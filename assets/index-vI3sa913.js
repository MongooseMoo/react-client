var Ux=Object.defineProperty;var Gx=(t,e,n)=>e in t?Ux(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Vx=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var j=(t,e,n)=>(Gx(t,typeof e!="symbol"?e+"":e,n),n),dg=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var x=(t,e,n)=>(dg(t,e,"read from private field"),n?n.call(t):e.get(t)),Me=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Ae=(t,e,n,r)=>(dg(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var kf=(t,e,n,r)=>({set _(i){Ae(t,e,i,n)},get _(){return x(t,e,r)}}),ye=(t,e,n)=>(dg(t,e,"access private method"),n);var nQ=Vx((VQ,Ox)=>{function $k(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Wx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Kk={exports:{}},Jp={},Jk={exports:{}},We={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qd=Symbol.for("react.element"),Hx=Symbol.for("react.portal"),Zx=Symbol.for("react.fragment"),jx=Symbol.for("react.strict_mode"),zx=Symbol.for("react.profiler"),Xx=Symbol.for("react.provider"),$x=Symbol.for("react.context"),Kx=Symbol.for("react.forward_ref"),Jx=Symbol.for("react.suspense"),Yx=Symbol.for("react.memo"),qx=Symbol.for("react.lazy"),TS=Symbol.iterator;function Qx(t){return t===null||typeof t!="object"?null:(t=TS&&t[TS]||t["@@iterator"],typeof t=="function"?t:null)}var Yk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qk=Object.assign,Qk={};function Zl(t,e,n){this.props=t,this.context=e,this.refs=Qk,this.updater=n||Yk}Zl.prototype.isReactComponent={};Zl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Zl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function eE(){}eE.prototype=Zl.prototype;function q0(t,e,n){this.props=t,this.context=e,this.refs=Qk,this.updater=n||Yk}var Q0=q0.prototype=new eE;Q0.constructor=q0;qk(Q0,Zl.prototype);Q0.isPureReactComponent=!0;var _S=Array.isArray,tE=Object.prototype.hasOwnProperty,eC={current:null},nE={key:!0,ref:!0,__self:!0,__source:!0};function rE(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)tE.call(e,r)&&!nE.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:qd,type:t,key:s,ref:o,props:i,_owner:eC.current}}function eD(t,e){return{$$typeof:qd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function tC(t){return typeof t=="object"&&t!==null&&t.$$typeof===qd}function tD(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var RS=/\/+/g;function fg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?tD(""+t.key):e.toString(36)}function lh(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case qd:case Hx:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+fg(o,0):r,_S(i)?(n="",t!=null&&(n=t.replace(RS,"$&/")+"/"),lh(i,e,n,"",function(l){return l})):i!=null&&(tC(i)&&(i=eD(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(RS,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",_S(t))for(var a=0;a<t.length;a++){s=t[a];var c=r+fg(s,a);o+=lh(s,e,n,c,i)}else if(c=Qx(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=r+fg(s,a++),o+=lh(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ef(t,e,n){if(t==null)return t;var r=[],i=0;return lh(t,r,"","",function(s){return e.call(n,s,i++)}),r}function nD(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var rr={current:null},uh={transition:null},rD={ReactCurrentDispatcher:rr,ReactCurrentBatchConfig:uh,ReactCurrentOwner:eC};We.Children={map:Ef,forEach:function(t,e,n){Ef(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ef(t,function(){e++}),e},toArray:function(t){return Ef(t,function(e){return e})||[]},only:function(t){if(!tC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};We.Component=Zl;We.Fragment=Zx;We.Profiler=zx;We.PureComponent=q0;We.StrictMode=jx;We.Suspense=Jx;We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rD;We.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=qk({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=eC.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)tE.call(e,c)&&!nE.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:qd,type:t.type,key:i,ref:s,props:r,_owner:o}};We.createContext=function(t){return t={$$typeof:$x,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Xx,_context:t},t.Consumer=t};We.createElement=rE;We.createFactory=function(t){var e=rE.bind(null,t);return e.type=t,e};We.createRef=function(){return{current:null}};We.forwardRef=function(t){return{$$typeof:Kx,render:t}};We.isValidElement=tC;We.lazy=function(t){return{$$typeof:qx,_payload:{_status:-1,_result:t},_init:nD}};We.memo=function(t,e){return{$$typeof:Yx,type:t,compare:e===void 0?null:e}};We.startTransition=function(t){var e=uh.transition;uh.transition={};try{t()}finally{uh.transition=e}};We.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};We.useCallback=function(t,e){return rr.current.useCallback(t,e)};We.useContext=function(t){return rr.current.useContext(t)};We.useDebugValue=function(){};We.useDeferredValue=function(t){return rr.current.useDeferredValue(t)};We.useEffect=function(t,e){return rr.current.useEffect(t,e)};We.useId=function(){return rr.current.useId()};We.useImperativeHandle=function(t,e,n){return rr.current.useImperativeHandle(t,e,n)};We.useInsertionEffect=function(t,e){return rr.current.useInsertionEffect(t,e)};We.useLayoutEffect=function(t,e){return rr.current.useLayoutEffect(t,e)};We.useMemo=function(t,e){return rr.current.useMemo(t,e)};We.useReducer=function(t,e,n){return rr.current.useReducer(t,e,n)};We.useRef=function(t){return rr.current.useRef(t)};We.useState=function(t){return rr.current.useState(t)};We.useSyncExternalStore=function(t,e,n){return rr.current.useSyncExternalStore(t,e,n)};We.useTransition=function(){return rr.current.useTransition()};We.version="18.2.0";Jk.exports=We;var w=Jk.exports;const St=Yd(w),iD=$k({__proto__:null,default:St},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sD=w,oD=Symbol.for("react.element"),aD=Symbol.for("react.fragment"),cD=Object.prototype.hasOwnProperty,lD=sD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,uD={key:!0,ref:!0,__self:!0,__source:!0};function iE(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)cD.call(e,r)&&!uD.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:oD,type:t,key:s,ref:o,props:i,_owner:lD.current}}Jp.Fragment=aD;Jp.jsx=iE;Jp.jsxs=iE;Kk.exports=Jp;var q=Kk.exports,Sv={},sE={exports:{}},Pr={},oE={exports:{}},aE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,K){var ie=H.length;H.push(K);e:for(;0<ie;){var $=ie-1>>>1,se=H[$];if(0<i(se,K))H[$]=K,H[ie]=se,ie=$;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var K=H[0],ie=H.pop();if(ie!==K){H[0]=ie;e:for(var $=0,se=H.length,be=se>>>1;$<be;){var we=2*($+1)-1,me=H[we],ke=we+1,Ue=H[ke];if(0>i(me,ie))ke<se&&0>i(Ue,me)?(H[$]=Ue,H[ke]=ie,$=ke):(H[$]=me,H[we]=ie,$=we);else if(ke<se&&0>i(Ue,ie))H[$]=Ue,H[ke]=ie,$=ke;else break e}}return K}function i(H,K){var ie=H.sortIndex-K.sortIndex;return ie!==0?ie:H.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],l=[],u=1,d=null,f=3,h=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(H){for(var K=n(l);K!==null;){if(K.callback===null)r(l);else if(K.startTime<=H)r(l),K.sortIndex=K.expirationTime,e(c,K);else break;K=n(l)}}function E(H){if(g=!1,S(H),!p)if(n(c)!==null)p=!0,X(A);else{var K=n(l);K!==null&&te(E,K.startTime-H)}}function A(H,K){p=!1,g&&(g=!1,m(_),_=-1),h=!0;var ie=f;try{for(S(K),d=n(c);d!==null&&(!(d.expirationTime>K)||H&&!D());){var $=d.callback;if(typeof $=="function"){d.callback=null,f=d.priorityLevel;var se=$(d.expirationTime<=K);K=t.unstable_now(),typeof se=="function"?d.callback=se:d===n(c)&&r(c),S(K)}else r(c);d=n(c)}if(d!==null)var be=!0;else{var we=n(l);we!==null&&te(E,we.startTime-K),be=!1}return be}finally{d=null,f=ie,h=!1}}var b=!1,k=null,_=-1,N=5,M=-1;function D(){return!(t.unstable_now()-M<N)}function B(){if(k!==null){var H=t.unstable_now();M=H;var K=!0;try{K=k(!0,H)}finally{K?G():(b=!1,k=null)}}else b=!1}var G;if(typeof v=="function")G=function(){v(B)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,z=V.port2;V.port1.onmessage=B,G=function(){z.postMessage(null)}}else G=function(){y(B,0)};function X(H){k=H,b||(b=!0,G())}function te(H,K){_=y(function(){H(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,X(A))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(f){case 1:case 2:case 3:var K=3;break;default:K=f}var ie=f;f=K;try{return H()}finally{f=ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,K){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ie=f;f=H;try{return K()}finally{f=ie}},t.unstable_scheduleCallback=function(H,K,ie){var $=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?$+ie:$):ie=$,H){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=ie+se,H={id:u++,callback:K,priorityLevel:H,startTime:ie,expirationTime:se,sortIndex:-1},ie>$?(H.sortIndex=ie,e(l,H),n(c)===null&&H===n(l)&&(g?(m(_),_=-1):g=!0,te(E,ie-$))):(H.sortIndex=se,e(c,H),p||h||(p=!0,X(A))),H},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(H){var K=f;return function(){var ie=f;f=K;try{return H.apply(this,arguments)}finally{f=ie}}}})(aE);oE.exports=aE;var dD=oE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cE=w,Rr=dD;function ae(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lE=new Set,cd={};function sc(t,e){Sl(t,e),Sl(t+"Capture",e)}function Sl(t,e){for(cd[t]=e,t=0;t<e.length;t++)lE.add(e[t])}var ro=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bv=Object.prototype.hasOwnProperty,fD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,NS={},PS={};function hD(t){return bv.call(PS,t)?!0:bv.call(NS,t)?!1:fD.test(t)?PS[t]=!0:(NS[t]=!0,!1)}function pD(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function mD(t,e,n,r){if(e===null||typeof e>"u"||pD(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ir(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var _n={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){_n[t]=new ir(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];_n[e]=new ir(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){_n[t]=new ir(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){_n[t]=new ir(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){_n[t]=new ir(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){_n[t]=new ir(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){_n[t]=new ir(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){_n[t]=new ir(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){_n[t]=new ir(t,5,!1,t.toLowerCase(),null,!1,!1)});var nC=/[\-:]([a-z])/g;function rC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(nC,rC);_n[e]=new ir(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(nC,rC);_n[e]=new ir(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(nC,rC);_n[e]=new ir(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){_n[t]=new ir(t,1,!1,t.toLowerCase(),null,!1,!1)});_n.xlinkHref=new ir("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){_n[t]=new ir(t,1,!1,t.toLowerCase(),null,!0,!0)});function iC(t,e,n,r){var i=_n.hasOwnProperty(e)?_n[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(mD(e,n,i,r)&&(n=null),r||i===null?hD(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var fo=cE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Tf=Symbol.for("react.element"),_c=Symbol.for("react.portal"),Rc=Symbol.for("react.fragment"),sC=Symbol.for("react.strict_mode"),wv=Symbol.for("react.profiler"),uE=Symbol.for("react.provider"),dE=Symbol.for("react.context"),oC=Symbol.for("react.forward_ref"),Av=Symbol.for("react.suspense"),kv=Symbol.for("react.suspense_list"),aC=Symbol.for("react.memo"),To=Symbol.for("react.lazy"),fE=Symbol.for("react.offscreen"),MS=Symbol.iterator;function lu(t){return t===null||typeof t!="object"?null:(t=MS&&t[MS]||t["@@iterator"],typeof t=="function"?t:null)}var Pt=Object.assign,hg;function Pu(t){if(hg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);hg=e&&e[1]||""}return`
`+hg+t}var pg=!1;function mg(t,e){if(!t||pg)return"";pg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{pg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Pu(t):""}function gD(t){switch(t.tag){case 5:return Pu(t.type);case 16:return Pu("Lazy");case 13:return Pu("Suspense");case 19:return Pu("SuspenseList");case 0:case 2:case 15:return t=mg(t.type,!1),t;case 11:return t=mg(t.type.render,!1),t;case 1:return t=mg(t.type,!0),t;default:return""}}function Ev(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Rc:return"Fragment";case _c:return"Portal";case wv:return"Profiler";case sC:return"StrictMode";case Av:return"Suspense";case kv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case dE:return(t.displayName||"Context")+".Consumer";case uE:return(t._context.displayName||"Context")+".Provider";case oC:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case aC:return e=t.displayName||null,e!==null?e:Ev(t.type)||"Memo";case To:e=t._payload,t=t._init;try{return Ev(t(e))}catch{}}return null}function vD(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ev(e);case 8:return e===sC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function oa(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function hE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yD(t){var e=hE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function _f(t){t._valueTracker||(t._valueTracker=yD(t))}function pE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=hE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Uh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Tv(t,e){var n=e.checked;return Pt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function xS(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=oa(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function mE(t,e){e=e.checked,e!=null&&iC(t,"checked",e,!1)}function _v(t,e){mE(t,e);var n=oa(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Rv(t,e.type,n):e.hasOwnProperty("defaultValue")&&Rv(t,e.type,oa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function DS(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Rv(t,e,n){(e!=="number"||Uh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Mu=Array.isArray;function Jc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+oa(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Nv(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ae(91));return Pt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function OS(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ae(92));if(Mu(n)){if(1<n.length)throw Error(ae(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:oa(n)}}function gE(t,e){var n=oa(e.value),r=oa(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function LS(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function vE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?vE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Rf,yE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Rf=Rf||document.createElement("div"),Rf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Rf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ld(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Wu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},CD=["Webkit","ms","Moz","O"];Object.keys(Wu).forEach(function(t){CD.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Wu[e]=Wu[t]})});function CE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Wu.hasOwnProperty(t)&&Wu[t]?(""+e).trim():e+"px"}function IE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=CE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var ID=Pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mv(t,e){if(e){if(ID[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ae(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ae(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ae(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ae(62))}}function xv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dv=null;function cC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ov=null,Yc=null,qc=null;function BS(t){if(t=tf(t)){if(typeof Ov!="function")throw Error(ae(280));var e=t.stateNode;e&&(e=tm(e),Ov(t.stateNode,t.type,e))}}function SE(t){Yc?qc?qc.push(t):qc=[t]:Yc=t}function bE(){if(Yc){var t=Yc,e=qc;if(qc=Yc=null,BS(t),e)for(t=0;t<e.length;t++)BS(e[t])}}function wE(t,e){return t(e)}function AE(){}var gg=!1;function kE(t,e,n){if(gg)return t(e,n);gg=!0;try{return wE(t,e,n)}finally{gg=!1,(Yc!==null||qc!==null)&&(AE(),bE())}}function ud(t,e){var n=t.stateNode;if(n===null)return null;var r=tm(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ae(231,e,typeof n));return n}var Lv=!1;if(ro)try{var uu={};Object.defineProperty(uu,"passive",{get:function(){Lv=!0}}),window.addEventListener("test",uu,uu),window.removeEventListener("test",uu,uu)}catch{Lv=!1}function SD(t,e,n,r,i,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var Hu=!1,Gh=null,Vh=!1,Bv=null,bD={onError:function(t){Hu=!0,Gh=t}};function wD(t,e,n,r,i,s,o,a,c){Hu=!1,Gh=null,SD.apply(bD,arguments)}function AD(t,e,n,r,i,s,o,a,c){if(wD.apply(this,arguments),Hu){if(Hu){var l=Gh;Hu=!1,Gh=null}else throw Error(ae(198));Vh||(Vh=!0,Bv=l)}}function oc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function EE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function FS(t){if(oc(t)!==t)throw Error(ae(188))}function kD(t){var e=t.alternate;if(!e){if(e=oc(t),e===null)throw Error(ae(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return FS(i),t;if(s===r)return FS(i),e;s=s.sibling}throw Error(ae(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ae(189))}}if(n.alternate!==r)throw Error(ae(190))}if(n.tag!==3)throw Error(ae(188));return n.stateNode.current===n?t:e}function TE(t){return t=kD(t),t!==null?_E(t):null}function _E(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=_E(t);if(e!==null)return e;t=t.sibling}return null}var RE=Rr.unstable_scheduleCallback,US=Rr.unstable_cancelCallback,ED=Rr.unstable_shouldYield,TD=Rr.unstable_requestPaint,Ht=Rr.unstable_now,_D=Rr.unstable_getCurrentPriorityLevel,lC=Rr.unstable_ImmediatePriority,NE=Rr.unstable_UserBlockingPriority,Wh=Rr.unstable_NormalPriority,RD=Rr.unstable_LowPriority,PE=Rr.unstable_IdlePriority,Yp=null,as=null;function ND(t){if(as&&typeof as.onCommitFiberRoot=="function")try{as.onCommitFiberRoot(Yp,t,void 0,(t.current.flags&128)===128)}catch{}}var Ii=Math.clz32?Math.clz32:xD,PD=Math.log,MD=Math.LN2;function xD(t){return t>>>=0,t===0?32:31-(PD(t)/MD|0)|0}var Nf=64,Pf=4194304;function xu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Hh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=xu(a):(s&=o,s!==0&&(r=xu(s)))}else o=n&~i,o!==0?r=xu(o):s!==0&&(r=xu(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ii(e),i=1<<n,r|=t[n],e&=~i;return r}function DD(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function OD(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Ii(s),a=1<<o,c=i[o];c===-1?(!(a&n)||a&r)&&(i[o]=DD(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function Fv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ME(){var t=Nf;return Nf<<=1,!(Nf&4194240)&&(Nf=64),t}function vg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Qd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ii(e),t[e]=n}function LD(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ii(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function uC(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ii(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var et=0;function xE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var DE,dC,OE,LE,BE,Uv=!1,Mf=[],zo=null,Xo=null,$o=null,dd=new Map,fd=new Map,xo=[],BD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function GS(t,e){switch(t){case"focusin":case"focusout":zo=null;break;case"dragenter":case"dragleave":Xo=null;break;case"mouseover":case"mouseout":$o=null;break;case"pointerover":case"pointerout":dd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fd.delete(e.pointerId)}}function du(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=tf(e),e!==null&&dC(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function FD(t,e,n,r,i){switch(e){case"focusin":return zo=du(zo,t,e,n,r,i),!0;case"dragenter":return Xo=du(Xo,t,e,n,r,i),!0;case"mouseover":return $o=du($o,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return dd.set(s,du(dd.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,fd.set(s,du(fd.get(s)||null,t,e,n,r,i)),!0}return!1}function FE(t){var e=_a(t.target);if(e!==null){var n=oc(e);if(n!==null){if(e=n.tag,e===13){if(e=EE(n),e!==null){t.blockedOn=e,BE(t.priority,function(){OE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function dh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Gv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Dv=r,n.target.dispatchEvent(r),Dv=null}else return e=tf(n),e!==null&&dC(e),t.blockedOn=n,!1;e.shift()}return!0}function VS(t,e,n){dh(t)&&n.delete(e)}function UD(){Uv=!1,zo!==null&&dh(zo)&&(zo=null),Xo!==null&&dh(Xo)&&(Xo=null),$o!==null&&dh($o)&&($o=null),dd.forEach(VS),fd.forEach(VS)}function fu(t,e){t.blockedOn===e&&(t.blockedOn=null,Uv||(Uv=!0,Rr.unstable_scheduleCallback(Rr.unstable_NormalPriority,UD)))}function hd(t){function e(i){return fu(i,t)}if(0<Mf.length){fu(Mf[0],t);for(var n=1;n<Mf.length;n++){var r=Mf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(zo!==null&&fu(zo,t),Xo!==null&&fu(Xo,t),$o!==null&&fu($o,t),dd.forEach(e),fd.forEach(e),n=0;n<xo.length;n++)r=xo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<xo.length&&(n=xo[0],n.blockedOn===null);)FE(n),n.blockedOn===null&&xo.shift()}var Qc=fo.ReactCurrentBatchConfig,Zh=!0;function GD(t,e,n,r){var i=et,s=Qc.transition;Qc.transition=null;try{et=1,fC(t,e,n,r)}finally{et=i,Qc.transition=s}}function VD(t,e,n,r){var i=et,s=Qc.transition;Qc.transition=null;try{et=4,fC(t,e,n,r)}finally{et=i,Qc.transition=s}}function fC(t,e,n,r){if(Zh){var i=Gv(t,e,n,r);if(i===null)Tg(t,e,r,jh,n),GS(t,r);else if(FD(i,t,e,n,r))r.stopPropagation();else if(GS(t,r),e&4&&-1<BD.indexOf(t)){for(;i!==null;){var s=tf(i);if(s!==null&&DE(s),s=Gv(t,e,n,r),s===null&&Tg(t,e,r,jh,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Tg(t,e,r,null,n)}}var jh=null;function Gv(t,e,n,r){if(jh=null,t=cC(r),t=_a(t),t!==null)if(e=oc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=EE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return jh=t,null}function UE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_D()){case lC:return 1;case NE:return 4;case Wh:case RD:return 16;case PE:return 536870912;default:return 16}default:return 16}}var Bo=null,hC=null,fh=null;function GE(){if(fh)return fh;var t,e=hC,n=e.length,r,i="value"in Bo?Bo.value:Bo.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return fh=i.slice(t,1<r?1-r:void 0)}function hh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function xf(){return!0}function WS(){return!1}function Mr(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?xf:WS,this.isPropagationStopped=WS,this}return Pt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=xf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=xf)},persist:function(){},isPersistent:xf}),e}var jl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pC=Mr(jl),ef=Pt({},jl,{view:0,detail:0}),WD=Mr(ef),yg,Cg,hu,qp=Pt({},ef,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mC,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==hu&&(hu&&t.type==="mousemove"?(yg=t.screenX-hu.screenX,Cg=t.screenY-hu.screenY):Cg=yg=0,hu=t),yg)},movementY:function(t){return"movementY"in t?t.movementY:Cg}}),HS=Mr(qp),HD=Pt({},qp,{dataTransfer:0}),ZD=Mr(HD),jD=Pt({},ef,{relatedTarget:0}),Ig=Mr(jD),zD=Pt({},jl,{animationName:0,elapsedTime:0,pseudoElement:0}),XD=Mr(zD),$D=Pt({},jl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),KD=Mr($D),JD=Pt({},jl,{data:0}),ZS=Mr(JD),YD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eO(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=QD[t])?!!e[t]:!1}function mC(){return eO}var tO=Pt({},ef,{key:function(t){if(t.key){var e=YD[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=hh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?qD[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mC,charCode:function(t){return t.type==="keypress"?hh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?hh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),nO=Mr(tO),rO=Pt({},qp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jS=Mr(rO),iO=Pt({},ef,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mC}),sO=Mr(iO),oO=Pt({},jl,{propertyName:0,elapsedTime:0,pseudoElement:0}),aO=Mr(oO),cO=Pt({},qp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),lO=Mr(cO),uO=[9,13,27,32],gC=ro&&"CompositionEvent"in window,Zu=null;ro&&"documentMode"in document&&(Zu=document.documentMode);var dO=ro&&"TextEvent"in window&&!Zu,VE=ro&&(!gC||Zu&&8<Zu&&11>=Zu),zS=" ",XS=!1;function WE(t,e){switch(t){case"keyup":return uO.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function HE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Nc=!1;function fO(t,e){switch(t){case"compositionend":return HE(e);case"keypress":return e.which!==32?null:(XS=!0,zS);case"textInput":return t=e.data,t===zS&&XS?null:t;default:return null}}function hO(t,e){if(Nc)return t==="compositionend"||!gC&&WE(t,e)?(t=GE(),fh=hC=Bo=null,Nc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return VE&&e.locale!=="ko"?null:e.data;default:return null}}var pO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $S(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!pO[t.type]:e==="textarea"}function ZE(t,e,n,r){SE(r),e=zh(e,"onChange"),0<e.length&&(n=new pC("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ju=null,pd=null;function mO(t){t1(t,0)}function Qp(t){var e=xc(t);if(pE(e))return t}function gO(t,e){if(t==="change")return e}var jE=!1;if(ro){var Sg;if(ro){var bg="oninput"in document;if(!bg){var KS=document.createElement("div");KS.setAttribute("oninput","return;"),bg=typeof KS.oninput=="function"}Sg=bg}else Sg=!1;jE=Sg&&(!document.documentMode||9<document.documentMode)}function JS(){ju&&(ju.detachEvent("onpropertychange",zE),pd=ju=null)}function zE(t){if(t.propertyName==="value"&&Qp(pd)){var e=[];ZE(e,pd,t,cC(t)),kE(mO,e)}}function vO(t,e,n){t==="focusin"?(JS(),ju=e,pd=n,ju.attachEvent("onpropertychange",zE)):t==="focusout"&&JS()}function yO(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qp(pd)}function CO(t,e){if(t==="click")return Qp(e)}function IO(t,e){if(t==="input"||t==="change")return Qp(e)}function SO(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ai=typeof Object.is=="function"?Object.is:SO;function md(t,e){if(Ai(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!bv.call(e,i)||!Ai(t[i],e[i]))return!1}return!0}function YS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qS(t,e){var n=YS(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=YS(n)}}function XE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?XE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function $E(){for(var t=window,e=Uh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Uh(t.document)}return e}function vC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function bO(t){var e=$E(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&XE(n.ownerDocument.documentElement,n)){if(r!==null&&vC(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=qS(n,s);var o=qS(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var wO=ro&&"documentMode"in document&&11>=document.documentMode,Pc=null,Vv=null,zu=null,Wv=!1;function QS(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Wv||Pc==null||Pc!==Uh(r)||(r=Pc,"selectionStart"in r&&vC(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),zu&&md(zu,r)||(zu=r,r=zh(Vv,"onSelect"),0<r.length&&(e=new pC("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Pc)))}function Df(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Mc={animationend:Df("Animation","AnimationEnd"),animationiteration:Df("Animation","AnimationIteration"),animationstart:Df("Animation","AnimationStart"),transitionend:Df("Transition","TransitionEnd")},wg={},KE={};ro&&(KE=document.createElement("div").style,"AnimationEvent"in window||(delete Mc.animationend.animation,delete Mc.animationiteration.animation,delete Mc.animationstart.animation),"TransitionEvent"in window||delete Mc.transitionend.transition);function em(t){if(wg[t])return wg[t];if(!Mc[t])return t;var e=Mc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in KE)return wg[t]=e[n];return t}var JE=em("animationend"),YE=em("animationiteration"),qE=em("animationstart"),QE=em("transitionend"),e1=new Map,eb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ha(t,e){e1.set(t,e),sc(e,[t])}for(var Ag=0;Ag<eb.length;Ag++){var kg=eb[Ag],AO=kg.toLowerCase(),kO=kg[0].toUpperCase()+kg.slice(1);ha(AO,"on"+kO)}ha(JE,"onAnimationEnd");ha(YE,"onAnimationIteration");ha(qE,"onAnimationStart");ha("dblclick","onDoubleClick");ha("focusin","onFocus");ha("focusout","onBlur");ha(QE,"onTransitionEnd");Sl("onMouseEnter",["mouseout","mouseover"]);Sl("onMouseLeave",["mouseout","mouseover"]);Sl("onPointerEnter",["pointerout","pointerover"]);Sl("onPointerLeave",["pointerout","pointerover"]);sc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sc("onBeforeInput",["compositionend","keypress","textInput","paste"]);sc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Du="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),EO=new Set("cancel close invalid load scroll toggle".split(" ").concat(Du));function tb(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,AD(r,e,void 0,t),t.currentTarget=null}function t1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;tb(i,a,l),s=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;tb(i,a,l),s=c}}}if(Vh)throw t=Bv,Vh=!1,Bv=null,t}function vt(t,e){var n=e[Xv];n===void 0&&(n=e[Xv]=new Set);var r=t+"__bubble";n.has(r)||(n1(e,t,2,!1),n.add(r))}function Eg(t,e,n){var r=0;e&&(r|=4),n1(n,t,r,e)}var Of="_reactListening"+Math.random().toString(36).slice(2);function gd(t){if(!t[Of]){t[Of]=!0,lE.forEach(function(n){n!=="selectionchange"&&(EO.has(n)||Eg(n,!1,t),Eg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Of]||(e[Of]=!0,Eg("selectionchange",!1,e))}}function n1(t,e,n,r){switch(UE(e)){case 1:var i=GD;break;case 4:i=VD;break;default:i=fC}n=i.bind(null,e,n,t),i=void 0,!Lv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Tg(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=_a(a),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}a=a.parentNode}}r=r.return}kE(function(){var l=s,u=cC(n),d=[];e:{var f=e1.get(t);if(f!==void 0){var h=pC,p=t;switch(t){case"keypress":if(hh(n)===0)break e;case"keydown":case"keyup":h=nO;break;case"focusin":p="focus",h=Ig;break;case"focusout":p="blur",h=Ig;break;case"beforeblur":case"afterblur":h=Ig;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=HS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=ZD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=sO;break;case JE:case YE:case qE:h=XD;break;case QE:h=aO;break;case"scroll":h=WD;break;case"wheel":h=lO;break;case"copy":case"cut":case"paste":h=KD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=jS}var g=(e&4)!==0,y=!g&&t==="scroll",m=g?f!==null?f+"Capture":null:f;g=[];for(var v=l,S;v!==null;){S=v;var E=S.stateNode;if(S.tag===5&&E!==null&&(S=E,m!==null&&(E=ud(v,m),E!=null&&g.push(vd(v,E,S)))),y)break;v=v.return}0<g.length&&(f=new h(f,p,null,n,u),d.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Dv&&(p=n.relatedTarget||n.fromElement)&&(_a(p)||p[io]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?_a(p):null,p!==null&&(y=oc(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(g=HS,E="onMouseLeave",m="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(g=jS,E="onPointerLeave",m="onPointerEnter",v="pointer"),y=h==null?f:xc(h),S=p==null?f:xc(p),f=new g(E,v+"leave",h,n,u),f.target=y,f.relatedTarget=S,E=null,_a(u)===l&&(g=new g(m,v+"enter",p,n,u),g.target=S,g.relatedTarget=y,E=g),y=E,h&&p)t:{for(g=h,m=p,v=0,S=g;S;S=Cc(S))v++;for(S=0,E=m;E;E=Cc(E))S++;for(;0<v-S;)g=Cc(g),v--;for(;0<S-v;)m=Cc(m),S--;for(;v--;){if(g===m||m!==null&&g===m.alternate)break t;g=Cc(g),m=Cc(m)}g=null}else g=null;h!==null&&nb(d,f,h,g,!1),p!==null&&y!==null&&nb(d,y,p,g,!0)}}e:{if(f=l?xc(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var A=gO;else if($S(f))if(jE)A=IO;else{A=yO;var b=vO}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(A=CO);if(A&&(A=A(t,l))){ZE(d,A,n,u);break e}b&&b(t,f,l),t==="focusout"&&(b=f._wrapperState)&&b.controlled&&f.type==="number"&&Rv(f,"number",f.value)}switch(b=l?xc(l):window,t){case"focusin":($S(b)||b.contentEditable==="true")&&(Pc=b,Vv=l,zu=null);break;case"focusout":zu=Vv=Pc=null;break;case"mousedown":Wv=!0;break;case"contextmenu":case"mouseup":case"dragend":Wv=!1,QS(d,n,u);break;case"selectionchange":if(wO)break;case"keydown":case"keyup":QS(d,n,u)}var k;if(gC)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Nc?WE(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(VE&&n.locale!=="ko"&&(Nc||_!=="onCompositionStart"?_==="onCompositionEnd"&&Nc&&(k=GE()):(Bo=u,hC="value"in Bo?Bo.value:Bo.textContent,Nc=!0)),b=zh(l,_),0<b.length&&(_=new ZS(_,t,null,n,u),d.push({event:_,listeners:b}),k?_.data=k:(k=HE(n),k!==null&&(_.data=k)))),(k=dO?fO(t,n):hO(t,n))&&(l=zh(l,"onBeforeInput"),0<l.length&&(u=new ZS("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:l}),u.data=k))}t1(d,e)})}function vd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function zh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ud(t,n),s!=null&&r.unshift(vd(t,s,i)),s=ud(t,e),s!=null&&r.push(vd(t,s,i))),t=t.return}return r}function Cc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function nb(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&l!==null&&(a=l,i?(c=ud(n,s),c!=null&&o.unshift(vd(n,c,a))):i||(c=ud(n,s),c!=null&&o.push(vd(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var TO=/\r\n?/g,_O=/\u0000|\uFFFD/g;function rb(t){return(typeof t=="string"?t:""+t).replace(TO,`
`).replace(_O,"")}function Lf(t,e,n){if(e=rb(e),rb(t)!==e&&n)throw Error(ae(425))}function Xh(){}var Hv=null,Zv=null;function jv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var zv=typeof setTimeout=="function"?setTimeout:void 0,RO=typeof clearTimeout=="function"?clearTimeout:void 0,ib=typeof Promise=="function"?Promise:void 0,NO=typeof queueMicrotask=="function"?queueMicrotask:typeof ib<"u"?function(t){return ib.resolve(null).then(t).catch(PO)}:zv;function PO(t){setTimeout(function(){throw t})}function _g(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),hd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);hd(e)}function Ko(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sb(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var zl=Math.random().toString(36).slice(2),Ui="__reactFiber$"+zl,yd="__reactProps$"+zl,io="__reactContainer$"+zl,Xv="__reactEvents$"+zl,MO="__reactListeners$"+zl,xO="__reactHandles$"+zl;function _a(t){var e=t[Ui];if(e)return e;for(var n=t.parentNode;n;){if(e=n[io]||n[Ui]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=sb(t);t!==null;){if(n=t[Ui])return n;t=sb(t)}return e}t=n,n=t.parentNode}return null}function tf(t){return t=t[Ui]||t[io],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ae(33))}function tm(t){return t[yd]||null}var $v=[],Dc=-1;function pa(t){return{current:t}}function It(t){0>Dc||(t.current=$v[Dc],$v[Dc]=null,Dc--)}function mt(t,e){Dc++,$v[Dc]=t.current,t.current=e}var aa={},Gn=pa(aa),dr=pa(!1),Wa=aa;function bl(t,e){var n=t.type.contextTypes;if(!n)return aa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function fr(t){return t=t.childContextTypes,t!=null}function $h(){It(dr),It(Gn)}function ob(t,e,n){if(Gn.current!==aa)throw Error(ae(168));mt(Gn,e),mt(dr,n)}function r1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ae(108,vD(t)||"Unknown",i));return Pt({},n,r)}function Kh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||aa,Wa=Gn.current,mt(Gn,t),mt(dr,dr.current),!0}function ab(t,e,n){var r=t.stateNode;if(!r)throw Error(ae(169));n?(t=r1(t,e,Wa),r.__reactInternalMemoizedMergedChildContext=t,It(dr),It(Gn),mt(Gn,t)):It(dr),mt(dr,n)}var bs=null,nm=!1,Rg=!1;function i1(t){bs===null?bs=[t]:bs.push(t)}function DO(t){nm=!0,i1(t)}function ma(){if(!Rg&&bs!==null){Rg=!0;var t=0,e=et;try{var n=bs;for(et=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}bs=null,nm=!1}catch(i){throw bs!==null&&(bs=bs.slice(t+1)),RE(lC,ma),i}finally{et=e,Rg=!1}}return null}var Oc=[],Lc=0,Jh=null,Yh=0,Br=[],Fr=0,Ha=null,Ts=1,_s="";function ka(t,e){Oc[Lc++]=Yh,Oc[Lc++]=Jh,Jh=t,Yh=e}function s1(t,e,n){Br[Fr++]=Ts,Br[Fr++]=_s,Br[Fr++]=Ha,Ha=t;var r=Ts;t=_s;var i=32-Ii(r)-1;r&=~(1<<i),n+=1;var s=32-Ii(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ts=1<<32-Ii(e)+i|n<<i|r,_s=s+t}else Ts=1<<s|n<<i|r,_s=t}function yC(t){t.return!==null&&(ka(t,1),s1(t,1,0))}function CC(t){for(;t===Jh;)Jh=Oc[--Lc],Oc[Lc]=null,Yh=Oc[--Lc],Oc[Lc]=null;for(;t===Ha;)Ha=Br[--Fr],Br[Fr]=null,_s=Br[--Fr],Br[Fr]=null,Ts=Br[--Fr],Br[Fr]=null}var Tr=null,kr=null,Et=!1,di=null;function o1(t,e){var n=Gr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function cb(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Tr=t,kr=Ko(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Tr=t,kr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ha!==null?{id:Ts,overflow:_s}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Gr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Tr=t,kr=null,!0):!1;default:return!1}}function Kv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Jv(t){if(Et){var e=kr;if(e){var n=e;if(!cb(t,e)){if(Kv(t))throw Error(ae(418));e=Ko(n.nextSibling);var r=Tr;e&&cb(t,e)?o1(r,n):(t.flags=t.flags&-4097|2,Et=!1,Tr=t)}}else{if(Kv(t))throw Error(ae(418));t.flags=t.flags&-4097|2,Et=!1,Tr=t}}}function lb(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Tr=t}function Bf(t){if(t!==Tr)return!1;if(!Et)return lb(t),Et=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!jv(t.type,t.memoizedProps)),e&&(e=kr)){if(Kv(t))throw a1(),Error(ae(418));for(;e;)o1(t,e),e=Ko(e.nextSibling)}if(lb(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ae(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){kr=Ko(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}kr=null}}else kr=Tr?Ko(t.stateNode.nextSibling):null;return!0}function a1(){for(var t=kr;t;)t=Ko(t.nextSibling)}function wl(){kr=Tr=null,Et=!1}function IC(t){di===null?di=[t]:di.push(t)}var OO=fo.ReactCurrentBatchConfig;function Qr(t,e){if(t&&t.defaultProps){e=Pt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var qh=pa(null),Qh=null,Bc=null,SC=null;function bC(){SC=Bc=Qh=null}function wC(t){var e=qh.current;It(qh),t._currentValue=e}function Yv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function el(t,e){Qh=t,SC=Bc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(lr=!0),t.firstContext=null)}function jr(t){var e=t._currentValue;if(SC!==t)if(t={context:t,memoizedValue:e,next:null},Bc===null){if(Qh===null)throw Error(ae(308));Bc=t,Qh.dependencies={lanes:0,firstContext:t}}else Bc=Bc.next=t;return e}var Ra=null;function AC(t){Ra===null?Ra=[t]:Ra.push(t)}function c1(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,AC(e)):(n.next=i.next,i.next=n),e.interleaved=n,so(t,r)}function so(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var _o=!1;function kC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function l1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Jo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Xe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,so(t,n)}return i=r.interleaved,i===null?(e.next=e,AC(r)):(e.next=i.next,i.next=e),r.interleaved=e,so(t,n)}function ph(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,uC(t,n)}}function ub(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ep(t,e,n,r){var i=t.updateQueue;_o=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?s=l:o.next=l,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(s!==null){var d=i.baseState;o=0,u=l=c=null,a=s;do{var f=a.lane,h=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,g=a;switch(f=e,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Pt({},d,f);break e;case 2:_o=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=h,c=d):u=u.next=h,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ja|=o,t.lanes=o,t.memoizedState=d}}function db(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ae(191,i));i.call(r)}}}var u1=new cE.Component().refs;function qv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Pt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var rm={isMounted:function(t){return(t=t._reactInternals)?oc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=nr(),i=qo(t),s=Qs(r,i);s.payload=e,n!=null&&(s.callback=n),e=Jo(t,s,i),e!==null&&(Si(e,t,i,r),ph(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=nr(),i=qo(t),s=Qs(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Jo(t,s,i),e!==null&&(Si(e,t,i,r),ph(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=nr(),r=qo(t),i=Qs(n,r);i.tag=2,e!=null&&(i.callback=e),e=Jo(t,i,r),e!==null&&(Si(e,t,r,n),ph(e,t,r))}};function fb(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!md(n,r)||!md(i,s):!0}function d1(t,e,n){var r=!1,i=aa,s=e.contextType;return typeof s=="object"&&s!==null?s=jr(s):(i=fr(e)?Wa:Gn.current,r=e.contextTypes,s=(r=r!=null)?bl(t,i):aa),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=rm,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function hb(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&rm.enqueueReplaceState(e,e.state,null)}function Qv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=u1,kC(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=jr(s):(s=fr(e)?Wa:Gn.current,i.context=bl(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(qv(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&rm.enqueueReplaceState(i,i.state,null),ep(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function pu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ae(309));var r=n.stateNode}if(!r)throw Error(ae(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===u1&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ae(284));if(!n._owner)throw Error(ae(290,t))}return t}function Ff(t,e){throw t=Object.prototype.toString.call(e),Error(ae(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function pb(t){var e=t._init;return e(t._payload)}function f1(t){function e(m,v){if(t){var S=m.deletions;S===null?(m.deletions=[v],m.flags|=16):S.push(v)}}function n(m,v){if(!t)return null;for(;v!==null;)e(m,v),v=v.sibling;return null}function r(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function i(m,v){return m=Qo(m,v),m.index=0,m.sibling=null,m}function s(m,v,S){return m.index=S,t?(S=m.alternate,S!==null?(S=S.index,S<v?(m.flags|=2,v):S):(m.flags|=2,v)):(m.flags|=1048576,v)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,v,S,E){return v===null||v.tag!==6?(v=Lg(S,m.mode,E),v.return=m,v):(v=i(v,S),v.return=m,v)}function c(m,v,S,E){var A=S.type;return A===Rc?u(m,v,S.props.children,E,S.key):v!==null&&(v.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===To&&pb(A)===v.type)?(E=i(v,S.props),E.ref=pu(m,v,S),E.return=m,E):(E=Ih(S.type,S.key,S.props,null,m.mode,E),E.ref=pu(m,v,S),E.return=m,E)}function l(m,v,S,E){return v===null||v.tag!==4||v.stateNode.containerInfo!==S.containerInfo||v.stateNode.implementation!==S.implementation?(v=Bg(S,m.mode,E),v.return=m,v):(v=i(v,S.children||[]),v.return=m,v)}function u(m,v,S,E,A){return v===null||v.tag!==7?(v=Fa(S,m.mode,E,A),v.return=m,v):(v=i(v,S),v.return=m,v)}function d(m,v,S){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Lg(""+v,m.mode,S),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Tf:return S=Ih(v.type,v.key,v.props,null,m.mode,S),S.ref=pu(m,null,v),S.return=m,S;case _c:return v=Bg(v,m.mode,S),v.return=m,v;case To:var E=v._init;return d(m,E(v._payload),S)}if(Mu(v)||lu(v))return v=Fa(v,m.mode,S,null),v.return=m,v;Ff(m,v)}return null}function f(m,v,S,E){var A=v!==null?v.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return A!==null?null:a(m,v,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Tf:return S.key===A?c(m,v,S,E):null;case _c:return S.key===A?l(m,v,S,E):null;case To:return A=S._init,f(m,v,A(S._payload),E)}if(Mu(S)||lu(S))return A!==null?null:u(m,v,S,E,null);Ff(m,S)}return null}function h(m,v,S,E,A){if(typeof E=="string"&&E!==""||typeof E=="number")return m=m.get(S)||null,a(v,m,""+E,A);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Tf:return m=m.get(E.key===null?S:E.key)||null,c(v,m,E,A);case _c:return m=m.get(E.key===null?S:E.key)||null,l(v,m,E,A);case To:var b=E._init;return h(m,v,S,b(E._payload),A)}if(Mu(E)||lu(E))return m=m.get(S)||null,u(v,m,E,A,null);Ff(v,E)}return null}function p(m,v,S,E){for(var A=null,b=null,k=v,_=v=0,N=null;k!==null&&_<S.length;_++){k.index>_?(N=k,k=null):N=k.sibling;var M=f(m,k,S[_],E);if(M===null){k===null&&(k=N);break}t&&k&&M.alternate===null&&e(m,k),v=s(M,v,_),b===null?A=M:b.sibling=M,b=M,k=N}if(_===S.length)return n(m,k),Et&&ka(m,_),A;if(k===null){for(;_<S.length;_++)k=d(m,S[_],E),k!==null&&(v=s(k,v,_),b===null?A=k:b.sibling=k,b=k);return Et&&ka(m,_),A}for(k=r(m,k);_<S.length;_++)N=h(k,m,_,S[_],E),N!==null&&(t&&N.alternate!==null&&k.delete(N.key===null?_:N.key),v=s(N,v,_),b===null?A=N:b.sibling=N,b=N);return t&&k.forEach(function(D){return e(m,D)}),Et&&ka(m,_),A}function g(m,v,S,E){var A=lu(S);if(typeof A!="function")throw Error(ae(150));if(S=A.call(S),S==null)throw Error(ae(151));for(var b=A=null,k=v,_=v=0,N=null,M=S.next();k!==null&&!M.done;_++,M=S.next()){k.index>_?(N=k,k=null):N=k.sibling;var D=f(m,k,M.value,E);if(D===null){k===null&&(k=N);break}t&&k&&D.alternate===null&&e(m,k),v=s(D,v,_),b===null?A=D:b.sibling=D,b=D,k=N}if(M.done)return n(m,k),Et&&ka(m,_),A;if(k===null){for(;!M.done;_++,M=S.next())M=d(m,M.value,E),M!==null&&(v=s(M,v,_),b===null?A=M:b.sibling=M,b=M);return Et&&ka(m,_),A}for(k=r(m,k);!M.done;_++,M=S.next())M=h(k,m,_,M.value,E),M!==null&&(t&&M.alternate!==null&&k.delete(M.key===null?_:M.key),v=s(M,v,_),b===null?A=M:b.sibling=M,b=M);return t&&k.forEach(function(B){return e(m,B)}),Et&&ka(m,_),A}function y(m,v,S,E){if(typeof S=="object"&&S!==null&&S.type===Rc&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Tf:e:{for(var A=S.key,b=v;b!==null;){if(b.key===A){if(A=S.type,A===Rc){if(b.tag===7){n(m,b.sibling),v=i(b,S.props.children),v.return=m,m=v;break e}}else if(b.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===To&&pb(A)===b.type){n(m,b.sibling),v=i(b,S.props),v.ref=pu(m,b,S),v.return=m,m=v;break e}n(m,b);break}else e(m,b);b=b.sibling}S.type===Rc?(v=Fa(S.props.children,m.mode,E,S.key),v.return=m,m=v):(E=Ih(S.type,S.key,S.props,null,m.mode,E),E.ref=pu(m,v,S),E.return=m,m=E)}return o(m);case _c:e:{for(b=S.key;v!==null;){if(v.key===b)if(v.tag===4&&v.stateNode.containerInfo===S.containerInfo&&v.stateNode.implementation===S.implementation){n(m,v.sibling),v=i(v,S.children||[]),v.return=m,m=v;break e}else{n(m,v);break}else e(m,v);v=v.sibling}v=Bg(S,m.mode,E),v.return=m,m=v}return o(m);case To:return b=S._init,y(m,v,b(S._payload),E)}if(Mu(S))return p(m,v,S,E);if(lu(S))return g(m,v,S,E);Ff(m,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,v!==null&&v.tag===6?(n(m,v.sibling),v=i(v,S),v.return=m,m=v):(n(m,v),v=Lg(S,m.mode,E),v.return=m,m=v),o(m)):n(m,v)}return y}var Al=f1(!0),h1=f1(!1),nf={},cs=pa(nf),Cd=pa(nf),Id=pa(nf);function Na(t){if(t===nf)throw Error(ae(174));return t}function EC(t,e){switch(mt(Id,e),mt(Cd,t),mt(cs,nf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Pv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Pv(e,t)}It(cs),mt(cs,e)}function kl(){It(cs),It(Cd),It(Id)}function p1(t){Na(Id.current);var e=Na(cs.current),n=Pv(e,t.type);e!==n&&(mt(Cd,t),mt(cs,n))}function TC(t){Cd.current===t&&(It(cs),It(Cd))}var Tt=pa(0);function tp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ng=[];function _C(){for(var t=0;t<Ng.length;t++)Ng[t]._workInProgressVersionPrimary=null;Ng.length=0}var mh=fo.ReactCurrentDispatcher,Pg=fo.ReactCurrentBatchConfig,Za=0,Nt=null,en=null,pn=null,np=!1,Xu=!1,Sd=0,LO=0;function Mn(){throw Error(ae(321))}function RC(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ai(t[n],e[n]))return!1;return!0}function NC(t,e,n,r,i,s){if(Za=s,Nt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,mh.current=t===null||t.memoizedState===null?GO:VO,t=n(r,i),Xu){s=0;do{if(Xu=!1,Sd=0,25<=s)throw Error(ae(301));s+=1,pn=en=null,e.updateQueue=null,mh.current=WO,t=n(r,i)}while(Xu)}if(mh.current=rp,e=en!==null&&en.next!==null,Za=0,pn=en=Nt=null,np=!1,e)throw Error(ae(300));return t}function PC(){var t=Sd!==0;return Sd=0,t}function xi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?Nt.memoizedState=pn=t:pn=pn.next=t,pn}function zr(){if(en===null){var t=Nt.alternate;t=t!==null?t.memoizedState:null}else t=en.next;var e=pn===null?Nt.memoizedState:pn.next;if(e!==null)pn=e,en=t;else{if(t===null)throw Error(ae(310));en=t,t={memoizedState:en.memoizedState,baseState:en.baseState,baseQueue:en.baseQueue,queue:en.queue,next:null},pn===null?Nt.memoizedState=pn=t:pn=pn.next=t}return pn}function bd(t,e){return typeof e=="function"?e(t):e}function Mg(t){var e=zr(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var r=en,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,c=null,l=s;do{var u=l.lane;if((Za&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=d,o=r):c=c.next=d,Nt.lanes|=u,ja|=u}l=l.next}while(l!==null&&l!==s);c===null?o=r:c.next=a,Ai(r,e.memoizedState)||(lr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Nt.lanes|=s,ja|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function xg(t){var e=zr(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ai(s,e.memoizedState)||(lr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function m1(){}function g1(t,e){var n=Nt,r=zr(),i=e(),s=!Ai(r.memoizedState,i);if(s&&(r.memoizedState=i,lr=!0),r=r.queue,MC(C1.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||pn!==null&&pn.memoizedState.tag&1){if(n.flags|=2048,wd(9,y1.bind(null,n,r,i,e),void 0,null),vn===null)throw Error(ae(349));Za&30||v1(n,e,i)}return i}function v1(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Nt.updateQueue,e===null?(e={lastEffect:null,stores:null},Nt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function y1(t,e,n,r){e.value=n,e.getSnapshot=r,I1(e)&&S1(t)}function C1(t,e,n){return n(function(){I1(e)&&S1(t)})}function I1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ai(t,n)}catch{return!0}}function S1(t){var e=so(t,1);e!==null&&Si(e,t,1,-1)}function mb(t){var e=xi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bd,lastRenderedState:t},e.queue=t,t=t.dispatch=UO.bind(null,Nt,t),[e.memoizedState,t]}function wd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Nt.updateQueue,e===null?(e={lastEffect:null,stores:null},Nt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function b1(){return zr().memoizedState}function gh(t,e,n,r){var i=xi();Nt.flags|=t,i.memoizedState=wd(1|e,n,void 0,r===void 0?null:r)}function im(t,e,n,r){var i=zr();r=r===void 0?null:r;var s=void 0;if(en!==null){var o=en.memoizedState;if(s=o.destroy,r!==null&&RC(r,o.deps)){i.memoizedState=wd(e,n,s,r);return}}Nt.flags|=t,i.memoizedState=wd(1|e,n,s,r)}function gb(t,e){return gh(8390656,8,t,e)}function MC(t,e){return im(2048,8,t,e)}function w1(t,e){return im(4,2,t,e)}function A1(t,e){return im(4,4,t,e)}function k1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function E1(t,e,n){return n=n!=null?n.concat([t]):null,im(4,4,k1.bind(null,e,t),n)}function xC(){}function T1(t,e){var n=zr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&RC(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function _1(t,e){var n=zr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&RC(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function R1(t,e,n){return Za&21?(Ai(n,e)||(n=ME(),Nt.lanes|=n,ja|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,lr=!0),t.memoizedState=n)}function BO(t,e){var n=et;et=n!==0&&4>n?n:4,t(!0);var r=Pg.transition;Pg.transition={};try{t(!1),e()}finally{et=n,Pg.transition=r}}function N1(){return zr().memoizedState}function FO(t,e,n){var r=qo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},P1(t))M1(e,n);else if(n=c1(t,e,n,r),n!==null){var i=nr();Si(n,t,r,i),x1(n,e,r)}}function UO(t,e,n){var r=qo(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(P1(t))M1(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Ai(a,o)){var c=e.interleaved;c===null?(i.next=i,AC(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=c1(t,e,i,r),n!==null&&(i=nr(),Si(n,t,r,i),x1(n,e,r))}}function P1(t){var e=t.alternate;return t===Nt||e!==null&&e===Nt}function M1(t,e){Xu=np=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function x1(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,uC(t,n)}}var rp={readContext:jr,useCallback:Mn,useContext:Mn,useEffect:Mn,useImperativeHandle:Mn,useInsertionEffect:Mn,useLayoutEffect:Mn,useMemo:Mn,useReducer:Mn,useRef:Mn,useState:Mn,useDebugValue:Mn,useDeferredValue:Mn,useTransition:Mn,useMutableSource:Mn,useSyncExternalStore:Mn,useId:Mn,unstable_isNewReconciler:!1},GO={readContext:jr,useCallback:function(t,e){return xi().memoizedState=[t,e===void 0?null:e],t},useContext:jr,useEffect:gb,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,gh(4194308,4,k1.bind(null,e,t),n)},useLayoutEffect:function(t,e){return gh(4194308,4,t,e)},useInsertionEffect:function(t,e){return gh(4,2,t,e)},useMemo:function(t,e){var n=xi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=xi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=FO.bind(null,Nt,t),[r.memoizedState,t]},useRef:function(t){var e=xi();return t={current:t},e.memoizedState=t},useState:mb,useDebugValue:xC,useDeferredValue:function(t){return xi().memoizedState=t},useTransition:function(){var t=mb(!1),e=t[0];return t=BO.bind(null,t[1]),xi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Nt,i=xi();if(Et){if(n===void 0)throw Error(ae(407));n=n()}else{if(n=e(),vn===null)throw Error(ae(349));Za&30||v1(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,gb(C1.bind(null,r,s,t),[t]),r.flags|=2048,wd(9,y1.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=xi(),e=vn.identifierPrefix;if(Et){var n=_s,r=Ts;n=(r&~(1<<32-Ii(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Sd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=LO++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},VO={readContext:jr,useCallback:T1,useContext:jr,useEffect:MC,useImperativeHandle:E1,useInsertionEffect:w1,useLayoutEffect:A1,useMemo:_1,useReducer:Mg,useRef:b1,useState:function(){return Mg(bd)},useDebugValue:xC,useDeferredValue:function(t){var e=zr();return R1(e,en.memoizedState,t)},useTransition:function(){var t=Mg(bd)[0],e=zr().memoizedState;return[t,e]},useMutableSource:m1,useSyncExternalStore:g1,useId:N1,unstable_isNewReconciler:!1},WO={readContext:jr,useCallback:T1,useContext:jr,useEffect:MC,useImperativeHandle:E1,useInsertionEffect:w1,useLayoutEffect:A1,useMemo:_1,useReducer:xg,useRef:b1,useState:function(){return xg(bd)},useDebugValue:xC,useDeferredValue:function(t){var e=zr();return en===null?e.memoizedState=t:R1(e,en.memoizedState,t)},useTransition:function(){var t=xg(bd)[0],e=zr().memoizedState;return[t,e]},useMutableSource:m1,useSyncExternalStore:g1,useId:N1,unstable_isNewReconciler:!1};function El(t,e){try{var n="",r=e;do n+=gD(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Dg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ey(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var HO=typeof WeakMap=="function"?WeakMap:Map;function D1(t,e,n){n=Qs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){sp||(sp=!0,uy=r),ey(t,e)},n}function O1(t,e,n){n=Qs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){ey(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){ey(t,e),typeof r!="function"&&(Yo===null?Yo=new Set([this]):Yo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function vb(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new HO;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=rL.bind(null,t,e,n),e.then(t,t))}function yb(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Cb(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Qs(-1,1),e.tag=2,Jo(n,e,1))),n.lanes|=1),t)}var ZO=fo.ReactCurrentOwner,lr=!1;function zn(t,e,n,r){e.child=t===null?h1(e,null,n,r):Al(e,t.child,n,r)}function Ib(t,e,n,r,i){n=n.render;var s=e.ref;return el(e,i),r=NC(t,e,n,r,s,i),n=PC(),t!==null&&!lr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oo(t,e,i)):(Et&&n&&yC(e),e.flags|=1,zn(t,e,r,i),e.child)}function Sb(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!VC(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,L1(t,e,s,r,i)):(t=Ih(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:md,n(o,r)&&t.ref===e.ref)return oo(t,e,i)}return e.flags|=1,t=Qo(s,r),t.ref=e.ref,t.return=e,e.child=t}function L1(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(md(s,r)&&t.ref===e.ref)if(lr=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(lr=!0);else return e.lanes=t.lanes,oo(t,e,i)}return ty(t,e,n,r,i)}function B1(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(Uc,br),br|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,mt(Uc,br),br|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,mt(Uc,br),br|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,mt(Uc,br),br|=r;return zn(t,e,i,n),e.child}function F1(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ty(t,e,n,r,i){var s=fr(n)?Wa:Gn.current;return s=bl(e,s),el(e,i),n=NC(t,e,n,r,s,i),r=PC(),t!==null&&!lr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oo(t,e,i)):(Et&&r&&yC(e),e.flags|=1,zn(t,e,n,i),e.child)}function bb(t,e,n,r,i){if(fr(n)){var s=!0;Kh(e)}else s=!1;if(el(e,i),e.stateNode===null)vh(t,e),d1(e,n,r),Qv(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=jr(l):(l=fr(n)?Wa:Gn.current,l=bl(e,l));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==l)&&hb(e,o,r,l),_o=!1;var f=e.memoizedState;o.state=f,ep(e,r,o,i),c=e.memoizedState,a!==r||f!==c||dr.current||_o?(typeof u=="function"&&(qv(e,n,u,r),c=e.memoizedState),(a=_o||fb(e,n,a,r,f,c,l))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=l,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,l1(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:Qr(e.type,a),o.props=l,d=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=jr(c):(c=fr(n)?Wa:Gn.current,c=bl(e,c));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==c)&&hb(e,o,r,c),_o=!1,f=e.memoizedState,o.state=f,ep(e,r,o,i);var p=e.memoizedState;a!==d||f!==p||dr.current||_o?(typeof h=="function"&&(qv(e,n,h,r),p=e.memoizedState),(l=_o||fb(e,n,l,r,f,p,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=c,r=l):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return ny(t,e,n,r,s,i)}function ny(t,e,n,r,i,s){F1(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&ab(e,n,!1),oo(t,e,s);r=e.stateNode,ZO.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Al(e,t.child,null,s),e.child=Al(e,null,a,s)):zn(t,e,a,s),e.memoizedState=r.state,i&&ab(e,n,!0),e.child}function U1(t){var e=t.stateNode;e.pendingContext?ob(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ob(t,e.context,!1),EC(t,e.containerInfo)}function wb(t,e,n,r,i){return wl(),IC(i),e.flags|=256,zn(t,e,n,r),e.child}var ry={dehydrated:null,treeContext:null,retryLane:0};function iy(t){return{baseLanes:t,cachePool:null,transitions:null}}function G1(t,e,n){var r=e.pendingProps,i=Tt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),mt(Tt,i&1),t===null)return Jv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=am(o,r,0,null),t=Fa(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=iy(n),e.memoizedState=ry,t):DC(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return jO(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Qo(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Qo(a,s):(s=Fa(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?iy(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=ry,r}return s=t.child,t=s.sibling,r=Qo(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function DC(t,e){return e=am({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Uf(t,e,n,r){return r!==null&&IC(r),Al(e,t.child,null,n),t=DC(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function jO(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Dg(Error(ae(422))),Uf(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=am({mode:"visible",children:r.children},i,0,null),s=Fa(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Al(e,t.child,null,o),e.child.memoizedState=iy(o),e.memoizedState=ry,s);if(!(e.mode&1))return Uf(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ae(419)),r=Dg(s,r,void 0),Uf(t,e,o,r)}if(a=(o&t.childLanes)!==0,lr||a){if(r=vn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,so(t,i),Si(r,t,i,-1))}return GC(),r=Dg(Error(ae(421))),Uf(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=iL.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,kr=Ko(i.nextSibling),Tr=e,Et=!0,di=null,t!==null&&(Br[Fr++]=Ts,Br[Fr++]=_s,Br[Fr++]=Ha,Ts=t.id,_s=t.overflow,Ha=e),e=DC(e,r.children),e.flags|=4096,e)}function Ab(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Yv(t.return,e,n)}function Og(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function V1(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(zn(t,e,r.children,n),r=Tt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ab(t,n,e);else if(t.tag===19)Ab(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(mt(Tt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&tp(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Og(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&tp(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Og(e,!0,n,null,s);break;case"together":Og(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function vh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function oo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ja|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ae(153));if(e.child!==null){for(t=e.child,n=Qo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Qo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function zO(t,e,n){switch(e.tag){case 3:U1(e),wl();break;case 5:p1(e);break;case 1:fr(e.type)&&Kh(e);break;case 4:EC(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;mt(qh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(mt(Tt,Tt.current&1),e.flags|=128,null):n&e.child.childLanes?G1(t,e,n):(mt(Tt,Tt.current&1),t=oo(t,e,n),t!==null?t.sibling:null);mt(Tt,Tt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return V1(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),mt(Tt,Tt.current),r)break;return null;case 22:case 23:return e.lanes=0,B1(t,e,n)}return oo(t,e,n)}var W1,sy,H1,Z1;W1=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};sy=function(){};H1=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Na(cs.current);var s=null;switch(n){case"input":i=Tv(t,i),r=Tv(t,r),s=[];break;case"select":i=Pt({},i,{value:void 0}),r=Pt({},r,{value:void 0}),s=[];break;case"textarea":i=Nv(t,i),r=Nv(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Xh)}Mv(n,r);var o;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(cd.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in r){var c=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(cd.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&vt("scroll",t),s||a===c||(s=[])):(s=s||[]).push(l,c))}n&&(s=s||[]).push("style",n);var l=s;(e.updateQueue=l)&&(e.flags|=4)}};Z1=function(t,e,n,r){n!==r&&(e.flags|=4)};function mu(t,e){if(!Et)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function xn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function XO(t,e,n){var r=e.pendingProps;switch(CC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xn(e),null;case 1:return fr(e.type)&&$h(),xn(e),null;case 3:return r=e.stateNode,kl(),It(dr),It(Gn),_C(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Bf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,di!==null&&(hy(di),di=null))),sy(t,e),xn(e),null;case 5:TC(e);var i=Na(Id.current);if(n=e.type,t!==null&&e.stateNode!=null)H1(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ae(166));return xn(e),null}if(t=Na(cs.current),Bf(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ui]=e,r[yd]=s,t=(e.mode&1)!==0,n){case"dialog":vt("cancel",r),vt("close",r);break;case"iframe":case"object":case"embed":vt("load",r);break;case"video":case"audio":for(i=0;i<Du.length;i++)vt(Du[i],r);break;case"source":vt("error",r);break;case"img":case"image":case"link":vt("error",r),vt("load",r);break;case"details":vt("toggle",r);break;case"input":xS(r,s),vt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},vt("invalid",r);break;case"textarea":OS(r,s),vt("invalid",r)}Mv(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Lf(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Lf(r.textContent,a,t),i=["children",""+a]):cd.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&vt("scroll",r)}switch(n){case"input":_f(r),DS(r,s,!0);break;case"textarea":_f(r),LS(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Xh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=vE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ui]=e,t[yd]=r,W1(t,e,!1,!1),e.stateNode=t;e:{switch(o=xv(n,r),n){case"dialog":vt("cancel",t),vt("close",t),i=r;break;case"iframe":case"object":case"embed":vt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Du.length;i++)vt(Du[i],t);i=r;break;case"source":vt("error",t),i=r;break;case"img":case"image":case"link":vt("error",t),vt("load",t),i=r;break;case"details":vt("toggle",t),i=r;break;case"input":xS(t,r),i=Tv(t,r),vt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Pt({},r,{value:void 0}),vt("invalid",t);break;case"textarea":OS(t,r),i=Nv(t,r),vt("invalid",t);break;default:i=r}Mv(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?IE(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&yE(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ld(t,c):typeof c=="number"&&ld(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(cd.hasOwnProperty(s)?c!=null&&s==="onScroll"&&vt("scroll",t):c!=null&&iC(t,s,c,o))}switch(n){case"input":_f(t),DS(t,r,!1);break;case"textarea":_f(t),LS(t);break;case"option":r.value!=null&&t.setAttribute("value",""+oa(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Jc(t,!!r.multiple,s,!1):r.defaultValue!=null&&Jc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Xh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return xn(e),null;case 6:if(t&&e.stateNode!=null)Z1(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ae(166));if(n=Na(Id.current),Na(cs.current),Bf(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ui]=e,(s=r.nodeValue!==n)&&(t=Tr,t!==null))switch(t.tag){case 3:Lf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Lf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ui]=e,e.stateNode=r}return xn(e),null;case 13:if(It(Tt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Et&&kr!==null&&e.mode&1&&!(e.flags&128))a1(),wl(),e.flags|=98560,s=!1;else if(s=Bf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ae(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ae(317));s[Ui]=e}else wl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;xn(e),s=!1}else di!==null&&(hy(di),di=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Tt.current&1?rn===0&&(rn=3):GC())),e.updateQueue!==null&&(e.flags|=4),xn(e),null);case 4:return kl(),sy(t,e),t===null&&gd(e.stateNode.containerInfo),xn(e),null;case 10:return wC(e.type._context),xn(e),null;case 17:return fr(e.type)&&$h(),xn(e),null;case 19:if(It(Tt),s=e.memoizedState,s===null)return xn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)mu(s,!1);else{if(rn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=tp(t),o!==null){for(e.flags|=128,mu(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return mt(Tt,Tt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ht()>Tl&&(e.flags|=128,r=!0,mu(s,!1),e.lanes=4194304)}else{if(!r)if(t=tp(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),mu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Et)return xn(e),null}else 2*Ht()-s.renderingStartTime>Tl&&n!==1073741824&&(e.flags|=128,r=!0,mu(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ht(),e.sibling=null,n=Tt.current,mt(Tt,r?n&1|2:n&1),e):(xn(e),null);case 22:case 23:return UC(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?br&1073741824&&(xn(e),e.subtreeFlags&6&&(e.flags|=8192)):xn(e),null;case 24:return null;case 25:return null}throw Error(ae(156,e.tag))}function $O(t,e){switch(CC(e),e.tag){case 1:return fr(e.type)&&$h(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return kl(),It(dr),It(Gn),_C(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return TC(e),null;case 13:if(It(Tt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ae(340));wl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return It(Tt),null;case 4:return kl(),null;case 10:return wC(e.type._context),null;case 22:case 23:return UC(),null;case 24:return null;default:return null}}var Gf=!1,On=!1,KO=typeof WeakSet=="function"?WeakSet:Set,he=null;function Fc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Lt(t,e,r)}else n.current=null}function oy(t,e,n){try{n()}catch(r){Lt(t,e,r)}}var kb=!1;function JO(t,e){if(Hv=Zh,t=$E(),vC(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,l=0,u=0,d=t,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(c=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++l===i&&(a=o),f===s&&++u===r&&(c=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zv={focusedElem:t,selectionRange:n},Zh=!1,he=e;he!==null;)if(e=he,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,he=t;else for(;he!==null;){e=he;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,y=p.memoizedState,m=e.stateNode,v=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:Qr(e.type,g),y);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(E){Lt(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,he=t;break}he=e.return}return p=kb,kb=!1,p}function $u(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&oy(e,n,s)}i=i.next}while(i!==r)}}function sm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ay(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function j1(t){var e=t.alternate;e!==null&&(t.alternate=null,j1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ui],delete e[yd],delete e[Xv],delete e[MO],delete e[xO])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function z1(t){return t.tag===5||t.tag===3||t.tag===4}function Eb(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||z1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cy(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Xh));else if(r!==4&&(t=t.child,t!==null))for(cy(t,e,n),t=t.sibling;t!==null;)cy(t,e,n),t=t.sibling}function ly(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ly(t,e,n),t=t.sibling;t!==null;)ly(t,e,n),t=t.sibling}var wn=null,ci=!1;function Co(t,e,n){for(n=n.child;n!==null;)X1(t,e,n),n=n.sibling}function X1(t,e,n){if(as&&typeof as.onCommitFiberUnmount=="function")try{as.onCommitFiberUnmount(Yp,n)}catch{}switch(n.tag){case 5:On||Fc(n,e);case 6:var r=wn,i=ci;wn=null,Co(t,e,n),wn=r,ci=i,wn!==null&&(ci?(t=wn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):wn.removeChild(n.stateNode));break;case 18:wn!==null&&(ci?(t=wn,n=n.stateNode,t.nodeType===8?_g(t.parentNode,n):t.nodeType===1&&_g(t,n),hd(t)):_g(wn,n.stateNode));break;case 4:r=wn,i=ci,wn=n.stateNode.containerInfo,ci=!0,Co(t,e,n),wn=r,ci=i;break;case 0:case 11:case 14:case 15:if(!On&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&oy(n,e,o),i=i.next}while(i!==r)}Co(t,e,n);break;case 1:if(!On&&(Fc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Lt(n,e,a)}Co(t,e,n);break;case 21:Co(t,e,n);break;case 22:n.mode&1?(On=(r=On)||n.memoizedState!==null,Co(t,e,n),On=r):Co(t,e,n);break;default:Co(t,e,n)}}function Tb(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new KO),e.forEach(function(r){var i=sL.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Kr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:wn=a.stateNode,ci=!1;break e;case 3:wn=a.stateNode.containerInfo,ci=!0;break e;case 4:wn=a.stateNode.containerInfo,ci=!0;break e}a=a.return}if(wn===null)throw Error(ae(160));X1(s,o,i),wn=null,ci=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){Lt(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)$1(e,t),e=e.sibling}function $1(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Kr(e,t),Pi(t),r&4){try{$u(3,t,t.return),sm(3,t)}catch(g){Lt(t,t.return,g)}try{$u(5,t,t.return)}catch(g){Lt(t,t.return,g)}}break;case 1:Kr(e,t),Pi(t),r&512&&n!==null&&Fc(n,n.return);break;case 5:if(Kr(e,t),Pi(t),r&512&&n!==null&&Fc(n,n.return),t.flags&32){var i=t.stateNode;try{ld(i,"")}catch(g){Lt(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&mE(i,s),xv(a,o);var l=xv(a,s);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?IE(i,d):u==="dangerouslySetInnerHTML"?yE(i,d):u==="children"?ld(i,d):iC(i,u,d,l)}switch(a){case"input":_v(i,s);break;case"textarea":gE(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?Jc(i,!!s.multiple,h,!1):f!==!!s.multiple&&(s.defaultValue!=null?Jc(i,!!s.multiple,s.defaultValue,!0):Jc(i,!!s.multiple,s.multiple?[]:"",!1))}i[yd]=s}catch(g){Lt(t,t.return,g)}}break;case 6:if(Kr(e,t),Pi(t),r&4){if(t.stateNode===null)throw Error(ae(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){Lt(t,t.return,g)}}break;case 3:if(Kr(e,t),Pi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{hd(e.containerInfo)}catch(g){Lt(t,t.return,g)}break;case 4:Kr(e,t),Pi(t);break;case 13:Kr(e,t),Pi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(BC=Ht())),r&4&&Tb(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(On=(l=On)||u,Kr(e,t),On=l):Kr(e,t),Pi(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!u&&t.mode&1)for(he=t,u=t.child;u!==null;){for(d=he=u;he!==null;){switch(f=he,h=f.child,f.tag){case 0:case 11:case 14:case 15:$u(4,f,f.return);break;case 1:Fc(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){Lt(r,n,g)}}break;case 5:Fc(f,f.return);break;case 22:if(f.memoizedState!==null){Rb(d);continue}}h!==null?(h.return=f,he=h):Rb(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,l?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=CE("display",o))}catch(g){Lt(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(g){Lt(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Kr(e,t),Pi(t),r&4&&Tb(t);break;case 21:break;default:Kr(e,t),Pi(t)}}function Pi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(z1(n)){var r=n;break e}n=n.return}throw Error(ae(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ld(i,""),r.flags&=-33);var s=Eb(t);ly(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Eb(t);cy(t,a,o);break;default:throw Error(ae(161))}}catch(c){Lt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function YO(t,e,n){he=t,K1(t)}function K1(t,e,n){for(var r=(t.mode&1)!==0;he!==null;){var i=he,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Gf;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||On;a=Gf;var l=On;if(Gf=o,(On=c)&&!l)for(he=i;he!==null;)o=he,c=o.child,o.tag===22&&o.memoizedState!==null?Nb(i):c!==null?(c.return=o,he=c):Nb(i);for(;s!==null;)he=s,K1(s),s=s.sibling;he=i,Gf=a,On=l}_b(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,he=s):_b(t)}}function _b(t){for(;he!==null;){var e=he;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:On||sm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!On)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Qr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&db(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}db(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&hd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}On||e.flags&512&&ay(e)}catch(f){Lt(e,e.return,f)}}if(e===t){he=null;break}if(n=e.sibling,n!==null){n.return=e.return,he=n;break}he=e.return}}function Rb(t){for(;he!==null;){var e=he;if(e===t){he=null;break}var n=e.sibling;if(n!==null){n.return=e.return,he=n;break}he=e.return}}function Nb(t){for(;he!==null;){var e=he;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{sm(4,e)}catch(c){Lt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Lt(e,i,c)}}var s=e.return;try{ay(e)}catch(c){Lt(e,s,c)}break;case 5:var o=e.return;try{ay(e)}catch(c){Lt(e,o,c)}}}catch(c){Lt(e,e.return,c)}if(e===t){he=null;break}var a=e.sibling;if(a!==null){a.return=e.return,he=a;break}he=e.return}}var qO=Math.ceil,ip=fo.ReactCurrentDispatcher,OC=fo.ReactCurrentOwner,Zr=fo.ReactCurrentBatchConfig,Xe=0,vn=null,$t=null,En=0,br=0,Uc=pa(0),rn=0,Ad=null,ja=0,om=0,LC=0,Ku=null,or=null,BC=0,Tl=1/0,Cs=null,sp=!1,uy=null,Yo=null,Vf=!1,Fo=null,op=0,Ju=0,dy=null,yh=-1,Ch=0;function nr(){return Xe&6?Ht():yh!==-1?yh:yh=Ht()}function qo(t){return t.mode&1?Xe&2&&En!==0?En&-En:OO.transition!==null?(Ch===0&&(Ch=ME()),Ch):(t=et,t!==0||(t=window.event,t=t===void 0?16:UE(t.type)),t):1}function Si(t,e,n,r){if(50<Ju)throw Ju=0,dy=null,Error(ae(185));Qd(t,n,r),(!(Xe&2)||t!==vn)&&(t===vn&&(!(Xe&2)&&(om|=n),rn===4&&Do(t,En)),hr(t,r),n===1&&Xe===0&&!(e.mode&1)&&(Tl=Ht()+500,nm&&ma()))}function hr(t,e){var n=t.callbackNode;OD(t,e);var r=Hh(t,t===vn?En:0);if(r===0)n!==null&&US(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&US(n),e===1)t.tag===0?DO(Pb.bind(null,t)):i1(Pb.bind(null,t)),NO(function(){!(Xe&6)&&ma()}),n=null;else{switch(xE(r)){case 1:n=lC;break;case 4:n=NE;break;case 16:n=Wh;break;case 536870912:n=PE;break;default:n=Wh}n=rT(n,J1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function J1(t,e){if(yh=-1,Ch=0,Xe&6)throw Error(ae(327));var n=t.callbackNode;if(tl()&&t.callbackNode!==n)return null;var r=Hh(t,t===vn?En:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ap(t,r);else{e=r;var i=Xe;Xe|=2;var s=q1();(vn!==t||En!==e)&&(Cs=null,Tl=Ht()+500,Ba(t,e));do try{tL();break}catch(a){Y1(t,a)}while(!0);bC(),ip.current=s,Xe=i,$t!==null?e=0:(vn=null,En=0,e=rn)}if(e!==0){if(e===2&&(i=Fv(t),i!==0&&(r=i,e=fy(t,i))),e===1)throw n=Ad,Ba(t,0),Do(t,r),hr(t,Ht()),n;if(e===6)Do(t,r);else{if(i=t.current.alternate,!(r&30)&&!QO(i)&&(e=ap(t,r),e===2&&(s=Fv(t),s!==0&&(r=s,e=fy(t,s))),e===1))throw n=Ad,Ba(t,0),Do(t,r),hr(t,Ht()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ae(345));case 2:Ea(t,or,Cs);break;case 3:if(Do(t,r),(r&130023424)===r&&(e=BC+500-Ht(),10<e)){if(Hh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){nr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=zv(Ea.bind(null,t,or,Cs),e);break}Ea(t,or,Cs);break;case 4:if(Do(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Ii(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Ht()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*qO(r/1960))-r,10<r){t.timeoutHandle=zv(Ea.bind(null,t,or,Cs),r);break}Ea(t,or,Cs);break;case 5:Ea(t,or,Cs);break;default:throw Error(ae(329))}}}return hr(t,Ht()),t.callbackNode===n?J1.bind(null,t):null}function fy(t,e){var n=Ku;return t.current.memoizedState.isDehydrated&&(Ba(t,e).flags|=256),t=ap(t,e),t!==2&&(e=or,or=n,e!==null&&hy(e)),t}function hy(t){or===null?or=t:or.push.apply(or,t)}function QO(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ai(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Do(t,e){for(e&=~LC,e&=~om,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ii(e),r=1<<n;t[n]=-1,e&=~r}}function Pb(t){if(Xe&6)throw Error(ae(327));tl();var e=Hh(t,0);if(!(e&1))return hr(t,Ht()),null;var n=ap(t,e);if(t.tag!==0&&n===2){var r=Fv(t);r!==0&&(e=r,n=fy(t,r))}if(n===1)throw n=Ad,Ba(t,0),Do(t,e),hr(t,Ht()),n;if(n===6)throw Error(ae(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ea(t,or,Cs),hr(t,Ht()),null}function FC(t,e){var n=Xe;Xe|=1;try{return t(e)}finally{Xe=n,Xe===0&&(Tl=Ht()+500,nm&&ma())}}function za(t){Fo!==null&&Fo.tag===0&&!(Xe&6)&&tl();var e=Xe;Xe|=1;var n=Zr.transition,r=et;try{if(Zr.transition=null,et=1,t)return t()}finally{et=r,Zr.transition=n,Xe=e,!(Xe&6)&&ma()}}function UC(){br=Uc.current,It(Uc)}function Ba(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,RO(n)),$t!==null)for(n=$t.return;n!==null;){var r=n;switch(CC(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&$h();break;case 3:kl(),It(dr),It(Gn),_C();break;case 5:TC(r);break;case 4:kl();break;case 13:It(Tt);break;case 19:It(Tt);break;case 10:wC(r.type._context);break;case 22:case 23:UC()}n=n.return}if(vn=t,$t=t=Qo(t.current,null),En=br=e,rn=0,Ad=null,LC=om=ja=0,or=Ku=null,Ra!==null){for(e=0;e<Ra.length;e++)if(n=Ra[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ra=null}return t}function Y1(t,e){do{var n=$t;try{if(bC(),mh.current=rp,np){for(var r=Nt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}np=!1}if(Za=0,pn=en=Nt=null,Xu=!1,Sd=0,OC.current=null,n===null||n.return===null){rn=1,Ad=e,$t=null;break}e:{var s=t,o=n.return,a=n,c=e;if(e=En,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=yb(o);if(h!==null){h.flags&=-257,Cb(h,o,a,s,e),h.mode&1&&vb(s,l,e),e=h,c=l;var p=e.updateQueue;if(p===null){var g=new Set;g.add(c),e.updateQueue=g}else p.add(c);break e}else{if(!(e&1)){vb(s,l,e),GC();break e}c=Error(ae(426))}}else if(Et&&a.mode&1){var y=yb(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Cb(y,o,a,s,e),IC(El(c,a));break e}}s=c=El(c,a),rn!==4&&(rn=2),Ku===null?Ku=[s]:Ku.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=D1(s,c,e);ub(s,m);break e;case 1:a=c;var v=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Yo===null||!Yo.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var E=O1(s,a,e);ub(s,E);break e}}s=s.return}while(s!==null)}eT(n)}catch(A){e=A,$t===n&&n!==null&&($t=n=n.return);continue}break}while(!0)}function q1(){var t=ip.current;return ip.current=rp,t===null?rp:t}function GC(){(rn===0||rn===3||rn===2)&&(rn=4),vn===null||!(ja&268435455)&&!(om&268435455)||Do(vn,En)}function ap(t,e){var n=Xe;Xe|=2;var r=q1();(vn!==t||En!==e)&&(Cs=null,Ba(t,e));do try{eL();break}catch(i){Y1(t,i)}while(!0);if(bC(),Xe=n,ip.current=r,$t!==null)throw Error(ae(261));return vn=null,En=0,rn}function eL(){for(;$t!==null;)Q1($t)}function tL(){for(;$t!==null&&!ED();)Q1($t)}function Q1(t){var e=nT(t.alternate,t,br);t.memoizedProps=t.pendingProps,e===null?eT(t):$t=e,OC.current=null}function eT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=$O(n,e),n!==null){n.flags&=32767,$t=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{rn=6,$t=null;return}}else if(n=XO(n,e,br),n!==null){$t=n;return}if(e=e.sibling,e!==null){$t=e;return}$t=e=t}while(e!==null);rn===0&&(rn=5)}function Ea(t,e,n){var r=et,i=Zr.transition;try{Zr.transition=null,et=1,nL(t,e,n,r)}finally{Zr.transition=i,et=r}return null}function nL(t,e,n,r){do tl();while(Fo!==null);if(Xe&6)throw Error(ae(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ae(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(LD(t,s),t===vn&&($t=vn=null,En=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Vf||(Vf=!0,rT(Wh,function(){return tl(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Zr.transition,Zr.transition=null;var o=et;et=1;var a=Xe;Xe|=4,OC.current=null,JO(t,n),$1(n,t),bO(Zv),Zh=!!Hv,Zv=Hv=null,t.current=n,YO(n),TD(),Xe=a,et=o,Zr.transition=s}else t.current=n;if(Vf&&(Vf=!1,Fo=t,op=i),s=t.pendingLanes,s===0&&(Yo=null),ND(n.stateNode),hr(t,Ht()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(sp)throw sp=!1,t=uy,uy=null,t;return op&1&&t.tag!==0&&tl(),s=t.pendingLanes,s&1?t===dy?Ju++:(Ju=0,dy=t):Ju=0,ma(),null}function tl(){if(Fo!==null){var t=xE(op),e=Zr.transition,n=et;try{if(Zr.transition=null,et=16>t?16:t,Fo===null)var r=!1;else{if(t=Fo,Fo=null,op=0,Xe&6)throw Error(ae(331));var i=Xe;for(Xe|=4,he=t.current;he!==null;){var s=he,o=s.child;if(he.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(he=l;he!==null;){var u=he;switch(u.tag){case 0:case 11:case 15:$u(8,u,s)}var d=u.child;if(d!==null)d.return=u,he=d;else for(;he!==null;){u=he;var f=u.sibling,h=u.return;if(j1(u),u===l){he=null;break}if(f!==null){f.return=h,he=f;break}he=h}}}var p=s.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}he=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,he=o;else e:for(;he!==null;){if(s=he,s.flags&2048)switch(s.tag){case 0:case 11:case 15:$u(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,he=m;break e}he=s.return}}var v=t.current;for(he=v;he!==null;){o=he;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,he=S;else e:for(o=v;he!==null;){if(a=he,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:sm(9,a)}}catch(A){Lt(a,a.return,A)}if(a===o){he=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,he=E;break e}he=a.return}}if(Xe=i,ma(),as&&typeof as.onPostCommitFiberRoot=="function")try{as.onPostCommitFiberRoot(Yp,t)}catch{}r=!0}return r}finally{et=n,Zr.transition=e}}return!1}function Mb(t,e,n){e=El(n,e),e=D1(t,e,1),t=Jo(t,e,1),e=nr(),t!==null&&(Qd(t,1,e),hr(t,e))}function Lt(t,e,n){if(t.tag===3)Mb(t,t,n);else for(;e!==null;){if(e.tag===3){Mb(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Yo===null||!Yo.has(r))){t=El(n,t),t=O1(e,t,1),e=Jo(e,t,1),t=nr(),e!==null&&(Qd(e,1,t),hr(e,t));break}}e=e.return}}function rL(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=nr(),t.pingedLanes|=t.suspendedLanes&n,vn===t&&(En&n)===n&&(rn===4||rn===3&&(En&130023424)===En&&500>Ht()-BC?Ba(t,0):LC|=n),hr(t,e)}function tT(t,e){e===0&&(t.mode&1?(e=Pf,Pf<<=1,!(Pf&130023424)&&(Pf=4194304)):e=1);var n=nr();t=so(t,e),t!==null&&(Qd(t,e,n),hr(t,n))}function iL(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),tT(t,n)}function sL(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ae(314))}r!==null&&r.delete(e),tT(t,n)}var nT;nT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||dr.current)lr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return lr=!1,zO(t,e,n);lr=!!(t.flags&131072)}else lr=!1,Et&&e.flags&1048576&&s1(e,Yh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;vh(t,e),t=e.pendingProps;var i=bl(e,Gn.current);el(e,n),i=NC(null,e,r,t,i,n);var s=PC();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,fr(r)?(s=!0,Kh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,kC(e),i.updater=rm,e.stateNode=i,i._reactInternals=e,Qv(e,r,t,n),e=ny(null,e,r,!0,s,n)):(e.tag=0,Et&&s&&yC(e),zn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(vh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=aL(r),t=Qr(r,t),i){case 0:e=ty(null,e,r,t,n);break e;case 1:e=bb(null,e,r,t,n);break e;case 11:e=Ib(null,e,r,t,n);break e;case 14:e=Sb(null,e,r,Qr(r.type,t),n);break e}throw Error(ae(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qr(r,i),ty(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qr(r,i),bb(t,e,r,i,n);case 3:e:{if(U1(e),t===null)throw Error(ae(387));r=e.pendingProps,s=e.memoizedState,i=s.element,l1(t,e),ep(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=El(Error(ae(423)),e),e=wb(t,e,r,n,i);break e}else if(r!==i){i=El(Error(ae(424)),e),e=wb(t,e,r,n,i);break e}else for(kr=Ko(e.stateNode.containerInfo.firstChild),Tr=e,Et=!0,di=null,n=h1(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(wl(),r===i){e=oo(t,e,n);break e}zn(t,e,r,n)}e=e.child}return e;case 5:return p1(e),t===null&&Jv(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,jv(r,i)?o=null:s!==null&&jv(r,s)&&(e.flags|=32),F1(t,e),zn(t,e,o,n),e.child;case 6:return t===null&&Jv(e),null;case 13:return G1(t,e,n);case 4:return EC(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Al(e,null,r,n):zn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qr(r,i),Ib(t,e,r,i,n);case 7:return zn(t,e,e.pendingProps,n),e.child;case 8:return zn(t,e,e.pendingProps.children,n),e.child;case 12:return zn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,mt(qh,r._currentValue),r._currentValue=o,s!==null)if(Ai(s.value,o)){if(s.children===i.children&&!dr.current){e=oo(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Qs(-1,n&-n),c.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Yv(s.return,n,e),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ae(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Yv(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}zn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,el(e,n),i=jr(i),r=r(i),e.flags|=1,zn(t,e,r,n),e.child;case 14:return r=e.type,i=Qr(r,e.pendingProps),i=Qr(r.type,i),Sb(t,e,r,i,n);case 15:return L1(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qr(r,i),vh(t,e),e.tag=1,fr(r)?(t=!0,Kh(e)):t=!1,el(e,n),d1(e,r,i),Qv(e,r,i,n),ny(null,e,r,!0,t,n);case 19:return V1(t,e,n);case 22:return B1(t,e,n)}throw Error(ae(156,e.tag))};function rT(t,e){return RE(t,e)}function oL(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gr(t,e,n,r){return new oL(t,e,n,r)}function VC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function aL(t){if(typeof t=="function")return VC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===oC)return 11;if(t===aC)return 14}return 2}function Qo(t,e){var n=t.alternate;return n===null?(n=Gr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ih(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")VC(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Rc:return Fa(n.children,i,s,e);case sC:o=8,i|=8;break;case wv:return t=Gr(12,n,e,i|2),t.elementType=wv,t.lanes=s,t;case Av:return t=Gr(13,n,e,i),t.elementType=Av,t.lanes=s,t;case kv:return t=Gr(19,n,e,i),t.elementType=kv,t.lanes=s,t;case fE:return am(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case uE:o=10;break e;case dE:o=9;break e;case oC:o=11;break e;case aC:o=14;break e;case To:o=16,r=null;break e}throw Error(ae(130,t==null?t:typeof t,""))}return e=Gr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Fa(t,e,n,r){return t=Gr(7,t,r,e),t.lanes=n,t}function am(t,e,n,r){return t=Gr(22,t,r,e),t.elementType=fE,t.lanes=n,t.stateNode={isHidden:!1},t}function Lg(t,e,n){return t=Gr(6,t,null,e),t.lanes=n,t}function Bg(t,e,n){return e=Gr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function cL(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vg(0),this.expirationTimes=vg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function WC(t,e,n,r,i,s,o,a,c){return t=new cL(t,e,n,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Gr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},kC(s),t}function lL(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_c,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function iT(t){if(!t)return aa;t=t._reactInternals;e:{if(oc(t)!==t||t.tag!==1)throw Error(ae(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(fr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ae(171))}if(t.tag===1){var n=t.type;if(fr(n))return r1(t,n,e)}return e}function sT(t,e,n,r,i,s,o,a,c){return t=WC(n,r,!0,t,i,s,o,a,c),t.context=iT(null),n=t.current,r=nr(),i=qo(n),s=Qs(r,i),s.callback=e??null,Jo(n,s,i),t.current.lanes=i,Qd(t,i,r),hr(t,r),t}function cm(t,e,n,r){var i=e.current,s=nr(),o=qo(i);return n=iT(n),e.context===null?e.context=n:e.pendingContext=n,e=Qs(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Jo(i,e,o),t!==null&&(Si(t,i,o,s),ph(t,i,o)),o}function cp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xb(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function HC(t,e){xb(t,e),(t=t.alternate)&&xb(t,e)}function uL(){return null}var oT=typeof reportError=="function"?reportError:function(t){console.error(t)};function ZC(t){this._internalRoot=t}lm.prototype.render=ZC.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ae(409));cm(t,e,null,null)};lm.prototype.unmount=ZC.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;za(function(){cm(null,t,null,null)}),e[io]=null}};function lm(t){this._internalRoot=t}lm.prototype.unstable_scheduleHydration=function(t){if(t){var e=LE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<xo.length&&e!==0&&e<xo[n].priority;n++);xo.splice(n,0,t),n===0&&FE(t)}};function jC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function um(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Db(){}function dL(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var l=cp(o);s.call(l)}}var o=sT(e,r,t,0,null,!1,!1,"",Db);return t._reactRootContainer=o,t[io]=o.current,gd(t.nodeType===8?t.parentNode:t),za(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=cp(c);a.call(l)}}var c=WC(t,0,!1,null,null,!1,!1,"",Db);return t._reactRootContainer=c,t[io]=c.current,gd(t.nodeType===8?t.parentNode:t),za(function(){cm(e,c,n,r)}),c}function dm(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=cp(o);a.call(c)}}cm(e,o,t,i)}else o=dL(n,e,t,i,r);return cp(o)}DE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=xu(e.pendingLanes);n!==0&&(uC(e,n|1),hr(e,Ht()),!(Xe&6)&&(Tl=Ht()+500,ma()))}break;case 13:za(function(){var r=so(t,1);if(r!==null){var i=nr();Si(r,t,1,i)}}),HC(t,1)}};dC=function(t){if(t.tag===13){var e=so(t,134217728);if(e!==null){var n=nr();Si(e,t,134217728,n)}HC(t,134217728)}};OE=function(t){if(t.tag===13){var e=qo(t),n=so(t,e);if(n!==null){var r=nr();Si(n,t,e,r)}HC(t,e)}};LE=function(){return et};BE=function(t,e){var n=et;try{return et=t,e()}finally{et=n}};Ov=function(t,e,n){switch(e){case"input":if(_v(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=tm(r);if(!i)throw Error(ae(90));pE(r),_v(r,i)}}}break;case"textarea":gE(t,n);break;case"select":e=n.value,e!=null&&Jc(t,!!n.multiple,e,!1)}};wE=FC;AE=za;var fL={usingClientEntryPoint:!1,Events:[tf,xc,tm,SE,bE,FC]},gu={findFiberByHostInstance:_a,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},hL={bundleType:gu.bundleType,version:gu.version,rendererPackageName:gu.rendererPackageName,rendererConfig:gu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=TE(t),t===null?null:t.stateNode},findFiberByHostInstance:gu.findFiberByHostInstance||uL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wf.isDisabled&&Wf.supportsFiber)try{Yp=Wf.inject(hL),as=Wf}catch{}}Pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fL;Pr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jC(e))throw Error(ae(200));return lL(t,e,null,n)};Pr.createRoot=function(t,e){if(!jC(t))throw Error(ae(299));var n=!1,r="",i=oT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=WC(t,1,!1,null,null,n,!1,r,i),t[io]=e.current,gd(t.nodeType===8?t.parentNode:t),new ZC(e)};Pr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ae(188)):(t=Object.keys(t).join(","),Error(ae(268,t)));return t=TE(e),t=t===null?null:t.stateNode,t};Pr.flushSync=function(t){return za(t)};Pr.hydrate=function(t,e,n){if(!um(e))throw Error(ae(200));return dm(null,t,e,!0,n)};Pr.hydrateRoot=function(t,e,n){if(!jC(t))throw Error(ae(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=oT;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=sT(e,null,t,1,n??null,i,!1,s,o),t[io]=e.current,gd(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new lm(e)};Pr.render=function(t,e,n){if(!um(e))throw Error(ae(200));return dm(null,t,e,!1,n)};Pr.unmountComponentAtNode=function(t){if(!um(t))throw Error(ae(40));return t._reactRootContainer?(za(function(){dm(null,null,t,!1,function(){t._reactRootContainer=null,t[io]=null})}),!0):!1};Pr.unstable_batchedUpdates=FC;Pr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!um(n))throw Error(ae(200));if(t==null||t._reactInternals===void 0)throw Error(ae(38));return dm(t,e,n,!1,r)};Pr.version="18.2.0-next-9e3b772b8-20220608";function aT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(aT)}catch(t){console.error(t)}}aT(),sE.exports=Pr;var zC=sE.exports;const pL=Yd(zC),mL=$k({__proto__:null,default:pL},[zC]);var Ob=zC;Sv.createRoot=Ob.createRoot,Sv.hydrateRoot=Ob.hydrateRoot;/**
 * @remix-run/router v1.14.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bt(){return Bt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Bt.apply(this,arguments)}var Gt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Gt||(Gt={}));const Lb="popstate";function gL(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return kd("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:rf(i)}return yL(e,n,null,t)}function Ze(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Xa(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function vL(){return Math.random().toString(36).substr(2,8)}function Bb(t,e){return{usr:t.state,key:t.key,idx:e}}function kd(t,e,n,r){return n===void 0&&(n=null),Bt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ho(e):e,{state:n,key:e&&e.key||r||vL()})}function rf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ho(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function yL(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=Gt.Pop,c=null,l=u();l==null&&(l=0,o.replaceState(Bt({},o.state,{idx:l}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=Gt.Pop;let y=u(),m=y==null?null:y-l;l=y,c&&c({action:a,location:g.location,delta:m})}function f(y,m){a=Gt.Push;let v=kd(g.location,y,m);n&&n(v,y),l=u()+1;let S=Bb(v,l),E=g.createHref(v);try{o.pushState(S,"",E)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;i.location.assign(E)}s&&c&&c({action:a,location:g.location,delta:1})}function h(y,m){a=Gt.Replace;let v=kd(g.location,y,m);n&&n(v,y),l=u();let S=Bb(v,l),E=g.createHref(v);o.replaceState(S,"",E),s&&c&&c({action:a,location:g.location,delta:0})}function p(y){let m=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof y=="string"?y:rf(y);return Ze(m,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,m)}let g={get action(){return a},get location(){return t(i,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(Lb,d),c=y,()=>{i.removeEventListener(Lb,d),c=null}},createHref(y){return e(i,y)},createURL:p,encodeLocation(y){let m=p(y);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:f,replace:h,go(y){return o.go(y)}};return g}var Ot;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Ot||(Ot={}));const CL=new Set(["lazy","caseSensitive","path","id","index","children"]);function IL(t){return t.index===!0}function py(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((i,s)=>{let o=[...n,s],a=typeof i.id=="string"?i.id:o.join("-");if(Ze(i.index!==!0||!i.children,"Cannot specify children on an index route"),Ze(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),IL(i)){let c=Bt({},i,e(i),{id:a});return r[a]=c,c}else{let c=Bt({},i,e(i),{id:a,children:void 0});return r[a]=c,i.children&&(c.children=py(i.children,e,o,r)),c}})}function Gc(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?ho(e):e,i=sf(r.pathname||"/",n);if(i==null)return null;let s=cT(t);bL(s);let o=null;for(let a=0;o==null&&a<s.length;++a)o=PL(s[a],DL(i));return o}function SL(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function cT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let c={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(Ze(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let l=Ua([r,c.relativePath]),u=n.concat(c);s.children&&s.children.length>0&&(Ze(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),cT(s.children,e,u,l)),!(s.path==null&&!s.index)&&e.push({path:l,score:RL(l,s.index),routesMeta:u})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let c of lT(s.path))i(s,o,c)}),e}function lT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=lT(r.join("/")),a=[];return a.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&a.push(...o),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function bL(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:NL(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const wL=/^:\w+$/,AL=3,kL=2,EL=1,TL=10,_L=-2,Fb=t=>t==="*";function RL(t,e){let n=t.split("/"),r=n.length;return n.some(Fb)&&(r+=_L),e&&(r+=kL),n.filter(i=>!Fb(i)).reduce((i,s)=>i+(wL.test(s)?AL:s===""?EL:TL),r)}function NL(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function PL(t,e){let{routesMeta:n}=t,r={},i="/",s=[];for(let o=0;o<n.length;++o){let a=n[o],c=o===n.length-1,l=i==="/"?e:e.slice(i.length)||"/",u=ML({path:a.relativePath,caseSensitive:a.caseSensitive,end:c},l);if(!u)return null;Object.assign(r,u.params);let d=a.route;s.push({params:r,pathname:Ua([i,u.pathname]),pathnameBase:GL(Ua([i,u.pathnameBase])),route:d}),u.pathnameBase!=="/"&&(i=Ua([i,u.pathnameBase]))}return s}function ML(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=xL(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((l,u,d)=>{let{paramName:f,isOptional:h}=u;if(f==="*"){let g=a[d]||"";o=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?l[f]=void 0:l[f]=OL(p||"",f),l},{}),pathname:s,pathnameBase:o,pattern:t}}function xL(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Xa(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(o,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function DL(t){try{return decodeURI(t)}catch(e){return Xa(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function OL(t,e){try{return decodeURIComponent(t)}catch(n){return Xa(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function sf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function LL(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?ho(t):t;return{pathname:n?n.startsWith("/")?n:BL(n,e):e,search:VL(r),hash:WL(i)}}function BL(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Fg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function uT(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function FL(t,e){let n=uT(t);return e?n.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function UL(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=ho(t):(i=Bt({},t),Ze(!i.pathname||!i.pathname.includes("?"),Fg("?","pathname","search",i)),Ze(!i.pathname||!i.pathname.includes("#"),Fg("#","pathname","hash",i)),Ze(!i.search||!i.search.includes("#"),Fg("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?e[d]:"/"}let c=LL(i,a),l=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}const Ua=t=>t.join("/").replace(/\/\/+/g,"/"),GL=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),VL=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,WL=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class XC{constructor(e,n,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function dT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const fT=["post","put","patch","delete"],HL=new Set(fT),ZL=["get",...fT],jL=new Set(ZL),zL=new Set([301,302,303,307,308]),XL=new Set([307,308]),Ug={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},$L={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},vu={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},hT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,KL=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),pT="remix-router-transitions";function JL(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;Ze(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let F=t.detectErrorBoundary;i=Z=>({hasErrorBoundary:F(Z)})}else i=KL;let s={},o=py(t.routes,i,void 0,s),a,c=t.basename||"/",l=Bt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1},t.future),u=null,d=new Set,f=null,h=null,p=null,g=t.hydrationData!=null,y=Gc(o,t.history.location,c),m=null;if(y==null){let F=Lr(404,{pathname:t.history.location.pathname}),{matches:Z,route:ee}=zb(o);y=Z,m={[ee.id]:F}}let v,S=y.some(F=>F.route.lazy),E=y.some(F=>F.route.loader);if(S)v=!1;else if(!E)v=!0;else if(l.v7_partialHydration){let F=t.hydrationData?t.hydrationData.loaderData:null,Z=t.hydrationData?t.hydrationData.errors:null;v=y.every(ee=>ee.route.loader&&ee.route.loader.hydrate!==!0&&(F&&F[ee.route.id]!==void 0||Z&&Z[ee.route.id]!==void 0))}else v=t.hydrationData!=null;let A,b={historyAction:t.history.action,location:t.history.location,matches:y,initialized:v,navigation:Ug,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||m,fetchers:new Map,blockers:new Map},k=Gt.Pop,_=!1,N,M=!1,D=new Map,B=null,G=!1,V=!1,z=[],X=[],te=new Map,H=0,K=-1,ie=new Map,$=new Set,se=new Map,be=new Map,we=new Set,me=new Map,ke=new Map,Ue=!1;function ce(){if(u=t.history.listen(F=>{let{action:Z,location:ee,delta:de}=F;if(Ue){Ue=!1;return}Xa(ke.size===0||de!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ve=it({currentLocation:b.location,nextLocation:ee,historyAction:Z});if(ve&&de!=null){Ue=!0,t.history.go(de*-1),rt(ve,{state:"blocked",location:ee,proceed(){rt(ve,{state:"proceeding",proceed:void 0,reset:void 0,location:ee}),t.history.go(de)},reset(){let Ve=new Map(b.blockers);Ve.set(ve,vu),wt({blockers:Ve})}});return}return le(Z,ee)}),n){aB(e,D);let F=()=>cB(e,D);e.addEventListener("pagehide",F),B=()=>e.removeEventListener("pagehide",F)}return b.initialized||le(Gt.Pop,b.location,{initialHydration:!0}),A}function xt(){u&&u(),B&&B(),d.clear(),N&&N.abort(),b.fetchers.forEach((F,Z)=>T(Z)),b.blockers.forEach((F,Z)=>Pe(Z))}function cn(F){return d.add(F),()=>d.delete(F)}function wt(F,Z){Z===void 0&&(Z={}),b=Bt({},b,F);let ee=[],de=[];l.v7_fetcherPersist&&b.fetchers.forEach((ve,Ve)=>{ve.state==="idle"&&(we.has(Ve)?de.push(Ve):ee.push(Ve))}),[...d].forEach(ve=>ve(b,{deletedFetchers:de,unstable_viewTransitionOpts:Z.viewTransitionOpts,unstable_flushSync:Z.flushSync===!0})),l.v7_fetcherPersist&&(ee.forEach(ve=>b.fetchers.delete(ve)),de.forEach(ve=>T(ve)))}function Cn(F,Z,ee){var de,ve;let{flushSync:Ve}=ee===void 0?{}:ee,Re=b.actionData!=null&&b.navigation.formMethod!=null&&li(b.navigation.formMethod)&&b.navigation.state==="loading"&&((de=F.state)==null?void 0:de._isRedirect)!==!0,Te;Z.actionData?Object.keys(Z.actionData).length>0?Te=Z.actionData:Te=null:Re?Te=b.actionData:Te=null;let Ie=Z.loaderData?jb(b.loaderData,Z.loaderData,Z.matches||[],Z.errors):b.loaderData,He=b.blockers;He.size>0&&(He=new Map(He),He.forEach((dt,Sn)=>He.set(Sn,vu)));let ln=_===!0||b.navigation.formMethod!=null&&li(b.navigation.formMethod)&&((ve=F.state)==null?void 0:ve._isRedirect)!==!0;a&&(o=a,a=void 0),G||k===Gt.Pop||(k===Gt.Push?t.history.push(F,F.state):k===Gt.Replace&&t.history.replace(F,F.state));let Oe;if(k===Gt.Pop){let dt=D.get(b.location.pathname);dt&&dt.has(F.pathname)?Oe={currentLocation:b.location,nextLocation:F}:D.has(F.pathname)&&(Oe={currentLocation:F,nextLocation:b.location})}else if(M){let dt=D.get(b.location.pathname);dt?dt.add(F.pathname):(dt=new Set([F.pathname]),D.set(b.location.pathname,dt)),Oe={currentLocation:b.location,nextLocation:F}}wt(Bt({},Z,{actionData:Te,loaderData:Ie,historyAction:k,location:F,initialized:!0,navigation:Ug,revalidation:"idle",restoreScrollPosition:ES(F,Z.matches||b.matches),preventScrollReset:ln,blockers:He}),{viewTransitionOpts:Oe,flushSync:Ve===!0}),k=Gt.Pop,_=!1,M=!1,G=!1,V=!1,z=[],X=[]}async function Kt(F,Z){if(typeof F=="number"){t.history.go(F);return}let ee=my(b.location,b.matches,c,l.v7_prependBasename,F,l.v7_relativeSplatPath,Z==null?void 0:Z.fromRouteId,Z==null?void 0:Z.relative),{path:de,submission:ve,error:Ve}=Ub(l.v7_normalizeFormMethod,!1,ee,Z),Re=b.location,Te=kd(b.location,de,Z&&Z.state);Te=Bt({},Te,t.history.encodeLocation(Te));let Ie=Z&&Z.replace!=null?Z.replace:void 0,He=Gt.Push;Ie===!0?He=Gt.Replace:Ie===!1||ve!=null&&li(ve.formMethod)&&ve.formAction===b.location.pathname+b.location.search&&(He=Gt.Replace);let ln=Z&&"preventScrollReset"in Z?Z.preventScrollReset===!0:void 0,Oe=(Z&&Z.unstable_flushSync)===!0,dt=it({currentLocation:Re,nextLocation:Te,historyAction:He});if(dt){rt(dt,{state:"blocked",location:Te,proceed(){rt(dt,{state:"proceeding",proceed:void 0,reset:void 0,location:Te}),Kt(F,Z)},reset(){let Sn=new Map(b.blockers);Sn.set(dt,vu),wt({blockers:Sn})}});return}return await le(He,Te,{submission:ve,pendingError:Ve,preventScrollReset:ln,replace:Z&&Z.replace,enableViewTransition:Z&&Z.unstable_viewTransition,flushSync:Oe})}function In(){if(Ut(),wt({revalidation:"loading"}),b.navigation.state!=="submitting"){if(b.navigation.state==="idle"){le(b.historyAction,b.location,{startUninterruptedRevalidation:!0});return}le(k||b.historyAction,b.navigation.location,{overrideNavigation:b.navigation})}}async function le(F,Z,ee){N&&N.abort(),N=null,k=F,G=(ee&&ee.startUninterruptedRevalidation)===!0,Lx(b.location,b.matches),_=(ee&&ee.preventScrollReset)===!0,M=(ee&&ee.enableViewTransition)===!0;let de=a||o,ve=ee&&ee.overrideNavigation,Ve=Gc(de,Z,c),Re=(ee&&ee.flushSync)===!0;if(!Ve){let Sn=Lr(404,{pathname:Z.pathname}),{matches:Dr,route:un}=zb(de);ut(),Cn(Z,{matches:Dr,loaderData:{},errors:{[un.id]:Sn}},{flushSync:Re});return}if(b.initialized&&!V&&tB(b.location,Z)&&!(ee&&ee.submission&&li(ee.submission.formMethod))){Cn(Z,{matches:Ve},{flushSync:Re});return}N=new AbortController;let Te=Cu(t.history,Z,N.signal,ee&&ee.submission),Ie,He;if(ee&&ee.pendingError)He={[Yu(Ve).route.id]:ee.pendingError};else if(ee&&ee.submission&&li(ee.submission.formMethod)){let Sn=await Ce(Te,Z,ee.submission,Ve,{replace:ee.replace,flushSync:Re});if(Sn.shortCircuited)return;Ie=Sn.pendingActionData,He=Sn.pendingActionError,ve=Gg(Z,ee.submission),Re=!1,Te=new Request(Te.url,{signal:Te.signal})}let{shortCircuited:ln,loaderData:Oe,errors:dt}=await Ye(Te,Z,Ve,ve,ee&&ee.submission,ee&&ee.fetcherSubmission,ee&&ee.replace,ee&&ee.initialHydration===!0,Re,Ie,He);ln||(N=null,Cn(Z,Bt({matches:Ve},Ie?{actionData:Ie}:{},{loaderData:Oe,errors:dt})))}async function Ce(F,Z,ee,de,ve){ve===void 0&&(ve={}),Ut();let Ve=sB(Z,ee);wt({navigation:Ve},{flushSync:ve.flushSync===!0});let Re,Te=vy(de,Z);if(!Te.route.action&&!Te.route.lazy)Re={type:Ot.error,error:Lr(405,{method:F.method,pathname:Z.pathname,routeId:Te.route.id})};else if(Re=await yu("action",F,Te,de,s,i,c,l.v7_relativeSplatPath),F.signal.aborted)return{shortCircuited:!0};if(Ma(Re)){let Ie;return ve&&ve.replace!=null?Ie=ve.replace:Ie=Re.location===b.location.pathname+b.location.search,await _e(b,Re,{submission:ee,replace:Ie}),{shortCircuited:!0}}if(Vc(Re)){let Ie=Yu(de,Te.route.id);return(ve&&ve.replace)!==!0&&(k=Gt.Push),{pendingActionData:{},pendingActionError:{[Ie.route.id]:Re.error}}}if(Pa(Re))throw Lr(400,{type:"defer-action"});return{pendingActionData:{[Te.route.id]:Re.data}}}async function Ye(F,Z,ee,de,ve,Ve,Re,Te,Ie,He,ln){let Oe=de||Gg(Z,ve),dt=ve||Ve||Kb(Oe),Sn=a||o,[Dr,un]=Gb(t.history,b,ee,dt,Z,l.v7_partialHydration&&Te===!0,V,z,X,we,se,$,Sn,c,He,ln);if(ut(st=>!(ee&&ee.some(At=>At.route.id===st))||Dr&&Dr.some(At=>At.route.id===st)),K=++H,Dr.length===0&&un.length===0){let st=O();return Cn(Z,Bt({matches:ee,loaderData:{},errors:ln||null},He?{actionData:He}:{},st?{fetchers:new Map(b.fetchers)}:{}),{flushSync:Ie}),{shortCircuited:!0}}if(!G&&(!l.v7_partialHydration||!Te)){un.forEach(At=>{let Ni=b.fetchers.get(At.key),Af=Iu(void 0,Ni?Ni.data:void 0);b.fetchers.set(At.key,Af)});let st=He||b.actionData;wt(Bt({navigation:Oe},st?Object.keys(st).length===0?{actionData:null}:{actionData:st}:{},un.length>0?{fetchers:new Map(b.fetchers)}:{}),{flushSync:Ie})}un.forEach(st=>{te.has(st.key)&&I(st.key),st.controller&&te.set(st.key,st.controller)});let gc=()=>un.forEach(st=>I(st.key));N&&N.signal.addEventListener("abort",gc);let{results:ag,loaderResults:vc,fetcherResults:yo}=await Ge(b.matches,ee,Dr,un,F);if(F.signal.aborted)return{shortCircuited:!0};N&&N.signal.removeEventListener("abort",gc),un.forEach(st=>te.delete(st.key));let wa=Xb(ag);if(wa){if(wa.idx>=Dr.length){let st=un[wa.idx-Dr.length].key;$.add(st)}return await _e(b,wa.result,{replace:Re}),{shortCircuited:!0}}let{loaderData:cg,errors:lg}=Zb(b,ee,Dr,vc,ln,un,yo,me);me.forEach((st,At)=>{st.subscribe(Ni=>{(Ni||st.done)&&me.delete(At)})});let ug=O(),yc=W(K),wf=ug||yc||un.length>0;return Bt({loaderData:cg,errors:lg},wf?{fetchers:new Map(b.fetchers)}:{})}function $e(F,Z,ee,de){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");te.has(F)&&I(F);let ve=(de&&de.unstable_flushSync)===!0,Ve=a||o,Re=my(b.location,b.matches,c,l.v7_prependBasename,ee,l.v7_relativeSplatPath,Z,de==null?void 0:de.relative),Te=Gc(Ve,Re,c);if(!Te){jt(F,Z,Lr(404,{pathname:Re}),{flushSync:ve});return}let{path:Ie,submission:He,error:ln}=Ub(l.v7_normalizeFormMethod,!0,Re,de);if(ln){jt(F,Z,ln,{flushSync:ve});return}let Oe=vy(Te,Ie);if(_=(de&&de.preventScrollReset)===!0,He&&li(He.formMethod)){ue(F,Z,Ie,Oe,Te,ve,He);return}se.set(F,{routeId:Z,path:Ie}),Le(F,Z,Ie,Oe,Te,ve,He)}async function ue(F,Z,ee,de,ve,Ve,Re){if(Ut(),se.delete(F),!de.route.action&&!de.route.lazy){let At=Lr(405,{method:Re.formMethod,pathname:ee,routeId:Z});jt(F,Z,At,{flushSync:Ve});return}let Te=b.fetchers.get(F);De(F,oB(Re,Te),{flushSync:Ve});let Ie=new AbortController,He=Cu(t.history,ee,Ie.signal,Re);te.set(F,Ie);let ln=H,Oe=await yu("action",He,de,ve,s,i,c,l.v7_relativeSplatPath);if(He.signal.aborted){te.get(F)===Ie&&te.delete(F);return}if(l.v7_fetcherPersist&&we.has(F)){if(Ma(Oe)||Vc(Oe)){De(F,wo(void 0));return}}else{if(Ma(Oe))if(te.delete(F),K>ln){De(F,wo(void 0));return}else return $.add(F),De(F,Iu(Re)),_e(b,Oe,{fetcherSubmission:Re});if(Vc(Oe)){jt(F,Z,Oe.error);return}}if(Pa(Oe))throw Lr(400,{type:"defer-action"});let dt=b.navigation.location||b.location,Sn=Cu(t.history,dt,Ie.signal),Dr=a||o,un=b.navigation.state!=="idle"?Gc(Dr,b.navigation.location,c):b.matches;Ze(un,"Didn't find any matches after fetcher action");let gc=++H;ie.set(F,gc);let ag=Iu(Re,Oe.data);b.fetchers.set(F,ag);let[vc,yo]=Gb(t.history,b,un,Re,dt,!1,V,z,X,we,se,$,Dr,c,{[de.route.id]:Oe.data},void 0);yo.filter(At=>At.key!==F).forEach(At=>{let Ni=At.key,Af=b.fetchers.get(Ni),Fx=Iu(void 0,Af?Af.data:void 0);b.fetchers.set(Ni,Fx),te.has(Ni)&&I(Ni),At.controller&&te.set(Ni,At.controller)}),wt({fetchers:new Map(b.fetchers)});let wa=()=>yo.forEach(At=>I(At.key));Ie.signal.addEventListener("abort",wa);let{results:cg,loaderResults:lg,fetcherResults:ug}=await Ge(b.matches,un,vc,yo,Sn);if(Ie.signal.aborted)return;Ie.signal.removeEventListener("abort",wa),ie.delete(F),te.delete(F),yo.forEach(At=>te.delete(At.key));let yc=Xb(cg);if(yc){if(yc.idx>=vc.length){let At=yo[yc.idx-vc.length].key;$.add(At)}return _e(b,yc.result)}let{loaderData:wf,errors:st}=Zb(b,b.matches,vc,lg,void 0,yo,ug,me);if(b.fetchers.has(F)){let At=wo(Oe.data);b.fetchers.set(F,At)}W(gc),b.navigation.state==="loading"&&gc>K?(Ze(k,"Expected pending action"),N&&N.abort(),Cn(b.navigation.location,{matches:un,loaderData:wf,errors:st,fetchers:new Map(b.fetchers)})):(wt({errors:st,loaderData:jb(b.loaderData,wf,un,st),fetchers:new Map(b.fetchers)}),V=!1)}async function Le(F,Z,ee,de,ve,Ve,Re){let Te=b.fetchers.get(F);De(F,Iu(Re,Te?Te.data:void 0),{flushSync:Ve});let Ie=new AbortController,He=Cu(t.history,ee,Ie.signal);te.set(F,Ie);let ln=H,Oe=await yu("loader",He,de,ve,s,i,c,l.v7_relativeSplatPath);if(Pa(Oe)&&(Oe=await vT(Oe,He.signal,!0)||Oe),te.get(F)===Ie&&te.delete(F),!He.signal.aborted){if(we.has(F)){De(F,wo(void 0));return}if(Ma(Oe))if(K>ln){De(F,wo(void 0));return}else{$.add(F),await _e(b,Oe);return}if(Vc(Oe)){jt(F,Z,Oe.error);return}Ze(!Pa(Oe),"Unhandled fetcher deferred data"),De(F,wo(Oe.data))}}async function _e(F,Z,ee){let{submission:de,fetcherSubmission:ve,replace:Ve}=ee===void 0?{}:ee;Z.revalidate&&(V=!0);let Re=kd(F.location,Z.location,{_isRedirect:!0});if(Ze(Re,"Expected a location on the redirect navigation"),n){let dt=!1;if(Z.reloadDocument)dt=!0;else if(hT.test(Z.location)){const Sn=t.history.createURL(Z.location);dt=Sn.origin!==e.location.origin||sf(Sn.pathname,c)==null}if(dt){Ve?e.location.replace(Z.location):e.location.assign(Z.location);return}}N=null;let Te=Ve===!0?Gt.Replace:Gt.Push,{formMethod:Ie,formAction:He,formEncType:ln}=F.navigation;!de&&!ve&&Ie&&He&&ln&&(de=Kb(F.navigation));let Oe=de||ve;if(XL.has(Z.status)&&Oe&&li(Oe.formMethod))await le(Te,Re,{submission:Bt({},Oe,{formAction:Z.location}),preventScrollReset:_});else{let dt=Gg(Re,de);await le(Te,Re,{overrideNavigation:dt,fetcherSubmission:ve,preventScrollReset:_})}}async function Ge(F,Z,ee,de,ve){let Ve=await Promise.all([...ee.map(Ie=>yu("loader",ve,Ie,Z,s,i,c,l.v7_relativeSplatPath)),...de.map(Ie=>Ie.matches&&Ie.match&&Ie.controller?yu("loader",Cu(t.history,Ie.path,Ie.controller.signal),Ie.match,Ie.matches,s,i,c,l.v7_relativeSplatPath):{type:Ot.error,error:Lr(404,{pathname:Ie.path})})]),Re=Ve.slice(0,ee.length),Te=Ve.slice(ee.length);return await Promise.all([$b(F,ee,Re,Re.map(()=>ve.signal),!1,b.loaderData),$b(F,de.map(Ie=>Ie.match),Te,de.map(Ie=>Ie.controller?Ie.controller.signal:null),!0)]),{results:Ve,loaderResults:Re,fetcherResults:Te}}function Ut(){V=!0,z.push(...ut()),se.forEach((F,Z)=>{te.has(Z)&&(X.push(Z),I(Z))})}function De(F,Z,ee){ee===void 0&&(ee={}),b.fetchers.set(F,Z),wt({fetchers:new Map(b.fetchers)},{flushSync:(ee&&ee.flushSync)===!0})}function jt(F,Z,ee,de){de===void 0&&(de={});let ve=Yu(b.matches,Z);T(F),wt({errors:{[ve.route.id]:ee},fetchers:new Map(b.fetchers)},{flushSync:(de&&de.flushSync)===!0})}function mc(F){return l.v7_fetcherPersist&&(be.set(F,(be.get(F)||0)+1),we.has(F)&&we.delete(F)),b.fetchers.get(F)||$L}function T(F){let Z=b.fetchers.get(F);te.has(F)&&!(Z&&Z.state==="loading"&&ie.has(F))&&I(F),se.delete(F),ie.delete(F),$.delete(F),we.delete(F),b.fetchers.delete(F)}function C(F){if(l.v7_fetcherPersist){let Z=(be.get(F)||0)-1;Z<=0?(be.delete(F),we.add(F)):be.set(F,Z)}else T(F);wt({fetchers:new Map(b.fetchers)})}function I(F){let Z=te.get(F);Ze(Z,"Expected fetch controller: "+F),Z.abort(),te.delete(F)}function P(F){for(let Z of F){let ee=mc(Z),de=wo(ee.data);b.fetchers.set(Z,de)}}function O(){let F=[],Z=!1;for(let ee of $){let de=b.fetchers.get(ee);Ze(de,"Expected fetcher: "+ee),de.state==="loading"&&($.delete(ee),F.push(ee),Z=!0)}return P(F),Z}function W(F){let Z=[];for(let[ee,de]of ie)if(de<F){let ve=b.fetchers.get(ee);Ze(ve,"Expected fetcher: "+ee),ve.state==="loading"&&(I(ee),ie.delete(ee),Z.push(ee))}return P(Z),Z.length>0}function Q(F,Z){let ee=b.blockers.get(F)||vu;return ke.get(F)!==Z&&ke.set(F,Z),ee}function Pe(F){b.blockers.delete(F),ke.delete(F)}function rt(F,Z){let ee=b.blockers.get(F)||vu;Ze(ee.state==="unblocked"&&Z.state==="blocked"||ee.state==="blocked"&&Z.state==="blocked"||ee.state==="blocked"&&Z.state==="proceeding"||ee.state==="blocked"&&Z.state==="unblocked"||ee.state==="proceeding"&&Z.state==="unblocked","Invalid blocker state transition: "+ee.state+" -> "+Z.state);let de=new Map(b.blockers);de.set(F,Z),wt({blockers:de})}function it(F){let{currentLocation:Z,nextLocation:ee,historyAction:de}=F;if(ke.size===0)return;ke.size>1&&Xa(!1,"A router only supports one blocker at a time");let ve=Array.from(ke.entries()),[Ve,Re]=ve[ve.length-1],Te=b.blockers.get(Ve);if(!(Te&&Te.state==="proceeding")&&Re({currentLocation:Z,nextLocation:ee,historyAction:de}))return Ve}function ut(F){let Z=[];return me.forEach((ee,de)=>{(!F||F(de))&&(ee.cancel(),Z.push(de),me.delete(de))}),Z}function qe(F,Z,ee){if(f=F,p=Z,h=ee||null,!g&&b.navigation===Ug){g=!0;let de=ES(b.location,b.matches);de!=null&&wt({restoreScrollPosition:de})}return()=>{f=null,p=null,h=null}}function kS(F,Z){return h&&h(F,Z.map(de=>SL(de,b.loaderData)))||F.key}function Lx(F,Z){if(f&&p){let ee=kS(F,Z);f[ee]=p()}}function ES(F,Z){if(f){let ee=kS(F,Z),de=f[ee];if(typeof de=="number")return de}return null}function Bx(F){s={},a=py(F,i,void 0,s)}return A={get basename(){return c},get future(){return l},get state(){return b},get routes(){return o},get window(){return e},initialize:ce,subscribe:cn,enableScrollRestoration:qe,navigate:Kt,fetch:$e,revalidate:In,createHref:F=>t.history.createHref(F),encodeLocation:F=>t.history.encodeLocation(F),getFetcher:mc,deleteFetcher:C,dispose:xt,getBlocker:Q,deleteBlocker:Pe,_internalFetchControllers:te,_internalActiveDeferreds:me,_internalSetRoutes:Bx},A}function YL(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function my(t,e,n,r,i,s,o,a){let c,l;if(o){c=[];for(let d of e)if(c.push(d),d.route.id===o){l=d;break}}else c=e,l=e[e.length-1];let u=UL(i||".",FL(c,s),sf(t.pathname,n)||t.pathname,a==="path");return i==null&&(u.search=t.search,u.hash=t.hash),(i==null||i===""||i===".")&&l&&l.route.index&&!$C(u.search)&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:Ua([n,u.pathname])),rf(u)}function Ub(t,e,n,r){if(!r||!YL(r))return{path:n};if(r.formMethod&&!iB(r.formMethod))return{path:n,error:Lr(405,{method:r.formMethod})};let i=()=>({path:n,error:Lr(400,{type:"invalid-body"})}),s=r.formMethod||"get",o=t?s.toUpperCase():s.toLowerCase(),a=gT(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!li(o))return i();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[g,y]=p;return""+h+g+"="+y+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!li(o))return i();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return i()}}}Ze(typeof FormData=="function","FormData is not available in this environment");let c,l;if(r.formData)c=gy(r.formData),l=r.formData;else if(r.body instanceof FormData)c=gy(r.body),l=r.body;else if(r.body instanceof URLSearchParams)c=r.body,l=Hb(c);else if(r.body==null)c=new URLSearchParams,l=new FormData;else try{c=new URLSearchParams(r.body),l=Hb(c)}catch{return i()}let u={formMethod:o,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:l,json:void 0,text:void 0};if(li(u.formMethod))return{path:n,submission:u};let d=ho(n);return e&&d.search&&$C(d.search)&&c.append("index",""),d.search="?"+c,{path:rf(d),submission:u}}function qL(t,e){let n=t;if(e){let r=t.findIndex(i=>i.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function Gb(t,e,n,r,i,s,o,a,c,l,u,d,f,h,p,g){let y=g?Object.values(g)[0]:p?Object.values(p)[0]:void 0,m=t.createURL(e.location),v=t.createURL(i),S=g?Object.keys(g)[0]:void 0,A=qL(n,S).filter((k,_)=>{let{route:N}=k;if(N.lazy)return!0;if(N.loader==null)return!1;if(s)return N.loader.hydrate?!0:e.loaderData[N.id]===void 0&&(!e.errors||e.errors[N.id]===void 0);if(QL(e.loaderData,e.matches[_],k)||a.some(B=>B===k.route.id))return!0;let M=e.matches[_],D=k;return Vb(k,Bt({currentUrl:m,currentParams:M.params,nextUrl:v,nextParams:D.params},r,{actionResult:y,defaultShouldRevalidate:o||m.pathname+m.search===v.pathname+v.search||m.search!==v.search||mT(M,D)}))}),b=[];return u.forEach((k,_)=>{if(s||!n.some(G=>G.route.id===k.routeId)||l.has(_))return;let N=Gc(f,k.path,h);if(!N){b.push({key:_,routeId:k.routeId,path:k.path,matches:null,match:null,controller:null});return}let M=e.fetchers.get(_),D=vy(N,k.path),B=!1;d.has(_)?B=!1:c.includes(_)?B=!0:M&&M.state!=="idle"&&M.data===void 0?B=o:B=Vb(D,Bt({currentUrl:m,currentParams:e.matches[e.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params},r,{actionResult:y,defaultShouldRevalidate:o})),B&&b.push({key:_,routeId:k.routeId,path:k.path,matches:N,match:D,controller:new AbortController})}),[A,b]}function QL(t,e,n){let r=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return r||i}function mT(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function Vb(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function Wb(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let i=n[t.id];Ze(i,"No route found in manifest");let s={};for(let o in r){let c=i[o]!==void 0&&o!=="hasErrorBoundary";Xa(!c,'Route "'+i.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!c&&!CL.has(o)&&(s[o]=r[o])}Object.assign(i,s),Object.assign(i,Bt({},e(i),{lazy:void 0}))}async function yu(t,e,n,r,i,s,o,a,c){c===void 0&&(c={});let l,u,d,f=g=>{let y,m=new Promise((v,S)=>y=S);return d=()=>y(),e.signal.addEventListener("abort",d),Promise.race([g({request:e,params:n.params,context:c.requestContext}),m])};try{let g=n.route[t];if(n.route.lazy)if(g){let y,m=await Promise.all([f(g).catch(v=>{y=v}),Wb(n.route,s,i)]);if(y)throw y;u=m[0]}else if(await Wb(n.route,s,i),g=n.route[t],g)u=await f(g);else if(t==="action"){let y=new URL(e.url),m=y.pathname+y.search;throw Lr(405,{method:e.method,pathname:m,routeId:n.route.id})}else return{type:Ot.data,data:void 0};else if(g)u=await f(g);else{let y=new URL(e.url),m=y.pathname+y.search;throw Lr(404,{pathname:m})}Ze(u!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(g){l=Ot.error,u=g}finally{d&&e.signal.removeEventListener("abort",d)}if(rB(u)){let g=u.status;if(zL.has(g)){let m=u.headers.get("Location");if(Ze(m,"Redirects returned/thrown from loaders/actions must have a Location header"),!hT.test(m))m=my(new URL(e.url),r.slice(0,r.indexOf(n)+1),o,!0,m,a);else if(!c.isStaticRequest){let v=new URL(e.url),S=m.startsWith("//")?new URL(v.protocol+m):new URL(m),E=sf(S.pathname,o)!=null;S.origin===v.origin&&E&&(m=S.pathname+S.search+S.hash)}if(c.isStaticRequest)throw u.headers.set("Location",m),u;return{type:Ot.redirect,status:g,location:m,revalidate:u.headers.get("X-Remix-Revalidate")!==null,reloadDocument:u.headers.get("X-Remix-Reload-Document")!==null}}if(c.isRouteRequest)throw{type:l===Ot.error?Ot.error:Ot.data,response:u};let y;try{let m=u.headers.get("Content-Type");m&&/\bapplication\/json\b/.test(m)?y=await u.json():y=await u.text()}catch(m){return{type:Ot.error,error:m}}return l===Ot.error?{type:l,error:new XC(g,u.statusText,y),headers:u.headers}:{type:Ot.data,data:y,statusCode:u.status,headers:u.headers}}if(l===Ot.error)return{type:l,error:u};if(nB(u)){var h,p;return{type:Ot.deferred,deferredData:u,statusCode:(h=u.init)==null?void 0:h.status,headers:((p=u.init)==null?void 0:p.headers)&&new Headers(u.init.headers)}}return{type:Ot.data,data:u}}function Cu(t,e,n,r){let i=t.createURL(gT(e)).toString(),s={signal:n};if(r&&li(r.formMethod)){let{formMethod:o,formEncType:a}=r;s.method=o.toUpperCase(),a==="application/json"?(s.headers=new Headers({"Content-Type":a}),s.body=JSON.stringify(r.json)):a==="text/plain"?s.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?s.body=gy(r.formData):s.body=r.formData}return new Request(i,s)}function gy(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function Hb(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function eB(t,e,n,r,i){let s={},o=null,a,c=!1,l={};return n.forEach((u,d)=>{let f=e[d].route.id;if(Ze(!Ma(u),"Cannot handle redirect results in processLoaderData"),Vc(u)){let h=Yu(t,f),p=u.error;r&&(p=Object.values(r)[0],r=void 0),o=o||{},o[h.route.id]==null&&(o[h.route.id]=p),s[f]=void 0,c||(c=!0,a=dT(u.error)?u.error.status:500),u.headers&&(l[f]=u.headers)}else Pa(u)?(i.set(f,u.deferredData),s[f]=u.deferredData.data):s[f]=u.data,u.statusCode!=null&&u.statusCode!==200&&!c&&(a=u.statusCode),u.headers&&(l[f]=u.headers)}),r&&(o=r,s[Object.keys(r)[0]]=void 0),{loaderData:s,errors:o,statusCode:a||200,loaderHeaders:l}}function Zb(t,e,n,r,i,s,o,a){let{loaderData:c,errors:l}=eB(e,n,r,i,a);for(let u=0;u<s.length;u++){let{key:d,match:f,controller:h}=s[u];Ze(o!==void 0&&o[u]!==void 0,"Did not find corresponding fetcher result");let p=o[u];if(!(h&&h.signal.aborted))if(Vc(p)){let g=Yu(t.matches,f==null?void 0:f.route.id);l&&l[g.route.id]||(l=Bt({},l,{[g.route.id]:p.error})),t.fetchers.delete(d)}else if(Ma(p))Ze(!1,"Unhandled fetcher revalidation redirect");else if(Pa(p))Ze(!1,"Unhandled fetcher deferred data");else{let g=wo(p.data);t.fetchers.set(d,g)}}return{loaderData:c,errors:l}}function jb(t,e,n,r){let i=Bt({},e);for(let s of n){let o=s.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(i[o]=e[o]):t[o]!==void 0&&s.route.loader&&(i[o]=t[o]),r&&r.hasOwnProperty(o))break}return i}function Yu(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function zb(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Lr(t,e){let{pathname:n,routeId:r,method:i,type:s}=e===void 0?{}:e,o="Unknown Server Error",a="Unknown @remix-run/router error";return t===400?(o="Bad Request",i&&n&&r?a="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":s==="defer-action"?a="defer() is not supported in actions":s==="invalid-body"&&(a="Unable to encode submission body")):t===403?(o="Forbidden",a='Route "'+r+'" does not match URL "'+n+'"'):t===404?(o="Not Found",a='No route matches URL "'+n+'"'):t===405&&(o="Method Not Allowed",i&&n&&r?a="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(a='Invalid request method "'+i.toUpperCase()+'"')),new XC(t||500,o,new Error(a),!0)}function Xb(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(Ma(n))return{result:n,idx:e}}}function gT(t){let e=typeof t=="string"?ho(t):t;return rf(Bt({},e,{hash:""}))}function tB(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function Pa(t){return t.type===Ot.deferred}function Vc(t){return t.type===Ot.error}function Ma(t){return(t&&t.type)===Ot.redirect}function nB(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function rB(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function iB(t){return jL.has(t.toLowerCase())}function li(t){return HL.has(t.toLowerCase())}async function $b(t,e,n,r,i,s){for(let o=0;o<n.length;o++){let a=n[o],c=e[o];if(!c)continue;let l=t.find(d=>d.route.id===c.route.id),u=l!=null&&!mT(l,c)&&(s&&s[c.route.id])!==void 0;if(Pa(a)&&(i||u)){let d=r[o];Ze(d,"Expected an AbortSignal for revalidating fetcher deferred result"),await vT(a,d,i).then(f=>{f&&(n[o]=f||n[o])})}}}async function vT(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Ot.data,data:t.deferredData.unwrappedData}}catch(i){return{type:Ot.error,error:i}}return{type:Ot.data,data:t.deferredData.data}}}function $C(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function vy(t,e){let n=typeof e=="string"?ho(e).search:e.search;if(t[t.length-1].route.index&&$C(n||""))return t[t.length-1];let r=uT(t);return r[r.length-1]}function Kb(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:s,json:o}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:s,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function Gg(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function sB(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Iu(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function oB(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function wo(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function aB(t,e){try{let n=t.sessionStorage.getItem(pT);if(n){let r=JSON.parse(n);for(let[i,s]of Object.entries(r||{}))s&&Array.isArray(s)&&e.set(i,new Set(s||[]))}}catch{}}function cB(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(pT,JSON.stringify(n))}catch(r){Xa(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lp(){return lp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lp.apply(this,arguments)}const yT=w.createContext(null),CT=w.createContext(null),IT=w.createContext(null),fm=w.createContext(null),hm=w.createContext({outlet:null,matches:[],isDataRoute:!1}),ST=w.createContext(null);function KC(){return w.useContext(fm)!=null}function bT(){return KC()||Ze(!1),w.useContext(fm).location}function lB(t,e,n,r){KC()||Ze(!1);let{navigator:i}=w.useContext(IT),{matches:s}=w.useContext(hm),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let l=bT(),u;if(e){var d;let y=typeof e=="string"?ho(e):e;c==="/"||(d=y.pathname)!=null&&d.startsWith(c)||Ze(!1),u=y}else u=l;let f=u.pathname||"/",h=c==="/"?f:f.slice(c.length)||"/",p=Gc(t,{pathname:h}),g=pB(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:Ua([c,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Ua([c,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,n,r);return e&&g?w.createElement(fm.Provider,{value:{location:lp({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Gt.Pop}},g):g}function uB(){let t=yB(),e=dT(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),n?w.createElement("pre",{style:i},n):null,s)}const dB=w.createElement(uB,null);class fB extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(hm.Provider,{value:this.props.routeContext},w.createElement(ST.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function hB(t){let{routeContext:e,match:n,children:r}=t,i=w.useContext(yT);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(hm.Provider,{value:e},r)}function pB(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id]));u>=0||Ze(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=u),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){c=!0,l>=0?o=o.slice(0,l+1):o=[o[0]];break}}}return o.reduceRight((u,d,f)=>{let h,p=!1,g=null,y=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,g=d.route.errorElement||dB,c&&(l<0&&f===0?(CB("route-fallback",!1),p=!0,y=null):l===f&&(p=!0,y=d.route.hydrateFallbackElement||null)));let m=e.concat(o.slice(0,f+1)),v=()=>{let S;return h?S=g:p?S=y:d.route.Component?S=w.createElement(d.route.Component,null):d.route.element?S=d.route.element:S=u,w.createElement(hB,{match:d,routeContext:{outlet:u,matches:m,isDataRoute:n!=null},children:S})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?w.createElement(fB,{location:n.location,revalidation:n.revalidation,component:g,error:h,children:v(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):v()},null)}var yy=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(yy||{});function mB(t){let e=w.useContext(CT);return e||Ze(!1),e}function gB(t){let e=w.useContext(hm);return e||Ze(!1),e}function vB(t){let e=gB(),n=e.matches[e.matches.length-1];return n.route.id||Ze(!1),n.route.id}function yB(){var t;let e=w.useContext(ST),n=mB(yy.UseRouteError),r=vB(yy.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}const Jb={};function CB(t,e,n){!e&&!Jb[t]&&(Jb[t]=!0)}function IB(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Gt.Pop,navigator:s,static:o=!1,future:a}=t;KC()&&Ze(!1);let c=e.replace(/^\/*/,"/"),l=w.useMemo(()=>({basename:c,navigator:s,static:o,future:lp({v7_relativeSplatPath:!1},a)}),[c,a,s,o]);typeof r=="string"&&(r=ho(r));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,g=w.useMemo(()=>{let y=sf(u,c);return y==null?null:{location:{pathname:y,search:d,hash:f,state:h,key:p},navigationType:i}},[c,u,d,f,h,p,i]);return g==null?null:w.createElement(IT.Provider,{value:l},w.createElement(fm.Provider,{children:n,value:g}))}new Promise(()=>{});function SB(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:w.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:w.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:w.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function up(){return up=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},up.apply(this,arguments)}function bB(t,e){return JL({basename:e==null?void 0:e.basename,future:up({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:gL({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||wB(),routes:t,mapRouteProperties:SB,window:e==null?void 0:e.window}).initialize()}function wB(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=up({},e,{errors:AB(e.errors)})),e}function AB(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new XC(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let o=new s(i.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let s=new Error(i.message);s.stack="",n[r]=s}}else n[r]=i;return n}const kB=w.createContext({isTransitioning:!1}),EB=w.createContext(new Map),TB="startTransition",Yb=iD[TB],_B="flushSync",qb=mL[_B];function RB(t){Yb?Yb(t):t()}function Su(t){qb?qb(t):t()}class NB{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function PB(t){let{fallbackElement:e,router:n,future:r}=t,[i,s]=w.useState(n.state),[o,a]=w.useState(),[c,l]=w.useState({isTransitioning:!1}),[u,d]=w.useState(),[f,h]=w.useState(),[p,g]=w.useState(),y=w.useRef(new Map),{v7_startTransition:m}=r||{},v=w.useCallback(k=>{m?RB(k):k()},[m]),S=w.useCallback((k,_)=>{let{deletedFetchers:N,unstable_flushSync:M,unstable_viewTransitionOpts:D}=_;N.forEach(G=>y.current.delete(G)),k.fetchers.forEach((G,V)=>{G.data!==void 0&&y.current.set(V,G.data)});let B=n.window==null||typeof n.window.document.startViewTransition!="function";if(!D||B){M?Su(()=>s(k)):v(()=>s(k));return}if(M){Su(()=>{f&&(u&&u.resolve(),f.skipTransition()),l({isTransitioning:!0,flushSync:!0,currentLocation:D.currentLocation,nextLocation:D.nextLocation})});let G=n.window.document.startViewTransition(()=>{Su(()=>s(k))});G.finished.finally(()=>{Su(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})})}),Su(()=>h(G));return}f?(u&&u.resolve(),f.skipTransition(),g({state:k,currentLocation:D.currentLocation,nextLocation:D.nextLocation})):(a(k),l({isTransitioning:!0,flushSync:!1,currentLocation:D.currentLocation,nextLocation:D.nextLocation}))},[n.window,f,u,y,v]);w.useLayoutEffect(()=>n.subscribe(S),[n,S]),w.useEffect(()=>{c.isTransitioning&&!c.flushSync&&d(new NB)},[c]),w.useEffect(()=>{if(u&&o&&n.window){let k=o,_=u.promise,N=n.window.document.startViewTransition(async()=>{v(()=>s(k)),await _});N.finished.finally(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})}),h(N)}},[v,o,u,n.window]),w.useEffect(()=>{u&&o&&i.location.key===o.location.key&&u.resolve()},[u,f,i.location,o]),w.useEffect(()=>{!c.isTransitioning&&p&&(a(p.state),l({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),g(void 0))},[c.isTransitioning,p]),w.useEffect(()=>{},[]);let E=w.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:k=>n.navigate(k),push:(k,_,N)=>n.navigate(k,{state:_,preventScrollReset:N==null?void 0:N.preventScrollReset}),replace:(k,_,N)=>n.navigate(k,{replace:!0,state:_,preventScrollReset:N==null?void 0:N.preventScrollReset})}),[n]),A=n.basename||"/",b=w.useMemo(()=>({router:n,navigator:E,static:!1,basename:A}),[n,E,A]);return w.createElement(w.Fragment,null,w.createElement(yT.Provider,{value:b},w.createElement(CT.Provider,{value:i},w.createElement(EB.Provider,{value:y.current},w.createElement(kB.Provider,{value:c},w.createElement(IB,{basename:A,location:i.location,navigationType:i.historyAction,navigator:E,future:{v7_relativeSplatPath:n.future.v7_relativeSplatPath}},i.initialized||n.future.v7_partialHydration?w.createElement(MB,{routes:n.routes,future:n.future,state:i}):e))))),null)}function MB(t){let{routes:e,future:n,state:r}=t;return lB(e,void 0,r,n)}var Qb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Qb||(Qb={}));var ew;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(ew||(ew={}));const wT=t=>{const e=typeof t=="function",n=w.useRef(t);w.useEffect(()=>{n.current=t}),w.useEffect(()=>{if(e){const r=i=>{const s=n.current(i);if(typeof s=="string")return i.preventDefault(),i.returnValue=s;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])};var tw=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function xB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Io=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],DB=function(){tw(t,null,[{key:"escapeForHtml",value:function(n){return new t().escapeForHtml(n)}},{key:"linkify",value:function(n){return new t().linkify(n)}},{key:"ansiToHtml",value:function(n,r){return new t().ansiToHtml(n,r)}},{key:"ansiToJson",value:function(n,r){return new t().ansiToJson(n,r)}},{key:"ansiToText",value:function(n){return new t().ansiToText(n)}}]);function t(){xB(this,t),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return tw(t,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var n=0;n<2;++n)for(var r=0;r<8;++r)this.PALETTE_COLORS.push(Io[n][r].color);for(var i=[0,95,135,175,215,255],s=function(f,h,p){return i[f]+", "+i[h]+", "+i[p]},o=0;o<6;++o)for(var a=0;a<6;++a)for(var c=0;c<6;++c)this.PALETTE_COLORS.push(s(o,a,c));for(var l=8,u=0;u<24;++u,l+=10)this.PALETTE_COLORS.push(s(l,l,l))}},{key:"escapeForHtml",value:function(n){return n.replace(/[&<>\"]/gm,function(r){return r=="&"?"&amp;":r=='"'?"&quot;":r=="<"?"&lt;":r==">"?"&gt;":""})}},{key:"linkify",value:function(n){return n.replace(/(https?:\/\/[^\s]+)/gm,function(r){return'<a href="'+r+'">'+r+"</a>"})}},{key:"ansiToHtml",value:function(n,r){return this.process(n,r,!0)}},{key:"ansiToJson",value:function(n,r){return r=r||{},r.json=!0,r.clearLine=!1,this.process(n,r,!0)}},{key:"ansiToText",value:function(n){return this.process(n,{},!1)}},{key:"process",value:function(n,r,i){var s=this,o=this,a=n.split(/\033\[/),c=a.shift();r==null&&(r={}),r.clearLine=/\r/.test(n);var l=a.map(function(d){return s.processChunk(d,r,i)});if(r&&r.json){var u=o.processChunkJson("");return u.content=c,u.clearLine=r.clearLine,l.unshift(u),r.remove_empty&&(l=l.filter(function(d){return!d.isEmpty()})),l}else l.unshift(c);return l.join("")}},{key:"processChunkJson",value:function(n,r,i){r=typeof r>"u"?{}:r;var s=r.use_classes=typeof r.use_classes<"u"&&r.use_classes,o=r.key=s?"class":"color",a={content:n,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:r.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!a.content}},c=n.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!c)return a;a.content=c[4];var l=c[2].split(";");if(c[1]!==""||c[3]!=="m"||!i)return a;for(var u=this;l.length>0;){var d=l.shift(),f=parseInt(d);if(isNaN(f)||f===0)u.fg=u.bg=null,u.decorations=[];else if(f===1)u.decorations.push("bold");else if(f===2)u.decorations.push("dim");else if(f===3)u.decorations.push("italic");else if(f===4)u.decorations.push("underline");else if(f===5)u.decorations.push("blink");else if(f===7)u.decorations.push("reverse");else if(f===8)u.decorations.push("hidden");else if(f===9)u.decorations.push("strikethrough");else if(f===21)u.removeDecoration("bold");else if(f===22)u.removeDecoration("bold"),u.removeDecoration("dim");else if(f===23)u.removeDecoration("italic");else if(f===24)u.removeDecoration("underline");else if(f===25)u.removeDecoration("blink");else if(f===27)u.removeDecoration("reverse");else if(f===28)u.removeDecoration("hidden");else if(f===29)u.removeDecoration("strikethrough");else if(f===39)u.fg=null;else if(f===49)u.bg=null;else if(f>=30&&f<38)u.fg=Io[0][f%10][o];else if(f>=90&&f<98)u.fg=Io[1][f%10][o];else if(f>=40&&f<48)u.bg=Io[0][f%10][o];else if(f>=100&&f<108)u.bg=Io[1][f%10][o];else if(f===38||f===48){var h=f===38;if(l.length>=1){var p=l.shift();if(p==="5"&&l.length>=1){var g=parseInt(l.shift());if(g>=0&&g<=255)if(!s)this.PALETTE_COLORS||u.setupPalette(),h?u.fg=this.PALETTE_COLORS[g]:u.bg=this.PALETTE_COLORS[g];else{var y=g>=16?"ansi-palette-"+g:Io[g>7?1:0][g%8].class;h?u.fg=y:u.bg=y}}else if(p==="2"&&l.length>=3){var m=parseInt(l.shift()),v=parseInt(l.shift()),S=parseInt(l.shift());if(m>=0&&m<=255&&v>=0&&v<=255&&S>=0&&S<=255){var E=m+", "+v+", "+S;s?h?(u.fg="ansi-truecolor",u.fg_truecolor=E):(u.bg="ansi-truecolor",u.bg_truecolor=E):h?u.fg=E:u.bg=E}}}}}return u.fg===null&&u.bg===null&&u.decorations.length===0||(a.fg=u.fg,a.bg=u.bg,a.fg_truecolor=u.fg_truecolor,a.bg_truecolor=u.bg_truecolor,a.decorations=u.decorations,a.decoration=u.decorations.slice(-1).pop()||null,a.was_processed=!0),a}},{key:"processChunk",value:function(n,r,i){var s=this;r=r||{};var o=this.processChunkJson(n,r,i),a=r.use_classes;if(o.decorations=o.decorations.filter(function(h){if(h==="reverse"){o.fg||(o.fg=Io[0][7][a?"class":"color"]),o.bg||(o.bg=Io[0][0][a?"class":"color"]);var p=o.fg;o.fg=o.bg,o.bg=p;var g=o.fg_truecolor;return o.fg_truecolor=o.bg_truecolor,o.bg_truecolor=g,o.isInverted=!0,!1}return!0}),r.json)return o;if(o.isEmpty())return"";if(!o.was_processed)return o.content;var c=[],l=[],u=[],d={},f=function(p){var g=[],y=void 0;for(y in p)p.hasOwnProperty(y)&&g.push("data-"+y+'="'+s.escapeForHtml(p[y])+'"');return g.length>0?" "+g.join(" "):""};return o.isInverted&&(d["ansi-is-inverted"]="true"),o.fg&&(a?(c.push(o.fg+"-fg"),o.fg_truecolor!==null&&(d["ansi-truecolor-fg"]=o.fg_truecolor,o.fg_truecolor=null)):c.push("color:rgb("+o.fg+")")),o.bg&&(a?(c.push(o.bg+"-bg"),o.bg_truecolor!==null&&(d["ansi-truecolor-bg"]=o.bg_truecolor,o.bg_truecolor=null)):c.push("background-color:rgb("+o.bg+")")),o.decorations.forEach(function(h){if(a){l.push("ansi-"+h);return}h==="bold"?l.push("font-weight:bold"):h==="dim"?l.push("opacity:0.5"):h==="italic"?l.push("font-style:italic"):h==="hidden"?l.push("visibility:hidden"):h==="strikethrough"?u.push("line-through"):u.push(h)}),u.length&&l.push("text-decoration:"+u.join(" ")),a?'<span class="'+c.concat(l).join(" ")+'"'+f(d)+">"+o.content+"</span>":'<span style="'+c.concat(l).join(";")+'"'+f(d)+">"+o.content+"</span>"}},{key:"removeDecoration",value:function(n){var r=this.decorations.indexOf(n);r>=0&&this.decorations.splice(r,1)}}]),t}(),OB=DB;const LB=Yd(OB);function BB(t,e){let n=[];for(const r of t.split(`\r
`)){const i=LB.ansiToJson(r,{json:!0,remove_empty:!1});let s=[];for(const o of i){const a=VB(o,e);s=[...s,...a]}n=[...n,q.jsx("span",{children:s},n.length)]}return n}const FB=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,UB=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,GB=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function VB(t,e){const n=WB(t),r=[];let i=0;function s(l,u){let d;for(;(d=l.exec(t.content))!==null;){const f=d.index;f>i&&r.push(t.content.substring(i,f)),r.push(u(d)),i=l.lastIndex}}function o(l){const[,u,d]=l,f=d;return q.jsxs(q.Fragment,{children:[u,q.jsx("a",{href:f,target:"_blank",rel:"noreferrer",children:d})]})}function a(l){const u=l.groups.name,d=`mailto:${u}`;return q.jsxs(q.Fragment,{children:[l.groups.slorp1,q.jsx("a",{href:d,target:"_blank",rel:"noreferrer",children:u}),l.groups.slorp2]})}function c(l){const[,u,d]=l;return q.jsx("a",{onClick:()=>e(u),className:"exit",children:d})}return s(FB,o),s(UB,a),s(GB,c),i<t.content.length&&r.push(t.content.substring(i)),r.map(l=>q.jsx("span",{style:n,children:l}))}function WB(t){const e={};switch(t.bg&&(e.backgroundColor=`rgb(${t.bg})`),t.fg&&(e.color=`rgb(${t.fg})`),t.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}class HB extends St.Component{constructor(n){super(n);j(this,"outputRef",St.createRef());j(this,"state",{output:[],sidebarVisible:!1});j(this,"addCommand",n=>{this.addToOutput([q.jsx("span",{className:"command","aria-live":"off",children:n})])});j(this,"addError",n=>this.addToOutput([q.jsxs("h2",{children:[" Error: ",n.message]})]));j(this,"handleConnected",()=>this.addToOutput([q.jsx("h2",{children:" Connected"})]));j(this,"handleDisconnected",()=>{this.addToOutput([q.jsx("h2",{children:" Disconnected"})]),this.state.sidebarVisible=!1});j(this,"handleUserList",n=>this.setState({sidebarVisible:!!n}));j(this,"scrollToBottom",()=>{const n=this.outputRef.current;n&&(n.scrollTop=n.scrollHeight)});j(this,"handleMessage",n=>{const r=BB(n,this.handleExitClick);this.addToOutput(r)});j(this,"handleExitClick",n=>{this.props.client.sendCommand(n)});this.props.client.on("message",this.handleMessage),this.props.client.on("connect",this.handleConnected),this.props.client.on("disconnect",this.handleDisconnected),this.props.client.on("error",this.addError),this.props.client.on("command",this.addCommand),this.props.client.on("userlist",this.handleUserList)}componentDidUpdate(){this.scrollToBottom()}componentWillUnmount(){this.props.client.removeListener("message",this.handleMessage)}addToOutput(n){this.setState(r=>{const i=r.output.length,s=n.map((o,a)=>q.jsx("div",{children:o},i+a));return{output:[...r.output,...s]}})}saveLog(){const n=this.outputRef.current;if(n){const r=n.innerHTML,i=new Blob([r],{type:"text/html"}),s=URL.createObjectURL(i),o=document.createElement("a"),a=new Date,c=a.toLocaleDateString(),l=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=`${document.title.replace(/\s+/g,"-")}-log-${c}-${l}.html`;o.download=d,o.href=s,o.click(),URL.revokeObjectURL(s),o.remove()}}clearLog(){this.setState({output:[]})}render(){var n="output";return this.state.sidebarVisible&&(n+=" sidebar-visible"),q.jsx("div",{ref:this.outputRef,className:n,"aria-live":"polite",role:"log",children:this.state.output})}}var AT={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function s(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new i(u,d||c,f),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],h]:c._events[p].push(h):(c._events[p]=h,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,f,h,p){var g=n?n+l:l;if(!this._events[g])return!1;var y=this._events[g],m=arguments.length,v,S;if(y.fn){switch(y.once&&this.removeListener(l,y.fn,void 0,!0),m){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,d),!0;case 4:return y.fn.call(y.context,u,d,f),!0;case 5:return y.fn.call(y.context,u,d,f,h),!0;case 6:return y.fn.call(y.context,u,d,f,h,p),!0}for(S=1,v=new Array(m-1);S<m;S++)v[S-1]=arguments[S];y.fn.apply(y.context,v)}else{var E=y.length,A;for(S=0;S<E;S++)switch(y[S].once&&this.removeListener(l,y[S].fn,void 0,!0),m){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,u);break;case 3:y[S].fn.call(y[S].context,u,d);break;case 4:y[S].fn.call(y[S].context,u,d,f);break;default:if(!v)for(A=1,v=new Array(m-1);A<m;A++)v[A-1]=arguments[A];y[S].fn.apply(y[S].context,v)}}return!0},a.prototype.on=function(l,u,d){return s(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return s(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,f){var h=n?n+l:l;if(!this._events[h])return this;if(!u)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&o(this,h);else{for(var g=0,y=[],m=p.length;g<m;g++)(p[g].fn!==u||f&&!p[g].once||d&&p[g].context!==d)&&y.push(p[g]);y.length?this._events[h]=y.length===1?y[0]:y:o(this,h)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(AT);var ZB=AT.exports;const kT=Yd(ZB);var bn={},pm={};pm.byteLength=XB;pm.toByteArray=KB;pm.fromByteArray=qB;var Gi=[],Or=[],jB=typeof Uint8Array<"u"?Uint8Array:Array,Vg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ic=0,zB=Vg.length;Ic<zB;++Ic)Gi[Ic]=Vg[Ic],Or[Vg.charCodeAt(Ic)]=Ic;Or[45]=62;Or[95]=63;function ET(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function XB(t){var e=ET(t),n=e[0],r=e[1];return(n+r)*3/4-r}function $B(t,e,n){return(e+n)*3/4-n}function KB(t){var e,n=ET(t),r=n[0],i=n[1],s=new jB($B(t,r,i)),o=0,a=i>0?r-4:r,c;for(c=0;c<a;c+=4)e=Or[t.charCodeAt(c)]<<18|Or[t.charCodeAt(c+1)]<<12|Or[t.charCodeAt(c+2)]<<6|Or[t.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=Or[t.charCodeAt(c)]<<2|Or[t.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=Or[t.charCodeAt(c)]<<10|Or[t.charCodeAt(c+1)]<<4|Or[t.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function JB(t){return Gi[t>>18&63]+Gi[t>>12&63]+Gi[t>>6&63]+Gi[t&63]}function YB(t,e,n){for(var r,i=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(JB(r));return i.join("")}function qB(t){for(var e,n=t.length,r=n%3,i=[],s=16383,o=0,a=n-r;o<a;o+=s)i.push(YB(t,o,o+s>a?a:o+s));return r===1?(e=t[n-1],i.push(Gi[e>>2]+Gi[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(Gi[e>>10]+Gi[e>>4&63]+Gi[e<<2&63]+"=")),i.join("")}var JC={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */JC.read=function(t,e,n,r,i){var s,o,a=i*8-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?i-1:0,f=n?-1:1,h=t[e+d];for(d+=f,s=h&(1<<-u)-1,h>>=-u,u+=a;u>0;s=s*256+t[e+d],d+=f,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=r;u>0;o=o*256+t[e+d],d+=f,u-=8);if(s===0)s=1-l;else{if(s===c)return o?NaN:(h?-1:1)*(1/0);o=o+Math.pow(2,r),s=s-l}return(h?-1:1)*o*Math.pow(2,s-r)};JC.write=function(t,e,n,r,i,s){var o,a,c,l=s*8-i-1,u=(1<<l)-1,d=u>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:s-1,p=r?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=f/c:e+=f*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*c-1)*Math.pow(2,i),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;t[n+h]=a&255,h+=p,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;t[n+h]=o&255,h+=p,o/=256,l-=8);t[n+h-p]|=g*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=pm,n=JC,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const T=new Uint8Array(1),C={foo:function(){return 42}};return Object.setPrototypeOf(C,Uint8Array.prototype),Object.setPrototypeOf(T,C),T.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(T){if(T>i)throw new RangeError('The value "'+T+'" is invalid for option "size"');const C=new Uint8Array(T);return Object.setPrototypeOf(C,a.prototype),C}function a(T,C,I){if(typeof T=="number"){if(typeof C=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(T)}return c(T,C,I)}a.poolSize=8192;function c(T,C,I){if(typeof T=="string")return f(T,C);if(ArrayBuffer.isView(T))return p(T);if(T==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T);if(Ge(T,ArrayBuffer)||T&&Ge(T.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ge(T,SharedArrayBuffer)||T&&Ge(T.buffer,SharedArrayBuffer)))return g(T,C,I);if(typeof T=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const P=T.valueOf&&T.valueOf();if(P!=null&&P!==T)return a.from(P,C,I);const O=y(T);if(O)return O;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof T[Symbol.toPrimitive]=="function")return a.from(T[Symbol.toPrimitive]("string"),C,I);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T)}a.from=function(T,C,I){return c(T,C,I)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(T){if(typeof T!="number")throw new TypeError('"size" argument must be of type number');if(T<0)throw new RangeError('The value "'+T+'" is invalid for option "size"')}function u(T,C,I){return l(T),T<=0?o(T):C!==void 0?typeof I=="string"?o(T).fill(C,I):o(T).fill(C):o(T)}a.alloc=function(T,C,I){return u(T,C,I)};function d(T){return l(T),o(T<0?0:m(T)|0)}a.allocUnsafe=function(T){return d(T)},a.allocUnsafeSlow=function(T){return d(T)};function f(T,C){if((typeof C!="string"||C==="")&&(C="utf8"),!a.isEncoding(C))throw new TypeError("Unknown encoding: "+C);const I=S(T,C)|0;let P=o(I);const O=P.write(T,C);return O!==I&&(P=P.slice(0,O)),P}function h(T){const C=T.length<0?0:m(T.length)|0,I=o(C);for(let P=0;P<C;P+=1)I[P]=T[P]&255;return I}function p(T){if(Ge(T,Uint8Array)){const C=new Uint8Array(T);return g(C.buffer,C.byteOffset,C.byteLength)}return h(T)}function g(T,C,I){if(C<0||T.byteLength<C)throw new RangeError('"offset" is outside of buffer bounds');if(T.byteLength<C+(I||0))throw new RangeError('"length" is outside of buffer bounds');let P;return C===void 0&&I===void 0?P=new Uint8Array(T):I===void 0?P=new Uint8Array(T,C):P=new Uint8Array(T,C,I),Object.setPrototypeOf(P,a.prototype),P}function y(T){if(a.isBuffer(T)){const C=m(T.length)|0,I=o(C);return I.length===0||T.copy(I,0,0,C),I}if(T.length!==void 0)return typeof T.length!="number"||Ut(T.length)?o(0):h(T);if(T.type==="Buffer"&&Array.isArray(T.data))return h(T.data)}function m(T){if(T>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return T|0}function v(T){return+T!=T&&(T=0),a.alloc(+T)}a.isBuffer=function(C){return C!=null&&C._isBuffer===!0&&C!==a.prototype},a.compare=function(C,I){if(Ge(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),Ge(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),!a.isBuffer(C)||!a.isBuffer(I))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(C===I)return 0;let P=C.length,O=I.length;for(let W=0,Q=Math.min(P,O);W<Q;++W)if(C[W]!==I[W]){P=C[W],O=I[W];break}return P<O?-1:O<P?1:0},a.isEncoding=function(C){switch(String(C).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(C,I){if(!Array.isArray(C))throw new TypeError('"list" argument must be an Array of Buffers');if(C.length===0)return a.alloc(0);let P;if(I===void 0)for(I=0,P=0;P<C.length;++P)I+=C[P].length;const O=a.allocUnsafe(I);let W=0;for(P=0;P<C.length;++P){let Q=C[P];if(Ge(Q,Uint8Array))W+Q.length>O.length?(a.isBuffer(Q)||(Q=a.from(Q)),Q.copy(O,W)):Uint8Array.prototype.set.call(O,Q,W);else if(a.isBuffer(Q))Q.copy(O,W);else throw new TypeError('"list" argument must be an Array of Buffers');W+=Q.length}return O};function S(T,C){if(a.isBuffer(T))return T.length;if(ArrayBuffer.isView(T)||Ge(T,ArrayBuffer))return T.byteLength;if(typeof T!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof T);const I=T.length,P=arguments.length>2&&arguments[2]===!0;if(!P&&I===0)return 0;let O=!1;for(;;)switch(C){case"ascii":case"latin1":case"binary":return I;case"utf8":case"utf-8":return Ye(T).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I*2;case"hex":return I>>>1;case"base64":return Le(T).length;default:if(O)return P?-1:Ye(T).length;C=(""+C).toLowerCase(),O=!0}}a.byteLength=S;function E(T,C,I){let P=!1;if((C===void 0||C<0)&&(C=0),C>this.length||((I===void 0||I>this.length)&&(I=this.length),I<=0)||(I>>>=0,C>>>=0,I<=C))return"";for(T||(T="utf8");;)switch(T){case"hex":return K(this,C,I);case"utf8":case"utf-8":return V(this,C,I);case"ascii":return te(this,C,I);case"latin1":case"binary":return H(this,C,I);case"base64":return G(this,C,I);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,C,I);default:if(P)throw new TypeError("Unknown encoding: "+T);T=(T+"").toLowerCase(),P=!0}}a.prototype._isBuffer=!0;function A(T,C,I){const P=T[C];T[C]=T[I],T[I]=P}a.prototype.swap16=function(){const C=this.length;if(C%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let I=0;I<C;I+=2)A(this,I,I+1);return this},a.prototype.swap32=function(){const C=this.length;if(C%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let I=0;I<C;I+=4)A(this,I,I+3),A(this,I+1,I+2);return this},a.prototype.swap64=function(){const C=this.length;if(C%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let I=0;I<C;I+=8)A(this,I,I+7),A(this,I+1,I+6),A(this,I+2,I+5),A(this,I+3,I+4);return this},a.prototype.toString=function(){const C=this.length;return C===0?"":arguments.length===0?V(this,0,C):E.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(C){if(!a.isBuffer(C))throw new TypeError("Argument must be a Buffer");return this===C?!0:a.compare(this,C)===0},a.prototype.inspect=function(){let C="";const I=t.INSPECT_MAX_BYTES;return C=this.toString("hex",0,I).replace(/(.{2})/g,"$1 ").trim(),this.length>I&&(C+=" ... "),"<Buffer "+C+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(C,I,P,O,W){if(Ge(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),!a.isBuffer(C))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof C);if(I===void 0&&(I=0),P===void 0&&(P=C?C.length:0),O===void 0&&(O=0),W===void 0&&(W=this.length),I<0||P>C.length||O<0||W>this.length)throw new RangeError("out of range index");if(O>=W&&I>=P)return 0;if(O>=W)return-1;if(I>=P)return 1;if(I>>>=0,P>>>=0,O>>>=0,W>>>=0,this===C)return 0;let Q=W-O,Pe=P-I;const rt=Math.min(Q,Pe),it=this.slice(O,W),ut=C.slice(I,P);for(let qe=0;qe<rt;++qe)if(it[qe]!==ut[qe]){Q=it[qe],Pe=ut[qe];break}return Q<Pe?-1:Pe<Q?1:0};function b(T,C,I,P,O){if(T.length===0)return-1;if(typeof I=="string"?(P=I,I=0):I>2147483647?I=2147483647:I<-2147483648&&(I=-2147483648),I=+I,Ut(I)&&(I=O?0:T.length-1),I<0&&(I=T.length+I),I>=T.length){if(O)return-1;I=T.length-1}else if(I<0)if(O)I=0;else return-1;if(typeof C=="string"&&(C=a.from(C,P)),a.isBuffer(C))return C.length===0?-1:k(T,C,I,P,O);if(typeof C=="number")return C=C&255,typeof Uint8Array.prototype.indexOf=="function"?O?Uint8Array.prototype.indexOf.call(T,C,I):Uint8Array.prototype.lastIndexOf.call(T,C,I):k(T,[C],I,P,O);throw new TypeError("val must be string, number or Buffer")}function k(T,C,I,P,O){let W=1,Q=T.length,Pe=C.length;if(P!==void 0&&(P=String(P).toLowerCase(),P==="ucs2"||P==="ucs-2"||P==="utf16le"||P==="utf-16le")){if(T.length<2||C.length<2)return-1;W=2,Q/=2,Pe/=2,I/=2}function rt(ut,qe){return W===1?ut[qe]:ut.readUInt16BE(qe*W)}let it;if(O){let ut=-1;for(it=I;it<Q;it++)if(rt(T,it)===rt(C,ut===-1?0:it-ut)){if(ut===-1&&(ut=it),it-ut+1===Pe)return ut*W}else ut!==-1&&(it-=it-ut),ut=-1}else for(I+Pe>Q&&(I=Q-Pe),it=I;it>=0;it--){let ut=!0;for(let qe=0;qe<Pe;qe++)if(rt(T,it+qe)!==rt(C,qe)){ut=!1;break}if(ut)return it}return-1}a.prototype.includes=function(C,I,P){return this.indexOf(C,I,P)!==-1},a.prototype.indexOf=function(C,I,P){return b(this,C,I,P,!0)},a.prototype.lastIndexOf=function(C,I,P){return b(this,C,I,P,!1)};function _(T,C,I,P){I=Number(I)||0;const O=T.length-I;P?(P=Number(P),P>O&&(P=O)):P=O;const W=C.length;P>W/2&&(P=W/2);let Q;for(Q=0;Q<P;++Q){const Pe=parseInt(C.substr(Q*2,2),16);if(Ut(Pe))return Q;T[I+Q]=Pe}return Q}function N(T,C,I,P){return _e(Ye(C,T.length-I),T,I,P)}function M(T,C,I,P){return _e($e(C),T,I,P)}function D(T,C,I,P){return _e(Le(C),T,I,P)}function B(T,C,I,P){return _e(ue(C,T.length-I),T,I,P)}a.prototype.write=function(C,I,P,O){if(I===void 0)O="utf8",P=this.length,I=0;else if(P===void 0&&typeof I=="string")O=I,P=this.length,I=0;else if(isFinite(I))I=I>>>0,isFinite(P)?(P=P>>>0,O===void 0&&(O="utf8")):(O=P,P=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const W=this.length-I;if((P===void 0||P>W)&&(P=W),C.length>0&&(P<0||I<0)||I>this.length)throw new RangeError("Attempt to write outside buffer bounds");O||(O="utf8");let Q=!1;for(;;)switch(O){case"hex":return _(this,C,I,P);case"utf8":case"utf-8":return N(this,C,I,P);case"ascii":case"latin1":case"binary":return M(this,C,I,P);case"base64":return D(this,C,I,P);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,C,I,P);default:if(Q)throw new TypeError("Unknown encoding: "+O);O=(""+O).toLowerCase(),Q=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function G(T,C,I){return C===0&&I===T.length?e.fromByteArray(T):e.fromByteArray(T.slice(C,I))}function V(T,C,I){I=Math.min(T.length,I);const P=[];let O=C;for(;O<I;){const W=T[O];let Q=null,Pe=W>239?4:W>223?3:W>191?2:1;if(O+Pe<=I){let rt,it,ut,qe;switch(Pe){case 1:W<128&&(Q=W);break;case 2:rt=T[O+1],(rt&192)===128&&(qe=(W&31)<<6|rt&63,qe>127&&(Q=qe));break;case 3:rt=T[O+1],it=T[O+2],(rt&192)===128&&(it&192)===128&&(qe=(W&15)<<12|(rt&63)<<6|it&63,qe>2047&&(qe<55296||qe>57343)&&(Q=qe));break;case 4:rt=T[O+1],it=T[O+2],ut=T[O+3],(rt&192)===128&&(it&192)===128&&(ut&192)===128&&(qe=(W&15)<<18|(rt&63)<<12|(it&63)<<6|ut&63,qe>65535&&qe<1114112&&(Q=qe))}}Q===null?(Q=65533,Pe=1):Q>65535&&(Q-=65536,P.push(Q>>>10&1023|55296),Q=56320|Q&1023),P.push(Q),O+=Pe}return X(P)}const z=4096;function X(T){const C=T.length;if(C<=z)return String.fromCharCode.apply(String,T);let I="",P=0;for(;P<C;)I+=String.fromCharCode.apply(String,T.slice(P,P+=z));return I}function te(T,C,I){let P="";I=Math.min(T.length,I);for(let O=C;O<I;++O)P+=String.fromCharCode(T[O]&127);return P}function H(T,C,I){let P="";I=Math.min(T.length,I);for(let O=C;O<I;++O)P+=String.fromCharCode(T[O]);return P}function K(T,C,I){const P=T.length;(!C||C<0)&&(C=0),(!I||I<0||I>P)&&(I=P);let O="";for(let W=C;W<I;++W)O+=De[T[W]];return O}function ie(T,C,I){const P=T.slice(C,I);let O="";for(let W=0;W<P.length-1;W+=2)O+=String.fromCharCode(P[W]+P[W+1]*256);return O}a.prototype.slice=function(C,I){const P=this.length;C=~~C,I=I===void 0?P:~~I,C<0?(C+=P,C<0&&(C=0)):C>P&&(C=P),I<0?(I+=P,I<0&&(I=0)):I>P&&(I=P),I<C&&(I=C);const O=this.subarray(C,I);return Object.setPrototypeOf(O,a.prototype),O};function $(T,C,I){if(T%1!==0||T<0)throw new RangeError("offset is not uint");if(T+C>I)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(C,I,P){C=C>>>0,I=I>>>0,P||$(C,I,this.length);let O=this[C],W=1,Q=0;for(;++Q<I&&(W*=256);)O+=this[C+Q]*W;return O},a.prototype.readUintBE=a.prototype.readUIntBE=function(C,I,P){C=C>>>0,I=I>>>0,P||$(C,I,this.length);let O=this[C+--I],W=1;for(;I>0&&(W*=256);)O+=this[C+--I]*W;return O},a.prototype.readUint8=a.prototype.readUInt8=function(C,I){return C=C>>>0,I||$(C,1,this.length),this[C]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(C,I){return C=C>>>0,I||$(C,2,this.length),this[C]|this[C+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(C,I){return C=C>>>0,I||$(C,2,this.length),this[C]<<8|this[C+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(C,I){return C=C>>>0,I||$(C,4,this.length),(this[C]|this[C+1]<<8|this[C+2]<<16)+this[C+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(C,I){return C=C>>>0,I||$(C,4,this.length),this[C]*16777216+(this[C+1]<<16|this[C+2]<<8|this[C+3])},a.prototype.readBigUInt64LE=jt(function(C){C=C>>>0,Kt(C,"offset");const I=this[C],P=this[C+7];(I===void 0||P===void 0)&&In(C,this.length-8);const O=I+this[++C]*2**8+this[++C]*2**16+this[++C]*2**24,W=this[++C]+this[++C]*2**8+this[++C]*2**16+P*2**24;return BigInt(O)+(BigInt(W)<<BigInt(32))}),a.prototype.readBigUInt64BE=jt(function(C){C=C>>>0,Kt(C,"offset");const I=this[C],P=this[C+7];(I===void 0||P===void 0)&&In(C,this.length-8);const O=I*2**24+this[++C]*2**16+this[++C]*2**8+this[++C],W=this[++C]*2**24+this[++C]*2**16+this[++C]*2**8+P;return(BigInt(O)<<BigInt(32))+BigInt(W)}),a.prototype.readIntLE=function(C,I,P){C=C>>>0,I=I>>>0,P||$(C,I,this.length);let O=this[C],W=1,Q=0;for(;++Q<I&&(W*=256);)O+=this[C+Q]*W;return W*=128,O>=W&&(O-=Math.pow(2,8*I)),O},a.prototype.readIntBE=function(C,I,P){C=C>>>0,I=I>>>0,P||$(C,I,this.length);let O=I,W=1,Q=this[C+--O];for(;O>0&&(W*=256);)Q+=this[C+--O]*W;return W*=128,Q>=W&&(Q-=Math.pow(2,8*I)),Q},a.prototype.readInt8=function(C,I){return C=C>>>0,I||$(C,1,this.length),this[C]&128?(255-this[C]+1)*-1:this[C]},a.prototype.readInt16LE=function(C,I){C=C>>>0,I||$(C,2,this.length);const P=this[C]|this[C+1]<<8;return P&32768?P|4294901760:P},a.prototype.readInt16BE=function(C,I){C=C>>>0,I||$(C,2,this.length);const P=this[C+1]|this[C]<<8;return P&32768?P|4294901760:P},a.prototype.readInt32LE=function(C,I){return C=C>>>0,I||$(C,4,this.length),this[C]|this[C+1]<<8|this[C+2]<<16|this[C+3]<<24},a.prototype.readInt32BE=function(C,I){return C=C>>>0,I||$(C,4,this.length),this[C]<<24|this[C+1]<<16|this[C+2]<<8|this[C+3]},a.prototype.readBigInt64LE=jt(function(C){C=C>>>0,Kt(C,"offset");const I=this[C],P=this[C+7];(I===void 0||P===void 0)&&In(C,this.length-8);const O=this[C+4]+this[C+5]*2**8+this[C+6]*2**16+(P<<24);return(BigInt(O)<<BigInt(32))+BigInt(I+this[++C]*2**8+this[++C]*2**16+this[++C]*2**24)}),a.prototype.readBigInt64BE=jt(function(C){C=C>>>0,Kt(C,"offset");const I=this[C],P=this[C+7];(I===void 0||P===void 0)&&In(C,this.length-8);const O=(I<<24)+this[++C]*2**16+this[++C]*2**8+this[++C];return(BigInt(O)<<BigInt(32))+BigInt(this[++C]*2**24+this[++C]*2**16+this[++C]*2**8+P)}),a.prototype.readFloatLE=function(C,I){return C=C>>>0,I||$(C,4,this.length),n.read(this,C,!0,23,4)},a.prototype.readFloatBE=function(C,I){return C=C>>>0,I||$(C,4,this.length),n.read(this,C,!1,23,4)},a.prototype.readDoubleLE=function(C,I){return C=C>>>0,I||$(C,8,this.length),n.read(this,C,!0,52,8)},a.prototype.readDoubleBE=function(C,I){return C=C>>>0,I||$(C,8,this.length),n.read(this,C,!1,52,8)};function se(T,C,I,P,O,W){if(!a.isBuffer(T))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>O||C<W)throw new RangeError('"value" argument is out of bounds');if(I+P>T.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(C,I,P,O){if(C=+C,I=I>>>0,P=P>>>0,!O){const Pe=Math.pow(2,8*P)-1;se(this,C,I,P,Pe,0)}let W=1,Q=0;for(this[I]=C&255;++Q<P&&(W*=256);)this[I+Q]=C/W&255;return I+P},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(C,I,P,O){if(C=+C,I=I>>>0,P=P>>>0,!O){const Pe=Math.pow(2,8*P)-1;se(this,C,I,P,Pe,0)}let W=P-1,Q=1;for(this[I+W]=C&255;--W>=0&&(Q*=256);)this[I+W]=C/Q&255;return I+P},a.prototype.writeUint8=a.prototype.writeUInt8=function(C,I,P){return C=+C,I=I>>>0,P||se(this,C,I,1,255,0),this[I]=C&255,I+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(C,I,P){return C=+C,I=I>>>0,P||se(this,C,I,2,65535,0),this[I]=C&255,this[I+1]=C>>>8,I+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(C,I,P){return C=+C,I=I>>>0,P||se(this,C,I,2,65535,0),this[I]=C>>>8,this[I+1]=C&255,I+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(C,I,P){return C=+C,I=I>>>0,P||se(this,C,I,4,4294967295,0),this[I+3]=C>>>24,this[I+2]=C>>>16,this[I+1]=C>>>8,this[I]=C&255,I+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(C,I,P){return C=+C,I=I>>>0,P||se(this,C,I,4,4294967295,0),this[I]=C>>>24,this[I+1]=C>>>16,this[I+2]=C>>>8,this[I+3]=C&255,I+4};function be(T,C,I,P,O){Cn(C,P,O,T,I,7);let W=Number(C&BigInt(4294967295));T[I++]=W,W=W>>8,T[I++]=W,W=W>>8,T[I++]=W,W=W>>8,T[I++]=W;let Q=Number(C>>BigInt(32)&BigInt(4294967295));return T[I++]=Q,Q=Q>>8,T[I++]=Q,Q=Q>>8,T[I++]=Q,Q=Q>>8,T[I++]=Q,I}function we(T,C,I,P,O){Cn(C,P,O,T,I,7);let W=Number(C&BigInt(4294967295));T[I+7]=W,W=W>>8,T[I+6]=W,W=W>>8,T[I+5]=W,W=W>>8,T[I+4]=W;let Q=Number(C>>BigInt(32)&BigInt(4294967295));return T[I+3]=Q,Q=Q>>8,T[I+2]=Q,Q=Q>>8,T[I+1]=Q,Q=Q>>8,T[I]=Q,I+8}a.prototype.writeBigUInt64LE=jt(function(C,I=0){return be(this,C,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=jt(function(C,I=0){return we(this,C,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(C,I,P,O){if(C=+C,I=I>>>0,!O){const rt=Math.pow(2,8*P-1);se(this,C,I,P,rt-1,-rt)}let W=0,Q=1,Pe=0;for(this[I]=C&255;++W<P&&(Q*=256);)C<0&&Pe===0&&this[I+W-1]!==0&&(Pe=1),this[I+W]=(C/Q>>0)-Pe&255;return I+P},a.prototype.writeIntBE=function(C,I,P,O){if(C=+C,I=I>>>0,!O){const rt=Math.pow(2,8*P-1);se(this,C,I,P,rt-1,-rt)}let W=P-1,Q=1,Pe=0;for(this[I+W]=C&255;--W>=0&&(Q*=256);)C<0&&Pe===0&&this[I+W+1]!==0&&(Pe=1),this[I+W]=(C/Q>>0)-Pe&255;return I+P},a.prototype.writeInt8=function(C,I,P){return C=+C,I=I>>>0,P||se(this,C,I,1,127,-128),C<0&&(C=255+C+1),this[I]=C&255,I+1},a.prototype.writeInt16LE=function(C,I,P){return C=+C,I=I>>>0,P||se(this,C,I,2,32767,-32768),this[I]=C&255,this[I+1]=C>>>8,I+2},a.prototype.writeInt16BE=function(C,I,P){return C=+C,I=I>>>0,P||se(this,C,I,2,32767,-32768),this[I]=C>>>8,this[I+1]=C&255,I+2},a.prototype.writeInt32LE=function(C,I,P){return C=+C,I=I>>>0,P||se(this,C,I,4,2147483647,-2147483648),this[I]=C&255,this[I+1]=C>>>8,this[I+2]=C>>>16,this[I+3]=C>>>24,I+4},a.prototype.writeInt32BE=function(C,I,P){return C=+C,I=I>>>0,P||se(this,C,I,4,2147483647,-2147483648),C<0&&(C=4294967295+C+1),this[I]=C>>>24,this[I+1]=C>>>16,this[I+2]=C>>>8,this[I+3]=C&255,I+4},a.prototype.writeBigInt64LE=jt(function(C,I=0){return be(this,C,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=jt(function(C,I=0){return we(this,C,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function me(T,C,I,P,O,W){if(I+P>T.length)throw new RangeError("Index out of range");if(I<0)throw new RangeError("Index out of range")}function ke(T,C,I,P,O){return C=+C,I=I>>>0,O||me(T,C,I,4),n.write(T,C,I,P,23,4),I+4}a.prototype.writeFloatLE=function(C,I,P){return ke(this,C,I,!0,P)},a.prototype.writeFloatBE=function(C,I,P){return ke(this,C,I,!1,P)};function Ue(T,C,I,P,O){return C=+C,I=I>>>0,O||me(T,C,I,8),n.write(T,C,I,P,52,8),I+8}a.prototype.writeDoubleLE=function(C,I,P){return Ue(this,C,I,!0,P)},a.prototype.writeDoubleBE=function(C,I,P){return Ue(this,C,I,!1,P)},a.prototype.copy=function(C,I,P,O){if(!a.isBuffer(C))throw new TypeError("argument should be a Buffer");if(P||(P=0),!O&&O!==0&&(O=this.length),I>=C.length&&(I=C.length),I||(I=0),O>0&&O<P&&(O=P),O===P||C.length===0||this.length===0)return 0;if(I<0)throw new RangeError("targetStart out of bounds");if(P<0||P>=this.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("sourceEnd out of bounds");O>this.length&&(O=this.length),C.length-I<O-P&&(O=C.length-I+P);const W=O-P;return this===C&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(I,P,O):Uint8Array.prototype.set.call(C,this.subarray(P,O),I),W},a.prototype.fill=function(C,I,P,O){if(typeof C=="string"){if(typeof I=="string"?(O=I,I=0,P=this.length):typeof P=="string"&&(O=P,P=this.length),O!==void 0&&typeof O!="string")throw new TypeError("encoding must be a string");if(typeof O=="string"&&!a.isEncoding(O))throw new TypeError("Unknown encoding: "+O);if(C.length===1){const Q=C.charCodeAt(0);(O==="utf8"&&Q<128||O==="latin1")&&(C=Q)}}else typeof C=="number"?C=C&255:typeof C=="boolean"&&(C=Number(C));if(I<0||this.length<I||this.length<P)throw new RangeError("Out of range index");if(P<=I)return this;I=I>>>0,P=P===void 0?this.length:P>>>0,C||(C=0);let W;if(typeof C=="number")for(W=I;W<P;++W)this[W]=C;else{const Q=a.isBuffer(C)?C:a.from(C,O),Pe=Q.length;if(Pe===0)throw new TypeError('The value "'+C+'" is invalid for argument "value"');for(W=0;W<P-I;++W)this[W+I]=Q[W%Pe]}return this};const ce={};function xt(T,C,I){ce[T]=class extends I{constructor(){super(),Object.defineProperty(this,"message",{value:C.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${T}]`,this.stack,delete this.name}get code(){return T}set code(O){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:O,writable:!0})}toString(){return`${this.name} [${T}]: ${this.message}`}}}xt("ERR_BUFFER_OUT_OF_BOUNDS",function(T){return T?`${T} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),xt("ERR_INVALID_ARG_TYPE",function(T,C){return`The "${T}" argument must be of type number. Received type ${typeof C}`},TypeError),xt("ERR_OUT_OF_RANGE",function(T,C,I){let P=`The value of "${T}" is out of range.`,O=I;return Number.isInteger(I)&&Math.abs(I)>2**32?O=cn(String(I)):typeof I=="bigint"&&(O=String(I),(I>BigInt(2)**BigInt(32)||I<-(BigInt(2)**BigInt(32)))&&(O=cn(O)),O+="n"),P+=` It must be ${C}. Received ${O}`,P},RangeError);function cn(T){let C="",I=T.length;const P=T[0]==="-"?1:0;for(;I>=P+4;I-=3)C=`_${T.slice(I-3,I)}${C}`;return`${T.slice(0,I)}${C}`}function wt(T,C,I){Kt(C,"offset"),(T[C]===void 0||T[C+I]===void 0)&&In(C,T.length-(I+1))}function Cn(T,C,I,P,O,W){if(T>I||T<C){const Q=typeof C=="bigint"?"n":"";let Pe;throw W>3?C===0||C===BigInt(0)?Pe=`>= 0${Q} and < 2${Q} ** ${(W+1)*8}${Q}`:Pe=`>= -(2${Q} ** ${(W+1)*8-1}${Q}) and < 2 ** ${(W+1)*8-1}${Q}`:Pe=`>= ${C}${Q} and <= ${I}${Q}`,new ce.ERR_OUT_OF_RANGE("value",Pe,T)}wt(P,O,W)}function Kt(T,C){if(typeof T!="number")throw new ce.ERR_INVALID_ARG_TYPE(C,"number",T)}function In(T,C,I){throw Math.floor(T)!==T?(Kt(T,I),new ce.ERR_OUT_OF_RANGE(I||"offset","an integer",T)):C<0?new ce.ERR_BUFFER_OUT_OF_BOUNDS:new ce.ERR_OUT_OF_RANGE(I||"offset",`>= ${I?1:0} and <= ${C}`,T)}const le=/[^+/0-9A-Za-z-_]/g;function Ce(T){if(T=T.split("=")[0],T=T.trim().replace(le,""),T.length<2)return"";for(;T.length%4!==0;)T=T+"=";return T}function Ye(T,C){C=C||1/0;let I;const P=T.length;let O=null;const W=[];for(let Q=0;Q<P;++Q){if(I=T.charCodeAt(Q),I>55295&&I<57344){if(!O){if(I>56319){(C-=3)>-1&&W.push(239,191,189);continue}else if(Q+1===P){(C-=3)>-1&&W.push(239,191,189);continue}O=I;continue}if(I<56320){(C-=3)>-1&&W.push(239,191,189),O=I;continue}I=(O-55296<<10|I-56320)+65536}else O&&(C-=3)>-1&&W.push(239,191,189);if(O=null,I<128){if((C-=1)<0)break;W.push(I)}else if(I<2048){if((C-=2)<0)break;W.push(I>>6|192,I&63|128)}else if(I<65536){if((C-=3)<0)break;W.push(I>>12|224,I>>6&63|128,I&63|128)}else if(I<1114112){if((C-=4)<0)break;W.push(I>>18|240,I>>12&63|128,I>>6&63|128,I&63|128)}else throw new Error("Invalid code point")}return W}function $e(T){const C=[];for(let I=0;I<T.length;++I)C.push(T.charCodeAt(I)&255);return C}function ue(T,C){let I,P,O;const W=[];for(let Q=0;Q<T.length&&!((C-=2)<0);++Q)I=T.charCodeAt(Q),P=I>>8,O=I%256,W.push(O),W.push(P);return W}function Le(T){return e.toByteArray(Ce(T))}function _e(T,C,I,P){let O;for(O=0;O<P&&!(O+I>=C.length||O>=T.length);++O)C[O+I]=T[O];return O}function Ge(T,C){return T instanceof C||T!=null&&T.constructor!=null&&T.constructor.name!=null&&T.constructor.name===C.name}function Ut(T){return T!==T}const De=function(){const T="0123456789abcdef",C=new Array(256);for(let I=0;I<16;++I){const P=I*16;for(let O=0;O<16;++O)C[P+O]=T[I]+T[O]}return C}();function jt(T){return typeof BigInt>"u"?mc:T}function mc(){throw new Error("BigInt not supported")}})(bn);var Ou=(t=>(t[t.BINARY=0]="BINARY",t[t.ECHO=1]="ECHO",t[t.RCP=2]="RCP",t[t.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",t[t.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",t[t.STATUS=5]="STATUS",t[t.TIMING_MARK=6]="TIMING_MARK",t[t.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",t[t.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",t[t.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",t[t.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",t[t.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",t[t.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",t[t.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",t[t.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",t[t.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",t[t.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",t[t.EXTENDED_ASCII=17]="EXTENDED_ASCII",t[t.LOGOUT=18]="LOGOUT",t[t.BYTE_MACRO=19]="BYTE_MACRO",t[t.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",t[t.SUPDUP=21]="SUPDUP",t[t.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",t[t.SEND_LOCATION=23]="SEND_LOCATION",t[t.TERMINAL_TYPE=24]="TERMINAL_TYPE",t[t.END_OF_RECORD=25]="END_OF_RECORD",t[t.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",t[t.OUTPUT_MARKING=27]="OUTPUT_MARKING",t[t.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",t[t.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",t[t.X_3_PAD=30]="X_3_PAD",t[t.NAWS=31]="NAWS",t[t.TERMINAL_SPEED=32]="TERMINAL_SPEED",t[t.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",t[t.LINEMODE=34]="LINEMODE",t[t.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",t[t.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",t[t.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",t[t.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",t[t.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",t[t.TN3270E=40]="TN3270E",t[t.XAUTH=41]="XAUTH",t[t.CHARSET=42]="CHARSET",t[t.RSP=43]="RSP",t[t.COM_PORT_OPTION=44]="COM_PORT_OPTION",t[t.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",t[t.START_TLS=46]="START_TLS",t[t.KERMIT=47]="KERMIT",t[t.SEND_URL=48]="SEND_URL",t[t.FORWARD_X=49]="FORWARD_X",t[t.PRAGMA_LOGON=138]="PRAGMA_LOGON",t[t.GMCP=201]="GMCP",t))(Ou||{}),Lu=(t=>(t[t.SE=240]="SE",t[t.NOP=241]="NOP",t[t.DM=242]="DM",t[t.BRK=243]="BRK",t[t.IP=244]="IP",t[t.AO=245]="AO",t[t.AYT=246]="AYT",t[t.EC=247]="EC",t[t.EL=248]="EL",t[t.GA=249]="GA",t[t.SB=250]="SB",t[t.WILL=251]="WILL",t[t.WONT=252]="WONT",t[t.DO=253]="DO",t[t.DONT=254]="DONT",t[t.IAC=255]="IAC",t))(Lu||{});class QB{constructor(e){j(this,"ws");this.ws=e}on(e,n){if(e==="data"){this.ws.onmessage=i=>{n(i.data)};return}const r="on"+e;this[r]=n}write(e){this.ws.send(e)}}class e2 extends kT{constructor(n){super();j(this,"state");j(this,"buffer");j(this,"subBuffer");j(this,"iacSEBuffer",bn.Buffer.from([255,240]));j(this,"negotiationByte",0);j(this,"stream");this.state=0,this.buffer=bn.Buffer.alloc(0),this.subBuffer=bn.Buffer.alloc(0),n&&n.on("data",r=>this.parse(r)),this.stream=n}parse(n){for(this.buffer=bn.Buffer.concat([this.buffer,bn.Buffer.from(n)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const n=this.buffer.indexOf(255);if(n===-1){this.emit("data",this.buffer),this.buffer=bn.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,n)),this.buffer=this.buffer.slice(n),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const n=this.buffer[1];switch(this.buffer=this.buffer.slice(2),n){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=bn.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=n,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const n=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",n,r),this.state=0,!1}handleSubnegotiation(){let n=this.buffer.indexOf(this.iacSEBuffer);if(n===-1)return!0;this.state=0;let r=this.buffer.slice(0,n);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(n+2),!1}handleGmcp(n){const r=n.toString(),[i,s]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,s)}sendNegotiation(n,r){this.stream.write(bn.Buffer.from([255,n,r]))}sendGmcp(n,r){const i=n+" "+r,s=bn.Buffer.from(i),o=bn.Buffer.concat([bn.Buffer.from([255,250]),bn.Buffer.from([201]),s,this.iacSEBuffer]);this.stream.write(o)}sendTerminalType(n){const r=bn.Buffer.from(n),i=bn.Buffer.concat([bn.Buffer.from([255,250]),bn.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}class po{constructor(e){j(this,"packageName");j(this,"packageVersion",1);j(this,"client");this.client=e}sendData(e,n){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(n))}shutdown(){}}class t2 extends po{constructor(){super(...arguments);j(this,"packageName","Auth.Autologin")}handleToken(n){localStorage.setItem("LoginRefreshToken",n)}sendLogin(){var n=localStorage.getItem("LoginRefreshToken");n&&this.sendData("Login",n)}}class n2 extends po{constructor(){super(...arguments);j(this,"packageName","Char")}handleName(n){this.client.worldData.playerId=n.name,this.client.worldData.playerName=n.fullname,this.client.emit("statustext",`Logged in as ${n.fullname}`)}sendLogin(n,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:n,password:r}))}}class r2 extends po{constructor(n){super(n);j(this,"packageName","Client.Keystrokes");j(this,"bindings",[]);document.addEventListener("keyup",this.handleKeyup.bind(this))}handleKeyup(n){const r=this.findBinding(n);if(r){const i=this.client.getInput(),s=this.parseCommand(r.command,i);r.autosend?this.sendCommand(s):this.placeInInputField(s)}}findBinding(n){return this.bindings.find(r=>r.key===n.key&&r.modifiers.every(i=>n[`${i}Key`]))}parseCommand(n,r){const i=r.trim().split(/\s+/);return n.replace(/%(\d+|\*)/g,(s,o)=>{if(o==="*")return r;const a=parseInt(o,10)-1;return a>=0&&a<i.length?i[a]:s})}sendCommand(n){this.sendData("ExecuteCommand",{command:n})}placeInInputField(n){this.client.setInput(n)}bindKey(n){const r={key:n.key,modifiers:n.modifiers,command:n.command,autosend:n.autosend};this.bindings.push(r)}unbindKey(n){this.bindings=this.bindings.filter(r=>r.key!==n.key||!r.modifiers.every(i=>n.modifiers.includes(i)))}unbindAll(){this.bindings=[]}bindAll(n){this.bindings=n.bindings}listBindings(){return this.bindings}}const nw=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),rw=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),Cy=(t,e)=>({startTime:e,type:"setValue",value:t}),TT=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),_T=(t,e,{startTime:n,target:r,timeConstant:i})=>r+(e-r)*Math.exp((n-t)/i),Wc=t=>t.type==="exponentialRampToValue",dp=t=>t.type==="linearRampToValue",Ro=t=>Wc(t)||dp(t),YC=t=>t.type==="setValue",Is=t=>t.type==="setValueCurve",fp=(t,e,n,r)=>{const i=t[e];return i===void 0?r:Ro(i)||YC(i)?i.value:Is(i)?i.values[i.values.length-1]:_T(n,fp(t,e-1,i.startTime,r),i)},iw=(t,e,n,r,i)=>n===void 0?[r.insertTime,i]:Ro(n)?[n.endTime,n.value]:YC(n)?[n.startTime,n.value]:Is(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,fp(t,e-1,n.startTime,i)],Iy=t=>t.type==="cancelAndHold",Sy=t=>t.type==="cancelScheduledValues",So=t=>Iy(t)||Sy(t)?t.cancelTime:Wc(t)||dp(t)?t.endTime:t.startTime,sw=(t,e,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((t-e)/(r-e)):0,ow=(t,e,n,{endTime:r,value:i})=>n+(t-e)/(r-e)*(i-n),i2=(t,e)=>{const n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},s2=(t,{duration:e,startTime:n,values:r})=>{const i=(t-n)/e*(r.length-1);return i2(r,i)},Hf=t=>t.type==="setTarget";class o2{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=So(e);if(Iy(e)||Sy(e)){const r=this._automationEvents.findIndex(s=>Sy(e)&&Is(s)?s.startTime+s.duration>=n:So(s)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Iy(e)){const s=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&Ro(i)){if(s!==void 0&&Hf(s))throw new Error("The internal list is malformed.");const o=s===void 0?i.insertTime:Is(s)?s.startTime+s.duration:So(s),a=s===void 0?this._defaultValue:Is(s)?s.values[s.values.length-1]:s.value,c=Wc(i)?sw(n,o,a,i):ow(n,o,a,i),l=Wc(i)?nw(c,n,this._currenTime):rw(c,n,this._currenTime);this._automationEvents.push(l)}if(s!==void 0&&Hf(s)&&this._automationEvents.push(Cy(this.getValue(n),n)),s!==void 0&&Is(s)&&s.startTime+s.duration>n){const o=n-s.startTime,a=(s.values.length-1)/s.duration,c=Math.max(2,1+Math.ceil(o*a)),l=o/(c-1)*a,u=s.values.slice(0,c);if(l<1)for(let d=1;d<c;d+=1){const f=l*d%1;u[d]=s.values[d-1]*(1-f)+s.values[d]*f}this._automationEvents[this._automationEvents.length-1]=TT(u,s.startTime,o)}}}else{const r=this._automationEvents.findIndex(o=>So(o)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Is(i)&&So(i)+i.duration>n)return!1;const s=Wc(e)?nw(e.value,e.endTime,this._currenTime):dp(e)?rw(e.value,n,this._currenTime):e;if(r===-1)this._automationEvents.push(s);else{if(Is(e)&&n+e.duration>So(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(e){const n=this._automationEvents.findIndex(r=>So(r)>e);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];Hf(i)&&r.unshift(Cy(fp(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(o=>So(o)>e),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,s=this._automationEvents[i];if(s!==void 0&&Hf(s)&&(r===void 0||!Ro(r)||r.insertTime>e))return _T(e,fp(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(s!==void 0&&YC(s)&&(r===void 0||!Ro(r)))return s.value;if(s!==void 0&&Is(s)&&(r===void 0||!Ro(r)||s.startTime+s.duration>e))return e<s.startTime+s.duration?s2(e,s):s.values[s.values.length-1];if(s!==void 0&&Ro(s)&&(r===void 0||!Ro(r)))return s.value;if(r!==void 0&&Wc(r)){const[o,a]=iw(this._automationEvents,i,s,r,this._defaultValue);return sw(e,o,a,r)}if(r!==void 0&&dp(r)){const[o,a]=iw(this._automationEvents,i,s,r,this._defaultValue);return ow(e,o,a,r)}return this._defaultValue}}const a2=t=>({cancelTime:t,type:"cancelAndHold"}),c2=t=>({cancelTime:t,type:"cancelScheduledValues"}),l2=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),u2=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),d2=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),f2=()=>new DOMException("","AbortError"),h2=t=>(e,n,[r,i,s],o)=>{t(e[i],[n,r,s],a=>a[0]===n&&a[1]===r,o)},p2=t=>(e,n,r)=>{const i=[];for(let s=0;s<r.numberOfInputs;s+=1)i.push(new Set);t.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},m2=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},_l=new WeakSet,RT=new WeakMap,NT=new WeakMap,PT=new WeakMap,MT=new WeakMap,xT=new WeakMap,DT=new WeakMap,by=new WeakMap,wy=new WeakMap,Ay=new WeakMap,OT={construct(){return OT}},g2=t=>{try{const e=new Proxy(t,OT);new e}catch{return!1}return!0},aw=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,cw=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),i=r.match(aw);for(;i!==null;){const s=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());n.push(o),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(aw)}return[n.join(";"),r]},lw=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},uw=t=>{if(!g2(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},v2=(t,e,n,r,i,s,o,a,c,l,u,d,f)=>{let h=0;return(p,g,y={credentials:"omit"})=>{const m=u.get(p);if(m!==void 0&&m.has(g))return Promise.resolve();const v=l.get(p);if(v!==void 0){const A=v.get(g);if(A!==void 0)return A}const S=s(p),E=S.audioWorklet===void 0?i(g).then(([A,b])=>{const[k,_]=cw(A,b),N=`${k};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${_}
})})(window,'_AWGS')`;return n(N)}).then(()=>{const A=f._AWGS.pop();if(A===void 0)throw new SyntaxError;r(S.currentTime,S.sampleRate,()=>A(class{},void 0,(b,k)=>{if(b.trim()==="")throw e();const _=wy.get(S);if(_!==void 0){if(_.has(b))throw e();uw(k),lw(k.parameterDescriptors),_.set(b,k)}else uw(k),lw(k.parameterDescriptors),wy.set(S,new Map([[b,k]]))},S.sampleRate,void 0,void 0))}):Promise.all([i(g),Promise.resolve(t(d,d))]).then(([[A,b],k])=>{const _=h+1;h=_;const[N,M]=cw(A,b),V=`${N};((AudioWorkletProcessor,registerProcessor)=>{${M}
})(${k?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${k?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${k?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${_}',class extends AudioWorkletProcessor{process(){return !1}})`,z=new Blob([V],{type:"application/javascript; charset=utf-8"}),X=URL.createObjectURL(z);return S.audioWorklet.addModule(X,y).then(()=>{if(a(S))return S;const te=o(S);return te.audioWorklet.addModule(X,y).then(()=>te)}).then(te=>{if(c===null)throw new SyntaxError;try{new c(te,`__sac${_}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(X))});return v===void 0?l.set(p,new Map([[g,E]])):v.set(g,E),E.then(()=>{const A=u.get(p);A===void 0?u.set(p,new Set([g])):A.add(g)}).finally(()=>{const A=l.get(p);A!==void 0&&A.delete(g)}),E}},ki=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},mm=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return t.delete(r),r},LT=(t,e,n,r)=>{const i=ki(t,e),s=mm(i,o=>o[0]===n&&o[1]===r);return i.size===0&&t.delete(e),s},of=t=>ki(DT,t),Rl=t=>{if(_l.has(t))throw new Error("The AudioNode is already stored.");_l.add(t),of(t).forEach(e=>e(!0))},BT=t=>"port"in t,af=t=>{if(!_l.has(t))throw new Error("The AudioNode is not stored.");_l.delete(t),of(t).forEach(e=>e(!1))},ky=(t,e)=>{!BT(t)&&e.every(n=>n.size===0)&&af(t)},y2=(t,e,n,r,i,s,o,a,c,l,u,d,f)=>{const h=new WeakMap;return(p,g,y,m,v)=>{const{activeInputs:S,passiveInputs:E}=s(g),{outputs:A}=s(p),b=a(p),k=_=>{const N=c(g),M=c(p);if(_){const D=LT(E,p,y,m);t(S,p,D,!1),!v&&!d(p)&&n(M,N,y,m),f(g)&&Rl(g)}else{const D=r(S,p,y,m);e(E,m,D,!1),!v&&!d(p)&&i(M,N,y,m);const B=o(g);if(B===0)u(g)&&ky(g,S);else{const G=h.get(g);G!==void 0&&clearTimeout(G),h.set(g,setTimeout(()=>{u(g)&&ky(g,S)},B*1e3))}}};return l(A,[g,y,m],_=>_[0]===g&&_[1]===y&&_[2]===m,!0)?(b.add(k),u(p)?t(S,p,[y,m,k],!0):e(E,m,[p,y,k],!0),!0):!1}},C2=t=>(e,n,[r,i,s],o)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[i,n,s]])):t(a,[i,n,s],c=>c[0]===i&&c[1]===n,o)},I2=t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},S2=t=>(e,n)=>{t(e).add(n)},b2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},w2=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=i(a),u={...b2,...c},d=r(l,u),f=s(l)?e():null;super(a,!1,d,f),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},Wn=(t,e)=>t.context===e,A2=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Wn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},Ey=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},hs=()=>new DOMException("","IndexSizeError"),FT=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(r){throw r.code===12?hs():r}})(t.getChannelData)},k2={numberOfChannels:1},E2=(t,e,n,r,i,s,o,a)=>{let c=null;return class UT{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:f,sampleRate:h}={...k2,...u};c===null&&(c=new i(1,1,44100));const p=r!==null&&e(s,s)?new r({length:d,numberOfChannels:f,sampleRate:h}):c.createBuffer(f,d,h);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(o(p),FT(p)):e(Ey,()=>Ey(p))||a(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===UT.prototype||t.has(u)}}},ar=-34028234663852886e22,Kn=-ar,eo=t=>_l.has(t),T2={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},_2=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f={...T2,...u},h=i(d,f),p=o(d),g=p?e():null;super(l,!1,h,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=n(this,p,h.playbackRate,Kn,ar)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?l:d}get playbackRate(){return this._playbackRate}start(l=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(l,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[l,u]:[l,u,d]),this.context.state!=="closed"){Rl(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),eo(this)&&af(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},R2=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let d=n(l);const f=Wn(d,u);if(!f){const h={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(u,h),o!==null&&d.start(...o),a!==null&&d.stop(a)}return s.set(u,d),f?await t(u,l.playbackRate,d.playbackRate):await r(u,l.playbackRate,d.playbackRate),await i(l,u,d),d};return{set start(l){o=l},set stop(l){a=l},render(l,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},N2=t=>"playbackRate"in t,P2=t=>"frequency"in t&&"gain"in t,M2=t=>"offset"in t,x2=t=>!("frequency"in t)&&"gain"in t,D2=t=>"detune"in t&&"frequency"in t,O2=t=>"pan"in t,Qn=t=>ki(RT,t),cf=t=>ki(PT,t),Ty=(t,e)=>{const{activeInputs:n}=Qn(t);n.forEach(i=>i.forEach(([s])=>{e.includes(t)||Ty(s,[...e,t])}));const r=N2(t)?[t.playbackRate]:BT(t)?Array.from(t.parameters.values()):P2(t)?[t.Q,t.detune,t.frequency,t.gain]:M2(t)?[t.offset]:x2(t)?[t.gain]:D2(t)?[t.detune,t.frequency]:O2(t)?[t.pan]:[];for(const i of r){const s=cf(i);s!==void 0&&s.activeInputs.forEach(([o])=>Ty(o,e))}eo(t)&&af(t)},L2=t=>{Ty(t.destination,[])},B2=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),F2=(t,e,n,r,i,s,o,a,c)=>class extends t{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new c(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(d===null)throw r();if(!B2(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw n();super(d,2);const{latencyHint:f}=u,{sampleRate:h}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:f==="balanced"?512/h:f==="interactive"||f===void 0?256/h:f==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(f*h/128)))*128/h,this._nativeAudioContext=d,c.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",p)};d.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),L2(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(u){return new o(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},U2=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f=o(d),h=i(d,u,f),p=f?e(a):null;super(l,!1,h,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},G2=t=>{const e=new WeakMap,n=async(r,i)=>{const s=i.destination;return e.set(i,s),await t(r,i,s),s};return{render(r,i){const s=e.get(i);return s!==void 0?Promise.resolve(s):n(r,i)}}},V2=(t,e,n,r,i,s,o,a)=>(c,l)=>{const u=l.listener,d=()=>{const A=new Float32Array(1),b=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),k=o(l);let _=!1,N=[0,0,-1,0,1,0],M=[0,0,0];const D=()=>{if(_)return;_=!0;const z=r(l,256,9,0);z.onaudioprocess=({inputBuffer:X})=>{const te=[s(X,A,0),s(X,A,1),s(X,A,2),s(X,A,3),s(X,A,4),s(X,A,5)];te.some((K,ie)=>K!==N[ie])&&(u.setOrientation(...te),N=te);const H=[s(X,A,6),s(X,A,7),s(X,A,8)];H.some((K,ie)=>K!==M[ie])&&(u.setPosition(...H),M=H)},b.connect(z)},B=z=>X=>{X!==N[z]&&(N[z]=X,u.setOrientation(...N))},G=z=>X=>{X!==M[z]&&(M[z]=X,u.setPosition(...M))},V=(z,X,te)=>{const H=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:X});H.connect(b,0,z),H.start(),Object.defineProperty(H.offset,"defaultValue",{get(){return X}});const K=t({context:c},k,H.offset,Kn,ar);return a(K,"value",ie=>()=>ie.call(K),ie=>$=>{try{ie.call(K,$)}catch(se){if(se.code!==9)throw se}D(),k&&te($)}),K.cancelAndHoldAtTime=(ie=>k?()=>{throw i()}:(...$)=>{const se=ie.apply(K,$);return D(),se})(K.cancelAndHoldAtTime),K.cancelScheduledValues=(ie=>k?()=>{throw i()}:(...$)=>{const se=ie.apply(K,$);return D(),se})(K.cancelScheduledValues),K.exponentialRampToValueAtTime=(ie=>k?()=>{throw i()}:(...$)=>{const se=ie.apply(K,$);return D(),se})(K.exponentialRampToValueAtTime),K.linearRampToValueAtTime=(ie=>k?()=>{throw i()}:(...$)=>{const se=ie.apply(K,$);return D(),se})(K.linearRampToValueAtTime),K.setTargetAtTime=(ie=>k?()=>{throw i()}:(...$)=>{const se=ie.apply(K,$);return D(),se})(K.setTargetAtTime),K.setValueAtTime=(ie=>k?()=>{throw i()}:(...$)=>{const se=ie.apply(K,$);return D(),se})(K.setValueAtTime),K.setValueCurveAtTime=(ie=>k?()=>{throw i()}:(...$)=>{const se=ie.apply(K,$);return D(),se})(K.setValueCurveAtTime),K};return{forwardX:V(0,0,B(0)),forwardY:V(1,0,B(1)),forwardZ:V(2,-1,B(2)),positionX:V(6,0,G(0)),positionY:V(7,0,G(1)),positionZ:V(8,0,G(2)),upX:V(3,0,B(3)),upY:V(4,1,B(4)),upZ:V(5,0,B(5))}},{forwardX:f,forwardY:h,forwardZ:p,positionX:g,positionY:y,positionZ:m,upX:v,upY:S,upZ:E}=u.forwardX===void 0?d():u;return{get forwardX(){return f},get forwardY(){return h},get forwardZ(){return p},get positionX(){return g},get positionY(){return y},get positionZ(){return m},get upX(){return v},get upY(){return S},get upZ(){return E}}},hp=t=>"context"in t,lf=t=>hp(t[0]),ac=(t,e,n,r)=>{for(const i of t)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},dw=(t,e,[n,r],i)=>{ac(t,[e,n,r],s=>s[0]===e&&s[1]===n,i)},fw=(t,[e,n,r],i)=>{const s=t.get(e);s===void 0?t.set(e,new Set([[n,r]])):ac(s,[n,r],o=>o[0]===n,i)},Xl=t=>"inputs"in t,pp=(t,e,n,r)=>{if(Xl(e)){const i=e.inputs[r];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,r),[e,n,r]},GT=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},W2=(t,e,n)=>mm(t,r=>r[0]===e&&r[1]===n),VT=(t,e)=>{if(!of(t).delete(e))throw new Error("Missing the expected event listener.")},WT=(t,e,n)=>{const r=ki(t,e),i=mm(r,s=>s[0]===n);return r.size===0&&t.delete(e),i},mp=(t,e,n,r)=>{Xl(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},bt=t=>ki(NT,t),Ed=t=>ki(MT,t),$a=t=>by.has(t),Sh=t=>!_l.has(t),hw=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const r=t.createScriptProcessor(256,1,1),i=t.createGain(),s=t.createBuffer(1,2,44100),o=s.getChannelData(0);o[0]=1,o[1]=1;const a=t.createBufferSource();a.buffer=s,a.loop=!0,a.connect(r).connect(t.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}}),Wg=(t,e)=>{const n=new Map;for(const r of t)for(const i of r){const s=n.get(i);n.set(i,s===void 0?1:s+1)}n.forEach((r,i)=>e(i,r))},gp=t=>"context"in t,H2=t=>{const e=new Map;t.connect=(n=>(r,i=0,s=0)=>{const o=gp(r)?n(r,i,s):n(r,i),a=e.get(r);return a===void 0?e.set(r,[{input:s,output:i}]):a.every(c=>c.input!==s||c.output!==i)&&a.push({input:s,output:i}),o})(t.connect.bind(t)),t.disconnect=(n=>(r,i,s)=>{if(n.apply(t),r===void 0)e.clear();else if(typeof r=="number")for(const[o,a]of e){const c=a.filter(l=>l.output!==r);c.length===0?e.delete(o):e.set(o,c)}else if(e.has(r))if(i===void 0)e.delete(r);else{const o=e.get(r);if(o!==void 0){const a=o.filter(c=>c.output!==i&&(c.input!==s||s===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[o,a]of e)a.forEach(c=>{gp(o)?t.connect(o,c.output,c.input):t.connect(o,c.output)})})(t.disconnect)},Z2=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:s}=cf(e),{outputs:o}=Qn(t),a=of(t),c=l=>{const u=bt(t),d=Ed(e);if(l){const f=WT(s,t,n);dw(i,t,f,!1),!r&&!$a(t)&&u.connect(d,n)}else{const f=W2(i,t,n);fw(s,f,!1),!r&&!$a(t)&&u.disconnect(d,n)}};return ac(o,[e,n],l=>l[0]===e&&l[1]===n,!0)?(a.add(c),eo(t)?dw(i,t,[n,c],!0):fw(s,[t,n,c],!0),!0):!1},j2=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:s}=Qn(e),o=GT(i[r],t,n);return o===null?[LT(s,t,n,r)[2],!1]:[o[2],!0]},z2=(t,e,n)=>{const{activeInputs:r,passiveInputs:i}=cf(e),s=GT(r,t,n);return s===null?[WT(i,t,n)[1],!1]:[s[2],!0]},qC=(t,e,n,r,i)=>{const[s,o]=j2(t,n,r,i);if(s!==null&&(VT(t,s),o&&!e&&!$a(t)&&mp(bt(t),bt(n),r,i)),eo(n)){const{activeInputs:a}=Qn(n);ky(n,a)}},QC=(t,e,n,r)=>{const[i,s]=z2(t,n,r);i!==null&&(VT(t,i),s&&!e&&!$a(t)&&bt(t).disconnect(Ed(n),r))},X2=(t,e)=>{const n=Qn(t),r=[];for(const i of n.outputs)lf(i)?qC(t,e,...i):QC(t,e,...i),r.push(i[0]);return n.outputs.clear(),r},$2=(t,e,n)=>{const r=Qn(t),i=[];for(const s of r.outputs)s[1]===n&&(lf(s)?qC(t,e,...s):QC(t,e,...s),i.push(s[0]),r.outputs.delete(s));return i},K2=(t,e,n,r,i)=>{const s=Qn(t);return Array.from(s.outputs).filter(o=>o[0]===n&&(r===void 0||o[1]===r)&&(i===void 0||o[2]===i)).map(o=>(lf(o)?qC(t,e,...o):QC(t,e,...o),s.outputs.delete(o),o[0]))},J2=(t,e,n,r,i,s,o,a,c,l,u,d,f,h,p,g)=>class extends l{constructor(m,v,S,E){super(S),this._context=m,this._nativeAudioNode=S;const A=u(m);d(A)&&n(hw,()=>hw(A,g))!==!0&&H2(S),NT.set(this,S),DT.set(this,new Set),m.state!=="closed"&&v&&Rl(this),t(this,E,S)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(m){this._nativeAudioNode.channelCount=m}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(m){this._nativeAudioNode.channelCountMode=m}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(m){this._nativeAudioNode.channelInterpretation=m}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(m,v=0,S=0){if(v<0||v>=this._nativeAudioNode.numberOfOutputs)throw i();const E=u(this._context),A=p(E);if(f(m)||h(m))throw s();if(hp(m)){const _=bt(m);try{const M=pp(this._nativeAudioNode,_,v,S),D=Sh(this);(A||D)&&this._nativeAudioNode.disconnect(...M),this.context.state!=="closed"&&!D&&Sh(m)&&Rl(m)}catch(M){throw M.code===12?s():M}if(e(this,m,v,S,A)){const M=c([this],m);Wg(M,r(A))}return m}const b=Ed(m);if(b.name==="playbackRate"&&b.maxValue===1024)throw o();try{this._nativeAudioNode.connect(b,v),(A||Sh(this))&&this._nativeAudioNode.disconnect(b,v)}catch(_){throw _.code===12?s():_}if(Z2(this,m,v,A)){const _=c([this],m);Wg(_,r(A))}}disconnect(m,v,S){let E;const A=u(this._context),b=p(A);if(m===void 0)E=X2(this,b);else if(typeof m=="number"){if(m<0||m>=this.numberOfOutputs)throw i();E=$2(this,b,m)}else{if(v!==void 0&&(v<0||v>=this.numberOfOutputs)||hp(m)&&S!==void 0&&(S<0||S>=m.numberOfInputs))throw i();if(E=K2(this,b,m,v,S),E.length===0)throw s()}for(const k of E){const _=c([this],k);Wg(_,a)}}},Y2=(t,e,n,r,i,s,o,a,c,l,u,d,f)=>(h,p,g,y=null,m=null)=>{const v=g.value,S=new o2(v),E=p?r(S):null,A={get defaultValue(){return v},get maxValue(){return y===null?g.maxValue:y},get minValue(){return m===null?g.minValue:m},get value(){return g.value},set value(b){g.value=b,A.setValueAtTime(b,h.context.currentTime)},cancelAndHoldAtTime(b){if(typeof g.cancelAndHoldAtTime=="function")E===null&&S.flush(h.context.currentTime),S.add(i(b)),g.cancelAndHoldAtTime(b);else{const k=Array.from(S).pop();E===null&&S.flush(h.context.currentTime),S.add(i(b));const _=Array.from(S).pop();g.cancelScheduledValues(b),k!==_&&_!==void 0&&(_.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(_.value,_.endTime):_.type==="linearRampToValue"?g.linearRampToValueAtTime(_.value,_.endTime):_.type==="setValue"?g.setValueAtTime(_.value,_.startTime):_.type==="setValueCurve"&&g.setValueCurveAtTime(_.values,_.startTime,_.duration))}return A},cancelScheduledValues(b){return E===null&&S.flush(h.context.currentTime),S.add(s(b)),g.cancelScheduledValues(b),A},exponentialRampToValueAtTime(b,k){if(b===0)throw new RangeError;if(!Number.isFinite(k)||k<0)throw new RangeError;const _=h.context.currentTime;return E===null&&S.flush(_),Array.from(S).length===0&&(S.add(l(v,_)),g.setValueAtTime(v,_)),S.add(o(b,k)),g.exponentialRampToValueAtTime(b,k),A},linearRampToValueAtTime(b,k){const _=h.context.currentTime;return E===null&&S.flush(_),Array.from(S).length===0&&(S.add(l(v,_)),g.setValueAtTime(v,_)),S.add(a(b,k)),g.linearRampToValueAtTime(b,k),A},setTargetAtTime(b,k,_){return E===null&&S.flush(h.context.currentTime),S.add(c(b,k,_)),g.setTargetAtTime(b,k,_),A},setValueAtTime(b,k){return E===null&&S.flush(h.context.currentTime),S.add(l(b,k)),g.setValueAtTime(b,k),A},setValueCurveAtTime(b,k,_){const N=b instanceof Float32Array?b:new Float32Array(b);if(d!==null&&d.name==="webkitAudioContext"){const M=k+_,D=h.context.sampleRate,B=Math.ceil(k*D),G=Math.floor(M*D),V=G-B,z=new Float32Array(V);for(let te=0;te<V;te+=1){const H=(N.length-1)/_*((B+te)/D-k),K=Math.floor(H),ie=Math.ceil(H);z[te]=K===ie?N[K]:(1-(H-K))*N[K]+(1-(ie-H))*N[ie]}E===null&&S.flush(h.context.currentTime),S.add(u(z,k,_)),g.setValueCurveAtTime(z,k,_);const X=G/D;X<M&&f(A,z[z.length-1],X),f(A,N[N.length-1],M)}else E===null&&S.flush(h.context.currentTime),S.add(u(N,k,_)),g.setValueCurveAtTime(N,k,_);return A}};return n.set(A,g),e.set(A,h),t(A,E),A},q2=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;e.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;e.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:s}=n;e.setTargetAtTime(i,r,s)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;e.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:s}=n;e.setValueCurveAtTime(s,i,r)}else throw new Error("Can't apply an unknown automation.")}});class HT{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((r,i)=>e.call(n,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const Q2={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},eF=(t,e,n,r,i,s,o,a,c,l,u,d,f,h)=>class extends e{constructor(g,y,m){var v;const S=a(g),E=c(S),A=u({...Q2,...m});f(A);const b=wy.get(S),k=b==null?void 0:b.get(y),_=E||S.state!=="closed"?S:(v=o(S))!==null&&v!==void 0?v:S,N=i(_,E?null:g.baseLatency,l,y,k,A),M=E?r(y,A,k):null;super(g,!0,N,M);const D=[];N.parameters.forEach((G,V)=>{const z=n(this,E,G);D.push([V,z])}),this._nativeAudioWorkletNode=N,this._onprocessorerror=null,this._parameters=new HT(D),E&&t(S,this);const{activeInputs:B}=s(this);d(N,B)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const y=typeof g=="function"?h(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=y;const m=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=m!==null&&m===y?g:m}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function vp(t,e,n,r,i){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],r,i);else{const s=t.getChannelData(r);if(e[n].byteLength===0)e[n]=s.slice(i,i+128);else{const o=new Float32Array(s.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(o)}}}const ZT=(t,e,n,r,i)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],r,i):e[n].byteLength!==0&&t.getChannelData(r).set(e[n],i)},yp=(t,e)=>{const n=[];for(let r=0;r<t;r+=1){const i=[],s=typeof e=="number"?e:e[r];for(let o=0;o<s;o+=1)i.push(new Float32Array(128));n.push(i)}return n},tF=(t,e)=>{const n=ki(Ay,t),r=bt(e);return ki(n,r)},nF=async(t,e,n,r,i,s,o)=>{const a=e===null?Math.ceil(t.context.length/128)*128:e.length,c=r.channelCount*r.numberOfInputs,l=i.reduce((y,m)=>y+m,0),u=l===0?null:n.createBuffer(l,a,n.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const d=Qn(t),f=await tF(n,t),h=yp(r.numberOfInputs,r.channelCount),p=yp(r.numberOfOutputs,i),g=Array.from(t.parameters.keys()).reduce((y,m)=>({...y,[m]:new Float32Array(128)}),{});for(let y=0;y<a;y+=128){if(r.numberOfInputs>0&&e!==null)for(let m=0;m<r.numberOfInputs;m+=1)for(let v=0;v<r.channelCount;v+=1)vp(e,h[m],v,v,y);s.parameterDescriptors!==void 0&&e!==null&&s.parameterDescriptors.forEach(({name:m},v)=>{vp(e,g,m,c+v,y)});for(let m=0;m<r.numberOfInputs;m+=1)for(let v=0;v<i[m];v+=1)p[m][v].byteLength===0&&(p[m][v]=new Float32Array(128));try{const m=h.map((S,E)=>d.activeInputs[E].size===0?[]:S),v=o(y/n.sampleRate,n.sampleRate,()=>f.process(m,p,g));if(u!==null)for(let S=0,E=0;S<r.numberOfOutputs;S+=1){for(let A=0;A<i[S];A+=1)ZT(u,p[S],A,E+A,y);E+=i[S]}if(!v)break}catch(m){t.dispatchEvent(new ErrorEvent("processorerror",{colno:m.colno,filename:m.filename,lineno:m.lineno,message:m.message}));break}}return u},rF=(t,e,n,r,i,s,o,a,c,l,u,d,f,h,p,g)=>(y,m,v)=>{const S=new WeakMap;let E=null;const A=async(b,k)=>{let _=u(b),N=null;const M=Wn(_,k),D=Array.isArray(m.outputChannelCount)?m.outputChannelCount:Array.from(m.outputChannelCount);if(d===null){const B=D.reduce((X,te)=>X+te,0),G=i(k,{channelCount:Math.max(1,B),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,B)}),V=[];for(let X=0;X<b.numberOfOutputs;X+=1)V.push(r(k,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:D[X]}));const z=o(k,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1});z.connect=e.bind(null,V),z.disconnect=c.bind(null,V),N=[G,V,z]}else M||(_=new d(k,y));if(S.set(k,N===null?_:N[2]),N!==null){if(E===null){if(v===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const te=b.channelCount*b.numberOfInputs,H=v.parameterDescriptors===void 0?0:v.parameterDescriptors.length,K=te+H;E=nF(b,K===0?null:await(async()=>{const $=new f(K,Math.ceil(b.context.length/128)*128,k.sampleRate),se=[],be=[];for(let ke=0;ke<m.numberOfInputs;ke+=1)se.push(o($,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1})),be.push(i($,{channelCount:m.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:m.channelCount}));const we=await Promise.all(Array.from(b.parameters.values()).map(async ke=>{const Ue=s($,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ke.value});return await h($,ke,Ue.offset),Ue})),me=r($,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,te+H)});for(let ke=0;ke<m.numberOfInputs;ke+=1){se[ke].connect(be[ke]);for(let Ue=0;Ue<m.channelCount;Ue+=1)be[ke].connect(me,Ue,ke*m.channelCount+Ue)}for(const[ke,Ue]of we.entries())Ue.connect(me,0,te+ke),Ue.start(0);return me.connect($.destination),await Promise.all(se.map(ke=>p(b,$,ke))),g($)})(),k,m,D,v,l)}const B=await E,G=n(k,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[V,z,X]=N;B!==null&&(G.buffer=B,G.start(0)),G.connect(V);for(let te=0,H=0;te<b.numberOfOutputs;te+=1){const K=z[te];for(let ie=0;ie<D[te];ie+=1)V.connect(K,H+ie,ie);H+=D[te]}return X}if(M)for(const[B,G]of b.parameters.entries())await t(k,G,_.parameters.get(B));else for(const[B,G]of b.parameters.entries())await h(k,G,_.parameters.get(B));return await p(b,k,_),_};return{render(b,k){a(k,b);const _=S.get(k);return _!==void 0?Promise.resolve(_):A(b,k)}}},iF=(t,e,n,r,i,s,o,a,c,l,u,d,f,h,p,g,y,m,v,S)=>class extends p{constructor(A,b){super(A,b),this._nativeContext=A,this._audioWorklet=t===void 0?void 0:{addModule:(k,_)=>t(this,k,_)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(A,b,k){return new n({length:b,numberOfChannels:A,sampleRate:k})}createBufferSource(){return new r(this)}createChannelMerger(A=6){return new s(this,{numberOfInputs:A})}createChannelSplitter(A=6){return new o(this,{numberOfOutputs:A})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(A=1){return new u(this,{maxDelayTime:A})}createDynamicsCompressor(){return new d(this)}createGain(){return new f(this)}createIIRFilter(A,b){return new h(this,{feedback:b,feedforward:A})}createOscillator(){return new g(this)}createPanner(){return new y(this)}createPeriodicWave(A,b,k={disableNormalization:!1}){return new m(this,{...k,imag:b,real:A})}createStereoPanner(){return new v(this)}createWaveShaper(){return new S(this)}decodeAudioData(A,b,k){return l(this._nativeContext,A).then(_=>(typeof b=="function"&&b(_),_),_=>{throw typeof k=="function"&&k(_),_})}},sF={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},oF=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f={...sF,...u},h=i(d,f),p=o(d),g=p?n():null;super(l,!1,h,g),this._Q=e(this,p,h.Q,Kn,ar),this._detune=e(this,p,h.detune,1200*Math.log2(Kn),-1200*Math.log2(Kn)),this._frequency=e(this,p,h.frequency,l.sampleRate/2,0),this._gain=e(this,p,h.gain,40*Math.log10(Kn),ar),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,d)}catch(f){throw f.code===11?r():f}if(l.length!==u.length||u.length!==d.length)throw r()}},aF=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Wn(l,c);if(!u){const d={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,d)}return s.set(c,l),u?(await t(c,a.Q,l.Q),await t(c,a.detune,l.detune),await t(c,a.frequency,l.frequency),await t(c,a.gain,l.gain)):(await r(c,a.Q,l.Q),await r(c,a.detune,l.detune),await r(c,a.frequency,l.frequency),await r(c,a.gain,l.gain)),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},cF=(t,e)=>(n,r)=>{const i=e.get(n);if(i!==void 0)return i;const s=t.get(n);if(s!==void 0)return s;try{const o=r();return o instanceof Promise?(t.set(n,o),o.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,o),o)}catch{return e.set(n,!1),!1}},lF={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},uF=(t,e,n,r,i)=>class extends t{constructor(o,a){const c=r(o),l={...lF,...a},u=n(c,l),d=i(c)?e():null;super(o,!1,u,d)}},dF=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Wn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},fF={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},hF=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=r(a),u=s({...fF,...c}),d=n(l,u),f=i(l)?e():null;super(a,!1,d,f)}},pF=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Wn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},mF=t=>(e,n,r)=>t(n,e,r),gF=t=>(e,n,r=0,i=0)=>{const s=e[r];if(s===void 0)throw t();return gp(n)?s.connect(n,0,i):s.connect(n,0)},vF=t=>(e,n)=>{const r=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},yF={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},CF=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...yF,...l},f=r(u,d),h=s(u),p=h?n():null;super(c,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=e(this,h,f.offset,Kn,ar),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){Rl(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),eo(this)&&af(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},IF=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let d=n(l);const f=Wn(d,u);if(!f){const h={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=e(u,h),o!==null&&d.start(o),a!==null&&d.stop(a)}return s.set(u,d),f?await t(u,l.offset,d.offset):await r(u,l.offset,d.offset),await i(l,u,d),d};return{set start(l){o=l},set stop(l){a=l},render(l,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},SF=t=>e=>(t[0]=e,t[0]),bF={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},wF=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=r(a),u={...bF,...c},d=n(l,u),h=i(l)?e():null;super(a,!1,d,h),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},AF=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Wn(a,o)){const l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(o,l)}return r.set(o,a),Xl(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},kF=()=>new DOMException("","DataCloneError"),pw=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,e.close(),n.close(),r()};n.onmessage=()=>i();try{e.postMessage(t,[t])}catch{}finally{i()}})},EF=(t,e,n,r,i,s,o,a,c,l,u)=>(d,f)=>{const h=o(d)?d:s(d);if(i.has(f)){const p=n();return Promise.reject(p)}try{i.add(f)}catch{}return e(c,()=>c(h))?h.decodeAudioData(f).then(p=>(pw(f).catch(()=>{}),e(a,()=>a(p))||u(p),t.add(p),p)):new Promise((p,g)=>{const y=async()=>{try{await pw(f)}catch{}},m=v=>{g(v),y()};try{h.decodeAudioData(f,v=>{typeof v.copyFromChannel!="function"&&(l(v),FT(v)),t.add(v),y().then(()=>p(v))},v=>{m(v===null?r():v)})}catch(v){m(v)}})},TF=(t,e,n,r,i,s,o,a)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=s(c.context),f=a(d);if(u===l){if(e.delete(c),!f&&o(c)){const h=r(c),{outputs:p}=n(c);for(const g of p)if(lf(g)){const y=r(g[0]);t(h,y,g[1],g[2])}else{const y=i(g[0]);h.connect(y,g[1])}}}else e.set(c,u-l)},_F={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},RF=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={..._F,...l},f=r(u,d),h=s(u),p=h?n(d.maxDelayTime):null;super(c,!1,f,p),this._delayTime=e(this,h,f.delayTime),o(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},NF=(t,e,n,r,i)=>s=>{const o=new WeakMap,a=async(c,l)=>{let u=n(c);const d=Wn(u,l);if(!d){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=e(l,f)}return o.set(l,u),d?await t(l,c.delayTime,u.delayTime):await r(l,c.delayTime,u.delayTime),await i(c,l,u),u};return{render(c,l){const u=o.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}},PF=t=>(e,n,r,i)=>t(e[i],s=>s[0]===n&&s[1]===r),MF=t=>(e,n)=>{t(e).delete(n)},xF=t=>"delayTime"in t,DF=(t,e,n)=>function r(i,s){const o=hp(s)?s:n(t,s);if(xF(o))return[];if(i[0]===o)return[i];if(i.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(c=>r([...i,o],c[0])).reduce((c,l)=>c.concat(l),[])},Zf=(t,e,n)=>{const r=e[n];if(r===void 0)throw t();return r},OF=t=>(e,n=void 0,r=void 0,i=0)=>n===void 0?e.forEach(s=>s.disconnect()):typeof n=="number"?Zf(t,e,n).disconnect():gp(n)?r===void 0?e.forEach(s=>s.disconnect(n)):i===void 0?Zf(t,e,r).disconnect(n,0):Zf(t,e,r).disconnect(n,0,i):r===void 0?e.forEach(s=>s.disconnect(n)):Zf(t,e,r).disconnect(n,0),LF={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},BF=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f={...LF,...u},h=r(d,f),p=o(d),g=p?n():null;super(l,!1,h,g),this._attack=e(this,p,h.attack),this._knee=e(this,p,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=e(this,p,h.ratio),this._release=e(this,p,h.release),this._threshold=e(this,p,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},FF=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Wn(l,c);if(!u){const d={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,d)}return s.set(c,l),u?(await t(c,a.attack,l.attack),await t(c,a.knee,l.knee),await t(c,a.ratio,l.ratio),await t(c,a.release,l.release),await t(c,a.threshold,l.threshold)):(await r(c,a.attack,l.attack),await r(c,a.knee,l.knee),await r(c,a.ratio,l.ratio),await r(c,a.release,l.release),await r(c,a.threshold,l.threshold)),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},UF=()=>new DOMException("","EncodingError"),GF=t=>e=>new Promise((n,r)=>{if(t===null){r(new SyntaxError);return}const i=t.document.head;if(i===null)r(new SyntaxError);else{const s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(u,d,f,h,p)=>{if(d===a||d===t.location.href&&f===1&&h===1)return l(),r(p),!1;if(c!==null)return c(u,d,f,h,p)},s.onerror=()=>{l(),r(new SyntaxError)},s.onload=()=>{l(),n()},s.src=a,s.type="module",i.appendChild(s)}}),VF=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=t(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(n,s,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,s===void 0?null:s,i)}},WF=t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},HF=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},ZF={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},jF=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=i(a),u={...ZF,...c},d=r(l,u),f=s(l),h=f?n():null;super(a,!1,d,h),this._gain=e(this,f,d.gain,Kn,ar)}get gain(){return this._gain}},zF=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Wn(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,d)}return s.set(c,l),u?await t(c,a.gain,l.gain):await r(c,a.gain,l.gain),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},XF=(t,e)=>n=>e(t,n),$F=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},KF=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},JF=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},YF=t=>e=>t.get(e),Tn=()=>new DOMException("","InvalidStateError"),qF=t=>e=>{const n=t.get(e);if(n===void 0)throw Tn();return n},QF=(t,e)=>n=>{let r=t.get(n);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),t.set(n,r),r},e5=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},gm=()=>new DOMException("","InvalidAccessError"),t5=t=>{t.getFrequencyResponse=(e=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw gm();return e.call(t,n,r,i)})(t.getFrequencyResponse)},n5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},r5=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=r(a),u=i(l),d={...n5,...c},f=e(l,u?null:a.baseLatency,d),h=u?n(d.feedback,d.feedforward):null;super(a,!1,f,h),t5(f),this._nativeIIRFilterNode=f,s(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}},jT=(t,e,n,r,i,s,o,a,c,l,u)=>{const d=l.length;let f=a;for(let h=0;h<d;h+=1){let p=n[0]*l[h];for(let g=1;g<i;g+=1){const y=f-g&c-1;p+=n[g]*s[y],p-=t[g]*o[y]}for(let g=i;g<r;g+=1)p+=n[g]*s[f-g&c-1];for(let g=i;g<e;g+=1)p-=t[g]*o[f-g&c-1];s[f]=l[h],o[f]=p,f=f+1&c-1,u[h]=p}return f},i5=(t,e,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),s=r instanceof Float64Array?r:new Float64Array(r),o=i.length,a=s.length,c=Math.min(o,a);if(i[0]!==1){for(let p=0;p<o;p+=1)s[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const l=32,u=new Float32Array(l),d=new Float32Array(l),f=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),h=t.numberOfChannels;for(let p=0;p<h;p+=1){const g=t.getChannelData(p),y=f.getChannelData(p);u.fill(0),d.fill(0),jT(i,o,s,a,c,u,d,0,l,g,y)}return f},s5=(t,e,n,r,i)=>(s,o)=>{const a=new WeakMap;let c=null;const l=async(u,d)=>{let f=null,h=e(u);const p=Wn(h,d);if(d.createIIRFilter===void 0?f=t(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(h=d.createIIRFilter(o,s)),a.set(d,f===null?h:f),f!==null){if(c===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const y=new n(u.context.destination.channelCount,u.context.length,d.sampleRate);c=(async()=>{await r(u,y,y.destination);const m=await i(y);return i5(m,d,s,o)})()}const g=await c;return f.buffer=g,f.start(0),f}return await r(u,d,h),h};return{render(u,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):l(u,d)}}},o5=(t,e,n,r,i,s)=>o=>(a,c)=>{const l=t.get(a);if(l===void 0){if(!o&&s(a)){const u=r(a),{outputs:d}=n(a);for(const f of d)if(lf(f)){const h=r(f[0]);e(u,h,f[1],f[2])}else{const h=i(f[0]);u.disconnect(h,f[1])}}t.set(a,c)}else t.set(a,l+c)},a5=t=>e=>t!==null&&e instanceof t,c5=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,l5=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,u5=(t,e)=>n=>t(n)||e(n),d5=t=>e=>t!==null&&e instanceof t,f5=t=>t!==null&&t.isSecureContext,h5=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s),c=e(a,o);if(r(a))throw TypeError();super(s,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},p5={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},m5=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s);if(r(a))throw new TypeError;const c={...p5,...o},l=e(a,c);super(s,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},g5=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s),c=e(a,o);if(r(a))throw new TypeError;super(s,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},v5=(t,e,n)=>class extends t{constructor(i,s){const o=n(i),a=e(o,s);super(i,!0,a,null)}},y5=(t,e,n,r,i,s)=>class extends n{constructor(a,c){super(a),this._nativeContext=a,xT.set(this,a),r(a)&&i.set(a,new Set),this._destination=new t(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},_y=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},C5=(t,e)=>(n,r,i)=>{const s=new Set;return n.connect=(o=>(a,c=0,l=0)=>{const u=s.size===0;if(e(a))return o.call(n,a,c,l),t(s,[a,c,l],d=>d[0]===a&&d[1]===c&&d[2]===l,!0),u&&r(),a;o.call(n,a,c),t(s,[a,c],d=>d[0]===a&&d[1]===c,!0),u&&r()})(n.connect),n.disconnect=(o=>(a,c,l)=>{const u=s.size>0;if(a===void 0)o.apply(n),s.clear();else if(typeof a=="number"){o.call(n,a);for(const f of s)f[1]===a&&s.delete(f)}else{e(a)?o.call(n,a,c,l):o.call(n,a,c);for(const f of s)f[0]===a&&(c===void 0||f[1]===c)&&(l===void 0||f[2]===l)&&s.delete(f)}const d=s.size===0;u&&d&&i()})(n.disconnect),n},kt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n]&&(t[n]=r)},an=(t,e)=>{kt(t,e,"channelCount"),kt(t,e,"channelCountMode"),kt(t,e,"channelInterpretation")},mw=t=>typeof t.getFloatTimeDomainData=="function",I5=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const r=Math.max(n.length,t.fftSize);for(let i=0;i<r;i+=1)e[i]=(n[i]-128)*.0078125;return e}},S5=(t,e)=>(n,r)=>{const i=n.createAnalyser();if(an(i,r),!(r.maxDecibels>r.minDecibels))throw e();return kt(i,r,"fftSize"),kt(i,r,"maxDecibels"),kt(i,r,"minDecibels"),kt(i,r,"smoothingTimeConstant"),t(mw,()=>mw(i))||I5(i),i},b5=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,Ft=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n].value&&(t[n].value=r)},w5=t=>{t.start=(e=>{let n=!1;return(r=0,i=0,s)=>{if(n)throw Tn();e.call(t,r,i,s),n=!0}})(t.start)},eI=t=>{t.start=(e=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,i)})(t.start)},tI=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},A5=(t,e,n,r,i,s,o,a,c,l,u)=>(d,f)=>{const h=d.createBufferSource();return an(h,f),Ft(h,f,"playbackRate"),kt(h,f,"buffer"),kt(h,f,"loop"),kt(h,f,"loopEnd"),kt(h,f,"loopStart"),e(n,()=>n(d))||w5(h),e(r,()=>r(d))||c(h),e(i,()=>i(d))||l(h,d),e(s,()=>s(d))||eI(h),e(o,()=>o(d))||u(h,d),e(a,()=>a(d))||tI(h),t(d,h),h},k5=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,E5=(t,e)=>(n,r,i)=>{const s=n.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}i&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});const o=t(n,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",a=>()=>a.call(o),a=>c=>{a.call(o,c);try{s.channelCount=c}catch(l){if(c>s.maxChannelCount)throw l}}),e(o,"channelCountMode",a=>()=>a.call(o),a=>c=>{a.call(o,c),s.channelCountMode=c}),e(o,"channelInterpretation",a=>()=>a.call(o),a=>c=>{a.call(o,c),s.channelInterpretation=c}),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o},T5=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,_5=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},R5=(t,e,n,r,i)=>(s,o,a,c,l,u)=>{if(a!==null)try{const d=new a(s,c,u),f=new Map;let h=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>h,set:p=>{typeof h=="function"&&d.removeEventListener("processorerror",h),h=typeof p=="function"?p:null,typeof h=="function"&&d.addEventListener("processorerror",h)}}}),d.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const y=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(y!==null){const m=f.get(g[1]);m!==void 0?g[1]=m:(g[1]=v=>{v.type==="error"?(Object.defineProperties(v,{type:{value:"processorerror"}}),y(v)):y(new ErrorEvent(g[0],{...v}))},f.set(y,g[1]))}}return p.call(d,"error",g[1],g[2]),p.call(d,...g)})(d.addEventListener),d.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const y=f.get(g[1]);y!==void 0&&(f.delete(g[1]),g[1]=y)}return p.call(d,"error",g[1],g[2]),p.call(d,g[0],g[1],g[2])})(d.removeEventListener),u.numberOfOutputs!==0){const p=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(p).connect(s.destination),i(d,()=>p.disconnect(),()=>p.connect(s.destination))}return d}catch(d){throw d.code===11?r():d}if(l===void 0)throw r();return _5(u),e(s,o,l,u)},zT=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),N5=t=>new Promise((e,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:s})=>{r.close(),i.close(),e(s)},r.onmessageerror=({data:s})=>{r.close(),i.close(),n(s)},i.postMessage(t)}),P5=async(t,e)=>{const n=await N5(e);return new t(n)},M5=(t,e,n,r)=>{let i=Ay.get(t);i===void 0&&(i=new WeakMap,Ay.set(t,i));const s=P5(n,r);return i.set(e,s),s},x5=(t,e,n,r,i,s,o,a,c,l,u,d,f)=>(h,p,g,y)=>{if(y.numberOfInputs===0&&y.numberOfOutputs===0)throw c();const m=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(m.some(le=>le<1))throw c();if(m.length!==y.numberOfOutputs)throw e();if(y.channelCountMode!=="explicit")throw c();const v=y.channelCount*y.numberOfInputs,S=m.reduce((le,Ce)=>le+Ce,0),E=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(v+E>6||S>6)throw c();const A=new MessageChannel,b=[],k=[];for(let le=0;le<y.numberOfInputs;le+=1)b.push(o(h,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),k.push(i(h,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const _=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:le,maxValue:Ce,minValue:Ye,name:$e}of g.parameterDescriptors){const ue=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:y.parameterData[$e]!==void 0?y.parameterData[$e]:le===void 0?0:le});Object.defineProperties(ue.offset,{defaultValue:{get:()=>le===void 0?0:le},maxValue:{get:()=>Ce===void 0?Kn:Ce},minValue:{get:()=>Ye===void 0?ar:Ye}}),_.push(ue)}const N=r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+E)}),M=zT(p,h.sampleRate),D=a(h,M,v+E,Math.max(1,S)),B=i(h,{channelCount:Math.max(1,S),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,S)}),G=[];for(let le=0;le<y.numberOfOutputs;le+=1)G.push(r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:m[le]}));for(let le=0;le<y.numberOfInputs;le+=1){b[le].connect(k[le]);for(let Ce=0;Ce<y.channelCount;Ce+=1)k[le].connect(N,Ce,le*y.channelCount+Ce)}const V=new HT(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:le},Ce)=>{const Ye=_[Ce];return Ye.connect(N,0,v+Ce),Ye.start(0),[le,Ye.offset]}));N.connect(D);let z=y.channelInterpretation,X=null;const te=y.numberOfOutputs===0?[D]:G,H={get bufferSize(){return M},get channelCount(){return y.channelCount},set channelCount(le){throw n()},get channelCountMode(){return y.channelCountMode},set channelCountMode(le){throw n()},get channelInterpretation(){return z},set channelInterpretation(le){for(const Ce of b)Ce.channelInterpretation=le;z=le},get context(){return D.context},get inputs(){return b},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},get onprocessorerror(){return X},set onprocessorerror(le){typeof X=="function"&&H.removeEventListener("processorerror",X),X=typeof le=="function"?le:null,typeof X=="function"&&H.addEventListener("processorerror",X)},get parameters(){return V},get port(){return A.port2},addEventListener(...le){return D.addEventListener(le[0],le[1],le[2])},connect:t.bind(null,te),disconnect:l.bind(null,te),dispatchEvent(...le){return D.dispatchEvent(le[0])},removeEventListener(...le){return D.removeEventListener(le[0],le[1],le[2])}},K=new Map;A.port1.addEventListener=(le=>(...Ce)=>{if(Ce[0]==="message"){const Ye=typeof Ce[1]=="function"?Ce[1]:typeof Ce[1]=="object"&&Ce[1]!==null&&typeof Ce[1].handleEvent=="function"?Ce[1].handleEvent:null;if(Ye!==null){const $e=K.get(Ce[1]);$e!==void 0?Ce[1]=$e:(Ce[1]=ue=>{u(h.currentTime,h.sampleRate,()=>Ye(ue))},K.set(Ye,Ce[1]))}}return le.call(A.port1,Ce[0],Ce[1],Ce[2])})(A.port1.addEventListener),A.port1.removeEventListener=(le=>(...Ce)=>{if(Ce[0]==="message"){const Ye=K.get(Ce[1]);Ye!==void 0&&(K.delete(Ce[1]),Ce[1]=Ye)}return le.call(A.port1,Ce[0],Ce[1],Ce[2])})(A.port1.removeEventListener);let ie=null;Object.defineProperty(A.port1,"onmessage",{get:()=>ie,set:le=>{typeof ie=="function"&&A.port1.removeEventListener("message",ie),ie=typeof le=="function"?le:null,typeof ie=="function"&&(A.port1.addEventListener("message",ie),A.port1.start())}}),g.prototype.port=A.port1;let $=null;M5(h,H,g,y).then(le=>$=le);const be=yp(y.numberOfInputs,y.channelCount),we=yp(y.numberOfOutputs,m),me=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((le,{name:Ce})=>({...le,[Ce]:new Float32Array(128)}),{});let ke=!0;const Ue=()=>{y.numberOfOutputs>0&&D.disconnect(B);for(let le=0,Ce=0;le<y.numberOfOutputs;le+=1){const Ye=G[le];for(let $e=0;$e<m[le];$e+=1)B.disconnect(Ye,Ce+$e,$e);Ce+=m[le]}},ce=new Map;D.onaudioprocess=({inputBuffer:le,outputBuffer:Ce})=>{if($!==null){const Ye=d(H);for(let $e=0;$e<M;$e+=128){for(let ue=0;ue<y.numberOfInputs;ue+=1)for(let Le=0;Le<y.channelCount;Le+=1)vp(le,be[ue],Le,Le,$e);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:ue},Le)=>{vp(le,me,ue,v+Le,$e)});for(let ue=0;ue<y.numberOfInputs;ue+=1)for(let Le=0;Le<m[ue];Le+=1)we[ue][Le].byteLength===0&&(we[ue][Le]=new Float32Array(128));try{const ue=be.map((_e,Ge)=>{if(Ye[Ge].size>0)return ce.set(Ge,M/128),_e;const De=ce.get(Ge);return De===void 0?[]:(_e.every(jt=>jt.every(mc=>mc===0))&&(De===1?ce.delete(Ge):ce.set(Ge,De-1)),_e)});ke=u(h.currentTime+$e/h.sampleRate,h.sampleRate,()=>$.process(ue,we,me));for(let _e=0,Ge=0;_e<y.numberOfOutputs;_e+=1){for(let Ut=0;Ut<m[_e];Ut+=1)ZT(Ce,we[_e],Ut,Ge+Ut,$e);Ge+=m[_e]}}catch(ue){ke=!1,H.dispatchEvent(new ErrorEvent("processorerror",{colno:ue.colno,filename:ue.filename,lineno:ue.lineno,message:ue.message}))}if(!ke){for(let ue=0;ue<y.numberOfInputs;ue+=1){b[ue].disconnect(k[ue]);for(let Le=0;Le<y.channelCount;Le+=1)k[$e].disconnect(N,Le,ue*y.channelCount+Le)}if(g.parameterDescriptors!==void 0){const ue=g.parameterDescriptors.length;for(let Le=0;Le<ue;Le+=1){const _e=_[Le];_e.disconnect(N,0,v+Le),_e.stop()}}N.disconnect(D),D.onaudioprocess=null,xt?Ue():Cn();break}}}};let xt=!1;const cn=o(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),wt=()=>D.connect(cn).connect(h.destination),Cn=()=>{D.disconnect(cn),cn.disconnect()},Kt=()=>{if(ke){Cn(),y.numberOfOutputs>0&&D.connect(B);for(let le=0,Ce=0;le<y.numberOfOutputs;le+=1){const Ye=G[le];for(let $e=0;$e<m[le];$e+=1)B.connect(Ye,Ce+$e,$e);Ce+=m[le]}}xt=!0},In=()=>{ke&&(wt(),Ue()),xt=!1};return wt(),f(H,Kt,In)},XT=(t,e)=>{const n=t.createBiquadFilter();return an(n,e),Ft(n,e,"Q"),Ft(n,e,"detune"),Ft(n,e,"frequency"),Ft(n,e,"gain"),kt(n,e,"type"),n},D5=(t,e)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,i),an(i,r),i},O5=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw Tn()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw Tn()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw Tn()}})},uf=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return an(n,e),O5(n),n},L5=(t,e,n,r,i)=>(s,o)=>{if(s.createConstantSource===void 0)return n(s,o);const a=s.createConstantSource();return an(a,o),Ft(a,o,"offset"),e(r,()=>r(s))||eI(a),e(i,()=>i(s))||tI(a),t(s,a),a},$l=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),B5=(t,e,n,r)=>(i,{offset:s,...o})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(i,{...o,gain:s}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const d={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(p){l.channelCount=p},get channelCountMode(){return l.channelCountMode},set channelCountMode(p){l.channelCountMode=p},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(p){l.channelInterpretation=p},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(p){c.onended=p},addEventListener(...p){return c.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return c.dispatchEvent(p[0])},removeEventListener(...p){return c.removeEventListener(p[0],p[1],p[2])},start(p=0){c.start.call(c,p)},stop(p=0){c.stop.call(c,p)}},f=()=>c.connect(l),h=()=>c.disconnect(l);return t(i,c),r($l(d,l),f,h)},F5=(t,e)=>(n,r)=>{const i=n.createConvolver();if(an(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),kt(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",s=>()=>s.call(i),s=>o=>{if(o>2)throw t();return s.call(i,o)}),r.channelCountMode==="max"))throw t();return e(i,"channelCountMode",s=>()=>s.call(i),s=>o=>{if(o==="max")throw t();return s.call(i,o)}),i},$T=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return an(n,e),Ft(n,e,"delayTime"),n},U5=t=>(e,n)=>{const r=e.createDynamicsCompressor();if(an(r,n),n.channelCount>2||n.channelCountMode==="max")throw t();return Ft(r,n,"attack"),Ft(r,n,"knee"),Ft(r,n,"ratio"),Ft(r,n,"release"),Ft(r,n,"threshold"),r},mr=(t,e)=>{const n=t.createGain();return an(n,e),Ft(n,e,"gain"),n},G5=t=>(e,n,r)=>{if(e.createIIRFilter===void 0)return t(e,n,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return an(i,r),i};function V5(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function W5(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function gw(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)n=W5(n,e),n[0]+=t[r];return n}const H5=(t,e,n,r)=>(i,s,{channelCount:o,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const d=zT(s,i.sampleRate),f=l instanceof Float64Array?l:new Float64Array(l),h=u instanceof Float64Array?u:new Float64Array(u),p=f.length,g=h.length,y=Math.min(p,g);if(p===0||p>20)throw r();if(f[0]===0)throw e();if(g===0||g>20)throw r();if(h[0]===0)throw e();if(f[0]!==1){for(let _=0;_<g;_+=1)h[_]/=f[0];for(let _=1;_<p;_+=1)f[_]/=f[0]}const m=n(i,d,o,o);m.channelCount=o,m.channelCountMode=a,m.channelInterpretation=c;const v=32,S=[],E=[],A=[];for(let _=0;_<o;_+=1){S.push(0);const N=new Float32Array(v),M=new Float32Array(v);N.fill(0),M.fill(0),E.push(N),A.push(M)}m.onaudioprocess=_=>{const N=_.inputBuffer,M=_.outputBuffer,D=N.numberOfChannels;for(let B=0;B<D;B+=1){const G=N.getChannelData(B),V=M.getChannelData(B);S[B]=jT(f,p,h,g,y,E[B],A[B],S[B],v,G,V)}};const b=i.sampleRate/2;return $l({get bufferSize(){return d},get channelCount(){return m.channelCount},set channelCount(_){m.channelCount=_},get channelCountMode(){return m.channelCountMode},set channelCountMode(_){m.channelCountMode=_},get channelInterpretation(){return m.channelInterpretation},set channelInterpretation(_){m.channelInterpretation=_},get context(){return m.context},get inputs(){return[m]},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},addEventListener(..._){return m.addEventListener(_[0],_[1],_[2])},dispatchEvent(..._){return m.dispatchEvent(_[0])},getFrequencyResponse(_,N,M){if(_.length!==N.length||N.length!==M.length)throw t();const D=_.length;for(let B=0;B<D;B+=1){const G=-Math.PI*(_[B]/b),V=[Math.cos(G),Math.sin(G)],z=gw(h,V),X=gw(f,V),te=V5(z,X);N[B]=Math.sqrt(te[0]*te[0]+te[1]*te[1]),M[B]=Math.atan2(te[1],te[0])}},removeEventListener(..._){return m.removeEventListener(_[0],_[1],_[2])}},m)},Z5=(t,e)=>t.createMediaElementSource(e.mediaElement),j5=(t,e)=>{const n=t.createMediaStreamDestination();return an(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},z5=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((s,o)=>s.id<o.id?-1:s.id>o.id?1:0);const r=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},X5=(t,e)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),s=n.createMediaStreamSource(i);if(r.kind!=="audio")throw t();if(e(n))throw new TypeError;return s},$5=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,K5=(t,e,n,r,i,s)=>(o,a)=>{const c=o.createOscillator();return an(c,a),Ft(c,a,"detune"),Ft(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):kt(c,a,"type"),e(n,()=>n(o))||eI(c),e(r,()=>r(o))||s(c,o),e(i,()=>i(o))||tI(c),t(o,c),c},J5=t=>(e,n)=>{const r=e.createPanner();return r.orientationX===void 0?t(e,n):(an(r,n),Ft(r,n,"orientationX"),Ft(r,n,"orientationY"),Ft(r,n,"orientationZ"),Ft(r,n,"positionX"),Ft(r,n,"positionY"),Ft(r,n,"positionZ"),kt(r,n,"coneInnerAngle"),kt(r,n,"coneOuterAngle"),kt(r,n,"coneOuterGain"),kt(r,n,"distanceModel"),kt(r,n,"maxDistance"),kt(r,n,"panningModel"),kt(r,n,"refDistance"),kt(r,n,"rolloffFactor"),r)},Y5=(t,e,n,r,i,s,o,a,c,l)=>(u,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:h,distanceModel:p,maxDistance:g,orientationX:y,orientationY:m,orientationZ:v,panningModel:S,positionX:E,positionY:A,positionZ:b,refDistance:k,rolloffFactor:_,...N})=>{const M=u.createPanner();if(N.channelCount>2||N.channelCountMode==="max")throw o();an(M,N);const D={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},B=n(u,{...D,channelInterpretation:"speakers",numberOfInputs:6}),G=r(u,{...N,gain:1}),V=r(u,{...D,gain:1}),z=r(u,{...D,gain:0}),X=r(u,{...D,gain:0}),te=r(u,{...D,gain:0}),H=r(u,{...D,gain:0}),K=r(u,{...D,gain:0}),ie=i(u,256,6,1),$=s(u,{...D,curve:new Float32Array([1,1]),oversample:"none"});let se=[y,m,v],be=[E,A,b];const we=new Float32Array(1);ie.onaudioprocess=({inputBuffer:ce})=>{const xt=[c(ce,we,0),c(ce,we,1),c(ce,we,2)];xt.some((wt,Cn)=>wt!==se[Cn])&&(M.setOrientation(...xt),se=xt);const cn=[c(ce,we,3),c(ce,we,4),c(ce,we,5)];cn.some((wt,Cn)=>wt!==be[Cn])&&(M.setPosition(...cn),be=cn)},Object.defineProperty(z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(X.gain,"defaultValue",{get:()=>0}),Object.defineProperty(te.gain,"defaultValue",{get:()=>0}),Object.defineProperty(H.gain,"defaultValue",{get:()=>0}),Object.defineProperty(K.gain,"defaultValue",{get:()=>0});const me={get bufferSize(){},get channelCount(){return M.channelCount},set channelCount(ce){if(ce>2)throw o();G.channelCount=ce,M.channelCount=ce},get channelCountMode(){return M.channelCountMode},set channelCountMode(ce){if(ce==="max")throw o();G.channelCountMode=ce,M.channelCountMode=ce},get channelInterpretation(){return M.channelInterpretation},set channelInterpretation(ce){G.channelInterpretation=ce,M.channelInterpretation=ce},get coneInnerAngle(){return M.coneInnerAngle},set coneInnerAngle(ce){M.coneInnerAngle=ce},get coneOuterAngle(){return M.coneOuterAngle},set coneOuterAngle(ce){M.coneOuterAngle=ce},get coneOuterGain(){return M.coneOuterGain},set coneOuterGain(ce){if(ce<0||ce>1)throw e();M.coneOuterGain=ce},get context(){return M.context},get distanceModel(){return M.distanceModel},set distanceModel(ce){M.distanceModel=ce},get inputs(){return[G]},get maxDistance(){return M.maxDistance},set maxDistance(ce){if(ce<0)throw new RangeError;M.maxDistance=ce},get numberOfInputs(){return M.numberOfInputs},get numberOfOutputs(){return M.numberOfOutputs},get orientationX(){return V.gain},get orientationY(){return z.gain},get orientationZ(){return X.gain},get panningModel(){return M.panningModel},set panningModel(ce){M.panningModel=ce},get positionX(){return te.gain},get positionY(){return H.gain},get positionZ(){return K.gain},get refDistance(){return M.refDistance},set refDistance(ce){if(ce<0)throw new RangeError;M.refDistance=ce},get rolloffFactor(){return M.rolloffFactor},set rolloffFactor(ce){if(ce<0)throw new RangeError;M.rolloffFactor=ce},addEventListener(...ce){return G.addEventListener(ce[0],ce[1],ce[2])},dispatchEvent(...ce){return G.dispatchEvent(ce[0])},removeEventListener(...ce){return G.removeEventListener(ce[0],ce[1],ce[2])}};d!==me.coneInnerAngle&&(me.coneInnerAngle=d),f!==me.coneOuterAngle&&(me.coneOuterAngle=f),h!==me.coneOuterGain&&(me.coneOuterGain=h),p!==me.distanceModel&&(me.distanceModel=p),g!==me.maxDistance&&(me.maxDistance=g),y!==me.orientationX.value&&(me.orientationX.value=y),m!==me.orientationY.value&&(me.orientationY.value=m),v!==me.orientationZ.value&&(me.orientationZ.value=v),S!==me.panningModel&&(me.panningModel=S),E!==me.positionX.value&&(me.positionX.value=E),A!==me.positionY.value&&(me.positionY.value=A),b!==me.positionZ.value&&(me.positionZ.value=b),k!==me.refDistance&&(me.refDistance=k),_!==me.rolloffFactor&&(me.rolloffFactor=_),(se[0]!==1||se[1]!==0||se[2]!==0)&&M.setOrientation(...se),(be[0]!==0||be[1]!==0||be[2]!==0)&&M.setPosition(...be);const ke=()=>{G.connect(M),t(G,$,0,0),$.connect(V).connect(B,0,0),$.connect(z).connect(B,0,1),$.connect(X).connect(B,0,2),$.connect(te).connect(B,0,3),$.connect(H).connect(B,0,4),$.connect(K).connect(B,0,5),B.connect(ie).connect(u.destination)},Ue=()=>{G.disconnect(M),a(G,$,0,0),$.disconnect(V),V.disconnect(B),$.disconnect(z),z.disconnect(B),$.disconnect(X),X.disconnect(B),$.disconnect(te),te.disconnect(B),$.disconnect(H),H.disconnect(B),$.disconnect(K),K.disconnect(B),B.disconnect(ie),ie.disconnect(u.destination)};return l($l(me,M),ke,Ue)},q5=t=>(e,{disableNormalization:n,imag:r,real:i})=>{const s=r instanceof Float32Array?r:new Float32Array(r),o=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(o,s,{disableNormalization:n});if(Array.from(r).length<2)throw t();return a},df=(t,e,n,r)=>t.createScriptProcessor(e,n,r),Q5=(t,e)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,r);const s=n.createStereoPanner();return an(s,r),Ft(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:o=>{if(o!==i)throw e()}}),s},e3=(t,e,n,r,i,s)=>{const a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},d=(p,g,y,m)=>{const v=new Float32Array(16385),S=new Float32Array(16385);for(let N=0;N<16385;N+=1){const M=N/16384*c;v[N]=Math.cos(M),S[N]=Math.sin(M)}const E=n(p,{...l,gain:0}),A=r(p,{...u,curve:v}),b=r(p,{...u,curve:a}),k=n(p,{...l,gain:0}),_=r(p,{...u,curve:S});return{connectGraph(){g.connect(E),g.connect(b.inputs===void 0?b:b.inputs[0]),g.connect(k),b.connect(y),y.connect(A.inputs===void 0?A:A.inputs[0]),y.connect(_.inputs===void 0?_:_.inputs[0]),A.connect(E.gain),_.connect(k.gain),E.connect(m,0,0),k.connect(m,0,1)},disconnectGraph(){g.disconnect(E),g.disconnect(b.inputs===void 0?b:b.inputs[0]),g.disconnect(k),b.disconnect(y),y.disconnect(A.inputs===void 0?A:A.inputs[0]),y.disconnect(_.inputs===void 0?_:_.inputs[0]),A.disconnect(E.gain),_.disconnect(k.gain),E.disconnect(m,0,0),k.disconnect(m,0,1)}}},f=(p,g,y,m)=>{const v=new Float32Array(16385),S=new Float32Array(16385),E=new Float32Array(16385),A=new Float32Array(16385),b=Math.floor(16385/2);for(let te=0;te<16385;te+=1)if(te>b){const H=(te-b)/(16384-b)*c;v[te]=Math.cos(H),S[te]=Math.sin(H),E[te]=0,A[te]=1}else{const H=te/(16384-b)*c;v[te]=1,S[te]=0,E[te]=Math.cos(H),A[te]=Math.sin(H)}const k=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),_=n(p,{...l,gain:0}),N=r(p,{...u,curve:v}),M=n(p,{...l,gain:0}),D=r(p,{...u,curve:S}),B=r(p,{...u,curve:a}),G=n(p,{...l,gain:0}),V=r(p,{...u,curve:E}),z=n(p,{...l,gain:0}),X=r(p,{...u,curve:A});return{connectGraph(){g.connect(k),g.connect(B.inputs===void 0?B:B.inputs[0]),k.connect(_,0),k.connect(M,0),k.connect(G,1),k.connect(z,1),B.connect(y),y.connect(N.inputs===void 0?N:N.inputs[0]),y.connect(D.inputs===void 0?D:D.inputs[0]),y.connect(V.inputs===void 0?V:V.inputs[0]),y.connect(X.inputs===void 0?X:X.inputs[0]),N.connect(_.gain),D.connect(M.gain),V.connect(G.gain),X.connect(z.gain),_.connect(m,0,0),G.connect(m,0,0),M.connect(m,0,1),z.connect(m,0,1)},disconnectGraph(){g.disconnect(k),g.disconnect(B.inputs===void 0?B:B.inputs[0]),k.disconnect(_,0),k.disconnect(M,0),k.disconnect(G,1),k.disconnect(z,1),B.disconnect(y),y.disconnect(N.inputs===void 0?N:N.inputs[0]),y.disconnect(D.inputs===void 0?D:D.inputs[0]),y.disconnect(V.inputs===void 0?V:V.inputs[0]),y.disconnect(X.inputs===void 0?X:X.inputs[0]),N.disconnect(_.gain),D.disconnect(M.gain),V.disconnect(G.gain),X.disconnect(z.gain),_.disconnect(m,0,0),G.disconnect(m,0,0),M.disconnect(m,0,1),z.disconnect(m,0,1)}}},h=(p,g,y,m,v)=>{if(g===1)return d(p,y,m,v);if(g===2)return f(p,y,m,v);throw i()};return(p,{channelCount:g,channelCountMode:y,pan:m,...v})=>{if(y==="max")throw i();const S=t(p,{...v,channelCount:1,channelCountMode:y,numberOfInputs:2}),E=n(p,{...v,channelCount:g,channelCountMode:y,gain:1}),A=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:m});let{connectGraph:b,disconnectGraph:k}=h(p,g,E,A,S);Object.defineProperty(A.gain,"defaultValue",{get:()=>0}),Object.defineProperty(A.gain,"maxValue",{get:()=>1}),Object.defineProperty(A.gain,"minValue",{get:()=>-1});const _={get bufferSize(){},get channelCount(){return E.channelCount},set channelCount(B){E.channelCount!==B&&(N&&k(),{connectGraph:b,disconnectGraph:k}=h(p,B,E,A,S),N&&b()),E.channelCount=B},get channelCountMode(){return E.channelCountMode},set channelCountMode(B){if(B==="clamped-max"||B==="max")throw i();E.channelCountMode=B},get channelInterpretation(){return E.channelInterpretation},set channelInterpretation(B){E.channelInterpretation=B},get context(){return E.context},get inputs(){return[E]},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get pan(){return A.gain},addEventListener(...B){return E.addEventListener(B[0],B[1],B[2])},dispatchEvent(...B){return E.dispatchEvent(B[0])},removeEventListener(...B){return E.removeEventListener(B[0],B[1],B[2])}};let N=!1;const M=()=>{b(),N=!0},D=()=>{k(),N=!1};return s($l(_,S),M,D)}},t3=(t,e,n,r,i,s,o)=>(a,c)=>{const l=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,c);an(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();kt(l,{curve:u},"curve"),kt(l,c,"oversample");let d=null,f=!1;return o(l,"curve",g=>()=>g.call(l),g=>y=>(g.call(l,y),f&&(r(y)&&d===null?d=t(a,l):!r(y)&&d!==null&&(d(),d=null)),y)),i(l,()=>{f=!0,r(l.curve)&&(d=t(a,l))},()=>{f=!1,d!==null&&(d(),d=null)})},n3=(t,e,n,r,i)=>(s,{curve:o,oversample:a,...c})=>{const l=s.createWaveShaper(),u=s.createWaveShaper();an(l,c),an(u,c);const d=n(s,{...c,gain:1}),f=n(s,{...c,gain:-1}),h=n(s,{...c,gain:1}),p=n(s,{...c,gain:-1});let g=null,y=!1,m=null;const v={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(A){d.channelCount=A,f.channelCount=A,l.channelCount=A,h.channelCount=A,u.channelCount=A,p.channelCount=A},get channelCountMode(){return l.channelCountMode},set channelCountMode(A){d.channelCountMode=A,f.channelCountMode=A,l.channelCountMode=A,h.channelCountMode=A,u.channelCountMode=A,p.channelCountMode=A},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(A){d.channelInterpretation=A,f.channelInterpretation=A,l.channelInterpretation=A,h.channelInterpretation=A,u.channelInterpretation=A,p.channelInterpretation=A},get context(){return l.context},get curve(){return m},set curve(A){if(A!==null&&A.length<2)throw e();if(A===null)l.curve=A,u.curve=A;else{const b=A.length,k=new Float32Array(b+2-b%2),_=new Float32Array(b+2-b%2);k[0]=A[0],_[0]=-A[b-1];const N=Math.ceil((b+1)/2),M=(b+1)/2-1;for(let D=1;D<N;D+=1){const B=D/N*M,G=Math.floor(B),V=Math.ceil(B);k[D]=G===V?A[G]:(1-(B-G))*A[G]+(1-(V-B))*A[V],_[D]=G===V?-A[b-1-G]:-((1-(B-G))*A[b-1-G])-(1-(V-B))*A[b-1-V]}k[N]=b%2===1?A[N-1]:(A[N-2]+A[N-1])/2,l.curve=k,u.curve=_}m=A,y&&(r(m)&&g===null?g=t(s,d):g!==null&&(g(),g=null))},get inputs(){return[d]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(A){l.oversample=A,u.oversample=A},addEventListener(...A){return d.addEventListener(A[0],A[1],A[2])},dispatchEvent(...A){return d.dispatchEvent(A[0])},removeEventListener(...A){return d.removeEventListener(A[0],A[1],A[2])}};o!==null&&(v.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==v.oversample&&(v.oversample=a);const S=()=>{d.connect(l).connect(h),d.connect(f).connect(u).connect(p).connect(h),y=!0,r(m)&&(g=t(s,d))},E=()=>{d.disconnect(l),l.disconnect(h),d.disconnect(f),f.disconnect(u),u.disconnect(p),p.disconnect(h),y=!1,g!==null&&(g(),g=null)};return i($l(v,h),S,E)},gr=()=>new DOMException("","NotSupportedError"),r3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},i3=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...r3,...l},f=n(u,d),h=s(u),p=h?r():null,g=c.sampleRate/2;super(c,!1,f,p),this._detune=e(this,h,f.detune,153600,-153600),this._frequency=e(this,h,f.frequency,g,-g),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){Rl(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),eo(this)&&af(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},s3=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null,c=null;const l=async(u,d)=>{let f=n(u);const h=Wn(f,d);if(!h){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:o===null?void 0:o,type:f.type};f=e(d,p),a!==null&&f.start(a),c!==null&&f.stop(c)}return s.set(d,f),h?(await t(d,u.detune,f.detune),await t(d,u.frequency,f.frequency)):(await r(d,u.detune,f.detune),await r(d,u.frequency,f.frequency)),await i(u,d,f),f};return{set periodicWave(u){o=u},set start(u){a=u},set stop(u){c=u},render(u,d){const f=s.get(d);return f!==void 0?Promise.resolve(f):l(u,d)}}},o3={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},a3=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...o3,...l},f=n(u,d),h=s(u),p=h?r():null;super(c,!1,f,p),this._nativePannerNode=f,this._orientationX=e(this,h,f.orientationX,Kn,ar),this._orientationY=e(this,h,f.orientationY,Kn,ar),this._orientationZ=e(this,h,f.orientationZ,Kn,ar),this._positionX=e(this,h,f.positionX,Kn,ar),this._positionY=e(this,h,f.positionY,Kn,ar),this._positionZ=e(this,h,f.positionZ,Kn,ar),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},c3=(t,e,n,r,i,s,o,a,c,l)=>()=>{const u=new WeakMap;let d=null;const f=async(h,p)=>{let g=null,y=s(h);const m={channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation},v={...m,coneInnerAngle:y.coneInnerAngle,coneOuterAngle:y.coneOuterAngle,coneOuterGain:y.coneOuterGain,distanceModel:y.distanceModel,maxDistance:y.maxDistance,panningModel:y.panningModel,refDistance:y.refDistance,rolloffFactor:y.rolloffFactor},S=Wn(y,p);if("bufferSize"in y)g=r(p,{...m,gain:1});else if(!S){const E={...v,orientationX:y.orientationX.value,orientationY:y.orientationY.value,orientationZ:y.orientationZ.value,positionX:y.positionX.value,positionY:y.positionY.value,positionZ:y.positionZ.value};y=i(p,E)}if(u.set(p,g===null?y:g),g!==null){if(d===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const D=new o(6,h.context.length,p.sampleRate),B=e(D,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});B.connect(D.destination),d=(async()=>{const G=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map(async(V,z)=>{const X=n(D,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:z===0?1:0});return await a(D,V,X.offset),X}));for(let V=0;V<6;V+=1)G[V].connect(B,0,V),G[V].start(0);return l(D)})()}const E=await d,A=r(p,{...m,gain:1});await c(h,p,A);const b=[];for(let D=0;D<E.numberOfChannels;D+=1)b.push(E.getChannelData(D));let k=[b[0][0],b[1][0],b[2][0]],_=[b[3][0],b[4][0],b[5][0]],N=r(p,{...m,gain:1}),M=i(p,{...v,orientationX:k[0],orientationY:k[1],orientationZ:k[2],positionX:_[0],positionY:_[1],positionZ:_[2]});A.connect(N).connect(M.inputs[0]),M.connect(g);for(let D=128;D<E.length;D+=128){const B=[b[0][D],b[1][D],b[2][D]],G=[b[3][D],b[4][D],b[5][D]];if(B.some((V,z)=>V!==k[z])||G.some((V,z)=>V!==_[z])){k=B,_=G;const V=D/p.sampleRate;N.gain.setValueAtTime(0,V),N=r(p,{...m,gain:0}),M=i(p,{...v,orientationX:k[0],orientationY:k[1],orientationZ:k[2],positionX:_[0],positionY:_[1],positionZ:_[2]}),N.gain.setValueAtTime(1,V),A.connect(N).connect(M.inputs[0]),M.connect(g)}}return g}return S?(await t(p,h.orientationX,y.orientationX),await t(p,h.orientationY,y.orientationY),await t(p,h.orientationZ,y.orientationZ),await t(p,h.positionX,y.positionX),await t(p,h.positionY,y.positionY),await t(p,h.positionZ,y.positionZ)):(await a(p,h.orientationX,y.orientationX),await a(p,h.orientationY,y.orientationY),await a(p,h.orientationZ,y.orientationZ),await a(p,h.positionX,y.positionX),await a(p,h.positionY,y.positionY),await a(p,h.positionZ,y.positionZ)),Xl(y)?await c(h,p,y.inputs[0]):await c(h,p,y),y};return{render(h,p){const g=u.get(p);return g!==void 0?Promise.resolve(g):f(h,p)}}},l3={disableNormalization:!1},u3=(t,e,n,r)=>class KT{constructor(s,o){const a=e(s),c=r({...l3,...o}),l=t(a,c);return n.add(l),l}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===KT.prototype||n.has(s)}},d3=(t,e)=>(n,r,i)=>(t(r).replay(i),e(r,n,i)),f3=(t,e,n)=>async(r,i,s)=>{const o=t(r);await Promise.all(o.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{const f=await e(l).render(l,i),h=r.context.destination;!n(l)&&(r!==h||!n(r))&&f.connect(s,u,c)})).reduce((a,c)=>[...a,...c],[]))},h3=(t,e,n)=>async(r,i,s)=>{const o=e(r);await Promise.all(Array.from(o.activeInputs).map(async([a,c])=>{const u=await t(a).render(a,i);n(a)||u.connect(s,c)}))},p3=(t,e,n,r)=>i=>t(_y,()=>_y(i))?Promise.resolve(t(r,r)).then(s=>{if(!s){const o=n(i,512,0,1);i.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>i.currentTime,o.connect(i.destination)}return i.startRendering()}):new Promise(s=>{const o=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{o.disconnect(),s(a.renderedBuffer)},o.connect(i.destination),i.startRendering()}),m3=t=>(e,n)=>{t.set(e,n)},g3=t=>(e,n)=>t.set(e,n),v3={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},y3=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=i(a),u={...v3,...c},d=n(l,u),f=s(l),h=f?r():null;super(a,!1,d,h),this._pan=e(this,f,d.pan)}get pan(){return this._pan}},C3=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Wn(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,d)}return s.set(c,l),u?await t(c,a.pan,l.pan):await r(c,a.pan,l.pan),Xl(l)?await i(a,c,l.inputs[0]):await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},I3=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},S3=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(n);let s=!1,o=!1;try{await r.audioWorklet.addModule(i);const a=new t(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>o=!0,c.connect(a),c.start(0),await r.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(i)}return s&&!o},b3=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},w3=()=>new DOMException("","UnknownError"),A3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},k3=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...A3,...l},f=n(u,d),p=s(u)?r():null;super(c,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},E3=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Wn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(o,l)}return r.set(o,a),Xl(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},T3=()=>typeof window>"u"?null:window,_3=(t,e)=>n=>{n.copyFromChannel=(r,i,s=0)=>{const o=t(s),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=o<0?-o:0;d+o<c&&d<u;d+=1)r[d]=l[d+o]},n.copyToChannel=(r,i,s=0)=>{const o=t(s),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=o<0?-o:0;d+o<c&&d<u;d+=1)l[d+o]=r[d]}},R3=t=>e=>{e.copyFromChannel=(n=>(r,i,s=0)=>{const o=t(s),a=t(i);if(o<e.length)return n.call(e,r,a,o)})(e.copyFromChannel),e.copyToChannel=(n=>(r,i,s=0)=>{const o=t(s),a=t(i);if(o<e.length)return n.call(e,r,a,o)})(e.copyToChannel)},N3=t=>(e,n)=>{const r=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),t(e,"buffer",i=>()=>{const s=i.call(e);return s===r?null:s},i=>s=>i.call(e,s===null?r:s))},P3=(t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let c=0;c<a;c+=1)i.connect(r,0,c)},()=>i.disconnect(r))},JT=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),YT=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},ff=(t,e,n,r)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:s,set:o}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(s),set:r(o)})},M3=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),x3=t=>({...t,channelCount:t.numberOfOutputs}),D3=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},qT=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(r){if(r.code!==9)throw r;qT(t,e,n+1e-7)}},O3=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},L3=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},B3=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},nI=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},QT=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},rI=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},F3=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},U3=t=>{t.start=(e=>(n=0,r=0,i)=>{const s=t.buffer,o=s===null?r:Math.min(s.duration,r);s!==null&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,i)})(t.start)},e_=(t,e)=>{const n=e.createGain();t.connect(n);const r=(i=>()=>{i.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),$l(t,n),t.stop=(i=>{let s=!1;return(o=0)=>{if(s)try{i.call(t,o)}catch{n.gain.setValueAtTime(0,o)}else i.call(t,o),s=!0}})(t.stop)},Kl=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},G3=h2(ac),V3=C2(ac),W3=PF(mm),t_=new WeakMap,H3=KF(t_),mo=cF(new Map,new WeakMap),ds=T3(),n_=S5(mo,hs),r_=$F(Qn),Pn=f3(Qn,r_,$a),Z3=A2(n_,bt,Pn),gt=qF(xT),ga=$5(ds),lt=d5(ga),i_=new WeakMap,s_=VF(Kl),hf=k5(ds),o_=a5(hf),a_=c5(ds),j3=l5(ds),Td=T5(ds),Zt=J2(p2(RT),y2(G3,V3,pp,W3,mp,Qn,H3,of,bt,ac,eo,$a,Sh),mo,o5(by,mp,Qn,bt,Ed,eo),hs,gm,gr,TF(pp,by,Qn,bt,Ed,gt,eo,lt),DF(i_,Qn,ki),s_,gt,o_,a_,j3,lt,Td),z3=w2(Zt,Z3,hs,n_,gt,lt),c_=new WeakSet,vw=b5(ds),l_=SF(new Uint32Array(1)),u_=_3(l_,hs),d_=R3(l_),X3=E2(c_,mo,gr,vw,ga,I3(vw),u_,d_),vm=I2(mr),f_=h3(r_,cf,$a),ps=mF(f_),Jl=A5(vm,mo,O3,L3,B3,nI,QT,rI,U3,N3(ff),e_),ms=d3(JF(cf),f_),$3=R2(ps,Jl,bt,ms,Pn),_i=Y2(m2(PT),i_,MT,q2,a2,c2,l2,u2,d2,Cy,TT,hf,qT),K3=_2(Zt,$3,_i,Tn,Jl,gt,lt,Kl),J3=U2(Zt,G2,hs,Tn,E5(mr,ff),gt,lt,Pn),Y3=aF(ps,XT,bt,ms,Pn),cc=g3(t_),q3=oF(Zt,_i,Y3,gm,XT,gt,lt,cc),va=C5(ac,a_),Q3=P3(Tn,va),ya=D5(hf,Q3),eU=dF(ya,bt,Pn),tU=uF(Zt,eU,ya,gt,lt),nU=pF(uf,bt,Pn),rU=hF(Zt,nU,uf,gt,lt,x3),iU=B5(vm,Jl,mr,va),Yl=L5(vm,mo,iU,nI,rI),sU=IF(ps,Yl,bt,ms,Pn),oU=CF(Zt,_i,sU,Yl,gt,lt,Kl),h_=F5(gr,ff),aU=AF(h_,bt,Pn),cU=wF(Zt,aU,h_,gt,lt,cc),lU=NF(ps,$T,bt,ms,Pn),uU=RF(Zt,_i,lU,$T,gt,lt,cc),p_=U5(gr),dU=FF(ps,p_,bt,ms,Pn),fU=BF(Zt,_i,dU,p_,gr,gt,lt,cc),hU=zF(ps,mr,bt,ms,Pn),pU=jF(Zt,_i,hU,mr,gt,lt),mU=H5(gm,Tn,df,gr),iI=p3(mo,mr,df,b3(mr,ga)),gU=s5(Jl,bt,ga,Pn,iI),vU=G5(mU),yU=r5(Zt,vU,gU,gt,lt,cc),CU=V2(_i,ya,Yl,df,gr,JT,lt,ff),m_=new WeakMap,IU=y5(J3,CU,s_,lt,m_,Kl),g_=K5(vm,mo,nI,QT,rI,e_),SU=s3(ps,g_,bt,ms,Pn),bU=i3(Zt,_i,g_,SU,gt,lt,Kl),v_=vF(Jl),wU=n3(v_,Tn,mr,YT,va),ym=t3(v_,Tn,wU,YT,va,hf,ff),AU=Y5(pp,Tn,ya,mr,df,ym,gr,mp,JT,va),y_=J5(AU),kU=c3(ps,ya,Yl,mr,y_,bt,ga,ms,Pn,iI),EU=a3(Zt,_i,y_,kU,gt,lt,cc),TU=q5(hs),_U=u3(TU,gt,new WeakSet,D3),RU=e3(ya,uf,mr,ym,gr,va),C_=Q5(RU,gr),NU=C3(ps,C_,bt,ms,Pn),PU=y3(Zt,_i,C_,NU,gt,lt),MU=E3(ym,bt,Pn),xU=k3(Zt,Tn,ym,MU,gt,lt,cc),I_=f5(ds),sI=WF(ds),S_=new WeakMap,DU=QF(S_,ga),OU=I_?v2(mo,gr,GF(ds),sI,HF(f2),gt,DU,lt,Td,new WeakMap,new WeakMap,S3(Td,ga),ds):void 0,LU=u5(o_,lt),BU=EF(c_,mo,kF,UF,new WeakSet,gt,LU,Ey,_y,u_,d_),FU=iF(OU,z3,X3,K3,q3,tU,rU,oU,cU,BU,uU,fU,pU,yU,IU,bU,EU,_U,PU,xU),UU=h5(Zt,Z5,gt,lt),GU=m5(Zt,j5,gt,lt),VU=g5(Zt,z5,gt,lt),WU=X5(Tn,lt),HU=v5(Zt,WU,gt),ZU=F2(FU,Tn,gr,w3,UU,GU,VU,HU,hf),b_=e5(m_),jU=S2(b_),w_=gF(hs),zU=MF(b_),A_=OF(hs),k_=new WeakMap,XU=XF(k_,ki),$U=x5(w_,hs,Tn,ya,uf,Yl,mr,df,gr,A_,sI,XU,va),KU=R5(Tn,$U,mr,gr,va),JU=rF(ps,w_,Jl,ya,uf,Yl,mr,zU,A_,sI,bt,Td,ga,ms,Pn,iI),YU=YF(S_),qU=m3(k_),yw=I_?eF(jU,Zt,_i,JU,KU,Qn,YU,gt,lt,Td,M3,qU,F3,Kl):void 0;class E_{static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getAudioBufferFromCache(e,n,r){try{const i=await n.match(e);if(i){const s=await i.arrayBuffer();return r.decodeAudioData(s)}return null}catch(i){throw console.error("Failed to get audio data from cache:",i),i}}static async fetchAndCacheAudioBuffer(e,n,r){try{const i=await fetch(e),s=i.clone();n.put(e,s);const o=await i.arrayBuffer();return r.decodeAudioData(o)}catch(i){throw console.error("Failed to fetch and cache audio data:",i),i}}static async getAudioBuffer(e,n){const r=await this.openCache();let i=this.pendingRequests.get(e);return i||await this.getAudioBufferFromCache(e,r,n)||(i=this.fetchAndCacheAudioBuffer(e,r,n),this.pendingRequests.set(e,i),i)}}j(E_,"pendingRequests",new Map);const QU=(t,e)=>{var n=new Uint8Array(t.byteLength+e.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),t.byteLength),n.buffer};function e4(t,e){const n=[];let r=0;fetch(t).then(function(s){if(!s.ok)throw new Error("HTTP error, status = "+s.status);if(!s.body)throw new Error("Missing body");var o=s.body.getReader();let a=new ArrayBuffer(0);function c(){return o.read().then(({value:l,done:u})=>{let d=null;if(l){if(a.byteLength?d=QU(a,l.buffer):(a=l.buffer.slice(0,44),d=l.buffer),e.decodeAudioData(d,function(f){n.push(f),n.length&&i()},function(f){console.log("err(decodeAudioData): "+f)}),u){console.log("done");return}c()}})}c()});function i(){for(;n.length;){let s=n.shift();const o=e.createBufferSource();if(!s)return;o.buffer=s,o.connect(e.destination),r==0&&(r=e.currentTime+.02),o.start(r),r+=o.buffer.duration}}}const t4="data:application/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";var T_=(t=>(t.HTML="HTML",t.Streaming="Streaming",t.Buffer="Buffer",t))(T_||{});let n4=class{constructor(e){j(this,"context");j(this,"globalGainNode");j(this,"listener");j(this,"prevVolume",1);j(this,"finalizationRegistry");j(this,"createOscillator",({frequency:e,type:n,periodicWave:r})=>{const i=this.context.createOscillator();return i.type=n||"sine",i.setPeriodicWave(r),i.frequency.value=e,i.connect(this.globalGainNode),i});this.context=e||new ZU,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.finalizationRegistry=new FinalizationRegistry(n=>{n.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",t4):console.warn("AudioWorklet not supported")}async createWorkletNode(e,n){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new yw(this.context,e)}catch(r){console.error(r),console.log("Loading worklet from url",n);try{await this.context.audioWorklet.addModule(n)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${n}`)}return new yw(this.context,e)}}async createSound(e,n="Buffer"){if(e instanceof AudioBuffer)return Promise.resolve(new jf("",e,this.context,this.globalGainNode,"Buffer"));const r=e;if(n==="HTML"){const i=new Audio;return i.src=r,i.crossOrigin="anonymous",new jf(r,void 0,this.context,this.globalGainNode,"HTML")}return E_.getAudioBuffer(r,this.context).then(i=>new jf(r,i,this.context,this.globalGainNode,n))}async createGroup(e){const n=new Cw;return e.forEach(r=>n.addSound(r)),n}async createGroupFromUrls(e){const n=new Cw;return(await Promise.all(e.map(r=>this.createSound(r)))).forEach(r=>n.addSound(r)),n}async createStream(e){return await e4(e,this.context),new jf(e,void 0,this.context,this.globalGainNode,"Streaming")}createBiquadFilter({type:e,frequency:n,gain:r,Q:i}){const s=this.context.createBiquadFilter();return s.type=e||"lowpass",s.frequency.value=n||350,s.gain.value=r||0,s.Q.value=i||1,s}createPanner({coneInnerAngle:e,coneOuterAngle:n,coneOuterGain:r,distanceModel:i,maxDistance:s,channelCount:o,channelCountMode:a,channelInterpretation:c,panningModel:l,refDistance:u,rolloffFactor:d,positionX:f,positionY:h,positionZ:p,orientationX:g,orientationY:y,orientationZ:m}){const v=this.context.createPanner();return v.coneInnerAngle=e||360,v.coneOuterAngle=n||360,v.coneOuterGain=r||0,v.distanceModel=i||"inverse",v.maxDistance=s||1e4,v.channelCount=o||2,v.channelCountMode=a||"clamped-max",v.channelInterpretation=c||"speakers",v.panningModel=l||"HRTF",v.refDistance=u||1,v.rolloffFactor=d||1,v.positionX.value=f||0,v.positionY.value=h||0,v.positionZ.value=p||0,v.orientationX.value=g||0,v.orientationY.value=y||0,v.orientationZ.value=m||0,v}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new s4(this.context);i.play(),e(i)}).catch(r=>{n(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:n,up:r}=e,[i,s,o]=n,[a,c,l]=r;this.listener.forwardX.setValueAtTime(i,this.context.currentTime),this.listener.forwardY.setValueAtTime(s,this.context.currentTime),this.listener.forwardZ.setValueAtTime(o,this.context.currentTime),this.listener.upX.setValueAtTime(a,this.context.currentTime),this.listener.upY.setValueAtTime(c,this.context.currentTime),this.listener.upZ.setValueAtTime(l,this.context.currentTime)}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[n,r,i]=e;this.listener.upX.setValueAtTime(n,this.context.currentTime),this.listener.upY.setValueAtTime(r,this.context.currentTime),this.listener.upZ.setValueAtTime(i,this.context.currentTime)}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[n,r,i]=e;this.listener.forwardX.setValueAtTime(n,this.context.currentTime),this.listener.forwardY.setValueAtTime(r,this.context.currentTime),this.listener.forwardZ.setValueAtTime(i,this.context.currentTime)}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[n,r,i]=e;this.listener.positionX.setValueAtTime(n,this.context.currentTime),this.listener.positionY.setValueAtTime(r,this.context.currentTime),this.listener.positionZ.setValueAtTime(i,this.context.currentTime)}},Cm=class{constructor(){j(this,"filters",[])}addFilter(e){this.filters.push(e)}removeFilter(e){this.filters=this.filters.filter(n=>n!==e)}applyFilters(e){return this.filters.reduce((n,r)=>(n.connect(r),r),e),this.filters.length>0?this.filters[this.filters.length-1]:e}},jf=class extends Cm{constructor(n,r,i,s,o="Buffer"){super();j(this,"buffer");j(this,"context");j(this,"playbacks",[]);j(this,"globalGainNode");j(this,"_position",[0,0,0]);j(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});j(this,"loopCount",0);j(this,"_playbackRate",1);j(this,"_volume",1);this.url=n,this.type=o,this.buffer=r,this.context=i,this.globalGainNode=s,this._position=[0,0,0]}preplay(){let n;if(this.buffer)n=this.context.createBufferSource(),n.buffer=this.buffer;else{const s=new Audio;s.crossOrigin="anonymous",s.src=this.url,s.preload="auto",n=this.context.createMediaElementSource(s)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new r4(n,r,this.context,this.loopCount);return i.volume=this.volume,i.playbackRate=this.playbackRate,this.filters.forEach(s=>i.addFilter(s)),i.threeDOptions=this.threeDOptions,i.position=this.position,this.playbacks.push(i),[i]}play(){const n=this.preplay();return n.forEach(r=>r.play()),n}stop(){this.playbacks.forEach(n=>n.stop())}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}seek(n){this.playbacks.forEach(r=>r.seek(n))}get duration(){var n;return((n=this.buffer)==null?void 0:n.duration)||0}set position(n){this._threeDOptions.positionX=n[0],this._threeDOptions.positionY=n[1],this._threeDOptions.positionZ=n[2],this.playbacks.forEach(r=>r.position=n)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}get threeDOptions(){return this._threeDOptions}set threeDOptions(n){this._threeDOptions={...this._threeDOptions,...n},this.playbacks.forEach(r=>r.threeDOptions=this._threeDOptions)}loop(n){return n===void 0?this.loopCount:(this.loopCount=n,this.playbacks.forEach(r=>r.sourceLoop=!0),this.loopCount)}addFilter(n){super.addFilter(n),this.playbacks.forEach(r=>r.addFilter(n))}removeFilter(n){super.removeFilter(n),this.playbacks.forEach(r=>r.removeFilter(n))}get volume(){return this._volume}set volume(n){this._volume=n,this.playbacks.forEach(r=>r.volume=n)}isPlaying(){return this.playbacks.some(n=>n.isPlaying())}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.playbacks.forEach(r=>r.playbackRate=n)}},r4=class extends Cm{constructor(n,r,i,s=0){super();j(this,"context");j(this,"source");j(this,"gainNode");j(this,"panner");j(this,"loopCount",0);j(this,"currentLoop",0);j(this,"buffer");j(this,"playing",!1);this.loopCount=s,this.source=n,"buffer"in n&&n.buffer&&(this.buffer=n.buffer),"mediaElement"in n&&n.mediaElement?n.mediaElement.onended=this.handleLoop.bind(this):"onended"in n&&(n.onended=this.handleLoop.bind(this)),this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner),this.panner.connect(this.gainNode),this.refreshFilters()}get duration(){if(!this.buffer)throw new Error("Cannot get duration of a sound that has been cleaned up");return this.buffer.duration}get playbackRate(){if(!this.source)throw new Error("Cannot get playback rate of a sound that has been cleaned up");if("playbackRate"in this.source)return this.source.playbackRate.value;if("mediaElement"in this.source&&this.source.mediaElement)return this.source.mediaElement.playbackRate;throw new Error("Unsupported source type")}set playbackRate(n){if(!this.source)throw new Error("Cannot set playback rate of a sound that has been cleaned up");"playbackRate"in this.source&&(this.source.playbackRate.value=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=n)}handleLoop(){this.buffer?(this.source=this.context.createBufferSource(),this.source.buffer=this.buffer):this.seek(0),this.loopCount==="infinite"||this.currentLoop<this.loopCount?(this.currentLoop++,this.playing&&this.play()):this.playing=!1}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():"start"in this.source&&this.source.start&&this.source.start(),this.playing=!0,[this]}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");return{coneInnerAngle:this.panner.coneInnerAngle,coneOuterAngle:this.panner.coneOuterAngle,coneOuterGain:this.panner.coneOuterGain,distanceModel:this.panner.distanceModel,maxDistance:this.panner.maxDistance,channelCount:this.panner.channelCount,channelCountMode:this.panner.channelCountMode,channelInterpretation:this.panner.channelInterpretation,panningModel:this.panner.panningModel,refDistance:this.panner.refDistance,rolloffFactor:this.panner.rolloffFactor,positionX:this.panner.positionX.value,positionY:this.panner.positionY.value,positionZ:this.panner.positionZ.value,orientationX:this.panner.orientationX.value,orientationY:this.panner.orientationY.value,orientationZ:this.panner.orientationZ.value}}set threeDOptions(n){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");this.panner.coneInnerAngle=n.coneInnerAngle||this.panner.coneInnerAngle,this.panner.coneOuterAngle=n.coneOuterAngle||this.panner.coneOuterAngle,this.panner.coneOuterGain=n.coneOuterGain||this.panner.coneOuterGain,this.panner.distanceModel=n.distanceModel||this.panner.distanceModel,this.panner.maxDistance=n.maxDistance||this.panner.maxDistance,this.panner.channelCount=n.channelCount||this.panner.channelCount,this.panner.channelCountMode=n.channelCountMode||this.panner.channelCountMode,this.panner.channelInterpretation=n.channelInterpretation||this.panner.channelInterpretation,this.panner.panningModel=n.panningModel||this.panner.panningModel,this.panner.refDistance=n.refDistance||this.panner.refDistance,this.panner.rolloffFactor=n.rolloffFactor||this.panner.rolloffFactor,this.panner.positionX.value=n.positionX||this.panner.positionX.value,this.panner.positionY.value=n.positionY||this.panner.positionY.value,this.panner.positionZ.value=n.positionZ||this.panner.positionZ.value,this.panner.orientationX.value=n.orientationX||this.panner.orientationX.value,this.panner.orientationY.value=n.orientationY||this.panner.orientationY.value,this.panner.orientationZ.value=n.orientationZ||this.panner.orientationZ.value}seek(n){if(!this.source||!this.buffer||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");const r=this.isPlaying();this.stop(),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.refreshFilters(),this.source.connect(this.panner).connect(this.gainNode),r&&this.source.start(0,n)}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}set sourceLoop(n){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=n)}fadeIn(n,r="linear"){return new Promise(i=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value;const s=1;switch(this.gainNode.gain.value=0,r){case"exponential":this.gainNode.gain.setValueAtTime(.01,this.context.currentTime),this.gainNode.gain.exponentialRampToValueAtTime(s,this.context.currentTime+n);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(s,this.context.currentTime+n);break}setTimeout(()=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value=s,i()},n*1e3)})}fadeOut(n,r="linear"){return new Promise(i=>{if(!this.gainNode)throw new Error("Cannot fade out a sound that has been cleaned up");switch(this.gainNode.gain.value,r){case"exponential":this.gainNode.gain.exponentialRampToValueAtTime(.01,this.context.currentTime+n);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+n)}setTimeout(()=>i(),n*1e3)})}isPlaying(){if(!this.source)throw new Error("Cannot check if a sound is playing that has been cleaned up");return this.playing}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this.filters.forEach(n=>{n&&n.disconnect()}),this.filters=[]}loop(n){var r;if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(this.source instanceof AudioBufferSourceNode)return n===void 0?this.source.loop===!0?"infinite":0:(this.source.loop=!0,this.source.loopEnd=((r=this.source.buffer)==null?void 0:r.duration)||0,this.source.loopStart=0,this.source.loop===!0?"infinite":0);if("mediaElement"in this.source&&this.source.mediaElement){const i=this.source.mediaElement;return n===void 0||(i.loop=!0),i.loop===!0?"infinite":0}throw new Error("Unsupported source type")}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.isPlaying()&&("stop"in this.source&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this.playing=!1)}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");"suspend"in this.source.context&&this.source.context.suspend()}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");"resume"in this.source.context&&this.source.context.resume()}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,s]=n;this.panner.positionX.setValueAtTime(r,this.context.currentTime),this.panner.positionY.setValueAtTime(i,this.context.currentTime),this.panner.positionZ.setValueAtTime(s,this.context.currentTime)}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}},Cw=class{constructor(){j(this,"sounds",[]);j(this,"_position",[0,0,0]);j(this,"loopCount",0)}get duration(){return this.sounds.map(e=>e.duration).reduce((e,n)=>Math.max(e,n),0)}seek(e){this.sounds.forEach(n=>n.seek&&n.seek(e))}addSound(e){this.sounds.push(e)}preplay(){return this.sounds.reduce((e,n)=>(n.loop&&n.loop(this.loopCount),e.concat(n.preplay())),[])}play(){return this.preplay().map(e=>(e.play(),e))}isPlaying(){return this.sounds.some(e=>e.isPlaying())}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}resume(){this.sounds.forEach(e=>e.resume())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(n=>n.loop&&n.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(n=>n.addFilter(e))}removeFilter(e){this.sounds.forEach(n=>n.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(n=>n.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,n)=>e+n,0)/this.sounds.length}set volume(e){this.sounds.forEach(n=>n.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(n=>n.playbackRate=e)}};class i4 extends Cm{constructor(n,r,i,s=0){super();j(this,"context");j(this,"source");j(this,"gainNode");j(this,"panner");this.source=n,this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!0)}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,s]=n;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=s}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.source;this.source.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(n){}}class s4 extends Cm{constructor(n){super();j(this,"context");j(this,"_position",[0,0,0]);j(this,"loopCount",0);j(this,"prevVolume",1);j(this,"microphoneGainNode");j(this,"streamPlayback");j(this,"stream");j(this,"streamSource");this.context=n,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{this.stream=n,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new i4(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(n=>{console.error("Error initializing microphone stream:",n)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(n){}isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(n){this.streamPlayback&&this.streamPlayback.addFilter(n)}removeFilter(n){this.streamPlayback&&this.streamPlayback.removeFilter(n)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(n){this.streamPlayback&&(this.streamPlayback.volume=n)}get position(){return[0,0,0]}set position(n){}loop(n){return 0}get playbackRate(){return 1}set playbackRate(n){}}const o4="https://mongoose.world:9080/?url=";class a4 extends po{constructor(){super(...arguments);j(this,"packageName","Client.Media");j(this,"sounds",{});j(this,"defaultUrl","")}handleDefault(n){this.defaultUrl=n}async handleLoad(n){const r=(n.url||this.defaultUrl)+n.name,i=n.url+n.name;if(!this.sounds[i]){let o=await this.client.cacophony.createSound(r);o.key=i,this.sounds[i]=o}}async handlePlay(n){let r=(n.url||this.defaultUrl)+n.name;n.key=n.key||r;let i=this.sounds[n.key];if((!i||i.url!==r)&&(n.type==="music"?(r=o4+encodeURIComponent(r),i=await this.client.cacophony.createSound(r,T_.HTML)):i=await this.client.cacophony.createSound(r)),n.volume!==void 0&&(i.volume=n.volume/100),n.loops!==void 0&&i.loop&&i.loop(n.loops===-1?"infinite":n.loops),n.start&&i.seek(n.start),n.end&&setTimeout(()=>{i.stop()},n.end),n.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[n.position[0],n.position[1],n.position[2]]),n.priority){for(let s in this.sounds){const o=this.sounds[s];o.priority&&o.priority<n.priority&&o.stop()}i.priority=n.priority}if(!i.isPlaying()){const s=i.play()[0];n.fadein&&s.fadeIn(n.fadein),n.fadeout&&s.fadeOut(n.fadeout)}this.sounds[n.key]=i,i.key=n.key}handleStop(n){n.name&&this.soundsByName(n.name).forEach(r=>r.stop()),n.type&&this.soundsByType(n.type).forEach(r=>r.stop()),n.tag&&this.soundsByTag(n.tag).forEach(r=>r.stop()),n.key&&this.soundsByKey(n.key).forEach(r=>r.stop()),!n.name&&!n.type&&!n.tag&&!n.key&&this.allSounds.forEach(r=>r.stop())}handleListenerPosition(n){var r;(r=n.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=n.position)}handleListenerOrientation(n){n.up&&n.up.length&&(this.client.cacophony.listenerUpOrientation=n.up),n.forward&&n.forward.length&&(this.client.cacophony.listenerForwardOrientation=n.forward)}soundsByName(n){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(n))}soundsByKey(n){return Object.values(this.sounds).filter(r=>r.key===n)}soundsByTag(n){return Object.values(this.sounds).filter(r=>r.tag===n)}soundsByType(n){return Object.values(this.sounds).filter(r=>r.mediaType===n)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(n=>n.stop()),this.sounds={}}}class c4 extends po{constructor(){super(...arguments);j(this,"packageName","Client.Speech")}handleSpeak(n){const r=new SpeechSynthesisUtterance(n.text);r.rate=n.rate,r.pitch=n.pitch,r.volume=n.volume,speechSynthesis.speak(r)}}class l4 extends po{constructor(){super(...arguments);j(this,"packageName","Comm.Channel");j(this,"channels",[])}handleList(n){this.channels=n}sendList(){this.sendData("List")}handleText(n){n.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${n.talker}`,`${n.text}`))}}class u4 extends po{constructor(){super(...arguments);j(this,"packageName","Comm.LiveKit")}handleroom_token(n){this.client.worldData.liveKitTokens.push(n.token),this.client.emit("livekitToken",n.token)}handleroom_leave(n){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==n.token),this.client.emit("livekitLeave",n.token)}}class d4 extends po{constructor(){super(...arguments);j(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}}class f4 extends po{constructor(){super(...arguments);j(this,"packageName","Core.Supports")}sendSet(){const n=Object.values(this.client.gmcpHandlers).map(r=>r.packageName+" "+r.packageVersion.toString());this.sendData("Set",n)}}const Sc=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,__=new Set,Ry=typeof process=="object"&&process?process:{},R_=(t,e,n,r)=>{typeof Ry.emitWarning=="function"?Ry.emitWarning(t,e,n,r):console.error(`[${n}] ${e}: ${t}`)};let Cp=globalThis.AbortController,Iw=globalThis.AbortSignal;var Xk;if(typeof Cp>"u"){Iw=class{constructor(){j(this,"onabort");j(this,"_onabort",[]);j(this,"reason");j(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},Cp=class{constructor(){j(this,"signal",new Iw);e()}abort(r){var i,s;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const o of this.signal._onabort)o(r);(s=(i=this.signal).onabort)==null||s.call(i,r)}}};let t=((Xk=Ry.env)==null?void 0:Xk.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{t&&(t=!1,R_("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const h4=t=>!__.has(t),Ao=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),N_=t=>Ao(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?bh:null:null;class bh extends Array{constructor(e){super(e),this.fill(0)}}var gl;const Ta=class Ta{constructor(e,n){j(this,"heap");j(this,"length");if(!x(Ta,gl))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(e),this.length=0}static create(e){const n=N_(e);if(!n)return[];Ae(Ta,gl,!0);const r=new Ta(e,n);return Ae(Ta,gl,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};gl=new WeakMap,Me(Ta,gl,!1);let Ny=Ta;var ei,vr,ti,ni,vl,Jt,ri,Xt,Ct,Ne,Zn,yr,Dn,fn,ii,hn,si,oi,Cr,ai,Lo,jn,zd,My,Da,ks,Xd,Ir,Kp,P_,Oa,yl,$d,Oi,ko,Li,Eo,Kd,xy,Cl,wh,Il,Ah,ot,yt,Jd,Dy,La,Bu;const AS=class AS{constructor(e){Me(this,zd);Me(this,Kp);Me(this,Oi);Me(this,Li);Me(this,Kd);Me(this,Cl);Me(this,Il);Me(this,ot);Me(this,Jd);Me(this,La);Me(this,ei,void 0);Me(this,vr,void 0);Me(this,ti,void 0);Me(this,ni,void 0);Me(this,vl,void 0);j(this,"ttl");j(this,"ttlResolution");j(this,"ttlAutopurge");j(this,"updateAgeOnGet");j(this,"updateAgeOnHas");j(this,"allowStale");j(this,"noDisposeOnSet");j(this,"noUpdateTTL");j(this,"maxEntrySize");j(this,"sizeCalculation");j(this,"noDeleteOnFetchRejection");j(this,"noDeleteOnStaleGet");j(this,"allowStaleOnFetchAbort");j(this,"allowStaleOnFetchRejection");j(this,"ignoreFetchAbort");Me(this,Jt,void 0);Me(this,ri,void 0);Me(this,Xt,void 0);Me(this,Ct,void 0);Me(this,Ne,void 0);Me(this,Zn,void 0);Me(this,yr,void 0);Me(this,Dn,void 0);Me(this,fn,void 0);Me(this,ii,void 0);Me(this,hn,void 0);Me(this,si,void 0);Me(this,oi,void 0);Me(this,Cr,void 0);Me(this,ai,void 0);Me(this,Lo,void 0);Me(this,jn,void 0);Me(this,Da,()=>{});Me(this,ks,()=>{});Me(this,Xd,()=>{});Me(this,Ir,()=>!1);Me(this,Oa,e=>{});Me(this,yl,(e,n,r)=>{});Me(this,$d,(e,n,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:s,updateAgeOnGet:o,updateAgeOnHas:a,allowStale:c,dispose:l,disposeAfter:u,noDisposeOnSet:d,noUpdateTTL:f,maxSize:h=0,maxEntrySize:p=0,sizeCalculation:g,fetchMethod:y,noDeleteOnFetchRejection:m,noDeleteOnStaleGet:v,allowStaleOnFetchRejection:S,allowStaleOnFetchAbort:E,ignoreFetchAbort:A}=e;if(n!==0&&!Ao(n))throw new TypeError("max option must be a nonnegative integer");const b=n?N_(n):Array;if(!b)throw new Error("invalid max value: "+n);if(Ae(this,ei,n),Ae(this,vr,h),this.maxEntrySize=p||x(this,vr),this.sizeCalculation=g,this.sizeCalculation){if(!x(this,vr)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(y!==void 0&&typeof y!="function")throw new TypeError("fetchMethod must be a function if specified");if(Ae(this,vl,y),Ae(this,Lo,!!y),Ae(this,Xt,new Map),Ae(this,Ct,new Array(n).fill(void 0)),Ae(this,Ne,new Array(n).fill(void 0)),Ae(this,Zn,new b(n)),Ae(this,yr,new b(n)),Ae(this,Dn,0),Ae(this,fn,0),Ae(this,ii,Ny.create(n)),Ae(this,Jt,0),Ae(this,ri,0),typeof l=="function"&&Ae(this,ti,l),typeof u=="function"?(Ae(this,ni,u),Ae(this,hn,[])):(Ae(this,ni,void 0),Ae(this,hn,void 0)),Ae(this,ai,!!x(this,ti)),Ae(this,jn,!!x(this,ni)),this.noDisposeOnSet=!!d,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!m,this.allowStaleOnFetchRejection=!!S,this.allowStaleOnFetchAbort=!!E,this.ignoreFetchAbort=!!A,this.maxEntrySize!==0){if(x(this,vr)!==0&&!Ao(x(this,vr)))throw new TypeError("maxSize must be a positive integer if specified");if(!Ao(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");ye(this,Kp,P_).call(this)}if(this.allowStale=!!c,this.noDeleteOnStaleGet=!!v,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!a,this.ttlResolution=Ao(i)||i===0?i:1,this.ttlAutopurge=!!s,this.ttl=r||0,this.ttl){if(!Ao(this.ttl))throw new TypeError("ttl must be a positive integer if specified");ye(this,zd,My).call(this)}if(x(this,ei)===0&&this.ttl===0&&x(this,vr)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!x(this,ei)&&!x(this,vr)){const k="LRU_CACHE_UNBOUNDED";h4(k)&&(__.add(k),R_("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",k,AS))}}static unsafeExposeInternals(e){return{starts:x(e,oi),ttls:x(e,Cr),sizes:x(e,si),keyMap:x(e,Xt),keyList:x(e,Ct),valList:x(e,Ne),next:x(e,Zn),prev:x(e,yr),get head(){return x(e,Dn)},get tail(){return x(e,fn)},free:x(e,ii),isBackgroundFetch:n=>{var r;return ye(r=e,ot,yt).call(r,n)},backgroundFetch:(n,r,i,s)=>{var o;return ye(o=e,Il,Ah).call(o,n,r,i,s)},moveToTail:n=>{var r;return ye(r=e,La,Bu).call(r,n)},indexes:n=>{var r;return ye(r=e,Oi,ko).call(r,n)},rindexes:n=>{var r;return ye(r=e,Li,Eo).call(r,n)},isStale:n=>{var r;return x(r=e,Ir).call(r,n)}}}get max(){return x(this,ei)}get maxSize(){return x(this,vr)}get calculatedSize(){return x(this,ri)}get size(){return x(this,Jt)}get fetchMethod(){return x(this,vl)}get dispose(){return x(this,ti)}get disposeAfter(){return x(this,ni)}getRemainingTTL(e){return x(this,Xt).has(e)?1/0:0}*entries(){for(const e of ye(this,Oi,ko).call(this))x(this,Ne)[e]!==void 0&&x(this,Ct)[e]!==void 0&&!ye(this,ot,yt).call(this,x(this,Ne)[e])&&(yield[x(this,Ct)[e],x(this,Ne)[e]])}*rentries(){for(const e of ye(this,Li,Eo).call(this))x(this,Ne)[e]!==void 0&&x(this,Ct)[e]!==void 0&&!ye(this,ot,yt).call(this,x(this,Ne)[e])&&(yield[x(this,Ct)[e],x(this,Ne)[e]])}*keys(){for(const e of ye(this,Oi,ko).call(this)){const n=x(this,Ct)[e];n!==void 0&&!ye(this,ot,yt).call(this,x(this,Ne)[e])&&(yield n)}}*rkeys(){for(const e of ye(this,Li,Eo).call(this)){const n=x(this,Ct)[e];n!==void 0&&!ye(this,ot,yt).call(this,x(this,Ne)[e])&&(yield n)}}*values(){for(const e of ye(this,Oi,ko).call(this))x(this,Ne)[e]!==void 0&&!ye(this,ot,yt).call(this,x(this,Ne)[e])&&(yield x(this,Ne)[e])}*rvalues(){for(const e of ye(this,Li,Eo).call(this))x(this,Ne)[e]!==void 0&&!ye(this,ot,yt).call(this,x(this,Ne)[e])&&(yield x(this,Ne)[e])}[Symbol.iterator](){return this.entries()}find(e,n={}){for(const r of ye(this,Oi,ko).call(this)){const i=x(this,Ne)[r],s=ye(this,ot,yt).call(this,i)?i.__staleWhileFetching:i;if(s!==void 0&&e(s,x(this,Ct)[r],this))return this.get(x(this,Ct)[r],n)}}forEach(e,n=this){for(const r of ye(this,Oi,ko).call(this)){const i=x(this,Ne)[r],s=ye(this,ot,yt).call(this,i)?i.__staleWhileFetching:i;s!==void 0&&e.call(n,s,x(this,Ct)[r],this)}}rforEach(e,n=this){for(const r of ye(this,Li,Eo).call(this)){const i=x(this,Ne)[r],s=ye(this,ot,yt).call(this,i)?i.__staleWhileFetching:i;s!==void 0&&e.call(n,s,x(this,Ct)[r],this)}}purgeStale(){let e=!1;for(const n of ye(this,Li,Eo).call(this,{allowStale:!0}))x(this,Ir).call(this,n)&&(this.delete(x(this,Ct)[n]),e=!0);return e}info(e){const n=x(this,Xt).get(e);if(n===void 0)return;const r=x(this,Ne)[n],i=ye(this,ot,yt).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const s={value:i};if(x(this,Cr)&&x(this,oi)){const o=x(this,Cr)[n],a=x(this,oi)[n];if(o&&a){const c=o-(Sc.now()-a);s.ttl=c,s.start=Date.now()}}return x(this,si)&&(s.size=x(this,si)[n]),s}dump(){const e=[];for(const n of ye(this,Oi,ko).call(this,{allowStale:!0})){const r=x(this,Ct)[n],i=x(this,Ne)[n],s=ye(this,ot,yt).call(this,i)?i.__staleWhileFetching:i;if(s===void 0||r===void 0)continue;const o={value:s};if(x(this,Cr)&&x(this,oi)){o.ttl=x(this,Cr)[n];const a=Sc.now()-x(this,oi)[n];o.start=Math.floor(Date.now()-a)}x(this,si)&&(o.size=x(this,si)[n]),e.unshift([r,o])}return e}load(e){this.clear();for(const[n,r]of e){if(r.start){const i=Date.now()-r.start;r.start=Sc.now()-i}this.set(n,r.value,r)}}set(e,n,r={}){var f,h,p,g,y;if(n===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:s,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:c}=r;let{noUpdateTTL:l=this.noUpdateTTL}=r;const u=x(this,$d).call(this,e,n,r.size||0,a);if(this.maxEntrySize&&u>this.maxEntrySize)return c&&(c.set="miss",c.maxEntrySizeExceeded=!0),this.delete(e),this;let d=x(this,Jt)===0?void 0:x(this,Xt).get(e);if(d===void 0)d=x(this,Jt)===0?x(this,fn):x(this,ii).length!==0?x(this,ii).pop():x(this,Jt)===x(this,ei)?ye(this,Cl,wh).call(this,!1):x(this,Jt),x(this,Ct)[d]=e,x(this,Ne)[d]=n,x(this,Xt).set(e,d),x(this,Zn)[x(this,fn)]=d,x(this,yr)[d]=x(this,fn),Ae(this,fn,d),kf(this,Jt)._++,x(this,yl).call(this,d,u,c),c&&(c.set="add"),l=!1;else{ye(this,La,Bu).call(this,d);const m=x(this,Ne)[d];if(n!==m){if(x(this,Lo)&&ye(this,ot,yt).call(this,m)){m.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:v}=m;v!==void 0&&!o&&(x(this,ai)&&((f=x(this,ti))==null||f.call(this,v,e,"set")),x(this,jn)&&((h=x(this,hn))==null||h.push([v,e,"set"])))}else o||(x(this,ai)&&((p=x(this,ti))==null||p.call(this,m,e,"set")),x(this,jn)&&((g=x(this,hn))==null||g.push([m,e,"set"])));if(x(this,Oa).call(this,d),x(this,yl).call(this,d,u,c),x(this,Ne)[d]=n,c){c.set="replace";const v=m&&ye(this,ot,yt).call(this,m)?m.__staleWhileFetching:m;v!==void 0&&(c.oldValue=v)}}else c&&(c.set="update")}if(i!==0&&!x(this,Cr)&&ye(this,zd,My).call(this),x(this,Cr)&&(l||x(this,Xd).call(this,d,i,s),c&&x(this,ks).call(this,c,d)),!o&&x(this,jn)&&x(this,hn)){const m=x(this,hn);let v;for(;v=m==null?void 0:m.shift();)(y=x(this,ni))==null||y.call(this,...v)}return this}pop(){var e;try{for(;x(this,Jt);){const n=x(this,Ne)[x(this,Dn)];if(ye(this,Cl,wh).call(this,!0),ye(this,ot,yt).call(this,n)){if(n.__staleWhileFetching)return n.__staleWhileFetching}else if(n!==void 0)return n}}finally{if(x(this,jn)&&x(this,hn)){const n=x(this,hn);let r;for(;r=n==null?void 0:n.shift();)(e=x(this,ni))==null||e.call(this,...r)}}}has(e,n={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=n,s=x(this,Xt).get(e);if(s!==void 0){const o=x(this,Ne)[s];if(ye(this,ot,yt).call(this,o)&&o.__staleWhileFetching===void 0)return!1;if(x(this,Ir).call(this,s))i&&(i.has="stale",x(this,ks).call(this,i,s));else return r&&x(this,Da).call(this,s),i&&(i.has="hit",x(this,ks).call(this,i,s)),!0}else i&&(i.has="miss");return!1}peek(e,n={}){const{allowStale:r=this.allowStale}=n,i=x(this,Xt).get(e);if(i===void 0||!r&&x(this,Ir).call(this,i))return;const s=x(this,Ne)[i];return ye(this,ot,yt).call(this,s)?s.__staleWhileFetching:s}async fetch(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:g,forceRefresh:y=!1,status:m,signal:v}=n;if(!x(this,Lo))return m&&(m.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:s,status:m});const S={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:s,ttl:o,noDisposeOnSet:a,size:c,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:p,ignoreFetchAbort:h,status:m,signal:v};let E=x(this,Xt).get(e);if(E===void 0){m&&(m.fetch="miss");const A=ye(this,Il,Ah).call(this,e,E,S,g);return A.__returned=A}else{const A=x(this,Ne)[E];if(ye(this,ot,yt).call(this,A)){const M=r&&A.__staleWhileFetching!==void 0;return m&&(m.fetch="inflight",M&&(m.returnedStale=!0)),M?A.__staleWhileFetching:A.__returned=A}const b=x(this,Ir).call(this,E);if(!y&&!b)return m&&(m.fetch="hit"),ye(this,La,Bu).call(this,E),i&&x(this,Da).call(this,E),m&&x(this,ks).call(this,m,E),A;const k=ye(this,Il,Ah).call(this,e,E,S,g),N=k.__staleWhileFetching!==void 0&&r;return m&&(m.fetch=b?"stale":"refresh",N&&b&&(m.returnedStale=!0)),N?k.__staleWhileFetching:k.__returned=k}}get(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:o}=n,a=x(this,Xt).get(e);if(a!==void 0){const c=x(this,Ne)[a],l=ye(this,ot,yt).call(this,c);return o&&x(this,ks).call(this,o,a),x(this,Ir).call(this,a)?(o&&(o.get="stale"),l?(o&&r&&c.__staleWhileFetching!==void 0&&(o.returnedStale=!0),r?c.__staleWhileFetching:void 0):(s||this.delete(e),o&&r&&(o.returnedStale=!0),r?c:void 0)):(o&&(o.get="hit"),l?c.__staleWhileFetching:(ye(this,La,Bu).call(this,a),i&&x(this,Da).call(this,a),c))}else o&&(o.get="miss")}delete(e){var r,i,s,o;let n=!1;if(x(this,Jt)!==0){const a=x(this,Xt).get(e);if(a!==void 0)if(n=!0,x(this,Jt)===1)this.clear();else{x(this,Oa).call(this,a);const c=x(this,Ne)[a];if(ye(this,ot,yt).call(this,c)?c.__abortController.abort(new Error("deleted")):(x(this,ai)||x(this,jn))&&(x(this,ai)&&((r=x(this,ti))==null||r.call(this,c,e,"delete")),x(this,jn)&&((i=x(this,hn))==null||i.push([c,e,"delete"]))),x(this,Xt).delete(e),x(this,Ct)[a]=void 0,x(this,Ne)[a]=void 0,a===x(this,fn))Ae(this,fn,x(this,yr)[a]);else if(a===x(this,Dn))Ae(this,Dn,x(this,Zn)[a]);else{const l=x(this,yr)[a];x(this,Zn)[l]=x(this,Zn)[a];const u=x(this,Zn)[a];x(this,yr)[u]=x(this,yr)[a]}kf(this,Jt)._--,x(this,ii).push(a)}}if(x(this,jn)&&((s=x(this,hn))!=null&&s.length)){const a=x(this,hn);let c;for(;c=a==null?void 0:a.shift();)(o=x(this,ni))==null||o.call(this,...c)}return n}clear(){var e,n,r;for(const i of ye(this,Li,Eo).call(this,{allowStale:!0})){const s=x(this,Ne)[i];if(ye(this,ot,yt).call(this,s))s.__abortController.abort(new Error("deleted"));else{const o=x(this,Ct)[i];x(this,ai)&&((e=x(this,ti))==null||e.call(this,s,o,"delete")),x(this,jn)&&((n=x(this,hn))==null||n.push([s,o,"delete"]))}}if(x(this,Xt).clear(),x(this,Ne).fill(void 0),x(this,Ct).fill(void 0),x(this,Cr)&&x(this,oi)&&(x(this,Cr).fill(0),x(this,oi).fill(0)),x(this,si)&&x(this,si).fill(0),Ae(this,Dn,0),Ae(this,fn,0),x(this,ii).length=0,Ae(this,ri,0),Ae(this,Jt,0),x(this,jn)&&x(this,hn)){const i=x(this,hn);let s;for(;s=i==null?void 0:i.shift();)(r=x(this,ni))==null||r.call(this,...s)}}};ei=new WeakMap,vr=new WeakMap,ti=new WeakMap,ni=new WeakMap,vl=new WeakMap,Jt=new WeakMap,ri=new WeakMap,Xt=new WeakMap,Ct=new WeakMap,Ne=new WeakMap,Zn=new WeakMap,yr=new WeakMap,Dn=new WeakMap,fn=new WeakMap,ii=new WeakMap,hn=new WeakMap,si=new WeakMap,oi=new WeakMap,Cr=new WeakMap,ai=new WeakMap,Lo=new WeakMap,jn=new WeakMap,zd=new WeakSet,My=function(){const e=new bh(x(this,ei)),n=new bh(x(this,ei));Ae(this,Cr,e),Ae(this,oi,n),Ae(this,Xd,(s,o,a=Sc.now())=>{if(n[s]=o!==0?a:0,e[s]=o,o!==0&&this.ttlAutopurge){const c=setTimeout(()=>{x(this,Ir).call(this,s)&&this.delete(x(this,Ct)[s])},o+1);c.unref&&c.unref()}}),Ae(this,Da,s=>{n[s]=e[s]!==0?Sc.now():0}),Ae(this,ks,(s,o)=>{if(e[o]){const a=e[o],c=n[o];if(!a||!c)return;s.ttl=a,s.start=c,s.now=r||i();const l=s.now-c;s.remainingTTL=a-l}});let r=0;const i=()=>{const s=Sc.now();if(this.ttlResolution>0){r=s;const o=setTimeout(()=>r=0,this.ttlResolution);o.unref&&o.unref()}return s};this.getRemainingTTL=s=>{const o=x(this,Xt).get(s);if(o===void 0)return 0;const a=e[o],c=n[o];if(!a||!c)return 1/0;const l=(r||i())-c;return a-l},Ae(this,Ir,s=>{const o=n[s],a=e[s];return!!a&&!!o&&(r||i())-o>a})},Da=new WeakMap,ks=new WeakMap,Xd=new WeakMap,Ir=new WeakMap,Kp=new WeakSet,P_=function(){const e=new bh(x(this,ei));Ae(this,ri,0),Ae(this,si,e),Ae(this,Oa,n=>{Ae(this,ri,x(this,ri)-e[n]),e[n]=0}),Ae(this,$d,(n,r,i,s)=>{if(ye(this,ot,yt).call(this,r))return 0;if(!Ao(i))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(i=s(r,n),!Ao(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Ae(this,yl,(n,r,i)=>{if(e[n]=r,x(this,vr)){const s=x(this,vr)-e[n];for(;x(this,ri)>s;)ye(this,Cl,wh).call(this,!0)}Ae(this,ri,x(this,ri)+e[n]),i&&(i.entrySize=r,i.totalCalculatedSize=x(this,ri))})},Oa=new WeakMap,yl=new WeakMap,$d=new WeakMap,Oi=new WeakSet,ko=function*({allowStale:e=this.allowStale}={}){if(x(this,Jt))for(let n=x(this,fn);!(!ye(this,Kd,xy).call(this,n)||((e||!x(this,Ir).call(this,n))&&(yield n),n===x(this,Dn)));)n=x(this,yr)[n]},Li=new WeakSet,Eo=function*({allowStale:e=this.allowStale}={}){if(x(this,Jt))for(let n=x(this,Dn);!(!ye(this,Kd,xy).call(this,n)||((e||!x(this,Ir).call(this,n))&&(yield n),n===x(this,fn)));)n=x(this,Zn)[n]},Kd=new WeakSet,xy=function(e){return e!==void 0&&x(this,Xt).get(x(this,Ct)[e])===e},Cl=new WeakSet,wh=function(e){var s,o;const n=x(this,Dn),r=x(this,Ct)[n],i=x(this,Ne)[n];return x(this,Lo)&&ye(this,ot,yt).call(this,i)?i.__abortController.abort(new Error("evicted")):(x(this,ai)||x(this,jn))&&(x(this,ai)&&((s=x(this,ti))==null||s.call(this,i,r,"evict")),x(this,jn)&&((o=x(this,hn))==null||o.push([i,r,"evict"]))),x(this,Oa).call(this,n),e&&(x(this,Ct)[n]=void 0,x(this,Ne)[n]=void 0,x(this,ii).push(n)),x(this,Jt)===1?(Ae(this,Dn,Ae(this,fn,0)),x(this,ii).length=0):Ae(this,Dn,x(this,Zn)[n]),x(this,Xt).delete(r),kf(this,Jt)._--,n},Il=new WeakSet,Ah=function(e,n,r,i){const s=n===void 0?void 0:x(this,Ne)[n];if(ye(this,ot,yt).call(this,s))return s;const o=new Cp,{signal:a}=r;a==null||a.addEventListener("abort",()=>o.abort(a.reason),{signal:o.signal});const c={signal:o.signal,options:r,context:i},l=(g,y=!1)=>{const{aborted:m}=o.signal,v=r.ignoreFetchAbort&&g!==void 0;if(r.status&&(m&&!y?(r.status.fetchAborted=!0,r.status.fetchError=o.signal.reason,v&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),m&&!v&&!y)return d(o.signal.reason);const S=h;return x(this,Ne)[n]===h&&(g===void 0?S.__staleWhileFetching?x(this,Ne)[n]=S.__staleWhileFetching:this.delete(e):(r.status&&(r.status.fetchUpdated=!0),this.set(e,g,c.options))),g},u=g=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=g),d(g)),d=g=>{const{aborted:y}=o.signal,m=y&&r.allowStaleOnFetchAbort,v=m||r.allowStaleOnFetchRejection,S=v||r.noDeleteOnFetchRejection,E=h;if(x(this,Ne)[n]===h&&(!S||E.__staleWhileFetching===void 0?this.delete(e):m||(x(this,Ne)[n]=E.__staleWhileFetching)),v)return r.status&&E.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),E.__staleWhileFetching;if(E.__returned===E)throw g},f=(g,y)=>{var v;const m=(v=x(this,vl))==null?void 0:v.call(this,e,s,c);m&&m instanceof Promise&&m.then(S=>g(S===void 0?void 0:S),y),o.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(g(void 0),r.allowStaleOnFetchAbort&&(g=S=>l(S,!0)))})};r.status&&(r.status.fetchDispatched=!0);const h=new Promise(f).then(l,u),p=Object.assign(h,{__abortController:o,__staleWhileFetching:s,__returned:void 0});return n===void 0?(this.set(e,p,{...c.options,status:void 0}),n=x(this,Xt).get(e)):x(this,Ne)[n]=p,p},ot=new WeakSet,yt=function(e){if(!x(this,Lo))return!1;const n=e;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof Cp},Jd=new WeakSet,Dy=function(e,n){x(this,yr)[n]=e,x(this,Zn)[e]=n},La=new WeakSet,Bu=function(e){e!==x(this,fn)&&(e===x(this,Dn)?Ae(this,Dn,x(this,Zn)[e]):ye(this,Jd,Dy).call(this,x(this,yr)[e],x(this,Zn)[e]),ye(this,Jd,Dy).call(this,x(this,fn),e),Ae(this,fn,e))};let Py=AS;function p4(t){const e=t.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+t+"`"),null;const n=e[1],r=e[2],i={},s=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let o;for(;o=s.exec(e[3]);){const a=o[1]||o[3],c=o[2]||o[4];a in i?console.log(`Invalid message format: duplicate key ${a} detected`):i[a]=c}return{name:n,authKey:r,keyvals:i}}function Sw(t){const e=t.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+t+"`"),null;const n=e[1]||e[4],r=void 0,i=e[2],s=e[3],o={};return o[i]=s,{name:n,authKey:r,keyvals:o}}function Oy(){return(Math.random()+1).toString(36).substring(3,9)}class ql{constructor(e){j(this,"packageName");j(this,"minVersion",1);j(this,"maxVersion",1);j(this,"packageVersion",0);j(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,n){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,n)}}class m4 extends ql{constructor(){super(...arguments);j(this,"packageName","mcp-negotiate");j(this,"minVersion",2);j(this,"maxVersion",2)}handle(n){switch(n.name){}}sendNegotiate(){var n,r;for(const i of Object.values(this.client.mcpHandlers)){let s=(n=i.minVersion)==null?void 0:n.toFixed(1),o=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":s,"max-version":o})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class g4 extends ql{constructor(){super(...arguments);j(this,"packageName","dns-com-awns-status")}handle(n){console.log(n),this.client.emit("statustext",n.keyvals.text)}}class v4 extends ql{constructor(n){super(n);j(this,"packageName","dns-org-mud-moo-simpleedit");j(this,"sessions",{});j(this,"clientId");this.clientId=Oy()}handle(n){if(n.name==="dns-org-mud-moo-simpleedit-content"){const r={name:n.keyvals.name,reference:n.keyvals.reference,type:n.keyvals.type,contents:[]};this.sessions[n.keyvals["_data-tag"]]=r}else console.log(`Unexpected simpleedit message ${n}`)}handleMultiline(n){"content"in n.keyvals?this.sessions[n.name].contents.push(n.keyvals.content):console.log(`Unexpected simpleedit ML ${n}`)}closeMultiline(n){console.log(`Closing multiline ${n.name}`),this.client.openEditorWindow(this.sessions[n.name])}shutdown(){new BroadcastChannel("editor").postMessage({type:"shutdown"})}}class y4 extends ql{constructor(){super(...arguments);j(this,"packageName","dns-com-awns-getset");j(this,"id",1);j(this,"cache",new Py({max:10}));j(this,"LocalCache",{})}handle(n){switch(n.name){case"dns-com-awns-getset-ack":const r=this.cache.get(n.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${n.keyvals.id}`);break}const i=n.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(n){const r=(this.id++).toString();this.cache.set(r,n),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:n})}sendSet(n,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:n,value:r})}sendDrop(n){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:n})}}class C4 extends ql{constructor(){super(...arguments);j(this,"packageName","dns-com-vmoo-userlist");j(this,"maxVersion",1.1);j(this,"player");j(this,"fields",["Object","Name","Icon"]);j(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);j(this,"players",[])}handle(n){switch(n.name){case"dns-com-vmoo-userlist-you":this.player=n.keyvals.nr;break}}handleMultiline(n){if("fields"in n.keyvals&&(this.fields=Jr(n.keyvals.fields.trim())),"icons"in n.keyvals&&(this.icons=Jr(n.keyvals.icons.trim())),"d"in n.keyvals){const s=n.keyvals.d[0];switch(s){case"=":var r=Jr(n.keyvals.d.slice(1));this.players=r.map(a=>this.playerFromArray(a));break;case"+":this.players.push(this.playerFromArray(Jr(n.keyvals.d.slice(1))));break;case"-":var i=Jr(n.keyvals.d.slice(1));this.players=this.players.filter(a=>!i.includes(a.Object));break;case"*":const o=this.playerFromArray(Jr(n.keyvals.d.slice(1)));this.updatePlayer(o);break;case"<":i=Jr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!0,this.players[c]=a)});break;case">":i=Jr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!1,this.players[c]=a)});break;case"[":i=Jr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!0,this.players[c]=a)});break;case"]":i=Jr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!1,this.players[c]=a)});break;default:console.log(`Unknown userlist mode ${s} in ${n.keyvals.d}`);break}this.update()}}updatePlayer(n){const r=this.players.findIndex(i=>i.Object===n.Object);r!==-1?this.players[r]=n:this.players.push(n)}update(){this.players.sort((r,i)=>n(i)-n(r)),this.client.emit("userlist",this.players);function n(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(n){const r={};return n.forEach((i,s)=>{r[this.fields[s]]=i}),r.away=!1,r.idle=!1,r}}function Jr(t){t=t.slice(1,-1);let e=[],n="",r=0;for(let s=0;s<t.length;s++){const o=t[s];if(o==="{")r++;else if(o==="}")r--;else if(o===","&&r===0){i(),n="";continue}n+=o}return n.length>0&&i(),e;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?e.push(Jr(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?e.push(n.slice(1,-1)):e.push(n):e.push(Number(n))}}class I4 extends ql{constructor(){super(...arguments);j(this,"packageName","dns-com-awns-ping");j(this,"id",1)}handle(n){switch(n.name){case"dns-com-awns-ping":this.send("reply",n.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}function S4({onlyFirst:t=!1}={}){const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,t?void 0:"g")}const b4=S4();function w4(t){if(typeof t!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof t}\``);return t.replace(b4,"")}var Ly=(t=>(t.Off="off",t.Unfocused="unfocused",t.All="all",t))(Ly||{}),ao=(t=>(t.SetGeneral="SET_GENERAL",t.SetSpeech="SET_SPEECH",t.SetChannels="SET_CHANNELS",t.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",t.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",t))(ao||{});class A4{constructor(){j(this,"state");j(this,"listeners",new Set);j(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(n=>n())});const e=localStorage.getItem("preferences"),n=this.getInitialPreferences();this.state=e?this.mergePreferences(n,JSON.parse(e)):n}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(e,n){return{...e,general:{...e.general,...n.general},speech:{...e.speech,...n.speech},channels:n.channels?{...e.channels,...n.channels}:e.channels,editor:{...e.editor,...n.editor}}}reducer(e,n){switch(n.type){case"SET_GENERAL":return{...e,general:n.data};case"SET_SPEECH":return{...e,speech:n.data};case"SET_CHANNELS":return{...e,channels:n.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:n.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:n.data}};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const nl=new A4;class k4 extends kT{constructor(n,r){super();j(this,"ws");j(this,"decoder",new TextDecoder("utf8"));j(this,"telnet");j(this,"host");j(this,"port");j(this,"telnetNegotiation",!1);j(this,"telnetBuffer","");j(this,"gmcpHandlers",{});j(this,"mcpHandlers",{});j(this,"mcpMultilines",{});j(this,"mcpAuthKey",null);j(this,"mcp_negotiate");j(this,"mcp_getset");j(this,"gmcp_char");j(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[]});j(this,"cacophony");this.host=n,this.port=r,this.mcp_negotiate=this.registerMcpPackage(m4),this.mcp_getset=this.registerMcpPackage(y4),this.gmcp_char=this.registerGMCPPackage(n2),this.cacophony=new n4}registerGMCPPackage(n){const r=new n(this);return this.gmcpHandlers[r.packageName]=r,r}registerMcpPackage(n){const r=new n(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new e2(new QB(this.ws)),this.ws.onopen=()=>{this.emit("connect")},this.telnet.on("data",n=>{this.handleData(n)}),this.telnet.on("negotiation",(n,r)=>{n===Lu.WILL&&r===Ou.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(Lu.DO,Ou.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):n===Lu.DO&&r===Ou.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(Lu.WILL,Ou.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose React Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(n,r)=>{console.log("GMCP Package:",n,r),this.handleGmcpData(n,r)}),this.ws.onclose=()=>{this.emit("disconnect"),this.mcpAuthKey=null,setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=n=>{this.emit("error",n)}}send(n){this.ws.send(n)}close(){this.ws.close()}sendCommand(n){nl.getState().general.localEcho&&this.emit("command",n),this.send(n+`\r
`),console.log("> "+n)}handleData(n){const r=this.decoder.decode(n).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(n){if(n.startsWith("#$#*")){const i=Sw(n.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(n.startsWith("#$#:")){const i=Sw(n.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=p4(n.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=Oy(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(n,r){const i=n.lastIndexOf("."),s=n.substring(0,i),o=n.substring(i+1);console.log("GMCP Message:",s,o,r);const a=this.gmcpHandlers[s];if(!a){console.log("No handler for GMCP package:",s);return}const c=a["handle"+o];c?(console.log("Calling handler:",c),c.call(a,JSON.parse(r))):console.log("No handler for GMCP package:",s)}emitMessage(n){const r=nl.getState().speech.autoreadMode;r===Ly.All&&this.speak(n),r===Ly.Unfocused&&!document.hasFocus()&&this.speak(n),this.emit("message",n)}sendGmcp(n,r){console.log("Sending GMCP:",n,r),this.telnet.sendGmcp(n,r)}sendMcp(n,r){if(typeof r=="object"){let s="";for(const[o,a]of Object.entries(r))s+=` ${o}: ${a||'""'}`;r=s}const i=`#$#${n} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(n,r,i){this.send(`#$#* ${n} ${r}: ${i}\r
`)}closeMcpML(n){this.send(`#$#: ${n}\r
`)}openEditorWindow(n){console.log(n);const r=new BroadcastChannel("editor"),i=n.reference,s=encodeURIComponent(i),o=window.open(`/editor?reference=${s}`,"_blank");r.onmessage=a=>{console.log("editor window message",a),a.data.id===i&&(a.data.type==="ready"?(console.log("sending editor window session",n),r.postMessage({type:"load",session:n})):a.data.type==="save"?(console.log("saving editor window with session",a.data.session),this.saveEditorWindow(a.data.session)):a.data.type==="close"&&(console.log("closing editor window"),r.close(),r.onmessage=null))},o&&o.focus()}saveEditorWindow(n){const r={reference:n.reference,type:n.type};r["content*"]="",this.sendMCPMultiline(r,n.contents)}sendMCPMultiline(n,r){const i=Oy();n["_data-tag"]=i,this.sendMcp("dns-org-mud-moo-simpleedit-set",n);for(const s of r)this.sendMcpMLLine(i,"content",s);this.closeMcpML(i)}shutdown(){Object.values(this.mcpHandlers).forEach(n=>{n.shutdown()}),Object.values(this.gmcpHandlers).forEach(n=>{n.shutdown()})}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(n,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(n,{body:r})}speak(n){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(w4(n));r.lang="en-US";const{rate:i,pitch:s,voice:o,volume:a}=nl.getState().speech;r.rate=i,r.pitch=s,r.volume=a;const l=speechSynthesis.getVoices().find(u=>u.name===o);l&&(r.voice=l),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}getInput(){var n;return((n=document.getElementById("command-input"))==null?void 0:n.textContent)||""}setInput(n){const r=document.getElementById("command-input");r&&(r.textContent=n)}}class E4{constructor(){j(this,"history",[]);j(this,"currentIndex",null);j(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&(this.history.push(e.trim()),this.currentIndex=null,this.unsentInput="")}navigateUp(e){return this.currentIndex===null&&(this.unsentInput=e),this.history.length>0&&(this.currentIndex==null||this.currentIndex>0)?(this.currentIndex=this.currentIndex==null?this.history.length-1:this.currentIndex-1,this.history[this.currentIndex]):e}navigateDown(e){return this.currentIndex!==null?this.currentIndex<this.history.length-1?(this.currentIndex++,this.history[this.currentIndex]):(this.currentIndex=null,""):this.unsentInput}getCurrentInput(){return this.currentIndex===null?this.unsentInput:this.history[this.currentIndex]}}const T4=({onSend:t})=>{const[e,n]=w.useState(""),r=w.useRef(new E4),i=s=>{const o=r.current;if(s.key==="Enter"&&!s.shiftKey)s.preventDefault(),t(e),o.addCommand(e),n("");else if(s.key==="ArrowUp"){s.preventDefault();const a=o.navigateUp(e);n(a)}else if(s.key==="ArrowDown"){s.preventDefault();const a=o.navigateDown(e);n(a)}};return q.jsx("textarea",{value:e,onChange:s=>n(s.target.value),onKeyDown:i,autoFocus:!0,id:"command-input"})},Ca=()=>{const[,t]=w.useReducer(e=>e+1,0);return w.useEffect(()=>nl.subscribe(t),[]),[nl.getState(),nl.dispatch]},_4=()=>{const[t,e]=w.useState([]);return w.useEffect(()=>{const n=()=>{e(window.speechSynthesis.getVoices())};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)},[]),t},R4=({tabs:t})=>{const[e,n]=w.useState(0),r=w.useRef([]);return w.useEffect(()=>{r.current=r.current.slice(0,t.length)},[t]),w.useEffect(()=>{const i=o=>{switch(o.key){case"ArrowLeft":n(a=>a>0?a-1:t.length-1);break;case"ArrowRight":n(a=>a<t.length-1?a+1:0);break}},s=r.current[e];return s==null||s.addEventListener("keydown",i),()=>{s==null||s.removeEventListener("keydown",i)}},[t.length,e]),w.useEffect(()=>{var i;(i=r.current[e])==null||i.focus()},[e]),q.jsxs("div",{children:[q.jsx("div",{role:"tablist","aria-label":"Tabs",children:t.map((i,s)=>q.jsx("button",{ref:o=>r.current[s]=o,role:"tab","aria-selected":e===s,id:`${i.label}-tab`,"aria-controls":`${i.label}-panel`,onClick:()=>n(s),tabIndex:e===s?void 0:-1,children:i.label},s))}),t.map((i,s)=>q.jsx("div",{role:"tabpanel",id:`${i.label}-panel`,"aria-labelledby":`${i.label}-tab`,hidden:e!==s,tabIndex:e===s?0:-1,children:i.content},s))]})},N4=()=>{const[t,e]=Ca();return q.jsxs("label",{children:[q.jsx("input",{type:"checkbox",checked:t.general.localEcho,onChange:n=>e({type:ao.SetGeneral,data:{...t.general,localEcho:n.target.checked}})}),"Local Echo"]})},P4=()=>{const[t,e]=Ca();return q.jsxs("label",{children:["Auto Read:",q.jsxs("select",{value:t.speech.autoreadMode,onChange:n=>e({type:ao.SetSpeech,data:{...t.speech,autoreadMode:n.target.value}}),children:[q.jsx("option",{value:"off",children:"Off"}),q.jsx("option",{value:"unfocused",children:"Unfocused"}),q.jsx("option",{value:"all",children:"Always"})]})]})},M4=()=>{const[t,e]=Ca(),n=_4();return q.jsxs("label",{children:["Voice:",q.jsx("select",{value:t.speech.voice,onChange:r=>e({type:ao.SetSpeech,data:{...t.speech,voice:r.target.value}}),children:n.map(r=>q.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},x4=()=>{const[t,e]=Ca();return q.jsxs("label",{children:["Rate (0.1 - 10.0):",q.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:t.speech.rate,onChange:n=>e({type:ao.SetSpeech,data:{...t.speech,rate:parseFloat(n.target.value)}})})]})},D4=()=>{const[t,e]=Ca();return q.jsxs("label",{children:["Pitch (0 - 2):",q.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:t.speech.pitch,onChange:n=>e({type:ao.SetSpeech,data:{...t.speech,pitch:parseFloat(n.target.value)}})})]})},O4=()=>{const[t,e]=Ca();return q.jsxs("label",{children:["Volume (0 - 1):",q.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:t.speech.volume,onChange:n=>e({type:ao.SetSpeech,data:{...t.speech,volume:parseFloat(n.target.value)}})})]})},L4=()=>q.jsxs("div",{children:[q.jsx(P4,{}),q.jsx("br",{}),q.jsx(M4,{}),q.jsx("br",{}),q.jsx(x4,{}),q.jsx("br",{}),q.jsx(D4,{}),q.jsx("br",{}),q.jsx(O4,{}),q.jsx("br",{})]}),B4=()=>{const[t,e]=Ca(),n=t.editor,r=s=>{e({type:ao.SetEditorAutocompleteEnabled,data:s.target.checked})},i=s=>{e({type:ao.SetEditorAccessibilityMode,data:s.target.checked})};return q.jsxs("div",{children:[q.jsxs("label",{children:[q.jsx("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),q.jsx("br",{}),q.jsxs("label",{children:[q.jsx("input",{type:"checkbox",checked:n.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),q.jsx("br",{})]})},F4=()=>{const t=[{label:"General",content:q.jsx(N4,{})},{label:"Speech",content:q.jsx(L4,{})},{label:"Editor",content:q.jsx(B4,{})}];return q.jsx(R4,{tabs:t})};function U4(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function _d(){return _d=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_d.apply(this,arguments)}var By="data-focus-lock",M_="data-focus-lock-disabled",G4="data-no-focus-lock",V4="data-autofocus-inside",W4="data-no-autofocus";function H4(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Z4(t,e){var n=w.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}function j4(t,e){return Z4(e||null,function(n){return t.forEach(function(r){return H4(r,n)})})}var Hg={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},Fy=function(t,e){return Fy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Fy(t,e)};function Ql(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Fy(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Uy=function(){return Uy=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Uy.apply(this,arguments)};function z4(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function x_(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(n=0)),n;)try{if(r=1,i&&(s=l[0]&2?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){n.label=l[1];break}if(l[0]===6&&n.label<s[1]){n.label=s[1],s=l;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(l);break}s[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],i=0}finally{r=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Nl(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ip(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function Sp(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}function rl(t){return this instanceof rl?(this.v=t,this):new rl(t)}function X4(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(f){r[f]&&(i[f]=function(h){return new Promise(function(p,g){s.push([f,h,p,g])>1||a(f,h)})})}function a(f,h){try{c(r[f](h))}catch(p){d(s[0][3],p)}}function c(f){f.value instanceof rl?Promise.resolve(f.value.v).then(l,u):d(s[0][2],f)}function l(f){a("next",f)}function u(f){a("throw",f)}function d(f,h){f(h),s.shift(),s.length&&a(s[0][0],s[0][1])}}function $4(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Nl=="function"?Nl(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}function D_(t){return t}function O_(t,e){e===void 0&&(e=D_);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(r=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var c=function(){var u=o;o=[],u.forEach(s)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){o.push(u),l()},filter:function(u){return o=o.filter(u),n}}}};return i}function oI(t,e){return e===void 0&&(e=D_),O_(t,e)}function K4(t){t===void 0&&(t={});var e=O_(null);return e.options=Uy({async:!0,ssr:!1},t),e}var L_=oI({},function(t){var e=t.target,n=t.currentTarget;return{target:e,currentTarget:n}}),B_=oI(),J4=oI(),Y4=K4({async:!0}),q4=[],aI=w.forwardRef(function(e,n){var r,i=w.useState(),s=i[0],o=i[1],a=w.useRef(),c=w.useRef(!1),l=w.useRef(null),u=e.children,d=e.disabled,f=e.noFocusGuards,h=e.persistentFocus,p=e.crossFrame,g=e.autoFocus;e.allowTextSelection;var y=e.group,m=e.className,v=e.whiteList,S=e.hasPositiveIndices,E=e.shards,A=E===void 0?q4:E,b=e.as,k=b===void 0?"div":b,_=e.lockProps,N=_===void 0?{}:_,M=e.sideCar,D=e.returnFocus,B=e.focusOptions,G=e.onActivation,V=e.onDeactivation,z=w.useState({}),X=z[0],te=w.useCallback(function(){l.current=l.current||document&&document.activeElement,a.current&&G&&G(a.current),c.current=!0},[G]),H=w.useCallback(function(){c.current=!1,V&&V(a.current)},[V]);w.useEffect(function(){d||(l.current=null)},[]);var K=w.useCallback(function(Ue){var ce=l.current;if(ce&&ce.focus){var xt=typeof D=="function"?D(ce):D;if(xt){var cn=typeof xt=="object"?xt:void 0;l.current=null,Ue?Promise.resolve().then(function(){return ce.focus(cn)}):ce.focus(cn)}}},[D]),ie=w.useCallback(function(Ue){c.current&&L_.useMedium(Ue)},[]),$=B_.useMedium,se=w.useCallback(function(Ue){a.current!==Ue&&(a.current=Ue,o(Ue))},[]),be=_d((r={},r[M_]=d&&"disabled",r[By]=y,r),N),we=f!==!0,me=we&&f!=="tail",ke=j4([n,se]);return w.createElement(w.Fragment,null,we&&[w.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:d?-1:0,style:Hg}),S?w.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:d?-1:1,style:Hg}):null],!d&&w.createElement(M,{id:X,sideCar:Y4,observed:s,disabled:d,persistentFocus:h,crossFrame:p,autoFocus:g,whiteList:v,shards:A,onActivation:te,onDeactivation:H,returnFocus:K,focusOptions:B}),w.createElement(k,_d({ref:ke},be,{className:m,onBlur:$,onFocus:ie}),u),me&&w.createElement("div",{"data-focus-guard":!0,tabIndex:d?-1:0,style:Hg}))});aI.propTypes={};aI.defaultProps={children:void 0,disabled:!1,returnFocus:!1,focusOptions:void 0,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,hasPositiveIndices:void 0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};const F_=aI;function Gy(t,e){return Gy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Gy(t,e)}function Q4(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Gy(t,e)}function Rd(t){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rd(t)}function eG(t,e){if(Rd(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Rd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tG(t){var e=eG(t,"string");return Rd(e)=="symbol"?e:String(e)}function nG(t,e,n){return e=tG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rG(t,e){function n(r){return r.displayName||r.name||"Component"}return function(i){var s=[],o;function a(){o=t(s.map(function(l){return l.props})),e(o)}var c=function(l){Q4(u,l);function u(){return l.apply(this,arguments)||this}u.peek=function(){return o};var d=u.prototype;return d.componentDidMount=function(){s.push(this),a()},d.componentDidUpdate=function(){a()},d.componentWillUnmount=function(){var h=s.indexOf(this);s.splice(h,1),a()},d.render=function(){return St.createElement(i,this.props)},u}(w.PureComponent);return nG(c,"displayName","SideEffect("+n(i)+")"),c}}var gs=function(t){for(var e=Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e},bp=function(t){return Array.isArray(t)?t:[t]},U_=function(t){return Array.isArray(t)?t[0]:t},iG=function(t){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(t,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},G_=function(t){return t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.host:t.parentNode},V_=function(t){return t===document||t&&t.nodeType===Node.DOCUMENT_NODE},sG=function(t,e){return!t||V_(t)||!iG(t)&&e(G_(t))},W_=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=sG(e,W_.bind(void 0,t));return t.set(e,r),r},oG=function(t,e){return t&&!V_(t)?lG(t)?e(G_(t)):!1:!0},H_=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=oG(e,H_.bind(void 0,t));return t.set(e,r),r},Z_=function(t){return t.dataset},aG=function(t){return t.tagName==="BUTTON"},j_=function(t){return t.tagName==="INPUT"},z_=function(t){return j_(t)&&t.type==="radio"},cG=function(t){return!((j_(t)||aG(t))&&(t.type==="hidden"||t.disabled))},lG=function(t){var e=t.getAttribute(W4);return![!0,"true",""].includes(e)},cI=function(t){var e;return!!(t&&(!((e=Z_(t))===null||e===void 0)&&e.focusGuard))},wp=function(t){return!cI(t)},uG=function(t){return!!t},dG=function(t,e){var n=t.tabIndex-e.tabIndex,r=t.index-e.index;if(n){if(!t.tabIndex)return 1;if(!e.tabIndex)return-1}return n||r},X_=function(t,e,n){return gs(t).map(function(r,i){return{node:r,index:i,tabIndex:n&&r.tabIndex===-1?(r.dataset||{}).focusGuard?0:-1:r.tabIndex}}).filter(function(r){return!e||r.tabIndex>=0}).sort(dG)},fG=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],lI=fG.join(","),hG="".concat(lI,", [data-focus-guard]"),$_=function(t,e){return gs((t.shadowRoot||t).children).reduce(function(n,r){return n.concat(r.matches(e?hG:lI)?[r]:[],$_(r))},[])},pG=function(t,e){var n;return t instanceof HTMLIFrameElement&&(!((n=t.contentDocument)===null||n===void 0)&&n.body)?Im([t.contentDocument.body],e):[t]},Im=function(t,e){return t.reduce(function(n,r){var i,s=$_(r,e),o=(i=[]).concat.apply(i,s.map(function(a){return pG(a,e)}));return n.concat(o,r.parentNode?gs(r.parentNode.querySelectorAll(lI)).filter(function(a){return a===r}):[])},[])},mG=function(t){var e=t.querySelectorAll("[".concat(V4,"]"));return gs(e).map(function(n){return Im([n])}).reduce(function(n,r){return n.concat(r)},[])},uI=function(t,e){return gs(t).filter(function(n){return W_(e,n)}).filter(function(n){return cG(n)})},bw=function(t,e){return e===void 0&&(e=new Map),gs(t).filter(function(n){return H_(e,n)})},Vy=function(t,e,n){return X_(uI(Im(t,n),e),!0,n)},ww=function(t,e){return X_(uI(Im(t),e),!1)},gG=function(t,e){return uI(mG(t),e)},il=function(t,e){return t.shadowRoot?il(t.shadowRoot,e):Object.getPrototypeOf(t).contains!==void 0&&Object.getPrototypeOf(t).contains.call(t,e)?!0:gs(t.children).some(function(n){var r;if(n instanceof HTMLIFrameElement){var i=(r=n.contentDocument)===null||r===void 0?void 0:r.body;return i?il(i,e):!1}return il(n,e)})},vG=function(t){for(var e=new Set,n=t.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var s=t[r].compareDocumentPosition(t[i]);(s&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(s&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return t.filter(function(o,a){return!e.has(a)})},K_=function(t){return t.parentNode?K_(t.parentNode):t},dI=function(t){var e=bp(t);return e.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(By);return n.push.apply(n,i?vG(gs(K_(r).querySelectorAll("[".concat(By,'="').concat(i,'"]:not([').concat(M_,'="disabled"])')))):[r]),n},[])},yG=function(t){try{return t()}catch{return}},Nd=function(t){if(t===void 0&&(t=document),!(!t||!t.activeElement)){var e=t.activeElement;return e.shadowRoot?Nd(e.shadowRoot):e instanceof HTMLIFrameElement&&yG(function(){return e.contentWindow.document})?Nd(e.contentWindow.document):e}},CG=function(t,e){return t===e},IG=function(t,e){return!!gs(t.querySelectorAll("iframe")).some(function(n){return CG(n,e)})},J_=function(t,e){return e===void 0&&(e=Nd(U_(t).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:dI(t).some(function(n){return il(n,e)||IG(n,e)})},SG=function(t){t===void 0&&(t=document);var e=Nd(t);return e?gs(t.querySelectorAll("[".concat(G4,"]"))).some(function(n){return il(n,e)}):!1},bG=function(t,e){return e.filter(z_).filter(function(n){return n.name===t.name}).filter(function(n){return n.checked})[0]||t},fI=function(t,e){return z_(t)&&t.name?bG(t,e):t},wG=function(t){var e=new Set;return t.forEach(function(n){return e.add(fI(n,t))}),t.filter(function(n){return e.has(n)})},Aw=function(t){return t[0]&&t.length>1?fI(t[0],t):t[0]},kw=function(t,e){return t.length>1?t.indexOf(fI(t[e],t)):e},Y_="NEW_FOCUS",AG=function(t,e,n,r){var i=t.length,s=t[0],o=t[i-1],a=cI(n);if(!(n&&t.indexOf(n)>=0)){var c=n!==void 0?e.indexOf(n):-1,l=r?e.indexOf(r):c,u=r?t.indexOf(r):-1,d=c-l,f=e.indexOf(s),h=e.indexOf(o),p=wG(e),g=n!==void 0?p.indexOf(n):-1,y=g-(r?p.indexOf(r):c),m=kw(t,0),v=kw(t,i-1);if(c===-1||u===-1)return Y_;if(!d&&u>=0)return u;if(c<=f&&a&&Math.abs(d)>1)return v;if(c>=h&&a&&Math.abs(d)>1)return m;if(d&&Math.abs(y)>1)return u;if(c<=f)return v;if(c>h)return m;if(d)return Math.abs(d)>1?u:(i+u+d)%i}},kG=function(t){return function(e){var n,r=(n=Z_(e))===null||n===void 0?void 0:n.autofocus;return e.autofocus||r!==void 0&&r!=="false"||t.indexOf(e)>=0}},EG=function(t,e,n){var r=t.map(function(s){var o=s.node;return o}),i=bw(r.filter(kG(n)));return i&&i.length?Aw(i):Aw(bw(e))},Wy=function(t,e){return e===void 0&&(e=[]),e.push(t),t.parentNode&&Wy(t.parentNode.host||t.parentNode,e),e},Zg=function(t,e){for(var n=Wy(t),r=Wy(e),i=0;i<n.length;i+=1){var s=n[i];if(r.indexOf(s)>=0)return s}return!1},q_=function(t,e,n){var r=bp(t),i=bp(e),s=r[0],o=!1;return i.filter(Boolean).forEach(function(a){o=Zg(o||a,a)||o,n.filter(Boolean).forEach(function(c){var l=Zg(s,c);l&&(!o||il(l,o)?o=l:o=Zg(l,o))})}),o},TG=function(t,e){return t.reduce(function(n,r){return n.concat(gG(r,e))},[])},_G=function(t,e){var n=new Map;return e.forEach(function(r){return n.set(r.node,r)}),t.map(function(r){return n.get(r)}).filter(uG)},RG=function(t,e){var n=Nd(bp(t).length>0?document:U_(t).ownerDocument),r=dI(t).filter(wp),i=q_(n||t,t,r),s=new Map,o=ww(r,s),a=Vy(r,s).filter(function(h){var p=h.node;return wp(p)});if(!(!a[0]&&(a=o,!a[0]))){var c=ww([i],s).map(function(h){var p=h.node;return p}),l=_G(c,a),u=l.map(function(h){var p=h.node;return p}),d=AG(u,c,n,e);if(d===Y_){var f=EG(o,u,TG(r,s));if(f)return{node:f};console.warn("focus-lock: cannot find any node to move focus into");return}return d===void 0?d:l[d]}},NG=function(t){var e=dI(t).filter(wp),n=q_(t,t,e),r=new Map,i=Vy([n],r,!0),s=Vy(e,r).filter(function(o){var a=o.node;return wp(a)}).map(function(o){var a=o.node;return a});return i.map(function(o){var a=o.node,c=o.index;return{node:a,index:c,lockItem:s.indexOf(a)>=0,guard:cI(a)}})},PG=function(t,e){"focus"in t&&t.focus(e),"contentWindow"in t&&t.contentWindow&&t.contentWindow.focus()},jg=0,zg=!1,Q_=function(t,e,n){n===void 0&&(n={});var r=RG(t,e);if(!zg&&r){if(jg>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),zg=!0,setTimeout(function(){zg=!1},1);return}jg++,PG(r.node,n.focusOptions),jg--}};function hI(t){setTimeout(t,1)}var MG=function(){return document&&document.activeElement===document.body},xG=function(){return MG()||SG()},sl=null,Hc=null,ol=null,Pd=!1,DG=function(){return!0},OG=function(e){return(sl.whiteList||DG)(e)},LG=function(e,n){ol={observerNode:e,portaledElement:n}},BG=function(e){return ol&&ol.portaledElement===e};function Ew(t,e,n,r){var i=null,s=t;do{var o=r[s];if(o.guard)o.node.dataset.focusAutoGuard&&(i=o);else if(o.lockItem){if(s!==t)return;i=null}else break}while((s+=n)!==e);i&&(i.node.tabIndex=0)}var FG=function(e){return e&&"current"in e?e.current:e},UG=function(e){return e?!!Pd:Pd==="meanwhile"},GG=function t(e,n,r){return n&&(n.host===e&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&t(e,n.parentNode,r))},VG=function(e,n){return n.some(function(r){return GG(e,r,r)})},Ap=function(){var e=!1;if(sl){var n=sl,r=n.observed,i=n.persistentFocus,s=n.autoFocus,o=n.shards,a=n.crossFrame,c=n.focusOptions,l=r||ol&&ol.portaledElement,u=document&&document.activeElement;if(l){var d=[l].concat(o.map(FG).filter(Boolean));if((!u||OG(u))&&(i||UG(a)||!xG()||!Hc&&s)&&(l&&!(J_(d)||u&&VG(u,d)||BG(u))&&(document&&!Hc&&u&&!s?(u.blur&&u.blur(),document.body.focus()):(e=Q_(d,Hc,{focusOptions:c}),ol={})),Pd=!1,Hc=document&&document.activeElement),document){var f=document&&document.activeElement,h=NG(d),p=h.map(function(g){var y=g.node;return y}).indexOf(f);p>-1&&(h.filter(function(g){var y=g.guard,m=g.node;return y&&m.dataset.focusAutoGuard}).forEach(function(g){var y=g.node;return y.removeAttribute("tabIndex")}),Ew(p,h.length,1,h),Ew(p,-1,-1,h))}}}return e},eR=function(e){Ap()&&e&&(e.stopPropagation(),e.preventDefault())},pI=function(){return hI(Ap)},WG=function(e){var n=e.target,r=e.currentTarget;r.contains(n)||LG(r,n)},HG=function(){return null},tR=function(){Pd="just",hI(function(){Pd="meanwhile"})},ZG=function(){document.addEventListener("focusin",eR),document.addEventListener("focusout",pI),window.addEventListener("blur",tR)},jG=function(){document.removeEventListener("focusin",eR),document.removeEventListener("focusout",pI),window.removeEventListener("blur",tR)};function zG(t){return t.filter(function(e){var n=e.disabled;return!n})}function XG(t){var e=t.slice(-1)[0];e&&!sl&&ZG();var n=sl,r=n&&e&&e.id===n.id;sl=e,n&&!r&&(n.onDeactivation(),t.filter(function(i){var s=i.id;return s===n.id}).length||n.returnFocus(!e)),e?(Hc=null,(!r||n.observed!==e.observed)&&e.onActivation(),Ap(),hI(Ap)):(jG(),Hc=null)}L_.assignSyncMedium(WG);B_.assignMedium(pI);J4.assignMedium(function(t){return t({moveFocusInside:Q_,focusInside:J_})});const $G=rG(zG,XG)(HG);var nR=w.forwardRef(function(e,n){return w.createElement(F_,_d({sideCar:$G,ref:n},e))}),rR=F_.propTypes||{};rR.sideCar;U4(rR,["sideCar"]);nR.propTypes={};const KG=nR,JG=St.forwardRef((t,e)=>{const[n,r]=w.useState(!1),i=w.useRef(null);return St.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),w.useEffect(()=>{var s;n&&((s=i.current)==null||s.focus())},[n]),w.useEffect(()=>{const s=o=>{o.key==="Escape"&&r(!1)};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[]),q.jsx(KG,{disabled:!n,children:q.jsxs("dialog",{className:"preferences-dialog",open:n,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[n&&q.jsx(F4,{}),q.jsx("button",{onClick:()=>r(!1),children:"Close"})]})})});var iR={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Tw=St.createContext&&St.createContext(iR),ea=function(){return ea=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},ea.apply(this,arguments)},YG=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function sR(t){return t&&t.map(function(e,n){return St.createElement(e.tag,ea({key:n},e.attr),sR(e.child))})}function lc(t){return function(e){return St.createElement(qG,ea({attr:ea({},t.attr)},e),sR(t.child))}}function qG(t){var e=function(n){var r=t.attr,i=t.size,s=t.title,o=YG(t,["attr","size","title"]),a=i||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),St.createElement("svg",ea({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:c,style:ea(ea({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&St.createElement("title",null,s),t.children)};return Tw!==void 0?St.createElement(Tw.Consumer,null,function(n){return e(n)}):e(iR)}function QG(t){return lc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}}]})(t)}function eV(t){return lc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(t)}function tV(t){return lc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"}}]})(t)}function oR(t){return lc({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(t)}function nV(t){return lc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"}}]})(t)}function rV(t){return lc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"}}]})(t)}function iV(t){return lc({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"}}]})(t)}const sV=({client:t,onClearLog:e,onSaveLog:n,onToggleUsers:r,onOpenPrefs:i})=>{const[s,o]=St.useState(t.cacophony.muted);return q.jsxs("div",{className:"toolbar",children:[q.jsxs("button",{onClick:n,accessKey:"l",children:[q.jsx(oR,{}),"Save Log"]}),q.jsxs("button",{onClick:e,accessKey:"c",children:[q.jsx(tV,{}),"Clear Log"]}),q.jsxs("button",{onClick:i,accessKey:"p",children:[q.jsx(QG,{}),"Preferences"]}),q.jsxs("button",{onClick:()=>{o(!s),t.cacophony.muted=!s},accessKey:"m",children:[s?q.jsx(iV,{}):q.jsx(rV,{}),s?"Unmute":"Mute"]}),q.jsx("button",{onClick:r,accessKey:"u",children:"Show/Hide Users"}),q.jsxs("label",{children:["Volume",q.jsx("input",{type:"range",min:"0",max:"100",onChange:a=>t.cacophony.setGlobalVolume(Number(a.target.value)/100)})]})]})};class oV extends St.Component{constructor(e){super(e),this.state={statusText:"Not connected"},e.client.on("statustext",n=>this.setState({statusText:n})),e.client.on("connect",()=>this.setState({statusText:"Connected"})),e.client.on("disconnect",()=>this.setState({statusText:"Disconnected"}))}render(){return q.jsx("div",{className:"statusbar",children:this.state.statusText})}}const aV=({users:t})=>q.jsxs("div",{className:"sidebar",children:[q.jsx("div",{className:"sidebar-header",role:"heading","aria-level":2,children:"Connected Players"}),q.jsx("div",{className:"sidebar-content",children:q.jsx("ul",{children:t.map(e=>{let n="";return e.away&&(n+=" away"),e.idle&&(n+=" idle"),q.jsx("li",{className:n,children:e.Name},e.Object)})})})]});var _w={};function cV(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var lV=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uV(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var aR={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(lV,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function s(g,y){var m=g[y];if(typeof m.bind=="function")return m.bind(g);try{return Function.prototype.bind.call(m,g)}catch{return function(){return Function.prototype.apply.apply(m,[g,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?o:console[g]!==void 0?s(console,g):console.log!==void 0?s(console,"log"):e}function c(g,y){for(var m=0;m<i.length;m++){var v=i[m];this[v]=m<g?e:this.methodFactory(v,g,y)}this.log=this.debug}function l(g,y,m){return function(){typeof console!==n&&(c.call(this,y,m),this[g].apply(this,arguments))}}function u(g,y,m){return a(g)||l.apply(this,arguments)}function d(g,y,m){var v=this,S;y=y??"WARN";var E="loglevel";typeof g=="string"?E+=":"+g:typeof g=="symbol"&&(E=void 0);function A(N){var M=(i[N]||"silent").toUpperCase();if(!(typeof window===n||!E)){try{window.localStorage[E]=M;return}catch{}try{window.document.cookie=encodeURIComponent(E)+"="+M+";"}catch{}}}function b(){var N;if(!(typeof window===n||!E)){try{N=window.localStorage[E]}catch{}if(typeof N===n)try{var M=window.document.cookie,D=M.indexOf(encodeURIComponent(E)+"=");D!==-1&&(N=/^([^;]+)/.exec(M.slice(D))[1])}catch{}return v.levels[N]===void 0&&(N=void 0),N}}function k(){if(!(typeof window===n||!E)){try{window.localStorage.removeItem(E);return}catch{}try{window.document.cookie=encodeURIComponent(E)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}v.name=g,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=m||u,v.getLevel=function(){return S},v.setLevel=function(N,M){if(typeof N=="string"&&v.levels[N.toUpperCase()]!==void 0&&(N=v.levels[N.toUpperCase()]),typeof N=="number"&&N>=0&&N<=v.levels.SILENT){if(S=N,M!==!1&&A(N),c.call(v,N,g),typeof console===n&&N<v.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+N},v.setDefaultLevel=function(N){y=N,b()||v.setLevel(N,!1)},v.resetLevel=function(){v.setLevel(y,!1),k()},v.enableAll=function(N){v.setLevel(v.levels.TRACE,N)},v.disableAll=function(N){v.setLevel(v.levels.SILENT,N)};var _=b();_==null&&(_=y),v.setLevel(_,!1)}var f=new d,h={};f.getLogger=function(y){if(typeof y!="symbol"&&typeof y!="string"||y==="")throw new TypeError("You must supply a name when creating a logger.");var m=h[y];return m||(m=h[y]=new d(y,f.getLevel(),f.methodFactory)),m};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(aR);var cR=aR.exports,Hy;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(Hy||(Hy={}));const L=cR.getLogger("livekit");L.setDefaultLevel(Hy.info);cR.getLogger("lk-e2ee");function cr(t,e){if(!t)throw new Error(e)}const dV=34028234663852886e22,fV=-34028234663852886e22,hV=4294967295,pV=2147483647,mV=-2147483648;function kh(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>pV||t<mV)throw new Error("invalid int 32: "+t)}function Zy(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>hV||t<0)throw new Error("invalid uint 32: "+t)}function lR(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>dV||t<fV))throw new Error("invalid float 32: "+t)}const uR=Symbol("@bufbuild/protobuf/enum-type");function gV(t){const e=t[uR];return cr(e,"missing enum type on enum object"),e}function dR(t,e,n,r){t[uR]=fR(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function fR(t,e,n){const r=Object.create(null),i=Object.create(null),s=[];for(const o of e){const a=hR(o);s.push(a),r[o.name]=a,i[o.no]=a}return{typeName:t,values:s,findName(o){return r[o]},findNumber(o){return i[o]}}}function vV(t,e,n){const r={};for(const i of e){const s=hR(i);r[s.localName]=s.no,r[s.no]=s.localName}return dR(r,t,e),r}function hR(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class pe{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,s=i.makeReadOptions(n);return i.readMessage(this,s.readerFactory(e),e.byteLength,s),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,s=i.makeReadOptions(n);return i.readMessage(r,e,s,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),s=i.writerFactory();return r.writeMessage(this,s,i),s.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function yV(t,e,n,r){var i;const s=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),o={[s]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[s];return Object.setPrototypeOf(o.prototype,new pe),Object.assign(o,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,c){return new o().fromBinary(a,c)},fromJson(a,c){return new o().fromJson(a,c)},fromJsonString(a,c){return new o().fromJsonString(a,c)},equals(a,c){return t.util.equals(o,a,c)}}),o}function CV(t,e,n,r){return{syntax:t,json:e,bin:n,util:r,makeMessageType(i,s,o){return yV(this,i,s,o)},makeEnum:vV,makeEnumType:fR,getEnumType:gV}}var re;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(re||(re={}));var Ka;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Ka||(Ka={}));function IV(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Xg(t,e,n){for(let s=0;s<28;s=s+7){const o=t>>>s,a=!(!(o>>>7)&&e==0),c=(a?o|128:o)&255;if(n.push(c),!a)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let s=3;s<31;s=s+7){const o=e>>>s,a=!!(o>>>7),c=(a?o|128:o)&255;if(n.push(c),!a)return}n.push(e>>>31&1)}}const Eh=4294967296;function Rw(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function s(o,a){const c=Number(t.slice(o,a));i*=n,r=r*n+c,r>=Eh&&(i=i+(r/Eh|0),r=r%Eh)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),e?mR(r,i):mI(r,i)}function SV(t,e){let n=mI(t,e);const r=n.hi&2147483648;r&&(n=mR(n.lo,n.hi));const i=pR(n.lo,n.hi);return r?"-"+i:i}function pR(t,e){if({lo:t,hi:e}=bV(t,e),e<=2097151)return String(Eh*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let s=n+r*6777216+i*6710656,o=r+i*8147497,a=i*2;const c=1e7;return s>=c&&(o+=Math.floor(s/c),s%=c),o>=c&&(a+=Math.floor(o/c),o%=c),a.toString()+Nw(o)+Nw(s)}function bV(t,e){return{lo:t>>>0,hi:e>>>0}}function mI(t,e){return{lo:t|0,hi:e|0}}function mR(t,e){return e=~e,t?t=~t+1:e+=1,mI(t,e)}const Nw=t=>{const e=String(t);return"0000000".slice(e.length)+e};function Pw(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function wV(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function AV(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof _w!="object"||_w.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),s=BigInt("9223372036854775807"),o=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>s||l<i)throw new Error("int64 invalid: ".concat(c));return l},uParse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>a||l<o)throw new Error("uint64 invalid: ".concat(c));return l},enc(c){return t.setBigInt64(0,this.parse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(c){return t.setBigInt64(0,this.uParse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigInt64(0,!0)},uDec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigUint64(0,!0)}}}const n=i=>cr(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>cr(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),Rw(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),Rw(i)},dec(i,s){return SV(i,s)},uDec(i,s){return pR(i,s)}}}const xe=AV();var Vt;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(Vt||(Vt={}));class kV{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Zy(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return kh(e),Pw(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){lR(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Zy(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){kh(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return kh(e),e=(e<<1^e>>31)>>>0,Pw(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=xe.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=xe.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=xe.enc(e);return Xg(n.lo,n.hi,this.buf),this}sint64(e){let n=xe.enc(e),r=n.hi>>31,i=n.lo<<1^r,s=(n.hi<<1|n.lo>>>31)^r;return Xg(i,s,this.buf),this}uint64(e){let n=xe.uEnc(e);return Xg(n.lo,n.hi,this.buf),this}}class EV{constructor(e,n){this.varint64=IV,this.uint32=wV,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e){let n=this.pos;switch(e){case Vt.Varint:for(;this.buf[this.pos++]&128;);break;case Vt.Bit64:this.pos+=4;case Vt.Bit32:this.pos+=4;break;case Vt.LengthDelimited:let r=this.uint32();this.pos+=r;break;case Vt.StartGroup:let i;for(;(i=this.tag()[1])!==Vt.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return xe.dec(...this.varint64())}uint64(){return xe.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,xe.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return xe.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return xe.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function jy(t,e){return e instanceof pe||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}re.DOUBLE,re.FLOAT,re.INT64,re.UINT64,re.INT32,re.UINT32,re.BOOL,re.STRING,re.BYTES;function bo(t,e,n){if(e===n)return!0;if(t==re.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case re.UINT64:case re.FIXED64:case re.INT64:case re.SFIXED64:case re.SINT64:return e==n}return!1}function zy(t,e){switch(t){case re.BOOL:return!1;case re.UINT64:case re.FIXED64:case re.INT64:case re.SFIXED64:case re.SINT64:return e==0?xe.zero:"0";case re.DOUBLE:case re.FLOAT:return 0;case re.BYTES:return new Uint8Array(0);case re.STRING:return"";default:return 0}}function gR(t,e){const n=e===void 0;let r=Vt.Varint,i=e===0;switch(t){case re.STRING:i=n||!e.length,r=Vt.LengthDelimited;break;case re.BOOL:i=e===!1;break;case re.DOUBLE:r=Vt.Bit64;break;case re.FLOAT:r=Vt.Bit32;break;case re.INT64:i=n||e==0;break;case re.UINT64:i=n||e==0;break;case re.FIXED64:i=n||e==0,r=Vt.Bit64;break;case re.BYTES:i=n||!e.byteLength,r=Vt.LengthDelimited;break;case re.FIXED32:r=Vt.Bit32;break;case re.SFIXED32:r=Vt.Bit32;break;case re.SFIXED64:i=n||e==0,r=Vt.Bit64;break;case re.SINT64:i=n||e==0;break}const s=re[t].toLowerCase();return[r,s,n||i]}const bc=Symbol("@bufbuild/protobuf/unknown-fields"),Mw={readUnknownFields:!0,readerFactory:t=>new EV(t)},xw={writeUnknownFields:!0,writerFactory:()=>new kV};function TV(t){return t?Object.assign(Object.assign({},Mw),t):Mw}function _V(t){return t?Object.assign(Object.assign({},xw),t):xw}function RV(){return{makeReadOptions:TV,makeWriteOptions:_V,listUnknownFields(t){var e;return(e=t[bc])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[bc]},writeUnknownFields(t,e){const r=t[bc];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[bc])||(i[bc]=[]),i[bc].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r){const i=t.getType(),s=n===void 0?e.len:e.pos+n;for(;e.pos<s;){const[o,a]=e.tag(),c=i.fields.find(o);if(!c){const f=e.skip(a);r.readUnknownFields&&this.onUnknownField(t,o,a,f);continue}let l=t,u=c.repeated,d=c.localName;switch(c.oneof&&(l=l[c.oneof.localName],l.case!=d&&delete l.value,l.case=d,d="value"),c.kind){case"scalar":case"enum":const f=c.kind=="enum"?re.INT32:c.T;let h=kp;if(c.kind=="scalar"&&c.L>0&&(h=PV),u){let m=l[d];if(a==Vt.LengthDelimited&&f!=re.STRING&&f!=re.BYTES){let v=e.uint32()+e.pos;for(;e.pos<v;)m.push(h(e,f))}else m.push(h(e,f))}else l[d]=h(e,f);break;case"message":const p=c.T;u?l[d].push(Th(e,new p,r)):l[d]instanceof pe?Th(e,l[d],r):(l[d]=Th(e,new p,r),p.fieldWrapper&&!c.oneof&&!c.repeated&&(l[d]=p.fieldWrapper.unwrapField(l[d])));break;case"map":let[g,y]=NV(c,e,r);l[d][g]=y;break}}}}}function Th(t,e,n){return e.getType().runtime.bin.readMessage(e,t,t.uint32(),n),e}function NV(t,e,n){const r=e.uint32(),i=e.pos+r;let s,o;for(;e.pos<i;){let[a]=e.tag();switch(a){case 1:s=kp(e,t.K);break;case 2:switch(t.V.kind){case"scalar":o=kp(e,t.V.T);break;case"enum":o=e.int32();break;case"message":o=Th(e,new t.V.T,n);break}break}}if(s===void 0){let a=zy(t.K,Ka.BIGINT);s=t.K==re.BOOL?a.toString():a}if(typeof s!="string"&&typeof s!="number"&&(s=s.toString()),o===void 0)switch(t.V.kind){case"scalar":o=zy(t.V.T,Ka.BIGINT);break;case"enum":o=0;break;case"message":o=new t.V.T;break}return[s,o]}function PV(t,e){const n=kp(t,e);return typeof n=="bigint"?n.toString():n}function kp(t,e){switch(e){case re.STRING:return t.string();case re.BOOL:return t.bool();case re.DOUBLE:return t.double();case re.FLOAT:return t.float();case re.INT32:return t.int32();case re.INT64:return t.int64();case re.UINT64:return t.uint64();case re.FIXED64:return t.fixed64();case re.BYTES:return t.bytes();case re.FIXED32:return t.fixed32();case re.SFIXED32:return t.sfixed32();case re.SFIXED64:return t.sfixed64();case re.SINT64:return t.sint64();case re.UINT32:return t.uint32();case re.SINT32:return t.sint32()}}function MV(t,e,n,r,i){t.tag(n.no,Vt.LengthDelimited),t.fork();let s=r;switch(n.K){case re.INT32:case re.FIXED32:case re.UINT32:case re.SFIXED32:case re.SINT32:s=Number.parseInt(r);break;case re.BOOL:cr(r=="true"||r=="false"),s=r=="true";break}switch(qu(t,n.K,1,s,!0),n.V.kind){case"scalar":qu(t,n.V.T,2,i,!0);break;case"enum":qu(t,re.INT32,2,i,!0);break;case"message":Xy(t,e,n.V.T,2,i);break}t.join()}function Xy(t,e,n,r,i){if(i!==void 0){const s=jy(n,i);t.tag(r,Vt.LengthDelimited).bytes(s.toBinary(e))}}function qu(t,e,n,r,i){let[s,o,a]=gR(e,r);(!a||i)&&t.tag(n,s)[o](r)}function xV(t,e,n,r){if(!r.length)return;t.tag(n,Vt.LengthDelimited).fork();let[,i]=gR(e);for(let s=0;s<r.length;s++)t[i](r[s]);t.join()}function DV(){return Object.assign(Object.assign({},RV()),{writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){let s,o=i.repeated,a=i.localName;if(i.oneof){const c=t[i.oneof.localName];if(c.case!==a)continue;s=c.value}else s=t[a];switch(i.kind){case"scalar":case"enum":let c=i.kind=="enum"?re.INT32:i.T;if(o)if(i.packed)xV(e,c,i.no,s);else for(const l of s)qu(e,c,i.no,l,!0);else s!==void 0&&qu(e,c,i.no,s,!!i.oneof||i.opt);break;case"message":if(o)for(const l of s)Xy(e,n,i.T,i.no,l);else Xy(e,n,i.T,i.no,s);break;case"map":for(const[l,u]of Object.entries(s))MV(e,n,i,l,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}let Es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Sm=[];for(let t=0;t<Es.length;t++)Sm[Es[t].charCodeAt(0)]=t;Sm[45]=Es.indexOf("+");Sm[95]=Es.indexOf("/");const vR={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,s,o=0;for(let a=0;a<t.length;a++){if(s=Sm[t.charCodeAt(a)],s===void 0)switch(t[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:o=s,i=1;break;case 1:n[r++]=o<<2|(s&48)>>4,o=s,i=2;break;case 2:n[r++]=(o&15)<<4|(s&60)>>2,o=s,i=3;break;case 3:n[r++]=(o&3)<<6|s,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let s=0;s<t.length;s++)switch(r=t[s],n){case 0:e+=Es[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=Es[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=Es[i|r>>6],e+=Es[r&63],n=0;break}return n&&(e+=Es[i],e+="=",n==1&&(e+="=")),e}},Dw={ignoreUnknownFields:!1},Ow={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function OV(t){return t?Object.assign(Object.assign({},Dw),t):Dw}function LV(t){return t?Object.assign(Object.assign({},Ow),t):Ow}function BV(t){const e=t(FV,Lw);return{makeReadOptions:OV,makeWriteOptions:LV,readMessage(n,r,i,s){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(r)));s=s??new n;const o={};for(const[a,c]of Object.entries(r)){const l=n.fields.findJsonName(a);if(!l){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let u=l.localName,d=s;if(l.oneof){if(c===null&&l.kind=="scalar")continue;const f=o[l.oneof.localName];if(f)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(l.oneof.name,'" present: "').concat(f,'", "').concat(a,'"'));o[l.oneof.localName]=a,d=d[l.oneof.localName]={case:u},u="value"}if(l.repeated){if(c===null)continue;if(!Array.isArray(c))throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const f=d[u];for(const h of c){if(h===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(h)));let p;switch(l.kind){case"message":p=l.T.fromJson(h,i);break;case"enum":if(p=$g(l.T,h,i.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=bu(l.T,h,l.L)}catch(g){let y="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(h));throw g instanceof Error&&g.message.length>0&&(y+=": ".concat(g.message)),new Error(y)}break}f.push(p)}}else if(l.kind=="map"){if(c===null)continue;if(Array.isArray(c)||typeof c!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const f=d[u];for(const[h,p]of Object.entries(c)){if(p===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: map value null"));let g;switch(l.V.kind){case"message":g=l.V.T.fromJson(p,i);break;case"enum":if(g=$g(l.V.T,p,i.ignoreUnknownFields),g===void 0)continue;break;case"scalar":try{g=bu(l.V.T,p,Ka.BIGINT)}catch(y){let m="cannot decode map value for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw y instanceof Error&&y.message.length>0&&(m+=": ".concat(y.message)),new Error(m)}break}try{f[bu(l.K,l.K==re.BOOL?h=="true"?!0:h=="false"?!1:h:h,Ka.BIGINT).toString()]=g}catch(y){let m="cannot decode map key for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw y instanceof Error&&y.message.length>0&&(m+=": ".concat(y.message)),new Error(m)}}}else switch(l.kind){case"message":const f=l.T;if(c===null&&f.typeName!="google.protobuf.Value"){if(l.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}d[u]instanceof pe?d[u].fromJson(c,i):(d[u]=f.fromJson(c,i),f.fieldWrapper&&!l.oneof&&(d[u]=f.fieldWrapper.unwrapField(d[u])));break;case"enum":const h=$g(l.T,c,i.ignoreUnknownFields);h!==void 0&&(d[u]=h);break;case"scalar":try{d[u]=bu(l.T,c,l.L)}catch(p){let g="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw p instanceof Error&&p.message.length>0&&(g+=": ".concat(p.message)),new Error(g)}break}}return s},writeMessage(n,r){const i=n.getType(),s={};let o;try{for(const a of i.fields.byMember()){let c;if(a.kind=="oneof"){const l=n[a.localName];if(l.value===void 0)continue;if(o=a.findField(l.case),!o)throw"oneof case not found: "+l.case;c=e(o,l.value,r)}else o=a,c=e(o,n[o.localName],r);c!==void 0&&(s[r.useProtoFieldName?o.name:o.jsonName]=c)}}catch(a){const c=o?"cannot encode field ".concat(i.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),l=a instanceof Error?a.message:String(a);throw new Error(c+(l.length>0?": ".concat(l):""))}return s},readScalar:bu,writeScalar:Lw,debug:yR}}function yR(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function bu(t,e,n){switch(t){case re.DOUBLE:case re.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==re.FLOAT&&lR(r),r;case re.INT32:case re.FIXED32:case re.SFIXED32:case re.SINT32:case re.UINT32:if(e===null)return 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return t==re.UINT32?Zy(i):kh(i),i;case re.INT64:case re.SFIXED64:case re.SINT64:if(e===null)return xe.zero;if(typeof e!="number"&&typeof e!="string")break;const s=xe.parse(e);return n?s.toString():s;case re.FIXED64:case re.UINT64:if(e===null)return xe.zero;if(typeof e!="number"&&typeof e!="string")break;const o=xe.uParse(e);return n?o.toString():o;case re.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case re.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case re.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return vR.dec(e)}throw new Error}function $g(t,e,n){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=t.findName(e);if(r||n)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(yR(e)))}function FV(t,e,n,r){var i;if(e===void 0)return e;if(e===0&&!n)return;if(r)return e;if(t.typeName=="google.protobuf.NullValue")return null;const s=t.findNumber(e);return(i=s==null?void 0:s.name)!==null&&i!==void 0?i:e}function Lw(t,e,n){if(e!==void 0)switch(t){case re.INT32:case re.SFIXED32:case re.SINT32:case re.FIXED32:case re.UINT32:return cr(typeof e=="number"),e!=0||n?e:void 0;case re.FLOAT:case re.DOUBLE:return cr(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case re.STRING:return cr(typeof e=="string"),e.length>0||n?e:void 0;case re.BOOL:return cr(typeof e=="boolean"),e||n?e:void 0;case re.UINT64:case re.FIXED64:case re.INT64:case re.SFIXED64:case re.SINT64:return cr(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case re.BYTES:return cr(e instanceof Uint8Array),n||e.byteLength>0?vR.enc(e):void 0}}function UV(){return BV((t,e)=>function(r,i,s){if(r.kind=="map"){const o={};switch(r.V.kind){case"scalar":for(const[c,l]of Object.entries(i)){const u=e(r.V.T,l,!0);cr(u!==void 0),o[c.toString()]=u}break;case"message":for(const[c,l]of Object.entries(i))o[c.toString()]=l.toJson(s);break;case"enum":const a=r.V.T;for(const[c,l]of Object.entries(i)){cr(l===void 0||typeof l=="number");const u=t(a,l,!0,s.enumAsInteger);cr(u!==void 0),o[c.toString()]=u}break}return s.emitDefaultValues||Object.keys(o).length>0?o:void 0}else if(r.repeated){const o=[];switch(r.kind){case"scalar":for(let a=0;a<i.length;a++)o.push(e(r.T,i[a],!0));break;case"enum":for(let a=0;a<i.length;a++)o.push(t(r.T,i[a],!0,s.enumAsInteger));break;case"message":for(let a=0;a<i.length;a++)o.push(jy(r.T,i[a]).toJson(s));break}return s.emitDefaultValues||o.length>0?o:void 0}else switch(r.kind){case"scalar":return e(r.T,i,!!r.oneof||r.opt||s.emitDefaultValues);case"enum":return t(r.T,i,!!r.oneof||r.opt||s.emitDefaultValues,s.enumAsInteger);case"message":return i!==void 0?jy(r.T,i).toJson(s):void 0}})}function GV(){return{setEnumType:dR,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,s=e,o=t;if(o[i]!==void 0)switch(r.kind){case"oneof":const a=o[i].case;if(a===void 0)continue;const c=r.findField(a);let l=o[i].value;c&&c.kind=="message"&&!(l instanceof c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===re.BYTES&&(l=wu(l)),s[i]={case:a,value:l};break;case"scalar":case"enum":let u=o[i];r.T===re.BYTES&&(u=r.repeated?u.map(wu):wu(u)),s[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===re.BYTES)for(const[h,p]of Object.entries(o[i]))s[i][h]=wu(p);else Object.assign(s[i],o[i]);break;case"message":const f=r.V.T;for(const h of Object.keys(o[i])){let p=o[i][h];f.fieldWrapper||(p=new f(p)),s[i][h]=p}break}break;case"message":const d=r.T;if(r.repeated)s[i]=o[i].map(f=>f instanceof d?f:new d(f));else if(o[i]!==void 0){const f=o[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?s[i]=wu(f):s[i]=f:s[i]=f instanceof d?f:new d(f)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],s=n[r.localName];if(r.repeated){if(i.length!==s.length)return!1;switch(r.kind){case"message":return i.every((o,a)=>r.T.equals(o,s[a]));case"scalar":return i.every((o,a)=>bo(r.T,o,s[a]));case"enum":return i.every((o,a)=>bo(re.INT32,o,s[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,s);case"enum":return bo(re.INT32,i,s);case"scalar":return bo(r.T,i,s);case"oneof":if(i.case!==s.case)return!1;const o=r.findField(i.case);if(o===void 0)return!0;switch(o.kind){case"message":return o.T.equals(i.value,s.value);case"enum":return bo(re.INT32,i.value,s.value);case"scalar":return bo(o.T,i.value,s.value)}throw new Error("oneof cannot contain ".concat(o.kind));case"map":const a=Object.keys(i).concat(Object.keys(s));switch(r.V.kind){case"message":const c=r.V.T;return a.every(u=>c.equals(i[u],s[u]));case"enum":return a.every(u=>bo(re.INT32,i[u],s[u]));case"scalar":const l=r.V.T;return a.every(u=>bo(l,i[u],s[u]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const s=t[i.localName];let o;if(i.repeated)o=s.map(zf);else if(i.kind=="map"){o=r[i.localName];for(const[a,c]of Object.entries(s))o[a]=zf(c)}else i.kind=="oneof"?o=i.findField(s.case)?{case:s.case,value:zf(s.value)}:{case:void 0}:o=zf(s);r[i.localName]=o}return n}}}function zf(t){if(t===void 0)return t;if(t instanceof pe)return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function wu(t){return t instanceof Uint8Array?t:new Uint8Array(t)}class VV{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function CR(t,e){const n=IR(t);return e?n:XV(zV(n))}function WV(t){return CR(t,!1)}const HV=IR;function IR(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const ZV=new Set(["constructor","toString","toJSON","valueOf"]),jV=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),SR=t=>"".concat(t,"$"),zV=t=>jV.has(t)?SR(t):t,XV=t=>ZV.has(t)?SR(t):t;class $V{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=WV(e)}addField(e){cr(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}const R=CV("proto3",UV(),DV(),Object.assign(Object.assign({},GV()),{newFieldList(t){return new VV(t,KV)},initFields(t){for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=zy(e.T,e.L);break}}}}));function KV(t){var e,n,r,i;const s=[];let o;for(const a of typeof t=="function"?t():t){const c=a;if(c.localName=CR(a.name,a.oneof!==void 0),c.jsonName=(e=a.jsonName)!==null&&e!==void 0?e:HV(a.name),c.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(c.L=(r=a.L)!==null&&r!==void 0?r:Ka.BIGINT),c.packed=(i=a.packed)!==null&&i!==void 0?i:a.kind=="enum"||a.kind=="scalar"&&a.T!=re.BYTES&&a.T!=re.STRING,a.oneof!==void 0){const l=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!o||o.name!=l)&&(o=new $V(l)),c.oneof=o,o.addField(c)}s.push(c)}return s}class mn extends pe{constructor(e){super(),this.seconds=xe.zero,this.nanos=0,R.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(R.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=xe.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return mn.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new mn({seconds:xe.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new mn().fromBinary(e,n)}static fromJson(e,n){return new mn().fromJson(e,n)}static fromJsonString(e,n){return new mn().fromJsonString(e,n)}static equals(e,n){return R.util.equals(mn,e,n)}}mn.runtime=R;mn.typeName="google.protobuf.Timestamp";mn.fields=R.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var $y;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC"})($y||($y={}));R.util.setEnumType($y,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var Ky;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8"})(Ky||(Ky={}));R.util.setEnumType(Ky,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var Jy;(function(t){t[t.IC_DEFAULT=0]="IC_DEFAULT",t[t.IC_JPEG=1]="IC_JPEG"})(Jy||(Jy={}));R.util.setEnumType(Jy,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var Ln;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA"})(Ln||(Ln={}));R.util.setEnumType(Ln,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var Wt;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(Wt||(Wt={}));R.util.setEnumType(Wt,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var sn;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF"})(sn||(sn={}));R.util.setEnumType(sn,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var Rs;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.LOST=3]="LOST"})(Rs||(Rs={}));R.util.setEnumType(Rs,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var Ei;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED"})(Ei||(Ei={}));R.util.setEnumType(Ei,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var to;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE"})(to||(to={}));R.util.setEnumType(to,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var ws;(function(t){t[t.RR_UNKNOWN=0]="RR_UNKNOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(ws||(ws={}));R.util.setEnumType(ws,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var Md;(function(t){t[t.SE_UNKNOWN=0]="SE_UNKNOWN",t[t.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",t[t.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(Md||(Md={}));R.util.setEnumType(Md,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let eu=class Fu extends pe{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=xe.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Fu().fromBinary(e,n)}static fromJson(e,n){return new Fu().fromJson(e,n)}static fromJsonString(e,n){return new Fu().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Fu,e,n)}};eu.runtime=R;eu.typeName="livekit.Room";eu.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:hi,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class hi extends pe{constructor(e){super(),this.mime="",this.fmtpLine="",R.util.initPartial(e,this)}static fromBinary(e,n){return new hi().fromBinary(e,n)}static fromJson(e,n){return new hi().fromJson(e,n)}static fromJsonString(e,n){return new hi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(hi,e,n)}}hi.runtime=R;hi.typeName="livekit.Codec";hi.fields=R.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class Uo extends pe{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new Uo().fromBinary(e,n)}static fromJson(e,n){return new Uo().fromJson(e,n)}static fromJsonString(e,n){return new Uo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Uo,e,n)}}Uo.runtime=R;Uo.typeName="livekit.PlayoutDelay";Uo.fields=R.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class Ns extends pe{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Ns().fromBinary(e,n)}static fromJson(e,n){return new Ns().fromJson(e,n)}static fromJsonString(e,n){return new Ns().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ns,e,n)}}Ns.runtime=R;Ns.typeName="livekit.ParticipantPermission";Ns.fields=R.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:R.getEnumType(Wt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class Er extends pe{constructor(e){super(),this.sid="",this.identity="",this.state=Ja.JOINING,this.tracks=[],this.metadata="",this.joinedAt=xe.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Er().fromBinary(e,n)}static fromJson(e,n){return new Er().fromJson(e,n)}static fromJsonString(e,n){return new Er().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Er,e,n)}}Er.runtime=R;Er.typeName="livekit.ParticipantInfo";Er.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:R.getEnumType(Ja)},{no:4,name:"tracks",kind:"message",T:ur,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:Ns},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var Ja;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED"})(Ja||(Ja={}));R.util.setEnumType(Ja,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class Go extends pe{constructor(e){super(),R.util.initPartial(e,this)}static fromBinary(e,n){return new Go().fromBinary(e,n)}static fromJson(e,n){return new Go().fromJson(e,n)}static fromJsonString(e,n){return new Go().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Go,e,n)}}Go.runtime=R;Go.typeName="livekit.Encryption";Go.fields=R.util.newFieldList(()=>[]);var An;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM"})(An||(An={}));R.util.setEnumType(An,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class Ps extends pe{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Ps().fromBinary(e,n)}static fromJson(e,n){return new Ps().fromJson(e,n)}static fromJsonString(e,n){return new Ps().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ps,e,n)}}Ps.runtime=R;Ps.typeName="livekit.SimulcastCodecInfo";Ps.fields=R.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:er,repeated:!0}]);class ur extends pe{constructor(e){super(),this.sid="",this.type=Ln.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=Wt.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=An.NONE,this.stream="",R.util.initPartial(e,this)}static fromBinary(e,n){return new ur().fromBinary(e,n)}static fromJson(e,n){return new ur().fromJson(e,n)}static fromJsonString(e,n){return new ur().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ur,e,n)}}ur.runtime=R;ur.typeName="livekit.TrackInfo";ur.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:R.getEnumType(Ln)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:R.getEnumType(Wt)},{no:10,name:"layers",kind:"message",T:er,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Ps,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:R.getEnumType(An)},{no:17,name:"stream",kind:"scalar",T:9}]);class er extends pe{constructor(e){super(),this.quality=sn.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new er().fromBinary(e,n)}static fromJson(e,n){return new er().fromJson(e,n)}static fromJsonString(e,n){return new er().fromJsonString(e,n)}static equals(e,n){return R.util.equals(er,e,n)}}er.runtime=R;er.typeName="livekit.VideoLayer";er.fields=R.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:R.getEnumType(sn)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class Wi extends pe{constructor(e){super(),this.kind=qt.RELIABLE,this.value={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new Wi().fromBinary(e,n)}static fromJson(e,n){return new Wi().fromJson(e,n)}static fromJsonString(e,n){return new Wi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Wi,e,n)}}Wi.runtime=R;Wi.typeName="livekit.DataPacket";Wi.fields=R.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:R.getEnumType(qt)},{no:2,name:"user",kind:"message",T:Zi,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Ms,oneof:"value"}]);var qt;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY"})(qt||(qt={}));R.util.setEnumType(qt,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class Ms extends pe{constructor(e){super(),this.speakers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Ms().fromBinary(e,n)}static fromJson(e,n){return new Ms().fromJson(e,n)}static fromJsonString(e,n){return new Ms().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ms,e,n)}}Ms.runtime=R;Ms.typeName="livekit.ActiveSpeakerUpdate";Ms.fields=R.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Hi,repeated:!0}]);class Hi extends pe{constructor(e){super(),this.sid="",this.level=0,this.active=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Hi().fromBinary(e,n)}static fromJson(e,n){return new Hi().fromJson(e,n)}static fromJsonString(e,n){return new Hi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Hi,e,n)}}Hi.runtime=R;Hi.typeName="livekit.SpeakerInfo";Hi.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class Zi extends pe{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Zi().fromBinary(e,n)}static fromJson(e,n){return new Zi().fromJson(e,n)}static fromJsonString(e,n){return new Zi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Zi,e,n)}}Zi.runtime=R;Zi.typeName="livekit.UserPacket";Zi.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class ji extends pe{constructor(e){super(),this.participantSid="",this.trackSids=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new ji().fromBinary(e,n)}static fromJson(e,n){return new ji().fromJson(e,n)}static fromJsonString(e,n){return new ji().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ji,e,n)}}ji.runtime=R;ji.typeName="livekit.ParticipantTracks";ji.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class xs extends pe{constructor(e){super(),this.edition=Pl.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",R.util.initPartial(e,this)}static fromBinary(e,n){return new xs().fromBinary(e,n)}static fromJson(e,n){return new xs().fromJson(e,n)}static fromJsonString(e,n){return new xs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(xs,e,n)}}xs.runtime=R;xs.typeName="livekit.ServerInfo";xs.fields=R.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:R.getEnumType(Pl)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var Pl;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud"})(Pl||(Pl={}));R.util.setEnumType(Pl,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class Ds extends pe{constructor(e){super(),this.sdk=Ml.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Ds().fromBinary(e,n)}static fromJson(e,n){return new Ds().fromJson(e,n)}static fromJsonString(e,n){return new Ds().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ds,e,n)}}Ds.runtime=R;Ds.typeName="livekit.ClientInfo";Ds.fields=R.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:R.getEnumType(Ml)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var Ml;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.PYTHON=9]="PYTHON",t[t.CPP=10]="CPP"})(Ml||(Ml={}));R.util.setEnumType(Ml,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class zi extends pe{constructor(e){super(),this.resumeConnection=Ei.UNSET,this.forceRelay=Ei.UNSET,R.util.initPartial(e,this)}static fromBinary(e,n){return new zi().fromBinary(e,n)}static fromJson(e,n){return new zi().fromJson(e,n)}static fromJsonString(e,n){return new zi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(zi,e,n)}}zi.runtime=R;zi.typeName="livekit.ClientConfiguration";zi.fields=R.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:Xi},{no:2,name:"screen",kind:"message",T:Xi},{no:3,name:"resume_connection",kind:"enum",T:R.getEnumType(Ei)},{no:4,name:"disabled_codecs",kind:"message",T:Os},{no:5,name:"force_relay",kind:"enum",T:R.getEnumType(Ei)}]);class Xi extends pe{constructor(e){super(),this.hardwareEncoder=Ei.UNSET,R.util.initPartial(e,this)}static fromBinary(e,n){return new Xi().fromBinary(e,n)}static fromJson(e,n){return new Xi().fromJson(e,n)}static fromJsonString(e,n){return new Xi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Xi,e,n)}}Xi.runtime=R;Xi.typeName="livekit.VideoConfiguration";Xi.fields=R.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:R.getEnumType(Ei)}]);class Os extends pe{constructor(e){super(),this.codecs=[],this.publish=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Os().fromBinary(e,n)}static fromJson(e,n){return new Os().fromJson(e,n)}static fromJsonString(e,n){return new Os().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Os,e,n)}}Os.runtime=R;Os.typeName="livekit.DisabledCodecs";Os.fields=R.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:hi,repeated:!0},{no:2,name:"publish",kind:"message",T:hi,repeated:!0}]);class $i extends pe{constructor(e){super(),this.duration=0,this.startTimestamp=xe.zero,this.endTimestamp=xe.zero,this.rtpClockTicks=xe.zero,this.driftSamples=xe.zero,this.driftMs=0,this.clockRate=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new $i().fromBinary(e,n)}static fromJson(e,n){return new $i().fromJson(e,n)}static fromJsonString(e,n){return new $i().fromJsonString(e,n)}static equals(e,n){return R.util.equals($i,e,n)}}$i.runtime=R;$i.typeName="livekit.RTPDrift";$i.fields=R.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:mn},{no:2,name:"end_time",kind:"message",T:mn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class Vo extends pe{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=xe.zero,this.headerBytes=xe.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=xe.zero,this.headerBytesDuplicate=xe.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=xe.zero,this.headerBytesPadding=xe.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new Vo().fromBinary(e,n)}static fromJson(e,n){return new Vo().fromJson(e,n)}static fromJsonString(e,n){return new Vo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Vo,e,n)}}Vo.runtime=R;Vo.typeName="livekit.RTPStats";Vo.fields=R.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:mn},{no:2,name:"end_time",kind:"message",T:mn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:mn},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:mn},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:mn},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:mn},{no:44,name:"packet_drift",kind:"message",T:$i},{no:45,name:"report_drift",kind:"message",T:$i}]);class Wo extends pe{constructor(e){super(),this.unixMicro=xe.zero,this.ticks=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new Wo().fromBinary(e,n)}static fromJson(e,n){return new Wo().fromJson(e,n)}static fromJsonString(e,n){return new Wo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Wo,e,n)}}Wo.runtime=R;Wo.typeName="livekit.TimedVersion";Wo.fields=R.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const Au=7e3,JV=[0,300,2*2*300,3*3*300,4*4*300,Au,Au,Au,Au,Au];class YV{constructor(e){this._retryDelays=e!==void 0?[...e]:JV}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function U(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function Bw(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function kc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Bw=="function"?Bw(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var gI={exports:{}},al=typeof Reflect=="object"?Reflect:null,Fw=al&&typeof al.apply=="function"?al.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},_h;al&&typeof al.ownKeys=="function"?_h=al.ownKeys:Object.getOwnPropertySymbols?_h=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:_h=function(e){return Object.getOwnPropertyNames(e)};function qV(t){console&&console.warn&&console.warn(t)}var bR=Number.isNaN||function(e){return e!==e};function nt(){nt.init.call(this)}gI.exports=nt;gI.exports.once=nW;nt.EventEmitter=nt;nt.prototype._events=void 0;nt.prototype._eventsCount=0;nt.prototype._maxListeners=void 0;var Uw=10;function bm(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(nt,"defaultMaxListeners",{enumerable:!0,get:function(){return Uw},set:function(t){if(typeof t!="number"||t<0||bR(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Uw=t}});nt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};nt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||bR(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function wR(t){return t._maxListeners===void 0?nt.defaultMaxListeners:t._maxListeners}nt.prototype.getMaxListeners=function(){return wR(this)};nt.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")Fw(c,this,n);else for(var l=c.length,u=_R(c,l),r=0;r<l;++r)Fw(u[r],this,n);return!0};function AR(t,e,n,r){var i,s,o;if(bm(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),i=wR(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,qV(a)}return t}nt.prototype.addListener=function(e,n){return AR(this,e,n,!1)};nt.prototype.on=nt.prototype.addListener;nt.prototype.prependListener=function(e,n){return AR(this,e,n,!0)};function QV(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function kR(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=QV.bind(r);return i.listener=n,r.wrapFn=i,i}nt.prototype.once=function(e,n){return bm(n),this.on(e,kR(this,e,n)),this};nt.prototype.prependOnceListener=function(e,n){return bm(n),this.prependListener(e,kR(this,e,n)),this};nt.prototype.removeListener=function(e,n){var r,i,s,o,a;if(bm(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():eW(r,s),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};nt.prototype.off=nt.prototype.removeListener;nt.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function ER(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?tW(i):_R(i,i.length)}nt.prototype.listeners=function(e){return ER(this,e,!0)};nt.prototype.rawListeners=function(e){return ER(this,e,!1)};nt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):TR.call(t,e)};nt.prototype.listenerCount=TR;function TR(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}nt.prototype.eventNames=function(){return this._eventsCount>0?_h(this._events):[]};function _R(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function eW(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function tW(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function nW(t,e){return new Promise(function(n,r){function i(o){t.removeListener(e,s),r(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}RR(t,e,s,{once:!0}),e!=="error"&&rW(t,i,{once:!0})})}function rW(t,e,n){typeof t.on=="function"&&RR(t,"error",e,n)}function RR(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){r.once&&t.removeEventListener(e,i),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var vs=gI.exports;let NR=!0,PR=!0;function Rh(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function uc(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(o,a){if(o!==e)return i.apply(this,arguments);const c=l=>{const u=n(l);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,c),i.apply(this,[o,c])};const s=r.removeEventListener;r.removeEventListener=function(o,a){if(o!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(a))return s.apply(this,arguments);const c=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[o,c])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function iW(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(NR=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function sW(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(PR=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function MR(){if(typeof window=="object"){if(NR)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function vI(t,e){PR&&console.warn(t+" is deprecated, please use "+e+" instead.")}function oW(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=Rh(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=Rh(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Rh(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function Gw(t){return Object.prototype.toString.call(t)==="[object Object]"}function xR(t){return Gw(t)?Object.keys(t).reduce(function(e,n){const r=Gw(t[n]),i=r?xR(t[n]):t[n],s=r&&!Object.keys(i).length;return i===void 0||s?e:Object.assign(e,{[n]:i})},{}):t}function Yy(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Yy(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{Yy(t,t.get(i),n)})}))}function Vw(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const s=[];return t.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&s.push(o)}),s.forEach(o=>{t.forEach(a=>{a.type===r&&a.trackId===o.id&&Yy(t,a,i)})}),i}const Ww=MR;function DR(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const c={};return Object.keys(a).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof a[l]=="object"?a[l]:{ideal:a[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(f,h){return f?f+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(u.ideal!==void 0){c.optional=c.optional||[];let f={};typeof u.ideal=="number"?(f[d("min",l)]=u.ideal,c.optional.push(f),f={},f[d("max",l)]=u.ideal,c.optional.push(f)):(f[d("",l)]=u.ideal,c.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[d("",l)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[d(f,l)]=u[f])})}),a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced)),c},i=function(a,c){if(e.version>=61)return c(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const l=function(u,d,f){d in u&&!(f in u)&&(u[f]=u[d],delete u[d])};a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","googAutoGainControl"),l(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let l=a.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let d;if(l.exact==="environment"||l.ideal==="environment"?d=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(p=>p.kind==="videoinput");let h=f.find(p=>d.some(g=>p.label.toLowerCase().includes(g)));return!h&&f.length&&d.includes("back")&&(h=f[f.length-1]),h&&(a.video.deviceId=l.exact?{exact:h.deviceId}:{ideal:h.deviceId}),a.video=r(a.video),Ww("chrome: "+JSON.stringify(a)),c(a)})}a.video=r(a.video)}return Ww("chrome: "+JSON.stringify(a)),c(a)},s=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(a,c,l){i(a,u=>{n.webkitGetUserMedia(u,c,d=>{l&&l(s(d))})})};if(n.getUserMedia=o.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return i(c,l=>a(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(s(u))))}}}function aW(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const s=r.video&&r.video.width,o=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},s&&(r.video.mandatory.maxWidth=s),o&&(r.video.mandatory.maxHeight=o),t.navigator.mediaDevices.getUserMedia(r)})}}}function OR(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function LR(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):s={track:i.track};const o=new Event("track");o.track=i.track,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(i=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.id):s={track:i};const o=new Event("track");o.track=i,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else uc(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function BR(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=i.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,c){let l=i.apply(this,arguments);return l||(l=e(this,a),this._senders.push(l)),l};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){s.apply(this,arguments);const c=this._senders.indexOf(a);c!==-1&&this._senders.splice(c,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],n.apply(this,[s]),s.getTracks().forEach(o=>{this._senders.push(e(this,o))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],r.apply(this,[s]),s.getTracks().forEach(o=>{const a=this._senders.find(c=>c.track===o);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function FR(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[r,i,s]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const o=function(c){const l={};return c.result().forEach(d=>{const f={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach(h=>{f[h]=d.stat(h)}),l[f.id]=f}),l},a=function(c){return new Map(Object.keys(c).map(l=>[l,c[l]]))};if(arguments.length>=2){const c=function(l){i(a(o(l)))};return e.apply(this,[c,r])}return new Promise((c,l)=>{e.apply(this,[function(u){c(a(o(u)))},l])}).then(i,s)}}function UR(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=n.apply(this,[]);return s.forEach(o=>o._pc=this),s});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(o=>Vw(o,s.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(s=>s._pc=this),i}),uc(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(s=>Vw(s,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,s,o;return this.getSenders().forEach(a=>{a.track===r&&(i?o=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(s?o=!0:s=a),a.track===r)),o||i&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function GR(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(c)===-1&&this._shimmedLocalStreams[a.id].push(c):this._shimmedLocalStreams[a.id]=[a,c],c};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(l=>{if(this.getSenders().find(d=>d.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(l=>a.indexOf(l)===-1);this._shimmedLocalStreams[o.id]=[o].concat(c)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const c=this._shimmedLocalStreams[a].indexOf(o);c!==-1&&this._shimmedLocalStreams[a].splice(c,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function VR(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return GR(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(d=>this._reverseStreams[d.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(d=>{if(this.getSenders().find(h=>h.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const d=new t.MediaStream(u.getTracks());this._streams[u.id]=d,this._reverseStreams[d.id]=u,u=d}r.apply(this,[u])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(g=>g===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(g=>g.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[d.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const g=new t.MediaStream([u]);this._streams[d.id]=g,this._reverseStreams[g.id]=d,this.addStream(g)}return this.getSenders().find(g=>g.track===u)};function s(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const h=l._reverseStreams[f],p=l._streams[h.id];d=d.replace(new RegExp(p.id,"g"),h.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function o(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const h=l._reverseStreams[f],p=l._streams[h.id];d=d.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],d={[l](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const g=s(this,p);f[0].apply(null,[g])},p=>{f[1]&&f[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>s(this,p))}};t.RTCPeerConnection.prototype[l]=d[l]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=o(this,arguments[0]),a.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:s(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(g=>u.track===g)&&(f=this._streams[h])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function qy(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function WR(t,e){uc(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var Hw=Object.freeze({__proto__:null,fixNegotiationNeeded:WR,shimAddTrackRemoveTrack:VR,shimAddTrackRemoveTrackWithNative:GR,shimGetDisplayMedia:aW,shimGetSendersWithDtmf:BR,shimGetStats:FR,shimGetUserMedia:DR,shimMediaStream:OR,shimOnTrack:LR,shimPeerConnection:qy,shimSenderReceiverGetStats:UR});function HR(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,s,o){vI("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(s,o)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(o,a,c){a in o&&!(c in o)&&(o[c]=o[a],delete o[a])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o.audio,"autoGainControl","mozAutoGainControl"),i(o.audio,"noiseSuppression","mozNoiseSuppression")),s(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const a=o.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[a])}}}}function cW(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function ZR(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Qy(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=t.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=o[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[s,o,a]=arguments;return r.apply(this,[s||null]).then(c=>{if(e.version<53&&!o)try{c.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((u,d)=>{c.set(d,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(o,a)}}function jR(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(s=>s._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function zR(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),uc(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function XR(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){vI("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function $R(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function KR(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(i){const{sender:o}=s,a=o.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(a).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return s})}function JR(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function YR(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function qR(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Zw=Object.freeze({__proto__:null,shimAddTransceiver:KR,shimCreateAnswer:qR,shimCreateOffer:YR,shimGetDisplayMedia:cW,shimGetParameters:JR,shimGetUserMedia:HR,shimOnTrack:ZR,shimPeerConnection:Qy,shimRTCDataChannel:$R,shimReceiverGetStats:zR,shimRemoveStream:XR,shimSenderGetStats:jR});function QR(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return s&&s.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(s=>{i.includes(s.track)&&this.removeTrack(s)})})}}function eN(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const s=new Event("addstream");s.stream=i,this.dispatchEvent(s)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(s=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(s)>=0)return;r._remoteStreams.push(s);const o=new Event("addstream");o.stream=s,r.dispatchEvent(o)})}),e.apply(r,arguments)}}}function tN(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,s=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[d]);return u?(f.then(l,u),Promise.resolve()):f},e.createAnswer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[d]);return u?(f.then(l,u),Promise.resolve()):f};let a=function(c,l,u){const d=i.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d};e.setLocalDescription=a,a=function(c,l,u){const d=s.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.setRemoteDescription=a,a=function(c,l,u){const d=o.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.addIceCandidate=a}function nN(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(rN(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,s){e.mediaDevices.getUserMedia(r).then(i,s)}).bind(e))}function rN(t){return t&&t.video!==void 0?Object.assign({},t,{video:xR(t.video)}):t}function iN(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const s=[];for(let o=0;o<r.iceServers.length;o++){let a=r.iceServers[o];a.urls===void 0&&a.url?(vI("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,s.push(a)):s.push(r.iceServers[o])}r.iceServers=s}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function sN(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function oN(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const s=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function aN(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var jw=Object.freeze({__proto__:null,shimAudioContext:aN,shimCallbacksAPI:tN,shimConstraints:rN,shimCreateOfferLegacy:oN,shimGetUserMedia:nN,shimLocalStreamsAPI:QR,shimRTCIceServerUrls:iN,shimRemoteStreamsAPI:eN,shimTrackEventTransceiver:sN}),cN={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((i,s)=>(s>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":i.relatedAddress=r[s+1];break;case"rport":i.relatedPort=parseInt(r[s+1],10);break;case"tcptype":i.tcpType=r[s+1];break;case"ufrag":i.ufrag=r[s+1],i.usernameFragment=r[s+1];break;default:i[r[s]]===void 0&&(i[r[s]]=r[s+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const s=n.type;return r.push("typ"),r.push(s),s!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const s=n.substring(n.indexOf(" ")+1).split(";");for(let o=0;o<s.length;o++)i=s[o].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const s=[];Object.keys(n.parameters).forEach(o=>{n.parameters[o]!==void 0?s.push(o+"="+n.parameters[o]):s.push(o)}),r+="a=fmtp:"+i+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+i+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},s=n.indexOf(":",r);return s>-1?(i.attribute=n.substring(r+1,s),i.value=n.substring(s+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(s=>{i+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],s=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(n)[0].split(" ");r.profile=s[2];for(let a=3;a<s.length;a++){const c=s[a],l=e.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(l){const u=e.parseRtpMap(l),d=e.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=d.length?e.parseFmtp(d[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const o=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{o.forEach(c=>{a.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||a.rtcpFeedback.push(c)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{i+=e.writeRtpMap(o),i+=e.writeFmtp(o),i+=e.writeRtcpFb(o)});let s=0;return r.codecs.forEach(o=>{o.maxptime>s&&(s=o.maxptime)}),s>0&&(i+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{i+=e.writeExtmap(o)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),s=i.fecMechanisms.indexOf("RED")!==-1,o=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(n,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),c=a.length>0&&a[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let h={ssrc:c,codecPayloadType:parseInt(f.parameters.apt,10)};c&&l&&(h.rtx={ssrc:l}),r.push(h),s&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},r.push(h))}}),r.length===0&&c&&r.push({ssrc:c});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(f=>{f.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const s=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const o=e.matchPrefix(n,"a=rtcp-mux");return r.mux=o.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let s;i.length>0&&(s=parseInt(i[0].substring(19),10)),isNaN(s)&&(s=65536);const o=e.matchPrefix(n,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const a=e.matchPrefix(n,"a=sctpmap:");if(a.length>0){const c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:s}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let s;const o=r!==void 0?r:2;return n?s=n:s=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+s+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let s=0;s<i.length;s++)switch(i[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const i=e.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(n){const i=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e})(cN);var lN=cN.exports,cl=uV(lN),lW=cV({__proto__:null,default:cl},[lN]);function Nh(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),s=cl.parseCandidate(r.candidate);for(const o in s)o in i||Object.defineProperty(i,o,{value:s[o]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,uc(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function e0(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||uc(t,"icecandidate",e=>{if(e.candidate){const n=cl.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Ph(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const c=cl.splitSections(a.sdp);return c.shift(),c.some(l=>{const u=cl.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(a){const c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},i=function(a){let c=65536;return e.browser==="firefox"&&(e.version<57?a===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},s=function(a,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=cl.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=r(arguments[0]),l=i(c),u=s(arguments[0],c);let d;l===0&&u===0?d=Number.POSITIVE_INFINITY:l===0||u===0?d=Math.max(l,u):d=Math.min(l,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return o.apply(this,arguments)}}function Mh(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const s=r.send;r.send=function(){const a=arguments[0],c=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&c>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},uc(t,"datachannel",r=>(e(r.channel,r.target),r))}function t0(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const s=i.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const o=new Event("connectionstatechange",i);s.dispatchEvent(o)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function n0(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=i.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:s}):i.sdp=s}return n.apply(this,arguments)}}function xh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Dh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>n.apply(this,[o]))})}var uW=Object.freeze({__proto__:null,removeExtmapAllowMixed:n0,shimAddIceCandidateNullOrEmpty:xh,shimConnectionState:t0,shimMaxMessageSize:Ph,shimParameterlessSetLocalDescription:Dh,shimRTCIceCandidate:Nh,shimRTCIceCandidateRelayProtocol:e0,shimSendThrowTypeError:Mh});function dW(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=MR,r=oW(t),i={browserDetails:r,commonShim:uW,extractVersion:Rh,disableLog:iW,disableWarnings:sW,sdp:lW};switch(r.browser){case"chrome":if(!Hw||!qy||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=Hw,xh(t,r),Dh(t),DR(t,r),OR(t),qy(t,r),LR(t),VR(t,r),BR(t),FR(t),UR(t),WR(t,r),Nh(t),e0(t),t0(t),Ph(t,r),Mh(t),n0(t,r);break;case"firefox":if(!Zw||!Qy||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=Zw,xh(t,r),Dh(t),HR(t,r),Qy(t,r),ZR(t),XR(t),jR(t),zR(t),$R(t),KR(t),JR(t),YR(t),qR(t),Nh(t),t0(t),Ph(t,r),Mh(t);break;case"safari":if(!jw||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=jw,xh(t,r),Dh(t),iN(t),oN(t),tN(t),QR(t),eN(t),sN(t),nN(t),aN(t),Nh(t),e0(t),Ph(t,r),Mh(t),n0(t,r);break;default:n("Unsupported browser!");break}return i}dW({window:typeof window>"u"?void 0:window});const fW=10,Xf="lk_e2ee",hW="LKFrameEncryptionKey",pW={sharedKey:!1,ratchetSalt:hW,ratchetWindowSize:8,failureTolerance:fW};var ta;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(ta||(ta={}));var zw;(function(t){t.KeyRatcheted="keyRatcheted"})(zw||(zw={}));var Ho;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Ho||(Ho={}));var Xw;(function(t){t.Error="cryptorError"})(Xw||(Xw={}));function mW(){return gW()||r0()}function r0(){return typeof window.RTCRtpScriptTransform<"u"}function gW(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class UQ extends vs.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{L.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},pW),e),this.on(ta.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(ta.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(ta.RatchetRequest,e,n)}}class tu extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}class Rt extends tu{constructor(e,n,r){super(1,e),this.status=r,this.reason=n}}class yI extends tu{constructor(e){super(21,e??"device is unsupported")}}class Bi extends tu{constructor(e){super(20,e??"track is invalid")}}class vW extends tu{constructor(e){super(10,e??"unsupported server")}}class Yt extends tu{constructor(e){super(12,e??"unexpected connection state")}}class i0 extends tu{constructor(e){super(13,e??"unable to negotiate")}}var xd;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(xd||(xd={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(xd||(xd={}));var ne;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.StateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged"})(ne||(ne={}));var oe;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded"})(oe||(oe={}));var ge;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished"})(ge||(ge={}));var fe;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed"})(fe||(fe={}));function CI(t,e,n){var r,i,s;e===void 0&&(e=50),n===void 0&&(n={});var o=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,c=n.maxWait,l=Date.now(),u=[];function d(){if(c!==void 0){var h=Date.now()-l;if(h+e>=c)return c-h}return e}var f=function(){var h=[].slice.call(arguments),p=this;return new Promise(function(g,y){var m=o&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,l=Date.now(),!o){var S=t.apply(p,h);a&&a(S),u.forEach(function(E){return(0,E.resolve)(S)}),u=[]}},d()),m){var v=t.apply(p,h);return a&&a(v),g(v)}u.push({resolve:g,reject:y})})};return f.cancel=function(h){s!==void 0&&clearTimeout(s),u.forEach(function(p){return(0,p.reject)(h)}),u=[]},f}const yW=/version\/(\d+(\.?_?\d+)+)/i;let Kg;function ca(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof t>"u"&&typeof navigator>"u")return;const n=(t??navigator.userAgent).toLowerCase();if(Kg===void 0||e){const r=CW.find(i=>{let{test:s}=i;return s.test(n)});Kg=r==null?void 0:r.describe(n)}return Kg}const CW=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Jg(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Jg(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Jg(yW,t),os:t.includes("mobile/")?"iOS":"macOS"}}}];function Jg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}var IW="1.15.5";const SW=IW,bW=11;class kn{}kn.setTimeout=function(){return setTimeout(...arguments)};kn.setInterval=function(){return setInterval(...arguments)};kn.clearTimeout=function(){return clearTimeout(...arguments)};kn.clearInterval=function(){return clearInterval(...arguments)};class pt{constructor(e,n,r,i,s){this.width=e,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i,priority:s}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const wW=["vp8","h264"],uN=["vp8","h264","vp9","av1"];function AW(t){return!!wW.find(e=>e===t)}var Ep;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:2e4},t.music={maxBitrate:32e3},t.musicStereo={maxBitrate:48e3},t.musicHighQuality={maxBitrate:64e3},t.musicHighQualityStereo={maxBitrate:96e3}})(Ep||(Ep={}));const Dd={h90:new pt(160,90,9e4,20),h180:new pt(320,180,16e4,20),h216:new pt(384,216,18e4,20),h360:new pt(640,360,45e4,20),h540:new pt(960,540,8e5,25),h720:new pt(1280,720,17e5,30),h1080:new pt(1920,1080,3e6,30),h1440:new pt(2560,1440,5e6,30),h2160:new pt(3840,2160,8e6,30)},s0={h120:new pt(160,120,7e4,20),h180:new pt(240,180,125e3,20),h240:new pt(320,240,14e4,20),h360:new pt(480,360,33e4,20),h480:new pt(640,480,5e5,20),h540:new pt(720,540,6e5,25),h720:new pt(960,720,13e5,30),h1080:new pt(1440,1080,23e5,30),h1440:new pt(1920,1440,38e5,30)},dN={h360fps3:new pt(640,360,2e5,3,"medium"),h720fps5:new pt(1280,720,4e5,5,"medium"),h720fps15:new pt(1280,720,15e5,15,"medium"),h720fps30:new pt(1280,720,2e6,30,"medium"),h1080fps15:new pt(1920,1080,25e5,15,"medium"),h1080fps30:new pt(1920,1080,4e6,30,"medium")};var Bn;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER"})(Bn||(Bn={}));R.util.setEnumType(Bn,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var Ya;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.PAUSED=1]="PAUSED"})(Ya||(Ya={}));R.util.setEnumType(Ya,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var Tp;(function(t){t[t.UDP=0]="UDP",t[t.TCP=1]="TCP",t[t.TLS=2]="TLS"})(Tp||(Tp={}));R.util.setEnumType(Tp,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class Ls extends pe{constructor(e){super(),this.message={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new Ls().fromBinary(e,n)}static fromJson(e,n){return new Ls().fromJson(e,n)}static fromJsonString(e,n){return new Ls().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ls,e,n)}}Ls.runtime=R;Ls.typeName="livekit.SignalRequest";Ls.fields=R.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:tr,oneof:"message"},{no:2,name:"answer",kind:"message",T:tr,oneof:"message"},{no:3,name:"trickle",kind:"message",T:gi,oneof:"message"},{no:4,name:"add_track",kind:"message",T:mi,oneof:"message"},{no:5,name:"mute",kind:"message",T:vi,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Vr,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:Ji,oneof:"message"},{no:8,name:"leave",kind:"message",T:Wr,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Yi,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:ts,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:ns,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Jn,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:qi,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:is,oneof:"message"}]);class Ki extends pe{constructor(e){super(),this.message={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new Ki().fromBinary(e,n)}static fromJson(e,n){return new Ki().fromJson(e,n)}static fromJsonString(e,n){return new Ki().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ki,e,n)}}Ki.runtime=R;Ki.typeName="livekit.SignalResponse";Ki.fields=R.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:Bs,oneof:"message"},{no:2,name:"answer",kind:"message",T:tr,oneof:"message"},{no:3,name:"offer",kind:"message",T:tr,oneof:"message"},{no:4,name:"trickle",kind:"message",T:gi,oneof:"message"},{no:5,name:"update",kind:"message",T:Gs,oneof:"message"},{no:6,name:"track_published",kind:"message",T:yi,oneof:"message"},{no:8,name:"leave",kind:"message",T:Wr,oneof:"message"},{no:9,name:"mute",kind:"message",T:vi,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Vs,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Ws,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:Zs,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:zs,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:$s,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Ks,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:Us,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:Fs,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Js,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:qs,oneof:"message"}]);class pi extends pe{constructor(e){super(),this.codec="",this.cid="",R.util.initPartial(e,this)}static fromBinary(e,n){return new pi().fromBinary(e,n)}static fromJson(e,n){return new pi().fromJson(e,n)}static fromJsonString(e,n){return new pi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(pi,e,n)}}pi.runtime=R;pi.typeName="livekit.SimulcastCodec";pi.fields=R.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class mi extends pe{constructor(e){super(),this.cid="",this.name="",this.type=Ln.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=Wt.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=An.NONE,this.stream="",R.util.initPartial(e,this)}static fromBinary(e,n){return new mi().fromBinary(e,n)}static fromJson(e,n){return new mi().fromJson(e,n)}static fromJsonString(e,n){return new mi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(mi,e,n)}}mi.runtime=R;mi.typeName="livekit.AddTrackRequest";mi.fields=R.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:R.getEnumType(Ln)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:R.getEnumType(Wt)},{no:9,name:"layers",kind:"message",T:er,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:pi,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:R.getEnumType(An)},{no:15,name:"stream",kind:"scalar",T:9}]);class gi extends pe{constructor(e){super(),this.candidateInit="",this.target=Bn.PUBLISHER,R.util.initPartial(e,this)}static fromBinary(e,n){return new gi().fromBinary(e,n)}static fromJson(e,n){return new gi().fromJson(e,n)}static fromJsonString(e,n){return new gi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(gi,e,n)}}gi.runtime=R;gi.typeName="livekit.TrickleRequest";gi.fields=R.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:R.getEnumType(Bn)}]);class vi extends pe{constructor(e){super(),this.sid="",this.muted=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new vi().fromBinary(e,n)}static fromJson(e,n){return new vi().fromJson(e,n)}static fromJsonString(e,n){return new vi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(vi,e,n)}}vi.runtime=R;vi.typeName="livekit.MuteTrackRequest";vi.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class Bs extends pe{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),R.util.initPartial(e,this)}static fromBinary(e,n){return new Bs().fromBinary(e,n)}static fromJson(e,n){return new Bs().fromJson(e,n)}static fromJsonString(e,n){return new Bs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Bs,e,n)}}Bs.runtime=R;Bs.typeName="livekit.JoinResponse";Bs.fields=R.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:eu},{no:2,name:"participant",kind:"message",T:Er},{no:3,name:"other_participants",kind:"message",T:Er,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Qi,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:zi},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:xs},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class Fs extends pe{constructor(e){super(),this.iceServers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Fs().fromBinary(e,n)}static fromJson(e,n){return new Fs().fromJson(e,n)}static fromJsonString(e,n){return new Fs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Fs,e,n)}}Fs.runtime=R;Fs.typeName="livekit.ReconnectResponse";Fs.fields=R.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:Qi,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:zi}]);class yi extends pe{constructor(e){super(),this.cid="",R.util.initPartial(e,this)}static fromBinary(e,n){return new yi().fromBinary(e,n)}static fromJson(e,n){return new yi().fromJson(e,n)}static fromJsonString(e,n){return new yi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(yi,e,n)}}yi.runtime=R;yi.typeName="livekit.TrackPublishedResponse";yi.fields=R.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:ur}]);class Us extends pe{constructor(e){super(),this.trackSid="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Us().fromBinary(e,n)}static fromJson(e,n){return new Us().fromJson(e,n)}static fromJsonString(e,n){return new Us().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Us,e,n)}}Us.runtime=R;Us.typeName="livekit.TrackUnpublishedResponse";Us.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class tr extends pe{constructor(e){super(),this.type="",this.sdp="",R.util.initPartial(e,this)}static fromBinary(e,n){return new tr().fromBinary(e,n)}static fromJson(e,n){return new tr().fromJson(e,n)}static fromJsonString(e,n){return new tr().fromJsonString(e,n)}static equals(e,n){return R.util.equals(tr,e,n)}}tr.runtime=R;tr.typeName="livekit.SessionDescription";tr.fields=R.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class Gs extends pe{constructor(e){super(),this.participants=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Gs().fromBinary(e,n)}static fromJson(e,n){return new Gs().fromJson(e,n)}static fromJsonString(e,n){return new Gs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Gs,e,n)}}Gs.runtime=R;Gs.typeName="livekit.ParticipantUpdate";Gs.fields=R.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:Er,repeated:!0}]);class Vr extends pe{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Vr().fromBinary(e,n)}static fromJson(e,n){return new Vr().fromJson(e,n)}static fromJsonString(e,n){return new Vr().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Vr,e,n)}}Vr.runtime=R;Vr.typeName="livekit.UpdateSubscription";Vr.fields=R.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:ji,repeated:!0}]);class Ji extends pe{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=sn.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new Ji().fromBinary(e,n)}static fromJson(e,n){return new Ji().fromJson(e,n)}static fromJsonString(e,n){return new Ji().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ji,e,n)}}Ji.runtime=R;Ji.typeName="livekit.UpdateTrackSettings";Ji.fields=R.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:R.getEnumType(sn)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class Wr extends pe{constructor(e){super(),this.canReconnect=!1,this.reason=to.UNKNOWN_REASON,R.util.initPartial(e,this)}static fromBinary(e,n){return new Wr().fromBinary(e,n)}static fromJson(e,n){return new Wr().fromJson(e,n)}static fromJsonString(e,n){return new Wr().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Wr,e,n)}}Wr.runtime=R;Wr.typeName="livekit.LeaveRequest";Wr.fields=R.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:R.getEnumType(to)}]);class Yi extends pe{constructor(e){super(),this.trackSid="",this.layers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Yi().fromBinary(e,n)}static fromJson(e,n){return new Yi().fromJson(e,n)}static fromJsonString(e,n){return new Yi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Yi,e,n)}}Yi.runtime=R;Yi.typeName="livekit.UpdateVideoLayers";Yi.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:er,repeated:!0}]);class qi extends pe{constructor(e){super(),this.metadata="",this.name="",R.util.initPartial(e,this)}static fromBinary(e,n){return new qi().fromBinary(e,n)}static fromJson(e,n){return new qi().fromJson(e,n)}static fromJsonString(e,n){return new qi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(qi,e,n)}}qi.runtime=R;qi.typeName="livekit.UpdateParticipantMetadata";qi.fields=R.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class Qi extends pe{constructor(e){super(),this.urls=[],this.username="",this.credential="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Qi().fromBinary(e,n)}static fromJson(e,n){return new Qi().fromJson(e,n)}static fromJsonString(e,n){return new Qi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Qi,e,n)}}Qi.runtime=R;Qi.typeName="livekit.ICEServer";Qi.fields=R.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class Vs extends pe{constructor(e){super(),this.speakers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Vs().fromBinary(e,n)}static fromJson(e,n){return new Vs().fromJson(e,n)}static fromJsonString(e,n){return new Vs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Vs,e,n)}}Vs.runtime=R;Vs.typeName="livekit.SpeakersChanged";Vs.fields=R.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Hi,repeated:!0}]);class Ws extends pe{constructor(e){super(),R.util.initPartial(e,this)}static fromBinary(e,n){return new Ws().fromBinary(e,n)}static fromJson(e,n){return new Ws().fromJson(e,n)}static fromJsonString(e,n){return new Ws().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ws,e,n)}}Ws.runtime=R;Ws.typeName="livekit.RoomUpdate";Ws.fields=R.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:eu}]);class Hs extends pe{constructor(e){super(),this.participantSid="",this.quality=Rs.POOR,this.score=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new Hs().fromBinary(e,n)}static fromJson(e,n){return new Hs().fromJson(e,n)}static fromJsonString(e,n){return new Hs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Hs,e,n)}}Hs.runtime=R;Hs.typeName="livekit.ConnectionQualityInfo";Hs.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:R.getEnumType(Rs)},{no:3,name:"score",kind:"scalar",T:2}]);class Zs extends pe{constructor(e){super(),this.updates=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Zs().fromBinary(e,n)}static fromJson(e,n){return new Zs().fromJson(e,n)}static fromJsonString(e,n){return new Zs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Zs,e,n)}}Zs.runtime=R;Zs.typeName="livekit.ConnectionQualityUpdate";Zs.fields=R.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:Hs,repeated:!0}]);class js extends pe{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=Ya.ACTIVE,R.util.initPartial(e,this)}static fromBinary(e,n){return new js().fromBinary(e,n)}static fromJson(e,n){return new js().fromJson(e,n)}static fromJsonString(e,n){return new js().fromJsonString(e,n)}static equals(e,n){return R.util.equals(js,e,n)}}js.runtime=R;js.typeName="livekit.StreamStateInfo";js.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:R.getEnumType(Ya)}]);class zs extends pe{constructor(e){super(),this.streamStates=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new zs().fromBinary(e,n)}static fromJson(e,n){return new zs().fromJson(e,n)}static fromJsonString(e,n){return new zs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(zs,e,n)}}zs.runtime=R;zs.typeName="livekit.StreamStateUpdate";zs.fields=R.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:js,repeated:!0}]);class Ci extends pe{constructor(e){super(),this.quality=sn.LOW,this.enabled=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Ci().fromBinary(e,n)}static fromJson(e,n){return new Ci().fromJson(e,n)}static fromJsonString(e,n){return new Ci().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ci,e,n)}}Ci.runtime=R;Ci.typeName="livekit.SubscribedQuality";Ci.fields=R.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:R.getEnumType(sn)},{no:2,name:"enabled",kind:"scalar",T:8}]);class Xs extends pe{constructor(e){super(),this.codec="",this.qualities=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Xs().fromBinary(e,n)}static fromJson(e,n){return new Xs().fromJson(e,n)}static fromJsonString(e,n){return new Xs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Xs,e,n)}}Xs.runtime=R;Xs.typeName="livekit.SubscribedCodec";Xs.fields=R.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Ci,repeated:!0}]);class $s extends pe{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new $s().fromBinary(e,n)}static fromJson(e,n){return new $s().fromJson(e,n)}static fromJsonString(e,n){return new $s().fromJsonString(e,n)}static equals(e,n){return R.util.equals($s,e,n)}}$s.runtime=R;$s.typeName="livekit.SubscribedQualityUpdate";$s.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Ci,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:Xs,repeated:!0}]);class es extends pe{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",R.util.initPartial(e,this)}static fromBinary(e,n){return new es().fromBinary(e,n)}static fromJson(e,n){return new es().fromJson(e,n)}static fromJsonString(e,n){return new es().fromJsonString(e,n)}static equals(e,n){return R.util.equals(es,e,n)}}es.runtime=R;es.typeName="livekit.TrackPermission";es.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class ts extends pe{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new ts().fromBinary(e,n)}static fromJson(e,n){return new ts().fromJson(e,n)}static fromJsonString(e,n){return new ts().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ts,e,n)}}ts.runtime=R;ts.typeName="livekit.SubscriptionPermission";ts.fields=R.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:es,repeated:!0}]);class Ks extends pe{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Ks().fromBinary(e,n)}static fromJson(e,n){return new Ks().fromJson(e,n)}static fromJsonString(e,n){return new Ks().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ks,e,n)}}Ks.runtime=R;Ks.typeName="livekit.SubscriptionPermissionUpdate";Ks.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class ns extends pe{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new ns().fromBinary(e,n)}static fromJson(e,n){return new ns().fromJson(e,n)}static fromJsonString(e,n){return new ns().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ns,e,n)}}ns.runtime=R;ns.typeName="livekit.SyncState";ns.fields=R.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:tr},{no:2,name:"subscription",kind:"message",T:Vr},{no:3,name:"publish_tracks",kind:"message",T:yi,repeated:!0},{no:4,name:"data_channels",kind:"message",T:rs,repeated:!0},{no:5,name:"offer",kind:"message",T:tr}]);class rs extends pe{constructor(e){super(),this.label="",this.id=0,this.target=Bn.PUBLISHER,R.util.initPartial(e,this)}static fromBinary(e,n){return new rs().fromBinary(e,n)}static fromJson(e,n){return new rs().fromJson(e,n)}static fromJsonString(e,n){return new rs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(rs,e,n)}}rs.runtime=R;rs.typeName="livekit.DataChannelInfo";rs.fields=R.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:R.getEnumType(Bn)}]);class Jn extends pe{constructor(e){super(),this.scenario={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new Jn().fromBinary(e,n)}static fromJson(e,n){return new Jn().fromJson(e,n)}static fromJsonString(e,n){return new Jn().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Jn,e,n)}}Jn.runtime=R;Jn.typeName="livekit.SimulateScenario";Jn.fields=R.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:R.getEnumType(Tp),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"}]);class is extends pe{constructor(e){super(),this.timestamp=xe.zero,this.rtt=xe.zero,R.util.initPartial(e,this)}static fromBinary(e,n){return new is().fromBinary(e,n)}static fromJson(e,n){return new is().fromJson(e,n)}static fromJsonString(e,n){return new is().fromJsonString(e,n)}static equals(e,n){return R.util.equals(is,e,n)}}is.runtime=R;is.typeName="livekit.Ping";is.fields=R.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class Js extends pe{constructor(e){super(),this.lastPingTimestamp=xe.zero,this.timestamp=xe.zero,R.util.initPartial(e,this)}static fromBinary(e,n){return new Js().fromBinary(e,n)}static fromJson(e,n){return new Js().fromJson(e,n)}static fromJsonString(e,n){return new Js().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Js,e,n)}}Js.runtime=R;Js.typeName="livekit.Pong";Js.fields=R.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class Zo extends pe{constructor(e){super(),this.regions=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Zo().fromBinary(e,n)}static fromJson(e,n){return new Zo().fromJson(e,n)}static fromJsonString(e,n){return new Zo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Zo,e,n)}}Zo.runtime=R;Zo.typeName="livekit.RegionSettings";Zo.fields=R.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:Ys,repeated:!0}]);class Ys extends pe{constructor(e){super(),this.region="",this.url="",this.distance=xe.zero,R.util.initPartial(e,this)}static fromBinary(e,n){return new Ys().fromBinary(e,n)}static fromJson(e,n){return new Ys().fromJson(e,n)}static fromJsonString(e,n){return new Ys().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ys,e,n)}}Ys.runtime=R;Ys.typeName="livekit.RegionInfo";Ys.fields=R.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class qs extends pe{constructor(e){super(),this.trackSid="",this.err=Md.SE_UNKNOWN,R.util.initPartial(e,this)}static fromBinary(e,n){return new qs().fromBinary(e,n)}static fromJson(e,n){return new qs().fromJson(e,n)}static fromJsonString(e,n){return new qs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(qs,e,n)}}qs.runtime=R;qs.typeName="livekit.SubscriptionResponse";qs.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:R.getEnumType(Md)}]);function kW(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const EW=5e3,ku=[];class Y extends vs.EventEmitter{constructor(e,n){super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Y.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),EW):this.handleAppVisibilityChanged()},this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Y.Source.Unknown}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===Y.Kind.Video&&(n="video"),this.attachedElements.length===0&&Y.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(ku.forEach(s=>{s.parentElement===null&&!e&&(e=s)}),e&&ku.splice(ku.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),Zc(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(s=>s.kind==="audio");return e.play().then(()=>{this.emit(i?fe.AudioPlaybackStarted:fe.VideoPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(i?fe.AudioPlaybackFailed:fe.VideoPlaybackFailed,s):s.name==="AbortError"?L.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):L.warn("could not playback ".concat(i?"audio":"video"),s),i&&e&&r.some(o=>o.kind==="video")&&s.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(fe.ElementAttached,e),e}detach(e){try{if(e){ll(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(fe.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{ll(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(fe.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),ku.forEach(r=>{r.parentElement||(n=!1)}),n&&ku.push(e)}}handleAppVisibilityChanged(){return U(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){pr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){pr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Zc(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!qa()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(qa()||xl())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function ll(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(l){l.Audio="audio",l.Video="video",l.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(l){l.Camera="camera",l.Microphone="microphone",l.ScreenShare="screen_share",l.ScreenShareAudio="screen_share_audio",l.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(l){l.Active="active",l.Paused="paused",l.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(l){switch(l){case e.Audio:return Ln.AUDIO;case e.Video:return Ln.VIDEO;default:return Ln.DATA}}t.kindToProto=i;function s(l){switch(l){case Ln.AUDIO:return e.Audio;case Ln.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=s;function o(l){switch(l){case n.Camera:return Wt.CAMERA;case n.Microphone:return Wt.MICROPHONE;case n.ScreenShare:return Wt.SCREEN_SHARE;case n.ScreenShareAudio:return Wt.SCREEN_SHARE_AUDIO;default:return Wt.UNKNOWN}}t.sourceToProto=o;function a(l){switch(l){case Wt.CAMERA:return n.Camera;case Wt.MICROPHONE:return n.Microphone;case Wt.SCREEN_SHARE:return n.ScreenShare;case Wt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=a;function c(l){switch(l){case Ya.ACTIVE:return r.Active;case Ya.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=c})(Y||(Y={}));function fN(t,e,n){var r;const i=(r=kW(t))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&o0(i.audio,e),i.video&&o0(i.video,n),i}function o0(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function wm(t){const e={};if(t.video)if(typeof t.video=="object"){const n={},r=n,i=t.video;Object.keys(i).forEach(s=>{switch(s){case"resolution":o0(r,i.resolution);break;default:r[s]=i[s]}}),e.video=n}else e.video=t.video;else e.video=!1;return t.audio?typeof t.audio=="object"?e.audio=t.audio:e.audio=!0:e.audio=!1,e}function TW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return U(this,void 0,void 0,function*(){const n=II();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,s=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(r),yield no(e),r.getByteTimeDomainData(s);const a=s.some(c=>c!==128&&c!==0);return n.close(),!a}return!1})}function II(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function _W(t){return t===Y.Source.Microphone?"audioinput":t===Y.Source.Camera?"videoinput":void 0}function RW(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&(r=typeof r=="boolean"?{}:r,qa()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio}}function hN(t){const e=t.split("/")[1].toLowerCase();if(!uN.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function NW(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new yi({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}const PW="|",$w="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function MW(t){const e=t.split(PW);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function no(t){return U(this,void 0,void 0,function*(){return new Promise(e=>kn.setTimeout(e,t))})}function Kw(){return"addTransceiver"in RTCPeerConnection.prototype}function Jw(){return"addTrack"in RTCPeerConnection.prototype}function xW(){if(!("getCapabilities"in RTCRtpSender)||qa())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function DW(){if(!("getCapabilities"in RTCRtpSender)||xl())return!1;if(qa()){const n=ca();if(n!=null&&n.version&&SI(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function Qu(t){return t==="av1"||t==="vp9"}function a0(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}const OW={Chrome:"100",Safari:"15",Firefox:"100"};function LW(t){if(!pr()||!("setCodecPreferences"in t))return!1;const e=ca();if(!(e!=null&&e.name)||!e.version)return!1;const n=OW[e.name];return n?SI(e.version,n)>=0:!1}function xl(){var t;return((t=ca())===null||t===void 0?void 0:t.name)==="Firefox"}function BW(){var t;return((t=ca())===null||t===void 0?void 0:t.name)==="Chrome"}function qa(){var t;return((t=ca())===null||t===void 0?void 0:t.name)==="Safari"}function pN(){return pr()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function pr(){return typeof document<"u"}function Qa(){return navigator.product=="ReactNative"}function c0(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function mN(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function gN(){if(!Qa())return;let t=mN();if(t)return t.platform}function Yw(){if(pr())return window.devicePixelRatio;if(Qa()){let t=mN();if(t)return t.devicePixelRatio}return 1}function SI(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let s=0;s<i;++s){const o=parseInt(n[s],10),a=parseInt(r[s],10);if(o>a)return 1;if(o<a)return-1;if(s===i-1&&o===a)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function FW(t){for(const e of t)e.target.handleResize(e)}function UW(t){for(const e of t)e.target.handleVisibilityChanged(e)}let Yg=null;const qw=()=>(Yg||(Yg=new ResizeObserver(FW)),Yg);let qg=null;const Qw=()=>(qg||(qg=new IntersectionObserver(UW,{root:null,rootMargin:"0px"})),qg);function GW(){var t;const e=new Ds({sdk:Ml.JS,protocol:bW,version:SW});return Qa()&&(e.os=(t=gN())!==null&&t!==void 0?t:""),e}function eA(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const s=i.getContext("2d");s==null||s.fillRect(0,0,i.width,i.height),r&&s&&(s.beginPath(),s.arc(t/2,e/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const o=i.captureStream(),[a]=o.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let Eu;function Qg(){if(!Eu){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[Eu]=r.stream.getAudioTracks(),!Eu)throw Error("Could not get empty media stream audio track");Eu.enabled=!1}return Eu.clone()}class vN{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>U(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function VW(t,e){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=II();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?t.mediaStreamTrack.clone():t.mediaStreamTrack,s=r.createMediaStreamSource(new MediaStream([i])),o=r.createAnalyser();o.minDecibels=n.minDecibels,o.maxDecibels=n.maxDecibels,o.fftSize=n.fftSize,o.smoothingTimeConstant=n.smoothingTimeConstant,s.connect(o);const a=new Uint8Array(o.frequencyBinCount);return{calculateVolume:()=>{o.getByteFrequencyData(a);let u=0;for(const f of a)u+=Math.pow(f/255,2);return Math.sqrt(u/a.length)},analyser:o,cleanup:()=>U(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&i.stop()})}}class bi{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function WW(t){return uN.includes(t)}function Ga(t){if(typeof t=="string")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function HW(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function tA(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}const nA="default";class Yn{static getInstance(){return this.instance===void 0&&(this.instance=new Yn),this.instance}getDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return U(this,void 0,void 0,function*(){if(((r=Yn.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){L.debug("awaiting getUserMedia promise");try{e?yield Yn.userMediaPromiseMap.get(e):yield Promise.all(Yn.userMediaPromiseMap.values())}catch{L.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(n&&!(qa()&&this.hasDeviceInUse(e))&&(i.length===0||i.some(o=>{const a=o.label==="",c=e?o.kind===e:!0;return a&&c}))){const o={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(o);i=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(c=>{c.stop()})}return e&&(i=i.filter(s=>s.kind===e)),i})}normalizeDeviceId(e,n,r){return U(this,void 0,void 0,function*(){if(n!==nA)return n;const s=(yield this.getDevices(e)).find(o=>o.groupId===r&&o.deviceId!==nA);return s==null?void 0:s.deviceId})}hasDeviceInUse(e){return e?Yn.userMediaPromiseMap.has(e):Yn.userMediaPromiseMap.size>0}}Yn.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Yn.userMediaPromiseMap=new Map;const ZW=1e3;class Dl extends Y{get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;super(e,n),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>L.debug("track mute bounce got cancelled by an unmute event")),this.debouncedTrackMuteHandler=CI(()=>U(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>U(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(fe.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new bi,this.pauseUpstreamLock=new bi,this.processorLock=new bi,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Y.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(e,n){return U(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{ll(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop()),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e&&this.processorElement){if(L.debug("restarting processor"),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");Zc(e,this.processorElement),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??e)),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{Zc(r??e,i)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ZW;var n;return U(this,void 0,void 0,function*(){if(this.kind===Y.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=ca())===null||n===void 0?void 0:n.os)==="iOS"&&(yield no(10));const r=Date.now();for(;Date.now()-r<e;){const i=this.dimensions;if(i)return i;yield no(50)}throw new Bi("unable to get track dimensions after timeout")})}getDeviceId(){return U(this,void 0,void 0,function*(){if(this.source===Y.Source.ScreenShare)return;const{deviceId:e,groupId:n}=this._mediaStreamTrack.getSettings(),r=this.kind===Y.Kind.Audio?"audioinput":"videoinput";return Yn.getInstance().normalizeDeviceId(r,e,n)})}mute(){return U(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return U(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return U(this,void 0,void 0,function*(){if(!this.sender)throw new Bi("unable to replace an unpublished track");return L.debug("replace MediaStreamTrack"),yield this.setMediaStreamTrack(e),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(e){return U(this,void 0,void 0,function*(){e||(e=this._constraints),L.debug("restarting track with constraints",e);const n={audio:!1,video:!1};this.kind===Y.Kind.Video?n.video=e:n.audio=e,this.attachedElements.forEach(s=>{ll(this.mediaStreamTrack,s)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),L.debug("re-acquired MediaStreamTrack"),yield this.setMediaStreamTrack(i),this._constraints=e,this.emit(fe.Restarted,this),this})}setTrackMuted(e){L.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted")),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?fe.Muted:fe.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return U(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),pN()&&(L.debug("visibility changed, is in Background: ".concat(this.isInBackground)),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(L.debug("track needs to be reacquired, restarting ".concat(this.source)),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return U(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){L.warn("unable to pause upstream for an unpublished track");return}this._isUpstreamPaused=!0,this.emit(fe.UpstreamPaused,this);const n=ca();if((n==null?void 0:n.name)==="Safari"&&SI(n.version,"12.0")<0)throw new yI("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return U(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){L.warn("unable to resume upstream for an unpublished track");return}this._isUpstreamPaused=!1,this.emit(fe.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return U(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return U(this,void 0,void 0,function*(){const s=yield this.processorLock.lock();try{if(L.debug("setting up processor"),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),this.processorElement.muted=!0,Zc(this._mediaStreamTrack,this.processorElement),this.processorElement.play().catch(a=>L.error("failed to play processor element",{error:a}));const o={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(o),this.processor=e,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&n&&(ll(this._mediaStreamTrack,a),Zc(this.processor.processedTrack,a));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{s()}})}getProcessor(){return this.processor}stopProcessor(){var e,n;return U(this,void 0,void 0,function*(){this.processor&&(L.debug("stopping processor"),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class jW extends vs.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:s,data:o}=n.data;switch(s){case"error":L.error(o.error.message),this.emit(Ho.EncryptionError,o.error);break;case"initAck":o.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==o.enabled&&o.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Ho.ParticipantEncryptionStatusChanged,o.enabled,this.room.localParticipant),this.encryptionEnabled=o.enabled;else if(o.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(o.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(o.participantIdentity));this.emit(Ho.ParticipantEncryptionStatusChanged,o.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(ta.KeyRatcheted,o.material,o.keyIndex);break}},this.onWorkerError=n=>{L.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Ho.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!mW())throw new yI("tried to setup end-to-end encryption on an unsupported browser");if(L.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(L.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){L.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?L.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(ge.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(ne.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==An.NONE,i.identity)),e.on(ne.ConnectionStateChanged,r=>{r===Ke.Connected&&e.participants.forEach(i=>{i.tracks.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==An.NONE,i.identity)})})}).on(ne.TrackUnsubscribed,(r,i,s)=>{var o;const a={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:r.mediaStreamID}};(o=this.worker)===null||o===void 0||o.postMessage(a)}).on(ne.TrackSubscribed,(r,i,s)=>{this.setupE2EEReceiver(r,s.identity,i.trackInfo)}).on(ne.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(r=>{this.postKey(r)})}),e.localParticipant.on(oe.LocalTrackPublished,r=>U(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(ta.SetKey,r=>this.postKey(r)).on(ta.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var s;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(o)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?hN(r.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof Dl)||!n){n||L.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return U(this,void 0,void 0,function*(){if(this.worker){if(r0()){const s={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(Xf in e&&i){const c={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(c);return}let s=e.writableStream,o=e.readableStream;if(!s||!o){const c=e.createEncodedStreams();e.writableStream=c.writable,s=c.writable,e.readableStream=c.readable,o=c.readable}const a={kind:"decode",data:{readableStream:o,writableStream:s,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[o,s])}e[Xf]=!0}})}handleSender(e,n,r){var i;if(!(Xf in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(r0()){L.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{L.info("initialize encoded streams");const s=e.createEncodedStreams(),o={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o,[s.readable,s.writable])}e[Xf]=!0}}}var ed;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(ed||(ed={}));class zW{constructor(){this.pendingTasks=new Map,this.taskMutex=new bi,this.nextTaskIndex=0}run(e){return U(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:ed.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=ed.RUNNING,yield e()}finally{n.status=ed.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return U(this,void 0,void 0,function*(){return this.run(()=>U(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const XW=["syncState","trickle","offer","answer","simulate","leave"];function $W(t){const e=XW.indexOf(t.case)>=0;return L.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var dn;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(dn||(dn={}));class bI{get currentState(){return this.state}get isDisconnected(){return this.state===dn.DISCONNECTING||this.state===dn.DISCONNECTED}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.rtt=0,this.state=dn.DISCONNECTED,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.useJSON=e,this.requestQueue=new zW,this.queuedRequests=[],this.closingLock=new bi,this.connectionLock=new bi,this.state=dn.DISCONNECTED}join(e,n,r,i){return U(this,void 0,void 0,function*(){return this.state=dn.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return U(this,void 0,void 0,function*(){if(!this.options){L.warn("attempted to reconnect without signal options being set, ignoring");return}return this.state=dn.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r,e=HW(e),e=e.replace(/\/$/,""),e+="/rtc";const s=GW(),o=KW(n,s,r);return new Promise((a,c)=>U(this,void 0,void 0,function*(){const l=yield this.connectionLock.lock();try{const u=()=>U(this,void 0,void 0,function*(){this.close(),clearTimeout(d),c(new Rt("room connection has been cancelled (signal)"))}),d=setTimeout(()=>{this.close(),c(new Rt("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&u(),i==null||i.addEventListener("abort",u),L.debug("connecting to ".concat(e+o)),this.ws&&(yield this.close()),this.ws=new WebSocket(e+o),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=f=>U(this,void 0,void 0,function*(){if(this.state!==dn.CONNECTED){clearTimeout(d);try{const h=yield fetch("http".concat(e.substring(2),"/validate").concat(o));if(h.status.toFixed(0).startsWith("4")){const p=yield h.text();c(new Rt(p,0,h.status))}else c(new Rt("Internal error",2,h.status))}catch{c(new Rt("server was not reachable",1))}return}this.handleWSError(f)}),this.ws.onmessage=f=>U(this,void 0,void 0,function*(){var h,p,g,y;let m;if(typeof f.data=="string"){const v=JSON.parse(f.data);m=Ki.fromJson(v)}else if(f.data instanceof ArrayBuffer)m=Ki.fromBinary(new Uint8Array(f.data));else{L.error("could not decode websocket message: ".concat(typeof f.data));return}if(this.state!==dn.CONNECTED){let v=!1;if(((h=m.message)===null||h===void 0?void 0:h.case)==="join"?(this.state=dn.CONNECTED,i==null||i.removeEventListener("abort",u),this.pingTimeoutDuration=m.message.value.pingTimeout,this.pingIntervalDuration=m.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(L.debug("ping config",{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration}),this.startPingInterval()),a(m.message.value)):this.state===dn.RECONNECTING?(this.state=dn.CONNECTED,i==null||i.removeEventListener("abort",u),this.startPingInterval(),((p=m.message)===null||p===void 0?void 0:p.case)==="reconnect"?a((g=m.message)===null||g===void 0?void 0:g.value):(a(),v=!0)):r.reconnect||c(new Rt("did not receive join response, got ".concat((y=m.message)===null||y===void 0?void 0:y.case," instead"))),!v)return}this.signalLatency&&(yield no(this.signalLatency)),this.handleSignalResponse(m)}),this.ws.onclose=f=>{L.warn("websocket closed",{ev:f}),this.handleOnClose(f.reason)}}finally{l()}}))}close(){return U(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();try{if(this.state=dn.DISCONNECTING,this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const n=new Promise(r=>{this.ws?this.ws.onclose=()=>{r()}:r()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([n,no(250)])),this.ws=void 0}}finally{this.state=dn.DISCONNECTED,this.clearPingInterval(),e()}})}sendOffer(e){L.debug("sending offer",e),this.sendRequest({case:"offer",value:_p(e)})}sendAnswer(e){return L.debug("sending answer"),this.sendRequest({case:"answer",value:_p(e)})}sendIceCandidate(e,n){return L.trace("sending ice candidate",e),this.sendRequest({case:"trickle",value:new gi({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new vi({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return this.sendRequest({case:"updateMetadata",value:new qi({metadata:e,name:n})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new Yi({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new ts({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:xe.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new is({timestamp:xe.parse(Date.now()),rtt:xe.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new Wr({canReconnect:!1,reason:to.CLIENT_INITIATED})})}sendRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return U(this,void 0,void 0,function*(){if(!n&&!$W(e)&&this.state===dn.RECONNECTING){this.queuedRequests.push(()=>U(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield no(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){L.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case));return}const i=new Ls({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(s){L.error("error sending signal message",{error:s})}})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){L.debug("received unsupported message");return}let s=!1;if(i.case==="answer"){const o=rA(i.value);this.onAnswer&&this.onAnswer(o)}else if(i.case==="offer"){const o=rA(i.value);this.onOffer&&this.onOffer(o)}else if(i.case==="trickle"){const o=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(o,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),s=!0):L.debug("unsupported message",i));s||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return U(this,void 0,void 0,function*(){if(this.state===dn.DISCONNECTED)return;const n=this.onClose;yield this.close(),L.debug("websocket connection closed: ".concat(e)),n&&n(e)})}handleWSError(e){L.error("websocket error",e)}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){L.warn("ping timeout duration not set");return}this.pingTimeout=kn.setTimeout(()=>{L.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString())),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&kn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){L.warn("ping interval duration not set");return}L.debug("start ping interval"),this.pingInterval=kn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){L.debug("clearing ping interval"),this.clearPingTimeout(),this.pingInterval&&kn.clearInterval(this.pingInterval)}}function rA(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function _p(t){return new tr({sdp:t.sdp,type:t.type})}function KW(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",Qa()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.publishOnly!==void 0&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var yN={},CN={exports:{}},iA=CN.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(iA).forEach(function(t){var e=iA[t];e.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var IN=CN.exports;(function(t){var e=function(a){return String(Number(a))===a?Number(a):a},n=function(a,c,l,u){if(u&&!l)c[u]=e(a[1]);else for(var d=0;d<l.length;d+=1)a[d+1]!=null&&(c[l[d]]=e(a[d+1]))},r=function(a,c,l){var u=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:u&&!c[a.name]&&(c[a.name]={});var d=a.push?{}:u?c[a.name]:c;n(l.match(a.reg),d,a.names,a.name),a.push&&c[a.push].push(d)},i=IN,s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var c={},l=[],u=c;return a.split(/(\r\n|\r|\n)/).filter(s).forEach(function(d){var f=d[0],h=d.slice(2);f==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var p=0;p<(i[f]||[]).length;p+=1){var g=i[f][p];if(g.reg.test(h))return r(g,u,h)}}),c.media=l,c};var o=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=e(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(e),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},t.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var u,d=!1;return l[0]!=="~"?u=e(l):(u=e(l.substring(1,l.length)),d=!0),{scid:u,paused:d}})})}})(yN);var ev=IN,JW=/%[sdv%]/g,YW=function(t){var e=1,n=arguments,r=n.length;return t.replace(JW,function(i){if(e>=r)return i;var s=n[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}})},Tu=function(t,e,n){var r=e.format instanceof Function?e.format(e.push?n:n[e.name]):e.format,i=[t+"="+r];if(e.names)for(var s=0;s<e.names.length;s+=1){var o=e.names[s];e.name?i.push(n[e.name][o]):i.push(n[e.names[s]])}else i.push(n[e.name]);return YW.apply(null,i)},qW=["v","o","s","i","u","e","p","c","b","t","r","z","a"],QW=["i","c","b","a"],e6=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(s){s.payloads==null&&(s.payloads="")});var n=e.outerOrder||qW,r=e.innerOrder||QW,i=[];return n.forEach(function(s){ev[s].forEach(function(o){o.name in t&&t[o.name]!=null?i.push(Tu(s,o,t)):o.push in t&&t[o.push]!=null&&t[o.push].forEach(function(a){i.push(Tu(s,o,a))})})}),t.media.forEach(function(s){i.push(Tu("m",ev.m[0],s)),r.forEach(function(o){ev[o].forEach(function(a){a.name in s&&s[a.name]!=null?i.push(Tu(o,a,s)):a.push in s&&s[a.push]!=null&&s[a.push].forEach(function(c){i.push(Tu(o,a,c))})})})}),i.join(`\r
`)+`\r
`},t6=yN,n6=e6,tv=n6,Uu=t6.parse;const sA=.7,ul={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class oA extends vs.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=CI(r=>U(this,void 0,void 0,function*(){this.emit(ul.NegotiationStarted);try{yield this.createAndSendOffer()}catch(i){if(r)r(i);else throw i}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.config=e,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const e=BW()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return U(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var n;return U(this,void 0,void 0,function*(){let r;if(e.type==="offer"){let{stereoMids:i,nackMids:s}=i6(e);this.remoteStereoMids=i,this.remoteNackMids=s}else if(e.type==="answer"){const i=Uu((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(s=>{s.type==="audio"&&this.trackBitrates.some(o=>{if(!o.transceiver||s.mid!=o.transceiver.mid)return!1;let a=0;if(s.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of s.fmtp)if(l.payload===a){l.config=l.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),o.maxbr>0&&(l.config+=";maxaveragebitrate=".concat(o.maxbr*1e3)),c=!0;break}return c||o.maxbr>0&&s.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(o.maxbr*1e3)}),!0})}),r=tv(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(ul.NegotiationComplete),e.sdp&&Uu(e.sdp).media.forEach(s=>{s.type==="video"&&this.emit(ul.RTPVideoPayloadTypes,s.rtp)}))})}createAndSendOffer(e){var n;return U(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(L.debug("restarting ICE"),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){L.warn("could not createOffer with closed peer connection");return}L.debug("starting to negotiate");const r=yield this.pc.createOffer(e),i=Uu((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(s=>{s.type==="audio"?aA(s,[],[]):s.type==="video"&&(r6(s),this.trackBitrates.some(o=>{if(!s.msid||!o.cid||!s.msid.includes(o.cid))return!1;let a=0;if(s.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of s.fmtp)if(l.payload===a){l.config.includes("x-google-start-bitrate")||(l.config+=";x-google-start-bitrate=".concat(Math.round(o.maxbr*sA))),l.config.includes("x-google-max-bitrate")||(l.config+=";x-google-max-bitrate=".concat(o.maxbr)),c=!0;break}return c||s.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(Math.round(o.maxbr*sA),";x-google-max-bitrate=").concat(o.maxbr)}),!0}))}),yield this.setMungedSDP(r,tv(i)),this.onOffer(r)})}createAndSetAnswer(){var e;return U(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),r=Uu((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{i.type==="audio"&&aA(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,tv(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new Yt("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new Yt("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return U(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const o=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(o!==void 0)return i.get(o)})}setMungedSDP(e,n,r){return U(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{L.debug("setting munged ".concat(r?"remote":"local"," description")),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(s){L.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),{error:s,sdp:n}),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let s="unknown error";i instanceof Error?s=i.message:typeof i=="string"&&(s=i);const o={error:s,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),L.error("unable to set ".concat(e.type),o),new i0(s)}})}}function aA(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function r6(t){var e,n,r,i;const s=(n=(e=t.rtp[0])===null||e===void 0?void 0:e.codec)===null||n===void 0?void 0:n.toLowerCase();if(!Qu(s))return;let o=0;((r=t.ext)===null||r===void 0?void 0:r.some(c=>c.uri===$w?!0:(c.value>o&&(o=c.value),!1)))||(i=t.ext)===null||i===void 0||i.push({value:o+1,uri:$w})}function i6(t){var e;const n=[],r=[],i=Uu((e=t.sdp)!==null&&e!==void 0?e:"");let s=0;return i.media.forEach(o=>{var a;o.type==="audio"&&(o.rtp.some(c=>c.codec==="opus"?(s=c.payload,!0):!1),!((a=o.rtcpFb)===null||a===void 0)&&a.some(c=>c.payload===s&&c.type==="nack")&&r.push(o.mid),o.fmtp.some(c=>c.payload===s?(c.config.includes("sprop-stereo=1")&&n.push(o.mid),!0):!1))}),{stereoMids:n,nackMids:r}}const l0="vp8",s6={audioBitrate:Ep.music.maxBitrate,audioPreset:Ep.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:dN.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:l0,backupCodec:!0},SN={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},bN={resolution:Dd.h720.resolution},o6={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new YV,disconnectOnPageLeave:!0,expWebAudioMix:!1},wI={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Qt;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(Qt||(Qt={}));class a6{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n){this.peerConnectionTimeout=wI.peerConnectionTimeout,this.updateState=()=>{var i;const s=this.state,o=this.requiredTransports.map(a=>a.getConnectionState());o.every(a=>a==="connected")?this.state=Qt.CONNECTED:o.some(a=>a==="failed")?this.state=Qt.FAILED:o.some(a=>a==="connecting")?this.state=Qt.CONNECTING:o.every(a=>a==="closed")?this.state=Qt.CLOSED:o.some(a=>a==="closed")?this.state=Qt.CLOSING:o.every(a=>a==="new")&&(this.state=Qt.NEW),s!==this.state&&(L.debug("pc state change: from ".concat(Qt[s]," to ").concat(Qt[this.state])),(i=this.onStateChange)===null||i===void 0||i.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const r={optional:[{googDscp:!0}]};this.publisher=new oA(e,r),this.subscriber=new oA(e),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=i=>{var s;(s=this.onIceCandidate)===null||s===void 0||s.call(this,i,Bn.PUBLISHER)},this.subscriber.onIceCandidate=i=>{var s;(s=this.onIceCandidate)===null||s===void 0||s.call(this,i,Bn.SUBSCRIBER)},this.subscriber.onDataChannel=i=>{var s;(s=this.onDataChannel)===null||s===void 0||s.call(this,i)},this.subscriber.onTrack=i=>{var s;(s=this.onTrack)===null||s===void 0||s.call(this,i)},this.publisher.onOffer=i=>{var s;(s=this.onPublisherOffer)===null||s===void 0||s.call(this,i)},this.state=Qt.NEW,this.connectionLock=new bi}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return U(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){L.warn("could not removeTrack",{error:r})}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return U(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return U(this,void 0,void 0,function*(){n===Bn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return U(this,void 0,void 0,function*(){return L.debug("received server offer",{RTCSdpType:e.type,signalingState:this.subscriber.getSignallingState().toString()}),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){var r;return U(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(L.debug("negotiation required, start negotiating"),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(s=>this.ensureTransportConnected(s,e,n)))}finally{i()}})}negotiate(e){return U(this,void 0,void 0,function*(){return new Promise((n,r)=>U(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),s=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",s),this.publisher.once(ul.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(ul.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(o=>{clearTimeout(i),r(o)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===Bn.PUBLISHER?this.publisher.getConnectedAddress():e===Bn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return U(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((s,o)=>U(this,void 0,void 0,function*(){const a=()=>{L.warn("abort transport connection"),kn.clearTimeout(c),o(new Rt("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&a(),n==null||n.signal.addEventListener("abort",a);const c=kn.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",a),o(new Rt("could not establish pc connection"))},r);for(;this.state!==Qt.CONNECTED;)if(yield no(50),n!=null&&n.signal.aborted){o(new Rt("room connection has been cancelled",3));return}kn.clearTimeout(c),n==null||n.signal.removeEventListener("abort",a),s()}))})}}const cA="_lossy",lA="_reliable",c6=2*1e3,uA="leave-reconnect";var Yr;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(Yr||(Yr={}));class l6 extends vs.EventEmitter{get isClosed(){return this._isClosed}constructor(e){super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=wI.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=Yr.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.handleDataChannel=n=>{let{channel:r}=n;return U(this,void 0,void 0,function*(){if(r){if(r.label===lA)this.reliableDCSub=r;else if(r.label===cA)this.lossyDCSub=r;else return;L.debug("on data channel ".concat(r.id,", ").concat(r.label)),r.onmessage=this.handleDataMessage}})},this.handleDataMessage=n=>U(this,void 0,void 0,function*(){var r,i;const s=yield this.dataProcessLock.lock();try{let o;if(n.data instanceof ArrayBuffer)o=n.data;else if(n.data instanceof Blob)o=yield n.data.arrayBuffer();else{L.error("unsupported data type",n.data);return}const a=Wi.fromBinary(new Uint8Array(o));((r=a.value)===null||r===void 0?void 0:r.case)==="speaker"?this.emit(ge.ActiveSpeakersUpdate,a.value.value.speakers):((i=a.value)===null||i===void 0?void 0:i.case)==="user"&&this.emit(ge.DataPacketReceived,a.value.value,a.kind)}finally{s()}}),this.handleDataError=n=>{const i=n.currentTarget.maxRetransmits===0?"lossy":"reliable";if(n instanceof ErrorEvent&&n.error){const{error:s}=n.error;L.error("DataChannel error on ".concat(i,": ").concat(n.message),s)}else L.error("Unknown DataChannel error on ".concat(i),n)},this.handleBufferedAmountLow=n=>{const i=n.currentTarget.maxRetransmits===0?qt.LOSSY:qt.RELIABLE;this.updateAndEmitDCBufferStatus(i)},this.handleDisconnect=(n,r)=>{if(this._isClosed)return;L.warn("".concat(n," disconnected")),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const i=a=>{L.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(a,"ms. giving up")),this.emit(ge.Disconnected),this.close()},s=Date.now()-this.reconnectStart;let o=this.getNextRetryDelay({elapsedMs:s,retryCount:this.reconnectAttempts});if(o===null){i(s);return}n===uA&&(o=0),L.debug("reconnecting in ".concat(o,"ms")),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=kn.setTimeout(()=>this.attemptReconnect(r),o)},this.waitForRestarted=()=>new Promise((n,r)=>{this.pcState===Yr.Connected&&n();const i=()=>{this.off(ge.Disconnected,s),n()},s=()=>{this.off(ge.Restarted,i),r()};this.once(ge.Restarted,i),this.once(ge.Disconnected,s)}),this.updateAndEmitDCBufferStatus=n=>{const r=this.isBufferStatusLow(n);typeof r<"u"&&r!==this.dcBufferStatus.get(n)&&(this.dcBufferStatus.set(n,r),this.emit(ge.DCBufferStatusChanged,r,n))},this.isBufferStatusLow=n=>{const r=this.dataChannelForKind(n);if(r)return r.bufferedAmount<=r.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===dn.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(ws.RR_SIGNAL_DISCONNECTED))},this.client=new bI,this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new bi,this.dataProcessLock=new bi,this.dcBufferStatus=new Map([[qt.LOSSY,!0],[qt.RELIABLE,!0]]),this.client.onParticipantUpdate=n=>this.emit(ge.ParticipantUpdate,n),this.client.onConnectionQuality=n=>this.emit(ge.ConnectionQualityUpdate,n),this.client.onRoomUpdate=n=>this.emit(ge.RoomUpdate,n),this.client.onSubscriptionError=n=>this.emit(ge.SubscriptionError,n),this.client.onSubscriptionPermissionUpdate=n=>this.emit(ge.SubscriptionPermissionUpdate,n),this.client.onSpeakersChanged=n=>this.emit(ge.SpeakersChanged,n),this.client.onStreamStateUpdate=n=>this.emit(ge.StreamStateChanged,n)}join(e,n,r,i){return U(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.pcManager||(yield this.configure(s)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=s.clientConfiguration,s}catch(s){if(s instanceof Rt&&s.reason===1&&(L.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts)),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw s}})}close(){return U(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(ge.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return U(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return U(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Bi("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new Rt("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:s=>{clearTimeout(i),n(s)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){L.warn("failed to remove track",{error:n,method:"removeTrack"})}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return U(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var n;return U(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==Qt.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new a6(r,e.subscriberPrimary),this.emit(ge.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,s)=>{this.client.sendIceCandidate(i,s)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,s,o)=>U(this,void 0,void 0,function*(){if(L.debug("primary PC state changed ".concat(i)),i===Qt.CONNECTED){const a=this.pcState===Yr.New;this.pcState=Yr.Connected,a&&this.emit(ge.Connected,e)}else i===Qt.FAILED&&this.pcState===Yr.Connected&&(this.pcState=Yr.Disconnected,this.handleDisconnect("peerconnection failed",o==="failed"?ws.RR_SUBSCRIBER_FAILED:ws.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(ge.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>U(this,void 0,void 0,function*(){this.pcManager&&(L.debug("received server answer",{RTCSdpType:e.type}),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(L.trace("got ICE candidate from peer",{candidate:e,target:n}),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>U(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{if(L.debug("received trackPublishedResponse",e),!this.pendingTrackResolvers[e.cid]){L.error("missing track resolver for ".concat(e.cid));return}const{resolve:n}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],n(e.track)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(ge.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(ge.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",ws.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(uA)):(this.emit(ge.Disconnected,e==null?void 0:e.reason),this.close()),L.trace("leave request",{leave:e})}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(L.debug("E2EE - setting up transports with insertable streams"),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(s=>{const o={urls:s.urls};s.username&&(o.username=s.username),s.credential&&(o.credential=s.credential),i.push(o)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Ei.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(cA,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(lA,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,n,r){if(!("getCapabilities"in RTCRtpSender))return;const i=RTCRtpSender.getCapabilities(n);if(!i)return;L.debug("get capabilities",i);const s=[],o=[],a=[];i.codecs.forEach(c=>{const l=c.mimeType.toLowerCase();if(l==="audio/opus"){s.push(c);return}if(!(l==="video/".concat(r))){a.push(c);return}if(r==="h264"){c.sdpFmtpLine&&c.sdpFmtpLine.includes("profile-level-id=42e01f")?s.push(c):o.push(c);return}s.push(c)}),LW(e)&&e.setCodecPreferences(s.concat(o,a))}createSender(e,n,r){return U(this,void 0,void 0,function*(){if(Kw())return yield this.createTransceiverRTCRtpSender(e,n,r);if(Jw())return L.warn("using add-track fallback"),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Yt("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return U(this,void 0,void 0,function*(){if(Kw())return this.createSimulcastTransceiverSender(e,n,r,i);if(Jw())return L.debug("using add-track fallback"),this.createRTCRtpSender(e.mediaStreamTrack);throw new Yt("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yt("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const s={direction:"sendonly",streams:i};r&&(s.sendEncodings=r);const o=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,s);return e.kind===Y.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(o,e.kind,n.videoCodec),e.codec=n.videoCodec),o.sender})}createSimulcastTransceiverSender(e,n,r,i){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yt("publisher is closed");const s={direction:"sendonly"};i&&(s.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,s);if(r.videoCodec)return this.setPreferredCodec(o,e.kind,r.videoCodec),e.setSimulcastTrackSender(r.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yt("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var n,r,i;return U(this,void 0,void 0,function*(){if(!this._isClosed&&!this.attemptingReconnect){(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Ei.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:Qt.NEW)===Qt.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let o=!0;s instanceof Yt?(L.debug("received unrecoverable error",{error:s}),o=!1):s instanceof $f||(this.fullReconnectOnNext=!0),o?this.handleDisconnect("reconnect",ws.RR_UNKNOWN):(L.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up")),this.emit(ge.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){L.warn("encountered error in reconnect policy",{error:n})}return null}restartConnection(e){var n,r,i;return U(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new Yt("could not reconnect, url or token not saved");L.info("reconnecting, attempt: ".concat(this.reconnectAttempts)),this.emit(ge.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw L.warn("attempted connection restart, without signal options present"),new $f;s=yield this.join(e??this.url,this.token,this.signalOpts)}catch(o){throw o instanceof Rt&&o.reason===0?new Yt("could not reconnect, token might be expired"):new $f}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");this.client.setReconnected(),this.emit(ge.SignalRestarted,s),yield this.waitForPCReconnected(),(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(ge.Restarted)}catch(s){const o=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(o){yield this.restartConnection(o);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),s}})}resumeConnection(e){var n;return U(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new Yt("could not reconnect, url or token not saved");if(!this.pcManager)throw new Yt("publisher and subscriber connections unset");L.info("resuming signal connection, attempt ".concat(this.reconnectAttempts)),this.emit(ge.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,L.error(r.message)),r instanceof Rt&&r.reason===0?new Yt("could not reconnect, token might be expired"):new $f(i)}if(this.emit(ge.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(ge.Resumed)})}waitForPCInitialConnection(e,n){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return U(this,void 0,void 0,function*(){this.pcState=Yr.Reconnecting,L.debug("waiting for peer connection to reconnect");try{if(yield no(c6),!this.pcManager)throw new Yt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Yr.Connected}catch(e){throw this.pcState=Yr.Disconnected,new Rt("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,n){return U(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yt("PC manager is closed");const i=n?this.pcManager.subscriber:this.pcManager.publisher,s=n?"Subscriber":"Publisher";if(!i)throw new Rt("".concat(s," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const o=this.dataChannelForKind(e,n);if((o==null?void 0:o.readyState)==="open")return;const a=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<a;){if(i.isICEConnected&&((r=this.dataChannelForKind(e,n))===null||r===void 0?void 0:r.readyState)==="open")return;yield no(50)}throw new Rt("could not establish ".concat(s," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(e){return U(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Qt.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return U(this,void 0,void 0,function*(){return new Promise((e,n)=>U(this,void 0,void 0,function*(){if(!this.pcManager){n(new i0("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),L.debug("engine disconnected while negotiation was ongoing"),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(ge.Closing,i),this.pcManager.publisher.once(ul.RTPVideoPayloadTypes,s=>{const o=new Map;s.forEach(a=>{const c=a.codec.toLowerCase();WW(c)&&o.set(a.payload,c)}),this.emit(ge.RTPVideoMapUpdate,o)});try{yield this.pcManager.negotiate(r),e()}catch(s){s instanceof i0&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",ws.RR_UNKNOWN),n(s)}finally{this.off(ge.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===qt.LOSSY)return this.lossyDCSub;if(e===qt.RELIABLE)return this.reliableDCSub}else{if(e===qt.LOSSY)return this.lossyDC;if(e===qt.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){L.warn("sync state cannot be sent without peer connection setup");return}const s=this.pcManager.subscriber.getLocalDescription(),o=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,c=new Array;e.forEach(l=>{l.isDesired!==a&&c.push(l.trackSid)}),this.client.sendSyncState(new ns({answer:s?_p({sdp:s.sdp,type:s.type}):void 0,offer:o?_p({sdp:o.sdp,type:o.type}):void 0,subscription:new Vr({trackSids:c,subscribe:!a,participantTracks:[]}),publishTracks:NW(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new rs({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(qt.LOSSY),Bn.PUBLISHER),n(this.dataChannelForKind(qt.RELIABLE),Bn.PUBLISHER),n(this.dataChannelForKind(qt.LOSSY,!0),Bn.SUBSCRIBER),n(this.dataChannelForKind(qt.RELIABLE,!0),Bn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&kn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){pr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){pr()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class $f extends Error{}class dA{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return c0(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return U(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),L.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return U(this,void 0,void 0,function*(){const n=yield fetch("".concat(u6(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new Rt("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function u6(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}const AI=2e3;function Am(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}class Xn extends Dl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,Y.Kind.Audio,n,r),this.stopOnMute=!1,this.monitorSender=()=>U(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(o){L.error("could not get audio sender stats",{error:o});return}s&&this.prevStats&&(this._currentBitrate=Am(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return U(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||Ga(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return U(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(L.debug("stopping mic track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return U(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Ga(this._constraints.deviceId);return this.source===Y.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(L.debug("reacquiring mic track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return U(this,void 0,void 0,function*(){let n;if(e){const r=wm({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return U(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){pr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},AI)))}setProcessor(e){var n;return U(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};L.debug("setting up audio processor ".concat(e.name)),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return U(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return U(this,void 0,void 0,function*(){const e=yield TW(this);return e&&(this.isMuted||L.warn("silence detected on local audio track"),this.emit(fe.AudioSilenceDetected)),e})}}function wN(t,e){switch(t.kind){case"audio":return new Xn(t,e,!1);case"video":return new Sr(t,e,!1);default:throw new Bi("unsupported track type: ".concat(t.kind))}}const d6=Object.values(Dd),f6=Object.values(s0),h6=Object.values(dN),p6=[Dd.h180,Dd.h360],m6=[s0.h180,s0.h360],g6=t=>[{scaleResolutionDownBy:2,fps:3}].map(n=>{var r;return new pt(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/n.fps)))),n.fps,t.encoding.priority)}),u0=["q","h","f"];function d0(t,e,n,r){var i,s;let o=r==null?void 0:r.videoEncoding;t&&(o=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,c=r==null?void 0:r.scalabilityMode,l=r==null?void 0:r.videoCodec;if(!o&&!a&&!c||!e||!n)return[{}];o||(o=y6(t,e,n,l),L.debug("using video encoding",o));const u=new pt(e,n,o.maxBitrate,o.maxFramerate,o.priority);if(c&&Qu(l)){L.debug("using svc with scalabilityMode ".concat(c));const h=new AN(c),p=[];if(h.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));for(let g=0;g<h.spatial;g+=1)p.push({rid:u0[2-g],maxBitrate:o.maxBitrate/Math.pow(3,g),maxFramerate:u.encoding.maxFramerate});return p[0].scalabilityMode=c,L.debug("encodings",p),p}if(!a)return[o];let d=[];t?d=(i=hA(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:fA(t,u):d=(s=hA(r==null?void 0:r.videoSimulcastLayers))!==null&&s!==void 0?s:fA(t,u);let f;if(d.length>0){const h=d[0];d.length>1&&([,f]=d);const p=Math.max(e,n);if(p>=960&&f)return nv(e,n,[h,f,u]);if(p>=480)return nv(e,n,[h,u])}return nv(e,n,[u])}function v6(t,e,n){var r,i,s,o;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&L.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const a=t.mediaStreamTrack.getSettings(),c=(r=a.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,l=(s=a.height)!==null&&s!==void 0?s:(o=t.dimensions)===null||o===void 0?void 0:o.height;return d0(t.source===Y.Source.ScreenShare,c,l,n)}function y6(t,e,n,r){const i=C6(t,e,n);let{encoding:s}=i[0];const o=Math.max(e,n);for(let a=0;a<i.length;a+=1){const c=i[a];if(s=c.encoding,c.width>=o)break}if(r)switch(r){case"av1":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function C6(t,e,n){if(t)return h6;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?d6:f6}function fA(t,e){if(t)return g6(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?p6:m6}function nv(t,e,n){const r=[];if(n.forEach((i,s)=>{if(s>=u0.length)return;const o=Math.min(t,e),c={rid:u0[s],scaleResolutionDownBy:Math.max(1,o/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(c.maxFramerate=i.encoding.maxFramerate);const l=xl()||s===0;i.encoding.priority&&l&&(c.priority=i.encoding.priority,c.networkPriority=i.encoding.priority),r.push(c)}),Qa()&&gN()==="ios"){let i;r.forEach(o=>{i?o.maxFramerate&&o.maxFramerate>i&&(i=o.maxFramerate):i=o.maxFramerate});let s=!0;r.forEach(o=>{var a;o.maxFramerate!=i&&(s&&(s=!1,L.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),L.info('Setting framerate of encoding "'.concat((a=o.rid)!==null&&a!==void 0?a:"",'" to ').concat(i)),o.maxFramerate=i)})}return r}function hA(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class AN{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const I6=5e3;class Sr extends Dl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;super(e,Y.Kind.Video,n,r),this.simulcastCodecs=new Map,this.monitorSender=()=>U(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let i;try{i=yield this.getSenderStats()}catch(o){L.error("could not get audio sender stats",{error:o});return}const s=new Map(i.map(o=>[o.rid,o]));if(this.prevStats){let o=0;s.forEach((a,c)=>{var l;const u=(l=this.prevStats)===null||l===void 0?void 0:l.get(c);o+=Am(a,u)}),this._currentBitrate=o}this.prevStats=s}),this.senderLock=new bi}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!pr())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},AI))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,r,i,s,o;return U(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var a=!0,c=kc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0)s=l.value,a=!1,yield(o=s.sender)===null||o===void 0?void 0:o.replaceTrack(null)}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,r,i,s,o;return U(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var a=!0,c=kc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){s=l.value,a=!1;const u=s;yield(o=u.sender)===null||o===void 0?void 0:o.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return U(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Camera&&!this.isUserProvided&&(L.debug("stopping camera track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return U(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Camera&&!this.isUserProvided&&(L.debug("reacquiring camera track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return U(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var s;if(i.type==="outbound-rtp"){const o={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(s=i.rid)!==null&&s!==void 0?s:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},a=r.get(i.remoteId);a&&(o.jitter=a.jitter,o.packetsLost=a.packetsLost,o.roundTripTime=a.roundTripTime),n.push(o)}}),n})}setPublishingQuality(e){const n=[];for(let r=sn.LOW;r<=sn.HIGH;r+=1)n.push(new Ci({quality:r,enabled:r<=e}));L.debug("setting publishing quality. max quality ".concat(e)),this.setPublishingLayers(n)}setDeviceId(e){return U(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Ga(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||Ga(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var n,r,i,s;return U(this,void 0,void 0,function*(){let o;if(e){const u=wm({video:e});typeof u.video!="boolean"&&(o=u.video)}yield this.restart(o);try{for(var a=!0,c=kc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){s=l.value,a=!1;const u=s;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,s,o,a,c,l;return U(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,e,n),!((c=this.processor)===null||c===void 0)&&c.processedTrack)try{for(var u=!0,d=kc(this.simulcastCodecs.values()),f;f=yield d.next(),i=f.done,!i;u=!0)a=f.value,u=!1,yield(l=a.sender)===null||l===void 0?void 0:l.replaceTrack(this.processor.processedTrack)}catch(h){s={error:h}}finally{try{!u&&!i&&(o=d.return)&&(yield o.call(d))}finally{if(s)throw s.error}}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},I6))}setPublishingCodecs(e){var n,r,i,s,o,a,c;return U(this,void 0,void 0,function*(){if(L.debug("setting publishing codecs",{codecs:e,currentCodec:this.codec}),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const l=[];try{for(n=!0,r=kc(e);i=yield r.next(),s=i.done,!s;n=!0){c=i.value,n=!1;const u=c;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(L.debug("try setPublishingCodec for ".concat(u.codec),d),!d||!d.sender){for(const f of u.qualities)if(f.enabled){l.push(u.codec);break}}else d.encodings&&(L.debug("try setPublishingLayersForSender ".concat(u.codec)),yield pA(d.sender,d.encodings,u.qualities,this.senderLock))}}}catch(u){o={error:u}}finally{try{!n&&!s&&(a=r.return)&&(yield a.call(r))}finally{if(o)throw o.error}}return l})}setPublishingLayers(e){return U(this,void 0,void 0,function*(){L.debug("setting publishing layers",e),!(!this.sender||!this.encodings)&&(yield pA(this.sender,this.encodings,e,this.senderLock))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return U(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),pN()&&this.isInBackground&&this.source===Y.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function pA(t,e,n,r){return U(this,void 0,void 0,function*(){const i=yield r.lock();L.debug("setPublishingLayersForSender",{sender:t,qualities:n,senderEncodings:e});try{const s=t.getParameters(),{encodings:o}=s;if(!o)return;if(o.length!==e.length){L.warn("cannot set publishing layers, encodings mismatch");return}let a=!1;!1&&o[0].scalabilityMode||o.forEach((l,u)=>{var d;let f=(d=l.rid)!==null&&d!==void 0?d:"";f===""&&(f="q");const h=kN(f),p=n.find(g=>g.quality===h);p&&l.active!==p.enabled&&(a=!0,l.active=p.enabled,L.debug("setting layer ".concat(p.quality," to ").concat(l.active?"enabled":"disabled")),xl()&&(p.enabled?(l.scaleResolutionDownBy=e[u].scaleResolutionDownBy,l.maxBitrate=e[u].maxBitrate,l.maxFrameRate=e[u].maxFrameRate):(l.scaleResolutionDownBy=4,l.maxBitrate=10,l.maxFrameRate=2)))}),a&&(s.encodings=o,L.debug("setting encodings",s.encodings),yield t.setParameters(s))}finally{i()}})}function kN(t){switch(t){case"f":return sn.HIGH;case"h":return sn.MEDIUM;case"q":return sn.LOW;default:return sn.HIGH}}function mA(t,e,n,r){if(!n)return[new er({quality:sn.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,s=new AN(i),o=[];for(let a=0;a<s.spatial;a+=1)o.push(new er({quality:sn.HIGH-a,width:Math.ceil(t/Math.pow(2,a)),height:Math.ceil(e/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return o}return n.map(i=>{var s,o,a;const c=(s=i.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let l=kN((o=i.rid)!==null&&o!==void 0?o:"");return new er({quality:l,width:Math.ceil(t/c),height:Math.ceil(e/c),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class EN extends Y{constructor(e,n,r,i){super(e,r),this.sid=n,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?fe.Muted:fe.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(fe.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return U(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),AI))}}class Va extends EN{constructor(e,n,r,i,s){super(e,n,Y.Kind.Audio,r),this.monitorReceiver=()=>U(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const o=yield this.getReceiverStats();o&&this.prevStats&&this.receiver&&(this._currentBitrate=Am(o,this.prevStats)),this.prevStats=o}),this.audioContext=i,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;Qa()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Qa())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return U(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(a0(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&a0(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(L.debug("using audio context mapping"),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(fe.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(fe.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return U(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const rv=100;class td extends EN{constructor(e,n,r,i){super(e,n,Y.Kind.Video,r),this.elementInfos=[],this.monitorReceiver=()=>U(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=Am(s,this.prevStats)),this.prevStats=s}),this.debouncedHandleResize=CI(()=>{this.updateDimensions()},rv),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?ll(this._mediaStreamTrack,n):Zc(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new S6(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):L.warn("visibility resize observer not triggered")}stopObservingElementInfo(e){if(!this.isAdaptiveStream){L.warn("stopObservingElementInfo ignored");return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return U(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(s=>{s.type==="inbound-rtp"?(r=s.codecId,n={type:"video",framesDecoded:s.framesDecoded,framesDropped:s.framesDropped,framesReceived:s.framesReceived,packetsReceived:s.packetsReceived,packetsLost:s.packetsLost,frameWidth:s.frameWidth,frameHeight:s.frameHeight,pliCount:s.pliCount,firCount:s.firCount,nackCount:s.nackCount,jitter:s.jitter,timestamp:s.timestamp,bytesReceived:s.bytesReceived,decoderImplementation:s.decoderImplementation}):s.type==="codec"&&i.set(s.id,s)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return U(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((a,c)=>Math.max(a,c.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,s=this.elementInfos.some(a=>a.pictureInPicture),o=this.elementInfos.some(a=>a.visible)&&!i||s;if(this.lastVisible!==o){if(!o&&Date.now()-r<rv){kn.setTimeout(()=>{this.updateVisibility()},rv);return}this.lastVisible=o,this.emit(fe.VisibilityChanged,o,this)}}updateDimensions(){var e,n;let r=0,i=0;const s=this.getPixelDensity();for(const o of this.elementInfos){const a=o.width()*s,c=o.height()*s;a+c>r+i&&(r=a,i=c)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(fe.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?Yw():n||(Yw()>2?2:1)}}class S6{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:s,isIntersecting:o}=r;s===this.element&&(this.isIntersecting=o,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??gA(e),this.isPiP=pr()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=gA(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,Qw().observe(this.element),qw().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,n;(e=Qw())===null||e===void 0||e.unobserve(this.element),(n=qw())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function gA(t){let e=t.offsetTop,n=t.offsetLeft;const r=t.offsetWidth,i=t.offsetHeight,{hidden:s}=t,{opacity:o,display:a}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+i>window.pageYOffset&&n+r>window.pageXOffset&&!s&&(o!==""?parseFloat(o)>0:!0)&&a!=="none"}class As extends vs.EventEmitter{constructor(e,n,r){super(),this.metadataMuted=!1,this.encryption=An.NONE,this.handleMuted=()=>{this.emit(fe.Muted)},this.handleUnmuted=()=>{this.emit(fe.Unmuted)},this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=Y.Source.Unknown}setTrack(e){this.track&&(this.track.off(fe.Muted,this.handleMuted),this.track.off(fe.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(fe.Muted,this.handleMuted),e.on(fe.Unmuted,this.handleUnmuted))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==An.NONE}get audioTrack(){if(this.track instanceof Xn||this.track instanceof Va)return this.track}get videoTrack(){if(this.track instanceof Sr||this.track instanceof td)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Y.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Y.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,L.debug("update publication info",{info:e})}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(As||(As={}));class Od extends As{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r){super(e,n.sid,n.name),this.track=void 0,this.handleTrackEnded=()=>{this.emit(fe.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(fe.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(fe.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return U(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return U(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return U(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return U(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var Ur;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(Ur||(Ur={}));function b6(t){switch(t){case Rs.EXCELLENT:return Ur.Excellent;case Rs.GOOD:return Ur.Good;case Rs.POOR:return Ur.Poor;case Rs.LOST:return Ur.Lost;default:return Ur.Unknown}}class TN extends vs.EventEmitter{get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,n;return(n=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&n!==void 0?n:!1}constructor(e,n,r,i){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Ur.Unknown,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,n]of this.tracks)if(n.source===e)return n}getTrackByName(e){for(const[,n]of this.tracks)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrack(Y.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrack(Y.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(Y.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,L.trace("update participant info",{info:e}),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(oe.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(oe.ParticipantNameChanged,e)}setPermissions(e){var n,r,i,s,o;const a=this.permissions,c=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||e.recorder!==((o=this.permissions)===null||o===void 0?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((l,u)=>{var d;return l!==((d=this.permissions)===null||d===void 0?void 0:d.canPublishSources[u])});return this.permissions=e,c&&this.emit(oe.ParticipantPermissionsChanged,a),c}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(oe.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=b6(e),n!==this._connectionQuality&&this.emit(oe.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(n=>(n.track instanceof Va||n.track instanceof Xn)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(fe.Muted,()=>{this.emit(oe.TrackMuted,e)}),e.on(fe.Unmuted,()=>{this.emit(oe.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case Y.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case Y.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function w6(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new es({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}class kI extends As{constructor(e,n,r){super(e,n.sid,n.name),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=sn.HIGH,this.handleEnded=i=>{this.setTrack(void 0),this.emit(fe.Ended,i)},this.handleVisibilityChange=i=>{L.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(i),{trackSid:this.trackSid}),this.disabled=!i,this.emitTrackUpdate()},this.handleVideoDimensionsChange=i=>{L.debug("adaptivestream video dimensions ".concat(i.width,"x").concat(i.height),{trackSid:this.trackSid}),this.videoDimensions=i,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new Vr({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new ji({participantSid:"",trackSids:[this.trackSid]})]});this.emit(fe.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?As.SubscriptionStatus.Unsubscribed:super.isSubscribed?As.SubscriptionStatus.Subscribed:As.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?As.PermissionStatus.Allowed:As.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof td&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof td&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(fe.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(fe.VisibilityChanged,this.handleVisibilityChange),i.off(fe.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(fe.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(fe.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(fe.VisibilityChanged,this.handleVisibilityChange),e.on(fe.Ended,this.handleEnded),this.emit(fe.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(fe.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?fe.Muted:fe.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(fe.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(fe.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===Y.Kind.Video&&this.isAdaptiveStream?(L.warn("adaptive stream is enabled, cannot change video track settings",{trackSid:this.trackSid}),!1):this.isDesired?!0:(L.warn("cannot update track settings when not subscribed",{trackSid:this.trackSid}),!1)}get isAdaptiveStream(){return this.track instanceof td&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new Ji({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=sn.HIGH,this.emit(fe.UpdateSettings,e)}}class Ld extends TN{static fromParticipantInfo(e,n){return new Ld(e,n.sid,n.identity,n.name,n.metadata)}constructor(e,n,r,i,s){super(n,r||"",i,s),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(fe.UpdateSettings,n=>{L.debug("send update settings",n),this.signalClient.sendUpdateTrackSettings(n)}),e.on(fe.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(fe.SubscriptionPermissionChanged,n=>{this.emit(oe.TrackSubscriptionPermissionChanged,e,n)}),e.on(fe.SubscriptionStatusChanged,n=>{this.emit(oe.TrackSubscriptionStatusChanged,e,n)}),e.on(fe.Subscribed,n=>{this.emit(oe.TrackSubscribed,n,e)}),e.on(fe.Unsubscribed,n=>{this.emit(oe.TrackUnsubscribed,n,e)}),e.on(fe.SubscriptionFailed,n=>{this.emit(oe.TrackSubscriptionFailed,e.trackSid,n)})}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrack(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y.Source.Microphone;const n=this.getTrack(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,s,o){let a=this.getTrackPublication(n);if(a||n.startsWith("TR")||this.tracks.forEach(u=>{!a&&e.kind===u.kind.toString()&&(a=u)}),!a){if(o===0){L.error("could not find published track",{participant:this.sid,trackSid:n}),this.emit(oe.TrackSubscriptionFailed,n);return}o===void 0&&(o=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,s,o-1)},150);return}if(e.readyState==="ended"){L.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",{participant:this.sid,trackSid:n}),this.emit(oe.TrackSubscriptionFailed,n);return}const c=e.kind==="video";let l;return c?l=new td(e,n,i,s):l=new Va(e,n,i,this.audioContext,this.audioOutput),l.source=a.source,l.isMuted=a.isMuted,l.setMediaStream(r),l.start(),a.setTrack(l),this.volumeMap.has(a.source)&&l instanceof Va&&l.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var s;let o=this.getTrackPublication(i.sid);if(o)o.updateInfo(i);else{const a=Y.kindFromProto(i.type);if(!a)return;o=new kI(a,i,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe),o.updateInfo(i),r.set(i.sid,o);const c=Array.from(this.tracks.values()).find(l=>l.source===(o==null?void 0:o.source));c&&o.source!==Y.Source.Unknown&&L.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(o.source),{oldTrack:c,newTrack:o,participant:this,participantInfo:e}),this.addTrackPublication(o)}n.set(i.sid,o)}),this.tracks.forEach(i=>{n.has(i.trackSid)||(L.trace("detected removed track on remote participant, unpublishing",{publication:i,participantSid:this.sid}),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(oe.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.tracks.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(e),r.kind){case Y.Kind.Audio:this.audioTracks.delete(e);break;case Y.Kind.Video:this.videoTracks.delete(e);break}n&&this.emit(oe.TrackUnpublished,r)}setAudioOutput(e){return U(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTracks.forEach(r=>{var i;r.track instanceof Va&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return L.trace("participant event",{participant:this.sid,event:e,args:r}),super.emit(e,...r)}}class f0 extends TN{constructor(e,n,r,i){super(e,n),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=An.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new vN)},this.handleReconnected=()=>{var s,o;(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||o===void 0||o.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var s,o;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>L.warn(a)),(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||o===void 0||o.call(s,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{L.debug("updating track subscription permissions",{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions}),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>w6(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,o)=>{if(o===void 0&&(o=!0),!s.sid){L.error("could not update mute status for unpublished track",s);return}this.engine.updateMuteStatus(s.sid,o)},this.onTrackUpstreamPaused=s=>{L.debug("upstream paused"),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{L.debug("upstream resumed"),this.onTrackMuted(s,s.isMuted)},this.handleSubscribedQualityUpdate=s=>U(this,void 0,void 0,function*(){var o,a,c,l,u,d;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const f=this.videoTracks.get(s.trackSid);if(!f){L.warn("received subscribed quality update for unknown track",{method:"handleSubscribedQualityUpdate",sid:s.trackSid});return}if(s.subscribedCodecs.length>0){if(!f.videoTrack)return;const y=yield f.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var h=!0,p=kc(y),g;g=yield p.next(),o=g.done,!o;h=!0){l=g.value,h=!1;const m=l;AW(m)&&(L.debug("publish ".concat(m," for ").concat(f.videoTrack.sid)),yield this.publishAdditionalCodecForTrack(f.videoTrack,m,f.options))}}catch(m){a={error:m}}finally{try{!h&&!o&&(c=p.return)&&(yield c.call(p))}finally{if(a)throw a.error}}}else s.subscribedQualities.length>0&&(yield(d=f.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(s.subscribedQualities))}),this.handleLocalTrackUnpublished=s=>{const o=this.tracks.get(s.trackSid);if(!o){L.warn("received unpublished event for unknown track",{method:"handleLocalTrackUnpublished",trackSid:s.trackSid});return}this.unpublishTrack(o.track)},this.handleTrackEnded=s=>U(this,void 0,void 0,function*(){if(s.source===Y.Source.ScreenShare||s.source===Y.Source.ScreenShareAudio)L.debug("unpublishing local track due to TrackEnded",{track:s.sid}),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(s instanceof Xn||s instanceof Sr)try{if(pr())try{const o=yield navigator==null?void 0:navigator.permissions.query({name:s.source===Y.Source.Camera?"camera":"microphone"});if(o&&o.state==="denied")throw L.warn("user has revoked access to ".concat(s.source)),o.onchange=()=>{o.state!=="denied"&&(s.isMuted||s.restartTrack(),o.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}s.isMuted||(L.debug("track ended, attempting to use a different device"),yield s.restartTrack())}catch{L.warn("could not restart track, muting instead"),yield s.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==An.NONE}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(ge.RemoteMute,(n,r)=>{const i=this.tracks.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(ge.Connected,this.handleReconnected).on(ge.SignalRestarted,this.handleReconnected).on(ge.SignalResumed,this.handleReconnected).on(ge.Restarting,this.handleReconnecting).on(ge.Resuming,this.handleReconnecting).on(ge.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(ge.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(ge.Disconnected,this.handleDisconnected)}setMetadata(e){var n;this.engine.client.sendUpdateLocalMetadata(e,(n=this.name)!==null&&n!==void 0?n:"")}setName(e){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",e)}setCameraEnabled(e,n,r){return this.setTrackEnabled(Y.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(Y.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(Y.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(oe.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return U(this,void 0,void 0,function*(){this.encryptionType=e?An.GCM:An.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){var s,o;return U(this,void 0,void 0,function*(){L.debug("setTrackEnabled",{source:e,enabled:n});let a=this.getTrack(e);if(n)if(a)yield a.unmute();else{let c;if(this.pendingPublishing.has(e)){L.info("skipping duplicate published source",{source:e});return}this.pendingPublishing.add(e);try{switch(e){case Y.Source.Camera:c=yield this.createTracks({video:(s=r)!==null&&s!==void 0?s:!0});break;case Y.Source.Microphone:c=yield this.createTracks({audio:(o=r)!==null&&o!==void 0?o:!0});break;case Y.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},r));break;default:throw new Bi(e)}const l=[];for(const d of c)L.info("publishing track",{localTrack:d}),l.push(this.publishTrack(d,i));[a]=yield Promise.all(l)}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l instanceof Error&&!(l instanceof Bi)&&this.emit(oe.MediaDevicesError,l),l}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===Y.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const c=this.getTrack(Y.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return U(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Y.Source.Camera)||this.pendingPublishing.has(Y.Source.Microphone))){this.pendingPublishing.add(Y.Source.Camera),this.pendingPublishing.add(Y.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(Y.Source.Camera),this.pendingPublishing.delete(Y.Source.Microphone)}}})}createTracks(e){var n,r;return U(this,void 0,void 0,function*(){const i=fN(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),s=wm(i);let o;try{o=yield navigator.mediaDevices.getUserMedia(s)}catch(a){throw a instanceof Error&&(s.audio&&(this.microphoneError=a),s.video&&(this.cameraError=a)),a}return s.audio&&(this.microphoneError=void 0,this.emit(oe.AudioStreamAcquired)),s.video&&(this.cameraError=void 0),o.getTracks().map(a=>{const c=a.kind==="audio";c?e.audio:e.video;let l;const u=c?s.audio:s.video;typeof u!="boolean"&&(l=u);const d=wN(a,l);return d.kind===Y.Kind.Video?d.source=Y.Source.Camera:d.kind===Y.Kind.Audio&&(d.source=Y.Source.Microphone),d.mediaStream=o,d})})}createScreenTracks(e){return U(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new yI("getDisplayMedia not supported");const n=RW(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new Bi("no video track found");const s=new Sr(i[0],void 0,!1);s.source=Y.Source.ScreenShare;const o=[s];if(r.getAudioTracks().length>0){this.emit(oe.AudioStreamAcquired);const a=new Xn(r.getAudioTracks()[0],void 0,!1,this.audioContext);a.source=Y.Source.ScreenShareAudio,o.push(a)}return o})}publishTrack(e,n){var r,i,s,o;return U(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,e instanceof Dl&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let a;if(e instanceof MediaStreamTrack)a=e.getConstraints();else{a=e.constraints;let h;switch(e.source){case Y.Source.Microphone:h="audioinput";break;case Y.Source.Camera:h="videoinput"}h&&this.activeDeviceMap.has(h)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(h)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new Xn(e,a,!0,this.audioContext);break;case"video":e=new Sr(e,a,!0);break;default:throw new Bi("unsupported MediaStreamTrack kind ".concat(e.kind))}e instanceof Xn&&e.setAudioContext(this.audioContext);let c;if(this.tracks.forEach(h=>{h.track&&h.track===e&&(c=h)}),c)return L.warn("track has already been published, skipping"),c;const l="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,u=(i=n==null?void 0:n.forceStereo)!==null&&i!==void 0?i:l;u&&(n||(n={}),n.dtx===void 0&&L.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work."),n.red===void 0&&L.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(s=n.dtx)!==null&&s!==void 0||(n.dtx=!1),(o=n.red)!==null&&o!==void 0||(n.red=!1));const d=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);qa()&&this.roomOptions.e2ee&&(L.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari"),d.simulcast=!1),d.source&&(e.source=d.source);const f=this.publish(e,d,u);this.pendingPublishPromises.set(e,f);try{return yield f}catch(h){throw h}finally{this.pendingPublishPromises.delete(e)}})}publish(e,n,r){var i,s,o,a,c,l,u,d,f,h,p,g,y;return U(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(_=>e instanceof Dl&&_.source===e.source)&&e.source!==Y.Source.Unknown&&L.info("publishing a second track with the same source: ".concat(e.source)),n.stopMicTrackOnMute&&e instanceof Xn&&(e.stopOnMute=!0),e.source===Y.Source.ScreenShare&&xl()&&(n.simulcast=!1),n.videoCodec==="av1"&&!xW()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!DW()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=l0);const v=n.videoCodec;e.on(fe.Muted,this.onTrackMuted),e.on(fe.Unmuted,this.onTrackUnmuted),e.on(fe.Ended,this.handleTrackEnded),e.on(fe.UpstreamPaused,this.onTrackUpstreamPaused),e.on(fe.UpstreamResumed,this.onTrackUpstreamResumed);const S=new mi({cid:e.mediaStreamTrack.id,name:n.name,type:Y.kindToProto(e.kind),muted:e.isMuted,source:Y.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((s=n.red)!==null&&s!==void 0)||s),stream:n==null?void 0:n.stream});let E;if(e.kind===Y.Kind.Video){let _={width:0,height:0};try{_=yield e.waitForDimensions()}catch{const M=(a=(o=this.roomOptions.videoCaptureDefaults)===null||o===void 0?void 0:o.resolution)!==null&&a!==void 0?a:Dd.h720.resolution;_={width:M.width,height:M.height},L.error("could not determine track dimensions, using defaults",_)}S.width=_.width,S.height=_.height,e instanceof Sr&&(Qu(v)&&(e.source===Y.Source.ScreenShare&&v==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(c=n.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),S.simulcastCodecs=[new pi({codec:v,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:l0}),n.backupCodec&&v!==n.backupCodec.codec&&S.encryption===An.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),S.simulcastCodecs.push(new pi({codec:n.backupCodec.codec,cid:""})))),E=d0(e.source===Y.Source.ScreenShare,S.width,S.height,n),S.layers=mA(S.width,S.height,E,Qu(n.videoCodec))}else e.kind===Y.Kind.Audio&&(E=[{maxBitrate:(u=(l=n.audioPreset)===null||l===void 0?void 0:l.maxBitrate)!==null&&u!==void 0?u:n.audioBitrate,priority:(f=(d=n.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&f!==void 0?f:"high",networkPriority:(p=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new Yt("cannot publish track when not connected");const A=yield this.engine.addTrack(S);let b;if(A.codecs.forEach(_=>{b===void 0&&(b=_.mimeType)}),b&&e.kind===Y.Kind.Video){const _=hN(b);_!==v&&(L.debug("falling back to server selected codec",{codec:_}),n.videoCodec=_,E=d0(e.source===Y.Source.ScreenShare,S.width,S.height,n))}const k=new Od(e.kind,A,e);if(k.options=n,e.sid=A.sid,!this.engine.pcManager)throw new Yt("pcManager is not ready");if(L.debug("publishing ".concat(e.kind," with encodings"),{encodings:E,trackInfo:A}),e.sender=yield this.engine.createSender(e,n,E),E)if(xl()&&e.kind===Y.Kind.Audio){let _;for(const N of this.engine.pcManager.publisher.getTransceivers())if(N.sender===e.sender){_=N;break}_&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:_,codec:"opus",maxbr:!((g=E[0])===null||g===void 0)&&g.maxBitrate?E[0].maxBitrate/1e3:0})}else e.codec&&Qu(e.codec)&&(!((y=E[0])===null||y===void 0)&&y.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:S.cid,codec:e.codec,maxbr:E[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof Sr?e.startMonitor(this.engine.client):e instanceof Xn&&e.startMonitor(),this.addTrackPublication(k),this.emit(oe.LocalTrackPublished,k),k})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){var i;return U(this,void 0,void 0,function*(){if(this.encryptionType!==An.NONE)return;let s;if(this.tracks.forEach(d=>{d.track&&d.track===e&&(s=d)}),!s)throw new Bi("track is not published");if(!(e instanceof Sr))throw new Bi("track is not a video track");const o=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=v6(e,n,o);if(!a){L.info("backup codec has been disabled, ignoring request to add additional codec for track");return}const c=e.addSimulcastTrack(n,a),l=new mi({cid:c.mediaStreamTrack.id,type:Y.kindToProto(e.kind),muted:e.isMuted,source:Y.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:c.mediaStreamTrack.id}]});if(l.layers=mA(l.width,l.height,a),!this.engine||this.engine.isClosed)throw new Yt("cannot publish track when not connected");const u=yield this.engine.addTrack(l);yield this.engine.createSimulcastSender(e,c,o,a),yield this.engine.negotiate(),L.debug("published ".concat(n," for track ").concat(e.sid),{encodings:a,trackInfo:u})})}unpublishTrack(e,n){var r,i;return U(this,void 0,void 0,function*(){const s=this.getPublicationForTrack(e);if(L.debug("unpublishing track",{track:e,method:"unpublishTrack"}),!s||!s.track){L.warn("track was not unpublished because no publication was found",{track:e,method:"unpublishTrack"});return}e=s.track,e.off(fe.Muted,this.onTrackMuted),e.off(fe.Unmuted,this.onTrackUnmuted),e.off(fe.Ended,this.handleTrackEnded),e.off(fe.UpstreamPaused,this.onTrackUpstreamPaused),e.off(fe.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n&&e.stop();let o=!1;const a=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Qt.FAILED&&a)try{for(const c of this.engine.pcManager.publisher.getTransceivers())c.sender===a&&(c.direction="inactive",o=!0);if(this.engine.removeTrack(a)&&(o=!0),e instanceof Sr){for(const[,c]of e.simulcastCodecs)c.sender&&(this.engine.removeTrack(c.sender)&&(o=!0),c.sender=void 0);e.simulcastCodecs.clear()}}catch(c){L.warn("failed to unpublish track",{error:c,method:"unpublishTrack"})}switch(this.tracks.delete(s.trackSid),s.kind){case Y.Kind.Audio:this.audioTracks.delete(s.trackSid);break;case Y.Kind.Video:this.videoTracks.delete(s.trackSid);break}return this.emit(oe.LocalTrackUnpublished,s),s.setTrack(void 0),o&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return U(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof Od)})}republishAllTracks(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return U(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(e&&(i.options=Object.assign(Object.assign({},i.options),e)),r.push(i))}),yield Promise.all(r.map(i=>U(this,void 0,void 0,function*(){const s=i.track;yield this.unpublishTrack(s,!1),n&&!s.isMuted&&(s instanceof Xn||s instanceof Sr)&&!s.isUserProvided&&(L.debug("restarting existing track",{track:i.trackSid}),yield s.restartTrack()),yield this.publishTrack(s,i.options)})))})}publishData(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return U(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,s=[],o=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(c=>{c instanceof Ld?s.push(c.sid):s.push(c)});const a=new Wi({kind:n,value:{case:"user",value:new Zi({participantSid:this.sid,payload:e,destinationSids:s,topic:o})}});yield this.engine.sendDataPacket(a,n)})}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const s=this.tracks.get(n.sid);if(s){const o=s.isMuted||((i=(r=s.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);o!==n.muted&&(L.debug("updating server mute state after reconcile",{sid:n.sid,muted:o}),this.engine.client.sendMuteTrack(n.sid,o))}}),!0)}getPublicationForTrack(e){let n;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof Xn||i instanceof Sr)&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}}var Ke;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting"})(Ke||(Ke={}));const A6=2*1e3;class Rp extends vs.EventEmitter{constructor(e){var n,r;super(),n=this,this.state=Ke.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.connect=(i,s,o)=>U(this,void 0,void 0,function*(){var a;const c=yield this.disconnectLock.lock();if(this.state===Ke.Connected)return L.info("already connected to room ".concat(this.name)),c(),Promise.resolve();if(this.connectFuture)return c(),this.connectFuture.promise;this.setAndEmitConnectionState(Ke.Connecting),((a=this.regionUrlProvider)===null||a===void 0?void 0:a.getServerUrl().toString())!==i&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),c0(new URL(i))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new dA(i,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().catch(d=>{L.warn("could not fetch region settings",{error:d})}));const l=(d,f,h)=>U(this,void 0,void 0,function*(){var p;this.abortController&&this.abortController.abort();const g=new AbortController;this.abortController=g,c==null||c();try{yield this.attemptConnection(h??i,s,o,g),this.abortController=void 0,d()}catch(y){if(this.regionUrlProvider&&y instanceof Rt&&y.reason!==3&&y.reason!==0){let m=null;try{m=yield this.regionUrlProvider.getNextBestRegionUrl((p=this.abortController)===null||p===void 0?void 0:p.signal)}catch(v){if(v instanceof Rt&&(v.status===401||v.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(v);return}}m?(L.info("Initial connection failed with ConnectionError: ".concat(y.message,". Retrying with another region: ").concat(m)),yield l(d,f,m)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(y))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(y)}}),u=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new vN((d,f)=>{l(d,f,u)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(i,s,o,a,c,l)=>U(this,void 0,void 0,function*(){const u=yield o.join(i,s,{autoSubscribe:a.autoSubscribe,publishOnly:a.publishOnly,adaptiveStream:typeof c.adaptiveStream=="object"?!0:c.adaptiveStream,maxRetries:a.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:a.websocketTimeout},l.signal);let d=u.serverInfo;if(d||(d={version:u.serverVersion,region:u.serverRegion}),L.debug("connected to Livekit Server ".concat(Object.entries(d).map(f=>{let[h,p]=f;return"".concat(h,": ").concat(p)}).join(", "))),!u.serverVersion)throw new vW("unknown server version");return u.serverVersion==="0.15.1"&&this.options.dynacast&&(L.debug("disabling dynacast due to server version"),c.dynacast=!1),u}),this.applyJoinResponse=i=>{const s=i.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...i.otherParticipants]),i.room&&this.handleRoomUpdate(i.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(i.sifTrailer)},this.attemptConnection=(i,s,o,a)=>U(this,void 0,void 0,function*(){var c,l;this.state===Ke.Reconnecting?(L.info("Reconnection attempt replaced by new connection attempt"),this.recreateEngine()):this.maybeCreateEngine(),!((c=this.regionUrlProvider)===null||c===void 0)&&c.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},wI),o),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const u=yield this.connectSignal(i,s,this.engine,this.connOptions,this.options,a);this.applyJoinResponse(u),this.setupLocalParticipantEvents(),this.emit(ne.SignalConnected)}catch(u){yield this.engine.close(),this.recreateEngine();const d=new Rt("could not establish signal connection");throw u instanceof Error&&(d.message="".concat(d.message,": ").concat(u.message)),u instanceof Rt&&(d.reason=u.reason,d.status=u.status),L.debug("error trying to establish signal connection",{error:u}),d}if(a.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Rt("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,a)}catch(u){throw yield this.engine.close(),this.recreateEngine(),u}pr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),pr()&&(document.addEventListener("freeze",this.onPageLeave),(l=navigator.mediaDevices)===null||l===void 0||l.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(Ke.Connected),this.emit(ne.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return U(n,void 0,void 0,function*(){var s,o,a,c;const l=yield this.disconnectLock.lock();try{if(this.state===Ke.Disconnected){L.debug("already disconnected");return}L.info("disconnect from room",{identity:this.localParticipant.identity}),(this.state===Ke.Connecting||this.state===Ke.Reconnecting)&&(L.warn("abort connection attempt"),(s=this.abortController)===null||s===void 0||s.abort(),(a=(o=this.connectFuture)===null||o===void 0?void 0:o.reject)===null||a===void 0||a.call(o,new Rt("Client initiated disconnect")),this.connectFuture=void 0),!((c=this.engine)===null||c===void 0)&&c.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(i,to.CLIENT_INITIATED),this.engine=void 0}finally{l()}})},this.onPageLeave=()=>U(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>U(this,void 0,void 0,function*(){const i=[],s=ca();if(s&&s.os==="iOS"){const o="livekit-dummy-audio-el";let a=document.getElementById(o);if(!a){a=document.createElement("audio"),a.id=o,a.autoplay=!0,a.hidden=!0;const c=Qg();c.enabled=!0;const l=new MediaStream([c]);a.srcObject=l,document.addEventListener("visibilitychange",()=>{a&&(a.srcObject=document.hidden?null:l)}),document.body.append(a),this.once(ne.Disconnected,()=>{a==null||a.remove()})}i.push(a)}this.participants.forEach(o=>{o.audioTracks.forEach(a=>{a.track&&a.track.attachedElements.forEach(c=>{i.push(c)})})});try{yield Promise.all([this.acquireAudioContext(),...i.map(o=>(o.muted=!1,o.play()))]),this.handleAudioPlaybackStarted()}catch(o){throw this.handleAudioPlaybackFailed(o),o}}),this.startVideo=()=>U(this,void 0,void 0,function*(){const i=[];for(const s of this.participants.values())s.videoTracks.forEach(o=>{var a;(a=o.track)===null||a===void 0||a.attachedElements.forEach(c=>{i.includes(c)||i.push(c)})});yield Promise.all(i.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():L.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler")})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const i of this.participants.values())this.handleParticipantDisconnected(i.sid,i);this.setAndEmitConnectionState(Ke.Reconnecting)&&this.emit(ne.Reconnecting)},this.handleSignalRestarted=i=>U(this,void 0,void 0,function*(){L.debug("signal reconnected to server",{region:i.serverRegion}),this.cachedParticipantSids=[],this.applyJoinResponse(i);try{const s=[];this.localParticipant.tracks.forEach(o=>{o.track&&s.push(o)}),yield Promise.all(s.map(o=>U(this,void 0,void 0,function*(){const a=o.track;this.localParticipant.unpublishTrack(a,!1),a.isMuted||((a instanceof Xn||a instanceof Sr)&&a.source!==Y.Source.ScreenShare&&a.source!==Y.Source.ScreenShareAudio&&!a.isUserProvided&&(L.debug("restarting existing track",{track:o.trackSid}),yield a.restartTrack()),L.debug("publishing new track",{track:o.trackSid}),yield this.localParticipant.publishTrack(a,o.options))})))}catch(s){L.error("error trying to re-publish tracks after reconnection",{error:s})}try{yield this.engine.waitForRestarted(),L.debug("fully reconnected to server",{region:i.serverRegion})}catch{return}this.setAndEmitConnectionState(Ke.Connected),this.emit(ne.Reconnected),this.registerConnectionReconcile(),this.participants.forEach(s=>{this.emit(ne.ParticipantConnected,s)})}),this.handleParticipantUpdates=i=>{i.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const o=this.identityToSid.get(s.identity);o&&o!==s.sid&&this.handleParticipantDisconnected(o,this.participants.get(o));let a=this.participants.get(s.sid);const c=!a;s.state===Ja.DISCONNECTED?this.handleParticipantDisconnected(s.sid,a):(a=this.getOrCreateParticipant(s.sid,s),c||a.updateInfo(s))})},this.handleActiveSpeakersUpdate=i=>{const s=[],o={};i.forEach(a=>{if(o[a.sid]=!0,a.sid===this.localParticipant.sid)this.localParticipant.audioLevel=a.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const c=this.participants.get(a.sid);c&&(c.audioLevel=a.level,c.setIsSpeaking(!0),s.push(c))}}),o[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(a=>{o[a.sid]||(a.audioLevel=0,a.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(ne.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=i=>{const s=new Map;this.activeSpeakers.forEach(a=>{s.set(a.sid,a)}),i.forEach(a=>{let c=this.participants.get(a.sid);a.sid===this.localParticipant.sid&&(c=this.localParticipant),c&&(c.audioLevel=a.level,c.setIsSpeaking(a.active),a.active?s.set(a.sid,c):s.delete(a.sid))});const o=Array.from(s.values());o.sort((a,c)=>c.audioLevel-a.audioLevel),this.activeSpeakers=o,this.emitWhenConnected(ne.ActiveSpeakersChanged,o)},this.handleStreamStateUpdate=i=>{i.streamStates.forEach(s=>{const o=this.participants.get(s.participantSid);if(!o)return;const a=o.getTrackPublication(s.trackSid);!a||!a.track||(a.track.streamState=Y.streamStateFromProto(s.state),o.emit(oe.TrackStreamStateChanged,a,a.track.streamState),this.emitWhenConnected(ne.TrackStreamStateChanged,a,a.track.streamState,o))})},this.handleSubscriptionPermissionUpdate=i=>{const s=this.participants.get(i.participantSid);if(!s)return;const o=s.getTrackPublication(i.trackSid);o&&o.setAllowed(i.allowed)},this.handleSubscriptionError=i=>{const s=Array.from(this.participants.values()).find(a=>a.tracks.has(i.trackSid));if(!s)return;const o=s.getTrackPublication(i.trackSid);o&&o.setSubscriptionError(i.err)},this.handleDataPacket=(i,s)=>{const o=this.participants.get(i.participantSid);this.emit(ne.DataReceived,i.payload,o,s,i.topic),o==null||o.emit(oe.DataReceived,i.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ne.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=i=>{L.warn("could not playback audio",i),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ne.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ne.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ne.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>U(this,void 0,void 0,function*(){this.emit(ne.MediaDevicesChanged)}),this.handleRoomUpdate=i=>{const s=this.roomInfo;this.roomInfo=i,s&&s.metadata!==i.metadata&&this.emitWhenConnected(ne.RoomMetadataChanged,i.metadata),(s==null?void 0:s.activeRecording)!==i.activeRecording&&this.emitWhenConnected(ne.RecordingStatusChanged,i.activeRecording)},this.handleConnectionQualityUpdate=i=>{i.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const o=this.participants.get(s.participantSid);o&&o.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=i=>{this.emit(ne.ParticipantMetadataChanged,i,this.localParticipant)},this.onLocalParticipantNameChanged=i=>{this.emit(ne.ParticipantNameChanged,i,this.localParticipant)},this.onLocalTrackMuted=i=>{this.emit(ne.TrackMuted,i,this.localParticipant)},this.onLocalTrackUnmuted=i=>{this.emit(ne.TrackUnmuted,i,this.localParticipant)},this.onLocalTrackPublished=i=>U(this,void 0,void 0,function*(){var s;this.emit(ne.LocalTrackPublished,i,this.localParticipant),i.track instanceof Xn&&(yield i.track.checkForSilence())&&this.emit(ne.LocalAudioSilenceDetected,i);const o=yield(s=i.track)===null||s===void 0?void 0:s.getDeviceId(),a=_W(i.source);a&&o&&o!==this.localParticipant.activeDeviceMap.get(a)&&(this.localParticipant.activeDeviceMap.set(a,o),this.emit(ne.ActiveDeviceChanged,a,o))}),this.onLocalTrackUnpublished=i=>{this.emit(ne.LocalTrackUnpublished,i,this.localParticipant)},this.onLocalConnectionQualityChanged=i=>{this.emit(ne.ConnectionQualityChanged,i,this.localParticipant)},this.onMediaDevicesError=i=>{this.emit(ne.MediaDevicesError,i)},this.onLocalParticipantPermissionsChanged=i=>{this.emit(ne.ParticipantPermissionsChanged,i,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.cachedParticipantSids=[],this.identityToSid=new Map,this.options=Object.assign(Object.assign({},o6),e),this.options.audioCaptureDefaults=Object.assign(Object.assign({},SN),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},bN),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},s6),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new bi,this.localParticipant=new f0("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Ga(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Ga(this.options.audioCaptureDefaults.deviceId)),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&this.switchActiveDevice("audiooutput",Ga(this.options.audioOutput.deviceId)).catch(i=>L.warn("Could not set audio output: ".concat(i.message))),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return U(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new jW(this.options.e2ee),this.e2eeManager.on(Ho.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof f0&&(this.isE2EEEnabled=n),this.emit(ne.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(Ho.EncryptionError,n=>this.emit(ne.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&n!==void 0?n:""}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new l6(this.options),this.engine.on(ge.ParticipantUpdate,this.handleParticipantUpdates).on(ge.RoomUpdate,this.handleRoomUpdate).on(ge.SpeakersChanged,this.handleSpeakersChanged).on(ge.StreamStateChanged,this.handleStreamStateUpdate).on(ge.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(ge.SubscriptionError,this.handleSubscriptionError).on(ge.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(ge.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(ge.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(ge.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(ge.DataPacketReceived,this.handleDataPacket).on(ge.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(Ke.Reconnecting)&&this.emit(ne.Reconnecting),this.cachedParticipantSids=Array.from(this.participants.keys())}).on(ge.Resumed,()=>{this.setAndEmitConnectionState(Ke.Connected),this.emit(ne.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),Array.from(this.participants.values()).filter(n=>!this.cachedParticipantSids.includes(n.sid)).forEach(n=>this.emit(ne.ParticipantConnected,n)),this.cachedParticipantSids=[]}).on(ge.SignalResumed,()=>{this.state===Ke.Reconnecting&&this.sendSyncState()}).on(ge.Restarting,this.handleRestarting).on(ge.SignalRestarted,this.handleSignalRestarted).on(ge.DCBufferStatusChanged,(e,n)=>{this.emit(ne.DCBufferStatusChanged,e,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Yn.getInstance().getDevices(e,n)}prepareConnection(e,n){return U(this,void 0,void 0,function*(){if(this.state===Ke.Disconnected){L.debug("prepareConnection to ".concat(e));try{if(c0(new URL(e))&&n){this.regionUrlProvider=new dA(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===Ke.Disconnected&&(this.regionUrl=r,yield fetch(tA(r),{method:"HEAD"}),L.debug("prepared connection to ".concat(r)))}else yield fetch(tA(e),{method:"HEAD"})}catch(r){L.warn("could not prepare connection",{error:r})}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const n=this.identityToSid.get(e);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return U(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new Jn({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new Jn({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new Jn({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new Jn({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new Jn({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>U(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new Wr({reason:to.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new Jn({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}i&&(this.engine.client.sendSimulateScenario(i),r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,n;return(n=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,s,o;return U(this,void 0,void 0,function*(){let a=!1,c=!0;const l=r?{exact:n}:n;if(e==="audioinput"){const u=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.audioTracks.values()).filter(f=>f.source===Y.Source.Microphone);try{c=(yield Promise.all(d.map(f=>{var h;return(h=f.audioTrack)===null||h===void 0?void 0:h.setDeviceId(l)}))).every(f=>f===!0)}catch(f){throw this.options.audioCaptureDefaults.deviceId=u,f}}else if(e==="videoinput"){const u=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.videoTracks.values()).filter(f=>f.source===Y.Source.Camera);try{c=(yield Promise.all(d.map(f=>{var h;return(h=f.videoTrack)===null||h===void 0?void 0:h.setDeviceId(l)}))).every(f=>f===!0)}catch(f){throw this.options.videoCaptureDefaults.deviceId=u,f}}else if(e==="audiooutput"){if(!a0()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(o=this.options).audioOutput)!==null&&i!==void 0||(o.audioOutput={});const u=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,a=u!==l;try{this.options.expWebAudioMix?(s=this.audioContext)===null||s===void 0||s.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(d=>d.setAudioOutput({deviceId:n})))}catch(d){throw this.options.audioOutput.deviceId=u,d}}return a&&c&&(this.localParticipant.activeDeviceMap.set(e,n),this.emit(ne.ActiveDeviceChanged,e,n)),c})}setupLocalParticipantEvents(){this.localParticipant.on(oe.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(oe.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(oe.TrackMuted,this.onLocalTrackMuted).on(oe.TrackUnmuted,this.onLocalTrackUnmuted).on(oe.LocalTrackPublished,this.onLocalTrackPublished).on(oe.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(oe.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(oe.MediaDevicesError,this.onMediaDevicesError).on(oe.AudioStreamAcquired,this.startAudio).on(oe.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===Ke.Connecting||this.state===Ke.Reconnecting){const u=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(ne.Reconnected,u),this.off(ne.Connected,u),this.off(ne.Disconnected,d)};this.once(ne.Reconnected,u),this.once(ne.Connected,u),this.once(ne.Disconnected,d);return}if(this.state===Ke.Disconnected){L.warn("skipping incoming track after Room disconnected");return}const i=MW(n.id),s=i[0];let o=i[1],a=e.id;if(o&&o.startsWith("TR")&&(a=o),s===this.localParticipant.sid){L.warn("tried to create RemoteParticipant for local participant");return}const c=this.participants.get(s);if(!c){L.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s));return}let l;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?l=this.options.adaptiveStream:l={}),c.addSubscribedMediaTrack(e,a,n,r,l)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.state!==Ke.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(s=>{i.unpublishTrack(s.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var s,o;i.track&&this.localParticipant.unpublishTrack(i.track,e),e&&((s=i.track)===null||s===void 0||s.detach(),(o=i.track)===null||o===void 0||o.stop())}),this.localParticipant.off(oe.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(oe.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(oe.TrackMuted,this.onLocalTrackMuted).off(oe.TrackUnmuted,this.onLocalTrackUnmuted).off(oe.LocalTrackPublished,this.onLocalTrackPublished).off(oe.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(oe.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(oe.MediaDevicesError,this.onMediaDevicesError).off(oe.AudioStreamAcquired,this.startAudio).off(oe.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),pr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ke.Disconnected),this.emit(ne.Disconnected,n)}}}handleParticipantDisconnected(e,n){this.participants.delete(e),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(ne.ParticipantDisconnected,n))}acquireAudioContext(){var e,n;return U(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=II())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){L.warn(i)}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(ne.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=Ld.fromParticipantInfo(this.engine.client,n):i=new Ld(this.engine.client,e,"",void 0,void 0),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(s=>L.warn("Could not set audio output: ".concat(s.message))),i}getOrCreateParticipant(e,n){if(this.participants.has(e))return this.participants.get(e);const r=this.createParticipant(e,n);return this.participants.set(e,r),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(ne.ParticipantConnected,r),r.on(oe.TrackPublished,i=>{this.emitWhenConnected(ne.TrackPublished,i,r)}).on(oe.TrackSubscribed,(i,s)=>{i.kind===Y.Kind.Audio?(i.on(fe.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(fe.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===Y.Kind.Video&&(i.on(fe.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(fe.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ne.TrackSubscribed,i,s,r)}).on(oe.TrackUnpublished,i=>{this.emit(ne.TrackUnpublished,i,r)}).on(oe.TrackUnsubscribed,(i,s)=>{this.emit(ne.TrackUnsubscribed,i,s,r)}).on(oe.TrackSubscriptionFailed,i=>{this.emit(ne.TrackSubscriptionFailed,i,r)}).on(oe.TrackMuted,i=>{this.emitWhenConnected(ne.TrackMuted,i,r)}).on(oe.TrackUnmuted,i=>{this.emitWhenConnected(ne.TrackUnmuted,i,r)}).on(oe.ParticipantMetadataChanged,i=>{this.emitWhenConnected(ne.ParticipantMetadataChanged,i,r)}).on(oe.ParticipantNameChanged,i=>{this.emitWhenConnected(ne.ParticipantNameChanged,i,r)}).on(oe.ConnectionQualityChanged,i=>{this.emitWhenConnected(ne.ConnectionQualityChanged,i,r)}).on(oe.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(ne.ParticipantPermissionsChanged,i,r)}).on(oe.TrackSubscriptionStatusChanged,(i,s)=>{this.emitWhenConnected(ne.TrackSubscriptionStatusChanged,i,s,r)}).on(oe.TrackSubscriptionFailed,(i,s)=>{this.emit(ne.TrackSubscriptionFailed,i,r,s)}).on(oe.TrackSubscriptionPermissionChanged,(i,s)=>{this.emitWhenConnected(ne.TrackSubscriptionPermissionChanged,i,s,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.participants.values())for(const n of e.videoTracks.values())n.isSubscribed&&n instanceof kI&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=kn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,L.warn("detected connection state mismatch",{numFailures:e}),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,to.STATE_MISMATCH))):e=0},A6)}clearConnectionReconcile(){this.connectionReconcileInterval&&kn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(ne.ConnectionStateChanged,this.state),!0)}emitWhenConnected(e){if(this.state===Ke.Connected){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.emit(e,...r)}return!1}simulateParticipants(e){var n,r;return U(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new eu({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:xe.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Er({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ne.SignalConnected),this.emit(ne.Connected),this.setAndEmitConnectionState(Ke.Connected),i.video){const o=new Od(Y.Kind.Video,new ur({source:Wt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Ln.AUDIO,name:"video-dummy"}),new Sr(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:eA((n=160*s.aspectRatios[0])!==null&&n!==void 0?n:1,160,!0,!0)));this.localParticipant.addTrackPublication(o),this.localParticipant.emit(oe.LocalTrackPublished,o)}if(i.audio){const o=new Od(Y.Kind.Audio,new ur({source:Wt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Ln.AUDIO}),new Xn(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Qg()));this.localParticipant.addTrackPublication(o),this.localParticipant.emit(oe.LocalTrackPublished,o)}for(let o=0;o<s.count-1;o+=1){let a=new Er({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(o),state:Ja.ACTIVE,tracks:[],joinedAt:xe.parse(Date.now())});const c=this.getOrCreateParticipant(a.identity,a);if(s.video){const l=eA((r=160*s.aspectRatios[o%s.aspectRatios.length])!==null&&r!==void 0?r:1,160,!1,!0),u=new ur({source:Wt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Ln.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}if(s.audio){const l=Qg(),u=new ur({source:Wt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Ln.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}c.updateInfo(a)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e!==ne.ActiveSpeakersChanged&&L.debug("room event ".concat(e),{event:e,args:r}),super.emit(e,...r)}}var ui;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(ui||(ui={}));class nu extends vs.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=ui.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Rp(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return U(this,void 0,void 0,function*(){if(this.status!==ui.IDLE)throw Error("check is running already");this.setStatus(ui.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==ui.SKIPPED&&this.setStatus(this.isSuccess()?ui.SUCCESS:ui.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return U(this,void 0,void 0,function*(){return this.room.state===Ke.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return U(this,void 0,void 0,function*(){this.room&&this.room.state!==Ke.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(ui.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function _N(t){var e,n;return U(this,void 0,void 0,function*(){t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio=!0),(n=t.video)!==null&&n!==void 0||(t.video=!0);const r=fN(t,SN,bN),i=wm(r),s=navigator.mediaDevices.getUserMedia(i);t.audio&&(Yn.userMediaPromiseMap.set("audioinput",s),s.catch(()=>Yn.userMediaPromiseMap.delete("audioinput"))),t.video&&(Yn.userMediaPromiseMap.set("videoinput",s),s.catch(()=>Yn.userMediaPromiseMap.delete("videoinput")));const o=yield s;return o.getTracks().map(a=>{const c=a.kind==="audio";c?t.audio:t.video;let l;const u=c?i.audio:i.video;typeof u!="boolean"&&(l=u),l?l.deviceId=a.getSettings().deviceId:l={deviceId:a.getSettings().deviceId};const d=wN(a,l);return d.kind===Y.Kind.Video?d.source=Y.Source.Camera:d.kind===Y.Kind.Audio&&(d.source=Y.Source.Microphone),d.mediaStream=o,d})})}function k6(t){return U(this,void 0,void 0,function*(){return(yield _N({audio:!1,video:t}))[0]})}function E6(t){return U(this,void 0,void 0,function*(){return(yield _N({audio:t,video:!1}))[0]})}class T6 extends nu{get description(){return"Can publish audio"}perform(){var e;return U(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield E6();n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&o.mediaType==="audio"&&(s=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class _6 extends nu{get description(){return"Can publish video"}perform(){var e;return U(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield k6();n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&o.mediaType==="video"&&(s=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}}class R6 extends nu{get description(){return"Resuming connection after interruption"}perform(){var e;return U(this,void 0,void 0,function*(){const n=yield this.connect();let r=!1,i=!1,s;const o=new Promise(c=>{setTimeout(c,5e3),s=c});n.on(ne.Reconnecting,()=>{r=!0}).on(ne.Reconnected,()=>{i=!0,s(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const a=n.engine.client.onClose;if(a&&a(""),yield o,r){if(!i||n.state!==Ke.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class N6 extends nu{get description(){return"Can connect via TURN"}perform(){var e,n;return U(this,void 0,void 0,function*(){const r=new bI,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let s=!1,o=!1,a=!1;for(let c of i.iceServers)for(let l of c.urls)l.startsWith("turn:")?(o=!0,a=!0):l.startsWith("turns:")&&(o=!0,a=!0,s=!0),l.startsWith("stun:")&&(a=!0);a?o&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||o?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(c=>setTimeout(c,0)))})}}class P6 extends nu{get description(){return"Establishing WebRTC connection"}perform(){return U(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(ne.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,s)=>{if(i.candidate){const o=new RTCIceCandidate(i);let a="".concat(o.protocol," ").concat(o.address,":").concat(o.port," ").concat(o.type);o.address&&(M6(o.address)?a+=" (private)":o.protocol==="tcp"&&o.tcpType==="passive"?(e=!0,a+=" (passive)"):o.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,s)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),L.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function M6(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class x6 extends nu{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,n,r;return U(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new bI;const s=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((e=s.serverInfo)===null||e===void 0?void 0:e.edition)===Pl.Cloud&&(!((n=s.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=s.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class GQ extends vs.EventEmitter{constructor(e,n){super(),this.checkResults=new Map,this.url=e,this.token=n}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:ui.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==ui.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return U(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token),i=o=>{this.updateCheck(n,o)};r.on("update",i);const s=yield r.run();return r.off("update",i),s})}checkWebsocket(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(x6)})}checkWebRTC(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(P6)})}checkTURN(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(N6)})}checkReconnect(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(R6)})}checkPublishAudio(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(T6)})}checkPublishVideo(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(_6)})}}function D6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=t instanceof Dl?t.mediaStreamTrack:t,i=r.getSettings();let s={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const o=i.facingMode;L.debug("rawFacingMode",{rawFacingMode:o}),o&&typeof o=="string"&&B6(o)&&(s={facingMode:o,confidence:"high"})}if(["low","medium"].includes(s.confidence)){L.debug("Try to get facing mode from device label: (".concat(r.label,")"));const o=L6(r.label);o!==void 0&&(s=o)}return s}const vA=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),O6=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function L6(t){var e;const n=t.trim().toLowerCase();if(n!=="")return vA.has(n)?vA.get(n):(e=Array.from(O6.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||e===void 0?void 0:e[1]}function B6(t){return t===void 0||["user","environment","left","right"].includes(t)}const h0=Math.min,dl=Math.max,Np=Math.round,la=t=>({x:t,y:t}),F6={left:"right",right:"left",bottom:"top",top:"bottom"},U6={start:"end",end:"start"};function yA(t,e,n){return dl(t,h0(e,n))}function km(t,e){return typeof t=="function"?t(e):t}function ec(t){return t.split("-")[0]}function Em(t){return t.split("-")[1]}function RN(t){return t==="x"?"y":"x"}function NN(t){return t==="y"?"height":"width"}function Tm(t){return["top","bottom"].includes(ec(t))?"y":"x"}function PN(t){return RN(Tm(t))}function G6(t,e,n){n===void 0&&(n=!1);const r=Em(t),i=PN(t),s=NN(i);let o=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=Pp(o)),[o,Pp(o)]}function V6(t){const e=Pp(t);return[p0(t),e,p0(e)]}function p0(t){return t.replace(/start|end/g,e=>U6[e])}function W6(t,e,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?s:o;default:return[]}}function H6(t,e,n,r){const i=Em(t);let s=W6(ec(t),n==="start",r);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(p0)))),s}function Pp(t){return t.replace(/left|right|bottom|top/g,e=>F6[e])}function Z6(t){return{top:0,right:0,bottom:0,left:0,...t}}function j6(t){return typeof t!="number"?Z6(t):{top:t,right:t,bottom:t,left:t}}function Mp(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function CA(t,e,n){let{reference:r,floating:i}=t;const s=Tm(e),o=PN(e),a=NN(o),c=ec(e),l=s==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[a]/2-i[a]/2;let h;switch(c){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-i.width,y:d};break;default:h={x:r.x,y:r.y}}switch(Em(e)){case"start":h[o]-=f*(n&&l?-1:1);break;case"end":h[o]+=f*(n&&l?-1:1);break}return h}const z6=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let l=await o.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=CA(l,r,c),f=r,h={},p=0;for(let g=0;g<a.length;g++){const{name:y,fn:m}=a[g],{x:v,y:S,data:E,reset:A}=await m({x:u,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:h,rects:l,platform:o,elements:{reference:t,floating:e}});if(u=v??u,d=S??d,h={...h,[y]:{...h[y],...E}},A&&p<=50){p++,typeof A=="object"&&(A.placement&&(f=A.placement),A.rects&&(l=A.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:i}):A.rects),{x:u,y:d}=CA(l,f,c)),g=-1;continue}}return{x:u,y:d,placement:f,strategy:i,middlewareData:h}};async function MN(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=km(e,t),p=j6(h),y=a[f?d==="floating"?"reference":"floating":d],m=Mp(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(y)))==null||n?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),v=d==="floating"?{...o.floating,x:r,y:i}:o.reference,S=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),E=await(s.isElement==null?void 0:s.isElement(S))?await(s.getScale==null?void 0:s.getScale(S))||{x:1,y:1}:{x:1,y:1},A=Mp(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:v,offsetParent:S,strategy:c}):v);return{top:(m.top-A.top+p.top)/E.y,bottom:(A.bottom-m.bottom+p.bottom)/E.y,left:(m.left-A.left+p.left)/E.x,right:(A.right-m.right+p.right)/E.x}}const X6=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...y}=km(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const m=ec(i),v=ec(a)===a,S=await(c.isRTL==null?void 0:c.isRTL(l.floating)),E=f||(v||!g?[Pp(a)]:V6(a));!f&&p!=="none"&&E.push(...H6(a,g,p,S));const A=[a,...E],b=await MN(e,y),k=[];let _=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&k.push(b[m]),d){const B=G6(i,o,S);k.push(b[B[0]],b[B[1]])}if(_=[..._,{placement:i,overflows:k}],!k.every(B=>B<=0)){var N,M;const B=(((N=s.flip)==null?void 0:N.index)||0)+1,G=A[B];if(G)return{data:{index:B,overflows:_},reset:{placement:G}};let V=(M=_.filter(z=>z.overflows[0]<=0).sort((z,X)=>z.overflows[1]-X.overflows[1])[0])==null?void 0:M.placement;if(!V)switch(h){case"bestFit":{var D;const z=(D=_.map(X=>[X.placement,X.overflows.filter(te=>te>0).reduce((te,H)=>te+H,0)]).sort((X,te)=>X[1]-te[1])[0])==null?void 0:D[0];z&&(V=z);break}case"initialPlacement":V=a;break}if(i!==V)return{reset:{placement:V}}}return{}}}};async function $6(t,e){const{placement:n,platform:r,elements:i}=t,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=ec(n),a=Em(n),c=Tm(n)==="y",l=["left","top"].includes(o)?-1:1,u=s&&c?-1:1,d=km(e,t);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),c?{x:h*u,y:f*l}:{x:f*l,y:h*u}}const K6=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:s,placement:o,middlewareData:a}=e,c=await $6(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+c.x,y:s+c.y,data:{...c,placement:o}}}}},J6=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:y=>{let{x:m,y:v}=y;return{x:m,y:v}}},...c}=km(t,e),l={x:n,y:r},u=await MN(e,c),d=Tm(ec(i)),f=RN(d);let h=l[f],p=l[d];if(s){const y=f==="y"?"top":"left",m=f==="y"?"bottom":"right",v=h+u[y],S=h-u[m];h=yA(v,h,S)}if(o){const y=d==="y"?"top":"left",m=d==="y"?"bottom":"right",v=p+u[y],S=p-u[m];p=yA(v,p,S)}const g=a.fn({...e,[f]:h,[d]:p});return{...g,data:{x:g.x-n,y:g.y-r}}}}};function ua(t){return xN(t)?(t.nodeName||"").toLowerCase():"#document"}function _r(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Ia(t){var e;return(e=(xN(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function xN(t){return t instanceof Node||t instanceof _r(t).Node}function co(t){return t instanceof Element||t instanceof _r(t).Element}function fs(t){return t instanceof HTMLElement||t instanceof _r(t).HTMLElement}function IA(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof _r(t).ShadowRoot}function pf(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Xr(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function Y6(t){return["table","td","th"].includes(ua(t))}function EI(t){const e=TI(),n=Xr(t);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function q6(t){let e=Ol(t);for(;fs(e)&&!_m(e);){if(EI(e))return e;e=Ol(e)}return null}function TI(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function _m(t){return["html","body","#document"].includes(ua(t))}function Xr(t){return _r(t).getComputedStyle(t)}function Rm(t){return co(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Ol(t){if(ua(t)==="html")return t;const e=t.assignedSlot||t.parentNode||IA(t)&&t.host||Ia(t);return IA(e)?e.host:e}function DN(t){const e=Ol(t);return _m(e)?t.ownerDocument?t.ownerDocument.body:t.body:fs(e)&&pf(e)?e:DN(e)}function m0(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=DN(t),s=i===((r=t.ownerDocument)==null?void 0:r.body),o=_r(i);return s?e.concat(o,o.visualViewport||[],pf(i)?i:[],o.frameElement&&n?m0(o.frameElement):[]):e.concat(i,m0(i,[],n))}function ON(t){const e=Xr(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=fs(t),s=i?t.offsetWidth:n,o=i?t.offsetHeight:r,a=Np(n)!==s||Np(r)!==o;return a&&(n=s,r=o),{width:n,height:r,$:a}}function LN(t){return co(t)?t:t.contextElement}function fl(t){const e=LN(t);if(!fs(e))return la(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:s}=ON(e);let o=(s?Np(n.width):n.width)/r,a=(s?Np(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Q6=la(0);function BN(t){const e=_r(t);return!TI()||!e.visualViewport?Q6:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function e9(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==_r(t)?!1:e}function Bd(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),s=LN(t);let o=la(1);e&&(r?co(r)&&(o=fl(r)):o=fl(t));const a=e9(s,n,r)?BN(s):la(0);let c=(i.left+a.x)/o.x,l=(i.top+a.y)/o.y,u=i.width/o.x,d=i.height/o.y;if(s){const f=_r(s),h=r&&co(r)?_r(r):r;let p=f.frameElement;for(;p&&r&&h!==f;){const g=fl(p),y=p.getBoundingClientRect(),m=Xr(p),v=y.left+(p.clientLeft+parseFloat(m.paddingLeft))*g.x,S=y.top+(p.clientTop+parseFloat(m.paddingTop))*g.y;c*=g.x,l*=g.y,u*=g.x,d*=g.y,c+=v,l+=S,p=_r(p).frameElement}}return Mp({width:u,height:d,x:c,y:l})}function t9(t){let{rect:e,offsetParent:n,strategy:r}=t;const i=fs(n),s=Ia(n);if(n===s)return e;let o={scrollLeft:0,scrollTop:0},a=la(1);const c=la(0);if((i||!i&&r!=="fixed")&&((ua(n)!=="body"||pf(s))&&(o=Rm(n)),fs(n))){const l=Bd(n);a=fl(n),c.x=l.x+n.clientLeft,c.y=l.y+n.clientTop}return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-o.scrollLeft*a.x+c.x,y:e.y*a.y-o.scrollTop*a.y+c.y}}function n9(t){return Array.from(t.getClientRects())}function FN(t){return Bd(Ia(t)).left+Rm(t).scrollLeft}function r9(t){const e=Ia(t),n=Rm(t),r=t.ownerDocument.body,i=dl(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=dl(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+FN(t);const a=-n.scrollTop;return Xr(r).direction==="rtl"&&(o+=dl(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:a}}function i9(t,e){const n=_r(t),r=Ia(t),i=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,c=0;if(i){s=i.width,o=i.height;const l=TI();(!l||l&&e==="fixed")&&(a=i.offsetLeft,c=i.offsetTop)}return{width:s,height:o,x:a,y:c}}function s9(t,e){const n=Bd(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,s=fs(t)?fl(t):la(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,c=i*s.x,l=r*s.y;return{width:o,height:a,x:c,y:l}}function SA(t,e,n){let r;if(e==="viewport")r=i9(t,n);else if(e==="document")r=r9(Ia(t));else if(co(e))r=s9(e,n);else{const i=BN(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return Mp(r)}function UN(t,e){const n=Ol(t);return n===e||!co(n)||_m(n)?!1:Xr(n).position==="fixed"||UN(n,e)}function o9(t,e){const n=e.get(t);if(n)return n;let r=m0(t,[],!1).filter(a=>co(a)&&ua(a)!=="body"),i=null;const s=Xr(t).position==="fixed";let o=s?Ol(t):t;for(;co(o)&&!_m(o);){const a=Xr(o),c=EI(o);!c&&a.position==="fixed"&&(i=null),(s?!c&&!i:!c&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||pf(o)&&!c&&UN(t,o))?r=r.filter(u=>u!==o):i=a,o=Ol(o)}return e.set(t,r),r}function a9(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const o=[...n==="clippingAncestors"?o9(e,this._c):[].concat(n),r],a=o[0],c=o.reduce((l,u)=>{const d=SA(e,u,i);return l.top=dl(d.top,l.top),l.right=h0(d.right,l.right),l.bottom=h0(d.bottom,l.bottom),l.left=dl(d.left,l.left),l},SA(e,a,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function c9(t){return ON(t)}function l9(t,e,n){const r=fs(e),i=Ia(e),s=n==="fixed",o=Bd(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const c=la(0);if(r||!r&&!s)if((ua(e)!=="body"||pf(i))&&(a=Rm(e)),r){const l=Bd(e,!0,s,e);c.x=l.x+e.clientLeft,c.y=l.y+e.clientTop}else i&&(c.x=FN(i));return{x:o.left+a.scrollLeft-c.x,y:o.top+a.scrollTop-c.y,width:o.width,height:o.height}}function bA(t,e){return!fs(t)||Xr(t).position==="fixed"?null:e?e(t):t.offsetParent}function GN(t,e){const n=_r(t);if(!fs(t))return n;let r=bA(t,e);for(;r&&Y6(r)&&Xr(r).position==="static";)r=bA(r,e);return r&&(ua(r)==="html"||ua(r)==="body"&&Xr(r).position==="static"&&!EI(r))?n:r||q6(t)||n}const u9=async function(t){let{reference:e,floating:n,strategy:r}=t;const i=this.getOffsetParent||GN,s=this.getDimensions;return{reference:l9(e,await i(n),r),floating:{x:0,y:0,...await s(n)}}};function d9(t){return Xr(t).direction==="rtl"}const f9={convertOffsetParentRelativeRectToViewportRelativeRect:t9,getDocumentElement:Ia,getClippingRect:a9,getOffsetParent:GN,getElementRects:u9,getClientRects:n9,getDimensions:c9,getScale:fl,isElement:co,isRTL:d9},h9=(t,e,n)=>{const r=new Map,i={platform:f9,...n},s={...i.platform,_c:r};return z6(t,e,{...i,platform:s})};var VN={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(Wx,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function s(g,y){var m=g[y];if(typeof m.bind=="function")return m.bind(g);try{return Function.prototype.bind.call(m,g)}catch{return function(){return Function.prototype.apply.apply(m,[g,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?o:console[g]!==void 0?s(console,g):console.log!==void 0?s(console,"log"):e}function c(g,y){for(var m=0;m<i.length;m++){var v=i[m];this[v]=m<g?e:this.methodFactory(v,g,y)}this.log=this.debug}function l(g,y,m){return function(){typeof console!==n&&(c.call(this,y,m),this[g].apply(this,arguments))}}function u(g,y,m){return a(g)||l.apply(this,arguments)}function d(g,y,m){var v=this,S;y=y??"WARN";var E="loglevel";typeof g=="string"?E+=":"+g:typeof g=="symbol"&&(E=void 0);function A(N){var M=(i[N]||"silent").toUpperCase();if(!(typeof window===n||!E)){try{window.localStorage[E]=M;return}catch{}try{window.document.cookie=encodeURIComponent(E)+"="+M+";"}catch{}}}function b(){var N;if(!(typeof window===n||!E)){try{N=window.localStorage[E]}catch{}if(typeof N===n)try{var M=window.document.cookie,D=M.indexOf(encodeURIComponent(E)+"=");D!==-1&&(N=/^([^;]+)/.exec(M.slice(D))[1])}catch{}return v.levels[N]===void 0&&(N=void 0),N}}function k(){if(!(typeof window===n||!E)){try{window.localStorage.removeItem(E);return}catch{}try{window.document.cookie=encodeURIComponent(E)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}v.name=g,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=m||u,v.getLevel=function(){return S},v.setLevel=function(N,M){if(typeof N=="string"&&v.levels[N.toUpperCase()]!==void 0&&(N=v.levels[N.toUpperCase()]),typeof N=="number"&&N>=0&&N<=v.levels.SILENT){if(S=N,M!==!1&&A(N),c.call(v,N,g),typeof console===n&&N<v.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+N},v.setDefaultLevel=function(N){y=N,b()||v.setLevel(N,!1)},v.resetLevel=function(){v.setLevel(y,!1),k()},v.enableAll=function(N){v.setLevel(v.levels.TRACE,N)},v.disableAll=function(N){v.setLevel(v.levels.SILENT,N)};var _=b();_==null&&(_=y),v.setLevel(_,!1)}var f=new d,h={};f.getLogger=function(y){if(typeof y!="symbol"&&typeof y!="string"||y==="")throw new TypeError("You must supply a name when creating a logger.");var m=h[y];return m||(m=h[y]=new d(y,f.getLevel(),f.methodFactory)),m};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(VN);var p9=VN.exports;const m9=Yd(p9);function on(t){return typeof t=="function"}function WN(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var iv=WN(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function g0(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Nm=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Nl(o),c=a.next();!c.done;c=a.next()){var l=c.value;l.remove(this)}}catch(g){e={error:g}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(on(u))try{u()}catch(g){s=g instanceof iv?g.errors:[g]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=Nl(d),h=f.next();!h.done;h=f.next()){var p=h.value;try{wA(p)}catch(g){s=s??[],g instanceof iv?s=Sp(Sp([],Ip(s)),Ip(g.errors)):s.push(g)}}}catch(g){r={error:g}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(s)throw new iv(s)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)wA(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&g0(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&g0(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),HN=Nm.EMPTY;function ZN(t){return t instanceof Nm||t&&"closed"in t&&on(t.remove)&&on(t.add)&&on(t.unsubscribe)}function wA(t){on(t)?t():t.unsubscribe()}var jN={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},v0={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=v0.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,Sp([t,e],Ip(n))):setTimeout.apply(void 0,Sp([t,e],Ip(n)))},clearTimeout:function(t){var e=v0.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function zN(t){v0.setTimeout(function(){throw t})}function y0(){}function Oh(t){t()}var _I=function(t){Ql(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,ZN(n)&&n.add(r)):r.destination=C9,r}return e.create=function(n,r,i){return new C0(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Nm),g9=Function.prototype.bind;function sv(t,e){return g9.call(t,e)}var v9=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){Kf(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){Kf(r)}else Kf(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){Kf(n)}},t}(),C0=function(t){Ql(e,t);function e(n,r,i){var s=t.call(this)||this,o;if(on(n)||!n)o={next:n??void 0,error:r??void 0,complete:i??void 0};else{var a;s&&jN.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return s.unsubscribe()},o={next:n.next&&sv(n.next,a),error:n.error&&sv(n.error,a),complete:n.complete&&sv(n.complete,a)}):o=n}return s.destination=new v9(o),s}return e}(_I);function Kf(t){zN(t)}function y9(t){throw t}var C9={closed:!0,next:y0,error:y9,complete:y0},RI=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function XN(t){return t}function I9(t){return t.length===0?XN:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var Rn=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,s=b9(e)?e:new C0(e,n,r);return Oh(function(){var o=i,a=o.operator,c=o.source;s.add(a?a.call(s,c):c?i._subscribe(s):i._trySubscribe(s))}),s},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=AA(n),new n(function(i,s){var o=new C0({next:function(a){try{e(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});r.subscribe(o)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[RI]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return I9(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=AA(e),new e(function(r,i){var s;n.subscribe(function(o){return s=o},function(o){return i(o)},function(){return r(s)})})},t.create=function(e){return new t(e)},t}();function AA(t){var e;return(e=t??jN.Promise)!==null&&e!==void 0?e:Promise}function S9(t){return t&&on(t.next)&&on(t.error)&&on(t.complete)}function b9(t){return t&&t instanceof _I||S9(t)&&ZN(t)}function w9(t){return on(t==null?void 0:t.lift)}function go(t){return function(e){if(w9(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function tc(t,e,n,r,i){return new A9(t,e,n,r,i)}var A9=function(t){Ql(e,t);function e(n,r,i,s,o,a){var c=t.call(this,n)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=r?function(l){try{r(l)}catch(u){n.error(u)}}:t.prototype._next,c._error=s?function(l){try{s(l)}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._error,c._complete=i?function(){try{i()}catch(l){n.error(l)}finally{this.unsubscribe()}}:t.prototype._complete,c}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(_I),k9=WN(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),da=function(t){Ql(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new kA(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new k9},e.prototype.next=function(n){var r=this;Oh(function(){var i,s;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var o=Nl(r.currentObservers),a=o.next();!a.done;a=o.next()){var c=a.value;c.next(n)}}catch(l){i={error:l}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;Oh(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;Oh(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,s=i.hasError,o=i.isStopped,a=i.observers;return s||o?HN:(this.currentObservers=null,a.push(n),new Nm(function(){r.currentObservers=null,g0(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,s=r.thrownError,o=r.isStopped;i?n.error(s):o&&n.complete()},e.prototype.asObservable=function(){var n=new Rn;return n.source=this,n},e.create=function(n,r){return new kA(n,r)},e}(Rn),kA=function(t){Ql(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:HN},e}(da),$N=function(t){Ql(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,s=n._value;if(r)throw i;return this._throwIfClosed(),s},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(da);function E9(t){return t&&on(t.schedule)}function T9(t){return t[t.length-1]}function KN(t){return E9(T9(t))?t.pop():void 0}var JN=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function YN(t){return on(t==null?void 0:t.then)}function qN(t){return on(t[RI])}function QN(t){return Symbol.asyncIterator&&on(t==null?void 0:t[Symbol.asyncIterator])}function eP(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function _9(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var tP=_9();function nP(t){return on(t==null?void 0:t[tP])}function rP(t){return X4(this,arguments,function(){var n,r,i,s;return x_(this,function(o){switch(o.label){case 0:n=t.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,rl(n.read())];case 3:return r=o.sent(),i=r.value,s=r.done,s?[4,rl(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,rl(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function iP(t){return on(t==null?void 0:t.getReader)}function ru(t){if(t instanceof Rn)return t;if(t!=null){if(qN(t))return R9(t);if(JN(t))return N9(t);if(YN(t))return P9(t);if(QN(t))return sP(t);if(nP(t))return M9(t);if(iP(t))return x9(t)}throw eP(t)}function R9(t){return new Rn(function(e){var n=t[RI]();if(on(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function N9(t){return new Rn(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function P9(t){return new Rn(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,zN)})}function M9(t){return new Rn(function(e){var n,r;try{for(var i=Nl(t),s=i.next();!s.done;s=i.next()){var o=s.value;if(e.next(o),e.closed)return}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function sP(t){return new Rn(function(e){D9(t,e).catch(function(n){return e.error(n)})})}function x9(t){return sP(rP(t))}function D9(t,e){var n,r,i,s;return z4(this,void 0,void 0,function(){var o,a;return x_(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=$4(t),c.label=1;case 1:return[4,n.next()];case 2:if(r=c.sent(),!!r.done)return[3,4];if(o=r.value,e.next(o),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function na(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function oP(t,e){return e===void 0&&(e=0),go(function(n,r){n.subscribe(tc(r,function(i){return na(r,t,function(){return r.next(i)},e)},function(){return na(r,t,function(){return r.complete()},e)},function(i){return na(r,t,function(){return r.error(i)},e)}))})}function aP(t,e){return e===void 0&&(e=0),go(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function O9(t,e){return ru(t).pipe(aP(e),oP(e))}function L9(t,e){return ru(t).pipe(aP(e),oP(e))}function B9(t,e){return new Rn(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function F9(t,e){return new Rn(function(n){var r;return na(n,e,function(){r=t[tP](),na(n,e,function(){var i,s,o;try{i=r.next(),s=i.value,o=i.done}catch(a){n.error(a);return}o?n.complete():n.next(s)},0,!0)}),function(){return on(r==null?void 0:r.return)&&r.return()}})}function cP(t,e){if(!t)throw new Error("Iterable cannot be null");return new Rn(function(n){na(n,e,function(){var r=t[Symbol.asyncIterator]();na(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function U9(t,e){return cP(rP(t),e)}function G9(t,e){if(t!=null){if(qN(t))return O9(t,e);if(JN(t))return B9(t,e);if(YN(t))return L9(t,e);if(QN(t))return cP(t,e);if(nP(t))return F9(t,e);if(iP(t))return U9(t,e)}throw eP(t)}function V9(t,e){return e?G9(t,e):ru(t)}function sr(t,e){return go(function(n,r){var i=0;n.subscribe(tc(r,function(s){r.next(t.call(e,s,i++))}))})}function W9(t,e,n,r,i,s,o,a){var c=[],l=0,u=0,d=!1,f=function(){d&&!c.length&&!l&&e.complete()},h=function(g){return l<r?p(g):c.push(g)},p=function(g){s&&e.next(g),l++;var y=!1;ru(n(g,u++)).subscribe(tc(e,function(m){i==null||i(m),s?h(m):e.next(m)},function(){y=!0},void 0,function(){if(y)try{l--;for(var m=function(){var v=c.shift();o?na(e,o,function(){return p(v)}):p(v)};c.length&&l<r;)m();f()}catch(v){e.error(v)}}))};return t.subscribe(tc(e,h,function(){d=!0,f()})),function(){a==null||a()}}function lP(t,e,n){return n===void 0&&(n=1/0),on(e)?lP(function(r,i){return sr(function(s,o){return e(r,s,i,o)})(ru(t(r,i)))},n):(typeof e=="number"&&(n=e),go(function(r,i){return W9(r,i,t,n)}))}function H9(t){return t===void 0&&(t=1/0),lP(XN,t)}function Z9(){return H9(1)}function I0(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Z9()(V9(t,KN(t)))}function uP(t,e){return go(function(n,r){var i=0;n.subscribe(tc(r,function(s){return t.call(e,s,i++)&&r.next(s)}))})}function j9(t,e,n,r,i){return function(s,o){var a=n,c=e,l=0;s.subscribe(tc(o,function(u){var d=l++;c=a?t(c,u,d):(a=!0,u),r&&o.next(c)},i&&function(){a&&o.next(c),o.complete()}))}}function z9(t){return go(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function X9(t,e){return go(j9(t,e,arguments.length>=2,!0))}function Ri(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=KN(t);return go(function(r,i){(n?I0(t,r,n):I0(t,r)).subscribe(i)})}function EA(t){return go(function(e,n){ru(t).subscribe(tc(n,function(){return n.complete()},y0)),!n.closed&&e.subscribe(n)})}var $9=Object.defineProperty,K9=Object.defineProperties,J9=Object.getOwnPropertyDescriptors,xp=Object.getOwnPropertySymbols,dP=Object.prototype.hasOwnProperty,fP=Object.prototype.propertyIsEnumerable,TA=(t,e,n)=>e in t?$9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,S0=(t,e)=>{for(var n in e||(e={}))dP.call(e,n)&&TA(t,n,e[n]);if(xp)for(var n of xp(e))fP.call(e,n)&&TA(t,n,e[n]);return t},Y9=(t,e)=>K9(t,J9(e)),q9=(t,e)=>{var n={};for(var r in t)dP.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&xp)for(var r of xp(t))e.indexOf(r)<0&&fP.call(t,r)&&(n[r]=t[r]);return n},vo=(t,e,n)=>new Promise((r,i)=>{var s=c=>{try{a(n.next(c))}catch(l){i(l)}},o=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((n=n.apply(t,e)).next())}),hP="lk";function NI(t){return typeof t>"u"?!1:Q9(t)||eH(t)}function Q9(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function eH(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function tH(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function pP(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(tH(t))return`${t.participant.identity}_${t.source}_placeholder`;if(NI(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function nH(t){return t instanceof f0}function rH(t,e){return vo(this,null,function*(){const{x:n,y:r}=yield h9(t,e,{placement:"top",middleware:[K6(6),X6(),J6({padding:5})]});return{x:n,y:r}})}function iH(t,e){return!t.contains(e.target)}var sH=[ne.ConnectionStateChanged,ne.RoomMetadataChanged,ne.ActiveSpeakersChanged,ne.ConnectionQualityChanged,ne.ParticipantConnected,ne.ParticipantDisconnected,ne.ParticipantPermissionsChanged,ne.ParticipantMetadataChanged,ne.TrackMuted,ne.TrackUnmuted,ne.TrackPublished,ne.TrackUnpublished,ne.TrackStreamStateChanged,ne.TrackSubscriptionFailed,ne.TrackSubscriptionPermissionChanged,ne.TrackSubscriptionStatusChanged],oH=[...sH,ne.LocalTrackPublished,ne.LocalTrackUnpublished],aH=[oe.ConnectionQualityChanged,oe.IsSpeakingChanged,oe.ParticipantMetadataChanged,oe.ParticipantPermissionsChanged,oe.TrackMuted,oe.TrackUnmuted,oe.TrackPublished,oe.TrackUnpublished,oe.TrackStreamStateChanged,oe.TrackSubscriptionFailed,oe.TrackSubscriptionPermissionChanged,oe.TrackSubscriptionStatusChanged];[...aH,oe.LocalTrackPublished,oe.LocalTrackUnpublished];var Qe=m9.getLogger("lk-components-js");Qe.setDefaultLevel("WARN");function cH(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var lH=[],uH={showChat:!1,unreadMessages:0};function PI(t,...e){return new Rn(r=>{const i=()=>{r.next(t)};return e.forEach(o=>{t.on(o,i)}),()=>{e.forEach(o=>{t.off(o,i)})}}).pipe(Ri(t))}function MI(t,e){return new Rn(r=>{const i=(...o)=>{r.next(o)};return t.on(e,i),()=>{t.off(e,i)}})}function dH(t){return MI(t,ne.ConnectionStateChanged).pipe(sr(([e])=>e),Ri(t.state))}function fH(t,e,n=!0){var r;const i=()=>vo(this,null,function*(){try{const a=yield Rp.getLocalDevices(t,n);s.next(a)}catch(a){e==null||e(a)}}),s=new da,o=s.pipe(z9(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return I0(Rp.getLocalDevices(t,n).catch(a=>e==null?void 0:e(a)),o)}function hH(t){return MI(t,ne.DataReceived)}function pH(t){return PI(t,ne.AudioPlaybackStatusChanged).pipe(sr(n=>({canPlayAudio:n.canPlaybackAudio})))}function mH(t){return PI(t,ne.VideoPlaybackStatusChanged).pipe(sr(n=>({canPlayVideo:n.canPlaybackVideo})))}function gH(t,e){return MI(t,ne.ActiveDeviceChanged).pipe(uP(([n])=>n===e),sr(([n,r])=>(Qe.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)),Ri(t.getActiveDevice(e)))}function $r(t){return`${hP}-${t}`}function vH(t){const e=b0(t),n=DI(t.participant).pipe(sr(()=>b0(t)),Ri(e));return{className:$r(t.source===Y.Source.Camera||t.source===Y.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function b0(t){if(NI(t))return t.publication;{const{source:e,name:n,participant:r}=t;if(e&&n)return r.getTracks().find(i=>i.source===e&&i.trackName===n);if(n)return r.getTrackByName(n);if(e)return r.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function xI(t,...e){return new Rn(r=>{const i=()=>{r.next(t)};return e.forEach(o=>{t.on(o,i)}),()=>{e.forEach(o=>{t.off(o,i)})}}).pipe(Ri(t))}function DI(t){return xI(t,oe.TrackMuted,oe.TrackUnmuted,oe.ParticipantPermissionsChanged,oe.TrackPublished,oe.TrackUnpublished,oe.LocalTrackPublished,oe.LocalTrackUnpublished,oe.MediaDevicesError,oe.TrackSubscriptionStatusChanged).pipe(sr(n=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:s}=n,o=n.getTrack(Y.Source.Microphone),a=n.getTrack(Y.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:s,cameraTrack:a,microphoneTrack:o,participant:n}}))}function yH(t){return xI(t,oe.ParticipantMetadataChanged).pipe(sr(({name:n,identity:r,metadata:i})=>({name:n,identity:r,metadata:i})),Ri({name:t.name,identity:t.identity,metadata:t.metadata}))}function CH(t){return OI(t,oe.ConnectionQualityChanged).pipe(sr(([n])=>n),Ri(t.connectionQuality))}function OI(t,e){return new Rn(r=>{const i=(...o)=>{r.next(o)};return t.on(e,i),()=>{t.off(e,i)}})}function mP(t){var e,n,r,i;return xI(t.participant,oe.TrackMuted,oe.TrackUnmuted,oe.TrackSubscribed,oe.TrackUnsubscribed,oe.LocalTrackPublished,oe.LocalTrackUnpublished).pipe(sr(s=>{var o,a;const c=(o=t.publication)!=null?o:s.getTrack(t.source);return(a=c==null?void 0:c.isMuted)!=null?a:!0}),Ri((i=(r=(e=t.publication)==null?void 0:e.isMuted)!=null?r:(n=t.participant.getTrack(t.source))==null?void 0:n.isMuted)!=null?i:!0))}function IH(t){return OI(t,oe.IsSpeakingChanged).pipe(sr(([e])=>e))}function SH(t,e={}){var n;let r;const i=new Rn(c=>(r=c,()=>a.unsubscribe())).pipe(Ri(Array.from(t.participants.values()))),s=(n=e.additionalRoomEvents)!=null?n:oH,o=Array.from(new Set([ne.ParticipantConnected,ne.ParticipantDisconnected,ne.ConnectionStateChanged,...s])),a=PI(t,...o).subscribe(c=>r==null?void 0:r.next(Array.from(c.participants.values())));return t.participants.size>0&&(r==null||r.next(Array.from(t.participants.values()))),i}function bH(t){return OI(t,oe.ParticipantPermissionsChanged).pipe(sr(()=>t.permissions),Ri(t.permissions))}function wH(t,e,n){const{localParticipant:r}=e,i=(l,u)=>{let d=!1;switch(l){case Y.Source.Camera:d=u.isCameraEnabled;break;case Y.Source.Microphone:d=u.isMicrophoneEnabled;break;case Y.Source.ScreenShare:d=u.isScreenShareEnabled;break}return d},s=DI(r).pipe(sr(l=>i(t,l.participant)),Ri(i(t,r))),o=new da,a=(l,u)=>vo(this,null,function*(){try{switch(u??(u=n),o.next(!0),t){case Y.Source.Camera:yield r.setCameraEnabled(l??!r.isCameraEnabled,u);break;case Y.Source.Microphone:yield r.setMicrophoneEnabled(l??!r.isMicrophoneEnabled,u);break;case Y.Source.ScreenShare:yield r.setScreenShareEnabled(l??!r.isScreenShareEnabled,u);break;default:break}}finally{o.next(!1)}});return{className:$r("button"),toggle:a,enabledObserver:s,pendingObserver:o.asObservable()}}function AH(){let t=!1;const e=new da,n=new da,r=s=>{n.next(!0),t=s??!t,e.next(t),n.next(!1)};return{className:$r("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function kH(t,e,n){const r=new $N(void 0),i=e?gH(e,t):r.asObservable(),s=(a,...c)=>vo(this,[a,...c],function*(l,u={}){var d,f,h;if(e){Qe.debug(`Switching active device of kind "${t}" with id ${l}.`),yield e.switchActiveDevice(t,l,u.exact);const p=(d=e.getActiveDevice(t))!=null?d:l;p!==l&&l!=="default"&&Qe.info(`We tried to select the device with id (${l}), but the browser decided to select the device with id (${p}) instead.`);let g;t==="audioinput"?g=(f=e.localParticipant.getTrack(Y.Source.Microphone))==null?void 0:f.track:t==="videoinput"&&(g=(h=e.localParticipant.getTrack(Y.Source.Camera))==null?void 0:h.track);const y=l==="default"&&!g||l==="default"&&(g==null?void 0:g.mediaStreamTrack.label.startsWith("Default"));r.next(y?l:p)}else if(n){yield n.setDeviceId(u.exact?{exact:l}:l);const p=yield n.getDeviceId();r.next(l==="default"&&n.mediaStreamTrack.label.startsWith("Default")?l:p)}else r.value!==l&&(Qe.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(l))});return{className:$r("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:s}}function EH(t){const e=r=>{t.disconnect(r)};return{className:$r("disconnect-button"),disconnect:e}}function TH(t){const e=$r("connection-quality"),n=CH(t);return{className:e,connectionQualityObserver:n}}function _H(t){let e="track-muted-indicator-camera";switch(t.source){case Y.Source.Camera:e="track-muted-indicator-camera";break;case Y.Source.Microphone:e="track-muted-indicator-microphone";break}const n=$r(e),r=mP(t);return{className:n,mediaMutedObserver:r}}function RH(t){return{className:"lk-participant-name",infoObserver:yH(t)}}function NH(){return{className:$r("participant-tile")}}var PH={CHAT:"lk-chat-topic"};function gP(t,e,n){return vo(this,arguments,function*(r,i,s,o={}){const{kind:a,destination:c}=o;yield r.publishData(i,a??qt.RELIABLE,{destination:c,topic:s})})}function MH(t,e,n){const r=hH(t).pipe(uP(([,,,a])=>e===void 0||a===e),sr(([a,c,,l])=>{const u={payload:a,topic:l,from:c};return n==null||n(u),u}));let i;const s=new Rn(a=>{i=a});return{messageObservable:r,isSendingObservable:s,send:(a,...c)=>vo(this,[a,...c],function*(l,u={}){i.next(!0);try{yield gP(t.localParticipant,l,e,u)}finally{i.next(!1)}})}}var xH=new TextEncoder,DH=new TextDecoder,Jf=new Map,OH=t=>xH.encode(JSON.stringify({message:t.message,timestamp:t.timestamp})),LH=t=>JSON.parse(DH.decode(t));function BH(t,e){var n,r;const i=new da,{messageDecoder:s,messageEncoder:o,channelTopic:a}=e??{},c=a??PH.CHAT;let l=!1;Jf.has(t)||(l=!0);const u=(n=Jf.get(t))!=null?n:new Map,d=(r=u.get(c))!=null?r:new da;if(u.set(c,d),Jf.set(t,u),l){const{messageObservable:v}=MH(t,c);v.pipe(EA(i)).subscribe(d)}const f=s??LH,h=d.pipe(sr(v=>{const S=f(v.payload);return Y9(S0({},S),{from:v.from})}),X9((v,S)=>[...v,S],[]),EA(i)),p=new $N(!1),g=o??OH,y=v=>vo(this,null,function*(){const S=Date.now(),E=g({message:v,timestamp:S});p.next(!0);try{yield gP(t.localParticipant,E,c,{kind:qt.RELIABLE}),d.next({payload:E,topic:c,from:t.localParticipant})}finally{p.next(!1)}});function m(){i.next(),i.complete(),Jf.clear()}return t.once(ne.Disconnected,m),{messageObservable:h,isSendingObservable:p,send:y}}function FH(){const t=n=>vo(this,null,function*(){Qe.info("Start Audio for room: ",n),yield n.startAudio()});return{className:$r("start-audio-button"),roomAudioPlaybackAllowedObservable:pH,handleStartAudioPlayback:t}}function UH(){const t=n=>vo(this,null,function*(){Qe.info("Start Video for room: ",n),yield n.startVideo()});return{className:$r("start-audio-button"),roomVideoPlaybackAllowedObservable:mH,handleStartVideoPlayback:t}}function GH(){return{className:[$r("button"),$r("chat-toggle")].join(" ")}}function VH(){return{className:"lk-room-container"}}function WH(t,e){if(typeof localStorage>"u"){Qe.error("Local storage is not available.");return}try{localStorage.setItem(t,JSON.stringify(e))}catch(n){Qe.error(`Error setting item to local storage: ${n}`)}}function HH(t){if(typeof localStorage>"u"){Qe.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){Qe.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){Qe.error(`Error getting item from local storage: ${e}`);return}}function ZH(t){return{load:()=>HH(t),save:e=>WH(t,e)}}var jH=`${hP}-user-choices`,Aa={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:zH,save:XH}=ZH(jH);function $H(t,e=!1){if(e===!0)return;const n=t,r=q9(n,["e2ee","sharedPassphrase"]);XH(r)}function KH(t,e=!1){var n,r,i,s,o,a,c;const l={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:Aa.videoEnabled,audioEnabled:(r=t==null?void 0:t.audioEnabled)!=null?r:Aa.audioEnabled,videoDeviceId:(i=t==null?void 0:t.videoDeviceId)!=null?i:Aa.videoDeviceId,audioDeviceId:(s=t==null?void 0:t.audioDeviceId)!=null?s:Aa.audioDeviceId,username:(o=t==null?void 0:t.username)!=null?o:Aa.username,e2ee:(a=t==null?void 0:t.e2ee)!=null?a:Aa.e2ee,sharedPassphrase:(c=t==null?void 0:t.sharedPassphrase)!=null?c:Aa.sharedPassphrase};if(e)return l;{const u=zH();return S0(S0({},l),u??{})}}function vP(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=vP(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function JH(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=vP(t))&&(r&&(r+=" "),r+=e);return r}var YH=Object.defineProperty,qH=Object.defineProperties,QH=Object.getOwnPropertyDescriptors,Dp=Object.getOwnPropertySymbols,yP=Object.prototype.hasOwnProperty,CP=Object.prototype.propertyIsEnumerable,_A=(t,e,n)=>e in t?YH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ee=(t,e)=>{for(var n in e||(e={}))yP.call(e,n)&&_A(t,n,e[n]);if(Dp)for(var n of Dp(e))CP.call(e,n)&&_A(t,n,e[n]);return t},Fn=(t,e)=>qH(t,QH(e)),Nn=(t,e)=>{var n={};for(var r in t)yP.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Dp)for(var r of Dp(t))e.indexOf(r)<0&&CP.call(t,r)&&(n[r]=t[r]);return n},IP=(t,e,n)=>new Promise((r,i)=>{var s=c=>{try{a(n.next(c))}catch(l){i(l)}},o=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((n=n.apply(t,e)).next())});function Nr(t,e){const[n,r]=w.useState(e);return w.useEffect(()=>{if(typeof window>"u"||!t)return;const i=t.subscribe(r);return()=>i.unsubscribe()},[t]),n}function e8(t){const e=s=>typeof window<"u"?window.matchMedia(s).matches:!1,[n,r]=w.useState(e(t));function i(){r(e(t))}return w.useEffect(()=>{const s=window.matchMedia(t);return i(),s.addListener?s.addListener(i):s.addEventListener("change",i),()=>{s.removeListener?s.removeListener(i):s.removeEventListener("change",i)}},[t]),n}function t8(t,e){if(e.msg==="show_chat")return Fn(Ee({},t),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return Fn(Ee({},t),{showChat:!1});if(e.msg==="toggle_chat"){const n=Fn(Ee({},t),{showChat:!t.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?Fn(Ee({},t),{unreadMessages:e.count}):Ee({},t)}function n8(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:Ee({},t)}var LI=w.createContext(void 0);function r8(){const t=w.useContext(LI);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function i8(t){const[e,n]=w.useReducer(n8,lH),[r,i]=w.useReducer(t8,uH);return t??{pin:{dispatch:n,state:e},widget:{dispatch:i,state:r}}}function SP(){return w.useContext(LI)}var s8=w.createContext(void 0);function mf(){return w.useContext(s8)}var BI=w.createContext(void 0);function Pm(){return w.useContext(BI)}function dc(t){var e;const n=Pm(),r=mf(),i=(e=t??n)!=null?e:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var FI=w.createContext(void 0);function Mm(){const t=w.useContext(FI);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function xm(){return w.useContext(FI)}function gf(t){const e=xm(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var o8=w.createContext(void 0);function a8(...t){return(...e)=>{for(const n of t)typeof n=="function"&&n(...e)}}function Sa(...t){const e=Ee({},t[0]);for(let n=1;n<t.length;n++){const r=t[n];for(const i in r){const s=e[i],o=r[i];typeof s=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=a8(s,o):(i==="className"||i==="UNSAFE_className")&&typeof s=="string"&&typeof o=="string"?e[i]=JH(s,o):e[i]=o!==void 0?o:s}}return e}function c8(t={}){const e=dc(t.participant),{className:n,connectionQualityObserver:r}=w.useMemo(()=>TH(e),[e]),i=Nr(r,Ur.Unknown);return{className:n,quality:i}}function l8(t){const e=gf(t),n=w.useMemo(()=>dH(e),[e]);return Nr(n,e.state)}function u8(t){const e=Mm(),n=l8(e);return{buttonProps:w.useMemo(()=>{const{className:i,disconnect:s}=EH(e);return Sa(t,{className:i,onClick:()=>{var a;return s((a=t.stopTracks)!=null?a:!0)},disabled:n===Ke.Disconnected})},[e,t,n])}}function d8(t){if(t.publication instanceof Od){const e=t.publication.track;if(e){const{facingMode:n}=D6(e);return n}}return"undefined"}function RA(t,e={}){var n,r;const i=typeof t=="string"?e.participant:t.participant,s=dc(i),o=typeof t=="string"?{participant:s,source:t}:t,[a,c]=w.useState(!!((n=o.publication)!=null&&n.isMuted||(r=s.getTrack(o.source))!=null&&r.isMuted));return w.useEffect(()=>{const l=mP(o).subscribe(c);return()=>l.unsubscribe()},[pP(o)]),a}function f8(t){const e=dc(t),n=w.useMemo(()=>IH(e),[e]);return Nr(n,e.isSpeaking)}var h8={connect:!0,audio:!1,video:!1};function p8(t){const e=Ee(Ee({},h8),t),{token:n,serverUrl:r,options:i,room:s,connectOptions:o,connect:a,audio:c,video:l,screen:u,onConnected:d,onDisconnected:f,onError:h,onMediaDeviceFailure:p,onEncryptionError:g,simulateParticipants:y}=e,m=Nn(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&s&&Qe.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[v,S]=w.useState();w.useEffect(()=>{S(s??new Rp(i))},[s]);const E=w.useMemo(()=>{const{className:A}=VH();return Sa(m,{className:A})},[m]);return w.useEffect(()=>{if(!v)return;const A=()=>{const _=v.localParticipant;Qe.debug("trying to publish local tracks"),Promise.all([_.setMicrophoneEnabled(!!c,typeof c!="boolean"?c:void 0),_.setCameraEnabled(!!l,typeof l!="boolean"?l:void 0),_.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(N=>{Qe.warn(N),h==null||h(N)})},b=_=>{const N=xd.getFailure(_);p==null||p(N)},k=_=>{g==null||g(_)};return v.on(ne.SignalConnected,A).on(ne.MediaDevicesError,b).on(ne.EncryptionError,k),()=>{v.off(ne.SignalConnected,A).off(ne.MediaDevicesError,b).off(ne.EncryptionError,k)}},[v,c,l,u,h,g,p]),w.useEffect(()=>{if(v){if(y){v.simulateParticipants({participants:{count:y},publish:{audio:!0,useRealTracks:!0}});return}if(!n){Qe.debug("no token yet");return}if(!r){Qe.warn("no livekit url provided"),h==null||h(Error("no livekit url provided"));return}a?(Qe.debug("connecting"),v.connect(r,n,o).catch(A=>{Qe.warn(A),h==null||h(A)})):(Qe.debug("disconnecting because connect is false"),v.disconnect())}},[a,n,JSON.stringify(o),v,h,r,y]),w.useEffect(()=>{if(!v)return;const A=b=>{switch(b){case Ke.Disconnected:f&&f();break;case Ke.Connected:d&&d();break}};return v.on(ne.ConnectionStateChanged,A),()=>{v.off(ne.ConnectionStateChanged,A)}},[n,d,f,v]),w.useEffect(()=>{if(v)return()=>{Qe.info("disconnecting on onmount"),v.disconnect()}},[v]),{room:v,htmlProps:E}}function m8(t={}){const e=gf(t.room),[n,r]=w.useState(e.localParticipant),[i,s]=w.useState(n.isMicrophoneEnabled),[o,a]=w.useState(n.isMicrophoneEnabled),[c,l]=w.useState(n.lastMicrophoneError),[u,d]=w.useState(n.lastCameraError),[f,h]=w.useState(n.isMicrophoneEnabled),[p,g]=w.useState(void 0),[y,m]=w.useState(void 0),v=S=>{a(S.isCameraEnabled),s(S.isMicrophoneEnabled),h(S.isScreenShareEnabled),m(S.cameraTrack),g(S.microphoneTrack),l(S.participant.lastMicrophoneError),d(S.participant.lastCameraError),r(S.participant)};return w.useEffect(()=>{const S=DI(n).subscribe(v);return()=>S.unsubscribe()},[n]),{isMicrophoneEnabled:i,isScreenShareEnabled:f,isCameraEnabled:o,microphoneTrack:p,cameraTrack:y,lastMicrophoneError:c,lastCameraError:u,localParticipant:n}}function g8(){const t=Mm(),e=w.useMemo(()=>bH(t.localParticipant),[t]);return Nr(e,t.localParticipant.permissions)}function v8({kind:t,room:e,track:n,requestPermissions:r,onError:i}){const s=xm(),o=w.useMemo(()=>fH(t,i,r),[t,r,i]),a=Nr(o,[]),[c,l]=w.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:f}=w.useMemo(()=>kH(t,e??s,n),[t,e,s,n]);return w.useEffect(()=>{const h=d.subscribe(p=>{Qe.info("setCurrentDeviceId",p),p&&l(p)});return()=>{h==null||h.unsubscribe()}},[d]),{devices:a,className:u,activeDeviceId:c,setActiveMediaDevice:f}}function y8(t){return t!==void 0}function iu(...t){return Sa(...t.filter(y8))}function bP(t,e,n){return w.Children.map(t,r=>w.isValidElement(r)&&w.Children.only(t)?w.cloneElement(r,Fn(Ee({},e),{key:n})):r)}function wP(t,e={}){var n;const[r,i]=w.useState(b0(t)),[s,o]=w.useState(r==null?void 0:r.isMuted),[a,c]=w.useState(r==null?void 0:r.isSubscribed),[l,u]=w.useState(r==null?void 0:r.track),[d,f]=w.useState("landscape"),h=w.useRef(),{className:p,trackObserver:g}=w.useMemo(()=>vH(t),[(n=t.participant.sid)!=null?n:t.participant.identity,t.source,NI(t)&&t.publication.trackSid]);return w.useEffect(()=>{const y=g.subscribe(m=>{Qe.debug("update track",m),i(m),o(m==null?void 0:m.isMuted),c(m==null?void 0:m.isSubscribed),u(m==null?void 0:m.track)});return()=>y==null?void 0:y.unsubscribe()},[g]),w.useEffect(()=>{var y,m;return l&&(h.current&&l.detach(h.current),(y=e.element)!=null&&y.current&&!(nH(t.participant)&&(l==null?void 0:l.kind)==="audio")&&l.attach(e.element.current)),h.current=(m=e.element)==null?void 0:m.current,()=>{h.current&&(l==null||l.detach(h.current))}},[l,e.element]),w.useEffect(()=>{var y,m;if(typeof((y=r==null?void 0:r.dimensions)==null?void 0:y.width)=="number"&&typeof((m=r==null?void 0:r.dimensions)==null?void 0:m.height)=="number"){const v=r.dimensions.width>r.dimensions.height?"landscape":"portrait";f(v)}},[r]),{publication:r,isMuted:s,isSubscribed:a,track:l,elementProps:iu(e.props,Ee({className:p,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":d}))}}function C8({trackRef:t,participant:e,source:n,publication:r,onParticipantClick:i,disableSpeakingIndicator:s,htmlProps:o}){const a=mf(),c=dc(e),l=w.useMemo(()=>{var g,y,m,v,S,E;const A=(y=(g=t==null?void 0:t.source)!=null?g:a==null?void 0:a.source)!=null?y:n;if(A===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(v=(m=t==null?void 0:t.participant)!=null?m:a==null?void 0:a.participant)!=null?v:c,publication:(E=(S=t==null?void 0:t.publication)!=null?S:a==null?void 0:a.publication)!=null?E:r,source:A}},[t==null?void 0:t.participant,t==null?void 0:t.source,t==null?void 0:t.publication,a==null?void 0:a.participant,a==null?void 0:a.source,a==null?void 0:a.publication,c,n,r]),u=w.useMemo(()=>{const{className:g}=NH();return Sa(o,{className:g,onClick:y=>{var m,v;if((m=o.onClick)==null||m.call(o,y),typeof i=="function"){const S=(v=l.publication)!=null?v:l.participant.getTrack(l.source);i({participant:l.participant,track:S})}}})},[o,i,l.publication,l.source,l.participant]),d=RA(Y.Source.Camera,{participant:l.participant}),f=RA(Y.Source.Microphone,{participant:l.participant}),h=f8(l.participant),p=d8(l);return{elementProps:Ee({"data-lk-audio-muted":f,"data-lk-video-muted":d,"data-lk-speaking":s===!0?!1:h,"data-lk-local-participant":l.participant.isLocal,"data-lk-source":l.source,"data-lk-facing-mode":p},u)}}function I8(t={}){const e=gf(t.room),[n,r]=w.useState([]);return w.useEffect(()=>{const i=SH(e,{additionalRoomEvents:t.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[e,JSON.stringify(t.updateOnlyOn)]),n}function S8(t={}){const e=I8(t),{localParticipant:n}=m8(t);return[n,...e]}function b8({room:t,props:e}){const n=gf(t),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:s}=w.useMemo(()=>FH(),[]),o=w.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=Nr(o,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:w.useMemo(()=>Sa(e,{className:r,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[e,r,a,s,n]),canPlayAudio:a}}function w8({room:t,props:e}){const n=gf(t),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:s}=w.useMemo(()=>UH(),[]),o=w.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=Nr(o,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:w.useMemo(()=>Sa(e,{className:r,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[e,r,a,s,n]),canPlayVideo:a}}function A8({props:t}){const{dispatch:e,state:n}=r8().widget,{className:r}=w.useMemo(()=>GH(),[]);return{mergedProps:w.useMemo(()=>Sa(t,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,r,e,n])}}function k8(t,e={}){var n,r,i,s;let o=mf();const a=(r=(n=Pm())!=null?n:e.participant)!=null?r:o==null?void 0:o.participant;if(typeof t=="string"){if(!a)throw Error("Participant missing, either provide it via context or pass it in directly");o={participant:a,source:t}}else if(t)o=t;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:c,mediaMutedObserver:l}=w.useMemo(()=>_H(o),[pP(o)]);return{isMuted:Nr(l,!!((i=o.publication)!=null&&i.isMuted||(s=o.participant.getTrack(o.source))!=null&&s.isMuted)),className:c}}function E8(t){var e=t,{source:n,onChange:r,initialState:i,captureOptions:s}=e,o=Nn(e,["source","onChange","initialState","captureOptions"]),a;const c=xm(),l=(a=c==null?void 0:c.localParticipant)==null?void 0:a.getTrack(n),{toggle:u,className:d,pendingObserver:f,enabledObserver:h}=w.useMemo(()=>c?wH(n,c,s):AH(),[c,n,JSON.stringify(s)]),p=Nr(f,!1),g=Nr(h,i??!!(l!=null&&l.isEnabled));w.useEffect(()=>{r==null||r(g)},[g,r]),w.useEffect(()=>{i!==void 0&&(Qe.debug("forcing initial toggle state",n,i),u(i))},[]);const y=w.useMemo(()=>Sa(o,{className:d}),[o,d]),m=w.useCallback(v=>{var S;u(),(S=o.onClick)==null||S.call(o,v)},[o,u]);return{toggle:u,enabled:g,pending:p,track:l,buttonProps:Fn(Ee({},y),{"aria-pressed":g,"data-lk-source":n,"data-lk-enabled":g,disabled:p,onClick:m})}}function T8(t,e={}){return wP(t,e)}function _8(t){const e=Mm(),[n,r]=w.useState(),i=Nr(n==null?void 0:n.isSendingObservable,!1),s=Nr(n==null?void 0:n.messageObservable,[]);return w.useEffect(()=>{const o=BH(e,t);r(o)},[e,t]),{send:n==null?void 0:n.send,chatMessages:s,isSending:i}}function R8(t={}){var e;const[n,r]=w.useState(KH(t.defaults,(e=t.preventLoad)!=null?e:!1)),i=w.useCallback(l=>{r(u=>Fn(Ee({},u),{audioEnabled:l}))},[]),s=w.useCallback(l=>{r(u=>Fn(Ee({},u),{videoEnabled:l}))},[]),o=w.useCallback(l=>{r(u=>Fn(Ee({},u),{audioDeviceId:l}))},[]),a=w.useCallback(l=>{r(u=>Fn(Ee({},u),{videoDeviceId:l}))},[]),c=w.useCallback(l=>{r(u=>Fn(Ee({},u),{username:l}))},[]);return w.useEffect(()=>{var l;$H(n,(l=t.preventSave)!=null?l:!1)},[n,t.preventSave]),{userChoices:n,saveAudioInputEnabled:i,saveVideoInputEnabled:s,saveAudioInputDeviceId:o,saveVideoInputDeviceId:a,saveUsername:c}}function N8(t){const{mergedProps:e}=A8({props:t});return w.createElement("button",Ee({},e),t.children)}function P8(t){const{buttonProps:e}=u8(t);return w.createElement("button",Ee({},e),t.children)}var M8=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),w.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),w.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),x8=M8,D8=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),w.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),O8=D8,L8=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),B8=L8,F8=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),U8=F8,G8=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),w.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),w.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),V8=G8,W8=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),w.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),w.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),H8=W8,Z8=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),j8=Z8,z8=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("g",{opacity:.25},w.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),X8=z8,$8=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("g",{opacity:.25},w.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),K8=$8,J8=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),w.createElement("g",{opacity:.25},w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),Y8=J8,q8=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),Q8=q8,eZ=t=>w.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),w.createElement("g",{fill:"currentColor"},w.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),w.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),tZ=eZ;function ov(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:s,onDeviceSelectError:o,exactMatch:a,track:c,requestPermissions:l,onError:u}=e,d=Nn(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const f=xm(),h=w.useCallback(A=>{f&&f.emit(ne.MediaDevicesError,A),u==null||u(A)},[f,u]),{devices:p,activeDeviceId:g,setActiveMediaDevice:y,className:m}=v8({kind:n,room:f,track:c,requestPermissions:l,onError:h});w.useEffect(()=>{r!==void 0&&y(r)},[y]),w.useEffect(()=>{typeof s=="function"&&s(p)},[s,p]),w.useEffect(()=>{g&&g!==""&&(i==null||i(g))},[g]);const v=A=>IP(this,null,function*(){try{yield y(A,{exact:a})}catch(b){if(b instanceof Error)o==null||o(b);else throw b}}),S=w.useMemo(()=>iu(d,{className:m},{className:"lk-list"}),[m,d]);function E(A,b,k){return A===b||k===0&&b==="default"}return w.createElement("ul",Ee({},S),p.map((A,b)=>w.createElement("li",{key:A.deviceId,id:A.deviceId,"data-lk-active":E(A.deviceId,g,b),"aria-selected":E(A.deviceId,g,b),role:"option"},w.createElement("button",{className:"lk-button",onClick:()=>v(A.deviceId)},A.label))))}function AP(t,e){switch(t){case Y.Source.Microphone:return e?w.createElement(H8,null):w.createElement(V8,null);case Y.Source.Camera:return e?w.createElement(O8,null):w.createElement(x8,null);case Y.Source.ScreenShare:return e?w.createElement(tZ,null):w.createElement(Q8,null);default:return}}function nZ(t){switch(t){case Ur.Excellent:return w.createElement(j8,null);case Ur.Good:return w.createElement(X8,null);case Ur.Poor:return w.createElement(K8,null);default:return w.createElement(Y8,null)}}function av(t){var e=t,{showIcon:n}=e,r=Nn(e,["showIcon"]);const{buttonProps:i,enabled:s}=E8(r);return w.createElement("button",Ee({},i),(n??!0)&&AP(r.source,s),r.children)}function rZ(t){var e;const{className:n,quality:r}=c8(t),i=w.useMemo(()=>Fn(Ee({},iu(t,{className:n})),{"data-lk-quality":r}),[r,t,n]);return w.createElement("div",Ee({},i),(e=t.children)!=null?e:nZ(r))}function iZ(t){var e=t,{participant:n}=e,r=Nn(e,["participant"]);const i=dc(n),{className:s,infoObserver:o}=w.useMemo(()=>RH(i),[i]),{identity:a,name:c}=Nr(o,{name:i.name,identity:i.identity,metadata:i.metadata}),l=w.useMemo(()=>iu(r,{className:s,"data-lk-participant-name":c}),[r,s,c]);return w.createElement("span",Ee({},l),c!==""?c:a,r.children)}function sZ(t){var e=t,{source:n,participant:r,trackRef:i,show:s="always"}=e,o=Nn(e,["source","participant","trackRef","show"]),a,c;const{className:l,isMuted:u}=k8(i??n,{participant:r}),d=s==="always"||s==="muted"&&u||s==="unmuted"&&!u,f=w.useMemo(()=>iu(o,{className:l}),[l,o]);return d?w.createElement("div",Fn(Ee({},f),{"data-lk-muted":u}),(c=o.children)!=null?c:AP((a=i==null?void 0:i.source)!=null?a:n,!u)):null}function oZ(t){var e=t,{trackRef:n,onSubscriptionStatusChanged:r,volume:i,source:s,name:o,publication:a,participant:c}=e,l=Nn(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),u,d,f,h,p,g,y,m,v,S;const E=mf(),A=(h=(f=(u=n==null?void 0:n.publication)==null?void 0:u.trackName)!=null?f:(d=E==null?void 0:E.publication)==null?void 0:d.trackName)!=null?h:o,b=(g=(p=n==null?void 0:n.source)!=null?p:E==null?void 0:E.source)!=null?g:s,k=(m=(y=n==null?void 0:n.publication)!=null?y:E==null?void 0:E.publication)!=null?m:a,_=(S=(v=n==null?void 0:n.participant)!=null?v:E==null?void 0:E.participant)!=null?S:c;if(b===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const N=w.useRef(null),M=dc(_),{elementProps:D,isSubscribed:B,track:G,publication:V}=wP({source:b,name:A,participant:M,publication:k},{element:N,props:l});return w.useEffect(()=>{r==null||r(!!B)},[B,r]),w.useEffect(()=>{G===void 0||i===void 0||(G instanceof Va?G.setVolume(i):Qe.warn("Volume can only be set on remote audio tracks."))},[i,G]),w.useEffect(()=>{V===void 0||l.muted===void 0||(V instanceof kI?V.setEnabled(!l.muted):Qe.warn("Can only call setEnabled on remote track publications."))},[l.muted,V,G]),w.createElement("audio",Ee({ref:N},D))}function aZ(t){const e=!!Pm();return t.participant&&!e?w.createElement(BI.Provider,{value:t.participant},t.children):w.createElement(w.Fragment,null,t.children)}function cZ({value:t,onPinChange:e,onWidgetChange:n,children:r}){const i=i8(t);return w.useEffect(()=>{Qe.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),w.useEffect(()=>{Qe.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),w.createElement(LI.Provider,{value:i},r)}function lZ(t){const{room:e,htmlProps:n}=p8(t);return w.createElement("div",Ee({},n),e&&w.createElement(FI.Provider,{value:e},w.createElement(o8.Provider,{value:t.featureFlags},t.children)))}function uZ(t){var e=t,{participant:n,trackRef:r}=e,i=Nn(e,["participant","trackRef"]),s,o;const[a,c]=w.useState([]),l=200,u=90,d=6,f=4,h=50,p=7,g=(s=Pm())!=null?s:n;let y=(o=mf())!=null?o:r;if(!y){if(!g)throw Error("Participant missing, provide it directly or within a context");y={participant:g,source:Y.Source.Microphone}}const{track:m}=T8(y);return w.useEffect(()=>{if(!m||!(m instanceof Xn||m instanceof Va))return;const{analyser:v,cleanup:S}=VW(m,{smoothingTimeConstant:.8,fftSize:64}),E=new Uint8Array(v.frequencyBinCount),A=()=>{v.getByteFrequencyData(E);const k=new Array(p).fill(0);E.slice(1);const _=6;for(let N=0;N<p/2;N+=1){const M=Math.floor(p/2-N);for(let D=0;D<_;D+=1)k[M]+=Math.pow(E[N*_+D]/255,2);k[M]/=_}for(let N=0;N<p/2;N+=1){const M=Math.floor(p/2+N);if(k[M]===0){for(let D=0;D<_;D+=1)k[M]+=Math.pow(E[N*_+D]/255,2);k[M]/=_}}return k.map(N=>N*h)},b=setInterval(()=>{const k=A();c(k)},100);return()=>{clearInterval(b),S()}},[m]),w.createElement("svg",Fn(Ee({width:"100%",height:"100%",viewBox:`0 0 ${l} ${u}`},i),{className:"lk-audio-visualizer"}),w.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),w.createElement("g",{style:{transform:`translate(${(l-p*(d+f))/2}px, 0)`}},a.map((v,S)=>w.createElement("rect",{key:S,x:S*(d+f),y:u/2-v/2,width:d,height:v}))))}function dZ(t){var e=t,{participants:n}=e,r=Nn(e,["participants"]);return w.createElement(w.Fragment,null,n.map(i=>w.createElement(BI.Provider,{value:i,key:i.identity},bP(r.children))))}function fZ(t){var e=t,{participant:n,children:r,source:i,publication:s,disableSpeakingIndicator:o,onParticipantClick:a}=e,c=Nn(e,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const l=dc(n),{elementProps:u}=C8({participant:l,htmlProps:c,disableSpeakingIndicator:o,source:Y.Source.Microphone,publication:s,onParticipantClick:a});return w.createElement("div",Ee({style:{position:"relative"}},u),w.createElement(aZ,{participant:l},r??w.createElement(w.Fragment,null,w.createElement(oZ,{source:i??Y.Source.Microphone}),w.createElement(uZ,null),w.createElement("div",{className:"lk-participant-metadata"},w.createElement("div",{className:"lk-participant-metadata-item"},w.createElement(sZ,{source:Y.Source.Microphone}),w.createElement(iZ,null)),w.createElement(rZ,{className:"lk-participant-metadata-item"})))))}function hZ(t){var e=t,{entry:n,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:s}=e,o=Nn(e,["entry","hideName","hideTimestamp","messageFormatter"]),a,c,l,u;const d=w.useMemo(()=>s?s(n.message):n.message,[n.message,s]),f=new Date(n.timestamp),h=navigator?navigator.language:"en-US";return w.createElement("li",Ee({className:"lk-chat-entry",title:f.toLocaleTimeString(h,{timeStyle:"full"}),"data-lk-message-origin":(a=n.from)!=null&&a.isLocal?"local":"remote"},o),(!i||!r)&&w.createElement("span",{className:"lk-meta-data"},!r&&w.createElement("strong",{className:"lk-participant-name"},(u=(c=n.from)==null?void 0:c.name)!=null?u:(l=n.from)==null?void 0:l.identity),!i&&w.createElement("span",{className:"lk-timestamp"},f.toLocaleTimeString(h,{timeStyle:"short"}))),w.createElement("span",{className:"lk-message-body"},d))}function pZ(t){var e=t,{messageFormatter:n,messageDecoder:r,messageEncoder:i,channelTopic:s}=e,o=Nn(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const a=w.useRef(null),c=w.useRef(null),l=w.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:s}),[r,i,s]),{send:u,chatMessages:d,isSending:f}=_8(l),h=SP(),p=w.useRef(0);function g(y){return IP(this,null,function*(){y.preventDefault(),a.current&&a.current.value.trim()!==""&&u&&(yield u(a.current.value),a.current.value="",a.current.focus())})}return w.useEffect(()=>{var y;c&&((y=c.current)==null||y.scrollTo({top:c.current.scrollHeight}))},[c,d]),w.useEffect(()=>{var y,m,v,S,E;if(!h||d.length===0)return;if((y=h.widget.state)!=null&&y.showChat&&d.length>0&&p.current!==((m=d[d.length-1])==null?void 0:m.timestamp)){p.current=(v=d[d.length-1])==null?void 0:v.timestamp;return}const A=d.filter(k=>!p.current||k.timestamp>p.current).length,{widget:b}=h;A>0&&((S=b.state)==null?void 0:S.unreadMessages)!==A&&((E=b.dispatch)==null||E.call(b,{msg:"unread_msg",count:A}))},[d,h==null?void 0:h.widget]),w.createElement("div",Fn(Ee({},o),{className:"lk-chat"}),w.createElement("ul",{className:"lk-list lk-chat-messages",ref:c},o.children?d.map((y,m)=>bP(o.children,{entry:y,key:m,messageFormatter:n})):d.map((y,m,v)=>{const S=m>=1&&v[m-1].from===y.from,E=m>=1&&y.timestamp-v[m-1].timestamp<6e4;return w.createElement(hZ,{key:m,hideName:S,hideTimestamp:S===!1?!1:E,entry:y,messageFormatter:n})})),w.createElement("form",{className:"lk-chat-form",onSubmit:g},w.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:f,ref:a,type:"text",placeholder:"Enter a message..."}),w.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:f},"Send")))}function NA(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,tracks:s,requestPermissions:o=!1}=e,a=Nn(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[c,l]=w.useState(!1),[u,d]=w.useState([]),[f,h]=w.useState(!0),p=(v,S)=>{Qe.debug("handle device change"),l(!1),i==null||i(v,S)},g=w.useRef(null),y=w.useRef(null);w.useLayoutEffect(()=>{g.current&&y.current&&(u||f)&&rH(g.current,y.current).then(({x:v,y:S})=>{y.current&&Object.assign(y.current.style,{left:`${v}px`,top:`${S}px`})}),h(!1)},[g,y,u,f]);const m=w.useCallback(v=>{y.current&&v.target!==g.current&&c&&iH(y.current,v)&&l(!1)},[c,y,g]);return w.useEffect(()=>(document.addEventListener("click",m),window.addEventListener("resize",()=>h(!0)),()=>{document.removeEventListener("click",m),window.removeEventListener("resize",()=>h(!0))}),[m,h]),w.createElement(w.Fragment,null,w.createElement("button",Fn(Ee({className:"lk-button lk-button-menu","aria-pressed":c},a),{onClick:()=>l(!c),ref:g}),a.children),!a.disabled&&w.createElement("div",{className:"lk-device-menu",ref:y,style:{visibility:c?"visible":"hidden"}},n?w.createElement(ov,{initialSelection:r,onActiveDeviceChange:v=>p(n,v),onDeviceListChange:d,kind:n,track:s==null?void 0:s[n],requestPermissions:o}):w.createElement(w.Fragment,null,w.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),w.createElement(ov,{kind:"audioinput",onActiveDeviceChange:v=>p("audioinput",v),onDeviceListChange:d,track:s==null?void 0:s.audioinput,requestPermissions:o}),w.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),w.createElement(ov,{kind:"videoinput",onActiveDeviceChange:v=>p("videoinput",v),onDeviceListChange:d,track:s==null?void 0:s.videoinput,requestPermissions:o}))))}function mZ(t){var e=t,{label:n}=e,r=Nn(e,["label"]);const i=Mm(),{mergedProps:s,canPlayAudio:o}=b8({room:i,props:r}),{mergedProps:a,canPlayVideo:c}=w8({room:i,props:s}),l=a,{style:u}=l,d=Nn(l,["style"]);return u.display=o&&c?"none":"block",w.createElement("button",Ee({style:u},d),n??`Start ${o?"Video":"Audio"}`)}function gZ(t){var e=t,{variation:n,controls:r,saveUserChoices:i=!0}=e,s=Nn(e,["variation","controls","saveUserChoices"]),o,a,c,l,u;const[d,f]=w.useState(!1),h=SP();w.useEffect(()=>{var G,V;((G=h==null?void 0:h.widget.state)==null?void 0:G.showChat)!==void 0&&f((V=h==null?void 0:h.widget.state)==null?void 0:V.showChat)},[(o=h==null?void 0:h.widget.state)==null?void 0:o.showChat]);const g=e8(`(max-width: ${d?1e3:760}px)`)?"minimal":"verbose";n??(n=g);const y=Ee({leave:!0},r),m=g8();m?((a=y.camera)!=null||(y.camera=m.canPublish),(c=y.microphone)!=null||(y.microphone=m.canPublish),(l=y.screenShare)!=null||(y.screenShare=m.canPublish),(u=y.chat)!=null||(y.chat=m.canPublishData&&(r==null?void 0:r.chat))):(y.camera=!1,y.chat=!1,y.microphone=!1,y.screenShare=!1);const v=w.useMemo(()=>n==="minimal"||n==="verbose",[n]),S=w.useMemo(()=>n==="textOnly"||n==="verbose",[n]),E=cH(),[A,b]=w.useState(!1),k=G=>{b(G)},_=iu({className:"lk-control-bar"},s),{saveAudioInputEnabled:N,saveVideoInputEnabled:M,saveAudioInputDeviceId:D,saveVideoInputDeviceId:B}=R8({preventSave:!i});return w.createElement("div",Ee({},_),y.microphone&&w.createElement("div",{className:"lk-button-group"},w.createElement(av,{source:Y.Source.Microphone,showIcon:v,onChange:N},S&&"Microphone"),w.createElement("div",{className:"lk-button-group-menu"},w.createElement(NA,{kind:"audioinput",onActiveDeviceChange:(G,V)=>D(V??"")}))),y.camera&&w.createElement("div",{className:"lk-button-group"},w.createElement(av,{source:Y.Source.Camera,showIcon:v,onChange:M},S&&"Camera"),w.createElement("div",{className:"lk-button-group-menu"},w.createElement(NA,{kind:"videoinput",onActiveDeviceChange:(G,V)=>B(V??"")}))),y.screenShare&&E&&w.createElement(av,{source:Y.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:v,onChange:k},S&&(A?"Stop screen share":"Share screen")),y.chat&&w.createElement(N8,null,v&&w.createElement(B8,null),S&&"Chat"),y.leave&&w.createElement(P8,null,v&&w.createElement(U8,null),S&&"Leave"),w.createElement(mZ,null))}function vZ(t){var e=Nn(t,[]);const[n,r]=w.useState({showChat:!1,unreadMessages:0}),i=S8();return w.createElement(cZ,{onWidgetChange:r},w.createElement("div",Ee({className:"lk-audio-conference"},e),w.createElement("div",{className:"lk-audio-conference-stage"},w.createElement(dZ,{participants:i},w.createElement(fZ,null))),w.createElement(gZ,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),n.showChat&&w.createElement(pZ,null)))}const yZ="wss://mongoose-67t79p35.livekit.cloud",CZ=({client:t})=>{const[e,n]=w.useState([]),[r,i]=w.useState(!1);return w.useEffect(()=>{const s=a=>{n(c=>[...c,a]),i(!0)},o=a=>{n(c=>{const l=c.filter(u=>u!==a);return l.length===0&&i(!1),l})};return t.on("livekitToken",s),t.on("livekitLeave",o),()=>{t.off("livekitToken",s),t.off("livekitLeave",o)}},[t]),e.length?q.jsxs("div",{"data-lk-theme":"default",children:[e.map((s,o)=>q.jsx(lZ,{video:!1,audio:!0,token:s,serverUrl:yZ,connect:!0,onDisconnected:()=>t.emit("livekitLeave",s),children:q.jsx(vZ,{})},o)),q.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null},kP=Object.prototype.toString;function UI(t){switch(kP.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return lo(t,Error)}}function su(t,e){return kP.call(t)===`[object ${e}]`}function GI(t){return su(t,"ErrorEvent")}function PA(t){return su(t,"DOMError")}function IZ(t){return su(t,"DOMException")}function ls(t){return su(t,"String")}function VI(t){return t===null||typeof t!="object"&&typeof t!="function"}function Ll(t){return su(t,"Object")}function Dm(t){return typeof Event<"u"&&lo(t,Event)}function SZ(t){return typeof Element<"u"&&lo(t,Element)}function bZ(t){return su(t,"RegExp")}function WI(t){return!!(t&&t.then&&typeof t.then=="function")}function wZ(t){return Ll(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function EP(t){return typeof t=="number"&&t!==t}function lo(t,e){try{return t instanceof e}catch{return!1}}function TP(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}function hl(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function MA(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const i=t[r];try{TP(i)?n.push("[VueViewModel]"):n.push(String(i))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function AZ(t,e,n=!1){return ls(t)?bZ(e)?e.test(t):ls(e)?n?t===e:t.includes(e):!1:!1}function ou(t,e=[],n=!1){return e.some(r=>AZ(t,r,n))}function kZ(t,e,n=250,r,i,s,o){if(!s.exception||!s.exception.values||!o||!lo(o.originalException,Error))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;a&&(s.exception.values=EZ(w0(t,e,i,o.originalException,r,s.exception.values,a,0),n))}function w0(t,e,n,r,i,s,o,a){if(s.length>=n+1)return s;let c=[...s];if(lo(r[i],Error)){xA(o,a);const l=t(e,r[i]),u=c.length;DA(l,i,u,a),c=w0(t,e,n,r[i],i,[l,...c],l,u)}return Array.isArray(r.errors)&&r.errors.forEach((l,u)=>{if(lo(l,Error)){xA(o,a);const d=t(e,l),f=c.length;DA(d,`errors[${u}]`,f,a),c=w0(t,e,n,l,i,[d,...c],d,f)}}),c}function xA(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,is_exception_group:!0,exception_id:e}}function DA(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function EZ(t,e){return t.map(n=>(n.value&&(n.value=hl(n.value,e)),n))}function Yf(t){return t&&t.Math==Math?t:void 0}const Je=typeof globalThis=="object"&&Yf(globalThis)||typeof window=="object"&&Yf(window)||typeof self=="object"&&Yf(self)||typeof global=="object"&&Yf(global)||function(){return this}()||{};function Om(){return Je}function _P(t,e,n){const r=n||Je,i=r.__SENTRY__=r.__SENTRY__||{};return i[t]||(i[t]=e())}const pl=Om(),TZ=80;function nc(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,i=[];let s=0,o=0;const a=" > ",c=a.length;let l;const u=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||TZ;for(;n&&s++<r&&(l=_Z(n,u),!(l==="html"||s>1&&o+i.length*c+l.length>=d));)i.push(l),o+=l.length,n=n.parentNode;return i.reverse().join(a)}catch{return"<unknown>"}}function _Z(t,e){const n=t,r=[];let i,s,o,a,c;if(!n||!n.tagName)return"";if(pl.HTMLElement&&n instanceof HTMLElement&&n.dataset&&n.dataset.sentryComponent)return n.dataset.sentryComponent;r.push(n.tagName.toLowerCase());const l=e&&e.length?e.filter(d=>n.getAttribute(d)).map(d=>[d,n.getAttribute(d)]):null;if(l&&l.length)l.forEach(d=>{r.push(`[${d[0]}="${d[1]}"]`)});else if(n.id&&r.push(`#${n.id}`),i=n.className,i&&ls(i))for(s=i.split(/\s+/),c=0;c<s.length;c++)r.push(`.${s[c]}`);const u=["aria-label","type","name","title","alt"];for(c=0;c<u.length;c++)o=u[c],a=n.getAttribute(o),a&&r.push(`[${o}="${a}"]`);return r.join("")}function RZ(){try{return pl.document.location.href}catch{return""}}function NZ(t){return pl.document&&pl.document.querySelector?pl.document.querySelector(t):null}function RP(t){if(!pl.HTMLElement)return null;let e=t;const n=5;for(let r=0;r<n;r++){if(!e)return null;if(e instanceof HTMLElement&&e.dataset.sentryComponent)return e.dataset.sentryComponent;e=e.parentNode}return null}const au=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,PZ="Sentry Logger ",A0=["debug","info","warn","error","log","assert","trace"],Op={};function rc(t){if(!("console"in Je))return t();const e=Je.console,n={},r=Object.keys(Op);r.forEach(i=>{const s=Op[i];n[i]=e[i],e[i]=s});try{return t()}finally{r.forEach(i=>{e[i]=n[i]})}}function MZ(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return au?A0.forEach(n=>{e[n]=(...r)=>{t&&rc(()=>{Je.console[n](`${PZ}[${n}]:`,...r)})}}):A0.forEach(n=>{e[n]=()=>{}}),e}const J=MZ(),xZ=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function DZ(t){return t==="http"||t==="https"}function cu(t,e=!1){const{host:n,path:r,pass:i,port:s,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&i?`:${i}`:""}@${n}${s?`:${s}`:""}/${r&&`${r}/`}${o}`}function OZ(t){const e=xZ.exec(t);if(!e){rc(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,r,i="",s,o="",a]=e.slice(1);let c="",l=a;const u=l.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),l=u.pop()),l){const d=l.match(/^\d+/);d&&(l=d[0])}return NP({host:s,pass:i,path:c,projectId:l,port:o,protocol:n,publicKey:r})}function NP(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function LZ(t){if(!au)return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(J.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?DZ(r)?e&&isNaN(parseInt(e,10))?(J.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(J.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(J.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function PP(t){const e=typeof t=="string"?OZ(t):NP(t);if(!(!e||!LZ(e)))return e}class Vi extends Error{constructor(e,n="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}}function gn(t,e,n){if(!(e in t))return;const r=t[e],i=n(r);typeof i=="function"&&MP(i,r),t[e]=i}function Fd(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{au&&J.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function MP(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,Fd(t,"__sentry_original__",e)}catch{}}function HI(t){return t.__sentry_original__}function BZ(t){return Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}function xP(t){if(UI(t))return{message:t.message,name:t.name,stack:t.stack,...LA(t)};if(Dm(t)){const e={type:t.type,target:OA(t.target),currentTarget:OA(t.currentTarget),...LA(t)};return typeof CustomEvent<"u"&&lo(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function OA(t){try{return SZ(t)?nc(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function LA(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function FZ(t,e=40){const n=Object.keys(xP(t));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=e)return hl(n[0],e);for(let r=n.length;r>0;r--){const i=n.slice(0,r).join(", ");if(!(i.length>e))return r===n.length?i:hl(i,e)}return""}function us(t){return k0(t,new Map)}function k0(t,e){if(Ll(t)){const n=e.get(t);if(n!==void 0)return n;const r={};e.set(t,r);for(const i of Object.keys(t))typeof t[i]<"u"&&(r[i]=k0(t[i],e));return r}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const r=[];return e.set(t,r),t.forEach(i=>{r.push(k0(i,e))}),r}return t}const DP=50,BA=/\(error: (.*)\)/,FA=/captureMessage|captureException/;function OP(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0)=>{const i=[],s=n.split(`
`);for(let o=r;o<s.length;o++){const a=s[o];if(a.length>1024)continue;const c=BA.test(a)?a.replace(BA,"$1"):a;if(!c.match(/\S*Error: /)){for(const l of e){const u=l(c);if(u){i.push(u);break}}if(i.length>=DP)break}}return GZ(i)}}function UZ(t){return Array.isArray(t)?OP(...t):t}function GZ(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(e[e.length-1].function||"")&&e.pop(),e.reverse(),FA.test(e[e.length-1].function||"")&&(e.pop(),FA.test(e[e.length-1].function||"")&&e.pop()),e.slice(0,DP).map(n=>({...n,filename:n.filename||e[e.length-1].filename,function:n.function||"?"}))}const cv="<anonymous>";function uo(t){try{return!t||typeof t!="function"?cv:t.name||cv}catch{return cv}}const Lh={},UA={};function fc(t,e){Lh[t]=Lh[t]||[],Lh[t].push(e)}function hc(t,e){UA[t]||(e(),UA[t]=!0)}function wi(t,e){const n=t&&Lh[t];if(n)for(const r of n)try{r(e)}catch(i){au&&J.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${uo(r)}
Error:`,i)}}function VZ(t){const e="console";fc(e,t),hc(e,WZ)}function WZ(){"console"in Je&&A0.forEach(function(t){t in Je.console&&gn(Je.console,t,function(e){return Op[t]=e,function(...n){wi("console",{args:n,level:t});const i=Op[t];i&&i.apply(Je.console,n)}})})}function Un(){const t=Je,e=t.crypto||t.msCrypto;let n=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>{const r=new Uint8Array(1);return e.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(n()&15)>>r/4).toString(16))}function LP(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function Oo(t){const{message:e,event_id:n}=t;if(e)return e;const r=LP(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function E0(t,e,n){const r=t.exception=t.exception||{},i=r.values=r.values||[],s=i[0]=i[0]||{};s.value||(s.value=e||""),s.type||(s.type=n||"Error")}function Ud(t,e){const n=LP(t);if(!n)return;const r={type:"generic",handled:!0},i=n.mechanism;if(n.mechanism={...r,...i,...e},e&&"data"in e){const s={...i&&i.data,...e.data};n.mechanism.data=s}}function GA(t){if(t&&t.__sentry_captured__)return!0;try{Fd(t,"__sentry_captured__",!0)}catch{}return!1}function BP(t){return Array.isArray(t)?t:[t]}const Ec=Je,HZ=1e3;let VA,T0,_0;function FP(t){const e="dom";fc(e,t),hc(e,ZZ)}function ZZ(){if(!Ec.document)return;const t=wi.bind(null,"dom"),e=WA(t,!0);Ec.document.addEventListener("click",e,!1),Ec.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{const r=Ec[n]&&Ec[n].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(gn(r,"addEventListener",function(i){return function(s,o,a){if(s==="click"||s=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__=c.__sentry_instrumentation_handlers__||{},u=l[s]=l[s]||{refCount:0};if(!u.handler){const d=WA(t);u.handler=d,i.call(this,s,d,a)}u.refCount++}catch{}return i.call(this,s,o,a)}}),gn(r,"removeEventListener",function(i){return function(s,o,a){if(s==="click"||s=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__||{},u=l[s];u&&(u.refCount--,u.refCount<=0&&(i.call(this,s,u.handler,a),u.handler=void 0,delete l[s]),Object.keys(l).length===0&&delete c.__sentry_instrumentation_handlers__)}catch{}return i.call(this,s,o,a)}}))})}function jZ(t){if(t.type!==T0)return!1;try{if(!t.target||t.target._sentryId!==_0)return!1}catch{}return!0}function zZ(t,e){return t!=="keypress"?!1:!e||!e.tagName?!0:!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)}function WA(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=XZ(n);if(zZ(n.type,r))return;Fd(n,"_sentryCaptured",!0),r&&!r._sentryId&&Fd(r,"_sentryId",Un());const i=n.type==="keypress"?"input":n.type;jZ(n)||(t({event:n,name:i,global:e}),T0=n.type,_0=r?r._sentryId:void 0),clearTimeout(VA),VA=Ec.setTimeout(()=>{_0=void 0,T0=void 0},HZ)}}function XZ(t){try{return t.target}catch{return null}}const R0=Om();function UP(){if(!("fetch"in R0))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function N0(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function $Z(){if(typeof EdgeRuntime=="string")return!0;if(!UP())return!1;if(N0(R0.fetch))return!0;let t=!1;const e=R0.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=N0(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){au&&J.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}function ZI(t){const e="fetch";fc(e,t),hc(e,KZ)}function KZ(){$Z()&&gn(Je,"fetch",function(t){return function(...e){const{method:n,url:r}=JZ(e),i={args:e,fetchData:{method:n,url:r},startTimestamp:Date.now()};return wi("fetch",{...i}),t.apply(Je,e).then(s=>{const o={...i,endTimestamp:Date.now(),response:s};return wi("fetch",o),s},s=>{const o={...i,endTimestamp:Date.now(),error:s};throw wi("fetch",o),s})}})}function P0(t,e){return!!t&&typeof t=="object"&&!!t[e]}function HA(t){return typeof t=="string"?t:t?P0(t,"url")?t.url:t.toString?t.toString():"":""}function JZ(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,r]=t;return{url:HA(n),method:P0(r,"method")?String(r.method).toUpperCase():"GET"}}const e=t[0];return{url:HA(e),method:P0(e,"method")?String(e.method).toUpperCase():"GET"}}let qf=null;function GP(t){const e="error";fc(e,t),hc(e,YZ)}function YZ(){qf=Je.onerror,Je.onerror=function(t,e,n,r,i){return wi("error",{column:r,error:i,line:n,msg:t,url:e}),qf&&!qf.__SENTRY_LOADER__?qf.apply(this,arguments):!1},Je.onerror.__SENTRY_INSTRUMENTED__=!0}let Qf=null;function VP(t){const e="unhandledrejection";fc(e,t),hc(e,qZ)}function qZ(){Qf=Je.onunhandledrejection,Je.onunhandledrejection=function(t){return wi("unhandledrejection",t),Qf&&!Qf.__SENTRY_LOADER__?Qf.apply(this,arguments):!0},Je.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const eh=Om();function QZ(){const t=eh.chrome,e=t&&t.app&&t.app.runtime,n="history"in eh&&!!eh.history.pushState&&!!eh.history.replaceState;return!e&&n}const _u=Je;let th;function Lm(t){const e="history";fc(e,t),hc(e,ej)}function ej(){if(!QZ())return;const t=_u.onpopstate;_u.onpopstate=function(...n){const r=_u.location.href,i=th;if(th=r,wi("history",{from:i,to:r}),t)try{return t.apply(this,n)}catch{}};function e(n){return function(...r){const i=r.length>2?r[2]:void 0;if(i){const s=th,o=String(i);th=o,wi("history",{from:s,to:o})}return n.apply(this,r)}}gn(_u.history,"pushState",e),gn(_u.history,"replaceState",e)}const tj=Je,jo="__sentry_xhr_v3__";function jI(t){const e="xhr";fc(e,t),hc(e,nj)}function nj(){if(!tj.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;gn(t,"open",function(e){return function(...n){const r=Date.now(),i=ls(n[0])?n[0].toUpperCase():void 0,s=rj(n[1]);if(!i||!s)return e.apply(this,n);this[jo]={method:i,url:s,request_headers:{}},i==="POST"&&s.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const o=()=>{const a=this[jo];if(a&&this.readyState===4){try{a.status_code=this.status}catch{}const c={args:[i,s],endTimestamp:Date.now(),startTimestamp:r,xhr:this};wi("xhr",c)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?gn(this,"onreadystatechange",function(a){return function(...c){return o(),a.apply(this,c)}}):this.addEventListener("readystatechange",o),gn(this,"setRequestHeader",function(a){return function(...c){const[l,u]=c,d=this[jo];return d&&ls(l)&&ls(u)&&(d.request_headers[l.toLowerCase()]=u),a.apply(this,c)}}),e.apply(this,n)}}),gn(t,"send",function(e){return function(...n){const r=this[jo];if(!r)return e.apply(this,n);n[0]!==void 0&&(r.body=n[0]);const i={args:[r.method,r.url],startTimestamp:Date.now(),xhr:this};return wi("xhr",i),e.apply(this,n)}})}function rj(t){if(ls(t))return t;try{return t.toString()}catch{}}function ij(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function sj(){return"npm"}function WP(){return!ij()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function oj(t,e){return t.require(e)}function ZA(){return typeof window<"u"&&(!WP()||aj())}function aj(){return Je.process!==void 0&&Je.process.type==="renderer"}function cj(){const t=typeof WeakSet=="function",e=t?new WeakSet:[];function n(i){if(t)return e.has(i)?!0:(e.add(i),!1);for(let s=0;s<e.length;s++)if(e[s]===i)return!0;return e.push(i),!1}function r(i){if(t)e.delete(i);else for(let s=0;s<e.length;s++)if(e[s]===i){e.splice(s,1);break}}return[n,r]}function Fi(t,e=100,n=1/0){try{return M0("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function HP(t,e=3,n=100*1024){const r=Fi(t,e);return fj(r)>n?HP(t,e-1,n):r}function M0(t,e,n=1/0,r=1/0,i=cj()){const[s,o]=i;if(e==null||["number","boolean","string"].includes(typeof e)&&!EP(e))return e;const a=lj(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(s(e))return"[Circular ~]";const l=e;if(l&&typeof l.toJSON=="function")try{const h=l.toJSON();return M0("",h,c-1,r,i)}catch{}const u=Array.isArray(e)?[]:{};let d=0;const f=xP(e);for(const h in f){if(!Object.prototype.hasOwnProperty.call(f,h))continue;if(d>=r){u[h]="[MaxProperties ~]";break}const p=f[h];u[h]=M0(h,p,c-1,r,i),d++}return o(e),u}function lj(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(TP(e))return"[VueViewModel]";if(wZ(e))return"[SyntheticEvent]";if(typeof e=="number"&&e!==e)return"[NaN]";if(typeof e=="function")return`[Function: ${uo(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=uj(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function uj(t){const e=Object.getPrototypeOf(t);return e?e.constructor.name:"null prototype"}function dj(t){return~-encodeURI(t).split(/%..|./).length}function fj(t){return dj(JSON.stringify(t))}var Ss;(function(t){t[t.PENDING=0]="PENDING";const n=1;t[t.RESOLVED=n]="RESOLVED";const r=2;t[t.REJECTED=r]="REJECTED"})(Ss||(Ss={}));function Bl(t){return new Ar(e=>{e(t)})}function zI(t){return new Ar((e,n)=>{n(t)})}class Ar{constructor(e){Ar.prototype.__init.call(this),Ar.prototype.__init2.call(this),Ar.prototype.__init3.call(this),Ar.prototype.__init4.call(this),this._state=Ss.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new Ar((r,i)=>{this._handlers.push([!1,s=>{if(!e)r(s);else try{r(e(s))}catch(o){i(o)}},s=>{if(!n)i(s);else try{r(n(s))}catch(o){i(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new Ar((n,r)=>{let i,s;return this.then(o=>{s=!1,i=o,e&&e()},o=>{s=!0,i=o,e&&e()}).then(()=>{if(s){r(i);return}n(i)})})}__init(){this._resolve=e=>{this._setResult(Ss.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(Ss.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{if(this._state===Ss.PENDING){if(WI(n)){n.then(this._resolve,this._reject);return}this._state=e,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===Ss.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===Ss.RESOLVED&&n[1](this._value),this._state===Ss.REJECTED&&n[2](this._value),n[0]=!0)})}}}function hj(t){const e=[];function n(){return t===void 0||e.length<t}function r(o){return e.splice(e.indexOf(o),1)[0]}function i(o){if(!n())return zI(new Vi("Not adding Promise because buffer limit was reached."));const a=o();return e.indexOf(a)===-1&&e.push(a),a.then(()=>r(a)).then(null,()=>r(a).then(null,()=>{})),a}function s(o){return new Ar((a,c)=>{let l=e.length;if(!l)return a(!0);const u=setTimeout(()=>{o&&o>0&&a(!1)},o);e.forEach(d=>{Bl(d).then(()=>{--l||(clearTimeout(u),a(!0))},c)})})}return{$:e,add:i,drain:s}}function lv(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}const pj=["fatal","error","warning","log","info","debug"];function mj(t){return t==="warn"?"warning":pj.includes(t)?t:"log"}const ZP=Om(),x0={nowSeconds:()=>Date.now()/1e3};function gj(){const{performance:t}=ZP;if(!t||!t.now)return;const e=Date.now()-t.now();return{now:()=>t.now(),timeOrigin:e}}function vj(){try{return oj(Ox,"perf_hooks").performance}catch{return}}const uv=WP()?vj():gj(),jA=uv===void 0?x0:{nowSeconds:()=>(uv.timeOrigin+uv.now())/1e3},Bm=x0.nowSeconds.bind(x0),ic=jA.nowSeconds.bind(jA),Ti=(()=>{const{performance:t}=ZP;if(!t||!t.now)return;const e=3600*1e3,n=t.now(),r=Date.now(),i=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,s=i<e,o=t.timing&&t.timing.navigationStart,c=typeof o=="number"?Math.abs(o+n-r):e,l=c<e;return s||l?i<=c?t.timeOrigin:o:r})(),D0="baggage",jP="sentry-",yj=/^sentry-/,Cj=8192;function Ij(t){if(!ls(t)&&!Array.isArray(t))return;let e={};if(Array.isArray(t))e=t.reduce((r,i)=>{const s=zA(i);return{...r,...s}},{});else{if(!t)return;e=zA(t)}const n=Object.entries(e).reduce((r,[i,s])=>{if(i.match(yj)){const o=i.slice(jP.length);r[o]=s}return r},{});if(Object.keys(n).length>0)return n}function O0(t){if(!t)return;const e=Object.entries(t).reduce((n,[r,i])=>(i&&(n[`${jP}${r}`]=i),n),{});return Sj(e)}function zA(t){return t.split(",").map(e=>e.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((e,[n,r])=>(e[n]=r,e),{})}function Sj(t){if(Object.keys(t).length!==0)return Object.entries(t).reduce((e,[n,r],i)=>{const s=`${encodeURIComponent(n)}=${encodeURIComponent(r)}`,o=i===0?s:`${e},${s}`;return o.length>Cj?(au&&J.warn(`Not adding key: ${n} with val: ${r} to baggage header due to exceeding baggage size limits.`),e):o},"")}const bj=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function wj(t){if(!t)return;const e=t.match(bj);if(!e)return;let n;return e[3]==="1"?n=!0:e[3]==="0"&&(n=!1),{traceId:e[1],parentSampled:n,parentSpanId:e[2]}}function Aj(t,e){const n=wj(t),r=Ij(e),{traceId:i,parentSpanId:s,parentSampled:o}=n||{},a={traceId:i||Un(),spanId:Un().substring(16),sampled:o};return s&&(a.parentSpanId=s),r&&(a.dsc=r),{traceparentData:n,dynamicSamplingContext:r,propagationContext:a}}function XI(t=Un(),e=Un().substring(16),n){let r="";return n!==void 0&&(r=n?"-1":"-0"),`${t}-${e}${r}`}function pc(t,e=[]){return[t,e]}function kj(t,e){const[n,r]=t;return[n,[...r,e]]}function XA(t,e){const n=t[1];for(const r of n){const i=r[0].type;if(e(r,i))return!0}return!1}function L0(t,e){return(e||new TextEncoder).encode(t)}function Ej(t,e){const[n,r]=t;let i=JSON.stringify(n);function s(o){typeof i=="string"?i=typeof o=="string"?i+o:[L0(i,e),o]:i.push(typeof o=="string"?L0(o,e):o)}for(const o of r){const[a,c]=o;if(s(`
${JSON.stringify(a)}
`),typeof c=="string"||c instanceof Uint8Array)s(c);else{let l;try{l=JSON.stringify(c)}catch{l=JSON.stringify(Fi(c))}s(l)}}return typeof i=="string"?i:Tj(i)}function Tj(t){const e=t.reduce((i,s)=>i+s.length,0),n=new Uint8Array(e);let r=0;for(const i of t)n.set(i,r),r+=i.length;return n}function _j(t,e){const n=typeof t.data=="string"?L0(t.data,e):t.data;return[us({type:"attachment",length:n.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),n]}const Rj={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",statsd:"unknown"};function $A(t){return Rj[t]}function $I(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function zP(t,e,n,r){const i=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&r&&{dsn:cu(r)},...i&&{trace:us({...i})}}}function Nj(t,e,n){const r=[{type:"client_report"},{timestamp:n||Bm(),discarded_events:t}];return pc(e?{dsn:e}:{},[r])}const Pj=60*1e3;function Mj(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?Pj:r-e}function xj(t,e){return t[e]||t.all||0}function XP(t,e,n=Date.now()){return xj(t,e)>n}function $P(t,{statusCode:e,headers:n},r=Date.now()){const i={...t},s=n&&n["x-sentry-rate-limits"],o=n&&n["retry-after"];if(s)for(const a of s.trim().split(",")){const[c,l]=a.split(":",2),u=parseInt(c,10),d=(isNaN(u)?60:u)*1e3;if(!l)i.all=r+d;else for(const f of l.split(";"))i[f]=r+d}else o?i.all=r+Mj(o,r):e===429&&(i.all=r+60*1e3);return i}const Se=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,KI="production";function JI(){return _P("globalEventProcessors",()=>[])}function Dj(t){JI().push(t)}function Lp(t,e,n,r=0){return new Ar((i,s)=>{const o=t[r];if(e===null||typeof o!="function")i(e);else{const a=o({...e},n);Se&&o.id&&a===null&&J.log(`Event processor "${o.id}" dropped event`),WI(a)?a.then(c=>Lp(t,c,n,r+1).then(i)).then(null,s):Lp(t,a,n,r+1).then(i).then(null,s)}})}function Oj(t){const e=ic(),n={sid:Un(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>Bj(n)};return t&&Fl(n,t),n}function Fl(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||ic(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:Un()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function Lj(t,e){let n={};e?n={status:e}:t.status==="ok"&&(n={status:"exited"}),Fl(t,n)}function Bj(t){return us({sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}function KP(t,e){const{fingerprint:n,span:r,breadcrumbs:i,sdkProcessingMetadata:s,propagationContext:o}=e;Fj(t,e),r&&Vj(t,r),Wj(t,n),Uj(t,i),Gj(t,s,o)}function KA(t,e){const{extra:n,tags:r,user:i,contexts:s,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:l,eventProcessors:u,attachments:d,propagationContext:f,transactionName:h,span:p}=e;Ru(t,"extra",n),Ru(t,"tags",r),Ru(t,"user",i),Ru(t,"contexts",s),Ru(t,"sdkProcessingMetadata",a),o&&(t.level=o),h&&(t.transactionName=h),p&&(t.span=p),c.length&&(t.breadcrumbs=[...t.breadcrumbs,...c]),l.length&&(t.fingerprint=[...t.fingerprint,...l]),u.length&&(t.eventProcessors=[...t.eventProcessors,...u]),d.length&&(t.attachments=[...t.attachments,...d]),t.propagationContext={...t.propagationContext,...f}}function Ru(t,e,n){n&&Object.keys(n).length&&(t[e]={...t[e],...n})}function Fj(t,e){const{extra:n,tags:r,user:i,contexts:s,level:o,transactionName:a}=e;n&&Object.keys(n).length&&(t.extra={...n,...t.extra}),r&&Object.keys(r).length&&(t.tags={...r,...t.tags}),i&&Object.keys(i).length&&(t.user={...i,...t.user}),s&&Object.keys(s).length&&(t.contexts={...s,...t.contexts}),o&&(t.level=o),a&&(t.transaction=a)}function Uj(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function Gj(t,e,n){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e,propagationContext:n}}function Vj(t,e){t.contexts={trace:e.getTraceContext(),...t.contexts};const n=e.transaction;if(n){t.sdkProcessingMetadata={dynamicSamplingContext:n.getDynamicSamplingContext(),...t.sdkProcessingMetadata};const r=n.name;r&&(t.tags={transaction:r,...t.tags})}}function Wj(t,e){t.fingerprint=t.fingerprint?BP(t.fingerprint):[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}const Hj=100;let dv;class ss{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=JA()}static clone(e){return e?e.clone():new ss}clone(){const e=new ss;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._span=this._span,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{},this._session&&Fl(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this.getSpan();return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if(typeof e=="function"){const n=e(this);return n instanceof ss?n:this}return e instanceof ss?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession),e._propagationContext&&(this._propagationContext=e._propagationContext)):Ll(e)&&(e=e,this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=JA(),this}addBreadcrumb(e,n){const r=typeof n=="number"?n:Hj;if(r<=0)return this;const i={timestamp:Bm(),...e},s=this._breadcrumbs;return s.push(i),this._breadcrumbs=s.length>r?s.slice(-r):s,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:e,_attachments:n,_contexts:r,_tags:i,_extra:s,_user:o,_level:a,_fingerprint:c,_eventProcessors:l,_propagationContext:u,_sdkProcessingMetadata:d,_transactionName:f,_span:h}=this;return{breadcrumbs:e,attachments:n,contexts:r,tags:i,extra:s,user:o,level:a,fingerprint:c||[],eventProcessors:l,propagationContext:u,sdkProcessingMetadata:d,transactionName:f,span:h}}applyToEvent(e,n={},r=[]){KP(e,this.getScopeData());const i=[...r,...JI(),...this._eventProcessors];return Lp(i,e,n)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function Zj(){return dv||(dv=new ss),dv}function JA(){return{traceId:Un(),spanId:Un().substring(16)}}const Gd="7.91.0",JP=parseFloat(Gd),jj=100;class YP{constructor(e,n=new ss,r=new ss,i=JP){this._version=i,this._stack=[{scope:n}],e&&this.bindClient(e),this._isolationScope=r}isOlderThan(e){return this._version<e}bindClient(e){const n=this.getStackTop();n.client=e,e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(e){const n=this.pushScope();try{return e(n)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,n){const r=this._lastEventId=n&&n.event_id?n.event_id:Un(),i=new Error("Sentry syntheticException");return this._withClient((s,o)=>{s.captureException(e,{originalException:e,syntheticException:i,...n,event_id:r},o)}),r}captureMessage(e,n,r){const i=this._lastEventId=r&&r.event_id?r.event_id:Un(),s=new Error(e);return this._withClient((o,a)=>{o.captureMessage(e,n,{originalException:e,syntheticException:s,...r,event_id:i},a)}),i}captureEvent(e,n){const r=n&&n.event_id?n.event_id:Un();return e.type||(this._lastEventId=r),this._withClient((i,s)=>{i.captureEvent(e,{...n,event_id:r},s)}),r}lastEventId(){return this._lastEventId}addBreadcrumb(e,n){const{scope:r,client:i}=this.getStackTop();if(!i)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:o=jj}=i.getOptions&&i.getOptions()||{};if(o<=0)return;const c={timestamp:Bm(),...e},l=s?rc(()=>s(c,n)):c;l!==null&&(i.emit&&i.emit("beforeAddBreadcrumb",l,n),r.addBreadcrumb(l,o))}setUser(e){this.getScope().setUser(e)}setTags(e){this.getScope().setTags(e)}setExtras(e){this.getScope().setExtras(e)}setTag(e,n){this.getScope().setTag(e,n)}setExtra(e,n){this.getScope().setExtra(e,n)}setContext(e,n){this.getScope().setContext(e,n)}configureScope(e){const{scope:n,client:r}=this.getStackTop();r&&e(n)}run(e){const n=YA(this);try{e(this)}finally{YA(n)}}getIntegration(e){const n=this.getClient();if(!n)return null;try{return n.getIntegration(e)}catch{return Se&&J.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,n){const r=this._callExtensionMethod("startTransaction",e,n);return Se&&!r&&(this.getClient()?J.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):J.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),r}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const n=this.getStackTop().scope,r=n.getSession();r&&Lj(r),this._sendSessionUpdate(),n.setSession()}startSession(e){const{scope:n,client:r}=this.getStackTop(),{release:i,environment:s=KI}=r&&r.getOptions()||{},{userAgent:o}=Je.navigator||{},a=Oj({release:i,environment:s,user:n.getUser(),...o&&{userAgent:o},...e}),c=n.getSession&&n.getSession();return c&&c.status==="ok"&&Fl(c,{status:"exited"}),this.endSession(),n.setSession(a),a}shouldSendDefaultPii(){const e=this.getClient(),n=e&&e.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:n}=this.getStackTop(),r=e.getSession();r&&n&&n.captureSession&&n.captureSession(r)}_withClient(e){const{scope:n,client:r}=this.getStackTop();r&&e(r,n)}_callExtensionMethod(e,...n){const i=vf().__SENTRY__;if(i&&i.extensions&&typeof i.extensions[e]=="function")return i.extensions[e].apply(this,n);Se&&J.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function vf(){return Je.__SENTRY__=Je.__SENTRY__||{extensions:{},hub:void 0},Je}function YA(t){const e=vf(),n=B0(e);return QP(e,t),n}function Vn(){const t=vf();if(t.__SENTRY__&&t.__SENTRY__.acs){const e=t.__SENTRY__.acs.getCurrentHub();if(e)return e}return zj(t)}function qP(){return Vn().getIsolationScope()}function zj(t=vf()){return(!Xj(t)||B0(t).isOlderThan(JP))&&QP(t,new YP),B0(t)}function Xj(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function B0(t){return _P("hub",()=>new YP,t)}function QP(t,e){if(!t)return!1;const n=t.__SENTRY__=t.__SENTRY__||{};return n.hub=e,!0}function yf(t){return(t||Vn()).getScope().getTransaction()}function YI(t){return t>9999999999?t/1e3:t}let qA=!1;function $j(){qA||(qA=!0,GP(F0),VP(F0))}function F0(){const t=yf();if(t){const e="internal_error";Se&&J.log(`[Tracing] Transaction: ${e} -> Global error occured`),t.setStatus(e)}}F0.tag="sentry_tracingErrorCallback";class eM{constructor(e=1e3){this._maxlen=e,this.spans=[]}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class qI{constructor(e={}){this.traceId=e.traceId||Un(),this.spanId=e.spanId||Un().substring(16),this.startTimestamp=e.startTimestamp||ic(),this.tags=e.tags||{},this.data=e.data||{},this.instrumenter=e.instrumenter||"sentry",this.origin=e.origin||"manual",e.parentSpanId&&(this.parentSpanId=e.parentSpanId),"sampled"in e&&(this.sampled=e.sampled),e.op&&(this.op=e.op),e.description&&(this.description=e.description),e.name&&(this.description=e.name),e.status&&(this.status=e.status),e.endTimestamp&&(this.endTimestamp=e.endTimestamp)}get name(){return this.description||""}set name(e){this.setName(e)}startChild(e){const n=new qI({...e,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(n.spanRecorder=this.spanRecorder,n.spanRecorder&&n.spanRecorder.add(n),n.transaction=this.transaction,Se&&n.transaction){const r=e&&e.op||"< unknown op >",i=n.transaction.name||"< unknown name >",s=n.transaction.spanId,o=`[Tracing] Starting '${r}' span on transaction '${i}' (${s}).`;n.transaction.metadata.spanMetadata[n.spanId]={logMessage:o},J.log(o)}return n}setTag(e,n){return this.tags={...this.tags,[e]:n},this}setData(e,n){return this.data={...this.data,[e]:n},this}setStatus(e){return this.status=e,this}setHttpStatus(e){this.setTag("http.status_code",String(e)),this.setData("http.response.status_code",e);const n=Kj(e);return n!=="unknown_error"&&this.setStatus(n),this}setName(e){this.description=e}isSuccess(){return this.status==="ok"}finish(e){return this.end(e)}end(e){if(Se&&this.transaction&&this.transaction.spanId!==this.spanId){const{logMessage:n}=this.transaction.metadata.spanMetadata[this.spanId];n&&J.log(n.replace("Starting","Finishing"))}this.endTimestamp=typeof e=="number"?YI(e):ic()}toTraceparent(){return XI(this.traceId,this.spanId,this.sampled)}toContext(){return us({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(e){return this.data=e.data||{},this.description=e.description,this.endTimestamp=e.endTimestamp,this.op=e.op,this.parentSpanId=e.parentSpanId,this.sampled=e.sampled,this.spanId=e.spanId||this.spanId,this.startTimestamp=e.startTimestamp||this.startTimestamp,this.status=e.status,this.tags=e.tags||{},this.traceId=e.traceId||this.traceId,this}getTraceContext(){return us({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId,origin:this.origin})}toJSON(){return us({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId,origin:this.origin})}}function Kj(t){if(t<400&&t>=100)return"ok";if(t>=400&&t<500)switch(t){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(t>=500&&t<600)switch(t){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}function Fm(t,e,n){const r=e.getOptions(),{publicKey:i}=e.getDsn()||{},{segment:s}=n&&n.getUser()||{},o=us({environment:r.environment||KI,release:r.release,user_segment:s,public_key:i,trace_id:t});return e.emit&&e.emit("createDsc",o),o}class tM extends qI{constructor(e,n){super(e),delete this.description,this._measurements={},this._contexts={},this._hub=n||Vn(),this._name=e.name||"",this.metadata={source:"custom",...e.metadata,spanMetadata:{}},this._trimEnd=e.trimEnd,this.transaction=this;const r=this.metadata.dynamicSamplingContext;r&&(this._frozenDynamicSamplingContext={...r})}get name(){return this._name}set name(e){this.setName(e)}setName(e,n="custom"){this._name=e,this.metadata.source=n}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new eM(e)),this.spanRecorder.add(this)}setContext(e,n){n===null?delete this._contexts[e]:this._contexts[e]=n}setMeasurement(e,n,r=""){this._measurements[e]={value:n,unit:r}}setMetadata(e){this.metadata={...this.metadata,...e}}end(e){const n=typeof e=="number"?YI(e):ic(),r=this._finishTransaction(n);if(r)return this._hub.captureEvent(r)}toContext(){const e=super.toContext();return us({...e,name:this.name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this.name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;const e=this._hub||Vn(),n=e.getClient();if(!n)return{};const r=e.getScope(),i=Fm(this.traceId,n,r),s=this.metadata.sampleRate;s!==void 0&&(i.sample_rate=`${s}`);const o=this.metadata.source;return o&&o!=="url"&&(i.transaction=this.name),this.sampled!==void 0&&(i.sampled=String(this.sampled)),i}setHub(e){this._hub=e}_finishTransaction(e){if(this.endTimestamp!==void 0)return;this.name||(Se&&J.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.end(e);const n=this._hub.getClient();if(n&&n.emit&&n.emit("finishTransaction",this),this.sampled!==!0){Se&&J.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),n&&n.recordDroppedEvent("sample_rate","transaction");return}const r=this.spanRecorder?this.spanRecorder.spans.filter(a=>a!==this&&a.endTimestamp):[];this._trimEnd&&r.length>0&&(this.endTimestamp=r.reduce((a,c)=>a.endTimestamp&&c.endTimestamp?a.endTimestamp>c.endTimestamp?a:c:a).endTimestamp);const i=this.metadata,s={contexts:{...this._contexts,trace:this.getTraceContext()},spans:r,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...i,dynamicSamplingContext:this.getDynamicSamplingContext()},...i.source&&{transaction_info:{source:i.source}}};return Object.keys(this._measurements).length>0&&(Se&&J.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),s.measurements=this._measurements),Se&&J.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),s}}const Bh={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},Jj="finishReason",wc=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class Yj extends eM{constructor(e,n,r,i){super(i),this._pushActivity=e,this._popActivity=n,this.transactionSpanId=r}add(e){if(e.spanId!==this.transactionSpanId){const n=e.end;e.end=(...r)=>(this._popActivity(e.spanId),n.apply(e,r)),e.endTimestamp===void 0&&this._pushActivity(e.spanId)}super.add(e)}}class qj extends tM{constructor(e,n,r=Bh.idleTimeout,i=Bh.finalTimeout,s=Bh.heartbeatInterval,o=!1){super(e,n),this._idleHub=n,this._idleTimeout=r,this._finalTimeout=i,this._heartbeatInterval=s,this._onScope=o,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=wc[4],o&&(Se&&J.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`),n.getScope().setSpan(this)),this._restartIdleTimeout(),setTimeout(()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=wc[3],this.end())},this._finalTimeout)}end(e=ic()){const n=YI(e);if(this._finished=!0,this.activities={},this.op==="ui.action.click"&&this.setTag(Jj,this._finishReason),this.spanRecorder){Se&&J.log("[Tracing] finishing IdleTransaction",new Date(n*1e3).toISOString(),this.op);for(const r of this._beforeFinishCallbacks)r(this,e);this.spanRecorder.spans=this.spanRecorder.spans.filter(r=>{if(r.spanId===this.spanId)return!0;r.endTimestamp||(r.endTimestamp=n,r.setStatus("cancelled"),Se&&J.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(r,void 0,2)));const i=r.startTimestamp<n,s=(this._finalTimeout+this._idleTimeout)/1e3,o=r.endTimestamp-this.startTimestamp<s;if(Se){const a=JSON.stringify(r,void 0,2);i?o||J.log("[Tracing] discarding Span since it finished after Transaction final timeout",a):J.log("[Tracing] discarding Span since it happened after Transaction was finished",a)}return i&&o}),Se&&J.log("[Tracing] flushing IdleTransaction")}else Se&&J.log("[Tracing] No active IdleTransaction");if(this._onScope){const r=this._idleHub.getScope();r.getTransaction()===this&&r.setSpan(void 0)}return super.end(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){const n=i=>{this._finished||this._pushActivity(i)},r=i=>{this._finished||this._popActivity(i)};this.spanRecorder=new Yj(n,r,this.spanId,e),Se&&J.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:n}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=n===!1,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,Object.keys(this.activities).length===0&&this._idleTimeoutCanceledPermanently&&(this._finishReason=wc[5],this.end(e)))}setFinishReason(e){this._finishReason=e}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout(()=>{!this._finished&&Object.keys(this.activities).length===0&&(this._finishReason=wc[1],this.end(e))},this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),Se&&J.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,Se&&J.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&(Se&&J.log(`[Tracing] popActivity ${e}`),delete this.activities[e],Se&&J.log("[Tracing] new activities count",Object.keys(this.activities).length)),Object.keys(this.activities).length===0){const n=ic();this._idleTimeoutCanceledPermanently?(this._finishReason=wc[5],this.end(n)):this._restartIdleTimeout(n+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?(Se&&J.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=wc[0],this.end()):this._pingHeartbeat()}_pingHeartbeat(){Se&&J.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout(()=>{this._beat()},this._heartbeatInterval)}}function nM(t,e,n,r,i,s){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,c={...e,event_id:e.event_id||n.event_id||Un(),timestamp:e.timestamp||Bm()},l=n.integrations||t.integrations.map(y=>y.name);Qj(c,t),nz(c,l),e.type===void 0&&ez(c,t.stackParser);const u=iz(r,n.captureContext);n.mechanism&&Ud(c,n.mechanism);const d=i&&i.getEventProcessors?i.getEventProcessors():[],f=Zj().getScopeData();if(s){const y=s.getScopeData();KA(f,y)}if(u){const y=u.getScopeData();KA(f,y)}const h=[...n.attachments||[],...f.attachments];h.length&&(n.attachments=h),KP(c,f);const p=[...d,...JI(),...f.eventProcessors];return Lp(p,c,n).then(y=>(y&&tz(y),typeof o=="number"&&o>0?rz(y,o,a):y))}function Qj(t,e){const{environment:n,release:r,dist:i,maxValueLength:s=250}=e;"environment"in t||(t.environment="environment"in e?n:KI),t.release===void 0&&r!==void 0&&(t.release=r),t.dist===void 0&&i!==void 0&&(t.dist=i),t.message&&(t.message=hl(t.message,s));const o=t.exception&&t.exception.values&&t.exception.values[0];o&&o.value&&(o.value=hl(o.value,s));const a=t.request;a&&a.url&&(a.url=hl(a.url,s))}const QA=new WeakMap;function ez(t,e){const n=Je._sentryDebugIds;if(!n)return;let r;const i=QA.get(e);i?r=i:(r=new Map,QA.set(e,r));const s=Object.keys(n).reduce((o,a)=>{let c;const l=r.get(a);l?c=l:(c=e(a),r.set(a,c));for(let u=c.length-1;u>=0;u--){const d=c[u];if(d.filename){o[d.filename]=n[a];break}}return o},{});try{t.exception.values.forEach(o=>{o.stacktrace.frames.forEach(a=>{a.filename&&(a.debug_id=s[a.filename])})})}catch{}}function tz(t){const e={};try{t.exception.values.forEach(r=>{r.stacktrace.frames.forEach(i=>{i.debug_id&&(i.abs_path?e[i.abs_path]=i.debug_id:i.filename&&(e[i.filename]=i.debug_id),delete i.debug_id)})})}catch{}if(Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.keys(e).forEach(r=>{n.push({type:"sourcemap",code_file:r,debug_id:e[r]})})}function nz(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function rz(t,e,n){if(!t)return null;const r={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(i=>({...i,...i.data&&{data:Fi(i.data,e,n)}}))},...t.user&&{user:Fi(t.user,e,n)},...t.contexts&&{contexts:Fi(t.contexts,e,n)},...t.extra&&{extra:Fi(t.extra,e,n)}};return t.contexts&&t.contexts.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=Fi(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(i=>(i.data&&(i.data=Fi(i.data,e,n)),i))),r}function iz(t,e){if(!e)return t;const n=t?t.clone():new ss;return n.update(e),n}function sz(t){if(t)return oz(t)?{captureContext:t}:cz(t)?{captureContext:t}:t}function oz(t){return t instanceof ss||typeof t=="function"}const az=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function cz(t){return Object.keys(t).some(e=>az.includes(e))}function Um(t,e){return Vn().captureException(t,sz(e))}function rM(t,e){return Vn().captureEvent(t,e)}function fa(t,e){Vn().addBreadcrumb(t,e)}function lz(t,e){Vn().setContext(t,e)}function iM(t){return Vn().withScope(t)}function Mt(){return Vn().getClient()}function Cf(){return Vn().getScope()}function QI(t){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=Mt(),n=t||e&&e.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function sM(t,e,n){if(!QI(e))return t.sampled=!1,t;if(t.sampled!==void 0)return t.setMetadata({sampleRate:Number(t.sampled)}),t;let r;return typeof e.tracesSampler=="function"?(r=e.tracesSampler(n),t.setMetadata({sampleRate:Number(r)})):n.parentSampled!==void 0?r=n.parentSampled:typeof e.tracesSampleRate<"u"?(r=e.tracesSampleRate,t.setMetadata({sampleRate:Number(r)})):(r=1,t.setMetadata({sampleRate:r})),uz(r)?r?(t.sampled=Math.random()<r,t.sampled?(Se&&J.log(`[Tracing] starting ${t.op} transaction - ${t.name}`),t):(Se&&J.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(r)})`),t)):(Se&&J.log(`[Tracing] Discarding transaction because ${typeof e.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),t.sampled=!1,t):(Se&&J.warn("[Tracing] Discarding transaction because of invalid sample rate."),t.sampled=!1,t)}function uz(t){return EP(t)||!(typeof t=="number"||typeof t=="boolean")?(Se&&J.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(t)} of type ${JSON.stringify(typeof t)}.`),!1):t<0||t>1?(Se&&J.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${t}.`),!1):!0}function dz(){const e=this.getScope().getSpan();return e?{"sentry-trace":e.toTraceparent()}:{}}function fz(t,e){const n=this.getClient(),r=n&&n.getOptions()||{},i=r.instrumenter||"sentry",s=t.instrumenter||"sentry";i!==s&&(Se&&J.error(`A transaction was started with instrumenter=\`${s}\`, but the SDK is configured with the \`${i}\` instrumenter.
The transaction will not be sampled. Please use the ${i} instrumentation to start transactions.`),t.sampled=!1);let o=new tM(t,this);return o=sM(o,r,{parentSampled:t.parentSampled,transactionContext:t,...e}),o.sampled&&o.initSpanRecorder(r._experiments&&r._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",o),o}function ek(t,e,n,r,i,s,o){const a=t.getClient(),c=a&&a.getOptions()||{};let l=new qj(e,t,n,r,o,i);return l=sM(l,c,{parentSampled:e.parentSampled,transactionContext:e,...s}),l.sampled&&l.initSpanRecorder(c._experiments&&c._experiments.maxSpans),a&&a.emit&&a.emit("startTransaction",l),l}function hz(){const t=vf();t.__SENTRY__&&(t.__SENTRY__.extensions=t.__SENTRY__.extensions||{},t.__SENTRY__.extensions.startTransaction||(t.__SENTRY__.extensions.startTransaction=fz),t.__SENTRY__.extensions.traceHeaders||(t.__SENTRY__.extensions.traceHeaders=dz),$j())}function pz(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function mz(t,e,n,r){const i=$I(n),s={sent_at:new Date().toISOString(),...i&&{sdk:i},...!!r&&e&&{dsn:cu(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return pc(s,[o])}function gz(t,e,n,r){const i=$I(n),s=t.type&&t.type!=="replay_event"?t.type:"event";pz(t,n&&n.sdk);const o=zP(t,i,r,e);return delete t.sdkProcessingMetadata,pc(o,[[{type:s},t]])}const vz="7";function oM(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function yz(t){return`${oM(t)}${t.projectId}/envelope/`}function Cz(t,e){return BZ({sentry_key:t.publicKey,sentry_version:vz,...e&&{sentry_client:`${e.name}/${e.version}`}})}function Iz(t,e={}){const n=typeof e=="string"?e:e.tunnel,r=typeof e=="string"||!e._metadata?void 0:e._metadata.sdk;return n||`${yz(t)}?${Cz(t,r)}`}function Sz(t,e){const n=PP(t);if(!n)return"";const r=`${oM(n)}embed/error-page/`;let i=`dsn=${cu(n)}`;for(const s in e)if(s!=="dsn"&&s!=="onClose")if(s==="user"){const o=e.user;if(!o)continue;o.name&&(i+=`&name=${encodeURIComponent(o.name)}`),o.email&&(i+=`&email=${encodeURIComponent(o.email)}`)}else i+=`&${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`;return`${r}?${i}`}const tk=[];function bz(t){const e={};return t.forEach(n=>{const{name:r}=n,i=e[r];i&&!i.isDefaultInstance&&n.isDefaultInstance||(e[r]=n)}),Object.keys(e).map(n=>e[n])}function wz(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(o=>{o.isDefaultInstance=!0});let r;Array.isArray(n)?r=[...e,...n]:typeof n=="function"?r=BP(n(e)):r=e;const i=bz(r),s=kz(i,o=>o.name==="Debug");if(s!==-1){const[o]=i.splice(s,1);i.push(o)}return i}function Az(t,e){const n={};return e.forEach(r=>{r&&aM(t,r,n)}),n}function aM(t,e,n){if(n[e.name]=e,tk.indexOf(e.name)===-1&&(e.setupOnce(Dj,Vn),tk.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),t.on&&typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(i,s)=>r(i,s,t))}if(t.addEventProcessor&&typeof e.processEvent=="function"){const r=e.processEvent.bind(e),i=Object.assign((s,o)=>r(s,o,t),{id:e.name});t.addEventProcessor(i)}Se&&J.log(`Integration installed: ${e.name}`)}function kz(t,e){for(let n=0;n<t.length;n++)if(e(t[n])===!0)return n;return-1}function ba(t,e){return Object.assign(function(...r){return{setupOnce:()=>{},...e(...r)}},{id:t})}function Ez(t){let e="";for(const n of t){const r=Object.entries(n.tags),i=r.length>0?`|#${r.map(([s,o])=>`${s}:${o}`).join(",")}`:"";e+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${i}|T${n.timestamp}
`}return e}function Tz(t,e,n,r){const i={sent_at:new Date().toISOString()};n&&n.sdk&&(i.sdk={name:n.sdk.name,version:n.sdk.version}),r&&e&&(i.dsn=cu(e));const s=_z(t);return pc(i,[s])}function _z(t){const e=Ez(t);return[{type:"statsd",length:e.length},e]}const nk="Not capturing exception because it's already been captured.";class Rz{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=PP(e.dsn):Se&&J.warn("No DSN provided, client will not send events."),this._dsn){const n=Iz(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}}captureException(e,n,r){if(GA(e)){Se&&J.log(nk);return}let i=n&&n.event_id;return this._process(this.eventFromException(e,n).then(s=>this._captureEvent(s,n,r)).then(s=>{i=s})),i}captureMessage(e,n,r,i){let s=r&&r.event_id;const o=VI(e)?this.eventFromMessage(String(e),n,r):this.eventFromException(e,r);return this._process(o.then(a=>this._captureEvent(a,r,i)).then(a=>{s=a})),s}captureEvent(e,n,r){if(n&&n.originalException&&GA(n.originalException)){Se&&J.log(nk);return}let i=n&&n.event_id;return this._process(this._captureEvent(e,n,r).then(s=>{i=s})),i}captureSession(e){typeof e.release!="string"?Se&&J.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),Fl(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(e).then(r=>n.flush(e).then(i=>r&&i))):Bl(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&(this._integrations=Az(this,this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch{return Se&&J.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){aM(this,e,this._integrations)}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=gz(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])r=kj(r,_j(s,this._options.transportOptions&&this._options.transportOptions.textEncoder));const i=this._sendEnvelope(r);i&&i.then(s=>this.emit("afterSendEvent",e,s),null)}sendSession(e){const n=mz(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}recordDroppedEvent(e,n,r){if(this._options.sendClientReports){const i=`${e}:${n}`;Se&&J.log(`Adding outcome: "${i}"`),this._outcomes[i]=this._outcomes[i]+1||1}}captureAggregateMetrics(e){Se&&J.log(`Flushing aggregated metrics, number of metrics: ${e.length}`);const n=Tz(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}on(e,n){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(n)}emit(e,...n){this._hooks[e]&&this._hooks[e].forEach(r=>r(...n))}_updateSessionFromEvent(e,n){let r=!1,i=!1;const s=n.exception&&n.exception.values;if(s){i=!0;for(const c of s){const l=c.mechanism;if(l&&l.handled===!1){r=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&(Fl(e,{...r&&{status:"crashed"},errors:e.errors||Number(i||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Ar(n=>{let r=0;const i=1,s=setInterval(()=>{this._numProcessing==0?(clearInterval(s),n(!0)):(r+=i,e&&r>=e&&(clearInterval(s),n(!1)))},i)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r,i=qP()){const s=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&o.length>0&&(n.integrations=o),this.emit("preprocessEvent",e,n),nM(s,e,n,r,this,i).then(a=>{if(a===null)return a;const{propagationContext:c}=a.sdkProcessingMetadata||{};if(!(a.contexts&&a.contexts.trace)&&c){const{traceId:u,spanId:d,parentSpanId:f,dsc:h}=c;a.contexts={trace:{trace_id:u,span_id:d,parent_span_id:f},...a.contexts};const p=h||Fm(u,this,r);a.sdkProcessingMetadata={dynamicSamplingContext:p,...a.sdkProcessingMetadata}}return a})}_captureEvent(e,n={},r){return this._processEvent(e,n,r).then(i=>i.event_id,i=>{if(Se){const s=i;s.logLevel==="log"?J.log(s.message):J.warn(s)}})}_processEvent(e,n,r){const i=this.getOptions(),{sampleRate:s}=i,o=lM(e),a=cM(e),c=e.type||"error",l=`before send for type \`${c}\``;if(a&&typeof s=="number"&&Math.random()>s)return this.recordDroppedEvent("sample_rate","error",e),zI(new Vi(`Discarding event because it's not included in the random sample (sampling rate = ${s})`,"log"));const u=c==="replay_event"?"replay":c;return this._prepareEvent(e,n,r).then(d=>{if(d===null)throw this.recordDroppedEvent("event_processor",u,e),new Vi("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return d;const h=Pz(i,d,n);return Nz(h,l)}).then(d=>{if(d===null)throw this.recordDroppedEvent("before_send",u,e),new Vi(`${l} returned \`null\`, will not send event.`,"log");const f=r&&r.getSession();!o&&f&&this._updateSessionFromEvent(f,d);const h=d.transaction_info;if(o&&h&&d.transaction!==e.transaction){const p="custom";d.transaction_info={...h,source:p}}return this.sendEvent(d,n),d}).then(null,d=>{throw d instanceof Vi?d:(this.captureException(d,{data:{__sentry__:!0},originalException:d}),new Vi(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${d}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,n=>{Se&&J.error("Error while sending event:",n)});Se&&J.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map(n=>{const[r,i]=n.split(":");return{reason:r,category:i,quantity:e[n]}})}}function Nz(t,e){const n=`${e} must return \`null\` or a valid event.`;if(WI(t))return t.then(r=>{if(!Ll(r)&&r!==null)throw new Vi(n);return r},r=>{throw new Vi(`${e} rejected with ${r}`)});if(!Ll(t)&&t!==null)throw new Vi(n);return t}function Pz(t,e,n){const{beforeSend:r,beforeSendTransaction:i}=t;return cM(e)&&r?r(e,n):lM(e)&&i?i(e,n):e}function cM(t){return t.type===void 0}function lM(t){return t.type==="transaction"}function Mz(t){const e=Mt();!e||!e.addEventProcessor||e.addEventProcessor(t)}function xz(t,e){e.debug===!0&&(Se?J.enable():rc(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")}));const n=Vn();n.getScope().update(e.initialScope);const i=new t(e);n.bindClient(i)}const Dz=30;function uM(t,e,n=hj(t.bufferSize||Dz)){let r={};const i=o=>n.drain(o);function s(o){const a=[];if(XA(o,(d,f)=>{const h=$A(f);if(XP(r,h)){const p=rk(d,f);t.recordDroppedEvent("ratelimit_backoff",h,p)}else a.push(d)}),a.length===0)return Bl();const c=pc(o[0],a),l=d=>{XA(c,(f,h)=>{const p=rk(f,h);t.recordDroppedEvent(d,$A(h),p)})},u=()=>e({body:Ej(c,t.textEncoder)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&Se&&J.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=$P(r,d),d),d=>{throw l("network_error"),d});return n.add(u).then(d=>d,d=>{if(d instanceof Vi)return Se&&J.error("Skipped sending event because buffer is full."),l("queue_overflow"),Bl();throw d})}return s.__sentry__baseTransport__=!0,{send:s,flush:i}}function rk(t,e){if(!(e!=="event"&&e!=="transaction"))return Array.isArray(t)?t[1]:void 0}let ik;const dM="FunctionToString",Oz=()=>({name:dM,setupOnce(){ik=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=HI(this)||this;return ik.apply(e,t)}}catch{}}}),Lz=ba(dM,Oz),Bz=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],Fz=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],fM="InboundFilters",Uz=t=>({name:fM,processEvent(e,n,r){const i=r.getOptions(),s=Vz(t,i);return Wz(e,s)?null:e}}),Gz=ba(fM,Uz);function Vz(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:Bz],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[],...t.disableTransactionDefaults?[]:Fz],ignoreInternal:t.ignoreInternal!==void 0?t.ignoreInternal:!0}}function Wz(t,e){return e.ignoreInternal&&$z(t)?(Se&&J.warn(`Event dropped due to being internal Sentry Error.
Event: ${Oo(t)}`),!0):Hz(t,e.ignoreErrors)?(Se&&J.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Oo(t)}`),!0):Zz(t,e.ignoreTransactions)?(Se&&J.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Oo(t)}`),!0):jz(t,e.denyUrls)?(Se&&J.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Oo(t)}.
Url: ${Bp(t)}`),!0):zz(t,e.allowUrls)?!1:(Se&&J.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Oo(t)}.
Url: ${Bp(t)}`),!0)}function Hz(t,e){return t.type||!e||!e.length?!1:Xz(t).some(n=>ou(n,e))}function Zz(t,e){if(t.type!=="transaction"||!e||!e.length)return!1;const n=t.transaction;return n?ou(n,e):!1}function jz(t,e){if(!e||!e.length)return!1;const n=Bp(t);return n?ou(n,e):!1}function zz(t,e){if(!e||!e.length)return!0;const n=Bp(t);return n?ou(n,e):!0}function Xz(t){const e=[];t.message&&e.push(t.message);let n;try{n=t.exception.values[t.exception.values.length-1]}catch{}return n&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`)),Se&&e.length===0&&J.error(`Could not extract message for event ${Oo(t)}`),e}function $z(t){try{return t.exception.values[0].type==="SentryError"}catch{}return!1}function Kz(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Bp(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?Kz(e):null}catch{return Se&&J.error(`Cannot extract url for event ${Oo(t)}`),null}}function Jz(t,e){const n=e&&Qz(e)?e.getClient():e,r=n&&n.getDsn(),i=n&&n.getOptions().tunnel;return qz(t,r)||Yz(t,i)}function Yz(t,e){return e?sk(t)===sk(e):!1}function qz(t,e){return e?t.includes(e.host):!1}function sk(t){return t[t.length-1]==="/"?t.slice(0,-1):t}function Qz(t){return t.getClient!==void 0}const ze=Je;let U0=0;function hM(){return U0>0}function e7(){U0++,setTimeout(()=>{U0--})}function Ul(t,e={},n){if(typeof t!="function")return t;try{const i=t.__sentry_wrapped__;if(i)return i;if(HI(t))return t}catch{return t}const r=function(){const i=Array.prototype.slice.call(arguments);try{n&&typeof n=="function"&&n.apply(this,arguments);const s=i.map(o=>Ul(o,e));return t.apply(this,s)}catch(s){throw e7(),iM(o=>{o.addEventProcessor(a=>(e.mechanism&&(E0(a,void 0,void 0),Ud(a,e.mechanism)),a.extra={...a.extra,arguments:i},a)),Um(s)}),s}};try{for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}catch{}MP(r,t),Fd(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch{}return r}const Hr=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function pM(t,e){const n=eS(t,e),r={type:e&&e.name,value:i7(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function t7(t,e,n,r){const i=Mt(),s=i&&i.getOptions().normalizeDepth,o={exception:{values:[{type:Dm(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:a7(e,{isUnhandledRejection:r})}]},extra:{__serialized__:HP(e,s)}};if(n){const a=eS(t,n);a.length&&(o.exception.values[0].stacktrace={frames:a})}return o}function fv(t,e){return{exception:{values:[pM(t,e)]}}}function eS(t,e){const n=e.stacktrace||e.stack||"",r=r7(e);try{return t(n,r)}catch{}return[]}const n7=/Minified React error #\d+;/i;function r7(t){if(t){if(typeof t.framesToPop=="number")return t.framesToPop;if(n7.test(t.message))return 1}return 0}function i7(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function s7(t,e,n,r){const i=n&&n.syntheticException||void 0,s=tS(t,e,i,r);return Ud(s),s.level="error",n&&n.event_id&&(s.event_id=n.event_id),Bl(s)}function o7(t,e,n="info",r,i){const s=r&&r.syntheticException||void 0,o=G0(t,e,s,i);return o.level=n,r&&r.event_id&&(o.event_id=r.event_id),Bl(o)}function tS(t,e,n,r,i){let s;if(GI(e)&&e.error)return fv(t,e.error);if(PA(e)||IZ(e)){const o=e;if("stack"in e)s=fv(t,e);else{const a=o.name||(PA(o)?"DOMError":"DOMException"),c=o.message?`${a}: ${o.message}`:a;s=G0(t,c,n,r),E0(s,c)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":`${o.code}`}),s}return UI(e)?fv(t,e):Ll(e)||Dm(e)?(s=t7(t,e,n,i),Ud(s,{synthetic:!0}),s):(s=G0(t,e,n,r),E0(s,`${e}`,void 0),Ud(s,{synthetic:!0}),s)}function G0(t,e,n,r){const i={message:e};if(r&&n){const s=eS(t,n);s.length&&(i.exception={values:[{value:e,stacktrace:{frames:s}}]})}return i}function a7(t,{isUnhandledRejection:e}){const n=FZ(t),r=e?"promise rejection":"exception";return GI(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:Dm(t)?`Event \`${c7(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function c7(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function l7(t,{metadata:e,tunnel:n,dsn:r}){const i={event_id:t.event_id,sent_at:new Date().toISOString(),...e&&e.sdk&&{sdk:{name:e.sdk.name,version:e.sdk.version}},...!!n&&!!r&&{dsn:cu(r)}},s=u7(t);return pc(i,[s])}function u7(t){return[{type:"user_report"},t]}class d7 extends Rz{constructor(e){const n=ze.SENTRY_SDK_SOURCE||sj();e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${n}:@sentry/browser`,version:Gd}],version:Gd},super(e),e.sendClientReports&&ze.document&&ze.document.addEventListener("visibilitychange",()=>{ze.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,n){return s7(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return o7(this._options.stackParser,e,n,r,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled()){Hr&&J.warn("SDK not enabled, will not capture user feedback.");return}const n=l7(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(n)}_prepareEvent(e,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r)}_flushOutcomes(){const e=this._clearOutcomes();if(e.length===0){Hr&&J.log("No outcomes to send");return}if(!this._dsn){Hr&&J.log("No dsn provided, will not send outcomes");return}Hr&&J.log("Sending outcomes:",e);const n=Nj(e,this._options.tunnel&&cu(this._dsn));this._sendEnvelope(n)}}let Gu;function f7(){if(Gu)return Gu;if(N0(ze.fetch))return Gu=ze.fetch.bind(ze);const t=ze.document;let e=ze.fetch;if(t&&typeof t.createElement=="function")try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n);const r=n.contentWindow;r&&r.fetch&&(e=r.fetch),t.head.removeChild(n)}catch(n){Hr&&J.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return Gu=e.bind(ze)}function h7(){Gu=void 0}function p7(t,e=f7()){let n=0,r=0;function i(s){const o=s.body.length;n+=o,r++;const a={body:s.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};try{return e(t.url,a).then(c=>(n-=o,r--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return h7(),n-=o,r--,zI(c)}}return uM(t,i)}const m7=4;function g7(t){function e(n){return new Ar((r,i)=>{const s=new XMLHttpRequest;s.onerror=i,s.onreadystatechange=()=>{s.readyState===m7&&r({statusCode:s.status,headers:{"x-sentry-rate-limits":s.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":s.getResponseHeader("Retry-After")}})},s.open("POST",t.url);for(const o in t.headers)Object.prototype.hasOwnProperty.call(t.headers,o)&&s.setRequestHeader(o,t.headers[o]);s.send(n.body)})}return uM(t,e)}const Gm="?",v7=30,y7=40,C7=50;function nS(t,e,n,r){const i={filename:t,function:e,in_app:!0};return n!==void 0&&(i.lineno=n),r!==void 0&&(i.colno=r),i}const I7=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,S7=/\((\S*)(?::(\d+))(?::(\d+))\)/,b7=t=>{const e=I7.exec(t);if(e){if(e[2]&&e[2].indexOf("eval")===0){const s=S7.exec(e[2]);s&&(e[2]=s[1],e[3]=s[2],e[4]=s[3])}const[r,i]=mM(e[1]||Gm,e[2]);return nS(i,r,e[3]?+e[3]:void 0,e[4]?+e[4]:void 0)}},w7=[v7,b7],A7=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,k7=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,E7=t=>{const e=A7.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const s=k7.exec(e[3]);s&&(e[1]=e[1]||"eval",e[3]=s[1],e[4]=s[2],e[5]="")}let r=e[3],i=e[1]||Gm;return[i,r]=mM(i,r),nS(r,i,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},T7=[C7,E7],_7=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,R7=t=>{const e=_7.exec(t);return e?nS(e[2],e[1]||Gm,+e[3],e[4]?+e[4]:void 0):void 0},N7=[y7,R7],P7=[w7,T7,N7],M7=OP(...P7),mM=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:Gm,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},gM="GlobalHandlers",x7=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:gM,setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&(O7(n),ok("onerror")),e.onunhandledrejection&&(L7(n),ok("onunhandledrejection"))}}},D7=ba(gM,x7);function O7(t){GP(e=>{const{stackParser:n,attachStacktrace:r}=yM();if(Mt()!==t||hM())return;const{msg:i,url:s,line:o,column:a,error:c}=e,l=c===void 0&&ls(i)?U7(i,s,o,a):vM(tS(n,c||i,void 0,r,!1),s,o,a);l.level="error",rM(l,{originalException:c,mechanism:{handled:!1,type:"onerror"}})})}function L7(t){VP(e=>{const{stackParser:n,attachStacktrace:r}=yM();if(Mt()!==t||hM())return;const i=B7(e),s=VI(i)?F7(i):tS(n,i,void 0,r,!0);s.level="error",rM(s,{originalException:i,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function B7(t){if(VI(t))return t;const e=t;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return t}function F7(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function U7(t,e,n,r){const i=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let s=GI(t)?t.message:t,o="Error";const a=s.match(i);return a&&(o=a[1],s=a[2]),vM({exception:{values:[{type:o,value:s}]}},e,n,r)}function vM(t,e,n,r){const i=t.exception=t.exception||{},s=i.values=i.values||[],o=s[0]=s[0]||{},a=o.stacktrace=o.stacktrace||{},c=a.frames=a.frames||[],l=isNaN(parseInt(r,10))?void 0:r,u=isNaN(parseInt(n,10))?void 0:n,d=ls(e)&&e.length>0?e:RZ();return c.length===0&&c.push({colno:l,filename:d,function:"?",in_app:!0,lineno:u}),t}function ok(t){Hr&&J.log(`Global Handler attached: ${t}`)}function yM(){const t=Mt();return t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const G7=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],CM="TryCatch",V7=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t};return{name:CM,setupOnce(){e.setTimeout&&gn(ze,"setTimeout",ak),e.setInterval&&gn(ze,"setInterval",ak),e.requestAnimationFrame&&gn(ze,"requestAnimationFrame",H7),e.XMLHttpRequest&&"XMLHttpRequest"in ze&&gn(XMLHttpRequest.prototype,"send",Z7);const n=e.eventTarget;n&&(Array.isArray(n)?n:G7).forEach(j7)}}},W7=ba(CM,V7);function ak(t){return function(...e){const n=e[0];return e[0]=Ul(n,{mechanism:{data:{function:uo(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function H7(t){return function(e){return t.apply(this,[Ul(e,{mechanism:{data:{function:"requestAnimationFrame",handler:uo(t)},handled:!1,type:"instrument"}})])}}function Z7(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(i=>{i in n&&typeof n[i]=="function"&&gn(n,i,function(s){const o={mechanism:{data:{function:i,handler:uo(s)},handled:!1,type:"instrument"}},a=HI(s);return a&&(o.mechanism.data.handler=uo(a)),Ul(s,o)})}),t.apply(this,e)}}function j7(t){const e=ze,n=e[t]&&e[t].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(gn(n,"addEventListener",function(r){return function(i,s,o){try{typeof s.handleEvent=="function"&&(s.handleEvent=Ul(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:uo(s),target:t},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[i,Ul(s,{mechanism:{data:{function:"addEventListener",handler:uo(s),target:t},handled:!1,type:"instrument"}}),o])}}),gn(n,"removeEventListener",function(r){return function(i,s,o){const a=s;try{const c=a&&a.__sentry_wrapped__;c&&r.call(this,i,c,o)}catch{}return r.call(this,i,a,o)}}))}const nh=1024,IM="Breadcrumbs",z7=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:IM,setup(n){e.console&&VZ(J7(n)),e.dom&&FP(K7(n,e.dom)),e.xhr&&jI(Y7(n)),e.fetch&&ZI(q7(n)),e.history&&Lm(Q7(n)),e.sentry&&n.on&&n.on("beforeSendEvent",$7(n))}}},X7=ba(IM,z7);function $7(t){return function(n){Mt()===t&&fa({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:Oo(n)},{event:n})}}function K7(t,e){return function(r){if(Mt()!==t)return;let i,s,o=typeof e=="object"?e.serializeAttribute:void 0,a=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;a&&a>nh&&(Hr&&J.warn(`\`dom.maxStringLength\` cannot exceed ${nh}, but a value of ${a} was configured. Sentry will use ${nh} instead.`),a=nh),typeof o=="string"&&(o=[o]);try{const l=r.event,u=eX(l)?l.target:l;i=nc(u,{keyAttrs:o,maxStringLength:a}),s=RP(u)}catch{i="<unknown>"}if(i.length===0)return;const c={category:`ui.${r.name}`,message:i};s&&(c.data={"ui.component_name":s}),fa(c,{event:r.event,name:r.name,global:r.global})}}function J7(t){return function(n){if(Mt()!==t)return;const r={category:"console",data:{arguments:n.args,logger:"console"},level:mj(n.level),message:MA(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)r.message=`Assertion failed: ${MA(n.args.slice(1)," ")||"console.assert"}`,r.data.arguments=n.args.slice(1);else return;fa(r,{input:n.args,level:n.level})}}function Y7(t){return function(n){if(Mt()!==t)return;const{startTimestamp:r,endTimestamp:i}=n,s=n.xhr[jo];if(!r||!i||!s)return;const{method:o,url:a,status_code:c,body:l}=s,u={method:o,url:a,status_code:c},d={xhr:n.xhr,input:l,startTimestamp:r,endTimestamp:i};fa({category:"xhr",data:u,type:"http"},d)}}function q7(t){return function(n){if(Mt()!==t)return;const{startTimestamp:r,endTimestamp:i}=n;if(i&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.error){const s=n.fetchData,o={data:n.error,input:n.args,startTimestamp:r,endTimestamp:i};fa({category:"fetch",data:s,level:"error",type:"http"},o)}else{const s=n.response,o={...n.fetchData,status_code:s&&s.status},a={input:n.args,response:s,startTimestamp:r,endTimestamp:i};fa({category:"fetch",data:o,type:"http"},a)}}}function Q7(t){return function(n){if(Mt()!==t)return;let r=n.from,i=n.to;const s=lv(ze.location.href);let o=r?lv(r):void 0;const a=lv(i);(!o||!o.path)&&(o=s),s.protocol===a.protocol&&s.host===a.host&&(i=a.relative),s.protocol===o.protocol&&s.host===o.host&&(r=o.relative),fa({category:"navigation",data:{from:r,to:i}})}}function eX(t){return!!t&&!!t.target}const tX="cause",nX=5,SM="LinkedErrors",rX=(t={})=>{const e=t.limit||nX,n=t.key||tX;return{name:SM,preprocessEvent(r,i,s){const o=s.getOptions();kZ(pM,o.stackParser,o.maxValueLength,n,e,r,i)}}},iX=ba(SM,rX),bM="HttpContext",sX=()=>({name:bM,preprocessEvent(t){if(!ze.navigator&&!ze.location&&!ze.document)return;const e=t.request&&t.request.url||ze.location&&ze.location.href,{referrer:n}=ze.document||{},{userAgent:r}=ze.navigator||{},i={...t.request&&t.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},s={...t.request,...e&&{url:e},headers:i};t.request=s}}),oX=ba(bM,sX),wM="Dedupe",aX=()=>{let t;return{name:wM,processEvent(e){if(e.type)return e;try{if(lX(e,t))return Hr&&J.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}},cX=ba(wM,aX);function lX(t,e){return e?!!(uX(t,e)||dX(t,e)):!1}function uX(t,e){const n=t.message,r=e.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!kM(t,e)||!AM(t,e))}function dX(t,e){const n=ck(e),r=ck(t);return!(!n||!r||n.type!==r.type||n.value!==r.value||!kM(t,e)||!AM(t,e))}function AM(t,e){let n=lk(t),r=lk(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let i=0;i<r.length;i++){const s=r[i],o=n[i];if(s.filename!==o.filename||s.lineno!==o.lineno||s.colno!==o.colno||s.function!==o.function)return!1}return!0}function kM(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function ck(t){return t.exception&&t.exception.values&&t.exception.values[0]}function lk(t){const e=t.exception;if(e)try{return e.values[0].stacktrace.frames}catch{return}}const fX=[new Gz,new Lz,new W7,new X7,new D7,new iX,new cX,new oX];function hX(t={}){t.defaultIntegrations===void 0&&(t.defaultIntegrations=fX),t.release===void 0&&(typeof __SENTRY_RELEASE__=="string"&&(t.release=__SENTRY_RELEASE__),ze.SENTRY_RELEASE&&ze.SENTRY_RELEASE.id&&(t.release=ze.SENTRY_RELEASE.id)),t.autoSessionTracking===void 0&&(t.autoSessionTracking=!0),t.sendClientReports===void 0&&(t.sendClientReports=!0);const e={...t,stackParser:UZ(t.stackParser||M7),integrations:wz(t),transport:t.transport||(UP()?p7:g7)};xz(d7,e),t.autoSessionTracking&&pX()}function uk(t={},e=Vn()){if(!ze.document){Hr&&J.error("Global document not defined in showReportDialog call");return}const{client:n,scope:r}=e.getStackTop(),i=t.dsn||n&&n.getDsn();if(!i){Hr&&J.error("DSN not configured for showReportDialog call");return}r&&(t.user={...r.getUser(),...t.user}),t.eventId||(t.eventId=e.lastEventId());const s=ze.document.createElement("script");s.async=!0,s.crossOrigin="anonymous",s.src=Sz(i,t),t.onLoad&&(s.onload=t.onLoad);const{onClose:o}=t;if(o){const c=l=>{if(l.data==="__sentry_reportdialog_closed__")try{o()}finally{ze.removeEventListener("message",c)}};ze.addEventListener("message",c)}const a=ze.document.head||ze.document.body;a?a.appendChild(s):Hr&&J.error("Not injecting report dialog. No injection point found in HTML")}function dk(t){t.startSession({ignoreDuration:!0}),t.captureSession()}function pX(){if(typeof ze.document>"u"){Hr&&J.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}const t=Vn();t.captureSession&&(dk(t),Lm(({from:e,to:n})=>{e!==void 0&&e!==n&&dk(Vn())}))}const _t=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,at=Je;function mX(){at&&at.document?at.document.addEventListener("visibilitychange",()=>{const t=yf();if(at.document.hidden&&t){const e="cancelled";_t&&J.log(`[Tracing] Transaction: ${e} -> since tab moved to the background, op: ${t.op}`),t.status||t.setStatus(e),t.setTag("visibilitychange","document.hidden"),t.end()}}):_t&&J.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const rS=(t,e,n)=>{let r,i;return s=>{e.value>=0&&(s||n)&&(i=e.value-(r||0),(i||r===void 0)&&(r=e.value,e.delta=i,t(e)))}},gX=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,vX=()=>{const t=at.performance.timing,e=at.performance.navigation.type,n={entryType:"navigation",startTime:0,type:e==2?"back_forward":e===1?"reload":"navigate"};for(const r in t)r!=="navigationStart"&&r!=="toJSON"&&(n[r]=Math.max(t[r]-t.navigationStart,0));return n},EM=()=>at.__WEB_VITALS_POLYFILL__?at.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||vX()):at.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],TM=()=>{const t=EM();return t&&t.activationStart||0},iS=(t,e)=>{const n=EM();let r="navigate";return n&&(at.document.prerendering||TM()>0?r="prerender":r=n.type.replace(/_/g,"-")),{name:t,value:typeof e>"u"?-1:e,rating:"good",delta:0,entries:[],id:gX(),navigationType:r}},Vm=(t,e,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(i=>{e(i.getEntries())});return r.observe(Object.assign({type:t,buffered:!0},n||{})),r}}catch{}},Wm=(t,e)=>{const n=r=>{(r.type==="pagehide"||at.document.visibilityState==="hidden")&&(t(r),e&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},yX=t=>{const e=iS("CLS",0);let n,r=0,i=[];const s=a=>{a.forEach(c=>{if(!c.hadRecentInput){const l=i[0],u=i[i.length-1];r&&i.length!==0&&c.startTime-u.startTime<1e3&&c.startTime-l.startTime<5e3?(r+=c.value,i.push(c)):(r=c.value,i=[c]),r>e.value&&(e.value=r,e.entries=i,n&&n())}})},o=Vm("layout-shift",s);if(o){n=rS(t,e);const a=()=>{s(o.takeRecords()),n(!0)};return Wm(a),a}};let Fh=-1;const CX=()=>at.document.visibilityState==="hidden"&&!at.document.prerendering?0:1/0,IX=()=>{Wm(({timeStamp:t})=>{Fh=t},!0)},sS=()=>(Fh<0&&(Fh=CX(),IX()),{get firstHiddenTime(){return Fh}}),SX=t=>{const e=sS(),n=iS("FID");let r;const i=a=>{a.startTime<e.firstHiddenTime&&(n.value=a.processingStart-a.startTime,n.entries.push(a),r(!0))},s=a=>{a.forEach(i)},o=Vm("first-input",s);r=rS(t,n),o&&Wm(()=>{s(o.takeRecords()),o.disconnect()},!0)},fk={},bX=t=>{const e=sS(),n=iS("LCP");let r;const i=o=>{const a=o[o.length-1];if(a){const c=Math.max(a.startTime-TM(),0);c<e.firstHiddenTime&&(n.value=c,n.entries=[a],r())}},s=Vm("largest-contentful-paint",i);if(s){r=rS(t,n);const o=()=>{fk[n.id]||(i(s.takeRecords()),s.disconnect(),fk[n.id]=!0,r(!0))};return["keydown","click"].forEach(a=>{addEventListener(a,o,{once:!0,capture:!0})}),Wm(o,!0),o}},nd={},Fp={};let _M,RM,NM;function wX(t){return oS("cls",t,kX,_M)}function PM(t){return oS("lcp",t,TX,NM)}function AX(t){return oS("fid",t,EX,RM)}function Hm(t,e){return MM(t,e),Fp[t]||(_X(t),Fp[t]=!0),xM(t,e)}function Zm(t,e){const n=nd[t];if(!(!n||!n.length))for(const r of n)try{r(e)}catch(i){_t&&J.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${uo(r)}
Error:`,i)}}function kX(){yX(t=>{Zm("cls",{metric:t}),_M=t})}function EX(){SX(t=>{Zm("fid",{metric:t}),RM=t})}function TX(){bX(t=>{Zm("lcp",{metric:t}),NM=t})}function oS(t,e,n,r){return MM(t,e),Fp[t]||(n(),Fp[t]=!0),r&&e({metric:r}),xM(t,e)}function _X(t){const e={};t==="event"&&(e.durationThreshold=0),Vm(t,n=>{Zm(t,{entries:n})},e)}function MM(t,e){nd[t]=nd[t]||[],nd[t].push(e)}function xM(t,e){return()=>{const n=nd[t];if(!n)return;const r=n.indexOf(e);r!==-1&&n.splice(r,1)}}function hv(t){return typeof t=="number"&&isFinite(t)}function Gl(t,{startTimestamp:e,...n}){return e&&t.startTimestamp>e&&(t.startTimestamp=e),t.startChild({startTimestamp:e,...n})}const RX=2147483647;function tn(t){return t/1e3}function DM(){return at&&at.addEventListener&&at.performance}let hk=0,Dt={},Di,rd;function NX(){const t=DM();if(t&&Ti){t.mark&&at.performance.mark("sentry-tracing-init");const e=OX(),n=xX(),r=DX();return()=>{e(),n(),r()}}return()=>{}}function PX(){Hm("longtask",({entries:t})=>{for(const e of t){const n=yf();if(!n)return;const r=tn(Ti+e.startTime),i=tn(e.duration);n.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i})}})}function MX(){Hm("event",({entries:t})=>{for(const e of t){const n=yf();if(!n)return;if(e.name==="click"){const r=tn(Ti+e.startTime),i=tn(e.duration),s={description:nc(e.target),op:`ui.interaction.${e.name}`,origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i},o=RP(e.target);o&&(s.data={"ui.component_name":o}),n.startChild(s)}}})}function xX(){return wX(({metric:t})=>{const e=t.entries.pop();e&&(_t&&J.log("[Measurements] Adding CLS"),Dt.cls={value:t.value,unit:""},rd=e)})}function DX(){return PM(({metric:t})=>{const e=t.entries.pop();e&&(_t&&J.log("[Measurements] Adding LCP"),Dt.lcp={value:t.value,unit:"millisecond"},Di=e)})}function OX(){return AX(({metric:t})=>{const e=t.entries.pop();if(!e)return;const n=tn(Ti),r=tn(e.startTime);_t&&J.log("[Measurements] Adding FID"),Dt.fid={value:t.value,unit:"millisecond"},Dt["mark.fid"]={value:n+r,unit:"second"}})}function LX(t){const e=DM();if(!e||!at.performance.getEntries||!Ti)return;_t&&J.log("[Tracing] Adding & adjusting spans using Performance API");const n=tn(Ti),r=e.getEntries();let i,s;if(r.slice(hk).forEach(o=>{const a=tn(o.startTime),c=tn(o.duration);if(!(t.op==="navigation"&&n+a<t.startTimestamp))switch(o.entryType){case"navigation":{FX(t,o,n),i=n+tn(o.responseStart),s=n+tn(o.requestStart);break}case"mark":case"paint":case"measure":{BX(t,o,a,c,n);const l=sS(),u=o.startTime<l.firstHiddenTime;o.name==="first-paint"&&u&&(_t&&J.log("[Measurements] Adding FP"),Dt.fp={value:o.startTime,unit:"millisecond"}),o.name==="first-contentful-paint"&&u&&(_t&&J.log("[Measurements] Adding FCP"),Dt.fcp={value:o.startTime,unit:"millisecond"});break}case"resource":{const l=o.name.replace(at.location.origin,"");GX(t,o,l,a,c,n);break}}}),hk=Math.max(r.length-1,0),VX(t),t.op==="pageload"){typeof i=="number"&&(_t&&J.log("[Measurements] Adding TTFB"),Dt.ttfb={value:(i-t.startTimestamp)*1e3,unit:"millisecond"},typeof s=="number"&&s<=i&&(Dt["ttfb.requestTime"]={value:(i-s)*1e3,unit:"millisecond"})),["fcp","fp","lcp"].forEach(a=>{if(!Dt[a]||n>=t.startTimestamp)return;const c=Dt[a].value,l=n+tn(c),u=Math.abs((l-t.startTimestamp)*1e3),d=u-c;_t&&J.log(`[Measurements] Normalized ${a} from ${c} to ${u} (${d})`),Dt[a].value=u});const o=Dt["mark.fid"];o&&Dt.fid&&(Gl(t,{description:"first input delay",endTimestamp:o.value+tn(Dt.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:o.value}),delete Dt["mark.fid"]),"fcp"in Dt||delete Dt.cls,Object.keys(Dt).forEach(a=>{t.setMeasurement(a,Dt[a].value,Dt[a].unit)}),WX(t)}Di=void 0,rd=void 0,Dt={}}function BX(t,e,n,r,i){const s=i+n,o=s+r;return Gl(t,{description:e.name,endTimestamp:o,op:e.entryType,origin:"auto.resource.browser.metrics",startTimestamp:s}),s}function FX(t,e,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(r=>{rh(t,e,r,n)}),rh(t,e,"secureConnection",n,"TLS/SSL","connectEnd"),rh(t,e,"fetch",n,"cache","domainLookupStart"),rh(t,e,"domainLookup",n,"DNS"),UX(t,e,n)}function rh(t,e,n,r,i,s){const o=s?e[s]:e[`${n}End`],a=e[`${n}Start`];!a||!o||Gl(t,{op:"browser",origin:"auto.browser.browser.metrics",description:i||n,startTimestamp:r+tn(a),endTimestamp:r+tn(o)})}function UX(t,e,n){Gl(t,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:n+tn(e.requestStart),endTimestamp:n+tn(e.responseEnd)}),Gl(t,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:n+tn(e.responseStart),endTimestamp:n+tn(e.responseEnd)})}function GX(t,e,n,r,i,s){if(e.initiatorType==="xmlhttprequest"||e.initiatorType==="fetch")return;const o={};pv(o,e,"transferSize","http.response_transfer_size"),pv(o,e,"encodedBodySize","http.response_content_length"),pv(o,e,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in e&&(o["resource.render_blocking_status"]=e.renderBlockingStatus);const a=s+r,c=a+i;Gl(t,{description:n,endTimestamp:c,op:e.initiatorType?`resource.${e.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:a,data:o})}function VX(t){const e=at.navigator;if(!e)return;const n=e.connection;n&&(n.effectiveType&&t.setTag("effectiveConnectionType",n.effectiveType),n.type&&t.setTag("connectionType",n.type),hv(n.rtt)&&(Dt["connection.rtt"]={value:n.rtt,unit:"millisecond"})),hv(e.deviceMemory)&&t.setTag("deviceMemory",`${e.deviceMemory} GB`),hv(e.hardwareConcurrency)&&t.setTag("hardwareConcurrency",String(e.hardwareConcurrency))}function WX(t){Di&&(_t&&J.log("[Measurements] Adding LCP Data"),Di.element&&t.setTag("lcp.element",nc(Di.element)),Di.id&&t.setTag("lcp.id",Di.id),Di.url&&t.setTag("lcp.url",Di.url.trim().slice(0,200)),t.setTag("lcp.size",Di.size)),rd&&rd.sources&&(_t&&J.log("[Measurements] Adding CLS Data"),rd.sources.forEach((e,n)=>t.setTag(`cls.source.${n+1}`,nc(e.node))))}function pv(t,e,n,r){const i=e[n];i!=null&&i<RX&&(t[r]=i)}function HX(t,e,n,r,i="auto.http.browser"){if(!QI()||!t.fetchData)return;const s=e(t.fetchData.url);if(t.endTimestamp&&s){const f=t.fetchData.__span;if(!f)return;const h=r[f];if(h){if(t.response){h.setHttpStatus(t.response.status);const p=t.response&&t.response.headers&&t.response.headers.get("content-length");if(p){const g=parseInt(p);g>0&&h.setData("http.response_content_length",g)}}else t.error&&h.setStatus("internal_error");h.end(),delete r[f]}return}const o=Cf(),a=Mt(),c=o.getSpan(),{method:l,url:u}=t.fetchData,d=s&&c?c.startChild({data:{url:u,type:"fetch","http.method":l},description:`${l} ${u}`,op:"http.client",origin:i}):void 0;if(d&&(t.fetchData.__span=d.spanId,r[d.spanId]=d),n(t.fetchData.url)&&a){const f=t.args[0];t.args[1]=t.args[1]||{};const h=t.args[1];h.headers=ZX(f,a,o,h,d)}return d}function ZX(t,e,n,r,i){const s=i||n.getSpan(),o=s&&s.transaction,{traceId:a,sampled:c,dsc:l}=n.getPropagationContext(),u=s?s.toTraceparent():XI(a,void 0,c),d=o?o.getDynamicSamplingContext():l||Fm(a,e,n),f=O0(d),h=typeof Request<"u"&&lo(t,Request)?t.headers:r.headers;if(h)if(typeof Headers<"u"&&lo(h,Headers)){const p=new Headers(h);return p.append("sentry-trace",u),f&&p.append(D0,f),p}else if(Array.isArray(h)){const p=[...h,["sentry-trace",u]];return f&&p.push([D0,f]),p}else{const p="baggage"in h?h.baggage:void 0,g=[];return Array.isArray(p)?g.push(...p):p&&g.push(p),f&&g.push(f),{...h,"sentry-trace":u,baggage:g.length>0?g.join(","):void 0}}else return{"sentry-trace":u,baggage:f}}const V0=["localhost",/^\/(?!\/)/],W0={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:V0,tracePropagationTargets:V0};function jX(t){const{traceFetch:e,traceXHR:n,tracePropagationTargets:r,tracingOrigins:i,shouldCreateSpanForRequest:s,enableHTTPTimings:o}={traceFetch:W0.traceFetch,traceXHR:W0.traceXHR,...t},a=typeof s=="function"?s:u=>!0,c=u=>KX(u,r||i),l={};e&&ZI(u=>{const d=HX(u,a,c,l);o&&d&&pk(d)}),n&&jI(u=>{const d=JX(u,a,c,l);o&&d&&pk(d)})}function zX(t){return t.entryType==="resource"&&"initiatorType"in t&&typeof t.nextHopProtocol=="string"&&(t.initiatorType==="fetch"||t.initiatorType==="xmlhttprequest")}function pk(t){const e=t.data.url;if(!e)return;const n=Hm("resource",({entries:r})=>{r.forEach(i=>{zX(i)&&i.name.endsWith(e)&&($X(i).forEach(o=>t.setData(...o)),setTimeout(n))})})}function XX(t){let e="unknown",n="unknown",r="";for(const i of t){if(i==="/"){[e,n]=t.split("/");break}if(!isNaN(Number(i))){e=r==="h"?"http":r,n=t.split(r)[1];break}r+=i}return r===t&&(e=r),{name:e,version:n}}function Mi(t=0){return((Ti||performance.timeOrigin)+t)/1e3}function $X(t){const{name:e,version:n}=XX(t.nextHopProtocol),r=[];return r.push(["network.protocol.version",n],["network.protocol.name",e]),Ti?[...r,["http.request.redirect_start",Mi(t.redirectStart)],["http.request.fetch_start",Mi(t.fetchStart)],["http.request.domain_lookup_start",Mi(t.domainLookupStart)],["http.request.domain_lookup_end",Mi(t.domainLookupEnd)],["http.request.connect_start",Mi(t.connectStart)],["http.request.secure_connection_start",Mi(t.secureConnectionStart)],["http.request.connection_end",Mi(t.connectEnd)],["http.request.request_start",Mi(t.requestStart)],["http.request.response_start",Mi(t.responseStart)],["http.request.response_end",Mi(t.responseEnd)]]:r}function KX(t,e){return ou(t,e||V0)}function JX(t,e,n,r){const i=t.xhr,s=i&&i[jo];if(!QI()||!i||i.__sentry_own_request__||!s)return;const o=e(s.url);if(t.endTimestamp&&o){const u=i.__sentry_xhr_span_id__;if(!u)return;const d=r[u];d&&s.status_code!==void 0&&(d.setHttpStatus(s.status_code),d.end(),delete r[u]);return}const a=Cf(),c=a.getSpan(),l=o&&c?c.startChild({data:{type:"xhr","http.method":s.method,url:s.url},description:`${s.method} ${s.url}`,op:"http.client",origin:"auto.http.browser"}):void 0;if(l&&(i.__sentry_xhr_span_id__=l.spanId,r[i.__sentry_xhr_span_id__]=l),i.setRequestHeader&&n(s.url))if(l){const u=l&&l.transaction,d=u&&u.getDynamicSamplingContext(),f=O0(d);mk(i,l.toTraceparent(),f)}else{const u=Mt(),{traceId:d,sampled:f,dsc:h}=a.getPropagationContext(),p=XI(d,void 0,f),g=h||(u?Fm(d,u,a):void 0),y=O0(g);mk(i,p,y)}return l}function mk(t,e,n){try{t.setRequestHeader("sentry-trace",e),n&&t.setRequestHeader(D0,n)}catch{}}function YX(t,e=!0,n=!0){if(!at||!at.location){_t&&J.warn("Could not initialize routing instrumentation due to invalid location");return}let r=at.location.href,i;e&&(i=t({name:at.location.pathname,startTimestamp:Ti?Ti/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),n&&Lm(({to:s,from:o})=>{if(o===void 0&&r&&r.indexOf(s)!==-1){r=void 0;return}o!==s&&(r=void 0,i&&(_t&&J.log(`[Tracing] Finishing current transaction with op: ${i.op}`),i.end()),i=t({name:at.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))})}const qX="BrowserTracing",QX={...Bh,markBackgroundTransactions:!0,routingInstrumentation:YX,startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...W0};class e${constructor(e){this.name=qX,this._hasSetTracePropagationTargets=!1,hz(),_t&&(this._hasSetTracePropagationTargets=!!(e&&(e.tracePropagationTargets||e.tracingOrigins))),this.options={...QX,...e},this.options._experiments.enableLongTask!==void 0&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=NX(),this.options.enableLongTask&&PX(),this.options._experiments.enableInteractions&&MX()}setupOnce(e,n){this._getCurrentHub=n;const i=n().getClient(),s=i&&i.getOptions(),{routingInstrumentation:o,startTransactionOnLocationChange:a,startTransactionOnPageLoad:c,markBackgroundTransactions:l,traceFetch:u,traceXHR:d,shouldCreateSpanForRequest:f,enableHTTPTimings:h,_experiments:p}=this.options,g=s&&s.tracePropagationTargets,y=g||this.options.tracePropagationTargets;_t&&this._hasSetTracePropagationTargets&&g&&J.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),o(m=>{const v=this._createRouteTransaction(m);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(v,m,n),v},c,a),l&&mX(),p.enableInteractions&&this._registerInteractionListener(),jX({traceFetch:u,traceXHR:d,tracePropagationTargets:y,shouldCreateSpanForRequest:f,enableHTTPTimings:h})}_createRouteTransaction(e){if(!this._getCurrentHub){_t&&J.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`);return}const n=this._getCurrentHub(),{beforeNavigate:r,idleTimeout:i,finalTimeout:s,heartbeatInterval:o}=this.options,a=e.op==="pageload",c=a?gk("sentry-trace"):"",l=a?gk("baggage"):"",{traceparentData:u,dynamicSamplingContext:d,propagationContext:f}=Aj(c,l),h={...e,...u,metadata:{...e.metadata,dynamicSamplingContext:u&&!d?{}:d},trimEnd:!0},p=typeof r=="function"?r(h):h,g=p===void 0?{...h,sampled:!1}:p;g.metadata=g.name!==h.name?{...g.metadata,source:"custom"}:g.metadata,this._latestRouteName=g.name,this._latestRouteSource=g.metadata&&g.metadata.source,g.sampled===!1&&_t&&J.log(`[Tracing] Will not send ${g.op} transaction because of beforeNavigate.`),_t&&J.log(`[Tracing] Starting ${g.op} transaction on scope`);const{location:y}=at,m=ek(n,g,i,s,!0,{location:y},o),v=n.getScope();return a&&u?v.setPropagationContext(f):v.setPropagationContext({traceId:m.traceId,spanId:m.spanId,parentSpanId:m.parentSpanId,sampled:m.sampled}),m.registerBeforeFinishCallback(S=>{this._collectWebVitals(),LX(S)}),m}_registerInteractionListener(){let e;const n=()=>{const{idleTimeout:r,finalTimeout:i,heartbeatInterval:s}=this.options,o="ui.action.click",a=yf();if(a&&a.op&&["navigation","pageload"].includes(a.op)){_t&&J.warn(`[Tracing] Did not create ${o} transaction because a pageload or navigation transaction is in progress.`);return}if(e&&(e.setFinishReason("interactionInterrupted"),e.end(),e=void 0),!this._getCurrentHub){_t&&J.warn(`[Tracing] Did not create ${o} transaction because _getCurrentHub is invalid.`);return}if(!this._latestRouteName){_t&&J.warn(`[Tracing] Did not create ${o} transaction because _latestRouteName is missing.`);return}const c=this._getCurrentHub(),{location:l}=at,u={name:this._latestRouteName,op:o,trimEnd:!0,metadata:{source:this._latestRouteSource||"url"}};e=ek(c,u,r,i,!0,{location:l},s)};["click"].forEach(r=>{addEventListener(r,n,{once:!1,capture:!0})})}}function gk(t){const e=NZ(`meta[name=${t}]`);return e?e.getAttribute("content"):void 0}const ht=Je,aS="sentryReplaySession",t$="replay_event",cS="Unable to send Replay",n$=3e5,r$=9e5,i$=5e3,s$=5500,o$=6e4,a$=5e3,c$=3,vk=15e4,ih=5e3,l$=3e3,u$=300,lS=2e7,d$=4999,f$=15e3,yk=36e5,Ck={low:{sampling:{canvas:1},dataURLOptions:{type:"image/webp",quality:.25}},medium:{sampling:{canvas:2},dataURLOptions:{type:"image/webp",quality:.4}},high:{sampling:{canvas:4},dataURLOptions:{type:"image/webp",quality:.5}}};var nn;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(nn||(nn={}));function h$(t){return t.nodeType===t.ELEMENT_NODE}function id(t){const e=t==null?void 0:t.host;return(e==null?void 0:e.shadowRoot)===t}function sd(t){return Object.prototype.toString.call(t)==="[object ShadowRoot]"}function p$(t){return t.includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t}function m$(t){const{cssText:e}=t;if(e.split('"').length<3)return e;const n=["@import",`url(${JSON.stringify(t.href)})`];return t.layerName===""?n.push("layer"):t.layerName&&n.push(`layer(${t.layerName})`),t.supportsText&&n.push(`supports(${t.supportsText})`),t.media.length&&n.push(t.media.mediaText),n.join(" ")+";"}function Up(t){try{const e=t.rules||t.cssRules;return e?p$(Array.from(e,OM).join("")):null}catch{return null}}function OM(t){let e;if(v$(t))try{e=Up(t.styleSheet)||m$(t)}catch{}else if(y$(t)&&t.selectorText.includes(":"))return g$(t.cssText);return e||t.cssText}function g$(t){const e=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return t.replace(e,"$1\\$2")}function v$(t){return"styleSheet"in t}function y$(t){return"selectorText"in t}class LM{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var n;if(!e)return-1;const r=(n=this.getMeta(e))===null||n===void 0?void 0:n.id;return r??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){const r=n.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,n)}replace(e,n){const r=this.getNode(e);if(r){const i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(n,i)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function C$(){return new LM}function jm({maskInputOptions:t,tagName:e,type:n}){return e==="OPTION"&&(e="SELECT"),!!(t[e.toLowerCase()]||n&&t[n]||n==="password"||e==="INPUT"&&!n&&t.text)}function Vd({isMasked:t,element:e,value:n,maskInputFn:r}){let i=n||"";return t?(r&&(i=r(i,e)),"*".repeat(i.length)):i}function Vl(t){return t.toLowerCase()}function H0(t){return t.toUpperCase()}const Ik="__rrweb_original__";function I$(t){const e=t.getContext("2d");if(!e)return!0;const n=50;for(let r=0;r<t.width;r+=n)for(let i=0;i<t.height;i+=n){const s=e.getImageData,o=Ik in s?s[Ik]:s;if(new Uint32Array(o.call(e,r,i,Math.min(n,t.width-r),Math.min(n,t.height-i)).data.buffer).some(c=>c!==0))return!1}return!0}function uS(t){const e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?Vl(e):null}function Gp(t,e,n){return e==="INPUT"&&(n==="radio"||n==="checkbox")?t.getAttribute("value")||"":t.value}let S$=1;const b$=new RegExp("[^a-z0-9-_:]"),Wd=-2;function dS(){return S$++}function w$(t){if(t instanceof HTMLFormElement)return"form";const e=Vl(t.tagName);return b$.test(e)?"div":e}function A$(t){let e="";return t.indexOf("//")>-1?e=t.split("/").slice(0,3).join("/"):e=t.split("/")[0],e=e.split("?")[0],e}let Ac,Sk;const k$=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,E$=/^(?:[a-z+]+:)?\/\//i,T$=/^www\..*/i,_$=/^(data:)([^,]*),(.*)/i;function Vp(t,e){return(t||"").replace(k$,(n,r,i,s,o,a)=>{const c=i||o||a,l=r||s||"";if(!c)return n;if(E$.test(c)||T$.test(c))return`url(${l}${c}${l})`;if(_$.test(c))return`url(${l}${c}${l})`;if(c[0]==="/")return`url(${l}${A$(e)+c}${l})`;const u=e.split("/"),d=c.split("/");u.pop();for(const f of d)f!=="."&&(f===".."?u.pop():u.push(f));return`url(${l}${u.join("/")}${l})`})}const R$=/^[^ \t\n\r\u000c]+/,N$=/^[, \t\n\r\u000c]+/;function P$(t,e){if(e.trim()==="")return e;let n=0;function r(s){let o;const a=s.exec(e.substring(n));return a?(o=a[0],n+=o.length,o):""}const i=[];for(;r(N$),!(n>=e.length);){let s=r(R$);if(s.slice(-1)===",")s=jc(t,s.substring(0,s.length-1)),i.push(s);else{let o="";s=jc(t,s);let a=!1;for(;;){const c=e.charAt(n);if(c===""){i.push((s+o).trim());break}else if(a)c===")"&&(a=!1);else if(c===","){n+=1,i.push((s+o).trim());break}else c==="("&&(a=!0);o+=c,n+=1}}}return i.join(", ")}function jc(t,e){if(!e||e.trim()==="")return e;const n=t.createElement("a");return n.href=e,n.href}function M$(t){return!!(t.tagName==="svg"||t.ownerSVGElement)}function fS(){const t=document.createElement("a");return t.href="",t.href}function BM(t,e,n,r,i,s){return r&&(n==="src"||n==="href"&&!(e==="use"&&r[0]==="#")||n==="xlink:href"&&r[0]!=="#"||n==="background"&&(e==="table"||e==="td"||e==="th")?jc(t,r):n==="srcset"?P$(t,r):n==="style"?Vp(r,fS()):e==="object"&&n==="data"?jc(t,r):typeof s=="function"?s(n,r,i):r)}function FM(t,e,n){return(t==="video"||t==="audio")&&e==="autoplay"}function x$(t,e,n,r){try{if(r&&t.matches(r))return!1;if(typeof e=="string"){if(t.classList.contains(e))return!0}else for(let i=t.classList.length;i--;){const s=t.classList[i];if(e.test(s))return!0}if(n)return t.matches(n)}catch{}return!1}function D$(t,e){for(let n=t.classList.length;n--;){const r=t.classList[n];if(e.test(r))return!0}return!1}function xa(t,e,n=1/0,r=0){return!t||t.nodeType!==t.ELEMENT_NODE||r>n?-1:e(t)?r:xa(t.parentNode,e,n,r+1)}function zc(t,e){return n=>{const r=n;if(r===null)return!1;if(t){if(typeof t=="string"){if(r.matches(`.${t}`))return!0}else if(D$(r,t))return!0}return!!(e&&r.matches(e))}}function Wl(t,e,n,r,i,s){try{const o=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(o===null)return!1;let a=-1,c=-1;if(s){if(c=xa(o,zc(r,i)),c<0)return!0;a=xa(o,zc(e,n),c>=0?c:1/0)}else{if(a=xa(o,zc(e,n)),a<0)return!1;c=xa(o,zc(r,i),a>=0?a:1/0)}return a>=0?c>=0?a<=c:!0:c>=0?!1:!!s}catch{}return!!s}function O$(t,e,n){const r=t.contentWindow;if(!r)return;let i=!1,s;try{s=r.document.readyState}catch{return}if(s!=="complete"){const a=setTimeout(()=>{i||(e(),i=!0)},n);t.addEventListener("load",()=>{clearTimeout(a),i=!0,e()});return}const o="about:blank";if(r.location.href!==o||t.src===o||t.src==="")return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}function L$(t,e,n){let r=!1,i;try{i=t.sheet}catch{return}if(i)return;const s=setTimeout(()=>{r||(e(),r=!0)},n);t.addEventListener("load",()=>{clearTimeout(s),r=!0,e()})}function B$(t,e){const{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskAttributeFn:c,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f,inlineStylesheet:h,maskInputOptions:p={},maskTextFn:g,maskInputFn:y,dataURLOptions:m={},inlineImages:v,recordCanvas:S,keepIframeSrcFn:E,newlyAddedElement:A=!1}=e,b=F$(n,r);switch(t.nodeType){case t.DOCUMENT_NODE:return t.compatMode!=="CSS1Compat"?{type:nn.Document,childNodes:[],compatMode:t.compatMode}:{type:nn.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:nn.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:b};case t.ELEMENT_NODE:return G$(t,{doc:n,blockClass:i,blockSelector:s,unblockSelector:o,inlineStylesheet:h,maskAttributeFn:c,maskInputOptions:p,maskInputFn:y,dataURLOptions:m,inlineImages:v,recordCanvas:S,keepIframeSrcFn:E,newlyAddedElement:A,rootId:b,maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f});case t.TEXT_NODE:return U$(t,{maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f,maskTextFn:g,maskInputOptions:p,maskInputFn:y,rootId:b});case t.CDATA_SECTION_NODE:return{type:nn.CDATA,textContent:"",rootId:b};case t.COMMENT_NODE:return{type:nn.Comment,textContent:t.textContent||"",rootId:b};default:return!1}}function F$(t,e){if(!e.hasNode(t))return;const n=e.getId(t);return n===1?void 0:n}function U$(t,e){var n;const{maskAllText:r,maskTextClass:i,unmaskTextClass:s,maskTextSelector:o,unmaskTextSelector:a,maskTextFn:c,maskInputOptions:l,maskInputFn:u,rootId:d}=e,f=t.parentNode&&t.parentNode.tagName;let h=t.textContent;const p=f==="STYLE"?!0:void 0,g=f==="SCRIPT"?!0:void 0,y=f==="TEXTAREA"?!0:void 0;if(p&&h){try{t.nextSibling||t.previousSibling||!((n=t.parentNode.sheet)===null||n===void 0)&&n.cssRules&&(h=Up(t.parentNode.sheet))}catch(v){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${v}`,t)}h=Vp(h,fS())}g&&(h="SCRIPT_PLACEHOLDER");const m=Wl(t,i,o,s,a,r);if(!p&&!g&&!y&&h&&m&&(h=c?c(h):h.replace(/[\S]/g,"*")),y&&h&&(l.textarea||m)&&(h=u?u(h,t.parentNode):h.replace(/[\S]/g,"*")),f==="OPTION"&&h){const v=jm({type:null,tagName:f,maskInputOptions:l});h=Vd({isMasked:Wl(t,i,o,s,a,v),element:t,value:h,maskInputFn:u})}return{type:nn.Text,textContent:h||"",isStyle:p,rootId:d}}function G$(t,e){const{doc:n,blockClass:r,blockSelector:i,unblockSelector:s,inlineStylesheet:o,maskInputOptions:a={},maskAttributeFn:c,maskInputFn:l,dataURLOptions:u={},inlineImages:d,recordCanvas:f,keepIframeSrcFn:h,newlyAddedElement:p=!1,rootId:g,maskAllText:y,maskTextClass:m,unmaskTextClass:v,maskTextSelector:S,unmaskTextSelector:E}=e,A=x$(t,r,i,s),b=w$(t);let k={};const _=t.attributes.length;for(let M=0;M<_;M++){const D=t.attributes[M];FM(b,D.name,D.value)||(k[D.name]=BM(n,b,Vl(D.name),D.value,t,c))}if(b==="link"&&o){const M=Array.from(n.styleSheets).find(B=>B.href===t.href);let D=null;M&&(D=Up(M)),D&&(delete k.rel,delete k.href,k._cssText=Vp(D,M.href))}if(b==="style"&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){const M=Up(t.sheet);M&&(k._cssText=Vp(M,fS()))}if(b==="input"||b==="textarea"||b==="select"||b==="option"){const M=t,D=uS(M),B=Gp(M,H0(b),D),G=M.checked;if(D!=="submit"&&D!=="button"&&B){const V=Wl(M,m,S,v,E,jm({type:D,tagName:H0(b),maskInputOptions:a}));k.value=Vd({isMasked:V,element:M,value:B,maskInputFn:l})}G&&(k.checked=G)}if(b==="option"&&(t.selected&&!a.select?k.selected=!0:delete k.selected),b==="canvas"&&f){if(t.__context==="2d")I$(t)||(k.rr_dataURL=t.toDataURL(u.type,u.quality));else if(!("__context"in t)){const M=t.toDataURL(u.type,u.quality),D=document.createElement("canvas");D.width=t.width,D.height=t.height;const B=D.toDataURL(u.type,u.quality);M!==B&&(k.rr_dataURL=M)}}if(b==="img"&&d){Ac||(Ac=n.createElement("canvas"),Sk=Ac.getContext("2d"));const M=t,D=M.crossOrigin;M.crossOrigin="anonymous";const B=()=>{M.removeEventListener("load",B);try{Ac.width=M.naturalWidth,Ac.height=M.naturalHeight,Sk.drawImage(M,0,0),k.rr_dataURL=Ac.toDataURL(u.type,u.quality)}catch(G){console.warn(`Cannot inline img src=${M.currentSrc}! Error: ${G}`)}D?k.crossOrigin=D:M.removeAttribute("crossorigin")};M.complete&&M.naturalWidth!==0?B():M.addEventListener("load",B)}if((b==="audio"||b==="video")&&(k.rr_mediaState=t.paused?"paused":"played",k.rr_mediaCurrentTime=t.currentTime),p||(t.scrollLeft&&(k.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(k.rr_scrollTop=t.scrollTop)),A){const{width:M,height:D}=t.getBoundingClientRect();k={class:k.class,rr_width:`${M}px`,rr_height:`${D}px`}}b==="iframe"&&!h(k.src)&&(t.contentDocument||(k.rr_src=k.src),delete k.src);let N;try{customElements.get(b)&&(N=!0)}catch{}return{type:nn.Element,tagName:b,attributes:k,childNodes:[],isSVG:M$(t)||void 0,needBlock:A,rootId:g,isCustom:N}}function ft(t){return t==null?"":t.toLowerCase()}function V$(t,e){if(e.comment&&t.type===nn.Comment)return!0;if(t.type===nn.Element){if(e.script&&(t.tagName==="script"||t.tagName==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||t.tagName==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&t.attributes.href.endsWith(".js")))return!0;if(e.headFavicon&&(t.tagName==="link"&&t.attributes.rel==="shortcut icon"||t.tagName==="meta"&&(ft(t.attributes.name).match(/^msapplication-tile(image|color)$/)||ft(t.attributes.name)==="application-name"||ft(t.attributes.rel)==="icon"||ft(t.attributes.rel)==="apple-touch-icon"||ft(t.attributes.rel)==="shortcut icon")))return!0;if(t.tagName==="meta"){if(e.headMetaDescKeywords&&ft(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(ft(t.attributes.property).match(/^(og|twitter|fb):/)||ft(t.attributes.name).match(/^(og|twitter):/)||ft(t.attributes.name)==="pinterest"))return!0;if(e.headMetaRobots&&(ft(t.attributes.name)==="robots"||ft(t.attributes.name)==="googlebot"||ft(t.attributes.name)==="bingbot"))return!0;if(e.headMetaHttpEquiv&&t.attributes["http-equiv"]!==void 0)return!0;if(e.headMetaAuthorship&&(ft(t.attributes.name)==="author"||ft(t.attributes.name)==="generator"||ft(t.attributes.name)==="framework"||ft(t.attributes.name)==="publisher"||ft(t.attributes.name)==="progid"||ft(t.attributes.property).match(/^article:/)||ft(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&(ft(t.attributes.name)==="google-site-verification"||ft(t.attributes.name)==="yandex-verification"||ft(t.attributes.name)==="csrf-token"||ft(t.attributes.name)==="p:domain_verify"||ft(t.attributes.name)==="verify-v1"||ft(t.attributes.name)==="verification"||ft(t.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function Xc(t,e){const{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:f=!1,inlineStylesheet:h=!0,maskInputOptions:p={},maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOMOptions:v,dataURLOptions:S={},inlineImages:E=!1,recordCanvas:A=!1,onSerialize:b,onIframeLoad:k,iframeLoadTimeout:_=5e3,onStylesheetLoad:N,stylesheetLoadTimeout:M=5e3,keepIframeSrcFn:D=()=>!1,newlyAddedElement:B=!1}=e;let{preserveWhiteSpace:G=!0}=e;const V=B$(t,{doc:n,mirror:r,blockClass:i,blockSelector:s,maskAllText:a,unblockSelector:o,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,dataURLOptions:S,inlineImages:E,recordCanvas:A,keepIframeSrcFn:D,newlyAddedElement:B});if(!V)return console.warn(t,"not serialized"),null;let z;r.hasNode(t)?z=r.getId(t):V$(V,v)||!G&&V.type===nn.Text&&!V.isStyle&&!V.textContent.replace(/^\s+|\s+$/gm,"").length?z=Wd:z=dS();const X=Object.assign(V,{id:z});if(r.add(t,X),z===Wd)return null;b&&b(t);let te=!f;if(X.type===nn.Element){te=te&&!X.needBlock,delete X.needBlock;const H=t.shadowRoot;H&&sd(H)&&(X.isShadowHost=!0)}if((X.type===nn.Document||X.type===nn.Element)&&te){v.headWhitespace&&X.type===nn.Element&&X.tagName==="head"&&(G=!1);const H={doc:n,mirror:r,blockClass:i,blockSelector:s,maskAllText:a,unblockSelector:o,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:f,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOMOptions:v,dataURLOptions:S,inlineImages:E,recordCanvas:A,preserveWhiteSpace:G,onSerialize:b,onIframeLoad:k,iframeLoadTimeout:_,onStylesheetLoad:N,stylesheetLoadTimeout:M,keepIframeSrcFn:D};for(const K of Array.from(t.childNodes)){const ie=Xc(K,H);ie&&X.childNodes.push(ie)}if(h$(t)&&t.shadowRoot)for(const K of Array.from(t.shadowRoot.childNodes)){const ie=Xc(K,H);ie&&(sd(t.shadowRoot)&&(ie.isShadow=!0),X.childNodes.push(ie))}}return t.parentNode&&id(t.parentNode)&&sd(t.parentNode)&&(X.isShadow=!0),X.type===nn.Element&&X.tagName==="iframe"&&O$(t,()=>{const H=t.contentDocument;if(H&&k){const K=Xc(H,{doc:H,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOMOptions:v,dataURLOptions:S,inlineImages:E,recordCanvas:A,preserveWhiteSpace:G,onSerialize:b,onIframeLoad:k,iframeLoadTimeout:_,onStylesheetLoad:N,stylesheetLoadTimeout:M,keepIframeSrcFn:D});K&&k(t,K)}},_),X.type===nn.Element&&X.tagName==="link"&&X.attributes.rel==="stylesheet"&&L$(t,()=>{if(N){const H=Xc(t,{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOMOptions:v,dataURLOptions:S,inlineImages:E,recordCanvas:A,preserveWhiteSpace:G,onSerialize:b,onIframeLoad:k,iframeLoadTimeout:_,onStylesheetLoad:N,stylesheetLoadTimeout:M,keepIframeSrcFn:D});H&&N(t,H)}},M),X}function W$(t,e){const{mirror:n=new LM,blockClass:r="rr-block",blockSelector:i=null,unblockSelector:s=null,maskAllText:o=!1,maskTextClass:a="rr-mask",unmaskTextClass:c=null,maskTextSelector:l=null,unmaskTextSelector:u=null,inlineStylesheet:d=!0,inlineImages:f=!1,recordCanvas:h=!1,maskAllInputs:p=!1,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOM:v=!1,dataURLOptions:S,preserveWhiteSpace:E,onSerialize:A,onIframeLoad:b,iframeLoadTimeout:k,onStylesheetLoad:_,stylesheetLoadTimeout:N,keepIframeSrcFn:M=()=>!1}=e||{};return Xc(t,{doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,maskAllText:o,maskTextClass:a,unmaskTextClass:c,maskTextSelector:l,unmaskTextSelector:u,skipChild:!1,inlineStylesheet:d,maskInputOptions:p===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:p===!1?{}:p,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOMOptions:v===!0||v==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:v==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:v===!1?{}:v,dataURLOptions:S,inlineImages:f,recordCanvas:h,preserveWhiteSpace:E,onSerialize:A,onIframeLoad:b,iframeLoadTimeout:k,onStylesheetLoad:_,stylesheetLoadTimeout:N,keepIframeSrcFn:M,newlyAddedElement:!1})}function qn(t,e,n=document){const r={capture:!0,passive:!0};return n.addEventListener(t,e,r),()=>n.removeEventListener(t,e,r)}const Tc=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let bk={map:{},getId(){return console.error(Tc),-1},getNode(){return console.error(Tc),null},removeNodeFromMap(){console.error(Tc)},has(){return console.error(Tc),!1},reset(){console.error(Tc)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(bk=new Proxy(bk,{get(t,e,n){return e==="map"&&console.error(Tc),Reflect.get(t,e,n)}}));function Hd(t,e,n={}){let r=null,i=0;return function(...s){const o=Date.now();!i&&n.leading===!1&&(i=o);const a=e-(o-i),c=this;a<=0||a>e?(r&&(clearTimeout(r),r=null),i=o,t.apply(c,s)):!r&&n.trailing!==!1&&(r=setTimeout(()=>{i=n.leading===!1?0:Date.now(),r=null,t.apply(c,s)},a))}}function UM(t,e,n,r,i=window){const s=i.Object.getOwnPropertyDescriptor(t,e);return i.Object.defineProperty(t,e,r?n:{set(o){setTimeout(()=>{n.set.call(this,o)},0),s&&s.set&&s.set.call(this,o)}}),()=>UM(t,e,s||{},!0)}function hS(t,e,n){try{if(!(e in t))return()=>{};const r=t[e],i=n(r);return typeof i=="function"&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:r}})),t[e]=i,()=>{t[e]=r}}catch{return()=>{}}}let Wp=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(Wp=()=>new Date().getTime());function GM(t){var e,n,r,i,s,o;const a=t.document;return{left:a.scrollingElement?a.scrollingElement.scrollLeft:t.pageXOffset!==void 0?t.pageXOffset:(a==null?void 0:a.documentElement.scrollLeft)||((n=(e=a==null?void 0:a.body)===null||e===void 0?void 0:e.parentElement)===null||n===void 0?void 0:n.scrollLeft)||((r=a==null?void 0:a.body)===null||r===void 0?void 0:r.scrollLeft)||0,top:a.scrollingElement?a.scrollingElement.scrollTop:t.pageYOffset!==void 0?t.pageYOffset:(a==null?void 0:a.documentElement.scrollTop)||((s=(i=a==null?void 0:a.body)===null||i===void 0?void 0:i.parentElement)===null||s===void 0?void 0:s.scrollTop)||((o=a==null?void 0:a.body)===null||o===void 0?void 0:o.scrollTop)||0}}function VM(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function WM(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function fi(t,e,n,r,i){if(!t)return!1;const s=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(!s)return!1;const o=zc(e,n);if(!i){const l=r&&s.matches(r);return o(s)&&!l}const a=xa(s,o);let c=-1;return a<0?!1:(r&&(c=xa(s,zc(null,r))),a>-1&&c<0?!0:a<c)}function H$(t,e){return e.getId(t)!==-1}function mv(t,e){return e.getId(t)===Wd}function HM(t,e){if(id(t))return!1;const n=e.getId(t);return e.has(n)?t.parentNode&&t.parentNode.nodeType===t.DOCUMENT_NODE?!1:t.parentNode?HM(t.parentNode,e):!0:!0}function Z0(t){return!!t.changedTouches}function Z$(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let n=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function ZM(t,e){return!!(t.nodeName==="IFRAME"&&e.getMeta(t))}function jM(t,e){return!!(t.nodeName==="LINK"&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&t.getAttribute("rel")==="stylesheet"&&e.getMeta(t))}function j0(t){return!!(t!=null&&t.shadowRoot)}class j${constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var n;return(n=this.styleIDMap.get(e))!==null&&n!==void 0?n:-1}has(e){return this.styleIDMap.has(e)}add(e,n){if(this.has(e))return this.getId(e);let r;return n===void 0?r=this.id++:r=n,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function zM(t){var e,n;let r=null;return((n=(e=t.getRootNode)===null||e===void 0?void 0:e.call(t))===null||n===void 0?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host&&(r=t.getRootNode().host),r}function z$(t){let e=t,n;for(;n=zM(e);)e=n;return e}function X$(t){const e=t.ownerDocument;if(!e)return!1;const n=z$(t);return e.contains(n)}function XM(t){const e=t.ownerDocument;return e?e.contains(t)||X$(t):!1}var Be=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(Be||{}),Fe=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t))(Fe||{}),Hn=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(Hn||{}),ys=(t=>(t[t.Mouse=0]="Mouse",t[t.Pen=1]="Pen",t[t.Touch=2]="Touch",t))(ys||{});function wk(t){return"__ln"in t}class $${constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let n=this.head;for(let r=0;r<e;r++)n=(n==null?void 0:n.next)||null;return n}addNode(e){const n={value:e,previous:null,next:null};if(e.__ln=n,e.previousSibling&&wk(e.previousSibling)){const r=e.previousSibling.__ln.next;n.next=r,n.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=n,r&&(r.previous=n)}else if(e.nextSibling&&wk(e.nextSibling)&&e.nextSibling.__ln.previous){const r=e.nextSibling.__ln.previous;n.previous=r,n.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=n,r&&(r.next=n)}else this.head&&(this.head.previous=n),n.next=this.head,this.head=n;n.next===null&&(this.tail=n),this.length++}removeNode(e){const n=e.__ln;this.head&&(n.previous?(n.previous.next=n.next,n.next?n.next.previous=n.previous:this.tail=n.previous):(this.head=n.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const Ak=(t,e)=>`${t}@${e}`;class K${constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],n=new Set,r=new $$,i=c=>{let l=c,u=Wd;for(;u===Wd;)l=l&&l.nextSibling,u=l&&this.mirror.getId(l);return u},s=c=>{if(!c.parentNode||!XM(c))return;const l=id(c.parentNode)?this.mirror.getId(zM(c)):this.mirror.getId(c.parentNode),u=i(c);if(l===-1||u===-1)return r.addNode(c);const d=Xc(c,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:f=>{ZM(f,this.mirror)&&this.iframeManager.addIframe(f),jM(f,this.mirror)&&this.stylesheetManager.trackLinkElement(f),j0(c)&&this.shadowDomManager.addShadowRoot(c.shadowRoot,this.doc)},onIframeLoad:(f,h)=>{this.iframeManager.attachIframe(f,h),this.shadowDomManager.observeAttachShadow(f)},onStylesheetLoad:(f,h)=>{this.stylesheetManager.attachLinkElement(f,h)}});d&&(e.push({parentId:l,nextId:u,node:d}),n.add(d.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const c of this.movedSet)kk(this.removes,c,this.mirror)&&!this.movedSet.has(c.parentNode)||s(c);for(const c of this.addedSet)!Ek(this.droppedSet,c)&&!kk(this.removes,c,this.mirror)||Ek(this.movedSet,c)?s(c):this.droppedSet.add(c);let o=null;for(;r.length;){let c=null;if(o){const l=this.mirror.getId(o.value.parentNode),u=i(o.value);l!==-1&&u!==-1&&(c=o)}if(!c){let l=r.tail;for(;l;){const u=l;if(l=l.previous,u){const d=this.mirror.getId(u.value.parentNode);if(i(u.value)===-1)continue;if(d!==-1){c=u;break}else{const h=u.value;if(h.parentNode&&h.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const p=h.parentNode.host;if(this.mirror.getId(p)!==-1){c=u;break}}}}}}if(!c){for(;r.head;)r.removeNode(r.head.value);break}o=c.previous,r.removeNode(c.value),s(c.value)}const a={texts:this.texts.map(c=>({id:this.mirror.getId(c.node),value:c.value})).filter(c=>!n.has(c.id)).filter(c=>this.mirror.has(c.id)),attributes:this.attributes.map(c=>{const{attributes:l}=c;if(typeof l.style=="string"){const u=JSON.stringify(c.styleDiff),d=JSON.stringify(c._unchangedStyles);u.length<l.style.length&&(u+d).split("var(").length===l.style.split("var(").length&&(l.style=c.styleDiff)}return{id:this.mirror.getId(c.node),attributes:l}}).filter(c=>!n.has(c.id)).filter(c=>this.mirror.has(c.id)),removes:this.removes,adds:e};!a.texts.length&&!a.attributes.length&&!a.removes.length&&!a.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(a))},this.processMutation=e=>{if(mv(e.target,this.mirror))return;let n;try{n=document.implementation.createHTMLDocument()}catch{n=this.doc}switch(e.type){case"characterData":{const r=e.target.textContent;!fi(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)&&r!==e.oldValue&&this.texts.push({value:Wl(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&r?this.maskTextFn?this.maskTextFn(r):r.replace(/[\S]/g,"*"):r,node:e.target});break}case"attributes":{const r=e.target;let i=e.attributeName,s=e.target.getAttribute(i);if(i==="value"){const a=uS(r),c=r.tagName;s=Gp(r,c,a);const l=jm({maskInputOptions:this.maskInputOptions,tagName:c,type:a}),u=Wl(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,l);s=Vd({isMasked:u,element:r,value:s,maskInputFn:this.maskInputFn})}if(fi(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||s===e.oldValue)return;let o=this.attributes.find(a=>a.node===e.target);if(r.tagName==="IFRAME"&&i==="src"&&!this.keepIframeSrcFn(s))if(!r.contentDocument)i="rr_src";else return;if(o||(o={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(o)),i==="type"&&r.tagName==="INPUT"&&(e.oldValue||"").toLowerCase()==="password"&&r.setAttribute("data-rr-is-password","true"),!FM(r.tagName,i)&&(o.attributes[i]=BM(this.doc,Vl(r.tagName),Vl(i),s,r,this.maskAttributeFn),i==="style")){const a=n.createElement("span");e.oldValue&&a.setAttribute("style",e.oldValue);for(const c of Array.from(r.style)){const l=r.style.getPropertyValue(c),u=r.style.getPropertyPriority(c);l!==a.style.getPropertyValue(c)||u!==a.style.getPropertyPriority(c)?u===""?o.styleDiff[c]=l:o.styleDiff[c]=[l,u]:o._unchangedStyles[c]=[l,u]}for(const c of Array.from(a.style))r.style.getPropertyValue(c)===""&&(o.styleDiff[c]=!1)}break}case"childList":{if(fi(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;e.addedNodes.forEach(r=>this.genAdds(r,e.target)),e.removedNodes.forEach(r=>{const i=this.mirror.getId(r),s=id(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);fi(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||mv(r,this.mirror)||!H$(r,this.mirror)||(this.addedSet.has(r)?(z0(this.addedSet,r),this.droppedSet.add(r)):this.addedSet.has(e.target)&&i===-1||HM(e.target,this.mirror)||(this.movedSet.has(r)&&this.movedMap[Ak(i,s)]?z0(this.movedSet,r):this.removes.push({parentId:s,id:i,isShadow:id(e.target)&&sd(e.target)?!0:void 0})),this.mapRemoves.push(r))});break}}},this.genAdds=(e,n)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!(this.addedSet.has(e)||this.movedSet.has(e))){if(this.mirror.hasNode(e)){if(mv(e,this.mirror))return;this.movedSet.add(e);let r=null;n&&this.mirror.hasNode(n)&&(r=this.mirror.getId(n)),r&&r!==-1&&(this.movedMap[Ak(this.mirror.getId(e),r)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);fi(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(e.childNodes.forEach(r=>this.genAdds(r)),j0(e)&&e.shadowRoot.childNodes.forEach(r=>{this.processedNodeManager.add(r,this),this.genAdds(r,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(n=>{this[n]=e[n]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function z0(t,e){t.delete(e),e.childNodes.forEach(n=>z0(t,n))}function kk(t,e,n){return t.length===0?!1:$M(t,e,n)}function $M(t,e,n){const{parentNode:r}=e;if(!r)return!1;const i=n.getId(r);return t.some(s=>s.id===i)?!0:$M(t,r,n)}function Ek(t,e){return t.size===0?!1:KM(t,e)}function KM(t,e){const{parentNode:n}=e;return n?t.has(n)?!0:KM(t,n):!1}let od;function J$(t){od=t}function Y$(){od=void 0}const je=t=>od?(...n)=>{try{return t(...n)}catch(r){if(od&&od(r)===!0)return()=>{};throw r}}:t,$c=[];function If(t){try{if("composedPath"in t){const e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch{}return t&&t.target}function JM(t,e){var n,r;const i=new K$;$c.push(i),i.init(t);let s=window.MutationObserver||window.__rrMutationObserver;const o=(r=(n=window==null?void 0:window.Zone)===null||n===void 0?void 0:n.__symbol__)===null||r===void 0?void 0:r.call(n,"MutationObserver");o&&window[o]&&(s=window[o]);const a=new s(je(c=>{t.onMutation&&t.onMutation(c)===!1||i.processMutations.bind(i)(c)}));return a.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function q$({mousemoveCb:t,sampling:e,doc:n,mirror:r}){if(e.mousemove===!1)return()=>{};const i=typeof e.mousemove=="number"?e.mousemove:50,s=typeof e.mousemoveCallback=="number"?e.mousemoveCallback:500;let o=[],a;const c=Hd(je(d=>{const f=Date.now()-a;t(o.map(h=>(h.timeOffset-=f,h)),d),o=[],a=null}),s),l=je(Hd(je(d=>{const f=If(d),{clientX:h,clientY:p}=Z0(d)?d.changedTouches[0]:d;a||(a=Wp()),o.push({x:h,y:p,id:r.getId(f),timeOffset:Wp()-a}),c(typeof DragEvent<"u"&&d instanceof DragEvent?Fe.Drag:d instanceof MouseEvent?Fe.MouseMove:Fe.TouchMove)}),i,{trailing:!1})),u=[qn("mousemove",l,n),qn("touchmove",l,n),qn("drag",l,n)];return je(()=>{u.forEach(d=>d())})}function Q$({mouseInteractionCb:t,doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,sampling:o}){if(o.mouseInteraction===!1)return()=>{};const a=o.mouseInteraction===!0||o.mouseInteraction===void 0?{}:o.mouseInteraction,c=[];let l=null;const u=d=>f=>{const h=If(f);if(fi(h,r,i,s,!0))return;let p=null,g=d;if("pointerType"in f){switch(f.pointerType){case"mouse":p=ys.Mouse;break;case"touch":p=ys.Touch;break;case"pen":p=ys.Pen;break}p===ys.Touch?Hn[d]===Hn.MouseDown?g="TouchStart":Hn[d]===Hn.MouseUp&&(g="TouchEnd"):ys.Pen}else Z0(f)&&(p=ys.Touch);p!==null?(l=p,(g.startsWith("Touch")&&p===ys.Touch||g.startsWith("Mouse")&&p===ys.Mouse)&&(p=null)):Hn[d]===Hn.Click&&(p=l,l=null);const y=Z0(f)?f.changedTouches[0]:f;if(!y)return;const m=n.getId(h),{clientX:v,clientY:S}=y;je(t)(Object.assign({type:Hn[g],id:m,x:v,y:S},p!==null&&{pointerType:p}))};return Object.keys(Hn).filter(d=>Number.isNaN(Number(d))&&!d.endsWith("_Departed")&&a[d]!==!1).forEach(d=>{let f=Vl(d);const h=u(d);if(window.PointerEvent)switch(Hn[d]){case Hn.MouseDown:case Hn.MouseUp:f=f.replace("mouse","pointer");break;case Hn.TouchStart:case Hn.TouchEnd:return}c.push(qn(f,h,e))}),je(()=>{c.forEach(d=>d())})}function YM({scrollCb:t,doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,sampling:o}){const a=je(Hd(je(c=>{const l=If(c);if(!l||fi(l,r,i,s,!0))return;const u=n.getId(l);if(l===e&&e.defaultView){const d=GM(e.defaultView);t({id:u,x:d.left,y:d.top})}else t({id:u,x:l.scrollLeft,y:l.scrollTop})}),o.scroll||100));return qn("scroll",a,e)}function eK({viewportResizeCb:t},{win:e}){let n=-1,r=-1;const i=je(Hd(je(()=>{const s=VM(),o=WM();(n!==s||r!==o)&&(t({width:Number(o),height:Number(s)}),n=s,r=o)}),200));return qn("resize",i,e)}const tK=["INPUT","TEXTAREA","SELECT"],Tk=new WeakMap;function nK({inputCb:t,doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,ignoreClass:o,ignoreSelector:a,maskInputOptions:c,maskInputFn:l,sampling:u,userTriggeredOnInput:d,maskTextClass:f,unmaskTextClass:h,maskTextSelector:p,unmaskTextSelector:g}){function y(k){let _=If(k);const N=k.isTrusted,M=_&&H0(_.tagName);if(M==="OPTION"&&(_=_.parentElement),!_||!M||tK.indexOf(M)<0||fi(_,r,i,s,!0))return;const D=_;if(D.classList.contains(o)||a&&D.matches(a))return;const B=uS(_);let G=Gp(D,M,B),V=!1;const z=jm({maskInputOptions:c,tagName:M,type:B}),X=Wl(_,f,p,h,g,z);(B==="radio"||B==="checkbox")&&(V=_.checked),G=Vd({isMasked:X,element:_,value:G,maskInputFn:l}),m(_,d?{text:G,isChecked:V,userTriggered:N}:{text:G,isChecked:V});const te=_.name;B==="radio"&&te&&V&&e.querySelectorAll(`input[type="radio"][name="${te}"]`).forEach(H=>{if(H!==_){const K=Vd({isMasked:X,element:H,value:Gp(H,M,B),maskInputFn:l});m(H,d?{text:K,isChecked:!V,userTriggered:!1}:{text:K,isChecked:!V})}})}function m(k,_){const N=Tk.get(k);if(!N||N.text!==_.text||N.isChecked!==_.isChecked){Tk.set(k,_);const M=n.getId(k);je(t)(Object.assign(Object.assign({},_),{id:M}))}}const S=(u.input==="last"?["change"]:["input","change"]).map(k=>qn(k,je(y),e)),E=e.defaultView;if(!E)return()=>{S.forEach(k=>k())};const A=E.Object.getOwnPropertyDescriptor(E.HTMLInputElement.prototype,"value"),b=[[E.HTMLInputElement.prototype,"value"],[E.HTMLInputElement.prototype,"checked"],[E.HTMLSelectElement.prototype,"value"],[E.HTMLTextAreaElement.prototype,"value"],[E.HTMLSelectElement.prototype,"selectedIndex"],[E.HTMLOptionElement.prototype,"selected"]];return A&&A.set&&S.push(...b.map(k=>UM(k[0],k[1],{set(){je(y)({target:this,isTrusted:!1})}},!1,E))),je(()=>{S.forEach(k=>k())})}function Hp(t){const e=[];function n(r,i){if(sh("CSSGroupingRule")&&r.parentRule instanceof CSSGroupingRule||sh("CSSMediaRule")&&r.parentRule instanceof CSSMediaRule||sh("CSSSupportsRule")&&r.parentRule instanceof CSSSupportsRule||sh("CSSConditionRule")&&r.parentRule instanceof CSSConditionRule){const o=Array.from(r.parentRule.cssRules).indexOf(r);i.unshift(o)}else if(r.parentStyleSheet){const o=Array.from(r.parentStyleSheet.cssRules).indexOf(r);i.unshift(o)}return i}return n(t,e)}function No(t,e,n){let r,i;return t?(t.ownerNode?r=e.getId(t.ownerNode):i=n.getId(t),{styleId:i,id:r}):{}}function rK({styleSheetRuleCb:t,mirror:e,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const i=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(i,{apply:je((u,d,f)=>{const[h,p]=f,{id:g,styleId:y}=No(d,e,n.styleMirror);return(g&&g!==-1||y&&y!==-1)&&t({id:g,styleId:y,adds:[{rule:h,index:p}]}),u.apply(d,f)})});const s=r.CSSStyleSheet.prototype.deleteRule;r.CSSStyleSheet.prototype.deleteRule=new Proxy(s,{apply:je((u,d,f)=>{const[h]=f,{id:p,styleId:g}=No(d,e,n.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,removes:[{index:h}]}),u.apply(d,f)})});let o;r.CSSStyleSheet.prototype.replace&&(o=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(o,{apply:je((u,d,f)=>{const[h]=f,{id:p,styleId:g}=No(d,e,n.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,replace:h}),u.apply(d,f)})}));let a;r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:je((u,d,f)=>{const[h]=f,{id:p,styleId:g}=No(d,e,n.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,replaceSync:h}),u.apply(d,f)})}));const c={};oh("CSSGroupingRule")?c.CSSGroupingRule=r.CSSGroupingRule:(oh("CSSMediaRule")&&(c.CSSMediaRule=r.CSSMediaRule),oh("CSSConditionRule")&&(c.CSSConditionRule=r.CSSConditionRule),oh("CSSSupportsRule")&&(c.CSSSupportsRule=r.CSSSupportsRule));const l={};return Object.entries(c).forEach(([u,d])=>{l[u]={insertRule:d.prototype.insertRule,deleteRule:d.prototype.deleteRule},d.prototype.insertRule=new Proxy(l[u].insertRule,{apply:je((f,h,p)=>{const[g,y]=p,{id:m,styleId:v}=No(h.parentStyleSheet,e,n.styleMirror);return(m&&m!==-1||v&&v!==-1)&&t({id:m,styleId:v,adds:[{rule:g,index:[...Hp(h),y||0]}]}),f.apply(h,p)})}),d.prototype.deleteRule=new Proxy(l[u].deleteRule,{apply:je((f,h,p)=>{const[g]=p,{id:y,styleId:m}=No(h.parentStyleSheet,e,n.styleMirror);return(y&&y!==-1||m&&m!==-1)&&t({id:y,styleId:m,removes:[{index:[...Hp(h),g]}]}),f.apply(h,p)})})}),je(()=>{r.CSSStyleSheet.prototype.insertRule=i,r.CSSStyleSheet.prototype.deleteRule=s,o&&(r.CSSStyleSheet.prototype.replace=o),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(c).forEach(([u,d])=>{d.prototype.insertRule=l[u].insertRule,d.prototype.deleteRule=l[u].deleteRule})})}function qM({mirror:t,stylesheetManager:e},n){var r,i,s;let o=null;n.nodeName==="#document"?o=t.getId(n):o=t.getId(n.host);const a=n.nodeName==="#document"?(r=n.defaultView)===null||r===void 0?void 0:r.Document:(s=(i=n.ownerDocument)===null||i===void 0?void 0:i.defaultView)===null||s===void 0?void 0:s.ShadowRoot,c=a!=null&&a.prototype?Object.getOwnPropertyDescriptor(a==null?void 0:a.prototype,"adoptedStyleSheets"):void 0;return o===null||o===-1||!a||!c?()=>{}:(Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get(){var l;return(l=c.get)===null||l===void 0?void 0:l.call(this)},set(l){var u;const d=(u=c.set)===null||u===void 0?void 0:u.call(this,l);if(o!==null&&o!==-1)try{e.adoptStyleSheets(l,o)}catch{}return d}}),je(()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get:c.get,set:c.set})}))}function iK({styleDeclarationCb:t,mirror:e,ignoreCSSAttributes:n,stylesheetManager:r},{win:i}){const s=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:je((a,c,l)=>{var u;const[d,f,h]=l;if(n.has(d))return s.apply(c,[d,f,h]);const{id:p,styleId:g}=No((u=c.parentRule)===null||u===void 0?void 0:u.parentStyleSheet,e,r.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,set:{property:d,value:f,priority:h},index:Hp(c.parentRule)}),a.apply(c,l)})});const o=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(o,{apply:je((a,c,l)=>{var u;const[d]=l;if(n.has(d))return o.apply(c,[d]);const{id:f,styleId:h}=No((u=c.parentRule)===null||u===void 0?void 0:u.parentStyleSheet,e,r.styleMirror);return(f&&f!==-1||h&&h!==-1)&&t({id:f,styleId:h,remove:{property:d},index:Hp(c.parentRule)}),a.apply(c,l)})}),je(()=>{i.CSSStyleDeclaration.prototype.setProperty=s,i.CSSStyleDeclaration.prototype.removeProperty=o})}function sK({mediaInteractionCb:t,blockClass:e,blockSelector:n,unblockSelector:r,mirror:i,sampling:s,doc:o}){const a=je(l=>Hd(je(u=>{const d=If(u);if(!d||fi(d,e,n,r,!0))return;const{currentTime:f,volume:h,muted:p,playbackRate:g}=d;t({type:l,id:i.getId(d),currentTime:f,volume:h,muted:p,playbackRate:g})}),s.media||500)),c=[qn("play",a(0),o),qn("pause",a(1),o),qn("seeked",a(2),o),qn("volumechange",a(3),o),qn("ratechange",a(4),o)];return je(()=>{c.forEach(l=>l())})}function oK({fontCb:t,doc:e}){const n=e.defaultView;if(!n)return()=>{};const r=[],i=new WeakMap,s=n.FontFace;n.FontFace=function(c,l,u){const d=new s(c,l,u);return i.set(d,{family:c,buffer:typeof l!="string",descriptors:u,fontSource:typeof l=="string"?l:JSON.stringify(Array.from(new Uint8Array(l)))}),d};const o=hS(e.fonts,"add",function(a){return function(c){return setTimeout(je(()=>{const l=i.get(c);l&&(t(l),i.delete(c))}),0),a.apply(this,[c])}});return r.push(()=>{n.FontFace=s}),r.push(o),je(()=>{r.forEach(a=>a())})}function aK(t){const{doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,selectionCb:o}=t;let a=!0;const c=je(()=>{const l=e.getSelection();if(!l||a&&(l!=null&&l.isCollapsed))return;a=l.isCollapsed||!1;const u=[],d=l.rangeCount||0;for(let f=0;f<d;f++){const h=l.getRangeAt(f),{startContainer:p,startOffset:g,endContainer:y,endOffset:m}=h;fi(p,r,i,s,!0)||fi(y,r,i,s,!0)||u.push({start:n.getId(p),startOffset:g,end:n.getId(y),endOffset:m})}o({ranges:u})});return c(),qn("selectionchange",c)}function cK({doc:t,customElementCb:e}){const n=t.defaultView;return!n||!n.customElements?()=>{}:hS(n.customElements,"define",function(i){return function(s,o,a){try{e({define:{name:s}})}catch{}return i.apply(this,[s,o,a])}})}function lK(t,e={}){const n=t.doc.defaultView;if(!n)return()=>{};const r=JM(t,t.doc),i=q$(t),s=Q$(t),o=YM(t),a=eK(t,{win:n}),c=nK(t),l=sK(t),u=rK(t,{win:n}),d=qM(t,t.doc),f=iK(t,{win:n}),h=t.collectFonts?oK(t):()=>{},p=aK(t),g=cK(t),y=[];for(const m of t.plugins)y.push(m.observer(m.callback,n,m.options));return je(()=>{$c.forEach(m=>m.reset()),r.disconnect(),i(),s(),o(),a(),c(),l(),u(),d(),f(),h(),p(),g(),y.forEach(m=>m())})}function sh(t){return typeof window[t]<"u"}function oh(t){return!!(typeof window[t]<"u"&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}class X0{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,n,r,i){const s=r||this.getIdToRemoteIdMap(e),o=i||this.getRemoteIdToIdMap(e);let a=s.get(n);return a||(a=this.generateIdFn(),s.set(n,a),o.set(a,n)),a}getIds(e,n){const r=this.getIdToRemoteIdMap(e),i=this.getRemoteIdToIdMap(e);return n.map(s=>this.getId(e,s,r,i))}getRemoteId(e,n,r){const i=r||this.getRemoteIdToIdMap(e);if(typeof n!="number")return n;const s=i.get(n);return s||-1}getRemoteIds(e,n){const r=this.getRemoteIdToIdMap(e);return n.map(i=>this.getRemoteId(e,i,r))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let n=this.iframeIdToRemoteIdMap.get(e);return n||(n=new Map,this.iframeIdToRemoteIdMap.set(e,n)),n}getRemoteIdToIdMap(e){let n=this.iframeRemoteIdToIdMap.get(e);return n||(n=new Map,this.iframeRemoteIdToIdMap.set(e,n)),n}}class uK{constructor(){this.crossOriginIframeMirror=new X0(dS),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class dK{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new X0(dS),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new X0(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,n){var r;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:n}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(r=this.loadListener)===null||r===void 0||r.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const n=e;if(n.data.type!=="rrweb"||n.origin!==n.data.origin||!e.source)return;const i=this.crossOriginIframeMap.get(e.source);if(!i)return;const s=this.transformCrossOriginEvent(i,n.data.event);s&&this.wrappedEmit(s,n.data.isCheckout)}transformCrossOriginEvent(e,n){var r;switch(n.type){case Be.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(n.data.node,e);const i=n.data.node.id;return this.crossOriginIframeRootIdMap.set(e,i),this.patchRootIdOnNode(n.data.node,i),{timestamp:n.timestamp,type:Be.IncrementalSnapshot,data:{source:Fe.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:n.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case Be.Meta:case Be.Load:case Be.DomContentLoaded:return!1;case Be.Plugin:return n;case Be.Custom:return this.replaceIds(n.data.payload,e,["id","parentId","previousId","nextId"]),n;case Be.IncrementalSnapshot:switch(n.data.source){case Fe.Mutation:return n.data.adds.forEach(i=>{this.replaceIds(i,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(i.node,e);const s=this.crossOriginIframeRootIdMap.get(e);s&&this.patchRootIdOnNode(i.node,s)}),n.data.removes.forEach(i=>{this.replaceIds(i,e,["parentId","id"])}),n.data.attributes.forEach(i=>{this.replaceIds(i,e,["id"])}),n.data.texts.forEach(i=>{this.replaceIds(i,e,["id"])}),n;case Fe.Drag:case Fe.TouchMove:case Fe.MouseMove:return n.data.positions.forEach(i=>{this.replaceIds(i,e,["id"])}),n;case Fe.ViewportResize:return!1;case Fe.MediaInteraction:case Fe.MouseInteraction:case Fe.Scroll:case Fe.CanvasMutation:case Fe.Input:return this.replaceIds(n.data,e,["id"]),n;case Fe.StyleSheetRule:case Fe.StyleDeclaration:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleId"]),n;case Fe.Font:return n;case Fe.Selection:return n.data.ranges.forEach(i=>{this.replaceIds(i,e,["start","end"])}),n;case Fe.AdoptedStyleSheet:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleIds"]),(r=n.data.styles)===null||r===void 0||r.forEach(i=>{this.replaceStyleIds(i,e,["styleId"])}),n}}return!1}replace(e,n,r,i){for(const s of i)!Array.isArray(n[s])&&typeof n[s]!="number"||(Array.isArray(n[s])?n[s]=e.getIds(r,n[s]):n[s]=e.getId(r,n[s]));return n}replaceIds(e,n,r){return this.replace(this.crossOriginIframeMirror,e,n,r)}replaceStyleIds(e,n,r){return this.replace(this.crossOriginIframeStyleMirror,e,n,r)}replaceIdOnNode(e,n){this.replaceIds(e,n,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(r=>{this.replaceIdOnNode(r,n)})}patchRootIdOnNode(e,n){e.type!==nn.Document&&!e.rootId&&(e.rootId=n),"childNodes"in e&&e.childNodes.forEach(r=>{this.patchRootIdOnNode(r,n)})}}class fK{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class hK{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,n){if(!sd(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e);const r=JM(Object.assign(Object.assign({},this.bypassOptions),{doc:n,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push(()=>r.disconnect()),this.restoreHandlers.push(YM(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(qM({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){!e.contentWindow||!e.contentDocument||this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,n){const r=this;this.restoreHandlers.push(hS(e.prototype,"attachShadow",function(i){return function(s){const o=i.call(this,s);return this.shadowRoot&&XM(this)&&r.addShadowRoot(this.shadowRoot,n),o}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}class pK{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}}class mK{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new j$,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,n){"_cssText"in n.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:n.id,attributes:n.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,n){if(e.length===0)return;const r={id:n,styleIds:[]},i=[];for(const s of e){let o;this.styleMirror.has(s)?o=this.styleMirror.getId(s):(o=this.styleMirror.add(s),i.push({styleId:o,rules:Array.from(s.rules||CSSRule,(a,c)=>({rule:OM(a),index:c}))})),r.styleIds.push(o)}i.length>0&&(r.styles=i),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class gK{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(e,n){const r=this.nodeMap.get(e);return r&&Array.from(r).some(i=>i!==n)}add(e,n){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(n))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}function zt(t){const e=t;return e.timestamp=Wp(),e}let $0,Zp;const qr=C$();function ra(t={}){const{emit:e,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:i="rr-block",blockSelector:s=null,unblockSelector:o=null,ignoreClass:a="rr-ignore",ignoreSelector:c=null,maskAllText:l=!1,maskTextClass:u="rr-mask",unmaskTextClass:d=null,maskTextSelector:f=null,unmaskTextSelector:h=null,inlineStylesheet:p=!0,maskAllInputs:g,maskInputOptions:y,slimDOMOptions:m,maskAttributeFn:v,maskInputFn:S,maskTextFn:E,packFn:A,sampling:b={},dataURLOptions:k={},mousemoveWait:_,recordCanvas:N=!1,recordCrossOriginIframes:M=!1,recordAfter:D=t.recordAfter==="DOMContentLoaded"?t.recordAfter:"load",userTriggeredOnInput:B=!1,collectFonts:G=!1,inlineImages:V=!1,plugins:z,keepIframeSrcFn:X=()=>!1,ignoreCSSAttributes:te=new Set([]),errorHandler:H,onMutation:K,getCanvasManager:ie}=t;J$(H);const $=M?window.parent===window:!0;let se=!1;if(!$)try{window.parent.document&&(se=!1)}catch{se=!0}if($&&!e)throw new Error("emit function is required");_!==void 0&&b.mousemove===void 0&&(b.mousemove=_),qr.reset();const be=g===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:y!==void 0?y:{},we=m===!0||m==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:m==="all",headMetaDescKeywords:m==="all"}:m||{};Z$();let me,ke=0;const Ue=ue=>{for(const Le of z||[])Le.eventProcessor&&(ue=Le.eventProcessor(ue));return A&&!se&&(ue=A(ue)),ue},ce=(ue,Le)=>{var _e;if(!((_e=$c[0])===null||_e===void 0)&&_e.isFrozen()&&ue.type!==Be.FullSnapshot&&!(ue.type===Be.IncrementalSnapshot&&ue.data.source===Fe.Mutation)&&$c.forEach(Ge=>Ge.unfreeze()),$)e==null||e(Ue(ue),Le);else if(se){const Ge={type:"rrweb",event:Ue(ue),origin:window.location.origin,isCheckout:Le};window.parent.postMessage(Ge,"*")}if(ue.type===Be.FullSnapshot)me=ue,ke=0;else if(ue.type===Be.IncrementalSnapshot){if(ue.data.source===Fe.Mutation&&ue.data.isAttachIframe)return;ke++;const Ge=r&&ke>=r,Ut=n&&ue.timestamp-me.timestamp>n;(Ge||Ut)&&$e(!0)}};$0=ce;const xt=ue=>{ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.Mutation},ue)}))},cn=ue=>ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.Scroll},ue)})),wt=ue=>ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.CanvasMutation},ue)})),Cn=ue=>ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.AdoptedStyleSheet},ue)})),Kt=new mK({mutationCb:xt,adoptedStyleSheetCb:Cn}),In=typeof __RRWEB_EXCLUDE_IFRAME__=="boolean"&&__RRWEB_EXCLUDE_IFRAME__?new uK:new dK({mirror:qr,mutationCb:xt,stylesheetManager:Kt,recordCrossOriginIframes:M,wrappedEmit:ce});for(const ue of z||[])ue.getMirror&&ue.getMirror({nodeMirror:qr,crossOriginIframeMirror:In.crossOriginIframeMirror,crossOriginIframeStyleMirror:In.crossOriginIframeStyleMirror});const le=new gK,Ce=CK(ie,{recordCanvas:N,blockClass:i,blockSelector:s,unblockSelector:o,sampling:b.canvas,dataURLOptions:k}),Ye=typeof __RRWEB_EXCLUDE_SHADOW_DOM__=="boolean"&&__RRWEB_EXCLUDE_SHADOW_DOM__?new fK:new hK({mutationCb:xt,scrollCb:cn,bypassOptions:{onMutation:K,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,inlineStylesheet:p,maskInputOptions:be,dataURLOptions:k,maskAttributeFn:v,maskTextFn:E,maskInputFn:S,recordCanvas:N,inlineImages:V,sampling:b,slimDOMOptions:we,iframeManager:In,stylesheetManager:Kt,canvasManager:Ce,keepIframeSrcFn:X,processedNodeManager:le},mirror:qr}),$e=(ue=!1)=>{ce(zt({type:Be.Meta,data:{href:window.location.href,width:WM(),height:VM()}}),ue),Kt.reset(),Ye.init(),$c.forEach(_e=>_e.lock());const Le=W$(document,{mirror:qr,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,inlineStylesheet:p,maskAllInputs:be,maskAttributeFn:v,maskInputFn:S,maskTextFn:E,slimDOM:we,dataURLOptions:k,recordCanvas:N,inlineImages:V,onSerialize:_e=>{ZM(_e,qr)&&In.addIframe(_e),jM(_e,qr)&&Kt.trackLinkElement(_e),j0(_e)&&Ye.addShadowRoot(_e.shadowRoot,document)},onIframeLoad:(_e,Ge)=>{In.attachIframe(_e,Ge),Ye.observeAttachShadow(_e)},onStylesheetLoad:(_e,Ge)=>{Kt.attachLinkElement(_e,Ge)},keepIframeSrcFn:X});if(!Le)return console.warn("Failed to snapshot the document");ce(zt({type:Be.FullSnapshot,data:{node:Le,initialOffset:GM(window)}})),$c.forEach(_e=>_e.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&Kt.adoptStyleSheets(document.adoptedStyleSheets,qr.getId(document))};Zp=$e;try{const ue=[],Le=Ge=>{var Ut;return je(lK)({onMutation:K,mutationCb:xt,mousemoveCb:(De,jt)=>ce(zt({type:Be.IncrementalSnapshot,data:{source:jt,positions:De}})),mouseInteractionCb:De=>ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.MouseInteraction},De)})),scrollCb:cn,viewportResizeCb:De=>ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.ViewportResize},De)})),inputCb:De=>ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.Input},De)})),mediaInteractionCb:De=>ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.MediaInteraction},De)})),styleSheetRuleCb:De=>ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.StyleSheetRule},De)})),styleDeclarationCb:De=>ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.StyleDeclaration},De)})),canvasMutationCb:wt,fontCb:De=>ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.Font},De)})),selectionCb:De=>{ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.Selection},De)}))},customElementCb:De=>{ce(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.CustomElement},De)}))},blockClass:i,ignoreClass:a,ignoreSelector:c,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,maskInputOptions:be,inlineStylesheet:p,sampling:b,recordCanvas:N,inlineImages:V,userTriggeredOnInput:B,collectFonts:G,doc:Ge,maskAttributeFn:v,maskInputFn:S,maskTextFn:E,keepIframeSrcFn:X,blockSelector:s,unblockSelector:o,slimDOMOptions:we,dataURLOptions:k,mirror:qr,iframeManager:In,stylesheetManager:Kt,shadowDomManager:Ye,processedNodeManager:le,canvasManager:Ce,ignoreCSSAttributes:te,plugins:((Ut=z==null?void 0:z.filter(De=>De.observer))===null||Ut===void 0?void 0:Ut.map(De=>({observer:De.observer,options:De.options,callback:jt=>ce(zt({type:Be.Plugin,data:{plugin:De.name,payload:jt}}))})))||[]},{})};In.addLoadListener(Ge=>{try{ue.push(Le(Ge.contentDocument))}catch(Ut){console.warn(Ut)}});const _e=()=>{$e(),ue.push(Le(document))};return document.readyState==="interactive"||document.readyState==="complete"?_e():(ue.push(qn("DOMContentLoaded",()=>{ce(zt({type:Be.DomContentLoaded,data:{}})),D==="DOMContentLoaded"&&_e()})),ue.push(qn("load",()=>{ce(zt({type:Be.Load,data:{}})),D==="load"&&_e()},window))),()=>{ue.forEach(Ge=>Ge()),le.destroy(),Zp=void 0,Y$()}}catch(ue){console.warn(ue)}}function vK(t){if(!Zp)throw new Error("please take full snapshot after start recording");Zp(t)}function yK(t){$0&&$0(t)}ra.mirror=qr;ra.takeFullSnapshot=vK;function CK(t,e){return t?t(Object.assign(Object.assign({},e),{mirror:qr,win:window,mutationCb:n=>yK(zt({type:Be.IncrementalSnapshot,data:Object.assign({source:Fe.CanvasMutation},n)}))})):new pK}const IK=3,SK=5;function pS(t){return t>9999999999?t:t*1e3}function gv(t){return t>9999999999?t/1e3:t}function Sf(t,e){e.category!=="sentry.transaction"&&(["ui.click","ui.input"].includes(e.category)?t.triggerUserActivity():t.checkAndHandleExpiredSession(),t.addUpdate(()=>(t.throttledAddEvent({type:Be.Custom,timestamp:(e.timestamp||0)*1e3,data:{tag:"breadcrumb",payload:Fi(e,10,1e3)}}),e.category==="console")))}const bK="button,a";function QM(t){return t.closest(bK)||t}function ex(t){const e=tx(t);return!e||!(e instanceof Element)?e:QM(e)}function tx(t){return wK(t)?t.target:t}function wK(t){return typeof t=="object"&&!!t&&"target"in t}let Po;function AK(t){return Po||(Po=[],kK()),Po.push(t),()=>{const e=Po?Po.indexOf(t):-1;e>-1&&Po.splice(e,1)}}function kK(){gn(ht,"open",function(t){return function(...e){if(Po)try{Po.forEach(n=>n())}catch{}return t.apply(ht,e)}})}function EK(t,e,n){t.handleClick(e,n)}class TK{constructor(e,n,r=Sf){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=n.timeout/1e3,this._threshold=n.threshold/1e3,this._scollTimeout=n.scrollTimeout/1e3,this._replay=e,this._ignoreSelector=n.ignoreSelector,this._addBreadcrumbEvent=r}addListeners(){const e=AK(()=>{this._lastMutation=_k()});this._teardown=()=>{e(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(e,n){if(RK(n,this._ignoreSelector)||!NK(e))return;const r={timestamp:gv(e.timestamp),clickBreadcrumb:e,clickCount:0,node:n};this._clicks.some(i=>i.node===r.node&&Math.abs(i.timestamp-r.timestamp)<1)||(this._clicks.push(r),this._clicks.length===1&&this._scheduleCheckClicks())}registerMutation(e=Date.now()){this._lastMutation=gv(e)}registerScroll(e=Date.now()){this._lastScroll=gv(e)}registerClick(e){const n=QM(e);this._handleMultiClick(n)}_handleMultiClick(e){this._getClicks(e).forEach(n=>{n.clickCount++})}_getClicks(e){return this._clicks.filter(n=>n.node===e)}_checkClicks(){const e=[],n=_k();this._clicks.forEach(r=>{!r.mutationAfter&&this._lastMutation&&(r.mutationAfter=r.timestamp<=this._lastMutation?this._lastMutation-r.timestamp:void 0),!r.scrollAfter&&this._lastScroll&&(r.scrollAfter=r.timestamp<=this._lastScroll?this._lastScroll-r.timestamp:void 0),r.timestamp+this._timeout<=n&&e.push(r)});for(const r of e){const i=this._clicks.indexOf(r);i>-1&&(this._generateBreadcrumbs(r),this._clicks.splice(i,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(e){const n=this._replay,r=e.scrollAfter&&e.scrollAfter<=this._scollTimeout,i=e.mutationAfter&&e.mutationAfter<=this._threshold,s=!r&&!i,{clickCount:o,clickBreadcrumb:a}=e;if(s){const c=Math.min(e.mutationAfter||this._timeout,this._timeout)*1e3,l=c<this._timeout*1e3?"mutation":"timeout",u={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.slowClickDetected",data:{...a.data,url:ht.location.href,route:n.getCurrentRoute(),timeAfterClickMs:c,endReason:l,clickCount:o||1}};this._addBreadcrumbEvent(n,u);return}if(o>1){const c={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.multiClick",data:{...a.data,url:ht.location.href,route:n.getCurrentRoute(),clickCount:o,metric:!0}};this._addBreadcrumbEvent(n,c)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=setTimeout(()=>this._checkClicks(),1e3)}}const _K=["A","BUTTON","INPUT"];function RK(t,e){return!!(!_K.includes(t.tagName)||t.tagName==="INPUT"&&!["submit","button"].includes(t.getAttribute("type")||"")||t.tagName==="A"&&(t.hasAttribute("download")||t.hasAttribute("target")&&t.getAttribute("target")!=="_self")||e&&t.matches(e))}function NK(t){return!!(t.data&&typeof t.data.nodeId=="number"&&t.timestamp)}function _k(){return Date.now()/1e3}function PK(t,e){try{if(!MK(e))return;const{source:n}=e.data;if(n===Fe.Mutation&&t.registerMutation(e.timestamp),n===Fe.Scroll&&t.registerScroll(e.timestamp),xK(e)){const{type:r,id:i}=e.data,s=ra.mirror.getNode(i);s instanceof HTMLElement&&r===Hn.Click&&t.registerClick(s)}}catch{}}function MK(t){return t.type===IK}function xK(t){return t.data.source===Fe.MouseInteraction}function os(t){return{timestamp:Date.now()/1e3,type:"default",...t}}var jp;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(jp||(jp={}));const DK=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function OK(t){const e={};for(const n in t)if(DK.has(n)){let r=n;(n==="data-testid"||n==="data-test-id")&&(r="testId"),e[r]=t[n]}return e}const LK=t=>e=>{if(!t.isEnabled())return;const n=BK(e);if(!n)return;const r=e.name==="click",i=r?e.event:void 0;r&&t.clickDetector&&i&&i.target&&!i.altKey&&!i.metaKey&&!i.ctrlKey&&!i.shiftKey&&EK(t.clickDetector,n,ex(e.event)),Sf(t,n)};function nx(t,e){const n=ra.mirror.getId(t),r=n&&ra.mirror.getNode(n),i=r&&ra.mirror.getMeta(r),s=i&&UK(i)?i:null;return{message:e,data:s?{nodeId:n,node:{id:n,tagName:s.tagName,textContent:Array.from(s.childNodes).map(o=>o.type===jp.Text&&o.textContent).filter(Boolean).map(o=>o.trim()).join(""),attributes:OK(s.attributes)}}:{}}}function BK(t){const{target:e,message:n}=FK(t);return os({category:`ui.${t.name}`,...nx(e,n)})}function FK(t){const e=t.name==="click";let n,r=null;try{r=e?ex(t.event):tx(t.event),n=nc(r,{maxStringLength:200})||"<unknown>"}catch{n="<unknown>"}return{target:r,message:n}}function UK(t){return t.type===jp.Element}function GK(t,e){if(!t.isEnabled())return;t.updateUserActivity();const n=VK(e);n&&Sf(t,n)}function VK(t){const{metaKey:e,shiftKey:n,ctrlKey:r,altKey:i,key:s,target:o}=t;if(!o||WK(o)||!s)return null;const a=e||r||i,c=s.length===1;if(!a&&c)return null;const l=nc(o,{maxStringLength:200})||"<unknown>",u=nx(o,l);return os({category:"ui.keyDown",message:l,data:{...u.data,metaKey:e,shiftKey:n,ctrlKey:r,altKey:i,key:s}})}function WK(t){return t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable}const Rk={resource:XK,paint:jK,navigation:zK};function HK(t){return t.map(ZK).filter(Boolean)}function ZK(t){return Rk[t.entryType]?Rk[t.entryType](t):null}function Hl(t){return((Ti||ht.performance.timeOrigin)+t)/1e3}function jK(t){const{duration:e,entryType:n,name:r,startTime:i}=t,s=Hl(i);return{type:n,name:r,start:s,end:s+e,data:void 0}}function zK(t){const{entryType:e,name:n,decodedBodySize:r,duration:i,domComplete:s,encodedBodySize:o,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,domInteractive:l,loadEventStart:u,loadEventEnd:d,redirectCount:f,startTime:h,transferSize:p,type:g}=t;return i===0?null:{type:`${e}.${g}`,start:Hl(h),end:Hl(s),name:n,data:{size:p,decodedBodySize:r,encodedBodySize:o,duration:i,domInteractive:l,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,loadEventStart:u,loadEventEnd:d,domComplete:s,redirectCount:f}}}function XK(t){const{entryType:e,initiatorType:n,name:r,responseEnd:i,startTime:s,decodedBodySize:o,encodedBodySize:a,responseStatus:c,transferSize:l}=t;return["fetch","xmlhttprequest"].includes(n)?null:{type:`${e}.${n}`,start:Hl(s),end:Hl(i),name:r,data:{size:l,statusCode:c,decodedBodySize:o,encodedBodySize:a}}}function $K(t){const e=t.entries,n=e[e.length-1],r=n?n.element:void 0,i=t.value,s=Hl(i);return{type:"largest-contentful-paint",name:"largest-contentful-paint",start:s,end:s,data:{value:i,size:i,nodeId:r?ra.mirror.getId(r):void 0}}}function KK(t){function e(i){t.performanceEntries.includes(i)||t.performanceEntries.push(i)}function n({entries:i}){i.forEach(e)}const r=[];return["navigation","paint","resource"].forEach(i=>{r.push(Hm(i,n))}),r.push(PM(({metric:i})=>{t.replayPerformanceEntries.push($K(i))})),()=>{r.forEach(i=>i())}}const ct=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,JK='var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var i=new n(31),a=0;a<31;++a)i[a]=e+=1<<t[a-1];var s=new r(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return{b:i,r:s}},o=s(e,2),f=o.b,h=o.r;f[28]=258,h[258]=28;for(var l=s(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,a=0,s=new n(r);a<i;++a)t[a]&&++s[t[a]-1];var o,f=new n(r);for(a=1;a<r;++a)f[a]=f[a-1]+s[a-1]<<1;if(e){o=new n(1<<r);var h=15-r;for(a=0;a<i;++a)if(t[a])for(var l=a<<4|t[a],c=r-t[a],v=f[t[a]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>h]=l}else for(o=new n(i),a=0;a<i;++a)t[a]&&(o[a]=u[f[t[a]-1]++]>>15-t[a]);return o},g=new t(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var w=new t(32);for(c=0;c<32;++c)w[c]=5;var p=d(g,9,0),y=d(w,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==r||r<0)&&(r=0),(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},A=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},_=function(r,e){for(var i=[],a=0;a<r.length;++a)r[a]&&i.push({s:a,f:r[a]});var s=i.length,o=i.slice();if(!s)return{t:F,l:0};if(1==s){var f=new t(i[0].s+1);return f[i[0].s]=1,{t:f,l:1}}i.sort((function(t,n){return t.f-n.f})),i.push({s:-1,f:25001});var h=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:h.f+l.f,l:h,r:l};c!=s-1;)h=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:h.f+l.f,l:h,r:l};var d=o[0].s;for(a=1;a<s;++a)o[a].s>d&&(d=o[a].s);var g=new n(d+1),w=x(i[c-1],g,0);if(w>e){a=0;var p=0,y=w-e,m=1<<y;for(o.sort((function(t,n){return g[n.s]-g[t.s]||t.f-n.f}));a<s;++a){var b=o[a].s;if(!(g[b]>e))break;p+=m-(1<<w-g[b]),g[b]=e}for(p>>=y;p>0;){var M=o[a].s;g[M]<e?p-=1<<e-g[M]++-1:++a}for(;a>=0&&p;--a){var E=o[a].s;g[E]==e&&(--g[E],++p)}w=e}return{t:new t(g),l:w}},x=function(t,n,r){return-1==t.s?Math.max(x(t.l,n,r+1),x(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,a=t[0],s=1,o=function(t){e[i++]=t},f=1;f<=r;++f)if(t[f]==a&&f!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[f]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var a=0;a<e;++a)t[i+a+4]=r[a];return 8*(i+4+e)},C=function(t,r,s,o,f,h,l,u,c,v,m){z(r,m++,s),++f[256];for(var b=_(f,15),M=b.t,E=b.l,x=_(h,15),C=x.t,U=x.l,F=D(M),I=F.c,S=F.n,L=D(C),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=_(q,7),H=G.t,J=G.l,K=19;K>4&&!H[a[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(f,g)+T(h,w)+l,X=T(f,M)+T(h,C)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(C,U,0),R=C;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[a[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=p,P=g,Q=y,R=w;for(B=0;B<u;++B){var rt=o[B];if(rt>255){A(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;A(r,m,Q[et]),m+=R[et],et>3&&(A(r,m,rt>>5&8191),m+=i[et])}else A(r,m,N[rt]),m+=P[rt]}return A(r,m,N[256]),m+P[256]},U=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,a=0|r.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=e+=r[s];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},L=function(a,s,o,f,u){if(!u&&(u={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),v=new t(c.length+a.length);v.set(c),v.set(a,c.length),a=v,u.w=c.length}return function(a,s,o,f,u,c){var v=c.z||a.length,d=new t(f+v+5*(1+Math.ceil(v/7e3))+u),g=d.subarray(f,d.length-u),w=c.l,p=7&(c.r||0);if(s){p&&(g[0]=c.r>>3);for(var y=U[s-1],M=y>>13,E=8191&y,z=(1<<o)-1,A=c.p||new n(32768),_=c.h||new n(z+1),x=Math.ceil(o/3),D=2*x,T=function(t){return(a[t]^a[t+1]<<x^a[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=_[H];if(A[J]=K,_[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!w)){p=C(a,g,0,F,I,S,O,q,G,j-G,p),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(a[j+Q]==a[j+Q-W]){for(var $=0;$<Z&&a[j+$]==a[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-A[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=A[J])&32767}if(R){F[q++]=268435456|h[Q]<<18|l[R];var it=31&h[Q],at=31&l[R];O+=e[it]+i[at],++I[257+it],++S[at],B=j+Q,++L}else F[q++]=a[j],++I[a[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=a[j],++I[a[j]];p=C(a,g,w,F,I,S,O,q,G,j-G,p),w||(c.r=7&p|g[p/8|0]<<3,p-=7,c.h=_,c.p=A,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+w;j+=65535){var st=j+65535;st>=v&&(g[p/8|0]=w,st=v),p=k(g,p+1,a.subarray(j,st))}c.i=v}return b(d,0,f+m(p)+u)}(a,null==s.level?6:s.level,null==s.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+s.mem,o,f,u)},O=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},j=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(L(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var a=this.b.length-this.s.z;a&&(this.b.set(n.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1)),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(a),32768),this.s.z=n.length-a+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n}();function q(t,n){n||(n={});var r=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}}(),e=t.length;r.p(t);var i,a=L(t,n,10+((i=n).filename?i.filename.length+1:0),8),s=a.length;return function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&O(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}}(a,n),O(a,s-8,r.d()),O(a,s-4,e),a}var B=function(){function t(t,n){this.c=S(),this.v=1,j.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),j.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=L(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=S();i.p(n.dictionary),O(t,2,i.d())}}(r,this.o),this.v=0),n&&O(r,r.length-4,this.c.d()),this.ondata(r,n)},t}(),G="undefined"!=typeof TextEncoder&&new TextEncoder,H="undefined"!=typeof TextDecoder&&new TextDecoder;try{H.decode(F,{stream:!0})}catch(t){}var J=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(K(t),this.d=n||!1)},t}();function K(n,r){if(r){for(var e=new t(n.length),i=0;i<n.length;++i)e[i]=n.charCodeAt(i);return e}if(G)return G.encode(n);var a=n.length,s=new t(n.length+(n.length>>1)),o=0,f=function(t){s[o++]=t};for(i=0;i<a;++i){if(o+5>s.length){var h=new t(o+8+(a-i<<1));h.set(s),s=h}var l=n.charCodeAt(i);l<128||r?f(l):l<2048?(f(192|l>>6),f(128|63&l)):l>55295&&l<57344?(f(240|(l=65536+(1047552&l)|1023&n.charCodeAt(++i))>>18),f(128|l>>12&63),f(128|l>>6&63),f(128|63&l)):(f(224|l>>12),f(128|l>>6&63),f(128|63&l))}return b(s,0,o)}const N=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(let r=0,e=t.length;r<e;r++)n+=t[r].length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new B,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new J(((t,n)=>{this.deflate.push(t,n)})),this.stream.push("[")}},P={clear:()=>{N.clear()},addEvent:t=>N.addEvent(t),finish:()=>N.finish(),compress:t=>function(t){return q(K(t))}(t)};addEventListener("message",(function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in P&&"function"==typeof P[n])try{const t=P[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});';function YK(){const t=new Blob([JK]);return URL.createObjectURL(t)}function $n(t,e){ct&&(J.info(t),e&&rx(t))}function ml(t,e){ct&&(J.info(t),e&&setTimeout(()=>{rx(t)},0))}function rx(t){fa({category:"console",data:{logger:"replay"},level:"info",message:t},{level:"info"})}class mS extends Error{constructor(){super(`Event buffer exceeded maximum size of ${lS}.`)}}class ix{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(e){const n=JSON.stringify(e).length;if(this._totalSize+=n,this._totalSize>lS)throw new mS;this.events.push(e)}finish(){return new Promise(e=>{const n=this.events;this.clear(),e(JSON.stringify(n))})}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const e=this.events.map(n=>n.timestamp).sort()[0];return e?pS(e):null}}class qK{constructor(e){this._worker=e,this._id=0}ensureReady(){return this._ensureReadyPromise?this._ensureReadyPromise:(this._ensureReadyPromise=new Promise((e,n)=>{this._worker.addEventListener("message",({data:r})=>{r.success?e():n()},{once:!0}),this._worker.addEventListener("error",r=>{n(r)},{once:!0})}),this._ensureReadyPromise)}destroy(){$n("[Replay] Destroying compression worker"),this._worker.terminate()}postMessage(e,n){const r=this._getAndIncrementId();return new Promise((i,s)=>{const o=({data:a})=>{const c=a;if(c.method===e&&c.id===r){if(this._worker.removeEventListener("message",o),!c.success){ct&&J.error("[Replay]",c.response),s(new Error("Error in compression worker"));return}i(c.response)}};this._worker.addEventListener("message",o),this._worker.postMessage({id:r,method:e,arg:n})})}_getAndIncrementId(){return this._id++}}class QK{constructor(e){this._worker=new qK(e),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(e){const n=pS(e.timestamp);(!this._earliestTimestamp||n<this._earliestTimestamp)&&(this._earliestTimestamp=n);const r=JSON.stringify(e);return this._totalSize+=r.length,this._totalSize>lS?Promise.reject(new mS):this._sendEventToWorker(r)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear").then(null,e=>{ct&&J.warn('[Replay] Sending "clear" message to worker failed',e)})}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(e){return this._worker.postMessage("addEvent",e)}async _finishRequest(){const e=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,e}}class eJ{constructor(e){this._fallback=new ix,this._compression=new QK(e),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(e){this._used.hasCheckout=e}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(e){return this._used.addEvent(e)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch{$n("[Replay] Failed to load the compression worker, falling back to simple buffer");return}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:e,hasCheckout:n}=this._fallback,r=[];for(const i of e)r.push(this._compression.addEvent(i));this._compression.hasCheckout=n,this._used=this._compression;try{await Promise.all(r)}catch(i){ct&&J.warn("[Replay] Failed to add events when switching buffers.",i)}}}function tJ({useCompression:t,workerUrl:e}){if(t&&window.Worker){const n=nJ(e);if(n)return n}return $n("[Replay] Using simple buffer"),new ix}function nJ(t){try{const e=t||rJ();if(!e)return;$n(`[Replay] Using compression worker${t?` from ${t}`:""}`);const n=new Worker(e);return new eJ(n)}catch{$n("[Replay] Failed to create compression worker")}}function rJ(){return typeof __SENTRY_EXCLUDE_REPLAY_WORKER__>"u"||!__SENTRY_EXCLUDE_REPLAY_WORKER__?YK():""}function gS(){try{return"sessionStorage"in ht&&!!ht.sessionStorage}catch{return!1}}function iJ(t){sJ(),t.session=void 0}function sJ(){if(gS())try{ht.sessionStorage.removeItem(aS)}catch{}}function sx(t){return t===void 0?!1:Math.random()<t}function ox(t){const e=Date.now(),n=t.id||Un(),r=t.started||e,i=t.lastActivity||e,s=t.segmentId||0,o=t.sampled,a=t.previousSessionId;return{id:n,started:r,lastActivity:i,segmentId:s,sampled:o,previousSessionId:a}}function vS(t){if(gS())try{ht.sessionStorage.setItem(aS,JSON.stringify(t))}catch{}}function oJ(t,e){return sx(t)?"session":e?"buffer":!1}function Nk({sessionSampleRate:t,allowBuffering:e,stickySession:n=!1},{previousSessionId:r}={}){const i=oJ(t,e),s=ox({sampled:i,previousSessionId:r});return n&&vS(s),s}function aJ(t){if(!gS())return null;try{const e=ht.sessionStorage.getItem(aS);if(!e)return null;const n=JSON.parse(e);return ml("[Replay] Loading existing session",t),ox(n)}catch{return null}}function K0(t,e,n=+new Date){return t===null||e===void 0||e<0?!0:e===0?!1:t+e<=n}function ax(t,{maxReplayDuration:e,sessionIdleExpire:n,targetTime:r=Date.now()}){return K0(t.started,e,r)||K0(t.lastActivity,n,r)}function cx(t,{sessionIdleExpire:e,maxReplayDuration:n}){return!(!ax(t,{sessionIdleExpire:e,maxReplayDuration:n})||t.sampled==="buffer"&&t.segmentId===0)}function vv({traceInternals:t,sessionIdleExpire:e,maxReplayDuration:n,previousSessionId:r},i){const s=i.stickySession&&aJ(t);return s?cx(s,{sessionIdleExpire:e,maxReplayDuration:n})?(ml("[Replay] Session in sessionStorage is expired, creating new one..."),Nk(i,{previousSessionId:s.id})):s:(ml("[Replay] Creating new session",t),Nk(i,{previousSessionId:r}))}function cJ(t){return t.type===Be.Custom}function yS(t,e,n){return ux(t,e)?(lx(t,e,n),!0):!1}function lJ(t,e,n){return ux(t,e)?lx(t,e,n):Promise.resolve(null)}async function lx(t,e,n){if(!t.eventBuffer)return null;try{n&&t.recordingMode==="buffer"&&t.eventBuffer.clear(),n&&(t.eventBuffer.hasCheckout=!0);const r=t.getOptions(),i=uJ(e,r.beforeAddRecordingEvent);return i?await t.eventBuffer.addEvent(i):void 0}catch(r){const i=r&&r instanceof mS?"addEventSizeExceeded":"addEvent";ct&&J.error(r),await t.stop({reason:i});const s=Mt();s&&s.recordDroppedEvent("internal_sdk_error","replay")}}function ux(t,e){if(!t.eventBuffer||t.isPaused()||!t.isEnabled())return!1;const n=pS(e.timestamp);return n+t.timeouts.sessionIdlePause<Date.now()?!1:n>t.getContext().initialTimestamp+t.getOptions().maxReplayDuration?($n(`[Replay] Skipping event with timestamp ${n} because it is after maxReplayDuration`,t.getOptions()._experiments.traceInternals),!1):!0}function uJ(t,e){try{if(typeof e=="function"&&cJ(t))return e(t)}catch(n){return ct&&J.error("[Replay] An error occured in the `beforeAddRecordingEvent` callback, skipping the event...",n),null}return t}function CS(t){return!t.type}function J0(t){return t.type==="transaction"}function dJ(t){return t.type==="replay_event"}function Pk(t){return t.type==="feedback"}function dx(t){const e=pJ();return(n,r)=>{if(!t.isEnabled()||!CS(n)&&!J0(n))return;const i=r&&r.statusCode;if(!(e&&(!i||i<200||i>=300))){if(J0(n)){fJ(t,n);return}hJ(t,n)}}}function fJ(t,e){const n=t.getContext();e.contexts&&e.contexts.trace&&e.contexts.trace.trace_id&&n.traceIds.size<100&&n.traceIds.add(e.contexts.trace.trace_id)}function hJ(t,e){const n=t.getContext();if(e.event_id&&n.errorIds.size<100&&n.errorIds.add(e.event_id),t.recordingMode!=="buffer"||!e.tags||!e.tags.replayId)return;const{beforeErrorSampling:r}=t.getOptions();typeof r=="function"&&!r(e)||setTimeout(()=>{t.sendBufferedReplayOrFlush()})}function pJ(){const t=Mt();if(!t)return!1;const e=t.getTransport();return e&&e.send.__sentry__baseTransport__||!1}function mJ(t){return e=>{!t.isEnabled()||!CS(e)||gJ(t,e)}}function gJ(t,e){const n=e.exception&&e.exception.values&&e.exception.values[0].value;if(typeof n=="string"&&(n.match(/reactjs\.org\/docs\/error-decoder\.html\?invariant=(418|419|422|423|425)/)||n.match(/(does not match server-rendered HTML|Hydration failed because)/i))){const r=os({category:"replay.hydrate-error"});Sf(t,r)}}function vJ(t,e){return t.type||!t.exception||!t.exception.values||!t.exception.values.length?!1:!!(e.originalException&&e.originalException.__rrweb__)}function yJ(t,e){t.triggerUserActivity(),t.addUpdate(()=>e.timestamp?(t.throttledAddEvent({type:Be.Custom,timestamp:e.timestamp*1e3,data:{timestamp:e.timestamp,tag:"breadcrumb",payload:{category:"sentry.feedback",data:{feedbackId:e.event_id}}}}),!1):!0)}function CJ(t,e){return t.recordingMode!=="buffer"||e.message===cS||!e.exception||e.type?!1:sx(t.getOptions().errorSampleRate)}function IJ(t,e=!1){const n=e?dx(t):void 0;return Object.assign((r,i)=>t.isEnabled()?dJ(r)?(delete r.breadcrumbs,r):!CS(r)&&!J0(r)&&!Pk(r)||!t.checkAndHandleExpiredSession()?r:Pk(r)?(t.flush(),r.contexts.feedback.replay_id=t.getSessionId(),yJ(t,r),r):vJ(r,i)&&!t.getOptions()._experiments.captureExceptions?(ct&&J.log("[Replay] Ignoring error from rrweb internals",r),null):((CJ(t,r)||t.recordingMode==="session")&&(r.tags={...r.tags,replayId:t.getSessionId()}),n&&n(r,{statusCode:200}),r):r,{id:"Replay"})}function zm(t,e){return e.map(({type:n,start:r,end:i,name:s,data:o})=>{const a=t.throttledAddEvent({type:Be.Custom,timestamp:r,data:{tag:"performanceSpan",payload:{op:n,description:s,startTimestamp:r,endTimestamp:i,data:o}}});return typeof a=="string"?Promise.resolve(null):a})}function SJ(t){const{from:e,to:n}=t,r=Date.now()/1e3;return{type:"navigation.push",start:r,end:r,name:n,data:{previous:e}}}function bJ(t){return e=>{if(!t.isEnabled())return;const n=SJ(e);n!==null&&(t.getContext().urls.push(n.name),t.triggerUserActivity(),t.addUpdate(()=>(zm(t,[n]),!1)))}}function wJ(t,e){return ct&&t.getOptions()._experiments.traceInternals?!1:Jz(e,Mt())}function Xm(t,e){t.isEnabled()&&e!==null&&(wJ(t,e.name)||t.addUpdate(()=>(zm(t,[e]),!0)))}function AJ(t){const{startTimestamp:e,endTimestamp:n,fetchData:r,response:i}=t;if(!n)return null;const{method:s,url:o}=r;return{type:"resource.fetch",start:e/1e3,end:n/1e3,name:o,data:{method:s,statusCode:i?i.status:void 0}}}function kJ(t){return e=>{if(!t.isEnabled())return;const n=AJ(e);Xm(t,n)}}function EJ(t){const{startTimestamp:e,endTimestamp:n,xhr:r}=t,i=r[jo];if(!e||!n||!i)return null;const{method:s,url:o,status_code:a}=i;return o===void 0?null:{type:"resource.xhr",name:o,start:e/1e3,end:n/1e3,data:{method:s,statusCode:a}}}function TJ(t){return e=>{if(!t.isEnabled())return;const n=EJ(e);Xm(t,n)}}function $m(t,e){if(t)try{if(typeof t=="string")return e.encode(t).length;if(t instanceof URLSearchParams)return e.encode(t.toString()).length;if(t instanceof FormData){const n=mx(t);return e.encode(n).length}if(t instanceof Blob)return t.size;if(t instanceof ArrayBuffer)return t.byteLength}catch{}}function fx(t){if(!t)return;const e=parseInt(t,10);return isNaN(e)?void 0:e}function hx(t){try{if(typeof t=="string")return[t];if(t instanceof URLSearchParams)return[t.toString()];if(t instanceof FormData)return[mx(t)];if(!t)return[void 0]}catch{return ct&&J.warn("[Replay] Failed to serialize body",t),[void 0,"BODY_PARSE_ERROR"]}return ct&&J.info("[Replay] Skipping network body because of body type",t),[void 0,"UNPARSEABLE_BODY_TYPE"]}function zp(t,e){if(!t)return{headers:{},size:void 0,_meta:{warnings:[e]}};const n={...t._meta},r=n.warnings||[];return n.warnings=[...r,e],t._meta=n,t}function px(t,e){if(!e)return null;const{startTimestamp:n,endTimestamp:r,url:i,method:s,statusCode:o,request:a,response:c}=e;return{type:t,start:n/1e3,end:r/1e3,name:i,data:us({method:s,statusCode:o,request:a,response:c})}}function Zd(t){return{headers:{},size:t,_meta:{warnings:["URL_SKIPPED"]}}}function ia(t,e,n){if(!e&&Object.keys(t).length===0)return;if(!e)return{headers:t};if(!n)return{headers:t,size:e};const r={headers:t,size:e},{body:i,warnings:s}=_J(n);return r.body=i,s&&s.length>0&&(r._meta={warnings:s}),r}function Y0(t,e){return Object.keys(t).reduce((n,r)=>{const i=r.toLowerCase();return e.includes(i)&&t[r]&&(n[i]=t[r]),n},{})}function mx(t){return new URLSearchParams(t).toString()}function _J(t){if(!t||typeof t!="string")return{body:t};const e=t.length>vk,n=RJ(t);if(e){const r=t.slice(0,vk);return n?{body:r,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${r}`,warnings:["TEXT_TRUNCATED"]}}if(n)try{return{body:JSON.parse(t)}}catch{}return{body:t}}function RJ(t){const e=t[0],n=t[t.length-1];return e==="["&&n==="]"||e==="{"&&n==="}"}function Xp(t,e){const n=NJ(t);return ou(n,e)}function NJ(t,e=ht.document.baseURI){if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith(ht.location.origin))return t;const n=new URL(t,e);if(n.origin!==new URL(e).origin)return t;const r=n.href;return!t.endsWith("/")&&r.endsWith("/")?r.slice(0,-1):r}async function PJ(t,e,n){try{const r=await xJ(t,e,n),i=px("resource.fetch",r);Xm(n.replay,i)}catch(r){ct&&J.error("[Replay] Failed to capture fetch breadcrumb",r)}}function MJ(t,e,n){const{input:r,response:i}=e,s=r?gx(r):void 0,o=$m(s,n.textEncoder),a=i?fx(i.headers.get("content-length")):void 0;o!==void 0&&(t.data.request_body_size=o),a!==void 0&&(t.data.response_body_size=a)}async function xJ(t,e,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:s=r}=e,{url:o,method:a,status_code:c=0,request_body_size:l,response_body_size:u}=t.data,d=Xp(o,n.networkDetailAllowUrls)&&!Xp(o,n.networkDetailDenyUrls),f=d?DJ(n,e.input,l):Zd(l),h=await OJ(d,n,e.response,u);return{startTimestamp:i,endTimestamp:s,url:o,method:a,statusCode:c,request:f,response:h}}function DJ({networkCaptureBodies:t,networkRequestHeaders:e},n,r){const i=n?FJ(n,e):{};if(!t)return ia(i,r,void 0);const s=gx(n),[o,a]=hx(s),c=ia(i,r,o);return a?zp(c,a):c}async function OJ(t,{networkCaptureBodies:e,textEncoder:n,networkResponseHeaders:r},i,s){if(!t&&s!==void 0)return Zd(s);const o=i?vx(i.headers,r):{};if(!i||!e&&s!==void 0)return ia(o,s,void 0);const[a,c]=await BJ(i),l=LJ(a,{networkCaptureBodies:e,textEncoder:n,responseBodySize:s,captureDetails:t,headers:o});return c?zp(l,c):l}function LJ(t,{networkCaptureBodies:e,textEncoder:n,responseBodySize:r,captureDetails:i,headers:s}){try{const o=t&&t.length&&r===void 0?$m(t,n):r;return i?e?ia(s,o,t):ia(s,o,void 0):Zd(o)}catch(o){return ct&&J.warn("[Replay] Failed to serialize response body",o),ia(s,r,void 0)}}async function BJ(t){const e=UJ(t);if(!e)return[void 0,"BODY_PARSE_ERROR"];try{return[await GJ(e)]}catch(n){return ct&&J.warn("[Replay] Failed to get text body from response",n),[void 0,"BODY_PARSE_ERROR"]}}function gx(t=[]){if(!(t.length!==2||typeof t[1]!="object"))return t[1].body}function vx(t,e){const n={};return e.forEach(r=>{t.get(r)&&(n[r]=t.get(r))}),n}function FJ(t,e){return t.length===1&&typeof t[0]!="string"?Mk(t[0],e):t.length===2?Mk(t[1],e):{}}function Mk(t,e){if(!t)return{};const n=t.headers;return n?n instanceof Headers?vx(n,e):Array.isArray(n)?{}:Y0(n,e):{}}function UJ(t){try{return t.clone()}catch(e){ct&&J.warn("[Replay] Failed to clone response body",e)}}function GJ(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error("Timeout while trying to read response body")),500);VJ(t).then(i=>e(i),i=>n(i)).finally(()=>clearTimeout(r))})}async function VJ(t){return await t.text()}async function WJ(t,e,n){try{const r=ZJ(t,e,n),i=px("resource.xhr",r);Xm(n.replay,i)}catch(r){ct&&J.error("[Replay] Failed to capture xhr breadcrumb",r)}}function HJ(t,e,n){const{xhr:r,input:i}=e;if(!r)return;const s=$m(i,n.textEncoder),o=r.getResponseHeader("content-length")?fx(r.getResponseHeader("content-length")):$J(r.response,r.responseType,n.textEncoder);s!==void 0&&(t.data.request_body_size=s),o!==void 0&&(t.data.response_body_size=o)}function ZJ(t,e,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:s=r,input:o,xhr:a}=e,{url:c,method:l,status_code:u=0,request_body_size:d,response_body_size:f}=t.data;if(!c)return null;if(!a||!Xp(c,n.networkDetailAllowUrls)||Xp(c,n.networkDetailDenyUrls)){const b=Zd(d),k=Zd(f);return{startTimestamp:i,endTimestamp:s,url:c,method:l,statusCode:u,request:b,response:k}}const h=a[jo],p=h?Y0(h.request_headers,n.networkRequestHeaders):{},g=Y0(jJ(a),n.networkResponseHeaders),[y,m]=n.networkCaptureBodies?hx(o):[void 0],[v,S]=n.networkCaptureBodies?zJ(a):[void 0],E=ia(p,d,y),A=ia(g,f,v);return{startTimestamp:i,endTimestamp:s,url:c,method:l,statusCode:u,request:m?zp(E,m):E,response:S?zp(A,S):A}}function jJ(t){const e=t.getAllResponseHeaders();return e?e.split(`\r
`).reduce((n,r)=>{const[i,s]=r.split(": ");return n[i.toLowerCase()]=s,n},{}):{}}function zJ(t){const e=[];try{return[t.responseText]}catch(n){e.push(n)}try{return XJ(t.response,t.responseType)}catch(n){e.push(n)}return ct&&J.warn("[Replay] Failed to get xhr response body",...e),[void 0]}function XJ(t,e){try{if(typeof t=="string")return[t];if(t instanceof Document)return[t.body.outerHTML];if(e==="json"&&t&&typeof t=="object")return[JSON.stringify(t)];if(!t)return[void 0]}catch{return ct&&J.warn("[Replay] Failed to serialize body",t),[void 0,"BODY_PARSE_ERROR"]}return ct&&J.info("[Replay] Skipping network body because of body type",t),[void 0,"UNPARSEABLE_BODY_TYPE"]}function $J(t,e,n){try{const r=e==="json"&&t&&typeof t=="object"?JSON.stringify(t):t;return $m(r,n)}catch{return}}function KJ(t){const e=Mt();try{const n=new TextEncoder,{networkDetailAllowUrls:r,networkDetailDenyUrls:i,networkCaptureBodies:s,networkRequestHeaders:o,networkResponseHeaders:a}=t.getOptions(),c={replay:t,textEncoder:n,networkDetailAllowUrls:r,networkDetailDenyUrls:i,networkCaptureBodies:s,networkRequestHeaders:o,networkResponseHeaders:a};e&&e.on?e.on("beforeAddBreadcrumb",(l,u)=>JJ(c,l,u)):(ZI(kJ(t)),jI(TJ(t)))}catch{}}function JJ(t,e,n){if(e.data)try{YJ(e)&&QJ(n)&&(HJ(e,n,t),WJ(e,n,t)),qJ(e)&&eY(n)&&(MJ(e,n,t),PJ(e,n,t))}catch{ct&&J.warn("Error when enriching network breadcrumb")}}function YJ(t){return t.category==="xhr"}function qJ(t){return t.category==="fetch"}function QJ(t){return t&&t.xhr}function eY(t){return t&&t.response}let xk=null;function tY(t){return!!t.category}const nY=t=>e=>{if(!t.isEnabled())return;const n=rY(e);n&&Sf(t,n)};function rY(t){const e=t.getLastBreadcrumb&&t.getLastBreadcrumb();return xk===e||!e||(xk=e,!tY(e)||["fetch","xhr","sentry.event","sentry.transaction"].includes(e.category)||e.category.startsWith("ui."))?null:e.category==="console"?iY(e):os(e)}function iY(t){const e=t.data&&t.data.arguments;if(!Array.isArray(e)||e.length===0)return os(t);let n=!1;const r=e.map(i=>{if(!i)return i;if(typeof i=="string")return i.length>ih?(n=!0,`${i.slice(0,ih)}`):i;if(typeof i=="object")try{const s=Fi(i,7);return JSON.stringify(s).length>ih?(n=!0,`${JSON.stringify(s,null,2).slice(0,ih)}`):s}catch{}return i});return os({...t,data:{...t.data,arguments:r,...n?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}function sY(t){const e=Cf(),n=Mt();e.addScopeListener(nY(t)),FP(LK(t)),Lm(bJ(t)),KJ(t);const r=IJ(t,!Dk(n));n&&n.addEventProcessor?n.addEventProcessor(r):Mz(r),Dk(n)&&(n.on("beforeSendEvent",mJ(t)),n.on("afterSendEvent",dx(t)),n.on("createDsc",i=>{const s=t.getSessionId();s&&t.isEnabled()&&t.recordingMode==="session"&&t.checkAndHandleExpiredSession()&&(i.replay_id=s)}),n.on("startTransaction",i=>{t.lastTransaction=i}),n.on("finishTransaction",i=>{t.lastTransaction=i}),n.on("beforeSendFeedback",(i,s)=>{const o=t.getSessionId();s&&s.includeReplay&&t.isEnabled()&&o&&(t.flush(),i.contexts&&i.contexts.feedback&&(i.contexts.feedback.replay_id=o))}))}function Dk(t){return!!(t&&t.on)}async function oY(t){try{return Promise.all(zm(t,[aY(ht.performance.memory)]))}catch{return[]}}function aY(t){const{jsHeapSizeLimit:e,totalJSHeapSize:n,usedJSHeapSize:r}=t,i=Date.now()/1e3;return{type:"memory",name:"memory",start:i,end:i,data:{memory:{jsHeapSizeLimit:e,totalJSHeapSize:n,usedJSHeapSize:r}}}}function cY(t,e,n){let r,i,s;const o=n&&n.maxWait?Math.max(n.maxWait,e):0;function a(){return c(),r=t(),r}function c(){i!==void 0&&clearTimeout(i),s!==void 0&&clearTimeout(s),i=s=void 0}function l(){return i!==void 0||s!==void 0?a():r}function u(){return i&&clearTimeout(i),i=setTimeout(a,e),o&&s===void 0&&(s=setTimeout(a,o)),r}return u.cancel=c,u.flush=l,u}function lY(t){let e=!1;return(n,r)=>{if(!t.checkAndHandleExpiredSession()){ct&&J.warn("[Replay] Received replay event after session expired.");return}const i=r||!e;e=!0,t.clickDetector&&PK(t.clickDetector,n),t.addUpdate(()=>{if(t.recordingMode==="buffer"&&i&&t.setInitialState(),!yS(t,n,i))return!0;if(!i)return!1;if(dY(t,i),t.session&&t.session.previousSessionId)return!0;if(t.recordingMode==="buffer"&&t.session&&t.eventBuffer){const s=t.eventBuffer.getEarliestTimestamp();s&&($n(`[Replay] Updating session start time to earliest event in buffer to ${new Date(s)}`,t.getOptions()._experiments.traceInternals),t.session.started=s,t.getOptions().stickySession&&vS(t.session))}return t.recordingMode==="session"&&t.flush(),!0})}}function uY(t){const e=t.getOptions();return{type:Be.Custom,timestamp:Date.now(),data:{tag:"options",payload:{sessionSampleRate:e.sessionSampleRate,errorSampleRate:e.errorSampleRate,useCompressionOption:e.useCompression,blockAllMedia:e.blockAllMedia,maskAllText:e.maskAllText,maskAllInputs:e.maskAllInputs,useCompression:t.eventBuffer?t.eventBuffer.type==="worker":!1,networkDetailHasUrls:e.networkDetailAllowUrls.length>0,networkCaptureBodies:e.networkCaptureBodies,networkRequestHasHeaders:e.networkRequestHeaders.length>0,networkResponseHasHeaders:e.networkResponseHeaders.length>0}}}}function dY(t,e){!e||!t.session||t.session.segmentId!==0||yS(t,uY(t),!1)}function fY(t,e,n,r){return pc(zP(t,$I(t),r,n),[[{type:"replay_event"},t],[{type:"replay_recording",length:typeof e=="string"?new TextEncoder().encode(e).length:e.length},e]])}function hY({recordingData:t,headers:e}){let n;const r=`${JSON.stringify(e)}
`;if(typeof t=="string")n=`${r}${t}`;else{const s=new TextEncoder().encode(r);n=new Uint8Array(s.length+t.length),n.set(s),n.set(t,s.length)}return n}async function pY({client:t,scope:e,replayId:n,event:r}){const i=typeof t._integrations=="object"&&t._integrations!==null&&!Array.isArray(t._integrations)?Object.keys(t._integrations):void 0,s={event_id:n,integrations:i};t.emit&&t.emit("preprocessEvent",r,s);const o=await nM(t.getOptions(),r,s,e,t,qP());if(!o)return null;o.platform=o.platform||"javascript";const a=t.getSdkMetadata&&t.getSdkMetadata(),{name:c,version:l}=a&&a.sdk||{};return o.sdk={...o.sdk,name:c||"sentry.javascript.unknown",version:l||"0.0.0"},o}async function mY({recordingData:t,replayId:e,segmentId:n,eventContext:r,timestamp:i,session:s}){const o=hY({recordingData:t,headers:{segment_id:n}}),{urls:a,errorIds:c,traceIds:l,initialTimestamp:u}=r,d=Mt(),f=Cf(),h=d&&d.getTransport(),p=d&&d.getDsn();if(!d||!h||!p||!s.sampled)return;const g={type:t$,replay_start_timestamp:u/1e3,timestamp:i/1e3,error_ids:c,trace_ids:l,urls:a,replay_id:e,segment_id:n,replay_type:s.sampled},y=await pY({scope:f,client:d,replayId:e,event:g});if(!y){d.recordDroppedEvent("event_processor","replay",g),$n("An event processor returned `null`, will not send event.");return}delete y.sdkProcessingMetadata;const m=fY(y,o,p,d.getOptions().tunnel);let v;try{v=await h.send(m)}catch(E){const A=new Error(cS);try{A.cause=E}catch{}throw A}if(!v)return v;if(typeof v.statusCode=="number"&&(v.statusCode<200||v.statusCode>=300))throw new yx(v.statusCode);const S=$P({},v);if(XP(S,"replay"))throw new Cx(S);return v}class yx extends Error{constructor(e){super(`Transport returned status code ${e}`)}}class Cx extends Error{constructor(e){super("Rate limit hit"),this.rateLimits=e}}async function Ix(t,e={count:0,interval:a$}){const{recordingData:n,options:r}=t;if(n.length)try{return await mY(t),!0}catch(i){if(i instanceof yx||i instanceof Cx)throw i;if(lz("Replays",{_retryCount:e.count}),ct&&r._experiments&&r._experiments.captureExceptions&&Um(i),e.count>=c$){const s=new Error(`${cS} - max retries exceeded`);try{s.cause=i}catch{}throw s}return e.interval*=++e.count,new Promise((s,o)=>{setTimeout(async()=>{try{await Ix(t,e),s(!0)}catch(a){o(a)}},e.interval)})}}const Sx="__THROTTLED",gY="__SKIPPED";function vY(t,e,n){const r=new Map,i=a=>{const c=a-n;r.forEach((l,u)=>{u<c&&r.delete(u)})},s=()=>[...r.values()].reduce((a,c)=>a+c,0);let o=!1;return(...a)=>{const c=Math.floor(Date.now()/1e3);if(i(c),s()>=e){const u=o;return o=!0,u?gY:Sx}o=!1;const l=r.get(c)||0;return r.set(c,l+1),t(...a)}}class Mo{constructor({options:e,recordingOptions:n}){Mo.prototype.__init.call(this),Mo.prototype.__init2.call(this),Mo.prototype.__init3.call(this),Mo.prototype.__init4.call(this),Mo.prototype.__init5.call(this),Mo.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:n$,sessionIdleExpire:r$},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=n,this._options=e,this._debouncedFlush=cY(()=>this._flush(),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=vY((o,a)=>lJ(this,o,a),300,5);const{slowClickTimeout:r,slowClickIgnoreSelectors:i}=this.getOptions(),s=r?{threshold:Math.min(l$,r),timeout:r,scrollTimeout:u$,ignoreSelector:i?i.join(","):""}:void 0;s&&(this.clickDetector=new TK(this,s))}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}getOptions(){return this._options}initializeSampling(e){const{errorSampleRate:n,sessionSampleRate:r}=this._options;if(!(n<=0&&r<=0)){if(this._initializeSessionForSampling(e),!this.session){this._handleException(new Error("Unable to initialize and create session"));return}this.session.sampled!==!1&&(this.recordingMode=this.session.sampled==="buffer"&&this.session.segmentId===0?"buffer":"session",ml(`[Replay] Starting replay in ${this.recordingMode} mode`,this._options._experiments.traceInternals),this._initializeRecording())}}start(){if(this._isEnabled&&this.recordingMode==="session")throw new Error("Replay recording is already in progress");if(this._isEnabled&&this.recordingMode==="buffer")throw new Error("Replay buffering is in progress, call `flush()` to save the replay");ml("[Replay] Starting replay in session mode",this._options._experiments.traceInternals);const e=vv({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=e,this._initializeRecording()}startBuffering(){if(this._isEnabled)throw new Error("Replay recording is already in progress");ml("[Replay] Starting replay in buffer mode",this._options._experiments.traceInternals);const e=vv({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=e,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{const e=this._options._experiments.canvas;this._stopRecording=ra({...this._recordingOptions,...this.recordingMode==="buffer"&&{checkoutEveryNms:o$},emit:lY(this),onMutation:this._onMutationHandler,...e&&e.manager&&{recordCanvas:!0,getCanvasManager:e.manager,...Ck[e.quality||"medium"]||Ck.medium}})}catch(e){this._handleException(e)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(e){return this._handleException(e),!1}}async stop({forceFlush:e=!1,reason:n}={}){if(this._isEnabled){this._isEnabled=!1;try{$n(`[Replay] Stopping Replay${n?` triggered by ${n}`:""}`,this._options._experiments.traceInternals),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),e&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,iJ(this)}catch(r){this._handleException(r)}}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),$n("[Replay] Pausing replay",this._options._experiments.traceInternals))}resume(){!this._isPaused||!this._checkSession()||(this._isPaused=!1,this.startRecording(),$n("[Replay] Resuming replay",this._options._experiments.traceInternals))}async sendBufferedReplayOrFlush({continueRecording:e=!0}={}){if(this.recordingMode==="session")return this.flushImmediate();const n=Date.now();$n("[Replay] Converting buffer to session",this._options._experiments.traceInternals),await this.flushImmediate();const r=this.stopRecording();!e||!r||this.recordingMode!=="session"&&(this.recordingMode="session",this.session&&(this._updateUserActivity(n),this._updateSessionActivity(n),this._maybeSaveSession()),this.startRecording())}addUpdate(e){const n=e();this.recordingMode!=="buffer"&&n!==!0&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),!this._stopRecording){if(!this._checkSession())return;this.resume();return}this.checkAndHandleExpiredSession(),this._updateSessionActivity()}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return this.recordingMode==="buffer"?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){if(this._lastActivity&&K0(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&this.session.sampled==="session"){this.pause();return}return!!this._checkSession()}setInitialState(){const e=`${ht.location.pathname}${ht.location.hash}${ht.location.search}`,n=`${ht.location.origin}${e}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=n,this._context.initialTimestamp=Date.now(),this._context.urls.push(n)}throttledAddEvent(e,n){const r=this._throttledAddEvent(e,n);if(r===Sx){const i=os({category:"replay.throttled"});this.addUpdate(()=>!yS(this,{type:SK,timestamp:i.timestamp||0,data:{tag:"breadcrumb",payload:i,metric:!0}}))}return r}getCurrentRoute(){const e=this.lastTransaction||Cf().getTransaction();if(!(!e||!["route","custom"].includes(e.metadata.source)))return e.name}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=tJ({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_handleException(e){ct&&J.error("[Replay]",e),ct&&this._options._experiments&&this._options._experiments.captureExceptions&&Um(e)}_initializeSessionForSampling(e){const n=this._options.errorSampleRate>0,r=vv({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals,previousSessionId:e},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:n});this.session=r}_checkSession(){if(!this.session)return!1;const e=this.session;return cx(e,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})?(this._refreshSession(e),!1):!0}async _refreshSession(e){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(e.id))}_addListeners(){try{ht.document.addEventListener("visibilitychange",this._handleVisibilityChange),ht.addEventListener("blur",this._handleWindowBlur),ht.addEventListener("focus",this._handleWindowFocus),ht.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(sY(this),this._hasInitializedCoreListeners=!0)}catch(e){this._handleException(e)}this._performanceCleanupCallback=KK(this)}_removeListeners(){try{ht.document.removeEventListener("visibilitychange",this._handleVisibilityChange),ht.removeEventListener("blur",this._handleWindowBlur),ht.removeEventListener("focus",this._handleWindowFocus),ht.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(e){this._handleException(e)}}__init(){this._handleVisibilityChange=()=>{ht.document.visibilityState==="visible"?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const e=os({category:"ui.blur"});this._doChangeToBackgroundTasks(e)}}__init3(){this._handleWindowFocus=()=>{const e=os({category:"ui.focus"});this._doChangeToForegroundTasks(e)}}__init4(){this._handleKeyboardEvent=e=>{GK(this,e)}}_doChangeToBackgroundTasks(e){!this.session||ax(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(e&&this._createCustomBreadcrumb(e),this.conditionalFlush())}_doChangeToForegroundTasks(e){if(!this.session)return;if(!this.checkAndHandleExpiredSession()){$n("[Replay] Document has become active, but session has expired");return}e&&this._createCustomBreadcrumb(e)}_updateUserActivity(e=Date.now()){this._lastActivity=e}_updateSessionActivity(e=Date.now()){this.session&&(this.session.lastActivity=e,this._maybeSaveSession())}_createCustomBreadcrumb(e){this.addUpdate(()=>{this.throttledAddEvent({type:Be.Custom,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e}})})}_addPerformanceEntries(){const e=HK(this.performanceEntries).concat(this.replayPerformanceEntries);return this.performanceEntries=[],this.replayPerformanceEntries=[],Promise.all(zm(this,e))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:e,eventBuffer:n}=this;if(!e||!n||e.segmentId)return;const r=n.getEarliestTimestamp();r&&r<this._context.initialTimestamp&&(this._context.initialTimestamp=r)}_popEventContext(){const e={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),e}async _runFlush(){const e=this.getSessionId();if(!this.session||!this.eventBuffer||!e){ct&&J.error("[Replay] No session or eventBuffer found to flush.");return}if(await this._addPerformanceEntries(),!(!this.eventBuffer||!this.eventBuffer.hasEvents)&&(await oY(this),!!this.eventBuffer&&e===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const n=Date.now();if(n-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const r=this._popEventContext(),i=this.session.segmentId++;this._maybeSaveSession();const s=await this.eventBuffer.finish();await Ix({replayId:e,recordingData:s,segmentId:i,eventContext:r,session:this.session,options:this.getOptions(),timestamp:n})}catch(n){this._handleException(n),this.stop({reason:"sendReplay"});const r=Mt();r&&r.recordDroppedEvent("send_error","replay")}}__init5(){this._flush=async({force:e=!1}={})=>{if(!this._isEnabled&&!e)return;if(!this.checkAndHandleExpiredSession()){ct&&J.error("[Replay] Attempting to finish replay event after session expired.");return}if(!this.session)return;const n=this.session.started,i=Date.now()-n;this._debouncedFlush.cancel();const s=i<this._options.minReplayDuration,o=i>this._options.maxReplayDuration+5e3;if(s||o){$n(`[Replay] Session duration (${Math.floor(i/1e3)}s) is too ${s?"short":"long"}, not sending replay.`,this._options._experiments.traceInternals),s&&this._debouncedFlush();return}const a=this.eventBuffer;if(a&&this.session.segmentId===0&&!a.hasCheckout&&$n("[Replay] Flushing initial segment without checkout.",this._options._experiments.traceInternals),!this._flushLock){this._flushLock=this._runFlush(),await this._flushLock,this._flushLock=void 0;return}try{await this._flushLock}catch(c){ct&&J.error(c)}finally{this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&vS(this.session)}__init6(){this._onMutationHandler=e=>{const n=e.length,r=this._options.mutationLimit,i=this._options.mutationBreadcrumbLimit,s=r&&n>r;if(n>i||s){const o=os({category:"replay.mutations",data:{count:n,limit:s}});this._createCustomBreadcrumb(o)}return s?(this.stop({reason:"mutationLimit",forceFlush:this.recordingMode==="session"}),!1):!0}}}function Nu(t,e,n,r){const i=typeof r=="string"?r.split(","):[],s=[...t,...i,...e];return typeof n<"u"&&(typeof n=="string"&&s.push(`.${n}`),rc(()=>{console.warn("[Replay] You are using a deprecated configuration item for privacy. Read the documentation on how to use the new privacy configuration.")})),s.join(",")}function yY({mask:t,unmask:e,block:n,unblock:r,ignore:i,blockClass:s,blockSelector:o,maskTextClass:a,maskTextSelector:c,ignoreClass:l}){const u=['base[href="/"]'],d=Nu(t,[".sentry-mask","[data-sentry-mask]"],a,c),f=Nu(e,[".sentry-unmask","[data-sentry-unmask]"]),h={maskTextSelector:d,unmaskTextSelector:f,blockSelector:Nu(n,[".sentry-block","[data-sentry-block]",...u],s,o),unblockSelector:Nu(r,[".sentry-unblock","[data-sentry-unblock]"]),ignoreSelector:Nu(i,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'],l)};return s instanceof RegExp&&(h.blockClass=s),a instanceof RegExp&&(h.maskTextClass=a),h}function CY({el:t,key:e,maskAttributes:n,maskAllText:r,privacyOptions:i,value:s}){return!r||i.unmaskTextSelector&&t.matches(i.unmaskTextSelector)?s:n.includes(e)||e==="value"&&t.tagName==="INPUT"&&["submit","button"].includes(t.getAttribute("type")||"")?s.replace(/[\S]/g,"*"):s}const Ok='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',IY=["content-length","content-type","accept"];let Lk=!1;class Km{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:e=i$,flushMaxDelay:n=s$,minReplayDuration:r=d$,maxReplayDuration:i=yk,stickySession:s=!0,useCompression:o=!0,workerUrl:a,_experiments:c={},sessionSampleRate:l,errorSampleRate:u,maskAllText:d=!0,maskAllInputs:f=!0,blockAllMedia:h=!0,mutationBreadcrumbLimit:p=750,mutationLimit:g=1e4,slowClickTimeout:y=7e3,slowClickIgnoreSelectors:m=[],networkDetailAllowUrls:v=[],networkDetailDenyUrls:S=[],networkCaptureBodies:E=!0,networkRequestHeaders:A=[],networkResponseHeaders:b=[],mask:k=[],maskAttributes:_=["title","placeholder"],unmask:N=[],block:M=[],unblock:D=[],ignore:B=[],maskFn:G,beforeAddRecordingEvent:V,beforeErrorSampling:z,blockClass:X,blockSelector:te,maskInputOptions:H,maskTextClass:K,maskTextSelector:ie,ignoreClass:$}={}){this.name=Km.id;const se=yY({mask:k,unmask:N,block:M,unblock:D,ignore:B,blockClass:X,blockSelector:te,maskTextClass:K,maskTextSelector:ie,ignoreClass:$});if(this._recordingOptions={maskAllInputs:f,maskAllText:d,maskInputOptions:{...H||{},password:!0},maskTextFn:G,maskInputFn:G,maskAttributeFn:(be,we,me)=>CY({maskAttributes:_,maskAllText:d,privacyOptions:se,key:be,value:we,el:me}),...se,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:be=>{try{be.__rrweb__=!0}catch{}}},this._initialOptions={flushMinDelay:e,flushMaxDelay:n,minReplayDuration:Math.min(r,f$),maxReplayDuration:Math.min(i,yk),stickySession:s,sessionSampleRate:l,errorSampleRate:u,useCompression:o,workerUrl:a,blockAllMedia:h,maskAllInputs:f,maskAllText:d,mutationBreadcrumbLimit:p,mutationLimit:g,slowClickTimeout:y,slowClickIgnoreSelectors:m,networkDetailAllowUrls:v,networkDetailDenyUrls:S,networkCaptureBodies:E,networkRequestHeaders:Bk(A),networkResponseHeaders:Bk(b),beforeAddRecordingEvent:V,beforeErrorSampling:z,_experiments:c},typeof l=="number"&&(console.warn(`[Replay] You are passing \`sessionSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysSessionSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysSessionSampleRate: ${l} })`),this._initialOptions.sessionSampleRate=l),typeof u=="number"&&(console.warn(`[Replay] You are passing \`errorSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysOnErrorSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysOnErrorSampleRate: ${u} })`),this._initialOptions.errorSampleRate=u),this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${Ok}`:Ok),this._isInitialized&&ZA())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return Lk}set _isInitialized(e){Lk=e}setupOnce(){ZA()&&(this._setup(),setTimeout(()=>this._initialize()))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:this._replay.recordingMode==="session"}):Promise.resolve()}flush(e){return!this._replay||!this._replay.isEnabled()?Promise.resolve():this._replay.sendBufferedReplayOrFlush(e)}getReplayId(){if(!(!this._replay||!this._replay.isEnabled()))return this._replay.getSessionId()}_initialize(){this._replay&&this._replay.initializeSampling()}_setup(){const e=SY(this._initialOptions);this._replay=new Mo({options:e,recordingOptions:this._recordingOptions})}}Km.__initStatic();function SY(t){const e=Mt(),n=e&&e.getOptions(),r={sessionSampleRate:0,errorSampleRate:0,...us(t)};return n?(t.sessionSampleRate==null&&t.errorSampleRate==null&&n.replaysSessionSampleRate==null&&n.replaysOnErrorSampleRate==null&&rc(()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}),typeof n.replaysSessionSampleRate=="number"&&(r.sessionSampleRate=n.replaysSessionSampleRate),typeof n.replaysOnErrorSampleRate=="number"&&(r.errorSampleRate=n.replaysOnErrorSampleRate),r):(rc(()=>{console.warn("SDK client is not available.")}),r)}function Bk(t){return[...IY,...t.map(e=>e.toLowerCase())]}function bY(t){const e={_metadata:{},...t};e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.react",packages:[{name:"npm:@sentry/react",version:Gd}],version:Gd},hX(e)}var bx={exports:{}},tt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yn=typeof Symbol=="function"&&Symbol.for,IS=yn?Symbol.for("react.element"):60103,SS=yn?Symbol.for("react.portal"):60106,Jm=yn?Symbol.for("react.fragment"):60107,Ym=yn?Symbol.for("react.strict_mode"):60108,qm=yn?Symbol.for("react.profiler"):60114,Qm=yn?Symbol.for("react.provider"):60109,eg=yn?Symbol.for("react.context"):60110,bS=yn?Symbol.for("react.async_mode"):60111,tg=yn?Symbol.for("react.concurrent_mode"):60111,ng=yn?Symbol.for("react.forward_ref"):60112,rg=yn?Symbol.for("react.suspense"):60113,wY=yn?Symbol.for("react.suspense_list"):60120,ig=yn?Symbol.for("react.memo"):60115,sg=yn?Symbol.for("react.lazy"):60116,AY=yn?Symbol.for("react.block"):60121,kY=yn?Symbol.for("react.fundamental"):60117,EY=yn?Symbol.for("react.responder"):60118,TY=yn?Symbol.for("react.scope"):60119;function xr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case IS:switch(t=t.type,t){case bS:case tg:case Jm:case qm:case Ym:case rg:return t;default:switch(t=t&&t.$$typeof,t){case eg:case ng:case sg:case ig:case Qm:return t;default:return e}}case SS:return e}}}function wx(t){return xr(t)===tg}tt.AsyncMode=bS;tt.ConcurrentMode=tg;tt.ContextConsumer=eg;tt.ContextProvider=Qm;tt.Element=IS;tt.ForwardRef=ng;tt.Fragment=Jm;tt.Lazy=sg;tt.Memo=ig;tt.Portal=SS;tt.Profiler=qm;tt.StrictMode=Ym;tt.Suspense=rg;tt.isAsyncMode=function(t){return wx(t)||xr(t)===bS};tt.isConcurrentMode=wx;tt.isContextConsumer=function(t){return xr(t)===eg};tt.isContextProvider=function(t){return xr(t)===Qm};tt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===IS};tt.isForwardRef=function(t){return xr(t)===ng};tt.isFragment=function(t){return xr(t)===Jm};tt.isLazy=function(t){return xr(t)===sg};tt.isMemo=function(t){return xr(t)===ig};tt.isPortal=function(t){return xr(t)===SS};tt.isProfiler=function(t){return xr(t)===qm};tt.isStrictMode=function(t){return xr(t)===Ym};tt.isSuspense=function(t){return xr(t)===rg};tt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Jm||t===tg||t===qm||t===Ym||t===rg||t===wY||typeof t=="object"&&t!==null&&(t.$$typeof===sg||t.$$typeof===ig||t.$$typeof===Qm||t.$$typeof===eg||t.$$typeof===ng||t.$$typeof===kY||t.$$typeof===EY||t.$$typeof===TY||t.$$typeof===AY)};tt.typeOf=xr;bx.exports=tt;var _Y=bx.exports,Ax=_Y,RY={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},NY={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},kx={};kx[Ax.ForwardRef]=RY;kx[Ax.Memo]=NY;const PY=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function MY(t){const e=t.match(/^([^.]+)/);return e!==null&&parseInt(e[0])>=17}const Fk={componentStack:null,error:null,eventId:null};function xY(t,e){const n=new WeakMap;function r(i,s){if(!n.has(i)){if(i.cause)return n.set(i,!0),r(i.cause,s);i.cause=s}}r(t,e)}class wS extends w.Component{constructor(e){super(e),wS.prototype.__init.call(this),this.state=Fk,this._openFallbackReportDialog=!0;const n=Mt();n&&n.on&&e.showDialog&&(this._openFallbackReportDialog=!1,n.on("afterSendEvent",r=>{!r.type&&r.event_id===this._lastEventId&&uk({...e.dialogOptions,eventId:this._lastEventId})}))}componentDidCatch(e,{componentStack:n}){const{beforeCapture:r,onError:i,showDialog:s,dialogOptions:o}=this.props;iM(a=>{if(MY(w.version)&&UI(e)){const l=new Error(e.message);l.name=`React ErrorBoundary ${e.name}`,l.stack=n,xY(e,l)}r&&r(a,e,n);const c=Um(e,{captureContext:{contexts:{react:{componentStack:n}}},mechanism:{handled:!1}});i&&i(e,n,c),s&&(this._lastEventId=c,this._openFallbackReportDialog&&uk({...o,eventId:c})),this.setState({error:e,componentStack:n,eventId:c})})}componentDidMount(){const{onMount:e}=this.props;e&&e()}componentWillUnmount(){const{error:e,componentStack:n,eventId:r}=this.state,{onUnmount:i}=this.props;i&&i(e,n,r)}__init(){this.resetErrorBoundary=()=>{const{onReset:e}=this.props,{error:n,componentStack:r,eventId:i}=this.state;e&&e(n,r,i),this.setState(Fk)}}render(){const{fallback:e,children:n}=this.props,r=this.state;if(r.error){let i;return typeof e=="function"?i=e({error:r.error,componentStack:r.componentStack,resetError:this.resetErrorBoundary,eventId:r.eventId}):i=e,w.isValidElement(i)?i:(e&&PY&&J.warn("fallback did not produce a valid ReactElement"),null)}return typeof n=="function"?n():n}}function DY(){const[t,e]=w.useState(null),[n,r]=w.useState(!1),[i,s]=w.useState([]),o=St.useRef(null),a=St.useRef(null),c=w.useRef(!1),l=()=>{o.current&&o.current.saveLog()},u=()=>{o.current&&o.current.clearLog()},d=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return w.useEffect(()=>{if(c.current)return;const f=new k4("mongoose.moo.mud.org",8765);f.registerGMCPPackage(d4),f.registerGMCPPackage(a4),f.registerGMCPPackage(c4),f.registerGMCPPackage(f4),f.registerGMCPPackage(l4),f.registerGMCPPackage(u4),f.registerGMCPPackage(t2),f.registerGMCPPackage(r2),f.registerMcpPackage(g4),f.registerMcpPackage(v4),f.registerMcpPackage(C4),f.registerMcpPackage(I4),f.connect(),f.requestNotificationPermission(),e(f),r(!d),window.mudClient=f,c.current=!0;const h=p=>{f&&(p.key==="Control"&&f.cancelSpeech(),p.key==="Escape"&&f.stopAllSounds())};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[d]),w.useEffect(()=>{if(t){const f=p=>{s(p)},h=()=>{s([])};return t.on("userlist",f),t.on("disconnect",h),()=>{t.off("userlist",f),t.off("disconnect",h)}}},[t]),wT(f=>{t&&t.shutdown()}),t?q.jsx(wS,{fallback:q.jsx("p",{children:"An error has occurred"}),children:q.jsxs("div",{className:"App",children:[q.jsx("header",{className:"App-header"}),q.jsx(sV,{client:t,onSaveLog:l,onClearLog:u,onToggleUsers:()=>r(!n),onOpenPrefs:()=>{var f;return(f=a.current)==null?void 0:f.open()}}),q.jsxs("div",{children:[q.jsx(HB,{client:t,ref:o}),n&&q.jsx(aV,{users:i}),q.jsx(CZ,{client:t})]}),q.jsx(T4,{onSend:f=>t.sendCommand(f)}),q.jsx(oV,{client:t}),q.jsx(JG,{ref:a})]})}):null}function OY(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Gk(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Uk(Object(n),!0).forEach(function(r){OY(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Uk(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function LY(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function BY(t,e){if(t==null)return{};var n=LY(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function FY(t,e){return UY(t)||GY(t,e)||VY(t,e)||WY()}function UY(t){if(Array.isArray(t))return t}function GY(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,s=void 0;try{for(var o=t[Symbol.iterator](),a;!(r=(a=o.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(c){i=!0,s=c}finally{try{!r&&o.return!=null&&o.return()}finally{if(i)throw s}}return n}}function VY(t,e){if(t){if(typeof t=="string")return Vk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vk(t,e)}}function Vk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function WY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HY(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Hk(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Wk(Object(n),!0).forEach(function(r){HY(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wk(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ZY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return e.reduceRight(function(i,s){return s(i)},r)}}function Vu(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=t.length?t.apply(this,i):function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function $p(t){return{}.toString.call(t).includes("Object")}function jY(t){return!Object.keys(t).length}function jd(t){return typeof t=="function"}function zY(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function XY(t,e){return $p(e)||sa("changeType"),Object.keys(e).some(function(n){return!zY(t,n)})&&sa("changeField"),e}function $Y(t){jd(t)||sa("selectorType")}function KY(t){jd(t)||$p(t)||sa("handlerType"),$p(t)&&Object.values(t).some(function(e){return!jd(e)})&&sa("handlersType")}function JY(t){t||sa("initialIsRequired"),$p(t)||sa("initialType"),jY(t)&&sa("initialContent")}function YY(t,e){throw new Error(t[e]||t.default)}var qY={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},sa=Vu(YY)(qY),ah={changes:XY,selector:$Y,handler:KY,initial:JY};function QY(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ah.initial(t),ah.handler(e);var n={current:t},r=Vu(nq)(n,e),i=Vu(tq)(n),s=Vu(ah.changes)(t),o=Vu(eq)(n);function a(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return ah.selector(l),l(n.current)}function c(l){ZY(r,i,s,o)(l)}return[a,c]}function eq(t,e){return jd(e)?e(t.current):e}function tq(t,e){return t.current=Hk(Hk({},t.current),e),e}function nq(t,e,n){return jd(e)?e(t.current):Object.keys(n).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,t.current[r])}),n}var rq={create:QY},iq={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function sq(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=t.length?t.apply(this,i):function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function oq(t){return{}.toString.call(t).includes("Object")}function aq(t){return t||Zk("configIsRequired"),oq(t)||Zk("configType"),t.urls?(cq(),{paths:{vs:t.urls.monacoBase}}):t}function cq(){console.warn(Ex.deprecation)}function lq(t,e){throw new Error(t[e]||t.default)}var Ex={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Zk=sq(lq)(Ex),uq={config:aq},dq=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(s,o){return o(s)},i)}};function Tx(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],Tx(t[n],e[n]))}),Gk(Gk({},t),e)}var fq={type:"cancelation",msg:"operation is manually canceled"};function yv(t){var e=!1,n=new Promise(function(r,i){t.then(function(s){return e?i(fq):r(s)}),t.catch(i)});return n.cancel=function(){return e=!0},n}var hq=rq.create({config:iq,isInitialized:!1,resolve:null,reject:null,monaco:null}),_x=FY(hq,2),bf=_x[0],og=_x[1];function pq(t){var e=uq.config(t),n=e.monaco,r=BY(e,["monaco"]);og(function(i){return{config:Tx(i.config,r),monaco:n}})}function mq(){var t=bf(function(e){var n=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!t.isInitialized){if(og({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),yv(Cv);if(window.monaco&&window.monaco.editor)return Rx(window.monaco),t.resolve(window.monaco),yv(Cv);dq(gq,yq)(Cq)}return yv(Cv)}function gq(t){return document.body.appendChild(t)}function vq(t){var e=document.createElement("script");return t&&(e.src=t),e}function yq(t){var e=bf(function(r){var i=r.config,s=r.reject;return{config:i,reject:s}}),n=vq("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function Cq(){var t=bf(function(n){var r=n.config,i=n.resolve,s=n.reject;return{config:r,resolve:i,reject:s}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){Rx(n),t.resolve(n)},function(n){t.reject(n)})}function Rx(t){bf().monaco||og({monaco:t})}function Iq(){return bf(function(t){var e=t.monaco;return e})}var Cv=new Promise(function(t,e){return og({resolve:t,reject:e})}),Nx={config:pq,init:mq,__getMonacoInstance:Iq},Sq={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Iv=Sq,bq={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},wq=bq;function Aq({children:t}){return St.createElement("div",{style:wq.container},t)}var kq=Aq,Eq=kq;function Tq({width:t,height:e,isEditorReady:n,loading:r,_ref:i,className:s,wrapperProps:o}){return St.createElement("section",{style:{...Iv.wrapper,width:t,height:e},...o},!n&&St.createElement(Eq,null,r),St.createElement("div",{ref:i,style:{...Iv.fullWidth,...!n&&Iv.hide},className:s}))}var _q=Tq,Px=w.memo(_q);function Rq(t){w.useEffect(t,[])}var Mx=Rq;function Nq(t,e,n=!0){let r=w.useRef(!0);w.useEffect(r.current||!n?()=>{r.current=!1}:t,e)}var wr=Nq;function ad(){}function Kc(t,e,n,r){return Pq(t,r)||Mq(t,e,n,r)}function Pq(t,e){return t.editor.getModel(xx(t,e))}function Mq(t,e,n,r){return t.editor.createModel(e,n,r?xx(t,r):void 0)}function xx(t,e){return t.Uri.parse(e)}function xq({original:t,modified:e,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:s,modifiedModelPath:o,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:c=!1,theme:l="light",loading:u="Loading...",options:d={},height:f="100%",width:h="100%",className:p,wrapperProps:g={},beforeMount:y=ad,onMount:m=ad}){let[v,S]=w.useState(!1),[E,A]=w.useState(!0),b=w.useRef(null),k=w.useRef(null),_=w.useRef(null),N=w.useRef(m),M=w.useRef(y),D=w.useRef(!1);Mx(()=>{let z=Nx.init();return z.then(X=>(k.current=X)&&A(!1)).catch(X=>(X==null?void 0:X.type)!=="cancelation"&&console.error("Monaco initialization: error:",X)),()=>b.current?V():z.cancel()}),wr(()=>{if(b.current&&k.current){let z=b.current.getOriginalEditor(),X=Kc(k.current,t||"",r||n||"text",s||"");X!==z.getModel()&&z.setModel(X)}},[s],v),wr(()=>{if(b.current&&k.current){let z=b.current.getModifiedEditor(),X=Kc(k.current,e||"",i||n||"text",o||"");X!==z.getModel()&&z.setModel(X)}},[o],v),wr(()=>{let z=b.current.getModifiedEditor();z.getOption(k.current.editor.EditorOption.readOnly)?z.setValue(e||""):e!==z.getValue()&&(z.executeEdits("",[{range:z.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),z.pushUndoStop())},[e],v),wr(()=>{var z,X;(X=(z=b.current)==null?void 0:z.getModel())==null||X.original.setValue(t||"")},[t],v),wr(()=>{let{original:z,modified:X}=b.current.getModel();k.current.editor.setModelLanguage(z,r||n||"text"),k.current.editor.setModelLanguage(X,i||n||"text")},[n,r,i],v),wr(()=>{var z;(z=k.current)==null||z.editor.setTheme(l)},[l],v),wr(()=>{var z;(z=b.current)==null||z.updateOptions(d)},[d],v);let B=w.useCallback(()=>{var te;if(!k.current)return;M.current(k.current);let z=Kc(k.current,t||"",r||n||"text",s||""),X=Kc(k.current,e||"",i||n||"text",o||"");(te=b.current)==null||te.setModel({original:z,modified:X})},[n,e,i,t,r,s,o]),G=w.useCallback(()=>{var z;!D.current&&_.current&&(b.current=k.current.editor.createDiffEditor(_.current,{automaticLayout:!0,...d}),B(),(z=k.current)==null||z.editor.setTheme(l),S(!0),D.current=!0)},[d,l,B]);w.useEffect(()=>{v&&N.current(b.current,k.current)},[v]),w.useEffect(()=>{!E&&!v&&G()},[E,v,G]);function V(){var X,te,H,K;let z=(X=b.current)==null?void 0:X.getModel();a||((te=z==null?void 0:z.original)==null||te.dispose()),c||((H=z==null?void 0:z.modified)==null||H.dispose()),(K=b.current)==null||K.dispose()}return St.createElement(Px,{width:h,height:f,isEditorReady:v,loading:u,_ref:_,className:p,wrapperProps:g})}var Dq=xq;w.memo(Dq);function Oq(t){let e=w.useRef();return w.useEffect(()=>{e.current=t},[t]),e.current}var Lq=Oq,ch=new Map;function Bq({defaultValue:t,defaultLanguage:e,defaultPath:n,value:r,language:i,path:s,theme:o="light",line:a,loading:c="Loading...",options:l={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:f=!1,width:h="100%",height:p="100%",className:g,wrapperProps:y={},beforeMount:m=ad,onMount:v=ad,onChange:S,onValidate:E=ad}){let[A,b]=w.useState(!1),[k,_]=w.useState(!0),N=w.useRef(null),M=w.useRef(null),D=w.useRef(null),B=w.useRef(v),G=w.useRef(m),V=w.useRef(),z=w.useRef(r),X=Lq(s),te=w.useRef(!1),H=w.useRef(!1);Mx(()=>{let $=Nx.init();return $.then(se=>(N.current=se)&&_(!1)).catch(se=>(se==null?void 0:se.type)!=="cancelation"&&console.error("Monaco initialization: error:",se)),()=>M.current?ie():$.cancel()}),wr(()=>{var se,be,we,me;let $=Kc(N.current,t||r||"",e||i||"",s||n||"");$!==((se=M.current)==null?void 0:se.getModel())&&(d&&ch.set(X,(be=M.current)==null?void 0:be.saveViewState()),(we=M.current)==null||we.setModel($),d&&((me=M.current)==null||me.restoreViewState(ch.get(s))))},[s],A),wr(()=>{var $;($=M.current)==null||$.updateOptions(l)},[l],A),wr(()=>{!M.current||r===void 0||(M.current.getOption(N.current.editor.EditorOption.readOnly)?M.current.setValue(r):r!==M.current.getValue()&&(H.current=!0,M.current.executeEdits("",[{range:M.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),M.current.pushUndoStop(),H.current=!1))},[r],A),wr(()=>{var se,be;let $=(se=M.current)==null?void 0:se.getModel();$&&i&&((be=N.current)==null||be.editor.setModelLanguage($,i))},[i],A),wr(()=>{var $;a!==void 0&&(($=M.current)==null||$.revealLine(a))},[a],A),wr(()=>{var $;($=N.current)==null||$.editor.setTheme(o)},[o],A);let K=w.useCallback(()=>{var $;if(!(!D.current||!N.current)&&!te.current){G.current(N.current);let se=s||n,be=Kc(N.current,r||t||"",e||i||"",se||"");M.current=($=N.current)==null?void 0:$.editor.create(D.current,{model:be,automaticLayout:!0,...l},u),d&&M.current.restoreViewState(ch.get(se)),N.current.editor.setTheme(o),a!==void 0&&M.current.revealLine(a),b(!0),te.current=!0}},[t,e,n,r,i,s,l,u,d,o,a]);w.useEffect(()=>{A&&B.current(M.current,N.current)},[A]),w.useEffect(()=>{!k&&!A&&K()},[k,A,K]),z.current=r,w.useEffect(()=>{var $,se;A&&S&&(($=V.current)==null||$.dispose(),V.current=(se=M.current)==null?void 0:se.onDidChangeModelContent(be=>{H.current||S(M.current.getValue(),be)}))},[A,S]),w.useEffect(()=>{if(A){let $=N.current.editor.onDidChangeMarkers(se=>{var we;let be=(we=M.current.getModel())==null?void 0:we.uri;if(be&&se.find(me=>me.path===be.path)){let me=N.current.editor.getModelMarkers({resource:be});E==null||E(me)}});return()=>{$==null||$.dispose()}}return()=>{}},[A,E]);function ie(){var $,se;($=V.current)==null||$.dispose(),f?d&&ch.set(s,M.current.saveViewState()):(se=M.current.getModel())==null||se.dispose(),M.current.dispose()}return St.createElement(Px,{width:h,height:p,isEditorReady:A,loading:c,_ref:D,className:g,wrapperProps:y})}var Fq=Bq,Uq=w.memo(Fq),Gq=Uq,Vq={restoreOnUnmount:!1};function Wq(t,e){e===void 0&&(e=Vq);var n=w.useRef(document.title);document.title!==t&&(document.title=t),w.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=n.current}},[])}const Hq=typeof document<"u"?Wq:function(t){};function Zq({onSave:t,onRevert:e,onDownload:n}){return q.jsx("div",{className:"toolbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderBottom:"1px solid #e8e8e8"},children:q.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[q.jsxs("button",{onClick:t,accessKey:"s",children:[q.jsx(oR,{}),"Save"]}),q.jsxs("button",{onClick:e,accessKey:"r",children:[q.jsx(nV,{}),"Revert"]}),q.jsxs("button",{onClick:n,accessKey:"d",children:[q.jsx(eV,{}),"Download"]})]})})}const jq=({docstate:t,session:e})=>q.jsxs("div",{"aria-live":"polite",className:"statusbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderTop:"1px solid #e8e8e8"},children:[q.jsx("span",{children:t}),q.jsx("span",{children:"|"}),q.jsx("span",{children:e.reference}),q.jsx("span",{children:"|"}),q.jsx("span",{children:e.type})]});function zq(){const t=bT(),e=St.useRef(null),[n,r]=w.useState(""),[i,s]=w.useState(""),[o,a]=w.useState(""),[c,l]=w.useState(0),[u,d]=w.useState({name:"none",contents:[],reference:"",type:""}),f=(G,V)=>{e.current=G},[h,p]=Ca();console.log(h);const g=h.editor.accessibilityMode,y=h.editor.autocompleteEnabled;wT(G=>{A.postMessage({type:"close",id:k}),c===1&&G.preventDefault()});const[m,v]=w.useState(!1),S=m?`${u.name} - Mongoose Editor`:"Mongoose Editor";Hq(S);const E=w.useMemo(()=>{switch(c){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[c]),A=w.useMemo(()=>new BroadcastChannel("editor"),[]),b=new URLSearchParams(t.search),k=decodeURIComponent(b.get("reference")||"");w.useEffect(()=>{if(!k)return;console.log("ID: "+k),console.log("Sending ready message"),A.postMessage({type:"ready",id:k});const G=V=>{if(console.log(V.data),V.data.type==="load"){if(n!=="")return;const z=V.data.session.contents.join(`
`);s(z),a(z),d(V.data.session),l(0),r(V.data.clientId),B()}else if(V.data.type==="shutdown"){if(V.data.clientId!==n)return;A.close(),window.close()}};return A.addEventListener("message",G),()=>A.removeEventListener("message",G)},[A,n,k]);const _=()=>{s(o),l(0)},N=G=>{const V=i.split(/\r\n|\r|\n/),z={...u,contents:V};A.postMessage({type:"save",session:z,id:k}),l(2),B(),G.preventDefault()},M=G=>{G!==void 0&&(console.log("Original: "+o),console.log("New: "+G),s(G),G.split(/\r\n|\r|\n/).join(`
`)!==o?l(1):l(0),m||v(!0))},D=()=>{const G=new Blob([i],{type:"text/plain"}),V=URL.createObjectURL(G),z=document.createElement("a"),X=new Date,te=X.toLocaleDateString().replace(/\//g,"-"),H=X.toLocaleTimeString().replace(/:/g,"-"),K=`${u.name}-${te}-${H}.txt`;z.download=K,z.href=V,z.click(),URL.revokeObjectURL(V),z.remove()};return q.jsxs(q.Fragment,{children:[q.jsx(Zq,{onSave:N,onRevert:_,onDownload:D}),q.jsx(Gq,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:M,options:{wordWrap:"on",accessibilitySupport:g?"on":"off",quickSuggestions:y},onMount:f}),q.jsx(jq,{docstate:E,session:u})]});function B(){e.current!==null&&e.current.focus()}}const Xq="modulepreload",$q=function(t){return"/"+t},jk={},Kq=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link");i=Promise.all(n.map(o=>{if(o=$q(o),o in jk)return;jk[o]=!0;const a=o.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===o&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${c}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":Xq,a||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),a)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})}))}return i.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},Jq=t=>{t&&t instanceof Function&&Kq(()=>import("./web-vitals-GXdahIIP.js"),__vite__mapDeps([])).then(({getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:s})=>{e(t),n(t),r(t),i(t),s(t)})};var zk={};const Yq=!!(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function qq(t){if("serviceWorker"in navigator){if(new URL(zk.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const n=`${zk.PUBLIC_URL}/service-worker.js`;Yq?(Qq(n,t),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Dx(n,t)})}}function Dx(t,e){navigator.serviceWorker.register(t).then(n=>{n.onupdatefound=()=>{const r=n.installing;r!=null&&(r.onstatechange=()=>{r.state==="installed"&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(n)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(n)))})}}).catch(n=>{console.error("Error during service worker registration:",n)})}function Qq(t,e){fetch(t).then(n=>{const r=n.headers.get("content-type");n.status===404||r!=null&&r.indexOf("javascript")===-1?navigator.serviceWorker.ready.then(i=>{i.unregister().then(()=>{window.location.reload()})}):Dx(t,e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}bY({dsn:"https://2356c3ef12dad1afcb30defd749d96f1@new.q-continuum.net/2",integrations:[new e$({tracePropagationTargets:["localhost",/^https:\/\/client\.rustytelephone\.net\//]}),new Km],tracesSampleRate:1,replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1});const eQ=bB([{path:"/",element:q.jsx(DY,{})},{path:"/editor",element:q.jsx(zq,{})}]),tQ=Sv.createRoot(document.getElementById("root"));tQ.render(q.jsx(St.StrictMode,{children:q.jsx(PB,{router:eQ})}));Jq(console.log);qq()});export default nQ();
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
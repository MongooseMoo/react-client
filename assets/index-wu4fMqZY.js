var _N=Object.defineProperty;var mI=t=>{throw TypeError(t)};var ON=(t,e,n)=>e in t?_N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var G=(t,e,n)=>ON(t,typeof e!="symbol"?e+"":e,n),Ig=(t,e,n)=>e.has(t)||mI("Cannot "+n);var N=(t,e,n)=>(Ig(t,e,"read from private field"),n?n.call(t):e.get(t)),Ye=(t,e,n)=>e.has(t)?mI("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Ne=(t,e,n,r)=>(Ig(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),be=(t,e,n)=>(Ig(t,e,"access private method"),n);var af=(t,e,n,r)=>({set _(i){Ne(t,e,i,n)},get _(){return N(t,e,r)}});function GA(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var MN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var WA={exports:{}},Np={},jA={exports:{}},ze={},Fd=Symbol.for("react.element"),DN=Symbol.for("react.portal"),LN=Symbol.for("react.fragment"),BN=Symbol.for("react.strict_mode"),FN=Symbol.for("react.profiler"),UN=Symbol.for("react.provider"),VN=Symbol.for("react.context"),GN=Symbol.for("react.forward_ref"),WN=Symbol.for("react.suspense"),jN=Symbol.for("react.memo"),ZN=Symbol.for("react.lazy"),vI=Symbol.iterator;function HN(t){return t===null||typeof t!="object"?null:(t=vI&&t[vI]||t["@@iterator"],typeof t=="function"?t:null)}var ZA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},HA=Object.assign,zA={};function xc(t,e,n){this.props=t,this.context=e,this.refs=zA,this.updater=n||ZA}xc.prototype.isReactComponent={};xc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};xc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function XA(){}XA.prototype=xc.prototype;function ey(t,e,n){this.props=t,this.context=e,this.refs=zA,this.updater=n||ZA}var ty=ey.prototype=new XA;ty.constructor=ey;HA(ty,xc.prototype);ty.isPureReactComponent=!0;var yI=Array.isArray,$A=Object.prototype.hasOwnProperty,ny={current:null},KA={key:!0,ref:!0,__self:!0,__source:!0};function JA(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)$A.call(e,r)&&!KA.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Fd,type:t,key:o,ref:s,props:i,_owner:ny.current}}function zN(t,e){return{$$typeof:Fd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ry(t){return typeof t=="object"&&t!==null&&t.$$typeof===Fd}function XN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var CI=/\/+/g;function Sg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?XN(""+t.key):e.toString(36)}function Vf(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Fd:case DN:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+Sg(s,0):r,yI(i)?(n="",t!=null&&(n=t.replace(CI,"$&/")+"/"),Vf(i,e,n,"",function(c){return c})):i!=null&&(ry(i)&&(i=zN(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(CI,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",yI(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+Sg(o,a);s+=Vf(o,e,n,l,i)}else if(l=HN(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+Sg(o,a++),s+=Vf(o,e,n,l,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function lf(t,e,n){if(t==null)return t;var r=[],i=0;return Vf(t,r,"","",function(o){return e.call(n,o,i++)}),r}function $N(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var or={current:null},Gf={transition:null},KN={ReactCurrentDispatcher:or,ReactCurrentBatchConfig:Gf,ReactCurrentOwner:ny};function YA(){throw Error("act(...) is not supported in production builds of React.")}ze.Children={map:lf,forEach:function(t,e,n){lf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return lf(t,function(){e++}),e},toArray:function(t){return lf(t,function(e){return e})||[]},only:function(t){if(!ry(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ze.Component=xc;ze.Fragment=LN;ze.Profiler=FN;ze.PureComponent=ey;ze.StrictMode=BN;ze.Suspense=WN;ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KN;ze.act=YA;ze.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=HA({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=ny.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)$A.call(e,l)&&!KA.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Fd,type:t.type,key:i,ref:o,props:r,_owner:s}};ze.createContext=function(t){return t={$$typeof:VN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:UN,_context:t},t.Consumer=t};ze.createElement=JA;ze.createFactory=function(t){var e=JA.bind(null,t);return e.type=t,e};ze.createRef=function(){return{current:null}};ze.forwardRef=function(t){return{$$typeof:GN,render:t}};ze.isValidElement=ry;ze.lazy=function(t){return{$$typeof:ZN,_payload:{_status:-1,_result:t},_init:$N}};ze.memo=function(t,e){return{$$typeof:jN,type:t,compare:e===void 0?null:e}};ze.startTransition=function(t){var e=Gf.transition;Gf.transition={};try{t()}finally{Gf.transition=e}};ze.unstable_act=YA;ze.useCallback=function(t,e){return or.current.useCallback(t,e)};ze.useContext=function(t){return or.current.useContext(t)};ze.useDebugValue=function(){};ze.useDeferredValue=function(t){return or.current.useDeferredValue(t)};ze.useEffect=function(t,e){return or.current.useEffect(t,e)};ze.useId=function(){return or.current.useId()};ze.useImperativeHandle=function(t,e,n){return or.current.useImperativeHandle(t,e,n)};ze.useInsertionEffect=function(t,e){return or.current.useInsertionEffect(t,e)};ze.useLayoutEffect=function(t,e){return or.current.useLayoutEffect(t,e)};ze.useMemo=function(t,e){return or.current.useMemo(t,e)};ze.useReducer=function(t,e,n){return or.current.useReducer(t,e,n)};ze.useRef=function(t){return or.current.useRef(t)};ze.useState=function(t){return or.current.useState(t)};ze.useSyncExternalStore=function(t,e,n){return or.current.useSyncExternalStore(t,e,n)};ze.useTransition=function(){return or.current.useTransition()};ze.version="18.3.1";jA.exports=ze;var b=jA.exports;const dt=Bd(b),JN=GA({__proto__:null,default:dt},[b]);var YN=b,QN=Symbol.for("react.element"),qN=Symbol.for("react.fragment"),e_=Object.prototype.hasOwnProperty,t_=YN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n_={key:!0,ref:!0,__self:!0,__source:!0};function QA(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)e_.call(e,r)&&!n_.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:QN,type:t,key:o,ref:s,props:i,_owner:t_.current}}Np.Fragment=qN;Np.jsx=QA;Np.jsxs=QA;WA.exports=Np;var Y=WA.exports,Bm={},qA={exports:{}},zr={},e1={exports:{}},t1={};(function(t){function e(X,J){var oe=X.length;X.push(J);e:for(;0<oe;){var W=oe-1>>>1,se=X[W];if(0<i(se,J))X[W]=J,X[oe]=se,oe=W;else break e}}function n(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var J=X[0],oe=X.pop();if(oe!==J){X[0]=oe;e:for(var W=0,se=X.length,we=se>>>1;W<we;){var De=2*(W+1)-1,de=X[De],xe=De+1,rt=X[xe];if(0>i(de,oe))xe<se&&0>i(rt,de)?(X[W]=rt,X[xe]=oe,W=xe):(X[W]=de,X[De]=oe,W=De);else if(xe<se&&0>i(rt,oe))X[W]=rt,X[xe]=oe,W=xe;else break e}}return J}function i(X,J){var oe=X.sortIndex-J.sortIndex;return oe!==0?oe:X.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,f=3,h=!1,p=!1,g=!1,C=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(X){for(var J=n(c);J!==null;){if(J.callback===null)r(c);else if(J.startTime<=X)r(c),J.sortIndex=J.expirationTime,e(l,J);else break;J=n(c)}}function E(X){if(g=!1,S(X),!p)if(n(l)!==null)p=!0,ee(w);else{var J=n(c);J!==null&&re(E,J.startTime-X)}}function w(X,J){p=!1,g&&(g=!1,m(T),T=-1),h=!0;var oe=f;try{for(S(J),d=n(l);d!==null&&(!(d.expirationTime>J)||X&&!L());){var W=d.callback;if(typeof W=="function"){d.callback=null,f=d.priorityLevel;var se=W(d.expirationTime<=J);J=t.unstable_now(),typeof se=="function"?d.callback=se:d===n(l)&&r(l),S(J)}else r(l);d=n(l)}if(d!==null)var we=!0;else{var De=n(c);De!==null&&re(E,De.startTime-J),we=!1}return we}finally{d=null,f=oe,h=!1}}var A=!1,x=null,T=-1,_=5,O=-1;function L(){return!(t.unstable_now()-O<_)}function U(){if(x!==null){var X=t.unstable_now();O=X;var J=!0;try{J=x(!0,X)}finally{J?z():(A=!1,x=null)}}else A=!1}var z;if(typeof v=="function")z=function(){v(U)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,K=Z.port2;Z.port1.onmessage=U,z=function(){K.postMessage(null)}}else z=function(){C(U,0)};function ee(X){x=X,A||(A=!0,z())}function re(X,J){T=C(function(){X(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,ee(w))},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(X){switch(f){case 1:case 2:case 3:var J=3;break;default:J=f}var oe=f;f=J;try{return X()}finally{f=oe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(X,J){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var oe=f;f=X;try{return J()}finally{f=oe}},t.unstable_scheduleCallback=function(X,J,oe){var W=t.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?W+oe:W):oe=W,X){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=oe+se,X={id:u++,callback:J,priorityLevel:X,startTime:oe,expirationTime:se,sortIndex:-1},oe>W?(X.sortIndex=oe,e(c,X),n(l)===null&&X===n(c)&&(g?(m(T),T=-1):g=!0,re(E,oe-W))):(X.sortIndex=se,e(l,X),p||h||(p=!0,ee(w))),X},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(X){var J=f;return function(){var oe=f;f=J;try{return X.apply(this,arguments)}finally{f=oe}}}})(t1);e1.exports=t1;var r_=e1.exports,i_=b,jr=r_;function le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n1=new Set,Qu={};function dl(t,e){dc(t,e),dc(t+"Capture",e)}function dc(t,e){for(Qu[t]=e,t=0;t<e.length;t++)n1.add(e[t])}var ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fm=Object.prototype.hasOwnProperty,o_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,II={},SI={};function s_(t){return Fm.call(SI,t)?!0:Fm.call(II,t)?!1:o_.test(t)?SI[t]=!0:(II[t]=!0,!1)}function a_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function l_(t,e,n,r){if(e===null||typeof e>"u"||a_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function sr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Rn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Rn[t]=new sr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Rn[e]=new sr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Rn[t]=new sr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Rn[t]=new sr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Rn[t]=new sr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Rn[t]=new sr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Rn[t]=new sr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Rn[t]=new sr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Rn[t]=new sr(t,5,!1,t.toLowerCase(),null,!1,!1)});var iy=/[\-:]([a-z])/g;function oy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(iy,oy);Rn[e]=new sr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(iy,oy);Rn[e]=new sr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(iy,oy);Rn[e]=new sr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Rn[t]=new sr(t,1,!1,t.toLowerCase(),null,!1,!1)});Rn.xlinkHref=new sr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Rn[t]=new sr(t,1,!1,t.toLowerCase(),null,!0,!0)});function sy(t,e,n,r){var i=Rn.hasOwnProperty(e)?Rn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(l_(e,n,i,r)&&(n=null),r||i===null?s_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Is=i_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cf=Symbol.for("react.element"),Rl=Symbol.for("react.portal"),xl=Symbol.for("react.fragment"),ay=Symbol.for("react.strict_mode"),Um=Symbol.for("react.profiler"),r1=Symbol.for("react.provider"),i1=Symbol.for("react.context"),ly=Symbol.for("react.forward_ref"),Vm=Symbol.for("react.suspense"),Gm=Symbol.for("react.suspense_list"),cy=Symbol.for("react.memo"),Ds=Symbol.for("react.lazy"),o1=Symbol.for("react.offscreen"),bI=Symbol.iterator;function Qc(t){return t===null||typeof t!="object"?null:(t=bI&&t[bI]||t["@@iterator"],typeof t=="function"?t:null)}var Ft=Object.assign,bg;function Su(t){if(bg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);bg=e&&e[1]||""}return`
`+bg+t}var wg=!1;function Ag(t,e){if(!t||wg)return"";wg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{wg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Su(t):""}function c_(t){switch(t.tag){case 5:return Su(t.type);case 16:return Su("Lazy");case 13:return Su("Suspense");case 19:return Su("SuspenseList");case 0:case 2:case 15:return t=Ag(t.type,!1),t;case 11:return t=Ag(t.type.render,!1),t;case 1:return t=Ag(t.type,!0),t;default:return""}}function Wm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case xl:return"Fragment";case Rl:return"Portal";case Um:return"Profiler";case ay:return"StrictMode";case Vm:return"Suspense";case Gm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case i1:return(t.displayName||"Context")+".Consumer";case r1:return(t._context.displayName||"Context")+".Provider";case ly:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cy:return e=t.displayName||null,e!==null?e:Wm(t.type)||"Memo";case Ds:e=t._payload,t=t._init;try{return Wm(t(e))}catch{}}return null}function u_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wm(e);case 8:return e===ay?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function aa(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function s1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function d_(t){var e=s1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function uf(t){t._valueTracker||(t._valueTracker=d_(t))}function a1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=s1(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function kh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function jm(t,e){var n=e.checked;return Ft({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function wI(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=aa(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function l1(t,e){e=e.checked,e!=null&&sy(t,"checked",e,!1)}function Zm(t,e){l1(t,e);var n=aa(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Hm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Hm(t,e.type,aa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function AI(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Hm(t,e,n){(e!=="number"||kh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var bu=Array.isArray;function Hl(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+aa(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function zm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(le(91));return Ft({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function kI(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(le(92));if(bu(n)){if(1<n.length)throw Error(le(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:aa(n)}}function c1(t,e){var n=aa(e.value),r=aa(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function EI(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function u1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?u1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var df,d1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(df=df||document.createElement("div"),df.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=df.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function qu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Lu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},f_=["Webkit","ms","Moz","O"];Object.keys(Lu).forEach(function(t){f_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Lu[e]=Lu[t]})});function f1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Lu.hasOwnProperty(t)&&Lu[t]?(""+e).trim():e+"px"}function h1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=f1(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var h_=Ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $m(t,e){if(e){if(h_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(le(62))}}function Km(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jm=null;function uy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ym=null,zl=null,Xl=null;function TI(t){if(t=Gd(t)){if(typeof Ym!="function")throw Error(le(280));var e=t.stateNode;e&&(e=Lp(e),Ym(t.stateNode,t.type,e))}}function p1(t){zl?Xl?Xl.push(t):Xl=[t]:zl=t}function g1(){if(zl){var t=zl,e=Xl;if(Xl=zl=null,TI(t),e)for(t=0;t<e.length;t++)TI(e[t])}}function m1(t,e){return t(e)}function v1(){}var kg=!1;function y1(t,e,n){if(kg)return t(e,n);kg=!0;try{return m1(t,e,n)}finally{kg=!1,(zl!==null||Xl!==null)&&(v1(),g1())}}function ed(t,e){var n=t.stateNode;if(n===null)return null;var r=Lp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(le(231,e,typeof n));return n}var Qm=!1;if(ds)try{var qc={};Object.defineProperty(qc,"passive",{get:function(){Qm=!0}}),window.addEventListener("test",qc,qc),window.removeEventListener("test",qc,qc)}catch{Qm=!1}function p_(t,e,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Bu=!1,Eh=null,Th=!1,qm=null,g_={onError:function(t){Bu=!0,Eh=t}};function m_(t,e,n,r,i,o,s,a,l){Bu=!1,Eh=null,p_.apply(g_,arguments)}function v_(t,e,n,r,i,o,s,a,l){if(m_.apply(this,arguments),Bu){if(Bu){var c=Eh;Bu=!1,Eh=null}else throw Error(le(198));Th||(Th=!0,qm=c)}}function fl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function C1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function RI(t){if(fl(t)!==t)throw Error(le(188))}function y_(t){var e=t.alternate;if(!e){if(e=fl(t),e===null)throw Error(le(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return RI(i),t;if(o===r)return RI(i),e;o=o.sibling}throw Error(le(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(le(189))}}if(n.alternate!==r)throw Error(le(190))}if(n.tag!==3)throw Error(le(188));return n.stateNode.current===n?t:e}function I1(t){return t=y_(t),t!==null?S1(t):null}function S1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=S1(t);if(e!==null)return e;t=t.sibling}return null}var b1=jr.unstable_scheduleCallback,xI=jr.unstable_cancelCallback,C_=jr.unstable_shouldYield,I_=jr.unstable_requestPaint,$t=jr.unstable_now,S_=jr.unstable_getCurrentPriorityLevel,dy=jr.unstable_ImmediatePriority,w1=jr.unstable_UserBlockingPriority,Rh=jr.unstable_NormalPriority,b_=jr.unstable_LowPriority,A1=jr.unstable_IdlePriority,_p=null,go=null;function w_(t){if(go&&typeof go.onCommitFiberRoot=="function")try{go.onCommitFiberRoot(_p,t,void 0,(t.current.flags&128)===128)}catch{}}var Ni=Math.clz32?Math.clz32:E_,A_=Math.log,k_=Math.LN2;function E_(t){return t>>>=0,t===0?32:31-(A_(t)/k_|0)|0}var ff=64,hf=4194304;function wu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function xh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=wu(a):(o&=s,o!==0&&(r=wu(o)))}else s=n&~i,s!==0?r=wu(s):o!==0&&(r=wu(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ni(e),i=1<<n,r|=t[n],e&=~i;return r}function T_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function R_(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-Ni(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=T_(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function ev(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function k1(){var t=ff;return ff<<=1,!(ff&4194240)&&(ff=64),t}function Eg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ud(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ni(e),t[e]=n}function x_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ni(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function fy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ni(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var lt=0;function E1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var T1,hy,R1,x1,P1,tv=!1,pf=[],Ys=null,Qs=null,qs=null,td=new Map,nd=new Map,Fs=[],P_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function PI(t,e){switch(t){case"focusin":case"focusout":Ys=null;break;case"dragenter":case"dragleave":Qs=null;break;case"mouseover":case"mouseout":qs=null;break;case"pointerover":case"pointerout":td.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":nd.delete(e.pointerId)}}function eu(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Gd(e),e!==null&&hy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function N_(t,e,n,r,i){switch(e){case"focusin":return Ys=eu(Ys,t,e,n,r,i),!0;case"dragenter":return Qs=eu(Qs,t,e,n,r,i),!0;case"mouseover":return qs=eu(qs,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return td.set(o,eu(td.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,nd.set(o,eu(nd.get(o)||null,t,e,n,r,i)),!0}return!1}function N1(t){var e=Da(t.target);if(e!==null){var n=fl(e);if(n!==null){if(e=n.tag,e===13){if(e=C1(n),e!==null){t.blockedOn=e,P1(t.priority,function(){R1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Wf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=nv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Jm=r,n.target.dispatchEvent(r),Jm=null}else return e=Gd(n),e!==null&&hy(e),t.blockedOn=n,!1;e.shift()}return!0}function NI(t,e,n){Wf(t)&&n.delete(e)}function __(){tv=!1,Ys!==null&&Wf(Ys)&&(Ys=null),Qs!==null&&Wf(Qs)&&(Qs=null),qs!==null&&Wf(qs)&&(qs=null),td.forEach(NI),nd.forEach(NI)}function tu(t,e){t.blockedOn===e&&(t.blockedOn=null,tv||(tv=!0,jr.unstable_scheduleCallback(jr.unstable_NormalPriority,__)))}function rd(t){function e(i){return tu(i,t)}if(0<pf.length){tu(pf[0],t);for(var n=1;n<pf.length;n++){var r=pf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ys!==null&&tu(Ys,t),Qs!==null&&tu(Qs,t),qs!==null&&tu(qs,t),td.forEach(e),nd.forEach(e),n=0;n<Fs.length;n++)r=Fs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Fs.length&&(n=Fs[0],n.blockedOn===null);)N1(n),n.blockedOn===null&&Fs.shift()}var $l=Is.ReactCurrentBatchConfig,Ph=!0;function O_(t,e,n,r){var i=lt,o=$l.transition;$l.transition=null;try{lt=1,py(t,e,n,r)}finally{lt=i,$l.transition=o}}function M_(t,e,n,r){var i=lt,o=$l.transition;$l.transition=null;try{lt=4,py(t,e,n,r)}finally{lt=i,$l.transition=o}}function py(t,e,n,r){if(Ph){var i=nv(t,e,n,r);if(i===null)Lg(t,e,r,Nh,n),PI(t,r);else if(N_(i,t,e,n,r))r.stopPropagation();else if(PI(t,r),e&4&&-1<P_.indexOf(t)){for(;i!==null;){var o=Gd(i);if(o!==null&&T1(o),o=nv(t,e,n,r),o===null&&Lg(t,e,r,Nh,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Lg(t,e,r,null,n)}}var Nh=null;function nv(t,e,n,r){if(Nh=null,t=uy(r),t=Da(t),t!==null)if(e=fl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=C1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nh=t,null}function _1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(S_()){case dy:return 1;case w1:return 4;case Rh:case b_:return 16;case A1:return 536870912;default:return 16}default:return 16}}var Gs=null,gy=null,jf=null;function O1(){if(jf)return jf;var t,e=gy,n=e.length,r,i="value"in Gs?Gs.value:Gs.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return jf=i.slice(t,1<r?1-r:void 0)}function Zf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function gf(){return!0}function _I(){return!1}function Xr(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?gf:_I,this.isPropagationStopped=_I,this}return Ft(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=gf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=gf)},persist:function(){},isPersistent:gf}),e}var Pc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},my=Xr(Pc),Vd=Ft({},Pc,{view:0,detail:0}),D_=Xr(Vd),Tg,Rg,nu,Op=Ft({},Vd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==nu&&(nu&&t.type==="mousemove"?(Tg=t.screenX-nu.screenX,Rg=t.screenY-nu.screenY):Rg=Tg=0,nu=t),Tg)},movementY:function(t){return"movementY"in t?t.movementY:Rg}}),OI=Xr(Op),L_=Ft({},Op,{dataTransfer:0}),B_=Xr(L_),F_=Ft({},Vd,{relatedTarget:0}),xg=Xr(F_),U_=Ft({},Pc,{animationName:0,elapsedTime:0,pseudoElement:0}),V_=Xr(U_),G_=Ft({},Pc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),W_=Xr(G_),j_=Ft({},Pc,{data:0}),MI=Xr(j_),Z_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},H_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},z_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function X_(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=z_[t])?!!e[t]:!1}function vy(){return X_}var $_=Ft({},Vd,{key:function(t){if(t.key){var e=Z_[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Zf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?H_[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vy,charCode:function(t){return t.type==="keypress"?Zf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Zf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),K_=Xr($_),J_=Ft({},Op,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),DI=Xr(J_),Y_=Ft({},Vd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vy}),Q_=Xr(Y_),q_=Ft({},Pc,{propertyName:0,elapsedTime:0,pseudoElement:0}),eO=Xr(q_),tO=Ft({},Op,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),nO=Xr(tO),rO=[9,13,27,32],yy=ds&&"CompositionEvent"in window,Fu=null;ds&&"documentMode"in document&&(Fu=document.documentMode);var iO=ds&&"TextEvent"in window&&!Fu,M1=ds&&(!yy||Fu&&8<Fu&&11>=Fu),LI=" ",BI=!1;function D1(t,e){switch(t){case"keyup":return rO.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function L1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pl=!1;function oO(t,e){switch(t){case"compositionend":return L1(e);case"keypress":return e.which!==32?null:(BI=!0,LI);case"textInput":return t=e.data,t===LI&&BI?null:t;default:return null}}function sO(t,e){if(Pl)return t==="compositionend"||!yy&&D1(t,e)?(t=O1(),jf=gy=Gs=null,Pl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return M1&&e.locale!=="ko"?null:e.data;default:return null}}var aO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function FI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!aO[t.type]:e==="textarea"}function B1(t,e,n,r){p1(r),e=_h(e,"onChange"),0<e.length&&(n=new my("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Uu=null,id=null;function lO(t){$1(t,0)}function Mp(t){var e=Ol(t);if(a1(e))return t}function cO(t,e){if(t==="change")return e}var F1=!1;if(ds){var Pg;if(ds){var Ng="oninput"in document;if(!Ng){var UI=document.createElement("div");UI.setAttribute("oninput","return;"),Ng=typeof UI.oninput=="function"}Pg=Ng}else Pg=!1;F1=Pg&&(!document.documentMode||9<document.documentMode)}function VI(){Uu&&(Uu.detachEvent("onpropertychange",U1),id=Uu=null)}function U1(t){if(t.propertyName==="value"&&Mp(id)){var e=[];B1(e,id,t,uy(t)),y1(lO,e)}}function uO(t,e,n){t==="focusin"?(VI(),Uu=e,id=n,Uu.attachEvent("onpropertychange",U1)):t==="focusout"&&VI()}function dO(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Mp(id)}function fO(t,e){if(t==="click")return Mp(e)}function hO(t,e){if(t==="input"||t==="change")return Mp(e)}function pO(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Mi=typeof Object.is=="function"?Object.is:pO;function od(t,e){if(Mi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Fm.call(e,i)||!Mi(t[i],e[i]))return!1}return!0}function GI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function WI(t,e){var n=GI(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=GI(n)}}function V1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?V1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function G1(){for(var t=window,e=kh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=kh(t.document)}return e}function Cy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function gO(t){var e=G1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&V1(n.ownerDocument.documentElement,n)){if(r!==null&&Cy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=WI(n,o);var s=WI(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mO=ds&&"documentMode"in document&&11>=document.documentMode,Nl=null,rv=null,Vu=null,iv=!1;function jI(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;iv||Nl==null||Nl!==kh(r)||(r=Nl,"selectionStart"in r&&Cy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vu&&od(Vu,r)||(Vu=r,r=_h(rv,"onSelect"),0<r.length&&(e=new my("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Nl)))}function mf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var _l={animationend:mf("Animation","AnimationEnd"),animationiteration:mf("Animation","AnimationIteration"),animationstart:mf("Animation","AnimationStart"),transitionend:mf("Transition","TransitionEnd")},_g={},W1={};ds&&(W1=document.createElement("div").style,"AnimationEvent"in window||(delete _l.animationend.animation,delete _l.animationiteration.animation,delete _l.animationstart.animation),"TransitionEvent"in window||delete _l.transitionend.transition);function Dp(t){if(_g[t])return _g[t];if(!_l[t])return t;var e=_l[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in W1)return _g[t]=e[n];return t}var j1=Dp("animationend"),Z1=Dp("animationiteration"),H1=Dp("animationstart"),z1=Dp("transitionend"),X1=new Map,ZI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ha(t,e){X1.set(t,e),dl(e,[t])}for(var Og=0;Og<ZI.length;Og++){var Mg=ZI[Og],vO=Mg.toLowerCase(),yO=Mg[0].toUpperCase()+Mg.slice(1);ha(vO,"on"+yO)}ha(j1,"onAnimationEnd");ha(Z1,"onAnimationIteration");ha(H1,"onAnimationStart");ha("dblclick","onDoubleClick");ha("focusin","onFocus");ha("focusout","onBlur");ha(z1,"onTransitionEnd");dc("onMouseEnter",["mouseout","mouseover"]);dc("onMouseLeave",["mouseout","mouseover"]);dc("onPointerEnter",["pointerout","pointerover"]);dc("onPointerLeave",["pointerout","pointerover"]);dl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));dl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));dl("onBeforeInput",["compositionend","keypress","textInput","paste"]);dl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));dl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));dl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CO=new Set("cancel close invalid load scroll toggle".split(" ").concat(Au));function HI(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,v_(r,e,void 0,t),t.currentTarget=null}function $1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;HI(i,a,c),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;HI(i,a,c),o=l}}}if(Th)throw t=qm,Th=!1,qm=null,t}function St(t,e){var n=e[cv];n===void 0&&(n=e[cv]=new Set);var r=t+"__bubble";n.has(r)||(K1(e,t,2,!1),n.add(r))}function Dg(t,e,n){var r=0;e&&(r|=4),K1(n,t,r,e)}var vf="_reactListening"+Math.random().toString(36).slice(2);function sd(t){if(!t[vf]){t[vf]=!0,n1.forEach(function(n){n!=="selectionchange"&&(CO.has(n)||Dg(n,!1,t),Dg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[vf]||(e[vf]=!0,Dg("selectionchange",!1,e))}}function K1(t,e,n,r){switch(_1(e)){case 1:var i=O_;break;case 4:i=M_;break;default:i=py}n=i.bind(null,e,n,t),i=void 0,!Qm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Lg(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Da(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}y1(function(){var c=o,u=uy(n),d=[];e:{var f=X1.get(t);if(f!==void 0){var h=my,p=t;switch(t){case"keypress":if(Zf(n)===0)break e;case"keydown":case"keyup":h=K_;break;case"focusin":p="focus",h=xg;break;case"focusout":p="blur",h=xg;break;case"beforeblur":case"afterblur":h=xg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=OI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=B_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=Q_;break;case j1:case Z1:case H1:h=V_;break;case z1:h=eO;break;case"scroll":h=D_;break;case"wheel":h=nO;break;case"copy":case"cut":case"paste":h=W_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=DI}var g=(e&4)!==0,C=!g&&t==="scroll",m=g?f!==null?f+"Capture":null:f;g=[];for(var v=c,S;v!==null;){S=v;var E=S.stateNode;if(S.tag===5&&E!==null&&(S=E,m!==null&&(E=ed(v,m),E!=null&&g.push(ad(v,E,S)))),C)break;v=v.return}0<g.length&&(f=new h(f,p,null,n,u),d.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Jm&&(p=n.relatedTarget||n.fromElement)&&(Da(p)||p[fs]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=c,p=p?Da(p):null,p!==null&&(C=fl(p),p!==C||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=c),h!==p)){if(g=OI,E="onMouseLeave",m="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(g=DI,E="onPointerLeave",m="onPointerEnter",v="pointer"),C=h==null?f:Ol(h),S=p==null?f:Ol(p),f=new g(E,v+"leave",h,n,u),f.target=C,f.relatedTarget=S,E=null,Da(u)===c&&(g=new g(m,v+"enter",p,n,u),g.target=S,g.relatedTarget=C,E=g),C=E,h&&p)t:{for(g=h,m=p,v=0,S=g;S;S=Il(S))v++;for(S=0,E=m;E;E=Il(E))S++;for(;0<v-S;)g=Il(g),v--;for(;0<S-v;)m=Il(m),S--;for(;v--;){if(g===m||m!==null&&g===m.alternate)break t;g=Il(g),m=Il(m)}g=null}else g=null;h!==null&&zI(d,f,h,g,!1),p!==null&&C!==null&&zI(d,C,p,g,!0)}}e:{if(f=c?Ol(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var w=cO;else if(FI(f))if(F1)w=hO;else{w=dO;var A=uO}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(w=fO);if(w&&(w=w(t,c))){B1(d,w,n,u);break e}A&&A(t,f,c),t==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&Hm(f,"number",f.value)}switch(A=c?Ol(c):window,t){case"focusin":(FI(A)||A.contentEditable==="true")&&(Nl=A,rv=c,Vu=null);break;case"focusout":Vu=rv=Nl=null;break;case"mousedown":iv=!0;break;case"contextmenu":case"mouseup":case"dragend":iv=!1,jI(d,n,u);break;case"selectionchange":if(mO)break;case"keydown":case"keyup":jI(d,n,u)}var x;if(yy)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Pl?D1(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(M1&&n.locale!=="ko"&&(Pl||T!=="onCompositionStart"?T==="onCompositionEnd"&&Pl&&(x=O1()):(Gs=u,gy="value"in Gs?Gs.value:Gs.textContent,Pl=!0)),A=_h(c,T),0<A.length&&(T=new MI(T,t,null,n,u),d.push({event:T,listeners:A}),x?T.data=x:(x=L1(n),x!==null&&(T.data=x)))),(x=iO?oO(t,n):sO(t,n))&&(c=_h(c,"onBeforeInput"),0<c.length&&(u=new MI("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=x))}$1(d,e)})}function ad(t,e,n){return{instance:t,listener:e,currentTarget:n}}function _h(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=ed(t,n),o!=null&&r.unshift(ad(t,o,i)),o=ed(t,e),o!=null&&r.push(ad(t,o,i))),t=t.return}return r}function Il(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function zI(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=ed(n,o),l!=null&&s.unshift(ad(n,l,a))):i||(l=ed(n,o),l!=null&&s.push(ad(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var IO=/\r\n?/g,SO=/\u0000|\uFFFD/g;function XI(t){return(typeof t=="string"?t:""+t).replace(IO,`
`).replace(SO,"")}function yf(t,e,n){if(e=XI(e),XI(t)!==e&&n)throw Error(le(425))}function Oh(){}var ov=null,sv=null;function av(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var lv=typeof setTimeout=="function"?setTimeout:void 0,bO=typeof clearTimeout=="function"?clearTimeout:void 0,$I=typeof Promise=="function"?Promise:void 0,wO=typeof queueMicrotask=="function"?queueMicrotask:typeof $I<"u"?function(t){return $I.resolve(null).then(t).catch(AO)}:lv;function AO(t){setTimeout(function(){throw t})}function Bg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),rd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);rd(e)}function ea(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function KI(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Nc=Math.random().toString(36).slice(2),Ki="__reactFiber$"+Nc,ld="__reactProps$"+Nc,fs="__reactContainer$"+Nc,cv="__reactEvents$"+Nc,kO="__reactListeners$"+Nc,EO="__reactHandles$"+Nc;function Da(t){var e=t[Ki];if(e)return e;for(var n=t.parentNode;n;){if(e=n[fs]||n[Ki]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=KI(t);t!==null;){if(n=t[Ki])return n;t=KI(t)}return e}t=n,n=t.parentNode}return null}function Gd(t){return t=t[Ki]||t[fs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ol(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(le(33))}function Lp(t){return t[ld]||null}var uv=[],Ml=-1;function pa(t){return{current:t}}function Et(t){0>Ml||(t.current=uv[Ml],uv[Ml]=null,Ml--)}function yt(t,e){Ml++,uv[Ml]=t.current,t.current=e}var la={},Wn=pa(la),yr=pa(!1),Ya=la;function fc(t,e){var n=t.type.contextTypes;if(!n)return la;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Cr(t){return t=t.childContextTypes,t!=null}function Mh(){Et(yr),Et(Wn)}function JI(t,e,n){if(Wn.current!==la)throw Error(le(168));yt(Wn,e),yt(yr,n)}function J1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(le(108,u_(t)||"Unknown",i));return Ft({},n,r)}function Dh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||la,Ya=Wn.current,yt(Wn,t),yt(yr,yr.current),!0}function YI(t,e,n){var r=t.stateNode;if(!r)throw Error(le(169));n?(t=J1(t,e,Ya),r.__reactInternalMemoizedMergedChildContext=t,Et(yr),Et(Wn),yt(Wn,t)):Et(yr),yt(yr,n)}var Po=null,Bp=!1,Fg=!1;function Y1(t){Po===null?Po=[t]:Po.push(t)}function TO(t){Bp=!0,Y1(t)}function ga(){if(!Fg&&Po!==null){Fg=!0;var t=0,e=lt;try{var n=Po;for(lt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Po=null,Bp=!1}catch(i){throw Po!==null&&(Po=Po.slice(t+1)),b1(dy,ga),i}finally{lt=e,Fg=!1}}return null}var Dl=[],Ll=0,Lh=null,Bh=0,Jr=[],Yr=0,Qa=null,Do=1,Lo="";function Ea(t,e){Dl[Ll++]=Bh,Dl[Ll++]=Lh,Lh=t,Bh=e}function Q1(t,e,n){Jr[Yr++]=Do,Jr[Yr++]=Lo,Jr[Yr++]=Qa,Qa=t;var r=Do;t=Lo;var i=32-Ni(r)-1;r&=~(1<<i),n+=1;var o=32-Ni(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Do=1<<32-Ni(e)+i|n<<i|r,Lo=o+t}else Do=1<<o|n<<i|r,Lo=t}function Iy(t){t.return!==null&&(Ea(t,1),Q1(t,1,0))}function Sy(t){for(;t===Lh;)Lh=Dl[--Ll],Dl[Ll]=null,Bh=Dl[--Ll],Dl[Ll]=null;for(;t===Qa;)Qa=Jr[--Yr],Jr[Yr]=null,Lo=Jr[--Yr],Jr[Yr]=null,Do=Jr[--Yr],Jr[Yr]=null}var Gr=null,Ur=null,Nt=!1,wi=null;function q1(t,e){var n=qr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function QI(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Gr=t,Ur=ea(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Gr=t,Ur=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Qa!==null?{id:Do,overflow:Lo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=qr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Gr=t,Ur=null,!0):!1;default:return!1}}function dv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function fv(t){if(Nt){var e=Ur;if(e){var n=e;if(!QI(t,e)){if(dv(t))throw Error(le(418));e=ea(n.nextSibling);var r=Gr;e&&QI(t,e)?q1(r,n):(t.flags=t.flags&-4097|2,Nt=!1,Gr=t)}}else{if(dv(t))throw Error(le(418));t.flags=t.flags&-4097|2,Nt=!1,Gr=t}}}function qI(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Gr=t}function Cf(t){if(t!==Gr)return!1;if(!Nt)return qI(t),Nt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!av(t.type,t.memoizedProps)),e&&(e=Ur)){if(dv(t))throw ek(),Error(le(418));for(;e;)q1(t,e),e=ea(e.nextSibling)}if(qI(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ur=ea(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ur=null}}else Ur=Gr?ea(t.stateNode.nextSibling):null;return!0}function ek(){for(var t=Ur;t;)t=ea(t.nextSibling)}function hc(){Ur=Gr=null,Nt=!1}function by(t){wi===null?wi=[t]:wi.push(t)}var RO=Is.ReactCurrentBatchConfig;function ru(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(le(309));var r=n.stateNode}if(!r)throw Error(le(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(le(284));if(!n._owner)throw Error(le(290,t))}return t}function If(t,e){throw t=Object.prototype.toString.call(e),Error(le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function eS(t){var e=t._init;return e(t._payload)}function tk(t){function e(m,v){if(t){var S=m.deletions;S===null?(m.deletions=[v],m.flags|=16):S.push(v)}}function n(m,v){if(!t)return null;for(;v!==null;)e(m,v),v=v.sibling;return null}function r(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function i(m,v){return m=ia(m,v),m.index=0,m.sibling=null,m}function o(m,v,S){return m.index=S,t?(S=m.alternate,S!==null?(S=S.index,S<v?(m.flags|=2,v):S):(m.flags|=2,v)):(m.flags|=1048576,v)}function s(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,v,S,E){return v===null||v.tag!==6?(v=Hg(S,m.mode,E),v.return=m,v):(v=i(v,S),v.return=m,v)}function l(m,v,S,E){var w=S.type;return w===xl?u(m,v,S.props.children,E,S.key):v!==null&&(v.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Ds&&eS(w)===v.type)?(E=i(v,S.props),E.ref=ru(m,v,S),E.return=m,E):(E=Yf(S.type,S.key,S.props,null,m.mode,E),E.ref=ru(m,v,S),E.return=m,E)}function c(m,v,S,E){return v===null||v.tag!==4||v.stateNode.containerInfo!==S.containerInfo||v.stateNode.implementation!==S.implementation?(v=zg(S,m.mode,E),v.return=m,v):(v=i(v,S.children||[]),v.return=m,v)}function u(m,v,S,E,w){return v===null||v.tag!==7?(v=Ha(S,m.mode,E,w),v.return=m,v):(v=i(v,S),v.return=m,v)}function d(m,v,S){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Hg(""+v,m.mode,S),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case cf:return S=Yf(v.type,v.key,v.props,null,m.mode,S),S.ref=ru(m,null,v),S.return=m,S;case Rl:return v=zg(v,m.mode,S),v.return=m,v;case Ds:var E=v._init;return d(m,E(v._payload),S)}if(bu(v)||Qc(v))return v=Ha(v,m.mode,S,null),v.return=m,v;If(m,v)}return null}function f(m,v,S,E){var w=v!==null?v.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return w!==null?null:a(m,v,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case cf:return S.key===w?l(m,v,S,E):null;case Rl:return S.key===w?c(m,v,S,E):null;case Ds:return w=S._init,f(m,v,w(S._payload),E)}if(bu(S)||Qc(S))return w!==null?null:u(m,v,S,E,null);If(m,S)}return null}function h(m,v,S,E,w){if(typeof E=="string"&&E!==""||typeof E=="number")return m=m.get(S)||null,a(v,m,""+E,w);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case cf:return m=m.get(E.key===null?S:E.key)||null,l(v,m,E,w);case Rl:return m=m.get(E.key===null?S:E.key)||null,c(v,m,E,w);case Ds:var A=E._init;return h(m,v,S,A(E._payload),w)}if(bu(E)||Qc(E))return m=m.get(S)||null,u(v,m,E,w,null);If(v,E)}return null}function p(m,v,S,E){for(var w=null,A=null,x=v,T=v=0,_=null;x!==null&&T<S.length;T++){x.index>T?(_=x,x=null):_=x.sibling;var O=f(m,x,S[T],E);if(O===null){x===null&&(x=_);break}t&&x&&O.alternate===null&&e(m,x),v=o(O,v,T),A===null?w=O:A.sibling=O,A=O,x=_}if(T===S.length)return n(m,x),Nt&&Ea(m,T),w;if(x===null){for(;T<S.length;T++)x=d(m,S[T],E),x!==null&&(v=o(x,v,T),A===null?w=x:A.sibling=x,A=x);return Nt&&Ea(m,T),w}for(x=r(m,x);T<S.length;T++)_=h(x,m,T,S[T],E),_!==null&&(t&&_.alternate!==null&&x.delete(_.key===null?T:_.key),v=o(_,v,T),A===null?w=_:A.sibling=_,A=_);return t&&x.forEach(function(L){return e(m,L)}),Nt&&Ea(m,T),w}function g(m,v,S,E){var w=Qc(S);if(typeof w!="function")throw Error(le(150));if(S=w.call(S),S==null)throw Error(le(151));for(var A=w=null,x=v,T=v=0,_=null,O=S.next();x!==null&&!O.done;T++,O=S.next()){x.index>T?(_=x,x=null):_=x.sibling;var L=f(m,x,O.value,E);if(L===null){x===null&&(x=_);break}t&&x&&L.alternate===null&&e(m,x),v=o(L,v,T),A===null?w=L:A.sibling=L,A=L,x=_}if(O.done)return n(m,x),Nt&&Ea(m,T),w;if(x===null){for(;!O.done;T++,O=S.next())O=d(m,O.value,E),O!==null&&(v=o(O,v,T),A===null?w=O:A.sibling=O,A=O);return Nt&&Ea(m,T),w}for(x=r(m,x);!O.done;T++,O=S.next())O=h(x,m,T,O.value,E),O!==null&&(t&&O.alternate!==null&&x.delete(O.key===null?T:O.key),v=o(O,v,T),A===null?w=O:A.sibling=O,A=O);return t&&x.forEach(function(U){return e(m,U)}),Nt&&Ea(m,T),w}function C(m,v,S,E){if(typeof S=="object"&&S!==null&&S.type===xl&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case cf:e:{for(var w=S.key,A=v;A!==null;){if(A.key===w){if(w=S.type,w===xl){if(A.tag===7){n(m,A.sibling),v=i(A,S.props.children),v.return=m,m=v;break e}}else if(A.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Ds&&eS(w)===A.type){n(m,A.sibling),v=i(A,S.props),v.ref=ru(m,A,S),v.return=m,m=v;break e}n(m,A);break}else e(m,A);A=A.sibling}S.type===xl?(v=Ha(S.props.children,m.mode,E,S.key),v.return=m,m=v):(E=Yf(S.type,S.key,S.props,null,m.mode,E),E.ref=ru(m,v,S),E.return=m,m=E)}return s(m);case Rl:e:{for(A=S.key;v!==null;){if(v.key===A)if(v.tag===4&&v.stateNode.containerInfo===S.containerInfo&&v.stateNode.implementation===S.implementation){n(m,v.sibling),v=i(v,S.children||[]),v.return=m,m=v;break e}else{n(m,v);break}else e(m,v);v=v.sibling}v=zg(S,m.mode,E),v.return=m,m=v}return s(m);case Ds:return A=S._init,C(m,v,A(S._payload),E)}if(bu(S))return p(m,v,S,E);if(Qc(S))return g(m,v,S,E);If(m,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,v!==null&&v.tag===6?(n(m,v.sibling),v=i(v,S),v.return=m,m=v):(n(m,v),v=Hg(S,m.mode,E),v.return=m,m=v),s(m)):n(m,v)}return C}var pc=tk(!0),nk=tk(!1),Fh=pa(null),Uh=null,Bl=null,wy=null;function Ay(){wy=Bl=Uh=null}function ky(t){var e=Fh.current;Et(Fh),t._currentValue=e}function hv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Kl(t,e){Uh=t,wy=Bl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(mr=!0),t.firstContext=null)}function ri(t){var e=t._currentValue;if(wy!==t)if(t={context:t,memoizedValue:e,next:null},Bl===null){if(Uh===null)throw Error(le(308));Bl=t,Uh.dependencies={lanes:0,firstContext:t}}else Bl=Bl.next=t;return e}var La=null;function Ey(t){La===null?La=[t]:La.push(t)}function rk(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Ey(e)):(n.next=i.next,i.next=n),e.interleaved=n,hs(t,r)}function hs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ls=!1;function Ty(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ik(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function as(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ta(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Qe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,hs(t,n)}return i=r.interleaved,i===null?(e.next=e,Ey(r)):(e.next=i.next,i.next=e),r.interleaved=e,hs(t,n)}function Hf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fy(t,n)}}function tS(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Vh(t,e,n,r){var i=t.updateQueue;Ls=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=i.baseState;s=0,u=c=l=null,a=o;do{var f=a.lane,h=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,g=a;switch(f=e,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Ft({},d,f);break e;case 2:Ls=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=h,l=d):u=u.next=h,s|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);el|=s,t.lanes=s,t.memoizedState=d}}function nS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(le(191,i));i.call(r)}}}var Wd={},mo=pa(Wd),cd=pa(Wd),ud=pa(Wd);function Ba(t){if(t===Wd)throw Error(le(174));return t}function Ry(t,e){switch(yt(ud,e),yt(cd,t),yt(mo,Wd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Xm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Xm(e,t)}Et(mo),yt(mo,e)}function gc(){Et(mo),Et(cd),Et(ud)}function ok(t){Ba(ud.current);var e=Ba(mo.current),n=Xm(e,t.type);e!==n&&(yt(cd,t),yt(mo,n))}function xy(t){cd.current===t&&(Et(mo),Et(cd))}var Lt=pa(0);function Gh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ug=[];function Py(){for(var t=0;t<Ug.length;t++)Ug[t]._workInProgressVersionPrimary=null;Ug.length=0}var zf=Is.ReactCurrentDispatcher,Vg=Is.ReactCurrentBatchConfig,qa=0,Bt=null,an=null,pn=null,Wh=!1,Gu=!1,dd=0,xO=0;function Dn(){throw Error(le(321))}function Ny(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Mi(t[n],e[n]))return!1;return!0}function _y(t,e,n,r,i,o){if(qa=o,Bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zf.current=t===null||t.memoizedState===null?OO:MO,t=n(r,i),Gu){o=0;do{if(Gu=!1,dd=0,25<=o)throw Error(le(301));o+=1,pn=an=null,e.updateQueue=null,zf.current=DO,t=n(r,i)}while(Gu)}if(zf.current=jh,e=an!==null&&an.next!==null,qa=0,pn=an=Bt=null,Wh=!1,e)throw Error(le(300));return t}function Oy(){var t=dd!==0;return dd=0,t}function Xi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?Bt.memoizedState=pn=t:pn=pn.next=t,pn}function ii(){if(an===null){var t=Bt.alternate;t=t!==null?t.memoizedState:null}else t=an.next;var e=pn===null?Bt.memoizedState:pn.next;if(e!==null)pn=e,an=t;else{if(t===null)throw Error(le(310));an=t,t={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},pn===null?Bt.memoizedState=pn=t:pn=pn.next=t}return pn}function fd(t,e){return typeof e=="function"?e(t):e}function Gg(t){var e=ii(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var r=an,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,c=o;do{var u=c.lane;if((qa&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,s=r):l=l.next=d,Bt.lanes|=u,el|=u}c=c.next}while(c!==null&&c!==o);l===null?s=r:l.next=a,Mi(r,e.memoizedState)||(mr=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Bt.lanes|=o,el|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Wg(t){var e=ii(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);Mi(o,e.memoizedState)||(mr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function sk(){}function ak(t,e){var n=Bt,r=ii(),i=e(),o=!Mi(r.memoizedState,i);if(o&&(r.memoizedState=i,mr=!0),r=r.queue,My(uk.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||pn!==null&&pn.memoizedState.tag&1){if(n.flags|=2048,hd(9,ck.bind(null,n,r,i,e),void 0,null),mn===null)throw Error(le(349));qa&30||lk(n,e,i)}return i}function lk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function ck(t,e,n,r){e.value=n,e.getSnapshot=r,dk(e)&&fk(t)}function uk(t,e,n){return n(function(){dk(e)&&fk(t)})}function dk(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Mi(t,n)}catch{return!0}}function fk(t){var e=hs(t,1);e!==null&&_i(e,t,1,-1)}function rS(t){var e=Xi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fd,lastRenderedState:t},e.queue=t,t=t.dispatch=_O.bind(null,Bt,t),[e.memoizedState,t]}function hd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function hk(){return ii().memoizedState}function Xf(t,e,n,r){var i=Xi();Bt.flags|=t,i.memoizedState=hd(1|e,n,void 0,r===void 0?null:r)}function Fp(t,e,n,r){var i=ii();r=r===void 0?null:r;var o=void 0;if(an!==null){var s=an.memoizedState;if(o=s.destroy,r!==null&&Ny(r,s.deps)){i.memoizedState=hd(e,n,o,r);return}}Bt.flags|=t,i.memoizedState=hd(1|e,n,o,r)}function iS(t,e){return Xf(8390656,8,t,e)}function My(t,e){return Fp(2048,8,t,e)}function pk(t,e){return Fp(4,2,t,e)}function gk(t,e){return Fp(4,4,t,e)}function mk(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function vk(t,e,n){return n=n!=null?n.concat([t]):null,Fp(4,4,mk.bind(null,e,t),n)}function Dy(){}function yk(t,e){var n=ii();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ny(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ck(t,e){var n=ii();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ny(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ik(t,e,n){return qa&21?(Mi(n,e)||(n=k1(),Bt.lanes|=n,el|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,mr=!0),t.memoizedState=n)}function PO(t,e){var n=lt;lt=n!==0&&4>n?n:4,t(!0);var r=Vg.transition;Vg.transition={};try{t(!1),e()}finally{lt=n,Vg.transition=r}}function Sk(){return ii().memoizedState}function NO(t,e,n){var r=ra(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},bk(t))wk(e,n);else if(n=rk(t,e,n,r),n!==null){var i=rr();_i(n,t,r,i),Ak(n,e,r)}}function _O(t,e,n){var r=ra(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(bk(t))wk(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Mi(a,s)){var l=e.interleaved;l===null?(i.next=i,Ey(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=rk(t,e,i,r),n!==null&&(i=rr(),_i(n,t,r,i),Ak(n,e,r))}}function bk(t){var e=t.alternate;return t===Bt||e!==null&&e===Bt}function wk(t,e){Gu=Wh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ak(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fy(t,n)}}var jh={readContext:ri,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useInsertionEffect:Dn,useLayoutEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useMutableSource:Dn,useSyncExternalStore:Dn,useId:Dn,unstable_isNewReconciler:!1},OO={readContext:ri,useCallback:function(t,e){return Xi().memoizedState=[t,e===void 0?null:e],t},useContext:ri,useEffect:iS,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Xf(4194308,4,mk.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Xf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Xf(4,2,t,e)},useMemo:function(t,e){var n=Xi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Xi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=NO.bind(null,Bt,t),[r.memoizedState,t]},useRef:function(t){var e=Xi();return t={current:t},e.memoizedState=t},useState:rS,useDebugValue:Dy,useDeferredValue:function(t){return Xi().memoizedState=t},useTransition:function(){var t=rS(!1),e=t[0];return t=PO.bind(null,t[1]),Xi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Bt,i=Xi();if(Nt){if(n===void 0)throw Error(le(407));n=n()}else{if(n=e(),mn===null)throw Error(le(349));qa&30||lk(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,iS(uk.bind(null,r,o,t),[t]),r.flags|=2048,hd(9,ck.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Xi(),e=mn.identifierPrefix;if(Nt){var n=Lo,r=Do;n=(r&~(1<<32-Ni(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=dd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=xO++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},MO={readContext:ri,useCallback:yk,useContext:ri,useEffect:My,useImperativeHandle:vk,useInsertionEffect:pk,useLayoutEffect:gk,useMemo:Ck,useReducer:Gg,useRef:hk,useState:function(){return Gg(fd)},useDebugValue:Dy,useDeferredValue:function(t){var e=ii();return Ik(e,an.memoizedState,t)},useTransition:function(){var t=Gg(fd)[0],e=ii().memoizedState;return[t,e]},useMutableSource:sk,useSyncExternalStore:ak,useId:Sk,unstable_isNewReconciler:!1},DO={readContext:ri,useCallback:yk,useContext:ri,useEffect:My,useImperativeHandle:vk,useInsertionEffect:pk,useLayoutEffect:gk,useMemo:Ck,useReducer:Wg,useRef:hk,useState:function(){return Wg(fd)},useDebugValue:Dy,useDeferredValue:function(t){var e=ii();return an===null?e.memoizedState=t:Ik(e,an.memoizedState,t)},useTransition:function(){var t=Wg(fd)[0],e=ii().memoizedState;return[t,e]},useMutableSource:sk,useSyncExternalStore:ak,useId:Sk,unstable_isNewReconciler:!1};function di(t,e){if(t&&t.defaultProps){e=Ft({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function pv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ft({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Up={isMounted:function(t){return(t=t._reactInternals)?fl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=rr(),i=ra(t),o=as(r,i);o.payload=e,n!=null&&(o.callback=n),e=ta(t,o,i),e!==null&&(_i(e,t,i,r),Hf(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=rr(),i=ra(t),o=as(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=ta(t,o,i),e!==null&&(_i(e,t,i,r),Hf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=rr(),r=ra(t),i=as(n,r);i.tag=2,e!=null&&(i.callback=e),e=ta(t,i,r),e!==null&&(_i(e,t,r,n),Hf(e,t,r))}};function oS(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!od(n,r)||!od(i,o):!0}function kk(t,e,n){var r=!1,i=la,o=e.contextType;return typeof o=="object"&&o!==null?o=ri(o):(i=Cr(e)?Ya:Wn.current,r=e.contextTypes,o=(r=r!=null)?fc(t,i):la),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Up,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function sS(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Up.enqueueReplaceState(e,e.state,null)}function gv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Ty(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=ri(o):(o=Cr(e)?Ya:Wn.current,i.context=fc(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(pv(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Up.enqueueReplaceState(i,i.state,null),Vh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function mc(t,e){try{var n="",r=e;do n+=c_(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function jg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function mv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var LO=typeof WeakMap=="function"?WeakMap:Map;function Ek(t,e,n){n=as(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Hh||(Hh=!0,Ev=r),mv(t,e)},n}function Tk(t,e,n){n=as(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){mv(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){mv(t,e),typeof r!="function"&&(na===null?na=new Set([this]):na.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function aS(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new LO;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=JO.bind(null,t,e,n),e.then(t,t))}function lS(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function cS(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=as(-1,1),e.tag=2,ta(n,e,1))),n.lanes|=1),t)}var BO=Is.ReactCurrentOwner,mr=!1;function Jn(t,e,n,r){e.child=t===null?nk(e,null,n,r):pc(e,t.child,n,r)}function uS(t,e,n,r,i){n=n.render;var o=e.ref;return Kl(e,i),r=_y(t,e,n,r,o,i),n=Oy(),t!==null&&!mr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ps(t,e,i)):(Nt&&n&&Iy(e),e.flags|=1,Jn(t,e,r,i),e.child)}function dS(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!jy(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,Rk(t,e,o,r,i)):(t=Yf(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:od,n(s,r)&&t.ref===e.ref)return ps(t,e,i)}return e.flags|=1,t=ia(o,r),t.ref=e.ref,t.return=e,e.child=t}function Rk(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(od(o,r)&&t.ref===e.ref)if(mr=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(mr=!0);else return e.lanes=t.lanes,ps(t,e,i)}return vv(t,e,n,r,i)}function xk(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},yt(Ul,_r),_r|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,yt(Ul,_r),_r|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,yt(Ul,_r),_r|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,yt(Ul,_r),_r|=r;return Jn(t,e,i,n),e.child}function Pk(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function vv(t,e,n,r,i){var o=Cr(n)?Ya:Wn.current;return o=fc(e,o),Kl(e,i),n=_y(t,e,n,r,o,i),r=Oy(),t!==null&&!mr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ps(t,e,i)):(Nt&&r&&Iy(e),e.flags|=1,Jn(t,e,n,i),e.child)}function fS(t,e,n,r,i){if(Cr(n)){var o=!0;Dh(e)}else o=!1;if(Kl(e,i),e.stateNode===null)$f(t,e),kk(e,n,r),gv(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=ri(c):(c=Cr(n)?Ya:Wn.current,c=fc(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&sS(e,s,r,c),Ls=!1;var f=e.memoizedState;s.state=f,Vh(e,r,s,i),l=e.memoizedState,a!==r||f!==l||yr.current||Ls?(typeof u=="function"&&(pv(e,n,u,r),l=e.memoizedState),(a=Ls||oS(e,n,a,r,f,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,ik(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:di(e.type,a),s.props=c,d=e.pendingProps,f=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=ri(l):(l=Cr(n)?Ya:Wn.current,l=fc(e,l));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||f!==l)&&sS(e,s,r,l),Ls=!1,f=e.memoizedState,s.state=f,Vh(e,r,s,i);var p=e.memoizedState;a!==d||f!==p||yr.current||Ls?(typeof h=="function"&&(pv(e,n,h,r),p=e.memoizedState),(c=Ls||oS(e,n,c,r,f,p,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return yv(t,e,n,r,o,i)}function yv(t,e,n,r,i,o){Pk(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&YI(e,n,!1),ps(t,e,o);r=e.stateNode,BO.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=pc(e,t.child,null,o),e.child=pc(e,null,a,o)):Jn(t,e,a,o),e.memoizedState=r.state,i&&YI(e,n,!0),e.child}function Nk(t){var e=t.stateNode;e.pendingContext?JI(t,e.pendingContext,e.pendingContext!==e.context):e.context&&JI(t,e.context,!1),Ry(t,e.containerInfo)}function hS(t,e,n,r,i){return hc(),by(i),e.flags|=256,Jn(t,e,n,r),e.child}var Cv={dehydrated:null,treeContext:null,retryLane:0};function Iv(t){return{baseLanes:t,cachePool:null,transitions:null}}function _k(t,e,n){var r=e.pendingProps,i=Lt.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),yt(Lt,i&1),t===null)return fv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Wp(s,r,0,null),t=Ha(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Iv(n),e.memoizedState=Cv,t):Ly(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return FO(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ia(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=ia(a,o):(o=Ha(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?Iv(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Cv,r}return o=t.child,t=o.sibling,r=ia(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ly(t,e){return e=Wp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Sf(t,e,n,r){return r!==null&&by(r),pc(e,t.child,null,n),t=Ly(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function FO(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=jg(Error(le(422))),Sf(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Wp({mode:"visible",children:r.children},i,0,null),o=Ha(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&pc(e,t.child,null,s),e.child.memoizedState=Iv(s),e.memoizedState=Cv,o);if(!(e.mode&1))return Sf(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(le(419)),r=jg(o,r,void 0),Sf(t,e,s,r)}if(a=(s&t.childLanes)!==0,mr||a){if(r=mn,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,hs(t,i),_i(r,t,i,-1))}return Wy(),r=jg(Error(le(421))),Sf(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=YO.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Ur=ea(i.nextSibling),Gr=e,Nt=!0,wi=null,t!==null&&(Jr[Yr++]=Do,Jr[Yr++]=Lo,Jr[Yr++]=Qa,Do=t.id,Lo=t.overflow,Qa=e),e=Ly(e,r.children),e.flags|=4096,e)}function pS(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),hv(t.return,e,n)}function Zg(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Ok(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Jn(t,e,r.children,n),r=Lt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&pS(t,n,e);else if(t.tag===19)pS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(yt(Lt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Gh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Zg(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Gh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Zg(e,!0,n,null,o);break;case"together":Zg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $f(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ps(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),el|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(le(153));if(e.child!==null){for(t=e.child,n=ia(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ia(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function UO(t,e,n){switch(e.tag){case 3:Nk(e),hc();break;case 5:ok(e);break;case 1:Cr(e.type)&&Dh(e);break;case 4:Ry(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;yt(Fh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(yt(Lt,Lt.current&1),e.flags|=128,null):n&e.child.childLanes?_k(t,e,n):(yt(Lt,Lt.current&1),t=ps(t,e,n),t!==null?t.sibling:null);yt(Lt,Lt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Ok(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),yt(Lt,Lt.current),r)break;return null;case 22:case 23:return e.lanes=0,xk(t,e,n)}return ps(t,e,n)}var Mk,Sv,Dk,Lk;Mk=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Sv=function(){};Dk=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ba(mo.current);var o=null;switch(n){case"input":i=jm(t,i),r=jm(t,r),o=[];break;case"select":i=Ft({},i,{value:void 0}),r=Ft({},r,{value:void 0}),o=[];break;case"textarea":i=zm(t,i),r=zm(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Oh)}$m(n,r);var s;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Qu.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Qu.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&St("scroll",t),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};Lk=function(t,e,n,r){n!==r&&(e.flags|=4)};function iu(t,e){if(!Nt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ln(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function VO(t,e,n){var r=e.pendingProps;switch(Sy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ln(e),null;case 1:return Cr(e.type)&&Mh(),Ln(e),null;case 3:return r=e.stateNode,gc(),Et(yr),Et(Wn),Py(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Cf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wi!==null&&(xv(wi),wi=null))),Sv(t,e),Ln(e),null;case 5:xy(e);var i=Ba(ud.current);if(n=e.type,t!==null&&e.stateNode!=null)Dk(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(le(166));return Ln(e),null}if(t=Ba(mo.current),Cf(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Ki]=e,r[ld]=o,t=(e.mode&1)!==0,n){case"dialog":St("cancel",r),St("close",r);break;case"iframe":case"object":case"embed":St("load",r);break;case"video":case"audio":for(i=0;i<Au.length;i++)St(Au[i],r);break;case"source":St("error",r);break;case"img":case"image":case"link":St("error",r),St("load",r);break;case"details":St("toggle",r);break;case"input":wI(r,o),St("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},St("invalid",r);break;case"textarea":kI(r,o),St("invalid",r)}$m(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&yf(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&yf(r.textContent,a,t),i=["children",""+a]):Qu.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&St("scroll",r)}switch(n){case"input":uf(r),AI(r,o,!0);break;case"textarea":uf(r),EI(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Oh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=u1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[Ki]=e,t[ld]=r,Mk(t,e,!1,!1),e.stateNode=t;e:{switch(s=Km(n,r),n){case"dialog":St("cancel",t),St("close",t),i=r;break;case"iframe":case"object":case"embed":St("load",t),i=r;break;case"video":case"audio":for(i=0;i<Au.length;i++)St(Au[i],t);i=r;break;case"source":St("error",t),i=r;break;case"img":case"image":case"link":St("error",t),St("load",t),i=r;break;case"details":St("toggle",t),i=r;break;case"input":wI(t,r),i=jm(t,r),St("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ft({},r,{value:void 0}),St("invalid",t);break;case"textarea":kI(t,r),i=zm(t,r),St("invalid",t);break;default:i=r}$m(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?h1(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&d1(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&qu(t,l):typeof l=="number"&&qu(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Qu.hasOwnProperty(o)?l!=null&&o==="onScroll"&&St("scroll",t):l!=null&&sy(t,o,l,s))}switch(n){case"input":uf(t),AI(t,r,!1);break;case"textarea":uf(t),EI(t);break;case"option":r.value!=null&&t.setAttribute("value",""+aa(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Hl(t,!!r.multiple,o,!1):r.defaultValue!=null&&Hl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Oh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ln(e),null;case 6:if(t&&e.stateNode!=null)Lk(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(le(166));if(n=Ba(ud.current),Ba(mo.current),Cf(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ki]=e,(o=r.nodeValue!==n)&&(t=Gr,t!==null))switch(t.tag){case 3:yf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&yf(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ki]=e,e.stateNode=r}return Ln(e),null;case 13:if(Et(Lt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Nt&&Ur!==null&&e.mode&1&&!(e.flags&128))ek(),hc(),e.flags|=98560,o=!1;else if(o=Cf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(le(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(le(317));o[Ki]=e}else hc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ln(e),o=!1}else wi!==null&&(xv(wi),wi=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Lt.current&1?ln===0&&(ln=3):Wy())),e.updateQueue!==null&&(e.flags|=4),Ln(e),null);case 4:return gc(),Sv(t,e),t===null&&sd(e.stateNode.containerInfo),Ln(e),null;case 10:return ky(e.type._context),Ln(e),null;case 17:return Cr(e.type)&&Mh(),Ln(e),null;case 19:if(Et(Lt),o=e.memoizedState,o===null)return Ln(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)iu(o,!1);else{if(ln!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Gh(t),s!==null){for(e.flags|=128,iu(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return yt(Lt,Lt.current&1|2),e.child}t=t.sibling}o.tail!==null&&$t()>vc&&(e.flags|=128,r=!0,iu(o,!1),e.lanes=4194304)}else{if(!r)if(t=Gh(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),iu(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Nt)return Ln(e),null}else 2*$t()-o.renderingStartTime>vc&&n!==1073741824&&(e.flags|=128,r=!0,iu(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=$t(),e.sibling=null,n=Lt.current,yt(Lt,r?n&1|2:n&1),e):(Ln(e),null);case 22:case 23:return Gy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?_r&1073741824&&(Ln(e),e.subtreeFlags&6&&(e.flags|=8192)):Ln(e),null;case 24:return null;case 25:return null}throw Error(le(156,e.tag))}function GO(t,e){switch(Sy(e),e.tag){case 1:return Cr(e.type)&&Mh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return gc(),Et(yr),Et(Wn),Py(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return xy(e),null;case 13:if(Et(Lt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(le(340));hc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Et(Lt),null;case 4:return gc(),null;case 10:return ky(e.type._context),null;case 22:case 23:return Gy(),null;case 24:return null;default:return null}}var bf=!1,Fn=!1,WO=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function Fl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Wt(t,e,r)}else n.current=null}function bv(t,e,n){try{n()}catch(r){Wt(t,e,r)}}var gS=!1;function jO(t,e){if(ov=Ph,t=G1(),Cy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=t,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++c===i&&(a=s),f===o&&++u===r&&(l=s),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(sv={focusedElem:t,selectionRange:n},Ph=!1,Ie=e;Ie!==null;)if(e=Ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ie=t;else for(;Ie!==null;){e=Ie;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,C=p.memoizedState,m=e.stateNode,v=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:di(e.type,g),C);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(E){Wt(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,Ie=t;break}Ie=e.return}return p=gS,gS=!1,p}function Wu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&bv(e,n,o)}i=i.next}while(i!==r)}}function Vp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function wv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Bk(t){var e=t.alternate;e!==null&&(t.alternate=null,Bk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ki],delete e[ld],delete e[cv],delete e[kO],delete e[EO])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Fk(t){return t.tag===5||t.tag===3||t.tag===4}function mS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Fk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Av(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Oh));else if(r!==4&&(t=t.child,t!==null))for(Av(t,e,n),t=t.sibling;t!==null;)Av(t,e,n),t=t.sibling}function kv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(kv(t,e,n),t=t.sibling;t!==null;)kv(t,e,n),t=t.sibling}var Sn=null,Ii=!1;function As(t,e,n){for(n=n.child;n!==null;)Uk(t,e,n),n=n.sibling}function Uk(t,e,n){if(go&&typeof go.onCommitFiberUnmount=="function")try{go.onCommitFiberUnmount(_p,n)}catch{}switch(n.tag){case 5:Fn||Fl(n,e);case 6:var r=Sn,i=Ii;Sn=null,As(t,e,n),Sn=r,Ii=i,Sn!==null&&(Ii?(t=Sn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Sn.removeChild(n.stateNode));break;case 18:Sn!==null&&(Ii?(t=Sn,n=n.stateNode,t.nodeType===8?Bg(t.parentNode,n):t.nodeType===1&&Bg(t,n),rd(t)):Bg(Sn,n.stateNode));break;case 4:r=Sn,i=Ii,Sn=n.stateNode.containerInfo,Ii=!0,As(t,e,n),Sn=r,Ii=i;break;case 0:case 11:case 14:case 15:if(!Fn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&bv(n,e,s),i=i.next}while(i!==r)}As(t,e,n);break;case 1:if(!Fn&&(Fl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Wt(n,e,a)}As(t,e,n);break;case 21:As(t,e,n);break;case 22:n.mode&1?(Fn=(r=Fn)||n.memoizedState!==null,As(t,e,n),Fn=r):As(t,e,n);break;default:As(t,e,n)}}function vS(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new WO),e.forEach(function(r){var i=QO.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ai(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:Sn=a.stateNode,Ii=!1;break e;case 3:Sn=a.stateNode.containerInfo,Ii=!0;break e;case 4:Sn=a.stateNode.containerInfo,Ii=!0;break e}a=a.return}if(Sn===null)throw Error(le(160));Uk(o,s,i),Sn=null,Ii=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Wt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Vk(e,t),e=e.sibling}function Vk(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ai(e,t),ji(t),r&4){try{Wu(3,t,t.return),Vp(3,t)}catch(g){Wt(t,t.return,g)}try{Wu(5,t,t.return)}catch(g){Wt(t,t.return,g)}}break;case 1:ai(e,t),ji(t),r&512&&n!==null&&Fl(n,n.return);break;case 5:if(ai(e,t),ji(t),r&512&&n!==null&&Fl(n,n.return),t.flags&32){var i=t.stateNode;try{qu(i,"")}catch(g){Wt(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&l1(i,o),Km(a,s);var c=Km(a,o);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?h1(i,d):u==="dangerouslySetInnerHTML"?d1(i,d):u==="children"?qu(i,d):sy(i,u,d,c)}switch(a){case"input":Zm(i,o);break;case"textarea":c1(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?Hl(i,!!o.multiple,h,!1):f!==!!o.multiple&&(o.defaultValue!=null?Hl(i,!!o.multiple,o.defaultValue,!0):Hl(i,!!o.multiple,o.multiple?[]:"",!1))}i[ld]=o}catch(g){Wt(t,t.return,g)}}break;case 6:if(ai(e,t),ji(t),r&4){if(t.stateNode===null)throw Error(le(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(g){Wt(t,t.return,g)}}break;case 3:if(ai(e,t),ji(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{rd(e.containerInfo)}catch(g){Wt(t,t.return,g)}break;case 4:ai(e,t),ji(t);break;case 13:ai(e,t),ji(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Uy=$t())),r&4&&vS(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Fn=(c=Fn)||u,ai(e,t),Fn=c):ai(e,t),ji(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Ie=t,u=t.child;u!==null;){for(d=Ie=u;Ie!==null;){switch(f=Ie,h=f.child,f.tag){case 0:case 11:case 14:case 15:Wu(4,f,f.return);break;case 1:Fl(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){Wt(r,n,g)}}break;case 5:Fl(f,f.return);break;case 22:if(f.memoizedState!==null){CS(d);continue}}h!==null?(h.return=f,Ie=h):CS(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=f1("display",s))}catch(g){Wt(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Wt(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ai(e,t),ji(t),r&4&&vS(t);break;case 21:break;default:ai(e,t),ji(t)}}function ji(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Fk(n)){var r=n;break e}n=n.return}throw Error(le(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(qu(i,""),r.flags&=-33);var o=mS(t);kv(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=mS(t);Av(t,a,s);break;default:throw Error(le(161))}}catch(l){Wt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ZO(t,e,n){Ie=t,Gk(t)}function Gk(t,e,n){for(var r=(t.mode&1)!==0;Ie!==null;){var i=Ie,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||bf;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Fn;a=bf;var c=Fn;if(bf=s,(Fn=l)&&!c)for(Ie=i;Ie!==null;)s=Ie,l=s.child,s.tag===22&&s.memoizedState!==null?IS(i):l!==null?(l.return=s,Ie=l):IS(i);for(;o!==null;)Ie=o,Gk(o),o=o.sibling;Ie=i,bf=a,Fn=c}yS(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Ie=o):yS(t)}}function yS(t){for(;Ie!==null;){var e=Ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Fn||Vp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Fn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:di(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&nS(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}nS(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&rd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}Fn||e.flags&512&&wv(e)}catch(f){Wt(e,e.return,f)}}if(e===t){Ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ie=n;break}Ie=e.return}}function CS(t){for(;Ie!==null;){var e=Ie;if(e===t){Ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ie=n;break}Ie=e.return}}function IS(t){for(;Ie!==null;){var e=Ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Vp(4,e)}catch(l){Wt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Wt(e,i,l)}}var o=e.return;try{wv(e)}catch(l){Wt(e,o,l)}break;case 5:var s=e.return;try{wv(e)}catch(l){Wt(e,s,l)}}}catch(l){Wt(e,e.return,l)}if(e===t){Ie=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ie=a;break}Ie=e.return}}var HO=Math.ceil,Zh=Is.ReactCurrentDispatcher,By=Is.ReactCurrentOwner,ni=Is.ReactCurrentBatchConfig,Qe=0,mn=null,en=null,En=0,_r=0,Ul=pa(0),ln=0,pd=null,el=0,Gp=0,Fy=0,ju=null,hr=null,Uy=0,vc=1/0,Ro=null,Hh=!1,Ev=null,na=null,wf=!1,Ws=null,zh=0,Zu=0,Tv=null,Kf=-1,Jf=0;function rr(){return Qe&6?$t():Kf!==-1?Kf:Kf=$t()}function ra(t){return t.mode&1?Qe&2&&En!==0?En&-En:RO.transition!==null?(Jf===0&&(Jf=k1()),Jf):(t=lt,t!==0||(t=window.event,t=t===void 0?16:_1(t.type)),t):1}function _i(t,e,n,r){if(50<Zu)throw Zu=0,Tv=null,Error(le(185));Ud(t,n,r),(!(Qe&2)||t!==mn)&&(t===mn&&(!(Qe&2)&&(Gp|=n),ln===4&&Us(t,En)),Ir(t,r),n===1&&Qe===0&&!(e.mode&1)&&(vc=$t()+500,Bp&&ga()))}function Ir(t,e){var n=t.callbackNode;R_(t,e);var r=xh(t,t===mn?En:0);if(r===0)n!==null&&xI(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&xI(n),e===1)t.tag===0?TO(SS.bind(null,t)):Y1(SS.bind(null,t)),wO(function(){!(Qe&6)&&ga()}),n=null;else{switch(E1(r)){case 1:n=dy;break;case 4:n=w1;break;case 16:n=Rh;break;case 536870912:n=A1;break;default:n=Rh}n=Kk(n,Wk.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Wk(t,e){if(Kf=-1,Jf=0,Qe&6)throw Error(le(327));var n=t.callbackNode;if(Jl()&&t.callbackNode!==n)return null;var r=xh(t,t===mn?En:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Xh(t,r);else{e=r;var i=Qe;Qe|=2;var o=Zk();(mn!==t||En!==e)&&(Ro=null,vc=$t()+500,Za(t,e));do try{$O();break}catch(a){jk(t,a)}while(!0);Ay(),Zh.current=o,Qe=i,en!==null?e=0:(mn=null,En=0,e=ln)}if(e!==0){if(e===2&&(i=ev(t),i!==0&&(r=i,e=Rv(t,i))),e===1)throw n=pd,Za(t,0),Us(t,r),Ir(t,$t()),n;if(e===6)Us(t,r);else{if(i=t.current.alternate,!(r&30)&&!zO(i)&&(e=Xh(t,r),e===2&&(o=ev(t),o!==0&&(r=o,e=Rv(t,o))),e===1))throw n=pd,Za(t,0),Us(t,r),Ir(t,$t()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(le(345));case 2:Ta(t,hr,Ro);break;case 3:if(Us(t,r),(r&130023424)===r&&(e=Uy+500-$t(),10<e)){if(xh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){rr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=lv(Ta.bind(null,t,hr,Ro),e);break}Ta(t,hr,Ro);break;case 4:if(Us(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-Ni(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=$t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*HO(r/1960))-r,10<r){t.timeoutHandle=lv(Ta.bind(null,t,hr,Ro),r);break}Ta(t,hr,Ro);break;case 5:Ta(t,hr,Ro);break;default:throw Error(le(329))}}}return Ir(t,$t()),t.callbackNode===n?Wk.bind(null,t):null}function Rv(t,e){var n=ju;return t.current.memoizedState.isDehydrated&&(Za(t,e).flags|=256),t=Xh(t,e),t!==2&&(e=hr,hr=n,e!==null&&xv(e)),t}function xv(t){hr===null?hr=t:hr.push.apply(hr,t)}function zO(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Mi(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Us(t,e){for(e&=~Fy,e&=~Gp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ni(e),r=1<<n;t[n]=-1,e&=~r}}function SS(t){if(Qe&6)throw Error(le(327));Jl();var e=xh(t,0);if(!(e&1))return Ir(t,$t()),null;var n=Xh(t,e);if(t.tag!==0&&n===2){var r=ev(t);r!==0&&(e=r,n=Rv(t,r))}if(n===1)throw n=pd,Za(t,0),Us(t,e),Ir(t,$t()),n;if(n===6)throw Error(le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ta(t,hr,Ro),Ir(t,$t()),null}function Vy(t,e){var n=Qe;Qe|=1;try{return t(e)}finally{Qe=n,Qe===0&&(vc=$t()+500,Bp&&ga())}}function tl(t){Ws!==null&&Ws.tag===0&&!(Qe&6)&&Jl();var e=Qe;Qe|=1;var n=ni.transition,r=lt;try{if(ni.transition=null,lt=1,t)return t()}finally{lt=r,ni.transition=n,Qe=e,!(Qe&6)&&ga()}}function Gy(){_r=Ul.current,Et(Ul)}function Za(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,bO(n)),en!==null)for(n=en.return;n!==null;){var r=n;switch(Sy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Mh();break;case 3:gc(),Et(yr),Et(Wn),Py();break;case 5:xy(r);break;case 4:gc();break;case 13:Et(Lt);break;case 19:Et(Lt);break;case 10:ky(r.type._context);break;case 22:case 23:Gy()}n=n.return}if(mn=t,en=t=ia(t.current,null),En=_r=e,ln=0,pd=null,Fy=Gp=el=0,hr=ju=null,La!==null){for(e=0;e<La.length;e++)if(n=La[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}La=null}return t}function jk(t,e){do{var n=en;try{if(Ay(),zf.current=jh,Wh){for(var r=Bt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Wh=!1}if(qa=0,pn=an=Bt=null,Gu=!1,dd=0,By.current=null,n===null||n.return===null){ln=1,pd=e,en=null;break}e:{var o=t,s=n.return,a=n,l=e;if(e=En,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=lS(s);if(h!==null){h.flags&=-257,cS(h,s,a,o,e),h.mode&1&&aS(o,c,e),e=h,l=c;var p=e.updateQueue;if(p===null){var g=new Set;g.add(l),e.updateQueue=g}else p.add(l);break e}else{if(!(e&1)){aS(o,c,e),Wy();break e}l=Error(le(426))}}else if(Nt&&a.mode&1){var C=lS(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),cS(C,s,a,o,e),by(mc(l,a));break e}}o=l=mc(l,a),ln!==4&&(ln=2),ju===null?ju=[o]:ju.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var m=Ek(o,l,e);tS(o,m);break e;case 1:a=l;var v=o.type,S=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(na===null||!na.has(S)))){o.flags|=65536,e&=-e,o.lanes|=e;var E=Tk(o,a,e);tS(o,E);break e}}o=o.return}while(o!==null)}zk(n)}catch(w){e=w,en===n&&n!==null&&(en=n=n.return);continue}break}while(!0)}function Zk(){var t=Zh.current;return Zh.current=jh,t===null?jh:t}function Wy(){(ln===0||ln===3||ln===2)&&(ln=4),mn===null||!(el&268435455)&&!(Gp&268435455)||Us(mn,En)}function Xh(t,e){var n=Qe;Qe|=2;var r=Zk();(mn!==t||En!==e)&&(Ro=null,Za(t,e));do try{XO();break}catch(i){jk(t,i)}while(!0);if(Ay(),Qe=n,Zh.current=r,en!==null)throw Error(le(261));return mn=null,En=0,ln}function XO(){for(;en!==null;)Hk(en)}function $O(){for(;en!==null&&!C_();)Hk(en)}function Hk(t){var e=$k(t.alternate,t,_r);t.memoizedProps=t.pendingProps,e===null?zk(t):en=e,By.current=null}function zk(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=GO(n,e),n!==null){n.flags&=32767,en=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ln=6,en=null;return}}else if(n=VO(n,e,_r),n!==null){en=n;return}if(e=e.sibling,e!==null){en=e;return}en=e=t}while(e!==null);ln===0&&(ln=5)}function Ta(t,e,n){var r=lt,i=ni.transition;try{ni.transition=null,lt=1,KO(t,e,n,r)}finally{ni.transition=i,lt=r}return null}function KO(t,e,n,r){do Jl();while(Ws!==null);if(Qe&6)throw Error(le(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(le(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(x_(t,o),t===mn&&(en=mn=null,En=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||wf||(wf=!0,Kk(Rh,function(){return Jl(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=ni.transition,ni.transition=null;var s=lt;lt=1;var a=Qe;Qe|=4,By.current=null,jO(t,n),Vk(n,t),gO(sv),Ph=!!ov,sv=ov=null,t.current=n,ZO(n),I_(),Qe=a,lt=s,ni.transition=o}else t.current=n;if(wf&&(wf=!1,Ws=t,zh=i),o=t.pendingLanes,o===0&&(na=null),w_(n.stateNode),Ir(t,$t()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hh)throw Hh=!1,t=Ev,Ev=null,t;return zh&1&&t.tag!==0&&Jl(),o=t.pendingLanes,o&1?t===Tv?Zu++:(Zu=0,Tv=t):Zu=0,ga(),null}function Jl(){if(Ws!==null){var t=E1(zh),e=ni.transition,n=lt;try{if(ni.transition=null,lt=16>t?16:t,Ws===null)var r=!1;else{if(t=Ws,Ws=null,zh=0,Qe&6)throw Error(le(331));var i=Qe;for(Qe|=4,Ie=t.current;Ie!==null;){var o=Ie,s=o.child;if(Ie.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Ie=c;Ie!==null;){var u=Ie;switch(u.tag){case 0:case 11:case 15:Wu(8,u,o)}var d=u.child;if(d!==null)d.return=u,Ie=d;else for(;Ie!==null;){u=Ie;var f=u.sibling,h=u.return;if(Bk(u),u===c){Ie=null;break}if(f!==null){f.return=h,Ie=f;break}Ie=h}}}var p=o.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var C=g.sibling;g.sibling=null,g=C}while(g!==null)}}Ie=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,Ie=s;else e:for(;Ie!==null;){if(o=Ie,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Wu(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,Ie=m;break e}Ie=o.return}}var v=t.current;for(Ie=v;Ie!==null;){s=Ie;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,Ie=S;else e:for(s=v;Ie!==null;){if(a=Ie,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Vp(9,a)}}catch(w){Wt(a,a.return,w)}if(a===s){Ie=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,Ie=E;break e}Ie=a.return}}if(Qe=i,ga(),go&&typeof go.onPostCommitFiberRoot=="function")try{go.onPostCommitFiberRoot(_p,t)}catch{}r=!0}return r}finally{lt=n,ni.transition=e}}return!1}function bS(t,e,n){e=mc(n,e),e=Ek(t,e,1),t=ta(t,e,1),e=rr(),t!==null&&(Ud(t,1,e),Ir(t,e))}function Wt(t,e,n){if(t.tag===3)bS(t,t,n);else for(;e!==null;){if(e.tag===3){bS(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(na===null||!na.has(r))){t=mc(n,t),t=Tk(e,t,1),e=ta(e,t,1),t=rr(),e!==null&&(Ud(e,1,t),Ir(e,t));break}}e=e.return}}function JO(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=rr(),t.pingedLanes|=t.suspendedLanes&n,mn===t&&(En&n)===n&&(ln===4||ln===3&&(En&130023424)===En&&500>$t()-Uy?Za(t,0):Fy|=n),Ir(t,e)}function Xk(t,e){e===0&&(t.mode&1?(e=hf,hf<<=1,!(hf&130023424)&&(hf=4194304)):e=1);var n=rr();t=hs(t,e),t!==null&&(Ud(t,e,n),Ir(t,n))}function YO(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Xk(t,n)}function QO(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(le(314))}r!==null&&r.delete(e),Xk(t,n)}var $k;$k=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||yr.current)mr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return mr=!1,UO(t,e,n);mr=!!(t.flags&131072)}else mr=!1,Nt&&e.flags&1048576&&Q1(e,Bh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;$f(t,e),t=e.pendingProps;var i=fc(e,Wn.current);Kl(e,n),i=_y(null,e,r,t,i,n);var o=Oy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Cr(r)?(o=!0,Dh(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Ty(e),i.updater=Up,e.stateNode=i,i._reactInternals=e,gv(e,r,t,n),e=yv(null,e,r,!0,o,n)):(e.tag=0,Nt&&o&&Iy(e),Jn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch($f(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=eM(r),t=di(r,t),i){case 0:e=vv(null,e,r,t,n);break e;case 1:e=fS(null,e,r,t,n);break e;case 11:e=uS(null,e,r,t,n);break e;case 14:e=dS(null,e,r,di(r.type,t),n);break e}throw Error(le(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:di(r,i),vv(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:di(r,i),fS(t,e,r,i,n);case 3:e:{if(Nk(e),t===null)throw Error(le(387));r=e.pendingProps,o=e.memoizedState,i=o.element,ik(t,e),Vh(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=mc(Error(le(423)),e),e=hS(t,e,r,n,i);break e}else if(r!==i){i=mc(Error(le(424)),e),e=hS(t,e,r,n,i);break e}else for(Ur=ea(e.stateNode.containerInfo.firstChild),Gr=e,Nt=!0,wi=null,n=nk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(hc(),r===i){e=ps(t,e,n);break e}Jn(t,e,r,n)}e=e.child}return e;case 5:return ok(e),t===null&&fv(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,av(r,i)?s=null:o!==null&&av(r,o)&&(e.flags|=32),Pk(t,e),Jn(t,e,s,n),e.child;case 6:return t===null&&fv(e),null;case 13:return _k(t,e,n);case 4:return Ry(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=pc(e,null,r,n):Jn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:di(r,i),uS(t,e,r,i,n);case 7:return Jn(t,e,e.pendingProps,n),e.child;case 8:return Jn(t,e,e.pendingProps.children,n),e.child;case 12:return Jn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,yt(Fh,r._currentValue),r._currentValue=s,o!==null)if(Mi(o.value,s)){if(o.children===i.children&&!yr.current){e=ps(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=as(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),hv(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(le(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),hv(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Jn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Kl(e,n),i=ri(i),r=r(i),e.flags|=1,Jn(t,e,r,n),e.child;case 14:return r=e.type,i=di(r,e.pendingProps),i=di(r.type,i),dS(t,e,r,i,n);case 15:return Rk(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:di(r,i),$f(t,e),e.tag=1,Cr(r)?(t=!0,Dh(e)):t=!1,Kl(e,n),kk(e,r,i),gv(e,r,i,n),yv(null,e,r,!0,t,n);case 19:return Ok(t,e,n);case 22:return xk(t,e,n)}throw Error(le(156,e.tag))};function Kk(t,e){return b1(t,e)}function qO(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qr(t,e,n,r){return new qO(t,e,n,r)}function jy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function eM(t){if(typeof t=="function")return jy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ly)return 11;if(t===cy)return 14}return 2}function ia(t,e){var n=t.alternate;return n===null?(n=qr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Yf(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")jy(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case xl:return Ha(n.children,i,o,e);case ay:s=8,i|=8;break;case Um:return t=qr(12,n,e,i|2),t.elementType=Um,t.lanes=o,t;case Vm:return t=qr(13,n,e,i),t.elementType=Vm,t.lanes=o,t;case Gm:return t=qr(19,n,e,i),t.elementType=Gm,t.lanes=o,t;case o1:return Wp(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case r1:s=10;break e;case i1:s=9;break e;case ly:s=11;break e;case cy:s=14;break e;case Ds:s=16,r=null;break e}throw Error(le(130,t==null?t:typeof t,""))}return e=qr(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function Ha(t,e,n,r){return t=qr(7,t,r,e),t.lanes=n,t}function Wp(t,e,n,r){return t=qr(22,t,r,e),t.elementType=o1,t.lanes=n,t.stateNode={isHidden:!1},t}function Hg(t,e,n){return t=qr(6,t,null,e),t.lanes=n,t}function zg(t,e,n){return e=qr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function tM(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Eg(0),this.expirationTimes=Eg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Eg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Zy(t,e,n,r,i,o,s,a,l){return t=new tM(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=qr(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ty(o),t}function nM(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Rl,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Jk(t){if(!t)return la;t=t._reactInternals;e:{if(fl(t)!==t||t.tag!==1)throw Error(le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Cr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(le(171))}if(t.tag===1){var n=t.type;if(Cr(n))return J1(t,n,e)}return e}function Yk(t,e,n,r,i,o,s,a,l){return t=Zy(n,r,!0,t,i,o,s,a,l),t.context=Jk(null),n=t.current,r=rr(),i=ra(n),o=as(r,i),o.callback=e??null,ta(n,o,i),t.current.lanes=i,Ud(t,i,r),Ir(t,r),t}function jp(t,e,n,r){var i=e.current,o=rr(),s=ra(i);return n=Jk(n),e.context===null?e.context=n:e.pendingContext=n,e=as(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ta(i,e,s),t!==null&&(_i(t,i,s,o),Hf(t,i,s)),s}function $h(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Hy(t,e){wS(t,e),(t=t.alternate)&&wS(t,e)}function rM(){return null}var Qk=typeof reportError=="function"?reportError:function(t){console.error(t)};function zy(t){this._internalRoot=t}Zp.prototype.render=zy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(le(409));jp(t,e,null,null)};Zp.prototype.unmount=zy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;tl(function(){jp(null,t,null,null)}),e[fs]=null}};function Zp(t){this._internalRoot=t}Zp.prototype.unstable_scheduleHydration=function(t){if(t){var e=x1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Fs.length&&e!==0&&e<Fs[n].priority;n++);Fs.splice(n,0,t),n===0&&N1(t)}};function Xy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function AS(){}function iM(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=$h(s);o.call(c)}}var s=Yk(e,r,t,0,null,!1,!1,"",AS);return t._reactRootContainer=s,t[fs]=s.current,sd(t.nodeType===8?t.parentNode:t),tl(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=$h(l);a.call(c)}}var l=Zy(t,0,!1,null,null,!1,!1,"",AS);return t._reactRootContainer=l,t[fs]=l.current,sd(t.nodeType===8?t.parentNode:t),tl(function(){jp(e,l,n,r)}),l}function zp(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=$h(s);a.call(l)}}jp(e,s,t,i)}else s=iM(n,e,t,i,r);return $h(s)}T1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=wu(e.pendingLanes);n!==0&&(fy(e,n|1),Ir(e,$t()),!(Qe&6)&&(vc=$t()+500,ga()))}break;case 13:tl(function(){var r=hs(t,1);if(r!==null){var i=rr();_i(r,t,1,i)}}),Hy(t,1)}};hy=function(t){if(t.tag===13){var e=hs(t,134217728);if(e!==null){var n=rr();_i(e,t,134217728,n)}Hy(t,134217728)}};R1=function(t){if(t.tag===13){var e=ra(t),n=hs(t,e);if(n!==null){var r=rr();_i(n,t,e,r)}Hy(t,e)}};x1=function(){return lt};P1=function(t,e){var n=lt;try{return lt=t,e()}finally{lt=n}};Ym=function(t,e,n){switch(e){case"input":if(Zm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Lp(r);if(!i)throw Error(le(90));a1(r),Zm(r,i)}}}break;case"textarea":c1(t,n);break;case"select":e=n.value,e!=null&&Hl(t,!!n.multiple,e,!1)}};m1=Vy;v1=tl;var oM={usingClientEntryPoint:!1,Events:[Gd,Ol,Lp,p1,g1,Vy]},ou={findFiberByHostInstance:Da,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sM={bundleType:ou.bundleType,version:ou.version,rendererPackageName:ou.rendererPackageName,rendererConfig:ou.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Is.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=I1(t),t===null?null:t.stateNode},findFiberByHostInstance:ou.findFiberByHostInstance||rM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Af=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Af.isDisabled&&Af.supportsFiber)try{_p=Af.inject(sM),go=Af}catch{}}zr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oM;zr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xy(e))throw Error(le(200));return nM(t,e,null,n)};zr.createRoot=function(t,e){if(!Xy(t))throw Error(le(299));var n=!1,r="",i=Qk;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Zy(t,1,!1,null,null,n,!1,r,i),t[fs]=e.current,sd(t.nodeType===8?t.parentNode:t),new zy(e)};zr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(le(188)):(t=Object.keys(t).join(","),Error(le(268,t)));return t=I1(e),t=t===null?null:t.stateNode,t};zr.flushSync=function(t){return tl(t)};zr.hydrate=function(t,e,n){if(!Hp(e))throw Error(le(200));return zp(null,t,e,!0,n)};zr.hydrateRoot=function(t,e,n){if(!Xy(t))throw Error(le(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=Qk;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=Yk(e,null,t,1,n??null,i,!1,o,s),t[fs]=e.current,sd(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Zp(e)};zr.render=function(t,e,n){if(!Hp(e))throw Error(le(200));return zp(null,t,e,!1,n)};zr.unmountComponentAtNode=function(t){if(!Hp(t))throw Error(le(40));return t._reactRootContainer?(tl(function(){zp(null,null,t,!1,function(){t._reactRootContainer=null,t[fs]=null})}),!0):!1};zr.unstable_batchedUpdates=Vy;zr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hp(n))throw Error(le(200));if(t==null||t._reactInternals===void 0)throw Error(le(38));return zp(t,e,n,!1,r)};zr.version="18.3.1-next-f1338f8080-20240426";function qk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qk)}catch(t){console.error(t)}}qk(),qA.exports=zr;var $y=qA.exports;const aM=Bd($y),lM=GA({__proto__:null,default:aM},[$y]);var kS=$y;Bm.createRoot=kS.createRoot,Bm.hydrateRoot=kS.hydrateRoot;/**
 * @remix-run/router v1.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dt(){return Dt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Dt.apply(this,arguments)}var qt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(qt||(qt={}));const ES="popstate";function cM(t){t===void 0&&(t={});function e(r,i){let{pathname:o,search:s,hash:a}=r.location;return gd("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:jd(i)}return dM(e,n,null,t)}function Ke(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function yc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function uM(){return Math.random().toString(36).substr(2,8)}function TS(t,e){return{usr:t.state,key:t.key,idx:e}}function gd(t,e,n,r){return n===void 0&&(n=null),Dt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ma(e):e,{state:n,key:e&&e.key||r||uM()})}function jd(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ma(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function dM(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,a=qt.Pop,l=null,c=u();c==null&&(c=0,s.replaceState(Dt({},s.state,{idx:c}),""));function u(){return(s.state||{idx:null}).idx}function d(){a=qt.Pop;let C=u(),m=C==null?null:C-c;c=C,l&&l({action:a,location:g.location,delta:m})}function f(C,m){a=qt.Push;let v=gd(g.location,C,m);c=u()+1;let S=TS(v,c),E=g.createHref(v);try{s.pushState(S,"",E)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;i.location.assign(E)}o&&l&&l({action:a,location:g.location,delta:1})}function h(C,m){a=qt.Replace;let v=gd(g.location,C,m);c=u();let S=TS(v,c),E=g.createHref(v);s.replaceState(S,"",E),o&&l&&l({action:a,location:g.location,delta:0})}function p(C){let m=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof C=="string"?C:jd(C);return v=v.replace(/ $/,"%20"),Ke(m,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,m)}let g={get action(){return a},get location(){return t(i,s)},listen(C){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(ES,d),l=C,()=>{i.removeEventListener(ES,d),l=null}},createHref(C){return e(i,C)},createURL:p,encodeLocation(C){let m=p(C);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:f,replace:h,go(C){return s.go(C)}};return g}var mt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(mt||(mt={}));const fM=new Set(["lazy","caseSensitive","path","id","index","children"]);function hM(t){return t.index===!0}function md(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((i,o)=>{let s=[...n,String(o)],a=typeof i.id=="string"?i.id:s.join("-");if(Ke(i.index!==!0||!i.children,"Cannot specify children on an index route"),Ke(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),hM(i)){let l=Dt({},i,e(i),{id:a});return r[a]=l,l}else{let l=Dt({},i,e(i),{id:a,children:void 0});return r[a]=l,i.children&&(l.children=md(i.children,e,s,r)),l}})}function xa(t,e,n){return n===void 0&&(n="/"),Qf(t,e,n,!1)}function Qf(t,e,n,r){let i=typeof e=="string"?ma(e):e,o=Zd(i.pathname||"/",n);if(o==null)return null;let s=eE(t);gM(s);let a=null;for(let l=0;a==null&&l<s.length;++l){let c=EM(o);a=AM(s[l],c,r)}return a}function pM(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function eE(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(o,s,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};l.relativePath.startsWith("/")&&(Ke(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=za([r,l.relativePath]),u=n.concat(l);o.children&&o.children.length>0&&(Ke(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),eE(o.children,e,u,c)),!(o.path==null&&!o.index)&&e.push({path:c,score:bM(c,o.index),routesMeta:u})};return t.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let l of tE(o.path))i(o,s,l)}),e}function tE(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let s=tE(r.join("/")),a=[];return a.push(...s.map(l=>l===""?o:[o,l].join("/"))),i&&a.push(...s),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function gM(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:wM(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const mM=/^:[\w-]+$/,vM=3,yM=2,CM=1,IM=10,SM=-2,RS=t=>t==="*";function bM(t,e){let n=t.split("/"),r=n.length;return n.some(RS)&&(r+=SM),e&&(r+=yM),n.filter(i=>!RS(i)).reduce((i,o)=>i+(mM.test(o)?vM:o===""?CM:IM),r)}function wM(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function AM(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,i={},o="/",s=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=o==="/"?e:e.slice(o.length)||"/",d=xS({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=xS({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),s.push({params:i,pathname:za([o,d.pathname]),pathnameBase:NM(za([o,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(o=za([o,d.pathnameBase]))}return s}function xS(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=kM(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,u,d)=>{let{paramName:f,isOptional:h}=u;if(f==="*"){let g=a[d]||"";s=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?c[f]=void 0:c[f]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:s,pattern:t}}function kM(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),yc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function EM(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return yc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Zd(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function TM(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?ma(t):t;return{pathname:n?n.startsWith("/")?n:RM(n,e):e,search:_M(r),hash:OM(i)}}function RM(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Xg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function nE(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function xM(t,e){let n=nE(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function PM(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=ma(t):(i=Dt({},t),Ke(!i.pathname||!i.pathname.includes("?"),Xg("?","pathname","search",i)),Ke(!i.pathname||!i.pathname.includes("#"),Xg("#","pathname","hash",i)),Ke(!i.search||!i.search.includes("#"),Xg("#","search","hash",i)));let o=t===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=n;else{let d=e.length-1;if(!r&&s.startsWith("..")){let f=s.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?e[d]:"/"}let l=TM(i,a),c=s&&s!=="/"&&s.endsWith("/"),u=(o||s===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const za=t=>t.join("/").replace(/\/\/+/g,"/"),NM=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),_M=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,OM=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Ky{constructor(e,n,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Xp(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const rE=["post","put","patch","delete"],MM=new Set(rE),DM=["get",...rE],LM=new Set(DM),BM=new Set([301,302,303,307,308]),FM=new Set([307,308]),$g={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},UM={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},su={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Jy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,VM=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),iE="remix-router-transitions";function GM(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;Ke(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let D=t.detectErrorBoundary;i=F=>({hasErrorBoundary:D(F)})}else i=VM;let o={},s=md(t.routes,i,void 0,o),a,l=t.basename||"/",c=t.unstable_dataStrategy||zM,u=t.unstable_patchRoutesOnMiss,d=Dt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,h=new Set,p=null,g=null,C=null,m=t.hydrationData!=null,v=xa(s,t.history.location,l),S=null;if(v==null&&!u){let D=Kn(404,{pathname:t.history.location.pathname}),{matches:F,route:H}=US(s);v=F,S={[H.id]:D}}v&&u&&!t.hydrationData&&yl(v,s,t.history.location.pathname).active&&(v=null);let E;if(!v)E=!1,v=[];else if(v.some(D=>D.route.lazy))E=!1;else if(!v.some(D=>D.route.loader))E=!0;else if(d.v7_partialHydration){let D=t.hydrationData?t.hydrationData.loaderData:null,F=t.hydrationData?t.hydrationData.errors:null,H=q=>q.route.loader?typeof q.route.loader=="function"&&q.route.loader.hydrate===!0?!1:D&&D[q.route.id]!==void 0||F&&F[q.route.id]!==void 0:!0;if(F){let q=v.findIndex(me=>F[me.route.id]!==void 0);E=v.slice(0,q+1).every(H)}else E=v.every(H)}else E=t.hydrationData!=null;let w,A={historyAction:t.history.action,location:t.history.location,matches:v,initialized:E,navigation:$g,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||S,fetchers:new Map,blockers:new Map},x=qt.Pop,T=!1,_,O=!1,L=new Map,U=null,z=!1,Z=!1,K=[],ee=[],re=new Map,X=0,J=-1,oe=new Map,W=new Set,se=new Map,we=new Map,De=new Set,de=new Map,xe=new Map,rt=new Map,Ce=!1;function tn(){if(f=t.history.listen(D=>{let{action:F,location:H,delta:q}=D;if(Ce){Ce=!1;return}yc(xe.size===0||q!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let me=rf({currentLocation:A.location,nextLocation:H,historyAction:F});if(me&&q!=null){Ce=!0,t.history.go(q*-1),Gi(me,{state:"blocked",location:H,proceed(){Gi(me,{state:"proceeding",proceed:void 0,reset:void 0,location:H}),t.history.go(q)},reset(){let ke=new Map(A.blockers);ke.set(me,su),$e({blockers:ke})}});return}return ve(F,H)}),n){oD(e,L);let D=()=>sD(e,L);e.addEventListener("pagehide",D),U=()=>e.removeEventListener("pagehide",D)}return A.initialized||ve(qt.Pop,A.location,{initialHydration:!0}),w}function vn(){f&&f(),U&&U(),h.clear(),_&&_.abort(),A.fetchers.forEach((D,F)=>B(F)),A.blockers.forEach((D,F)=>et(F))}function Zn(D){return h.add(D),()=>h.delete(D)}function $e(D,F){F===void 0&&(F={}),A=Dt({},A,D);let H=[],q=[];d.v7_fetcherPersist&&A.fetchers.forEach((me,ke)=>{me.state==="idle"&&(De.has(ke)?q.push(ke):H.push(ke))}),[...h].forEach(me=>me(A,{deletedFetchers:q,unstable_viewTransitionOpts:F.viewTransitionOpts,unstable_flushSync:F.flushSync===!0})),d.v7_fetcherPersist&&(H.forEach(me=>A.fetchers.delete(me)),q.forEach(me=>B(me)))}function Zt(D,F,H){var q,me;let{flushSync:ke}=H===void 0?{}:H,Pe=A.actionData!=null&&A.navigation.formMethod!=null&&Si(A.navigation.formMethod)&&A.navigation.state==="loading"&&((q=D.state)==null?void 0:q._isRedirect)!==!0,ce;F.actionData?Object.keys(F.actionData).length>0?ce=F.actionData:ce=null:Pe?ce=A.actionData:ce=null;let Le=F.loaderData?BS(A.loaderData,F.loaderData,F.matches||[],F.errors):A.loaderData,Te=A.blockers;Te.size>0&&(Te=new Map(Te),Te.forEach((st,ue)=>Te.set(ue,su)));let Re=T===!0||A.navigation.formMethod!=null&&Si(A.navigation.formMethod)&&((me=D.state)==null?void 0:me._isRedirect)!==!0;a&&(s=a,a=void 0),z||x===qt.Pop||(x===qt.Push?t.history.push(D,D.state):x===qt.Replace&&t.history.replace(D,D.state));let ot;if(x===qt.Pop){let st=L.get(A.location.pathname);st&&st.has(D.pathname)?ot={currentLocation:A.location,nextLocation:D}:L.has(D.pathname)&&(ot={currentLocation:D,nextLocation:A.location})}else if(O){let st=L.get(A.location.pathname);st?st.add(D.pathname):(st=new Set([D.pathname]),L.set(A.location.pathname,st)),ot={currentLocation:A.location,nextLocation:D}}$e(Dt({},F,{actionData:ce,loaderData:Le,historyAction:x,location:D,initialized:!0,navigation:$g,revalidation:"idle",restoreScrollPosition:Yc(D,F.matches||A.matches),preventScrollReset:Re,blockers:Te}),{viewTransitionOpts:ot,flushSync:ke===!0}),x=qt.Pop,T=!1,O=!1,z=!1,Z=!1,K=[],ee=[]}async function Jt(D,F){if(typeof D=="number"){t.history.go(D);return}let H=Pv(A.location,A.matches,l,d.v7_prependBasename,D,d.v7_relativeSplatPath,F==null?void 0:F.fromRouteId,F==null?void 0:F.relative),{path:q,submission:me,error:ke}=PS(d.v7_normalizeFormMethod,!1,H,F),Pe=A.location,ce=gd(A.location,q,F&&F.state);ce=Dt({},ce,t.history.encodeLocation(ce));let Le=F&&F.replace!=null?F.replace:void 0,Te=qt.Push;Le===!0?Te=qt.Replace:Le===!1||me!=null&&Si(me.formMethod)&&me.formAction===A.location.pathname+A.location.search&&(Te=qt.Replace);let Re=F&&"preventScrollReset"in F?F.preventScrollReset===!0:void 0,ot=(F&&F.unstable_flushSync)===!0,st=rf({currentLocation:Pe,nextLocation:ce,historyAction:Te});if(st){Gi(st,{state:"blocked",location:ce,proceed(){Gi(st,{state:"proceeding",proceed:void 0,reset:void 0,location:ce}),Jt(D,F)},reset(){let ue=new Map(A.blockers);ue.set(st,su),$e({blockers:ue})}});return}return await ve(Te,ce,{submission:me,pendingError:ke,preventScrollReset:Re,replace:F&&F.replace,enableViewTransition:F&&F.unstable_viewTransition,flushSync:ot})}function he(){if(k(),$e({revalidation:"loading"}),A.navigation.state!=="submitting"){if(A.navigation.state==="idle"){ve(A.historyAction,A.location,{startUninterruptedRevalidation:!0});return}ve(x||A.historyAction,A.navigation.location,{overrideNavigation:A.navigation})}}async function ve(D,F,H){_&&_.abort(),_=null,x=D,z=(H&&H.startUninterruptedRevalidation)===!0,Jc(A.location,A.matches),T=(H&&H.preventScrollReset)===!0,O=(H&&H.enableViewTransition)===!0;let q=a||s,me=H&&H.overrideNavigation,ke=xa(q,F,l),Pe=(H&&H.flushSync)===!0,ce=yl(ke,q,F.pathname);if(ce.active&&ce.matches&&(ke=ce.matches),!ke){let{error:M,notFoundMatches:ie,route:fe}=$c(F.pathname);Zt(F,{matches:ie,loaderData:{},errors:{[fe.id]:M}},{flushSync:Pe});return}if(A.initialized&&!Z&&QM(A.location,F)&&!(H&&H.submission&&Si(H.submission.formMethod))){Zt(F,{matches:ke},{flushSync:Pe});return}_=new AbortController;let Le=Sl(t.history,F,_.signal,H&&H.submission),Te;if(H&&H.pendingError)Te=[Vl(ke).route.id,{type:mt.error,error:H.pendingError}];else if(H&&H.submission&&Si(H.submission.formMethod)){let M=await Ge(Le,F,H.submission,ke,ce.active,{replace:H.replace,flushSync:Pe});if(M.shortCircuited)return;if(M.pendingActionResult){let[ie,fe]=M.pendingActionResult;if(Br(fe)&&Xp(fe.error)&&fe.error.status===404){_=null,Zt(F,{matches:M.matches,loaderData:{},errors:{[ie]:fe.error}});return}}ke=M.matches||ke,Te=M.pendingActionResult,me=Kg(F,H.submission),Pe=!1,ce.active=!1,Le=Sl(t.history,Le.url,Le.signal)}let{shortCircuited:Re,matches:ot,loaderData:st,errors:ue}=await We(Le,F,ke,ce.active,me,H&&H.submission,H&&H.fetcherSubmission,H&&H.replace,H&&H.initialHydration===!0,Pe,Te);Re||(_=null,Zt(F,Dt({matches:ot||ke},FS(Te),{loaderData:st,errors:ue})))}async function Ge(D,F,H,q,me,ke){ke===void 0&&(ke={}),k();let Pe=rD(F,H);if($e({navigation:Pe},{flushSync:ke.flushSync===!0}),me){let Te=await Cl(q,F.pathname,D.signal);if(Te.type==="aborted")return{shortCircuited:!0};if(Te.type==="error"){let{boundaryId:Re,error:ot}=Mt(F.pathname,Te);return{matches:Te.partialMatches,pendingActionResult:[Re,{type:mt.error,error:ot}]}}else if(Te.matches)q=Te.matches;else{let{notFoundMatches:Re,error:ot,route:st}=$c(F.pathname);return{matches:Re,pendingActionResult:[st.id,{type:mt.error,error:ot}]}}}let ce,Le=ku(q,F);if(!Le.route.action&&!Le.route.lazy)ce={type:mt.error,error:Kn(405,{method:D.method,pathname:F.pathname,routeId:Le.route.id})};else if(ce=(await Ot("action",D,[Le],q))[0],D.signal.aborted)return{shortCircuited:!0};if(Ua(ce)){let Te;return ke&&ke.replace!=null?Te=ke.replace:Te=MS(ce.response.headers.get("Location"),new URL(D.url),l)===A.location.pathname+A.location.search,await yn(D,ce,{submission:H,replace:Te}),{shortCircuited:!0}}if(Fa(ce))throw Kn(400,{type:"defer-action"});if(Br(ce)){let Te=Vl(q,Le.route.id);return(ke&&ke.replace)!==!0&&(x=qt.Push),{matches:q,pendingActionResult:[Te.route.id,ce]}}return{matches:q,pendingActionResult:[Le.route.id,ce]}}async function We(D,F,H,q,me,ke,Pe,ce,Le,Te,Re){let ot=me||Kg(F,ke),st=ke||Pe||WS(ot),ue=!z&&(!d.v7_partialHydration||!Le);if(q){if(ue){let Vt=Oe(Re);$e(Dt({navigation:ot},Vt!==void 0?{actionData:Vt}:{}),{flushSync:Te})}let Ve=await Cl(H,F.pathname,D.signal);if(Ve.type==="aborted")return{shortCircuited:!0};if(Ve.type==="error"){let{boundaryId:Vt,error:kr}=Mt(F.pathname,Ve);return{matches:Ve.partialMatches,loaderData:{},errors:{[Vt]:kr}}}else if(Ve.matches)H=Ve.matches;else{let{error:Vt,notFoundMatches:kr,route:xt}=$c(F.pathname);return{matches:kr,loaderData:{},errors:{[xt.id]:Vt}}}}let M=a||s,[ie,fe]=NS(t.history,A,H,st,F,d.v7_partialHydration&&Le===!0,d.v7_skipActionErrorRevalidation,Z,K,ee,De,se,W,M,l,Re);if(Wi(Ve=>!(H&&H.some(Vt=>Vt.route.id===Ve))||ie&&ie.some(Vt=>Vt.route.id===Ve)),J=++X,ie.length===0&&fe.length===0){let Ve=qe();return Zt(F,Dt({matches:H,loaderData:{},errors:Re&&Br(Re[1])?{[Re[0]]:Re[1].error}:null},FS(Re),Ve?{fetchers:new Map(A.fetchers)}:{}),{flushSync:Te}),{shortCircuited:!0}}if(ue){let Ve={};if(!q){Ve.navigation=ot;let Vt=Oe(Re);Vt!==void 0&&(Ve.actionData=Vt)}fe.length>0&&(Ve.fetchers=Je(fe)),$e(Ve,{flushSync:Te})}fe.forEach(Ve=>{re.has(Ve.key)&&$(Ve.key),Ve.controller&&re.set(Ve.key,Ve.controller)});let tt=()=>fe.forEach(Ve=>$(Ve.key));_&&_.signal.addEventListener("abort",tt);let{loaderResults:It,fetcherResults:Rt}=await Ar(A.matches,H,ie,fe,D);if(D.signal.aborted)return{shortCircuited:!0};_&&_.signal.removeEventListener("abort",tt),fe.forEach(Ve=>re.delete(Ve.key));let Ht=VS([...It,...Rt]);if(Ht){if(Ht.idx>=ie.length){let Ve=fe[Ht.idx-ie.length].key;W.add(Ve)}return await yn(D,Ht.result,{replace:ce}),{shortCircuited:!0}}let{loaderData:Cn,errors:Mn}=LS(A,H,ie,It,Re,fe,Rt,de);de.forEach((Ve,Vt)=>{Ve.subscribe(kr=>{(kr||Ve.done)&&de.delete(Vt)})}),d.v7_partialHydration&&Le&&A.errors&&Object.entries(A.errors).filter(Ve=>{let[Vt]=Ve;return!ie.some(kr=>kr.route.id===Vt)}).forEach(Ve=>{let[Vt,kr]=Ve;Mn=Object.assign(Mn||{},{[Vt]:kr})});let Yt=qe(),wa=it(J),Aa=Yt||wa||fe.length>0;return Dt({matches:H,loaderData:Cn,errors:Mn},Aa?{fetchers:new Map(A.fetchers)}:{})}function Oe(D){if(D&&!Br(D[1]))return{[D[0]]:D[1].data};if(A.actionData)return Object.keys(A.actionData).length===0?null:A.actionData}function Je(D){return D.forEach(F=>{let H=A.fetchers.get(F.key),q=au(void 0,H?H.data:void 0);A.fetchers.set(F.key,q)}),new Map(A.fetchers)}function Ut(D,F,H,q){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");re.has(D)&&$(D);let me=(q&&q.unstable_flushSync)===!0,ke=a||s,Pe=Pv(A.location,A.matches,l,d.v7_prependBasename,H,d.v7_relativeSplatPath,F,q==null?void 0:q.relative),ce=xa(ke,Pe,l),Le=yl(ce,ke,Pe);if(Le.active&&Le.matches&&(ce=Le.matches),!ce){I(D,F,Kn(404,{pathname:Pe}),{flushSync:me});return}let{path:Te,submission:Re,error:ot}=PS(d.v7_normalizeFormMethod,!0,Pe,q);if(ot){I(D,F,ot,{flushSync:me});return}let st=ku(ce,Te);if(T=(q&&q.preventScrollReset)===!0,Re&&Si(Re.formMethod)){_t(D,F,Te,st,ce,Le.active,me,Re);return}se.set(D,{routeId:F,path:Te}),Hn(D,F,Te,st,ce,Le.active,me,Re)}async function _t(D,F,H,q,me,ke,Pe,ce){k(),se.delete(D);function Le(xt){if(!xt.route.action&&!xt.route.lazy){let Eo=Kn(405,{method:ce.formMethod,pathname:H,routeId:F});return I(D,F,Eo,{flushSync:Pe}),!0}return!1}if(!ke&&Le(q))return;let Te=A.fetchers.get(D);y(D,iD(ce,Te),{flushSync:Pe});let Re=new AbortController,ot=Sl(t.history,H,Re.signal,ce);if(ke){let xt=await Cl(me,H,ot.signal);if(xt.type==="aborted")return;if(xt.type==="error"){let{error:Eo}=Mt(H,xt);I(D,F,Eo,{flushSync:Pe});return}else if(xt.matches){if(me=xt.matches,q=ku(me,H),Le(q))return}else{I(D,F,Kn(404,{pathname:H}),{flushSync:Pe});return}}re.set(D,Re);let st=X,M=(await Ot("action",ot,[q],me))[0];if(ot.signal.aborted){re.get(D)===Re&&re.delete(D);return}if(d.v7_fetcherPersist&&De.has(D)){if(Ua(M)||Br(M)){y(D,Rs(void 0));return}}else{if(Ua(M))if(re.delete(D),J>st){y(D,Rs(void 0));return}else return W.add(D),y(D,au(ce)),yn(ot,M,{fetcherSubmission:ce});if(Br(M)){I(D,F,M.error);return}}if(Fa(M))throw Kn(400,{type:"defer-action"});let ie=A.navigation.location||A.location,fe=Sl(t.history,ie,Re.signal),tt=a||s,It=A.navigation.state!=="idle"?xa(tt,A.navigation.location,l):A.matches;Ke(It,"Didn't find any matches after fetcher action");let Rt=++X;oe.set(D,Rt);let Ht=au(ce,M.data);A.fetchers.set(D,Ht);let[Cn,Mn]=NS(t.history,A,It,ce,ie,!1,d.v7_skipActionErrorRevalidation,Z,K,ee,De,se,W,tt,l,[q.route.id,M]);Mn.filter(xt=>xt.key!==D).forEach(xt=>{let Eo=xt.key,gI=A.fetchers.get(Eo),NN=au(void 0,gI?gI.data:void 0);A.fetchers.set(Eo,NN),re.has(Eo)&&$(Eo),xt.controller&&re.set(Eo,xt.controller)}),$e({fetchers:new Map(A.fetchers)});let Yt=()=>Mn.forEach(xt=>$(xt.key));Re.signal.addEventListener("abort",Yt);let{loaderResults:wa,fetcherResults:Aa}=await Ar(A.matches,It,Cn,Mn,fe);if(Re.signal.aborted)return;Re.signal.removeEventListener("abort",Yt),oe.delete(D),re.delete(D),Mn.forEach(xt=>re.delete(xt.key));let Ve=VS([...wa,...Aa]);if(Ve){if(Ve.idx>=Cn.length){let xt=Mn[Ve.idx-Cn.length].key;W.add(xt)}return yn(fe,Ve.result)}let{loaderData:Vt,errors:kr}=LS(A,A.matches,Cn,wa,void 0,Mn,Aa,de);if(A.fetchers.has(D)){let xt=Rs(M.data);A.fetchers.set(D,xt)}it(Rt),A.navigation.state==="loading"&&Rt>J?(Ke(x,"Expected pending action"),_&&_.abort(),Zt(A.navigation.location,{matches:It,loaderData:Vt,errors:kr,fetchers:new Map(A.fetchers)})):($e({errors:kr,loaderData:BS(A.loaderData,Vt,It,kr),fetchers:new Map(A.fetchers)}),Z=!1)}async function Hn(D,F,H,q,me,ke,Pe,ce){let Le=A.fetchers.get(D);y(D,au(ce,Le?Le.data:void 0),{flushSync:Pe});let Te=new AbortController,Re=Sl(t.history,H,Te.signal);if(ke){let M=await Cl(me,H,Re.signal);if(M.type==="aborted")return;if(M.type==="error"){let{error:ie}=Mt(H,M);I(D,F,ie,{flushSync:Pe});return}else if(M.matches)me=M.matches,q=ku(me,H);else{I(D,F,Kn(404,{pathname:H}),{flushSync:Pe});return}}re.set(D,Te);let ot=X,ue=(await Ot("loader",Re,[q],me))[0];if(Fa(ue)&&(ue=await cE(ue,Re.signal,!0)||ue),re.get(D)===Te&&re.delete(D),!Re.signal.aborted){if(De.has(D)){y(D,Rs(void 0));return}if(Ua(ue))if(J>ot){y(D,Rs(void 0));return}else{W.add(D),await yn(Re,ue);return}if(Br(ue)){I(D,F,ue.error);return}Ke(!Fa(ue),"Unhandled fetcher deferred data"),y(D,Rs(ue.data))}}async function yn(D,F,H){let{submission:q,fetcherSubmission:me,replace:ke}=H===void 0?{}:H;F.response.headers.has("X-Remix-Revalidate")&&(Z=!0);let Pe=F.response.headers.get("Location");Ke(Pe,"Expected a Location header on the redirect Response"),Pe=MS(Pe,new URL(D.url),l);let ce=gd(A.location,Pe,{_isRedirect:!0});if(n){let ue=!1;if(F.response.headers.has("X-Remix-Reload-Document"))ue=!0;else if(Jy.test(Pe)){const M=t.history.createURL(Pe);ue=M.origin!==e.location.origin||Zd(M.pathname,l)==null}if(ue){ke?e.location.replace(Pe):e.location.assign(Pe);return}}_=null;let Le=ke===!0?qt.Replace:qt.Push,{formMethod:Te,formAction:Re,formEncType:ot}=A.navigation;!q&&!me&&Te&&Re&&ot&&(q=WS(A.navigation));let st=q||me;if(FM.has(F.response.status)&&st&&Si(st.formMethod))await ve(Le,ce,{submission:Dt({},st,{formAction:Pe}),preventScrollReset:T});else{let ue=Kg(ce,q);await ve(Le,ce,{overrideNavigation:ue,fetcherSubmission:me,preventScrollReset:T})}}async function Ot(D,F,H,q){try{let me=await XM(c,D,F,H,q,o,i);return await Promise.all(me.map((ke,Pe)=>{if(eD(ke)){let ce=ke.result;return{type:mt.redirect,response:JM(ce,F,H[Pe].route.id,q,l,d.v7_relativeSplatPath)}}return KM(ke)}))}catch(me){return H.map(()=>({type:mt.error,error:me}))}}async function Ar(D,F,H,q,me){let[ke,...Pe]=await Promise.all([H.length?Ot("loader",me,H,F):[],...q.map(ce=>{if(ce.matches&&ce.match&&ce.controller){let Le=Sl(t.history,ce.path,ce.controller.signal);return Ot("loader",Le,[ce.match],ce.matches).then(Te=>Te[0])}else return Promise.resolve({type:mt.error,error:Kn(404,{pathname:ce.path})})})]);return await Promise.all([GS(D,H,ke,ke.map(()=>me.signal),!1,A.loaderData),GS(D,q.map(ce=>ce.match),Pe,q.map(ce=>ce.controller?ce.controller.signal:null),!0)]),{loaderResults:ke,fetcherResults:Pe}}function k(){Z=!0,K.push(...Wi()),se.forEach((D,F)=>{re.has(F)&&(ee.push(F),$(F))})}function y(D,F,H){H===void 0&&(H={}),A.fetchers.set(D,F),$e({fetchers:new Map(A.fetchers)},{flushSync:(H&&H.flushSync)===!0})}function I(D,F,H,q){q===void 0&&(q={});let me=Vl(A.matches,F);B(D),$e({errors:{[me.route.id]:H},fetchers:new Map(A.fetchers)},{flushSync:(q&&q.flushSync)===!0})}function P(D){return d.v7_fetcherPersist&&(we.set(D,(we.get(D)||0)+1),De.has(D)&&De.delete(D)),A.fetchers.get(D)||UM}function B(D){let F=A.fetchers.get(D);re.has(D)&&!(F&&F.state==="loading"&&oe.has(D))&&$(D),se.delete(D),oe.delete(D),W.delete(D),De.delete(D),A.fetchers.delete(D)}function j(D){if(d.v7_fetcherPersist){let F=(we.get(D)||0)-1;F<=0?(we.delete(D),De.add(D)):we.set(D,F)}else B(D);$e({fetchers:new Map(A.fetchers)})}function $(D){let F=re.get(D);Ke(F,"Expected fetch controller: "+D),F.abort(),re.delete(D)}function _e(D){for(let F of D){let H=P(F),q=Rs(H.data);A.fetchers.set(F,q)}}function qe(){let D=[],F=!1;for(let H of W){let q=A.fetchers.get(H);Ke(q,"Expected fetcher: "+H),q.state==="loading"&&(W.delete(H),D.push(H),F=!0)}return _e(D),F}function it(D){let F=[];for(let[H,q]of oe)if(q<D){let me=A.fetchers.get(H);Ke(me,"Expected fetcher: "+H),me.state==="loading"&&($(H),oe.delete(H),F.push(H))}return _e(F),F.length>0}function ct(D,F){let H=A.blockers.get(D)||su;return xe.get(D)!==F&&xe.set(D,F),H}function et(D){A.blockers.delete(D),xe.delete(D)}function Gi(D,F){let H=A.blockers.get(D)||su;Ke(H.state==="unblocked"&&F.state==="blocked"||H.state==="blocked"&&F.state==="blocked"||H.state==="blocked"&&F.state==="proceeding"||H.state==="blocked"&&F.state==="unblocked"||H.state==="proceeding"&&F.state==="unblocked","Invalid blocker state transition: "+H.state+" -> "+F.state);let q=new Map(A.blockers);q.set(D,F),$e({blockers:q})}function rf(D){let{currentLocation:F,nextLocation:H,historyAction:q}=D;if(xe.size===0)return;xe.size>1&&yc(!1,"A router only supports one blocker at a time");let me=Array.from(xe.entries()),[ke,Pe]=me[me.length-1],ce=A.blockers.get(ke);if(!(ce&&ce.state==="proceeding")&&Pe({currentLocation:F,nextLocation:H,historyAction:q}))return ke}function $c(D){let F=Kn(404,{pathname:D}),H=a||s,{matches:q,route:me}=US(H);return Wi(),{notFoundMatches:q,route:me,error:F}}function Mt(D,F){return{boundaryId:Vl(F.partialMatches).route.id,error:Kn(400,{type:"route-discovery",pathname:D,message:F.error!=null&&"message"in F.error?F.error:String(F.error)})}}function Wi(D){let F=[];return de.forEach((H,q)=>{(!D||D(q))&&(H.cancel(),F.push(q),de.delete(q))}),F}function Cg(D,F,H){if(p=D,C=F,g=H||null,!m&&A.navigation===$g){m=!0;let q=Yc(A.location,A.matches);q!=null&&$e({restoreScrollPosition:q})}return()=>{p=null,C=null,g=null}}function Kc(D,F){return g&&g(D,F.map(q=>pM(q,A.loaderData)))||D.key}function Jc(D,F){if(p&&C){let H=Kc(D,F);p[H]=C()}}function Yc(D,F){if(p){let H=Kc(D,F),q=p[H];if(typeof q=="number")return q}return null}function yl(D,F,H){if(u)if(D){let q=D[D.length-1].route;if(q.path&&(q.path==="*"||q.path.endsWith("/*")))return{active:!0,matches:Qf(F,H,l,!0)}}else return{active:!0,matches:Qf(F,H,l,!0)||[]};return{active:!1,matches:null}}async function Cl(D,F,H){let q=D,me=q.length>0?q[q.length-1].route:null;for(;;){let ke=a==null,Pe=a||s;try{await HM(u,F,q,Pe,o,i,rt,H)}catch(Re){return{type:"error",error:Re,partialMatches:q}}finally{ke&&(s=[...s])}if(H.aborted)return{type:"aborted"};let ce=xa(Pe,F,l),Le=!1;if(ce){let Re=ce[ce.length-1].route;if(Re.index)return{type:"success",matches:ce};if(Re.path&&Re.path.length>0)if(Re.path==="*")Le=!0;else return{type:"success",matches:ce}}let Te=Qf(Pe,F,l,!0);if(!Te||q.map(Re=>Re.route.id).join("-")===Te.map(Re=>Re.route.id).join("-"))return{type:"success",matches:Le?ce:null};if(q=Te,me=q[q.length-1].route,me.path==="*")return{type:"success",matches:q}}}function of(D){o={},a=md(D,i,void 0,o)}function sf(D,F){let H=a==null;sE(D,F,a||s,o,i),H&&(s=[...s],$e({}))}return w={get basename(){return l},get future(){return d},get state(){return A},get routes(){return s},get window(){return e},initialize:tn,subscribe:Zn,enableScrollRestoration:Cg,navigate:Jt,fetch:Ut,revalidate:he,createHref:D=>t.history.createHref(D),encodeLocation:D=>t.history.encodeLocation(D),getFetcher:P,deleteFetcher:j,dispose:vn,getBlocker:ct,deleteBlocker:et,patchRoutes:sf,_internalFetchControllers:re,_internalActiveDeferreds:de,_internalSetRoutes:of},w}function WM(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Pv(t,e,n,r,i,o,s,a){let l,c;if(s){l=[];for(let d of e)if(l.push(d),d.route.id===s){c=d;break}}else l=e,c=e[e.length-1];let u=PM(i||".",xM(l,o),Zd(t.pathname,n)||t.pathname,a==="path");return i==null&&(u.search=t.search,u.hash=t.hash),(i==null||i===""||i===".")&&c&&c.route.index&&!Yy(u.search)&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:za([n,u.pathname])),jd(u)}function PS(t,e,n,r){if(!r||!WM(r))return{path:n};if(r.formMethod&&!nD(r.formMethod))return{path:n,error:Kn(405,{method:r.formMethod})};let i=()=>({path:n,error:Kn(400,{type:"invalid-body"})}),o=r.formMethod||"get",s=t?o.toUpperCase():o.toLowerCase(),a=aE(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Si(s))return i();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[g,C]=p;return""+h+g+"="+C+`
`},""):String(r.body);return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!Si(s))return i();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return i()}}}Ke(typeof FormData=="function","FormData is not available in this environment");let l,c;if(r.formData)l=Nv(r.formData),c=r.formData;else if(r.body instanceof FormData)l=Nv(r.body),c=r.body;else if(r.body instanceof URLSearchParams)l=r.body,c=DS(l);else if(r.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(r.body),c=DS(l)}catch{return i()}let u={formMethod:s,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(Si(u.formMethod))return{path:n,submission:u};let d=ma(n);return e&&d.search&&Yy(d.search)&&l.append("index",""),d.search="?"+l,{path:jd(d),submission:u}}function jM(t,e){let n=t;if(e){let r=t.findIndex(i=>i.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function NS(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,g){let C=g?Br(g[1])?g[1].error:g[1].data:void 0,m=t.createURL(e.location),v=t.createURL(i),S=g&&Br(g[1])?g[0]:void 0,E=S?jM(n,S):n,w=g?g[1].statusCode:void 0,A=s&&w&&w>=400,x=E.filter((_,O)=>{let{route:L}=_;if(L.lazy)return!0;if(L.loader==null)return!1;if(o)return typeof L.loader!="function"||L.loader.hydrate?!0:e.loaderData[L.id]===void 0&&(!e.errors||e.errors[L.id]===void 0);if(ZM(e.loaderData,e.matches[O],_)||l.some(Z=>Z===_.route.id))return!0;let U=e.matches[O],z=_;return _S(_,Dt({currentUrl:m,currentParams:U.params,nextUrl:v,nextParams:z.params},r,{actionResult:C,actionStatus:w,defaultShouldRevalidate:A?!1:a||m.pathname+m.search===v.pathname+v.search||m.search!==v.search||oE(U,z)}))}),T=[];return d.forEach((_,O)=>{if(o||!n.some(K=>K.route.id===_.routeId)||u.has(O))return;let L=xa(h,_.path,p);if(!L){T.push({key:O,routeId:_.routeId,path:_.path,matches:null,match:null,controller:null});return}let U=e.fetchers.get(O),z=ku(L,_.path),Z=!1;f.has(O)?Z=!1:c.includes(O)?Z=!0:U&&U.state!=="idle"&&U.data===void 0?Z=a:Z=_S(z,Dt({currentUrl:m,currentParams:e.matches[e.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params},r,{actionResult:C,actionStatus:w,defaultShouldRevalidate:A?!1:a})),Z&&T.push({key:O,routeId:_.routeId,path:_.path,matches:L,match:z,controller:new AbortController})}),[x,T]}function ZM(t,e,n){let r=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return r||i}function oE(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function _S(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function HM(t,e,n,r,i,o,s,a){let l=[e,...n.map(c=>c.route.id)].join("-");try{let c=s.get(l);c||(c=t({path:e,matches:n,patch:(u,d)=>{a.aborted||sE(u,d,r,i,o)}}),s.set(l,c)),c&&qM(c)&&await c}finally{s.delete(l)}}function sE(t,e,n,r,i){if(t){var o;let s=r[t];Ke(s,"No route found to patch children into: routeId = "+t);let a=md(e,i,[t,"patch",String(((o=s.children)==null?void 0:o.length)||"0")],r);s.children?s.children.push(...a):s.children=a}else{let s=md(e,i,["patch",String(n.length||"0")],r);n.push(...s)}}async function OS(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let i=n[t.id];Ke(i,"No route found in manifest");let o={};for(let s in r){let l=i[s]!==void 0&&s!=="hasErrorBoundary";yc(!l,'Route "'+i.id+'" has a static property "'+s+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+s+'" will be ignored.')),!l&&!fM.has(s)&&(o[s]=r[s])}Object.assign(i,o),Object.assign(i,Dt({},e(i),{lazy:void 0}))}function zM(t){return Promise.all(t.matches.map(e=>e.resolve()))}async function XM(t,e,n,r,i,o,s,a){let l=r.reduce((d,f)=>d.add(f.route.id),new Set),c=new Set,u=await t({matches:i.map(d=>{let f=l.has(d.route.id);return Dt({},d,{shouldLoad:f,resolve:p=>(c.add(d.route.id),f?$M(e,n,d,o,s,p,a):Promise.resolve({type:mt.data,result:void 0}))})}),request:n,params:i[0].params,context:a});return i.forEach(d=>Ke(c.has(d.route.id),'`match.resolve()` was not called for route id "'+d.route.id+'". You must call `match.resolve()` on every match passed to `dataStrategy` to ensure all routes are properly loaded.')),u.filter((d,f)=>l.has(i[f].route.id))}async function $M(t,e,n,r,i,o,s){let a,l,c=u=>{let d,f=new Promise((g,C)=>d=C);l=()=>d(),e.signal.addEventListener("abort",l);let h=g=>typeof u!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):u({request:e,params:n.params,context:s},...g!==void 0?[g]:[]),p;return o?p=o(g=>h(g)):p=(async()=>{try{return{type:"data",result:await h()}}catch(g){return{type:"error",result:g}}})(),Promise.race([p,f])};try{let u=n.route[t];if(n.route.lazy)if(u){let d,[f]=await Promise.all([c(u).catch(h=>{d=h}),OS(n.route,i,r)]);if(d!==void 0)throw d;a=f}else if(await OS(n.route,i,r),u=n.route[t],u)a=await c(u);else if(t==="action"){let d=new URL(e.url),f=d.pathname+d.search;throw Kn(405,{method:e.method,pathname:f,routeId:n.route.id})}else return{type:mt.data,result:void 0};else if(u)a=await c(u);else{let d=new URL(e.url),f=d.pathname+d.search;throw Kn(404,{pathname:f})}Ke(a.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(u){return{type:mt.error,result:u}}finally{l&&e.signal.removeEventListener("abort",l)}return a}async function KM(t){let{result:e,type:n,status:r}=t;if(lE(e)){let s;try{let a=e.headers.get("Content-Type");a&&/\bapplication\/json\b/.test(a)?e.body==null?s=null:s=await e.json():s=await e.text()}catch(a){return{type:mt.error,error:a}}return n===mt.error?{type:mt.error,error:new Ky(e.status,e.statusText,s),statusCode:e.status,headers:e.headers}:{type:mt.data,data:s,statusCode:e.status,headers:e.headers}}if(n===mt.error)return{type:mt.error,error:e,statusCode:Xp(e)?e.status:r};if(tD(e)){var i,o;return{type:mt.deferred,deferredData:e,statusCode:(i=e.init)==null?void 0:i.status,headers:((o=e.init)==null?void 0:o.headers)&&new Headers(e.init.headers)}}return{type:mt.data,data:e,statusCode:r}}function JM(t,e,n,r,i,o){let s=t.headers.get("Location");if(Ke(s,"Redirects returned/thrown from loaders/actions must have a Location header"),!Jy.test(s)){let a=r.slice(0,r.findIndex(l=>l.route.id===n)+1);s=Pv(new URL(e.url),a,i,!0,s,o),t.headers.set("Location",s)}return t}function MS(t,e,n){if(Jy.test(t)){let r=t,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),o=Zd(i.pathname,n)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return t}function Sl(t,e,n,r){let i=t.createURL(aE(e)).toString(),o={signal:n};if(r&&Si(r.formMethod)){let{formMethod:s,formEncType:a}=r;o.method=s.toUpperCase(),a==="application/json"?(o.headers=new Headers({"Content-Type":a}),o.body=JSON.stringify(r.json)):a==="text/plain"?o.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?o.body=Nv(r.formData):o.body=r.formData}return new Request(i,o)}function Nv(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function DS(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function YM(t,e,n,r,i,o){let s={},a=null,l,c=!1,u={},d=r&&Br(r[1])?r[1].error:void 0;return n.forEach((f,h)=>{let p=e[h].route.id;if(Ke(!Ua(f),"Cannot handle redirect results in processLoaderData"),Br(f)){let g=f.error;d!==void 0&&(g=d,d=void 0),a=a||{};{let C=Vl(t,p);a[C.route.id]==null&&(a[C.route.id]=g)}s[p]=void 0,c||(c=!0,l=Xp(f.error)?f.error.status:500),f.headers&&(u[p]=f.headers)}else Fa(f)?(i.set(p,f.deferredData),s[p]=f.deferredData.data,f.statusCode!=null&&f.statusCode!==200&&!c&&(l=f.statusCode),f.headers&&(u[p]=f.headers)):(s[p]=f.data,f.statusCode&&f.statusCode!==200&&!c&&(l=f.statusCode),f.headers&&(u[p]=f.headers))}),d!==void 0&&r&&(a={[r[0]]:d},s[r[0]]=void 0),{loaderData:s,errors:a,statusCode:l||200,loaderHeaders:u}}function LS(t,e,n,r,i,o,s,a){let{loaderData:l,errors:c}=YM(e,n,r,i,a);for(let u=0;u<o.length;u++){let{key:d,match:f,controller:h}=o[u];Ke(s!==void 0&&s[u]!==void 0,"Did not find corresponding fetcher result");let p=s[u];if(!(h&&h.signal.aborted))if(Br(p)){let g=Vl(t.matches,f==null?void 0:f.route.id);c&&c[g.route.id]||(c=Dt({},c,{[g.route.id]:p.error})),t.fetchers.delete(d)}else if(Ua(p))Ke(!1,"Unhandled fetcher revalidation redirect");else if(Fa(p))Ke(!1,"Unhandled fetcher deferred data");else{let g=Rs(p.data);t.fetchers.set(d,g)}}return{loaderData:l,errors:c}}function BS(t,e,n,r){let i=Dt({},e);for(let o of n){let s=o.route.id;if(e.hasOwnProperty(s)?e[s]!==void 0&&(i[s]=e[s]):t[s]!==void 0&&o.route.loader&&(i[s]=t[s]),r&&r.hasOwnProperty(s))break}return i}function FS(t){return t?Br(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Vl(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function US(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Kn(t,e){let{pathname:n,routeId:r,method:i,type:o,message:s}=e===void 0?{}:e,a="Unknown Server Error",l="Unknown @remix-run/router error";return t===400?(a="Bad Request",o==="route-discovery"?l='Unable to match URL "'+n+'" - the `unstable_patchRoutesOnMiss()` '+(`function threw the following error:
`+s):i&&n&&r?l="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?l="defer() is not supported in actions":o==="invalid-body"&&(l="Unable to encode submission body")):t===403?(a="Forbidden",l='Route "'+r+'" does not match URL "'+n+'"'):t===404?(a="Not Found",l='No route matches URL "'+n+'"'):t===405&&(a="Method Not Allowed",i&&n&&r?l="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(l='Invalid request method "'+i.toUpperCase()+'"')),new Ky(t||500,a,new Error(l),!0)}function VS(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(Ua(n))return{result:n,idx:e}}}function aE(t){let e=typeof t=="string"?ma(t):t;return jd(Dt({},e,{hash:""}))}function QM(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function qM(t){return typeof t=="object"&&t!=null&&"then"in t}function eD(t){return lE(t.result)&&BM.has(t.result.status)}function Fa(t){return t.type===mt.deferred}function Br(t){return t.type===mt.error}function Ua(t){return(t&&t.type)===mt.redirect}function tD(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function lE(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function nD(t){return LM.has(t.toLowerCase())}function Si(t){return MM.has(t.toLowerCase())}async function GS(t,e,n,r,i,o){for(let s=0;s<n.length;s++){let a=n[s],l=e[s];if(!l)continue;let c=t.find(d=>d.route.id===l.route.id),u=c!=null&&!oE(c,l)&&(o&&o[l.route.id])!==void 0;if(Fa(a)&&(i||u)){let d=r[s];Ke(d,"Expected an AbortSignal for revalidating fetcher deferred result"),await cE(a,d,i).then(f=>{f&&(n[s]=f||n[s])})}}}async function cE(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:mt.data,data:t.deferredData.unwrappedData}}catch(i){return{type:mt.error,error:i}}return{type:mt.data,data:t.deferredData.data}}}function Yy(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function ku(t,e){let n=typeof e=="string"?ma(e).search:e.search;if(t[t.length-1].route.index&&Yy(n||""))return t[t.length-1];let r=nE(t);return r[r.length-1]}function WS(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:o,json:s}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(s!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:s,text:void 0}}}function Kg(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function rD(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function au(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function iD(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Rs(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function oD(t,e){try{let n=t.sessionStorage.getItem(iE);if(n){let r=JSON.parse(n);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function sD(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(iE,JSON.stringify(n))}catch(r){yc(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.25.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _v(){return _v=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_v.apply(this,arguments)}const uE=b.createContext(null),dE=b.createContext(null),fE=b.createContext(null),Qy=b.createContext(null),$p=b.createContext({outlet:null,matches:[],isDataRoute:!1}),hE=b.createContext(null);function qy(){return b.useContext(Qy)!=null}function pE(){return qy()||Ke(!1),b.useContext(Qy).location}function aD(t,e,n,r){qy()||Ke(!1);let{navigator:i}=b.useContext(fE),{matches:o}=b.useContext($p),s=o[o.length-1],a=s?s.params:{};s&&s.pathname;let l=s?s.pathnameBase:"/";s&&s.route;let c=pE(),u;u=c;let d=u.pathname||"/",f=d;if(l!=="/"){let g=l.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(g.length).join("/")}let h=xa(t,{pathname:f});return fD(h&&h.map(g=>Object.assign({},g,{params:Object.assign({},a,g.params),pathname:za([l,i.encodeLocation?i.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:za([l,i.encodeLocation?i.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),o,n,r)}function lD(){let t=mD(),e=Xp(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),n?b.createElement("pre",{style:i},n):null,null)}const cD=b.createElement(lD,null);class uD extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?b.createElement($p.Provider,{value:this.props.routeContext},b.createElement(hE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dD(t){let{routeContext:e,match:n,children:r}=t,i=b.useContext(uE);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),b.createElement($p.Provider,{value:e},r)}function fD(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if((o=n)!=null&&o.errors)t=n.matches;else return null}let s=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=s.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||Ke(!1),s=s.slice(0,Math.min(s.length,u+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,d,f)=>{let h,p=!1,g=null,C=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,g=d.route.errorElement||cD,l&&(c<0&&f===0?(vD("route-fallback"),p=!0,C=null):c===f&&(p=!0,C=d.route.hydrateFallbackElement||null)));let m=e.concat(s.slice(0,f+1)),v=()=>{let S;return h?S=g:p?S=C:d.route.Component?S=b.createElement(d.route.Component,null):d.route.element?S=d.route.element:S=u,b.createElement(dD,{match:d,routeContext:{outlet:u,matches:m,isDataRoute:n!=null},children:S})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?b.createElement(uD,{location:n.location,revalidation:n.revalidation,component:g,error:h,children:v(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):v()},null)}var Ov=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Ov||{});function hD(t){let e=b.useContext(dE);return e||Ke(!1),e}function pD(t){let e=b.useContext($p);return e||Ke(!1),e}function gD(t){let e=pD(),n=e.matches[e.matches.length-1];return n.route.id||Ke(!1),n.route.id}function mD(){var t;let e=b.useContext(hE),n=hD(Ov.UseRouteError),r=gD(Ov.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}const jS={};function vD(t,e,n){jS[t]||(jS[t]=!0)}function yD(t){let{basename:e="/",children:n=null,location:r,navigationType:i=qt.Pop,navigator:o,static:s=!1,future:a}=t;qy()&&Ke(!1);let l=e.replace(/^\/*/,"/"),c=b.useMemo(()=>({basename:l,navigator:o,static:s,future:_v({v7_relativeSplatPath:!1},a)}),[l,a,o,s]);typeof r=="string"&&(r=ma(r));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,g=b.useMemo(()=>{let C=Zd(u,l);return C==null?null:{location:{pathname:C,search:d,hash:f,state:h,key:p},navigationType:i}},[l,u,d,f,h,p,i]);return g==null?null:b.createElement(fE.Provider,{value:c},b.createElement(Qy.Provider,{children:n,value:g}))}new Promise(()=>{});function CD(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:b.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:b.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:b.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.25.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kh(){return Kh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kh.apply(this,arguments)}const ID="6";try{window.__reactRouterVersion=ID}catch{}function SD(t,e){return GM({basename:void 0,future:Kh({},void 0,{v7_prependBasename:!0}),history:cM({window:void 0}),hydrationData:bD(),routes:t,mapRouteProperties:CD,unstable_dataStrategy:void 0,unstable_patchRoutesOnMiss:void 0,window:void 0}).initialize()}function bD(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=Kh({},e,{errors:wD(e.errors)})),e}function wD(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new Ky(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let s=new o(i.message);s.stack="",n[r]=s}catch{}}if(n[r]==null){let o=new Error(i.message);o.stack="",n[r]=o}}else n[r]=i;return n}const AD=b.createContext({isTransitioning:!1}),kD=b.createContext(new Map),ED="startTransition",ZS=JN[ED],TD="flushSync",HS=lM[TD];function RD(t){ZS?ZS(t):t()}function lu(t){HS?HS(t):t()}class xD{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function PD(t){let{fallbackElement:e,router:n,future:r}=t,[i,o]=b.useState(n.state),[s,a]=b.useState(),[l,c]=b.useState({isTransitioning:!1}),[u,d]=b.useState(),[f,h]=b.useState(),[p,g]=b.useState(),C=b.useRef(new Map),{v7_startTransition:m}=r||{},v=b.useCallback(T=>{m?RD(T):T()},[m]),S=b.useCallback((T,_)=>{let{deletedFetchers:O,unstable_flushSync:L,unstable_viewTransitionOpts:U}=_;O.forEach(Z=>C.current.delete(Z)),T.fetchers.forEach((Z,K)=>{Z.data!==void 0&&C.current.set(K,Z.data)});let z=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!U||z){L?lu(()=>o(T)):v(()=>o(T));return}if(L){lu(()=>{f&&(u&&u.resolve(),f.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:U.currentLocation,nextLocation:U.nextLocation})});let Z=n.window.document.startViewTransition(()=>{lu(()=>o(T))});Z.finished.finally(()=>{lu(()=>{d(void 0),h(void 0),a(void 0),c({isTransitioning:!1})})}),lu(()=>h(Z));return}f?(u&&u.resolve(),f.skipTransition(),g({state:T,currentLocation:U.currentLocation,nextLocation:U.nextLocation})):(a(T),c({isTransitioning:!0,flushSync:!1,currentLocation:U.currentLocation,nextLocation:U.nextLocation}))},[n.window,f,u,C,v]);b.useLayoutEffect(()=>n.subscribe(S),[n,S]),b.useEffect(()=>{l.isTransitioning&&!l.flushSync&&d(new xD)},[l]),b.useEffect(()=>{if(u&&s&&n.window){let T=s,_=u.promise,O=n.window.document.startViewTransition(async()=>{v(()=>o(T)),await _});O.finished.finally(()=>{d(void 0),h(void 0),a(void 0),c({isTransitioning:!1})}),h(O)}},[v,s,u,n.window]),b.useEffect(()=>{u&&s&&i.location.key===s.location.key&&u.resolve()},[u,f,i.location,s]),b.useEffect(()=>{!l.isTransitioning&&p&&(a(p.state),c({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),g(void 0))},[l.isTransitioning,p]),b.useEffect(()=>{},[]);let E=b.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:T=>n.navigate(T),push:(T,_,O)=>n.navigate(T,{state:_,preventScrollReset:O==null?void 0:O.preventScrollReset}),replace:(T,_,O)=>n.navigate(T,{replace:!0,state:_,preventScrollReset:O==null?void 0:O.preventScrollReset})}),[n]),w=n.basename||"/",A=b.useMemo(()=>({router:n,navigator:E,static:!1,basename:w}),[n,E,w]),x=b.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return b.createElement(b.Fragment,null,b.createElement(uE.Provider,{value:A},b.createElement(dE.Provider,{value:i},b.createElement(kD.Provider,{value:C.current},b.createElement(AD.Provider,{value:l},b.createElement(yD,{basename:w,location:i.location,navigationType:i.historyAction,navigator:E,future:x},i.initialized||n.future.v7_partialHydration?b.createElement(ND,{routes:n.routes,future:n.future,state:i}):e))))),null)}const ND=b.memo(_D);function _D(t){let{routes:e,future:n,state:r}=t;return aD(e,void 0,r,n)}var zS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(zS||(zS={}));var XS;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(XS||(XS={}));const gE=t=>{const e=typeof t=="function",n=b.useRef(t);b.useEffect(()=>{n.current=t}),b.useEffect(()=>{if(e){const r=i=>{const o=n.current(i);if(typeof o=="string")return i.preventDefault(),i.returnValue=o;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])},mE=7e3;let Jg=null;function $S(t,e="assertive",n=mE){Jg||(Jg=new OD),Jg.announce(t,e,n)}class OD{createLog(e){let n=document.createElement("div");return n.setAttribute("role","log"),n.setAttribute("aria-live",e),n.setAttribute("aria-relevant","additions"),n}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,n="assertive",r=mE){if(!this.node)return;let i=document.createElement("div");i.textContent=e,n==="assertive"?this.assertiveLog.appendChild(i):this.politeLog.appendChild(i),e!==""&&setTimeout(()=>{i.remove()},r)}clear(e){this.node&&((!e||e==="assertive")&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&(this.politeLog.innerHTML=""))}constructor(){this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node)}}var KS=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function MD(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var ks=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],DD=function(){KS(t,null,[{key:"escapeForHtml",value:function(n){return new t().escapeForHtml(n)}},{key:"linkify",value:function(n){return new t().linkify(n)}},{key:"ansiToHtml",value:function(n,r){return new t().ansiToHtml(n,r)}},{key:"ansiToJson",value:function(n,r){return new t().ansiToJson(n,r)}},{key:"ansiToText",value:function(n){return new t().ansiToText(n)}}]);function t(){MD(this,t),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return KS(t,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var n=0;n<2;++n)for(var r=0;r<8;++r)this.PALETTE_COLORS.push(ks[n][r].color);for(var i=[0,95,135,175,215,255],o=function(f,h,p){return i[f]+", "+i[h]+", "+i[p]},s=0;s<6;++s)for(var a=0;a<6;++a)for(var l=0;l<6;++l)this.PALETTE_COLORS.push(o(s,a,l));for(var c=8,u=0;u<24;++u,c+=10)this.PALETTE_COLORS.push(o(c,c,c))}},{key:"escapeForHtml",value:function(n){return n.replace(/[&<>\"]/gm,function(r){return r=="&"?"&amp;":r=='"'?"&quot;":r=="<"?"&lt;":r==">"?"&gt;":""})}},{key:"linkify",value:function(n){return n.replace(/(https?:\/\/[^\s]+)/gm,function(r){return'<a href="'+r+'">'+r+"</a>"})}},{key:"ansiToHtml",value:function(n,r){return this.process(n,r,!0)}},{key:"ansiToJson",value:function(n,r){return r=r||{},r.json=!0,r.clearLine=!1,this.process(n,r,!0)}},{key:"ansiToText",value:function(n){return this.process(n,{},!1)}},{key:"process",value:function(n,r,i){var o=this,s=this,a=n.split(/\033\[/),l=a.shift();r==null&&(r={}),r.clearLine=/\r/.test(n);var c=a.map(function(d){return o.processChunk(d,r,i)});if(r&&r.json){var u=s.processChunkJson("");return u.content=l,u.clearLine=r.clearLine,c.unshift(u),r.remove_empty&&(c=c.filter(function(d){return!d.isEmpty()})),c}else c.unshift(l);return c.join("")}},{key:"processChunkJson",value:function(n,r,i){r=typeof r>"u"?{}:r;var o=r.use_classes=typeof r.use_classes<"u"&&r.use_classes,s=r.key=o?"class":"color",a={content:n,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:r.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!a.content}},l=n.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!l)return a;a.content=l[4];var c=l[2].split(";");if(l[1]!==""||l[3]!=="m"||!i)return a;for(var u=this;c.length>0;){var d=c.shift(),f=parseInt(d);if(isNaN(f)||f===0)u.fg=u.bg=null,u.decorations=[];else if(f===1)u.decorations.push("bold");else if(f===2)u.decorations.push("dim");else if(f===3)u.decorations.push("italic");else if(f===4)u.decorations.push("underline");else if(f===5)u.decorations.push("blink");else if(f===7)u.decorations.push("reverse");else if(f===8)u.decorations.push("hidden");else if(f===9)u.decorations.push("strikethrough");else if(f===21)u.removeDecoration("bold");else if(f===22)u.removeDecoration("bold"),u.removeDecoration("dim");else if(f===23)u.removeDecoration("italic");else if(f===24)u.removeDecoration("underline");else if(f===25)u.removeDecoration("blink");else if(f===27)u.removeDecoration("reverse");else if(f===28)u.removeDecoration("hidden");else if(f===29)u.removeDecoration("strikethrough");else if(f===39)u.fg=null;else if(f===49)u.bg=null;else if(f>=30&&f<38)u.fg=ks[0][f%10][s];else if(f>=90&&f<98)u.fg=ks[1][f%10][s];else if(f>=40&&f<48)u.bg=ks[0][f%10][s];else if(f>=100&&f<108)u.bg=ks[1][f%10][s];else if(f===38||f===48){var h=f===38;if(c.length>=1){var p=c.shift();if(p==="5"&&c.length>=1){var g=parseInt(c.shift());if(g>=0&&g<=255)if(!o)this.PALETTE_COLORS||u.setupPalette(),h?u.fg=this.PALETTE_COLORS[g]:u.bg=this.PALETTE_COLORS[g];else{var C=g>=16?"ansi-palette-"+g:ks[g>7?1:0][g%8].class;h?u.fg=C:u.bg=C}}else if(p==="2"&&c.length>=3){var m=parseInt(c.shift()),v=parseInt(c.shift()),S=parseInt(c.shift());if(m>=0&&m<=255&&v>=0&&v<=255&&S>=0&&S<=255){var E=m+", "+v+", "+S;o?h?(u.fg="ansi-truecolor",u.fg_truecolor=E):(u.bg="ansi-truecolor",u.bg_truecolor=E):h?u.fg=E:u.bg=E}}}}}return u.fg===null&&u.bg===null&&u.decorations.length===0||(a.fg=u.fg,a.bg=u.bg,a.fg_truecolor=u.fg_truecolor,a.bg_truecolor=u.bg_truecolor,a.decorations=u.decorations,a.decoration=u.decorations.slice(-1).pop()||null,a.was_processed=!0),a}},{key:"processChunk",value:function(n,r,i){var o=this;r=r||{};var s=this.processChunkJson(n,r,i),a=r.use_classes;if(s.decorations=s.decorations.filter(function(h){if(h==="reverse"){s.fg||(s.fg=ks[0][7][a?"class":"color"]),s.bg||(s.bg=ks[0][0][a?"class":"color"]);var p=s.fg;s.fg=s.bg,s.bg=p;var g=s.fg_truecolor;return s.fg_truecolor=s.bg_truecolor,s.bg_truecolor=g,s.isInverted=!0,!1}return!0}),r.json)return s;if(s.isEmpty())return"";if(!s.was_processed)return s.content;var l=[],c=[],u=[],d={},f=function(p){var g=[],C=void 0;for(C in p)p.hasOwnProperty(C)&&g.push("data-"+C+'="'+o.escapeForHtml(p[C])+'"');return g.length>0?" "+g.join(" "):""};return s.isInverted&&(d["ansi-is-inverted"]="true"),s.fg&&(a?(l.push(s.fg+"-fg"),s.fg_truecolor!==null&&(d["ansi-truecolor-fg"]=s.fg_truecolor,s.fg_truecolor=null)):l.push("color:rgb("+s.fg+")")),s.bg&&(a?(l.push(s.bg+"-bg"),s.bg_truecolor!==null&&(d["ansi-truecolor-bg"]=s.bg_truecolor,s.bg_truecolor=null)):l.push("background-color:rgb("+s.bg+")")),s.decorations.forEach(function(h){if(a){c.push("ansi-"+h);return}h==="bold"?c.push("font-weight:bold"):h==="dim"?c.push("opacity:0.5"):h==="italic"?c.push("font-style:italic"):h==="hidden"?c.push("visibility:hidden"):h==="strikethrough"?u.push("line-through"):u.push(h)}),u.length&&c.push("text-decoration:"+u.join(" ")),a?'<span class="'+l.concat(c).join(" ")+'"'+f(d)+">"+s.content+"</span>":'<span style="'+l.concat(c).join(";")+'"'+f(d)+">"+s.content+"</span>"}},{key:"removeDecoration",value:function(n){var r=this.decorations.indexOf(n);r>=0&&this.decorations.splice(r,1)}}]),t}(),LD=DD;const BD=Bd(LD);function FD(t,e){let n=[];for(const r of t.split(`\r
`)){const i=BD.ansiToJson(r,{json:!0,remove_empty:!1});let o=[];for(const s of i){const a=WD(s,e);o=[...o,...a]}n=[...n,Y.jsx("span",{children:o},n.length)]}return n}const UD=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,VD=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,GD=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function WD(t,e){const n=jD(t),r=[];let i=0,o=0;function s(u,d){let f;for(;(f=u.exec(t.content))!==null;){const h=f.index;h>i&&r.push(t.content.substring(i,h)),r.push(d(f)),i=u.lastIndex}}function a(u){const[,d,f]=u,h=f;return Y.jsxs(Y.Fragment,{children:[d,Y.jsx("a",{href:h,target:"_blank",rel:"noreferrer",children:f})]})}function l(u){const d=u.groups.name,f=`mailto:${d}`;return Y.jsxs(Y.Fragment,{children:[u.groups.slorp1,Y.jsx("a",{href:f,target:"_blank",rel:"noreferrer",children:d}),u.groups.slorp2]})}function c(u){const[,d,f]=u;return Y.jsx("a",{onClick:()=>e(d),className:"exit",children:f})}return s(UD,a),s(VD,l),s(GD,c),i<t.content.length&&r.push(t.content.substring(i)),r.map(u=>Y.jsx("span",{style:n,children:u},o++))}function jD(t){const e={};switch(t.bg&&(e.backgroundColor=`rgb(${t.bg})`),t.fg&&(e.color=`rgb(${t.fg})`),t.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}var ca={},_c={},vE=b;function Fe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ur=Object.prototype.hasOwnProperty,ZD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,JS={},YS={};function yE(t){return ur.call(YS,t)?!0:ur.call(JS,t)?!1:ZD.test(t)?YS[t]=!0:(JS[t]=!0,!1)}function ar(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var xn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xn[t]=new ar(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xn[e]=new ar(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xn[t]=new ar(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xn[t]=new ar(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xn[t]=new ar(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xn[t]=new ar(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xn[t]=new ar(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xn[t]=new ar(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xn[t]=new ar(t,5,!1,t.toLowerCase(),null,!1,!1)});var eC=/[\-:]([a-z])/g;function tC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(eC,tC);xn[e]=new ar(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(eC,tC);xn[e]=new ar(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(eC,tC);xn[e]=new ar(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xn[t]=new ar(t,1,!1,t.toLowerCase(),null,!1,!1)});xn.xlinkHref=new ar("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xn[t]=new ar(t,1,!1,t.toLowerCase(),null,!0,!0)});var qf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},HD=["Webkit","ms","Moz","O"];Object.keys(qf).forEach(function(t){HD.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),qf[e]=qf[t]})});var zD=/["'&<>]/;function qn(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=zD.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var XD=/([A-Z])/g,$D=/^ms-/,Mv=Array.isArray;function To(t,e){return{insertionMode:t,selectedValue:e}}function KD(t,e,n){switch(e){case"select":return To(1,n.value!=null?n.value:n.defaultValue);case"svg":return To(2,null);case"math":return To(3,null);case"foreignObject":return To(1,null);case"table":return To(4,null);case"thead":case"tbody":case"tfoot":return To(5,null);case"colgroup":return To(7,null);case"tr":return To(6,null)}return 4<=t.insertionMode||t.insertionMode===0?To(1,null):t}var QS=new Map;function CE(t,e,n){if(typeof n!="object")throw Error(Fe(62));e=!0;for(var r in n)if(ur.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=qn(r);i=qn((""+i).trim())}else{o=r;var s=QS.get(o);s!==void 0||(s=qn(o.replace(XD,"-$1").toLowerCase().replace($D,"-ms-")),QS.set(o,s)),o=s,i=typeof i=="number"?i===0||ur.call(qf,r)?""+i:i+"px":qn((""+i).trim())}e?(e=!1,t.push(' style="',o,":",i)):t.push(";",o,":",i)}}e||t.push('"')}function Er(t,e,n,r){switch(n){case"style":CE(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=xn.hasOwnProperty(n)?xn[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=e.attributeName,e.type){case 3:r&&t.push(" ",n,'=""');break;case 4:r===!0?t.push(" ",n,'=""'):r!==!1&&t.push(" ",n,'="',qn(r),'"');break;case 5:isNaN(r)||t.push(" ",n,'="',qn(r),'"');break;case 6:!isNaN(r)&&1<=r&&t.push(" ",n,'="',qn(r),'"');break;default:e.sanitizeURL&&(r=""+r),t.push(" ",n,'="',qn(r),'"')}}else if(yE(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(" ",n,'="',qn(r),'"')}}}function eh(t,e,n){if(e!=null){if(n!=null)throw Error(Fe(60));if(typeof e!="object"||!("__html"in e))throw Error(Fe(61));e=e.__html,e!=null&&t.push(""+e)}}function JD(t){var e="";return vE.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}function Yg(t,e,n,r){t.push(Zi(n));var i=n=null,o;for(o in e)if(ur.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:Er(t,r,o,s)}}return t.push(">"),eh(t,i,n),typeof n=="string"?(t.push(qn(n)),null):n}var YD=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,qS=new Map;function Zi(t){var e=qS.get(t);if(e===void 0){if(!YD.test(t))throw Error(Fe(65,t));e="<"+t,qS.set(t,e)}return e}function QD(t,e,n,r,i){switch(e){case"select":t.push(Zi("select"));var o=null,s=null;for(u in n)if(ur.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:Er(t,r,u,a)}}return t.push(">"),eh(t,s,o),o;case"option":s=i.selectedValue,t.push(Zi("option"));var l=a=null,c=null,u=null;for(o in n)if(ur.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":c=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":l=d;default:Er(t,r,o,d)}}if(s!=null)if(n=l!==null?""+l:JD(a),Mv(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(' selected=""');break}}else""+s===n&&t.push(' selected=""');else c&&t.push(' selected=""');return t.push(">"),eh(t,u,a),a;case"textarea":t.push(Zi("textarea")),u=s=o=null;for(a in n)if(ur.call(n,a)&&(l=n[a],l!=null))switch(a){case"children":u=l;break;case"value":o=l;break;case"defaultValue":s=l;break;case"dangerouslySetInnerHTML":throw Error(Fe(91));default:Er(t,r,a,l)}if(o===null&&s!==null&&(o=s),t.push(">"),u!=null){if(o!=null)throw Error(Fe(92));if(Mv(u)&&1<u.length)throw Error(Fe(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o!==null&&t.push(qn(""+o)),null;case"input":t.push(Zi("input")),l=u=a=o=null;for(s in n)if(ur.call(n,s)&&(c=n[s],c!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(Fe(399,"input"));case"defaultChecked":l=c;break;case"defaultValue":a=c;break;case"checked":u=c;break;case"value":o=c;break;default:Er(t,r,s,c)}return u!==null?Er(t,r,"checked",u):l!==null&&Er(t,r,"checked",l),o!==null?Er(t,r,"value",o):a!==null&&Er(t,r,"value",a),t.push("/>"),null;case"menuitem":t.push(Zi("menuitem"));for(var f in n)if(ur.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(Fe(400));default:Er(t,r,f,o)}return t.push(">"),null;case"title":t.push(Zi("title")),o=null;for(d in n)if(ur.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(Fe(434));default:Er(t,r,d,s)}return t.push(">"),o;case"listing":case"pre":t.push(Zi(e)),s=o=null;for(l in n)if(ur.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:Er(t,r,l,a)}if(t.push(">"),s!=null){if(o!=null)throw Error(Fe(60));if(typeof s!="object"||!("__html"in s))throw Error(Fe(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(`
`,n):t.push(""+n))}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(Zi(e));for(var h in n)if(ur.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(Fe(399,e));default:Er(t,r,h,o)}return t.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Yg(t,n,e,r);case"html":return i.insertionMode===0&&t.push("<!DOCTYPE html>"),Yg(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return Yg(t,n,e,r);t.push(Zi(e)),s=o=null;for(c in n)if(ur.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":CE(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:yE(c)&&typeof a!="function"&&typeof a!="symbol"&&t.push(" ",c,'="',qn(a),'"')}return t.push(">"),eh(t,s,o),o}}function eb(t,e,n){if(t.push('<!--$?--><template id="'),n===null)throw Error(Fe(395));return t.push(n),t.push('"></template>')}function qD(t,e,n,r){switch(n.insertionMode){case 0:case 1:return t.push('<div hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 2:return t.push('<svg aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 3:return t.push('<math aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 4:return t.push('<table hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 5:return t.push('<table hidden><tbody id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 6:return t.push('<table hidden><tr id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 7:return t.push('<table hidden><colgroup id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');default:throw Error(Fe(397))}}function e2(t,e){switch(e.insertionMode){case 0:case 1:return t.push("</div>");case 2:return t.push("</svg>");case 3:return t.push("</math>");case 4:return t.push("</table>");case 5:return t.push("</tbody></table>");case 6:return t.push("</tr></table>");case 7:return t.push("</colgroup></table>");default:throw Error(Fe(397))}}var t2=/[<\u2028\u2029]/g;function Qg(t){return JSON.stringify(t).replace(t2,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function n2(t,e){return e=e===void 0?"":e,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:e+"P:",segmentPrefix:e+"S:",boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:t}}function tb(t,e,n,r){return n.generateStaticMarkup?(t.push(qn(e)),!1):(e===""?t=r:(r&&t.push("<!-- -->"),t.push(qn(e)),t=!0),t)}var Hu=Object.assign,r2=Symbol.for("react.element"),IE=Symbol.for("react.portal"),SE=Symbol.for("react.fragment"),bE=Symbol.for("react.strict_mode"),wE=Symbol.for("react.profiler"),AE=Symbol.for("react.provider"),kE=Symbol.for("react.context"),EE=Symbol.for("react.forward_ref"),TE=Symbol.for("react.suspense"),RE=Symbol.for("react.suspense_list"),xE=Symbol.for("react.memo"),nC=Symbol.for("react.lazy"),i2=Symbol.for("react.scope"),o2=Symbol.for("react.debug_trace_mode"),s2=Symbol.for("react.legacy_hidden"),a2=Symbol.for("react.default_value"),nb=Symbol.iterator;function Dv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case SE:return"Fragment";case IE:return"Portal";case wE:return"Profiler";case bE:return"StrictMode";case TE:return"Suspense";case RE:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case kE:return(t.displayName||"Context")+".Consumer";case AE:return(t._context.displayName||"Context")+".Provider";case EE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case xE:return e=t.displayName||null,e!==null?e:Dv(t.type)||"Memo";case nC:e=t._payload,t=t._init;try{return Dv(t(e))}catch{}}return null}var PE={};function rb(t,e){if(t=t.contextTypes,!t)return PE;var n={},r;for(r in t)n[r]=e[r];return n}var Va=null;function Kp(t,e){if(t!==e){t.context._currentValue2=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(Fe(401))}else{if(n===null)throw Error(Fe(401));Kp(t,n)}e.context._currentValue2=e.value}}function NE(t){t.context._currentValue2=t.parentValue,t=t.parent,t!==null&&NE(t)}function _E(t){var e=t.parent;e!==null&&_E(e),t.context._currentValue2=t.value}function OE(t,e){if(t.context._currentValue2=t.parentValue,t=t.parent,t===null)throw Error(Fe(402));t.depth===e.depth?Kp(t,e):OE(t,e)}function ME(t,e){var n=e.parent;if(n===null)throw Error(Fe(402));t.depth===n.depth?Kp(t,n):ME(t,n),e.context._currentValue2=e.value}function Jh(t){var e=Va;e!==t&&(e===null?_E(t):t===null?NE(e):e.depth===t.depth?Kp(e,t):e.depth>t.depth?OE(e,t):ME(e,t),Va=t)}var ib={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function ob(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=ib,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue2:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:Hu({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&ib.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=Hu({},o,a)):Hu(o,a))}t.state=o}else o.queue=null}var l2={id:1,overflow:""};function Lv(t,e,n){var r=t.id;t=t.overflow;var i=32-th(r)-1;r&=~(1<<i),n+=1;var o=32-th(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-th(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var th=Math.clz32?Math.clz32:d2,c2=Math.log,u2=Math.LN2;function d2(t){return t>>>=0,t===0?32:31-(c2(t)/u2|0)|0}function f2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var h2=typeof Object.is=="function"?Object.is:f2,gs=null,rC=null,nh=null,pt=null,Eu=!1,Yh=!1,vd=0,js=null,Jp=0;function Pa(){if(gs===null)throw Error(Fe(321));return gs}function sb(){if(0<Jp)throw Error(Fe(312));return{memoizedState:null,queue:null,next:null}}function iC(){return pt===null?nh===null?(Eu=!1,nh=pt=sb()):(Eu=!0,pt=nh):pt.next===null?(Eu=!1,pt=pt.next=sb()):(Eu=!0,pt=pt.next),pt}function oC(){rC=gs=null,Yh=!1,nh=null,Jp=0,pt=js=null}function DE(t,e){return typeof e=="function"?e(t):e}function ab(t,e,n){if(gs=Pa(),pt=iC(),Eu){var r=pt.queue;if(e=r.dispatch,js!==null&&(n=js.get(r),n!==void 0)){js.delete(r),r=pt.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return pt.memoizedState=r,[r,e]}return[pt.memoizedState,e]}return t=t===DE?typeof e=="function"?e():e:n!==void 0?n(e):e,pt.memoizedState=t,t=pt.queue={last:null,dispatch:null},t=t.dispatch=p2.bind(null,gs,t),[pt.memoizedState,t]}function lb(t,e){if(gs=Pa(),pt=iC(),e=e===void 0?null:e,pt!==null){var n=pt.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!h2(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),pt.memoizedState=[t,e],t}function p2(t,e,n){if(25<=Jp)throw Error(Fe(301));if(t===gs)if(Yh=!0,t={action:n,next:null},js===null&&(js=new Map),n=js.get(e),n===void 0)js.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function g2(){throw Error(Fe(394))}function kf(){}var cb={readContext:function(t){return t._currentValue2},useContext:function(t){return Pa(),t._currentValue2},useMemo:lb,useReducer:ab,useRef:function(t){gs=Pa(),pt=iC();var e=pt.memoizedState;return e===null?(t={current:t},pt.memoizedState=t):e},useState:function(t){return ab(DE,t)},useInsertionEffect:kf,useLayoutEffect:function(){},useCallback:function(t,e){return lb(function(){return t},e)},useImperativeHandle:kf,useEffect:kf,useDebugValue:kf,useDeferredValue:function(t){return Pa(),t},useTransition:function(){return Pa(),[!1,g2]},useId:function(){var t=rC.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-th(t)-1)).toString(32)+e;var n=rh;if(n===null)throw Error(Fe(404));return e=vd++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return Pa(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(Fe(407));return n()}},rh=null,qg=vE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function m2(t){return console.error(t),null}function Tu(){}function v2(t,e,n,r,i,o,s,a,l){var c=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?m2:i,onAllReady:Tu,onShellReady:s===void 0?Tu:s,onShellError:Tu,onFatalError:Tu},n=Qh(e,0,null,n,!1,!1),n.parentFlushed=!0,t=sC(e,t,null,n,u,PE,null,l2),c.push(t),e}function sC(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var l={node:e,ping:function(){var c=t.pingedTasks;c.push(l),c.length===1&&FE(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(l),l}function Qh(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function yd(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function qh(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,t.destination.destroy(e)):(t.status=1,t.fatalError=e)}function ub(t,e,n,r,i){for(gs={},rC=e,vd=0,t=n(r,i);Yh;)Yh=!1,vd=0,Jp+=1,pt=null,t=n(r,i);return oC(),t}function db(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(Fe(108,Dv(r)||"Unknown",a));r=Hu({},s,n)}e.legacyContext=r,Or(t,e,i),e.legacyContext=s}else Or(t,e,i)}function fb(t,e){if(t&&t.defaultProps){e=Hu({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Bv(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=rb(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue2:i),ob(o,n,r,i),db(t,e,o,n)}else{o=rb(n,e.legacyContext),i=ub(t,e,n,r,o);var s=vd!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)ob(i,n,r,o),db(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=Lv(r,1,0);try{Or(t,e,i)}finally{e.treeContext=r}}else Or(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=QD(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=KD(s,n,r),Fv(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push("</",n,">")}i.lastPushedText=!1}else{switch(n){case s2:case o2:case bE:case wE:case SE:Or(t,e,r.children);return;case RE:Or(t,e,r.children);return;case i2:throw Error(Fe(343));case TE:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},l=Qh(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(l),i.lastPushedText=!1;var c=Qh(t,0,null,i.formatContext,!1,!1);c.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=c;try{if(Fv(t,e,r),t.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("<!-- -->"),c.status=1,ep(a,c),a.pendingTasks===0)break e}catch(u){c.status=4,a.forceClientRender=!0,a.errorDigest=yd(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=sC(t,o,n,l,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case EE:if(r=ub(t,e,n.render,r,i),vd!==0){n=e.treeContext,e.treeContext=Lv(n,1,0);try{Or(t,e,r)}finally{e.treeContext=n}}else Or(t,e,r);return;case xE:n=n.type,r=fb(n,r),Bv(t,e,n,r,i);return;case AE:if(i=r.children,n=n._context,r=r.value,o=n._currentValue2,n._currentValue2=r,s=Va,Va=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,Or(t,e,i),t=Va,t===null)throw Error(Fe(403));r=t.parentValue,t.context._currentValue2=r===a2?t.context._defaultValue:r,t=Va=t.parent,e.context=t;return;case kE:r=r.children,r=r(n._currentValue2),Or(t,e,r);return;case nC:i=n._init,n=i(n._payload),r=fb(n,r),Bv(t,e,n,r,void 0);return}throw Error(Fe(130,n==null?n:typeof n,""))}}function Or(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case r2:Bv(t,e,n.type,n.props,n.ref);return;case IE:throw Error(Fe(257));case nC:var r=n._init;n=r(n._payload),Or(t,e,n);return}if(Mv(n)){hb(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=nb&&n[nb]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);hb(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(Fe(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=tb(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=tb(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function hb(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=Lv(o,r,i);try{Fv(t,e,n[i])}finally{e.treeContext=o}}}function Fv(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return Or(t,e,n)}catch(l){if(oC(),typeof l=="object"&&l!==null&&typeof l.then=="function"){n=l;var s=e.blockedSegment,a=Qh(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=sC(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,Jh(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,Jh(o),l}}function y2(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,BE(this,e,t)}function LE(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.push(null))):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(Fe(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return LE(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function ep(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&ep(t,n)}else t.completedSegments.push(e)}function BE(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(Fe(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=Tu,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&ep(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(y2,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(ep(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function FE(t){if(t.status!==2){var e=Va,n=qg.current;qg.current=cb;var r=rh;rh=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,l=s.blockedSegment;if(l.status===0){Jh(s.context);try{Or(a,s,s.node),a.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),s.abortSet.delete(s),l.status=1,BE(a,s.blockedBoundary,l)}catch(p){if(oC(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var c=s.ping;p.then(c,c)}else{s.abortSet.delete(s),l.status=4;var u=s.blockedBoundary,d=p,f=yd(a,d);if(u===null?qh(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,o),t.destination!==null&&aC(t,t.destination)}catch(p){yd(t,p),qh(t,p)}finally{rh=r,qg.current=n,n===cb&&Jh(e)}}}function Ef(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,e.push('<template id="'),e.push(t.placeholderPrefix),t=r.toString(16),e.push(t),e.push('"></template>');case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)e.push(r[o]);i=Yp(t,e,i)}for(;o<r.length-1;o++)e.push(r[o]);return o<r.length&&(i=e.push(r[o])),i;default:throw Error(Fe(390))}}function Yp(t,e,n){var r=n.boundary;if(r===null)return Ef(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)return t.responseState.generateStaticMarkup||(r=r.errorDigest,e.push("<!--$!-->"),e.push("<template"),r&&(e.push(' data-dgst="'),r=qn(r),e.push(r),e.push('"')),e.push("></template>")),Ef(t,e,n),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t;if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;return i=i.boundaryPrefix+o.toString(16),r=r.id=i,eb(e,t.responseState,r),Ef(t,e,n),e.push("<!--/$-->")}if(r.byteSize>t.progressiveChunkSize)return r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),eb(e,t.responseState,r.id),Ef(t,e,n),e.push("<!--/$-->");if(t.responseState.generateStaticMarkup||e.push("<!--$-->"),n=r.completedSegments,n.length!==1)throw Error(Fe(391));return Yp(t,e,n[0]),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t}function pb(t,e,n){return qD(e,t.responseState,n.formatContext,n.id),Yp(t,e,n),e2(e,n.formatContext)}function gb(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)UE(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,e.push(t.startInlineScript),t.sentCompleteBoundaryFunction?e.push('$RC("'):(t.sentCompleteBoundaryFunction=!0,e.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),r===null)throw Error(Fe(395));return n=n.toString(16),e.push(r),e.push('","'),e.push(t.segmentPrefix),e.push(n),e.push('")<\/script>')}function UE(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(Fe(392));return pb(t,e,r)}return pb(t,e,r),t=t.responseState,e.push(t.startInlineScript),t.sentCompleteSegmentFunction?e.push('$RS("'):(t.sentCompleteSegmentFunction=!0,e.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),e.push(t.segmentPrefix),i=i.toString(16),e.push(i),e.push('","'),e.push(t.placeholderPrefix),e.push(i),e.push('")<\/script>')}function aC(t,e){try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){Yp(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)e.push(r[n]);n<r.length&&e.push(r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,l=s.id,c=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(r.push(a.startInlineScript),a.sentClientRenderFunction?r.push('$RX("'):(a.sentClientRenderFunction=!0,r.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),l===null)throw Error(Fe(395));if(r.push(l),r.push('"'),c||u||d){r.push(",");var f=Qg(c||"");r.push(f)}if(u||d){r.push(",");var h=Qg(u||"");r.push(h)}if(d){r.push(",");var p=Qg(d);r.push(p)}if(!r.push(")<\/script>")){t.destination=null,o++,i.splice(0,o);return}}i.splice(0,o);var g=t.completedBoundaries;for(o=0;o<g.length;o++)if(!gb(t,e,g[o])){t.destination=null,o++,g.splice(0,o);return}g.splice(0,o);var C=t.partialBoundaries;for(o=0;o<C.length;o++){var m=C[o];e:{i=t,s=e;var v=m.completedSegments;for(a=0;a<v.length;a++)if(!UE(i,s,m,v[a])){a++,v.splice(0,a);var S=!1;break e}v.splice(0,a),S=!0}if(!S){t.destination=null,o++,C.splice(0,o);return}}C.splice(0,o);var E=t.completedBoundaries;for(o=0;o<E.length;o++)if(!gb(t,e,E[o])){t.destination=null,o++,E.splice(0,o);return}E.splice(0,o)}finally{t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.push(null)}}function C2(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return LE(r,t,e)}),n.clear(),t.destination!==null&&aC(t,t.destination)}catch(r){yd(t,r),qh(t,r)}}function I2(){}function VE(t,e,n,r){var i=!1,o=null,s="",a={push:function(c){return c!==null&&(s+=c),!0},destroy:function(c){i=!0,o=c}},l=!1;if(t=v2(t,n2(n,e?e.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,I2,void 0,function(){l=!0}),FE(t),C2(t,r),t.status===1)t.status=2,a.destroy(t.fatalError);else if(t.status!==2&&t.destination===null){t.destination=a;try{aC(t,a)}catch(c){yd(t,c),qh(t,c)}}if(i)throw o;if(!l)throw Error(Fe(426));return s}_c.renderToNodeStream=function(){throw Error(Fe(207))};_c.renderToStaticMarkup=function(t,e){return VE(t,e,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};_c.renderToStaticNodeStream=function(){throw Error(Fe(208))};_c.renderToString=function(t,e){return VE(t,e,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};_c.version="18.3.1";var lC={},GE=b;function je(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mr=null,Dr=0;function Ee(t,e){if(e.length!==0)if(512<e.length)0<Dr&&(t.enqueue(new Uint8Array(Mr.buffer,0,Dr)),Mr=new Uint8Array(512),Dr=0),t.enqueue(e);else{var n=Mr.length-Dr;n<e.length&&(n===0?t.enqueue(Mr):(Mr.set(e.subarray(0,n),Dr),t.enqueue(Mr),e=e.subarray(n)),Mr=new Uint8Array(512),Dr=0),Mr.set(e,Dr),Dr+=e.length}}function kt(t,e){return Ee(t,e),!0}function mb(t){Mr&&0<Dr&&(t.enqueue(new Uint8Array(Mr.buffer,0,Dr)),Mr=null,Dr=0)}var WE=new TextEncoder;function Ze(t){return WE.encode(t)}function ge(t){return WE.encode(t)}function jE(t,e){typeof t.error=="function"?t.error(e):t.close()}var dr=Object.prototype.hasOwnProperty,S2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vb={},yb={};function ZE(t){return dr.call(yb,t)?!0:dr.call(vb,t)?!1:S2.test(t)?yb[t]=!0:(vb[t]=!0,!1)}function lr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Pn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Pn[t]=new lr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Pn[e]=new lr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Pn[t]=new lr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Pn[t]=new lr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Pn[t]=new lr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Pn[t]=new lr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Pn[t]=new lr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Pn[t]=new lr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Pn[t]=new lr(t,5,!1,t.toLowerCase(),null,!1,!1)});var cC=/[\-:]([a-z])/g;function uC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cC,uC);Pn[e]=new lr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cC,uC);Pn[e]=new lr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cC,uC);Pn[e]=new lr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Pn[t]=new lr(t,1,!1,t.toLowerCase(),null,!1,!1)});Pn.xlinkHref=new lr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Pn[t]=new lr(t,1,!1,t.toLowerCase(),null,!0,!0)});var ih={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},b2=["Webkit","ms","Moz","O"];Object.keys(ih).forEach(function(t){b2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ih[e]=ih[t]})});var w2=/["'&<>]/;function An(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=w2.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var A2=/([A-Z])/g,k2=/^ms-/,Uv=Array.isArray,E2=ge("<script>"),T2=ge("<\/script>"),R2=ge('<script src="'),x2=ge('<script type="module" src="'),Cb=ge('" async=""><\/script>'),P2=/(<\/|<)(s)(cript)/gi;function N2(t,e,n,r){return""+e+(n==="s"?"\\u0073":"\\u0053")+r}function _2(t,e,n,r,i){t=t===void 0?"":t,e=e===void 0?E2:ge('<script nonce="'+An(e)+'">');var o=[];if(n!==void 0&&o.push(e,Ze((""+n).replace(P2,N2)),T2),r!==void 0)for(n=0;n<r.length;n++)o.push(R2,Ze(An(r[n])),Cb);if(i!==void 0)for(r=0;r<i.length;r++)o.push(x2,Ze(An(i[r])),Cb);return{bootstrapChunks:o,startInlineScript:e,placeholderPrefix:ge(t+"P:"),segmentPrefix:ge(t+"S:"),boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function Hi(t,e){return{insertionMode:t,selectedValue:e}}function O2(t){return Hi(t==="http://www.w3.org/2000/svg"?2:t==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function M2(t,e,n){switch(e){case"select":return Hi(1,n.value!=null?n.value:n.defaultValue);case"svg":return Hi(2,null);case"math":return Hi(3,null);case"foreignObject":return Hi(1,null);case"table":return Hi(4,null);case"thead":case"tbody":case"tfoot":return Hi(5,null);case"colgroup":return Hi(7,null);case"tr":return Hi(6,null)}return 4<=t.insertionMode||t.insertionMode===0?Hi(1,null):t}var dC=ge("<!-- -->");function Ib(t,e,n,r){return e===""?r:(r&&t.push(dC),t.push(Ze(An(e))),!0)}var Sb=new Map,D2=ge(' style="'),bb=ge(":"),L2=ge(";");function HE(t,e,n){if(typeof n!="object")throw Error(je(62));e=!0;for(var r in n)if(dr.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=Ze(An(r));i=Ze(An((""+i).trim()))}else{o=r;var s=Sb.get(o);s!==void 0||(s=ge(An(o.replace(A2,"-$1").toLowerCase().replace(k2,"-ms-"))),Sb.set(o,s)),o=s,i=typeof i=="number"?i===0||dr.call(ih,r)?Ze(""+i):Ze(i+"px"):Ze(An((""+i).trim()))}e?(e=!1,t.push(D2,o,bb,i)):t.push(L2,o,bb,i)}}e||t.push(Na)}var xs=ge(" "),El=ge('="'),Na=ge('"'),wb=ge('=""');function Tr(t,e,n,r){switch(n){case"style":HE(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=Pn.hasOwnProperty(n)?Pn[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=Ze(e.attributeName),e.type){case 3:r&&t.push(xs,n,wb);break;case 4:r===!0?t.push(xs,n,wb):r!==!1&&t.push(xs,n,El,Ze(An(r)),Na);break;case 5:isNaN(r)||t.push(xs,n,El,Ze(An(r)),Na);break;case 6:!isNaN(r)&&1<=r&&t.push(xs,n,El,Ze(An(r)),Na);break;default:e.sanitizeURL&&(r=""+r),t.push(xs,n,El,Ze(An(r)),Na)}}else if(ZE(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(xs,Ze(n),El,Ze(An(r)),Na)}}}var Ps=ge(">"),Ab=ge("/>");function oh(t,e,n){if(e!=null){if(n!=null)throw Error(je(60));if(typeof e!="object"||!("__html"in e))throw Error(je(61));e=e.__html,e!=null&&t.push(Ze(""+e))}}function B2(t){var e="";return GE.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}var em=ge(' selected=""');function tm(t,e,n,r){t.push(zi(n));var i=n=null,o;for(o in e)if(dr.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:Tr(t,r,o,s)}}return t.push(Ps),oh(t,i,n),typeof n=="string"?(t.push(Ze(An(n))),null):n}var nm=ge(`
`),F2=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,kb=new Map;function zi(t){var e=kb.get(t);if(e===void 0){if(!F2.test(t))throw Error(je(65,t));e=ge("<"+t),kb.set(t,e)}return e}var U2=ge("<!DOCTYPE html>");function V2(t,e,n,r,i){switch(e){case"select":t.push(zi("select"));var o=null,s=null;for(u in n)if(dr.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:Tr(t,r,u,a)}}return t.push(Ps),oh(t,s,o),o;case"option":s=i.selectedValue,t.push(zi("option"));var l=a=null,c=null,u=null;for(o in n)if(dr.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":c=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":l=d;default:Tr(t,r,o,d)}}if(s!=null)if(n=l!==null?""+l:B2(a),Uv(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(em);break}}else""+s===n&&t.push(em);else c&&t.push(em);return t.push(Ps),oh(t,u,a),a;case"textarea":t.push(zi("textarea")),u=s=o=null;for(a in n)if(dr.call(n,a)&&(l=n[a],l!=null))switch(a){case"children":u=l;break;case"value":o=l;break;case"defaultValue":s=l;break;case"dangerouslySetInnerHTML":throw Error(je(91));default:Tr(t,r,a,l)}if(o===null&&s!==null&&(o=s),t.push(Ps),u!=null){if(o!=null)throw Error(je(92));if(Uv(u)&&1<u.length)throw Error(je(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(nm),o!==null&&t.push(Ze(An(""+o))),null;case"input":t.push(zi("input")),l=u=a=o=null;for(s in n)if(dr.call(n,s)&&(c=n[s],c!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(je(399,"input"));case"defaultChecked":l=c;break;case"defaultValue":a=c;break;case"checked":u=c;break;case"value":o=c;break;default:Tr(t,r,s,c)}return u!==null?Tr(t,r,"checked",u):l!==null&&Tr(t,r,"checked",l),o!==null?Tr(t,r,"value",o):a!==null&&Tr(t,r,"value",a),t.push(Ab),null;case"menuitem":t.push(zi("menuitem"));for(var f in n)if(dr.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(je(400));default:Tr(t,r,f,o)}return t.push(Ps),null;case"title":t.push(zi("title")),o=null;for(d in n)if(dr.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(je(434));default:Tr(t,r,d,s)}return t.push(Ps),o;case"listing":case"pre":t.push(zi(e)),s=o=null;for(l in n)if(dr.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:Tr(t,r,l,a)}if(t.push(Ps),s!=null){if(o!=null)throw Error(je(60));if(typeof s!="object"||!("__html"in s))throw Error(je(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(nm,Ze(n)):t.push(Ze(""+n)))}return typeof o=="string"&&o[0]===`
`&&t.push(nm),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(zi(e));for(var h in n)if(dr.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(je(399,e));default:Tr(t,r,h,o)}return t.push(Ab),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return tm(t,n,e,r);case"html":return i.insertionMode===0&&t.push(U2),tm(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return tm(t,n,e,r);t.push(zi(e)),s=o=null;for(c in n)if(dr.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":HE(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:ZE(c)&&typeof a!="function"&&typeof a!="symbol"&&t.push(xs,Ze(c),El,Ze(An(a)),Na)}return t.push(Ps),oh(t,s,o),o}}var G2=ge("</"),W2=ge(">"),j2=ge('<template id="'),Z2=ge('"></template>'),H2=ge("<!--$-->"),z2=ge('<!--$?--><template id="'),X2=ge('"></template>'),$2=ge("<!--$!-->"),K2=ge("<!--/$-->"),J2=ge("<template"),Y2=ge('"'),Q2=ge(' data-dgst="');ge(' data-msg="');ge(' data-stck="');var q2=ge("></template>");function Eb(t,e,n){if(Ee(t,z2),n===null)throw Error(je(395));return Ee(t,n),kt(t,X2)}var eL=ge('<div hidden id="'),tL=ge('">'),nL=ge("</div>"),rL=ge('<svg aria-hidden="true" style="display:none" id="'),iL=ge('">'),oL=ge("</svg>"),sL=ge('<math aria-hidden="true" style="display:none" id="'),aL=ge('">'),lL=ge("</math>"),cL=ge('<table hidden id="'),uL=ge('">'),dL=ge("</table>"),fL=ge('<table hidden><tbody id="'),hL=ge('">'),pL=ge("</tbody></table>"),gL=ge('<table hidden><tr id="'),mL=ge('">'),vL=ge("</tr></table>"),yL=ge('<table hidden><colgroup id="'),CL=ge('">'),IL=ge("</colgroup></table>");function SL(t,e,n,r){switch(n.insertionMode){case 0:case 1:return Ee(t,eL),Ee(t,e.segmentPrefix),Ee(t,Ze(r.toString(16))),kt(t,tL);case 2:return Ee(t,rL),Ee(t,e.segmentPrefix),Ee(t,Ze(r.toString(16))),kt(t,iL);case 3:return Ee(t,sL),Ee(t,e.segmentPrefix),Ee(t,Ze(r.toString(16))),kt(t,aL);case 4:return Ee(t,cL),Ee(t,e.segmentPrefix),Ee(t,Ze(r.toString(16))),kt(t,uL);case 5:return Ee(t,fL),Ee(t,e.segmentPrefix),Ee(t,Ze(r.toString(16))),kt(t,hL);case 6:return Ee(t,gL),Ee(t,e.segmentPrefix),Ee(t,Ze(r.toString(16))),kt(t,mL);case 7:return Ee(t,yL),Ee(t,e.segmentPrefix),Ee(t,Ze(r.toString(16))),kt(t,CL);default:throw Error(je(397))}}function bL(t,e){switch(e.insertionMode){case 0:case 1:return kt(t,nL);case 2:return kt(t,oL);case 3:return kt(t,lL);case 4:return kt(t,dL);case 5:return kt(t,pL);case 6:return kt(t,vL);case 7:return kt(t,IL);default:throw Error(je(397))}}var wL=ge('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),AL=ge('$RS("'),kL=ge('","'),EL=ge('")<\/script>'),TL=ge('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),RL=ge('$RC("'),xL=ge('","'),PL=ge('")<\/script>'),NL=ge('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),_L=ge('$RX("'),OL=ge('"'),ML=ge(")<\/script>"),rm=ge(","),DL=/[<\u2028\u2029]/g;function im(t){return JSON.stringify(t).replace(DL,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var zu=Object.assign,LL=Symbol.for("react.element"),zE=Symbol.for("react.portal"),XE=Symbol.for("react.fragment"),$E=Symbol.for("react.strict_mode"),KE=Symbol.for("react.profiler"),JE=Symbol.for("react.provider"),YE=Symbol.for("react.context"),QE=Symbol.for("react.forward_ref"),qE=Symbol.for("react.suspense"),eT=Symbol.for("react.suspense_list"),tT=Symbol.for("react.memo"),fC=Symbol.for("react.lazy"),BL=Symbol.for("react.scope"),FL=Symbol.for("react.debug_trace_mode"),UL=Symbol.for("react.legacy_hidden"),VL=Symbol.for("react.default_value"),Tb=Symbol.iterator;function Vv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case XE:return"Fragment";case zE:return"Portal";case KE:return"Profiler";case $E:return"StrictMode";case qE:return"Suspense";case eT:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case YE:return(t.displayName||"Context")+".Consumer";case JE:return(t._context.displayName||"Context")+".Provider";case QE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case tT:return e=t.displayName||null,e!==null?e:Vv(t.type)||"Memo";case fC:e=t._payload,t=t._init;try{return Vv(t(e))}catch{}}return null}var nT={};function Rb(t,e){if(t=t.contextTypes,!t)return nT;var n={},r;for(r in t)n[r]=e[r];return n}var Ga=null;function Qp(t,e){if(t!==e){t.context._currentValue=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(je(401))}else{if(n===null)throw Error(je(401));Qp(t,n)}e.context._currentValue=e.value}}function rT(t){t.context._currentValue=t.parentValue,t=t.parent,t!==null&&rT(t)}function iT(t){var e=t.parent;e!==null&&iT(e),t.context._currentValue=t.value}function oT(t,e){if(t.context._currentValue=t.parentValue,t=t.parent,t===null)throw Error(je(402));t.depth===e.depth?Qp(t,e):oT(t,e)}function sT(t,e){var n=e.parent;if(n===null)throw Error(je(402));t.depth===n.depth?Qp(t,n):sT(t,n),e.context._currentValue=e.value}function tp(t){var e=Ga;e!==t&&(e===null?iT(t):t===null?rT(e):e.depth===t.depth?Qp(e,t):e.depth>t.depth?oT(e,t):sT(e,t),Ga=t)}var xb={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function Pb(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=xb,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:zu({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&xb.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=zu({},o,a)):zu(o,a))}t.state=o}else o.queue=null}var GL={id:1,overflow:""};function Gv(t,e,n){var r=t.id;t=t.overflow;var i=32-sh(r)-1;r&=~(1<<i),n+=1;var o=32-sh(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-sh(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var sh=Math.clz32?Math.clz32:ZL,WL=Math.log,jL=Math.LN2;function ZL(t){return t>>>=0,t===0?32:31-(WL(t)/jL|0)|0}function HL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zL=typeof Object.is=="function"?Object.is:HL,ms=null,hC=null,ah=null,gt=null,Ru=!1,np=!1,Cd=0,Zs=null,qp=0;function _a(){if(ms===null)throw Error(je(321));return ms}function Nb(){if(0<qp)throw Error(je(312));return{memoizedState:null,queue:null,next:null}}function pC(){return gt===null?ah===null?(Ru=!1,ah=gt=Nb()):(Ru=!0,gt=ah):gt.next===null?(Ru=!1,gt=gt.next=Nb()):(Ru=!0,gt=gt.next),gt}function gC(){hC=ms=null,np=!1,ah=null,qp=0,gt=Zs=null}function aT(t,e){return typeof e=="function"?e(t):e}function _b(t,e,n){if(ms=_a(),gt=pC(),Ru){var r=gt.queue;if(e=r.dispatch,Zs!==null&&(n=Zs.get(r),n!==void 0)){Zs.delete(r),r=gt.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return gt.memoizedState=r,[r,e]}return[gt.memoizedState,e]}return t=t===aT?typeof e=="function"?e():e:n!==void 0?n(e):e,gt.memoizedState=t,t=gt.queue={last:null,dispatch:null},t=t.dispatch=XL.bind(null,ms,t),[gt.memoizedState,t]}function Ob(t,e){if(ms=_a(),gt=pC(),e=e===void 0?null:e,gt!==null){var n=gt.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!zL(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),gt.memoizedState=[t,e],t}function XL(t,e,n){if(25<=qp)throw Error(je(301));if(t===ms)if(np=!0,t={action:n,next:null},Zs===null&&(Zs=new Map),n=Zs.get(e),n===void 0)Zs.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function $L(){throw Error(je(394))}function Tf(){}var Mb={readContext:function(t){return t._currentValue},useContext:function(t){return _a(),t._currentValue},useMemo:Ob,useReducer:_b,useRef:function(t){ms=_a(),gt=pC();var e=gt.memoizedState;return e===null?(t={current:t},gt.memoizedState=t):e},useState:function(t){return _b(aT,t)},useInsertionEffect:Tf,useLayoutEffect:function(){},useCallback:function(t,e){return Ob(function(){return t},e)},useImperativeHandle:Tf,useEffect:Tf,useDebugValue:Tf,useDeferredValue:function(t){return _a(),t},useTransition:function(){return _a(),[!1,$L]},useId:function(){var t=hC.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-sh(t)-1)).toString(32)+e;var n=lh;if(n===null)throw Error(je(404));return e=Cd++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return _a(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(je(407));return n()}},lh=null,om=GE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function KL(t){return console.error(t),null}function xu(){}function JL(t,e,n,r,i,o,s,a,l){var c=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?KL:i,onAllReady:o===void 0?xu:o,onShellReady:s===void 0?xu:s,onShellError:a===void 0?xu:a,onFatalError:l===void 0?xu:l},n=rp(e,0,null,n,!1,!1),n.parentFlushed=!0,t=mC(e,t,null,n,u,nT,null,GL),c.push(t),e}function mC(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var l={node:e,ping:function(){var c=t.pingedTasks;c.push(l),c.length===1&&uT(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(l),l}function rp(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function Id(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function ip(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,jE(t.destination,e)):(t.status=1,t.fatalError=e)}function Db(t,e,n,r,i){for(ms={},hC=e,Cd=0,t=n(r,i);np;)np=!1,Cd=0,qp+=1,gt=null,t=n(r,i);return gC(),t}function Lb(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(je(108,Vv(r)||"Unknown",a));r=zu({},s,n)}e.legacyContext=r,Lr(t,e,i),e.legacyContext=s}else Lr(t,e,i)}function Bb(t,e){if(t&&t.defaultProps){e=zu({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Wv(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=Rb(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue:i),Pb(o,n,r,i),Lb(t,e,o,n)}else{o=Rb(n,e.legacyContext),i=Db(t,e,n,r,o);var s=Cd!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)Pb(i,n,r,o),Lb(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=Gv(r,1,0);try{Lr(t,e,i)}finally{e.treeContext=r}}else Lr(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=V2(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=M2(s,n,r),jv(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push(G2,Ze(n),W2)}i.lastPushedText=!1}else{switch(n){case UL:case FL:case $E:case KE:case XE:Lr(t,e,r.children);return;case eT:Lr(t,e,r.children);return;case BL:throw Error(je(343));case qE:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},l=rp(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(l),i.lastPushedText=!1;var c=rp(t,0,null,i.formatContext,!1,!1);c.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=c;try{if(jv(t,e,r),c.lastPushedText&&c.textEmbedded&&c.chunks.push(dC),c.status=1,op(a,c),a.pendingTasks===0)break e}catch(u){c.status=4,a.forceClientRender=!0,a.errorDigest=Id(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=mC(t,o,n,l,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case QE:if(r=Db(t,e,n.render,r,i),Cd!==0){n=e.treeContext,e.treeContext=Gv(n,1,0);try{Lr(t,e,r)}finally{e.treeContext=n}}else Lr(t,e,r);return;case tT:n=n.type,r=Bb(n,r),Wv(t,e,n,r,i);return;case JE:if(i=r.children,n=n._context,r=r.value,o=n._currentValue,n._currentValue=r,s=Ga,Ga=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,Lr(t,e,i),t=Ga,t===null)throw Error(je(403));r=t.parentValue,t.context._currentValue=r===VL?t.context._defaultValue:r,t=Ga=t.parent,e.context=t;return;case YE:r=r.children,r=r(n._currentValue),Lr(t,e,r);return;case fC:i=n._init,n=i(n._payload),r=Bb(n,r),Wv(t,e,n,r,void 0);return}throw Error(je(130,n==null?n:typeof n,""))}}function Lr(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case LL:Wv(t,e,n.type,n.props,n.ref);return;case zE:throw Error(je(257));case fC:var r=n._init;n=r(n._payload),Lr(t,e,n);return}if(Uv(n)){Fb(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=Tb&&n[Tb]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);Fb(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(je(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=Ib(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=Ib(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function Fb(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=Gv(o,r,i);try{jv(t,e,n[i])}finally{e.treeContext=o}}}function jv(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return Lr(t,e,n)}catch(l){if(gC(),typeof l=="object"&&l!==null&&typeof l.then=="function"){n=l;var s=e.blockedSegment,a=rp(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=mC(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,tp(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,tp(o),l}}function YL(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,cT(this,e,t)}function lT(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.close())):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(je(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return lT(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function op(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&op(t,n)}else t.completedSegments.push(e)}function cT(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(je(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=xu,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&op(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(YL,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(op(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function uT(t){if(t.status!==2){var e=Ga,n=om.current;om.current=Mb;var r=lh;lh=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,l=s.blockedSegment;if(l.status===0){tp(s.context);try{Lr(a,s,s.node),l.lastPushedText&&l.textEmbedded&&l.chunks.push(dC),s.abortSet.delete(s),l.status=1,cT(a,s.blockedBoundary,l)}catch(p){if(gC(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var c=s.ping;p.then(c,c)}else{s.abortSet.delete(s),l.status=4;var u=s.blockedBoundary,d=p,f=Id(a,d);if(u===null?ip(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,o),t.destination!==null&&vC(t,t.destination)}catch(p){Id(t,p),ip(t,p)}finally{lh=r,om.current=n,n===Mb&&tp(e)}}}function Rf(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,Ee(e,j2),Ee(e,t.placeholderPrefix),t=Ze(r.toString(16)),Ee(e,t),kt(e,Z2);case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)Ee(e,r[o]);i=eg(t,e,i)}for(;o<r.length-1;o++)Ee(e,r[o]);return o<r.length&&(i=kt(e,r[o])),i;default:throw Error(je(390))}}function eg(t,e,n){var r=n.boundary;if(r===null)return Rf(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)r=r.errorDigest,kt(e,$2),Ee(e,J2),r&&(Ee(e,Q2),Ee(e,Ze(An(r))),Ee(e,Y2)),kt(e,q2),Rf(t,e,n);else if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;i=ge(i.boundaryPrefix+o.toString(16)),r=r.id=i,Eb(e,t.responseState,r),Rf(t,e,n)}else if(r.byteSize>t.progressiveChunkSize)r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),Eb(e,t.responseState,r.id),Rf(t,e,n);else{if(kt(e,H2),n=r.completedSegments,n.length!==1)throw Error(je(391));eg(t,e,n[0])}return kt(e,K2)}function Ub(t,e,n){return SL(e,t.responseState,n.formatContext,n.id),eg(t,e,n),bL(e,n.formatContext)}function Vb(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)dT(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,Ee(e,t.startInlineScript),t.sentCompleteBoundaryFunction?Ee(e,RL):(t.sentCompleteBoundaryFunction=!0,Ee(e,TL)),r===null)throw Error(je(395));return n=Ze(n.toString(16)),Ee(e,r),Ee(e,xL),Ee(e,t.segmentPrefix),Ee(e,n),kt(e,PL)}function dT(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(je(392));return Ub(t,e,r)}return Ub(t,e,r),t=t.responseState,Ee(e,t.startInlineScript),t.sentCompleteSegmentFunction?Ee(e,AL):(t.sentCompleteSegmentFunction=!0,Ee(e,wL)),Ee(e,t.segmentPrefix),i=Ze(i.toString(16)),Ee(e,i),Ee(e,kL),Ee(e,t.placeholderPrefix),Ee(e,i),kt(e,EL)}function vC(t,e){Mr=new Uint8Array(512),Dr=0;try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){eg(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)Ee(e,r[n]);n<r.length&&kt(e,r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,l=s.id,c=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(Ee(r,a.startInlineScript),a.sentClientRenderFunction?Ee(r,_L):(a.sentClientRenderFunction=!0,Ee(r,NL)),l===null)throw Error(je(395));Ee(r,l),Ee(r,OL),(c||u||d)&&(Ee(r,rm),Ee(r,Ze(im(c||"")))),(u||d)&&(Ee(r,rm),Ee(r,Ze(im(u||"")))),d&&(Ee(r,rm),Ee(r,Ze(im(d)))),kt(r,ML)}i.splice(0,o);var f=t.completedBoundaries;for(o=0;o<f.length;o++)Vb(t,e,f[o]);f.splice(0,o),mb(e),Mr=new Uint8Array(512),Dr=0;var h=t.partialBoundaries;for(o=0;o<h.length;o++){var p=h[o];e:{i=t,s=e;var g=p.completedSegments;for(a=0;a<g.length;a++)if(!dT(i,s,p,g[a])){a++,g.splice(0,a);var C=!1;break e}g.splice(0,a),C=!0}if(!C){t.destination=null,o++,h.splice(0,o);return}}h.splice(0,o);var m=t.completedBoundaries;for(o=0;o<m.length;o++)Vb(t,e,m[o]);m.splice(0,o)}finally{mb(e),t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.close()}}function Gb(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return lT(r,t,e)}),n.clear(),t.destination!==null&&vC(t,t.destination)}catch(r){Id(t,r),ip(t,r)}}lC.renderToReadableStream=function(t,e){return new Promise(function(n,r){var i,o,s=new Promise(function(u,d){o=u,i=d}),a=JL(t,_2(e?e.identifierPrefix:void 0,e?e.nonce:void 0,e?e.bootstrapScriptContent:void 0,e?e.bootstrapScripts:void 0,e?e.bootstrapModules:void 0),O2(e?e.namespaceURI:void 0),e?e.progressiveChunkSize:void 0,e?e.onError:void 0,o,function(){var u=new ReadableStream({type:"bytes",pull:function(d){if(a.status===1)a.status=2,jE(d,a.fatalError);else if(a.status!==2&&a.destination===null){a.destination=d;try{vC(a,d)}catch(f){Id(a,f),ip(a,f)}}},cancel:function(){Gb(a)}},{highWaterMark:0});u.allReady=s,n(u)},function(u){s.catch(function(){}),r(u)},i);if(e&&e.signal){var l=e.signal,c=function(){Gb(a,l.reason),l.removeEventListener("abort",c)};l.addEventListener("abort",c)}uT(a)})};lC.version="18.3.1";var Oc,fT;Oc=_c,fT=lC;ca.version=Oc.version;ca.renderToString=Oc.renderToString;ca.renderToStaticMarkup=Oc.renderToStaticMarkup;ca.renderToNodeStream=Oc.renderToNodeStream;ca.renderToStaticNodeStream=Oc.renderToStaticNodeStream;ca.renderToReadableStream=fT.renderToReadableStream;/*! @license DOMPurify 3.1.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.6/LICENSE */const{entries:hT,setPrototypeOf:Wb,isFrozen:QL,getPrototypeOf:qL,getOwnPropertyDescriptor:eB}=Object;let{freeze:ir,seal:oi,create:pT}=Object,{apply:Zv,construct:Hv}=typeof Reflect<"u"&&Reflect;ir||(ir=function(e){return e});oi||(oi=function(e){return e});Zv||(Zv=function(e,n,r){return e.apply(n,r)});Hv||(Hv=function(e,n){return new e(...n)});const xf=Zr(Array.prototype.forEach),jb=Zr(Array.prototype.pop),cu=Zr(Array.prototype.push),ch=Zr(String.prototype.toLowerCase),sm=Zr(String.prototype.toString),Zb=Zr(String.prototype.match),uu=Zr(String.prototype.replace),tB=Zr(String.prototype.indexOf),nB=Zr(String.prototype.trim),ci=Zr(Object.prototype.hasOwnProperty),zn=Zr(RegExp.prototype.test),du=rB(TypeError);function Zr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Zv(t,e,r)}}function rB(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Hv(t,n)}}function He(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ch;Wb&&Wb(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(QL(e)||(e[r]=o),i=o)}t[i]=!0}return t}function iB(t){for(let e=0;e<t.length;e++)ci(t,e)||(t[e]=null);return t}function Ra(t){const e=pT(null);for(const[n,r]of hT(t))ci(t,n)&&(Array.isArray(r)?e[n]=iB(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Ra(r):e[n]=r);return e}function fu(t,e){for(;t!==null;){const r=eB(t,e);if(r){if(r.get)return Zr(r.get);if(typeof r.value=="function")return Zr(r.value)}t=qL(t)}function n(){return null}return n}const Hb=ir(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),am=ir(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lm=ir(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),oB=ir(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),cm=ir(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),sB=ir(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),zb=ir(["#text"]),Xb=ir(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),um=ir(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$b=ir(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Pf=ir(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),aB=oi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),lB=oi(/<%[\w\W]*|[\w\W]*%>/gm),cB=oi(/\${[\w\W]*}/gm),uB=oi(/^data-[\-\w.\u00B7-\uFFFF]/),dB=oi(/^aria-[\-\w]+$/),gT=oi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),fB=oi(/^(?:\w+script|data):/i),hB=oi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),mT=oi(/^html$/i),pB=oi(/^[a-z][.\w]*(-[.\w]+)+$/i);var Kb=Object.freeze({__proto__:null,MUSTACHE_EXPR:aB,ERB_EXPR:lB,TMPLIT_EXPR:cB,DATA_ATTR:uB,ARIA_ATTR:dB,IS_ALLOWED_URI:gT,IS_SCRIPT_OR_DATA:fB,ATTR_WHITESPACE:hB,DOCTYPE_NAME:mT,CUSTOM_ELEMENT:pB});const hu={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},gB=function(){return typeof window>"u"?null:window},mB=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function vT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gB();const e=ue=>vT(ue);if(e.version="3.1.6",e.removed=[],!t||!t.document||t.document.nodeType!==hu.document)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:f,trustedTypes:h}=t,p=l.prototype,g=fu(p,"cloneNode"),C=fu(p,"remove"),m=fu(p,"nextSibling"),v=fu(p,"childNodes"),S=fu(p,"parentNode");if(typeof s=="function"){const ue=n.createElement("template");ue.content&&ue.content.ownerDocument&&(n=ue.content.ownerDocument)}let E,w="";const{implementation:A,createNodeIterator:x,createDocumentFragment:T,getElementsByTagName:_}=n,{importNode:O}=r;let L={};e.isSupported=typeof hT=="function"&&typeof S=="function"&&A&&A.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:U,ERB_EXPR:z,TMPLIT_EXPR:Z,DATA_ATTR:K,ARIA_ATTR:ee,IS_SCRIPT_OR_DATA:re,ATTR_WHITESPACE:X,CUSTOM_ELEMENT:J}=Kb;let{IS_ALLOWED_URI:oe}=Kb,W=null;const se=He({},[...Hb,...am,...lm,...cm,...zb]);let we=null;const De=He({},[...Xb,...um,...$b,...Pf]);let de=Object.seal(pT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),xe=null,rt=null,Ce=!0,tn=!0,vn=!1,Zn=!0,$e=!1,Zt=!0,Jt=!1,he=!1,ve=!1,Ge=!1,We=!1,Oe=!1,Je=!0,Ut=!1;const _t="user-content-";let Hn=!0,yn=!1,Ot={},Ar=null;const k=He({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let y=null;const I=He({},["audio","video","img","source","image","track"]);let P=null;const B=He({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),j="http://www.w3.org/1998/Math/MathML",$="http://www.w3.org/2000/svg",_e="http://www.w3.org/1999/xhtml";let qe=_e,it=!1,ct=null;const et=He({},[j,$,_e],sm);let Gi=null;const rf=["application/xhtml+xml","text/html"],$c="text/html";let Mt=null,Wi=null;const Cg=n.createElement("form"),Kc=function(M){return M instanceof RegExp||M instanceof Function},Jc=function(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Wi&&Wi===M)){if((!M||typeof M!="object")&&(M={}),M=Ra(M),Gi=rf.indexOf(M.PARSER_MEDIA_TYPE)===-1?$c:M.PARSER_MEDIA_TYPE,Mt=Gi==="application/xhtml+xml"?sm:ch,W=ci(M,"ALLOWED_TAGS")?He({},M.ALLOWED_TAGS,Mt):se,we=ci(M,"ALLOWED_ATTR")?He({},M.ALLOWED_ATTR,Mt):De,ct=ci(M,"ALLOWED_NAMESPACES")?He({},M.ALLOWED_NAMESPACES,sm):et,P=ci(M,"ADD_URI_SAFE_ATTR")?He(Ra(B),M.ADD_URI_SAFE_ATTR,Mt):B,y=ci(M,"ADD_DATA_URI_TAGS")?He(Ra(I),M.ADD_DATA_URI_TAGS,Mt):I,Ar=ci(M,"FORBID_CONTENTS")?He({},M.FORBID_CONTENTS,Mt):k,xe=ci(M,"FORBID_TAGS")?He({},M.FORBID_TAGS,Mt):{},rt=ci(M,"FORBID_ATTR")?He({},M.FORBID_ATTR,Mt):{},Ot=ci(M,"USE_PROFILES")?M.USE_PROFILES:!1,Ce=M.ALLOW_ARIA_ATTR!==!1,tn=M.ALLOW_DATA_ATTR!==!1,vn=M.ALLOW_UNKNOWN_PROTOCOLS||!1,Zn=M.ALLOW_SELF_CLOSE_IN_ATTR!==!1,$e=M.SAFE_FOR_TEMPLATES||!1,Zt=M.SAFE_FOR_XML!==!1,Jt=M.WHOLE_DOCUMENT||!1,Ge=M.RETURN_DOM||!1,We=M.RETURN_DOM_FRAGMENT||!1,Oe=M.RETURN_TRUSTED_TYPE||!1,ve=M.FORCE_BODY||!1,Je=M.SANITIZE_DOM!==!1,Ut=M.SANITIZE_NAMED_PROPS||!1,Hn=M.KEEP_CONTENT!==!1,yn=M.IN_PLACE||!1,oe=M.ALLOWED_URI_REGEXP||gT,qe=M.NAMESPACE||_e,de=M.CUSTOM_ELEMENT_HANDLING||{},M.CUSTOM_ELEMENT_HANDLING&&Kc(M.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(de.tagNameCheck=M.CUSTOM_ELEMENT_HANDLING.tagNameCheck),M.CUSTOM_ELEMENT_HANDLING&&Kc(M.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(de.attributeNameCheck=M.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),M.CUSTOM_ELEMENT_HANDLING&&typeof M.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(de.allowCustomizedBuiltInElements=M.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),$e&&(tn=!1),We&&(Ge=!0),Ot&&(W=He({},zb),we=[],Ot.html===!0&&(He(W,Hb),He(we,Xb)),Ot.svg===!0&&(He(W,am),He(we,um),He(we,Pf)),Ot.svgFilters===!0&&(He(W,lm),He(we,um),He(we,Pf)),Ot.mathMl===!0&&(He(W,cm),He(we,$b),He(we,Pf))),M.ADD_TAGS&&(W===se&&(W=Ra(W)),He(W,M.ADD_TAGS,Mt)),M.ADD_ATTR&&(we===De&&(we=Ra(we)),He(we,M.ADD_ATTR,Mt)),M.ADD_URI_SAFE_ATTR&&He(P,M.ADD_URI_SAFE_ATTR,Mt),M.FORBID_CONTENTS&&(Ar===k&&(Ar=Ra(Ar)),He(Ar,M.FORBID_CONTENTS,Mt)),Hn&&(W["#text"]=!0),Jt&&He(W,["html","head","body"]),W.table&&(He(W,["tbody"]),delete xe.tbody),M.TRUSTED_TYPES_POLICY){if(typeof M.TRUSTED_TYPES_POLICY.createHTML!="function")throw du('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof M.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw du('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=M.TRUSTED_TYPES_POLICY,w=E.createHTML("")}else E===void 0&&(E=mB(h,i)),E!==null&&typeof w=="string"&&(w=E.createHTML(""));ir&&ir(M),Wi=M}},Yc=He({},["mi","mo","mn","ms","mtext"]),yl=He({},["foreignobject","annotation-xml"]),Cl=He({},["title","style","font","a","script"]),of=He({},[...am,...lm,...oB]),sf=He({},[...cm,...sB]),D=function(M){let ie=S(M);(!ie||!ie.tagName)&&(ie={namespaceURI:qe,tagName:"template"});const fe=ch(M.tagName),tt=ch(ie.tagName);return ct[M.namespaceURI]?M.namespaceURI===$?ie.namespaceURI===_e?fe==="svg":ie.namespaceURI===j?fe==="svg"&&(tt==="annotation-xml"||Yc[tt]):!!of[fe]:M.namespaceURI===j?ie.namespaceURI===_e?fe==="math":ie.namespaceURI===$?fe==="math"&&yl[tt]:!!sf[fe]:M.namespaceURI===_e?ie.namespaceURI===$&&!yl[tt]||ie.namespaceURI===j&&!Yc[tt]?!1:!sf[fe]&&(Cl[fe]||!of[fe]):!!(Gi==="application/xhtml+xml"&&ct[M.namespaceURI]):!1},F=function(M){cu(e.removed,{element:M});try{S(M).removeChild(M)}catch{C(M)}},H=function(M,ie){try{cu(e.removed,{attribute:ie.getAttributeNode(M),from:ie})}catch{cu(e.removed,{attribute:null,from:ie})}if(ie.removeAttribute(M),M==="is"&&!we[M])if(Ge||We)try{F(ie)}catch{}else try{ie.setAttribute(M,"")}catch{}},q=function(M){let ie=null,fe=null;if(ve)M="<remove></remove>"+M;else{const Rt=Zb(M,/^[\r\n\t ]+/);fe=Rt&&Rt[0]}Gi==="application/xhtml+xml"&&qe===_e&&(M='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+M+"</body></html>");const tt=E?E.createHTML(M):M;if(qe===_e)try{ie=new f().parseFromString(tt,Gi)}catch{}if(!ie||!ie.documentElement){ie=A.createDocument(qe,"template",null);try{ie.documentElement.innerHTML=it?w:tt}catch{}}const It=ie.body||ie.documentElement;return M&&fe&&It.insertBefore(n.createTextNode(fe),It.childNodes[0]||null),qe===_e?_.call(ie,Jt?"html":"body")[0]:Jt?ie.documentElement:It},me=function(M){return x.call(M.ownerDocument||M,M,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},ke=function(M){return M instanceof d&&(typeof M.nodeName!="string"||typeof M.textContent!="string"||typeof M.removeChild!="function"||!(M.attributes instanceof u)||typeof M.removeAttribute!="function"||typeof M.setAttribute!="function"||typeof M.namespaceURI!="string"||typeof M.insertBefore!="function"||typeof M.hasChildNodes!="function")},Pe=function(M){return typeof a=="function"&&M instanceof a},ce=function(M,ie,fe){L[M]&&xf(L[M],tt=>{tt.call(e,ie,fe,Wi)})},Le=function(M){let ie=null;if(ce("beforeSanitizeElements",M,null),ke(M))return F(M),!0;const fe=Mt(M.nodeName);if(ce("uponSanitizeElement",M,{tagName:fe,allowedTags:W}),M.hasChildNodes()&&!Pe(M.firstElementChild)&&zn(/<[/\w]/g,M.innerHTML)&&zn(/<[/\w]/g,M.textContent)||M.nodeType===hu.progressingInstruction||Zt&&M.nodeType===hu.comment&&zn(/<[/\w]/g,M.data))return F(M),!0;if(!W[fe]||xe[fe]){if(!xe[fe]&&Re(fe)&&(de.tagNameCheck instanceof RegExp&&zn(de.tagNameCheck,fe)||de.tagNameCheck instanceof Function&&de.tagNameCheck(fe)))return!1;if(Hn&&!Ar[fe]){const tt=S(M)||M.parentNode,It=v(M)||M.childNodes;if(It&&tt){const Rt=It.length;for(let Ht=Rt-1;Ht>=0;--Ht){const Cn=g(It[Ht],!0);Cn.__removalCount=(M.__removalCount||0)+1,tt.insertBefore(Cn,m(M))}}}return F(M),!0}return M instanceof l&&!D(M)||(fe==="noscript"||fe==="noembed"||fe==="noframes")&&zn(/<\/no(script|embed|frames)/i,M.innerHTML)?(F(M),!0):($e&&M.nodeType===hu.text&&(ie=M.textContent,xf([U,z,Z],tt=>{ie=uu(ie,tt," ")}),M.textContent!==ie&&(cu(e.removed,{element:M.cloneNode()}),M.textContent=ie)),ce("afterSanitizeElements",M,null),!1)},Te=function(M,ie,fe){if(Je&&(ie==="id"||ie==="name")&&(fe in n||fe in Cg))return!1;if(!(tn&&!rt[ie]&&zn(K,ie))){if(!(Ce&&zn(ee,ie))){if(!we[ie]||rt[ie]){if(!(Re(M)&&(de.tagNameCheck instanceof RegExp&&zn(de.tagNameCheck,M)||de.tagNameCheck instanceof Function&&de.tagNameCheck(M))&&(de.attributeNameCheck instanceof RegExp&&zn(de.attributeNameCheck,ie)||de.attributeNameCheck instanceof Function&&de.attributeNameCheck(ie))||ie==="is"&&de.allowCustomizedBuiltInElements&&(de.tagNameCheck instanceof RegExp&&zn(de.tagNameCheck,fe)||de.tagNameCheck instanceof Function&&de.tagNameCheck(fe))))return!1}else if(!P[ie]){if(!zn(oe,uu(fe,X,""))){if(!((ie==="src"||ie==="xlink:href"||ie==="href")&&M!=="script"&&tB(fe,"data:")===0&&y[M])){if(!(vn&&!zn(re,uu(fe,X,"")))){if(fe)return!1}}}}}}return!0},Re=function(M){return M!=="annotation-xml"&&Zb(M,J)},ot=function(M){ce("beforeSanitizeAttributes",M,null);const{attributes:ie}=M;if(!ie)return;const fe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:we};let tt=ie.length;for(;tt--;){const It=ie[tt],{name:Rt,namespaceURI:Ht,value:Cn}=It,Mn=Mt(Rt);let Yt=Rt==="value"?Cn:nB(Cn);if(fe.attrName=Mn,fe.attrValue=Yt,fe.keepAttr=!0,fe.forceKeepAttr=void 0,ce("uponSanitizeAttribute",M,fe),Yt=fe.attrValue,Zt&&zn(/((--!?|])>)|<\/(style|title)/i,Yt)){H(Rt,M);continue}if(fe.forceKeepAttr||(H(Rt,M),!fe.keepAttr))continue;if(!Zn&&zn(/\/>/i,Yt)){H(Rt,M);continue}$e&&xf([U,z,Z],Aa=>{Yt=uu(Yt,Aa," ")});const wa=Mt(M.nodeName);if(Te(wa,Mn,Yt)){if(Ut&&(Mn==="id"||Mn==="name")&&(H(Rt,M),Yt=_t+Yt),E&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!Ht)switch(h.getAttributeType(wa,Mn)){case"TrustedHTML":{Yt=E.createHTML(Yt);break}case"TrustedScriptURL":{Yt=E.createScriptURL(Yt);break}}try{Ht?M.setAttributeNS(Ht,Rt,Yt):M.setAttribute(Rt,Yt),ke(M)?F(M):jb(e.removed)}catch{}}}ce("afterSanitizeAttributes",M,null)},st=function ue(M){let ie=null;const fe=me(M);for(ce("beforeSanitizeShadowDOM",M,null);ie=fe.nextNode();)ce("uponSanitizeShadowNode",ie,null),!Le(ie)&&(ie.content instanceof o&&ue(ie.content),ot(ie));ce("afterSanitizeShadowDOM",M,null)};return e.sanitize=function(ue){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ie=null,fe=null,tt=null,It=null;if(it=!ue,it&&(ue="<!-->"),typeof ue!="string"&&!Pe(ue))if(typeof ue.toString=="function"){if(ue=ue.toString(),typeof ue!="string")throw du("dirty is not a string, aborting")}else throw du("toString is not a function");if(!e.isSupported)return ue;if(he||Jc(M),e.removed=[],typeof ue=="string"&&(yn=!1),yn){if(ue.nodeName){const Cn=Mt(ue.nodeName);if(!W[Cn]||xe[Cn])throw du("root node is forbidden and cannot be sanitized in-place")}}else if(ue instanceof a)ie=q("<!---->"),fe=ie.ownerDocument.importNode(ue,!0),fe.nodeType===hu.element&&fe.nodeName==="BODY"||fe.nodeName==="HTML"?ie=fe:ie.appendChild(fe);else{if(!Ge&&!$e&&!Jt&&ue.indexOf("<")===-1)return E&&Oe?E.createHTML(ue):ue;if(ie=q(ue),!ie)return Ge?null:Oe?w:""}ie&&ve&&F(ie.firstChild);const Rt=me(yn?ue:ie);for(;tt=Rt.nextNode();)Le(tt)||(tt.content instanceof o&&st(tt.content),ot(tt));if(yn)return ue;if(Ge){if(We)for(It=T.call(ie.ownerDocument);ie.firstChild;)It.appendChild(ie.firstChild);else It=ie;return(we.shadowroot||we.shadowrootmode)&&(It=O.call(r,It,!0)),It}let Ht=Jt?ie.outerHTML:ie.innerHTML;return Jt&&W["!doctype"]&&ie.ownerDocument&&ie.ownerDocument.doctype&&ie.ownerDocument.doctype.name&&zn(mT,ie.ownerDocument.doctype.name)&&(Ht="<!DOCTYPE "+ie.ownerDocument.doctype.name+`>
`+Ht),$e&&xf([U,z,Z],Cn=>{Ht=uu(Ht,Cn," ")}),E&&Oe?E.createHTML(Ht):Ht},e.setConfig=function(){let ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Jc(ue),he=!0},e.clearConfig=function(){Wi=null,he=!1},e.isValidAttribute=function(ue,M,ie){Wi||Jc({});const fe=Mt(ue),tt=Mt(M);return Te(fe,tt,ie)},e.addHook=function(ue,M){typeof M=="function"&&(L[ue]=L[ue]||[],cu(L[ue],M))},e.removeHook=function(ue){if(L[ue])return jb(L[ue])},e.removeHooks=function(ue){L[ue]&&(L[ue]=[])},e.removeAllHooks=function(){L={}},e}var vB=vT();const Oa=class Oa extends dt.Component{constructor(n){super(n);G(this,"outputRef",dt.createRef());G(this,"messageKey",0);G(this,"saveOutput",()=>{const n=this.state.output.map(r=>ca.renderToStaticMarkup(r));localStorage.setItem(Oa.LOCAL_STORAGE_KEY,JSON.stringify(n))});G(this,"loadOutput",()=>{const n=localStorage.getItem(Oa.LOCAL_STORAGE_KEY);return n?JSON.parse(n).map(i=>dt.createElement("div",{dangerouslySetInnerHTML:{__html:i}})):[]});G(this,"addCommand",n=>{this.addToOutput([Y.jsx("span",{className:"command","aria-live":"off",children:n})],!1)});G(this,"addError",n=>this.addToOutput([Y.jsxs("h2",{children:[" Error: ",n.message]})]));G(this,"handleConnected",()=>this.addToOutput([Y.jsx("h2",{children:" Connected"})]));G(this,"handleDisconnected",()=>{this.addToOutput([Y.jsx("h2",{children:" Disconnected"})]),this.setState({sidebarVisible:!1})});G(this,"handleUserList",n=>this.setState({sidebarVisible:!!n}));G(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});G(this,"isScrolledToBottom",()=>{const n=this.outputRef.current;return n?n.scrollHeight-n.scrollTop<=n.clientHeight+1:!1});G(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});G(this,"scrollToBottom",()=>{const n=this.outputRef.current;n&&(n.scrollTop=n.scrollHeight)});G(this,"handleMessage",n=>{if(!n)return;const r=FD(n,this.handleExitClick);this.addToOutput(r)});G(this,"handleHtml",n=>{const r=vB.sanitize(n),i=Y.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}});this.addToOutput([i])});G(this,"handleExitClick",n=>{this.props.client.sendCommand(n)});this.state={output:this.loadOutput(),sidebarVisible:!1,newLinesCount:0}}getSnapshotBeforeUpdate(n,r){if(this.outputRef.current){const i=this.outputRef.current;return i.scrollHeight-i.scrollTop<=i.clientHeight}return null}componentDidUpdate(n,r,i){i&&this.scrollToBottom(),this.state.output.length>r.output.length&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState({newLinesCount:this.state.newLinesCount+(this.state.output.length-r.output.length)})),this.saveOutput()}componentDidMount(){const{client:n}=this.props;n.on("message",this.handleMessage),n.on("html",this.handleHtml),n.on("connect",this.handleConnected),n.on("disconnect",this.handleDisconnected),n.on("error",this.addError),n.on("command",this.addCommand),n.on("userlist",this.handleUserList)}componentWillUnmount(){const{client:n}=this.props;n.removeListener("message",this.handleMessage),n.removeListener("html",this.handleHtml),n.removeListener("connect",this.handleConnected),n.removeListener("disconnect",this.handleDisconnected),n.removeListener("error",this.addError),n.removeListener("command",this.addCommand),n.removeListener("userlist",this.handleUserList)}sanitizeHtml(n){return new DOMParser().parseFromString(n,"text/html").body.textContent||""}addToOutput(n,r=!0){r&&n.forEach(i=>{if(dt.isValidElement(i)){const o=ca.renderToString(i),s=this.sanitizeHtml(o);$S(s)}else typeof i=="string"&&$S(i)}),this.setState(i=>{const o=n.map((l,c)=>Y.jsx("div",{children:l},this.messageKey+c));return this.messageKey+=n.length,{output:[...i.output,...o].slice(-Oa.MAX_OUTPUT_LENGTH)}})}saveLog(){const n=this.outputRef.current;if(n){const r=n.innerHTML,i=new Blob([r],{type:"text/html"}),o=URL.createObjectURL(i),s=document.createElement("a"),a=new Date,l=a.toLocaleDateString(),c=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=`${document.title.replace(/\s+/g,"-")}-log-${l}-${c}.html`;s.download=d,s.href=o,s.click(),URL.revokeObjectURL(o),s.remove()}}clearLog(){this.setState({output:[]})}render(){var n="output";this.state.sidebarVisible&&(n+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return Y.jsxs("div",{ref:this.outputRef,className:n,onScroll:this.handleScroll,children:[this.state.output,this.state.newLinesCount>0&&Y.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};G(Oa,"MAX_OUTPUT_LENGTH",5e3),G(Oa,"LOCAL_STORAGE_KEY","outputLog");let zv=Oa;var yT={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function o(l,c,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new i(u,d||l,f),p=n?n+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],h]:l._events[p].push(h):(l._events[p]=h,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,f,h,p){var g=n?n+c:c;if(!this._events[g])return!1;var C=this._events[g],m=arguments.length,v,S;if(C.fn){switch(C.once&&this.removeListener(c,C.fn,void 0,!0),m){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,u),!0;case 3:return C.fn.call(C.context,u,d),!0;case 4:return C.fn.call(C.context,u,d,f),!0;case 5:return C.fn.call(C.context,u,d,f,h),!0;case 6:return C.fn.call(C.context,u,d,f,h,p),!0}for(S=1,v=new Array(m-1);S<m;S++)v[S-1]=arguments[S];C.fn.apply(C.context,v)}else{var E=C.length,w;for(S=0;S<E;S++)switch(C[S].once&&this.removeListener(c,C[S].fn,void 0,!0),m){case 1:C[S].fn.call(C[S].context);break;case 2:C[S].fn.call(C[S].context,u);break;case 3:C[S].fn.call(C[S].context,u,d);break;case 4:C[S].fn.call(C[S].context,u,d,f);break;default:if(!v)for(w=1,v=new Array(m-1);w<m;w++)v[w-1]=arguments[w];C[S].fn.apply(C[S].context,v)}}return!0},a.prototype.on=function(c,u,d){return o(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return o(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,f){var h=n?n+c:c;if(!this._events[h])return this;if(!u)return s(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&s(this,h);else{for(var g=0,C=[],m=p.length;g<m;g++)(p[g].fn!==u||f&&!p[g].once||d&&p[g].context!==d)&&C.push(p[g]);C.length?this._events[h]=C.length===1?C[0]:C:s(this,h)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&s(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(yT);var yB=yT.exports;const CT=Bd(yB);var In={},tg={};tg.byteLength=SB;tg.toByteArray=wB;tg.fromByteArray=EB;var Ji=[],$r=[],CB=typeof Uint8Array<"u"?Uint8Array:Array,dm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var bl=0,IB=dm.length;bl<IB;++bl)Ji[bl]=dm[bl],$r[dm.charCodeAt(bl)]=bl;$r[45]=62;$r[95]=63;function IT(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function SB(t){var e=IT(t),n=e[0],r=e[1];return(n+r)*3/4-r}function bB(t,e,n){return(e+n)*3/4-n}function wB(t){var e,n=IT(t),r=n[0],i=n[1],o=new CB(bB(t,r,i)),s=0,a=i>0?r-4:r,l;for(l=0;l<a;l+=4)e=$r[t.charCodeAt(l)]<<18|$r[t.charCodeAt(l+1)]<<12|$r[t.charCodeAt(l+2)]<<6|$r[t.charCodeAt(l+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=$r[t.charCodeAt(l)]<<2|$r[t.charCodeAt(l+1)]>>4,o[s++]=e&255),i===1&&(e=$r[t.charCodeAt(l)]<<10|$r[t.charCodeAt(l+1)]<<4|$r[t.charCodeAt(l+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function AB(t){return Ji[t>>18&63]+Ji[t>>12&63]+Ji[t>>6&63]+Ji[t&63]}function kB(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(AB(r));return i.join("")}function EB(t){for(var e,n=t.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(kB(t,s,s+o>a?a:s+o));return r===1?(e=t[n-1],i.push(Ji[e>>2]+Ji[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(Ji[e>>10]+Ji[e>>4&63]+Ji[e<<2&63]+"=")),i.join("")}var yC={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */yC.read=function(t,e,n,r,i){var o,s,a=i*8-r-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?i-1:0,f=n?-1:1,h=t[e+d];for(d+=f,o=h&(1<<-u)-1,h>>=-u,u+=a;u>0;o=o*256+t[e+d],d+=f,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=s*256+t[e+d],d+=f,u-=8);if(o===0)o=1-c;else{if(o===l)return s?NaN:(h?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-c}return(h?-1:1)*s*Math.pow(2,o-r)};yC.write=function(t,e,n,r,i,o){var s,a,l,c=o*8-i-1,u=(1<<c)-1,d=u>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+d>=1?e+=f/l:e+=f*Math.pow(2,1-d),e*l>=2&&(s++,l/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(e*l-1)*Math.pow(2,i),s=s+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;t[n+h]=a&255,h+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+h]=s&255,h+=p,s/=256,c-=8);t[n+h-p]|=g*128};(function(t){const e=tg,n=yC,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const k=new Uint8Array(1),y={foo:function(){return 42}};return Object.setPrototypeOf(y,Uint8Array.prototype),Object.setPrototypeOf(k,y),k.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(k){if(k>i)throw new RangeError('The value "'+k+'" is invalid for option "size"');const y=new Uint8Array(k);return Object.setPrototypeOf(y,a.prototype),y}function a(k,y,I){if(typeof k=="number"){if(typeof y=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(k)}return l(k,y,I)}a.poolSize=8192;function l(k,y,I){if(typeof k=="string")return f(k,y);if(ArrayBuffer.isView(k))return p(k);if(k==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k);if(_t(k,ArrayBuffer)||k&&_t(k.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(_t(k,SharedArrayBuffer)||k&&_t(k.buffer,SharedArrayBuffer)))return g(k,y,I);if(typeof k=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const P=k.valueOf&&k.valueOf();if(P!=null&&P!==k)return a.from(P,y,I);const B=C(k);if(B)return B;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof k[Symbol.toPrimitive]=="function")return a.from(k[Symbol.toPrimitive]("string"),y,I);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k)}a.from=function(k,y,I){return l(k,y,I)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(k){if(typeof k!="number")throw new TypeError('"size" argument must be of type number');if(k<0)throw new RangeError('The value "'+k+'" is invalid for option "size"')}function u(k,y,I){return c(k),k<=0?s(k):y!==void 0?typeof I=="string"?s(k).fill(y,I):s(k).fill(y):s(k)}a.alloc=function(k,y,I){return u(k,y,I)};function d(k){return c(k),s(k<0?0:m(k)|0)}a.allocUnsafe=function(k){return d(k)},a.allocUnsafeSlow=function(k){return d(k)};function f(k,y){if((typeof y!="string"||y==="")&&(y="utf8"),!a.isEncoding(y))throw new TypeError("Unknown encoding: "+y);const I=S(k,y)|0;let P=s(I);const B=P.write(k,y);return B!==I&&(P=P.slice(0,B)),P}function h(k){const y=k.length<0?0:m(k.length)|0,I=s(y);for(let P=0;P<y;P+=1)I[P]=k[P]&255;return I}function p(k){if(_t(k,Uint8Array)){const y=new Uint8Array(k);return g(y.buffer,y.byteOffset,y.byteLength)}return h(k)}function g(k,y,I){if(y<0||k.byteLength<y)throw new RangeError('"offset" is outside of buffer bounds');if(k.byteLength<y+(I||0))throw new RangeError('"length" is outside of buffer bounds');let P;return y===void 0&&I===void 0?P=new Uint8Array(k):I===void 0?P=new Uint8Array(k,y):P=new Uint8Array(k,y,I),Object.setPrototypeOf(P,a.prototype),P}function C(k){if(a.isBuffer(k)){const y=m(k.length)|0,I=s(y);return I.length===0||k.copy(I,0,0,y),I}if(k.length!==void 0)return typeof k.length!="number"||Hn(k.length)?s(0):h(k);if(k.type==="Buffer"&&Array.isArray(k.data))return h(k.data)}function m(k){if(k>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return k|0}function v(k){return+k!=k&&(k=0),a.alloc(+k)}a.isBuffer=function(y){return y!=null&&y._isBuffer===!0&&y!==a.prototype},a.compare=function(y,I){if(_t(y,Uint8Array)&&(y=a.from(y,y.offset,y.byteLength)),_t(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),!a.isBuffer(y)||!a.isBuffer(I))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(y===I)return 0;let P=y.length,B=I.length;for(let j=0,$=Math.min(P,B);j<$;++j)if(y[j]!==I[j]){P=y[j],B=I[j];break}return P<B?-1:B<P?1:0},a.isEncoding=function(y){switch(String(y).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(y,I){if(!Array.isArray(y))throw new TypeError('"list" argument must be an Array of Buffers');if(y.length===0)return a.alloc(0);let P;if(I===void 0)for(I=0,P=0;P<y.length;++P)I+=y[P].length;const B=a.allocUnsafe(I);let j=0;for(P=0;P<y.length;++P){let $=y[P];if(_t($,Uint8Array))j+$.length>B.length?(a.isBuffer($)||($=a.from($)),$.copy(B,j)):Uint8Array.prototype.set.call(B,$,j);else if(a.isBuffer($))$.copy(B,j);else throw new TypeError('"list" argument must be an Array of Buffers');j+=$.length}return B};function S(k,y){if(a.isBuffer(k))return k.length;if(ArrayBuffer.isView(k)||_t(k,ArrayBuffer))return k.byteLength;if(typeof k!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof k);const I=k.length,P=arguments.length>2&&arguments[2]===!0;if(!P&&I===0)return 0;let B=!1;for(;;)switch(y){case"ascii":case"latin1":case"binary":return I;case"utf8":case"utf-8":return Ge(k).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I*2;case"hex":return I>>>1;case"base64":return Je(k).length;default:if(B)return P?-1:Ge(k).length;y=(""+y).toLowerCase(),B=!0}}a.byteLength=S;function E(k,y,I){let P=!1;if((y===void 0||y<0)&&(y=0),y>this.length||((I===void 0||I>this.length)&&(I=this.length),I<=0)||(I>>>=0,y>>>=0,I<=y))return"";for(k||(k="utf8");;)switch(k){case"hex":return J(this,y,I);case"utf8":case"utf-8":return Z(this,y,I);case"ascii":return re(this,y,I);case"latin1":case"binary":return X(this,y,I);case"base64":return z(this,y,I);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,y,I);default:if(P)throw new TypeError("Unknown encoding: "+k);k=(k+"").toLowerCase(),P=!0}}a.prototype._isBuffer=!0;function w(k,y,I){const P=k[y];k[y]=k[I],k[I]=P}a.prototype.swap16=function(){const y=this.length;if(y%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let I=0;I<y;I+=2)w(this,I,I+1);return this},a.prototype.swap32=function(){const y=this.length;if(y%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let I=0;I<y;I+=4)w(this,I,I+3),w(this,I+1,I+2);return this},a.prototype.swap64=function(){const y=this.length;if(y%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let I=0;I<y;I+=8)w(this,I,I+7),w(this,I+1,I+6),w(this,I+2,I+5),w(this,I+3,I+4);return this},a.prototype.toString=function(){const y=this.length;return y===0?"":arguments.length===0?Z(this,0,y):E.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(y){if(!a.isBuffer(y))throw new TypeError("Argument must be a Buffer");return this===y?!0:a.compare(this,y)===0},a.prototype.inspect=function(){let y="";const I=t.INSPECT_MAX_BYTES;return y=this.toString("hex",0,I).replace(/(.{2})/g,"$1 ").trim(),this.length>I&&(y+=" ... "),"<Buffer "+y+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(y,I,P,B,j){if(_t(y,Uint8Array)&&(y=a.from(y,y.offset,y.byteLength)),!a.isBuffer(y))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof y);if(I===void 0&&(I=0),P===void 0&&(P=y?y.length:0),B===void 0&&(B=0),j===void 0&&(j=this.length),I<0||P>y.length||B<0||j>this.length)throw new RangeError("out of range index");if(B>=j&&I>=P)return 0;if(B>=j)return-1;if(I>=P)return 1;if(I>>>=0,P>>>=0,B>>>=0,j>>>=0,this===y)return 0;let $=j-B,_e=P-I;const qe=Math.min($,_e),it=this.slice(B,j),ct=y.slice(I,P);for(let et=0;et<qe;++et)if(it[et]!==ct[et]){$=it[et],_e=ct[et];break}return $<_e?-1:_e<$?1:0};function A(k,y,I,P,B){if(k.length===0)return-1;if(typeof I=="string"?(P=I,I=0):I>2147483647?I=2147483647:I<-2147483648&&(I=-2147483648),I=+I,Hn(I)&&(I=B?0:k.length-1),I<0&&(I=k.length+I),I>=k.length){if(B)return-1;I=k.length-1}else if(I<0)if(B)I=0;else return-1;if(typeof y=="string"&&(y=a.from(y,P)),a.isBuffer(y))return y.length===0?-1:x(k,y,I,P,B);if(typeof y=="number")return y=y&255,typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(k,y,I):Uint8Array.prototype.lastIndexOf.call(k,y,I):x(k,[y],I,P,B);throw new TypeError("val must be string, number or Buffer")}function x(k,y,I,P,B){let j=1,$=k.length,_e=y.length;if(P!==void 0&&(P=String(P).toLowerCase(),P==="ucs2"||P==="ucs-2"||P==="utf16le"||P==="utf-16le")){if(k.length<2||y.length<2)return-1;j=2,$/=2,_e/=2,I/=2}function qe(ct,et){return j===1?ct[et]:ct.readUInt16BE(et*j)}let it;if(B){let ct=-1;for(it=I;it<$;it++)if(qe(k,it)===qe(y,ct===-1?0:it-ct)){if(ct===-1&&(ct=it),it-ct+1===_e)return ct*j}else ct!==-1&&(it-=it-ct),ct=-1}else for(I+_e>$&&(I=$-_e),it=I;it>=0;it--){let ct=!0;for(let et=0;et<_e;et++)if(qe(k,it+et)!==qe(y,et)){ct=!1;break}if(ct)return it}return-1}a.prototype.includes=function(y,I,P){return this.indexOf(y,I,P)!==-1},a.prototype.indexOf=function(y,I,P){return A(this,y,I,P,!0)},a.prototype.lastIndexOf=function(y,I,P){return A(this,y,I,P,!1)};function T(k,y,I,P){I=Number(I)||0;const B=k.length-I;P?(P=Number(P),P>B&&(P=B)):P=B;const j=y.length;P>j/2&&(P=j/2);let $;for($=0;$<P;++$){const _e=parseInt(y.substr($*2,2),16);if(Hn(_e))return $;k[I+$]=_e}return $}function _(k,y,I,P){return Ut(Ge(y,k.length-I),k,I,P)}function O(k,y,I,P){return Ut(We(y),k,I,P)}function L(k,y,I,P){return Ut(Je(y),k,I,P)}function U(k,y,I,P){return Ut(Oe(y,k.length-I),k,I,P)}a.prototype.write=function(y,I,P,B){if(I===void 0)B="utf8",P=this.length,I=0;else if(P===void 0&&typeof I=="string")B=I,P=this.length,I=0;else if(isFinite(I))I=I>>>0,isFinite(P)?(P=P>>>0,B===void 0&&(B="utf8")):(B=P,P=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const j=this.length-I;if((P===void 0||P>j)&&(P=j),y.length>0&&(P<0||I<0)||I>this.length)throw new RangeError("Attempt to write outside buffer bounds");B||(B="utf8");let $=!1;for(;;)switch(B){case"hex":return T(this,y,I,P);case"utf8":case"utf-8":return _(this,y,I,P);case"ascii":case"latin1":case"binary":return O(this,y,I,P);case"base64":return L(this,y,I,P);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,y,I,P);default:if($)throw new TypeError("Unknown encoding: "+B);B=(""+B).toLowerCase(),$=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function z(k,y,I){return y===0&&I===k.length?e.fromByteArray(k):e.fromByteArray(k.slice(y,I))}function Z(k,y,I){I=Math.min(k.length,I);const P=[];let B=y;for(;B<I;){const j=k[B];let $=null,_e=j>239?4:j>223?3:j>191?2:1;if(B+_e<=I){let qe,it,ct,et;switch(_e){case 1:j<128&&($=j);break;case 2:qe=k[B+1],(qe&192)===128&&(et=(j&31)<<6|qe&63,et>127&&($=et));break;case 3:qe=k[B+1],it=k[B+2],(qe&192)===128&&(it&192)===128&&(et=(j&15)<<12|(qe&63)<<6|it&63,et>2047&&(et<55296||et>57343)&&($=et));break;case 4:qe=k[B+1],it=k[B+2],ct=k[B+3],(qe&192)===128&&(it&192)===128&&(ct&192)===128&&(et=(j&15)<<18|(qe&63)<<12|(it&63)<<6|ct&63,et>65535&&et<1114112&&($=et))}}$===null?($=65533,_e=1):$>65535&&($-=65536,P.push($>>>10&1023|55296),$=56320|$&1023),P.push($),B+=_e}return ee(P)}const K=4096;function ee(k){const y=k.length;if(y<=K)return String.fromCharCode.apply(String,k);let I="",P=0;for(;P<y;)I+=String.fromCharCode.apply(String,k.slice(P,P+=K));return I}function re(k,y,I){let P="";I=Math.min(k.length,I);for(let B=y;B<I;++B)P+=String.fromCharCode(k[B]&127);return P}function X(k,y,I){let P="";I=Math.min(k.length,I);for(let B=y;B<I;++B)P+=String.fromCharCode(k[B]);return P}function J(k,y,I){const P=k.length;(!y||y<0)&&(y=0),(!I||I<0||I>P)&&(I=P);let B="";for(let j=y;j<I;++j)B+=yn[k[j]];return B}function oe(k,y,I){const P=k.slice(y,I);let B="";for(let j=0;j<P.length-1;j+=2)B+=String.fromCharCode(P[j]+P[j+1]*256);return B}a.prototype.slice=function(y,I){const P=this.length;y=~~y,I=I===void 0?P:~~I,y<0?(y+=P,y<0&&(y=0)):y>P&&(y=P),I<0?(I+=P,I<0&&(I=0)):I>P&&(I=P),I<y&&(I=y);const B=this.subarray(y,I);return Object.setPrototypeOf(B,a.prototype),B};function W(k,y,I){if(k%1!==0||k<0)throw new RangeError("offset is not uint");if(k+y>I)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(y,I,P){y=y>>>0,I=I>>>0,P||W(y,I,this.length);let B=this[y],j=1,$=0;for(;++$<I&&(j*=256);)B+=this[y+$]*j;return B},a.prototype.readUintBE=a.prototype.readUIntBE=function(y,I,P){y=y>>>0,I=I>>>0,P||W(y,I,this.length);let B=this[y+--I],j=1;for(;I>0&&(j*=256);)B+=this[y+--I]*j;return B},a.prototype.readUint8=a.prototype.readUInt8=function(y,I){return y=y>>>0,I||W(y,1,this.length),this[y]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(y,I){return y=y>>>0,I||W(y,2,this.length),this[y]|this[y+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(y,I){return y=y>>>0,I||W(y,2,this.length),this[y]<<8|this[y+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(y,I){return y=y>>>0,I||W(y,4,this.length),(this[y]|this[y+1]<<8|this[y+2]<<16)+this[y+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(y,I){return y=y>>>0,I||W(y,4,this.length),this[y]*16777216+(this[y+1]<<16|this[y+2]<<8|this[y+3])},a.prototype.readBigUInt64LE=Ot(function(y){y=y>>>0,Zt(y,"offset");const I=this[y],P=this[y+7];(I===void 0||P===void 0)&&Jt(y,this.length-8);const B=I+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24,j=this[++y]+this[++y]*2**8+this[++y]*2**16+P*2**24;return BigInt(B)+(BigInt(j)<<BigInt(32))}),a.prototype.readBigUInt64BE=Ot(function(y){y=y>>>0,Zt(y,"offset");const I=this[y],P=this[y+7];(I===void 0||P===void 0)&&Jt(y,this.length-8);const B=I*2**24+this[++y]*2**16+this[++y]*2**8+this[++y],j=this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+P;return(BigInt(B)<<BigInt(32))+BigInt(j)}),a.prototype.readIntLE=function(y,I,P){y=y>>>0,I=I>>>0,P||W(y,I,this.length);let B=this[y],j=1,$=0;for(;++$<I&&(j*=256);)B+=this[y+$]*j;return j*=128,B>=j&&(B-=Math.pow(2,8*I)),B},a.prototype.readIntBE=function(y,I,P){y=y>>>0,I=I>>>0,P||W(y,I,this.length);let B=I,j=1,$=this[y+--B];for(;B>0&&(j*=256);)$+=this[y+--B]*j;return j*=128,$>=j&&($-=Math.pow(2,8*I)),$},a.prototype.readInt8=function(y,I){return y=y>>>0,I||W(y,1,this.length),this[y]&128?(255-this[y]+1)*-1:this[y]},a.prototype.readInt16LE=function(y,I){y=y>>>0,I||W(y,2,this.length);const P=this[y]|this[y+1]<<8;return P&32768?P|4294901760:P},a.prototype.readInt16BE=function(y,I){y=y>>>0,I||W(y,2,this.length);const P=this[y+1]|this[y]<<8;return P&32768?P|4294901760:P},a.prototype.readInt32LE=function(y,I){return y=y>>>0,I||W(y,4,this.length),this[y]|this[y+1]<<8|this[y+2]<<16|this[y+3]<<24},a.prototype.readInt32BE=function(y,I){return y=y>>>0,I||W(y,4,this.length),this[y]<<24|this[y+1]<<16|this[y+2]<<8|this[y+3]},a.prototype.readBigInt64LE=Ot(function(y){y=y>>>0,Zt(y,"offset");const I=this[y],P=this[y+7];(I===void 0||P===void 0)&&Jt(y,this.length-8);const B=this[y+4]+this[y+5]*2**8+this[y+6]*2**16+(P<<24);return(BigInt(B)<<BigInt(32))+BigInt(I+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24)}),a.prototype.readBigInt64BE=Ot(function(y){y=y>>>0,Zt(y,"offset");const I=this[y],P=this[y+7];(I===void 0||P===void 0)&&Jt(y,this.length-8);const B=(I<<24)+this[++y]*2**16+this[++y]*2**8+this[++y];return(BigInt(B)<<BigInt(32))+BigInt(this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+P)}),a.prototype.readFloatLE=function(y,I){return y=y>>>0,I||W(y,4,this.length),n.read(this,y,!0,23,4)},a.prototype.readFloatBE=function(y,I){return y=y>>>0,I||W(y,4,this.length),n.read(this,y,!1,23,4)},a.prototype.readDoubleLE=function(y,I){return y=y>>>0,I||W(y,8,this.length),n.read(this,y,!0,52,8)},a.prototype.readDoubleBE=function(y,I){return y=y>>>0,I||W(y,8,this.length),n.read(this,y,!1,52,8)};function se(k,y,I,P,B,j){if(!a.isBuffer(k))throw new TypeError('"buffer" argument must be a Buffer instance');if(y>B||y<j)throw new RangeError('"value" argument is out of bounds');if(I+P>k.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(y,I,P,B){if(y=+y,I=I>>>0,P=P>>>0,!B){const _e=Math.pow(2,8*P)-1;se(this,y,I,P,_e,0)}let j=1,$=0;for(this[I]=y&255;++$<P&&(j*=256);)this[I+$]=y/j&255;return I+P},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(y,I,P,B){if(y=+y,I=I>>>0,P=P>>>0,!B){const _e=Math.pow(2,8*P)-1;se(this,y,I,P,_e,0)}let j=P-1,$=1;for(this[I+j]=y&255;--j>=0&&($*=256);)this[I+j]=y/$&255;return I+P},a.prototype.writeUint8=a.prototype.writeUInt8=function(y,I,P){return y=+y,I=I>>>0,P||se(this,y,I,1,255,0),this[I]=y&255,I+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(y,I,P){return y=+y,I=I>>>0,P||se(this,y,I,2,65535,0),this[I]=y&255,this[I+1]=y>>>8,I+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(y,I,P){return y=+y,I=I>>>0,P||se(this,y,I,2,65535,0),this[I]=y>>>8,this[I+1]=y&255,I+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(y,I,P){return y=+y,I=I>>>0,P||se(this,y,I,4,4294967295,0),this[I+3]=y>>>24,this[I+2]=y>>>16,this[I+1]=y>>>8,this[I]=y&255,I+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(y,I,P){return y=+y,I=I>>>0,P||se(this,y,I,4,4294967295,0),this[I]=y>>>24,this[I+1]=y>>>16,this[I+2]=y>>>8,this[I+3]=y&255,I+4};function we(k,y,I,P,B){$e(y,P,B,k,I,7);let j=Number(y&BigInt(4294967295));k[I++]=j,j=j>>8,k[I++]=j,j=j>>8,k[I++]=j,j=j>>8,k[I++]=j;let $=Number(y>>BigInt(32)&BigInt(4294967295));return k[I++]=$,$=$>>8,k[I++]=$,$=$>>8,k[I++]=$,$=$>>8,k[I++]=$,I}function De(k,y,I,P,B){$e(y,P,B,k,I,7);let j=Number(y&BigInt(4294967295));k[I+7]=j,j=j>>8,k[I+6]=j,j=j>>8,k[I+5]=j,j=j>>8,k[I+4]=j;let $=Number(y>>BigInt(32)&BigInt(4294967295));return k[I+3]=$,$=$>>8,k[I+2]=$,$=$>>8,k[I+1]=$,$=$>>8,k[I]=$,I+8}a.prototype.writeBigUInt64LE=Ot(function(y,I=0){return we(this,y,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Ot(function(y,I=0){return De(this,y,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(y,I,P,B){if(y=+y,I=I>>>0,!B){const qe=Math.pow(2,8*P-1);se(this,y,I,P,qe-1,-qe)}let j=0,$=1,_e=0;for(this[I]=y&255;++j<P&&($*=256);)y<0&&_e===0&&this[I+j-1]!==0&&(_e=1),this[I+j]=(y/$>>0)-_e&255;return I+P},a.prototype.writeIntBE=function(y,I,P,B){if(y=+y,I=I>>>0,!B){const qe=Math.pow(2,8*P-1);se(this,y,I,P,qe-1,-qe)}let j=P-1,$=1,_e=0;for(this[I+j]=y&255;--j>=0&&($*=256);)y<0&&_e===0&&this[I+j+1]!==0&&(_e=1),this[I+j]=(y/$>>0)-_e&255;return I+P},a.prototype.writeInt8=function(y,I,P){return y=+y,I=I>>>0,P||se(this,y,I,1,127,-128),y<0&&(y=255+y+1),this[I]=y&255,I+1},a.prototype.writeInt16LE=function(y,I,P){return y=+y,I=I>>>0,P||se(this,y,I,2,32767,-32768),this[I]=y&255,this[I+1]=y>>>8,I+2},a.prototype.writeInt16BE=function(y,I,P){return y=+y,I=I>>>0,P||se(this,y,I,2,32767,-32768),this[I]=y>>>8,this[I+1]=y&255,I+2},a.prototype.writeInt32LE=function(y,I,P){return y=+y,I=I>>>0,P||se(this,y,I,4,2147483647,-2147483648),this[I]=y&255,this[I+1]=y>>>8,this[I+2]=y>>>16,this[I+3]=y>>>24,I+4},a.prototype.writeInt32BE=function(y,I,P){return y=+y,I=I>>>0,P||se(this,y,I,4,2147483647,-2147483648),y<0&&(y=4294967295+y+1),this[I]=y>>>24,this[I+1]=y>>>16,this[I+2]=y>>>8,this[I+3]=y&255,I+4},a.prototype.writeBigInt64LE=Ot(function(y,I=0){return we(this,y,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Ot(function(y,I=0){return De(this,y,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function de(k,y,I,P,B,j){if(I+P>k.length)throw new RangeError("Index out of range");if(I<0)throw new RangeError("Index out of range")}function xe(k,y,I,P,B){return y=+y,I=I>>>0,B||de(k,y,I,4),n.write(k,y,I,P,23,4),I+4}a.prototype.writeFloatLE=function(y,I,P){return xe(this,y,I,!0,P)},a.prototype.writeFloatBE=function(y,I,P){return xe(this,y,I,!1,P)};function rt(k,y,I,P,B){return y=+y,I=I>>>0,B||de(k,y,I,8),n.write(k,y,I,P,52,8),I+8}a.prototype.writeDoubleLE=function(y,I,P){return rt(this,y,I,!0,P)},a.prototype.writeDoubleBE=function(y,I,P){return rt(this,y,I,!1,P)},a.prototype.copy=function(y,I,P,B){if(!a.isBuffer(y))throw new TypeError("argument should be a Buffer");if(P||(P=0),!B&&B!==0&&(B=this.length),I>=y.length&&(I=y.length),I||(I=0),B>0&&B<P&&(B=P),B===P||y.length===0||this.length===0)return 0;if(I<0)throw new RangeError("targetStart out of bounds");if(P<0||P>=this.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("sourceEnd out of bounds");B>this.length&&(B=this.length),y.length-I<B-P&&(B=y.length-I+P);const j=B-P;return this===y&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(I,P,B):Uint8Array.prototype.set.call(y,this.subarray(P,B),I),j},a.prototype.fill=function(y,I,P,B){if(typeof y=="string"){if(typeof I=="string"?(B=I,I=0,P=this.length):typeof P=="string"&&(B=P,P=this.length),B!==void 0&&typeof B!="string")throw new TypeError("encoding must be a string");if(typeof B=="string"&&!a.isEncoding(B))throw new TypeError("Unknown encoding: "+B);if(y.length===1){const $=y.charCodeAt(0);(B==="utf8"&&$<128||B==="latin1")&&(y=$)}}else typeof y=="number"?y=y&255:typeof y=="boolean"&&(y=Number(y));if(I<0||this.length<I||this.length<P)throw new RangeError("Out of range index");if(P<=I)return this;I=I>>>0,P=P===void 0?this.length:P>>>0,y||(y=0);let j;if(typeof y=="number")for(j=I;j<P;++j)this[j]=y;else{const $=a.isBuffer(y)?y:a.from(y,B),_e=$.length;if(_e===0)throw new TypeError('The value "'+y+'" is invalid for argument "value"');for(j=0;j<P-I;++j)this[j+I]=$[j%_e]}return this};const Ce={};function tn(k,y,I){Ce[k]=class extends I{constructor(){super(),Object.defineProperty(this,"message",{value:y.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${k}]`,this.stack,delete this.name}get code(){return k}set code(B){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:B,writable:!0})}toString(){return`${this.name} [${k}]: ${this.message}`}}}tn("ERR_BUFFER_OUT_OF_BOUNDS",function(k){return k?`${k} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),tn("ERR_INVALID_ARG_TYPE",function(k,y){return`The "${k}" argument must be of type number. Received type ${typeof y}`},TypeError),tn("ERR_OUT_OF_RANGE",function(k,y,I){let P=`The value of "${k}" is out of range.`,B=I;return Number.isInteger(I)&&Math.abs(I)>2**32?B=vn(String(I)):typeof I=="bigint"&&(B=String(I),(I>BigInt(2)**BigInt(32)||I<-(BigInt(2)**BigInt(32)))&&(B=vn(B)),B+="n"),P+=` It must be ${y}. Received ${B}`,P},RangeError);function vn(k){let y="",I=k.length;const P=k[0]==="-"?1:0;for(;I>=P+4;I-=3)y=`_${k.slice(I-3,I)}${y}`;return`${k.slice(0,I)}${y}`}function Zn(k,y,I){Zt(y,"offset"),(k[y]===void 0||k[y+I]===void 0)&&Jt(y,k.length-(I+1))}function $e(k,y,I,P,B,j){if(k>I||k<y){const $=typeof y=="bigint"?"n":"";let _e;throw y===0||y===BigInt(0)?_e=`>= 0${$} and < 2${$} ** ${(j+1)*8}${$}`:_e=`>= -(2${$} ** ${(j+1)*8-1}${$}) and < 2 ** ${(j+1)*8-1}${$}`,new Ce.ERR_OUT_OF_RANGE("value",_e,k)}Zn(P,B,j)}function Zt(k,y){if(typeof k!="number")throw new Ce.ERR_INVALID_ARG_TYPE(y,"number",k)}function Jt(k,y,I){throw Math.floor(k)!==k?(Zt(k,I),new Ce.ERR_OUT_OF_RANGE("offset","an integer",k)):y<0?new Ce.ERR_BUFFER_OUT_OF_BOUNDS:new Ce.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${y}`,k)}const he=/[^+/0-9A-Za-z-_]/g;function ve(k){if(k=k.split("=")[0],k=k.trim().replace(he,""),k.length<2)return"";for(;k.length%4!==0;)k=k+"=";return k}function Ge(k,y){y=y||1/0;let I;const P=k.length;let B=null;const j=[];for(let $=0;$<P;++$){if(I=k.charCodeAt($),I>55295&&I<57344){if(!B){if(I>56319){(y-=3)>-1&&j.push(239,191,189);continue}else if($+1===P){(y-=3)>-1&&j.push(239,191,189);continue}B=I;continue}if(I<56320){(y-=3)>-1&&j.push(239,191,189),B=I;continue}I=(B-55296<<10|I-56320)+65536}else B&&(y-=3)>-1&&j.push(239,191,189);if(B=null,I<128){if((y-=1)<0)break;j.push(I)}else if(I<2048){if((y-=2)<0)break;j.push(I>>6|192,I&63|128)}else if(I<65536){if((y-=3)<0)break;j.push(I>>12|224,I>>6&63|128,I&63|128)}else if(I<1114112){if((y-=4)<0)break;j.push(I>>18|240,I>>12&63|128,I>>6&63|128,I&63|128)}else throw new Error("Invalid code point")}return j}function We(k){const y=[];for(let I=0;I<k.length;++I)y.push(k.charCodeAt(I)&255);return y}function Oe(k,y){let I,P,B;const j=[];for(let $=0;$<k.length&&!((y-=2)<0);++$)I=k.charCodeAt($),P=I>>8,B=I%256,j.push(B),j.push(P);return j}function Je(k){return e.toByteArray(ve(k))}function Ut(k,y,I,P){let B;for(B=0;B<P&&!(B+I>=y.length||B>=k.length);++B)y[B+I]=k[B];return B}function _t(k,y){return k instanceof y||k!=null&&k.constructor!=null&&k.constructor.name!=null&&k.constructor.name===y.name}function Hn(k){return k!==k}const yn=function(){const k="0123456789abcdef",y=new Array(256);for(let I=0;I<16;++I){const P=I*16;for(let B=0;B<16;++B)y[P+B]=k[I]+k[B]}return y}();function Ot(k){return typeof BigInt>"u"?Ar:k}function Ar(){throw new Error("BigInt not supported")}})(In);var Pu=(t=>(t[t.BINARY=0]="BINARY",t[t.ECHO=1]="ECHO",t[t.RCP=2]="RCP",t[t.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",t[t.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",t[t.STATUS=5]="STATUS",t[t.TIMING_MARK=6]="TIMING_MARK",t[t.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",t[t.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",t[t.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",t[t.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",t[t.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",t[t.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",t[t.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",t[t.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",t[t.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",t[t.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",t[t.EXTENDED_ASCII=17]="EXTENDED_ASCII",t[t.LOGOUT=18]="LOGOUT",t[t.BYTE_MACRO=19]="BYTE_MACRO",t[t.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",t[t.SUPDUP=21]="SUPDUP",t[t.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",t[t.SEND_LOCATION=23]="SEND_LOCATION",t[t.TERMINAL_TYPE=24]="TERMINAL_TYPE",t[t.END_OF_RECORD=25]="END_OF_RECORD",t[t.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",t[t.OUTPUT_MARKING=27]="OUTPUT_MARKING",t[t.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",t[t.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",t[t.X_3_PAD=30]="X_3_PAD",t[t.NAWS=31]="NAWS",t[t.TERMINAL_SPEED=32]="TERMINAL_SPEED",t[t.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",t[t.LINEMODE=34]="LINEMODE",t[t.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",t[t.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",t[t.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",t[t.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",t[t.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",t[t.TN3270E=40]="TN3270E",t[t.XAUTH=41]="XAUTH",t[t.CHARSET=42]="CHARSET",t[t.RSP=43]="RSP",t[t.COM_PORT_OPTION=44]="COM_PORT_OPTION",t[t.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",t[t.START_TLS=46]="START_TLS",t[t.KERMIT=47]="KERMIT",t[t.SEND_URL=48]="SEND_URL",t[t.FORWARD_X=49]="FORWARD_X",t[t.PRAGMA_LOGON=138]="PRAGMA_LOGON",t[t.GMCP=201]="GMCP",t))(Pu||{}),Nu=(t=>(t[t.SE=240]="SE",t[t.NOP=241]="NOP",t[t.DM=242]="DM",t[t.BRK=243]="BRK",t[t.IP=244]="IP",t[t.AO=245]="AO",t[t.AYT=246]="AYT",t[t.EC=247]="EC",t[t.EL=248]="EL",t[t.GA=249]="GA",t[t.SB=250]="SB",t[t.WILL=251]="WILL",t[t.WONT=252]="WONT",t[t.DO=253]="DO",t[t.DONT=254]="DONT",t[t.IAC=255]="IAC",t))(Nu||{});class TB{constructor(e){G(this,"ws");this.ws=e}on(e,n){if(e==="data"){this.ws.onmessage=i=>{n(i.data)};return}const r="on"+e;this[r]=n}write(e){this.ws.send(e)}}class RB extends CT{constructor(n){super();G(this,"state");G(this,"buffer");G(this,"subBuffer");G(this,"iacSEBuffer",In.Buffer.from([255,240]));G(this,"negotiationByte",0);G(this,"stream");this.state=0,this.buffer=In.Buffer.alloc(0),this.subBuffer=In.Buffer.alloc(0),n&&n.on("data",r=>this.parse(r)),this.stream=n}parse(n){for(this.buffer=In.Buffer.concat([this.buffer,In.Buffer.from(n)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const n=this.buffer.indexOf(255);if(n===-1){this.emit("data",this.buffer),this.buffer=In.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,n)),this.buffer=this.buffer.slice(n),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const n=this.buffer[1];switch(this.buffer=this.buffer.slice(2),n){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=In.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=n,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const n=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",n,r),this.state=0,!1}handleSubnegotiation(){let n=this.buffer.indexOf(this.iacSEBuffer);if(n===-1)return!0;this.state=0;let r=this.buffer.slice(0,n);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(n+2),!1}handleGmcp(n){const r=n.toString(),[i,o]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,o)}sendNegotiation(n,r){this.stream.write(In.Buffer.from([255,n,r]))}sendGmcp(n,r){const i=n+" "+r,o=In.Buffer.from(i),s=In.Buffer.concat([In.Buffer.from([255,250]),In.Buffer.from([201]),o,this.iacSEBuffer]);this.stream.write(s)}sendTerminalType(n){const r=In.Buffer.from(n),i=In.Buffer.concat([In.Buffer.from([255,250]),In.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}function xB({onlyFirst:t=!1}={}){const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,t?void 0:"g")}const PB=xB();function NB(t){if(typeof t!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof t}\``);return t.replace(PB,"")}class Io{constructor(e){G(this,"packageName");G(this,"packageVersion",1);G(this,"client");this.client=e}sendData(e,n){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(n))}shutdown(){}}class _B extends Io{constructor(){super(...arguments);G(this,"packageName","Auth.Autologin")}handleToken(n){localStorage.setItem("LoginRefreshToken",n)}sendLogin(){var n=localStorage.getItem("LoginRefreshToken");n&&this.sendData("Login",n)}}class OB extends Io{constructor(){super(...arguments);G(this,"packageName","Char")}handleName(n){this.client.worldData.playerId=n.name,this.client.worldData.playerName=n.fullname,this.client.emit("statustext",`Logged in as ${n.fullname}`)}sendLogin(n,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:n,password:r}))}}class MB extends Io{constructor(n){super(n);G(this,"packageName","Client.Keystrokes");G(this,"bindings",[]);G(this,"boundKeyUpHandler");document.addEventListener("keydown",r=>this.handleKeydown(r))}handleKeydown(n){const r=this.findBinding(n);if(r){n.preventDefault();const i=this.client.getInput(),o=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(o):this.placeInInputField(o)}}shutdown(){document.removeEventListener("keydown",n=>this.handleKeydown(n))}findBinding(n){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==n.key.toLowerCase())return!1;const i=new Set([n.altKey&&"Alt",n.ctrlKey&&"Control",n.shiftKey&&"Shift",n.metaKey&&"Meta"].filter(Boolean));return r.modifiers&&r.modifiers.every(o=>i.has(o))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(n,r){const i=r.trim().split(/\s+/);return n.replace(/%(\d+|\*)/g,(o,s)=>{if(s==="*")return r;const a=parseInt(s,10)-1;return a>=0&&a<i.length?i[a]:o})}placeInInputField(n){this.client.setInput(n)}bindKey(n){const r={key:n.key,modifiers:n.modifiers,command:n.command,autosend:n.autosend};this.bindings.push(r)}unbindKey(n){this.bindings=this.bindings.filter(r=>!(r.key===n.key&&r.modifiers.length===n.modifiers.length&&r.modifiers.every(i=>n.modifiers.includes(i))))}unbindAll(){this.bindings=[]}handleBind(n){this.bindKey(n)}handleUnbind(n){this.unbindKey(n)}handleBind_all(n){this.bindings=n.bindings.map(r=>({...r}))}listBindings(){return[...this.bindings]}}const Jb=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),Yb=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),Xv=(t,e)=>({startTime:e,type:"setValue",value:t}),ST=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),bT=(t,e,{startTime:n,target:r,timeConstant:i})=>r+(e-r)*Math.exp((n-t)/i),Gl=t=>t.type==="exponentialRampToValue",sp=t=>t.type==="linearRampToValue",Bs=t=>Gl(t)||sp(t),CC=t=>t.type==="setValue",xo=t=>t.type==="setValueCurve",ap=(t,e,n,r)=>{const i=t[e];return i===void 0?r:Bs(i)||CC(i)?i.value:xo(i)?i.values[i.values.length-1]:bT(n,ap(t,e-1,i.startTime,r),i)},Qb=(t,e,n,r,i)=>n===void 0?[r.insertTime,i]:Bs(n)?[n.endTime,n.value]:CC(n)?[n.startTime,n.value]:xo(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,ap(t,e-1,n.startTime,i)],$v=t=>t.type==="cancelAndHold",Kv=t=>t.type==="cancelScheduledValues",Es=t=>$v(t)||Kv(t)?t.cancelTime:Gl(t)||sp(t)?t.endTime:t.startTime,qb=(t,e,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((t-e)/(r-e)):0,ew=(t,e,n,{endTime:r,value:i})=>n+(t-e)/(r-e)*(i-n),DB=(t,e)=>{const n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},LB=(t,{duration:e,startTime:n,values:r})=>{const i=(t-n)/e*(r.length-1);return DB(r,i)},Nf=t=>t.type==="setTarget";class BB{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=Es(e);if($v(e)||Kv(e)){const r=this._automationEvents.findIndex(o=>Kv(e)&&xo(o)?o.startTime+o.duration>=n:Es(o)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),$v(e)){const o=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&Bs(i)){if(o!==void 0&&Nf(o))throw new Error("The internal list is malformed.");const s=o===void 0?i.insertTime:xo(o)?o.startTime+o.duration:Es(o),a=o===void 0?this._defaultValue:xo(o)?o.values[o.values.length-1]:o.value,l=Gl(i)?qb(n,s,a,i):ew(n,s,a,i),c=Gl(i)?Jb(l,n,this._currenTime):Yb(l,n,this._currenTime);this._automationEvents.push(c)}if(o!==void 0&&Nf(o)&&this._automationEvents.push(Xv(this.getValue(n),n)),o!==void 0&&xo(o)&&o.startTime+o.duration>n){const s=n-o.startTime,a=(o.values.length-1)/o.duration,l=Math.max(2,1+Math.ceil(s*a)),c=s/(l-1)*a,u=o.values.slice(0,l);if(c<1)for(let d=1;d<l;d+=1){const f=c*d%1;u[d]=o.values[d-1]*(1-f)+o.values[d]*f}this._automationEvents[this._automationEvents.length-1]=ST(u,o.startTime,s)}}}else{const r=this._automationEvents.findIndex(s=>Es(s)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&xo(i)&&Es(i)+i.duration>n)return!1;const o=Gl(e)?Jb(e.value,e.endTime,this._currenTime):sp(e)?Yb(e.value,n,this._currenTime):e;if(r===-1)this._automationEvents.push(o);else{if(xo(e)&&n+e.duration>Es(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(e){const n=this._automationEvents.findIndex(r=>Es(r)>e);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];Nf(i)&&r.unshift(Xv(ap(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(s=>Es(s)>e),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,o=this._automationEvents[i];if(o!==void 0&&Nf(o)&&(r===void 0||!Bs(r)||r.insertTime>e))return bT(e,ap(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(o!==void 0&&CC(o)&&(r===void 0||!Bs(r)))return o.value;if(o!==void 0&&xo(o)&&(r===void 0||!Bs(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?LB(e,o):o.values[o.values.length-1];if(o!==void 0&&Bs(o)&&(r===void 0||!Bs(r)))return o.value;if(r!==void 0&&Gl(r)){const[s,a]=Qb(this._automationEvents,i,o,r,this._defaultValue);return qb(e,s,a,r)}if(r!==void 0&&sp(r)){const[s,a]=Qb(this._automationEvents,i,o,r,this._defaultValue);return ew(e,s,a,r)}return this._defaultValue}}const FB=t=>({cancelTime:t,type:"cancelAndHold"}),UB=t=>({cancelTime:t,type:"cancelScheduledValues"}),VB=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),GB=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),WB=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),jB=()=>new DOMException("","AbortError"),ZB=t=>(e,n,[r,i,o],s)=>{t(e[i],[n,r,o],a=>a[0]===n&&a[1]===r,s)},HB=t=>(e,n,r)=>{const i=[];for(let o=0;o<r.numberOfInputs;o+=1)i.push(new Set);t.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},zB=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Cc=new WeakSet,wT=new WeakMap,AT=new WeakMap,kT=new WeakMap,ET=new WeakMap,TT=new WeakMap,RT=new WeakMap,Jv=new WeakMap,Yv=new WeakMap,Qv=new WeakMap,xT={construct(){return xT}},XB=t=>{try{const e=new Proxy(t,xT);new e}catch{return!1}return!0},tw=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,nw=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),i=r.match(tw);for(;i!==null;){const o=i[1].slice(1,-1),s=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());n.push(s),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(tw)}return[n.join(";"),r]},rw=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},iw=t=>{if(!XB(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},$B=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>{let h=0;return(p,g,C={credentials:"omit"})=>{const m=u.get(p);if(m!==void 0&&m.has(g))return Promise.resolve();const v=c.get(p);if(v!==void 0){const w=v.get(g);if(w!==void 0)return w}const S=o(p),E=S.audioWorklet===void 0?i(g).then(([w,A])=>{const[x,T]=nw(w,A),_=`${x};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${T}
})})(window,'_AWGS')`;return n(_)}).then(()=>{const w=f._AWGS.pop();if(w===void 0)throw new SyntaxError;r(S.currentTime,S.sampleRate,()=>w(class{},void 0,(A,x)=>{if(A.trim()==="")throw e();const T=Yv.get(S);if(T!==void 0){if(T.has(A))throw e();iw(x),rw(x.parameterDescriptors),T.set(A,x)}else iw(x),rw(x.parameterDescriptors),Yv.set(S,new Map([[A,x]]))},S.sampleRate,void 0,void 0))}):Promise.all([i(g),Promise.resolve(t(d,d))]).then(([[w,A],x])=>{const T=h+1;h=T;const[_,O]=nw(w,A),Z=`${_};((AudioWorkletProcessor,registerProcessor)=>{${O}
})(${x?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${x?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${x?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${T}',class extends AudioWorkletProcessor{process(){return !1}})`,K=new Blob([Z],{type:"application/javascript; charset=utf-8"}),ee=URL.createObjectURL(K);return S.audioWorklet.addModule(ee,C).then(()=>{if(a(S))return S;const re=s(S);return re.audioWorklet.addModule(ee,C).then(()=>re)}).then(re=>{if(l===null)throw new SyntaxError;try{new l(re,`__sac${T}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(ee))});return v===void 0?c.set(p,new Map([[g,E]])):v.set(g,E),E.then(()=>{const w=u.get(p);w===void 0?u.set(p,new Set([g])):w.add(g)}).finally(()=>{const w=c.get(p);w!==void 0&&w.delete(g)}),E}},Di=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},ng=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return t.delete(r),r},PT=(t,e,n,r)=>{const i=Di(t,e),o=ng(i,s=>s[0]===n&&s[1]===r);return i.size===0&&t.delete(e),o},Hd=t=>Di(RT,t),Ic=t=>{if(Cc.has(t))throw new Error("The AudioNode is already stored.");Cc.add(t),Hd(t).forEach(e=>e(!0))},NT=t=>"port"in t,zd=t=>{if(!Cc.has(t))throw new Error("The AudioNode is not stored.");Cc.delete(t),Hd(t).forEach(e=>e(!1))},qv=(t,e)=>{!NT(t)&&e.every(n=>n.size===0)&&zd(t)},KB=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>{const h=new WeakMap;return(p,g,C,m,v)=>{const{activeInputs:S,passiveInputs:E}=o(g),{outputs:w}=o(p),A=a(p),x=T=>{const _=l(g),O=l(p);if(T){const L=PT(E,p,C,m);t(S,p,L,!1),!v&&!d(p)&&n(O,_,C,m),f(g)&&Ic(g)}else{const L=r(S,p,C,m);e(E,m,L,!1),!v&&!d(p)&&i(O,_,C,m);const U=s(g);if(U===0)u(g)&&qv(g,S);else{const z=h.get(g);z!==void 0&&clearTimeout(z),h.set(g,setTimeout(()=>{u(g)&&qv(g,S)},U*1e3))}}};return c(w,[g,C,m],T=>T[0]===g&&T[1]===C&&T[2]===m,!0)?(A.add(x),u(p)?t(S,p,[C,m,x],!0):e(E,m,[p,C,x],!0),!0):!1}},JB=t=>(e,n,[r,i,o],s)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[i,n,o]])):t(a,[i,n,o],l=>l[0]===i&&l[1]===n,s)},YB=t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},QB=t=>(e,n)=>{t(e).add(n)},qB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},eF=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=i(a),u={...qB,...l},d=r(c,u),f=o(c)?e():null;super(a,!1,d,f),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},jn=(t,e)=>t.context===e,tF=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!jn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},e0=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},So=()=>new DOMException("","IndexSizeError"),_T=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(r){throw r.code===12?So():r}})(t.getChannelData)},nF={numberOfChannels:1},rF=(t,e,n,r,i,o,s,a)=>{let l=null;return class OT{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:f,sampleRate:h}={...nF,...u};l===null&&(l=new i(1,1,44100));const p=r!==null&&e(o,o)?new r({length:d,numberOfChannels:f,sampleRate:h}):l.createBuffer(f,d,h);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(s(p),_T(p)):e(e0,()=>e0(p))||a(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===OT.prototype||t.has(u)}}},pr=-34028234663852886e22,Yn=-pr,ls=t=>Cc.has(t),iF={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},oF=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f={...iF,...u},h=i(d,f),p=s(d),g=p?e():null;super(c,!1,h,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=n(this,p,h.playbackRate,Yn,pr)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(c){if(this._nativeAudioBufferSourceNode.buffer=c,c!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(c){this._nativeAudioBufferSourceNode.loop=c}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(c){this._nativeAudioBufferSourceNode.loopEnd=c}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(c){this._nativeAudioBufferSourceNode.loopStart=c}get onended(){return this._onended}set onended(c){const u=typeof c=="function"?a(this,c):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?c:d}get playbackRate(){return this._playbackRate}start(c=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(c,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[c,u]:[c,u,d]),this.context.state!=="closed"){Ic(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),ls(this)&&zd(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(c=0){this._nativeAudioBufferSourceNode.stop(c),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=c)}},sF=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const l=async(c,u)=>{let d=n(c);const f=jn(d,u);if(!f){const h={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(u,h),s!==null&&d.start(...s),a!==null&&d.stop(a)}return o.set(u,d),f?await t(u,c.playbackRate,d.playbackRate):await r(u,c.playbackRate,d.playbackRate),await i(c,u,d),d};return{set start(c){s=c},set stop(c){a=c},render(c,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):l(c,u)}}},aF=t=>"playbackRate"in t,lF=t=>"frequency"in t&&"gain"in t,cF=t=>"offset"in t,uF=t=>!("frequency"in t)&&"gain"in t,dF=t=>"detune"in t&&"frequency"in t&&!("gain"in t),fF=t=>"pan"in t,er=t=>Di(wT,t),Xd=t=>Di(kT,t),t0=(t,e)=>{const{activeInputs:n}=er(t);n.forEach(i=>i.forEach(([o])=>{e.includes(t)||t0(o,[...e,t])}));const r=aF(t)?[t.playbackRate]:NT(t)?Array.from(t.parameters.values()):lF(t)?[t.Q,t.detune,t.frequency,t.gain]:cF(t)?[t.offset]:uF(t)?[t.gain]:dF(t)?[t.detune,t.frequency]:fF(t)?[t.pan]:[];for(const i of r){const o=Xd(i);o!==void 0&&o.activeInputs.forEach(([s])=>t0(s,e))}ls(t)&&zd(t)},hF=t=>{t0(t.destination,[])},pF=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),gF=(t,e,n,r,i,o,s,a,l)=>class extends t{constructor(u={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new l(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(d===null)throw r();if(!pF(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw n();super(d,2);const{latencyHint:f}=u,{sampleRate:h}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:f==="balanced"?512/h:f==="interactive"||f===void 0?256/h:f==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(f*h/128)))*128/h,this._nativeAudioContext=d,l.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",p)};d.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),hF(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(u){return new s(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},mF=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f=s(d),h=i(d,u,f),p=f?e(a):null;super(c,!1,h,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(c>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=c}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=c}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},vF=t=>{const e=new WeakMap,n=async(r,i)=>{const o=i.destination;return e.set(i,o),await t(r,i,o),o};return{render(r,i){const o=e.get(i);return o!==void 0?Promise.resolve(o):n(r,i)}}},yF=(t,e,n,r,i,o,s,a)=>(l,c)=>{const u=c.listener,d=()=>{const w=new Float32Array(1),A=e(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),x=s(c);let T=!1,_=[0,0,-1,0,1,0],O=[0,0,0];const L=()=>{if(T)return;T=!0;const K=r(c,256,9,0);K.onaudioprocess=({inputBuffer:ee})=>{const re=[o(ee,w,0),o(ee,w,1),o(ee,w,2),o(ee,w,3),o(ee,w,4),o(ee,w,5)];re.some((J,oe)=>J!==_[oe])&&(u.setOrientation(...re),_=re);const X=[o(ee,w,6),o(ee,w,7),o(ee,w,8)];X.some((J,oe)=>J!==O[oe])&&(u.setPosition(...X),O=X)},A.connect(K)},U=K=>ee=>{ee!==_[K]&&(_[K]=ee,u.setOrientation(..._))},z=K=>ee=>{ee!==O[K]&&(O[K]=ee,u.setPosition(...O))},Z=(K,ee,re)=>{const X=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ee});X.connect(A,0,K),X.start(),Object.defineProperty(X.offset,"defaultValue",{get(){return ee}});const J=t({context:l},x,X.offset,Yn,pr);return a(J,"value",oe=>()=>oe.call(J),oe=>W=>{try{oe.call(J,W)}catch(se){if(se.code!==9)throw se}L(),x&&re(W)}),J.cancelAndHoldAtTime=(oe=>x?()=>{throw i()}:(...W)=>{const se=oe.apply(J,W);return L(),se})(J.cancelAndHoldAtTime),J.cancelScheduledValues=(oe=>x?()=>{throw i()}:(...W)=>{const se=oe.apply(J,W);return L(),se})(J.cancelScheduledValues),J.exponentialRampToValueAtTime=(oe=>x?()=>{throw i()}:(...W)=>{const se=oe.apply(J,W);return L(),se})(J.exponentialRampToValueAtTime),J.linearRampToValueAtTime=(oe=>x?()=>{throw i()}:(...W)=>{const se=oe.apply(J,W);return L(),se})(J.linearRampToValueAtTime),J.setTargetAtTime=(oe=>x?()=>{throw i()}:(...W)=>{const se=oe.apply(J,W);return L(),se})(J.setTargetAtTime),J.setValueAtTime=(oe=>x?()=>{throw i()}:(...W)=>{const se=oe.apply(J,W);return L(),se})(J.setValueAtTime),J.setValueCurveAtTime=(oe=>x?()=>{throw i()}:(...W)=>{const se=oe.apply(J,W);return L(),se})(J.setValueCurveAtTime),J};return{forwardX:Z(0,0,U(0)),forwardY:Z(1,0,U(1)),forwardZ:Z(2,-1,U(2)),positionX:Z(6,0,z(0)),positionY:Z(7,0,z(1)),positionZ:Z(8,0,z(2)),upX:Z(3,0,U(3)),upY:Z(4,1,U(4)),upZ:Z(5,0,U(5))}},{forwardX:f,forwardY:h,forwardZ:p,positionX:g,positionY:C,positionZ:m,upX:v,upY:S,upZ:E}=u.forwardX===void 0?d():u;return{get forwardX(){return f},get forwardY(){return h},get forwardZ(){return p},get positionX(){return g},get positionY(){return C},get positionZ(){return m},get upX(){return v},get upY(){return S},get upZ(){return E}}},lp=t=>"context"in t,$d=t=>lp(t[0]),hl=(t,e,n,r)=>{for(const i of t)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},ow=(t,e,[n,r],i)=>{hl(t,[e,n,r],o=>o[0]===e&&o[1]===n,i)},sw=(t,[e,n,r],i)=>{const o=t.get(e);o===void 0?t.set(e,new Set([[n,r]])):hl(o,[n,r],s=>s[0]===n,i)},Mc=t=>"inputs"in t,cp=(t,e,n,r)=>{if(Mc(e)){const i=e.inputs[r];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,r),[e,n,r]},MT=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},CF=(t,e,n)=>ng(t,r=>r[0]===e&&r[1]===n),DT=(t,e)=>{if(!Hd(t).delete(e))throw new Error("Missing the expected event listener.")},LT=(t,e,n)=>{const r=Di(t,e),i=ng(r,o=>o[0]===n);return r.size===0&&t.delete(e),i},up=(t,e,n,r)=>{Mc(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},Tt=t=>Di(AT,t),Sd=t=>Di(ET,t),nl=t=>Jv.has(t),uh=t=>!Cc.has(t),aw=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const r=t.createScriptProcessor(256,1,1),i=t.createGain(),o=t.createBuffer(1,2,44100),s=o.getChannelData(0);s[0]=1,s[1]=1;const a=t.createBufferSource();a.buffer=o,a.loop=!0,a.connect(r).connect(t.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=l=>{const c=l.inputBuffer.getChannelData(0);Array.prototype.some.call(c,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}}),fm=(t,e)=>{const n=new Map;for(const r of t)for(const i of r){const o=n.get(i);n.set(i,o===void 0?1:o+1)}n.forEach((r,i)=>e(i,r))},dp=t=>"context"in t,IF=t=>{const e=new Map;t.connect=(n=>(r,i=0,o=0)=>{const s=dp(r)?n(r,i,o):n(r,i),a=e.get(r);return a===void 0?e.set(r,[{input:o,output:i}]):a.every(l=>l.input!==o||l.output!==i)&&a.push({input:o,output:i}),s})(t.connect.bind(t)),t.disconnect=(n=>(r,i,o)=>{if(n.apply(t),r===void 0)e.clear();else if(typeof r=="number")for(const[s,a]of e){const l=a.filter(c=>c.output!==r);l.length===0?e.delete(s):e.set(s,l)}else if(e.has(r))if(i===void 0)e.delete(r);else{const s=e.get(r);if(s!==void 0){const a=s.filter(l=>l.output!==i&&(l.input!==o||o===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[s,a]of e)a.forEach(l=>{dp(s)?t.connect(s,l.output,l.input):t.connect(s,l.output)})})(t.disconnect)},SF=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=Xd(e),{outputs:s}=er(t),a=Hd(t),l=c=>{const u=Tt(t),d=Sd(e);if(c){const f=LT(o,t,n);ow(i,t,f,!1),!r&&!nl(t)&&u.connect(d,n)}else{const f=CF(i,t,n);sw(o,f,!1),!r&&!nl(t)&&u.disconnect(d,n)}};return hl(s,[e,n],c=>c[0]===e&&c[1]===n,!0)?(a.add(l),ls(t)?ow(i,t,[n,l],!0):sw(o,[t,n,l],!0),!0):!1},bF=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=er(e),s=MT(i[r],t,n);return s===null?[PT(o,t,n,r)[2],!1]:[s[2],!0]},wF=(t,e,n)=>{const{activeInputs:r,passiveInputs:i}=Xd(e),o=MT(r,t,n);return o===null?[LT(i,t,n)[1],!1]:[o[2],!0]},IC=(t,e,n,r,i)=>{const[o,s]=bF(t,n,r,i);if(o!==null&&(DT(t,o),s&&!e&&!nl(t)&&up(Tt(t),Tt(n),r,i)),ls(n)){const{activeInputs:a}=er(n);qv(n,a)}},SC=(t,e,n,r)=>{const[i,o]=wF(t,n,r);i!==null&&(DT(t,i),o&&!e&&!nl(t)&&Tt(t).disconnect(Sd(n),r))},AF=(t,e)=>{const n=er(t),r=[];for(const i of n.outputs)$d(i)?IC(t,e,...i):SC(t,e,...i),r.push(i[0]);return n.outputs.clear(),r},kF=(t,e,n)=>{const r=er(t),i=[];for(const o of r.outputs)o[1]===n&&($d(o)?IC(t,e,...o):SC(t,e,...o),i.push(o[0]),r.outputs.delete(o));return i},EF=(t,e,n,r,i)=>{const o=er(t);return Array.from(o.outputs).filter(s=>s[0]===n&&(r===void 0||s[1]===r)&&(i===void 0||s[2]===i)).map(s=>($d(s)?IC(t,e,...s):SC(t,e,...s),o.outputs.delete(s),s[0]))},TF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,g)=>class extends c{constructor(m,v,S,E){super(S),this._context=m,this._nativeAudioNode=S;const w=u(m);d(w)&&n(aw,()=>aw(w,g))!==!0&&IF(S),AT.set(this,S),RT.set(this,new Set),m.state!=="closed"&&v&&Ic(this),t(this,E,S)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(m){this._nativeAudioNode.channelCount=m}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(m){this._nativeAudioNode.channelCountMode=m}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(m){this._nativeAudioNode.channelInterpretation=m}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(m,v=0,S=0){if(v<0||v>=this._nativeAudioNode.numberOfOutputs)throw i();const E=u(this._context),w=p(E);if(f(m)||h(m))throw o();if(lp(m)){const T=Tt(m);try{const O=cp(this._nativeAudioNode,T,v,S),L=uh(this);(w||L)&&this._nativeAudioNode.disconnect(...O),this.context.state!=="closed"&&!L&&uh(m)&&Ic(m)}catch(O){throw O.code===12?o():O}if(e(this,m,v,S,w)){const O=l([this],m);fm(O,r(w))}return m}const A=Sd(m);if(A.name==="playbackRate"&&A.maxValue===1024)throw s();try{this._nativeAudioNode.connect(A,v),(w||uh(this))&&this._nativeAudioNode.disconnect(A,v)}catch(T){throw T.code===12?o():T}if(SF(this,m,v,w)){const T=l([this],m);fm(T,r(w))}}disconnect(m,v,S){let E;const w=u(this._context),A=p(w);if(m===void 0)E=AF(this,A);else if(typeof m=="number"){if(m<0||m>=this.numberOfOutputs)throw i();E=kF(this,A,m)}else{if(v!==void 0&&(v<0||v>=this.numberOfOutputs)||lp(m)&&S!==void 0&&(S<0||S>=m.numberOfInputs))throw i();if(E=EF(this,A,m,v,S),E.length===0)throw o()}for(const x of E){const T=l([this],x);fm(T,a)}}},RF=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>(h,p,g,C=null,m=null)=>{const v=g.value,S=new BB(v),E=p?r(S):null,w={get defaultValue(){return v},get maxValue(){return C===null?g.maxValue:C},get minValue(){return m===null?g.minValue:m},get value(){return g.value},set value(A){g.value=A,w.setValueAtTime(A,h.context.currentTime)},cancelAndHoldAtTime(A){if(typeof g.cancelAndHoldAtTime=="function")E===null&&S.flush(h.context.currentTime),S.add(i(A)),g.cancelAndHoldAtTime(A);else{const x=Array.from(S).pop();E===null&&S.flush(h.context.currentTime),S.add(i(A));const T=Array.from(S).pop();g.cancelScheduledValues(A),x!==T&&T!==void 0&&(T.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(T.value,T.endTime):T.type==="linearRampToValue"?g.linearRampToValueAtTime(T.value,T.endTime):T.type==="setValue"?g.setValueAtTime(T.value,T.startTime):T.type==="setValueCurve"&&g.setValueCurveAtTime(T.values,T.startTime,T.duration))}return w},cancelScheduledValues(A){return E===null&&S.flush(h.context.currentTime),S.add(o(A)),g.cancelScheduledValues(A),w},exponentialRampToValueAtTime(A,x){if(A===0)throw new RangeError;if(!Number.isFinite(x)||x<0)throw new RangeError;const T=h.context.currentTime;return E===null&&S.flush(T),Array.from(S).length===0&&(S.add(c(v,T)),g.setValueAtTime(v,T)),S.add(s(A,x)),g.exponentialRampToValueAtTime(A,x),w},linearRampToValueAtTime(A,x){const T=h.context.currentTime;return E===null&&S.flush(T),Array.from(S).length===0&&(S.add(c(v,T)),g.setValueAtTime(v,T)),S.add(a(A,x)),g.linearRampToValueAtTime(A,x),w},setTargetAtTime(A,x,T){return E===null&&S.flush(h.context.currentTime),S.add(l(A,x,T)),g.setTargetAtTime(A,x,T),w},setValueAtTime(A,x){return E===null&&S.flush(h.context.currentTime),S.add(c(A,x)),g.setValueAtTime(A,x),w},setValueCurveAtTime(A,x,T){const _=A instanceof Float32Array?A:new Float32Array(A);if(d!==null&&d.name==="webkitAudioContext"){const O=x+T,L=h.context.sampleRate,U=Math.ceil(x*L),z=Math.floor(O*L),Z=z-U,K=new Float32Array(Z);for(let re=0;re<Z;re+=1){const X=(_.length-1)/T*((U+re)/L-x),J=Math.floor(X),oe=Math.ceil(X);K[re]=J===oe?_[J]:(1-(X-J))*_[J]+(1-(oe-X))*_[oe]}E===null&&S.flush(h.context.currentTime),S.add(u(K,x,T)),g.setValueCurveAtTime(K,x,T);const ee=z/L;ee<O&&f(w,K[K.length-1],ee),f(w,_[_.length-1],O)}else E===null&&S.flush(h.context.currentTime),S.add(u(_,x,T)),g.setValueCurveAtTime(_,x,T);return w}};return n.set(w,g),e.set(w,h),t(w,E),w},xF=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;e.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;e.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:o}=n;e.setTargetAtTime(i,r,o)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;e.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:o}=n;e.setValueCurveAtTime(o,i,r)}else throw new Error("Can't apply an unknown automation.")}});class BT{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((r,i)=>e.call(n,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const PF={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},NF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h)=>class extends e{constructor(g,C,m){var v;const S=a(g),E=l(S),w=u({...PF,...m});f(w);const A=Yv.get(S),x=A==null?void 0:A.get(C),T=E||S.state!=="closed"?S:(v=s(S))!==null&&v!==void 0?v:S,_=i(T,E?null:g.baseLatency,c,C,x,w),O=E?r(C,w,x):null;super(g,!0,_,O);const L=[];_.parameters.forEach((z,Z)=>{const K=n(this,E,z);L.push([Z,K])}),this._nativeAudioWorkletNode=_,this._onprocessorerror=null,this._parameters=new BT(L),E&&t(S,this);const{activeInputs:U}=o(this);d(_,U)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const C=typeof g=="function"?h(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=C;const m=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=m!==null&&m===C?g:m}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function fp(t,e,n,r,i){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],r,i);else{const o=t.getChannelData(r);if(e[n].byteLength===0)e[n]=o.slice(i,i+128);else{const s=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(s)}}}const FT=(t,e,n,r,i)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],r,i):e[n].byteLength!==0&&t.getChannelData(r).set(e[n],i)},hp=(t,e)=>{const n=[];for(let r=0;r<t;r+=1){const i=[],o=typeof e=="number"?e:e[r];for(let s=0;s<o;s+=1)i.push(new Float32Array(128));n.push(i)}return n},_F=(t,e)=>{const n=Di(Qv,t),r=Tt(e);return Di(n,r)},OF=async(t,e,n,r,i,o,s)=>{const a=e===null?Math.ceil(t.context.length/128)*128:e.length,l=r.channelCount*r.numberOfInputs,c=i.reduce((C,m)=>C+m,0),u=c===0?null:n.createBuffer(c,a,n.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const d=er(t),f=await _F(n,t),h=hp(r.numberOfInputs,r.channelCount),p=hp(r.numberOfOutputs,i),g=Array.from(t.parameters.keys()).reduce((C,m)=>({...C,[m]:new Float32Array(128)}),{});for(let C=0;C<a;C+=128){if(r.numberOfInputs>0&&e!==null)for(let m=0;m<r.numberOfInputs;m+=1)for(let v=0;v<r.channelCount;v+=1)fp(e,h[m],v,v,C);o.parameterDescriptors!==void 0&&e!==null&&o.parameterDescriptors.forEach(({name:m},v)=>{fp(e,g,m,l+v,C)});for(let m=0;m<r.numberOfInputs;m+=1)for(let v=0;v<i[m];v+=1)p[m][v].byteLength===0&&(p[m][v]=new Float32Array(128));try{const m=h.map((S,E)=>d.activeInputs[E].size===0?[]:S),v=s(C/n.sampleRate,n.sampleRate,()=>f.process(m,p,g));if(u!==null)for(let S=0,E=0;S<r.numberOfOutputs;S+=1){for(let w=0;w<i[S];w+=1)FT(u,p[S],w,E+w,C);E+=i[S]}if(!v)break}catch(m){t.dispatchEvent(new ErrorEvent("processorerror",{colno:m.colno,filename:m.filename,lineno:m.lineno,message:m.message}));break}}return u},MF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,g)=>(C,m,v)=>{const S=new WeakMap;let E=null;const w=async(A,x)=>{let T=u(A),_=null;const O=jn(T,x),L=Array.isArray(m.outputChannelCount)?m.outputChannelCount:Array.from(m.outputChannelCount);if(d===null){const U=L.reduce((ee,re)=>ee+re,0),z=i(x,{channelCount:Math.max(1,U),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,U)}),Z=[];for(let ee=0;ee<A.numberOfOutputs;ee+=1)Z.push(r(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:L[ee]}));const K=s(x,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1});K.connect=e.bind(null,Z),K.disconnect=l.bind(null,Z),_=[z,Z,K]}else O||(T=new d(x,C));if(S.set(x,_===null?T:_[2]),_!==null){if(E===null){if(v===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const re=A.channelCount*A.numberOfInputs,X=v.parameterDescriptors===void 0?0:v.parameterDescriptors.length,J=re+X;E=OF(A,J===0?null:await(async()=>{const W=new f(J,Math.ceil(A.context.length/128)*128,x.sampleRate),se=[],we=[];for(let xe=0;xe<m.numberOfInputs;xe+=1)se.push(s(W,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1})),we.push(i(W,{channelCount:m.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:m.channelCount}));const De=await Promise.all(Array.from(A.parameters.values()).map(async xe=>{const rt=o(W,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:xe.value});return await h(W,xe,rt.offset),rt})),de=r(W,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,re+X)});for(let xe=0;xe<m.numberOfInputs;xe+=1){se[xe].connect(we[xe]);for(let rt=0;rt<m.channelCount;rt+=1)we[xe].connect(de,rt,xe*m.channelCount+rt)}for(const[xe,rt]of De.entries())rt.connect(de,0,re+xe),rt.start(0);return de.connect(W.destination),await Promise.all(se.map(xe=>p(A,W,xe))),g(W)})(),x,m,L,v,c)}const U=await E,z=n(x,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[Z,K,ee]=_;U!==null&&(z.buffer=U,z.start(0)),z.connect(Z);for(let re=0,X=0;re<A.numberOfOutputs;re+=1){const J=K[re];for(let oe=0;oe<L[re];oe+=1)Z.connect(J,X+oe,oe);X+=L[re]}return ee}if(O)for(const[U,z]of A.parameters.entries())await t(x,z,T.parameters.get(U));else for(const[U,z]of A.parameters.entries())await h(x,z,T.parameters.get(U));return await p(A,x,T),T};return{render(A,x){a(x,A);const T=S.get(x);return T!==void 0?Promise.resolve(T):w(A,x)}}},DF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,g,C,m,v,S)=>class extends p{constructor(w,A){super(w,A),this._nativeContext=w,this._audioWorklet=t===void 0?void 0:{addModule:(x,T)=>t(this,x,T)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(w,A,x){return new n({length:A,numberOfChannels:w,sampleRate:x})}createBufferSource(){return new r(this)}createChannelMerger(w=6){return new o(this,{numberOfInputs:w})}createChannelSplitter(w=6){return new s(this,{numberOfOutputs:w})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(w=1){return new u(this,{maxDelayTime:w})}createDynamicsCompressor(){return new d(this)}createGain(){return new f(this)}createIIRFilter(w,A){return new h(this,{feedback:A,feedforward:w})}createOscillator(){return new g(this)}createPanner(){return new C(this)}createPeriodicWave(w,A,x={disableNormalization:!1}){return new m(this,{...x,imag:A,real:w})}createStereoPanner(){return new v(this)}createWaveShaper(){return new S(this)}decodeAudioData(w,A,x){return c(this._nativeContext,w).then(T=>(typeof A=="function"&&A(T),T),T=>{throw typeof x=="function"&&x(T),T})}},LF={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},BF=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f={...LF,...u},h=i(d,f),p=s(d),g=p?n():null;super(c,!1,h,g),this._Q=e(this,p,h.Q,Yn,pr),this._detune=e(this,p,h.detune,1200*Math.log2(Yn),-1200*Math.log2(Yn)),this._frequency=e(this,p,h.frequency,c.sampleRate/2,0),this._gain=e(this,p,h.gain,40*Math.log10(Yn),pr),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(c){this._nativeBiquadFilterNode.type=c}getFrequencyResponse(c,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(c,u,d)}catch(f){throw f.code===11?r():f}if(c.length!==u.length||u.length!==d.length)throw r()}},FF=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=jn(c,l);if(!u){const d={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=e(l,d)}return o.set(l,c),u?(await t(l,a.Q,c.Q),await t(l,a.detune,c.detune),await t(l,a.frequency,c.frequency),await t(l,a.gain,c.gain)):(await r(l,a.Q,c.Q),await r(l,a.detune,c.detune),await r(l,a.frequency,c.frequency),await r(l,a.gain,c.gain)),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},UF=(t,e)=>(n,r)=>{const i=e.get(n);if(i!==void 0)return i;const o=t.get(n);if(o!==void 0)return o;try{const s=r();return s instanceof Promise?(t.set(n,s),s.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,s),s)}catch{return e.set(n,!1),!1}},VF={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},GF=(t,e,n,r,i)=>class extends t{constructor(s,a){const l=r(s),c={...VF,...a},u=n(l,c),d=i(l)?e():null;super(s,!1,u,d)}},WF=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!jn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},jF={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},ZF=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=r(a),u=o({...jF,...l}),d=n(c,u),f=i(c)?e():null;super(a,!1,d,f)}},HF=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!jn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},zF=t=>(e,n,r)=>t(n,e,r),XF=t=>(e,n,r=0,i=0)=>{const o=e[r];if(o===void 0)throw t();return dp(n)?o.connect(n,0,i):o.connect(n,0)},$F=t=>(e,n)=>{const r=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},KF={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},JF=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...KF,...c},f=r(u,d),h=o(u),p=h?n():null;super(l,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=e(this,h,f.offset,Yn,pr),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?s(this,l):null;this._nativeConstantSourceNode.onended=c;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===c?l:u}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Ic(this);const c=()=>{this._nativeConstantSourceNode.removeEventListener("ended",c),ls(this)&&zd(this)};this._nativeConstantSourceNode.addEventListener("ended",c)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},YF=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const l=async(c,u)=>{let d=n(c);const f=jn(d,u);if(!f){const h={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=e(u,h),s!==null&&d.start(s),a!==null&&d.stop(a)}return o.set(u,d),f?await t(u,c.offset,d.offset):await r(u,c.offset,d.offset),await i(c,u,d),d};return{set start(c){s=c},set stop(c){a=c},render(c,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):l(c,u)}}},QF=t=>e=>(t[0]=e,t[0]),qF={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},e3=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=r(a),u={...qF,...l},d=n(c,u),h=i(c)?e():null;super(a,!1,d,h),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&o(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},t3=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!jn(a,s)){const c={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(s,c)}return r.set(s,a),Mc(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},n3=()=>new DOMException("","DataCloneError"),lw=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,e.close(),n.close(),r()};n.onmessage=()=>i();try{e.postMessage(t,[t])}catch{}finally{i()}})},r3=(t,e,n,r,i,o,s,a,l,c,u)=>(d,f)=>{const h=s(d)?d:o(d);if(i.has(f)){const p=n();return Promise.reject(p)}try{i.add(f)}catch{}return e(l,()=>l(h))?h.decodeAudioData(f).then(p=>(lw(f).catch(()=>{}),e(a,()=>a(p))||u(p),t.add(p),p)):new Promise((p,g)=>{const C=async()=>{try{await lw(f)}catch{}},m=v=>{g(v),C()};try{h.decodeAudioData(f,v=>{typeof v.copyFromChannel!="function"&&(c(v),_T(v)),t.add(v),C().then(()=>p(v))},v=>{m(v===null?r():v)})}catch(v){m(v)}})},i3=(t,e,n,r,i,o,s,a)=>(l,c)=>{const u=e.get(l);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=o(l.context),f=a(d);if(u===c){if(e.delete(l),!f&&s(l)){const h=r(l),{outputs:p}=n(l);for(const g of p)if($d(g)){const C=r(g[0]);t(h,C,g[1],g[2])}else{const C=i(g[0]);h.connect(C,g[1])}}}else e.set(l,u-c)},o3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},s3=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...o3,...c},f=r(u,d),h=o(u),p=h?n(d.maxDelayTime):null;super(l,!1,f,p),this._delayTime=e(this,h,f.delayTime),s(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},a3=(t,e,n,r,i)=>o=>{const s=new WeakMap,a=async(l,c)=>{let u=n(l);const d=jn(u,c);if(!d){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=e(c,f)}return s.set(c,u),d?await t(c,l.delayTime,u.delayTime):await r(c,l.delayTime,u.delayTime),await i(l,c,u),u};return{render(l,c){const u=s.get(c);return u!==void 0?Promise.resolve(u):a(l,c)}}},l3=t=>(e,n,r,i)=>t(e[i],o=>o[0]===n&&o[1]===r),c3=t=>(e,n)=>{t(e).delete(n)},u3=t=>"delayTime"in t,d3=(t,e,n)=>function r(i,o){const s=lp(o)?o:n(t,o);if(u3(s))return[];if(i[0]===s)return[i];if(i.includes(s))return[];const{outputs:a}=e(s);return Array.from(a).map(l=>r([...i,s],l[0])).reduce((l,c)=>l.concat(c),[])},_f=(t,e,n)=>{const r=e[n];if(r===void 0)throw t();return r},f3=t=>(e,n=void 0,r=void 0,i=0)=>n===void 0?e.forEach(o=>o.disconnect()):typeof n=="number"?_f(t,e,n).disconnect():dp(n)?r===void 0?e.forEach(o=>o.disconnect(n)):i===void 0?_f(t,e,r).disconnect(n,0):_f(t,e,r).disconnect(n,0,i):r===void 0?e.forEach(o=>o.disconnect(n)):_f(t,e,r).disconnect(n,0),h3={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},p3=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f={...h3,...u},h=r(d,f),p=s(d),g=p?n():null;super(c,!1,h,g),this._attack=e(this,p,h.attack),this._knee=e(this,p,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=e(this,p,h.ratio),this._release=e(this,p,h.release),this._threshold=e(this,p,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(c){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=c,c>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(c){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=c,c==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},g3=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=jn(c,l);if(!u){const d={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=e(l,d)}return o.set(l,c),u?(await t(l,a.attack,c.attack),await t(l,a.knee,c.knee),await t(l,a.ratio,c.ratio),await t(l,a.release,c.release),await t(l,a.threshold,c.threshold)):(await r(l,a.attack,c.attack),await r(l,a.knee,c.knee),await r(l,a.ratio,c.ratio),await r(l,a.release,c.release),await r(l,a.threshold,c.threshold)),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},m3=()=>new DOMException("","EncodingError"),v3=t=>e=>new Promise((n,r)=>{if(t===null){r(new SyntaxError);return}const i=t.document.head;if(i===null)r(new SyntaxError);else{const o=t.document.createElement("script"),s=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(s),l=t.onerror,c=()=>{t.onerror=l,URL.revokeObjectURL(a)};t.onerror=(u,d,f,h,p)=>{if(d===a||d===t.location.href&&f===1&&h===1)return c(),r(p),!1;if(l!==null)return l(u,d,f,h,p)},o.onerror=()=>{c(),r(new SyntaxError)},o.onload=()=>{c(),n()},o.src=a,o.type="module",i.appendChild(o)}}),y3=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=t(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(n,o,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,o===void 0?null:o,i)}},C3=t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},I3=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},S3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},b3=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=i(a),u={...S3,...l},d=r(c,u),f=o(c),h=f?n():null;super(a,!1,d,h),this._gain=e(this,f,d.gain,Yn,pr)}get gain(){return this._gain}},w3=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=jn(c,l);if(!u){const d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=e(l,d)}return o.set(l,c),u?await t(l,a.gain,c.gain):await r(l,a.gain,c.gain),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},A3=(t,e)=>n=>e(t,n),k3=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},E3=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},T3=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},R3=t=>e=>t.get(e),Tn=()=>new DOMException("","InvalidStateError"),x3=t=>e=>{const n=t.get(e);if(n===void 0)throw Tn();return n},P3=(t,e)=>n=>{let r=t.get(n);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),t.set(n,r),r},N3=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},rg=()=>new DOMException("","InvalidAccessError"),_3=t=>{t.getFrequencyResponse=(e=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw rg();return e.call(t,n,r,i)})(t.getFrequencyResponse)},O3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},M3=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=r(a),u=i(c),d={...O3,...l},f=e(c,u?null:a.baseLatency,d),h=u?n(d.feedback,d.feedforward):null;super(a,!1,f,h),_3(f),this._nativeIIRFilterNode=f,o(this,1)}getFrequencyResponse(a,l,c){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,c)}},UT=(t,e,n,r,i,o,s,a,l,c,u)=>{const d=c.length;let f=a;for(let h=0;h<d;h+=1){let p=n[0]*c[h];for(let g=1;g<i;g+=1){const C=f-g&l-1;p+=n[g]*o[C],p-=t[g]*s[C]}for(let g=i;g<r;g+=1)p+=n[g]*o[f-g&l-1];for(let g=i;g<e;g+=1)p-=t[g]*s[f-g&l-1];o[f]=c[h],s[f]=p,f=f+1&l-1,u[h]=p}return f},D3=(t,e,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),o=r instanceof Float64Array?r:new Float64Array(r),s=i.length,a=o.length,l=Math.min(s,a);if(i[0]!==1){for(let p=0;p<s;p+=1)o[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const c=32,u=new Float32Array(c),d=new Float32Array(c),f=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),h=t.numberOfChannels;for(let p=0;p<h;p+=1){const g=t.getChannelData(p),C=f.getChannelData(p);u.fill(0),d.fill(0),UT(i,s,o,a,l,u,d,0,c,g,C)}return f},L3=(t,e,n,r,i)=>(o,s)=>{const a=new WeakMap;let l=null;const c=async(u,d)=>{let f=null,h=e(u);const p=jn(h,d);if(d.createIIRFilter===void 0?f=t(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(h=d.createIIRFilter(s,o)),a.set(d,f===null?h:f),f!==null){if(l===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const C=new n(u.context.destination.channelCount,u.context.length,d.sampleRate);l=(async()=>{await r(u,C,C.destination);const m=await i(C);return D3(m,d,o,s)})()}const g=await l;return f.buffer=g,f.start(0),f}return await r(u,d,h),h};return{render(u,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):c(u,d)}}},B3=(t,e,n,r,i,o)=>s=>(a,l)=>{const c=t.get(a);if(c===void 0){if(!s&&o(a)){const u=r(a),{outputs:d}=n(a);for(const f of d)if($d(f)){const h=r(f[0]);e(u,h,f[1],f[2])}else{const h=i(f[0]);u.disconnect(h,f[1])}}t.set(a,l)}else t.set(a,c+l)},F3=t=>e=>t!==null&&e instanceof t,U3=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,V3=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,G3=(t,e)=>n=>t(n)||e(n),W3=t=>e=>t!==null&&e instanceof t,j3=t=>t!==null&&t.isSecureContext,Z3=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),l=e(a,s);if(r(a))throw TypeError();super(o,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},H3={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},z3=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o);if(r(a))throw new TypeError;const l={...H3,...s},c=e(a,l);super(o,!1,c,null),this._nativeMediaStreamAudioDestinationNode=c}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},X3=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),l=e(a,s);if(r(a))throw new TypeError;super(o,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},$3=(t,e,n)=>class extends t{constructor(i,o){const s=n(i),a=e(s,o);super(i,!0,a,null)}},K3=(t,e,n,r,i,o)=>class extends n{constructor(a,l){super(a),this._nativeContext=a,TT.set(this,a),r(a)&&i.set(a,new Set),this._destination=new t(this,l),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const l=typeof a=="function"?o(this,a):null;this._nativeContext.onstatechange=l;const c=this._nativeContext.onstatechange;this._onstatechange=c!==null&&c===l?a:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},n0=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},J3=(t,e)=>(n,r,i)=>{const o=new Set;return n.connect=(s=>(a,l=0,c=0)=>{const u=o.size===0;if(e(a))return s.call(n,a,l,c),t(o,[a,l,c],d=>d[0]===a&&d[1]===l&&d[2]===c,!0),u&&r(),a;s.call(n,a,l),t(o,[a,l],d=>d[0]===a&&d[1]===l,!0),u&&r()})(n.connect),n.disconnect=(s=>(a,l,c)=>{const u=o.size>0;if(a===void 0)s.apply(n),o.clear();else if(typeof a=="number"){s.call(n,a);for(const f of o)f[1]===a&&o.delete(f)}else{e(a)?s.call(n,a,l,c):s.call(n,a,l);for(const f of o)f[0]===a&&(l===void 0||f[1]===l)&&(c===void 0||f[2]===c)&&o.delete(f)}const d=o.size===0;u&&d&&i()})(n.disconnect),n},Pt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n]&&(t[n]=r)},dn=(t,e)=>{Pt(t,e,"channelCount"),Pt(t,e,"channelCountMode"),Pt(t,e,"channelInterpretation")},cw=t=>typeof t.getFloatTimeDomainData=="function",Y3=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const r=Math.max(n.length,t.fftSize);for(let i=0;i<r;i+=1)e[i]=(n[i]-128)*.0078125;return e}},Q3=(t,e)=>(n,r)=>{const i=n.createAnalyser();if(dn(i,r),!(r.maxDecibels>r.minDecibels))throw e();return Pt(i,r,"fftSize"),Pt(i,r,"maxDecibels"),Pt(i,r,"minDecibels"),Pt(i,r,"smoothingTimeConstant"),t(cw,()=>cw(i))||Y3(i),i},q3=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,jt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n].value&&(t[n].value=r)},e5=t=>{t.start=(e=>{let n=!1;return(r=0,i=0,o)=>{if(n)throw Tn();e.call(t,r,i,o),n=!0}})(t.start)},bC=t=>{t.start=(e=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,i)})(t.start)},wC=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},t5=(t,e,n,r,i,o,s,a,l,c,u)=>(d,f)=>{const h=d.createBufferSource();return dn(h,f),jt(h,f,"playbackRate"),Pt(h,f,"buffer"),Pt(h,f,"loop"),Pt(h,f,"loopEnd"),Pt(h,f,"loopStart"),e(n,()=>n(d))||e5(h),e(r,()=>r(d))||l(h),e(i,()=>i(d))||c(h,d),e(o,()=>o(d))||bC(h),e(s,()=>s(d))||u(h,d),e(a,()=>a(d))||wC(h),t(d,h),h},n5=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,r5=(t,e)=>(n,r,i)=>{const o=n.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}i&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const s=t(n,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(s,"channelCount",a=>()=>a.call(s),a=>l=>{a.call(s,l);try{o.channelCount=l}catch(c){if(l>o.maxChannelCount)throw c}}),e(s,"channelCountMode",a=>()=>a.call(s),a=>l=>{a.call(s,l),o.channelCountMode=l}),e(s,"channelInterpretation",a=>()=>a.call(s),a=>l=>{a.call(s,l),o.channelInterpretation=l}),Object.defineProperty(s,"maxChannelCount",{get:()=>o.maxChannelCount}),s.connect(o),s},i5=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,o5=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},s5=(t,e,n,r,i)=>(o,s,a,l,c,u)=>{if(a!==null)try{const d=new a(o,l,u),f=new Map;let h=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>h,set:p=>{typeof h=="function"&&d.removeEventListener("processorerror",h),h=typeof p=="function"?p:null,typeof h=="function"&&d.addEventListener("processorerror",h)}}}),d.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const C=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(C!==null){const m=f.get(g[1]);m!==void 0?g[1]=m:(g[1]=v=>{v.type==="error"?(Object.defineProperties(v,{type:{value:"processorerror"}}),C(v)):C(new ErrorEvent(g[0],{...v}))},f.set(C,g[1]))}}return p.call(d,"error",g[1],g[2]),p.call(d,...g)})(d.addEventListener),d.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const C=f.get(g[1]);C!==void 0&&(f.delete(g[1]),g[1]=C)}return p.call(d,"error",g[1],g[2]),p.call(d,g[0],g[1],g[2])})(d.removeEventListener),u.numberOfOutputs!==0){const p=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(p).connect(o.destination),i(d,()=>p.disconnect(),()=>p.connect(o.destination))}return d}catch(d){throw d.code===11?r():d}if(c===void 0)throw r();return o5(u),e(o,s,c,u)},VT=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),a5=t=>new Promise((e,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:o})=>{r.close(),i.close(),e(o)},r.onmessageerror=({data:o})=>{r.close(),i.close(),n(o)},i.postMessage(t)}),l5=async(t,e)=>{const n=await a5(e);return new t(n)},c5=(t,e,n,r)=>{let i=Qv.get(t);i===void 0&&(i=new WeakMap,Qv.set(t,i));const o=l5(n,r);return i.set(e,o),o},u5=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>(h,p,g,C)=>{if(C.numberOfInputs===0&&C.numberOfOutputs===0)throw l();const m=Array.isArray(C.outputChannelCount)?C.outputChannelCount:Array.from(C.outputChannelCount);if(m.some(he=>he<1))throw l();if(m.length!==C.numberOfOutputs)throw e();if(C.channelCountMode!=="explicit")throw l();const v=C.channelCount*C.numberOfInputs,S=m.reduce((he,ve)=>he+ve,0),E=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(v+E>6||S>6)throw l();const w=new MessageChannel,A=[],x=[];for(let he=0;he<C.numberOfInputs;he+=1)A.push(s(h,{channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation,gain:1})),x.push(i(h,{channelCount:C.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:C.channelCount}));const T=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:he,maxValue:ve,minValue:Ge,name:We}of g.parameterDescriptors){const Oe=o(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:C.parameterData[We]!==void 0?C.parameterData[We]:he===void 0?0:he});Object.defineProperties(Oe.offset,{defaultValue:{get:()=>he===void 0?0:he},maxValue:{get:()=>ve===void 0?Yn:ve},minValue:{get:()=>Ge===void 0?pr:Ge}}),T.push(Oe)}const _=r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+E)}),O=VT(p,h.sampleRate),L=a(h,O,v+E,Math.max(1,S)),U=i(h,{channelCount:Math.max(1,S),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,S)}),z=[];for(let he=0;he<C.numberOfOutputs;he+=1)z.push(r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:m[he]}));for(let he=0;he<C.numberOfInputs;he+=1){A[he].connect(x[he]);for(let ve=0;ve<C.channelCount;ve+=1)x[he].connect(_,ve,he*C.channelCount+ve)}const Z=new BT(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:he},ve)=>{const Ge=T[ve];return Ge.connect(_,0,v+ve),Ge.start(0),[he,Ge.offset]}));_.connect(L);let K=C.channelInterpretation,ee=null;const re=C.numberOfOutputs===0?[L]:z,X={get bufferSize(){return O},get channelCount(){return C.channelCount},set channelCount(he){throw n()},get channelCountMode(){return C.channelCountMode},set channelCountMode(he){throw n()},get channelInterpretation(){return K},set channelInterpretation(he){for(const ve of A)ve.channelInterpretation=he;K=he},get context(){return L.context},get inputs(){return A},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get onprocessorerror(){return ee},set onprocessorerror(he){typeof ee=="function"&&X.removeEventListener("processorerror",ee),ee=typeof he=="function"?he:null,typeof ee=="function"&&X.addEventListener("processorerror",ee)},get parameters(){return Z},get port(){return w.port2},addEventListener(...he){return L.addEventListener(he[0],he[1],he[2])},connect:t.bind(null,re),disconnect:c.bind(null,re),dispatchEvent(...he){return L.dispatchEvent(he[0])},removeEventListener(...he){return L.removeEventListener(he[0],he[1],he[2])}},J=new Map;w.port1.addEventListener=(he=>(...ve)=>{if(ve[0]==="message"){const Ge=typeof ve[1]=="function"?ve[1]:typeof ve[1]=="object"&&ve[1]!==null&&typeof ve[1].handleEvent=="function"?ve[1].handleEvent:null;if(Ge!==null){const We=J.get(ve[1]);We!==void 0?ve[1]=We:(ve[1]=Oe=>{u(h.currentTime,h.sampleRate,()=>Ge(Oe))},J.set(Ge,ve[1]))}}return he.call(w.port1,ve[0],ve[1],ve[2])})(w.port1.addEventListener),w.port1.removeEventListener=(he=>(...ve)=>{if(ve[0]==="message"){const Ge=J.get(ve[1]);Ge!==void 0&&(J.delete(ve[1]),ve[1]=Ge)}return he.call(w.port1,ve[0],ve[1],ve[2])})(w.port1.removeEventListener);let oe=null;Object.defineProperty(w.port1,"onmessage",{get:()=>oe,set:he=>{typeof oe=="function"&&w.port1.removeEventListener("message",oe),oe=typeof he=="function"?he:null,typeof oe=="function"&&(w.port1.addEventListener("message",oe),w.port1.start())}}),g.prototype.port=w.port1;let W=null;c5(h,X,g,C).then(he=>W=he);const we=hp(C.numberOfInputs,C.channelCount),De=hp(C.numberOfOutputs,m),de=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((he,{name:ve})=>({...he,[ve]:new Float32Array(128)}),{});let xe=!0;const rt=()=>{C.numberOfOutputs>0&&L.disconnect(U);for(let he=0,ve=0;he<C.numberOfOutputs;he+=1){const Ge=z[he];for(let We=0;We<m[he];We+=1)U.disconnect(Ge,ve+We,We);ve+=m[he]}},Ce=new Map;L.onaudioprocess=({inputBuffer:he,outputBuffer:ve})=>{if(W!==null){const Ge=d(X);for(let We=0;We<O;We+=128){for(let Oe=0;Oe<C.numberOfInputs;Oe+=1)for(let Je=0;Je<C.channelCount;Je+=1)fp(he,we[Oe],Je,Je,We);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:Oe},Je)=>{fp(he,de,Oe,v+Je,We)});for(let Oe=0;Oe<C.numberOfInputs;Oe+=1)for(let Je=0;Je<m[Oe];Je+=1)De[Oe][Je].byteLength===0&&(De[Oe][Je]=new Float32Array(128));try{const Oe=we.map((Ut,_t)=>{if(Ge[_t].size>0)return Ce.set(_t,O/128),Ut;const yn=Ce.get(_t);return yn===void 0?[]:(Ut.every(Ot=>Ot.every(Ar=>Ar===0))&&(yn===1?Ce.delete(_t):Ce.set(_t,yn-1)),Ut)});xe=u(h.currentTime+We/h.sampleRate,h.sampleRate,()=>W.process(Oe,De,de));for(let Ut=0,_t=0;Ut<C.numberOfOutputs;Ut+=1){for(let Hn=0;Hn<m[Ut];Hn+=1)FT(ve,De[Ut],Hn,_t+Hn,We);_t+=m[Ut]}}catch(Oe){xe=!1,X.dispatchEvent(new ErrorEvent("processorerror",{colno:Oe.colno,filename:Oe.filename,lineno:Oe.lineno,message:Oe.message}))}if(!xe){for(let Oe=0;Oe<C.numberOfInputs;Oe+=1){A[Oe].disconnect(x[Oe]);for(let Je=0;Je<C.channelCount;Je+=1)x[We].disconnect(_,Je,Oe*C.channelCount+Je)}if(g.parameterDescriptors!==void 0){const Oe=g.parameterDescriptors.length;for(let Je=0;Je<Oe;Je+=1){const Ut=T[Je];Ut.disconnect(_,0,v+Je),Ut.stop()}}_.disconnect(L),L.onaudioprocess=null,tn?rt():$e();break}}}};let tn=!1;const vn=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Zn=()=>L.connect(vn).connect(h.destination),$e=()=>{L.disconnect(vn),vn.disconnect()},Zt=()=>{if(xe){$e(),C.numberOfOutputs>0&&L.connect(U);for(let he=0,ve=0;he<C.numberOfOutputs;he+=1){const Ge=z[he];for(let We=0;We<m[he];We+=1)U.connect(Ge,ve+We,We);ve+=m[he]}}tn=!0},Jt=()=>{xe&&(Zn(),rt()),tn=!1};return Zn(),f(X,Zt,Jt)},GT=(t,e)=>{const n=t.createBiquadFilter();return dn(n,e),jt(n,e,"Q"),jt(n,e,"detune"),jt(n,e,"frequency"),jt(n,e,"gain"),Pt(n,e,"type"),n},d5=(t,e)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,i),dn(i,r),i},f5=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw Tn()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw Tn()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw Tn()}})},Kd=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return dn(n,e),f5(n),n},h5=(t,e,n,r,i)=>(o,s)=>{if(o.createConstantSource===void 0)return n(o,s);const a=o.createConstantSource();return dn(a,s),jt(a,s,"offset"),e(r,()=>r(o))||bC(a),e(i,()=>i(o))||wC(a),t(o,a),a},Dc=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),p5=(t,e,n,r)=>(i,{offset:o,...s})=>{const a=i.createBuffer(1,2,44100),l=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=n(i,{...s,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,l.buffer=a,l.loop=!0;const d={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(p){c.channelCount=p},get channelCountMode(){return c.channelCountMode},set channelCountMode(p){c.channelCountMode=p},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(p){c.channelInterpretation=p},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(p){l.onended=p},addEventListener(...p){return l.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return l.dispatchEvent(p[0])},removeEventListener(...p){return l.removeEventListener(p[0],p[1],p[2])},start(p=0){l.start.call(l,p)},stop(p=0){l.stop.call(l,p)}},f=()=>l.connect(c),h=()=>l.disconnect(c);return t(i,l),r(Dc(d,c),f,h)},g5=(t,e)=>(n,r)=>{const i=n.createConvolver();if(dn(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),Pt(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",o=>()=>o.call(i),o=>s=>{if(s>2)throw t();return o.call(i,s)}),r.channelCountMode==="max"))throw t();return e(i,"channelCountMode",o=>()=>o.call(i),o=>s=>{if(s==="max")throw t();return o.call(i,s)}),i},WT=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return dn(n,e),jt(n,e,"delayTime"),n},m5=t=>(e,n)=>{const r=e.createDynamicsCompressor();if(dn(r,n),n.channelCount>2||n.channelCountMode==="max")throw t();return jt(r,n,"attack"),jt(r,n,"knee"),jt(r,n,"ratio"),jt(r,n,"release"),jt(r,n,"threshold"),r},br=(t,e)=>{const n=t.createGain();return dn(n,e),jt(n,e,"gain"),n},v5=t=>(e,n,r)=>{if(e.createIIRFilter===void 0)return t(e,n,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return dn(i,r),i};function y5(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function C5(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function uw(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)n=C5(n,e),n[0]+=t[r];return n}const I5=(t,e,n,r)=>(i,o,{channelCount:s,channelCountMode:a,channelInterpretation:l,feedback:c,feedforward:u})=>{const d=VT(o,i.sampleRate),f=c instanceof Float64Array?c:new Float64Array(c),h=u instanceof Float64Array?u:new Float64Array(u),p=f.length,g=h.length,C=Math.min(p,g);if(p===0||p>20)throw r();if(f[0]===0)throw e();if(g===0||g>20)throw r();if(h[0]===0)throw e();if(f[0]!==1){for(let T=0;T<g;T+=1)h[T]/=f[0];for(let T=1;T<p;T+=1)f[T]/=f[0]}const m=n(i,d,s,s);m.channelCount=s,m.channelCountMode=a,m.channelInterpretation=l;const v=32,S=[],E=[],w=[];for(let T=0;T<s;T+=1){S.push(0);const _=new Float32Array(v),O=new Float32Array(v);_.fill(0),O.fill(0),E.push(_),w.push(O)}m.onaudioprocess=T=>{const _=T.inputBuffer,O=T.outputBuffer,L=_.numberOfChannels;for(let U=0;U<L;U+=1){const z=_.getChannelData(U),Z=O.getChannelData(U);S[U]=UT(f,p,h,g,C,E[U],w[U],S[U],v,z,Z)}};const A=i.sampleRate/2;return Dc({get bufferSize(){return d},get channelCount(){return m.channelCount},set channelCount(T){m.channelCount=T},get channelCountMode(){return m.channelCountMode},set channelCountMode(T){m.channelCountMode=T},get channelInterpretation(){return m.channelInterpretation},set channelInterpretation(T){m.channelInterpretation=T},get context(){return m.context},get inputs(){return[m]},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},addEventListener(...T){return m.addEventListener(T[0],T[1],T[2])},dispatchEvent(...T){return m.dispatchEvent(T[0])},getFrequencyResponse(T,_,O){if(T.length!==_.length||_.length!==O.length)throw t();const L=T.length;for(let U=0;U<L;U+=1){const z=-Math.PI*(T[U]/A),Z=[Math.cos(z),Math.sin(z)],K=uw(h,Z),ee=uw(f,Z),re=y5(K,ee);_[U]=Math.sqrt(re[0]*re[0]+re[1]*re[1]),O[U]=Math.atan2(re[1],re[0])}},removeEventListener(...T){return m.removeEventListener(T[0],T[1],T[2])}},m)},S5=(t,e)=>t.createMediaElementSource(e.mediaElement),b5=(t,e)=>{const n=t.createMediaStreamDestination();return dn(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},w5=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((o,s)=>o.id<s.id?-1:o.id>s.id?1:0);const r=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},A5=(t,e)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),o=n.createMediaStreamSource(i);if(r.kind!=="audio")throw t();if(e(n))throw new TypeError;return o},k5=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,E5=(t,e,n,r,i,o)=>(s,a)=>{const l=s.createOscillator();return dn(l,a),jt(l,a,"detune"),jt(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):Pt(l,a,"type"),e(n,()=>n(s))||bC(l),e(r,()=>r(s))||o(l,s),e(i,()=>i(s))||wC(l),t(s,l),l},T5=t=>(e,n)=>{const r=e.createPanner();return r.orientationX===void 0?t(e,n):(dn(r,n),jt(r,n,"orientationX"),jt(r,n,"orientationY"),jt(r,n,"orientationZ"),jt(r,n,"positionX"),jt(r,n,"positionY"),jt(r,n,"positionZ"),Pt(r,n,"coneInnerAngle"),Pt(r,n,"coneOuterAngle"),Pt(r,n,"coneOuterGain"),Pt(r,n,"distanceModel"),Pt(r,n,"maxDistance"),Pt(r,n,"panningModel"),Pt(r,n,"refDistance"),Pt(r,n,"rolloffFactor"),r)},R5=(t,e,n,r,i,o,s,a,l,c)=>(u,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:h,distanceModel:p,maxDistance:g,orientationX:C,orientationY:m,orientationZ:v,panningModel:S,positionX:E,positionY:w,positionZ:A,refDistance:x,rolloffFactor:T,..._})=>{const O=u.createPanner();if(_.channelCount>2||_.channelCountMode==="max")throw s();dn(O,_);const L={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},U=n(u,{...L,channelInterpretation:"speakers",numberOfInputs:6}),z=r(u,{..._,gain:1}),Z=r(u,{...L,gain:1}),K=r(u,{...L,gain:0}),ee=r(u,{...L,gain:0}),re=r(u,{...L,gain:0}),X=r(u,{...L,gain:0}),J=r(u,{...L,gain:0}),oe=i(u,256,6,1),W=o(u,{...L,curve:new Float32Array([1,1]),oversample:"none"});let se=[C,m,v],we=[E,w,A];const De=new Float32Array(1);oe.onaudioprocess=({inputBuffer:Ce})=>{const tn=[l(Ce,De,0),l(Ce,De,1),l(Ce,De,2)];tn.some((Zn,$e)=>Zn!==se[$e])&&(O.setOrientation(...tn),se=tn);const vn=[l(Ce,De,3),l(Ce,De,4),l(Ce,De,5)];vn.some((Zn,$e)=>Zn!==we[$e])&&(O.setPosition(...vn),we=vn)},Object.defineProperty(K.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ee.gain,"defaultValue",{get:()=>0}),Object.defineProperty(re.gain,"defaultValue",{get:()=>0}),Object.defineProperty(X.gain,"defaultValue",{get:()=>0}),Object.defineProperty(J.gain,"defaultValue",{get:()=>0});const de={get bufferSize(){},get channelCount(){return O.channelCount},set channelCount(Ce){if(Ce>2)throw s();z.channelCount=Ce,O.channelCount=Ce},get channelCountMode(){return O.channelCountMode},set channelCountMode(Ce){if(Ce==="max")throw s();z.channelCountMode=Ce,O.channelCountMode=Ce},get channelInterpretation(){return O.channelInterpretation},set channelInterpretation(Ce){z.channelInterpretation=Ce,O.channelInterpretation=Ce},get coneInnerAngle(){return O.coneInnerAngle},set coneInnerAngle(Ce){O.coneInnerAngle=Ce},get coneOuterAngle(){return O.coneOuterAngle},set coneOuterAngle(Ce){O.coneOuterAngle=Ce},get coneOuterGain(){return O.coneOuterGain},set coneOuterGain(Ce){if(Ce<0||Ce>1)throw e();O.coneOuterGain=Ce},get context(){return O.context},get distanceModel(){return O.distanceModel},set distanceModel(Ce){O.distanceModel=Ce},get inputs(){return[z]},get maxDistance(){return O.maxDistance},set maxDistance(Ce){if(Ce<0)throw new RangeError;O.maxDistance=Ce},get numberOfInputs(){return O.numberOfInputs},get numberOfOutputs(){return O.numberOfOutputs},get orientationX(){return Z.gain},get orientationY(){return K.gain},get orientationZ(){return ee.gain},get panningModel(){return O.panningModel},set panningModel(Ce){O.panningModel=Ce},get positionX(){return re.gain},get positionY(){return X.gain},get positionZ(){return J.gain},get refDistance(){return O.refDistance},set refDistance(Ce){if(Ce<0)throw new RangeError;O.refDistance=Ce},get rolloffFactor(){return O.rolloffFactor},set rolloffFactor(Ce){if(Ce<0)throw new RangeError;O.rolloffFactor=Ce},addEventListener(...Ce){return z.addEventListener(Ce[0],Ce[1],Ce[2])},dispatchEvent(...Ce){return z.dispatchEvent(Ce[0])},removeEventListener(...Ce){return z.removeEventListener(Ce[0],Ce[1],Ce[2])}};d!==de.coneInnerAngle&&(de.coneInnerAngle=d),f!==de.coneOuterAngle&&(de.coneOuterAngle=f),h!==de.coneOuterGain&&(de.coneOuterGain=h),p!==de.distanceModel&&(de.distanceModel=p),g!==de.maxDistance&&(de.maxDistance=g),C!==de.orientationX.value&&(de.orientationX.value=C),m!==de.orientationY.value&&(de.orientationY.value=m),v!==de.orientationZ.value&&(de.orientationZ.value=v),S!==de.panningModel&&(de.panningModel=S),E!==de.positionX.value&&(de.positionX.value=E),w!==de.positionY.value&&(de.positionY.value=w),A!==de.positionZ.value&&(de.positionZ.value=A),x!==de.refDistance&&(de.refDistance=x),T!==de.rolloffFactor&&(de.rolloffFactor=T),(se[0]!==1||se[1]!==0||se[2]!==0)&&O.setOrientation(...se),(we[0]!==0||we[1]!==0||we[2]!==0)&&O.setPosition(...we);const xe=()=>{z.connect(O),t(z,W,0,0),W.connect(Z).connect(U,0,0),W.connect(K).connect(U,0,1),W.connect(ee).connect(U,0,2),W.connect(re).connect(U,0,3),W.connect(X).connect(U,0,4),W.connect(J).connect(U,0,5),U.connect(oe).connect(u.destination)},rt=()=>{z.disconnect(O),a(z,W,0,0),W.disconnect(Z),Z.disconnect(U),W.disconnect(K),K.disconnect(U),W.disconnect(ee),ee.disconnect(U),W.disconnect(re),re.disconnect(U),W.disconnect(X),X.disconnect(U),W.disconnect(J),J.disconnect(U),U.disconnect(oe),oe.disconnect(u.destination)};return c(Dc(de,O),xe,rt)},x5=t=>(e,{disableNormalization:n,imag:r,real:i})=>{const o=r instanceof Float32Array?r:new Float32Array(r),s=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(s,o,{disableNormalization:n});if(Array.from(r).length<2)throw t();return a},Jd=(t,e,n,r)=>t.createScriptProcessor(e,n,r),P5=(t,e)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,r);const o=n.createStereoPanner();return dn(o,r),jt(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:s=>{if(s!==i)throw e()}}),o},N5=(t,e,n,r,i,o)=>{const a=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},d=(p,g,C,m)=>{const v=new Float32Array(16385),S=new Float32Array(16385);for(let _=0;_<16385;_+=1){const O=_/16384*l;v[_]=Math.cos(O),S[_]=Math.sin(O)}const E=n(p,{...c,gain:0}),w=r(p,{...u,curve:v}),A=r(p,{...u,curve:a}),x=n(p,{...c,gain:0}),T=r(p,{...u,curve:S});return{connectGraph(){g.connect(E),g.connect(A.inputs===void 0?A:A.inputs[0]),g.connect(x),A.connect(C),C.connect(w.inputs===void 0?w:w.inputs[0]),C.connect(T.inputs===void 0?T:T.inputs[0]),w.connect(E.gain),T.connect(x.gain),E.connect(m,0,0),x.connect(m,0,1)},disconnectGraph(){g.disconnect(E),g.disconnect(A.inputs===void 0?A:A.inputs[0]),g.disconnect(x),A.disconnect(C),C.disconnect(w.inputs===void 0?w:w.inputs[0]),C.disconnect(T.inputs===void 0?T:T.inputs[0]),w.disconnect(E.gain),T.disconnect(x.gain),E.disconnect(m,0,0),x.disconnect(m,0,1)}}},f=(p,g,C,m)=>{const v=new Float32Array(16385),S=new Float32Array(16385),E=new Float32Array(16385),w=new Float32Array(16385),A=Math.floor(16385/2);for(let re=0;re<16385;re+=1)if(re>A){const X=(re-A)/(16384-A)*l;v[re]=Math.cos(X),S[re]=Math.sin(X),E[re]=0,w[re]=1}else{const X=re/(16384-A)*l;v[re]=1,S[re]=0,E[re]=Math.cos(X),w[re]=Math.sin(X)}const x=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),T=n(p,{...c,gain:0}),_=r(p,{...u,curve:v}),O=n(p,{...c,gain:0}),L=r(p,{...u,curve:S}),U=r(p,{...u,curve:a}),z=n(p,{...c,gain:0}),Z=r(p,{...u,curve:E}),K=n(p,{...c,gain:0}),ee=r(p,{...u,curve:w});return{connectGraph(){g.connect(x),g.connect(U.inputs===void 0?U:U.inputs[0]),x.connect(T,0),x.connect(O,0),x.connect(z,1),x.connect(K,1),U.connect(C),C.connect(_.inputs===void 0?_:_.inputs[0]),C.connect(L.inputs===void 0?L:L.inputs[0]),C.connect(Z.inputs===void 0?Z:Z.inputs[0]),C.connect(ee.inputs===void 0?ee:ee.inputs[0]),_.connect(T.gain),L.connect(O.gain),Z.connect(z.gain),ee.connect(K.gain),T.connect(m,0,0),z.connect(m,0,0),O.connect(m,0,1),K.connect(m,0,1)},disconnectGraph(){g.disconnect(x),g.disconnect(U.inputs===void 0?U:U.inputs[0]),x.disconnect(T,0),x.disconnect(O,0),x.disconnect(z,1),x.disconnect(K,1),U.disconnect(C),C.disconnect(_.inputs===void 0?_:_.inputs[0]),C.disconnect(L.inputs===void 0?L:L.inputs[0]),C.disconnect(Z.inputs===void 0?Z:Z.inputs[0]),C.disconnect(ee.inputs===void 0?ee:ee.inputs[0]),_.disconnect(T.gain),L.disconnect(O.gain),Z.disconnect(z.gain),ee.disconnect(K.gain),T.disconnect(m,0,0),z.disconnect(m,0,0),O.disconnect(m,0,1),K.disconnect(m,0,1)}}},h=(p,g,C,m,v)=>{if(g===1)return d(p,C,m,v);if(g===2)return f(p,C,m,v);throw i()};return(p,{channelCount:g,channelCountMode:C,pan:m,...v})=>{if(C==="max")throw i();const S=t(p,{...v,channelCount:1,channelCountMode:C,numberOfInputs:2}),E=n(p,{...v,channelCount:g,channelCountMode:C,gain:1}),w=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:m});let{connectGraph:A,disconnectGraph:x}=h(p,g,E,w,S);Object.defineProperty(w.gain,"defaultValue",{get:()=>0}),Object.defineProperty(w.gain,"maxValue",{get:()=>1}),Object.defineProperty(w.gain,"minValue",{get:()=>-1});const T={get bufferSize(){},get channelCount(){return E.channelCount},set channelCount(U){E.channelCount!==U&&(_&&x(),{connectGraph:A,disconnectGraph:x}=h(p,U,E,w,S),_&&A()),E.channelCount=U},get channelCountMode(){return E.channelCountMode},set channelCountMode(U){if(U==="clamped-max"||U==="max")throw i();E.channelCountMode=U},get channelInterpretation(){return E.channelInterpretation},set channelInterpretation(U){E.channelInterpretation=U},get context(){return E.context},get inputs(){return[E]},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get pan(){return w.gain},addEventListener(...U){return E.addEventListener(U[0],U[1],U[2])},dispatchEvent(...U){return E.dispatchEvent(U[0])},removeEventListener(...U){return E.removeEventListener(U[0],U[1],U[2])}};let _=!1;const O=()=>{A(),_=!0},L=()=>{x(),_=!1};return o(Dc(T,S),O,L)}},_5=(t,e,n,r,i,o,s)=>(a,l)=>{const c=a.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,l);dn(c,l);const u=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(u!==null&&u.length<2)throw e();Pt(c,{curve:u},"curve"),Pt(c,l,"oversample");let d=null,f=!1;return s(c,"curve",g=>()=>g.call(c),g=>C=>(g.call(c,C),f&&(r(C)&&d===null?d=t(a,c):!r(C)&&d!==null&&(d(),d=null)),C)),i(c,()=>{f=!0,r(c.curve)&&(d=t(a,c))},()=>{f=!1,d!==null&&(d(),d=null)})},O5=(t,e,n,r,i)=>(o,{curve:s,oversample:a,...l})=>{const c=o.createWaveShaper(),u=o.createWaveShaper();dn(c,l),dn(u,l);const d=n(o,{...l,gain:1}),f=n(o,{...l,gain:-1}),h=n(o,{...l,gain:1}),p=n(o,{...l,gain:-1});let g=null,C=!1,m=null;const v={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(w){d.channelCount=w,f.channelCount=w,c.channelCount=w,h.channelCount=w,u.channelCount=w,p.channelCount=w},get channelCountMode(){return c.channelCountMode},set channelCountMode(w){d.channelCountMode=w,f.channelCountMode=w,c.channelCountMode=w,h.channelCountMode=w,u.channelCountMode=w,p.channelCountMode=w},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(w){d.channelInterpretation=w,f.channelInterpretation=w,c.channelInterpretation=w,h.channelInterpretation=w,u.channelInterpretation=w,p.channelInterpretation=w},get context(){return c.context},get curve(){return m},set curve(w){if(w!==null&&w.length<2)throw e();if(w===null)c.curve=w,u.curve=w;else{const A=w.length,x=new Float32Array(A+2-A%2),T=new Float32Array(A+2-A%2);x[0]=w[0],T[0]=-w[A-1];const _=Math.ceil((A+1)/2),O=(A+1)/2-1;for(let L=1;L<_;L+=1){const U=L/_*O,z=Math.floor(U),Z=Math.ceil(U);x[L]=z===Z?w[z]:(1-(U-z))*w[z]+(1-(Z-U))*w[Z],T[L]=z===Z?-w[A-1-z]:-((1-(U-z))*w[A-1-z])-(1-(Z-U))*w[A-1-Z]}x[_]=A%2===1?w[_-1]:(w[_-2]+w[_-1])/2,c.curve=x,u.curve=T}m=w,C&&(r(m)&&g===null?g=t(o,d):g!==null&&(g(),g=null))},get inputs(){return[d]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(w){c.oversample=w,u.oversample=w},addEventListener(...w){return d.addEventListener(w[0],w[1],w[2])},dispatchEvent(...w){return d.dispatchEvent(w[0])},removeEventListener(...w){return d.removeEventListener(w[0],w[1],w[2])}};s!==null&&(v.curve=s instanceof Float32Array?s:new Float32Array(s)),a!==v.oversample&&(v.oversample=a);const S=()=>{d.connect(c).connect(h),d.connect(f).connect(u).connect(p).connect(h),C=!0,r(m)&&(g=t(o,d))},E=()=>{d.disconnect(c),c.disconnect(h),d.disconnect(f),f.disconnect(u),u.disconnect(p),p.disconnect(h),C=!1,g!==null&&(g(),g=null)};return i(Dc(v,h),S,E)},wr=()=>new DOMException("","NotSupportedError"),M5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},D5=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...M5,...c},f=n(u,d),h=o(u),p=h?r():null,g=l.sampleRate/2;super(l,!1,f,p),this._detune=e(this,h,f.detune,153600,-153600),this._frequency=e(this,h,f.frequency,g,-g),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?s(this,l):null;this._nativeOscillatorNode.onended=c;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===c?l:u}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Ic(this);const c=()=>{this._nativeOscillatorNode.removeEventListener("ended",c),ls(this)&&zd(this)};this._nativeOscillatorNode.addEventListener("ended",c)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},L5=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null,l=null;const c=async(u,d)=>{let f=n(u);const h=jn(f,d);if(!h){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:s===null?void 0:s,type:f.type};f=e(d,p),a!==null&&f.start(a),l!==null&&f.stop(l)}return o.set(d,f),h?(await t(d,u.detune,f.detune),await t(d,u.frequency,f.frequency)):(await r(d,u.detune,f.detune),await r(d,u.frequency,f.frequency)),await i(u,d,f),f};return{set periodicWave(u){s=u},set start(u){a=u},set stop(u){l=u},render(u,d){const f=o.get(d);return f!==void 0?Promise.resolve(f):c(u,d)}}},B5={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},F5=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...B5,...c},f=n(u,d),h=o(u),p=h?r():null;super(l,!1,f,p),this._nativePannerNode=f,this._orientationX=e(this,h,f.orientationX,Yn,pr),this._orientationY=e(this,h,f.orientationY,Yn,pr),this._orientationZ=e(this,h,f.orientationZ,Yn,pr),this._positionX=e(this,h,f.positionX,Yn,pr),this._positionY=e(this,h,f.positionY,Yn,pr),this._positionZ=e(this,h,f.positionZ,Yn,pr),s(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},U5=(t,e,n,r,i,o,s,a,l,c)=>()=>{const u=new WeakMap;let d=null;const f=async(h,p)=>{let g=null,C=o(h);const m={channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation},v={...m,coneInnerAngle:C.coneInnerAngle,coneOuterAngle:C.coneOuterAngle,coneOuterGain:C.coneOuterGain,distanceModel:C.distanceModel,maxDistance:C.maxDistance,panningModel:C.panningModel,refDistance:C.refDistance,rolloffFactor:C.rolloffFactor},S=jn(C,p);if("bufferSize"in C)g=r(p,{...m,gain:1});else if(!S){const E={...v,orientationX:C.orientationX.value,orientationY:C.orientationY.value,orientationZ:C.orientationZ.value,positionX:C.positionX.value,positionY:C.positionY.value,positionZ:C.positionZ.value};C=i(p,E)}if(u.set(p,g===null?C:g),g!==null){if(d===null){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const L=new s(6,h.context.length,p.sampleRate),U=e(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});U.connect(L.destination),d=(async()=>{const z=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map(async(Z,K)=>{const ee=n(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:K===0?1:0});return await a(L,Z,ee.offset),ee}));for(let Z=0;Z<6;Z+=1)z[Z].connect(U,0,Z),z[Z].start(0);return c(L)})()}const E=await d,w=r(p,{...m,gain:1});await l(h,p,w);const A=[];for(let L=0;L<E.numberOfChannels;L+=1)A.push(E.getChannelData(L));let x=[A[0][0],A[1][0],A[2][0]],T=[A[3][0],A[4][0],A[5][0]],_=r(p,{...m,gain:1}),O=i(p,{...v,orientationX:x[0],orientationY:x[1],orientationZ:x[2],positionX:T[0],positionY:T[1],positionZ:T[2]});w.connect(_).connect(O.inputs[0]),O.connect(g);for(let L=128;L<E.length;L+=128){const U=[A[0][L],A[1][L],A[2][L]],z=[A[3][L],A[4][L],A[5][L]];if(U.some((Z,K)=>Z!==x[K])||z.some((Z,K)=>Z!==T[K])){x=U,T=z;const Z=L/p.sampleRate;_.gain.setValueAtTime(0,Z),_=r(p,{...m,gain:0}),O=i(p,{...v,orientationX:x[0],orientationY:x[1],orientationZ:x[2],positionX:T[0],positionY:T[1],positionZ:T[2]}),_.gain.setValueAtTime(1,Z),w.connect(_).connect(O.inputs[0]),O.connect(g)}}return g}return S?(await t(p,h.orientationX,C.orientationX),await t(p,h.orientationY,C.orientationY),await t(p,h.orientationZ,C.orientationZ),await t(p,h.positionX,C.positionX),await t(p,h.positionY,C.positionY),await t(p,h.positionZ,C.positionZ)):(await a(p,h.orientationX,C.orientationX),await a(p,h.orientationY,C.orientationY),await a(p,h.orientationZ,C.orientationZ),await a(p,h.positionX,C.positionX),await a(p,h.positionY,C.positionY),await a(p,h.positionZ,C.positionZ)),Mc(C)?await l(h,p,C.inputs[0]):await l(h,p,C),C};return{render(h,p){const g=u.get(p);return g!==void 0?Promise.resolve(g):f(h,p)}}},V5={disableNormalization:!1},G5=(t,e,n,r)=>class jT{constructor(o,s){const a=e(o),l=r({...V5,...s}),c=t(a,l);return n.add(c),c}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===jT.prototype||n.has(o)}},W5=(t,e)=>(n,r,i)=>(t(r).replay(i),e(r,n,i)),j5=(t,e,n)=>async(r,i,o)=>{const s=t(r);await Promise.all(s.activeInputs.map((a,l)=>Array.from(a).map(async([c,u])=>{const f=await e(c).render(c,i),h=r.context.destination;!n(c)&&(r!==h||!n(r))&&f.connect(o,u,l)})).reduce((a,l)=>[...a,...l],[]))},Z5=(t,e,n)=>async(r,i,o)=>{const s=e(r);await Promise.all(Array.from(s.activeInputs).map(async([a,l])=>{const u=await t(a).render(a,i);n(a)||u.connect(o,l)}))},H5=(t,e,n,r)=>i=>t(n0,()=>n0(i))?Promise.resolve(t(r,r)).then(o=>{if(!o){const s=n(i,512,0,1);i.oncomplete=()=>{s.onaudioprocess=null,s.disconnect()},s.onaudioprocess=()=>i.currentTime,s.connect(i.destination)}return i.startRendering()}):new Promise(o=>{const s=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{s.disconnect(),o(a.renderedBuffer)},s.connect(i.destination),i.startRendering()}),z5=t=>(e,n)=>{t.set(e,n)},X5=t=>(e,n)=>t.set(e,n),$5={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},K5=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=i(a),u={...$5,...l},d=n(c,u),f=o(c),h=f?r():null;super(a,!1,d,h),this._pan=e(this,f,d.pan)}get pan(){return this._pan}},J5=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=jn(c,l);if(!u){const d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=e(l,d)}return o.set(l,c),u?await t(l,a.pan,c.pan):await r(l,a.pan,c.pan),Mc(c)?await i(a,l,c.inputs[0]):await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},Y5=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},Q5=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(n);let o=!1,s=!1;try{await r.audioWorklet.addModule(i);const a=new t(r,"a",{numberOfOutputs:0}),l=r.createOscillator();a.port.onmessage=()=>o=!0,a.onprocessorerror=()=>s=!0,l.connect(a),l.start(0),await r.startRendering(),await new Promise(c=>setTimeout(c))}catch{}finally{URL.revokeObjectURL(i)}return o&&!s},q5=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},eU=()=>new DOMException("","UnknownError"),tU={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},nU=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...tU,...c},f=n(u,d),p=o(u)?r():null;super(l,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,s(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},rU=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!jn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(s,c)}return r.set(s,a),Mc(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},iU=()=>typeof window>"u"?null:window,oU=(t,e)=>n=>{n.copyFromChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const l=n.length,c=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<l&&d<u;d+=1)r[d]=c[d+s]},n.copyToChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const l=n.length,c=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<l&&d<u;d+=1)c[d+s]=r[d]}},sU=t=>e=>{e.copyFromChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyFromChannel),e.copyToChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyToChannel)},aU=t=>(e,n)=>{const r=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),t(e,"buffer",i=>()=>{const o=i.call(e);return o===r?null:o},i=>o=>i.call(e,o===null?r:o))},lU=(t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let l=0;l<a;l+=1)i.connect(r,0,l)},()=>i.disconnect(r))},ZT=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),HT=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},Yd=(t,e,n,r)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:s}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(o),set:r(s)})},cU=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),uU=t=>({...t,channelCount:t.numberOfOutputs}),dU=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},zT=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(r){if(r.code!==9)throw r;zT(t,e,n+1e-7)}},fU=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},hU=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},pU=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},AC=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},XT=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},kC=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},gU=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},mU=t=>{t.start=(e=>(n=0,r=0,i)=>{const o=t.buffer,s=o===null?r:Math.min(o.duration,r);o!==null&&s>o.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,s,i)})(t.start)},$T=(t,e)=>{const n=e.createGain();t.connect(n);const r=(i=>()=>{i.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),Dc(t,n),t.stop=(i=>{let o=!1;return(s=0)=>{if(o)try{i.call(t,s)}catch{n.gain.setValueAtTime(0,s)}else i.call(t,s),o=!0}})(t.stop)},Lc=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},vU=ZB(hl),yU=JB(hl),CU=l3(ng),KT=new WeakMap,IU=E3(KT),Ss=UF(new Map,new WeakMap),vo=iU(),JT=Q3(Ss,So),YT=k3(er),On=j5(er,YT,nl),SU=tF(JT,Tt,On),Ct=x3(TT),va=k5(vo),ht=W3(va),QT=new WeakMap,qT=y3(Lc),Qd=n5(vo),eR=F3(Qd),tR=U3(vo),bU=V3(vo),bd=i5(vo),Kt=TF(HB(wT),KB(vU,yU,cp,CU,up,er,IU,Hd,Tt,hl,ls,nl,uh),Ss,B3(Jv,up,er,Tt,Sd,ls),So,rg,wr,i3(cp,Jv,er,Tt,Sd,Ct,ls,ht),d3(QT,er,Di),qT,Ct,eR,tR,bU,ht,bd),wU=eF(Kt,SU,So,JT,Ct,ht),nR=new WeakSet,dw=q3(vo),rR=QF(new Uint32Array(1)),iR=oU(rR,So),oR=sU(rR),AU=rF(nR,Ss,wr,dw,va,Y5(dw),iR,oR),ig=YB(br),sR=Z5(YT,Xd,nl),bo=zF(sR),Bc=t5(ig,Ss,fU,hU,pU,AC,XT,kC,mU,aU(Yd),$T),wo=W5(T3(Xd),sR),kU=sF(bo,Bc,Tt,wo,On),Ui=RF(zB(kT),QT,ET,xF,FB,UB,VB,GB,WB,Xv,ST,Qd,zT),EU=oF(Kt,kU,Ui,Tn,Bc,Ct,ht,Lc),TU=mF(Kt,vF,So,Tn,r5(br,Yd),Ct,ht,On),RU=FF(bo,GT,Tt,wo,On),pl=X5(KT),xU=BF(Kt,Ui,RU,rg,GT,Ct,ht,pl),ya=J3(hl,tR),PU=lU(Tn,ya),Ca=d5(Qd,PU),NU=WF(Ca,Tt,On),_U=GF(Kt,NU,Ca,Ct,ht),OU=HF(Kd,Tt,On),MU=ZF(Kt,OU,Kd,Ct,ht,uU),DU=p5(ig,Bc,br,ya),Fc=h5(ig,Ss,DU,AC,kC),LU=YF(bo,Fc,Tt,wo,On),BU=JF(Kt,Ui,LU,Fc,Ct,ht,Lc),aR=g5(wr,Yd),FU=t3(aR,Tt,On),UU=e3(Kt,FU,aR,Ct,ht,pl),VU=a3(bo,WT,Tt,wo,On),GU=s3(Kt,Ui,VU,WT,Ct,ht,pl),lR=m5(wr),WU=g3(bo,lR,Tt,wo,On),jU=p3(Kt,Ui,WU,lR,wr,Ct,ht,pl),ZU=w3(bo,br,Tt,wo,On),HU=b3(Kt,Ui,ZU,br,Ct,ht),zU=I5(rg,Tn,Jd,wr),EC=H5(Ss,br,Jd,q5(br,va)),XU=L3(Bc,Tt,va,On,EC),$U=v5(zU),KU=M3(Kt,$U,XU,Ct,ht,pl),JU=yF(Ui,Ca,Fc,Jd,wr,ZT,ht,Yd),cR=new WeakMap,YU=K3(TU,JU,qT,ht,cR,Lc),uR=E5(ig,Ss,AC,XT,kC,$T),QU=L5(bo,uR,Tt,wo,On),qU=D5(Kt,Ui,uR,QU,Ct,ht,Lc),dR=$F(Bc),e4=O5(dR,Tn,br,HT,ya),og=_5(dR,Tn,e4,HT,ya,Qd,Yd),t4=R5(cp,Tn,Ca,br,Jd,og,wr,up,ZT,ya),fR=T5(t4),n4=U5(bo,Ca,Fc,br,fR,Tt,va,wo,On,EC),r4=F5(Kt,Ui,fR,n4,Ct,ht,pl),i4=x5(So),o4=G5(i4,Ct,new WeakSet,dU),s4=N5(Ca,Kd,br,og,wr,ya),hR=P5(s4,wr),a4=J5(bo,hR,Tt,wo,On),l4=K5(Kt,Ui,hR,a4,Ct,ht),c4=rU(og,Tt,On),u4=nU(Kt,Tn,og,c4,Ct,ht,pl),pR=j3(vo),TC=C3(vo),gR=new WeakMap,d4=P3(gR,va),f4=pR?$B(Ss,wr,v3(vo),TC,I3(jB),Ct,d4,ht,bd,new WeakMap,new WeakMap,Q5(bd,va),vo):void 0,h4=G3(eR,ht),p4=r3(nR,Ss,n3,m3,new WeakSet,Ct,h4,e0,n0,iR,oR),g4=DF(f4,wU,AU,EU,xU,_U,MU,BU,UU,p4,GU,jU,HU,KU,YU,qU,r4,o4,l4,u4),m4=Z3(Kt,S5,Ct,ht),v4=z3(Kt,b5,Ct,ht),y4=X3(Kt,w5,Ct,ht),C4=A5(Tn,ht),I4=$3(Kt,C4,Ct),S4=gF(g4,Tn,wr,eU,m4,v4,y4,I4,Qd),mR=N3(cR),b4=QB(mR),vR=XF(So),w4=c3(mR),yR=f3(So),CR=new WeakMap,A4=A3(CR,Di),k4=u5(vR,So,Tn,Ca,Kd,Fc,br,Jd,wr,yR,TC,A4,ya),E4=s5(Tn,k4,br,wr,ya),T4=MF(bo,vR,Bc,Ca,Kd,Fc,br,w4,yR,TC,Tt,bd,va,wo,On,EC),R4=R3(gR),x4=z5(CR),fw=pR?NF(b4,Kt,Ui,T4,E4,er,R4,Ct,ht,bd,cU,x4,gU,Lc):void 0,P4="data:text/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";class hw{constructor(e){G(this,"maxSize");G(this,"cache");this.maxSize=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const n=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,n),n}set(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}has(e){return this.cache.has(e)}}const N4=100;class pp{static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getBufferFromCache(e,n){try{const r=await n.match(e);return r&&r.ok?await r.arrayBuffer():null}catch(r){return console.error("Failed to get data from cache:",r),null}}static async fetchAndCacheBuffer(e,n,r,i){try{const o=new Headers;r&&o.append("If-None-Match",r),i&&o.append("If-Modified-Since",i);const s=await fetch(e,{headers:o}),a=s.clone();if(s.status===200){const l=s.headers.get("ETag")||void 0,c=s.headers.get("Last-Modified")||void 0,u={url:e,etag:l,lastModified:c};await n.put(e,a),await n.put(e+":meta",new Response(JSON.stringify(u),{headers:{"Content-Type":"application/json"}}))}else if(s.status===304){const l=await n.match(e);if(l)return await l.arrayBuffer()}return await s.arrayBuffer()}catch(o){throw console.error("Failed to fetch and cache data:",o),o}}static async decodeAudioData(e,n){try{return await e.decodeAudioData(n)}catch(r){throw console.error("Failed to decode audio data:",r),r}}static async getMetadataFromCache(e,n){try{const r=await n.match(e+":meta");return r&&r.ok?await r.json():null}catch(r){return console.error("Failed to get metadata from cache:",r),null}}static async getAudioBuffer(e,n){if(this.decodedBuffers.has(n))return this.decodedBuffers.get(n);if(n.startsWith("data:")){const c=n.split(",")[1],u=Uint8Array.from(atob(c),f=>f.charCodeAt(0)).buffer,d=await this.decodeAudioData(e,u);return this.decodedBuffers.set(n,d),d}const r=await this.openCache();let i=this.pendingRequests.get(n);if(i)return i;const o=await this.getBufferFromCache(n,r);if(o){const c=await this.decodeAudioData(e,o);return this.decodedBuffers.set(n,c),c}const s=await this.getMetadataFromCache(n,r),a=s==null?void 0:s.etag,l=s==null?void 0:s.lastModified;return i=this.fetchAndCacheBuffer(n,r,a,l).then(c=>this.decodeAudioData(e,c)).then(c=>(this.decodedBuffers.set(n,c),c)).finally(()=>{this.pendingRequests.delete(n)}),this.pendingRequests.set(n,i),i}static clearMemoryCache(){this.decodedBuffers=new hw(N4),this.pendingRequests.clear()}}G(pp,"pendingRequests",new Map),G(pp,"decodedBuffers",new hw(100));class pw{constructor(e=[]){G(this,"_position",[0,0,0]);G(this,"loopCount",0);G(this,"playIndex",0);this.sounds=e}playRandom(){if(this.sounds.length===0)throw new Error("Cannot play a random sound from an empty group");const e=Math.floor(Math.random()*this.sounds.length),n=this.sounds[e].preplay();return n.forEach(r=>r.play()),n[0]}playOrdered(e=!0){if(this.sounds.length===0)throw new Error("Cannot play an ordered sound from an empty group");const n=this.sounds[this.playIndex].preplay();return n.forEach(r=>r.play()),this.playIndex++,this.playIndex>=this.sounds.length&&(e?this.playIndex=0:this.playIndex=this.sounds.length),n[0]}get duration(){return this.sounds.map(e=>e.duration).reduce((e,n)=>Math.max(e,n),0)}seek(e){this.sounds.forEach(n=>n.seek&&n.seek(e))}addSound(e){this.sounds.push(e)}preplay(){return this.sounds.reduce((e,n)=>(n.loop&&n.loop(this.loopCount),e.concat(n.preplay())),[])}play(){return this.preplay().map(e=>e.play()[0])}get isPlaying(){return this.sounds.some(e=>e.isPlaying)}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(n=>n.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(n=>n.addFilter(e))}removeFilter(e){this.sounds.forEach(n=>n.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(n=>n.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,n)=>e+n,0)/this.sounds.length}set volume(e){this.sounds.forEach(n=>n.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(n=>n.playbackRate=e)}}class Uc{constructor(){G(this,"_filters",[])}addFilter(e){this._filters.push(e)}removeFilter(e){this._filters=this._filters.filter(n=>n.frequency.value!==e.frequency.value&&n.type!==e.type&&n.Q.value!==e.Q.value&&n.gain.value!==e.gain.value)}applyFilters(e){return this._filters.reduce((n,r)=>(n.connect(r),r),e),this._filters.length>0?this._filters[this._filters.length-1]:e}get filters(){return this._filters}addFilters(e){e.forEach(n=>this.addFilter(n))}removeFilters(e){e.forEach(n=>this.removeFilter(n))}}let _4=class extends Uc{constructor(n,r,i,o=0){super();G(this,"context");G(this,"source");G(this,"gainNode");G(this,"panner");this.source=n,this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}get isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!0)}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,o]=n;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=o}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.source;this.source.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(n){}},O4=class extends Uc{constructor(n){super();G(this,"context");G(this,"_position",[0,0,0]);G(this,"loopCount",0);G(this,"prevVolume",1);G(this,"microphoneGainNode");G(this,"streamPlayback");G(this,"stream");G(this,"streamSource");this.context=n,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{this.stream=n,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new _4(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(n=>{console.error("Error initializing microphone stream:",n)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(n){}get isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(n){this.streamPlayback&&this.streamPlayback.addFilter(n)}removeFilter(n){this.streamPlayback&&this.streamPlayback.removeFilter(n)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(n){this.streamPlayback&&(this.streamPlayback.volume=n)}get position(){return[0,0,0]}set position(n){}loop(n){return 0}get playbackRate(){return 1}set playbackRate(n){}};function IR(t){class e extends t{constructor(){super(...arguments);G(this,"playbacks",[]);G(this,"_position",[0,0,0]);G(this,"_stereoPan",0);G(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});G(this,"_volume",1)}play(){const i=this.preplay();return i.forEach(o=>o.play()),i}stop(){this.playbacks.forEach(i=>i.stop()),this.playbacks=[]}pause(){this.playbacks.forEach(i=>i.pause())}addFilter(i){super.addFilter(i),this.playbacks.forEach(o=>o.addFilter(i))}removeFilter(i){super.removeFilter(i),this.playbacks.forEach(o=>o.removeFilter(i))}get isPlaying(){return this.playbacks.some(i=>i.isPlaying)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}set position(i){this._threeDOptions.positionX=i[0],this._threeDOptions.positionY=i[1],this._threeDOptions.positionZ=i[2],this.playbacks.forEach(o=>o.position=i)}get threeDOptions(){return this._threeDOptions}set threeDOptions(i){this._threeDOptions={...this._threeDOptions,...i},this.playbacks.forEach(o=>o.threeDOptions=this._threeDOptions)}get stereoPan(){return this._stereoPan}set stereoPan(i){this._stereoPan=i,this.playbacks.forEach(o=>o.stereoPan=i)}get volume(){return this._volume}set volume(i){this._volume=i,this.playbacks.forEach(o=>o.volume=i)}}return e}function SR(t){class e extends t{constructor(){super(...arguments);G(this,"panner");G(this,"_panType","stereo")}get panType(){return this._panType}setPanType(i,o){this._panType=i,i==="stereo"?this.panner=o.createStereoPanner():this.panner=o.createPanner()}setPannerNode(i){this.panner=i}get stereoPan(){return this.panType==="stereo"?this.panner.pan.value:null}set stereoPan(i){if(this.panType!=="stereo")throw new Error("Stereo panning is not available when using HRTF.");if(!this.panner)throw new Error("Cannot set stereo pan of a sound that has been cleaned up");i=gw(i,-1,1),this.panner.pan.setValueAtTime(gw(i,-1,1),this.panner.context.currentTime)}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get 3D options of a sound that is not using HRTF");const i=this.panner;return{coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,channelCount:this.panner.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,panningModel:i.panningModel,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,positionX:i.positionX.value,positionY:i.positionY.value,positionZ:i.positionZ.value,orientationX:i.orientationX.value,orientationY:i.orientationY.value,orientationZ:i.orientationZ.value}}set threeDOptions(i){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot set 3D options of a sound that is not using HRTF");const o=this.panner;o.coneInnerAngle=i.coneInnerAngle!==void 0?i.coneInnerAngle:o.coneInnerAngle,o.coneOuterAngle=i.coneOuterAngle!==void 0?i.coneOuterAngle:o.coneOuterAngle,o.coneOuterGain=i.coneOuterGain!==void 0?i.coneOuterGain:o.coneOuterGain,o.distanceModel=i.distanceModel||o.distanceModel,o.maxDistance=i.maxDistance!==void 0?i.maxDistance:o.maxDistance,o.channelCount=i.channelCount!==void 0?i.channelCount:o.channelCount,o.channelCountMode=i.channelCountMode||o.channelCountMode,o.channelInterpretation=i.channelInterpretation||o.channelInterpretation,o.panningModel=i.panningModel||o.panningModel,o.refDistance=i.refDistance!==void 0?i.refDistance:o.refDistance,o.rolloffFactor=i.rolloffFactor!==void 0?i.rolloffFactor:o.rolloffFactor,o.positionX.value=i.positionX!==void 0?i.positionX:o.positionX.value,o.positionY.value=i.positionY!==void 0?i.positionY:o.positionY.value,o.positionZ.value=i.positionZ!==void 0?i.positionZ:o.positionZ.value,o.orientationX.value=i.orientationX!==void 0?i.orientationX:o.orientationX.value,o.orientationY.value=i.orientationY!==void 0?i.orientationY:o.orientationY.value,o.orientationZ.value=i.orientationZ!==void 0?i.orientationZ:o.orientationZ.value}set position(i){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot move a sound that is not using HRTF");const[o,s,a]=i,l=this.panner;l.positionX.value=o,l.positionY.value=s,l.positionZ.value=a}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get position of a sound that is not using HRTF");const i=this.panner;return[i.positionX.value,i.positionY.value,i.positionZ.value]}}return e}function gw(t,e,n){return Math.min(Math.max(t,e),n)}function bR(t){class e extends t{constructor(){super(...arguments);G(this,"gainNode")}setGainNode(i){this.gainNode=i}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(i){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=i}}return e}class wR extends SR(bR(Uc)){constructor(){super(...arguments);G(this,"source");G(this,"_playing",!1)}get isPlaying(){return this.source?this._playing:!1}}class RC extends wR{constructor(n,r,i,o=0,s="HRTF"){super();G(this,"context");G(this,"loopCount",0);G(this,"currentLoop",0);G(this,"buffer");G(this,"pauseTime",0);G(this,"startTime",0);G(this,"handleLoop",()=>{this.source&&(this.currentLoop++,this.loopCount!=="infinite"&&this.currentLoop>this.loopCount&&(this._playing=!1,this.stop()),this.loopCount==="infinite"||this.currentLoop<this.loopCount?this.buffer?(this.recreateSource(),this._playing&&(this.source.start(0),this._playing=!0)):this._playing&&this.seek(0):this._playing=!1)});if(this.loopCount=o,this.setPanType(s,i),this.source=n,"buffer"in n&&n.buffer&&(this.buffer=n.buffer),"mediaElement"in n&&n.mediaElement)n.mediaElement.onended=this.handleLoop;else if("onended"in n)n.onended=this.handleLoop;else throw new Error("Unsupported source type");this.context=i,this.source.connect(this.panner),this.setGainNode(r),this.panner.connect(this.gainNode),this.refreshFilters()}get duration(){if(!this.buffer)throw new Error("Cannot get duration of a sound that has been cleaned up");return this.buffer.duration}get playbackRate(){if(!this.source)throw new Error("Cannot get playback rate of a sound that has been cleaned up");if("playbackRate"in this.source)return this.source.playbackRate.value;if("mediaElement"in this.source&&this.source.mediaElement)return this.source.mediaElement.playbackRate;throw new Error("Unsupported source type")}set playbackRate(n){if(!this.source)throw new Error("Cannot set playback rate of a sound that has been cleaned up");"playbackRate"in this.source&&(this.source.playbackRate.value=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=n)}recreateSource(){if(!this.buffer||!this.source||!this.panner||!this.context||!this.gainNode)throw new Error("Cannot recreate source of a sound that has been cleaned up");this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.panner),this.source.onended=this.handleLoop}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");if("mediaElement"in this.source&&this.source.mediaElement)this.source.mediaElement.play();else if("start"in this.source&&this.source.start){const n=this.pauseTime?this.pauseTime:0;this.source.start(0,n)}return this._playing=!0,[this]}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.pause():"stop"in this.source&&this.source.stop&&(this.pauseTime=this.context.currentTime-this.startTime,this.source.stop()),this._playing=!1}seek(n){if(!this.source||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");const r=this.isPlaying;if(this.stop(),this.pauseTime=n,"mediaElement"in this.source&&this.source.mediaElement)this.source.mediaElement.currentTime=n,r&&this.source.mediaElement.play();else if(this.buffer)this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.onended=this.handleLoop,this.refreshFilters(),this.source.connect(this.panner),r&&this.source.start(0,n);else throw new Error("Unsupported source type for seeking")}set sourceLoop(n){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=n)}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this._filters.forEach(n=>{n&&n.disconnect()}),this._filters=[]}loop(n){var r;if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if("mediaElement"in this.source&&this.source.mediaElement){const i=this.source.mediaElement;return n===void 0||(i.loop=!0),i.loop===!0?"infinite":0}else if("loop"in this.source)return n===void 0?this.source.loop===!0?"infinite":0:(this.source.loop=!0,this.source.loopEnd=((r=this.source.buffer)==null?void 0:r.duration)||0,this.source.loopStart=0,this.source.loop===!0?"infinite":0);throw new Error("Unsupported source type")}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");if(this.isPlaying){try{"stop"in this.source&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0)}catch{}this._playing=!1,this.startTime=0,this.pauseTime=0}}addFilter(n){const r=n.context.createBiquadFilter();r.type=n.type,r.frequency.value=n.frequency.value,r.Q.value=n.Q.value,super.addFilter(r),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}clone(n={}){if(!this.source||!this.gainNode||!this.context)throw new Error("Cannot clone a sound that has been cleaned up");const r=n.panType||this.panType,i=this.context.createGain();let o;if("buffer"in this.source&&this.source.buffer)o=this.context.createBufferSource(),o.buffer=this.source.buffer;else if("mediaElement"in this.source&&this.source.mediaElement)o=this.context.createMediaElementSource(this.source.mediaElement);else throw new Error("Unsupported source type");const s=n.loopCount!==void 0?n.loopCount:this.loopCount;return new RC(o,i,this.context,s,r)}}let Of=class AR extends IR(Uc){constructor(n,r,i,o,s=wd.Buffer,a="HRTF"){super();G(this,"buffer");G(this,"context");G(this,"loopCount",0);G(this,"_playbackRate",1);this.url=n,this.globalGainNode=o,this.soundType=s,this.panType=a,this.buffer=r,this.context=i}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan,o=n.threeDOptions||this.threeDOptions,s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=n.playbackRate||this.playbackRate,l=n.volume!==void 0?n.volume:this.volume,c=n.position&&n.position.length?n.position:this.position,u=n.filters&&n.filters.length?n.filters:this._filters,d=new AR(this.url,this.buffer,this.context,this.globalGainNode,this.soundType,r);return d.loopCount=s,d._playbackRate=a,d._volume=l,d._position=c,d._stereoPan=i,d._threeDOptions=o,d.addFilters(u),d}preplay(){let n;if(this.buffer)n=this.context.createBufferSource(),n.buffer=this.buffer;else{const o=new Audio;o.crossOrigin="anonymous",o.src=this.url,o.preload="auto",n=this.context.createMediaElementSource(o)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new RC(n,r,this.context,this.loopCount,this.panType);return i.setGainNode(r),i.volume=this.volume,i.playbackRate=this.playbackRate,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}seek(n){this.playbacks.forEach(r=>r.seek(n))}get duration(){var n;return((n=this.buffer)==null?void 0:n.duration)||0}loop(n){return n===void 0?this.loopCount:(this.loopCount=n,this.playbacks.forEach(r=>r.loop(n)),this.loopCount)}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.playbacks.forEach(r=>r.playbackRate=n)}};const M4=(t,e)=>{var n=new Uint8Array(t.byteLength+e.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),t.byteLength),n.buffer};function D4(t,e){const n=[];let r=0;fetch(t).then(function(o){if(!o.ok)throw new Error("HTTP error, status = "+o.status);if(!o.body)throw new Error("Missing body");var s=o.body.getReader();let a=new ArrayBuffer(0);function l(){return s.read().then(({value:c,done:u})=>{let d=null;if(c){if(a.byteLength?d=M4(a,c.buffer):(a=c.buffer.slice(0,44),d=c.buffer),e.decodeAudioData(d,function(f){n.push(f),n.length&&i()},function(f){console.log("err(decodeAudioData): "+f)}),u){console.log("done");return}l()}})}l()});function i(){for(;n.length;){let o=n.shift();const s=e.createBufferSource();if(!o)return;s.buffer=o,s.connect(e.destination),r==0&&(r=e.currentTime+.02),s.start(r),r+=s.buffer.duration}}}function L4(t){class e extends wR{constructor(){super(...arguments);G(this,"_oscillatorOptions",{})}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(i){this._oscillatorOptions=i,this.source&&this.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type))}play(){if(!this.source)throw new Error("No source node found");return this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type),this.source.start(),this._playing=!0,[this]}stop(){this.source&&this.source.stop&&(this.source.stop(),this._playing=!1)}pause(){this.stop()}get frequency(){return this.source.frequency.value}set frequency(i){this.source.frequency.value=i,this.oscillatorOptions.frequency=i}get detune(){return this.source.detune.value}set detune(i){this.source.detune.value=i,this.oscillatorOptions.detune=i}get type(){return this.source.type}set type(i){this.source.type=i,this.oscillatorOptions.type=i}}return e}class B4 extends L4(SR(bR(Uc))){constructor(e,n,r,i="HRTF"){super(),this.source=e,this.context=r,this.setPanType(i,r),this.source.connect(this.panner),this.setGainNode(n),this.panner.connect(this.gainNode),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let e=this.panner;e.disconnect(),e=this.applyFilters(e),e.connect(this.gainNode)}}class xC extends IR(Uc){constructor(n,r,i=wd.Oscillator,o="HRTF",s={}){super();G(this,"_oscillatorOptions");G(this,"playbacks",[]);this.context=n,this.globalGainNode=r,this.soundType=i,this.panType=o,this.context=n,this._oscillatorOptions=s}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan??0,o=n.threeDOptions||this.threeDOptions,s=n.volume!==void 0?n.volume:this.volume,a=n.position&&n.position.length?n.position:this.position,l=n.filters&&n.filters.length?n.filters:this._filters,c=n.oscillatorOptions||this._oscillatorOptions,u=new xC(this.context,this.globalGainNode,this.soundType,r,c);return u._volume=s,u._position=a,u._stereoPan=i,u._threeDOptions=o,u.addFilters(l),u}preplay(){const n=this.context.createOscillator();this.oscillatorOptions.detune&&(n.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(n.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(n.type=this.oscillatorOptions.type);const r=this.context.createGain();r.connect(this.globalGainNode);const i=new B4(n,r,this.context,this.panType);return i.volume=this.volume,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(n){this._oscillatorOptions=n,this.playbacks.forEach(r=>{r.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(r.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(r.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(r.source.type=this.oscillatorOptions.type))})}get frequency(){return this.oscillatorOptions.frequency||440}set frequency(n){this._oscillatorOptions.frequency=n,this.playbacks.forEach(r=>r.frequency=n)}get detune(){return this.oscillatorOptions.detune}set detune(n){this._oscillatorOptions.detune=n,this.playbacks.forEach(r=>r.detune=n)}get type(){return this.oscillatorOptions.type||"sine"}set type(n){this._oscillatorOptions.type=n,this.playbacks.forEach(r=>r.type=n)}}var wd=(t=>(t.HTML="HTML",t.Streaming="Streaming",t.Buffer="Buffer",t.Oscillator="oscillator",t))(wd||{});class F4{constructor(e){G(this,"context");G(this,"globalGainNode");G(this,"listener");G(this,"prevVolume",1);G(this,"finalizationRegistry");G(this,"createBiquadFilter",({type:e,frequency:n,gain:r,Q:i})=>{n===void 0&&(n=350);const o=this.context.createBiquadFilter();return o.type=e||"lowpass",o.frequency.value=n,o.gain.value=r||0,o.Q.value=i||1,o});this.context=e||new S4,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.finalizationRegistry=new FinalizationRegistry(n=>{n.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",P4):console.warn("AudioWorklet not supported")}async createWorkletNode(e,n){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new fw(this.context,e)}catch(r){console.error(r),console.log("Loading worklet from url",n);try{await this.context.audioWorklet.addModule(n)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${n}`)}return new fw(this.context,e)}}clearMemoryCache(){pp.clearMemoryCache()}createOscillator(e,n="HRTF"){return new xC(this.context,this.globalGainNode,"oscillator",n,e)}async createSound(e,n="Buffer",r="HRTF"){if(typeof e=="object")return Promise.resolve(new Of("",e,this.context,this.globalGainNode,"Buffer",r));const i=e;if(n==="HTML"){const o=new Audio;return o.src=i,o.crossOrigin="anonymous",new Of(i,void 0,this.context,this.globalGainNode,"HTML",r)}return pp.getAudioBuffer(this.context,i).then(o=>new Of(i,o,this.context,this.globalGainNode,n,r))}async createGroup(e){const n=new pw;return e.forEach(r=>n.addSound(r)),n}async createGroupFromUrls(e,n="Buffer",r="HRTF"){const i=new pw;return(await Promise.all(e.map(o=>this.createSound(o,n,r)))).forEach(o=>i.addSound(o)),i}async createStream(e){return await D4(e,this.context),new Of(e,void 0,this.context,this.globalGainNode,"Streaming")}createPanner({coneInnerAngle:e,coneOuterAngle:n,coneOuterGain:r,distanceModel:i,maxDistance:o,channelCount:s,channelCountMode:a,channelInterpretation:l,panningModel:c,refDistance:u,rolloffFactor:d,positionX:f,positionY:h,positionZ:p,orientationX:g,orientationY:C,orientationZ:m}){const v=this.context.createPanner();return v.coneInnerAngle=e||360,v.coneOuterAngle=n||360,v.coneOuterGain=r||0,v.distanceModel=i||"inverse",v.maxDistance=o||1e4,v.channelCount=s||2,v.channelCountMode=a||"clamped-max",v.channelInterpretation=l||"speakers",v.panningModel=c||"HRTF",v.refDistance=u||1,v.rolloffFactor=d||1,v.positionX.value=f||0,v.positionY.value=h||0,v.positionZ.value=p||0,v.orientationX.value=g||0,v.orientationY.value=C||0,v.orientationZ.value=m||0,v}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new O4(this.context);i.play(),e(i)}).catch(r=>{n(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:n,up:r}=e,[i,o,s]=n,[a,l,c]=r;this.listener.forwardX.value=i,this.listener.forwardY.value=o,this.listener.forwardZ.value=s,this.listener.upX.value=a,this.listener.upY.value=l,this.listener.upZ.value=c}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[n,r,i]=e;this.listener.upX.value=n,this.listener.upY.value=r,this.listener.upZ.value=i}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[n,r,i]=e;this.listener.forwardX.value=n,this.listener.forwardY.value=r,this.listener.forwardZ.value=i}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[n,r,i]=e,o=this.context.currentTime;this.listener.positionX.setValueAtTime(n,o),this.listener.positionY.setValueAtTime(r,o),this.listener.positionZ.setValueAtTime(i,o)}}const U4="https://mongoose.world:9080/?url=";class V4 extends Io{constructor(){super(...arguments);G(this,"packageName","Client.Media");G(this,"sounds",{});G(this,"defaultUrl","")}handleDefault(n){this.defaultUrl=n}async handleLoad(n){const r=(n.url||this.defaultUrl)+n.name,i=n.url+n.name;if(!this.sounds[i]){let s=await this.client.cacophony.createSound(r);s.key=i,this.sounds[i]=s}}mediaUrl(n){var i;let r=(n.url||this.defaultUrl)+n.name;return((i=n.type)==null?void 0:i.toLowerCase())==="music"&&(r=U4+encodeURIComponent(r)),r}async handlePlay(n){let r=this.mediaUrl(n);n.key=n.key||r;let i=this.sounds[n.key];const o=n.is3d?"HRTF":"stereo";if((!i||i.url!==r)&&(n.type==="music"?i=await this.client.cacophony.createSound(r,wd.HTML,o):i=await this.client.cacophony.createSound(r,wd.Buffer,o)),n.volume!==void 0&&(i.volume=n.volume/100),n.loops!==void 0&&i.loop(n.loops),n.start&&i.seek(n.start),n.end&&setTimeout(()=>{delete this.sounds[i.key],i.stop()},n.end),n.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[n.position[0],n.position[1],n.position[2]]),n.priority){for(let s in this.sounds){const a=this.sounds[s];a.priority&&a.priority<n.priority&&a.stop()}i.priority=n.priority}if(!i.isPlaying){const s=i.play()[0];n.fadein&&s.fadeIn(n.fadein),n.fadeout&&s.fadeOut(n.fadeout)}i.key=n.key,this.sounds[i.key]=i}handleStop(n){n.name&&this.soundsByName(n.name).forEach(r=>this.stopSound(r)),n.type&&this.soundsByType(n.type).forEach(r=>this.stopSound(r)),n.tag&&this.soundsByTag(n.tag).forEach(r=>this.stopSound(r)),n.key&&this.soundsByKey(n.key).forEach(r=>this.stopSound(r)),!n.name&&!n.type&&!n.tag&&!n.key&&(this.allSounds.forEach(r=>r.stop()),this.sounds={})}stopSound(n){delete this.sounds[n.key],n.stop()}handleListenerPosition(n){var r;(r=n.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=n.position)}handleListenerOrientation(n){n.up&&n.up.length&&(this.client.cacophony.listenerUpOrientation=n.up),n.forward&&n.forward.length&&(this.client.cacophony.listenerForwardOrientation=n.forward)}soundsByName(n){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(n))}soundsByKey(n){return Object.values(this.sounds).filter(r=>r.key===n)}soundsByTag(n){return Object.values(this.sounds).filter(r=>r.tag===n)}soundsByType(n){return Object.values(this.sounds).filter(r=>r.mediaType===n)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(n=>n.stop()),this.sounds={}}}class G4 extends Io{constructor(){super(...arguments);G(this,"packageName","Client.Speech")}handleSpeak(n){const r=new SpeechSynthesisUtterance(n.text);r.rate=n.rate,r.pitch=n.pitch,r.volume=n.volume,speechSynthesis.speak(r)}}class W4 extends Io{constructor(){super(...arguments);G(this,"packageName","Comm.Channel");G(this,"channels",[])}handleList(n){this.channels=n}sendList(){this.sendData("List")}handleText(n){n.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${n.talker}`,`${n.text}`))}}class j4 extends Io{constructor(){super(...arguments);G(this,"packageName","Comm.LiveKit")}handleroom_token(n){this.client.worldData.liveKitTokens.push(n.token),this.client.emit("livekitToken",n.token)}handleroom_leave(n){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==n.token),this.client.emit("livekitLeave",n.token)}}class Z4 extends Io{constructor(){super(...arguments);G(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}}class H4 extends Io{constructor(){super(...arguments);G(this,"packageName","Core.Supports")}sendSet(){const n=Object.values(this.client.gmcpHandlers).map(r=>r.packageName+" "+r.packageVersion.toString());this.sendData("Set",n)}}class z4 extends Io{constructor(n){super(n);G(this,"packageName","Client.Html")}handleAdd_html(n){this.client.emit("html",n.data.join(`
`))}}const wl=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,kR=new Set,r0=typeof process=="object"&&process?process:{},ER=(t,e,n,r)=>{typeof r0.emitWarning=="function"?r0.emitWarning(t,e,n,r):console.error(`[${n}] ${e}: ${t}`)};let gp=globalThis.AbortController,mw=globalThis.AbortSignal;var FA;if(typeof gp>"u"){mw=class{constructor(){G(this,"onabort");G(this,"_onabort",[]);G(this,"reason");G(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},gp=class{constructor(){G(this,"signal",new mw);e()}abort(r){var i,o;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const s of this.signal._onabort)s(r);(o=(i=this.signal).onabort)==null||o.call(i,r)}}};let t=((FA=r0.env)==null?void 0:FA.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{t&&(t=!1,ER("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const X4=t=>!kR.has(t),Ns=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),TR=t=>Ns(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?dh:null:null;class dh extends Array{constructor(e){super(e),this.fill(0)}}var ac;const Ma=class Ma{constructor(e,n){G(this,"heap");G(this,"length");if(!N(Ma,ac))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(e),this.length=0}static create(e){const n=TR(e);if(!n)return[];Ne(Ma,ac,!0);const r=new Ma(e,n);return Ne(Ma,ac,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};ac=new WeakMap,Ye(Ma,ac,!1);let i0=Ma;var UA,VA,fi,Rr,hi,pi,lc,cc,nn,gi,Qt,wt,Be,Xn,xr,Bn,fn,mi,hn,vi,yi,Pr,Ci,Vs,$n,pe,s0,Wa,Oo,Dd,Nr,RR,ja,uc,Ld,_s,Os,a0,fh,hh,bt,l0,_u,Ms,c0;const pI=class pI{constructor(e){Ye(this,pe);Ye(this,fi);Ye(this,Rr);Ye(this,hi);Ye(this,pi);Ye(this,lc);Ye(this,cc);G(this,"ttl");G(this,"ttlResolution");G(this,"ttlAutopurge");G(this,"updateAgeOnGet");G(this,"updateAgeOnHas");G(this,"allowStale");G(this,"noDisposeOnSet");G(this,"noUpdateTTL");G(this,"maxEntrySize");G(this,"sizeCalculation");G(this,"noDeleteOnFetchRejection");G(this,"noDeleteOnStaleGet");G(this,"allowStaleOnFetchAbort");G(this,"allowStaleOnFetchRejection");G(this,"ignoreFetchAbort");Ye(this,nn);Ye(this,gi);Ye(this,Qt);Ye(this,wt);Ye(this,Be);Ye(this,Xn);Ye(this,xr);Ye(this,Bn);Ye(this,fn);Ye(this,mi);Ye(this,hn);Ye(this,vi);Ye(this,yi);Ye(this,Pr);Ye(this,Ci);Ye(this,Vs);Ye(this,$n);Ye(this,Wa,()=>{});Ye(this,Oo,()=>{});Ye(this,Dd,()=>{});Ye(this,Nr,()=>!1);Ye(this,ja,e=>{});Ye(this,uc,(e,n,r)=>{});Ye(this,Ld,(e,n,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});G(this,UA,"LRUCache");const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:s,updateAgeOnHas:a,allowStale:l,dispose:c,disposeAfter:u,noDisposeOnSet:d,noUpdateTTL:f,maxSize:h=0,maxEntrySize:p=0,sizeCalculation:g,fetchMethod:C,memoMethod:m,noDeleteOnFetchRejection:v,noDeleteOnStaleGet:S,allowStaleOnFetchRejection:E,allowStaleOnFetchAbort:w,ignoreFetchAbort:A}=e;if(n!==0&&!Ns(n))throw new TypeError("max option must be a nonnegative integer");const x=n?TR(n):Array;if(!x)throw new Error("invalid max value: "+n);if(Ne(this,fi,n),Ne(this,Rr,h),this.maxEntrySize=p||N(this,Rr),this.sizeCalculation=g,this.sizeCalculation){if(!N(this,Rr)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(m!==void 0&&typeof m!="function")throw new TypeError("memoMethod must be a function if defined");if(Ne(this,cc,m),C!==void 0&&typeof C!="function")throw new TypeError("fetchMethod must be a function if specified");if(Ne(this,lc,C),Ne(this,Vs,!!C),Ne(this,Qt,new Map),Ne(this,wt,new Array(n).fill(void 0)),Ne(this,Be,new Array(n).fill(void 0)),Ne(this,Xn,new x(n)),Ne(this,xr,new x(n)),Ne(this,Bn,0),Ne(this,fn,0),Ne(this,mi,i0.create(n)),Ne(this,nn,0),Ne(this,gi,0),typeof c=="function"&&Ne(this,hi,c),typeof u=="function"?(Ne(this,pi,u),Ne(this,hn,[])):(Ne(this,pi,void 0),Ne(this,hn,void 0)),Ne(this,Ci,!!N(this,hi)),Ne(this,$n,!!N(this,pi)),this.noDisposeOnSet=!!d,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!v,this.allowStaleOnFetchRejection=!!E,this.allowStaleOnFetchAbort=!!w,this.ignoreFetchAbort=!!A,this.maxEntrySize!==0){if(N(this,Rr)!==0&&!Ns(N(this,Rr)))throw new TypeError("maxSize must be a positive integer if specified");if(!Ns(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");be(this,pe,RR).call(this)}if(this.allowStale=!!l,this.noDeleteOnStaleGet=!!S,this.updateAgeOnGet=!!s,this.updateAgeOnHas=!!a,this.ttlResolution=Ns(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=r||0,this.ttl){if(!Ns(this.ttl))throw new TypeError("ttl must be a positive integer if specified");be(this,pe,s0).call(this)}if(N(this,fi)===0&&this.ttl===0&&N(this,Rr)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!N(this,fi)&&!N(this,Rr)){const T="LRU_CACHE_UNBOUNDED";X4(T)&&(kR.add(T),ER("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",T,pI))}}static unsafeExposeInternals(e){return{starts:N(e,yi),ttls:N(e,Pr),sizes:N(e,vi),keyMap:N(e,Qt),keyList:N(e,wt),valList:N(e,Be),next:N(e,Xn),prev:N(e,xr),get head(){return N(e,Bn)},get tail(){return N(e,fn)},free:N(e,mi),isBackgroundFetch:n=>{var r;return be(r=e,pe,bt).call(r,n)},backgroundFetch:(n,r,i,o)=>{var s;return be(s=e,pe,hh).call(s,n,r,i,o)},moveToTail:n=>{var r;return be(r=e,pe,_u).call(r,n)},indexes:n=>{var r;return be(r=e,pe,_s).call(r,n)},rindexes:n=>{var r;return be(r=e,pe,Os).call(r,n)},isStale:n=>{var r;return N(r=e,Nr).call(r,n)}}}get max(){return N(this,fi)}get maxSize(){return N(this,Rr)}get calculatedSize(){return N(this,gi)}get size(){return N(this,nn)}get fetchMethod(){return N(this,lc)}get memoMethod(){return N(this,cc)}get dispose(){return N(this,hi)}get disposeAfter(){return N(this,pi)}getRemainingTTL(e){return N(this,Qt).has(e)?1/0:0}*entries(){for(const e of be(this,pe,_s).call(this))N(this,Be)[e]!==void 0&&N(this,wt)[e]!==void 0&&!be(this,pe,bt).call(this,N(this,Be)[e])&&(yield[N(this,wt)[e],N(this,Be)[e]])}*rentries(){for(const e of be(this,pe,Os).call(this))N(this,Be)[e]!==void 0&&N(this,wt)[e]!==void 0&&!be(this,pe,bt).call(this,N(this,Be)[e])&&(yield[N(this,wt)[e],N(this,Be)[e]])}*keys(){for(const e of be(this,pe,_s).call(this)){const n=N(this,wt)[e];n!==void 0&&!be(this,pe,bt).call(this,N(this,Be)[e])&&(yield n)}}*rkeys(){for(const e of be(this,pe,Os).call(this)){const n=N(this,wt)[e];n!==void 0&&!be(this,pe,bt).call(this,N(this,Be)[e])&&(yield n)}}*values(){for(const e of be(this,pe,_s).call(this))N(this,Be)[e]!==void 0&&!be(this,pe,bt).call(this,N(this,Be)[e])&&(yield N(this,Be)[e])}*rvalues(){for(const e of be(this,pe,Os).call(this))N(this,Be)[e]!==void 0&&!be(this,pe,bt).call(this,N(this,Be)[e])&&(yield N(this,Be)[e])}[(VA=Symbol.iterator,UA=Symbol.toStringTag,VA)](){return this.entries()}find(e,n={}){for(const r of be(this,pe,_s).call(this)){const i=N(this,Be)[r],o=be(this,pe,bt).call(this,i)?i.__staleWhileFetching:i;if(o!==void 0&&e(o,N(this,wt)[r],this))return this.get(N(this,wt)[r],n)}}forEach(e,n=this){for(const r of be(this,pe,_s).call(this)){const i=N(this,Be)[r],o=be(this,pe,bt).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,N(this,wt)[r],this)}}rforEach(e,n=this){for(const r of be(this,pe,Os).call(this)){const i=N(this,Be)[r],o=be(this,pe,bt).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,N(this,wt)[r],this)}}purgeStale(){let e=!1;for(const n of be(this,pe,Os).call(this,{allowStale:!0}))N(this,Nr).call(this,n)&&(be(this,pe,Ms).call(this,N(this,wt)[n],"expire"),e=!0);return e}info(e){const n=N(this,Qt).get(e);if(n===void 0)return;const r=N(this,Be)[n],i=be(this,pe,bt).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const o={value:i};if(N(this,Pr)&&N(this,yi)){const s=N(this,Pr)[n],a=N(this,yi)[n];if(s&&a){const l=s-(wl.now()-a);o.ttl=l,o.start=Date.now()}}return N(this,vi)&&(o.size=N(this,vi)[n]),o}dump(){const e=[];for(const n of be(this,pe,_s).call(this,{allowStale:!0})){const r=N(this,wt)[n],i=N(this,Be)[n],o=be(this,pe,bt).call(this,i)?i.__staleWhileFetching:i;if(o===void 0||r===void 0)continue;const s={value:o};if(N(this,Pr)&&N(this,yi)){s.ttl=N(this,Pr)[n];const a=wl.now()-N(this,yi)[n];s.start=Math.floor(Date.now()-a)}N(this,vi)&&(s.size=N(this,vi)[n]),e.unshift([r,s])}return e}load(e){this.clear();for(const[n,r]of e){if(r.start){const i=Date.now()-r.start;r.start=wl.now()-i}this.set(n,r.value,r)}}set(e,n,r={}){var f,h,p,g,C;if(n===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:l}=r;let{noUpdateTTL:c=this.noUpdateTTL}=r;const u=N(this,Ld).call(this,e,n,r.size||0,a);if(this.maxEntrySize&&u>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),be(this,pe,Ms).call(this,e,"set"),this;let d=N(this,nn)===0?void 0:N(this,Qt).get(e);if(d===void 0)d=N(this,nn)===0?N(this,fn):N(this,mi).length!==0?N(this,mi).pop():N(this,nn)===N(this,fi)?be(this,pe,fh).call(this,!1):N(this,nn),N(this,wt)[d]=e,N(this,Be)[d]=n,N(this,Qt).set(e,d),N(this,Xn)[N(this,fn)]=d,N(this,xr)[d]=N(this,fn),Ne(this,fn,d),af(this,nn)._++,N(this,uc).call(this,d,u,l),l&&(l.set="add"),c=!1;else{be(this,pe,_u).call(this,d);const m=N(this,Be)[d];if(n!==m){if(N(this,Vs)&&be(this,pe,bt).call(this,m)){m.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:v}=m;v!==void 0&&!s&&(N(this,Ci)&&((f=N(this,hi))==null||f.call(this,v,e,"set")),N(this,$n)&&((h=N(this,hn))==null||h.push([v,e,"set"])))}else s||(N(this,Ci)&&((p=N(this,hi))==null||p.call(this,m,e,"set")),N(this,$n)&&((g=N(this,hn))==null||g.push([m,e,"set"])));if(N(this,ja).call(this,d),N(this,uc).call(this,d,u,l),N(this,Be)[d]=n,l){l.set="replace";const v=m&&be(this,pe,bt).call(this,m)?m.__staleWhileFetching:m;v!==void 0&&(l.oldValue=v)}}else l&&(l.set="update")}if(i!==0&&!N(this,Pr)&&be(this,pe,s0).call(this),N(this,Pr)&&(c||N(this,Dd).call(this,d,i,o),l&&N(this,Oo).call(this,l,d)),!s&&N(this,$n)&&N(this,hn)){const m=N(this,hn);let v;for(;v=m==null?void 0:m.shift();)(C=N(this,pi))==null||C.call(this,...v)}return this}pop(){var e;try{for(;N(this,nn);){const n=N(this,Be)[N(this,Bn)];if(be(this,pe,fh).call(this,!0),be(this,pe,bt).call(this,n)){if(n.__staleWhileFetching)return n.__staleWhileFetching}else if(n!==void 0)return n}}finally{if(N(this,$n)&&N(this,hn)){const n=N(this,hn);let r;for(;r=n==null?void 0:n.shift();)(e=N(this,pi))==null||e.call(this,...r)}}}has(e,n={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=n,o=N(this,Qt).get(e);if(o!==void 0){const s=N(this,Be)[o];if(be(this,pe,bt).call(this,s)&&s.__staleWhileFetching===void 0)return!1;if(N(this,Nr).call(this,o))i&&(i.has="stale",N(this,Oo).call(this,i,o));else return r&&N(this,Wa).call(this,o),i&&(i.has="hit",N(this,Oo).call(this,i,o)),!0}else i&&(i.has="miss");return!1}peek(e,n={}){const{allowStale:r=this.allowStale}=n,i=N(this,Qt).get(e);if(i===void 0||!r&&N(this,Nr).call(this,i))return;const o=N(this,Be)[i];return be(this,pe,bt).call(this,o)?o.__staleWhileFetching:o}async fetch(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:l=0,sizeCalculation:c=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:g,forceRefresh:C=!1,status:m,signal:v}=n;if(!N(this,Vs))return m&&(m.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,status:m});const S={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:l,sizeCalculation:c,noUpdateTTL:u,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:p,ignoreFetchAbort:h,status:m,signal:v};let E=N(this,Qt).get(e);if(E===void 0){m&&(m.fetch="miss");const w=be(this,pe,hh).call(this,e,E,S,g);return w.__returned=w}else{const w=N(this,Be)[E];if(be(this,pe,bt).call(this,w)){const O=r&&w.__staleWhileFetching!==void 0;return m&&(m.fetch="inflight",O&&(m.returnedStale=!0)),O?w.__staleWhileFetching:w.__returned=w}const A=N(this,Nr).call(this,E);if(!C&&!A)return m&&(m.fetch="hit"),be(this,pe,_u).call(this,E),i&&N(this,Wa).call(this,E),m&&N(this,Oo).call(this,m,E),w;const x=be(this,pe,hh).call(this,e,E,S,g),_=x.__staleWhileFetching!==void 0&&r;return m&&(m.fetch=A?"stale":"refresh",_&&A&&(m.returnedStale=!0)),_?x.__staleWhileFetching:x.__returned=x}}async forceFetch(e,n={}){const r=await this.fetch(e,n);if(r===void 0)throw new Error("fetch() returned undefined");return r}memo(e,n={}){const r=N(this,cc);if(!r)throw new Error("no memoMethod provided to constructor");const{context:i,forceRefresh:o,...s}=n,a=this.get(e,s);if(!o&&a!==void 0)return a;const l=r(e,a,{options:s,context:i});return this.set(e,l,s),l}get(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:s}=n,a=N(this,Qt).get(e);if(a!==void 0){const l=N(this,Be)[a],c=be(this,pe,bt).call(this,l);return s&&N(this,Oo).call(this,s,a),N(this,Nr).call(this,a)?(s&&(s.get="stale"),c?(s&&r&&l.__staleWhileFetching!==void 0&&(s.returnedStale=!0),r?l.__staleWhileFetching:void 0):(o||be(this,pe,Ms).call(this,e,"expire"),s&&r&&(s.returnedStale=!0),r?l:void 0)):(s&&(s.get="hit"),c?l.__staleWhileFetching:(be(this,pe,_u).call(this,a),i&&N(this,Wa).call(this,a),l))}else s&&(s.get="miss")}delete(e){return be(this,pe,Ms).call(this,e,"delete")}clear(){return be(this,pe,c0).call(this,"delete")}};fi=new WeakMap,Rr=new WeakMap,hi=new WeakMap,pi=new WeakMap,lc=new WeakMap,cc=new WeakMap,nn=new WeakMap,gi=new WeakMap,Qt=new WeakMap,wt=new WeakMap,Be=new WeakMap,Xn=new WeakMap,xr=new WeakMap,Bn=new WeakMap,fn=new WeakMap,mi=new WeakMap,hn=new WeakMap,vi=new WeakMap,yi=new WeakMap,Pr=new WeakMap,Ci=new WeakMap,Vs=new WeakMap,$n=new WeakMap,pe=new WeakSet,s0=function(){const e=new dh(N(this,fi)),n=new dh(N(this,fi));Ne(this,Pr,e),Ne(this,yi,n),Ne(this,Dd,(o,s,a=wl.now())=>{if(n[o]=s!==0?a:0,e[o]=s,s!==0&&this.ttlAutopurge){const l=setTimeout(()=>{N(this,Nr).call(this,o)&&be(this,pe,Ms).call(this,N(this,wt)[o],"expire")},s+1);l.unref&&l.unref()}}),Ne(this,Wa,o=>{n[o]=e[o]!==0?wl.now():0}),Ne(this,Oo,(o,s)=>{if(e[s]){const a=e[s],l=n[s];if(!a||!l)return;o.ttl=a,o.start=l,o.now=r||i();const c=o.now-l;o.remainingTTL=a-c}});let r=0;const i=()=>{const o=wl.now();if(this.ttlResolution>0){r=o;const s=setTimeout(()=>r=0,this.ttlResolution);s.unref&&s.unref()}return o};this.getRemainingTTL=o=>{const s=N(this,Qt).get(o);if(s===void 0)return 0;const a=e[s],l=n[s];if(!a||!l)return 1/0;const c=(r||i())-l;return a-c},Ne(this,Nr,o=>{const s=n[o],a=e[o];return!!a&&!!s&&(r||i())-s>a})},Wa=new WeakMap,Oo=new WeakMap,Dd=new WeakMap,Nr=new WeakMap,RR=function(){const e=new dh(N(this,fi));Ne(this,gi,0),Ne(this,vi,e),Ne(this,ja,n=>{Ne(this,gi,N(this,gi)-e[n]),e[n]=0}),Ne(this,Ld,(n,r,i,o)=>{if(be(this,pe,bt).call(this,r))return 0;if(!Ns(i))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(i=o(r,n),!Ns(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Ne(this,uc,(n,r,i)=>{if(e[n]=r,N(this,Rr)){const o=N(this,Rr)-e[n];for(;N(this,gi)>o;)be(this,pe,fh).call(this,!0)}Ne(this,gi,N(this,gi)+e[n]),i&&(i.entrySize=r,i.totalCalculatedSize=N(this,gi))})},ja=new WeakMap,uc=new WeakMap,Ld=new WeakMap,_s=function*({allowStale:e=this.allowStale}={}){if(N(this,nn))for(let n=N(this,fn);!(!be(this,pe,a0).call(this,n)||((e||!N(this,Nr).call(this,n))&&(yield n),n===N(this,Bn)));)n=N(this,xr)[n]},Os=function*({allowStale:e=this.allowStale}={}){if(N(this,nn))for(let n=N(this,Bn);!(!be(this,pe,a0).call(this,n)||((e||!N(this,Nr).call(this,n))&&(yield n),n===N(this,fn)));)n=N(this,Xn)[n]},a0=function(e){return e!==void 0&&N(this,Qt).get(N(this,wt)[e])===e},fh=function(e){var o,s;const n=N(this,Bn),r=N(this,wt)[n],i=N(this,Be)[n];return N(this,Vs)&&be(this,pe,bt).call(this,i)?i.__abortController.abort(new Error("evicted")):(N(this,Ci)||N(this,$n))&&(N(this,Ci)&&((o=N(this,hi))==null||o.call(this,i,r,"evict")),N(this,$n)&&((s=N(this,hn))==null||s.push([i,r,"evict"]))),N(this,ja).call(this,n),e&&(N(this,wt)[n]=void 0,N(this,Be)[n]=void 0,N(this,mi).push(n)),N(this,nn)===1?(Ne(this,Bn,Ne(this,fn,0)),N(this,mi).length=0):Ne(this,Bn,N(this,Xn)[n]),N(this,Qt).delete(r),af(this,nn)._--,n},hh=function(e,n,r,i){const o=n===void 0?void 0:N(this,Be)[n];if(be(this,pe,bt).call(this,o))return o;const s=new gp,{signal:a}=r;a==null||a.addEventListener("abort",()=>s.abort(a.reason),{signal:s.signal});const l={signal:s.signal,options:r,context:i},c=(g,C=!1)=>{const{aborted:m}=s.signal,v=r.ignoreFetchAbort&&g!==void 0;if(r.status&&(m&&!C?(r.status.fetchAborted=!0,r.status.fetchError=s.signal.reason,v&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),m&&!v&&!C)return d(s.signal.reason);const S=h;return N(this,Be)[n]===h&&(g===void 0?S.__staleWhileFetching?N(this,Be)[n]=S.__staleWhileFetching:be(this,pe,Ms).call(this,e,"fetch"):(r.status&&(r.status.fetchUpdated=!0),this.set(e,g,l.options))),g},u=g=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=g),d(g)),d=g=>{const{aborted:C}=s.signal,m=C&&r.allowStaleOnFetchAbort,v=m||r.allowStaleOnFetchRejection,S=v||r.noDeleteOnFetchRejection,E=h;if(N(this,Be)[n]===h&&(!S||E.__staleWhileFetching===void 0?be(this,pe,Ms).call(this,e,"fetch"):m||(N(this,Be)[n]=E.__staleWhileFetching)),v)return r.status&&E.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),E.__staleWhileFetching;if(E.__returned===E)throw g},f=(g,C)=>{var v;const m=(v=N(this,lc))==null?void 0:v.call(this,e,o,l);m&&m instanceof Promise&&m.then(S=>g(S===void 0?void 0:S),C),s.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(g(void 0),r.allowStaleOnFetchAbort&&(g=S=>c(S,!0)))})};r.status&&(r.status.fetchDispatched=!0);const h=new Promise(f).then(c,u),p=Object.assign(h,{__abortController:s,__staleWhileFetching:o,__returned:void 0});return n===void 0?(this.set(e,p,{...l.options,status:void 0}),n=N(this,Qt).get(e)):N(this,Be)[n]=p,p},bt=function(e){if(!N(this,Vs))return!1;const n=e;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof gp},l0=function(e,n){N(this,xr)[n]=e,N(this,Xn)[e]=n},_u=function(e){e!==N(this,fn)&&(e===N(this,Bn)?Ne(this,Bn,N(this,Xn)[e]):be(this,pe,l0).call(this,N(this,xr)[e],N(this,Xn)[e]),be(this,pe,l0).call(this,N(this,fn),e),Ne(this,fn,e))},Ms=function(e,n){var i,o,s,a;let r=!1;if(N(this,nn)!==0){const l=N(this,Qt).get(e);if(l!==void 0)if(r=!0,N(this,nn)===1)be(this,pe,c0).call(this,n);else{N(this,ja).call(this,l);const c=N(this,Be)[l];if(be(this,pe,bt).call(this,c)?c.__abortController.abort(new Error("deleted")):(N(this,Ci)||N(this,$n))&&(N(this,Ci)&&((i=N(this,hi))==null||i.call(this,c,e,n)),N(this,$n)&&((o=N(this,hn))==null||o.push([c,e,n]))),N(this,Qt).delete(e),N(this,wt)[l]=void 0,N(this,Be)[l]=void 0,l===N(this,fn))Ne(this,fn,N(this,xr)[l]);else if(l===N(this,Bn))Ne(this,Bn,N(this,Xn)[l]);else{const u=N(this,xr)[l];N(this,Xn)[u]=N(this,Xn)[l];const d=N(this,Xn)[l];N(this,xr)[d]=N(this,xr)[l]}af(this,nn)._--,N(this,mi).push(l)}}if(N(this,$n)&&((s=N(this,hn))!=null&&s.length)){const l=N(this,hn);let c;for(;c=l==null?void 0:l.shift();)(a=N(this,pi))==null||a.call(this,...c)}return r},c0=function(e){var n,r,i;for(const o of be(this,pe,Os).call(this,{allowStale:!0})){const s=N(this,Be)[o];if(be(this,pe,bt).call(this,s))s.__abortController.abort(new Error("deleted"));else{const a=N(this,wt)[o];N(this,Ci)&&((n=N(this,hi))==null||n.call(this,s,a,e)),N(this,$n)&&((r=N(this,hn))==null||r.push([s,a,e]))}}if(N(this,Qt).clear(),N(this,Be).fill(void 0),N(this,wt).fill(void 0),N(this,Pr)&&N(this,yi)&&(N(this,Pr).fill(0),N(this,yi).fill(0)),N(this,vi)&&N(this,vi).fill(0),Ne(this,Bn,0),Ne(this,fn,0),N(this,mi).length=0,Ne(this,gi,0),Ne(this,nn,0),N(this,$n)&&N(this,hn)){const o=N(this,hn);let s;for(;s=o==null?void 0:o.shift();)(i=N(this,pi))==null||i.call(this,...s)}};let o0=pI;function $4(t){const e=t.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+t+"`"),null;const n=e[1],r=e[2],i={},o=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let s;for(;s=o.exec(e[3]);){const a=s[1]||s[3],l=s[2]||s[4];a in i?console.log(`Invalid message format: duplicate key ${a} detected`):i[a]=l}return{name:n,authKey:r,keyvals:i}}function vw(t){const e=t.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+t+"`"),null;const n=e[1]||e[4],r=void 0,i=e[2],o=e[3],s={};return s[i]=o,{name:n,authKey:r,keyvals:s}}function u0(){return(Math.random()+1).toString(36).substring(3,9)}class Vc{constructor(e){G(this,"packageName");G(this,"minVersion",1);G(this,"maxVersion",1);G(this,"packageVersion",0);G(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,n){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,n)}}class K4 extends Vc{constructor(){super(...arguments);G(this,"packageName","mcp-negotiate");G(this,"minVersion",2);G(this,"maxVersion",2)}handle(n){switch(n.name){}}sendNegotiate(){var n,r;for(const i of Object.values(this.client.mcpHandlers)){let o=(n=i.minVersion)==null?void 0:n.toFixed(1),s=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":o,"max-version":s})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class J4 extends Vc{constructor(){super(...arguments);G(this,"packageName","dns-com-awns-status")}handle(n){console.log(n),this.client.emit("statustext",n.keyvals.text)}}class Y4 extends Vc{constructor(n){super(n);G(this,"packageName","dns-org-mud-moo-simpleedit");G(this,"sessions",{});G(this,"clientId");this.clientId=u0()}handle(n){if(n.name==="dns-org-mud-moo-simpleedit-content"){const r={name:n.keyvals.name,reference:n.keyvals.reference,type:n.keyvals.type,contents:[]};this.sessions[n.keyvals["_data-tag"]]=r}else console.log(`Unexpected simpleedit message ${n}`)}handleMultiline(n){"content"in n.keyvals?this.sessions[n.name].contents.push(n.keyvals.content):console.log(`Unexpected simpleedit ML ${n}`)}closeMultiline(n){console.log(`Closing multiline ${n.name}`),this.client.openEditorWindow(this.sessions[n.name])}shutdown(){new BroadcastChannel("editor").postMessage({type:"shutdown"})}}class Q4 extends Vc{constructor(){super(...arguments);G(this,"packageName","dns-com-awns-getset");G(this,"id",1);G(this,"cache",new o0({max:10}));G(this,"LocalCache",{})}handle(n){switch(n.name){case"dns-com-awns-getset-ack":const r=this.cache.get(n.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${n.keyvals.id}`);break}const i=n.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(n){const r=(this.id++).toString();this.cache.set(r,n),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:n})}sendSet(n,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:n,value:r})}sendDrop(n){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:n})}}class q4 extends Vc{constructor(){super(...arguments);G(this,"packageName","dns-com-vmoo-userlist");G(this,"maxVersion",1.1);G(this,"player");G(this,"fields",["Object","Name","Icon"]);G(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);G(this,"players",[])}handle(n){switch(n.name){case"dns-com-vmoo-userlist-you":this.player=n.keyvals.nr;break}}handleMultiline(n){if("fields"in n.keyvals&&(this.fields=li(n.keyvals.fields.trim())),"icons"in n.keyvals&&(this.icons=li(n.keyvals.icons.trim())),"d"in n.keyvals){const o=n.keyvals.d[0];switch(o){case"=":var r=li(n.keyvals.d.slice(1));this.players=r.map(a=>this.playerFromArray(a));break;case"+":this.players.push(this.playerFromArray(li(n.keyvals.d.slice(1))));break;case"-":var i=li(n.keyvals.d.slice(1));this.players=this.players.filter(a=>!i.includes(a.Object));break;case"*":const s=this.playerFromArray(li(n.keyvals.d.slice(1)));this.updatePlayer(s);break;case"<":i=li(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.idle=!0,this.players[l]=a)});break;case">":i=li(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.idle=!1,this.players[l]=a)});break;case"[":i=li(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.away=!0,this.players[l]=a)});break;case"]":i=li(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.away=!1,this.players[l]=a)});break;default:console.log(`Unknown userlist mode ${o} in ${n.keyvals.d}`);break}this.update()}}updatePlayer(n){const r=this.players.findIndex(i=>i.Object===n.Object);r!==-1?this.players[r]=n:this.players.push(n)}update(){this.players.sort((r,i)=>n(i)-n(r)),this.client.emit("userlist",this.players);function n(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(n){const r={};return n.forEach((i,o)=>{r[this.fields[o]]=i}),r.away=!1,r.idle=!1,r}}function li(t){t=t.slice(1,-1);let e=[],n="",r=0;for(let o=0;o<t.length;o++){const s=t[o];if(s==="{")r++;else if(s==="}")r--;else if(s===","&&r===0){i(),n="";continue}n+=s}return n.length>0&&i(),e;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?e.push(li(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?e.push(n.slice(1,-1)):e.push(n):e.push(Number(n))}}class eV extends Vc{constructor(){super(...arguments);G(this,"packageName","dns-com-awns-ping");G(this,"id",1)}handle(n){switch(n.name){case"dns-com-awns-ping":this.send("reply",n.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}var d0=(t=>(t.Off="off",t.Unfocused="unfocused",t.All="all",t))(d0||{}),vs=(t=>(t.SetGeneral="SET_GENERAL",t.SetSpeech="SET_SPEECH",t.SetChannels="SET_CHANNELS",t.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",t.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",t))(vs||{});class tV{constructor(){G(this,"state");G(this,"listeners",new Set);G(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(n=>n())});const e=localStorage.getItem("preferences"),n=this.getInitialPreferences();this.state=e?this.mergePreferences(n,JSON.parse(e)):n}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(e,n){return{...e,general:{...e.general,...n.general},speech:{...e.speech,...n.speech},channels:n.channels?{...e.channels,...n.channels}:e.channels,editor:{...e.editor,...n.editor}}}reducer(e,n){switch(n.type){case"SET_GENERAL":return{...e,general:n.data};case"SET_SPEECH":return{...e,speech:n.data};case"SET_CHANNELS":return{...e,channels:n.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:n.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:n.data}};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const Yl=new tV;class nV extends CT{constructor(n,r){super();G(this,"ws");G(this,"decoder",new TextDecoder("utf8"));G(this,"telnet");G(this,"host");G(this,"port");G(this,"telnetNegotiation",!1);G(this,"telnetBuffer","");G(this,"gmcpHandlers",{});G(this,"mcpHandlers",{});G(this,"mcpMultilines",{});G(this,"mcpAuthKey",null);G(this,"mcp_negotiate");G(this,"mcp_getset");G(this,"gmcp_char");G(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[]});G(this,"cacophony");G(this,"sendCommand",n=>{Yl.getState().general.localEcho&&this.emit("command",n),this.send(n+`\r
`),console.log("> "+n)});this.host=n,this.port=r,this.mcp_negotiate=this.registerMcpPackage(K4),this.mcp_getset=this.registerMcpPackage(Q4),this.gmcp_char=this.registerGMCPPackage(OB),this.cacophony=new F4}registerGMCPPackage(n){const r=new n(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(n){const r=new n(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new RB(new TB(this.ws)),this.ws.onopen=()=>{this.emit("connect")},this.telnet.on("data",n=>{this.handleData(n)}),this.telnet.on("negotiation",(n,r)=>{n===Nu.WILL&&r===Pu.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(Nu.DO,Pu.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):n===Nu.DO&&r===Pu.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(Nu.WILL,Pu.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(n,r)=>{console.log("GMCP Package:",n,r);try{this.handleGmcpData(n,r)}catch(i){console.error("Calling GMCP:",i)}}),this.ws.onclose=()=>{this.emit("disconnect"),this.mcpAuthKey=null,setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=n=>{this.emit("error",n)}}send(n){this.ws.send(n)}close(){this.ws.close()}handleData(n){const r=this.decoder.decode(n).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(n){if(n.startsWith("#$#*")){const i=vw(n.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(n.startsWith("#$#:")){const i=vw(n.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=$4(n.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=u0(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(n,r){const i=n.lastIndexOf("."),o=n.substring(0,i),s=n.substring(i+1);console.log("GMCP Message:",o,s,r);const a=this.gmcpHandlers[o];if(!a){console.log("No handler for GMCP package:",o);return}const l=a["handle"+s];l?(console.log("Calling handler:",l),l.call(a,JSON.parse(r))):console.log("No handler on package:",o,s)}emitMessage(n){const r=Yl.getState().speech.autoreadMode;r===d0.All&&this.speak(n),r===d0.Unfocused&&!document.hasFocus()&&this.speak(n),this.emit("message",n)}sendGmcp(n,r){console.log("Sending GMCP:",n,r),this.telnet.sendGmcp(n,r)}sendMcp(n,r){if(typeof r=="object"){let o="";for(const[s,a]of Object.entries(r))o+=` ${s}: ${a||'""'}`;r=o}const i=`#$#${n} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(n,r,i){this.send(`#$#* ${n} ${r}: ${i}\r
`)}closeMcpML(n){this.send(`#$#: ${n}\r
`)}openEditorWindow(n){console.log(n);const r=new BroadcastChannel("editor"),i=n.reference,o=encodeURIComponent(i),s=window.open(`/editor?reference=${o}`,"_blank");r.onmessage=a=>{console.log("editor window message",a),a.data.id===i&&(a.data.type==="ready"?(console.log("sending editor window session",n),r.postMessage({type:"load",session:n})):a.data.type==="save"?(console.log("saving editor window with session",a.data.session),this.saveEditorWindow(a.data.session)):a.data.type==="close"&&(console.log("closing editor window"),r.close(),r.onmessage=null))},s&&s.focus()}saveEditorWindow(n){const r={reference:n.reference,type:n.type};r["content*"]="",this.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",r,n.contents)}sendMCPMultiline(n,r,i){const o=u0();r["_data-tag"]=o,this.sendMcp(n,r);for(const s of i)this.sendMcpMLLine(o,"content",s);this.closeMcpML(o)}shutdown(){Object.values(this.mcpHandlers).forEach(n=>{n.shutdown()}),Object.values(this.gmcpHandlers).forEach(n=>{n.shutdown()})}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(n,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(n,{body:r})}speak(n){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(NB(n));r.lang="en-US";const{rate:i,pitch:o,voice:s,volume:a}=Yl.getState().speech;r.rate=i,r.pitch=o,r.volume=a;const c=speechSynthesis.getVoices().find(u=>u.name===s);c&&(r.voice=c),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}getInput(){var n;return((n=document.getElementById("command-input"))==null?void 0:n.textContent)||""}setInput(n){const r=document.getElementById("command-input");r&&(r.textContent=n)}}class rV{constructor(){G(this,"history",[]);G(this,"currentIndex",0);G(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&(this.history.push(e.trim()),this.currentIndex=this.history.length),this.unsentInput=""}navigateUp(e){return this.currentIndex===this.history.length&&(this.unsentInput=e),this.history.length>0&&this.currentIndex>0&&this.currentIndex--,this.history.length>0?this.history[Math.max(0,this.currentIndex)]:""}navigateDown(e){return this.currentIndex===this.history.length&&(this.unsentInput=e),this.currentIndex<this.history.length-1?(this.currentIndex++,this.history[this.currentIndex]):(this.currentIndex=this.history.length,this.unsentInput)}getCurrentInput(){return this.currentIndex>=this.history.length?this.unsentInput:this.history[this.currentIndex]}}const iV=({onSend:t,inputRef:e})=>{const[n,r]=b.useState(""),i=b.useRef(new rV),o=s=>{const a=i.current;if(s.key==="Enter"&&!s.shiftKey)s.preventDefault(),t(n),a.addCommand(n),r("");else if(s.key==="ArrowUp"){s.preventDefault();const l=a.navigateUp(n);r(l)}else if(s.key==="ArrowDown"){s.preventDefault();const l=a.navigateDown(n);r(l)}};return Y.jsx("textarea",{value:n,onChange:s=>r(s.target.value),onKeyDown:o,id:"command-input",ref:e,autoFocus:!0})},oV="f589892b641bd434c1f8db636ec3a230f9bc751a",Ia=()=>{const[,t]=b.useReducer(e=>e+1,0);return b.useEffect(()=>Yl.subscribe(t),[]),[Yl.getState(),Yl.dispatch]},sV=()=>{const[t,e]=b.useState([]);return b.useEffect(()=>{const n=()=>{e(window.speechSynthesis.getVoices())};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)},[]),t},aV=({tabs:t})=>{const[e,n]=b.useState(0),r=b.useRef([]);return b.useEffect(()=>{r.current=r.current.slice(0,t.length)},[t]),b.useEffect(()=>{const i=s=>{switch(s.key){case"ArrowLeft":n(a=>a>0?a-1:t.length-1);break;case"ArrowRight":n(a=>a<t.length-1?a+1:0);break}},o=r.current[e];return o==null||o.addEventListener("keydown",i),()=>{o==null||o.removeEventListener("keydown",i)}},[t.length,e]),b.useEffect(()=>{var i;(i=r.current[e])==null||i.focus()},[e]),Y.jsxs("div",{children:[Y.jsx("div",{role:"tablist","aria-label":"Tabs",children:t.map((i,o)=>Y.jsx("button",{ref:s=>r.current[o]=s,role:"tab","aria-selected":e===o,id:`${i.label}-tab`,"aria-controls":`${i.label}-panel`,onClick:()=>n(o),tabIndex:e===o?void 0:-1,children:i.label},o))}),t.map((i,o)=>Y.jsx("div",{role:"tabpanel",id:`${i.label}-panel`,"aria-labelledby":`${i.label}-tab`,hidden:e!==o,tabIndex:e===o?0:-1,children:i.content},o))]})},lV=()=>{const[t,e]=Ia();return Y.jsxs("label",{children:[Y.jsx("input",{type:"checkbox",checked:t.general.localEcho,onChange:n=>e({type:vs.SetGeneral,data:{...t.general,localEcho:n.target.checked}})}),"Local Echo"]})},cV=()=>{const[t,e]=Ia();return Y.jsxs("label",{children:["Auto Read:",Y.jsxs("select",{value:t.speech.autoreadMode,onChange:n=>e({type:vs.SetSpeech,data:{...t.speech,autoreadMode:n.target.value}}),children:[Y.jsx("option",{value:"off",children:"Off"}),Y.jsx("option",{value:"unfocused",children:"Unfocused"}),Y.jsx("option",{value:"all",children:"Always"})]})]})},uV=()=>{const[t,e]=Ia(),n=sV();return Y.jsxs("label",{children:["Voice:",Y.jsx("select",{value:t.speech.voice,onChange:r=>e({type:vs.SetSpeech,data:{...t.speech,voice:r.target.value}}),children:n.map(r=>Y.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},dV=()=>{const[t,e]=Ia();return Y.jsxs("label",{children:["Rate (0.1 - 10.0):",Y.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:t.speech.rate,onChange:n=>e({type:vs.SetSpeech,data:{...t.speech,rate:parseFloat(n.target.value)}})})]})},fV=()=>{const[t,e]=Ia();return Y.jsxs("label",{children:["Pitch (0 - 2):",Y.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:t.speech.pitch,onChange:n=>e({type:vs.SetSpeech,data:{...t.speech,pitch:parseFloat(n.target.value)}})})]})},hV=()=>{const[t,e]=Ia();return Y.jsxs("label",{children:["Volume (0 - 1):",Y.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:t.speech.volume,onChange:n=>e({type:vs.SetSpeech,data:{...t.speech,volume:parseFloat(n.target.value)}})})]})},pV=()=>Y.jsxs("div",{children:[Y.jsx(cV,{}),Y.jsx("br",{}),Y.jsx(uV,{}),Y.jsx("br",{}),Y.jsx(dV,{}),Y.jsx("br",{}),Y.jsx(fV,{}),Y.jsx("br",{}),Y.jsx(hV,{}),Y.jsx("br",{})]}),gV=()=>{const[t,e]=Ia(),n=t.editor,r=o=>{e({type:vs.SetEditorAutocompleteEnabled,data:o.target.checked})},i=o=>{e({type:vs.SetEditorAccessibilityMode,data:o.target.checked})};return Y.jsxs("div",{children:[Y.jsxs("label",{children:[Y.jsx("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),Y.jsx("br",{}),Y.jsxs("label",{children:[Y.jsx("input",{type:"checkbox",checked:n.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),Y.jsx("br",{})]})},mV=()=>{const t=[{label:"General",content:Y.jsx(lV,{})},{label:"Speech",content:Y.jsx(pV,{})},{label:"Editor",content:Y.jsx(gV,{})}];return Y.jsx(aV,{tabs:t})};function vV(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.includes(r))continue;n[r]=t[r]}return n}function Ad(){return Ad=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ad.apply(null,arguments)}var f0="data-focus-lock",xR="data-focus-lock-disabled",yV="data-no-focus-lock",CV="data-autofocus-inside",IV="data-no-autofocus";function hm(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function SV(t,e){var n=b.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var bV=typeof window<"u"?b.useLayoutEffect:b.useEffect,yw=new WeakMap;function wV(t,e){var n=SV(null,function(r){return t.forEach(function(i){return hm(i,r)})});return bV(function(){var r=yw.get(n);if(r){var i=new Set(r),o=new Set(t),s=n.current;i.forEach(function(a){o.has(a)||hm(a,null)}),o.forEach(function(a){i.has(a)||hm(a,s)})}yw.set(n,t)},[t]),n}var pm={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},h0=function(t,e){return h0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},h0(t,e)};function Gc(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");h0(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var p0=function(){return p0=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},p0.apply(this,arguments)};function AV(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function PR(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Sc(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function g0(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function m0(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function Ql(t){return this instanceof Ql?(this.v=t,this):new Ql(t)}function kV(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(h){return function(p){return Promise.resolve(p).then(h,d)}}function a(h,p){r[h]&&(i[h]=function(g){return new Promise(function(C,m){o.push([h,g,C,m])>1||l(h,g)})},p&&(i[h]=p(i[h])))}function l(h,p){try{c(r[h](p))}catch(g){f(o[0][3],g)}}function c(h){h.value instanceof Ql?Promise.resolve(h.value.v).then(u,d):f(o[0][2],h)}function u(h){l("next",h)}function d(h){l("throw",h)}function f(h,p){h(p),o.shift(),o.length&&l(o[0][0],o[0][1])}}function EV(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Sc=="function"?Sc(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){s=t[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}function NR(t){return t}function _R(t,e){e===void 0&&(e=NR);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(o){var s=e(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var l=function(){var u=s;s=[],u.forEach(o)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),n}}}};return i}function PC(t,e){return e===void 0&&(e=NR),_R(t,e)}function TV(t){t===void 0&&(t={});var e=_R(null);return e.options=p0({async:!0,ssr:!1},t),e}var OR=PC({},function(t){var e=t.target,n=t.currentTarget;return{target:e,currentTarget:n}}),MR=PC(),RV=PC(),xV=TV({async:!0,ssr:typeof document<"u"}),PV=b.createContext(void 0),NV=[],NC=b.forwardRef(function(e,n){var r,i=b.useState(),o=i[0],s=i[1],a=b.useRef(),l=b.useRef(!1),c=b.useRef(null),u=b.useState({}),d=u[1],f=e.children,h=e.disabled,p=h===void 0?!1:h,g=e.noFocusGuards,C=g===void 0?!1:g,m=e.persistentFocus,v=m===void 0?!1:m,S=e.crossFrame,E=S===void 0?!0:S,w=e.autoFocus,A=w===void 0?!0:w;e.allowTextSelection;var x=e.group,T=e.className,_=e.whiteList,O=e.hasPositiveIndices,L=e.shards,U=L===void 0?NV:L,z=e.as,Z=z===void 0?"div":z,K=e.lockProps,ee=K===void 0?{}:K,re=e.sideCar,X=e.returnFocus,J=X===void 0?!1:X,oe=e.focusOptions,W=e.onActivation,se=e.onDeactivation,we=b.useState({}),De=we[0],de=b.useCallback(function(ve){var Ge=ve.captureFocusRestore;if(!c.current){var We,Oe=(We=document)==null?void 0:We.activeElement;c.current=Oe,Oe!==document.body&&(c.current=Ge(Oe))}a.current&&W&&W(a.current),l.current=!0,d()},[W]),xe=b.useCallback(function(){l.current=!1,se&&se(a.current),d()},[se]),rt=b.useCallback(function(ve){var Ge=c.current;if(Ge){var We=(typeof Ge=="function"?Ge():Ge)||document.body,Oe=typeof J=="function"?J(We):J;if(Oe){var Je=typeof Oe=="object"?Oe:void 0;c.current=null,ve?Promise.resolve().then(function(){return We.focus(Je)}):We.focus(Je)}}},[J]),Ce=b.useCallback(function(ve){l.current&&OR.useMedium(ve)},[]),tn=MR.useMedium,vn=b.useCallback(function(ve){a.current!==ve&&(a.current=ve,s(ve))},[]),Zn=Ad((r={},r[xR]=p&&"disabled",r[f0]=x,r),ee),$e=C!==!0,Zt=$e&&C!=="tail",Jt=wV([n,vn]),he=b.useMemo(function(){return{observed:a,shards:U,enabled:!p,active:l.current}},[p,l.current,U,o]);return b.createElement(b.Fragment,null,$e&&[b.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:p?-1:0,style:pm}),O?b.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:p?-1:1,style:pm}):null],!p&&b.createElement(re,{id:De,sideCar:xV,observed:o,disabled:p,persistentFocus:v,crossFrame:E,autoFocus:A,whiteList:_,shards:U,onActivation:de,onDeactivation:xe,returnFocus:rt,focusOptions:oe}),b.createElement(Z,Ad({ref:Jt},Zn,{className:T,onBlur:tn,onFocus:Ce}),b.createElement(PV.Provider,{value:he},f)),Zt&&b.createElement("div",{"data-focus-guard":!0,tabIndex:p?-1:0,style:pm}))});NC.propTypes={};function v0(t,e){return v0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},v0(t,e)}function _V(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,v0(t,e)}function kd(t){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kd(t)}function OV(t,e){if(kd(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(kd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MV(t){var e=OV(t,"string");return kd(e)=="symbol"?e:e+""}function DV(t,e,n){return(e=MV(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LV(t,e){function n(r){return r.displayName||r.name||"Component"}return function(i){var o=[],s;function a(){s=t(o.map(function(c){return c.props})),e(s)}var l=function(c){_V(u,c);function u(){return c.apply(this,arguments)||this}u.peek=function(){return s};var d=u.prototype;return d.componentDidMount=function(){o.push(this),a()},d.componentDidUpdate=function(){a()},d.componentWillUnmount=function(){var h=o.indexOf(this);o.splice(h,1),a()},d.render=function(){return dt.createElement(i,this.props)},u}(b.PureComponent);return DV(l,"displayName","SideEffect("+n(i)+")"),l}}var Ao=function(t){for(var e=Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e},rl=function(t){return Array.isArray(t)?t:[t]},DR=function(t){return Array.isArray(t)?t[0]:t},BV=function(t){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(t,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},LR=function(t){return t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.host:t.parentNode},BR=function(t){return t===document||t&&t.nodeType===Node.DOCUMENT_NODE},FV=function(t){return t.hasAttribute("inert")},UV=function(t,e){return!t||BR(t)||!BV(t)&&!FV(t)&&e(LR(t))},FR=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=UV(e,FR.bind(void 0,t));return t.set(e,r),r},VV=function(t,e){return t&&!BR(t)?jV(t)?e(LR(t)):!1:!0},UR=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=VV(e,UR.bind(void 0,t));return t.set(e,r),r},VR=function(t){return t.dataset},GV=function(t){return t.tagName==="BUTTON"},GR=function(t){return t.tagName==="INPUT"},WR=function(t){return GR(t)&&t.type==="radio"},WV=function(t){return!((GR(t)||GV(t))&&(t.type==="hidden"||t.disabled))},jV=function(t){var e=t.getAttribute(IV);return![!0,"true",""].includes(e)},_C=function(t){var e;return!!(t&&(!((e=VR(t))===null||e===void 0)&&e.focusGuard))},y0=function(t){return!_C(t)},ZV=function(t){return!!t},HV=function(t,e){var n=Math.max(0,t.tabIndex),r=Math.max(0,e.tabIndex),i=n-r,o=t.index-e.index;if(i){if(!n)return 1;if(!r)return-1}return i||o},zV=function(t){return t.tabIndex<0&&!t.hasAttribute("tabindex")?0:t.tabIndex},OC=function(t,e,n){return Ao(t).map(function(r,i){var o=zV(r);return{node:r,index:i,tabIndex:n&&o===-1?(r.dataset||{}).focusGuard?0:-1:o}}).filter(function(r){return!e||r.tabIndex>=0}).sort(HV)},XV=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],MC=XV.join(","),$V="".concat(MC,", [data-focus-guard]"),jR=function(t,e){return Ao((t.shadowRoot||t).children).reduce(function(n,r){return n.concat(r.matches(e?$V:MC)?[r]:[],jR(r))},[])},KV=function(t,e){var n;return t instanceof HTMLIFrameElement&&(!((n=t.contentDocument)===null||n===void 0)&&n.body)?bc([t.contentDocument.body],e):[t]},bc=function(t,e){return t.reduce(function(n,r){var i,o=jR(r,e),s=(i=[]).concat.apply(i,o.map(function(a){return KV(a,e)}));return n.concat(s,r.parentNode?Ao(r.parentNode.querySelectorAll(MC)).filter(function(a){return a===r}):[])},[])},JV=function(t){var e=t.querySelectorAll("[".concat(CV,"]"));return Ao(e).map(function(n){return bc([n])}).reduce(function(n,r){return n.concat(r)},[])},DC=function(t,e){return Ao(t).filter(function(n){return FR(e,n)}).filter(function(n){return WV(n)})},Cw=function(t,e){return e===void 0&&(e=new Map),Ao(t).filter(function(n){return UR(e,n)})},LC=function(t,e,n){return OC(DC(bc(t,n),e),!0,n)},mp=function(t,e){return OC(DC(bc(t),e),!1)},YV=function(t,e){return DC(JV(t),e)},Xa=function(t,e){return t.shadowRoot?Xa(t.shadowRoot,e):Object.getPrototypeOf(t).contains!==void 0&&Object.getPrototypeOf(t).contains.call(t,e)?!0:Ao(t.children).some(function(n){var r;if(n instanceof HTMLIFrameElement){var i=(r=n.contentDocument)===null||r===void 0?void 0:r.body;return i?Xa(i,e):!1}return Xa(n,e)})},QV=function(t){for(var e=new Set,n=t.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var o=t[r].compareDocumentPosition(t[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return t.filter(function(s,a){return!e.has(a)})},ZR=function(t){return t.parentNode?ZR(t.parentNode):t},BC=function(t){var e=rl(t);return e.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(f0);return n.push.apply(n,i?QV(Ao(ZR(r).querySelectorAll("[".concat(f0,'="').concat(i,'"]:not([').concat(xR,'="disabled"])')))):[r]),n},[])},qV=function(t){try{return t()}catch{return}},Ed=function(t){if(t===void 0&&(t=document),!(!t||!t.activeElement)){var e=t.activeElement;return e.shadowRoot?Ed(e.shadowRoot):e instanceof HTMLIFrameElement&&qV(function(){return e.contentWindow.document})?Ed(e.contentWindow.document):e}},eG=function(t,e){return t===e},tG=function(t,e){return!!Ao(t.querySelectorAll("iframe")).some(function(n){return eG(n,e)})},HR=function(t,e){return e===void 0&&(e=Ed(DR(t).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:BC(t).some(function(n){return Xa(n,e)||tG(n,e)})},nG=function(t){t===void 0&&(t=document);var e=Ed(t);return e?Ao(t.querySelectorAll("[".concat(yV,"]"))).some(function(n){return Xa(n,e)}):!1},rG=function(t,e){return e.filter(WR).filter(function(n){return n.name===t.name}).filter(function(n){return n.checked})[0]||t},FC=function(t,e){return WR(t)&&t.name?rG(t,e):t},iG=function(t){var e=new Set;return t.forEach(function(n){return e.add(FC(n,t))}),t.filter(function(n){return e.has(n)})},Iw=function(t){return t[0]&&t.length>1?FC(t[0],t):t[0]},Sw=function(t,e){return t.indexOf(FC(e,t))},C0="NEW_FOCUS",oG=function(t,e,n,r,i){var o=t.length,s=t[0],a=t[o-1],l=_C(r);if(!(r&&t.indexOf(r)>=0)){var c=r!==void 0?n.indexOf(r):-1,u=i?n.indexOf(i):c,d=i?t.indexOf(i):-1;if(c===-1)return d!==-1?d:C0;if(d===-1)return C0;var f=c-u,h=n.indexOf(s),p=n.indexOf(a),g=iG(n),C=r!==void 0?g.indexOf(r):-1,m=C-(i?g.indexOf(i):c);if(!f&&d>=0||e.length===0)return d;var v=Sw(t,e[0]),S=Sw(t,e[e.length-1]);if(c<=h&&l&&Math.abs(f)>1)return S;if(c>=p&&l&&Math.abs(f)>1)return v;if(f&&Math.abs(m)>1)return d;if(c<=h)return S;if(c>p)return v;if(f)return Math.abs(f)>1?d:(o+d+f)%o}},sG=function(t){return function(e){var n,r=(n=VR(e))===null||n===void 0?void 0:n.autofocus;return e.autofocus||r!==void 0&&r!=="false"||t.indexOf(e)>=0}},bw=function(t,e,n){var r=t.map(function(o){var s=o.node;return s}),i=Cw(r.filter(sG(n)));return i&&i.length?Iw(i):Iw(Cw(e))},I0=function(t,e){return e===void 0&&(e=[]),e.push(t),t.parentNode&&I0(t.parentNode.host||t.parentNode,e),e},gm=function(t,e){for(var n=I0(t),r=I0(e),i=0;i<n.length;i+=1){var o=n[i];if(r.indexOf(o)>=0)return o}return!1},zR=function(t,e,n){var r=rl(t),i=rl(e),o=r[0],s=!1;return i.filter(Boolean).forEach(function(a){s=gm(s||a,a)||s,n.filter(Boolean).forEach(function(l){var c=gm(o,l);c&&(!s||Xa(c,s)?s=c:s=gm(c,s))})}),s},ww=function(t,e){return t.reduce(function(n,r){return n.concat(YV(r,e))},[])},aG=function(t,e){var n=new Map;return e.forEach(function(r){return n.set(r.node,r)}),t.map(function(r){return n.get(r)}).filter(ZV)},lG=function(t,e){var n=Ed(rl(t).length>0?document:DR(t).ownerDocument),r=BC(t).filter(y0),i=zR(n||t,t,r),o=new Map,s=mp(r,o),a=s.filter(function(p){var g=p.node;return y0(g)});if(a[0]){var l=mp([i],o).map(function(p){var g=p.node;return g}),c=aG(l,a),u=c.map(function(p){var g=p.node;return g}),d=c.filter(function(p){var g=p.tabIndex;return g>=0}).map(function(p){var g=p.node;return g}),f=oG(u,d,l,n,e);if(f===C0){var h=bw(s,d,ww(r,o))||bw(s,u,ww(r,o));if(h)return{node:h};console.warn("focus-lock: cannot find any node to move focus into");return}return f===void 0?f:c[f]}},cG=function(t){var e=BC(t).filter(y0),n=zR(t,t,e),r=OC(bc([n],!0),!0,!0),i=bc(e,!1);return r.map(function(o){var s=o.node,a=o.index;return{node:s,index:a,lockItem:i.indexOf(s)>=0,guard:_C(s)}})},UC=function(t,e){t&&("focus"in t&&t.focus(e),"contentWindow"in t&&t.contentWindow&&t.contentWindow.focus())},mm=0,vm=!1,XR=function(t,e,n){n===void 0&&(n={});var r=lG(t,e);if(!vm&&r){if(mm>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),vm=!0,setTimeout(function(){vm=!1},1);return}mm++,UC(r.node,n.focusOptions),mm--}};function pu(t){if(!t)return null;if(typeof WeakRef>"u")return function(){return t||null};var e=t?new WeakRef(t):null;return function(){return(e==null?void 0:e.deref())||null}}var uG=function(t){if(!t)return null;for(var e=[],n=t;n&&n!==document.body;)e.push({current:pu(n),parent:pu(n.parentElement),left:pu(n.previousElementSibling),right:pu(n.nextElementSibling)}),n=n.parentElement;return{element:pu(t),stack:e,ownerDocument:t.ownerDocument}},dG=function(t){var e,n,r,i,o;if(t)for(var s=t.stack,a=t.ownerDocument,l=new Map,c=0,u=s;c<u.length;c++){var d=u[c],f=(e=d.parent)===null||e===void 0?void 0:e.call(d);if(f&&a.contains(f)){for(var h=(n=d.left)===null||n===void 0?void 0:n.call(d),p=d.current(),g=f.contains(p)?p:void 0,C=(r=d.right)===null||r===void 0?void 0:r.call(d),m=LC([f],l),v=(o=(i=g??(h==null?void 0:h.nextElementSibling))!==null&&i!==void 0?i:C)!==null&&o!==void 0?o:h;v;){for(var S=0,E=m;S<E.length;S++){var w=E[S];if(v!=null&&v.contains(w.node))return w.node}v=v.nextElementSibling}if(m.length)return m[0].node}}},fG=function(t){var e=uG(t);return function(){return dG(e)}},hG=function(t,e,n){if(!t||!e)return console.error("no element or scope given"),{};var r=rl(e);if(r.every(function(s){return!Xa(s,t)}))return console.error("Active element is not contained in the scope"),{};var i=n?LC(r,new Map):mp(r,new Map),o=i.findIndex(function(s){var a=s.node;return a===t});if(o!==-1)return{prev:i[o-1],next:i[o+1],first:i[0],last:i[i.length-1]}},pG=function(t,e){var n=e?LC(rl(t),new Map):mp(rl(t),new Map);return{first:n[0],last:n[n.length-1]}},gG=function(t){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},t)},$R=function(t,e,n){e===void 0&&(e={});var r=gG(e),i=hG(t,r.scope,r.onlyTabbable);if(i){var o=n(i,r.cycle);o&&UC(o.node,r.focusOptions)}},mG=function(t,e){e===void 0&&(e={}),$R(t,e,function(n,r){var i=n.next,o=n.first;return i||r&&o})},vG=function(t,e){e===void 0&&(e={}),$R(t,e,function(n,r){var i=n.prev,o=n.last;return i||r&&o})},KR=function(t,e,n){var r,i=pG(t,(r=e.onlyTabbable)!==null&&r!==void 0?r:!0),o=i[n];o&&UC(o.node,e.focusOptions)},yG=function(t,e){e===void 0&&(e={}),KR(t,e,"first")},CG=function(t,e){e===void 0&&(e={}),KR(t,e,"last")};function VC(t){setTimeout(t,1)}var IG=function(e){return e&&"current"in e?e.current:e},SG=function(){return document&&document.activeElement===document.body},bG=function(){return SG()||nG()},ql=null,Wl=null,ec=null,Td=!1,wG=function(){return!0},AG=function(e){return(ql.whiteList||wG)(e)},kG=function(e,n){ec={observerNode:e,portaledElement:n}},EG=function(e){return ec&&ec.portaledElement===e};function Aw(t,e,n,r){var i=null,o=t;do{var s=r[o];if(s.guard)s.node.dataset.focusAutoGuard&&(i=s);else if(s.lockItem){if(o!==t)return;i=null}else break}while((o+=n)!==e);i&&(i.node.tabIndex=0)}var TG=function(e){return e?!!Td:Td==="meanwhile"},RG=function t(e,n,r){return n&&(n.host===e&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&t(e,n.parentNode,r))},xG=function(e,n){return n.some(function(r){return RG(e,r,r)})},vp=function(){var e=!1;if(ql){var n=ql,r=n.observed,i=n.persistentFocus,o=n.autoFocus,s=n.shards,a=n.crossFrame,l=n.focusOptions,c=r||ec&&ec.portaledElement,u=document&&document.activeElement;if(c){var d=[c].concat(s.map(IG).filter(Boolean));if((!u||AG(u))&&(i||TG(a)||!bG()||!Wl&&o)&&(c&&!(HR(d)||u&&xG(u,d)||EG(u))&&(document&&!Wl&&u&&!o?(u.blur&&u.blur(),document.body.focus()):(e=XR(d,Wl,{focusOptions:l}),ec={})),Td=!1,Wl=document&&document.activeElement),document&&u!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var f=document&&document.activeElement,h=cG(d),p=h.map(function(g){var C=g.node;return C}).indexOf(f);p>-1&&(h.filter(function(g){var C=g.guard,m=g.node;return C&&m.dataset.focusAutoGuard}).forEach(function(g){var C=g.node;return C.removeAttribute("tabIndex")}),Aw(p,h.length,1,h),Aw(p,-1,-1,h))}}}return e},JR=function(e){vp()&&e&&(e.stopPropagation(),e.preventDefault())},GC=function(){return VC(vp)},PG=function(e){var n=e.target,r=e.currentTarget;r.contains(n)||kG(r,n)},NG=function(){return null},YR=function(){Td="just",VC(function(){Td="meanwhile"})},_G=function(){document.addEventListener("focusin",JR),document.addEventListener("focusout",GC),window.addEventListener("blur",YR)},OG=function(){document.removeEventListener("focusin",JR),document.removeEventListener("focusout",GC),window.removeEventListener("blur",YR)};function MG(t){return t.filter(function(e){var n=e.disabled;return!n})}var QR={moveFocusInside:XR,focusInside:HR,focusNextElement:mG,focusPrevElement:vG,focusFirstElement:yG,focusLastElement:CG,captureFocusRestore:fG};function DG(t){var e=t.slice(-1)[0];e&&!ql&&_G();var n=ql,r=n&&e&&e.id===n.id;ql=e,n&&!r&&(n.onDeactivation(),t.filter(function(i){var o=i.id;return o===n.id}).length||n.returnFocus(!e)),e?(Wl=null,(!r||n.observed!==e.observed)&&e.onActivation(QR),vp(),VC(vp)):(OG(),Wl=null)}OR.assignSyncMedium(PG);MR.assignMedium(GC);RV.assignMedium(function(t){return t(QR)});const LG=LV(MG,DG)(NG);var qR=b.forwardRef(function(e,n){return b.createElement(NC,Ad({sideCar:LG,ref:n},e))}),ex=NC.propTypes||{};ex.sideCar;vV(ex,["sideCar"]);qR.propTypes={};const BG=dt.forwardRef((t,e)=>{const[n,r]=b.useState(!1),i=b.useRef(null);return dt.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),b.useEffect(()=>{var o;n&&((o=i.current)==null||o.focus())},[n]),b.useEffect(()=>{const o=s=>{s.key==="Escape"&&r(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]),Y.jsx(qR,{disabled:!n,children:Y.jsxs("dialog",{className:"preferences-dialog",open:n,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[Y.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),n&&Y.jsx(mV,{}),Y.jsx("button",{onClick:()=>r(!1),children:"Close"}),Y.jsx("br",{}),Y.jsxs("span",{id:"commit-hash",children:["Version: ",oV]})]})})});var tx={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},kw=dt.createContext&&dt.createContext(tx),FG=["attr","size","title"];function UG(t,e){if(t==null)return{};var n=VG(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function VG(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function yp(){return yp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yp.apply(this,arguments)}function Ew(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Cp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ew(Object(n),!0).forEach(function(r){GG(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ew(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function GG(t,e,n){return e=WG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WG(t){var e=jG(t,"string");return typeof e=="symbol"?e:e+""}function jG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nx(t){return t&&t.map((e,n)=>dt.createElement(e.tag,Cp({key:n},e.attr),nx(e.child)))}function gl(t){return e=>dt.createElement(ZG,yp({attr:Cp({},t.attr)},e),nx(t.child))}function ZG(t){var e=n=>{var{attr:r,size:i,title:o}=t,s=UG(t,FG),a=i||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),dt.createElement("svg",yp({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:l,style:Cp(Cp({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&dt.createElement("title",null,o),t.children)};return kw!==void 0?dt.createElement(kw.Consumer,null,n=>e(n)):e(tx)}function HG(t){return gl({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(t)}function zG(t){return gl({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(t)}function XG(t){return gl({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"},child:[]}]})(t)}function rx(t){return gl({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(t)}function $G(t){return gl({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(t)}function KG(t){return gl({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(t)}function JG(t){return gl({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(t)}const YG=({client:t,onClearLog:e,onSaveLog:n,onToggleUsers:r,onOpenPrefs:i})=>{const[o,s]=dt.useState(t.cacophony.muted);return Y.jsxs("div",{className:"toolbar",children:[Y.jsxs("button",{onClick:n,accessKey:"l",children:[Y.jsx(rx,{}),"Save Log"]}),Y.jsxs("button",{onClick:e,accessKey:"c",children:[Y.jsx(XG,{}),"Clear Log"]}),Y.jsxs("button",{onClick:i,accessKey:"p",children:[Y.jsx(HG,{}),"Preferences"]}),Y.jsxs("button",{onClick:()=>{s(!o),t.cacophony.muted=!o},accessKey:"m",children:[o?Y.jsx(JG,{}):Y.jsx(KG,{}),o?"Unmute":"Mute"]}),Y.jsxs("label",{children:["Volume",Y.jsx("input",{type:"range",min:"0",max:"100",onChange:a=>t.cacophony.setGlobalVolume(Number(a.target.value)/100)})]}),Y.jsx("button",{onClick:r,accessKey:"u",children:"Show/Hide Users"}),Y.jsxs("label",{children:["Volume",Y.jsx("input",{type:"range",min:"0",max:"100",onChange:a=>t.cacophony.setGlobalVolume(Number(a.target.value)/100)})]})]})};class QG extends dt.Component{constructor(e){super(e),this.state={statusText:"Not connected"},e.client.on("statustext",n=>this.setState({statusText:n})),e.client.on("connect",()=>this.setState({statusText:"Connected"})),e.client.on("disconnect",()=>this.setState({statusText:"Disconnected"}))}render(){return Y.jsx("div",{className:"statusbar",children:this.state.statusText})}}const qG=({users:t})=>Y.jsxs("div",{className:"sidebar",children:[Y.jsx("div",{className:"sidebar-header",role:"heading","aria-level":2,children:"Connected Players"}),Y.jsx("div",{className:"sidebar-content",children:Y.jsx("ul",{children:t.map(e=>{let n="";return e.away&&(n+=" away"),e.idle&&(n+=" idle"),Y.jsx("li",{className:n,children:e.Name},e.Object)})})})]});var Tw={};function eW(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var tW=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nW(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ix={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(tW,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function o(g,C){var m=g[C];if(typeof m.bind=="function")return m.bind(g);try{return Function.prototype.bind.call(m,g)}catch{return function(){return Function.prototype.apply.apply(m,[g,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?s:console[g]!==void 0?o(console,g):console.log!==void 0?o(console,"log"):e}function l(g,C){for(var m=0;m<i.length;m++){var v=i[m];this[v]=m<g?e:this.methodFactory(v,g,C)}this.log=this.debug}function c(g,C,m){return function(){typeof console!==n&&(l.call(this,C,m),this[g].apply(this,arguments))}}function u(g,C,m){return a(g)||c.apply(this,arguments)}function d(g,C,m){var v=this,S;C=C??"WARN";var E="loglevel";typeof g=="string"?E+=":"+g:typeof g=="symbol"&&(E=void 0);function w(_){var O=(i[_]||"silent").toUpperCase();if(!(typeof window===n||!E)){try{window.localStorage[E]=O;return}catch{}try{window.document.cookie=encodeURIComponent(E)+"="+O+";"}catch{}}}function A(){var _;if(!(typeof window===n||!E)){try{_=window.localStorage[E]}catch{}if(typeof _===n)try{var O=window.document.cookie,L=O.indexOf(encodeURIComponent(E)+"=");L!==-1&&(_=/^([^;]+)/.exec(O.slice(L))[1])}catch{}return v.levels[_]===void 0&&(_=void 0),_}}function x(){if(!(typeof window===n||!E)){try{window.localStorage.removeItem(E);return}catch{}try{window.document.cookie=encodeURIComponent(E)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}v.name=g,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=m||u,v.getLevel=function(){return S},v.setLevel=function(_,O){if(typeof _=="string"&&v.levels[_.toUpperCase()]!==void 0&&(_=v.levels[_.toUpperCase()]),typeof _=="number"&&_>=0&&_<=v.levels.SILENT){if(S=_,O!==!1&&w(_),l.call(v,_,g),typeof console===n&&_<v.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+_},v.setDefaultLevel=function(_){C=_,A()||v.setLevel(_,!1)},v.resetLevel=function(){v.setLevel(C,!1),x()},v.enableAll=function(_){v.setLevel(v.levels.TRACE,_)},v.disableAll=function(_){v.setLevel(v.levels.SILENT,_)};var T=A();T==null&&(T=C),v.setLevel(T,!1)}var f=new d,h={};f.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var m=h[C];return m||(m=h[C]=new d(C,f.getLevel(),f.methodFactory)),m};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(ix);var WC=ix.exports,S0;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(S0||(S0={}));var yo;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(yo||(yo={}));let Xe=WC.getLogger("livekit");Xe.setDefaultLevel(S0.info);function ys(t){const e=WC.getLogger(t);return e.setDefaultLevel(Xe.getLevel()),e}WC.getLogger("lk-e2ee");function gr(t,e){if(!t)throw new Error(e)}const rW=34028234663852886e22,iW=-34028234663852886e22,oW=4294967295,sW=2147483647,aW=-2147483648;function ph(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>sW||t<aW)throw new Error("invalid int 32: "+t)}function b0(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>oW||t<0)throw new Error("invalid uint 32: "+t)}function ox(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>rW||t<iW))throw new Error("invalid float 32: "+t)}const sx=Symbol("@bufbuild/protobuf/enum-type");function lW(t){const e=t[sx];return gr(e,"missing enum type on enum object"),e}function ax(t,e,n,r){t[sx]=lx(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function lx(t,e,n){const r=Object.create(null),i=Object.create(null),o=[];for(const s of e){const a=cx(s);o.push(a),r[s.name]=a,i[s.no]=a}return{typeName:t,values:o,findName(s){return r[s]},findNumber(s){return i[s]}}}function cW(t,e,n){const r={};for(const i of e){const o=cx(i);r[o.localName]=o.no,r[o.no]=o.localName}return ax(r,t,e),r}function cx(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class Se{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,o=i.makeReadOptions(n);return i.readMessage(this,o.readerFactory(e),e.byteLength,o),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,o=i.makeReadOptions(n);return i.readMessage(r,e,o,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),o=i.writerFactory();return r.writeMessage(this,o,i),o.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function uW(t,e,n,r){var i;const o=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),s={[o]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[o];return Object.setPrototypeOf(s.prototype,new Se),Object.assign(s,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,l){return new s().fromBinary(a,l)},fromJson(a,l){return new s().fromJson(a,l)},fromJsonString(a,l){return new s().fromJsonString(a,l)},equals(a,l){return t.util.equals(s,a,l)}}),s}function dW(t,e,n,r){return{syntax:t,json:e,bin:n,util:r,makeMessageType(i,o,s){return uW(this,i,o,s)},makeEnum:cW,makeEnumType:lx,getEnumType:lW}}var te;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(te||(te={}));var il;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(il||(il={}));function fW(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function ym(t,e,n){for(let o=0;o<28;o=o+7){const s=t>>>o,a=!(!(s>>>7)&&e==0),l=(a?s|128:s)&255;if(n.push(l),!a)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let o=3;o<31;o=o+7){const s=e>>>o,a=!!(s>>>7),l=(a?s|128:s)&255;if(n.push(l),!a)return}n.push(e>>>31&1)}}const gh=4294967296;function Rw(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function o(s,a){const l=Number(t.slice(s,a));i*=n,r=r*n+l,r>=gh&&(i=i+(r/gh|0),r=r%gh)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),e?dx(r,i):jC(r,i)}function hW(t,e){let n=jC(t,e);const r=n.hi&2147483648;r&&(n=dx(n.lo,n.hi));const i=ux(n.lo,n.hi);return r?"-"+i:i}function ux(t,e){if({lo:t,hi:e}=pW(t,e),e<=2097151)return String(gh*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let o=n+r*6777216+i*6710656,s=r+i*8147497,a=i*2;const l=1e7;return o>=l&&(s+=Math.floor(o/l),o%=l),s>=l&&(a+=Math.floor(s/l),s%=l),a.toString()+xw(s)+xw(o)}function pW(t,e){return{lo:t>>>0,hi:e>>>0}}function jC(t,e){return{lo:t|0,hi:e|0}}function dx(t,e){return e=~e,t?t=~t+1:e+=1,jC(t,e)}const xw=t=>{const e=String(t);return"0000000".slice(e.length)+e};function Pw(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function gW(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function mW(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof Tw!="object"||Tw.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(l){const c=typeof l=="bigint"?l:BigInt(l);if(c>o||c<i)throw new Error("int64 invalid: ".concat(l));return c},uParse(l){const c=typeof l=="bigint"?l:BigInt(l);if(c>a||c<s)throw new Error("uint64 invalid: ".concat(l));return c},enc(l){return t.setBigInt64(0,this.parse(l),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(l){return t.setBigInt64(0,this.uParse(l),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(l,c){return t.setInt32(0,l,!0),t.setInt32(4,c,!0),t.getBigInt64(0,!0)},uDec(l,c){return t.setInt32(0,l,!0),t.setInt32(4,c,!0),t.getBigUint64(0,!0)}}}const n=i=>gr(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>gr(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),Rw(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),Rw(i)},dec(i,o){return hW(i,o)},uDec(i,o){return ux(i,o)}}}const Ue=mW();var zt;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(zt||(zt={}));class vW{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(b0(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return ph(e),Pw(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){ox(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){b0(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){ph(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return ph(e),e=(e<<1^e>>31)>>>0,Pw(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Ue.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Ue.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=Ue.enc(e);return ym(n.lo,n.hi,this.buf),this}sint64(e){let n=Ue.enc(e),r=n.hi>>31,i=n.lo<<1^r,o=(n.hi<<1|n.lo>>>31)^r;return ym(i,o,this.buf),this}uint64(e){let n=Ue.uEnc(e);return ym(n.lo,n.hi,this.buf),this}}class yW{constructor(e,n){this.varint64=fW,this.uint32=gW,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e){let n=this.pos;switch(e){case zt.Varint:for(;this.buf[this.pos++]&128;);break;case zt.Bit64:this.pos+=4;case zt.Bit32:this.pos+=4;break;case zt.LengthDelimited:let r=this.uint32();this.pos+=r;break;case zt.StartGroup:let i;for(;(i=this.tag()[1])!==zt.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Ue.dec(...this.varint64())}uint64(){return Ue.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,Ue.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ue.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ue.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function w0(t,e){return e instanceof Se||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}te.DOUBLE,te.FLOAT,te.INT64,te.UINT64,te.INT32,te.UINT32,te.BOOL,te.STRING,te.BYTES;function Ts(t,e,n){if(e===n)return!0;if(t==te.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return e==n}return!1}function A0(t,e){switch(t){case te.BOOL:return!1;case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return e==0?Ue.zero:"0";case te.DOUBLE:case te.FLOAT:return 0;case te.BYTES:return new Uint8Array(0);case te.STRING:return"";default:return 0}}function fx(t,e){const n=e===void 0;let r=zt.Varint,i=e===0;switch(t){case te.STRING:i=n||!e.length,r=zt.LengthDelimited;break;case te.BOOL:i=e===!1;break;case te.DOUBLE:r=zt.Bit64;break;case te.FLOAT:r=zt.Bit32;break;case te.INT64:i=n||e==0;break;case te.UINT64:i=n||e==0;break;case te.FIXED64:i=n||e==0,r=zt.Bit64;break;case te.BYTES:i=n||!e.byteLength,r=zt.LengthDelimited;break;case te.FIXED32:r=zt.Bit32;break;case te.SFIXED32:r=zt.Bit32;break;case te.SFIXED64:i=n||e==0,r=zt.Bit64;break;case te.SINT64:i=n||e==0;break}const o=te[t].toLowerCase();return[r,o,n||i]}const Al=Symbol("@bufbuild/protobuf/unknown-fields"),Nw={readUnknownFields:!0,readerFactory:t=>new yW(t)},_w={writeUnknownFields:!0,writerFactory:()=>new vW};function CW(t){return t?Object.assign(Object.assign({},Nw),t):Nw}function IW(t){return t?Object.assign(Object.assign({},_w),t):_w}function SW(){return{makeReadOptions:CW,makeWriteOptions:IW,listUnknownFields(t){var e;return(e=t[Al])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[Al]},writeUnknownFields(t,e){const r=t[Al];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[Al])||(i[Al]=[]),i[Al].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r){const i=t.getType(),o=n===void 0?e.len:e.pos+n;for(;e.pos<o;){const[s,a]=e.tag(),l=i.fields.find(s);if(!l){const f=e.skip(a);r.readUnknownFields&&this.onUnknownField(t,s,a,f);continue}let c=t,u=l.repeated,d=l.localName;switch(l.oneof&&(c=c[l.oneof.localName],c.case!=d&&delete c.value,c.case=d,d="value"),l.kind){case"scalar":case"enum":const f=l.kind=="enum"?te.INT32:l.T;let h=Ip;if(l.kind=="scalar"&&l.L>0&&(h=wW),u){let m=c[d];if(a==zt.LengthDelimited&&f!=te.STRING&&f!=te.BYTES){let v=e.uint32()+e.pos;for(;e.pos<v;)m.push(h(e,f))}else m.push(h(e,f))}else c[d]=h(e,f);break;case"message":const p=l.T;u?c[d].push(mh(e,new p,r)):c[d]instanceof Se?mh(e,c[d],r):(c[d]=mh(e,new p,r),p.fieldWrapper&&!l.oneof&&!l.repeated&&(c[d]=p.fieldWrapper.unwrapField(c[d])));break;case"map":let[g,C]=bW(l,e,r);c[d][g]=C;break}}}}}function mh(t,e,n){return e.getType().runtime.bin.readMessage(e,t,t.uint32(),n),e}function bW(t,e,n){const r=e.uint32(),i=e.pos+r;let o,s;for(;e.pos<i;){let[a]=e.tag();switch(a){case 1:o=Ip(e,t.K);break;case 2:switch(t.V.kind){case"scalar":s=Ip(e,t.V.T);break;case"enum":s=e.int32();break;case"message":s=mh(e,new t.V.T,n);break}break}}if(o===void 0){let a=A0(t.K,il.BIGINT);o=t.K==te.BOOL?a.toString():a}if(typeof o!="string"&&typeof o!="number"&&(o=o.toString()),s===void 0)switch(t.V.kind){case"scalar":s=A0(t.V.T,il.BIGINT);break;case"enum":s=0;break;case"message":s=new t.V.T;break}return[o,s]}function wW(t,e){const n=Ip(t,e);return typeof n=="bigint"?n.toString():n}function Ip(t,e){switch(e){case te.STRING:return t.string();case te.BOOL:return t.bool();case te.DOUBLE:return t.double();case te.FLOAT:return t.float();case te.INT32:return t.int32();case te.INT64:return t.int64();case te.UINT64:return t.uint64();case te.FIXED64:return t.fixed64();case te.BYTES:return t.bytes();case te.FIXED32:return t.fixed32();case te.SFIXED32:return t.sfixed32();case te.SFIXED64:return t.sfixed64();case te.SINT64:return t.sint64();case te.UINT32:return t.uint32();case te.SINT32:return t.sint32()}}function AW(t,e,n,r,i){t.tag(n.no,zt.LengthDelimited),t.fork();let o=r;switch(n.K){case te.INT32:case te.FIXED32:case te.UINT32:case te.SFIXED32:case te.SINT32:o=Number.parseInt(r);break;case te.BOOL:gr(r=="true"||r=="false"),o=r=="true";break}switch(Xu(t,n.K,1,o,!0),n.V.kind){case"scalar":Xu(t,n.V.T,2,i,!0);break;case"enum":Xu(t,te.INT32,2,i,!0);break;case"message":k0(t,e,n.V.T,2,i);break}t.join()}function k0(t,e,n,r,i){if(i!==void 0){const o=w0(n,i);t.tag(r,zt.LengthDelimited).bytes(o.toBinary(e))}}function Xu(t,e,n,r,i){let[o,s,a]=fx(e,r);(!a||i)&&t.tag(n,o)[s](r)}function kW(t,e,n,r){if(!r.length)return;t.tag(n,zt.LengthDelimited).fork();let[,i]=fx(e);for(let o=0;o<r.length;o++)t[i](r[o]);t.join()}function EW(){return Object.assign(Object.assign({},SW()),{writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){let o,s=i.repeated,a=i.localName;if(i.oneof){const l=t[i.oneof.localName];if(l.case!==a)continue;o=l.value}else o=t[a];switch(i.kind){case"scalar":case"enum":let l=i.kind=="enum"?te.INT32:i.T;if(s)if(i.packed)kW(e,l,i.no,o);else for(const c of o)Xu(e,l,i.no,c,!0);else o!==void 0&&Xu(e,l,i.no,o,!!i.oneof||i.opt);break;case"message":if(s)for(const c of o)k0(e,n,i.T,i.no,c);else k0(e,n,i.T,i.no,o);break;case"map":for(const[c,u]of Object.entries(o))AW(e,n,i,c,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}let Mo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),sg=[];for(let t=0;t<Mo.length;t++)sg[Mo[t].charCodeAt(0)]=t;sg[45]=Mo.indexOf("+");sg[95]=Mo.indexOf("/");const hx={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,o,s=0;for(let a=0;a<t.length;a++){if(o=sg[t.charCodeAt(a)],o===void 0)switch(t[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:s=o,i=1;break;case 1:n[r++]=s<<2|(o&48)>>4,s=o,i=2;break;case 2:n[r++]=(s&15)<<4|(o&60)>>2,s=o,i=3;break;case 3:n[r++]=(s&3)<<6|o,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let o=0;o<t.length;o++)switch(r=t[o],n){case 0:e+=Mo[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=Mo[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=Mo[i|r>>6],e+=Mo[r&63],n=0;break}return n&&(e+=Mo[i],e+="=",n==1&&(e+="=")),e}},Ow={ignoreUnknownFields:!1},Mw={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function TW(t){return t?Object.assign(Object.assign({},Ow),t):Ow}function RW(t){return t?Object.assign(Object.assign({},Mw),t):Mw}function xW(t){const e=t(PW,Dw);return{makeReadOptions:TW,makeWriteOptions:RW,readMessage(n,r,i,o){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(r)));o=o??new n;const s={};for(const[a,l]of Object.entries(r)){const c=n.fields.findJsonName(a);if(!c){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let u=c.localName,d=o;if(c.oneof){if(l===null&&c.kind=="scalar")continue;const f=s[c.oneof.localName];if(f)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(c.oneof.name,'" present: "').concat(f,'", "').concat(a,'"'));s[c.oneof.localName]=a,d=d[c.oneof.localName]={case:u},u="value"}if(c.repeated){if(l===null)continue;if(!Array.isArray(l))throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l)));const f=d[u];for(const h of l){if(h===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(h)));let p;switch(c.kind){case"message":p=c.T.fromJson(h,i);break;case"enum":if(p=Cm(c.T,h,i.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=gu(c.T,h,c.L)}catch(g){let C="cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(h));throw g instanceof Error&&g.message.length>0&&(C+=": ".concat(g.message)),new Error(C)}break}f.push(p)}}else if(c.kind=="map"){if(l===null)continue;if(Array.isArray(l)||typeof l!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l)));const f=d[u];for(const[h,p]of Object.entries(l)){if(p===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: map value null"));let g;switch(c.V.kind){case"message":g=c.V.T.fromJson(p,i);break;case"enum":if(g=Cm(c.V.T,p,i.ignoreUnknownFields),g===void 0)continue;break;case"scalar":try{g=gu(c.V.T,p,il.BIGINT)}catch(C){let m="cannot decode map value for field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw C instanceof Error&&C.message.length>0&&(m+=": ".concat(C.message)),new Error(m)}break}try{f[gu(c.K,c.K==te.BOOL?h=="true"?!0:h=="false"?!1:h:h,il.BIGINT).toString()]=g}catch(C){let m="cannot decode map key for field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw C instanceof Error&&C.message.length>0&&(m+=": ".concat(C.message)),new Error(m)}}}else switch(c.kind){case"message":const f=c.T;if(l===null&&f.typeName!="google.protobuf.Value"){if(c.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}d[u]instanceof Se?d[u].fromJson(l,i):(d[u]=f.fromJson(l,i),f.fieldWrapper&&!c.oneof&&(d[u]=f.fieldWrapper.unwrapField(d[u])));break;case"enum":const h=Cm(c.T,l,i.ignoreUnknownFields);h!==void 0&&(d[u]=h);break;case"scalar":try{d[u]=gu(c.T,l,c.L)}catch(p){let g="cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw p instanceof Error&&p.message.length>0&&(g+=": ".concat(p.message)),new Error(g)}break}}return o},writeMessage(n,r){const i=n.getType(),o={};let s;try{for(const a of i.fields.byMember()){let l;if(a.kind=="oneof"){const c=n[a.localName];if(c.value===void 0)continue;if(s=a.findField(c.case),!s)throw"oneof case not found: "+c.case;l=e(s,c.value,r)}else s=a,l=e(s,n[s.localName],r);l!==void 0&&(o[r.useProtoFieldName?s.name:s.jsonName]=l)}}catch(a){const l=s?"cannot encode field ".concat(i.typeName,".").concat(s.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),c=a instanceof Error?a.message:String(a);throw new Error(l+(c.length>0?": ".concat(c):""))}return o},readScalar:gu,writeScalar:Dw,debug:px}}function px(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function gu(t,e,n){switch(t){case te.DOUBLE:case te.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==te.FLOAT&&ox(r),r;case te.INT32:case te.FIXED32:case te.SFIXED32:case te.SINT32:case te.UINT32:if(e===null)return 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return t==te.UINT32?b0(i):ph(i),i;case te.INT64:case te.SFIXED64:case te.SINT64:if(e===null)return Ue.zero;if(typeof e!="number"&&typeof e!="string")break;const o=Ue.parse(e);return n?o.toString():o;case te.FIXED64:case te.UINT64:if(e===null)return Ue.zero;if(typeof e!="number"&&typeof e!="string")break;const s=Ue.uParse(e);return n?s.toString():s;case te.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case te.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case te.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return hx.dec(e)}throw new Error}function Cm(t,e,n){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=t.findName(e);if(r||n)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(px(e)))}function PW(t,e,n,r){var i;if(e===void 0)return e;if(e===0&&!n)return;if(r)return e;if(t.typeName=="google.protobuf.NullValue")return null;const o=t.findNumber(e);return(i=o==null?void 0:o.name)!==null&&i!==void 0?i:e}function Dw(t,e,n){if(e!==void 0)switch(t){case te.INT32:case te.SFIXED32:case te.SINT32:case te.FIXED32:case te.UINT32:return gr(typeof e=="number"),e!=0||n?e:void 0;case te.FLOAT:case te.DOUBLE:return gr(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case te.STRING:return gr(typeof e=="string"),e.length>0||n?e:void 0;case te.BOOL:return gr(typeof e=="boolean"),e||n?e:void 0;case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return gr(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case te.BYTES:return gr(e instanceof Uint8Array),n||e.byteLength>0?hx.enc(e):void 0}}function NW(){return xW((t,e)=>function(r,i,o){if(r.kind=="map"){const s={};switch(r.V.kind){case"scalar":for(const[l,c]of Object.entries(i)){const u=e(r.V.T,c,!0);gr(u!==void 0),s[l.toString()]=u}break;case"message":for(const[l,c]of Object.entries(i))s[l.toString()]=c.toJson(o);break;case"enum":const a=r.V.T;for(const[l,c]of Object.entries(i)){gr(c===void 0||typeof c=="number");const u=t(a,c,!0,o.enumAsInteger);gr(u!==void 0),s[l.toString()]=u}break}return o.emitDefaultValues||Object.keys(s).length>0?s:void 0}else if(r.repeated){const s=[];switch(r.kind){case"scalar":for(let a=0;a<i.length;a++)s.push(e(r.T,i[a],!0));break;case"enum":for(let a=0;a<i.length;a++)s.push(t(r.T,i[a],!0,o.enumAsInteger));break;case"message":for(let a=0;a<i.length;a++)s.push(w0(r.T,i[a]).toJson(o));break}return o.emitDefaultValues||s.length>0?s:void 0}else switch(r.kind){case"scalar":return e(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues);case"enum":return t(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues,o.enumAsInteger);case"message":return i!==void 0?w0(r.T,i).toJson(o):void 0}})}function _W(){return{setEnumType:ax,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,o=e,s=t;if(s[i]!==void 0)switch(r.kind){case"oneof":const a=s[i].case;if(a===void 0)continue;const l=r.findField(a);let c=s[i].value;l&&l.kind=="message"&&!(c instanceof l.T)?c=new l.T(c):l&&l.kind==="scalar"&&l.T===te.BYTES&&(c=mu(c)),o[i]={case:a,value:c};break;case"scalar":case"enum":let u=s[i];r.T===te.BYTES&&(u=r.repeated?u.map(mu):mu(u)),o[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===te.BYTES)for(const[h,p]of Object.entries(s[i]))o[i][h]=mu(p);else Object.assign(o[i],s[i]);break;case"message":const f=r.V.T;for(const h of Object.keys(s[i])){let p=s[i][h];f.fieldWrapper||(p=new f(p)),o[i][h]=p}break}break;case"message":const d=r.T;if(r.repeated)o[i]=s[i].map(f=>f instanceof d?f:new d(f));else if(s[i]!==void 0){const f=s[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?o[i]=mu(f):o[i]=f:o[i]=f instanceof d?f:new d(f)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],o=n[r.localName];if(r.repeated){if(i.length!==o.length)return!1;switch(r.kind){case"message":return i.every((s,a)=>r.T.equals(s,o[a]));case"scalar":return i.every((s,a)=>Ts(r.T,s,o[a]));case"enum":return i.every((s,a)=>Ts(te.INT32,s,o[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,o);case"enum":return Ts(te.INT32,i,o);case"scalar":return Ts(r.T,i,o);case"oneof":if(i.case!==o.case)return!1;const s=r.findField(i.case);if(s===void 0)return!0;switch(s.kind){case"message":return s.T.equals(i.value,o.value);case"enum":return Ts(te.INT32,i.value,o.value);case"scalar":return Ts(s.T,i.value,o.value)}throw new Error("oneof cannot contain ".concat(s.kind));case"map":const a=Object.keys(i).concat(Object.keys(o));switch(r.V.kind){case"message":const l=r.V.T;return a.every(u=>l.equals(i[u],o[u]));case"enum":return a.every(u=>Ts(te.INT32,i[u],o[u]));case"scalar":const c=r.V.T;return a.every(u=>Ts(c,i[u],o[u]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const o=t[i.localName];let s;if(i.repeated)s=o.map(Mf);else if(i.kind=="map"){s=r[i.localName];for(const[a,l]of Object.entries(o))s[a]=Mf(l)}else i.kind=="oneof"?s=i.findField(o.case)?{case:o.case,value:Mf(o.value)}:{case:void 0}:s=Mf(o);r[i.localName]=s}return n}}}function Mf(t){if(t===void 0)return t;if(t instanceof Se)return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function mu(t){return t instanceof Uint8Array?t:new Uint8Array(t)}class OW{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function gx(t,e){const n=mx(t);return e?n:UW(FW(n))}function MW(t){return gx(t,!1)}const DW=mx;function mx(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const LW=new Set(["constructor","toString","toJSON","valueOf"]),BW=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),vx=t=>"".concat(t,"$"),FW=t=>BW.has(t)?vx(t):t,UW=t=>LW.has(t)?vx(t):t;class VW{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=MW(e)}addField(e){gr(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}const R=dW("proto3",NW(),EW(),Object.assign(Object.assign({},_W()),{newFieldList(t){return new OW(t,GW)},initFields(t){for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=A0(e.T,e.L);break}}}}));function GW(t){var e,n,r,i;const o=[];let s;for(const a of typeof t=="function"?t():t){const l=a;if(l.localName=gx(a.name,a.oneof!==void 0),l.jsonName=(e=a.jsonName)!==null&&e!==void 0?e:DW(a.name),l.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(l.L=(r=a.L)!==null&&r!==void 0?r:il.BIGINT),l.packed=(i=a.packed)!==null&&i!==void 0?i:a.kind=="enum"||a.kind=="scalar"&&a.T!=te.BYTES&&a.T!=te.STRING,a.oneof!==void 0){const c=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!s||s.name!=c)&&(s=new VW(c)),l.oneof=s,s.addField(l)}o.push(l)}return o}class gn extends Se{constructor(e){super(),this.seconds=Ue.zero,this.nanos=0,R.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(R.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ue.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return gn.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new gn({seconds:Ue.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new gn().fromBinary(e,n)}static fromJson(e,n){return new gn().fromJson(e,n)}static fromJsonString(e,n){return new gn().fromJsonString(e,n)}static equals(e,n){return R.util.equals(gn,e,n)}}gn.runtime=R;gn.typeName="google.protobuf.Timestamp";gn.fields=R.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var E0;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC"})(E0||(E0={}));R.util.setEnumType(E0,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var T0;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8"})(T0||(T0={}));R.util.setEnumType(T0,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var R0;(function(t){t[t.IC_DEFAULT=0]="IC_DEFAULT",t[t.IC_JPEG=1]="IC_JPEG"})(R0||(R0={}));R.util.setEnumType(R0,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var Un;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA"})(Un||(Un={}));R.util.setEnumType(Un,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var Xt;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(Xt||(Xt={}));R.util.setEnumType(Xt,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var cn;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF"})(cn||(cn={}));R.util.setEnumType(cn,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var Bo;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.LOST=3]="LOST"})(Bo||(Bo={}));R.util.setEnumType(Bo,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var Li;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED"})(Li||(Li={}));R.util.setEnumType(Li,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var cs;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE"})(cs||(cs={}));R.util.setEnumType(cs,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var No;(function(t){t[t.RR_UNKNOWN=0]="RR_UNKNOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(No||(No={}));R.util.setEnumType(No,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var Rd;(function(t){t[t.SE_UNKNOWN=0]="SE_UNKNOWN",t[t.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",t[t.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(Rd||(Rd={}));R.util.setEnumType(Rd,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let Wc=class Ou extends Se{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=Ue.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Ou().fromBinary(e,n)}static fromJson(e,n){return new Ou().fromJson(e,n)}static fromJsonString(e,n){return new Ou().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ou,e,n)}};Wc.runtime=R;Wc.typeName="livekit.Room";Wc.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Ai,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class Ai extends Se{constructor(e){super(),this.mime="",this.fmtpLine="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Ai().fromBinary(e,n)}static fromJson(e,n){return new Ai().fromJson(e,n)}static fromJsonString(e,n){return new Ai().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ai,e,n)}}Ai.runtime=R;Ai.typeName="livekit.Codec";Ai.fields=R.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class Hs extends Se{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new Hs().fromBinary(e,n)}static fromJson(e,n){return new Hs().fromJson(e,n)}static fromJsonString(e,n){return new Hs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Hs,e,n)}}Hs.runtime=R;Hs.typeName="livekit.PlayoutDelay";Hs.fields=R.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class Fo extends Se{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Fo().fromBinary(e,n)}static fromJson(e,n){return new Fo().fromJson(e,n)}static fromJsonString(e,n){return new Fo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Fo,e,n)}}Fo.runtime=R;Fo.typeName="livekit.ParticipantPermission";Fo.fields=R.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:R.getEnumType(Xt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class Vr extends Se{constructor(e){super(),this.sid="",this.identity="",this.state=ol.JOINING,this.tracks=[],this.metadata="",this.joinedAt=Ue.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Vr().fromBinary(e,n)}static fromJson(e,n){return new Vr().fromJson(e,n)}static fromJsonString(e,n){return new Vr().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Vr,e,n)}}Vr.runtime=R;Vr.typeName="livekit.ParticipantInfo";Vr.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:R.getEnumType(ol)},{no:4,name:"tracks",kind:"message",T:vr,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:Fo},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var ol;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED"})(ol||(ol={}));R.util.setEnumType(ol,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class zs extends Se{constructor(e){super(),R.util.initPartial(e,this)}static fromBinary(e,n){return new zs().fromBinary(e,n)}static fromJson(e,n){return new zs().fromJson(e,n)}static fromJsonString(e,n){return new zs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(zs,e,n)}}zs.runtime=R;zs.typeName="livekit.Encryption";zs.fields=R.util.newFieldList(()=>[]);var wn;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM"})(wn||(wn={}));R.util.setEnumType(wn,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class Uo extends Se{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Uo().fromBinary(e,n)}static fromJson(e,n){return new Uo().fromJson(e,n)}static fromJsonString(e,n){return new Uo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Uo,e,n)}}Uo.runtime=R;Uo.typeName="livekit.SimulcastCodecInfo";Uo.fields=R.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:tr,repeated:!0}]);class vr extends Se{constructor(e){super(),this.sid="",this.type=Un.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=Xt.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=wn.NONE,this.stream="",R.util.initPartial(e,this)}static fromBinary(e,n){return new vr().fromBinary(e,n)}static fromJson(e,n){return new vr().fromJson(e,n)}static fromJsonString(e,n){return new vr().fromJsonString(e,n)}static equals(e,n){return R.util.equals(vr,e,n)}}vr.runtime=R;vr.typeName="livekit.TrackInfo";vr.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:R.getEnumType(Un)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:R.getEnumType(Xt)},{no:10,name:"layers",kind:"message",T:tr,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Uo,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:R.getEnumType(wn)},{no:17,name:"stream",kind:"scalar",T:9}]);class tr extends Se{constructor(e){super(),this.quality=cn.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new tr().fromBinary(e,n)}static fromJson(e,n){return new tr().fromJson(e,n)}static fromJsonString(e,n){return new tr().fromJsonString(e,n)}static equals(e,n){return R.util.equals(tr,e,n)}}tr.runtime=R;tr.typeName="livekit.VideoLayer";tr.fields=R.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:R.getEnumType(cn)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class Yi extends Se{constructor(e){super(),this.kind=on.RELIABLE,this.value={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new Yi().fromBinary(e,n)}static fromJson(e,n){return new Yi().fromJson(e,n)}static fromJsonString(e,n){return new Yi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Yi,e,n)}}Yi.runtime=R;Yi.typeName="livekit.DataPacket";Yi.fields=R.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:R.getEnumType(on)},{no:2,name:"user",kind:"message",T:qi,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Vo,oneof:"value"}]);var on;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY"})(on||(on={}));R.util.setEnumType(on,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class Vo extends Se{constructor(e){super(),this.speakers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Vo().fromBinary(e,n)}static fromJson(e,n){return new Vo().fromJson(e,n)}static fromJsonString(e,n){return new Vo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Vo,e,n)}}Vo.runtime=R;Vo.typeName="livekit.ActiveSpeakerUpdate";Vo.fields=R.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Qi,repeated:!0}]);class Qi extends Se{constructor(e){super(),this.sid="",this.level=0,this.active=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Qi().fromBinary(e,n)}static fromJson(e,n){return new Qi().fromJson(e,n)}static fromJsonString(e,n){return new Qi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Qi,e,n)}}Qi.runtime=R;Qi.typeName="livekit.SpeakerInfo";Qi.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class qi extends Se{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new qi().fromBinary(e,n)}static fromJson(e,n){return new qi().fromJson(e,n)}static fromJsonString(e,n){return new qi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(qi,e,n)}}qi.runtime=R;qi.typeName="livekit.UserPacket";qi.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class eo extends Se{constructor(e){super(),this.participantSid="",this.trackSids=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new eo().fromBinary(e,n)}static fromJson(e,n){return new eo().fromJson(e,n)}static fromJsonString(e,n){return new eo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(eo,e,n)}}eo.runtime=R;eo.typeName="livekit.ParticipantTracks";eo.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class Go extends Se{constructor(e){super(),this.edition=wc.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Go().fromBinary(e,n)}static fromJson(e,n){return new Go().fromJson(e,n)}static fromJsonString(e,n){return new Go().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Go,e,n)}}Go.runtime=R;Go.typeName="livekit.ServerInfo";Go.fields=R.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:R.getEnumType(wc)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var wc;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud"})(wc||(wc={}));R.util.setEnumType(wc,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class Wo extends Se{constructor(e){super(),this.sdk=Ac.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Wo().fromBinary(e,n)}static fromJson(e,n){return new Wo().fromJson(e,n)}static fromJsonString(e,n){return new Wo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Wo,e,n)}}Wo.runtime=R;Wo.typeName="livekit.ClientInfo";Wo.fields=R.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:R.getEnumType(Ac)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var Ac;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.PYTHON=9]="PYTHON",t[t.CPP=10]="CPP"})(Ac||(Ac={}));R.util.setEnumType(Ac,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class to extends Se{constructor(e){super(),this.resumeConnection=Li.UNSET,this.forceRelay=Li.UNSET,R.util.initPartial(e,this)}static fromBinary(e,n){return new to().fromBinary(e,n)}static fromJson(e,n){return new to().fromJson(e,n)}static fromJsonString(e,n){return new to().fromJsonString(e,n)}static equals(e,n){return R.util.equals(to,e,n)}}to.runtime=R;to.typeName="livekit.ClientConfiguration";to.fields=R.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:no},{no:2,name:"screen",kind:"message",T:no},{no:3,name:"resume_connection",kind:"enum",T:R.getEnumType(Li)},{no:4,name:"disabled_codecs",kind:"message",T:jo},{no:5,name:"force_relay",kind:"enum",T:R.getEnumType(Li)}]);class no extends Se{constructor(e){super(),this.hardwareEncoder=Li.UNSET,R.util.initPartial(e,this)}static fromBinary(e,n){return new no().fromBinary(e,n)}static fromJson(e,n){return new no().fromJson(e,n)}static fromJsonString(e,n){return new no().fromJsonString(e,n)}static equals(e,n){return R.util.equals(no,e,n)}}no.runtime=R;no.typeName="livekit.VideoConfiguration";no.fields=R.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:R.getEnumType(Li)}]);class jo extends Se{constructor(e){super(),this.codecs=[],this.publish=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new jo().fromBinary(e,n)}static fromJson(e,n){return new jo().fromJson(e,n)}static fromJsonString(e,n){return new jo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(jo,e,n)}}jo.runtime=R;jo.typeName="livekit.DisabledCodecs";jo.fields=R.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:Ai,repeated:!0},{no:2,name:"publish",kind:"message",T:Ai,repeated:!0}]);class ro extends Se{constructor(e){super(),this.duration=0,this.startTimestamp=Ue.zero,this.endTimestamp=Ue.zero,this.rtpClockTicks=Ue.zero,this.driftSamples=Ue.zero,this.driftMs=0,this.clockRate=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new ro().fromBinary(e,n)}static fromJson(e,n){return new ro().fromJson(e,n)}static fromJsonString(e,n){return new ro().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ro,e,n)}}ro.runtime=R;ro.typeName="livekit.RTPDrift";ro.fields=R.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:gn},{no:2,name:"end_time",kind:"message",T:gn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class Xs extends Se{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=Ue.zero,this.headerBytes=Ue.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=Ue.zero,this.headerBytesDuplicate=Ue.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=Ue.zero,this.headerBytesPadding=Ue.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new Xs().fromBinary(e,n)}static fromJson(e,n){return new Xs().fromJson(e,n)}static fromJsonString(e,n){return new Xs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Xs,e,n)}}Xs.runtime=R;Xs.typeName="livekit.RTPStats";Xs.fields=R.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:gn},{no:2,name:"end_time",kind:"message",T:gn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:gn},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:gn},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:gn},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:gn},{no:44,name:"packet_drift",kind:"message",T:ro},{no:45,name:"report_drift",kind:"message",T:ro}]);class $s extends Se{constructor(e){super(),this.unixMicro=Ue.zero,this.ticks=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new $s().fromBinary(e,n)}static fromJson(e,n){return new $s().fromJson(e,n)}static fromJsonString(e,n){return new $s().fromJsonString(e,n)}static equals(e,n){return R.util.equals($s,e,n)}}$s.runtime=R;$s.typeName="livekit.TimedVersion";$s.fields=R.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const vu=7e3,WW=[0,300,2*2*300,3*3*300,4*4*300,vu,vu,vu,vu,vu];class jW{constructor(e){this._retryDelays=e!==void 0?[...e]:WW}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function V(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,[])).next())})}function Lw(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Tl(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Lw=="function"?Lw(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){s=t[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var ZC={exports:{}},tc=typeof Reflect=="object"?Reflect:null,Bw=tc&&typeof tc.apply=="function"?tc.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},vh;tc&&typeof tc.ownKeys=="function"?vh=tc.ownKeys:Object.getOwnPropertySymbols?vh=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:vh=function(e){return Object.getOwnPropertyNames(e)};function ZW(t){console&&console.warn&&console.warn(t)}var yx=Number.isNaN||function(e){return e!==e};function ft(){ft.init.call(this)}ZC.exports=ft;ZC.exports.once=$W;ft.EventEmitter=ft;ft.prototype._events=void 0;ft.prototype._eventsCount=0;ft.prototype._maxListeners=void 0;var Fw=10;function ag(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ft,"defaultMaxListeners",{enumerable:!0,get:function(){return Fw},set:function(t){if(typeof t!="number"||t<0||yx(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Fw=t}});ft.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ft.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||yx(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Cx(t){return t._maxListeners===void 0?ft.defaultMaxListeners:t._maxListeners}ft.prototype.getMaxListeners=function(){return Cx(this)};ft.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(n.length>0&&(s=n[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")Bw(l,this,n);else for(var c=l.length,u=Ax(l,c),r=0;r<c;++r)Bw(u[r],this,n);return!0};function Ix(t,e,n,r){var i,o,s;if(ag(n),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),s===void 0)s=o[e]=n,++t._eventsCount;else if(typeof s=="function"?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=Cx(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,ZW(a)}return t}ft.prototype.addListener=function(e,n){return Ix(this,e,n,!1)};ft.prototype.on=ft.prototype.addListener;ft.prototype.prependListener=function(e,n){return Ix(this,e,n,!0)};function HW(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Sx(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=HW.bind(r);return i.listener=n,r.wrapFn=i,i}ft.prototype.once=function(e,n){return ag(n),this.on(e,Sx(this,e,n)),this};ft.prototype.prependOnceListener=function(e,n){return ag(n),this.prependListener(e,Sx(this,e,n)),this};ft.prototype.removeListener=function(e,n){var r,i,o,s,a;if(ag(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===n||r[s].listener===n){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():zW(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};ft.prototype.off=ft.prototype.removeListener;ft.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function bx(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?XW(i):Ax(i,i.length)}ft.prototype.listeners=function(e){return bx(this,e,!0)};ft.prototype.rawListeners=function(e){return bx(this,e,!1)};ft.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):wx.call(t,e)};ft.prototype.listenerCount=wx;function wx(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}ft.prototype.eventNames=function(){return this._eventsCount>0?vh(this._events):[]};function Ax(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function zW(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function XW(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function $W(t,e){return new Promise(function(n,r){function i(s){t.removeListener(e,o),r(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}kx(t,e,o,{once:!0}),e!=="error"&&KW(t,i,{once:!0})})}function KW(t,e,n){typeof t.on=="function"&&kx(t,"error",e,n)}function kx(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){r.once&&t.removeEventListener(e,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var ko=ZC.exports;let Ex=!0,Tx=!0;function yh(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function ml(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(s,a){if(s!==e)return i.apply(this,arguments);const l=c=>{const u=n(c);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,l),i.apply(this,[s,l])};const o=r.removeEventListener;r.removeEventListener=function(s,a){if(s!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(a))return o.apply(this,arguments);const l=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[s,l])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(s){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),s&&this.addEventListener(e,this["_on"+e]=s)},enumerable:!0,configurable:!0})}function JW(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(Ex=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function YW(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(Tx=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function Rx(){if(typeof window=="object"){if(Ex)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function HC(t,e){Tx&&console.warn(t+" is deprecated, please use "+e+" instead.")}function QW(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=yh(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=yh(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=yh(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function Uw(t){return Object.prototype.toString.call(t)==="[object Object]"}function xx(t){return Uw(t)?Object.keys(t).reduce(function(e,n){const r=Uw(t[n]),i=r?xx(t[n]):t[n],o=r&&!Object.keys(i).length;return i===void 0||o?e:Object.assign(e,{[n]:i})},{}):t}function x0(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?x0(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{x0(t,t.get(i),n)})}))}function Vw(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const o=[];return t.forEach(s=>{s.type==="track"&&s.trackIdentifier===e.id&&o.push(s)}),o.forEach(s=>{t.forEach(a=>{a.type===r&&a.trackId===s.id&&x0(t,a,i)})}),i}const Gw=Rx;function Px(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const l={};return Object.keys(a).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;const u=typeof a[c]=="object"?a[c]:{ideal:a[c]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(f,h){return f?f+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(u.ideal!==void 0){l.optional=l.optional||[];let f={};typeof u.ideal=="number"?(f[d("min",c)]=u.ideal,l.optional.push(f),f={},f[d("max",c)]=u.ideal,l.optional.push(f)):(f[d("",c)]=u.ideal,l.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[d("",c)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[d(f,c)]=u[f])})}),a.advanced&&(l.optional=(l.optional||[]).concat(a.advanced)),l},i=function(a,l){if(e.version>=61)return l(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const c=function(u,d,f){d in u&&!(f in u)&&(u[f]=u[d],delete u[d])};a=JSON.parse(JSON.stringify(a)),c(a.audio,"autoGainControl","googAutoGainControl"),c(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let c=a.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});const u=e.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let d;if(c.exact==="environment"||c.ideal==="environment"?d=["back","rear"]:(c.exact==="user"||c.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(p=>p.kind==="videoinput");let h=f.find(p=>d.some(g=>p.label.toLowerCase().includes(g)));return!h&&f.length&&d.includes("back")&&(h=f[f.length-1]),h&&(a.video.deviceId=c.exact?{exact:h.deviceId}:{ideal:h.deviceId}),a.video=r(a.video),Gw("chrome: "+JSON.stringify(a)),l(a)})}a.video=r(a.video)}return Gw("chrome: "+JSON.stringify(a)),l(a)},o=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},s=function(a,l,c){i(a,u=>{n.webkitGetUserMedia(u,l,d=>{c&&c(o(d))})})};if(n.getUserMedia=s.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(l){return i(l,c=>a(c).then(u=>{if(c.audio&&!u.getAudioTracks().length||c.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(o(u))))}}}function qW(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const o=r.video&&r.video.width,s=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},o&&(r.video.mandatory.maxWidth=o),s&&(r.video.mandatory.maxHeight=s),t.navigator.mediaDevices.getUserMedia(r)})}}}function Nx(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function _x(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):o={track:i.track};const s=new Event("track");s.track=i.track,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)}),r.stream.getTracks().forEach(i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.id):o={track:i};const s=new Event("track");s.track=i,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else ml(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Ox(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,l){let c=i.apply(this,arguments);return c||(c=e(this,a),this._senders.push(c)),c};const o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){o.apply(this,arguments);const l=this._senders.indexOf(a);l!==-1&&this._senders.splice(l,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(s=>{this._senders.push(e(this,s))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(s=>{const a=this._senders.find(l=>l.track===s);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Mx(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[r,i,o]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const s=function(l){const c={};return l.result().forEach(d=>{const f={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach(h=>{f[h]=d.stat(h)}),c[f.id]=f}),c},a=function(l){return new Map(Object.keys(l).map(c=>[c,l[c]]))};if(arguments.length>=2){const l=function(c){i(a(s(c)))};return e.apply(this,[l,r])}return new Promise((l,c)=>{e.apply(this,[function(u){l(a(s(u)))},c])}).then(i,o)}}function Dx(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const o=n.apply(this,[]);return o.forEach(s=>s._pc=this),o});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),t.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(s=>Vw(s,o.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(o=>o._pc=this),i}),ml(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>Vw(o,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,o,s;return this.getSenders().forEach(a=>{a.track===r&&(i?s=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(o?s=!0:o=a),a.track===r)),s||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Lx(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(s=>this._shimmedLocalStreams[s][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(s,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(l)===-1&&this._shimmedLocalStreams[a.id].push(l):this._shimmedLocalStreams[a.id]=[a,l],l};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._shimmedLocalStreams=this._shimmedLocalStreams||{},s.getTracks().forEach(c=>{if(this.getSenders().find(d=>d.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const l=this.getSenders().filter(c=>a.indexOf(c)===-1);this._shimmedLocalStreams[s.id]=[s].concat(l)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[s.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},s&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const l=this._shimmedLocalStreams[a].indexOf(s);l!==-1&&this._shimmedLocalStreams[a].splice(l,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function Bx(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Lx(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(d=>this._reverseStreams[d.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(d=>{if(this.getSenders().find(h=>h.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const d=new t.MediaStream(u.getTracks());this._streams[u.id]=d,this._reverseStreams[d.id]=u,u=d}r.apply(this,[u])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(g=>g===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(g=>g.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[d.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const g=new t.MediaStream([u]);this._streams[d.id]=g,this._reverseStreams[g.id]=d,this.addStream(g)}return this.getSenders().find(g=>g.track===u)};function o(c,u){let d=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(f=>{const h=c._reverseStreams[f],p=c._streams[h.id];d=d.replace(new RegExp(p.id,"g"),h.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function s(c,u){let d=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(f=>{const h=c._reverseStreams[f],p=c._streams[h.id];d=d.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(c){const u=t.RTCPeerConnection.prototype[c],d={[c](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const g=o(this,p);f[0].apply(null,[g])},p=>{f[1]&&f[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>o(this,p))}};t.RTCPeerConnection.prototype[c]=d[c]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=s(this,arguments[0]),a.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const c=l.get.apply(this);return c.type===""?c:o(this,c)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(g=>u.track===g)&&(f=this._streams[h])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function P0(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function Fx(t,e){ml(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var Ww=Object.freeze({__proto__:null,fixNegotiationNeeded:Fx,shimAddTrackRemoveTrack:Bx,shimAddTrackRemoveTrackWithNative:Lx,shimGetDisplayMedia:qW,shimGetSendersWithDtmf:Ox,shimGetStats:Mx,shimGetUserMedia:Px,shimMediaStream:Nx,shimOnTrack:_x,shimPeerConnection:P0,shimSenderReceiverGetStats:Dx});function Ux(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,o,s){HC("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(o,s)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(s,a,l){a in s&&!(l in s)&&(s[l]=s[a],delete s[a])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(s){return typeof s=="object"&&typeof s.audio=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s.audio,"autoGainControl","mozAutoGainControl"),i(s.audio,"noiseSuppression","mozNoiseSuppression")),o(s)},r&&r.prototype.getSettings){const s=r.prototype.getSettings;r.prototype.getSettings=function(){const a=s.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[a])}}}}function e9(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function Vx(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function N0(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=t.RTCPeerConnection.prototype[i],s={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=s[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[o,s,a]=arguments;return r.apply(this,[o||null]).then(l=>{if(e.version<53&&!s)try{l.forEach(c=>{c.type=n[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;l.forEach((u,d)=>{l.set(d,Object.assign({},u,{type:n[u.type]||u.type}))})}return l}).then(s,a)}}function Gx(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Wx(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),ml(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function jx(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){HC("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function Zx(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function Hx(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(s=>{if("rid"in s&&!/^[a-z0-9]{0,16}$/i.test(s.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in s&&!(parseFloat(s.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in s&&!(parseFloat(s.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(i){const{sender:s}=o,a=s.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,s.sendEncodings=r,this.setParametersPromises.push(s.setParameters(a).then(()=>{delete s.sendEncodings}).catch(()=>{delete s.sendEncodings})))}return o})}function zx(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function Xx(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function $x(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var jw=Object.freeze({__proto__:null,shimAddTransceiver:Hx,shimCreateAnswer:$x,shimCreateOffer:Xx,shimGetDisplayMedia:e9,shimGetParameters:zx,shimGetUserMedia:Ux,shimOnTrack:Vx,shimPeerConnection:N0,shimRTCDataChannel:Zx,shimReceiverGetStats:Wx,shimRemoveStream:jx,shimSenderGetStats:Gx});function Kx(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return o&&o.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function Jx(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const s=new Event("addstream");s.stream=o,r.dispatchEvent(s)})}),e.apply(r,arguments)}}}function Yx(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,o=e.setRemoteDescription,s=e.addIceCandidate;e.createOffer=function(c,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[d]);return u?(f.then(c,u),Promise.resolve()):f},e.createAnswer=function(c,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[d]);return u?(f.then(c,u),Promise.resolve()):f};let a=function(l,c,u){const d=i.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d};e.setLocalDescription=a,a=function(l,c,u){const d=o.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d},e.setRemoteDescription=a,a=function(l,c,u){const d=s.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d},e.addIceCandidate=a}function Qx(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(qx(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,o){e.mediaDevices.getUserMedia(r).then(i,o)}).bind(e))}function qx(t){return t&&t.video!==void 0?Object.assign({},t,{video:xx(t.video)}):t}function eP(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const o=[];for(let s=0;s<r.iceServers.length;s++){let a=r.iceServers[s];a.urls===void 0&&a.url?(HC("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,o.push(a)):o.push(r.iceServers[s])}r.iceServers=o}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function tP(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function nP(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(s=>s.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(s=>s.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function rP(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var Zw=Object.freeze({__proto__:null,shimAudioContext:rP,shimCallbacksAPI:Yx,shimConstraints:qx,shimCreateOfferLegacy:nP,shimGetUserMedia:Qx,shimLocalStreamsAPI:Kx,shimRTCIceServerUrls:eP,shimRemoteStreamsAPI:Jx,shimTrackEventTransceiver:tP}),iP={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":i.relatedAddress=r[o+1];break;case"rport":i.relatedPort=parseInt(r[o+1],10);break;case"tcptype":i.tcpType=r[o+1];break;case"ufrag":i.ufrag=r[o+1],i.usernameFragment=r[o+1];break;default:i[r[o]]===void 0&&(i[r[o]]=r[o+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const o=n.type;return r.push("typ"),r.push(o),o!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const o=n.substring(n.indexOf(" ")+1).split(";");for(let s=0;s<o.length;s++)i=o[s].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const o=[];Object.keys(n.parameters).forEach(s=>{n.parameters[s]!==void 0?o.push(s+"="+n.parameters[s]):o.push(s)}),r+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},o=n.indexOf(":",r);return o>-1?(i.attribute=n.substring(r+1,o),i.value=n.substring(o+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],o=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(n)[0].split(" ");r.profile=o[2];for(let a=3;a<o.length;a++){const l=o[a],c=e.matchPrefix(n,"a=rtpmap:"+l+" ")[0];if(c){const u=e.parseRtpMap(c),d=e.matchPrefix(n,"a=fmtp:"+l+" ");switch(u.parameters=d.length?e.parseFmtp(d[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const s=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{s.forEach(l=>{a.rtcpFeedback.find(u=>u.type===l.type&&u.parameter===l.parameter)||a.rtcpFeedback.push(l)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(s=>s.preferredPayloadType!==void 0?s.preferredPayloadType:s.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(s=>{i+=e.writeRtpMap(s),i+=e.writeFmtp(s),i+=e.writeRtcpFb(s)});let o=0;return r.codecs.forEach(s=>{s.maxptime>o&&(o=s.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(s=>{i+=e.writeExtmap(s)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),o=i.fecMechanisms.indexOf("RED")!==-1,s=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(n,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),l=a.length>0&&a[0].ssrc;let c;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===l&&(c=u[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let h={ssrc:l,codecPayloadType:parseInt(f.parameters.apt,10)};l&&c&&(h.rtx={ssrc:c}),r.push(h),o&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:l,mechanism:s?"red+ulpfec":"red"},r.push(h))}}),r.length===0&&l&&r.push({ssrc:l});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(f=>{f.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const o=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const s=e.matchPrefix(n,"a=rtcp-mux");return r.mux=s.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=e.matchPrefix(n,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const s=e.matchPrefix(n,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const a=e.matchPrefix(n,"a=sctpmap:");if(a.length>0){const l=a[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:o}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let o;const s=r!==void 0?r:2;return n?o=n:o=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+s+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const i=e.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(n){const i=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e})(iP);var oP=iP.exports,nc=nW(oP),t9=eW({__proto__:null,default:nc},[oP]);function Ch(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),o=nc.parseCandidate(r.candidate);for(const s in o)s in i||Object.defineProperty(i,s,{value:o[s]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,ml(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function _0(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||ml(t,"icecandidate",e=>{if(e.candidate){const n=nc.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Ih(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const l=nc.splitSections(a.sdp);return l.shift(),l.some(c=>{const u=nc.parseMLine(c);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(a){const l=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const c=parseInt(l[1],10);return c!==c?-1:c},i=function(a){let l=65536;return e.browser==="firefox"&&(e.version<57?a===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},o=function(a,l){let c=65536;e.browser==="firefox"&&e.version===57&&(c=65535);const u=nc.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?c=parseInt(u[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(c=2147483637),c},s=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const l=r(arguments[0]),c=i(l),u=o(arguments[0],l);let d;c===0&&u===0?d=Number.POSITIVE_INFINITY:c===0||u===0?d=Math.max(c,u):d=Math.min(c,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return s.apply(this,arguments)}}function Sh(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const o=r.send;r.send=function(){const a=arguments[0],l=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&l>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},ml(t,"datachannel",r=>(e(r.channel,r.target),r))}function O0(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const s=new Event("connectionstatechange",i);o.dispatchEvent(s)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function M0(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(s=>s.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return n.apply(this,arguments)}}function bh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function wh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(s=>n.apply(this,[s]))})}var n9=Object.freeze({__proto__:null,removeExtmapAllowMixed:M0,shimAddIceCandidateNullOrEmpty:bh,shimConnectionState:O0,shimMaxMessageSize:Ih,shimParameterlessSetLocalDescription:wh,shimRTCIceCandidate:Ch,shimRTCIceCandidateRelayProtocol:_0,shimSendThrowTypeError:Sh});function r9(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Rx,r=QW(t),i={browserDetails:r,commonShim:n9,extractVersion:yh,disableLog:JW,disableWarnings:YW,sdp:t9};switch(r.browser){case"chrome":if(!Ww||!P0||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=Ww,bh(t,r),wh(t),Px(t,r),Nx(t),P0(t,r),_x(t),Bx(t,r),Ox(t),Mx(t),Dx(t),Fx(t,r),Ch(t),_0(t),O0(t),Ih(t,r),Sh(t),M0(t,r);break;case"firefox":if(!jw||!N0||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=jw,bh(t,r),wh(t),Ux(t,r),N0(t,r),Vx(t),jx(t),Gx(t),Wx(t),Zx(t),Hx(t),zx(t),Xx(t),$x(t),Ch(t),O0(t),Ih(t,r),Sh(t);break;case"safari":if(!Zw||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=Zw,bh(t,r),wh(t),eP(t),nP(t),Yx(t),Kx(t),Jx(t),tP(t),Qx(t),rP(t),Ch(t),_0(t),Ih(t,r),Sh(t),M0(t,r);break;default:n("Unsupported browser!");break}return i}r9({window:typeof window>"u"?void 0:window});const i9=10,Df="lk_e2ee",o9="LKFrameEncryptionKey",s9={sharedKey:!1,ratchetSalt:o9,ratchetWindowSize:8,failureTolerance:i9};var oa;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(oa||(oa={}));var Hw;(function(t){t.KeyRatcheted="keyRatcheted"})(Hw||(Hw={}));var Ks;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Ks||(Ks={}));var zw;(function(t){t.Error="cryptorError"})(zw||(zw={}));function a9(){return l9()||D0()}function D0(){return typeof window.RTCRtpScriptTransform<"u"}function l9(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class vz extends ko.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{Xe.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},s9),e),this.on(oa.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(oa.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(oa.RatchetRequest,e,n)}}class jc extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}class vt extends jc{constructor(e,n,r){super(1,e),this.status=r,this.reason=n}}class zC extends jc{constructor(e){super(21,e??"device is unsupported")}}class $i extends jc{constructor(e){super(20,e??"track is invalid")}}class c9 extends jc{constructor(e){super(10,e??"unsupported server")}}class rn extends jc{constructor(e){super(12,e??"unexpected connection state")}}class L0 extends jc{constructor(e){super(13,e??"unable to negotiate")}}var xd;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(xd||(xd={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(xd||(xd={}));var ne;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.StateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged"})(ne||(ne={}));var ae;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded"})(ae||(ae={}));var Ae;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished"})(Ae||(Ae={}));var ye;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed"})(ye||(ye={}));function XC(t,e,n){var r,i,o;e===void 0&&(e=50),n===void 0&&(n={});var s=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,l=n.maxWait,c=Date.now(),u=[];function d(){if(l!==void 0){var h=Date.now()-c;if(h+e>=l)return l-h}return e}var f=function(){var h=[].slice.call(arguments),p=this;return new Promise(function(g,C){var m=s&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,c=Date.now(),!s){var S=t.apply(p,h);a&&a(S),u.forEach(function(E){return(0,E.resolve)(S)}),u=[]}},d()),m){var v=t.apply(p,h);return a&&a(v),g(v)}u.push({resolve:g,reject:C})})};return f.cancel=function(h){o!==void 0&&clearTimeout(o),u.forEach(function(p){return(0,p.reject)(h)}),u=[]},f}const u9=/version\/(\d+(\.?_?\d+)+)/i;let Im;function Cs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(Im===void 0||e){const r=d9.find(i=>{let{test:o}=i;return o.test(n)});Im=r==null?void 0:r.describe(n)}return Im}const d9=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Sm(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Sm(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Sm(u9,t),os:t.includes("mobile/")?"iOS":"macOS"}}}];function Sm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}var f9="1.15.13";const h9=f9,p9=11;class kn{}kn.setTimeout=function(){return setTimeout(...arguments)};kn.setInterval=function(){return setInterval(...arguments)};kn.clearTimeout=function(){return clearTimeout(...arguments)};kn.clearInterval=function(){return clearInterval(...arguments)};class ut{constructor(e,n,r,i,o){this.width=e,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i,priority:o}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const g9=["vp8","h264"],sP=["vp8","h264","vp9","av1"];function m9(t){return!!g9.find(e=>e===t)}var Sp;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:2e4},t.music={maxBitrate:32e3},t.musicStereo={maxBitrate:48e3},t.musicHighQuality={maxBitrate:64e3},t.musicHighQualityStereo={maxBitrate:96e3}})(Sp||(Sp={}));const Pd={h90:new ut(160,90,9e4,20),h180:new ut(320,180,16e4,20),h216:new ut(384,216,18e4,20),h360:new ut(640,360,45e4,20),h540:new ut(960,540,8e5,25),h720:new ut(1280,720,17e5,30),h1080:new ut(1920,1080,3e6,30),h1440:new ut(2560,1440,5e6,30),h2160:new ut(3840,2160,8e6,30)},B0={h120:new ut(160,120,7e4,20),h180:new ut(240,180,125e3,20),h240:new ut(320,240,14e4,20),h360:new ut(480,360,33e4,20),h480:new ut(640,480,5e5,20),h540:new ut(720,540,6e5,25),h720:new ut(960,720,13e5,30),h1080:new ut(1440,1080,23e5,30),h1440:new ut(1920,1440,38e5,30)},$C={h360fps3:new ut(640,360,2e5,3,"medium"),h360fps15:new ut(640,360,4e5,15,"medium"),h720fps5:new ut(1280,720,8e5,5,"medium"),h720fps15:new ut(1280,720,15e5,15,"medium"),h720fps30:new ut(1280,720,2e6,30,"medium"),h1080fps15:new ut(1920,1080,25e5,15,"medium"),h1080fps30:new ut(1920,1080,5e6,30,"medium"),original:new ut(0,0,7e6,30,"medium")};var Vn;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER"})(Vn||(Vn={}));R.util.setEnumType(Vn,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var sl;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.PAUSED=1]="PAUSED"})(sl||(sl={}));R.util.setEnumType(sl,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var bp;(function(t){t[t.UDP=0]="UDP",t[t.TCP=1]="TCP",t[t.TLS=2]="TLS"})(bp||(bp={}));R.util.setEnumType(bp,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class Zo extends Se{constructor(e){super(),this.message={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new Zo().fromBinary(e,n)}static fromJson(e,n){return new Zo().fromJson(e,n)}static fromJsonString(e,n){return new Zo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Zo,e,n)}}Zo.runtime=R;Zo.typeName="livekit.SignalRequest";Zo.fields=R.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:nr,oneof:"message"},{no:2,name:"answer",kind:"message",T:nr,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Ti,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Ei,oneof:"message"},{no:5,name:"mute",kind:"message",T:Ri,oneof:"message"},{no:6,name:"subscription",kind:"message",T:ei,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:oo,oneof:"message"},{no:8,name:"leave",kind:"message",T:ti,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:so,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:uo,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:fo,oneof:"message"},{no:13,name:"simulate",kind:"message",T:bn,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:ao,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:po,oneof:"message"}]);class io extends Se{constructor(e){super(),this.message={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new io().fromBinary(e,n)}static fromJson(e,n){return new io().fromJson(e,n)}static fromJsonString(e,n){return new io().fromJsonString(e,n)}static equals(e,n){return R.util.equals(io,e,n)}}io.runtime=R;io.typeName="livekit.SignalResponse";io.fields=R.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:Ho,oneof:"message"},{no:2,name:"answer",kind:"message",T:nr,oneof:"message"},{no:3,name:"offer",kind:"message",T:nr,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Ti,oneof:"message"},{no:5,name:"update",kind:"message",T:$o,oneof:"message"},{no:6,name:"track_published",kind:"message",T:xi,oneof:"message"},{no:8,name:"leave",kind:"message",T:ti,oneof:"message"},{no:9,name:"mute",kind:"message",T:Ri,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Ko,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Jo,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:Qo,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:es,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:ns,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:rs,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:Xo,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:zo,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:is,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:ss,oneof:"message"}]);class ki extends Se{constructor(e){super(),this.codec="",this.cid="",R.util.initPartial(e,this)}static fromBinary(e,n){return new ki().fromBinary(e,n)}static fromJson(e,n){return new ki().fromJson(e,n)}static fromJsonString(e,n){return new ki().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ki,e,n)}}ki.runtime=R;ki.typeName="livekit.SimulcastCodec";ki.fields=R.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class Ei extends Se{constructor(e){super(),this.cid="",this.name="",this.type=Un.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=Xt.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=wn.NONE,this.stream="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Ei().fromBinary(e,n)}static fromJson(e,n){return new Ei().fromJson(e,n)}static fromJsonString(e,n){return new Ei().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ei,e,n)}}Ei.runtime=R;Ei.typeName="livekit.AddTrackRequest";Ei.fields=R.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:R.getEnumType(Un)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:R.getEnumType(Xt)},{no:9,name:"layers",kind:"message",T:tr,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:ki,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:R.getEnumType(wn)},{no:15,name:"stream",kind:"scalar",T:9}]);class Ti extends Se{constructor(e){super(),this.candidateInit="",this.target=Vn.PUBLISHER,R.util.initPartial(e,this)}static fromBinary(e,n){return new Ti().fromBinary(e,n)}static fromJson(e,n){return new Ti().fromJson(e,n)}static fromJsonString(e,n){return new Ti().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ti,e,n)}}Ti.runtime=R;Ti.typeName="livekit.TrickleRequest";Ti.fields=R.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:R.getEnumType(Vn)}]);class Ri extends Se{constructor(e){super(),this.sid="",this.muted=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Ri().fromBinary(e,n)}static fromJson(e,n){return new Ri().fromJson(e,n)}static fromJsonString(e,n){return new Ri().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ri,e,n)}}Ri.runtime=R;Ri.typeName="livekit.MuteTrackRequest";Ri.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class Ho extends Se{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),R.util.initPartial(e,this)}static fromBinary(e,n){return new Ho().fromBinary(e,n)}static fromJson(e,n){return new Ho().fromJson(e,n)}static fromJsonString(e,n){return new Ho().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ho,e,n)}}Ho.runtime=R;Ho.typeName="livekit.JoinResponse";Ho.fields=R.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Wc},{no:2,name:"participant",kind:"message",T:Vr},{no:3,name:"other_participants",kind:"message",T:Vr,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:lo,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:to},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Go},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class zo extends Se{constructor(e){super(),this.iceServers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new zo().fromBinary(e,n)}static fromJson(e,n){return new zo().fromJson(e,n)}static fromJsonString(e,n){return new zo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(zo,e,n)}}zo.runtime=R;zo.typeName="livekit.ReconnectResponse";zo.fields=R.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:lo,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:to}]);class xi extends Se{constructor(e){super(),this.cid="",R.util.initPartial(e,this)}static fromBinary(e,n){return new xi().fromBinary(e,n)}static fromJson(e,n){return new xi().fromJson(e,n)}static fromJsonString(e,n){return new xi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(xi,e,n)}}xi.runtime=R;xi.typeName="livekit.TrackPublishedResponse";xi.fields=R.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:vr}]);class Xo extends Se{constructor(e){super(),this.trackSid="",R.util.initPartial(e,this)}static fromBinary(e,n){return new Xo().fromBinary(e,n)}static fromJson(e,n){return new Xo().fromJson(e,n)}static fromJsonString(e,n){return new Xo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Xo,e,n)}}Xo.runtime=R;Xo.typeName="livekit.TrackUnpublishedResponse";Xo.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class nr extends Se{constructor(e){super(),this.type="",this.sdp="",R.util.initPartial(e,this)}static fromBinary(e,n){return new nr().fromBinary(e,n)}static fromJson(e,n){return new nr().fromJson(e,n)}static fromJsonString(e,n){return new nr().fromJsonString(e,n)}static equals(e,n){return R.util.equals(nr,e,n)}}nr.runtime=R;nr.typeName="livekit.SessionDescription";nr.fields=R.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class $o extends Se{constructor(e){super(),this.participants=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new $o().fromBinary(e,n)}static fromJson(e,n){return new $o().fromJson(e,n)}static fromJsonString(e,n){return new $o().fromJsonString(e,n)}static equals(e,n){return R.util.equals($o,e,n)}}$o.runtime=R;$o.typeName="livekit.ParticipantUpdate";$o.fields=R.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:Vr,repeated:!0}]);class ei extends Se{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new ei().fromBinary(e,n)}static fromJson(e,n){return new ei().fromJson(e,n)}static fromJsonString(e,n){return new ei().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ei,e,n)}}ei.runtime=R;ei.typeName="livekit.UpdateSubscription";ei.fields=R.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:eo,repeated:!0}]);class oo extends Se{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=cn.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new oo().fromBinary(e,n)}static fromJson(e,n){return new oo().fromJson(e,n)}static fromJsonString(e,n){return new oo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(oo,e,n)}}oo.runtime=R;oo.typeName="livekit.UpdateTrackSettings";oo.fields=R.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:R.getEnumType(cn)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class ti extends Se{constructor(e){super(),this.canReconnect=!1,this.reason=cs.UNKNOWN_REASON,R.util.initPartial(e,this)}static fromBinary(e,n){return new ti().fromBinary(e,n)}static fromJson(e,n){return new ti().fromJson(e,n)}static fromJsonString(e,n){return new ti().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ti,e,n)}}ti.runtime=R;ti.typeName="livekit.LeaveRequest";ti.fields=R.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:R.getEnumType(cs)}]);class so extends Se{constructor(e){super(),this.trackSid="",this.layers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new so().fromBinary(e,n)}static fromJson(e,n){return new so().fromJson(e,n)}static fromJsonString(e,n){return new so().fromJsonString(e,n)}static equals(e,n){return R.util.equals(so,e,n)}}so.runtime=R;so.typeName="livekit.UpdateVideoLayers";so.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:tr,repeated:!0}]);class ao extends Se{constructor(e){super(),this.metadata="",this.name="",R.util.initPartial(e,this)}static fromBinary(e,n){return new ao().fromBinary(e,n)}static fromJson(e,n){return new ao().fromJson(e,n)}static fromJsonString(e,n){return new ao().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ao,e,n)}}ao.runtime=R;ao.typeName="livekit.UpdateParticipantMetadata";ao.fields=R.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class lo extends Se{constructor(e){super(),this.urls=[],this.username="",this.credential="",R.util.initPartial(e,this)}static fromBinary(e,n){return new lo().fromBinary(e,n)}static fromJson(e,n){return new lo().fromJson(e,n)}static fromJsonString(e,n){return new lo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(lo,e,n)}}lo.runtime=R;lo.typeName="livekit.ICEServer";lo.fields=R.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class Ko extends Se{constructor(e){super(),this.speakers=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Ko().fromBinary(e,n)}static fromJson(e,n){return new Ko().fromJson(e,n)}static fromJsonString(e,n){return new Ko().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Ko,e,n)}}Ko.runtime=R;Ko.typeName="livekit.SpeakersChanged";Ko.fields=R.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Qi,repeated:!0}]);class Jo extends Se{constructor(e){super(),R.util.initPartial(e,this)}static fromBinary(e,n){return new Jo().fromBinary(e,n)}static fromJson(e,n){return new Jo().fromJson(e,n)}static fromJsonString(e,n){return new Jo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Jo,e,n)}}Jo.runtime=R;Jo.typeName="livekit.RoomUpdate";Jo.fields=R.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Wc}]);class Yo extends Se{constructor(e){super(),this.participantSid="",this.quality=Bo.POOR,this.score=0,R.util.initPartial(e,this)}static fromBinary(e,n){return new Yo().fromBinary(e,n)}static fromJson(e,n){return new Yo().fromJson(e,n)}static fromJsonString(e,n){return new Yo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Yo,e,n)}}Yo.runtime=R;Yo.typeName="livekit.ConnectionQualityInfo";Yo.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:R.getEnumType(Bo)},{no:3,name:"score",kind:"scalar",T:2}]);class Qo extends Se{constructor(e){super(),this.updates=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Qo().fromBinary(e,n)}static fromJson(e,n){return new Qo().fromJson(e,n)}static fromJsonString(e,n){return new Qo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Qo,e,n)}}Qo.runtime=R;Qo.typeName="livekit.ConnectionQualityUpdate";Qo.fields=R.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:Yo,repeated:!0}]);class qo extends Se{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=sl.ACTIVE,R.util.initPartial(e,this)}static fromBinary(e,n){return new qo().fromBinary(e,n)}static fromJson(e,n){return new qo().fromJson(e,n)}static fromJsonString(e,n){return new qo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(qo,e,n)}}qo.runtime=R;qo.typeName="livekit.StreamStateInfo";qo.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:R.getEnumType(sl)}]);class es extends Se{constructor(e){super(),this.streamStates=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new es().fromBinary(e,n)}static fromJson(e,n){return new es().fromJson(e,n)}static fromJsonString(e,n){return new es().fromJsonString(e,n)}static equals(e,n){return R.util.equals(es,e,n)}}es.runtime=R;es.typeName="livekit.StreamStateUpdate";es.fields=R.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:qo,repeated:!0}]);class Pi extends Se{constructor(e){super(),this.quality=cn.LOW,this.enabled=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new Pi().fromBinary(e,n)}static fromJson(e,n){return new Pi().fromJson(e,n)}static fromJsonString(e,n){return new Pi().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Pi,e,n)}}Pi.runtime=R;Pi.typeName="livekit.SubscribedQuality";Pi.fields=R.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:R.getEnumType(cn)},{no:2,name:"enabled",kind:"scalar",T:8}]);class ts extends Se{constructor(e){super(),this.codec="",this.qualities=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new ts().fromBinary(e,n)}static fromJson(e,n){return new ts().fromJson(e,n)}static fromJsonString(e,n){return new ts().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ts,e,n)}}ts.runtime=R;ts.typeName="livekit.SubscribedCodec";ts.fields=R.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Pi,repeated:!0}]);class ns extends Se{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new ns().fromBinary(e,n)}static fromJson(e,n){return new ns().fromJson(e,n)}static fromJsonString(e,n){return new ns().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ns,e,n)}}ns.runtime=R;ns.typeName="livekit.SubscribedQualityUpdate";ns.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Pi,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:ts,repeated:!0}]);class co extends Se{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",R.util.initPartial(e,this)}static fromBinary(e,n){return new co().fromBinary(e,n)}static fromJson(e,n){return new co().fromJson(e,n)}static fromJsonString(e,n){return new co().fromJsonString(e,n)}static equals(e,n){return R.util.equals(co,e,n)}}co.runtime=R;co.typeName="livekit.TrackPermission";co.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class uo extends Se{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new uo().fromBinary(e,n)}static fromJson(e,n){return new uo().fromJson(e,n)}static fromJsonString(e,n){return new uo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(uo,e,n)}}uo.runtime=R;uo.typeName="livekit.SubscriptionPermission";uo.fields=R.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:co,repeated:!0}]);class rs extends Se{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,R.util.initPartial(e,this)}static fromBinary(e,n){return new rs().fromBinary(e,n)}static fromJson(e,n){return new rs().fromJson(e,n)}static fromJsonString(e,n){return new rs().fromJsonString(e,n)}static equals(e,n){return R.util.equals(rs,e,n)}}rs.runtime=R;rs.typeName="livekit.SubscriptionPermissionUpdate";rs.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class fo extends Se{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new fo().fromBinary(e,n)}static fromJson(e,n){return new fo().fromJson(e,n)}static fromJsonString(e,n){return new fo().fromJsonString(e,n)}static equals(e,n){return R.util.equals(fo,e,n)}}fo.runtime=R;fo.typeName="livekit.SyncState";fo.fields=R.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:nr},{no:2,name:"subscription",kind:"message",T:ei},{no:3,name:"publish_tracks",kind:"message",T:xi,repeated:!0},{no:4,name:"data_channels",kind:"message",T:ho,repeated:!0},{no:5,name:"offer",kind:"message",T:nr}]);class ho extends Se{constructor(e){super(),this.label="",this.id=0,this.target=Vn.PUBLISHER,R.util.initPartial(e,this)}static fromBinary(e,n){return new ho().fromBinary(e,n)}static fromJson(e,n){return new ho().fromJson(e,n)}static fromJsonString(e,n){return new ho().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ho,e,n)}}ho.runtime=R;ho.typeName="livekit.DataChannelInfo";ho.fields=R.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:R.getEnumType(Vn)}]);class bn extends Se{constructor(e){super(),this.scenario={case:void 0},R.util.initPartial(e,this)}static fromBinary(e,n){return new bn().fromBinary(e,n)}static fromJson(e,n){return new bn().fromJson(e,n)}static fromJsonString(e,n){return new bn().fromJsonString(e,n)}static equals(e,n){return R.util.equals(bn,e,n)}}bn.runtime=R;bn.typeName="livekit.SimulateScenario";bn.fields=R.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:R.getEnumType(bp),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]);class po extends Se{constructor(e){super(),this.timestamp=Ue.zero,this.rtt=Ue.zero,R.util.initPartial(e,this)}static fromBinary(e,n){return new po().fromBinary(e,n)}static fromJson(e,n){return new po().fromJson(e,n)}static fromJsonString(e,n){return new po().fromJsonString(e,n)}static equals(e,n){return R.util.equals(po,e,n)}}po.runtime=R;po.typeName="livekit.Ping";po.fields=R.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class is extends Se{constructor(e){super(),this.lastPingTimestamp=Ue.zero,this.timestamp=Ue.zero,R.util.initPartial(e,this)}static fromBinary(e,n){return new is().fromBinary(e,n)}static fromJson(e,n){return new is().fromJson(e,n)}static fromJsonString(e,n){return new is().fromJsonString(e,n)}static equals(e,n){return R.util.equals(is,e,n)}}is.runtime=R;is.typeName="livekit.Pong";is.fields=R.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class Js extends Se{constructor(e){super(),this.regions=[],R.util.initPartial(e,this)}static fromBinary(e,n){return new Js().fromBinary(e,n)}static fromJson(e,n){return new Js().fromJson(e,n)}static fromJsonString(e,n){return new Js().fromJsonString(e,n)}static equals(e,n){return R.util.equals(Js,e,n)}}Js.runtime=R;Js.typeName="livekit.RegionSettings";Js.fields=R.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:os,repeated:!0}]);class os extends Se{constructor(e){super(),this.region="",this.url="",this.distance=Ue.zero,R.util.initPartial(e,this)}static fromBinary(e,n){return new os().fromBinary(e,n)}static fromJson(e,n){return new os().fromJson(e,n)}static fromJsonString(e,n){return new os().fromJsonString(e,n)}static equals(e,n){return R.util.equals(os,e,n)}}os.runtime=R;os.typeName="livekit.RegionInfo";os.fields=R.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class ss extends Se{constructor(e){super(),this.trackSid="",this.err=Rd.SE_UNKNOWN,R.util.initPartial(e,this)}static fromBinary(e,n){return new ss().fromBinary(e,n)}static fromJson(e,n){return new ss().fromJson(e,n)}static fromJsonString(e,n){return new ss().fromJsonString(e,n)}static equals(e,n){return R.util.equals(ss,e,n)}}ss.runtime=R;ss.typeName="livekit.SubscriptionResponse";ss.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:R.getEnumType(Rd)}]);function v9(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const y9=5e3,yu=[];class Q extends ko.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Q.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Xe,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),y9):this.handleAppVisibilityChanged()},this.log=ys((i=r.loggerName)!==null&&i!==void 0?i:yo.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Q.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),At(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===Q.Kind.Video&&(n="video"),this.attachedElements.length===0&&Q.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(yu.forEach(o=>{o.parentElement===null&&!e&&(e=o)}),e&&yu.splice(yu.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),jl(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(o=>o.kind==="audio");return e.play().then(()=>{this.emit(i?ye.AudioPlaybackStarted:ye.VideoPlaybackStarted)}).catch(o=>{o.name==="NotAllowedError"?this.emit(i?ye.AudioPlaybackFailed:ye.VideoPlaybackFailed,o):o.name==="AbortError"?Xe.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):Xe.warn("could not playback ".concat(i?"audio":"video"),o),i&&e&&r.some(s=>s.kind==="video")&&o.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(ye.ElementAttached,e),e}detach(e){try{if(e){rc(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(ye.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{rc(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(ye.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(e){e.loggerName&&(this.log=ys(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),yu.forEach(r=>{r.parentElement||(n=!1)}),n&&yu.push(e)}}handleAppVisibilityChanged(){return V(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){Sr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Sr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function jl(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!al()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(al()||kc())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function rc(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(c){c.Audio="audio",c.Video="video",c.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(c){c.Camera="camera",c.Microphone="microphone",c.ScreenShare="screen_share",c.ScreenShareAudio="screen_share_audio",c.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(c){c.Active="active",c.Paused="paused",c.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(c){switch(c){case e.Audio:return Un.AUDIO;case e.Video:return Un.VIDEO;default:return Un.DATA}}t.kindToProto=i;function o(c){switch(c){case Un.AUDIO:return e.Audio;case Un.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=o;function s(c){switch(c){case n.Camera:return Xt.CAMERA;case n.Microphone:return Xt.MICROPHONE;case n.ScreenShare:return Xt.SCREEN_SHARE;case n.ScreenShareAudio:return Xt.SCREEN_SHARE_AUDIO;default:return Xt.UNKNOWN}}t.sourceToProto=s;function a(c){switch(c){case Xt.CAMERA:return n.Camera;case Xt.MICROPHONE:return n.Microphone;case Xt.SCREEN_SHARE:return n.ScreenShare;case Xt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=a;function l(c){switch(c){case sl.ACTIVE:return r.Active;case sl.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=l})(Q||(Q={}));function aP(t,e,n){var r;const i=(r=v9(t))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&F0(i.audio,e),i.video&&F0(i.video,n),i}function F0(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function lg(t){const e={};if(t.video)if(typeof t.video=="object"){const n={},r=n,i=t.video;Object.keys(i).forEach(o=>{switch(o){case"resolution":F0(r,i.resolution);break;default:r[o]=i[o]}}),e.video=n}else e.video=t.video;else e.video=!1;return t.audio?typeof t.audio=="object"?e.audio=t.audio:e.audio=!0:e.audio=!1,e}function C9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return V(this,void 0,void 0,function*(){const n=KC();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,o=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(r),yield us(e),r.getByteTimeDomainData(o);const a=o.some(l=>l!==128&&l!==0);return n.close(),!a}return!1})}function KC(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function I9(t){return t===Q.Source.Microphone?"audioinput":t===Q.Source.Camera?"videoinput":void 0}function S9(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(r=typeof r=="boolean"?{}:r,al()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio}}function lP(t){const e=t.split("/")[1].toLowerCase();if(!sP.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function b9(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new xi({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function At(t){return t instanceof Q?{trackSid:t.sid,trackSource:t.source,trackMuted:t.isMuted,trackEnabled:t.mediaStreamTrack.enabled,trackKind:t.kind}:{trackSid:t.trackSid,trackName:t.trackName,track:t.track?At(t.track):void 0,trackEnabled:t.isEnabled,trackEncrypted:t.isEncrypted,trackMimeType:t.mimeType}}const w9="|",Xw="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function A9(t){const e=t.split(w9);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function us(t){return V(this,void 0,void 0,function*(){return new Promise(e=>kn.setTimeout(e,t))})}function $w(){return"addTransceiver"in RTCPeerConnection.prototype}function Kw(){return"addTrack"in RTCPeerConnection.prototype}function k9(){if(!("getCapabilities"in RTCRtpSender)||al())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function E9(){if(!("getCapabilities"in RTCRtpSender)||kc())return!1;if(al()){const n=Cs();if(n!=null&&n.version&&JC(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function $u(t){return t==="av1"||t==="vp9"}function U0(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}const T9={Chrome:"100",Safari:"15",Firefox:"100"};function R9(t){if(!Sr()||!("setCodecPreferences"in t))return!1;const e=Cs();if(!(e!=null&&e.name)||!e.version)return!1;const n=T9[e.name];return n?JC(e.version,n)>=0:!1}function kc(){var t;return((t=Cs())===null||t===void 0?void 0:t.name)==="Firefox"}function x9(){var t;return((t=Cs())===null||t===void 0?void 0:t.name)==="Chrome"}function al(){var t;return((t=Cs())===null||t===void 0?void 0:t.name)==="Safari"}function P9(){const t=Cs();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")}function cP(){return Sr()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function Sr(){return typeof document<"u"}function ll(){return navigator.product=="ReactNative"}function V0(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function uP(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function dP(){if(!ll())return;let t=uP();if(t)return t.platform}function Jw(){if(Sr())return window.devicePixelRatio;if(ll()){let t=uP();if(t)return t.devicePixelRatio}return 1}function JC(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let o=0;o<i;++o){const s=parseInt(n[o],10),a=parseInt(r[o],10);if(s>a)return 1;if(s<a)return-1;if(o===i-1&&s===a)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function N9(t){for(const e of t)e.target.handleResize(e)}function _9(t){for(const e of t)e.target.handleVisibilityChanged(e)}let bm=null;const Yw=()=>(bm||(bm=new ResizeObserver(N9)),bm);let wm=null;const Qw=()=>(wm||(wm=new IntersectionObserver(_9,{root:null,rootMargin:"0px"})),wm);function O9(){var t;const e=new Wo({sdk:Ac.JS,protocol:p9,version:h9});return ll()&&(e.os=(t=dP())!==null&&t!==void 0?t:""),e}function qw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const o=i.getContext("2d");o==null||o.fillRect(0,0,i.width,i.height),r&&o&&(o.beginPath(),o.arc(t/2,e/2,50,0,Math.PI*2,!0),o.closePath(),o.fillStyle="grey",o.fill());const s=i.captureStream(),[a]=s.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let Cu;function Am(){if(!Cu){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[Cu]=r.stream.getAudioTracks(),!Cu)throw Error("Could not get empty media stream audio track");Cu.enabled=!1}return Cu.clone()}class fP{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>V(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function M9(t,e){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=KC();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?t.mediaStreamTrack.clone():t.mediaStreamTrack,o=r.createMediaStreamSource(new MediaStream([i])),s=r.createAnalyser();s.minDecibels=n.minDecibels,s.maxDecibels=n.maxDecibels,s.fftSize=n.fftSize,s.smoothingTimeConstant=n.smoothingTimeConstant,o.connect(s);const a=new Uint8Array(s.frequencyBinCount);return{calculateVolume:()=>{s.getByteFrequencyData(a);let u=0;for(const f of a)u+=Math.pow(f/255,2);return Math.sqrt(u/a.length)},analyser:s,cleanup:()=>V(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&i.stop()})}}class Oi{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function D9(t){return sP.includes(t)}function $a(t){if(typeof t=="string")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function L9(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function eA(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}const tA="default";class Qn{static getInstance(){return this.instance===void 0&&(this.instance=new Qn),this.instance}getDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return V(this,void 0,void 0,function*(){if(((r=Qn.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){Xe.debug("awaiting getUserMedia promise");try{e?yield Qn.userMediaPromiseMap.get(e):yield Promise.all(Qn.userMediaPromiseMap.values())}catch{Xe.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(n&&!(al()&&this.hasDeviceInUse(e))&&(i.length===0||i.some(s=>{const a=s.label==="",l=e?s.kind===e:!0;return a&&l}))){const s={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(s);i=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(l=>{l.stop()})}return e&&(i=i.filter(o=>o.kind===e)),i})}normalizeDeviceId(e,n,r){return V(this,void 0,void 0,function*(){if(n!==tA)return n;const o=(yield this.getDevices(e)).find(s=>s.groupId===r&&s.deviceId!==tA);return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?Qn.userMediaPromiseMap.has(e):Qn.userMediaPromiseMap.size>0}}Qn.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Qn.userMediaPromiseMap=new Map;const B9=1e3;class Ec extends Q{get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;super(e,n,o),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=XC(()=>V(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>V(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(ye.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new Oi,this.pauseUpstreamLock=new Oi,this.processorLock=new Oi,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Q.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(e,n){return V(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{rc(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");jl(e,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{jl(r??e,i)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:B9;var n;return V(this,void 0,void 0,function*(){if(this.kind===Q.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=Cs())===null||n===void 0?void 0:n.os)==="iOS"&&(yield us(10));const r=Date.now();for(;Date.now()-r<e;){const i=this.dimensions;if(i)return i;yield us(50)}throw new $i("unable to get track dimensions after timeout")})}getDeviceId(){return V(this,void 0,void 0,function*(){if(this.source===Q.Source.ScreenShare)return;const{deviceId:e,groupId:n}=this._mediaStreamTrack.getSettings(),r=this.kind===Q.Kind.Audio?"audioinput":"videoinput";return Qn.getInstance().normalizeDeviceId(r,e,n)})}mute(){return V(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return V(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return V(this,void 0,void 0,function*(){if(!this.sender)throw new $i("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(e){return V(this,void 0,void 0,function*(){e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const n={audio:!1,video:!1};this.kind===Q.Kind.Video?n.video=e:n.audio=e,this.attachedElements.forEach(o=>{rc(this.mediaStreamTrack,o)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(i),this._constraints=e,this.emit(ye.Restarted,this),this})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ye.Muted:ye.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return V(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),cP()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return V(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(ye.UpstreamPaused,this);const n=Cs();if((n==null?void 0:n.name)==="Safari"&&JC(n.version,"12.0")<0)throw new zC("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return V(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(ye.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return V(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return V(this,void 0,void 0,function*(){const o=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),jl(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch(a=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:a})));const s={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(s),this.processor=e,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&n&&(rc(this._mediaStreamTrack,a),jl(this.processor.processedTrack,a));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{o()}})}getProcessor(){return this.processor}stopProcessor(){var e,n;return V(this,void 0,void 0,function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class F9 extends ko.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:o,data:s}=n.data;switch(o){case"error":Xe.error(s.error.message),this.emit(Ks.EncryptionError,s.error);break;case"initAck":s.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==s.enabled&&s.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Ks.ParticipantEncryptionStatusChanged,s.enabled,this.room.localParticipant),this.encryptionEnabled=s.enabled;else if(s.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(s.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(s.participantIdentity));this.emit(Ks.ParticipantEncryptionStatusChanged,s.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(oa.KeyRatcheted,s.material,s.keyIndex);break}},this.onWorkerError=n=>{Xe.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Ks.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!a9())throw new zC("tried to setup end-to-end encryption on an unsupported browser");if(Xe.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(Xe.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){Xe.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?Xe.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(Ae.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(ne.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==wn.NONE,i.identity)),e.on(ne.ConnectionStateChanged,r=>{r===nt.Connected&&e.participants.forEach(i=>{i.tracks.forEach(o=>{this.setParticipantCryptorEnabled(o.trackInfo.encryption!==wn.NONE,i.identity)})})}).on(ne.TrackUnsubscribed,(r,i,o)=>{var s;const a={kind:"removeTransform",data:{participantIdentity:o.identity,trackId:r.mediaStreamID}};(s=this.worker)===null||s===void 0||s.postMessage(a)}).on(ne.TrackSubscribed,(r,i,o)=>{this.setupE2EEReceiver(r,o.identity,i.trackInfo)}).on(ne.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(r=>{this.postKey(r)})}),e.localParticipant.on(ae.LocalTrackPublished,r=>V(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(oa.SetKey,r=>this.postKey(r)).on(oa.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const s={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(s)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?lP(r.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof Ec)||!n){n||Xe.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return V(this,void 0,void 0,function*(){if(this.worker){if(D0()){const o={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(Df in e&&i){const l={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(l);return}let o=e.writableStream,s=e.readableStream;if(!o||!s){const l=e.createEncodedStreams();e.writableStream=l.writable,o=l.writable,e.readableStream=l.readable,s=l.readable}const a={kind:"decode",data:{readableStream:s,writableStream:o,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[s,o])}e[Df]=!0}})}handleSender(e,n,r){var i;if(!(Df in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(D0()){Xe.info("initialize script transform");const o={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{Xe.info("initialize encoded streams");const o=e.createEncodedStreams(),s={kind:"encode",data:{readableStream:o.readable,writableStream:o.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s,[o.readable,o.writable])}e[Df]=!0}}}var Ku;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(Ku||(Ku={}));class U9{constructor(){this.pendingTasks=new Map,this.taskMutex=new Oi,this.nextTaskIndex=0}run(e){return V(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Ku.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Ku.RUNNING,yield e()}finally{n.status=Ku.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return V(this,void 0,void 0,function*(){return this.run(()=>V(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const V9=["syncState","trickle","offer","answer","simulate","leave"];function G9(t){const e=V9.indexOf(t.case)>=0;return Xe.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var Gt;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(Gt||(Gt={}));class YC{get currentState(){return this.state}get isDisconnected(){return this.state===Gt.DISCONNECTING||this.state===Gt.DISCONNECTED}get isEstablishingConnection(){return this.state===Gt.CONNECTING||this.state===Gt.RECONNECTING}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=Gt.DISCONNECTED,this.log=Xe,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=ys((r=n.loggerName)!==null&&r!==void 0?r:yo.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new U9,this.queuedRequests=[],this.closingLock=new Oi,this.connectionLock=new Oi,this.state=Gt.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,i){return V(this,void 0,void 0,function*(){return this.state=Gt.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return V(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Gt.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r,e=L9(e),e=e.replace(/\/$/,""),e+="/rtc";const o=O9(),s=W9(n,o,r);return new Promise((a,l)=>V(this,void 0,void 0,function*(){const c=yield this.connectionLock.lock();try{const u=()=>V(this,void 0,void 0,function*(){this.close(),clearTimeout(d),l(new vt("room connection has been cancelled (signal)"))}),d=setTimeout(()=>{this.close(),l(new vt("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&u(),i==null||i.addEventListener("abort",u),this.log.debug("connecting to ".concat(e+s),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+s),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=f=>V(this,void 0,void 0,function*(){if(this.state!==Gt.CONNECTED){clearTimeout(d);try{const h=yield fetch("http".concat(e.substring(2),"/validate").concat(s));if(h.status.toFixed(0).startsWith("4")){const p=yield h.text();l(new vt(p,0,h.status))}else l(new vt("Internal error",2,h.status))}catch{l(new vt("server was not reachable",1))}return}this.handleWSError(f)}),this.ws.onmessage=f=>V(this,void 0,void 0,function*(){var h,p,g,C;let m;if(typeof f.data=="string"){const v=JSON.parse(f.data);m=io.fromJson(v)}else if(f.data instanceof ArrayBuffer)m=io.fromBinary(new Uint8Array(f.data));else{this.log.error("could not decode websocket message: ".concat(typeof f.data),this.logContext);return}if(this.state!==Gt.CONNECTED){let v=!1;if(((h=m.message)===null||h===void 0?void 0:h.case)==="join"?(this.state=Gt.CONNECTED,i==null||i.removeEventListener("abort",u),this.pingTimeoutDuration=m.message.value.pingTimeout,this.pingIntervalDuration=m.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),a(m.message.value)):this.state===Gt.RECONNECTING&&m.message.case!=="leave"?(this.state=Gt.CONNECTED,i==null||i.removeEventListener("abort",u),this.startPingInterval(),((p=m.message)===null||p===void 0?void 0:p.case)==="reconnect"?a((g=m.message)===null||g===void 0?void 0:g.value):(a(),v=!0)):this.isEstablishingConnection&&m.message.case==="leave"?l(new vt("Received leave request while trying to (re)connect",4)):r.reconnect||l(new vt("did not receive join response, got ".concat((C=m.message)===null||C===void 0?void 0:C.case," instead"))),!v)return}this.signalLatency&&(yield us(this.signalLatency)),this.handleSignalResponse(m)}),this.ws.onclose=f=>{this.isEstablishingConnection&&l(new vt("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:f.reason,state:this.state})),this.handleOnClose(f.reason)}}finally{c()}}))}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return V(this,void 0,void 0,function*(){const n=yield this.closingLock.lock();try{if(e&&(this.state=Gt.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const r=new Promise(i=>{this.ws?this.ws.onclose=()=>{i()}:i()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([r,us(250)])),this.ws=void 0}}finally{e&&(this.state=Gt.DISCONNECTED),this.clearPingInterval(),n()}})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:wp(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:wp(e)})}sendIceCandidate(e,n){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Ti({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new Ri({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return this.sendRequest({case:"updateMetadata",value:new ao({metadata:e,name:n})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new so({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new uo({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Ue.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new po({timestamp:Ue.parse(Date.now()),rtt:Ue.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new ti({canReconnect:!1,reason:cs.CLIENT_INITIATED})})}sendRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return V(this,void 0,void 0,function*(){if(!n&&!G9(e)&&this.state===Gt.RECONNECTING){this.queuedRequests.push(()=>V(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield us(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){this.log.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case),this.logContext);return}const i=new Zo({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(o){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:o}))}})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let o=!1;if(i.case==="answer"){const s=nA(i.value);this.onAnswer&&this.onAnswer(s)}else if(i.case==="offer"){const s=nA(i.value);this.onOffer&&this.onOffer(s)}else if(i.case==="trickle"){const s=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(s,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return V(this,void 0,void 0,function*(){if(this.state===Gt.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=kn.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&kn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=kn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&kn.clearInterval(this.pingInterval)}}function nA(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function wp(t){return new nr({sdp:t.sdp,type:t.type})}function W9(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",ll()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.publishOnly!==void 0&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var hP={},pP={exports:{}},rA=pP.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(rA).forEach(function(t){var e=rA[t];e.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var gP=pP.exports;(function(t){var e=function(a){return String(Number(a))===a?Number(a):a},n=function(a,l,c,u){if(u&&!c)l[u]=e(a[1]);else for(var d=0;d<c.length;d+=1)a[d+1]!=null&&(l[c[d]]=e(a[d+1]))},r=function(a,l,c){var u=a.name&&a.names;a.push&&!l[a.push]?l[a.push]=[]:u&&!l[a.name]&&(l[a.name]={});var d=a.push?{}:u?l[a.name]:l;n(c.match(a.reg),d,a.names,a.name),a.push&&l[a.push].push(d)},i=gP,o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var l={},c=[],u=l;return a.split(/(\r\n|\r|\n)/).filter(o).forEach(function(d){var f=d[0],h=d.slice(2);f==="m"&&(c.push({rtp:[],fmtp:[]}),u=c[c.length-1]);for(var p=0;p<(i[f]||[]).length;p+=1){var g=i[f][p];if(g.reg.test(h))return r(g,u,h)}}),l.media=c,l};var s=function(a,l){var c=l.split(/=(.+)/,2);return c.length===2?a[c[0]]=e(c[1]):c.length===1&&l.length>1&&(a[c[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(s,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var l=[],c=a.split(" ").map(e),u=0;u<c.length;u+=3)l.push({component:c[u],ip:c[u+1],port:c[u+2]});return l},t.parseImageAttributes=function(a){return a.split(" ").map(function(l){return l.substring(1,l.length-1).split(",").reduce(s,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(l){return l.split(",").map(function(c){var u,d=!1;return c[0]!=="~"?u=e(c):(u=e(c.substring(1,c.length)),d=!0),{scid:u,paused:d}})})}})(hP);var km=gP,j9=/%[sdv%]/g,Z9=function(t){var e=1,n=arguments,r=n.length;return t.replace(j9,function(i){if(e>=r)return i;var o=n[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},Iu=function(t,e,n){var r=e.format instanceof Function?e.format(e.push?n:n[e.name]):e.format,i=[t+"="+r];if(e.names)for(var o=0;o<e.names.length;o+=1){var s=e.names[o];e.name?i.push(n[e.name][s]):i.push(n[e.names[o]])}else i.push(n[e.name]);return Z9.apply(null,i)},H9=["v","o","s","i","u","e","p","c","b","t","r","z","a"],z9=["i","c","b","a"],X9=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(o){o.payloads==null&&(o.payloads="")});var n=e.outerOrder||H9,r=e.innerOrder||z9,i=[];return n.forEach(function(o){km[o].forEach(function(s){s.name in t&&t[s.name]!=null?i.push(Iu(o,s,t)):s.push in t&&t[s.push]!=null&&t[s.push].forEach(function(a){i.push(Iu(o,s,a))})})}),t.media.forEach(function(o){i.push(Iu("m",km.m[0],o)),r.forEach(function(s){km[s].forEach(function(a){a.name in o&&o[a.name]!=null?i.push(Iu(s,a,o)):a.push in o&&o[a.push]!=null&&o[a.push].forEach(function(l){i.push(Iu(s,a,l))})})})}),i.join(`\r
`)+`\r
`},$9=hP,K9=X9,Em=K9,Mu=$9.parse;const iA=.7,ic={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class oA extends ko.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.log=Xe,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=XC(o=>V(this,void 0,void 0,function*(){this.emit(ic.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(o)o(s);else throw s}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=ys((i=r.loggerName)!==null&&i!==void 0?i:yo.PCTransport),this.loggerOptions=r,this.config=e,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const e=x9()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return V(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var n;return V(this,void 0,void 0,function*(){let r;if(e.type==="offer"){let{stereoMids:i,nackMids:o}=Y9(e);this.remoteStereoMids=i,this.remoteNackMids=o}else if(e.type==="answer"){const i=Mu((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"&&this.trackBitrates.some(s=>{if(!s.transceiver||o.mid!=s.transceiver.mid)return!1;let a=0;if(o.rtp.some(c=>c.codec.toUpperCase()===s.codec.toUpperCase()?(a=c.payload,!0):!1),a===0)return!0;let l=!1;for(const c of o.fmtp)if(c.payload===a){c.config=c.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),s.maxbr>0&&(c.config+=";maxaveragebitrate=".concat(s.maxbr*1e3)),l=!0;break}return l||s.maxbr>0&&o.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(s.maxbr*1e3)}),!0})}),r=Em(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(ic.NegotiationComplete),e.sdp&&Mu(e.sdp).media.forEach(o=>{o.type==="video"&&this.emit(ic.RTPVideoPayloadTypes,o.rtp)}))})}createAndSendOffer(e){var n;return V(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const o=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&o)yield this._pc.setRemoteDescription(o);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e),i=Mu((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"?sA(o,[],[]):o.type==="video"&&(J9(o),this.trackBitrates.some(s=>{if(!o.msid||!s.cid||!o.msid.includes(s.cid))return!1;let a=0;if(o.rtp.some(c=>c.codec.toUpperCase()===s.codec.toUpperCase()?(a=c.payload,!0):!1),a===0)return!0;let l=!1;for(const c of o.fmtp)if(c.payload===a){c.config.includes("x-google-start-bitrate")||(c.config+=";x-google-start-bitrate=".concat(Math.round(s.maxbr*iA))),c.config.includes("x-google-max-bitrate")||(c.config+=";x-google-max-bitrate=".concat(s.maxbr)),l=!0;break}return l||o.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(Math.round(s.maxbr*iA),";x-google-max-bitrate=").concat(s.maxbr)}),!0}))}),yield this.setMungedSDP(r,Em(i)),this.onOffer(r)})}createAndSetAnswer(){var e;return V(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),r=Mu((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{i.type==="audio"&&sA(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Em(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new rn("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new rn("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return V(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const s=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(s!==void 0)return i.get(s)})}setMungedSDP(e,n,r){return V(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(o){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:o,sdp:n})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let o="unknown error";i instanceof Error?o=i.message:typeof i=="string"&&(o=i);const s={error:o,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(s.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:s})),new L0(o)}})}}function sA(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function J9(t){var e,n,r,i;const o=(n=(e=t.rtp[0])===null||e===void 0?void 0:e.codec)===null||n===void 0?void 0:n.toLowerCase();if(!$u(o))return;let s=0;((r=t.ext)===null||r===void 0?void 0:r.some(l=>l.uri===Xw?!0:(l.value>s&&(s=l.value),!1)))||(i=t.ext)===null||i===void 0||i.push({value:s+1,uri:Xw})}function Y9(t){var e;const n=[],r=[],i=Mu((e=t.sdp)!==null&&e!==void 0?e:"");let o=0;return i.media.forEach(s=>{var a;s.type==="audio"&&(s.rtp.some(l=>l.codec==="opus"?(o=l.payload,!0):!1),!((a=s.rtcpFb)===null||a===void 0)&&a.some(l=>l.payload===o&&l.type==="nack")&&r.push(s.mid),s.fmtp.some(l=>l.payload===o?(l.config.includes("sprop-stereo=1")&&n.push(s.mid),!0):!1))}),{stereoMids:n,nackMids:r}}const G0="vp8",Q9={audioBitrate:Sp.music.maxBitrate,audioPreset:Sp.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:$C.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:G0,backupCodec:!0},mP={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},vP={resolution:Pd.h720.resolution},q9={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new jW,disconnectOnPageLeave:!0,expWebAudioMix:!1},QC={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var sn;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(sn||(sn={}));class e6{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,r){var i;this.peerConnectionTimeout=QC.peerConnectionTimeout,this.log=Xe,this.updateState=()=>{var s;const a=this.state,l=this.requiredTransports.map(c=>c.getConnectionState());l.every(c=>c==="connected")?this.state=sn.CONNECTED:l.some(c=>c==="failed")?this.state=sn.FAILED:l.some(c=>c==="connecting")?this.state=sn.CONNECTING:l.every(c=>c==="closed")?this.state=sn.CLOSED:l.some(c=>c==="closed")?this.state=sn.CLOSING:l.every(c=>c==="new")&&(this.state=sn.NEW),a!==this.state&&(this.log.debug("pc state change: from ".concat(sn[a]," to ").concat(sn[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=ys((i=r.loggerName)!==null&&i!==void 0?i:yo.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const o={optional:[{googDscp:!0}]};this.publisher=new oA(e,o,r),this.subscriber=new oA(e,void 0,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,Vn.PUBLISHER)},this.subscriber.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,Vn.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var a;(a=this.onDataChannel)===null||a===void 0||a.call(this,s)},this.subscriber.onTrack=s=>{var a;(a=this.onTrack)===null||a===void 0||a.call(this,s)},this.publisher.onOffer=s=>{var a;(a=this.onPublisherOffer)===null||a===void 0||a.call(this,s)},this.state=sn.NEW,this.connectionLock=new Oi}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return V(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return V(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return V(this,void 0,void 0,function*(){n===Vn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return V(this,void 0,void 0,function*(){return this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){var r;return V(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(o=>this.ensureTransportConnected(o,e,n)))}finally{i()}})}negotiate(e){return V(this,void 0,void 0,function*(){return new Promise((n,r)=>V(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),o=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",o),this.publisher.once(ic.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(ic.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(s=>{clearTimeout(i),r(s)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===Vn.PUBLISHER?this.publisher.getConnectedAddress():e===Vn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return V(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((o,s)=>V(this,void 0,void 0,function*(){const a=()=>{this.log.warn("abort transport connection",this.logContext),kn.clearTimeout(l),s(new vt("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&a(),n==null||n.signal.addEventListener("abort",a);const l=kn.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",a),s(new vt("could not establish pc connection"))},r);for(;this.state!==sn.CONNECTED;)if(yield us(50),n!=null&&n.signal.aborted){s(new vt("room connection has been cancelled",3));return}kn.clearTimeout(l),n==null||n.signal.removeEventListener("abort",a),o()}))})}}const aA="_lossy",lA="_reliable",t6=2*1e3,cA="leave-reconnect";var ui;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(ui||(ui={}));class n6 extends ko.EventEmitter{get isClosed(){return this._isClosed}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=QC.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=ui.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Xe,this.handleDataChannel=r=>{let{channel:i}=r;return V(this,void 0,void 0,function*(){if(i){if(i.label===lA)this.reliableDCSub=i;else if(i.label===aA)this.lossyDCSub=i;else return;this.log.debug("on data channel ".concat(i.id,", ").concat(i.label),this.logContext),i.onmessage=this.handleDataMessage}})},this.handleDataMessage=r=>V(this,void 0,void 0,function*(){var i,o;const s=yield this.dataProcessLock.lock();try{let a;if(r.data instanceof ArrayBuffer)a=r.data;else if(r.data instanceof Blob)a=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const l=Yi.fromBinary(new Uint8Array(a));((i=l.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(Ae.ActiveSpeakersUpdate,l.value.value.speakers):((o=l.value)===null||o===void 0?void 0:o.case)==="user"&&this.emit(Ae.DataPacketReceived,l.value.value,l.kind)}finally{s()}}),this.handleDataError=r=>{const o=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:s}=r.error;this.log.error("DataChannel error on ".concat(o,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:s}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const o=r.currentTarget.maxRetransmits===0?on.LOSSY:on.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const o=l=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(l,"ms. giving up"),this.logContext),this.emit(Ae.Disconnected),this.close()},s=Date.now()-this.reconnectStart;let a=this.getNextRetryDelay({elapsedMs:s,retryCount:this.reconnectAttempts});if(a===null){o(s);return}r===cA&&(a=0),this.log.debug("reconnecting in ".concat(a,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=kn.setTimeout(()=>this.attemptReconnect(i),a)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===ui.Connected&&r();const o=()=>{this.off(Ae.Disconnected,s),r()},s=()=>{this.off(Ae.Restarted,o),i()};this.once(Ae.Restarted,o),this.once(Ae.Disconnected,s)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(Ae.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Gt.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(No.RR_SIGNAL_DISCONNECTED))},this.log=ys((n=e.loggerName)!==null&&n!==void 0?n:yo.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new YC(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Oi,this.dataProcessLock=new Oi,this.dcBufferStatus=new Map([[on.LOSSY,!0],[on.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(Ae.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(Ae.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(Ae.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(Ae.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(Ae.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(Ae.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(Ae.StreamStateChanged,r)}get logContext(){var e,n,r,i,o,s;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomSid:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,identity:(s=(o=this.latestJoinResponse)===null||o===void 0?void 0:o.participant)===null||s===void 0?void 0:s.identity}}join(e,n,r,i){return V(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.pcManager||(yield this.configure(o)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=o.clientConfiguration,o}catch(o){if(o instanceof vt&&o.reason===1&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw o}})}close(){return V(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(Ae.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return V(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return V(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new $i("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new vt("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:o=>{clearTimeout(i),n(o)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return V(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var n;return V(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==sn.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new e6(r,e.subscriberPrimary,this.loggerOptions),this.emit(Ae.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,o)=>{this.client.sendIceCandidate(i,o)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,o,s)=>V(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(i),this.logContext),i===sn.CONNECTED){const a=this.pcState===ui.New;this.pcState=ui.Connected,a&&this.emit(Ae.Connected,e)}else i===sn.FAILED&&this.pcState===ui.Connected&&(this.pcState=ui.Disconnected,this.handleDisconnect("peerconnection failed",s==="failed"?No.RR_SUBSCRIBER_FAILED:No.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(Ae.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>V(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>V(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Ae.LocalTrackUnpublished,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(Ae.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Ae.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",No.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(cA)):(this.emit(Ae.Disconnected,e==null?void 0:e.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason}))}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(o=>{const s={urls:o.urls};o.username&&(s.username=o.username),o.credential&&(s.credential=o.credential),i.push(s)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Li.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(aA,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(lA,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,n,r){if(!("getCapabilities"in RTCRtpReceiver))return;const i=RTCRtpReceiver.getCapabilities(n);if(!i)return;this.log.debug("get receiver capabilities",Object.assign(Object.assign({},this.logContext),{cap:i}));const o=[],s=[],a=[];i.codecs.forEach(l=>{const c=l.mimeType.toLowerCase();if(c==="audio/opus"){o.push(l);return}if(!(c==="video/".concat(r))){a.push(l);return}if(r==="h264"){l.sdpFmtpLine&&l.sdpFmtpLine.includes("profile-level-id=42e01f")?o.push(l):s.push(l);return}o.push(l)}),R9(e)&&e.setCodecPreferences(o.concat(s,a))}createSender(e,n,r){return V(this,void 0,void 0,function*(){if($w())return yield this.createTransceiverRTCRtpSender(e,n,r);if(Kw())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new rn("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return V(this,void 0,void 0,function*(){if($w())return this.createSimulcastTransceiverSender(e,n,r,i);if(Kw())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new rn("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return V(this,void 0,void 0,function*(){if(!this.pcManager)throw new rn("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const o={direction:"sendonly",streams:i};r&&(o.sendEncodings=r);const s=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,o);return e.kind===Q.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(s,e.kind,n.videoCodec),e.codec=n.videoCodec),s.sender})}createSimulcastTransceiverSender(e,n,r,i){return V(this,void 0,void 0,function*(){if(!this.pcManager)throw new rn("publisher is closed");const o={direction:"sendonly"};i&&(o.sendEncodings=i);const s=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,o);if(r.videoCodec)return this.setPreferredCodec(s,e.kind,r.videoCodec),e.setSimulcastTrackSender(r.videoCodec,s.sender),s.sender})}createRTCRtpSender(e){return V(this,void 0,void 0,function*(){if(!this.pcManager)throw new rn("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var n,r,i;return V(this,void 0,void 0,function*(){if(!this._isClosed){if(this.attemptingReconnect){Xe.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Li.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:sn.NEW)===sn.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(o){this.reconnectAttempts+=1;let s=!0;o instanceof rn?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:o})),s=!1):o instanceof kl||(this.fullReconnectOnNext=!0),s?this.handleDisconnect("reconnect",No.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Ae.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){var n,r,i;return V(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new rn("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Ae.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let o;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new kl;o=yield this.join(e??this.url,this.token,this.signalOpts)}catch(s){throw s instanceof vt&&s.reason===0?new rn("could not reconnect, token might be expired"):new kl}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Ae.SignalRestarted,o),yield this.waitForPCReconnected(),this.client.currentState!==Gt.CONNECTED)throw new kl("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(Ae.Restarted)}catch(o){const s=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(s){yield this.restartConnection(s);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),o}})}resumeConnection(e){var n;return V(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new rn("could not reconnect, url or token not saved");if(!this.pcManager)throw new rn("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Ae.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,this.log.error(r.message,Object.assign(Object.assign({},this.logContext),{error:r}))),r instanceof vt&&r.reason===0?new rn("could not reconnect, token might be expired"):r instanceof vt&&r.reason===4?r:new kl(i)}if(this.emit(Ae.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Gt.CONNECTED)throw new kl("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(Ae.Resumed)})}waitForPCInitialConnection(e,n){return V(this,void 0,void 0,function*(){if(!this.pcManager)throw new rn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return V(this,void 0,void 0,function*(){this.pcState=ui.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield us(t6),!this.pcManager)throw new rn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=ui.Connected}catch(e){throw this.pcState=ui.Disconnected,new vt("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,n){return V(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return V(this,void 0,void 0,function*(){if(!this.pcManager)throw new rn("PC manager is closed");const i=n?this.pcManager.subscriber:this.pcManager.publisher,o=n?"Subscriber":"Publisher";if(!i)throw new vt("".concat(o," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const s=this.dataChannelForKind(e,n);if((s==null?void 0:s.readyState)==="open")return;const a=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<a;){if(i.isICEConnected&&((r=this.dataChannelForKind(e,n))===null||r===void 0?void 0:r.readyState)==="open")return;yield us(50)}throw new vt("could not establish ".concat(o," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(e){return V(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==sn.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return V(this,void 0,void 0,function*(){return new Promise((e,n)=>V(this,void 0,void 0,function*(){if(!this.pcManager){n(new L0("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(Ae.Closing,i),this.pcManager.publisher.once(ic.RTPVideoPayloadTypes,o=>{const s=new Map;o.forEach(a=>{const l=a.codec.toLowerCase();D9(l)&&s.set(a.payload,l)}),this.emit(Ae.RTPVideoMapUpdate,s)});try{yield this.pcManager.negotiate(r),e()}catch(o){o instanceof L0&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",No.RR_UNKNOWN),n(o)}finally{this.off(Ae.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===on.LOSSY)return this.lossyDCSub;if(e===on.RELIABLE)return this.reliableDCSub}else{if(e===on.LOSSY)return this.lossyDC;if(e===on.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const o=this.pcManager.subscriber.getLocalDescription(),s=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,l=new Array;e.forEach(c=>{c.isDesired!==a&&l.push(c.trackSid)}),this.client.sendSyncState(new fo({answer:o?wp({sdp:o.sdp,type:o.type}):void 0,offer:s?wp({sdp:s.sdp,type:s.type}):void 0,subscription:new ei({trackSids:l,subscribe:!a,participantTracks:[]}),publishTracks:b9(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new ho({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(on.LOSSY),Vn.PUBLISHER),n(this.dataChannelForKind(on.RELIABLE),Vn.PUBLISHER),n(this.dataChannelForKind(on.LOSSY,!0),Vn.SUBSCRIBER),n(this.dataChannelForKind(on.RELIABLE,!0),Vn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&kn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Sr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Sr()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class kl extends Error{}class uA{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return V0(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return V(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),Xe.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return V(this,void 0,void 0,function*(){const n=yield fetch("".concat(r6(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new vt("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function r6(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}const qC=2e3;function cg(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}class fr extends Ec{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(e,Q.Kind.Audio,n,r,o),this.stopOnMute=!1,this.monitorSender=()=>V(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}s&&this.prevStats&&(this._currentBitrate=cg(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return V(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||$a(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return V(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Q.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return V(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==$a(this._constraints.deviceId);return this.source===Q.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return V(this,void 0,void 0,function*(){let n;if(e){const r=lg({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return V(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){Sr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},qC)))}setProcessor(e){var n;return V(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return V(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return V(this,void 0,void 0,function*(){const e=yield C9(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(ye.AudioSilenceDetected)),e})}}function yP(t,e,n){switch(t.kind){case"audio":return new fr(t,e,!1,void 0,n);case"video":return new Kr(t,e,!1,n);default:throw new $i("unsupported track type: ".concat(t.kind))}}const i6=Object.values(Pd),o6=Object.values(B0),s6=Object.values($C),a6=[Pd.h180,Pd.h360],l6=[B0.h180,B0.h360],c6=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var r,i;return new ut(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=n.fps)!==null&&i!==void 0?i:30))))),n.fps,t.encoding.priority)}),W0=["q","h","f"];function j0(t,e,n,r){var i,o;let s=r==null?void 0:r.videoEncoding;t&&(s=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,l=r==null?void 0:r.scalabilityMode,c=r==null?void 0:r.videoCodec;if(!s&&!a&&!l||!e||!n)return[{}];s||(s=d6(t,e,n,c),Xe.debug("using video encoding",s));const u=new ut(e,n,s.maxBitrate,s.maxFramerate,s.priority);if(l&&$u(c)){Xe.debug("using svc with scalabilityMode ".concat(l));const h=new CP(l),p=[];if(h.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(l));for(let g=0;g<h.spatial;g+=1)p.push({rid:W0[2-g],maxBitrate:s.maxBitrate/Math.pow(3,g),maxFramerate:u.encoding.maxFramerate});return p[0].scalabilityMode=l,Xe.debug("encodings",p),p}if(!a)return[s];let d=[];t?d=(i=fA(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:dA(t,u):d=(o=fA(r==null?void 0:r.videoSimulcastLayers))!==null&&o!==void 0?o:dA(t,u);let f;if(d.length>0){const h=d[0];d.length>1&&([,f]=d);const p=Math.max(e,n);if(p>=960&&f)return Tm(e,n,[h,f,u]);if(p>=480)return Tm(e,n,[h,u])}return Tm(e,n,[u])}function u6(t,e,n){var r,i,o,s;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&Xe.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const a=t.mediaStreamTrack.getSettings(),l=(r=a.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,c=(o=a.height)!==null&&o!==void 0?o:(s=t.dimensions)===null||s===void 0?void 0:s.height;return j0(t.source===Q.Source.ScreenShare,l,c,n)}function d6(t,e,n,r){const i=f6(t,e,n);let{encoding:o}=i[0];const s=Math.max(e,n);for(let a=0;a<i.length;a+=1){const l=i[a];if(o=l.encoding,l.width>=s)break}if(r)switch(r){case"av1":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.7;break;case"vp9":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.85;break}return o}function f6(t,e,n){if(t)return s6;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?i6:o6}function dA(t,e){if(t)return c6(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?a6:l6}function Tm(t,e,n){const r=[];if(n.forEach((i,o)=>{if(o>=W0.length)return;const s=Math.min(t,e),l={rid:W0[o],scaleResolutionDownBy:Math.max(1,s/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(l.maxFramerate=i.encoding.maxFramerate);const c=kc()||o===0;i.encoding.priority&&c&&(l.priority=i.encoding.priority,l.networkPriority=i.encoding.priority),r.push(l)}),ll()&&dP()==="ios"){let i;r.forEach(s=>{i?s.maxFramerate&&s.maxFramerate>i&&(i=s.maxFramerate):i=s.maxFramerate});let o=!0;r.forEach(s=>{var a;s.maxFramerate!=i&&(o&&(o=!1,Xe.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Xe.info('Setting framerate of encoding "'.concat((a=s.rid)!==null&&a!==void 0?a:"",'" to ').concat(i)),s.maxFramerate=i)})}return r}function fA(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class CP{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const h6=5e3;class Kr extends Ec{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,Q.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.monitorSender=()=>V(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}const s=new Map(o.map(a=>[a.rid,a]));if(this.prevStats){let a=0;s.forEach((l,c)=>{var u;const d=(u=this.prevStats)===null||u===void 0?void 0:u.get(c);a+=cg(l,d)}),this._currentBitrate=a}this.prevStats=s}),this.senderLock=new Oi}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!Sr())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},qC))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,r,i,o,s;return V(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var a=!0,l=Tl(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0)o=c.value,a=!1,yield(s=o.sender)===null||s===void 0?void 0:s.replaceTrack(null)}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,r,i,o,s;return V(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var a=!0,l=Tl(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0){o=c.value,a=!1;const u=o;yield(s=u.sender)===null||s===void 0?void 0:s.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return V(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return V(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return V(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var o;if(i.type==="outbound-rtp"){const s={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(o=i.rid)!==null&&o!==void 0?o:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},a=r.get(i.remoteId);a&&(s.jitter=a.jitter,s.packetsLost=a.packetsLost,s.roundTripTime=a.roundTripTime),n.push(s)}}),n})}setPublishingQuality(e){const n=[];for(let r=cn.LOW;r<=cn.HIGH;r+=1)n.push(new Pi({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(n)}setDeviceId(e){return V(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===$a(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||$a(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var n,r,i,o;return V(this,void 0,void 0,function*(){let s;if(e){const u=lg({video:e});typeof u.video!="boolean"&&(s=u.video)}yield this.restart(s);try{for(var a=!0,l=Tl(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0){o=c.value,a=!1;const u=o;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,o,s,a,l,c;return V(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,e,n),!((l=this.processor)===null||l===void 0)&&l.processedTrack)try{for(var u=!0,d=Tl(this.simulcastCodecs.values()),f;f=yield d.next(),i=f.done,!i;u=!0)a=f.value,u=!1,yield(c=a.sender)===null||c===void 0?void 0:c.replaceTrack(this.processor.processedTrack)}catch(h){o={error:h}}finally{try{!u&&!i&&(s=d.return)&&(yield s.call(d))}finally{if(o)throw o.error}}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},h6))}setPublishingCodecs(e){var n,r,i,o,s,a,l;return V(this,void 0,void 0,function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(n=!0,r=Tl(e);i=yield r.next(),o=i.done,!o;n=!0){l=i.value,n=!1;const u=l;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(this.log.debug("try setPublishingCodec for ".concat(u.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const f of u.qualities)if(f.enabled){c.push(u.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(u.codec),this.logContext),yield hA(d.sender,d.encodings,u.qualities,this.senderLock,this.log,this.logContext))}}}catch(u){s={error:u}}finally{try{!n&&!o&&(a=r.return)&&(yield a.call(r))}finally{if(s)throw s.error}}return c})}setPublishingLayers(e){return V(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield hA(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return V(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),cP()&&this.isInBackground&&this.source===Q.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function hA(t,e,n,r,i,o){return V(this,void 0,void 0,function*(){const s=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:t,qualities:n,senderEncodings:e}));try{const a=t.getParameters(),{encodings:l}=a;if(!l)return;if(l.length!==e.length){i.warn("cannot set publishing layers, encodings mismatch");return}let c=!1;!1&&l[0].scalabilityMode||l.forEach((d,f)=>{var h;let p=(h=d.rid)!==null&&h!==void 0?h:"";p===""&&(p="q");const g=IP(p),C=n.find(m=>m.quality===g);C&&d.active!==C.enabled&&(c=!0,d.active=C.enabled,i.debug("setting layer ".concat(C.quality," to ").concat(d.active?"enabled":"disabled"),o),kc()&&(C.enabled?(d.scaleResolutionDownBy=e[f].scaleResolutionDownBy,d.maxBitrate=e[f].maxBitrate,d.maxFrameRate=e[f].maxFrameRate):(d.scaleResolutionDownBy=4,d.maxBitrate=10,d.maxFrameRate=2)))}),c&&(a.encodings=l,i.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:a.encodings})),yield t.setParameters(a))}finally{s()}})}function IP(t){switch(t){case"f":return cn.HIGH;case"h":return cn.MEDIUM;case"q":return cn.LOW;default:return cn.HIGH}}function pA(t,e,n,r){if(!n)return[new tr({quality:cn.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,o=new CP(i),s=[];for(let a=0;a<o.spatial;a+=1)s.push(new tr({quality:cn.HIGH-a,width:Math.ceil(t/Math.pow(2,a)),height:Math.ceil(e/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return s}return n.map(i=>{var o,s,a;const l=(o=i.scaleResolutionDownBy)!==null&&o!==void 0?o:1;let c=IP((s=i.rid)!==null&&s!==void 0?s:"");return new tr({quality:c,width:Math.ceil(t/l),height:Math.ceil(e/l),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class SP extends Q{constructor(e,n,r,i,o){super(e,r,o),this.sid=n,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ye.Muted:ye.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(ye.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return V(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),qC))}}class Ka extends SP{constructor(e,n,r,i,o,s){super(e,n,Q.Kind.Audio,r,s),this.monitorReceiver=()=>V(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=cg(a,this.prevStats)),this.prevStats=a}),this.audioContext=i,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;ll()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(ll())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return V(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(U0(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&U0(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(ye.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(ye.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return V(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const Rm=100;class Ju extends SP{constructor(e,n,r,i,o){super(e,n,Q.Kind.Video,r,o),this.elementInfos=[],this.monitorReceiver=()=>V(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=cg(s,this.prevStats)),this.prevStats=s}),this.debouncedHandleResize=XC(()=>{this.updateDimensions()},Rm),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?rc(this._mediaStreamTrack,n):jl(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new p6(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return V(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(o=>{o.type==="inbound-rtp"?(r=o.codecId,n={type:"video",framesDecoded:o.framesDecoded,framesDropped:o.framesDropped,framesReceived:o.framesReceived,packetsReceived:o.packetsReceived,packetsLost:o.packetsLost,frameWidth:o.frameWidth,frameHeight:o.frameHeight,pliCount:o.pliCount,firCount:o.firCount,nackCount:o.nackCount,jitter:o.jitter,timestamp:o.timestamp,bytesReceived:o.bytesReceived,decoderImplementation:o.decoderImplementation}):o.type==="codec"&&i.set(o.id,o)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return V(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((a,l)=>Math.max(a,l.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,o=this.elementInfos.some(a=>a.pictureInPicture),s=this.elementInfos.some(a=>a.visible)&&!i||o;if(this.lastVisible!==s){if(!s&&Date.now()-r<Rm){kn.setTimeout(()=>{this.updateVisibility()},Rm);return}this.lastVisible=s,this.emit(ye.VisibilityChanged,s,this)}}updateDimensions(){var e,n;let r=0,i=0;const o=this.getPixelDensity();for(const s of this.elementInfos){const a=s.width()*o,l=s.height()*o;a+l>r+i&&(r=a,i=l)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(ye.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?Jw():n||(Jw()>2?2:1)}}class p6{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:o,isIntersecting:s}=r;o===this.element&&(this.isIntersecting=s,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??gA(e),this.isPiP=Sr()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=gA(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,Qw().observe(this.element),Yw().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,n;(e=Qw())===null||e===void 0||e.unobserve(this.element),(n=Yw())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function gA(t){let e=t.offsetTop,n=t.offsetLeft;const r=t.offsetWidth,i=t.offsetHeight,{hidden:o}=t,{opacity:s,display:a}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+i>window.pageYOffset&&n+r>window.pageXOffset&&!o&&(s!==""?parseFloat(s)>0:!0)&&a!=="none"}class _o extends ko.EventEmitter{constructor(e,n,r,i){var o;super(),this.metadataMuted=!1,this.encryption=wn.NONE,this.log=Xe,this.handleMuted=()=>{this.emit(ye.Muted)},this.handleUnmuted=()=>{this.emit(ye.Unmuted)},this.log=ys((o=i==null?void 0:i.loggerName)!==null&&o!==void 0?o:yo.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=Q.Source.Unknown}setTrack(e){this.track&&(this.track.off(ye.Muted,this.handleMuted),this.track.off(ye.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(ye.Muted,this.handleMuted),e.on(ye.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),At(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==wn.NONE}get audioTrack(){if(this.track instanceof fr||this.track instanceof Ka)return this.track}get videoTrack(){if(this.track instanceof Kr||this.track instanceof Ju)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Q.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Q.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(_o||(_o={}));class Nd extends _o{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(ye.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(ye.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(ye.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return V(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return V(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return V(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return V(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var Qr;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(Qr||(Qr={}));function g6(t){switch(t){case Bo.EXCELLENT:return Qr.Excellent;case Bo.GOOD:return Qr.Good;case Bo.POOR:return Qr.Poor;case Bo.LOST:return Qr.Lost;default:return Qr.Unknown}}class bP extends ko.EventEmitter{get logContext(){var e,n;return Object.assign(Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,n;return(n=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&n!==void 0?n:!1}constructor(e,n,r,i,o){var s;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Qr.Unknown,this.log=Xe,this.log=ys((s=o==null?void 0:o.loggerName)!==null&&s!==void 0?s:yo.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,n]of this.tracks)if(n.source===e)return n}getTrackByName(e){for(const[,n]of this.tracks)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrack(Q.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrack(Q.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(Q.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(ae.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(ae.ParticipantNameChanged,e)}setPermissions(e){var n,r,i,o,s;const a=this.permissions,l=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((o=this.permissions)===null||o===void 0?void 0:o.hidden)||e.recorder!==((s=this.permissions)===null||s===void 0?void 0:s.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((c,u)=>{var d;return c!==((d=this.permissions)===null||d===void 0?void 0:d.canPublishSources[u])});return this.permissions=e,l&&this.emit(ae.ParticipantPermissionsChanged,a),l}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(ae.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=g6(e),n!==this._connectionQuality&&this.emit(ae.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(n=>(n.track instanceof Ka||n.track instanceof fr)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(ye.Muted,()=>{this.emit(ae.TrackMuted,e)}),e.on(ye.Unmuted,()=>{this.emit(ae.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case Q.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case Q.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function m6(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new co({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}class eI extends _o{constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=cn.HIGH,this.handleEnded=o=>{this.setTrack(void 0),this.emit(ye.Ended,o)},this.handleVisibilityChange=o=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(o),this.logContext),this.disabled=!o,this.emitTrackUpdate()},this.handleVideoDimensionsChange=o=>{this.log.debug("adaptivestream video dimensions ".concat(o.width,"x").concat(o.height),this.logContext),this.videoDimensions=o,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new ei({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new eo({participantSid:"",trackSids:[this.trackSid]})]});this.emit(ye.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?_o.SubscriptionStatus.Unsubscribed:super.isSubscribed?_o.SubscriptionStatus.Subscribed:_o.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?_o.PermissionStatus.Allowed:_o.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof Ju&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof Ju&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(ye.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(ye.VisibilityChanged,this.handleVisibilityChange),i.off(ye.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(ye.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(ye.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(ye.VisibilityChanged,this.handleVisibilityChange),e.on(ye.Ended,this.handleEnded),this.emit(ye.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(ye.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?ye.Muted:ye.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(ye.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(ye.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===Q.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof Ju&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new oo({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=cn.HIGH,this.emit(ye.UpdateSettings,e)}}class _d extends bP{static fromParticipantInfo(e,n){return new _d(e,n.sid,n.identity,n.name,n.metadata)}constructor(e,n,r,i,o,s){super(n,r||"",i,o,s),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(ye.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),At(e))),this.signalClient.sendUpdateTrackSettings(n)}),e.on(ye.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(ye.SubscriptionPermissionChanged,n=>{this.emit(ae.TrackSubscriptionPermissionChanged,e,n)}),e.on(ye.SubscriptionStatusChanged,n=>{this.emit(ae.TrackSubscriptionStatusChanged,e,n)}),e.on(ye.Subscribed,n=>{this.emit(ae.TrackSubscribed,n,e)}),e.on(ye.Unsubscribed,n=>{this.emit(ae.TrackUnsubscribed,n,e)}),e.on(ye.SubscriptionFailed,n=>{this.emit(ae.TrackSubscriptionFailed,e.trackSid,n)})}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Q.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrack(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q.Source.Microphone;const n=this.getTrack(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,o,s){let a=this.getTrackPublication(n);if(a||n.startsWith("TR")||this.tracks.forEach(u=>{!a&&e.kind===u.kind.toString()&&(a=u)}),!a){if(s===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(ae.TrackSubscriptionFailed,n);return}s===void 0&&(s=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,o,s-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),At(a))),this.emit(ae.TrackSubscriptionFailed,n);return}const l=e.kind==="video";let c;return l?c=new Ju(e,n,i,o):c=new Ka(e,n,i,this.audioContext,this.audioOutput),c.source=a.source,c.isMuted=a.isMuted,c.setMediaStream(r),c.start(),a.setTrack(c),this.volumeMap.has(a.source)&&c instanceof Ka&&c.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var o,s;let a=this.getTrackPublication(i.sid);if(a)a.updateInfo(i);else{const l=Q.kindFromProto(i.type);if(!l)return;a=new eI(l,i,(o=this.signalClient.connectOptions)===null||o===void 0?void 0:o.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(s=this.loggerOptions)===null||s===void 0?void 0:s.loggerName}),a.updateInfo(i),r.set(i.sid,a);const c=Array.from(this.tracks.values()).find(u=>u.source===(a==null?void 0:a.source));c&&a.source!==Q.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:At(c),newTrack:At(a)})),this.addTrackPublication(a)}n.set(i.sid,a)}),this.tracks.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),At(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(ae.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.tracks.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(e),r.kind){case Q.Kind.Audio:this.audioTracks.delete(e);break;case Q.Kind.Video:this.videoTracks.delete(e);break}n&&this.emit(ae.TrackUnpublished,r)}setAudioOutput(e){return V(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTracks.forEach(r=>{var i;r.track instanceof Ka&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}class Z0 extends bP{constructor(e,n,r,i){super(e,n,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=wn.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new fP)},this.handleReconnected=()=>{var o,s;(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.resolve)===null||s===void 0||s.call(o),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var o,s;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>this.log.warn(a.message,this.logContext)),(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.reject)===null||s===void 0||s.call(o,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(o=>m6(o)))},this.onTrackUnmuted=o=>{this.onTrackMuted(o,o.isUpstreamPaused)},this.onTrackMuted=(o,s)=>{if(s===void 0&&(s=!0),!o.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),At(o)));return}this.engine.updateMuteStatus(o.sid,s)},this.onTrackUpstreamPaused=o=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),At(o))),this.onTrackMuted(o,!0)},this.onTrackUpstreamResumed=o=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),At(o))),this.onTrackMuted(o,o.isMuted)},this.handleSubscribedQualityUpdate=o=>V(this,void 0,void 0,function*(){var s,a,l,c,u,d;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const f=this.videoTracks.get(o.trackSid);if(!f){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}if(o.subscribedCodecs.length>0){if(!f.videoTrack)return;const C=yield f.videoTrack.setPublishingCodecs(o.subscribedCodecs);try{for(var h=!0,p=Tl(C),g;g=yield p.next(),s=g.done,!s;h=!0){c=g.value,h=!1;const m=c;m9(m)&&(this.log.debug("publish ".concat(m," for ").concat(f.videoTrack.sid),Object.assign(Object.assign({},this.logContext),At(f))),yield this.publishAdditionalCodecForTrack(f.videoTrack,m,f.options))}}catch(m){a={error:m}}finally{try{!h&&!s&&(l=p.return)&&(yield l.call(p))}finally{if(a)throw a.error}}}else o.subscribedQualities.length>0&&(yield(d=f.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(o.subscribedQualities))}),this.handleLocalTrackUnpublished=o=>{const s=this.tracks.get(o.trackSid);if(!s){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}this.unpublishTrack(s.track)},this.handleTrackEnded=o=>V(this,void 0,void 0,function*(){if(o.source===Q.Source.ScreenShare||o.source===Q.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),At(o))),this.unpublishTrack(o);else if(o.isUserProvided)yield o.mute();else if(o instanceof fr||o instanceof Kr)try{if(Sr())try{const s=yield navigator==null?void 0:navigator.permissions.query({name:o.source===Q.Source.Camera?"camera":"microphone"});if(s&&s.state==="denied")throw this.log.warn("user has revoked access to ".concat(o.source),Object.assign(Object.assign({},this.logContext),At(o))),s.onchange=()=>{s.state!=="denied"&&(o.isMuted||o.restartTrack(),s.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}o.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),At(o))),yield o.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),At(o))),yield o.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==wn.NONE}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(Ae.RemoteMute,(n,r)=>{const i=this.tracks.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(Ae.Connected,this.handleReconnected).on(Ae.SignalRestarted,this.handleReconnected).on(Ae.SignalResumed,this.handleReconnected).on(Ae.Restarting,this.handleReconnecting).on(Ae.Resuming,this.handleReconnecting).on(Ae.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Ae.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Ae.Disconnected,this.handleDisconnected)}setMetadata(e){var n;this.engine.client.sendUpdateLocalMetadata(e,(n=this.name)!==null&&n!==void 0?n:"")}setName(e){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",e)}setCameraEnabled(e,n,r){return this.setTrackEnabled(Q.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(Q.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(Q.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(ae.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return V(this,void 0,void 0,function*(){this.encryptionType=e?wn.GCM:wn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){var o,s;return V(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n}));let a=this.getTrack(e);if(n)if(a)yield a.unmute();else{let l;if(this.pendingPublishing.has(e)){this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:e}));return}this.pendingPublishing.add(e);try{switch(e){case Q.Source.Camera:l=yield this.createTracks({video:(o=r)!==null&&o!==void 0?o:!0});break;case Q.Source.Microphone:l=yield this.createTracks({audio:(s=r)!==null&&s!==void 0?s:!0});break;case Q.Source.ScreenShare:l=yield this.createScreenTracks(Object.assign({},r));break;default:throw new $i(e)}const c=[];for(const d of l)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),At(d))),c.push(this.publishTrack(d,i));[a]=yield Promise.all(c)}catch(c){throw l==null||l.forEach(u=>{u.stop()}),c instanceof Error&&!(c instanceof $i)&&this.emit(ae.MediaDevicesError,c),c}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===Q.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const l=this.getTrack(Q.Source.ScreenShareAudio);l&&l.track&&this.unpublishTrack(l.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return V(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Q.Source.Camera)||this.pendingPublishing.has(Q.Source.Microphone))){this.pendingPublishing.add(Q.Source.Camera),this.pendingPublishing.add(Q.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(Q.Source.Camera),this.pendingPublishing.delete(Q.Source.Microphone)}}})}createTracks(e){var n,r;return V(this,void 0,void 0,function*(){const i=aP(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),o=lg(i);let s;try{s=yield navigator.mediaDevices.getUserMedia(o)}catch(a){throw a instanceof Error&&(o.audio&&(this.microphoneError=a),o.video&&(this.cameraError=a)),a}return o.audio&&(this.microphoneError=void 0,this.emit(ae.AudioStreamAcquired)),o.video&&(this.cameraError=void 0),s.getTracks().map(a=>{const l=a.kind==="audio";l?e.audio:e.video;let c;const u=l?o.audio:o.video;typeof u!="boolean"&&(c=u);const d=yP(a,c,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return d.kind===Q.Kind.Video?d.source=Q.Source.Camera:d.kind===Q.Kind.Audio&&(d.source=Q.Source.Microphone),d.mediaStream=s,d})})}createScreenTracks(e){return V(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new zC("getDisplayMedia not supported");e.resolution===void 0&&!P9()&&(e.resolution=$C.h1080fps30.resolution);const n=S9(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new $i("no video track found");const o=new Kr(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=Q.Source.ScreenShare,e.contentHint&&(o.mediaStreamTrack.contentHint=e.contentHint);const s=[o];if(r.getAudioTracks().length>0){this.emit(ae.AudioStreamAcquired);const a=new fr(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=Q.Source.ScreenShareAudio,s.push(a)}return s})}publishTrack(e,n){var r,i,o,s;return V(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,e instanceof Ec&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let a;if(e instanceof MediaStreamTrack)a=e.getConstraints();else{a=e.constraints;let h;switch(e.source){case Q.Source.Microphone:h="audioinput";break;case Q.Source.Camera:h="videoinput"}h&&this.activeDeviceMap.has(h)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(h)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new fr(e,a,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":e=new Kr(e,a,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new $i("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e instanceof fr&&e.setAudioContext(this.audioContext);let l;if(this.tracks.forEach(h=>{h.track&&h.track===e&&(l=h)}),l)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),At(l))),l;const c="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,u=(i=n==null?void 0:n.forceStereo)!==null&&i!==void 0?i:c;u&&(n||(n={}),n.dtx===void 0&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),At(e))),n.red===void 0&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(o=n.dtx)!==null&&o!==void 0||(n.dtx=!1),(s=n.red)!==null&&s!==void 0||(n.red=!1));const d=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);al()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),d.simulcast=!1),d.source&&(e.source=d.source);const f=this.publish(e,d,u);this.pendingPublishPromises.set(e,f);try{return yield f}catch(h){throw h}finally{this.pendingPublishPromises.delete(e)}})}publish(e,n,r){var i,o,s,a,l,c,u,d,f,h,p,g,C;return V(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(T=>e instanceof Ec&&T.source===e.source)&&e.source!==Q.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),At(e))),n.stopMicTrackOnMute&&e instanceof fr&&(e.stopOnMute=!0),e.source===Q.Source.ScreenShare&&kc()&&(n.simulcast=!1),n.videoCodec==="av1"&&!k9()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!E9()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=G0);const v=n.videoCodec;e.on(ye.Muted,this.onTrackMuted),e.on(ye.Unmuted,this.onTrackUnmuted),e.on(ye.Ended,this.handleTrackEnded),e.on(ye.UpstreamPaused,this.onTrackUpstreamPaused),e.on(ye.UpstreamResumed,this.onTrackUpstreamResumed);const S=new Ei({cid:e.mediaStreamTrack.id,name:n.name,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((o=n.red)!==null&&o!==void 0)||o),stream:n==null?void 0:n.stream});let E;if(e.kind===Q.Kind.Video){let T={width:0,height:0};try{T=yield e.waitForDimensions()}catch{const O=(a=(s=this.roomOptions.videoCaptureDefaults)===null||s===void 0?void 0:s.resolution)!==null&&a!==void 0?a:Pd.h720.resolution;T={width:O.width,height:O.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),At(e)),{dims:T}))}S.width=T.width,S.height=T.height,e instanceof Kr&&($u(v)&&(e.source===Q.Source.ScreenShare&&v==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(l=n.scalabilityMode)!==null&&l!==void 0?l:"L3T3_KEY"),S.simulcastCodecs=[new ki({codec:v,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:G0}),n.backupCodec&&v!==n.backupCodec.codec&&S.encryption===wn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),S.simulcastCodecs.push(new ki({codec:n.backupCodec.codec,cid:""})))),E=j0(e.source===Q.Source.ScreenShare,S.width,S.height,n),S.layers=pA(S.width,S.height,E,$u(n.videoCodec))}else e.kind===Q.Kind.Audio&&(E=[{maxBitrate:(u=(c=n.audioPreset)===null||c===void 0?void 0:c.maxBitrate)!==null&&u!==void 0?u:n.audioBitrate,priority:(f=(d=n.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&f!==void 0?f:"high",networkPriority:(p=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new rn("cannot publish track when not connected");const w=yield this.engine.addTrack(S);let A;if(w.codecs.forEach(T=>{A===void 0&&(A=T.mimeType)}),A&&e.kind===Q.Kind.Video){const T=lP(A);T!==v&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),At(e)),{codec:T})),n.videoCodec=T,E=j0(e.source===Q.Source.ScreenShare,S.width,S.height,n))}const x=new Nd(e.kind,w,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(x.options=n,e.sid=w.sid,!this.engine.pcManager)throw new rn("pcManager is not ready");if(this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:E,trackInfo:w})),e.sender=yield this.engine.createSender(e,n,E),E)if(kc()&&e.kind===Q.Kind.Audio){let T;for(const _ of this.engine.pcManager.publisher.getTransceivers())if(_.sender===e.sender){T=_;break}T&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:T,codec:"opus",maxbr:!((g=E[0])===null||g===void 0)&&g.maxBitrate?E[0].maxBitrate/1e3:0})}else e.codec&&$u(e.codec)&&(!((C=E[0])===null||C===void 0)&&C.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:S.cid,codec:e.codec,maxbr:E[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof Kr?e.startMonitor(this.engine.client):e instanceof fr&&e.startMonitor(),this.addTrackPublication(x),this.emit(ae.LocalTrackPublished,x),x})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){var i;return V(this,void 0,void 0,function*(){if(this.encryptionType!==wn.NONE)return;let o;if(this.tracks.forEach(d=>{d.track&&d.track===e&&(o=d)}),!o)throw new $i("track is not published");if(!(e instanceof Kr))throw new $i("track is not a video track");const s=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=u6(e,n,s);if(!a){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),At(e)));return}const l=e.addSimulcastTrack(n,a),c=new Ei({cid:l.mediaStreamTrack.id,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:s.videoCodec,cid:l.mediaStreamTrack.id}]});if(c.layers=pA(c.width,c.height,a),!this.engine||this.engine.isClosed)throw new rn("cannot publish track when not connected");const u=yield this.engine.addTrack(c);yield this.engine.createSimulcastSender(e,l,s,a),yield this.engine.negotiate(),this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:u}))})}unpublishTrack(e,n){var r,i;return V(this,void 0,void 0,function*(){const o=this.getPublicationForTrack(e),s=o?At(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),s)),!o||!o.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),s));return}e=o.track,e.off(ye.Muted,this.onTrackMuted),e.off(ye.Unmuted,this.onTrackUnmuted),e.off(ye.Ended,this.handleTrackEnded),e.off(ye.UpstreamPaused,this.onTrackUpstreamPaused),e.off(ye.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n&&e.stop();let a=!1;const l=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<sn.FAILED&&l)try{for(const c of this.engine.pcManager.publisher.getTransceivers())c.sender===l&&(c.direction="inactive",a=!0);if(this.engine.removeTrack(l)&&(a=!0),e instanceof Kr){for(const[,c]of e.simulcastCodecs)c.sender&&(this.engine.removeTrack(c.sender)&&(a=!0),c.sender=void 0);e.simulcastCodecs.clear()}}catch(c){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),s),{error:c}))}switch(this.tracks.delete(o.trackSid),o.kind){case Q.Kind.Audio:this.audioTracks.delete(o.trackSid);break;case Q.Kind.Video:this.videoTracks.delete(o.trackSid);break}return this.emit(ae.LocalTrackUnpublished,o),o.setTrack(void 0),a&&(yield this.engine.negotiate()),o})}unpublishTracks(e){return V(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof Nd)})}republishAllTracks(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return V(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(e&&(i.options=Object.assign(Object.assign({},i.options),e)),r.push(i))}),yield Promise.all(r.map(i=>V(this,void 0,void 0,function*(){const o=i.track;yield this.unpublishTrack(o,!1),n&&!o.isMuted&&o.source!==Q.Source.ScreenShare&&o.source!==Q.Source.ScreenShareAudio&&(o instanceof fr||o instanceof Kr)&&!o.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:i.trackSid})),yield o.restartTrack()),yield this.publishTrack(o,i.options)})))})}publishData(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return V(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,o=[],s=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(l=>{l instanceof _d?o.push(l.sid):o.push(l)});const a=new Yi({kind:n,value:{case:"user",value:new qi({participantSid:this.sid,payload:e,destinationSids:o,topic:s})}});yield this.engine.sendDataPacket(a,n)})}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const o=this.tracks.get(n.sid);if(o){const s=o.isMuted||((i=(r=o.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);s!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),At(o)),{mutedOnServer:s})),this.engine.client.sendMuteTrack(n.sid,s))}}),!0)}getPublicationForTrack(e){let n;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof fr||i instanceof Kr)&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}}var nt;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting"})(nt||(nt={}));const v6=2*1e3;class Ap extends ko.EventEmitter{constructor(e){var n,r,i;super(),n=this,this.state=nt.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Xe,this.bufferedEvents=[],this.connect=(o,s,a)=>V(this,void 0,void 0,function*(){var l;const c=yield this.disconnectLock.lock();if(this.state===nt.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),c(),Promise.resolve();if(this.connectFuture)return c(),this.connectFuture.promise;this.setAndEmitConnectionState(nt.Connecting),((l=this.regionUrlProvider)===null||l===void 0?void 0:l.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),V0(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new uA(o,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().catch(f=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:f}))}));const u=(f,h,p)=>V(this,void 0,void 0,function*(){var g;this.abortController&&this.abortController.abort();const C=new AbortController;this.abortController=C,c==null||c();try{yield this.attemptConnection(p??o,s,a,C),this.abortController=void 0,f()}catch(m){if(this.regionUrlProvider&&m instanceof vt&&m.reason!==3&&m.reason!==0){let v=null;try{v=yield this.regionUrlProvider.getNextBestRegionUrl((g=this.abortController)===null||g===void 0?void 0:g.signal)}catch(S){if(S instanceof vt&&(S.status===401||S.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(S);return}}v?(this.log.info("Initial connection failed with ConnectionError: ".concat(m.message,". Retrying with another region: ").concat(v),this.logContext),yield u(f,h,v)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(m))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(m)}}),d=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new fP((f,h)=>{u(f,h,d)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,s,a,l,c,u)=>V(this,void 0,void 0,function*(){var d,f,h;const p=yield a.join(o,s,{autoSubscribe:l.autoSubscribe,publishOnly:l.publishOnly,adaptiveStream:typeof c.adaptiveStream=="object"?!0:c.adaptiveStream,maxRetries:l.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:l.websocketTimeout},u.signal);let g=p.serverInfo;if(g||(g={version:p.serverVersion,region:p.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(g).map(C=>{let[m,v]=C;return"".concat(m,": ").concat(v)}).join(", ")),{room:(d=p.room)===null||d===void 0?void 0:d.name,roomSid:(f=p.room)===null||f===void 0?void 0:f.sid,identity:(h=p.participant)===null||h===void 0?void 0:h.identity}),!p.serverVersion)throw new c9("unknown server version");return p.serverVersion==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),c.dynacast=!1),p}),this.applyJoinResponse=o=>{const s=o.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(o.sifTrailer)},this.attemptConnection=(o,s,a,l)=>V(this,void 0,void 0,function*(){var c,u;this.state===nt.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((c=this.regionUrlProvider)===null||c===void 0)&&c.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},QC),a),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const d=yield this.connectSignal(o,s,this.engine,this.connOptions,this.options,l);this.applyJoinResponse(d),this.setupLocalParticipantEvents(),this.emit(ne.SignalConnected)}catch(d){yield this.engine.close(),this.recreateEngine();const f=new vt("could not establish signal connection");throw d instanceof Error&&(f.message="".concat(f.message,": ").concat(d.message)),d instanceof vt&&(f.reason=d.reason,f.status=d.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:d})),f}if(l.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new vt("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,l)}catch(d){throw yield this.engine.close(),this.recreateEngine(),d}Sr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Sr()&&(document.addEventListener("freeze",this.onPageLeave),(u=navigator.mediaDevices)===null||u===void 0||u.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(nt.Connected),this.emit(ne.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return V(n,void 0,void 0,function*(){var s,a,l,c;const u=yield this.disconnectLock.lock();try{if(this.state===nt.Disconnected){this.log.debug("already disconnected",this.logContext);return}this.log.info("disconnect from room",Object.assign({},this.logContext)),(this.state===nt.Connecting||this.state===nt.Reconnecting)&&(this.log.warn("abort connection attempt",this.logContext),(s=this.abortController)===null||s===void 0||s.abort(),(l=(a=this.connectFuture)===null||a===void 0?void 0:a.reject)===null||l===void 0||l.call(a,new vt("Client initiated disconnect")),this.connectFuture=void 0),!((c=this.engine)===null||c===void 0)&&c.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(o,cs.CLIENT_INITIATED),this.engine=void 0}finally{u()}})},this.onPageLeave=()=>V(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>V(this,void 0,void 0,function*(){const o=[],s=Cs();if(s&&s.os==="iOS"){const a="livekit-dummy-audio-el";let l=document.getElementById(a);if(!l){l=document.createElement("audio"),l.id=a,l.autoplay=!0,l.hidden=!0;const c=Am();c.enabled=!0;const u=new MediaStream([c]);l.srcObject=u,document.addEventListener("visibilitychange",()=>{l&&(l.srcObject=document.hidden?null:u,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(l),this.once(ne.Disconnected,()=>{l==null||l.remove(),l=null})}o.push(l)}this.participants.forEach(a=>{a.audioTracks.forEach(l=>{l.track&&l.track.attachedElements.forEach(c=>{o.push(c)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(a=>(a.muted=!1,a.play()))]),this.handleAudioPlaybackStarted()}catch(a){throw this.handleAudioPlaybackFailed(a),a}}),this.startVideo=()=>V(this,void 0,void 0,function*(){const o=[];for(const s of this.participants.values())s.videoTracks.forEach(a=>{var l;(l=a.track)===null||l===void 0||l.attachedElements.forEach(c=>{o.includes(c)||o.push(c)})});yield Promise.all(o.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const o of this.participants.values())this.handleParticipantDisconnected(o.sid,o);this.setAndEmitConnectionState(nt.Reconnecting)&&this.emit(ne.Reconnecting)},this.handleSignalRestarted=o=>V(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(s){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:s}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(nt.Connected),this.emit(ne.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const a=this.identityToSid.get(s.identity);a&&a!==s.sid&&this.handleParticipantDisconnected(a,this.participants.get(a));let l=this.participants.get(s.sid);const c=!l;s.state===ol.DISCONNECTED?this.handleParticipantDisconnected(s.sid,l):(l=this.getOrCreateParticipant(s.sid,s),c||l.updateInfo(s))})},this.handleActiveSpeakersUpdate=o=>{const s=[],a={};o.forEach(l=>{if(a[l.sid]=!0,l.sid===this.localParticipant.sid)this.localParticipant.audioLevel=l.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const c=this.participants.get(l.sid);c&&(c.audioLevel=l.level,c.setIsSpeaking(!0),s.push(c))}}),a[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(l=>{a[l.sid]||(l.audioLevel=0,l.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(ne.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=o=>{const s=new Map;this.activeSpeakers.forEach(l=>{s.set(l.sid,l)}),o.forEach(l=>{let c=this.participants.get(l.sid);l.sid===this.localParticipant.sid&&(c=this.localParticipant),c&&(c.audioLevel=l.level,c.setIsSpeaking(l.active),l.active?s.set(l.sid,c):s.delete(l.sid))});const a=Array.from(s.values());a.sort((l,c)=>c.audioLevel-l.audioLevel),this.activeSpeakers=a,this.emitWhenConnected(ne.ActiveSpeakersChanged,a)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(s=>{const a=this.participants.get(s.participantSid);if(!a)return;const l=a.getTrackPublication(s.trackSid);!l||!l.track||(l.track.streamState=Q.streamStateFromProto(s.state),a.emit(ae.TrackStreamStateChanged,l,l.track.streamState),this.emitWhenConnected(ne.TrackStreamStateChanged,l,l.track.streamState,a))})},this.handleSubscriptionPermissionUpdate=o=>{const s=this.participants.get(o.participantSid);if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const s=Array.from(this.participants.values()).find(l=>l.tracks.has(o.trackSid));if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setSubscriptionError(o.err)},this.handleDataPacket=(o,s)=>{const a=this.participants.get(o.participantSid);this.emit(ne.DataReceived,o.payload,a,s,o.topic),a==null||a.emit(ae.DataReceived,o.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ne.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ne.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ne.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ne.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>V(this,void 0,void 0,function*(){this.emit(ne.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const s=this.roomInfo;this.roomInfo=o,s&&s.metadata!==o.metadata&&this.emitWhenConnected(ne.RoomMetadataChanged,o.metadata),(s==null?void 0:s.activeRecording)!==o.activeRecording&&this.emitWhenConnected(ne.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const a=this.participants.get(s.participantSid);a&&a.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(ne.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(ne.ParticipantNameChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(ne.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(ne.TrackUnmuted,o,this.localParticipant)},this.onLocalTrackPublished=o=>V(this,void 0,void 0,function*(){var s;this.emit(ne.LocalTrackPublished,o,this.localParticipant),o.track instanceof fr&&(yield o.track.checkForSilence())&&this.emit(ne.LocalAudioSilenceDetected,o);const a=yield(s=o.track)===null||s===void 0?void 0:s.getDeviceId(),l=I9(o.source);l&&a&&a!==this.localParticipant.activeDeviceMap.get(l)&&(this.localParticipant.activeDeviceMap.set(l,a),this.emit(ne.ActiveDeviceChanged,l,a))}),this.onLocalTrackUnpublished=o=>{this.emit(ne.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalConnectionQualityChanged=o=>{this.emit(ne.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(ne.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(ne.ParticipantPermissionsChanged,o,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},q9),e),this.log=ys((r=this.options.loggerName)!==null&&r!==void 0?r:yo.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},mP),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},vP),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},Q9),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Oi,this.localParticipant=new Z0("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",$a(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",$a(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",$a(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return V(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new F9(this.options.e2ee),this.e2eeManager.on(Ks.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof Z0&&(this.isE2EEEnabled=n),this.emit(ne.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(Ks.EncryptionError,n=>this.emit(ne.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&n!==void 0?n:""}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new n6(this.options),this.engine.on(Ae.ParticipantUpdate,this.handleParticipantUpdates).on(Ae.RoomUpdate,this.handleRoomUpdate).on(Ae.SpeakersChanged,this.handleSpeakersChanged).on(Ae.StreamStateChanged,this.handleStreamStateUpdate).on(Ae.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Ae.SubscriptionError,this.handleSubscriptionError).on(Ae.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Ae.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(Ae.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Ae.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Ae.DataPacketReceived,this.handleDataPacket).on(Ae.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(nt.Reconnecting)&&this.emit(ne.Reconnecting)}).on(Ae.Resumed,()=>{this.setAndEmitConnectionState(nt.Connected),this.emit(ne.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()}).on(Ae.SignalResumed,()=>{this.bufferedEvents=[],this.state===nt.Reconnecting&&this.sendSyncState()}).on(Ae.Restarting,this.handleRestarting).on(Ae.SignalRestarted,this.handleSignalRestarted).on(Ae.DCBufferStatusChanged,(e,n)=>{this.emit(ne.DCBufferStatusChanged,e,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Qn.getInstance().getDevices(e,n)}prepareConnection(e,n){return V(this,void 0,void 0,function*(){if(this.state===nt.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(V0(new URL(e))&&n){this.regionUrlProvider=new uA(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===nt.Disconnected&&(this.regionUrl=r,yield fetch(eA(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(eA(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const n=this.identityToSid.get(e);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return V(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new bn({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new bn({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new bn({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new bn({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>V(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new bn({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>V(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new bn({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new bn({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>V(this,void 0,void 0,function*(){const o=this.engine.client.onLeave;o&&o(new ti({reason:cs.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new bn({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,n;return(n=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,o,s;return V(this,void 0,void 0,function*(){let a=!1,l=!0;const c=r?{exact:n}:n;if(e==="audioinput"){const u=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=c,a=u!==c;const d=Array.from(this.localParticipant.audioTracks.values()).filter(f=>f.source===Q.Source.Microphone);try{l=(yield Promise.all(d.map(f=>{var h;return(h=f.audioTrack)===null||h===void 0?void 0:h.setDeviceId(c)}))).every(f=>f===!0)}catch(f){throw this.options.audioCaptureDefaults.deviceId=u,f}}else if(e==="videoinput"){const u=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=c,a=u!==c;const d=Array.from(this.localParticipant.videoTracks.values()).filter(f=>f.source===Q.Source.Camera);try{l=(yield Promise.all(d.map(f=>{var h;return(h=f.videoTrack)===null||h===void 0?void 0:h.setDeviceId(c)}))).every(f=>f===!0)}catch(f){throw this.options.videoCaptureDefaults.deviceId=u,f}}else if(e==="audiooutput"){if(!U0()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(s=this.options).audioOutput)!==null&&i!==void 0||(s.audioOutput={});const u=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,a=u!==c;try{this.options.expWebAudioMix?(o=this.audioContext)===null||o===void 0||o.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(d=>d.setAudioOutput({deviceId:n})))}catch(d){throw this.options.audioOutput.deviceId=u,d}}return a&&l&&(this.localParticipant.activeDeviceMap.set(e,n),this.emit(ne.ActiveDeviceChanged,e,n)),l})}setupLocalParticipantEvents(){this.localParticipant.on(ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ae.TrackMuted,this.onLocalTrackMuted).on(ae.TrackUnmuted,this.onLocalTrackUnmuted).on(ae.LocalTrackPublished,this.onLocalTrackPublished).on(ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ae.MediaDevicesError,this.onMediaDevicesError).on(ae.AudioStreamAcquired,this.startAudio).on(ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===nt.Connecting||this.state===nt.Reconnecting){const u=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(ne.Reconnected,u),this.off(ne.Connected,u),this.off(ne.Disconnected,d)};this.once(ne.Reconnected,u),this.once(ne.Connected,u),this.once(ne.Disconnected,d);return}if(this.state===nt.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const i=A9(n.id),o=i[0];let s=i[1],a=e.id;if(s&&s.startsWith("TR")&&(a=s),o===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const l=this.participants.get(o);if(!l){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);return}let c;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?c=this.options.adaptiveStream:c={}),l.addSubscribedMediaTrack(e,a,n,r,c)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==nt.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(o=>{i.unpublishTrack(o.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var o,s;i.track&&this.localParticipant.unpublishTrack(i.track,e),e&&((o=i.track)===null||o===void 0||o.detach(),(s=i.track)===null||s===void 0||s.stop())}),this.localParticipant.off(ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ae.TrackMuted,this.onLocalTrackMuted).off(ae.TrackUnmuted,this.onLocalTrackUnmuted).off(ae.LocalTrackPublished,this.onLocalTrackPublished).off(ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ae.MediaDevicesError,this.onMediaDevicesError).off(ae.AudioStreamAcquired,this.startAudio).off(ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Sr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(nt.Disconnected),this.emit(ne.Disconnected,n)}}}handleParticipantDisconnected(e,n){this.participants.delete(e),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(ne.ParticipantDisconnected,n))}acquireAudioContext(){var e,n;return V(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=KC())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(ne.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=_d.fromParticipantInfo(this.engine.client,n):i=new _d(this.engine.client,e,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),i}getOrCreateParticipant(e,n){if(this.participants.has(e))return this.participants.get(e);const r=this.createParticipant(e,n);return this.participants.set(e,r),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(ne.ParticipantConnected,r),r.on(ae.TrackPublished,i=>{this.emitWhenConnected(ne.TrackPublished,i,r)}).on(ae.TrackSubscribed,(i,o)=>{i.kind===Q.Kind.Audio?(i.on(ye.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(ye.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===Q.Kind.Video&&(i.on(ye.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(ye.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ne.TrackSubscribed,i,o,r)}).on(ae.TrackUnpublished,i=>{this.emit(ne.TrackUnpublished,i,r)}).on(ae.TrackUnsubscribed,(i,o)=>{this.emit(ne.TrackUnsubscribed,i,o,r)}).on(ae.TrackSubscriptionFailed,i=>{this.emit(ne.TrackSubscriptionFailed,i,r)}).on(ae.TrackMuted,i=>{this.emitWhenConnected(ne.TrackMuted,i,r)}).on(ae.TrackUnmuted,i=>{this.emitWhenConnected(ne.TrackUnmuted,i,r)}).on(ae.ParticipantMetadataChanged,i=>{this.emitWhenConnected(ne.ParticipantMetadataChanged,i,r)}).on(ae.ParticipantNameChanged,i=>{this.emitWhenConnected(ne.ParticipantNameChanged,i,r)}).on(ae.ConnectionQualityChanged,i=>{this.emitWhenConnected(ne.ConnectionQualityChanged,i,r)}).on(ae.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(ne.ParticipantPermissionsChanged,i,r)}).on(ae.TrackSubscriptionStatusChanged,(i,o)=>{this.emitWhenConnected(ne.TrackSubscriptionStatusChanged,i,o,r)}).on(ae.TrackSubscriptionFailed,(i,o)=>{this.emit(ne.TrackSubscriptionFailed,i,r,o)}).on(ae.TrackSubscriptionPermissionChanged,(i,o)=>{this.emitWhenConnected(ne.TrackSubscriptionPermissionChanged,i,o,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.participants.values())for(const n of e.videoTracks.values())n.isSubscribed&&n instanceof eI&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=kn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,cs.STATE_MISMATCH))):e=0},v6)}clearConnectionReconcile(){this.connectionReconcileInterval&&kn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(ne.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.state===nt.Connected?this.emit(e,...r):(this.state===nt.Reconnecting&&this.bufferedEvents.push([e,r]),!1)}simulateParticipants(e){var n,r;return V(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Wc({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Ue.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Vr({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ne.SignalConnected),this.emit(ne.Connected),this.setAndEmitConnectionState(nt.Connected),i.video){const s=new Nd(Q.Kind.Video,new vr({source:Xt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Un.AUDIO,name:"video-dummy"}),new Kr(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:qw(160*((n=o.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(ae.LocalTrackPublished,s)}if(i.audio){const s=new Nd(Q.Kind.Audio,new vr({source:Xt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Un.AUDIO}),new fr(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Am(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(ae.LocalTrackPublished,s)}for(let s=0;s<o.count-1;s+=1){let a=new Vr({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(s),state:ol.ACTIVE,tracks:[],joinedAt:Ue.parse(Date.now())});const l=this.getOrCreateParticipant(a.identity,a);if(o.video){const c=qw(160*((r=o.aspectRatios[s%o.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),u=new vr({source:Xt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Un.AUDIO});l.addSubscribedMediaTrack(c,u.sid,new MediaStream([c])),a.tracks=[...a.tracks,u]}if(o.audio){const c=Am(),u=new vr({source:Xt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Un.AUDIO});l.addSubscribedMediaTrack(c,u.sid,new MediaStream([c])),a.tracks=[...a.tracks,u]}l.updateInfo(a)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(e!==ne.ActiveSpeakersChanged){const o=wP(r).filter(s=>s!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:o}))}return super.emit(e,...r)}}function wP(t){return t.map(e=>{if(e)return Array.isArray(e)?wP(e):typeof e=="object"?"logContext"in e&&e.logContext:e})}var bi;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(bi||(bi={}));class Zc extends ko.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=bi.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Ap(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return V(this,void 0,void 0,function*(){if(this.status!==bi.IDLE)throw Error("check is running already");this.setStatus(bi.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==bi.SKIPPED&&this.setStatus(this.isSuccess()?bi.SUCCESS:bi.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return V(this,void 0,void 0,function*(){return this.room.state===nt.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return V(this,void 0,void 0,function*(){this.room&&this.room.state!==nt.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(bi.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function AP(t){var e,n;return V(this,void 0,void 0,function*(){t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio=!0),(n=t.video)!==null&&n!==void 0||(t.video=!0);const r=aP(t,mP,vP),i=lg(r),o=navigator.mediaDevices.getUserMedia(i);t.audio&&(Qn.userMediaPromiseMap.set("audioinput",o),o.catch(()=>Qn.userMediaPromiseMap.delete("audioinput"))),t.video&&(Qn.userMediaPromiseMap.set("videoinput",o),o.catch(()=>Qn.userMediaPromiseMap.delete("videoinput")));const s=yield o;return s.getTracks().map(a=>{const l=a.kind==="audio";l?t.audio:t.video;let c;const u=l?i.audio:i.video;typeof u!="boolean"&&(c=u),c?c.deviceId=a.getSettings().deviceId:c={deviceId:a.getSettings().deviceId};const d=yP(a,c);return d.kind===Q.Kind.Video?d.source=Q.Source.Camera:d.kind===Q.Kind.Audio&&(d.source=Q.Source.Microphone),d.mediaStream=s,d})})}function y6(t){return V(this,void 0,void 0,function*(){return(yield AP({audio:!1,video:t}))[0]})}function C6(t){return V(this,void 0,void 0,function*(){return(yield AP({audio:t,video:!1}))[0]})}class I6 extends Zc{get description(){return"Can publish audio"}perform(){var e;return V(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield C6();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="audio"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," audio packets"))})}}class S6 extends Zc{get description(){return"Can publish video"}perform(){var e;return V(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield y6();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="video"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," video packets"))})}}class b6 extends Zc{get description(){return"Resuming connection after interruption"}perform(){var e;return V(this,void 0,void 0,function*(){const n=yield this.connect();let r=!1,i=!1,o;const s=new Promise(l=>{setTimeout(l,5e3),o=l});n.on(ne.Reconnecting,()=>{r=!0}).on(ne.Reconnected,()=>{i=!0,o(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const a=n.engine.client.onClose;if(a&&a(""),yield s,r){if(!i||n.state!==nt.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class w6 extends Zc{get description(){return"Can connect via TURN"}perform(){var e,n;return V(this,void 0,void 0,function*(){const r=new YC,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let o=!1,s=!1,a=!1;for(let l of i.iceServers)for(let c of l.urls)c.startsWith("turn:")?(s=!0,a=!0):c.startsWith("turns:")&&(s=!0,a=!0,o=!0),c.startsWith("stun:")&&(a=!0);a?s&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||s?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(l=>setTimeout(l,0)))})}}class A6 extends Zc{get description(){return"Establishing WebRTC connection"}perform(){return V(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(ne.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,o)=>{if(i.candidate){const s=new RTCIceCandidate(i);let a="".concat(s.protocol," ").concat(s.address,":").concat(s.port," ").concat(s.type);s.address&&(k6(s.address)?a+=" (private)":s.protocol==="tcp"&&s.tcpType==="passive"?(e=!0,a+=" (passive)"):s.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,o)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),Xe.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function k6(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class E6 extends Zc{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,n,r;return V(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new YC;const o=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(o.serverVersion,".")),((e=o.serverInfo)===null||e===void 0?void 0:e.edition)===wc.Cloud&&(!((n=o.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=o.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class yz extends ko.EventEmitter{constructor(e,n){super(),this.checkResults=new Map,this.url=e,this.token=n}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:bi.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==bi.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return V(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token),i=s=>{this.updateCheck(n,s)};r.on("update",i);const o=yield r.run();return r.off("update",i),o})}checkWebsocket(){return V(this,void 0,void 0,function*(){return this.createAndRunCheck(E6)})}checkWebRTC(){return V(this,void 0,void 0,function*(){return this.createAndRunCheck(A6)})}checkTURN(){return V(this,void 0,void 0,function*(){return this.createAndRunCheck(w6)})}checkReconnect(){return V(this,void 0,void 0,function*(){return this.createAndRunCheck(b6)})}checkPublishAudio(){return V(this,void 0,void 0,function*(){return this.createAndRunCheck(I6)})}checkPublishVideo(){return V(this,void 0,void 0,function*(){return this.createAndRunCheck(S6)})}}function T6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=t instanceof Ec?t.mediaStreamTrack:t,i=r.getSettings();let o={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const s=i.facingMode;Xe.debug("rawFacingMode",{rawFacingMode:s}),s&&typeof s=="string"&&P6(s)&&(o={facingMode:s,confidence:"high"})}if(["low","medium"].includes(o.confidence)){Xe.debug("Try to get facing mode from device label: (".concat(r.label,")"));const s=x6(r.label);s!==void 0&&(o=s)}return o}const mA=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),R6=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function x6(t){var e;const n=t.trim().toLowerCase();if(n!=="")return mA.has(n)?mA.get(n):(e=Array.from(R6.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||e===void 0?void 0:e[1]}function P6(t){return t===void 0||["user","environment","left","right"].includes(t)}const H0=Math.min,oc=Math.max,kp=Math.round,ua=t=>({x:t,y:t}),N6={left:"right",right:"left",bottom:"top",top:"bottom"},_6={start:"end",end:"start"};function vA(t,e,n){return oc(t,H0(e,n))}function ug(t,e){return typeof t=="function"?t(e):t}function cl(t){return t.split("-")[0]}function dg(t){return t.split("-")[1]}function kP(t){return t==="x"?"y":"x"}function EP(t){return t==="y"?"height":"width"}function Tc(t){return["top","bottom"].includes(cl(t))?"y":"x"}function TP(t){return kP(Tc(t))}function O6(t,e,n){n===void 0&&(n=!1);const r=dg(t),i=TP(t),o=EP(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=Ep(s)),[s,Ep(s)]}function M6(t){const e=Ep(t);return[z0(t),e,z0(e)]}function z0(t){return t.replace(/start|end/g,e=>_6[e])}function D6(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function L6(t,e,n,r){const i=dg(t);let o=D6(cl(t),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(z0)))),o}function Ep(t){return t.replace(/left|right|bottom|top/g,e=>N6[e])}function B6(t){return{top:0,right:0,bottom:0,left:0,...t}}function F6(t){return typeof t!="number"?B6(t):{top:t,right:t,bottom:t,left:t}}function Tp(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function yA(t,e,n){let{reference:r,floating:i}=t;const o=Tc(e),s=TP(e),a=EP(s),l=cl(e),c=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[a]/2-i[a]/2;let h;switch(l){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-i.width,y:d};break;default:h={x:r.x,y:r.y}}switch(dg(e)){case"start":h[s]-=f*(n&&c?-1:1);break;case"end":h[s]+=f*(n&&c?-1:1);break}return h}const U6=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=yA(c,r,l),f=r,h={},p=0;for(let g=0;g<a.length;g++){const{name:C,fn:m}=a[g],{x:v,y:S,data:E,reset:w}=await m({x:u,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:h,rects:c,platform:s,elements:{reference:t,floating:e}});u=v??u,d=S??d,h={...h,[C]:{...h[C],...E}},w&&p<=50&&(p++,typeof w=="object"&&(w.placement&&(f=w.placement),w.rects&&(c=w.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):w.rects),{x:u,y:d}=yA(c,f,l)),g=-1)}return{x:u,y:d,placement:f,strategy:i,middlewareData:h}};async function RP(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=ug(e,t),p=F6(h),C=a[f?d==="floating"?"reference":"floating":d],m=Tp(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(C)))==null||n?C:C.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),v=d==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),E=await(o.isElement==null?void 0:o.isElement(S))?await(o.getScale==null?void 0:o.getScale(S))||{x:1,y:1}:{x:1,y:1},w=Tp(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:S,strategy:l}):v);return{top:(m.top-w.top+p.top)/E.y,bottom:(w.bottom-m.bottom+p.bottom)/E.y,left:(m.left-w.left+p.left)/E.x,right:(w.right-m.right+p.right)/E.x}}const V6=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...C}=ug(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const m=cl(i),v=Tc(a),S=cl(a)===a,E=await(l.isRTL==null?void 0:l.isRTL(c.floating)),w=f||(S||!g?[Ep(a)]:M6(a)),A=p!=="none";!f&&A&&w.push(...L6(a,g,p,E));const x=[a,...w],T=await RP(e,C),_=[];let O=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&_.push(T[m]),d){const Z=O6(i,s,E);_.push(T[Z[0]],T[Z[1]])}if(O=[...O,{placement:i,overflows:_}],!_.every(Z=>Z<=0)){var L,U;const Z=(((L=o.flip)==null?void 0:L.index)||0)+1,K=x[Z];if(K)return{data:{index:Z,overflows:O},reset:{placement:K}};let ee=(U=O.filter(re=>re.overflows[0]<=0).sort((re,X)=>re.overflows[1]-X.overflows[1])[0])==null?void 0:U.placement;if(!ee)switch(h){case"bestFit":{var z;const re=(z=O.filter(X=>{if(A){const J=Tc(X.placement);return J===v||J==="y"}return!0}).map(X=>[X.placement,X.overflows.filter(J=>J>0).reduce((J,oe)=>J+oe,0)]).sort((X,J)=>X[1]-J[1])[0])==null?void 0:z[0];re&&(ee=re);break}case"initialPlacement":ee=a;break}if(i!==ee)return{reset:{placement:ee}}}return{}}}};async function G6(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=cl(n),a=dg(n),l=Tc(n)==="y",c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,d=ug(e,t);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),l?{x:h*u,y:f*c}:{x:f*c,y:h*u}}const W6=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=e,l=await G6(e,t);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:s}}}}},j6=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:C=>{let{x:m,y:v}=C;return{x:m,y:v}}},...l}=ug(t,e),c={x:n,y:r},u=await RP(e,l),d=Tc(cl(i)),f=kP(d);let h=c[f],p=c[d];if(o){const C=f==="y"?"top":"left",m=f==="y"?"bottom":"right",v=h+u[C],S=h-u[m];h=vA(v,h,S)}if(s){const C=d==="y"?"top":"left",m=d==="y"?"bottom":"right",v=p+u[C],S=p-u[m];p=vA(v,p,S)}const g=a.fn({...e,[f]:h,[d]:p});return{...g,data:{x:g.x-n,y:g.y-r}}}}};function Hc(t){return xP(t)?(t.nodeName||"").toLowerCase():"#document"}function Wr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Sa(t){var e;return(e=(xP(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function xP(t){return t instanceof Node||t instanceof Wr(t).Node}function Bi(t){return t instanceof Element||t instanceof Wr(t).Element}function Co(t){return t instanceof HTMLElement||t instanceof Wr(t).HTMLElement}function CA(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Wr(t).ShadowRoot}function qd(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Fi(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function Z6(t){return["table","td","th"].includes(Hc(t))}function fg(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function tI(t){const e=nI(),n=Bi(t)?Fi(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function H6(t){let e=da(t);for(;Co(e)&&!Rc(e);){if(tI(e))return e;if(fg(e))return null;e=da(e)}return null}function nI(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Rc(t){return["html","body","#document"].includes(Hc(t))}function Fi(t){return Wr(t).getComputedStyle(t)}function hg(t){return Bi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function da(t){if(Hc(t)==="html")return t;const e=t.assignedSlot||t.parentNode||CA(t)&&t.host||Sa(t);return CA(e)?e.host:e}function PP(t){const e=da(t);return Rc(e)?t.ownerDocument?t.ownerDocument.body:t.body:Co(e)&&qd(e)?e:PP(e)}function X0(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=PP(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),s=Wr(i);return o?e.concat(s,s.visualViewport||[],qd(i)?i:[],s.frameElement&&n?X0(s.frameElement):[]):e.concat(i,X0(i,[],n))}function NP(t){const e=Fi(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Co(t),o=i?t.offsetWidth:n,s=i?t.offsetHeight:r,a=kp(n)!==o||kp(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function _P(t){return Bi(t)?t:t.contextElement}function sc(t){const e=_P(t);if(!Co(e))return ua(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=NP(e);let s=(o?kp(n.width):n.width)/r,a=(o?kp(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const z6=ua(0);function OP(t){const e=Wr(t);return!nI()||!e.visualViewport?z6:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function X6(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Wr(t)?!1:e}function Od(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=_P(t);let s=ua(1);e&&(r?Bi(r)&&(s=sc(r)):s=sc(t));const a=X6(o,n,r)?OP(o):ua(0);let l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const f=Wr(o),h=r&&Bi(r)?Wr(r):r;let p=f,g=p.frameElement;for(;g&&r&&h!==p;){const C=sc(g),m=g.getBoundingClientRect(),v=Fi(g),S=m.left+(g.clientLeft+parseFloat(v.paddingLeft))*C.x,E=m.top+(g.clientTop+parseFloat(v.paddingTop))*C.y;l*=C.x,c*=C.y,u*=C.x,d*=C.y,l+=S,c+=E,p=Wr(g),g=p.frameElement}}return Tp({width:u,height:d,x:l,y:c})}function $6(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const o=i==="fixed",s=Sa(r),a=e?fg(e.floating):!1;if(r===s||a&&o)return n;let l={scrollLeft:0,scrollTop:0},c=ua(1);const u=ua(0),d=Co(r);if((d||!d&&!o)&&((Hc(r)!=="body"||qd(s))&&(l=hg(r)),Co(r))){const f=Od(r);c=sc(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x,y:n.y*c.y-l.scrollTop*c.y+u.y}}function K6(t){return Array.from(t.getClientRects())}function MP(t){return Od(Sa(t)).left+hg(t).scrollLeft}function J6(t){const e=Sa(t),n=hg(t),r=t.ownerDocument.body,i=oc(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=oc(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+MP(t);const a=-n.scrollTop;return Fi(r).direction==="rtl"&&(s+=oc(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function Y6(t,e){const n=Wr(t),r=Sa(t),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;const c=nI();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}function Q6(t,e){const n=Od(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=Co(t)?sc(t):ua(1),s=t.clientWidth*o.x,a=t.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function IA(t,e,n){let r;if(e==="viewport")r=Y6(t,n);else if(e==="document")r=J6(Sa(t));else if(Bi(e))r=Q6(e,n);else{const i=OP(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return Tp(r)}function DP(t,e){const n=da(t);return n===e||!Bi(n)||Rc(n)?!1:Fi(n).position==="fixed"||DP(n,e)}function q6(t,e){const n=e.get(t);if(n)return n;let r=X0(t,[],!1).filter(a=>Bi(a)&&Hc(a)!=="body"),i=null;const o=Fi(t).position==="fixed";let s=o?da(t):t;for(;Bi(s)&&!Rc(s);){const a=Fi(s),l=tI(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||qd(s)&&!l&&DP(t,s))?r=r.filter(u=>u!==s):i=a,s=da(s)}return e.set(t,r),r}function ej(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?fg(e)?[]:q6(e,this._c):[].concat(n),r],a=s[0],l=s.reduce((c,u)=>{const d=IA(e,u,i);return c.top=oc(d.top,c.top),c.right=H0(d.right,c.right),c.bottom=H0(d.bottom,c.bottom),c.left=oc(d.left,c.left),c},IA(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function tj(t){const{width:e,height:n}=NP(t);return{width:e,height:n}}function nj(t,e,n){const r=Co(e),i=Sa(e),o=n==="fixed",s=Od(t,!0,o,e);let a={scrollLeft:0,scrollTop:0};const l=ua(0);if(r||!r&&!o)if((Hc(e)!=="body"||qd(i))&&(a=hg(e)),r){const d=Od(e,!0,o,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else i&&(l.x=MP(i));const c=s.left+a.scrollLeft-l.x,u=s.top+a.scrollTop-l.y;return{x:c,y:u,width:s.width,height:s.height}}function xm(t){return Fi(t).position==="static"}function SA(t,e){return!Co(t)||Fi(t).position==="fixed"?null:e?e(t):t.offsetParent}function LP(t,e){const n=Wr(t);if(fg(t))return n;if(!Co(t)){let i=da(t);for(;i&&!Rc(i);){if(Bi(i)&&!xm(i))return i;i=da(i)}return n}let r=SA(t,e);for(;r&&Z6(r)&&xm(r);)r=SA(r,e);return r&&Rc(r)&&xm(r)&&!tI(r)?n:r||H6(t)||n}const rj=async function(t){const e=this.getOffsetParent||LP,n=this.getDimensions,r=await n(t.floating);return{reference:nj(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function ij(t){return Fi(t).direction==="rtl"}const oj={convertOffsetParentRelativeRectToViewportRelativeRect:$6,getDocumentElement:Sa,getClippingRect:ej,getOffsetParent:LP,getElementRects:rj,getClientRects:K6,getDimensions:tj,getScale:sc,isElement:Bi,isRTL:ij},sj=W6,aj=j6,lj=V6,cj=(t,e,n)=>{const r=new Map,i={platform:oj,...n},o={...i.platform,_c:r};return U6(t,e,{...i,platform:o})};var BP={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(MN,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},s=null;function a(g,C){var m=g[C];if(typeof m.bind=="function")return m.bind(g);try{return Function.prototype.bind.call(m,g)}catch{return function(){return Function.prototype.apply.apply(m,[g,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?l:console[g]!==void 0?a(console,g):console.log!==void 0?a(console,"log"):e}function u(){for(var g=this.getLevel(),C=0;C<i.length;C++){var m=i[C];this[m]=C<g?e:this.methodFactory(m,g,this.name)}if(this.log=this.debug,typeof console===n&&g<this.levels.SILENT)return"No console available for logging"}function d(g){return function(){typeof console!==n&&(u.call(this),this[g].apply(this,arguments))}}function f(g,C,m){return c(g)||d.apply(this,arguments)}function h(g,C){var m=this,v,S,E,w="loglevel";typeof g=="string"?w+=":"+g:typeof g=="symbol"&&(w=void 0);function A(L){var U=(i[L]||"silent").toUpperCase();if(!(typeof window===n||!w)){try{window.localStorage[w]=U;return}catch{}try{window.document.cookie=encodeURIComponent(w)+"="+U+";"}catch{}}}function x(){var L;if(!(typeof window===n||!w)){try{L=window.localStorage[w]}catch{}if(typeof L===n)try{var U=window.document.cookie,z=encodeURIComponent(w),Z=U.indexOf(z+"=");Z!==-1&&(L=/^([^;]+)/.exec(U.slice(Z+z.length+1))[1])}catch{}return m.levels[L]===void 0&&(L=void 0),L}}function T(){if(!(typeof window===n||!w)){try{window.localStorage.removeItem(w)}catch{}try{window.document.cookie=encodeURIComponent(w)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function _(L){var U=L;if(typeof U=="string"&&m.levels[U.toUpperCase()]!==void 0&&(U=m.levels[U.toUpperCase()]),typeof U=="number"&&U>=0&&U<=m.levels.SILENT)return U;throw new TypeError("log.setLevel() called with invalid level: "+L)}m.name=g,m.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},m.methodFactory=C||f,m.getLevel=function(){return E??S??v},m.setLevel=function(L,U){return E=_(L),U!==!1&&A(E),u.call(m)},m.setDefaultLevel=function(L){S=_(L),x()||m.setLevel(L,!1)},m.resetLevel=function(){E=null,T(),u.call(m)},m.enableAll=function(L){m.setLevel(m.levels.TRACE,L)},m.disableAll=function(L){m.setLevel(m.levels.SILENT,L)},m.rebuild=function(){if(s!==m&&(v=_(s.getLevel())),u.call(m),s===m)for(var L in o)o[L].rebuild()},v=_(s?s.getLevel():"WARN");var O=x();O!=null&&(E=_(O)),u.call(m)}s=new h,s.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var m=o[C];return m||(m=o[C]=new h(C,s.methodFactory)),m};var p=typeof window!==n?window.log:void 0;return s.noConflict=function(){return typeof window!==n&&window.log===s&&(window.log=p),s},s.getLoggers=function(){return o},s.default=s,s})})(BP);var uj=BP.exports;const dj=Bd(uj);function un(t){return typeof t=="function"}function FP(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Pm=FP(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function $0(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var pg=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=Sc(s),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(g){e={error:g}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else s.remove(this);var u=this.initialTeardown;if(un(u))try{u()}catch(g){o=g instanceof Pm?g.errors:[g]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=Sc(d),h=f.next();!h.done;h=f.next()){var p=h.value;try{bA(p)}catch(g){o=o??[],g instanceof Pm?o=m0(m0([],g0(o)),g0(g.errors)):o.push(g)}}}catch(g){r={error:g}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(o)throw new Pm(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)bA(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&$0(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&$0(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),UP=pg.EMPTY;function VP(t){return t instanceof pg||t&&"closed"in t&&un(t.remove)&&un(t.add)&&un(t.unsubscribe)}function bA(t){un(t)?t():t.unsubscribe()}var GP={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},WP={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,m0([t,e],g0(n)))},clearTimeout:function(t){var e=WP.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function jP(t){WP.setTimeout(function(){throw t})}function K0(){}function Ah(t){t()}var rI=function(t){Gc(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,VP(n)&&n.add(r)):r.destination=gj,r}return e.create=function(n,r,i){return new J0(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(pg),fj=Function.prototype.bind;function Nm(t,e){return fj.call(t,e)}var hj=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){Lf(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){Lf(r)}else Lf(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){Lf(n)}},t}(),J0=function(t){Gc(e,t);function e(n,r,i){var o=t.call(this)||this,s;if(un(n)||!n)s={next:n??void 0,error:r??void 0,complete:i??void 0};else{var a;o&&GP.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return o.unsubscribe()},s={next:n.next&&Nm(n.next,a),error:n.error&&Nm(n.error,a),complete:n.complete&&Nm(n.complete,a)}):s=n}return o.destination=new hj(s),o}return e}(rI);function Lf(t){jP(t)}function pj(t){throw t}var gj={closed:!0,next:K0,error:pj,complete:K0},iI=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function ZP(t){return t}function mj(t){return t.length===0?ZP:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var Nn=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,o=yj(e)?e:new J0(e,n,r);return Ah(function(){var s=i,a=s.operator,l=s.source;o.add(a?a.call(o,l):l?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=wA(n),new n(function(i,o){var s=new J0({next:function(a){try{e(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:i});r.subscribe(s)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[iI]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return mj(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=wA(e),new e(function(r,i){var o;n.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},t.create=function(e){return new t(e)},t}();function wA(t){var e;return(e=t??GP.Promise)!==null&&e!==void 0?e:Promise}function vj(t){return t&&un(t.next)&&un(t.error)&&un(t.complete)}function yj(t){return t&&t instanceof rI||vj(t)&&VP(t)}function Cj(t){return un(t==null?void 0:t.lift)}function bs(t){return function(e){if(Cj(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ul(t,e,n,r,i){return new Ij(t,e,n,r,i)}var Ij=function(t){Gc(e,t);function e(n,r,i,o,s,a){var l=t.call(this,n)||this;return l.onFinalize=s,l.shouldUnsubscribe=a,l._next=r?function(c){try{r(c)}catch(u){n.error(u)}}:t.prototype._next,l._error=o?function(c){try{o(c)}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=i?function(){try{i()}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(rI),Sj=FP(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),fa=function(t){Gc(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new AA(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new Sj},e.prototype.next=function(n){var r=this;Ah(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var s=Sc(r.currentObservers),a=s.next();!a.done;a=s.next()){var l=a.value;l.next(n)}}catch(c){i={error:c}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;Ah(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;Ah(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,o=i.hasError,s=i.isStopped,a=i.observers;return o||s?UP:(this.currentObservers=null,a.push(n),new pg(function(){r.currentObservers=null,$0(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,o=r.thrownError,s=r.isStopped;i?n.error(o):s&&n.complete()},e.prototype.asObservable=function(){var n=new Nn;return n.source=this,n},e.create=function(n,r){return new AA(n,r)},e}(Nn),AA=function(t){Gc(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:UP},e}(fa),HP=function(t){Gc(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,o=n._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(fa);function bj(t){return t&&un(t.schedule)}function wj(t){return t[t.length-1]}function zP(t){return bj(wj(t))?t.pop():void 0}var XP=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function $P(t){return un(t==null?void 0:t.then)}function KP(t){return un(t[iI])}function JP(t){return Symbol.asyncIterator&&un(t==null?void 0:t[Symbol.asyncIterator])}function YP(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Aj(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var QP=Aj();function qP(t){return un(t==null?void 0:t[QP])}function eN(t){return kV(this,arguments,function(){var n,r,i,o;return PR(this,function(s){switch(s.label){case 0:n=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,Ql(n.read())];case 3:return r=s.sent(),i=r.value,o=r.done,o?[4,Ql(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,Ql(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function tN(t){return un(t==null?void 0:t.getReader)}function zc(t){if(t instanceof Nn)return t;if(t!=null){if(KP(t))return kj(t);if(XP(t))return Ej(t);if($P(t))return Tj(t);if(JP(t))return nN(t);if(qP(t))return Rj(t);if(tN(t))return xj(t)}throw YP(t)}function kj(t){return new Nn(function(e){var n=t[iI]();if(un(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Ej(t){return new Nn(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function Tj(t){return new Nn(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,jP)})}function Rj(t){return new Nn(function(e){var n,r;try{for(var i=Sc(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function nN(t){return new Nn(function(e){Pj(t,e).catch(function(n){return e.error(n)})})}function xj(t){return nN(eN(t))}function Pj(t,e){var n,r,i,o;return AV(this,void 0,void 0,function(){var s,a;return PR(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=EV(t),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(s=r.value,e.next(s),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),i={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Ja(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function rN(t,e){return e===void 0&&(e=0),bs(function(n,r){n.subscribe(ul(r,function(i){return Ja(r,t,function(){return r.next(i)},e)},function(){return Ja(r,t,function(){return r.complete()},e)},function(i){return Ja(r,t,function(){return r.error(i)},e)}))})}function iN(t,e){return e===void 0&&(e=0),bs(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function Nj(t,e){return zc(t).pipe(iN(e),rN(e))}function _j(t,e){return zc(t).pipe(iN(e),rN(e))}function Oj(t,e){return new Nn(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Mj(t,e){return new Nn(function(n){var r;return Ja(n,e,function(){r=t[QP](),Ja(n,e,function(){var i,o,s;try{i=r.next(),o=i.value,s=i.done}catch(a){n.error(a);return}s?n.complete():n.next(o)},0,!0)}),function(){return un(r==null?void 0:r.return)&&r.return()}})}function oN(t,e){if(!t)throw new Error("Iterable cannot be null");return new Nn(function(n){Ja(n,e,function(){var r=t[Symbol.asyncIterator]();Ja(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function Dj(t,e){return oN(eN(t),e)}function Lj(t,e){if(t!=null){if(KP(t))return Nj(t,e);if(XP(t))return Oj(t,e);if($P(t))return _j(t,e);if(JP(t))return oN(t,e);if(qP(t))return Mj(t,e);if(tN(t))return Dj(t,e)}throw YP(t)}function Bj(t,e){return e?Lj(t,e):zc(t)}function cr(t,e){return bs(function(n,r){var i=0;n.subscribe(ul(r,function(o){r.next(t.call(e,o,i++))}))})}function Fj(t,e,n,r,i,o,s,a){var l=[],c=0,u=0,d=!1,f=function(){d&&!l.length&&!c&&e.complete()},h=function(g){return c<r?p(g):l.push(g)},p=function(g){c++;var C=!1;zc(n(g,u++)).subscribe(ul(e,function(m){e.next(m)},function(){C=!0},void 0,function(){if(C)try{c--;for(var m=function(){var v=l.shift();s||p(v)};l.length&&c<r;)m();f()}catch(v){e.error(v)}}))};return t.subscribe(ul(e,h,function(){d=!0,f()})),function(){}}function sN(t,e,n){return n===void 0&&(n=1/0),un(e)?sN(function(r,i){return cr(function(o,s){return e(r,o,i,s)})(zc(t(r,i)))},n):(typeof e=="number"&&(n=e),bs(function(r,i){return Fj(r,i,t,n)}))}function Uj(t){return sN(ZP,t)}function Vj(){return Uj(1)}function Y0(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Vj()(Bj(t,zP(t)))}function aN(t,e){return bs(function(n,r){var i=0;n.subscribe(ul(r,function(o){return t.call(e,o,i++)&&r.next(o)}))})}function Gj(t,e,n,r,i){return function(o,s){var a=n,l=e,c=0;o.subscribe(ul(s,function(u){var d=c++;l=a?t(l,u,d):(a=!0,u),s.next(l)},i))}}function Wj(t){return bs(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function jj(t,e){return bs(Gj(t,e,arguments.length>=2,!0))}function Vi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=zP(t);return bs(function(r,i){(n?Y0(t,r,n):Y0(t,r)).subscribe(i)})}function kA(t){return bs(function(e,n){zc(t).subscribe(ul(n,function(){return n.complete()},K0)),!n.closed&&e.subscribe(n)})}var Zj=Object.defineProperty,Hj=Object.defineProperties,zj=Object.getOwnPropertyDescriptors,Rp=Object.getOwnPropertySymbols,lN=Object.prototype.hasOwnProperty,cN=Object.prototype.propertyIsEnumerable,EA=(t,e,n)=>e in t?Zj(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Q0=(t,e)=>{for(var n in e||(e={}))lN.call(e,n)&&EA(t,n,e[n]);if(Rp)for(var n of Rp(e))cN.call(e,n)&&EA(t,n,e[n]);return t},Xj=(t,e)=>Hj(t,zj(e)),$j=(t,e)=>{var n={};for(var r in t)lN.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Rp)for(var r of Rp(t))e.indexOf(r)<0&&cN.call(t,r)&&(n[r]=t[r]);return n},ws=(t,e,n)=>new Promise((r,i)=>{var o=l=>{try{a(n.next(l))}catch(c){i(c)}},s=l=>{try{a(n.throw(l))}catch(c){i(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,s);a((n=n.apply(t,e)).next())}),uN="lk";function oI(t){return typeof t>"u"?!1:Kj(t)||Jj(t)}function Kj(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function Jj(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function Yj(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function dN(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(Yj(t))return`${t.participant.identity}_${t.source}_placeholder`;if(oI(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function Qj(t){return t instanceof Z0}function qj(t,e){return ws(this,null,function*(){const{x:n,y:r}=yield cj(t,e,{placement:"top",middleware:[sj(6),lj(),aj({padding:5})]});return{x:n,y:r}})}function eZ(t,e){return!t.contains(e.target)}var tZ=[ne.ConnectionStateChanged,ne.RoomMetadataChanged,ne.ActiveSpeakersChanged,ne.ConnectionQualityChanged,ne.ParticipantConnected,ne.ParticipantDisconnected,ne.ParticipantPermissionsChanged,ne.ParticipantMetadataChanged,ne.TrackMuted,ne.TrackUnmuted,ne.TrackPublished,ne.TrackUnpublished,ne.TrackStreamStateChanged,ne.TrackSubscriptionFailed,ne.TrackSubscriptionPermissionChanged,ne.TrackSubscriptionStatusChanged],nZ=[...tZ,ne.LocalTrackPublished,ne.LocalTrackUnpublished],rZ=[ae.ConnectionQualityChanged,ae.IsSpeakingChanged,ae.ParticipantMetadataChanged,ae.ParticipantPermissionsChanged,ae.TrackMuted,ae.TrackUnmuted,ae.TrackPublished,ae.TrackUnpublished,ae.TrackStreamStateChanged,ae.TrackSubscriptionFailed,ae.TrackSubscriptionPermissionChanged,ae.TrackSubscriptionStatusChanged];[...rZ,ae.LocalTrackPublished,ae.LocalTrackUnpublished];var at=dj.getLogger("lk-components-js");at.setDefaultLevel("WARN");function iZ(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var oZ=[],sZ={showChat:!1,unreadMessages:0};function sI(t,...e){return new Nn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(Vi(t))}function aI(t,e){return new Nn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function aZ(t){return aI(t,ne.ConnectionStateChanged).pipe(cr(([e])=>e),Vi(t.state))}function lZ(t,e,n=!0){var r;const i=()=>ws(this,null,function*(){try{const a=yield Ap.getLocalDevices(t,n);o.next(a)}catch(a){e==null||e(a)}}),o=new fa,s=o.pipe(Wj(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return Y0(Ap.getLocalDevices(t,n).catch(a=>e==null?void 0:e(a)),s)}function cZ(t){return aI(t,ne.DataReceived)}function uZ(t){return sI(t,ne.AudioPlaybackStatusChanged).pipe(cr(n=>({canPlayAudio:n.canPlaybackAudio})))}function dZ(t){return sI(t,ne.VideoPlaybackStatusChanged).pipe(cr(n=>({canPlayVideo:n.canPlaybackVideo})))}function fZ(t,e){return aI(t,ne.ActiveDeviceChanged).pipe(aN(([n])=>n===e),cr(([n,r])=>(at.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)),Vi(t.getActiveDevice(e)))}function si(t){return`${uN}-${t}`}function hZ(t){const e=q0(t),n=cI(t.participant).pipe(cr(()=>q0(t)),Vi(e));return{className:si(t.source===Q.Source.Camera||t.source===Q.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function q0(t){if(oI(t))return t.publication;{const{source:e,name:n,participant:r}=t;if(e&&n)return r.getTracks().find(i=>i.source===e&&i.trackName===n);if(n)return r.getTrackByName(n);if(e)return r.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function lI(t,...e){return new Nn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(Vi(t))}function cI(t){return lI(t,ae.TrackMuted,ae.TrackUnmuted,ae.ParticipantPermissionsChanged,ae.TrackPublished,ae.TrackUnpublished,ae.LocalTrackPublished,ae.LocalTrackUnpublished,ae.MediaDevicesError,ae.TrackSubscriptionStatusChanged).pipe(cr(n=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:o}=n,s=n.getTrack(Q.Source.Microphone),a=n.getTrack(Q.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:o,cameraTrack:a,microphoneTrack:s,participant:n}}))}function pZ(t){return lI(t,ae.ParticipantMetadataChanged).pipe(cr(({name:n,identity:r,metadata:i})=>({name:n,identity:r,metadata:i})),Vi({name:t.name,identity:t.identity,metadata:t.metadata}))}function gZ(t){return uI(t,ae.ConnectionQualityChanged).pipe(cr(([n])=>n),Vi(t.connectionQuality))}function uI(t,e){return new Nn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function fN(t){var e,n,r,i;return lI(t.participant,ae.TrackMuted,ae.TrackUnmuted,ae.TrackSubscribed,ae.TrackUnsubscribed,ae.LocalTrackPublished,ae.LocalTrackUnpublished).pipe(cr(o=>{var s,a;const l=(s=t.publication)!=null?s:o.getTrack(t.source);return(a=l==null?void 0:l.isMuted)!=null?a:!0}),Vi((i=(r=(e=t.publication)==null?void 0:e.isMuted)!=null?r:(n=t.participant.getTrack(t.source))==null?void 0:n.isMuted)!=null?i:!0))}function mZ(t){return uI(t,ae.IsSpeakingChanged).pipe(cr(([e])=>e))}function vZ(t,e={}){var n;let r;const i=new Nn(l=>(r=l,()=>a.unsubscribe())).pipe(Vi(Array.from(t.participants.values()))),o=(n=e.additionalRoomEvents)!=null?n:nZ,s=Array.from(new Set([ne.ParticipantConnected,ne.ParticipantDisconnected,ne.ConnectionStateChanged,...o])),a=sI(t,...s).subscribe(l=>r==null?void 0:r.next(Array.from(l.participants.values())));return t.participants.size>0&&(r==null||r.next(Array.from(t.participants.values()))),i}function yZ(t){return uI(t,ae.ParticipantPermissionsChanged).pipe(cr(()=>t.permissions),Vi(t.permissions))}function CZ(t,e,n){const{localParticipant:r}=e,i=(c,u)=>{let d=!1;switch(c){case Q.Source.Camera:d=u.isCameraEnabled;break;case Q.Source.Microphone:d=u.isMicrophoneEnabled;break;case Q.Source.ScreenShare:d=u.isScreenShareEnabled;break}return d},o=cI(r).pipe(cr(c=>i(t,c.participant)),Vi(i(t,r))),s=new fa,a=(c,u)=>ws(this,null,function*(){try{switch(u??(u=n),s.next(!0),t){case Q.Source.Camera:yield r.setCameraEnabled(c??!r.isCameraEnabled,u);break;case Q.Source.Microphone:yield r.setMicrophoneEnabled(c??!r.isMicrophoneEnabled,u);break;case Q.Source.ScreenShare:yield r.setScreenShareEnabled(c??!r.isScreenShareEnabled,u);break;default:break}}finally{s.next(!1)}});return{className:si("button"),toggle:a,enabledObserver:o,pendingObserver:s.asObservable()}}function IZ(){let t=!1;const e=new fa,n=new fa,r=o=>{n.next(!0),t=o??!t,e.next(t),n.next(!1)};return{className:si("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function SZ(t,e,n){const r=new HP(void 0),i=e?fZ(e,t):r.asObservable(),o=(a,...l)=>ws(this,[a,...l],function*(c,u={}){var d,f,h;if(e){at.debug(`Switching active device of kind "${t}" with id ${c}.`),yield e.switchActiveDevice(t,c,u.exact);const p=(d=e.getActiveDevice(t))!=null?d:c;p!==c&&c!=="default"&&at.info(`We tried to select the device with id (${c}), but the browser decided to select the device with id (${p}) instead.`);let g;t==="audioinput"?g=(f=e.localParticipant.getTrack(Q.Source.Microphone))==null?void 0:f.track:t==="videoinput"&&(g=(h=e.localParticipant.getTrack(Q.Source.Camera))==null?void 0:h.track);const C=c==="default"&&!g||c==="default"&&(g==null?void 0:g.mediaStreamTrack.label.startsWith("Default"));r.next(C?c:p)}else if(n){yield n.setDeviceId(u.exact?{exact:c}:c);const p=yield n.getDeviceId();r.next(c==="default"&&n.mediaStreamTrack.label.startsWith("Default")?c:p)}else r.value!==c&&(at.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(c))});return{className:si("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:o}}function bZ(t){const e=r=>{t.disconnect(r)};return{className:si("disconnect-button"),disconnect:e}}function wZ(t){const e=si("connection-quality"),n=gZ(t);return{className:e,connectionQualityObserver:n}}function AZ(t){let e="track-muted-indicator-camera";switch(t.source){case Q.Source.Camera:e="track-muted-indicator-camera";break;case Q.Source.Microphone:e="track-muted-indicator-microphone";break}const n=si(e),r=fN(t);return{className:n,mediaMutedObserver:r}}function kZ(t){return{className:"lk-participant-name",infoObserver:pZ(t)}}function EZ(){return{className:si("participant-tile")}}var TZ={CHAT:"lk-chat-topic"};function hN(t,e,n){return ws(this,arguments,function*(r,i,o,s={}){const{kind:a,destination:l}=s;yield r.publishData(i,a??on.RELIABLE,{destination:l,topic:o})})}function RZ(t,e,n){const r=cZ(t).pipe(aN(([,,,a])=>e===void 0||a===e),cr(([a,l,,c])=>({payload:a,topic:c,from:l})));let i;const o=new Nn(a=>{i=a});return{messageObservable:r,isSendingObservable:o,send:(a,...l)=>ws(this,[a,...l],function*(c,u={}){i.next(!0);try{yield hN(t.localParticipant,c,e,u)}finally{i.next(!1)}})}}var xZ=new TextEncoder,PZ=new TextDecoder,Bf=new Map,NZ=t=>xZ.encode(JSON.stringify({message:t.message,timestamp:t.timestamp})),_Z=t=>JSON.parse(PZ.decode(t));function OZ(t,e){var n,r;const i=new fa,{messageDecoder:o,messageEncoder:s,channelTopic:a}=e??{},l=a??TZ.CHAT;let c=!1;Bf.has(t)||(c=!0);const u=(n=Bf.get(t))!=null?n:new Map,d=(r=u.get(l))!=null?r:new fa;if(u.set(l,d),Bf.set(t,u),c){const{messageObservable:v}=RZ(t,l);v.pipe(kA(i)).subscribe(d)}const f=o??_Z,h=d.pipe(cr(v=>{const S=f(v.payload);return Xj(Q0({},S),{from:v.from})}),jj((v,S)=>[...v,S],[]),kA(i)),p=new HP(!1),g=s??NZ,C=v=>ws(this,null,function*(){const S=Date.now(),E=g({message:v,timestamp:S});p.next(!0);try{yield hN(t.localParticipant,E,l,{kind:on.RELIABLE}),d.next({payload:E,topic:l,from:t.localParticipant})}finally{p.next(!1)}});function m(){i.next(),i.complete(),Bf.clear()}return t.once(ne.Disconnected,m),{messageObservable:h,isSendingObservable:p,send:C}}function MZ(){const t=n=>ws(this,null,function*(){at.info("Start Audio for room: ",n),yield n.startAudio()});return{className:si("start-audio-button"),roomAudioPlaybackAllowedObservable:uZ,handleStartAudioPlayback:t}}function DZ(){const t=n=>ws(this,null,function*(){at.info("Start Video for room: ",n),yield n.startVideo()});return{className:si("start-audio-button"),roomVideoPlaybackAllowedObservable:dZ,handleStartVideoPlayback:t}}function LZ(){return{className:[si("button"),si("chat-toggle")].join(" ")}}function BZ(){return{className:"lk-room-container"}}function FZ(t,e){if(typeof localStorage>"u"){at.error("Local storage is not available.");return}try{localStorage.setItem(t,JSON.stringify(e))}catch(n){at.error(`Error setting item to local storage: ${n}`)}}function UZ(t){if(typeof localStorage>"u"){at.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){at.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){at.error(`Error getting item from local storage: ${e}`);return}}function VZ(t){return{load:()=>UZ(t),save:e=>FZ(t,e)}}var GZ=`${uN}-user-choices`,ka={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:WZ,save:jZ}=VZ(GZ);function ZZ(t,e=!1){if(e===!0)return;const n=t,r=$j(n,["e2ee","sharedPassphrase"]);jZ(r)}function HZ(t,e=!1){var n,r,i,o,s,a,l;const c={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:ka.videoEnabled,audioEnabled:(r=t==null?void 0:t.audioEnabled)!=null?r:ka.audioEnabled,videoDeviceId:(i=t==null?void 0:t.videoDeviceId)!=null?i:ka.videoDeviceId,audioDeviceId:(o=t==null?void 0:t.audioDeviceId)!=null?o:ka.audioDeviceId,username:(s=t==null?void 0:t.username)!=null?s:ka.username,e2ee:(a=t==null?void 0:t.e2ee)!=null?a:ka.e2ee,sharedPassphrase:(l=t==null?void 0:t.sharedPassphrase)!=null?l:ka.sharedPassphrase};if(e)return c;{const u=WZ();return Q0(Q0({},c),u??{})}}function pN(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=pN(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function zZ(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=pN(t))&&(r&&(r+=" "),r+=e);return r}var XZ=Object.defineProperty,$Z=Object.defineProperties,KZ=Object.getOwnPropertyDescriptors,xp=Object.getOwnPropertySymbols,gN=Object.prototype.hasOwnProperty,mN=Object.prototype.propertyIsEnumerable,TA=(t,e,n)=>e in t?XZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Me=(t,e)=>{for(var n in e||(e={}))gN.call(e,n)&&TA(t,n,e[n]);if(xp)for(var n of xp(e))mN.call(e,n)&&TA(t,n,e[n]);return t},Gn=(t,e)=>$Z(t,KZ(e)),_n=(t,e)=>{var n={};for(var r in t)gN.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&xp)for(var r of xp(t))e.indexOf(r)<0&&mN.call(t,r)&&(n[r]=t[r]);return n},vN=(t,e,n)=>new Promise((r,i)=>{var o=l=>{try{a(n.next(l))}catch(c){i(c)}},s=l=>{try{a(n.throw(l))}catch(c){i(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,s);a((n=n.apply(t,e)).next())});function Hr(t,e){const[n,r]=b.useState(e);return b.useEffect(()=>{if(typeof window>"u"||!t)return;const i=t.subscribe(r);return()=>i.unsubscribe()},[t]),n}function JZ(t){const e=o=>typeof window<"u"?window.matchMedia(o).matches:!1,[n,r]=b.useState(e(t));function i(){r(e(t))}return b.useEffect(()=>{const o=window.matchMedia(t);return i(),o.addListener?o.addListener(i):o.addEventListener("change",i),()=>{o.removeListener?o.removeListener(i):o.removeEventListener("change",i)}},[t]),n}function YZ(t,e){if(e.msg==="show_chat")return Gn(Me({},t),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return Gn(Me({},t),{showChat:!1});if(e.msg==="toggle_chat"){const n=Gn(Me({},t),{showChat:!t.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?Gn(Me({},t),{unreadMessages:e.count}):Me({},t)}function QZ(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:Me({},t)}var dI=b.createContext(void 0);function qZ(){const t=b.useContext(dI);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function e8(t){const[e,n]=b.useReducer(QZ,oZ),[r,i]=b.useReducer(YZ,sZ);return t??{pin:{dispatch:n,state:e},widget:{dispatch:i,state:r}}}function yN(){return b.useContext(dI)}var t8=b.createContext(void 0);function ef(){return b.useContext(t8)}var fI=b.createContext(void 0);function gg(){return b.useContext(fI)}function vl(t){var e;const n=gg(),r=ef(),i=(e=t??n)!=null?e:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var hI=b.createContext(void 0);function mg(){const t=b.useContext(hI);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function vg(){return b.useContext(hI)}function tf(t){const e=vg(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var n8=b.createContext(void 0);function r8(...t){return(...e)=>{for(const n of t)typeof n=="function"&&n(...e)}}function ba(...t){const e=Me({},t[0]);for(let n=1;n<t.length;n++){const r=t[n];for(const i in r){const o=e[i],s=r[i];typeof o=="function"&&typeof s=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=r8(o,s):(i==="className"||i==="UNSAFE_className")&&typeof o=="string"&&typeof s=="string"?e[i]=zZ(o,s):e[i]=s!==void 0?s:o}}return e}function i8(t={}){const e=vl(t.participant),{className:n,connectionQualityObserver:r}=b.useMemo(()=>wZ(e),[e]),i=Hr(r,Qr.Unknown);return{className:n,quality:i}}function o8(t){const e=tf(t),n=b.useMemo(()=>aZ(e),[e]);return Hr(n,e.state)}function s8(t){const e=mg(),n=o8(e);return{buttonProps:b.useMemo(()=>{const{className:i,disconnect:o}=bZ(e);return ba(t,{className:i,onClick:()=>{var a;return o((a=t.stopTracks)!=null?a:!0)},disabled:n===nt.Disconnected})},[e,t,n])}}function a8(t){if(t.publication instanceof Nd){const e=t.publication.track;if(e){const{facingMode:n}=T6(e);return n}}return"undefined"}function RA(t,e={}){var n,r;const i=typeof t=="string"?e.participant:t.participant,o=vl(i),s=typeof t=="string"?{participant:o,source:t}:t,[a,l]=b.useState(!!((n=s.publication)!=null&&n.isMuted||(r=o.getTrack(s.source))!=null&&r.isMuted));return b.useEffect(()=>{const c=fN(s).subscribe(l);return()=>c.unsubscribe()},[dN(s)]),a}function l8(t){const e=vl(t),n=b.useMemo(()=>mZ(e),[e]);return Hr(n,e.isSpeaking)}var c8={connect:!0,audio:!1,video:!1};function u8(t){const e=Me(Me({},c8),t),{token:n,serverUrl:r,options:i,room:o,connectOptions:s,connect:a,audio:l,video:c,screen:u,onConnected:d,onDisconnected:f,onError:h,onMediaDeviceFailure:p,onEncryptionError:g,simulateParticipants:C}=e,m=_n(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&o&&at.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[v,S]=b.useState();b.useEffect(()=>{S(o??new Ap(i))},[o]);const E=b.useMemo(()=>{const{className:w}=BZ();return ba(m,{className:w})},[m]);return b.useEffect(()=>{if(!v)return;const w=()=>{const T=v.localParticipant;at.debug("trying to publish local tracks"),Promise.all([T.setMicrophoneEnabled(!!l,typeof l!="boolean"?l:void 0),T.setCameraEnabled(!!c,typeof c!="boolean"?c:void 0),T.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(_=>{at.warn(_),h==null||h(_)})},A=T=>{const _=xd.getFailure(T);p==null||p(_)},x=T=>{g==null||g(T)};return v.on(ne.SignalConnected,w).on(ne.MediaDevicesError,A).on(ne.EncryptionError,x),()=>{v.off(ne.SignalConnected,w).off(ne.MediaDevicesError,A).off(ne.EncryptionError,x)}},[v,l,c,u,h,g,p]),b.useEffect(()=>{if(v){if(C){v.simulateParticipants({participants:{count:C},publish:{audio:!0,useRealTracks:!0}});return}if(!n){at.debug("no token yet");return}if(!r){at.warn("no livekit url provided"),h==null||h(Error("no livekit url provided"));return}a?(at.debug("connecting"),v.connect(r,n,s).catch(w=>{at.warn(w),h==null||h(w)})):(at.debug("disconnecting because connect is false"),v.disconnect())}},[a,n,JSON.stringify(s),v,h,r,C]),b.useEffect(()=>{if(!v)return;const w=A=>{switch(A){case nt.Disconnected:f&&f();break;case nt.Connected:d&&d();break}};return v.on(ne.ConnectionStateChanged,w),()=>{v.off(ne.ConnectionStateChanged,w)}},[n,d,f,v]),b.useEffect(()=>{if(v)return()=>{at.info("disconnecting on onmount"),v.disconnect()}},[v]),{room:v,htmlProps:E}}function d8(t={}){const e=tf(t.room),[n,r]=b.useState(e.localParticipant),[i,o]=b.useState(n.isMicrophoneEnabled),[s,a]=b.useState(n.isMicrophoneEnabled),[l,c]=b.useState(n.lastMicrophoneError),[u,d]=b.useState(n.lastCameraError),[f,h]=b.useState(n.isMicrophoneEnabled),[p,g]=b.useState(void 0),[C,m]=b.useState(void 0),v=S=>{a(S.isCameraEnabled),o(S.isMicrophoneEnabled),h(S.isScreenShareEnabled),m(S.cameraTrack),g(S.microphoneTrack),c(S.participant.lastMicrophoneError),d(S.participant.lastCameraError),r(S.participant)};return b.useEffect(()=>{const S=cI(n).subscribe(v);return()=>S.unsubscribe()},[n]),{isMicrophoneEnabled:i,isScreenShareEnabled:f,isCameraEnabled:s,microphoneTrack:p,cameraTrack:C,lastMicrophoneError:l,lastCameraError:u,localParticipant:n}}function f8(){const t=mg(),e=b.useMemo(()=>yZ(t.localParticipant),[t]);return Hr(e,t.localParticipant.permissions)}function h8({kind:t,room:e,track:n,requestPermissions:r,onError:i}){const o=vg(),s=b.useMemo(()=>lZ(t,i,r),[t,r,i]),a=Hr(s,[]),[l,c]=b.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:f}=b.useMemo(()=>SZ(t,e??o,n),[t,e,o,n]);return b.useEffect(()=>{const h=d.subscribe(p=>{at.info("setCurrentDeviceId",p),p&&c(p)});return()=>{h==null||h.unsubscribe()}},[d]),{devices:a,className:u,activeDeviceId:l,setActiveMediaDevice:f}}function p8(t){return t!==void 0}function Xc(...t){return ba(...t.filter(p8))}function CN(t,e,n){return b.Children.map(t,r=>b.isValidElement(r)&&b.Children.only(t)?b.cloneElement(r,Gn(Me({},e),{key:n})):r)}function IN(t,e={}){var n;const[r,i]=b.useState(q0(t)),[o,s]=b.useState(r==null?void 0:r.isMuted),[a,l]=b.useState(r==null?void 0:r.isSubscribed),[c,u]=b.useState(r==null?void 0:r.track),[d,f]=b.useState("landscape"),h=b.useRef(),{className:p,trackObserver:g}=b.useMemo(()=>hZ(t),[(n=t.participant.sid)!=null?n:t.participant.identity,t.source,oI(t)&&t.publication.trackSid]);return b.useEffect(()=>{const C=g.subscribe(m=>{at.debug("update track",m),i(m),s(m==null?void 0:m.isMuted),l(m==null?void 0:m.isSubscribed),u(m==null?void 0:m.track)});return()=>C==null?void 0:C.unsubscribe()},[g]),b.useEffect(()=>{var C,m;return c&&(h.current&&c.detach(h.current),(C=e.element)!=null&&C.current&&!(Qj(t.participant)&&(c==null?void 0:c.kind)==="audio")&&c.attach(e.element.current)),h.current=(m=e.element)==null?void 0:m.current,()=>{h.current&&(c==null||c.detach(h.current))}},[c,e.element]),b.useEffect(()=>{var C,m;if(typeof((C=r==null?void 0:r.dimensions)==null?void 0:C.width)=="number"&&typeof((m=r==null?void 0:r.dimensions)==null?void 0:m.height)=="number"){const v=r.dimensions.width>r.dimensions.height?"landscape":"portrait";f(v)}},[r]),{publication:r,isMuted:o,isSubscribed:a,track:c,elementProps:Xc(e.props,Me({className:p,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":d}))}}function g8({trackRef:t,participant:e,source:n,publication:r,onParticipantClick:i,disableSpeakingIndicator:o,htmlProps:s}){const a=ef(),l=vl(e),c=b.useMemo(()=>{var g,C,m,v,S,E;const w=(C=(g=t==null?void 0:t.source)!=null?g:a==null?void 0:a.source)!=null?C:n;if(w===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(v=(m=t==null?void 0:t.participant)!=null?m:a==null?void 0:a.participant)!=null?v:l,publication:(E=(S=t==null?void 0:t.publication)!=null?S:a==null?void 0:a.publication)!=null?E:r,source:w}},[t==null?void 0:t.participant,t==null?void 0:t.source,t==null?void 0:t.publication,a==null?void 0:a.participant,a==null?void 0:a.source,a==null?void 0:a.publication,l,n,r]),u=b.useMemo(()=>{const{className:g}=EZ();return ba(s,{className:g,onClick:C=>{var m,v;if((m=s.onClick)==null||m.call(s,C),typeof i=="function"){const S=(v=c.publication)!=null?v:c.participant.getTrack(c.source);i({participant:c.participant,track:S})}}})},[s,i,c.publication,c.source,c.participant]),d=RA(Q.Source.Camera,{participant:c.participant}),f=RA(Q.Source.Microphone,{participant:c.participant}),h=l8(c.participant),p=a8(c);return{elementProps:Me({"data-lk-audio-muted":f,"data-lk-video-muted":d,"data-lk-speaking":o===!0?!1:h,"data-lk-local-participant":c.participant.isLocal,"data-lk-source":c.source,"data-lk-facing-mode":p},u)}}function m8(t={}){const e=tf(t.room),[n,r]=b.useState([]);return b.useEffect(()=>{const i=vZ(e,{additionalRoomEvents:t.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[e,JSON.stringify(t.updateOnlyOn)]),n}function v8(t={}){const e=m8(t),{localParticipant:n}=d8(t);return[n,...e]}function y8({room:t,props:e}){const n=tf(t),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:o}=b.useMemo(()=>MZ(),[]),s=b.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=Hr(s,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:b.useMemo(()=>ba(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayAudio:a}}function C8({room:t,props:e}){const n=tf(t),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:o}=b.useMemo(()=>DZ(),[]),s=b.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=Hr(s,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:b.useMemo(()=>ba(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayVideo:a}}function I8({props:t}){const{dispatch:e,state:n}=qZ().widget,{className:r}=b.useMemo(()=>LZ(),[]);return{mergedProps:b.useMemo(()=>ba(t,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,r,e,n])}}function S8(t,e={}){var n,r,i,o;let s=ef();const a=(r=(n=gg())!=null?n:e.participant)!=null?r:s==null?void 0:s.participant;if(typeof t=="string"){if(!a)throw Error("Participant missing, either provide it via context or pass it in directly");s={participant:a,source:t}}else if(t)s=t;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:l,mediaMutedObserver:c}=b.useMemo(()=>AZ(s),[dN(s)]);return{isMuted:Hr(c,!!((i=s.publication)!=null&&i.isMuted||(o=s.participant.getTrack(s.source))!=null&&o.isMuted)),className:l}}function b8(t){var e=t,{source:n,onChange:r,initialState:i,captureOptions:o}=e,s=_n(e,["source","onChange","initialState","captureOptions"]),a;const l=vg(),c=(a=l==null?void 0:l.localParticipant)==null?void 0:a.getTrack(n),{toggle:u,className:d,pendingObserver:f,enabledObserver:h}=b.useMemo(()=>l?CZ(n,l,o):IZ(),[l,n,JSON.stringify(o)]),p=Hr(f,!1),g=Hr(h,i??!!(c!=null&&c.isEnabled));b.useEffect(()=>{r==null||r(g)},[g,r]),b.useEffect(()=>{i!==void 0&&(at.debug("forcing initial toggle state",n,i),u(i))},[]);const C=b.useMemo(()=>ba(s,{className:d}),[s,d]),m=b.useCallback(v=>{var S;u(),(S=s.onClick)==null||S.call(s,v)},[s,u]);return{toggle:u,enabled:g,pending:p,track:c,buttonProps:Gn(Me({},C),{"aria-pressed":g,"data-lk-source":n,"data-lk-enabled":g,disabled:p,onClick:m})}}function w8(t,e={}){return IN(t,e)}function A8(t){const e=mg(),[n,r]=b.useState(),i=Hr(n==null?void 0:n.isSendingObservable,!1),o=Hr(n==null?void 0:n.messageObservable,[]);return b.useEffect(()=>{const s=OZ(e,t);r(s)},[e,t]),{send:n==null?void 0:n.send,chatMessages:o,isSending:i}}function k8(t={}){var e;const[n,r]=b.useState(HZ(t.defaults,(e=t.preventLoad)!=null?e:!1)),i=b.useCallback(c=>{r(u=>Gn(Me({},u),{audioEnabled:c}))},[]),o=b.useCallback(c=>{r(u=>Gn(Me({},u),{videoEnabled:c}))},[]),s=b.useCallback(c=>{r(u=>Gn(Me({},u),{audioDeviceId:c}))},[]),a=b.useCallback(c=>{r(u=>Gn(Me({},u),{videoDeviceId:c}))},[]),l=b.useCallback(c=>{r(u=>Gn(Me({},u),{username:c}))},[]);return b.useEffect(()=>{var c;ZZ(n,(c=t.preventSave)!=null?c:!1)},[n,t.preventSave]),{userChoices:n,saveAudioInputEnabled:i,saveVideoInputEnabled:o,saveAudioInputDeviceId:s,saveVideoInputDeviceId:a,saveUsername:l}}function E8(t){const{mergedProps:e}=I8({props:t});return b.createElement("button",Me({},e),t.children)}function T8(t){const{buttonProps:e}=s8(t);return b.createElement("button",Me({},e),t.children)}var R8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),b.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),x8=R8,P8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),N8=P8,_8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),O8=_8,M8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),D8=M8,L8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),b.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),B8=L8,F8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),b.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),U8=F8,V8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),G8=V8,W8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),j8=W8,Z8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),H8=Z8,z8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),X8=z8,$8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),K8=$8,J8=t=>b.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),b.createElement("g",{fill:"currentColor"},b.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),b.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),Y8=J8;function _m(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:o,onDeviceSelectError:s,exactMatch:a,track:l,requestPermissions:c,onError:u}=e,d=_n(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const f=vg(),h=b.useCallback(w=>{f&&f.emit(ne.MediaDevicesError,w),u==null||u(w)},[f,u]),{devices:p,activeDeviceId:g,setActiveMediaDevice:C,className:m}=h8({kind:n,room:f,track:l,requestPermissions:c,onError:h});b.useEffect(()=>{r!==void 0&&C(r)},[C]),b.useEffect(()=>{typeof o=="function"&&o(p)},[o,p]),b.useEffect(()=>{g&&g!==""&&(i==null||i(g))},[g]);const v=w=>vN(this,null,function*(){try{yield C(w,{exact:a})}catch(A){if(A instanceof Error)s==null||s(A);else throw A}}),S=b.useMemo(()=>Xc(d,{className:m},{className:"lk-list"}),[m,d]);function E(w,A,x){return w===A||x===0&&A==="default"}return b.createElement("ul",Me({},S),p.map((w,A)=>b.createElement("li",{key:w.deviceId,id:w.deviceId,"data-lk-active":E(w.deviceId,g,A),"aria-selected":E(w.deviceId,g,A),role:"option"},b.createElement("button",{className:"lk-button",onClick:()=>v(w.deviceId)},w.label))))}function SN(t,e){switch(t){case Q.Source.Microphone:return e?b.createElement(U8,null):b.createElement(B8,null);case Q.Source.Camera:return e?b.createElement(N8,null):b.createElement(x8,null);case Q.Source.ScreenShare:return e?b.createElement(Y8,null):b.createElement(K8,null);default:return}}function Q8(t){switch(t){case Qr.Excellent:return b.createElement(G8,null);case Qr.Good:return b.createElement(j8,null);case Qr.Poor:return b.createElement(H8,null);default:return b.createElement(X8,null)}}function Om(t){var e=t,{showIcon:n}=e,r=_n(e,["showIcon"]);const{buttonProps:i,enabled:o}=b8(r);return b.createElement("button",Me({},i),(n??!0)&&SN(r.source,o),r.children)}function q8(t){var e;const{className:n,quality:r}=i8(t),i=b.useMemo(()=>Gn(Me({},Xc(t,{className:n})),{"data-lk-quality":r}),[r,t,n]);return b.createElement("div",Me({},i),(e=t.children)!=null?e:Q8(r))}function eH(t){var e=t,{participant:n}=e,r=_n(e,["participant"]);const i=vl(n),{className:o,infoObserver:s}=b.useMemo(()=>kZ(i),[i]),{identity:a,name:l}=Hr(s,{name:i.name,identity:i.identity,metadata:i.metadata}),c=b.useMemo(()=>Xc(r,{className:o,"data-lk-participant-name":l}),[r,o,l]);return b.createElement("span",Me({},c),l!==""?l:a,r.children)}function tH(t){var e=t,{source:n,participant:r,trackRef:i,show:o="always"}=e,s=_n(e,["source","participant","trackRef","show"]),a,l;const{className:c,isMuted:u}=S8(i??n,{participant:r}),d=o==="always"||o==="muted"&&u||o==="unmuted"&&!u,f=b.useMemo(()=>Xc(s,{className:c}),[c,s]);return d?b.createElement("div",Gn(Me({},f),{"data-lk-muted":u}),(l=s.children)!=null?l:SN((a=i==null?void 0:i.source)!=null?a:n,!u)):null}function nH(t){var e=t,{trackRef:n,onSubscriptionStatusChanged:r,volume:i,source:o,name:s,publication:a,participant:l}=e,c=_n(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),u,d,f,h,p,g,C,m,v,S;const E=ef(),w=(h=(f=(u=n==null?void 0:n.publication)==null?void 0:u.trackName)!=null?f:(d=E==null?void 0:E.publication)==null?void 0:d.trackName)!=null?h:s,A=(g=(p=n==null?void 0:n.source)!=null?p:E==null?void 0:E.source)!=null?g:o,x=(m=(C=n==null?void 0:n.publication)!=null?C:E==null?void 0:E.publication)!=null?m:a,T=(S=(v=n==null?void 0:n.participant)!=null?v:E==null?void 0:E.participant)!=null?S:l;if(A===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const _=b.useRef(null),O=vl(T),{elementProps:L,isSubscribed:U,track:z,publication:Z}=IN({source:A,name:w,participant:O,publication:x},{element:_,props:c});return b.useEffect(()=>{r==null||r(!!U)},[U,r]),b.useEffect(()=>{z===void 0||i===void 0||(z instanceof Ka?z.setVolume(i):at.warn("Volume can only be set on remote audio tracks."))},[i,z]),b.useEffect(()=>{Z===void 0||c.muted===void 0||(Z instanceof eI?Z.setEnabled(!c.muted):at.warn("Can only call setEnabled on remote track publications."))},[c.muted,Z,z]),b.createElement("audio",Me({ref:_},L))}function rH(t){const e=!!gg();return t.participant&&!e?b.createElement(fI.Provider,{value:t.participant},t.children):b.createElement(b.Fragment,null,t.children)}function iH({value:t,onPinChange:e,onWidgetChange:n,children:r}){const i=e8(t);return b.useEffect(()=>{at.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),b.useEffect(()=>{at.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),b.createElement(dI.Provider,{value:i},r)}function oH(t){const{room:e,htmlProps:n}=u8(t);return b.createElement("div",Me({},n),e&&b.createElement(hI.Provider,{value:e},b.createElement(n8.Provider,{value:t.featureFlags},t.children)))}function sH(t){var e=t,{participant:n,trackRef:r}=e,i=_n(e,["participant","trackRef"]),o,s;const[a,l]=b.useState([]),c=200,u=90,d=6,f=4,h=50,p=7,g=(o=gg())!=null?o:n;let C=(s=ef())!=null?s:r;if(!C){if(!g)throw Error("Participant missing, provide it directly or within a context");C={participant:g,source:Q.Source.Microphone}}const{track:m}=w8(C);return b.useEffect(()=>{if(!m||!(m instanceof fr||m instanceof Ka))return;const{analyser:v,cleanup:S}=M9(m,{smoothingTimeConstant:.8,fftSize:64}),E=new Uint8Array(v.frequencyBinCount),w=()=>{v.getByteFrequencyData(E);const x=new Array(p).fill(0);E.slice(1);const T=6;for(let _=0;_<p/2;_+=1){const O=Math.floor(p/2-_);for(let L=0;L<T;L+=1)x[O]+=Math.pow(E[_*T+L]/255,2);x[O]/=T}for(let _=0;_<p/2;_+=1){const O=Math.floor(p/2+_);if(x[O]===0){for(let L=0;L<T;L+=1)x[O]+=Math.pow(E[_*T+L]/255,2);x[O]/=T}}return x.map(_=>_*h)},A=setInterval(()=>{const x=w();l(x)},100);return()=>{clearInterval(A),S()}},[m]),b.createElement("svg",Gn(Me({width:"100%",height:"100%",viewBox:`0 0 ${c} ${u}`},i),{className:"lk-audio-visualizer"}),b.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),b.createElement("g",{style:{transform:`translate(${(c-p*(d+f))/2}px, 0)`}},a.map((v,S)=>b.createElement("rect",{key:S,x:S*(d+f),y:u/2-v/2,width:d,height:v}))))}function aH(t){var e=t,{participants:n}=e,r=_n(e,["participants"]);return b.createElement(b.Fragment,null,n.map(i=>b.createElement(fI.Provider,{value:i,key:i.identity},CN(r.children))))}function lH(t){var e=t,{participant:n,children:r,source:i,publication:o,disableSpeakingIndicator:s,onParticipantClick:a}=e,l=_n(e,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const c=vl(n),{elementProps:u}=g8({participant:c,htmlProps:l,disableSpeakingIndicator:s,source:Q.Source.Microphone,publication:o,onParticipantClick:a});return b.createElement("div",Me({style:{position:"relative"}},u),b.createElement(rH,{participant:c},r??b.createElement(b.Fragment,null,b.createElement(nH,{source:i??Q.Source.Microphone}),b.createElement(sH,null),b.createElement("div",{className:"lk-participant-metadata"},b.createElement("div",{className:"lk-participant-metadata-item"},b.createElement(tH,{source:Q.Source.Microphone}),b.createElement(eH,null)),b.createElement(q8,{className:"lk-participant-metadata-item"})))))}function cH(t){var e=t,{entry:n,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:o}=e,s=_n(e,["entry","hideName","hideTimestamp","messageFormatter"]),a,l,c,u;const d=b.useMemo(()=>o?o(n.message):n.message,[n.message,o]),f=new Date(n.timestamp),h=navigator?navigator.language:"en-US";return b.createElement("li",Me({className:"lk-chat-entry",title:f.toLocaleTimeString(h,{timeStyle:"full"}),"data-lk-message-origin":(a=n.from)!=null&&a.isLocal?"local":"remote"},s),(!i||!r)&&b.createElement("span",{className:"lk-meta-data"},!r&&b.createElement("strong",{className:"lk-participant-name"},(u=(l=n.from)==null?void 0:l.name)!=null?u:(c=n.from)==null?void 0:c.identity),!i&&b.createElement("span",{className:"lk-timestamp"},f.toLocaleTimeString(h,{timeStyle:"short"}))),b.createElement("span",{className:"lk-message-body"},d))}function uH(t){var e=t,{messageFormatter:n,messageDecoder:r,messageEncoder:i,channelTopic:o}=e,s=_n(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const a=b.useRef(null),l=b.useRef(null),c=b.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:o}),[r,i,o]),{send:u,chatMessages:d,isSending:f}=A8(c),h=yN(),p=b.useRef(0);function g(C){return vN(this,null,function*(){C.preventDefault(),a.current&&a.current.value.trim()!==""&&u&&(yield u(a.current.value),a.current.value="",a.current.focus())})}return b.useEffect(()=>{var C;l&&((C=l.current)==null||C.scrollTo({top:l.current.scrollHeight}))},[l,d]),b.useEffect(()=>{var C,m,v,S,E;if(!h||d.length===0)return;if((C=h.widget.state)!=null&&C.showChat&&d.length>0&&p.current!==((m=d[d.length-1])==null?void 0:m.timestamp)){p.current=(v=d[d.length-1])==null?void 0:v.timestamp;return}const w=d.filter(x=>!p.current||x.timestamp>p.current).length,{widget:A}=h;w>0&&((S=A.state)==null?void 0:S.unreadMessages)!==w&&((E=A.dispatch)==null||E.call(A,{msg:"unread_msg",count:w}))},[d,h==null?void 0:h.widget]),b.createElement("div",Gn(Me({},s),{className:"lk-chat"}),b.createElement("ul",{className:"lk-list lk-chat-messages",ref:l},s.children?d.map((C,m)=>CN(s.children,{entry:C,key:m,messageFormatter:n})):d.map((C,m,v)=>{const S=m>=1&&v[m-1].from===C.from,E=m>=1&&C.timestamp-v[m-1].timestamp<6e4;return b.createElement(cH,{key:m,hideName:S,hideTimestamp:S===!1?!1:E,entry:C,messageFormatter:n})})),b.createElement("form",{className:"lk-chat-form",onSubmit:g},b.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:f,ref:a,type:"text",placeholder:"Enter a message..."}),b.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:f},"Send")))}function xA(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,tracks:o,requestPermissions:s=!1}=e,a=_n(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[l,c]=b.useState(!1),[u,d]=b.useState([]),[f,h]=b.useState(!0),p=(v,S)=>{at.debug("handle device change"),c(!1),i==null||i(v,S)},g=b.useRef(null),C=b.useRef(null);b.useLayoutEffect(()=>{g.current&&C.current&&(u||f)&&qj(g.current,C.current).then(({x:v,y:S})=>{C.current&&Object.assign(C.current.style,{left:`${v}px`,top:`${S}px`})}),h(!1)},[g,C,u,f]);const m=b.useCallback(v=>{C.current&&v.target!==g.current&&l&&eZ(C.current,v)&&c(!1)},[l,C,g]);return b.useEffect(()=>(document.addEventListener("click",m),window.addEventListener("resize",()=>h(!0)),()=>{document.removeEventListener("click",m),window.removeEventListener("resize",()=>h(!0))}),[m,h]),b.createElement(b.Fragment,null,b.createElement("button",Gn(Me({className:"lk-button lk-button-menu","aria-pressed":l},a),{onClick:()=>c(!l),ref:g}),a.children),!a.disabled&&b.createElement("div",{className:"lk-device-menu",ref:C,style:{visibility:l?"visible":"hidden"}},n?b.createElement(_m,{initialSelection:r,onActiveDeviceChange:v=>p(n,v),onDeviceListChange:d,kind:n,track:o==null?void 0:o[n],requestPermissions:s}):b.createElement(b.Fragment,null,b.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),b.createElement(_m,{kind:"audioinput",onActiveDeviceChange:v=>p("audioinput",v),onDeviceListChange:d,track:o==null?void 0:o.audioinput,requestPermissions:s}),b.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),b.createElement(_m,{kind:"videoinput",onActiveDeviceChange:v=>p("videoinput",v),onDeviceListChange:d,track:o==null?void 0:o.videoinput,requestPermissions:s}))))}function dH(t){var e=t,{label:n}=e,r=_n(e,["label"]);const i=mg(),{mergedProps:o,canPlayAudio:s}=y8({room:i,props:r}),{mergedProps:a,canPlayVideo:l}=C8({room:i,props:o}),c=a,{style:u}=c,d=_n(c,["style"]);return u.display=s&&l?"none":"block",b.createElement("button",Me({style:u},d),n??`Start ${s?"Video":"Audio"}`)}function fH(t){var e=t,{variation:n,controls:r,saveUserChoices:i=!0}=e,o=_n(e,["variation","controls","saveUserChoices"]),s,a,l,c,u;const[d,f]=b.useState(!1),h=yN();b.useEffect(()=>{var z,Z;((z=h==null?void 0:h.widget.state)==null?void 0:z.showChat)!==void 0&&f((Z=h==null?void 0:h.widget.state)==null?void 0:Z.showChat)},[(s=h==null?void 0:h.widget.state)==null?void 0:s.showChat]);const g=JZ(`(max-width: ${d?1e3:760}px)`)?"minimal":"verbose";n??(n=g);const C=Me({leave:!0},r),m=f8();m?((a=C.camera)!=null||(C.camera=m.canPublish),(l=C.microphone)!=null||(C.microphone=m.canPublish),(c=C.screenShare)!=null||(C.screenShare=m.canPublish),(u=C.chat)!=null||(C.chat=m.canPublishData&&(r==null?void 0:r.chat))):(C.camera=!1,C.chat=!1,C.microphone=!1,C.screenShare=!1);const v=b.useMemo(()=>n==="minimal"||n==="verbose",[n]),S=b.useMemo(()=>n==="textOnly"||n==="verbose",[n]),E=iZ(),[w,A]=b.useState(!1),x=z=>{A(z)},T=Xc({className:"lk-control-bar"},o),{saveAudioInputEnabled:_,saveVideoInputEnabled:O,saveAudioInputDeviceId:L,saveVideoInputDeviceId:U}=k8({preventSave:!i});return b.createElement("div",Me({},T),C.microphone&&b.createElement("div",{className:"lk-button-group"},b.createElement(Om,{source:Q.Source.Microphone,showIcon:v,onChange:_},S&&"Microphone"),b.createElement("div",{className:"lk-button-group-menu"},b.createElement(xA,{kind:"audioinput",onActiveDeviceChange:(z,Z)=>L(Z??"")}))),C.camera&&b.createElement("div",{className:"lk-button-group"},b.createElement(Om,{source:Q.Source.Camera,showIcon:v,onChange:O},S&&"Camera"),b.createElement("div",{className:"lk-button-group-menu"},b.createElement(xA,{kind:"videoinput",onActiveDeviceChange:(z,Z)=>U(Z??"")}))),C.screenShare&&E&&b.createElement(Om,{source:Q.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:v,onChange:x},S&&(w?"Stop screen share":"Share screen")),C.chat&&b.createElement(E8,null,v&&b.createElement(O8,null),S&&"Chat"),C.leave&&b.createElement(T8,null,v&&b.createElement(D8,null),S&&"Leave"),b.createElement(dH,null))}function hH(t){var e=_n(t,[]);const[n,r]=b.useState({showChat:!1,unreadMessages:0}),i=v8();return b.createElement(iH,{onWidgetChange:r},b.createElement("div",Me({className:"lk-audio-conference"},e),b.createElement("div",{className:"lk-audio-conference-stage"},b.createElement(aH,{participants:i},b.createElement(lH,null))),b.createElement(fH,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),n.showChat&&b.createElement(uH,null)))}const pH="wss://mongoose-67t79p35.livekit.cloud",gH=({client:t})=>{const[e,n]=b.useState([]),[r,i]=b.useState(!1);return b.useEffect(()=>{const o=a=>{n(l=>[...l,a]),i(!0)},s=a=>{n(l=>{const c=l.filter(u=>u!==a);return c.length===0&&i(!1),c})};return t.on("livekitToken",o),t.on("livekitLeave",s),()=>{t.off("livekitToken",o),t.off("livekitLeave",s)}},[t]),e.length?Y.jsxs("div",{"data-lk-theme":"default",children:[e.map((o,s)=>Y.jsx(oH,{video:!1,audio:!0,token:o,serverUrl:pH,connect:!0,onDisconnected:()=>t.emit("livekitLeave",o),children:Y.jsx(hH,{})},s)),Y.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null};function mH(){const[t,e]=b.useState(null),[n,r]=b.useState(!1),[i,o]=b.useState([]),s=dt.useRef(null),a=dt.useRef(null),l=dt.useRef(null),c=b.useRef(!1),u=()=>{s.current&&s.current.saveLog()},d=()=>{s.current&&s.current.clearLog()},f=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return b.useEffect(()=>{if(c.current)return;const h=new nV("mongoose.moo.mud.org",8765);h.registerGMCPPackage(Z4),h.registerGMCPPackage(V4),h.registerGMCPPackage(G4),h.registerGMCPPackage(MB),h.registerGMCPPackage(H4),h.registerGMCPPackage(W4),h.registerGMCPPackage(j4),h.registerGMCPPackage(_B),h.registerGMCPPackage(z4),h.registerMcpPackage(J4),h.registerMcpPackage(Y4),h.registerMcpPackage(q4),h.registerMcpPackage(eV),h.connect(),h.requestNotificationPermission(),e(h),r(!f),window.mudClient=h,c.current=!0;const p=C=>{h&&(C.key==="Control"&&h.cancelSpeech(),C.key==="Escape"&&h.stopAllSounds())};window.addEventListener("keydown",p);const g=()=>{var C;(C=a.current)==null||C.focus()};return document.addEventListener("focus",g),()=>{window.removeEventListener("keydown",p),document.removeEventListener("focus",g)}},[f]),b.useEffect(()=>{if(t){const h=g=>{o(g)},p=()=>{o([])};return t.on("userlist",h),t.on("disconnect",p),()=>{t.off("userlist",h),t.off("disconnect",p)}}},[t]),gE(h=>{t&&t.shutdown()}),t?Y.jsxs("div",{className:"App",children:[Y.jsx("header",{className:"App-header"}),Y.jsx(YG,{client:t,onSaveLog:u,onClearLog:d,onToggleUsers:()=>r(!n),onOpenPrefs:()=>{var h;return(h=l.current)==null?void 0:h.open()}}),Y.jsxs("div",{children:[Y.jsx(zv,{client:t,ref:s}),n&&Y.jsx(qG,{users:i}),Y.jsx(gH,{client:t})]}),Y.jsx(iV,{onSend:t.sendCommand,inputRef:a}),Y.jsx(QG,{client:t}),Y.jsx(BG,{ref:l})]}):null}function vH(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function NA(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?PA(Object(n),!0).forEach(function(r){vH(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):PA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function yH(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function CH(t,e){if(t==null)return{};var n=yH(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function IH(t,e){return SH(t)||bH(t,e)||wH(t,e)||AH()}function SH(t){if(Array.isArray(t))return t}function bH(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var s=t[Symbol.iterator](),a;!(r=(a=s.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(l){i=!0,o=l}finally{try{!r&&s.return!=null&&s.return()}finally{if(i)throw o}}return n}}function wH(t,e){if(t){if(typeof t=="string")return _A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _A(t,e)}}function _A(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function AH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kH(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function MA(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?OA(Object(n),!0).forEach(function(r){kH(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):OA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function EH(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return e.reduceRight(function(i,o){return o(i)},r)}}function Du(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return e.apply(n,[].concat(i,a))}}}function Pp(t){return{}.toString.call(t).includes("Object")}function TH(t){return!Object.keys(t).length}function Md(t){return typeof t=="function"}function RH(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function xH(t,e){return Pp(e)||sa("changeType"),Object.keys(e).some(function(n){return!RH(t,n)})&&sa("changeField"),e}function PH(t){Md(t)||sa("selectorType")}function NH(t){Md(t)||Pp(t)||sa("handlerType"),Pp(t)&&Object.values(t).some(function(e){return!Md(e)})&&sa("handlersType")}function _H(t){t||sa("initialIsRequired"),Pp(t)||sa("initialType"),TH(t)&&sa("initialContent")}function OH(t,e){throw new Error(t[e]||t.default)}var MH={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},sa=Du(OH)(MH),Ff={changes:xH,selector:PH,handler:NH,initial:_H};function DH(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ff.initial(t),Ff.handler(e);var n={current:t},r=Du(FH)(n,e),i=Du(BH)(n),o=Du(Ff.changes)(t),s=Du(LH)(n);function a(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return Ff.selector(c),c(n.current)}function l(c){EH(r,i,o,s)(c)}return[a,l]}function LH(t,e){return Md(e)?e(t.current):e}function BH(t,e){return t.current=MA(MA({},t.current),e),e}function FH(t,e,n){return Md(e)?e(t.current):Object.keys(n).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,t.current[r])}),n}var UH={create:DH},VH={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function GH(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return e.apply(n,[].concat(i,a))}}}function WH(t){return{}.toString.call(t).includes("Object")}function jH(t){return t||DA("configIsRequired"),WH(t)||DA("configType"),t.urls?(ZH(),{paths:{vs:t.urls.monacoBase}}):t}function ZH(){console.warn(bN.deprecation)}function HH(t,e){throw new Error(t[e]||t.default)}var bN={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},DA=GH(HH)(bN),zH={config:jH},XH=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(o,s){return s(o)},i)}};function wN(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],wN(t[n],e[n]))}),NA(NA({},t),e)}var $H={type:"cancelation",msg:"operation is manually canceled"};function Mm(t){var e=!1,n=new Promise(function(r,i){t.then(function(o){return e?i($H):r(o)}),t.catch(i)});return n.cancel=function(){return e=!0},n}var KH=UH.create({config:VH,isInitialized:!1,resolve:null,reject:null,monaco:null}),AN=IH(KH,2),nf=AN[0],yg=AN[1];function JH(t){var e=zH.config(t),n=e.monaco,r=CH(e,["monaco"]);yg(function(i){return{config:wN(i.config,r),monaco:n}})}function YH(){var t=nf(function(e){var n=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!t.isInitialized){if(yg({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),Mm(Dm);if(window.monaco&&window.monaco.editor)return kN(window.monaco),t.resolve(window.monaco),Mm(Dm);XH(QH,e7)(t7)}return Mm(Dm)}function QH(t){return document.body.appendChild(t)}function qH(t){var e=document.createElement("script");return t&&(e.src=t),e}function e7(t){var e=nf(function(r){var i=r.config,o=r.reject;return{config:i,reject:o}}),n=qH("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function t7(){var t=nf(function(n){var r=n.config,i=n.resolve,o=n.reject;return{config:r,resolve:i,reject:o}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){kN(n),t.resolve(n)},function(n){t.reject(n)})}function kN(t){nf().monaco||yg({monaco:t})}function n7(){return nf(function(t){var e=t.monaco;return e})}var Dm=new Promise(function(t,e){return yg({resolve:t,reject:e})}),EN={config:JH,init:YH,__getMonacoInstance:n7},r7={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Lm=r7,i7={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},o7=i7;function s7({children:t}){return dt.createElement("div",{style:o7.container},t)}var a7=s7,l7=a7;function c7({width:t,height:e,isEditorReady:n,loading:r,_ref:i,className:o,wrapperProps:s}){return dt.createElement("section",{style:{...Lm.wrapper,width:t,height:e},...s},!n&&dt.createElement(l7,null,r),dt.createElement("div",{ref:i,style:{...Lm.fullWidth,...!n&&Lm.hide},className:o}))}var u7=c7,TN=b.memo(u7);function d7(t){b.useEffect(t,[])}var RN=d7;function f7(t,e,n=!0){let r=b.useRef(!0);b.useEffect(r.current||!n?()=>{r.current=!1}:t,e)}var Fr=f7;function Yu(){}function Zl(t,e,n,r){return h7(t,r)||p7(t,e,n,r)}function h7(t,e){return t.editor.getModel(xN(t,e))}function p7(t,e,n,r){return t.editor.createModel(e,n,r?xN(t,r):void 0)}function xN(t,e){return t.Uri.parse(e)}function g7({original:t,modified:e,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:o,modifiedModelPath:s,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:l=!1,theme:c="light",loading:u="Loading...",options:d={},height:f="100%",width:h="100%",className:p,wrapperProps:g={},beforeMount:C=Yu,onMount:m=Yu}){let[v,S]=b.useState(!1),[E,w]=b.useState(!0),A=b.useRef(null),x=b.useRef(null),T=b.useRef(null),_=b.useRef(m),O=b.useRef(C),L=b.useRef(!1);RN(()=>{let K=EN.init();return K.then(ee=>(x.current=ee)&&w(!1)).catch(ee=>(ee==null?void 0:ee.type)!=="cancelation"&&console.error("Monaco initialization: error:",ee)),()=>A.current?Z():K.cancel()}),Fr(()=>{if(A.current&&x.current){let K=A.current.getOriginalEditor(),ee=Zl(x.current,t||"",r||n||"text",o||"");ee!==K.getModel()&&K.setModel(ee)}},[o],v),Fr(()=>{if(A.current&&x.current){let K=A.current.getModifiedEditor(),ee=Zl(x.current,e||"",i||n||"text",s||"");ee!==K.getModel()&&K.setModel(ee)}},[s],v),Fr(()=>{let K=A.current.getModifiedEditor();K.getOption(x.current.editor.EditorOption.readOnly)?K.setValue(e||""):e!==K.getValue()&&(K.executeEdits("",[{range:K.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),K.pushUndoStop())},[e],v),Fr(()=>{var K,ee;(ee=(K=A.current)==null?void 0:K.getModel())==null||ee.original.setValue(t||"")},[t],v),Fr(()=>{let{original:K,modified:ee}=A.current.getModel();x.current.editor.setModelLanguage(K,r||n||"text"),x.current.editor.setModelLanguage(ee,i||n||"text")},[n,r,i],v),Fr(()=>{var K;(K=x.current)==null||K.editor.setTheme(c)},[c],v),Fr(()=>{var K;(K=A.current)==null||K.updateOptions(d)},[d],v);let U=b.useCallback(()=>{var re;if(!x.current)return;O.current(x.current);let K=Zl(x.current,t||"",r||n||"text",o||""),ee=Zl(x.current,e||"",i||n||"text",s||"");(re=A.current)==null||re.setModel({original:K,modified:ee})},[n,e,i,t,r,o,s]),z=b.useCallback(()=>{var K;!L.current&&T.current&&(A.current=x.current.editor.createDiffEditor(T.current,{automaticLayout:!0,...d}),U(),(K=x.current)==null||K.editor.setTheme(c),S(!0),L.current=!0)},[d,c,U]);b.useEffect(()=>{v&&_.current(A.current,x.current)},[v]),b.useEffect(()=>{!E&&!v&&z()},[E,v,z]);function Z(){var ee,re,X,J;let K=(ee=A.current)==null?void 0:ee.getModel();a||((re=K==null?void 0:K.original)==null||re.dispose()),l||((X=K==null?void 0:K.modified)==null||X.dispose()),(J=A.current)==null||J.dispose()}return dt.createElement(TN,{width:h,height:f,isEditorReady:v,loading:u,_ref:T,className:p,wrapperProps:g})}var m7=g7;b.memo(m7);function v7(t){let e=b.useRef();return b.useEffect(()=>{e.current=t},[t]),e.current}var y7=v7,Uf=new Map;function C7({defaultValue:t,defaultLanguage:e,defaultPath:n,value:r,language:i,path:o,theme:s="light",line:a,loading:l="Loading...",options:c={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:f=!1,width:h="100%",height:p="100%",className:g,wrapperProps:C={},beforeMount:m=Yu,onMount:v=Yu,onChange:S,onValidate:E=Yu}){let[w,A]=b.useState(!1),[x,T]=b.useState(!0),_=b.useRef(null),O=b.useRef(null),L=b.useRef(null),U=b.useRef(v),z=b.useRef(m),Z=b.useRef(),K=b.useRef(r),ee=y7(o),re=b.useRef(!1),X=b.useRef(!1);RN(()=>{let W=EN.init();return W.then(se=>(_.current=se)&&T(!1)).catch(se=>(se==null?void 0:se.type)!=="cancelation"&&console.error("Monaco initialization: error:",se)),()=>O.current?oe():W.cancel()}),Fr(()=>{var se,we,De,de;let W=Zl(_.current,t||r||"",e||i||"",o||n||"");W!==((se=O.current)==null?void 0:se.getModel())&&(d&&Uf.set(ee,(we=O.current)==null?void 0:we.saveViewState()),(De=O.current)==null||De.setModel(W),d&&((de=O.current)==null||de.restoreViewState(Uf.get(o))))},[o],w),Fr(()=>{var W;(W=O.current)==null||W.updateOptions(c)},[c],w),Fr(()=>{!O.current||r===void 0||(O.current.getOption(_.current.editor.EditorOption.readOnly)?O.current.setValue(r):r!==O.current.getValue()&&(X.current=!0,O.current.executeEdits("",[{range:O.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),O.current.pushUndoStop(),X.current=!1))},[r],w),Fr(()=>{var se,we;let W=(se=O.current)==null?void 0:se.getModel();W&&i&&((we=_.current)==null||we.editor.setModelLanguage(W,i))},[i],w),Fr(()=>{var W;a!==void 0&&((W=O.current)==null||W.revealLine(a))},[a],w),Fr(()=>{var W;(W=_.current)==null||W.editor.setTheme(s)},[s],w);let J=b.useCallback(()=>{var W;if(!(!L.current||!_.current)&&!re.current){z.current(_.current);let se=o||n,we=Zl(_.current,r||t||"",e||i||"",se||"");O.current=(W=_.current)==null?void 0:W.editor.create(L.current,{model:we,automaticLayout:!0,...c},u),d&&O.current.restoreViewState(Uf.get(se)),_.current.editor.setTheme(s),a!==void 0&&O.current.revealLine(a),A(!0),re.current=!0}},[t,e,n,r,i,o,c,u,d,s,a]);b.useEffect(()=>{w&&U.current(O.current,_.current)},[w]),b.useEffect(()=>{!x&&!w&&J()},[x,w,J]),K.current=r,b.useEffect(()=>{var W,se;w&&S&&((W=Z.current)==null||W.dispose(),Z.current=(se=O.current)==null?void 0:se.onDidChangeModelContent(we=>{X.current||S(O.current.getValue(),we)}))},[w,S]),b.useEffect(()=>{if(w){let W=_.current.editor.onDidChangeMarkers(se=>{var De;let we=(De=O.current.getModel())==null?void 0:De.uri;if(we&&se.find(de=>de.path===we.path)){let de=_.current.editor.getModelMarkers({resource:we});E==null||E(de)}});return()=>{W==null||W.dispose()}}return()=>{}},[w,E]);function oe(){var W,se;(W=Z.current)==null||W.dispose(),f?d&&Uf.set(o,O.current.saveViewState()):(se=O.current.getModel())==null||se.dispose(),O.current.dispose()}return dt.createElement(TN,{width:h,height:p,isEditorReady:w,loading:l,_ref:L,className:g,wrapperProps:C})}var I7=C7,S7=b.memo(I7),b7=S7,w7={restoreOnUnmount:!1};function A7(t,e){e===void 0&&(e=w7);var n=b.useRef(document.title);document.title!==t&&(document.title=t),b.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=n.current}},[])}const k7=typeof document<"u"?A7:function(t){};function E7({onSave:t,onRevert:e,onDownload:n}){return Y.jsx("div",{className:"toolbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderBottom:"1px solid #e8e8e8"},children:Y.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[Y.jsxs("button",{onClick:t,accessKey:"s",children:[Y.jsx(rx,{}),"Save"]}),Y.jsxs("button",{onClick:e,accessKey:"r",children:[Y.jsx($G,{}),"Revert"]}),Y.jsxs("button",{onClick:n,accessKey:"d",children:[Y.jsx(zG,{}),"Download"]})]})})}const T7=({docstate:t,session:e})=>Y.jsxs("div",{"aria-live":"polite",className:"statusbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderTop:"1px solid #e8e8e8"},children:[Y.jsx("span",{children:t}),Y.jsx("span",{children:"|"}),Y.jsx("span",{children:e.reference}),Y.jsx("span",{children:"|"}),Y.jsx("span",{children:e.type})]});function R7(){const t=pE(),e=dt.useRef(null),[n,r]=b.useState(""),[i,o]=b.useState(""),[s,a]=b.useState(""),[l,c]=b.useState(0),[u,d]=b.useState({name:"none",contents:[],reference:"",type:""}),f=(z,Z)=>{e.current=z},[h,p]=Ia();console.log(h);const g=h.editor.accessibilityMode,C=h.editor.autocompleteEnabled;gE(z=>{w.postMessage({type:"close",id:x}),l===1&&z.preventDefault()});const[m,v]=b.useState(!1),S=m?`${u.name} - Mongoose Editor`:"Mongoose Editor";k7(S);const E=b.useMemo(()=>{switch(l){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[l]),w=b.useMemo(()=>new BroadcastChannel("editor"),[]),A=new URLSearchParams(t.search),x=decodeURIComponent(A.get("reference")||"");b.useEffect(()=>{if(!x)return;console.log("ID: "+x),console.log("Sending ready message"),w.postMessage({type:"ready",id:x});const z=Z=>{if(console.log(Z.data),Z.data.type==="load"){if(n!=="")return;const K=Z.data.session.contents.join(`
`);o(K),a(K),d(Z.data.session),c(0),r(Z.data.clientId),setTimeout(U,100)}else if(Z.data.type==="shutdown"){if(Z.data.clientId!==n)return;w.close(),window.close()}};return w.addEventListener("message",z),()=>w.removeEventListener("message",z)},[w,n,x]);const T=()=>{o(s),c(0)},_=z=>{const Z=i.split(/\r\n|\r|\n/),K={...u,contents:Z};w.postMessage({type:"save",session:K,id:x}),c(2),U(),z.preventDefault()},O=z=>{z!==void 0&&(console.log("Original: "+s),console.log("New: "+z),o(z),z.split(/\r\n|\r|\n/).join(`
`)!==s?c(1):c(0),m||v(!0))},L=()=>{const z=new Blob([i],{type:"text/plain"}),Z=URL.createObjectURL(z),K=document.createElement("a"),ee=new Date,re=ee.toLocaleDateString().replace(/\//g,"-"),X=ee.toLocaleTimeString().replace(/:/g,"-"),J=`${u.name}-${re}-${X}.txt`;K.download=J,K.href=Z,K.click(),URL.revokeObjectURL(Z),K.remove()};return Y.jsxs("div",{id:"editor",children:[Y.jsx(E7,{onSave:_,onRevert:T,onDownload:L}),Y.jsx(b7,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:O,options:{wordWrap:"on",accessibilitySupport:g?"on":"off",quickSuggestions:C},onMount:f,path:u.reference}),Y.jsx(T7,{docstate:E,session:u})]});function U(){e.current!==null&&e.current.focus()}}const x7="modulepreload",P7=function(t){return"/"+t},LA={},N7=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.all(n.map(a=>{if(a=P7(a),a in LA)return;LA[a]=!0;const l=a.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":x7,l||(u.as="script",u.crossOrigin=""),u.href=a,s&&u.setAttribute("nonce",s),document.head.appendChild(u),l)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})}))}return i.then(()=>e()).catch(o=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o})},_7=t=>{t&&t instanceof Function&&N7(async()=>{const{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}=await import("./web-vitals-DdRmOIVa.js");return{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}},[]).then(({getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o})=>{e(t),n(t),r(t),i(t),o(t)})};var BA={};const O7=!!(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function M7(t){if("serviceWorker"in navigator){if(new URL(BA.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const n=`${BA.PUBLIC_URL}/service-worker.js`;O7?(D7(n),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):PN(n)})}}function PN(t,e){navigator.serviceWorker.register(t).then(n=>{n.onupdatefound=()=>{const r=n.installing;r!=null&&(r.onstatechange=()=>{r.state==="installed"&&(navigator.serviceWorker.controller?console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."):console.log("Content is cached for offline use."))})}}).catch(n=>{console.error("Error during service worker registration:",n)})}function D7(t,e){fetch(t).then(n=>{const r=n.headers.get("content-type");n.status===404||r!=null&&r.indexOf("javascript")===-1?navigator.serviceWorker.ready.then(i=>{i.unregister().then(()=>{window.location.reload()})}):PN(t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}const L7=SD([{path:"/",element:Y.jsx(mH,{})},{path:"/editor",element:Y.jsx(R7,{})}]),B7=Bm.createRoot(document.getElementById("root"));B7.render(Y.jsx(dt.StrictMode,{children:Y.jsx(PD,{router:L7})}));_7(console.log);M7();

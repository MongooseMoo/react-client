var ER=Object.defineProperty;var RC=t=>{throw TypeError(t)};var TR=(t,e,n)=>e in t?ER(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var U=(t,e,n)=>TR(t,typeof e!="symbol"?e+"":e,n),Fp=(t,e,n)=>e.has(t)||RC("Cannot "+n);var N=(t,e,n)=>(Fp(t,e,"read from private field"),n?n.call(t):e.get(t)),He=(t,e,n)=>e.has(t)?RC("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),be=(t,e,n,r)=>(Fp(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ie=(t,e,n)=>(Fp(t,e,"access private method"),n);var xd=(t,e,n,r)=>({set _(i){be(t,e,i,n)},get _(){return N(t,e,r)}});function Zw(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var xR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function od(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var zw={exports:{}},Kf={},Hw={exports:{}},Fe={},sd=Symbol.for("react.element"),PR=Symbol.for("react.portal"),RR=Symbol.for("react.fragment"),NR=Symbol.for("react.strict_mode"),_R=Symbol.for("react.profiler"),MR=Symbol.for("react.provider"),OR=Symbol.for("react.context"),DR=Symbol.for("react.forward_ref"),LR=Symbol.for("react.suspense"),BR=Symbol.for("react.memo"),FR=Symbol.for("react.lazy"),NC=Symbol.iterator;function UR(t){return t===null||typeof t!="object"?null:(t=NC&&t[NC]||t["@@iterator"],typeof t=="function"?t:null)}var Xw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$w=Object.assign,Kw={};function al(t,e,n){this.props=t,this.context=e,this.refs=Kw,this.updater=n||Xw}al.prototype.isReactComponent={};al.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};al.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Jw(){}Jw.prototype=al.prototype;function d0(t,e,n){this.props=t,this.context=e,this.refs=Kw,this.updater=n||Xw}var h0=d0.prototype=new Jw;h0.constructor=d0;$w(h0,al.prototype);h0.isPureReactComponent=!0;var _C=Array.isArray,Yw=Object.prototype.hasOwnProperty,f0={current:null},Qw={key:!0,ref:!0,__self:!0,__source:!0};function qw(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)Yw.call(e,r)&&!Qw.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:sd,type:t,key:o,ref:s,props:i,_owner:f0.current}}function VR(t,e){return{$$typeof:sd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function p0(t){return typeof t=="object"&&t!==null&&t.$$typeof===sd}function GR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var MC=/\/+/g;function Up(t,e){return typeof t=="object"&&t!==null&&t.key!=null?GR(""+t.key):e.toString(36)}function ih(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case sd:case PR:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+Up(s,0):r,_C(i)?(n="",t!=null&&(n=t.replace(MC,"$&/")+"/"),ih(i,e,n,"",function(l){return l})):i!=null&&(p0(i)&&(i=VR(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(MC,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",_C(t))for(var a=0;a<t.length;a++){o=t[a];var c=r+Up(o,a);s+=ih(o,e,n,c,i)}else if(c=UR(t),typeof c=="function")for(t=c.call(t),a=0;!(o=t.next()).done;)o=o.value,c=r+Up(o,a++),s+=ih(o,e,n,c,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Pd(t,e,n){if(t==null)return t;var r=[],i=0;return ih(t,r,"","",function(o){return e.call(n,o,i++)}),r}function WR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Vn={current:null},oh={transition:null},jR={ReactCurrentDispatcher:Vn,ReactCurrentBatchConfig:oh,ReactCurrentOwner:f0};function e1(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:Pd,forEach:function(t,e,n){Pd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Pd(t,function(){e++}),e},toArray:function(t){return Pd(t,function(e){return e})||[]},only:function(t){if(!p0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Fe.Component=al;Fe.Fragment=RR;Fe.Profiler=_R;Fe.PureComponent=d0;Fe.StrictMode=NR;Fe.Suspense=LR;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jR;Fe.act=e1;Fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=$w({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=f0.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)Yw.call(e,c)&&!Qw.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:sd,type:t.type,key:i,ref:o,props:r,_owner:s}};Fe.createContext=function(t){return t={$$typeof:OR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:MR,_context:t},t.Consumer=t};Fe.createElement=qw;Fe.createFactory=function(t){var e=qw.bind(null,t);return e.type=t,e};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(t){return{$$typeof:DR,render:t}};Fe.isValidElement=p0;Fe.lazy=function(t){return{$$typeof:FR,_payload:{_status:-1,_result:t},_init:WR}};Fe.memo=function(t,e){return{$$typeof:BR,type:t,compare:e===void 0?null:e}};Fe.startTransition=function(t){var e=oh.transition;oh.transition={};try{t()}finally{oh.transition=e}};Fe.unstable_act=e1;Fe.useCallback=function(t,e){return Vn.current.useCallback(t,e)};Fe.useContext=function(t){return Vn.current.useContext(t)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(t){return Vn.current.useDeferredValue(t)};Fe.useEffect=function(t,e){return Vn.current.useEffect(t,e)};Fe.useId=function(){return Vn.current.useId()};Fe.useImperativeHandle=function(t,e,n){return Vn.current.useImperativeHandle(t,e,n)};Fe.useInsertionEffect=function(t,e){return Vn.current.useInsertionEffect(t,e)};Fe.useLayoutEffect=function(t,e){return Vn.current.useLayoutEffect(t,e)};Fe.useMemo=function(t,e){return Vn.current.useMemo(t,e)};Fe.useReducer=function(t,e,n){return Vn.current.useReducer(t,e,n)};Fe.useRef=function(t){return Vn.current.useRef(t)};Fe.useState=function(t){return Vn.current.useState(t)};Fe.useSyncExternalStore=function(t,e,n){return Vn.current.useSyncExternalStore(t,e,n)};Fe.useTransition=function(){return Vn.current.useTransition()};Fe.version="18.3.1";Hw.exports=Fe;var b=Hw.exports;const nt=od(b),ZR=Zw({__proto__:null,default:nt},[b]);var zR=b,HR=Symbol.for("react.element"),XR=Symbol.for("react.fragment"),$R=Object.prototype.hasOwnProperty,KR=zR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,JR={key:!0,ref:!0,__self:!0,__source:!0};function t1(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)$R.call(e,r)&&!JR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:HR,type:t,key:o,ref:s,props:i,_owner:KR.current}}Kf.Fragment=XR;Kf.jsx=t1;Kf.jsxs=t1;zw.exports=Kf;var X=zw.exports,Kg={},n1={exports:{}},kr={},r1={exports:{}},i1={};(function(t){function e(W,Y){var re=W.length;W.push(Y);e:for(;0<re;){var H=re-1>>>1,te=W[H];if(0<i(te,Y))W[H]=Y,W[re]=te,re=H;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var Y=W[0],re=W.pop();if(re!==Y){W[0]=re;e:for(var H=0,te=W.length,Ee=te>>>1;H<Ee;){var Le=2*(H+1)-1,ve=W[Le],ke=Le+1,je=W[ke];if(0>i(ve,re))ke<te&&0>i(je,ve)?(W[H]=je,W[ke]=re,H=ke):(W[H]=ve,W[Le]=re,H=Le);else if(ke<te&&0>i(je,re))W[H]=je,W[ke]=re,H=ke;else break e}}return Y}function i(W,Y){var re=W.sortIndex-Y.sortIndex;return re!==0?re:W.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var c=[],l=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,C=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var Y=n(l);Y!==null;){if(Y.callback===null)r(l);else if(Y.startTime<=W)r(l),Y.sortIndex=Y.expirationTime,e(c,Y);else break;Y=n(l)}}function E(W){if(m=!1,S(W),!p)if(n(c)!==null)p=!0,q(A);else{var Y=n(l);Y!==null&&oe(E,Y.startTime-W)}}function A(W,Y){p=!1,m&&(m=!1,g(T),T=-1),f=!0;var re=h;try{for(S(Y),d=n(c);d!==null&&(!(d.expirationTime>Y)||W&&!D());){var H=d.callback;if(typeof H=="function"){d.callback=null,h=d.priorityLevel;var te=H(d.expirationTime<=Y);Y=t.unstable_now(),typeof te=="function"?d.callback=te:d===n(c)&&r(c),S(Y)}else r(c);d=n(c)}if(d!==null)var Ee=!0;else{var Le=n(l);Le!==null&&oe(E,Le.startTime-Y),Ee=!1}return Ee}finally{d=null,h=re,f=!1}}var P=!1,w=null,T=-1,_=5,M=-1;function D(){return!(t.unstable_now()-M<_)}function B(){if(w!==null){var W=t.unstable_now();M=W;var Y=!0;try{Y=w(!0,W)}finally{Y?j():(P=!1,w=null)}}else P=!1}var j;if(typeof y=="function")j=function(){y(B)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,z=Z.port2;Z.port1.onmessage=B,j=function(){z.postMessage(null)}}else j=function(){C(B,0)};function q(W){w=W,P||(P=!0,j())}function oe(W,Y){T=C(function(){W(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,q(A))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(W){switch(h){case 1:case 2:case 3:var Y=3;break;default:Y=h}var re=h;h=Y;try{return W()}finally{h=re}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,Y){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var re=h;h=W;try{return Y()}finally{h=re}},t.unstable_scheduleCallback=function(W,Y,re){var H=t.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?H+re:H):re=H,W){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=re+te,W={id:u++,callback:Y,priorityLevel:W,startTime:re,expirationTime:te,sortIndex:-1},re>H?(W.sortIndex=re,e(l,W),n(c)===null&&W===n(l)&&(m?(g(T),T=-1):m=!0,oe(E,re-H))):(W.sortIndex=te,e(c,W),p||f||(p=!0,q(A))),W},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(W){var Y=h;return function(){var re=h;h=Y;try{return W.apply(this,arguments)}finally{h=re}}}})(i1);r1.exports=i1;var YR=r1.exports,QR=b,wr=YR;function ie(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o1=new Set,bu={};function Wa(t,e){Zc(t,e),Zc(t+"Capture",e)}function Zc(t,e){for(bu[t]=e,t=0;t<e.length;t++)o1.add(e[t])}var zo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jg=Object.prototype.hasOwnProperty,qR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,OC={},DC={};function eN(t){return Jg.call(DC,t)?!0:Jg.call(OC,t)?!1:qR.test(t)?DC[t]=!0:(OC[t]=!0,!1)}function tN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function nN(t,e,n,r){if(e===null||typeof e>"u"||tN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Gn(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var dn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){dn[t]=new Gn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];dn[e]=new Gn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){dn[t]=new Gn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){dn[t]=new Gn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){dn[t]=new Gn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){dn[t]=new Gn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){dn[t]=new Gn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){dn[t]=new Gn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){dn[t]=new Gn(t,5,!1,t.toLowerCase(),null,!1,!1)});var g0=/[\-:]([a-z])/g;function m0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(g0,m0);dn[e]=new Gn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(g0,m0);dn[e]=new Gn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(g0,m0);dn[e]=new Gn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){dn[t]=new Gn(t,1,!1,t.toLowerCase(),null,!1,!1)});dn.xlinkHref=new Gn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){dn[t]=new Gn(t,1,!1,t.toLowerCase(),null,!0,!0)});function v0(t,e,n,r){var i=dn.hasOwnProperty(e)?dn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(nN(e,n,i,r)&&(n=null),r||i===null?eN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var es=QR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rd=Symbol.for("react.element"),ac=Symbol.for("react.portal"),cc=Symbol.for("react.fragment"),y0=Symbol.for("react.strict_mode"),Yg=Symbol.for("react.profiler"),s1=Symbol.for("react.provider"),a1=Symbol.for("react.context"),C0=Symbol.for("react.forward_ref"),Qg=Symbol.for("react.suspense"),qg=Symbol.for("react.suspense_list"),I0=Symbol.for("react.memo"),vs=Symbol.for("react.lazy"),c1=Symbol.for("react.offscreen"),LC=Symbol.iterator;function Tl(t){return t===null||typeof t!="object"?null:(t=LC&&t[LC]||t["@@iterator"],typeof t=="function"?t:null)}var Et=Object.assign,Vp;function zl(t){if(Vp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Vp=e&&e[1]||""}return`
`+Vp+t}var Gp=!1;function Wp(t,e){if(!t||Gp)return"";Gp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var c=`
`+i[s].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=s&&0<=a);break}}}finally{Gp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?zl(t):""}function rN(t){switch(t.tag){case 5:return zl(t.type);case 16:return zl("Lazy");case 13:return zl("Suspense");case 19:return zl("SuspenseList");case 0:case 2:case 15:return t=Wp(t.type,!1),t;case 11:return t=Wp(t.type.render,!1),t;case 1:return t=Wp(t.type,!0),t;default:return""}}function em(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case cc:return"Fragment";case ac:return"Portal";case Yg:return"Profiler";case y0:return"StrictMode";case Qg:return"Suspense";case qg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case a1:return(t.displayName||"Context")+".Consumer";case s1:return(t._context.displayName||"Context")+".Provider";case C0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case I0:return e=t.displayName||null,e!==null?e:em(t.type)||"Memo";case vs:e=t._payload,t=t._init;try{return em(t(e))}catch{}}return null}function iN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return em(e);case 8:return e===y0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function js(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function l1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function oN(t){var e=l1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Nd(t){t._valueTracker||(t._valueTracker=oN(t))}function u1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=l1(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Gh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function tm(t,e){var n=e.checked;return Et({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function BC(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=js(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function d1(t,e){e=e.checked,e!=null&&v0(t,"checked",e,!1)}function nm(t,e){d1(t,e);var n=js(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?rm(t,e.type,n):e.hasOwnProperty("defaultValue")&&rm(t,e.type,js(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function FC(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function rm(t,e,n){(e!=="number"||Gh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Hl=Array.isArray;function kc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+js(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function im(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ie(91));return Et({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function UC(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ie(92));if(Hl(n)){if(1<n.length)throw Error(ie(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:js(n)}}function h1(t,e){var n=js(e.value),r=js(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function VC(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function f1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function om(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?f1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _d,p1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_d=_d||document.createElement("div"),_d.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_d.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function wu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ou={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sN=["Webkit","ms","Moz","O"];Object.keys(ou).forEach(function(t){sN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ou[e]=ou[t]})});function g1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ou.hasOwnProperty(t)&&ou[t]?(""+e).trim():e+"px"}function m1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=g1(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var aN=Et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sm(t,e){if(e){if(aN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ie(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ie(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ie(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ie(62))}}function am(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cm=null;function S0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var lm=null,Ec=null,Tc=null;function GC(t){if(t=ld(t)){if(typeof lm!="function")throw Error(ie(280));var e=t.stateNode;e&&(e=ep(e),lm(t.stateNode,t.type,e))}}function v1(t){Ec?Tc?Tc.push(t):Tc=[t]:Ec=t}function y1(){if(Ec){var t=Ec,e=Tc;if(Tc=Ec=null,GC(t),e)for(t=0;t<e.length;t++)GC(e[t])}}function C1(t,e){return t(e)}function I1(){}var jp=!1;function S1(t,e,n){if(jp)return t(e,n);jp=!0;try{return C1(t,e,n)}finally{jp=!1,(Ec!==null||Tc!==null)&&(I1(),y1())}}function Au(t,e){var n=t.stateNode;if(n===null)return null;var r=ep(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ie(231,e,typeof n));return n}var um=!1;if(zo)try{var xl={};Object.defineProperty(xl,"passive",{get:function(){um=!0}}),window.addEventListener("test",xl,xl),window.removeEventListener("test",xl,xl)}catch{um=!1}function cN(t,e,n,r,i,o,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var su=!1,Wh=null,jh=!1,dm=null,lN={onError:function(t){su=!0,Wh=t}};function uN(t,e,n,r,i,o,s,a,c){su=!1,Wh=null,cN.apply(lN,arguments)}function dN(t,e,n,r,i,o,s,a,c){if(uN.apply(this,arguments),su){if(su){var l=Wh;su=!1,Wh=null}else throw Error(ie(198));jh||(jh=!0,dm=l)}}function ja(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function b1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function WC(t){if(ja(t)!==t)throw Error(ie(188))}function hN(t){var e=t.alternate;if(!e){if(e=ja(t),e===null)throw Error(ie(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return WC(i),t;if(o===r)return WC(i),e;o=o.sibling}throw Error(ie(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(ie(189))}}if(n.alternate!==r)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?t:e}function w1(t){return t=hN(t),t!==null?A1(t):null}function A1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=A1(t);if(e!==null)return e;t=t.sibling}return null}var k1=wr.unstable_scheduleCallback,jC=wr.unstable_cancelCallback,fN=wr.unstable_shouldYield,pN=wr.unstable_requestPaint,_t=wr.unstable_now,gN=wr.unstable_getCurrentPriorityLevel,b0=wr.unstable_ImmediatePriority,E1=wr.unstable_UserBlockingPriority,Zh=wr.unstable_NormalPriority,mN=wr.unstable_LowPriority,T1=wr.unstable_IdlePriority,Jf=null,Ki=null;function vN(t){if(Ki&&typeof Ki.onCommitFiberRoot=="function")try{Ki.onCommitFiberRoot(Jf,t,void 0,(t.current.flags&128)===128)}catch{}}var pi=Math.clz32?Math.clz32:IN,yN=Math.log,CN=Math.LN2;function IN(t){return t>>>=0,t===0?32:31-(yN(t)/CN|0)|0}var Md=64,Od=4194304;function Xl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function zh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Xl(a):(o&=s,o!==0&&(r=Xl(o)))}else s=n&~i,s!==0?r=Xl(s):o!==0&&(r=Xl(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-pi(e),i=1<<n,r|=t[n],e&=~i;return r}function SN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-pi(o),a=1<<s,c=i[s];c===-1?(!(a&n)||a&r)&&(i[s]=SN(a,e)):c<=e&&(t.expiredLanes|=a),o&=~a}}function hm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function x1(){var t=Md;return Md<<=1,!(Md&4194240)&&(Md=64),t}function Zp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ad(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-pi(e),t[e]=n}function wN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-pi(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function w0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-pi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ye=0;function P1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var R1,A0,N1,_1,M1,fm=!1,Dd=[],Ms=null,Os=null,Ds=null,ku=new Map,Eu=new Map,Is=[],AN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ZC(t,e){switch(t){case"focusin":case"focusout":Ms=null;break;case"dragenter":case"dragleave":Os=null;break;case"mouseover":case"mouseout":Ds=null;break;case"pointerover":case"pointerout":ku.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Eu.delete(e.pointerId)}}function Pl(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=ld(e),e!==null&&A0(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function kN(t,e,n,r,i){switch(e){case"focusin":return Ms=Pl(Ms,t,e,n,r,i),!0;case"dragenter":return Os=Pl(Os,t,e,n,r,i),!0;case"mouseover":return Ds=Pl(Ds,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return ku.set(o,Pl(ku.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Eu.set(o,Pl(Eu.get(o)||null,t,e,n,r,i)),!0}return!1}function O1(t){var e=ha(t.target);if(e!==null){var n=ja(e);if(n!==null){if(e=n.tag,e===13){if(e=b1(n),e!==null){t.blockedOn=e,M1(t.priority,function(){N1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function sh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=pm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);cm=r,n.target.dispatchEvent(r),cm=null}else return e=ld(n),e!==null&&A0(e),t.blockedOn=n,!1;e.shift()}return!0}function zC(t,e,n){sh(t)&&n.delete(e)}function EN(){fm=!1,Ms!==null&&sh(Ms)&&(Ms=null),Os!==null&&sh(Os)&&(Os=null),Ds!==null&&sh(Ds)&&(Ds=null),ku.forEach(zC),Eu.forEach(zC)}function Rl(t,e){t.blockedOn===e&&(t.blockedOn=null,fm||(fm=!0,wr.unstable_scheduleCallback(wr.unstable_NormalPriority,EN)))}function Tu(t){function e(i){return Rl(i,t)}if(0<Dd.length){Rl(Dd[0],t);for(var n=1;n<Dd.length;n++){var r=Dd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ms!==null&&Rl(Ms,t),Os!==null&&Rl(Os,t),Ds!==null&&Rl(Ds,t),ku.forEach(e),Eu.forEach(e),n=0;n<Is.length;n++)r=Is[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Is.length&&(n=Is[0],n.blockedOn===null);)O1(n),n.blockedOn===null&&Is.shift()}var xc=es.ReactCurrentBatchConfig,Hh=!0;function TN(t,e,n,r){var i=Ye,o=xc.transition;xc.transition=null;try{Ye=1,k0(t,e,n,r)}finally{Ye=i,xc.transition=o}}function xN(t,e,n,r){var i=Ye,o=xc.transition;xc.transition=null;try{Ye=4,k0(t,e,n,r)}finally{Ye=i,xc.transition=o}}function k0(t,e,n,r){if(Hh){var i=pm(t,e,n,r);if(i===null)eg(t,e,r,Xh,n),ZC(t,r);else if(kN(i,t,e,n,r))r.stopPropagation();else if(ZC(t,r),e&4&&-1<AN.indexOf(t)){for(;i!==null;){var o=ld(i);if(o!==null&&R1(o),o=pm(t,e,n,r),o===null&&eg(t,e,r,Xh,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else eg(t,e,r,null,n)}}var Xh=null;function pm(t,e,n,r){if(Xh=null,t=S0(r),t=ha(t),t!==null)if(e=ja(t),e===null)t=null;else if(n=e.tag,n===13){if(t=b1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Xh=t,null}function D1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gN()){case b0:return 1;case E1:return 4;case Zh:case mN:return 16;case T1:return 536870912;default:return 16}default:return 16}}var ws=null,E0=null,ah=null;function L1(){if(ah)return ah;var t,e=E0,n=e.length,r,i="value"in ws?ws.value:ws.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return ah=i.slice(t,1<r?1-r:void 0)}function ch(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ld(){return!0}function HC(){return!1}function Er(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Ld:HC,this.isPropagationStopped=HC,this}return Et(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ld)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ld)},persist:function(){},isPersistent:Ld}),e}var cl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},T0=Er(cl),cd=Et({},cl,{view:0,detail:0}),PN=Er(cd),zp,Hp,Nl,Yf=Et({},cd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:x0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Nl&&(Nl&&t.type==="mousemove"?(zp=t.screenX-Nl.screenX,Hp=t.screenY-Nl.screenY):Hp=zp=0,Nl=t),zp)},movementY:function(t){return"movementY"in t?t.movementY:Hp}}),XC=Er(Yf),RN=Et({},Yf,{dataTransfer:0}),NN=Er(RN),_N=Et({},cd,{relatedTarget:0}),Xp=Er(_N),MN=Et({},cl,{animationName:0,elapsedTime:0,pseudoElement:0}),ON=Er(MN),DN=Et({},cl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),LN=Er(DN),BN=Et({},cl,{data:0}),$C=Er(BN),FN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},VN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=VN[t])?!!e[t]:!1}function x0(){return GN}var WN=Et({},cd,{key:function(t){if(t.key){var e=FN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ch(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?UN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:x0,charCode:function(t){return t.type==="keypress"?ch(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ch(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),jN=Er(WN),ZN=Et({},Yf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),KC=Er(ZN),zN=Et({},cd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:x0}),HN=Er(zN),XN=Et({},cl,{propertyName:0,elapsedTime:0,pseudoElement:0}),$N=Er(XN),KN=Et({},Yf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),JN=Er(KN),YN=[9,13,27,32],P0=zo&&"CompositionEvent"in window,au=null;zo&&"documentMode"in document&&(au=document.documentMode);var QN=zo&&"TextEvent"in window&&!au,B1=zo&&(!P0||au&&8<au&&11>=au),JC=" ",YC=!1;function F1(t,e){switch(t){case"keyup":return YN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function U1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var lc=!1;function qN(t,e){switch(t){case"compositionend":return U1(e);case"keypress":return e.which!==32?null:(YC=!0,JC);case"textInput":return t=e.data,t===JC&&YC?null:t;default:return null}}function e_(t,e){if(lc)return t==="compositionend"||!P0&&F1(t,e)?(t=L1(),ah=E0=ws=null,lc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return B1&&e.locale!=="ko"?null:e.data;default:return null}}var t_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function QC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!t_[t.type]:e==="textarea"}function V1(t,e,n,r){v1(r),e=$h(e,"onChange"),0<e.length&&(n=new T0("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var cu=null,xu=null;function n_(t){Y1(t,0)}function Qf(t){var e=hc(t);if(u1(e))return t}function r_(t,e){if(t==="change")return e}var G1=!1;if(zo){var $p;if(zo){var Kp="oninput"in document;if(!Kp){var qC=document.createElement("div");qC.setAttribute("oninput","return;"),Kp=typeof qC.oninput=="function"}$p=Kp}else $p=!1;G1=$p&&(!document.documentMode||9<document.documentMode)}function eI(){cu&&(cu.detachEvent("onpropertychange",W1),xu=cu=null)}function W1(t){if(t.propertyName==="value"&&Qf(xu)){var e=[];V1(e,xu,t,S0(t)),S1(n_,e)}}function i_(t,e,n){t==="focusin"?(eI(),cu=e,xu=n,cu.attachEvent("onpropertychange",W1)):t==="focusout"&&eI()}function o_(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qf(xu)}function s_(t,e){if(t==="click")return Qf(e)}function a_(t,e){if(t==="input"||t==="change")return Qf(e)}function c_(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var vi=typeof Object.is=="function"?Object.is:c_;function Pu(t,e){if(vi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Jg.call(e,i)||!vi(t[i],e[i]))return!1}return!0}function tI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function nI(t,e){var n=tI(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=tI(n)}}function j1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?j1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Z1(){for(var t=window,e=Gh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Gh(t.document)}return e}function R0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function l_(t){var e=Z1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&j1(n.ownerDocument.documentElement,n)){if(r!==null&&R0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=nI(n,o);var s=nI(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var u_=zo&&"documentMode"in document&&11>=document.documentMode,uc=null,gm=null,lu=null,mm=!1;function rI(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;mm||uc==null||uc!==Gh(r)||(r=uc,"selectionStart"in r&&R0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),lu&&Pu(lu,r)||(lu=r,r=$h(gm,"onSelect"),0<r.length&&(e=new T0("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=uc)))}function Bd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var dc={animationend:Bd("Animation","AnimationEnd"),animationiteration:Bd("Animation","AnimationIteration"),animationstart:Bd("Animation","AnimationStart"),transitionend:Bd("Transition","TransitionEnd")},Jp={},z1={};zo&&(z1=document.createElement("div").style,"AnimationEvent"in window||(delete dc.animationend.animation,delete dc.animationiteration.animation,delete dc.animationstart.animation),"TransitionEvent"in window||delete dc.transitionend.transition);function qf(t){if(Jp[t])return Jp[t];if(!dc[t])return t;var e=dc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in z1)return Jp[t]=e[n];return t}var H1=qf("animationend"),X1=qf("animationiteration"),$1=qf("animationstart"),K1=qf("transitionend"),J1=new Map,iI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $s(t,e){J1.set(t,e),Wa(e,[t])}for(var Yp=0;Yp<iI.length;Yp++){var Qp=iI[Yp],d_=Qp.toLowerCase(),h_=Qp[0].toUpperCase()+Qp.slice(1);$s(d_,"on"+h_)}$s(H1,"onAnimationEnd");$s(X1,"onAnimationIteration");$s($1,"onAnimationStart");$s("dblclick","onDoubleClick");$s("focusin","onFocus");$s("focusout","onBlur");$s(K1,"onTransitionEnd");Zc("onMouseEnter",["mouseout","mouseover"]);Zc("onMouseLeave",["mouseout","mouseover"]);Zc("onPointerEnter",["pointerout","pointerover"]);Zc("onPointerLeave",["pointerout","pointerover"]);Wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $l="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f_=new Set("cancel close invalid load scroll toggle".split(" ").concat($l));function oI(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,dN(r,e,void 0,t),t.currentTarget=null}function Y1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==o&&i.isPropagationStopped())break e;oI(i,a,l),o=c}else for(s=0;s<r.length;s++){if(a=r[s],c=a.instance,l=a.currentTarget,a=a.listener,c!==o&&i.isPropagationStopped())break e;oI(i,a,l),o=c}}}if(jh)throw t=dm,jh=!1,dm=null,t}function dt(t,e){var n=e[Sm];n===void 0&&(n=e[Sm]=new Set);var r=t+"__bubble";n.has(r)||(Q1(e,t,2,!1),n.add(r))}function qp(t,e,n){var r=0;e&&(r|=4),Q1(n,t,r,e)}var Fd="_reactListening"+Math.random().toString(36).slice(2);function Ru(t){if(!t[Fd]){t[Fd]=!0,o1.forEach(function(n){n!=="selectionchange"&&(f_.has(n)||qp(n,!1,t),qp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Fd]||(e[Fd]=!0,qp("selectionchange",!1,e))}}function Q1(t,e,n,r){switch(D1(e)){case 1:var i=TN;break;case 4:i=xN;break;default:i=k0}n=i.bind(null,e,n,t),i=void 0,!um||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function eg(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;s=s.return}for(;a!==null;){if(s=ha(a),s===null)return;if(c=s.tag,c===5||c===6){r=o=s;continue e}a=a.parentNode}}r=r.return}S1(function(){var l=o,u=S0(n),d=[];e:{var h=J1.get(t);if(h!==void 0){var f=T0,p=t;switch(t){case"keypress":if(ch(n)===0)break e;case"keydown":case"keyup":f=jN;break;case"focusin":p="focus",f=Xp;break;case"focusout":p="blur",f=Xp;break;case"beforeblur":case"afterblur":f=Xp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=XC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=NN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=HN;break;case H1:case X1:case $1:f=ON;break;case K1:f=$N;break;case"scroll":f=PN;break;case"wheel":f=JN;break;case"copy":case"cut":case"paste":f=LN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=KC}var m=(e&4)!==0,C=!m&&t==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var y=l,S;y!==null;){S=y;var E=S.stateNode;if(S.tag===5&&E!==null&&(S=E,g!==null&&(E=Au(y,g),E!=null&&m.push(Nu(y,E,S)))),C)break;y=y.return}0<m.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==cm&&(p=n.relatedTarget||n.fromElement)&&(ha(p)||p[Ho]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=l,p=p?ha(p):null,p!==null&&(C=ja(p),p!==C||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=l),f!==p)){if(m=XC,E="onMouseLeave",g="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=KC,E="onPointerLeave",g="onPointerEnter",y="pointer"),C=f==null?h:hc(f),S=p==null?h:hc(p),h=new m(E,y+"leave",f,n,u),h.target=C,h.relatedTarget=S,E=null,ha(u)===l&&(m=new m(g,y+"enter",p,n,u),m.target=S,m.relatedTarget=C,E=m),C=E,f&&p)t:{for(m=f,g=p,y=0,S=m;S;S=qa(S))y++;for(S=0,E=g;E;E=qa(E))S++;for(;0<y-S;)m=qa(m),y--;for(;0<S-y;)g=qa(g),S--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=qa(m),g=qa(g)}m=null}else m=null;f!==null&&sI(d,h,f,m,!1),p!==null&&C!==null&&sI(d,C,p,m,!0)}}e:{if(h=l?hc(l):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var A=r_;else if(QC(h))if(G1)A=a_;else{A=o_;var P=i_}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(A=s_);if(A&&(A=A(t,l))){V1(d,A,n,u);break e}P&&P(t,h,l),t==="focusout"&&(P=h._wrapperState)&&P.controlled&&h.type==="number"&&rm(h,"number",h.value)}switch(P=l?hc(l):window,t){case"focusin":(QC(P)||P.contentEditable==="true")&&(uc=P,gm=l,lu=null);break;case"focusout":lu=gm=uc=null;break;case"mousedown":mm=!0;break;case"contextmenu":case"mouseup":case"dragend":mm=!1,rI(d,n,u);break;case"selectionchange":if(u_)break;case"keydown":case"keyup":rI(d,n,u)}var w;if(P0)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else lc?F1(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(B1&&n.locale!=="ko"&&(lc||T!=="onCompositionStart"?T==="onCompositionEnd"&&lc&&(w=L1()):(ws=u,E0="value"in ws?ws.value:ws.textContent,lc=!0)),P=$h(l,T),0<P.length&&(T=new $C(T,t,null,n,u),d.push({event:T,listeners:P}),w?T.data=w:(w=U1(n),w!==null&&(T.data=w)))),(w=QN?qN(t,n):e_(t,n))&&(l=$h(l,"onBeforeInput"),0<l.length&&(u=new $C("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:l}),u.data=w))}Y1(d,e)})}function Nu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $h(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Au(t,n),o!=null&&r.unshift(Nu(t,o,i)),o=Au(t,e),o!=null&&r.push(Nu(t,o,i))),t=t.return}return r}function qa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function sI(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&l!==null&&(a=l,i?(c=Au(n,o),c!=null&&s.unshift(Nu(n,c,a))):i||(c=Au(n,o),c!=null&&s.push(Nu(n,c,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var p_=/\r\n?/g,g_=/\u0000|\uFFFD/g;function aI(t){return(typeof t=="string"?t:""+t).replace(p_,`
`).replace(g_,"")}function Ud(t,e,n){if(e=aI(e),aI(t)!==e&&n)throw Error(ie(425))}function Kh(){}var vm=null,ym=null;function Cm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Im=typeof setTimeout=="function"?setTimeout:void 0,m_=typeof clearTimeout=="function"?clearTimeout:void 0,cI=typeof Promise=="function"?Promise:void 0,v_=typeof queueMicrotask=="function"?queueMicrotask:typeof cI<"u"?function(t){return cI.resolve(null).then(t).catch(y_)}:Im;function y_(t){setTimeout(function(){throw t})}function tg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Tu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Tu(e)}function Ls(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function lI(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ll=Math.random().toString(36).slice(2),Ri="__reactFiber$"+ll,_u="__reactProps$"+ll,Ho="__reactContainer$"+ll,Sm="__reactEvents$"+ll,C_="__reactListeners$"+ll,I_="__reactHandles$"+ll;function ha(t){var e=t[Ri];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ho]||n[Ri]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=lI(t);t!==null;){if(n=t[Ri])return n;t=lI(t)}return e}t=n,n=t.parentNode}return null}function ld(t){return t=t[Ri]||t[Ho],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function hc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ie(33))}function ep(t){return t[_u]||null}var bm=[],fc=-1;function Ks(t){return{current:t}}function mt(t){0>fc||(t.current=bm[fc],bm[fc]=null,fc--)}function ct(t,e){fc++,bm[fc]=t.current,t.current=e}var Zs={},kn=Ks(Zs),tr=Ks(!1),xa=Zs;function zc(t,e){var n=t.type.contextTypes;if(!n)return Zs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function nr(t){return t=t.childContextTypes,t!=null}function Jh(){mt(tr),mt(kn)}function uI(t,e,n){if(kn.current!==Zs)throw Error(ie(168));ct(kn,e),ct(tr,n)}function q1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ie(108,iN(t)||"Unknown",i));return Et({},n,r)}function Yh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Zs,xa=kn.current,ct(kn,t),ct(tr,tr.current),!0}function dI(t,e,n){var r=t.stateNode;if(!r)throw Error(ie(169));n?(t=q1(t,e,xa),r.__reactInternalMemoizedMergedChildContext=t,mt(tr),mt(kn),ct(kn,t)):mt(tr),ct(tr,n)}var lo=null,tp=!1,ng=!1;function eA(t){lo===null?lo=[t]:lo.push(t)}function S_(t){tp=!0,eA(t)}function Js(){if(!ng&&lo!==null){ng=!0;var t=0,e=Ye;try{var n=lo;for(Ye=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}lo=null,tp=!1}catch(i){throw lo!==null&&(lo=lo.slice(t+1)),k1(b0,Js),i}finally{Ye=e,ng=!1}}return null}var pc=[],gc=0,Qh=null,qh=0,Or=[],Dr=0,Pa=null,go=1,mo="";function oa(t,e){pc[gc++]=qh,pc[gc++]=Qh,Qh=t,qh=e}function tA(t,e,n){Or[Dr++]=go,Or[Dr++]=mo,Or[Dr++]=Pa,Pa=t;var r=go;t=mo;var i=32-pi(r)-1;r&=~(1<<i),n+=1;var o=32-pi(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,go=1<<32-pi(e)+i|n<<i|r,mo=o+t}else go=1<<o|n<<i|r,mo=t}function N0(t){t.return!==null&&(oa(t,1),tA(t,1,0))}function _0(t){for(;t===Qh;)Qh=pc[--gc],pc[gc]=null,qh=pc[--gc],pc[gc]=null;for(;t===Pa;)Pa=Or[--Dr],Or[Dr]=null,mo=Or[--Dr],Or[Dr]=null,go=Or[--Dr],Or[Dr]=null}var Sr=null,Cr=null,bt=!1,si=null;function nA(t,e){var n=Fr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function hI(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Sr=t,Cr=Ls(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Sr=t,Cr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Pa!==null?{id:go,overflow:mo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Fr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Sr=t,Cr=null,!0):!1;default:return!1}}function wm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Am(t){if(bt){var e=Cr;if(e){var n=e;if(!hI(t,e)){if(wm(t))throw Error(ie(418));e=Ls(n.nextSibling);var r=Sr;e&&hI(t,e)?nA(r,n):(t.flags=t.flags&-4097|2,bt=!1,Sr=t)}}else{if(wm(t))throw Error(ie(418));t.flags=t.flags&-4097|2,bt=!1,Sr=t}}}function fI(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Sr=t}function Vd(t){if(t!==Sr)return!1;if(!bt)return fI(t),bt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Cm(t.type,t.memoizedProps)),e&&(e=Cr)){if(wm(t))throw rA(),Error(ie(418));for(;e;)nA(t,e),e=Ls(e.nextSibling)}if(fI(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ie(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Cr=Ls(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Cr=null}}else Cr=Sr?Ls(t.stateNode.nextSibling):null;return!0}function rA(){for(var t=Cr;t;)t=Ls(t.nextSibling)}function Hc(){Cr=Sr=null,bt=!1}function M0(t){si===null?si=[t]:si.push(t)}var b_=es.ReactCurrentBatchConfig;function _l(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ie(309));var r=n.stateNode}if(!r)throw Error(ie(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(ie(284));if(!n._owner)throw Error(ie(290,t))}return t}function Gd(t,e){throw t=Object.prototype.toString.call(e),Error(ie(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function pI(t){var e=t._init;return e(t._payload)}function iA(t){function e(g,y){if(t){var S=g.deletions;S===null?(g.deletions=[y],g.flags|=16):S.push(y)}}function n(g,y){if(!t)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function i(g,y){return g=Vs(g,y),g.index=0,g.sibling=null,g}function o(g,y,S){return g.index=S,t?(S=g.alternate,S!==null?(S=S.index,S<y?(g.flags|=2,y):S):(g.flags|=2,y)):(g.flags|=1048576,y)}function s(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,y,S,E){return y===null||y.tag!==6?(y=lg(S,g.mode,E),y.return=g,y):(y=i(y,S),y.return=g,y)}function c(g,y,S,E){var A=S.type;return A===cc?u(g,y,S.props.children,E,S.key):y!==null&&(y.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===vs&&pI(A)===y.type)?(E=i(y,S.props),E.ref=_l(g,y,S),E.return=g,E):(E=gh(S.type,S.key,S.props,null,g.mode,E),E.ref=_l(g,y,S),E.return=g,E)}function l(g,y,S,E){return y===null||y.tag!==4||y.stateNode.containerInfo!==S.containerInfo||y.stateNode.implementation!==S.implementation?(y=ug(S,g.mode,E),y.return=g,y):(y=i(y,S.children||[]),y.return=g,y)}function u(g,y,S,E,A){return y===null||y.tag!==7?(y=ba(S,g.mode,E,A),y.return=g,y):(y=i(y,S),y.return=g,y)}function d(g,y,S){if(typeof y=="string"&&y!==""||typeof y=="number")return y=lg(""+y,g.mode,S),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Rd:return S=gh(y.type,y.key,y.props,null,g.mode,S),S.ref=_l(g,null,y),S.return=g,S;case ac:return y=ug(y,g.mode,S),y.return=g,y;case vs:var E=y._init;return d(g,E(y._payload),S)}if(Hl(y)||Tl(y))return y=ba(y,g.mode,S,null),y.return=g,y;Gd(g,y)}return null}function h(g,y,S,E){var A=y!==null?y.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return A!==null?null:a(g,y,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Rd:return S.key===A?c(g,y,S,E):null;case ac:return S.key===A?l(g,y,S,E):null;case vs:return A=S._init,h(g,y,A(S._payload),E)}if(Hl(S)||Tl(S))return A!==null?null:u(g,y,S,E,null);Gd(g,S)}return null}function f(g,y,S,E,A){if(typeof E=="string"&&E!==""||typeof E=="number")return g=g.get(S)||null,a(y,g,""+E,A);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Rd:return g=g.get(E.key===null?S:E.key)||null,c(y,g,E,A);case ac:return g=g.get(E.key===null?S:E.key)||null,l(y,g,E,A);case vs:var P=E._init;return f(g,y,S,P(E._payload),A)}if(Hl(E)||Tl(E))return g=g.get(S)||null,u(y,g,E,A,null);Gd(y,E)}return null}function p(g,y,S,E){for(var A=null,P=null,w=y,T=y=0,_=null;w!==null&&T<S.length;T++){w.index>T?(_=w,w=null):_=w.sibling;var M=h(g,w,S[T],E);if(M===null){w===null&&(w=_);break}t&&w&&M.alternate===null&&e(g,w),y=o(M,y,T),P===null?A=M:P.sibling=M,P=M,w=_}if(T===S.length)return n(g,w),bt&&oa(g,T),A;if(w===null){for(;T<S.length;T++)w=d(g,S[T],E),w!==null&&(y=o(w,y,T),P===null?A=w:P.sibling=w,P=w);return bt&&oa(g,T),A}for(w=r(g,w);T<S.length;T++)_=f(w,g,T,S[T],E),_!==null&&(t&&_.alternate!==null&&w.delete(_.key===null?T:_.key),y=o(_,y,T),P===null?A=_:P.sibling=_,P=_);return t&&w.forEach(function(D){return e(g,D)}),bt&&oa(g,T),A}function m(g,y,S,E){var A=Tl(S);if(typeof A!="function")throw Error(ie(150));if(S=A.call(S),S==null)throw Error(ie(151));for(var P=A=null,w=y,T=y=0,_=null,M=S.next();w!==null&&!M.done;T++,M=S.next()){w.index>T?(_=w,w=null):_=w.sibling;var D=h(g,w,M.value,E);if(D===null){w===null&&(w=_);break}t&&w&&D.alternate===null&&e(g,w),y=o(D,y,T),P===null?A=D:P.sibling=D,P=D,w=_}if(M.done)return n(g,w),bt&&oa(g,T),A;if(w===null){for(;!M.done;T++,M=S.next())M=d(g,M.value,E),M!==null&&(y=o(M,y,T),P===null?A=M:P.sibling=M,P=M);return bt&&oa(g,T),A}for(w=r(g,w);!M.done;T++,M=S.next())M=f(w,g,T,M.value,E),M!==null&&(t&&M.alternate!==null&&w.delete(M.key===null?T:M.key),y=o(M,y,T),P===null?A=M:P.sibling=M,P=M);return t&&w.forEach(function(B){return e(g,B)}),bt&&oa(g,T),A}function C(g,y,S,E){if(typeof S=="object"&&S!==null&&S.type===cc&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Rd:e:{for(var A=S.key,P=y;P!==null;){if(P.key===A){if(A=S.type,A===cc){if(P.tag===7){n(g,P.sibling),y=i(P,S.props.children),y.return=g,g=y;break e}}else if(P.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===vs&&pI(A)===P.type){n(g,P.sibling),y=i(P,S.props),y.ref=_l(g,P,S),y.return=g,g=y;break e}n(g,P);break}else e(g,P);P=P.sibling}S.type===cc?(y=ba(S.props.children,g.mode,E,S.key),y.return=g,g=y):(E=gh(S.type,S.key,S.props,null,g.mode,E),E.ref=_l(g,y,S),E.return=g,g=E)}return s(g);case ac:e:{for(P=S.key;y!==null;){if(y.key===P)if(y.tag===4&&y.stateNode.containerInfo===S.containerInfo&&y.stateNode.implementation===S.implementation){n(g,y.sibling),y=i(y,S.children||[]),y.return=g,g=y;break e}else{n(g,y);break}else e(g,y);y=y.sibling}y=ug(S,g.mode,E),y.return=g,g=y}return s(g);case vs:return P=S._init,C(g,y,P(S._payload),E)}if(Hl(S))return p(g,y,S,E);if(Tl(S))return m(g,y,S,E);Gd(g,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,y!==null&&y.tag===6?(n(g,y.sibling),y=i(y,S),y.return=g,g=y):(n(g,y),y=lg(S,g.mode,E),y.return=g,g=y),s(g)):n(g,y)}return C}var Xc=iA(!0),oA=iA(!1),ef=Ks(null),tf=null,mc=null,O0=null;function D0(){O0=mc=tf=null}function L0(t){var e=ef.current;mt(ef),t._currentValue=e}function km(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Pc(t,e){tf=t,O0=mc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(qn=!0),t.firstContext=null)}function Wr(t){var e=t._currentValue;if(O0!==t)if(t={context:t,memoizedValue:e,next:null},mc===null){if(tf===null)throw Error(ie(308));mc=t,tf.dependencies={lanes:0,firstContext:t}}else mc=mc.next=t;return e}var fa=null;function B0(t){fa===null?fa=[t]:fa.push(t)}function sA(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,B0(e)):(n.next=i.next,i.next=n),e.interleaved=n,Xo(t,r)}function Xo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ys=!1;function F0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Go(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ze&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Xo(t,n)}return i=r.interleaved,i===null?(e.next=e,B0(r)):(e.next=i.next,i.next=e),r.interleaved=e,Xo(t,n)}function lh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,w0(t,n)}}function gI(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function nf(t,e,n,r){var i=t.updateQueue;ys=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,s===null?o=l:s.next=l,s=c;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(o!==null){var d=i.baseState;s=0,u=l=c=null,a=o;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Et({},d,h);break e;case 2:ys=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=f,c=d):u=u.next=f,s|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Na|=s,t.lanes=s,t.memoizedState=d}}function mI(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ie(191,i));i.call(r)}}}var ud={},Ji=Ks(ud),Mu=Ks(ud),Ou=Ks(ud);function pa(t){if(t===ud)throw Error(ie(174));return t}function U0(t,e){switch(ct(Ou,e),ct(Mu,t),ct(Ji,ud),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:om(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=om(e,t)}mt(Ji),ct(Ji,e)}function $c(){mt(Ji),mt(Mu),mt(Ou)}function cA(t){pa(Ou.current);var e=pa(Ji.current),n=om(e,t.type);e!==n&&(ct(Mu,t),ct(Ji,n))}function V0(t){Mu.current===t&&(mt(Ji),mt(Mu))}var At=Ks(0);function rf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var rg=[];function G0(){for(var t=0;t<rg.length;t++)rg[t]._workInProgressVersionPrimary=null;rg.length=0}var uh=es.ReactCurrentDispatcher,ig=es.ReactCurrentBatchConfig,Ra=0,kt=null,Wt=null,Jt=null,of=!1,uu=!1,Du=0,w_=0;function yn(){throw Error(ie(321))}function W0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!vi(t[n],e[n]))return!1;return!0}function j0(t,e,n,r,i,o){if(Ra=o,kt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,uh.current=t===null||t.memoizedState===null?T_:x_,t=n(r,i),uu){o=0;do{if(uu=!1,Du=0,25<=o)throw Error(ie(301));o+=1,Jt=Wt=null,e.updateQueue=null,uh.current=P_,t=n(r,i)}while(uu)}if(uh.current=sf,e=Wt!==null&&Wt.next!==null,Ra=0,Jt=Wt=kt=null,of=!1,e)throw Error(ie(300));return t}function Z0(){var t=Du!==0;return Du=0,t}function xi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?kt.memoizedState=Jt=t:Jt=Jt.next=t,Jt}function jr(){if(Wt===null){var t=kt.alternate;t=t!==null?t.memoizedState:null}else t=Wt.next;var e=Jt===null?kt.memoizedState:Jt.next;if(e!==null)Jt=e,Wt=t;else{if(t===null)throw Error(ie(310));Wt=t,t={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Jt===null?kt.memoizedState=Jt=t:Jt=Jt.next=t}return Jt}function Lu(t,e){return typeof e=="function"?e(t):e}function og(t){var e=jr(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=Wt,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,c=null,l=o;do{var u=l.lane;if((Ra&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=d,s=r):c=c.next=d,kt.lanes|=u,Na|=u}l=l.next}while(l!==null&&l!==o);c===null?s=r:c.next=a,vi(r,e.memoizedState)||(qn=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,kt.lanes|=o,Na|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function sg(t){var e=jr(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);vi(o,e.memoizedState)||(qn=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function lA(){}function uA(t,e){var n=kt,r=jr(),i=e(),o=!vi(r.memoizedState,i);if(o&&(r.memoizedState=i,qn=!0),r=r.queue,z0(fA.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Jt!==null&&Jt.memoizedState.tag&1){if(n.flags|=2048,Bu(9,hA.bind(null,n,r,i,e),void 0,null),Qt===null)throw Error(ie(349));Ra&30||dA(n,e,i)}return i}function dA(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function hA(t,e,n,r){e.value=n,e.getSnapshot=r,pA(e)&&gA(t)}function fA(t,e,n){return n(function(){pA(e)&&gA(t)})}function pA(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!vi(t,n)}catch{return!0}}function gA(t){var e=Xo(t,1);e!==null&&gi(e,t,1,-1)}function vI(t){var e=xi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Lu,lastRenderedState:t},e.queue=t,t=t.dispatch=E_.bind(null,kt,t),[e.memoizedState,t]}function Bu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function mA(){return jr().memoizedState}function dh(t,e,n,r){var i=xi();kt.flags|=t,i.memoizedState=Bu(1|e,n,void 0,r===void 0?null:r)}function np(t,e,n,r){var i=jr();r=r===void 0?null:r;var o=void 0;if(Wt!==null){var s=Wt.memoizedState;if(o=s.destroy,r!==null&&W0(r,s.deps)){i.memoizedState=Bu(e,n,o,r);return}}kt.flags|=t,i.memoizedState=Bu(1|e,n,o,r)}function yI(t,e){return dh(8390656,8,t,e)}function z0(t,e){return np(2048,8,t,e)}function vA(t,e){return np(4,2,t,e)}function yA(t,e){return np(4,4,t,e)}function CA(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function IA(t,e,n){return n=n!=null?n.concat([t]):null,np(4,4,CA.bind(null,e,t),n)}function H0(){}function SA(t,e){var n=jr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&W0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function bA(t,e){var n=jr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&W0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function wA(t,e,n){return Ra&21?(vi(n,e)||(n=x1(),kt.lanes|=n,Na|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,qn=!0),t.memoizedState=n)}function A_(t,e){var n=Ye;Ye=n!==0&&4>n?n:4,t(!0);var r=ig.transition;ig.transition={};try{t(!1),e()}finally{Ye=n,ig.transition=r}}function AA(){return jr().memoizedState}function k_(t,e,n){var r=Us(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},kA(t))EA(e,n);else if(n=sA(t,e,n,r),n!==null){var i=Un();gi(n,t,r,i),TA(n,e,r)}}function E_(t,e,n){var r=Us(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(kA(t))EA(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,vi(a,s)){var c=e.interleaved;c===null?(i.next=i,B0(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=sA(t,e,i,r),n!==null&&(i=Un(),gi(n,t,r,i),TA(n,e,r))}}function kA(t){var e=t.alternate;return t===kt||e!==null&&e===kt}function EA(t,e){uu=of=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function TA(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,w0(t,n)}}var sf={readContext:Wr,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useInsertionEffect:yn,useLayoutEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useMutableSource:yn,useSyncExternalStore:yn,useId:yn,unstable_isNewReconciler:!1},T_={readContext:Wr,useCallback:function(t,e){return xi().memoizedState=[t,e===void 0?null:e],t},useContext:Wr,useEffect:yI,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,dh(4194308,4,CA.bind(null,e,t),n)},useLayoutEffect:function(t,e){return dh(4194308,4,t,e)},useInsertionEffect:function(t,e){return dh(4,2,t,e)},useMemo:function(t,e){var n=xi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=xi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=k_.bind(null,kt,t),[r.memoizedState,t]},useRef:function(t){var e=xi();return t={current:t},e.memoizedState=t},useState:vI,useDebugValue:H0,useDeferredValue:function(t){return xi().memoizedState=t},useTransition:function(){var t=vI(!1),e=t[0];return t=A_.bind(null,t[1]),xi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=kt,i=xi();if(bt){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=e(),Qt===null)throw Error(ie(349));Ra&30||dA(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,yI(fA.bind(null,r,o,t),[t]),r.flags|=2048,Bu(9,hA.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=xi(),e=Qt.identifierPrefix;if(bt){var n=mo,r=go;n=(r&~(1<<32-pi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Du++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=w_++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},x_={readContext:Wr,useCallback:SA,useContext:Wr,useEffect:z0,useImperativeHandle:IA,useInsertionEffect:vA,useLayoutEffect:yA,useMemo:bA,useReducer:og,useRef:mA,useState:function(){return og(Lu)},useDebugValue:H0,useDeferredValue:function(t){var e=jr();return wA(e,Wt.memoizedState,t)},useTransition:function(){var t=og(Lu)[0],e=jr().memoizedState;return[t,e]},useMutableSource:lA,useSyncExternalStore:uA,useId:AA,unstable_isNewReconciler:!1},P_={readContext:Wr,useCallback:SA,useContext:Wr,useEffect:z0,useImperativeHandle:IA,useInsertionEffect:vA,useLayoutEffect:yA,useMemo:bA,useReducer:sg,useRef:mA,useState:function(){return sg(Lu)},useDebugValue:H0,useDeferredValue:function(t){var e=jr();return Wt===null?e.memoizedState=t:wA(e,Wt.memoizedState,t)},useTransition:function(){var t=sg(Lu)[0],e=jr().memoizedState;return[t,e]},useMutableSource:lA,useSyncExternalStore:uA,useId:AA,unstable_isNewReconciler:!1};function $r(t,e){if(t&&t.defaultProps){e=Et({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Em(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Et({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var rp={isMounted:function(t){return(t=t._reactInternals)?ja(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Un(),i=Us(t),o=Go(r,i);o.payload=e,n!=null&&(o.callback=n),e=Bs(t,o,i),e!==null&&(gi(e,t,i,r),lh(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Un(),i=Us(t),o=Go(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Bs(t,o,i),e!==null&&(gi(e,t,i,r),lh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Un(),r=Us(t),i=Go(n,r);i.tag=2,e!=null&&(i.callback=e),e=Bs(t,i,r),e!==null&&(gi(e,t,r,n),lh(e,t,r))}};function CI(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Pu(n,r)||!Pu(i,o):!0}function xA(t,e,n){var r=!1,i=Zs,o=e.contextType;return typeof o=="object"&&o!==null?o=Wr(o):(i=nr(e)?xa:kn.current,r=e.contextTypes,o=(r=r!=null)?zc(t,i):Zs),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=rp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function II(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&rp.enqueueReplaceState(e,e.state,null)}function Tm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},F0(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Wr(o):(o=nr(e)?xa:kn.current,i.context=zc(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Em(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&rp.enqueueReplaceState(i,i.state,null),nf(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Kc(t,e){try{var n="",r=e;do n+=rN(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function ag(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function xm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var R_=typeof WeakMap=="function"?WeakMap:Map;function PA(t,e,n){n=Go(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){cf||(cf=!0,Fm=r),xm(t,e)},n}function RA(t,e,n){n=Go(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){xm(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){xm(t,e),typeof r!="function"&&(Fs===null?Fs=new Set([this]):Fs.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function SI(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new R_;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Z_.bind(null,t,e,n),e.then(t,t))}function bI(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function wI(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Go(-1,1),e.tag=2,Bs(n,e,1))),n.lanes|=1),t)}var N_=es.ReactCurrentOwner,qn=!1;function _n(t,e,n,r){e.child=t===null?oA(e,null,n,r):Xc(e,t.child,n,r)}function AI(t,e,n,r,i){n=n.render;var o=e.ref;return Pc(e,i),r=j0(t,e,n,r,o,i),n=Z0(),t!==null&&!qn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,$o(t,e,i)):(bt&&n&&N0(e),e.flags|=1,_n(t,e,r,i),e.child)}function kI(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!ey(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,NA(t,e,o,r,i)):(t=gh(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Pu,n(s,r)&&t.ref===e.ref)return $o(t,e,i)}return e.flags|=1,t=Vs(o,r),t.ref=e.ref,t.return=e,e.child=t}function NA(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Pu(o,r)&&t.ref===e.ref)if(qn=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(qn=!0);else return e.lanes=t.lanes,$o(t,e,i)}return Pm(t,e,n,r,i)}function _A(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(yc,fr),fr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ct(yc,fr),fr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ct(yc,fr),fr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,ct(yc,fr),fr|=r;return _n(t,e,i,n),e.child}function MA(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Pm(t,e,n,r,i){var o=nr(n)?xa:kn.current;return o=zc(e,o),Pc(e,i),n=j0(t,e,n,r,o,i),r=Z0(),t!==null&&!qn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,$o(t,e,i)):(bt&&r&&N0(e),e.flags|=1,_n(t,e,n,i),e.child)}function EI(t,e,n,r,i){if(nr(n)){var o=!0;Yh(e)}else o=!1;if(Pc(e,i),e.stateNode===null)hh(t,e),xA(e,n,r),Tm(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var c=s.context,l=n.contextType;typeof l=="object"&&l!==null?l=Wr(l):(l=nr(n)?xa:kn.current,l=zc(e,l));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||c!==l)&&II(e,s,r,l),ys=!1;var h=e.memoizedState;s.state=h,nf(e,r,s,i),c=e.memoizedState,a!==r||h!==c||tr.current||ys?(typeof u=="function"&&(Em(e,n,u,r),c=e.memoizedState),(a=ys||CI(e,n,a,r,h,c,l))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),s.props=r,s.state=c,s.context=l,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,aA(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:$r(e.type,a),s.props=l,d=e.pendingProps,h=s.context,c=n.contextType,typeof c=="object"&&c!==null?c=Wr(c):(c=nr(n)?xa:kn.current,c=zc(e,c));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||h!==c)&&II(e,s,r,c),ys=!1,h=e.memoizedState,s.state=h,nf(e,r,s,i);var p=e.memoizedState;a!==d||h!==p||tr.current||ys?(typeof f=="function"&&(Em(e,n,f,r),p=e.memoizedState),(l=ys||CI(e,n,l,r,h,p,c)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,c)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=c,r=l):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Rm(t,e,n,r,o,i)}function Rm(t,e,n,r,i,o){MA(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&dI(e,n,!1),$o(t,e,o);r=e.stateNode,N_.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=Xc(e,t.child,null,o),e.child=Xc(e,null,a,o)):_n(t,e,a,o),e.memoizedState=r.state,i&&dI(e,n,!0),e.child}function OA(t){var e=t.stateNode;e.pendingContext?uI(t,e.pendingContext,e.pendingContext!==e.context):e.context&&uI(t,e.context,!1),U0(t,e.containerInfo)}function TI(t,e,n,r,i){return Hc(),M0(i),e.flags|=256,_n(t,e,n,r),e.child}var Nm={dehydrated:null,treeContext:null,retryLane:0};function _m(t){return{baseLanes:t,cachePool:null,transitions:null}}function DA(t,e,n){var r=e.pendingProps,i=At.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ct(At,i&1),t===null)return Am(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=sp(s,r,0,null),t=ba(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=_m(n),e.memoizedState=Nm,t):X0(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return __(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Vs(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=Vs(a,o):(o=ba(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?_m(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Nm,r}return o=t.child,t=o.sibling,r=Vs(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function X0(t,e){return e=sp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Wd(t,e,n,r){return r!==null&&M0(r),Xc(e,t.child,null,n),t=X0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function __(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=ag(Error(ie(422))),Wd(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=sp({mode:"visible",children:r.children},i,0,null),o=ba(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Xc(e,t.child,null,s),e.child.memoizedState=_m(s),e.memoizedState=Nm,o);if(!(e.mode&1))return Wd(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(ie(419)),r=ag(o,r,void 0),Wd(t,e,s,r)}if(a=(s&t.childLanes)!==0,qn||a){if(r=Qt,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Xo(t,i),gi(r,t,i,-1))}return q0(),r=ag(Error(ie(421))),Wd(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=z_.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Cr=Ls(i.nextSibling),Sr=e,bt=!0,si=null,t!==null&&(Or[Dr++]=go,Or[Dr++]=mo,Or[Dr++]=Pa,go=t.id,mo=t.overflow,Pa=e),e=X0(e,r.children),e.flags|=4096,e)}function xI(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),km(t.return,e,n)}function cg(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function LA(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(_n(t,e,r.children,n),r=At.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&xI(t,n,e);else if(t.tag===19)xI(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ct(At,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&rf(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),cg(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&rf(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}cg(e,!0,n,null,o);break;case"together":cg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function hh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function $o(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Na|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ie(153));if(e.child!==null){for(t=e.child,n=Vs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Vs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function M_(t,e,n){switch(e.tag){case 3:OA(e),Hc();break;case 5:cA(e);break;case 1:nr(e.type)&&Yh(e);break;case 4:U0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ct(ef,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ct(At,At.current&1),e.flags|=128,null):n&e.child.childLanes?DA(t,e,n):(ct(At,At.current&1),t=$o(t,e,n),t!==null?t.sibling:null);ct(At,At.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return LA(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ct(At,At.current),r)break;return null;case 22:case 23:return e.lanes=0,_A(t,e,n)}return $o(t,e,n)}var BA,Mm,FA,UA;BA=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Mm=function(){};FA=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,pa(Ji.current);var o=null;switch(n){case"input":i=tm(t,i),r=tm(t,r),o=[];break;case"select":i=Et({},i,{value:void 0}),r=Et({},r,{value:void 0}),o=[];break;case"textarea":i=im(t,i),r=im(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Kh)}sm(n,r);var s;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(bu.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(s in a)!a.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&a[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(o=o||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(bu.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&dt("scroll",t),o||a===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(e.updateQueue=l)&&(e.flags|=4)}};UA=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ml(t,e){if(!bt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Cn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function O_(t,e,n){var r=e.pendingProps;switch(_0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cn(e),null;case 1:return nr(e.type)&&Jh(),Cn(e),null;case 3:return r=e.stateNode,$c(),mt(tr),mt(kn),G0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Vd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,si!==null&&(Gm(si),si=null))),Mm(t,e),Cn(e),null;case 5:V0(e);var i=pa(Ou.current);if(n=e.type,t!==null&&e.stateNode!=null)FA(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ie(166));return Cn(e),null}if(t=pa(Ji.current),Vd(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Ri]=e,r[_u]=o,t=(e.mode&1)!==0,n){case"dialog":dt("cancel",r),dt("close",r);break;case"iframe":case"object":case"embed":dt("load",r);break;case"video":case"audio":for(i=0;i<$l.length;i++)dt($l[i],r);break;case"source":dt("error",r);break;case"img":case"image":case"link":dt("error",r),dt("load",r);break;case"details":dt("toggle",r);break;case"input":BC(r,o),dt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},dt("invalid",r);break;case"textarea":UC(r,o),dt("invalid",r)}sm(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Ud(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Ud(r.textContent,a,t),i=["children",""+a]):bu.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&dt("scroll",r)}switch(n){case"input":Nd(r),FC(r,o,!0);break;case"textarea":Nd(r),VC(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Kh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=f1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[Ri]=e,t[_u]=r,BA(t,e,!1,!1),e.stateNode=t;e:{switch(s=am(n,r),n){case"dialog":dt("cancel",t),dt("close",t),i=r;break;case"iframe":case"object":case"embed":dt("load",t),i=r;break;case"video":case"audio":for(i=0;i<$l.length;i++)dt($l[i],t);i=r;break;case"source":dt("error",t),i=r;break;case"img":case"image":case"link":dt("error",t),dt("load",t),i=r;break;case"details":dt("toggle",t),i=r;break;case"input":BC(t,r),i=tm(t,r),dt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Et({},r,{value:void 0}),dt("invalid",t);break;case"textarea":UC(t,r),i=im(t,r),dt("invalid",t);break;default:i=r}sm(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="style"?m1(t,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&p1(t,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&wu(t,c):typeof c=="number"&&wu(t,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(bu.hasOwnProperty(o)?c!=null&&o==="onScroll"&&dt("scroll",t):c!=null&&v0(t,o,c,s))}switch(n){case"input":Nd(t),FC(t,r,!1);break;case"textarea":Nd(t),VC(t);break;case"option":r.value!=null&&t.setAttribute("value",""+js(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?kc(t,!!r.multiple,o,!1):r.defaultValue!=null&&kc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Kh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Cn(e),null;case 6:if(t&&e.stateNode!=null)UA(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ie(166));if(n=pa(Ou.current),pa(Ji.current),Vd(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ri]=e,(o=r.nodeValue!==n)&&(t=Sr,t!==null))switch(t.tag){case 3:Ud(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ud(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ri]=e,e.stateNode=r}return Cn(e),null;case 13:if(mt(At),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(bt&&Cr!==null&&e.mode&1&&!(e.flags&128))rA(),Hc(),e.flags|=98560,o=!1;else if(o=Vd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ie(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ie(317));o[Ri]=e}else Hc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Cn(e),o=!1}else si!==null&&(Gm(si),si=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||At.current&1?jt===0&&(jt=3):q0())),e.updateQueue!==null&&(e.flags|=4),Cn(e),null);case 4:return $c(),Mm(t,e),t===null&&Ru(e.stateNode.containerInfo),Cn(e),null;case 10:return L0(e.type._context),Cn(e),null;case 17:return nr(e.type)&&Jh(),Cn(e),null;case 19:if(mt(At),o=e.memoizedState,o===null)return Cn(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Ml(o,!1);else{if(jt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=rf(t),s!==null){for(e.flags|=128,Ml(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ct(At,At.current&1|2),e.child}t=t.sibling}o.tail!==null&&_t()>Jc&&(e.flags|=128,r=!0,Ml(o,!1),e.lanes=4194304)}else{if(!r)if(t=rf(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ml(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!bt)return Cn(e),null}else 2*_t()-o.renderingStartTime>Jc&&n!==1073741824&&(e.flags|=128,r=!0,Ml(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=_t(),e.sibling=null,n=At.current,ct(At,r?n&1|2:n&1),e):(Cn(e),null);case 22:case 23:return Q0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?fr&1073741824&&(Cn(e),e.subtreeFlags&6&&(e.flags|=8192)):Cn(e),null;case 24:return null;case 25:return null}throw Error(ie(156,e.tag))}function D_(t,e){switch(_0(e),e.tag){case 1:return nr(e.type)&&Jh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return $c(),mt(tr),mt(kn),G0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return V0(e),null;case 13:if(mt(At),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ie(340));Hc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return mt(At),null;case 4:return $c(),null;case 10:return L0(e.type._context),null;case 22:case 23:return Q0(),null;case 24:return null;default:return null}}var jd=!1,Sn=!1,L_=typeof WeakSet=="function"?WeakSet:Set,fe=null;function vc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){xt(t,e,r)}else n.current=null}function Om(t,e,n){try{n()}catch(r){xt(t,e,r)}}var PI=!1;function B_(t,e){if(vm=Hh,t=Z1(),R0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,c=-1,l=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(c=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++l===i&&(a=s),h===o&&++u===r&&(c=s),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ym={focusedElem:t,selectionRange:n},Hh=!1,fe=e;fe!==null;)if(e=fe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,fe=t;else for(;fe!==null;){e=fe;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,C=p.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:$r(e.type,m),C);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(E){xt(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,fe=t;break}fe=e.return}return p=PI,PI=!1,p}function du(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Om(e,n,o)}i=i.next}while(i!==r)}}function ip(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Dm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function VA(t){var e=t.alternate;e!==null&&(t.alternate=null,VA(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ri],delete e[_u],delete e[Sm],delete e[C_],delete e[I_])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function GA(t){return t.tag===5||t.tag===3||t.tag===4}function RI(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||GA(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Lm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Kh));else if(r!==4&&(t=t.child,t!==null))for(Lm(t,e,n),t=t.sibling;t!==null;)Lm(t,e,n),t=t.sibling}function Bm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Bm(t,e,n),t=t.sibling;t!==null;)Bm(t,e,n),t=t.sibling}var rn=null,ri=!1;function as(t,e,n){for(n=n.child;n!==null;)WA(t,e,n),n=n.sibling}function WA(t,e,n){if(Ki&&typeof Ki.onCommitFiberUnmount=="function")try{Ki.onCommitFiberUnmount(Jf,n)}catch{}switch(n.tag){case 5:Sn||vc(n,e);case 6:var r=rn,i=ri;rn=null,as(t,e,n),rn=r,ri=i,rn!==null&&(ri?(t=rn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):rn.removeChild(n.stateNode));break;case 18:rn!==null&&(ri?(t=rn,n=n.stateNode,t.nodeType===8?tg(t.parentNode,n):t.nodeType===1&&tg(t,n),Tu(t)):tg(rn,n.stateNode));break;case 4:r=rn,i=ri,rn=n.stateNode.containerInfo,ri=!0,as(t,e,n),rn=r,ri=i;break;case 0:case 11:case 14:case 15:if(!Sn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Om(n,e,s),i=i.next}while(i!==r)}as(t,e,n);break;case 1:if(!Sn&&(vc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){xt(n,e,a)}as(t,e,n);break;case 21:as(t,e,n);break;case 22:n.mode&1?(Sn=(r=Sn)||n.memoizedState!==null,as(t,e,n),Sn=r):as(t,e,n);break;default:as(t,e,n)}}function NI(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new L_),e.forEach(function(r){var i=H_.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function zr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:rn=a.stateNode,ri=!1;break e;case 3:rn=a.stateNode.containerInfo,ri=!0;break e;case 4:rn=a.stateNode.containerInfo,ri=!0;break e}a=a.return}if(rn===null)throw Error(ie(160));WA(o,s,i),rn=null,ri=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){xt(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)jA(e,t),e=e.sibling}function jA(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zr(e,t),Ai(t),r&4){try{du(3,t,t.return),ip(3,t)}catch(m){xt(t,t.return,m)}try{du(5,t,t.return)}catch(m){xt(t,t.return,m)}}break;case 1:zr(e,t),Ai(t),r&512&&n!==null&&vc(n,n.return);break;case 5:if(zr(e,t),Ai(t),r&512&&n!==null&&vc(n,n.return),t.flags&32){var i=t.stateNode;try{wu(i,"")}catch(m){xt(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&d1(i,o),am(a,s);var l=am(a,o);for(s=0;s<c.length;s+=2){var u=c[s],d=c[s+1];u==="style"?m1(i,d):u==="dangerouslySetInnerHTML"?p1(i,d):u==="children"?wu(i,d):v0(i,u,d,l)}switch(a){case"input":nm(i,o);break;case"textarea":h1(i,o);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?kc(i,!!o.multiple,f,!1):h!==!!o.multiple&&(o.defaultValue!=null?kc(i,!!o.multiple,o.defaultValue,!0):kc(i,!!o.multiple,o.multiple?[]:"",!1))}i[_u]=o}catch(m){xt(t,t.return,m)}}break;case 6:if(zr(e,t),Ai(t),r&4){if(t.stateNode===null)throw Error(ie(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(m){xt(t,t.return,m)}}break;case 3:if(zr(e,t),Ai(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Tu(e.containerInfo)}catch(m){xt(t,t.return,m)}break;case 4:zr(e,t),Ai(t);break;case 13:zr(e,t),Ai(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(J0=_t())),r&4&&NI(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Sn=(l=Sn)||u,zr(e,t),Sn=l):zr(e,t),Ai(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!u&&t.mode&1)for(fe=t,u=t.child;u!==null;){for(d=fe=u;fe!==null;){switch(h=fe,f=h.child,h.tag){case 0:case 11:case 14:case 15:du(4,h,h.return);break;case 1:vc(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){xt(r,n,m)}}break;case 5:vc(h,h.return);break;case 22:if(h.memoizedState!==null){MI(d);continue}}f!==null?(f.return=h,fe=f):MI(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,l?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,c=d.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=g1("display",s))}catch(m){xt(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(m){xt(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:zr(e,t),Ai(t),r&4&&NI(t);break;case 21:break;default:zr(e,t),Ai(t)}}function Ai(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(GA(n)){var r=n;break e}n=n.return}throw Error(ie(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(wu(i,""),r.flags&=-33);var o=RI(t);Bm(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=RI(t);Lm(t,a,s);break;default:throw Error(ie(161))}}catch(c){xt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function F_(t,e,n){fe=t,ZA(t)}function ZA(t,e,n){for(var r=(t.mode&1)!==0;fe!==null;){var i=fe,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||jd;if(!s){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Sn;a=jd;var l=Sn;if(jd=s,(Sn=c)&&!l)for(fe=i;fe!==null;)s=fe,c=s.child,s.tag===22&&s.memoizedState!==null?OI(i):c!==null?(c.return=s,fe=c):OI(i);for(;o!==null;)fe=o,ZA(o),o=o.sibling;fe=i,jd=a,Sn=l}_I(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,fe=o):_I(t)}}function _I(t){for(;fe!==null;){var e=fe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Sn||ip(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Sn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:$r(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&mI(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}mI(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Tu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}Sn||e.flags&512&&Dm(e)}catch(h){xt(e,e.return,h)}}if(e===t){fe=null;break}if(n=e.sibling,n!==null){n.return=e.return,fe=n;break}fe=e.return}}function MI(t){for(;fe!==null;){var e=fe;if(e===t){fe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,fe=n;break}fe=e.return}}function OI(t){for(;fe!==null;){var e=fe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ip(4,e)}catch(c){xt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){xt(e,i,c)}}var o=e.return;try{Dm(e)}catch(c){xt(e,o,c)}break;case 5:var s=e.return;try{Dm(e)}catch(c){xt(e,s,c)}}}catch(c){xt(e,e.return,c)}if(e===t){fe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,fe=a;break}fe=e.return}}var U_=Math.ceil,af=es.ReactCurrentDispatcher,$0=es.ReactCurrentOwner,Gr=es.ReactCurrentBatchConfig,Ze=0,Qt=null,Lt=null,ln=0,fr=0,yc=Ks(0),jt=0,Fu=null,Na=0,op=0,K0=0,hu=null,Jn=null,J0=0,Jc=1/0,ao=null,cf=!1,Fm=null,Fs=null,Zd=!1,As=null,lf=0,fu=0,Um=null,fh=-1,ph=0;function Un(){return Ze&6?_t():fh!==-1?fh:fh=_t()}function Us(t){return t.mode&1?Ze&2&&ln!==0?ln&-ln:b_.transition!==null?(ph===0&&(ph=x1()),ph):(t=Ye,t!==0||(t=window.event,t=t===void 0?16:D1(t.type)),t):1}function gi(t,e,n,r){if(50<fu)throw fu=0,Um=null,Error(ie(185));ad(t,n,r),(!(Ze&2)||t!==Qt)&&(t===Qt&&(!(Ze&2)&&(op|=n),jt===4&&Ss(t,ln)),rr(t,r),n===1&&Ze===0&&!(e.mode&1)&&(Jc=_t()+500,tp&&Js()))}function rr(t,e){var n=t.callbackNode;bN(t,e);var r=zh(t,t===Qt?ln:0);if(r===0)n!==null&&jC(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&jC(n),e===1)t.tag===0?S_(DI.bind(null,t)):eA(DI.bind(null,t)),v_(function(){!(Ze&6)&&Js()}),n=null;else{switch(P1(r)){case 1:n=b0;break;case 4:n=E1;break;case 16:n=Zh;break;case 536870912:n=T1;break;default:n=Zh}n=QA(n,zA.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function zA(t,e){if(fh=-1,ph=0,Ze&6)throw Error(ie(327));var n=t.callbackNode;if(Rc()&&t.callbackNode!==n)return null;var r=zh(t,t===Qt?ln:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=uf(t,r);else{e=r;var i=Ze;Ze|=2;var o=XA();(Qt!==t||ln!==e)&&(ao=null,Jc=_t()+500,Sa(t,e));do try{W_();break}catch(a){HA(t,a)}while(!0);D0(),af.current=o,Ze=i,Lt!==null?e=0:(Qt=null,ln=0,e=jt)}if(e!==0){if(e===2&&(i=hm(t),i!==0&&(r=i,e=Vm(t,i))),e===1)throw n=Fu,Sa(t,0),Ss(t,r),rr(t,_t()),n;if(e===6)Ss(t,r);else{if(i=t.current.alternate,!(r&30)&&!V_(i)&&(e=uf(t,r),e===2&&(o=hm(t),o!==0&&(r=o,e=Vm(t,o))),e===1))throw n=Fu,Sa(t,0),Ss(t,r),rr(t,_t()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ie(345));case 2:sa(t,Jn,ao);break;case 3:if(Ss(t,r),(r&130023424)===r&&(e=J0+500-_t(),10<e)){if(zh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Un(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Im(sa.bind(null,t,Jn,ao),e);break}sa(t,Jn,ao);break;case 4:if(Ss(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-pi(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=_t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*U_(r/1960))-r,10<r){t.timeoutHandle=Im(sa.bind(null,t,Jn,ao),r);break}sa(t,Jn,ao);break;case 5:sa(t,Jn,ao);break;default:throw Error(ie(329))}}}return rr(t,_t()),t.callbackNode===n?zA.bind(null,t):null}function Vm(t,e){var n=hu;return t.current.memoizedState.isDehydrated&&(Sa(t,e).flags|=256),t=uf(t,e),t!==2&&(e=Jn,Jn=n,e!==null&&Gm(e)),t}function Gm(t){Jn===null?Jn=t:Jn.push.apply(Jn,t)}function V_(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!vi(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ss(t,e){for(e&=~K0,e&=~op,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-pi(e),r=1<<n;t[n]=-1,e&=~r}}function DI(t){if(Ze&6)throw Error(ie(327));Rc();var e=zh(t,0);if(!(e&1))return rr(t,_t()),null;var n=uf(t,e);if(t.tag!==0&&n===2){var r=hm(t);r!==0&&(e=r,n=Vm(t,r))}if(n===1)throw n=Fu,Sa(t,0),Ss(t,e),rr(t,_t()),n;if(n===6)throw Error(ie(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,sa(t,Jn,ao),rr(t,_t()),null}function Y0(t,e){var n=Ze;Ze|=1;try{return t(e)}finally{Ze=n,Ze===0&&(Jc=_t()+500,tp&&Js())}}function _a(t){As!==null&&As.tag===0&&!(Ze&6)&&Rc();var e=Ze;Ze|=1;var n=Gr.transition,r=Ye;try{if(Gr.transition=null,Ye=1,t)return t()}finally{Ye=r,Gr.transition=n,Ze=e,!(Ze&6)&&Js()}}function Q0(){fr=yc.current,mt(yc)}function Sa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,m_(n)),Lt!==null)for(n=Lt.return;n!==null;){var r=n;switch(_0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Jh();break;case 3:$c(),mt(tr),mt(kn),G0();break;case 5:V0(r);break;case 4:$c();break;case 13:mt(At);break;case 19:mt(At);break;case 10:L0(r.type._context);break;case 22:case 23:Q0()}n=n.return}if(Qt=t,Lt=t=Vs(t.current,null),ln=fr=e,jt=0,Fu=null,K0=op=Na=0,Jn=hu=null,fa!==null){for(e=0;e<fa.length;e++)if(n=fa[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}fa=null}return t}function HA(t,e){do{var n=Lt;try{if(D0(),uh.current=sf,of){for(var r=kt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}of=!1}if(Ra=0,Jt=Wt=kt=null,uu=!1,Du=0,$0.current=null,n===null||n.return===null){jt=1,Fu=e,Lt=null;break}e:{var o=t,s=n.return,a=n,c=e;if(e=ln,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=bI(s);if(f!==null){f.flags&=-257,wI(f,s,a,o,e),f.mode&1&&SI(o,l,e),e=f,c=l;var p=e.updateQueue;if(p===null){var m=new Set;m.add(c),e.updateQueue=m}else p.add(c);break e}else{if(!(e&1)){SI(o,l,e),q0();break e}c=Error(ie(426))}}else if(bt&&a.mode&1){var C=bI(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),wI(C,s,a,o,e),M0(Kc(c,a));break e}}o=c=Kc(c,a),jt!==4&&(jt=2),hu===null?hu=[o]:hu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=PA(o,c,e);gI(o,g);break e;case 1:a=c;var y=o.type,S=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Fs===null||!Fs.has(S)))){o.flags|=65536,e&=-e,o.lanes|=e;var E=RA(o,a,e);gI(o,E);break e}}o=o.return}while(o!==null)}KA(n)}catch(A){e=A,Lt===n&&n!==null&&(Lt=n=n.return);continue}break}while(!0)}function XA(){var t=af.current;return af.current=sf,t===null?sf:t}function q0(){(jt===0||jt===3||jt===2)&&(jt=4),Qt===null||!(Na&268435455)&&!(op&268435455)||Ss(Qt,ln)}function uf(t,e){var n=Ze;Ze|=2;var r=XA();(Qt!==t||ln!==e)&&(ao=null,Sa(t,e));do try{G_();break}catch(i){HA(t,i)}while(!0);if(D0(),Ze=n,af.current=r,Lt!==null)throw Error(ie(261));return Qt=null,ln=0,jt}function G_(){for(;Lt!==null;)$A(Lt)}function W_(){for(;Lt!==null&&!fN();)$A(Lt)}function $A(t){var e=YA(t.alternate,t,fr);t.memoizedProps=t.pendingProps,e===null?KA(t):Lt=e,$0.current=null}function KA(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=D_(n,e),n!==null){n.flags&=32767,Lt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{jt=6,Lt=null;return}}else if(n=O_(n,e,fr),n!==null){Lt=n;return}if(e=e.sibling,e!==null){Lt=e;return}Lt=e=t}while(e!==null);jt===0&&(jt=5)}function sa(t,e,n){var r=Ye,i=Gr.transition;try{Gr.transition=null,Ye=1,j_(t,e,n,r)}finally{Gr.transition=i,Ye=r}return null}function j_(t,e,n,r){do Rc();while(As!==null);if(Ze&6)throw Error(ie(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ie(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(wN(t,o),t===Qt&&(Lt=Qt=null,ln=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zd||(Zd=!0,QA(Zh,function(){return Rc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Gr.transition,Gr.transition=null;var s=Ye;Ye=1;var a=Ze;Ze|=4,$0.current=null,B_(t,n),jA(n,t),l_(ym),Hh=!!vm,ym=vm=null,t.current=n,F_(n),pN(),Ze=a,Ye=s,Gr.transition=o}else t.current=n;if(Zd&&(Zd=!1,As=t,lf=i),o=t.pendingLanes,o===0&&(Fs=null),vN(n.stateNode),rr(t,_t()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(cf)throw cf=!1,t=Fm,Fm=null,t;return lf&1&&t.tag!==0&&Rc(),o=t.pendingLanes,o&1?t===Um?fu++:(fu=0,Um=t):fu=0,Js(),null}function Rc(){if(As!==null){var t=P1(lf),e=Gr.transition,n=Ye;try{if(Gr.transition=null,Ye=16>t?16:t,As===null)var r=!1;else{if(t=As,As=null,lf=0,Ze&6)throw Error(ie(331));var i=Ze;for(Ze|=4,fe=t.current;fe!==null;){var o=fe,s=o.child;if(fe.flags&16){var a=o.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(fe=l;fe!==null;){var u=fe;switch(u.tag){case 0:case 11:case 15:du(8,u,o)}var d=u.child;if(d!==null)d.return=u,fe=d;else for(;fe!==null;){u=fe;var h=u.sibling,f=u.return;if(VA(u),u===l){fe=null;break}if(h!==null){h.return=f,fe=h;break}fe=f}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var C=m.sibling;m.sibling=null,m=C}while(m!==null)}}fe=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,fe=s;else e:for(;fe!==null;){if(o=fe,o.flags&2048)switch(o.tag){case 0:case 11:case 15:du(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,fe=g;break e}fe=o.return}}var y=t.current;for(fe=y;fe!==null;){s=fe;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,fe=S;else e:for(s=y;fe!==null;){if(a=fe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ip(9,a)}}catch(A){xt(a,a.return,A)}if(a===s){fe=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,fe=E;break e}fe=a.return}}if(Ze=i,Js(),Ki&&typeof Ki.onPostCommitFiberRoot=="function")try{Ki.onPostCommitFiberRoot(Jf,t)}catch{}r=!0}return r}finally{Ye=n,Gr.transition=e}}return!1}function LI(t,e,n){e=Kc(n,e),e=PA(t,e,1),t=Bs(t,e,1),e=Un(),t!==null&&(ad(t,1,e),rr(t,e))}function xt(t,e,n){if(t.tag===3)LI(t,t,n);else for(;e!==null;){if(e.tag===3){LI(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Fs===null||!Fs.has(r))){t=Kc(n,t),t=RA(e,t,1),e=Bs(e,t,1),t=Un(),e!==null&&(ad(e,1,t),rr(e,t));break}}e=e.return}}function Z_(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Un(),t.pingedLanes|=t.suspendedLanes&n,Qt===t&&(ln&n)===n&&(jt===4||jt===3&&(ln&130023424)===ln&&500>_t()-J0?Sa(t,0):K0|=n),rr(t,e)}function JA(t,e){e===0&&(t.mode&1?(e=Od,Od<<=1,!(Od&130023424)&&(Od=4194304)):e=1);var n=Un();t=Xo(t,e),t!==null&&(ad(t,e,n),rr(t,n))}function z_(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),JA(t,n)}function H_(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ie(314))}r!==null&&r.delete(e),JA(t,n)}var YA;YA=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||tr.current)qn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return qn=!1,M_(t,e,n);qn=!!(t.flags&131072)}else qn=!1,bt&&e.flags&1048576&&tA(e,qh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;hh(t,e),t=e.pendingProps;var i=zc(e,kn.current);Pc(e,n),i=j0(null,e,r,t,i,n);var o=Z0();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,nr(r)?(o=!0,Yh(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,F0(e),i.updater=rp,e.stateNode=i,i._reactInternals=e,Tm(e,r,t,n),e=Rm(null,e,r,!0,o,n)):(e.tag=0,bt&&o&&N0(e),_n(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(hh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=$_(r),t=$r(r,t),i){case 0:e=Pm(null,e,r,t,n);break e;case 1:e=EI(null,e,r,t,n);break e;case 11:e=AI(null,e,r,t,n);break e;case 14:e=kI(null,e,r,$r(r.type,t),n);break e}throw Error(ie(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:$r(r,i),Pm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:$r(r,i),EI(t,e,r,i,n);case 3:e:{if(OA(e),t===null)throw Error(ie(387));r=e.pendingProps,o=e.memoizedState,i=o.element,aA(t,e),nf(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=Kc(Error(ie(423)),e),e=TI(t,e,r,n,i);break e}else if(r!==i){i=Kc(Error(ie(424)),e),e=TI(t,e,r,n,i);break e}else for(Cr=Ls(e.stateNode.containerInfo.firstChild),Sr=e,bt=!0,si=null,n=oA(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Hc(),r===i){e=$o(t,e,n);break e}_n(t,e,r,n)}e=e.child}return e;case 5:return cA(e),t===null&&Am(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Cm(r,i)?s=null:o!==null&&Cm(r,o)&&(e.flags|=32),MA(t,e),_n(t,e,s,n),e.child;case 6:return t===null&&Am(e),null;case 13:return DA(t,e,n);case 4:return U0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Xc(e,null,r,n):_n(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:$r(r,i),AI(t,e,r,i,n);case 7:return _n(t,e,e.pendingProps,n),e.child;case 8:return _n(t,e,e.pendingProps.children,n),e.child;case 12:return _n(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,ct(ef,r._currentValue),r._currentValue=s,o!==null)if(vi(o.value,s)){if(o.children===i.children&&!tr.current){e=$o(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=Go(-1,n&-n),c.tag=2;var l=o.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),km(o.return,n,e),a.lanes|=n;break}c=c.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(ie(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),km(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}_n(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Pc(e,n),i=Wr(i),r=r(i),e.flags|=1,_n(t,e,r,n),e.child;case 14:return r=e.type,i=$r(r,e.pendingProps),i=$r(r.type,i),kI(t,e,r,i,n);case 15:return NA(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:$r(r,i),hh(t,e),e.tag=1,nr(r)?(t=!0,Yh(e)):t=!1,Pc(e,n),xA(e,r,i),Tm(e,r,i,n),Rm(null,e,r,!0,t,n);case 19:return LA(t,e,n);case 22:return _A(t,e,n)}throw Error(ie(156,e.tag))};function QA(t,e){return k1(t,e)}function X_(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fr(t,e,n,r){return new X_(t,e,n,r)}function ey(t){return t=t.prototype,!(!t||!t.isReactComponent)}function $_(t){if(typeof t=="function")return ey(t)?1:0;if(t!=null){if(t=t.$$typeof,t===C0)return 11;if(t===I0)return 14}return 2}function Vs(t,e){var n=t.alternate;return n===null?(n=Fr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function gh(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")ey(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case cc:return ba(n.children,i,o,e);case y0:s=8,i|=8;break;case Yg:return t=Fr(12,n,e,i|2),t.elementType=Yg,t.lanes=o,t;case Qg:return t=Fr(13,n,e,i),t.elementType=Qg,t.lanes=o,t;case qg:return t=Fr(19,n,e,i),t.elementType=qg,t.lanes=o,t;case c1:return sp(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case s1:s=10;break e;case a1:s=9;break e;case C0:s=11;break e;case I0:s=14;break e;case vs:s=16,r=null;break e}throw Error(ie(130,t==null?t:typeof t,""))}return e=Fr(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function ba(t,e,n,r){return t=Fr(7,t,r,e),t.lanes=n,t}function sp(t,e,n,r){return t=Fr(22,t,r,e),t.elementType=c1,t.lanes=n,t.stateNode={isHidden:!1},t}function lg(t,e,n){return t=Fr(6,t,null,e),t.lanes=n,t}function ug(t,e,n){return e=Fr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function K_(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zp(0),this.expirationTimes=Zp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ty(t,e,n,r,i,o,s,a,c){return t=new K_(t,e,n,a,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Fr(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},F0(o),t}function J_(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ac,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function qA(t){if(!t)return Zs;t=t._reactInternals;e:{if(ja(t)!==t||t.tag!==1)throw Error(ie(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(nr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ie(171))}if(t.tag===1){var n=t.type;if(nr(n))return q1(t,n,e)}return e}function ek(t,e,n,r,i,o,s,a,c){return t=ty(n,r,!0,t,i,o,s,a,c),t.context=qA(null),n=t.current,r=Un(),i=Us(n),o=Go(r,i),o.callback=e??null,Bs(n,o,i),t.current.lanes=i,ad(t,i,r),rr(t,r),t}function ap(t,e,n,r){var i=e.current,o=Un(),s=Us(i);return n=qA(n),e.context===null?e.context=n:e.pendingContext=n,e=Go(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Bs(i,e,s),t!==null&&(gi(t,i,s,o),lh(t,i,s)),s}function df(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function BI(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ny(t,e){BI(t,e),(t=t.alternate)&&BI(t,e)}function Y_(){return null}var tk=typeof reportError=="function"?reportError:function(t){console.error(t)};function ry(t){this._internalRoot=t}cp.prototype.render=ry.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ie(409));ap(t,e,null,null)};cp.prototype.unmount=ry.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;_a(function(){ap(null,t,null,null)}),e[Ho]=null}};function cp(t){this._internalRoot=t}cp.prototype.unstable_scheduleHydration=function(t){if(t){var e=_1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Is.length&&e!==0&&e<Is[n].priority;n++);Is.splice(n,0,t),n===0&&O1(t)}};function iy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function lp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function FI(){}function Q_(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var l=df(s);o.call(l)}}var s=ek(e,r,t,0,null,!1,!1,"",FI);return t._reactRootContainer=s,t[Ho]=s.current,Ru(t.nodeType===8?t.parentNode:t),_a(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=df(c);a.call(l)}}var c=ty(t,0,!1,null,null,!1,!1,"",FI);return t._reactRootContainer=c,t[Ho]=c.current,Ru(t.nodeType===8?t.parentNode:t),_a(function(){ap(e,c,n,r)}),c}function up(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var c=df(s);a.call(c)}}ap(e,s,t,i)}else s=Q_(n,e,t,i,r);return df(s)}R1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Xl(e.pendingLanes);n!==0&&(w0(e,n|1),rr(e,_t()),!(Ze&6)&&(Jc=_t()+500,Js()))}break;case 13:_a(function(){var r=Xo(t,1);if(r!==null){var i=Un();gi(r,t,1,i)}}),ny(t,1)}};A0=function(t){if(t.tag===13){var e=Xo(t,134217728);if(e!==null){var n=Un();gi(e,t,134217728,n)}ny(t,134217728)}};N1=function(t){if(t.tag===13){var e=Us(t),n=Xo(t,e);if(n!==null){var r=Un();gi(n,t,e,r)}ny(t,e)}};_1=function(){return Ye};M1=function(t,e){var n=Ye;try{return Ye=t,e()}finally{Ye=n}};lm=function(t,e,n){switch(e){case"input":if(nm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=ep(r);if(!i)throw Error(ie(90));u1(r),nm(r,i)}}}break;case"textarea":h1(t,n);break;case"select":e=n.value,e!=null&&kc(t,!!n.multiple,e,!1)}};C1=Y0;I1=_a;var q_={usingClientEntryPoint:!1,Events:[ld,hc,ep,v1,y1,Y0]},Ol={findFiberByHostInstance:ha,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eM={bundleType:Ol.bundleType,version:Ol.version,rendererPackageName:Ol.rendererPackageName,rendererConfig:Ol.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:es.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=w1(t),t===null?null:t.stateNode},findFiberByHostInstance:Ol.findFiberByHostInstance||Y_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zd.isDisabled&&zd.supportsFiber)try{Jf=zd.inject(eM),Ki=zd}catch{}}kr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=q_;kr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!iy(e))throw Error(ie(200));return J_(t,e,null,n)};kr.createRoot=function(t,e){if(!iy(t))throw Error(ie(299));var n=!1,r="",i=tk;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=ty(t,1,!1,null,null,n,!1,r,i),t[Ho]=e.current,Ru(t.nodeType===8?t.parentNode:t),new ry(e)};kr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ie(188)):(t=Object.keys(t).join(","),Error(ie(268,t)));return t=w1(e),t=t===null?null:t.stateNode,t};kr.flushSync=function(t){return _a(t)};kr.hydrate=function(t,e,n){if(!lp(e))throw Error(ie(200));return up(null,t,e,!0,n)};kr.hydrateRoot=function(t,e,n){if(!iy(t))throw Error(ie(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=tk;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=ek(e,null,t,1,n??null,i,!1,o,s),t[Ho]=e.current,Ru(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new cp(e)};kr.render=function(t,e,n){if(!lp(e))throw Error(ie(200));return up(null,t,e,!1,n)};kr.unmountComponentAtNode=function(t){if(!lp(t))throw Error(ie(40));return t._reactRootContainer?(_a(function(){up(null,null,t,!1,function(){t._reactRootContainer=null,t[Ho]=null})}),!0):!1};kr.unstable_batchedUpdates=Y0;kr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!lp(n))throw Error(ie(200));if(t==null||t._reactInternals===void 0)throw Error(ie(38));return up(t,e,n,!1,r)};kr.version="18.3.1-next-f1338f8080-20240426";function nk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(nk)}catch(t){console.error(t)}}nk(),n1.exports=kr;var oy=n1.exports;const tM=od(oy),nM=Zw({__proto__:null,default:tM},[oy]);var UI=oy;Kg.createRoot=UI.createRoot,Kg.hydrateRoot=UI.hydrateRoot;/**
 * @remix-run/router v1.16.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wt(){return wt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wt.apply(this,arguments)}var Dt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Dt||(Dt={}));const VI="popstate";function rM(t){t===void 0&&(t={});function e(r,i){let{pathname:o,search:s,hash:a}=r.location;return Uu("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:dd(i)}return oM(e,n,null,t)}function We(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Yc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function iM(){return Math.random().toString(36).substr(2,8)}function GI(t,e){return{usr:t.state,key:t.key,idx:e}}function Uu(t,e,n,r){return n===void 0&&(n=null),wt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ys(e):e,{state:n,key:e&&e.key||r||iM()})}function dd(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ys(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function oM(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,a=Dt.Pop,c=null,l=u();l==null&&(l=0,s.replaceState(wt({},s.state,{idx:l}),""));function u(){return(s.state||{idx:null}).idx}function d(){a=Dt.Pop;let C=u(),g=C==null?null:C-l;l=C,c&&c({action:a,location:m.location,delta:g})}function h(C,g){a=Dt.Push;let y=Uu(m.location,C,g);l=u()+1;let S=GI(y,l),E=m.createHref(y);try{s.pushState(S,"",E)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;i.location.assign(E)}o&&c&&c({action:a,location:m.location,delta:1})}function f(C,g){a=Dt.Replace;let y=Uu(m.location,C,g);l=u();let S=GI(y,l),E=m.createHref(y);s.replaceState(S,"",E),o&&c&&c({action:a,location:m.location,delta:0})}function p(C){let g=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof C=="string"?C:dd(C);return y=y.replace(/ $/,"%20"),We(g,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,g)}let m={get action(){return a},get location(){return t(i,s)},listen(C){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(VI,d),c=C,()=>{i.removeEventListener(VI,d),c=null}},createHref(C){return e(i,C)},createURL:p,encodeLocation(C){let g=p(C);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:f,go(C){return s.go(C)}};return m}var It;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(It||(It={}));const sM=new Set(["lazy","caseSensitive","path","id","index","children"]);function aM(t){return t.index===!0}function Wm(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((i,o)=>{let s=[...n,o],a=typeof i.id=="string"?i.id:s.join("-");if(We(i.index!==!0||!i.children,"Cannot specify children on an index route"),We(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),aM(i)){let c=wt({},i,e(i),{id:a});return r[a]=c,c}else{let c=wt({},i,e(i),{id:a,children:void 0});return r[a]=c,i.children&&(c.children=Wm(i.children,e,s,r)),c}})}function Cc(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Ys(e):e,i=hd(r.pathname||"/",n);if(i==null)return null;let o=rk(t);lM(o);let s=null;for(let a=0;s==null&&a<o.length;++a){let c=SM(i);s=yM(o[a],c)}return s}function cM(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function rk(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(o,s,a)=>{let c={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};c.relativePath.startsWith("/")&&(We(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let l=wa([r,c.relativePath]),u=n.concat(c);o.children&&o.children.length>0&&(We(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),rk(o.children,e,u,l)),!(o.path==null&&!o.index)&&e.push({path:l,score:mM(l,o.index),routesMeta:u})};return t.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let c of ik(o.path))i(o,s,c)}),e}function ik(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let s=ik(r.join("/")),a=[];return a.push(...s.map(c=>c===""?o:[o,c].join("/"))),i&&a.push(...s),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function lM(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:vM(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const uM=/^:[\w-]+$/,dM=3,hM=2,fM=1,pM=10,gM=-2,WI=t=>t==="*";function mM(t,e){let n=t.split("/"),r=n.length;return n.some(WI)&&(r+=gM),e&&(r+=hM),n.filter(i=>!WI(i)).reduce((i,o)=>i+(uM.test(o)?dM:o===""?fM:pM),r)}function vM(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function yM(t,e){let{routesMeta:n}=t,r={},i="/",o=[];for(let s=0;s<n.length;++s){let a=n[s],c=s===n.length-1,l=i==="/"?e:e.slice(i.length)||"/",u=CM({path:a.relativePath,caseSensitive:a.caseSensitive,end:c},l);if(!u)return null;Object.assign(r,u.params);let d=a.route;o.push({params:r,pathname:wa([i,u.pathname]),pathnameBase:EM(wa([i,u.pathnameBase])),route:d}),u.pathnameBase!=="/"&&(i=wa([i,u.pathnameBase]))}return o}function CM(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=IM(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((l,u,d)=>{let{paramName:h,isOptional:f}=u;if(h==="*"){let m=a[d]||"";s=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return f&&!p?l[h]=void 0:l[h]=(p||"").replace(/%2F/g,"/"),l},{}),pathname:o,pathnameBase:s,pattern:t}}function IM(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Yc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function SM(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function hd(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function bM(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Ys(t):t;return{pathname:n?n.startsWith("/")?n:wM(n,e):e,search:TM(r),hash:xM(i)}}function wM(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function dg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ok(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function AM(t,e){let n=ok(t);return e?n.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function kM(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Ys(t):(i=wt({},t),We(!i.pathname||!i.pathname.includes("?"),dg("?","pathname","search",i)),We(!i.pathname||!i.pathname.includes("#"),dg("#","pathname","hash",i)),We(!i.search||!i.search.includes("#"),dg("#","search","hash",i)));let o=t===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=n;else{let d=e.length-1;if(!r&&s.startsWith("..")){let h=s.split("/");for(;h[0]==="..";)h.shift(),d-=1;i.pathname=h.join("/")}a=d>=0?e[d]:"/"}let c=bM(i,a),l=s&&s!=="/"&&s.endsWith("/"),u=(o||s===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}const wa=t=>t.join("/").replace(/\/\/+/g,"/"),EM=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),TM=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,xM=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class sy{constructor(e,n,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function ay(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const sk=["post","put","patch","delete"],PM=new Set(sk),RM=["get",...sk],NM=new Set(RM),_M=new Set([301,302,303,307,308]),MM=new Set([307,308]),hg={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},OM={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Dl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},cy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,DM=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),ak="remix-router-transitions";function LM(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;We(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let L=t.detectErrorBoundary;i=G=>({hasErrorBoundary:L(G)})}else i=DM;let o={},s=Wm(t.routes,i,void 0,o),a,c=t.basename||"/",l=t.unstable_dataStrategy||VM,u=wt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,unstable_skipActionErrorRevalidation:!1},t.future),d=null,h=new Set,f=null,p=null,m=null,C=t.hydrationData!=null,g=Cc(s,t.history.location,c),y=null;if(g==null){let L=Mr(404,{pathname:t.history.location.pathname}),{matches:G,route:K}=QI(s);g=G,y={[K.id]:L}}let S,E=g.some(L=>L.route.lazy),A=g.some(L=>L.route.loader);if(E)S=!1;else if(!A)S=!0;else if(u.v7_partialHydration){let L=t.hydrationData?t.hydrationData.loaderData:null,G=t.hydrationData?t.hydrationData.errors:null,K=se=>se.route.loader?typeof se.route.loader=="function"&&se.route.loader.hydrate===!0?!1:L&&L[se.route.id]!==void 0||G&&G[se.route.id]!==void 0:!0;if(G){let se=g.findIndex(ge=>G[ge.route.id]!==void 0);S=g.slice(0,se+1).every(K)}else S=g.every(K)}else S=t.hydrationData!=null;let P,w={historyAction:t.history.action,location:t.history.location,matches:g,initialized:S,navigation:hg,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||y,fetchers:new Map,blockers:new Map},T=Dt.Pop,_=!1,M,D=!1,B=new Map,j=null,Z=!1,z=!1,q=[],oe=[],W=new Map,Y=0,re=-1,H=new Map,te=new Set,Ee=new Map,Le=new Map,ve=new Set,ke=new Map,je=new Map,he=!1;function Tn(){if(d=t.history.listen(L=>{let{action:G,location:K,delta:se}=L;if(he){he=!1;return}Yc(je.size===0||se!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ge=Ke({currentLocation:w.location,nextLocation:K,historyAction:G});if(ge&&se!=null){he=!0,t.history.go(se*-1),tt(ge,{state:"blocked",location:K,proceed(){tt(ge,{state:"proceeding",proceed:void 0,reset:void 0,location:K}),t.history.go(se)},reset(){let Re=new Map(w.blockers);Re.set(ge,Dl),it({blockers:Re})}});return}return ue(G,K)}),n){QM(e,B);let L=()=>qM(e,B);e.addEventListener("pagehide",L),j=()=>e.removeEventListener("pagehide",L)}return w.initialized||ue(Dt.Pop,w.location,{initialHydration:!0}),P}function zn(){d&&d(),j&&j(),h.clear(),M&&M.abort(),w.fetchers.forEach((L,G)=>I(G)),w.blockers.forEach((L,G)=>et(G))}function Tr(L){return h.add(L),()=>h.delete(L)}function it(L,G){G===void 0&&(G={}),w=wt({},w,L);let K=[],se=[];u.v7_fetcherPersist&&w.fetchers.forEach((ge,Re)=>{ge.state==="idle"&&(ve.has(Re)?se.push(Re):K.push(Re))}),[...h].forEach(ge=>ge(w,{deletedFetchers:se,unstable_viewTransitionOpts:G.viewTransitionOpts,unstable_flushSync:G.flushSync===!0})),u.v7_fetcherPersist&&(K.forEach(ge=>w.fetchers.delete(ge)),se.forEach(ge=>I(ge)))}function vn(L,G,K){var se,ge;let{flushSync:Re}=K===void 0?{}:K,Se=w.actionData!=null&&w.navigation.formMethod!=null&&ii(w.navigation.formMethod)&&w.navigation.state==="loading"&&((se=L.state)==null?void 0:se._isRedirect)!==!0,me;G.actionData?Object.keys(G.actionData).length>0?me=G.actionData:me=null:Se?me=w.actionData:me=null;let _e=G.loaderData?JI(w.loaderData,G.loaderData,G.matches||[],G.errors):w.loaderData,Te=w.blockers;Te.size>0&&(Te=new Map(Te),Te.forEach((Ae,Ct)=>Te.set(Ct,Dl)));let qt=_===!0||w.navigation.formMethod!=null&&ii(w.navigation.formMethod)&&((ge=L.state)==null?void 0:ge._isRedirect)!==!0;a&&(s=a,a=void 0),Z||T===Dt.Pop||(T===Dt.Push?t.history.push(L,L.state):T===Dt.Replace&&t.history.replace(L,L.state));let en;if(T===Dt.Pop){let Ae=B.get(w.location.pathname);Ae&&Ae.has(L.pathname)?en={currentLocation:w.location,nextLocation:L}:B.has(L.pathname)&&(en={currentLocation:L,nextLocation:w.location})}else if(D){let Ae=B.get(w.location.pathname);Ae?Ae.add(L.pathname):(Ae=new Set([L.pathname]),B.set(w.location.pathname,Ae)),en={currentLocation:w.location,nextLocation:L}}it(wt({},G,{actionData:me,loaderData:_e,historyAction:T,location:L,initialized:!0,navigation:hg,revalidation:"idle",restoreScrollPosition:xC(L,G.matches||w.matches),preventScrollReset:qt,blockers:Te}),{viewTransitionOpts:en,flushSync:Re===!0}),T=Dt.Pop,_=!1,D=!1,Z=!1,z=!1,q=[],oe=[]}async function xr(L,G){if(typeof L=="number"){t.history.go(L);return}let K=jm(w.location,w.matches,c,u.v7_prependBasename,L,u.v7_relativeSplatPath,G==null?void 0:G.fromRouteId,G==null?void 0:G.relative),{path:se,submission:ge,error:Re}=jI(u.v7_normalizeFormMethod,!1,K,G),Se=w.location,me=Uu(w.location,se,G&&G.state);me=wt({},me,t.history.encodeLocation(me));let _e=G&&G.replace!=null?G.replace:void 0,Te=Dt.Push;_e===!0?Te=Dt.Replace:_e===!1||ge!=null&&ii(ge.formMethod)&&ge.formAction===w.location.pathname+w.location.search&&(Te=Dt.Replace);let qt=G&&"preventScrollReset"in G?G.preventScrollReset===!0:void 0,en=(G&&G.unstable_flushSync)===!0,Ae=Ke({currentLocation:Se,nextLocation:me,historyAction:Te});if(Ae){tt(Ae,{state:"blocked",location:me,proceed(){tt(Ae,{state:"proceeding",proceed:void 0,reset:void 0,location:me}),xr(L,G)},reset(){let Ct=new Map(w.blockers);Ct.set(Ae,Dl),it({blockers:Ct})}});return}return await ue(Te,me,{submission:ge,pendingError:Re,preventScrollReset:qt,replace:G&&G.replace,enableViewTransition:G&&G.unstable_viewTransition,flushSync:en})}function ae(){if(Hn(),it({revalidation:"loading"}),w.navigation.state!=="submitting"){if(w.navigation.state==="idle"){ue(w.historyAction,w.location,{startUninterruptedRevalidation:!0});return}ue(T||w.historyAction,w.navigation.location,{overrideNavigation:w.navigation})}}async function ue(L,G,K){M&&M.abort(),M=null,T=L,Z=(K&&K.startUninterruptedRevalidation)===!0,wR(w.location,w.matches),_=(K&&K.preventScrollReset)===!0,D=(K&&K.enableViewTransition)===!0;let se=a||s,ge=K&&K.overrideNavigation,Re=Cc(se,G,c),Se=(K&&K.flushSync)===!0;if(!Re){let Ae=Mr(404,{pathname:G.pathname}),{matches:Ct,route:Xt}=QI(se);Bp(),vn(G,{matches:Ct,loaderData:{},errors:{[Xt.id]:Ae}},{flushSync:Se});return}if(w.initialized&&!z&&HM(w.location,G)&&!(K&&K.submission&&ii(K.submission.formMethod))){vn(G,{matches:Re},{flushSync:Se});return}M=new AbortController;let me=ec(t.history,G,M.signal,K&&K.submission),_e;if(K&&K.pendingError)_e=[pu(Re).route.id,{type:It.error,error:K.pendingError}];else if(K&&K.submission&&ii(K.submission.formMethod)){let Ae=await ze(me,G,K.submission,Re,{replace:K.replace,flushSync:Se});if(Ae.shortCircuited)return;_e=Ae.pendingActionResult,ge=fg(G,K.submission),Se=!1,me=ec(t.history,me.url,me.signal)}let{shortCircuited:Te,loaderData:qt,errors:en}=await Ve(me,G,Re,ge,K&&K.submission,K&&K.fetcherSubmission,K&&K.replace,K&&K.initialHydration===!0,Se,_e);Te||(M=null,vn(G,wt({matches:Re},YI(_e),{loaderData:qt,errors:en})))}async function ze(L,G,K,se,ge){ge===void 0&&(ge={}),Hn();let Re=JM(G,K);it({navigation:Re},{flushSync:ge.flushSync===!0});let Se,me=zm(se,G);if(!me.route.action&&!me.route.lazy)Se={type:It.error,error:Mr(405,{method:L.method,pathname:G.pathname,routeId:me.route.id})};else if(Se=(await xn("action",L,[me],se))[0],L.signal.aborted)return{shortCircuited:!0};if(ma(Se)){let _e;return ge&&ge.replace!=null?_e=ge.replace:_e=XI(Se.response.headers.get("Location"),new URL(L.url),c)===w.location.pathname+w.location.search,await ut(L,Se,{submission:K,replace:_e}),{shortCircuited:!0}}if(ga(Se))throw Mr(400,{type:"defer-action"});if(Lr(Se)){let _e=pu(se,me.route.id);return(ge&&ge.replace)!==!0&&(T=Dt.Push),{pendingActionResult:[_e.route.id,Se]}}return{pendingActionResult:[me.route.id,Se]}}async function Ve(L,G,K,se,ge,Re,Se,me,_e,Te){let qt=se||fg(G,ge),en=ge||Re||tS(qt),Ae=a||s,[Ct,Xt]=ZI(t.history,w,K,en,G,u.v7_partialHydration&&me===!0,u.unstable_skipActionErrorRevalidation,z,q,oe,ve,Ee,te,Ae,c,Te);if(Bp(Ge=>!(K&&K.some(Pn=>Pn.route.id===Ge))||Ct&&Ct.some(Pn=>Pn.route.id===Ge)),re=++Y,Ct.length===0&&Xt.length===0){let Ge=J();return vn(G,wt({matches:K,loaderData:{},errors:Te&&Lr(Te[1])?{[Te[0]]:Te[1].error}:null},YI(Te),Ge?{fetchers:new Map(w.fetchers)}:{}),{flushSync:_e}),{shortCircuited:!0}}if(!Z&&(!u.v7_partialHydration||!me)){Xt.forEach(Pn=>{let Rr=w.fetchers.get(Pn.key),tn=Ll(void 0,Rr?Rr.data:void 0);w.fetchers.set(Pn.key,tn)});let Ge;Te&&!Lr(Te[1])?Ge={[Te[0]]:Te[1].data}:w.actionData&&(Object.keys(w.actionData).length===0?Ge=null:Ge=w.actionData),it(wt({navigation:qt},Ge!==void 0?{actionData:Ge}:{},Xt.length>0?{fetchers:new Map(w.fetchers)}:{}),{flushSync:_e})}Xt.forEach(Ge=>{W.has(Ge.key)&&O(Ge.key),Ge.controller&&W.set(Ge.key,Ge.controller)});let kl=()=>Xt.forEach(Ge=>O(Ge.key));M&&M.signal.addEventListener("abort",kl);let{loaderResults:ss,fetcherResults:Ja}=await os(w.matches,K,Ct,Xt,L);if(L.signal.aborted)return{shortCircuited:!0};M&&M.signal.removeEventListener("abort",kl),Xt.forEach(Ge=>W.delete(Ge.key));let Ya=qI([...ss,...Ja]);if(Ya){if(Ya.idx>=Ct.length){let Ge=Xt[Ya.idx-Ct.length].key;te.add(Ge)}return await ut(L,Ya.result,{replace:Se}),{shortCircuited:!0}}let{loaderData:Qa,errors:wi}=KI(w,K,Ct,ss,Te,Xt,Ja,ke);ke.forEach((Ge,Pn)=>{Ge.subscribe(Rr=>{(Rr||Ge.done)&&ke.delete(Pn)})}),u.v7_partialHydration&&me&&w.errors&&Object.entries(w.errors).filter(Ge=>{let[Pn]=Ge;return!Ct.some(Rr=>Rr.route.id===Pn)}).forEach(Ge=>{let[Pn,Rr]=Ge;wi=Object.assign(wi||{},{[Pn]:Rr})});let kd=J(),Ed=Oe(re),Td=kd||Ed||Xt.length>0;return wt({loaderData:Qa,errors:wi},Td?{fetchers:new Map(w.fetchers)}:{})}function Pe(L,G,K,se){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");W.has(L)&&O(L);let ge=(se&&se.unstable_flushSync)===!0,Re=a||s,Se=jm(w.location,w.matches,c,u.v7_prependBasename,K,u.v7_relativeSplatPath,G,se==null?void 0:se.relative),me=Cc(Re,Se,c);if(!me){k(L,G,Mr(404,{pathname:Se}),{flushSync:ge});return}let{path:_e,submission:Te,error:qt}=jI(u.v7_normalizeFormMethod,!0,Se,se);if(qt){k(L,G,qt,{flushSync:ge});return}let en=zm(me,_e);if(_=(se&&se.preventScrollReset)===!0,Te&&ii(Te.formMethod)){$e(L,G,_e,en,me,ge,Te);return}Ee.set(L,{routeId:G,path:_e}),Bt(L,G,_e,en,me,ge,Te)}async function $e(L,G,K,se,ge,Re,Se){if(Hn(),Ee.delete(L),!se.route.action&&!se.route.lazy){let tn=Mr(405,{method:Se.formMethod,pathname:K,routeId:G});k(L,G,tn,{flushSync:Re});return}let me=w.fetchers.get(L);Pr(L,YM(Se,me),{flushSync:Re});let _e=new AbortController,Te=ec(t.history,K,_e.signal,Se);W.set(L,_e);let qt=Y,Ae=(await xn("action",Te,[se],ge))[0];if(Te.signal.aborted){W.get(L)===_e&&W.delete(L);return}if(u.v7_fetcherPersist&&ve.has(L)){if(ma(Ae)||Lr(Ae)){Pr(L,ds(void 0));return}}else{if(ma(Ae))if(W.delete(L),re>qt){Pr(L,ds(void 0));return}else return te.add(L),Pr(L,Ll(Se)),ut(Te,Ae,{fetcherSubmission:Se});if(Lr(Ae)){k(L,G,Ae.error);return}}if(ga(Ae))throw Mr(400,{type:"defer-action"});let Ct=w.navigation.location||w.location,Xt=ec(t.history,Ct,_e.signal),kl=a||s,ss=w.navigation.state!=="idle"?Cc(kl,w.navigation.location,c):w.matches;We(ss,"Didn't find any matches after fetcher action");let Ja=++Y;H.set(L,Ja);let Ya=Ll(Se,Ae.data);w.fetchers.set(L,Ya);let[Qa,wi]=ZI(t.history,w,ss,Se,Ct,!1,u.unstable_skipActionErrorRevalidation,z,q,oe,ve,Ee,te,kl,c,[se.route.id,Ae]);wi.filter(tn=>tn.key!==L).forEach(tn=>{let El=tn.key,PC=w.fetchers.get(El),kR=Ll(void 0,PC?PC.data:void 0);w.fetchers.set(El,kR),W.has(El)&&O(El),tn.controller&&W.set(El,tn.controller)}),it({fetchers:new Map(w.fetchers)});let kd=()=>wi.forEach(tn=>O(tn.key));_e.signal.addEventListener("abort",kd);let{loaderResults:Ed,fetcherResults:Td}=await os(w.matches,ss,Qa,wi,Xt);if(_e.signal.aborted)return;_e.signal.removeEventListener("abort",kd),H.delete(L),W.delete(L),wi.forEach(tn=>W.delete(tn.key));let Ge=qI([...Ed,...Td]);if(Ge){if(Ge.idx>=Qa.length){let tn=wi[Ge.idx-Qa.length].key;te.add(tn)}return ut(Xt,Ge.result)}let{loaderData:Pn,errors:Rr}=KI(w,w.matches,Qa,Ed,void 0,wi,Td,ke);if(w.fetchers.has(L)){let tn=ds(Ae.data);w.fetchers.set(L,tn)}Oe(Ja),w.navigation.state==="loading"&&Ja>re?(We(T,"Expected pending action"),M&&M.abort(),vn(w.navigation.location,{matches:ss,loaderData:Pn,errors:Rr,fetchers:new Map(w.fetchers)})):(it({errors:Rr,loaderData:JI(w.loaderData,Pn,ss,Rr),fetchers:new Map(w.fetchers)}),z=!1)}async function Bt(L,G,K,se,ge,Re,Se){let me=w.fetchers.get(L);Pr(L,Ll(Se,me?me.data:void 0),{flushSync:Re});let _e=new AbortController,Te=ec(t.history,K,_e.signal);W.set(L,_e);let qt=Y,Ae=(await xn("loader",Te,[se],ge))[0];if(ga(Ae)&&(Ae=await dk(Ae,Te.signal,!0)||Ae),W.get(L)===_e&&W.delete(L),!Te.signal.aborted){if(ve.has(L)){Pr(L,ds(void 0));return}if(ma(Ae))if(re>qt){Pr(L,ds(void 0));return}else{te.add(L),await ut(Te,Ae);return}if(Lr(Ae)){k(L,G,Ae.error);return}We(!ga(Ae),"Unhandled fetcher deferred data"),Pr(L,ds(Ae.data))}}async function ut(L,G,K){let{submission:se,fetcherSubmission:ge,replace:Re}=K===void 0?{}:K;G.response.headers.has("X-Remix-Revalidate")&&(z=!0);let Se=G.response.headers.get("Location");We(Se,"Expected a Location header on the redirect Response"),Se=XI(Se,new URL(L.url),c);let me=Uu(w.location,Se,{_isRedirect:!0});if(n){let Ct=!1;if(G.response.headers.has("X-Remix-Reload-Document"))Ct=!0;else if(cy.test(Se)){const Xt=t.history.createURL(Se);Ct=Xt.origin!==e.location.origin||hd(Xt.pathname,c)==null}if(Ct){Re?e.location.replace(Se):e.location.assign(Se);return}}M=null;let _e=Re===!0?Dt.Replace:Dt.Push,{formMethod:Te,formAction:qt,formEncType:en}=w.navigation;!se&&!ge&&Te&&qt&&en&&(se=tS(w.navigation));let Ae=se||ge;if(MM.has(G.response.status)&&Ae&&ii(Ae.formMethod))await ue(_e,me,{submission:wt({},Ae,{formAction:Se}),preventScrollReset:_});else{let Ct=fg(me,se);await ue(_e,me,{overrideNavigation:Ct,fetcherSubmission:ge,preventScrollReset:_})}}async function xn(L,G,K,se){try{let ge=await GM(l,L,G,K,se,o,i);return await Promise.all(ge.map((Re,Se)=>{if(XM(Re)){let me=Re.result;return{type:It.redirect,response:ZM(me,G,K[Se].route.id,se,c,u.v7_relativeSplatPath)}}return jM(Re)}))}catch(ge){return K.map(()=>({type:It.error,error:ge}))}}async function os(L,G,K,se,ge){let[Re,...Se]=await Promise.all([K.length?xn("loader",ge,K,G):[],...se.map(me=>{if(me.matches&&me.match&&me.controller){let _e=ec(t.history,me.path,me.controller.signal);return xn("loader",_e,[me.match],me.matches).then(Te=>Te[0])}else return Promise.resolve({type:It.error,error:Mr(404,{pathname:me.path})})})]);return await Promise.all([eS(L,K,Re,Re.map(()=>ge.signal),!1,w.loaderData),eS(L,se.map(me=>me.match),Se,se.map(me=>me.controller?me.controller.signal:null),!0)]),{loaderResults:Re,fetcherResults:Se}}function Hn(){z=!0,q.push(...Bp()),Ee.forEach((L,G)=>{W.has(G)&&(oe.push(G),O(G))})}function Pr(L,G,K){K===void 0&&(K={}),w.fetchers.set(L,G),it({fetchers:new Map(w.fetchers)},{flushSync:(K&&K.flushSync)===!0})}function k(L,G,K,se){se===void 0&&(se={});let ge=pu(w.matches,G);I(L),it({errors:{[ge.route.id]:K},fetchers:new Map(w.fetchers)},{flushSync:(se&&se.flushSync)===!0})}function v(L){return u.v7_fetcherPersist&&(Le.set(L,(Le.get(L)||0)+1),ve.has(L)&&ve.delete(L)),w.fetchers.get(L)||OM}function I(L){let G=w.fetchers.get(L);W.has(L)&&!(G&&G.state==="loading"&&H.has(L))&&O(L),Ee.delete(L),H.delete(L),te.delete(L),ve.delete(L),w.fetchers.delete(L)}function R(L){if(u.v7_fetcherPersist){let G=(Le.get(L)||0)-1;G<=0?(Le.delete(L),ve.add(L)):Le.set(L,G)}else I(L);it({fetchers:new Map(w.fetchers)})}function O(L){let G=W.get(L);We(G,"Expected fetch controller: "+L),G.abort(),W.delete(L)}function V(L){for(let G of L){let K=v(G),se=ds(K.data);w.fetchers.set(G,se)}}function J(){let L=[],G=!1;for(let K of te){let se=w.fetchers.get(K);We(se,"Expected fetcher: "+K),se.state==="loading"&&(te.delete(K),L.push(K),G=!0)}return V(L),G}function Oe(L){let G=[];for(let[K,se]of H)if(se<L){let ge=w.fetchers.get(K);We(ge,"Expected fetcher: "+K),ge.state==="loading"&&(O(K),H.delete(K),G.push(K))}return V(G),G.length>0}function yt(L,G){let K=w.blockers.get(L)||Dl;return je.get(L)!==G&&je.set(L,G),K}function et(L){w.blockers.delete(L),je.delete(L)}function tt(L,G){let K=w.blockers.get(L)||Dl;We(K.state==="unblocked"&&G.state==="blocked"||K.state==="blocked"&&G.state==="blocked"||K.state==="blocked"&&G.state==="proceeding"||K.state==="blocked"&&G.state==="unblocked"||K.state==="proceeding"&&G.state==="unblocked","Invalid blocker state transition: "+K.state+" -> "+G.state);let se=new Map(w.blockers);se.set(L,G),it({blockers:se})}function Ke(L){let{currentLocation:G,nextLocation:K,historyAction:se}=L;if(je.size===0)return;je.size>1&&Yc(!1,"A router only supports one blocker at a time");let ge=Array.from(je.entries()),[Re,Se]=ge[ge.length-1],me=w.blockers.get(Re);if(!(me&&me.state==="proceeding")&&Se({currentLocation:G,nextLocation:K,historyAction:se}))return Re}function Bp(L){let G=[];return ke.forEach((K,se)=>{(!L||L(se))&&(K.cancel(),G.push(se),ke.delete(se))}),G}function bR(L,G,K){if(f=L,m=G,p=K||null,!C&&w.navigation===hg){C=!0;let se=xC(w.location,w.matches);se!=null&&it({restoreScrollPosition:se})}return()=>{f=null,m=null,p=null}}function TC(L,G){return p&&p(L,G.map(se=>cM(se,w.loaderData)))||L.key}function wR(L,G){if(f&&m){let K=TC(L,G);f[K]=m()}}function xC(L,G){if(f){let K=TC(L,G),se=f[K];if(typeof se=="number")return se}return null}function AR(L){o={},a=Wm(L,i,void 0,o)}return P={get basename(){return c},get future(){return u},get state(){return w},get routes(){return s},get window(){return e},initialize:Tn,subscribe:Tr,enableScrollRestoration:bR,navigate:xr,fetch:Pe,revalidate:ae,createHref:L=>t.history.createHref(L),encodeLocation:L=>t.history.encodeLocation(L),getFetcher:v,deleteFetcher:R,dispose:zn,getBlocker:yt,deleteBlocker:et,_internalFetchControllers:W,_internalActiveDeferreds:ke,_internalSetRoutes:AR},P}function BM(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function jm(t,e,n,r,i,o,s,a){let c,l;if(s){c=[];for(let d of e)if(c.push(d),d.route.id===s){l=d;break}}else c=e,l=e[e.length-1];let u=kM(i||".",AM(c,o),hd(t.pathname,n)||t.pathname,a==="path");return i==null&&(u.search=t.search,u.hash=t.hash),(i==null||i===""||i===".")&&l&&l.route.index&&!ly(u.search)&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:wa([n,u.pathname])),dd(u)}function jI(t,e,n,r){if(!r||!BM(r))return{path:n};if(r.formMethod&&!KM(r.formMethod))return{path:n,error:Mr(405,{method:r.formMethod})};let i=()=>({path:n,error:Mr(400,{type:"invalid-body"})}),o=r.formMethod||"get",s=t?o.toUpperCase():o.toLowerCase(),a=lk(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!ii(s))return i();let h=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((f,p)=>{let[m,C]=p;return""+f+m+"="+C+`
`},""):String(r.body);return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:h}}}else if(r.formEncType==="application/json"){if(!ii(s))return i();try{let h=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:h,text:void 0}}}catch{return i()}}}We(typeof FormData=="function","FormData is not available in this environment");let c,l;if(r.formData)c=Zm(r.formData),l=r.formData;else if(r.body instanceof FormData)c=Zm(r.body),l=r.body;else if(r.body instanceof URLSearchParams)c=r.body,l=$I(c);else if(r.body==null)c=new URLSearchParams,l=new FormData;else try{c=new URLSearchParams(r.body),l=$I(c)}catch{return i()}let u={formMethod:s,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:l,json:void 0,text:void 0};if(ii(u.formMethod))return{path:n,submission:u};let d=Ys(n);return e&&d.search&&ly(d.search)&&c.append("index",""),d.search="?"+c,{path:dd(d),submission:u}}function FM(t,e){let n=t;if(e){let r=t.findIndex(i=>i.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function ZI(t,e,n,r,i,o,s,a,c,l,u,d,h,f,p,m){let C=m?Lr(m[1])?m[1].error:m[1].data:void 0,g=t.createURL(e.location),y=t.createURL(i),S=m&&Lr(m[1])?m[0]:void 0,E=S?FM(n,S):n,A=m?m[1].statusCode:void 0,P=s&&A&&A>=400,w=E.filter((_,M)=>{let{route:D}=_;if(D.lazy)return!0;if(D.loader==null)return!1;if(o)return typeof D.loader!="function"||D.loader.hydrate?!0:e.loaderData[D.id]===void 0&&(!e.errors||e.errors[D.id]===void 0);if(UM(e.loaderData,e.matches[M],_)||c.some(Z=>Z===_.route.id))return!0;let B=e.matches[M],j=_;return zI(_,wt({currentUrl:g,currentParams:B.params,nextUrl:y,nextParams:j.params},r,{actionResult:C,unstable_actionStatus:A,defaultShouldRevalidate:P?!1:a||g.pathname+g.search===y.pathname+y.search||g.search!==y.search||ck(B,j)}))}),T=[];return d.forEach((_,M)=>{if(o||!n.some(z=>z.route.id===_.routeId)||u.has(M))return;let D=Cc(f,_.path,p);if(!D){T.push({key:M,routeId:_.routeId,path:_.path,matches:null,match:null,controller:null});return}let B=e.fetchers.get(M),j=zm(D,_.path),Z=!1;h.has(M)?Z=!1:l.includes(M)?Z=!0:B&&B.state!=="idle"&&B.data===void 0?Z=a:Z=zI(j,wt({currentUrl:g,currentParams:e.matches[e.matches.length-1].params,nextUrl:y,nextParams:n[n.length-1].params},r,{actionResult:C,unstable_actionStatus:A,defaultShouldRevalidate:P?!1:a})),Z&&T.push({key:M,routeId:_.routeId,path:_.path,matches:D,match:j,controller:new AbortController})}),[w,T]}function UM(t,e,n){let r=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return r||i}function ck(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function zI(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function HI(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let i=n[t.id];We(i,"No route found in manifest");let o={};for(let s in r){let c=i[s]!==void 0&&s!=="hasErrorBoundary";Yc(!c,'Route "'+i.id+'" has a static property "'+s+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+s+'" will be ignored.')),!c&&!sM.has(s)&&(o[s]=r[s])}Object.assign(i,o),Object.assign(i,wt({},e(i),{lazy:void 0}))}function VM(t){return Promise.all(t.matches.map(e=>e.resolve()))}async function GM(t,e,n,r,i,o,s,a){let c=r.reduce((d,h)=>d.add(h.route.id),new Set),l=new Set,u=await t({matches:i.map(d=>{let h=c.has(d.route.id);return wt({},d,{shouldLoad:h,resolve:p=>(l.add(d.route.id),h?WM(e,n,d,o,s,p,a):Promise.resolve({type:It.data,result:void 0}))})}),request:n,params:i[0].params,context:a});return i.forEach(d=>We(l.has(d.route.id),'`match.resolve()` was not called for route id "'+d.route.id+'". You must call `match.resolve()` on every match passed to `dataStrategy` to ensure all routes are properly loaded.')),u.filter((d,h)=>c.has(i[h].route.id))}async function WM(t,e,n,r,i,o,s){let a,c,l=u=>{let d,h=new Promise((m,C)=>d=C);c=()=>d(),e.signal.addEventListener("abort",c);let f=m=>typeof u!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):u({request:e,params:n.params,context:s},...m!==void 0?[m]:[]),p;return o?p=o(m=>f(m)):p=(async()=>{try{return{type:"data",result:await f()}}catch(m){return{type:"error",result:m}}})(),Promise.race([p,h])};try{let u=n.route[t];if(n.route.lazy)if(u){let d,[h]=await Promise.all([l(u).catch(f=>{d=f}),HI(n.route,i,r)]);if(d!==void 0)throw d;a=h}else if(await HI(n.route,i,r),u=n.route[t],u)a=await l(u);else if(t==="action"){let d=new URL(e.url),h=d.pathname+d.search;throw Mr(405,{method:e.method,pathname:h,routeId:n.route.id})}else return{type:It.data,result:void 0};else if(u)a=await l(u);else{let d=new URL(e.url),h=d.pathname+d.search;throw Mr(404,{pathname:h})}We(a.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(u){return{type:It.error,result:u}}finally{c&&e.signal.removeEventListener("abort",c)}return a}async function jM(t){let{result:e,type:n,status:r}=t;if(uk(e)){let s;try{let a=e.headers.get("Content-Type");a&&/\bapplication\/json\b/.test(a)?e.body==null?s=null:s=await e.json():s=await e.text()}catch(a){return{type:It.error,error:a}}return n===It.error?{type:It.error,error:new sy(e.status,e.statusText,s),statusCode:e.status,headers:e.headers}:{type:It.data,data:s,statusCode:e.status,headers:e.headers}}if(n===It.error)return{type:It.error,error:e,statusCode:ay(e)?e.status:r};if($M(e)){var i,o;return{type:It.deferred,deferredData:e,statusCode:(i=e.init)==null?void 0:i.status,headers:((o=e.init)==null?void 0:o.headers)&&new Headers(e.init.headers)}}return{type:It.data,data:e,statusCode:r}}function ZM(t,e,n,r,i,o){let s=t.headers.get("Location");if(We(s,"Redirects returned/thrown from loaders/actions must have a Location header"),!cy.test(s)){let a=r.slice(0,r.findIndex(c=>c.route.id===n)+1);s=jm(new URL(e.url),a,i,!0,s,o),t.headers.set("Location",s)}return t}function XI(t,e,n){if(cy.test(t)){let r=t,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),o=hd(i.pathname,n)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return t}function ec(t,e,n,r){let i=t.createURL(lk(e)).toString(),o={signal:n};if(r&&ii(r.formMethod)){let{formMethod:s,formEncType:a}=r;o.method=s.toUpperCase(),a==="application/json"?(o.headers=new Headers({"Content-Type":a}),o.body=JSON.stringify(r.json)):a==="text/plain"?o.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?o.body=Zm(r.formData):o.body=r.formData}return new Request(i,o)}function Zm(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function $I(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function zM(t,e,n,r,i,o){let s={},a=null,c,l=!1,u={},d=r&&Lr(r[1])?r[1].error:void 0;return n.forEach((h,f)=>{let p=e[f].route.id;if(We(!ma(h),"Cannot handle redirect results in processLoaderData"),Lr(h)){let m=h.error;d!==void 0&&(m=d,d=void 0),a=a||{};{let C=pu(t,p);a[C.route.id]==null&&(a[C.route.id]=m)}s[p]=void 0,l||(l=!0,c=ay(h.error)?h.error.status:500),h.headers&&(u[p]=h.headers)}else ga(h)?(i.set(p,h.deferredData),s[p]=h.deferredData.data,h.statusCode!=null&&h.statusCode!==200&&!l&&(c=h.statusCode),h.headers&&(u[p]=h.headers)):(s[p]=h.data,h.statusCode&&h.statusCode!==200&&!l&&(c=h.statusCode),h.headers&&(u[p]=h.headers))}),d!==void 0&&r&&(a={[r[0]]:d},s[r[0]]=void 0),{loaderData:s,errors:a,statusCode:c||200,loaderHeaders:u}}function KI(t,e,n,r,i,o,s,a){let{loaderData:c,errors:l}=zM(e,n,r,i,a);for(let u=0;u<o.length;u++){let{key:d,match:h,controller:f}=o[u];We(s!==void 0&&s[u]!==void 0,"Did not find corresponding fetcher result");let p=s[u];if(!(f&&f.signal.aborted))if(Lr(p)){let m=pu(t.matches,h==null?void 0:h.route.id);l&&l[m.route.id]||(l=wt({},l,{[m.route.id]:p.error})),t.fetchers.delete(d)}else if(ma(p))We(!1,"Unhandled fetcher revalidation redirect");else if(ga(p))We(!1,"Unhandled fetcher deferred data");else{let m=ds(p.data);t.fetchers.set(d,m)}}return{loaderData:c,errors:l}}function JI(t,e,n,r){let i=wt({},e);for(let o of n){let s=o.route.id;if(e.hasOwnProperty(s)?e[s]!==void 0&&(i[s]=e[s]):t[s]!==void 0&&o.route.loader&&(i[s]=t[s]),r&&r.hasOwnProperty(s))break}return i}function YI(t){return t?Lr(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function pu(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function QI(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Mr(t,e){let{pathname:n,routeId:r,method:i,type:o}=e===void 0?{}:e,s="Unknown Server Error",a="Unknown @remix-run/router error";return t===400?(s="Bad Request",i&&n&&r?a="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?a="defer() is not supported in actions":o==="invalid-body"&&(a="Unable to encode submission body")):t===403?(s="Forbidden",a='Route "'+r+'" does not match URL "'+n+'"'):t===404?(s="Not Found",a='No route matches URL "'+n+'"'):t===405&&(s="Method Not Allowed",i&&n&&r?a="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(a='Invalid request method "'+i.toUpperCase()+'"')),new sy(t||500,s,new Error(a),!0)}function qI(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(ma(n))return{result:n,idx:e}}}function lk(t){let e=typeof t=="string"?Ys(t):t;return dd(wt({},e,{hash:""}))}function HM(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function XM(t){return uk(t.result)&&_M.has(t.result.status)}function ga(t){return t.type===It.deferred}function Lr(t){return t.type===It.error}function ma(t){return(t&&t.type)===It.redirect}function $M(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function uk(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function KM(t){return NM.has(t.toLowerCase())}function ii(t){return PM.has(t.toLowerCase())}async function eS(t,e,n,r,i,o){for(let s=0;s<n.length;s++){let a=n[s],c=e[s];if(!c)continue;let l=t.find(d=>d.route.id===c.route.id),u=l!=null&&!ck(l,c)&&(o&&o[c.route.id])!==void 0;if(ga(a)&&(i||u)){let d=r[s];We(d,"Expected an AbortSignal for revalidating fetcher deferred result"),await dk(a,d,i).then(h=>{h&&(n[s]=h||n[s])})}}}async function dk(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:It.data,data:t.deferredData.unwrappedData}}catch(i){return{type:It.error,error:i}}return{type:It.data,data:t.deferredData.data}}}function ly(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function zm(t,e){let n=typeof e=="string"?Ys(e).search:e.search;if(t[t.length-1].route.index&&ly(n||""))return t[t.length-1];let r=ok(t);return r[r.length-1]}function tS(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:o,json:s}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(s!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:s,text:void 0}}}function fg(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function JM(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Ll(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function YM(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function ds(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function QM(t,e){try{let n=t.sessionStorage.getItem(ak);if(n){let r=JSON.parse(n);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function qM(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(ak,JSON.stringify(n))}catch(r){Yc(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hm(){return Hm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hm.apply(this,arguments)}const hk=b.createContext(null),fk=b.createContext(null),pk=b.createContext(null),uy=b.createContext(null),dp=b.createContext({outlet:null,matches:[],isDataRoute:!1}),gk=b.createContext(null);function dy(){return b.useContext(uy)!=null}function mk(){return dy()||We(!1),b.useContext(uy).location}function eO(t,e,n,r){dy()||We(!1);let{navigator:i}=b.useContext(pk),{matches:o}=b.useContext(dp),s=o[o.length-1],a=s?s.params:{};s&&s.pathname;let c=s?s.pathnameBase:"/";s&&s.route;let l=mk(),u;u=l;let d=u.pathname||"/",h=d;if(c!=="/"){let m=c.replace(/^\//,"").split("/");h="/"+d.replace(/^\//,"").split("/").slice(m.length).join("/")}let f=Cc(t,{pathname:h});return oO(f&&f.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:wa([c,i.encodeLocation?i.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?c:wa([c,i.encodeLocation?i.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),o,n,r)}function tO(){let t=lO(),e=ay(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),n?b.createElement("pre",{style:i},n):null,null)}const nO=b.createElement(tO,null);class rO extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?b.createElement(dp.Provider,{value:this.props.routeContext},b.createElement(gk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function iO(t){let{routeContext:e,match:n,children:r}=t,i=b.useContext(hk);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),b.createElement(dp.Provider,{value:e},r)}function oO(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if((o=n)!=null&&o.errors)t=n.matches;else return null}let s=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=s.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||We(!1),s=s.slice(0,Math.min(s.length,u+1))}let c=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=u),d.route.id){let{loaderData:h,errors:f}=n,p=d.route.loader&&h[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||p){c=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((u,d,h)=>{let f,p=!1,m=null,C=null;n&&(f=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||nO,c&&(l<0&&h===0?(uO("route-fallback"),p=!0,C=null):l===h&&(p=!0,C=d.route.hydrateFallbackElement||null)));let g=e.concat(s.slice(0,h+1)),y=()=>{let S;return f?S=m:p?S=C:d.route.Component?S=b.createElement(d.route.Component,null):d.route.element?S=d.route.element:S=u,b.createElement(iO,{match:d,routeContext:{outlet:u,matches:g,isDataRoute:n!=null},children:S})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?b.createElement(rO,{location:n.location,revalidation:n.revalidation,component:m,error:f,children:y(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):y()},null)}var Xm=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Xm||{});function sO(t){let e=b.useContext(fk);return e||We(!1),e}function aO(t){let e=b.useContext(dp);return e||We(!1),e}function cO(t){let e=aO(),n=e.matches[e.matches.length-1];return n.route.id||We(!1),n.route.id}function lO(){var t;let e=b.useContext(gk),n=sO(Xm.UseRouteError),r=cO(Xm.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}const nS={};function uO(t,e,n){nS[t]||(nS[t]=!0)}function dO(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Dt.Pop,navigator:o,static:s=!1,future:a}=t;dy()&&We(!1);let c=e.replace(/^\/*/,"/"),l=b.useMemo(()=>({basename:c,navigator:o,static:s,future:Hm({v7_relativeSplatPath:!1},a)}),[c,a,o,s]);typeof r=="string"&&(r=Ys(r));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:p="default"}=r,m=b.useMemo(()=>{let C=hd(u,c);return C==null?null:{location:{pathname:C,search:d,hash:h,state:f,key:p},navigationType:i}},[c,u,d,h,f,p,i]);return m==null?null:b.createElement(pk.Provider,{value:l},b.createElement(uy.Provider,{children:n,value:m}))}new Promise(()=>{});function hO(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:b.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:b.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:b.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hf(){return hf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hf.apply(this,arguments)}const fO="6";try{window.__reactRouterVersion=fO}catch{}function pO(t,e){return LM({basename:void 0,future:hf({},void 0,{v7_prependBasename:!0}),history:rM({window:void 0}),hydrationData:gO(),routes:t,mapRouteProperties:hO,unstable_dataStrategy:void 0,window:void 0}).initialize()}function gO(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=hf({},e,{errors:mO(e.errors)})),e}function mO(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new sy(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let s=new o(i.message);s.stack="",n[r]=s}catch{}}if(n[r]==null){let o=new Error(i.message);o.stack="",n[r]=o}}else n[r]=i;return n}const vO=b.createContext({isTransitioning:!1}),yO=b.createContext(new Map),CO="startTransition",rS=ZR[CO],IO="flushSync",iS=nM[IO];function SO(t){rS?rS(t):t()}function Bl(t){iS?iS(t):t()}class bO{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function wO(t){let{fallbackElement:e,router:n,future:r}=t,[i,o]=b.useState(n.state),[s,a]=b.useState(),[c,l]=b.useState({isTransitioning:!1}),[u,d]=b.useState(),[h,f]=b.useState(),[p,m]=b.useState(),C=b.useRef(new Map),{v7_startTransition:g}=r||{},y=b.useCallback(w=>{g?SO(w):w()},[g]),S=b.useCallback((w,T)=>{let{deletedFetchers:_,unstable_flushSync:M,unstable_viewTransitionOpts:D}=T;_.forEach(j=>C.current.delete(j)),w.fetchers.forEach((j,Z)=>{j.data!==void 0&&C.current.set(Z,j.data)});let B=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!D||B){M?Bl(()=>o(w)):y(()=>o(w));return}if(M){Bl(()=>{h&&(u&&u.resolve(),h.skipTransition()),l({isTransitioning:!0,flushSync:!0,currentLocation:D.currentLocation,nextLocation:D.nextLocation})});let j=n.window.document.startViewTransition(()=>{Bl(()=>o(w))});j.finished.finally(()=>{Bl(()=>{d(void 0),f(void 0),a(void 0),l({isTransitioning:!1})})}),Bl(()=>f(j));return}h?(u&&u.resolve(),h.skipTransition(),m({state:w,currentLocation:D.currentLocation,nextLocation:D.nextLocation})):(a(w),l({isTransitioning:!0,flushSync:!1,currentLocation:D.currentLocation,nextLocation:D.nextLocation}))},[n.window,h,u,C,y]);b.useLayoutEffect(()=>n.subscribe(S),[n,S]),b.useEffect(()=>{c.isTransitioning&&!c.flushSync&&d(new bO)},[c]),b.useEffect(()=>{if(u&&s&&n.window){let w=s,T=u.promise,_=n.window.document.startViewTransition(async()=>{y(()=>o(w)),await T});_.finished.finally(()=>{d(void 0),f(void 0),a(void 0),l({isTransitioning:!1})}),f(_)}},[y,s,u,n.window]),b.useEffect(()=>{u&&s&&i.location.key===s.location.key&&u.resolve()},[u,h,i.location,s]),b.useEffect(()=>{!c.isTransitioning&&p&&(a(p.state),l({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),m(void 0))},[c.isTransitioning,p]),b.useEffect(()=>{},[]);let E=b.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:w=>n.navigate(w),push:(w,T,_)=>n.navigate(w,{state:T,preventScrollReset:_==null?void 0:_.preventScrollReset}),replace:(w,T,_)=>n.navigate(w,{replace:!0,state:T,preventScrollReset:_==null?void 0:_.preventScrollReset})}),[n]),A=n.basename||"/",P=b.useMemo(()=>({router:n,navigator:E,static:!1,basename:A}),[n,E,A]);return b.createElement(b.Fragment,null,b.createElement(hk.Provider,{value:P},b.createElement(fk.Provider,{value:i},b.createElement(yO.Provider,{value:C.current},b.createElement(vO.Provider,{value:c},b.createElement(dO,{basename:A,location:i.location,navigationType:i.historyAction,navigator:E,future:{v7_relativeSplatPath:n.future.v7_relativeSplatPath}},i.initialized||n.future.v7_partialHydration?b.createElement(AO,{routes:n.routes,future:n.future,state:i}):e))))),null)}function AO(t){let{routes:e,future:n,state:r}=t;return eO(e,void 0,r,n)}var oS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(oS||(oS={}));var sS;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(sS||(sS={}));const vk=t=>{const e=typeof t=="function",n=b.useRef(t);b.useEffect(()=>{n.current=t}),b.useEffect(()=>{if(e){const r=i=>{const o=n.current(i);if(typeof o=="string")return i.preventDefault(),i.returnValue=o;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])};var aS=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function kO(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var cs=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],EO=function(){aS(t,null,[{key:"escapeForHtml",value:function(n){return new t().escapeForHtml(n)}},{key:"linkify",value:function(n){return new t().linkify(n)}},{key:"ansiToHtml",value:function(n,r){return new t().ansiToHtml(n,r)}},{key:"ansiToJson",value:function(n,r){return new t().ansiToJson(n,r)}},{key:"ansiToText",value:function(n){return new t().ansiToText(n)}}]);function t(){kO(this,t),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return aS(t,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var n=0;n<2;++n)for(var r=0;r<8;++r)this.PALETTE_COLORS.push(cs[n][r].color);for(var i=[0,95,135,175,215,255],o=function(h,f,p){return i[h]+", "+i[f]+", "+i[p]},s=0;s<6;++s)for(var a=0;a<6;++a)for(var c=0;c<6;++c)this.PALETTE_COLORS.push(o(s,a,c));for(var l=8,u=0;u<24;++u,l+=10)this.PALETTE_COLORS.push(o(l,l,l))}},{key:"escapeForHtml",value:function(n){return n.replace(/[&<>\"]/gm,function(r){return r=="&"?"&amp;":r=='"'?"&quot;":r=="<"?"&lt;":r==">"?"&gt;":""})}},{key:"linkify",value:function(n){return n.replace(/(https?:\/\/[^\s]+)/gm,function(r){return'<a href="'+r+'">'+r+"</a>"})}},{key:"ansiToHtml",value:function(n,r){return this.process(n,r,!0)}},{key:"ansiToJson",value:function(n,r){return r=r||{},r.json=!0,r.clearLine=!1,this.process(n,r,!0)}},{key:"ansiToText",value:function(n){return this.process(n,{},!1)}},{key:"process",value:function(n,r,i){var o=this,s=this,a=n.split(/\033\[/),c=a.shift();r==null&&(r={}),r.clearLine=/\r/.test(n);var l=a.map(function(d){return o.processChunk(d,r,i)});if(r&&r.json){var u=s.processChunkJson("");return u.content=c,u.clearLine=r.clearLine,l.unshift(u),r.remove_empty&&(l=l.filter(function(d){return!d.isEmpty()})),l}else l.unshift(c);return l.join("")}},{key:"processChunkJson",value:function(n,r,i){r=typeof r>"u"?{}:r;var o=r.use_classes=typeof r.use_classes<"u"&&r.use_classes,s=r.key=o?"class":"color",a={content:n,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:r.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!a.content}},c=n.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!c)return a;a.content=c[4];var l=c[2].split(";");if(c[1]!==""||c[3]!=="m"||!i)return a;for(var u=this;l.length>0;){var d=l.shift(),h=parseInt(d);if(isNaN(h)||h===0)u.fg=u.bg=null,u.decorations=[];else if(h===1)u.decorations.push("bold");else if(h===2)u.decorations.push("dim");else if(h===3)u.decorations.push("italic");else if(h===4)u.decorations.push("underline");else if(h===5)u.decorations.push("blink");else if(h===7)u.decorations.push("reverse");else if(h===8)u.decorations.push("hidden");else if(h===9)u.decorations.push("strikethrough");else if(h===21)u.removeDecoration("bold");else if(h===22)u.removeDecoration("bold"),u.removeDecoration("dim");else if(h===23)u.removeDecoration("italic");else if(h===24)u.removeDecoration("underline");else if(h===25)u.removeDecoration("blink");else if(h===27)u.removeDecoration("reverse");else if(h===28)u.removeDecoration("hidden");else if(h===29)u.removeDecoration("strikethrough");else if(h===39)u.fg=null;else if(h===49)u.bg=null;else if(h>=30&&h<38)u.fg=cs[0][h%10][s];else if(h>=90&&h<98)u.fg=cs[1][h%10][s];else if(h>=40&&h<48)u.bg=cs[0][h%10][s];else if(h>=100&&h<108)u.bg=cs[1][h%10][s];else if(h===38||h===48){var f=h===38;if(l.length>=1){var p=l.shift();if(p==="5"&&l.length>=1){var m=parseInt(l.shift());if(m>=0&&m<=255)if(!o)this.PALETTE_COLORS||u.setupPalette(),f?u.fg=this.PALETTE_COLORS[m]:u.bg=this.PALETTE_COLORS[m];else{var C=m>=16?"ansi-palette-"+m:cs[m>7?1:0][m%8].class;f?u.fg=C:u.bg=C}}else if(p==="2"&&l.length>=3){var g=parseInt(l.shift()),y=parseInt(l.shift()),S=parseInt(l.shift());if(g>=0&&g<=255&&y>=0&&y<=255&&S>=0&&S<=255){var E=g+", "+y+", "+S;o?f?(u.fg="ansi-truecolor",u.fg_truecolor=E):(u.bg="ansi-truecolor",u.bg_truecolor=E):f?u.fg=E:u.bg=E}}}}}return u.fg===null&&u.bg===null&&u.decorations.length===0||(a.fg=u.fg,a.bg=u.bg,a.fg_truecolor=u.fg_truecolor,a.bg_truecolor=u.bg_truecolor,a.decorations=u.decorations,a.decoration=u.decorations.slice(-1).pop()||null,a.was_processed=!0),a}},{key:"processChunk",value:function(n,r,i){var o=this;r=r||{};var s=this.processChunkJson(n,r,i),a=r.use_classes;if(s.decorations=s.decorations.filter(function(f){if(f==="reverse"){s.fg||(s.fg=cs[0][7][a?"class":"color"]),s.bg||(s.bg=cs[0][0][a?"class":"color"]);var p=s.fg;s.fg=s.bg,s.bg=p;var m=s.fg_truecolor;return s.fg_truecolor=s.bg_truecolor,s.bg_truecolor=m,s.isInverted=!0,!1}return!0}),r.json)return s;if(s.isEmpty())return"";if(!s.was_processed)return s.content;var c=[],l=[],u=[],d={},h=function(p){var m=[],C=void 0;for(C in p)p.hasOwnProperty(C)&&m.push("data-"+C+'="'+o.escapeForHtml(p[C])+'"');return m.length>0?" "+m.join(" "):""};return s.isInverted&&(d["ansi-is-inverted"]="true"),s.fg&&(a?(c.push(s.fg+"-fg"),s.fg_truecolor!==null&&(d["ansi-truecolor-fg"]=s.fg_truecolor,s.fg_truecolor=null)):c.push("color:rgb("+s.fg+")")),s.bg&&(a?(c.push(s.bg+"-bg"),s.bg_truecolor!==null&&(d["ansi-truecolor-bg"]=s.bg_truecolor,s.bg_truecolor=null)):c.push("background-color:rgb("+s.bg+")")),s.decorations.forEach(function(f){if(a){l.push("ansi-"+f);return}f==="bold"?l.push("font-weight:bold"):f==="dim"?l.push("opacity:0.5"):f==="italic"?l.push("font-style:italic"):f==="hidden"?l.push("visibility:hidden"):f==="strikethrough"?u.push("line-through"):u.push(f)}),u.length&&l.push("text-decoration:"+u.join(" ")),a?'<span class="'+c.concat(l).join(" ")+'"'+h(d)+">"+s.content+"</span>":'<span style="'+c.concat(l).join(";")+'"'+h(d)+">"+s.content+"</span>"}},{key:"removeDecoration",value:function(n){var r=this.decorations.indexOf(n);r>=0&&this.decorations.splice(r,1)}}]),t}(),TO=EO;const xO=od(TO);function PO(t,e){let n=[];for(const r of t.split(`\r
`)){const i=xO.ansiToJson(r,{json:!0,remove_empty:!1});let o=[];for(const s of i){const a=MO(s,e);o=[...o,...a]}n=[...n,X.jsx("span",{children:o},n.length)]}return n}const RO=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,NO=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,_O=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function MO(t,e){const n=OO(t),r=[];let i=0,o=0;function s(u,d){let h;for(;(h=u.exec(t.content))!==null;){const f=h.index;f>i&&r.push(t.content.substring(i,f)),r.push(d(h)),i=u.lastIndex}}function a(u){const[,d,h]=u,f=h;return X.jsxs(X.Fragment,{children:[d,X.jsx("a",{href:f,target:"_blank",rel:"noreferrer",children:h})]})}function c(u){const d=u.groups.name,h=`mailto:${d}`;return X.jsxs(X.Fragment,{children:[u.groups.slorp1,X.jsx("a",{href:h,target:"_blank",rel:"noreferrer",children:d}),u.groups.slorp2]})}function l(u){const[,d,h]=u;return X.jsx("a",{onClick:()=>e(d),className:"exit",children:h})}return s(RO,a),s(NO,c),s(_O,l),i<t.content.length&&r.push(t.content.substring(i)),r.map(u=>X.jsx("span",{style:n,children:u},o++))}function OO(t){const e={};switch(t.bg&&(e.backgroundColor=`rgb(${t.bg})`),t.fg&&(e.color=`rgb(${t.fg})`),t.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}var Za={},ul={},yk=b;function Ne(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Xn=Object.prototype.hasOwnProperty,DO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cS={},lS={};function Ck(t){return Xn.call(lS,t)?!0:Xn.call(cS,t)?!1:DO.test(t)?lS[t]=!0:(cS[t]=!0,!1)}function Wn(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var hn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){hn[t]=new Wn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];hn[e]=new Wn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){hn[t]=new Wn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){hn[t]=new Wn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){hn[t]=new Wn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){hn[t]=new Wn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){hn[t]=new Wn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){hn[t]=new Wn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){hn[t]=new Wn(t,5,!1,t.toLowerCase(),null,!1,!1)});var hy=/[\-:]([a-z])/g;function fy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(hy,fy);hn[e]=new Wn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(hy,fy);hn[e]=new Wn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(hy,fy);hn[e]=new Wn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){hn[t]=new Wn(t,1,!1,t.toLowerCase(),null,!1,!1)});hn.xlinkHref=new Wn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){hn[t]=new Wn(t,1,!1,t.toLowerCase(),null,!0,!0)});var mh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},LO=["Webkit","ms","Moz","O"];Object.keys(mh).forEach(function(t){LO.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),mh[e]=mh[t]})});var BO=/["'&<>]/;function Dn(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=BO.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var FO=/([A-Z])/g,UO=/^ms-/,$m=Array.isArray;function so(t,e){return{insertionMode:t,selectedValue:e}}function VO(t,e,n){switch(e){case"select":return so(1,n.value!=null?n.value:n.defaultValue);case"svg":return so(2,null);case"math":return so(3,null);case"foreignObject":return so(1,null);case"table":return so(4,null);case"thead":case"tbody":case"tfoot":return so(5,null);case"colgroup":return so(7,null);case"tr":return so(6,null)}return 4<=t.insertionMode||t.insertionMode===0?so(1,null):t}var uS=new Map;function Ik(t,e,n){if(typeof n!="object")throw Error(Ne(62));e=!0;for(var r in n)if(Xn.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=Dn(r);i=Dn((""+i).trim())}else{o=r;var s=uS.get(o);s!==void 0||(s=Dn(o.replace(FO,"-$1").toLowerCase().replace(UO,"-ms-")),uS.set(o,s)),o=s,i=typeof i=="number"?i===0||Xn.call(mh,r)?""+i:i+"px":Dn((""+i).trim())}e?(e=!1,t.push(' style="',o,":",i)):t.push(";",o,":",i)}}e||t.push('"')}function ar(t,e,n,r){switch(n){case"style":Ik(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=hn.hasOwnProperty(n)?hn[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=e.attributeName,e.type){case 3:r&&t.push(" ",n,'=""');break;case 4:r===!0?t.push(" ",n,'=""'):r!==!1&&t.push(" ",n,'="',Dn(r),'"');break;case 5:isNaN(r)||t.push(" ",n,'="',Dn(r),'"');break;case 6:!isNaN(r)&&1<=r&&t.push(" ",n,'="',Dn(r),'"');break;default:e.sanitizeURL&&(r=""+r),t.push(" ",n,'="',Dn(r),'"')}}else if(Ck(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(" ",n,'="',Dn(r),'"')}}}function vh(t,e,n){if(e!=null){if(n!=null)throw Error(Ne(60));if(typeof e!="object"||!("__html"in e))throw Error(Ne(61));e=e.__html,e!=null&&t.push(""+e)}}function GO(t){var e="";return yk.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}function pg(t,e,n,r){t.push(ki(n));var i=n=null,o;for(o in e)if(Xn.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:ar(t,r,o,s)}}return t.push(">"),vh(t,i,n),typeof n=="string"?(t.push(Dn(n)),null):n}var WO=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,dS=new Map;function ki(t){var e=dS.get(t);if(e===void 0){if(!WO.test(t))throw Error(Ne(65,t));e="<"+t,dS.set(t,e)}return e}function jO(t,e,n,r,i){switch(e){case"select":t.push(ki("select"));var o=null,s=null;for(u in n)if(Xn.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:ar(t,r,u,a)}}return t.push(">"),vh(t,s,o),o;case"option":s=i.selectedValue,t.push(ki("option"));var c=a=null,l=null,u=null;for(o in n)if(Xn.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":l=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":c=d;default:ar(t,r,o,d)}}if(s!=null)if(n=c!==null?""+c:GO(a),$m(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(' selected=""');break}}else""+s===n&&t.push(' selected=""');else l&&t.push(' selected=""');return t.push(">"),vh(t,u,a),a;case"textarea":t.push(ki("textarea")),u=s=o=null;for(a in n)if(Xn.call(n,a)&&(c=n[a],c!=null))switch(a){case"children":u=c;break;case"value":o=c;break;case"defaultValue":s=c;break;case"dangerouslySetInnerHTML":throw Error(Ne(91));default:ar(t,r,a,c)}if(o===null&&s!==null&&(o=s),t.push(">"),u!=null){if(o!=null)throw Error(Ne(92));if($m(u)&&1<u.length)throw Error(Ne(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o!==null&&t.push(Dn(""+o)),null;case"input":t.push(ki("input")),c=u=a=o=null;for(s in n)if(Xn.call(n,s)&&(l=n[s],l!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(Ne(399,"input"));case"defaultChecked":c=l;break;case"defaultValue":a=l;break;case"checked":u=l;break;case"value":o=l;break;default:ar(t,r,s,l)}return u!==null?ar(t,r,"checked",u):c!==null&&ar(t,r,"checked",c),o!==null?ar(t,r,"value",o):a!==null&&ar(t,r,"value",a),t.push("/>"),null;case"menuitem":t.push(ki("menuitem"));for(var h in n)if(Xn.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(Ne(400));default:ar(t,r,h,o)}return t.push(">"),null;case"title":t.push(ki("title")),o=null;for(d in n)if(Xn.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(Ne(434));default:ar(t,r,d,s)}return t.push(">"),o;case"listing":case"pre":t.push(ki(e)),s=o=null;for(c in n)if(Xn.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:ar(t,r,c,a)}if(t.push(">"),s!=null){if(o!=null)throw Error(Ne(60));if(typeof s!="object"||!("__html"in s))throw Error(Ne(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(`
`,n):t.push(""+n))}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(ki(e));for(var f in n)if(Xn.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(Ne(399,e));default:ar(t,r,f,o)}return t.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return pg(t,n,e,r);case"html":return i.insertionMode===0&&t.push("<!DOCTYPE html>"),pg(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return pg(t,n,e,r);t.push(ki(e)),s=o=null;for(l in n)if(Xn.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":Ik(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:Ck(l)&&typeof a!="function"&&typeof a!="symbol"&&t.push(" ",l,'="',Dn(a),'"')}return t.push(">"),vh(t,s,o),o}}function hS(t,e,n){if(t.push('<!--$?--><template id="'),n===null)throw Error(Ne(395));return t.push(n),t.push('"></template>')}function ZO(t,e,n,r){switch(n.insertionMode){case 0:case 1:return t.push('<div hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 2:return t.push('<svg aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 3:return t.push('<math aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 4:return t.push('<table hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 5:return t.push('<table hidden><tbody id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 6:return t.push('<table hidden><tr id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 7:return t.push('<table hidden><colgroup id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');default:throw Error(Ne(397))}}function zO(t,e){switch(e.insertionMode){case 0:case 1:return t.push("</div>");case 2:return t.push("</svg>");case 3:return t.push("</math>");case 4:return t.push("</table>");case 5:return t.push("</tbody></table>");case 6:return t.push("</tr></table>");case 7:return t.push("</colgroup></table>");default:throw Error(Ne(397))}}var HO=/[<\u2028\u2029]/g;function gg(t){return JSON.stringify(t).replace(HO,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function XO(t,e){return e=e===void 0?"":e,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:e+"P:",segmentPrefix:e+"S:",boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:t}}function fS(t,e,n,r){return n.generateStaticMarkup?(t.push(Dn(e)),!1):(e===""?t=r:(r&&t.push("<!-- -->"),t.push(Dn(e)),t=!0),t)}var gu=Object.assign,$O=Symbol.for("react.element"),Sk=Symbol.for("react.portal"),bk=Symbol.for("react.fragment"),wk=Symbol.for("react.strict_mode"),Ak=Symbol.for("react.profiler"),kk=Symbol.for("react.provider"),Ek=Symbol.for("react.context"),Tk=Symbol.for("react.forward_ref"),xk=Symbol.for("react.suspense"),Pk=Symbol.for("react.suspense_list"),Rk=Symbol.for("react.memo"),py=Symbol.for("react.lazy"),KO=Symbol.for("react.scope"),JO=Symbol.for("react.debug_trace_mode"),YO=Symbol.for("react.legacy_hidden"),QO=Symbol.for("react.default_value"),pS=Symbol.iterator;function Km(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case bk:return"Fragment";case Sk:return"Portal";case Ak:return"Profiler";case wk:return"StrictMode";case xk:return"Suspense";case Pk:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Ek:return(t.displayName||"Context")+".Consumer";case kk:return(t._context.displayName||"Context")+".Provider";case Tk:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rk:return e=t.displayName||null,e!==null?e:Km(t.type)||"Memo";case py:e=t._payload,t=t._init;try{return Km(t(e))}catch{}}return null}var Nk={};function gS(t,e){if(t=t.contextTypes,!t)return Nk;var n={},r;for(r in t)n[r]=e[r];return n}var va=null;function hp(t,e){if(t!==e){t.context._currentValue2=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(Ne(401))}else{if(n===null)throw Error(Ne(401));hp(t,n)}e.context._currentValue2=e.value}}function _k(t){t.context._currentValue2=t.parentValue,t=t.parent,t!==null&&_k(t)}function Mk(t){var e=t.parent;e!==null&&Mk(e),t.context._currentValue2=t.value}function Ok(t,e){if(t.context._currentValue2=t.parentValue,t=t.parent,t===null)throw Error(Ne(402));t.depth===e.depth?hp(t,e):Ok(t,e)}function Dk(t,e){var n=e.parent;if(n===null)throw Error(Ne(402));t.depth===n.depth?hp(t,n):Dk(t,n),e.context._currentValue2=e.value}function ff(t){var e=va;e!==t&&(e===null?Mk(t):t===null?_k(e):e.depth===t.depth?hp(e,t):e.depth>t.depth?Ok(e,t):Dk(e,t),va=t)}var mS={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function vS(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=mS,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue2:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:gu({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&mS.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=gu({},o,a)):gu(o,a))}t.state=o}else o.queue=null}var qO={id:1,overflow:""};function Jm(t,e,n){var r=t.id;t=t.overflow;var i=32-yh(r)-1;r&=~(1<<i),n+=1;var o=32-yh(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-yh(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var yh=Math.clz32?Math.clz32:nD,eD=Math.log,tD=Math.LN2;function nD(t){return t>>>=0,t===0?32:31-(eD(t)/tD|0)|0}function rD(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var iD=typeof Object.is=="function"?Object.is:rD,Ko=null,gy=null,Ch=null,ot=null,Kl=!1,pf=!1,Vu=0,ks=null,fp=0;function aa(){if(Ko===null)throw Error(Ne(321));return Ko}function yS(){if(0<fp)throw Error(Ne(312));return{memoizedState:null,queue:null,next:null}}function my(){return ot===null?Ch===null?(Kl=!1,Ch=ot=yS()):(Kl=!0,ot=Ch):ot.next===null?(Kl=!1,ot=ot.next=yS()):(Kl=!0,ot=ot.next),ot}function vy(){gy=Ko=null,pf=!1,Ch=null,fp=0,ot=ks=null}function Lk(t,e){return typeof e=="function"?e(t):e}function CS(t,e,n){if(Ko=aa(),ot=my(),Kl){var r=ot.queue;if(e=r.dispatch,ks!==null&&(n=ks.get(r),n!==void 0)){ks.delete(r),r=ot.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return ot.memoizedState=r,[r,e]}return[ot.memoizedState,e]}return t=t===Lk?typeof e=="function"?e():e:n!==void 0?n(e):e,ot.memoizedState=t,t=ot.queue={last:null,dispatch:null},t=t.dispatch=oD.bind(null,Ko,t),[ot.memoizedState,t]}function IS(t,e){if(Ko=aa(),ot=my(),e=e===void 0?null:e,ot!==null){var n=ot.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!iD(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),ot.memoizedState=[t,e],t}function oD(t,e,n){if(25<=fp)throw Error(Ne(301));if(t===Ko)if(pf=!0,t={action:n,next:null},ks===null&&(ks=new Map),n=ks.get(e),n===void 0)ks.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function sD(){throw Error(Ne(394))}function Hd(){}var SS={readContext:function(t){return t._currentValue2},useContext:function(t){return aa(),t._currentValue2},useMemo:IS,useReducer:CS,useRef:function(t){Ko=aa(),ot=my();var e=ot.memoizedState;return e===null?(t={current:t},ot.memoizedState=t):e},useState:function(t){return CS(Lk,t)},useInsertionEffect:Hd,useLayoutEffect:function(){},useCallback:function(t,e){return IS(function(){return t},e)},useImperativeHandle:Hd,useEffect:Hd,useDebugValue:Hd,useDeferredValue:function(t){return aa(),t},useTransition:function(){return aa(),[!1,sD]},useId:function(){var t=gy.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-yh(t)-1)).toString(32)+e;var n=Ih;if(n===null)throw Error(Ne(404));return e=Vu++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return aa(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(Ne(407));return n()}},Ih=null,mg=yk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function aD(t){return console.error(t),null}function Jl(){}function cD(t,e,n,r,i,o,s,a,c){var l=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:l,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?aD:i,onAllReady:Jl,onShellReady:s===void 0?Jl:s,onShellError:Jl,onFatalError:Jl},n=gf(e,0,null,n,!1,!1),n.parentFlushed=!0,t=yy(e,t,null,n,u,Nk,null,qO),l.push(t),e}function yy(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var c={node:e,ping:function(){var l=t.pingedTasks;l.push(c),l.length===1&&Uk(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(c),c}function gf(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function Gu(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function mf(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,t.destination.destroy(e)):(t.status=1,t.fatalError=e)}function bS(t,e,n,r,i){for(Ko={},gy=e,Vu=0,t=n(r,i);pf;)pf=!1,Vu=0,fp+=1,ot=null,t=n(r,i);return vy(),t}function wS(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(Ne(108,Km(r)||"Unknown",a));r=gu({},s,n)}e.legacyContext=r,pr(t,e,i),e.legacyContext=s}else pr(t,e,i)}function AS(t,e){if(t&&t.defaultProps){e=gu({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ym(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=gS(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue2:i),vS(o,n,r,i),wS(t,e,o,n)}else{o=gS(n,e.legacyContext),i=bS(t,e,n,r,o);var s=Vu!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)vS(i,n,r,o),wS(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=Jm(r,1,0);try{pr(t,e,i)}finally{e.treeContext=r}}else pr(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=jO(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=VO(s,n,r),Qm(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push("</",n,">")}i.lastPushedText=!1}else{switch(n){case YO:case JO:case wk:case Ak:case bk:pr(t,e,r.children);return;case Pk:pr(t,e,r.children);return;case KO:throw Error(Ne(343));case xk:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},c=gf(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(c),i.lastPushedText=!1;var l=gf(t,0,null,i.formatContext,!1,!1);l.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=l;try{if(Qm(t,e,r),t.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),l.status=1,vf(a,l),a.pendingTasks===0)break e}catch(u){l.status=4,a.forceClientRender=!0,a.errorDigest=Gu(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=yy(t,o,n,c,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Tk:if(r=bS(t,e,n.render,r,i),Vu!==0){n=e.treeContext,e.treeContext=Jm(n,1,0);try{pr(t,e,r)}finally{e.treeContext=n}}else pr(t,e,r);return;case Rk:n=n.type,r=AS(n,r),Ym(t,e,n,r,i);return;case kk:if(i=r.children,n=n._context,r=r.value,o=n._currentValue2,n._currentValue2=r,s=va,va=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,pr(t,e,i),t=va,t===null)throw Error(Ne(403));r=t.parentValue,t.context._currentValue2=r===QO?t.context._defaultValue:r,t=va=t.parent,e.context=t;return;case Ek:r=r.children,r=r(n._currentValue2),pr(t,e,r);return;case py:i=n._init,n=i(n._payload),r=AS(n,r),Ym(t,e,n,r,void 0);return}throw Error(Ne(130,n==null?n:typeof n,""))}}function pr(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case $O:Ym(t,e,n.type,n.props,n.ref);return;case Sk:throw Error(Ne(257));case py:var r=n._init;n=r(n._payload),pr(t,e,n);return}if($m(n)){kS(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=pS&&n[pS]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);kS(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(Ne(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=fS(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=fS(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function kS(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=Jm(o,r,i);try{Qm(t,e,n[i])}finally{e.treeContext=o}}}function Qm(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return pr(t,e,n)}catch(c){if(vy(),typeof c=="object"&&c!==null&&typeof c.then=="function"){n=c;var s=e.blockedSegment,a=gf(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=yy(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,ff(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,ff(o),c}}function lD(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,Fk(this,e,t)}function Bk(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.push(null))):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(Ne(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return Bk(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function vf(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&vf(t,n)}else t.completedSegments.push(e)}function Fk(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(Ne(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=Jl,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&vf(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(lD,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(vf(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function Uk(t){if(t.status!==2){var e=va,n=mg.current;mg.current=SS;var r=Ih;Ih=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,c=s.blockedSegment;if(c.status===0){ff(s.context);try{pr(a,s,s.node),a.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("<!-- -->"),s.abortSet.delete(s),c.status=1,Fk(a,s.blockedBoundary,c)}catch(p){if(vy(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var l=s.ping;p.then(l,l)}else{s.abortSet.delete(s),c.status=4;var u=s.blockedBoundary,d=p,h=Gu(a,d);if(u===null?mf(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=h,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var f=a.onAllReady;f()}}}finally{}}}i.splice(0,o),t.destination!==null&&Cy(t,t.destination)}catch(p){Gu(t,p),mf(t,p)}finally{Ih=r,mg.current=n,n===SS&&ff(e)}}}function Xd(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,e.push('<template id="'),e.push(t.placeholderPrefix),t=r.toString(16),e.push(t),e.push('"></template>');case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)e.push(r[o]);i=pp(t,e,i)}for(;o<r.length-1;o++)e.push(r[o]);return o<r.length&&(i=e.push(r[o])),i;default:throw Error(Ne(390))}}function pp(t,e,n){var r=n.boundary;if(r===null)return Xd(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)return t.responseState.generateStaticMarkup||(r=r.errorDigest,e.push("<!--$!-->"),e.push("<template"),r&&(e.push(' data-dgst="'),r=Dn(r),e.push(r),e.push('"')),e.push("></template>")),Xd(t,e,n),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t;if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;return i=i.boundaryPrefix+o.toString(16),r=r.id=i,hS(e,t.responseState,r),Xd(t,e,n),e.push("<!--/$-->")}if(r.byteSize>t.progressiveChunkSize)return r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),hS(e,t.responseState,r.id),Xd(t,e,n),e.push("<!--/$-->");if(t.responseState.generateStaticMarkup||e.push("<!--$-->"),n=r.completedSegments,n.length!==1)throw Error(Ne(391));return pp(t,e,n[0]),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t}function ES(t,e,n){return ZO(e,t.responseState,n.formatContext,n.id),pp(t,e,n),zO(e,n.formatContext)}function TS(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)Vk(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,e.push(t.startInlineScript),t.sentCompleteBoundaryFunction?e.push('$RC("'):(t.sentCompleteBoundaryFunction=!0,e.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),r===null)throw Error(Ne(395));return n=n.toString(16),e.push(r),e.push('","'),e.push(t.segmentPrefix),e.push(n),e.push('")<\/script>')}function Vk(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(Ne(392));return ES(t,e,r)}return ES(t,e,r),t=t.responseState,e.push(t.startInlineScript),t.sentCompleteSegmentFunction?e.push('$RS("'):(t.sentCompleteSegmentFunction=!0,e.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),e.push(t.segmentPrefix),i=i.toString(16),e.push(i),e.push('","'),e.push(t.placeholderPrefix),e.push(i),e.push('")<\/script>')}function Cy(t,e){try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){pp(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)e.push(r[n]);n<r.length&&e.push(r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,c=s.id,l=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(r.push(a.startInlineScript),a.sentClientRenderFunction?r.push('$RX("'):(a.sentClientRenderFunction=!0,r.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),c===null)throw Error(Ne(395));if(r.push(c),r.push('"'),l||u||d){r.push(",");var h=gg(l||"");r.push(h)}if(u||d){r.push(",");var f=gg(u||"");r.push(f)}if(d){r.push(",");var p=gg(d);r.push(p)}if(!r.push(")<\/script>")){t.destination=null,o++,i.splice(0,o);return}}i.splice(0,o);var m=t.completedBoundaries;for(o=0;o<m.length;o++)if(!TS(t,e,m[o])){t.destination=null,o++,m.splice(0,o);return}m.splice(0,o);var C=t.partialBoundaries;for(o=0;o<C.length;o++){var g=C[o];e:{i=t,s=e;var y=g.completedSegments;for(a=0;a<y.length;a++)if(!Vk(i,s,g,y[a])){a++,y.splice(0,a);var S=!1;break e}y.splice(0,a),S=!0}if(!S){t.destination=null,o++,C.splice(0,o);return}}C.splice(0,o);var E=t.completedBoundaries;for(o=0;o<E.length;o++)if(!TS(t,e,E[o])){t.destination=null,o++,E.splice(0,o);return}E.splice(0,o)}finally{t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.push(null)}}function uD(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return Bk(r,t,e)}),n.clear(),t.destination!==null&&Cy(t,t.destination)}catch(r){Gu(t,r),mf(t,r)}}function dD(){}function Gk(t,e,n,r){var i=!1,o=null,s="",a={push:function(l){return l!==null&&(s+=l),!0},destroy:function(l){i=!0,o=l}},c=!1;if(t=cD(t,XO(n,e?e.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,dD,void 0,function(){c=!0}),Uk(t),uD(t,r),t.status===1)t.status=2,a.destroy(t.fatalError);else if(t.status!==2&&t.destination===null){t.destination=a;try{Cy(t,a)}catch(l){Gu(t,l),mf(t,l)}}if(i)throw o;if(!c)throw Error(Ne(426));return s}ul.renderToNodeStream=function(){throw Error(Ne(207))};ul.renderToStaticMarkup=function(t,e){return Gk(t,e,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};ul.renderToStaticNodeStream=function(){throw Error(Ne(208))};ul.renderToString=function(t,e){return Gk(t,e,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};ul.version="18.3.1";var Iy={},Wk=b;function De(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gr=null,mr=0;function Ce(t,e){if(e.length!==0)if(512<e.length)0<mr&&(t.enqueue(new Uint8Array(gr.buffer,0,mr)),gr=new Uint8Array(512),mr=0),t.enqueue(e);else{var n=gr.length-mr;n<e.length&&(n===0?t.enqueue(gr):(gr.set(e.subarray(0,n),mr),t.enqueue(gr),e=e.subarray(n)),gr=new Uint8Array(512),mr=0),gr.set(e,mr),mr+=e.length}}function gt(t,e){return Ce(t,e),!0}function xS(t){gr&&0<mr&&(t.enqueue(new Uint8Array(gr.buffer,0,mr)),gr=null,mr=0)}var jk=new TextEncoder;function Be(t){return jk.encode(t)}function ce(t){return jk.encode(t)}function Zk(t,e){typeof t.error=="function"?t.error(e):t.close()}var $n=Object.prototype.hasOwnProperty,hD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,PS={},RS={};function zk(t){return $n.call(RS,t)?!0:$n.call(PS,t)?!1:hD.test(t)?RS[t]=!0:(PS[t]=!0,!1)}function jn(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var fn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){fn[t]=new jn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];fn[e]=new jn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){fn[t]=new jn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){fn[t]=new jn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){fn[t]=new jn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){fn[t]=new jn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){fn[t]=new jn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){fn[t]=new jn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){fn[t]=new jn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Sy=/[\-:]([a-z])/g;function by(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Sy,by);fn[e]=new jn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Sy,by);fn[e]=new jn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Sy,by);fn[e]=new jn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){fn[t]=new jn(t,1,!1,t.toLowerCase(),null,!1,!1)});fn.xlinkHref=new jn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){fn[t]=new jn(t,1,!1,t.toLowerCase(),null,!0,!0)});var Sh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fD=["Webkit","ms","Moz","O"];Object.keys(Sh).forEach(function(t){fD.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Sh[e]=Sh[t]})});var pD=/["'&<>]/;function an(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=pD.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var gD=/([A-Z])/g,mD=/^ms-/,qm=Array.isArray,vD=ce("<script>"),yD=ce("<\/script>"),CD=ce('<script src="'),ID=ce('<script type="module" src="'),NS=ce('" async=""><\/script>'),SD=/(<\/|<)(s)(cript)/gi;function bD(t,e,n,r){return""+e+(n==="s"?"\\u0073":"\\u0053")+r}function wD(t,e,n,r,i){t=t===void 0?"":t,e=e===void 0?vD:ce('<script nonce="'+an(e)+'">');var o=[];if(n!==void 0&&o.push(e,Be((""+n).replace(SD,bD)),yD),r!==void 0)for(n=0;n<r.length;n++)o.push(CD,Be(an(r[n])),NS);if(i!==void 0)for(r=0;r<i.length;r++)o.push(ID,Be(an(i[r])),NS);return{bootstrapChunks:o,startInlineScript:e,placeholderPrefix:ce(t+"P:"),segmentPrefix:ce(t+"S:"),boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function Ei(t,e){return{insertionMode:t,selectedValue:e}}function AD(t){return Ei(t==="http://www.w3.org/2000/svg"?2:t==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function kD(t,e,n){switch(e){case"select":return Ei(1,n.value!=null?n.value:n.defaultValue);case"svg":return Ei(2,null);case"math":return Ei(3,null);case"foreignObject":return Ei(1,null);case"table":return Ei(4,null);case"thead":case"tbody":case"tfoot":return Ei(5,null);case"colgroup":return Ei(7,null);case"tr":return Ei(6,null)}return 4<=t.insertionMode||t.insertionMode===0?Ei(1,null):t}var wy=ce("<!-- -->");function _S(t,e,n,r){return e===""?r:(r&&t.push(wy),t.push(Be(an(e))),!0)}var MS=new Map,ED=ce(' style="'),OS=ce(":"),TD=ce(";");function Hk(t,e,n){if(typeof n!="object")throw Error(De(62));e=!0;for(var r in n)if($n.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=Be(an(r));i=Be(an((""+i).trim()))}else{o=r;var s=MS.get(o);s!==void 0||(s=ce(an(o.replace(gD,"-$1").toLowerCase().replace(mD,"-ms-"))),MS.set(o,s)),o=s,i=typeof i=="number"?i===0||$n.call(Sh,r)?Be(""+i):Be(i+"px"):Be(an((""+i).trim()))}e?(e=!1,t.push(ED,o,OS,i)):t.push(TD,o,OS,i)}}e||t.push(ca)}var hs=ce(" "),oc=ce('="'),ca=ce('"'),DS=ce('=""');function cr(t,e,n,r){switch(n){case"style":Hk(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=fn.hasOwnProperty(n)?fn[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=Be(e.attributeName),e.type){case 3:r&&t.push(hs,n,DS);break;case 4:r===!0?t.push(hs,n,DS):r!==!1&&t.push(hs,n,oc,Be(an(r)),ca);break;case 5:isNaN(r)||t.push(hs,n,oc,Be(an(r)),ca);break;case 6:!isNaN(r)&&1<=r&&t.push(hs,n,oc,Be(an(r)),ca);break;default:e.sanitizeURL&&(r=""+r),t.push(hs,n,oc,Be(an(r)),ca)}}else if(zk(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(hs,Be(n),oc,Be(an(r)),ca)}}}var fs=ce(">"),LS=ce("/>");function bh(t,e,n){if(e!=null){if(n!=null)throw Error(De(60));if(typeof e!="object"||!("__html"in e))throw Error(De(61));e=e.__html,e!=null&&t.push(Be(""+e))}}function xD(t){var e="";return Wk.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}var vg=ce(' selected=""');function yg(t,e,n,r){t.push(Ti(n));var i=n=null,o;for(o in e)if($n.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:cr(t,r,o,s)}}return t.push(fs),bh(t,i,n),typeof n=="string"?(t.push(Be(an(n))),null):n}var Cg=ce(`
`),PD=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,BS=new Map;function Ti(t){var e=BS.get(t);if(e===void 0){if(!PD.test(t))throw Error(De(65,t));e=ce("<"+t),BS.set(t,e)}return e}var RD=ce("<!DOCTYPE html>");function ND(t,e,n,r,i){switch(e){case"select":t.push(Ti("select"));var o=null,s=null;for(u in n)if($n.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:cr(t,r,u,a)}}return t.push(fs),bh(t,s,o),o;case"option":s=i.selectedValue,t.push(Ti("option"));var c=a=null,l=null,u=null;for(o in n)if($n.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":l=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":c=d;default:cr(t,r,o,d)}}if(s!=null)if(n=c!==null?""+c:xD(a),qm(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(vg);break}}else""+s===n&&t.push(vg);else l&&t.push(vg);return t.push(fs),bh(t,u,a),a;case"textarea":t.push(Ti("textarea")),u=s=o=null;for(a in n)if($n.call(n,a)&&(c=n[a],c!=null))switch(a){case"children":u=c;break;case"value":o=c;break;case"defaultValue":s=c;break;case"dangerouslySetInnerHTML":throw Error(De(91));default:cr(t,r,a,c)}if(o===null&&s!==null&&(o=s),t.push(fs),u!=null){if(o!=null)throw Error(De(92));if(qm(u)&&1<u.length)throw Error(De(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(Cg),o!==null&&t.push(Be(an(""+o))),null;case"input":t.push(Ti("input")),c=u=a=o=null;for(s in n)if($n.call(n,s)&&(l=n[s],l!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(De(399,"input"));case"defaultChecked":c=l;break;case"defaultValue":a=l;break;case"checked":u=l;break;case"value":o=l;break;default:cr(t,r,s,l)}return u!==null?cr(t,r,"checked",u):c!==null&&cr(t,r,"checked",c),o!==null?cr(t,r,"value",o):a!==null&&cr(t,r,"value",a),t.push(LS),null;case"menuitem":t.push(Ti("menuitem"));for(var h in n)if($n.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(De(400));default:cr(t,r,h,o)}return t.push(fs),null;case"title":t.push(Ti("title")),o=null;for(d in n)if($n.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(De(434));default:cr(t,r,d,s)}return t.push(fs),o;case"listing":case"pre":t.push(Ti(e)),s=o=null;for(c in n)if($n.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:cr(t,r,c,a)}if(t.push(fs),s!=null){if(o!=null)throw Error(De(60));if(typeof s!="object"||!("__html"in s))throw Error(De(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(Cg,Be(n)):t.push(Be(""+n)))}return typeof o=="string"&&o[0]===`
`&&t.push(Cg),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(Ti(e));for(var f in n)if($n.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(De(399,e));default:cr(t,r,f,o)}return t.push(LS),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return yg(t,n,e,r);case"html":return i.insertionMode===0&&t.push(RD),yg(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return yg(t,n,e,r);t.push(Ti(e)),s=o=null;for(l in n)if($n.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":Hk(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:zk(l)&&typeof a!="function"&&typeof a!="symbol"&&t.push(hs,Be(l),oc,Be(an(a)),ca)}return t.push(fs),bh(t,s,o),o}}var _D=ce("</"),MD=ce(">"),OD=ce('<template id="'),DD=ce('"></template>'),LD=ce("<!--$-->"),BD=ce('<!--$?--><template id="'),FD=ce('"></template>'),UD=ce("<!--$!-->"),VD=ce("<!--/$-->"),GD=ce("<template"),WD=ce('"'),jD=ce(' data-dgst="');ce(' data-msg="');ce(' data-stck="');var ZD=ce("></template>");function FS(t,e,n){if(Ce(t,BD),n===null)throw Error(De(395));return Ce(t,n),gt(t,FD)}var zD=ce('<div hidden id="'),HD=ce('">'),XD=ce("</div>"),$D=ce('<svg aria-hidden="true" style="display:none" id="'),KD=ce('">'),JD=ce("</svg>"),YD=ce('<math aria-hidden="true" style="display:none" id="'),QD=ce('">'),qD=ce("</math>"),e2=ce('<table hidden id="'),t2=ce('">'),n2=ce("</table>"),r2=ce('<table hidden><tbody id="'),i2=ce('">'),o2=ce("</tbody></table>"),s2=ce('<table hidden><tr id="'),a2=ce('">'),c2=ce("</tr></table>"),l2=ce('<table hidden><colgroup id="'),u2=ce('">'),d2=ce("</colgroup></table>");function h2(t,e,n,r){switch(n.insertionMode){case 0:case 1:return Ce(t,zD),Ce(t,e.segmentPrefix),Ce(t,Be(r.toString(16))),gt(t,HD);case 2:return Ce(t,$D),Ce(t,e.segmentPrefix),Ce(t,Be(r.toString(16))),gt(t,KD);case 3:return Ce(t,YD),Ce(t,e.segmentPrefix),Ce(t,Be(r.toString(16))),gt(t,QD);case 4:return Ce(t,e2),Ce(t,e.segmentPrefix),Ce(t,Be(r.toString(16))),gt(t,t2);case 5:return Ce(t,r2),Ce(t,e.segmentPrefix),Ce(t,Be(r.toString(16))),gt(t,i2);case 6:return Ce(t,s2),Ce(t,e.segmentPrefix),Ce(t,Be(r.toString(16))),gt(t,a2);case 7:return Ce(t,l2),Ce(t,e.segmentPrefix),Ce(t,Be(r.toString(16))),gt(t,u2);default:throw Error(De(397))}}function f2(t,e){switch(e.insertionMode){case 0:case 1:return gt(t,XD);case 2:return gt(t,JD);case 3:return gt(t,qD);case 4:return gt(t,n2);case 5:return gt(t,o2);case 6:return gt(t,c2);case 7:return gt(t,d2);default:throw Error(De(397))}}var p2=ce('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),g2=ce('$RS("'),m2=ce('","'),v2=ce('")<\/script>'),y2=ce('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),C2=ce('$RC("'),I2=ce('","'),S2=ce('")<\/script>'),b2=ce('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),w2=ce('$RX("'),A2=ce('"'),k2=ce(")<\/script>"),Ig=ce(","),E2=/[<\u2028\u2029]/g;function Sg(t){return JSON.stringify(t).replace(E2,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var mu=Object.assign,T2=Symbol.for("react.element"),Xk=Symbol.for("react.portal"),$k=Symbol.for("react.fragment"),Kk=Symbol.for("react.strict_mode"),Jk=Symbol.for("react.profiler"),Yk=Symbol.for("react.provider"),Qk=Symbol.for("react.context"),qk=Symbol.for("react.forward_ref"),eE=Symbol.for("react.suspense"),tE=Symbol.for("react.suspense_list"),nE=Symbol.for("react.memo"),Ay=Symbol.for("react.lazy"),x2=Symbol.for("react.scope"),P2=Symbol.for("react.debug_trace_mode"),R2=Symbol.for("react.legacy_hidden"),N2=Symbol.for("react.default_value"),US=Symbol.iterator;function ev(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case $k:return"Fragment";case Xk:return"Portal";case Jk:return"Profiler";case Kk:return"StrictMode";case eE:return"Suspense";case tE:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Qk:return(t.displayName||"Context")+".Consumer";case Yk:return(t._context.displayName||"Context")+".Provider";case qk:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case nE:return e=t.displayName||null,e!==null?e:ev(t.type)||"Memo";case Ay:e=t._payload,t=t._init;try{return ev(t(e))}catch{}}return null}var rE={};function VS(t,e){if(t=t.contextTypes,!t)return rE;var n={},r;for(r in t)n[r]=e[r];return n}var ya=null;function gp(t,e){if(t!==e){t.context._currentValue=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(De(401))}else{if(n===null)throw Error(De(401));gp(t,n)}e.context._currentValue=e.value}}function iE(t){t.context._currentValue=t.parentValue,t=t.parent,t!==null&&iE(t)}function oE(t){var e=t.parent;e!==null&&oE(e),t.context._currentValue=t.value}function sE(t,e){if(t.context._currentValue=t.parentValue,t=t.parent,t===null)throw Error(De(402));t.depth===e.depth?gp(t,e):sE(t,e)}function aE(t,e){var n=e.parent;if(n===null)throw Error(De(402));t.depth===n.depth?gp(t,n):aE(t,n),e.context._currentValue=e.value}function yf(t){var e=ya;e!==t&&(e===null?oE(t):t===null?iE(e):e.depth===t.depth?gp(e,t):e.depth>t.depth?sE(e,t):aE(e,t),ya=t)}var GS={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function WS(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=GS,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:mu({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&GS.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=mu({},o,a)):mu(o,a))}t.state=o}else o.queue=null}var _2={id:1,overflow:""};function tv(t,e,n){var r=t.id;t=t.overflow;var i=32-wh(r)-1;r&=~(1<<i),n+=1;var o=32-wh(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-wh(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var wh=Math.clz32?Math.clz32:D2,M2=Math.log,O2=Math.LN2;function D2(t){return t>>>=0,t===0?32:31-(M2(t)/O2|0)|0}function L2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var B2=typeof Object.is=="function"?Object.is:L2,Jo=null,ky=null,Ah=null,st=null,Yl=!1,Cf=!1,Wu=0,Es=null,mp=0;function la(){if(Jo===null)throw Error(De(321));return Jo}function jS(){if(0<mp)throw Error(De(312));return{memoizedState:null,queue:null,next:null}}function Ey(){return st===null?Ah===null?(Yl=!1,Ah=st=jS()):(Yl=!0,st=Ah):st.next===null?(Yl=!1,st=st.next=jS()):(Yl=!0,st=st.next),st}function Ty(){ky=Jo=null,Cf=!1,Ah=null,mp=0,st=Es=null}function cE(t,e){return typeof e=="function"?e(t):e}function ZS(t,e,n){if(Jo=la(),st=Ey(),Yl){var r=st.queue;if(e=r.dispatch,Es!==null&&(n=Es.get(r),n!==void 0)){Es.delete(r),r=st.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return st.memoizedState=r,[r,e]}return[st.memoizedState,e]}return t=t===cE?typeof e=="function"?e():e:n!==void 0?n(e):e,st.memoizedState=t,t=st.queue={last:null,dispatch:null},t=t.dispatch=F2.bind(null,Jo,t),[st.memoizedState,t]}function zS(t,e){if(Jo=la(),st=Ey(),e=e===void 0?null:e,st!==null){var n=st.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!B2(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),st.memoizedState=[t,e],t}function F2(t,e,n){if(25<=mp)throw Error(De(301));if(t===Jo)if(Cf=!0,t={action:n,next:null},Es===null&&(Es=new Map),n=Es.get(e),n===void 0)Es.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function U2(){throw Error(De(394))}function $d(){}var HS={readContext:function(t){return t._currentValue},useContext:function(t){return la(),t._currentValue},useMemo:zS,useReducer:ZS,useRef:function(t){Jo=la(),st=Ey();var e=st.memoizedState;return e===null?(t={current:t},st.memoizedState=t):e},useState:function(t){return ZS(cE,t)},useInsertionEffect:$d,useLayoutEffect:function(){},useCallback:function(t,e){return zS(function(){return t},e)},useImperativeHandle:$d,useEffect:$d,useDebugValue:$d,useDeferredValue:function(t){return la(),t},useTransition:function(){return la(),[!1,U2]},useId:function(){var t=ky.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-wh(t)-1)).toString(32)+e;var n=kh;if(n===null)throw Error(De(404));return e=Wu++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return la(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(De(407));return n()}},kh=null,bg=Wk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function V2(t){return console.error(t),null}function Ql(){}function G2(t,e,n,r,i,o,s,a,c){var l=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:l,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?V2:i,onAllReady:o===void 0?Ql:o,onShellReady:s===void 0?Ql:s,onShellError:a===void 0?Ql:a,onFatalError:c===void 0?Ql:c},n=If(e,0,null,n,!1,!1),n.parentFlushed=!0,t=xy(e,t,null,n,u,rE,null,_2),l.push(t),e}function xy(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var c={node:e,ping:function(){var l=t.pingedTasks;l.push(c),l.length===1&&dE(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(c),c}function If(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function ju(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function Sf(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,Zk(t.destination,e)):(t.status=1,t.fatalError=e)}function XS(t,e,n,r,i){for(Jo={},ky=e,Wu=0,t=n(r,i);Cf;)Cf=!1,Wu=0,mp+=1,st=null,t=n(r,i);return Ty(),t}function $S(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(De(108,ev(r)||"Unknown",a));r=mu({},s,n)}e.legacyContext=r,vr(t,e,i),e.legacyContext=s}else vr(t,e,i)}function KS(t,e){if(t&&t.defaultProps){e=mu({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function nv(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=VS(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue:i),WS(o,n,r,i),$S(t,e,o,n)}else{o=VS(n,e.legacyContext),i=XS(t,e,n,r,o);var s=Wu!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)WS(i,n,r,o),$S(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=tv(r,1,0);try{vr(t,e,i)}finally{e.treeContext=r}}else vr(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=ND(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=kD(s,n,r),rv(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push(_D,Be(n),MD)}i.lastPushedText=!1}else{switch(n){case R2:case P2:case Kk:case Jk:case $k:vr(t,e,r.children);return;case tE:vr(t,e,r.children);return;case x2:throw Error(De(343));case eE:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},c=If(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(c),i.lastPushedText=!1;var l=If(t,0,null,i.formatContext,!1,!1);l.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=l;try{if(rv(t,e,r),l.lastPushedText&&l.textEmbedded&&l.chunks.push(wy),l.status=1,bf(a,l),a.pendingTasks===0)break e}catch(u){l.status=4,a.forceClientRender=!0,a.errorDigest=ju(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=xy(t,o,n,c,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case qk:if(r=XS(t,e,n.render,r,i),Wu!==0){n=e.treeContext,e.treeContext=tv(n,1,0);try{vr(t,e,r)}finally{e.treeContext=n}}else vr(t,e,r);return;case nE:n=n.type,r=KS(n,r),nv(t,e,n,r,i);return;case Yk:if(i=r.children,n=n._context,r=r.value,o=n._currentValue,n._currentValue=r,s=ya,ya=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,vr(t,e,i),t=ya,t===null)throw Error(De(403));r=t.parentValue,t.context._currentValue=r===N2?t.context._defaultValue:r,t=ya=t.parent,e.context=t;return;case Qk:r=r.children,r=r(n._currentValue),vr(t,e,r);return;case Ay:i=n._init,n=i(n._payload),r=KS(n,r),nv(t,e,n,r,void 0);return}throw Error(De(130,n==null?n:typeof n,""))}}function vr(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case T2:nv(t,e,n.type,n.props,n.ref);return;case Xk:throw Error(De(257));case Ay:var r=n._init;n=r(n._payload),vr(t,e,n);return}if(qm(n)){JS(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=US&&n[US]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);JS(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(De(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=_S(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=_S(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function JS(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=tv(o,r,i);try{rv(t,e,n[i])}finally{e.treeContext=o}}}function rv(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return vr(t,e,n)}catch(c){if(Ty(),typeof c=="object"&&c!==null&&typeof c.then=="function"){n=c;var s=e.blockedSegment,a=If(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=xy(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,yf(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,yf(o),c}}function W2(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,uE(this,e,t)}function lE(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.close())):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(De(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return lE(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function bf(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&bf(t,n)}else t.completedSegments.push(e)}function uE(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(De(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=Ql,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&bf(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(W2,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(bf(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function dE(t){if(t.status!==2){var e=ya,n=bg.current;bg.current=HS;var r=kh;kh=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,c=s.blockedSegment;if(c.status===0){yf(s.context);try{vr(a,s,s.node),c.lastPushedText&&c.textEmbedded&&c.chunks.push(wy),s.abortSet.delete(s),c.status=1,uE(a,s.blockedBoundary,c)}catch(p){if(Ty(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var l=s.ping;p.then(l,l)}else{s.abortSet.delete(s),c.status=4;var u=s.blockedBoundary,d=p,h=ju(a,d);if(u===null?Sf(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=h,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var f=a.onAllReady;f()}}}finally{}}}i.splice(0,o),t.destination!==null&&Py(t,t.destination)}catch(p){ju(t,p),Sf(t,p)}finally{kh=r,bg.current=n,n===HS&&yf(e)}}}function Kd(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,Ce(e,OD),Ce(e,t.placeholderPrefix),t=Be(r.toString(16)),Ce(e,t),gt(e,DD);case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)Ce(e,r[o]);i=vp(t,e,i)}for(;o<r.length-1;o++)Ce(e,r[o]);return o<r.length&&(i=gt(e,r[o])),i;default:throw Error(De(390))}}function vp(t,e,n){var r=n.boundary;if(r===null)return Kd(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)r=r.errorDigest,gt(e,UD),Ce(e,GD),r&&(Ce(e,jD),Ce(e,Be(an(r))),Ce(e,WD)),gt(e,ZD),Kd(t,e,n);else if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;i=ce(i.boundaryPrefix+o.toString(16)),r=r.id=i,FS(e,t.responseState,r),Kd(t,e,n)}else if(r.byteSize>t.progressiveChunkSize)r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),FS(e,t.responseState,r.id),Kd(t,e,n);else{if(gt(e,LD),n=r.completedSegments,n.length!==1)throw Error(De(391));vp(t,e,n[0])}return gt(e,VD)}function YS(t,e,n){return h2(e,t.responseState,n.formatContext,n.id),vp(t,e,n),f2(e,n.formatContext)}function QS(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)hE(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,Ce(e,t.startInlineScript),t.sentCompleteBoundaryFunction?Ce(e,C2):(t.sentCompleteBoundaryFunction=!0,Ce(e,y2)),r===null)throw Error(De(395));return n=Be(n.toString(16)),Ce(e,r),Ce(e,I2),Ce(e,t.segmentPrefix),Ce(e,n),gt(e,S2)}function hE(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(De(392));return YS(t,e,r)}return YS(t,e,r),t=t.responseState,Ce(e,t.startInlineScript),t.sentCompleteSegmentFunction?Ce(e,g2):(t.sentCompleteSegmentFunction=!0,Ce(e,p2)),Ce(e,t.segmentPrefix),i=Be(i.toString(16)),Ce(e,i),Ce(e,m2),Ce(e,t.placeholderPrefix),Ce(e,i),gt(e,v2)}function Py(t,e){gr=new Uint8Array(512),mr=0;try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){vp(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)Ce(e,r[n]);n<r.length&&gt(e,r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,c=s.id,l=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(Ce(r,a.startInlineScript),a.sentClientRenderFunction?Ce(r,w2):(a.sentClientRenderFunction=!0,Ce(r,b2)),c===null)throw Error(De(395));Ce(r,c),Ce(r,A2),(l||u||d)&&(Ce(r,Ig),Ce(r,Be(Sg(l||"")))),(u||d)&&(Ce(r,Ig),Ce(r,Be(Sg(u||"")))),d&&(Ce(r,Ig),Ce(r,Be(Sg(d)))),gt(r,k2)}i.splice(0,o);var h=t.completedBoundaries;for(o=0;o<h.length;o++)QS(t,e,h[o]);h.splice(0,o),xS(e),gr=new Uint8Array(512),mr=0;var f=t.partialBoundaries;for(o=0;o<f.length;o++){var p=f[o];e:{i=t,s=e;var m=p.completedSegments;for(a=0;a<m.length;a++)if(!hE(i,s,p,m[a])){a++,m.splice(0,a);var C=!1;break e}m.splice(0,a),C=!0}if(!C){t.destination=null,o++,f.splice(0,o);return}}f.splice(0,o);var g=t.completedBoundaries;for(o=0;o<g.length;o++)QS(t,e,g[o]);g.splice(0,o)}finally{xS(e),t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.close()}}function qS(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return lE(r,t,e)}),n.clear(),t.destination!==null&&Py(t,t.destination)}catch(r){ju(t,r),Sf(t,r)}}Iy.renderToReadableStream=function(t,e){return new Promise(function(n,r){var i,o,s=new Promise(function(u,d){o=u,i=d}),a=G2(t,wD(e?e.identifierPrefix:void 0,e?e.nonce:void 0,e?e.bootstrapScriptContent:void 0,e?e.bootstrapScripts:void 0,e?e.bootstrapModules:void 0),AD(e?e.namespaceURI:void 0),e?e.progressiveChunkSize:void 0,e?e.onError:void 0,o,function(){var u=new ReadableStream({type:"bytes",pull:function(d){if(a.status===1)a.status=2,Zk(d,a.fatalError);else if(a.status!==2&&a.destination===null){a.destination=d;try{Py(a,d)}catch(h){ju(a,h),Sf(a,h)}}},cancel:function(){qS(a)}},{highWaterMark:0});u.allReady=s,n(u)},function(u){s.catch(function(){}),r(u)},i);if(e&&e.signal){var c=e.signal,l=function(){qS(a,c.reason),c.removeEventListener("abort",l)};c.addEventListener("abort",l)}dE(a)})};Iy.version="18.3.1";var dl,fE;dl=ul,fE=Iy;Za.version=dl.version;Za.renderToString=dl.renderToString;Za.renderToStaticMarkup=dl.renderToStaticMarkup;Za.renderToNodeStream=dl.renderToNodeStream;Za.renderToStaticNodeStream=dl.renderToStaticNodeStream;Za.renderToReadableStream=fE.renderToReadableStream;const ua=class ua extends nt.Component{constructor(n){super(n);U(this,"outputRef",nt.createRef());U(this,"messageKey",0);U(this,"saveOutput",()=>{const n=this.state.output.map(r=>Za.renderToStaticMarkup(r));localStorage.setItem(ua.LOCAL_STORAGE_KEY,JSON.stringify(n))});U(this,"loadOutput",()=>{const n=localStorage.getItem(ua.LOCAL_STORAGE_KEY);return n?JSON.parse(n).map(i=>nt.createElement("div",{dangerouslySetInnerHTML:{__html:i}})):[]});U(this,"addCommand",n=>{this.addToOutput([X.jsx("span",{className:"command","aria-live":"off",children:n})])});U(this,"addError",n=>this.addToOutput([X.jsxs("h2",{children:[" Error: ",n.message]})]));U(this,"handleConnected",()=>this.addToOutput([X.jsx("h2",{children:" Connected"})]));U(this,"handleDisconnected",()=>{this.addToOutput([X.jsx("h2",{children:" Disconnected"})]),this.setState({sidebarVisible:!1})});U(this,"handleUserList",n=>this.setState({sidebarVisible:!!n}));U(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});U(this,"isScrolledToBottom",()=>{const n=this.outputRef.current;return n?n.scrollHeight-n.scrollTop<=n.clientHeight+1:!1});U(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});U(this,"scrollToBottom",()=>{const n=this.outputRef.current;n&&(n.scrollTop=n.scrollHeight)});U(this,"handleMessage",n=>{if(!n)return;const r=PO(n,this.handleExitClick);this.addToOutput(r)});U(this,"handleExitClick",n=>{this.props.client.sendCommand(n)});this.state={output:this.loadOutput(),sidebarVisible:!1,newLinesCount:0}}getSnapshotBeforeUpdate(n,r){if(this.outputRef.current){const i=this.outputRef.current;return i.scrollHeight-i.scrollTop<=i.clientHeight}return null}componentDidUpdate(n,r,i){i&&this.scrollToBottom(),this.state.output.length>r.output.length&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState({newLinesCount:this.state.newLinesCount+(this.state.output.length-r.output.length)})),this.saveOutput()}componentDidMount(){const{client:n}=this.props;n.on("message",this.handleMessage),n.on("connect",this.handleConnected),n.on("disconnect",this.handleDisconnected),n.on("error",this.addError),n.on("command",this.addCommand),n.on("userlist",this.handleUserList)}componentWillUnmount(){const{client:n}=this.props;n.removeListener("message",this.handleMessage),n.removeListener("connect",this.handleConnected),n.removeListener("disconnect",this.handleDisconnected),n.removeListener("error",this.addError),n.removeListener("command",this.addCommand),n.removeListener("userlist",this.handleUserList)}addToOutput(n){this.setState(r=>{const i=n.map((a,c)=>X.jsx("div",{children:a},this.messageKey+c));return this.messageKey+=n.length,{output:[...r.output,...i].slice(-ua.MAX_OUTPUT_LENGTH)}})}saveLog(){const n=this.outputRef.current;if(n){const r=n.innerHTML,i=new Blob([r],{type:"text/html"}),o=URL.createObjectURL(i),s=document.createElement("a"),a=new Date,c=a.toLocaleDateString(),l=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=`${document.title.replace(/\s+/g,"-")}-log-${c}-${l}.html`;s.download=d,s.href=o,s.click(),URL.revokeObjectURL(o),s.remove()}}clearLog(){this.setState({output:[]})}render(){var n="output";this.state.sidebarVisible&&(n+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return X.jsxs("div",{ref:this.outputRef,className:n,onScroll:this.handleScroll,"aria-live":"polite",role:"log",children:[this.state.output,this.state.newLinesCount>0&&X.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};U(ua,"MAX_OUTPUT_LENGTH",5e3),U(ua,"LOCAL_STORAGE_KEY","outputLog");let iv=ua;var pE={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function o(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new i(u,d||c,h),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],f]:c._events[p].push(f):(c._events[p]=f,c._eventsCount++),c}function s(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,h,f,p){var m=n?n+l:l;if(!this._events[m])return!1;var C=this._events[m],g=arguments.length,y,S;if(C.fn){switch(C.once&&this.removeListener(l,C.fn,void 0,!0),g){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,u),!0;case 3:return C.fn.call(C.context,u,d),!0;case 4:return C.fn.call(C.context,u,d,h),!0;case 5:return C.fn.call(C.context,u,d,h,f),!0;case 6:return C.fn.call(C.context,u,d,h,f,p),!0}for(S=1,y=new Array(g-1);S<g;S++)y[S-1]=arguments[S];C.fn.apply(C.context,y)}else{var E=C.length,A;for(S=0;S<E;S++)switch(C[S].once&&this.removeListener(l,C[S].fn,void 0,!0),g){case 1:C[S].fn.call(C[S].context);break;case 2:C[S].fn.call(C[S].context,u);break;case 3:C[S].fn.call(C[S].context,u,d);break;case 4:C[S].fn.call(C[S].context,u,d,h);break;default:if(!y)for(A=1,y=new Array(g-1);A<g;A++)y[A-1]=arguments[A];C[S].fn.apply(C[S].context,y)}}return!0},a.prototype.on=function(l,u,d){return o(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return o(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,h){var f=n?n+l:l;if(!this._events[f])return this;if(!u)return s(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&s(this,f);else{for(var m=0,C=[],g=p.length;m<g;m++)(p[m].fn!==u||h&&!p[m].once||d&&p[m].context!==d)&&C.push(p[m]);C.length?this._events[f]=C.length===1?C[0]:C:s(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&s(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(pE);var j2=pE.exports;const gE=od(j2);var nn={},yp={};yp.byteLength=H2;yp.toByteArray=$2;yp.fromByteArray=Y2;var Ni=[],Nr=[],Z2=typeof Uint8Array<"u"?Uint8Array:Array,wg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var tc=0,z2=wg.length;tc<z2;++tc)Ni[tc]=wg[tc],Nr[wg.charCodeAt(tc)]=tc;Nr[45]=62;Nr[95]=63;function mE(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function H2(t){var e=mE(t),n=e[0],r=e[1];return(n+r)*3/4-r}function X2(t,e,n){return(e+n)*3/4-n}function $2(t){var e,n=mE(t),r=n[0],i=n[1],o=new Z2(X2(t,r,i)),s=0,a=i>0?r-4:r,c;for(c=0;c<a;c+=4)e=Nr[t.charCodeAt(c)]<<18|Nr[t.charCodeAt(c+1)]<<12|Nr[t.charCodeAt(c+2)]<<6|Nr[t.charCodeAt(c+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=Nr[t.charCodeAt(c)]<<2|Nr[t.charCodeAt(c+1)]>>4,o[s++]=e&255),i===1&&(e=Nr[t.charCodeAt(c)]<<10|Nr[t.charCodeAt(c+1)]<<4|Nr[t.charCodeAt(c+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function K2(t){return Ni[t>>18&63]+Ni[t>>12&63]+Ni[t>>6&63]+Ni[t&63]}function J2(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(K2(r));return i.join("")}function Y2(t){for(var e,n=t.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(J2(t,s,s+o>a?a:s+o));return r===1?(e=t[n-1],i.push(Ni[e>>2]+Ni[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(Ni[e>>10]+Ni[e>>4&63]+Ni[e<<2&63]+"=")),i.join("")}var Ry={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Ry.read=function(t,e,n,r,i){var o,s,a=i*8-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?i-1:0,h=n?-1:1,f=t[e+d];for(d+=h,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=o*256+t[e+d],d+=h,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=s*256+t[e+d],d+=h,u-=8);if(o===0)o=1-l;else{if(o===c)return s?NaN:(f?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-l}return(f?-1:1)*s*Math.pow(2,o-r)};Ry.write=function(t,e,n,r,i,o){var s,a,c,l=o*8-i-1,u=(1<<l)-1,d=u>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),s+d>=1?e+=h/c:e+=h*Math.pow(2,1-d),e*c>=2&&(s++,c/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(e*c-1)*Math.pow(2,i),s=s+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;t[n+f]=a&255,f+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;t[n+f]=s&255,f+=p,s/=256,l-=8);t[n+f-p]|=m*128};(function(t){const e=yp,n=Ry,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=y,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const k=new Uint8Array(1),v={foo:function(){return 42}};return Object.setPrototypeOf(v,Uint8Array.prototype),Object.setPrototypeOf(k,v),k.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(k){if(k>i)throw new RangeError('The value "'+k+'" is invalid for option "size"');const v=new Uint8Array(k);return Object.setPrototypeOf(v,a.prototype),v}function a(k,v,I){if(typeof k=="number"){if(typeof v=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(k)}return c(k,v,I)}a.poolSize=8192;function c(k,v,I){if(typeof k=="string")return h(k,v);if(ArrayBuffer.isView(k))return p(k);if(k==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k);if(ut(k,ArrayBuffer)||k&&ut(k.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ut(k,SharedArrayBuffer)||k&&ut(k.buffer,SharedArrayBuffer)))return m(k,v,I);if(typeof k=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const R=k.valueOf&&k.valueOf();if(R!=null&&R!==k)return a.from(R,v,I);const O=C(k);if(O)return O;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof k[Symbol.toPrimitive]=="function")return a.from(k[Symbol.toPrimitive]("string"),v,I);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k)}a.from=function(k,v,I){return c(k,v,I)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(k){if(typeof k!="number")throw new TypeError('"size" argument must be of type number');if(k<0)throw new RangeError('The value "'+k+'" is invalid for option "size"')}function u(k,v,I){return l(k),k<=0?s(k):v!==void 0?typeof I=="string"?s(k).fill(v,I):s(k).fill(v):s(k)}a.alloc=function(k,v,I){return u(k,v,I)};function d(k){return l(k),s(k<0?0:g(k)|0)}a.allocUnsafe=function(k){return d(k)},a.allocUnsafeSlow=function(k){return d(k)};function h(k,v){if((typeof v!="string"||v==="")&&(v="utf8"),!a.isEncoding(v))throw new TypeError("Unknown encoding: "+v);const I=S(k,v)|0;let R=s(I);const O=R.write(k,v);return O!==I&&(R=R.slice(0,O)),R}function f(k){const v=k.length<0?0:g(k.length)|0,I=s(v);for(let R=0;R<v;R+=1)I[R]=k[R]&255;return I}function p(k){if(ut(k,Uint8Array)){const v=new Uint8Array(k);return m(v.buffer,v.byteOffset,v.byteLength)}return f(k)}function m(k,v,I){if(v<0||k.byteLength<v)throw new RangeError('"offset" is outside of buffer bounds');if(k.byteLength<v+(I||0))throw new RangeError('"length" is outside of buffer bounds');let R;return v===void 0&&I===void 0?R=new Uint8Array(k):I===void 0?R=new Uint8Array(k,v):R=new Uint8Array(k,v,I),Object.setPrototypeOf(R,a.prototype),R}function C(k){if(a.isBuffer(k)){const v=g(k.length)|0,I=s(v);return I.length===0||k.copy(I,0,0,v),I}if(k.length!==void 0)return typeof k.length!="number"||xn(k.length)?s(0):f(k);if(k.type==="Buffer"&&Array.isArray(k.data))return f(k.data)}function g(k){if(k>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return k|0}function y(k){return+k!=k&&(k=0),a.alloc(+k)}a.isBuffer=function(v){return v!=null&&v._isBuffer===!0&&v!==a.prototype},a.compare=function(v,I){if(ut(v,Uint8Array)&&(v=a.from(v,v.offset,v.byteLength)),ut(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),!a.isBuffer(v)||!a.isBuffer(I))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(v===I)return 0;let R=v.length,O=I.length;for(let V=0,J=Math.min(R,O);V<J;++V)if(v[V]!==I[V]){R=v[V],O=I[V];break}return R<O?-1:O<R?1:0},a.isEncoding=function(v){switch(String(v).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(v,I){if(!Array.isArray(v))throw new TypeError('"list" argument must be an Array of Buffers');if(v.length===0)return a.alloc(0);let R;if(I===void 0)for(I=0,R=0;R<v.length;++R)I+=v[R].length;const O=a.allocUnsafe(I);let V=0;for(R=0;R<v.length;++R){let J=v[R];if(ut(J,Uint8Array))V+J.length>O.length?(a.isBuffer(J)||(J=a.from(J)),J.copy(O,V)):Uint8Array.prototype.set.call(O,J,V);else if(a.isBuffer(J))J.copy(O,V);else throw new TypeError('"list" argument must be an Array of Buffers');V+=J.length}return O};function S(k,v){if(a.isBuffer(k))return k.length;if(ArrayBuffer.isView(k)||ut(k,ArrayBuffer))return k.byteLength;if(typeof k!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof k);const I=k.length,R=arguments.length>2&&arguments[2]===!0;if(!R&&I===0)return 0;let O=!1;for(;;)switch(v){case"ascii":case"latin1":case"binary":return I;case"utf8":case"utf-8":return ze(k).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I*2;case"hex":return I>>>1;case"base64":return $e(k).length;default:if(O)return R?-1:ze(k).length;v=(""+v).toLowerCase(),O=!0}}a.byteLength=S;function E(k,v,I){let R=!1;if((v===void 0||v<0)&&(v=0),v>this.length||((I===void 0||I>this.length)&&(I=this.length),I<=0)||(I>>>=0,v>>>=0,I<=v))return"";for(k||(k="utf8");;)switch(k){case"hex":return Y(this,v,I);case"utf8":case"utf-8":return Z(this,v,I);case"ascii":return oe(this,v,I);case"latin1":case"binary":return W(this,v,I);case"base64":return j(this,v,I);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,v,I);default:if(R)throw new TypeError("Unknown encoding: "+k);k=(k+"").toLowerCase(),R=!0}}a.prototype._isBuffer=!0;function A(k,v,I){const R=k[v];k[v]=k[I],k[I]=R}a.prototype.swap16=function(){const v=this.length;if(v%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let I=0;I<v;I+=2)A(this,I,I+1);return this},a.prototype.swap32=function(){const v=this.length;if(v%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let I=0;I<v;I+=4)A(this,I,I+3),A(this,I+1,I+2);return this},a.prototype.swap64=function(){const v=this.length;if(v%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let I=0;I<v;I+=8)A(this,I,I+7),A(this,I+1,I+6),A(this,I+2,I+5),A(this,I+3,I+4);return this},a.prototype.toString=function(){const v=this.length;return v===0?"":arguments.length===0?Z(this,0,v):E.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(v){if(!a.isBuffer(v))throw new TypeError("Argument must be a Buffer");return this===v?!0:a.compare(this,v)===0},a.prototype.inspect=function(){let v="";const I=t.INSPECT_MAX_BYTES;return v=this.toString("hex",0,I).replace(/(.{2})/g,"$1 ").trim(),this.length>I&&(v+=" ... "),"<Buffer "+v+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(v,I,R,O,V){if(ut(v,Uint8Array)&&(v=a.from(v,v.offset,v.byteLength)),!a.isBuffer(v))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof v);if(I===void 0&&(I=0),R===void 0&&(R=v?v.length:0),O===void 0&&(O=0),V===void 0&&(V=this.length),I<0||R>v.length||O<0||V>this.length)throw new RangeError("out of range index");if(O>=V&&I>=R)return 0;if(O>=V)return-1;if(I>=R)return 1;if(I>>>=0,R>>>=0,O>>>=0,V>>>=0,this===v)return 0;let J=V-O,Oe=R-I;const yt=Math.min(J,Oe),et=this.slice(O,V),tt=v.slice(I,R);for(let Ke=0;Ke<yt;++Ke)if(et[Ke]!==tt[Ke]){J=et[Ke],Oe=tt[Ke];break}return J<Oe?-1:Oe<J?1:0};function P(k,v,I,R,O){if(k.length===0)return-1;if(typeof I=="string"?(R=I,I=0):I>2147483647?I=2147483647:I<-2147483648&&(I=-2147483648),I=+I,xn(I)&&(I=O?0:k.length-1),I<0&&(I=k.length+I),I>=k.length){if(O)return-1;I=k.length-1}else if(I<0)if(O)I=0;else return-1;if(typeof v=="string"&&(v=a.from(v,R)),a.isBuffer(v))return v.length===0?-1:w(k,v,I,R,O);if(typeof v=="number")return v=v&255,typeof Uint8Array.prototype.indexOf=="function"?O?Uint8Array.prototype.indexOf.call(k,v,I):Uint8Array.prototype.lastIndexOf.call(k,v,I):w(k,[v],I,R,O);throw new TypeError("val must be string, number or Buffer")}function w(k,v,I,R,O){let V=1,J=k.length,Oe=v.length;if(R!==void 0&&(R=String(R).toLowerCase(),R==="ucs2"||R==="ucs-2"||R==="utf16le"||R==="utf-16le")){if(k.length<2||v.length<2)return-1;V=2,J/=2,Oe/=2,I/=2}function yt(tt,Ke){return V===1?tt[Ke]:tt.readUInt16BE(Ke*V)}let et;if(O){let tt=-1;for(et=I;et<J;et++)if(yt(k,et)===yt(v,tt===-1?0:et-tt)){if(tt===-1&&(tt=et),et-tt+1===Oe)return tt*V}else tt!==-1&&(et-=et-tt),tt=-1}else for(I+Oe>J&&(I=J-Oe),et=I;et>=0;et--){let tt=!0;for(let Ke=0;Ke<Oe;Ke++)if(yt(k,et+Ke)!==yt(v,Ke)){tt=!1;break}if(tt)return et}return-1}a.prototype.includes=function(v,I,R){return this.indexOf(v,I,R)!==-1},a.prototype.indexOf=function(v,I,R){return P(this,v,I,R,!0)},a.prototype.lastIndexOf=function(v,I,R){return P(this,v,I,R,!1)};function T(k,v,I,R){I=Number(I)||0;const O=k.length-I;R?(R=Number(R),R>O&&(R=O)):R=O;const V=v.length;R>V/2&&(R=V/2);let J;for(J=0;J<R;++J){const Oe=parseInt(v.substr(J*2,2),16);if(xn(Oe))return J;k[I+J]=Oe}return J}function _(k,v,I,R){return Bt(ze(v,k.length-I),k,I,R)}function M(k,v,I,R){return Bt(Ve(v),k,I,R)}function D(k,v,I,R){return Bt($e(v),k,I,R)}function B(k,v,I,R){return Bt(Pe(v,k.length-I),k,I,R)}a.prototype.write=function(v,I,R,O){if(I===void 0)O="utf8",R=this.length,I=0;else if(R===void 0&&typeof I=="string")O=I,R=this.length,I=0;else if(isFinite(I))I=I>>>0,isFinite(R)?(R=R>>>0,O===void 0&&(O="utf8")):(O=R,R=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const V=this.length-I;if((R===void 0||R>V)&&(R=V),v.length>0&&(R<0||I<0)||I>this.length)throw new RangeError("Attempt to write outside buffer bounds");O||(O="utf8");let J=!1;for(;;)switch(O){case"hex":return T(this,v,I,R);case"utf8":case"utf-8":return _(this,v,I,R);case"ascii":case"latin1":case"binary":return M(this,v,I,R);case"base64":return D(this,v,I,R);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,v,I,R);default:if(J)throw new TypeError("Unknown encoding: "+O);O=(""+O).toLowerCase(),J=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function j(k,v,I){return v===0&&I===k.length?e.fromByteArray(k):e.fromByteArray(k.slice(v,I))}function Z(k,v,I){I=Math.min(k.length,I);const R=[];let O=v;for(;O<I;){const V=k[O];let J=null,Oe=V>239?4:V>223?3:V>191?2:1;if(O+Oe<=I){let yt,et,tt,Ke;switch(Oe){case 1:V<128&&(J=V);break;case 2:yt=k[O+1],(yt&192)===128&&(Ke=(V&31)<<6|yt&63,Ke>127&&(J=Ke));break;case 3:yt=k[O+1],et=k[O+2],(yt&192)===128&&(et&192)===128&&(Ke=(V&15)<<12|(yt&63)<<6|et&63,Ke>2047&&(Ke<55296||Ke>57343)&&(J=Ke));break;case 4:yt=k[O+1],et=k[O+2],tt=k[O+3],(yt&192)===128&&(et&192)===128&&(tt&192)===128&&(Ke=(V&15)<<18|(yt&63)<<12|(et&63)<<6|tt&63,Ke>65535&&Ke<1114112&&(J=Ke))}}J===null?(J=65533,Oe=1):J>65535&&(J-=65536,R.push(J>>>10&1023|55296),J=56320|J&1023),R.push(J),O+=Oe}return q(R)}const z=4096;function q(k){const v=k.length;if(v<=z)return String.fromCharCode.apply(String,k);let I="",R=0;for(;R<v;)I+=String.fromCharCode.apply(String,k.slice(R,R+=z));return I}function oe(k,v,I){let R="";I=Math.min(k.length,I);for(let O=v;O<I;++O)R+=String.fromCharCode(k[O]&127);return R}function W(k,v,I){let R="";I=Math.min(k.length,I);for(let O=v;O<I;++O)R+=String.fromCharCode(k[O]);return R}function Y(k,v,I){const R=k.length;(!v||v<0)&&(v=0),(!I||I<0||I>R)&&(I=R);let O="";for(let V=v;V<I;++V)O+=os[k[V]];return O}function re(k,v,I){const R=k.slice(v,I);let O="";for(let V=0;V<R.length-1;V+=2)O+=String.fromCharCode(R[V]+R[V+1]*256);return O}a.prototype.slice=function(v,I){const R=this.length;v=~~v,I=I===void 0?R:~~I,v<0?(v+=R,v<0&&(v=0)):v>R&&(v=R),I<0?(I+=R,I<0&&(I=0)):I>R&&(I=R),I<v&&(I=v);const O=this.subarray(v,I);return Object.setPrototypeOf(O,a.prototype),O};function H(k,v,I){if(k%1!==0||k<0)throw new RangeError("offset is not uint");if(k+v>I)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(v,I,R){v=v>>>0,I=I>>>0,R||H(v,I,this.length);let O=this[v],V=1,J=0;for(;++J<I&&(V*=256);)O+=this[v+J]*V;return O},a.prototype.readUintBE=a.prototype.readUIntBE=function(v,I,R){v=v>>>0,I=I>>>0,R||H(v,I,this.length);let O=this[v+--I],V=1;for(;I>0&&(V*=256);)O+=this[v+--I]*V;return O},a.prototype.readUint8=a.prototype.readUInt8=function(v,I){return v=v>>>0,I||H(v,1,this.length),this[v]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(v,I){return v=v>>>0,I||H(v,2,this.length),this[v]|this[v+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(v,I){return v=v>>>0,I||H(v,2,this.length),this[v]<<8|this[v+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(v,I){return v=v>>>0,I||H(v,4,this.length),(this[v]|this[v+1]<<8|this[v+2]<<16)+this[v+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(v,I){return v=v>>>0,I||H(v,4,this.length),this[v]*16777216+(this[v+1]<<16|this[v+2]<<8|this[v+3])},a.prototype.readBigUInt64LE=Hn(function(v){v=v>>>0,vn(v,"offset");const I=this[v],R=this[v+7];(I===void 0||R===void 0)&&xr(v,this.length-8);const O=I+this[++v]*2**8+this[++v]*2**16+this[++v]*2**24,V=this[++v]+this[++v]*2**8+this[++v]*2**16+R*2**24;return BigInt(O)+(BigInt(V)<<BigInt(32))}),a.prototype.readBigUInt64BE=Hn(function(v){v=v>>>0,vn(v,"offset");const I=this[v],R=this[v+7];(I===void 0||R===void 0)&&xr(v,this.length-8);const O=I*2**24+this[++v]*2**16+this[++v]*2**8+this[++v],V=this[++v]*2**24+this[++v]*2**16+this[++v]*2**8+R;return(BigInt(O)<<BigInt(32))+BigInt(V)}),a.prototype.readIntLE=function(v,I,R){v=v>>>0,I=I>>>0,R||H(v,I,this.length);let O=this[v],V=1,J=0;for(;++J<I&&(V*=256);)O+=this[v+J]*V;return V*=128,O>=V&&(O-=Math.pow(2,8*I)),O},a.prototype.readIntBE=function(v,I,R){v=v>>>0,I=I>>>0,R||H(v,I,this.length);let O=I,V=1,J=this[v+--O];for(;O>0&&(V*=256);)J+=this[v+--O]*V;return V*=128,J>=V&&(J-=Math.pow(2,8*I)),J},a.prototype.readInt8=function(v,I){return v=v>>>0,I||H(v,1,this.length),this[v]&128?(255-this[v]+1)*-1:this[v]},a.prototype.readInt16LE=function(v,I){v=v>>>0,I||H(v,2,this.length);const R=this[v]|this[v+1]<<8;return R&32768?R|4294901760:R},a.prototype.readInt16BE=function(v,I){v=v>>>0,I||H(v,2,this.length);const R=this[v+1]|this[v]<<8;return R&32768?R|4294901760:R},a.prototype.readInt32LE=function(v,I){return v=v>>>0,I||H(v,4,this.length),this[v]|this[v+1]<<8|this[v+2]<<16|this[v+3]<<24},a.prototype.readInt32BE=function(v,I){return v=v>>>0,I||H(v,4,this.length),this[v]<<24|this[v+1]<<16|this[v+2]<<8|this[v+3]},a.prototype.readBigInt64LE=Hn(function(v){v=v>>>0,vn(v,"offset");const I=this[v],R=this[v+7];(I===void 0||R===void 0)&&xr(v,this.length-8);const O=this[v+4]+this[v+5]*2**8+this[v+6]*2**16+(R<<24);return(BigInt(O)<<BigInt(32))+BigInt(I+this[++v]*2**8+this[++v]*2**16+this[++v]*2**24)}),a.prototype.readBigInt64BE=Hn(function(v){v=v>>>0,vn(v,"offset");const I=this[v],R=this[v+7];(I===void 0||R===void 0)&&xr(v,this.length-8);const O=(I<<24)+this[++v]*2**16+this[++v]*2**8+this[++v];return(BigInt(O)<<BigInt(32))+BigInt(this[++v]*2**24+this[++v]*2**16+this[++v]*2**8+R)}),a.prototype.readFloatLE=function(v,I){return v=v>>>0,I||H(v,4,this.length),n.read(this,v,!0,23,4)},a.prototype.readFloatBE=function(v,I){return v=v>>>0,I||H(v,4,this.length),n.read(this,v,!1,23,4)},a.prototype.readDoubleLE=function(v,I){return v=v>>>0,I||H(v,8,this.length),n.read(this,v,!0,52,8)},a.prototype.readDoubleBE=function(v,I){return v=v>>>0,I||H(v,8,this.length),n.read(this,v,!1,52,8)};function te(k,v,I,R,O,V){if(!a.isBuffer(k))throw new TypeError('"buffer" argument must be a Buffer instance');if(v>O||v<V)throw new RangeError('"value" argument is out of bounds');if(I+R>k.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(v,I,R,O){if(v=+v,I=I>>>0,R=R>>>0,!O){const Oe=Math.pow(2,8*R)-1;te(this,v,I,R,Oe,0)}let V=1,J=0;for(this[I]=v&255;++J<R&&(V*=256);)this[I+J]=v/V&255;return I+R},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(v,I,R,O){if(v=+v,I=I>>>0,R=R>>>0,!O){const Oe=Math.pow(2,8*R)-1;te(this,v,I,R,Oe,0)}let V=R-1,J=1;for(this[I+V]=v&255;--V>=0&&(J*=256);)this[I+V]=v/J&255;return I+R},a.prototype.writeUint8=a.prototype.writeUInt8=function(v,I,R){return v=+v,I=I>>>0,R||te(this,v,I,1,255,0),this[I]=v&255,I+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(v,I,R){return v=+v,I=I>>>0,R||te(this,v,I,2,65535,0),this[I]=v&255,this[I+1]=v>>>8,I+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(v,I,R){return v=+v,I=I>>>0,R||te(this,v,I,2,65535,0),this[I]=v>>>8,this[I+1]=v&255,I+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(v,I,R){return v=+v,I=I>>>0,R||te(this,v,I,4,4294967295,0),this[I+3]=v>>>24,this[I+2]=v>>>16,this[I+1]=v>>>8,this[I]=v&255,I+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(v,I,R){return v=+v,I=I>>>0,R||te(this,v,I,4,4294967295,0),this[I]=v>>>24,this[I+1]=v>>>16,this[I+2]=v>>>8,this[I+3]=v&255,I+4};function Ee(k,v,I,R,O){it(v,R,O,k,I,7);let V=Number(v&BigInt(4294967295));k[I++]=V,V=V>>8,k[I++]=V,V=V>>8,k[I++]=V,V=V>>8,k[I++]=V;let J=Number(v>>BigInt(32)&BigInt(4294967295));return k[I++]=J,J=J>>8,k[I++]=J,J=J>>8,k[I++]=J,J=J>>8,k[I++]=J,I}function Le(k,v,I,R,O){it(v,R,O,k,I,7);let V=Number(v&BigInt(4294967295));k[I+7]=V,V=V>>8,k[I+6]=V,V=V>>8,k[I+5]=V,V=V>>8,k[I+4]=V;let J=Number(v>>BigInt(32)&BigInt(4294967295));return k[I+3]=J,J=J>>8,k[I+2]=J,J=J>>8,k[I+1]=J,J=J>>8,k[I]=J,I+8}a.prototype.writeBigUInt64LE=Hn(function(v,I=0){return Ee(this,v,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Hn(function(v,I=0){return Le(this,v,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(v,I,R,O){if(v=+v,I=I>>>0,!O){const yt=Math.pow(2,8*R-1);te(this,v,I,R,yt-1,-yt)}let V=0,J=1,Oe=0;for(this[I]=v&255;++V<R&&(J*=256);)v<0&&Oe===0&&this[I+V-1]!==0&&(Oe=1),this[I+V]=(v/J>>0)-Oe&255;return I+R},a.prototype.writeIntBE=function(v,I,R,O){if(v=+v,I=I>>>0,!O){const yt=Math.pow(2,8*R-1);te(this,v,I,R,yt-1,-yt)}let V=R-1,J=1,Oe=0;for(this[I+V]=v&255;--V>=0&&(J*=256);)v<0&&Oe===0&&this[I+V+1]!==0&&(Oe=1),this[I+V]=(v/J>>0)-Oe&255;return I+R},a.prototype.writeInt8=function(v,I,R){return v=+v,I=I>>>0,R||te(this,v,I,1,127,-128),v<0&&(v=255+v+1),this[I]=v&255,I+1},a.prototype.writeInt16LE=function(v,I,R){return v=+v,I=I>>>0,R||te(this,v,I,2,32767,-32768),this[I]=v&255,this[I+1]=v>>>8,I+2},a.prototype.writeInt16BE=function(v,I,R){return v=+v,I=I>>>0,R||te(this,v,I,2,32767,-32768),this[I]=v>>>8,this[I+1]=v&255,I+2},a.prototype.writeInt32LE=function(v,I,R){return v=+v,I=I>>>0,R||te(this,v,I,4,2147483647,-2147483648),this[I]=v&255,this[I+1]=v>>>8,this[I+2]=v>>>16,this[I+3]=v>>>24,I+4},a.prototype.writeInt32BE=function(v,I,R){return v=+v,I=I>>>0,R||te(this,v,I,4,2147483647,-2147483648),v<0&&(v=4294967295+v+1),this[I]=v>>>24,this[I+1]=v>>>16,this[I+2]=v>>>8,this[I+3]=v&255,I+4},a.prototype.writeBigInt64LE=Hn(function(v,I=0){return Ee(this,v,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Hn(function(v,I=0){return Le(this,v,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ve(k,v,I,R,O,V){if(I+R>k.length)throw new RangeError("Index out of range");if(I<0)throw new RangeError("Index out of range")}function ke(k,v,I,R,O){return v=+v,I=I>>>0,O||ve(k,v,I,4),n.write(k,v,I,R,23,4),I+4}a.prototype.writeFloatLE=function(v,I,R){return ke(this,v,I,!0,R)},a.prototype.writeFloatBE=function(v,I,R){return ke(this,v,I,!1,R)};function je(k,v,I,R,O){return v=+v,I=I>>>0,O||ve(k,v,I,8),n.write(k,v,I,R,52,8),I+8}a.prototype.writeDoubleLE=function(v,I,R){return je(this,v,I,!0,R)},a.prototype.writeDoubleBE=function(v,I,R){return je(this,v,I,!1,R)},a.prototype.copy=function(v,I,R,O){if(!a.isBuffer(v))throw new TypeError("argument should be a Buffer");if(R||(R=0),!O&&O!==0&&(O=this.length),I>=v.length&&(I=v.length),I||(I=0),O>0&&O<R&&(O=R),O===R||v.length===0||this.length===0)return 0;if(I<0)throw new RangeError("targetStart out of bounds");if(R<0||R>=this.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("sourceEnd out of bounds");O>this.length&&(O=this.length),v.length-I<O-R&&(O=v.length-I+R);const V=O-R;return this===v&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(I,R,O):Uint8Array.prototype.set.call(v,this.subarray(R,O),I),V},a.prototype.fill=function(v,I,R,O){if(typeof v=="string"){if(typeof I=="string"?(O=I,I=0,R=this.length):typeof R=="string"&&(O=R,R=this.length),O!==void 0&&typeof O!="string")throw new TypeError("encoding must be a string");if(typeof O=="string"&&!a.isEncoding(O))throw new TypeError("Unknown encoding: "+O);if(v.length===1){const J=v.charCodeAt(0);(O==="utf8"&&J<128||O==="latin1")&&(v=J)}}else typeof v=="number"?v=v&255:typeof v=="boolean"&&(v=Number(v));if(I<0||this.length<I||this.length<R)throw new RangeError("Out of range index");if(R<=I)return this;I=I>>>0,R=R===void 0?this.length:R>>>0,v||(v=0);let V;if(typeof v=="number")for(V=I;V<R;++V)this[V]=v;else{const J=a.isBuffer(v)?v:a.from(v,O),Oe=J.length;if(Oe===0)throw new TypeError('The value "'+v+'" is invalid for argument "value"');for(V=0;V<R-I;++V)this[V+I]=J[V%Oe]}return this};const he={};function Tn(k,v,I){he[k]=class extends I{constructor(){super(),Object.defineProperty(this,"message",{value:v.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${k}]`,this.stack,delete this.name}get code(){return k}set code(O){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:O,writable:!0})}toString(){return`${this.name} [${k}]: ${this.message}`}}}Tn("ERR_BUFFER_OUT_OF_BOUNDS",function(k){return k?`${k} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Tn("ERR_INVALID_ARG_TYPE",function(k,v){return`The "${k}" argument must be of type number. Received type ${typeof v}`},TypeError),Tn("ERR_OUT_OF_RANGE",function(k,v,I){let R=`The value of "${k}" is out of range.`,O=I;return Number.isInteger(I)&&Math.abs(I)>2**32?O=zn(String(I)):typeof I=="bigint"&&(O=String(I),(I>BigInt(2)**BigInt(32)||I<-(BigInt(2)**BigInt(32)))&&(O=zn(O)),O+="n"),R+=` It must be ${v}. Received ${O}`,R},RangeError);function zn(k){let v="",I=k.length;const R=k[0]==="-"?1:0;for(;I>=R+4;I-=3)v=`_${k.slice(I-3,I)}${v}`;return`${k.slice(0,I)}${v}`}function Tr(k,v,I){vn(v,"offset"),(k[v]===void 0||k[v+I]===void 0)&&xr(v,k.length-(I+1))}function it(k,v,I,R,O,V){if(k>I||k<v){const J=typeof v=="bigint"?"n":"";let Oe;throw v===0||v===BigInt(0)?Oe=`>= 0${J} and < 2${J} ** ${(V+1)*8}${J}`:Oe=`>= -(2${J} ** ${(V+1)*8-1}${J}) and < 2 ** ${(V+1)*8-1}${J}`,new he.ERR_OUT_OF_RANGE("value",Oe,k)}Tr(R,O,V)}function vn(k,v){if(typeof k!="number")throw new he.ERR_INVALID_ARG_TYPE(v,"number",k)}function xr(k,v,I){throw Math.floor(k)!==k?(vn(k,I),new he.ERR_OUT_OF_RANGE("offset","an integer",k)):v<0?new he.ERR_BUFFER_OUT_OF_BOUNDS:new he.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${v}`,k)}const ae=/[^+/0-9A-Za-z-_]/g;function ue(k){if(k=k.split("=")[0],k=k.trim().replace(ae,""),k.length<2)return"";for(;k.length%4!==0;)k=k+"=";return k}function ze(k,v){v=v||1/0;let I;const R=k.length;let O=null;const V=[];for(let J=0;J<R;++J){if(I=k.charCodeAt(J),I>55295&&I<57344){if(!O){if(I>56319){(v-=3)>-1&&V.push(239,191,189);continue}else if(J+1===R){(v-=3)>-1&&V.push(239,191,189);continue}O=I;continue}if(I<56320){(v-=3)>-1&&V.push(239,191,189),O=I;continue}I=(O-55296<<10|I-56320)+65536}else O&&(v-=3)>-1&&V.push(239,191,189);if(O=null,I<128){if((v-=1)<0)break;V.push(I)}else if(I<2048){if((v-=2)<0)break;V.push(I>>6|192,I&63|128)}else if(I<65536){if((v-=3)<0)break;V.push(I>>12|224,I>>6&63|128,I&63|128)}else if(I<1114112){if((v-=4)<0)break;V.push(I>>18|240,I>>12&63|128,I>>6&63|128,I&63|128)}else throw new Error("Invalid code point")}return V}function Ve(k){const v=[];for(let I=0;I<k.length;++I)v.push(k.charCodeAt(I)&255);return v}function Pe(k,v){let I,R,O;const V=[];for(let J=0;J<k.length&&!((v-=2)<0);++J)I=k.charCodeAt(J),R=I>>8,O=I%256,V.push(O),V.push(R);return V}function $e(k){return e.toByteArray(ue(k))}function Bt(k,v,I,R){let O;for(O=0;O<R&&!(O+I>=v.length||O>=k.length);++O)v[O+I]=k[O];return O}function ut(k,v){return k instanceof v||k!=null&&k.constructor!=null&&k.constructor.name!=null&&k.constructor.name===v.name}function xn(k){return k!==k}const os=function(){const k="0123456789abcdef",v=new Array(256);for(let I=0;I<16;++I){const R=I*16;for(let O=0;O<16;++O)v[R+O]=k[I]+k[O]}return v}();function Hn(k){return typeof BigInt>"u"?Pr:k}function Pr(){throw new Error("BigInt not supported")}})(nn);var ql=(t=>(t[t.BINARY=0]="BINARY",t[t.ECHO=1]="ECHO",t[t.RCP=2]="RCP",t[t.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",t[t.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",t[t.STATUS=5]="STATUS",t[t.TIMING_MARK=6]="TIMING_MARK",t[t.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",t[t.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",t[t.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",t[t.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",t[t.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",t[t.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",t[t.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",t[t.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",t[t.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",t[t.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",t[t.EXTENDED_ASCII=17]="EXTENDED_ASCII",t[t.LOGOUT=18]="LOGOUT",t[t.BYTE_MACRO=19]="BYTE_MACRO",t[t.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",t[t.SUPDUP=21]="SUPDUP",t[t.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",t[t.SEND_LOCATION=23]="SEND_LOCATION",t[t.TERMINAL_TYPE=24]="TERMINAL_TYPE",t[t.END_OF_RECORD=25]="END_OF_RECORD",t[t.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",t[t.OUTPUT_MARKING=27]="OUTPUT_MARKING",t[t.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",t[t.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",t[t.X_3_PAD=30]="X_3_PAD",t[t.NAWS=31]="NAWS",t[t.TERMINAL_SPEED=32]="TERMINAL_SPEED",t[t.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",t[t.LINEMODE=34]="LINEMODE",t[t.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",t[t.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",t[t.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",t[t.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",t[t.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",t[t.TN3270E=40]="TN3270E",t[t.XAUTH=41]="XAUTH",t[t.CHARSET=42]="CHARSET",t[t.RSP=43]="RSP",t[t.COM_PORT_OPTION=44]="COM_PORT_OPTION",t[t.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",t[t.START_TLS=46]="START_TLS",t[t.KERMIT=47]="KERMIT",t[t.SEND_URL=48]="SEND_URL",t[t.FORWARD_X=49]="FORWARD_X",t[t.PRAGMA_LOGON=138]="PRAGMA_LOGON",t[t.GMCP=201]="GMCP",t))(ql||{}),eu=(t=>(t[t.SE=240]="SE",t[t.NOP=241]="NOP",t[t.DM=242]="DM",t[t.BRK=243]="BRK",t[t.IP=244]="IP",t[t.AO=245]="AO",t[t.AYT=246]="AYT",t[t.EC=247]="EC",t[t.EL=248]="EL",t[t.GA=249]="GA",t[t.SB=250]="SB",t[t.WILL=251]="WILL",t[t.WONT=252]="WONT",t[t.DO=253]="DO",t[t.DONT=254]="DONT",t[t.IAC=255]="IAC",t))(eu||{});class Q2{constructor(e){U(this,"ws");this.ws=e}on(e,n){if(e==="data"){this.ws.onmessage=i=>{n(i.data)};return}const r="on"+e;this[r]=n}write(e){this.ws.send(e)}}class q2 extends gE{constructor(n){super();U(this,"state");U(this,"buffer");U(this,"subBuffer");U(this,"iacSEBuffer",nn.Buffer.from([255,240]));U(this,"negotiationByte",0);U(this,"stream");this.state=0,this.buffer=nn.Buffer.alloc(0),this.subBuffer=nn.Buffer.alloc(0),n&&n.on("data",r=>this.parse(r)),this.stream=n}parse(n){for(this.buffer=nn.Buffer.concat([this.buffer,nn.Buffer.from(n)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const n=this.buffer.indexOf(255);if(n===-1){this.emit("data",this.buffer),this.buffer=nn.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,n)),this.buffer=this.buffer.slice(n),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const n=this.buffer[1];switch(this.buffer=this.buffer.slice(2),n){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=nn.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=n,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const n=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",n,r),this.state=0,!1}handleSubnegotiation(){let n=this.buffer.indexOf(this.iacSEBuffer);if(n===-1)return!0;this.state=0;let r=this.buffer.slice(0,n);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(n+2),!1}handleGmcp(n){const r=n.toString(),[i,o]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,o)}sendNegotiation(n,r){this.stream.write(nn.Buffer.from([255,n,r]))}sendGmcp(n,r){const i=n+" "+r,o=nn.Buffer.from(i),s=nn.Buffer.concat([nn.Buffer.from([255,250]),nn.Buffer.from([201]),o,this.iacSEBuffer]);this.stream.write(s)}sendTerminalType(n){const r=nn.Buffer.from(n),i=nn.Buffer.concat([nn.Buffer.from([255,250]),nn.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}class ts{constructor(e){U(this,"packageName");U(this,"packageVersion",1);U(this,"client");this.client=e}sendData(e,n){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(n))}shutdown(){}}class eL extends ts{constructor(){super(...arguments);U(this,"packageName","Auth.Autologin")}handleToken(n){localStorage.setItem("LoginRefreshToken",n)}sendLogin(){var n=localStorage.getItem("LoginRefreshToken");n&&this.sendData("Login",n)}}class tL extends ts{constructor(){super(...arguments);U(this,"packageName","Char")}handleName(n){this.client.worldData.playerId=n.name,this.client.worldData.playerName=n.fullname,this.client.emit("statustext",`Logged in as ${n.fullname}`)}sendLogin(n,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:n,password:r}))}}class nL extends ts{constructor(n){super(n);U(this,"packageName","Client.Keystrokes");U(this,"bindings",[]);U(this,"boundKeyUpHandler");document.addEventListener("keydown",r=>this.handleKeydown(r))}handleKeydown(n){const r=this.findBinding(n);if(r){n.preventDefault();const i=this.client.getInput(),o=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(o):this.placeInInputField(o)}}shutdown(){document.removeEventListener("keydown",n=>this.handleKeydown(n))}findBinding(n){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==n.key.toLowerCase())return!1;const i=new Set([n.altKey&&"Alt",n.ctrlKey&&"Control",n.shiftKey&&"Shift",n.metaKey&&"Meta"].filter(Boolean));return r.modifiers&&r.modifiers.every(o=>i.has(o))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(n,r){const i=r.trim().split(/\s+/);return n.replace(/%(\d+|\*)/g,(o,s)=>{if(s==="*")return r;const a=parseInt(s,10)-1;return a>=0&&a<i.length?i[a]:o})}placeInInputField(n){this.client.setInput(n)}bindKey(n){const r={key:n.key,modifiers:n.modifiers,command:n.command,autosend:n.autosend};this.bindings.push(r)}unbindKey(n){this.bindings=this.bindings.filter(r=>!(r.key===n.key&&r.modifiers.length===n.modifiers.length&&r.modifiers.every(i=>n.modifiers.includes(i))))}unbindAll(){this.bindings=[]}handleBind(n){this.bindKey(n)}handleUnbind(n){this.unbindKey(n)}handleBind_all(n){this.bindings=n.bindings.map(r=>({...r}))}listBindings(){return[...this.bindings]}}const eb=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),tb=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),ov=(t,e)=>({startTime:e,type:"setValue",value:t}),vE=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),yE=(t,e,{startTime:n,target:r,timeConstant:i})=>r+(e-r)*Math.exp((n-t)/i),Ic=t=>t.type==="exponentialRampToValue",wf=t=>t.type==="linearRampToValue",Cs=t=>Ic(t)||wf(t),Ny=t=>t.type==="setValue",co=t=>t.type==="setValueCurve",Af=(t,e,n,r)=>{const i=t[e];return i===void 0?r:Cs(i)||Ny(i)?i.value:co(i)?i.values[i.values.length-1]:yE(n,Af(t,e-1,i.startTime,r),i)},nb=(t,e,n,r,i)=>n===void 0?[r.insertTime,i]:Cs(n)?[n.endTime,n.value]:Ny(n)?[n.startTime,n.value]:co(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,Af(t,e-1,n.startTime,i)],sv=t=>t.type==="cancelAndHold",av=t=>t.type==="cancelScheduledValues",ls=t=>sv(t)||av(t)?t.cancelTime:Ic(t)||wf(t)?t.endTime:t.startTime,rb=(t,e,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((t-e)/(r-e)):0,ib=(t,e,n,{endTime:r,value:i})=>n+(t-e)/(r-e)*(i-n),rL=(t,e)=>{const n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},iL=(t,{duration:e,startTime:n,values:r})=>{const i=(t-n)/e*(r.length-1);return rL(r,i)},Jd=t=>t.type==="setTarget";class oL{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=ls(e);if(sv(e)||av(e)){const r=this._automationEvents.findIndex(o=>av(e)&&co(o)?o.startTime+o.duration>=n:ls(o)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),sv(e)){const o=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&Cs(i)){if(o!==void 0&&Jd(o))throw new Error("The internal list is malformed.");const s=o===void 0?i.insertTime:co(o)?o.startTime+o.duration:ls(o),a=o===void 0?this._defaultValue:co(o)?o.values[o.values.length-1]:o.value,c=Ic(i)?rb(n,s,a,i):ib(n,s,a,i),l=Ic(i)?eb(c,n,this._currenTime):tb(c,n,this._currenTime);this._automationEvents.push(l)}if(o!==void 0&&Jd(o)&&this._automationEvents.push(ov(this.getValue(n),n)),o!==void 0&&co(o)&&o.startTime+o.duration>n){const s=n-o.startTime,a=(o.values.length-1)/o.duration,c=Math.max(2,1+Math.ceil(s*a)),l=s/(c-1)*a,u=o.values.slice(0,c);if(l<1)for(let d=1;d<c;d+=1){const h=l*d%1;u[d]=o.values[d-1]*(1-h)+o.values[d]*h}this._automationEvents[this._automationEvents.length-1]=vE(u,o.startTime,s)}}}else{const r=this._automationEvents.findIndex(s=>ls(s)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&co(i)&&ls(i)+i.duration>n)return!1;const o=Ic(e)?eb(e.value,e.endTime,this._currenTime):wf(e)?tb(e.value,n,this._currenTime):e;if(r===-1)this._automationEvents.push(o);else{if(co(e)&&n+e.duration>ls(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(e){const n=this._automationEvents.findIndex(r=>ls(r)>e);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];Jd(i)&&r.unshift(ov(Af(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(s=>ls(s)>e),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,o=this._automationEvents[i];if(o!==void 0&&Jd(o)&&(r===void 0||!Cs(r)||r.insertTime>e))return yE(e,Af(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(o!==void 0&&Ny(o)&&(r===void 0||!Cs(r)))return o.value;if(o!==void 0&&co(o)&&(r===void 0||!Cs(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?iL(e,o):o.values[o.values.length-1];if(o!==void 0&&Cs(o)&&(r===void 0||!Cs(r)))return o.value;if(r!==void 0&&Ic(r)){const[s,a]=nb(this._automationEvents,i,o,r,this._defaultValue);return rb(e,s,a,r)}if(r!==void 0&&wf(r)){const[s,a]=nb(this._automationEvents,i,o,r,this._defaultValue);return ib(e,s,a,r)}return this._defaultValue}}const sL=t=>({cancelTime:t,type:"cancelAndHold"}),aL=t=>({cancelTime:t,type:"cancelScheduledValues"}),cL=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),lL=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),uL=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),dL=()=>new DOMException("","AbortError"),hL=t=>(e,n,[r,i,o],s)=>{t(e[i],[n,r,o],a=>a[0]===n&&a[1]===r,s)},fL=t=>(e,n,r)=>{const i=[];for(let o=0;o<r.numberOfInputs;o+=1)i.push(new Set);t.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},pL=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Qc=new WeakSet,CE=new WeakMap,IE=new WeakMap,SE=new WeakMap,bE=new WeakMap,wE=new WeakMap,AE=new WeakMap,cv=new WeakMap,lv=new WeakMap,uv=new WeakMap,kE={construct(){return kE}},gL=t=>{try{const e=new Proxy(t,kE);new e}catch{return!1}return!0},ob=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,sb=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),i=r.match(ob);for(;i!==null;){const o=i[1].slice(1,-1),s=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());n.push(s),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(ob)}return[n.join(";"),r]},ab=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},cb=t=>{if(!gL(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},mL=(t,e,n,r,i,o,s,a,c,l,u,d,h)=>{let f=0;return(p,m,C={credentials:"omit"})=>{const g=u.get(p);if(g!==void 0&&g.has(m))return Promise.resolve();const y=l.get(p);if(y!==void 0){const A=y.get(m);if(A!==void 0)return A}const S=o(p),E=S.audioWorklet===void 0?i(m).then(([A,P])=>{const[w,T]=sb(A,P),_=`${w};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${T}
})})(window,'_AWGS')`;return n(_)}).then(()=>{const A=h._AWGS.pop();if(A===void 0)throw new SyntaxError;r(S.currentTime,S.sampleRate,()=>A(class{},void 0,(P,w)=>{if(P.trim()==="")throw e();const T=lv.get(S);if(T!==void 0){if(T.has(P))throw e();cb(w),ab(w.parameterDescriptors),T.set(P,w)}else cb(w),ab(w.parameterDescriptors),lv.set(S,new Map([[P,w]]))},S.sampleRate,void 0,void 0))}):Promise.all([i(m),Promise.resolve(t(d,d))]).then(([[A,P],w])=>{const T=f+1;f=T;const[_,M]=sb(A,P),Z=`${_};((AudioWorkletProcessor,registerProcessor)=>{${M}
})(${w?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${w?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${w?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${T}',class extends AudioWorkletProcessor{process(){return !1}})`,z=new Blob([Z],{type:"application/javascript; charset=utf-8"}),q=URL.createObjectURL(z);return S.audioWorklet.addModule(q,C).then(()=>{if(a(S))return S;const oe=s(S);return oe.audioWorklet.addModule(q,C).then(()=>oe)}).then(oe=>{if(c===null)throw new SyntaxError;try{new c(oe,`__sac${T}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(q))});return y===void 0?l.set(p,new Map([[m,E]])):y.set(m,E),E.then(()=>{const A=u.get(p);A===void 0?u.set(p,new Set([m])):A.add(m)}).finally(()=>{const A=l.get(p);A!==void 0&&A.delete(m)}),E}},yi=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},Cp=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return t.delete(r),r},EE=(t,e,n,r)=>{const i=yi(t,e),o=Cp(i,s=>s[0]===n&&s[1]===r);return i.size===0&&t.delete(e),o},fd=t=>yi(AE,t),qc=t=>{if(Qc.has(t))throw new Error("The AudioNode is already stored.");Qc.add(t),fd(t).forEach(e=>e(!0))},TE=t=>"port"in t,pd=t=>{if(!Qc.has(t))throw new Error("The AudioNode is not stored.");Qc.delete(t),fd(t).forEach(e=>e(!1))},dv=(t,e)=>{!TE(t)&&e.every(n=>n.size===0)&&pd(t)},vL=(t,e,n,r,i,o,s,a,c,l,u,d,h)=>{const f=new WeakMap;return(p,m,C,g,y)=>{const{activeInputs:S,passiveInputs:E}=o(m),{outputs:A}=o(p),P=a(p),w=T=>{const _=c(m),M=c(p);if(T){const D=EE(E,p,C,g);t(S,p,D,!1),!y&&!d(p)&&n(M,_,C,g),h(m)&&qc(m)}else{const D=r(S,p,C,g);e(E,g,D,!1),!y&&!d(p)&&i(M,_,C,g);const B=s(m);if(B===0)u(m)&&dv(m,S);else{const j=f.get(m);j!==void 0&&clearTimeout(j),f.set(m,setTimeout(()=>{u(m)&&dv(m,S)},B*1e3))}}};return l(A,[m,C,g],T=>T[0]===m&&T[1]===C&&T[2]===g,!0)?(P.add(w),u(p)?t(S,p,[C,g,w],!0):e(E,g,[p,C,w],!0),!0):!1}},yL=t=>(e,n,[r,i,o],s)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[i,n,o]])):t(a,[i,n,o],c=>c[0]===i&&c[1]===n,s)},CL=t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},IL=t=>(e,n)=>{t(e).add(n)},SL={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},bL=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=i(a),u={...SL,...c},d=r(l,u),h=o(l)?e():null;super(a,!1,d,h),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},En=(t,e)=>t.context===e,wL=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!En(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(s,l)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},hv=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},to=()=>new DOMException("","IndexSizeError"),xE=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(r){throw r.code===12?to():r}})(t.getChannelData)},AL={numberOfChannels:1},kL=(t,e,n,r,i,o,s,a)=>{let c=null;return class PE{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:h,sampleRate:f}={...AL,...u};c===null&&(c=new i(1,1,44100));const p=r!==null&&e(o,o)?new r({length:d,numberOfChannels:h,sampleRate:f}):c.createBuffer(h,d,f);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(s(p),xE(p)):e(hv,()=>hv(p))||a(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===PE.prototype||t.has(u)}}},Yn=-34028234663852886e22,Mn=-Yn,Wo=t=>Qc.has(t),EL={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},TL=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),h={...EL,...u},f=i(d,h),p=s(d),m=p?e():null;super(l,!1,f,m),this._audioBufferSourceNodeRenderer=m,this._isBufferNullified=!1,this._isBufferSet=h.buffer!==null,this._nativeAudioBufferSourceNode=f,this._onended=null,this._playbackRate=n(this,p,f.playbackRate,Mn,Yn)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?l:d}get playbackRate(){return this._playbackRate}start(l=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(l,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[l,u]:[l,u,d]),this.context.state!=="closed"){qc(this);const h=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",h),Wo(this)&&pd(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",h)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},xL=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const c=async(l,u)=>{let d=n(l);const h=En(d,u);if(!h){const f={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(u,f),s!==null&&d.start(...s),a!==null&&d.stop(a)}return o.set(u,d),h?await t(u,l.playbackRate,d.playbackRate):await r(u,l.playbackRate,d.playbackRate),await i(l,u,d),d};return{set start(l){s=l},set stop(l){a=l},render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},PL=t=>"playbackRate"in t,RL=t=>"frequency"in t&&"gain"in t,NL=t=>"offset"in t,_L=t=>!("frequency"in t)&&"gain"in t,ML=t=>"detune"in t&&"frequency"in t,OL=t=>"pan"in t,Ln=t=>yi(CE,t),gd=t=>yi(SE,t),fv=(t,e)=>{const{activeInputs:n}=Ln(t);n.forEach(i=>i.forEach(([o])=>{e.includes(t)||fv(o,[...e,t])}));const r=PL(t)?[t.playbackRate]:TE(t)?Array.from(t.parameters.values()):RL(t)?[t.Q,t.detune,t.frequency,t.gain]:NL(t)?[t.offset]:_L(t)?[t.gain]:ML(t)?[t.detune,t.frequency]:OL(t)?[t.pan]:[];for(const i of r){const o=gd(i);o!==void 0&&o.activeInputs.forEach(([s])=>fv(s,e))}Wo(t)&&pd(t)},DL=t=>{fv(t.destination,[])},LL=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),BL=(t,e,n,r,i,o,s,a,c)=>class extends t{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new c(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(d===null)throw r();if(!LL(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw n();super(d,2);const{latencyHint:h}=u,{sampleRate:f}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:h==="balanced"?512/f:h==="interactive"||h===void 0?256/f:h==="playback"?1024/f:Math.max(2,Math.min(128,Math.round(h*f/128)))*128/f,this._nativeAudioContext=d,c.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",p)};d.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),DL(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(u){return new s(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const h=()=>{this._nativeAudioContext.removeEventListener("statechange",h),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",h)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},FL=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),h=s(d),f=i(d,u,h),p=h?e(a):null;super(l,!1,f,p),this._isNodeOfNativeOfflineAudioContext=h,this._nativeAudioDestinationNode=f}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},UL=t=>{const e=new WeakMap,n=async(r,i)=>{const o=i.destination;return e.set(i,o),await t(r,i,o),o};return{render(r,i){const o=e.get(i);return o!==void 0?Promise.resolve(o):n(r,i)}}},VL=(t,e,n,r,i,o,s,a)=>(c,l)=>{const u=l.listener,d=()=>{const A=new Float32Array(1),P=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),w=s(l);let T=!1,_=[0,0,-1,0,1,0],M=[0,0,0];const D=()=>{if(T)return;T=!0;const z=r(l,256,9,0);z.onaudioprocess=({inputBuffer:q})=>{const oe=[o(q,A,0),o(q,A,1),o(q,A,2),o(q,A,3),o(q,A,4),o(q,A,5)];oe.some((Y,re)=>Y!==_[re])&&(u.setOrientation(...oe),_=oe);const W=[o(q,A,6),o(q,A,7),o(q,A,8)];W.some((Y,re)=>Y!==M[re])&&(u.setPosition(...W),M=W)},P.connect(z)},B=z=>q=>{q!==_[z]&&(_[z]=q,u.setOrientation(..._))},j=z=>q=>{q!==M[z]&&(M[z]=q,u.setPosition(...M))},Z=(z,q,oe)=>{const W=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:q});W.connect(P,0,z),W.start(),Object.defineProperty(W.offset,"defaultValue",{get(){return q}});const Y=t({context:c},w,W.offset,Mn,Yn);return a(Y,"value",re=>()=>re.call(Y),re=>H=>{try{re.call(Y,H)}catch(te){if(te.code!==9)throw te}D(),w&&oe(H)}),Y.cancelAndHoldAtTime=(re=>w?()=>{throw i()}:(...H)=>{const te=re.apply(Y,H);return D(),te})(Y.cancelAndHoldAtTime),Y.cancelScheduledValues=(re=>w?()=>{throw i()}:(...H)=>{const te=re.apply(Y,H);return D(),te})(Y.cancelScheduledValues),Y.exponentialRampToValueAtTime=(re=>w?()=>{throw i()}:(...H)=>{const te=re.apply(Y,H);return D(),te})(Y.exponentialRampToValueAtTime),Y.linearRampToValueAtTime=(re=>w?()=>{throw i()}:(...H)=>{const te=re.apply(Y,H);return D(),te})(Y.linearRampToValueAtTime),Y.setTargetAtTime=(re=>w?()=>{throw i()}:(...H)=>{const te=re.apply(Y,H);return D(),te})(Y.setTargetAtTime),Y.setValueAtTime=(re=>w?()=>{throw i()}:(...H)=>{const te=re.apply(Y,H);return D(),te})(Y.setValueAtTime),Y.setValueCurveAtTime=(re=>w?()=>{throw i()}:(...H)=>{const te=re.apply(Y,H);return D(),te})(Y.setValueCurveAtTime),Y};return{forwardX:Z(0,0,B(0)),forwardY:Z(1,0,B(1)),forwardZ:Z(2,-1,B(2)),positionX:Z(6,0,j(0)),positionY:Z(7,0,j(1)),positionZ:Z(8,0,j(2)),upX:Z(3,0,B(3)),upY:Z(4,1,B(4)),upZ:Z(5,0,B(5))}},{forwardX:h,forwardY:f,forwardZ:p,positionX:m,positionY:C,positionZ:g,upX:y,upY:S,upZ:E}=u.forwardX===void 0?d():u;return{get forwardX(){return h},get forwardY(){return f},get forwardZ(){return p},get positionX(){return m},get positionY(){return C},get positionZ(){return g},get upX(){return y},get upY(){return S},get upZ(){return E}}},kf=t=>"context"in t,md=t=>kf(t[0]),za=(t,e,n,r)=>{for(const i of t)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},lb=(t,e,[n,r],i)=>{za(t,[e,n,r],o=>o[0]===e&&o[1]===n,i)},ub=(t,[e,n,r],i)=>{const o=t.get(e);o===void 0?t.set(e,new Set([[n,r]])):za(o,[n,r],s=>s[0]===n,i)},hl=t=>"inputs"in t,Ef=(t,e,n,r)=>{if(hl(e)){const i=e.inputs[r];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,r),[e,n,r]},RE=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},GL=(t,e,n)=>Cp(t,r=>r[0]===e&&r[1]===n),NE=(t,e)=>{if(!fd(t).delete(e))throw new Error("Missing the expected event listener.")},_E=(t,e,n)=>{const r=yi(t,e),i=Cp(r,o=>o[0]===n);return r.size===0&&t.delete(e),i},Tf=(t,e,n,r)=>{hl(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},vt=t=>yi(IE,t),Zu=t=>yi(bE,t),Ma=t=>cv.has(t),Eh=t=>!Qc.has(t),db=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const r=t.createScriptProcessor(256,1,1),i=t.createGain(),o=t.createBuffer(1,2,44100),s=o.getChannelData(0);s[0]=1,s[1]=1;const a=t.createBufferSource();a.buffer=o,a.loop=!0,a.connect(r).connect(t.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}}),Ag=(t,e)=>{const n=new Map;for(const r of t)for(const i of r){const o=n.get(i);n.set(i,o===void 0?1:o+1)}n.forEach((r,i)=>e(i,r))},xf=t=>"context"in t,WL=t=>{const e=new Map;t.connect=(n=>(r,i=0,o=0)=>{const s=xf(r)?n(r,i,o):n(r,i),a=e.get(r);return a===void 0?e.set(r,[{input:o,output:i}]):a.every(c=>c.input!==o||c.output!==i)&&a.push({input:o,output:i}),s})(t.connect.bind(t)),t.disconnect=(n=>(r,i,o)=>{if(n.apply(t),r===void 0)e.clear();else if(typeof r=="number")for(const[s,a]of e){const c=a.filter(l=>l.output!==r);c.length===0?e.delete(s):e.set(s,c)}else if(e.has(r))if(i===void 0)e.delete(r);else{const s=e.get(r);if(s!==void 0){const a=s.filter(c=>c.output!==i&&(c.input!==o||o===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[s,a]of e)a.forEach(c=>{xf(s)?t.connect(s,c.output,c.input):t.connect(s,c.output)})})(t.disconnect)},jL=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=gd(e),{outputs:s}=Ln(t),a=fd(t),c=l=>{const u=vt(t),d=Zu(e);if(l){const h=_E(o,t,n);lb(i,t,h,!1),!r&&!Ma(t)&&u.connect(d,n)}else{const h=GL(i,t,n);ub(o,h,!1),!r&&!Ma(t)&&u.disconnect(d,n)}};return za(s,[e,n],l=>l[0]===e&&l[1]===n,!0)?(a.add(c),Wo(t)?lb(i,t,[n,c],!0):ub(o,[t,n,c],!0),!0):!1},ZL=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=Ln(e),s=RE(i[r],t,n);return s===null?[EE(o,t,n,r)[2],!1]:[s[2],!0]},zL=(t,e,n)=>{const{activeInputs:r,passiveInputs:i}=gd(e),o=RE(r,t,n);return o===null?[_E(i,t,n)[1],!1]:[o[2],!0]},_y=(t,e,n,r,i)=>{const[o,s]=ZL(t,n,r,i);if(o!==null&&(NE(t,o),s&&!e&&!Ma(t)&&Tf(vt(t),vt(n),r,i)),Wo(n)){const{activeInputs:a}=Ln(n);dv(n,a)}},My=(t,e,n,r)=>{const[i,o]=zL(t,n,r);i!==null&&(NE(t,i),o&&!e&&!Ma(t)&&vt(t).disconnect(Zu(n),r))},HL=(t,e)=>{const n=Ln(t),r=[];for(const i of n.outputs)md(i)?_y(t,e,...i):My(t,e,...i),r.push(i[0]);return n.outputs.clear(),r},XL=(t,e,n)=>{const r=Ln(t),i=[];for(const o of r.outputs)o[1]===n&&(md(o)?_y(t,e,...o):My(t,e,...o),i.push(o[0]),r.outputs.delete(o));return i},$L=(t,e,n,r,i)=>{const o=Ln(t);return Array.from(o.outputs).filter(s=>s[0]===n&&(r===void 0||s[1]===r)&&(i===void 0||s[2]===i)).map(s=>(md(s)?_y(t,e,...s):My(t,e,...s),o.outputs.delete(s),s[0]))},KL=(t,e,n,r,i,o,s,a,c,l,u,d,h,f,p,m)=>class extends l{constructor(g,y,S,E){super(S),this._context=g,this._nativeAudioNode=S;const A=u(g);d(A)&&n(db,()=>db(A,m))!==!0&&WL(S),IE.set(this,S),AE.set(this,new Set),g.state!=="closed"&&y&&qc(this),t(this,E,S)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(g){this._nativeAudioNode.channelCount=g}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(g){this._nativeAudioNode.channelCountMode=g}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(g){this._nativeAudioNode.channelInterpretation=g}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(g,y=0,S=0){if(y<0||y>=this._nativeAudioNode.numberOfOutputs)throw i();const E=u(this._context),A=p(E);if(h(g)||f(g))throw o();if(kf(g)){const T=vt(g);try{const M=Ef(this._nativeAudioNode,T,y,S),D=Eh(this);(A||D)&&this._nativeAudioNode.disconnect(...M),this.context.state!=="closed"&&!D&&Eh(g)&&qc(g)}catch(M){throw M.code===12?o():M}if(e(this,g,y,S,A)){const M=c([this],g);Ag(M,r(A))}return g}const P=Zu(g);if(P.name==="playbackRate"&&P.maxValue===1024)throw s();try{this._nativeAudioNode.connect(P,y),(A||Eh(this))&&this._nativeAudioNode.disconnect(P,y)}catch(T){throw T.code===12?o():T}if(jL(this,g,y,A)){const T=c([this],g);Ag(T,r(A))}}disconnect(g,y,S){let E;const A=u(this._context),P=p(A);if(g===void 0)E=HL(this,P);else if(typeof g=="number"){if(g<0||g>=this.numberOfOutputs)throw i();E=XL(this,P,g)}else{if(y!==void 0&&(y<0||y>=this.numberOfOutputs)||kf(g)&&S!==void 0&&(S<0||S>=g.numberOfInputs))throw i();if(E=$L(this,P,g,y,S),E.length===0)throw o()}for(const w of E){const T=c([this],w);Ag(T,a)}}},JL=(t,e,n,r,i,o,s,a,c,l,u,d,h)=>(f,p,m,C=null,g=null)=>{const y=m.value,S=new oL(y),E=p?r(S):null,A={get defaultValue(){return y},get maxValue(){return C===null?m.maxValue:C},get minValue(){return g===null?m.minValue:g},get value(){return m.value},set value(P){m.value=P,A.setValueAtTime(P,f.context.currentTime)},cancelAndHoldAtTime(P){if(typeof m.cancelAndHoldAtTime=="function")E===null&&S.flush(f.context.currentTime),S.add(i(P)),m.cancelAndHoldAtTime(P);else{const w=Array.from(S).pop();E===null&&S.flush(f.context.currentTime),S.add(i(P));const T=Array.from(S).pop();m.cancelScheduledValues(P),w!==T&&T!==void 0&&(T.type==="exponentialRampToValue"?m.exponentialRampToValueAtTime(T.value,T.endTime):T.type==="linearRampToValue"?m.linearRampToValueAtTime(T.value,T.endTime):T.type==="setValue"?m.setValueAtTime(T.value,T.startTime):T.type==="setValueCurve"&&m.setValueCurveAtTime(T.values,T.startTime,T.duration))}return A},cancelScheduledValues(P){return E===null&&S.flush(f.context.currentTime),S.add(o(P)),m.cancelScheduledValues(P),A},exponentialRampToValueAtTime(P,w){if(P===0)throw new RangeError;if(!Number.isFinite(w)||w<0)throw new RangeError;const T=f.context.currentTime;return E===null&&S.flush(T),Array.from(S).length===0&&(S.add(l(y,T)),m.setValueAtTime(y,T)),S.add(s(P,w)),m.exponentialRampToValueAtTime(P,w),A},linearRampToValueAtTime(P,w){const T=f.context.currentTime;return E===null&&S.flush(T),Array.from(S).length===0&&(S.add(l(y,T)),m.setValueAtTime(y,T)),S.add(a(P,w)),m.linearRampToValueAtTime(P,w),A},setTargetAtTime(P,w,T){return E===null&&S.flush(f.context.currentTime),S.add(c(P,w,T)),m.setTargetAtTime(P,w,T),A},setValueAtTime(P,w){return E===null&&S.flush(f.context.currentTime),S.add(l(P,w)),m.setValueAtTime(P,w),A},setValueCurveAtTime(P,w,T){const _=P instanceof Float32Array?P:new Float32Array(P);if(d!==null&&d.name==="webkitAudioContext"){const M=w+T,D=f.context.sampleRate,B=Math.ceil(w*D),j=Math.floor(M*D),Z=j-B,z=new Float32Array(Z);for(let oe=0;oe<Z;oe+=1){const W=(_.length-1)/T*((B+oe)/D-w),Y=Math.floor(W),re=Math.ceil(W);z[oe]=Y===re?_[Y]:(1-(W-Y))*_[Y]+(1-(re-W))*_[re]}E===null&&S.flush(f.context.currentTime),S.add(u(z,w,T)),m.setValueCurveAtTime(z,w,T);const q=j/D;q<M&&h(A,z[z.length-1],q),h(A,_[_.length-1],M)}else E===null&&S.flush(f.context.currentTime),S.add(u(_,w,T)),m.setValueCurveAtTime(_,w,T);return A}};return n.set(A,m),e.set(A,f),t(A,E),A},YL=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;e.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;e.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:o}=n;e.setTargetAtTime(i,r,o)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;e.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:o}=n;e.setValueCurveAtTime(o,i,r)}else throw new Error("Can't apply an unknown automation.")}});class ME{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((r,i)=>e.call(n,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const QL={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},qL=(t,e,n,r,i,o,s,a,c,l,u,d,h,f)=>class extends e{constructor(m,C,g){var y;const S=a(m),E=c(S),A=u({...QL,...g});h(A);const P=lv.get(S),w=P==null?void 0:P.get(C),T=E||S.state!=="closed"?S:(y=s(S))!==null&&y!==void 0?y:S,_=i(T,E?null:m.baseLatency,l,C,w,A),M=E?r(C,A,w):null;super(m,!0,_,M);const D=[];_.parameters.forEach((j,Z)=>{const z=n(this,E,j);D.push([Z,z])}),this._nativeAudioWorkletNode=_,this._onprocessorerror=null,this._parameters=new ME(D),E&&t(S,this);const{activeInputs:B}=o(this);d(_,B)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(m){const C=typeof m=="function"?f(this,m):null;this._nativeAudioWorkletNode.onprocessorerror=C;const g=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=g!==null&&g===C?m:g}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Pf(t,e,n,r,i){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],r,i);else{const o=t.getChannelData(r);if(e[n].byteLength===0)e[n]=o.slice(i,i+128);else{const s=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(s)}}}const OE=(t,e,n,r,i)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],r,i):e[n].byteLength!==0&&t.getChannelData(r).set(e[n],i)},Rf=(t,e)=>{const n=[];for(let r=0;r<t;r+=1){const i=[],o=typeof e=="number"?e:e[r];for(let s=0;s<o;s+=1)i.push(new Float32Array(128));n.push(i)}return n},eB=(t,e)=>{const n=yi(uv,t),r=vt(e);return yi(n,r)},tB=async(t,e,n,r,i,o,s)=>{const a=e===null?Math.ceil(t.context.length/128)*128:e.length,c=r.channelCount*r.numberOfInputs,l=i.reduce((C,g)=>C+g,0),u=l===0?null:n.createBuffer(l,a,n.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const d=Ln(t),h=await eB(n,t),f=Rf(r.numberOfInputs,r.channelCount),p=Rf(r.numberOfOutputs,i),m=Array.from(t.parameters.keys()).reduce((C,g)=>({...C,[g]:new Float32Array(128)}),{});for(let C=0;C<a;C+=128){if(r.numberOfInputs>0&&e!==null)for(let g=0;g<r.numberOfInputs;g+=1)for(let y=0;y<r.channelCount;y+=1)Pf(e,f[g],y,y,C);o.parameterDescriptors!==void 0&&e!==null&&o.parameterDescriptors.forEach(({name:g},y)=>{Pf(e,m,g,c+y,C)});for(let g=0;g<r.numberOfInputs;g+=1)for(let y=0;y<i[g];y+=1)p[g][y].byteLength===0&&(p[g][y]=new Float32Array(128));try{const g=f.map((S,E)=>d.activeInputs[E].size===0?[]:S),y=s(C/n.sampleRate,n.sampleRate,()=>h.process(g,p,m));if(u!==null)for(let S=0,E=0;S<r.numberOfOutputs;S+=1){for(let A=0;A<i[S];A+=1)OE(u,p[S],A,E+A,C);E+=i[S]}if(!y)break}catch(g){t.dispatchEvent(new ErrorEvent("processorerror",{colno:g.colno,filename:g.filename,lineno:g.lineno,message:g.message}));break}}return u},nB=(t,e,n,r,i,o,s,a,c,l,u,d,h,f,p,m)=>(C,g,y)=>{const S=new WeakMap;let E=null;const A=async(P,w)=>{let T=u(P),_=null;const M=En(T,w),D=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(d===null){const B=D.reduce((q,oe)=>q+oe,0),j=i(w,{channelCount:Math.max(1,B),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,B)}),Z=[];for(let q=0;q<P.numberOfOutputs;q+=1)Z.push(r(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:D[q]}));const z=s(w,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});z.connect=e.bind(null,Z),z.disconnect=c.bind(null,Z),_=[j,Z,z]}else M||(T=new d(w,C));if(S.set(w,_===null?T:_[2]),_!==null){if(E===null){if(y===void 0)throw new Error("Missing the processor constructor.");if(h===null)throw new Error("Missing the native OfflineAudioContext constructor.");const oe=P.channelCount*P.numberOfInputs,W=y.parameterDescriptors===void 0?0:y.parameterDescriptors.length,Y=oe+W;E=tB(P,Y===0?null:await(async()=>{const H=new h(Y,Math.ceil(P.context.length/128)*128,w.sampleRate),te=[],Ee=[];for(let ke=0;ke<g.numberOfInputs;ke+=1)te.push(s(H,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),Ee.push(i(H,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const Le=await Promise.all(Array.from(P.parameters.values()).map(async ke=>{const je=o(H,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ke.value});return await f(H,ke,je.offset),je})),ve=r(H,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,oe+W)});for(let ke=0;ke<g.numberOfInputs;ke+=1){te[ke].connect(Ee[ke]);for(let je=0;je<g.channelCount;je+=1)Ee[ke].connect(ve,je,ke*g.channelCount+je)}for(const[ke,je]of Le.entries())je.connect(ve,0,oe+ke),je.start(0);return ve.connect(H.destination),await Promise.all(te.map(ke=>p(P,H,ke))),m(H)})(),w,g,D,y,l)}const B=await E,j=n(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[Z,z,q]=_;B!==null&&(j.buffer=B,j.start(0)),j.connect(Z);for(let oe=0,W=0;oe<P.numberOfOutputs;oe+=1){const Y=z[oe];for(let re=0;re<D[oe];re+=1)Z.connect(Y,W+re,re);W+=D[oe]}return q}if(M)for(const[B,j]of P.parameters.entries())await t(w,j,T.parameters.get(B));else for(const[B,j]of P.parameters.entries())await f(w,j,T.parameters.get(B));return await p(P,w,T),T};return{render(P,w){a(w,P);const T=S.get(w);return T!==void 0?Promise.resolve(T):A(P,w)}}},rB=(t,e,n,r,i,o,s,a,c,l,u,d,h,f,p,m,C,g,y,S)=>class extends p{constructor(A,P){super(A,P),this._nativeContext=A,this._audioWorklet=t===void 0?void 0:{addModule:(w,T)=>t(this,w,T)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(A,P,w){return new n({length:P,numberOfChannels:A,sampleRate:w})}createBufferSource(){return new r(this)}createChannelMerger(A=6){return new o(this,{numberOfInputs:A})}createChannelSplitter(A=6){return new s(this,{numberOfOutputs:A})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(A=1){return new u(this,{maxDelayTime:A})}createDynamicsCompressor(){return new d(this)}createGain(){return new h(this)}createIIRFilter(A,P){return new f(this,{feedback:P,feedforward:A})}createOscillator(){return new m(this)}createPanner(){return new C(this)}createPeriodicWave(A,P,w={disableNormalization:!1}){return new g(this,{...w,imag:P,real:A})}createStereoPanner(){return new y(this)}createWaveShaper(){return new S(this)}decodeAudioData(A,P,w){return l(this._nativeContext,A).then(T=>(typeof P=="function"&&P(T),T),T=>{throw typeof w=="function"&&w(T),T})}},iB={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},oB=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),h={...iB,...u},f=i(d,h),p=s(d),m=p?n():null;super(l,!1,f,m),this._Q=e(this,p,f.Q,Mn,Yn),this._detune=e(this,p,f.detune,1200*Math.log2(Mn),-1200*Math.log2(Mn)),this._frequency=e(this,p,f.frequency,l.sampleRate/2,0),this._gain=e(this,p,f.gain,40*Math.log10(Mn),Yn),this._nativeBiquadFilterNode=f,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,d)}catch(h){throw h.code===11?r():h}if(l.length!==u.length||u.length!==d.length)throw r()}},sB=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=En(l,c);if(!u){const d={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,d)}return o.set(c,l),u?(await t(c,a.Q,l.Q),await t(c,a.detune,l.detune),await t(c,a.frequency,l.frequency),await t(c,a.gain,l.gain)):(await r(c,a.Q,l.Q),await r(c,a.detune,l.detune),await r(c,a.frequency,l.frequency),await r(c,a.gain,l.gain)),await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},aB=(t,e)=>(n,r)=>{const i=e.get(n);if(i!==void 0)return i;const o=t.get(n);if(o!==void 0)return o;try{const s=r();return s instanceof Promise?(t.set(n,s),s.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,s),s)}catch{return e.set(n,!1),!1}},cB={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},lB=(t,e,n,r,i)=>class extends t{constructor(s,a){const c=r(s),l={...cB,...a},u=n(c,l),d=i(c)?e():null;super(s,!1,u,d)}},uB=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!En(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(s,l)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},dB={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},hB=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=r(a),u=o({...dB,...c}),d=n(l,u),h=i(l)?e():null;super(a,!1,d,h)}},fB=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!En(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(s,l)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},pB=t=>(e,n,r)=>t(n,e,r),gB=t=>(e,n,r=0,i=0)=>{const o=e[r];if(o===void 0)throw t();return xf(n)?o.connect(n,0,i):o.connect(n,0)},mB=t=>(e,n)=>{const r=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},vB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},yB=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...vB,...l},h=r(u,d),f=o(u),p=f?n():null;super(c,!1,h,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=h,this._offset=e(this,f,h.offset,Mn,Yn),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?s(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){qc(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),Wo(this)&&pd(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},CB=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const c=async(l,u)=>{let d=n(l);const h=En(d,u);if(!h){const f={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=e(u,f),s!==null&&d.start(s),a!==null&&d.stop(a)}return o.set(u,d),h?await t(u,l.offset,d.offset):await r(u,l.offset,d.offset),await i(l,u,d),d};return{set start(l){s=l},set stop(l){a=l},render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},IB=t=>e=>(t[0]=e,t[0]),SB={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},bB=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=r(a),u={...SB,...c},d=n(l,u),f=i(l)?e():null;super(a,!1,d,f),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&o(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},wB=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!En(a,s)){const l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(s,l)}return r.set(s,a),hl(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},AB=()=>new DOMException("","DataCloneError"),hb=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,e.close(),n.close(),r()};n.onmessage=()=>i();try{e.postMessage(t,[t])}catch{}finally{i()}})},kB=(t,e,n,r,i,o,s,a,c,l,u)=>(d,h)=>{const f=s(d)?d:o(d);if(i.has(h)){const p=n();return Promise.reject(p)}try{i.add(h)}catch{}return e(c,()=>c(f))?f.decodeAudioData(h).then(p=>(hb(h).catch(()=>{}),e(a,()=>a(p))||u(p),t.add(p),p)):new Promise((p,m)=>{const C=async()=>{try{await hb(h)}catch{}},g=y=>{m(y),C()};try{f.decodeAudioData(h,y=>{typeof y.copyFromChannel!="function"&&(l(y),xE(y)),t.add(y),C().then(()=>p(y))},y=>{g(y===null?r():y)})}catch(y){g(y)}})},EB=(t,e,n,r,i,o,s,a)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=o(c.context),h=a(d);if(u===l){if(e.delete(c),!h&&s(c)){const f=r(c),{outputs:p}=n(c);for(const m of p)if(md(m)){const C=r(m[0]);t(f,C,m[1],m[2])}else{const C=i(m[0]);f.connect(C,m[1])}}}else e.set(c,u-l)},TB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},xB=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...TB,...l},h=r(u,d),f=o(u),p=f?n(d.maxDelayTime):null;super(c,!1,h,p),this._delayTime=e(this,f,h.delayTime),s(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},PB=(t,e,n,r,i)=>o=>{const s=new WeakMap,a=async(c,l)=>{let u=n(c);const d=En(u,l);if(!d){const h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=e(l,h)}return s.set(l,u),d?await t(l,c.delayTime,u.delayTime):await r(l,c.delayTime,u.delayTime),await i(c,l,u),u};return{render(c,l){const u=s.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}},RB=t=>(e,n,r,i)=>t(e[i],o=>o[0]===n&&o[1]===r),NB=t=>(e,n)=>{t(e).delete(n)},_B=t=>"delayTime"in t,MB=(t,e,n)=>function r(i,o){const s=kf(o)?o:n(t,o);if(_B(s))return[];if(i[0]===s)return[i];if(i.includes(s))return[];const{outputs:a}=e(s);return Array.from(a).map(c=>r([...i,s],c[0])).reduce((c,l)=>c.concat(l),[])},Yd=(t,e,n)=>{const r=e[n];if(r===void 0)throw t();return r},OB=t=>(e,n=void 0,r=void 0,i=0)=>n===void 0?e.forEach(o=>o.disconnect()):typeof n=="number"?Yd(t,e,n).disconnect():xf(n)?r===void 0?e.forEach(o=>o.disconnect(n)):i===void 0?Yd(t,e,r).disconnect(n,0):Yd(t,e,r).disconnect(n,0,i):r===void 0?e.forEach(o=>o.disconnect(n)):Yd(t,e,r).disconnect(n,0),DB={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},LB=(t,e,n,r,i,o,s,a)=>class extends t{constructor(l,u){const d=o(l),h={...DB,...u},f=r(d,h),p=s(d),m=p?n():null;super(l,!1,f,m),this._attack=e(this,p,f.attack),this._knee=e(this,p,f.knee),this._nativeDynamicsCompressorNode=f,this._ratio=e(this,p,f.ratio),this._release=e(this,p,f.release),this._threshold=e(this,p,f.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},BB=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=En(l,c);if(!u){const d={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,d)}return o.set(c,l),u?(await t(c,a.attack,l.attack),await t(c,a.knee,l.knee),await t(c,a.ratio,l.ratio),await t(c,a.release,l.release),await t(c,a.threshold,l.threshold)):(await r(c,a.attack,l.attack),await r(c,a.knee,l.knee),await r(c,a.ratio,l.ratio),await r(c,a.release,l.release),await r(c,a.threshold,l.threshold)),await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},FB=()=>new DOMException("","EncodingError"),UB=t=>e=>new Promise((n,r)=>{if(t===null){r(new SyntaxError);return}const i=t.document.head;if(i===null)r(new SyntaxError);else{const o=t.document.createElement("script"),s=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(s),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(u,d,h,f,p)=>{if(d===a||d===t.location.href&&h===1&&f===1)return l(),r(p),!1;if(c!==null)return c(u,d,h,f,p)},o.onerror=()=>{l(),r(new SyntaxError)},o.onload=()=>{l(),n()},o.src=a,o.type="module",i.appendChild(o)}}),VB=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=t(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(n,o,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,o===void 0?null:o,i)}},GB=t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},WB=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},jB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},ZB=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=i(a),u={...jB,...c},d=r(l,u),h=o(l),f=h?n():null;super(a,!1,d,f),this._gain=e(this,h,d.gain,Mn,Yn)}get gain(){return this._gain}},zB=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=En(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,d)}return o.set(c,l),u?await t(c,a.gain,l.gain):await r(c,a.gain,l.gain),await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},HB=(t,e)=>n=>e(t,n),XB=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},$B=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},KB=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},JB=t=>e=>t.get(e),un=()=>new DOMException("","InvalidStateError"),YB=t=>e=>{const n=t.get(e);if(n===void 0)throw un();return n},QB=(t,e)=>n=>{let r=t.get(n);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),t.set(n,r),r},qB=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},Ip=()=>new DOMException("","InvalidAccessError"),eF=t=>{t.getFrequencyResponse=(e=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw Ip();return e.call(t,n,r,i)})(t.getFrequencyResponse)},tF={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},nF=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=r(a),u=i(l),d={...tF,...c},h=e(l,u?null:a.baseLatency,d),f=u?n(d.feedback,d.feedforward):null;super(a,!1,h,f),eF(h),this._nativeIIRFilterNode=h,o(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}},DE=(t,e,n,r,i,o,s,a,c,l,u)=>{const d=l.length;let h=a;for(let f=0;f<d;f+=1){let p=n[0]*l[f];for(let m=1;m<i;m+=1){const C=h-m&c-1;p+=n[m]*o[C],p-=t[m]*s[C]}for(let m=i;m<r;m+=1)p+=n[m]*o[h-m&c-1];for(let m=i;m<e;m+=1)p-=t[m]*s[h-m&c-1];o[h]=l[f],s[h]=p,h=h+1&c-1,u[f]=p}return h},rF=(t,e,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),o=r instanceof Float64Array?r:new Float64Array(r),s=i.length,a=o.length,c=Math.min(s,a);if(i[0]!==1){for(let p=0;p<s;p+=1)o[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const l=32,u=new Float32Array(l),d=new Float32Array(l),h=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),f=t.numberOfChannels;for(let p=0;p<f;p+=1){const m=t.getChannelData(p),C=h.getChannelData(p);u.fill(0),d.fill(0),DE(i,s,o,a,c,u,d,0,l,m,C)}return h},iF=(t,e,n,r,i)=>(o,s)=>{const a=new WeakMap;let c=null;const l=async(u,d)=>{let h=null,f=e(u);const p=En(f,d);if(d.createIIRFilter===void 0?h=t(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(f=d.createIIRFilter(s,o)),a.set(d,h===null?f:h),h!==null){if(c===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const C=new n(u.context.destination.channelCount,u.context.length,d.sampleRate);c=(async()=>{await r(u,C,C.destination);const g=await i(C);return rF(g,d,o,s)})()}const m=await c;return h.buffer=m,h.start(0),h}return await r(u,d,f),f};return{render(u,d){const h=a.get(d);return h!==void 0?Promise.resolve(h):l(u,d)}}},oF=(t,e,n,r,i,o)=>s=>(a,c)=>{const l=t.get(a);if(l===void 0){if(!s&&o(a)){const u=r(a),{outputs:d}=n(a);for(const h of d)if(md(h)){const f=r(h[0]);e(u,f,h[1],h[2])}else{const f=i(h[0]);u.disconnect(f,h[1])}}t.set(a,c)}else t.set(a,l+c)},sF=t=>e=>t!==null&&e instanceof t,aF=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,cF=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,lF=(t,e)=>n=>t(n)||e(n),uF=t=>e=>t!==null&&e instanceof t,dF=t=>t!==null&&t.isSecureContext,hF=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),c=e(a,s);if(r(a))throw TypeError();super(o,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},fF={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},pF=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o);if(r(a))throw new TypeError;const c={...fF,...s},l=e(a,c);super(o,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},gF=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),c=e(a,s);if(r(a))throw new TypeError;super(o,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},mF=(t,e,n)=>class extends t{constructor(i,o){const s=n(i),a=e(s,o);super(i,!0,a,null)}},vF=(t,e,n,r,i,o)=>class extends n{constructor(a,c){super(a),this._nativeContext=a,wE.set(this,a),r(a)&&i.set(a,new Set),this._destination=new t(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?o(this,a):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},pv=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},yF=(t,e)=>(n,r,i)=>{const o=new Set;return n.connect=(s=>(a,c=0,l=0)=>{const u=o.size===0;if(e(a))return s.call(n,a,c,l),t(o,[a,c,l],d=>d[0]===a&&d[1]===c&&d[2]===l,!0),u&&r(),a;s.call(n,a,c),t(o,[a,c],d=>d[0]===a&&d[1]===c,!0),u&&r()})(n.connect),n.disconnect=(s=>(a,c,l)=>{const u=o.size>0;if(a===void 0)s.apply(n),o.clear();else if(typeof a=="number"){s.call(n,a);for(const h of o)h[1]===a&&o.delete(h)}else{e(a)?s.call(n,a,c,l):s.call(n,a,c);for(const h of o)h[0]===a&&(c===void 0||h[1]===c)&&(l===void 0||h[2]===l)&&o.delete(h)}const d=o.size===0;u&&d&&i()})(n.disconnect),n},St=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n]&&(t[n]=r)},Ht=(t,e)=>{St(t,e,"channelCount"),St(t,e,"channelCountMode"),St(t,e,"channelInterpretation")},fb=t=>typeof t.getFloatTimeDomainData=="function",CF=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const r=Math.max(n.length,t.fftSize);for(let i=0;i<r;i+=1)e[i]=(n[i]-128)*.0078125;return e}},IF=(t,e)=>(n,r)=>{const i=n.createAnalyser();if(Ht(i,r),!(r.maxDecibels>r.minDecibels))throw e();return St(i,r,"fftSize"),St(i,r,"maxDecibels"),St(i,r,"minDecibels"),St(i,r,"smoothingTimeConstant"),t(fb,()=>fb(i))||CF(i),i},SF=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,Pt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n].value&&(t[n].value=r)},bF=t=>{t.start=(e=>{let n=!1;return(r=0,i=0,o)=>{if(n)throw un();e.call(t,r,i,o),n=!0}})(t.start)},Oy=t=>{t.start=(e=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,i)})(t.start)},Dy=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},wF=(t,e,n,r,i,o,s,a,c,l,u)=>(d,h)=>{const f=d.createBufferSource();return Ht(f,h),Pt(f,h,"playbackRate"),St(f,h,"buffer"),St(f,h,"loop"),St(f,h,"loopEnd"),St(f,h,"loopStart"),e(n,()=>n(d))||bF(f),e(r,()=>r(d))||c(f),e(i,()=>i(d))||l(f,d),e(o,()=>o(d))||Oy(f),e(s,()=>s(d))||u(f,d),e(a,()=>a(d))||Dy(f),t(d,f),f},AF=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,kF=(t,e)=>(n,r,i)=>{const o=n.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}i&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const s=t(n,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(s,"channelCount",a=>()=>a.call(s),a=>c=>{a.call(s,c);try{o.channelCount=c}catch(l){if(c>o.maxChannelCount)throw l}}),e(s,"channelCountMode",a=>()=>a.call(s),a=>c=>{a.call(s,c),o.channelCountMode=c}),e(s,"channelInterpretation",a=>()=>a.call(s),a=>c=>{a.call(s,c),o.channelInterpretation=c}),Object.defineProperty(s,"maxChannelCount",{get:()=>o.maxChannelCount}),s.connect(o),s},EF=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,TF=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},xF=(t,e,n,r,i)=>(o,s,a,c,l,u)=>{if(a!==null)try{const d=new a(o,c,u),h=new Map;let f=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>f,set:p=>{typeof f=="function"&&d.removeEventListener("processorerror",f),f=typeof p=="function"?p:null,typeof f=="function"&&d.addEventListener("processorerror",f)}}}),d.addEventListener=(p=>(...m)=>{if(m[0]==="processorerror"){const C=typeof m[1]=="function"?m[1]:typeof m[1]=="object"&&m[1]!==null&&typeof m[1].handleEvent=="function"?m[1].handleEvent:null;if(C!==null){const g=h.get(m[1]);g!==void 0?m[1]=g:(m[1]=y=>{y.type==="error"?(Object.defineProperties(y,{type:{value:"processorerror"}}),C(y)):C(new ErrorEvent(m[0],{...y}))},h.set(C,m[1]))}}return p.call(d,"error",m[1],m[2]),p.call(d,...m)})(d.addEventListener),d.removeEventListener=(p=>(...m)=>{if(m[0]==="processorerror"){const C=h.get(m[1]);C!==void 0&&(h.delete(m[1]),m[1]=C)}return p.call(d,"error",m[1],m[2]),p.call(d,m[0],m[1],m[2])})(d.removeEventListener),u.numberOfOutputs!==0){const p=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(p).connect(o.destination),i(d,()=>p.disconnect(),()=>p.connect(o.destination))}return d}catch(d){throw d.code===11?r():d}if(l===void 0)throw r();return TF(u),e(o,s,l,u)},LE=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),PF=t=>new Promise((e,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:o})=>{r.close(),i.close(),e(o)},r.onmessageerror=({data:o})=>{r.close(),i.close(),n(o)},i.postMessage(t)}),RF=async(t,e)=>{const n=await PF(e);return new t(n)},NF=(t,e,n,r)=>{let i=uv.get(t);i===void 0&&(i=new WeakMap,uv.set(t,i));const o=RF(n,r);return i.set(e,o),o},_F=(t,e,n,r,i,o,s,a,c,l,u,d,h)=>(f,p,m,C)=>{if(C.numberOfInputs===0&&C.numberOfOutputs===0)throw c();const g=Array.isArray(C.outputChannelCount)?C.outputChannelCount:Array.from(C.outputChannelCount);if(g.some(ae=>ae<1))throw c();if(g.length!==C.numberOfOutputs)throw e();if(C.channelCountMode!=="explicit")throw c();const y=C.channelCount*C.numberOfInputs,S=g.reduce((ae,ue)=>ae+ue,0),E=m.parameterDescriptors===void 0?0:m.parameterDescriptors.length;if(y+E>6||S>6)throw c();const A=new MessageChannel,P=[],w=[];for(let ae=0;ae<C.numberOfInputs;ae+=1)P.push(s(f,{channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation,gain:1})),w.push(i(f,{channelCount:C.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:C.channelCount}));const T=[];if(m.parameterDescriptors!==void 0)for(const{defaultValue:ae,maxValue:ue,minValue:ze,name:Ve}of m.parameterDescriptors){const Pe=o(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:C.parameterData[Ve]!==void 0?C.parameterData[Ve]:ae===void 0?0:ae});Object.defineProperties(Pe.offset,{defaultValue:{get:()=>ae===void 0?0:ae},maxValue:{get:()=>ue===void 0?Mn:ue},minValue:{get:()=>ze===void 0?Yn:ze}}),T.push(Pe)}const _=r(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+E)}),M=LE(p,f.sampleRate),D=a(f,M,y+E,Math.max(1,S)),B=i(f,{channelCount:Math.max(1,S),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,S)}),j=[];for(let ae=0;ae<C.numberOfOutputs;ae+=1)j.push(r(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[ae]}));for(let ae=0;ae<C.numberOfInputs;ae+=1){P[ae].connect(w[ae]);for(let ue=0;ue<C.channelCount;ue+=1)w[ae].connect(_,ue,ae*C.channelCount+ue)}const Z=new ME(m.parameterDescriptors===void 0?[]:m.parameterDescriptors.map(({name:ae},ue)=>{const ze=T[ue];return ze.connect(_,0,y+ue),ze.start(0),[ae,ze.offset]}));_.connect(D);let z=C.channelInterpretation,q=null;const oe=C.numberOfOutputs===0?[D]:j,W={get bufferSize(){return M},get channelCount(){return C.channelCount},set channelCount(ae){throw n()},get channelCountMode(){return C.channelCountMode},set channelCountMode(ae){throw n()},get channelInterpretation(){return z},set channelInterpretation(ae){for(const ue of P)ue.channelInterpretation=ae;z=ae},get context(){return D.context},get inputs(){return P},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get onprocessorerror(){return q},set onprocessorerror(ae){typeof q=="function"&&W.removeEventListener("processorerror",q),q=typeof ae=="function"?ae:null,typeof q=="function"&&W.addEventListener("processorerror",q)},get parameters(){return Z},get port(){return A.port2},addEventListener(...ae){return D.addEventListener(ae[0],ae[1],ae[2])},connect:t.bind(null,oe),disconnect:l.bind(null,oe),dispatchEvent(...ae){return D.dispatchEvent(ae[0])},removeEventListener(...ae){return D.removeEventListener(ae[0],ae[1],ae[2])}},Y=new Map;A.port1.addEventListener=(ae=>(...ue)=>{if(ue[0]==="message"){const ze=typeof ue[1]=="function"?ue[1]:typeof ue[1]=="object"&&ue[1]!==null&&typeof ue[1].handleEvent=="function"?ue[1].handleEvent:null;if(ze!==null){const Ve=Y.get(ue[1]);Ve!==void 0?ue[1]=Ve:(ue[1]=Pe=>{u(f.currentTime,f.sampleRate,()=>ze(Pe))},Y.set(ze,ue[1]))}}return ae.call(A.port1,ue[0],ue[1],ue[2])})(A.port1.addEventListener),A.port1.removeEventListener=(ae=>(...ue)=>{if(ue[0]==="message"){const ze=Y.get(ue[1]);ze!==void 0&&(Y.delete(ue[1]),ue[1]=ze)}return ae.call(A.port1,ue[0],ue[1],ue[2])})(A.port1.removeEventListener);let re=null;Object.defineProperty(A.port1,"onmessage",{get:()=>re,set:ae=>{typeof re=="function"&&A.port1.removeEventListener("message",re),re=typeof ae=="function"?ae:null,typeof re=="function"&&(A.port1.addEventListener("message",re),A.port1.start())}}),m.prototype.port=A.port1;let H=null;NF(f,W,m,C).then(ae=>H=ae);const Ee=Rf(C.numberOfInputs,C.channelCount),Le=Rf(C.numberOfOutputs,g),ve=m.parameterDescriptors===void 0?[]:m.parameterDescriptors.reduce((ae,{name:ue})=>({...ae,[ue]:new Float32Array(128)}),{});let ke=!0;const je=()=>{C.numberOfOutputs>0&&D.disconnect(B);for(let ae=0,ue=0;ae<C.numberOfOutputs;ae+=1){const ze=j[ae];for(let Ve=0;Ve<g[ae];Ve+=1)B.disconnect(ze,ue+Ve,Ve);ue+=g[ae]}},he=new Map;D.onaudioprocess=({inputBuffer:ae,outputBuffer:ue})=>{if(H!==null){const ze=d(W);for(let Ve=0;Ve<M;Ve+=128){for(let Pe=0;Pe<C.numberOfInputs;Pe+=1)for(let $e=0;$e<C.channelCount;$e+=1)Pf(ae,Ee[Pe],$e,$e,Ve);m.parameterDescriptors!==void 0&&m.parameterDescriptors.forEach(({name:Pe},$e)=>{Pf(ae,ve,Pe,y+$e,Ve)});for(let Pe=0;Pe<C.numberOfInputs;Pe+=1)for(let $e=0;$e<g[Pe];$e+=1)Le[Pe][$e].byteLength===0&&(Le[Pe][$e]=new Float32Array(128));try{const Pe=Ee.map((Bt,ut)=>{if(ze[ut].size>0)return he.set(ut,M/128),Bt;const os=he.get(ut);return os===void 0?[]:(Bt.every(Hn=>Hn.every(Pr=>Pr===0))&&(os===1?he.delete(ut):he.set(ut,os-1)),Bt)});ke=u(f.currentTime+Ve/f.sampleRate,f.sampleRate,()=>H.process(Pe,Le,ve));for(let Bt=0,ut=0;Bt<C.numberOfOutputs;Bt+=1){for(let xn=0;xn<g[Bt];xn+=1)OE(ue,Le[Bt],xn,ut+xn,Ve);ut+=g[Bt]}}catch(Pe){ke=!1,W.dispatchEvent(new ErrorEvent("processorerror",{colno:Pe.colno,filename:Pe.filename,lineno:Pe.lineno,message:Pe.message}))}if(!ke){for(let Pe=0;Pe<C.numberOfInputs;Pe+=1){P[Pe].disconnect(w[Pe]);for(let $e=0;$e<C.channelCount;$e+=1)w[Ve].disconnect(_,$e,Pe*C.channelCount+$e)}if(m.parameterDescriptors!==void 0){const Pe=m.parameterDescriptors.length;for(let $e=0;$e<Pe;$e+=1){const Bt=T[$e];Bt.disconnect(_,0,y+$e),Bt.stop()}}_.disconnect(D),D.onaudioprocess=null,Tn?je():it();break}}}};let Tn=!1;const zn=s(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Tr=()=>D.connect(zn).connect(f.destination),it=()=>{D.disconnect(zn),zn.disconnect()},vn=()=>{if(ke){it(),C.numberOfOutputs>0&&D.connect(B);for(let ae=0,ue=0;ae<C.numberOfOutputs;ae+=1){const ze=j[ae];for(let Ve=0;Ve<g[ae];Ve+=1)B.connect(ze,ue+Ve,Ve);ue+=g[ae]}}Tn=!0},xr=()=>{ke&&(Tr(),je()),Tn=!1};return Tr(),h(W,vn,xr)},BE=(t,e)=>{const n=t.createBiquadFilter();return Ht(n,e),Pt(n,e,"Q"),Pt(n,e,"detune"),Pt(n,e,"frequency"),Pt(n,e,"gain"),St(n,e,"type"),n},MF=(t,e)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,i),Ht(i,r),i},OF=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw un()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw un()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw un()}})},vd=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Ht(n,e),OF(n),n},DF=(t,e,n,r,i)=>(o,s)=>{if(o.createConstantSource===void 0)return n(o,s);const a=o.createConstantSource();return Ht(a,s),Pt(a,s,"offset"),e(r,()=>r(o))||Oy(a),e(i,()=>i(o))||Dy(a),t(o,a),a},fl=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),LF=(t,e,n,r)=>(i,{offset:o,...s})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(i,{...s,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const d={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(p){l.channelCount=p},get channelCountMode(){return l.channelCountMode},set channelCountMode(p){l.channelCountMode=p},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(p){l.channelInterpretation=p},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(p){c.onended=p},addEventListener(...p){return c.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return c.dispatchEvent(p[0])},removeEventListener(...p){return c.removeEventListener(p[0],p[1],p[2])},start(p=0){c.start.call(c,p)},stop(p=0){c.stop.call(c,p)}},h=()=>c.connect(l),f=()=>c.disconnect(l);return t(i,c),r(fl(d,l),h,f)},BF=(t,e)=>(n,r)=>{const i=n.createConvolver();if(Ht(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),St(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",o=>()=>o.call(i),o=>s=>{if(s>2)throw t();return o.call(i,s)}),r.channelCountMode==="max"))throw t();return e(i,"channelCountMode",o=>()=>o.call(i),o=>s=>{if(s==="max")throw t();return o.call(i,s)}),i},FE=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Ht(n,e),Pt(n,e,"delayTime"),n},FF=t=>(e,n)=>{const r=e.createDynamicsCompressor();if(Ht(r,n),n.channelCount>2||n.channelCountMode==="max")throw t();return Pt(r,n,"attack"),Pt(r,n,"knee"),Pt(r,n,"ratio"),Pt(r,n,"release"),Pt(r,n,"threshold"),r},or=(t,e)=>{const n=t.createGain();return Ht(n,e),Pt(n,e,"gain"),n},UF=t=>(e,n,r)=>{if(e.createIIRFilter===void 0)return t(e,n,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return Ht(i,r),i};function VF(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function GF(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function pb(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)n=GF(n,e),n[0]+=t[r];return n}const WF=(t,e,n,r)=>(i,o,{channelCount:s,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const d=LE(o,i.sampleRate),h=l instanceof Float64Array?l:new Float64Array(l),f=u instanceof Float64Array?u:new Float64Array(u),p=h.length,m=f.length,C=Math.min(p,m);if(p===0||p>20)throw r();if(h[0]===0)throw e();if(m===0||m>20)throw r();if(f[0]===0)throw e();if(h[0]!==1){for(let T=0;T<m;T+=1)f[T]/=h[0];for(let T=1;T<p;T+=1)h[T]/=h[0]}const g=n(i,d,s,s);g.channelCount=s,g.channelCountMode=a,g.channelInterpretation=c;const y=32,S=[],E=[],A=[];for(let T=0;T<s;T+=1){S.push(0);const _=new Float32Array(y),M=new Float32Array(y);_.fill(0),M.fill(0),E.push(_),A.push(M)}g.onaudioprocess=T=>{const _=T.inputBuffer,M=T.outputBuffer,D=_.numberOfChannels;for(let B=0;B<D;B+=1){const j=_.getChannelData(B),Z=M.getChannelData(B);S[B]=DE(h,p,f,m,C,E[B],A[B],S[B],y,j,Z)}};const P=i.sampleRate/2;return fl({get bufferSize(){return d},get channelCount(){return g.channelCount},set channelCount(T){g.channelCount=T},get channelCountMode(){return g.channelCountMode},set channelCountMode(T){g.channelCountMode=T},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(T){g.channelInterpretation=T},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener(...T){return g.addEventListener(T[0],T[1],T[2])},dispatchEvent(...T){return g.dispatchEvent(T[0])},getFrequencyResponse(T,_,M){if(T.length!==_.length||_.length!==M.length)throw t();const D=T.length;for(let B=0;B<D;B+=1){const j=-Math.PI*(T[B]/P),Z=[Math.cos(j),Math.sin(j)],z=pb(f,Z),q=pb(h,Z),oe=VF(z,q);_[B]=Math.sqrt(oe[0]*oe[0]+oe[1]*oe[1]),M[B]=Math.atan2(oe[1],oe[0])}},removeEventListener(...T){return g.removeEventListener(T[0],T[1],T[2])}},g)},jF=(t,e)=>t.createMediaElementSource(e.mediaElement),ZF=(t,e)=>{const n=t.createMediaStreamDestination();return Ht(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},zF=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((o,s)=>o.id<s.id?-1:o.id>s.id?1:0);const r=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},HF=(t,e)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),o=n.createMediaStreamSource(i);if(r.kind!=="audio")throw t();if(e(n))throw new TypeError;return o},XF=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,$F=(t,e,n,r,i,o)=>(s,a)=>{const c=s.createOscillator();return Ht(c,a),Pt(c,a,"detune"),Pt(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):St(c,a,"type"),e(n,()=>n(s))||Oy(c),e(r,()=>r(s))||o(c,s),e(i,()=>i(s))||Dy(c),t(s,c),c},KF=t=>(e,n)=>{const r=e.createPanner();return r.orientationX===void 0?t(e,n):(Ht(r,n),Pt(r,n,"orientationX"),Pt(r,n,"orientationY"),Pt(r,n,"orientationZ"),Pt(r,n,"positionX"),Pt(r,n,"positionY"),Pt(r,n,"positionZ"),St(r,n,"coneInnerAngle"),St(r,n,"coneOuterAngle"),St(r,n,"coneOuterGain"),St(r,n,"distanceModel"),St(r,n,"maxDistance"),St(r,n,"panningModel"),St(r,n,"refDistance"),St(r,n,"rolloffFactor"),r)},JF=(t,e,n,r,i,o,s,a,c,l)=>(u,{coneInnerAngle:d,coneOuterAngle:h,coneOuterGain:f,distanceModel:p,maxDistance:m,orientationX:C,orientationY:g,orientationZ:y,panningModel:S,positionX:E,positionY:A,positionZ:P,refDistance:w,rolloffFactor:T,..._})=>{const M=u.createPanner();if(_.channelCount>2||_.channelCountMode==="max")throw s();Ht(M,_);const D={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},B=n(u,{...D,channelInterpretation:"speakers",numberOfInputs:6}),j=r(u,{..._,gain:1}),Z=r(u,{...D,gain:1}),z=r(u,{...D,gain:0}),q=r(u,{...D,gain:0}),oe=r(u,{...D,gain:0}),W=r(u,{...D,gain:0}),Y=r(u,{...D,gain:0}),re=i(u,256,6,1),H=o(u,{...D,curve:new Float32Array([1,1]),oversample:"none"});let te=[C,g,y],Ee=[E,A,P];const Le=new Float32Array(1);re.onaudioprocess=({inputBuffer:he})=>{const Tn=[c(he,Le,0),c(he,Le,1),c(he,Le,2)];Tn.some((Tr,it)=>Tr!==te[it])&&(M.setOrientation(...Tn),te=Tn);const zn=[c(he,Le,3),c(he,Le,4),c(he,Le,5)];zn.some((Tr,it)=>Tr!==Ee[it])&&(M.setPosition(...zn),Ee=zn)},Object.defineProperty(z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(oe.gain,"defaultValue",{get:()=>0}),Object.defineProperty(W.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Y.gain,"defaultValue",{get:()=>0});const ve={get bufferSize(){},get channelCount(){return M.channelCount},set channelCount(he){if(he>2)throw s();j.channelCount=he,M.channelCount=he},get channelCountMode(){return M.channelCountMode},set channelCountMode(he){if(he==="max")throw s();j.channelCountMode=he,M.channelCountMode=he},get channelInterpretation(){return M.channelInterpretation},set channelInterpretation(he){j.channelInterpretation=he,M.channelInterpretation=he},get coneInnerAngle(){return M.coneInnerAngle},set coneInnerAngle(he){M.coneInnerAngle=he},get coneOuterAngle(){return M.coneOuterAngle},set coneOuterAngle(he){M.coneOuterAngle=he},get coneOuterGain(){return M.coneOuterGain},set coneOuterGain(he){if(he<0||he>1)throw e();M.coneOuterGain=he},get context(){return M.context},get distanceModel(){return M.distanceModel},set distanceModel(he){M.distanceModel=he},get inputs(){return[j]},get maxDistance(){return M.maxDistance},set maxDistance(he){if(he<0)throw new RangeError;M.maxDistance=he},get numberOfInputs(){return M.numberOfInputs},get numberOfOutputs(){return M.numberOfOutputs},get orientationX(){return Z.gain},get orientationY(){return z.gain},get orientationZ(){return q.gain},get panningModel(){return M.panningModel},set panningModel(he){M.panningModel=he},get positionX(){return oe.gain},get positionY(){return W.gain},get positionZ(){return Y.gain},get refDistance(){return M.refDistance},set refDistance(he){if(he<0)throw new RangeError;M.refDistance=he},get rolloffFactor(){return M.rolloffFactor},set rolloffFactor(he){if(he<0)throw new RangeError;M.rolloffFactor=he},addEventListener(...he){return j.addEventListener(he[0],he[1],he[2])},dispatchEvent(...he){return j.dispatchEvent(he[0])},removeEventListener(...he){return j.removeEventListener(he[0],he[1],he[2])}};d!==ve.coneInnerAngle&&(ve.coneInnerAngle=d),h!==ve.coneOuterAngle&&(ve.coneOuterAngle=h),f!==ve.coneOuterGain&&(ve.coneOuterGain=f),p!==ve.distanceModel&&(ve.distanceModel=p),m!==ve.maxDistance&&(ve.maxDistance=m),C!==ve.orientationX.value&&(ve.orientationX.value=C),g!==ve.orientationY.value&&(ve.orientationY.value=g),y!==ve.orientationZ.value&&(ve.orientationZ.value=y),S!==ve.panningModel&&(ve.panningModel=S),E!==ve.positionX.value&&(ve.positionX.value=E),A!==ve.positionY.value&&(ve.positionY.value=A),P!==ve.positionZ.value&&(ve.positionZ.value=P),w!==ve.refDistance&&(ve.refDistance=w),T!==ve.rolloffFactor&&(ve.rolloffFactor=T),(te[0]!==1||te[1]!==0||te[2]!==0)&&M.setOrientation(...te),(Ee[0]!==0||Ee[1]!==0||Ee[2]!==0)&&M.setPosition(...Ee);const ke=()=>{j.connect(M),t(j,H,0,0),H.connect(Z).connect(B,0,0),H.connect(z).connect(B,0,1),H.connect(q).connect(B,0,2),H.connect(oe).connect(B,0,3),H.connect(W).connect(B,0,4),H.connect(Y).connect(B,0,5),B.connect(re).connect(u.destination)},je=()=>{j.disconnect(M),a(j,H,0,0),H.disconnect(Z),Z.disconnect(B),H.disconnect(z),z.disconnect(B),H.disconnect(q),q.disconnect(B),H.disconnect(oe),oe.disconnect(B),H.disconnect(W),W.disconnect(B),H.disconnect(Y),Y.disconnect(B),B.disconnect(re),re.disconnect(u.destination)};return l(fl(ve,M),ke,je)},YF=t=>(e,{disableNormalization:n,imag:r,real:i})=>{const o=r instanceof Float32Array?r:new Float32Array(r),s=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(s,o,{disableNormalization:n});if(Array.from(r).length<2)throw t();return a},yd=(t,e,n,r)=>t.createScriptProcessor(e,n,r),QF=(t,e)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,r);const o=n.createStereoPanner();return Ht(o,r),Pt(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:s=>{if(s!==i)throw e()}}),o},qF=(t,e,n,r,i,o)=>{const a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},d=(p,m,C,g)=>{const y=new Float32Array(16385),S=new Float32Array(16385);for(let _=0;_<16385;_+=1){const M=_/16384*c;y[_]=Math.cos(M),S[_]=Math.sin(M)}const E=n(p,{...l,gain:0}),A=r(p,{...u,curve:y}),P=r(p,{...u,curve:a}),w=n(p,{...l,gain:0}),T=r(p,{...u,curve:S});return{connectGraph(){m.connect(E),m.connect(P.inputs===void 0?P:P.inputs[0]),m.connect(w),P.connect(C),C.connect(A.inputs===void 0?A:A.inputs[0]),C.connect(T.inputs===void 0?T:T.inputs[0]),A.connect(E.gain),T.connect(w.gain),E.connect(g,0,0),w.connect(g,0,1)},disconnectGraph(){m.disconnect(E),m.disconnect(P.inputs===void 0?P:P.inputs[0]),m.disconnect(w),P.disconnect(C),C.disconnect(A.inputs===void 0?A:A.inputs[0]),C.disconnect(T.inputs===void 0?T:T.inputs[0]),A.disconnect(E.gain),T.disconnect(w.gain),E.disconnect(g,0,0),w.disconnect(g,0,1)}}},h=(p,m,C,g)=>{const y=new Float32Array(16385),S=new Float32Array(16385),E=new Float32Array(16385),A=new Float32Array(16385),P=Math.floor(16385/2);for(let oe=0;oe<16385;oe+=1)if(oe>P){const W=(oe-P)/(16384-P)*c;y[oe]=Math.cos(W),S[oe]=Math.sin(W),E[oe]=0,A[oe]=1}else{const W=oe/(16384-P)*c;y[oe]=1,S[oe]=0,E[oe]=Math.cos(W),A[oe]=Math.sin(W)}const w=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),T=n(p,{...l,gain:0}),_=r(p,{...u,curve:y}),M=n(p,{...l,gain:0}),D=r(p,{...u,curve:S}),B=r(p,{...u,curve:a}),j=n(p,{...l,gain:0}),Z=r(p,{...u,curve:E}),z=n(p,{...l,gain:0}),q=r(p,{...u,curve:A});return{connectGraph(){m.connect(w),m.connect(B.inputs===void 0?B:B.inputs[0]),w.connect(T,0),w.connect(M,0),w.connect(j,1),w.connect(z,1),B.connect(C),C.connect(_.inputs===void 0?_:_.inputs[0]),C.connect(D.inputs===void 0?D:D.inputs[0]),C.connect(Z.inputs===void 0?Z:Z.inputs[0]),C.connect(q.inputs===void 0?q:q.inputs[0]),_.connect(T.gain),D.connect(M.gain),Z.connect(j.gain),q.connect(z.gain),T.connect(g,0,0),j.connect(g,0,0),M.connect(g,0,1),z.connect(g,0,1)},disconnectGraph(){m.disconnect(w),m.disconnect(B.inputs===void 0?B:B.inputs[0]),w.disconnect(T,0),w.disconnect(M,0),w.disconnect(j,1),w.disconnect(z,1),B.disconnect(C),C.disconnect(_.inputs===void 0?_:_.inputs[0]),C.disconnect(D.inputs===void 0?D:D.inputs[0]),C.disconnect(Z.inputs===void 0?Z:Z.inputs[0]),C.disconnect(q.inputs===void 0?q:q.inputs[0]),_.disconnect(T.gain),D.disconnect(M.gain),Z.disconnect(j.gain),q.disconnect(z.gain),T.disconnect(g,0,0),j.disconnect(g,0,0),M.disconnect(g,0,1),z.disconnect(g,0,1)}}},f=(p,m,C,g,y)=>{if(m===1)return d(p,C,g,y);if(m===2)return h(p,C,g,y);throw i()};return(p,{channelCount:m,channelCountMode:C,pan:g,...y})=>{if(C==="max")throw i();const S=t(p,{...y,channelCount:1,channelCountMode:C,numberOfInputs:2}),E=n(p,{...y,channelCount:m,channelCountMode:C,gain:1}),A=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:g});let{connectGraph:P,disconnectGraph:w}=f(p,m,E,A,S);Object.defineProperty(A.gain,"defaultValue",{get:()=>0}),Object.defineProperty(A.gain,"maxValue",{get:()=>1}),Object.defineProperty(A.gain,"minValue",{get:()=>-1});const T={get bufferSize(){},get channelCount(){return E.channelCount},set channelCount(B){E.channelCount!==B&&(_&&w(),{connectGraph:P,disconnectGraph:w}=f(p,B,E,A,S),_&&P()),E.channelCount=B},get channelCountMode(){return E.channelCountMode},set channelCountMode(B){if(B==="clamped-max"||B==="max")throw i();E.channelCountMode=B},get channelInterpretation(){return E.channelInterpretation},set channelInterpretation(B){E.channelInterpretation=B},get context(){return E.context},get inputs(){return[E]},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get pan(){return A.gain},addEventListener(...B){return E.addEventListener(B[0],B[1],B[2])},dispatchEvent(...B){return E.dispatchEvent(B[0])},removeEventListener(...B){return E.removeEventListener(B[0],B[1],B[2])}};let _=!1;const M=()=>{P(),_=!0},D=()=>{w(),_=!1};return o(fl(T,S),M,D)}},e3=(t,e,n,r,i,o,s)=>(a,c)=>{const l=a.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,c);Ht(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();St(l,{curve:u},"curve"),St(l,c,"oversample");let d=null,h=!1;return s(l,"curve",m=>()=>m.call(l),m=>C=>(m.call(l,C),h&&(r(C)&&d===null?d=t(a,l):!r(C)&&d!==null&&(d(),d=null)),C)),i(l,()=>{h=!0,r(l.curve)&&(d=t(a,l))},()=>{h=!1,d!==null&&(d(),d=null)})},t3=(t,e,n,r,i)=>(o,{curve:s,oversample:a,...c})=>{const l=o.createWaveShaper(),u=o.createWaveShaper();Ht(l,c),Ht(u,c);const d=n(o,{...c,gain:1}),h=n(o,{...c,gain:-1}),f=n(o,{...c,gain:1}),p=n(o,{...c,gain:-1});let m=null,C=!1,g=null;const y={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(A){d.channelCount=A,h.channelCount=A,l.channelCount=A,f.channelCount=A,u.channelCount=A,p.channelCount=A},get channelCountMode(){return l.channelCountMode},set channelCountMode(A){d.channelCountMode=A,h.channelCountMode=A,l.channelCountMode=A,f.channelCountMode=A,u.channelCountMode=A,p.channelCountMode=A},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(A){d.channelInterpretation=A,h.channelInterpretation=A,l.channelInterpretation=A,f.channelInterpretation=A,u.channelInterpretation=A,p.channelInterpretation=A},get context(){return l.context},get curve(){return g},set curve(A){if(A!==null&&A.length<2)throw e();if(A===null)l.curve=A,u.curve=A;else{const P=A.length,w=new Float32Array(P+2-P%2),T=new Float32Array(P+2-P%2);w[0]=A[0],T[0]=-A[P-1];const _=Math.ceil((P+1)/2),M=(P+1)/2-1;for(let D=1;D<_;D+=1){const B=D/_*M,j=Math.floor(B),Z=Math.ceil(B);w[D]=j===Z?A[j]:(1-(B-j))*A[j]+(1-(Z-B))*A[Z],T[D]=j===Z?-A[P-1-j]:-((1-(B-j))*A[P-1-j])-(1-(Z-B))*A[P-1-Z]}w[_]=P%2===1?A[_-1]:(A[_-2]+A[_-1])/2,l.curve=w,u.curve=T}g=A,C&&(r(g)&&m===null?m=t(o,d):m!==null&&(m(),m=null))},get inputs(){return[d]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(A){l.oversample=A,u.oversample=A},addEventListener(...A){return d.addEventListener(A[0],A[1],A[2])},dispatchEvent(...A){return d.dispatchEvent(A[0])},removeEventListener(...A){return d.removeEventListener(A[0],A[1],A[2])}};s!==null&&(y.curve=s instanceof Float32Array?s:new Float32Array(s)),a!==y.oversample&&(y.oversample=a);const S=()=>{d.connect(l).connect(f),d.connect(h).connect(u).connect(p).connect(f),C=!0,r(g)&&(m=t(o,d))},E=()=>{d.disconnect(l),l.disconnect(f),d.disconnect(h),h.disconnect(u),u.disconnect(p),p.disconnect(f),C=!1,m!==null&&(m(),m=null)};return i(fl(y,f),S,E)},sr=()=>new DOMException("","NotSupportedError"),n3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},r3=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...n3,...l},h=n(u,d),f=o(u),p=f?r():null,m=c.sampleRate/2;super(c,!1,h,p),this._detune=e(this,f,h.detune,153600,-153600),this._frequency=e(this,f,h.frequency,m,-m),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?s(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){qc(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),Wo(this)&&pd(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},i3=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null,c=null;const l=async(u,d)=>{let h=n(u);const f=En(h,d);if(!f){const p={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:s===null?void 0:s,type:h.type};h=e(d,p),a!==null&&h.start(a),c!==null&&h.stop(c)}return o.set(d,h),f?(await t(d,u.detune,h.detune),await t(d,u.frequency,h.frequency)):(await r(d,u.detune,h.detune),await r(d,u.frequency,h.frequency)),await i(u,d,h),h};return{set periodicWave(u){s=u},set start(u){a=u},set stop(u){c=u},render(u,d){const h=o.get(d);return h!==void 0?Promise.resolve(h):l(u,d)}}},o3={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},s3=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...o3,...l},h=n(u,d),f=o(u),p=f?r():null;super(c,!1,h,p),this._nativePannerNode=h,this._orientationX=e(this,f,h.orientationX,Mn,Yn),this._orientationY=e(this,f,h.orientationY,Mn,Yn),this._orientationZ=e(this,f,h.orientationZ,Mn,Yn),this._positionX=e(this,f,h.positionX,Mn,Yn),this._positionY=e(this,f,h.positionY,Mn,Yn),this._positionZ=e(this,f,h.positionZ,Mn,Yn),s(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},a3=(t,e,n,r,i,o,s,a,c,l)=>()=>{const u=new WeakMap;let d=null;const h=async(f,p)=>{let m=null,C=o(f);const g={channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation},y={...g,coneInnerAngle:C.coneInnerAngle,coneOuterAngle:C.coneOuterAngle,coneOuterGain:C.coneOuterGain,distanceModel:C.distanceModel,maxDistance:C.maxDistance,panningModel:C.panningModel,refDistance:C.refDistance,rolloffFactor:C.rolloffFactor},S=En(C,p);if("bufferSize"in C)m=r(p,{...g,gain:1});else if(!S){const E={...y,orientationX:C.orientationX.value,orientationY:C.orientationY.value,orientationZ:C.orientationZ.value,positionX:C.positionX.value,positionY:C.positionY.value,positionZ:C.positionZ.value};C=i(p,E)}if(u.set(p,m===null?C:m),m!==null){if(d===null){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const D=new s(6,f.context.length,p.sampleRate),B=e(D,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});B.connect(D.destination),d=(async()=>{const j=await Promise.all([f.orientationX,f.orientationY,f.orientationZ,f.positionX,f.positionY,f.positionZ].map(async(Z,z)=>{const q=n(D,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:z===0?1:0});return await a(D,Z,q.offset),q}));for(let Z=0;Z<6;Z+=1)j[Z].connect(B,0,Z),j[Z].start(0);return l(D)})()}const E=await d,A=r(p,{...g,gain:1});await c(f,p,A);const P=[];for(let D=0;D<E.numberOfChannels;D+=1)P.push(E.getChannelData(D));let w=[P[0][0],P[1][0],P[2][0]],T=[P[3][0],P[4][0],P[5][0]],_=r(p,{...g,gain:1}),M=i(p,{...y,orientationX:w[0],orientationY:w[1],orientationZ:w[2],positionX:T[0],positionY:T[1],positionZ:T[2]});A.connect(_).connect(M.inputs[0]),M.connect(m);for(let D=128;D<E.length;D+=128){const B=[P[0][D],P[1][D],P[2][D]],j=[P[3][D],P[4][D],P[5][D]];if(B.some((Z,z)=>Z!==w[z])||j.some((Z,z)=>Z!==T[z])){w=B,T=j;const Z=D/p.sampleRate;_.gain.setValueAtTime(0,Z),_=r(p,{...g,gain:0}),M=i(p,{...y,orientationX:w[0],orientationY:w[1],orientationZ:w[2],positionX:T[0],positionY:T[1],positionZ:T[2]}),_.gain.setValueAtTime(1,Z),A.connect(_).connect(M.inputs[0]),M.connect(m)}}return m}return S?(await t(p,f.orientationX,C.orientationX),await t(p,f.orientationY,C.orientationY),await t(p,f.orientationZ,C.orientationZ),await t(p,f.positionX,C.positionX),await t(p,f.positionY,C.positionY),await t(p,f.positionZ,C.positionZ)):(await a(p,f.orientationX,C.orientationX),await a(p,f.orientationY,C.orientationY),await a(p,f.orientationZ,C.orientationZ),await a(p,f.positionX,C.positionX),await a(p,f.positionY,C.positionY),await a(p,f.positionZ,C.positionZ)),hl(C)?await c(f,p,C.inputs[0]):await c(f,p,C),C};return{render(f,p){const m=u.get(p);return m!==void 0?Promise.resolve(m):h(f,p)}}},c3={disableNormalization:!1},l3=(t,e,n,r)=>class UE{constructor(o,s){const a=e(o),c=r({...c3,...s}),l=t(a,c);return n.add(l),l}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===UE.prototype||n.has(o)}},u3=(t,e)=>(n,r,i)=>(t(r).replay(i),e(r,n,i)),d3=(t,e,n)=>async(r,i,o)=>{const s=t(r);await Promise.all(s.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{const h=await e(l).render(l,i),f=r.context.destination;!n(l)&&(r!==f||!n(r))&&h.connect(o,u,c)})).reduce((a,c)=>[...a,...c],[]))},h3=(t,e,n)=>async(r,i,o)=>{const s=e(r);await Promise.all(Array.from(s.activeInputs).map(async([a,c])=>{const u=await t(a).render(a,i);n(a)||u.connect(o,c)}))},f3=(t,e,n,r)=>i=>t(pv,()=>pv(i))?Promise.resolve(t(r,r)).then(o=>{if(!o){const s=n(i,512,0,1);i.oncomplete=()=>{s.onaudioprocess=null,s.disconnect()},s.onaudioprocess=()=>i.currentTime,s.connect(i.destination)}return i.startRendering()}):new Promise(o=>{const s=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{s.disconnect(),o(a.renderedBuffer)},s.connect(i.destination),i.startRendering()}),p3=t=>(e,n)=>{t.set(e,n)},g3=t=>(e,n)=>t.set(e,n),m3={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},v3=(t,e,n,r,i,o)=>class extends t{constructor(a,c){const l=i(a),u={...m3,...c},d=n(l,u),h=o(l),f=h?r():null;super(a,!1,d,f),this._pan=e(this,h,d.pan)}get pan(){return this._pan}},y3=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,c)=>{let l=n(a);const u=En(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,d)}return o.set(c,l),u?await t(c,a.pan,l.pan):await r(c,a.pan,l.pan),hl(l)?await i(a,c,l.inputs[0]):await i(a,c,l),l};return{render(a,c){const l=o.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}},C3=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},I3=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(n);let o=!1,s=!1;try{await r.audioWorklet.addModule(i);const a=new t(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>o=!0,a.onprocessorerror=()=>s=!0,c.connect(a),c.start(0),await r.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(i)}return o&&!s},S3=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},b3=()=>new DOMException("","UnknownError"),w3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},A3=(t,e,n,r,i,o,s)=>class extends t{constructor(c,l){const u=i(c),d={...w3,...l},h=n(u,d),p=o(u)?r():null;super(c,!0,h,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=h,s(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},k3=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!En(a,s)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(s,l)}return r.set(s,a),hl(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},E3=()=>typeof window>"u"?null:window,T3=(t,e)=>n=>{n.copyFromChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<c&&d<u;d+=1)r[d]=l[d+s]},n.copyToChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<c&&d<u;d+=1)l[d+s]=r[d]}},x3=t=>e=>{e.copyFromChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyFromChannel),e.copyToChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyToChannel)},P3=t=>(e,n)=>{const r=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),t(e,"buffer",i=>()=>{const o=i.call(e);return o===r?null:o},i=>o=>i.call(e,o===null?r:o))},R3=(t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let c=0;c<a;c+=1)i.connect(r,0,c)},()=>i.disconnect(r))},VE=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),GE=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},Cd=(t,e,n,r)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:s}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(o),set:r(s)})},N3=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),_3=t=>({...t,channelCount:t.numberOfOutputs}),M3=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},WE=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(r){if(r.code!==9)throw r;WE(t,e,n+1e-7)}},O3=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},D3=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},L3=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},Ly=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},jE=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},By=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},B3=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},F3=t=>{t.start=(e=>(n=0,r=0,i)=>{const o=t.buffer,s=o===null?r:Math.min(o.duration,r);o!==null&&s>o.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,s,i)})(t.start)},ZE=(t,e)=>{const n=e.createGain();t.connect(n);const r=(i=>()=>{i.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),fl(t,n),t.stop=(i=>{let o=!1;return(s=0)=>{if(o)try{i.call(t,s)}catch{n.gain.setValueAtTime(0,s)}else i.call(t,s),o=!0}})(t.stop)},pl=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},U3=hL(za),V3=yL(za),G3=RB(Cp),zE=new WeakMap,W3=$B(zE),ns=aB(new Map,new WeakMap),Yi=E3(),HE=IF(ns,to),XE=XB(Ln),mn=d3(Ln,XE,Ma),j3=wL(HE,vt,mn),lt=YB(wE),Qs=XF(Yi),rt=uF(Qs),$E=new WeakMap,KE=VB(pl),Id=AF(Yi),JE=sF(Id),YE=aF(Yi),Z3=cF(Yi),zu=EF(Yi),Mt=KL(fL(CE),vL(U3,V3,Ef,G3,Tf,Ln,W3,fd,vt,za,Wo,Ma,Eh),ns,oF(cv,Tf,Ln,vt,Zu,Wo),to,Ip,sr,EB(Ef,cv,Ln,vt,Zu,lt,Wo,rt),MB($E,Ln,yi),KE,lt,JE,YE,Z3,rt,zu),z3=bL(Mt,j3,to,HE,lt,rt),QE=new WeakSet,gb=SF(Yi),qE=IB(new Uint32Array(1)),eT=T3(qE,to),tT=x3(qE),H3=kL(QE,ns,sr,gb,Qs,C3(gb),eT,tT),Sp=CL(or),nT=h3(XE,gd,Ma),no=pB(nT),gl=wF(Sp,ns,O3,D3,L3,Ly,jE,By,F3,P3(Cd),ZE),ro=u3(KB(gd),nT),X3=xL(no,gl,vt,ro,mn),Si=JL(pL(SE),$E,bE,YL,sL,aL,cL,lL,uL,ov,vE,Id,WE),$3=TL(Mt,X3,Si,un,gl,lt,rt,pl),K3=FL(Mt,UL,to,un,kF(or,Cd),lt,rt,mn),J3=sB(no,BE,vt,ro,mn),Ha=g3(zE),Y3=oB(Mt,Si,J3,Ip,BE,lt,rt,Ha),qs=yF(za,YE),Q3=R3(un,qs),ea=MF(Id,Q3),q3=uB(ea,vt,mn),e5=lB(Mt,q3,ea,lt,rt),t5=fB(vd,vt,mn),n5=hB(Mt,t5,vd,lt,rt,_3),r5=LF(Sp,gl,or,qs),ml=DF(Sp,ns,r5,Ly,By),i5=CB(no,ml,vt,ro,mn),o5=yB(Mt,Si,i5,ml,lt,rt,pl),rT=BF(sr,Cd),s5=wB(rT,vt,mn),a5=bB(Mt,s5,rT,lt,rt,Ha),c5=PB(no,FE,vt,ro,mn),l5=xB(Mt,Si,c5,FE,lt,rt,Ha),iT=FF(sr),u5=BB(no,iT,vt,ro,mn),d5=LB(Mt,Si,u5,iT,sr,lt,rt,Ha),h5=zB(no,or,vt,ro,mn),f5=ZB(Mt,Si,h5,or,lt,rt),p5=WF(Ip,un,yd,sr),Fy=f3(ns,or,yd,S3(or,Qs)),g5=iF(gl,vt,Qs,mn,Fy),m5=UF(p5),v5=nF(Mt,m5,g5,lt,rt,Ha),y5=VL(Si,ea,ml,yd,sr,VE,rt,Cd),oT=new WeakMap,C5=vF(K3,y5,KE,rt,oT,pl),sT=$F(Sp,ns,Ly,jE,By,ZE),I5=i3(no,sT,vt,ro,mn),S5=r3(Mt,Si,sT,I5,lt,rt,pl),aT=mB(gl),b5=t3(aT,un,or,GE,qs),bp=e3(aT,un,b5,GE,qs,Id,Cd),w5=JF(Ef,un,ea,or,yd,bp,sr,Tf,VE,qs),cT=KF(w5),A5=a3(no,ea,ml,or,cT,vt,Qs,ro,mn,Fy),k5=s3(Mt,Si,cT,A5,lt,rt,Ha),E5=YF(to),T5=l3(E5,lt,new WeakSet,M3),x5=qF(ea,vd,or,bp,sr,qs),lT=QF(x5,sr),P5=y3(no,lT,vt,ro,mn),R5=v3(Mt,Si,lT,P5,lt,rt),N5=k3(bp,vt,mn),_5=A3(Mt,un,bp,N5,lt,rt,Ha),uT=dF(Yi),Uy=GB(Yi),dT=new WeakMap,M5=QB(dT,Qs),O5=uT?mL(ns,sr,UB(Yi),Uy,WB(dL),lt,M5,rt,zu,new WeakMap,new WeakMap,I3(zu,Qs),Yi):void 0,D5=lF(JE,rt),L5=kB(QE,ns,AB,FB,new WeakSet,lt,D5,hv,pv,eT,tT),B5=rB(O5,z3,H3,$3,Y3,e5,n5,o5,a5,L5,l5,d5,f5,v5,C5,S5,k5,T5,R5,_5),F5=hF(Mt,jF,lt,rt),U5=pF(Mt,ZF,lt,rt),V5=gF(Mt,zF,lt,rt),G5=HF(un,rt),W5=mF(Mt,G5,lt),j5=BL(B5,un,sr,b3,F5,U5,V5,W5,Id),hT=qB(oT),Z5=IL(hT),fT=gB(to),z5=NB(hT),pT=OB(to),gT=new WeakMap,H5=HB(gT,yi),X5=_F(fT,to,un,ea,vd,ml,or,yd,sr,pT,Uy,H5,qs),$5=xF(un,X5,or,sr,qs),K5=nB(no,fT,gl,ea,vd,ml,or,z5,pT,Uy,vt,zu,Qs,ro,mn,Fy),J5=JB(dT),Y5=p3(gT),mb=uT?qL(Z5,Mt,Si,K5,$5,Ln,J5,lt,rt,zu,N3,Y5,B3,pl):void 0,Q5="data:text/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";class vb{constructor(e){U(this,"maxSize");U(this,"cache");this.maxSize=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const n=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,n),n}set(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}has(e){return this.cache.has(e)}}const q5=100;class Nf{static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getBufferFromCache(e,n){try{const r=await n.match(e);return r&&r.ok?await r.arrayBuffer():null}catch(r){return console.error("Failed to get data from cache:",r),null}}static async fetchAndCacheBuffer(e,n,r,i){try{const o=new Headers;r&&o.append("If-None-Match",r),i&&o.append("If-Modified-Since",i);const s=await fetch(e,{headers:o}),a=s.clone();if(s.status===200){const c=s.headers.get("ETag")||void 0,l=s.headers.get("Last-Modified")||void 0,u={url:e,etag:c,lastModified:l};await n.put(e,a),await n.put(e+":meta",new Response(JSON.stringify(u),{headers:{"Content-Type":"application/json"}}))}else if(s.status===304){const c=await n.match(e);if(c)return await c.arrayBuffer()}return await s.arrayBuffer()}catch(o){throw console.error("Failed to fetch and cache data:",o),o}}static async decodeAudioData(e,n){try{return await e.decodeAudioData(n)}catch(r){throw console.error("Failed to decode audio data:",r),r}}static async getMetadataFromCache(e,n){try{const r=await n.match(e+":meta");return r&&r.ok?await r.json():null}catch(r){return console.error("Failed to get metadata from cache:",r),null}}static async getAudioBuffer(e,n){if(this.decodedBuffers.has(n))return this.decodedBuffers.get(n);if(n.startsWith("data:")){const l=n.split(",")[1],u=Uint8Array.from(atob(l),h=>h.charCodeAt(0)).buffer,d=await this.decodeAudioData(e,u);return this.decodedBuffers.set(n,d),d}const r=await this.openCache();let i=this.pendingRequests.get(n);if(i)return i;const o=await this.getBufferFromCache(n,r);if(o){const l=await this.decodeAudioData(e,o);return this.decodedBuffers.set(n,l),l}const s=await this.getMetadataFromCache(n,r),a=s==null?void 0:s.etag,c=s==null?void 0:s.lastModified;return i=this.fetchAndCacheBuffer(n,r,a,c).then(l=>this.decodeAudioData(e,l)).then(l=>(this.decodedBuffers.set(n,l),l)).finally(()=>{this.pendingRequests.delete(n)}),this.pendingRequests.set(n,i),i}static clearMemoryCache(){this.decodedBuffers=new vb(q5),this.pendingRequests.clear()}}U(Nf,"pendingRequests",new Map),U(Nf,"decodedBuffers",new vb(100));let wp=class{constructor(){U(this,"_filters",[])}addFilter(e){this._filters.push(e)}removeFilter(e){this._filters=this._filters.filter(n=>n.frequency.value!==e.frequency.value&&n.type!==e.type&&n.Q.value!==e.Q.value&&n.gain.value!==e.gain.value)}applyFilters(e){return this._filters.reduce((n,r)=>(n.connect(r),r),e),this._filters.length>0?this._filters[this._filters.length-1]:e}get filters(){return this._filters}addFilters(e){e.forEach(n=>this.addFilter(n))}removeFilters(e){e.forEach(n=>this.removeFilter(n))}};class yb{constructor(e=[]){U(this,"_position",[0,0,0]);U(this,"loopCount",0);U(this,"playIndex",0);this.sounds=e}playRandom(){if(this.sounds.length===0)throw new Error("Cannot play a random sound from an empty group");const e=Math.floor(Math.random()*this.sounds.length),n=this.sounds[e].preplay();return n.forEach(r=>r.play()),n[0]}playOrdered(e=!0){if(this.sounds.length===0)throw new Error("Cannot play an ordered sound from an empty group");const n=this.sounds[this.playIndex].preplay();return n.forEach(r=>r.play()),this.playIndex++,this.playIndex>=this.sounds.length&&(e?this.playIndex=0:this.playIndex=this.sounds.length),n[0]}get duration(){return this.sounds.map(e=>e.duration).reduce((e,n)=>Math.max(e,n),0)}seek(e){this.sounds.forEach(n=>n.seek&&n.seek(e))}addSound(e){this.sounds.push(e)}preplay(){return this.sounds.reduce((e,n)=>(n.loop&&n.loop(this.loopCount),e.concat(n.preplay())),[])}play(){return this.preplay().map(e=>e.play()[0])}get isPlaying(){return this.sounds.some(e=>e.isPlaying)}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(n=>n.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(n=>n.addFilter(e))}removeFilter(e){this.sounds.forEach(n=>n.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(n=>n.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,n)=>e+n,0)/this.sounds.length}set volume(e){this.sounds.forEach(n=>n.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(n=>n.playbackRate=e)}}class Vy extends wp{constructor(n,r,i,o=0,s="HRTF"){super();U(this,"_playing",!1);U(this,"context");U(this,"source");U(this,"gainNode");U(this,"panner");U(this,"loopCount",0);U(this,"currentLoop",0);U(this,"buffer");U(this,"pauseTime",0);U(this,"startTime",0);U(this,"handleLoop",()=>{this.source&&(this.currentLoop++,this.loopCount!=="infinite"&&this.currentLoop>this.loopCount&&(this._playing=!1,this.stop()),this.loopCount==="infinite"||this.currentLoop<this.loopCount?this.buffer?(this.recreateSource(),this._playing&&(this.source.start(0),this._playing=!0)):this._playing&&this.seek(0):this._playing=!1)});if(this.panType=s,this.loopCount=o,this.panType=s,this.source=n,"buffer"in n&&n.buffer&&(this.buffer=n.buffer),"mediaElement"in n&&n.mediaElement)n.mediaElement.onended=this.handleLoop;else if("onended"in n)n.onended=this.handleLoop;else throw new Error("Unsupported source type");if(this.gainNode=r,this.context=i,this.panType==="HRTF")this.panner=i.createPanner();else if(this.panType==="stereo")this.panner=i.createStereoPanner();else throw new Error("Invalid pan type");this.source.connect(this.panner),this.panner.connect(this.gainNode),this.refreshFilters()}get stereoPan(){return this.panType==="stereo"?this.panner.pan.value:null}set stereoPan(n){if(this.panType!=="stereo")throw new Error("Stereo panning is not available when using HRTF.");if(!this.panner)throw new Error("Cannot set stereo pan of a sound that has been cleaned up");this.panner.pan.setValueAtTime(eU(n,-1,1),this.context.currentTime)}get duration(){if(!this.buffer)throw new Error("Cannot get duration of a sound that has been cleaned up");return this.buffer.duration}get playbackRate(){if(!this.source)throw new Error("Cannot get playback rate of a sound that has been cleaned up");if("playbackRate"in this.source)return this.source.playbackRate.value;if("mediaElement"in this.source&&this.source.mediaElement)return this.source.mediaElement.playbackRate;throw new Error("Unsupported source type")}set playbackRate(n){if(!this.source)throw new Error("Cannot set playback rate of a sound that has been cleaned up");"playbackRate"in this.source&&(this.source.playbackRate.value=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=n)}recreateSource(){if(!this.buffer||!this.source||!this.panner||!this.context||!this.gainNode)throw new Error("Cannot recreate source of a sound that has been cleaned up");this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.panner),this.source.onended=this.handleLoop}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");if("mediaElement"in this.source&&this.source.mediaElement)this.source.mediaElement.play();else if("start"in this.source&&this.source.start){const n=this.pauseTime?this.pauseTime:0;this.source.start(0,n)}return this._playing=!0,[this]}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.pause():"stop"in this.source&&this.source.stop&&(this.pauseTime=this.context.currentTime-this.startTime,this.source.stop()),this._playing=!1}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get 3D options of a sound that is not using HRTF");const n=this.panner;return{coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,channelCount:this.panner.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation,panningModel:n.panningModel,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,positionX:n.positionX.value,positionY:n.positionY.value,positionZ:n.positionZ.value,orientationX:n.orientationX.value,orientationY:n.orientationY.value,orientationZ:n.orientationZ.value}}set threeDOptions(n){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot set 3D options of a sound that is not using HRTF");const r=this.panner;r.coneInnerAngle=n.coneInnerAngle!==void 0?n.coneInnerAngle:r.coneInnerAngle,r.coneOuterAngle=n.coneOuterAngle!==void 0?n.coneOuterAngle:r.coneOuterAngle,r.coneOuterGain=n.coneOuterGain!==void 0?n.coneOuterGain:r.coneOuterGain,r.distanceModel=n.distanceModel||r.distanceModel,r.maxDistance=n.maxDistance!==void 0?n.maxDistance:r.maxDistance,r.channelCount=n.channelCount!==void 0?n.channelCount:r.channelCount,r.channelCountMode=n.channelCountMode||r.channelCountMode,r.channelInterpretation=n.channelInterpretation||r.channelInterpretation,r.panningModel=n.panningModel||r.panningModel,r.refDistance=n.refDistance!==void 0?n.refDistance:r.refDistance,r.rolloffFactor=n.rolloffFactor!==void 0?n.rolloffFactor:r.rolloffFactor,r.positionX.value=n.positionX!==void 0?n.positionX:r.positionX.value,r.positionY.value=n.positionY!==void 0?n.positionY:r.positionY.value,r.positionZ.value=n.positionZ!==void 0?n.positionZ:r.positionZ.value,r.orientationX.value=n.orientationX!==void 0?n.orientationX:r.orientationX.value,r.orientationY.value=n.orientationY!==void 0?n.orientationY:r.orientationY.value,r.orientationZ.value=n.orientationZ!==void 0?n.orientationZ:r.orientationZ.value}seek(n){if(!this.source||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");const r=this.isPlaying;if(this.stop(),"mediaElement"in this.source&&this.source.mediaElement)this.source.mediaElement.currentTime=n,r&&this.source.mediaElement.play();else if(this.buffer)this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.onended=this.handleLoop,this.refreshFilters(),this.source.connect(this.panner),r&&this.source.start(0,n);else throw new Error("Unsupported source type for seeking")}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}set sourceLoop(n){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=n)}fadeIn(n,r="linear"){return new Promise(i=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value;const o=1;switch(this.gainNode.gain.value=0,r){case"exponential":this.gainNode.gain.setValueAtTime(.01,this.context.currentTime),this.gainNode.gain.exponentialRampToValueAtTime(o,this.context.currentTime+n);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(o,this.context.currentTime+n);break}setTimeout(()=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value=o,i()},n*1e3)})}fadeOut(n,r="linear"){return new Promise(i=>{if(!this.gainNode)throw new Error("Cannot fade out a sound that has been cleaned up");switch(this.gainNode.gain.value,r){case"exponential":this.gainNode.gain.exponentialRampToValueAtTime(.01,this.context.currentTime+n);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+n)}setTimeout(()=>i(),n*1e3)})}get isPlaying(){return this.source?this._playing:!1}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this._filters.forEach(n=>{n&&n.disconnect()}),this._filters=[]}loop(n){var r;if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if("mediaElement"in this.source&&this.source.mediaElement){const i=this.source.mediaElement;return n===void 0||(i.loop=!0),i.loop===!0?"infinite":0}else if("loop"in this.source)return n===void 0?this.source.loop===!0?"infinite":0:(this.source.loop=!0,this.source.loopEnd=((r=this.source.buffer)==null?void 0:r.duration)||0,this.source.loopStart=0,this.source.loop===!0?"infinite":0);throw new Error("Unsupported source type")}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");if(this.isPlaying){try{"stop"in this.source&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0)}catch{}this._playing=!1,this.startTime=0,this.pauseTime=0}}addFilter(n){const r=n.context.createBiquadFilter();r.type=n.type,r.frequency.value=n.frequency.value,r.Q.value=n.Q.value,super.addFilter(r),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot move a sound that is not using HRTF");const[r,i,o]=n,s=this.panner;s.positionX.value=r,s.positionY.value=i,s.positionZ.value=o}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get position of a sound that is not using HRTF");const n=this.panner;return[n.positionX.value,n.positionY.value,n.positionZ.value]}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}clone(n={}){if(!this.source||!this.gainNode||!this.context)throw new Error("Cannot clone a sound that has been cleaned up");const r=n.panType||this.panType,i=this.context.createGain();let o;if("buffer"in this.source&&this.source.buffer)o=this.context.createBufferSource(),o.buffer=this.source.buffer;else if("mediaElement"in this.source&&this.source.mediaElement)o=this.context.createMediaElementSource(this.source.mediaElement);else throw new Error("Unsupported source type");const s=n.loopCount!==void 0?n.loopCount:this.loopCount;return new Vy(o,i,this.context,s,r)}}function eU(t,e,n){return Math.min(Math.max(t,e),n)}class Sc extends wp{constructor(n,r,i,o,s=_f.Buffer,a="HRTF"){super();U(this,"buffer");U(this,"context");U(this,"playbacks",[]);U(this,"globalGainNode");U(this,"_position",[0,0,0]);U(this,"_stereoPan",0);U(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});U(this,"loopCount",0);U(this,"_playbackRate",1);U(this,"_volume",1);this.url=n,this.type=s,this.panType=a,this.buffer=r,this.context=i,this.globalGainNode=o}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan,o=n.threeDOptions||this.threeDOptions,s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=n.playbackRate||this.playbackRate,c=n.volume!==void 0?n.volume:this.volume,l=n.position&&n.position.length?n.position:this.position,u=n.filters&&n.filters.length?n.filters:this._filters,d=new Sc(this.url,this.buffer,this.context,this.globalGainNode,this.type,r);return d.loopCount=s,d._playbackRate=a,d._volume=c,d._position=l,d._stereoPan=i,d._threeDOptions=o,d.addFilters(u),d}preplay(){let n;if(this.buffer)n=this.context.createBufferSource(),n.buffer=this.buffer;else{const o=new Audio;o.crossOrigin="anonymous",o.src=this.url,o.preload="auto",n=this.context.createMediaElementSource(o)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new Vy(n,r,this.context,this.loopCount,this.panType);return i.volume=this.volume,i.playbackRate=this.playbackRate,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}play(){const n=this.preplay();return n.forEach(r=>r.play()),n}stop(){this.playbacks.forEach(n=>n.stop()),this.playbacks=[]}pause(){this.playbacks.forEach(n=>n.pause())}seek(n){this.playbacks.forEach(r=>r.seek(n))}get duration(){var n;return((n=this.buffer)==null?void 0:n.duration)||0}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}set position(n){this._threeDOptions.positionX=n[0],this._threeDOptions.positionY=n[1],this._threeDOptions.positionZ=n[2],this.playbacks.forEach(r=>r.position=n)}get threeDOptions(){return this._threeDOptions}set threeDOptions(n){this._threeDOptions={...this._threeDOptions,...n},this.playbacks.forEach(r=>r.threeDOptions=this._threeDOptions)}get stereoPan(){return this._stereoPan}set stereoPan(n){this._stereoPan=n,this.playbacks.forEach(r=>r.stereoPan=n)}loop(n){return n===void 0?this.loopCount:(this.loopCount=n,this.playbacks.forEach(r=>r.loop(n)),this.loopCount)}addFilter(n){super.addFilter(n),this.playbacks.forEach(r=>r.addFilter(n))}removeFilter(n){super.removeFilter(n),this.playbacks.forEach(r=>r.removeFilter(n))}get volume(){return this._volume}set volume(n){this._volume=n,this.playbacks.forEach(r=>r.volume=n)}get isPlaying(){return this.playbacks.some(n=>n.isPlaying)}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.playbacks.forEach(r=>r.playbackRate=n)}}const tU=(t,e)=>{var n=new Uint8Array(t.byteLength+e.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),t.byteLength),n.buffer};function nU(t,e){const n=[];let r=0;fetch(t).then(function(o){if(!o.ok)throw new Error("HTTP error, status = "+o.status);if(!o.body)throw new Error("Missing body");var s=o.body.getReader();let a=new ArrayBuffer(0);function c(){return s.read().then(({value:l,done:u})=>{let d=null;if(l){if(a.byteLength?d=tU(a,l.buffer):(a=l.buffer.slice(0,44),d=l.buffer),e.decodeAudioData(d,function(h){n.push(h),n.length&&i()},function(h){console.log("err(decodeAudioData): "+h)}),u){console.log("done");return}c()}})}c()});function i(){for(;n.length;){let o=n.shift();const s=e.createBufferSource();if(!o)return;s.buffer=o,s.connect(e.destination),r==0&&(r=e.currentTime+.02),s.start(r),r+=s.buffer.duration}}}var _f=(t=>(t.HTML="HTML",t.Streaming="Streaming",t.Buffer="Buffer",t))(_f||{});let rU=class{constructor(e){U(this,"context");U(this,"globalGainNode");U(this,"listener");U(this,"prevVolume",1);U(this,"finalizationRegistry");U(this,"createOscillator",({frequency:e,type:n,periodicWave:r})=>{e===void 0&&(e=440);const i=this.context.createOscillator();return i.type=n||"sine",r&&i.setPeriodicWave(r),i.frequency.setValueAtTime(e,this.context.currentTime),i.connect(this.globalGainNode),i});U(this,"createBiquadFilter",({type:e,frequency:n,gain:r,Q:i})=>{n===void 0&&(n=350);const o=this.context.createBiquadFilter();return o.type=e||"lowpass",o.frequency.value=n,o.gain.value=r||0,o.Q.value=i||1,o});this.context=e||new j5,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.finalizationRegistry=new FinalizationRegistry(n=>{n.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",Q5):console.warn("AudioWorklet not supported")}async createWorkletNode(e,n){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new mb(this.context,e)}catch(r){console.error(r),console.log("Loading worklet from url",n);try{await this.context.audioWorklet.addModule(n)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${n}`)}return new mb(this.context,e)}}clearMemoryCache(){Nf.clearMemoryCache()}async createSound(e,n="Buffer",r="HRTF"){if(typeof e=="object")return Promise.resolve(new Sc("",e,this.context,this.globalGainNode,"Buffer",r));const i=e;if(n==="HTML"){const o=new Audio;return o.src=i,o.crossOrigin="anonymous",new Sc(i,void 0,this.context,this.globalGainNode,"HTML",r)}return Nf.getAudioBuffer(this.context,i).then(o=>new Sc(i,o,this.context,this.globalGainNode,n,r))}async createGroup(e){const n=new yb;return e.forEach(r=>n.addSound(r)),n}async createGroupFromUrls(e,n="Buffer",r="HRTF"){const i=new yb;return(await Promise.all(e.map(o=>this.createSound(o,n,r)))).forEach(o=>i.addSound(o)),i}async createStream(e){return await nU(e,this.context),new Sc(e,void 0,this.context,this.globalGainNode,"Streaming")}createPanner({coneInnerAngle:e,coneOuterAngle:n,coneOuterGain:r,distanceModel:i,maxDistance:o,channelCount:s,channelCountMode:a,channelInterpretation:c,panningModel:l,refDistance:u,rolloffFactor:d,positionX:h,positionY:f,positionZ:p,orientationX:m,orientationY:C,orientationZ:g}){const y=this.context.createPanner();return y.coneInnerAngle=e||360,y.coneOuterAngle=n||360,y.coneOuterGain=r||0,y.distanceModel=i||"inverse",y.maxDistance=o||1e4,y.channelCount=s||2,y.channelCountMode=a||"clamped-max",y.channelInterpretation=c||"speakers",y.panningModel=l||"HRTF",y.refDistance=u||1,y.rolloffFactor=d||1,y.positionX.value=h||0,y.positionY.value=f||0,y.positionZ.value=p||0,y.orientationX.value=m||0,y.orientationY.value=C||0,y.orientationZ.value=g||0,y}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new oU(this.context);i.play(),e(i)}).catch(r=>{n(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:n,up:r}=e,[i,o,s]=n,[a,c,l]=r;this.listener.forwardX.value=i,this.listener.forwardY.value=o,this.listener.forwardZ.value=s,this.listener.upX.value=a,this.listener.upY.value=c,this.listener.upZ.value=l}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[n,r,i]=e;this.listener.upX.value=n,this.listener.upY.value=r,this.listener.upZ.value=i}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[n,r,i]=e;this.listener.forwardX.value=n,this.listener.forwardY.value=r,this.listener.forwardZ.value=i}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[n,r,i]=e,o=this.context.currentTime;this.listener.positionX.setValueAtTime(n,o),this.listener.positionY.setValueAtTime(r,o),this.listener.positionZ.setValueAtTime(i,o)}},iU=class extends wp{constructor(n,r,i,o=0){super();U(this,"context");U(this,"source");U(this,"gainNode");U(this,"panner");this.source=n,this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}get isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!0)}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,o]=n;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=o}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.source;this.source.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(n){}};class oU extends wp{constructor(n){super();U(this,"context");U(this,"_position",[0,0,0]);U(this,"loopCount",0);U(this,"prevVolume",1);U(this,"microphoneGainNode");U(this,"streamPlayback");U(this,"stream");U(this,"streamSource");this.context=n,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{this.stream=n,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new iU(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(n=>{console.error("Error initializing microphone stream:",n)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(n){}get isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(n){this.streamPlayback&&this.streamPlayback.addFilter(n)}removeFilter(n){this.streamPlayback&&this.streamPlayback.removeFilter(n)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(n){this.streamPlayback&&(this.streamPlayback.volume=n)}get position(){return[0,0,0]}set position(n){}loop(n){return 0}get playbackRate(){return 1}set playbackRate(n){}}const sU="https://mongoose.world:9080/?url=";class aU extends ts{constructor(){super(...arguments);U(this,"packageName","Client.Media");U(this,"sounds",{});U(this,"defaultUrl","")}handleDefault(n){this.defaultUrl=n}async handleLoad(n){const r=(n.url||this.defaultUrl)+n.name,i=n.url+n.name;if(!this.sounds[i]){let s=await this.client.cacophony.createSound(r);s.key=i,this.sounds[i]=s}}mediaUrl(n){var i;let r=(n.url||this.defaultUrl)+n.name;return((i=n.type)==null?void 0:i.toLowerCase())==="music"&&(r=sU+encodeURIComponent(r)),r}async handlePlay(n){let r=this.mediaUrl(n);n.key=n.key||r;let i=this.sounds[n.key];const o=n.is3d?"HRTF":"stereo";if((!i||i.url!==r)&&(n.type==="music"?i=await this.client.cacophony.createSound(r,_f.HTML,o):i=await this.client.cacophony.createSound(r,_f.Buffer,o)),n.volume!==void 0&&(i.volume=n.volume/100),n.loops!==void 0&&i.loop(n.loops),n.start&&i.seek(n.start),n.end&&setTimeout(()=>{delete this.sounds[i.key],i.stop()},n.end),n.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[n.position[0],n.position[1],n.position[2]]),n.priority){for(let s in this.sounds){const a=this.sounds[s];a.priority&&a.priority<n.priority&&a.stop()}i.priority=n.priority}if(!i.isPlaying){const s=i.play()[0];n.fadein&&s.fadeIn(n.fadein),n.fadeout&&s.fadeOut(n.fadeout)}i.key=n.key,this.sounds[i.key]=i}handleStop(n){n.name&&this.soundsByName(n.name).forEach(r=>this.stopSound(r)),n.type&&this.soundsByType(n.type).forEach(r=>this.stopSound(r)),n.tag&&this.soundsByTag(n.tag).forEach(r=>this.stopSound(r)),n.key&&this.soundsByKey(n.key).forEach(r=>this.stopSound(r)),!n.name&&!n.type&&!n.tag&&!n.key&&(this.allSounds.forEach(r=>r.stop()),this.sounds={})}stopSound(n){delete this.sounds[n.key],n.stop()}handleListenerPosition(n){var r;(r=n.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=n.position)}handleListenerOrientation(n){n.up&&n.up.length&&(this.client.cacophony.listenerUpOrientation=n.up),n.forward&&n.forward.length&&(this.client.cacophony.listenerForwardOrientation=n.forward)}soundsByName(n){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(n))}soundsByKey(n){return Object.values(this.sounds).filter(r=>r.key===n)}soundsByTag(n){return Object.values(this.sounds).filter(r=>r.tag===n)}soundsByType(n){return Object.values(this.sounds).filter(r=>r.mediaType===n)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(n=>n.stop()),this.sounds={}}}class cU extends ts{constructor(){super(...arguments);U(this,"packageName","Client.Speech")}handleSpeak(n){const r=new SpeechSynthesisUtterance(n.text);r.rate=n.rate,r.pitch=n.pitch,r.volume=n.volume,speechSynthesis.speak(r)}}class lU extends ts{constructor(){super(...arguments);U(this,"packageName","Comm.Channel");U(this,"channels",[])}handleList(n){this.channels=n}sendList(){this.sendData("List")}handleText(n){n.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${n.talker}`,`${n.text}`))}}class uU extends ts{constructor(){super(...arguments);U(this,"packageName","Comm.LiveKit")}handleroom_token(n){this.client.worldData.liveKitTokens.push(n.token),this.client.emit("livekitToken",n.token)}handleroom_leave(n){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==n.token),this.client.emit("livekitLeave",n.token)}}class dU extends ts{constructor(){super(...arguments);U(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}}class hU extends ts{constructor(){super(...arguments);U(this,"packageName","Core.Supports")}sendSet(){const n=Object.values(this.client.gmcpHandlers).map(r=>r.packageName+" "+r.packageVersion.toString());this.sendData("Set",n)}}const nc=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,mT=new Set,gv=typeof process=="object"&&process?process:{},vT=(t,e,n,r)=>{typeof gv.emitWarning=="function"?gv.emitWarning(t,e,n,r):console.error(`[${n}] ${e}: ${t}`)};let Mf=globalThis.AbortController,Cb=globalThis.AbortSignal;var Gw;if(typeof Mf>"u"){Cb=class{constructor(){U(this,"onabort");U(this,"_onabort",[]);U(this,"reason");U(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},Mf=class{constructor(){U(this,"signal",new Cb);e()}abort(r){var i,o;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const s of this.signal._onabort)s(r);(o=(i=this.signal).onabort)==null||o.call(i,r)}}};let t=((Gw=gv.env)==null?void 0:Gw.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{t&&(t=!1,vT("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const fU=t=>!mT.has(t),ps=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),yT=t=>ps(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?Th:null:null;class Th extends Array{constructor(e){super(e),this.fill(0)}}var Gc;const da=class da{constructor(e,n){U(this,"heap");U(this,"length");if(!N(da,Gc))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(e),this.length=0}static create(e){const n=yT(e);if(!n)return[];be(da,Gc,!0);const r=new da(e,n);return be(da,Gc,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};Gc=new WeakMap,He(da,Gc,!1);let mv=da;var Ww,jw,Kr,lr,Jr,Yr,Wc,Ft,Qr,Ot,ft,xe,Rn,ur,In,$t,qr,Kt,ei,ti,dr,ni,bs,Nn,de,yv,Ca,fo,rd,hr,CT,Ia,jc,id,gs,ms,Cv,xh,Ph,ht,Iv,tu;const EC=class EC{constructor(e){He(this,de);He(this,Kr);He(this,lr);He(this,Jr);He(this,Yr);He(this,Wc);U(this,"ttl");U(this,"ttlResolution");U(this,"ttlAutopurge");U(this,"updateAgeOnGet");U(this,"updateAgeOnHas");U(this,"allowStale");U(this,"noDisposeOnSet");U(this,"noUpdateTTL");U(this,"maxEntrySize");U(this,"sizeCalculation");U(this,"noDeleteOnFetchRejection");U(this,"noDeleteOnStaleGet");U(this,"allowStaleOnFetchAbort");U(this,"allowStaleOnFetchRejection");U(this,"ignoreFetchAbort");He(this,Ft);He(this,Qr);He(this,Ot);He(this,ft);He(this,xe);He(this,Rn);He(this,ur);He(this,In);He(this,$t);He(this,qr);He(this,Kt);He(this,ei);He(this,ti);He(this,dr);He(this,ni);He(this,bs);He(this,Nn);He(this,Ca,()=>{});He(this,fo,()=>{});He(this,rd,()=>{});He(this,hr,()=>!1);He(this,Ia,e=>{});He(this,jc,(e,n,r)=>{});He(this,id,(e,n,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});U(this,Ww,"LRUCache");const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:s,updateAgeOnHas:a,allowStale:c,dispose:l,disposeAfter:u,noDisposeOnSet:d,noUpdateTTL:h,maxSize:f=0,maxEntrySize:p=0,sizeCalculation:m,fetchMethod:C,noDeleteOnFetchRejection:g,noDeleteOnStaleGet:y,allowStaleOnFetchRejection:S,allowStaleOnFetchAbort:E,ignoreFetchAbort:A}=e;if(n!==0&&!ps(n))throw new TypeError("max option must be a nonnegative integer");const P=n?yT(n):Array;if(!P)throw new Error("invalid max value: "+n);if(be(this,Kr,n),be(this,lr,f),this.maxEntrySize=p||N(this,lr),this.sizeCalculation=m,this.sizeCalculation){if(!N(this,lr)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(C!==void 0&&typeof C!="function")throw new TypeError("fetchMethod must be a function if specified");if(be(this,Wc,C),be(this,bs,!!C),be(this,Ot,new Map),be(this,ft,new Array(n).fill(void 0)),be(this,xe,new Array(n).fill(void 0)),be(this,Rn,new P(n)),be(this,ur,new P(n)),be(this,In,0),be(this,$t,0),be(this,qr,mv.create(n)),be(this,Ft,0),be(this,Qr,0),typeof l=="function"&&be(this,Jr,l),typeof u=="function"?(be(this,Yr,u),be(this,Kt,[])):(be(this,Yr,void 0),be(this,Kt,void 0)),be(this,ni,!!N(this,Jr)),be(this,Nn,!!N(this,Yr)),this.noDisposeOnSet=!!d,this.noUpdateTTL=!!h,this.noDeleteOnFetchRejection=!!g,this.allowStaleOnFetchRejection=!!S,this.allowStaleOnFetchAbort=!!E,this.ignoreFetchAbort=!!A,this.maxEntrySize!==0){if(N(this,lr)!==0&&!ps(N(this,lr)))throw new TypeError("maxSize must be a positive integer if specified");if(!ps(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Ie(this,de,CT).call(this)}if(this.allowStale=!!c,this.noDeleteOnStaleGet=!!y,this.updateAgeOnGet=!!s,this.updateAgeOnHas=!!a,this.ttlResolution=ps(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=r||0,this.ttl){if(!ps(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Ie(this,de,yv).call(this)}if(N(this,Kr)===0&&this.ttl===0&&N(this,lr)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!N(this,Kr)&&!N(this,lr)){const w="LRU_CACHE_UNBOUNDED";fU(w)&&(mT.add(w),vT("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",w,EC))}}static unsafeExposeInternals(e){return{starts:N(e,ti),ttls:N(e,dr),sizes:N(e,ei),keyMap:N(e,Ot),keyList:N(e,ft),valList:N(e,xe),next:N(e,Rn),prev:N(e,ur),get head(){return N(e,In)},get tail(){return N(e,$t)},free:N(e,qr),isBackgroundFetch:n=>{var r;return Ie(r=e,de,ht).call(r,n)},backgroundFetch:(n,r,i,o)=>{var s;return Ie(s=e,de,Ph).call(s,n,r,i,o)},moveToTail:n=>{var r;return Ie(r=e,de,tu).call(r,n)},indexes:n=>{var r;return Ie(r=e,de,gs).call(r,n)},rindexes:n=>{var r;return Ie(r=e,de,ms).call(r,n)},isStale:n=>{var r;return N(r=e,hr).call(r,n)}}}get max(){return N(this,Kr)}get maxSize(){return N(this,lr)}get calculatedSize(){return N(this,Qr)}get size(){return N(this,Ft)}get fetchMethod(){return N(this,Wc)}get dispose(){return N(this,Jr)}get disposeAfter(){return N(this,Yr)}getRemainingTTL(e){return N(this,Ot).has(e)?1/0:0}*entries(){for(const e of Ie(this,de,gs).call(this))N(this,xe)[e]!==void 0&&N(this,ft)[e]!==void 0&&!Ie(this,de,ht).call(this,N(this,xe)[e])&&(yield[N(this,ft)[e],N(this,xe)[e]])}*rentries(){for(const e of Ie(this,de,ms).call(this))N(this,xe)[e]!==void 0&&N(this,ft)[e]!==void 0&&!Ie(this,de,ht).call(this,N(this,xe)[e])&&(yield[N(this,ft)[e],N(this,xe)[e]])}*keys(){for(const e of Ie(this,de,gs).call(this)){const n=N(this,ft)[e];n!==void 0&&!Ie(this,de,ht).call(this,N(this,xe)[e])&&(yield n)}}*rkeys(){for(const e of Ie(this,de,ms).call(this)){const n=N(this,ft)[e];n!==void 0&&!Ie(this,de,ht).call(this,N(this,xe)[e])&&(yield n)}}*values(){for(const e of Ie(this,de,gs).call(this))N(this,xe)[e]!==void 0&&!Ie(this,de,ht).call(this,N(this,xe)[e])&&(yield N(this,xe)[e])}*rvalues(){for(const e of Ie(this,de,ms).call(this))N(this,xe)[e]!==void 0&&!Ie(this,de,ht).call(this,N(this,xe)[e])&&(yield N(this,xe)[e])}[(jw=Symbol.iterator,Ww=Symbol.toStringTag,jw)](){return this.entries()}find(e,n={}){for(const r of Ie(this,de,gs).call(this)){const i=N(this,xe)[r],o=Ie(this,de,ht).call(this,i)?i.__staleWhileFetching:i;if(o!==void 0&&e(o,N(this,ft)[r],this))return this.get(N(this,ft)[r],n)}}forEach(e,n=this){for(const r of Ie(this,de,gs).call(this)){const i=N(this,xe)[r],o=Ie(this,de,ht).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,N(this,ft)[r],this)}}rforEach(e,n=this){for(const r of Ie(this,de,ms).call(this)){const i=N(this,xe)[r],o=Ie(this,de,ht).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,N(this,ft)[r],this)}}purgeStale(){let e=!1;for(const n of Ie(this,de,ms).call(this,{allowStale:!0}))N(this,hr).call(this,n)&&(this.delete(N(this,ft)[n]),e=!0);return e}info(e){const n=N(this,Ot).get(e);if(n===void 0)return;const r=N(this,xe)[n],i=Ie(this,de,ht).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const o={value:i};if(N(this,dr)&&N(this,ti)){const s=N(this,dr)[n],a=N(this,ti)[n];if(s&&a){const c=s-(nc.now()-a);o.ttl=c,o.start=Date.now()}}return N(this,ei)&&(o.size=N(this,ei)[n]),o}dump(){const e=[];for(const n of Ie(this,de,gs).call(this,{allowStale:!0})){const r=N(this,ft)[n],i=N(this,xe)[n],o=Ie(this,de,ht).call(this,i)?i.__staleWhileFetching:i;if(o===void 0||r===void 0)continue;const s={value:o};if(N(this,dr)&&N(this,ti)){s.ttl=N(this,dr)[n];const a=nc.now()-N(this,ti)[n];s.start=Math.floor(Date.now()-a)}N(this,ei)&&(s.size=N(this,ei)[n]),e.unshift([r,s])}return e}load(e){this.clear();for(const[n,r]of e){if(r.start){const i=Date.now()-r.start;r.start=nc.now()-i}this.set(n,r.value,r)}}set(e,n,r={}){var h,f,p,m,C;if(n===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:c}=r;let{noUpdateTTL:l=this.noUpdateTTL}=r;const u=N(this,id).call(this,e,n,r.size||0,a);if(this.maxEntrySize&&u>this.maxEntrySize)return c&&(c.set="miss",c.maxEntrySizeExceeded=!0),this.delete(e),this;let d=N(this,Ft)===0?void 0:N(this,Ot).get(e);if(d===void 0)d=N(this,Ft)===0?N(this,$t):N(this,qr).length!==0?N(this,qr).pop():N(this,Ft)===N(this,Kr)?Ie(this,de,xh).call(this,!1):N(this,Ft),N(this,ft)[d]=e,N(this,xe)[d]=n,N(this,Ot).set(e,d),N(this,Rn)[N(this,$t)]=d,N(this,ur)[d]=N(this,$t),be(this,$t,d),xd(this,Ft)._++,N(this,jc).call(this,d,u,c),c&&(c.set="add"),l=!1;else{Ie(this,de,tu).call(this,d);const g=N(this,xe)[d];if(n!==g){if(N(this,bs)&&Ie(this,de,ht).call(this,g)){g.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:y}=g;y!==void 0&&!s&&(N(this,ni)&&((h=N(this,Jr))==null||h.call(this,y,e,"set")),N(this,Nn)&&((f=N(this,Kt))==null||f.push([y,e,"set"])))}else s||(N(this,ni)&&((p=N(this,Jr))==null||p.call(this,g,e,"set")),N(this,Nn)&&((m=N(this,Kt))==null||m.push([g,e,"set"])));if(N(this,Ia).call(this,d),N(this,jc).call(this,d,u,c),N(this,xe)[d]=n,c){c.set="replace";const y=g&&Ie(this,de,ht).call(this,g)?g.__staleWhileFetching:g;y!==void 0&&(c.oldValue=y)}}else c&&(c.set="update")}if(i!==0&&!N(this,dr)&&Ie(this,de,yv).call(this),N(this,dr)&&(l||N(this,rd).call(this,d,i,o),c&&N(this,fo).call(this,c,d)),!s&&N(this,Nn)&&N(this,Kt)){const g=N(this,Kt);let y;for(;y=g==null?void 0:g.shift();)(C=N(this,Yr))==null||C.call(this,...y)}return this}pop(){var e;try{for(;N(this,Ft);){const n=N(this,xe)[N(this,In)];if(Ie(this,de,xh).call(this,!0),Ie(this,de,ht).call(this,n)){if(n.__staleWhileFetching)return n.__staleWhileFetching}else if(n!==void 0)return n}}finally{if(N(this,Nn)&&N(this,Kt)){const n=N(this,Kt);let r;for(;r=n==null?void 0:n.shift();)(e=N(this,Yr))==null||e.call(this,...r)}}}has(e,n={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=n,o=N(this,Ot).get(e);if(o!==void 0){const s=N(this,xe)[o];if(Ie(this,de,ht).call(this,s)&&s.__staleWhileFetching===void 0)return!1;if(N(this,hr).call(this,o))i&&(i.has="stale",N(this,fo).call(this,i,o));else return r&&N(this,Ca).call(this,o),i&&(i.has="hit",N(this,fo).call(this,i,o)),!0}else i&&(i.has="miss");return!1}peek(e,n={}){const{allowStale:r=this.allowStale}=n,i=N(this,Ot).get(e);if(i===void 0||!r&&N(this,hr).call(this,i))return;const o=N(this,xe)[i];return Ie(this,de,ht).call(this,o)?o.__staleWhileFetching:o}async fetch(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:h=this.allowStaleOnFetchRejection,ignoreFetchAbort:f=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:m,forceRefresh:C=!1,status:g,signal:y}=n;if(!N(this,bs))return g&&(g.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,status:g});const S={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:c,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:h,allowStaleOnFetchAbort:p,ignoreFetchAbort:f,status:g,signal:y};let E=N(this,Ot).get(e);if(E===void 0){g&&(g.fetch="miss");const A=Ie(this,de,Ph).call(this,e,E,S,m);return A.__returned=A}else{const A=N(this,xe)[E];if(Ie(this,de,ht).call(this,A)){const M=r&&A.__staleWhileFetching!==void 0;return g&&(g.fetch="inflight",M&&(g.returnedStale=!0)),M?A.__staleWhileFetching:A.__returned=A}const P=N(this,hr).call(this,E);if(!C&&!P)return g&&(g.fetch="hit"),Ie(this,de,tu).call(this,E),i&&N(this,Ca).call(this,E),g&&N(this,fo).call(this,g,E),A;const w=Ie(this,de,Ph).call(this,e,E,S,m),_=w.__staleWhileFetching!==void 0&&r;return g&&(g.fetch=P?"stale":"refresh",_&&P&&(g.returnedStale=!0)),_?w.__staleWhileFetching:w.__returned=w}}get(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:s}=n,a=N(this,Ot).get(e);if(a!==void 0){const c=N(this,xe)[a],l=Ie(this,de,ht).call(this,c);return s&&N(this,fo).call(this,s,a),N(this,hr).call(this,a)?(s&&(s.get="stale"),l?(s&&r&&c.__staleWhileFetching!==void 0&&(s.returnedStale=!0),r?c.__staleWhileFetching:void 0):(o||this.delete(e),s&&r&&(s.returnedStale=!0),r?c:void 0)):(s&&(s.get="hit"),l?c.__staleWhileFetching:(Ie(this,de,tu).call(this,a),i&&N(this,Ca).call(this,a),c))}else s&&(s.get="miss")}delete(e){var r,i,o,s;let n=!1;if(N(this,Ft)!==0){const a=N(this,Ot).get(e);if(a!==void 0)if(n=!0,N(this,Ft)===1)this.clear();else{N(this,Ia).call(this,a);const c=N(this,xe)[a];if(Ie(this,de,ht).call(this,c)?c.__abortController.abort(new Error("deleted")):(N(this,ni)||N(this,Nn))&&(N(this,ni)&&((r=N(this,Jr))==null||r.call(this,c,e,"delete")),N(this,Nn)&&((i=N(this,Kt))==null||i.push([c,e,"delete"]))),N(this,Ot).delete(e),N(this,ft)[a]=void 0,N(this,xe)[a]=void 0,a===N(this,$t))be(this,$t,N(this,ur)[a]);else if(a===N(this,In))be(this,In,N(this,Rn)[a]);else{const l=N(this,ur)[a];N(this,Rn)[l]=N(this,Rn)[a];const u=N(this,Rn)[a];N(this,ur)[u]=N(this,ur)[a]}xd(this,Ft)._--,N(this,qr).push(a)}}if(N(this,Nn)&&((o=N(this,Kt))!=null&&o.length)){const a=N(this,Kt);let c;for(;c=a==null?void 0:a.shift();)(s=N(this,Yr))==null||s.call(this,...c)}return n}clear(){var e,n,r;for(const i of Ie(this,de,ms).call(this,{allowStale:!0})){const o=N(this,xe)[i];if(Ie(this,de,ht).call(this,o))o.__abortController.abort(new Error("deleted"));else{const s=N(this,ft)[i];N(this,ni)&&((e=N(this,Jr))==null||e.call(this,o,s,"delete")),N(this,Nn)&&((n=N(this,Kt))==null||n.push([o,s,"delete"]))}}if(N(this,Ot).clear(),N(this,xe).fill(void 0),N(this,ft).fill(void 0),N(this,dr)&&N(this,ti)&&(N(this,dr).fill(0),N(this,ti).fill(0)),N(this,ei)&&N(this,ei).fill(0),be(this,In,0),be(this,$t,0),N(this,qr).length=0,be(this,Qr,0),be(this,Ft,0),N(this,Nn)&&N(this,Kt)){const i=N(this,Kt);let o;for(;o=i==null?void 0:i.shift();)(r=N(this,Yr))==null||r.call(this,...o)}}};Kr=new WeakMap,lr=new WeakMap,Jr=new WeakMap,Yr=new WeakMap,Wc=new WeakMap,Ft=new WeakMap,Qr=new WeakMap,Ot=new WeakMap,ft=new WeakMap,xe=new WeakMap,Rn=new WeakMap,ur=new WeakMap,In=new WeakMap,$t=new WeakMap,qr=new WeakMap,Kt=new WeakMap,ei=new WeakMap,ti=new WeakMap,dr=new WeakMap,ni=new WeakMap,bs=new WeakMap,Nn=new WeakMap,de=new WeakSet,yv=function(){const e=new Th(N(this,Kr)),n=new Th(N(this,Kr));be(this,dr,e),be(this,ti,n),be(this,rd,(o,s,a=nc.now())=>{if(n[o]=s!==0?a:0,e[o]=s,s!==0&&this.ttlAutopurge){const c=setTimeout(()=>{N(this,hr).call(this,o)&&this.delete(N(this,ft)[o])},s+1);c.unref&&c.unref()}}),be(this,Ca,o=>{n[o]=e[o]!==0?nc.now():0}),be(this,fo,(o,s)=>{if(e[s]){const a=e[s],c=n[s];if(!a||!c)return;o.ttl=a,o.start=c,o.now=r||i();const l=o.now-c;o.remainingTTL=a-l}});let r=0;const i=()=>{const o=nc.now();if(this.ttlResolution>0){r=o;const s=setTimeout(()=>r=0,this.ttlResolution);s.unref&&s.unref()}return o};this.getRemainingTTL=o=>{const s=N(this,Ot).get(o);if(s===void 0)return 0;const a=e[s],c=n[s];if(!a||!c)return 1/0;const l=(r||i())-c;return a-l},be(this,hr,o=>{const s=n[o],a=e[o];return!!a&&!!s&&(r||i())-s>a})},Ca=new WeakMap,fo=new WeakMap,rd=new WeakMap,hr=new WeakMap,CT=function(){const e=new Th(N(this,Kr));be(this,Qr,0),be(this,ei,e),be(this,Ia,n=>{be(this,Qr,N(this,Qr)-e[n]),e[n]=0}),be(this,id,(n,r,i,o)=>{if(Ie(this,de,ht).call(this,r))return 0;if(!ps(i))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(i=o(r,n),!ps(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),be(this,jc,(n,r,i)=>{if(e[n]=r,N(this,lr)){const o=N(this,lr)-e[n];for(;N(this,Qr)>o;)Ie(this,de,xh).call(this,!0)}be(this,Qr,N(this,Qr)+e[n]),i&&(i.entrySize=r,i.totalCalculatedSize=N(this,Qr))})},Ia=new WeakMap,jc=new WeakMap,id=new WeakMap,gs=function*({allowStale:e=this.allowStale}={}){if(N(this,Ft))for(let n=N(this,$t);!(!Ie(this,de,Cv).call(this,n)||((e||!N(this,hr).call(this,n))&&(yield n),n===N(this,In)));)n=N(this,ur)[n]},ms=function*({allowStale:e=this.allowStale}={}){if(N(this,Ft))for(let n=N(this,In);!(!Ie(this,de,Cv).call(this,n)||((e||!N(this,hr).call(this,n))&&(yield n),n===N(this,$t)));)n=N(this,Rn)[n]},Cv=function(e){return e!==void 0&&N(this,Ot).get(N(this,ft)[e])===e},xh=function(e){var o,s;const n=N(this,In),r=N(this,ft)[n],i=N(this,xe)[n];return N(this,bs)&&Ie(this,de,ht).call(this,i)?i.__abortController.abort(new Error("evicted")):(N(this,ni)||N(this,Nn))&&(N(this,ni)&&((o=N(this,Jr))==null||o.call(this,i,r,"evict")),N(this,Nn)&&((s=N(this,Kt))==null||s.push([i,r,"evict"]))),N(this,Ia).call(this,n),e&&(N(this,ft)[n]=void 0,N(this,xe)[n]=void 0,N(this,qr).push(n)),N(this,Ft)===1?(be(this,In,be(this,$t,0)),N(this,qr).length=0):be(this,In,N(this,Rn)[n]),N(this,Ot).delete(r),xd(this,Ft)._--,n},Ph=function(e,n,r,i){const o=n===void 0?void 0:N(this,xe)[n];if(Ie(this,de,ht).call(this,o))return o;const s=new Mf,{signal:a}=r;a==null||a.addEventListener("abort",()=>s.abort(a.reason),{signal:s.signal});const c={signal:s.signal,options:r,context:i},l=(m,C=!1)=>{const{aborted:g}=s.signal,y=r.ignoreFetchAbort&&m!==void 0;if(r.status&&(g&&!C?(r.status.fetchAborted=!0,r.status.fetchError=s.signal.reason,y&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),g&&!y&&!C)return d(s.signal.reason);const S=f;return N(this,xe)[n]===f&&(m===void 0?S.__staleWhileFetching?N(this,xe)[n]=S.__staleWhileFetching:this.delete(e):(r.status&&(r.status.fetchUpdated=!0),this.set(e,m,c.options))),m},u=m=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=m),d(m)),d=m=>{const{aborted:C}=s.signal,g=C&&r.allowStaleOnFetchAbort,y=g||r.allowStaleOnFetchRejection,S=y||r.noDeleteOnFetchRejection,E=f;if(N(this,xe)[n]===f&&(!S||E.__staleWhileFetching===void 0?this.delete(e):g||(N(this,xe)[n]=E.__staleWhileFetching)),y)return r.status&&E.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),E.__staleWhileFetching;if(E.__returned===E)throw m},h=(m,C)=>{var y;const g=(y=N(this,Wc))==null?void 0:y.call(this,e,o,c);g&&g instanceof Promise&&g.then(S=>m(S===void 0?void 0:S),C),s.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(m(void 0),r.allowStaleOnFetchAbort&&(m=S=>l(S,!0)))})};r.status&&(r.status.fetchDispatched=!0);const f=new Promise(h).then(l,u),p=Object.assign(f,{__abortController:s,__staleWhileFetching:o,__returned:void 0});return n===void 0?(this.set(e,p,{...c.options,status:void 0}),n=N(this,Ot).get(e)):N(this,xe)[n]=p,p},ht=function(e){if(!N(this,bs))return!1;const n=e;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof Mf},Iv=function(e,n){N(this,ur)[n]=e,N(this,Rn)[e]=n},tu=function(e){e!==N(this,$t)&&(e===N(this,In)?be(this,In,N(this,Rn)[e]):Ie(this,de,Iv).call(this,N(this,ur)[e],N(this,Rn)[e]),Ie(this,de,Iv).call(this,N(this,$t),e),be(this,$t,e))};let vv=EC;function pU(t){const e=t.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+t+"`"),null;const n=e[1],r=e[2],i={},o=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let s;for(;s=o.exec(e[3]);){const a=s[1]||s[3],c=s[2]||s[4];a in i?console.log(`Invalid message format: duplicate key ${a} detected`):i[a]=c}return{name:n,authKey:r,keyvals:i}}function Ib(t){const e=t.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+t+"`"),null;const n=e[1]||e[4],r=void 0,i=e[2],o=e[3],s={};return s[i]=o,{name:n,authKey:r,keyvals:s}}function Sv(){return(Math.random()+1).toString(36).substring(3,9)}class vl{constructor(e){U(this,"packageName");U(this,"minVersion",1);U(this,"maxVersion",1);U(this,"packageVersion",0);U(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,n){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,n)}}class gU extends vl{constructor(){super(...arguments);U(this,"packageName","mcp-negotiate");U(this,"minVersion",2);U(this,"maxVersion",2)}handle(n){switch(n.name){}}sendNegotiate(){var n,r;for(const i of Object.values(this.client.mcpHandlers)){let o=(n=i.minVersion)==null?void 0:n.toFixed(1),s=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":o,"max-version":s})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class mU extends vl{constructor(){super(...arguments);U(this,"packageName","dns-com-awns-status")}handle(n){console.log(n),this.client.emit("statustext",n.keyvals.text)}}class vU extends vl{constructor(n){super(n);U(this,"packageName","dns-org-mud-moo-simpleedit");U(this,"sessions",{});U(this,"clientId");this.clientId=Sv()}handle(n){if(n.name==="dns-org-mud-moo-simpleedit-content"){const r={name:n.keyvals.name,reference:n.keyvals.reference,type:n.keyvals.type,contents:[]};this.sessions[n.keyvals["_data-tag"]]=r}else console.log(`Unexpected simpleedit message ${n}`)}handleMultiline(n){"content"in n.keyvals?this.sessions[n.name].contents.push(n.keyvals.content):console.log(`Unexpected simpleedit ML ${n}`)}closeMultiline(n){console.log(`Closing multiline ${n.name}`),this.client.openEditorWindow(this.sessions[n.name])}shutdown(){new BroadcastChannel("editor").postMessage({type:"shutdown"})}}class yU extends vl{constructor(){super(...arguments);U(this,"packageName","dns-com-awns-getset");U(this,"id",1);U(this,"cache",new vv({max:10}));U(this,"LocalCache",{})}handle(n){switch(n.name){case"dns-com-awns-getset-ack":const r=this.cache.get(n.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${n.keyvals.id}`);break}const i=n.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(n){const r=(this.id++).toString();this.cache.set(r,n),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:n})}sendSet(n,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:n,value:r})}sendDrop(n){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:n})}}class CU extends vl{constructor(){super(...arguments);U(this,"packageName","dns-com-vmoo-userlist");U(this,"maxVersion",1.1);U(this,"player");U(this,"fields",["Object","Name","Icon"]);U(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);U(this,"players",[])}handle(n){switch(n.name){case"dns-com-vmoo-userlist-you":this.player=n.keyvals.nr;break}}handleMultiline(n){if("fields"in n.keyvals&&(this.fields=Hr(n.keyvals.fields.trim())),"icons"in n.keyvals&&(this.icons=Hr(n.keyvals.icons.trim())),"d"in n.keyvals){const o=n.keyvals.d[0];switch(o){case"=":var r=Hr(n.keyvals.d.slice(1));this.players=r.map(a=>this.playerFromArray(a));break;case"+":this.players.push(this.playerFromArray(Hr(n.keyvals.d.slice(1))));break;case"-":var i=Hr(n.keyvals.d.slice(1));this.players=this.players.filter(a=>!i.includes(a.Object));break;case"*":const s=this.playerFromArray(Hr(n.keyvals.d.slice(1)));this.updatePlayer(s);break;case"<":i=Hr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!0,this.players[c]=a)});break;case">":i=Hr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!1,this.players[c]=a)});break;case"[":i=Hr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!0,this.players[c]=a)});break;case"]":i=Hr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!1,this.players[c]=a)});break;default:console.log(`Unknown userlist mode ${o} in ${n.keyvals.d}`);break}this.update()}}updatePlayer(n){const r=this.players.findIndex(i=>i.Object===n.Object);r!==-1?this.players[r]=n:this.players.push(n)}update(){this.players.sort((r,i)=>n(i)-n(r)),this.client.emit("userlist",this.players);function n(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(n){const r={};return n.forEach((i,o)=>{r[this.fields[o]]=i}),r.away=!1,r.idle=!1,r}}function Hr(t){t=t.slice(1,-1);let e=[],n="",r=0;for(let o=0;o<t.length;o++){const s=t[o];if(s==="{")r++;else if(s==="}")r--;else if(s===","&&r===0){i(),n="";continue}n+=s}return n.length>0&&i(),e;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?e.push(Hr(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?e.push(n.slice(1,-1)):e.push(n):e.push(Number(n))}}class IU extends vl{constructor(){super(...arguments);U(this,"packageName","dns-com-awns-ping");U(this,"id",1)}handle(n){switch(n.name){case"dns-com-awns-ping":this.send("reply",n.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}function SU({onlyFirst:t=!1}={}){const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,t?void 0:"g")}const bU=SU();function wU(t){if(typeof t!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof t}\``);return t.replace(bU,"")}var bv=(t=>(t.Off="off",t.Unfocused="unfocused",t.All="all",t))(bv||{}),Yo=(t=>(t.SetGeneral="SET_GENERAL",t.SetSpeech="SET_SPEECH",t.SetChannels="SET_CHANNELS",t.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",t.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",t))(Yo||{});class AU{constructor(){U(this,"state");U(this,"listeners",new Set);U(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(n=>n())});const e=localStorage.getItem("preferences"),n=this.getInitialPreferences();this.state=e?this.mergePreferences(n,JSON.parse(e)):n}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(e,n){return{...e,general:{...e.general,...n.general},speech:{...e.speech,...n.speech},channels:n.channels?{...e.channels,...n.channels}:e.channels,editor:{...e.editor,...n.editor}}}reducer(e,n){switch(n.type){case"SET_GENERAL":return{...e,general:n.data};case"SET_SPEECH":return{...e,speech:n.data};case"SET_CHANNELS":return{...e,channels:n.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:n.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:n.data}};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const Nc=new AU;class kU extends gE{constructor(n,r){super();U(this,"ws");U(this,"decoder",new TextDecoder("utf8"));U(this,"telnet");U(this,"host");U(this,"port");U(this,"telnetNegotiation",!1);U(this,"telnetBuffer","");U(this,"gmcpHandlers",{});U(this,"mcpHandlers",{});U(this,"mcpMultilines",{});U(this,"mcpAuthKey",null);U(this,"mcp_negotiate");U(this,"mcp_getset");U(this,"gmcp_char");U(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[]});U(this,"cacophony");U(this,"sendCommand",n=>{Nc.getState().general.localEcho&&this.emit("command",n),this.send(n+`\r
`),console.log("> "+n)});this.host=n,this.port=r,this.mcp_negotiate=this.registerMcpPackage(gU),this.mcp_getset=this.registerMcpPackage(yU),this.gmcp_char=this.registerGMCPPackage(tL),this.cacophony=new rU}registerGMCPPackage(n){const r=new n(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(n){const r=new n(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new q2(new Q2(this.ws)),this.ws.onopen=()=>{this.emit("connect")},this.telnet.on("data",n=>{this.handleData(n)}),this.telnet.on("negotiation",(n,r)=>{n===eu.WILL&&r===ql.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(eu.DO,ql.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):n===eu.DO&&r===ql.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(eu.WILL,ql.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(n,r)=>{console.log("GMCP Package:",n,r);try{this.handleGmcpData(n,r)}catch(i){console.error("Calling GMCP:",i)}}),this.ws.onclose=()=>{this.emit("disconnect"),this.mcpAuthKey=null,setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=n=>{this.emit("error",n)}}send(n){this.ws.send(n)}close(){this.ws.close()}handleData(n){const r=this.decoder.decode(n).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(n){if(n.startsWith("#$#*")){const i=Ib(n.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(n.startsWith("#$#:")){const i=Ib(n.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=pU(n.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=Sv(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(n,r){const i=n.lastIndexOf("."),o=n.substring(0,i),s=n.substring(i+1);console.log("GMCP Message:",o,s,r);const a=this.gmcpHandlers[o];if(!a){console.log("No handler for GMCP package:",o);return}const c=a["handle"+s];c?(console.log("Calling handler:",c),c.call(a,JSON.parse(r))):console.log("No handler on package:",o,s)}emitMessage(n){const r=Nc.getState().speech.autoreadMode;r===bv.All&&this.speak(n),r===bv.Unfocused&&!document.hasFocus()&&this.speak(n),this.emit("message",n)}sendGmcp(n,r){console.log("Sending GMCP:",n,r),this.telnet.sendGmcp(n,r)}sendMcp(n,r){if(typeof r=="object"){let o="";for(const[s,a]of Object.entries(r))o+=` ${s}: ${a||'""'}`;r=o}const i=`#$#${n} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(n,r,i){this.send(`#$#* ${n} ${r}: ${i}\r
`)}closeMcpML(n){this.send(`#$#: ${n}\r
`)}openEditorWindow(n){console.log(n);const r=new BroadcastChannel("editor"),i=n.reference,o=encodeURIComponent(i),s=window.open(`/editor?reference=${o}`,"_blank");r.onmessage=a=>{console.log("editor window message",a),a.data.id===i&&(a.data.type==="ready"?(console.log("sending editor window session",n),r.postMessage({type:"load",session:n})):a.data.type==="save"?(console.log("saving editor window with session",a.data.session),this.saveEditorWindow(a.data.session)):a.data.type==="close"&&(console.log("closing editor window"),r.close(),r.onmessage=null))},s&&s.focus()}saveEditorWindow(n){const r={reference:n.reference,type:n.type};r["content*"]="",this.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",r,n.contents)}sendMCPMultiline(n,r,i){const o=Sv();r["_data-tag"]=o,this.sendMcp(n,r);for(const s of i)this.sendMcpMLLine(o,"content",s);this.closeMcpML(o)}shutdown(){Object.values(this.mcpHandlers).forEach(n=>{n.shutdown()}),Object.values(this.gmcpHandlers).forEach(n=>{n.shutdown()})}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(n,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(n,{body:r})}speak(n){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(wU(n));r.lang="en-US";const{rate:i,pitch:o,voice:s,volume:a}=Nc.getState().speech;r.rate=i,r.pitch=o,r.volume=a;const l=speechSynthesis.getVoices().find(u=>u.name===s);l&&(r.voice=l),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}getInput(){var n;return((n=document.getElementById("command-input"))==null?void 0:n.textContent)||""}setInput(n){const r=document.getElementById("command-input");r&&(r.textContent=n)}}class EU{constructor(){U(this,"history",[]);U(this,"currentIndex",0);U(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&(this.history.push(e.trim()),this.currentIndex=this.history.length),this.unsentInput=""}navigateUp(e){return this.currentIndex===this.history.length&&(this.unsentInput=e),this.history.length>0&&this.currentIndex>0&&this.currentIndex--,this.history.length>0?this.history[Math.max(0,this.currentIndex)]:""}navigateDown(e){return this.currentIndex===this.history.length&&(this.unsentInput=e),this.currentIndex<this.history.length-1?(this.currentIndex++,this.history[this.currentIndex]):(this.currentIndex=this.history.length,this.unsentInput)}getCurrentInput(){return this.currentIndex>=this.history.length?this.unsentInput:this.history[this.currentIndex]}}const TU=({onSend:t,inputRef:e})=>{const[n,r]=b.useState(""),i=b.useRef(new EU),o=s=>{const a=i.current;if(s.key==="Enter"&&!s.shiftKey)s.preventDefault(),t(n),a.addCommand(n),r("");else if(s.key==="ArrowUp"){s.preventDefault();const c=a.navigateUp(n);r(c)}else if(s.key==="ArrowDown"){s.preventDefault();const c=a.navigateDown(n);r(c)}};return X.jsx("textarea",{value:n,onChange:s=>r(s.target.value),onKeyDown:o,id:"command-input",ref:e,autoFocus:!0})},xU="5c72cbd33787fdb9dae57a61fc190a6b236a5149",ta=()=>{const[,t]=b.useReducer(e=>e+1,0);return b.useEffect(()=>Nc.subscribe(t),[]),[Nc.getState(),Nc.dispatch]},PU=()=>{const[t,e]=b.useState([]);return b.useEffect(()=>{const n=()=>{e(window.speechSynthesis.getVoices())};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)},[]),t},RU=({tabs:t})=>{const[e,n]=b.useState(0),r=b.useRef([]);return b.useEffect(()=>{r.current=r.current.slice(0,t.length)},[t]),b.useEffect(()=>{const i=s=>{switch(s.key){case"ArrowLeft":n(a=>a>0?a-1:t.length-1);break;case"ArrowRight":n(a=>a<t.length-1?a+1:0);break}},o=r.current[e];return o==null||o.addEventListener("keydown",i),()=>{o==null||o.removeEventListener("keydown",i)}},[t.length,e]),b.useEffect(()=>{var i;(i=r.current[e])==null||i.focus()},[e]),X.jsxs("div",{children:[X.jsx("div",{role:"tablist","aria-label":"Tabs",children:t.map((i,o)=>X.jsx("button",{ref:s=>r.current[o]=s,role:"tab","aria-selected":e===o,id:`${i.label}-tab`,"aria-controls":`${i.label}-panel`,onClick:()=>n(o),tabIndex:e===o?void 0:-1,children:i.label},o))}),t.map((i,o)=>X.jsx("div",{role:"tabpanel",id:`${i.label}-panel`,"aria-labelledby":`${i.label}-tab`,hidden:e!==o,tabIndex:e===o?0:-1,children:i.content},o))]})},NU=()=>{const[t,e]=ta();return X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:t.general.localEcho,onChange:n=>e({type:Yo.SetGeneral,data:{...t.general,localEcho:n.target.checked}})}),"Local Echo"]})},_U=()=>{const[t,e]=ta();return X.jsxs("label",{children:["Auto Read:",X.jsxs("select",{value:t.speech.autoreadMode,onChange:n=>e({type:Yo.SetSpeech,data:{...t.speech,autoreadMode:n.target.value}}),children:[X.jsx("option",{value:"off",children:"Off"}),X.jsx("option",{value:"unfocused",children:"Unfocused"}),X.jsx("option",{value:"all",children:"Always"})]})]})},MU=()=>{const[t,e]=ta(),n=PU();return X.jsxs("label",{children:["Voice:",X.jsx("select",{value:t.speech.voice,onChange:r=>e({type:Yo.SetSpeech,data:{...t.speech,voice:r.target.value}}),children:n.map(r=>X.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},OU=()=>{const[t,e]=ta();return X.jsxs("label",{children:["Rate (0.1 - 10.0):",X.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:t.speech.rate,onChange:n=>e({type:Yo.SetSpeech,data:{...t.speech,rate:parseFloat(n.target.value)}})})]})},DU=()=>{const[t,e]=ta();return X.jsxs("label",{children:["Pitch (0 - 2):",X.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:t.speech.pitch,onChange:n=>e({type:Yo.SetSpeech,data:{...t.speech,pitch:parseFloat(n.target.value)}})})]})},LU=()=>{const[t,e]=ta();return X.jsxs("label",{children:["Volume (0 - 1):",X.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:t.speech.volume,onChange:n=>e({type:Yo.SetSpeech,data:{...t.speech,volume:parseFloat(n.target.value)}})})]})},BU=()=>X.jsxs("div",{children:[X.jsx(_U,{}),X.jsx("br",{}),X.jsx(MU,{}),X.jsx("br",{}),X.jsx(OU,{}),X.jsx("br",{}),X.jsx(DU,{}),X.jsx("br",{}),X.jsx(LU,{}),X.jsx("br",{})]}),FU=()=>{const[t,e]=ta(),n=t.editor,r=o=>{e({type:Yo.SetEditorAutocompleteEnabled,data:o.target.checked})},i=o=>{e({type:Yo.SetEditorAccessibilityMode,data:o.target.checked})};return X.jsxs("div",{children:[X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),X.jsx("br",{}),X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:n.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),X.jsx("br",{})]})},UU=()=>{const t=[{label:"General",content:X.jsx(NU,{})},{label:"Speech",content:X.jsx(BU,{})},{label:"Editor",content:X.jsx(FU,{})}];return X.jsx(RU,{tabs:t})};function VU(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Hu(){return Hu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hu.apply(null,arguments)}var wv="data-focus-lock",IT="data-focus-lock-disabled",GU="data-no-focus-lock",WU="data-autofocus-inside",jU="data-no-autofocus";function kg(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function ZU(t,e){var n=b.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var zU=typeof window<"u"?b.useLayoutEffect:b.useEffect,Sb=new WeakMap;function HU(t,e){var n=ZU(null,function(r){return t.forEach(function(i){return kg(i,r)})});return zU(function(){var r=Sb.get(n);if(r){var i=new Set(r),o=new Set(t),s=n.current;i.forEach(function(a){o.has(a)||kg(a,null)}),o.forEach(function(a){i.has(a)||kg(a,s)})}Sb.set(n,t)},[t]),n}var Eg={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},Av=function(t,e){return Av=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Av(t,e)};function yl(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Av(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var kv=function(){return kv=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},kv.apply(this,arguments)};function XU(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{l(r.next(u))}catch(d){s(d)}}function c(u){try{l(r.throw(u))}catch(d){s(d)}}function l(u){u.done?o(u.value):i(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function ST(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(n=0)),n;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){n.label=l[1];break}if(l[0]===6&&n.label<o[1]){n.label=o[1],o=l;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(l);break}o[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function el(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ev(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function Tv(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function _c(t){return this instanceof _c?(this.v=t,this):new _c(t)}function $U(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(f){return function(p){return Promise.resolve(p).then(f,d)}}function a(f,p){r[f]&&(i[f]=function(m){return new Promise(function(C,g){o.push([f,m,C,g])>1||c(f,m)})},p&&(i[f]=p(i[f])))}function c(f,p){try{l(r[f](p))}catch(m){h(o[0][3],m)}}function l(f){f.value instanceof _c?Promise.resolve(f.value.v).then(u,d):h(o[0][2],f)}function u(f){c("next",f)}function d(f){c("throw",f)}function h(f,p){f(p),o.shift(),o.length&&c(o[0][0],o[0][1])}}function KU(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof el=="function"?el(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,c){s=t[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}}function bT(t){return t}function wT(t,e){e===void 0&&(e=bT);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(o){var s=e(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var c=function(){var u=s;s=[],u.forEach(o)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){s.push(u),l()},filter:function(u){return s=s.filter(u),n}}}};return i}function Gy(t,e){return e===void 0&&(e=bT),wT(t,e)}function JU(t){t===void 0&&(t={});var e=wT(null);return e.options=kv({async:!0,ssr:!1},t),e}var AT=Gy({},function(t){var e=t.target,n=t.currentTarget;return{target:e,currentTarget:n}}),kT=Gy(),YU=Gy(),QU=JU({async:!0,ssr:typeof document<"u"}),qU=b.createContext(void 0),e4=[],Wy=b.forwardRef(function(e,n){var r,i=b.useState(),o=i[0],s=i[1],a=b.useRef(),c=b.useRef(!1),l=b.useRef(null),u=b.useState({}),d=u[1],h=e.children,f=e.disabled,p=f===void 0?!1:f,m=e.noFocusGuards,C=m===void 0?!1:m,g=e.persistentFocus,y=g===void 0?!1:g,S=e.crossFrame,E=S===void 0?!0:S,A=e.autoFocus,P=A===void 0?!0:A;e.allowTextSelection;var w=e.group,T=e.className,_=e.whiteList,M=e.hasPositiveIndices,D=e.shards,B=D===void 0?e4:D,j=e.as,Z=j===void 0?"div":j,z=e.lockProps,q=z===void 0?{}:z,oe=e.sideCar,W=e.returnFocus,Y=W===void 0?!1:W,re=e.focusOptions,H=e.onActivation,te=e.onDeactivation,Ee=b.useState({}),Le=Ee[0],ve=b.useCallback(function(ue){var ze=ue.captureFocusRestore;if(!l.current){var Ve,Pe=(Ve=document)==null?void 0:Ve.activeElement;l.current=Pe,Pe!==document.body&&(l.current=ze(Pe))}a.current&&H&&H(a.current),c.current=!0,d()},[H]),ke=b.useCallback(function(){c.current=!1,te&&te(a.current),d()},[te]),je=b.useCallback(function(ue){var ze=l.current;if(ze){var Ve=(typeof ze=="function"?ze():ze)||document.body,Pe=typeof Y=="function"?Y(Ve):Y;if(Pe){var $e=typeof Pe=="object"?Pe:void 0;l.current=null,ue?Promise.resolve().then(function(){return Ve.focus($e)}):Ve.focus($e)}}},[Y]),he=b.useCallback(function(ue){c.current&&AT.useMedium(ue)},[]),Tn=kT.useMedium,zn=b.useCallback(function(ue){a.current!==ue&&(a.current=ue,s(ue))},[]),Tr=Hu((r={},r[IT]=p&&"disabled",r[wv]=w,r),q),it=C!==!0,vn=it&&C!=="tail",xr=HU([n,zn]),ae=b.useMemo(function(){return{observed:a,shards:B,enabled:!p,active:c.current}},[p,c.current,B,o]);return b.createElement(b.Fragment,null,it&&[b.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:p?-1:0,style:Eg}),M?b.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:p?-1:1,style:Eg}):null],!p&&b.createElement(oe,{id:Le,sideCar:QU,observed:o,disabled:p,persistentFocus:y,crossFrame:E,autoFocus:P,whiteList:_,shards:B,onActivation:ve,onDeactivation:ke,returnFocus:je,focusOptions:re}),b.createElement(Z,Hu({ref:xr},Tr,{className:T,onBlur:Tn,onFocus:he}),b.createElement(qU.Provider,{value:ae},h)),vn&&b.createElement("div",{"data-focus-guard":!0,tabIndex:p?-1:0,style:Eg}))});Wy.propTypes={};function xv(t,e){return xv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},xv(t,e)}function t4(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,xv(t,e)}function Xu(t){"@babel/helpers - typeof";return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xu(t)}function n4(t,e){if(Xu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Xu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function r4(t){var e=n4(t,"string");return Xu(e)=="symbol"?e:e+""}function i4(t,e,n){return(e=r4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o4(t,e){function n(r){return r.displayName||r.name||"Component"}return function(i){var o=[],s;function a(){s=t(o.map(function(l){return l.props})),e(s)}var c=function(l){t4(u,l);function u(){return l.apply(this,arguments)||this}u.peek=function(){return s};var d=u.prototype;return d.componentDidMount=function(){o.push(this),a()},d.componentDidUpdate=function(){a()},d.componentWillUnmount=function(){var f=o.indexOf(this);o.splice(f,1),a()},d.render=function(){return nt.createElement(i,this.props)},u}(b.PureComponent);return i4(c,"displayName","SideEffect("+n(i)+")"),c}}var io=function(t){for(var e=Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e},Oa=function(t){return Array.isArray(t)?t:[t]},ET=function(t){return Array.isArray(t)?t[0]:t},s4=function(t){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(t,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},TT=function(t){return t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.host:t.parentNode},xT=function(t){return t===document||t&&t.nodeType===Node.DOCUMENT_NODE},a4=function(t){return t.hasAttribute("inert")},c4=function(t,e){return!t||xT(t)||!s4(t)&&!a4(t)&&e(TT(t))},PT=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=c4(e,PT.bind(void 0,t));return t.set(e,r),r},l4=function(t,e){return t&&!xT(t)?h4(t)?e(TT(t)):!1:!0},RT=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=l4(e,RT.bind(void 0,t));return t.set(e,r),r},NT=function(t){return t.dataset},u4=function(t){return t.tagName==="BUTTON"},_T=function(t){return t.tagName==="INPUT"},MT=function(t){return _T(t)&&t.type==="radio"},d4=function(t){return!((_T(t)||u4(t))&&(t.type==="hidden"||t.disabled))},h4=function(t){var e=t.getAttribute(jU);return![!0,"true",""].includes(e)},jy=function(t){var e;return!!(t&&(!((e=NT(t))===null||e===void 0)&&e.focusGuard))},Pv=function(t){return!jy(t)},f4=function(t){return!!t},p4=function(t,e){var n=Math.max(0,t.tabIndex),r=Math.max(0,e.tabIndex),i=n-r,o=t.index-e.index;if(i){if(!n)return 1;if(!r)return-1}return i||o},g4=function(t){return t.tabIndex<0&&!t.hasAttribute("tabindex")?0:t.tabIndex},Zy=function(t,e,n){return io(t).map(function(r,i){var o=g4(r);return{node:r,index:i,tabIndex:n&&o===-1?(r.dataset||{}).focusGuard?0:-1:o}}).filter(function(r){return!e||r.tabIndex>=0}).sort(p4)},m4=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],zy=m4.join(","),v4="".concat(zy,", [data-focus-guard]"),OT=function(t,e){return io((t.shadowRoot||t).children).reduce(function(n,r){return n.concat(r.matches(e?v4:zy)?[r]:[],OT(r))},[])},y4=function(t,e){var n;return t instanceof HTMLIFrameElement&&(!((n=t.contentDocument)===null||n===void 0)&&n.body)?tl([t.contentDocument.body],e):[t]},tl=function(t,e){return t.reduce(function(n,r){var i,o=OT(r,e),s=(i=[]).concat.apply(i,o.map(function(a){return y4(a,e)}));return n.concat(s,r.parentNode?io(r.parentNode.querySelectorAll(zy)).filter(function(a){return a===r}):[])},[])},C4=function(t){var e=t.querySelectorAll("[".concat(WU,"]"));return io(e).map(function(n){return tl([n])}).reduce(function(n,r){return n.concat(r)},[])},Hy=function(t,e){return io(t).filter(function(n){return PT(e,n)}).filter(function(n){return d4(n)})},bb=function(t,e){return e===void 0&&(e=new Map),io(t).filter(function(n){return RT(e,n)})},Xy=function(t,e,n){return Zy(Hy(tl(t,n),e),!0,n)},Of=function(t,e){return Zy(Hy(tl(t),e),!1)},I4=function(t,e){return Hy(C4(t),e)},Aa=function(t,e){return t.shadowRoot?Aa(t.shadowRoot,e):Object.getPrototypeOf(t).contains!==void 0&&Object.getPrototypeOf(t).contains.call(t,e)?!0:io(t.children).some(function(n){var r;if(n instanceof HTMLIFrameElement){var i=(r=n.contentDocument)===null||r===void 0?void 0:r.body;return i?Aa(i,e):!1}return Aa(n,e)})},S4=function(t){for(var e=new Set,n=t.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var o=t[r].compareDocumentPosition(t[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return t.filter(function(s,a){return!e.has(a)})},DT=function(t){return t.parentNode?DT(t.parentNode):t},$y=function(t){var e=Oa(t);return e.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(wv);return n.push.apply(n,i?S4(io(DT(r).querySelectorAll("[".concat(wv,'="').concat(i,'"]:not([').concat(IT,'="disabled"])')))):[r]),n},[])},b4=function(t){try{return t()}catch{return}},$u=function(t){if(t===void 0&&(t=document),!(!t||!t.activeElement)){var e=t.activeElement;return e.shadowRoot?$u(e.shadowRoot):e instanceof HTMLIFrameElement&&b4(function(){return e.contentWindow.document})?$u(e.contentWindow.document):e}},w4=function(t,e){return t===e},A4=function(t,e){return!!io(t.querySelectorAll("iframe")).some(function(n){return w4(n,e)})},LT=function(t,e){return e===void 0&&(e=$u(ET(t).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:$y(t).some(function(n){return Aa(n,e)||A4(n,e)})},k4=function(t){t===void 0&&(t=document);var e=$u(t);return e?io(t.querySelectorAll("[".concat(GU,"]"))).some(function(n){return Aa(n,e)}):!1},E4=function(t,e){return e.filter(MT).filter(function(n){return n.name===t.name}).filter(function(n){return n.checked})[0]||t},Ky=function(t,e){return MT(t)&&t.name?E4(t,e):t},T4=function(t){var e=new Set;return t.forEach(function(n){return e.add(Ky(n,t))}),t.filter(function(n){return e.has(n)})},wb=function(t){return t[0]&&t.length>1?Ky(t[0],t):t[0]},Ab=function(t,e){return t.indexOf(Ky(e,t))},Rv="NEW_FOCUS",x4=function(t,e,n,r,i){var o=t.length,s=t[0],a=t[o-1],c=jy(r);if(!(r&&t.indexOf(r)>=0)){var l=r!==void 0?n.indexOf(r):-1,u=i?n.indexOf(i):l,d=i?t.indexOf(i):-1;if(l===-1)return d!==-1?d:Rv;if(d===-1)return Rv;var h=l-u,f=n.indexOf(s),p=n.indexOf(a),m=T4(n),C=r!==void 0?m.indexOf(r):-1,g=C-(i?m.indexOf(i):l);if(!h&&d>=0||e.length===0)return d;var y=Ab(t,e[0]),S=Ab(t,e[e.length-1]);if(l<=f&&c&&Math.abs(h)>1)return S;if(l>=p&&c&&Math.abs(h)>1)return y;if(h&&Math.abs(g)>1)return d;if(l<=f)return S;if(l>p)return y;if(h)return Math.abs(h)>1?d:(o+d+h)%o}},P4=function(t){return function(e){var n,r=(n=NT(e))===null||n===void 0?void 0:n.autofocus;return e.autofocus||r!==void 0&&r!=="false"||t.indexOf(e)>=0}},kb=function(t,e,n){var r=t.map(function(o){var s=o.node;return s}),i=bb(r.filter(P4(n)));return i&&i.length?wb(i):wb(bb(e))},Nv=function(t,e){return e===void 0&&(e=[]),e.push(t),t.parentNode&&Nv(t.parentNode.host||t.parentNode,e),e},Tg=function(t,e){for(var n=Nv(t),r=Nv(e),i=0;i<n.length;i+=1){var o=n[i];if(r.indexOf(o)>=0)return o}return!1},BT=function(t,e,n){var r=Oa(t),i=Oa(e),o=r[0],s=!1;return i.filter(Boolean).forEach(function(a){s=Tg(s||a,a)||s,n.filter(Boolean).forEach(function(c){var l=Tg(o,c);l&&(!s||Aa(l,s)?s=l:s=Tg(l,s))})}),s},Eb=function(t,e){return t.reduce(function(n,r){return n.concat(I4(r,e))},[])},R4=function(t,e){var n=new Map;return e.forEach(function(r){return n.set(r.node,r)}),t.map(function(r){return n.get(r)}).filter(f4)},N4=function(t,e){var n=$u(Oa(t).length>0?document:ET(t).ownerDocument),r=$y(t).filter(Pv),i=BT(n||t,t,r),o=new Map,s=Of(r,o),a=s.filter(function(p){var m=p.node;return Pv(m)});if(a[0]){var c=Of([i],o).map(function(p){var m=p.node;return m}),l=R4(c,a),u=l.map(function(p){var m=p.node;return m}),d=l.filter(function(p){var m=p.tabIndex;return m>=0}).map(function(p){var m=p.node;return m}),h=x4(u,d,c,n,e);if(h===Rv){var f=kb(s,d,Eb(r,o))||kb(s,u,Eb(r,o));if(f)return{node:f};console.warn("focus-lock: cannot find any node to move focus into");return}return h===void 0?h:l[h]}},_4=function(t){var e=$y(t).filter(Pv),n=BT(t,t,e),r=Zy(tl([n],!0),!0,!0),i=tl(e,!1);return r.map(function(o){var s=o.node,a=o.index;return{node:s,index:a,lockItem:i.indexOf(s)>=0,guard:jy(s)}})},Jy=function(t,e){t&&("focus"in t&&t.focus(e),"contentWindow"in t&&t.contentWindow&&t.contentWindow.focus())},xg=0,Pg=!1,FT=function(t,e,n){n===void 0&&(n={});var r=N4(t,e);if(!Pg&&r){if(xg>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),Pg=!0,setTimeout(function(){Pg=!1},1);return}xg++,Jy(r.node,n.focusOptions),xg--}};function Fl(t){if(!t)return null;if(typeof WeakRef>"u")return function(){return t||null};var e=t?new WeakRef(t):null;return function(){return(e==null?void 0:e.deref())||null}}var M4=function(t){if(!t)return null;for(var e=[],n=t;n&&n!==document.body;)e.push({current:Fl(n),parent:Fl(n.parentElement),left:Fl(n.previousElementSibling),right:Fl(n.nextElementSibling)}),n=n.parentElement;return{element:Fl(t),stack:e,ownerDocument:t.ownerDocument}},O4=function(t){var e,n,r,i,o;if(t)for(var s=t.stack,a=t.ownerDocument,c=new Map,l=0,u=s;l<u.length;l++){var d=u[l],h=(e=d.parent)===null||e===void 0?void 0:e.call(d);if(h&&a.contains(h)){for(var f=(n=d.left)===null||n===void 0?void 0:n.call(d),p=d.current(),m=h.contains(p)?p:void 0,C=(r=d.right)===null||r===void 0?void 0:r.call(d),g=Xy([h],c),y=(o=(i=m??(f==null?void 0:f.nextElementSibling))!==null&&i!==void 0?i:C)!==null&&o!==void 0?o:f;y;){for(var S=0,E=g;S<E.length;S++){var A=E[S];if(y!=null&&y.contains(A.node))return A.node}y=y.nextElementSibling}if(g.length)return g[0].node}}},D4=function(t){var e=M4(t);return function(){return O4(e)}},L4=function(t,e,n){if(!t||!e)return console.error("no element or scope given"),{};var r=Oa(e);if(r.every(function(s){return!Aa(s,t)}))return console.error("Active element is not contained in the scope"),{};var i=n?Xy(r,new Map):Of(r,new Map),o=i.findIndex(function(s){var a=s.node;return a===t});if(o!==-1)return{prev:i[o-1],next:i[o+1],first:i[0],last:i[i.length-1]}},B4=function(t,e){var n=e?Xy(Oa(t),new Map):Of(Oa(t),new Map);return{first:n[0],last:n[n.length-1]}},F4=function(t){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},t)},UT=function(t,e,n){e===void 0&&(e={});var r=F4(e),i=L4(t,r.scope,r.onlyTabbable);if(i){var o=n(i,r.cycle);o&&Jy(o.node,r.focusOptions)}},U4=function(t,e){e===void 0&&(e={}),UT(t,e,function(n,r){var i=n.next,o=n.first;return i||r&&o})},V4=function(t,e){e===void 0&&(e={}),UT(t,e,function(n,r){var i=n.prev,o=n.last;return i||r&&o})},VT=function(t,e,n){var r,i=B4(t,(r=e.onlyTabbable)!==null&&r!==void 0?r:!0),o=i[n];o&&Jy(o.node,e.focusOptions)},G4=function(t,e){e===void 0&&(e={}),VT(t,e,"first")},W4=function(t,e){e===void 0&&(e={}),VT(t,e,"last")};function Yy(t){setTimeout(t,1)}var j4=function(e){return e&&"current"in e?e.current:e},Z4=function(){return document&&document.activeElement===document.body},z4=function(){return Z4()||k4()},Mc=null,bc=null,Oc=null,Ku=!1,H4=function(){return!0},X4=function(e){return(Mc.whiteList||H4)(e)},$4=function(e,n){Oc={observerNode:e,portaledElement:n}},K4=function(e){return Oc&&Oc.portaledElement===e};function Tb(t,e,n,r){var i=null,o=t;do{var s=r[o];if(s.guard)s.node.dataset.focusAutoGuard&&(i=s);else if(s.lockItem){if(o!==t)return;i=null}else break}while((o+=n)!==e);i&&(i.node.tabIndex=0)}var J4=function(e){return e?!!Ku:Ku==="meanwhile"},Y4=function t(e,n,r){return n&&(n.host===e&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&t(e,n.parentNode,r))},Q4=function(e,n){return n.some(function(r){return Y4(e,r,r)})},Df=function(){var e=!1;if(Mc){var n=Mc,r=n.observed,i=n.persistentFocus,o=n.autoFocus,s=n.shards,a=n.crossFrame,c=n.focusOptions,l=r||Oc&&Oc.portaledElement,u=document&&document.activeElement;if(l){var d=[l].concat(s.map(j4).filter(Boolean));if((!u||X4(u))&&(i||J4(a)||!z4()||!bc&&o)&&(l&&!(LT(d)||u&&Q4(u,d)||K4(u))&&(document&&!bc&&u&&!o?(u.blur&&u.blur(),document.body.focus()):(e=FT(d,bc,{focusOptions:c}),Oc={})),Ku=!1,bc=document&&document.activeElement),document&&u!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var h=document&&document.activeElement,f=_4(d),p=f.map(function(m){var C=m.node;return C}).indexOf(h);p>-1&&(f.filter(function(m){var C=m.guard,g=m.node;return C&&g.dataset.focusAutoGuard}).forEach(function(m){var C=m.node;return C.removeAttribute("tabIndex")}),Tb(p,f.length,1,f),Tb(p,-1,-1,f))}}}return e},GT=function(e){Df()&&e&&(e.stopPropagation(),e.preventDefault())},Qy=function(){return Yy(Df)},q4=function(e){var n=e.target,r=e.currentTarget;r.contains(n)||$4(r,n)},eV=function(){return null},WT=function(){Ku="just",Yy(function(){Ku="meanwhile"})},tV=function(){document.addEventListener("focusin",GT),document.addEventListener("focusout",Qy),window.addEventListener("blur",WT)},nV=function(){document.removeEventListener("focusin",GT),document.removeEventListener("focusout",Qy),window.removeEventListener("blur",WT)};function rV(t){return t.filter(function(e){var n=e.disabled;return!n})}var jT={moveFocusInside:FT,focusInside:LT,focusNextElement:U4,focusPrevElement:V4,focusFirstElement:G4,focusLastElement:W4,captureFocusRestore:D4};function iV(t){var e=t.slice(-1)[0];e&&!Mc&&tV();var n=Mc,r=n&&e&&e.id===n.id;Mc=e,n&&!r&&(n.onDeactivation(),t.filter(function(i){var o=i.id;return o===n.id}).length||n.returnFocus(!e)),e?(bc=null,(!r||n.observed!==e.observed)&&e.onActivation(jT),Df(),Yy(Df)):(nV(),bc=null)}AT.assignSyncMedium(q4);kT.assignMedium(Qy);YU.assignMedium(function(t){return t(jT)});const oV=o4(rV,iV)(eV);var ZT=b.forwardRef(function(e,n){return b.createElement(Wy,Hu({sideCar:oV,ref:n},e))}),zT=Wy.propTypes||{};zT.sideCar;VU(zT,["sideCar"]);ZT.propTypes={};const sV=nt.forwardRef((t,e)=>{const[n,r]=b.useState(!1),i=b.useRef(null);return nt.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),b.useEffect(()=>{var o;n&&((o=i.current)==null||o.focus())},[n]),b.useEffect(()=>{const o=s=>{s.key==="Escape"&&r(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]),X.jsx(ZT,{disabled:!n,children:X.jsxs("dialog",{className:"preferences-dialog",open:n,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[X.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),n&&X.jsx(UU,{}),X.jsx("button",{onClick:()=>r(!1),children:"Close"}),X.jsx("br",{}),X.jsxs("span",{id:"commit-hash",children:["Version: ",xU]})]})})});var HT={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},xb=nt.createContext&&nt.createContext(HT),aV=["attr","size","title"];function cV(t,e){if(t==null)return{};var n=lV(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function lV(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Lf(){return Lf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Lf.apply(this,arguments)}function Pb(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Bf(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Pb(Object(n),!0).forEach(function(r){uV(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pb(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function uV(t,e,n){return e=dV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dV(t){var e=hV(t,"string");return typeof e=="symbol"?e:e+""}function hV(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XT(t){return t&&t.map((e,n)=>nt.createElement(e.tag,Bf({key:n},e.attr),XT(e.child)))}function Xa(t){return e=>nt.createElement(fV,Lf({attr:Bf({},t.attr)},e),XT(t.child))}function fV(t){var e=n=>{var{attr:r,size:i,title:o}=t,s=cV(t,aV),a=i||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),nt.createElement("svg",Lf({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:c,style:Bf(Bf({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&nt.createElement("title",null,o),t.children)};return xb!==void 0?nt.createElement(xb.Consumer,null,n=>e(n)):e(HT)}function pV(t){return Xa({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(t)}function gV(t){return Xa({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(t)}function mV(t){return Xa({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"},child:[]}]})(t)}function $T(t){return Xa({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(t)}function vV(t){return Xa({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(t)}function yV(t){return Xa({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(t)}function CV(t){return Xa({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(t)}const IV=({client:t,onClearLog:e,onSaveLog:n,onToggleUsers:r,onOpenPrefs:i})=>{const[o,s]=nt.useState(t.cacophony.muted);return X.jsxs("div",{className:"toolbar",children:[X.jsxs("button",{onClick:n,accessKey:"l",children:[X.jsx($T,{}),"Save Log"]}),X.jsxs("button",{onClick:e,accessKey:"c",children:[X.jsx(mV,{}),"Clear Log"]}),X.jsxs("button",{onClick:i,accessKey:"p",children:[X.jsx(pV,{}),"Preferences"]}),X.jsxs("button",{onClick:()=>{s(!o),t.cacophony.muted=!o},accessKey:"m",children:[o?X.jsx(CV,{}):X.jsx(yV,{}),o?"Unmute":"Mute"]}),X.jsxs("label",{children:["Volume",X.jsx("input",{type:"range",min:"0",max:"100",onChange:a=>Howler.volume(Number(a.target.value)/100)})]}),X.jsx("button",{onClick:r,accessKey:"u",children:"Show/Hide Users"}),X.jsxs("label",{children:["Volume",X.jsx("input",{type:"range",min:"0",max:"100",onChange:a=>t.cacophony.setGlobalVolume(Number(a.target.value)/100)})]})]})};class SV extends nt.Component{constructor(e){super(e),this.state={statusText:"Not connected"},e.client.on("statustext",n=>this.setState({statusText:n})),e.client.on("connect",()=>this.setState({statusText:"Connected"})),e.client.on("disconnect",()=>this.setState({statusText:"Disconnected"}))}render(){return X.jsx("div",{className:"statusbar",children:this.state.statusText})}}const bV=({users:t})=>X.jsxs("div",{className:"sidebar",children:[X.jsx("div",{className:"sidebar-header",role:"heading","aria-level":2,children:"Connected Players"}),X.jsx("div",{className:"sidebar-content",children:X.jsx("ul",{children:t.map(e=>{let n="";return e.away&&(n+=" away"),e.idle&&(n+=" idle"),X.jsx("li",{className:n,children:e.Name},e.Object)})})})]});var Rb={};function wV(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var AV=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kV(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var KT={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(AV,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function o(m,C){var g=m[C];if(typeof g.bind=="function")return g.bind(m);try{return Function.prototype.bind.call(g,m)}catch{return function(){return Function.prototype.apply.apply(g,[m,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?s:console[m]!==void 0?o(console,m):console.log!==void 0?o(console,"log"):e}function c(m,C){for(var g=0;g<i.length;g++){var y=i[g];this[y]=g<m?e:this.methodFactory(y,m,C)}this.log=this.debug}function l(m,C,g){return function(){typeof console!==n&&(c.call(this,C,g),this[m].apply(this,arguments))}}function u(m,C,g){return a(m)||l.apply(this,arguments)}function d(m,C,g){var y=this,S;C=C??"WARN";var E="loglevel";typeof m=="string"?E+=":"+m:typeof m=="symbol"&&(E=void 0);function A(_){var M=(i[_]||"silent").toUpperCase();if(!(typeof window===n||!E)){try{window.localStorage[E]=M;return}catch{}try{window.document.cookie=encodeURIComponent(E)+"="+M+";"}catch{}}}function P(){var _;if(!(typeof window===n||!E)){try{_=window.localStorage[E]}catch{}if(typeof _===n)try{var M=window.document.cookie,D=M.indexOf(encodeURIComponent(E)+"=");D!==-1&&(_=/^([^;]+)/.exec(M.slice(D))[1])}catch{}return y.levels[_]===void 0&&(_=void 0),_}}function w(){if(!(typeof window===n||!E)){try{window.localStorage.removeItem(E);return}catch{}try{window.document.cookie=encodeURIComponent(E)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}y.name=m,y.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},y.methodFactory=g||u,y.getLevel=function(){return S},y.setLevel=function(_,M){if(typeof _=="string"&&y.levels[_.toUpperCase()]!==void 0&&(_=y.levels[_.toUpperCase()]),typeof _=="number"&&_>=0&&_<=y.levels.SILENT){if(S=_,M!==!1&&A(_),c.call(y,_,m),typeof console===n&&_<y.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+_},y.setDefaultLevel=function(_){C=_,P()||y.setLevel(_,!1)},y.resetLevel=function(){y.setLevel(C,!1),w()},y.enableAll=function(_){y.setLevel(y.levels.TRACE,_)},y.disableAll=function(_){y.setLevel(y.levels.SILENT,_)};var T=P();T==null&&(T=C),y.setLevel(T,!1)}var h=new d,f={};h.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var g=f[C];return g||(g=f[C]=new d(C,h.getLevel(),h.methodFactory)),g};var p=typeof window!==n?window.log:void 0;return h.noConflict=function(){return typeof window!==n&&window.log===h&&(window.log=p),h},h.getLoggers=function(){return f},h.default=h,h})})(KT);var qy=KT.exports,_v;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(_v||(_v={}));var Qi;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(Qi||(Qi={}));let Ue=qy.getLogger("livekit");Ue.setDefaultLevel(_v.info);function Qo(t){const e=qy.getLogger(t);return e.setDefaultLevel(Ue.getLevel()),e}qy.getLogger("lk-e2ee");function Qn(t,e){if(!t)throw new Error(e)}const EV=34028234663852886e22,TV=-34028234663852886e22,xV=4294967295,PV=2147483647,RV=-2147483648;function Rh(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>PV||t<RV)throw new Error("invalid int 32: "+t)}function Mv(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>xV||t<0)throw new Error("invalid uint 32: "+t)}function JT(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>EV||t<TV))throw new Error("invalid float 32: "+t)}const YT=Symbol("@bufbuild/protobuf/enum-type");function NV(t){const e=t[YT];return Qn(e,"missing enum type on enum object"),e}function QT(t,e,n,r){t[YT]=qT(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function qT(t,e,n){const r=Object.create(null),i=Object.create(null),o=[];for(const s of e){const a=ex(s);o.push(a),r[s.name]=a,i[s.no]=a}return{typeName:t,values:o,findName(s){return r[s]},findNumber(s){return i[s]}}}function _V(t,e,n){const r={};for(const i of e){const o=ex(i);r[o.localName]=o.no,r[o.no]=o.localName}return QT(r,t,e),r}function ex(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class pe{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,o=i.makeReadOptions(n);return i.readMessage(this,o.readerFactory(e),e.byteLength,o),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,o=i.makeReadOptions(n);return i.readMessage(r,e,o,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),o=i.writerFactory();return r.writeMessage(this,o,i),o.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function MV(t,e,n,r){var i;const o=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),s={[o]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[o];return Object.setPrototypeOf(s.prototype,new pe),Object.assign(s,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,c){return new s().fromBinary(a,c)},fromJson(a,c){return new s().fromJson(a,c)},fromJsonString(a,c){return new s().fromJsonString(a,c)},equals(a,c){return t.util.equals(s,a,c)}}),s}function OV(t,e,n,r){return{syntax:t,json:e,bin:n,util:r,makeMessageType(i,o,s){return MV(this,i,o,s)},makeEnum:_V,makeEnumType:qT,getEnumType:NV}}var Q;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(Q||(Q={}));var Da;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Da||(Da={}));function DV(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Rg(t,e,n){for(let o=0;o<28;o=o+7){const s=t>>>o,a=!(!(s>>>7)&&e==0),c=(a?s|128:s)&255;if(n.push(c),!a)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let o=3;o<31;o=o+7){const s=e>>>o,a=!!(s>>>7),c=(a?s|128:s)&255;if(n.push(c),!a)return}n.push(e>>>31&1)}}const Nh=4294967296;function Nb(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function o(s,a){const c=Number(t.slice(s,a));i*=n,r=r*n+c,r>=Nh&&(i=i+(r/Nh|0),r=r%Nh)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),e?nx(r,i):eC(r,i)}function LV(t,e){let n=eC(t,e);const r=n.hi&2147483648;r&&(n=nx(n.lo,n.hi));const i=tx(n.lo,n.hi);return r?"-"+i:i}function tx(t,e){if({lo:t,hi:e}=BV(t,e),e<=2097151)return String(Nh*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let o=n+r*6777216+i*6710656,s=r+i*8147497,a=i*2;const c=1e7;return o>=c&&(s+=Math.floor(o/c),o%=c),s>=c&&(a+=Math.floor(s/c),s%=c),a.toString()+_b(s)+_b(o)}function BV(t,e){return{lo:t>>>0,hi:e>>>0}}function eC(t,e){return{lo:t|0,hi:e|0}}function nx(t,e){return e=~e,t?t=~t+1:e+=1,eC(t,e)}const _b=t=>{const e=String(t);return"0000000".slice(e.length)+e};function Mb(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function FV(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function UV(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof Rb!="object"||Rb.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>o||l<i)throw new Error("int64 invalid: ".concat(c));return l},uParse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>a||l<s)throw new Error("uint64 invalid: ".concat(c));return l},enc(c){return t.setBigInt64(0,this.parse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(c){return t.setBigInt64(0,this.uParse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigInt64(0,!0)},uDec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigUint64(0,!0)}}}const n=i=>Qn(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>Qn(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),Nb(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),Nb(i)},dec(i,o){return LV(i,o)},uDec(i,o){return tx(i,o)}}}const Me=UV();var Rt;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(Rt||(Rt={}));class VV{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Mv(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Rh(e),Mb(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){JT(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Mv(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Rh(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Rh(e),e=(e<<1^e>>31)>>>0,Mb(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Me.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Me.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=Me.enc(e);return Rg(n.lo,n.hi,this.buf),this}sint64(e){let n=Me.enc(e),r=n.hi>>31,i=n.lo<<1^r,o=(n.hi<<1|n.lo>>>31)^r;return Rg(i,o,this.buf),this}uint64(e){let n=Me.uEnc(e);return Rg(n.lo,n.hi,this.buf),this}}class GV{constructor(e,n){this.varint64=DV,this.uint32=FV,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e){let n=this.pos;switch(e){case Rt.Varint:for(;this.buf[this.pos++]&128;);break;case Rt.Bit64:this.pos+=4;case Rt.Bit32:this.pos+=4;break;case Rt.LengthDelimited:let r=this.uint32();this.pos+=r;break;case Rt.StartGroup:let i;for(;(i=this.tag()[1])!==Rt.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Me.dec(...this.varint64())}uint64(){return Me.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,Me.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Me.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Me.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function Ov(t,e){return e instanceof pe||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}Q.DOUBLE,Q.FLOAT,Q.INT64,Q.UINT64,Q.INT32,Q.UINT32,Q.BOOL,Q.STRING,Q.BYTES;function us(t,e,n){if(e===n)return!0;if(t==Q.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case Q.UINT64:case Q.FIXED64:case Q.INT64:case Q.SFIXED64:case Q.SINT64:return e==n}return!1}function Dv(t,e){switch(t){case Q.BOOL:return!1;case Q.UINT64:case Q.FIXED64:case Q.INT64:case Q.SFIXED64:case Q.SINT64:return e==0?Me.zero:"0";case Q.DOUBLE:case Q.FLOAT:return 0;case Q.BYTES:return new Uint8Array(0);case Q.STRING:return"";default:return 0}}function rx(t,e){const n=e===void 0;let r=Rt.Varint,i=e===0;switch(t){case Q.STRING:i=n||!e.length,r=Rt.LengthDelimited;break;case Q.BOOL:i=e===!1;break;case Q.DOUBLE:r=Rt.Bit64;break;case Q.FLOAT:r=Rt.Bit32;break;case Q.INT64:i=n||e==0;break;case Q.UINT64:i=n||e==0;break;case Q.FIXED64:i=n||e==0,r=Rt.Bit64;break;case Q.BYTES:i=n||!e.byteLength,r=Rt.LengthDelimited;break;case Q.FIXED32:r=Rt.Bit32;break;case Q.SFIXED32:r=Rt.Bit32;break;case Q.SFIXED64:i=n||e==0,r=Rt.Bit64;break;case Q.SINT64:i=n||e==0;break}const o=Q[t].toLowerCase();return[r,o,n||i]}const rc=Symbol("@bufbuild/protobuf/unknown-fields"),Ob={readUnknownFields:!0,readerFactory:t=>new GV(t)},Db={writeUnknownFields:!0,writerFactory:()=>new VV};function WV(t){return t?Object.assign(Object.assign({},Ob),t):Ob}function jV(t){return t?Object.assign(Object.assign({},Db),t):Db}function ZV(){return{makeReadOptions:WV,makeWriteOptions:jV,listUnknownFields(t){var e;return(e=t[rc])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[rc]},writeUnknownFields(t,e){const r=t[rc];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[rc])||(i[rc]=[]),i[rc].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r){const i=t.getType(),o=n===void 0?e.len:e.pos+n;for(;e.pos<o;){const[s,a]=e.tag(),c=i.fields.find(s);if(!c){const h=e.skip(a);r.readUnknownFields&&this.onUnknownField(t,s,a,h);continue}let l=t,u=c.repeated,d=c.localName;switch(c.oneof&&(l=l[c.oneof.localName],l.case!=d&&delete l.value,l.case=d,d="value"),c.kind){case"scalar":case"enum":const h=c.kind=="enum"?Q.INT32:c.T;let f=Ff;if(c.kind=="scalar"&&c.L>0&&(f=HV),u){let g=l[d];if(a==Rt.LengthDelimited&&h!=Q.STRING&&h!=Q.BYTES){let y=e.uint32()+e.pos;for(;e.pos<y;)g.push(f(e,h))}else g.push(f(e,h))}else l[d]=f(e,h);break;case"message":const p=c.T;u?l[d].push(_h(e,new p,r)):l[d]instanceof pe?_h(e,l[d],r):(l[d]=_h(e,new p,r),p.fieldWrapper&&!c.oneof&&!c.repeated&&(l[d]=p.fieldWrapper.unwrapField(l[d])));break;case"map":let[m,C]=zV(c,e,r);l[d][m]=C;break}}}}}function _h(t,e,n){return e.getType().runtime.bin.readMessage(e,t,t.uint32(),n),e}function zV(t,e,n){const r=e.uint32(),i=e.pos+r;let o,s;for(;e.pos<i;){let[a]=e.tag();switch(a){case 1:o=Ff(e,t.K);break;case 2:switch(t.V.kind){case"scalar":s=Ff(e,t.V.T);break;case"enum":s=e.int32();break;case"message":s=_h(e,new t.V.T,n);break}break}}if(o===void 0){let a=Dv(t.K,Da.BIGINT);o=t.K==Q.BOOL?a.toString():a}if(typeof o!="string"&&typeof o!="number"&&(o=o.toString()),s===void 0)switch(t.V.kind){case"scalar":s=Dv(t.V.T,Da.BIGINT);break;case"enum":s=0;break;case"message":s=new t.V.T;break}return[o,s]}function HV(t,e){const n=Ff(t,e);return typeof n=="bigint"?n.toString():n}function Ff(t,e){switch(e){case Q.STRING:return t.string();case Q.BOOL:return t.bool();case Q.DOUBLE:return t.double();case Q.FLOAT:return t.float();case Q.INT32:return t.int32();case Q.INT64:return t.int64();case Q.UINT64:return t.uint64();case Q.FIXED64:return t.fixed64();case Q.BYTES:return t.bytes();case Q.FIXED32:return t.fixed32();case Q.SFIXED32:return t.sfixed32();case Q.SFIXED64:return t.sfixed64();case Q.SINT64:return t.sint64();case Q.UINT32:return t.uint32();case Q.SINT32:return t.sint32()}}function XV(t,e,n,r,i){t.tag(n.no,Rt.LengthDelimited),t.fork();let o=r;switch(n.K){case Q.INT32:case Q.FIXED32:case Q.UINT32:case Q.SFIXED32:case Q.SINT32:o=Number.parseInt(r);break;case Q.BOOL:Qn(r=="true"||r=="false"),o=r=="true";break}switch(vu(t,n.K,1,o,!0),n.V.kind){case"scalar":vu(t,n.V.T,2,i,!0);break;case"enum":vu(t,Q.INT32,2,i,!0);break;case"message":Lv(t,e,n.V.T,2,i);break}t.join()}function Lv(t,e,n,r,i){if(i!==void 0){const o=Ov(n,i);t.tag(r,Rt.LengthDelimited).bytes(o.toBinary(e))}}function vu(t,e,n,r,i){let[o,s,a]=rx(e,r);(!a||i)&&t.tag(n,o)[s](r)}function $V(t,e,n,r){if(!r.length)return;t.tag(n,Rt.LengthDelimited).fork();let[,i]=rx(e);for(let o=0;o<r.length;o++)t[i](r[o]);t.join()}function KV(){return Object.assign(Object.assign({},ZV()),{writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){let o,s=i.repeated,a=i.localName;if(i.oneof){const c=t[i.oneof.localName];if(c.case!==a)continue;o=c.value}else o=t[a];switch(i.kind){case"scalar":case"enum":let c=i.kind=="enum"?Q.INT32:i.T;if(s)if(i.packed)$V(e,c,i.no,o);else for(const l of o)vu(e,c,i.no,l,!0);else o!==void 0&&vu(e,c,i.no,o,!!i.oneof||i.opt);break;case"message":if(s)for(const l of o)Lv(e,n,i.T,i.no,l);else Lv(e,n,i.T,i.no,o);break;case"map":for(const[l,u]of Object.entries(o))XV(e,n,i,l,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}let po="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Ap=[];for(let t=0;t<po.length;t++)Ap[po[t].charCodeAt(0)]=t;Ap[45]=po.indexOf("+");Ap[95]=po.indexOf("/");const ix={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,o,s=0;for(let a=0;a<t.length;a++){if(o=Ap[t.charCodeAt(a)],o===void 0)switch(t[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:s=o,i=1;break;case 1:n[r++]=s<<2|(o&48)>>4,s=o,i=2;break;case 2:n[r++]=(s&15)<<4|(o&60)>>2,s=o,i=3;break;case 3:n[r++]=(s&3)<<6|o,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let o=0;o<t.length;o++)switch(r=t[o],n){case 0:e+=po[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=po[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=po[i|r>>6],e+=po[r&63],n=0;break}return n&&(e+=po[i],e+="=",n==1&&(e+="=")),e}},Lb={ignoreUnknownFields:!1},Bb={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function JV(t){return t?Object.assign(Object.assign({},Lb),t):Lb}function YV(t){return t?Object.assign(Object.assign({},Bb),t):Bb}function QV(t){const e=t(qV,Fb);return{makeReadOptions:JV,makeWriteOptions:YV,readMessage(n,r,i,o){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(r)));o=o??new n;const s={};for(const[a,c]of Object.entries(r)){const l=n.fields.findJsonName(a);if(!l){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let u=l.localName,d=o;if(l.oneof){if(c===null&&l.kind=="scalar")continue;const h=s[l.oneof.localName];if(h)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(l.oneof.name,'" present: "').concat(h,'", "').concat(a,'"'));s[l.oneof.localName]=a,d=d[l.oneof.localName]={case:u},u="value"}if(l.repeated){if(c===null)continue;if(!Array.isArray(c))throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const h=d[u];for(const f of c){if(f===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(f)));let p;switch(l.kind){case"message":p=l.T.fromJson(f,i);break;case"enum":if(p=Ng(l.T,f,i.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=Ul(l.T,f,l.L)}catch(m){let C="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(f));throw m instanceof Error&&m.message.length>0&&(C+=": ".concat(m.message)),new Error(C)}break}h.push(p)}}else if(l.kind=="map"){if(c===null)continue;if(Array.isArray(c)||typeof c!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const h=d[u];for(const[f,p]of Object.entries(c)){if(p===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: map value null"));let m;switch(l.V.kind){case"message":m=l.V.T.fromJson(p,i);break;case"enum":if(m=Ng(l.V.T,p,i.ignoreUnknownFields),m===void 0)continue;break;case"scalar":try{m=Ul(l.V.T,p,Da.BIGINT)}catch(C){let g="cannot decode map value for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw C instanceof Error&&C.message.length>0&&(g+=": ".concat(C.message)),new Error(g)}break}try{h[Ul(l.K,l.K==Q.BOOL?f=="true"?!0:f=="false"?!1:f:f,Da.BIGINT).toString()]=m}catch(C){let g="cannot decode map key for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw C instanceof Error&&C.message.length>0&&(g+=": ".concat(C.message)),new Error(g)}}}else switch(l.kind){case"message":const h=l.T;if(c===null&&h.typeName!="google.protobuf.Value"){if(l.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}d[u]instanceof pe?d[u].fromJson(c,i):(d[u]=h.fromJson(c,i),h.fieldWrapper&&!l.oneof&&(d[u]=h.fieldWrapper.unwrapField(d[u])));break;case"enum":const f=Ng(l.T,c,i.ignoreUnknownFields);f!==void 0&&(d[u]=f);break;case"scalar":try{d[u]=Ul(l.T,c,l.L)}catch(p){let m="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw p instanceof Error&&p.message.length>0&&(m+=": ".concat(p.message)),new Error(m)}break}}return o},writeMessage(n,r){const i=n.getType(),o={};let s;try{for(const a of i.fields.byMember()){let c;if(a.kind=="oneof"){const l=n[a.localName];if(l.value===void 0)continue;if(s=a.findField(l.case),!s)throw"oneof case not found: "+l.case;c=e(s,l.value,r)}else s=a,c=e(s,n[s.localName],r);c!==void 0&&(o[r.useProtoFieldName?s.name:s.jsonName]=c)}}catch(a){const c=s?"cannot encode field ".concat(i.typeName,".").concat(s.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),l=a instanceof Error?a.message:String(a);throw new Error(c+(l.length>0?": ".concat(l):""))}return o},readScalar:Ul,writeScalar:Fb,debug:ox}}function ox(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function Ul(t,e,n){switch(t){case Q.DOUBLE:case Q.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==Q.FLOAT&&JT(r),r;case Q.INT32:case Q.FIXED32:case Q.SFIXED32:case Q.SINT32:case Q.UINT32:if(e===null)return 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return t==Q.UINT32?Mv(i):Rh(i),i;case Q.INT64:case Q.SFIXED64:case Q.SINT64:if(e===null)return Me.zero;if(typeof e!="number"&&typeof e!="string")break;const o=Me.parse(e);return n?o.toString():o;case Q.FIXED64:case Q.UINT64:if(e===null)return Me.zero;if(typeof e!="number"&&typeof e!="string")break;const s=Me.uParse(e);return n?s.toString():s;case Q.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case Q.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case Q.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return ix.dec(e)}throw new Error}function Ng(t,e,n){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=t.findName(e);if(r||n)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(ox(e)))}function qV(t,e,n,r){var i;if(e===void 0)return e;if(e===0&&!n)return;if(r)return e;if(t.typeName=="google.protobuf.NullValue")return null;const o=t.findNumber(e);return(i=o==null?void 0:o.name)!==null&&i!==void 0?i:e}function Fb(t,e,n){if(e!==void 0)switch(t){case Q.INT32:case Q.SFIXED32:case Q.SINT32:case Q.FIXED32:case Q.UINT32:return Qn(typeof e=="number"),e!=0||n?e:void 0;case Q.FLOAT:case Q.DOUBLE:return Qn(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case Q.STRING:return Qn(typeof e=="string"),e.length>0||n?e:void 0;case Q.BOOL:return Qn(typeof e=="boolean"),e||n?e:void 0;case Q.UINT64:case Q.FIXED64:case Q.INT64:case Q.SFIXED64:case Q.SINT64:return Qn(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case Q.BYTES:return Qn(e instanceof Uint8Array),n||e.byteLength>0?ix.enc(e):void 0}}function eG(){return QV((t,e)=>function(r,i,o){if(r.kind=="map"){const s={};switch(r.V.kind){case"scalar":for(const[c,l]of Object.entries(i)){const u=e(r.V.T,l,!0);Qn(u!==void 0),s[c.toString()]=u}break;case"message":for(const[c,l]of Object.entries(i))s[c.toString()]=l.toJson(o);break;case"enum":const a=r.V.T;for(const[c,l]of Object.entries(i)){Qn(l===void 0||typeof l=="number");const u=t(a,l,!0,o.enumAsInteger);Qn(u!==void 0),s[c.toString()]=u}break}return o.emitDefaultValues||Object.keys(s).length>0?s:void 0}else if(r.repeated){const s=[];switch(r.kind){case"scalar":for(let a=0;a<i.length;a++)s.push(e(r.T,i[a],!0));break;case"enum":for(let a=0;a<i.length;a++)s.push(t(r.T,i[a],!0,o.enumAsInteger));break;case"message":for(let a=0;a<i.length;a++)s.push(Ov(r.T,i[a]).toJson(o));break}return o.emitDefaultValues||s.length>0?s:void 0}else switch(r.kind){case"scalar":return e(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues);case"enum":return t(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues,o.enumAsInteger);case"message":return i!==void 0?Ov(r.T,i).toJson(o):void 0}})}function tG(){return{setEnumType:QT,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,o=e,s=t;if(s[i]!==void 0)switch(r.kind){case"oneof":const a=s[i].case;if(a===void 0)continue;const c=r.findField(a);let l=s[i].value;c&&c.kind=="message"&&!(l instanceof c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===Q.BYTES&&(l=Vl(l)),o[i]={case:a,value:l};break;case"scalar":case"enum":let u=s[i];r.T===Q.BYTES&&(u=r.repeated?u.map(Vl):Vl(u)),o[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===Q.BYTES)for(const[f,p]of Object.entries(s[i]))o[i][f]=Vl(p);else Object.assign(o[i],s[i]);break;case"message":const h=r.V.T;for(const f of Object.keys(s[i])){let p=s[i][f];h.fieldWrapper||(p=new h(p)),o[i][f]=p}break}break;case"message":const d=r.T;if(r.repeated)o[i]=s[i].map(h=>h instanceof d?h:new d(h));else if(s[i]!==void 0){const h=s[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?o[i]=Vl(h):o[i]=h:o[i]=h instanceof d?h:new d(h)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],o=n[r.localName];if(r.repeated){if(i.length!==o.length)return!1;switch(r.kind){case"message":return i.every((s,a)=>r.T.equals(s,o[a]));case"scalar":return i.every((s,a)=>us(r.T,s,o[a]));case"enum":return i.every((s,a)=>us(Q.INT32,s,o[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,o);case"enum":return us(Q.INT32,i,o);case"scalar":return us(r.T,i,o);case"oneof":if(i.case!==o.case)return!1;const s=r.findField(i.case);if(s===void 0)return!0;switch(s.kind){case"message":return s.T.equals(i.value,o.value);case"enum":return us(Q.INT32,i.value,o.value);case"scalar":return us(s.T,i.value,o.value)}throw new Error("oneof cannot contain ".concat(s.kind));case"map":const a=Object.keys(i).concat(Object.keys(o));switch(r.V.kind){case"message":const c=r.V.T;return a.every(u=>c.equals(i[u],o[u]));case"enum":return a.every(u=>us(Q.INT32,i[u],o[u]));case"scalar":const l=r.V.T;return a.every(u=>us(l,i[u],o[u]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const o=t[i.localName];let s;if(i.repeated)s=o.map(Qd);else if(i.kind=="map"){s=r[i.localName];for(const[a,c]of Object.entries(o))s[a]=Qd(c)}else i.kind=="oneof"?s=i.findField(o.case)?{case:o.case,value:Qd(o.value)}:{case:void 0}:s=Qd(o);r[i.localName]=s}return n}}}function Qd(t){if(t===void 0)return t;if(t instanceof pe)return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function Vl(t){return t instanceof Uint8Array?t:new Uint8Array(t)}class nG{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function sx(t,e){const n=ax(t);return e?n:cG(aG(n))}function rG(t){return sx(t,!1)}const iG=ax;function ax(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const oG=new Set(["constructor","toString","toJSON","valueOf"]),sG=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),cx=t=>"".concat(t,"$"),aG=t=>sG.has(t)?cx(t):t,cG=t=>oG.has(t)?cx(t):t;class lG{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=rG(e)}addField(e){Qn(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}const x=OV("proto3",eG(),KV(),Object.assign(Object.assign({},tG()),{newFieldList(t){return new nG(t,uG)},initFields(t){for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=Dv(e.T,e.L);break}}}}));function uG(t){var e,n,r,i;const o=[];let s;for(const a of typeof t=="function"?t():t){const c=a;if(c.localName=sx(a.name,a.oneof!==void 0),c.jsonName=(e=a.jsonName)!==null&&e!==void 0?e:iG(a.name),c.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(c.L=(r=a.L)!==null&&r!==void 0?r:Da.BIGINT),c.packed=(i=a.packed)!==null&&i!==void 0?i:a.kind=="enum"||a.kind=="scalar"&&a.T!=Q.BYTES&&a.T!=Q.STRING,a.oneof!==void 0){const l=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!s||s.name!=l)&&(s=new lG(l)),c.oneof=s,s.addField(c)}o.push(c)}return o}class Yt extends pe{constructor(e){super(),this.seconds=Me.zero,this.nanos=0,x.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(x.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Me.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Yt.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new Yt({seconds:Me.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new Yt().fromBinary(e,n)}static fromJson(e,n){return new Yt().fromJson(e,n)}static fromJsonString(e,n){return new Yt().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Yt,e,n)}}Yt.runtime=x;Yt.typeName="google.protobuf.Timestamp";Yt.fields=x.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var Bv;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC"})(Bv||(Bv={}));x.util.setEnumType(Bv,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var Fv;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8"})(Fv||(Fv={}));x.util.setEnumType(Fv,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var Uv;(function(t){t[t.IC_DEFAULT=0]="IC_DEFAULT",t[t.IC_JPEG=1]="IC_JPEG"})(Uv||(Uv={}));x.util.setEnumType(Uv,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var bn;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA"})(bn||(bn={}));x.util.setEnumType(bn,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var Nt;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(Nt||(Nt={}));x.util.setEnumType(Nt,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var Zt;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF"})(Zt||(Zt={}));x.util.setEnumType(Zt,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var vo;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.LOST=3]="LOST"})(vo||(vo={}));x.util.setEnumType(vo,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var Ci;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED"})(Ci||(Ci={}));x.util.setEnumType(Ci,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var jo;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE"})(jo||(jo={}));x.util.setEnumType(jo,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var uo;(function(t){t[t.RR_UNKNOWN=0]="RR_UNKNOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(uo||(uo={}));x.util.setEnumType(uo,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var Ju;(function(t){t[t.SE_UNKNOWN=0]="SE_UNKNOWN",t[t.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",t[t.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(Ju||(Ju={}));x.util.setEnumType(Ju,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let Cl=class nu extends pe{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=Me.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,x.util.initPartial(e,this)}static fromBinary(e,n){return new nu().fromBinary(e,n)}static fromJson(e,n){return new nu().fromJson(e,n)}static fromJsonString(e,n){return new nu().fromJsonString(e,n)}static equals(e,n){return x.util.equals(nu,e,n)}};Cl.runtime=x;Cl.typeName="livekit.Room";Cl.fields=x.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:ai,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class ai extends pe{constructor(e){super(),this.mime="",this.fmtpLine="",x.util.initPartial(e,this)}static fromBinary(e,n){return new ai().fromBinary(e,n)}static fromJson(e,n){return new ai().fromJson(e,n)}static fromJsonString(e,n){return new ai().fromJsonString(e,n)}static equals(e,n){return x.util.equals(ai,e,n)}}ai.runtime=x;ai.typeName="livekit.Codec";ai.fields=x.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class Ts extends pe{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,x.util.initPartial(e,this)}static fromBinary(e,n){return new Ts().fromBinary(e,n)}static fromJson(e,n){return new Ts().fromJson(e,n)}static fromJsonString(e,n){return new Ts().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Ts,e,n)}}Ts.runtime=x;Ts.typeName="livekit.PlayoutDelay";Ts.fields=x.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class yo extends pe{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,x.util.initPartial(e,this)}static fromBinary(e,n){return new yo().fromBinary(e,n)}static fromJson(e,n){return new yo().fromJson(e,n)}static fromJsonString(e,n){return new yo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(yo,e,n)}}yo.runtime=x;yo.typeName="livekit.ParticipantPermission";yo.fields=x.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:x.getEnumType(Nt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class Ir extends pe{constructor(e){super(),this.sid="",this.identity="",this.state=La.JOINING,this.tracks=[],this.metadata="",this.joinedAt=Me.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,x.util.initPartial(e,this)}static fromBinary(e,n){return new Ir().fromBinary(e,n)}static fromJson(e,n){return new Ir().fromJson(e,n)}static fromJsonString(e,n){return new Ir().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Ir,e,n)}}Ir.runtime=x;Ir.typeName="livekit.ParticipantInfo";Ir.fields=x.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:x.getEnumType(La)},{no:4,name:"tracks",kind:"message",T:er,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:yo},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var La;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED"})(La||(La={}));x.util.setEnumType(La,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class xs extends pe{constructor(e){super(),x.util.initPartial(e,this)}static fromBinary(e,n){return new xs().fromBinary(e,n)}static fromJson(e,n){return new xs().fromJson(e,n)}static fromJsonString(e,n){return new xs().fromJsonString(e,n)}static equals(e,n){return x.util.equals(xs,e,n)}}xs.runtime=x;xs.typeName="livekit.Encryption";xs.fields=x.util.newFieldList(()=>[]);var sn;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM"})(sn||(sn={}));x.util.setEnumType(sn,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class Co extends pe{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Co().fromBinary(e,n)}static fromJson(e,n){return new Co().fromJson(e,n)}static fromJsonString(e,n){return new Co().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Co,e,n)}}Co.runtime=x;Co.typeName="livekit.SimulcastCodecInfo";Co.fields=x.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Bn,repeated:!0}]);class er extends pe{constructor(e){super(),this.sid="",this.type=bn.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=Nt.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=sn.NONE,this.stream="",x.util.initPartial(e,this)}static fromBinary(e,n){return new er().fromBinary(e,n)}static fromJson(e,n){return new er().fromJson(e,n)}static fromJsonString(e,n){return new er().fromJsonString(e,n)}static equals(e,n){return x.util.equals(er,e,n)}}er.runtime=x;er.typeName="livekit.TrackInfo";er.fields=x.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:x.getEnumType(bn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:x.getEnumType(Nt)},{no:10,name:"layers",kind:"message",T:Bn,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Co,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:x.getEnumType(sn)},{no:17,name:"stream",kind:"scalar",T:9}]);class Bn extends pe{constructor(e){super(),this.quality=Zt.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,x.util.initPartial(e,this)}static fromBinary(e,n){return new Bn().fromBinary(e,n)}static fromJson(e,n){return new Bn().fromJson(e,n)}static fromJsonString(e,n){return new Bn().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Bn,e,n)}}Bn.runtime=x;Bn.typeName="livekit.VideoLayer";Bn.fields=x.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:x.getEnumType(Zt)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class _i extends pe{constructor(e){super(),this.kind=Vt.RELIABLE,this.value={case:void 0},x.util.initPartial(e,this)}static fromBinary(e,n){return new _i().fromBinary(e,n)}static fromJson(e,n){return new _i().fromJson(e,n)}static fromJsonString(e,n){return new _i().fromJsonString(e,n)}static equals(e,n){return x.util.equals(_i,e,n)}}_i.runtime=x;_i.typeName="livekit.DataPacket";_i.fields=x.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:x.getEnumType(Vt)},{no:2,name:"user",kind:"message",T:Oi,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Io,oneof:"value"}]);var Vt;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY"})(Vt||(Vt={}));x.util.setEnumType(Vt,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class Io extends pe{constructor(e){super(),this.speakers=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Io().fromBinary(e,n)}static fromJson(e,n){return new Io().fromJson(e,n)}static fromJsonString(e,n){return new Io().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Io,e,n)}}Io.runtime=x;Io.typeName="livekit.ActiveSpeakerUpdate";Io.fields=x.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Mi,repeated:!0}]);class Mi extends pe{constructor(e){super(),this.sid="",this.level=0,this.active=!1,x.util.initPartial(e,this)}static fromBinary(e,n){return new Mi().fromBinary(e,n)}static fromJson(e,n){return new Mi().fromJson(e,n)}static fromJsonString(e,n){return new Mi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Mi,e,n)}}Mi.runtime=x;Mi.typeName="livekit.SpeakerInfo";Mi.fields=x.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class Oi extends pe{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Oi().fromBinary(e,n)}static fromJson(e,n){return new Oi().fromJson(e,n)}static fromJsonString(e,n){return new Oi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Oi,e,n)}}Oi.runtime=x;Oi.typeName="livekit.UserPacket";Oi.fields=x.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class Di extends pe{constructor(e){super(),this.participantSid="",this.trackSids=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Di().fromBinary(e,n)}static fromJson(e,n){return new Di().fromJson(e,n)}static fromJsonString(e,n){return new Di().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Di,e,n)}}Di.runtime=x;Di.typeName="livekit.ParticipantTracks";Di.fields=x.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class So extends pe{constructor(e){super(),this.edition=nl.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",x.util.initPartial(e,this)}static fromBinary(e,n){return new So().fromBinary(e,n)}static fromJson(e,n){return new So().fromJson(e,n)}static fromJsonString(e,n){return new So().fromJsonString(e,n)}static equals(e,n){return x.util.equals(So,e,n)}}So.runtime=x;So.typeName="livekit.ServerInfo";So.fields=x.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:x.getEnumType(nl)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var nl;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud"})(nl||(nl={}));x.util.setEnumType(nl,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class bo extends pe{constructor(e){super(),this.sdk=rl.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",x.util.initPartial(e,this)}static fromBinary(e,n){return new bo().fromBinary(e,n)}static fromJson(e,n){return new bo().fromJson(e,n)}static fromJsonString(e,n){return new bo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(bo,e,n)}}bo.runtime=x;bo.typeName="livekit.ClientInfo";bo.fields=x.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:x.getEnumType(rl)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var rl;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.PYTHON=9]="PYTHON",t[t.CPP=10]="CPP"})(rl||(rl={}));x.util.setEnumType(rl,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class Li extends pe{constructor(e){super(),this.resumeConnection=Ci.UNSET,this.forceRelay=Ci.UNSET,x.util.initPartial(e,this)}static fromBinary(e,n){return new Li().fromBinary(e,n)}static fromJson(e,n){return new Li().fromJson(e,n)}static fromJsonString(e,n){return new Li().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Li,e,n)}}Li.runtime=x;Li.typeName="livekit.ClientConfiguration";Li.fields=x.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:Bi},{no:2,name:"screen",kind:"message",T:Bi},{no:3,name:"resume_connection",kind:"enum",T:x.getEnumType(Ci)},{no:4,name:"disabled_codecs",kind:"message",T:wo},{no:5,name:"force_relay",kind:"enum",T:x.getEnumType(Ci)}]);class Bi extends pe{constructor(e){super(),this.hardwareEncoder=Ci.UNSET,x.util.initPartial(e,this)}static fromBinary(e,n){return new Bi().fromBinary(e,n)}static fromJson(e,n){return new Bi().fromJson(e,n)}static fromJsonString(e,n){return new Bi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Bi,e,n)}}Bi.runtime=x;Bi.typeName="livekit.VideoConfiguration";Bi.fields=x.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:x.getEnumType(Ci)}]);class wo extends pe{constructor(e){super(),this.codecs=[],this.publish=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new wo().fromBinary(e,n)}static fromJson(e,n){return new wo().fromJson(e,n)}static fromJsonString(e,n){return new wo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(wo,e,n)}}wo.runtime=x;wo.typeName="livekit.DisabledCodecs";wo.fields=x.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:ai,repeated:!0},{no:2,name:"publish",kind:"message",T:ai,repeated:!0}]);class Fi extends pe{constructor(e){super(),this.duration=0,this.startTimestamp=Me.zero,this.endTimestamp=Me.zero,this.rtpClockTicks=Me.zero,this.driftSamples=Me.zero,this.driftMs=0,this.clockRate=0,x.util.initPartial(e,this)}static fromBinary(e,n){return new Fi().fromBinary(e,n)}static fromJson(e,n){return new Fi().fromJson(e,n)}static fromJsonString(e,n){return new Fi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Fi,e,n)}}Fi.runtime=x;Fi.typeName="livekit.RTPDrift";Fi.fields=x.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:Yt},{no:2,name:"end_time",kind:"message",T:Yt},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class Ps extends pe{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=Me.zero,this.headerBytes=Me.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=Me.zero,this.headerBytesDuplicate=Me.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=Me.zero,this.headerBytesPadding=Me.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,x.util.initPartial(e,this)}static fromBinary(e,n){return new Ps().fromBinary(e,n)}static fromJson(e,n){return new Ps().fromJson(e,n)}static fromJsonString(e,n){return new Ps().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Ps,e,n)}}Ps.runtime=x;Ps.typeName="livekit.RTPStats";Ps.fields=x.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:Yt},{no:2,name:"end_time",kind:"message",T:Yt},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:Yt},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:Yt},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:Yt},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:Yt},{no:44,name:"packet_drift",kind:"message",T:Fi},{no:45,name:"report_drift",kind:"message",T:Fi}]);class Rs extends pe{constructor(e){super(),this.unixMicro=Me.zero,this.ticks=0,x.util.initPartial(e,this)}static fromBinary(e,n){return new Rs().fromBinary(e,n)}static fromJson(e,n){return new Rs().fromJson(e,n)}static fromJsonString(e,n){return new Rs().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Rs,e,n)}}Rs.runtime=x;Rs.typeName="livekit.TimedVersion";Rs.fields=x.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const Gl=7e3,dG=[0,300,2*2*300,3*3*300,4*4*300,Gl,Gl,Gl,Gl,Gl];class hG{constructor(e){this._retryDelays=e!==void 0?[...e]:dG}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function F(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{l(r.next(u))}catch(d){s(d)}}function c(u){try{l(r.throw(u))}catch(d){s(d)}}function l(u){u.done?o(u.value):i(u.value).then(a,c)}l((r=r.apply(t,[])).next())})}function Ub(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function sc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Ub=="function"?Ub(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,c){s=t[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}}var tC={exports:{}},Dc=typeof Reflect=="object"?Reflect:null,Vb=Dc&&typeof Dc.apply=="function"?Dc.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Mh;Dc&&typeof Dc.ownKeys=="function"?Mh=Dc.ownKeys:Object.getOwnPropertySymbols?Mh=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Mh=function(e){return Object.getOwnPropertyNames(e)};function fG(t){console&&console.warn&&console.warn(t)}var lx=Number.isNaN||function(e){return e!==e};function qe(){qe.init.call(this)}tC.exports=qe;tC.exports.once=vG;qe.EventEmitter=qe;qe.prototype._events=void 0;qe.prototype._eventsCount=0;qe.prototype._maxListeners=void 0;var Gb=10;function kp(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(qe,"defaultMaxListeners",{enumerable:!0,get:function(){return Gb},set:function(t){if(typeof t!="number"||t<0||lx(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Gb=t}});qe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};qe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||lx(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ux(t){return t._maxListeners===void 0?qe.defaultMaxListeners:t._maxListeners}qe.prototype.getMaxListeners=function(){return ux(this)};qe.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(n.length>0&&(s=n[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")Vb(c,this,n);else for(var l=c.length,u=gx(c,l),r=0;r<l;++r)Vb(u[r],this,n);return!0};function dx(t,e,n,r){var i,o,s;if(kp(n),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),s===void 0)s=o[e]=n,++t._eventsCount;else if(typeof s=="function"?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=ux(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,fG(a)}return t}qe.prototype.addListener=function(e,n){return dx(this,e,n,!1)};qe.prototype.on=qe.prototype.addListener;qe.prototype.prependListener=function(e,n){return dx(this,e,n,!0)};function pG(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function hx(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=pG.bind(r);return i.listener=n,r.wrapFn=i,i}qe.prototype.once=function(e,n){return kp(n),this.on(e,hx(this,e,n)),this};qe.prototype.prependOnceListener=function(e,n){return kp(n),this.prependListener(e,hx(this,e,n)),this};qe.prototype.removeListener=function(e,n){var r,i,o,s,a;if(kp(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===n||r[s].listener===n){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():gG(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};qe.prototype.off=qe.prototype.removeListener;qe.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function fx(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?mG(i):gx(i,i.length)}qe.prototype.listeners=function(e){return fx(this,e,!0)};qe.prototype.rawListeners=function(e){return fx(this,e,!1)};qe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):px.call(t,e)};qe.prototype.listenerCount=px;function px(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}qe.prototype.eventNames=function(){return this._eventsCount>0?Mh(this._events):[]};function gx(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function gG(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function mG(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function vG(t,e){return new Promise(function(n,r){function i(s){t.removeListener(e,o),r(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}mx(t,e,o,{once:!0}),e!=="error"&&yG(t,i,{once:!0})})}function yG(t,e,n){typeof t.on=="function"&&mx(t,"error",e,n)}function mx(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){r.once&&t.removeEventListener(e,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var oo=tC.exports;let vx=!0,yx=!0;function Oh(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function $a(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(s,a){if(s!==e)return i.apply(this,arguments);const c=l=>{const u=n(l);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,c),i.apply(this,[s,c])};const o=r.removeEventListener;r.removeEventListener=function(s,a){if(s!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(a))return o.apply(this,arguments);const c=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[s,c])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(s){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),s&&this.addEventListener(e,this["_on"+e]=s)},enumerable:!0,configurable:!0})}function CG(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(vx=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function IG(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(yx=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function Cx(){if(typeof window=="object"){if(vx)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function nC(t,e){yx&&console.warn(t+" is deprecated, please use "+e+" instead.")}function SG(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=Oh(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=Oh(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Oh(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function Wb(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ix(t){return Wb(t)?Object.keys(t).reduce(function(e,n){const r=Wb(t[n]),i=r?Ix(t[n]):t[n],o=r&&!Object.keys(i).length;return i===void 0||o?e:Object.assign(e,{[n]:i})},{}):t}function Vv(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Vv(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{Vv(t,t.get(i),n)})}))}function jb(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const o=[];return t.forEach(s=>{s.type==="track"&&s.trackIdentifier===e.id&&o.push(s)}),o.forEach(s=>{t.forEach(a=>{a.type===r&&a.trackId===s.id&&Vv(t,a,i)})}),i}const Zb=Cx;function Sx(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const c={};return Object.keys(a).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof a[l]=="object"?a[l]:{ideal:a[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(h,f){return h?h+f.charAt(0).toUpperCase()+f.slice(1):f==="deviceId"?"sourceId":f};if(u.ideal!==void 0){c.optional=c.optional||[];let h={};typeof u.ideal=="number"?(h[d("min",l)]=u.ideal,c.optional.push(h),h={},h[d("max",l)]=u.ideal,c.optional.push(h)):(h[d("",l)]=u.ideal,c.optional.push(h))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[d("",l)]=u.exact):["min","max"].forEach(h=>{u[h]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[d(h,l)]=u[h])})}),a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced)),c},i=function(a,c){if(e.version>=61)return c(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const l=function(u,d,h){d in u&&!(h in u)&&(u[h]=u[d],delete u[d])};a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","googAutoGainControl"),l(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let l=a.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let d;if(l.exact==="environment"||l.ideal==="environment"?d=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(h=>{h=h.filter(p=>p.kind==="videoinput");let f=h.find(p=>d.some(m=>p.label.toLowerCase().includes(m)));return!f&&h.length&&d.includes("back")&&(f=h[h.length-1]),f&&(a.video.deviceId=l.exact?{exact:f.deviceId}:{ideal:f.deviceId}),a.video=r(a.video),Zb("chrome: "+JSON.stringify(a)),c(a)})}a.video=r(a.video)}return Zb("chrome: "+JSON.stringify(a)),c(a)},o=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},s=function(a,c,l){i(a,u=>{n.webkitGetUserMedia(u,c,d=>{l&&l(o(d))})})};if(n.getUserMedia=s.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return i(c,l=>a(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(o(u))))}}}function bG(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const o=r.video&&r.video.width,s=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},o&&(r.video.mandatory.maxWidth=o),s&&(r.video.mandatory.maxHeight=s),t.navigator.mediaDevices.getUserMedia(r)})}}}function bx(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function wx(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):o={track:i.track};const s=new Event("track");s.track=i.track,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)}),r.stream.getTracks().forEach(i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.id):o={track:i};const s=new Event("track");s.track=i,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else $a(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Ax(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,c){let l=i.apply(this,arguments);return l||(l=e(this,a),this._senders.push(l)),l};const o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){o.apply(this,arguments);const c=this._senders.indexOf(a);c!==-1&&this._senders.splice(c,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(s=>{this._senders.push(e(this,s))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(s=>{const a=this._senders.find(c=>c.track===s);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function kx(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[r,i,o]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const s=function(c){const l={};return c.result().forEach(d=>{const h={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach(f=>{h[f]=d.stat(f)}),l[h.id]=h}),l},a=function(c){return new Map(Object.keys(c).map(l=>[l,c[l]]))};if(arguments.length>=2){const c=function(l){i(a(s(l)))};return e.apply(this,[c,r])}return new Promise((c,l)=>{e.apply(this,[function(u){c(a(s(u)))},l])}).then(i,o)}}function Ex(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const o=n.apply(this,[]);return o.forEach(s=>s._pc=this),o});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),t.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(s=>jb(s,o.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(o=>o._pc=this),i}),$a(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>jb(o,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,o,s;return this.getSenders().forEach(a=>{a.track===r&&(i?s=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(o?s=!0:o=a),a.track===r)),s||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Tx(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(s=>this._shimmedLocalStreams[s][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(s,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(c)===-1&&this._shimmedLocalStreams[a.id].push(c):this._shimmedLocalStreams[a.id]=[a,c],c};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._shimmedLocalStreams=this._shimmedLocalStreams||{},s.getTracks().forEach(l=>{if(this.getSenders().find(d=>d.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(l=>a.indexOf(l)===-1);this._shimmedLocalStreams[s.id]=[s].concat(c)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[s.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},s&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const c=this._shimmedLocalStreams[a].indexOf(s);c!==-1&&this._shimmedLocalStreams[a].splice(c,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function xx(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Tx(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(d=>this._reverseStreams[d.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(d=>{if(this.getSenders().find(f=>f.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const d=new t.MediaStream(u.getTracks());this._streams[u.id]=d,this._reverseStreams[d.id]=u,u=d}r.apply(this,[u])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const h=[].slice.call(arguments,1);if(h.length!==1||!h[0].getTracks().find(m=>m===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(m=>m.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[d.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const m=new t.MediaStream([u]);this._streams[d.id]=m,this._reverseStreams[m.id]=d,this.addStream(m)}return this.getSenders().find(m=>m.track===u)};function o(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(h=>{const f=l._reverseStreams[h],p=l._streams[f.id];d=d.replace(new RegExp(p.id,"g"),f.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function s(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(h=>{const f=l._reverseStreams[h],p=l._streams[f.id];d=d.replace(new RegExp(f.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],d={[l](){const h=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const m=o(this,p);h[0].apply(null,[m])},p=>{h[1]&&h[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>o(this,p))}};t.RTCPeerConnection.prototype[l]=d[l]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=s(this,arguments[0]),a.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:o(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let h;Object.keys(this._streams).forEach(f=>{this._streams[f].getTracks().find(m=>u.track===m)&&(h=this._streams[f])}),h&&(h.getTracks().length===1?this.removeStream(this._reverseStreams[h.id]):h.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Gv(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function Px(t,e){$a(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var zb=Object.freeze({__proto__:null,fixNegotiationNeeded:Px,shimAddTrackRemoveTrack:xx,shimAddTrackRemoveTrackWithNative:Tx,shimGetDisplayMedia:bG,shimGetSendersWithDtmf:Ax,shimGetStats:kx,shimGetUserMedia:Sx,shimMediaStream:bx,shimOnTrack:wx,shimPeerConnection:Gv,shimSenderReceiverGetStats:Ex});function Rx(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,o,s){nC("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(o,s)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(s,a,c){a in s&&!(c in s)&&(s[c]=s[a],delete s[a])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(s){return typeof s=="object"&&typeof s.audio=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s.audio,"autoGainControl","mozAutoGainControl"),i(s.audio,"noiseSuppression","mozNoiseSuppression")),o(s)},r&&r.prototype.getSettings){const s=r.prototype.getSettings;r.prototype.getSettings=function(){const a=s.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[a])}}}}function wG(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function Nx(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Wv(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=t.RTCPeerConnection.prototype[i],s={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=s[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[o,s,a]=arguments;return r.apply(this,[o||null]).then(c=>{if(e.version<53&&!s)try{c.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((u,d)=>{c.set(d,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(s,a)}}function _x(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Mx(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),$a(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Ox(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){nC("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function Dx(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function Lx(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(s=>{if("rid"in s&&!/^[a-z0-9]{0,16}$/i.test(s.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in s&&!(parseFloat(s.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in s&&!(parseFloat(s.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(i){const{sender:s}=o,a=s.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,s.sendEncodings=r,this.setParametersPromises.push(s.setParameters(a).then(()=>{delete s.sendEncodings}).catch(()=>{delete s.sendEncodings})))}return o})}function Bx(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function Fx(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Ux(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Hb=Object.freeze({__proto__:null,shimAddTransceiver:Lx,shimCreateAnswer:Ux,shimCreateOffer:Fx,shimGetDisplayMedia:wG,shimGetParameters:Bx,shimGetUserMedia:Rx,shimOnTrack:Nx,shimPeerConnection:Wv,shimRTCDataChannel:Dx,shimReceiverGetStats:Mx,shimRemoveStream:Ox,shimSenderGetStats:_x});function Vx(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return o&&o.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function Gx(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const s=new Event("addstream");s.stream=o,r.dispatchEvent(s)})}),e.apply(r,arguments)}}}function Wx(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,o=e.setRemoteDescription,s=e.addIceCandidate;e.createOffer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],h=n.apply(this,[d]);return u?(h.then(l,u),Promise.resolve()):h},e.createAnswer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],h=r.apply(this,[d]);return u?(h.then(l,u),Promise.resolve()):h};let a=function(c,l,u){const d=i.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d};e.setLocalDescription=a,a=function(c,l,u){const d=o.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.setRemoteDescription=a,a=function(c,l,u){const d=s.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.addIceCandidate=a}function jx(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(Zx(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,o){e.mediaDevices.getUserMedia(r).then(i,o)}).bind(e))}function Zx(t){return t&&t.video!==void 0?Object.assign({},t,{video:Ix(t.video)}):t}function zx(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const o=[];for(let s=0;s<r.iceServers.length;s++){let a=r.iceServers[s];a.urls===void 0&&a.url?(nC("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,o.push(a)):o.push(r.iceServers[s])}r.iceServers=o}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function Hx(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Xx(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(s=>s.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(s=>s.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function $x(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var Xb=Object.freeze({__proto__:null,shimAudioContext:$x,shimCallbacksAPI:Wx,shimConstraints:Zx,shimCreateOfferLegacy:Xx,shimGetUserMedia:jx,shimLocalStreamsAPI:Vx,shimRTCIceServerUrls:zx,shimRemoteStreamsAPI:Gx,shimTrackEventTransceiver:Hx}),Kx={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":i.relatedAddress=r[o+1];break;case"rport":i.relatedPort=parseInt(r[o+1],10);break;case"tcptype":i.tcpType=r[o+1];break;case"ufrag":i.ufrag=r[o+1],i.usernameFragment=r[o+1];break;default:i[r[o]]===void 0&&(i[r[o]]=r[o+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const o=n.type;return r.push("typ"),r.push(o),o!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const o=n.substring(n.indexOf(" ")+1).split(";");for(let s=0;s<o.length;s++)i=o[s].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const o=[];Object.keys(n.parameters).forEach(s=>{n.parameters[s]!==void 0?o.push(s+"="+n.parameters[s]):o.push(s)}),r+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},o=n.indexOf(":",r);return o>-1?(i.attribute=n.substring(r+1,o),i.value=n.substring(o+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],o=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(n)[0].split(" ");r.profile=o[2];for(let a=3;a<o.length;a++){const c=o[a],l=e.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(l){const u=e.parseRtpMap(l),d=e.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=d.length?e.parseFmtp(d[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const s=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{s.forEach(c=>{a.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||a.rtcpFeedback.push(c)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(s=>s.preferredPayloadType!==void 0?s.preferredPayloadType:s.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(s=>{i+=e.writeRtpMap(s),i+=e.writeFmtp(s),i+=e.writeRtcpFb(s)});let o=0;return r.codecs.forEach(s=>{s.maxptime>o&&(o=s.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(s=>{i+=e.writeExtmap(s)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),o=i.fecMechanisms.indexOf("RED")!==-1,s=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(n,"a=ssrc:").map(h=>e.parseSsrcMedia(h)).filter(h=>h.attribute==="cname"),c=a.length>0&&a[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(h=>h.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),i.codecs.forEach(h=>{if(h.name.toUpperCase()==="RTX"&&h.parameters.apt){let f={ssrc:c,codecPayloadType:parseInt(h.parameters.apt,10)};c&&l&&(f.rtx={ssrc:l}),r.push(f),o&&(f=JSON.parse(JSON.stringify(f)),f.fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},r.push(f))}}),r.length===0&&c&&r.push({ssrc:c});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(h=>{h.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const o=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const s=e.matchPrefix(n,"a=rtcp-mux");return r.mux=s.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=e.matchPrefix(n,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const s=e.matchPrefix(n,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const a=e.matchPrefix(n,"a=sctpmap:");if(a.length>0){const c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:o}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let o;const s=r!==void 0?r:2;return n?o=n:o=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+s+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const i=e.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(n){const i=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e})(Kx);var Jx=Kx.exports,Lc=kV(Jx),AG=wV({__proto__:null,default:Lc},[Jx]);function Dh(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),o=Lc.parseCandidate(r.candidate);for(const s in o)s in i||Object.defineProperty(i,s,{value:o[s]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,$a(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function jv(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||$a(t,"icecandidate",e=>{if(e.candidate){const n=Lc.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Lh(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const c=Lc.splitSections(a.sdp);return c.shift(),c.some(l=>{const u=Lc.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(a){const c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},i=function(a){let c=65536;return e.browser==="firefox"&&(e.version<57?a===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},o=function(a,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=Lc.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},s=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=r(arguments[0]),l=i(c),u=o(arguments[0],c);let d;l===0&&u===0?d=Number.POSITIVE_INFINITY:l===0||u===0?d=Math.max(l,u):d=Math.min(l,u);const h={};Object.defineProperty(h,"maxMessageSize",{get(){return d}}),this._sctp=h}return s.apply(this,arguments)}}function Bh(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const o=r.send;r.send=function(){const a=arguments[0],c=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&c>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},$a(t,"datachannel",r=>(e(r.channel,r.target),r))}function Zv(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const s=new Event("connectionstatechange",i);o.dispatchEvent(s)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function zv(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(s=>s.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return n.apply(this,arguments)}}function Fh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Uh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(s=>n.apply(this,[s]))})}var kG=Object.freeze({__proto__:null,removeExtmapAllowMixed:zv,shimAddIceCandidateNullOrEmpty:Fh,shimConnectionState:Zv,shimMaxMessageSize:Lh,shimParameterlessSetLocalDescription:Uh,shimRTCIceCandidate:Dh,shimRTCIceCandidateRelayProtocol:jv,shimSendThrowTypeError:Bh});function EG(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Cx,r=SG(t),i={browserDetails:r,commonShim:kG,extractVersion:Oh,disableLog:CG,disableWarnings:IG,sdp:AG};switch(r.browser){case"chrome":if(!zb||!Gv||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=zb,Fh(t,r),Uh(t),Sx(t,r),bx(t),Gv(t,r),wx(t),xx(t,r),Ax(t),kx(t),Ex(t),Px(t,r),Dh(t),jv(t),Zv(t),Lh(t,r),Bh(t),zv(t,r);break;case"firefox":if(!Hb||!Wv||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=Hb,Fh(t,r),Uh(t),Rx(t,r),Wv(t,r),Nx(t),Ox(t),_x(t),Mx(t),Dx(t),Lx(t),Bx(t),Fx(t),Ux(t),Dh(t),Zv(t),Lh(t,r),Bh(t);break;case"safari":if(!Xb||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=Xb,Fh(t,r),Uh(t),zx(t),Xx(t),Wx(t),Vx(t),Gx(t),Hx(t),jx(t),$x(t),Dh(t),jv(t),Lh(t,r),Bh(t),zv(t,r);break;default:n("Unsupported browser!");break}return i}EG({window:typeof window>"u"?void 0:window});const TG=10,qd="lk_e2ee",xG="LKFrameEncryptionKey",PG={sharedKey:!1,ratchetSalt:xG,ratchetWindowSize:8,failureTolerance:TG};var Gs;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(Gs||(Gs={}));var $b;(function(t){t.KeyRatcheted="keyRatcheted"})($b||($b={}));var Ns;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Ns||(Ns={}));var Kb;(function(t){t.Error="cryptorError"})(Kb||(Kb={}));function RG(){return NG()||Hv()}function Hv(){return typeof window.RTCRtpScriptTransform<"u"}function NG(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class W7 extends oo.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{Ue.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},PG),e),this.on(Gs.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(Gs.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(Gs.RatchetRequest,e,n)}}class Il extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}class at extends Il{constructor(e,n,r){super(1,e),this.status=r,this.reason=n}}class rC extends Il{constructor(e){super(21,e??"device is unsupported")}}class Pi extends Il{constructor(e){super(20,e??"track is invalid")}}class _G extends Il{constructor(e){super(10,e??"unsupported server")}}class Ut extends Il{constructor(e){super(12,e??"unexpected connection state")}}class Xv extends Il{constructor(e){super(13,e??"unable to negotiate")}}var Yu;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(Yu||(Yu={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(Yu||(Yu={}));var ee;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.StateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged"})(ee||(ee={}));var ne;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded"})(ne||(ne={}));var ye;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished"})(ye||(ye={}));var le;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed"})(le||(le={}));function iC(t,e,n){var r,i,o;e===void 0&&(e=50),n===void 0&&(n={});var s=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,c=n.maxWait,l=Date.now(),u=[];function d(){if(c!==void 0){var f=Date.now()-l;if(f+e>=c)return c-f}return e}var h=function(){var f=[].slice.call(arguments),p=this;return new Promise(function(m,C){var g=s&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,l=Date.now(),!s){var S=t.apply(p,f);a&&a(S),u.forEach(function(E){return(0,E.resolve)(S)}),u=[]}},d()),g){var y=t.apply(p,f);return a&&a(y),m(y)}u.push({resolve:m,reject:C})})};return h.cancel=function(f){o!==void 0&&clearTimeout(o),u.forEach(function(p){return(0,p.reject)(f)}),u=[]},h}const MG=/version\/(\d+(\.?_?\d+)+)/i;let _g;function qo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(_g===void 0||e){const r=OG.find(i=>{let{test:o}=i;return o.test(n)});_g=r==null?void 0:r.describe(n)}return _g}const OG=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Mg(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Mg(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Mg(MG,t),os:t.includes("mobile/")?"iOS":"macOS"}}}];function Mg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}var DG="1.15.13";const LG=DG,BG=11;class cn{}cn.setTimeout=function(){return setTimeout(...arguments)};cn.setInterval=function(){return setInterval(...arguments)};cn.clearTimeout=function(){return clearTimeout(...arguments)};cn.clearInterval=function(){return clearInterval(...arguments)};class Qe{constructor(e,n,r,i,o){this.width=e,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i,priority:o}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const FG=["vp8","h264"],Yx=["vp8","h264","vp9","av1"];function UG(t){return!!FG.find(e=>e===t)}var Uf;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:2e4},t.music={maxBitrate:32e3},t.musicStereo={maxBitrate:48e3},t.musicHighQuality={maxBitrate:64e3},t.musicHighQualityStereo={maxBitrate:96e3}})(Uf||(Uf={}));const Qu={h90:new Qe(160,90,9e4,20),h180:new Qe(320,180,16e4,20),h216:new Qe(384,216,18e4,20),h360:new Qe(640,360,45e4,20),h540:new Qe(960,540,8e5,25),h720:new Qe(1280,720,17e5,30),h1080:new Qe(1920,1080,3e6,30),h1440:new Qe(2560,1440,5e6,30),h2160:new Qe(3840,2160,8e6,30)},$v={h120:new Qe(160,120,7e4,20),h180:new Qe(240,180,125e3,20),h240:new Qe(320,240,14e4,20),h360:new Qe(480,360,33e4,20),h480:new Qe(640,480,5e5,20),h540:new Qe(720,540,6e5,25),h720:new Qe(960,720,13e5,30),h1080:new Qe(1440,1080,23e5,30),h1440:new Qe(1920,1440,38e5,30)},oC={h360fps3:new Qe(640,360,2e5,3,"medium"),h360fps15:new Qe(640,360,4e5,15,"medium"),h720fps5:new Qe(1280,720,8e5,5,"medium"),h720fps15:new Qe(1280,720,15e5,15,"medium"),h720fps30:new Qe(1280,720,2e6,30,"medium"),h1080fps15:new Qe(1920,1080,25e5,15,"medium"),h1080fps30:new Qe(1920,1080,5e6,30,"medium"),original:new Qe(0,0,7e6,30,"medium")};var wn;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER"})(wn||(wn={}));x.util.setEnumType(wn,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var Ba;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.PAUSED=1]="PAUSED"})(Ba||(Ba={}));x.util.setEnumType(Ba,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var Vf;(function(t){t[t.UDP=0]="UDP",t[t.TCP=1]="TCP",t[t.TLS=2]="TLS"})(Vf||(Vf={}));x.util.setEnumType(Vf,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class Ao extends pe{constructor(e){super(),this.message={case:void 0},x.util.initPartial(e,this)}static fromBinary(e,n){return new Ao().fromBinary(e,n)}static fromJson(e,n){return new Ao().fromJson(e,n)}static fromJsonString(e,n){return new Ao().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Ao,e,n)}}Ao.runtime=x;Ao.typeName="livekit.SignalRequest";Ao.fields=x.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:Fn,oneof:"message"},{no:2,name:"answer",kind:"message",T:Fn,oneof:"message"},{no:3,name:"trickle",kind:"message",T:ui,oneof:"message"},{no:4,name:"add_track",kind:"message",T:li,oneof:"message"},{no:5,name:"mute",kind:"message",T:di,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Ur,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:Vi,oneof:"message"},{no:8,name:"leave",kind:"message",T:Vr,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Gi,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:zi,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:Hi,oneof:"message"},{no:13,name:"simulate",kind:"message",T:on,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Wi,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:$i,oneof:"message"}]);class Ui extends pe{constructor(e){super(),this.message={case:void 0},x.util.initPartial(e,this)}static fromBinary(e,n){return new Ui().fromBinary(e,n)}static fromJson(e,n){return new Ui().fromJson(e,n)}static fromJsonString(e,n){return new Ui().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Ui,e,n)}}Ui.runtime=x;Ui.typeName="livekit.SignalResponse";Ui.fields=x.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:ko,oneof:"message"},{no:2,name:"answer",kind:"message",T:Fn,oneof:"message"},{no:3,name:"offer",kind:"message",T:Fn,oneof:"message"},{no:4,name:"trickle",kind:"message",T:ui,oneof:"message"},{no:5,name:"update",kind:"message",T:xo,oneof:"message"},{no:6,name:"track_published",kind:"message",T:hi,oneof:"message"},{no:8,name:"leave",kind:"message",T:Vr,oneof:"message"},{no:9,name:"mute",kind:"message",T:di,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Po,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Ro,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:_o,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:Oo,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Lo,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Bo,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:To,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:Eo,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Fo,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Vo,oneof:"message"}]);class ci extends pe{constructor(e){super(),this.codec="",this.cid="",x.util.initPartial(e,this)}static fromBinary(e,n){return new ci().fromBinary(e,n)}static fromJson(e,n){return new ci().fromJson(e,n)}static fromJsonString(e,n){return new ci().fromJsonString(e,n)}static equals(e,n){return x.util.equals(ci,e,n)}}ci.runtime=x;ci.typeName="livekit.SimulcastCodec";ci.fields=x.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class li extends pe{constructor(e){super(),this.cid="",this.name="",this.type=bn.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=Nt.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=sn.NONE,this.stream="",x.util.initPartial(e,this)}static fromBinary(e,n){return new li().fromBinary(e,n)}static fromJson(e,n){return new li().fromJson(e,n)}static fromJsonString(e,n){return new li().fromJsonString(e,n)}static equals(e,n){return x.util.equals(li,e,n)}}li.runtime=x;li.typeName="livekit.AddTrackRequest";li.fields=x.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:x.getEnumType(bn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:x.getEnumType(Nt)},{no:9,name:"layers",kind:"message",T:Bn,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:ci,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:x.getEnumType(sn)},{no:15,name:"stream",kind:"scalar",T:9}]);class ui extends pe{constructor(e){super(),this.candidateInit="",this.target=wn.PUBLISHER,x.util.initPartial(e,this)}static fromBinary(e,n){return new ui().fromBinary(e,n)}static fromJson(e,n){return new ui().fromJson(e,n)}static fromJsonString(e,n){return new ui().fromJsonString(e,n)}static equals(e,n){return x.util.equals(ui,e,n)}}ui.runtime=x;ui.typeName="livekit.TrickleRequest";ui.fields=x.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:x.getEnumType(wn)}]);class di extends pe{constructor(e){super(),this.sid="",this.muted=!1,x.util.initPartial(e,this)}static fromBinary(e,n){return new di().fromBinary(e,n)}static fromJson(e,n){return new di().fromJson(e,n)}static fromJsonString(e,n){return new di().fromJsonString(e,n)}static equals(e,n){return x.util.equals(di,e,n)}}di.runtime=x;di.typeName="livekit.MuteTrackRequest";di.fields=x.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class ko extends pe{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),x.util.initPartial(e,this)}static fromBinary(e,n){return new ko().fromBinary(e,n)}static fromJson(e,n){return new ko().fromJson(e,n)}static fromJsonString(e,n){return new ko().fromJsonString(e,n)}static equals(e,n){return x.util.equals(ko,e,n)}}ko.runtime=x;ko.typeName="livekit.JoinResponse";ko.fields=x.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Cl},{no:2,name:"participant",kind:"message",T:Ir},{no:3,name:"other_participants",kind:"message",T:Ir,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:ji,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Li},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:So},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class Eo extends pe{constructor(e){super(),this.iceServers=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Eo().fromBinary(e,n)}static fromJson(e,n){return new Eo().fromJson(e,n)}static fromJsonString(e,n){return new Eo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Eo,e,n)}}Eo.runtime=x;Eo.typeName="livekit.ReconnectResponse";Eo.fields=x.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:ji,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Li}]);class hi extends pe{constructor(e){super(),this.cid="",x.util.initPartial(e,this)}static fromBinary(e,n){return new hi().fromBinary(e,n)}static fromJson(e,n){return new hi().fromJson(e,n)}static fromJsonString(e,n){return new hi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(hi,e,n)}}hi.runtime=x;hi.typeName="livekit.TrackPublishedResponse";hi.fields=x.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:er}]);class To extends pe{constructor(e){super(),this.trackSid="",x.util.initPartial(e,this)}static fromBinary(e,n){return new To().fromBinary(e,n)}static fromJson(e,n){return new To().fromJson(e,n)}static fromJsonString(e,n){return new To().fromJsonString(e,n)}static equals(e,n){return x.util.equals(To,e,n)}}To.runtime=x;To.typeName="livekit.TrackUnpublishedResponse";To.fields=x.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class Fn extends pe{constructor(e){super(),this.type="",this.sdp="",x.util.initPartial(e,this)}static fromBinary(e,n){return new Fn().fromBinary(e,n)}static fromJson(e,n){return new Fn().fromJson(e,n)}static fromJsonString(e,n){return new Fn().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Fn,e,n)}}Fn.runtime=x;Fn.typeName="livekit.SessionDescription";Fn.fields=x.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class xo extends pe{constructor(e){super(),this.participants=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new xo().fromBinary(e,n)}static fromJson(e,n){return new xo().fromJson(e,n)}static fromJsonString(e,n){return new xo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(xo,e,n)}}xo.runtime=x;xo.typeName="livekit.ParticipantUpdate";xo.fields=x.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:Ir,repeated:!0}]);class Ur extends pe{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Ur().fromBinary(e,n)}static fromJson(e,n){return new Ur().fromJson(e,n)}static fromJsonString(e,n){return new Ur().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Ur,e,n)}}Ur.runtime=x;Ur.typeName="livekit.UpdateSubscription";Ur.fields=x.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Di,repeated:!0}]);class Vi extends pe{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=Zt.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,x.util.initPartial(e,this)}static fromBinary(e,n){return new Vi().fromBinary(e,n)}static fromJson(e,n){return new Vi().fromJson(e,n)}static fromJsonString(e,n){return new Vi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Vi,e,n)}}Vi.runtime=x;Vi.typeName="livekit.UpdateTrackSettings";Vi.fields=x.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:x.getEnumType(Zt)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class Vr extends pe{constructor(e){super(),this.canReconnect=!1,this.reason=jo.UNKNOWN_REASON,x.util.initPartial(e,this)}static fromBinary(e,n){return new Vr().fromBinary(e,n)}static fromJson(e,n){return new Vr().fromJson(e,n)}static fromJsonString(e,n){return new Vr().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Vr,e,n)}}Vr.runtime=x;Vr.typeName="livekit.LeaveRequest";Vr.fields=x.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:x.getEnumType(jo)}]);class Gi extends pe{constructor(e){super(),this.trackSid="",this.layers=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Gi().fromBinary(e,n)}static fromJson(e,n){return new Gi().fromJson(e,n)}static fromJsonString(e,n){return new Gi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Gi,e,n)}}Gi.runtime=x;Gi.typeName="livekit.UpdateVideoLayers";Gi.fields=x.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Bn,repeated:!0}]);class Wi extends pe{constructor(e){super(),this.metadata="",this.name="",x.util.initPartial(e,this)}static fromBinary(e,n){return new Wi().fromBinary(e,n)}static fromJson(e,n){return new Wi().fromJson(e,n)}static fromJsonString(e,n){return new Wi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Wi,e,n)}}Wi.runtime=x;Wi.typeName="livekit.UpdateParticipantMetadata";Wi.fields=x.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class ji extends pe{constructor(e){super(),this.urls=[],this.username="",this.credential="",x.util.initPartial(e,this)}static fromBinary(e,n){return new ji().fromBinary(e,n)}static fromJson(e,n){return new ji().fromJson(e,n)}static fromJsonString(e,n){return new ji().fromJsonString(e,n)}static equals(e,n){return x.util.equals(ji,e,n)}}ji.runtime=x;ji.typeName="livekit.ICEServer";ji.fields=x.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class Po extends pe{constructor(e){super(),this.speakers=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Po().fromBinary(e,n)}static fromJson(e,n){return new Po().fromJson(e,n)}static fromJsonString(e,n){return new Po().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Po,e,n)}}Po.runtime=x;Po.typeName="livekit.SpeakersChanged";Po.fields=x.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Mi,repeated:!0}]);class Ro extends pe{constructor(e){super(),x.util.initPartial(e,this)}static fromBinary(e,n){return new Ro().fromBinary(e,n)}static fromJson(e,n){return new Ro().fromJson(e,n)}static fromJsonString(e,n){return new Ro().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Ro,e,n)}}Ro.runtime=x;Ro.typeName="livekit.RoomUpdate";Ro.fields=x.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:Cl}]);class No extends pe{constructor(e){super(),this.participantSid="",this.quality=vo.POOR,this.score=0,x.util.initPartial(e,this)}static fromBinary(e,n){return new No().fromBinary(e,n)}static fromJson(e,n){return new No().fromJson(e,n)}static fromJsonString(e,n){return new No().fromJsonString(e,n)}static equals(e,n){return x.util.equals(No,e,n)}}No.runtime=x;No.typeName="livekit.ConnectionQualityInfo";No.fields=x.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:x.getEnumType(vo)},{no:3,name:"score",kind:"scalar",T:2}]);class _o extends pe{constructor(e){super(),this.updates=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new _o().fromBinary(e,n)}static fromJson(e,n){return new _o().fromJson(e,n)}static fromJsonString(e,n){return new _o().fromJsonString(e,n)}static equals(e,n){return x.util.equals(_o,e,n)}}_o.runtime=x;_o.typeName="livekit.ConnectionQualityUpdate";_o.fields=x.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:No,repeated:!0}]);class Mo extends pe{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=Ba.ACTIVE,x.util.initPartial(e,this)}static fromBinary(e,n){return new Mo().fromBinary(e,n)}static fromJson(e,n){return new Mo().fromJson(e,n)}static fromJsonString(e,n){return new Mo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Mo,e,n)}}Mo.runtime=x;Mo.typeName="livekit.StreamStateInfo";Mo.fields=x.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:x.getEnumType(Ba)}]);class Oo extends pe{constructor(e){super(),this.streamStates=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Oo().fromBinary(e,n)}static fromJson(e,n){return new Oo().fromJson(e,n)}static fromJsonString(e,n){return new Oo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Oo,e,n)}}Oo.runtime=x;Oo.typeName="livekit.StreamStateUpdate";Oo.fields=x.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:Mo,repeated:!0}]);class fi extends pe{constructor(e){super(),this.quality=Zt.LOW,this.enabled=!1,x.util.initPartial(e,this)}static fromBinary(e,n){return new fi().fromBinary(e,n)}static fromJson(e,n){return new fi().fromJson(e,n)}static fromJsonString(e,n){return new fi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(fi,e,n)}}fi.runtime=x;fi.typeName="livekit.SubscribedQuality";fi.fields=x.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:x.getEnumType(Zt)},{no:2,name:"enabled",kind:"scalar",T:8}]);class Do extends pe{constructor(e){super(),this.codec="",this.qualities=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Do().fromBinary(e,n)}static fromJson(e,n){return new Do().fromJson(e,n)}static fromJsonString(e,n){return new Do().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Do,e,n)}}Do.runtime=x;Do.typeName="livekit.SubscribedCodec";Do.fields=x.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:fi,repeated:!0}]);class Lo extends pe{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Lo().fromBinary(e,n)}static fromJson(e,n){return new Lo().fromJson(e,n)}static fromJsonString(e,n){return new Lo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Lo,e,n)}}Lo.runtime=x;Lo.typeName="livekit.SubscribedQualityUpdate";Lo.fields=x.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:fi,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:Do,repeated:!0}]);class Zi extends pe{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",x.util.initPartial(e,this)}static fromBinary(e,n){return new Zi().fromBinary(e,n)}static fromJson(e,n){return new Zi().fromJson(e,n)}static fromJsonString(e,n){return new Zi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Zi,e,n)}}Zi.runtime=x;Zi.typeName="livekit.TrackPermission";Zi.fields=x.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class zi extends pe{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new zi().fromBinary(e,n)}static fromJson(e,n){return new zi().fromJson(e,n)}static fromJsonString(e,n){return new zi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(zi,e,n)}}zi.runtime=x;zi.typeName="livekit.SubscriptionPermission";zi.fields=x.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:Zi,repeated:!0}]);class Bo extends pe{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,x.util.initPartial(e,this)}static fromBinary(e,n){return new Bo().fromBinary(e,n)}static fromJson(e,n){return new Bo().fromJson(e,n)}static fromJsonString(e,n){return new Bo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Bo,e,n)}}Bo.runtime=x;Bo.typeName="livekit.SubscriptionPermissionUpdate";Bo.fields=x.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class Hi extends pe{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new Hi().fromBinary(e,n)}static fromJson(e,n){return new Hi().fromJson(e,n)}static fromJsonString(e,n){return new Hi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Hi,e,n)}}Hi.runtime=x;Hi.typeName="livekit.SyncState";Hi.fields=x.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:Fn},{no:2,name:"subscription",kind:"message",T:Ur},{no:3,name:"publish_tracks",kind:"message",T:hi,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Xi,repeated:!0},{no:5,name:"offer",kind:"message",T:Fn}]);class Xi extends pe{constructor(e){super(),this.label="",this.id=0,this.target=wn.PUBLISHER,x.util.initPartial(e,this)}static fromBinary(e,n){return new Xi().fromBinary(e,n)}static fromJson(e,n){return new Xi().fromJson(e,n)}static fromJsonString(e,n){return new Xi().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Xi,e,n)}}Xi.runtime=x;Xi.typeName="livekit.DataChannelInfo";Xi.fields=x.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:x.getEnumType(wn)}]);class on extends pe{constructor(e){super(),this.scenario={case:void 0},x.util.initPartial(e,this)}static fromBinary(e,n){return new on().fromBinary(e,n)}static fromJson(e,n){return new on().fromJson(e,n)}static fromJsonString(e,n){return new on().fromJsonString(e,n)}static equals(e,n){return x.util.equals(on,e,n)}}on.runtime=x;on.typeName="livekit.SimulateScenario";on.fields=x.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:x.getEnumType(Vf),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]);class $i extends pe{constructor(e){super(),this.timestamp=Me.zero,this.rtt=Me.zero,x.util.initPartial(e,this)}static fromBinary(e,n){return new $i().fromBinary(e,n)}static fromJson(e,n){return new $i().fromJson(e,n)}static fromJsonString(e,n){return new $i().fromJsonString(e,n)}static equals(e,n){return x.util.equals($i,e,n)}}$i.runtime=x;$i.typeName="livekit.Ping";$i.fields=x.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class Fo extends pe{constructor(e){super(),this.lastPingTimestamp=Me.zero,this.timestamp=Me.zero,x.util.initPartial(e,this)}static fromBinary(e,n){return new Fo().fromBinary(e,n)}static fromJson(e,n){return new Fo().fromJson(e,n)}static fromJsonString(e,n){return new Fo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Fo,e,n)}}Fo.runtime=x;Fo.typeName="livekit.Pong";Fo.fields=x.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class _s extends pe{constructor(e){super(),this.regions=[],x.util.initPartial(e,this)}static fromBinary(e,n){return new _s().fromBinary(e,n)}static fromJson(e,n){return new _s().fromJson(e,n)}static fromJsonString(e,n){return new _s().fromJsonString(e,n)}static equals(e,n){return x.util.equals(_s,e,n)}}_s.runtime=x;_s.typeName="livekit.RegionSettings";_s.fields=x.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:Uo,repeated:!0}]);class Uo extends pe{constructor(e){super(),this.region="",this.url="",this.distance=Me.zero,x.util.initPartial(e,this)}static fromBinary(e,n){return new Uo().fromBinary(e,n)}static fromJson(e,n){return new Uo().fromJson(e,n)}static fromJsonString(e,n){return new Uo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Uo,e,n)}}Uo.runtime=x;Uo.typeName="livekit.RegionInfo";Uo.fields=x.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class Vo extends pe{constructor(e){super(),this.trackSid="",this.err=Ju.SE_UNKNOWN,x.util.initPartial(e,this)}static fromBinary(e,n){return new Vo().fromBinary(e,n)}static fromJson(e,n){return new Vo().fromJson(e,n)}static fromJsonString(e,n){return new Vo().fromJsonString(e,n)}static equals(e,n){return x.util.equals(Vo,e,n)}}Vo.runtime=x;Vo.typeName="livekit.SubscriptionResponse";Vo.fields=x.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:x.getEnumType(Ju)}]);function VG(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const GG=5e3,Wl=[];class $ extends oo.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=$.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Ue,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),GG):this.handleAppVisibilityChanged()},this.log=Qo((i=r.loggerName)!==null&&i!==void 0?i:Qi.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=$.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),pt(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===$.Kind.Video&&(n="video"),this.attachedElements.length===0&&$.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(Wl.forEach(o=>{o.parentElement===null&&!e&&(e=o)}),e&&Wl.splice(Wl.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),wc(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(o=>o.kind==="audio");return e.play().then(()=>{this.emit(i?le.AudioPlaybackStarted:le.VideoPlaybackStarted)}).catch(o=>{o.name==="NotAllowedError"?this.emit(i?le.AudioPlaybackFailed:le.VideoPlaybackFailed,o):o.name==="AbortError"?Ue.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):Ue.warn("could not playback ".concat(i?"audio":"video"),o),i&&e&&r.some(s=>s.kind==="video")&&o.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(le.ElementAttached,e),e}detach(e){try{if(e){Bc(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(le.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{Bc(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(le.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(e){e.loggerName&&(this.log=Qo(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),Wl.forEach(r=>{r.parentElement||(n=!1)}),n&&Wl.push(e)}}handleAppVisibilityChanged(){return F(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){ir()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){ir()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function wc(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!Fa()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(Fa()||il())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function Bc(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(l){l.Audio="audio",l.Video="video",l.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(l){l.Camera="camera",l.Microphone="microphone",l.ScreenShare="screen_share",l.ScreenShareAudio="screen_share_audio",l.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(l){l.Active="active",l.Paused="paused",l.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(l){switch(l){case e.Audio:return bn.AUDIO;case e.Video:return bn.VIDEO;default:return bn.DATA}}t.kindToProto=i;function o(l){switch(l){case bn.AUDIO:return e.Audio;case bn.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=o;function s(l){switch(l){case n.Camera:return Nt.CAMERA;case n.Microphone:return Nt.MICROPHONE;case n.ScreenShare:return Nt.SCREEN_SHARE;case n.ScreenShareAudio:return Nt.SCREEN_SHARE_AUDIO;default:return Nt.UNKNOWN}}t.sourceToProto=s;function a(l){switch(l){case Nt.CAMERA:return n.Camera;case Nt.MICROPHONE:return n.Microphone;case Nt.SCREEN_SHARE:return n.ScreenShare;case Nt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=a;function c(l){switch(l){case Ba.ACTIVE:return r.Active;case Ba.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=c})($||($={}));function Qx(t,e,n){var r;const i=(r=VG(t))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&Kv(i.audio,e),i.video&&Kv(i.video,n),i}function Kv(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function Ep(t){const e={};if(t.video)if(typeof t.video=="object"){const n={},r=n,i=t.video;Object.keys(i).forEach(o=>{switch(o){case"resolution":Kv(r,i.resolution);break;default:r[o]=i[o]}}),e.video=n}else e.video=t.video;else e.video=!1;return t.audio?typeof t.audio=="object"?e.audio=t.audio:e.audio=!0:e.audio=!1,e}function WG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return F(this,void 0,void 0,function*(){const n=sC();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,o=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(r),yield Zo(e),r.getByteTimeDomainData(o);const a=o.some(c=>c!==128&&c!==0);return n.close(),!a}return!1})}function sC(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function jG(t){return t===$.Source.Microphone?"audioinput":t===$.Source.Camera?"videoinput":void 0}function ZG(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(r=typeof r=="boolean"?{}:r,Fa()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio}}function qx(t){const e=t.split("/")[1].toLowerCase();if(!Yx.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function zG(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new hi({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function pt(t){return t instanceof $?{trackSid:t.sid,trackSource:t.source,trackMuted:t.isMuted,trackEnabled:t.mediaStreamTrack.enabled,trackKind:t.kind}:{trackSid:t.trackSid,trackName:t.trackName,track:t.track?pt(t.track):void 0,trackEnabled:t.isEnabled,trackEncrypted:t.isEncrypted,trackMimeType:t.mimeType}}const HG="|",Jb="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function XG(t){const e=t.split(HG);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function Zo(t){return F(this,void 0,void 0,function*(){return new Promise(e=>cn.setTimeout(e,t))})}function Yb(){return"addTransceiver"in RTCPeerConnection.prototype}function Qb(){return"addTrack"in RTCPeerConnection.prototype}function $G(){if(!("getCapabilities"in RTCRtpSender)||Fa())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function KG(){if(!("getCapabilities"in RTCRtpSender)||il())return!1;if(Fa()){const n=qo();if(n!=null&&n.version&&aC(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function yu(t){return t==="av1"||t==="vp9"}function Jv(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}const JG={Chrome:"100",Safari:"15",Firefox:"100"};function YG(t){if(!ir()||!("setCodecPreferences"in t))return!1;const e=qo();if(!(e!=null&&e.name)||!e.version)return!1;const n=JG[e.name];return n?aC(e.version,n)>=0:!1}function il(){var t;return((t=qo())===null||t===void 0?void 0:t.name)==="Firefox"}function QG(){var t;return((t=qo())===null||t===void 0?void 0:t.name)==="Chrome"}function Fa(){var t;return((t=qo())===null||t===void 0?void 0:t.name)==="Safari"}function qG(){const t=qo();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")}function eP(){return ir()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function ir(){return typeof document<"u"}function Ua(){return navigator.product=="ReactNative"}function Yv(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function tP(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function nP(){if(!Ua())return;let t=tP();if(t)return t.platform}function qb(){if(ir())return window.devicePixelRatio;if(Ua()){let t=tP();if(t)return t.devicePixelRatio}return 1}function aC(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let o=0;o<i;++o){const s=parseInt(n[o],10),a=parseInt(r[o],10);if(s>a)return 1;if(s<a)return-1;if(o===i-1&&s===a)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function eW(t){for(const e of t)e.target.handleResize(e)}function tW(t){for(const e of t)e.target.handleVisibilityChanged(e)}let Og=null;const ew=()=>(Og||(Og=new ResizeObserver(eW)),Og);let Dg=null;const tw=()=>(Dg||(Dg=new IntersectionObserver(tW,{root:null,rootMargin:"0px"})),Dg);function nW(){var t;const e=new bo({sdk:rl.JS,protocol:BG,version:LG});return Ua()&&(e.os=(t=nP())!==null&&t!==void 0?t:""),e}function nw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const o=i.getContext("2d");o==null||o.fillRect(0,0,i.width,i.height),r&&o&&(o.beginPath(),o.arc(t/2,e/2,50,0,Math.PI*2,!0),o.closePath(),o.fillStyle="grey",o.fill());const s=i.captureStream(),[a]=s.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let jl;function Lg(){if(!jl){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[jl]=r.stream.getAudioTracks(),!jl)throw Error("Could not get empty media stream audio track");jl.enabled=!1}return jl.clone()}class rP{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>F(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function rW(t,e){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=sC();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?t.mediaStreamTrack.clone():t.mediaStreamTrack,o=r.createMediaStreamSource(new MediaStream([i])),s=r.createAnalyser();s.minDecibels=n.minDecibels,s.maxDecibels=n.maxDecibels,s.fftSize=n.fftSize,s.smoothingTimeConstant=n.smoothingTimeConstant,o.connect(s);const a=new Uint8Array(s.frequencyBinCount);return{calculateVolume:()=>{s.getByteFrequencyData(a);let u=0;for(const h of a)u+=Math.pow(h/255,2);return Math.sqrt(u/a.length)},analyser:s,cleanup:()=>F(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&i.stop()})}}class mi{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function iW(t){return Yx.includes(t)}function ka(t){if(typeof t=="string")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function oW(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function rw(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}const iw="default";class On{static getInstance(){return this.instance===void 0&&(this.instance=new On),this.instance}getDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return F(this,void 0,void 0,function*(){if(((r=On.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){Ue.debug("awaiting getUserMedia promise");try{e?yield On.userMediaPromiseMap.get(e):yield Promise.all(On.userMediaPromiseMap.values())}catch{Ue.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(n&&!(Fa()&&this.hasDeviceInUse(e))&&(i.length===0||i.some(s=>{const a=s.label==="",c=e?s.kind===e:!0;return a&&c}))){const s={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(s);i=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(c=>{c.stop()})}return e&&(i=i.filter(o=>o.kind===e)),i})}normalizeDeviceId(e,n,r){return F(this,void 0,void 0,function*(){if(n!==iw)return n;const o=(yield this.getDevices(e)).find(s=>s.groupId===r&&s.deviceId!==iw);return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?On.userMediaPromiseMap.has(e):On.userMediaPromiseMap.size>0}}On.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];On.userMediaPromiseMap=new Map;const sW=1e3;class ol extends ${get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;super(e,n,o),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=iC(()=>F(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>F(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(le.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new mi,this.pauseUpstreamLock=new mi,this.processorLock=new mi,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==$.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(e,n){return F(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{Bc(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");wc(e,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{wc(r??e,i)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sW;var n;return F(this,void 0,void 0,function*(){if(this.kind===$.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=qo())===null||n===void 0?void 0:n.os)==="iOS"&&(yield Zo(10));const r=Date.now();for(;Date.now()-r<e;){const i=this.dimensions;if(i)return i;yield Zo(50)}throw new Pi("unable to get track dimensions after timeout")})}getDeviceId(){return F(this,void 0,void 0,function*(){if(this.source===$.Source.ScreenShare)return;const{deviceId:e,groupId:n}=this._mediaStreamTrack.getSettings(),r=this.kind===$.Kind.Audio?"audioinput":"videoinput";return On.getInstance().normalizeDeviceId(r,e,n)})}mute(){return F(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return F(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return F(this,void 0,void 0,function*(){if(!this.sender)throw new Pi("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(e){return F(this,void 0,void 0,function*(){e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const n={audio:!1,video:!1};this.kind===$.Kind.Video?n.video=e:n.audio=e,this.attachedElements.forEach(o=>{Bc(this.mediaStreamTrack,o)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(i),this._constraints=e,this.emit(le.Restarted,this),this})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?le.Muted:le.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return F(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),eP()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return F(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(le.UpstreamPaused,this);const n=qo();if((n==null?void 0:n.name)==="Safari"&&aC(n.version,"12.0")<0)throw new rC("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return F(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(le.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return F(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return F(this,void 0,void 0,function*(){const o=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),wc(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch(a=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:a})));const s={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(s),this.processor=e,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&n&&(Bc(this._mediaStreamTrack,a),wc(this.processor.processedTrack,a));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{o()}})}getProcessor(){return this.processor}stopProcessor(){var e,n;return F(this,void 0,void 0,function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class aW extends oo.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:o,data:s}=n.data;switch(o){case"error":Ue.error(s.error.message),this.emit(Ns.EncryptionError,s.error);break;case"initAck":s.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==s.enabled&&s.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Ns.ParticipantEncryptionStatusChanged,s.enabled,this.room.localParticipant),this.encryptionEnabled=s.enabled;else if(s.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(s.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(s.participantIdentity));this.emit(Ns.ParticipantEncryptionStatusChanged,s.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(Gs.KeyRatcheted,s.material,s.keyIndex);break}},this.onWorkerError=n=>{Ue.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Ns.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!RG())throw new rC("tried to setup end-to-end encryption on an unsupported browser");if(Ue.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(Ue.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){Ue.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?Ue.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(ye.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(ee.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==sn.NONE,i.identity)),e.on(ee.ConnectionStateChanged,r=>{r===Xe.Connected&&e.participants.forEach(i=>{i.tracks.forEach(o=>{this.setParticipantCryptorEnabled(o.trackInfo.encryption!==sn.NONE,i.identity)})})}).on(ee.TrackUnsubscribed,(r,i,o)=>{var s;const a={kind:"removeTransform",data:{participantIdentity:o.identity,trackId:r.mediaStreamID}};(s=this.worker)===null||s===void 0||s.postMessage(a)}).on(ee.TrackSubscribed,(r,i,o)=>{this.setupE2EEReceiver(r,o.identity,i.trackInfo)}).on(ee.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(r=>{this.postKey(r)})}),e.localParticipant.on(ne.LocalTrackPublished,r=>F(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(Gs.SetKey,r=>this.postKey(r)).on(Gs.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const s={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(s)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?qx(r.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof ol)||!n){n||Ue.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return F(this,void 0,void 0,function*(){if(this.worker){if(Hv()){const o={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(qd in e&&i){const c={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(c);return}let o=e.writableStream,s=e.readableStream;if(!o||!s){const c=e.createEncodedStreams();e.writableStream=c.writable,o=c.writable,e.readableStream=c.readable,s=c.readable}const a={kind:"decode",data:{readableStream:s,writableStream:o,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[s,o])}e[qd]=!0}})}handleSender(e,n,r){var i;if(!(qd in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Hv()){Ue.info("initialize script transform");const o={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{Ue.info("initialize encoded streams");const o=e.createEncodedStreams(),s={kind:"encode",data:{readableStream:o.readable,writableStream:o.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s,[o.readable,o.writable])}e[qd]=!0}}}var Cu;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(Cu||(Cu={}));class cW{constructor(){this.pendingTasks=new Map,this.taskMutex=new mi,this.nextTaskIndex=0}run(e){return F(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Cu.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Cu.RUNNING,yield e()}finally{n.status=Cu.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return F(this,void 0,void 0,function*(){return this.run(()=>F(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const lW=["syncState","trickle","offer","answer","simulate","leave"];function uW(t){const e=lW.indexOf(t.case)>=0;return Ue.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var Tt;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(Tt||(Tt={}));class cC{get currentState(){return this.state}get isDisconnected(){return this.state===Tt.DISCONNECTING||this.state===Tt.DISCONNECTED}get isEstablishingConnection(){return this.state===Tt.CONNECTING||this.state===Tt.RECONNECTING}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=Tt.DISCONNECTED,this.log=Ue,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=Qo((r=n.loggerName)!==null&&r!==void 0?r:Qi.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new cW,this.queuedRequests=[],this.closingLock=new mi,this.connectionLock=new mi,this.state=Tt.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,i){return F(this,void 0,void 0,function*(){return this.state=Tt.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return F(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Tt.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r,e=oW(e),e=e.replace(/\/$/,""),e+="/rtc";const o=nW(),s=dW(n,o,r);return new Promise((a,c)=>F(this,void 0,void 0,function*(){const l=yield this.connectionLock.lock();try{const u=()=>F(this,void 0,void 0,function*(){this.close(),clearTimeout(d),c(new at("room connection has been cancelled (signal)"))}),d=setTimeout(()=>{this.close(),c(new at("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&u(),i==null||i.addEventListener("abort",u),this.log.debug("connecting to ".concat(e+s),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+s),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=h=>F(this,void 0,void 0,function*(){if(this.state!==Tt.CONNECTED){clearTimeout(d);try{const f=yield fetch("http".concat(e.substring(2),"/validate").concat(s));if(f.status.toFixed(0).startsWith("4")){const p=yield f.text();c(new at(p,0,f.status))}else c(new at("Internal error",2,f.status))}catch{c(new at("server was not reachable",1))}return}this.handleWSError(h)}),this.ws.onmessage=h=>F(this,void 0,void 0,function*(){var f,p,m,C;let g;if(typeof h.data=="string"){const y=JSON.parse(h.data);g=Ui.fromJson(y)}else if(h.data instanceof ArrayBuffer)g=Ui.fromBinary(new Uint8Array(h.data));else{this.log.error("could not decode websocket message: ".concat(typeof h.data),this.logContext);return}if(this.state!==Tt.CONNECTED){let y=!1;if(((f=g.message)===null||f===void 0?void 0:f.case)==="join"?(this.state=Tt.CONNECTED,i==null||i.removeEventListener("abort",u),this.pingTimeoutDuration=g.message.value.pingTimeout,this.pingIntervalDuration=g.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),a(g.message.value)):this.state===Tt.RECONNECTING&&g.message.case!=="leave"?(this.state=Tt.CONNECTED,i==null||i.removeEventListener("abort",u),this.startPingInterval(),((p=g.message)===null||p===void 0?void 0:p.case)==="reconnect"?a((m=g.message)===null||m===void 0?void 0:m.value):(a(),y=!0)):this.isEstablishingConnection&&g.message.case==="leave"?c(new at("Received leave request while trying to (re)connect",4)):r.reconnect||c(new at("did not receive join response, got ".concat((C=g.message)===null||C===void 0?void 0:C.case," instead"))),!y)return}this.signalLatency&&(yield Zo(this.signalLatency)),this.handleSignalResponse(g)}),this.ws.onclose=h=>{this.isEstablishingConnection&&c(new at("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:h.reason,state:this.state})),this.handleOnClose(h.reason)}}finally{l()}}))}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return F(this,void 0,void 0,function*(){const n=yield this.closingLock.lock();try{if(e&&(this.state=Tt.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const r=new Promise(i=>{this.ws?this.ws.onclose=()=>{i()}:i()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([r,Zo(250)])),this.ws=void 0}}finally{e&&(this.state=Tt.DISCONNECTED),this.clearPingInterval(),n()}})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Gf(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Gf(e)})}sendIceCandidate(e,n){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new ui({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new di({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return this.sendRequest({case:"updateMetadata",value:new Wi({metadata:e,name:n})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new Gi({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new zi({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Me.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new $i({timestamp:Me.parse(Date.now()),rtt:Me.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new Vr({canReconnect:!1,reason:jo.CLIENT_INITIATED})})}sendRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return F(this,void 0,void 0,function*(){if(!n&&!uW(e)&&this.state===Tt.RECONNECTING){this.queuedRequests.push(()=>F(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield Zo(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){this.log.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case),this.logContext);return}const i=new Ao({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(o){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:o}))}})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let o=!1;if(i.case==="answer"){const s=ow(i.value);this.onAnswer&&this.onAnswer(s)}else if(i.case==="offer"){const s=ow(i.value);this.onOffer&&this.onOffer(s)}else if(i.case==="trickle"){const s=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(s,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return F(this,void 0,void 0,function*(){if(this.state===Tt.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=cn.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&cn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=cn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&cn.clearInterval(this.pingInterval)}}function ow(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function Gf(t){return new Fn({sdp:t.sdp,type:t.type})}function dW(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",Ua()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.publishOnly!==void 0&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var iP={},oP={exports:{}},sw=oP.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(sw).forEach(function(t){var e=sw[t];e.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var sP=oP.exports;(function(t){var e=function(a){return String(Number(a))===a?Number(a):a},n=function(a,c,l,u){if(u&&!l)c[u]=e(a[1]);else for(var d=0;d<l.length;d+=1)a[d+1]!=null&&(c[l[d]]=e(a[d+1]))},r=function(a,c,l){var u=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:u&&!c[a.name]&&(c[a.name]={});var d=a.push?{}:u?c[a.name]:c;n(l.match(a.reg),d,a.names,a.name),a.push&&c[a.push].push(d)},i=sP,o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var c={},l=[],u=c;return a.split(/(\r\n|\r|\n)/).filter(o).forEach(function(d){var h=d[0],f=d.slice(2);h==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var p=0;p<(i[h]||[]).length;p+=1){var m=i[h][p];if(m.reg.test(f))return r(m,u,f)}}),c.media=l,c};var s=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=e(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(s,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(e),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},t.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(s,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var u,d=!1;return l[0]!=="~"?u=e(l):(u=e(l.substring(1,l.length)),d=!0),{scid:u,paused:d}})})}})(iP);var Bg=sP,hW=/%[sdv%]/g,fW=function(t){var e=1,n=arguments,r=n.length;return t.replace(hW,function(i){if(e>=r)return i;var o=n[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},Zl=function(t,e,n){var r=e.format instanceof Function?e.format(e.push?n:n[e.name]):e.format,i=[t+"="+r];if(e.names)for(var o=0;o<e.names.length;o+=1){var s=e.names[o];e.name?i.push(n[e.name][s]):i.push(n[e.names[o]])}else i.push(n[e.name]);return fW.apply(null,i)},pW=["v","o","s","i","u","e","p","c","b","t","r","z","a"],gW=["i","c","b","a"],mW=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(o){o.payloads==null&&(o.payloads="")});var n=e.outerOrder||pW,r=e.innerOrder||gW,i=[];return n.forEach(function(o){Bg[o].forEach(function(s){s.name in t&&t[s.name]!=null?i.push(Zl(o,s,t)):s.push in t&&t[s.push]!=null&&t[s.push].forEach(function(a){i.push(Zl(o,s,a))})})}),t.media.forEach(function(o){i.push(Zl("m",Bg.m[0],o)),r.forEach(function(s){Bg[s].forEach(function(a){a.name in o&&o[a.name]!=null?i.push(Zl(s,a,o)):a.push in o&&o[a.push]!=null&&o[a.push].forEach(function(c){i.push(Zl(s,a,c))})})})}),i.join(`\r
`)+`\r
`},vW=iP,yW=mW,Fg=yW,ru=vW.parse;const aw=.7,Fc={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class cw extends oo.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.log=Ue,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=iC(o=>F(this,void 0,void 0,function*(){this.emit(Fc.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(o)o(s);else throw s}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Qo((i=r.loggerName)!==null&&i!==void 0?i:Qi.PCTransport),this.loggerOptions=r,this.config=e,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const e=QG()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return F(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var n;return F(this,void 0,void 0,function*(){let r;if(e.type==="offer"){let{stereoMids:i,nackMids:o}=IW(e);this.remoteStereoMids=i,this.remoteNackMids=o}else if(e.type==="answer"){const i=ru((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"&&this.trackBitrates.some(s=>{if(!s.transceiver||o.mid!=s.transceiver.mid)return!1;let a=0;if(o.rtp.some(l=>l.codec.toUpperCase()===s.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of o.fmtp)if(l.payload===a){l.config=l.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),s.maxbr>0&&(l.config+=";maxaveragebitrate=".concat(s.maxbr*1e3)),c=!0;break}return c||s.maxbr>0&&o.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(s.maxbr*1e3)}),!0})}),r=Fg(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Fc.NegotiationComplete),e.sdp&&ru(e.sdp).media.forEach(o=>{o.type==="video"&&this.emit(Fc.RTPVideoPayloadTypes,o.rtp)}))})}createAndSendOffer(e){var n;return F(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const o=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&o)yield this._pc.setRemoteDescription(o);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e),i=ru((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"?lw(o,[],[]):o.type==="video"&&(CW(o),this.trackBitrates.some(s=>{if(!o.msid||!s.cid||!o.msid.includes(s.cid))return!1;let a=0;if(o.rtp.some(l=>l.codec.toUpperCase()===s.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of o.fmtp)if(l.payload===a){l.config.includes("x-google-start-bitrate")||(l.config+=";x-google-start-bitrate=".concat(Math.round(s.maxbr*aw))),l.config.includes("x-google-max-bitrate")||(l.config+=";x-google-max-bitrate=".concat(s.maxbr)),c=!0;break}return c||o.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(Math.round(s.maxbr*aw),";x-google-max-bitrate=").concat(s.maxbr)}),!0}))}),yield this.setMungedSDP(r,Fg(i)),this.onOffer(r)})}createAndSetAnswer(){var e;return F(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),r=ru((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{i.type==="audio"&&lw(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Fg(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new Ut("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new Ut("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return F(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const s=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(s!==void 0)return i.get(s)})}setMungedSDP(e,n,r){return F(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(o){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:o,sdp:n})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let o="unknown error";i instanceof Error?o=i.message:typeof i=="string"&&(o=i);const s={error:o,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(s.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:s})),new Xv(o)}})}}function lw(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function CW(t){var e,n,r,i;const o=(n=(e=t.rtp[0])===null||e===void 0?void 0:e.codec)===null||n===void 0?void 0:n.toLowerCase();if(!yu(o))return;let s=0;((r=t.ext)===null||r===void 0?void 0:r.some(c=>c.uri===Jb?!0:(c.value>s&&(s=c.value),!1)))||(i=t.ext)===null||i===void 0||i.push({value:s+1,uri:Jb})}function IW(t){var e;const n=[],r=[],i=ru((e=t.sdp)!==null&&e!==void 0?e:"");let o=0;return i.media.forEach(s=>{var a;s.type==="audio"&&(s.rtp.some(c=>c.codec==="opus"?(o=c.payload,!0):!1),!((a=s.rtcpFb)===null||a===void 0)&&a.some(c=>c.payload===o&&c.type==="nack")&&r.push(s.mid),s.fmtp.some(c=>c.payload===o?(c.config.includes("sprop-stereo=1")&&n.push(s.mid),!0):!1))}),{stereoMids:n,nackMids:r}}const Qv="vp8",SW={audioBitrate:Uf.music.maxBitrate,audioPreset:Uf.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:oC.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Qv,backupCodec:!0},aP={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},cP={resolution:Qu.h720.resolution},bW={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new hG,disconnectOnPageLeave:!0,expWebAudioMix:!1},lC={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Gt;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(Gt||(Gt={}));class wW{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,r){var i;this.peerConnectionTimeout=lC.peerConnectionTimeout,this.log=Ue,this.updateState=()=>{var s;const a=this.state,c=this.requiredTransports.map(l=>l.getConnectionState());c.every(l=>l==="connected")?this.state=Gt.CONNECTED:c.some(l=>l==="failed")?this.state=Gt.FAILED:c.some(l=>l==="connecting")?this.state=Gt.CONNECTING:c.every(l=>l==="closed")?this.state=Gt.CLOSED:c.some(l=>l==="closed")?this.state=Gt.CLOSING:c.every(l=>l==="new")&&(this.state=Gt.NEW),a!==this.state&&(this.log.debug("pc state change: from ".concat(Gt[a]," to ").concat(Gt[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=Qo((i=r.loggerName)!==null&&i!==void 0?i:Qi.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const o={optional:[{googDscp:!0}]};this.publisher=new cw(e,o,r),this.subscriber=new cw(e,void 0,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,wn.PUBLISHER)},this.subscriber.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,wn.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var a;(a=this.onDataChannel)===null||a===void 0||a.call(this,s)},this.subscriber.onTrack=s=>{var a;(a=this.onTrack)===null||a===void 0||a.call(this,s)},this.publisher.onOffer=s=>{var a;(a=this.onPublisherOffer)===null||a===void 0||a.call(this,s)},this.state=Gt.NEW,this.connectionLock=new mi}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return F(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return F(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return F(this,void 0,void 0,function*(){n===wn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return F(this,void 0,void 0,function*(){return this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){var r;return F(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(o=>this.ensureTransportConnected(o,e,n)))}finally{i()}})}negotiate(e){return F(this,void 0,void 0,function*(){return new Promise((n,r)=>F(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),o=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",o),this.publisher.once(Fc.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Fc.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(s=>{clearTimeout(i),r(s)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===wn.PUBLISHER?this.publisher.getConnectedAddress():e===wn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return F(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((o,s)=>F(this,void 0,void 0,function*(){const a=()=>{this.log.warn("abort transport connection",this.logContext),cn.clearTimeout(c),s(new at("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&a(),n==null||n.signal.addEventListener("abort",a);const c=cn.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",a),s(new at("could not establish pc connection"))},r);for(;this.state!==Gt.CONNECTED;)if(yield Zo(50),n!=null&&n.signal.aborted){s(new at("room connection has been cancelled",3));return}cn.clearTimeout(c),n==null||n.signal.removeEventListener("abort",a),o()}))})}}const uw="_lossy",dw="_reliable",AW=2*1e3,hw="leave-reconnect";var Xr;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(Xr||(Xr={}));class kW extends oo.EventEmitter{get isClosed(){return this._isClosed}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=lC.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=Xr.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Ue,this.handleDataChannel=r=>{let{channel:i}=r;return F(this,void 0,void 0,function*(){if(i){if(i.label===dw)this.reliableDCSub=i;else if(i.label===uw)this.lossyDCSub=i;else return;this.log.debug("on data channel ".concat(i.id,", ").concat(i.label),this.logContext),i.onmessage=this.handleDataMessage}})},this.handleDataMessage=r=>F(this,void 0,void 0,function*(){var i,o;const s=yield this.dataProcessLock.lock();try{let a;if(r.data instanceof ArrayBuffer)a=r.data;else if(r.data instanceof Blob)a=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const c=_i.fromBinary(new Uint8Array(a));((i=c.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(ye.ActiveSpeakersUpdate,c.value.value.speakers):((o=c.value)===null||o===void 0?void 0:o.case)==="user"&&this.emit(ye.DataPacketReceived,c.value.value,c.kind)}finally{s()}}),this.handleDataError=r=>{const o=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:s}=r.error;this.log.error("DataChannel error on ".concat(o,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:s}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const o=r.currentTarget.maxRetransmits===0?Vt.LOSSY:Vt.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const o=c=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(c,"ms. giving up"),this.logContext),this.emit(ye.Disconnected),this.close()},s=Date.now()-this.reconnectStart;let a=this.getNextRetryDelay({elapsedMs:s,retryCount:this.reconnectAttempts});if(a===null){o(s);return}r===hw&&(a=0),this.log.debug("reconnecting in ".concat(a,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=cn.setTimeout(()=>this.attemptReconnect(i),a)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===Xr.Connected&&r();const o=()=>{this.off(ye.Disconnected,s),r()},s=()=>{this.off(ye.Restarted,o),i()};this.once(ye.Restarted,o),this.once(ye.Disconnected,s)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(ye.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Tt.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(uo.RR_SIGNAL_DISCONNECTED))},this.log=Qo((n=e.loggerName)!==null&&n!==void 0?n:Qi.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new cC(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new mi,this.dataProcessLock=new mi,this.dcBufferStatus=new Map([[Vt.LOSSY,!0],[Vt.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(ye.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(ye.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(ye.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(ye.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(ye.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(ye.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(ye.StreamStateChanged,r)}get logContext(){var e,n,r,i,o,s;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomSid:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,identity:(s=(o=this.latestJoinResponse)===null||o===void 0?void 0:o.participant)===null||s===void 0?void 0:s.identity}}join(e,n,r,i){return F(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.pcManager||(yield this.configure(o)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=o.clientConfiguration,o}catch(o){if(o instanceof at&&o.reason===1&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw o}})}close(){return F(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(ye.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return F(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return F(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Pi("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new at("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:o=>{clearTimeout(i),n(o)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return F(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var n;return F(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==Gt.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new wW(r,e.subscriberPrimary,this.loggerOptions),this.emit(ye.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,o)=>{this.client.sendIceCandidate(i,o)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,o,s)=>F(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(i),this.logContext),i===Gt.CONNECTED){const a=this.pcState===Xr.New;this.pcState=Xr.Connected,a&&this.emit(ye.Connected,e)}else i===Gt.FAILED&&this.pcState===Xr.Connected&&(this.pcState=Xr.Disconnected,this.handleDisconnect("peerconnection failed",s==="failed"?uo.RR_SUBSCRIBER_FAILED:uo.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(ye.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>F(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>F(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(ye.LocalTrackUnpublished,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(ye.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(ye.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",uo.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(hw)):(this.emit(ye.Disconnected,e==null?void 0:e.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason}))}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(o=>{const s={urls:o.urls};o.username&&(s.username=o.username),o.credential&&(s.credential=o.credential),i.push(s)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Ci.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(uw,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(dw,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,n,r){if(!("getCapabilities"in RTCRtpReceiver))return;const i=RTCRtpReceiver.getCapabilities(n);if(!i)return;this.log.debug("get receiver capabilities",Object.assign(Object.assign({},this.logContext),{cap:i}));const o=[],s=[],a=[];i.codecs.forEach(c=>{const l=c.mimeType.toLowerCase();if(l==="audio/opus"){o.push(c);return}if(!(l==="video/".concat(r))){a.push(c);return}if(r==="h264"){c.sdpFmtpLine&&c.sdpFmtpLine.includes("profile-level-id=42e01f")?o.push(c):s.push(c);return}o.push(c)}),YG(e)&&e.setCodecPreferences(o.concat(s,a))}createSender(e,n,r){return F(this,void 0,void 0,function*(){if(Yb())return yield this.createTransceiverRTCRtpSender(e,n,r);if(Qb())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Ut("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return F(this,void 0,void 0,function*(){if(Yb())return this.createSimulcastTransceiverSender(e,n,r,i);if(Qb())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Ut("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ut("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const o={direction:"sendonly",streams:i};r&&(o.sendEncodings=r);const s=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,o);return e.kind===$.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(s,e.kind,n.videoCodec),e.codec=n.videoCodec),s.sender})}createSimulcastTransceiverSender(e,n,r,i){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ut("publisher is closed");const o={direction:"sendonly"};i&&(o.sendEncodings=i);const s=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,o);if(r.videoCodec)return this.setPreferredCodec(s,e.kind,r.videoCodec),e.setSimulcastTrackSender(r.videoCodec,s.sender),s.sender})}createRTCRtpSender(e){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ut("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var n,r,i;return F(this,void 0,void 0,function*(){if(!this._isClosed){if(this.attemptingReconnect){Ue.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Ci.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:Gt.NEW)===Gt.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(o){this.reconnectAttempts+=1;let s=!0;o instanceof Ut?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:o})),s=!1):o instanceof ic||(this.fullReconnectOnNext=!0),s?this.handleDisconnect("reconnect",uo.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(ye.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){var n,r,i;return F(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new Ut("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(ye.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let o;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new ic;o=yield this.join(e??this.url,this.token,this.signalOpts)}catch(s){throw s instanceof at&&s.reason===0?new Ut("could not reconnect, token might be expired"):new ic}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(ye.SignalRestarted,o),yield this.waitForPCReconnected(),this.client.currentState!==Tt.CONNECTED)throw new ic("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(ye.Restarted)}catch(o){const s=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(s){yield this.restartConnection(s);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),o}})}resumeConnection(e){var n;return F(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new Ut("could not reconnect, url or token not saved");if(!this.pcManager)throw new Ut("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(ye.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,this.log.error(r.message,Object.assign(Object.assign({},this.logContext),{error:r}))),r instanceof at&&r.reason===0?new Ut("could not reconnect, token might be expired"):r instanceof at&&r.reason===4?r:new ic(i)}if(this.emit(ye.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Tt.CONNECTED)throw new ic("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(ye.Resumed)})}waitForPCInitialConnection(e,n){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ut("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return F(this,void 0,void 0,function*(){this.pcState=Xr.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Zo(AW),!this.pcManager)throw new Ut("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Xr.Connected}catch(e){throw this.pcState=Xr.Disconnected,new at("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,n){return F(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ut("PC manager is closed");const i=n?this.pcManager.subscriber:this.pcManager.publisher,o=n?"Subscriber":"Publisher";if(!i)throw new at("".concat(o," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const s=this.dataChannelForKind(e,n);if((s==null?void 0:s.readyState)==="open")return;const a=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<a;){if(i.isICEConnected&&((r=this.dataChannelForKind(e,n))===null||r===void 0?void 0:r.readyState)==="open")return;yield Zo(50)}throw new at("could not establish ".concat(o," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(e){return F(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Gt.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return F(this,void 0,void 0,function*(){return new Promise((e,n)=>F(this,void 0,void 0,function*(){if(!this.pcManager){n(new Xv("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(ye.Closing,i),this.pcManager.publisher.once(Fc.RTPVideoPayloadTypes,o=>{const s=new Map;o.forEach(a=>{const c=a.codec.toLowerCase();iW(c)&&s.set(a.payload,c)}),this.emit(ye.RTPVideoMapUpdate,s)});try{yield this.pcManager.negotiate(r),e()}catch(o){o instanceof Xv&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",uo.RR_UNKNOWN),n(o)}finally{this.off(ye.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===Vt.LOSSY)return this.lossyDCSub;if(e===Vt.RELIABLE)return this.reliableDCSub}else{if(e===Vt.LOSSY)return this.lossyDC;if(e===Vt.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const o=this.pcManager.subscriber.getLocalDescription(),s=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,c=new Array;e.forEach(l=>{l.isDesired!==a&&c.push(l.trackSid)}),this.client.sendSyncState(new Hi({answer:o?Gf({sdp:o.sdp,type:o.type}):void 0,offer:s?Gf({sdp:s.sdp,type:s.type}):void 0,subscription:new Ur({trackSids:c,subscribe:!a,participantTracks:[]}),publishTracks:zG(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new Xi({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(Vt.LOSSY),wn.PUBLISHER),n(this.dataChannelForKind(Vt.RELIABLE),wn.PUBLISHER),n(this.dataChannelForKind(Vt.LOSSY,!0),wn.SUBSCRIBER),n(this.dataChannelForKind(Vt.RELIABLE,!0),wn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&cn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){ir()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){ir()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class ic extends Error{}class fw{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return Yv(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return F(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),Ue.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return F(this,void 0,void 0,function*(){const n=yield fetch("".concat(EW(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new at("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function EW(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}const uC=2e3;function Tp(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}class Kn extends ol{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(e,$.Kind.Audio,n,r,o),this.stopOnMute=!1,this.monitorSender=()=>F(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}s&&this.prevStats&&(this._currentBitrate=Tp(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return F(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||ka(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===$.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==ka(this._constraints.deviceId);return this.source===$.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return F(this,void 0,void 0,function*(){let n;if(e){const r=Ep({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return F(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){ir()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},uC)))}setProcessor(e){var n;return F(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return F(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return F(this,void 0,void 0,function*(){const e=yield WG(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(le.AudioSilenceDetected)),e})}}function lP(t,e,n){switch(t.kind){case"audio":return new Kn(t,e,!1,void 0,n);case"video":return new _r(t,e,!1,n);default:throw new Pi("unsupported track type: ".concat(t.kind))}}const TW=Object.values(Qu),xW=Object.values($v),PW=Object.values(oC),RW=[Qu.h180,Qu.h360],NW=[$v.h180,$v.h360],_W=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var r,i;return new Qe(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=n.fps)!==null&&i!==void 0?i:30))))),n.fps,t.encoding.priority)}),qv=["q","h","f"];function e0(t,e,n,r){var i,o;let s=r==null?void 0:r.videoEncoding;t&&(s=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,c=r==null?void 0:r.scalabilityMode,l=r==null?void 0:r.videoCodec;if(!s&&!a&&!c||!e||!n)return[{}];s||(s=OW(t,e,n,l),Ue.debug("using video encoding",s));const u=new Qe(e,n,s.maxBitrate,s.maxFramerate,s.priority);if(c&&yu(l)){Ue.debug("using svc with scalabilityMode ".concat(c));const f=new uP(c),p=[];if(f.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));for(let m=0;m<f.spatial;m+=1)p.push({rid:qv[2-m],maxBitrate:s.maxBitrate/Math.pow(3,m),maxFramerate:u.encoding.maxFramerate});return p[0].scalabilityMode=c,Ue.debug("encodings",p),p}if(!a)return[s];let d=[];t?d=(i=gw(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:pw(t,u):d=(o=gw(r==null?void 0:r.videoSimulcastLayers))!==null&&o!==void 0?o:pw(t,u);let h;if(d.length>0){const f=d[0];d.length>1&&([,h]=d);const p=Math.max(e,n);if(p>=960&&h)return Ug(e,n,[f,h,u]);if(p>=480)return Ug(e,n,[f,u])}return Ug(e,n,[u])}function MW(t,e,n){var r,i,o,s;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&Ue.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const a=t.mediaStreamTrack.getSettings(),c=(r=a.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,l=(o=a.height)!==null&&o!==void 0?o:(s=t.dimensions)===null||s===void 0?void 0:s.height;return e0(t.source===$.Source.ScreenShare,c,l,n)}function OW(t,e,n,r){const i=DW(t,e,n);let{encoding:o}=i[0];const s=Math.max(e,n);for(let a=0;a<i.length;a+=1){const c=i[a];if(o=c.encoding,c.width>=s)break}if(r)switch(r){case"av1":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.7;break;case"vp9":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.85;break}return o}function DW(t,e,n){if(t)return PW;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?TW:xW}function pw(t,e){if(t)return _W(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?RW:NW}function Ug(t,e,n){const r=[];if(n.forEach((i,o)=>{if(o>=qv.length)return;const s=Math.min(t,e),c={rid:qv[o],scaleResolutionDownBy:Math.max(1,s/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(c.maxFramerate=i.encoding.maxFramerate);const l=il()||o===0;i.encoding.priority&&l&&(c.priority=i.encoding.priority,c.networkPriority=i.encoding.priority),r.push(c)}),Ua()&&nP()==="ios"){let i;r.forEach(s=>{i?s.maxFramerate&&s.maxFramerate>i&&(i=s.maxFramerate):i=s.maxFramerate});let o=!0;r.forEach(s=>{var a;s.maxFramerate!=i&&(o&&(o=!1,Ue.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Ue.info('Setting framerate of encoding "'.concat((a=s.rid)!==null&&a!==void 0?a:"",'" to ').concat(i)),s.maxFramerate=i)})}return r}function gw(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class uP{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const LW=5e3;class _r extends ol{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,$.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.monitorSender=()=>F(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}const s=new Map(o.map(a=>[a.rid,a]));if(this.prevStats){let a=0;s.forEach((c,l)=>{var u;const d=(u=this.prevStats)===null||u===void 0?void 0:u.get(l);a+=Tp(c,d)}),this._currentBitrate=a}this.prevStats=s}),this.senderLock=new mi}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!ir())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},uC))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,r,i,o,s;return F(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var a=!0,c=sc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0)o=l.value,a=!1,yield(s=o.sender)===null||s===void 0?void 0:s.replaceTrack(null)}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,r,i,o,s;return F(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var a=!0,c=sc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){o=l.value,a=!1;const u=o;yield(s=u.sender)===null||s===void 0?void 0:s.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===$.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===$.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return F(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var o;if(i.type==="outbound-rtp"){const s={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(o=i.rid)!==null&&o!==void 0?o:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},a=r.get(i.remoteId);a&&(s.jitter=a.jitter,s.packetsLost=a.packetsLost,s.roundTripTime=a.roundTripTime),n.push(s)}}),n})}setPublishingQuality(e){const n=[];for(let r=Zt.LOW;r<=Zt.HIGH;r+=1)n.push(new fi({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(n)}setDeviceId(e){return F(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===ka(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||ka(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var n,r,i,o;return F(this,void 0,void 0,function*(){let s;if(e){const u=Ep({video:e});typeof u.video!="boolean"&&(s=u.video)}yield this.restart(s);try{for(var a=!0,c=sc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){o=l.value,a=!1;const u=o;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,o,s,a,c,l;return F(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,e,n),!((c=this.processor)===null||c===void 0)&&c.processedTrack)try{for(var u=!0,d=sc(this.simulcastCodecs.values()),h;h=yield d.next(),i=h.done,!i;u=!0)a=h.value,u=!1,yield(l=a.sender)===null||l===void 0?void 0:l.replaceTrack(this.processor.processedTrack)}catch(f){o={error:f}}finally{try{!u&&!i&&(s=d.return)&&(yield s.call(d))}finally{if(o)throw o.error}}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},LW))}setPublishingCodecs(e){var n,r,i,o,s,a,c;return F(this,void 0,void 0,function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const l=[];try{for(n=!0,r=sc(e);i=yield r.next(),o=i.done,!o;n=!0){c=i.value,n=!1;const u=c;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(this.log.debug("try setPublishingCodec for ".concat(u.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const h of u.qualities)if(h.enabled){l.push(u.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(u.codec),this.logContext),yield mw(d.sender,d.encodings,u.qualities,this.senderLock,this.log,this.logContext))}}}catch(u){s={error:u}}finally{try{!n&&!o&&(a=r.return)&&(yield a.call(r))}finally{if(s)throw s.error}}return l})}setPublishingLayers(e){return F(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield mw(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return F(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),eP()&&this.isInBackground&&this.source===$.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function mw(t,e,n,r,i,o){return F(this,void 0,void 0,function*(){const s=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:t,qualities:n,senderEncodings:e}));try{const a=t.getParameters(),{encodings:c}=a;if(!c)return;if(c.length!==e.length){i.warn("cannot set publishing layers, encodings mismatch");return}let l=!1;!1&&c[0].scalabilityMode||c.forEach((d,h)=>{var f;let p=(f=d.rid)!==null&&f!==void 0?f:"";p===""&&(p="q");const m=dP(p),C=n.find(g=>g.quality===m);C&&d.active!==C.enabled&&(l=!0,d.active=C.enabled,i.debug("setting layer ".concat(C.quality," to ").concat(d.active?"enabled":"disabled"),o),il()&&(C.enabled?(d.scaleResolutionDownBy=e[h].scaleResolutionDownBy,d.maxBitrate=e[h].maxBitrate,d.maxFrameRate=e[h].maxFrameRate):(d.scaleResolutionDownBy=4,d.maxBitrate=10,d.maxFrameRate=2)))}),l&&(a.encodings=c,i.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:a.encodings})),yield t.setParameters(a))}finally{s()}})}function dP(t){switch(t){case"f":return Zt.HIGH;case"h":return Zt.MEDIUM;case"q":return Zt.LOW;default:return Zt.HIGH}}function vw(t,e,n,r){if(!n)return[new Bn({quality:Zt.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,o=new uP(i),s=[];for(let a=0;a<o.spatial;a+=1)s.push(new Bn({quality:Zt.HIGH-a,width:Math.ceil(t/Math.pow(2,a)),height:Math.ceil(e/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return s}return n.map(i=>{var o,s,a;const c=(o=i.scaleResolutionDownBy)!==null&&o!==void 0?o:1;let l=dP((s=i.rid)!==null&&s!==void 0?s:"");return new Bn({quality:l,width:Math.ceil(t/c),height:Math.ceil(e/c),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class hP extends ${constructor(e,n,r,i,o){super(e,r,o),this.sid=n,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?le.Muted:le.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(le.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return F(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),uC))}}class Ea extends hP{constructor(e,n,r,i,o,s){super(e,n,$.Kind.Audio,r,s),this.monitorReceiver=()=>F(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=Tp(a,this.prevStats)),this.prevStats=a}),this.audioContext=i,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;Ua()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Ua())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return F(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(Jv(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Jv(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(le.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(le.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return F(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const Vg=100;class Iu extends hP{constructor(e,n,r,i,o){super(e,n,$.Kind.Video,r,o),this.elementInfos=[],this.monitorReceiver=()=>F(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=Tp(s,this.prevStats)),this.prevStats=s}),this.debouncedHandleResize=iC(()=>{this.updateDimensions()},Vg),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?Bc(this._mediaStreamTrack,n):wc(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new BW(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return F(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(o=>{o.type==="inbound-rtp"?(r=o.codecId,n={type:"video",framesDecoded:o.framesDecoded,framesDropped:o.framesDropped,framesReceived:o.framesReceived,packetsReceived:o.packetsReceived,packetsLost:o.packetsLost,frameWidth:o.frameWidth,frameHeight:o.frameHeight,pliCount:o.pliCount,firCount:o.firCount,nackCount:o.nackCount,jitter:o.jitter,timestamp:o.timestamp,bytesReceived:o.bytesReceived,decoderImplementation:o.decoderImplementation}):o.type==="codec"&&i.set(o.id,o)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return F(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((a,c)=>Math.max(a,c.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,o=this.elementInfos.some(a=>a.pictureInPicture),s=this.elementInfos.some(a=>a.visible)&&!i||o;if(this.lastVisible!==s){if(!s&&Date.now()-r<Vg){cn.setTimeout(()=>{this.updateVisibility()},Vg);return}this.lastVisible=s,this.emit(le.VisibilityChanged,s,this)}}updateDimensions(){var e,n;let r=0,i=0;const o=this.getPixelDensity();for(const s of this.elementInfos){const a=s.width()*o,c=s.height()*o;a+c>r+i&&(r=a,i=c)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(le.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?qb():n||(qb()>2?2:1)}}class BW{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:o,isIntersecting:s}=r;o===this.element&&(this.isIntersecting=s,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??yw(e),this.isPiP=ir()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=yw(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,tw().observe(this.element),ew().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,n;(e=tw())===null||e===void 0||e.unobserve(this.element),(n=ew())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function yw(t){let e=t.offsetTop,n=t.offsetLeft;const r=t.offsetWidth,i=t.offsetHeight,{hidden:o}=t,{opacity:s,display:a}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+i>window.pageYOffset&&n+r>window.pageXOffset&&!o&&(s!==""?parseFloat(s)>0:!0)&&a!=="none"}class ho extends oo.EventEmitter{constructor(e,n,r,i){var o;super(),this.metadataMuted=!1,this.encryption=sn.NONE,this.log=Ue,this.handleMuted=()=>{this.emit(le.Muted)},this.handleUnmuted=()=>{this.emit(le.Unmuted)},this.log=Qo((o=i==null?void 0:i.loggerName)!==null&&o!==void 0?o:Qi.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=$.Source.Unknown}setTrack(e){this.track&&(this.track.off(le.Muted,this.handleMuted),this.track.off(le.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(le.Muted,this.handleMuted),e.on(le.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),pt(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==sn.NONE}get audioTrack(){if(this.track instanceof Kn||this.track instanceof Ea)return this.track}get videoTrack(){if(this.track instanceof _r||this.track instanceof Iu)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=$.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===$.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(ho||(ho={}));class qu extends ho{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(le.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(le.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(le.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return F(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return F(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return F(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return F(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var Br;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(Br||(Br={}));function FW(t){switch(t){case vo.EXCELLENT:return Br.Excellent;case vo.GOOD:return Br.Good;case vo.POOR:return Br.Poor;case vo.LOST:return Br.Lost;default:return Br.Unknown}}class fP extends oo.EventEmitter{get logContext(){var e,n;return Object.assign(Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,n;return(n=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&n!==void 0?n:!1}constructor(e,n,r,i,o){var s;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Br.Unknown,this.log=Ue,this.log=Qo((s=o==null?void 0:o.loggerName)!==null&&s!==void 0?s:Qi.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,n]of this.tracks)if(n.source===e)return n}getTrackByName(e){for(const[,n]of this.tracks)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrack($.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrack($.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack($.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(ne.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(ne.ParticipantNameChanged,e)}setPermissions(e){var n,r,i,o,s;const a=this.permissions,c=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((o=this.permissions)===null||o===void 0?void 0:o.hidden)||e.recorder!==((s=this.permissions)===null||s===void 0?void 0:s.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((l,u)=>{var d;return l!==((d=this.permissions)===null||d===void 0?void 0:d.canPublishSources[u])});return this.permissions=e,c&&this.emit(ne.ParticipantPermissionsChanged,a),c}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(ne.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=FW(e),n!==this._connectionQuality&&this.emit(ne.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(n=>(n.track instanceof Ea||n.track instanceof Kn)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(le.Muted,()=>{this.emit(ne.TrackMuted,e)}),e.on(le.Unmuted,()=>{this.emit(ne.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case $.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case $.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function UW(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new Zi({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}class dC extends ho{constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=Zt.HIGH,this.handleEnded=o=>{this.setTrack(void 0),this.emit(le.Ended,o)},this.handleVisibilityChange=o=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(o),this.logContext),this.disabled=!o,this.emitTrackUpdate()},this.handleVideoDimensionsChange=o=>{this.log.debug("adaptivestream video dimensions ".concat(o.width,"x").concat(o.height),this.logContext),this.videoDimensions=o,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new Ur({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Di({participantSid:"",trackSids:[this.trackSid]})]});this.emit(le.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?ho.SubscriptionStatus.Unsubscribed:super.isSubscribed?ho.SubscriptionStatus.Subscribed:ho.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?ho.PermissionStatus.Allowed:ho.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof Iu&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof Iu&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(le.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(le.VisibilityChanged,this.handleVisibilityChange),i.off(le.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(le.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(le.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(le.VisibilityChanged,this.handleVisibilityChange),e.on(le.Ended,this.handleEnded),this.emit(le.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(le.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?le.Muted:le.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(le.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(le.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===$.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof Iu&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new Vi({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=Zt.HIGH,this.emit(le.UpdateSettings,e)}}class ed extends fP{static fromParticipantInfo(e,n){return new ed(e,n.sid,n.identity,n.name,n.metadata)}constructor(e,n,r,i,o,s){super(n,r||"",i,o,s),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(le.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),pt(e))),this.signalClient.sendUpdateTrackSettings(n)}),e.on(le.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(le.SubscriptionPermissionChanged,n=>{this.emit(ne.TrackSubscriptionPermissionChanged,e,n)}),e.on(le.SubscriptionStatusChanged,n=>{this.emit(ne.TrackSubscriptionStatusChanged,e,n)}),e.on(le.Subscribed,n=>{this.emit(ne.TrackSubscribed,n,e)}),e.on(le.Unsubscribed,n=>{this.emit(ne.TrackUnsubscribed,n,e)}),e.on(le.SubscriptionFailed,n=>{this.emit(ne.TrackSubscriptionFailed,e.trackSid,n)})}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrack(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$.Source.Microphone;const n=this.getTrack(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,o,s){let a=this.getTrackPublication(n);if(a||n.startsWith("TR")||this.tracks.forEach(u=>{!a&&e.kind===u.kind.toString()&&(a=u)}),!a){if(s===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(ne.TrackSubscriptionFailed,n);return}s===void 0&&(s=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,o,s-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),pt(a))),this.emit(ne.TrackSubscriptionFailed,n);return}const c=e.kind==="video";let l;return c?l=new Iu(e,n,i,o):l=new Ea(e,n,i,this.audioContext,this.audioOutput),l.source=a.source,l.isMuted=a.isMuted,l.setMediaStream(r),l.start(),a.setTrack(l),this.volumeMap.has(a.source)&&l instanceof Ea&&l.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var o,s;let a=this.getTrackPublication(i.sid);if(a)a.updateInfo(i);else{const c=$.kindFromProto(i.type);if(!c)return;a=new dC(c,i,(o=this.signalClient.connectOptions)===null||o===void 0?void 0:o.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(s=this.loggerOptions)===null||s===void 0?void 0:s.loggerName}),a.updateInfo(i),r.set(i.sid,a);const l=Array.from(this.tracks.values()).find(u=>u.source===(a==null?void 0:a.source));l&&a.source!==$.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:pt(l),newTrack:pt(a)})),this.addTrackPublication(a)}n.set(i.sid,a)}),this.tracks.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),pt(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(ne.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.tracks.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(e),r.kind){case $.Kind.Audio:this.audioTracks.delete(e);break;case $.Kind.Video:this.videoTracks.delete(e);break}n&&this.emit(ne.TrackUnpublished,r)}setAudioOutput(e){return F(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTracks.forEach(r=>{var i;r.track instanceof Ea&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}class t0 extends fP{constructor(e,n,r,i){super(e,n,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=sn.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new rP)},this.handleReconnected=()=>{var o,s;(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.resolve)===null||s===void 0||s.call(o),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var o,s;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>this.log.warn(a.message,this.logContext)),(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.reject)===null||s===void 0||s.call(o,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(o=>UW(o)))},this.onTrackUnmuted=o=>{this.onTrackMuted(o,o.isUpstreamPaused)},this.onTrackMuted=(o,s)=>{if(s===void 0&&(s=!0),!o.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),pt(o)));return}this.engine.updateMuteStatus(o.sid,s)},this.onTrackUpstreamPaused=o=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),pt(o))),this.onTrackMuted(o,!0)},this.onTrackUpstreamResumed=o=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),pt(o))),this.onTrackMuted(o,o.isMuted)},this.handleSubscribedQualityUpdate=o=>F(this,void 0,void 0,function*(){var s,a,c,l,u,d;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const h=this.videoTracks.get(o.trackSid);if(!h){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}if(o.subscribedCodecs.length>0){if(!h.videoTrack)return;const C=yield h.videoTrack.setPublishingCodecs(o.subscribedCodecs);try{for(var f=!0,p=sc(C),m;m=yield p.next(),s=m.done,!s;f=!0){l=m.value,f=!1;const g=l;UG(g)&&(this.log.debug("publish ".concat(g," for ").concat(h.videoTrack.sid),Object.assign(Object.assign({},this.logContext),pt(h))),yield this.publishAdditionalCodecForTrack(h.videoTrack,g,h.options))}}catch(g){a={error:g}}finally{try{!f&&!s&&(c=p.return)&&(yield c.call(p))}finally{if(a)throw a.error}}}else o.subscribedQualities.length>0&&(yield(d=h.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(o.subscribedQualities))}),this.handleLocalTrackUnpublished=o=>{const s=this.tracks.get(o.trackSid);if(!s){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}this.unpublishTrack(s.track)},this.handleTrackEnded=o=>F(this,void 0,void 0,function*(){if(o.source===$.Source.ScreenShare||o.source===$.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),pt(o))),this.unpublishTrack(o);else if(o.isUserProvided)yield o.mute();else if(o instanceof Kn||o instanceof _r)try{if(ir())try{const s=yield navigator==null?void 0:navigator.permissions.query({name:o.source===$.Source.Camera?"camera":"microphone"});if(s&&s.state==="denied")throw this.log.warn("user has revoked access to ".concat(o.source),Object.assign(Object.assign({},this.logContext),pt(o))),s.onchange=()=>{s.state!=="denied"&&(o.isMuted||o.restartTrack(),s.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}o.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),pt(o))),yield o.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),pt(o))),yield o.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==sn.NONE}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(ye.RemoteMute,(n,r)=>{const i=this.tracks.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(ye.Connected,this.handleReconnected).on(ye.SignalRestarted,this.handleReconnected).on(ye.SignalResumed,this.handleReconnected).on(ye.Restarting,this.handleReconnecting).on(ye.Resuming,this.handleReconnecting).on(ye.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(ye.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(ye.Disconnected,this.handleDisconnected)}setMetadata(e){var n;this.engine.client.sendUpdateLocalMetadata(e,(n=this.name)!==null&&n!==void 0?n:"")}setName(e){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",e)}setCameraEnabled(e,n,r){return this.setTrackEnabled($.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled($.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled($.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(ne.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return F(this,void 0,void 0,function*(){this.encryptionType=e?sn.GCM:sn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){var o,s;return F(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n}));let a=this.getTrack(e);if(n)if(a)yield a.unmute();else{let c;if(this.pendingPublishing.has(e)){this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:e}));return}this.pendingPublishing.add(e);try{switch(e){case $.Source.Camera:c=yield this.createTracks({video:(o=r)!==null&&o!==void 0?o:!0});break;case $.Source.Microphone:c=yield this.createTracks({audio:(s=r)!==null&&s!==void 0?s:!0});break;case $.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},r));break;default:throw new Pi(e)}const l=[];for(const d of c)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),pt(d))),l.push(this.publishTrack(d,i));[a]=yield Promise.all(l)}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l instanceof Error&&!(l instanceof Pi)&&this.emit(ne.MediaDevicesError,l),l}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===$.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const c=this.getTrack($.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return F(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has($.Source.Camera)||this.pendingPublishing.has($.Source.Microphone))){this.pendingPublishing.add($.Source.Camera),this.pendingPublishing.add($.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete($.Source.Camera),this.pendingPublishing.delete($.Source.Microphone)}}})}createTracks(e){var n,r;return F(this,void 0,void 0,function*(){const i=Qx(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),o=Ep(i);let s;try{s=yield navigator.mediaDevices.getUserMedia(o)}catch(a){throw a instanceof Error&&(o.audio&&(this.microphoneError=a),o.video&&(this.cameraError=a)),a}return o.audio&&(this.microphoneError=void 0,this.emit(ne.AudioStreamAcquired)),o.video&&(this.cameraError=void 0),s.getTracks().map(a=>{const c=a.kind==="audio";c?e.audio:e.video;let l;const u=c?o.audio:o.video;typeof u!="boolean"&&(l=u);const d=lP(a,l,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return d.kind===$.Kind.Video?d.source=$.Source.Camera:d.kind===$.Kind.Audio&&(d.source=$.Source.Microphone),d.mediaStream=s,d})})}createScreenTracks(e){return F(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new rC("getDisplayMedia not supported");e.resolution===void 0&&!qG()&&(e.resolution=oC.h1080fps30.resolution);const n=ZG(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new Pi("no video track found");const o=new _r(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=$.Source.ScreenShare,e.contentHint&&(o.mediaStreamTrack.contentHint=e.contentHint);const s=[o];if(r.getAudioTracks().length>0){this.emit(ne.AudioStreamAcquired);const a=new Kn(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=$.Source.ScreenShareAudio,s.push(a)}return s})}publishTrack(e,n){var r,i,o,s;return F(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,e instanceof ol&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let a;if(e instanceof MediaStreamTrack)a=e.getConstraints();else{a=e.constraints;let f;switch(e.source){case $.Source.Microphone:f="audioinput";break;case $.Source.Camera:f="videoinput"}f&&this.activeDeviceMap.has(f)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(f)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new Kn(e,a,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":e=new _r(e,a,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new Pi("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e instanceof Kn&&e.setAudioContext(this.audioContext);let c;if(this.tracks.forEach(f=>{f.track&&f.track===e&&(c=f)}),c)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),pt(c))),c;const l="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,u=(i=n==null?void 0:n.forceStereo)!==null&&i!==void 0?i:l;u&&(n||(n={}),n.dtx===void 0&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),pt(e))),n.red===void 0&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(o=n.dtx)!==null&&o!==void 0||(n.dtx=!1),(s=n.red)!==null&&s!==void 0||(n.red=!1));const d=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);Fa()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),d.simulcast=!1),d.source&&(e.source=d.source);const h=this.publish(e,d,u);this.pendingPublishPromises.set(e,h);try{return yield h}catch(f){throw f}finally{this.pendingPublishPromises.delete(e)}})}publish(e,n,r){var i,o,s,a,c,l,u,d,h,f,p,m,C;return F(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(T=>e instanceof ol&&T.source===e.source)&&e.source!==$.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),pt(e))),n.stopMicTrackOnMute&&e instanceof Kn&&(e.stopOnMute=!0),e.source===$.Source.ScreenShare&&il()&&(n.simulcast=!1),n.videoCodec==="av1"&&!$G()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!KG()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=Qv);const y=n.videoCodec;e.on(le.Muted,this.onTrackMuted),e.on(le.Unmuted,this.onTrackUnmuted),e.on(le.Ended,this.handleTrackEnded),e.on(le.UpstreamPaused,this.onTrackUpstreamPaused),e.on(le.UpstreamResumed,this.onTrackUpstreamResumed);const S=new li({cid:e.mediaStreamTrack.id,name:n.name,type:$.kindToProto(e.kind),muted:e.isMuted,source:$.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((o=n.red)!==null&&o!==void 0)||o),stream:n==null?void 0:n.stream});let E;if(e.kind===$.Kind.Video){let T={width:0,height:0};try{T=yield e.waitForDimensions()}catch{const M=(a=(s=this.roomOptions.videoCaptureDefaults)===null||s===void 0?void 0:s.resolution)!==null&&a!==void 0?a:Qu.h720.resolution;T={width:M.width,height:M.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{dims:T}))}S.width=T.width,S.height=T.height,e instanceof _r&&(yu(y)&&(e.source===$.Source.ScreenShare&&y==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(c=n.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),S.simulcastCodecs=[new ci({codec:y,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:Qv}),n.backupCodec&&y!==n.backupCodec.codec&&S.encryption===sn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),S.simulcastCodecs.push(new ci({codec:n.backupCodec.codec,cid:""})))),E=e0(e.source===$.Source.ScreenShare,S.width,S.height,n),S.layers=vw(S.width,S.height,E,yu(n.videoCodec))}else e.kind===$.Kind.Audio&&(E=[{maxBitrate:(u=(l=n.audioPreset)===null||l===void 0?void 0:l.maxBitrate)!==null&&u!==void 0?u:n.audioBitrate,priority:(h=(d=n.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&h!==void 0?h:"high",networkPriority:(p=(f=n.audioPreset)===null||f===void 0?void 0:f.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new Ut("cannot publish track when not connected");const A=yield this.engine.addTrack(S);let P;if(A.codecs.forEach(T=>{P===void 0&&(P=T.mimeType)}),P&&e.kind===$.Kind.Video){const T=qx(P);T!==y&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{codec:T})),n.videoCodec=T,E=e0(e.source===$.Source.ScreenShare,S.width,S.height,n))}const w=new qu(e.kind,A,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(w.options=n,e.sid=A.sid,!this.engine.pcManager)throw new Ut("pcManager is not ready");if(this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:E,trackInfo:A})),e.sender=yield this.engine.createSender(e,n,E),E)if(il()&&e.kind===$.Kind.Audio){let T;for(const _ of this.engine.pcManager.publisher.getTransceivers())if(_.sender===e.sender){T=_;break}T&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:T,codec:"opus",maxbr:!((m=E[0])===null||m===void 0)&&m.maxBitrate?E[0].maxBitrate/1e3:0})}else e.codec&&yu(e.codec)&&(!((C=E[0])===null||C===void 0)&&C.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:S.cid,codec:e.codec,maxbr:E[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof _r?e.startMonitor(this.engine.client):e instanceof Kn&&e.startMonitor(),this.addTrackPublication(w),this.emit(ne.LocalTrackPublished,w),w})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){var i;return F(this,void 0,void 0,function*(){if(this.encryptionType!==sn.NONE)return;let o;if(this.tracks.forEach(d=>{d.track&&d.track===e&&(o=d)}),!o)throw new Pi("track is not published");if(!(e instanceof _r))throw new Pi("track is not a video track");const s=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=MW(e,n,s);if(!a){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),pt(e)));return}const c=e.addSimulcastTrack(n,a),l=new li({cid:c.mediaStreamTrack.id,type:$.kindToProto(e.kind),muted:e.isMuted,source:$.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:s.videoCodec,cid:c.mediaStreamTrack.id}]});if(l.layers=vw(l.width,l.height,a),!this.engine||this.engine.isClosed)throw new Ut("cannot publish track when not connected");const u=yield this.engine.addTrack(l);yield this.engine.createSimulcastSender(e,c,s,a),yield this.engine.negotiate(),this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:u}))})}unpublishTrack(e,n){var r,i;return F(this,void 0,void 0,function*(){const o=this.getPublicationForTrack(e),s=o?pt(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),s)),!o||!o.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),s));return}e=o.track,e.off(le.Muted,this.onTrackMuted),e.off(le.Unmuted,this.onTrackUnmuted),e.off(le.Ended,this.handleTrackEnded),e.off(le.UpstreamPaused,this.onTrackUpstreamPaused),e.off(le.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n&&e.stop();let a=!1;const c=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Gt.FAILED&&c)try{for(const l of this.engine.pcManager.publisher.getTransceivers())l.sender===c&&(l.direction="inactive",a=!0);if(this.engine.removeTrack(c)&&(a=!0),e instanceof _r){for(const[,l]of e.simulcastCodecs)l.sender&&(this.engine.removeTrack(l.sender)&&(a=!0),l.sender=void 0);e.simulcastCodecs.clear()}}catch(l){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),s),{error:l}))}switch(this.tracks.delete(o.trackSid),o.kind){case $.Kind.Audio:this.audioTracks.delete(o.trackSid);break;case $.Kind.Video:this.videoTracks.delete(o.trackSid);break}return this.emit(ne.LocalTrackUnpublished,o),o.setTrack(void 0),a&&(yield this.engine.negotiate()),o})}unpublishTracks(e){return F(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof qu)})}republishAllTracks(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return F(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(e&&(i.options=Object.assign(Object.assign({},i.options),e)),r.push(i))}),yield Promise.all(r.map(i=>F(this,void 0,void 0,function*(){const o=i.track;yield this.unpublishTrack(o,!1),n&&!o.isMuted&&o.source!==$.Source.ScreenShare&&o.source!==$.Source.ScreenShareAudio&&(o instanceof Kn||o instanceof _r)&&!o.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:i.trackSid})),yield o.restartTrack()),yield this.publishTrack(o,i.options)})))})}publishData(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return F(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,o=[],s=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(c=>{c instanceof ed?o.push(c.sid):o.push(c)});const a=new _i({kind:n,value:{case:"user",value:new Oi({participantSid:this.sid,payload:e,destinationSids:o,topic:s})}});yield this.engine.sendDataPacket(a,n)})}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const o=this.tracks.get(n.sid);if(o){const s=o.isMuted||((i=(r=o.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);s!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),pt(o)),{mutedOnServer:s})),this.engine.client.sendMuteTrack(n.sid,s))}}),!0)}getPublicationForTrack(e){let n;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof Kn||i instanceof _r)&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}}var Xe;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting"})(Xe||(Xe={}));const VW=2*1e3;class Wf extends oo.EventEmitter{constructor(e){var n,r,i;super(),n=this,this.state=Xe.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Ue,this.bufferedEvents=[],this.connect=(o,s,a)=>F(this,void 0,void 0,function*(){var c;const l=yield this.disconnectLock.lock();if(this.state===Xe.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),l(),Promise.resolve();if(this.connectFuture)return l(),this.connectFuture.promise;this.setAndEmitConnectionState(Xe.Connecting),((c=this.regionUrlProvider)===null||c===void 0?void 0:c.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Yv(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new fw(o,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().catch(h=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:h}))}));const u=(h,f,p)=>F(this,void 0,void 0,function*(){var m;this.abortController&&this.abortController.abort();const C=new AbortController;this.abortController=C,l==null||l();try{yield this.attemptConnection(p??o,s,a,C),this.abortController=void 0,h()}catch(g){if(this.regionUrlProvider&&g instanceof at&&g.reason!==3&&g.reason!==0){let y=null;try{y=yield this.regionUrlProvider.getNextBestRegionUrl((m=this.abortController)===null||m===void 0?void 0:m.signal)}catch(S){if(S instanceof at&&(S.status===401||S.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(S);return}}y?(this.log.info("Initial connection failed with ConnectionError: ".concat(g.message,". Retrying with another region: ").concat(y),this.logContext),yield u(h,f,y)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(g))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(g)}}),d=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new rP((h,f)=>{u(h,f,d)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,s,a,c,l,u)=>F(this,void 0,void 0,function*(){var d,h,f;const p=yield a.join(o,s,{autoSubscribe:c.autoSubscribe,publishOnly:c.publishOnly,adaptiveStream:typeof l.adaptiveStream=="object"?!0:l.adaptiveStream,maxRetries:c.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:c.websocketTimeout},u.signal);let m=p.serverInfo;if(m||(m={version:p.serverVersion,region:p.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(m).map(C=>{let[g,y]=C;return"".concat(g,": ").concat(y)}).join(", ")),{room:(d=p.room)===null||d===void 0?void 0:d.name,roomSid:(h=p.room)===null||h===void 0?void 0:h.sid,identity:(f=p.participant)===null||f===void 0?void 0:f.identity}),!p.serverVersion)throw new _G("unknown server version");return p.serverVersion==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),l.dynacast=!1),p}),this.applyJoinResponse=o=>{const s=o.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(o.sifTrailer)},this.attemptConnection=(o,s,a,c)=>F(this,void 0,void 0,function*(){var l,u;this.state===Xe.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((l=this.regionUrlProvider)===null||l===void 0)&&l.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},lC),a),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const d=yield this.connectSignal(o,s,this.engine,this.connOptions,this.options,c);this.applyJoinResponse(d),this.setupLocalParticipantEvents(),this.emit(ee.SignalConnected)}catch(d){yield this.engine.close(),this.recreateEngine();const h=new at("could not establish signal connection");throw d instanceof Error&&(h.message="".concat(h.message,": ").concat(d.message)),d instanceof at&&(h.reason=d.reason,h.status=d.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:d})),h}if(c.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new at("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,c)}catch(d){throw yield this.engine.close(),this.recreateEngine(),d}ir()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),ir()&&(document.addEventListener("freeze",this.onPageLeave),(u=navigator.mediaDevices)===null||u===void 0||u.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(Xe.Connected),this.emit(ee.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return F(n,void 0,void 0,function*(){var s,a,c,l;const u=yield this.disconnectLock.lock();try{if(this.state===Xe.Disconnected){this.log.debug("already disconnected",this.logContext);return}this.log.info("disconnect from room",Object.assign({},this.logContext)),(this.state===Xe.Connecting||this.state===Xe.Reconnecting)&&(this.log.warn("abort connection attempt",this.logContext),(s=this.abortController)===null||s===void 0||s.abort(),(c=(a=this.connectFuture)===null||a===void 0?void 0:a.reject)===null||c===void 0||c.call(a,new at("Client initiated disconnect")),this.connectFuture=void 0),!((l=this.engine)===null||l===void 0)&&l.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(o,jo.CLIENT_INITIATED),this.engine=void 0}finally{u()}})},this.onPageLeave=()=>F(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>F(this,void 0,void 0,function*(){const o=[],s=qo();if(s&&s.os==="iOS"){const a="livekit-dummy-audio-el";let c=document.getElementById(a);if(!c){c=document.createElement("audio"),c.id=a,c.autoplay=!0,c.hidden=!0;const l=Lg();l.enabled=!0;const u=new MediaStream([l]);c.srcObject=u,document.addEventListener("visibilitychange",()=>{c&&(c.srcObject=document.hidden?null:u,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(c),this.once(ee.Disconnected,()=>{c==null||c.remove(),c=null})}o.push(c)}this.participants.forEach(a=>{a.audioTracks.forEach(c=>{c.track&&c.track.attachedElements.forEach(l=>{o.push(l)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(a=>(a.muted=!1,a.play()))]),this.handleAudioPlaybackStarted()}catch(a){throw this.handleAudioPlaybackFailed(a),a}}),this.startVideo=()=>F(this,void 0,void 0,function*(){const o=[];for(const s of this.participants.values())s.videoTracks.forEach(a=>{var c;(c=a.track)===null||c===void 0||c.attachedElements.forEach(l=>{o.includes(l)||o.push(l)})});yield Promise.all(o.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const o of this.participants.values())this.handleParticipantDisconnected(o.sid,o);this.setAndEmitConnectionState(Xe.Reconnecting)&&this.emit(ee.Reconnecting)},this.handleSignalRestarted=o=>F(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(s){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:s}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(Xe.Connected),this.emit(ee.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const a=this.identityToSid.get(s.identity);a&&a!==s.sid&&this.handleParticipantDisconnected(a,this.participants.get(a));let c=this.participants.get(s.sid);const l=!c;s.state===La.DISCONNECTED?this.handleParticipantDisconnected(s.sid,c):(c=this.getOrCreateParticipant(s.sid,s),l||c.updateInfo(s))})},this.handleActiveSpeakersUpdate=o=>{const s=[],a={};o.forEach(c=>{if(a[c.sid]=!0,c.sid===this.localParticipant.sid)this.localParticipant.audioLevel=c.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const l=this.participants.get(c.sid);l&&(l.audioLevel=c.level,l.setIsSpeaking(!0),s.push(l))}}),a[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(c=>{a[c.sid]||(c.audioLevel=0,c.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(ee.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=o=>{const s=new Map;this.activeSpeakers.forEach(c=>{s.set(c.sid,c)}),o.forEach(c=>{let l=this.participants.get(c.sid);c.sid===this.localParticipant.sid&&(l=this.localParticipant),l&&(l.audioLevel=c.level,l.setIsSpeaking(c.active),c.active?s.set(c.sid,l):s.delete(c.sid))});const a=Array.from(s.values());a.sort((c,l)=>l.audioLevel-c.audioLevel),this.activeSpeakers=a,this.emitWhenConnected(ee.ActiveSpeakersChanged,a)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(s=>{const a=this.participants.get(s.participantSid);if(!a)return;const c=a.getTrackPublication(s.trackSid);!c||!c.track||(c.track.streamState=$.streamStateFromProto(s.state),a.emit(ne.TrackStreamStateChanged,c,c.track.streamState),this.emitWhenConnected(ee.TrackStreamStateChanged,c,c.track.streamState,a))})},this.handleSubscriptionPermissionUpdate=o=>{const s=this.participants.get(o.participantSid);if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const s=Array.from(this.participants.values()).find(c=>c.tracks.has(o.trackSid));if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setSubscriptionError(o.err)},this.handleDataPacket=(o,s)=>{const a=this.participants.get(o.participantSid);this.emit(ee.DataReceived,o.payload,a,s,o.topic),a==null||a.emit(ne.DataReceived,o.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ee.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ee.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ee.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ee.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>F(this,void 0,void 0,function*(){this.emit(ee.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const s=this.roomInfo;this.roomInfo=o,s&&s.metadata!==o.metadata&&this.emitWhenConnected(ee.RoomMetadataChanged,o.metadata),(s==null?void 0:s.activeRecording)!==o.activeRecording&&this.emitWhenConnected(ee.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const a=this.participants.get(s.participantSid);a&&a.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(ee.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(ee.ParticipantNameChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(ee.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(ee.TrackUnmuted,o,this.localParticipant)},this.onLocalTrackPublished=o=>F(this,void 0,void 0,function*(){var s;this.emit(ee.LocalTrackPublished,o,this.localParticipant),o.track instanceof Kn&&(yield o.track.checkForSilence())&&this.emit(ee.LocalAudioSilenceDetected,o);const a=yield(s=o.track)===null||s===void 0?void 0:s.getDeviceId(),c=jG(o.source);c&&a&&a!==this.localParticipant.activeDeviceMap.get(c)&&(this.localParticipant.activeDeviceMap.set(c,a),this.emit(ee.ActiveDeviceChanged,c,a))}),this.onLocalTrackUnpublished=o=>{this.emit(ee.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalConnectionQualityChanged=o=>{this.emit(ee.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(ee.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(ee.ParticipantPermissionsChanged,o,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},bW),e),this.log=Qo((r=this.options.loggerName)!==null&&r!==void 0?r:Qi.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},aP),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},cP),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},SW),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new mi,this.localParticipant=new t0("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",ka(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",ka(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",ka(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return F(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new aW(this.options.e2ee),this.e2eeManager.on(Ns.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof t0&&(this.isE2EEEnabled=n),this.emit(ee.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(Ns.EncryptionError,n=>this.emit(ee.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&n!==void 0?n:""}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new kW(this.options),this.engine.on(ye.ParticipantUpdate,this.handleParticipantUpdates).on(ye.RoomUpdate,this.handleRoomUpdate).on(ye.SpeakersChanged,this.handleSpeakersChanged).on(ye.StreamStateChanged,this.handleStreamStateUpdate).on(ye.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(ye.SubscriptionError,this.handleSubscriptionError).on(ye.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(ye.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(ye.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(ye.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(ye.DataPacketReceived,this.handleDataPacket).on(ye.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(Xe.Reconnecting)&&this.emit(ee.Reconnecting)}).on(ye.Resumed,()=>{this.setAndEmitConnectionState(Xe.Connected),this.emit(ee.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()}).on(ye.SignalResumed,()=>{this.bufferedEvents=[],this.state===Xe.Reconnecting&&this.sendSyncState()}).on(ye.Restarting,this.handleRestarting).on(ye.SignalRestarted,this.handleSignalRestarted).on(ye.DCBufferStatusChanged,(e,n)=>{this.emit(ee.DCBufferStatusChanged,e,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return On.getInstance().getDevices(e,n)}prepareConnection(e,n){return F(this,void 0,void 0,function*(){if(this.state===Xe.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Yv(new URL(e))&&n){this.regionUrlProvider=new fw(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===Xe.Disconnected&&(this.regionUrl=r,yield fetch(rw(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(rw(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const n=this.identityToSid.get(e);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return F(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new on({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new on({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new on({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new on({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>F(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new on({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>F(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new on({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new on({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>F(this,void 0,void 0,function*(){const o=this.engine.client.onLeave;o&&o(new Vr({reason:jo.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new on({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,n;return(n=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,o,s;return F(this,void 0,void 0,function*(){let a=!1,c=!0;const l=r?{exact:n}:n;if(e==="audioinput"){const u=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.audioTracks.values()).filter(h=>h.source===$.Source.Microphone);try{c=(yield Promise.all(d.map(h=>{var f;return(f=h.audioTrack)===null||f===void 0?void 0:f.setDeviceId(l)}))).every(h=>h===!0)}catch(h){throw this.options.audioCaptureDefaults.deviceId=u,h}}else if(e==="videoinput"){const u=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.videoTracks.values()).filter(h=>h.source===$.Source.Camera);try{c=(yield Promise.all(d.map(h=>{var f;return(f=h.videoTrack)===null||f===void 0?void 0:f.setDeviceId(l)}))).every(h=>h===!0)}catch(h){throw this.options.videoCaptureDefaults.deviceId=u,h}}else if(e==="audiooutput"){if(!Jv()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(s=this.options).audioOutput)!==null&&i!==void 0||(s.audioOutput={});const u=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,a=u!==l;try{this.options.expWebAudioMix?(o=this.audioContext)===null||o===void 0||o.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(d=>d.setAudioOutput({deviceId:n})))}catch(d){throw this.options.audioOutput.deviceId=u,d}}return a&&c&&(this.localParticipant.activeDeviceMap.set(e,n),this.emit(ee.ActiveDeviceChanged,e,n)),c})}setupLocalParticipantEvents(){this.localParticipant.on(ne.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ne.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ne.TrackMuted,this.onLocalTrackMuted).on(ne.TrackUnmuted,this.onLocalTrackUnmuted).on(ne.LocalTrackPublished,this.onLocalTrackPublished).on(ne.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ne.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ne.MediaDevicesError,this.onMediaDevicesError).on(ne.AudioStreamAcquired,this.startAudio).on(ne.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===Xe.Connecting||this.state===Xe.Reconnecting){const u=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(ee.Reconnected,u),this.off(ee.Connected,u),this.off(ee.Disconnected,d)};this.once(ee.Reconnected,u),this.once(ee.Connected,u),this.once(ee.Disconnected,d);return}if(this.state===Xe.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const i=XG(n.id),o=i[0];let s=i[1],a=e.id;if(s&&s.startsWith("TR")&&(a=s),o===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const c=this.participants.get(o);if(!c){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);return}let l;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?l=this.options.adaptiveStream:l={}),c.addSubscribedMediaTrack(e,a,n,r,l)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==Xe.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(o=>{i.unpublishTrack(o.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var o,s;i.track&&this.localParticipant.unpublishTrack(i.track,e),e&&((o=i.track)===null||o===void 0||o.detach(),(s=i.track)===null||s===void 0||s.stop())}),this.localParticipant.off(ne.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ne.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ne.TrackMuted,this.onLocalTrackMuted).off(ne.TrackUnmuted,this.onLocalTrackUnmuted).off(ne.LocalTrackPublished,this.onLocalTrackPublished).off(ne.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ne.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ne.MediaDevicesError,this.onMediaDevicesError).off(ne.AudioStreamAcquired,this.startAudio).off(ne.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),ir()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Xe.Disconnected),this.emit(ee.Disconnected,n)}}}handleParticipantDisconnected(e,n){this.participants.delete(e),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(ee.ParticipantDisconnected,n))}acquireAudioContext(){var e,n;return F(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=sC())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(ee.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=ed.fromParticipantInfo(this.engine.client,n):i=new ed(this.engine.client,e,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),i}getOrCreateParticipant(e,n){if(this.participants.has(e))return this.participants.get(e);const r=this.createParticipant(e,n);return this.participants.set(e,r),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(ee.ParticipantConnected,r),r.on(ne.TrackPublished,i=>{this.emitWhenConnected(ee.TrackPublished,i,r)}).on(ne.TrackSubscribed,(i,o)=>{i.kind===$.Kind.Audio?(i.on(le.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(le.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===$.Kind.Video&&(i.on(le.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(le.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ee.TrackSubscribed,i,o,r)}).on(ne.TrackUnpublished,i=>{this.emit(ee.TrackUnpublished,i,r)}).on(ne.TrackUnsubscribed,(i,o)=>{this.emit(ee.TrackUnsubscribed,i,o,r)}).on(ne.TrackSubscriptionFailed,i=>{this.emit(ee.TrackSubscriptionFailed,i,r)}).on(ne.TrackMuted,i=>{this.emitWhenConnected(ee.TrackMuted,i,r)}).on(ne.TrackUnmuted,i=>{this.emitWhenConnected(ee.TrackUnmuted,i,r)}).on(ne.ParticipantMetadataChanged,i=>{this.emitWhenConnected(ee.ParticipantMetadataChanged,i,r)}).on(ne.ParticipantNameChanged,i=>{this.emitWhenConnected(ee.ParticipantNameChanged,i,r)}).on(ne.ConnectionQualityChanged,i=>{this.emitWhenConnected(ee.ConnectionQualityChanged,i,r)}).on(ne.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(ee.ParticipantPermissionsChanged,i,r)}).on(ne.TrackSubscriptionStatusChanged,(i,o)=>{this.emitWhenConnected(ee.TrackSubscriptionStatusChanged,i,o,r)}).on(ne.TrackSubscriptionFailed,(i,o)=>{this.emit(ee.TrackSubscriptionFailed,i,r,o)}).on(ne.TrackSubscriptionPermissionChanged,(i,o)=>{this.emitWhenConnected(ee.TrackSubscriptionPermissionChanged,i,o,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.participants.values())for(const n of e.videoTracks.values())n.isSubscribed&&n instanceof dC&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=cn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,jo.STATE_MISMATCH))):e=0},VW)}clearConnectionReconcile(){this.connectionReconcileInterval&&cn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(ee.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.state===Xe.Connected?this.emit(e,...r):(this.state===Xe.Reconnecting&&this.bufferedEvents.push([e,r]),!1)}simulateParticipants(e){var n,r;return F(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Cl({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Me.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Ir({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ee.SignalConnected),this.emit(ee.Connected),this.setAndEmitConnectionState(Xe.Connected),i.video){const s=new qu($.Kind.Video,new er({source:Nt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:bn.AUDIO,name:"video-dummy"}),new _r(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:nw(160*((n=o.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(ne.LocalTrackPublished,s)}if(i.audio){const s=new qu($.Kind.Audio,new er({source:Nt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:bn.AUDIO}),new Kn(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Lg(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(ne.LocalTrackPublished,s)}for(let s=0;s<o.count-1;s+=1){let a=new Ir({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(s),state:La.ACTIVE,tracks:[],joinedAt:Me.parse(Date.now())});const c=this.getOrCreateParticipant(a.identity,a);if(o.video){const l=nw(160*((r=o.aspectRatios[s%o.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),u=new er({source:Nt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:bn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}if(o.audio){const l=Lg(),u=new er({source:Nt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:bn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}c.updateInfo(a)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(e!==ee.ActiveSpeakersChanged){const o=pP(r).filter(s=>s!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:o}))}return super.emit(e,...r)}}function pP(t){return t.map(e=>{if(e)return Array.isArray(e)?pP(e):typeof e=="object"?"logContext"in e&&e.logContext:e})}var oi;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(oi||(oi={}));class Sl extends oo.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=oi.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Wf(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return F(this,void 0,void 0,function*(){if(this.status!==oi.IDLE)throw Error("check is running already");this.setStatus(oi.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==oi.SKIPPED&&this.setStatus(this.isSuccess()?oi.SUCCESS:oi.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return F(this,void 0,void 0,function*(){return this.room.state===Xe.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return F(this,void 0,void 0,function*(){this.room&&this.room.state!==Xe.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(oi.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function gP(t){var e,n;return F(this,void 0,void 0,function*(){t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio=!0),(n=t.video)!==null&&n!==void 0||(t.video=!0);const r=Qx(t,aP,cP),i=Ep(r),o=navigator.mediaDevices.getUserMedia(i);t.audio&&(On.userMediaPromiseMap.set("audioinput",o),o.catch(()=>On.userMediaPromiseMap.delete("audioinput"))),t.video&&(On.userMediaPromiseMap.set("videoinput",o),o.catch(()=>On.userMediaPromiseMap.delete("videoinput")));const s=yield o;return s.getTracks().map(a=>{const c=a.kind==="audio";c?t.audio:t.video;let l;const u=c?i.audio:i.video;typeof u!="boolean"&&(l=u),l?l.deviceId=a.getSettings().deviceId:l={deviceId:a.getSettings().deviceId};const d=lP(a,l);return d.kind===$.Kind.Video?d.source=$.Source.Camera:d.kind===$.Kind.Audio&&(d.source=$.Source.Microphone),d.mediaStream=s,d})})}function GW(t){return F(this,void 0,void 0,function*(){return(yield gP({audio:!1,video:t}))[0]})}function WW(t){return F(this,void 0,void 0,function*(){return(yield gP({audio:t,video:!1}))[0]})}class jW extends Sl{get description(){return"Can publish audio"}perform(){var e;return F(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield WW();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="audio"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," audio packets"))})}}class ZW extends Sl{get description(){return"Can publish video"}perform(){var e;return F(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield GW();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="video"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," video packets"))})}}class zW extends Sl{get description(){return"Resuming connection after interruption"}perform(){var e;return F(this,void 0,void 0,function*(){const n=yield this.connect();let r=!1,i=!1,o;const s=new Promise(c=>{setTimeout(c,5e3),o=c});n.on(ee.Reconnecting,()=>{r=!0}).on(ee.Reconnected,()=>{i=!0,o(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const a=n.engine.client.onClose;if(a&&a(""),yield s,r){if(!i||n.state!==Xe.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class HW extends Sl{get description(){return"Can connect via TURN"}perform(){var e,n;return F(this,void 0,void 0,function*(){const r=new cC,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let o=!1,s=!1,a=!1;for(let c of i.iceServers)for(let l of c.urls)l.startsWith("turn:")?(s=!0,a=!0):l.startsWith("turns:")&&(s=!0,a=!0,o=!0),l.startsWith("stun:")&&(a=!0);a?s&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||s?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(c=>setTimeout(c,0)))})}}class XW extends Sl{get description(){return"Establishing WebRTC connection"}perform(){return F(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(ee.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,o)=>{if(i.candidate){const s=new RTCIceCandidate(i);let a="".concat(s.protocol," ").concat(s.address,":").concat(s.port," ").concat(s.type);s.address&&($W(s.address)?a+=" (private)":s.protocol==="tcp"&&s.tcpType==="passive"?(e=!0,a+=" (passive)"):s.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,o)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),Ue.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function $W(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class KW extends Sl{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,n,r;return F(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new cC;const o=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(o.serverVersion,".")),((e=o.serverInfo)===null||e===void 0?void 0:e.edition)===nl.Cloud&&(!((n=o.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=o.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class j7 extends oo.EventEmitter{constructor(e,n){super(),this.checkResults=new Map,this.url=e,this.token=n}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:oi.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==oi.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return F(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token),i=s=>{this.updateCheck(n,s)};r.on("update",i);const o=yield r.run();return r.off("update",i),o})}checkWebsocket(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(KW)})}checkWebRTC(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(XW)})}checkTURN(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(HW)})}checkReconnect(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(zW)})}checkPublishAudio(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(jW)})}checkPublishVideo(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(ZW)})}}function JW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=t instanceof ol?t.mediaStreamTrack:t,i=r.getSettings();let o={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const s=i.facingMode;Ue.debug("rawFacingMode",{rawFacingMode:s}),s&&typeof s=="string"&&qW(s)&&(o={facingMode:s,confidence:"high"})}if(["low","medium"].includes(o.confidence)){Ue.debug("Try to get facing mode from device label: (".concat(r.label,")"));const s=QW(r.label);s!==void 0&&(o=s)}return o}const Cw=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),YW=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function QW(t){var e;const n=t.trim().toLowerCase();if(n!=="")return Cw.has(n)?Cw.get(n):(e=Array.from(YW.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||e===void 0?void 0:e[1]}function qW(t){return t===void 0||["user","environment","left","right"].includes(t)}const n0=Math.min,Uc=Math.max,jf=Math.round,zs=t=>({x:t,y:t}),e9={left:"right",right:"left",bottom:"top",top:"bottom"},t9={start:"end",end:"start"};function Iw(t,e,n){return Uc(t,n0(e,n))}function xp(t,e){return typeof t=="function"?t(e):t}function Va(t){return t.split("-")[0]}function Pp(t){return t.split("-")[1]}function mP(t){return t==="x"?"y":"x"}function vP(t){return t==="y"?"height":"width"}function Rp(t){return["top","bottom"].includes(Va(t))?"y":"x"}function yP(t){return mP(Rp(t))}function n9(t,e,n){n===void 0&&(n=!1);const r=Pp(t),i=yP(t),o=vP(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=Zf(s)),[s,Zf(s)]}function r9(t){const e=Zf(t);return[r0(t),e,r0(e)]}function r0(t){return t.replace(/start|end/g,e=>t9[e])}function i9(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function o9(t,e,n,r){const i=Pp(t);let o=i9(Va(t),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(r0)))),o}function Zf(t){return t.replace(/left|right|bottom|top/g,e=>e9[e])}function s9(t){return{top:0,right:0,bottom:0,left:0,...t}}function a9(t){return typeof t!="number"?s9(t):{top:t,right:t,bottom:t,left:t}}function zf(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function Sw(t,e,n){let{reference:r,floating:i}=t;const o=Rp(e),s=yP(e),a=vP(s),c=Va(e),l=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[a]/2-i[a]/2;let f;switch(c){case"top":f={x:u,y:r.y-i.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-i.width,y:d};break;default:f={x:r.x,y:r.y}}switch(Pp(e)){case"start":f[s]-=h*(n&&l?-1:1);break;case"end":f[s]+=h*(n&&l?-1:1);break}return f}const c9=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),c=await(s.isRTL==null?void 0:s.isRTL(e));let l=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=Sw(l,r,c),h=r,f={},p=0;for(let m=0;m<a.length;m++){const{name:C,fn:g}=a[m],{x:y,y:S,data:E,reset:A}=await g({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:f,rects:l,platform:s,elements:{reference:t,floating:e}});u=y??u,d=S??d,f={...f,[C]:{...f[C],...E}},A&&p<=50&&(p++,typeof A=="object"&&(A.placement&&(h=A.placement),A.rects&&(l=A.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):A.rects),{x:u,y:d}=Sw(l,h,c)),m=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:f}};async function CP(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=xp(e,t),p=a9(f),C=a[h?d==="floating"?"reference":"floating":d],g=zf(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(C)))==null||n?C:C.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),y=d==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),E=await(o.isElement==null?void 0:o.isElement(S))?await(o.getScale==null?void 0:o.getScale(S))||{x:1,y:1}:{x:1,y:1},A=zf(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:S,strategy:c}):y);return{top:(g.top-A.top+p.top)/E.y,bottom:(A.bottom-g.bottom+p.bottom)/E.y,left:(g.left-A.left+p.left)/E.x,right:(A.right-g.right+p.right)/E.x}}const l9=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...C}=xp(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const g=Va(i),y=Va(a)===a,S=await(c.isRTL==null?void 0:c.isRTL(l.floating)),E=h||(y||!m?[Zf(a)]:r9(a));!h&&p!=="none"&&E.push(...o9(a,m,p,S));const A=[a,...E],P=await CP(e,C),w=[];let T=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&w.push(P[g]),d){const B=n9(i,s,S);w.push(P[B[0]],P[B[1]])}if(T=[...T,{placement:i,overflows:w}],!w.every(B=>B<=0)){var _,M;const B=(((_=o.flip)==null?void 0:_.index)||0)+1,j=A[B];if(j)return{data:{index:B,overflows:T},reset:{placement:j}};let Z=(M=T.filter(z=>z.overflows[0]<=0).sort((z,q)=>z.overflows[1]-q.overflows[1])[0])==null?void 0:M.placement;if(!Z)switch(f){case"bestFit":{var D;const z=(D=T.map(q=>[q.placement,q.overflows.filter(oe=>oe>0).reduce((oe,W)=>oe+W,0)]).sort((q,oe)=>q[1]-oe[1])[0])==null?void 0:D[0];z&&(Z=z);break}case"initialPlacement":Z=a;break}if(i!==Z)return{reset:{placement:Z}}}return{}}}};async function u9(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=Va(n),a=Pp(n),c=Rp(n)==="y",l=["left","top"].includes(s)?-1:1,u=o&&c?-1:1,d=xp(e,t);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),c?{x:f*u,y:h*l}:{x:h*l,y:f*u}}const d9=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=e,c=await u9(e,t);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+c.x,y:o+c.y,data:{...c,placement:s}}}}},h9=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:C=>{let{x:g,y}=C;return{x:g,y}}},...c}=xp(t,e),l={x:n,y:r},u=await CP(e,c),d=Rp(Va(i)),h=mP(d);let f=l[h],p=l[d];if(o){const C=h==="y"?"top":"left",g=h==="y"?"bottom":"right",y=f+u[C],S=f-u[g];f=Iw(y,f,S)}if(s){const C=d==="y"?"top":"left",g=d==="y"?"bottom":"right",y=p+u[C],S=p-u[g];p=Iw(y,p,S)}const m=a.fn({...e,[h]:f,[d]:p});return{...m,data:{x:m.x-n,y:m.y-r}}}}};function bl(t){return IP(t)?(t.nodeName||"").toLowerCase():"#document"}function br(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function na(t){var e;return(e=(IP(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function IP(t){return t instanceof Node||t instanceof br(t).Node}function qi(t){return t instanceof Element||t instanceof br(t).Element}function eo(t){return t instanceof HTMLElement||t instanceof br(t).HTMLElement}function bw(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof br(t).ShadowRoot}function Sd(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Ii(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function f9(t){return["table","td","th"].includes(bl(t))}function hC(t){const e=fC(),n=Ii(t);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function p9(t){let e=Hs(t);for(;eo(e)&&!sl(e);){if(hC(e))return e;e=Hs(e)}return null}function fC(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function sl(t){return["html","body","#document"].includes(bl(t))}function Ii(t){return br(t).getComputedStyle(t)}function Np(t){return qi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Hs(t){if(bl(t)==="html")return t;const e=t.assignedSlot||t.parentNode||bw(t)&&t.host||na(t);return bw(e)?e.host:e}function SP(t){const e=Hs(t);return sl(e)?t.ownerDocument?t.ownerDocument.body:t.body:eo(e)&&Sd(e)?e:SP(e)}function i0(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=SP(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),s=br(i);return o?e.concat(s,s.visualViewport||[],Sd(i)?i:[],s.frameElement&&n?i0(s.frameElement):[]):e.concat(i,i0(i,[],n))}function bP(t){const e=Ii(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=eo(t),o=i?t.offsetWidth:n,s=i?t.offsetHeight:r,a=jf(n)!==o||jf(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function wP(t){return qi(t)?t:t.contextElement}function Vc(t){const e=wP(t);if(!eo(e))return zs(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=bP(e);let s=(o?jf(n.width):n.width)/r,a=(o?jf(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const g9=zs(0);function AP(t){const e=br(t);return!fC()||!e.visualViewport?g9:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function m9(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==br(t)?!1:e}function td(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=wP(t);let s=zs(1);e&&(r?qi(r)&&(s=Vc(r)):s=Vc(t));const a=m9(o,n,r)?AP(o):zs(0);let c=(i.left+a.x)/s.x,l=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const h=br(o),f=r&&qi(r)?br(r):r;let p=h,m=p.frameElement;for(;m&&r&&f!==p;){const C=Vc(m),g=m.getBoundingClientRect(),y=Ii(m),S=g.left+(m.clientLeft+parseFloat(y.paddingLeft))*C.x,E=g.top+(m.clientTop+parseFloat(y.paddingTop))*C.y;c*=C.x,l*=C.y,u*=C.x,d*=C.y,c+=S,l+=E,p=br(m),m=p.frameElement}}return zf({width:u,height:d,x:c,y:l})}const v9=[":popover-open",":modal"];function pC(t){return v9.some(e=>{try{return t.matches(e)}catch{return!1}})}function y9(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const o=i==="fixed",s=na(r),a=e?pC(e.floating):!1;if(r===s||a&&o)return n;let c={scrollLeft:0,scrollTop:0},l=zs(1);const u=zs(0),d=eo(r);if((d||!d&&!o)&&((bl(r)!=="body"||Sd(s))&&(c=Np(r)),eo(r))){const h=td(r);l=Vc(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function C9(t){return Array.from(t.getClientRects())}function kP(t){return td(na(t)).left+Np(t).scrollLeft}function I9(t){const e=na(t),n=Np(t),r=t.ownerDocument.body,i=Uc(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=Uc(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+kP(t);const a=-n.scrollTop;return Ii(r).direction==="rtl"&&(s+=Uc(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function S9(t,e){const n=br(t),r=na(t),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,c=0;if(i){o=i.width,s=i.height;const l=fC();(!l||l&&e==="fixed")&&(a=i.offsetLeft,c=i.offsetTop)}return{width:o,height:s,x:a,y:c}}function b9(t,e){const n=td(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=eo(t)?Vc(t):zs(1),s=t.clientWidth*o.x,a=t.clientHeight*o.y,c=i*o.x,l=r*o.y;return{width:s,height:a,x:c,y:l}}function ww(t,e,n){let r;if(e==="viewport")r=S9(t,n);else if(e==="document")r=I9(na(t));else if(qi(e))r=b9(e,n);else{const i=AP(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return zf(r)}function EP(t,e){const n=Hs(t);return n===e||!qi(n)||sl(n)?!1:Ii(n).position==="fixed"||EP(n,e)}function w9(t,e){const n=e.get(t);if(n)return n;let r=i0(t,[],!1).filter(a=>qi(a)&&bl(a)!=="body"),i=null;const o=Ii(t).position==="fixed";let s=o?Hs(t):t;for(;qi(s)&&!sl(s);){const a=Ii(s),c=hC(s);!c&&a.position==="fixed"&&(i=null),(o?!c&&!i:!c&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Sd(s)&&!c&&EP(t,s))?r=r.filter(u=>u!==s):i=a,s=Hs(s)}return e.set(t,r),r}function A9(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?pC(e)?[]:w9(e,this._c):[].concat(n),r],a=s[0],c=s.reduce((l,u)=>{const d=ww(e,u,i);return l.top=Uc(d.top,l.top),l.right=n0(d.right,l.right),l.bottom=n0(d.bottom,l.bottom),l.left=Uc(d.left,l.left),l},ww(e,a,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function k9(t){const{width:e,height:n}=bP(t);return{width:e,height:n}}function E9(t,e,n){const r=eo(e),i=na(e),o=n==="fixed",s=td(t,!0,o,e);let a={scrollLeft:0,scrollTop:0};const c=zs(0);if(r||!r&&!o)if((bl(e)!=="body"||Sd(i))&&(a=Np(e)),r){const d=td(e,!0,o,e);c.x=d.x+e.clientLeft,c.y=d.y+e.clientTop}else i&&(c.x=kP(i));const l=s.left+a.scrollLeft-c.x,u=s.top+a.scrollTop-c.y;return{x:l,y:u,width:s.width,height:s.height}}function Gg(t){return Ii(t).position==="static"}function Aw(t,e){return!eo(t)||Ii(t).position==="fixed"?null:e?e(t):t.offsetParent}function TP(t,e){const n=br(t);if(pC(t))return n;if(!eo(t)){let i=Hs(t);for(;i&&!sl(i);){if(qi(i)&&!Gg(i))return i;i=Hs(i)}return n}let r=Aw(t,e);for(;r&&f9(r)&&Gg(r);)r=Aw(r,e);return r&&sl(r)&&Gg(r)&&!hC(r)?n:r||p9(t)||n}const T9=async function(t){const e=this.getOffsetParent||TP,n=this.getDimensions,r=await n(t.floating);return{reference:E9(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function x9(t){return Ii(t).direction==="rtl"}const P9={convertOffsetParentRelativeRectToViewportRelativeRect:y9,getDocumentElement:na,getClippingRect:A9,getOffsetParent:TP,getElementRects:T9,getClientRects:C9,getDimensions:k9,getScale:Vc,isElement:qi,isRTL:x9},R9=d9,N9=h9,_9=l9,M9=(t,e,n)=>{const r=new Map,i={platform:P9,...n},o={...i.platform,_c:r};return c9(t,e,{...i,platform:o})};var xP={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(xR,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},s=null;function a(m,C){var g=m[C];if(typeof g.bind=="function")return g.bind(m);try{return Function.prototype.bind.call(g,m)}catch{return function(){return Function.prototype.apply.apply(g,[m,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?c:console[m]!==void 0?a(console,m):console.log!==void 0?a(console,"log"):e}function u(){for(var m=this.getLevel(),C=0;C<i.length;C++){var g=i[C];this[g]=C<m?e:this.methodFactory(g,m,this.name)}if(this.log=this.debug,typeof console===n&&m<this.levels.SILENT)return"No console available for logging"}function d(m){return function(){typeof console!==n&&(u.call(this),this[m].apply(this,arguments))}}function h(m,C,g){return l(m)||d.apply(this,arguments)}function f(m,C){var g=this,y,S,E,A="loglevel";typeof m=="string"?A+=":"+m:typeof m=="symbol"&&(A=void 0);function P(D){var B=(i[D]||"silent").toUpperCase();if(!(typeof window===n||!A)){try{window.localStorage[A]=B;return}catch{}try{window.document.cookie=encodeURIComponent(A)+"="+B+";"}catch{}}}function w(){var D;if(!(typeof window===n||!A)){try{D=window.localStorage[A]}catch{}if(typeof D===n)try{var B=window.document.cookie,j=encodeURIComponent(A),Z=B.indexOf(j+"=");Z!==-1&&(D=/^([^;]+)/.exec(B.slice(Z+j.length+1))[1])}catch{}return g.levels[D]===void 0&&(D=void 0),D}}function T(){if(!(typeof window===n||!A)){try{window.localStorage.removeItem(A)}catch{}try{window.document.cookie=encodeURIComponent(A)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function _(D){var B=D;if(typeof B=="string"&&g.levels[B.toUpperCase()]!==void 0&&(B=g.levels[B.toUpperCase()]),typeof B=="number"&&B>=0&&B<=g.levels.SILENT)return B;throw new TypeError("log.setLevel() called with invalid level: "+D)}g.name=m,g.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},g.methodFactory=C||h,g.getLevel=function(){return E??S??y},g.setLevel=function(D,B){return E=_(D),B!==!1&&P(E),u.call(g)},g.setDefaultLevel=function(D){S=_(D),w()||g.setLevel(D,!1)},g.resetLevel=function(){E=null,T(),u.call(g)},g.enableAll=function(D){g.setLevel(g.levels.TRACE,D)},g.disableAll=function(D){g.setLevel(g.levels.SILENT,D)},g.rebuild=function(){if(s!==g&&(y=_(s.getLevel())),u.call(g),s===g)for(var D in o)o[D].rebuild()},y=_(s?s.getLevel():"WARN");var M=w();M!=null&&(E=_(M)),u.call(g)}s=new f,s.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var g=o[C];return g||(g=o[C]=new f(C,s.methodFactory)),g};var p=typeof window!==n?window.log:void 0;return s.noConflict=function(){return typeof window!==n&&window.log===s&&(window.log=p),s},s.getLoggers=function(){return o},s.default=s,s})})(xP);var O9=xP.exports;const D9=od(O9);function zt(t){return typeof t=="function"}function PP(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Wg=PP(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function o0(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var _p=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=el(s),c=a.next();!c.done;c=a.next()){var l=c.value;l.remove(this)}}catch(m){e={error:m}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else s.remove(this);var u=this.initialTeardown;if(zt(u))try{u()}catch(m){o=m instanceof Wg?m.errors:[m]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var h=el(d),f=h.next();!f.done;f=h.next()){var p=f.value;try{kw(p)}catch(m){o=o??[],m instanceof Wg?o=Tv(Tv([],Ev(o)),Ev(m.errors)):o.push(m)}}}catch(m){r={error:m}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}if(o)throw new Wg(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)kw(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&o0(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&o0(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),RP=_p.EMPTY;function NP(t){return t instanceof _p||t&&"closed"in t&&zt(t.remove)&&zt(t.add)&&zt(t.unsubscribe)}function kw(t){zt(t)?t():t.unsubscribe()}var _P={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},MP={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,Tv([t,e],Ev(n)))},clearTimeout:function(t){var e=MP.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function OP(t){MP.setTimeout(function(){throw t})}function s0(){}function Vh(t){t()}var gC=function(t){yl(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,NP(n)&&n.add(r)):r.destination=U9,r}return e.create=function(n,r,i){return new a0(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(_p),L9=Function.prototype.bind;function jg(t,e){return L9.call(t,e)}var B9=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){eh(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){eh(r)}else eh(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){eh(n)}},t}(),a0=function(t){yl(e,t);function e(n,r,i){var o=t.call(this)||this,s;if(zt(n)||!n)s={next:n??void 0,error:r??void 0,complete:i??void 0};else{var a;o&&_P.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return o.unsubscribe()},s={next:n.next&&jg(n.next,a),error:n.error&&jg(n.error,a),complete:n.complete&&jg(n.complete,a)}):s=n}return o.destination=new B9(s),o}return e}(gC);function eh(t){OP(t)}function F9(t){throw t}var U9={closed:!0,next:s0,error:F9,complete:s0},mC=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function DP(t){return t}function V9(t){return t.length===0?DP:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var pn=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,o=W9(e)?e:new a0(e,n,r);return Vh(function(){var s=i,a=s.operator,c=s.source;o.add(a?a.call(o,c):c?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=Ew(n),new n(function(i,o){var s=new a0({next:function(a){try{e(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});r.subscribe(s)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[mC]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return V9(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=Ew(e),new e(function(r,i){var o;n.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},t.create=function(e){return new t(e)},t}();function Ew(t){var e;return(e=t??_P.Promise)!==null&&e!==void 0?e:Promise}function G9(t){return t&&zt(t.next)&&zt(t.error)&&zt(t.complete)}function W9(t){return t&&t instanceof gC||G9(t)&&NP(t)}function j9(t){return zt(t==null?void 0:t.lift)}function rs(t){return function(e){if(j9(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ga(t,e,n,r,i){return new Z9(t,e,n,r,i)}var Z9=function(t){yl(e,t);function e(n,r,i,o,s,a){var c=t.call(this,n)||this;return c.onFinalize=s,c.shouldUnsubscribe=a,c._next=r?function(l){try{r(l)}catch(u){n.error(u)}}:t.prototype._next,c._error=o?function(l){try{o(l)}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._error,c._complete=i?function(){try{i()}catch(l){n.error(l)}finally{this.unsubscribe()}}:t.prototype._complete,c}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(gC),z9=PP(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Xs=function(t){yl(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new Tw(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new z9},e.prototype.next=function(n){var r=this;Vh(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var s=el(r.currentObservers),a=s.next();!a.done;a=s.next()){var c=a.value;c.next(n)}}catch(l){i={error:l}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;Vh(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;Vh(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,o=i.hasError,s=i.isStopped,a=i.observers;return o||s?RP:(this.currentObservers=null,a.push(n),new _p(function(){r.currentObservers=null,o0(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,o=r.thrownError,s=r.isStopped;i?n.error(o):s&&n.complete()},e.prototype.asObservable=function(){var n=new pn;return n.source=this,n},e.create=function(n,r){return new Tw(n,r)},e}(pn),Tw=function(t){yl(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:RP},e}(Xs),LP=function(t){yl(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,o=n._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(Xs);function H9(t){return t&&zt(t.schedule)}function X9(t){return t[t.length-1]}function BP(t){return H9(X9(t))?t.pop():void 0}var FP=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function UP(t){return zt(t==null?void 0:t.then)}function VP(t){return zt(t[mC])}function GP(t){return Symbol.asyncIterator&&zt(t==null?void 0:t[Symbol.asyncIterator])}function WP(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function $9(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var jP=$9();function ZP(t){return zt(t==null?void 0:t[jP])}function zP(t){return $U(this,arguments,function(){var n,r,i,o;return ST(this,function(s){switch(s.label){case 0:n=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,_c(n.read())];case 3:return r=s.sent(),i=r.value,o=r.done,o?[4,_c(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,_c(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function HP(t){return zt(t==null?void 0:t.getReader)}function wl(t){if(t instanceof pn)return t;if(t!=null){if(VP(t))return K9(t);if(FP(t))return J9(t);if(UP(t))return Y9(t);if(GP(t))return XP(t);if(ZP(t))return Q9(t);if(HP(t))return q9(t)}throw WP(t)}function K9(t){return new pn(function(e){var n=t[mC]();if(zt(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function J9(t){return new pn(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function Y9(t){return new pn(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,OP)})}function Q9(t){return new pn(function(e){var n,r;try{for(var i=el(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function XP(t){return new pn(function(e){e6(t,e).catch(function(n){return e.error(n)})})}function q9(t){return XP(zP(t))}function e6(t,e){var n,r,i,o;return XU(this,void 0,void 0,function(){var s,a;return ST(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=KU(t),c.label=1;case 1:return[4,n.next()];case 2:if(r=c.sent(),!!r.done)return[3,4];if(s=r.value,e.next(s),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Ta(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function $P(t,e){return e===void 0&&(e=0),rs(function(n,r){n.subscribe(Ga(r,function(i){return Ta(r,t,function(){return r.next(i)},e)},function(){return Ta(r,t,function(){return r.complete()},e)},function(i){return Ta(r,t,function(){return r.error(i)},e)}))})}function KP(t,e){return e===void 0&&(e=0),rs(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function t6(t,e){return wl(t).pipe(KP(e),$P(e))}function n6(t,e){return wl(t).pipe(KP(e),$P(e))}function r6(t,e){return new pn(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function i6(t,e){return new pn(function(n){var r;return Ta(n,e,function(){r=t[jP](),Ta(n,e,function(){var i,o,s;try{i=r.next(),o=i.value,s=i.done}catch(a){n.error(a);return}s?n.complete():n.next(o)},0,!0)}),function(){return zt(r==null?void 0:r.return)&&r.return()}})}function JP(t,e){if(!t)throw new Error("Iterable cannot be null");return new pn(function(n){Ta(n,e,function(){var r=t[Symbol.asyncIterator]();Ta(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function o6(t,e){return JP(zP(t),e)}function s6(t,e){if(t!=null){if(VP(t))return t6(t,e);if(FP(t))return r6(t,e);if(UP(t))return n6(t,e);if(GP(t))return JP(t,e);if(ZP(t))return i6(t,e);if(HP(t))return o6(t,e)}throw WP(t)}function a6(t,e){return e?s6(t,e):wl(t)}function Zn(t,e){return rs(function(n,r){var i=0;n.subscribe(Ga(r,function(o){r.next(t.call(e,o,i++))}))})}function c6(t,e,n,r,i,o,s,a){var c=[],l=0,u=0,d=!1,h=function(){d&&!c.length&&!l&&e.complete()},f=function(m){return l<r?p(m):c.push(m)},p=function(m){l++;var C=!1;wl(n(m,u++)).subscribe(Ga(e,function(g){e.next(g)},function(){C=!0},void 0,function(){if(C)try{l--;for(var g=function(){var y=c.shift();s||p(y)};c.length&&l<r;)g();h()}catch(y){e.error(y)}}))};return t.subscribe(Ga(e,f,function(){d=!0,h()})),function(){}}function YP(t,e,n){return n===void 0&&(n=1/0),zt(e)?YP(function(r,i){return Zn(function(o,s){return e(r,o,i,s)})(wl(t(r,i)))},n):(typeof e=="number"&&(n=e),rs(function(r,i){return c6(r,i,t,n)}))}function l6(t){return YP(DP,t)}function u6(){return l6(1)}function c0(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return u6()(a6(t,BP(t)))}function QP(t,e){return rs(function(n,r){var i=0;n.subscribe(Ga(r,function(o){return t.call(e,o,i++)&&r.next(o)}))})}function d6(t,e,n,r,i){return function(o,s){var a=n,c=e,l=0;o.subscribe(Ga(s,function(u){var d=l++;c=a?t(c,u,d):(a=!0,u),s.next(c)},i))}}function h6(t){return rs(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function f6(t,e){return rs(d6(t,e,arguments.length>=2,!0))}function bi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=BP(t);return rs(function(r,i){(n?c0(t,r,n):c0(t,r)).subscribe(i)})}function xw(t){return rs(function(e,n){wl(t).subscribe(Ga(n,function(){return n.complete()},s0)),!n.closed&&e.subscribe(n)})}var p6=Object.defineProperty,g6=Object.defineProperties,m6=Object.getOwnPropertyDescriptors,Hf=Object.getOwnPropertySymbols,qP=Object.prototype.hasOwnProperty,eR=Object.prototype.propertyIsEnumerable,Pw=(t,e,n)=>e in t?p6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,l0=(t,e)=>{for(var n in e||(e={}))qP.call(e,n)&&Pw(t,n,e[n]);if(Hf)for(var n of Hf(e))eR.call(e,n)&&Pw(t,n,e[n]);return t},v6=(t,e)=>g6(t,m6(e)),y6=(t,e)=>{var n={};for(var r in t)qP.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Hf)for(var r of Hf(t))e.indexOf(r)<0&&eR.call(t,r)&&(n[r]=t[r]);return n},is=(t,e,n)=>new Promise((r,i)=>{var o=c=>{try{a(n.next(c))}catch(l){i(l)}},s=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,s);a((n=n.apply(t,e)).next())}),tR="lk";function vC(t){return typeof t>"u"?!1:C6(t)||I6(t)}function C6(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function I6(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function S6(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function nR(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(S6(t))return`${t.participant.identity}_${t.source}_placeholder`;if(vC(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function b6(t){return t instanceof t0}function w6(t,e){return is(this,null,function*(){const{x:n,y:r}=yield M9(t,e,{placement:"top",middleware:[R9(6),_9(),N9({padding:5})]});return{x:n,y:r}})}function A6(t,e){return!t.contains(e.target)}var k6=[ee.ConnectionStateChanged,ee.RoomMetadataChanged,ee.ActiveSpeakersChanged,ee.ConnectionQualityChanged,ee.ParticipantConnected,ee.ParticipantDisconnected,ee.ParticipantPermissionsChanged,ee.ParticipantMetadataChanged,ee.TrackMuted,ee.TrackUnmuted,ee.TrackPublished,ee.TrackUnpublished,ee.TrackStreamStateChanged,ee.TrackSubscriptionFailed,ee.TrackSubscriptionPermissionChanged,ee.TrackSubscriptionStatusChanged],E6=[...k6,ee.LocalTrackPublished,ee.LocalTrackUnpublished],T6=[ne.ConnectionQualityChanged,ne.IsSpeakingChanged,ne.ParticipantMetadataChanged,ne.ParticipantPermissionsChanged,ne.TrackMuted,ne.TrackUnmuted,ne.TrackPublished,ne.TrackUnpublished,ne.TrackStreamStateChanged,ne.TrackSubscriptionFailed,ne.TrackSubscriptionPermissionChanged,ne.TrackSubscriptionStatusChanged];[...T6,ne.LocalTrackPublished,ne.LocalTrackUnpublished];var Je=D9.getLogger("lk-components-js");Je.setDefaultLevel("WARN");function x6(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var P6=[],R6={showChat:!1,unreadMessages:0};function yC(t,...e){return new pn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(bi(t))}function CC(t,e){return new pn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function N6(t){return CC(t,ee.ConnectionStateChanged).pipe(Zn(([e])=>e),bi(t.state))}function _6(t,e,n=!0){var r;const i=()=>is(this,null,function*(){try{const a=yield Wf.getLocalDevices(t,n);o.next(a)}catch(a){e==null||e(a)}}),o=new Xs,s=o.pipe(h6(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return c0(Wf.getLocalDevices(t,n).catch(a=>e==null?void 0:e(a)),s)}function M6(t){return CC(t,ee.DataReceived)}function O6(t){return yC(t,ee.AudioPlaybackStatusChanged).pipe(Zn(n=>({canPlayAudio:n.canPlaybackAudio})))}function D6(t){return yC(t,ee.VideoPlaybackStatusChanged).pipe(Zn(n=>({canPlayVideo:n.canPlaybackVideo})))}function L6(t,e){return CC(t,ee.ActiveDeviceChanged).pipe(QP(([n])=>n===e),Zn(([n,r])=>(Je.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)),bi(t.getActiveDevice(e)))}function Zr(t){return`${tR}-${t}`}function B6(t){const e=u0(t),n=SC(t.participant).pipe(Zn(()=>u0(t)),bi(e));return{className:Zr(t.source===$.Source.Camera||t.source===$.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function u0(t){if(vC(t))return t.publication;{const{source:e,name:n,participant:r}=t;if(e&&n)return r.getTracks().find(i=>i.source===e&&i.trackName===n);if(n)return r.getTrackByName(n);if(e)return r.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function IC(t,...e){return new pn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(bi(t))}function SC(t){return IC(t,ne.TrackMuted,ne.TrackUnmuted,ne.ParticipantPermissionsChanged,ne.TrackPublished,ne.TrackUnpublished,ne.LocalTrackPublished,ne.LocalTrackUnpublished,ne.MediaDevicesError,ne.TrackSubscriptionStatusChanged).pipe(Zn(n=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:o}=n,s=n.getTrack($.Source.Microphone),a=n.getTrack($.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:o,cameraTrack:a,microphoneTrack:s,participant:n}}))}function F6(t){return IC(t,ne.ParticipantMetadataChanged).pipe(Zn(({name:n,identity:r,metadata:i})=>({name:n,identity:r,metadata:i})),bi({name:t.name,identity:t.identity,metadata:t.metadata}))}function U6(t){return bC(t,ne.ConnectionQualityChanged).pipe(Zn(([n])=>n),bi(t.connectionQuality))}function bC(t,e){return new pn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function rR(t){var e,n,r,i;return IC(t.participant,ne.TrackMuted,ne.TrackUnmuted,ne.TrackSubscribed,ne.TrackUnsubscribed,ne.LocalTrackPublished,ne.LocalTrackUnpublished).pipe(Zn(o=>{var s,a;const c=(s=t.publication)!=null?s:o.getTrack(t.source);return(a=c==null?void 0:c.isMuted)!=null?a:!0}),bi((i=(r=(e=t.publication)==null?void 0:e.isMuted)!=null?r:(n=t.participant.getTrack(t.source))==null?void 0:n.isMuted)!=null?i:!0))}function V6(t){return bC(t,ne.IsSpeakingChanged).pipe(Zn(([e])=>e))}function G6(t,e={}){var n;let r;const i=new pn(c=>(r=c,()=>a.unsubscribe())).pipe(bi(Array.from(t.participants.values()))),o=(n=e.additionalRoomEvents)!=null?n:E6,s=Array.from(new Set([ee.ParticipantConnected,ee.ParticipantDisconnected,ee.ConnectionStateChanged,...o])),a=yC(t,...s).subscribe(c=>r==null?void 0:r.next(Array.from(c.participants.values())));return t.participants.size>0&&(r==null||r.next(Array.from(t.participants.values()))),i}function W6(t){return bC(t,ne.ParticipantPermissionsChanged).pipe(Zn(()=>t.permissions),bi(t.permissions))}function j6(t,e,n){const{localParticipant:r}=e,i=(l,u)=>{let d=!1;switch(l){case $.Source.Camera:d=u.isCameraEnabled;break;case $.Source.Microphone:d=u.isMicrophoneEnabled;break;case $.Source.ScreenShare:d=u.isScreenShareEnabled;break}return d},o=SC(r).pipe(Zn(l=>i(t,l.participant)),bi(i(t,r))),s=new Xs,a=(l,u)=>is(this,null,function*(){try{switch(u??(u=n),s.next(!0),t){case $.Source.Camera:yield r.setCameraEnabled(l??!r.isCameraEnabled,u);break;case $.Source.Microphone:yield r.setMicrophoneEnabled(l??!r.isMicrophoneEnabled,u);break;case $.Source.ScreenShare:yield r.setScreenShareEnabled(l??!r.isScreenShareEnabled,u);break;default:break}}finally{s.next(!1)}});return{className:Zr("button"),toggle:a,enabledObserver:o,pendingObserver:s.asObservable()}}function Z6(){let t=!1;const e=new Xs,n=new Xs,r=o=>{n.next(!0),t=o??!t,e.next(t),n.next(!1)};return{className:Zr("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function z6(t,e,n){const r=new LP(void 0),i=e?L6(e,t):r.asObservable(),o=(a,...c)=>is(this,[a,...c],function*(l,u={}){var d,h,f;if(e){Je.debug(`Switching active device of kind "${t}" with id ${l}.`),yield e.switchActiveDevice(t,l,u.exact);const p=(d=e.getActiveDevice(t))!=null?d:l;p!==l&&l!=="default"&&Je.info(`We tried to select the device with id (${l}), but the browser decided to select the device with id (${p}) instead.`);let m;t==="audioinput"?m=(h=e.localParticipant.getTrack($.Source.Microphone))==null?void 0:h.track:t==="videoinput"&&(m=(f=e.localParticipant.getTrack($.Source.Camera))==null?void 0:f.track);const C=l==="default"&&!m||l==="default"&&(m==null?void 0:m.mediaStreamTrack.label.startsWith("Default"));r.next(C?l:p)}else if(n){yield n.setDeviceId(u.exact?{exact:l}:l);const p=yield n.getDeviceId();r.next(l==="default"&&n.mediaStreamTrack.label.startsWith("Default")?l:p)}else r.value!==l&&(Je.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(l))});return{className:Zr("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:o}}function H6(t){const e=r=>{t.disconnect(r)};return{className:Zr("disconnect-button"),disconnect:e}}function X6(t){const e=Zr("connection-quality"),n=U6(t);return{className:e,connectionQualityObserver:n}}function $6(t){let e="track-muted-indicator-camera";switch(t.source){case $.Source.Camera:e="track-muted-indicator-camera";break;case $.Source.Microphone:e="track-muted-indicator-microphone";break}const n=Zr(e),r=rR(t);return{className:n,mediaMutedObserver:r}}function K6(t){return{className:"lk-participant-name",infoObserver:F6(t)}}function J6(){return{className:Zr("participant-tile")}}var Y6={CHAT:"lk-chat-topic"};function iR(t,e,n){return is(this,arguments,function*(r,i,o,s={}){const{kind:a,destination:c}=s;yield r.publishData(i,a??Vt.RELIABLE,{destination:c,topic:o})})}function Q6(t,e,n){const r=M6(t).pipe(QP(([,,,a])=>e===void 0||a===e),Zn(([a,c,,l])=>({payload:a,topic:l,from:c})));let i;const o=new pn(a=>{i=a});return{messageObservable:r,isSendingObservable:o,send:(a,...c)=>is(this,[a,...c],function*(l,u={}){i.next(!0);try{yield iR(t.localParticipant,l,e,u)}finally{i.next(!1)}})}}var q6=new TextEncoder,ej=new TextDecoder,th=new Map,tj=t=>q6.encode(JSON.stringify({message:t.message,timestamp:t.timestamp})),nj=t=>JSON.parse(ej.decode(t));function rj(t,e){var n,r;const i=new Xs,{messageDecoder:o,messageEncoder:s,channelTopic:a}=e??{},c=a??Y6.CHAT;let l=!1;th.has(t)||(l=!0);const u=(n=th.get(t))!=null?n:new Map,d=(r=u.get(c))!=null?r:new Xs;if(u.set(c,d),th.set(t,u),l){const{messageObservable:y}=Q6(t,c);y.pipe(xw(i)).subscribe(d)}const h=o??nj,f=d.pipe(Zn(y=>{const S=h(y.payload);return v6(l0({},S),{from:y.from})}),f6((y,S)=>[...y,S],[]),xw(i)),p=new LP(!1),m=s??tj,C=y=>is(this,null,function*(){const S=Date.now(),E=m({message:y,timestamp:S});p.next(!0);try{yield iR(t.localParticipant,E,c,{kind:Vt.RELIABLE}),d.next({payload:E,topic:c,from:t.localParticipant})}finally{p.next(!1)}});function g(){i.next(),i.complete(),th.clear()}return t.once(ee.Disconnected,g),{messageObservable:f,isSendingObservable:p,send:C}}function ij(){const t=n=>is(this,null,function*(){Je.info("Start Audio for room: ",n),yield n.startAudio()});return{className:Zr("start-audio-button"),roomAudioPlaybackAllowedObservable:O6,handleStartAudioPlayback:t}}function oj(){const t=n=>is(this,null,function*(){Je.info("Start Video for room: ",n),yield n.startVideo()});return{className:Zr("start-audio-button"),roomVideoPlaybackAllowedObservable:D6,handleStartVideoPlayback:t}}function sj(){return{className:[Zr("button"),Zr("chat-toggle")].join(" ")}}function aj(){return{className:"lk-room-container"}}function cj(t,e){if(typeof localStorage>"u"){Je.error("Local storage is not available.");return}try{localStorage.setItem(t,JSON.stringify(e))}catch(n){Je.error(`Error setting item to local storage: ${n}`)}}function lj(t){if(typeof localStorage>"u"){Je.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){Je.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){Je.error(`Error getting item from local storage: ${e}`);return}}function uj(t){return{load:()=>lj(t),save:e=>cj(t,e)}}var dj=`${tR}-user-choices`,ia={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:hj,save:fj}=uj(dj);function pj(t,e=!1){if(e===!0)return;const n=t,r=y6(n,["e2ee","sharedPassphrase"]);fj(r)}function gj(t,e=!1){var n,r,i,o,s,a,c;const l={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:ia.videoEnabled,audioEnabled:(r=t==null?void 0:t.audioEnabled)!=null?r:ia.audioEnabled,videoDeviceId:(i=t==null?void 0:t.videoDeviceId)!=null?i:ia.videoDeviceId,audioDeviceId:(o=t==null?void 0:t.audioDeviceId)!=null?o:ia.audioDeviceId,username:(s=t==null?void 0:t.username)!=null?s:ia.username,e2ee:(a=t==null?void 0:t.e2ee)!=null?a:ia.e2ee,sharedPassphrase:(c=t==null?void 0:t.sharedPassphrase)!=null?c:ia.sharedPassphrase};if(e)return l;{const u=hj();return l0(l0({},l),u??{})}}function oR(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=oR(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function mj(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=oR(t))&&(r&&(r+=" "),r+=e);return r}var vj=Object.defineProperty,yj=Object.defineProperties,Cj=Object.getOwnPropertyDescriptors,Xf=Object.getOwnPropertySymbols,sR=Object.prototype.hasOwnProperty,aR=Object.prototype.propertyIsEnumerable,Rw=(t,e,n)=>e in t?vj(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,we=(t,e)=>{for(var n in e||(e={}))sR.call(e,n)&&Rw(t,n,e[n]);if(Xf)for(var n of Xf(e))aR.call(e,n)&&Rw(t,n,e[n]);return t},An=(t,e)=>yj(t,Cj(e)),gn=(t,e)=>{var n={};for(var r in t)sR.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Xf)for(var r of Xf(t))e.indexOf(r)<0&&aR.call(t,r)&&(n[r]=t[r]);return n},cR=(t,e,n)=>new Promise((r,i)=>{var o=c=>{try{a(n.next(c))}catch(l){i(l)}},s=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,s);a((n=n.apply(t,e)).next())});function Ar(t,e){const[n,r]=b.useState(e);return b.useEffect(()=>{if(typeof window>"u"||!t)return;const i=t.subscribe(r);return()=>i.unsubscribe()},[t]),n}function Ij(t){const e=o=>typeof window<"u"?window.matchMedia(o).matches:!1,[n,r]=b.useState(e(t));function i(){r(e(t))}return b.useEffect(()=>{const o=window.matchMedia(t);return i(),o.addListener?o.addListener(i):o.addEventListener("change",i),()=>{o.removeListener?o.removeListener(i):o.removeEventListener("change",i)}},[t]),n}function Sj(t,e){if(e.msg==="show_chat")return An(we({},t),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return An(we({},t),{showChat:!1});if(e.msg==="toggle_chat"){const n=An(we({},t),{showChat:!t.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?An(we({},t),{unreadMessages:e.count}):we({},t)}function bj(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:we({},t)}var wC=b.createContext(void 0);function wj(){const t=b.useContext(wC);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function Aj(t){const[e,n]=b.useReducer(bj,P6),[r,i]=b.useReducer(Sj,R6);return t??{pin:{dispatch:n,state:e},widget:{dispatch:i,state:r}}}function lR(){return b.useContext(wC)}var kj=b.createContext(void 0);function bd(){return b.useContext(kj)}var AC=b.createContext(void 0);function Mp(){return b.useContext(AC)}function Ka(t){var e;const n=Mp(),r=bd(),i=(e=t??n)!=null?e:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var kC=b.createContext(void 0);function Op(){const t=b.useContext(kC);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function Dp(){return b.useContext(kC)}function wd(t){const e=Dp(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var Ej=b.createContext(void 0);function Tj(...t){return(...e)=>{for(const n of t)typeof n=="function"&&n(...e)}}function ra(...t){const e=we({},t[0]);for(let n=1;n<t.length;n++){const r=t[n];for(const i in r){const o=e[i],s=r[i];typeof o=="function"&&typeof s=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=Tj(o,s):(i==="className"||i==="UNSAFE_className")&&typeof o=="string"&&typeof s=="string"?e[i]=mj(o,s):e[i]=s!==void 0?s:o}}return e}function xj(t={}){const e=Ka(t.participant),{className:n,connectionQualityObserver:r}=b.useMemo(()=>X6(e),[e]),i=Ar(r,Br.Unknown);return{className:n,quality:i}}function Pj(t){const e=wd(t),n=b.useMemo(()=>N6(e),[e]);return Ar(n,e.state)}function Rj(t){const e=Op(),n=Pj(e);return{buttonProps:b.useMemo(()=>{const{className:i,disconnect:o}=H6(e);return ra(t,{className:i,onClick:()=>{var a;return o((a=t.stopTracks)!=null?a:!0)},disabled:n===Xe.Disconnected})},[e,t,n])}}function Nj(t){if(t.publication instanceof qu){const e=t.publication.track;if(e){const{facingMode:n}=JW(e);return n}}return"undefined"}function Nw(t,e={}){var n,r;const i=typeof t=="string"?e.participant:t.participant,o=Ka(i),s=typeof t=="string"?{participant:o,source:t}:t,[a,c]=b.useState(!!((n=s.publication)!=null&&n.isMuted||(r=o.getTrack(s.source))!=null&&r.isMuted));return b.useEffect(()=>{const l=rR(s).subscribe(c);return()=>l.unsubscribe()},[nR(s)]),a}function _j(t){const e=Ka(t),n=b.useMemo(()=>V6(e),[e]);return Ar(n,e.isSpeaking)}var Mj={connect:!0,audio:!1,video:!1};function Oj(t){const e=we(we({},Mj),t),{token:n,serverUrl:r,options:i,room:o,connectOptions:s,connect:a,audio:c,video:l,screen:u,onConnected:d,onDisconnected:h,onError:f,onMediaDeviceFailure:p,onEncryptionError:m,simulateParticipants:C}=e,g=gn(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&o&&Je.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[y,S]=b.useState();b.useEffect(()=>{S(o??new Wf(i))},[o]);const E=b.useMemo(()=>{const{className:A}=aj();return ra(g,{className:A})},[g]);return b.useEffect(()=>{if(!y)return;const A=()=>{const T=y.localParticipant;Je.debug("trying to publish local tracks"),Promise.all([T.setMicrophoneEnabled(!!c,typeof c!="boolean"?c:void 0),T.setCameraEnabled(!!l,typeof l!="boolean"?l:void 0),T.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(_=>{Je.warn(_),f==null||f(_)})},P=T=>{const _=Yu.getFailure(T);p==null||p(_)},w=T=>{m==null||m(T)};return y.on(ee.SignalConnected,A).on(ee.MediaDevicesError,P).on(ee.EncryptionError,w),()=>{y.off(ee.SignalConnected,A).off(ee.MediaDevicesError,P).off(ee.EncryptionError,w)}},[y,c,l,u,f,m,p]),b.useEffect(()=>{if(y){if(C){y.simulateParticipants({participants:{count:C},publish:{audio:!0,useRealTracks:!0}});return}if(!n){Je.debug("no token yet");return}if(!r){Je.warn("no livekit url provided"),f==null||f(Error("no livekit url provided"));return}a?(Je.debug("connecting"),y.connect(r,n,s).catch(A=>{Je.warn(A),f==null||f(A)})):(Je.debug("disconnecting because connect is false"),y.disconnect())}},[a,n,JSON.stringify(s),y,f,r,C]),b.useEffect(()=>{if(!y)return;const A=P=>{switch(P){case Xe.Disconnected:h&&h();break;case Xe.Connected:d&&d();break}};return y.on(ee.ConnectionStateChanged,A),()=>{y.off(ee.ConnectionStateChanged,A)}},[n,d,h,y]),b.useEffect(()=>{if(y)return()=>{Je.info("disconnecting on onmount"),y.disconnect()}},[y]),{room:y,htmlProps:E}}function Dj(t={}){const e=wd(t.room),[n,r]=b.useState(e.localParticipant),[i,o]=b.useState(n.isMicrophoneEnabled),[s,a]=b.useState(n.isMicrophoneEnabled),[c,l]=b.useState(n.lastMicrophoneError),[u,d]=b.useState(n.lastCameraError),[h,f]=b.useState(n.isMicrophoneEnabled),[p,m]=b.useState(void 0),[C,g]=b.useState(void 0),y=S=>{a(S.isCameraEnabled),o(S.isMicrophoneEnabled),f(S.isScreenShareEnabled),g(S.cameraTrack),m(S.microphoneTrack),l(S.participant.lastMicrophoneError),d(S.participant.lastCameraError),r(S.participant)};return b.useEffect(()=>{const S=SC(n).subscribe(y);return()=>S.unsubscribe()},[n]),{isMicrophoneEnabled:i,isScreenShareEnabled:h,isCameraEnabled:s,microphoneTrack:p,cameraTrack:C,lastMicrophoneError:c,lastCameraError:u,localParticipant:n}}function Lj(){const t=Op(),e=b.useMemo(()=>W6(t.localParticipant),[t]);return Ar(e,t.localParticipant.permissions)}function Bj({kind:t,room:e,track:n,requestPermissions:r,onError:i}){const o=Dp(),s=b.useMemo(()=>_6(t,i,r),[t,r,i]),a=Ar(s,[]),[c,l]=b.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:h}=b.useMemo(()=>z6(t,e??o,n),[t,e,o,n]);return b.useEffect(()=>{const f=d.subscribe(p=>{Je.info("setCurrentDeviceId",p),p&&l(p)});return()=>{f==null||f.unsubscribe()}},[d]),{devices:a,className:u,activeDeviceId:c,setActiveMediaDevice:h}}function Fj(t){return t!==void 0}function Al(...t){return ra(...t.filter(Fj))}function uR(t,e,n){return b.Children.map(t,r=>b.isValidElement(r)&&b.Children.only(t)?b.cloneElement(r,An(we({},e),{key:n})):r)}function dR(t,e={}){var n;const[r,i]=b.useState(u0(t)),[o,s]=b.useState(r==null?void 0:r.isMuted),[a,c]=b.useState(r==null?void 0:r.isSubscribed),[l,u]=b.useState(r==null?void 0:r.track),[d,h]=b.useState("landscape"),f=b.useRef(),{className:p,trackObserver:m}=b.useMemo(()=>B6(t),[(n=t.participant.sid)!=null?n:t.participant.identity,t.source,vC(t)&&t.publication.trackSid]);return b.useEffect(()=>{const C=m.subscribe(g=>{Je.debug("update track",g),i(g),s(g==null?void 0:g.isMuted),c(g==null?void 0:g.isSubscribed),u(g==null?void 0:g.track)});return()=>C==null?void 0:C.unsubscribe()},[m]),b.useEffect(()=>{var C,g;return l&&(f.current&&l.detach(f.current),(C=e.element)!=null&&C.current&&!(b6(t.participant)&&(l==null?void 0:l.kind)==="audio")&&l.attach(e.element.current)),f.current=(g=e.element)==null?void 0:g.current,()=>{f.current&&(l==null||l.detach(f.current))}},[l,e.element]),b.useEffect(()=>{var C,g;if(typeof((C=r==null?void 0:r.dimensions)==null?void 0:C.width)=="number"&&typeof((g=r==null?void 0:r.dimensions)==null?void 0:g.height)=="number"){const y=r.dimensions.width>r.dimensions.height?"landscape":"portrait";h(y)}},[r]),{publication:r,isMuted:o,isSubscribed:a,track:l,elementProps:Al(e.props,we({className:p,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":d}))}}function Uj({trackRef:t,participant:e,source:n,publication:r,onParticipantClick:i,disableSpeakingIndicator:o,htmlProps:s}){const a=bd(),c=Ka(e),l=b.useMemo(()=>{var m,C,g,y,S,E;const A=(C=(m=t==null?void 0:t.source)!=null?m:a==null?void 0:a.source)!=null?C:n;if(A===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(y=(g=t==null?void 0:t.participant)!=null?g:a==null?void 0:a.participant)!=null?y:c,publication:(E=(S=t==null?void 0:t.publication)!=null?S:a==null?void 0:a.publication)!=null?E:r,source:A}},[t==null?void 0:t.participant,t==null?void 0:t.source,t==null?void 0:t.publication,a==null?void 0:a.participant,a==null?void 0:a.source,a==null?void 0:a.publication,c,n,r]),u=b.useMemo(()=>{const{className:m}=J6();return ra(s,{className:m,onClick:C=>{var g,y;if((g=s.onClick)==null||g.call(s,C),typeof i=="function"){const S=(y=l.publication)!=null?y:l.participant.getTrack(l.source);i({participant:l.participant,track:S})}}})},[s,i,l.publication,l.source,l.participant]),d=Nw($.Source.Camera,{participant:l.participant}),h=Nw($.Source.Microphone,{participant:l.participant}),f=_j(l.participant),p=Nj(l);return{elementProps:we({"data-lk-audio-muted":h,"data-lk-video-muted":d,"data-lk-speaking":o===!0?!1:f,"data-lk-local-participant":l.participant.isLocal,"data-lk-source":l.source,"data-lk-facing-mode":p},u)}}function Vj(t={}){const e=wd(t.room),[n,r]=b.useState([]);return b.useEffect(()=>{const i=G6(e,{additionalRoomEvents:t.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[e,JSON.stringify(t.updateOnlyOn)]),n}function Gj(t={}){const e=Vj(t),{localParticipant:n}=Dj(t);return[n,...e]}function Wj({room:t,props:e}){const n=wd(t),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:o}=b.useMemo(()=>ij(),[]),s=b.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=Ar(s,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:b.useMemo(()=>ra(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayAudio:a}}function jj({room:t,props:e}){const n=wd(t),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:o}=b.useMemo(()=>oj(),[]),s=b.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=Ar(s,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:b.useMemo(()=>ra(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayVideo:a}}function Zj({props:t}){const{dispatch:e,state:n}=wj().widget,{className:r}=b.useMemo(()=>sj(),[]);return{mergedProps:b.useMemo(()=>ra(t,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,r,e,n])}}function zj(t,e={}){var n,r,i,o;let s=bd();const a=(r=(n=Mp())!=null?n:e.participant)!=null?r:s==null?void 0:s.participant;if(typeof t=="string"){if(!a)throw Error("Participant missing, either provide it via context or pass it in directly");s={participant:a,source:t}}else if(t)s=t;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:c,mediaMutedObserver:l}=b.useMemo(()=>$6(s),[nR(s)]);return{isMuted:Ar(l,!!((i=s.publication)!=null&&i.isMuted||(o=s.participant.getTrack(s.source))!=null&&o.isMuted)),className:c}}function Hj(t){var e=t,{source:n,onChange:r,initialState:i,captureOptions:o}=e,s=gn(e,["source","onChange","initialState","captureOptions"]),a;const c=Dp(),l=(a=c==null?void 0:c.localParticipant)==null?void 0:a.getTrack(n),{toggle:u,className:d,pendingObserver:h,enabledObserver:f}=b.useMemo(()=>c?j6(n,c,o):Z6(),[c,n,JSON.stringify(o)]),p=Ar(h,!1),m=Ar(f,i??!!(l!=null&&l.isEnabled));b.useEffect(()=>{r==null||r(m)},[m,r]),b.useEffect(()=>{i!==void 0&&(Je.debug("forcing initial toggle state",n,i),u(i))},[]);const C=b.useMemo(()=>ra(s,{className:d}),[s,d]),g=b.useCallback(y=>{var S;u(),(S=s.onClick)==null||S.call(s,y)},[s,u]);return{toggle:u,enabled:m,pending:p,track:l,buttonProps:An(we({},C),{"aria-pressed":m,"data-lk-source":n,"data-lk-enabled":m,disabled:p,onClick:g})}}function Xj(t,e={}){return dR(t,e)}function $j(t){const e=Op(),[n,r]=b.useState(),i=Ar(n==null?void 0:n.isSendingObservable,!1),o=Ar(n==null?void 0:n.messageObservable,[]);return b.useEffect(()=>{const s=rj(e,t);r(s)},[e,t]),{send:n==null?void 0:n.send,chatMessages:o,isSending:i}}function Kj(t={}){var e;const[n,r]=b.useState(gj(t.defaults,(e=t.preventLoad)!=null?e:!1)),i=b.useCallback(l=>{r(u=>An(we({},u),{audioEnabled:l}))},[]),o=b.useCallback(l=>{r(u=>An(we({},u),{videoEnabled:l}))},[]),s=b.useCallback(l=>{r(u=>An(we({},u),{audioDeviceId:l}))},[]),a=b.useCallback(l=>{r(u=>An(we({},u),{videoDeviceId:l}))},[]),c=b.useCallback(l=>{r(u=>An(we({},u),{username:l}))},[]);return b.useEffect(()=>{var l;pj(n,(l=t.preventSave)!=null?l:!1)},[n,t.preventSave]),{userChoices:n,saveAudioInputEnabled:i,saveVideoInputEnabled:o,saveAudioInputDeviceId:s,saveVideoInputDeviceId:a,saveUsername:c}}function Jj(t){const{mergedProps:e}=Zj({props:t});return b.createElement("button",we({},e),t.children)}function Yj(t){const{buttonProps:e}=Rj(t);return b.createElement("button",we({},e),t.children)}var Qj=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),b.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),qj=Qj,eZ=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),tZ=eZ,nZ=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),rZ=nZ,iZ=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),oZ=iZ,sZ=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),b.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),aZ=sZ,cZ=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),b.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),lZ=cZ,uZ=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),dZ=uZ,hZ=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),fZ=hZ,pZ=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),gZ=pZ,mZ=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),vZ=mZ,yZ=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),CZ=yZ,IZ=t=>b.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),b.createElement("g",{fill:"currentColor"},b.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),b.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),SZ=IZ;function Zg(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:o,onDeviceSelectError:s,exactMatch:a,track:c,requestPermissions:l,onError:u}=e,d=gn(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const h=Dp(),f=b.useCallback(A=>{h&&h.emit(ee.MediaDevicesError,A),u==null||u(A)},[h,u]),{devices:p,activeDeviceId:m,setActiveMediaDevice:C,className:g}=Bj({kind:n,room:h,track:c,requestPermissions:l,onError:f});b.useEffect(()=>{r!==void 0&&C(r)},[C]),b.useEffect(()=>{typeof o=="function"&&o(p)},[o,p]),b.useEffect(()=>{m&&m!==""&&(i==null||i(m))},[m]);const y=A=>cR(this,null,function*(){try{yield C(A,{exact:a})}catch(P){if(P instanceof Error)s==null||s(P);else throw P}}),S=b.useMemo(()=>Al(d,{className:g},{className:"lk-list"}),[g,d]);function E(A,P,w){return A===P||w===0&&P==="default"}return b.createElement("ul",we({},S),p.map((A,P)=>b.createElement("li",{key:A.deviceId,id:A.deviceId,"data-lk-active":E(A.deviceId,m,P),"aria-selected":E(A.deviceId,m,P),role:"option"},b.createElement("button",{className:"lk-button",onClick:()=>y(A.deviceId)},A.label))))}function hR(t,e){switch(t){case $.Source.Microphone:return e?b.createElement(lZ,null):b.createElement(aZ,null);case $.Source.Camera:return e?b.createElement(tZ,null):b.createElement(qj,null);case $.Source.ScreenShare:return e?b.createElement(SZ,null):b.createElement(CZ,null);default:return}}function bZ(t){switch(t){case Br.Excellent:return b.createElement(dZ,null);case Br.Good:return b.createElement(fZ,null);case Br.Poor:return b.createElement(gZ,null);default:return b.createElement(vZ,null)}}function zg(t){var e=t,{showIcon:n}=e,r=gn(e,["showIcon"]);const{buttonProps:i,enabled:o}=Hj(r);return b.createElement("button",we({},i),(n??!0)&&hR(r.source,o),r.children)}function wZ(t){var e;const{className:n,quality:r}=xj(t),i=b.useMemo(()=>An(we({},Al(t,{className:n})),{"data-lk-quality":r}),[r,t,n]);return b.createElement("div",we({},i),(e=t.children)!=null?e:bZ(r))}function AZ(t){var e=t,{participant:n}=e,r=gn(e,["participant"]);const i=Ka(n),{className:o,infoObserver:s}=b.useMemo(()=>K6(i),[i]),{identity:a,name:c}=Ar(s,{name:i.name,identity:i.identity,metadata:i.metadata}),l=b.useMemo(()=>Al(r,{className:o,"data-lk-participant-name":c}),[r,o,c]);return b.createElement("span",we({},l),c!==""?c:a,r.children)}function kZ(t){var e=t,{source:n,participant:r,trackRef:i,show:o="always"}=e,s=gn(e,["source","participant","trackRef","show"]),a,c;const{className:l,isMuted:u}=zj(i??n,{participant:r}),d=o==="always"||o==="muted"&&u||o==="unmuted"&&!u,h=b.useMemo(()=>Al(s,{className:l}),[l,s]);return d?b.createElement("div",An(we({},h),{"data-lk-muted":u}),(c=s.children)!=null?c:hR((a=i==null?void 0:i.source)!=null?a:n,!u)):null}function EZ(t){var e=t,{trackRef:n,onSubscriptionStatusChanged:r,volume:i,source:o,name:s,publication:a,participant:c}=e,l=gn(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),u,d,h,f,p,m,C,g,y,S;const E=bd(),A=(f=(h=(u=n==null?void 0:n.publication)==null?void 0:u.trackName)!=null?h:(d=E==null?void 0:E.publication)==null?void 0:d.trackName)!=null?f:s,P=(m=(p=n==null?void 0:n.source)!=null?p:E==null?void 0:E.source)!=null?m:o,w=(g=(C=n==null?void 0:n.publication)!=null?C:E==null?void 0:E.publication)!=null?g:a,T=(S=(y=n==null?void 0:n.participant)!=null?y:E==null?void 0:E.participant)!=null?S:c;if(P===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const _=b.useRef(null),M=Ka(T),{elementProps:D,isSubscribed:B,track:j,publication:Z}=dR({source:P,name:A,participant:M,publication:w},{element:_,props:l});return b.useEffect(()=>{r==null||r(!!B)},[B,r]),b.useEffect(()=>{j===void 0||i===void 0||(j instanceof Ea?j.setVolume(i):Je.warn("Volume can only be set on remote audio tracks."))},[i,j]),b.useEffect(()=>{Z===void 0||l.muted===void 0||(Z instanceof dC?Z.setEnabled(!l.muted):Je.warn("Can only call setEnabled on remote track publications."))},[l.muted,Z,j]),b.createElement("audio",we({ref:_},D))}function TZ(t){const e=!!Mp();return t.participant&&!e?b.createElement(AC.Provider,{value:t.participant},t.children):b.createElement(b.Fragment,null,t.children)}function xZ({value:t,onPinChange:e,onWidgetChange:n,children:r}){const i=Aj(t);return b.useEffect(()=>{Je.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),b.useEffect(()=>{Je.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),b.createElement(wC.Provider,{value:i},r)}function PZ(t){const{room:e,htmlProps:n}=Oj(t);return b.createElement("div",we({},n),e&&b.createElement(kC.Provider,{value:e},b.createElement(Ej.Provider,{value:t.featureFlags},t.children)))}function RZ(t){var e=t,{participant:n,trackRef:r}=e,i=gn(e,["participant","trackRef"]),o,s;const[a,c]=b.useState([]),l=200,u=90,d=6,h=4,f=50,p=7,m=(o=Mp())!=null?o:n;let C=(s=bd())!=null?s:r;if(!C){if(!m)throw Error("Participant missing, provide it directly or within a context");C={participant:m,source:$.Source.Microphone}}const{track:g}=Xj(C);return b.useEffect(()=>{if(!g||!(g instanceof Kn||g instanceof Ea))return;const{analyser:y,cleanup:S}=rW(g,{smoothingTimeConstant:.8,fftSize:64}),E=new Uint8Array(y.frequencyBinCount),A=()=>{y.getByteFrequencyData(E);const w=new Array(p).fill(0);E.slice(1);const T=6;for(let _=0;_<p/2;_+=1){const M=Math.floor(p/2-_);for(let D=0;D<T;D+=1)w[M]+=Math.pow(E[_*T+D]/255,2);w[M]/=T}for(let _=0;_<p/2;_+=1){const M=Math.floor(p/2+_);if(w[M]===0){for(let D=0;D<T;D+=1)w[M]+=Math.pow(E[_*T+D]/255,2);w[M]/=T}}return w.map(_=>_*f)},P=setInterval(()=>{const w=A();c(w)},100);return()=>{clearInterval(P),S()}},[g]),b.createElement("svg",An(we({width:"100%",height:"100%",viewBox:`0 0 ${l} ${u}`},i),{className:"lk-audio-visualizer"}),b.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),b.createElement("g",{style:{transform:`translate(${(l-p*(d+h))/2}px, 0)`}},a.map((y,S)=>b.createElement("rect",{key:S,x:S*(d+h),y:u/2-y/2,width:d,height:y}))))}function NZ(t){var e=t,{participants:n}=e,r=gn(e,["participants"]);return b.createElement(b.Fragment,null,n.map(i=>b.createElement(AC.Provider,{value:i,key:i.identity},uR(r.children))))}function _Z(t){var e=t,{participant:n,children:r,source:i,publication:o,disableSpeakingIndicator:s,onParticipantClick:a}=e,c=gn(e,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const l=Ka(n),{elementProps:u}=Uj({participant:l,htmlProps:c,disableSpeakingIndicator:s,source:$.Source.Microphone,publication:o,onParticipantClick:a});return b.createElement("div",we({style:{position:"relative"}},u),b.createElement(TZ,{participant:l},r??b.createElement(b.Fragment,null,b.createElement(EZ,{source:i??$.Source.Microphone}),b.createElement(RZ,null),b.createElement("div",{className:"lk-participant-metadata"},b.createElement("div",{className:"lk-participant-metadata-item"},b.createElement(kZ,{source:$.Source.Microphone}),b.createElement(AZ,null)),b.createElement(wZ,{className:"lk-participant-metadata-item"})))))}function MZ(t){var e=t,{entry:n,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:o}=e,s=gn(e,["entry","hideName","hideTimestamp","messageFormatter"]),a,c,l,u;const d=b.useMemo(()=>o?o(n.message):n.message,[n.message,o]),h=new Date(n.timestamp),f=navigator?navigator.language:"en-US";return b.createElement("li",we({className:"lk-chat-entry",title:h.toLocaleTimeString(f,{timeStyle:"full"}),"data-lk-message-origin":(a=n.from)!=null&&a.isLocal?"local":"remote"},s),(!i||!r)&&b.createElement("span",{className:"lk-meta-data"},!r&&b.createElement("strong",{className:"lk-participant-name"},(u=(c=n.from)==null?void 0:c.name)!=null?u:(l=n.from)==null?void 0:l.identity),!i&&b.createElement("span",{className:"lk-timestamp"},h.toLocaleTimeString(f,{timeStyle:"short"}))),b.createElement("span",{className:"lk-message-body"},d))}function OZ(t){var e=t,{messageFormatter:n,messageDecoder:r,messageEncoder:i,channelTopic:o}=e,s=gn(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const a=b.useRef(null),c=b.useRef(null),l=b.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:o}),[r,i,o]),{send:u,chatMessages:d,isSending:h}=$j(l),f=lR(),p=b.useRef(0);function m(C){return cR(this,null,function*(){C.preventDefault(),a.current&&a.current.value.trim()!==""&&u&&(yield u(a.current.value),a.current.value="",a.current.focus())})}return b.useEffect(()=>{var C;c&&((C=c.current)==null||C.scrollTo({top:c.current.scrollHeight}))},[c,d]),b.useEffect(()=>{var C,g,y,S,E;if(!f||d.length===0)return;if((C=f.widget.state)!=null&&C.showChat&&d.length>0&&p.current!==((g=d[d.length-1])==null?void 0:g.timestamp)){p.current=(y=d[d.length-1])==null?void 0:y.timestamp;return}const A=d.filter(w=>!p.current||w.timestamp>p.current).length,{widget:P}=f;A>0&&((S=P.state)==null?void 0:S.unreadMessages)!==A&&((E=P.dispatch)==null||E.call(P,{msg:"unread_msg",count:A}))},[d,f==null?void 0:f.widget]),b.createElement("div",An(we({},s),{className:"lk-chat"}),b.createElement("ul",{className:"lk-list lk-chat-messages",ref:c},s.children?d.map((C,g)=>uR(s.children,{entry:C,key:g,messageFormatter:n})):d.map((C,g,y)=>{const S=g>=1&&y[g-1].from===C.from,E=g>=1&&C.timestamp-y[g-1].timestamp<6e4;return b.createElement(MZ,{key:g,hideName:S,hideTimestamp:S===!1?!1:E,entry:C,messageFormatter:n})})),b.createElement("form",{className:"lk-chat-form",onSubmit:m},b.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:h,ref:a,type:"text",placeholder:"Enter a message..."}),b.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:h},"Send")))}function _w(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,tracks:o,requestPermissions:s=!1}=e,a=gn(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[c,l]=b.useState(!1),[u,d]=b.useState([]),[h,f]=b.useState(!0),p=(y,S)=>{Je.debug("handle device change"),l(!1),i==null||i(y,S)},m=b.useRef(null),C=b.useRef(null);b.useLayoutEffect(()=>{m.current&&C.current&&(u||h)&&w6(m.current,C.current).then(({x:y,y:S})=>{C.current&&Object.assign(C.current.style,{left:`${y}px`,top:`${S}px`})}),f(!1)},[m,C,u,h]);const g=b.useCallback(y=>{C.current&&y.target!==m.current&&c&&A6(C.current,y)&&l(!1)},[c,C,m]);return b.useEffect(()=>(document.addEventListener("click",g),window.addEventListener("resize",()=>f(!0)),()=>{document.removeEventListener("click",g),window.removeEventListener("resize",()=>f(!0))}),[g,f]),b.createElement(b.Fragment,null,b.createElement("button",An(we({className:"lk-button lk-button-menu","aria-pressed":c},a),{onClick:()=>l(!c),ref:m}),a.children),!a.disabled&&b.createElement("div",{className:"lk-device-menu",ref:C,style:{visibility:c?"visible":"hidden"}},n?b.createElement(Zg,{initialSelection:r,onActiveDeviceChange:y=>p(n,y),onDeviceListChange:d,kind:n,track:o==null?void 0:o[n],requestPermissions:s}):b.createElement(b.Fragment,null,b.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),b.createElement(Zg,{kind:"audioinput",onActiveDeviceChange:y=>p("audioinput",y),onDeviceListChange:d,track:o==null?void 0:o.audioinput,requestPermissions:s}),b.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),b.createElement(Zg,{kind:"videoinput",onActiveDeviceChange:y=>p("videoinput",y),onDeviceListChange:d,track:o==null?void 0:o.videoinput,requestPermissions:s}))))}function DZ(t){var e=t,{label:n}=e,r=gn(e,["label"]);const i=Op(),{mergedProps:o,canPlayAudio:s}=Wj({room:i,props:r}),{mergedProps:a,canPlayVideo:c}=jj({room:i,props:o}),l=a,{style:u}=l,d=gn(l,["style"]);return u.display=s&&c?"none":"block",b.createElement("button",we({style:u},d),n??`Start ${s?"Video":"Audio"}`)}function LZ(t){var e=t,{variation:n,controls:r,saveUserChoices:i=!0}=e,o=gn(e,["variation","controls","saveUserChoices"]),s,a,c,l,u;const[d,h]=b.useState(!1),f=lR();b.useEffect(()=>{var j,Z;((j=f==null?void 0:f.widget.state)==null?void 0:j.showChat)!==void 0&&h((Z=f==null?void 0:f.widget.state)==null?void 0:Z.showChat)},[(s=f==null?void 0:f.widget.state)==null?void 0:s.showChat]);const m=Ij(`(max-width: ${d?1e3:760}px)`)?"minimal":"verbose";n??(n=m);const C=we({leave:!0},r),g=Lj();g?((a=C.camera)!=null||(C.camera=g.canPublish),(c=C.microphone)!=null||(C.microphone=g.canPublish),(l=C.screenShare)!=null||(C.screenShare=g.canPublish),(u=C.chat)!=null||(C.chat=g.canPublishData&&(r==null?void 0:r.chat))):(C.camera=!1,C.chat=!1,C.microphone=!1,C.screenShare=!1);const y=b.useMemo(()=>n==="minimal"||n==="verbose",[n]),S=b.useMemo(()=>n==="textOnly"||n==="verbose",[n]),E=x6(),[A,P]=b.useState(!1),w=j=>{P(j)},T=Al({className:"lk-control-bar"},o),{saveAudioInputEnabled:_,saveVideoInputEnabled:M,saveAudioInputDeviceId:D,saveVideoInputDeviceId:B}=Kj({preventSave:!i});return b.createElement("div",we({},T),C.microphone&&b.createElement("div",{className:"lk-button-group"},b.createElement(zg,{source:$.Source.Microphone,showIcon:y,onChange:_},S&&"Microphone"),b.createElement("div",{className:"lk-button-group-menu"},b.createElement(_w,{kind:"audioinput",onActiveDeviceChange:(j,Z)=>D(Z??"")}))),C.camera&&b.createElement("div",{className:"lk-button-group"},b.createElement(zg,{source:$.Source.Camera,showIcon:y,onChange:M},S&&"Camera"),b.createElement("div",{className:"lk-button-group-menu"},b.createElement(_w,{kind:"videoinput",onActiveDeviceChange:(j,Z)=>B(Z??"")}))),C.screenShare&&E&&b.createElement(zg,{source:$.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:y,onChange:w},S&&(A?"Stop screen share":"Share screen")),C.chat&&b.createElement(Jj,null,y&&b.createElement(rZ,null),S&&"Chat"),C.leave&&b.createElement(Yj,null,y&&b.createElement(oZ,null),S&&"Leave"),b.createElement(DZ,null))}function BZ(t){var e=gn(t,[]);const[n,r]=b.useState({showChat:!1,unreadMessages:0}),i=Gj();return b.createElement(xZ,{onWidgetChange:r},b.createElement("div",we({className:"lk-audio-conference"},e),b.createElement("div",{className:"lk-audio-conference-stage"},b.createElement(NZ,{participants:i},b.createElement(_Z,null))),b.createElement(LZ,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),n.showChat&&b.createElement(OZ,null)))}const FZ="wss://mongoose-67t79p35.livekit.cloud",UZ=({client:t})=>{const[e,n]=b.useState([]),[r,i]=b.useState(!1);return b.useEffect(()=>{const o=a=>{n(c=>[...c,a]),i(!0)},s=a=>{n(c=>{const l=c.filter(u=>u!==a);return l.length===0&&i(!1),l})};return t.on("livekitToken",o),t.on("livekitLeave",s),()=>{t.off("livekitToken",o),t.off("livekitLeave",s)}},[t]),e.length?X.jsxs("div",{"data-lk-theme":"default",children:[e.map((o,s)=>X.jsx(PZ,{video:!1,audio:!0,token:o,serverUrl:FZ,connect:!0,onDisconnected:()=>t.emit("livekitLeave",o),children:X.jsx(BZ,{})},s)),X.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null};function VZ(){const[t,e]=b.useState(null),[n,r]=b.useState(!1),[i,o]=b.useState([]),s=nt.useRef(null),a=nt.useRef(null),c=nt.useRef(null),l=b.useRef(!1),u=()=>{s.current&&s.current.saveLog()},d=()=>{s.current&&s.current.clearLog()},h=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return b.useEffect(()=>{if(l.current)return;const f=new kU("mongoose.moo.mud.org",8765);f.registerGMCPPackage(dU),f.registerGMCPPackage(aU),f.registerGMCPPackage(cU),f.registerGMCPPackage(nL),f.registerGMCPPackage(hU),f.registerGMCPPackage(lU),f.registerGMCPPackage(uU),f.registerGMCPPackage(eL),f.registerMcpPackage(mU),f.registerMcpPackage(vU),f.registerMcpPackage(CU),f.registerMcpPackage(IU),f.connect(),f.requestNotificationPermission(),e(f),r(!h),window.mudClient=f,l.current=!0;const p=C=>{f&&(C.key==="Control"&&f.cancelSpeech(),C.key==="Escape"&&f.stopAllSounds())};window.addEventListener("keydown",p);const m=()=>{var C;(C=a.current)==null||C.focus()};return document.addEventListener("focus",m),()=>{window.removeEventListener("keydown",p),document.removeEventListener("focus",m)}},[h]),b.useEffect(()=>{if(t){const f=m=>{o(m)},p=()=>{o([])};return t.on("userlist",f),t.on("disconnect",p),()=>{t.off("userlist",f),t.off("disconnect",p)}}},[t]),vk(f=>{t&&t.shutdown()}),t?X.jsxs("div",{className:"App",children:[X.jsx("header",{className:"App-header"}),X.jsx(IV,{client:t,onSaveLog:u,onClearLog:d,onToggleUsers:()=>r(!n),onOpenPrefs:()=>{var f;return(f=c.current)==null?void 0:f.open()}}),X.jsxs("div",{children:[X.jsx(iv,{client:t,ref:s}),n&&X.jsx(bV,{users:i}),X.jsx(UZ,{client:t})]}),X.jsx(TU,{onSend:t.sendCommand,inputRef:a}),X.jsx(SV,{client:t}),X.jsx(sV,{ref:c})]}):null}function GZ(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ow(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Mw(Object(n),!0).forEach(function(r){GZ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mw(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function WZ(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function jZ(t,e){if(t==null)return{};var n=WZ(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function ZZ(t,e){return zZ(t)||HZ(t,e)||XZ(t,e)||$Z()}function zZ(t){if(Array.isArray(t))return t}function HZ(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var s=t[Symbol.iterator](),a;!(r=(a=s.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(c){i=!0,o=c}finally{try{!r&&s.return!=null&&s.return()}finally{if(i)throw o}}return n}}function XZ(t,e){if(t){if(typeof t=="string")return Dw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dw(t,e)}}function Dw(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $Z(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KZ(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Bw(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Lw(Object(n),!0).forEach(function(r){KZ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lw(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function JZ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return e.reduceRight(function(i,o){return o(i)},r)}}function iu(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function $f(t){return{}.toString.call(t).includes("Object")}function YZ(t){return!Object.keys(t).length}function nd(t){return typeof t=="function"}function QZ(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function qZ(t,e){return $f(e)||Ws("changeType"),Object.keys(e).some(function(n){return!QZ(t,n)})&&Ws("changeField"),e}function e8(t){nd(t)||Ws("selectorType")}function t8(t){nd(t)||$f(t)||Ws("handlerType"),$f(t)&&Object.values(t).some(function(e){return!nd(e)})&&Ws("handlersType")}function n8(t){t||Ws("initialIsRequired"),$f(t)||Ws("initialType"),YZ(t)&&Ws("initialContent")}function r8(t,e){throw new Error(t[e]||t.default)}var i8={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Ws=iu(r8)(i8),nh={changes:qZ,selector:e8,handler:t8,initial:n8};function o8(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};nh.initial(t),nh.handler(e);var n={current:t},r=iu(c8)(n,e),i=iu(a8)(n),o=iu(nh.changes)(t),s=iu(s8)(n);function a(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return nh.selector(l),l(n.current)}function c(l){JZ(r,i,o,s)(l)}return[a,c]}function s8(t,e){return nd(e)?e(t.current):e}function a8(t,e){return t.current=Bw(Bw({},t.current),e),e}function c8(t,e,n){return nd(e)?e(t.current):Object.keys(n).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,t.current[r])}),n}var l8={create:o8},u8={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function d8(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function h8(t){return{}.toString.call(t).includes("Object")}function f8(t){return t||Fw("configIsRequired"),h8(t)||Fw("configType"),t.urls?(p8(),{paths:{vs:t.urls.monacoBase}}):t}function p8(){console.warn(fR.deprecation)}function g8(t,e){throw new Error(t[e]||t.default)}var fR={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Fw=d8(g8)(fR),m8={config:f8},v8=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(o,s){return s(o)},i)}};function pR(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],pR(t[n],e[n]))}),Ow(Ow({},t),e)}var y8={type:"cancelation",msg:"operation is manually canceled"};function Hg(t){var e=!1,n=new Promise(function(r,i){t.then(function(o){return e?i(y8):r(o)}),t.catch(i)});return n.cancel=function(){return e=!0},n}var C8=l8.create({config:u8,isInitialized:!1,resolve:null,reject:null,monaco:null}),gR=ZZ(C8,2),Ad=gR[0],Lp=gR[1];function I8(t){var e=m8.config(t),n=e.monaco,r=jZ(e,["monaco"]);Lp(function(i){return{config:pR(i.config,r),monaco:n}})}function S8(){var t=Ad(function(e){var n=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!t.isInitialized){if(Lp({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),Hg(Xg);if(window.monaco&&window.monaco.editor)return mR(window.monaco),t.resolve(window.monaco),Hg(Xg);v8(b8,A8)(k8)}return Hg(Xg)}function b8(t){return document.body.appendChild(t)}function w8(t){var e=document.createElement("script");return t&&(e.src=t),e}function A8(t){var e=Ad(function(r){var i=r.config,o=r.reject;return{config:i,reject:o}}),n=w8("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function k8(){var t=Ad(function(n){var r=n.config,i=n.resolve,o=n.reject;return{config:r,resolve:i,reject:o}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){mR(n),t.resolve(n)},function(n){t.reject(n)})}function mR(t){Ad().monaco||Lp({monaco:t})}function E8(){return Ad(function(t){var e=t.monaco;return e})}var Xg=new Promise(function(t,e){return Lp({resolve:t,reject:e})}),vR={config:I8,init:S8,__getMonacoInstance:E8},T8={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},$g=T8,x8={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},P8=x8;function R8({children:t}){return nt.createElement("div",{style:P8.container},t)}var N8=R8,_8=N8;function M8({width:t,height:e,isEditorReady:n,loading:r,_ref:i,className:o,wrapperProps:s}){return nt.createElement("section",{style:{...$g.wrapper,width:t,height:e},...s},!n&&nt.createElement(_8,null,r),nt.createElement("div",{ref:i,style:{...$g.fullWidth,...!n&&$g.hide},className:o}))}var O8=M8,yR=b.memo(O8);function D8(t){b.useEffect(t,[])}var CR=D8;function L8(t,e,n=!0){let r=b.useRef(!0);b.useEffect(r.current||!n?()=>{r.current=!1}:t,e)}var yr=L8;function Su(){}function Ac(t,e,n,r){return B8(t,r)||F8(t,e,n,r)}function B8(t,e){return t.editor.getModel(IR(t,e))}function F8(t,e,n,r){return t.editor.createModel(e,n,r?IR(t,r):void 0)}function IR(t,e){return t.Uri.parse(e)}function U8({original:t,modified:e,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:o,modifiedModelPath:s,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:c=!1,theme:l="light",loading:u="Loading...",options:d={},height:h="100%",width:f="100%",className:p,wrapperProps:m={},beforeMount:C=Su,onMount:g=Su}){let[y,S]=b.useState(!1),[E,A]=b.useState(!0),P=b.useRef(null),w=b.useRef(null),T=b.useRef(null),_=b.useRef(g),M=b.useRef(C),D=b.useRef(!1);CR(()=>{let z=vR.init();return z.then(q=>(w.current=q)&&A(!1)).catch(q=>(q==null?void 0:q.type)!=="cancelation"&&console.error("Monaco initialization: error:",q)),()=>P.current?Z():z.cancel()}),yr(()=>{if(P.current&&w.current){let z=P.current.getOriginalEditor(),q=Ac(w.current,t||"",r||n||"text",o||"");q!==z.getModel()&&z.setModel(q)}},[o],y),yr(()=>{if(P.current&&w.current){let z=P.current.getModifiedEditor(),q=Ac(w.current,e||"",i||n||"text",s||"");q!==z.getModel()&&z.setModel(q)}},[s],y),yr(()=>{let z=P.current.getModifiedEditor();z.getOption(w.current.editor.EditorOption.readOnly)?z.setValue(e||""):e!==z.getValue()&&(z.executeEdits("",[{range:z.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),z.pushUndoStop())},[e],y),yr(()=>{var z,q;(q=(z=P.current)==null?void 0:z.getModel())==null||q.original.setValue(t||"")},[t],y),yr(()=>{let{original:z,modified:q}=P.current.getModel();w.current.editor.setModelLanguage(z,r||n||"text"),w.current.editor.setModelLanguage(q,i||n||"text")},[n,r,i],y),yr(()=>{var z;(z=w.current)==null||z.editor.setTheme(l)},[l],y),yr(()=>{var z;(z=P.current)==null||z.updateOptions(d)},[d],y);let B=b.useCallback(()=>{var oe;if(!w.current)return;M.current(w.current);let z=Ac(w.current,t||"",r||n||"text",o||""),q=Ac(w.current,e||"",i||n||"text",s||"");(oe=P.current)==null||oe.setModel({original:z,modified:q})},[n,e,i,t,r,o,s]),j=b.useCallback(()=>{var z;!D.current&&T.current&&(P.current=w.current.editor.createDiffEditor(T.current,{automaticLayout:!0,...d}),B(),(z=w.current)==null||z.editor.setTheme(l),S(!0),D.current=!0)},[d,l,B]);b.useEffect(()=>{y&&_.current(P.current,w.current)},[y]),b.useEffect(()=>{!E&&!y&&j()},[E,y,j]);function Z(){var q,oe,W,Y;let z=(q=P.current)==null?void 0:q.getModel();a||((oe=z==null?void 0:z.original)==null||oe.dispose()),c||((W=z==null?void 0:z.modified)==null||W.dispose()),(Y=P.current)==null||Y.dispose()}return nt.createElement(yR,{width:f,height:h,isEditorReady:y,loading:u,_ref:T,className:p,wrapperProps:m})}var V8=U8;b.memo(V8);function G8(t){let e=b.useRef();return b.useEffect(()=>{e.current=t},[t]),e.current}var W8=G8,rh=new Map;function j8({defaultValue:t,defaultLanguage:e,defaultPath:n,value:r,language:i,path:o,theme:s="light",line:a,loading:c="Loading...",options:l={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:h=!1,width:f="100%",height:p="100%",className:m,wrapperProps:C={},beforeMount:g=Su,onMount:y=Su,onChange:S,onValidate:E=Su}){let[A,P]=b.useState(!1),[w,T]=b.useState(!0),_=b.useRef(null),M=b.useRef(null),D=b.useRef(null),B=b.useRef(y),j=b.useRef(g),Z=b.useRef(),z=b.useRef(r),q=W8(o),oe=b.useRef(!1),W=b.useRef(!1);CR(()=>{let H=vR.init();return H.then(te=>(_.current=te)&&T(!1)).catch(te=>(te==null?void 0:te.type)!=="cancelation"&&console.error("Monaco initialization: error:",te)),()=>M.current?re():H.cancel()}),yr(()=>{var te,Ee,Le,ve;let H=Ac(_.current,t||r||"",e||i||"",o||n||"");H!==((te=M.current)==null?void 0:te.getModel())&&(d&&rh.set(q,(Ee=M.current)==null?void 0:Ee.saveViewState()),(Le=M.current)==null||Le.setModel(H),d&&((ve=M.current)==null||ve.restoreViewState(rh.get(o))))},[o],A),yr(()=>{var H;(H=M.current)==null||H.updateOptions(l)},[l],A),yr(()=>{!M.current||r===void 0||(M.current.getOption(_.current.editor.EditorOption.readOnly)?M.current.setValue(r):r!==M.current.getValue()&&(W.current=!0,M.current.executeEdits("",[{range:M.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),M.current.pushUndoStop(),W.current=!1))},[r],A),yr(()=>{var te,Ee;let H=(te=M.current)==null?void 0:te.getModel();H&&i&&((Ee=_.current)==null||Ee.editor.setModelLanguage(H,i))},[i],A),yr(()=>{var H;a!==void 0&&((H=M.current)==null||H.revealLine(a))},[a],A),yr(()=>{var H;(H=_.current)==null||H.editor.setTheme(s)},[s],A);let Y=b.useCallback(()=>{var H;if(!(!D.current||!_.current)&&!oe.current){j.current(_.current);let te=o||n,Ee=Ac(_.current,r||t||"",e||i||"",te||"");M.current=(H=_.current)==null?void 0:H.editor.create(D.current,{model:Ee,automaticLayout:!0,...l},u),d&&M.current.restoreViewState(rh.get(te)),_.current.editor.setTheme(s),a!==void 0&&M.current.revealLine(a),P(!0),oe.current=!0}},[t,e,n,r,i,o,l,u,d,s,a]);b.useEffect(()=>{A&&B.current(M.current,_.current)},[A]),b.useEffect(()=>{!w&&!A&&Y()},[w,A,Y]),z.current=r,b.useEffect(()=>{var H,te;A&&S&&((H=Z.current)==null||H.dispose(),Z.current=(te=M.current)==null?void 0:te.onDidChangeModelContent(Ee=>{W.current||S(M.current.getValue(),Ee)}))},[A,S]),b.useEffect(()=>{if(A){let H=_.current.editor.onDidChangeMarkers(te=>{var Le;let Ee=(Le=M.current.getModel())==null?void 0:Le.uri;if(Ee&&te.find(ve=>ve.path===Ee.path)){let ve=_.current.editor.getModelMarkers({resource:Ee});E==null||E(ve)}});return()=>{H==null||H.dispose()}}return()=>{}},[A,E]);function re(){var H,te;(H=Z.current)==null||H.dispose(),h?d&&rh.set(o,M.current.saveViewState()):(te=M.current.getModel())==null||te.dispose(),M.current.dispose()}return nt.createElement(yR,{width:f,height:p,isEditorReady:A,loading:c,_ref:D,className:m,wrapperProps:C})}var Z8=j8,z8=b.memo(Z8),H8=z8,X8={restoreOnUnmount:!1};function $8(t,e){e===void 0&&(e=X8);var n=b.useRef(document.title);document.title!==t&&(document.title=t),b.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=n.current}},[])}const K8=typeof document<"u"?$8:function(t){};function J8({onSave:t,onRevert:e,onDownload:n}){return X.jsx("div",{className:"toolbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderBottom:"1px solid #e8e8e8"},children:X.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[X.jsxs("button",{onClick:t,accessKey:"s",children:[X.jsx($T,{}),"Save"]}),X.jsxs("button",{onClick:e,accessKey:"r",children:[X.jsx(vV,{}),"Revert"]}),X.jsxs("button",{onClick:n,accessKey:"d",children:[X.jsx(gV,{}),"Download"]})]})})}const Y8=({docstate:t,session:e})=>X.jsxs("div",{"aria-live":"polite",className:"statusbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderTop:"1px solid #e8e8e8"},children:[X.jsx("span",{children:t}),X.jsx("span",{children:"|"}),X.jsx("span",{children:e.reference}),X.jsx("span",{children:"|"}),X.jsx("span",{children:e.type})]});function Q8(){const t=mk(),e=nt.useRef(null),[n,r]=b.useState(""),[i,o]=b.useState(""),[s,a]=b.useState(""),[c,l]=b.useState(0),[u,d]=b.useState({name:"none",contents:[],reference:"",type:""}),h=(j,Z)=>{e.current=j},[f,p]=ta();console.log(f);const m=f.editor.accessibilityMode,C=f.editor.autocompleteEnabled;vk(j=>{A.postMessage({type:"close",id:w}),c===1&&j.preventDefault()});const[g,y]=b.useState(!1),S=g?`${u.name} - Mongoose Editor`:"Mongoose Editor";K8(S);const E=b.useMemo(()=>{switch(c){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[c]),A=b.useMemo(()=>new BroadcastChannel("editor"),[]),P=new URLSearchParams(t.search),w=decodeURIComponent(P.get("reference")||"");b.useEffect(()=>{if(!w)return;console.log("ID: "+w),console.log("Sending ready message"),A.postMessage({type:"ready",id:w});const j=Z=>{if(console.log(Z.data),Z.data.type==="load"){if(n!=="")return;const z=Z.data.session.contents.join(`
`);o(z),a(z),d(Z.data.session),l(0),r(Z.data.clientId),setTimeout(B,100)}else if(Z.data.type==="shutdown"){if(Z.data.clientId!==n)return;A.close(),window.close()}};return A.addEventListener("message",j),()=>A.removeEventListener("message",j)},[A,n,w]);const T=()=>{o(s),l(0)},_=j=>{const Z=i.split(/\r\n|\r|\n/),z={...u,contents:Z};A.postMessage({type:"save",session:z,id:w}),l(2),B(),j.preventDefault()},M=j=>{j!==void 0&&(console.log("Original: "+s),console.log("New: "+j),o(j),j.split(/\r\n|\r|\n/).join(`
`)!==s?l(1):l(0),g||y(!0))},D=()=>{const j=new Blob([i],{type:"text/plain"}),Z=URL.createObjectURL(j),z=document.createElement("a"),q=new Date,oe=q.toLocaleDateString().replace(/\//g,"-"),W=q.toLocaleTimeString().replace(/:/g,"-"),Y=`${u.name}-${oe}-${W}.txt`;z.download=Y,z.href=Z,z.click(),URL.revokeObjectURL(Z),z.remove()};return X.jsxs("div",{id:"editor",children:[X.jsx(J8,{onSave:_,onRevert:T,onDownload:D}),X.jsx(H8,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:M,options:{wordWrap:"on",accessibilitySupport:m?"on":"off",quickSuggestions:C},onMount:h,path:u.reference}),X.jsx(Y8,{docstate:E,session:u})]});function B(){e.current!==null&&e.current.focus()}}const q8="modulepreload",e7=function(t){return"/"+t},Uw={},t7=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.all(n.map(a=>{if(a=e7(a),a in Uw)return;Uw[a]=!0;const c=a.endsWith(".css"),l=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${l}`))return;const u=document.createElement("link");if(u.rel=c?"stylesheet":q8,c||(u.as="script",u.crossOrigin=""),u.href=a,s&&u.setAttribute("nonce",s),document.head.appendChild(u),c)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})}))}return i.then(()=>e()).catch(o=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o})},n7=t=>{t&&t instanceof Function&&t7(async()=>{const{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}=await import("./web-vitals-DdRmOIVa.js");return{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}},[]).then(({getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o})=>{e(t),n(t),r(t),i(t),o(t)})};var Vw={};const r7=!!(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function i7(t){if("serviceWorker"in navigator){if(new URL(Vw.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const n=`${Vw.PUBLIC_URL}/service-worker.js`;r7?(o7(n),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):SR(n)})}}function SR(t,e){navigator.serviceWorker.register(t).then(n=>{n.onupdatefound=()=>{const r=n.installing;r!=null&&(r.onstatechange=()=>{r.state==="installed"&&(navigator.serviceWorker.controller?console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."):console.log("Content is cached for offline use."))})}}).catch(n=>{console.error("Error during service worker registration:",n)})}function o7(t,e){fetch(t).then(n=>{const r=n.headers.get("content-type");n.status===404||r!=null&&r.indexOf("javascript")===-1?navigator.serviceWorker.ready.then(i=>{i.unregister().then(()=>{window.location.reload()})}):SR(t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}const s7=pO([{path:"/",element:X.jsx(VZ,{})},{path:"/editor",element:X.jsx(Q8,{})}]),a7=Kg.createRoot(document.getElementById("root"));a7.render(X.jsx(nt.StrictMode,{children:X.jsx(wO,{router:s7})}));n7(console.log);i7();

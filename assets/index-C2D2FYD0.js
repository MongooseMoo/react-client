var dP=Object.defineProperty;var Ab=n=>{throw TypeError(n)};var fP=(n,e,t)=>e in n?dP(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var oe=(n,e,t)=>fP(n,typeof e!="symbol"?e+"":e,t),Im=(n,e,t)=>e.has(n)||Ab("Cannot "+t);var le=(n,e,t)=>(Im(n,e,"read from private field"),t?t.call(n):e.get(n)),Rn=(n,e,t)=>e.has(n)?Ab("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Jt=(n,e,t,r)=>(Im(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),Nt=(n,e,t)=>(Im(n,e,"access private method"),t);var Ih=(n,e,t,r)=>({set _(i){Jt(n,e,i,t)},get _(){return le(n,e,r)}});function LA(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(n,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var Gh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ec(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function hP(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var wm={exports:{}},hd={},Sm={exports:{}},In={},kb;function pP(){if(kb)return In;kb=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),a=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;function g(H){return H===null||typeof H!="object"?null:(H=m&&H[m]||H["@@iterator"],typeof H=="function"?H:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,x={};function w(H,ee,ae){this.props=H,this.context=ee,this.refs=x,this.updater=ae||y}w.prototype.isReactComponent={},w.prototype.setState=function(H,ee){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ee,"setState")},w.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function S(){}S.prototype=w.prototype;function A(H,ee,ae){this.props=H,this.context=ee,this.refs=x,this.updater=ae||y}var E=A.prototype=new S;E.constructor=A,C(E,w.prototype),E.isPureReactComponent=!0;var _=Array.isArray,T=Object.prototype.hasOwnProperty,M={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function j(H,ee,ae){var ye,Ee={},_e=null,Je=null;if(ee!=null)for(ye in ee.ref!==void 0&&(Je=ee.ref),ee.key!==void 0&&(_e=""+ee.key),ee)T.call(ee,ye)&&!P.hasOwnProperty(ye)&&(Ee[ye]=ee[ye]);var me=arguments.length-2;if(me===1)Ee.children=ae;else if(1<me){for(var it=Array(me),Tt=0;Tt<me;Tt++)it[Tt]=arguments[Tt+2];Ee.children=it}if(H&&H.defaultProps)for(ye in me=H.defaultProps,me)Ee[ye]===void 0&&(Ee[ye]=me[ye]);return{$$typeof:n,type:H,key:_e,ref:Je,props:Ee,_owner:M.current}}function X(H,ee){return{$$typeof:n,type:H.type,key:ee,ref:H.ref,props:H.props,_owner:H._owner}}function L(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function G(H){var ee={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ae){return ee[ae]})}var Z=/\/+/g;function ne(H,ee){return typeof H=="object"&&H!==null&&H.key!=null?G(""+H.key):ee.toString(36)}function pe(H,ee,ae,ye,Ee){var _e=typeof H;(_e==="undefined"||_e==="boolean")&&(H=null);var Je=!1;if(H===null)Je=!0;else switch(_e){case"string":case"number":Je=!0;break;case"object":switch(H.$$typeof){case n:case e:Je=!0}}if(Je)return Je=H,Ee=Ee(Je),H=ye===""?"."+ne(Je,0):ye,_(Ee)?(ae="",H!=null&&(ae=H.replace(Z,"$&/")+"/"),pe(Ee,ee,ae,"",function(Tt){return Tt})):Ee!=null&&(L(Ee)&&(Ee=X(Ee,ae+(!Ee.key||Je&&Je.key===Ee.key?"":(""+Ee.key).replace(Z,"$&/")+"/")+H)),ee.push(Ee)),1;if(Je=0,ye=ye===""?".":ye+":",_(H))for(var me=0;me<H.length;me++){_e=H[me];var it=ye+ne(_e,me);Je+=pe(_e,ee,ae,it,Ee)}else if(it=g(H),typeof it=="function")for(H=it.call(H),me=0;!(_e=H.next()).done;)_e=_e.value,it=ye+ne(_e,me++),Je+=pe(_e,ee,ae,it,Ee);else if(_e==="object")throw ee=String(H),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.");return Je}function ve(H,ee,ae){if(H==null)return H;var ye=[],Ee=0;return pe(H,ye,"","",function(_e){return ee.call(ae,_e,Ee++)}),ye}function Se(H){if(H._status===-1){var ee=H._result;ee=ee(),ee.then(function(ae){(H._status===0||H._status===-1)&&(H._status=1,H._result=ae)},function(ae){(H._status===0||H._status===-1)&&(H._status=2,H._result=ae)}),H._status===-1&&(H._status=0,H._result=ee)}if(H._status===1)return H._result.default;throw H._result}var Ne={current:null},xe={transition:null},Ae={ReactCurrentDispatcher:Ne,ReactCurrentBatchConfig:xe,ReactCurrentOwner:M};function ke(){throw Error("act(...) is not supported in production builds of React.")}return In.Children={map:ve,forEach:function(H,ee,ae){ve(H,function(){ee.apply(this,arguments)},ae)},count:function(H){var ee=0;return ve(H,function(){ee++}),ee},toArray:function(H){return ve(H,function(ee){return ee})||[]},only:function(H){if(!L(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},In.Component=w,In.Fragment=t,In.Profiler=i,In.PureComponent=A,In.StrictMode=r,In.Suspense=l,In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ae,In.act=ke,In.cloneElement=function(H,ee,ae){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var ye=C({},H.props),Ee=H.key,_e=H.ref,Je=H._owner;if(ee!=null){if(ee.ref!==void 0&&(_e=ee.ref,Je=M.current),ee.key!==void 0&&(Ee=""+ee.key),H.type&&H.type.defaultProps)var me=H.type.defaultProps;for(it in ee)T.call(ee,it)&&!P.hasOwnProperty(it)&&(ye[it]=ee[it]===void 0&&me!==void 0?me[it]:ee[it])}var it=arguments.length-2;if(it===1)ye.children=ae;else if(1<it){me=Array(it);for(var Tt=0;Tt<it;Tt++)me[Tt]=arguments[Tt+2];ye.children=me}return{$$typeof:n,type:H.type,key:Ee,ref:_e,props:ye,_owner:Je}},In.createContext=function(H){return H={$$typeof:a,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:o,_context:H},H.Consumer=H},In.createElement=j,In.createFactory=function(H){var ee=j.bind(null,H);return ee.type=H,ee},In.createRef=function(){return{current:null}},In.forwardRef=function(H){return{$$typeof:s,render:H}},In.isValidElement=L,In.lazy=function(H){return{$$typeof:h,_payload:{_status:-1,_result:H},_init:Se}},In.memo=function(H,ee){return{$$typeof:f,type:H,compare:ee===void 0?null:ee}},In.startTransition=function(H){var ee=xe.transition;xe.transition={};try{H()}finally{xe.transition=ee}},In.unstable_act=ke,In.useCallback=function(H,ee){return Ne.current.useCallback(H,ee)},In.useContext=function(H){return Ne.current.useContext(H)},In.useDebugValue=function(){},In.useDeferredValue=function(H){return Ne.current.useDeferredValue(H)},In.useEffect=function(H,ee){return Ne.current.useEffect(H,ee)},In.useId=function(){return Ne.current.useId()},In.useImperativeHandle=function(H,ee,ae){return Ne.current.useImperativeHandle(H,ee,ae)},In.useInsertionEffect=function(H,ee){return Ne.current.useInsertionEffect(H,ee)},In.useLayoutEffect=function(H,ee){return Ne.current.useLayoutEffect(H,ee)},In.useMemo=function(H,ee){return Ne.current.useMemo(H,ee)},In.useReducer=function(H,ee,ae){return Ne.current.useReducer(H,ee,ae)},In.useRef=function(H){return Ne.current.useRef(H)},In.useState=function(H){return Ne.current.useState(H)},In.useSyncExternalStore=function(H,ee,ae){return Ne.current.useSyncExternalStore(H,ee,ae)},In.useTransition=function(){return Ne.current.useTransition()},In.version="18.3.1",In}var Eb;function mf(){return Eb||(Eb=1,Sm.exports=pP()),Sm.exports}var Tb;function gP(){if(Tb)return hd;Tb=1;var n=mf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(s,l,f){var h,m={},g=null,y=null;f!==void 0&&(g=""+f),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(y=l.ref);for(h in l)r.call(l,h)&&!o.hasOwnProperty(h)&&(m[h]=l[h]);if(s&&s.defaultProps)for(h in l=s.defaultProps,l)m[h]===void 0&&(m[h]=l[h]);return{$$typeof:e,type:s,key:g,ref:y,props:m,_owner:i.current}}return hd.Fragment=t,hd.jsx=a,hd.jsxs=a,hd}var _b;function mP(){return _b||(_b=1,wm.exports=gP()),wm.exports}var K=mP(),O=mf();const vn=Ec(O),vP=LA({__proto__:null,default:vn},[O]);var wh={},Am={exports:{}},eo={},km={exports:{}},Em={},Rb;function yP(){return Rb||(Rb=1,function(n){function e(xe,Ae){var ke=xe.length;xe.push(Ae);e:for(;0<ke;){var H=ke-1>>>1,ee=xe[H];if(0<i(ee,Ae))xe[H]=Ae,xe[ke]=ee,ke=H;else break e}}function t(xe){return xe.length===0?null:xe[0]}function r(xe){if(xe.length===0)return null;var Ae=xe[0],ke=xe.pop();if(ke!==Ae){xe[0]=ke;e:for(var H=0,ee=xe.length,ae=ee>>>1;H<ae;){var ye=2*(H+1)-1,Ee=xe[ye],_e=ye+1,Je=xe[_e];if(0>i(Ee,ke))_e<ee&&0>i(Je,Ee)?(xe[H]=Je,xe[_e]=ke,H=_e):(xe[H]=Ee,xe[ye]=ke,H=ye);else if(_e<ee&&0>i(Je,ke))xe[H]=Je,xe[_e]=ke,H=_e;else break e}}return Ae}function i(xe,Ae){var ke=xe.sortIndex-Ae.sortIndex;return ke!==0?ke:xe.id-Ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();n.unstable_now=function(){return a.now()-s}}var l=[],f=[],h=1,m=null,g=3,y=!1,C=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(xe){for(var Ae=t(f);Ae!==null;){if(Ae.callback===null)r(f);else if(Ae.startTime<=xe)r(f),Ae.sortIndex=Ae.expirationTime,e(l,Ae);else break;Ae=t(f)}}function _(xe){if(x=!1,E(xe),!C)if(t(l)!==null)C=!0,Se(T);else{var Ae=t(f);Ae!==null&&Ne(_,Ae.startTime-xe)}}function T(xe,Ae){C=!1,x&&(x=!1,S(j),j=-1),y=!0;var ke=g;try{for(E(Ae),m=t(l);m!==null&&(!(m.expirationTime>Ae)||xe&&!G());){var H=m.callback;if(typeof H=="function"){m.callback=null,g=m.priorityLevel;var ee=H(m.expirationTime<=Ae);Ae=n.unstable_now(),typeof ee=="function"?m.callback=ee:m===t(l)&&r(l),E(Ae)}else r(l);m=t(l)}if(m!==null)var ae=!0;else{var ye=t(f);ye!==null&&Ne(_,ye.startTime-Ae),ae=!1}return ae}finally{m=null,g=ke,y=!1}}var M=!1,P=null,j=-1,X=5,L=-1;function G(){return!(n.unstable_now()-L<X)}function Z(){if(P!==null){var xe=n.unstable_now();L=xe;var Ae=!0;try{Ae=P(!0,xe)}finally{Ae?ne():(M=!1,P=null)}}else M=!1}var ne;if(typeof A=="function")ne=function(){A(Z)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,ve=pe.port2;pe.port1.onmessage=Z,ne=function(){ve.postMessage(null)}}else ne=function(){w(Z,0)};function Se(xe){P=xe,M||(M=!0,ne())}function Ne(xe,Ae){j=w(function(){xe(n.unstable_now())},Ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(xe){xe.callback=null},n.unstable_continueExecution=function(){C||y||(C=!0,Se(T))},n.unstable_forceFrameRate=function(xe){0>xe||125<xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<xe?Math.floor(1e3/xe):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(xe){switch(g){case 1:case 2:case 3:var Ae=3;break;default:Ae=g}var ke=g;g=Ae;try{return xe()}finally{g=ke}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(xe,Ae){switch(xe){case 1:case 2:case 3:case 4:case 5:break;default:xe=3}var ke=g;g=xe;try{return Ae()}finally{g=ke}},n.unstable_scheduleCallback=function(xe,Ae,ke){var H=n.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?H+ke:H):ke=H,xe){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=ke+ee,xe={id:h++,callback:Ae,priorityLevel:xe,startTime:ke,expirationTime:ee,sortIndex:-1},ke>H?(xe.sortIndex=ke,e(f,xe),t(l)===null&&xe===t(f)&&(x?(S(j),j=-1):x=!0,Ne(_,ke-H))):(xe.sortIndex=ee,e(l,xe),C||y||(C=!0,Se(T))),xe},n.unstable_shouldYield=G,n.unstable_wrapCallback=function(xe){var Ae=g;return function(){var ke=g;g=Ae;try{return xe.apply(this,arguments)}finally{g=ke}}}}(Em)),Em}var Pb;function CP(){return Pb||(Pb=1,km.exports=yP()),km.exports}var Db;function xP(){if(Db)return eo;Db=1;var n=mf(),e=CP();function t(c){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+c,v=1;v<arguments.length;v++)d+="&args[]="+encodeURIComponent(arguments[v]);return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function o(c,d){a(c,d),a(c+"Capture",d)}function a(c,d){for(i[c]=d,c=0;c<d.length;c++)r.add(d[c])}var s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},m={};function g(c){return l.call(m,c)?!0:l.call(h,c)?!1:f.test(c)?m[c]=!0:(h[c]=!0,!1)}function y(c,d,v,b){if(v!==null&&v.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return b?!1:v!==null?!v.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function C(c,d,v,b){if(d===null||typeof d>"u"||y(c,d,v,b))return!0;if(b)return!1;if(v!==null)switch(v.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function x(c,d,v,b,k,B,$){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=b,this.attributeNamespace=k,this.mustUseProperty=v,this.propertyName=c,this.type=d,this.sanitizeURL=B,this.removeEmptyString=$}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){w[c]=new x(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var d=c[0];w[d]=new x(d,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){w[c]=new x(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){w[c]=new x(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){w[c]=new x(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){w[c]=new x(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){w[c]=new x(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){w[c]=new x(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){w[c]=new x(c,5,!1,c.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function A(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var d=c.replace(S,A);w[d]=new x(d,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var d=c.replace(S,A);w[d]=new x(d,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var d=c.replace(S,A);w[d]=new x(d,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){w[c]=new x(c,1,!1,c.toLowerCase(),null,!1,!1)}),w.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){w[c]=new x(c,1,!1,c.toLowerCase(),null,!0,!0)});function E(c,d,v,b){var k=w.hasOwnProperty(d)?w[d]:null;(k!==null?k.type!==0:b||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(C(d,v,k,b)&&(v=null),b||k===null?g(d)&&(v===null?c.removeAttribute(d):c.setAttribute(d,""+v)):k.mustUseProperty?c[k.propertyName]=v===null?k.type===3?!1:"":v:(d=k.attributeName,b=k.attributeNamespace,v===null?c.removeAttribute(d):(k=k.type,v=k===3||k===4&&v===!0?"":""+v,b?c.setAttributeNS(b,d,v):c.setAttribute(d,v))))}var _=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=Symbol.for("react.element"),M=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),X=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),G=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),ne=Symbol.for("react.suspense"),pe=Symbol.for("react.suspense_list"),ve=Symbol.for("react.memo"),Se=Symbol.for("react.lazy"),Ne=Symbol.for("react.offscreen"),xe=Symbol.iterator;function Ae(c){return c===null||typeof c!="object"?null:(c=xe&&c[xe]||c["@@iterator"],typeof c=="function"?c:null)}var ke=Object.assign,H;function ee(c){if(H===void 0)try{throw Error()}catch(v){var d=v.stack.trim().match(/\n( *(at )?)/);H=d&&d[1]||""}return`
`+H+c}var ae=!1;function ye(c,d){if(!c||ae)return"";ae=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Le){var b=Le}Reflect.construct(c,[],d)}else{try{d.call()}catch(Le){b=Le}c.call(d.prototype)}else{try{throw Error()}catch(Le){b=Le}c()}}catch(Le){if(Le&&b&&typeof Le.stack=="string"){for(var k=Le.stack.split(`
`),B=b.stack.split(`
`),$=k.length-1,ue=B.length-1;1<=$&&0<=ue&&k[$]!==B[ue];)ue--;for(;1<=$&&0<=ue;$--,ue--)if(k[$]!==B[ue]){if($!==1||ue!==1)do if($--,ue--,0>ue||k[$]!==B[ue]){var be=`
`+k[$].replace(" at new "," at ");return c.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",c.displayName)),be}while(1<=$&&0<=ue);break}}}finally{ae=!1,Error.prepareStackTrace=v}return(c=c?c.displayName||c.name:"")?ee(c):""}function Ee(c){switch(c.tag){case 5:return ee(c.type);case 16:return ee("Lazy");case 13:return ee("Suspense");case 19:return ee("SuspenseList");case 0:case 2:case 15:return c=ye(c.type,!1),c;case 11:return c=ye(c.type.render,!1),c;case 1:return c=ye(c.type,!0),c;default:return""}}function _e(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case P:return"Fragment";case M:return"Portal";case X:return"Profiler";case j:return"StrictMode";case ne:return"Suspense";case pe:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case G:return(c.displayName||"Context")+".Consumer";case L:return(c._context.displayName||"Context")+".Provider";case Z:var d=c.render;return c=c.displayName,c||(c=d.displayName||d.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case ve:return d=c.displayName||null,d!==null?d:_e(c.type)||"Memo";case Se:d=c._payload,c=c._init;try{return _e(c(d))}catch{}}return null}function Je(c){var d=c.type;switch(c.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=d.render,c=c.displayName||c.name||"",d.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _e(d);case 8:return d===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function me(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function it(c){var d=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Tt(c){var d=it(c)?"checked":"value",v=Object.getOwnPropertyDescriptor(c.constructor.prototype,d),b=""+c[d];if(!c.hasOwnProperty(d)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var k=v.get,B=v.set;return Object.defineProperty(c,d,{configurable:!0,get:function(){return k.call(this)},set:function($){b=""+$,B.call(this,$)}}),Object.defineProperty(c,d,{enumerable:v.enumerable}),{getValue:function(){return b},setValue:function($){b=""+$},stopTracking:function(){c._valueTracker=null,delete c[d]}}}}function Xt(c){c._valueTracker||(c._valueTracker=Tt(c))}function Et(c){if(!c)return!1;var d=c._valueTracker;if(!d)return!0;var v=d.getValue(),b="";return c&&(b=it(c)?c.checked?"true":"false":c.value),c=b,c!==v?(d.setValue(c),!0):!1}function St(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function Dt(c,d){var v=d.checked;return ke({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:v??c._wrapperState.initialChecked})}function at(c,d){var v=d.defaultValue==null?"":d.defaultValue,b=d.checked!=null?d.checked:d.defaultChecked;v=me(d.value!=null?d.value:v),c._wrapperState={initialChecked:b,initialValue:v,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function lt(c,d){d=d.checked,d!=null&&E(c,"checked",d,!1)}function Vt(c,d){lt(c,d);var v=me(d.value),b=d.type;if(v!=null)b==="number"?(v===0&&c.value===""||c.value!=v)&&(c.value=""+v):c.value!==""+v&&(c.value=""+v);else if(b==="submit"||b==="reset"){c.removeAttribute("value");return}d.hasOwnProperty("value")?Pt(c,d.type,v):d.hasOwnProperty("defaultValue")&&Pt(c,d.type,me(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(c.defaultChecked=!!d.defaultChecked)}function Gt(c,d,v){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var b=d.type;if(!(b!=="submit"&&b!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+c._wrapperState.initialValue,v||d===c.value||(c.value=d),c.defaultValue=d}v=c.name,v!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,v!==""&&(c.name=v)}function Pt(c,d,v){(d!=="number"||St(c.ownerDocument)!==c)&&(v==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+v&&(c.defaultValue=""+v))}var Ht=Array.isArray;function on(c,d,v,b){if(c=c.options,d){d={};for(var k=0;k<v.length;k++)d["$"+v[k]]=!0;for(v=0;v<c.length;v++)k=d.hasOwnProperty("$"+c[v].value),c[v].selected!==k&&(c[v].selected=k),k&&b&&(c[v].defaultSelected=!0)}else{for(v=""+me(v),d=null,k=0;k<c.length;k++){if(c[k].value===v){c[k].selected=!0,b&&(c[k].defaultSelected=!0);return}d!==null||c[k].disabled||(d=c[k])}d!==null&&(d.selected=!0)}}function ct(c,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return ke({},d,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function ce(c,d){var v=d.value;if(v==null){if(v=d.children,d=d.defaultValue,v!=null){if(d!=null)throw Error(t(92));if(Ht(v)){if(1<v.length)throw Error(t(93));v=v[0]}d=v}d==null&&(d=""),v=d}c._wrapperState={initialValue:me(v)}}function nn(c,d){var v=me(d.value),b=me(d.defaultValue);v!=null&&(v=""+v,v!==c.value&&(c.value=v),d.defaultValue==null&&c.defaultValue!==v&&(c.defaultValue=v)),b!=null&&(c.defaultValue=""+b)}function pn(c){var d=c.textContent;d===c._wrapperState.initialValue&&d!==""&&d!==null&&(c.value=d)}function Un(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function q(c,d){return c==null||c==="http://www.w3.org/1999/xhtml"?Un(d):c==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var N,F=function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,v,b,k){MSApp.execUnsafeLocalFunction(function(){return c(d,v,b,k)})}:c}(function(c,d){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=d;else{for(N=N||document.createElement("div"),N.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=N.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;d.firstChild;)c.appendChild(d.firstChild)}});function te(c,d){if(d){var v=c.firstChild;if(v&&v===c.lastChild&&v.nodeType===3){v.nodeValue=d;return}}c.textContent=d}var Ce={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pe=["Webkit","ms","Moz","O"];Object.keys(Ce).forEach(function(c){Pe.forEach(function(d){d=d+c.charAt(0).toUpperCase()+c.substring(1),Ce[d]=Ce[c]})});function Ge(c,d,v){return d==null||typeof d=="boolean"||d===""?"":v||typeof d!="number"||d===0||Ce.hasOwnProperty(c)&&Ce[c]?(""+d).trim():d+"px"}function Lt(c,d){c=c.style;for(var v in d)if(d.hasOwnProperty(v)){var b=v.indexOf("--")===0,k=Ge(v,d[v],b);v==="float"&&(v="cssFloat"),b?c.setProperty(v,k):c[v]=k}}var fn=ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hn(c,d){if(d){if(fn[c]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function yn(c,d){if(c.indexOf("-")===-1)return typeof d.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var un=null;function On(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Sr=null,mr=null,Qt=null;function Yr(c){if(c=Qu(c)){if(typeof Sr!="function")throw Error(t(280));var d=c.stateNode;d&&(d=Ff(d),Sr(c.stateNode,c.type,d))}}function Qe(c){mr?Qt?Qt.push(c):Qt=[c]:mr=c}function kn(){if(mr){var c=mr,d=Qt;if(Qt=mr=null,Yr(c),d)for(c=0;c<d.length;c++)Yr(d[c])}}function zt(c,d){return c(d)}function dr(){}var Kn=!1;function Qr(c,d,v){if(Kn)return c(d,v);Kn=!0;try{return zt(c,d,v)}finally{Kn=!1,(mr!==null||Qt!==null)&&(dr(),kn())}}function Br(c,d){var v=c.stateNode;if(v===null)return null;var b=Ff(v);if(b===null)return null;v=b[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(c=c.type,b=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!b;break e;default:c=!1}if(c)return null;if(v&&typeof v!="function")throw Error(t(231,d,typeof v));return v}var ge=!1;if(s)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){ge=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch{ge=!1}function J(c,d,v,b,k,B,$,ue,be){var Le=Array.prototype.slice.call(arguments,3);try{d.apply(v,Le)}catch(nt){this.onError(nt)}}var Ve=!1,rt=null,_t=!1,Bt=null,pt={onError:function(c){Ve=!0,rt=c}};function gt(c,d,v,b,k,B,$,ue,be){Ve=!1,rt=null,J.apply(pt,arguments)}function bt(c,d,v,b,k,B,$,ue,be){if(gt.apply(this,arguments),Ve){if(Ve){var Le=rt;Ve=!1,rt=null}else throw Error(t(198));_t||(_t=!0,Bt=Le)}}function Fe(c){var d=c,v=c;if(c.alternate)for(;d.return;)d=d.return;else{c=d;do d=c,(d.flags&4098)!==0&&(v=d.return),c=d.return;while(c)}return d.tag===3?v:null}function ut(c){if(c.tag===13){var d=c.memoizedState;if(d===null&&(c=c.alternate,c!==null&&(d=c.memoizedState)),d!==null)return d.dehydrated}return null}function He(c){if(Fe(c)!==c)throw Error(t(188))}function Cn(c){var d=c.alternate;if(!d){if(d=Fe(c),d===null)throw Error(t(188));return d!==c?null:c}for(var v=c,b=d;;){var k=v.return;if(k===null)break;var B=k.alternate;if(B===null){if(b=k.return,b!==null){v=b;continue}break}if(k.child===B.child){for(B=k.child;B;){if(B===v)return He(k),c;if(B===b)return He(k),d;B=B.sibling}throw Error(t(188))}if(v.return!==b.return)v=k,b=B;else{for(var $=!1,ue=k.child;ue;){if(ue===v){$=!0,v=k,b=B;break}if(ue===b){$=!0,b=k,v=B;break}ue=ue.sibling}if(!$){for(ue=B.child;ue;){if(ue===v){$=!0,v=B,b=k;break}if(ue===b){$=!0,b=B,v=k;break}ue=ue.sibling}if(!$)throw Error(t(189))}}if(v.alternate!==b)throw Error(t(190))}if(v.tag!==3)throw Error(t(188));return v.stateNode.current===v?c:d}function st(c){return c=Cn(c),c!==null?de(c):null}function de(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var d=de(c);if(d!==null)return d;c=c.sibling}return null}var Xe=e.unstable_scheduleCallback,It=e.unstable_cancelCallback,xn=e.unstable_shouldYield,Ot=e.unstable_requestPaint,wt=e.unstable_now,Wt=e.unstable_getCurrentPriorityLevel,qn=e.unstable_ImmediatePriority,Yn=e.unstable_UserBlockingPriority,tr=e.unstable_NormalPriority,Nn=e.unstable_LowPriority,tn=e.unstable_IdlePriority,gn=null,nr=null;function ui(c){if(nr&&typeof nr.onCommitFiberRoot=="function")try{nr.onCommitFiberRoot(gn,c,void 0,(c.current.flags&128)===128)}catch{}}var mn=Math.clz32?Math.clz32:Mo,jr=Math.log,At=Math.LN2;function Mo(c){return c>>>=0,c===0?32:31-(jr(c)/At|0)|0}var Wi=64,Hi=4194304;function kt(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function rn(c,d){var v=c.pendingLanes;if(v===0)return 0;var b=0,k=c.suspendedLanes,B=c.pingedLanes,$=v&268435455;if($!==0){var ue=$&~k;ue!==0?b=kt(ue):(B&=$,B!==0&&(b=kt(B)))}else $=v&~k,$!==0?b=kt($):B!==0&&(b=kt(B));if(b===0)return 0;if(d!==0&&d!==b&&(d&k)===0&&(k=b&-b,B=d&-d,k>=B||k===16&&(B&4194240)!==0))return d;if((b&4)!==0&&(b|=v&16),d=c.entangledLanes,d!==0)for(c=c.entanglements,d&=b;0<d;)v=31-mn(d),k=1<<v,b|=c[v],d&=~k;return b}function D(c,d){switch(c){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function V(c,d){for(var v=c.suspendedLanes,b=c.pingedLanes,k=c.expirationTimes,B=c.pendingLanes;0<B;){var $=31-mn(B),ue=1<<$,be=k[$];be===-1?((ue&v)===0||(ue&b)!==0)&&(k[$]=D(ue,d)):be<=d&&(c.expiredLanes|=ue),B&=~ue}}function Q(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function ie(){var c=Wi;return Wi<<=1,(Wi&4194240)===0&&(Wi=64),c}function Be(c){for(var d=[],v=0;31>v;v++)d.push(c);return d}function Te(c,d,v){c.pendingLanes|=d,d!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,d=31-mn(d),c[d]=v}function We(c,d){var v=c.pendingLanes&~d;c.pendingLanes=d,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=d,c.mutableReadLanes&=d,c.entangledLanes&=d,d=c.entanglements;var b=c.eventTimes;for(c=c.expirationTimes;0<v;){var k=31-mn(v),B=1<<k;d[k]=0,b[k]=-1,c[k]=-1,v&=~B}}function dt(c,d){var v=c.entangledLanes|=d;for(c=c.entanglements;v;){var b=31-mn(v),k=1<<b;k&d|c[b]&d&&(c[b]|=d),v&=~k}}var mt=0;function Kt(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var sn,Fn,Ci,xi,Jr,bi=!1,Ii=[],vr=null,ei=null,Qn=null,Gr=new Map,fo=new Map,ho=[],sa="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function po(c,d){switch(c){case"focusin":case"focusout":vr=null;break;case"dragenter":case"dragleave":ei=null;break;case"mouseover":case"mouseout":Qn=null;break;case"pointerover":case"pointerout":Gr.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":fo.delete(d.pointerId)}}function aa(c,d,v,b,k,B){return c===null||c.nativeEvent!==B?(c={blockedOn:d,domEventName:v,eventSystemFlags:b,nativeEvent:B,targetContainers:[k]},d!==null&&(d=Qu(d),d!==null&&Fn(d)),c):(c.eventSystemFlags|=b,d=c.targetContainers,k!==null&&d.indexOf(k)===-1&&d.push(k),c)}function zu(c,d,v,b,k){switch(d){case"focusin":return vr=aa(vr,c,d,v,b,k),!0;case"dragenter":return ei=aa(ei,c,d,v,b,k),!0;case"mouseover":return Qn=aa(Qn,c,d,v,b,k),!0;case"pointerover":var B=k.pointerId;return Gr.set(B,aa(Gr.get(B)||null,c,d,v,b,k)),!0;case"gotpointercapture":return B=k.pointerId,fo.set(B,aa(fo.get(B)||null,c,d,v,b,k)),!0}return!1}function Zi(c){var d=Vc(c.target);if(d!==null){var v=Fe(d);if(v!==null){if(d=v.tag,d===13){if(d=ut(v),d!==null){c.blockedOn=d,Jr(c.priority,function(){Ci(v)});return}}else if(d===3&&v.stateNode.current.memoizedState.isDehydrated){c.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Ko(c){if(c.blockedOn!==null)return!1;for(var d=c.targetContainers;0<d.length;){var v=Ds(c.domEventName,c.eventSystemFlags,d[0],c.nativeEvent);if(v===null){v=c.nativeEvent;var b=new v.constructor(v.type,v);un=b,v.target.dispatchEvent(b),un=null}else return d=Qu(v),d!==null&&Fn(d),c.blockedOn=v,!1;d.shift()}return!0}function ca(c,d,v){Ko(c)&&v.delete(d)}function Ln(){bi=!1,vr!==null&&Ko(vr)&&(vr=null),ei!==null&&Ko(ei)&&(ei=null),Qn!==null&&Ko(Qn)&&(Qn=null),Gr.forEach(ca),fo.forEach(ca)}function yr(c,d){c.blockedOn===d&&(c.blockedOn=null,bi||(bi=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ln)))}function Ct(c){function d(k){return yr(k,c)}if(0<Ii.length){yr(Ii[0],c);for(var v=1;v<Ii.length;v++){var b=Ii[v];b.blockedOn===c&&(b.blockedOn=null)}}for(vr!==null&&yr(vr,c),ei!==null&&yr(ei,c),Qn!==null&&yr(Qn,c),Gr.forEach(d),fo.forEach(d),v=0;v<ho.length;v++)b=ho[v],b.blockedOn===c&&(b.blockedOn=null);for(;0<ho.length&&(v=ho[0],v.blockedOn===null);)Zi(v),v.blockedOn===null&&ho.shift()}var di=_.ReactCurrentBatchConfig,rr=!0;function fi(c,d,v,b){var k=mt,B=di.transition;di.transition=null;try{mt=1,la(c,d,v,b)}finally{mt=k,di.transition=B}}function Xi(c,d,v,b){var k=mt,B=di.transition;di.transition=null;try{mt=4,la(c,d,v,b)}finally{mt=k,di.transition=B}}function la(c,d,v,b){if(rr){var k=Ds(c,d,v,b);if(k===null)fg(c,d,b,No,v),po(c,b);else if(zu(k,c,d,v,b))b.stopPropagation();else if(po(c,b),d&4&&-1<sa.indexOf(c)){for(;k!==null;){var B=Qu(k);if(B!==null&&sn(B),B=Ds(c,d,v,b),B===null&&fg(c,d,b,No,v),B===k)break;k=B}k!==null&&b.stopPropagation()}else fg(c,d,b,null,v)}}var No=null;function Ds(c,d,v,b){if(No=null,c=On(b),c=Vc(c),c!==null)if(d=Fe(c),d===null)c=null;else if(v=d.tag,v===13){if(c=ut(d),c!==null)return c;c=null}else if(v===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;c=null}else d!==c&&(c=null);return No=c,null}function Ua(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wt()){case qn:return 1;case Yn:return 4;case tr:case Nn:return 16;case tn:return 536870912;default:return 16}default:return 16}}var Vn=null,cn=null,Vr=null;function Nl(){if(Vr)return Vr;var c,d=cn,v=d.length,b,k="value"in Vn?Vn.value:Vn.textContent,B=k.length;for(c=0;c<v&&d[c]===k[c];c++);var $=v-c;for(b=1;b<=$&&d[v-b]===k[B-b];b++);return Vr=k.slice(c,1<b?1-b:void 0)}function qo(c){var d=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&d===13&&(c=13)):c=d,c===10&&(c=13),32<=c||c===13?c:0}function ua(){return!0}function da(){return!1}function zr(c){function d(v,b,k,B,$){this._reactName=v,this._targetInst=k,this.type=b,this.nativeEvent=B,this.target=$,this.currentTarget=null;for(var ue in c)c.hasOwnProperty(ue)&&(v=c[ue],this[ue]=v?v(B):B[ue]);return this.isDefaultPrevented=(B.defaultPrevented!=null?B.defaultPrevented:B.returnValue===!1)?ua:da,this.isPropagationStopped=da,this}return ke(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=ua)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=ua)},persist:function(){},isPersistent:ua}),d}var Bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},go=zr(Bo),mo=ke({},Bo,{view:0,detail:0}),Oc=zr(mo),Ms,Yo,Oo,Ns=ke({},mo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cr,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Oo&&(Oo&&c.type==="mousemove"?(Ms=c.screenX-Oo.screenX,Yo=c.screenY-Oo.screenY):Yo=Ms=0,Oo=c),Ms)},movementY:function(c){return"movementY"in c?c.movementY:Yo}}),Fc=zr(Ns),ja=ke({},Ns,{dataTransfer:0}),Lc=zr(ja),Wr=ke({},mo,{relatedTarget:0}),Ar=zr(Wr),Uc=ke({},Bo,{animationName:0,elapsedTime:0,pseudoElement:0}),Wu=zr(Uc),Bl=ke({},Bo,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),Ga=zr(Bl),Va=ke({},Bo,{data:0}),Fo=zr(Va),Bs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},za={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ol={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jc(c){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(c):(c=Ol[c])?!!d[c]:!1}function Cr(){return jc}var Gc=ke({},mo,{key:function(c){if(c.key){var d=Bs[c.key]||c.key;if(d!=="Unidentified")return d}return c.type==="keypress"?(c=qo(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?za[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cr,charCode:function(c){return c.type==="keypress"?qo(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?qo(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),vo=zr(Gc),R=ke({},Ns,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z=zr(R),Y=ke({},mo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cr}),re=zr(Y),Me=ke({},Bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Re=zr(Me),Ke=ke({},Ns,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),et=zr(Ke),$t=[9,13,27,32],ln=s&&"CompositionEvent"in window,Zt=null;s&&"documentMode"in document&&(Zt=document.documentMode);var jn=s&&"TextEvent"in window&&!Zt,xr=s&&(!ln||Zt&&8<Zt&&11>=Zt),wi=" ",Si=!1;function $i(c,d){switch(c){case"keyup":return $t.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wa(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Mi=!1;function Fl(c,d){switch(c){case"compositionend":return Wa(d);case"keypress":return d.which!==32?null:(Si=!0,wi);case"textInput":return c=d.data,c===wi&&Si?null:c;default:return null}}function rg(c,d){if(Mi)return c==="compositionend"||!ln&&$i(c,d)?(c=Nl(),Vr=cn=Vn=null,Mi=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return xr&&d.locale!=="ko"?null:d.data;default:return null}}var ig={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function u(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d==="input"?!!ig[c.type]:d==="textarea"}function p(c,d,v,b){Qe(b),d=Nf(d,"onChange"),0<d.length&&(v=new go("onChange","change",null,v,b),c.push({event:v,listeners:d}))}var I=null,U=null;function W(c){G1(c,0)}function se(c){var d=zl(c);if(Et(d))return c}function fe(c,d){if(c==="change")return d}var $e=!1;if(s){var qe;if(s){var vt="oninput"in document;if(!vt){var br=document.createElement("div");br.setAttribute("oninput","return;"),vt=typeof br.oninput=="function"}qe=vt}else qe=!1;$e=qe&&(!document.documentMode||9<document.documentMode)}function Lo(){I&&(I.detachEvent("onpropertychange",Ll),U=I=null)}function Ll(c){if(c.propertyName==="value"&&se(U)){var d=[];p(d,U,c,On(c)),Qr(W,d)}}function Hu(c,d,v){c==="focusin"?(Lo(),I=d,U=v,I.attachEvent("onpropertychange",Ll)):c==="focusout"&&Lo()}function pR(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return se(U)}function gR(c,d){if(c==="click")return se(d)}function mR(c,d){if(c==="input"||c==="change")return se(d)}function vR(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var Qo=typeof Object.is=="function"?Object.is:vR;function Zu(c,d){if(Qo(c,d))return!0;if(typeof c!="object"||c===null||typeof d!="object"||d===null)return!1;var v=Object.keys(c),b=Object.keys(d);if(v.length!==b.length)return!1;for(b=0;b<v.length;b++){var k=v[b];if(!l.call(d,k)||!Qo(c[k],d[k]))return!1}return!0}function T1(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function _1(c,d){var v=T1(c);c=0;for(var b;v;){if(v.nodeType===3){if(b=c+v.textContent.length,c<=d&&b>=d)return{node:v,offset:d-c};c=b}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=T1(v)}}function R1(c,d){return c&&d?c===d?!0:c&&c.nodeType===3?!1:d&&d.nodeType===3?R1(c,d.parentNode):"contains"in c?c.contains(d):c.compareDocumentPosition?!!(c.compareDocumentPosition(d)&16):!1:!1}function P1(){for(var c=window,d=St();d instanceof c.HTMLIFrameElement;){try{var v=typeof d.contentWindow.location.href=="string"}catch{v=!1}if(v)c=d.contentWindow;else break;d=St(c.document)}return d}function og(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d&&(d==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||d==="textarea"||c.contentEditable==="true")}function yR(c){var d=P1(),v=c.focusedElem,b=c.selectionRange;if(d!==v&&v&&v.ownerDocument&&R1(v.ownerDocument.documentElement,v)){if(b!==null&&og(v)){if(d=b.start,c=b.end,c===void 0&&(c=d),"selectionStart"in v)v.selectionStart=d,v.selectionEnd=Math.min(c,v.value.length);else if(c=(d=v.ownerDocument||document)&&d.defaultView||window,c.getSelection){c=c.getSelection();var k=v.textContent.length,B=Math.min(b.start,k);b=b.end===void 0?B:Math.min(b.end,k),!c.extend&&B>b&&(k=b,b=B,B=k),k=_1(v,B);var $=_1(v,b);k&&$&&(c.rangeCount!==1||c.anchorNode!==k.node||c.anchorOffset!==k.offset||c.focusNode!==$.node||c.focusOffset!==$.offset)&&(d=d.createRange(),d.setStart(k.node,k.offset),c.removeAllRanges(),B>b?(c.addRange(d),c.extend($.node,$.offset)):(d.setEnd($.node,$.offset),c.addRange(d)))}}for(d=[],c=v;c=c.parentNode;)c.nodeType===1&&d.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<d.length;v++)c=d[v],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var CR=s&&"documentMode"in document&&11>=document.documentMode,Ul=null,sg=null,Xu=null,ag=!1;function D1(c,d,v){var b=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;ag||Ul==null||Ul!==St(b)||(b=Ul,"selectionStart"in b&&og(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),Xu&&Zu(Xu,b)||(Xu=b,b=Nf(sg,"onSelect"),0<b.length&&(d=new go("onSelect","select",null,d,v),c.push({event:d,listeners:b}),d.target=Ul)))}function Pf(c,d){var v={};return v[c.toLowerCase()]=d.toLowerCase(),v["Webkit"+c]="webkit"+d,v["Moz"+c]="moz"+d,v}var jl={animationend:Pf("Animation","AnimationEnd"),animationiteration:Pf("Animation","AnimationIteration"),animationstart:Pf("Animation","AnimationStart"),transitionend:Pf("Transition","TransitionEnd")},cg={},M1={};s&&(M1=document.createElement("div").style,"AnimationEvent"in window||(delete jl.animationend.animation,delete jl.animationiteration.animation,delete jl.animationstart.animation),"TransitionEvent"in window||delete jl.transitionend.transition);function Df(c){if(cg[c])return cg[c];if(!jl[c])return c;var d=jl[c],v;for(v in d)if(d.hasOwnProperty(v)&&v in M1)return cg[c]=d[v];return c}var N1=Df("animationend"),B1=Df("animationiteration"),O1=Df("animationstart"),F1=Df("transitionend"),L1=new Map,U1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ha(c,d){L1.set(c,d),o(d,[c])}for(var lg=0;lg<U1.length;lg++){var ug=U1[lg],xR=ug.toLowerCase(),bR=ug[0].toUpperCase()+ug.slice(1);Ha(xR,"on"+bR)}Ha(N1,"onAnimationEnd"),Ha(B1,"onAnimationIteration"),Ha(O1,"onAnimationStart"),Ha("dblclick","onDoubleClick"),Ha("focusin","onFocus"),Ha("focusout","onBlur"),Ha(F1,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IR=new Set("cancel close invalid load scroll toggle".split(" ").concat($u));function j1(c,d,v){var b=c.type||"unknown-event";c.currentTarget=v,bt(b,d,void 0,c),c.currentTarget=null}function G1(c,d){d=(d&4)!==0;for(var v=0;v<c.length;v++){var b=c[v],k=b.event;b=b.listeners;e:{var B=void 0;if(d)for(var $=b.length-1;0<=$;$--){var ue=b[$],be=ue.instance,Le=ue.currentTarget;if(ue=ue.listener,be!==B&&k.isPropagationStopped())break e;j1(k,ue,Le),B=be}else for($=0;$<b.length;$++){if(ue=b[$],be=ue.instance,Le=ue.currentTarget,ue=ue.listener,be!==B&&k.isPropagationStopped())break e;j1(k,ue,Le),B=be}}}if(_t)throw c=Bt,_t=!1,Bt=null,c}function ir(c,d){var v=d[yg];v===void 0&&(v=d[yg]=new Set);var b=c+"__bubble";v.has(b)||(V1(d,c,2,!1),v.add(b))}function dg(c,d,v){var b=0;d&&(b|=4),V1(v,c,b,d)}var Mf="_reactListening"+Math.random().toString(36).slice(2);function Ku(c){if(!c[Mf]){c[Mf]=!0,r.forEach(function(v){v!=="selectionchange"&&(IR.has(v)||dg(v,!1,c),dg(v,!0,c))});var d=c.nodeType===9?c:c.ownerDocument;d===null||d[Mf]||(d[Mf]=!0,dg("selectionchange",!1,d))}}function V1(c,d,v,b){switch(Ua(d)){case 1:var k=fi;break;case 4:k=Xi;break;default:k=la}v=k.bind(null,d,v,c),k=void 0,!ge||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(k=!0),b?k!==void 0?c.addEventListener(d,v,{capture:!0,passive:k}):c.addEventListener(d,v,!0):k!==void 0?c.addEventListener(d,v,{passive:k}):c.addEventListener(d,v,!1)}function fg(c,d,v,b,k){var B=b;if((d&1)===0&&(d&2)===0&&b!==null)e:for(;;){if(b===null)return;var $=b.tag;if($===3||$===4){var ue=b.stateNode.containerInfo;if(ue===k||ue.nodeType===8&&ue.parentNode===k)break;if($===4)for($=b.return;$!==null;){var be=$.tag;if((be===3||be===4)&&(be=$.stateNode.containerInfo,be===k||be.nodeType===8&&be.parentNode===k))return;$=$.return}for(;ue!==null;){if($=Vc(ue),$===null)return;if(be=$.tag,be===5||be===6){b=B=$;continue e}ue=ue.parentNode}}b=b.return}Qr(function(){var Le=B,nt=On(v),ot=[];e:{var tt=L1.get(c);if(tt!==void 0){var Rt=go,Ft=c;switch(c){case"keypress":if(qo(v)===0)break e;case"keydown":case"keyup":Rt=vo;break;case"focusin":Ft="focus",Rt=Ar;break;case"focusout":Ft="blur",Rt=Ar;break;case"beforeblur":case"afterblur":Rt=Ar;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Rt=Fc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Rt=Lc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Rt=re;break;case N1:case B1:case O1:Rt=Wu;break;case F1:Rt=Re;break;case"scroll":Rt=Oc;break;case"wheel":Rt=et;break;case"copy":case"cut":case"paste":Rt=Ga;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Rt=z}var Ut=(d&4)!==0,Pr=!Ut&&c==="scroll",De=Ut?tt!==null?tt+"Capture":null:tt;Ut=[];for(var we=Le,Oe;we!==null;){Oe=we;var ft=Oe.stateNode;if(Oe.tag===5&&ft!==null&&(Oe=ft,De!==null&&(ft=Br(we,De),ft!=null&&Ut.push(qu(we,ft,Oe)))),Pr)break;we=we.return}0<Ut.length&&(tt=new Rt(tt,Ft,null,v,nt),ot.push({event:tt,listeners:Ut}))}}if((d&7)===0){e:{if(tt=c==="mouseover"||c==="pointerover",Rt=c==="mouseout"||c==="pointerout",tt&&v!==un&&(Ft=v.relatedTarget||v.fromElement)&&(Vc(Ft)||Ft[fa]))break e;if((Rt||tt)&&(tt=nt.window===nt?nt:(tt=nt.ownerDocument)?tt.defaultView||tt.parentWindow:window,Rt?(Ft=v.relatedTarget||v.toElement,Rt=Le,Ft=Ft?Vc(Ft):null,Ft!==null&&(Pr=Fe(Ft),Ft!==Pr||Ft.tag!==5&&Ft.tag!==6)&&(Ft=null)):(Rt=null,Ft=Le),Rt!==Ft)){if(Ut=Fc,ft="onMouseLeave",De="onMouseEnter",we="mouse",(c==="pointerout"||c==="pointerover")&&(Ut=z,ft="onPointerLeave",De="onPointerEnter",we="pointer"),Pr=Rt==null?tt:zl(Rt),Oe=Ft==null?tt:zl(Ft),tt=new Ut(ft,we+"leave",Rt,v,nt),tt.target=Pr,tt.relatedTarget=Oe,ft=null,Vc(nt)===Le&&(Ut=new Ut(De,we+"enter",Ft,v,nt),Ut.target=Oe,Ut.relatedTarget=Pr,ft=Ut),Pr=ft,Rt&&Ft)t:{for(Ut=Rt,De=Ft,we=0,Oe=Ut;Oe;Oe=Gl(Oe))we++;for(Oe=0,ft=De;ft;ft=Gl(ft))Oe++;for(;0<we-Oe;)Ut=Gl(Ut),we--;for(;0<Oe-we;)De=Gl(De),Oe--;for(;we--;){if(Ut===De||De!==null&&Ut===De.alternate)break t;Ut=Gl(Ut),De=Gl(De)}Ut=null}else Ut=null;Rt!==null&&z1(ot,tt,Rt,Ut,!1),Ft!==null&&Pr!==null&&z1(ot,Pr,Ft,Ut,!0)}}e:{if(tt=Le?zl(Le):window,Rt=tt.nodeName&&tt.nodeName.toLowerCase(),Rt==="select"||Rt==="input"&&tt.type==="file")var jt=fe;else if(u(tt))if($e)jt=mR;else{jt=pR;var qt=Hu}else(Rt=tt.nodeName)&&Rt.toLowerCase()==="input"&&(tt.type==="checkbox"||tt.type==="radio")&&(jt=gR);if(jt&&(jt=jt(c,Le))){p(ot,jt,v,nt);break e}qt&&qt(c,tt,Le),c==="focusout"&&(qt=tt._wrapperState)&&qt.controlled&&tt.type==="number"&&Pt(tt,"number",tt.value)}switch(qt=Le?zl(Le):window,c){case"focusin":(u(qt)||qt.contentEditable==="true")&&(Ul=qt,sg=Le,Xu=null);break;case"focusout":Xu=sg=Ul=null;break;case"mousedown":ag=!0;break;case"contextmenu":case"mouseup":case"dragend":ag=!1,D1(ot,v,nt);break;case"selectionchange":if(CR)break;case"keydown":case"keyup":D1(ot,v,nt)}var Yt;if(ln)e:{switch(c){case"compositionstart":var an="onCompositionStart";break e;case"compositionend":an="onCompositionEnd";break e;case"compositionupdate":an="onCompositionUpdate";break e}an=void 0}else Mi?$i(c,v)&&(an="onCompositionEnd"):c==="keydown"&&v.keyCode===229&&(an="onCompositionStart");an&&(xr&&v.locale!=="ko"&&(Mi||an!=="onCompositionStart"?an==="onCompositionEnd"&&Mi&&(Yt=Nl()):(Vn=nt,cn="value"in Vn?Vn.value:Vn.textContent,Mi=!0)),qt=Nf(Le,an),0<qt.length&&(an=new Fo(an,c,null,v,nt),ot.push({event:an,listeners:qt}),Yt?an.data=Yt:(Yt=Wa(v),Yt!==null&&(an.data=Yt)))),(Yt=jn?Fl(c,v):rg(c,v))&&(Le=Nf(Le,"onBeforeInput"),0<Le.length&&(nt=new Fo("onBeforeInput","beforeinput",null,v,nt),ot.push({event:nt,listeners:Le}),nt.data=Yt))}G1(ot,d)})}function qu(c,d,v){return{instance:c,listener:d,currentTarget:v}}function Nf(c,d){for(var v=d+"Capture",b=[];c!==null;){var k=c,B=k.stateNode;k.tag===5&&B!==null&&(k=B,B=Br(c,v),B!=null&&b.unshift(qu(c,B,k)),B=Br(c,d),B!=null&&b.push(qu(c,B,k))),c=c.return}return b}function Gl(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function z1(c,d,v,b,k){for(var B=d._reactName,$=[];v!==null&&v!==b;){var ue=v,be=ue.alternate,Le=ue.stateNode;if(be!==null&&be===b)break;ue.tag===5&&Le!==null&&(ue=Le,k?(be=Br(v,B),be!=null&&$.unshift(qu(v,be,ue))):k||(be=Br(v,B),be!=null&&$.push(qu(v,be,ue)))),v=v.return}$.length!==0&&c.push({event:d,listeners:$})}var wR=/\r\n?/g,SR=/\u0000|\uFFFD/g;function W1(c){return(typeof c=="string"?c:""+c).replace(wR,`
`).replace(SR,"")}function Bf(c,d,v){if(d=W1(d),W1(c)!==d&&v)throw Error(t(425))}function Of(){}var hg=null,pg=null;function gg(c,d){return c==="textarea"||c==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var mg=typeof setTimeout=="function"?setTimeout:void 0,AR=typeof clearTimeout=="function"?clearTimeout:void 0,H1=typeof Promise=="function"?Promise:void 0,kR=typeof queueMicrotask=="function"?queueMicrotask:typeof H1<"u"?function(c){return H1.resolve(null).then(c).catch(ER)}:mg;function ER(c){setTimeout(function(){throw c})}function vg(c,d){var v=d,b=0;do{var k=v.nextSibling;if(c.removeChild(v),k&&k.nodeType===8)if(v=k.data,v==="/$"){if(b===0){c.removeChild(k),Ct(d);return}b--}else v!=="$"&&v!=="$?"&&v!=="$!"||b++;v=k}while(v);Ct(d)}function Za(c){for(;c!=null;c=c.nextSibling){var d=c.nodeType;if(d===1||d===3)break;if(d===8){if(d=c.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return c}function Z1(c){c=c.previousSibling;for(var d=0;c;){if(c.nodeType===8){var v=c.data;if(v==="$"||v==="$!"||v==="$?"){if(d===0)return c;d--}else v==="/$"&&d++}c=c.previousSibling}return null}var Vl=Math.random().toString(36).slice(2),Os="__reactFiber$"+Vl,Yu="__reactProps$"+Vl,fa="__reactContainer$"+Vl,yg="__reactEvents$"+Vl,TR="__reactListeners$"+Vl,_R="__reactHandles$"+Vl;function Vc(c){var d=c[Os];if(d)return d;for(var v=c.parentNode;v;){if(d=v[fa]||v[Os]){if(v=d.alternate,d.child!==null||v!==null&&v.child!==null)for(c=Z1(c);c!==null;){if(v=c[Os])return v;c=Z1(c)}return d}c=v,v=c.parentNode}return null}function Qu(c){return c=c[Os]||c[fa],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function zl(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function Ff(c){return c[Yu]||null}var Cg=[],Wl=-1;function Xa(c){return{current:c}}function or(c){0>Wl||(c.current=Cg[Wl],Cg[Wl]=null,Wl--)}function Jn(c,d){Wl++,Cg[Wl]=c.current,c.current=d}var $a={},Ai=Xa($a),Ki=Xa(!1),zc=$a;function Hl(c,d){var v=c.type.contextTypes;if(!v)return $a;var b=c.stateNode;if(b&&b.__reactInternalMemoizedUnmaskedChildContext===d)return b.__reactInternalMemoizedMaskedChildContext;var k={},B;for(B in v)k[B]=d[B];return b&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=d,c.__reactInternalMemoizedMaskedChildContext=k),k}function qi(c){return c=c.childContextTypes,c!=null}function Lf(){or(Ki),or(Ai)}function X1(c,d,v){if(Ai.current!==$a)throw Error(t(168));Jn(Ai,d),Jn(Ki,v)}function $1(c,d,v){var b=c.stateNode;if(d=d.childContextTypes,typeof b.getChildContext!="function")return v;b=b.getChildContext();for(var k in b)if(!(k in d))throw Error(t(108,Je(c)||"Unknown",k));return ke({},v,b)}function Uf(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||$a,zc=Ai.current,Jn(Ai,c),Jn(Ki,Ki.current),!0}function K1(c,d,v){var b=c.stateNode;if(!b)throw Error(t(169));v?(c=$1(c,d,zc),b.__reactInternalMemoizedMergedChildContext=c,or(Ki),or(Ai),Jn(Ai,c)):or(Ki),Jn(Ki,v)}var ha=null,jf=!1,xg=!1;function q1(c){ha===null?ha=[c]:ha.push(c)}function RR(c){jf=!0,q1(c)}function Ka(){if(!xg&&ha!==null){xg=!0;var c=0,d=mt;try{var v=ha;for(mt=1;c<v.length;c++){var b=v[c];do b=b(!0);while(b!==null)}ha=null,jf=!1}catch(k){throw ha!==null&&(ha=ha.slice(c+1)),Xe(qn,Ka),k}finally{mt=d,xg=!1}}return null}var Zl=[],Xl=0,Gf=null,Vf=0,Uo=[],jo=0,Wc=null,pa=1,ga="";function Hc(c,d){Zl[Xl++]=Vf,Zl[Xl++]=Gf,Gf=c,Vf=d}function Y1(c,d,v){Uo[jo++]=pa,Uo[jo++]=ga,Uo[jo++]=Wc,Wc=c;var b=pa;c=ga;var k=32-mn(b)-1;b&=~(1<<k),v+=1;var B=32-mn(d)+k;if(30<B){var $=k-k%5;B=(b&(1<<$)-1).toString(32),b>>=$,k-=$,pa=1<<32-mn(d)+k|v<<k|b,ga=B+c}else pa=1<<B|v<<k|b,ga=c}function bg(c){c.return!==null&&(Hc(c,1),Y1(c,1,0))}function Ig(c){for(;c===Gf;)Gf=Zl[--Xl],Zl[Xl]=null,Vf=Zl[--Xl],Zl[Xl]=null;for(;c===Wc;)Wc=Uo[--jo],Uo[jo]=null,ga=Uo[--jo],Uo[jo]=null,pa=Uo[--jo],Uo[jo]=null}var yo=null,Co=null,fr=!1,Jo=null;function Q1(c,d){var v=Wo(5,null,null,0);v.elementType="DELETED",v.stateNode=d,v.return=c,d=c.deletions,d===null?(c.deletions=[v],c.flags|=16):d.push(v)}function J1(c,d){switch(c.tag){case 5:var v=c.type;return d=d.nodeType!==1||v.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(c.stateNode=d,yo=c,Co=Za(d.firstChild),!0):!1;case 6:return d=c.pendingProps===""||d.nodeType!==3?null:d,d!==null?(c.stateNode=d,yo=c,Co=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(v=Wc!==null?{id:pa,overflow:ga}:null,c.memoizedState={dehydrated:d,treeContext:v,retryLane:1073741824},v=Wo(18,null,null,0),v.stateNode=d,v.return=c,c.child=v,yo=c,Co=null,!0):!1;default:return!1}}function wg(c){return(c.mode&1)!==0&&(c.flags&128)===0}function Sg(c){if(fr){var d=Co;if(d){var v=d;if(!J1(c,d)){if(wg(c))throw Error(t(418));d=Za(v.nextSibling);var b=yo;d&&J1(c,d)?Q1(b,v):(c.flags=c.flags&-4097|2,fr=!1,yo=c)}}else{if(wg(c))throw Error(t(418));c.flags=c.flags&-4097|2,fr=!1,yo=c}}}function ex(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;yo=c}function zf(c){if(c!==yo)return!1;if(!fr)return ex(c),fr=!0,!1;var d;if((d=c.tag!==3)&&!(d=c.tag!==5)&&(d=c.type,d=d!=="head"&&d!=="body"&&!gg(c.type,c.memoizedProps)),d&&(d=Co)){if(wg(c))throw tx(),Error(t(418));for(;d;)Q1(c,d),d=Za(d.nextSibling)}if(ex(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,d=0;c;){if(c.nodeType===8){var v=c.data;if(v==="/$"){if(d===0){Co=Za(c.nextSibling);break e}d--}else v!=="$"&&v!=="$!"&&v!=="$?"||d++}c=c.nextSibling}Co=null}}else Co=yo?Za(c.stateNode.nextSibling):null;return!0}function tx(){for(var c=Co;c;)c=Za(c.nextSibling)}function $l(){Co=yo=null,fr=!1}function Ag(c){Jo===null?Jo=[c]:Jo.push(c)}var PR=_.ReactCurrentBatchConfig;function Ju(c,d,v){if(c=v.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(v._owner){if(v=v._owner,v){if(v.tag!==1)throw Error(t(309));var b=v.stateNode}if(!b)throw Error(t(147,c));var k=b,B=""+c;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===B?d.ref:(d=function($){var ue=k.refs;$===null?delete ue[B]:ue[B]=$},d._stringRef=B,d)}if(typeof c!="string")throw Error(t(284));if(!v._owner)throw Error(t(290,c))}return c}function Wf(c,d){throw c=Object.prototype.toString.call(d),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":c))}function nx(c){var d=c._init;return d(c._payload)}function rx(c){function d(De,we){if(c){var Oe=De.deletions;Oe===null?(De.deletions=[we],De.flags|=16):Oe.push(we)}}function v(De,we){if(!c)return null;for(;we!==null;)d(De,we),we=we.sibling;return null}function b(De,we){for(De=new Map;we!==null;)we.key!==null?De.set(we.key,we):De.set(we.index,we),we=we.sibling;return De}function k(De,we){return De=rc(De,we),De.index=0,De.sibling=null,De}function B(De,we,Oe){return De.index=Oe,c?(Oe=De.alternate,Oe!==null?(Oe=Oe.index,Oe<we?(De.flags|=2,we):Oe):(De.flags|=2,we)):(De.flags|=1048576,we)}function $(De){return c&&De.alternate===null&&(De.flags|=2),De}function ue(De,we,Oe,ft){return we===null||we.tag!==6?(we=mm(Oe,De.mode,ft),we.return=De,we):(we=k(we,Oe),we.return=De,we)}function be(De,we,Oe,ft){var jt=Oe.type;return jt===P?nt(De,we,Oe.props.children,ft,Oe.key):we!==null&&(we.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Se&&nx(jt)===we.type)?(ft=k(we,Oe.props),ft.ref=Ju(De,we,Oe),ft.return=De,ft):(ft=ph(Oe.type,Oe.key,Oe.props,null,De.mode,ft),ft.ref=Ju(De,we,Oe),ft.return=De,ft)}function Le(De,we,Oe,ft){return we===null||we.tag!==4||we.stateNode.containerInfo!==Oe.containerInfo||we.stateNode.implementation!==Oe.implementation?(we=vm(Oe,De.mode,ft),we.return=De,we):(we=k(we,Oe.children||[]),we.return=De,we)}function nt(De,we,Oe,ft,jt){return we===null||we.tag!==7?(we=Jc(Oe,De.mode,ft,jt),we.return=De,we):(we=k(we,Oe),we.return=De,we)}function ot(De,we,Oe){if(typeof we=="string"&&we!==""||typeof we=="number")return we=mm(""+we,De.mode,Oe),we.return=De,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case T:return Oe=ph(we.type,we.key,we.props,null,De.mode,Oe),Oe.ref=Ju(De,null,we),Oe.return=De,Oe;case M:return we=vm(we,De.mode,Oe),we.return=De,we;case Se:var ft=we._init;return ot(De,ft(we._payload),Oe)}if(Ht(we)||Ae(we))return we=Jc(we,De.mode,Oe,null),we.return=De,we;Wf(De,we)}return null}function tt(De,we,Oe,ft){var jt=we!==null?we.key:null;if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number")return jt!==null?null:ue(De,we,""+Oe,ft);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case T:return Oe.key===jt?be(De,we,Oe,ft):null;case M:return Oe.key===jt?Le(De,we,Oe,ft):null;case Se:return jt=Oe._init,tt(De,we,jt(Oe._payload),ft)}if(Ht(Oe)||Ae(Oe))return jt!==null?null:nt(De,we,Oe,ft,null);Wf(De,Oe)}return null}function Rt(De,we,Oe,ft,jt){if(typeof ft=="string"&&ft!==""||typeof ft=="number")return De=De.get(Oe)||null,ue(we,De,""+ft,jt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case T:return De=De.get(ft.key===null?Oe:ft.key)||null,be(we,De,ft,jt);case M:return De=De.get(ft.key===null?Oe:ft.key)||null,Le(we,De,ft,jt);case Se:var qt=ft._init;return Rt(De,we,Oe,qt(ft._payload),jt)}if(Ht(ft)||Ae(ft))return De=De.get(Oe)||null,nt(we,De,ft,jt,null);Wf(we,ft)}return null}function Ft(De,we,Oe,ft){for(var jt=null,qt=null,Yt=we,an=we=0,ri=null;Yt!==null&&an<Oe.length;an++){Yt.index>an?(ri=Yt,Yt=null):ri=Yt.sibling;var Bn=tt(De,Yt,Oe[an],ft);if(Bn===null){Yt===null&&(Yt=ri);break}c&&Yt&&Bn.alternate===null&&d(De,Yt),we=B(Bn,we,an),qt===null?jt=Bn:qt.sibling=Bn,qt=Bn,Yt=ri}if(an===Oe.length)return v(De,Yt),fr&&Hc(De,an),jt;if(Yt===null){for(;an<Oe.length;an++)Yt=ot(De,Oe[an],ft),Yt!==null&&(we=B(Yt,we,an),qt===null?jt=Yt:qt.sibling=Yt,qt=Yt);return fr&&Hc(De,an),jt}for(Yt=b(De,Yt);an<Oe.length;an++)ri=Rt(Yt,De,an,Oe[an],ft),ri!==null&&(c&&ri.alternate!==null&&Yt.delete(ri.key===null?an:ri.key),we=B(ri,we,an),qt===null?jt=ri:qt.sibling=ri,qt=ri);return c&&Yt.forEach(function(ic){return d(De,ic)}),fr&&Hc(De,an),jt}function Ut(De,we,Oe,ft){var jt=Ae(Oe);if(typeof jt!="function")throw Error(t(150));if(Oe=jt.call(Oe),Oe==null)throw Error(t(151));for(var qt=jt=null,Yt=we,an=we=0,ri=null,Bn=Oe.next();Yt!==null&&!Bn.done;an++,Bn=Oe.next()){Yt.index>an?(ri=Yt,Yt=null):ri=Yt.sibling;var ic=tt(De,Yt,Bn.value,ft);if(ic===null){Yt===null&&(Yt=ri);break}c&&Yt&&ic.alternate===null&&d(De,Yt),we=B(ic,we,an),qt===null?jt=ic:qt.sibling=ic,qt=ic,Yt=ri}if(Bn.done)return v(De,Yt),fr&&Hc(De,an),jt;if(Yt===null){for(;!Bn.done;an++,Bn=Oe.next())Bn=ot(De,Bn.value,ft),Bn!==null&&(we=B(Bn,we,an),qt===null?jt=Bn:qt.sibling=Bn,qt=Bn);return fr&&Hc(De,an),jt}for(Yt=b(De,Yt);!Bn.done;an++,Bn=Oe.next())Bn=Rt(Yt,De,an,Bn.value,ft),Bn!==null&&(c&&Bn.alternate!==null&&Yt.delete(Bn.key===null?an:Bn.key),we=B(Bn,we,an),qt===null?jt=Bn:qt.sibling=Bn,qt=Bn);return c&&Yt.forEach(function(uP){return d(De,uP)}),fr&&Hc(De,an),jt}function Pr(De,we,Oe,ft){if(typeof Oe=="object"&&Oe!==null&&Oe.type===P&&Oe.key===null&&(Oe=Oe.props.children),typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case T:e:{for(var jt=Oe.key,qt=we;qt!==null;){if(qt.key===jt){if(jt=Oe.type,jt===P){if(qt.tag===7){v(De,qt.sibling),we=k(qt,Oe.props.children),we.return=De,De=we;break e}}else if(qt.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Se&&nx(jt)===qt.type){v(De,qt.sibling),we=k(qt,Oe.props),we.ref=Ju(De,qt,Oe),we.return=De,De=we;break e}v(De,qt);break}else d(De,qt);qt=qt.sibling}Oe.type===P?(we=Jc(Oe.props.children,De.mode,ft,Oe.key),we.return=De,De=we):(ft=ph(Oe.type,Oe.key,Oe.props,null,De.mode,ft),ft.ref=Ju(De,we,Oe),ft.return=De,De=ft)}return $(De);case M:e:{for(qt=Oe.key;we!==null;){if(we.key===qt)if(we.tag===4&&we.stateNode.containerInfo===Oe.containerInfo&&we.stateNode.implementation===Oe.implementation){v(De,we.sibling),we=k(we,Oe.children||[]),we.return=De,De=we;break e}else{v(De,we);break}else d(De,we);we=we.sibling}we=vm(Oe,De.mode,ft),we.return=De,De=we}return $(De);case Se:return qt=Oe._init,Pr(De,we,qt(Oe._payload),ft)}if(Ht(Oe))return Ft(De,we,Oe,ft);if(Ae(Oe))return Ut(De,we,Oe,ft);Wf(De,Oe)}return typeof Oe=="string"&&Oe!==""||typeof Oe=="number"?(Oe=""+Oe,we!==null&&we.tag===6?(v(De,we.sibling),we=k(we,Oe),we.return=De,De=we):(v(De,we),we=mm(Oe,De.mode,ft),we.return=De,De=we),$(De)):v(De,we)}return Pr}var Kl=rx(!0),ix=rx(!1),Hf=Xa(null),Zf=null,ql=null,kg=null;function Eg(){kg=ql=Zf=null}function Tg(c){var d=Hf.current;or(Hf),c._currentValue=d}function _g(c,d,v){for(;c!==null;){var b=c.alternate;if((c.childLanes&d)!==d?(c.childLanes|=d,b!==null&&(b.childLanes|=d)):b!==null&&(b.childLanes&d)!==d&&(b.childLanes|=d),c===v)break;c=c.return}}function Yl(c,d){Zf=c,kg=ql=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&d)!==0&&(Yi=!0),c.firstContext=null)}function Go(c){var d=c._currentValue;if(kg!==c)if(c={context:c,memoizedValue:d,next:null},ql===null){if(Zf===null)throw Error(t(308));ql=c,Zf.dependencies={lanes:0,firstContext:c}}else ql=ql.next=c;return d}var Zc=null;function Rg(c){Zc===null?Zc=[c]:Zc.push(c)}function ox(c,d,v,b){var k=d.interleaved;return k===null?(v.next=v,Rg(d)):(v.next=k.next,k.next=v),d.interleaved=v,ma(c,b)}function ma(c,d){c.lanes|=d;var v=c.alternate;for(v!==null&&(v.lanes|=d),v=c,c=c.return;c!==null;)c.childLanes|=d,v=c.alternate,v!==null&&(v.childLanes|=d),v=c,c=c.return;return v.tag===3?v.stateNode:null}var qa=!1;function Pg(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sx(c,d){c=c.updateQueue,d.updateQueue===c&&(d.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function va(c,d){return{eventTime:c,lane:d,tag:0,payload:null,callback:null,next:null}}function Ya(c,d,v){var b=c.updateQueue;if(b===null)return null;if(b=b.shared,(_n&2)!==0){var k=b.pending;return k===null?d.next=d:(d.next=k.next,k.next=d),b.pending=d,ma(c,v)}return k=b.interleaved,k===null?(d.next=d,Rg(b)):(d.next=k.next,k.next=d),b.interleaved=d,ma(c,v)}function Xf(c,d,v){if(d=d.updateQueue,d!==null&&(d=d.shared,(v&4194240)!==0)){var b=d.lanes;b&=c.pendingLanes,v|=b,d.lanes=v,dt(c,v)}}function ax(c,d){var v=c.updateQueue,b=c.alternate;if(b!==null&&(b=b.updateQueue,v===b)){var k=null,B=null;if(v=v.firstBaseUpdate,v!==null){do{var $={eventTime:v.eventTime,lane:v.lane,tag:v.tag,payload:v.payload,callback:v.callback,next:null};B===null?k=B=$:B=B.next=$,v=v.next}while(v!==null);B===null?k=B=d:B=B.next=d}else k=B=d;v={baseState:b.baseState,firstBaseUpdate:k,lastBaseUpdate:B,shared:b.shared,effects:b.effects},c.updateQueue=v;return}c=v.lastBaseUpdate,c===null?v.firstBaseUpdate=d:c.next=d,v.lastBaseUpdate=d}function $f(c,d,v,b){var k=c.updateQueue;qa=!1;var B=k.firstBaseUpdate,$=k.lastBaseUpdate,ue=k.shared.pending;if(ue!==null){k.shared.pending=null;var be=ue,Le=be.next;be.next=null,$===null?B=Le:$.next=Le,$=be;var nt=c.alternate;nt!==null&&(nt=nt.updateQueue,ue=nt.lastBaseUpdate,ue!==$&&(ue===null?nt.firstBaseUpdate=Le:ue.next=Le,nt.lastBaseUpdate=be))}if(B!==null){var ot=k.baseState;$=0,nt=Le=be=null,ue=B;do{var tt=ue.lane,Rt=ue.eventTime;if((b&tt)===tt){nt!==null&&(nt=nt.next={eventTime:Rt,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var Ft=c,Ut=ue;switch(tt=d,Rt=v,Ut.tag){case 1:if(Ft=Ut.payload,typeof Ft=="function"){ot=Ft.call(Rt,ot,tt);break e}ot=Ft;break e;case 3:Ft.flags=Ft.flags&-65537|128;case 0:if(Ft=Ut.payload,tt=typeof Ft=="function"?Ft.call(Rt,ot,tt):Ft,tt==null)break e;ot=ke({},ot,tt);break e;case 2:qa=!0}}ue.callback!==null&&ue.lane!==0&&(c.flags|=64,tt=k.effects,tt===null?k.effects=[ue]:tt.push(ue))}else Rt={eventTime:Rt,lane:tt,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},nt===null?(Le=nt=Rt,be=ot):nt=nt.next=Rt,$|=tt;if(ue=ue.next,ue===null){if(ue=k.shared.pending,ue===null)break;tt=ue,ue=tt.next,tt.next=null,k.lastBaseUpdate=tt,k.shared.pending=null}}while(!0);if(nt===null&&(be=ot),k.baseState=be,k.firstBaseUpdate=Le,k.lastBaseUpdate=nt,d=k.shared.interleaved,d!==null){k=d;do $|=k.lane,k=k.next;while(k!==d)}else B===null&&(k.shared.lanes=0);Kc|=$,c.lanes=$,c.memoizedState=ot}}function cx(c,d,v){if(c=d.effects,d.effects=null,c!==null)for(d=0;d<c.length;d++){var b=c[d],k=b.callback;if(k!==null){if(b.callback=null,b=v,typeof k!="function")throw Error(t(191,k));k.call(b)}}}var ed={},Fs=Xa(ed),td=Xa(ed),nd=Xa(ed);function Xc(c){if(c===ed)throw Error(t(174));return c}function Dg(c,d){switch(Jn(nd,d),Jn(td,c),Jn(Fs,ed),c=d.nodeType,c){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:q(null,"");break;default:c=c===8?d.parentNode:d,d=c.namespaceURI||null,c=c.tagName,d=q(d,c)}or(Fs),Jn(Fs,d)}function Ql(){or(Fs),or(td),or(nd)}function lx(c){Xc(nd.current);var d=Xc(Fs.current),v=q(d,c.type);d!==v&&(Jn(td,c),Jn(Fs,v))}function Mg(c){td.current===c&&(or(Fs),or(td))}var Ir=Xa(0);function Kf(c){for(var d=c;d!==null;){if(d.tag===13){var v=d.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||v.data==="$?"||v.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var Ng=[];function Bg(){for(var c=0;c<Ng.length;c++)Ng[c]._workInProgressVersionPrimary=null;Ng.length=0}var qf=_.ReactCurrentDispatcher,Og=_.ReactCurrentBatchConfig,$c=0,wr=null,Hr=null,ti=null,Yf=!1,rd=!1,id=0,DR=0;function ki(){throw Error(t(321))}function Fg(c,d){if(d===null)return!1;for(var v=0;v<d.length&&v<c.length;v++)if(!Qo(c[v],d[v]))return!1;return!0}function Lg(c,d,v,b,k,B){if($c=B,wr=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,qf.current=c===null||c.memoizedState===null?OR:FR,c=v(b,k),rd){B=0;do{if(rd=!1,id=0,25<=B)throw Error(t(301));B+=1,ti=Hr=null,d.updateQueue=null,qf.current=LR,c=v(b,k)}while(rd)}if(qf.current=eh,d=Hr!==null&&Hr.next!==null,$c=0,ti=Hr=wr=null,Yf=!1,d)throw Error(t(300));return c}function Ug(){var c=id!==0;return id=0,c}function Ls(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ti===null?wr.memoizedState=ti=c:ti=ti.next=c,ti}function Vo(){if(Hr===null){var c=wr.alternate;c=c!==null?c.memoizedState:null}else c=Hr.next;var d=ti===null?wr.memoizedState:ti.next;if(d!==null)ti=d,Hr=c;else{if(c===null)throw Error(t(310));Hr=c,c={memoizedState:Hr.memoizedState,baseState:Hr.baseState,baseQueue:Hr.baseQueue,queue:Hr.queue,next:null},ti===null?wr.memoizedState=ti=c:ti=ti.next=c}return ti}function od(c,d){return typeof d=="function"?d(c):d}function jg(c){var d=Vo(),v=d.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=c;var b=Hr,k=b.baseQueue,B=v.pending;if(B!==null){if(k!==null){var $=k.next;k.next=B.next,B.next=$}b.baseQueue=k=B,v.pending=null}if(k!==null){B=k.next,b=b.baseState;var ue=$=null,be=null,Le=B;do{var nt=Le.lane;if(($c&nt)===nt)be!==null&&(be=be.next={lane:0,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),b=Le.hasEagerState?Le.eagerState:c(b,Le.action);else{var ot={lane:nt,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null};be===null?(ue=be=ot,$=b):be=be.next=ot,wr.lanes|=nt,Kc|=nt}Le=Le.next}while(Le!==null&&Le!==B);be===null?$=b:be.next=ue,Qo(b,d.memoizedState)||(Yi=!0),d.memoizedState=b,d.baseState=$,d.baseQueue=be,v.lastRenderedState=b}if(c=v.interleaved,c!==null){k=c;do B=k.lane,wr.lanes|=B,Kc|=B,k=k.next;while(k!==c)}else k===null&&(v.lanes=0);return[d.memoizedState,v.dispatch]}function Gg(c){var d=Vo(),v=d.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=c;var b=v.dispatch,k=v.pending,B=d.memoizedState;if(k!==null){v.pending=null;var $=k=k.next;do B=c(B,$.action),$=$.next;while($!==k);Qo(B,d.memoizedState)||(Yi=!0),d.memoizedState=B,d.baseQueue===null&&(d.baseState=B),v.lastRenderedState=B}return[B,b]}function ux(){}function dx(c,d){var v=wr,b=Vo(),k=d(),B=!Qo(b.memoizedState,k);if(B&&(b.memoizedState=k,Yi=!0),b=b.queue,Vg(px.bind(null,v,b,c),[c]),b.getSnapshot!==d||B||ti!==null&&ti.memoizedState.tag&1){if(v.flags|=2048,sd(9,hx.bind(null,v,b,k,d),void 0,null),ni===null)throw Error(t(349));($c&30)!==0||fx(v,d,k)}return k}function fx(c,d,v){c.flags|=16384,c={getSnapshot:d,value:v},d=wr.updateQueue,d===null?(d={lastEffect:null,stores:null},wr.updateQueue=d,d.stores=[c]):(v=d.stores,v===null?d.stores=[c]:v.push(c))}function hx(c,d,v,b){d.value=v,d.getSnapshot=b,gx(d)&&mx(c)}function px(c,d,v){return v(function(){gx(d)&&mx(c)})}function gx(c){var d=c.getSnapshot;c=c.value;try{var v=d();return!Qo(c,v)}catch{return!0}}function mx(c){var d=ma(c,1);d!==null&&rs(d,c,1,-1)}function vx(c){var d=Ls();return typeof c=="function"&&(c=c()),d.memoizedState=d.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:od,lastRenderedState:c},d.queue=c,c=c.dispatch=BR.bind(null,wr,c),[d.memoizedState,c]}function sd(c,d,v,b){return c={tag:c,create:d,destroy:v,deps:b,next:null},d=wr.updateQueue,d===null?(d={lastEffect:null,stores:null},wr.updateQueue=d,d.lastEffect=c.next=c):(v=d.lastEffect,v===null?d.lastEffect=c.next=c:(b=v.next,v.next=c,c.next=b,d.lastEffect=c)),c}function yx(){return Vo().memoizedState}function Qf(c,d,v,b){var k=Ls();wr.flags|=c,k.memoizedState=sd(1|d,v,void 0,b===void 0?null:b)}function Jf(c,d,v,b){var k=Vo();b=b===void 0?null:b;var B=void 0;if(Hr!==null){var $=Hr.memoizedState;if(B=$.destroy,b!==null&&Fg(b,$.deps)){k.memoizedState=sd(d,v,B,b);return}}wr.flags|=c,k.memoizedState=sd(1|d,v,B,b)}function Cx(c,d){return Qf(8390656,8,c,d)}function Vg(c,d){return Jf(2048,8,c,d)}function xx(c,d){return Jf(4,2,c,d)}function bx(c,d){return Jf(4,4,c,d)}function Ix(c,d){if(typeof d=="function")return c=c(),d(c),function(){d(null)};if(d!=null)return c=c(),d.current=c,function(){d.current=null}}function wx(c,d,v){return v=v!=null?v.concat([c]):null,Jf(4,4,Ix.bind(null,d,c),v)}function zg(){}function Sx(c,d){var v=Vo();d=d===void 0?null:d;var b=v.memoizedState;return b!==null&&d!==null&&Fg(d,b[1])?b[0]:(v.memoizedState=[c,d],c)}function Ax(c,d){var v=Vo();d=d===void 0?null:d;var b=v.memoizedState;return b!==null&&d!==null&&Fg(d,b[1])?b[0]:(c=c(),v.memoizedState=[c,d],c)}function kx(c,d,v){return($c&21)===0?(c.baseState&&(c.baseState=!1,Yi=!0),c.memoizedState=v):(Qo(v,d)||(v=ie(),wr.lanes|=v,Kc|=v,c.baseState=!0),d)}function MR(c,d){var v=mt;mt=v!==0&&4>v?v:4,c(!0);var b=Og.transition;Og.transition={};try{c(!1),d()}finally{mt=v,Og.transition=b}}function Ex(){return Vo().memoizedState}function NR(c,d,v){var b=tc(c);if(v={lane:b,action:v,hasEagerState:!1,eagerState:null,next:null},Tx(c))_x(d,v);else if(v=ox(c,d,v,b),v!==null){var k=Bi();rs(v,c,b,k),Rx(v,d,b)}}function BR(c,d,v){var b=tc(c),k={lane:b,action:v,hasEagerState:!1,eagerState:null,next:null};if(Tx(c))_x(d,k);else{var B=c.alternate;if(c.lanes===0&&(B===null||B.lanes===0)&&(B=d.lastRenderedReducer,B!==null))try{var $=d.lastRenderedState,ue=B($,v);if(k.hasEagerState=!0,k.eagerState=ue,Qo(ue,$)){var be=d.interleaved;be===null?(k.next=k,Rg(d)):(k.next=be.next,be.next=k),d.interleaved=k;return}}catch{}finally{}v=ox(c,d,k,b),v!==null&&(k=Bi(),rs(v,c,b,k),Rx(v,d,b))}}function Tx(c){var d=c.alternate;return c===wr||d!==null&&d===wr}function _x(c,d){rd=Yf=!0;var v=c.pending;v===null?d.next=d:(d.next=v.next,v.next=d),c.pending=d}function Rx(c,d,v){if((v&4194240)!==0){var b=d.lanes;b&=c.pendingLanes,v|=b,d.lanes=v,dt(c,v)}}var eh={readContext:Go,useCallback:ki,useContext:ki,useEffect:ki,useImperativeHandle:ki,useInsertionEffect:ki,useLayoutEffect:ki,useMemo:ki,useReducer:ki,useRef:ki,useState:ki,useDebugValue:ki,useDeferredValue:ki,useTransition:ki,useMutableSource:ki,useSyncExternalStore:ki,useId:ki,unstable_isNewReconciler:!1},OR={readContext:Go,useCallback:function(c,d){return Ls().memoizedState=[c,d===void 0?null:d],c},useContext:Go,useEffect:Cx,useImperativeHandle:function(c,d,v){return v=v!=null?v.concat([c]):null,Qf(4194308,4,Ix.bind(null,d,c),v)},useLayoutEffect:function(c,d){return Qf(4194308,4,c,d)},useInsertionEffect:function(c,d){return Qf(4,2,c,d)},useMemo:function(c,d){var v=Ls();return d=d===void 0?null:d,c=c(),v.memoizedState=[c,d],c},useReducer:function(c,d,v){var b=Ls();return d=v!==void 0?v(d):d,b.memoizedState=b.baseState=d,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:d},b.queue=c,c=c.dispatch=NR.bind(null,wr,c),[b.memoizedState,c]},useRef:function(c){var d=Ls();return c={current:c},d.memoizedState=c},useState:vx,useDebugValue:zg,useDeferredValue:function(c){return Ls().memoizedState=c},useTransition:function(){var c=vx(!1),d=c[0];return c=MR.bind(null,c[1]),Ls().memoizedState=c,[d,c]},useMutableSource:function(){},useSyncExternalStore:function(c,d,v){var b=wr,k=Ls();if(fr){if(v===void 0)throw Error(t(407));v=v()}else{if(v=d(),ni===null)throw Error(t(349));($c&30)!==0||fx(b,d,v)}k.memoizedState=v;var B={value:v,getSnapshot:d};return k.queue=B,Cx(px.bind(null,b,B,c),[c]),b.flags|=2048,sd(9,hx.bind(null,b,B,v,d),void 0,null),v},useId:function(){var c=Ls(),d=ni.identifierPrefix;if(fr){var v=ga,b=pa;v=(b&~(1<<32-mn(b)-1)).toString(32)+v,d=":"+d+"R"+v,v=id++,0<v&&(d+="H"+v.toString(32)),d+=":"}else v=DR++,d=":"+d+"r"+v.toString(32)+":";return c.memoizedState=d},unstable_isNewReconciler:!1},FR={readContext:Go,useCallback:Sx,useContext:Go,useEffect:Vg,useImperativeHandle:wx,useInsertionEffect:xx,useLayoutEffect:bx,useMemo:Ax,useReducer:jg,useRef:yx,useState:function(){return jg(od)},useDebugValue:zg,useDeferredValue:function(c){var d=Vo();return kx(d,Hr.memoizedState,c)},useTransition:function(){var c=jg(od)[0],d=Vo().memoizedState;return[c,d]},useMutableSource:ux,useSyncExternalStore:dx,useId:Ex,unstable_isNewReconciler:!1},LR={readContext:Go,useCallback:Sx,useContext:Go,useEffect:Vg,useImperativeHandle:wx,useInsertionEffect:xx,useLayoutEffect:bx,useMemo:Ax,useReducer:Gg,useRef:yx,useState:function(){return Gg(od)},useDebugValue:zg,useDeferredValue:function(c){var d=Vo();return Hr===null?d.memoizedState=c:kx(d,Hr.memoizedState,c)},useTransition:function(){var c=Gg(od)[0],d=Vo().memoizedState;return[c,d]},useMutableSource:ux,useSyncExternalStore:dx,useId:Ex,unstable_isNewReconciler:!1};function es(c,d){if(c&&c.defaultProps){d=ke({},d),c=c.defaultProps;for(var v in c)d[v]===void 0&&(d[v]=c[v]);return d}return d}function Wg(c,d,v,b){d=c.memoizedState,v=v(b,d),v=v==null?d:ke({},d,v),c.memoizedState=v,c.lanes===0&&(c.updateQueue.baseState=v)}var th={isMounted:function(c){return(c=c._reactInternals)?Fe(c)===c:!1},enqueueSetState:function(c,d,v){c=c._reactInternals;var b=Bi(),k=tc(c),B=va(b,k);B.payload=d,v!=null&&(B.callback=v),d=Ya(c,B,k),d!==null&&(rs(d,c,k,b),Xf(d,c,k))},enqueueReplaceState:function(c,d,v){c=c._reactInternals;var b=Bi(),k=tc(c),B=va(b,k);B.tag=1,B.payload=d,v!=null&&(B.callback=v),d=Ya(c,B,k),d!==null&&(rs(d,c,k,b),Xf(d,c,k))},enqueueForceUpdate:function(c,d){c=c._reactInternals;var v=Bi(),b=tc(c),k=va(v,b);k.tag=2,d!=null&&(k.callback=d),d=Ya(c,k,b),d!==null&&(rs(d,c,b,v),Xf(d,c,b))}};function Px(c,d,v,b,k,B,$){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(b,B,$):d.prototype&&d.prototype.isPureReactComponent?!Zu(v,b)||!Zu(k,B):!0}function Dx(c,d,v){var b=!1,k=$a,B=d.contextType;return typeof B=="object"&&B!==null?B=Go(B):(k=qi(d)?zc:Ai.current,b=d.contextTypes,B=(b=b!=null)?Hl(c,k):$a),d=new d(v,B),c.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=th,c.stateNode=d,d._reactInternals=c,b&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=k,c.__reactInternalMemoizedMaskedChildContext=B),d}function Mx(c,d,v,b){c=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(v,b),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(v,b),d.state!==c&&th.enqueueReplaceState(d,d.state,null)}function Hg(c,d,v,b){var k=c.stateNode;k.props=v,k.state=c.memoizedState,k.refs={},Pg(c);var B=d.contextType;typeof B=="object"&&B!==null?k.context=Go(B):(B=qi(d)?zc:Ai.current,k.context=Hl(c,B)),k.state=c.memoizedState,B=d.getDerivedStateFromProps,typeof B=="function"&&(Wg(c,d,B,v),k.state=c.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(d=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),d!==k.state&&th.enqueueReplaceState(k,k.state,null),$f(c,v,k,b),k.state=c.memoizedState),typeof k.componentDidMount=="function"&&(c.flags|=4194308)}function Jl(c,d){try{var v="",b=d;do v+=Ee(b),b=b.return;while(b);var k=v}catch(B){k=`
Error generating stack: `+B.message+`
`+B.stack}return{value:c,source:d,stack:k,digest:null}}function Zg(c,d,v){return{value:c,source:null,stack:v??null,digest:d??null}}function Xg(c,d){try{console.error(d.value)}catch(v){setTimeout(function(){throw v})}}var UR=typeof WeakMap=="function"?WeakMap:Map;function Nx(c,d,v){v=va(-1,v),v.tag=3,v.payload={element:null};var b=d.value;return v.callback=function(){ch||(ch=!0,cm=b),Xg(c,d)},v}function Bx(c,d,v){v=va(-1,v),v.tag=3;var b=c.type.getDerivedStateFromError;if(typeof b=="function"){var k=d.value;v.payload=function(){return b(k)},v.callback=function(){Xg(c,d)}}var B=c.stateNode;return B!==null&&typeof B.componentDidCatch=="function"&&(v.callback=function(){Xg(c,d),typeof b!="function"&&(Ja===null?Ja=new Set([this]):Ja.add(this));var $=d.stack;this.componentDidCatch(d.value,{componentStack:$!==null?$:""})}),v}function Ox(c,d,v){var b=c.pingCache;if(b===null){b=c.pingCache=new UR;var k=new Set;b.set(d,k)}else k=b.get(d),k===void 0&&(k=new Set,b.set(d,k));k.has(v)||(k.add(v),c=JR.bind(null,c,d,v),d.then(c,c))}function Fx(c){do{var d;if((d=c.tag===13)&&(d=c.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return c;c=c.return}while(c!==null);return null}function Lx(c,d,v,b,k){return(c.mode&1)===0?(c===d?c.flags|=65536:(c.flags|=128,v.flags|=131072,v.flags&=-52805,v.tag===1&&(v.alternate===null?v.tag=17:(d=va(-1,1),d.tag=2,Ya(v,d,1))),v.lanes|=1),c):(c.flags|=65536,c.lanes=k,c)}var jR=_.ReactCurrentOwner,Yi=!1;function Ni(c,d,v,b){d.child=c===null?ix(d,null,v,b):Kl(d,c.child,v,b)}function Ux(c,d,v,b,k){v=v.render;var B=d.ref;return Yl(d,k),b=Lg(c,d,v,b,B,k),v=Ug(),c!==null&&!Yi?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~k,ya(c,d,k)):(fr&&v&&bg(d),d.flags|=1,Ni(c,d,b,k),d.child)}function jx(c,d,v,b,k){if(c===null){var B=v.type;return typeof B=="function"&&!gm(B)&&B.defaultProps===void 0&&v.compare===null&&v.defaultProps===void 0?(d.tag=15,d.type=B,Gx(c,d,B,b,k)):(c=ph(v.type,null,b,d,d.mode,k),c.ref=d.ref,c.return=d,d.child=c)}if(B=c.child,(c.lanes&k)===0){var $=B.memoizedProps;if(v=v.compare,v=v!==null?v:Zu,v($,b)&&c.ref===d.ref)return ya(c,d,k)}return d.flags|=1,c=rc(B,b),c.ref=d.ref,c.return=d,d.child=c}function Gx(c,d,v,b,k){if(c!==null){var B=c.memoizedProps;if(Zu(B,b)&&c.ref===d.ref)if(Yi=!1,d.pendingProps=b=B,(c.lanes&k)!==0)(c.flags&131072)!==0&&(Yi=!0);else return d.lanes=c.lanes,ya(c,d,k)}return $g(c,d,v,b,k)}function Vx(c,d,v){var b=d.pendingProps,k=b.children,B=c!==null?c.memoizedState:null;if(b.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jn(tu,xo),xo|=v;else{if((v&1073741824)===0)return c=B!==null?B.baseLanes|v:v,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:c,cachePool:null,transitions:null},d.updateQueue=null,Jn(tu,xo),xo|=c,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},b=B!==null?B.baseLanes:v,Jn(tu,xo),xo|=b}else B!==null?(b=B.baseLanes|v,d.memoizedState=null):b=v,Jn(tu,xo),xo|=b;return Ni(c,d,k,v),d.child}function zx(c,d){var v=d.ref;(c===null&&v!==null||c!==null&&c.ref!==v)&&(d.flags|=512,d.flags|=2097152)}function $g(c,d,v,b,k){var B=qi(v)?zc:Ai.current;return B=Hl(d,B),Yl(d,k),v=Lg(c,d,v,b,B,k),b=Ug(),c!==null&&!Yi?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~k,ya(c,d,k)):(fr&&b&&bg(d),d.flags|=1,Ni(c,d,v,k),d.child)}function Wx(c,d,v,b,k){if(qi(v)){var B=!0;Uf(d)}else B=!1;if(Yl(d,k),d.stateNode===null)rh(c,d),Dx(d,v,b),Hg(d,v,b,k),b=!0;else if(c===null){var $=d.stateNode,ue=d.memoizedProps;$.props=ue;var be=$.context,Le=v.contextType;typeof Le=="object"&&Le!==null?Le=Go(Le):(Le=qi(v)?zc:Ai.current,Le=Hl(d,Le));var nt=v.getDerivedStateFromProps,ot=typeof nt=="function"||typeof $.getSnapshotBeforeUpdate=="function";ot||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ue!==b||be!==Le)&&Mx(d,$,b,Le),qa=!1;var tt=d.memoizedState;$.state=tt,$f(d,b,$,k),be=d.memoizedState,ue!==b||tt!==be||Ki.current||qa?(typeof nt=="function"&&(Wg(d,v,nt,b),be=d.memoizedState),(ue=qa||Px(d,v,ue,b,tt,be,Le))?(ot||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(d.flags|=4194308)):(typeof $.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=b,d.memoizedState=be),$.props=b,$.state=be,$.context=Le,b=ue):(typeof $.componentDidMount=="function"&&(d.flags|=4194308),b=!1)}else{$=d.stateNode,sx(c,d),ue=d.memoizedProps,Le=d.type===d.elementType?ue:es(d.type,ue),$.props=Le,ot=d.pendingProps,tt=$.context,be=v.contextType,typeof be=="object"&&be!==null?be=Go(be):(be=qi(v)?zc:Ai.current,be=Hl(d,be));var Rt=v.getDerivedStateFromProps;(nt=typeof Rt=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ue!==ot||tt!==be)&&Mx(d,$,b,be),qa=!1,tt=d.memoizedState,$.state=tt,$f(d,b,$,k);var Ft=d.memoizedState;ue!==ot||tt!==Ft||Ki.current||qa?(typeof Rt=="function"&&(Wg(d,v,Rt,b),Ft=d.memoizedState),(Le=qa||Px(d,v,Le,b,tt,Ft,be)||!1)?(nt||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(b,Ft,be),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(b,Ft,be)),typeof $.componentDidUpdate=="function"&&(d.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof $.componentDidUpdate!="function"||ue===c.memoizedProps&&tt===c.memoizedState||(d.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ue===c.memoizedProps&&tt===c.memoizedState||(d.flags|=1024),d.memoizedProps=b,d.memoizedState=Ft),$.props=b,$.state=Ft,$.context=be,b=Le):(typeof $.componentDidUpdate!="function"||ue===c.memoizedProps&&tt===c.memoizedState||(d.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ue===c.memoizedProps&&tt===c.memoizedState||(d.flags|=1024),b=!1)}return Kg(c,d,v,b,B,k)}function Kg(c,d,v,b,k,B){zx(c,d);var $=(d.flags&128)!==0;if(!b&&!$)return k&&K1(d,v,!1),ya(c,d,B);b=d.stateNode,jR.current=d;var ue=$&&typeof v.getDerivedStateFromError!="function"?null:b.render();return d.flags|=1,c!==null&&$?(d.child=Kl(d,c.child,null,B),d.child=Kl(d,null,ue,B)):Ni(c,d,ue,B),d.memoizedState=b.state,k&&K1(d,v,!0),d.child}function Hx(c){var d=c.stateNode;d.pendingContext?X1(c,d.pendingContext,d.pendingContext!==d.context):d.context&&X1(c,d.context,!1),Dg(c,d.containerInfo)}function Zx(c,d,v,b,k){return $l(),Ag(k),d.flags|=256,Ni(c,d,v,b),d.child}var qg={dehydrated:null,treeContext:null,retryLane:0};function Yg(c){return{baseLanes:c,cachePool:null,transitions:null}}function Xx(c,d,v){var b=d.pendingProps,k=Ir.current,B=!1,$=(d.flags&128)!==0,ue;if((ue=$)||(ue=c!==null&&c.memoizedState===null?!1:(k&2)!==0),ue?(B=!0,d.flags&=-129):(c===null||c.memoizedState!==null)&&(k|=1),Jn(Ir,k&1),c===null)return Sg(d),c=d.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((d.mode&1)===0?d.lanes=1:c.data==="$!"?d.lanes=8:d.lanes=1073741824,null):($=b.children,c=b.fallback,B?(b=d.mode,B=d.child,$={mode:"hidden",children:$},(b&1)===0&&B!==null?(B.childLanes=0,B.pendingProps=$):B=gh($,b,0,null),c=Jc(c,b,v,null),B.return=d,c.return=d,B.sibling=c,d.child=B,d.child.memoizedState=Yg(v),d.memoizedState=qg,c):Qg(d,$));if(k=c.memoizedState,k!==null&&(ue=k.dehydrated,ue!==null))return GR(c,d,$,b,ue,k,v);if(B){B=b.fallback,$=d.mode,k=c.child,ue=k.sibling;var be={mode:"hidden",children:b.children};return($&1)===0&&d.child!==k?(b=d.child,b.childLanes=0,b.pendingProps=be,d.deletions=null):(b=rc(k,be),b.subtreeFlags=k.subtreeFlags&14680064),ue!==null?B=rc(ue,B):(B=Jc(B,$,v,null),B.flags|=2),B.return=d,b.return=d,b.sibling=B,d.child=b,b=B,B=d.child,$=c.child.memoizedState,$=$===null?Yg(v):{baseLanes:$.baseLanes|v,cachePool:null,transitions:$.transitions},B.memoizedState=$,B.childLanes=c.childLanes&~v,d.memoizedState=qg,b}return B=c.child,c=B.sibling,b=rc(B,{mode:"visible",children:b.children}),(d.mode&1)===0&&(b.lanes=v),b.return=d,b.sibling=null,c!==null&&(v=d.deletions,v===null?(d.deletions=[c],d.flags|=16):v.push(c)),d.child=b,d.memoizedState=null,b}function Qg(c,d){return d=gh({mode:"visible",children:d},c.mode,0,null),d.return=c,c.child=d}function nh(c,d,v,b){return b!==null&&Ag(b),Kl(d,c.child,null,v),c=Qg(d,d.pendingProps.children),c.flags|=2,d.memoizedState=null,c}function GR(c,d,v,b,k,B,$){if(v)return d.flags&256?(d.flags&=-257,b=Zg(Error(t(422))),nh(c,d,$,b)):d.memoizedState!==null?(d.child=c.child,d.flags|=128,null):(B=b.fallback,k=d.mode,b=gh({mode:"visible",children:b.children},k,0,null),B=Jc(B,k,$,null),B.flags|=2,b.return=d,B.return=d,b.sibling=B,d.child=b,(d.mode&1)!==0&&Kl(d,c.child,null,$),d.child.memoizedState=Yg($),d.memoizedState=qg,B);if((d.mode&1)===0)return nh(c,d,$,null);if(k.data==="$!"){if(b=k.nextSibling&&k.nextSibling.dataset,b)var ue=b.dgst;return b=ue,B=Error(t(419)),b=Zg(B,b,void 0),nh(c,d,$,b)}if(ue=($&c.childLanes)!==0,Yi||ue){if(b=ni,b!==null){switch($&-$){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(b.suspendedLanes|$))!==0?0:k,k!==0&&k!==B.retryLane&&(B.retryLane=k,ma(c,k),rs(b,c,k,-1))}return pm(),b=Zg(Error(t(421))),nh(c,d,$,b)}return k.data==="$?"?(d.flags|=128,d.child=c.child,d=eP.bind(null,c),k._reactRetry=d,null):(c=B.treeContext,Co=Za(k.nextSibling),yo=d,fr=!0,Jo=null,c!==null&&(Uo[jo++]=pa,Uo[jo++]=ga,Uo[jo++]=Wc,pa=c.id,ga=c.overflow,Wc=d),d=Qg(d,b.children),d.flags|=4096,d)}function $x(c,d,v){c.lanes|=d;var b=c.alternate;b!==null&&(b.lanes|=d),_g(c.return,d,v)}function Jg(c,d,v,b,k){var B=c.memoizedState;B===null?c.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:b,tail:v,tailMode:k}:(B.isBackwards=d,B.rendering=null,B.renderingStartTime=0,B.last=b,B.tail=v,B.tailMode=k)}function Kx(c,d,v){var b=d.pendingProps,k=b.revealOrder,B=b.tail;if(Ni(c,d,b.children,v),b=Ir.current,(b&2)!==0)b=b&1|2,d.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=d.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&$x(c,v,d);else if(c.tag===19)$x(c,v,d);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break e;for(;c.sibling===null;){if(c.return===null||c.return===d)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}b&=1}if(Jn(Ir,b),(d.mode&1)===0)d.memoizedState=null;else switch(k){case"forwards":for(v=d.child,k=null;v!==null;)c=v.alternate,c!==null&&Kf(c)===null&&(k=v),v=v.sibling;v=k,v===null?(k=d.child,d.child=null):(k=v.sibling,v.sibling=null),Jg(d,!1,k,v,B);break;case"backwards":for(v=null,k=d.child,d.child=null;k!==null;){if(c=k.alternate,c!==null&&Kf(c)===null){d.child=k;break}c=k.sibling,k.sibling=v,v=k,k=c}Jg(d,!0,v,null,B);break;case"together":Jg(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function rh(c,d){(d.mode&1)===0&&c!==null&&(c.alternate=null,d.alternate=null,d.flags|=2)}function ya(c,d,v){if(c!==null&&(d.dependencies=c.dependencies),Kc|=d.lanes,(v&d.childLanes)===0)return null;if(c!==null&&d.child!==c.child)throw Error(t(153));if(d.child!==null){for(c=d.child,v=rc(c,c.pendingProps),d.child=v,v.return=d;c.sibling!==null;)c=c.sibling,v=v.sibling=rc(c,c.pendingProps),v.return=d;v.sibling=null}return d.child}function VR(c,d,v){switch(d.tag){case 3:Hx(d),$l();break;case 5:lx(d);break;case 1:qi(d.type)&&Uf(d);break;case 4:Dg(d,d.stateNode.containerInfo);break;case 10:var b=d.type._context,k=d.memoizedProps.value;Jn(Hf,b._currentValue),b._currentValue=k;break;case 13:if(b=d.memoizedState,b!==null)return b.dehydrated!==null?(Jn(Ir,Ir.current&1),d.flags|=128,null):(v&d.child.childLanes)!==0?Xx(c,d,v):(Jn(Ir,Ir.current&1),c=ya(c,d,v),c!==null?c.sibling:null);Jn(Ir,Ir.current&1);break;case 19:if(b=(v&d.childLanes)!==0,(c.flags&128)!==0){if(b)return Kx(c,d,v);d.flags|=128}if(k=d.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),Jn(Ir,Ir.current),b)break;return null;case 22:case 23:return d.lanes=0,Vx(c,d,v)}return ya(c,d,v)}var qx,em,Yx,Qx;qx=function(c,d){for(var v=d.child;v!==null;){if(v.tag===5||v.tag===6)c.appendChild(v.stateNode);else if(v.tag!==4&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===d)break;for(;v.sibling===null;){if(v.return===null||v.return===d)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},em=function(){},Yx=function(c,d,v,b){var k=c.memoizedProps;if(k!==b){c=d.stateNode,Xc(Fs.current);var B=null;switch(v){case"input":k=Dt(c,k),b=Dt(c,b),B=[];break;case"select":k=ke({},k,{value:void 0}),b=ke({},b,{value:void 0}),B=[];break;case"textarea":k=ct(c,k),b=ct(c,b),B=[];break;default:typeof k.onClick!="function"&&typeof b.onClick=="function"&&(c.onclick=Of)}hn(v,b);var $;v=null;for(Le in k)if(!b.hasOwnProperty(Le)&&k.hasOwnProperty(Le)&&k[Le]!=null)if(Le==="style"){var ue=k[Le];for($ in ue)ue.hasOwnProperty($)&&(v||(v={}),v[$]="")}else Le!=="dangerouslySetInnerHTML"&&Le!=="children"&&Le!=="suppressContentEditableWarning"&&Le!=="suppressHydrationWarning"&&Le!=="autoFocus"&&(i.hasOwnProperty(Le)?B||(B=[]):(B=B||[]).push(Le,null));for(Le in b){var be=b[Le];if(ue=k!=null?k[Le]:void 0,b.hasOwnProperty(Le)&&be!==ue&&(be!=null||ue!=null))if(Le==="style")if(ue){for($ in ue)!ue.hasOwnProperty($)||be&&be.hasOwnProperty($)||(v||(v={}),v[$]="");for($ in be)be.hasOwnProperty($)&&ue[$]!==be[$]&&(v||(v={}),v[$]=be[$])}else v||(B||(B=[]),B.push(Le,v)),v=be;else Le==="dangerouslySetInnerHTML"?(be=be?be.__html:void 0,ue=ue?ue.__html:void 0,be!=null&&ue!==be&&(B=B||[]).push(Le,be)):Le==="children"?typeof be!="string"&&typeof be!="number"||(B=B||[]).push(Le,""+be):Le!=="suppressContentEditableWarning"&&Le!=="suppressHydrationWarning"&&(i.hasOwnProperty(Le)?(be!=null&&Le==="onScroll"&&ir("scroll",c),B||ue===be||(B=[])):(B=B||[]).push(Le,be))}v&&(B=B||[]).push("style",v);var Le=B;(d.updateQueue=Le)&&(d.flags|=4)}},Qx=function(c,d,v,b){v!==b&&(d.flags|=4)};function ad(c,d){if(!fr)switch(c.tailMode){case"hidden":d=c.tail;for(var v=null;d!==null;)d.alternate!==null&&(v=d),d=d.sibling;v===null?c.tail=null:v.sibling=null;break;case"collapsed":v=c.tail;for(var b=null;v!==null;)v.alternate!==null&&(b=v),v=v.sibling;b===null?d||c.tail===null?c.tail=null:c.tail.sibling=null:b.sibling=null}}function Ei(c){var d=c.alternate!==null&&c.alternate.child===c.child,v=0,b=0;if(d)for(var k=c.child;k!==null;)v|=k.lanes|k.childLanes,b|=k.subtreeFlags&14680064,b|=k.flags&14680064,k.return=c,k=k.sibling;else for(k=c.child;k!==null;)v|=k.lanes|k.childLanes,b|=k.subtreeFlags,b|=k.flags,k.return=c,k=k.sibling;return c.subtreeFlags|=b,c.childLanes=v,d}function zR(c,d,v){var b=d.pendingProps;switch(Ig(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ei(d),null;case 1:return qi(d.type)&&Lf(),Ei(d),null;case 3:return b=d.stateNode,Ql(),or(Ki),or(Ai),Bg(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(c===null||c.child===null)&&(zf(d)?d.flags|=4:c===null||c.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Jo!==null&&(dm(Jo),Jo=null))),em(c,d),Ei(d),null;case 5:Mg(d);var k=Xc(nd.current);if(v=d.type,c!==null&&d.stateNode!=null)Yx(c,d,v,b,k),c.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!b){if(d.stateNode===null)throw Error(t(166));return Ei(d),null}if(c=Xc(Fs.current),zf(d)){b=d.stateNode,v=d.type;var B=d.memoizedProps;switch(b[Os]=d,b[Yu]=B,c=(d.mode&1)!==0,v){case"dialog":ir("cancel",b),ir("close",b);break;case"iframe":case"object":case"embed":ir("load",b);break;case"video":case"audio":for(k=0;k<$u.length;k++)ir($u[k],b);break;case"source":ir("error",b);break;case"img":case"image":case"link":ir("error",b),ir("load",b);break;case"details":ir("toggle",b);break;case"input":at(b,B),ir("invalid",b);break;case"select":b._wrapperState={wasMultiple:!!B.multiple},ir("invalid",b);break;case"textarea":ce(b,B),ir("invalid",b)}hn(v,B),k=null;for(var $ in B)if(B.hasOwnProperty($)){var ue=B[$];$==="children"?typeof ue=="string"?b.textContent!==ue&&(B.suppressHydrationWarning!==!0&&Bf(b.textContent,ue,c),k=["children",ue]):typeof ue=="number"&&b.textContent!==""+ue&&(B.suppressHydrationWarning!==!0&&Bf(b.textContent,ue,c),k=["children",""+ue]):i.hasOwnProperty($)&&ue!=null&&$==="onScroll"&&ir("scroll",b)}switch(v){case"input":Xt(b),Gt(b,B,!0);break;case"textarea":Xt(b),pn(b);break;case"select":case"option":break;default:typeof B.onClick=="function"&&(b.onclick=Of)}b=k,d.updateQueue=b,b!==null&&(d.flags|=4)}else{$=k.nodeType===9?k:k.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=Un(v)),c==="http://www.w3.org/1999/xhtml"?v==="script"?(c=$.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof b.is=="string"?c=$.createElement(v,{is:b.is}):(c=$.createElement(v),v==="select"&&($=c,b.multiple?$.multiple=!0:b.size&&($.size=b.size))):c=$.createElementNS(c,v),c[Os]=d,c[Yu]=b,qx(c,d,!1,!1),d.stateNode=c;e:{switch($=yn(v,b),v){case"dialog":ir("cancel",c),ir("close",c),k=b;break;case"iframe":case"object":case"embed":ir("load",c),k=b;break;case"video":case"audio":for(k=0;k<$u.length;k++)ir($u[k],c);k=b;break;case"source":ir("error",c),k=b;break;case"img":case"image":case"link":ir("error",c),ir("load",c),k=b;break;case"details":ir("toggle",c),k=b;break;case"input":at(c,b),k=Dt(c,b),ir("invalid",c);break;case"option":k=b;break;case"select":c._wrapperState={wasMultiple:!!b.multiple},k=ke({},b,{value:void 0}),ir("invalid",c);break;case"textarea":ce(c,b),k=ct(c,b),ir("invalid",c);break;default:k=b}hn(v,k),ue=k;for(B in ue)if(ue.hasOwnProperty(B)){var be=ue[B];B==="style"?Lt(c,be):B==="dangerouslySetInnerHTML"?(be=be?be.__html:void 0,be!=null&&F(c,be)):B==="children"?typeof be=="string"?(v!=="textarea"||be!=="")&&te(c,be):typeof be=="number"&&te(c,""+be):B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&B!=="autoFocus"&&(i.hasOwnProperty(B)?be!=null&&B==="onScroll"&&ir("scroll",c):be!=null&&E(c,B,be,$))}switch(v){case"input":Xt(c),Gt(c,b,!1);break;case"textarea":Xt(c),pn(c);break;case"option":b.value!=null&&c.setAttribute("value",""+me(b.value));break;case"select":c.multiple=!!b.multiple,B=b.value,B!=null?on(c,!!b.multiple,B,!1):b.defaultValue!=null&&on(c,!!b.multiple,b.defaultValue,!0);break;default:typeof k.onClick=="function"&&(c.onclick=Of)}switch(v){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}}b&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Ei(d),null;case 6:if(c&&d.stateNode!=null)Qx(c,d,c.memoizedProps,b);else{if(typeof b!="string"&&d.stateNode===null)throw Error(t(166));if(v=Xc(nd.current),Xc(Fs.current),zf(d)){if(b=d.stateNode,v=d.memoizedProps,b[Os]=d,(B=b.nodeValue!==v)&&(c=yo,c!==null))switch(c.tag){case 3:Bf(b.nodeValue,v,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&Bf(b.nodeValue,v,(c.mode&1)!==0)}B&&(d.flags|=4)}else b=(v.nodeType===9?v:v.ownerDocument).createTextNode(b),b[Os]=d,d.stateNode=b}return Ei(d),null;case 13:if(or(Ir),b=d.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(fr&&Co!==null&&(d.mode&1)!==0&&(d.flags&128)===0)tx(),$l(),d.flags|=98560,B=!1;else if(B=zf(d),b!==null&&b.dehydrated!==null){if(c===null){if(!B)throw Error(t(318));if(B=d.memoizedState,B=B!==null?B.dehydrated:null,!B)throw Error(t(317));B[Os]=d}else $l(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Ei(d),B=!1}else Jo!==null&&(dm(Jo),Jo=null),B=!0;if(!B)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=v,d):(b=b!==null,b!==(c!==null&&c.memoizedState!==null)&&b&&(d.child.flags|=8192,(d.mode&1)!==0&&(c===null||(Ir.current&1)!==0?Zr===0&&(Zr=3):pm())),d.updateQueue!==null&&(d.flags|=4),Ei(d),null);case 4:return Ql(),em(c,d),c===null&&Ku(d.stateNode.containerInfo),Ei(d),null;case 10:return Tg(d.type._context),Ei(d),null;case 17:return qi(d.type)&&Lf(),Ei(d),null;case 19:if(or(Ir),B=d.memoizedState,B===null)return Ei(d),null;if(b=(d.flags&128)!==0,$=B.rendering,$===null)if(b)ad(B,!1);else{if(Zr!==0||c!==null&&(c.flags&128)!==0)for(c=d.child;c!==null;){if($=Kf(c),$!==null){for(d.flags|=128,ad(B,!1),b=$.updateQueue,b!==null&&(d.updateQueue=b,d.flags|=4),d.subtreeFlags=0,b=v,v=d.child;v!==null;)B=v,c=b,B.flags&=14680066,$=B.alternate,$===null?(B.childLanes=0,B.lanes=c,B.child=null,B.subtreeFlags=0,B.memoizedProps=null,B.memoizedState=null,B.updateQueue=null,B.dependencies=null,B.stateNode=null):(B.childLanes=$.childLanes,B.lanes=$.lanes,B.child=$.child,B.subtreeFlags=0,B.deletions=null,B.memoizedProps=$.memoizedProps,B.memoizedState=$.memoizedState,B.updateQueue=$.updateQueue,B.type=$.type,c=$.dependencies,B.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),v=v.sibling;return Jn(Ir,Ir.current&1|2),d.child}c=c.sibling}B.tail!==null&&wt()>nu&&(d.flags|=128,b=!0,ad(B,!1),d.lanes=4194304)}else{if(!b)if(c=Kf($),c!==null){if(d.flags|=128,b=!0,v=c.updateQueue,v!==null&&(d.updateQueue=v,d.flags|=4),ad(B,!0),B.tail===null&&B.tailMode==="hidden"&&!$.alternate&&!fr)return Ei(d),null}else 2*wt()-B.renderingStartTime>nu&&v!==1073741824&&(d.flags|=128,b=!0,ad(B,!1),d.lanes=4194304);B.isBackwards?($.sibling=d.child,d.child=$):(v=B.last,v!==null?v.sibling=$:d.child=$,B.last=$)}return B.tail!==null?(d=B.tail,B.rendering=d,B.tail=d.sibling,B.renderingStartTime=wt(),d.sibling=null,v=Ir.current,Jn(Ir,b?v&1|2:v&1),d):(Ei(d),null);case 22:case 23:return hm(),b=d.memoizedState!==null,c!==null&&c.memoizedState!==null!==b&&(d.flags|=8192),b&&(d.mode&1)!==0?(xo&1073741824)!==0&&(Ei(d),d.subtreeFlags&6&&(d.flags|=8192)):Ei(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function WR(c,d){switch(Ig(d),d.tag){case 1:return qi(d.type)&&Lf(),c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 3:return Ql(),or(Ki),or(Ai),Bg(),c=d.flags,(c&65536)!==0&&(c&128)===0?(d.flags=c&-65537|128,d):null;case 5:return Mg(d),null;case 13:if(or(Ir),c=d.memoizedState,c!==null&&c.dehydrated!==null){if(d.alternate===null)throw Error(t(340));$l()}return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 19:return or(Ir),null;case 4:return Ql(),null;case 10:return Tg(d.type._context),null;case 22:case 23:return hm(),null;case 24:return null;default:return null}}var ih=!1,Ti=!1,HR=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function eu(c,d){var v=c.ref;if(v!==null)if(typeof v=="function")try{v(null)}catch(b){kr(c,d,b)}else v.current=null}function tm(c,d,v){try{v()}catch(b){kr(c,d,b)}}var Jx=!1;function ZR(c,d){if(hg=rr,c=P1(),og(c)){if("selectionStart"in c)var v={start:c.selectionStart,end:c.selectionEnd};else e:{v=(v=c.ownerDocument)&&v.defaultView||window;var b=v.getSelection&&v.getSelection();if(b&&b.rangeCount!==0){v=b.anchorNode;var k=b.anchorOffset,B=b.focusNode;b=b.focusOffset;try{v.nodeType,B.nodeType}catch{v=null;break e}var $=0,ue=-1,be=-1,Le=0,nt=0,ot=c,tt=null;t:for(;;){for(var Rt;ot!==v||k!==0&&ot.nodeType!==3||(ue=$+k),ot!==B||b!==0&&ot.nodeType!==3||(be=$+b),ot.nodeType===3&&($+=ot.nodeValue.length),(Rt=ot.firstChild)!==null;)tt=ot,ot=Rt;for(;;){if(ot===c)break t;if(tt===v&&++Le===k&&(ue=$),tt===B&&++nt===b&&(be=$),(Rt=ot.nextSibling)!==null)break;ot=tt,tt=ot.parentNode}ot=Rt}v=ue===-1||be===-1?null:{start:ue,end:be}}else v=null}v=v||{start:0,end:0}}else v=null;for(pg={focusedElem:c,selectionRange:v},rr=!1,Mt=d;Mt!==null;)if(d=Mt,c=d.child,(d.subtreeFlags&1028)!==0&&c!==null)c.return=d,Mt=c;else for(;Mt!==null;){d=Mt;try{var Ft=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(Ft!==null){var Ut=Ft.memoizedProps,Pr=Ft.memoizedState,De=d.stateNode,we=De.getSnapshotBeforeUpdate(d.elementType===d.type?Ut:es(d.type,Ut),Pr);De.__reactInternalSnapshotBeforeUpdate=we}break;case 3:var Oe=d.stateNode.containerInfo;Oe.nodeType===1?Oe.textContent="":Oe.nodeType===9&&Oe.documentElement&&Oe.removeChild(Oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ft){kr(d,d.return,ft)}if(c=d.sibling,c!==null){c.return=d.return,Mt=c;break}Mt=d.return}return Ft=Jx,Jx=!1,Ft}function cd(c,d,v){var b=d.updateQueue;if(b=b!==null?b.lastEffect:null,b!==null){var k=b=b.next;do{if((k.tag&c)===c){var B=k.destroy;k.destroy=void 0,B!==void 0&&tm(d,v,B)}k=k.next}while(k!==b)}}function oh(c,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var v=d=d.next;do{if((v.tag&c)===c){var b=v.create;v.destroy=b()}v=v.next}while(v!==d)}}function nm(c){var d=c.ref;if(d!==null){var v=c.stateNode;switch(c.tag){case 5:c=v;break;default:c=v}typeof d=="function"?d(c):d.current=c}}function eb(c){var d=c.alternate;d!==null&&(c.alternate=null,eb(d)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(d=c.stateNode,d!==null&&(delete d[Os],delete d[Yu],delete d[yg],delete d[TR],delete d[_R])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function tb(c){return c.tag===5||c.tag===3||c.tag===4}function nb(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||tb(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function rm(c,d,v){var b=c.tag;if(b===5||b===6)c=c.stateNode,d?v.nodeType===8?v.parentNode.insertBefore(c,d):v.insertBefore(c,d):(v.nodeType===8?(d=v.parentNode,d.insertBefore(c,v)):(d=v,d.appendChild(c)),v=v._reactRootContainer,v!=null||d.onclick!==null||(d.onclick=Of));else if(b!==4&&(c=c.child,c!==null))for(rm(c,d,v),c=c.sibling;c!==null;)rm(c,d,v),c=c.sibling}function im(c,d,v){var b=c.tag;if(b===5||b===6)c=c.stateNode,d?v.insertBefore(c,d):v.appendChild(c);else if(b!==4&&(c=c.child,c!==null))for(im(c,d,v),c=c.sibling;c!==null;)im(c,d,v),c=c.sibling}var hi=null,ts=!1;function Qa(c,d,v){for(v=v.child;v!==null;)rb(c,d,v),v=v.sibling}function rb(c,d,v){if(nr&&typeof nr.onCommitFiberUnmount=="function")try{nr.onCommitFiberUnmount(gn,v)}catch{}switch(v.tag){case 5:Ti||eu(v,d);case 6:var b=hi,k=ts;hi=null,Qa(c,d,v),hi=b,ts=k,hi!==null&&(ts?(c=hi,v=v.stateNode,c.nodeType===8?c.parentNode.removeChild(v):c.removeChild(v)):hi.removeChild(v.stateNode));break;case 18:hi!==null&&(ts?(c=hi,v=v.stateNode,c.nodeType===8?vg(c.parentNode,v):c.nodeType===1&&vg(c,v),Ct(c)):vg(hi,v.stateNode));break;case 4:b=hi,k=ts,hi=v.stateNode.containerInfo,ts=!0,Qa(c,d,v),hi=b,ts=k;break;case 0:case 11:case 14:case 15:if(!Ti&&(b=v.updateQueue,b!==null&&(b=b.lastEffect,b!==null))){k=b=b.next;do{var B=k,$=B.destroy;B=B.tag,$!==void 0&&((B&2)!==0||(B&4)!==0)&&tm(v,d,$),k=k.next}while(k!==b)}Qa(c,d,v);break;case 1:if(!Ti&&(eu(v,d),b=v.stateNode,typeof b.componentWillUnmount=="function"))try{b.props=v.memoizedProps,b.state=v.memoizedState,b.componentWillUnmount()}catch(ue){kr(v,d,ue)}Qa(c,d,v);break;case 21:Qa(c,d,v);break;case 22:v.mode&1?(Ti=(b=Ti)||v.memoizedState!==null,Qa(c,d,v),Ti=b):Qa(c,d,v);break;default:Qa(c,d,v)}}function ib(c){var d=c.updateQueue;if(d!==null){c.updateQueue=null;var v=c.stateNode;v===null&&(v=c.stateNode=new HR),d.forEach(function(b){var k=tP.bind(null,c,b);v.has(b)||(v.add(b),b.then(k,k))})}}function ns(c,d){var v=d.deletions;if(v!==null)for(var b=0;b<v.length;b++){var k=v[b];try{var B=c,$=d,ue=$;e:for(;ue!==null;){switch(ue.tag){case 5:hi=ue.stateNode,ts=!1;break e;case 3:hi=ue.stateNode.containerInfo,ts=!0;break e;case 4:hi=ue.stateNode.containerInfo,ts=!0;break e}ue=ue.return}if(hi===null)throw Error(t(160));rb(B,$,k),hi=null,ts=!1;var be=k.alternate;be!==null&&(be.return=null),k.return=null}catch(Le){kr(k,d,Le)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)ob(d,c),d=d.sibling}function ob(c,d){var v=c.alternate,b=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(ns(d,c),Us(c),b&4){try{cd(3,c,c.return),oh(3,c)}catch(Ut){kr(c,c.return,Ut)}try{cd(5,c,c.return)}catch(Ut){kr(c,c.return,Ut)}}break;case 1:ns(d,c),Us(c),b&512&&v!==null&&eu(v,v.return);break;case 5:if(ns(d,c),Us(c),b&512&&v!==null&&eu(v,v.return),c.flags&32){var k=c.stateNode;try{te(k,"")}catch(Ut){kr(c,c.return,Ut)}}if(b&4&&(k=c.stateNode,k!=null)){var B=c.memoizedProps,$=v!==null?v.memoizedProps:B,ue=c.type,be=c.updateQueue;if(c.updateQueue=null,be!==null)try{ue==="input"&&B.type==="radio"&&B.name!=null&&lt(k,B),yn(ue,$);var Le=yn(ue,B);for($=0;$<be.length;$+=2){var nt=be[$],ot=be[$+1];nt==="style"?Lt(k,ot):nt==="dangerouslySetInnerHTML"?F(k,ot):nt==="children"?te(k,ot):E(k,nt,ot,Le)}switch(ue){case"input":Vt(k,B);break;case"textarea":nn(k,B);break;case"select":var tt=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!B.multiple;var Rt=B.value;Rt!=null?on(k,!!B.multiple,Rt,!1):tt!==!!B.multiple&&(B.defaultValue!=null?on(k,!!B.multiple,B.defaultValue,!0):on(k,!!B.multiple,B.multiple?[]:"",!1))}k[Yu]=B}catch(Ut){kr(c,c.return,Ut)}}break;case 6:if(ns(d,c),Us(c),b&4){if(c.stateNode===null)throw Error(t(162));k=c.stateNode,B=c.memoizedProps;try{k.nodeValue=B}catch(Ut){kr(c,c.return,Ut)}}break;case 3:if(ns(d,c),Us(c),b&4&&v!==null&&v.memoizedState.isDehydrated)try{Ct(d.containerInfo)}catch(Ut){kr(c,c.return,Ut)}break;case 4:ns(d,c),Us(c);break;case 13:ns(d,c),Us(c),k=c.child,k.flags&8192&&(B=k.memoizedState!==null,k.stateNode.isHidden=B,!B||k.alternate!==null&&k.alternate.memoizedState!==null||(am=wt())),b&4&&ib(c);break;case 22:if(nt=v!==null&&v.memoizedState!==null,c.mode&1?(Ti=(Le=Ti)||nt,ns(d,c),Ti=Le):ns(d,c),Us(c),b&8192){if(Le=c.memoizedState!==null,(c.stateNode.isHidden=Le)&&!nt&&(c.mode&1)!==0)for(Mt=c,nt=c.child;nt!==null;){for(ot=Mt=nt;Mt!==null;){switch(tt=Mt,Rt=tt.child,tt.tag){case 0:case 11:case 14:case 15:cd(4,tt,tt.return);break;case 1:eu(tt,tt.return);var Ft=tt.stateNode;if(typeof Ft.componentWillUnmount=="function"){b=tt,v=tt.return;try{d=b,Ft.props=d.memoizedProps,Ft.state=d.memoizedState,Ft.componentWillUnmount()}catch(Ut){kr(b,v,Ut)}}break;case 5:eu(tt,tt.return);break;case 22:if(tt.memoizedState!==null){cb(ot);continue}}Rt!==null?(Rt.return=tt,Mt=Rt):cb(ot)}nt=nt.sibling}e:for(nt=null,ot=c;;){if(ot.tag===5){if(nt===null){nt=ot;try{k=ot.stateNode,Le?(B=k.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none"):(ue=ot.stateNode,be=ot.memoizedProps.style,$=be!=null&&be.hasOwnProperty("display")?be.display:null,ue.style.display=Ge("display",$))}catch(Ut){kr(c,c.return,Ut)}}}else if(ot.tag===6){if(nt===null)try{ot.stateNode.nodeValue=Le?"":ot.memoizedProps}catch(Ut){kr(c,c.return,Ut)}}else if((ot.tag!==22&&ot.tag!==23||ot.memoizedState===null||ot===c)&&ot.child!==null){ot.child.return=ot,ot=ot.child;continue}if(ot===c)break e;for(;ot.sibling===null;){if(ot.return===null||ot.return===c)break e;nt===ot&&(nt=null),ot=ot.return}nt===ot&&(nt=null),ot.sibling.return=ot.return,ot=ot.sibling}}break;case 19:ns(d,c),Us(c),b&4&&ib(c);break;case 21:break;default:ns(d,c),Us(c)}}function Us(c){var d=c.flags;if(d&2){try{e:{for(var v=c.return;v!==null;){if(tb(v)){var b=v;break e}v=v.return}throw Error(t(160))}switch(b.tag){case 5:var k=b.stateNode;b.flags&32&&(te(k,""),b.flags&=-33);var B=nb(c);im(c,B,k);break;case 3:case 4:var $=b.stateNode.containerInfo,ue=nb(c);rm(c,ue,$);break;default:throw Error(t(161))}}catch(be){kr(c,c.return,be)}c.flags&=-3}d&4096&&(c.flags&=-4097)}function XR(c,d,v){Mt=c,sb(c)}function sb(c,d,v){for(var b=(c.mode&1)!==0;Mt!==null;){var k=Mt,B=k.child;if(k.tag===22&&b){var $=k.memoizedState!==null||ih;if(!$){var ue=k.alternate,be=ue!==null&&ue.memoizedState!==null||Ti;ue=ih;var Le=Ti;if(ih=$,(Ti=be)&&!Le)for(Mt=k;Mt!==null;)$=Mt,be=$.child,$.tag===22&&$.memoizedState!==null?lb(k):be!==null?(be.return=$,Mt=be):lb(k);for(;B!==null;)Mt=B,sb(B),B=B.sibling;Mt=k,ih=ue,Ti=Le}ab(c)}else(k.subtreeFlags&8772)!==0&&B!==null?(B.return=k,Mt=B):ab(c)}}function ab(c){for(;Mt!==null;){var d=Mt;if((d.flags&8772)!==0){var v=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Ti||oh(5,d);break;case 1:var b=d.stateNode;if(d.flags&4&&!Ti)if(v===null)b.componentDidMount();else{var k=d.elementType===d.type?v.memoizedProps:es(d.type,v.memoizedProps);b.componentDidUpdate(k,v.memoizedState,b.__reactInternalSnapshotBeforeUpdate)}var B=d.updateQueue;B!==null&&cx(d,B,b);break;case 3:var $=d.updateQueue;if($!==null){if(v=null,d.child!==null)switch(d.child.tag){case 5:v=d.child.stateNode;break;case 1:v=d.child.stateNode}cx(d,$,v)}break;case 5:var ue=d.stateNode;if(v===null&&d.flags&4){v=ue;var be=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":be.autoFocus&&v.focus();break;case"img":be.src&&(v.src=be.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Le=d.alternate;if(Le!==null){var nt=Le.memoizedState;if(nt!==null){var ot=nt.dehydrated;ot!==null&&Ct(ot)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ti||d.flags&512&&nm(d)}catch(tt){kr(d,d.return,tt)}}if(d===c){Mt=null;break}if(v=d.sibling,v!==null){v.return=d.return,Mt=v;break}Mt=d.return}}function cb(c){for(;Mt!==null;){var d=Mt;if(d===c){Mt=null;break}var v=d.sibling;if(v!==null){v.return=d.return,Mt=v;break}Mt=d.return}}function lb(c){for(;Mt!==null;){var d=Mt;try{switch(d.tag){case 0:case 11:case 15:var v=d.return;try{oh(4,d)}catch(be){kr(d,v,be)}break;case 1:var b=d.stateNode;if(typeof b.componentDidMount=="function"){var k=d.return;try{b.componentDidMount()}catch(be){kr(d,k,be)}}var B=d.return;try{nm(d)}catch(be){kr(d,B,be)}break;case 5:var $=d.return;try{nm(d)}catch(be){kr(d,$,be)}}}catch(be){kr(d,d.return,be)}if(d===c){Mt=null;break}var ue=d.sibling;if(ue!==null){ue.return=d.return,Mt=ue;break}Mt=d.return}}var $R=Math.ceil,sh=_.ReactCurrentDispatcher,om=_.ReactCurrentOwner,zo=_.ReactCurrentBatchConfig,_n=0,ni=null,Or=null,pi=0,xo=0,tu=Xa(0),Zr=0,ld=null,Kc=0,ah=0,sm=0,ud=null,Qi=null,am=0,nu=1/0,Ca=null,ch=!1,cm=null,Ja=null,lh=!1,ec=null,uh=0,dd=0,lm=null,dh=-1,fh=0;function Bi(){return(_n&6)!==0?wt():dh!==-1?dh:dh=wt()}function tc(c){return(c.mode&1)===0?1:(_n&2)!==0&&pi!==0?pi&-pi:PR.transition!==null?(fh===0&&(fh=ie()),fh):(c=mt,c!==0||(c=window.event,c=c===void 0?16:Ua(c.type)),c)}function rs(c,d,v,b){if(50<dd)throw dd=0,lm=null,Error(t(185));Te(c,v,b),((_n&2)===0||c!==ni)&&(c===ni&&((_n&2)===0&&(ah|=v),Zr===4&&nc(c,pi)),Ji(c,b),v===1&&_n===0&&(d.mode&1)===0&&(nu=wt()+500,jf&&Ka()))}function Ji(c,d){var v=c.callbackNode;V(c,d);var b=rn(c,c===ni?pi:0);if(b===0)v!==null&&It(v),c.callbackNode=null,c.callbackPriority=0;else if(d=b&-b,c.callbackPriority!==d){if(v!=null&&It(v),d===1)c.tag===0?RR(db.bind(null,c)):q1(db.bind(null,c)),kR(function(){(_n&6)===0&&Ka()}),v=null;else{switch(Kt(b)){case 1:v=qn;break;case 4:v=Yn;break;case 16:v=tr;break;case 536870912:v=tn;break;default:v=tr}v=Cb(v,ub.bind(null,c))}c.callbackPriority=d,c.callbackNode=v}}function ub(c,d){if(dh=-1,fh=0,(_n&6)!==0)throw Error(t(327));var v=c.callbackNode;if(ru()&&c.callbackNode!==v)return null;var b=rn(c,c===ni?pi:0);if(b===0)return null;if((b&30)!==0||(b&c.expiredLanes)!==0||d)d=hh(c,b);else{d=b;var k=_n;_n|=2;var B=hb();(ni!==c||pi!==d)&&(Ca=null,nu=wt()+500,Yc(c,d));do try{YR();break}catch(ue){fb(c,ue)}while(!0);Eg(),sh.current=B,_n=k,Or!==null?d=0:(ni=null,pi=0,d=Zr)}if(d!==0){if(d===2&&(k=Q(c),k!==0&&(b=k,d=um(c,k))),d===1)throw v=ld,Yc(c,0),nc(c,b),Ji(c,wt()),v;if(d===6)nc(c,b);else{if(k=c.current.alternate,(b&30)===0&&!KR(k)&&(d=hh(c,b),d===2&&(B=Q(c),B!==0&&(b=B,d=um(c,B))),d===1))throw v=ld,Yc(c,0),nc(c,b),Ji(c,wt()),v;switch(c.finishedWork=k,c.finishedLanes=b,d){case 0:case 1:throw Error(t(345));case 2:Qc(c,Qi,Ca);break;case 3:if(nc(c,b),(b&130023424)===b&&(d=am+500-wt(),10<d)){if(rn(c,0)!==0)break;if(k=c.suspendedLanes,(k&b)!==b){Bi(),c.pingedLanes|=c.suspendedLanes&k;break}c.timeoutHandle=mg(Qc.bind(null,c,Qi,Ca),d);break}Qc(c,Qi,Ca);break;case 4:if(nc(c,b),(b&4194240)===b)break;for(d=c.eventTimes,k=-1;0<b;){var $=31-mn(b);B=1<<$,$=d[$],$>k&&(k=$),b&=~B}if(b=k,b=wt()-b,b=(120>b?120:480>b?480:1080>b?1080:1920>b?1920:3e3>b?3e3:4320>b?4320:1960*$R(b/1960))-b,10<b){c.timeoutHandle=mg(Qc.bind(null,c,Qi,Ca),b);break}Qc(c,Qi,Ca);break;case 5:Qc(c,Qi,Ca);break;default:throw Error(t(329))}}}return Ji(c,wt()),c.callbackNode===v?ub.bind(null,c):null}function um(c,d){var v=ud;return c.current.memoizedState.isDehydrated&&(Yc(c,d).flags|=256),c=hh(c,d),c!==2&&(d=Qi,Qi=v,d!==null&&dm(d)),c}function dm(c){Qi===null?Qi=c:Qi.push.apply(Qi,c)}function KR(c){for(var d=c;;){if(d.flags&16384){var v=d.updateQueue;if(v!==null&&(v=v.stores,v!==null))for(var b=0;b<v.length;b++){var k=v[b],B=k.getSnapshot;k=k.value;try{if(!Qo(B(),k))return!1}catch{return!1}}}if(v=d.child,d.subtreeFlags&16384&&v!==null)v.return=d,d=v;else{if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function nc(c,d){for(d&=~sm,d&=~ah,c.suspendedLanes|=d,c.pingedLanes&=~d,c=c.expirationTimes;0<d;){var v=31-mn(d),b=1<<v;c[v]=-1,d&=~b}}function db(c){if((_n&6)!==0)throw Error(t(327));ru();var d=rn(c,0);if((d&1)===0)return Ji(c,wt()),null;var v=hh(c,d);if(c.tag!==0&&v===2){var b=Q(c);b!==0&&(d=b,v=um(c,b))}if(v===1)throw v=ld,Yc(c,0),nc(c,d),Ji(c,wt()),v;if(v===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=d,Qc(c,Qi,Ca),Ji(c,wt()),null}function fm(c,d){var v=_n;_n|=1;try{return c(d)}finally{_n=v,_n===0&&(nu=wt()+500,jf&&Ka())}}function qc(c){ec!==null&&ec.tag===0&&(_n&6)===0&&ru();var d=_n;_n|=1;var v=zo.transition,b=mt;try{if(zo.transition=null,mt=1,c)return c()}finally{mt=b,zo.transition=v,_n=d,(_n&6)===0&&Ka()}}function hm(){xo=tu.current,or(tu)}function Yc(c,d){c.finishedWork=null,c.finishedLanes=0;var v=c.timeoutHandle;if(v!==-1&&(c.timeoutHandle=-1,AR(v)),Or!==null)for(v=Or.return;v!==null;){var b=v;switch(Ig(b),b.tag){case 1:b=b.type.childContextTypes,b!=null&&Lf();break;case 3:Ql(),or(Ki),or(Ai),Bg();break;case 5:Mg(b);break;case 4:Ql();break;case 13:or(Ir);break;case 19:or(Ir);break;case 10:Tg(b.type._context);break;case 22:case 23:hm()}v=v.return}if(ni=c,Or=c=rc(c.current,null),pi=xo=d,Zr=0,ld=null,sm=ah=Kc=0,Qi=ud=null,Zc!==null){for(d=0;d<Zc.length;d++)if(v=Zc[d],b=v.interleaved,b!==null){v.interleaved=null;var k=b.next,B=v.pending;if(B!==null){var $=B.next;B.next=k,b.next=$}v.pending=b}Zc=null}return c}function fb(c,d){do{var v=Or;try{if(Eg(),qf.current=eh,Yf){for(var b=wr.memoizedState;b!==null;){var k=b.queue;k!==null&&(k.pending=null),b=b.next}Yf=!1}if($c=0,ti=Hr=wr=null,rd=!1,id=0,om.current=null,v===null||v.return===null){Zr=1,ld=d,Or=null;break}e:{var B=c,$=v.return,ue=v,be=d;if(d=pi,ue.flags|=32768,be!==null&&typeof be=="object"&&typeof be.then=="function"){var Le=be,nt=ue,ot=nt.tag;if((nt.mode&1)===0&&(ot===0||ot===11||ot===15)){var tt=nt.alternate;tt?(nt.updateQueue=tt.updateQueue,nt.memoizedState=tt.memoizedState,nt.lanes=tt.lanes):(nt.updateQueue=null,nt.memoizedState=null)}var Rt=Fx($);if(Rt!==null){Rt.flags&=-257,Lx(Rt,$,ue,B,d),Rt.mode&1&&Ox(B,Le,d),d=Rt,be=Le;var Ft=d.updateQueue;if(Ft===null){var Ut=new Set;Ut.add(be),d.updateQueue=Ut}else Ft.add(be);break e}else{if((d&1)===0){Ox(B,Le,d),pm();break e}be=Error(t(426))}}else if(fr&&ue.mode&1){var Pr=Fx($);if(Pr!==null){(Pr.flags&65536)===0&&(Pr.flags|=256),Lx(Pr,$,ue,B,d),Ag(Jl(be,ue));break e}}B=be=Jl(be,ue),Zr!==4&&(Zr=2),ud===null?ud=[B]:ud.push(B),B=$;do{switch(B.tag){case 3:B.flags|=65536,d&=-d,B.lanes|=d;var De=Nx(B,be,d);ax(B,De);break e;case 1:ue=be;var we=B.type,Oe=B.stateNode;if((B.flags&128)===0&&(typeof we.getDerivedStateFromError=="function"||Oe!==null&&typeof Oe.componentDidCatch=="function"&&(Ja===null||!Ja.has(Oe)))){B.flags|=65536,d&=-d,B.lanes|=d;var ft=Bx(B,ue,d);ax(B,ft);break e}}B=B.return}while(B!==null)}gb(v)}catch(jt){d=jt,Or===v&&v!==null&&(Or=v=v.return);continue}break}while(!0)}function hb(){var c=sh.current;return sh.current=eh,c===null?eh:c}function pm(){(Zr===0||Zr===3||Zr===2)&&(Zr=4),ni===null||(Kc&268435455)===0&&(ah&268435455)===0||nc(ni,pi)}function hh(c,d){var v=_n;_n|=2;var b=hb();(ni!==c||pi!==d)&&(Ca=null,Yc(c,d));do try{qR();break}catch(k){fb(c,k)}while(!0);if(Eg(),_n=v,sh.current=b,Or!==null)throw Error(t(261));return ni=null,pi=0,Zr}function qR(){for(;Or!==null;)pb(Or)}function YR(){for(;Or!==null&&!xn();)pb(Or)}function pb(c){var d=yb(c.alternate,c,xo);c.memoizedProps=c.pendingProps,d===null?gb(c):Or=d,om.current=null}function gb(c){var d=c;do{var v=d.alternate;if(c=d.return,(d.flags&32768)===0){if(v=zR(v,d,xo),v!==null){Or=v;return}}else{if(v=WR(v,d),v!==null){v.flags&=32767,Or=v;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Zr=6,Or=null;return}}if(d=d.sibling,d!==null){Or=d;return}Or=d=c}while(d!==null);Zr===0&&(Zr=5)}function Qc(c,d,v){var b=mt,k=zo.transition;try{zo.transition=null,mt=1,QR(c,d,v,b)}finally{zo.transition=k,mt=b}return null}function QR(c,d,v,b){do ru();while(ec!==null);if((_n&6)!==0)throw Error(t(327));v=c.finishedWork;var k=c.finishedLanes;if(v===null)return null;if(c.finishedWork=null,c.finishedLanes=0,v===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var B=v.lanes|v.childLanes;if(We(c,B),c===ni&&(Or=ni=null,pi=0),(v.subtreeFlags&2064)===0&&(v.flags&2064)===0||lh||(lh=!0,Cb(tr,function(){return ru(),null})),B=(v.flags&15990)!==0,(v.subtreeFlags&15990)!==0||B){B=zo.transition,zo.transition=null;var $=mt;mt=1;var ue=_n;_n|=4,om.current=null,ZR(c,v),ob(v,c),yR(pg),rr=!!hg,pg=hg=null,c.current=v,XR(v),Ot(),_n=ue,mt=$,zo.transition=B}else c.current=v;if(lh&&(lh=!1,ec=c,uh=k),B=c.pendingLanes,B===0&&(Ja=null),ui(v.stateNode),Ji(c,wt()),d!==null)for(b=c.onRecoverableError,v=0;v<d.length;v++)k=d[v],b(k.value,{componentStack:k.stack,digest:k.digest});if(ch)throw ch=!1,c=cm,cm=null,c;return(uh&1)!==0&&c.tag!==0&&ru(),B=c.pendingLanes,(B&1)!==0?c===lm?dd++:(dd=0,lm=c):dd=0,Ka(),null}function ru(){if(ec!==null){var c=Kt(uh),d=zo.transition,v=mt;try{if(zo.transition=null,mt=16>c?16:c,ec===null)var b=!1;else{if(c=ec,ec=null,uh=0,(_n&6)!==0)throw Error(t(331));var k=_n;for(_n|=4,Mt=c.current;Mt!==null;){var B=Mt,$=B.child;if((Mt.flags&16)!==0){var ue=B.deletions;if(ue!==null){for(var be=0;be<ue.length;be++){var Le=ue[be];for(Mt=Le;Mt!==null;){var nt=Mt;switch(nt.tag){case 0:case 11:case 15:cd(8,nt,B)}var ot=nt.child;if(ot!==null)ot.return=nt,Mt=ot;else for(;Mt!==null;){nt=Mt;var tt=nt.sibling,Rt=nt.return;if(eb(nt),nt===Le){Mt=null;break}if(tt!==null){tt.return=Rt,Mt=tt;break}Mt=Rt}}}var Ft=B.alternate;if(Ft!==null){var Ut=Ft.child;if(Ut!==null){Ft.child=null;do{var Pr=Ut.sibling;Ut.sibling=null,Ut=Pr}while(Ut!==null)}}Mt=B}}if((B.subtreeFlags&2064)!==0&&$!==null)$.return=B,Mt=$;else e:for(;Mt!==null;){if(B=Mt,(B.flags&2048)!==0)switch(B.tag){case 0:case 11:case 15:cd(9,B,B.return)}var De=B.sibling;if(De!==null){De.return=B.return,Mt=De;break e}Mt=B.return}}var we=c.current;for(Mt=we;Mt!==null;){$=Mt;var Oe=$.child;if(($.subtreeFlags&2064)!==0&&Oe!==null)Oe.return=$,Mt=Oe;else e:for($=we;Mt!==null;){if(ue=Mt,(ue.flags&2048)!==0)try{switch(ue.tag){case 0:case 11:case 15:oh(9,ue)}}catch(jt){kr(ue,ue.return,jt)}if(ue===$){Mt=null;break e}var ft=ue.sibling;if(ft!==null){ft.return=ue.return,Mt=ft;break e}Mt=ue.return}}if(_n=k,Ka(),nr&&typeof nr.onPostCommitFiberRoot=="function")try{nr.onPostCommitFiberRoot(gn,c)}catch{}b=!0}return b}finally{mt=v,zo.transition=d}}return!1}function mb(c,d,v){d=Jl(v,d),d=Nx(c,d,1),c=Ya(c,d,1),d=Bi(),c!==null&&(Te(c,1,d),Ji(c,d))}function kr(c,d,v){if(c.tag===3)mb(c,c,v);else for(;d!==null;){if(d.tag===3){mb(d,c,v);break}else if(d.tag===1){var b=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(Ja===null||!Ja.has(b))){c=Jl(v,c),c=Bx(d,c,1),d=Ya(d,c,1),c=Bi(),d!==null&&(Te(d,1,c),Ji(d,c));break}}d=d.return}}function JR(c,d,v){var b=c.pingCache;b!==null&&b.delete(d),d=Bi(),c.pingedLanes|=c.suspendedLanes&v,ni===c&&(pi&v)===v&&(Zr===4||Zr===3&&(pi&130023424)===pi&&500>wt()-am?Yc(c,0):sm|=v),Ji(c,d)}function vb(c,d){d===0&&((c.mode&1)===0?d=1:(d=Hi,Hi<<=1,(Hi&130023424)===0&&(Hi=4194304)));var v=Bi();c=ma(c,d),c!==null&&(Te(c,d,v),Ji(c,v))}function eP(c){var d=c.memoizedState,v=0;d!==null&&(v=d.retryLane),vb(c,v)}function tP(c,d){var v=0;switch(c.tag){case 13:var b=c.stateNode,k=c.memoizedState;k!==null&&(v=k.retryLane);break;case 19:b=c.stateNode;break;default:throw Error(t(314))}b!==null&&b.delete(d),vb(c,v)}var yb;yb=function(c,d,v){if(c!==null)if(c.memoizedProps!==d.pendingProps||Ki.current)Yi=!0;else{if((c.lanes&v)===0&&(d.flags&128)===0)return Yi=!1,VR(c,d,v);Yi=(c.flags&131072)!==0}else Yi=!1,fr&&(d.flags&1048576)!==0&&Y1(d,Vf,d.index);switch(d.lanes=0,d.tag){case 2:var b=d.type;rh(c,d),c=d.pendingProps;var k=Hl(d,Ai.current);Yl(d,v),k=Lg(null,d,b,c,k,v);var B=Ug();return d.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,qi(b)?(B=!0,Uf(d)):B=!1,d.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,Pg(d),k.updater=th,d.stateNode=k,k._reactInternals=d,Hg(d,b,c,v),d=Kg(null,d,b,!0,B,v)):(d.tag=0,fr&&B&&bg(d),Ni(null,d,k,v),d=d.child),d;case 16:b=d.elementType;e:{switch(rh(c,d),c=d.pendingProps,k=b._init,b=k(b._payload),d.type=b,k=d.tag=rP(b),c=es(b,c),k){case 0:d=$g(null,d,b,c,v);break e;case 1:d=Wx(null,d,b,c,v);break e;case 11:d=Ux(null,d,b,c,v);break e;case 14:d=jx(null,d,b,es(b.type,c),v);break e}throw Error(t(306,b,""))}return d;case 0:return b=d.type,k=d.pendingProps,k=d.elementType===b?k:es(b,k),$g(c,d,b,k,v);case 1:return b=d.type,k=d.pendingProps,k=d.elementType===b?k:es(b,k),Wx(c,d,b,k,v);case 3:e:{if(Hx(d),c===null)throw Error(t(387));b=d.pendingProps,B=d.memoizedState,k=B.element,sx(c,d),$f(d,b,null,v);var $=d.memoizedState;if(b=$.element,B.isDehydrated)if(B={element:b,isDehydrated:!1,cache:$.cache,pendingSuspenseBoundaries:$.pendingSuspenseBoundaries,transitions:$.transitions},d.updateQueue.baseState=B,d.memoizedState=B,d.flags&256){k=Jl(Error(t(423)),d),d=Zx(c,d,b,v,k);break e}else if(b!==k){k=Jl(Error(t(424)),d),d=Zx(c,d,b,v,k);break e}else for(Co=Za(d.stateNode.containerInfo.firstChild),yo=d,fr=!0,Jo=null,v=ix(d,null,b,v),d.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if($l(),b===k){d=ya(c,d,v);break e}Ni(c,d,b,v)}d=d.child}return d;case 5:return lx(d),c===null&&Sg(d),b=d.type,k=d.pendingProps,B=c!==null?c.memoizedProps:null,$=k.children,gg(b,k)?$=null:B!==null&&gg(b,B)&&(d.flags|=32),zx(c,d),Ni(c,d,$,v),d.child;case 6:return c===null&&Sg(d),null;case 13:return Xx(c,d,v);case 4:return Dg(d,d.stateNode.containerInfo),b=d.pendingProps,c===null?d.child=Kl(d,null,b,v):Ni(c,d,b,v),d.child;case 11:return b=d.type,k=d.pendingProps,k=d.elementType===b?k:es(b,k),Ux(c,d,b,k,v);case 7:return Ni(c,d,d.pendingProps,v),d.child;case 8:return Ni(c,d,d.pendingProps.children,v),d.child;case 12:return Ni(c,d,d.pendingProps.children,v),d.child;case 10:e:{if(b=d.type._context,k=d.pendingProps,B=d.memoizedProps,$=k.value,Jn(Hf,b._currentValue),b._currentValue=$,B!==null)if(Qo(B.value,$)){if(B.children===k.children&&!Ki.current){d=ya(c,d,v);break e}}else for(B=d.child,B!==null&&(B.return=d);B!==null;){var ue=B.dependencies;if(ue!==null){$=B.child;for(var be=ue.firstContext;be!==null;){if(be.context===b){if(B.tag===1){be=va(-1,v&-v),be.tag=2;var Le=B.updateQueue;if(Le!==null){Le=Le.shared;var nt=Le.pending;nt===null?be.next=be:(be.next=nt.next,nt.next=be),Le.pending=be}}B.lanes|=v,be=B.alternate,be!==null&&(be.lanes|=v),_g(B.return,v,d),ue.lanes|=v;break}be=be.next}}else if(B.tag===10)$=B.type===d.type?null:B.child;else if(B.tag===18){if($=B.return,$===null)throw Error(t(341));$.lanes|=v,ue=$.alternate,ue!==null&&(ue.lanes|=v),_g($,v,d),$=B.sibling}else $=B.child;if($!==null)$.return=B;else for($=B;$!==null;){if($===d){$=null;break}if(B=$.sibling,B!==null){B.return=$.return,$=B;break}$=$.return}B=$}Ni(c,d,k.children,v),d=d.child}return d;case 9:return k=d.type,b=d.pendingProps.children,Yl(d,v),k=Go(k),b=b(k),d.flags|=1,Ni(c,d,b,v),d.child;case 14:return b=d.type,k=es(b,d.pendingProps),k=es(b.type,k),jx(c,d,b,k,v);case 15:return Gx(c,d,d.type,d.pendingProps,v);case 17:return b=d.type,k=d.pendingProps,k=d.elementType===b?k:es(b,k),rh(c,d),d.tag=1,qi(b)?(c=!0,Uf(d)):c=!1,Yl(d,v),Dx(d,b,k),Hg(d,b,k,v),Kg(null,d,b,!0,c,v);case 19:return Kx(c,d,v);case 22:return Vx(c,d,v)}throw Error(t(156,d.tag))};function Cb(c,d){return Xe(c,d)}function nP(c,d,v,b){this.tag=c,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wo(c,d,v,b){return new nP(c,d,v,b)}function gm(c){return c=c.prototype,!(!c||!c.isReactComponent)}function rP(c){if(typeof c=="function")return gm(c)?1:0;if(c!=null){if(c=c.$$typeof,c===Z)return 11;if(c===ve)return 14}return 2}function rc(c,d){var v=c.alternate;return v===null?(v=Wo(c.tag,d,c.key,c.mode),v.elementType=c.elementType,v.type=c.type,v.stateNode=c.stateNode,v.alternate=c,c.alternate=v):(v.pendingProps=d,v.type=c.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=c.flags&14680064,v.childLanes=c.childLanes,v.lanes=c.lanes,v.child=c.child,v.memoizedProps=c.memoizedProps,v.memoizedState=c.memoizedState,v.updateQueue=c.updateQueue,d=c.dependencies,v.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},v.sibling=c.sibling,v.index=c.index,v.ref=c.ref,v}function ph(c,d,v,b,k,B){var $=2;if(b=c,typeof c=="function")gm(c)&&($=1);else if(typeof c=="string")$=5;else e:switch(c){case P:return Jc(v.children,k,B,d);case j:$=8,k|=8;break;case X:return c=Wo(12,v,d,k|2),c.elementType=X,c.lanes=B,c;case ne:return c=Wo(13,v,d,k),c.elementType=ne,c.lanes=B,c;case pe:return c=Wo(19,v,d,k),c.elementType=pe,c.lanes=B,c;case Ne:return gh(v,k,B,d);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case L:$=10;break e;case G:$=9;break e;case Z:$=11;break e;case ve:$=14;break e;case Se:$=16,b=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return d=Wo($,v,d,k),d.elementType=c,d.type=b,d.lanes=B,d}function Jc(c,d,v,b){return c=Wo(7,c,b,d),c.lanes=v,c}function gh(c,d,v,b){return c=Wo(22,c,b,d),c.elementType=Ne,c.lanes=v,c.stateNode={isHidden:!1},c}function mm(c,d,v){return c=Wo(6,c,null,d),c.lanes=v,c}function vm(c,d,v){return d=Wo(4,c.children!==null?c.children:[],c.key,d),d.lanes=v,d.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},d}function iP(c,d,v,b,k){this.tag=d,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Be(0),this.expirationTimes=Be(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Be(0),this.identifierPrefix=b,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function ym(c,d,v,b,k,B,$,ue,be){return c=new iP(c,d,v,ue,be),d===1?(d=1,B===!0&&(d|=8)):d=0,B=Wo(3,null,null,d),c.current=B,B.stateNode=c,B.memoizedState={element:b,isDehydrated:v,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pg(B),c}function oP(c,d,v){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:b==null?null:""+b,children:c,containerInfo:d,implementation:v}}function xb(c){if(!c)return $a;c=c._reactInternals;e:{if(Fe(c)!==c||c.tag!==1)throw Error(t(170));var d=c;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(qi(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(c.tag===1){var v=c.type;if(qi(v))return $1(c,v,d)}return d}function bb(c,d,v,b,k,B,$,ue,be){return c=ym(v,b,!0,c,k,B,$,ue,be),c.context=xb(null),v=c.current,b=Bi(),k=tc(v),B=va(b,k),B.callback=d??null,Ya(v,B,k),c.current.lanes=k,Te(c,k,b),Ji(c,b),c}function mh(c,d,v,b){var k=d.current,B=Bi(),$=tc(k);return v=xb(v),d.context===null?d.context=v:d.pendingContext=v,d=va(B,$),d.payload={element:c},b=b===void 0?null:b,b!==null&&(d.callback=b),c=Ya(k,d,$),c!==null&&(rs(c,k,$,B),Xf(c,k,$)),$}function vh(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function Ib(c,d){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var v=c.retryLane;c.retryLane=v!==0&&v<d?v:d}}function Cm(c,d){Ib(c,d),(c=c.alternate)&&Ib(c,d)}function sP(){return null}var wb=typeof reportError=="function"?reportError:function(c){console.error(c)};function xm(c){this._internalRoot=c}yh.prototype.render=xm.prototype.render=function(c){var d=this._internalRoot;if(d===null)throw Error(t(409));mh(c,d,null,null)},yh.prototype.unmount=xm.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var d=c.containerInfo;qc(function(){mh(null,c,null,null)}),d[fa]=null}};function yh(c){this._internalRoot=c}yh.prototype.unstable_scheduleHydration=function(c){if(c){var d=xi();c={blockedOn:null,target:c,priority:d};for(var v=0;v<ho.length&&d!==0&&d<ho[v].priority;v++);ho.splice(v,0,c),v===0&&Zi(c)}};function bm(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function Ch(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function Sb(){}function aP(c,d,v,b,k){if(k){if(typeof b=="function"){var B=b;b=function(){var Le=vh($);B.call(Le)}}var $=bb(d,b,c,0,null,!1,!1,"",Sb);return c._reactRootContainer=$,c[fa]=$.current,Ku(c.nodeType===8?c.parentNode:c),qc(),$}for(;k=c.lastChild;)c.removeChild(k);if(typeof b=="function"){var ue=b;b=function(){var Le=vh(be);ue.call(Le)}}var be=ym(c,0,!1,null,null,!1,!1,"",Sb);return c._reactRootContainer=be,c[fa]=be.current,Ku(c.nodeType===8?c.parentNode:c),qc(function(){mh(d,be,v,b)}),be}function xh(c,d,v,b,k){var B=v._reactRootContainer;if(B){var $=B;if(typeof k=="function"){var ue=k;k=function(){var be=vh($);ue.call(be)}}mh(d,$,c,k)}else $=aP(v,d,c,k,b);return vh($)}sn=function(c){switch(c.tag){case 3:var d=c.stateNode;if(d.current.memoizedState.isDehydrated){var v=kt(d.pendingLanes);v!==0&&(dt(d,v|1),Ji(d,wt()),(_n&6)===0&&(nu=wt()+500,Ka()))}break;case 13:qc(function(){var b=ma(c,1);if(b!==null){var k=Bi();rs(b,c,1,k)}}),Cm(c,1)}},Fn=function(c){if(c.tag===13){var d=ma(c,134217728);if(d!==null){var v=Bi();rs(d,c,134217728,v)}Cm(c,134217728)}},Ci=function(c){if(c.tag===13){var d=tc(c),v=ma(c,d);if(v!==null){var b=Bi();rs(v,c,d,b)}Cm(c,d)}},xi=function(){return mt},Jr=function(c,d){var v=mt;try{return mt=c,d()}finally{mt=v}},Sr=function(c,d,v){switch(d){case"input":if(Vt(c,v),d=v.name,v.type==="radio"&&d!=null){for(v=c;v.parentNode;)v=v.parentNode;for(v=v.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<v.length;d++){var b=v[d];if(b!==c&&b.form===c.form){var k=Ff(b);if(!k)throw Error(t(90));Et(b),Vt(b,k)}}}break;case"textarea":nn(c,v);break;case"select":d=v.value,d!=null&&on(c,!!v.multiple,d,!1)}},zt=fm,dr=qc;var cP={usingClientEntryPoint:!1,Events:[Qu,zl,Ff,Qe,kn,fm]},fd={findFiberByHostInstance:Vc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lP={bundleType:fd.bundleType,version:fd.version,rendererPackageName:fd.rendererPackageName,rendererConfig:fd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=st(c),c===null?null:c.stateNode},findFiberByHostInstance:fd.findFiberByHostInstance||sP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bh.isDisabled&&bh.supportsFiber)try{gn=bh.inject(lP),nr=bh}catch{}}return eo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cP,eo.createPortal=function(c,d){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bm(d))throw Error(t(200));return oP(c,d,null,v)},eo.createRoot=function(c,d){if(!bm(c))throw Error(t(299));var v=!1,b="",k=wb;return d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(b=d.identifierPrefix),d.onRecoverableError!==void 0&&(k=d.onRecoverableError)),d=ym(c,1,!1,null,null,v,!1,b,k),c[fa]=d.current,Ku(c.nodeType===8?c.parentNode:c),new xm(d)},eo.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var d=c._reactInternals;if(d===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=st(d),c=c===null?null:c.stateNode,c},eo.flushSync=function(c){return qc(c)},eo.hydrate=function(c,d,v){if(!Ch(d))throw Error(t(200));return xh(null,c,d,!0,v)},eo.hydrateRoot=function(c,d,v){if(!bm(c))throw Error(t(405));var b=v!=null&&v.hydratedSources||null,k=!1,B="",$=wb;if(v!=null&&(v.unstable_strictMode===!0&&(k=!0),v.identifierPrefix!==void 0&&(B=v.identifierPrefix),v.onRecoverableError!==void 0&&($=v.onRecoverableError)),d=bb(d,null,c,1,v??null,k,!1,B,$),c[fa]=d.current,Ku(c),b)for(c=0;c<b.length;c++)v=b[c],k=v._getVersion,k=k(v._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[v,k]:d.mutableSourceEagerHydrationData.push(v,k);return new yh(d)},eo.render=function(c,d,v){if(!Ch(d))throw Error(t(200));return xh(null,c,d,!1,v)},eo.unmountComponentAtNode=function(c){if(!Ch(c))throw Error(t(40));return c._reactRootContainer?(qc(function(){xh(null,null,c,!1,function(){c._reactRootContainer=null,c[fa]=null})}),!0):!1},eo.unstable_batchedUpdates=fm,eo.unstable_renderSubtreeIntoContainer=function(c,d,v,b){if(!Ch(v))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return xh(c,d,v,!1,b)},eo.version="18.3.1-next-f1338f8080-20240426",eo}var Mb;function UA(){if(Mb)return Am.exports;Mb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Am.exports=xP(),Am.exports}var Nb;function bP(){if(Nb)return wh;Nb=1;var n=UA();return wh.createRoot=n.createRoot,wh.hydrateRoot=n.hydrateRoot,wh}var IP=bP();const wP=Ec(IP);var jA=UA();const SP=Ec(jA),AP=LA({__proto__:null,default:SP},[jA]);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hr(){return hr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},hr.apply(this,arguments)}var Lr;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Lr||(Lr={}));const Bb="popstate";function kP(n){n===void 0&&(n={});function e(r,i){let{pathname:o,search:a,hash:s}=r.location;return $d("",{pathname:o,search:a,hash:s},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:vf(i)}return TP(e,t,null,n)}function Mn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ku(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function EP(){return Math.random().toString(36).substr(2,8)}function Ob(n,e){return{usr:n.state,key:n.key,idx:e}}function $d(n,e,t,r){return t===void 0&&(t=null),hr({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Tc(e):e,{state:t,key:e&&e.key||r||EP()})}function vf(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Tc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function TP(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,a=i.history,s=Lr.Pop,l=null,f=h();f==null&&(f=0,a.replaceState(hr({},a.state,{idx:f}),""));function h(){return(a.state||{idx:null}).idx}function m(){s=Lr.Pop;let w=h(),S=w==null?null:w-f;f=w,l&&l({action:s,location:x.location,delta:S})}function g(w,S){s=Lr.Push;let A=$d(x.location,w,S);f=h()+1;let E=Ob(A,f),_=x.createHref(A);try{a.pushState(E,"",_)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(_)}o&&l&&l({action:s,location:x.location,delta:1})}function y(w,S){s=Lr.Replace;let A=$d(x.location,w,S);f=h();let E=Ob(A,f),_=x.createHref(A);a.replaceState(E,"",_),o&&l&&l({action:s,location:x.location,delta:0})}function C(w){let S=i.location.origin!=="null"?i.location.origin:i.location.href,A=typeof w=="string"?w:vf(w);return A=A.replace(/ $/,"%20"),Mn(S,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,S)}let x={get action(){return s},get location(){return n(i,a)},listen(w){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Bb,m),l=w,()=>{i.removeEventListener(Bb,m),l=null}},createHref(w){return e(i,w)},createURL:C,encodeLocation(w){let S=C(w);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:g,replace:y,go(w){return a.go(w)}};return x}var zn;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(zn||(zn={}));const _P=new Set(["lazy","caseSensitive","path","id","index","children"]);function RP(n){return n.index===!0}function X0(n,e,t,r){return t===void 0&&(t=[]),r===void 0&&(r={}),n.map((i,o)=>{let a=[...t,String(o)],s=typeof i.id=="string"?i.id:a.join("-");if(Mn(i.index!==!0||!i.children,"Cannot specify children on an index route"),Mn(!r[s],'Found a route id collision on id "'+s+`".  Route id's must be globally unique within Data Router usages`),RP(i)){let l=hr({},i,e(i),{id:s});return r[s]=l,l}else{let l=hr({},i,e(i),{id:s,children:void 0});return r[s]=l,i.children&&(l.children=X0(i.children,e,a,r)),l}})}function nl(n,e,t){return t===void 0&&(t="/"),Vh(n,e,t,!1)}function Vh(n,e,t,r){let i=typeof e=="string"?Tc(e):e,o=yf(i.pathname||"/",t);if(o==null)return null;let a=GA(n);DP(a);let s=null;for(let l=0;s==null&&l<a.length;++l){let f=zP(o);s=GP(a[l],f,r)}return s}function PP(n,e){let{route:t,pathname:r,params:i}=n;return{id:t.id,pathname:r,params:i,data:e[t.id],handle:t.handle}}function GA(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(o,a,s)=>{let l={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};l.relativePath.startsWith("/")&&(Mn(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let f=ul([r,l.relativePath]),h=t.concat(l);o.children&&o.children.length>0&&(Mn(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),GA(o.children,e,h,f)),!(o.path==null&&!o.index)&&e.push({path:f,score:UP(f,o.index),routesMeta:h})};return n.forEach((o,a)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))i(o,a);else for(let l of VA(o.path))i(o,a,l)}),e}function VA(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let a=VA(r.join("/")),s=[];return s.push(...a.map(l=>l===""?o:[o,l].join("/"))),i&&s.push(...a),s.map(l=>n.startsWith("/")&&l===""?"/":l)}function DP(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:jP(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const MP=/^:[\w-]+$/,NP=3,BP=2,OP=1,FP=10,LP=-2,Fb=n=>n==="*";function UP(n,e){let t=n.split("/"),r=t.length;return t.some(Fb)&&(r+=LP),e&&(r+=BP),t.filter(i=>!Fb(i)).reduce((i,o)=>i+(MP.test(o)?NP:o===""?OP:FP),r)}function jP(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function GP(n,e,t){t===void 0&&(t=!1);let{routesMeta:r}=n,i={},o="/",a=[];for(let s=0;s<r.length;++s){let l=r[s],f=s===r.length-1,h=o==="/"?e:e.slice(o.length)||"/",m=Lb({path:l.relativePath,caseSensitive:l.caseSensitive,end:f},h),g=l.route;if(!m&&f&&t&&!r[r.length-1].route.index&&(m=Lb({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!m)return null;Object.assign(i,m.params),a.push({params:i,pathname:ul([o,m.pathname]),pathnameBase:$P(ul([o,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(o=ul([o,m.pathnameBase]))}return a}function Lb(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=VP(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((f,h,m)=>{let{paramName:g,isOptional:y}=h;if(g==="*"){let x=s[m]||"";a=o.slice(0,o.length-x.length).replace(/(.)\/+$/,"$1")}const C=s[m];return y&&!C?f[g]=void 0:f[g]=(C||"").replace(/%2F/g,"/"),f},{}),pathname:o,pathnameBase:a,pattern:n}}function VP(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),ku(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,l)=>(r.push({paramName:s,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function zP(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ku(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function yf(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function WP(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Tc(n):n;return{pathname:t?t.startsWith("/")?t:HP(t,e):e,search:KP(r),hash:qP(i)}}function HP(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function Tm(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zA(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function ZP(n,e){let t=zA(n);return e?t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function XP(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=Tc(n):(i=hr({},n),Mn(!i.pathname||!i.pathname.includes("?"),Tm("?","pathname","search",i)),Mn(!i.pathname||!i.pathname.includes("#"),Tm("#","pathname","hash",i)),Mn(!i.search||!i.search.includes("#"),Tm("#","search","hash",i)));let o=n===""||i.pathname==="",a=o?"/":i.pathname,s;if(a==null)s=t;else{let m=e.length-1;if(!r&&a.startsWith("..")){let g=a.split("/");for(;g[0]==="..";)g.shift(),m-=1;i.pathname=g.join("/")}s=m>=0?e[m]:"/"}let l=WP(i,s),f=a&&a!=="/"&&a.endsWith("/"),h=(o||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(f||h)&&(l.pathname+="/"),l}const ul=n=>n.join("/").replace(/\/\/+/g,"/"),$P=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),KP=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,qP=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;class $0{constructor(e,t,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=t||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Kd(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const WA=["post","put","patch","delete"],YP=new Set(WA),QP=["get",...WA],JP=new Set(QP),eD=new Set([301,302,303,307,308]),tD=new Set([307,308]),_m={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},nD={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},pd={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Jy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rD=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),HA="remix-router-transitions";function iD(n){const e=n.window?n.window:typeof window<"u"?window:void 0,t=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!t;Mn(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(n.mapRouteProperties)i=n.mapRouteProperties;else if(n.detectErrorBoundary){let ge=n.detectErrorBoundary;i=Ie=>({hasErrorBoundary:ge(Ie)})}else i=rD;let o={},a=X0(n.routes,i,void 0,o),s,l=n.basename||"/",f=n.dataStrategy||cD,h=n.patchRoutesOnNavigation,m=hr({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},n.future),g=null,y=new Set,C=null,x=null,w=null,S=n.hydrationData!=null,A=nl(a,n.history.location,l),E=!1,_=null;if(A==null&&!h){let ge=no(404,{pathname:n.history.location.pathname}),{matches:Ie,route:J}=Kb(a);A=Ie,_={[J.id]:ge}}A&&!n.hydrationData&&dr(A,a,n.history.location.pathname).active&&(A=null);let T;if(A)if(A.some(ge=>ge.route.lazy))T=!1;else if(!A.some(ge=>ge.route.loader))T=!0;else if(m.v7_partialHydration){let ge=n.hydrationData?n.hydrationData.loaderData:null,Ie=n.hydrationData?n.hydrationData.errors:null;if(Ie){let J=A.findIndex(Ve=>Ie[Ve.route.id]!==void 0);T=A.slice(0,J+1).every(Ve=>!Tv(Ve.route,ge,Ie))}else T=A.every(J=>!Tv(J.route,ge,Ie))}else T=n.hydrationData!=null;else if(T=!1,A=[],m.v7_partialHydration){let ge=dr(null,a,n.history.location.pathname);ge.active&&ge.matches&&(E=!0,A=ge.matches)}let M,P={historyAction:n.history.action,location:n.history.location,matches:A,initialized:T,navigation:_m,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||_,fetchers:new Map,blockers:new Map},j=Lr.Pop,X=!1,L,G=!1,Z=new Map,ne=null,pe=!1,ve=!1,Se=[],Ne=new Set,xe=new Map,Ae=0,ke=-1,H=new Map,ee=new Set,ae=new Map,ye=new Map,Ee=new Set,_e=new Map,Je=new Map,me;function it(){if(g=n.history.listen(ge=>{let{action:Ie,location:J,delta:Ve}=ge;if(me){me(),me=void 0;return}ku(Je.size===0||Ve!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let rt=Sr({currentLocation:P.location,nextLocation:J,historyAction:Ie});if(rt&&Ve!=null){let _t=new Promise(Bt=>{me=Bt});n.history.go(Ve*-1),On(rt,{state:"blocked",location:J,proceed(){On(rt,{state:"proceeding",proceed:void 0,reset:void 0,location:J}),_t.then(()=>n.history.go(Ve))},reset(){let Bt=new Map(P.blockers);Bt.set(rt,pd),Et({blockers:Bt})}});return}return lt(Ie,J)}),t){ID(e,Z);let ge=()=>wD(e,Z);e.addEventListener("pagehide",ge),ne=()=>e.removeEventListener("pagehide",ge)}return P.initialized||lt(Lr.Pop,P.location,{initialHydration:!0}),M}function Tt(){g&&g(),ne&&ne(),y.clear(),L&&L.abort(),P.fetchers.forEach((ge,Ie)=>Ce(Ie)),P.blockers.forEach((ge,Ie)=>un(Ie))}function Xt(ge){return y.add(ge),()=>y.delete(ge)}function Et(ge,Ie){Ie===void 0&&(Ie={}),P=hr({},P,ge);let J=[],Ve=[];m.v7_fetcherPersist&&P.fetchers.forEach((rt,_t)=>{rt.state==="idle"&&(Ee.has(_t)?Ve.push(_t):J.push(_t))}),Ee.forEach(rt=>{!P.fetchers.has(rt)&&!xe.has(rt)&&Ve.push(rt)}),[...y].forEach(rt=>rt(P,{deletedFetchers:Ve,viewTransitionOpts:Ie.viewTransitionOpts,flushSync:Ie.flushSync===!0})),m.v7_fetcherPersist?(J.forEach(rt=>P.fetchers.delete(rt)),Ve.forEach(rt=>Ce(rt))):Ve.forEach(rt=>Ee.delete(rt))}function St(ge,Ie,J){var Ve,rt;let{flushSync:_t}=J===void 0?{}:J,Bt=P.actionData!=null&&P.navigation.formMethod!=null&&vs(P.navigation.formMethod)&&P.navigation.state==="loading"&&((Ve=ge.state)==null?void 0:Ve._isRedirect)!==!0,pt;Ie.actionData?Object.keys(Ie.actionData).length>0?pt=Ie.actionData:pt=null:Bt?pt=P.actionData:pt=null;let gt=Ie.loaderData?Xb(P.loaderData,Ie.loaderData,Ie.matches||[],Ie.errors):P.loaderData,bt=P.blockers;bt.size>0&&(bt=new Map(bt),bt.forEach((He,Cn)=>bt.set(Cn,pd)));let Fe=X===!0||P.navigation.formMethod!=null&&vs(P.navigation.formMethod)&&((rt=ge.state)==null?void 0:rt._isRedirect)!==!0;s&&(a=s,s=void 0),pe||j===Lr.Pop||(j===Lr.Push?n.history.push(ge,ge.state):j===Lr.Replace&&n.history.replace(ge,ge.state));let ut;if(j===Lr.Pop){let He=Z.get(P.location.pathname);He&&He.has(ge.pathname)?ut={currentLocation:P.location,nextLocation:ge}:Z.has(ge.pathname)&&(ut={currentLocation:ge,nextLocation:P.location})}else if(G){let He=Z.get(P.location.pathname);He?He.add(ge.pathname):(He=new Set([ge.pathname]),Z.set(P.location.pathname,He)),ut={currentLocation:P.location,nextLocation:ge}}Et(hr({},Ie,{actionData:pt,loaderData:gt,historyAction:j,location:ge,initialized:!0,navigation:_m,revalidation:"idle",restoreScrollPosition:zt(ge,Ie.matches||P.matches),preventScrollReset:Fe,blockers:bt}),{viewTransitionOpts:ut,flushSync:_t===!0}),j=Lr.Pop,X=!1,G=!1,pe=!1,ve=!1,Se=[]}async function Dt(ge,Ie){if(typeof ge=="number"){n.history.go(ge);return}let J=Ev(P.location,P.matches,l,m.v7_prependBasename,ge,m.v7_relativeSplatPath,Ie==null?void 0:Ie.fromRouteId,Ie==null?void 0:Ie.relative),{path:Ve,submission:rt,error:_t}=Ub(m.v7_normalizeFormMethod,!1,J,Ie),Bt=P.location,pt=$d(P.location,Ve,Ie&&Ie.state);pt=hr({},pt,n.history.encodeLocation(pt));let gt=Ie&&Ie.replace!=null?Ie.replace:void 0,bt=Lr.Push;gt===!0?bt=Lr.Replace:gt===!1||rt!=null&&vs(rt.formMethod)&&rt.formAction===P.location.pathname+P.location.search&&(bt=Lr.Replace);let Fe=Ie&&"preventScrollReset"in Ie?Ie.preventScrollReset===!0:void 0,ut=(Ie&&Ie.flushSync)===!0,He=Sr({currentLocation:Bt,nextLocation:pt,historyAction:bt});if(He){On(He,{state:"blocked",location:pt,proceed(){On(He,{state:"proceeding",proceed:void 0,reset:void 0,location:pt}),Dt(ge,Ie)},reset(){let Cn=new Map(P.blockers);Cn.set(He,pd),Et({blockers:Cn})}});return}return await lt(bt,pt,{submission:rt,pendingError:_t,preventScrollReset:Fe,replace:Ie&&Ie.replace,enableViewTransition:Ie&&Ie.viewTransition,flushSync:ut})}function at(){if(q(),Et({revalidation:"loading"}),P.navigation.state!=="submitting"){if(P.navigation.state==="idle"){lt(P.historyAction,P.location,{startUninterruptedRevalidation:!0});return}lt(j||P.historyAction,P.navigation.location,{overrideNavigation:P.navigation,enableViewTransition:G===!0})}}async function lt(ge,Ie,J){L&&L.abort(),L=null,j=ge,pe=(J&&J.startUninterruptedRevalidation)===!0,kn(P.location,P.matches),X=(J&&J.preventScrollReset)===!0,G=(J&&J.enableViewTransition)===!0;let Ve=s||a,rt=J&&J.overrideNavigation,_t=J!=null&&J.initialHydration&&P.matches&&P.matches.length>0&&!E?P.matches:nl(Ve,Ie,l),Bt=(J&&J.flushSync)===!0;if(_t&&P.initialized&&!ve&&pD(P.location,Ie)&&!(J&&J.submission&&vs(J.submission.formMethod))){St(Ie,{matches:_t},{flushSync:Bt});return}let pt=dr(_t,Ve,Ie.pathname);if(pt.active&&pt.matches&&(_t=pt.matches),!_t){let{error:st,notFoundMatches:de,route:Xe}=mr(Ie.pathname);St(Ie,{matches:de,loaderData:{},errors:{[Xe.id]:st}},{flushSync:Bt});return}L=new AbortController;let gt=iu(n.history,Ie,L.signal,J&&J.submission),bt;if(J&&J.pendingError)bt=[rl(_t).route.id,{type:zn.error,error:J.pendingError}];else if(J&&J.submission&&vs(J.submission.formMethod)){let st=await Vt(gt,Ie,J.submission,_t,pt.active,{replace:J.replace,flushSync:Bt});if(st.shortCircuited)return;if(st.pendingActionResult){let[de,Xe]=st.pendingActionResult;if(Ao(Xe)&&Kd(Xe.error)&&Xe.error.status===404){L=null,St(Ie,{matches:st.matches,loaderData:{},errors:{[de]:Xe.error}});return}}_t=st.matches||_t,bt=st.pendingActionResult,rt=Rm(Ie,J.submission),Bt=!1,pt.active=!1,gt=iu(n.history,gt.url,gt.signal)}let{shortCircuited:Fe,matches:ut,loaderData:He,errors:Cn}=await Gt(gt,Ie,_t,pt.active,rt,J&&J.submission,J&&J.fetcherSubmission,J&&J.replace,J&&J.initialHydration===!0,Bt,bt);Fe||(L=null,St(Ie,hr({matches:ut||_t},$b(bt),{loaderData:He,errors:Cn})))}async function Vt(ge,Ie,J,Ve,rt,_t){_t===void 0&&(_t={}),q();let Bt=xD(Ie,J);if(Et({navigation:Bt},{flushSync:_t.flushSync===!0}),rt){let bt=await Kn(Ve,Ie.pathname,ge.signal);if(bt.type==="aborted")return{shortCircuited:!0};if(bt.type==="error"){let Fe=rl(bt.partialMatches).route.id;return{matches:bt.partialMatches,pendingActionResult:[Fe,{type:zn.error,error:bt.error}]}}else if(bt.matches)Ve=bt.matches;else{let{notFoundMatches:Fe,error:ut,route:He}=mr(Ie.pathname);return{matches:Fe,pendingActionResult:[He.id,{type:zn.error,error:ut}]}}}let pt,gt=Nd(Ve,Ie);if(!gt.route.action&&!gt.route.lazy)pt={type:zn.error,error:no(405,{method:ge.method,pathname:Ie.pathname,routeId:gt.route.id})};else if(pt=(await pn("action",P,ge,[gt],Ve,null))[gt.route.id],ge.signal.aborted)return{shortCircuited:!0};if(al(pt)){let bt;return _t&&_t.replace!=null?bt=_t.replace:bt=Wb(pt.response.headers.get("Location"),new URL(ge.url),l)===P.location.pathname+P.location.search,await nn(ge,pt,!0,{submission:J,replace:bt}),{shortCircuited:!0}}if(Cc(pt))throw no(400,{type:"defer-action"});if(Ao(pt)){let bt=rl(Ve,gt.route.id);return(_t&&_t.replace)!==!0&&(j=Lr.Push),{matches:Ve,pendingActionResult:[bt.route.id,pt]}}return{matches:Ve,pendingActionResult:[gt.route.id,pt]}}async function Gt(ge,Ie,J,Ve,rt,_t,Bt,pt,gt,bt,Fe){let ut=rt||Rm(Ie,_t),He=_t||Bt||Yb(ut),Cn=!pe&&(!m.v7_partialHydration||!gt);if(Ve){if(Cn){let gn=Pt(Fe);Et(hr({navigation:ut},gn!==void 0?{actionData:gn}:{}),{flushSync:bt})}let tn=await Kn(J,Ie.pathname,ge.signal);if(tn.type==="aborted")return{shortCircuited:!0};if(tn.type==="error"){let gn=rl(tn.partialMatches).route.id;return{matches:tn.partialMatches,loaderData:{},errors:{[gn]:tn.error}}}else if(tn.matches)J=tn.matches;else{let{error:gn,notFoundMatches:nr,route:ui}=mr(Ie.pathname);return{matches:nr,loaderData:{},errors:{[ui.id]:gn}}}}let st=s||a,[de,Xe]=Gb(n.history,P,J,He,Ie,m.v7_partialHydration&&gt===!0,m.v7_skipActionErrorRevalidation,ve,Se,Ne,Ee,ae,ee,st,l,Fe);if(Qt(tn=>!(J&&J.some(gn=>gn.route.id===tn))||de&&de.some(gn=>gn.route.id===tn)),ke=++Ae,de.length===0&&Xe.length===0){let tn=fn();return St(Ie,hr({matches:J,loaderData:{},errors:Fe&&Ao(Fe[1])?{[Fe[0]]:Fe[1].error}:null},$b(Fe),tn?{fetchers:new Map(P.fetchers)}:{}),{flushSync:bt}),{shortCircuited:!0}}if(Cn){let tn={};if(!Ve){tn.navigation=ut;let gn=Pt(Fe);gn!==void 0&&(tn.actionData=gn)}Xe.length>0&&(tn.fetchers=Ht(Xe)),Et(tn,{flushSync:bt})}Xe.forEach(tn=>{Ge(tn.key),tn.controller&&xe.set(tn.key,tn.controller)});let It=()=>Xe.forEach(tn=>Ge(tn.key));L&&L.signal.addEventListener("abort",It);let{loaderResults:xn,fetcherResults:Ot}=await Un(P,J,de,Xe,ge);if(ge.signal.aborted)return{shortCircuited:!0};L&&L.signal.removeEventListener("abort",It),Xe.forEach(tn=>xe.delete(tn.key));let wt=Sh(xn);if(wt)return await nn(ge,wt.result,!0,{replace:pt}),{shortCircuited:!0};if(wt=Sh(Ot),wt)return ee.add(wt.key),await nn(ge,wt.result,!0,{replace:pt}),{shortCircuited:!0};let{loaderData:Wt,errors:qn}=Zb(P,J,xn,Fe,Xe,Ot,_e);_e.forEach((tn,gn)=>{tn.subscribe(nr=>{(nr||tn.done)&&_e.delete(gn)})}),m.v7_partialHydration&&gt&&P.errors&&(qn=hr({},P.errors,qn));let Yn=fn(),tr=hn(ke),Nn=Yn||tr||Xe.length>0;return hr({matches:J,loaderData:Wt,errors:qn},Nn?{fetchers:new Map(P.fetchers)}:{})}function Pt(ge){if(ge&&!Ao(ge[1]))return{[ge[0]]:ge[1].data};if(P.actionData)return Object.keys(P.actionData).length===0?null:P.actionData}function Ht(ge){return ge.forEach(Ie=>{let J=P.fetchers.get(Ie.key),Ve=gd(void 0,J?J.data:void 0);P.fetchers.set(Ie.key,Ve)}),new Map(P.fetchers)}function on(ge,Ie,J,Ve){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Ge(ge);let rt=(Ve&&Ve.flushSync)===!0,_t=s||a,Bt=Ev(P.location,P.matches,l,m.v7_prependBasename,J,m.v7_relativeSplatPath,Ie,Ve==null?void 0:Ve.relative),pt=nl(_t,Bt,l),gt=dr(pt,_t,Bt);if(gt.active&&gt.matches&&(pt=gt.matches),!pt){F(ge,Ie,no(404,{pathname:Bt}),{flushSync:rt});return}let{path:bt,submission:Fe,error:ut}=Ub(m.v7_normalizeFormMethod,!0,Bt,Ve);if(ut){F(ge,Ie,ut,{flushSync:rt});return}let He=Nd(pt,bt),Cn=(Ve&&Ve.preventScrollReset)===!0;if(Fe&&vs(Fe.formMethod)){ct(ge,Ie,bt,He,pt,gt.active,rt,Cn,Fe);return}ae.set(ge,{routeId:Ie,path:bt}),ce(ge,Ie,bt,He,pt,gt.active,rt,Cn,Fe)}async function ct(ge,Ie,J,Ve,rt,_t,Bt,pt,gt){q(),ae.delete(ge);function bt(mn){if(!mn.route.action&&!mn.route.lazy){let jr=no(405,{method:gt.formMethod,pathname:J,routeId:Ie});return F(ge,Ie,jr,{flushSync:Bt}),!0}return!1}if(!_t&&bt(Ve))return;let Fe=P.fetchers.get(ge);N(ge,bD(gt,Fe),{flushSync:Bt});let ut=new AbortController,He=iu(n.history,J,ut.signal,gt);if(_t){let mn=await Kn(rt,new URL(He.url).pathname,He.signal,ge);if(mn.type==="aborted")return;if(mn.type==="error"){F(ge,Ie,mn.error,{flushSync:Bt});return}else if(mn.matches){if(rt=mn.matches,Ve=Nd(rt,J),bt(Ve))return}else{F(ge,Ie,no(404,{pathname:J}),{flushSync:Bt});return}}xe.set(ge,ut);let Cn=Ae,de=(await pn("action",P,He,[Ve],rt,ge))[Ve.route.id];if(He.signal.aborted){xe.get(ge)===ut&&xe.delete(ge);return}if(m.v7_fetcherPersist&&Ee.has(ge)){if(al(de)||Ao(de)){N(ge,lc(void 0));return}}else{if(al(de))if(xe.delete(ge),ke>Cn){N(ge,lc(void 0));return}else return ee.add(ge),N(ge,gd(gt)),nn(He,de,!1,{fetcherSubmission:gt,preventScrollReset:pt});if(Ao(de)){F(ge,Ie,de.error);return}}if(Cc(de))throw no(400,{type:"defer-action"});let Xe=P.navigation.location||P.location,It=iu(n.history,Xe,ut.signal),xn=s||a,Ot=P.navigation.state!=="idle"?nl(xn,P.navigation.location,l):P.matches;Mn(Ot,"Didn't find any matches after fetcher action");let wt=++Ae;H.set(ge,wt);let Wt=gd(gt,de.data);P.fetchers.set(ge,Wt);let[qn,Yn]=Gb(n.history,P,Ot,gt,Xe,!1,m.v7_skipActionErrorRevalidation,ve,Se,Ne,Ee,ae,ee,xn,l,[Ve.route.id,de]);Yn.filter(mn=>mn.key!==ge).forEach(mn=>{let jr=mn.key,At=P.fetchers.get(jr),Mo=gd(void 0,At?At.data:void 0);P.fetchers.set(jr,Mo),Ge(jr),mn.controller&&xe.set(jr,mn.controller)}),Et({fetchers:new Map(P.fetchers)});let tr=()=>Yn.forEach(mn=>Ge(mn.key));ut.signal.addEventListener("abort",tr);let{loaderResults:Nn,fetcherResults:tn}=await Un(P,Ot,qn,Yn,It);if(ut.signal.aborted)return;ut.signal.removeEventListener("abort",tr),H.delete(ge),xe.delete(ge),Yn.forEach(mn=>xe.delete(mn.key));let gn=Sh(Nn);if(gn)return nn(It,gn.result,!1,{preventScrollReset:pt});if(gn=Sh(tn),gn)return ee.add(gn.key),nn(It,gn.result,!1,{preventScrollReset:pt});let{loaderData:nr,errors:ui}=Zb(P,Ot,Nn,void 0,Yn,tn,_e);if(P.fetchers.has(ge)){let mn=lc(de.data);P.fetchers.set(ge,mn)}hn(wt),P.navigation.state==="loading"&&wt>ke?(Mn(j,"Expected pending action"),L&&L.abort(),St(P.navigation.location,{matches:Ot,loaderData:nr,errors:ui,fetchers:new Map(P.fetchers)})):(Et({errors:ui,loaderData:Xb(P.loaderData,nr,Ot,ui),fetchers:new Map(P.fetchers)}),ve=!1)}async function ce(ge,Ie,J,Ve,rt,_t,Bt,pt,gt){let bt=P.fetchers.get(ge);N(ge,gd(gt,bt?bt.data:void 0),{flushSync:Bt});let Fe=new AbortController,ut=iu(n.history,J,Fe.signal);if(_t){let de=await Kn(rt,new URL(ut.url).pathname,ut.signal,ge);if(de.type==="aborted")return;if(de.type==="error"){F(ge,Ie,de.error,{flushSync:Bt});return}else if(de.matches)rt=de.matches,Ve=Nd(rt,J);else{F(ge,Ie,no(404,{pathname:J}),{flushSync:Bt});return}}xe.set(ge,Fe);let He=Ae,st=(await pn("loader",P,ut,[Ve],rt,ge))[Ve.route.id];if(Cc(st)&&(st=await eC(st,ut.signal,!0)||st),xe.get(ge)===Fe&&xe.delete(ge),!ut.signal.aborted){if(Ee.has(ge)){N(ge,lc(void 0));return}if(al(st))if(ke>He){N(ge,lc(void 0));return}else{ee.add(ge),await nn(ut,st,!1,{preventScrollReset:pt});return}if(Ao(st)){F(ge,Ie,st.error);return}Mn(!Cc(st),"Unhandled fetcher deferred data"),N(ge,lc(st.data))}}async function nn(ge,Ie,J,Ve){let{submission:rt,fetcherSubmission:_t,preventScrollReset:Bt,replace:pt}=Ve===void 0?{}:Ve;Ie.response.headers.has("X-Remix-Revalidate")&&(ve=!0);let gt=Ie.response.headers.get("Location");Mn(gt,"Expected a Location header on the redirect Response"),gt=Wb(gt,new URL(ge.url),l);let bt=$d(P.location,gt,{_isRedirect:!0});if(t){let de=!1;if(Ie.response.headers.has("X-Remix-Reload-Document"))de=!0;else if(Jy.test(gt)){const Xe=n.history.createURL(gt);de=Xe.origin!==e.location.origin||yf(Xe.pathname,l)==null}if(de){pt?e.location.replace(gt):e.location.assign(gt);return}}L=null;let Fe=pt===!0||Ie.response.headers.has("X-Remix-Replace")?Lr.Replace:Lr.Push,{formMethod:ut,formAction:He,formEncType:Cn}=P.navigation;!rt&&!_t&&ut&&He&&Cn&&(rt=Yb(P.navigation));let st=rt||_t;if(tD.has(Ie.response.status)&&st&&vs(st.formMethod))await lt(Fe,bt,{submission:hr({},st,{formAction:gt}),preventScrollReset:Bt||X,enableViewTransition:J?G:void 0});else{let de=Rm(bt,rt);await lt(Fe,bt,{overrideNavigation:de,fetcherSubmission:_t,preventScrollReset:Bt||X,enableViewTransition:J?G:void 0})}}async function pn(ge,Ie,J,Ve,rt,_t){let Bt,pt={};try{Bt=await lD(f,ge,Ie,J,Ve,rt,_t,o,i)}catch(gt){return Ve.forEach(bt=>{pt[bt.route.id]={type:zn.error,error:gt}}),pt}for(let[gt,bt]of Object.entries(Bt))if(gD(bt)){let Fe=bt.result;pt[gt]={type:zn.redirect,response:fD(Fe,J,gt,rt,l,m.v7_relativeSplatPath)}}else pt[gt]=await dD(bt);return pt}async function Un(ge,Ie,J,Ve,rt){let _t=ge.matches,Bt=pn("loader",ge,rt,J,Ie,null),pt=Promise.all(Ve.map(async Fe=>{if(Fe.matches&&Fe.match&&Fe.controller){let He=(await pn("loader",ge,iu(n.history,Fe.path,Fe.controller.signal),[Fe.match],Fe.matches,Fe.key))[Fe.match.route.id];return{[Fe.key]:He}}else return Promise.resolve({[Fe.key]:{type:zn.error,error:no(404,{pathname:Fe.path})}})})),gt=await Bt,bt=(await pt).reduce((Fe,ut)=>Object.assign(Fe,ut),{});return await Promise.all([yD(Ie,gt,rt.signal,_t,ge.loaderData),CD(Ie,bt,Ve)]),{loaderResults:gt,fetcherResults:bt}}function q(){ve=!0,Se.push(...Qt()),ae.forEach((ge,Ie)=>{xe.has(Ie)&&Ne.add(Ie),Ge(Ie)})}function N(ge,Ie,J){J===void 0&&(J={}),P.fetchers.set(ge,Ie),Et({fetchers:new Map(P.fetchers)},{flushSync:(J&&J.flushSync)===!0})}function F(ge,Ie,J,Ve){Ve===void 0&&(Ve={});let rt=rl(P.matches,Ie);Ce(ge),Et({errors:{[rt.route.id]:J},fetchers:new Map(P.fetchers)},{flushSync:(Ve&&Ve.flushSync)===!0})}function te(ge){return ye.set(ge,(ye.get(ge)||0)+1),Ee.has(ge)&&Ee.delete(ge),P.fetchers.get(ge)||nD}function Ce(ge){let Ie=P.fetchers.get(ge);xe.has(ge)&&!(Ie&&Ie.state==="loading"&&H.has(ge))&&Ge(ge),ae.delete(ge),H.delete(ge),ee.delete(ge),m.v7_fetcherPersist&&Ee.delete(ge),Ne.delete(ge),P.fetchers.delete(ge)}function Pe(ge){let Ie=(ye.get(ge)||0)-1;Ie<=0?(ye.delete(ge),Ee.add(ge),m.v7_fetcherPersist||Ce(ge)):ye.set(ge,Ie),Et({fetchers:new Map(P.fetchers)})}function Ge(ge){let Ie=xe.get(ge);Ie&&(Ie.abort(),xe.delete(ge))}function Lt(ge){for(let Ie of ge){let J=te(Ie),Ve=lc(J.data);P.fetchers.set(Ie,Ve)}}function fn(){let ge=[],Ie=!1;for(let J of ee){let Ve=P.fetchers.get(J);Mn(Ve,"Expected fetcher: "+J),Ve.state==="loading"&&(ee.delete(J),ge.push(J),Ie=!0)}return Lt(ge),Ie}function hn(ge){let Ie=[];for(let[J,Ve]of H)if(Ve<ge){let rt=P.fetchers.get(J);Mn(rt,"Expected fetcher: "+J),rt.state==="loading"&&(Ge(J),H.delete(J),Ie.push(J))}return Lt(Ie),Ie.length>0}function yn(ge,Ie){let J=P.blockers.get(ge)||pd;return Je.get(ge)!==Ie&&Je.set(ge,Ie),J}function un(ge){P.blockers.delete(ge),Je.delete(ge)}function On(ge,Ie){let J=P.blockers.get(ge)||pd;Mn(J.state==="unblocked"&&Ie.state==="blocked"||J.state==="blocked"&&Ie.state==="blocked"||J.state==="blocked"&&Ie.state==="proceeding"||J.state==="blocked"&&Ie.state==="unblocked"||J.state==="proceeding"&&Ie.state==="unblocked","Invalid blocker state transition: "+J.state+" -> "+Ie.state);let Ve=new Map(P.blockers);Ve.set(ge,Ie),Et({blockers:Ve})}function Sr(ge){let{currentLocation:Ie,nextLocation:J,historyAction:Ve}=ge;if(Je.size===0)return;Je.size>1&&ku(!1,"A router only supports one blocker at a time");let rt=Array.from(Je.entries()),[_t,Bt]=rt[rt.length-1],pt=P.blockers.get(_t);if(!(pt&&pt.state==="proceeding")&&Bt({currentLocation:Ie,nextLocation:J,historyAction:Ve}))return _t}function mr(ge){let Ie=no(404,{pathname:ge}),J=s||a,{matches:Ve,route:rt}=Kb(J);return Qt(),{notFoundMatches:Ve,route:rt,error:Ie}}function Qt(ge){let Ie=[];return _e.forEach((J,Ve)=>{(!ge||ge(Ve))&&(J.cancel(),Ie.push(Ve),_e.delete(Ve))}),Ie}function Yr(ge,Ie,J){if(C=ge,w=Ie,x=J||null,!S&&P.navigation===_m){S=!0;let Ve=zt(P.location,P.matches);Ve!=null&&Et({restoreScrollPosition:Ve})}return()=>{C=null,w=null,x=null}}function Qe(ge,Ie){return x&&x(ge,Ie.map(Ve=>PP(Ve,P.loaderData)))||ge.key}function kn(ge,Ie){if(C&&w){let J=Qe(ge,Ie);C[J]=w()}}function zt(ge,Ie){if(C){let J=Qe(ge,Ie),Ve=C[J];if(typeof Ve=="number")return Ve}return null}function dr(ge,Ie,J){if(h)if(ge){if(Object.keys(ge[0].params).length>0)return{active:!0,matches:Vh(Ie,J,l,!0)}}else return{active:!0,matches:Vh(Ie,J,l,!0)||[]};return{active:!1,matches:null}}async function Kn(ge,Ie,J,Ve){if(!h)return{type:"success",matches:ge};let rt=ge;for(;;){let _t=s==null,Bt=s||a,pt=o;try{await h({signal:J,path:Ie,matches:rt,fetcherKey:Ve,patch:(Fe,ut)=>{J.aborted||zb(Fe,ut,Bt,pt,i)}})}catch(Fe){return{type:"error",error:Fe,partialMatches:rt}}finally{_t&&!J.aborted&&(a=[...a])}if(J.aborted)return{type:"aborted"};let gt=nl(Bt,Ie,l);if(gt)return{type:"success",matches:gt};let bt=Vh(Bt,Ie,l,!0);if(!bt||rt.length===bt.length&&rt.every((Fe,ut)=>Fe.route.id===bt[ut].route.id))return{type:"success",matches:null};rt=bt}}function Qr(ge){o={},s=X0(ge,i,void 0,o)}function Br(ge,Ie){let J=s==null;zb(ge,Ie,s||a,o,i),J&&(a=[...a],Et({}))}return M={get basename(){return l},get future(){return m},get state(){return P},get routes(){return a},get window(){return e},initialize:it,subscribe:Xt,enableScrollRestoration:Yr,navigate:Dt,fetch:on,revalidate:at,createHref:ge=>n.history.createHref(ge),encodeLocation:ge=>n.history.encodeLocation(ge),getFetcher:te,deleteFetcher:Pe,dispose:Tt,getBlocker:yn,deleteBlocker:un,patchRoutes:Br,_internalFetchControllers:xe,_internalActiveDeferreds:_e,_internalSetRoutes:Qr},M}function oD(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function Ev(n,e,t,r,i,o,a,s){let l,f;if(a){l=[];for(let m of e)if(l.push(m),m.route.id===a){f=m;break}}else l=e,f=e[e.length-1];let h=XP(i||".",ZP(l,o),yf(n.pathname,t)||n.pathname,s==="path");if(i==null&&(h.search=n.search,h.hash=n.hash),(i==null||i===""||i===".")&&f){let m=tC(h.search);if(f.route.index&&!m)h.search=h.search?h.search.replace(/^\?/,"?index&"):"?index";else if(!f.route.index&&m){let g=new URLSearchParams(h.search),y=g.getAll("index");g.delete("index"),y.filter(x=>x).forEach(x=>g.append("index",x));let C=g.toString();h.search=C?"?"+C:""}}return r&&t!=="/"&&(h.pathname=h.pathname==="/"?t:ul([t,h.pathname])),vf(h)}function Ub(n,e,t,r){if(!r||!oD(r))return{path:t};if(r.formMethod&&!vD(r.formMethod))return{path:t,error:no(405,{method:r.formMethod})};let i=()=>({path:t,error:no(400,{type:"invalid-body"})}),o=r.formMethod||"get",a=n?o.toUpperCase():o.toLowerCase(),s=$A(t);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!vs(a))return i();let g=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((y,C)=>{let[x,w]=C;return""+y+x+"="+w+`
`},""):String(r.body);return{path:t,submission:{formMethod:a,formAction:s,formEncType:r.formEncType,formData:void 0,json:void 0,text:g}}}else if(r.formEncType==="application/json"){if(!vs(a))return i();try{let g=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:t,submission:{formMethod:a,formAction:s,formEncType:r.formEncType,formData:void 0,json:g,text:void 0}}}catch{return i()}}}Mn(typeof FormData=="function","FormData is not available in this environment");let l,f;if(r.formData)l=_v(r.formData),f=r.formData;else if(r.body instanceof FormData)l=_v(r.body),f=r.body;else if(r.body instanceof URLSearchParams)l=r.body,f=Hb(l);else if(r.body==null)l=new URLSearchParams,f=new FormData;else try{l=new URLSearchParams(r.body),f=Hb(l)}catch{return i()}let h={formMethod:a,formAction:s,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:f,json:void 0,text:void 0};if(vs(h.formMethod))return{path:t,submission:h};let m=Tc(t);return e&&m.search&&tC(m.search)&&l.append("index",""),m.search="?"+l,{path:vf(m),submission:h}}function jb(n,e,t){t===void 0&&(t=!1);let r=n.findIndex(i=>i.route.id===e);return r>=0?n.slice(0,t?r+1:r):n}function Gb(n,e,t,r,i,o,a,s,l,f,h,m,g,y,C,x){let w=x?Ao(x[1])?x[1].error:x[1].data:void 0,S=n.createURL(e.location),A=n.createURL(i),E=t;o&&e.errors?E=jb(t,Object.keys(e.errors)[0],!0):x&&Ao(x[1])&&(E=jb(t,x[0]));let _=x?x[1].statusCode:void 0,T=a&&_&&_>=400,M=E.filter((j,X)=>{let{route:L}=j;if(L.lazy)return!0;if(L.loader==null)return!1;if(o)return Tv(L,e.loaderData,e.errors);if(sD(e.loaderData,e.matches[X],j)||l.some(ne=>ne===j.route.id))return!0;let G=e.matches[X],Z=j;return Vb(j,hr({currentUrl:S,currentParams:G.params,nextUrl:A,nextParams:Z.params},r,{actionResult:w,actionStatus:_,defaultShouldRevalidate:T?!1:s||S.pathname+S.search===A.pathname+A.search||S.search!==A.search||ZA(G,Z)}))}),P=[];return m.forEach((j,X)=>{if(o||!t.some(pe=>pe.route.id===j.routeId)||h.has(X))return;let L=nl(y,j.path,C);if(!L){P.push({key:X,routeId:j.routeId,path:j.path,matches:null,match:null,controller:null});return}let G=e.fetchers.get(X),Z=Nd(L,j.path),ne=!1;g.has(X)?ne=!1:f.has(X)?(f.delete(X),ne=!0):G&&G.state!=="idle"&&G.data===void 0?ne=s:ne=Vb(Z,hr({currentUrl:S,currentParams:e.matches[e.matches.length-1].params,nextUrl:A,nextParams:t[t.length-1].params},r,{actionResult:w,actionStatus:_,defaultShouldRevalidate:T?!1:s})),ne&&P.push({key:X,routeId:j.routeId,path:j.path,matches:L,match:Z,controller:new AbortController})}),[M,P]}function Tv(n,e,t){if(n.lazy)return!0;if(!n.loader)return!1;let r=e!=null&&e[n.id]!==void 0,i=t!=null&&t[n.id]!==void 0;return!r&&i?!1:typeof n.loader=="function"&&n.loader.hydrate===!0?!0:!r&&!i}function sD(n,e,t){let r=!e||t.route.id!==e.route.id,i=n[t.route.id]===void 0;return r||i}function ZA(n,e){let t=n.route.path;return n.pathname!==e.pathname||t!=null&&t.endsWith("*")&&n.params["*"]!==e.params["*"]}function Vb(n,e){if(n.route.shouldRevalidate){let t=n.route.shouldRevalidate(e);if(typeof t=="boolean")return t}return e.defaultShouldRevalidate}function zb(n,e,t,r,i){var o;let a;if(n){let f=r[n];Mn(f,"No route found to patch children into: routeId = "+n),f.children||(f.children=[]),a=f.children}else a=t;let s=e.filter(f=>!a.some(h=>XA(f,h))),l=X0(s,i,[n||"_","patch",String(((o=a)==null?void 0:o.length)||"0")],r);a.push(...l)}function XA(n,e){return"id"in n&&"id"in e&&n.id===e.id?!0:n.index===e.index&&n.path===e.path&&n.caseSensitive===e.caseSensitive?(!n.children||n.children.length===0)&&(!e.children||e.children.length===0)?!0:n.children.every((t,r)=>{var i;return(i=e.children)==null?void 0:i.some(o=>XA(t,o))}):!1}async function aD(n,e,t){if(!n.lazy)return;let r=await n.lazy();if(!n.lazy)return;let i=t[n.id];Mn(i,"No route found in manifest");let o={};for(let a in r){let l=i[a]!==void 0&&a!=="hasErrorBoundary";ku(!l,'Route "'+i.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!l&&!_P.has(a)&&(o[a]=r[a])}Object.assign(i,o),Object.assign(i,hr({},e(i),{lazy:void 0}))}async function cD(n){let{matches:e}=n,t=e.filter(i=>i.shouldLoad);return(await Promise.all(t.map(i=>i.resolve()))).reduce((i,o,a)=>Object.assign(i,{[t[a].route.id]:o}),{})}async function lD(n,e,t,r,i,o,a,s,l,f){let h=o.map(y=>y.route.lazy?aD(y.route,l,s):void 0),m=o.map((y,C)=>{let x=h[C],w=i.some(A=>A.route.id===y.route.id);return hr({},y,{shouldLoad:w,resolve:async A=>(A&&r.method==="GET"&&(y.route.lazy||y.route.loader)&&(w=!0),w?uD(e,r,y,x,A,f):Promise.resolve({type:zn.data,result:void 0}))})}),g=await n({matches:m,request:r,params:o[0].params,fetcherKey:a,context:f});try{await Promise.all(h)}catch{}return g}async function uD(n,e,t,r,i,o){let a,s,l=f=>{let h,m=new Promise((C,x)=>h=x);s=()=>h(),e.signal.addEventListener("abort",s);let g=C=>typeof f!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+n+'" [routeId: '+t.route.id+"]"))):f({request:e,params:t.params,context:o},...C!==void 0?[C]:[]),y=(async()=>{try{return{type:"data",result:await(i?i(x=>g(x)):g())}}catch(C){return{type:"error",result:C}}})();return Promise.race([y,m])};try{let f=t.route[n];if(r)if(f){let h,[m]=await Promise.all([l(f).catch(g=>{h=g}),r]);if(h!==void 0)throw h;a=m}else if(await r,f=t.route[n],f)a=await l(f);else if(n==="action"){let h=new URL(e.url),m=h.pathname+h.search;throw no(405,{method:e.method,pathname:m,routeId:t.route.id})}else return{type:zn.data,result:void 0};else if(f)a=await l(f);else{let h=new URL(e.url),m=h.pathname+h.search;throw no(404,{pathname:m})}Mn(a.result!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+t.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(f){return{type:zn.error,result:f}}finally{s&&e.signal.removeEventListener("abort",s)}return a}async function dD(n){let{result:e,type:t}=n;if(KA(e)){let m;try{let g=e.headers.get("Content-Type");g&&/\bapplication\/json\b/.test(g)?e.body==null?m=null:m=await e.json():m=await e.text()}catch(g){return{type:zn.error,error:g}}return t===zn.error?{type:zn.error,error:new $0(e.status,e.statusText,m),statusCode:e.status,headers:e.headers}:{type:zn.data,data:m,statusCode:e.status,headers:e.headers}}if(t===zn.error){if(qb(e)){var r,i;if(e.data instanceof Error){var o,a;return{type:zn.error,error:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}}return{type:zn.error,error:new $0(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:Kd(e)?e.status:void 0,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:zn.error,error:e,statusCode:Kd(e)?e.status:void 0}}if(mD(e)){var s,l;return{type:zn.deferred,deferredData:e,statusCode:(s=e.init)==null?void 0:s.status,headers:((l=e.init)==null?void 0:l.headers)&&new Headers(e.init.headers)}}if(qb(e)){var f,h;return{type:zn.data,data:e.data,statusCode:(f=e.init)==null?void 0:f.status,headers:(h=e.init)!=null&&h.headers?new Headers(e.init.headers):void 0}}return{type:zn.data,data:e}}function fD(n,e,t,r,i,o){let a=n.headers.get("Location");if(Mn(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!Jy.test(a)){let s=r.slice(0,r.findIndex(l=>l.route.id===t)+1);a=Ev(new URL(e.url),s,i,!0,a,o),n.headers.set("Location",a)}return n}function Wb(n,e,t){if(Jy.test(n)){let r=n,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),o=yf(i.pathname,t)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return n}function iu(n,e,t,r){let i=n.createURL($A(e)).toString(),o={signal:t};if(r&&vs(r.formMethod)){let{formMethod:a,formEncType:s}=r;o.method=a.toUpperCase(),s==="application/json"?(o.headers=new Headers({"Content-Type":s}),o.body=JSON.stringify(r.json)):s==="text/plain"?o.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?o.body=_v(r.formData):o.body=r.formData}return new Request(i,o)}function _v(n){let e=new URLSearchParams;for(let[t,r]of n.entries())e.append(t,typeof r=="string"?r:r.name);return e}function Hb(n){let e=new FormData;for(let[t,r]of n.entries())e.append(t,r);return e}function hD(n,e,t,r,i){let o={},a=null,s,l=!1,f={},h=t&&Ao(t[1])?t[1].error:void 0;return n.forEach(m=>{if(!(m.route.id in e))return;let g=m.route.id,y=e[g];if(Mn(!al(y),"Cannot handle redirect results in processLoaderData"),Ao(y)){let C=y.error;h!==void 0&&(C=h,h=void 0),a=a||{};{let x=rl(n,g);a[x.route.id]==null&&(a[x.route.id]=C)}o[g]=void 0,l||(l=!0,s=Kd(y.error)?y.error.status:500),y.headers&&(f[g]=y.headers)}else Cc(y)?(r.set(g,y.deferredData),o[g]=y.deferredData.data,y.statusCode!=null&&y.statusCode!==200&&!l&&(s=y.statusCode),y.headers&&(f[g]=y.headers)):(o[g]=y.data,y.statusCode&&y.statusCode!==200&&!l&&(s=y.statusCode),y.headers&&(f[g]=y.headers))}),h!==void 0&&t&&(a={[t[0]]:h},o[t[0]]=void 0),{loaderData:o,errors:a,statusCode:s||200,loaderHeaders:f}}function Zb(n,e,t,r,i,o,a){let{loaderData:s,errors:l}=hD(e,t,r,a);return i.forEach(f=>{let{key:h,match:m,controller:g}=f,y=o[h];if(Mn(y,"Did not find corresponding fetcher result"),!(g&&g.signal.aborted))if(Ao(y)){let C=rl(n.matches,m==null?void 0:m.route.id);l&&l[C.route.id]||(l=hr({},l,{[C.route.id]:y.error})),n.fetchers.delete(h)}else if(al(y))Mn(!1,"Unhandled fetcher revalidation redirect");else if(Cc(y))Mn(!1,"Unhandled fetcher deferred data");else{let C=lc(y.data);n.fetchers.set(h,C)}}),{loaderData:s,errors:l}}function Xb(n,e,t,r){let i=hr({},e);for(let o of t){let a=o.route.id;if(e.hasOwnProperty(a)?e[a]!==void 0&&(i[a]=e[a]):n[a]!==void 0&&o.route.loader&&(i[a]=n[a]),r&&r.hasOwnProperty(a))break}return i}function $b(n){return n?Ao(n[1])?{actionData:{}}:{actionData:{[n[0]]:n[1].data}}:{}}function rl(n,e){return(e?n.slice(0,n.findIndex(r=>r.route.id===e)+1):[...n]).reverse().find(r=>r.route.hasErrorBoundary===!0)||n[0]}function Kb(n){let e=n.length===1?n[0]:n.find(t=>t.index||!t.path||t.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function no(n,e){let{pathname:t,routeId:r,method:i,type:o,message:a}=e===void 0?{}:e,s="Unknown Server Error",l="Unknown @remix-run/router error";return n===400?(s="Bad Request",i&&t&&r?l="You made a "+i+' request to "'+t+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?l="defer() is not supported in actions":o==="invalid-body"&&(l="Unable to encode submission body")):n===403?(s="Forbidden",l='Route "'+r+'" does not match URL "'+t+'"'):n===404?(s="Not Found",l='No route matches URL "'+t+'"'):n===405&&(s="Method Not Allowed",i&&t&&r?l="You made a "+i.toUpperCase()+' request to "'+t+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(l='Invalid request method "'+i.toUpperCase()+'"')),new $0(n||500,s,new Error(l),!0)}function Sh(n){let e=Object.entries(n);for(let t=e.length-1;t>=0;t--){let[r,i]=e[t];if(al(i))return{key:r,result:i}}}function $A(n){let e=typeof n=="string"?Tc(n):n;return vf(hr({},e,{hash:""}))}function pD(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function gD(n){return KA(n.result)&&eD.has(n.result.status)}function Cc(n){return n.type===zn.deferred}function Ao(n){return n.type===zn.error}function al(n){return(n&&n.type)===zn.redirect}function qb(n){return typeof n=="object"&&n!=null&&"type"in n&&"data"in n&&"init"in n&&n.type==="DataWithResponseInit"}function mD(n){let e=n;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function KA(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function vD(n){return JP.has(n.toLowerCase())}function vs(n){return YP.has(n.toLowerCase())}async function yD(n,e,t,r,i){let o=Object.entries(e);for(let a=0;a<o.length;a++){let[s,l]=o[a],f=n.find(g=>(g==null?void 0:g.route.id)===s);if(!f)continue;let h=r.find(g=>g.route.id===f.route.id),m=h!=null&&!ZA(h,f)&&(i&&i[f.route.id])!==void 0;Cc(l)&&m&&await eC(l,t,!1).then(g=>{g&&(e[s]=g)})}}async function CD(n,e,t){for(let r=0;r<t.length;r++){let{key:i,routeId:o,controller:a}=t[r],s=e[i];n.find(f=>(f==null?void 0:f.route.id)===o)&&Cc(s)&&(Mn(a,"Expected an AbortController for revalidating fetcher deferred result"),await eC(s,a.signal,!0).then(f=>{f&&(e[i]=f)}))}}async function eC(n,e,t){if(t===void 0&&(t=!1),!await n.deferredData.resolveData(e)){if(t)try{return{type:zn.data,data:n.deferredData.unwrappedData}}catch(i){return{type:zn.error,error:i}}return{type:zn.data,data:n.deferredData.data}}}function tC(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function Nd(n,e){let t=typeof e=="string"?Tc(e).search:e.search;if(n[n.length-1].route.index&&tC(t||""))return n[n.length-1];let r=zA(n);return r[r.length-1]}function Yb(n){let{formMethod:e,formAction:t,formEncType:r,text:i,formData:o,json:a}=n;if(!(!e||!t||!r)){if(i!=null)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:t,formEncType:r,formData:o,json:void 0,text:void 0};if(a!==void 0)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:a,text:void 0}}}function Rm(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function xD(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function gd(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function bD(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function lc(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function ID(n,e){try{let t=n.sessionStorage.getItem(HA);if(t){let r=JSON.parse(t);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function wD(n,e){if(e.size>0){let t={};for(let[r,i]of e)t[r]=[...i];try{n.sessionStorage.setItem(HA,JSON.stringify(t))}catch(r){ku(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rv(){return Rv=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Rv.apply(this,arguments)}const qA=O.createContext(null),YA=O.createContext(null),QA=O.createContext(null),nC=O.createContext(null),_p=O.createContext({outlet:null,matches:[],isDataRoute:!1}),JA=O.createContext(null);function rC(){return O.useContext(nC)!=null}function ek(){return rC()||Mn(!1),O.useContext(nC).location}function SD(n,e,t,r){rC()||Mn(!1);let{navigator:i}=O.useContext(QA),{matches:o}=O.useContext(_p),a=o[o.length-1],s=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let f=ek(),h;h=f;let m=h.pathname||"/",g=m;if(l!=="/"){let x=l.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(x.length).join("/")}let y=nl(n,{pathname:g});return _D(y&&y.map(x=>Object.assign({},x,{params:Object.assign({},s,x.params),pathname:ul([l,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:ul([l,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),o,t,r)}function AD(){let n=MD(),e=Kd(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},e),t?O.createElement("pre",{style:i},t):null,null)}const kD=O.createElement(AD,null);class ED extends O.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?O.createElement(_p.Provider,{value:this.props.routeContext},O.createElement(JA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function TD(n){let{routeContext:e,match:t,children:r}=n,i=O.useContext(qA);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),O.createElement(_p.Provider,{value:e},r)}function _D(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var o;if(!t)return null;if(t.errors)n=t.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,s=(i=t)==null?void 0:i.errors;if(s!=null){let h=a.findIndex(m=>m.route.id&&(s==null?void 0:s[m.route.id])!==void 0);h>=0||Mn(!1),a=a.slice(0,Math.min(a.length,h+1))}let l=!1,f=-1;if(t&&r&&r.v7_partialHydration)for(let h=0;h<a.length;h++){let m=a[h];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(f=h),m.route.id){let{loaderData:g,errors:y}=t,C=m.route.loader&&g[m.route.id]===void 0&&(!y||y[m.route.id]===void 0);if(m.route.lazy||C){l=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}return a.reduceRight((h,m,g)=>{let y,C=!1,x=null,w=null;t&&(y=s&&m.route.id?s[m.route.id]:void 0,x=m.route.errorElement||kD,l&&(f<0&&g===0?(ND("route-fallback"),C=!0,w=null):f===g&&(C=!0,w=m.route.hydrateFallbackElement||null)));let S=e.concat(a.slice(0,g+1)),A=()=>{let E;return y?E=x:C?E=w:m.route.Component?E=O.createElement(m.route.Component,null):m.route.element?E=m.route.element:E=h,O.createElement(TD,{match:m,routeContext:{outlet:h,matches:S,isDataRoute:t!=null},children:E})};return t&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?O.createElement(ED,{location:t.location,revalidation:t.revalidation,component:x,error:y,children:A(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):A()},null)}var tk=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(tk||{});function RD(n){let e=O.useContext(YA);return e||Mn(!1),e}function PD(n){let e=O.useContext(_p);return e||Mn(!1),e}function DD(n){let e=PD(),t=e.matches[e.matches.length-1];return t.route.id||Mn(!1),t.route.id}function MD(){var n;let e=O.useContext(JA),t=RD(tk.UseRouteError),r=DD();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}const Qb={};function ND(n,e,t){Qb[n]||(Qb[n]=!0)}function BD(n,e){n==null||n.v7_startTransition,(n==null?void 0:n.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function OD(n){let{basename:e="/",children:t=null,location:r,navigationType:i=Lr.Pop,navigator:o,static:a=!1,future:s}=n;rC()&&Mn(!1);let l=e.replace(/^\/*/,"/"),f=O.useMemo(()=>({basename:l,navigator:o,static:a,future:Rv({v7_relativeSplatPath:!1},s)}),[l,s,o,a]);typeof r=="string"&&(r=Tc(r));let{pathname:h="/",search:m="",hash:g="",state:y=null,key:C="default"}=r,x=O.useMemo(()=>{let w=yf(h,l);return w==null?null:{location:{pathname:w,search:m,hash:g,state:y,key:C},navigationType:i}},[l,h,m,g,y,C,i]);return x==null?null:O.createElement(QA.Provider,{value:f},O.createElement(nC.Provider,{children:t,value:x}))}new Promise(()=>{});function FD(n){let e={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(e,{element:O.createElement(n.Component),Component:void 0}),n.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:O.createElement(n.HydrateFallback),HydrateFallback:void 0}),n.ErrorBoundary&&Object.assign(e,{errorElement:O.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function K0(){return K0=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},K0.apply(this,arguments)}const LD="6";try{window.__reactRouterVersion=LD}catch{}function UD(n,e){return iD({basename:void 0,future:K0({},void 0,{v7_prependBasename:!0}),history:kP({window:void 0}),hydrationData:jD(),routes:n,mapRouteProperties:FD,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function jD(){var n;let e=(n=window)==null?void 0:n.__staticRouterHydrationData;return e&&e.errors&&(e=K0({},e,{errors:GD(e.errors)})),e}function GD(n){if(!n)return null;let e=Object.entries(n),t={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")t[r]=new $0(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let a=new o(i.message);a.stack="",t[r]=a}catch{}}if(t[r]==null){let o=new Error(i.message);o.stack="",t[r]=o}}else t[r]=i;return t}const VD=O.createContext({isTransitioning:!1}),zD=O.createContext(new Map),WD="startTransition",Jb=vP[WD],HD="flushSync",eI=AP[HD];function ZD(n){Jb?Jb(n):n()}function md(n){eI?eI(n):n()}class XD{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",t(r))}})}}function $D(n){let{fallbackElement:e,router:t,future:r}=n,[i,o]=O.useState(t.state),[a,s]=O.useState(),[l,f]=O.useState({isTransitioning:!1}),[h,m]=O.useState(),[g,y]=O.useState(),[C,x]=O.useState(),w=O.useRef(new Map),{v7_startTransition:S}=r||{},A=O.useCallback(j=>{S?ZD(j):j()},[S]),E=O.useCallback((j,X)=>{let{deletedFetchers:L,flushSync:G,viewTransitionOpts:Z}=X;j.fetchers.forEach((pe,ve)=>{pe.data!==void 0&&w.current.set(ve,pe.data)}),L.forEach(pe=>w.current.delete(pe));let ne=t.window==null||t.window.document==null||typeof t.window.document.startViewTransition!="function";if(!Z||ne){G?md(()=>o(j)):A(()=>o(j));return}if(G){md(()=>{g&&(h&&h.resolve(),g.skipTransition()),f({isTransitioning:!0,flushSync:!0,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation})});let pe=t.window.document.startViewTransition(()=>{md(()=>o(j))});pe.finished.finally(()=>{md(()=>{m(void 0),y(void 0),s(void 0),f({isTransitioning:!1})})}),md(()=>y(pe));return}g?(h&&h.resolve(),g.skipTransition(),x({state:j,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation})):(s(j),f({isTransitioning:!0,flushSync:!1,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation}))},[t.window,g,h,w,A]);O.useLayoutEffect(()=>t.subscribe(E),[t,E]),O.useEffect(()=>{l.isTransitioning&&!l.flushSync&&m(new XD)},[l]),O.useEffect(()=>{if(h&&a&&t.window){let j=a,X=h.promise,L=t.window.document.startViewTransition(async()=>{A(()=>o(j)),await X});L.finished.finally(()=>{m(void 0),y(void 0),s(void 0),f({isTransitioning:!1})}),y(L)}},[A,a,h,t.window]),O.useEffect(()=>{h&&a&&i.location.key===a.location.key&&h.resolve()},[h,g,i.location,a]),O.useEffect(()=>{!l.isTransitioning&&C&&(s(C.state),f({isTransitioning:!0,flushSync:!1,currentLocation:C.currentLocation,nextLocation:C.nextLocation}),x(void 0))},[l.isTransitioning,C]),O.useEffect(()=>{},[]);let _=O.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:j=>t.navigate(j),push:(j,X,L)=>t.navigate(j,{state:X,preventScrollReset:L==null?void 0:L.preventScrollReset}),replace:(j,X,L)=>t.navigate(j,{replace:!0,state:X,preventScrollReset:L==null?void 0:L.preventScrollReset})}),[t]),T=t.basename||"/",M=O.useMemo(()=>({router:t,navigator:_,static:!1,basename:T}),[t,_,T]),P=O.useMemo(()=>({v7_relativeSplatPath:t.future.v7_relativeSplatPath}),[t.future.v7_relativeSplatPath]);return O.useEffect(()=>BD(r,t.future),[r,t.future]),O.createElement(O.Fragment,null,O.createElement(qA.Provider,{value:M},O.createElement(YA.Provider,{value:i},O.createElement(zD.Provider,{value:w.current},O.createElement(VD.Provider,{value:l},O.createElement(OD,{basename:T,location:i.location,navigationType:i.historyAction,navigator:_,future:P},i.initialized||t.future.v7_partialHydration?O.createElement(KD,{routes:t.routes,future:t.future,state:i}):e))))),null)}const KD=O.memo(qD);function qD(n){let{routes:e,future:t,state:r}=n;return SD(e,void 0,r,t)}var tI;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(tI||(tI={}));var nI;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(nI||(nI={}));const nk=n=>{const e=typeof n=="function",t=O.useRef(n);O.useEffect(()=>{t.current=n}),O.useEffect(()=>{if(e){const r=i=>{const o=t.current(i);if(typeof o=="string")return i.preventDefault(),i.returnValue=o;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])};var Pm={exports:{}},rI;function YD(){return rI||(rI=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(l,f,h){this.fn=l,this.context=f,this.once=h||!1}function o(l,f,h,m,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var y=new i(h,m||l,g),C=t?t+f:f;return l._events[C]?l._events[C].fn?l._events[C]=[l._events[C],y]:l._events[C].push(y):(l._events[C]=y,l._eventsCount++),l}function a(l,f){--l._eventsCount===0?l._events=new r:delete l._events[f]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var f=[],h,m;if(this._eventsCount===0)return f;for(m in h=this._events)e.call(h,m)&&f.push(t?m.slice(1):m);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},s.prototype.listeners=function(f){var h=t?t+f:f,m=this._events[h];if(!m)return[];if(m.fn)return[m.fn];for(var g=0,y=m.length,C=new Array(y);g<y;g++)C[g]=m[g].fn;return C},s.prototype.listenerCount=function(f){var h=t?t+f:f,m=this._events[h];return m?m.fn?1:m.length:0},s.prototype.emit=function(f,h,m,g,y,C){var x=t?t+f:f;if(!this._events[x])return!1;var w=this._events[x],S=arguments.length,A,E;if(w.fn){switch(w.once&&this.removeListener(f,w.fn,void 0,!0),S){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,h),!0;case 3:return w.fn.call(w.context,h,m),!0;case 4:return w.fn.call(w.context,h,m,g),!0;case 5:return w.fn.call(w.context,h,m,g,y),!0;case 6:return w.fn.call(w.context,h,m,g,y,C),!0}for(E=1,A=new Array(S-1);E<S;E++)A[E-1]=arguments[E];w.fn.apply(w.context,A)}else{var _=w.length,T;for(E=0;E<_;E++)switch(w[E].once&&this.removeListener(f,w[E].fn,void 0,!0),S){case 1:w[E].fn.call(w[E].context);break;case 2:w[E].fn.call(w[E].context,h);break;case 3:w[E].fn.call(w[E].context,h,m);break;case 4:w[E].fn.call(w[E].context,h,m,g);break;default:if(!A)for(T=1,A=new Array(S-1);T<S;T++)A[T-1]=arguments[T];w[E].fn.apply(w[E].context,A)}}return!0},s.prototype.on=function(f,h,m){return o(this,f,h,m,!1)},s.prototype.once=function(f,h,m){return o(this,f,h,m,!0)},s.prototype.removeListener=function(f,h,m,g){var y=t?t+f:f;if(!this._events[y])return this;if(!h)return a(this,y),this;var C=this._events[y];if(C.fn)C.fn===h&&(!g||C.once)&&(!m||C.context===m)&&a(this,y);else{for(var x=0,w=[],S=C.length;x<S;x++)(C[x].fn!==h||g&&!C[x].once||m&&C[x].context!==m)&&w.push(C[x]);w.length?this._events[y]=w.length===1?w[0]:w:a(this,y)}return this},s.prototype.removeAllListeners=function(f){var h;return f?(h=t?t+f:f,this._events[h]&&a(this,h)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=t,s.EventEmitter=s,n.exports=s}(Pm)),Pm.exports}var QD=YD();const Rp=Ec(QD);var Dm={},vd={},iI;function JD(){if(iI)return vd;iI=1,vd.byteLength=s,vd.toByteArray=f,vd.fromByteArray=g;for(var n=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=r.length;i<o;++i)n[i]=r[i],e[r.charCodeAt(i)]=i;e[45]=62,e[95]=63;function a(y){var C=y.length;if(C%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=y.indexOf("=");x===-1&&(x=C);var w=x===C?0:4-x%4;return[x,w]}function s(y){var C=a(y),x=C[0],w=C[1];return(x+w)*3/4-w}function l(y,C,x){return(C+x)*3/4-x}function f(y){var C,x=a(y),w=x[0],S=x[1],A=new t(l(y,w,S)),E=0,_=S>0?w-4:w,T;for(T=0;T<_;T+=4)C=e[y.charCodeAt(T)]<<18|e[y.charCodeAt(T+1)]<<12|e[y.charCodeAt(T+2)]<<6|e[y.charCodeAt(T+3)],A[E++]=C>>16&255,A[E++]=C>>8&255,A[E++]=C&255;return S===2&&(C=e[y.charCodeAt(T)]<<2|e[y.charCodeAt(T+1)]>>4,A[E++]=C&255),S===1&&(C=e[y.charCodeAt(T)]<<10|e[y.charCodeAt(T+1)]<<4|e[y.charCodeAt(T+2)]>>2,A[E++]=C>>8&255,A[E++]=C&255),A}function h(y){return n[y>>18&63]+n[y>>12&63]+n[y>>6&63]+n[y&63]}function m(y,C,x){for(var w,S=[],A=C;A<x;A+=3)w=(y[A]<<16&16711680)+(y[A+1]<<8&65280)+(y[A+2]&255),S.push(h(w));return S.join("")}function g(y){for(var C,x=y.length,w=x%3,S=[],A=16383,E=0,_=x-w;E<_;E+=A)S.push(m(y,E,E+A>_?_:E+A));return w===1?(C=y[x-1],S.push(n[C>>2]+n[C<<4&63]+"==")):w===2&&(C=(y[x-2]<<8)+y[x-1],S.push(n[C>>10]+n[C>>4&63]+n[C<<2&63]+"=")),S.join("")}return vd}var Ah={},oI;function e3(){if(oI)return Ah;oI=1;/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */return Ah.read=function(n,e,t,r,i){var o,a,s=i*8-r-1,l=(1<<s)-1,f=l>>1,h=-7,m=t?i-1:0,g=t?-1:1,y=n[e+m];for(m+=g,o=y&(1<<-h)-1,y>>=-h,h+=s;h>0;o=o*256+n[e+m],m+=g,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=r;h>0;a=a*256+n[e+m],m+=g,h-=8);if(o===0)o=1-f;else{if(o===l)return a?NaN:(y?-1:1)*(1/0);a=a+Math.pow(2,r),o=o-f}return(y?-1:1)*a*Math.pow(2,o-r)},Ah.write=function(n,e,t,r,i,o){var a,s,l,f=o*8-i-1,h=(1<<f)-1,m=h>>1,g=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=r?0:o-1,C=r?1:-1,x=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+m>=1?e+=g/l:e+=g*Math.pow(2,1-m),e*l>=2&&(a++,l/=2),a+m>=h?(s=0,a=h):a+m>=1?(s=(e*l-1)*Math.pow(2,i),a=a+m):(s=e*Math.pow(2,m-1)*Math.pow(2,i),a=0));i>=8;n[t+y]=s&255,y+=C,s/=256,i-=8);for(a=a<<i|s,f+=i;f>0;n[t+y]=a&255,y+=C,a/=256,f-=8);n[t+y-C]|=x*128},Ah}var sI;function t3(){return sI||(sI=1,function(n){const e=JD(),t=e3(),r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=s,n.SlowBuffer=A,n.INSPECT_MAX_BYTES=50;const i=2147483647;n.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=o(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const q=new Uint8Array(1),N={foo:function(){return 42}};return Object.setPrototypeOf(N,Uint8Array.prototype),Object.setPrototypeOf(q,N),q.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function a(q){if(q>i)throw new RangeError('The value "'+q+'" is invalid for option "size"');const N=new Uint8Array(q);return Object.setPrototypeOf(N,s.prototype),N}function s(q,N,F){if(typeof q=="number"){if(typeof N=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(q)}return l(q,N,F)}s.poolSize=8192;function l(q,N,F){if(typeof q=="string")return g(q,N);if(ArrayBuffer.isView(q))return C(q);if(q==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof q);if(ct(q,ArrayBuffer)||q&&ct(q.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ct(q,SharedArrayBuffer)||q&&ct(q.buffer,SharedArrayBuffer)))return x(q,N,F);if(typeof q=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const te=q.valueOf&&q.valueOf();if(te!=null&&te!==q)return s.from(te,N,F);const Ce=w(q);if(Ce)return Ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof q[Symbol.toPrimitive]=="function")return s.from(q[Symbol.toPrimitive]("string"),N,F);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof q)}s.from=function(q,N,F){return l(q,N,F)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function f(q){if(typeof q!="number")throw new TypeError('"size" argument must be of type number');if(q<0)throw new RangeError('The value "'+q+'" is invalid for option "size"')}function h(q,N,F){return f(q),q<=0?a(q):N!==void 0?typeof F=="string"?a(q).fill(N,F):a(q).fill(N):a(q)}s.alloc=function(q,N,F){return h(q,N,F)};function m(q){return f(q),a(q<0?0:S(q)|0)}s.allocUnsafe=function(q){return m(q)},s.allocUnsafeSlow=function(q){return m(q)};function g(q,N){if((typeof N!="string"||N==="")&&(N="utf8"),!s.isEncoding(N))throw new TypeError("Unknown encoding: "+N);const F=E(q,N)|0;let te=a(F);const Ce=te.write(q,N);return Ce!==F&&(te=te.slice(0,Ce)),te}function y(q){const N=q.length<0?0:S(q.length)|0,F=a(N);for(let te=0;te<N;te+=1)F[te]=q[te]&255;return F}function C(q){if(ct(q,Uint8Array)){const N=new Uint8Array(q);return x(N.buffer,N.byteOffset,N.byteLength)}return y(q)}function x(q,N,F){if(N<0||q.byteLength<N)throw new RangeError('"offset" is outside of buffer bounds');if(q.byteLength<N+(F||0))throw new RangeError('"length" is outside of buffer bounds');let te;return N===void 0&&F===void 0?te=new Uint8Array(q):F===void 0?te=new Uint8Array(q,N):te=new Uint8Array(q,N,F),Object.setPrototypeOf(te,s.prototype),te}function w(q){if(s.isBuffer(q)){const N=S(q.length)|0,F=a(N);return F.length===0||q.copy(F,0,0,N),F}if(q.length!==void 0)return typeof q.length!="number"||ce(q.length)?a(0):y(q);if(q.type==="Buffer"&&Array.isArray(q.data))return y(q.data)}function S(q){if(q>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return q|0}function A(q){return+q!=q&&(q=0),s.alloc(+q)}s.isBuffer=function(N){return N!=null&&N._isBuffer===!0&&N!==s.prototype},s.compare=function(N,F){if(ct(N,Uint8Array)&&(N=s.from(N,N.offset,N.byteLength)),ct(F,Uint8Array)&&(F=s.from(F,F.offset,F.byteLength)),!s.isBuffer(N)||!s.isBuffer(F))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(N===F)return 0;let te=N.length,Ce=F.length;for(let Pe=0,Ge=Math.min(te,Ce);Pe<Ge;++Pe)if(N[Pe]!==F[Pe]){te=N[Pe],Ce=F[Pe];break}return te<Ce?-1:Ce<te?1:0},s.isEncoding=function(N){switch(String(N).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(N,F){if(!Array.isArray(N))throw new TypeError('"list" argument must be an Array of Buffers');if(N.length===0)return s.alloc(0);let te;if(F===void 0)for(F=0,te=0;te<N.length;++te)F+=N[te].length;const Ce=s.allocUnsafe(F);let Pe=0;for(te=0;te<N.length;++te){let Ge=N[te];if(ct(Ge,Uint8Array))Pe+Ge.length>Ce.length?(s.isBuffer(Ge)||(Ge=s.from(Ge)),Ge.copy(Ce,Pe)):Uint8Array.prototype.set.call(Ce,Ge,Pe);else if(s.isBuffer(Ge))Ge.copy(Ce,Pe);else throw new TypeError('"list" argument must be an Array of Buffers');Pe+=Ge.length}return Ce};function E(q,N){if(s.isBuffer(q))return q.length;if(ArrayBuffer.isView(q)||ct(q,ArrayBuffer))return q.byteLength;if(typeof q!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof q);const F=q.length,te=arguments.length>2&&arguments[2]===!0;if(!te&&F===0)return 0;let Ce=!1;for(;;)switch(N){case"ascii":case"latin1":case"binary":return F;case"utf8":case"utf-8":return Vt(q).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F*2;case"hex":return F>>>1;case"base64":return Ht(q).length;default:if(Ce)return te?-1:Vt(q).length;N=(""+N).toLowerCase(),Ce=!0}}s.byteLength=E;function _(q,N,F){let te=!1;if((N===void 0||N<0)&&(N=0),N>this.length||((F===void 0||F>this.length)&&(F=this.length),F<=0)||(F>>>=0,N>>>=0,F<=N))return"";for(q||(q="utf8");;)switch(q){case"hex":return Ae(this,N,F);case"utf8":case"utf-8":return pe(this,N,F);case"ascii":return Ne(this,N,F);case"latin1":case"binary":return xe(this,N,F);case"base64":return ne(this,N,F);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ke(this,N,F);default:if(te)throw new TypeError("Unknown encoding: "+q);q=(q+"").toLowerCase(),te=!0}}s.prototype._isBuffer=!0;function T(q,N,F){const te=q[N];q[N]=q[F],q[F]=te}s.prototype.swap16=function(){const N=this.length;if(N%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let F=0;F<N;F+=2)T(this,F,F+1);return this},s.prototype.swap32=function(){const N=this.length;if(N%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let F=0;F<N;F+=4)T(this,F,F+3),T(this,F+1,F+2);return this},s.prototype.swap64=function(){const N=this.length;if(N%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let F=0;F<N;F+=8)T(this,F,F+7),T(this,F+1,F+6),T(this,F+2,F+5),T(this,F+3,F+4);return this},s.prototype.toString=function(){const N=this.length;return N===0?"":arguments.length===0?pe(this,0,N):_.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(N){if(!s.isBuffer(N))throw new TypeError("Argument must be a Buffer");return this===N?!0:s.compare(this,N)===0},s.prototype.inspect=function(){let N="";const F=n.INSPECT_MAX_BYTES;return N=this.toString("hex",0,F).replace(/(.{2})/g,"$1 ").trim(),this.length>F&&(N+=" ... "),"<Buffer "+N+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(N,F,te,Ce,Pe){if(ct(N,Uint8Array)&&(N=s.from(N,N.offset,N.byteLength)),!s.isBuffer(N))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof N);if(F===void 0&&(F=0),te===void 0&&(te=N?N.length:0),Ce===void 0&&(Ce=0),Pe===void 0&&(Pe=this.length),F<0||te>N.length||Ce<0||Pe>this.length)throw new RangeError("out of range index");if(Ce>=Pe&&F>=te)return 0;if(Ce>=Pe)return-1;if(F>=te)return 1;if(F>>>=0,te>>>=0,Ce>>>=0,Pe>>>=0,this===N)return 0;let Ge=Pe-Ce,Lt=te-F;const fn=Math.min(Ge,Lt),hn=this.slice(Ce,Pe),yn=N.slice(F,te);for(let un=0;un<fn;++un)if(hn[un]!==yn[un]){Ge=hn[un],Lt=yn[un];break}return Ge<Lt?-1:Lt<Ge?1:0};function M(q,N,F,te,Ce){if(q.length===0)return-1;if(typeof F=="string"?(te=F,F=0):F>2147483647?F=2147483647:F<-2147483648&&(F=-2147483648),F=+F,ce(F)&&(F=Ce?0:q.length-1),F<0&&(F=q.length+F),F>=q.length){if(Ce)return-1;F=q.length-1}else if(F<0)if(Ce)F=0;else return-1;if(typeof N=="string"&&(N=s.from(N,te)),s.isBuffer(N))return N.length===0?-1:P(q,N,F,te,Ce);if(typeof N=="number")return N=N&255,typeof Uint8Array.prototype.indexOf=="function"?Ce?Uint8Array.prototype.indexOf.call(q,N,F):Uint8Array.prototype.lastIndexOf.call(q,N,F):P(q,[N],F,te,Ce);throw new TypeError("val must be string, number or Buffer")}function P(q,N,F,te,Ce){let Pe=1,Ge=q.length,Lt=N.length;if(te!==void 0&&(te=String(te).toLowerCase(),te==="ucs2"||te==="ucs-2"||te==="utf16le"||te==="utf-16le")){if(q.length<2||N.length<2)return-1;Pe=2,Ge/=2,Lt/=2,F/=2}function fn(yn,un){return Pe===1?yn[un]:yn.readUInt16BE(un*Pe)}let hn;if(Ce){let yn=-1;for(hn=F;hn<Ge;hn++)if(fn(q,hn)===fn(N,yn===-1?0:hn-yn)){if(yn===-1&&(yn=hn),hn-yn+1===Lt)return yn*Pe}else yn!==-1&&(hn-=hn-yn),yn=-1}else for(F+Lt>Ge&&(F=Ge-Lt),hn=F;hn>=0;hn--){let yn=!0;for(let un=0;un<Lt;un++)if(fn(q,hn+un)!==fn(N,un)){yn=!1;break}if(yn)return hn}return-1}s.prototype.includes=function(N,F,te){return this.indexOf(N,F,te)!==-1},s.prototype.indexOf=function(N,F,te){return M(this,N,F,te,!0)},s.prototype.lastIndexOf=function(N,F,te){return M(this,N,F,te,!1)};function j(q,N,F,te){F=Number(F)||0;const Ce=q.length-F;te?(te=Number(te),te>Ce&&(te=Ce)):te=Ce;const Pe=N.length;te>Pe/2&&(te=Pe/2);let Ge;for(Ge=0;Ge<te;++Ge){const Lt=parseInt(N.substr(Ge*2,2),16);if(ce(Lt))return Ge;q[F+Ge]=Lt}return Ge}function X(q,N,F,te){return on(Vt(N,q.length-F),q,F,te)}function L(q,N,F,te){return on(Gt(N),q,F,te)}function G(q,N,F,te){return on(Ht(N),q,F,te)}function Z(q,N,F,te){return on(Pt(N,q.length-F),q,F,te)}s.prototype.write=function(N,F,te,Ce){if(F===void 0)Ce="utf8",te=this.length,F=0;else if(te===void 0&&typeof F=="string")Ce=F,te=this.length,F=0;else if(isFinite(F))F=F>>>0,isFinite(te)?(te=te>>>0,Ce===void 0&&(Ce="utf8")):(Ce=te,te=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Pe=this.length-F;if((te===void 0||te>Pe)&&(te=Pe),N.length>0&&(te<0||F<0)||F>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ce||(Ce="utf8");let Ge=!1;for(;;)switch(Ce){case"hex":return j(this,N,F,te);case"utf8":case"utf-8":return X(this,N,F,te);case"ascii":case"latin1":case"binary":return L(this,N,F,te);case"base64":return G(this,N,F,te);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,N,F,te);default:if(Ge)throw new TypeError("Unknown encoding: "+Ce);Ce=(""+Ce).toLowerCase(),Ge=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ne(q,N,F){return N===0&&F===q.length?e.fromByteArray(q):e.fromByteArray(q.slice(N,F))}function pe(q,N,F){F=Math.min(q.length,F);const te=[];let Ce=N;for(;Ce<F;){const Pe=q[Ce];let Ge=null,Lt=Pe>239?4:Pe>223?3:Pe>191?2:1;if(Ce+Lt<=F){let fn,hn,yn,un;switch(Lt){case 1:Pe<128&&(Ge=Pe);break;case 2:fn=q[Ce+1],(fn&192)===128&&(un=(Pe&31)<<6|fn&63,un>127&&(Ge=un));break;case 3:fn=q[Ce+1],hn=q[Ce+2],(fn&192)===128&&(hn&192)===128&&(un=(Pe&15)<<12|(fn&63)<<6|hn&63,un>2047&&(un<55296||un>57343)&&(Ge=un));break;case 4:fn=q[Ce+1],hn=q[Ce+2],yn=q[Ce+3],(fn&192)===128&&(hn&192)===128&&(yn&192)===128&&(un=(Pe&15)<<18|(fn&63)<<12|(hn&63)<<6|yn&63,un>65535&&un<1114112&&(Ge=un))}}Ge===null?(Ge=65533,Lt=1):Ge>65535&&(Ge-=65536,te.push(Ge>>>10&1023|55296),Ge=56320|Ge&1023),te.push(Ge),Ce+=Lt}return Se(te)}const ve=4096;function Se(q){const N=q.length;if(N<=ve)return String.fromCharCode.apply(String,q);let F="",te=0;for(;te<N;)F+=String.fromCharCode.apply(String,q.slice(te,te+=ve));return F}function Ne(q,N,F){let te="";F=Math.min(q.length,F);for(let Ce=N;Ce<F;++Ce)te+=String.fromCharCode(q[Ce]&127);return te}function xe(q,N,F){let te="";F=Math.min(q.length,F);for(let Ce=N;Ce<F;++Ce)te+=String.fromCharCode(q[Ce]);return te}function Ae(q,N,F){const te=q.length;(!N||N<0)&&(N=0),(!F||F<0||F>te)&&(F=te);let Ce="";for(let Pe=N;Pe<F;++Pe)Ce+=nn[q[Pe]];return Ce}function ke(q,N,F){const te=q.slice(N,F);let Ce="";for(let Pe=0;Pe<te.length-1;Pe+=2)Ce+=String.fromCharCode(te[Pe]+te[Pe+1]*256);return Ce}s.prototype.slice=function(N,F){const te=this.length;N=~~N,F=F===void 0?te:~~F,N<0?(N+=te,N<0&&(N=0)):N>te&&(N=te),F<0?(F+=te,F<0&&(F=0)):F>te&&(F=te),F<N&&(F=N);const Ce=this.subarray(N,F);return Object.setPrototypeOf(Ce,s.prototype),Ce};function H(q,N,F){if(q%1!==0||q<0)throw new RangeError("offset is not uint");if(q+N>F)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(N,F,te){N=N>>>0,F=F>>>0,te||H(N,F,this.length);let Ce=this[N],Pe=1,Ge=0;for(;++Ge<F&&(Pe*=256);)Ce+=this[N+Ge]*Pe;return Ce},s.prototype.readUintBE=s.prototype.readUIntBE=function(N,F,te){N=N>>>0,F=F>>>0,te||H(N,F,this.length);let Ce=this[N+--F],Pe=1;for(;F>0&&(Pe*=256);)Ce+=this[N+--F]*Pe;return Ce},s.prototype.readUint8=s.prototype.readUInt8=function(N,F){return N=N>>>0,F||H(N,1,this.length),this[N]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(N,F){return N=N>>>0,F||H(N,2,this.length),this[N]|this[N+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(N,F){return N=N>>>0,F||H(N,2,this.length),this[N]<<8|this[N+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(N,F){return N=N>>>0,F||H(N,4,this.length),(this[N]|this[N+1]<<8|this[N+2]<<16)+this[N+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(N,F){return N=N>>>0,F||H(N,4,this.length),this[N]*16777216+(this[N+1]<<16|this[N+2]<<8|this[N+3])},s.prototype.readBigUInt64LE=pn(function(N){N=N>>>0,St(N,"offset");const F=this[N],te=this[N+7];(F===void 0||te===void 0)&&Dt(N,this.length-8);const Ce=F+this[++N]*2**8+this[++N]*2**16+this[++N]*2**24,Pe=this[++N]+this[++N]*2**8+this[++N]*2**16+te*2**24;return BigInt(Ce)+(BigInt(Pe)<<BigInt(32))}),s.prototype.readBigUInt64BE=pn(function(N){N=N>>>0,St(N,"offset");const F=this[N],te=this[N+7];(F===void 0||te===void 0)&&Dt(N,this.length-8);const Ce=F*2**24+this[++N]*2**16+this[++N]*2**8+this[++N],Pe=this[++N]*2**24+this[++N]*2**16+this[++N]*2**8+te;return(BigInt(Ce)<<BigInt(32))+BigInt(Pe)}),s.prototype.readIntLE=function(N,F,te){N=N>>>0,F=F>>>0,te||H(N,F,this.length);let Ce=this[N],Pe=1,Ge=0;for(;++Ge<F&&(Pe*=256);)Ce+=this[N+Ge]*Pe;return Pe*=128,Ce>=Pe&&(Ce-=Math.pow(2,8*F)),Ce},s.prototype.readIntBE=function(N,F,te){N=N>>>0,F=F>>>0,te||H(N,F,this.length);let Ce=F,Pe=1,Ge=this[N+--Ce];for(;Ce>0&&(Pe*=256);)Ge+=this[N+--Ce]*Pe;return Pe*=128,Ge>=Pe&&(Ge-=Math.pow(2,8*F)),Ge},s.prototype.readInt8=function(N,F){return N=N>>>0,F||H(N,1,this.length),this[N]&128?(255-this[N]+1)*-1:this[N]},s.prototype.readInt16LE=function(N,F){N=N>>>0,F||H(N,2,this.length);const te=this[N]|this[N+1]<<8;return te&32768?te|4294901760:te},s.prototype.readInt16BE=function(N,F){N=N>>>0,F||H(N,2,this.length);const te=this[N+1]|this[N]<<8;return te&32768?te|4294901760:te},s.prototype.readInt32LE=function(N,F){return N=N>>>0,F||H(N,4,this.length),this[N]|this[N+1]<<8|this[N+2]<<16|this[N+3]<<24},s.prototype.readInt32BE=function(N,F){return N=N>>>0,F||H(N,4,this.length),this[N]<<24|this[N+1]<<16|this[N+2]<<8|this[N+3]},s.prototype.readBigInt64LE=pn(function(N){N=N>>>0,St(N,"offset");const F=this[N],te=this[N+7];(F===void 0||te===void 0)&&Dt(N,this.length-8);const Ce=this[N+4]+this[N+5]*2**8+this[N+6]*2**16+(te<<24);return(BigInt(Ce)<<BigInt(32))+BigInt(F+this[++N]*2**8+this[++N]*2**16+this[++N]*2**24)}),s.prototype.readBigInt64BE=pn(function(N){N=N>>>0,St(N,"offset");const F=this[N],te=this[N+7];(F===void 0||te===void 0)&&Dt(N,this.length-8);const Ce=(F<<24)+this[++N]*2**16+this[++N]*2**8+this[++N];return(BigInt(Ce)<<BigInt(32))+BigInt(this[++N]*2**24+this[++N]*2**16+this[++N]*2**8+te)}),s.prototype.readFloatLE=function(N,F){return N=N>>>0,F||H(N,4,this.length),t.read(this,N,!0,23,4)},s.prototype.readFloatBE=function(N,F){return N=N>>>0,F||H(N,4,this.length),t.read(this,N,!1,23,4)},s.prototype.readDoubleLE=function(N,F){return N=N>>>0,F||H(N,8,this.length),t.read(this,N,!0,52,8)},s.prototype.readDoubleBE=function(N,F){return N=N>>>0,F||H(N,8,this.length),t.read(this,N,!1,52,8)};function ee(q,N,F,te,Ce,Pe){if(!s.isBuffer(q))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>Ce||N<Pe)throw new RangeError('"value" argument is out of bounds');if(F+te>q.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(N,F,te,Ce){if(N=+N,F=F>>>0,te=te>>>0,!Ce){const Lt=Math.pow(2,8*te)-1;ee(this,N,F,te,Lt,0)}let Pe=1,Ge=0;for(this[F]=N&255;++Ge<te&&(Pe*=256);)this[F+Ge]=N/Pe&255;return F+te},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(N,F,te,Ce){if(N=+N,F=F>>>0,te=te>>>0,!Ce){const Lt=Math.pow(2,8*te)-1;ee(this,N,F,te,Lt,0)}let Pe=te-1,Ge=1;for(this[F+Pe]=N&255;--Pe>=0&&(Ge*=256);)this[F+Pe]=N/Ge&255;return F+te},s.prototype.writeUint8=s.prototype.writeUInt8=function(N,F,te){return N=+N,F=F>>>0,te||ee(this,N,F,1,255,0),this[F]=N&255,F+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(N,F,te){return N=+N,F=F>>>0,te||ee(this,N,F,2,65535,0),this[F]=N&255,this[F+1]=N>>>8,F+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(N,F,te){return N=+N,F=F>>>0,te||ee(this,N,F,2,65535,0),this[F]=N>>>8,this[F+1]=N&255,F+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(N,F,te){return N=+N,F=F>>>0,te||ee(this,N,F,4,4294967295,0),this[F+3]=N>>>24,this[F+2]=N>>>16,this[F+1]=N>>>8,this[F]=N&255,F+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(N,F,te){return N=+N,F=F>>>0,te||ee(this,N,F,4,4294967295,0),this[F]=N>>>24,this[F+1]=N>>>16,this[F+2]=N>>>8,this[F+3]=N&255,F+4};function ae(q,N,F,te,Ce){Et(N,te,Ce,q,F,7);let Pe=Number(N&BigInt(4294967295));q[F++]=Pe,Pe=Pe>>8,q[F++]=Pe,Pe=Pe>>8,q[F++]=Pe,Pe=Pe>>8,q[F++]=Pe;let Ge=Number(N>>BigInt(32)&BigInt(4294967295));return q[F++]=Ge,Ge=Ge>>8,q[F++]=Ge,Ge=Ge>>8,q[F++]=Ge,Ge=Ge>>8,q[F++]=Ge,F}function ye(q,N,F,te,Ce){Et(N,te,Ce,q,F,7);let Pe=Number(N&BigInt(4294967295));q[F+7]=Pe,Pe=Pe>>8,q[F+6]=Pe,Pe=Pe>>8,q[F+5]=Pe,Pe=Pe>>8,q[F+4]=Pe;let Ge=Number(N>>BigInt(32)&BigInt(4294967295));return q[F+3]=Ge,Ge=Ge>>8,q[F+2]=Ge,Ge=Ge>>8,q[F+1]=Ge,Ge=Ge>>8,q[F]=Ge,F+8}s.prototype.writeBigUInt64LE=pn(function(N,F=0){return ae(this,N,F,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=pn(function(N,F=0){return ye(this,N,F,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(N,F,te,Ce){if(N=+N,F=F>>>0,!Ce){const fn=Math.pow(2,8*te-1);ee(this,N,F,te,fn-1,-fn)}let Pe=0,Ge=1,Lt=0;for(this[F]=N&255;++Pe<te&&(Ge*=256);)N<0&&Lt===0&&this[F+Pe-1]!==0&&(Lt=1),this[F+Pe]=(N/Ge>>0)-Lt&255;return F+te},s.prototype.writeIntBE=function(N,F,te,Ce){if(N=+N,F=F>>>0,!Ce){const fn=Math.pow(2,8*te-1);ee(this,N,F,te,fn-1,-fn)}let Pe=te-1,Ge=1,Lt=0;for(this[F+Pe]=N&255;--Pe>=0&&(Ge*=256);)N<0&&Lt===0&&this[F+Pe+1]!==0&&(Lt=1),this[F+Pe]=(N/Ge>>0)-Lt&255;return F+te},s.prototype.writeInt8=function(N,F,te){return N=+N,F=F>>>0,te||ee(this,N,F,1,127,-128),N<0&&(N=255+N+1),this[F]=N&255,F+1},s.prototype.writeInt16LE=function(N,F,te){return N=+N,F=F>>>0,te||ee(this,N,F,2,32767,-32768),this[F]=N&255,this[F+1]=N>>>8,F+2},s.prototype.writeInt16BE=function(N,F,te){return N=+N,F=F>>>0,te||ee(this,N,F,2,32767,-32768),this[F]=N>>>8,this[F+1]=N&255,F+2},s.prototype.writeInt32LE=function(N,F,te){return N=+N,F=F>>>0,te||ee(this,N,F,4,2147483647,-2147483648),this[F]=N&255,this[F+1]=N>>>8,this[F+2]=N>>>16,this[F+3]=N>>>24,F+4},s.prototype.writeInt32BE=function(N,F,te){return N=+N,F=F>>>0,te||ee(this,N,F,4,2147483647,-2147483648),N<0&&(N=4294967295+N+1),this[F]=N>>>24,this[F+1]=N>>>16,this[F+2]=N>>>8,this[F+3]=N&255,F+4},s.prototype.writeBigInt64LE=pn(function(N,F=0){return ae(this,N,F,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=pn(function(N,F=0){return ye(this,N,F,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ee(q,N,F,te,Ce,Pe){if(F+te>q.length)throw new RangeError("Index out of range");if(F<0)throw new RangeError("Index out of range")}function _e(q,N,F,te,Ce){return N=+N,F=F>>>0,Ce||Ee(q,N,F,4),t.write(q,N,F,te,23,4),F+4}s.prototype.writeFloatLE=function(N,F,te){return _e(this,N,F,!0,te)},s.prototype.writeFloatBE=function(N,F,te){return _e(this,N,F,!1,te)};function Je(q,N,F,te,Ce){return N=+N,F=F>>>0,Ce||Ee(q,N,F,8),t.write(q,N,F,te,52,8),F+8}s.prototype.writeDoubleLE=function(N,F,te){return Je(this,N,F,!0,te)},s.prototype.writeDoubleBE=function(N,F,te){return Je(this,N,F,!1,te)},s.prototype.copy=function(N,F,te,Ce){if(!s.isBuffer(N))throw new TypeError("argument should be a Buffer");if(te||(te=0),!Ce&&Ce!==0&&(Ce=this.length),F>=N.length&&(F=N.length),F||(F=0),Ce>0&&Ce<te&&(Ce=te),Ce===te||N.length===0||this.length===0)return 0;if(F<0)throw new RangeError("targetStart out of bounds");if(te<0||te>=this.length)throw new RangeError("Index out of range");if(Ce<0)throw new RangeError("sourceEnd out of bounds");Ce>this.length&&(Ce=this.length),N.length-F<Ce-te&&(Ce=N.length-F+te);const Pe=Ce-te;return this===N&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(F,te,Ce):Uint8Array.prototype.set.call(N,this.subarray(te,Ce),F),Pe},s.prototype.fill=function(N,F,te,Ce){if(typeof N=="string"){if(typeof F=="string"?(Ce=F,F=0,te=this.length):typeof te=="string"&&(Ce=te,te=this.length),Ce!==void 0&&typeof Ce!="string")throw new TypeError("encoding must be a string");if(typeof Ce=="string"&&!s.isEncoding(Ce))throw new TypeError("Unknown encoding: "+Ce);if(N.length===1){const Ge=N.charCodeAt(0);(Ce==="utf8"&&Ge<128||Ce==="latin1")&&(N=Ge)}}else typeof N=="number"?N=N&255:typeof N=="boolean"&&(N=Number(N));if(F<0||this.length<F||this.length<te)throw new RangeError("Out of range index");if(te<=F)return this;F=F>>>0,te=te===void 0?this.length:te>>>0,N||(N=0);let Pe;if(typeof N=="number")for(Pe=F;Pe<te;++Pe)this[Pe]=N;else{const Ge=s.isBuffer(N)?N:s.from(N,Ce),Lt=Ge.length;if(Lt===0)throw new TypeError('The value "'+N+'" is invalid for argument "value"');for(Pe=0;Pe<te-F;++Pe)this[Pe+F]=Ge[Pe%Lt]}return this};const me={};function it(q,N,F){me[q]=class extends F{constructor(){super(),Object.defineProperty(this,"message",{value:N.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${q}]`,this.stack,delete this.name}get code(){return q}set code(Ce){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ce,writable:!0})}toString(){return`${this.name} [${q}]: ${this.message}`}}}it("ERR_BUFFER_OUT_OF_BOUNDS",function(q){return q?`${q} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),it("ERR_INVALID_ARG_TYPE",function(q,N){return`The "${q}" argument must be of type number. Received type ${typeof N}`},TypeError),it("ERR_OUT_OF_RANGE",function(q,N,F){let te=`The value of "${q}" is out of range.`,Ce=F;return Number.isInteger(F)&&Math.abs(F)>2**32?Ce=Tt(String(F)):typeof F=="bigint"&&(Ce=String(F),(F>BigInt(2)**BigInt(32)||F<-(BigInt(2)**BigInt(32)))&&(Ce=Tt(Ce)),Ce+="n"),te+=` It must be ${N}. Received ${Ce}`,te},RangeError);function Tt(q){let N="",F=q.length;const te=q[0]==="-"?1:0;for(;F>=te+4;F-=3)N=`_${q.slice(F-3,F)}${N}`;return`${q.slice(0,F)}${N}`}function Xt(q,N,F){St(N,"offset"),(q[N]===void 0||q[N+F]===void 0)&&Dt(N,q.length-(F+1))}function Et(q,N,F,te,Ce,Pe){if(q>F||q<N){const Ge=typeof N=="bigint"?"n":"";let Lt;throw N===0||N===BigInt(0)?Lt=`>= 0${Ge} and < 2${Ge} ** ${(Pe+1)*8}${Ge}`:Lt=`>= -(2${Ge} ** ${(Pe+1)*8-1}${Ge}) and < 2 ** ${(Pe+1)*8-1}${Ge}`,new me.ERR_OUT_OF_RANGE("value",Lt,q)}Xt(te,Ce,Pe)}function St(q,N){if(typeof q!="number")throw new me.ERR_INVALID_ARG_TYPE(N,"number",q)}function Dt(q,N,F){throw Math.floor(q)!==q?(St(q,F),new me.ERR_OUT_OF_RANGE("offset","an integer",q)):N<0?new me.ERR_BUFFER_OUT_OF_BOUNDS:new me.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${N}`,q)}const at=/[^+/0-9A-Za-z-_]/g;function lt(q){if(q=q.split("=")[0],q=q.trim().replace(at,""),q.length<2)return"";for(;q.length%4!==0;)q=q+"=";return q}function Vt(q,N){N=N||1/0;let F;const te=q.length;let Ce=null;const Pe=[];for(let Ge=0;Ge<te;++Ge){if(F=q.charCodeAt(Ge),F>55295&&F<57344){if(!Ce){if(F>56319){(N-=3)>-1&&Pe.push(239,191,189);continue}else if(Ge+1===te){(N-=3)>-1&&Pe.push(239,191,189);continue}Ce=F;continue}if(F<56320){(N-=3)>-1&&Pe.push(239,191,189),Ce=F;continue}F=(Ce-55296<<10|F-56320)+65536}else Ce&&(N-=3)>-1&&Pe.push(239,191,189);if(Ce=null,F<128){if((N-=1)<0)break;Pe.push(F)}else if(F<2048){if((N-=2)<0)break;Pe.push(F>>6|192,F&63|128)}else if(F<65536){if((N-=3)<0)break;Pe.push(F>>12|224,F>>6&63|128,F&63|128)}else if(F<1114112){if((N-=4)<0)break;Pe.push(F>>18|240,F>>12&63|128,F>>6&63|128,F&63|128)}else throw new Error("Invalid code point")}return Pe}function Gt(q){const N=[];for(let F=0;F<q.length;++F)N.push(q.charCodeAt(F)&255);return N}function Pt(q,N){let F,te,Ce;const Pe=[];for(let Ge=0;Ge<q.length&&!((N-=2)<0);++Ge)F=q.charCodeAt(Ge),te=F>>8,Ce=F%256,Pe.push(Ce),Pe.push(te);return Pe}function Ht(q){return e.toByteArray(lt(q))}function on(q,N,F,te){let Ce;for(Ce=0;Ce<te&&!(Ce+F>=N.length||Ce>=q.length);++Ce)N[Ce+F]=q[Ce];return Ce}function ct(q,N){return q instanceof N||q!=null&&q.constructor!=null&&q.constructor.name!=null&&q.constructor.name===N.name}function ce(q){return q!==q}const nn=function(){const q="0123456789abcdef",N=new Array(256);for(let F=0;F<16;++F){const te=F*16;for(let Ce=0;Ce<16;++Ce)N[te+Ce]=q[F]+q[Ce]}return N}();function pn(q){return typeof BigInt>"u"?Un:q}function Un(){throw new Error("BigInt not supported")}}(Dm)),Dm}var _i=t3(),Bd=(n=>(n[n.BINARY=0]="BINARY",n[n.ECHO=1]="ECHO",n[n.RCP=2]="RCP",n[n.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",n[n.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",n[n.STATUS=5]="STATUS",n[n.TIMING_MARK=6]="TIMING_MARK",n[n.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",n[n.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",n[n.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",n[n.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",n[n.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",n[n.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",n[n.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",n[n.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",n[n.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",n[n.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",n[n.EXTENDED_ASCII=17]="EXTENDED_ASCII",n[n.LOGOUT=18]="LOGOUT",n[n.BYTE_MACRO=19]="BYTE_MACRO",n[n.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",n[n.SUPDUP=21]="SUPDUP",n[n.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",n[n.SEND_LOCATION=23]="SEND_LOCATION",n[n.TERMINAL_TYPE=24]="TERMINAL_TYPE",n[n.END_OF_RECORD=25]="END_OF_RECORD",n[n.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",n[n.OUTPUT_MARKING=27]="OUTPUT_MARKING",n[n.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",n[n.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",n[n.X_3_PAD=30]="X_3_PAD",n[n.NAWS=31]="NAWS",n[n.TERMINAL_SPEED=32]="TERMINAL_SPEED",n[n.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",n[n.LINEMODE=34]="LINEMODE",n[n.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",n[n.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",n[n.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",n[n.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",n[n.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",n[n.TN3270E=40]="TN3270E",n[n.XAUTH=41]="XAUTH",n[n.CHARSET=42]="CHARSET",n[n.RSP=43]="RSP",n[n.COM_PORT_OPTION=44]="COM_PORT_OPTION",n[n.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",n[n.START_TLS=46]="START_TLS",n[n.KERMIT=47]="KERMIT",n[n.SEND_URL=48]="SEND_URL",n[n.FORWARD_X=49]="FORWARD_X",n[n.PRAGMA_LOGON=138]="PRAGMA_LOGON",n[n.GMCP=201]="GMCP",n))(Bd||{}),Od=(n=>(n[n.SE=240]="SE",n[n.NOP=241]="NOP",n[n.DM=242]="DM",n[n.BRK=243]="BRK",n[n.IP=244]="IP",n[n.AO=245]="AO",n[n.AYT=246]="AYT",n[n.EC=247]="EC",n[n.EL=248]="EL",n[n.GA=249]="GA",n[n.SB=250]="SB",n[n.WILL=251]="WILL",n[n.WONT=252]="WONT",n[n.DO=253]="DO",n[n.DONT=254]="DONT",n[n.IAC=255]="IAC",n))(Od||{});class n3{constructor(e){oe(this,"ws");this.ws=e}on(e,t){if(e==="data"){this.ws.onmessage=i=>{t(i.data)};return}const r="on"+e;this[r]=t}write(e){this.ws.send(e)}}class r3 extends Rp{constructor(t){super();oe(this,"state");oe(this,"buffer");oe(this,"subBuffer");oe(this,"iacSEBuffer",_i.Buffer.from([255,240]));oe(this,"negotiationByte",0);oe(this,"stream");this.state=0,this.buffer=_i.Buffer.alloc(0),this.subBuffer=_i.Buffer.alloc(0),t&&t.on("data",r=>this.parse(r)),this.stream=t}parse(t){for(this.buffer=_i.Buffer.concat([this.buffer,_i.Buffer.from(t)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const t=this.buffer.indexOf(255);if(t===-1){this.emit("data",this.buffer),this.buffer=_i.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,t)),this.buffer=this.buffer.slice(t),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const t=this.buffer[1];switch(this.buffer=this.buffer.slice(2),t){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=_i.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=t,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const t=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",t,r),this.state=0,!1}handleSubnegotiation(){let t=this.buffer.indexOf(this.iacSEBuffer);if(t===-1)return!0;this.state=0;let r=this.buffer.slice(0,t);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(t+2),!1}handleGmcp(t){const r=t.toString(),[i,o]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,o)}sendNegotiation(t,r){this.stream.write(_i.Buffer.from([255,t,r]))}sendGmcp(t,r){const i=t+" "+r,o=_i.Buffer.from(i),a=_i.Buffer.concat([_i.Buffer.from([255,250]),_i.Buffer.from([201]),o,this.iacSEBuffer]);this.stream.write(a)}sendTerminalType(t){const r=_i.Buffer.from(t),i=_i.Buffer.concat([_i.Buffer.from([255,250]),_i.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}function i3({onlyFirst:n=!1}={}){const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(t,n?void 0:"g")}const o3=i3();function s3(n){if(typeof n!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof n}\``);return n.replace(o3,"")}class a3{constructor(e){oe(this,"editors");oe(this,"channel");this.client=e,this.editors=new Map,this.channel=new BroadcastChannel("editor"),this.setupChannelListeners()}openEditorWindow(e){console.log("Opening editor window for session:",e);const t=e.reference,r=this.editors.get(t);if(r&&r.state===1&&r.window&&!r.window.closed)r.window.focus();else{const i=encodeURIComponent(t),o=window.open(`/editor?reference=${i}`,"_blank"),a={...e,window:o,state:0};this.editors.set(t,a),o&&o.focus()}}saveEditorWindow(e){const t={reference:e.reference,type:e.type,"content*":""};this.client.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",t,e.contents)}setupChannelListeners(){this.channel.onmessage=e=>{console.log("Editor window message:",e);const{type:t,id:r,session:i}=e.data;switch(t){case"ready":console.log("Editor window ready, id:",r);const o=this.editors.get(r);if(o){o.state=1;const{window:s,...l}=o;this.channel.postMessage({type:"load",session:l})}else console.error(`No session found for id: ${r}`);break;case"save":console.log("Saving editor window with session:",i),this.saveEditorWindow(i);break;case"close":console.log("Closing editor window, id:",r);const a=this.editors.get(r);a&&(a.state=2);break}}}shutdown(){console.log("Shutting down EditorManager"),this.editors.forEach((e,t)=>{try{e.state===1&&e.window&&(console.log(`Closing editor window for ${t}`),e.window.close(),this.channel.postMessage({type:"shutdown",id:t}))}catch(r){console.error(`Error closing editor window ${t}:`,r)}}),this.editors.clear(),console.log("Closing broadcast channel"),this.channel.close(),console.log("EditorManager shutdown complete")}}class $n{constructor(e){oe(this,"packageName");oe(this,"packageVersion",1);oe(this,"client");this.client=e}get enabled(){return!0}sendData(e,t){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(t))}shutdown(){}}class c3 extends $n{constructor(){super(...arguments);oe(this,"packageName","Auth.Autologin")}handleToken(t){localStorage.setItem("LoginRefreshToken",t)}sendLogin(){var t=localStorage.getItem("LoginRefreshToken");t&&this.sendData("Login",t)}}class rk extends $n{constructor(){super(...arguments);oe(this,"packageName","Char")}handleName(t){this.client.worldData.playerId=t.name,this.client.worldData.playerName=t.fullname,this.client.emit("statustext",`Logged in as ${t.fullname}`)}handleVitals(t){console.log("Received Char.Vitals:",t),this.client.emit("vitals",t)}handleStatusVars(t){console.log("Received Char.StatusVars:",t),this.client.emit("statusVars",t)}handleStatus(t){console.log("Received Char.Status:",t),this.client.emit("statusUpdate",t)}sendLogin(t,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:t,password:r}))}}class l3 extends $n{constructor(){super(...arguments);oe(this,"packageName","Char.Offer")}handleOffer(t){console.log("Received Char.Offer:",t),this.client.emit("offer",t)}sendOfferRequest(){this.sendData("Offer",{})}}class u3 extends $n{constructor(){super(...arguments);oe(this,"packageName","Char.Prompt")}handlePrompt(t){console.log("Received Char.Prompt:",t),this.client.emit("prompt",t)}sendPromptRequest(){this.sendData("Prompt",{})}}class d3 extends $n{constructor(){super(...arguments);oe(this,"packageName","Char.Status")}handleStatus(t){console.log("Received Char.Status:",t),this.client.emit("status",t)}sendStatusRequest(){this.sendData("Status",{})}}class f3 extends $n{constructor(){super(...arguments);oe(this,"packageName","Char.Status.AffectedBy")}handleAffectedBy(t){console.log("Received Char.Status.AffectedBy:",t),this.client.emit("statusAffectedBy",t)}sendAffectedByRequest(){this.sendData("AffectedBy",{})}}class h3 extends $n{constructor(){super(...arguments);oe(this,"packageName","Char.Status.Conditions")}handleConditions(t){console.log("Received Char.Status.Conditions:",t),this.client.emit("statusConditions",t)}sendConditionsRequest(){this.sendData("Conditions",{})}}class p3 extends $n{constructor(){super(...arguments);oe(this,"packageName","Char.Status.Timers")}handleTimers(t){console.log("Received Char.Status.Timers:",t),this.client.emit("statusTimers",t)}sendTimersRequest(){this.sendData("Timers",{})}}class g3 extends $n{constructor(t){super(t);oe(this,"packageName","Client.File")}handleDownload(t){console.log("[GMCPClientFile] Received download request:",t),t.url&&window.open(t.url,"_blank")}}class ik extends $n{constructor(){super(...arguments);oe(this,"packageName","Client.FileTransfer")}sendCandidate(t,r){this.sendData("Candidate",{recipient:t,candidate:JSON.stringify(r)})}handleCandidate(t){const r=JSON.parse(t.candidate);this.client.webRTCService.handleIceCandidate(r)}handleOffer(t){console.log("[GMCPClientFileTransfer] Received offer:",t),this.client.fileTransferManager.pendingOffers.set(`${t.hash}`,t),this.client.onFileTransferOffer(t.sender,t.hash,t.filename,t.filesize,t.offerSdp)}handleAccept(t){this.client.onFileTransferAccept(t.sender,t.hash,t.filename,t.answerSdp)}handleReject(t){this.client.onFileTransferReject(t.sender,t.hash)}handleCancel(t){this.client.onFileTransferCancel(t.sender,t.hash)}sendOffer(t,r,i,o,a){this.sendData("Offer",{recipient:t,filename:r,filesize:i,offerSdp:o,hash:a})}sendAccept(t,r,i,o){this.sendData("Accept",{sender:t,hash:r,filename:i,answerSdp:o})}sendReject(t,r){this.sendData("Reject",{sender:t,hash:r})}sendCancel(t,r){this.sendData("Cancel",{recipient:t,hash:r})}sendRequestResend(t,r){this.sendData("RequestResend",{sender:t,hash:r})}}function iC(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var El=iC();function ok(n){El=n}var Vd={exec:()=>null};function Gn(n,e=""){let t=typeof n=="string"?n:n.source;const r={replace:(i,o)=>{let a=typeof o=="string"?o:o.source;return a=a.replace(ji.caret,"$1"),t=t.replace(i,a),r},getRegex:()=>new RegExp(t,e)};return r}var ji={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},m3=/^(?:[ \t]*(?:\n|$))+/,v3=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,y3=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Cf=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,C3=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,oC=/(?:[*+-]|\d{1,9}[.)])/,sk=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,ak=Gn(sk).replace(/bull/g,oC).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),x3=Gn(sk).replace(/bull/g,oC).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),sC=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,b3=/^[^\n]+/,aC=/(?!\s*\])(?:\\.|[^\[\]\\])+/,I3=Gn(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",aC).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),w3=Gn(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,oC).getRegex(),Pp="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",cC=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,S3=Gn("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",cC).replace("tag",Pp).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ck=Gn(sC).replace("hr",Cf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pp).getRegex(),A3=Gn(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ck).getRegex(),lC={blockquote:A3,code:v3,def:I3,fences:y3,heading:C3,hr:Cf,html:S3,lheading:ak,list:w3,newline:m3,paragraph:ck,table:Vd,text:b3},aI=Gn("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Cf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pp).getRegex(),k3={...lC,lheading:x3,table:aI,paragraph:Gn(sC).replace("hr",Cf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",aI).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pp).getRegex()},E3={...lC,html:Gn(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",cC).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Vd,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Gn(sC).replace("hr",Cf).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ak).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},T3=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,_3=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,lk=/^( {2,}|\\)\n(?!\s*$)/,R3=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Dp=/[\p{P}\p{S}]/u,uC=/[\s\p{P}\p{S}]/u,uk=/[^\s\p{P}\p{S}]/u,P3=Gn(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,uC).getRegex(),dk=/(?!~)[\p{P}\p{S}]/u,D3=/(?!~)[\s\p{P}\p{S}]/u,M3=/(?:[^\s\p{P}\p{S}]|~)/u,N3=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,fk=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,B3=Gn(fk,"u").replace(/punct/g,Dp).getRegex(),O3=Gn(fk,"u").replace(/punct/g,dk).getRegex(),hk="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",F3=Gn(hk,"gu").replace(/notPunctSpace/g,uk).replace(/punctSpace/g,uC).replace(/punct/g,Dp).getRegex(),L3=Gn(hk,"gu").replace(/notPunctSpace/g,M3).replace(/punctSpace/g,D3).replace(/punct/g,dk).getRegex(),U3=Gn("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,uk).replace(/punctSpace/g,uC).replace(/punct/g,Dp).getRegex(),j3=Gn(/\\(punct)/,"gu").replace(/punct/g,Dp).getRegex(),G3=Gn(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),V3=Gn(cC).replace("(?:-->|$)","-->").getRegex(),z3=Gn("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",V3).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),q0=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,W3=Gn(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",q0).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),pk=Gn(/^!?\[(label)\]\[(ref)\]/).replace("label",q0).replace("ref",aC).getRegex(),gk=Gn(/^!?\[(ref)\](?:\[\])?/).replace("ref",aC).getRegex(),H3=Gn("reflink|nolink(?!\\()","g").replace("reflink",pk).replace("nolink",gk).getRegex(),dC={_backpedal:Vd,anyPunctuation:j3,autolink:G3,blockSkip:N3,br:lk,code:_3,del:Vd,emStrongLDelim:B3,emStrongRDelimAst:F3,emStrongRDelimUnd:U3,escape:T3,link:W3,nolink:gk,punctuation:P3,reflink:pk,reflinkSearch:H3,tag:z3,text:R3,url:Vd},Z3={...dC,link:Gn(/^!?\[(label)\]\((.*?)\)/).replace("label",q0).getRegex(),reflink:Gn(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",q0).getRegex()},Pv={...dC,emStrongRDelimAst:L3,emStrongLDelim:O3,url:Gn(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},X3={...Pv,br:Gn(lk).replace("{2,}","*").getRegex(),text:Gn(Pv.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},kh={normal:lC,gfm:k3,pedantic:E3},yd={normal:dC,gfm:Pv,breaks:X3,pedantic:Z3},$3={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},cI=n=>$3[n];function Vs(n,e){if(e){if(ji.escapeTest.test(n))return n.replace(ji.escapeReplace,cI)}else if(ji.escapeTestNoEncode.test(n))return n.replace(ji.escapeReplaceNoEncode,cI);return n}function lI(n){try{n=encodeURI(n).replace(ji.percentDecode,"%")}catch{return null}return n}function uI(n,e){var o;const t=n.replace(ji.findPipe,(a,s,l)=>{let f=!1,h=s;for(;--h>=0&&l[h]==="\\";)f=!f;return f?"|":" |"}),r=t.split(ji.splitPipe);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!((o=r.at(-1))!=null&&o.trim())&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(ji.slashPipe,"|");return r}function Cd(n,e,t){const r=n.length;if(r===0)return"";let i=0;for(;i<r&&n.charAt(r-i-1)===e;)i++;return n.slice(0,r-i)}function K3(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return t>0?-2:-1}function dI(n,e,t,r,i){const o=e.href,a=e.title||null,s=n[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;const l={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:o,title:a,text:s,tokens:r.inlineTokens(s)};return r.state.inLink=!1,l}function q3(n,e,t){const r=n.match(t.other.indentCodeCompensation);if(r===null)return e;const i=r[1];return e.split(`
`).map(o=>{const a=o.match(t.other.beginningSpace);if(a===null)return o;const[s]=a;return s.length>=i.length?o.slice(i.length):o}).join(`
`)}var Y0=class{constructor(n){oe(this,"options");oe(this,"rules");oe(this,"lexer");this.options=n||El}space(n){const e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){const e=this.rules.block.code.exec(n);if(e){const t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:Cd(t,`
`)}}}fences(n){const e=this.rules.block.fences.exec(n);if(e){const t=e[0],r=q3(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(n){const e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){const r=Cd(t,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(t=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){const e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:Cd(e[0],`
`)}}blockquote(n){const e=this.rules.block.blockquote.exec(n);if(e){let t=Cd(e[0],`
`).split(`
`),r="",i="";const o=[];for(;t.length>0;){let a=!1;const s=[];let l;for(l=0;l<t.length;l++)if(this.rules.other.blockquoteStart.test(t[l]))s.push(t[l]),a=!0;else if(!a)s.push(t[l]);else break;t=t.slice(l);const f=s.join(`
`),h=f.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${f}`:f,i=i?`${i}
${h}`:h;const m=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,o,!0),this.lexer.state.top=m,t.length===0)break;const g=o.at(-1);if((g==null?void 0:g.type)==="code")break;if((g==null?void 0:g.type)==="blockquote"){const y=g,C=y.raw+`
`+t.join(`
`),x=this.blockquote(C);o[o.length-1]=x,r=r.substring(0,r.length-y.raw.length)+x.raw,i=i.substring(0,i.length-y.text.length)+x.text;break}else if((g==null?void 0:g.type)==="list"){const y=g,C=y.raw+`
`+t.join(`
`),x=this.list(C);o[o.length-1]=x,r=r.substring(0,r.length-g.raw.length)+x.raw,i=i.substring(0,i.length-y.raw.length)+x.raw,t=C.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:i}}}list(n){let e=this.rules.block.list.exec(n);if(e){let t=e[1].trim();const r=t.length>1,i={type:"list",raw:"",ordered:r,start:r?+t.slice(0,-1):"",loose:!1,items:[]};t=r?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=r?t:"[*+-]");const o=this.rules.other.listItemRegex(t);let a=!1;for(;n;){let l=!1,f="",h="";if(!(e=o.exec(n))||this.rules.block.hr.test(n))break;f=e[0],n=n.substring(f.length);let m=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,S=>" ".repeat(3*S.length)),g=n.split(`
`,1)[0],y=!m.trim(),C=0;if(this.options.pedantic?(C=2,h=m.trimStart()):y?C=e[1].length+1:(C=e[2].search(this.rules.other.nonSpaceChar),C=C>4?1:C,h=m.slice(C),C+=e[1].length),y&&this.rules.other.blankLine.test(g)&&(f+=g+`
`,n=n.substring(g.length+1),l=!0),!l){const S=this.rules.other.nextBulletRegex(C),A=this.rules.other.hrRegex(C),E=this.rules.other.fencesBeginRegex(C),_=this.rules.other.headingBeginRegex(C),T=this.rules.other.htmlBeginRegex(C);for(;n;){const M=n.split(`
`,1)[0];let P;if(g=M,this.options.pedantic?(g=g.replace(this.rules.other.listReplaceNesting,"  "),P=g):P=g.replace(this.rules.other.tabCharGlobal,"    "),E.test(g)||_.test(g)||T.test(g)||S.test(g)||A.test(g))break;if(P.search(this.rules.other.nonSpaceChar)>=C||!g.trim())h+=`
`+P.slice(C);else{if(y||m.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||E.test(m)||_.test(m)||A.test(m))break;h+=`
`+g}!y&&!g.trim()&&(y=!0),f+=M+`
`,n=n.substring(M.length+1),m=P.slice(C)}}i.loose||(a?i.loose=!0:this.rules.other.doubleBlankLine.test(f)&&(a=!0));let x=null,w;this.options.gfm&&(x=this.rules.other.listIsTask.exec(h),x&&(w=x[0]!=="[ ] ",h=h.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:f,task:!!x,checked:w,loose:!1,text:h,tokens:[]}),i.raw+=f}const s=i.items.at(-1);if(s)s.raw=s.raw.trimEnd(),s.text=s.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let l=0;l<i.items.length;l++)if(this.lexer.state.top=!1,i.items[l].tokens=this.lexer.blockTokens(i.items[l].text,[]),!i.loose){const f=i.items[l].tokens.filter(m=>m.type==="space"),h=f.length>0&&f.some(m=>this.rules.other.anyLine.test(m.raw));i.loose=h}if(i.loose)for(let l=0;l<i.items.length;l++)i.items[l].loose=!0;return i}}html(n){const e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){const e=this.rules.block.def.exec(n);if(e){const t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:r,title:i}}}table(n){var a;const e=this.rules.block.table.exec(n);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const t=uI(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(a=e[3])!=null&&a.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===r.length){for(const s of r)this.rules.other.tableAlignRight.test(s)?o.align.push("right"):this.rules.other.tableAlignCenter.test(s)?o.align.push("center"):this.rules.other.tableAlignLeft.test(s)?o.align.push("left"):o.align.push(null);for(let s=0;s<t.length;s++)o.header.push({text:t[s],tokens:this.lexer.inline(t[s]),header:!0,align:o.align[s]});for(const s of i)o.rows.push(uI(s,o.header.length).map((l,f)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:o.align[f]})));return o}}lheading(n){const e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){const e=this.rules.block.paragraph.exec(n);if(e){const t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){const e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){const e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(n){const e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){const e=this.rules.inline.link.exec(n);if(e){const t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;const o=Cd(t.slice(0,-1),"\\");if((t.length-o.length)%2===0)return}else{const o=K3(e[2],"()");if(o===-2)return;if(o>-1){const s=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,s).trim(),e[3]=""}}let r=e[2],i="";if(this.options.pedantic){const o=this.rules.other.pedanticHrefTitle.exec(r);o&&(r=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?r=r.slice(1):r=r.slice(1,-1)),dI(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){const r=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[r.toLowerCase()];if(!i){const o=t[0].charAt(0);return{type:"text",raw:o,text:o}}return dI(t,i,t[0],this.lexer,this.rules)}}emStrong(n,e,t=""){let r=this.rules.inline.emStrongLDelim.exec(n);if(!r||r[3]&&t.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const o=[...r[0]].length-1;let a,s,l=o,f=0;const h=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*n.length+o);(r=h.exec(e))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(s=[...a].length,r[3]||r[4]){l+=s;continue}else if((r[5]||r[6])&&o%3&&!((o+s)%3)){f+=s;continue}if(l-=s,l>0)continue;s=Math.min(s,s+l+f);const m=[...r[0]][0].length,g=n.slice(0,o+r.index+m+s);if(Math.min(o,s)%2){const C=g.slice(1,-1);return{type:"em",raw:g,text:C,tokens:this.lexer.inlineTokens(C)}}const y=g.slice(2,-2);return{type:"strong",raw:g,text:y,tokens:this.lexer.inlineTokens(y)}}}}codespan(n){const e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(t),i=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return r&&i&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(n){const e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){const e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){const e=this.rules.inline.autolink.exec(n);if(e){let t,r;return e[2]==="@"?(t=e[1],r="mailto:"+t):(t=e[1],r=t),{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}url(n){var t;let e;if(e=this.rules.inline.url.exec(n)){let r,i;if(e[2]==="@")r=e[0],i="mailto:"+r;else{let o;do o=e[0],e[0]=((t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])??"";while(o!==e[0]);r=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(n){const e=this.rules.inline.text.exec(n);if(e){const t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},_a=class Dv{constructor(e){oe(this,"tokens");oe(this,"options");oe(this,"state");oe(this,"tokenizer");oe(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||El,this.options.tokenizer=this.options.tokenizer||new Y0,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:ji,block:kh.normal,inline:yd.normal};this.options.pedantic?(t.block=kh.pedantic,t.inline=yd.pedantic):this.options.gfm&&(t.block=kh.gfm,this.options.breaks?t.inline=yd.breaks:t.inline=yd.gfm),this.tokenizer.rules=t}static get rules(){return{block:kh,inline:yd}}static lex(e,t){return new Dv(t).lex(e)}static lexInline(e,t){return new Dv(t).inlineTokens(e)}lex(e){e=e.replace(ji.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){var i,o,a;for(this.options.pedantic&&(e=e.replace(ji.tabCharGlobal,"    ").replace(ji.spaceLine,""));e;){let s;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(f=>(s=f.call({lexer:this},e,t))?(e=e.substring(s.raw.length),t.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);const f=t.at(-1);s.raw.length===1&&f!==void 0?f.raw+=`
`:t.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="paragraph"||(f==null?void 0:f.type)==="text"?(f.raw+=`
`+s.raw,f.text+=`
`+s.text,this.inlineQueue.at(-1).src=f.text):t.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="paragraph"||(f==null?void 0:f.type)==="text"?(f.raw+=`
`+s.raw,f.text+=`
`+s.raw,this.inlineQueue.at(-1).src=f.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),t.push(s);continue}let l=e;if((a=this.options.extensions)!=null&&a.startBlock){let f=1/0;const h=e.slice(1);let m;this.options.extensions.startBlock.forEach(g=>{m=g.call({lexer:this},h),typeof m=="number"&&m>=0&&(f=Math.min(f,m))}),f<1/0&&f>=0&&(l=e.substring(0,f+1))}if(this.state.top&&(s=this.tokenizer.paragraph(l))){const f=t.at(-1);r&&(f==null?void 0:f.type)==="paragraph"?(f.raw+=`
`+s.raw,f.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=f.text):t.push(s),r=l.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=`
`+s.raw,f.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=f.text):t.push(s);continue}if(e){const f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var s,l,f;let r=e,i=null;if(this.tokens.links){const h=Object.keys(this.tokens.links);if(h.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)h.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,a="";for(;e;){o||(a=""),o=!1;let h;if((l=(s=this.options.extensions)==null?void 0:s.inline)!=null&&l.some(g=>(h=g.call({lexer:this},e,t))?(e=e.substring(h.raw.length),t.push(h),!0):!1))continue;if(h=this.tokenizer.escape(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.tag(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.link(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(h.raw.length);const g=t.at(-1);h.type==="text"&&(g==null?void 0:g.type)==="text"?(g.raw+=h.raw,g.text+=h.text):t.push(h);continue}if(h=this.tokenizer.emStrong(e,r,a)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.codespan(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.br(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.del(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.autolink(e)){e=e.substring(h.raw.length),t.push(h);continue}if(!this.state.inLink&&(h=this.tokenizer.url(e))){e=e.substring(h.raw.length),t.push(h);continue}let m=e;if((f=this.options.extensions)!=null&&f.startInline){let g=1/0;const y=e.slice(1);let C;this.options.extensions.startInline.forEach(x=>{C=x.call({lexer:this},y),typeof C=="number"&&C>=0&&(g=Math.min(g,C))}),g<1/0&&g>=0&&(m=e.substring(0,g+1))}if(h=this.tokenizer.inlineText(m)){e=e.substring(h.raw.length),h.raw.slice(-1)!=="_"&&(a=h.raw.slice(-1)),o=!0;const g=t.at(-1);(g==null?void 0:g.type)==="text"?(g.raw+=h.raw,g.text+=h.text):t.push(h);continue}if(e){const g="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return t}},Q0=class{constructor(n){oe(this,"options");oe(this,"parser");this.options=n||El}space(n){return""}code({text:n,lang:e,escaped:t}){var o;const r=(o=(e||"").match(ji.notSpaceStart))==null?void 0:o[0],i=n.replace(ji.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Vs(r)+'">'+(t?i:Vs(i,!0))+`</code></pre>
`:"<pre><code>"+(t?i:Vs(i,!0))+`</code></pre>
`}blockquote({tokens:n}){return`<blockquote>
${this.parser.parse(n)}</blockquote>
`}html({text:n}){return n}heading({tokens:n,depth:e}){return`<h${e}>${this.parser.parseInline(n)}</h${e}>
`}hr(n){return`<hr>
`}list(n){const e=n.ordered,t=n.start;let r="";for(let a=0;a<n.items.length;a++){const s=n.items[a];r+=this.listitem(s)}const i=e?"ol":"ul",o=e&&t!==1?' start="'+t+'"':"";return"<"+i+o+`>
`+r+"</"+i+`>
`}listitem(n){var t;let e="";if(n.task){const r=this.checkbox({checked:!!n.checked});n.loose?((t=n.tokens[0])==null?void 0:t.type)==="paragraph"?(n.tokens[0].text=r+" "+n.tokens[0].text,n.tokens[0].tokens&&n.tokens[0].tokens.length>0&&n.tokens[0].tokens[0].type==="text"&&(n.tokens[0].tokens[0].text=r+" "+Vs(n.tokens[0].tokens[0].text),n.tokens[0].tokens[0].escaped=!0)):n.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):e+=r+" "}return e+=this.parser.parse(n.tokens,!!n.loose),`<li>${e}</li>
`}checkbox({checked:n}){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:n}){return`<p>${this.parser.parseInline(n)}</p>
`}table(n){let e="",t="";for(let i=0;i<n.header.length;i++)t+=this.tablecell(n.header[i]);e+=this.tablerow({text:t});let r="";for(let i=0;i<n.rows.length;i++){const o=n.rows[i];t="";for(let a=0;a<o.length;a++)t+=this.tablecell(o[a]);r+=this.tablerow({text:t})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:n}){return`<tr>
${n}</tr>
`}tablecell(n){const e=this.parser.parseInline(n.tokens),t=n.header?"th":"td";return(n.align?`<${t} align="${n.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:n}){return`<strong>${this.parser.parseInline(n)}</strong>`}em({tokens:n}){return`<em>${this.parser.parseInline(n)}</em>`}codespan({text:n}){return`<code>${Vs(n,!0)}</code>`}br(n){return"<br>"}del({tokens:n}){return`<del>${this.parser.parseInline(n)}</del>`}link({href:n,title:e,tokens:t}){const r=this.parser.parseInline(t),i=lI(n);if(i===null)return r;n=i;let o='<a href="'+n+'"';return e&&(o+=' title="'+Vs(e)+'"'),o+=">"+r+"</a>",o}image({href:n,title:e,text:t,tokens:r}){r&&(t=this.parser.parseInline(r,this.parser.textRenderer));const i=lI(n);if(i===null)return Vs(t);n=i;let o=`<img src="${n}" alt="${t}"`;return e&&(o+=` title="${Vs(e)}"`),o+=">",o}text(n){return"tokens"in n&&n.tokens?this.parser.parseInline(n.tokens):"escaped"in n&&n.escaped?n.text:Vs(n.text)}},fC=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}},Ra=class Mv{constructor(e){oe(this,"options");oe(this,"renderer");oe(this,"textRenderer");this.options=e||El,this.options.renderer=this.options.renderer||new Q0,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new fC}static parse(e,t){return new Mv(t).parse(e)}static parseInline(e,t){return new Mv(t).parseInline(e)}parse(e,t=!0){var i,o;let r="";for(let a=0;a<e.length;a++){const s=e[a];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[s.type]){const f=s,h=this.options.extensions.renderers[f.type].call({parser:this},f);if(h!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(f.type)){r+=h||"";continue}}const l=s;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let f=l,h=this.renderer.text(f);for(;a+1<e.length&&e[a+1].type==="text";)f=e[++a],h+=`
`+this.renderer.text(f);t?r+=this.renderer.paragraph({type:"paragraph",raw:h,text:h,tokens:[{type:"text",raw:h,text:h,escaped:!0}]}):r+=h;continue}default:{const f='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(f),"";throw new Error(f)}}}return r}parseInline(e,t=this.renderer){var i,o;let r="";for(let a=0;a<e.length;a++){const s=e[a];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[s.type]){const f=this.options.extensions.renderers[s.type].call({parser:this},s);if(f!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=f||"";continue}}const l=s;switch(l.type){case"escape":{r+=t.text(l);break}case"html":{r+=t.html(l);break}case"link":{r+=t.link(l);break}case"image":{r+=t.image(l);break}case"strong":{r+=t.strong(l);break}case"em":{r+=t.em(l);break}case"codespan":{r+=t.codespan(l);break}case"br":{r+=t.br(l);break}case"del":{r+=t.del(l);break}case"text":{r+=t.text(l);break}default:{const f='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(f),"";throw new Error(f)}}}return r}},kv,zh=(kv=class{constructor(n){oe(this,"options");oe(this,"block");this.options=n||El}preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}provideLexer(){return this.block?_a.lex:_a.lexInline}provideParser(){return this.block?Ra.parse:Ra.parseInline}},oe(kv,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),kv),Y3=class{constructor(...n){oe(this,"defaults",iC());oe(this,"options",this.setOptions);oe(this,"parse",this.parseMarkdown(!0));oe(this,"parseInline",this.parseMarkdown(!1));oe(this,"Parser",Ra);oe(this,"Renderer",Q0);oe(this,"TextRenderer",fC);oe(this,"Lexer",_a);oe(this,"Tokenizer",Y0);oe(this,"Hooks",zh);this.use(...n)}walkTokens(n,e){var r,i;let t=[];for(const o of n)switch(t=t.concat(e.call(this,o)),o.type){case"table":{const a=o;for(const s of a.header)t=t.concat(this.walkTokens(s.tokens,e));for(const s of a.rows)for(const l of s)t=t.concat(this.walkTokens(l.tokens,e));break}case"list":{const a=o;t=t.concat(this.walkTokens(a.items,e));break}default:{const a=o;(i=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&i[a.type]?this.defaults.extensions.childTokens[a.type].forEach(s=>{const l=a[s].flat(1/0);t=t.concat(this.walkTokens(l,e))}):a.tokens&&(t=t.concat(this.walkTokens(a.tokens,e)))}}return t}use(...n){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{const r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const o=e.renderers[i.name];o?e.renderers[i.name]=function(...a){let s=i.renderer.apply(this,a);return s===!1&&(s=o.apply(this,a)),s}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),r.extensions=e),t.renderer){const i=this.defaults.renderer||new Q0(this.defaults);for(const o in t.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const a=o,s=t.renderer[a],l=i[a];i[a]=(...f)=>{let h=s.apply(i,f);return h===!1&&(h=l.apply(i,f)),h||""}}r.renderer=i}if(t.tokenizer){const i=this.defaults.tokenizer||new Y0(this.defaults);for(const o in t.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,s=t.tokenizer[a],l=i[a];i[a]=(...f)=>{let h=s.apply(i,f);return h===!1&&(h=l.apply(i,f)),h}}r.tokenizer=i}if(t.hooks){const i=this.defaults.hooks||new zh;for(const o in t.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;const a=o,s=t.hooks[a],l=i[a];zh.passThroughHooks.has(o)?i[a]=f=>{if(this.defaults.async)return Promise.resolve(s.call(i,f)).then(m=>l.call(i,m));const h=s.call(i,f);return l.call(i,h)}:i[a]=(...f)=>{let h=s.apply(i,f);return h===!1&&(h=l.apply(i,f)),h}}r.hooks=i}if(t.walkTokens){const i=this.defaults.walkTokens,o=t.walkTokens;r.walkTokens=function(a){let s=[];return s.push(o.call(this,a)),i&&(s=s.concat(i.call(this,a))),s}}this.defaults={...this.defaults,...r}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,e){return _a.lex(n,e??this.defaults)}parser(n,e){return Ra.parse(n,e??this.defaults)}parseMarkdown(n){return(t,r)=>{const i={...r},o={...this.defaults,...i},a=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&i.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=n);const s=o.hooks?o.hooks.provideLexer():n?_a.lex:_a.lexInline,l=o.hooks?o.hooks.provideParser():n?Ra.parse:Ra.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(t):t).then(f=>s(f,o)).then(f=>o.hooks?o.hooks.processAllTokens(f):f).then(f=>o.walkTokens?Promise.all(this.walkTokens(f,o.walkTokens)).then(()=>f):f).then(f=>l(f,o)).then(f=>o.hooks?o.hooks.postprocess(f):f).catch(a);try{o.hooks&&(t=o.hooks.preprocess(t));let f=s(t,o);o.hooks&&(f=o.hooks.processAllTokens(f)),o.walkTokens&&this.walkTokens(f,o.walkTokens);let h=l(f,o);return o.hooks&&(h=o.hooks.postprocess(h)),h}catch(f){return a(f)}}}onError(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){const r="<p>An error occurred:</p><pre>"+Vs(t.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(t);throw t}}},ml=new Y3;function Wn(n,e){return ml.parse(n,e)}Wn.options=Wn.setOptions=function(n){return ml.setOptions(n),Wn.defaults=ml.defaults,ok(Wn.defaults),Wn};Wn.getDefaults=iC;Wn.defaults=El;Wn.use=function(...n){return ml.use(...n),Wn.defaults=ml.defaults,ok(Wn.defaults),Wn};Wn.walkTokens=function(n,e){return ml.walkTokens(n,e)};Wn.parseInline=ml.parseInline;Wn.Parser=Ra;Wn.parser=Ra.parse;Wn.Renderer=Q0;Wn.TextRenderer=fC;Wn.Lexer=_a;Wn.lexer=_a.lex;Wn.Tokenizer=Y0;Wn.Hooks=zh;Wn.parse=Wn;Wn.options;Wn.setOptions;Wn.use;Wn.walkTokens;Wn.parseInline;Ra.parse;_a.lex;class Q3 extends $n{constructor(t){super(t);oe(this,"packageName","Client.Html")}handleAdd_html(t){this.client.emit("html",t.data.join(`
`))}handleAdd_markdown(t){const r=t.data.join(`
`),i=Wn(r);this.client.emit("html",i)}}class J3{constructor(){oe(this,"state",{text:""});oe(this,"listeners",new Set);oe(this,"inputRef",null);oe(this,"dispatch",e=>{const t=this.state;this.state=this.reducer(this.state,e),this.state!==t&&this.listeners.forEach(r=>r())})}reducer(e,t){switch(t.type){case"SET_INPUT":return e.text!==t.data?{...e,text:t.data}:e;case"CLEAR_INPUT":return e.text!==""?{...e,text:""}:e;default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}registerInputRef(e){this.inputRef=e}focusInput(){var e;(e=this.inputRef)!=null&&e.current&&this.inputRef.current.focus()}}const Pa=new J3,il=n=>{Pa.dispatch({type:"SET_INPUT",data:n})},fI=n=>{Pa.dispatch({type:"SET_INPUT",data:n}),Pa.focusInput()},eM=()=>{Pa.dispatch({type:"CLEAR_INPUT"})};class tM extends $n{constructor(t){super(t);oe(this,"packageName","Client.Keystrokes");oe(this,"bindings",[]);oe(this,"boundKeyDownHandler");this.boundKeyDownHandler=this.handleKeydown.bind(this),document.addEventListener("keydown",this.boundKeyDownHandler)}handleKeydown(t){const r=this.findBinding(t);if(r){t.preventDefault();const i=Pa.getState().text,o=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(o):this.placeInInputField(o)}}shutdown(){document.removeEventListener("keydown",this.boundKeyDownHandler)}findBinding(t){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==t.key.toLowerCase())return!1;const i=new Set([t.altKey&&"alt",t.ctrlKey&&"control",t.shiftKey&&"shift",t.metaKey&&"meta"].filter(Boolean)),o=new Set((r.modifiers||[]).map(a=>a.toLowerCase()));return i.size!==o.size?!1:Array.from(o).every(a=>i.has(a))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(t,r){const i=r.trim().split(/\s+/);return t.replace(/%(\d+|\*)/g,(o,a)=>{if(a==="*")return r;const s=parseInt(a,10)-1;return s>=0&&s<i.length?i[s]:o})}placeInInputField(t){il(t)}bindKey(t){const r={key:t.key,modifiers:t.modifiers,command:t.command,autosend:t.autosend};this.bindings.push(r)}unbindKey(t){const r=new Set((t.modifiers||[]).map(i=>i.toLowerCase()));this.bindings=this.bindings.filter(i=>{const o=new Set((i.modifiers||[]).map(s=>s.toLowerCase()));return i.key.toLowerCase()!==t.key.toLowerCase()||o.size!==r.size?!0:!Array.from(r).every(s=>o.has(s))})}unbindAll(){this.bindings=[]}handleBind(t){this.bindKey(t)}handleUnbind(t){this.unbindKey(t)}handleBind_all(t){this.bindings=t.bindings.map(r=>({...r}))}handleUnbindAll(t){console.log("Received Client.Keystrokes.UnbindAll, clearing all bindings."),this.unbindAll()}handleListBindings(t){console.log("Received Client.Keystrokes.ListBindings request, sending current bindings.");const r=this.listBindings();this.sendData("BindingsList",r)}listBindings(){return[...this.bindings]}}const hI=(n,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:n}),pI=(n,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:n}),Nv=(n,e)=>({startTime:e,type:"setValue",value:n}),mk=(n,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:n}),vk=(n,e,{startTime:t,target:r,timeConstant:i})=>r+(e-r)*Math.exp((t-n)/i),lu=n=>n.type==="exponentialRampToValue",J0=n=>n.type==="linearRampToValue",gc=n=>lu(n)||J0(n),hC=n=>n.type==="setValue",Ia=n=>n.type==="setValueCurve",ep=(n,e,t,r)=>{const i=n[e];return i===void 0?r:gc(i)||hC(i)?i.value:Ia(i)?i.values[i.values.length-1]:vk(t,ep(n,e-1,i.startTime,r),i)},gI=(n,e,t,r,i)=>t===void 0?[r.insertTime,i]:gc(t)?[t.endTime,t.value]:hC(t)?[t.startTime,t.value]:Ia(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,ep(n,e-1,t.startTime,i)],Bv=n=>n.type==="cancelAndHold",Ov=n=>n.type==="cancelScheduledValues",oc=n=>Bv(n)||Ov(n)?n.cancelTime:lu(n)||J0(n)?n.endTime:n.startTime,mI=(n,e,t,{endTime:r,value:i})=>t===i?i:0<t&&0<i||t<0&&i<0?t*(i/t)**((n-e)/(r-e)):0,vI=(n,e,t,{endTime:r,value:i})=>t+(n-e)/(r-e)*(i-t),nM=(n,e)=>{const t=Math.floor(e),r=Math.ceil(e);return t===r?n[t]:(1-(e-t))*n[t]+(1-(r-e))*n[r]},rM=(n,{duration:e,startTime:t,values:r})=>{const i=(n-t)/e*(r.length-1);return nM(r,i)},Eh=n=>n.type==="setTarget";class iM{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=oc(e);if(Bv(e)||Ov(e)){const r=this._automationEvents.findIndex(o=>Ov(e)&&Ia(o)?o.startTime+o.duration>=t:oc(o)>=t),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Bv(e)){const o=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&gc(i)){if(o!==void 0&&Eh(o))throw new Error("The internal list is malformed.");const a=o===void 0?i.insertTime:Ia(o)?o.startTime+o.duration:oc(o),s=o===void 0?this._defaultValue:Ia(o)?o.values[o.values.length-1]:o.value,l=lu(i)?mI(t,a,s,i):vI(t,a,s,i),f=lu(i)?hI(l,t,this._currenTime):pI(l,t,this._currenTime);this._automationEvents.push(f)}if(o!==void 0&&Eh(o)&&this._automationEvents.push(Nv(this.getValue(t),t)),o!==void 0&&Ia(o)&&o.startTime+o.duration>t){const a=t-o.startTime,s=(o.values.length-1)/o.duration,l=Math.max(2,1+Math.ceil(a*s)),f=a/(l-1)*s,h=o.values.slice(0,l);if(f<1)for(let m=1;m<l;m+=1){const g=f*m%1;h[m]=o.values[m-1]*(1-g)+o.values[m]*g}this._automationEvents[this._automationEvents.length-1]=mk(h,o.startTime,a)}}}else{const r=this._automationEvents.findIndex(a=>oc(a)>t),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Ia(i)&&oc(i)+i.duration>t)return!1;const o=lu(e)?hI(e.value,e.endTime,this._currenTime):J0(e)?pI(e.value,t,this._currenTime):e;if(r===-1)this._automationEvents.push(o);else{if(Ia(e)&&t+e.duration>oc(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(e){const t=this._automationEvents.findIndex(r=>oc(r)>e);if(t>1){const r=this._automationEvents.slice(t-1),i=r[0];Eh(i)&&r.unshift(Nv(ep(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(a=>oc(a)>e),r=this._automationEvents[t],i=(t===-1?this._automationEvents.length:t)-1,o=this._automationEvents[i];if(o!==void 0&&Eh(o)&&(r===void 0||!gc(r)||r.insertTime>e))return vk(e,ep(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(o!==void 0&&hC(o)&&(r===void 0||!gc(r)))return o.value;if(o!==void 0&&Ia(o)&&(r===void 0||!gc(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?rM(e,o):o.values[o.values.length-1];if(o!==void 0&&gc(o)&&(r===void 0||!gc(r)))return o.value;if(r!==void 0&&lu(r)){const[a,s]=gI(this._automationEvents,i,o,r,this._defaultValue);return mI(e,a,s,r)}if(r!==void 0&&J0(r)){const[a,s]=gI(this._automationEvents,i,o,r,this._defaultValue);return vI(e,a,s,r)}return this._defaultValue}}const oM=n=>({cancelTime:n,type:"cancelAndHold"}),sM=n=>({cancelTime:n,type:"cancelScheduledValues"}),aM=(n,e)=>({endTime:e,type:"exponentialRampToValue",value:n}),cM=(n,e)=>({endTime:e,type:"linearRampToValue",value:n}),lM=(n,e,t)=>({startTime:e,target:n,timeConstant:t,type:"setTarget"}),uM=()=>new DOMException("","AbortError"),dM=n=>(e,t,[r,i,o],a)=>{n(e[i],[t,r,o],s=>s[0]===t&&s[1]===r,a)},fM=n=>(e,t,r)=>{const i=[];for(let o=0;o<r.numberOfInputs;o+=1)i.push(new Set);n.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},hM=n=>(e,t)=>{n.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Eu=new WeakSet,yk=new WeakMap,Ck=new WeakMap,xk=new WeakMap,bk=new WeakMap,Ik=new WeakMap,wk=new WeakMap,Fv=new WeakMap,Lv=new WeakMap,Uv=new WeakMap,Sk={construct(){return Sk}},pM=n=>{try{const e=new Proxy(n,Sk);new e}catch{return!1}return!0},yI=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,CI=(n,e)=>{const t=[];let r=n.replace(/^[\s]+/,""),i=r.match(yI);for(;i!==null;){const o=i[1].slice(1,-1),a=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());t.push(a),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(yI)}return[t.join(";"),r]},xI=n=>{if(n!==void 0&&!Array.isArray(n))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},bI=n=>{if(!pM(n))throw new TypeError("The given value for processorCtor should be a constructor.");if(n.prototype===null||typeof n.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},gM=(n,e,t,r,i,o,a,s,l,f,h,m,g)=>{let y=0;return(C,x,w={credentials:"omit"})=>{const S=h.get(C);if(S!==void 0&&S.has(x))return Promise.resolve();const A=f.get(C);if(A!==void 0){const T=A.get(x);if(T!==void 0)return T}const E=o(C),_=E.audioWorklet===void 0?i(x).then(([T,M])=>{const[P,j]=CI(T,M),X=`${P};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${j}
})})(window,'_AWGS')`;return t(X)}).then(()=>{const T=g._AWGS.pop();if(T===void 0)throw new SyntaxError;r(E.currentTime,E.sampleRate,()=>T(class{},void 0,(M,P)=>{if(M.trim()==="")throw e();const j=Lv.get(E);if(j!==void 0){if(j.has(M))throw e();bI(P),xI(P.parameterDescriptors),j.set(M,P)}else bI(P),xI(P.parameterDescriptors),Lv.set(E,new Map([[M,P]]))},E.sampleRate,void 0,void 0))}):Promise.all([i(x),Promise.resolve(n(m,m))]).then(([[T,M],P])=>{const j=y+1;y=j;const[X,L]=CI(T,M),pe=`${X};((AudioWorkletProcessor,registerProcessor)=>{${L}
})(${P?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${P?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${P?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${j}',class extends AudioWorkletProcessor{process(){return !1}})`,ve=new Blob([pe],{type:"application/javascript; charset=utf-8"}),Se=URL.createObjectURL(ve);return E.audioWorklet.addModule(Se,w).then(()=>{if(s(E))return E;const Ne=a(E);return Ne.audioWorklet.addModule(Se,w).then(()=>Ne)}).then(Ne=>{if(l===null)throw new SyntaxError;try{new l(Ne,`__sac${j}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(Se))});return A===void 0?f.set(C,new Map([[x,_]])):A.set(x,_),_.then(()=>{const T=h.get(C);T===void 0?h.set(C,new Set([x])):T.add(x)}).finally(()=>{const T=f.get(C);T!==void 0&&T.delete(x)}),_}},Ss=(n,e)=>{const t=n.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},Mp=(n,e)=>{const t=Array.from(n).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[r]=t;return n.delete(r),r},Ak=(n,e,t,r)=>{const i=Ss(n,e),o=Mp(i,a=>a[0]===t&&a[1]===r);return i.size===0&&n.delete(e),o},xf=n=>Ss(wk,n),Tu=n=>{if(Eu.has(n))throw new Error("The AudioNode is already stored.");Eu.add(n),xf(n).forEach(e=>e(!0))},kk=n=>"port"in n,bf=n=>{if(!Eu.has(n))throw new Error("The AudioNode is not stored.");Eu.delete(n),xf(n).forEach(e=>e(!1))},jv=(n,e)=>{!kk(n)&&e.every(t=>t.size===0)&&bf(n)},mM=(n,e,t,r,i,o,a,s,l,f,h,m,g)=>{const y=new WeakMap;return(C,x,w,S,A)=>{const{activeInputs:E,passiveInputs:_}=o(x),{outputs:T}=o(C),M=s(C),P=j=>{const X=l(x),L=l(C);if(j){const G=Ak(_,C,w,S);n(E,C,G,!1),!A&&!m(C)&&t(L,X,w,S),g(x)&&Tu(x)}else{const G=r(E,C,w,S);e(_,S,G,!1),!A&&!m(C)&&i(L,X,w,S);const Z=a(x);if(Z===0)h(x)&&jv(x,E);else{const ne=y.get(x);ne!==void 0&&clearTimeout(ne),y.set(x,setTimeout(()=>{h(x)&&jv(x,E)},Z*1e3))}}};return f(T,[x,w,S],j=>j[0]===x&&j[1]===w&&j[2]===S,!0)?(M.add(P),h(C)?n(E,C,[w,S,P],!0):e(_,S,[C,w,P],!0),!0):!1}},vM=n=>(e,t,[r,i,o],a)=>{const s=e.get(r);s===void 0?e.set(r,new Set([[i,t,o]])):n(s,[i,t,o],l=>l[0]===i&&l[1]===t,a)},yM=n=>(e,t)=>{const r=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(e.destination);const i=()=>{t.removeEventListener("ended",i),t.disconnect(r),r.disconnect()};t.addEventListener("ended",i)},CM=n=>(e,t)=>{n(e).add(t)},xM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},bM=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const f=i(s),h={...xM,...l},m=r(f,h),g=o(f)?e():null;super(s,!1,m,g),this._nativeAnalyserNode=m}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(s){this._nativeAnalyserNode.fftSize=s}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(s){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=s,!(s>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(s){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=s,!(this._nativeAnalyserNode.maxDecibels>s))throw this._nativeAnalyserNode.minDecibels=l,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(s){this._nativeAnalyserNode.smoothingTimeConstant=s}getByteFrequencyData(s){this._nativeAnalyserNode.getByteFrequencyData(s)}getByteTimeDomainData(s){this._nativeAnalyserNode.getByteTimeDomainData(s)}getFloatFrequencyData(s){this._nativeAnalyserNode.getFloatFrequencyData(s)}getFloatTimeDomainData(s){this._nativeAnalyserNode.getFloatTimeDomainData(s)}},Pi=(n,e)=>n.context===e,IM=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,a)=>{let s=e(o);if(!Pi(s,a)){const f={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,fftSize:s.fftSize,maxDecibels:s.maxDecibels,minDecibels:s.minDecibels,smoothingTimeConstant:s.smoothingTimeConstant};s=n(a,f)}return r.set(a,s),await t(o,a,s),s};return{render(o,a){const s=r.get(a);return s!==void 0?Promise.resolve(s):i(o,a)}}},Gv=n=>{try{n.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Js=()=>new DOMException("","IndexSizeError"),Ek=n=>{n.getChannelData=(e=>t=>{try{return e.call(n,t)}catch(r){throw r.code===12?Js():r}})(n.getChannelData)},wM={numberOfChannels:1},SM=(n,e,t,r,i,o,a,s)=>{let l=null;return class Tk{constructor(h){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:m,numberOfChannels:g,sampleRate:y}={...wM,...h};l===null&&(l=new i(1,1,44100));const C=r!==null&&e(o,o)?new r({length:m,numberOfChannels:g,sampleRate:y}):l.createBuffer(g,m,y);if(C.numberOfChannels===0)throw t();return typeof C.copyFromChannel!="function"?(a(C),Ek(C)):e(Gv,()=>Gv(C))||s(C),n.add(C),C}static[Symbol.hasInstance](h){return h!==null&&typeof h=="object"&&Object.getPrototypeOf(h)===Tk.prototype||n.has(h)}}},ro=-34028234663852886e22,Ui=-ro,Da=n=>Eu.has(n),AM={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},kM=(n,e,t,r,i,o,a,s)=>class extends n{constructor(f,h){const m=o(f),g={...AM,...h},y=i(m,g),C=a(m),x=C?e():null;super(f,!1,y,x),this._audioBufferSourceNodeRenderer=x,this._isBufferNullified=!1,this._isBufferSet=g.buffer!==null,this._nativeAudioBufferSourceNode=y,this._onended=null,this._playbackRate=t(this,C,y.playbackRate,Ui,ro)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(f){if(this._nativeAudioBufferSourceNode.buffer=f,f!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(f){this._nativeAudioBufferSourceNode.loop=f}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(f){this._nativeAudioBufferSourceNode.loopEnd=f}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(f){this._nativeAudioBufferSourceNode.loopStart=f}get onended(){return this._onended}set onended(f){const h=typeof f=="function"?s(this,f):null;this._nativeAudioBufferSourceNode.onended=h;const m=this._nativeAudioBufferSourceNode.onended;this._onended=m!==null&&m===h?f:m}get playbackRate(){return this._playbackRate}start(f=0,h=0,m){if(this._nativeAudioBufferSourceNode.start(f,h,m),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=m===void 0?[f,h]:[f,h,m]),this.context.state!=="closed"){Tu(this);const g=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",g),Da(this)&&bf(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",g)}}stop(f=0){this._nativeAudioBufferSourceNode.stop(f),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=f)}},EM=(n,e,t,r,i)=>()=>{const o=new WeakMap;let a=null,s=null;const l=async(f,h)=>{let m=t(f);const g=Pi(m,h);if(!g){const y={buffer:m.buffer,channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,loop:m.loop,loopEnd:m.loopEnd,loopStart:m.loopStart,playbackRate:m.playbackRate.value};m=e(h,y),a!==null&&m.start(...a),s!==null&&m.stop(s)}return o.set(h,m),g?await n(h,f.playbackRate,m.playbackRate):await r(h,f.playbackRate,m.playbackRate),await i(f,h,m),m};return{set start(f){a=f},set stop(f){s=f},render(f,h){const m=o.get(h);return m!==void 0?Promise.resolve(m):l(f,h)}}},TM=n=>"playbackRate"in n,_M=n=>"frequency"in n&&"gain"in n,RM=n=>"offset"in n,PM=n=>!("frequency"in n)&&"gain"in n,DM=n=>"detune"in n&&"frequency"in n&&!("gain"in n),MM=n=>"pan"in n,Gi=n=>Ss(yk,n),If=n=>Ss(xk,n),Vv=(n,e)=>{const{activeInputs:t}=Gi(n);t.forEach(i=>i.forEach(([o])=>{e.includes(n)||Vv(o,[...e,n])}));const r=TM(n)?[n.playbackRate]:kk(n)?Array.from(n.parameters.values()):_M(n)?[n.Q,n.detune,n.frequency,n.gain]:RM(n)?[n.offset]:PM(n)?[n.gain]:DM(n)?[n.detune,n.frequency]:MM(n)?[n.pan]:[];for(const i of r){const o=If(i);o!==void 0&&o.activeInputs.forEach(([a])=>Vv(a,e))}Da(n)&&bf(n)},NM=n=>{Vv(n.destination,[])},BM=n=>n===void 0||typeof n=="number"||typeof n=="string"&&(n==="balanced"||n==="interactive"||n==="playback"),OM=(n,e,t,r,i,o,a,s,l)=>class extends n{constructor(h={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let m;try{m=new l(h)}catch(C){throw C.code===12&&C.message==="sampleRate is not in range"?t():C}if(m===null)throw r();if(!BM(h.latencyHint))throw new TypeError(`The provided value '${h.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(h.sampleRate!==void 0&&m.sampleRate!==h.sampleRate)throw t();super(m,2);const{latencyHint:g}=h,{sampleRate:y}=m;if(this._baseLatency=typeof m.baseLatency=="number"?m.baseLatency:g==="balanced"?512/y:g==="interactive"||g===void 0?256/y:g==="playback"?1024/y:Math.max(2,Math.min(128,Math.round(g*y/128)))*128/y,this._nativeAudioContext=m,l.name==="webkitAudioContext"?(this._nativeGainNode=m.createGain(),this._nativeOscillatorNode=m.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(m.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,m.state==="running"){this._state="suspended";const C=()=>{this._state==="suspended"&&(this._state=null),m.removeEventListener("statechange",C)};m.addEventListener("statechange",C)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),NM(this)}))}createMediaElementSource(h){return new i(this,{mediaElement:h})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(h){return new a(this,{mediaStream:h})}createMediaStreamTrackSource(h){return new s(this,{mediaStreamTrack:h})}resume(){return this._state==="suspended"?new Promise((h,m)=>{const g=()=>{this._nativeAudioContext.removeEventListener("statechange",g),this._nativeAudioContext.state==="running"?h():this.resume().then(h,m)};this._nativeAudioContext.addEventListener("statechange",g)}):this._nativeAudioContext.resume().catch(h=>{throw h===void 0||h.code===15?e():h})}suspend(){return this._nativeAudioContext.suspend().catch(h=>{throw h===void 0?e():h})}},FM=(n,e,t,r,i,o,a,s)=>class extends n{constructor(f,h){const m=o(f),g=a(m),y=i(m,h,g),C=g?e(s):null;super(f,!1,y,C),this._isNodeOfNativeOfflineAudioContext=g,this._nativeAudioDestinationNode=y}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(f){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(f>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=f}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(f){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=f}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},LM=n=>{const e=new WeakMap,t=async(r,i)=>{const o=i.destination;return e.set(i,o),await n(r,i,o),o};return{render(r,i){const o=e.get(i);return o!==void 0?Promise.resolve(o):t(r,i)}}},UM=(n,e,t,r,i,o,a,s)=>(l,f)=>{const h=f.listener,m=()=>{const T=new Float32Array(1),M=e(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),P=a(f);let j=!1,X=[0,0,-1,0,1,0],L=[0,0,0];const G=()=>{if(j)return;j=!0;const ve=r(f,256,9,0);ve.onaudioprocess=({inputBuffer:Se})=>{const Ne=[o(Se,T,0),o(Se,T,1),o(Se,T,2),o(Se,T,3),o(Se,T,4),o(Se,T,5)];Ne.some((Ae,ke)=>Ae!==X[ke])&&(h.setOrientation(...Ne),X=Ne);const xe=[o(Se,T,6),o(Se,T,7),o(Se,T,8)];xe.some((Ae,ke)=>Ae!==L[ke])&&(h.setPosition(...xe),L=xe)},M.connect(ve)},Z=ve=>Se=>{Se!==X[ve]&&(X[ve]=Se,h.setOrientation(...X))},ne=ve=>Se=>{Se!==L[ve]&&(L[ve]=Se,h.setPosition(...L))},pe=(ve,Se,Ne)=>{const xe=t(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Se});xe.connect(M,0,ve),xe.start(),Object.defineProperty(xe.offset,"defaultValue",{get(){return Se}});const Ae=n({context:l},P,xe.offset,Ui,ro);return s(Ae,"value",ke=>()=>ke.call(Ae),ke=>H=>{try{ke.call(Ae,H)}catch(ee){if(ee.code!==9)throw ee}G(),P&&Ne(H)}),Ae.cancelAndHoldAtTime=(ke=>P?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return G(),ee})(Ae.cancelAndHoldAtTime),Ae.cancelScheduledValues=(ke=>P?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return G(),ee})(Ae.cancelScheduledValues),Ae.exponentialRampToValueAtTime=(ke=>P?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return G(),ee})(Ae.exponentialRampToValueAtTime),Ae.linearRampToValueAtTime=(ke=>P?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return G(),ee})(Ae.linearRampToValueAtTime),Ae.setTargetAtTime=(ke=>P?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return G(),ee})(Ae.setTargetAtTime),Ae.setValueAtTime=(ke=>P?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return G(),ee})(Ae.setValueAtTime),Ae.setValueCurveAtTime=(ke=>P?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return G(),ee})(Ae.setValueCurveAtTime),Ae};return{forwardX:pe(0,0,Z(0)),forwardY:pe(1,0,Z(1)),forwardZ:pe(2,-1,Z(2)),positionX:pe(6,0,ne(0)),positionY:pe(7,0,ne(1)),positionZ:pe(8,0,ne(2)),upX:pe(3,0,Z(3)),upY:pe(4,1,Z(4)),upZ:pe(5,0,Z(5))}},{forwardX:g,forwardY:y,forwardZ:C,positionX:x,positionY:w,positionZ:S,upX:A,upY:E,upZ:_}=h.forwardX===void 0?m():h;return{get forwardX(){return g},get forwardY(){return y},get forwardZ(){return C},get positionX(){return x},get positionY(){return w},get positionZ(){return S},get upX(){return A},get upY(){return E},get upZ(){return _}}},tp=n=>"context"in n,wf=n=>tp(n[0]),Tl=(n,e,t,r)=>{for(const i of n)if(t(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return n.add(e),!0},II=(n,e,[t,r],i)=>{Tl(n,[e,t,r],o=>o[0]===e&&o[1]===t,i)},wI=(n,[e,t,r],i)=>{const o=n.get(e);o===void 0?n.set(e,new Set([[t,r]])):Tl(o,[t,r],a=>a[0]===t,i)},Nu=n=>"inputs"in n,np=(n,e,t,r)=>{if(Nu(e)){const i=e.inputs[r];return n.connect(i,t,0),[i,t,0]}return n.connect(e,t,r),[e,t,r]},_k=(n,e,t)=>{for(const r of n)if(r[0]===e&&r[1]===t)return n.delete(r),r;return null},jM=(n,e,t)=>Mp(n,r=>r[0]===e&&r[1]===t),Rk=(n,e)=>{if(!xf(n).delete(e))throw new Error("Missing the expected event listener.")},Pk=(n,e,t)=>{const r=Ss(n,e),i=Mp(r,o=>o[0]===t);return r.size===0&&n.delete(e),i},rp=(n,e,t,r)=>{Nu(e)?n.disconnect(e.inputs[r],t,0):n.disconnect(e,t,r)},ur=n=>Ss(Ck,n),qd=n=>Ss(bk,n),vl=n=>Fv.has(n),Wh=n=>!Eu.has(n),SI=(n,e)=>new Promise(t=>{if(e!==null)t(!0);else{const r=n.createScriptProcessor(256,1,1),i=n.createGain(),o=n.createBuffer(1,2,44100),a=o.getChannelData(0);a[0]=1,a[1]=1;const s=n.createBufferSource();s.buffer=o,s.loop=!0,s.connect(r).connect(n.destination),s.connect(i),s.disconnect(i),r.onaudioprocess=l=>{const f=l.inputBuffer.getChannelData(0);Array.prototype.some.call(f,h=>h===1)?t(!0):t(!1),s.stop(),r.onaudioprocess=null,s.disconnect(r),r.disconnect(n.destination)},s.start()}}),Mm=(n,e)=>{const t=new Map;for(const r of n)for(const i of r){const o=t.get(i);t.set(i,o===void 0?1:o+1)}t.forEach((r,i)=>e(i,r))},ip=n=>"context"in n,GM=n=>{const e=new Map;n.connect=(t=>(r,i=0,o=0)=>{const a=ip(r)?t(r,i,o):t(r,i),s=e.get(r);return s===void 0?e.set(r,[{input:o,output:i}]):s.every(l=>l.input!==o||l.output!==i)&&s.push({input:o,output:i}),a})(n.connect.bind(n)),n.disconnect=(t=>(r,i,o)=>{if(t.apply(n),r===void 0)e.clear();else if(typeof r=="number")for(const[a,s]of e){const l=s.filter(f=>f.output!==r);l.length===0?e.delete(a):e.set(a,l)}else if(e.has(r))if(i===void 0)e.delete(r);else{const a=e.get(r);if(a!==void 0){const s=a.filter(l=>l.output!==i&&(l.input!==o||o===void 0));s.length===0?e.delete(r):e.set(r,s)}}for(const[a,s]of e)s.forEach(l=>{ip(a)?n.connect(a,l.output,l.input):n.connect(a,l.output)})})(n.disconnect)},VM=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:o}=If(e),{outputs:a}=Gi(n),s=xf(n),l=f=>{const h=ur(n),m=qd(e);if(f){const g=Pk(o,n,t);II(i,n,g,!1),!r&&!vl(n)&&h.connect(m,t)}else{const g=jM(i,n,t);wI(o,g,!1),!r&&!vl(n)&&h.disconnect(m,t)}};return Tl(a,[e,t],f=>f[0]===e&&f[1]===t,!0)?(s.add(l),Da(n)?II(i,n,[t,l],!0):wI(o,[n,t,l],!0),!0):!1},zM=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:o}=Gi(e),a=_k(i[r],n,t);return a===null?[Ak(o,n,t,r)[2],!1]:[a[2],!0]},WM=(n,e,t)=>{const{activeInputs:r,passiveInputs:i}=If(e),o=_k(r,n,t);return o===null?[Pk(i,n,t)[1],!1]:[o[2],!0]},pC=(n,e,t,r,i)=>{const[o,a]=zM(n,t,r,i);if(o!==null&&(Rk(n,o),a&&!e&&!vl(n)&&rp(ur(n),ur(t),r,i)),Da(t)){const{activeInputs:s}=Gi(t);jv(t,s)}},gC=(n,e,t,r)=>{const[i,o]=WM(n,t,r);i!==null&&(Rk(n,i),o&&!e&&!vl(n)&&ur(n).disconnect(qd(t),r))},HM=(n,e)=>{const t=Gi(n),r=[];for(const i of t.outputs)wf(i)?pC(n,e,...i):gC(n,e,...i),r.push(i[0]);return t.outputs.clear(),r},ZM=(n,e,t)=>{const r=Gi(n),i=[];for(const o of r.outputs)o[1]===t&&(wf(o)?pC(n,e,...o):gC(n,e,...o),i.push(o[0]),r.outputs.delete(o));return i},XM=(n,e,t,r,i)=>{const o=Gi(n);return Array.from(o.outputs).filter(a=>a[0]===t&&(r===void 0||a[1]===r)&&(i===void 0||a[2]===i)).map(a=>(wf(a)?pC(n,e,...a):gC(n,e,...a),o.outputs.delete(a),a[0]))},$M=(n,e,t,r,i,o,a,s,l,f,h,m,g,y,C,x)=>class extends f{constructor(S,A,E,_){super(E),this._context=S,this._nativeAudioNode=E;const T=h(S);m(T)&&t(SI,()=>SI(T,x))!==!0&&GM(E),Ck.set(this,E),wk.set(this,new Set),S.state!=="closed"&&A&&Tu(this),n(this,_,E)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(S){this._nativeAudioNode.channelCount=S}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(S){this._nativeAudioNode.channelCountMode=S}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(S){this._nativeAudioNode.channelInterpretation=S}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(S,A=0,E=0){if(A<0||A>=this._nativeAudioNode.numberOfOutputs)throw i();const _=h(this._context),T=C(_);if(g(S)||y(S))throw o();if(tp(S)){const j=ur(S);try{const L=np(this._nativeAudioNode,j,A,E),G=Wh(this);(T||G)&&this._nativeAudioNode.disconnect(...L),this.context.state!=="closed"&&!G&&Wh(S)&&Tu(S)}catch(L){throw L.code===12?o():L}if(e(this,S,A,E,T)){const L=l([this],S);Mm(L,r(T))}return S}const M=qd(S);if(M.name==="playbackRate"&&M.maxValue===1024)throw a();try{this._nativeAudioNode.connect(M,A),(T||Wh(this))&&this._nativeAudioNode.disconnect(M,A)}catch(j){throw j.code===12?o():j}if(VM(this,S,A,T)){const j=l([this],S);Mm(j,r(T))}}disconnect(S,A,E){let _;const T=h(this._context),M=C(T);if(S===void 0)_=HM(this,M);else if(typeof S=="number"){if(S<0||S>=this.numberOfOutputs)throw i();_=ZM(this,M,S)}else{if(A!==void 0&&(A<0||A>=this.numberOfOutputs)||tp(S)&&E!==void 0&&(E<0||E>=S.numberOfInputs))throw i();if(_=XM(this,M,S,A,E),_.length===0)throw o()}for(const P of _){const j=l([this],P);Mm(j,s)}}},KM=(n,e,t,r,i,o,a,s,l,f,h,m,g)=>(y,C,x,w=null,S=null)=>{const A=x.value,E=new iM(A),_=C?r(E):null,T={get defaultValue(){return A},get maxValue(){return w===null?x.maxValue:w},get minValue(){return S===null?x.minValue:S},get value(){return x.value},set value(M){x.value=M,T.setValueAtTime(M,y.context.currentTime)},cancelAndHoldAtTime(M){if(typeof x.cancelAndHoldAtTime=="function")_===null&&E.flush(y.context.currentTime),E.add(i(M)),x.cancelAndHoldAtTime(M);else{const P=Array.from(E).pop();_===null&&E.flush(y.context.currentTime),E.add(i(M));const j=Array.from(E).pop();x.cancelScheduledValues(M),P!==j&&j!==void 0&&(j.type==="exponentialRampToValue"?x.exponentialRampToValueAtTime(j.value,j.endTime):j.type==="linearRampToValue"?x.linearRampToValueAtTime(j.value,j.endTime):j.type==="setValue"?x.setValueAtTime(j.value,j.startTime):j.type==="setValueCurve"&&x.setValueCurveAtTime(j.values,j.startTime,j.duration))}return T},cancelScheduledValues(M){return _===null&&E.flush(y.context.currentTime),E.add(o(M)),x.cancelScheduledValues(M),T},exponentialRampToValueAtTime(M,P){if(M===0)throw new RangeError;if(!Number.isFinite(P)||P<0)throw new RangeError;const j=y.context.currentTime;return _===null&&E.flush(j),Array.from(E).length===0&&(E.add(f(A,j)),x.setValueAtTime(A,j)),E.add(a(M,P)),x.exponentialRampToValueAtTime(M,P),T},linearRampToValueAtTime(M,P){const j=y.context.currentTime;return _===null&&E.flush(j),Array.from(E).length===0&&(E.add(f(A,j)),x.setValueAtTime(A,j)),E.add(s(M,P)),x.linearRampToValueAtTime(M,P),T},setTargetAtTime(M,P,j){return _===null&&E.flush(y.context.currentTime),E.add(l(M,P,j)),x.setTargetAtTime(M,P,j),T},setValueAtTime(M,P){return _===null&&E.flush(y.context.currentTime),E.add(f(M,P)),x.setValueAtTime(M,P),T},setValueCurveAtTime(M,P,j){const X=M instanceof Float32Array?M:new Float32Array(M);if(m!==null&&m.name==="webkitAudioContext"){const L=P+j,G=y.context.sampleRate,Z=Math.ceil(P*G),ne=Math.floor(L*G),pe=ne-Z,ve=new Float32Array(pe);for(let Ne=0;Ne<pe;Ne+=1){const xe=(X.length-1)/j*((Z+Ne)/G-P),Ae=Math.floor(xe),ke=Math.ceil(xe);ve[Ne]=Ae===ke?X[Ae]:(1-(xe-Ae))*X[Ae]+(1-(ke-xe))*X[ke]}_===null&&E.flush(y.context.currentTime),E.add(h(ve,P,j)),x.setValueCurveAtTime(ve,P,j);const Se=ne/G;Se<L&&g(T,ve[ve.length-1],Se),g(T,X[X.length-1],L)}else _===null&&E.flush(y.context.currentTime),E.add(h(X,P,j)),x.setValueCurveAtTime(X,P,j);return T}};return t.set(T,x),e.set(T,y),n(T,_),T},qM=n=>({replay(e){for(const t of n)if(t.type==="exponentialRampToValue"){const{endTime:r,value:i}=t;e.exponentialRampToValueAtTime(i,r)}else if(t.type==="linearRampToValue"){const{endTime:r,value:i}=t;e.linearRampToValueAtTime(i,r)}else if(t.type==="setTarget"){const{startTime:r,target:i,timeConstant:o}=t;e.setTargetAtTime(i,r,o)}else if(t.type==="setValue"){const{startTime:r,value:i}=t;e.setValueAtTime(i,r)}else if(t.type==="setValueCurve"){const{duration:r,startTime:i,values:o}=t;e.setValueCurveAtTime(o,i,r)}else throw new Error("Can't apply an unknown automation.")}});class Dk{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((r,i)=>e.call(t,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const YM={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},QM=(n,e,t,r,i,o,a,s,l,f,h,m,g,y)=>class extends e{constructor(x,w,S){var A;const E=s(x),_=l(E),T=h({...YM,...S});g(T);const M=Lv.get(E),P=M==null?void 0:M.get(w),j=_||E.state!=="closed"?E:(A=a(E))!==null&&A!==void 0?A:E,X=i(j,_?null:x.baseLatency,f,w,P,T),L=_?r(w,T,P):null;super(x,!0,X,L);const G=[];X.parameters.forEach((ne,pe)=>{const ve=t(this,_,ne);G.push([pe,ve])}),this._nativeAudioWorkletNode=X,this._onprocessorerror=null,this._parameters=new Dk(G),_&&n(E,this);const{activeInputs:Z}=o(this);m(X,Z)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(x){const w=typeof x=="function"?y(this,x):null;this._nativeAudioWorkletNode.onprocessorerror=w;const S=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=S!==null&&S===w?x:S}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function op(n,e,t,r,i){if(typeof n.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),n.copyFromChannel(e[t],r,i);else{const o=n.getChannelData(r);if(e[t].byteLength===0)e[t]=o.slice(i,i+128);else{const a=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(a)}}}const Mk=(n,e,t,r,i)=>{typeof n.copyToChannel=="function"?e[t].byteLength!==0&&n.copyToChannel(e[t],r,i):e[t].byteLength!==0&&n.getChannelData(r).set(e[t],i)},sp=(n,e)=>{const t=[];for(let r=0;r<n;r+=1){const i=[],o=typeof e=="number"?e:e[r];for(let a=0;a<o;a+=1)i.push(new Float32Array(128));t.push(i)}return t},JM=(n,e)=>{const t=Ss(Uv,n),r=ur(e);return Ss(t,r)},e4=async(n,e,t,r,i,o,a)=>{const s=e===null?Math.ceil(n.context.length/128)*128:e.length,l=r.channelCount*r.numberOfInputs,f=i.reduce((w,S)=>w+S,0),h=f===0?null:t.createBuffer(f,s,t.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const m=Gi(n),g=await JM(t,n),y=sp(r.numberOfInputs,r.channelCount),C=sp(r.numberOfOutputs,i),x=Array.from(n.parameters.keys()).reduce((w,S)=>({...w,[S]:new Float32Array(128)}),{});for(let w=0;w<s;w+=128){if(r.numberOfInputs>0&&e!==null)for(let S=0;S<r.numberOfInputs;S+=1)for(let A=0;A<r.channelCount;A+=1)op(e,y[S],A,A,w);o.parameterDescriptors!==void 0&&e!==null&&o.parameterDescriptors.forEach(({name:S},A)=>{op(e,x,S,l+A,w)});for(let S=0;S<r.numberOfInputs;S+=1)for(let A=0;A<i[S];A+=1)C[S][A].byteLength===0&&(C[S][A]=new Float32Array(128));try{const S=y.map((E,_)=>m.activeInputs[_].size===0?[]:E),A=a(w/t.sampleRate,t.sampleRate,()=>g.process(S,C,x));if(h!==null)for(let E=0,_=0;E<r.numberOfOutputs;E+=1){for(let T=0;T<i[E];T+=1)Mk(h,C[E],T,_+T,w);_+=i[E]}if(!A)break}catch(S){n.dispatchEvent(new ErrorEvent("processorerror",{colno:S.colno,filename:S.filename,lineno:S.lineno,message:S.message}));break}}return h},t4=(n,e,t,r,i,o,a,s,l,f,h,m,g,y,C,x)=>(w,S,A)=>{const E=new WeakMap;let _=null;const T=async(M,P)=>{let j=h(M),X=null;const L=Pi(j,P),G=Array.isArray(S.outputChannelCount)?S.outputChannelCount:Array.from(S.outputChannelCount);if(m===null){const Z=G.reduce((Se,Ne)=>Se+Ne,0),ne=i(P,{channelCount:Math.max(1,Z),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,Z)}),pe=[];for(let Se=0;Se<M.numberOfOutputs;Se+=1)pe.push(r(P,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:G[Se]}));const ve=a(P,{channelCount:S.channelCount,channelCountMode:S.channelCountMode,channelInterpretation:S.channelInterpretation,gain:1});ve.connect=e.bind(null,pe),ve.disconnect=l.bind(null,pe),X=[ne,pe,ve]}else L||(j=new m(P,w));if(E.set(P,X===null?j:X[2]),X!==null){if(_===null){if(A===void 0)throw new Error("Missing the processor constructor.");if(g===null)throw new Error("Missing the native OfflineAudioContext constructor.");const Ne=M.channelCount*M.numberOfInputs,xe=A.parameterDescriptors===void 0?0:A.parameterDescriptors.length,Ae=Ne+xe;_=e4(M,Ae===0?null:await(async()=>{const H=new g(Ae,Math.ceil(M.context.length/128)*128,P.sampleRate),ee=[],ae=[];for(let _e=0;_e<S.numberOfInputs;_e+=1)ee.push(a(H,{channelCount:S.channelCount,channelCountMode:S.channelCountMode,channelInterpretation:S.channelInterpretation,gain:1})),ae.push(i(H,{channelCount:S.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:S.channelCount}));const ye=await Promise.all(Array.from(M.parameters.values()).map(async _e=>{const Je=o(H,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:_e.value});return await y(H,_e,Je.offset),Je})),Ee=r(H,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,Ne+xe)});for(let _e=0;_e<S.numberOfInputs;_e+=1){ee[_e].connect(ae[_e]);for(let Je=0;Je<S.channelCount;Je+=1)ae[_e].connect(Ee,Je,_e*S.channelCount+Je)}for(const[_e,Je]of ye.entries())Je.connect(Ee,0,Ne+_e),Je.start(0);return Ee.connect(H.destination),await Promise.all(ee.map(_e=>C(M,H,_e))),x(H)})(),P,S,G,A,f)}const Z=await _,ne=t(P,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[pe,ve,Se]=X;Z!==null&&(ne.buffer=Z,ne.start(0)),ne.connect(pe);for(let Ne=0,xe=0;Ne<M.numberOfOutputs;Ne+=1){const Ae=ve[Ne];for(let ke=0;ke<G[Ne];ke+=1)pe.connect(Ae,xe+ke,ke);xe+=G[Ne]}return Se}if(L)for(const[Z,ne]of M.parameters.entries())await n(P,ne,j.parameters.get(Z));else for(const[Z,ne]of M.parameters.entries())await y(P,ne,j.parameters.get(Z));return await C(M,P,j),j};return{render(M,P){s(P,M);const j=E.get(P);return j!==void 0?Promise.resolve(j):T(M,P)}}},n4=(n,e,t,r,i,o,a,s,l,f,h,m,g,y,C,x,w,S,A,E)=>class extends C{constructor(T,M){super(T,M),this._nativeContext=T,this._audioWorklet=n===void 0?void 0:{addModule:(P,j)=>n(this,P,j)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(T,M,P){return new t({length:M,numberOfChannels:T,sampleRate:P})}createBufferSource(){return new r(this)}createChannelMerger(T=6){return new o(this,{numberOfInputs:T})}createChannelSplitter(T=6){return new a(this,{numberOfOutputs:T})}createConstantSource(){return new s(this)}createConvolver(){return new l(this)}createDelay(T=1){return new h(this,{maxDelayTime:T})}createDynamicsCompressor(){return new m(this)}createGain(){return new g(this)}createIIRFilter(T,M){return new y(this,{feedback:M,feedforward:T})}createOscillator(){return new x(this)}createPanner(){return new w(this)}createPeriodicWave(T,M,P={disableNormalization:!1}){return new S(this,{...P,imag:M,real:T})}createStereoPanner(){return new A(this)}createWaveShaper(){return new E(this)}decodeAudioData(T,M,P){return f(this._nativeContext,T).then(j=>(typeof M=="function"&&M(j),j),j=>{throw typeof P=="function"&&P(j),j})}},r4={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},i4=(n,e,t,r,i,o,a,s)=>class extends n{constructor(f,h){const m=o(f),g={...r4,...h},y=i(m,g),C=a(m),x=C?t():null;super(f,!1,y,x),this._Q=e(this,C,y.Q,Ui,ro),this._detune=e(this,C,y.detune,1200*Math.log2(Ui),-1200*Math.log2(Ui)),this._frequency=e(this,C,y.frequency,f.sampleRate/2,0),this._gain=e(this,C,y.gain,40*Math.log10(Ui),ro),this._nativeBiquadFilterNode=y,s(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(f){this._nativeBiquadFilterNode.type=f}getFrequencyResponse(f,h,m){try{this._nativeBiquadFilterNode.getFrequencyResponse(f,h,m)}catch(g){throw g.code===11?r():g}if(f.length!==h.length||h.length!==m.length)throw r()}},o4=(n,e,t,r,i)=>()=>{const o=new WeakMap,a=async(s,l)=>{let f=t(s);const h=Pi(f,l);if(!h){const m={Q:f.Q.value,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,gain:f.gain.value,type:f.type};f=e(l,m)}return o.set(l,f),h?(await n(l,s.Q,f.Q),await n(l,s.detune,f.detune),await n(l,s.frequency,f.frequency),await n(l,s.gain,f.gain)):(await r(l,s.Q,f.Q),await r(l,s.detune,f.detune),await r(l,s.frequency,f.frequency),await r(l,s.gain,f.gain)),await i(s,l,f),f};return{render(s,l){const f=o.get(l);return f!==void 0?Promise.resolve(f):a(s,l)}}},s4=(n,e)=>(t,r)=>{const i=e.get(t);if(i!==void 0)return i;const o=n.get(t);if(o!==void 0)return o;try{const a=r();return a instanceof Promise?(n.set(t,a),a.catch(()=>!1).then(s=>(n.delete(t),e.set(t,s),s))):(e.set(t,a),a)}catch{return e.set(t,!1),!1}},a4={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},c4=(n,e,t,r,i)=>class extends n{constructor(a,s){const l=r(a),f={...a4,...s},h=t(l,f),m=i(l)?e():null;super(a,!1,h,m)}},l4=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,a)=>{let s=e(o);if(!Pi(s,a)){const f={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfInputs:s.numberOfInputs};s=n(a,f)}return r.set(a,s),await t(o,a,s),s};return{render(o,a){const s=r.get(a);return s!==void 0?Promise.resolve(s):i(o,a)}}},u4={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},d4=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const f=r(s),h=o({...u4,...l}),m=t(f,h),g=i(f)?e():null;super(s,!1,m,g)}},f4=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,a)=>{let s=e(o);if(!Pi(s,a)){const f={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfOutputs:s.numberOfOutputs};s=n(a,f)}return r.set(a,s),await t(o,a,s),s};return{render(o,a){const s=r.get(a);return s!==void 0?Promise.resolve(s):i(o,a)}}},h4=n=>(e,t,r)=>n(t,e,r),p4=n=>(e,t,r=0,i=0)=>{const o=e[r];if(o===void 0)throw n();return ip(t)?o.connect(t,0,i):o.connect(t,0)},g4=n=>(e,t)=>{const r=n(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}},m4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},v4=(n,e,t,r,i,o,a)=>class extends n{constructor(l,f){const h=i(l),m={...m4,...f},g=r(h,m),y=o(h),C=y?t():null;super(l,!1,g,C),this._constantSourceNodeRenderer=C,this._nativeConstantSourceNode=g,this._offset=e(this,y,g.offset,Ui,ro),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const f=typeof l=="function"?a(this,l):null;this._nativeConstantSourceNode.onended=f;const h=this._nativeConstantSourceNode.onended;this._onended=h!==null&&h===f?l:h}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Tu(this);const f=()=>{this._nativeConstantSourceNode.removeEventListener("ended",f),Da(this)&&bf(this)};this._nativeConstantSourceNode.addEventListener("ended",f)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},y4=(n,e,t,r,i)=>()=>{const o=new WeakMap;let a=null,s=null;const l=async(f,h)=>{let m=t(f);const g=Pi(m,h);if(!g){const y={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,offset:m.offset.value};m=e(h,y),a!==null&&m.start(a),s!==null&&m.stop(s)}return o.set(h,m),g?await n(h,f.offset,m.offset):await r(h,f.offset,m.offset),await i(f,h,m),m};return{set start(f){a=f},set stop(f){s=f},render(f,h){const m=o.get(h);return m!==void 0?Promise.resolve(m):l(f,h)}}},C4=n=>e=>(n[0]=e,n[0]),x4={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},b4=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const f=r(s),h={...x4,...l},m=t(f,h),y=i(f)?e():null;super(s,!1,m,y),this._isBufferNullified=!1,this._nativeConvolverNode=m,h.buffer!==null&&o(this,h.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(s){if(this._nativeConvolverNode.buffer=s,s===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(s){this._nativeConvolverNode.normalize=s}},I4=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,a)=>{let s=e(o);if(!Pi(s,a)){const f={buffer:s.buffer,channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,disableNormalization:!s.normalize};s=n(a,f)}return r.set(a,s),Nu(s)?await t(o,a,s.inputs[0]):await t(o,a,s),s};return{render(o,a){const s=r.get(a);return s!==void 0?Promise.resolve(s):i(o,a)}}},w4=()=>new DOMException("","DataCloneError"),AI=n=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(r=>{const i=()=>{t.onmessage=null,e.close(),t.close(),r()};t.onmessage=()=>i();try{e.postMessage(n,[n])}catch{}finally{i()}})},S4=(n,e,t,r,i,o,a,s,l,f,h)=>(m,g)=>{const y=a(m)?m:o(m);if(i.has(g)){const C=t();return Promise.reject(C)}try{i.add(g)}catch{}return e(l,()=>l(y))?y.decodeAudioData(g).then(C=>(AI(g).catch(()=>{}),e(s,()=>s(C))||h(C),n.add(C),C)):new Promise((C,x)=>{const w=async()=>{try{await AI(g)}catch{}},S=A=>{x(A),w()};try{y.decodeAudioData(g,A=>{typeof A.copyFromChannel!="function"&&(f(A),Ek(A)),n.add(A),w().then(()=>C(A))},A=>{S(A===null?r():A)})}catch(A){S(A)}})},A4=(n,e,t,r,i,o,a,s)=>(l,f)=>{const h=e.get(l);if(h===void 0)throw new Error("Missing the expected cycle count.");const m=o(l.context),g=s(m);if(h===f){if(e.delete(l),!g&&a(l)){const y=r(l),{outputs:C}=t(l);for(const x of C)if(wf(x)){const w=r(x[0]);n(y,w,x[1],x[2])}else{const w=i(x[0]);y.connect(w,x[1])}}}else e.set(l,h-f)},k4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},E4=(n,e,t,r,i,o,a)=>class extends n{constructor(l,f){const h=i(l),m={...k4,...f},g=r(h,m),y=o(h),C=y?t(m.maxDelayTime):null;super(l,!1,g,C),this._delayTime=e(this,y,g.delayTime),a(this,m.maxDelayTime)}get delayTime(){return this._delayTime}},T4=(n,e,t,r,i)=>o=>{const a=new WeakMap,s=async(l,f)=>{let h=t(l);const m=Pi(h,f);if(!m){const g={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:o};h=e(f,g)}return a.set(f,h),m?await n(f,l.delayTime,h.delayTime):await r(f,l.delayTime,h.delayTime),await i(l,f,h),h};return{render(l,f){const h=a.get(f);return h!==void 0?Promise.resolve(h):s(l,f)}}},_4=n=>(e,t,r,i)=>n(e[i],o=>o[0]===t&&o[1]===r),R4=n=>(e,t)=>{n(e).delete(t)},P4=n=>"delayTime"in n,D4=(n,e,t)=>function r(i,o){const a=tp(o)?o:t(n,o);if(P4(a))return[];if(i[0]===a)return[i];if(i.includes(a))return[];const{outputs:s}=e(a);return Array.from(s).map(l=>r([...i,a],l[0])).reduce((l,f)=>l.concat(f),[])},Th=(n,e,t)=>{const r=e[t];if(r===void 0)throw n();return r},M4=n=>(e,t=void 0,r=void 0,i=0)=>t===void 0?e.forEach(o=>o.disconnect()):typeof t=="number"?Th(n,e,t).disconnect():ip(t)?r===void 0?e.forEach(o=>o.disconnect(t)):i===void 0?Th(n,e,r).disconnect(t,0):Th(n,e,r).disconnect(t,0,i):r===void 0?e.forEach(o=>o.disconnect(t)):Th(n,e,r).disconnect(t,0),N4={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},B4=(n,e,t,r,i,o,a,s)=>class extends n{constructor(f,h){const m=o(f),g={...N4,...h},y=r(m,g),C=a(m),x=C?t():null;super(f,!1,y,x),this._attack=e(this,C,y.attack),this._knee=e(this,C,y.knee),this._nativeDynamicsCompressorNode=y,this._ratio=e(this,C,y.ratio),this._release=e(this,C,y.release),this._threshold=e(this,C,y.threshold),s(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(f){const h=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=f,f>2)throw this._nativeDynamicsCompressorNode.channelCount=h,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(f){const h=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=f,f==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=h,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},O4=(n,e,t,r,i)=>()=>{const o=new WeakMap,a=async(s,l)=>{let f=t(s);const h=Pi(f,l);if(!h){const m={attack:f.attack.value,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,knee:f.knee.value,ratio:f.ratio.value,release:f.release.value,threshold:f.threshold.value};f=e(l,m)}return o.set(l,f),h?(await n(l,s.attack,f.attack),await n(l,s.knee,f.knee),await n(l,s.ratio,f.ratio),await n(l,s.release,f.release),await n(l,s.threshold,f.threshold)):(await r(l,s.attack,f.attack),await r(l,s.knee,f.knee),await r(l,s.ratio,f.ratio),await r(l,s.release,f.release),await r(l,s.threshold,f.threshold)),await i(s,l,f),f};return{render(s,l){const f=o.get(l);return f!==void 0?Promise.resolve(f):a(s,l)}}},F4=()=>new DOMException("","EncodingError"),L4=n=>e=>new Promise((t,r)=>{if(n===null){r(new SyntaxError);return}const i=n.document.head;if(i===null)r(new SyntaxError);else{const o=n.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),s=URL.createObjectURL(a),l=n.onerror,f=()=>{n.onerror=l,URL.revokeObjectURL(s)};n.onerror=(h,m,g,y,C)=>{if(m===s||m===n.location.href&&g===1&&y===1)return f(),r(C),!1;if(l!==null)return l(h,m,g,y,C)},o.onerror=()=>{f(),r(new SyntaxError)},o.onload=()=>{f(),t()},o.src=s,o.type="module",i.appendChild(o)}}),U4=n=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,i){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=n(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(t,o,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,i){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,o===void 0?null:o,i)}},j4=n=>(e,t,r)=>{Object.defineProperties(n,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{n!==null&&(delete n.currentFrame,delete n.currentTime)}},G4=n=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw n()},V4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},z4=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const f=i(s),h={...V4,...l},m=r(f,h),g=o(f),y=g?t():null;super(s,!1,m,y),this._gain=e(this,g,m.gain,Ui,ro)}get gain(){return this._gain}},W4=(n,e,t,r,i)=>()=>{const o=new WeakMap,a=async(s,l)=>{let f=t(s);const h=Pi(f,l);if(!h){const m={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,gain:f.gain.value};f=e(l,m)}return o.set(l,f),h?await n(l,s.gain,f.gain):await r(l,s.gain,f.gain),await i(s,l,f),f};return{render(s,l){const f=o.get(l);return f!==void 0?Promise.resolve(f):a(s,l)}}},H4=(n,e)=>t=>e(n,t),Z4=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},X4=n=>e=>{var t;return(t=n.get(e))!==null&&t!==void 0?t:0},$4=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},K4=n=>e=>n.get(e),mi=()=>new DOMException("","InvalidStateError"),q4=n=>e=>{const t=n.get(e);if(t===void 0)throw mi();return t},Y4=(n,e)=>t=>{let r=n.get(t);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),n.set(t,r),r},Q4=n=>e=>{const t=n.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},Np=()=>new DOMException("","InvalidAccessError"),J4=n=>{n.getFrequencyResponse=(e=>(t,r,i)=>{if(t.length!==r.length||r.length!==i.length)throw Np();return e.call(n,t,r,i)})(n.getFrequencyResponse)},e5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},t5=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const f=r(s),h=i(f),m={...e5,...l},g=e(f,h?null:s.baseLatency,m),y=h?t(m.feedback,m.feedforward):null;super(s,!1,g,y),J4(g),this._nativeIIRFilterNode=g,o(this,1)}getFrequencyResponse(s,l,f){return this._nativeIIRFilterNode.getFrequencyResponse(s,l,f)}},Nk=(n,e,t,r,i,o,a,s,l,f,h)=>{const m=f.length;let g=s;for(let y=0;y<m;y+=1){let C=t[0]*f[y];for(let x=1;x<i;x+=1){const w=g-x&l-1;C+=t[x]*o[w],C-=n[x]*a[w]}for(let x=i;x<r;x+=1)C+=t[x]*o[g-x&l-1];for(let x=i;x<e;x+=1)C-=n[x]*a[g-x&l-1];o[g]=f[y],a[g]=C,g=g+1&l-1,h[y]=C}return g},n5=(n,e,t,r)=>{const i=t instanceof Float64Array?t:new Float64Array(t),o=r instanceof Float64Array?r:new Float64Array(r),a=i.length,s=o.length,l=Math.min(a,s);if(i[0]!==1){for(let C=0;C<a;C+=1)o[C]/=i[0];for(let C=1;C<s;C+=1)i[C]/=i[0]}const f=32,h=new Float32Array(f),m=new Float32Array(f),g=e.createBuffer(n.numberOfChannels,n.length,n.sampleRate),y=n.numberOfChannels;for(let C=0;C<y;C+=1){const x=n.getChannelData(C),w=g.getChannelData(C);h.fill(0),m.fill(0),Nk(i,a,o,s,l,h,m,0,f,x,w)}return g},r5=(n,e,t,r,i)=>(o,a)=>{const s=new WeakMap;let l=null;const f=async(h,m)=>{let g=null,y=e(h);const C=Pi(y,m);if(m.createIIRFilter===void 0?g=n(m,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):C||(y=m.createIIRFilter(a,o)),s.set(m,g===null?y:g),g!==null){if(l===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const w=new t(h.context.destination.channelCount,h.context.length,m.sampleRate);l=(async()=>{await r(h,w,w.destination);const S=await i(w);return n5(S,m,o,a)})()}const x=await l;return g.buffer=x,g.start(0),g}return await r(h,m,y),y};return{render(h,m){const g=s.get(m);return g!==void 0?Promise.resolve(g):f(h,m)}}},i5=(n,e,t,r,i,o)=>a=>(s,l)=>{const f=n.get(s);if(f===void 0){if(!a&&o(s)){const h=r(s),{outputs:m}=t(s);for(const g of m)if(wf(g)){const y=r(g[0]);e(h,y,g[1],g[2])}else{const y=i(g[0]);h.disconnect(y,g[1])}}n.set(s,l)}else n.set(s,f+l)},o5=n=>e=>n!==null&&e instanceof n,s5=n=>e=>n!==null&&typeof n.AudioNode=="function"&&e instanceof n.AudioNode,a5=n=>e=>n!==null&&typeof n.AudioParam=="function"&&e instanceof n.AudioParam,c5=(n,e)=>t=>n(t)||e(t),l5=n=>e=>n!==null&&e instanceof n,u5=n=>n!==null&&n.isSecureContext,d5=(n,e,t,r)=>class extends n{constructor(o,a){const s=t(o),l=e(s,a);if(r(s))throw TypeError();super(o,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},f5={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},h5=(n,e,t,r)=>class extends n{constructor(o,a){const s=t(o);if(r(s))throw new TypeError;const l={...f5,...a},f=e(s,l);super(o,!1,f,null),this._nativeMediaStreamAudioDestinationNode=f}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},p5=(n,e,t,r)=>class extends n{constructor(o,a){const s=t(o),l=e(s,a);if(r(s))throw new TypeError;super(o,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},g5=(n,e,t)=>class extends n{constructor(i,o){const a=t(i),s=e(a,o);super(i,!0,s,null)}},m5=(n,e,t,r,i,o)=>class extends t{constructor(s,l){super(s),this._nativeContext=s,Ik.set(this,s),r(s)&&i.set(s,new Set),this._destination=new n(this,l),this._listener=e(this,s),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(s){const l=typeof s=="function"?o(this,s):null;this._nativeContext.onstatechange=l;const f=this._nativeContext.onstatechange;this._onstatechange=f!==null&&f===l?s:f}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},zv=n=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=n.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},v5=(n,e)=>(t,r,i)=>{const o=new Set;return t.connect=(a=>(s,l=0,f=0)=>{const h=o.size===0;if(e(s))return a.call(t,s,l,f),n(o,[s,l,f],m=>m[0]===s&&m[1]===l&&m[2]===f,!0),h&&r(),s;a.call(t,s,l),n(o,[s,l],m=>m[0]===s&&m[1]===l,!0),h&&r()})(t.connect),t.disconnect=(a=>(s,l,f)=>{const h=o.size>0;if(s===void 0)a.apply(t),o.clear();else if(typeof s=="number"){a.call(t,s);for(const g of o)g[1]===s&&o.delete(g)}else{e(s)?a.call(t,s,l,f):a.call(t,s,l);for(const g of o)g[0]===s&&(l===void 0||g[1]===l)&&(f===void 0||g[2]===f)&&o.delete(g)}const m=o.size===0;h&&m&&i()})(t.disconnect),t},pr=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t]&&(n[t]=r)},qr=(n,e)=>{pr(n,e,"channelCount"),pr(n,e,"channelCountMode"),pr(n,e,"channelInterpretation")},kI=n=>typeof n.getFloatTimeDomainData=="function",y5=n=>{n.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);n.getByteTimeDomainData(t);const r=Math.max(t.length,n.fftSize);for(let i=0;i<r;i+=1)e[i]=(t[i]-128)*.0078125;return e}},C5=(n,e)=>(t,r)=>{const i=t.createAnalyser();if(qr(i,r),!(r.maxDecibels>r.minDecibels))throw e();return pr(i,r,"fftSize"),pr(i,r,"maxDecibels"),pr(i,r,"minDecibels"),pr(i,r,"smoothingTimeConstant"),n(kI,()=>kI(i))||y5(i),i},x5=n=>n===null?null:n.hasOwnProperty("AudioBuffer")?n.AudioBuffer:null,Tr=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t].value&&(n[t].value=r)},b5=n=>{n.start=(e=>{let t=!1;return(r=0,i=0,o)=>{if(t)throw mi();e.call(n,r,i,o),t=!0}})(n.start)},mC=n=>{n.start=(e=>(t=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(n,t,r,i)})(n.start)},vC=n=>{n.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(n,t)})(n.stop)},I5=(n,e,t,r,i,o,a,s,l,f,h)=>(m,g)=>{const y=m.createBufferSource();return qr(y,g),Tr(y,g,"playbackRate"),pr(y,g,"buffer"),pr(y,g,"loop"),pr(y,g,"loopEnd"),pr(y,g,"loopStart"),e(t,()=>t(m))||b5(y),e(r,()=>r(m))||l(y),e(i,()=>i(m))||f(y,m),e(o,()=>o(m))||mC(y),e(a,()=>a(m))||h(y,m),e(s,()=>s(m))||vC(y),n(m,y),y},w5=n=>n===null?null:n.hasOwnProperty("AudioContext")?n.AudioContext:n.hasOwnProperty("webkitAudioContext")?n.webkitAudioContext:null,S5=(n,e)=>(t,r,i)=>{const o=t.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}i&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const a=n(t,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(a,"channelCount",s=>()=>s.call(a),s=>l=>{s.call(a,l);try{o.channelCount=l}catch(f){if(l>o.maxChannelCount)throw f}}),e(a,"channelCountMode",s=>()=>s.call(a),s=>l=>{s.call(a,l),o.channelCountMode=l}),e(a,"channelInterpretation",s=>()=>s.call(a),s=>l=>{s.call(a,l),o.channelInterpretation=l}),Object.defineProperty(a,"maxChannelCount",{get:()=>o.maxChannelCount}),a.connect(o),a},A5=n=>n===null?null:n.hasOwnProperty("AudioWorkletNode")?n.AudioWorkletNode:null,k5=n=>{const{port1:e}=new MessageChannel;try{e.postMessage(n)}finally{e.close()}},E5=(n,e,t,r,i)=>(o,a,s,l,f,h)=>{if(s!==null)try{const m=new s(o,l,h),g=new Map;let y=null;if(Object.defineProperties(m,{channelCount:{get:()=>h.channelCount,set:()=>{throw n()}},channelCountMode:{get:()=>"explicit",set:()=>{throw n()}},onprocessorerror:{get:()=>y,set:C=>{typeof y=="function"&&m.removeEventListener("processorerror",y),y=typeof C=="function"?C:null,typeof y=="function"&&m.addEventListener("processorerror",y)}}}),m.addEventListener=(C=>(...x)=>{if(x[0]==="processorerror"){const w=typeof x[1]=="function"?x[1]:typeof x[1]=="object"&&x[1]!==null&&typeof x[1].handleEvent=="function"?x[1].handleEvent:null;if(w!==null){const S=g.get(x[1]);S!==void 0?x[1]=S:(x[1]=A=>{A.type==="error"?(Object.defineProperties(A,{type:{value:"processorerror"}}),w(A)):w(new ErrorEvent(x[0],{...A}))},g.set(w,x[1]))}}return C.call(m,"error",x[1],x[2]),C.call(m,...x)})(m.addEventListener),m.removeEventListener=(C=>(...x)=>{if(x[0]==="processorerror"){const w=g.get(x[1]);w!==void 0&&(g.delete(x[1]),x[1]=w)}return C.call(m,"error",x[1],x[2]),C.call(m,x[0],x[1],x[2])})(m.removeEventListener),h.numberOfOutputs!==0){const C=t(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return m.connect(C).connect(o.destination),i(m,()=>C.disconnect(),()=>C.connect(o.destination))}return m}catch(m){throw m.code===11?r():m}if(f===void 0)throw r();return k5(h),e(o,a,f,h)},Bk=(n,e)=>n===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(n*e))))),T5=n=>new Promise((e,t)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:o})=>{r.close(),i.close(),e(o)},r.onmessageerror=({data:o})=>{r.close(),i.close(),t(o)},i.postMessage(n)}),_5=async(n,e)=>{const t=await T5(e);return new n(t)},R5=(n,e,t,r)=>{let i=Uv.get(n);i===void 0&&(i=new WeakMap,Uv.set(n,i));const o=_5(t,r);return i.set(e,o),o},P5=(n,e,t,r,i,o,a,s,l,f,h,m,g)=>(y,C,x,w)=>{if(w.numberOfInputs===0&&w.numberOfOutputs===0)throw l();const S=Array.isArray(w.outputChannelCount)?w.outputChannelCount:Array.from(w.outputChannelCount);if(S.some(at=>at<1))throw l();if(S.length!==w.numberOfOutputs)throw e();if(w.channelCountMode!=="explicit")throw l();const A=w.channelCount*w.numberOfInputs,E=S.reduce((at,lt)=>at+lt,0),_=x.parameterDescriptors===void 0?0:x.parameterDescriptors.length;if(A+_>6||E>6)throw l();const T=new MessageChannel,M=[],P=[];for(let at=0;at<w.numberOfInputs;at+=1)M.push(a(y,{channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation,gain:1})),P.push(i(y,{channelCount:w.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:w.channelCount}));const j=[];if(x.parameterDescriptors!==void 0)for(const{defaultValue:at,maxValue:lt,minValue:Vt,name:Gt}of x.parameterDescriptors){const Pt=o(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:w.parameterData[Gt]!==void 0?w.parameterData[Gt]:at===void 0?0:at});Object.defineProperties(Pt.offset,{defaultValue:{get:()=>at===void 0?0:at},maxValue:{get:()=>lt===void 0?Ui:lt},minValue:{get:()=>Vt===void 0?ro:Vt}}),j.push(Pt)}const X=r(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,A+_)}),L=Bk(C,y.sampleRate),G=s(y,L,A+_,Math.max(1,E)),Z=i(y,{channelCount:Math.max(1,E),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,E)}),ne=[];for(let at=0;at<w.numberOfOutputs;at+=1)ne.push(r(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:S[at]}));for(let at=0;at<w.numberOfInputs;at+=1){M[at].connect(P[at]);for(let lt=0;lt<w.channelCount;lt+=1)P[at].connect(X,lt,at*w.channelCount+lt)}const pe=new Dk(x.parameterDescriptors===void 0?[]:x.parameterDescriptors.map(({name:at},lt)=>{const Vt=j[lt];return Vt.connect(X,0,A+lt),Vt.start(0),[at,Vt.offset]}));X.connect(G);let ve=w.channelInterpretation,Se=null;const Ne=w.numberOfOutputs===0?[G]:ne,xe={get bufferSize(){return L},get channelCount(){return w.channelCount},set channelCount(at){throw t()},get channelCountMode(){return w.channelCountMode},set channelCountMode(at){throw t()},get channelInterpretation(){return ve},set channelInterpretation(at){for(const lt of M)lt.channelInterpretation=at;ve=at},get context(){return G.context},get inputs(){return M},get numberOfInputs(){return w.numberOfInputs},get numberOfOutputs(){return w.numberOfOutputs},get onprocessorerror(){return Se},set onprocessorerror(at){typeof Se=="function"&&xe.removeEventListener("processorerror",Se),Se=typeof at=="function"?at:null,typeof Se=="function"&&xe.addEventListener("processorerror",Se)},get parameters(){return pe},get port(){return T.port2},addEventListener(...at){return G.addEventListener(at[0],at[1],at[2])},connect:n.bind(null,Ne),disconnect:f.bind(null,Ne),dispatchEvent(...at){return G.dispatchEvent(at[0])},removeEventListener(...at){return G.removeEventListener(at[0],at[1],at[2])}},Ae=new Map;T.port1.addEventListener=(at=>(...lt)=>{if(lt[0]==="message"){const Vt=typeof lt[1]=="function"?lt[1]:typeof lt[1]=="object"&&lt[1]!==null&&typeof lt[1].handleEvent=="function"?lt[1].handleEvent:null;if(Vt!==null){const Gt=Ae.get(lt[1]);Gt!==void 0?lt[1]=Gt:(lt[1]=Pt=>{h(y.currentTime,y.sampleRate,()=>Vt(Pt))},Ae.set(Vt,lt[1]))}}return at.call(T.port1,lt[0],lt[1],lt[2])})(T.port1.addEventListener),T.port1.removeEventListener=(at=>(...lt)=>{if(lt[0]==="message"){const Vt=Ae.get(lt[1]);Vt!==void 0&&(Ae.delete(lt[1]),lt[1]=Vt)}return at.call(T.port1,lt[0],lt[1],lt[2])})(T.port1.removeEventListener);let ke=null;Object.defineProperty(T.port1,"onmessage",{get:()=>ke,set:at=>{typeof ke=="function"&&T.port1.removeEventListener("message",ke),ke=typeof at=="function"?at:null,typeof ke=="function"&&(T.port1.addEventListener("message",ke),T.port1.start())}}),x.prototype.port=T.port1;let H=null;R5(y,xe,x,w).then(at=>H=at);const ae=sp(w.numberOfInputs,w.channelCount),ye=sp(w.numberOfOutputs,S),Ee=x.parameterDescriptors===void 0?[]:x.parameterDescriptors.reduce((at,{name:lt})=>({...at,[lt]:new Float32Array(128)}),{});let _e=!0;const Je=()=>{w.numberOfOutputs>0&&G.disconnect(Z);for(let at=0,lt=0;at<w.numberOfOutputs;at+=1){const Vt=ne[at];for(let Gt=0;Gt<S[at];Gt+=1)Z.disconnect(Vt,lt+Gt,Gt);lt+=S[at]}},me=new Map;G.onaudioprocess=({inputBuffer:at,outputBuffer:lt})=>{if(H!==null){const Vt=m(xe);for(let Gt=0;Gt<L;Gt+=128){for(let Pt=0;Pt<w.numberOfInputs;Pt+=1)for(let Ht=0;Ht<w.channelCount;Ht+=1)op(at,ae[Pt],Ht,Ht,Gt);x.parameterDescriptors!==void 0&&x.parameterDescriptors.forEach(({name:Pt},Ht)=>{op(at,Ee,Pt,A+Ht,Gt)});for(let Pt=0;Pt<w.numberOfInputs;Pt+=1)for(let Ht=0;Ht<S[Pt];Ht+=1)ye[Pt][Ht].byteLength===0&&(ye[Pt][Ht]=new Float32Array(128));try{const Pt=ae.map((on,ct)=>{if(Vt[ct].size>0)return me.set(ct,L/128),on;const nn=me.get(ct);return nn===void 0?[]:(on.every(pn=>pn.every(Un=>Un===0))&&(nn===1?me.delete(ct):me.set(ct,nn-1)),on)});_e=h(y.currentTime+Gt/y.sampleRate,y.sampleRate,()=>H.process(Pt,ye,Ee));for(let on=0,ct=0;on<w.numberOfOutputs;on+=1){for(let ce=0;ce<S[on];ce+=1)Mk(lt,ye[on],ce,ct+ce,Gt);ct+=S[on]}}catch(Pt){_e=!1,xe.dispatchEvent(new ErrorEvent("processorerror",{colno:Pt.colno,filename:Pt.filename,lineno:Pt.lineno,message:Pt.message}))}if(!_e){for(let Pt=0;Pt<w.numberOfInputs;Pt+=1){M[Pt].disconnect(P[Pt]);for(let Ht=0;Ht<w.channelCount;Ht+=1)P[Gt].disconnect(X,Ht,Pt*w.channelCount+Ht)}if(x.parameterDescriptors!==void 0){const Pt=x.parameterDescriptors.length;for(let Ht=0;Ht<Pt;Ht+=1){const on=j[Ht];on.disconnect(X,0,A+Ht),on.stop()}}X.disconnect(G),G.onaudioprocess=null,it?Je():Et();break}}}};let it=!1;const Tt=a(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Xt=()=>G.connect(Tt).connect(y.destination),Et=()=>{G.disconnect(Tt),Tt.disconnect()},St=()=>{if(_e){Et(),w.numberOfOutputs>0&&G.connect(Z);for(let at=0,lt=0;at<w.numberOfOutputs;at+=1){const Vt=ne[at];for(let Gt=0;Gt<S[at];Gt+=1)Z.connect(Vt,lt+Gt,Gt);lt+=S[at]}}it=!0},Dt=()=>{_e&&(Xt(),Je()),it=!1};return Xt(),g(xe,St,Dt)},Ok=(n,e)=>{const t=n.createBiquadFilter();return qr(t,e),Tr(t,e,"Q"),Tr(t,e,"detune"),Tr(t,e,"frequency"),Tr(t,e,"gain"),pr(t,e,"type"),t},D5=(n,e)=>(t,r)=>{const i=t.createChannelMerger(r.numberOfInputs);return n!==null&&n.name==="webkitAudioContext"&&e(t,i),qr(i,r),i},M5=n=>{const e=n.numberOfOutputs;Object.defineProperty(n,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw mi()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw mi()}}),Object.defineProperty(n,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw mi()}})},Sf=(n,e)=>{const t=n.createChannelSplitter(e.numberOfOutputs);return qr(t,e),M5(t),t},N5=(n,e,t,r,i)=>(o,a)=>{if(o.createConstantSource===void 0)return t(o,a);const s=o.createConstantSource();return qr(s,a),Tr(s,a,"offset"),e(r,()=>r(o))||mC(s),e(i,()=>i(o))||vC(s),n(o,s),s},Bu=(n,e)=>(n.connect=e.connect.bind(e),n.disconnect=e.disconnect.bind(e),n),B5=(n,e,t,r)=>(i,{offset:o,...a})=>{const s=i.createBuffer(1,2,44100),l=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),f=t(i,{...a,gain:o}),h=s.getChannelData(0);h[0]=1,h[1]=1,l.buffer=s,l.loop=!0;const m={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(C){f.channelCount=C},get channelCountMode(){return f.channelCountMode},set channelCountMode(C){f.channelCountMode=C},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(C){f.channelInterpretation=C},get context(){return f.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get offset(){return f.gain},get onended(){return l.onended},set onended(C){l.onended=C},addEventListener(...C){return l.addEventListener(C[0],C[1],C[2])},dispatchEvent(...C){return l.dispatchEvent(C[0])},removeEventListener(...C){return l.removeEventListener(C[0],C[1],C[2])},start(C=0){l.start.call(l,C)},stop(C=0){l.stop.call(l,C)}},g=()=>l.connect(f),y=()=>l.disconnect(f);return n(i,l),r(Bu(m,f),g,y)},O5=(n,e)=>(t,r)=>{const i=t.createConvolver();if(qr(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),pr(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",o=>()=>o.call(i),o=>a=>{if(a>2)throw n();return o.call(i,a)}),r.channelCountMode==="max"))throw n();return e(i,"channelCountMode",o=>()=>o.call(i),o=>a=>{if(a==="max")throw n();return o.call(i,a)}),i},Fk=(n,e)=>{const t=n.createDelay(e.maxDelayTime);return qr(t,e),Tr(t,e,"delayTime"),t},F5=n=>(e,t)=>{const r=e.createDynamicsCompressor();if(qr(r,t),t.channelCount>2||t.channelCountMode==="max")throw n();return Tr(r,t,"attack"),Tr(r,t,"knee"),Tr(r,t,"ratio"),Tr(r,t,"release"),Tr(r,t,"threshold"),r},lo=(n,e)=>{const t=n.createGain();return qr(t,e),Tr(t,e,"gain"),t},L5=n=>(e,t,r)=>{if(e.createIIRFilter===void 0)return n(e,t,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return qr(i,r),i};function U5(n,e){const t=e[0]*e[0]+e[1]*e[1];return[(n[0]*e[0]+n[1]*e[1])/t,(n[1]*e[0]-n[0]*e[1])/t]}function j5(n,e){return[n[0]*e[0]-n[1]*e[1],n[0]*e[1]+n[1]*e[0]]}function EI(n,e){let t=[0,0];for(let r=n.length-1;r>=0;r-=1)t=j5(t,e),t[0]+=n[r];return t}const G5=(n,e,t,r)=>(i,o,{channelCount:a,channelCountMode:s,channelInterpretation:l,feedback:f,feedforward:h})=>{const m=Bk(o,i.sampleRate),g=f instanceof Float64Array?f:new Float64Array(f),y=h instanceof Float64Array?h:new Float64Array(h),C=g.length,x=y.length,w=Math.min(C,x);if(C===0||C>20)throw r();if(g[0]===0)throw e();if(x===0||x>20)throw r();if(y[0]===0)throw e();if(g[0]!==1){for(let j=0;j<x;j+=1)y[j]/=g[0];for(let j=1;j<C;j+=1)g[j]/=g[0]}const S=t(i,m,a,a);S.channelCount=a,S.channelCountMode=s,S.channelInterpretation=l;const A=32,E=[],_=[],T=[];for(let j=0;j<a;j+=1){E.push(0);const X=new Float32Array(A),L=new Float32Array(A);X.fill(0),L.fill(0),_.push(X),T.push(L)}S.onaudioprocess=j=>{const X=j.inputBuffer,L=j.outputBuffer,G=X.numberOfChannels;for(let Z=0;Z<G;Z+=1){const ne=X.getChannelData(Z),pe=L.getChannelData(Z);E[Z]=Nk(g,C,y,x,w,_[Z],T[Z],E[Z],A,ne,pe)}};const M=i.sampleRate/2;return Bu({get bufferSize(){return m},get channelCount(){return S.channelCount},set channelCount(j){S.channelCount=j},get channelCountMode(){return S.channelCountMode},set channelCountMode(j){S.channelCountMode=j},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(j){S.channelInterpretation=j},get context(){return S.context},get inputs(){return[S]},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},addEventListener(...j){return S.addEventListener(j[0],j[1],j[2])},dispatchEvent(...j){return S.dispatchEvent(j[0])},getFrequencyResponse(j,X,L){if(j.length!==X.length||X.length!==L.length)throw n();const G=j.length;for(let Z=0;Z<G;Z+=1){const ne=-Math.PI*(j[Z]/M),pe=[Math.cos(ne),Math.sin(ne)],ve=EI(y,pe),Se=EI(g,pe),Ne=U5(ve,Se);X[Z]=Math.sqrt(Ne[0]*Ne[0]+Ne[1]*Ne[1]),L[Z]=Math.atan2(Ne[1],Ne[0])}},removeEventListener(...j){return S.removeEventListener(j[0],j[1],j[2])}},S)},V5=(n,e)=>n.createMediaElementSource(e.mediaElement),z5=(n,e)=>{const t=n.createMediaStreamDestination();return qr(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},W5=(n,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((o,a)=>o.id<a.id?-1:o.id>a.id?1:0);const r=t.slice(0,1),i=n.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},H5=(n,e)=>(t,{mediaStreamTrack:r})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(r);const i=new MediaStream([r]),o=t.createMediaStreamSource(i);if(r.kind!=="audio")throw n();if(e(t))throw new TypeError;return o},Z5=n=>n===null?null:n.hasOwnProperty("OfflineAudioContext")?n.OfflineAudioContext:n.hasOwnProperty("webkitOfflineAudioContext")?n.webkitOfflineAudioContext:null,X5=(n,e,t,r,i,o)=>(a,s)=>{const l=a.createOscillator();return qr(l,s),Tr(l,s,"detune"),Tr(l,s,"frequency"),s.periodicWave!==void 0?l.setPeriodicWave(s.periodicWave):pr(l,s,"type"),e(t,()=>t(a))||mC(l),e(r,()=>r(a))||o(l,a),e(i,()=>i(a))||vC(l),n(a,l),l},$5=n=>(e,t)=>{const r=e.createPanner();return r.orientationX===void 0?n(e,t):(qr(r,t),Tr(r,t,"orientationX"),Tr(r,t,"orientationY"),Tr(r,t,"orientationZ"),Tr(r,t,"positionX"),Tr(r,t,"positionY"),Tr(r,t,"positionZ"),pr(r,t,"coneInnerAngle"),pr(r,t,"coneOuterAngle"),pr(r,t,"coneOuterGain"),pr(r,t,"distanceModel"),pr(r,t,"maxDistance"),pr(r,t,"panningModel"),pr(r,t,"refDistance"),pr(r,t,"rolloffFactor"),r)},K5=(n,e,t,r,i,o,a,s,l,f)=>(h,{coneInnerAngle:m,coneOuterAngle:g,coneOuterGain:y,distanceModel:C,maxDistance:x,orientationX:w,orientationY:S,orientationZ:A,panningModel:E,positionX:_,positionY:T,positionZ:M,refDistance:P,rolloffFactor:j,...X})=>{const L=h.createPanner();if(X.channelCount>2||X.channelCountMode==="max")throw a();qr(L,X);const G={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},Z=t(h,{...G,channelInterpretation:"speakers",numberOfInputs:6}),ne=r(h,{...X,gain:1}),pe=r(h,{...G,gain:1}),ve=r(h,{...G,gain:0}),Se=r(h,{...G,gain:0}),Ne=r(h,{...G,gain:0}),xe=r(h,{...G,gain:0}),Ae=r(h,{...G,gain:0}),ke=i(h,256,6,1),H=o(h,{...G,curve:new Float32Array([1,1]),oversample:"none"});let ee=[w,S,A],ae=[_,T,M];const ye=new Float32Array(1);ke.onaudioprocess=({inputBuffer:me})=>{const it=[l(me,ye,0),l(me,ye,1),l(me,ye,2)];it.some((Xt,Et)=>Xt!==ee[Et])&&(L.setOrientation(...it),ee=it);const Tt=[l(me,ye,3),l(me,ye,4),l(me,ye,5)];Tt.some((Xt,Et)=>Xt!==ae[Et])&&(L.setPosition(...Tt),ae=Tt)},Object.defineProperty(ve.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Se.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Ne.gain,"defaultValue",{get:()=>0}),Object.defineProperty(xe.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Ae.gain,"defaultValue",{get:()=>0});const Ee={get bufferSize(){},get channelCount(){return L.channelCount},set channelCount(me){if(me>2)throw a();ne.channelCount=me,L.channelCount=me},get channelCountMode(){return L.channelCountMode},set channelCountMode(me){if(me==="max")throw a();ne.channelCountMode=me,L.channelCountMode=me},get channelInterpretation(){return L.channelInterpretation},set channelInterpretation(me){ne.channelInterpretation=me,L.channelInterpretation=me},get coneInnerAngle(){return L.coneInnerAngle},set coneInnerAngle(me){L.coneInnerAngle=me},get coneOuterAngle(){return L.coneOuterAngle},set coneOuterAngle(me){L.coneOuterAngle=me},get coneOuterGain(){return L.coneOuterGain},set coneOuterGain(me){if(me<0||me>1)throw e();L.coneOuterGain=me},get context(){return L.context},get distanceModel(){return L.distanceModel},set distanceModel(me){L.distanceModel=me},get inputs(){return[ne]},get maxDistance(){return L.maxDistance},set maxDistance(me){if(me<0)throw new RangeError;L.maxDistance=me},get numberOfInputs(){return L.numberOfInputs},get numberOfOutputs(){return L.numberOfOutputs},get orientationX(){return pe.gain},get orientationY(){return ve.gain},get orientationZ(){return Se.gain},get panningModel(){return L.panningModel},set panningModel(me){L.panningModel=me},get positionX(){return Ne.gain},get positionY(){return xe.gain},get positionZ(){return Ae.gain},get refDistance(){return L.refDistance},set refDistance(me){if(me<0)throw new RangeError;L.refDistance=me},get rolloffFactor(){return L.rolloffFactor},set rolloffFactor(me){if(me<0)throw new RangeError;L.rolloffFactor=me},addEventListener(...me){return ne.addEventListener(me[0],me[1],me[2])},dispatchEvent(...me){return ne.dispatchEvent(me[0])},removeEventListener(...me){return ne.removeEventListener(me[0],me[1],me[2])}};m!==Ee.coneInnerAngle&&(Ee.coneInnerAngle=m),g!==Ee.coneOuterAngle&&(Ee.coneOuterAngle=g),y!==Ee.coneOuterGain&&(Ee.coneOuterGain=y),C!==Ee.distanceModel&&(Ee.distanceModel=C),x!==Ee.maxDistance&&(Ee.maxDistance=x),w!==Ee.orientationX.value&&(Ee.orientationX.value=w),S!==Ee.orientationY.value&&(Ee.orientationY.value=S),A!==Ee.orientationZ.value&&(Ee.orientationZ.value=A),E!==Ee.panningModel&&(Ee.panningModel=E),_!==Ee.positionX.value&&(Ee.positionX.value=_),T!==Ee.positionY.value&&(Ee.positionY.value=T),M!==Ee.positionZ.value&&(Ee.positionZ.value=M),P!==Ee.refDistance&&(Ee.refDistance=P),j!==Ee.rolloffFactor&&(Ee.rolloffFactor=j),(ee[0]!==1||ee[1]!==0||ee[2]!==0)&&L.setOrientation(...ee),(ae[0]!==0||ae[1]!==0||ae[2]!==0)&&L.setPosition(...ae);const _e=()=>{ne.connect(L),n(ne,H,0,0),H.connect(pe).connect(Z,0,0),H.connect(ve).connect(Z,0,1),H.connect(Se).connect(Z,0,2),H.connect(Ne).connect(Z,0,3),H.connect(xe).connect(Z,0,4),H.connect(Ae).connect(Z,0,5),Z.connect(ke).connect(h.destination)},Je=()=>{ne.disconnect(L),s(ne,H,0,0),H.disconnect(pe),pe.disconnect(Z),H.disconnect(ve),ve.disconnect(Z),H.disconnect(Se),Se.disconnect(Z),H.disconnect(Ne),Ne.disconnect(Z),H.disconnect(xe),xe.disconnect(Z),H.disconnect(Ae),Ae.disconnect(Z),Z.disconnect(ke),ke.disconnect(h.destination)};return f(Bu(Ee,L),_e,Je)},q5=n=>(e,{disableNormalization:t,imag:r,real:i})=>{const o=r instanceof Float32Array?r:new Float32Array(r),a=i instanceof Float32Array?i:new Float32Array(i),s=e.createPeriodicWave(a,o,{disableNormalization:t});if(Array.from(r).length<2)throw n();return s},Af=(n,e,t,r)=>n.createScriptProcessor(e,t,r),Y5=(n,e)=>(t,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(t.createStereoPanner===void 0)return n(t,r);const o=t.createStereoPanner();return qr(o,r),Tr(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:a=>{if(a!==i)throw e()}}),o},Q5=(n,e,t,r,i,o)=>{const s=new Float32Array([1,1]),l=Math.PI/2,f={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h={...f,oversample:"none"},m=(C,x,w,S)=>{const A=new Float32Array(16385),E=new Float32Array(16385);for(let X=0;X<16385;X+=1){const L=X/16384*l;A[X]=Math.cos(L),E[X]=Math.sin(L)}const _=t(C,{...f,gain:0}),T=r(C,{...h,curve:A}),M=r(C,{...h,curve:s}),P=t(C,{...f,gain:0}),j=r(C,{...h,curve:E});return{connectGraph(){x.connect(_),x.connect(M.inputs===void 0?M:M.inputs[0]),x.connect(P),M.connect(w),w.connect(T.inputs===void 0?T:T.inputs[0]),w.connect(j.inputs===void 0?j:j.inputs[0]),T.connect(_.gain),j.connect(P.gain),_.connect(S,0,0),P.connect(S,0,1)},disconnectGraph(){x.disconnect(_),x.disconnect(M.inputs===void 0?M:M.inputs[0]),x.disconnect(P),M.disconnect(w),w.disconnect(T.inputs===void 0?T:T.inputs[0]),w.disconnect(j.inputs===void 0?j:j.inputs[0]),T.disconnect(_.gain),j.disconnect(P.gain),_.disconnect(S,0,0),P.disconnect(S,0,1)}}},g=(C,x,w,S)=>{const A=new Float32Array(16385),E=new Float32Array(16385),_=new Float32Array(16385),T=new Float32Array(16385),M=Math.floor(16385/2);for(let Ne=0;Ne<16385;Ne+=1)if(Ne>M){const xe=(Ne-M)/(16384-M)*l;A[Ne]=Math.cos(xe),E[Ne]=Math.sin(xe),_[Ne]=0,T[Ne]=1}else{const xe=Ne/(16384-M)*l;A[Ne]=1,E[Ne]=0,_[Ne]=Math.cos(xe),T[Ne]=Math.sin(xe)}const P=e(C,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),j=t(C,{...f,gain:0}),X=r(C,{...h,curve:A}),L=t(C,{...f,gain:0}),G=r(C,{...h,curve:E}),Z=r(C,{...h,curve:s}),ne=t(C,{...f,gain:0}),pe=r(C,{...h,curve:_}),ve=t(C,{...f,gain:0}),Se=r(C,{...h,curve:T});return{connectGraph(){x.connect(P),x.connect(Z.inputs===void 0?Z:Z.inputs[0]),P.connect(j,0),P.connect(L,0),P.connect(ne,1),P.connect(ve,1),Z.connect(w),w.connect(X.inputs===void 0?X:X.inputs[0]),w.connect(G.inputs===void 0?G:G.inputs[0]),w.connect(pe.inputs===void 0?pe:pe.inputs[0]),w.connect(Se.inputs===void 0?Se:Se.inputs[0]),X.connect(j.gain),G.connect(L.gain),pe.connect(ne.gain),Se.connect(ve.gain),j.connect(S,0,0),ne.connect(S,0,0),L.connect(S,0,1),ve.connect(S,0,1)},disconnectGraph(){x.disconnect(P),x.disconnect(Z.inputs===void 0?Z:Z.inputs[0]),P.disconnect(j,0),P.disconnect(L,0),P.disconnect(ne,1),P.disconnect(ve,1),Z.disconnect(w),w.disconnect(X.inputs===void 0?X:X.inputs[0]),w.disconnect(G.inputs===void 0?G:G.inputs[0]),w.disconnect(pe.inputs===void 0?pe:pe.inputs[0]),w.disconnect(Se.inputs===void 0?Se:Se.inputs[0]),X.disconnect(j.gain),G.disconnect(L.gain),pe.disconnect(ne.gain),Se.disconnect(ve.gain),j.disconnect(S,0,0),ne.disconnect(S,0,0),L.disconnect(S,0,1),ve.disconnect(S,0,1)}}},y=(C,x,w,S,A)=>{if(x===1)return m(C,w,S,A);if(x===2)return g(C,w,S,A);throw i()};return(C,{channelCount:x,channelCountMode:w,pan:S,...A})=>{if(w==="max")throw i();const E=n(C,{...A,channelCount:1,channelCountMode:w,numberOfInputs:2}),_=t(C,{...A,channelCount:x,channelCountMode:w,gain:1}),T=t(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:S});let{connectGraph:M,disconnectGraph:P}=y(C,x,_,T,E);Object.defineProperty(T.gain,"defaultValue",{get:()=>0}),Object.defineProperty(T.gain,"maxValue",{get:()=>1}),Object.defineProperty(T.gain,"minValue",{get:()=>-1});const j={get bufferSize(){},get channelCount(){return _.channelCount},set channelCount(Z){_.channelCount!==Z&&(X&&P(),{connectGraph:M,disconnectGraph:P}=y(C,Z,_,T,E),X&&M()),_.channelCount=Z},get channelCountMode(){return _.channelCountMode},set channelCountMode(Z){if(Z==="clamped-max"||Z==="max")throw i();_.channelCountMode=Z},get channelInterpretation(){return _.channelInterpretation},set channelInterpretation(Z){_.channelInterpretation=Z},get context(){return _.context},get inputs(){return[_]},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get pan(){return T.gain},addEventListener(...Z){return _.addEventListener(Z[0],Z[1],Z[2])},dispatchEvent(...Z){return _.dispatchEvent(Z[0])},removeEventListener(...Z){return _.removeEventListener(Z[0],Z[1],Z[2])}};let X=!1;const L=()=>{M(),X=!0},G=()=>{P(),X=!1};return o(Bu(j,E),L,G)}},J5=(n,e,t,r,i,o,a)=>(s,l)=>{const f=s.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&s.createGain().gain.automationRate===void 0)return t(s,l);qr(f,l);const h=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(h!==null&&h.length<2)throw e();pr(f,{curve:h},"curve"),pr(f,l,"oversample");let m=null,g=!1;return a(f,"curve",x=>()=>x.call(f),x=>w=>(x.call(f,w),g&&(r(w)&&m===null?m=n(s,f):!r(w)&&m!==null&&(m(),m=null)),w)),i(f,()=>{g=!0,r(f.curve)&&(m=n(s,f))},()=>{g=!1,m!==null&&(m(),m=null)})},eN=(n,e,t,r,i)=>(o,{curve:a,oversample:s,...l})=>{const f=o.createWaveShaper(),h=o.createWaveShaper();qr(f,l),qr(h,l);const m=t(o,{...l,gain:1}),g=t(o,{...l,gain:-1}),y=t(o,{...l,gain:1}),C=t(o,{...l,gain:-1});let x=null,w=!1,S=null;const A={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(T){m.channelCount=T,g.channelCount=T,f.channelCount=T,y.channelCount=T,h.channelCount=T,C.channelCount=T},get channelCountMode(){return f.channelCountMode},set channelCountMode(T){m.channelCountMode=T,g.channelCountMode=T,f.channelCountMode=T,y.channelCountMode=T,h.channelCountMode=T,C.channelCountMode=T},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(T){m.channelInterpretation=T,g.channelInterpretation=T,f.channelInterpretation=T,y.channelInterpretation=T,h.channelInterpretation=T,C.channelInterpretation=T},get context(){return f.context},get curve(){return S},set curve(T){if(T!==null&&T.length<2)throw e();if(T===null)f.curve=T,h.curve=T;else{const M=T.length,P=new Float32Array(M+2-M%2),j=new Float32Array(M+2-M%2);P[0]=T[0],j[0]=-T[M-1];const X=Math.ceil((M+1)/2),L=(M+1)/2-1;for(let G=1;G<X;G+=1){const Z=G/X*L,ne=Math.floor(Z),pe=Math.ceil(Z);P[G]=ne===pe?T[ne]:(1-(Z-ne))*T[ne]+(1-(pe-Z))*T[pe],j[G]=ne===pe?-T[M-1-ne]:-((1-(Z-ne))*T[M-1-ne])-(1-(pe-Z))*T[M-1-pe]}P[X]=M%2===1?T[X-1]:(T[X-2]+T[X-1])/2,f.curve=P,h.curve=j}S=T,w&&(r(S)&&x===null?x=n(o,m):x!==null&&(x(),x=null))},get inputs(){return[m]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get oversample(){return f.oversample},set oversample(T){f.oversample=T,h.oversample=T},addEventListener(...T){return m.addEventListener(T[0],T[1],T[2])},dispatchEvent(...T){return m.dispatchEvent(T[0])},removeEventListener(...T){return m.removeEventListener(T[0],T[1],T[2])}};a!==null&&(A.curve=a instanceof Float32Array?a:new Float32Array(a)),s!==A.oversample&&(A.oversample=s);const E=()=>{m.connect(f).connect(y),m.connect(g).connect(h).connect(C).connect(y),w=!0,r(S)&&(x=n(o,m))},_=()=>{m.disconnect(f),f.disconnect(y),m.disconnect(g),g.disconnect(h),h.disconnect(C),C.disconnect(y),w=!1,x!==null&&(x(),x=null)};return i(Bu(A,y),E,_)},uo=()=>new DOMException("","NotSupportedError"),tN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},nN=(n,e,t,r,i,o,a)=>class extends n{constructor(l,f){const h=i(l),m={...tN,...f},g=t(h,m),y=o(h),C=y?r():null,x=l.sampleRate/2;super(l,!1,g,C),this._detune=e(this,y,g.detune,153600,-153600),this._frequency=e(this,y,g.frequency,x,-x),this._nativeOscillatorNode=g,this._onended=null,this._oscillatorNodeRenderer=C,this._oscillatorNodeRenderer!==null&&m.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=m.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const f=typeof l=="function"?a(this,l):null;this._nativeOscillatorNode.onended=f;const h=this._nativeOscillatorNode.onended;this._onended=h!==null&&h===f?l:h}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Tu(this);const f=()=>{this._nativeOscillatorNode.removeEventListener("ended",f),Da(this)&&bf(this)};this._nativeOscillatorNode.addEventListener("ended",f)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},rN=(n,e,t,r,i)=>()=>{const o=new WeakMap;let a=null,s=null,l=null;const f=async(h,m)=>{let g=t(h);const y=Pi(g,m);if(!y){const C={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,detune:g.detune.value,frequency:g.frequency.value,periodicWave:a===null?void 0:a,type:g.type};g=e(m,C),s!==null&&g.start(s),l!==null&&g.stop(l)}return o.set(m,g),y?(await n(m,h.detune,g.detune),await n(m,h.frequency,g.frequency)):(await r(m,h.detune,g.detune),await r(m,h.frequency,g.frequency)),await i(h,m,g),g};return{set periodicWave(h){a=h},set start(h){s=h},set stop(h){l=h},render(h,m){const g=o.get(m);return g!==void 0?Promise.resolve(g):f(h,m)}}},iN={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},oN=(n,e,t,r,i,o,a)=>class extends n{constructor(l,f){const h=i(l),m={...iN,...f},g=t(h,m),y=o(h),C=y?r():null;super(l,!1,g,C),this._nativePannerNode=g,this._orientationX=e(this,y,g.orientationX,Ui,ro),this._orientationY=e(this,y,g.orientationY,Ui,ro),this._orientationZ=e(this,y,g.orientationZ,Ui,ro),this._positionX=e(this,y,g.positionX,Ui,ro),this._positionY=e(this,y,g.positionY,Ui,ro),this._positionZ=e(this,y,g.positionZ,Ui,ro),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},sN=(n,e,t,r,i,o,a,s,l,f)=>()=>{const h=new WeakMap;let m=null;const g=async(y,C)=>{let x=null,w=o(y);const S={channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation},A={...S,coneInnerAngle:w.coneInnerAngle,coneOuterAngle:w.coneOuterAngle,coneOuterGain:w.coneOuterGain,distanceModel:w.distanceModel,maxDistance:w.maxDistance,panningModel:w.panningModel,refDistance:w.refDistance,rolloffFactor:w.rolloffFactor},E=Pi(w,C);if("bufferSize"in w)x=r(C,{...S,gain:1});else if(!E){const _={...A,orientationX:w.orientationX.value,orientationY:w.orientationY.value,orientationZ:w.orientationZ.value,positionX:w.positionX.value,positionY:w.positionY.value,positionZ:w.positionZ.value};w=i(C,_)}if(h.set(C,x===null?w:x),x!==null){if(m===null){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const G=new a(6,y.context.length,C.sampleRate),Z=e(G,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});Z.connect(G.destination),m=(async()=>{const ne=await Promise.all([y.orientationX,y.orientationY,y.orientationZ,y.positionX,y.positionY,y.positionZ].map(async(pe,ve)=>{const Se=t(G,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ve===0?1:0});return await s(G,pe,Se.offset),Se}));for(let pe=0;pe<6;pe+=1)ne[pe].connect(Z,0,pe),ne[pe].start(0);return f(G)})()}const _=await m,T=r(C,{...S,gain:1});await l(y,C,T);const M=[];for(let G=0;G<_.numberOfChannels;G+=1)M.push(_.getChannelData(G));let P=[M[0][0],M[1][0],M[2][0]],j=[M[3][0],M[4][0],M[5][0]],X=r(C,{...S,gain:1}),L=i(C,{...A,orientationX:P[0],orientationY:P[1],orientationZ:P[2],positionX:j[0],positionY:j[1],positionZ:j[2]});T.connect(X).connect(L.inputs[0]),L.connect(x);for(let G=128;G<_.length;G+=128){const Z=[M[0][G],M[1][G],M[2][G]],ne=[M[3][G],M[4][G],M[5][G]];if(Z.some((pe,ve)=>pe!==P[ve])||ne.some((pe,ve)=>pe!==j[ve])){P=Z,j=ne;const pe=G/C.sampleRate;X.gain.setValueAtTime(0,pe),X=r(C,{...S,gain:0}),L=i(C,{...A,orientationX:P[0],orientationY:P[1],orientationZ:P[2],positionX:j[0],positionY:j[1],positionZ:j[2]}),X.gain.setValueAtTime(1,pe),T.connect(X).connect(L.inputs[0]),L.connect(x)}}return x}return E?(await n(C,y.orientationX,w.orientationX),await n(C,y.orientationY,w.orientationY),await n(C,y.orientationZ,w.orientationZ),await n(C,y.positionX,w.positionX),await n(C,y.positionY,w.positionY),await n(C,y.positionZ,w.positionZ)):(await s(C,y.orientationX,w.orientationX),await s(C,y.orientationY,w.orientationY),await s(C,y.orientationZ,w.orientationZ),await s(C,y.positionX,w.positionX),await s(C,y.positionY,w.positionY),await s(C,y.positionZ,w.positionZ)),Nu(w)?await l(y,C,w.inputs[0]):await l(y,C,w),w};return{render(y,C){const x=h.get(C);return x!==void 0?Promise.resolve(x):g(y,C)}}},aN={disableNormalization:!1},cN=(n,e,t,r)=>class Lk{constructor(o,a){const s=e(o),l=r({...aN,...a}),f=n(s,l);return t.add(f),f}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===Lk.prototype||t.has(o)}},lN=(n,e)=>(t,r,i)=>(n(r).replay(i),e(r,t,i)),uN=(n,e,t)=>async(r,i,o)=>{const a=n(r);await Promise.all(a.activeInputs.map((s,l)=>Array.from(s).map(async([f,h])=>{const g=await e(f).render(f,i),y=r.context.destination;!t(f)&&(r!==y||!t(r))&&g.connect(o,h,l)})).reduce((s,l)=>[...s,...l],[]))},dN=(n,e,t)=>async(r,i,o)=>{const a=e(r);await Promise.all(Array.from(a.activeInputs).map(async([s,l])=>{const h=await n(s).render(s,i);t(s)||h.connect(o,l)}))},fN=(n,e,t,r)=>i=>n(zv,()=>zv(i))?Promise.resolve(n(r,r)).then(o=>{if(!o){const a=t(i,512,0,1);i.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>i.currentTime,a.connect(i.destination)}return i.startRendering()}):new Promise(o=>{const a=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=s=>{a.disconnect(),o(s.renderedBuffer)},a.connect(i.destination),i.startRendering()}),hN=n=>(e,t)=>{n.set(e,t)},pN=n=>(e,t)=>n.set(e,t),gN={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},mN=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const f=i(s),h={...gN,...l},m=t(f,h),g=o(f),y=g?r():null;super(s,!1,m,y),this._pan=e(this,g,m.pan)}get pan(){return this._pan}},vN=(n,e,t,r,i)=>()=>{const o=new WeakMap,a=async(s,l)=>{let f=t(s);const h=Pi(f,l);if(!h){const m={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,pan:f.pan.value};f=e(l,m)}return o.set(l,f),h?await n(l,s.pan,f.pan):await r(l,s.pan,f.pan),Nu(f)?await i(s,l,f.inputs[0]):await i(s,l,f),f};return{render(s,l){const f=o.get(l);return f!==void 0?Promise.resolve(f):a(s,l)}}},yN=n=>()=>{if(n===null)return!1;try{new n({length:1,sampleRate:44100})}catch{return!1}return!0},CN=(n,e)=>async()=>{if(n===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(t);let o=!1,a=!1;try{await r.audioWorklet.addModule(i);const s=new n(r,"a",{numberOfOutputs:0}),l=r.createOscillator();s.port.onmessage=()=>o=!0,s.onprocessorerror=()=>a=!0,l.connect(s),l.start(0),await r.startRendering(),await new Promise(f=>setTimeout(f))}catch{}finally{URL.revokeObjectURL(i)}return o&&!a},xN=(n,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{t.oncomplete=()=>{r.disconnect(),i(t.currentTime!==0)},t.startRendering()})},bN=()=>new DOMException("","UnknownError"),IN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},wN=(n,e,t,r,i,o,a)=>class extends n{constructor(l,f){const h=i(l),m={...IN,...f},g=t(h,m),C=o(h)?r():null;super(l,!0,g,C),this._isCurveNullified=!1,this._nativeWaveShaperNode=g,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},SN=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,a)=>{let s=e(o);if(!Pi(s,a)){const f={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,curve:s.curve,oversample:s.oversample};s=n(a,f)}return r.set(a,s),Nu(s)?await t(o,a,s.inputs[0]):await t(o,a,s),s};return{render(o,a){const s=r.get(a);return s!==void 0?Promise.resolve(s):i(o,a)}}},AN=()=>typeof window>"u"?null:window,kN=(n,e)=>t=>{t.copyFromChannel=(r,i,o=0)=>{const a=n(o),s=n(i);if(s>=t.numberOfChannels)throw e();const l=t.length,f=t.getChannelData(s),h=r.length;for(let m=a<0?-a:0;m+a<l&&m<h;m+=1)r[m]=f[m+a]},t.copyToChannel=(r,i,o=0)=>{const a=n(o),s=n(i);if(s>=t.numberOfChannels)throw e();const l=t.length,f=t.getChannelData(s),h=r.length;for(let m=a<0?-a:0;m+a<l&&m<h;m+=1)f[m+a]=r[m]}},EN=n=>e=>{e.copyFromChannel=(t=>(r,i,o=0)=>{const a=n(o),s=n(i);if(a<e.length)return t.call(e,r,s,a)})(e.copyFromChannel),e.copyToChannel=(t=>(r,i,o=0)=>{const a=n(o),s=n(i);if(a<e.length)return t.call(e,r,s,a)})(e.copyToChannel)},TN=n=>(e,t)=>{const r=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),n(e,"buffer",i=>()=>{const o=i.call(e);return o===r?null:o},i=>o=>i.call(e,o===null?r:o))},_N=(n,e)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw n()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw n()}});const i=t.createBufferSource();e(r,()=>{const s=r.numberOfInputs;for(let l=0;l<s;l+=1)i.connect(r,0,l)},()=>i.disconnect(r))},Uk=(n,e,t)=>n.copyFromChannel===void 0?n.getChannelData(t)[0]:(n.copyFromChannel(e,t),e[0]),jk=n=>{if(n===null)return!1;const e=n.length;return e%2!==0?n[Math.floor(e/2)]!==0:n[e/2-1]+n[e/2]!==0},kf=(n,e,t,r)=>{let i=n;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:a}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(n,e,{get:t(o),set:r(a)})},RN=n=>({...n,outputChannelCount:n.outputChannelCount!==void 0?n.outputChannelCount:n.numberOfInputs===1&&n.numberOfOutputs===1?[n.channelCount]:Array.from({length:n.numberOfOutputs},()=>1)}),PN=n=>({...n,channelCount:n.numberOfOutputs}),DN=n=>{const{imag:e,real:t}=n;return e===void 0?t===void 0?{...n,imag:[0,0],real:[0,0]}:{...n,imag:Array.from(t,()=>0),real:t}:t===void 0?{...n,imag:e,real:Array.from(e,()=>0)}:{...n,imag:e,real:t}},Gk=(n,e,t)=>{try{n.setValueAtTime(e,t)}catch(r){if(r.code!==9)throw r;Gk(n,e,t+1e-7)}},MN=n=>{const e=n.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},NN=n=>{const e=n.createBufferSource(),t=n.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},BN=n=>{const e=n.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},yC=n=>{const e=n.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},Vk=n=>{const e=n.createBuffer(1,1,44100),t=n.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},CC=n=>{const e=n.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},ON=n=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(n)}finally{e.close(),t.close()}},FN=n=>{n.start=(e=>(t=0,r=0,i)=>{const o=n.buffer,a=o===null?r:Math.min(o.duration,r);o!==null&&a>o.duration-.5/n.context.sampleRate?e.call(n,t,0,0):e.call(n,t,a,i)})(n.start)},zk=(n,e)=>{const t=e.createGain();n.connect(t);const r=(i=>()=>{i.call(n,t),n.removeEventListener("ended",r)})(n.disconnect);n.addEventListener("ended",r),Bu(n,t),n.stop=(i=>{let o=!1;return(a=0)=>{if(o)try{i.call(n,a)}catch{t.gain.setValueAtTime(0,a)}else i.call(n,a),o=!0}})(n.stop)},Ou=(n,e)=>t=>{const r={value:n};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof e=="function"?e.call(n,t):e.handleEvent.call(n,t)},LN=dM(Tl),UN=vM(Tl),jN=_4(Mp),Wk=new WeakMap,GN=X4(Wk),Ba=s4(new Map,new WeakMap),qs=AN(),Hk=C5(Ba,Js),Zk=Z4(Gi),yi=uN(Gi,Zk,vl),VN=IM(Hk,ur,yi),er=q4(Ik),_c=Z5(qs),Xn=l5(_c),Xk=new WeakMap,$k=U4(Ou),Ef=w5(qs),Kk=o5(Ef),qk=s5(qs),zN=a5(qs),Yd=A5(qs),Nr=$M(fM(yk),mM(LN,UN,np,jN,rp,Gi,GN,xf,ur,Tl,Da,vl,Wh),Ba,i5(Fv,rp,Gi,ur,qd,Da),Js,Np,uo,A4(np,Fv,Gi,ur,qd,er,Da,Xn),D4(Xk,Gi,Ss),$k,er,Kk,qk,zN,Xn,Yd),WN=bM(Nr,VN,Js,Hk,er,Xn),Yk=new WeakSet,TI=x5(qs),Qk=C4(new Uint32Array(1)),Jk=kN(Qk,Js),eE=EN(Qk),HN=SM(Yk,Ba,uo,TI,_c,yN(TI),Jk,eE),Bp=yM(lo),tE=dN(Zk,If,vl),ea=h4(tE),Fu=I5(Bp,Ba,MN,NN,BN,yC,Vk,CC,FN,TN(kf),zk),ta=lN($4(If),tE),ZN=EM(ea,Fu,ur,ta,yi),Rs=KM(hM(xk),Xk,bk,qM,oM,sM,aM,cM,lM,Nv,mk,Ef,Gk),XN=kM(Nr,ZN,Rs,mi,Fu,er,Xn,Ou),$N=FM(Nr,LM,Js,mi,S5(lo,kf),er,Xn,yi),KN=o4(ea,Ok,ur,ta,yi),_l=pN(Wk),qN=i4(Nr,Rs,KN,Np,Ok,er,Xn,_l),Rc=v5(Tl,qk),YN=_N(mi,Rc),Pc=D5(Ef,YN),QN=l4(Pc,ur,yi),JN=c4(Nr,QN,Pc,er,Xn),eB=f4(Sf,ur,yi),tB=d4(Nr,eB,Sf,er,Xn,PN),nB=B5(Bp,Fu,lo,Rc),Lu=N5(Bp,Ba,nB,yC,CC),rB=y4(ea,Lu,ur,ta,yi),iB=v4(Nr,Rs,rB,Lu,er,Xn,Ou),nE=O5(uo,kf),oB=I4(nE,ur,yi),sB=b4(Nr,oB,nE,er,Xn,_l),aB=T4(ea,Fk,ur,ta,yi),cB=E4(Nr,Rs,aB,Fk,er,Xn,_l),rE=F5(uo),lB=O4(ea,rE,ur,ta,yi),uB=B4(Nr,Rs,lB,rE,uo,er,Xn,_l),dB=W4(ea,lo,ur,ta,yi),fB=z4(Nr,Rs,dB,lo,er,Xn),hB=G5(Np,mi,Af,uo),xC=fN(Ba,lo,Af,xN(lo,_c)),pB=r5(Fu,ur,_c,yi,xC),gB=L5(hB),mB=t5(Nr,gB,pB,er,Xn,_l),vB=UM(Rs,Pc,Lu,Af,uo,Uk,Xn,kf),iE=new WeakMap,yB=m5($N,vB,$k,Xn,iE,Ou),oE=X5(Bp,Ba,yC,Vk,CC,zk),CB=rN(ea,oE,ur,ta,yi),xB=nN(Nr,Rs,oE,CB,er,Xn,Ou),sE=g4(Fu),bB=eN(sE,mi,lo,jk,Rc),Op=J5(sE,mi,bB,jk,Rc,Ef,kf),IB=K5(np,mi,Pc,lo,Af,Op,uo,rp,Uk,Rc),aE=$5(IB),wB=sN(ea,Pc,Lu,lo,aE,ur,_c,ta,yi,xC),SB=oN(Nr,Rs,aE,wB,er,Xn,_l),AB=q5(Js),kB=cN(AB,er,new WeakSet,DN),EB=Q5(Pc,Sf,lo,Op,uo,Rc),cE=Y5(EB,uo),TB=vN(ea,cE,ur,ta,yi),_B=mN(Nr,Rs,cE,TB,er,Xn),RB=SN(Op,ur,yi),PB=wN(Nr,mi,Op,RB,er,Xn,_l),lE=u5(qs),bC=j4(qs),uE=new WeakMap,DB=Y4(uE,_c),MB=lE?gM(Ba,uo,L4(qs),bC,G4(uM),er,DB,Xn,Yd,new WeakMap,new WeakMap,CN(Yd,_c),qs):void 0,NB=c5(Kk,Xn),BB=S4(Yk,Ba,w4,F4,new WeakSet,er,NB,Gv,zv,Jk,eE),OB=n4(MB,WN,HN,XN,qN,JN,tB,iB,sB,BB,cB,uB,fB,mB,yB,xB,SB,kB,_B,PB),FB=d5(Nr,V5,er,Xn),LB=h5(Nr,z5,er,Xn),UB=p5(Nr,W5,er,Xn),jB=H5(mi,Xn),GB=g5(Nr,jB,er),VB=OM(OB,mi,uo,bN,FB,LB,UB,GB,Ef),dE=Q4(iE),zB=CM(dE),fE=p4(Js),WB=R4(dE),hE=M4(Js),pE=new WeakMap,HB=H4(pE,Ss),ZB=P5(fE,Js,mi,Pc,Sf,Lu,lo,Af,uo,hE,bC,HB,Rc),XB=E5(mi,ZB,lo,uo,Rc),$B=t4(ea,fE,Fu,Pc,Sf,Lu,lo,WB,hE,bC,ur,Yd,_c,ta,yi,xC),KB=K4(uE),qB=hN(pE),_I=lE?QM(zB,Nr,Rs,$B,XB,Gi,KB,er,Xn,Yd,RN,qB,ON,Ou):void 0,YB="data:text/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";let RI=class{constructor(e){oe(this,"maxSize");oe(this,"cache");this.maxSize=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const r=this.cache.keys().next().value;r!==void 0&&this.cache.delete(r)}this.cache.set(e,t)}has(e){return this.cache.has(e)}};const PI=100,Dr=class Dr{static setCacheExpirationTime(e){this.cacheExpirationTime=e}static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getOrCreatePendingRequest(e,t){let r=this.pendingRequests.get(e);if(!r){const i=(async()=>{try{const o=await t();if(o===void 0)throw new Error("Failed to create audio buffer.");return o}finally{this.pendingRequests.delete(e)}})();return this.pendingRequests.set(e,i),i}return r}static async updateMetadata(e,t,r){const i={url:t,timestamp:Date.now(),...r};await e.put(`${t}:meta`,new Response(JSON.stringify(i),{headers:{"Content-Type":"application/json"}}))}static async getBufferFromCache(e,t){try{const r=await t.match(e);return r&&r.ok?await r.arrayBuffer():null}catch(r){return console.error("Failed to get data from cache:",r),null}}static async fetchAndCacheBuffer(e,t,r,i){const o=new Headers;r&&o.append("If-None-Match",r),i&&o.append("If-Modified-Since",i);const a=await fetch(e,{headers:o});if(a.status===304){const s=await t.match(e);if(s){const l=Date.now();return await this.updateMetadata(t,e,{timestamp:l,etag:r,lastModified:i}),await s.arrayBuffer()}else{console.warn(`Cache inconsistency detected for ${e}: 304 response but no cached body. Re-fetching.`);const l=await fetch(e);if(l.status===200){const f=l.clone(),h=l.headers.get("ETag"),m=l.headers.get("Last-Modified");try{await Promise.all([t.put(e,f),this.updateMetadata(t,e,{timestamp:Date.now(),etag:h||void 0,lastModified:m||void 0})])}catch(g){throw await t.delete(e),await t.delete(`${e}:meta`),g}return await l.arrayBuffer()}else throw new Error(`Failed to fetch resource after cache inconsistency: ${l.status} ${l.statusText}`)}}if(a.status===200){const s=a.clone(),l=a.headers.get("ETag"),f=a.headers.get("Last-Modified");try{await Promise.all([t.put(e,s),this.updateMetadata(t,e,{timestamp:Date.now(),etag:l||void 0,lastModified:f||void 0})])}catch(h){throw await t.delete(e),await t.delete(`${e}:meta`),h}}return await a.arrayBuffer()}static async decodeAudioData(e,t){try{return await e.decodeAudioData(t)}catch(r){throw console.error("Failed to decode audio data:",r),r}}static async getMetadataFromCache(e,t){try{const r=await t.match(e+":meta");return r&&r.ok?await r.json():null}catch(r){return console.error("Failed to get metadata from cache:",r),null}}async getAudioBuffer(e,t){if(Dr.decodedBuffers.has(t))return Dr.decodedBuffers.get(t);if(t.startsWith("data:")){const a=t.split(",")[1],s=Uint8Array.from(atob(a),f=>f.charCodeAt(0)).buffer,l=await Dr.decodeAudioData(e,s);return Dr.decodedBuffers.set(t,l),l}const r=await Dr.openCache(),i=await Dr.getMetadataFromCache(t,r),o=!i||i.etag||i.lastModified||Date.now()-i.timestamp>Dr.cacheExpirationTime;return Dr.getOrCreatePendingRequest(t,async()=>{if(o){const a=await Dr.fetchAndCacheBuffer(t,r,i==null?void 0:i.etag,i==null?void 0:i.lastModified),s=await Dr.decodeAudioData(e,a);return Dr.decodedBuffers.set(t,s),s}else{const a=await Dr.getBufferFromCache(t,r);if(a){const s=await Dr.decodeAudioData(e,a);return Dr.decodedBuffers.set(t,s),s}}})}clearMemoryCache(){Dr.decodedBuffers=new RI(PI),Dr.pendingRequests.clear()}};oe(Dr,"pendingRequests",new Map),oe(Dr,"decodedBuffers",new RI(PI)),oe(Dr,"cacheExpirationTime",24*60*60*1e3);let Wv=Dr,DI=class{constructor(e=[]){oe(this,"_position",[0,0,0]);oe(this,"loopCount",0);oe(this,"playIndex",0);this.sounds=e}preplayRandom(){if(this.sounds.length===0)return;const e=this.randomSound().preplay();return e.length>0?e[0]:void 0}playRandom(){const e=this.preplayRandom();return e&&e.play(),e}preplayOrdered(e=!0){if(this.sounds.length===0)return;const t=this.sounds[this.playIndex].preplay();if(t.length!==0)return this.playIndex=(this.playIndex+1)%this.sounds.length,!e&&this.playIndex===0&&(this.playIndex=this.sounds.length),t[0]}playOrdered(e=!0){const t=this.preplayOrdered(e);return t&&t.play(),t}get duration(){return this.sounds.map(e=>e.duration).reduce((e,t)=>Math.max(e,t),0)}seek(e){this.sounds.forEach(t=>t.seek&&t.seek(e))}addSound(e){this.sounds.push(e)}randomSound(){if(this.sounds.length===0)throw new Error("Cannot get a random sound from an empty group");const e=Math.floor(Math.random()*this.sounds.length);return this.sounds[e]}preplay(){return this.sounds.map(e=>e.preplay()).flat()}play(){const e=[];return this.preplay().forEach(t=>{t.play(),e.push(t)}),e}get isPlaying(){return this.sounds.some(e=>e.isPlaying)}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(t=>t.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(t=>t.addFilter(e))}removeFilter(e){this.sounds.forEach(t=>t.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(t=>t.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,t)=>e+t,0)/this.sounds.length}set volume(e){this.sounds.forEach(t=>t.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(t=>t.playbackRate=e)}};class Uu{constructor(){oe(this,"_filters",[])}addFilter(e){this._filters.push(e)}removeFilter(e){this._filters=this._filters.filter(t=>t.frequency.value!==e.frequency.value&&t.type!==e.type&&t.Q.value!==e.Q.value&&t.gain.value!==e.gain.value)}applyFilters(e){return this._filters.reduce((t,r)=>(t.connect(r),r),e),this._filters.length>0?this._filters[this._filters.length-1]:e}get filters(){return this._filters}addFilters(e){e.forEach(t=>this.addFilter(t))}removeFilters(e){e.forEach(t=>this.removeFilter(t))}}let QB=class extends Uu{constructor(t,r,i,o=0){super();oe(this,"context");oe(this,"source");oe(this,"gainNode");oe(this,"panner");this.source=t,this.gainNode=r,this.context=i,this.panner=i.createPanner(),t.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}get isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(t){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=t}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.enabled=!0)}addFilter(t){super.addFilter(t),this.refreshFilters()}removeFilter(t){super.removeFilter(t),this.refreshFilters()}set position(t){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,o]=t;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=o}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.source;this.source.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(t){}},JB=class extends Uu{constructor(t){super();oe(this,"context");oe(this,"_position",[0,0,0]);oe(this,"loopCount",0);oe(this,"prevVolume",1);oe(this,"microphoneGainNode");oe(this,"streamPlayback");oe(this,"stream");oe(this,"streamSource");this.context=t,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(t=>{this.stream=t,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new QB(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(t=>{console.error("Error initializing microphone stream:",t)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(t){}get isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(t){this.streamPlayback&&this.streamPlayback.addFilter(t)}removeFilter(t){this.streamPlayback&&this.streamPlayback.removeFilter(t)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(t){this.streamPlayback&&(this.streamPlayback.volume=t)}get position(){return[0,0,0]}set position(t){}loop(t){return 0}get playbackRate(){return 1}set playbackRate(t){}};function gE(n){class e extends n{constructor(){super(...arguments);oe(this,"playbacks",[]);oe(this,"_position",[0,0,0]);oe(this,"_stereoPan",0);oe(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});oe(this,"_volume",1)}play(){const i=this.preplay();return i.forEach(o=>o.play()),i}stop(){this.playbacks.forEach(i=>i.stop()),this.playbacks=[]}pause(){this.playbacks.forEach(i=>i.pause())}addFilter(i){super.addFilter(i),this.playbacks.forEach(o=>o.addFilter(i))}removeFilter(i){super.removeFilter(i),this.playbacks.forEach(o=>o.removeFilter(i))}get isPlaying(){return this.playbacks.some(i=>i.isPlaying)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}set position(i){this._threeDOptions.positionX=i[0],this._threeDOptions.positionY=i[1],this._threeDOptions.positionZ=i[2],this.playbacks.forEach(o=>o.position=i)}get threeDOptions(){return this._threeDOptions}set threeDOptions(i){this._threeDOptions={...this._threeDOptions,...i},this.playbacks.forEach(o=>o.threeDOptions=this._threeDOptions)}get stereoPan(){return this._stereoPan}set stereoPan(i){this._stereoPan=i,this.playbacks.forEach(o=>o.stereoPan=i)}get volume(){return this._volume}set volume(i){this._volume=i,this.playbacks.forEach(o=>o.volume=i)}}return e}function mE(n){class e extends n{constructor(){super(...arguments);oe(this,"panner");oe(this,"_panType","stereo")}get panType(){return this._panType}setPanType(i,o){this._panType===i&&this.panner||(this.panner&&this.panner.disconnect(),this._panType=i,i==="stereo"?this.panner=o.createStereoPanner():this.panner=o.createPanner())}setPannerNode(i){this.panner=i}get stereoPan(){return this.panType==="stereo"?this.panner.pan.value:null}set stereoPan(i){if(this.panType!=="stereo")throw new Error("Stereo panning is not available when using HRTF.");if(!this.panner)throw new Error("Cannot set stereo pan of a sound that has been cleaned up");i=MI(i,-1,1),this.panner.pan.setValueAtTime(MI(i,-1,1),this.panner.context.currentTime)}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get 3D options of a sound that is not using HRTF");const i=this.panner;return{coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,channelCount:this.panner.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,panningModel:i.panningModel,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,positionX:i.positionX.value,positionY:i.positionY.value,positionZ:i.positionZ.value,orientationX:i.orientationX.value,orientationY:i.orientationY.value,orientationZ:i.orientationZ.value}}set threeDOptions(i){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot set 3D options of a sound that is not using HRTF");const o=this.panner;o.coneInnerAngle=i.coneInnerAngle!==void 0?i.coneInnerAngle:o.coneInnerAngle,o.coneOuterAngle=i.coneOuterAngle!==void 0?i.coneOuterAngle:o.coneOuterAngle,o.coneOuterGain=i.coneOuterGain!==void 0?i.coneOuterGain:o.coneOuterGain,o.distanceModel=i.distanceModel||o.distanceModel,o.maxDistance=i.maxDistance!==void 0?i.maxDistance:o.maxDistance,o.channelCount=i.channelCount!==void 0?i.channelCount:o.channelCount,o.channelCountMode=i.channelCountMode||o.channelCountMode,o.channelInterpretation=i.channelInterpretation||o.channelInterpretation,o.panningModel=i.panningModel||o.panningModel,o.refDistance=i.refDistance!==void 0?i.refDistance:o.refDistance,o.rolloffFactor=i.rolloffFactor!==void 0?i.rolloffFactor:o.rolloffFactor,o.positionX.value=i.positionX!==void 0?i.positionX:o.positionX.value,o.positionY.value=i.positionY!==void 0?i.positionY:o.positionY.value,o.positionZ.value=i.positionZ!==void 0?i.positionZ:o.positionZ.value,o.orientationX.value=i.orientationX!==void 0?i.orientationX:o.orientationX.value,o.orientationY.value=i.orientationY!==void 0?i.orientationY:o.orientationY.value,o.orientationZ.value=i.orientationZ!==void 0?i.orientationZ:o.orientationZ.value}set position(i){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot move a sound that is not using HRTF");const[o,a,s]=i,l=this.panner;l.positionX.value=o,l.positionY.value=a,l.positionZ.value=s}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get position of a sound that is not using HRTF");const i=this.panner;return[i.positionX.value,i.positionY.value,i.positionZ.value]}}return e}function MI(n,e,t){return Math.min(Math.max(n,e),t)}function vE(n){class e extends n{constructor(){super(...arguments);oe(this,"gainNode")}setGainNode(i){this.gainNode=i}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(i){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=i}}return e}class yE extends mE(vE(Uu)){constructor(){super(...arguments);oe(this,"source");oe(this,"_playing",!1);oe(this,"origin")}get isPlaying(){return this.source?this._playing:!1}}class IC extends yE{constructor(t,r,i){super();oe(this,"context");oe(this,"loopCount",0);oe(this,"currentLoop",0);oe(this,"buffer");oe(this,"_offset",0);oe(this,"_startTime",0);oe(this,"_state",0);oe(this,"_playbackRate",1);oe(this,"loopEnded",()=>{!this.source||this._state!==1||(this.currentLoop++,this.loopCount!=="infinite"&&this.currentLoop>this.loopCount?this.stop():(this.seek(0),"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():this.play()))});this.origin=t,this.context=t.context,this.loopCount=t.loopCount,this.setPanType(t.panType,t.context),this.source=r,"buffer"in r&&r.buffer&&(this.buffer=r.buffer),this.setupSourceNode(r),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}setupSourceNode(t){if("mediaElement"in t&&t.mediaElement)t.mediaElement.onended=this.loopEnded;else if("onended"in t)t.onended=this.loopEnded;else throw new Error("Unsupported source type")}get isPlaying(){return this._state===1}get duration(){if(!this.source)throw new Error("Cannot get duration of a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.duration:this.buffer?this.buffer.duration||NaN:NaN}get playbackRate(){return this._playbackRate}set playbackRate(t){if(t<=0)throw new Error("Playback rate must be greater than 0");if(this._state===1){const r=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=r,this._startTime=this.context.currentTime}this._playbackRate=t,this.source&&("playbackRate"in this.source&&(this.source.playbackRate.value=t),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=t))}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return this._state===1?[this]:(this._state===2?"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():(this.recreateSource(),"start"in this.source&&this.source.start&&this.source.start(0,this._offset)):"mediaElement"in this.source&&this.source.mediaElement?(this.source.mediaElement.currentTime=this._offset,this.source.mediaElement.play()):"start"in this.source&&this.source.start&&(this.recreateSource(),this.source.start(0,this._offset)),this._startTime=this.context.currentTime,this._state=1,[this])}pause(){if(!this.source||this._state!==1)return;const t=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=t,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.pause():"stop"in this.source&&this.source.stop(),this._state=2}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this._state===3||this._state===0||("stop"in this.source&&this._state===1&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this._offset=0,this._startTime=0,this._state=3)}seek(t){if(!this.source||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");if(!isFinite(t)||t<0)throw new Error("Invalid time value for seek");const r=this._state===1;r&&this.pause(),this._offset=t,"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.currentTime=t),r&&this.play()}get currentTime(){if(this._state===1){const t=(this.context.currentTime-this._startTime)*this._playbackRate;return this._offset+t}else return this._offset}recreateSource(){if(!this.buffer||!this.panner||!this.context||!this.gainNode)throw new Error("Cannot recreate source of a sound that has been cleaned up");this.source&&(!("mediaElement"in this.source)&&"onended"in this.source&&(this.source.onended=null),this.source.disconnect()),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.panner),this.source.onended=this.loopEnded,this.playbackRate=this._playbackRate,this.refreshFilters()}set sourceLoop(t){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=t),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=t)}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this._filters.forEach(t=>{t&&t.disconnect()}),this._filters=[]}loop(t){if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(t!==void 0&&(this.loopCount=t==="infinite"?"infinite":Math.max(0,t),this.currentLoop=0),"mediaElement"in this.source&&this.source.mediaElement){const r=this.source.mediaElement;r.loop=this.loopCount==="infinite"}else if("loop"in this.source)this.source.loop=this.loopCount==="infinite",this.source.buffer&&(this.source.loopEnd=this.source.buffer.duration,this.source.loopStart=0);else throw new Error("Unsupported source type");return this.loopCount}addFilter(t){const r=this.context.createBiquadFilter();r.type=t.type,r.frequency.value=t.frequency.value,r.Q.value=t.Q.value,r.gain.value=t.gain.value,this._filters.push(r),this.refreshFilters()}removeFilter(t){const r=this._filters.indexOf(t);r!==-1&&this._filters.splice(r,1)[0].disconnect(),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.panner;t.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}clone(t={}){if(!this.source||!this.gainNode||!this.context)throw new Error("Cannot clone a sound that has been cleaned up");const r=t.panType||this.panType,i=this.context.createGain();let o;if("buffer"in this.source&&this.source.buffer)o=this.context.createBufferSource(),o.buffer=this.source.buffer;else if("mediaElement"in this.source&&this.source.mediaElement)o=this.context.createMediaElementSource(this.source.mediaElement);else throw new Error("Unsupported source type");const a=t.loopCount!==void 0?t.loopCount:this.loopCount,s=new IC(this.origin,o,i);return s.loopCount=a,s.currentLoop=this.currentLoop,s.setPanType(r,this.context),s.volume=this.volume,s.playbackRate=this._playbackRate,s._offset=this._offset,s._state=this._state,this._filters.forEach(l=>{const f=this.context.createBiquadFilter();f.type=l.type,f.frequency.value=l.frequency.value,f.Q.value=l.Q.value,f.gain.value=l.gain.value,s.addFilter(f)}),this._state===1&&s.play(),s}}let _h=class CE extends gE(Uu){constructor(t,r,i,o,a=Qd.Buffer,s="HRTF"){super();oe(this,"buffer");oe(this,"context");oe(this,"loopCount",0);oe(this,"_playbackRate",1);this.url=t,this.globalGainNode=o,this.soundType=a,this.panType=s,this.buffer=r,this.context=i}clone(t={}){const r=t.panType||this.panType,i=t.stereoPan!==void 0?t.stereoPan:this.stereoPan,o=t.threeDOptions||this.threeDOptions,a=t.loopCount!==void 0?t.loopCount:this.loopCount,s=t.playbackRate||this.playbackRate,l=t.volume!==void 0?t.volume:this.volume,f=t.position!==void 0?t.position:this.position,h=t.filters&&t.filters.length?t.filters:this._filters,m=new CE(this.url,this.buffer,this.context,this.globalGainNode,this.soundType,r);return m.loop(a),m.playbackRate=s,m.volume=l,r==="HRTF"?(m.threeDOptions=o,m.position=f):m.stereoPan=i,m.addFilters(h),m}preplay(){let t;if(this.buffer)t=this.context.createBufferSource(),t.buffer=this.buffer;else{const o=new Audio;o.crossOrigin="anonymous",o.src=this.url,o.preload="auto",t=this.context.createMediaElementSource(o)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new IC(this,t,r);return i.setGainNode(r),i.volume=this.volume,i.playbackRate=this.playbackRate,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}seek(t){this.playbacks.forEach(r=>r.seek(t))}get duration(){var t;return this.playbacks.length>0?this.playbacks[0].duration:((t=this.buffer)==null?void 0:t.duration)||NaN}loop(t){return t===void 0?this.loopCount:(this.loopCount=t,this.playbacks.forEach(r=>r.loop(t)),this.loopCount)}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this.playbacks.forEach(r=>r.playbackRate=t)}};function eO(n){class e extends yE{constructor(){super(...arguments);oe(this,"_oscillatorOptions",{})}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(i){this._oscillatorOptions=i,this.source&&this.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type))}play(){if(!this.source)throw new Error("No source node found");return this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type),this.source.start(),this._playing=!0,[this]}stop(){this.source&&this.source.stop&&(this.source.stop(),this._playing=!1)}pause(){this.stop()}get frequency(){return this.source.frequency.value}set frequency(i){this.source.frequency.value=i,this.oscillatorOptions.frequency=i}get detune(){return this.source.detune.value}set detune(i){this.source.detune.value=i,this.oscillatorOptions.detune=i}get type(){return this.source.type}set type(i){this.source.type=i,this.oscillatorOptions.type=i}}return e}class tO extends eO(mE(vE(Uu))){constructor(t,r,i){super();oe(this,"context");this.origin=t,this.source=r,this.context=t.context,this.setPanType(t.panType,t.context),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.panner;t.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}}class wC extends gE(Uu){constructor(t,r,i=Qd.Oscillator,o="HRTF",a={}){super();oe(this,"_oscillatorOptions");oe(this,"playbacks",[]);this.context=t,this.globalGainNode=r,this.soundType=i,this.panType=o,this.context=t,this._oscillatorOptions=a}clone(t={}){const r=t.panType||this.panType,i=t.stereoPan!==void 0?t.stereoPan:this.stereoPan??0,o=t.threeDOptions||this.threeDOptions,a=t.volume!==void 0?t.volume:this.volume,s=t.position&&t.position.length?t.position:this.position,l=t.filters&&t.filters.length?t.filters:this._filters,f=t.oscillatorOptions||this._oscillatorOptions,h=new wC(this.context,this.globalGainNode,this.soundType,r,f);return h._volume=a,h._position=s,h._stereoPan=i,h._threeDOptions=o,h.addFilters(l),h}preplay(){const t=this.context.createOscillator();this.oscillatorOptions.detune&&(t.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(t.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(t.type=this.oscillatorOptions.type);const r=this.context.createGain();r.connect(this.globalGainNode);const i=new tO(this,t,r);return i.volume=this.volume,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(t){this._oscillatorOptions=t,this.playbacks.forEach(r=>{r.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(r.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(r.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(r.source.type=this.oscillatorOptions.type))})}get frequency(){return this.oscillatorOptions.frequency||440}set frequency(t){this._oscillatorOptions.frequency=t,this.playbacks.forEach(r=>r.frequency=t)}get detune(){return this.oscillatorOptions.detune}set detune(t){this._oscillatorOptions.detune=t,this.playbacks.forEach(r=>r.detune=t)}get type(){return this.oscillatorOptions.type||"sine"}set type(t){this._oscillatorOptions.type=t,this.playbacks.forEach(r=>r.type=t)}}var Qd=(n=>(n.HTML="HTML",n.Streaming="Streaming",n.Buffer="Buffer",n.Oscillator="oscillator",n))(Qd||{});let nO=class{constructor(e,t){oe(this,"context");oe(this,"globalGainNode");oe(this,"listener");oe(this,"prevVolume",1);oe(this,"finalizationRegistry");oe(this,"cache");oe(this,"createBiquadFilter",({type:e,frequency:t,gain:r,Q:i})=>{t===void 0&&(t=350);const o=this.context.createBiquadFilter();return o.type=e||"lowpass",o.frequency.value=t,o.gain.value=r||0,o.Q.value=i||1,o});this.context=e||new VB,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.cache=t||new Wv,this.finalizationRegistry=new FinalizationRegistry(r=>{r.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",YB):console.warn("AudioWorklet not supported")}async createWorkletNode(e,t){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new _I(this.context,e)}catch(r){console.error(r),console.log("Loading worklet from url",t);try{await this.context.audioWorklet.addModule(t)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${t}`)}return new _I(this.context,e)}}clearMemoryCache(){this.cache.clearMemoryCache()}createOscillator(e,t="HRTF"){return new wC(this.context,this.globalGainNode,"oscillator",t,e)}async createSound(e,t="Buffer",r="HRTF"){if(typeof e=="object")return Promise.resolve(new _h("",e,this.context,this.globalGainNode,"Buffer",r));const i=e;if(t==="HTML"){const o=new Audio;return o.src=i,o.crossOrigin="anonymous",new _h(i,void 0,this.context,this.globalGainNode,"HTML",r)}return this.cache.getAudioBuffer(this.context,i).then(o=>new _h(i,o,this.context,this.globalGainNode,t,r))}async createGroup(e){const t=new DI;return e.forEach(r=>t.addSound(r)),t}async createGroupFromUrls(e,t="Buffer",r="HRTF"){const i=new DI;return(await Promise.all(e.map(o=>this.createSound(o,t,r)))).forEach(o=>i.addSound(o)),i}async createStream(e){return new _h(e,void 0,this.context,this.globalGainNode,"Streaming")}createPanner({coneInnerAngle:e,coneOuterAngle:t,coneOuterGain:r,distanceModel:i,maxDistance:o,channelCount:a,channelCountMode:s,channelInterpretation:l,panningModel:f,refDistance:h,rolloffFactor:m,positionX:g,positionY:y,positionZ:C,orientationX:x,orientationY:w,orientationZ:S}){const A=this.context.createPanner();return A.coneInnerAngle=e||360,A.coneOuterAngle=t||360,A.coneOuterGain=r||0,A.distanceModel=i||"inverse",A.maxDistance=o||1e4,A.channelCount=a||2,A.channelCountMode=s||"clamped-max",A.channelInterpretation=l||"speakers",A.panningModel=f||"HRTF",A.refDistance=h||1,A.rolloffFactor=m||1,A.positionX.value=g||0,A.positionY.value=y||0,A.positionZ.value=C||0,A.orientationX.value=x||0,A.orientationY.value=w||0,A.orientationZ.value=S||0,A}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,t)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new JB(this.context);i.play(),e(i)}).catch(r=>{t(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:t,up:r}=e,[i,o,a]=t,[s,l,f]=r;this.listener.forwardX.value=i,this.listener.forwardY.value=o,this.listener.forwardZ.value=a,this.listener.upX.value=s,this.listener.upY.value=l,this.listener.upZ.value=f}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[t,r,i]=e;this.listener.upX.value=t,this.listener.upY.value=r,this.listener.upZ.value=i}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[t,r,i]=e;this.listener.forwardX.value=t,this.listener.forwardY.value=r,this.listener.forwardZ.value=i}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[t,r,i]=e,o=this.context.currentTime;this.listener.positionX.setValueAtTime(t,o),this.listener.positionY.setValueAtTime(r,o),this.listener.positionZ.setValueAtTime(i,o)}};const rO="https://mongoose.world:9080/?url=";class iO extends $n{constructor(){super(...arguments);oe(this,"packageName","Client.Media");oe(this,"sounds",{});oe(this,"defaultUrl","")}handleDefault(t){this.defaultUrl=t}async handleLoad(t){const r=(t.url||this.defaultUrl)+t.name,i=t.url+t.name;if(!this.sounds[i]){let a=await this.client.cacophony.createSound(r);a.key=i,this.sounds[i]=a}}mediaUrl(t){var i;let r=(t.url||this.defaultUrl)+t.name;return((i=t.type)==null?void 0:i.toLowerCase())==="music"&&(r=rO+encodeURIComponent(r)),r}async handlePlay(t){let r=this.mediaUrl(t);t.key=t.key||r;let i=this.sounds[t.key];const o=t.is3d?"HRTF":"stereo";if((!i||i.url!==r)&&(t.type==="music"?i=await this.client.cacophony.createSound(r,Qd.HTML,o):i=await this.client.cacophony.createSound(r,Qd.Buffer,o)),t.volume!==void 0&&(i.volume=t.volume/100),t.loops!==void 0){const a=t.loops===-1?1/0:t.loops-1;i.loop(a)}if(t.start&&i.seek(t.start/1e3),t.end&&setTimeout(()=>{delete this.sounds[i.key],i.stop()},t.end),t.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[t.position[0],t.position[1],t.position[2]]),t.priority){for(let a in this.sounds){const s=this.sounds[a];s.priority&&s.priority<t.priority&&s.stop()}i.priority=t.priority}i.isPlaying||(i.play()[0],t.fadein,t.fadeout),i.key=t.key,this.sounds[i.key]=i}handleStop(t){t.name&&this.soundsByName(t.name).forEach(r=>this.stopSound(r)),t.type&&this.soundsByType(t.type).forEach(r=>this.stopSound(r)),t.tag&&this.soundsByTag(t.tag).forEach(r=>this.stopSound(r)),t.key&&this.soundsByKey(t.key).forEach(r=>this.stopSound(r)),!t.name&&!t.type&&!t.tag&&!t.key&&(this.allSounds.forEach(r=>r.stop()),this.sounds={})}stopSound(t){delete this.sounds[t.key],t.stop()}handleListenerPosition(t){var r;(r=t.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=t.position)}handleListenerOrientation(t){t.up&&t.up.length&&(this.client.cacophony.listenerUpOrientation=t.up),t.forward&&t.forward.length&&(this.client.cacophony.listenerForwardOrientation=t.forward)}soundsByName(t){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(t))}soundsByKey(t){return Object.values(this.sounds).filter(r=>r.key===t)}soundsByTag(t){return Object.values(this.sounds).filter(r=>r.tag===t)}soundsByType(t){return Object.values(this.sounds).filter(r=>r.mediaType===t)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(t=>t.stop()),this.sounds={}}}var Hh={exports:{}},Nm,NI;function oO(){return NI||(NI=1,Nm=void 0),Nm}var sO=Hh.exports,BI;function aO(){return BI||(BI=1,function(n,e){(function(t,r){n.exports=r()})(sO,function(){var t=typeof window>"u"?Gh:window,r="1.9.3",i,o,a,s,l,f=Date.now||function(){return new Date().getTime()},h=f(),m=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return f()-h},g=function(u){setTimeout(u,0)};function y(){}function C(u){return typeof u=="function"}function x(){this._orig=this,this._ready=!1,this._queue=[],this._log=[]}x.prototype._exec=function(){for(;this._ready&&this._queue.length;){var u=this._queue.shift();u[0].apply(this,u[1])}},x.prototype._push=function(u,p){this._queue.push([u,p]),x.prototype._exec.apply(this)},x.prototype._slip=function(u,p){this._queue.unshift([u,p])},x.prototype._pause=function(){this._ready=!1},x.prototype._resume=function(){this._ready=!0,x.prototype._exec.apply(this)},x.prototype._break=function(u){this._orig._bad=!0,this._orig._log.push(u||"Unknown JZZ error")},x.prototype._repair=function(){this._orig._bad=!1},x.prototype._crash=function(u){this._break(u),this._resume()},x.prototype._err=function(){return this._log[this._log.length-1]},x.prototype.log=function(){return Z(this._log)},x.prototype._dup=function(){var u=function(){};u.prototype=this._orig;var p=new u;return p._ready=!1,p._queue=[],p},x.prototype._image=function(){return this._dup()},x.prototype._thenable=function(){if(this.then)return this;var u=this,p=function(){};p.prototype=u;var I=new p;return I.then=function(U,W){return u._push(w,[U,W]),this},I};function w(u,p){this._bad?C(p)&&p.apply(this,[new Error(this._err())]):C(u)&&u.apply(this,[this])}function S(u,p){this._bad?u._crash(this._err()):setTimeout(function(){u._resume()},p)}x.prototype.wait=function(u){if(!u)return this;var p=this._image();return this._push(S,[p,u]),p._thenable()};function A(u){this._bad&&u._break(this._err()),u._resume()}function E(u,p,I){u[I]=function(){var U=arguments,W=p._image();return this._push(A,[W]),W[I].apply(W,U)}}function _(u){this._bad||(C(u)?u.apply(this):console.log(u))}x.prototype.and=function(u){return this._push(_,[u]),this._thenable()};function T(u){this._bad&&(C(u)?u.apply(this):console.log(u))}x.prototype.or=function(u){return this._push(T,[u]),this._thenable()},x.prototype._info={},x.prototype.info=function(){var u=Z(this._orig._info);return typeof u.engine>"u"&&(u.engine="none"),typeof u.sysex>"u"&&(u.sysex=!0),u},x.prototype.name=function(){return this.info().name};function M(u){this._bad?u._crash(this._err()):(this._break("Closed"),u._resume())}x.prototype.close=function(){var u=new x;return this._close&&this._push(this._close,[]),this._push(M,[u]),u._thenable()};function P(u){if(!u.length){this._break();return}var p=u.shift();if(u.length){var I=this;this._slip(T,[function(){P.apply(I,[u])}])}try{this._repair(),p.apply(this)}catch(U){this._break(U.toString())}}function j(u,p){for(var I=0;I<u.length;I++)if(u[I]===p)return;u.push(p)}function X(u,p){for(var I=0;I<u.length;I++)if(u[I]===p){u.splice(I,1);return}}function L(){x.apply(this)}L.prototype=new x;function G(u,p){for(var I in u)u.hasOwnProperty(I)&&p.call(this,I)}function Z(u,p,I){if(typeof p>"u")return Z(u,[],[]);if(u instanceof Object){for(var U=0;U<p.length;U++)if(p[U]===u)return I[U];var W;return u instanceof Array?W=[]:W={},p.push(u),I.push(W),G(u,function(se){W[se]=Z(u[se],p,I)}),W}return u}L.prototype._info={name:"JZZ.js",ver:r,version:r,inputs:[],outputs:[]};var ne=[],pe=[],ve=[],Se=[],Ne={},xe={};function Ae(){ct._info.engine=ce._type,ct._info.version=ce._version,ct._info.sysex=ce._sysex,ct._info.inputs=[],ct._info.outputs=[],ne=[],pe=[],ce._allOuts={},ce._allIns={};var u,p;for(u=0;u<ce._outs.length;u++)p=ce._outs[u],!Ne[p.name]&&(p.engine=ce,ce._allOuts[p.name]=p,ct._info.outputs.push({id:p.name,name:p.name,manufacturer:p.manufacturer,version:p.version,engine:ce._type}),ne.push(p));for(u=0;u<nn._outs.length;u++)p=nn._outs[u],!Ne[p.name]&&(ct._info.outputs.push({id:p.name,name:p.name,manufacturer:p.manufacturer,version:p.version,engine:p.type}),ne.push(p));for(u=0;u<ce._ins.length;u++)p=ce._ins[u],!xe[p.name]&&(p.engine=ce,ce._allIns[p.name]=p,ct._info.inputs.push({id:p.name,name:p.name,manufacturer:p.manufacturer,version:p.version,engine:ce._type}),pe.push(p));for(u=0;u<nn._ins.length;u++)p=nn._ins[u],!xe[p.name]&&(ct._info.inputs.push({id:p.name,name:p.name,manufacturer:p.manufacturer,version:p.version,engine:p.type}),pe.push(p));if(ct._watcher&&ct._watcher._handles.length){var I=Ht(Se,ve,ct._info.inputs,ct._info.outputs);if(I){for(o=0;o<I.inputs.removed.length;o++)p=ce._inMap[I.inputs.removed[o].name],p&&p._closeAll();for(o=0;o<I.outputs.removed.length;o++)p=ce._outMap[I.outputs.removed[o].name],p&&p._closeAll();g(function(){on(I)})}}Se=ct._info.inputs,ve=ct._info.outputs}function ke(){this._bad||ce._refresh(this)}L.prototype.refresh=function(){return this._push(ke,[]),this._thenable()};function H(u,p){var I,U;C(u)&&(u=u(p)),u instanceof Array||(u=[u]);var W=[],se=[],fe=p.slice(),$e=W;for(I=0;I<u.length;I++)if(typeof u[I]>"u")$e=se;else if(u[I]instanceof RegExp)for(U=0;U<fe.length;U++)u[I].test(fe[U].name)&&($e.push(fe[U]),fe.splice(U,1),U--);else for(U=0;U<fe.length;U++)(u[I]+""==U+""||u[I]===fe[U].name||u[I]instanceof Object&&u[I].name===fe[U].name)&&($e.push(fe[U]),fe.splice(U,1),U--);return $e==W?W:W.concat(fe).concat(se)}function ee(u,p){var I;p instanceof RegExp?I="Port matching "+p+" not found":p instanceof Object||typeof p>"u"?I="Port not found":I='Port "'+p+'" not found',u._crash(I)}function ae(u,p){if(this._bad)u._crash(this._err());else{var I=H(p,ne);if(!I.length){ee(u,p);return}for(var U=function(se){return function(){se.engine._openOut(this,se.name)}},W=0;W<I.length;W++)I[W]=U(I[W]);u._slip(P,[I]),u._resume()}}L.prototype.openMidiOut=function(u){var p=new _e;return this._push(ke,[]),this._push(ae,[p,u]),p._thenable()},L.prototype._openMidiOutNR=function(u){var p=new _e;return this._push(ae,[p,u]),p._thenable()};function ye(u,p){if(this._bad)u._crash(this._err());else{var I=H(p,pe);if(!I.length){ee(u,p);return}for(var U=function(se){return function(){se.engine._openIn(this,se.name)}},W=0;W<I.length;W++)I[W]=U(I[W]);u._slip(P,[I]),u._resume()}}L.prototype.openMidiIn=function(u){var p=new _e;return this._push(ke,[]),this._push(ye,[p,u]),p._thenable()},L.prototype._openMidiInNR=function(u){var p=new _e;return this._push(ye,[p,u]),p._thenable()};function Ee(u,p){this._bad?u._crash():(u._slip(Vt,[p]),u._resume())}L.prototype.onChange=function(u){this._orig._watcher||(this._orig._watcher=new lt);var p=this._orig._watcher._image();return this._push(Ee,[p,u]),p._thenable()},L.prototype._close=function(){ce._close();for(var u=pn.slice(),p=0;p<u.length;p++)u[p]&&(u[p]._close?u[p]._close():u[p].close&&u[p].close())};function _e(){x.apply(this),this._handles=[],this._outs=[]}_e.prototype=new x,_e.prototype._filter=function(u){if(this._orig._mpe){var p,I=0;this._handles&&this._handles.length&&(I=this._handles.length,p=this._handles[0]),this._outs&&this._outs.length&&(I=this._outs.length,p=this._outs[0]),I==1&&!p._mpe&&(u=this._orig._mpe.filter(u))}return u},_e.prototype._receive=function(u){this._emit(this._filter(u))};function Je(u){this._bad||this._receive(u)}_e.prototype.send=function(){return this._push(Je,[me.apply(null,arguments)]),this._thenable()},_e.prototype.note=function(u,p,I,U){return this.noteOn(u,p,I),typeof this._ch>"u"&&typeof this._master>"u"?U>0&&this.wait(U).noteOff(u,p):I>0&&this.wait(I).noteOff(u),this._thenable()};function me(u){return u.isMidi2?new Ct(u):J.apply(null,arguments)}_e.prototype._emit=function(u){var p,I;for(p=0;p<this._handles.length;p++)I=me(u),this._handles[p].apply(this,[I._stamp(this)]);for(p=0;p<this._outs.length;p++)I=me(u),I._stamped(this._outs[p])||this._outs[p].send(I._stamp(this))};function it(u){this._emit(u)}_e.prototype.emit=function(u){return this._push(it,[u]),this._thenable()};function Tt(u){C(u)?j(this._orig._handles,u):j(this._orig._outs,u)}function Xt(u){typeof u>"u"?(this._orig._handles=[],this._orig._outs=[]):C(u)?X(this._orig._handles,u):X(this._orig._outs,u)}_e.prototype.connect=function(u){return this._push(Tt,[u]),this._thenable()},_e.prototype.disconnect=function(u){return this._push(Xt,[u]),this._thenable()},_e.prototype.connected=function(){return this._orig._handles.length+this._orig._outs.length},_e.prototype._image=function(){var u=this._dup();return u._gr=this._gr,u._ch=this._ch,u._sxid=this._sxid,u._master=this._master,u._band=this._band,u},_e.prototype._sxid=127,_e.prototype.sxId=function(u){if(typeof u>"u"&&(u=_e.prototype._sxid),u==this._sxid)return this._thenable();u=He(u);var p=this._image();return p._sxid=u,this._push(A,[p]),p._thenable()},_e.prototype.ch=function(u){if(u==this._ch||typeof u>"u"&&typeof this._ch>"u")return this._thenable();var p=this._image();return typeof u<"u"&&(u=Fe(u)),p._ch=u,p._master=void 0,p._band=void 0,this._push(A,[p]),p._thenable()},_e.prototype.MIDI1=function(){var u=this._image();return u._ch=void 0,u._sxid=_e.prototype._sxid,u._master=void 0,u._band=void 0,this._push(A,[u]),u._thenable()},_e.prototype.MIDI2=function(){var u=this._image();u._ch=void 0,u._sxid=_e.prototype._sxid,u._master=void 0,u._band=void 0;var p=new Dt(u);return this._push(A,[p]),p._thenable()};function Et(u,p){this._orig._mpe||(this._orig._mpe=new yr),this._orig._mpe.setup(u,p)}_e.prototype.mpe=function(u,p){if(u==this._master&&p==this._band||typeof u>"u"&&typeof this._master>"u")return this._thenable();if(typeof u<"u"&&yr.validate(u,p),!p)return this.ch(u);var I=this._image();return I._ch=void 0,I._master=u,I._band=p,this._push(Et,[u,p]),this._push(A,[I]),I._thenable()};function St(u){if(u!=parseInt(u)||u<0||u>15)throw RangeError("Bad channel value (must not be less than 0 or more than 15): "+u)}function Dt(u){x.apply(this),this._sink=u}Dt.prototype=new x,Dt.prototype._sxid=_e.prototype._sxid,Dt.prototype._receive=function(u){this._sink._receive(u)};function at(u){return u.isMidi&&!u.isMidi2?new J(u):Ct.apply(null,arguments)}Dt.prototype.send=function(){return this._push(Je,[at.apply(null,arguments)]),this._thenable()},Dt.prototype._image=_e.prototype._image,Dt.prototype.connect=function(u){return this._sink.connect(u),this._push(A,[this._sink]),this._thenable()},Dt.prototype.disconnect=function(u){return this._sink.disconnect(u),this._push(A,[this._sink]),this._thenable()},Dt.prototype.connected=function(){return this._sink.connected()},Dt.prototype.sxId=_e.prototype.sxId,Dt.prototype.ch=_e.prototype.ch,Dt.prototype.gr=function(u){if(u==this._gr||typeof u>"u"&&typeof this._gr>"u")return this._thenable();var p=this._image();return typeof u<"u"&&(u=He(u)),p._gr=u,this._push(A,[p]),p._thenable()},Dt.prototype.MIDI1=function(){var u=this._sink._image();return this._push(A,[u]),u._thenable()},Dt.prototype.MIDI2=function(){var u=this._image();return u._gr=void 0,u._ch=void 0,u._sxid=_e.prototype._sxid,this._push(A,[u]),u._thenable()};function lt(){x.apply(this),this._handles=[],E(this,ct,"refresh"),E(this,ct,"openMidiOut"),E(this,ct,"openMidiIn"),E(this,ct,"onChange"),E(this,ct,"close")}lt.prototype=new x;function Vt(u){C(u)&&(this._orig._handles.length||ce._watch(),j(this._orig._handles,u))}function Gt(u){typeof u>"u"?this._orig._handles=[]:X(this._orig._handles,u),this._orig._handles.length||ce._unwatch()}lt.prototype.connect=function(u){return this._push(Vt,[u]),this._thenable()},lt.prototype.disconnect=function(u){return this._push(Gt,[u]),this._thenable()};function Pt(u,p,I,U){var W;if(u.length!=I.length||p.length!=U.length)return!0;for(W=0;W<u.length;W++)if(u[W].name!=I[W].name)return!0;for(W=0;W<p.length;W++)if(p[W].name!=U[W].name)return!0;return!1}function Ht(u,p,I,U){if(Pt(u,p,I,U)){var W=[],se=[],fe=[],$e=[],qe,vt={};for(qe=0;qe<u.length;qe++)vt[u[qe].name]=!0;for(qe=0;qe<I.length;qe++)vt[I[qe].name]||W.push(I[qe]);for(vt={},qe=0;qe<I.length;qe++)vt[I[qe].name]=!0;for(qe=0;qe<u.length;qe++)vt[u[qe].name]||fe.push(u[qe]);for(vt={},qe=0;qe<p.length;qe++)vt[p[qe].name]=!0;for(qe=0;qe<U.length;qe++)vt[U[qe].name]||se.push(U[qe]);for(vt={},qe=0;qe<U.length;qe++)vt[U[qe].name]=!0;for(qe=0;qe<p.length;qe++)vt[p[qe].name]||$e.push(p[qe]);return{inputs:{added:W,removed:fe},outputs:{added:se,removed:$e}}}}function on(u){for(i=0;i<ct._watcher._handles.length;i++)ct._watcher._handles[i].apply(ct,[u])}var ct,ce={_outs:[],_ins:[],_close:y},nn={_outs:[],_ins:[]},pn=[];function Un(){if(n.exports){var u=oO();if(u){Sr(u);return}}this._break()}function q(){var u=document.createElement("div");u.style.visibility="hidden",document.body.appendChild(u);var p=document.createElement("object");if(p.style.visibility="hidden",p.style.width="0px",p.style.height="0px",p.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",p.type="audio/x-jazz",document.body.appendChild(p),p.isJazz){mr(p);return}this._break()}var N,F;function te(){if(typeof navigator<"u"&&navigator.requestMIDIAccess){N=navigator,F=navigator.requestMIDIAccess;try{F.toString().indexOf("JZZ(")!=-1&&(F=void 0)}catch{}}}function Ce(){if(te(),F){var u=this,p=function(W){Qt(W),u._resume()},I=function(W){u._crash(W)},U={};F.call(N,U).then(p,I),this._pause();return}this._break()}function Pe(){if(te(),F){var u=this,p=function(W){Qt(W,!0),u._resume()},I=function(W){u._crash(W)},U={sysex:!0};F.call(N,U).then(p,I),this._pause();return}this._break()}function Ge(){var u=this,p,I;function U(W){p=!0;var se=W.detail;if(!se){if(I||(I=document.getElementById("jazz-midi-msg")),!I)return;try{se=JSON.parse(I.innerText)}catch{}I.innerText=""}document.removeEventListener("jazz-midi-msg",U),se[0]==="version"?(Yr(I,se[2]),u._resume()):u._crash()}this._pause();try{document.addEventListener("jazz-midi-msg",U),document.dispatchEvent(new Event("jazz-midi"))}catch{}setTimeout(function(){p||u._crash()},50)}function Lt(){this._pause();var u=this;g(function(){u._crash()})}function fn(u){for(var p=[],I=hn(u),U=0;U<I.length;U++)I[U]=="webmidi"?(u&&u.sysex===!0&&p.push(Pe),(!u||u.sysex!==!0||u.degrade===!0)&&p.push(Ce)):I[U]=="node"?(p.push(Un),p.push(Lt)):I[U]=="extension"?p.push(Ge):I[U]=="plugin"&&p.push(q);return p.push(un),p}function hn(u){var p=["node","extension","plugin","webmidi"];if(!u||!u.engine)return p;var I=u.engine instanceof Array?u.engine:[u.engine],U={},W,se,fe=[],$e=[],qe;for(qe=0;qe<I.length;qe++){var vt=I[qe].toString().toLowerCase();U[vt]||(U[vt]=!0,vt==="none"&&(W=!0),(vt==="etc"||typeof vt>"u")&&(se=!0),se?$e.push(vt):fe.push(vt),X(p,vt))}return(se||fe.length||$e.length)&&(W=!1),W?[]:fe.concat(se?p:$e)}function yn(u){ct=new L,ct._options=u,ct._push(P,[fn(u)]),ct.refresh(),ct._resume()}function un(){ce._type="none",ce._version=r,ce._sysex=!0,ce._outs=[],ce._ins=[],ce._outMap={},ce._inMap={},ce._refresh=function(){Ae()},ce._watch=y,ce._unwatch=y,ce._close=y}function On(){ce._inArr=[],ce._outArr=[],ce._inMap={},ce._outMap={},ce._outsW=[],ce._insW=[],ce._version=ce._main.version,ce._sysex=!0;var u;function p(){for(var I=0;I<this.clients.length;I++)this._close(this.clients[I])}ce._refresh=function(){ce._outs=[],ce._ins=[];var I,U;for(I=0;(U=ce._main.MidiOutInfo(I)).length;I++)ce._outs.push({type:ce._type,name:U[0],manufacturer:U[1],version:U[2]});for(I=0;(U=ce._main.MidiInInfo(I)).length;I++)ce._ins.push({type:ce._type,name:U[0],manufacturer:U[1],version:U[2]});Ae()},ce._openOut=function(I,U){var W=ce._outMap[U];if(!W){ce._pool.length<=ce._outArr.length&&ce._pool.push(ce._newPlugin()),W={name:U,clients:[],info:{name:U,manufacturer:ce._allOuts[U].manufacturer,version:ce._allOuts[U].version,type:"MIDI-out",sysex:ce._sysex,engine:ce._type},_close:function($e){ce._closeOut($e)},_closeAll:p,_receive:function($e){$e.length&&this.plugin.MidiOutRaw($e.slice())}};var se=ce._pool[ce._outArr.length];W.plugin=se,ce._outArr.push(W),ce._outMap[U]=W}if(!W.open){var fe=W.plugin.MidiOutOpen(U);if(fe!==U){fe&&W.plugin.MidiOutClose(),I._break();return}W.open=!0}I._orig._impl=W,j(W.clients,I._orig),I._info=W.info,I._receive=function($e){W._receive($e)},I._close=function(){W._close(this)}},ce._openIn=function(I,U){var W=ce._inMap[U];if(!W){ce._pool.length<=ce._inArr.length&&ce._pool.push(ce._newPlugin()),W={name:U,clients:[],info:{name:U,manufacturer:ce._allIns[U].manufacturer,version:ce._allIns[U].version,type:"MIDI-in",sysex:ce._sysex,engine:ce._type},_close:function(qe){ce._closeIn(qe)},_closeAll:p,handle:function(qe,vt){for(var br=0;br<this.clients.length;br++){var Lo=J(vt);this.clients[br]._emit(Lo)}}};var se=function(qe){return function(vt,br){qe.handle(vt,br)}};W.onmidi=se(W);var fe=ce._pool[ce._inArr.length];W.plugin=fe,ce._inArr.push(W),ce._inMap[U]=W}if(!W.open){var $e=W.plugin.MidiInOpen(U,W.onmidi);if($e!==U){$e&&W.plugin.MidiInClose(),I._break();return}W.open=!0}I._orig._impl=W,j(W.clients,I._orig),I._info=W.info,I._close=function(){W._close(this)}},ce._closeOut=function(I){var U=I._impl;X(U.clients,I._orig),!U.clients.length&&U.open&&(U.open=!1,U.plugin.MidiOutClose())},ce._closeIn=function(I){var U=I._impl;X(U.clients,I._orig),!U.clients.length&&U.open&&(U.open=!1,U.plugin.MidiInClose())},ce._close=function(){for(var I=0;I<ce._inArr.length;I++)ce._inArr[I].open&&ce._inArr[I].plugin.MidiInClose();ce._unwatch()},ce._watch=function(){u||(u=setInterval(function(){ce._refresh()},250))},ce._unwatch=function(){u&&clearInterval(u),u=void 0}}function Sr(u){ce._type="node",ce._main=u,ce._pool=[],ce._newPlugin=function(){return new u.MIDI},On()}function mr(u){ce._type="plugin",ce._main=u,ce._pool=[u],ce._newPlugin=function(){var p=document.createElement("object");return p.style.visibility="hidden",p.style.width="0px",u.style.height="0px",p.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",p.type="audio/x-jazz",document.body.appendChild(p),p.isJazz?p:void 0},On()}function Qt(u,p){ce._type="webmidi",ce._version=43,ce._sysex=!!p,ce._access=u,ce._inMap={},ce._outMap={},ce._outsW=[],ce._insW=[];var I;function U(){for(var W=0;W<this.clients.length;W++)this._close(this.clients[W])}ce._refresh=function(){ce._outs=[],ce._ins=[],ce._access.outputs.forEach(function(W){ce._outs.push({type:ce._type,name:W.name,manufacturer:W.manufacturer,version:W.version})}),ce._access.inputs.forEach(function(W){ce._ins.push({type:ce._type,name:W.name,manufacturer:W.manufacturer,version:W.version})}),Ae()},ce._openOut=function(W,se){var fe=ce._outMap[se];fe||(fe={name:se,clients:[],info:{name:se,manufacturer:ce._allOuts[se].manufacturer,version:ce._allOuts[se].version,type:"MIDI-out",sysex:ce._sysex,engine:ce._type},_close:function(qe){ce._closeOut(qe)},_closeAll:U,_receive:function(qe){fe.dev&&qe.length&&this.dev.send(qe.slice())}});var $e;ce._access.outputs.forEach(function(qe){qe.name===se&&($e=qe)}),$e?(fe.dev=$e,ce._outMap[se]=fe,W._orig._impl=fe,j(fe.clients,W._orig),W._info=fe.info,W._receive=function(qe){fe._receive(qe)},W._close=function(){fe._close(this)},fe.dev.open&&(W._pause(),fe.dev.open().then(function(){W._resume()},function(){W._crash()}))):W._break()},ce._openIn=function(W,se){var fe=ce._inMap[se];fe||(fe={name:se,clients:[],info:{name:se,manufacturer:ce._allIns[se].manufacturer,version:ce._allIns[se].version,type:"MIDI-in",sysex:ce._sysex,engine:ce._type},_close:function(vt){ce._closeIn(vt)},_closeAll:U,handle:function(vt){for(var br=0;br<this.clients.length;br++){var Lo=J([].slice.call(vt.data));this.clients[br]._emit(Lo)}}});var $e;if(ce._access.inputs.forEach(function(vt){vt.name===se&&($e=vt)}),$e){fe.dev=$e;var qe=function(vt){return function(br){vt.handle(br)}};fe.dev.onmidimessage=qe(fe),ce._inMap[se]=fe,W._orig._impl=fe,j(fe.clients,W._orig),W._info=fe.info,W._close=function(){fe._close(this)},fe.dev.open&&(W._pause(),fe.dev.open().then(function(){W._resume()},function(){W._crash()}))}else W._break()},ce._closeOut=function(W){var se=W._impl;X(se.clients,W._orig),se.clients.length||(se.dev&&se.dev.close&&se.dev.close(),se.dev=void 0)},ce._closeIn=function(W){var se=W._impl;X(se.clients,W._orig),se.clients.length||(se.dev&&(se.dev.onmidimessage=null,se.dev.close&&se.dev.close()),se.dev=void 0)},ce._close=function(){ce._unwatch()},ce._watch=function(){ce._access.onstatechange=function(){I=!0,g(function(){I&&(ce._refresh(),I=!1)})}},ce._unwatch=function(){ce._access.onstatechange=void 0}}function Yr(u,p){ce._type="extension",ce._version=p,ce._sysex=!0,ce._pool=[],ce._outs=[],ce._ins=[],ce._inArr=[],ce._outArr=[],ce._inMap={},ce._outMap={},ce._outsW=[],ce._insW=[],ce.refreshClients=[],ce._msg=u,ce._newPlugin=function(){var W={id:ce._pool.length};ce._pool.push(W),W.id?document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["new"]})):W.ready=!0},ce._newPlugin(),ce._refresh=function(W){ce.refreshClients.push(W),W._pause(),g(function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["refresh"]}))})};function I(){for(var W=0;W<this.clients.length;W++)this._close(this.clients[W])}ce._openOut=function(W,se){var fe=ce._outMap[se];if(!fe){ce._pool.length<=ce._outArr.length&&ce._newPlugin();var $e=ce._pool[ce._outArr.length];fe={name:se,clients:[],info:{name:se,manufacturer:ce._allOuts[se].manufacturer,version:ce._allOuts[se].version,type:"MIDI-out",sysex:ce._sysex,engine:ce._type},_start:function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["openout",$e.id,se]}))},_close:function(qe){ce._closeOut(qe)},_closeAll:I,_receive:function(qe){if(qe.length){var vt=qe.slice();vt.splice(0,0,"play",$e.id),document.dispatchEvent(new CustomEvent("jazz-midi",{detail:vt}))}}},fe.plugin=$e,$e.output=fe,ce._outArr.push(fe),ce._outMap[se]=fe}W._orig._impl=fe,j(fe.clients,W._orig),W._info=fe.info,W._receive=function(qe){fe._receive(qe)},W._close=function(){fe._close(this)},fe.open||(W._pause(),fe.plugin.ready&&fe._start())},ce._openIn=function(W,se){var fe=ce._inMap[se];if(!fe){ce._pool.length<=ce._inArr.length&&ce._newPlugin();var $e=ce._pool[ce._inArr.length];fe={name:se,clients:[],info:{name:se,manufacturer:ce._allIns[se].manufacturer,version:ce._allIns[se].version,type:"MIDI-in",sysex:ce._sysex,engine:ce._type},_start:function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["openin",$e.id,se]}))},_close:function(qe){ce._closeIn(qe)},_closeAll:I},fe.plugin=$e,$e.input=fe,ce._inArr.push(fe),ce._inMap[se]=fe}W._orig._impl=fe,j(fe.clients,W._orig),W._info=fe.info,W._close=function(){fe._close(this)},fe.open||(W._pause(),fe.plugin.ready&&fe._start())},ce._closeOut=function(W){var se=W._impl;X(se.clients,W._orig),!se.clients.length&&se.open&&(se.open=!1,document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["closeout",se.plugin.id]})))},ce._closeIn=function(W){var se=W._impl;X(se.clients,W._orig),!se.clients.length&&se.open&&(se.open=!1,document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["closein",se.plugin.id]})))},ce._close=function(){ce._unwatch()};var U;ce._watch=function(){ce._insW=ce._ins,ce._outsW=ce._outs,U=setInterval(function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["refresh"]}))},250)},ce._unwatch=function(){clearInterval(U),U=void 0},document.addEventListener("jazz-midi-msg",function(W){var se,fe,$e,qe=W.detail?[W.detail]:void 0;if(!qe)for(qe=ce._msg.innerText.split(`
`),ce._msg.innerText="",se=0;se<qe.length;se++)try{qe[se]=JSON.parse(qe[se])}catch{qe[se]=[]}for(se=0;se<qe.length;se++){var vt=qe[se];if(vt.length){if(vt[0]==="refresh"){if(vt[1].ins){for(fe=0;fe<vt[1].ins.length;fe++)vt[1].ins[fe].type=ce._type;ce._ins=vt[1].ins}if(vt[1].outs){for(fe=0;fe<vt[1].outs.length;fe++)vt[1].outs[fe].type=ce._type;ce._outs=vt[1].outs}for(Ae(),fe=0;fe<ce.refreshClients.length;fe++)ce.refreshClients[fe]._resume();ce.refreshClients=[]}else if(vt[0]==="version"){var br=ce._pool[vt[1]];br&&(br.ready=!0,br.input&&br.input._start(),br.output&&br.output._start())}else if(vt[0]==="openout"){if($e=ce._pool[vt[1]].output,$e){if(vt[2]==$e.name){if($e.open=!0,$e.clients)for(fe=0;fe<$e.clients.length;fe++)$e.clients[fe]._resume()}else if($e.clients)for(fe=0;fe<$e.clients.length;fe++)$e.clients[fe]._crash()}}else if(vt[0]==="openin"){if($e=ce._pool[vt[1]].input,$e){if(vt[2]==$e.name){if($e.open=!0,$e.clients)for(fe=0;fe<$e.clients.length;fe++)$e.clients[fe]._resume()}else if($e.clients)for(fe=0;fe<$e.clients.length;fe++)$e.clients[fe]._crash()}}else if(vt[0]==="midi"&&($e=ce._pool[vt[1]].input,$e&&$e.clients))for(fe=0;fe<$e.clients.length;fe++){var Lo=J(vt.slice(3));$e.clients[fe]._emit(Lo)}}}})}var Qe=function(u){return ct||yn(u),ct._thenable()};Qe.JZZ=Qe,Qe.version=r,Qe.info=function(){return L.prototype.info()};function kn(u){var p=new _e;return u instanceof Object&&G(u,function(I){p[I]=u[I]}),p._resume(),p}Qe.Widget=kn,L.prototype.Widget=Qe.Widget,Qe.addMidiIn=function(u,p){var I=Z(p._info||{});I.name=u,I.type=I.type||"javascript",I.manufacturer=I.manufacturer||"virtual",I.version=I.version||"0.0";var U={_info:function(){return I},_openIn:function(W){W._pause(),W._info=Z(I),W._close=function(){p.disconnect(W)},p.connect(W),W._resume()}};return Qe.lib.registerMidiIn(u,U)},L.prototype.addMidiIn=Qe.addMidiIn,Qe.addMidiOut=function(u,p){var I=Z(p._info||{});I.name=u,I.type=I.type||"javascript",I.manufacturer=I.manufacturer||"virtual",I.version=I.version||"0.0";var U={_info:function(){return I},_openOut:function(W){W._pause(),W._info=Z(I),W._close=function(){W.disconnect()},Tt.apply(W,[p]),W._resume()}};return Qe.lib.registerMidiOut(u,U)},L.prototype.addMidiOut=Qe.addMidiOut,Qe.removeMidiOut=function(u){return Qe.lib.unregisterMidiOut(u)},L.prototype.removeMidiOut=Qe.removeMidiOut,Qe.removeMidiIn=function(u){return Qe.lib.unregisterMidiIn(u)},L.prototype.removeMidiIn=Qe.removeMidiIn,Qe.maskMidiIn=function(u){xe[u]=!0},L.prototype.maskMidiIn=Qe.maskMidiIn,Qe.unmaskMidiIn=function(u){delete xe[u]},L.prototype.unmaskMidiIn=Qe.unmaskMidiIn,Qe.maskMidiOut=function(u){Ne[u]=!0},L.prototype.maskMidiOut=Qe.maskMidiOut,Qe.unmaskMidiOut=function(u){delete Ne[u]},L.prototype.unmaskMidiOut=Qe.unmaskMidiOut;function zt(){var u=this instanceof zt?this:u=new zt;return zt.prototype.reset.apply(u,arguments),u}zt.prototype.reset=function(u){if(u instanceof zt)return this.setType(u.getType()),this.setHour(u.getHour()),this.setMinute(u.getMinute()),this.setSecond(u.getSecond()),this.setFrame(u.getFrame()),this.setQuarter(u.getQuarter()),this;var p=u instanceof Array?u:arguments;return this.setType(p[0]),this.setHour(p[1]),this.setMinute(p[2]),this.setSecond(p[3]),this.setFrame(p[4]),this.setQuarter(p[5]),this};function dr(){this.type==29.97&&!this.second&&this.frame<2&&this.minute%10&&(this.frame=2)}zt.prototype.isFullFrame=function(){return this.quarter==0||this.quarter==4},zt.prototype.getType=function(){return this.type},zt.prototype.getHour=function(){return this.hour},zt.prototype.getMinute=function(){return this.minute},zt.prototype.getSecond=function(){return this.second},zt.prototype.getFrame=function(){return this.frame},zt.prototype.getQuarter=function(){return this.quarter},zt.prototype.setType=function(u){if(typeof u>"u"||u==24)this.type=24;else if(u==25)this.type=25;else if(u==29.97)this.type=29.97,dr.apply(this);else if(u==30)this.type=30;else throw RangeError("Bad SMPTE frame rate: "+u);return this.frame>=this.type&&(this.frame=this.type-1),this},zt.prototype.setHour=function(u){if(typeof u>"u"&&(u=0),u!=parseInt(u)||u<0||u>=24)throw RangeError("Bad SMPTE hours value: "+u);return this.hour=u,this},zt.prototype.setMinute=function(u){if(typeof u>"u"&&(u=0),u!=parseInt(u)||u<0||u>=60)throw RangeError("Bad SMPTE minutes value: "+u);return this.minute=u,dr.apply(this),this},zt.prototype.setSecond=function(u){if(typeof u>"u"&&(u=0),u!=parseInt(u)||u<0||u>=60)throw RangeError("Bad SMPTE seconds value: "+u);return this.second=u,dr.apply(this),this},zt.prototype.setFrame=function(u){if(typeof u>"u"&&(u=0),u!=parseInt(u)||u<0||u>=this.type)throw RangeError("Bad SMPTE frame number: "+u);return this.frame=u,dr.apply(this),this},zt.prototype.setQuarter=function(u){if(typeof u>"u"&&(u=0),u!=parseInt(u)||u<0||u>=8)throw RangeError("Bad SMPTE quarter frame: "+u);return this.quarter=u,this},zt.prototype.incrFrame=function(){return this.frame++,this.frame>=this.type&&(this.frame=0,this.second++,this.second>=60&&(this.second=0,this.minute++,this.minute>=60&&(this.minute=0,this.hour=this.hour>=23?0:this.hour+1))),dr.apply(this),this},zt.prototype.decrFrame=function(){return!this.second&&this.frame==2&&this.type==29.97&&this.minute%10&&(this.frame=0),this.frame--,this.frame<0&&(this.frame=this.type==29.97?29:this.type-1,this.second--,this.second<0&&(this.second=59,this.minute--,this.minute<0&&(this.minute=59,this.hour=this.hour?this.hour-1:23))),this},zt.prototype.incrQF=function(){return this.backwards=!1,this.quarter=this.quarter+1&7,(this.quarter==0||this.quarter==4)&&this.incrFrame(),this},zt.prototype.decrQF=function(){return this.backwards=!0,this.quarter=this.quarter+7&7,(this.quarter==3||this.quarter==7)&&this.decrFrame(),this};function Kn(u){return[[24,25,29.97,30][u[7]>>1&3],(u[7]&1)<<4|u[6],u[5]<<4|u[4],u[3]<<4|u[2],u[1]<<4|u[0]]}zt.prototype.read=function(u){if(u instanceof J||(u=J.apply(null,arguments)),u[0]==240&&u[1]==127&&u[3]==1&&u[4]==1&&u[9]==247)return this.type=[24,25,29.97,30][u[5]>>5&3],this.hour=u[5]&31,this.minute=u[6],this.second=u[7],this.frame=u[8],this.quarter=0,this._=void 0,this._b=void 0,this._f=void 0,!0;if(u[0]==241&&typeof u[1]<"u"){var p=u[1]>>4,I=u[1]&15;return p==0?this._==7&&(this._f==7&&(this.reset(Kn(this._a)),this.incrFrame()),this.incrFrame()):p==3?this._==4&&this.decrFrame():p==4?this._==3&&this.incrFrame():p==7&&this._===0&&(this._b===0&&(this.reset(Kn(this._a)),this.decrFrame()),this.decrFrame()),this._a||(this._a=[]),this._a[p]=I,this._f=this._f===p-1||p==0?p:void 0,this._b=this._b===p+1||p==7?p:void 0,this._=p,this.quarter=p,!0}return!1};function Qr(u){!u.backwards&&u.quarter>=4?u.decrFrame():u.backwards&&u.quarter<4&&u.incrFrame();var p;switch(u.quarter>>1){case 0:p=u.frame;break;case 1:p=u.second;break;case 2:p=u.minute;break;default:p=u.hour}return u.quarter&1?p>>=4:p&=15,u.quarter==7&&(u.type==25?p|=2:u.type==29.97?p|=4:u.type==30&&(p|=6)),!u.backwards&&u.quarter>=4?u.incrFrame():u.backwards&&u.quarter<4&&u.decrFrame(),p|u.quarter<<4}function Br(u){return u.type==25?u.hour|32:u.type==29.97?u.hour|64:u.type==30?u.hour|96:u.hour}function ge(u){return u<10?"0"+u:u}function Ie(u){for(var p=[],I=0;I<u.length;I++)p[I]=ge(I?u[I]:u[I]&31);return p.join(":")}zt.prototype.toString=function(){return Ie([this.hour,this.minute,this.second,this.frame])},Qe.SMPTE=zt,L.prototype.SMPTE=zt;function J(u){var p=this instanceof J?this:p=new J,I;if(u instanceof J)return p._from=u._from.slice(),G(u,function(W){W!="_from"&&(p[W]=u[W])}),p;if(p._from=[],typeof u>"u")return p;var U=u instanceof Array?u:arguments;for(I=0;I<U.length;I++)l=U[I],I==1&&(p[0]>=128&&p[0]<=175&&(l=J.noteValue(l)),p[0]>=192&&p[0]<=207&&(l=J.programValue(l))),(l!=parseInt(l)||l<0||l>255)&&pt(U[I]),p.push(l);return p}J.prototype=[],J.prototype.constructor=J,J.prototype.isMidi=function(){return 1};var Ve={};J.noteValue=function(u){return typeof u>"u"?void 0:Ve[u.toString().toLowerCase()]},J.programValue=function(u){return u},J.octaveValue=function(u){var p=Ve[u.toString().toLowerCase()];return typeof p>"u"&&(p=Ve[u.toString().toLowerCase()+"1"]),typeof p>"u"?void 0:p%12},J.freq=function(u,p){return typeof p>"u"&&(p=440),rt(p),u!=parseFloat(u)&&(u=Ot(u)),p*Math.pow(2,(u-69)/12)};function rt(u){if(u!=parseFloat(u))throw TypeError("Not a number: "+u)}J.shift=function(u,p){return typeof p>"u"&&(p=440),rt(u),rt(p),Math.log2(u/p)*12},J.midi=function(u,p){return u!=parseFloat(u)?Ot(u):J.shift(u,p)+69},J.to7b=function(u){return rt(u),u<=0?0:u>=1?127:Math.floor(u*128)},J.to14b=function(u){return rt(u),u<=0?0:u>=1?16383:Math.floor(u*16384)},J.to21b=function(u){return typeof u>"u"?2097151:(rt(u),u<=0?0:(u=(Math.floor(u)<<14)+J.to14b(u-Math.floor(u)),u<2097151?u:2097150))},J.to32b=function(u){return rt(u),u<=0?0:u>=1?4294967295:Math.floor(u*4294967296)};function _t(){}_t.prototype=J,J._sxid=127,J.sxId=function(u){if(typeof u>"u"&&(u=J._sxid),u==this._sxid)return this;u=He(u);var p=new _t;return p._ch=this._ch,p._sxid=u,p},J.ch=function(u){if(u==this._ch||typeof u>"u"&&typeof this._ch>"u")return this;var p=new _t;return typeof u<"u"&&(u=Fe(u)),p._ch=u,p._sxid=this._sxid,p};var Bt={c:0,d:2,e:4,f:5,g:7,a:9,b:11,h:11};for(G(Bt,function(u){for(l=0;l<12&&(s=Bt[u]+l*12,!(s>127));l++)Ve[u+l]=s,Ve[u+""+l]=s,s>0&&(Ve[u+"b"+l]=s-1,Ve[u+""+l]=s-1,Ve[u+"bb"+l]=s-2,Ve[u+""+l]=s-2,Ve[u+""+l]=s-2),s<127&&(Ve[u+"#"+l]=s+1,Ve[u+""+l]=s+1,Ve[u+"##"+l]=s+2,Ve[u+""+l]=s+2,Ve[u+""+l]=s+2)}),l=0;l<128;l++)Ve[l]=l;function pt(u){throw RangeError("Bad MIDI value: "+u)}function gt(u){throw TypeError("Invalid value: "+u)}function bt(u){throw RangeError("Out of range: "+u)}function Fe(u){return St(u),parseInt(u)}function ut(u){if(u!=parseInt(u)||u<0||u>15)throw RangeError("Expected a 4-bit value: "+u);return parseInt(u)}function He(u,p){return(u!=parseInt(u)||u<0||u>127)&&pt(typeof p>"u"?u:p),parseInt(u)}function Cn(u){return(u!=parseInt(u)||u<0||u>255)&&pt(u),parseInt(u)}function st(u){return(u!=parseInt(u)||u<0||u>16383)&&pt(u),parseInt(u)}function de(u){if(u!=parseInt(u)||u<0||u>65535)throw RangeError("Expected a 16-bit value: "+u);return parseInt(u)}function Xe(u){if(u!=parseInt(u)||u<0||u>1048575)throw RangeError("Expected a 20-bit value: "+u);return parseInt(u)}function It(u){return(u!=parseInt(u)||u<0||u>2097151)&&pt(u),parseInt(u)}function xn(u){return(u!=parseInt(u)||u<0||u>4294967295)&&pt(u),parseInt(u)}function Ot(u){return He(J.noteValue(u),u)}function wt(u){return st(u)&127}function Wt(u){return st(u)>>7}function qn(u){u=""+u;for(var p=0;p<u.length;p++)u.charCodeAt(p)>255&&pt(u[p]);return u}function Yn(u){return[u>>14,u>>7&127,u&127]}function tr(u,p){return u!=parseFloat(u)&&gt(typeof p>"u"?u:p),(u<0||u>1)&&bt(typeof p>"u"?u:p),parseFloat(u)}function Nn(u){return typeof u<"u"&&!u?126:127}function tn(u){var p,I,U=[],W={};G(u,function(fe){if(I=It(u[fe]),fe=Ot(fe),fe in W)throw RangeError("Duplicate MIDI value: "+fe);U.push(fe),W[fe]=I}),U.sort();var se=[U.length];for(p=0;p<U.length;p++)se=se.concat([U[p]],Yn(W[U[p]]));return se}function gn(u){var p={};return G(u,function(I){p[I]=J.to21b(u[I]==parseFloat(u[I])?u[I]:Ot(u[I]))}),p}function nr(u){var p={};return G(u,function(I){p[I]=J.to21b(J.midi(u[I]))}),p}function ui(u){var p=[];if(!(u instanceof Array)||u.length!=12)throw TypeError("Expected an array of size 12");for(var I=0;I<12;I++)p.push(He(u[I]));return p}function mn(u){var p=[];if(!(u instanceof Array)||u.length!=12)throw TypeError("Expected an array of size 12");for(var I=0;I<12;I++)p.push(Wt(u[I])),p.push(wt(u[I]));return p}var jr={noteOff:function(u,p,I){return typeof I>"u"&&(I=64),[128+Fe(u),Ot(p),He(I)]},noteOn:function(u,p,I){return typeof I>"u"&&(I=127),[144+Fe(u),Ot(p),He(I)]},aftertouch:function(u,p,I){return[160+Fe(u),Ot(p),He(I)]}},At={control:function(u,p,I){return[176+Fe(u),He(p),He(I)]},program:function(u,p){return[192+Fe(u),He(J.programValue(p),p)]},pressure:function(u,p){return[208+Fe(u),He(p)]},pitchBend:function(u,p,I){return typeof I>"u"?[224+Fe(u),wt(p),Wt(p)]:[224+Fe(u),He(I),He(p)]},pitchBendF:function(u,p){return At.pitchBend(u,J.to14b((p+1)/2))},bankMSB:function(u,p){return[176+Fe(u),0,He(p)]},bankLSB:function(u,p){return[176+Fe(u),32,He(p)]},modMSB:function(u,p){return[176+Fe(u),1,He(p)]},modLSB:function(u,p){return[176+Fe(u),33,He(p)]},breathMSB:function(u,p){return[176+Fe(u),2,He(p)]},breathLSB:function(u,p){return[176+Fe(u),34,He(p)]},footMSB:function(u,p){return[176+Fe(u),4,He(p)]},footLSB:function(u,p){return[176+Fe(u),36,He(p)]},portamentoMSB:function(u,p){return[176+Fe(u),5,He(p)]},portamentoLSB:function(u,p){return[176+Fe(u),37,He(p)]},dataMSB:function(u,p){return[176+Fe(u),6,He(p)]},dataLSB:function(u,p){return[176+Fe(u),38,He(p)]},volumeMSB:function(u,p){return[176+Fe(u),7,He(p)]},volumeLSB:function(u,p){return[176+Fe(u),39,He(p)]},balanceMSB:function(u,p){return[176+Fe(u),8,He(p)]},balanceLSB:function(u,p){return[176+Fe(u),40,He(p)]},panMSB:function(u,p){return[176+Fe(u),10,He(p)]},panLSB:function(u,p){return[176+Fe(u),42,He(p)]},expressionMSB:function(u,p){return[176+Fe(u),11,He(p)]},expressionLSB:function(u,p){return[176+Fe(u),43,He(p)]},damper:function(u,p){return typeof p>"u"&&(p=!0),[176+Fe(u),64,p?127:0]},portamento:function(u,p){return typeof p>"u"&&(p=!0),[176+Fe(u),65,p?127:0]},sostenuto:function(u,p){return typeof p>"u"&&(p=!0),[176+Fe(u),66,p?127:0]},soft:function(u,p){return typeof p>"u"&&(p=!0),[176+Fe(u),67,p?127:0]},legato:function(u,p){return typeof p>"u"&&(p=!0),[176+Fe(u),68,p?127:0]},hold2:function(u,p){return typeof p>"u"&&(p=!0),[176+Fe(u),69,p?127:0]},soundVariation:function(u,p){return[176+Fe(u),70,Ot(p)]},filterResonance:function(u,p){return[176+Fe(u),71,Ot(p)]},releaseTime:function(u,p){return[176+Fe(u),72,Ot(p)]},attackTime:function(u,p){return[176+Fe(u),73,Ot(p)]},brightness:function(u,p){return[176+Fe(u),74,Ot(p)]},decayTime:function(u,p){return[176+Fe(u),75,Ot(p)]},vibratoRate:function(u,p){return[176+Fe(u),76,Ot(p)]},vibratoDepth:function(u,p){return[176+Fe(u),77,Ot(p)]},vibratoDelay:function(u,p){return[176+Fe(u),78,Ot(p)]},ptc:function(u,p){return[176+Fe(u),84,Ot(p)]},dataIncr:function(u){return[176+Fe(u),96,0]},dataDecr:function(u){return[176+Fe(u),97,0]},nrpnLSB:function(u,p){return[176+Fe(u),98,He(p)]},nrpnMSB:function(u,p){return[176+Fe(u),99,He(p)]},rpnLSB:function(u,p){return[176+Fe(u),100,He(p)]},rpnMSB:function(u,p){return[176+Fe(u),101,He(p)]},allSoundOff:function(u){return[176+Fe(u),120,0]},resetAllControllers:function(u){return[176+Fe(u),121,0]},localControl:function(u,p){return typeof p>"u"&&(p=!0),[176+Fe(u),122,p?127:0]},allNotesOff:function(u){return[176+Fe(u),123,0]},omni:function(u,p){return typeof p>"u"&&(p=!0),[176+Fe(u),p?125:124,0]},mono:function(u,p){return typeof p>"u"&&(p=1),[176+Fe(u),126,He(p)]},poly:function(u){return[176+Fe(u),127,0]}};function Mo(u,p,I,U){return typeof p<"u"?[He(u),He(p),He(I),He(U)]:((u!=parseInt(u)||u<0||u>65535)&&gt(u),u=parseInt(u),[u>>12&15,u>>8&15,u>>4&15,u&15])}function Wi(u){return rt(u),u=Math.round(u*65536+16384),u<0?0:u>65535?65535:u}var Hi={mtc:function(u){return[241,Qr(u)]},songPosition:function(u,p){return typeof p>"u"?[242,wt(u),Wt(u)]:[242,He(p),He(u)]},songSelect:function(u){return[243,He(u)]},tune:function(){return[246]},clock:function(){return[248]},start:function(){return[250]},continue:function(){return[251]},stop:function(){return[252]},active:function(){return[254]},reset:function(){return[255]}},kt={sxIdRequest:function(){return[240,126,this._sxid,6,1,247]},sxTuningDumpRequest:function(u,p){return typeof p>"u"?[240,126,this._sxid,8,0,He(u),247]:[240,126,this._sxid,8,3,He(u),He(p),247]},sxFullFrame:function(u){return[240,127,this._sxid,1,1,Br(u),u.getMinute(),u.getSecond(),u.getFrame(),247]},sxMasterVolume:function(u,p){return typeof p>"u"?[240,127,this._sxid,4,1,wt(u),Wt(u),247]:[240,127,this._sxid,4,1,He(p),He(u),247]},sxMasterVolumeF:function(u){return kt.sxMasterVolume.call(this,J.to14b(tr(u)))},sxMasterFineTuning:function(u,p){return typeof p>"u"?[240,127,this._sxid,4,3,wt(u),Wt(u),247]:[240,127,this._sxid,4,3,He(p),He(u),247]},sxMasterFineTuningF:function(u){return kt.sxMasterFineTuning.call(this,J.to14b(tr((u%1+1)/2,u)))},sxMasterCoarseTuning:function(u){return[240,127,this._sxid,4,4,0,He(u),247]},sxMasterCoarseTuningF:function(u){return kt.sxMasterCoarseTuning.call(this,64+(u-u%1))},sxNoteTuning:function(u,p,I,U){return p==parseInt(p)?[240,Nn(U),this._sxid,8,7,He(u),He(p)].concat(tn(I),[247]):[240,127,this._sxid,8,2,He(u)].concat(tn(p),[247])},sxNoteTuningF:function(u,p,I,U){return p==parseInt(p)?kt.sxNoteTuning.call(this,u,p,gn(I),U):kt.sxNoteTuning.call(this,u,gn(p))},sxNoteTuningHZ:function(u,p,I,U){return p==parseInt(p)?kt.sxNoteTuning.call(this,u,p,nr(I),U):kt.sxNoteTuning.call(this,u,nr(p))},sxScaleTuning1:function(u,p,I){return u==parseInt(u)?[240,Nn(I),this._sxid,8,8].concat(Yn(de(u)),ui(p),[247]):kt.sxScaleTuning1.call(this,65535,u,p)},sxScaleTuning1F:function(u,p,I){if(u!=parseInt(u))return kt.sxScaleTuning1F.call(this,65535,u,p);for(var U=[],W=0;W<p.length;W++){if(p[W]<-.64||p[W]>.63)throw RangeError("Out of range: "+p[W]);U.push(Math.floor(p[W]*100+64))}return kt.sxScaleTuning1.call(this,u,U,I)},sxScaleTuning2:function(u,p,I){return u==parseInt(u)?[240,Nn(I),this._sxid,8,9].concat(Yn(de(u)),mn(p),[247]):kt.sxScaleTuning2.call(this,65535,u,p)},sxScaleTuning2F:function(u,p,I){if(u!=parseInt(u))return kt.sxScaleTuning2F.call(this,65535,u,p);for(var U=[],W=0;W<p.length;W++){var se=(p[W]+1)/2;if(se<-1||se>1)throw RangeError("Out of range: "+p[W]);U.push(J.to14b((p[W]+1)/2))}return kt.sxScaleTuning2.call(this,u,U,I)},sxGM:function(u){return typeof u>"u"&&(u=1),[240,126,this._sxid,9,u?u==2?3:1:2,247]},sxGS:function(u){for(var p=typeof u>"u"?[64,0,127,0]:u instanceof Array?u:arguments,I=0,U=[240,65,this._sxid,66,18],W=0;W<p.length;W++){var se=He(p[W]);U.push(se),I+=se}return I%=128,U.push(I?128-I:0),U.push(247),U},sxXG:function(u){var p=typeof u>"u"?[0,0,126,0]:u instanceof Array?u:arguments,I=this._sxid==127?0:this._sxid;I>15&&pt("Bad Yamaha device number: "+I);for(var U=[240,67,16+I,76],W=0;W<p.length;W++)U.push(He(p[W]));return U.push(247),U},sxMidiSoft:function(u,p){var I=[240,0,32,36,0,He(u||0)];p=typeof p>"u"?"":""+p;for(var U=0;U<p.length;U++)I.push(He(p.charCodeAt(U)));return I.push(247),I},gsMasterVolume:function(u){return kt.sxGS.call(this,[64,0,4,He(u)])},gsMasterVolumeF:function(u){return kt.gsMasterVolume.call(this,J.to7b(tr(u)))},gsMasterFineTuning:function(u,p,I,U){return u=Mo(u,p,I,U),kt.sxGS.call(this,[64,0,0,u[0],u[1],u[2],u[3]])},gsMasterFineTuningF:function(u){return kt.gsMasterFineTuning.call(this,Wi(u%1))},gsMasterCoarseTuning:function(u){return kt.sxGS.call(this,[64,0,5,He(u)])},gsMasterCoarseTuningF:function(u){return kt.gsMasterCoarseTuning.call(this,64+(u-u%1))},gsOctaveTuning:function(u,p,I){return kt.sxGS.call(this,[64,16+[1,2,3,4,5,6,7,8,9,0,11,12,13,14,15][Fe(u)],64+J.octaveValue(p),He(I)])},gsOctaveTuningF:function(u,p,I){if(I<-.64||I>.63)throw RangeError("Out of range: "+I);return kt.gsOctaveTuning.call(this,u,p,Math.floor(I*100+64))},xgMasterVolume:function(u){return kt.sxXG.call(this,[0,0,4,He(u)])},xgMasterVolumeF:function(u){return kt.xgMasterVolume.call(this,J.to7b(tr(u)))},xgMasterFineTuning:function(u,p,I,U){return u=Mo(u,p,I,U),kt.sxXG.call(this,[0,0,0,u[0],u[1],u[2],u[3]])},xgMasterFineTuningF:function(u){return kt.xgMasterFineTuning.call(this,Wi(u%1))},xgMasterCoarseTuning:function(u){return kt.sxXG.call(this,[0,0,6,He(u)])},xgMasterCoarseTuningF:function(u){return kt.xgMasterCoarseTuning.call(this,64+(u-u%1))},xgOctaveTuning:function(u,p,I){return kt.sxXG.call(this,[8,Fe(u),65+J.octaveValue(p),He(I)])},xgOctaveTuningF:function(u,p,I){if(I<-.64||I>.63)throw RangeError("Out of range: "+I);return kt.xgOctaveTuning.call(this,u,p,Math.floor(I*100+64))}};kt.sxScaleTuning=kt.sxScaleTuning2,kt.sxScaleTuningF=kt.sxScaleTuning2F,kt.sxMasterTranspose=kt.sxMasterCoarseTuning,kt.sxMasterTransposeF=kt.sxMasterCoarseTuningF,kt.gsMasterTranspose=kt.gsMasterCoarseTuning,kt.gsMasterTransposeF=kt.gsMasterCoarseTuningF,kt.xgMasterTranspose=kt.xgMasterCoarseTuning,kt.xgMasterTransposeF=kt.xgMasterCoarseTuningF;var rn={bank:function(u,p,I){return typeof I>"u"?[At.bankMSB(u,Wt(p)),At.bankLSB(u,wt(p))]:[At.bankMSB(u,p),At.bankLSB(u,I)]},modF:function(u,p){return rn.mod(u,J.to14b(p))},mod:function(u,p,I){return typeof I>"u"?[At.modMSB(u,Wt(p)),At.modLSB(u,wt(p))]:[At.modMSB(u,p),At.modLSB(u,I)]},breathF:function(u,p){return rn.breath(u,J.to14b(p))},breath:function(u,p,I){return typeof I>"u"?[At.breathMSB(u,Wt(p)),At.breathLSB(u,wt(p))]:[At.breathMSB(u,p),At.breathLSB(u,I)]},footF:function(u,p){return rn.foot(u,J.to14b(p))},foot:function(u,p,I){return typeof I>"u"?[At.footMSB(u,Wt(p)),At.footLSB(u,wt(p))]:[At.footMSB(u,p),At.footLSB(u,I)]},portamentoTimeF:function(u,p){return rn.portamentoTime(u,J.to14b(p))},portamentoTime:function(u,p,I){return typeof I>"u"?[At.portamentoMSB(u,Wt(p)),At.portamentoLSB(u,wt(p))]:[At.portamentoMSB(u,p),At.portamentoLSB(u,I)]},dataF:function(u,p){return rn.data(u,J.to14b(p))},data:function(u,p,I){return typeof I>"u"?[At.dataMSB(u,Wt(p)),At.dataLSB(u,wt(p))]:[At.dataMSB(u,p),At.dataLSB(u,I)]},volumeF:function(u,p){return rn.volume(u,J.to14b(p))},volume:function(u,p,I){return typeof I>"u"?[At.volumeMSB(u,Wt(p)),At.volumeLSB(u,wt(p))]:[At.volumeMSB(u,p),At.volumeLSB(u,I)]},balanceF:function(u,p){return rn.balance(u,J.to14b((p+1)/2))},balance:function(u,p,I){return typeof I>"u"?[At.balanceMSB(u,Wt(p)),At.balanceLSB(u,wt(p))]:[At.balanceMSB(u,p),At.balanceLSB(u,I)]},panF:function(u,p){return rn.pan(u,J.to14b((p+1)/2))},pan:function(u,p,I){return typeof I>"u"?[At.panMSB(u,Wt(p)),At.panLSB(u,wt(p))]:[At.panMSB(u,p),At.panLSB(u,I)]},expressionF:function(u,p){return rn.expression(u,J.to14b(p))},expression:function(u,p,I){return typeof I>"u"?[At.expressionMSB(u,Wt(p)),At.expressionLSB(u,wt(p))]:[At.expressionMSB(u,p),At.expressionLSB(u,I)]},nrpn:function(u,p,I){return typeof I>"u"?[At.nrpnMSB(u,Wt(p)),At.nrpnLSB(u,wt(p))]:[At.nrpnMSB(u,p),At.nrpnLSB(u,I)]},rpn:function(u,p,I){return typeof I>"u"?[At.rpnMSB(u,Wt(p)),At.rpnLSB(u,wt(p))]:[At.rpnMSB(u,p),At.rpnLSB(u,I)]},rpnPitchBendRange:function(u,p,I){return rn.rpn(u,0,0).concat(rn.data(u,p,I))},rpnPitchBendRangeF:function(u,p){return rn.rpnPitchBendRange(u,He(p-p%1),Math.floor(p%1*100))},rpnFineTuning:function(u,p,I){return rn.rpn(u,0,1).concat(rn.data(u,p,I))},rpnFineTuningF:function(u,p){return rn.rpn(u,0,1).concat(rn.dataF(u,(p%1+1)/2))},rpnCoarseTuning:function(u,p){return rn.rpn(u,0,2).concat([At.dataMSB(u,p)])},rpnCoarseTuningF:function(u,p){return rn.rpn(u,0,2).concat([At.dataMSB(u,64+(p-p%1))])},rpnTuning:function(u,p,I,U){return rn.rpnCoarseTuning(u,p).concat(rn.rpnFineTuning(u,I,U))},rpnTuningF:function(u,p){return rn.rpnCoarseTuningF(u,p).concat(rn.rpnFineTuningF(u,p))},rpnTuningA:function(u,p){return rn.rpnTuningF(u,J.shift(p))},rpnSelectTuningProgram:function(u,p){return rn.rpn(u,0,3).concat([At.dataMSB(u,p)])},rpnSelectTuningBank:function(u,p){return rn.rpn(u,0,4).concat([At.dataMSB(u,p)])},rpnSelectTuning:function(u,p,I){return typeof I>"u"?rn.rpnSelectTuningProgram(u,p):rn.rpnSelectTuningBank(u,p).concat(rn.rpnSelectTuningProgram(u,I))},rpnModulationDepthRange:function(u,p,I){return rn.rpn(u,0,5).concat(rn.data(u,p,I))},rpnModulationDepthRangeF:function(u,p){return rn.rpnModulationDepthRange(u,He(p-p%1),Math.floor(p%1*128))},rpnNull:function(u){return rn.rpn(u,127,127)},mode1:function(u){return[At.omni(u,!0),At.poly(u)]},mode2:function(u){return[At.omni(u,!0),At.mono(u)]},mode3:function(u){return[At.omni(u,!1),At.poly(u)]},mode4:function(u){return[At.omni(u,!1),At.mono(u)]}};rn.rpnTranspose=rn.rpnCoarseTuningF;var D={sxMasterTuning:function(u,p,I){return[kt.sxMasterCoarseTuning.call(this,u),kt.sxMasterFineTuning.call(this,p,I)]},sxMasterTuningF:function(u){return[kt.sxMasterCoarseTuningF.call(this,u),kt.sxMasterFineTuningF.call(this,u)]},gsMasterTuningF:function(u){return[kt.gsMasterCoarseTuningF.call(this,u),kt.gsMasterFineTuningF.call(this,u)]},xgMasterTuningF:function(u){return[kt.xgMasterCoarseTuningF.call(this,u),kt.xgMasterFineTuningF.call(this,u)]},sxMasterTuningA:function(u){return D.sxMasterTuningF.call(this,J.shift(u))},gsMasterTuningA:function(u){return D.gsMasterTuningF.call(this,J.shift(u))},xgMasterTuningA:function(u){return D.xgMasterTuningF.call(this,J.shift(u))},gsScaleTuning:function(u,p){var I=[];if(p.length!=12)throw RangeError("Wrong input size: "+p.length);for(var U=0;U<12;U++)I.push(kt.gsOctaveTuning.call(this,u,U,p[U]));return I},gsScaleTuningF:function(u,p){var I=[];if(p.length!=12)throw RangeError("Wrong input size: "+p.length);for(var U=0;U<12;U++)I.push(kt.gsOctaveTuningF.call(this,u,U,p[U]));return I},xgScaleTuning:function(u,p){var I=[];if(p.length!=12)throw RangeError("Wrong input size: "+p.length);for(var U=0;U<12;U++)I.push(kt.xgOctaveTuning.call(this,u,U,p[U]));return I},xgScaleTuningF:function(u,p){var I=[];if(p.length!=12)throw RangeError("Wrong input size: "+p.length);for(var U=0;U<12;U++)I.push(kt.xgOctaveTuningF.call(this,u,U,p[U]));return I}};function V(u,p){var I=new J;return I.ff=Cn(u),I.dd=typeof p>"u"?"":qn(p),I}var Q={smf:function(u){if(u instanceof J)return new J(u);var p=u instanceof Array?u:arguments,I=Cn(p[0]),U="";return p.length==2?U=vr(p[1]):p.length>2&&(U=vr(Array.prototype.slice.call(p,1))),V(I,U)},smfSeqNumber:function(u){if(u==parseInt(u)){if(u<0||u>65535)throw RangeError("Sequence number out of range: "+u);u=String.fromCharCode(u>>8)+String.fromCharCode(u&255)}else if(u=""+u,u.length==0)u="\0\0";else if(u.length==1)u="\0"+u;else if(u.length>2)throw RangeError("Sequence number out of range"+po(u));return V(0,u)},smfText:function(u){return V(1,Qe.lib.toUTF8(u))},smfCopyright:function(u){return V(2,Qe.lib.toUTF8(u))},smfSeqName:function(u){return V(3,Qe.lib.toUTF8(u))},smfInstrName:function(u){return V(4,Qe.lib.toUTF8(u))},smfLyric:function(u){return V(5,Qe.lib.toUTF8(u))},smfMarker:function(u){return V(6,Qe.lib.toUTF8(u))},smfCuePoint:function(u){return V(7,Qe.lib.toUTF8(u))},smfProgName:function(u){return V(8,Qe.lib.toUTF8(u))},smfDevName:function(u){return V(9,Qe.lib.toUTF8(u))},smfChannelPrefix:function(u){if(u==parseInt(u))St(u),u=String.fromCharCode(u);else if(u=""+u,u.length==0)u="\0";else if(u.length>1||u.charCodeAt(0)>15)throw RangeError("Channel number out of range"+po(u));return V(32,u)},smfMidiPort:function(u){if(u==parseInt(u)){if(u<0||u>127)throw RangeError("Port number out of range: "+u);u=String.fromCharCode(u)}else if(u=""+u,u.length==0)u="\0";else if(u.length>1||u.charCodeAt(0)>127)throw RangeError("Port number out of range"+po(u));return V(33,u)},smfEndOfTrack:function(u){if(vr(u)!="")throw RangeError("Unexpected data"+po(vr(u)));return V(47)},smfTempo:function(u){if((""+u).length==3)return V(81,u);if(u==parseInt(u)&&u>0&&u<=16777215)return V(81,String.fromCharCode(u>>16)+String.fromCharCode(u>>8&255)+String.fromCharCode(u&255));throw RangeError("Out of range"+po(vr(u)))},smfBPM:function(u){return Q.smfTempo(Math.round(6e7/u))},smfSMPTE:function(u){if(u instanceof zt)return V(84,String.fromCharCode(u.hour)+String.fromCharCode(u.minute)+String.fromCharCode(u.second)+String.fromCharCode(u.frame)+String.fromCharCode(u.quarter%4*25));var p=""+u;if(p.length==5)return V(84,u);var I=u instanceof Array?u:Array.prototype.slice.call(arguments);return I.splice(0,0,30),Q.smfSMPTE(new zt(I))},smfTimeSignature:function(u,p,I,U){var W,se,fe,$e,qe=(""+u).match(/^\s*(\d+)\s*\/\s*(\d+)\s*$/);if(qe){if(W=parseInt(qe[1]),se=parseInt(qe[2]),W>0&&W<256&&se>0&&!(se&se-1)){for(fe=se,se=0,fe>>=1;fe;fe>>=1)se++;return fe=p==parseInt(p)?p:24,$e=I==parseInt(I)?I:8,V(88,String.fromCharCode(W)+String.fromCharCode(se)+String.fromCharCode(fe)+String.fromCharCode($e))}else if((""+u).length==4)return V(88,u)}else if(u==parseInt(u)&&p==parseInt(p)){if(u>0&&u<256&&p>0&&!(p&p-1)){for(W=u,se=0,fe=p,fe>>=1;fe;fe>>=1)se++;return fe=I==parseInt(I)?I:24,$e=U==parseInt(U)?U:8,V(88,String.fromCharCode(W)+String.fromCharCode(se)+String.fromCharCode(fe)+String.fromCharCode($e))}else if((""+u).length==4)return V(88,u);u=u+"/"+p}else if((""+u).length==4)return V(88,u);throw RangeError("Wrong time signature"+po(vr(""+u)))},smfKeySignature:function(u){u=""+u;var p=u.match(/^\s*([A-H][b#]?)\s*(|maj|major|dur|m|min|minor|moll)\s*$/i);if(p){var I={CB:0,GB:1,DB:2,AB:3,EB:4,BB:5,F:6,C:7,G:8,D:9,A:10,E:11,B:12,H:12,"F#":13,"C#":14,"G#":15,"D#":16,"A#":17}[p[1].toUpperCase()],U={"":0,MAJ:0,MAJOR:0,DUR:0,M:1,MIN:1,MINOR:1,MOLL:1}[p[2].toUpperCase()];typeof I<"u"&&typeof U<"u"&&(U&&(I-=3),I-=7,I>=-7&&I<0?u=String.fromCharCode(256+I)+String.fromCharCode(U):I>=0&&I<=7&&(u=String.fromCharCode(I)+String.fromCharCode(U)))}if(u.length==2&&u.charCodeAt(1)<=1&&(u.charCodeAt(0)<=7||u.charCodeAt(0)<=255&&u.charCodeAt(0)>=249))return V(89,u);throw RangeError("Incorrect key signature"+po(u))},smfSequencer:function(u){return V(127,vr(u))}},ie={};function Be(u,p){J[u]=function(){return new J(p.apply(this,arguments))},ie[u]=function(){return this.send(p.apply(this,arguments))}}function Te(u,p){J[u]=function(){return p.apply(this,arguments)},ie[u]=function(){return this.send(p.apply(this,arguments))}}function We(u,p){J[u]=function(){var I,U=[],W=p.apply(this,arguments);for(I=0;I<W.length;I++)U.push(new J(W[I]));return U},ie[u]=function(){for(var I=p.apply(this,arguments),U=this,W=0;W<I.length;W++)U=U.send(I[W]);return U}}function dt(u,p){J[u]=function(){return new J(p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))},ie[u]=function(){if(typeof this._master<"u"){var I=new J(p.apply(this,[this._master].concat(Array.prototype.slice.call(arguments))));return I._mpe=I[1],this.send(I)}return this.send(p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))}}function mt(u,p){J[u]=function(){return new J(p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))},ie[u]=function(){if(typeof this._master<"u"){var I,U=Array.prototype.slice.call(arguments);U.length<p.length?U=[this._master].concat(U):(I=Ot(U[0]),U[0]=this._master);var W=new J(p.apply(this,U));return W._mpe=I,this.send(W)}return this.send(p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))}}function Kt(u,p){J[u]=function(){var I,U=[],W=p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments)));for(I=0;I<W.length;I++)U.push(new J(W[I]));return U},ie[u]=function(){var I,U,W;if(typeof this._master<"u"){var se,fe=Array.prototype.slice.call(arguments);for(fe.length<p.length?fe=[this._master].concat(fe):(se=Ot(fe[0]),fe[0]=this._master),U=p.apply(this,fe),W=this,I=0;I<U.length;I++){var $e=J(U[I]);$e._mpe=se,W=W.send($e)}return W}for(U=p.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))),W=this,I=0;I<U.length;I++)W=W.send(U[I]);return W}}G(Hi,function(u){Be(u,Hi[u])}),G(kt,function(u){Be(u,kt[u])}),G(Q,function(u){Te(u,Q[u])}),G(D,function(u){We(u,D[u])}),G(jr,function(u){dt(u,jr[u])}),G(At,function(u){mt(u,At[u])}),G(rn,function(u){Kt(u,rn[u])});function sn(u){G(ie,function(p){u.prototype[p]=ie[p]})}sn(_e);var Fn={a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};for(a=0;a<16;a++)Fn[a]=a;J.prototype.getChannel=function(){if(this.ff==32&&this.dd.length==1&&this.dd.charCodeAt(0)<16)return this.dd.charCodeAt(0);var u=this[0];if(!(typeof u>"u"||u<128||u>239))return u&15},J.prototype.setChannel=function(u){if(u=Fn[u],typeof u>"u")return this;if(this.ff==32)this.dd=String.fromCharCode(u);else{var p=this[0];typeof p<"u"&&p>=128&&p<=239&&(this[0]=p&240|u)}return this},J.prototype.getNote=function(){var u=this[0];if(!(typeof u>"u"||u<128||u>175))return this[1]},J.prototype.setNote=function(u){var p=this[0];return typeof p>"u"||p<128||p>175?this:(u=J.noteValue(u),typeof u<"u"&&(this[1]=u),this)},J.prototype.getVelocity=function(){var u=this[0];if(!(typeof u>"u"||u<128||u>159))return this[2]},J.prototype.setVelocity=function(u){var p=this[0];return typeof p>"u"||p<128||p>159?this:(u=parseInt(u),u>=0&&u<128&&(this[2]=u),this)},J.prototype.getSysExId=function(){if(this[0]==240)return this[2]},J.prototype.setSysExId=function(u){return this[0]==240&&this.length>2&&(u=parseInt(u),u>=0&&u<128&&(this[2]=u)),this},J.prototype.getData=function(){if(typeof this.dd<"u")return this.dd.toString()},J.prototype.setData=function(u){return this.dd=vr(u),this};function Ci(u,p){return u==127&&typeof p<"u"&&p.charCodeAt(0)==67&&p.charCodeAt(1)==123}function xi(u,p){return Ci(u,p)&&p.charCodeAt(2)==1}function Jr(u,p){if(u>=0&&u<=127&&p>=0&&p<=127){var I=u&15,U=u>>4;if(I>0&&I<8&&U<7)I=["C","D","E","F","G","A","B"][I-1]+["bbb","bb","b","","#","##","###"][U];else return"-";return p>34?I+"?":I+["","6","Maj7","Maj7(#11)","(9)","Maj7(9)","6(9)","aug","m","m6","m7","m7b5","m(9)","m7(9)","m7(11)","m+7","m+7(9)","dim","dim7","7","7sus4","7b5","7(9)","7(#11)","7(13)","7(b9)","7(b13)","7(#9)","Maj7aug","7aug","1+8","1+5","sus4","1+2+5","cc"][p]}return"-"}J.prototype.getText=function(){if(typeof this.dd<"u")return xi(this.ff,this.dd)?Jr(this.dd.charCodeAt(3),this.dd.charCodeAt(4)):Qe.lib.fromUTF8(this.dd);if(this.isMidiSoft()){for(var u=[],p=6;p<this.length-1;p++)u.push(String.fromCharCode(this[p]));return u.join("")}},J.prototype.setText=function(u){return this.dd=Qe.lib.toUTF8(u),this},J.prototype.getTempo=function(){if(this.ff==81&&typeof this.dd<"u")return this.dd.charCodeAt(0)*65536+this.dd.charCodeAt(1)*256+this.dd.charCodeAt(2)},J.prototype.getBPM=function(){var u=this.getTempo();if(u)return 6e7/u},J.prototype.getTimeSignature=function(){if(this.ff==88&&typeof this.dd<"u")return[this.dd.charCodeAt(0),1<<this.dd.charCodeAt(1)]},J.prototype.getTimeSignature4=function(){if(this.ff==88&&typeof this.dd<"u"){var u=[this.dd.charCodeAt(0),1<<this.dd.charCodeAt(1)];return this.dd.length==4&&u.push(this.dd.charCodeAt(2),this.dd.charCodeAt(3)),u}},J.prototype.getKeySignature=function(){if(this.ff==89&&typeof this.dd<"u"){var u=this.dd.charCodeAt(0),p=this.dd.charCodeAt(1);if(u&128&&(u=u-256),u>=-7&&u<=7&&p>=0&&p<=1)return[u,["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#","G#","D#","A#"][p?u+10:u+7],!!p]}},J.prototype.isNoteOn=function(){var u=this[0];return typeof u>"u"||u<144||u>159?!1:this[2]>0},J.prototype.isNoteOff=function(){var u=this[0];return typeof u>"u"||u<128||u>159?!1:u<144?!0:this[2]==0},J.prototype.isSysEx=function(){return this[0]==240},J.prototype.isFullSysEx=function(){return this[0]==240&&this[this.length-1]==247},J.prototype.isMidiSoft=function(){return this.isFullSysEx()&&this[1]==0&&this[2]==32&&this[3]==36&&this[4]==0},J.prototype.isSMF=function(){return this.ff>=0&&this.ff<=127},J.prototype.isEOT=function(){return this.ff==47},J.prototype.isText=function(){return this.ff==1},J.prototype.isCopyright=function(){return this.ff==2},J.prototype.isSeqName=function(){return this.ff==3},J.prototype.isInstrName=function(){return this.ff==4},J.prototype.isLyric=function(){return this.ff==5},J.prototype.isMarker=function(){return this.ff==6},J.prototype.isCuePoint=function(){return this.ff==7},J.prototype.isProgName=function(){return this.ff==8},J.prototype.isDevName=function(){return this.ff==9},J.prototype.isTempo=function(){return this.ff==81},J.prototype.isTimeSignature=function(){return this.ff==88},J.prototype.isKeySignature=function(){return this.ff==89},J.prototype.isGmReset=function(){return this.match([240,126,[0,0],9,[0,0],247])},J.prototype.isGsReset=function(){return this.match([240,65,[0,0],66,18,64,0,127,0,65,247])},J.prototype.isXgReset=function(){return this.match([240,67,[16,240],76,0,0,126,0,247])},J.prototype.match=function(u){var p,I;for(p=0;p<u.length;p++)if(I=u[p][1],typeof I>"u"){if(this[p]!=u[p])return!1}else if((this[p]&I)!=(u[p][0]&I))return!1;return!0};function bi(u){for(var p=[],I=0;I<u.length;I++)p[I]=u.charCodeAt(I);return p}function Ii(u){for(var p="",I=0;I<u.length;I++)p+=String.fromCharCode(u[I]);return p}function vr(u){return u instanceof Array?Ii(u):typeof u>"u"?"":""+u}function ei(u){for(var p=0,I=0;I<u.length;I++)p=(p<<8)+u.charCodeAt(I);return p}function Qn(u){return(u<16?"0":"")+u.toString(16)}function Gr(u){for(var p=[],I=0;I<u.length;I++)p.push(Qn(u[I]));return p.join(" ")}function fo(u){for(var p=[],I=0;I<u.length;I++)I&&I%4==0&&p.push(" "),p.push(Qn(u[I]));return p.join("")}function ho(u){for(var p="",I=0;I<u.length;I++)u[I]==`
`?p+="\\n":u[I]=="\r"?p+="\\r":u[I]=="	"?p+="\\t":u.charCodeAt(I)<32?p+="\\x"+Qn(u.charCodeAt(I)):p+=u[I];return p}function sa(u){return u.length?": "+Gr(bi(u)):""}function po(u){return u.length?": "+ho(Qe.lib.fromUTF8(u)):""}J.prototype.label=function(u){return this.lbl=this.lbl?this.lbl+", "+u:u,this},J.prototype.toString=function(){return this.lbl?this._str()+" ("+this.lbl+")":this._str()},J.prototype._str=function(){var u,p;if(this.length)u=Gr(this);else{if(typeof this.ff>"u")return"empty";u="ff"+Qn(this.ff)}return p=this._string(),p?u+" -- "+p:u},J.prototype._string=function(){var u="",p;if(!this.length){if(this.ff==0)u+="Sequence Number: "+ei(this.dd);else if(this.ff>0&&this.ff<10)u+=["","Text","Copyright","Sequence Name","Instrument Name","Lyric","Marker","Cue Point","Program Name","Device Name"][this.ff]+po(this.dd);else if(this.ff==32)u+="Channel Prefix"+sa(this.dd);else if(this.ff==33)u+="MIDI Port"+sa(this.dd);else if(this.ff==47)u+="End of Track"+sa(this.dd);else if(this.ff==81){var I=Math.round(this.getBPM()*100)/100;u+="Tempo: "+I+" bpm"}else if(this.ff==84)u+="SMPTE Offset: "+Ie(bi(this.dd));else if(this.ff==88){var U=1<<this.dd.charCodeAt(1);u+="Time Signature: "+this.dd.charCodeAt(0)+"/"+U,u+=" "+this.dd.charCodeAt(2)+" "+this.dd.charCodeAt(3)}else if(this.ff==89){u+="Key Signature: ";var W=this.getKeySignature();W?(u+=W[1],W[2]&&(u+=" min")):u+="invalid"}else if(this.ff==127){if(this.dd.charCodeAt(0)==67&&this.dd.charCodeAt(1)==123)return u+="[XF:"+Qn(this.dd.charCodeAt(2))+"]",p={0:"Version",1:"Chord",2:"Rehearsal Mark",3:"Phrase Mark",4:"Max Phrase Mark",5:"Fingering Number",12:"Guide Track Flag",16:"Guitar Info",18:"Chord Voicing",127:"XG Song Data Number"}[this.dd.charCodeAt(2)],u+=p?" "+p:"",u+=": ",this.dd.charCodeAt(2)==0?u+this.dd.substring(3,7)+" "+Gr(bi(this.dd.substring(7))):this.dd.charCodeAt(2)==1?u+this.getText():u+Gr(bi(this.dd.substring(3)));u+="Sequencer Specific"+sa(this.dd)}else u+="SMF"+sa(this.dd);return u}if(p={241:"MIDI Time Code",242:"Song Position",243:"Song Select",244:"Undefined",245:"Undefined",246:"Tune request",248:"Timing clock",249:"Undefined",250:"Start",251:"Continue",252:"Stop",253:"Undefined",254:"Active Sensing",255:"Reset"}[this[0]],p)return p;if(this.isMidiSoft())return p=ho(this.getText()),p&&(p=" "+p),"[K:"+Qn(this[5])+"]"+p;var se=this[0]>>4;return p={8:"Note Off",10:"Aftertouch",12:"Program Change",13:"Channel Aftertouch",14:"Pitch Wheel"}[se],p||(se==9?this[2]?"Note On":"Note Off":se!=11?u:(p={0:"Bank Select MSB",1:"Modulation Wheel MSB",2:"Breath Controller MSB",4:"Foot Controller MSB",5:"Portamento Time MSB",6:"Data Entry MSB",7:"Channel Volume MSB",8:"Balance MSB",10:"Pan MSB",11:"Expression Controller MSB",12:"Effect Control 1 MSB",13:"Effect Control 2 MSB",16:"General Purpose Controller 1 MSB",17:"General Purpose Controller 2 MSB",18:"General Purpose Controller 3 MSB",19:"General Purpose Controller 4 MSB",31:"Karaoke",32:"Bank Select LSB",33:"Modulation Wheel LSB",34:"Breath Controller LSB",36:"Foot Controller LSB",37:"Portamento Time LSB",38:"Data Entry LSB",39:"Channel Volume LSB",40:"Balance LSB",42:"Pan LSB",43:"Expression Controller LSB",44:"Effect control 1 LSB",45:"Effect control 2 LSB",48:"General Purpose Controller 1 LSB",49:"General Purpose Controller 2 LSB",50:"General Purpose Controller 3 LSB",51:"General Purpose Controller 4 LSB",64:"Damper Pedal",65:"Portamento",66:"Sostenuto",67:"Soft Pedal",68:"Legato",69:"Hold 2",70:"Sound Variation",71:"Filter Resonance",72:"Release Time",73:"Attack Time",74:"Brightness",75:"Decay Time",76:"Vibrato Rate",77:"Vibrato Depth",78:"Vibrato Delay",79:"Sound Controller 10",80:"General Purpose Controller 5",81:"General Purpose Controller 6",82:"General Purpose Controller 7",83:"General Purpose Controller 8",84:"Portamento Control",88:"High Resolution Velocity Prefix",91:"Effects 1 Depth",92:"Effects 2 Depth",93:"Effects 3 Depth",94:"Effects 4 Depth",95:"Effects 5 Depth",96:"Data Increment",97:"Data Decrement",98:"Non-Registered Parameter Number LSB",99:"Non-Registered Parameter Number MSB",100:"Registered Parameter Number LSB",101:"Registered Parameter Number MSB",120:"All Sound Off",121:"Reset All Controllers",122:"Local Control On/Off",123:"All Notes Off",124:"Omni Mode Off",125:"Omni Mode On",126:"Mono Mode On",127:"Poly Mode On"}[this[1]],this[1]>=64&&this[1]<=69&&(p+=this[2]<64?" Off":" On"),p||(p="Undefined"),p))},J.prototype._stamp=function(u){return this._from.push(u._orig?u._orig:u),this},J.prototype._unstamp=function(u){if(typeof u>"u")this._from=[];else{u._orig&&(u=u._orig);var p=this._from.indexOf(u);p>-1&&this._from.splice(p,1)}return this},J.prototype._stamped=function(u){u._orig&&(u=u._orig);for(var p=0;p<this._from.length;p++)if(this._from[p]==u)return!0;return!1},Qe.MIDI=J,L.prototype.MIDI=J;function aa(u){typeof u>"u"?this._cc={}:this._cc[u]={}}function zu(u,p){var I=typeof u>"u"?"??":Qn(u),U=typeof p>"u"?"??":Qn(p),W={"0000":"Pitch Bend Sensitivity","0001":"Channel Fine Tuning","0002":"Channel Coarse Tuning","0003":"Select Tuning Program","0004":"Select Tuning Bank","0005":"Vibrato Depth Range","7f7f":"NONE"}[I+""+U];return"RPN "+I+" "+U+(W?": "+W:"")}function Zi(u,p){var I=typeof u>"u"?"??":Qn(u),U=typeof p>"u"?"??":Qn(p);return"NRPN "+I+" "+U}function Ko(u){var p,I="";for(p=0;p<u.length&&u[p];p++)I+=String.fromCharCode(u[p]);return Qe.lib.fromUTF8(I)}function ca(u){var p,I,U,W,se,fe,$e,qe="x",vt="x";if(u.isMidi2?(U=u[0]>>4,qe=(u[0]&15).toString(16),I=qe,this._cc[I]||(this._cc[I]={}),U==2?p=new J(u.slice(1)):U==3?(W=u[1]>>4,se=u[1]&15,fe=u.slice(2,2+se),W==0&&(p=new J([240].concat(fe,[247])),this._cc[I].sx=void 0),W==1&&(this._cc[I].sx=fe),W==2&&this._cc[I].sx&&(this._cc[I].sx=this._cc[I].sx.concat(fe)),W==3&&this._cc[I].sx&&(fe=this._cc[I].sx.concat(fe),p=new J([240].concat(fe,[247])),this._cc[I].sx=void 0)):U==4?(W=u[1]>>4,vt=(u[1]&15).toString(16),I=qe+vt,this._cc[I]||(this._cc[I]={}),W==12&&(u[3]&1&&(this._cc[I].bm=u[6],this._cc[I].bl=u[7]),u._bm=this._cc[I].bm,u._bl=this._cc[I].bl,Qe.MIDI.programName&&u.label(Qe.MIDI.programName(u[4],u._bm,u._bl)))):U==13&&(W=u[1]>>6,u[1]&48||(vt=(u[1]&15).toString(16)),I=qe+vt,this._cc[I]||(this._cc[I]={}),fe=u.slice(4),W==0&&(u.label(Ko(fe)),this._cc[I].tx=void 0),W==1&&(this._cc[I].tx=fe),W==2&&this._cc[I].tx&&(this._cc[I].tx=this._cc[I].tx.concat(fe)),W==3&&this._cc[I].tx&&(fe=this._cc[I].tx.concat(fe),u.label(Ko(fe)),this._cc[I].tx=void 0))):p=u,!p||!p.length||p[0]<128)return u;if(p[0]==255)return this._clear(),u;if(W=p[0]>>4,vt=(p[0]&15).toString(16),I=W==15?qe:qe+vt,this._cc[I]||(this._cc[I]={}),W==12)p._bm=this._cc[I].bm,p._bl=this._cc[I].bl,Qe.MIDI.programName&&u.label(Qe.MIDI.programName(p[1],p._bm,p._bl));else if(W==11)switch(p[1]){case 0:this._cc[I].bm=p[2];break;case 32:this._cc[I].bl=p[2];break;case 98:this._cc[I].nl=p[2],this._cc[I].rn="n";break;case 99:this._cc[I].nm=p[2],this._cc[I].rn="n";break;case 100:this._cc[I].rl=p[2],this._cc[I].rn="r";break;case 101:this._cc[I].rm=p[2],this._cc[I].rn="r";break;case 6:case 38:case 96:case 97:this._cc[I].rn=="r"&&(p._rm=this._cc[I].rm,p._rl=this._cc[I].rl,u.label(zu(this._cc[I].rm,this._cc[I].rl))),this._cc[I].rn=="n"&&(p._nm=this._cc[I].rm,p._nl=this._cc[I].nl,u.label(Zi(this._cc[I].nm,this._cc[I].nl)));break}else p.isFullSysEx()&&(p[1]==127?p[3]==4?($e={1:"Master Volume",2:"Master Balance",3:"Master Fine Tuning",4:"Master Coarse Tuning"}[p[4]],$e&&u.label($e)):p[3]==8&&($e={2:"Note Tuning",7:"Note Tuning, Bank",8:"Scale Tuning, 1 byte format",9:"Scale Tuning, 2 byte format"}[p[4]],$e&&u.label($e)):p[1]==126?p[3]==6?p[4]==1?u.label("Device ID Request"):p[4]==2&&u.label("Device ID Response"):p[3]==8?($e={0:"Bulk Tuning Dump Request",1:"Bulk Tuning Dump",3:"Bulk Tuning Dump Request, Bank",4:"Bulk Tuning Dump, Bank",5:"Scale Tuning Dump, 1 byte format",6:"Scale Tuning Dump, 2 byte format",7:"Note Tuning, Bank",8:"Scale Tuning, 1 byte format",9:"Scale Tuning, 2 byte format"}[p[4]],$e&&u.label($e)):p[3]==9&&(p[4]==1?(u.label("GM1 System On"),this._clear(qe),this._cc[qe].gm="1"):p[4]==2?(u.label("GM System Off"),this._clear(qe),this._cc[qe].gm="0"):p[4]==3&&(u.label("GM2 System On"),this._clear(qe),this._cc[qe].gm="2")):p[1]==67?(p[2]&240)==16&&p[3]==76&&(p[4]==0&&p[5]==0&&p[6]==126&&p[7]==0?(u.label("XG System On"),this._clear(qe),this._cc[qe].gm="Y"):p[4]==0&&p[5]==0&&p[6]==0?u.label("XG Master Tuning"):p[4]==0&&p[5]==0&&p[6]==4?u.label("XG Master Volume"):p[4]==0&&p[5]==0&&p[6]==6?u.label("XG Master Transpose"):p[4]==8&&p[5]<16&&p[6]>=65&&p[6]<=76?u.label("XG Scale Tuning"):u.label("XG Parameter")):p[1]==65&&p[3]==66&&p[4]==18&&(p[5]==64&&(p[6]==0?p[7]==127&&p[8]==0&&p[9]==65?(u.label("GS Reset"),this._clear(qe),this._cc[qe].gm="R"):p[7]==0?u.label("GS Master Tuning"):p[7]==4?u.label("GS Master Volume"):p[7]==5?u.label("GS Master Transpose"):u.label("GS Parameter"):(p[6]&240)==16&&p[7]==21?u.label("GS Drum Part Change"):(p[6]&240)==16&&p[7]>=64&&p[7]<=75?u.label("GS Scale Tuning"):u.label("GS Parameter")),p[5]==65&&u.label("GS Parameter")));return u}function Ln(){var u=new _e;return u._clear=aa,u._read=ca,u._receive=function(p){this._emit(this._read(p))},u.gm=function(p){return typeof p>"u"&&(p="x"),this._cc[p]&&this._cc[p].gm||0},u._clear(),u._resume(),u}Qe.Context=Ln,L.prototype.Context=Ln;function yr(){var u=this instanceof yr?this:u=new yr;return u.reset(),arguments.length&&yr.prototype.setup.apply(u,arguments),u}yr.validate=function(u){var p=u instanceof Array?u:arguments;if(p[0]!=parseInt(p[0])||p[0]<0||p[0]>14)throw RangeError("Bad master channel value: "+p[0]);if(p[1]!=parseInt(p[1])||p[1]<0||p[0]+p[1]>15)throw RangeError("Bad zone size value: "+p[1])},yr.prototype.reset=function(){for(var u=0;u<16;u++)this[u]={band:0,master:u}},yr.prototype.setup=function(u,p){yr.validate(u,p);var I,U=u+p;if(!(this[u].master==u&&this[u].band==p)&&!(!p&&!this[u].band)){for(this[u].band?(I=u+this[u].band,U<I&&(U=I)):this[u].master==u-1?(I=u-1,I=I+this[I].band,U<I&&(U=I),this[u-1]={band:0,master:u-1}):this[u].master!=u&&(I=this[u].master,I=I+this[I].band,U<I&&(U=I),this[this[u].master].band=u-this[u].master-1),this[u].master=u,this[u].band=p,I=u+1;I<=u+p;I++)this[I].band&&U<I+this[I].band&&(U=I+this[I].band),this[I]={band:0,master:u};for(;I<=U;I++)this[I]={band:0,master:I}}},yr.prototype.filter=function(u){var p=u.getChannel();if(!this[p]||!this[this[p].master].band)return u;var I=this[p].master,U=this[I].band,W,se,fe;if(typeof u._mpe<"u"){for(fe=256,W=I+1;W<=I+U;W++)if(!this[W].notes)fe>0&&(p=W,fe=0);else for(fe>this[W].notes.length&&(p=W,fe=this[W].notes.length),se=0;se<this[W].notes.length;se++)if(this[W].notes[se]==u._mpe){p=W,fe=-1;break}u.setChannel(p),u._mpe=void 0}return p==I||(u.isNoteOn()?(this[p].notes||(this[p].notes=[]),j(this[p].notes,u.getNote())):u.isNoteOff()&&this[p].notes&&X(this[p].notes,u.getNote())),u},Qe.MPE=yr;function Ct(u){var p=this instanceof Ct?this:p=new Ct,I;if(u instanceof Ct)return p._from=u._from.slice(),G(u,function(W){W!="_from"&&(p[W]=u[W])}),p;p._from=[],typeof u>"u"&&(u=[0,0,0,0]);var U=u instanceof Array?u:arguments;for(p.length=0,I=0;I<U.length;I++)l=U[I],(l!=parseInt(l)||l<0||l>255)&&pt(U[I]),p.push(l);if(p.length!=[4,4,4,8,8,16,4,4,8,8,8,12,12,16,16,16][p[0]>>4])throw RangeError("Wrong UMP size");return p}Ct.prototype=[],Ct.prototype.constructor=Ct,Ct.prototype.isMidi=function(){return 2},Ct.prototype.isMidi2=!0,Ct.prototype.dump=function(){var u,p="";for(u=0;u<this.length;u++)p+=String.fromCharCode(this[u]);return p};function di(){}di.prototype=Ct,Ct._sxid=127,Ct.sxId=function(u){if(typeof u>"u"&&(u=Ct._sxid),u==this._sxid)return this;u=He(u);var p=new di;return p._ch=this._ch,p._gr=this._gr,p._sxid=u,p},Ct.ch=function(u){if(u==this._ch||typeof u>"u"&&typeof this._ch>"u")return this;var p=new di;return typeof u<"u"&&(u=Fe(u)),p._ch=u,p._gr=this._gr,p._sxid=this._sxid,p},Ct.gr=function(u){if(u==this._gr||typeof u>"u"&&typeof this._gr>"u")return this;var p=new di;return typeof u<"u"&&(u=ut(u)),p._ch=this._ch,p._gr=u,p._sxid=this._sxid,p},Ct.prototype.getGroup=function(){if(this[0]){var u=this[0]>>4;if(u==1||u==2||u==3||u==4||u==5||u==13)return this[0]&15}};var rr=[0,0,0,0,0,0,0,0,0,0,0,0,0];function fi(u,p,I,U){return typeof p<"u"?[Cn(u),Cn(p),Cn(I),Cn(U)]:(u=xn(u),[u>>24&255,u>>16&255,u>>8&255,u&255])}function Xi(u){return u=Math.floor(u*4294967296),u>4294967295?4294967295:u<0?0:u}var la={noop:function(){return[0,0,0,0]},umpClock:function(u){return u=de(u),[0,16,u>>8,u&255]},umpTimestamp:function(u){return u=de(u),[0,32,u>>8,u&255]},umpTicksPQN:function(u){return u=de(u),[0,48,u>>8,u&255]},umpDelta:function(u){return u=u||0,u=Xe(u),[0,64+(u>>16),u>>8&255,u&255]},umpStartClip:function(){return[240,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},umpEndClip:function(){return[240,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},No={umpTempo:function(u,p){return[208+ut(u),16,0,0].concat(fi(p),[0,0,0,0,0,0,0,0])},umpBPM:function(u,p){return No.umpTempo(u,Math.round(6e9/p))},umpTimeSignature:function(u,p,I){var U,W,se,fe=(""+p).match(/^\s*(\d+)\s*\/\s*(\d+)\s*$/);if(fe?(U=parseInt(fe[1]),W=parseInt(fe[2])):p==parseInt(p)&&I==parseInt(I)&&(U=parseInt(p),W=parseInt(I)),U>0&&U<256&&W>0&&!(W&W-1)){for(se=0,W>>=1;W;W>>=1)se++;if(W=Math.round(U*32/(1<<se)),W<256)return[208+ut(u),16,0,1,U,se,W,0,0,0,0,0,0,0,0,0]}throw RangeError("Wrong time signature "+p+(typeof I>"u"?"":"/"+I))}},Ds={umpMetadata:function(u,p){return cn.umpCustomText(u,0,1,1,0,p)},umpProjectName:function(u,p){return cn.umpCustomText(u,0,1,1,1,p)},umpCompositionName:function(u,p){return cn.umpCustomText(u,0,1,1,2,p)},umpClipName:function(u,p){return cn.umpCustomText(u,0,1,1,3,p)},umpCopyright:function(u,p){return cn.umpCustomText(u,0,1,1,4,p)},umpComposerName:function(u,p){return cn.umpCustomText(u,0,1,1,5,p)},umpLyricistName:function(u,p){return cn.umpCustomText(u,0,1,1,6,p)},umpArrangerName:function(u,p){return cn.umpCustomText(u,0,1,1,7,p)},umpPublisherName:function(u,p){return cn.umpCustomText(u,0,1,1,8,p)},umpPerformerName:function(u,p){return cn.umpCustomText(u,0,1,1,9,p)},umpAccPerformerName:function(u,p){return cn.umpCustomText(u,0,1,1,10,p)},umpRecordingDate:function(u,p){return cn.umpCustomText(u,0,1,1,11,p)},umpRecordingLocation:function(u,p){return cn.umpCustomText(u,0,1,1,12,p)},umpText:function(u,p){return cn.umpCustomText(u,0,1,2,0,p)},umpLyrics:function(u,p){return cn.umpCustomText(u,0,1,2,1,p)},umpLyricsLanguage:function(u,p){return cn.umpCustomText(u,0,1,2,2,p)},umpRuby:function(u,p){return cn.umpCustomText(u,0,1,2,3,p)},umpRubyLanguage:function(u,p){return cn.umpCustomText(u,0,1,2,4,p)},umpData:function(u,p,I){typeof I>"u"&&(I=p,p=0);var U,W=go(Oc(I),13);for(U=0;U<W.length;U++)W[U]=[80+ut(u),Bo(W.length,U)*16+W[U].length,Cn(p)].concat(W[U],rr).slice(0,16);return W}},Ua=[0,6,32,38,98,99,100,101],Vn={umpNoteOn:function(u,p,I,U,W,se){return typeof U>"u"&&(U=65535),W=W||0,se=se||0,U=de(U),se=de(se),[64+ut(u),144+Fe(p),Ot(I),Cn(W),U>>8,U&255,se>>8,se&255]},umpNoteOff:function(u,p,I,U,W,se){return U=U||0,W=W||0,se=se||0,U=de(U),se=de(se),[64+ut(u),128+Fe(p),Ot(I),Cn(W),U>>8,U&255,se>>8,se&255]},umpAftertouch:function(u,p,I,U,W,se,fe){return[64+ut(u),160+Fe(p),Ot(I),0].concat(fi(U,W,se,fe))},umpAftertouchF:function(u,p,I,U){return Vn.umpAftertouch(u,p,I,Xi(U))},umpControl:function(u,p,I,U,W,se,fe){return Ua.includes(I)&&pt(I),[64+ut(u),176+Fe(p),He(I),0].concat(fi(U,W,se,fe))},umpPortamento:function(u,p,I){return[64+ut(u),176+Fe(p),84,0,Ot(I),0,0,0]},umpPressure:function(u,p,I,U,W,se){return[64+ut(u),208+Fe(p),0,0].concat(fi(I,U,W,se))},umpPressureF:function(u,p,I){return Vn.umpPressure(u,p,Xi(I))},umpProgram:function(u,p,I,U,W){return typeof U>"u"&&typeof W>"u"?[64+ut(u),192+Fe(p),0,0,Ot(I),0,0,0]:typeof W>"u"?[64+ut(u),192+Fe(p),0,1,Ot(I),0,Wt(U),wt(U)]:[64+ut(u),192+Fe(p),0,1,Ot(I),0,He(U),He(W)]},umpPitchBend:function(u,p,I,U,W,se){return[64+ut(u),224+Fe(p),0,0].concat(fi(I,U,W,se))},umpPitchBendF:function(u,p,I){return Vn.umpPitchBend(u,p,Xi((I+1)/2))},umpPnPitchBend:function(u,p,I,U,W,se,fe){return[64+ut(u),96+Fe(p),Ot(I),0].concat(fi(U,W,se,fe))},umpPnPitchBendF:function(u,p,I,U){return Vn.umpPnPitchBend(u,p,I,Xi((U+1)/2))},umpRPN:function(u,p,I,U,W,se,fe,$e){return[64+ut(u),32+Fe(p),He(I),He(U)].concat(fi(W,se,fe,$e))},umpNRPN:function(u,p,I,U,W,se,fe,$e){return[64+ut(u),48+Fe(p),He(I),He(U)].concat(fi(W,se,fe,$e))},umpPnRPN:function(u,p,I,U,W,se,fe,$e){return[64+ut(u),0+Fe(p),Ot(I),Cn(U)].concat(fi(W,se,fe,$e))},umpPnNRPN:function(u,p,I,U,W,se,fe,$e){return[64+ut(u),16+Fe(p),Ot(I),Cn(U)].concat(fi(W,se,fe,$e))},umpFineTuning:function(u,p,I,U,W,se){return Vn.umpRPN(u,p,0,1,I,U,W,se)},umpFineTuningF:function(u,p,I){return Vn.umpFineTuning(u,p,J.to32b(tr((I%1+1)/2,I)))},umpCoarseTuning:function(u,p,I){return[64+ut(u),32+Fe(p),0,2,He(I)*2,0,0,0]},umpCoarseTuningF:function(u,p,I){return Vn.umpCoarseTuning(u,p,64+(I-I%1))},umpTuningProgram:function(u,p,I){return[64+ut(u),32+Fe(p),0,3,He(I)*2,0,0,0]},umpTuningBank:function(u,p,I){return[64+ut(u),32+Fe(p),0,4,He(I)*2,0,0,0]},umpPnManagement:function(u,p,I,U){for(var W=U.toString().split(""),se=0,fe=0;fe<W.length;fe++)if(W[fe]=="S"&&!(se&1))se|=1;else if(W[fe]=="D"&&!(se&2))se|=2;else{se=U;break}return[64+ut(u),240+Fe(p),Ot(I),Cn(se),0,0,0,0]}};Vn.umpPnPressure=Vn.umpAftertouch,Vn.umpPnPressureF=Vn.umpAftertouchF,Vn.umpTranspose=Vn.umpCoarseTuningF;var cn={umpTuningF:function(u,p,I){return[Vn.umpCoarseTuningF(u,p,I),Vn.umpFineTuningF(u,p,I)]},umpTuningA:function(u,p,I){return cn.umpTuningF(u,p,J.shift(I))},umpCustomText:function(u,p,I,U,W,se){var fe,$e=[];for(se=Qe.lib.toUTF8(""+se),fe=0;fe<se.length;fe++)$e.push(se.charCodeAt(fe));for($e=go($e,12),fe=0;fe<$e.length;fe++)$e[fe]=[208+ut(u),Bo($e.length,fe)*64+(I?16:0)+Fe(p),U,W].concat($e[fe],rr).slice(0,16);return $e},umpCMetadata:function(u,p,I){return cn.umpCustomText(u,p,0,1,0,I)},umpCProjectName:function(u,p,I){return cn.umpCustomText(u,p,0,1,1,I)},umpCCompositionName:function(u,p,I){return cn.umpCustomText(u,p,0,1,2,I)},umpCClipName:function(u,p,I){return cn.umpCustomText(u,p,0,1,3,I)},umpCCopyright:function(u,p,I){return cn.umpCustomText(u,p,0,1,4,I)},umpCComposerName:function(u,p,I){return cn.umpCustomText(u,p,0,1,5,I)},umpCLyricistName:function(u,p,I){return cn.umpCustomText(u,p,0,1,6,I)},umpCArrangerName:function(u,p,I){return cn.umpCustomText(u,p,0,1,7,I)},umpCPublisherName:function(u,p,I){return cn.umpCustomText(u,p,0,1,8,I)},umpCPerformerName:function(u,p,I){return cn.umpCustomText(u,p,0,1,9,I)},umpCAccPerformerName:function(u,p,I){return cn.umpCustomText(u,p,0,1,10,I)},umpCRecordingDate:function(u,p,I){return cn.umpCustomText(u,p,0,1,11,I)},umpCRecordingLocation:function(u,p,I){return cn.umpCustomText(u,p,0,1,12,I)},umpCText:function(u,p,I){return cn.umpCustomText(u,p,0,2,0,I)},umpCLyrics:function(u,p,I){return cn.umpCustomText(u,p,0,2,1,I)},umpCLyricsLanguage:function(u,p,I){return cn.umpCustomText(u,p,0,2,2,I)},umpCRuby:function(u,p,I){return cn.umpCustomText(u,p,0,2,3,I)},umpCRubyLanguage:function(u,p,I){return cn.umpCustomText(u,p,0,2,4,I)}},Vr={};function Nl(u,p){Ct[u]=function(){return new Ct(p.apply(this,arguments))},Vr[u]=function(){return this.send(p.apply(this,arguments))}}function qo(u,p){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),new Ct(p.apply(this,I))},Vr[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),this.send(p.apply(this,I))}}function ua(u,p){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var U=p.apply(this,I),W=0;W<U.length;W++)U[W]=new Ct(U[W]);return U},Vr[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var U=p.apply(this,I),W=0;W<U.length;W++)this.send(U[W]);return this}}function da(u,p){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),new Ct(p.apply(this,I))},Vr[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),this.send(p.apply(this,I))}}function zr(u,p){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var U=p.apply(this,I),W=0;W<U.length;W++)U[W]=new Ct(U[W]);return U},Vr[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var U=p.apply(this,I),W=0;W<U.length;W++)this.send(U[W]);return this}}function Bo(u,p){return u==1?0:p==0?1:p==u-1?3:2}function go(u,p){for(var I=[],U=u;U.length;U=U.slice(p))I.push(U.slice(0,p));return I.length?I:[[]]}function mo(u,p){for(var I=go(p.slice(1,p.length-1),6),U=0;U<I.length;U++)I[U]=new Ct([48+u,Bo(I.length,U)*16+I[U].length].concat(I[U],rr).slice(0,8));return I}function Oc(u){var p,I=[];if(typeof u=="string")for(p=0;p<u.length;p++)I.push(u.charCodeAt(p));else for(p=0;p<u.length;p++)I.push(u[p]);for(p=0;p<I.length;p++)if(I[p]!=parseInt(I[p])||I[p]<0||I[p]>255)throw RangeError("Bad data");return I}function Ms(u,p){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),mo(ut(I[0]),p.apply(this,I.slice(1)))},Vr[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var U=mo(ut(I[0]),p.apply(this,I.slice(1))),W=this,se=0;se<U.length;se++)W=W.send(U[se]);return W}}function Yo(u,p){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var U=p.apply(this,I.slice(1)),W=[],se=0;se<U.length;se++)W=W.concat(mo(ut(I[0]),U[se]));return W},Vr[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var U=p.apply(this,I.slice(1)),W=this,se=0;se<U.length;se++)for(var fe=mo(ut(I[0]),U[se]),$e=0;$e<fe.length;$e++)W=W.send(fe[$e]);return W}}function Oo(u,p){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),new Ct([16+ut(I[0])].concat(p.apply(this,I.slice(1)),rr).slice(0,4))},Vr[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),this.send([16+ut(I[0])].concat(p.apply(this,I.slice(1)),rr).slice(0,4))}}function Ns(u,p){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),new Ct([32+ut(I[0])].concat(p.apply(this,I.slice(1)),rr).slice(0,4))},Vr[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),this.send([32+ut(I[0])].concat(p.apply(this,I.slice(1)),rr).slice(0,4))}}function Fc(u,p){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var U=p.apply(this,I.slice(1)),W=0;W<U.length;W++)U[W]=new Ct([32+ut(I[0])].concat(U[W],rr).slice(0,4));return U},Vr[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var U=p.apply(this,I.slice(1)),W=this,se=0;se<U.length;se++)W=W.send([32+ut(I[0])].concat(U[se],rr).slice(0,4));return W}}G(la,function(u){Nl(u,la[u])}),G(No,function(u){qo(u,No[u])}),G(Ds,function(u){ua(u,Ds[u])}),G(Vn,function(u){da(u,Vn[u])}),G(cn,function(u){zr(u,cn[u])}),G(Hi,function(u){Oo(u,Hi[u])}),G(jr,function(u){Ns(u,jr[u])}),G(At,function(u){Ns(u,At[u])}),G(rn,function(u){Fc(u,rn[u])}),G(kt,function(u){Ms(u,kt[u])}),G(D,function(u){Yo(u,D[u])});function ja(u){G(Vr,function(p){u.prototype[p]=Vr[p]})}ja(Dt),Ct.prototype.getTempo=function(){if(this.isTempo())return(this[4]<<24)+(this[5]<<16)+(this[6]<<8)+this[7]},Ct.prototype.getBPM=function(){var u=this.getTempo();if(u)return Math.round(6e9/u)},Ct.prototype.getTimeSignature=function(){if(this.isTimeSignature())return[this[4],1<<this[5]]},Ct.prototype.getTicksPQN=function(){if(this.isTicksPQN())return(this[2]<<8)+this[3]},Ct.prototype.getDelta=function(){if(this.isDelta())return((this[1]&15)<<16)+(this[2]<<8)+this[3]},Ct.prototype.getStatus=function(){if(this.isFlex())return this[1]>>6;if(this.isData()||this.isSX())return this[1]>>4},Ct.prototype.isTempo=function(){return this[0]>>4==13&&this[1]>>4==1&&this[2]==0&&this[3]==0},Ct.prototype.isTimeSignature=function(){return this[0]>>4==13&&this[1]>>4==1&&this[2]==0&&this[3]==1},Ct.prototype.isTicksPQN=function(){return this[0]==0&&this[1]>>4==3},Ct.prototype.isDelta=function(){return this[0]==0&&this[1]>>4==4},Ct.prototype.isStartClip=function(){return this.match([240,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},Ct.prototype.isEndClip=function(){return this.match([240,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},Ct.prototype.isData=function(){return(this[0]&240)==80},Ct.prototype.isFlex=function(){return(this[0]&240)==208},Ct.prototype.isText=function(){return(this[0]&240)==208&&(this[2]==1||this[2]==2)},Ct.prototype.isSX=function(){return(this[0]&240)==48},Ct.prototype.isNoteOn=function(){var u=(this[0]||0)>>4,p=(this[1]||0)>>4;return u==4?p==9:u==2?p==9&&!!this[3]:!1},Ct.prototype.isNoteOff=function(){var u=(this[0]||0)>>4,p=(this[1]||0)>>4;return u==4?p==8:u==2?p==8||p==9&&!this[3]:!1},Ct.prototype.label=J.prototype.label,Ct.prototype.toString=J.prototype.toString,Ct.prototype._str=function(){var u=this._string();return u?fo(this)+" -- "+u:fo(this)},Ct.prototype._string=function(){var u,p,I,U=this[0]>>4;return U==1||U==2?new J(this.slice(1))._string():(U==0?(u=this[1]>>4,p=["NOOP","JR Clock","JR Timestamp","Ticks Per Quarter Note","Delta Ticks"][u]):U==3?p="SysEx":U==4?(u=this[1]>>4,p={0:"Registered Per-Note Controller",1:"Assignable Per-Note Controller",2:"Registered Controller",3:"Assignable Controller",4:"Relative Registered Controller",5:"Relative Assignable Controller",6:"Per-Note Pitch Bend",8:"Note Off",9:"Note On",10:"Poly Pressure",11:"Control Change",12:"Program Change",13:"Channel Pressure",14:"Pitch Bend",15:"Per-Note Management"}[u],u==11&&(p={84:"Portamento"}[this[2]]||p),u==2&&(I={"0000":"Pitch Bend Sensitivity","0001":"Fine Tuning","0002":"Coarse Tuning","0003":"Select Tuning Program","0004":"Select Tuning Bank","0005":"Vibrato Depth Range","7f7f":"NONE"}[Qn(this[2])+""+Qn(this[3])],I&&(p+=": "+I))):U==5?p="Data":U==13&&(u=this[2],u==0?(u=this[3],p={0:"Tempo ",1:"Time Signature ",2:"Metronome",5:"Key Signature",6:"Chord Name"}[u],u==0?p+=this.getBPM()+" BPM":u==1&&(p+=this.getTimeSignature().join("/"))):u==1?(u=this[3],p={0:"Metadata",1:"Project Name",2:"Composition Name",3:"Clip Name",4:"Copyright",5:"Composer Name",6:"Lyricist Name",7:"Arranger Name",8:"Publisher Name",9:"Primary Performer Name",10:"Accompanying Performer Name",11:"Recording Date",12:"Recording Location"}[u]||"Unknown Text"):u==2&&(u=this[3],p={0:"Text",1:"Lyrics",2:"Lyrics Language",3:"Ruby",4:"Ruby Language"}[u]||"Unknown Text")),U==15&&(p={32:"Start of Clip",33:"End of Clip"}[this[1]]),p)},Ct.prototype._stamp=J.prototype._stamp,Ct.prototype._unstamp=J.prototype._unstamp,Ct.prototype._stamped=J.prototype._stamped,Ct.prototype.match=J.prototype.match,Qe.UMP=Ct,L.prototype.UMP=Ct,Qe.MIDI2=Ct,L.prototype.MIDI2=Ct;function Lc(u,p){var I=u*256+p;return I?I>>9||1:0}function Wr(u,p,I,U){var W=u*16777216+p*65536+I*256+U;return W>>25&127}function Ar(u,p){return u.gr=p,u}function Uc(u){if(u.isMidi2){var p,I,U,W=u[0]>>4,se=u[0]&15;if(W==1||W==2)this._emit(Ar(new J(u.slice(1)),se));else if(W==3)I=u[1]>>4,p=u[1]&15,I==0?(this._emit(Ar(new J([240].concat(u.slice(2,2+p),[247])),se)),this._sx[se]=void 0):I==1?this._sx[se]=u.slice(2,2+p):I==2?this._sx[se]&&(this._sx[se]=this._sx[se].concat(u.slice(2,2+p))):I==3&&(this._sx[se]&&this._emit(Ar(new J([240].concat(this._sx[se],u.slice(2,2+p),[247])),se)),this._sx[se]=void 0);else if(W==4){if(p=u[1]>>4,I=u[1]&15,p==2||p==3?(this._emit(Ar(new J([176+I,p==2?101:99,u[2]]),se)),this._emit(Ar(new J([176+I,p==2?100:98,u[3]]),se)),this._emit(Ar(new J([176+I,6,u[4]>>1]),se)),this._emit(Ar(new J([176+I,38,(u[4]&1)*64+(u[4]>>2)]),se))):(p==8||p==9)&&this._emit(Ar(new J([u[1],u[2],Lc(u[4],u[5])]),se)),p==10&&this._emit(Ar(new J([u[1],u[2],Wr(u[4],u[5],u[6],u[7])]),se)),p==11){if(Ua.includes(u[2]))return;this._emit(Ar(new J([u[1],u[2],Wr(u[4],u[5],u[6],u[7])]),se))}p==13&&this._emit(Ar(new J([u[1],Wr(u[4],u[5],u[6],u[7])]),se)),p==14?(U=u[4]*16777216+u[5]*65536+u[6]*256+u[4]>>18,this._emit(Ar(new J([u[1],U&127,U>>7&127]),se))):p==12&&(u[3]&&(this._emit(Ar(new J([176+I,0,u[6]]),se)),this._emit(Ar(new J([176+I,32,u[7]]),se))),this._emit(Ar(new J([u[1],u[4]]),se)))}}else this._emit(u)}function Wu(){var u=new _e;return u._sx=[],u._receive=Uc,u._resume(),u.MIDI2()}Qe.M2M1=Wu,L.prototype.M2M1=Qe.M2M1;function Bl(u){if(u.isMidi2)this._emit(u);else{var p=u.gr>=0&&u.gr<=15?u.gr:0;if(u[0]>=128&&u[0]<240)this._emit(Qe.MIDI2([32+p].concat(u.slice(),rr).slice(0,4)));else if(u[0]>240&&u[0]<=255&&u[0]!=247)this._emit(Qe.MIDI2([16+p].concat(u.slice(),rr).slice(0,4)));else if(u.isFullSysEx())for(var I=mo(p,u.slice()),U=0;U<I.length;U++)this._emit(Qe.MIDI2(I[U]))}}function Ga(){var u=new _e;return u._receive=Bl,u._resume(),u}Qe.M1M2=Ga,L.prototype.M1M2=Qe.M1M2,Qe.lib={},Qe.lib.now=m,Qe.lib.schedule=g,Qe.lib.R=x;var Va=[],Fo,Bs=0;try{var za=URL.createObjectURL(new Blob(["(",(function(){function u(){postMessage({}),setTimeout(u,0)}u()}).toString(),")()"],{type:"application/javascript"})),Ol=function(){for(var u=Va.length,p=0;p<u;p++)Va.shift()();Bs++,Bs>20&&Fo&&(Fo.terminate(),Fo=void 0)},jc=function(u){Va.push(u),Bs=0,Fo||(Fo=new Worker(za),Fo.onmessage=Ol)};jc(function(){Qe.lib.schedule=jc})}catch{}Qe.lib.openMidiOut=function(u,p){var I=new _e;return p._openOut(I),I._info=p._info(u),I},Qe.lib.openMidiIn=function(u,p){var I=new _e;return p._openIn(I),I._info=p._info(u),I},Qe.lib.registerMidiOut=function(u,p){for(var I=p._info(u),U=0;U<nn._outs.length;U++)if(nn._outs[U].name==I.name)return!1;return I.engine=p,nn._outs.push(I),ct&&(Ae(),ct._bad&&(ct._repair(),ct._resume())),!0},Qe.lib.registerMidiIn=function(u,p){for(var I=p._info(u),U=0;U<nn._ins.length;U++)if(nn._ins[U].name==I.name)return!1;return I.engine=p,nn._ins.push(I),ct&&(Ae(),ct._bad&&(ct._repair(),ct._resume())),!0},Qe.lib.unregisterMidiOut=function(u){for(var p=0;p<nn._outs.length;p++)if(nn._outs[p].name==u)return nn._outs.splice(p,p+1),ct&&Ae(),!0;return!1},Qe.lib.unregisterMidiIn=function(u){for(var p=0;p<nn._ins.length;p++)if(nn._ins[p].name==u)return nn._ins.splice(p,p+1),ct&&Ae(),!0;return!1},Qe.lib.plug=function(u){for(var p=0;p<pn.length;p++)if(pn[p]==u)return;pn.push(u)},Qe.lib.unplug=function(u){for(var p=0;p<pn.length;p++)if(pn[p]==u){pn.splice(p,1);return}};var Cr;function Gc(){if(!Cr&&typeof window<"u"){var u=window.AudioContext||window.webkitAudioContext;if(u){Cr=new u,Cr&&!Cr.createGain&&(Cr.createGain=Cr.createGainNode);var p=function(){if(Cr.state!="running"){Cr.resume();var I=Cr.createOscillator(),U=Cr.createGain();try{U.gain.value=0}catch{}U.gain.setTargetAtTime(0,Cr.currentTime,.01),I.connect(U),U.connect(Cr.destination),I.start||(I.start=I.noteOn),I.stop||(I.stop=I.noteOff),I.start(.1),I.stop(.11)}else typeof document<"u"&&(document.removeEventListener("touchstart",p),document.removeEventListener("touchend",p),document.removeEventListener("mousedown",p),document.removeEventListener("keydown",p))};typeof document<"u"&&(document.addEventListener("touchstart",p),document.addEventListener("touchend",p),document.addEventListener("mousedown",p),document.addEventListener("keydown",p)),p()}}}Qe.lib.copyMidiHelpers=sn,Qe.lib.copyMidi2Helpers=ja,Qe.lib.copyUmpHelpers=ja,Qe.lib.getAudioContext=function(){return Gc(),Cr},Qe.lib.closeAudioContext=function(){Cr&&Cr.close(),Cr=void 0};var vo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Qe.lib.fromBase64=function(u){var p="",I,U,W,se,fe,$e,qe,vt=0;for(u=u.replace(/[^A-Za-z0-9+/=]/g,"");vt<u.length;)se=vo.indexOf(u.charAt(vt++)),fe=vo.indexOf(u.charAt(vt++)),$e=vo.indexOf(u.charAt(vt++)),qe=vo.indexOf(u.charAt(vt++)),I=se<<2|fe>>4,U=(fe&15)<<4|$e>>2,W=($e&3)<<6|qe,p=p+String.fromCharCode(I),$e!=64&&(p=p+String.fromCharCode(U)),qe!=64&&(p=p+String.fromCharCode(W));return p},Qe.lib.toBase64=function(u){var p,I,U,W,se,fe,$e,qe,vt=0,br=0,Lo="",Ll=[];if(!u)return u;do p=u.charCodeAt(vt++),I=u.charCodeAt(vt++),U=u.charCodeAt(vt++),qe=p<<16|I<<8|U,W=qe>>18&63,se=qe>>12&63,fe=qe>>6&63,$e=qe&63,Ll[br++]=vo.charAt(W)+vo.charAt(se)+vo.charAt(fe)+vo.charAt($e);while(vt<u.length);Lo=Ll.join("");var Hu=u.length%3;return Hu?Lo.slice(0,Hu-3)+"===".slice(Hu):Lo},Qe.lib.fromUTF8=function(u){u=typeof u>"u"?"":""+u;var p="",I,U,W;for(I=0;I<u.length;I++){if(U=u.charCodeAt(I),U>255)return u;if(U<128)p+=u[I];else if((U&224)==192){if(U=(U&31)<<6,I++,I>=u.length||(W=u.charCodeAt(I),(W&192)!=128))return u;U+=W&63,p+=String.fromCharCode(U)}else if((U&240)==224){if(U=(U&15)<<12,I++,I>=u.length||(W=u.charCodeAt(I),(W&192)!=128)||(U+=(W&63)<<6,I++,I>=u.length)||(W=u.charCodeAt(I),(W&192)!=128))return u;U+=W&63,p+=String.fromCharCode(U)}else if((U&248)==240){if(U=(U&7)<<18,I++,I>=u.length||(W=u.charCodeAt(I),(W&192)!=128)||(U+=(W&63)<<12,I++,I>=u.length)||(W=u.charCodeAt(I),(W&192)!=128)||(U+=(W&63)<<6,I++,I>=u.length)||(W=u.charCodeAt(I),(W&192)!=128)||(U+=W&63,U>1114111))return u;U-=65536,p+=String.fromCharCode(55296+(U>>10)),p+=String.fromCharCode(56320+(U&1023))}}return p},Qe.lib.toUTF8=function(u){u=typeof u>"u"?"":""+u;var p="",I,U;for(I=0;I<u.length;I++)U=u.charCodeAt(I),U<128?p+=u[I]:U<2048?(p+=String.fromCharCode(192+(U>>6)),p+=String.fromCharCode(128+(U&63))):U<65536?(p+=String.fromCharCode(224+(U>>12)),p+=String.fromCharCode(128+(U>>6&63)),p+=String.fromCharCode(128+(U&63))):(p+=String.fromCharCode(240+(U>>18)),p+=String.fromCharCode(128+(U>>12&63)),p+=String.fromCharCode(128+(U>>6&63)),p+=String.fromCharCode(128+(U&63)));return p};var R=[],z={},Y={},re=t.Promise;typeof re!="function"&&(re=function(u){this.executor=u},re.prototype.then=function(u,p){typeof u!="function"&&(u=y),typeof p!="function"&&(p=y),this.executor(u,p)});function Me(u,p,I){this.name=u,this.message=p,this.code=I}function Re(u,p){this.bubbles=!1,this.cancelBubble=!1,this.cancelable=!1,this.currentTarget=p,this.defaultPrevented=!1,this.eventPhase=0,this.path=[],this.port=u,this.returnValue=!0,this.srcElement=p,this.target=p,this.timeStamp=m(),this.type="statechange"}function Ke(u,p){this.bubbles=!1,this.cancelBubble=!1,this.cancelable=!1,this.currentTarget=u,this.data=p,this.defaultPrevented=!1,this.eventPhase=0,this.path=[],this.receivedTime=m(),this.returnValue=!0,this.srcElement=u,this.target=u,this.timeStamp=this.receivedTime,this.type="midimessage"}function et(u,p){u&&(u.onstatechange&&u.onstatechange(new Re(u,u)),p.onstatechange&&p.onstatechange(new Re(u,p)))}function $t(u,p){var I=this,U=!1,W=null,se=null;this.type="input",this.id=p.id,this.name=p.name,this.manufacturer=p.man,this.version=p.ver,Object.defineProperty(this,"state",{get:function(){return p.connected?"connected":"disconnected"},enumerable:!0}),Object.defineProperty(this,"connection",{get:function(){return U?p.proxy?"open":"pending":"closed"},enumerable:!0}),Object.defineProperty(this,"onmidimessage",{get:function(){return se},set:function(fe){C(fe)?(se=fe,U||I.open().then(y,y)):se=null},enumerable:!0}),Object.defineProperty(this,"onstatechange",{get:function(){return W},set:function(fe){C(fe)?W=fe:W=null},enumerable:!0}),this.open=function(){return new re(function(fe,$e){U?fe(I):p.open().then(function(){U||(U=!0,et(I,u)),fe(I)},function(){$e(new Me("InvalidAccessError","Port is not available",15))})})},this.close=function(){return new re(function(fe){U&&(U=!1,p.close(),et(I,u)),fe(I)})},Object.freeze(this)}function ln(u){for(var p,I;u.length;){for(p=0;p<u.length&&!(u[p]==parseInt(u[p])&&u[p]>=128&&u[p]<=255&&u[p]!=247);p++);if(u.splice(0,p),!u.length)return;if(u[0]==240){for(p=1;p<u.length&&u[p]!=247;p++);return p==u.length?void 0:u.splice(0,p+1)}else{if(I=jn(u[0])+1,I>u.length)return;for(p=1;p<I&&!(u[p]!=parseInt(u[p])||u[p]<0||u[p]>=128);p++);if(p==I)return u.splice(0,p);u.splice(0,p)}}}function Zt(u,p,I,U){var W=this;this.id=u,this.name=p,this.man=I,this.ver=U,this.connected=!0,this.ports=[],this.pending=[],this.proxy=void 0,this.queue=[],this.onmidi=function(se){var fe;for(W.queue=W.queue.concat(se.slice()),fe=ln(W.queue);fe;fe=ln(W.queue))for(i=0;i<W.ports.length;i++)W.ports[i][0].onmidimessage&&(fe[0]!=240||W.ports[i][1])&&W.ports[i][0].onmidimessage(new Ke(W,new Uint8Array(fe)))}}Zt.prototype.open=function(){var u=this;return new re(function(p,I){var U;u.proxy||!u.connected?p():(u.pending.push([p,I]),u.pending.length==1&&Qe().openMidiIn(u.name).or(function(){for(U=0;U<u.pending.length;U++)u.pending[U][1]();u.pending=[]}).and(function(){for(u.proxy=this,u.proxy.connect(u.onmidi),U=0;U<u.pending.length;U++)u.pending[U][0]();u.pending=[]}))})},Zt.prototype.close=function(){var u;if(this.proxy){for(u=0;u<this.ports.length;u++)if(this.ports[u].connection=="open")return;this.proxy.close(),this.proxy=void 0}},Zt.prototype.disconnect=function(){this.connected=!1,this.proxy&&(this.proxy.close(),this.proxy=void 0)},Zt.prototype.reconnect=function(){var u=this,p,I,U=[];for(this.connected=!0,p=0;p<R.length;p++)I=R[p].inputs.get(this.id),I.connection=="closed"?et(I,R[p]):U.push([I,R[p]]);U.length&&Qe()._openMidiInNR(u.name).or(function(){for(p=0;p<U.length;p++)U[p][0].close()}).and(function(){for(u.proxy=this,u.proxy.connect(u.onmidi),p=0;p<U.length;p++)et(U[p][0],U[p][1])})};function jn(u){return u>=128&&u<=191||u>=224&&u<=239||u==242?2:u>=192&&u<=223||u==241||u==243?1:0}var xr="Failed to execute 'send' on 'MIDIOutput': ";function wi(u,p){var I,U,W,se=[];for(I=0;I<u.length;I++)if(u[I]!=parseInt(u[I])||u[I]<0||u[I]>255)throw TypeError(xr+u[I]+" is not a UInt8 value.");for(U=0,I=0;I<u.length;I++)if(U){if(u[I]>127)throw TypeError(xr+"Unexpected status byte at index "+I+" ("+u[I]+").");W.push(u[I]),U--}else{if(u[I]<128)throw TypeError(xr+"Running status is not allowed at index "+I+" ("+u[I]+").");if(u[I]==247)throw TypeError(xr+"Unexpected end of system exclusive message at index "+I+" ("+u[I]+").");if(W=[u[I]],se.push(W),u[I]==240){if(!p)throw new Me("InvalidAccessError",xr+"System exclusive messag is not allowed at index "+I+" ("+u[I]+").",15);for(U=-1;I<u.length;I++)if(W.push(u[I]),u[I]==247){U=0;break}}else U=jn(u[I])}if(U)throw TypeError(xr+"Message is incomplete");return[se]}function Si(u,p){var I=this,U=!1,W=null;this.type="output",this.id=p.id,this.name=p.name,this.manufacturer=p.man,this.version=p.ver,Object.defineProperty(this,"state",{get:function(){return p.connected?"connected":"disconnected"},enumerable:!0}),Object.defineProperty(this,"connection",{get:function(){return U?p.proxy?"open":"pending":"closed"},enumerable:!0}),Object.defineProperty(this,"onstatechange",{get:function(){return W},set:function(se){C(se)?W=se:W=null},enumerable:!0}),this.open=function(){return new re(function(se,fe){U?se(I):p.open().then(function(){U||(U=!0,et(I,u)),se(I)},function(){fe(new Me("InvalidAccessError","Port is not available",15))})})},this.close=function(){return new re(function(se){U&&(U=!1,I.clear(),p.close(),et(I,u)),se(I)})},this.clear=function(){},this.send=function(se,fe){if(wi(se,u.sysexEnabled),!p.connected)throw new Me("InvalidStateError","Port is not connected",11);if(U){var $e=m();fe>$e?setTimeout(function(){p.proxy.send(se)},fe-$e):p.proxy.send(se)}else this.open().then(function(){I.send(se,fe)},y)},Object.freeze(this)}function $i(u,p,I,U){this.id=u,this.name=p,this.man=I,this.ver=U,this.connected=!0,this.ports=[],this.pending=[],this.proxy=void 0}$i.prototype.open=function(){var u=this;return new re(function(p,I){var U;u.proxy||!u.connected?p():(u.pending.push([p,I]),u.pending.length==1&&Qe().openMidiOut(u.name).or(function(){for(U=0;U<u.pending.length;U++)u.pending[U][1]();u.pending=[]}).and(function(){for(u.proxy=this,U=0;U<u.pending.length;U++)u.pending[U][0]();u.pending=[]}))})},$i.prototype.close=function(){var u;if(this.proxy){for(u=0;u<this.ports.length;u++)if(this.ports[u].connection=="open")return;this.proxy.close(),this.proxy=void 0}},$i.prototype.disconnect=function(){this.connected=!1,this.proxy&&(this.proxy.close(),this.proxy=void 0)},$i.prototype.reconnect=function(){var u=this,p,I,U=[];for(this.connected=!0,p=0;p<R.length;p++)I=R[p].outputs.get(this.id),I.connection=="closed"?et(I,R[p]):U.push([I,R[p]]);U.length&&Qe()._openMidiOutNR(u.name).or(function(){for(p=0;p<U.length;p++)U[p][0].close()}).and(function(){for(u.proxy=this,p=0;p<U.length;p++)et(U[p][0],U[p][1])})};function Wa(u){this.has=function(p){return u.hasOwnProperty(p)&&u[p].connected},this.keys=function(){try{var p=new Map;for(var I in u)this.has(I)&&p.set(I,this.get(I));return p.keys()}catch{}},this.values=function(){try{var p=new Map;for(var I in u)this.has(I)&&p.set(I,this.get(I));return p.values()}catch{}},this.entries=function(){try{var p=new Map;for(var I in u)this.has(I)&&p.set(I,this.get(I));return p.entries()}catch{}},this.forEach=function(p,I){typeof I>"u"&&(I=this);for(var U in u)this.has(U)&&p.call(I,this.get(U),U,this)},Object.defineProperty(this,"size",{get:function(){var p=0;for(var I in u)this.has(I)&&p++;return p},enumerable:!0})}function Mi(u,p){this.get=function(I){if(Y.hasOwnProperty(I)&&Y[I].connected)return p[I]||(p[I]=new $t(u,Y[I]),Y[I].ports.push([p[I],u.sysexEnabled])),p[I]},Object.freeze(this)}Mi.prototype=new Wa(Y),Mi.prototype.constructor=Mi;function Fl(u,p){this.get=function(I){if(z.hasOwnProperty(I)&&z[I].connected)return p[I]||(p[I]=new Si(u,z[I]),z[I].ports.push([p[I],u.sysexEnabled])),p[I]},Object.freeze(this)}Fl.prototype=new Wa(z),Fl.prototype.constructor=Fl;function rg(u){var p,I,U,W;for(p=0;p<u.inputs.added.length;p++)U=u.inputs.added[p],Y.hasOwnProperty(U.id)||(Y[U.id]=new Zt(U.id,U.name,U.manufacturer,U.version)),Y[U.id].reconnect();for(p=0;p<u.outputs.added.length;p++)U=u.outputs.added[p],z.hasOwnProperty(U.id)||(z[U.id]=new $i(U.id,U.name,U.manufacturer,U.version)),z[U.id].reconnect();for(p=0;p<u.inputs.removed.length;p++)if(U=u.inputs.removed[p],Y.hasOwnProperty(U.id)){for(W=[],I=0;I<R.length;I++)W.push([R[I].inputs.get(U.id),R[I]]);for(Y[U.id].disconnect(),I=0;I<W.length;I++)et(W[I][0],W[I][1])}for(p=0;p<u.outputs.removed.length;p++)if(U=u.outputs.removed[p],z.hasOwnProperty(U.id)){for(W=[],I=0;I<R.length;I++)W.push([R[I].outputs.get(U.id),R[I]]);for(z[U.id].disconnect(),I=0;I<W.length;I++)et(W[I][0],W[I][1])}}function ig(u){var p={},I={},U=null,W=this;this.sysexEnabled=u,this.inputs=new Mi(W,p),this.outputs=new Fl(W,I),Object.defineProperty(this,"onstatechange",{get:function(){return U},set:function(qe){U=C(qe)?qe:null},enumerable:!0}),Object.freeze(this);var se,fe,$e=ct._info;for(se=0;se<$e.inputs.length;se++)fe=$e.inputs[se],Y.hasOwnProperty(fe.id)||(Y[fe.id]=new Zt(fe.id,fe.name,fe.manufacturer,fe.version));for(se=0;se<$e.outputs.length;se++)fe=$e.outputs[se],z.hasOwnProperty(fe.id)||(z[fe.id]=new $i(fe.id,fe.name,fe.manufacturer,fe.version));R.length||Qe().onChange(rg),R.push(this)}return Qe.requestMIDIAccess=function(u){return new re(function(p,I){Qe.JZZ(u).or(function(){}).and(function(){var U=!!(u&&u.sysex);if(U&&!this.info().sysex)I(new Me("SecurityError","Sysex is not allowed",18));else{var W=new ig(U);p(W)}})})},typeof navigator<"u"&&!navigator.requestMIDIAccess&&(navigator.requestMIDIAccess=Qe.requestMIDIAccess),Qe.close=function(){ce._close&&ce._close()},Qe})}(Hh)),Hh.exports}var cO=aO();const Fd=Ec(cO);var Zh={exports:{}},lO=Zh.exports,OI;function uO(){return OI||(OI=1,function(n,e){(function(t,r){r.Tiny=r,n.exports=r})(lO,function(t){if(!t||(t.synth||(t.synth={}),t.synth.Tiny))return;var r="1.4.3";function i(h){this.__proto__=this.sy={is:"webaudio-tinysynth",properties:{masterVol:{type:Number,value:.5,observer:"setMasterVol"},reverbLev:{type:Number,value:.3,observer:"setReverbLev"},quality:{type:Number,value:1,observer:"setQuality"},debug:{type:Number,value:0},src:{type:String,value:null,observer:"loadMIDIUrl"},loop:{type:Number,value:0},tsmode:{type:Number,value:0},voices:{type:Number,value:64},useReverb:{type:Number,value:1}},program:[],drummap:[],program1:[[{w:"sine",v:.4,d:.7,r:.1},{w:"triangle",v:3,d:.7,s:.1,g:1,a:.01,k:-1.2}],[{w:"triangle",v:.4,d:.7,r:.1},{w:"triangle",v:4,t:3,d:.4,s:.1,g:1,k:-1,a:.01}],[{w:"sine",d:.7,r:.1},{w:"triangle",v:4,f:2,d:.5,s:.5,g:1,k:-1}],[{w:"sine",d:.7,v:.2},{w:"triangle",v:4,t:3,f:2,d:.3,g:1,k:-1,a:.01,s:.5}],[{w:"sine",v:.35,d:.7},{w:"sine",v:3,t:7,f:1,d:1,s:1,g:1,k:-.7}],[{w:"sine",v:.35,d:.7},{w:"sine",v:8,t:7,f:1,d:.5,s:1,g:1,k:-.7}],[{w:"sawtooth",v:.34,d:2},{w:"sine",v:8,f:.1,d:2,s:1,r:2,g:1}],[{w:"triangle",v:.34,d:1.5},{w:"square",v:6,f:.1,d:1.5,s:.5,r:2,g:1}],[{w:"sine",d:.3,r:.3},{w:"sine",v:7,t:11,d:.03,g:1}],[{w:"sine",d:.3,r:.3},{w:"sine",v:11,t:6,d:.2,s:.4,g:1}],[{w:"sine",v:.2,d:.3,r:.3},{w:"sine",v:11,t:5,d:.1,s:.4,g:1}],[{w:"sine",v:.2,d:.6,r:.6},{w:"triangle",v:11,t:5,f:1,s:.5,g:1}],[{w:"sine",v:.3,d:.2,r:.2},{w:"sine",v:6,t:5,d:.02,g:1}],[{w:"sine",v:.3,d:.2,r:.2},{w:"sine",v:7,t:11,d:.03,g:1}],[{w:"sine",v:.2,d:1,r:1},{w:"sine",v:11,t:3.5,d:1,r:1,g:1}],[{w:"triangle",v:.2,d:.5,r:.2},{w:"sine",v:6,t:2.5,d:.2,s:.1,r:.2,g:1}],[{w:"w9999",v:.22,s:.9},{w:"w9999",v:.22,t:2,f:2,s:.9}],[{w:"w9999",v:.2,s:1},{w:"sine",v:11,t:6,f:2,s:.1,g:1,h:.006,r:.002,d:.002},{w:"w9999",v:.2,t:2,f:1,h:0,s:1}],[{w:"w9999",v:.2,d:.1,s:.9},{w:"w9999",v:.25,t:4,f:2,s:.5}],[{w:"w9999",v:.3,a:.04,s:.9},{w:"w9999",v:.2,t:8,f:2,a:.04,s:.9}],[{w:"sine",v:.2,a:.02,d:.05,s:1},{w:"sine",v:6,t:3,f:1,a:.02,d:.05,s:1,g:1}],[{w:"triangle",v:.2,a:.02,d:.05,s:.8},{w:"square",v:7,t:3,f:1,d:.05,s:1.5,g:1}],[{w:"square",v:.2,a:.02,d:.2,s:.5},{w:"square",v:1,d:.03,s:2,g:1}],[{w:"square",v:.2,a:.02,d:.1,s:.8},{w:"square",v:1,a:.3,d:.1,s:2,g:1}],[{w:"sine",v:.3,d:.5,f:1},{w:"triangle",v:5,t:3,f:-1,d:1,s:.1,g:1}],[{w:"sine",v:.4,d:.6,f:1},{w:"triangle",v:12,t:3,d:.6,s:.1,g:1,f:-1}],[{w:"triangle",v:.3,d:1,f:1},{w:"triangle",v:6,f:-1,d:.4,s:.5,g:1,t:3}],[{w:"sine",v:.3,d:1,f:-1},{w:"triangle",v:11,f:1,d:.4,s:.5,g:1,t:3}],[{w:"sine",v:.4,d:.1,r:.01},{w:"sine",v:7,g:1}],[{w:"triangle",v:.4,d:1,f:1},{w:"square",v:4,f:-1,d:1,s:.7,g:1}],[{w:"triangle",v:.35,d:1,f:1},{w:"square",v:7,f:-1,d:.3,s:.5,g:1}],[{w:"sine",v:.2,t:1.5,a:.005,h:.2,d:.6},{w:"sine",v:11,t:5,f:2,d:1,s:.5,g:1}],[{w:"sine",d:.3},{w:"sine",v:4,t:3,d:1,s:1,g:1}],[{w:"sine",d:.3},{w:"sine",v:4,t:3,d:1,s:1,g:1}],[{w:"w9999",d:.3,v:.7,s:.5},{w:"sawtooth",v:1.2,d:.02,s:.5,g:1,h:0,r:.02}],[{w:"sine",d:.3},{w:"sine",v:4,t:3,d:1,s:1,g:1}],[{w:"triangle",v:.3,t:2,d:1},{w:"triangle",v:15,t:2.5,d:.04,s:.1,g:1}],[{w:"triangle",v:.3,t:2,d:1},{w:"triangle",v:15,t:2.5,d:.04,s:.1,g:1}],[{w:"triangle",d:.7},{w:"square",v:.4,t:.5,f:1,d:.2,s:10,g:1}],[{w:"triangle",d:.7},{w:"square",v:.4,t:.5,f:1,d:.2,s:10,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,d:11,s:.2,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,d:11,s:.2,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,t:.5,d:11,s:.2,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,t:.5,d:11,s:.2,g:1}],[{w:"sine",v:.4,a:.1,d:11},{w:"sine",v:6,f:2.5,d:.05,s:1.1,g:1}],[{w:"sine",v:.3,d:.1,r:.1},{w:"square",v:4,t:3,d:1,s:.2,g:1}],[{w:"sine",v:.3,d:.5,r:.5},{w:"sine",v:7,t:2,f:2,d:1,r:1,g:1}],[{w:"triangle",v:.6,h:.03,d:.3,r:.3,t:.5},{w:"n0",v:8,t:1.5,d:.08,r:.08,g:1}],[{w:"sawtooth",v:.3,a:.03,s:.5},{w:"sawtooth",v:.2,t:2,f:2,d:1,s:2}],[{w:"sawtooth",v:.3,f:-2,a:.03,s:.5},{w:"sawtooth",v:.2,t:2,f:2,d:1,s:2}],[{w:"sawtooth",v:.2,a:.02,s:1},{w:"sawtooth",v:.2,t:2,f:2,a:1,d:1,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1},{w:"sawtooth",v:.2,f:2,a:.02,d:1,s:1}],[{w:"triangle",v:.3,a:.03,s:1},{w:"sine",v:3,t:5,f:1,d:1,s:1,g:1}],[{w:"sine",v:.4,a:.03,s:.9},{w:"sine",v:1,t:2,f:3,d:.03,s:.2,g:1}],[{w:"triangle",v:.6,a:.05,s:.5},{w:"sine",v:1,f:.8,d:.2,s:.2,g:1}],[{w:"square",v:.15,a:.01,d:.2,r:.2,t:.5,h:.03},{w:"square",v:4,f:.5,d:.2,r:11,a:.01,g:1,h:.02},{w:"square",v:.15,t:4,f:1,a:.02,d:.15,r:.15,h:.03},{g:3,w:"square",v:4,f:-.5,a:.01,h:.02,d:.15,r:11}],[{w:"square",v:.2,a:.01,d:1,s:.6,r:.04},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.5,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.04,d:1,s:.4,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.15,a:.04,s:1},{w:"sine",v:2,d:.1,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.5,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.6,r:.08},{w:"sine",v:1,f:.2,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:.5,s:.7,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.5,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:2,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"square",v:.2,a:.02,d:2,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"sine",v:.4,a:.02,d:.7,s:.5},{w:"square",v:5,t:2,d:.2,s:.5,g:1}],[{w:"sine",v:.3,a:.05,d:.2,s:.8},{w:"sawtooth",v:6,f:.1,d:.1,s:.3,g:1}],[{w:"sine",v:.3,a:.03,d:.2,s:.4},{w:"square",v:7,f:.2,d:1,s:.1,g:1}],[{w:"square",v:.2,a:.05,d:.1,s:.8},{w:"square",v:4,d:.1,s:1.1,g:1}],[{w:"sine",a:.02,d:2},{w:"sine",v:6,t:2,d:.04,g:1}],[{w:"sine",v:.7,a:.03,d:.4,s:.4},{w:"sine",v:4,t:2,f:.2,d:.4,g:1}],[{w:"sine",v:.7,a:.02,d:.4,s:.6},{w:"sine",v:3,t:2,d:0,s:1,g:1}],[{w:"sine",v:.4,a:.06,d:.3,s:.3},{w:"sine",v:7,t:2,d:.2,s:.2,g:1}],[{w:"sine",a:.02,d:.3,s:.3},{w:"sawtooth",v:3,t:2,d:.3,g:1}],[{w:"sine",v:.4,a:.02,d:2,s:.1},{w:"sawtooth",v:8,t:2,f:1,d:.5,g:1}],[{w:"sine",v:.7,a:.03,d:.5,s:.3},{w:"sine",v:.003,t:0,f:4,d:.1,s:.002,g:1}],[{w:"sine",v:.7,a:.02,d:2},{w:"sine",v:1,t:2,f:1,d:.02,g:1}],[{w:"square",v:.3,d:1,s:.5},{w:"square",v:1,f:.2,d:1,s:.5,g:1}],[{w:"sawtooth",v:.3,d:2,s:.5},{w:"square",v:2,f:.1,s:.5,g:1}],[{w:"triangle",v:.5,a:.05,d:2,s:.6},{w:"sine",v:4,t:2,g:1}],[{w:"triangle",v:.3,a:.01,d:2,s:.3},{w:"sine",v:22,t:2,f:1,d:.03,s:.2,g:1}],[{w:"sawtooth",v:.3,d:1,s:.5},{w:"sine",v:11,t:11,a:.2,d:.05,s:.3,g:1}],[{w:"sine",v:.3,a:.06,d:1,s:.5},{w:"sine",v:7,f:1,d:1,s:.2,g:1}],[{w:"sawtooth",v:.3,a:.03,d:.7,s:.3,r:.2},{w:"sawtooth",v:.3,t:.75,d:.7,a:.1,s:.3,r:.2}],[{w:"triangle",v:.3,a:.01,d:.7,s:.5},{w:"square",v:5,t:.5,d:.7,s:.5,g:1}],[{w:"triangle",v:.3,a:.02,d:.3,s:.3,r:.3},{w:"square",v:3,t:4,f:1,a:.02,d:.1,s:1,g:1},{w:"triangle",v:.08,t:.5,a:.1,h:0,d:.1,s:.5,r:.1,b:0,c:0}],[{w:"sine",v:.3,a:.05,d:1,s:.7,r:.3},{w:"sine",v:2,f:1,d:.3,s:1,g:1}],[{w:"square",v:.3,a:.03,d:.5,s:.3,r:.1},{w:"square",v:4,f:1,a:.03,d:.1,g:1}],[{w:"triangle",v:.3,a:.08,d:1,s:.3,r:.1},{w:"square",v:2,f:1,d:.3,s:.3,g:1,t:4,a:.08}],[{w:"sine",v:.3,a:.05,d:1,s:.3,r:.1},{w:"sine",v:.1,t:2.001,f:1,d:1,s:50,g:1}],[{w:"triangle",v:.3,a:.03,d:.7,s:.3,r:.2},{w:"sine",v:12,t:7,f:1,d:.5,s:1.7,g:1}],[{w:"sine",v:.3,a:.05,d:1,s:.3,r:.1},{w:"sawtooth",v:22,t:6,d:.06,s:.3,g:1}],[{w:"triangle",v:.3,a:.05,d:11,r:.3},{w:"triangle",v:1,d:1,s:8,g:1}],[{w:"sawtooth",v:.3,d:4,s:.8,r:.1},{w:"square",v:1,t:2,f:8,a:1,d:1,s:1,r:.1,g:1}],[{w:"triangle",v:.3,d:1,s:.5,t:.8,a:.2,p:1.25,q:.2},{w:"sawtooth",v:.2,a:.2,d:.3,s:1,t:1.2,p:1.25,q:.2}],[{w:"sine",v:.3,d:1,s:.3},{w:"square",v:22,t:11,d:.5,s:.1,g:1}],[{w:"sawtooth",v:.3,a:.04,d:1,s:.8,r:.1},{w:"square",v:1,t:.5,d:1,s:2,g:1}],[{w:"triangle",v:.3,d:1,s:.3},{w:"sine",v:22,t:6,d:.6,s:.05,g:1}],[{w:"sine",v:.6,a:.1,d:.05,s:.4},{w:"sine",v:5,t:5,f:1,d:.05,s:.3,g:1}],[{w:"sine",a:.1,d:.05,s:.4,v:.8},{w:"sine",v:5,t:5,f:1,d:.05,s:.3,g:1}],[{w:"square",v:.3,a:.1,d:.1,s:.4},{w:"square",v:1,f:1,d:.3,s:.1,g:1}],[{w:"sawtooth",v:.3,d:.5,r:.5},{w:"sawtooth",v:11,t:5,d:.05,g:1}],[{w:"square",v:.3,d:.2,r:.2},{w:"square",v:7,t:3,d:.05,g:1}],[{w:"triangle",d:.2,r:.2},{w:"square",v:9,t:3,d:.1,r:.1,g:1}],[{w:"triangle",d:.3,r:.3},{w:"square",v:6,t:3,d:1,r:1,g:1}],[{w:"triangle",v:.4,d:.2,r:.2},{w:"square",v:22,t:12,d:.1,r:.1,g:1}],[{w:"sine",v:.25,a:.02,d:.05,s:.8},{w:"square",v:1,t:2,d:.03,s:11,g:1}],[{w:"sine",v:.3,a:.05,d:11},{w:"square",v:7,t:3,f:1,s:.7,g:1}],[{w:"square",v:.3,a:.05,d:.1,s:.8},{w:"square",v:4,d:.1,s:1.1,g:1}],[{w:"sine",v:.4,d:.3,r:.3},{w:"sine",v:7,t:9,d:.1,r:.1,g:1}],[{w:"sine",v:.7,d:.1,r:.1},{w:"sine",v:22,t:7,d:.05,g:1}],[{w:"sine",v:.6,d:.15,r:.15},{w:"square",v:11,t:3.2,d:.1,r:.1,g:1}],[{w:"sine",v:.8,d:.07,r:.07},{w:"square",v:11,t:7,r:.01,g:1}],[{w:"triangle",v:.7,t:.5,d:.2,r:.2,p:.95},{w:"n0",v:9,g:1,d:.2,r:.2}],[{w:"sine",v:.7,d:.1,r:.1,p:.9},{w:"square",v:14,t:2,d:.005,r:.005,g:1}],[{w:"square",d:.15,r:.15,p:.5},{w:"square",v:4,t:5,d:.001,r:.001,g:1}],[{w:"n1",v:.3,a:1,s:1,d:.15,r:0,t:.5}],[{w:"sine",t:12.5,d:0,r:0,p:.5,v:.3,h:.2,q:.5},{g:1,w:"sine",v:1,t:2,d:0,r:0,s:1},{g:1,w:"n0",v:.2,t:2,a:.6,h:0,d:.1,r:.1,b:0,c:0}],[{w:"n0",v:.2,a:.05,h:.02,d:.02,r:.02}],[{w:"n0",v:.4,a:1,d:1,t:.25}],[{w:"sine",v:.3,a:.1,d:1,s:.5},{w:"sine",v:4,t:0,f:1.5,d:1,s:1,r:.1,g:1},{g:1,w:"sine",v:4,t:0,f:2,a:.6,h:0,d:.1,s:1,r:.1,b:0,c:0}],[{w:"square",v:.3,t:.25,d:11,s:1},{w:"square",v:12,t:0,f:8,d:1,s:1,r:11,g:1}],[{w:"n0",v:.4,t:.5,a:1,d:11,s:1,r:.5},{w:"square",v:1,t:0,f:14,d:1,s:1,r:11,g:1}],[{w:"sine",t:0,f:1221,a:.2,d:1,r:.25,s:1},{g:1,w:"n0",v:3,t:.5,d:1,s:1,r:1}],[{w:"sine",d:.4,r:.4,p:.1,t:2.5,v:1},{w:"n0",v:12,t:2,d:1,r:1,g:1}]],program0:[[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"sawtooth",v:.3,d:.7}],[{w:"sawtooth",v:.3,d:.7}],[{w:"sine",v:.5,d:.3,r:.3}],[{w:"triangle",v:.5,d:.3,r:.3}],[{w:"square",v:.2,d:.3,r:.3}],[{w:"square",v:.2,d:.3,r:.3}],[{w:"sine",v:.5,d:.1,r:.1}],[{w:"sine",v:.5,d:.1,r:.1}],[{w:"square",v:.2,d:1,r:1}],[{w:"sawtooth",v:.3,d:.7,r:.7}],[{w:"sine",v:.5,a:.01,s:1}],[{w:"sine",v:.7,d:.02,s:.7}],[{w:"square",v:.2,s:1}],[{w:"triangle",v:.5,a:.01,s:1}],[{w:"square",v:.2,a:.02,s:1}],[{w:"square",v:.2,a:.02,s:1}],[{w:"square",v:.2,a:.02,s:1}],[{w:"square",v:.2,a:.05,s:1}],[{w:"triangle",v:.5,d:.5}],[{w:"square",v:.2,d:.6}],[{w:"square",v:.2,d:.6}],[{w:"triangle",v:.8,d:.6}],[{w:"triangle",v:.4,d:.05}],[{w:"square",v:.2,d:1}],[{w:"square",v:.2,d:1}],[{w:"sine",v:.4,d:.6}],[{w:"triangle",v:.7,d:.4}],[{w:"triangle",v:.7,d:.7}],[{w:"triangle",v:.7,d:.7}],[{w:"triangle",v:.7,d:.7}],[{w:"square",v:.3,d:.2}],[{w:"square",v:.3,d:.2}],[{w:"square",v:.3,d:.1,s:.2}],[{w:"sawtooth",v:.4,d:.1,s:.2}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.3,d:.1}],[{w:"sawtooth",v:.3,d:.5,r:.5}],[{w:"triangle",v:.6,d:.1,r:.1,h:.03,p:.8}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"triangle",v:.3,a:.03,s:1}],[{w:"sine",v:.3,a:.03,s:1}],[{w:"triangle",v:.3,a:.05,s:1}],[{w:"sawtooth",v:.5,a:.01,d:.1}],[{w:"square",v:.3,a:.05,d:.2,s:.6}],[{w:"square",v:.3,a:.05,d:.2,s:.6}],[{w:"square",v:.3,a:.05,d:.2,s:.6}],[{w:"square",v:.2,a:.05,d:.01,s:1}],[{w:"square",v:.3,a:.05,s:1}],[{w:"square",v:.3,s:.7}],[{w:"square",v:.3,s:.7}],[{w:"square",v:.3,s:.7}],[{w:"square",v:.3,a:.02,d:2}],[{w:"square",v:.3,a:.02,d:2}],[{w:"square",v:.3,a:.03,d:2}],[{w:"square",v:.3,a:.04,d:2}],[{w:"square",v:.3,a:.02,d:2}],[{w:"square",v:.3,a:.05,d:2}],[{w:"square",v:.3,a:.03,d:2}],[{w:"square",v:.3,a:.03,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"square",v:.3,s:.7}],[{w:"sawtooth",v:.4,s:.7}],[{w:"triangle",v:.5,s:.7}],[{w:"sawtooth",v:.4,s:.7}],[{w:"sawtooth",v:.4,d:12}],[{w:"sine",v:.4,a:.06,d:12}],[{w:"sawtooth",v:.4,d:12}],[{w:"sawtooth",v:.4,d:12}],[{w:"sawtooth",v:.3,d:12}],[{w:"triangle",v:.5,d:12}],[{w:"square",v:.3,d:12}],[{w:"triangle",v:.5,a:.08,d:11}],[{w:"sawtooth",v:.5,a:.05,d:11}],[{w:"sawtooth",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"square",v:.3,d:11}],[{w:"sawtooth",v:.5,a:.04,d:11}],[{w:"sawtooth",v:.5,d:11}],[{w:"triangle",v:.5,a:.8,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"square",v:.3,d:11}],[{w:"sawtooth",v:.3,d:1,r:1}],[{w:"sawtooth",v:.5,d:.3}],[{w:"sawtooth",v:.5,d:.3,r:.3}],[{w:"sawtooth",v:.5,d:.3,r:.3}],[{w:"square",v:.3,d:.2,r:.2}],[{w:"square",v:.3,a:.02,d:2}],[{w:"sawtooth",v:.2,a:.02,d:.7}],[{w:"triangle",v:.5,d:1}],[{w:"sawtooth",v:.3,d:.3,r:.3}],[{w:"sine",v:.8,d:.1,r:.1}],[{w:"square",v:.2,d:.1,r:.1,p:1.05}],[{w:"sine",v:.8,d:.05,r:.05}],[{w:"triangle",v:.5,d:.1,r:.1,p:.96}],[{w:"triangle",v:.5,d:.1,r:.1,p:.97}],[{w:"square",v:.3,d:.1,r:.1}],[{w:"n1",v:.3,a:1,s:1,d:.15,r:0,t:.5}],[{w:"triangle",v:.5,d:.03,t:0,f:1332,r:.001,p:1.1}],[{w:"n0",v:.2,t:.1,d:.02,a:.05,h:.02,r:.02}],[{w:"n0",v:.4,a:1,d:1,t:.25}],[{w:"sine",v:.3,a:.8,d:1,t:0,f:1832}],[{w:"triangle",d:.5,t:0,f:444,s:1}],[{w:"n0",v:.4,d:1,t:0,f:22,s:1}],[{w:"n0",v:.5,a:.2,d:11,t:0,f:44}],[{w:"n0",v:.5,t:.25,d:.4,r:.4}]],drummap1:[[{w:"triangle",t:0,f:70,v:1,d:.05,h:.03,p:.9,q:.1},{w:"n0",g:1,t:6,v:17,r:.01,h:0,p:0}],[{w:"triangle",t:0,f:88,v:1,d:.05,h:.03,p:.5,q:.1},{w:"n0",g:1,t:5,v:42,r:.01,h:0,p:0}],[{w:"n0",f:222,p:0,t:0,r:.01,h:0}],[{w:"triangle",v:.3,f:180,d:.05,t:0,h:.03,p:.9,q:.1},{w:"n0",v:.6,t:0,f:70,h:.02,r:.01,p:0},{g:1,w:"square",v:2,t:0,f:360,r:.01,b:0,c:0}],[{w:"square",f:1150,v:.34,t:0,r:.03,h:.025,d:.03},{g:1,w:"n0",t:0,f:13,h:.025,d:.1,s:1,r:.1,v:1}],[{w:"triangle",f:200,v:1,d:.06,t:0,r:.06},{w:"n0",g:1,t:0,f:400,v:12,r:.02,d:.02}],[{w:"triangle",f:100,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.4,h:.015,d:.005,r:.005}],[{w:"n1",f:390,v:.25,r:.01,t:0}],[{w:"triangle",f:120,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.5,h:.015,d:.005,r:.005}],[{w:"n1",v:.25,f:390,r:.03,t:0,h:.005,d:.03}],[{w:"triangle",f:140,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"n1",v:.25,f:390,t:0,d:.2,r:.2},{w:"n0",v:.3,t:0,c:0,f:440,h:.005,d:.05}],[{w:"triangle",f:155,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"triangle",f:180,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"n1",v:.3,f:1200,d:.2,r:.2,h:.05,t:0},{w:"n1",t:0,v:1,d:.1,r:.1,p:1.2,f:440}],[{w:"triangle",f:220,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"n1",f:500,v:.15,d:.4,r:.4,h:0,t:0},{w:"n0",v:.1,t:0,r:.01,f:440}],[{w:"n1",v:.3,f:800,d:.2,r:.2,h:.05,t:0},{w:"square",t:0,v:1,d:.1,r:.1,p:.1,f:220,g:1}],[{w:"sine",f:1651,v:.15,d:.2,r:.2,h:0,t:0},{w:"sawtooth",g:1,t:1.21,v:7.2,d:.1,r:11,h:1},{g:1,w:"n0",v:3.1,t:.152,d:.002,r:.002}],null,[{w:"n1",v:.3,f:1200,d:.2,r:.2,h:.05,t:0},{w:"n1",t:0,v:1,d:.1,r:.1,p:1.2,f:440}],null,[{w:"n1",v:.3,f:555,d:.25,r:.25,h:.05,t:0},{w:"n1",t:0,v:1,d:.1,r:.1,f:440,a:.005,h:.02}],[{w:"sawtooth",f:776,v:.2,d:.3,t:0,r:.3},{g:1,w:"n0",v:2,t:0,f:776,a:.005,h:.02,d:.1,s:1,r:.1,c:0},{g:11,w:"sine",v:.1,t:0,f:22,d:.3,r:.3,b:0,c:0}],[{w:"n1",f:440,v:.15,d:.4,r:.4,h:0,t:0},{w:"n0",v:.4,t:0,r:.01,f:440}],null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,[{w:"sine",f:1720,v:.3,d:.02,t:0,r:.02},{w:"square",g:1,t:0,f:2876,v:6,d:.2,s:1,r:.2}],[{w:"sine",f:1720,v:.3,d:.25,t:0,r:.25},{w:"square",g:1,t:0,f:2876,v:6,d:.2,s:1,r:.2}]],drummap0:[[{w:"triangle",t:0,f:110,v:1,d:.05,h:.02,p:.1}],[{w:"triangle",t:0,f:150,v:.8,d:.1,p:.1,h:.02,r:.01}],[{w:"n0",f:392,v:.5,d:.01,p:0,t:0,r:.05}],[{w:"n0",f:33,d:.05,t:0}],[{w:"n0",f:100,v:.7,d:.03,t:0,r:.03,h:.02}],[{w:"n0",f:44,v:.7,d:.02,p:.1,t:0,h:.02}],[{w:"triangle",f:240,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:440,v:.2,r:.01,t:0}],[{w:"triangle",f:270,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:440,v:.2,d:.04,r:.04,t:0}],[{w:"triangle",f:300,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:440,v:.2,d:.1,r:.1,h:.02,t:0}],[{w:"triangle",f:320,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"triangle",f:360,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:150,v:.2,d:.1,r:.1,h:.05,t:0,p:.1}],[{w:"triangle",f:400,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:150,v:.2,d:.1,r:.01,h:.05,t:0,p:.1}],[{w:"n0",f:150,v:.2,d:.1,r:.01,h:.05,t:0,p:.1}],[{w:"n0",f:440,v:.3,d:.1,p:.9,t:0,r:.1}],[{w:"n0",f:200,v:.2,d:.05,p:.9,t:0}],[{w:"n0",f:440,v:.3,d:.12,p:.9,t:0}],[{w:"sine",f:800,v:.4,d:.06,t:0}],[{w:"n0",f:150,v:.2,d:.1,r:.01,h:.05,t:0,p:.1}],[{w:"n0",f:33,v:.3,d:.2,p:.9,t:0}],[{w:"n0",f:300,v:.3,d:.14,p:.9,t:0}],[{w:"sine",f:200,d:.06,t:0}],[{w:"sine",f:150,d:.06,t:0}],[{w:"sine",f:300,t:0}],[{w:"sine",f:300,d:.06,t:0}],[{w:"sine",f:250,d:.06,t:0}],[{w:"square",f:300,v:.3,d:.06,p:.8,t:0}],[{w:"square",f:260,v:.3,d:.06,p:.8,t:0}],[{w:"sine",f:850,v:.5,d:.07,t:0}],[{w:"sine",f:790,v:.5,d:.07,t:0}],[{w:"n0",f:440,v:.3,a:.05,t:0}],[{w:"n0",f:440,v:.3,a:.05,t:0}],[{w:"triangle",f:1800,v:.4,p:.9,t:0,h:.03}],[{w:"triangle",f:1800,v:.3,p:.9,t:0,h:.13}],[{w:"n0",f:330,v:.3,a:.02,t:0,r:.01}],[{w:"n0",f:330,v:.3,a:.02,t:0,h:.04,r:.01}],[{w:"n0",f:440,v:.3,t:0}],[{w:"sine",f:800,t:0}],[{w:"sine",f:700,t:0}],[{w:"n0",f:330,v:.3,t:0}],[{w:"n0",f:330,v:.3,t:0,h:.1,r:.01,p:.7}],[{w:"sine",t:0,f:1200,v:.3,r:.01}],[{w:"sine",t:0,f:1200,v:.3,d:.2,r:.2}]],ready:function(){var g;this.pg=[],this.vol=[],this.ex=[],this.bend=[],this.rpnidx=[],this.brange=[],this.sustain=[],this.notetab=[],this.rhythm=[],this.masterTuningC=0,this.masterTuningF=0,this.tuningC=[],this.tuningF=[],this.scaleTuning=[],this.maxTick=0,this.playTick=0,this.playing=0,this.releaseRatio=3.5;for(var g=0;g<16;++g)this.pg[g]=0,this.vol[g]=3*100*100/(127*127),this.bend[g]=0,this.brange[g]=256,this.tuningC[g]=0,this.tuningF[g]=0,this.scaleTuning[g]=[0,0,0,0,0,0,0,0,0,0,0,0],this.rhythm[g]=0;this.rhythm[9]=1,this.preroll=.2,this.relcnt=0,setInterval((function(){if(++this.relcnt>=3){this.relcnt=0;for(var y=this.notetab.length-1;y>=0;--y){var C=this.notetab[y];this.actx.currentTime>C.e&&(this._pruneNote(C),this.notetab.splice(y,1))}}if(this.playing&&this.song.ev.length>0)for(var x=this.song.ev[this.playIndex];this.actx.currentTime+this.preroll>this.playTime;)if(x.m[0]==65361?(this.song.tempo=x.m[1],this.tick2Time=4*60/this.song.tempo/this.song.timebase):this.send(x.m,this.playTime),++this.playIndex,this.playIndex>=this.song.ev.length)if(this.loop)x=this.song.ev[this.playIndex=0],this.playTick=x.t;else{this.playTick=this.maxTick,this.playing=0;break}else x=this.song.ev[this.playIndex],this.playTime+=(x.t-this.playTick)*this.tick2Time,this.playTick=x.t}).bind(this),60),this.isReady=1},setMasterVol:function(g){g!=null&&(this.masterVol=g),this.out&&(this.out.gain.value=this.masterVol)},setReverbLev:function(g){g!=null&&(this.reverbLev=g);var y=parseFloat(this.reverbLev);this.rev&&!isNaN(y)&&(this.rev.gain.value=y*8)},setLoop:function(g){this.loop=g},setVoices:function(g){this.voices=g},reset:function(){for(var g=0;g<16;++g)this.setProgram(g,0),this.setBendRange(g,256),this.setModulation(g,0),this.setChVol(g,100),this.setPan(g,64),this.resetAllControllers(g),this.allSoundOff(g),this.rhythm[g]=0,this.tuningC[g]=0,this.tuningF[g]=0,this.scaleTuning[g]=[0,0,0,0,0,0,0,0,0,0,0,0];this.masterTuningC=0,this.masterTuningF=0,this.rhythm[9]=1},setQuality:function(g){var y;for(g!=null&&(this.quality=g),y=0;y<128;++y)this.setTimbre(0,y,this.program0[y]);for(y=0;y<this.drummap0.length;++y)this.setTimbre(1,y+35,this.drummap0[y]);if(this.quality){for(y=0;y<this.program1.length;++y)this.setTimbre(0,y,this.program1[y]);for(y=0;y<this.drummap.length;++y)this.drummap1[y]&&this.setTimbre(1,y+35,this.drummap1[y])}},setTimbre:function(g,y,C){var x={g:0,w:"sine",t:1,f:0,v:.5,a:0,h:.01,d:.01,s:0,r:.05,p:1,q:1,k:0};function w(S){for(y=0;y<S.length;++y)for(m in x)(!S[y].hasOwnProperty(m)||typeof S[y][m]>"u")&&(S[y][m]=x[m]);return S}g&&y>=35&&y<=81&&(this.drummap[y-35]=w(C)),g==0&&y>=0&&y<=127&&(this.program[y]=w(C))},_pruneNote:function(g){for(var y=g.o.length-1;y>=0;--y){if(g.o[y].frequency?g.o[y].frequency.cancelScheduledValues(0):g.o[y].playbackRate.cancelScheduledValues(0),g.g[y].gain.cancelScheduledValues(0),g.o[y].stop(),g.o[y].detune)try{this.chmod[g.ch].disconnect(g.o[y].detune)}catch{}g.g[y].gain.value=0}},_limitVoices:function(g,y){this.notetab.sort(function(w,S){return w.f!=S.f?w.f-S.f:w.e!=S.e?S.e-w.e:S.t-w.t});for(var C=this.notetab.length-1;C>=0;--C){var x=this.notetab[C];(this.actx.currentTime>x.e||C>=this.voices-1)&&(this._pruneNote(x),this.notetab.splice(C,1))}},_note:function(g,y,C,x,w){var S,A,E,_=[],T=[],M=[],P=[],j=[],X=440*Math.pow(2,(C-69+this.masterTuningC+this.tuningC[y]+(this.masterTuningF+this.tuningF[y]/8192+this.scaleTuning[y][C%12]))/12);this._limitVoices(y,C);for(var L=0;L<w.length;++L){E=w[L];var G=g+E.a+E.h;switch(E.g==0?(S=this.chvol[y],A=x*x/16384,P[L]=X*E.t+E.f):E.g>10?(S=T[E.g-11].gain,A=1,P[L]=P[E.g-11]*E.t+E.f):_[E.g-1].frequency?(S=_[E.g-1].frequency,A=P[E.g-1],P[L]=P[E.g-1]*E.t+E.f):(S=_[E.g-1].playbackRate,A=P[E.g-1]/440,P[L]=P[E.g-1]*E.t+E.f),E.w[0]){case"n":_[L]=this.actx.createBufferSource(),_[L].buffer=this.noiseBuf[E.w],_[L].loop=!0,_[L].playbackRate.value=P[L]/440,E.p!=1&&this._setParamTarget(_[L].playbackRate,P[L]/440*E.p,g,E.q),_[L].detune&&(this.chmod[y].connect(_[L].detune),_[L].detune.value=this.bend[y]);break;default:_[L]=this.actx.createOscillator(),_[L].frequency.value=P[L],E.p!=1&&this._setParamTarget(_[L].frequency,P[L]*E.p,g,E.q),E.w[0]=="w"?_[L].setPeriodicWave(this.wave[E.w]):_[L].type=E.w,_[L].detune&&(this.chmod[y].connect(_[L].detune),_[L].detune.value=this.bend[y]);break}T[L]=this.actx.createGain(),j[L]=E.r,_[L].connect(T[L]),T[L].connect(S),M[L]=A*E.v,E.k&&(M[L]*=Math.pow(2,(C-60)/12*E.k)),E.a?(T[L].gain.value=0,T[L].gain.setValueAtTime(0,g),T[L].gain.linearRampToValueAtTime(M[L],g+E.a)):T[L].gain.setValueAtTime(M[L],g),this._setParamTarget(T[L].gain,E.s*M[L],G,E.d),_[L].start(g),this.rhythm[y]&&(_[L].onended=function(Z,ne){return function(){ne&&Z.disconnect(ne)}}(this.chmod[y],_[L].detune),_[L].stop(g+w[0].d*this.releaseRatio))}this.rhythm[y]||this.notetab.push({t:g,e:99999,ch:y,n:C,o:_,g:T,t2:g+E.a,v:M,r:j,f:0})},_setParamTarget:function(g,y,C,x){x!=0?g.setTargetAtTime(y,C,x):g.setValueAtTime(y,C)},_releaseNote:function(g,y){if(g.ch!=9)for(var C=g.g.length-1;C>=0;--C)g.g[C].gain.cancelScheduledValues(y),y==g.t2?g.g[C].gain.setValueAtTime(g.v[C],y):y<g.t2&&g.g[C].gain.setValueAtTime(g.v[C]*(y-g.t)/(g.t2-g.t),y),this._setParamTarget(g.g[C].gain,0,y,g.r[C]);g.e=y+g.r[0]*this.releaseRatio,g.f=1},setModulation:function(g,y,C){this.chmod[g].gain.setValueAtTime(y*100/127,this._tsConv(C))},setChVol:function(g,y,C){this.vol[g]=3*y*y/(127*127),this.chvol[g].gain.setValueAtTime(this.vol[g]*this.ex[g],this._tsConv(C))},setPan:function(g,y,C){this.chpan[g]&&this.chpan[g].pan.setValueAtTime((y-64)/64,this._tsConv(C))},setExpression:function(g,y,C){this.ex[g]=y*y/(127*127),this.chvol[g].gain.setValueAtTime(this.vol[g]*this.ex[g],this._tsConv(C))},setSustain:function(g,y,C){if(this.sustain[g]=y,C=this._tsConv(C),y<64)for(var x=this.notetab.length-1;x>=0;--x){var w=this.notetab[x];C>=w.t&&w.ch==g&&w.f==1&&this._releaseNote(w,C)}},allSoundOff:function(g){for(var y=this.notetab.length-1;y>=0;--y){var C=this.notetab[y];C.ch==g&&(this._pruneNote(C),this.notetab.splice(y,1))}},resetAllControllers:function(g){this.bend[g]=0,this.ex[g]=1,this.rpnidx[g]=16383,this.sustain[g]=0,this.chvol[g]&&(this.chvol[g].gain.value=this.vol[g]*this.ex[g],this.chmod[g].gain.value=0)},setBendRange:function(g,y){this.brange[g]=y},setProgram:function(g,y){this.debug&&console.log("Pg("+g+")="+y),this.pg[g]=y},setBend:function(g,y,C){C=this._tsConv(C);var x=this.brange[g]*100/127;this.bend[g]=(y-8192)*x/8192;for(var w=this.notetab.length-1;w>=0;--w){var S=this.notetab[w];if(S.ch==g)for(var A=S.o.length-1;A>=0;--A)S.o[A].frequency&&S.o[A].detune&&S.o[A].detune.setValueAtTime(this.bend[g],C)}},noteOn:function(g,y,C,x){if(C==0){this.noteOff(g,y,x);return}if(x=this._tsConv(x),this.rhythm[g]){y>=35&&y<=81&&this._note(x,g,y,C,this.drummap[y-35]);return}this._note(x,g,y,C,this.program[this.pg[g]])},noteOff:function(g,y,C){if(!this.rhythm[g]){C=this._tsConv(C);for(var x=this.notetab.length-1;x>=0;--x){var w=this.notetab[x];C>=w.t&&w.ch==g&&w.n==y&&w.f==0&&(w.f=1,this.sustain[g]<64&&this._releaseNote(w,C))}}},_tsConv:function(g){return g==null||g<=0?(g=0,this.actx&&(g=this.actx.currentTime)):this.tsmode&&(g=g*.001-this.tsdiff),g},setTsMode:function(g){this.tsmode=g},send:function(g,y){var C=g[0]&15,x=g[0]&-16;if(!(x<128||x>=256))switch(this.audioContext.state=="suspended"&&this.audioContext.resume(),x){case 176:switch(g[1]){case 1:this.setModulation(C,g[2],y);break;case 7:this.setChVol(C,g[2],y);break;case 10:this.setPan(C,g[2],y);break;case 11:this.setExpression(C,g[2],y);break;case 64:this.setSustain(C,g[2],y);break;case 98:case 99:this.rpnidx[C]=16383;break;case 100:this.rpnidx[C]=this.rpnidx[C]&16256|g[2];break;case 101:this.rpnidx[C]=this.rpnidx[C]&127|g[2]<<7;break;case 6:switch(this.rpnidx[C]){case 0:this.brange[C]=(g[2]<<7)+(this.brange[C]&127);break;case 1:this.tuningF[C]=(g[2]<<7)+(this.tuningF[C]+8192&127)-8192;break;case 2:this.tuningC[C]=g[2]-64;break}break;case 38:switch(this.rpnidx[C]){case 0:this.brange[C]=this.brange[C]&16256|g[2];break;case 1:this.tuningF[C]=(this.tuningF[C]+8192&16256|g[2])-8192;break}break;case 120:case 123:case 124:case 125:case 126:case 127:this.allSoundOff(C);break;case 121:this.resetAllControllers(C);break}break;case 192:this.setProgram(C,g[1]);break;case 224:this.setBend(C,g[1]+(g[2]<<7),y);break;case 144:this.noteOn(C,g[1],g[2],y);break;case 128:this.noteOff(C,g[1],y);break;case 240:if(g[0]==255){this.reset();break}if(g[0]!=254&&this.debug)for(var w=[],S=0;S<g.length;++S)w.push(g[S].toString(16));if(g[0]==240&&(g[1]==127&&g[3]==4&&(g[4]==3&&g.length>=8&&(this.masterTuningF=(g[6]*128+g[5]-8192)/8192),g[4]==4&&g.length>=8&&(this.masterTuningC=g[6]-64)),g[1]==65&&g[3]==66&&g[4]==18&&g[5]==64))if((g[6]&240)==16&&g.length==11){var A=[9,0,1,2,3,4,5,6,7,8,10,11,12,13,14,15][g[6]&15];g[7]==21?this.rhythm[A]=g[8]:g[7]>=64&&g[7]<=75&&(this.scaleTuning[A][g[7]-64]=(g[8]-64)/100)}else g[6]==0&&(g[7]==0&&g.length==14?this.masterTuningF=(g[8]*4096+g[9]*256+g[10]*16+g[11]-1024)/1e3:g[7]==5&&g.length==11&&(this.masterTuningC=g[8]-64));break}},_createWave:function(g){for(var y=new Float32Array(g.length),C=new Float32Array(g.length),x=1;x<g.length;++x)y[x]=g[x];return this.actx.createPeriodicWave(C,y)},getAudioContext:function(){return this.actx},setAudioContext:function(g,y){this.audioContext=this.actx=g,this.dest=y,y||(this.dest=g.destination),this.tsdiff=performance.now()*.001-this.actx.currentTime,this.out=this.actx.createGain(),this.comp=this.actx.createDynamicsCompressor();var C=this.actx.sampleRate*.5|0;this.convBuf=this.actx.createBuffer(2,C,this.actx.sampleRate),this.noiseBuf={},this.noiseBuf.n0=this.actx.createBuffer(1,C,this.actx.sampleRate),this.noiseBuf.n1=this.actx.createBuffer(1,C,this.actx.sampleRate);for(var x=this.convBuf.getChannelData(0),w=this.convBuf.getChannelData(1),S=this.noiseBuf.n0.getChannelData(0),A=this.noiseBuf.n1.getChannelData(0),E=0;E<C;++E)E/C<Math.random()&&(x[E]=Math.exp(-3*E/C)*(Math.random()-.5)*.5,w[E]=Math.exp(-3*E/C)*(Math.random()-.5)*.5),S[E]=Math.random()*2-1;for(var _=0;_<64;++_){var T=Math.random()*10+1,M=Math.random()*10+1;for(E=0;E<C;++E){var P=Math.sin(E/C*2*Math.PI*440*T)*Math.sin(E/C*2*Math.PI*440*M);A[E]+=P/8}}for(this.useReverb&&(this.conv=this.actx.createConvolver(),this.conv.buffer=this.convBuf,this.rev=this.actx.createGain(),this.rev.gain.value=this.reverbLev,this.out.connect(this.conv),this.conv.connect(this.rev),this.rev.connect(this.comp)),this.setMasterVol(),this.out.connect(this.comp),this.comp.connect(this.dest),this.chvol=[],this.chmod=[],this.chpan=[],this.wave={w9999:this._createWave("w9999")},this.lfo=this.actx.createOscillator(),this.lfo.frequency.value=5,this.lfo.start(0),E=0;E<16;++E)this.chvol[E]=this.actx.createGain(),this.actx.createStereoPanner?(this.chpan[E]=this.actx.createStereoPanner(),this.chvol[E].connect(this.chpan[E]),this.chpan[E].connect(this.out)):(this.chpan[E]=null,this.chvol[E].connect(this.out)),this.chmod[E]=this.actx.createGain(),this.lfo.connect(this.chmod[E]),this.pg[E]=0,this.resetAllControllers(E);this.setReverbLev(),this.reset()}};for(var m in this.sy.properties)this[m]=this.sy.properties[m].value;this.setQuality(1),h&&(h.useReverb!=null&&(this.useReverb=h.useReverb),h.quality!=null&&this.setQuality(h.quality),h.voices!=null&&this.setVoices(h.voices)),this.ready()}function o(h,m,g){if(typeof m>"u")return o(h,[],[]);if(h instanceof Object){for(var y=0;y<m.length;y++)if(m[y]===h)return g[y];var C;h instanceof Array?C=[]:C={},m.push(h),g.push(C);for(var x in h)h.hasOwnProperty(x)&&(C[x]=o(h[x],m,g));return C}return h}var a;function s(){return a||(a=t.lib.getAudioContext()),!!a}var l={},f={};f._info=function(h){return h||(h="JZZ.synth.Tiny"),{type:"Web Audio",name:h,manufacturer:"virtual",version:r}},f._openOut=function(h,m){if(s(),!a){h._crash("AudioContext not supported");return}var g;typeof m<"u"?(m=""+m,l[m]||(l[m]=new i),g=l[m]):g=new i,g.setAudioContext(a),h.plug=function(y){y&&(y.context instanceof AudioContext||y.context instanceof webkitAudioContext)&&g.setAudioContext(y.context,y)},h.setSynth=function(y,C,x){g.setTimbre(!!x,y,o(C))},h.getSynth=function(y,C){return o(C?g.drummap[y-35]:g.program[y])},h._info=f._info(m),h._receive=function(y){g.send(y)},h._resume()},t.synth.Tiny=function(h){return t.lib.openMidiOut(h,f)},t.synth.Tiny.register=function(h){return s()?t.lib.registerMidiOut(h,f):!1},t.synth.Tiny.version=function(){return r}})}(Zh)),Zh.exports}var dO=uO();const ol=class ol{constructor(){oe(this,"isInitialized",!1);oe(this,"virtualPort",null);oe(this,"portName","Virtual Synthesizer")}static getInstance(){return ol.instance||(ol.instance=new ol),ol.instance}async initialize(){if(this.isInitialized)return!0;try{const e=await Fd();return dO.Tiny(Fd),Fd.synth.Tiny.register(this.portName),e.refresh(),console.log(`Virtual MIDI synthesizer registered as: ${this.portName}`),this.isInitialized=!0,!0}catch(e){return console.error("Failed to initialize virtual MIDI synthesizer:",e),!1}}async getVirtualPort(){if(!this.isInitialized&&!await this.initialize())return null;try{return this.virtualPort=await Fd().openMidiOut(this.portName),this.virtualPort}catch(e){return console.error("Failed to open virtual MIDI port:",e),null}}getPortName(){return this.portName}get initialized(){return this.isInitialized}close(){this.virtualPort&&(this.virtualPort.close(),this.virtualPort=null)}};oe(ol,"instance");let Hv=ol;const Hs=Hv.getInstance();var Zv=(n=>(n.Off="off",n.Unfocused="unfocused",n.All="all",n))(Zv||{}),Zo=(n=>(n.SetGeneral="SET_GENERAL",n.SetSpeech="SET_SPEECH",n.SetSound="SET_SOUND",n.SetChannels="SET_CHANNELS",n.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",n.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",n.SetMidi="SET_MIDI",n))(Zo||{});class fO{constructor(){oe(this,"state");oe(this,"listeners",new Set);oe(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(t=>t())});var i;const e=localStorage.getItem("preferences"),t=this.getInitialPreferences();let r=e?JSON.parse(e):null;((i=r==null?void 0:r.general)==null?void 0:i.volume)!==void 0&&(r!=null&&r.sound)&&(r.sound.volume||(r.sound.volume=r.general.volume),delete r.general.volume),this.state=r?this.mergePreferences(t,r):t}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},sound:{muteInBackground:!1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0},midi:{enabled:!1}}}mergePreferences(e,t){return{...e,general:{...e.general,...t.general},speech:{...e.speech,...t.speech},sound:{...e.sound,...t.sound},channels:t.channels?{...e.channels,...t.channels}:e.channels,editor:{...e.editor,...t.editor},midi:{...e.midi,...t.midi}}}reducer(e,t){switch(t.type){case"SET_GENERAL":return{...e,general:t.data};case"SET_SPEECH":return{...e,speech:t.data};case"SET_SOUND":return{...e,sound:t.data};case"SET_CHANNELS":return{...e,channels:t.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:t.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:t.data}};case"SET_MIDI":return{...e,midi:t.data};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const lr=new fO;class hO{constructor(){oe(this,"jzz",null);oe(this,"inputDevice",null);oe(this,"outputDevice",null);oe(this,"inputCallback",null);oe(this,"deviceChangeCallbacks",new Set);oe(this,"deviceWatcher",null);oe(this,"connectionState",{inputConnected:!1,outputConnected:!1});oe(this,"intentionalDisconnectFlags",{input:!1,output:!1})}async initialize(){try{return this.jzz=await Fd(),console.log("JZZ MIDI engine initialized"),this.deviceWatcher=this.jzz.onChange(e=>{const t=this.processDeviceChanges(e);this.deviceChangeCallbacks.forEach(r=>r(t)),this.handleDeviceDisconnections(t)}),await this.attemptAutoReconnect(),!0}catch(e){return console.error("Failed to initialize JZZ MIDI engine:",e),!1}}getInputDevices(){if(!this.jzz)return[];const e=[],t=this.jzz.info();return t&&t.inputs&&t.inputs.forEach(r=>{e.push({id:r.id||r.name,name:r.name||"Unknown Input Device"})}),e}getOutputDevices(){const e=[];if(Hs.initialized&&e.push({id:"virtual-synth",name:Hs.getPortName()}),this.jzz){const t=this.jzz.info();t&&t.outputs&&t.outputs.forEach(r=>{e.push({id:r.id||r.name,name:r.name||"Unknown Output Device"})})}return e}async connectInputDevice(e,t){if(!this.jzz)return!1;try{this.inputDevice&&this.inputDevice.close(),this.inputDevice=await this.jzz.openMidiIn(e),this.inputCallback=t,this.inputDevice.connect(o=>{var g;const a=o.data||o,s=a[0];if(s===254)return;const l=s&240,f=s&15,h={hex:Array.from(a).map(y=>y.toString(16).padStart(2,"0").toUpperCase()).join(" "),data:new Uint8Array(a),type:this.getMidiMessageType(s)},m={rawData:h};if(l===144||l===128){const y=a[1],C=a[2],x=l===144&&C>0;m.note={note:y,velocity:C,on:x,channel:f}}else if(l===176){const y=a[1],C=a[2];m.controlChange={controller:y,value:C,channel:f}}else if(l===192){const y=a[1];m.programChange={program:y,channel:f}}else(s&240)===240?m.systemMessage={type:this.getSystemMessageType(s),data:Array.from(a)}:m.raw=h;(g=this.inputCallback)==null||g.call(this,m)}),this.connectionState.inputConnected=!0,this.connectionState.inputDeviceId=e;const i=this.getInputDevices().find(o=>o.id===e);return this.connectionState.inputDeviceName=(i==null?void 0:i.name)||"Unknown Device",lr.dispatch({type:"SET_MIDI",data:{...lr.getState().midi,lastInputDeviceId:e}}),this.intentionalDisconnectFlags.input=!1,console.log(`Connected to MIDI input: ${this.connectionState.inputDeviceName}`),!0}catch(r){return console.error("Failed to connect to MIDI input:",r),!1}}async connectOutputDevice(e){var t,r;try{if(this.outputDevice&&((r=(t=this.outputDevice).close)==null||r.call(t)),e==="virtual-synth"){const a=await Hs.getVirtualPort();return a?(this.outputDevice=a,this.connectionState.outputConnected=!0,this.connectionState.outputDeviceId=e,this.connectionState.outputDeviceName=Hs.getPortName(),lr.dispatch({type:"SET_MIDI",data:{...lr.getState().midi,lastOutputDeviceId:e}}),this.intentionalDisconnectFlags.output=!1,console.log(`Connected to virtual MIDI synthesizer: ${Hs.getPortName()}`),!0):!1}if(!this.jzz)return!1;this.outputDevice=await this.jzz.openMidiOut(e),this.connectionState.outputConnected=!0,this.connectionState.outputDeviceId=e;const o=this.getOutputDevices().find(a=>a.id===e);return this.connectionState.outputDeviceName=(o==null?void 0:o.name)||"Unknown Device",lr.dispatch({type:"SET_MIDI",data:{...lr.getState().midi,lastOutputDeviceId:e}}),this.intentionalDisconnectFlags.output=!1,console.log(`Connected to MIDI output: ${this.connectionState.outputDeviceName}`),!0}catch(i){return console.error("Failed to connect to MIDI output:",i),!1}}sendNote(e){if(!this.outputDevice)return;const t=e.channel||0,r=e.on?144|t:128|t,i=e.on?Math.max(1,Math.min(127,e.velocity)):0;this.outputDevice.send([r,e.note,i])}sendRawMessage(e){this.outputDevice&&this.outputDevice.send(e)}sendAllNotesOff(){if(this.outputDevice)for(let e=0;e<16;e++)this.outputDevice.send([176|e,123,0]),this.outputDevice.send([176|e,120,0])}disconnectDevice(e){var t,r,i,o;e==="input"?(this.inputDevice&&((r=(t=this.inputDevice).close)==null||r.call(t),this.inputDevice=null),this.inputCallback=null,this.connectionState.inputConnected=!1,this.connectionState.inputDeviceId=void 0,this.connectionState.inputDeviceName=void 0,console.log("Disconnected input device")):e==="output"&&(this.outputDevice&&((o=(i=this.outputDevice).close)==null||o.call(i),this.outputDevice=null),this.connectionState.outputConnected=!1,this.connectionState.outputDeviceId=void 0,this.connectionState.outputDeviceName=void 0,console.log("Disconnected output device"))}disconnectWithIntent(e){this.setIntentionalDisconnect(e),e==="input"?this.disconnectDevice("input"):e==="output"?this.disconnectDevice("output"):this.disconnect()}disconnect(){var e,t,r,i;this.inputDevice&&((t=(e=this.inputDevice).close)==null||t.call(e),this.inputDevice=null),this.outputDevice&&((i=(r=this.outputDevice).close)==null||i.call(r),this.outputDevice=null),this.inputCallback=null,this.connectionState.inputConnected=!1,this.connectionState.outputConnected=!1,this.connectionState.inputDeviceId=void 0,this.connectionState.outputDeviceId=void 0,this.connectionState.inputDeviceName=void 0,this.connectionState.outputDeviceName=void 0}get isSupported(){return!0}get isInitialized(){return!!this.jzz}get hasInputDevice(){return this.connectionState.inputConnected}get hasOutputDevice(){return this.connectionState.outputConnected}get connectionStatus(){return{...this.connectionState}}get intentionalDisconnectStatus(){return{...this.intentionalDisconnectFlags}}onDeviceChange(e){return this.deviceChangeCallbacks.add(e),()=>this.deviceChangeCallbacks.delete(e)}refresh(){this.jzz&&this.jzz.refresh()}processDeviceChanges(e){var r,i,o,a;const t={inputs:{added:[],removed:[]},outputs:{added:[],removed:[]}};return(r=e.inputs)!=null&&r.added&&e.inputs.added.forEach(s=>{t.inputs.added.push({id:s.id||s.name,name:s.name||"Unknown Input Device"})}),(i=e.inputs)!=null&&i.removed&&e.inputs.removed.forEach(s=>{t.inputs.removed.push({id:s.id||s.name,name:s.name||"Unknown Input Device"})}),(o=e.outputs)!=null&&o.added&&e.outputs.added.forEach(s=>{t.outputs.added.push({id:s.id||s.name,name:s.name||"Unknown Output Device"})}),(a=e.outputs)!=null&&a.removed&&e.outputs.removed.forEach(s=>{t.outputs.removed.push({id:s.id||s.name,name:s.name||"Unknown Output Device"})}),t}handleDeviceDisconnections(e){this.connectionState.inputConnected&&this.connectionState.inputDeviceId&&e.inputs.removed.some(r=>r.id===this.connectionState.inputDeviceId)&&(console.log(`Input device ${this.connectionState.inputDeviceName} was disconnected`),this.connectionState.inputConnected=!1,this.inputDevice=null),this.connectionState.outputConnected&&this.connectionState.outputDeviceId&&e.outputs.removed.some(r=>r.id===this.connectionState.outputDeviceId)&&(console.log(`Output device ${this.connectionState.outputDeviceName} was disconnected`),this.connectionState.outputConnected=!1,this.outputDevice=null)}async attemptAutoReconnect(){const e=lr.getState().midi;if(e.lastInputDeviceId&&!this.intentionalDisconnectFlags.input){const r=this.getInputDevices().find(i=>i.id===e.lastInputDeviceId);r&&console.log(`Input device available for auto-reconnect: ${r.name}`)}else e.lastInputDeviceId&&this.intentionalDisconnectFlags.input&&console.log("Skipping input auto-reconnect due to intentional disconnect");if(e.lastOutputDeviceId&&!this.intentionalDisconnectFlags.output){const r=this.getOutputDevices().find(i=>i.id===e.lastOutputDeviceId);r&&(console.log(`Attempting to auto-reconnect to output device: ${r.name}`),await this.connectOutputDevice(e.lastOutputDeviceId))}else e.lastOutputDeviceId&&this.intentionalDisconnectFlags.output&&console.log("Skipping output auto-reconnect due to intentional disconnect")}async attemptAutoReconnectInput(e){const t=lr.getState().midi;if(t.lastInputDeviceId&&!this.intentionalDisconnectFlags.input){const i=this.getInputDevices().find(o=>o.id===t.lastInputDeviceId);if(i)return console.log(`Attempting to auto-reconnect to input device: ${i.name}`),await this.connectInputDevice(t.lastInputDeviceId,e)}else t.lastInputDeviceId&&this.intentionalDisconnectFlags.input&&console.log("Skipping input auto-reconnect due to intentional disconnect");return!1}canReconnectToDevice(e,t){return(t==="input"?this.getInputDevices():this.getOutputDevices()).some(i=>i.id===e)}async attemptReconnect(e,t){return t==="input"&&this.inputCallback?await this.connectInputDevice(e,this.inputCallback):t==="output"?await this.connectOutputDevice(e):!1}setIntentionalDisconnect(e){(e==="input"||e==="both")&&(this.intentionalDisconnectFlags.input=!0),(e==="output"||e==="both")&&(this.intentionalDisconnectFlags.output=!0),console.log(`Set intentional disconnect flag for: ${e}`)}resetIntentionalDisconnectFlags(){this.intentionalDisconnectFlags.input=!1,this.intentionalDisconnectFlags.output=!1,console.log("Reset intentional disconnect flags")}shutdown(){this.disconnect(),this.deviceWatcher&&(this.deviceWatcher.disconnect(),this.deviceWatcher=null),this.jzz&&(this.jzz.close(),this.jzz=null),this.deviceChangeCallbacks.clear()}getMidiMessageType(e){const t=e&240,r=(e&15)+1;switch(t){case 128:return`Note Off Ch.${r}`;case 144:return`Note On Ch.${r}`;case 160:return`Polyphonic Aftertouch Ch.${r}`;case 176:return`Control Change Ch.${r}`;case 192:return`Program Change Ch.${r}`;case 208:return`Channel Aftertouch Ch.${r}`;case 224:return`Pitch Bend Ch.${r}`;case 240:return this.getSystemMessageType(e);default:return`Unknown (${e.toString(16).toUpperCase()})`}}getSystemMessageType(e){switch(e){case 240:return"System Exclusive";case 241:return"MIDI Time Code Quarter Frame";case 242:return"Song Position Pointer";case 243:return"Song Select";case 246:return"Tune Request";case 247:return"End of Exclusive";case 248:return"Timing Clock";case 250:return"Start";case 251:return"Continue";case 252:return"Stop";case 254:return"Active Sensing";case 255:return"Reset";default:return`System (${e.toString(16).toUpperCase()})`}}}const en=new hO;class pO extends $n{constructor(t){super(t);oe(this,"packageName","Client.Midi");oe(this,"packageVersion",1);oe(this,"activeNotes",new Map);oe(this,"isAdvertised",!1);oe(this,"debugCallback")}get enabled(){return lr.getState().midi.enabled}async ensureInitialized(){if(this.isInitialized)return!0;if(!en.isSupported)return console.log("MIDI not supported in this browser"),!1;const t=await en.initialize();return t&&(console.log("MIDI service initialized"),await en.attemptAutoReconnectInput(r=>{this.handleInputMessage(r)})),t}get isInitialized(){return en.isInitialized}async connectInputDevice(t){return await this.ensureInitialized()?await en.connectInputDevice(t,i=>{this.handleInputMessage(i)}):!1}async connectOutputDevice(t){return await this.ensureInitialized()?await en.connectOutputDevice(t):!1}handleInputMessage(t){let r="";const i=t.rawData.hex,o=t.rawData.type;if(t.note){const a={note:t.note.note,velocity:t.note.velocity,on:t.note.on,channel:t.note.channel};this.sendData("Note",a),r=`Client.Midi.Note ${JSON.stringify(a)}`}else if(t.controlChange){const a={controller:t.controlChange.controller,value:t.controlChange.value,channel:t.controlChange.channel};this.sendData("ControlChange",a),r=`Client.Midi.ControlChange ${JSON.stringify(a)}`}else if(t.programChange){const a={program:t.programChange.program,channel:t.programChange.channel};this.sendData("ProgramChange",a),r=`Client.Midi.ProgramChange ${JSON.stringify(a)}`}else if(t.systemMessage){const a={type:t.systemMessage.type,data:t.systemMessage.data};this.sendData("SystemMessage",a),r=`Client.Midi.SystemMessage ${JSON.stringify(a)}`}else if(t.raw){const a={hex:t.raw.hex,data:Array.from(t.raw.data),type:t.raw.type};this.sendData("RawMessage",a),r=`Client.Midi.RawMessage ${JSON.stringify(a)}`}this.debugCallback&&r&&this.debugCallback(i,o,r)}sendNoteToServer(t,r){const i={note:t.note,velocity:t.velocity,on:t.on,channel:t.channel};r!==void 0&&(i.duration=r),this.sendData("Note",i)}handleNote(t){const r={note:t.note,velocity:t.velocity,on:t.on,channel:t.channel},i=`${t.note}_${t.channel||0}`;if(this.activeNotes.has(i)&&(clearTimeout(this.activeNotes.get(i)),this.activeNotes.delete(i)),en.sendNote(r),t.on&&t.duration){const o=setTimeout(()=>{en.sendNote({...r,on:!1,velocity:0}),this.activeNotes.delete(i)},t.duration);this.activeNotes.set(i,o)}}handleControlChange(t){if(en.hasOutputDevice){const r=176|t.channel;en.sendRawMessage([r,t.controller,t.value])}}handleProgramChange(t){if(en.hasOutputDevice){const r=192|t.channel;en.sendRawMessage([r,t.program])}}handleSystemMessage(t){en.hasOutputDevice&&en.sendRawMessage(t.data)}handleRawMessage(t){en.hasOutputDevice&&en.sendRawMessage(t.data)}handleEnable(t){console.log("Server MIDI enable status:",t.enabled)}advertiseMidiSupport(){if(!this.isAdvertised){const t=this.client.gmcpHandlers["Core.Supports"];t&&(t.sendAdd([{name:"Client.Midi",version:this.packageVersion||1}]),this.isAdvertised=!0,console.log("Advertised MIDI support to server"))}}unadvertiseMidiSupport(){if(this.isAdvertised){const t=this.client.gmcpHandlers["Core.Supports"];t&&(t.sendRemove(["Client.Midi"]),this.isAdvertised=!1,console.log("Removed MIDI support advertisement from server"))}}sendMidiCapability(){this.sendData("Enable",{enabled:en.isSupported&&en.isInitialized})}sendManualNote(t,r,i,o,a){const s={note:t,velocity:r,on:i,channel:o||0};this.sendNoteToServer(s,a)}sendAllNotesOff(){en.sendAllNotesOff(),this.activeNotes.forEach(t=>{clearTimeout(t)}),this.activeNotes.clear()}async getInputDevices(){return await this.ensureInitialized()?en.getInputDevices():[]}async getOutputDevices(){return await this.ensureInitialized()?en.getOutputDevices():[]}get hasInputDevice(){return en.hasInputDevice}get hasOutputDevice(){return en.hasOutputDevice}setDebugCallback(t){this.debugCallback=t}shutdown(){en.disconnect(),this.activeNotes.forEach(t=>{clearTimeout(t)}),this.activeNotes.clear()}}class gO extends $n{constructor(){super(...arguments);oe(this,"packageName","Client.Speech")}handleSpeak(t){const r=new SpeechSynthesisUtterance(t.text);r.rate=t.rate,r.pitch=t.pitch,r.volume=t.volume,speechSynthesis.speak(r)}}class mO extends $n{constructor(){super(...arguments);oe(this,"packageName","Comm.Channel");oe(this,"channels",[])}handleList(t){this.channels=t}sendList(){this.sendData("List")}handleText(t){console.log(`Received Comm.Channel.Text on ${t.channel} from ${t.talker}: ${t.text}`),this.client.emit("channelText",t),t.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${t.talker}`,`${t.text}`))}handlePlayers(t){console.log("Received Comm.Channel.Players:",t),this.client.emit("channelPlayers",t)}sendPlayersRequest(){this.sendData("Players","")}sendEnable(t){this.sendData("Enable",t)}handleStart(t){console.log(`Received Comm.Channel.Start for ${t}`),this.client.emit("channelStart",t)}handleEnd(t){console.log(`Received Comm.Channel.End for ${t}`),this.client.emit("channelEnd",t)}}class vO extends $n{constructor(){super(...arguments);oe(this,"packageName","Comm.LiveKit")}handleroom_token(t){this.client.worldData.liveKitTokens.push(t.token),this.client.emit("livekitToken",t.token)}handleroom_leave(t){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==t.token),this.client.emit("livekitLeave",t.token)}}class yO extends $n{constructor(){super(...arguments);oe(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}sendKeepAlive(){this.sendData("KeepAlive")}sendPing(t){this.sendData("Ping",t)}handlePing(){console.log("Received Core.Ping response from server."),this.client.emit("corePing")}handleGoodbye(t){console.log(`Server sent Core.Goodbye: ${t}`),this.client.emit("coreGoodbye",t)}}class CO extends $n{constructor(){super(...arguments);oe(this,"packageName","Core.Supports")}sendSet(){const t=Object.values(this.client.gmcpHandlers).filter(r=>r.packageName&&r.packageVersion&&r.enabled).map(r=>`${r.packageName} ${r.packageVersion.toString()}`);this.sendData("Set",t)}sendAdd(t){const r=t.map(i=>`${i.name} ${i.version}`);this.sendData("Add",r)}sendRemove(t){this.sendData("Remove",t)}}class xO extends $n{constructor(){super(...arguments);oe(this,"packageName","Char.Afflictions")}handleList(t){console.log("Received Char.Afflictions.List:",t),this.client.emit("afflictionsList",t)}handleAdd(t){console.log("Received Char.Afflictions.Add:",t),this.client.emit("afflictionAdd",t)}handleRemove(t){console.log("Received Char.Afflictions.Remove:",t),this.client.emit("afflictionRemove",t)}}class bO extends $n{constructor(){super(...arguments);oe(this,"packageName","Char.Defences")}handleList(t){console.log("Received Char.Defences.List:",t),this.client.emit("defencesList",t)}handleAdd(t){console.log("Received Char.Defences.Add:",t),this.client.emit("defenceAdd",t)}handleRemove(t){console.log("Received Char.Defences.Remove:",t),this.client.emit("defenceRemove",t)}}class IO extends $n{constructor(){super(...arguments);oe(this,"packageName","Char.Items")}handleList(t){console.log(`Received Char.Items.List for ${t.location}:`,t.items);const r=t.items.map(i=>({...i,location:t.location}));this.client.emit("itemsList",{...t,items:r})}handleAdd(t){console.log(`Received Char.Items.Add for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemAdd",{...t,item:r})}handleRemove(t){console.log(`Received Char.Items.Remove for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemRemove",{...t,item:r})}handleUpdate(t){console.log(`Received Char.Items.Update for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemUpdate",{...t,item:r})}sendContentsRequest(t){this.sendData("Contents",t)}sendInventoryRequest(){this.sendData("Inv","")}sendRoomRequest(){this.sendData("Room","")}}class wO extends $n{constructor(){super(...arguments);oe(this,"packageName","Char.Skills")}handleGroups(t){console.log("Received Char.Skills.Groups:",t),this.client.emit("skillGroups",t)}handleList(t){console.log(`Received Char.Skills.List for ${t.group}:`,t),this.client.emit("skillList",t)}handleInfo(t){console.log(`Received Char.Skills.Info for ${t.group}.${t.skill}:`,t.info),this.client.emit("skillInfo",t)}sendGetRequest(t,r){const i={};t&&(i.group=t),r&&(i.name=r),this.sendData("Get",i)}}class SO extends $n{constructor(){super(...arguments);oe(this,"packageName","Group")}handleInfo(t){console.log("Received Group.Info:",t),this.client.emit("groupInfo",t)}sendInfoRequest(){this.sendData("Info",{})}}class AO extends $n{constructor(){super(...arguments);oe(this,"packageName","Logging")}handleError(t){console.error("Received Logging.Error from server:",t),this.client.emit("gmcpError",t)}}class kO extends $n{constructor(){super(...arguments);oe(this,"packageName","Redirect")}handleWindow(t){const r=t||"main";console.log(`Received Redirect.Window: ${r}`),this.client.emit("redirectWindow",r)}}class EO extends $n{constructor(){super(...arguments);oe(this,"packageName","Room");oe(this,"name","");oe(this,"id","");oe(this,"exits",[]);oe(this,"people",[])}handleInfo(t){this.client.worldData.roomPlayers=[],this.name=t.name,this.id=t.num.toString(),this.client.worldData.roomId=this.id,this.client.currentRoomInfo=t,console.log("Received Room.Info:",t),this.client.emit("roomInfo",t)}handleWrongDir(t){console.log(`Received Room.WrongDir: ${t}`),this.client.emit("roomWrongDir",t)}handlePlayers(t){console.log("Received Room.Players:",t),this.client.worldData.roomPlayers=t.sort((r,i)=>r.fullname.localeCompare(i.fullname)),this.client.emit("roomPlayers",t)}handleAddPlayer(t){console.log("Received Room.AddPlayer:",t),this.client.worldData.roomPlayers.some(r=>r.name===t.name)||(this.client.worldData.roomPlayers.push(t),this.client.worldData.roomPlayers.sort((r,i)=>r.fullname.localeCompare(i.fullname))),this.client.emit("roomAddPlayer",t)}handleRemovePlayer(t){console.log("Received Room.RemovePlayer:",t),this.client.worldData.roomPlayers=this.client.worldData.roomPlayers.filter(r=>r.name!==t),this.client.emit("roomRemovePlayer",t)}}const ou=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,xE=new Set,Xv=typeof process=="object"&&process?process:{},bE=(n,e,t,r)=>{typeof Xv.emitWarning=="function"?Xv.emitWarning(n,e,t,r):console.error(`[${t}] ${e}: ${n}`)};let ap=globalThis.AbortController,FI=globalThis.AbortSignal;var BA;if(typeof ap>"u"){FI=class{constructor(){oe(this,"onabort");oe(this,"_onabort",[]);oe(this,"reason");oe(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},ap=class{constructor(){oe(this,"signal",new FI);e()}abort(r){var i,o;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const a of this.signal._onabort)a(r);(o=(i=this.signal).onabort)==null||o.call(i,r)}}};let n=((BA=Xv.env)==null?void 0:BA.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{n&&(n=!1,bE("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const TO=n=>!xE.has(n),uc=n=>n&&n===Math.floor(n)&&n>0&&isFinite(n),IE=n=>uc(n)?n<=Math.pow(2,8)?Uint8Array:n<=Math.pow(2,16)?Uint16Array:n<=Math.pow(2,32)?Uint32Array:n<=Number.MAX_SAFE_INTEGER?Xh:null:null;class Xh extends Array{constructor(e){super(e),this.fill(0)}}var Iu;const sl=class sl{constructor(e,t){oe(this,"heap");oe(this,"length");if(!le(sl,Iu))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}static create(e){const t=IE(e);if(!t)return[];Jt(sl,Iu,!0);const r=new sl(e,t);return Jt(sl,Iu,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};Iu=new WeakMap,Rn(sl,Iu,!1);let $v=sl;var OA,FA,ls,bo,us,ds,wu,Su,Xr,fs,Fr,ar,dn,Fi,Io,Ri,ii,hs,oi,ps,gs,wo,ms,yc,Li,xt,qv,cl,Sa,pf,So,wE,ll,Au,gf,dc,fc,Yv,$h,Kh,sr,Qv,Ld,hc,Jv;const E1=class E1{constructor(e){Rn(this,xt);Rn(this,ls);Rn(this,bo);Rn(this,us);Rn(this,ds);Rn(this,wu);Rn(this,Su);oe(this,"ttl");oe(this,"ttlResolution");oe(this,"ttlAutopurge");oe(this,"updateAgeOnGet");oe(this,"updateAgeOnHas");oe(this,"allowStale");oe(this,"noDisposeOnSet");oe(this,"noUpdateTTL");oe(this,"maxEntrySize");oe(this,"sizeCalculation");oe(this,"noDeleteOnFetchRejection");oe(this,"noDeleteOnStaleGet");oe(this,"allowStaleOnFetchAbort");oe(this,"allowStaleOnFetchRejection");oe(this,"ignoreFetchAbort");Rn(this,Xr);Rn(this,fs);Rn(this,Fr);Rn(this,ar);Rn(this,dn);Rn(this,Fi);Rn(this,Io);Rn(this,Ri);Rn(this,ii);Rn(this,hs);Rn(this,oi);Rn(this,ps);Rn(this,gs);Rn(this,wo);Rn(this,ms);Rn(this,yc);Rn(this,Li);Rn(this,cl,()=>{});Rn(this,Sa,()=>{});Rn(this,pf,()=>{});Rn(this,So,()=>!1);Rn(this,ll,e=>{});Rn(this,Au,(e,t,r)=>{});Rn(this,gf,(e,t,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});oe(this,OA,"LRUCache");const{max:t=0,ttl:r,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:a,updateAgeOnHas:s,allowStale:l,dispose:f,disposeAfter:h,noDisposeOnSet:m,noUpdateTTL:g,maxSize:y=0,maxEntrySize:C=0,sizeCalculation:x,fetchMethod:w,memoMethod:S,noDeleteOnFetchRejection:A,noDeleteOnStaleGet:E,allowStaleOnFetchRejection:_,allowStaleOnFetchAbort:T,ignoreFetchAbort:M}=e;if(t!==0&&!uc(t))throw new TypeError("max option must be a nonnegative integer");const P=t?IE(t):Array;if(!P)throw new Error("invalid max value: "+t);if(Jt(this,ls,t),Jt(this,bo,y),this.maxEntrySize=C||le(this,bo),this.sizeCalculation=x,this.sizeCalculation){if(!le(this,bo)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(S!==void 0&&typeof S!="function")throw new TypeError("memoMethod must be a function if defined");if(Jt(this,Su,S),w!==void 0&&typeof w!="function")throw new TypeError("fetchMethod must be a function if specified");if(Jt(this,wu,w),Jt(this,yc,!!w),Jt(this,Fr,new Map),Jt(this,ar,new Array(t).fill(void 0)),Jt(this,dn,new Array(t).fill(void 0)),Jt(this,Fi,new P(t)),Jt(this,Io,new P(t)),Jt(this,Ri,0),Jt(this,ii,0),Jt(this,hs,$v.create(t)),Jt(this,Xr,0),Jt(this,fs,0),typeof f=="function"&&Jt(this,us,f),typeof h=="function"?(Jt(this,ds,h),Jt(this,oi,[])):(Jt(this,ds,void 0),Jt(this,oi,void 0)),Jt(this,ms,!!le(this,us)),Jt(this,Li,!!le(this,ds)),this.noDisposeOnSet=!!m,this.noUpdateTTL=!!g,this.noDeleteOnFetchRejection=!!A,this.allowStaleOnFetchRejection=!!_,this.allowStaleOnFetchAbort=!!T,this.ignoreFetchAbort=!!M,this.maxEntrySize!==0){if(le(this,bo)!==0&&!uc(le(this,bo)))throw new TypeError("maxSize must be a positive integer if specified");if(!uc(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Nt(this,xt,wE).call(this)}if(this.allowStale=!!l,this.noDeleteOnStaleGet=!!E,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!s,this.ttlResolution=uc(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=r||0,this.ttl){if(!uc(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Nt(this,xt,qv).call(this)}if(le(this,ls)===0&&this.ttl===0&&le(this,bo)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!le(this,ls)&&!le(this,bo)){const j="LRU_CACHE_UNBOUNDED";TO(j)&&(xE.add(j),bE("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",j,E1))}}static unsafeExposeInternals(e){return{starts:le(e,gs),ttls:le(e,wo),sizes:le(e,ps),keyMap:le(e,Fr),keyList:le(e,ar),valList:le(e,dn),next:le(e,Fi),prev:le(e,Io),get head(){return le(e,Ri)},get tail(){return le(e,ii)},free:le(e,hs),isBackgroundFetch:t=>{var r;return Nt(r=e,xt,sr).call(r,t)},backgroundFetch:(t,r,i,o)=>{var a;return Nt(a=e,xt,Kh).call(a,t,r,i,o)},moveToTail:t=>{var r;return Nt(r=e,xt,Ld).call(r,t)},indexes:t=>{var r;return Nt(r=e,xt,dc).call(r,t)},rindexes:t=>{var r;return Nt(r=e,xt,fc).call(r,t)},isStale:t=>{var r;return le(r=e,So).call(r,t)}}}get max(){return le(this,ls)}get maxSize(){return le(this,bo)}get calculatedSize(){return le(this,fs)}get size(){return le(this,Xr)}get fetchMethod(){return le(this,wu)}get memoMethod(){return le(this,Su)}get dispose(){return le(this,us)}get disposeAfter(){return le(this,ds)}getRemainingTTL(e){return le(this,Fr).has(e)?1/0:0}*entries(){for(const e of Nt(this,xt,dc).call(this))le(this,dn)[e]!==void 0&&le(this,ar)[e]!==void 0&&!Nt(this,xt,sr).call(this,le(this,dn)[e])&&(yield[le(this,ar)[e],le(this,dn)[e]])}*rentries(){for(const e of Nt(this,xt,fc).call(this))le(this,dn)[e]!==void 0&&le(this,ar)[e]!==void 0&&!Nt(this,xt,sr).call(this,le(this,dn)[e])&&(yield[le(this,ar)[e],le(this,dn)[e]])}*keys(){for(const e of Nt(this,xt,dc).call(this)){const t=le(this,ar)[e];t!==void 0&&!Nt(this,xt,sr).call(this,le(this,dn)[e])&&(yield t)}}*rkeys(){for(const e of Nt(this,xt,fc).call(this)){const t=le(this,ar)[e];t!==void 0&&!Nt(this,xt,sr).call(this,le(this,dn)[e])&&(yield t)}}*values(){for(const e of Nt(this,xt,dc).call(this))le(this,dn)[e]!==void 0&&!Nt(this,xt,sr).call(this,le(this,dn)[e])&&(yield le(this,dn)[e])}*rvalues(){for(const e of Nt(this,xt,fc).call(this))le(this,dn)[e]!==void 0&&!Nt(this,xt,sr).call(this,le(this,dn)[e])&&(yield le(this,dn)[e])}[(FA=Symbol.iterator,OA=Symbol.toStringTag,FA)](){return this.entries()}find(e,t={}){for(const r of Nt(this,xt,dc).call(this)){const i=le(this,dn)[r],o=Nt(this,xt,sr).call(this,i)?i.__staleWhileFetching:i;if(o!==void 0&&e(o,le(this,ar)[r],this))return this.get(le(this,ar)[r],t)}}forEach(e,t=this){for(const r of Nt(this,xt,dc).call(this)){const i=le(this,dn)[r],o=Nt(this,xt,sr).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(t,o,le(this,ar)[r],this)}}rforEach(e,t=this){for(const r of Nt(this,xt,fc).call(this)){const i=le(this,dn)[r],o=Nt(this,xt,sr).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(t,o,le(this,ar)[r],this)}}purgeStale(){let e=!1;for(const t of Nt(this,xt,fc).call(this,{allowStale:!0}))le(this,So).call(this,t)&&(Nt(this,xt,hc).call(this,le(this,ar)[t],"expire"),e=!0);return e}info(e){const t=le(this,Fr).get(e);if(t===void 0)return;const r=le(this,dn)[t],i=Nt(this,xt,sr).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const o={value:i};if(le(this,wo)&&le(this,gs)){const a=le(this,wo)[t],s=le(this,gs)[t];if(a&&s){const l=a-(ou.now()-s);o.ttl=l,o.start=Date.now()}}return le(this,ps)&&(o.size=le(this,ps)[t]),o}dump(){const e=[];for(const t of Nt(this,xt,dc).call(this,{allowStale:!0})){const r=le(this,ar)[t],i=le(this,dn)[t],o=Nt(this,xt,sr).call(this,i)?i.__staleWhileFetching:i;if(o===void 0||r===void 0)continue;const a={value:o};if(le(this,wo)&&le(this,gs)){a.ttl=le(this,wo)[t];const s=ou.now()-le(this,gs)[t];a.start=Math.floor(Date.now()-s)}le(this,ps)&&(a.size=le(this,ps)[t]),e.unshift([r,a])}return e}load(e){this.clear();for(const[t,r]of e){if(r.start){const i=Date.now()-r.start;r.start=ou.now()-i}this.set(t,r.value,r)}}set(e,t,r={}){var g,y,C,x,w;if(t===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:o,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:s=this.sizeCalculation,status:l}=r;let{noUpdateTTL:f=this.noUpdateTTL}=r;const h=le(this,gf).call(this,e,t,r.size||0,s);if(this.maxEntrySize&&h>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),Nt(this,xt,hc).call(this,e,"set"),this;let m=le(this,Xr)===0?void 0:le(this,Fr).get(e);if(m===void 0)m=le(this,Xr)===0?le(this,ii):le(this,hs).length!==0?le(this,hs).pop():le(this,Xr)===le(this,ls)?Nt(this,xt,$h).call(this,!1):le(this,Xr),le(this,ar)[m]=e,le(this,dn)[m]=t,le(this,Fr).set(e,m),le(this,Fi)[le(this,ii)]=m,le(this,Io)[m]=le(this,ii),Jt(this,ii,m),Ih(this,Xr)._++,le(this,Au).call(this,m,h,l),l&&(l.set="add"),f=!1;else{Nt(this,xt,Ld).call(this,m);const S=le(this,dn)[m];if(t!==S){if(le(this,yc)&&Nt(this,xt,sr).call(this,S)){S.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:A}=S;A!==void 0&&!a&&(le(this,ms)&&((g=le(this,us))==null||g.call(this,A,e,"set")),le(this,Li)&&((y=le(this,oi))==null||y.push([A,e,"set"])))}else a||(le(this,ms)&&((C=le(this,us))==null||C.call(this,S,e,"set")),le(this,Li)&&((x=le(this,oi))==null||x.push([S,e,"set"])));if(le(this,ll).call(this,m),le(this,Au).call(this,m,h,l),le(this,dn)[m]=t,l){l.set="replace";const A=S&&Nt(this,xt,sr).call(this,S)?S.__staleWhileFetching:S;A!==void 0&&(l.oldValue=A)}}else l&&(l.set="update")}if(i!==0&&!le(this,wo)&&Nt(this,xt,qv).call(this),le(this,wo)&&(f||le(this,pf).call(this,m,i,o),l&&le(this,Sa).call(this,l,m)),!a&&le(this,Li)&&le(this,oi)){const S=le(this,oi);let A;for(;A=S==null?void 0:S.shift();)(w=le(this,ds))==null||w.call(this,...A)}return this}pop(){var e;try{for(;le(this,Xr);){const t=le(this,dn)[le(this,Ri)];if(Nt(this,xt,$h).call(this,!0),Nt(this,xt,sr).call(this,t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(le(this,Li)&&le(this,oi)){const t=le(this,oi);let r;for(;r=t==null?void 0:t.shift();)(e=le(this,ds))==null||e.call(this,...r)}}}has(e,t={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=t,o=le(this,Fr).get(e);if(o!==void 0){const a=le(this,dn)[o];if(Nt(this,xt,sr).call(this,a)&&a.__staleWhileFetching===void 0)return!1;if(le(this,So).call(this,o))i&&(i.has="stale",le(this,Sa).call(this,i,o));else return r&&le(this,cl).call(this,o),i&&(i.has="hit",le(this,Sa).call(this,i,o)),!0}else i&&(i.has="miss");return!1}peek(e,t={}){const{allowStale:r=this.allowStale}=t,i=le(this,Fr).get(e);if(i===void 0||!r&&le(this,So).call(this,i))return;const o=le(this,dn)[i];return Nt(this,xt,sr).call(this,o)?o.__staleWhileFetching:o}async fetch(e,t={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:s=this.noDisposeOnSet,size:l=0,sizeCalculation:f=this.sizeCalculation,noUpdateTTL:h=this.noUpdateTTL,noDeleteOnFetchRejection:m=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:g=this.allowStaleOnFetchRejection,ignoreFetchAbort:y=this.ignoreFetchAbort,allowStaleOnFetchAbort:C=this.allowStaleOnFetchAbort,context:x,forceRefresh:w=!1,status:S,signal:A}=t;if(!le(this,yc))return S&&(S.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,status:S});const E={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,ttl:a,noDisposeOnSet:s,size:l,sizeCalculation:f,noUpdateTTL:h,noDeleteOnFetchRejection:m,allowStaleOnFetchRejection:g,allowStaleOnFetchAbort:C,ignoreFetchAbort:y,status:S,signal:A};let _=le(this,Fr).get(e);if(_===void 0){S&&(S.fetch="miss");const T=Nt(this,xt,Kh).call(this,e,_,E,x);return T.__returned=T}else{const T=le(this,dn)[_];if(Nt(this,xt,sr).call(this,T)){const L=r&&T.__staleWhileFetching!==void 0;return S&&(S.fetch="inflight",L&&(S.returnedStale=!0)),L?T.__staleWhileFetching:T.__returned=T}const M=le(this,So).call(this,_);if(!w&&!M)return S&&(S.fetch="hit"),Nt(this,xt,Ld).call(this,_),i&&le(this,cl).call(this,_),S&&le(this,Sa).call(this,S,_),T;const P=Nt(this,xt,Kh).call(this,e,_,E,x),X=P.__staleWhileFetching!==void 0&&r;return S&&(S.fetch=M?"stale":"refresh",X&&M&&(S.returnedStale=!0)),X?P.__staleWhileFetching:P.__returned=P}}async forceFetch(e,t={}){const r=await this.fetch(e,t);if(r===void 0)throw new Error("fetch() returned undefined");return r}memo(e,t={}){const r=le(this,Su);if(!r)throw new Error("no memoMethod provided to constructor");const{context:i,forceRefresh:o,...a}=t,s=this.get(e,a);if(!o&&s!==void 0)return s;const l=r(e,s,{options:a,context:i});return this.set(e,l,a),l}get(e,t={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:a}=t,s=le(this,Fr).get(e);if(s!==void 0){const l=le(this,dn)[s],f=Nt(this,xt,sr).call(this,l);return a&&le(this,Sa).call(this,a,s),le(this,So).call(this,s)?(a&&(a.get="stale"),f?(a&&r&&l.__staleWhileFetching!==void 0&&(a.returnedStale=!0),r?l.__staleWhileFetching:void 0):(o||Nt(this,xt,hc).call(this,e,"expire"),a&&r&&(a.returnedStale=!0),r?l:void 0)):(a&&(a.get="hit"),f?l.__staleWhileFetching:(Nt(this,xt,Ld).call(this,s),i&&le(this,cl).call(this,s),l))}else a&&(a.get="miss")}delete(e){return Nt(this,xt,hc).call(this,e,"delete")}clear(){return Nt(this,xt,Jv).call(this,"delete")}};ls=new WeakMap,bo=new WeakMap,us=new WeakMap,ds=new WeakMap,wu=new WeakMap,Su=new WeakMap,Xr=new WeakMap,fs=new WeakMap,Fr=new WeakMap,ar=new WeakMap,dn=new WeakMap,Fi=new WeakMap,Io=new WeakMap,Ri=new WeakMap,ii=new WeakMap,hs=new WeakMap,oi=new WeakMap,ps=new WeakMap,gs=new WeakMap,wo=new WeakMap,ms=new WeakMap,yc=new WeakMap,Li=new WeakMap,xt=new WeakSet,qv=function(){const e=new Xh(le(this,ls)),t=new Xh(le(this,ls));Jt(this,wo,e),Jt(this,gs,t),Jt(this,pf,(o,a,s=ou.now())=>{if(t[o]=a!==0?s:0,e[o]=a,a!==0&&this.ttlAutopurge){const l=setTimeout(()=>{le(this,So).call(this,o)&&Nt(this,xt,hc).call(this,le(this,ar)[o],"expire")},a+1);l.unref&&l.unref()}}),Jt(this,cl,o=>{t[o]=e[o]!==0?ou.now():0}),Jt(this,Sa,(o,a)=>{if(e[a]){const s=e[a],l=t[a];if(!s||!l)return;o.ttl=s,o.start=l,o.now=r||i();const f=o.now-l;o.remainingTTL=s-f}});let r=0;const i=()=>{const o=ou.now();if(this.ttlResolution>0){r=o;const a=setTimeout(()=>r=0,this.ttlResolution);a.unref&&a.unref()}return o};this.getRemainingTTL=o=>{const a=le(this,Fr).get(o);if(a===void 0)return 0;const s=e[a],l=t[a];if(!s||!l)return 1/0;const f=(r||i())-l;return s-f},Jt(this,So,o=>{const a=t[o],s=e[o];return!!s&&!!a&&(r||i())-a>s})},cl=new WeakMap,Sa=new WeakMap,pf=new WeakMap,So=new WeakMap,wE=function(){const e=new Xh(le(this,ls));Jt(this,fs,0),Jt(this,ps,e),Jt(this,ll,t=>{Jt(this,fs,le(this,fs)-e[t]),e[t]=0}),Jt(this,gf,(t,r,i,o)=>{if(Nt(this,xt,sr).call(this,r))return 0;if(!uc(i))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(i=o(r,t),!uc(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Jt(this,Au,(t,r,i)=>{if(e[t]=r,le(this,bo)){const o=le(this,bo)-e[t];for(;le(this,fs)>o;)Nt(this,xt,$h).call(this,!0)}Jt(this,fs,le(this,fs)+e[t]),i&&(i.entrySize=r,i.totalCalculatedSize=le(this,fs))})},ll=new WeakMap,Au=new WeakMap,gf=new WeakMap,dc=function*({allowStale:e=this.allowStale}={}){if(le(this,Xr))for(let t=le(this,ii);!(!Nt(this,xt,Yv).call(this,t)||((e||!le(this,So).call(this,t))&&(yield t),t===le(this,Ri)));)t=le(this,Io)[t]},fc=function*({allowStale:e=this.allowStale}={}){if(le(this,Xr))for(let t=le(this,Ri);!(!Nt(this,xt,Yv).call(this,t)||((e||!le(this,So).call(this,t))&&(yield t),t===le(this,ii)));)t=le(this,Fi)[t]},Yv=function(e){return e!==void 0&&le(this,Fr).get(le(this,ar)[e])===e},$h=function(e){var o,a;const t=le(this,Ri),r=le(this,ar)[t],i=le(this,dn)[t];return le(this,yc)&&Nt(this,xt,sr).call(this,i)?i.__abortController.abort(new Error("evicted")):(le(this,ms)||le(this,Li))&&(le(this,ms)&&((o=le(this,us))==null||o.call(this,i,r,"evict")),le(this,Li)&&((a=le(this,oi))==null||a.push([i,r,"evict"]))),le(this,ll).call(this,t),e&&(le(this,ar)[t]=void 0,le(this,dn)[t]=void 0,le(this,hs).push(t)),le(this,Xr)===1?(Jt(this,Ri,Jt(this,ii,0)),le(this,hs).length=0):Jt(this,Ri,le(this,Fi)[t]),le(this,Fr).delete(r),Ih(this,Xr)._--,t},Kh=function(e,t,r,i){const o=t===void 0?void 0:le(this,dn)[t];if(Nt(this,xt,sr).call(this,o))return o;const a=new ap,{signal:s}=r;s==null||s.addEventListener("abort",()=>a.abort(s.reason),{signal:a.signal});const l={signal:a.signal,options:r,context:i},f=(x,w=!1)=>{const{aborted:S}=a.signal,A=r.ignoreFetchAbort&&x!==void 0;if(r.status&&(S&&!w?(r.status.fetchAborted=!0,r.status.fetchError=a.signal.reason,A&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),S&&!A&&!w)return m(a.signal.reason);const E=y;return le(this,dn)[t]===y&&(x===void 0?E.__staleWhileFetching?le(this,dn)[t]=E.__staleWhileFetching:Nt(this,xt,hc).call(this,e,"fetch"):(r.status&&(r.status.fetchUpdated=!0),this.set(e,x,l.options))),x},h=x=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=x),m(x)),m=x=>{const{aborted:w}=a.signal,S=w&&r.allowStaleOnFetchAbort,A=S||r.allowStaleOnFetchRejection,E=A||r.noDeleteOnFetchRejection,_=y;if(le(this,dn)[t]===y&&(!E||_.__staleWhileFetching===void 0?Nt(this,xt,hc).call(this,e,"fetch"):S||(le(this,dn)[t]=_.__staleWhileFetching)),A)return r.status&&_.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),_.__staleWhileFetching;if(_.__returned===_)throw x},g=(x,w)=>{var A;const S=(A=le(this,wu))==null?void 0:A.call(this,e,o,l);S&&S instanceof Promise&&S.then(E=>x(E===void 0?void 0:E),w),a.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(x(void 0),r.allowStaleOnFetchAbort&&(x=E=>f(E,!0)))})};r.status&&(r.status.fetchDispatched=!0);const y=new Promise(g).then(f,h),C=Object.assign(y,{__abortController:a,__staleWhileFetching:o,__returned:void 0});return t===void 0?(this.set(e,C,{...l.options,status:void 0}),t=le(this,Fr).get(e)):le(this,dn)[t]=C,C},sr=function(e){if(!le(this,yc))return!1;const t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof ap},Qv=function(e,t){le(this,Io)[t]=e,le(this,Fi)[e]=t},Ld=function(e){e!==le(this,ii)&&(e===le(this,Ri)?Jt(this,Ri,le(this,Fi)[e]):Nt(this,xt,Qv).call(this,le(this,Io)[e],le(this,Fi)[e]),Nt(this,xt,Qv).call(this,le(this,ii),e),Jt(this,ii,e))},hc=function(e,t){var i,o,a,s;let r=!1;if(le(this,Xr)!==0){const l=le(this,Fr).get(e);if(l!==void 0)if(r=!0,le(this,Xr)===1)Nt(this,xt,Jv).call(this,t);else{le(this,ll).call(this,l);const f=le(this,dn)[l];if(Nt(this,xt,sr).call(this,f)?f.__abortController.abort(new Error("deleted")):(le(this,ms)||le(this,Li))&&(le(this,ms)&&((i=le(this,us))==null||i.call(this,f,e,t)),le(this,Li)&&((o=le(this,oi))==null||o.push([f,e,t]))),le(this,Fr).delete(e),le(this,ar)[l]=void 0,le(this,dn)[l]=void 0,l===le(this,ii))Jt(this,ii,le(this,Io)[l]);else if(l===le(this,Ri))Jt(this,Ri,le(this,Fi)[l]);else{const h=le(this,Io)[l];le(this,Fi)[h]=le(this,Fi)[l];const m=le(this,Fi)[l];le(this,Io)[m]=le(this,Io)[l]}Ih(this,Xr)._--,le(this,hs).push(l)}}if(le(this,Li)&&((a=le(this,oi))!=null&&a.length)){const l=le(this,oi);let f;for(;f=l==null?void 0:l.shift();)(s=le(this,ds))==null||s.call(this,...f)}return r},Jv=function(e){var t,r,i;for(const o of Nt(this,xt,fc).call(this,{allowStale:!0})){const a=le(this,dn)[o];if(Nt(this,xt,sr).call(this,a))a.__abortController.abort(new Error("deleted"));else{const s=le(this,ar)[o];le(this,ms)&&((t=le(this,us))==null||t.call(this,a,s,e)),le(this,Li)&&((r=le(this,oi))==null||r.push([a,s,e]))}}if(le(this,Fr).clear(),le(this,dn).fill(void 0),le(this,ar).fill(void 0),le(this,wo)&&le(this,gs)&&(le(this,wo).fill(0),le(this,gs).fill(0)),le(this,ps)&&le(this,ps).fill(0),Jt(this,Ri,0),Jt(this,ii,0),le(this,hs).length=0,Jt(this,fs,0),Jt(this,Xr,0),le(this,Li)&&le(this,oi)){const o=le(this,oi);let a;for(;a=o==null?void 0:o.shift();)(i=le(this,ds))==null||i.call(this,...a)}};let Kv=E1;function _O(n){const e=n.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+n+"`"),null;const t=e[1],r=e[2],i={},o=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let a;for(;a=o.exec(e[3]);){const s=a[1]||a[3],l=a[2]||a[4];s in i?console.log(`Invalid message format: duplicate key ${s} detected`):i[s]=l}return{name:t,authKey:r,keyvals:i}}function LI(n){const e=n.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+n+"`"),null;const t=e[1]||e[4],r=void 0,i=e[2],o=e[3],a={};return a[i]=o,{name:t,authKey:r,keyvals:a}}function UI(){return(Math.random()+1).toString(36).substring(3,9)}class ju{constructor(e){oe(this,"packageName");oe(this,"minVersion",1);oe(this,"maxVersion",1);oe(this,"packageVersion",0);oe(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,t){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,t)}}class RO extends ju{constructor(){super(...arguments);oe(this,"packageName","mcp-negotiate");oe(this,"minVersion",2);oe(this,"maxVersion",2)}handle(t){t.name}sendNegotiate(){var t,r;for(const i of Object.values(this.client.mcpHandlers)){let o=(t=i.minVersion)==null?void 0:t.toFixed(1),a=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":o,"max-version":a})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class PO extends ju{constructor(){super(...arguments);oe(this,"packageName","dns-com-awns-status")}handle(t){console.log(t),this.client.emit("statustext",t.keyvals.text)}}class DO extends ju{constructor(t){super(t);oe(this,"packageName","dns-org-mud-moo-simpleedit");oe(this,"currentSession",null)}handle(t){t.name==="dns-org-mud-moo-simpleedit-content"?this.currentSession={name:t.keyvals.name,reference:t.keyvals.reference,type:t.keyvals.type,contents:[]}:console.log(`Unexpected simpleedit message ${t}`)}handleMultiline(t){this.currentSession&&"content"in t.keyvals?this.currentSession.contents.push(t.keyvals.content):console.log(`Unexpected simpleedit ML ${t}`)}closeMultiline(t){console.log(`Closing multiline ${t.name}`),this.currentSession&&(this.client.editors.openEditorWindow(this.currentSession),this.currentSession=null)}}class MO extends ju{constructor(){super(...arguments);oe(this,"packageName","dns-com-awns-getset");oe(this,"id",1);oe(this,"cache",new Kv({max:10}));oe(this,"LocalCache",{})}handle(t){switch(t.name){case"dns-com-awns-getset-ack":const r=this.cache.get(t.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${t.keyvals.id}`);break}const i=t.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(t){const r=(this.id++).toString();this.cache.set(r,t),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:t})}sendSet(t,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:t,value:r})}sendDrop(t){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:t})}}class NO extends ju{constructor(){super(...arguments);oe(this,"packageName","dns-com-vmoo-userlist");oe(this,"maxVersion",1.1);oe(this,"player");oe(this,"fields",["Object","Name","Icon"]);oe(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);oe(this,"players",[])}handle(t){switch(t.name){case"dns-com-vmoo-userlist-you":this.player=t.keyvals.nr;break}}handleMultiline(t){if("fields"in t.keyvals&&(this.fields=os(t.keyvals.fields.trim())),"icons"in t.keyvals&&(this.icons=os(t.keyvals.icons.trim())),"d"in t.keyvals){const o=t.keyvals.d[0];switch(o){case"=":var r=os(t.keyvals.d.slice(1));this.players=r.map(s=>this.playerFromArray(s));break;case"+":this.players.push(this.playerFromArray(os(t.keyvals.d.slice(1))));break;case"-":var i=os(t.keyvals.d.slice(1));this.players=this.players.filter(s=>!i.includes(s.Object));break;case"*":const a=this.playerFromArray(os(t.keyvals.d.slice(1)));this.updatePlayer(a);break;case"<":i=os(t.keyvals.d.slice(1)),this.players.forEach((s,l)=>{i.includes(s.Object)&&(s.idle=!0,this.players[l]=s)});break;case">":i=os(t.keyvals.d.slice(1)),this.players.forEach((s,l)=>{i.includes(s.Object)&&(s.idle=!1,this.players[l]=s)});break;case"[":i=os(t.keyvals.d.slice(1)),this.players.forEach((s,l)=>{i.includes(s.Object)&&(s.away=!0,this.players[l]=s)});break;case"]":i=os(t.keyvals.d.slice(1)),this.players.forEach((s,l)=>{i.includes(s.Object)&&(s.away=!1,this.players[l]=s)});break;default:console.log(`Unknown userlist mode ${o} in ${t.keyvals.d}`);break}this.update()}}updatePlayer(t){const r=this.players.findIndex(i=>i.Object===t.Object);r!==-1?this.players[r]=t:this.players.push(t)}update(){this.players.sort((r,i)=>t(i)-t(r)),this.client.emit("userlist",this.players);function t(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(t){const r={};return t.forEach((i,o)=>{r[this.fields[o]]=i}),r.away=!1,r.idle=!1,r}}function os(n){n=n.slice(1,-1);let e=[],t="",r=0;for(let o=0;o<n.length;o++){const a=n[o];if(a==="{")r++;else if(a==="}")r--;else if(a===","&&r===0){i(),t="";continue}t+=a}return t.length>0&&i(),e;function i(){t=t.trim(),t.startsWith("{")&&t.endsWith("}")?e.push(os(t)):Number.isNaN(Number(t))?t.startsWith('"')&&t.endsWith('"')?e.push(t.slice(1,-1)):e.push(t):e.push(Number(t))}}class BO extends ju{constructor(){super(...arguments);oe(this,"packageName","dns-com-awns-ping");oe(this,"id",1)}handle(t){switch(t.name){case"dns-com-awns-ping":this.send("reply",t.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}class OO extends Rp{constructor(t){super();oe(this,"peerConnection",null);oe(this,"dataChannel",null);oe(this,"client");oe(this,"connectionTimeout",3e5);oe(this,"connectionTimeoutId");oe(this,"recipient","");oe(this,"pendingCandidates",[]);oe(this,"remoteOfferReceived",!1);this.client=t}isDataChannelOpen(){return this.dataChannel!==null&&this.dataChannel.readyState==="open"}async createPeerConnection(){try{const t={iceServers:[{urls:["turn:mongoose.world:3478","stun:mongoose.world:3478"],username:"p2p",credential:"p2p"},{urls:"stun:stun.l.google.com:19302"}],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};this.peerConnection=new RTCPeerConnection(t),this.peerConnection.onconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.connectionState;switch(console.log("[WebRTCService] Connection state changed to:",r),this.emit("webRTCStateChange",`Connection: ${r}`),r){case"connected":console.log("[WebRTCService] Peer connection established successfully"),this.emit("webRTCConnected");break;case"disconnected":console.log("[WebRTCService] Connection temporarily disconnected"),this.emit("webRTCDisconnected"),setTimeout(()=>{var o;((o=this.peerConnection)==null?void 0:o.connectionState)==="disconnected"&&this.attemptRecovery()},5e3);break;case"failed":console.log("[WebRTCService] Connection failed - attempting immediate recovery"),this.attemptRecovery();break}},this.peerConnection.oniceconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceConnectionState;console.log("[WebRTCService] ICE connection state changed to:",r),this.emit("webRTCStateChange",`ICE: ${r}`),r==="failed"&&(console.log("[WebRTCService] ICE connection failed"),this.attemptRecovery())},this.peerConnection.onsignalingstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.signalingState;console.log("[WebRTCService] Signaling state changed to:",r),this.emit("webRTCStateChange",`Signaling: ${r}`),r==="stable"&&console.log("[WebRTCService] Signaling completed successfully")},this.peerConnection.onicegatheringstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceGatheringState;console.log("[WebRTCService] ICE gathering state changed to:",r),this.emit("webRTCStateChange",`ICE Gathering: ${r}`),r==="complete"&&(console.log("[WebRTCService] ICE gathering completed"),this.emit("iceGatheringComplete"))},this.peerConnection.onicecandidate=r=>{r.candidate?(console.debug("[WebRTCService] New ICE candidate:",{type:r.candidate.type,protocol:r.candidate.protocol,address:r.candidate.address,port:r.candidate.port}),this.recipient&&this.client.gmcp_fileTransfer.sendCandidate(this.recipient,r.candidate)):console.log("[WebRTCService] ICE gathering complete")},this.peerConnection.ondatachannel=r=>{console.log("[WebRTCService] Received data channel"),this.dataChannel=r.channel,this.setupDataChannel()},this.dataChannel||(console.log("[WebRTCService] Creating data channel"),this.dataChannel=this.peerConnection.createDataChannel("fileTransfer",{ordered:!0}),this.setupDataChannel())}catch(t){throw console.error("Error creating peer connection:",t),t}}setupDataChannel(){this.dataChannel&&(this.dataChannel.onopen=()=>{var t;console.log("[WebRTCService] Data channel opened with state:",(t=this.dataChannel)==null?void 0:t.readyState),this.emit("dataChannelOpen")},this.dataChannel.onclose=()=>{console.log("[WebRTCService] Data channel closed"),this.emit("dataChannelClose")},this.dataChannel.onerror=t=>{console.error("[WebRTCService] Data channel error:",t),this.emit("dataChannelError",t)},this.dataChannel.onmessage=t=>{t.data instanceof ArrayBuffer&&this.emit("dataChannelMessage",t.data)})}async attemptRecovery(){try{console.log("[WebRTCService] Attempting connection recovery"),this.close(),await new Promise(t=>setTimeout(t,1e3)),await this.createPeerConnection(),console.log("[WebRTCService] Recovery attempt completed")}catch(t){console.error("[WebRTCService] Recovery attempt failed:",t)}}async attemptChannelRecovery(){var t;try{this.dataChannel=((t=this.peerConnection)==null?void 0:t.createDataChannel("fileTransfer"))??null,this.setupDataChannel()}catch(r){console.error("Failed to recover data channel:",r),this.emit("dataChannelRecoveryFailed",r)}}async sendData(t){if(!this.dataChannel)throw new Error("Data channel not initialized");if(this.dataChannel.readyState!=="open")throw new Error("Data channel is not open");try{for(;this.dataChannel.bufferedAmount>1048576;)await new Promise(i=>{var a;const o=()=>{var s;(s=this.dataChannel)==null||s.removeEventListener("bufferedamountlow",o),i()};(a=this.dataChannel)==null||a.addEventListener("bufferedamountlow",o),this.dataChannel.bufferedAmountLowThreshold=1048576/2});this.dataChannel.send(t)}catch(r){throw console.error("[WebRTCService] Error sending data:",r),r}}async createOffer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const t=await this.peerConnection.createOffer();return await this.peerConnection.setLocalDescription(t),t}catch(t){throw console.error("Error creating offer:",t),t}}async createAnswer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const t=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(t),t}catch(t){throw console.error("Error creating answer:",t),t}}async handleAnswer(t){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{console.log("[WebRTCService] Received WebRTC answer:",t),console.log("[WebRTCService] Current connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Current signaling state:",this.peerConnection.signalingState),await this.peerConnection.setRemoteDescription(new RTCSessionDescription(t)),console.log("[WebRTCService] Remote description set successfully"),console.log("[WebRTCService] Updated connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Updated signaling state:",this.peerConnection.signalingState),this.pendingCandidates.length>0?(console.log(`[WebRTCService] Adding ${this.pendingCandidates.length} pending ICE candidates`),await Promise.all(this.pendingCandidates.map(async(r,i)=>{console.log(`[WebRTCService] Adding ICE candidate ${i+1}/${this.pendingCandidates.length}`),await this.peerConnection.addIceCandidate(new RTCIceCandidate(r))})),console.log("[WebRTCService] All pending ICE candidates added successfully"),this.pendingCandidates=[]):console.log("[WebRTCService] No pending ICE candidates to add")}catch(r){throw console.error("Error handling answer:",r),r}}async handleIceCandidate(t){if(!this.peerConnection||!this.peerConnection.remoteDescription){console.log("[WebRTCService] Storing ICE candidate until peer connection is ready"),this.pendingCandidates.push(t);return}try{console.log("[WebRTCService] Adding ICE candidate immediately"),await this.peerConnection.addIceCandidate(new RTCIceCandidate(t))}catch(r){throw console.error("Error handling ICE candidate:",r),r}}async reconnect(){this.close(),await this.createPeerConnection(),this.emit("webRTCReconnecting")}cleanup(){this.connectionTimeoutId&&(clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=void 0),this.close()}close(){this.pendingCandidates=[],this.dataChannel&&(this.dataChannel.close(),this.dataChannel=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.emit("webRTCClosed")}async waitForConnection(){return new Promise((t,r)=>{if(this.connectionTimeoutId=window.setTimeout(()=>{a(),r(new Error("Connection timeout"))},this.connectionTimeout),this.isDataChannelOpen())return clearTimeout(this.connectionTimeoutId),t();const i=()=>{clearTimeout(this.connectionTimeoutId),a(),t()},o=()=>{var l;((l=this.peerConnection)==null?void 0:l.connectionState)==="failed"&&(clearTimeout(this.connectionTimeoutId),a(),r(new Error("Connection failed")))},a=()=>{this.dataChannel&&this.dataChannel.removeEventListener("open",i),this.peerConnection&&this.peerConnection.removeEventListener("connectionstatechange",o),this.off("dataChannelOpen",i),this.off("webRTCFailed",s)},s=()=>{clearTimeout(this.connectionTimeoutId),a(),r(new Error("Connection failed"))};this.dataChannel&&this.dataChannel.addEventListener("open",i),this.peerConnection&&this.peerConnection.addEventListener("connectionstatechange",o),this.on("dataChannelOpen",i),this.on("webRTCFailed",s)})}isPeerConnectionInitialized(){var t;return console.log("[WebRTCService] Peer connection state:",(t=this.peerConnection)==null?void 0:t.connectionState),this.peerConnection!==null&&this.peerConnection.connectionState!=="closed"}hasRemoteOffer(){return this.remoteOfferReceived}async waitForRemoteOffer(t=3e4){return console.log("[WebRTCService] Waiting for remote offer..."),new Promise((r,i)=>{const o=setTimeout(()=>{s(),console.log("[WebRTCService] Timeout waiting for remote offer"),i(new Error("Timeout waiting for remote offer"))},t),a=()=>{console.log("[WebRTCService] Remote offer received"),clearTimeout(o),s(),r()},s=()=>{this.client.off("remoteOfferReceived",a)};if(this.remoteOfferReceived){console.log("[WebRTCService] Remote offer already received"),clearTimeout(o),r();return}this.client.on("remoteOfferReceived",a)})}async handleOffer(t){console.log("[WebRTCService] Handling WebRTC offer:",t),this.peerConnection||(console.log("[WebRTCService] Creating new peer connection for offer"),await this.createPeerConnection());try{if(await this.peerConnection.setRemoteDescription(new RTCSessionDescription(t)),this.remoteOfferReceived=!0,this.client.emit("remoteOfferReceived"),console.log("[WebRTCService] Remote offer set successfully"),this.pendingCandidates.length>0){console.log(`[WebRTCService] Processing ${this.pendingCandidates.length} pending ICE candidates`);const r=[...this.pendingCandidates];this.pendingCandidates=[];for(const i of r)try{await this.peerConnection.addIceCandidate(new RTCIceCandidate(i)),console.log("[WebRTCService] Successfully added pending ICE candidate")}catch(o){console.warn("[WebRTCService] Failed to add pending ICE candidate:",o)}}}catch(r){throw console.error("[WebRTCService] Error handling offer:",r),r}}}var qh={exports:{}};function FO(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Yh={exports:{}};const LO={},UO=Object.freeze(Object.defineProperty({__proto__:null,default:LO},Symbol.toStringTag,{value:"Module"})),jO=hP(UO);var GO=Yh.exports,jI;function En(){return jI||(jI=1,function(n,e){(function(t,r){n.exports=r()})(GO,function(){var t=t||function(r,i){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof Gh<"u"&&Gh.crypto&&(o=Gh.crypto),!o&&typeof FO=="function")try{o=jO}catch{}var a=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function A(){}return function(E){var _;return A.prototype=E,_=new A,A.prototype=null,_}}(),l={},f=l.lib={},h=f.Base=function(){return{extend:function(A){var E=s(this);return A&&E.mixIn(A),(!E.hasOwnProperty("init")||this.init===E.init)&&(E.init=function(){E.$super.init.apply(this,arguments)}),E.init.prototype=E,E.$super=this,E},create:function(){var A=this.extend();return A.init.apply(A,arguments),A},init:function(){},mixIn:function(A){for(var E in A)A.hasOwnProperty(E)&&(this[E]=A[E]);A.hasOwnProperty("toString")&&(this.toString=A.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),m=f.WordArray=h.extend({init:function(A,E){A=this.words=A||[],E!=i?this.sigBytes=E:this.sigBytes=A.length*4},toString:function(A){return(A||y).stringify(this)},concat:function(A){var E=this.words,_=A.words,T=this.sigBytes,M=A.sigBytes;if(this.clamp(),T%4)for(var P=0;P<M;P++){var j=_[P>>>2]>>>24-P%4*8&255;E[T+P>>>2]|=j<<24-(T+P)%4*8}else for(var X=0;X<M;X+=4)E[T+X>>>2]=_[X>>>2];return this.sigBytes+=M,this},clamp:function(){var A=this.words,E=this.sigBytes;A[E>>>2]&=4294967295<<32-E%4*8,A.length=r.ceil(E/4)},clone:function(){var A=h.clone.call(this);return A.words=this.words.slice(0),A},random:function(A){for(var E=[],_=0;_<A;_+=4)E.push(a());return new m.init(E,A)}}),g=l.enc={},y=g.Hex={stringify:function(A){for(var E=A.words,_=A.sigBytes,T=[],M=0;M<_;M++){var P=E[M>>>2]>>>24-M%4*8&255;T.push((P>>>4).toString(16)),T.push((P&15).toString(16))}return T.join("")},parse:function(A){for(var E=A.length,_=[],T=0;T<E;T+=2)_[T>>>3]|=parseInt(A.substr(T,2),16)<<24-T%8*4;return new m.init(_,E/2)}},C=g.Latin1={stringify:function(A){for(var E=A.words,_=A.sigBytes,T=[],M=0;M<_;M++){var P=E[M>>>2]>>>24-M%4*8&255;T.push(String.fromCharCode(P))}return T.join("")},parse:function(A){for(var E=A.length,_=[],T=0;T<E;T++)_[T>>>2]|=(A.charCodeAt(T)&255)<<24-T%4*8;return new m.init(_,E)}},x=g.Utf8={stringify:function(A){try{return decodeURIComponent(escape(C.stringify(A)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(A){return C.parse(unescape(encodeURIComponent(A)))}},w=f.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new m.init,this._nDataBytes=0},_append:function(A){typeof A=="string"&&(A=x.parse(A)),this._data.concat(A),this._nDataBytes+=A.sigBytes},_process:function(A){var E,_=this._data,T=_.words,M=_.sigBytes,P=this.blockSize,j=P*4,X=M/j;A?X=r.ceil(X):X=r.max((X|0)-this._minBufferSize,0);var L=X*P,G=r.min(L*4,M);if(L){for(var Z=0;Z<L;Z+=P)this._doProcessBlock(T,Z);E=T.splice(0,L),_.sigBytes-=G}return new m.init(E,G)},clone:function(){var A=h.clone.call(this);return A._data=this._data.clone(),A},_minBufferSize:0});f.Hasher=w.extend({cfg:h.extend(),init:function(A){this.cfg=this.cfg.extend(A),this.reset()},reset:function(){w.reset.call(this),this._doReset()},update:function(A){return this._append(A),this._process(),this},finalize:function(A){A&&this._append(A);var E=this._doFinalize();return E},blockSize:16,_createHelper:function(A){return function(E,_){return new A.init(_).finalize(E)}},_createHmacHelper:function(A){return function(E,_){return new S.HMAC.init(A,_).finalize(E)}}});var S=l.algo={};return l}(Math);return t})}(Yh)),Yh.exports}var Qh={exports:{}},VO=Qh.exports,GI;function Fp(){return GI||(GI=1,function(n,e){(function(t,r){n.exports=r(En())})(VO,function(t){return function(r){var i=t,o=i.lib,a=o.Base,s=o.WordArray,l=i.x64={};l.Word=a.extend({init:function(f,h){this.high=f,this.low=h}}),l.WordArray=a.extend({init:function(f,h){f=this.words=f||[],h!=r?this.sigBytes=h:this.sigBytes=f.length*8},toX32:function(){for(var f=this.words,h=f.length,m=[],g=0;g<h;g++){var y=f[g];m.push(y.high),m.push(y.low)}return s.create(m,this.sigBytes)},clone:function(){for(var f=a.clone.call(this),h=f.words=this.words.slice(0),m=h.length,g=0;g<m;g++)h[g]=h[g].clone();return f}})}(),t})}(Qh)),Qh.exports}var Jh={exports:{}},zO=Jh.exports,VI;function WO(){return VI||(VI=1,function(n,e){(function(t,r){n.exports=r(En())})(zO,function(t){return function(){if(typeof ArrayBuffer=="function"){var r=t,i=r.lib,o=i.WordArray,a=o.init,s=o.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var f=l.byteLength,h=[],m=0;m<f;m++)h[m>>>2]|=l[m]<<24-m%4*8;a.call(this,h,f)}else a.apply(this,arguments)};s.prototype=o}}(),t.lib.WordArray})}(Jh)),Jh.exports}var e0={exports:{}},HO=e0.exports,zI;function ZO(){return zI||(zI=1,function(n,e){(function(t,r){n.exports=r(En())})(HO,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=r.enc;a.Utf16=a.Utf16BE={stringify:function(l){for(var f=l.words,h=l.sigBytes,m=[],g=0;g<h;g+=2){var y=f[g>>>2]>>>16-g%4*8&65535;m.push(String.fromCharCode(y))}return m.join("")},parse:function(l){for(var f=l.length,h=[],m=0;m<f;m++)h[m>>>1]|=l.charCodeAt(m)<<16-m%2*16;return o.create(h,f*2)}},a.Utf16LE={stringify:function(l){for(var f=l.words,h=l.sigBytes,m=[],g=0;g<h;g+=2){var y=s(f[g>>>2]>>>16-g%4*8&65535);m.push(String.fromCharCode(y))}return m.join("")},parse:function(l){for(var f=l.length,h=[],m=0;m<f;m++)h[m>>>1]|=s(l.charCodeAt(m)<<16-m%2*16);return o.create(h,f*2)}};function s(l){return l<<8&4278255360|l>>>8&16711935}}(),t.enc.Utf16})}(e0)),e0.exports}var t0={exports:{}},XO=t0.exports,WI;function Rl(){return WI||(WI=1,function(n,e){(function(t,r){n.exports=r(En())})(XO,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=r.enc;a.Base64={stringify:function(l){var f=l.words,h=l.sigBytes,m=this._map;l.clamp();for(var g=[],y=0;y<h;y+=3)for(var C=f[y>>>2]>>>24-y%4*8&255,x=f[y+1>>>2]>>>24-(y+1)%4*8&255,w=f[y+2>>>2]>>>24-(y+2)%4*8&255,S=C<<16|x<<8|w,A=0;A<4&&y+A*.75<h;A++)g.push(m.charAt(S>>>6*(3-A)&63));var E=m.charAt(64);if(E)for(;g.length%4;)g.push(E);return g.join("")},parse:function(l){var f=l.length,h=this._map,m=this._reverseMap;if(!m){m=this._reverseMap=[];for(var g=0;g<h.length;g++)m[h.charCodeAt(g)]=g}var y=h.charAt(64);if(y){var C=l.indexOf(y);C!==-1&&(f=C)}return s(l,f,m)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function s(l,f,h){for(var m=[],g=0,y=0;y<f;y++)if(y%4){var C=h[l.charCodeAt(y-1)]<<y%4*2,x=h[l.charCodeAt(y)]>>>6-y%4*2,w=C|x;m[g>>>2]|=w<<24-g%4*8,g++}return o.create(m,g)}}(),t.enc.Base64})}(t0)),t0.exports}var n0={exports:{}},$O=n0.exports,HI;function KO(){return HI||(HI=1,function(n,e){(function(t,r){n.exports=r(En())})($O,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=r.enc;a.Base64url={stringify:function(l,f){f===void 0&&(f=!0);var h=l.words,m=l.sigBytes,g=f?this._safe_map:this._map;l.clamp();for(var y=[],C=0;C<m;C+=3)for(var x=h[C>>>2]>>>24-C%4*8&255,w=h[C+1>>>2]>>>24-(C+1)%4*8&255,S=h[C+2>>>2]>>>24-(C+2)%4*8&255,A=x<<16|w<<8|S,E=0;E<4&&C+E*.75<m;E++)y.push(g.charAt(A>>>6*(3-E)&63));var _=g.charAt(64);if(_)for(;y.length%4;)y.push(_);return y.join("")},parse:function(l,f){f===void 0&&(f=!0);var h=l.length,m=f?this._safe_map:this._map,g=this._reverseMap;if(!g){g=this._reverseMap=[];for(var y=0;y<m.length;y++)g[m.charCodeAt(y)]=y}var C=m.charAt(64);if(C){var x=l.indexOf(C);x!==-1&&(h=x)}return s(l,h,g)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function s(l,f,h){for(var m=[],g=0,y=0;y<f;y++)if(y%4){var C=h[l.charCodeAt(y-1)]<<y%4*2,x=h[l.charCodeAt(y)]>>>6-y%4*2,w=C|x;m[g>>>2]|=w<<24-g%4*8,g++}return o.create(m,g)}}(),t.enc.Base64url})}(n0)),n0.exports}var r0={exports:{}},qO=r0.exports,ZI;function Pl(){return ZI||(ZI=1,function(n,e){(function(t,r){n.exports=r(En())})(qO,function(t){return function(r){var i=t,o=i.lib,a=o.WordArray,s=o.Hasher,l=i.algo,f=[];(function(){for(var x=0;x<64;x++)f[x]=r.abs(r.sin(x+1))*4294967296|0})();var h=l.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(x,w){for(var S=0;S<16;S++){var A=w+S,E=x[A];x[A]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360}var _=this._hash.words,T=x[w+0],M=x[w+1],P=x[w+2],j=x[w+3],X=x[w+4],L=x[w+5],G=x[w+6],Z=x[w+7],ne=x[w+8],pe=x[w+9],ve=x[w+10],Se=x[w+11],Ne=x[w+12],xe=x[w+13],Ae=x[w+14],ke=x[w+15],H=_[0],ee=_[1],ae=_[2],ye=_[3];H=m(H,ee,ae,ye,T,7,f[0]),ye=m(ye,H,ee,ae,M,12,f[1]),ae=m(ae,ye,H,ee,P,17,f[2]),ee=m(ee,ae,ye,H,j,22,f[3]),H=m(H,ee,ae,ye,X,7,f[4]),ye=m(ye,H,ee,ae,L,12,f[5]),ae=m(ae,ye,H,ee,G,17,f[6]),ee=m(ee,ae,ye,H,Z,22,f[7]),H=m(H,ee,ae,ye,ne,7,f[8]),ye=m(ye,H,ee,ae,pe,12,f[9]),ae=m(ae,ye,H,ee,ve,17,f[10]),ee=m(ee,ae,ye,H,Se,22,f[11]),H=m(H,ee,ae,ye,Ne,7,f[12]),ye=m(ye,H,ee,ae,xe,12,f[13]),ae=m(ae,ye,H,ee,Ae,17,f[14]),ee=m(ee,ae,ye,H,ke,22,f[15]),H=g(H,ee,ae,ye,M,5,f[16]),ye=g(ye,H,ee,ae,G,9,f[17]),ae=g(ae,ye,H,ee,Se,14,f[18]),ee=g(ee,ae,ye,H,T,20,f[19]),H=g(H,ee,ae,ye,L,5,f[20]),ye=g(ye,H,ee,ae,ve,9,f[21]),ae=g(ae,ye,H,ee,ke,14,f[22]),ee=g(ee,ae,ye,H,X,20,f[23]),H=g(H,ee,ae,ye,pe,5,f[24]),ye=g(ye,H,ee,ae,Ae,9,f[25]),ae=g(ae,ye,H,ee,j,14,f[26]),ee=g(ee,ae,ye,H,ne,20,f[27]),H=g(H,ee,ae,ye,xe,5,f[28]),ye=g(ye,H,ee,ae,P,9,f[29]),ae=g(ae,ye,H,ee,Z,14,f[30]),ee=g(ee,ae,ye,H,Ne,20,f[31]),H=y(H,ee,ae,ye,L,4,f[32]),ye=y(ye,H,ee,ae,ne,11,f[33]),ae=y(ae,ye,H,ee,Se,16,f[34]),ee=y(ee,ae,ye,H,Ae,23,f[35]),H=y(H,ee,ae,ye,M,4,f[36]),ye=y(ye,H,ee,ae,X,11,f[37]),ae=y(ae,ye,H,ee,Z,16,f[38]),ee=y(ee,ae,ye,H,ve,23,f[39]),H=y(H,ee,ae,ye,xe,4,f[40]),ye=y(ye,H,ee,ae,T,11,f[41]),ae=y(ae,ye,H,ee,j,16,f[42]),ee=y(ee,ae,ye,H,G,23,f[43]),H=y(H,ee,ae,ye,pe,4,f[44]),ye=y(ye,H,ee,ae,Ne,11,f[45]),ae=y(ae,ye,H,ee,ke,16,f[46]),ee=y(ee,ae,ye,H,P,23,f[47]),H=C(H,ee,ae,ye,T,6,f[48]),ye=C(ye,H,ee,ae,Z,10,f[49]),ae=C(ae,ye,H,ee,Ae,15,f[50]),ee=C(ee,ae,ye,H,L,21,f[51]),H=C(H,ee,ae,ye,Ne,6,f[52]),ye=C(ye,H,ee,ae,j,10,f[53]),ae=C(ae,ye,H,ee,ve,15,f[54]),ee=C(ee,ae,ye,H,M,21,f[55]),H=C(H,ee,ae,ye,ne,6,f[56]),ye=C(ye,H,ee,ae,ke,10,f[57]),ae=C(ae,ye,H,ee,G,15,f[58]),ee=C(ee,ae,ye,H,xe,21,f[59]),H=C(H,ee,ae,ye,X,6,f[60]),ye=C(ye,H,ee,ae,Se,10,f[61]),ae=C(ae,ye,H,ee,P,15,f[62]),ee=C(ee,ae,ye,H,pe,21,f[63]),_[0]=_[0]+H|0,_[1]=_[1]+ee|0,_[2]=_[2]+ae|0,_[3]=_[3]+ye|0},_doFinalize:function(){var x=this._data,w=x.words,S=this._nDataBytes*8,A=x.sigBytes*8;w[A>>>5]|=128<<24-A%32;var E=r.floor(S/4294967296),_=S;w[(A+64>>>9<<4)+15]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,w[(A+64>>>9<<4)+14]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,x.sigBytes=(w.length+1)*4,this._process();for(var T=this._hash,M=T.words,P=0;P<4;P++){var j=M[P];M[P]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360}return T},clone:function(){var x=s.clone.call(this);return x._hash=this._hash.clone(),x}});function m(x,w,S,A,E,_,T){var M=x+(w&S|~w&A)+E+T;return(M<<_|M>>>32-_)+w}function g(x,w,S,A,E,_,T){var M=x+(w&A|S&~A)+E+T;return(M<<_|M>>>32-_)+w}function y(x,w,S,A,E,_,T){var M=x+(w^S^A)+E+T;return(M<<_|M>>>32-_)+w}function C(x,w,S,A,E,_,T){var M=x+(S^(w|~A))+E+T;return(M<<_|M>>>32-_)+w}i.MD5=s._createHelper(h),i.HmacMD5=s._createHmacHelper(h)}(Math),t.MD5})}(r0)),r0.exports}var i0={exports:{}},YO=i0.exports,XI;function SE(){return XI||(XI=1,function(n,e){(function(t,r){n.exports=r(En())})(YO,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=i.Hasher,s=r.algo,l=[],f=s.SHA1=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(h,m){for(var g=this._hash.words,y=g[0],C=g[1],x=g[2],w=g[3],S=g[4],A=0;A<80;A++){if(A<16)l[A]=h[m+A]|0;else{var E=l[A-3]^l[A-8]^l[A-14]^l[A-16];l[A]=E<<1|E>>>31}var _=(y<<5|y>>>27)+S+l[A];A<20?_+=(C&x|~C&w)+1518500249:A<40?_+=(C^x^w)+1859775393:A<60?_+=(C&x|C&w|x&w)-1894007588:_+=(C^x^w)-899497514,S=w,w=x,x=C<<30|C>>>2,C=y,y=_}g[0]=g[0]+y|0,g[1]=g[1]+C|0,g[2]=g[2]+x|0,g[3]=g[3]+w|0,g[4]=g[4]+S|0},_doFinalize:function(){var h=this._data,m=h.words,g=this._nDataBytes*8,y=h.sigBytes*8;return m[y>>>5]|=128<<24-y%32,m[(y+64>>>9<<4)+14]=Math.floor(g/4294967296),m[(y+64>>>9<<4)+15]=g,h.sigBytes=m.length*4,this._process(),this._hash},clone:function(){var h=a.clone.call(this);return h._hash=this._hash.clone(),h}});r.SHA1=a._createHelper(f),r.HmacSHA1=a._createHmacHelper(f)}(),t.SHA1})}(i0)),i0.exports}var o0={exports:{}},QO=o0.exports,$I;function SC(){return $I||($I=1,function(n,e){(function(t,r){n.exports=r(En())})(QO,function(t){return function(r){var i=t,o=i.lib,a=o.WordArray,s=o.Hasher,l=i.algo,f=[],h=[];(function(){function y(S){for(var A=r.sqrt(S),E=2;E<=A;E++)if(!(S%E))return!1;return!0}function C(S){return(S-(S|0))*4294967296|0}for(var x=2,w=0;w<64;)y(x)&&(w<8&&(f[w]=C(r.pow(x,1/2))),h[w]=C(r.pow(x,1/3)),w++),x++})();var m=[],g=l.SHA256=s.extend({_doReset:function(){this._hash=new a.init(f.slice(0))},_doProcessBlock:function(y,C){for(var x=this._hash.words,w=x[0],S=x[1],A=x[2],E=x[3],_=x[4],T=x[5],M=x[6],P=x[7],j=0;j<64;j++){if(j<16)m[j]=y[C+j]|0;else{var X=m[j-15],L=(X<<25|X>>>7)^(X<<14|X>>>18)^X>>>3,G=m[j-2],Z=(G<<15|G>>>17)^(G<<13|G>>>19)^G>>>10;m[j]=L+m[j-7]+Z+m[j-16]}var ne=_&T^~_&M,pe=w&S^w&A^S&A,ve=(w<<30|w>>>2)^(w<<19|w>>>13)^(w<<10|w>>>22),Se=(_<<26|_>>>6)^(_<<21|_>>>11)^(_<<7|_>>>25),Ne=P+Se+ne+h[j]+m[j],xe=ve+pe;P=M,M=T,T=_,_=E+Ne|0,E=A,A=S,S=w,w=Ne+xe|0}x[0]=x[0]+w|0,x[1]=x[1]+S|0,x[2]=x[2]+A|0,x[3]=x[3]+E|0,x[4]=x[4]+_|0,x[5]=x[5]+T|0,x[6]=x[6]+M|0,x[7]=x[7]+P|0},_doFinalize:function(){var y=this._data,C=y.words,x=this._nDataBytes*8,w=y.sigBytes*8;return C[w>>>5]|=128<<24-w%32,C[(w+64>>>9<<4)+14]=r.floor(x/4294967296),C[(w+64>>>9<<4)+15]=x,y.sigBytes=C.length*4,this._process(),this._hash},clone:function(){var y=s.clone.call(this);return y._hash=this._hash.clone(),y}});i.SHA256=s._createHelper(g),i.HmacSHA256=s._createHmacHelper(g)}(Math),t.SHA256})}(o0)),o0.exports}var s0={exports:{}},JO=s0.exports,KI;function eF(){return KI||(KI=1,function(n,e){(function(t,r,i){n.exports=r(En(),SC())})(JO,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=r.algo,s=a.SHA256,l=a.SHA224=s.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var f=s._doFinalize.call(this);return f.sigBytes-=4,f}});r.SHA224=s._createHelper(l),r.HmacSHA224=s._createHmacHelper(l)}(),t.SHA224})}(s0)),s0.exports}var a0={exports:{}},tF=a0.exports,qI;function AE(){return qI||(qI=1,function(n,e){(function(t,r,i){n.exports=r(En(),Fp())})(tF,function(t){return function(){var r=t,i=r.lib,o=i.Hasher,a=r.x64,s=a.Word,l=a.WordArray,f=r.algo;function h(){return s.create.apply(s,arguments)}var m=[h(1116352408,3609767458),h(1899447441,602891725),h(3049323471,3964484399),h(3921009573,2173295548),h(961987163,4081628472),h(1508970993,3053834265),h(2453635748,2937671579),h(2870763221,3664609560),h(3624381080,2734883394),h(310598401,1164996542),h(607225278,1323610764),h(1426881987,3590304994),h(1925078388,4068182383),h(2162078206,991336113),h(2614888103,633803317),h(3248222580,3479774868),h(3835390401,2666613458),h(4022224774,944711139),h(264347078,2341262773),h(604807628,2007800933),h(770255983,1495990901),h(1249150122,1856431235),h(1555081692,3175218132),h(1996064986,2198950837),h(2554220882,3999719339),h(2821834349,766784016),h(2952996808,2566594879),h(3210313671,3203337956),h(3336571891,1034457026),h(3584528711,2466948901),h(113926993,3758326383),h(338241895,168717936),h(666307205,1188179964),h(773529912,1546045734),h(1294757372,1522805485),h(1396182291,2643833823),h(1695183700,2343527390),h(1986661051,1014477480),h(2177026350,1206759142),h(2456956037,344077627),h(2730485921,1290863460),h(2820302411,3158454273),h(3259730800,3505952657),h(3345764771,106217008),h(3516065817,3606008344),h(3600352804,1432725776),h(4094571909,1467031594),h(275423344,851169720),h(430227734,3100823752),h(506948616,1363258195),h(659060556,3750685593),h(883997877,3785050280),h(958139571,3318307427),h(1322822218,3812723403),h(1537002063,2003034995),h(1747873779,3602036899),h(1955562222,1575990012),h(2024104815,1125592928),h(2227730452,2716904306),h(2361852424,442776044),h(2428436474,593698344),h(2756734187,3733110249),h(3204031479,2999351573),h(3329325298,3815920427),h(3391569614,3928383900),h(3515267271,566280711),h(3940187606,3454069534),h(4118630271,4000239992),h(116418474,1914138554),h(174292421,2731055270),h(289380356,3203993006),h(460393269,320620315),h(685471733,587496836),h(852142971,1086792851),h(1017036298,365543100),h(1126000580,2618297676),h(1288033470,3409855158),h(1501505948,4234509866),h(1607167915,987167468),h(1816402316,1246189591)],g=[];(function(){for(var C=0;C<80;C++)g[C]=h()})();var y=f.SHA512=o.extend({_doReset:function(){this._hash=new l.init([new s.init(1779033703,4089235720),new s.init(3144134277,2227873595),new s.init(1013904242,4271175723),new s.init(2773480762,1595750129),new s.init(1359893119,2917565137),new s.init(2600822924,725511199),new s.init(528734635,4215389547),new s.init(1541459225,327033209)])},_doProcessBlock:function(C,x){for(var w=this._hash.words,S=w[0],A=w[1],E=w[2],_=w[3],T=w[4],M=w[5],P=w[6],j=w[7],X=S.high,L=S.low,G=A.high,Z=A.low,ne=E.high,pe=E.low,ve=_.high,Se=_.low,Ne=T.high,xe=T.low,Ae=M.high,ke=M.low,H=P.high,ee=P.low,ae=j.high,ye=j.low,Ee=X,_e=L,Je=G,me=Z,it=ne,Tt=pe,Xt=ve,Et=Se,St=Ne,Dt=xe,at=Ae,lt=ke,Vt=H,Gt=ee,Pt=ae,Ht=ye,on=0;on<80;on++){var ct,ce,nn=g[on];if(on<16)ce=nn.high=C[x+on*2]|0,ct=nn.low=C[x+on*2+1]|0;else{var pn=g[on-15],Un=pn.high,q=pn.low,N=(Un>>>1|q<<31)^(Un>>>8|q<<24)^Un>>>7,F=(q>>>1|Un<<31)^(q>>>8|Un<<24)^(q>>>7|Un<<25),te=g[on-2],Ce=te.high,Pe=te.low,Ge=(Ce>>>19|Pe<<13)^(Ce<<3|Pe>>>29)^Ce>>>6,Lt=(Pe>>>19|Ce<<13)^(Pe<<3|Ce>>>29)^(Pe>>>6|Ce<<26),fn=g[on-7],hn=fn.high,yn=fn.low,un=g[on-16],On=un.high,Sr=un.low;ct=F+yn,ce=N+hn+(ct>>>0<F>>>0?1:0),ct=ct+Lt,ce=ce+Ge+(ct>>>0<Lt>>>0?1:0),ct=ct+Sr,ce=ce+On+(ct>>>0<Sr>>>0?1:0),nn.high=ce,nn.low=ct}var mr=St&at^~St&Vt,Qt=Dt&lt^~Dt&Gt,Yr=Ee&Je^Ee&it^Je&it,Qe=_e&me^_e&Tt^me&Tt,kn=(Ee>>>28|_e<<4)^(Ee<<30|_e>>>2)^(Ee<<25|_e>>>7),zt=(_e>>>28|Ee<<4)^(_e<<30|Ee>>>2)^(_e<<25|Ee>>>7),dr=(St>>>14|Dt<<18)^(St>>>18|Dt<<14)^(St<<23|Dt>>>9),Kn=(Dt>>>14|St<<18)^(Dt>>>18|St<<14)^(Dt<<23|St>>>9),Qr=m[on],Br=Qr.high,ge=Qr.low,Ie=Ht+Kn,J=Pt+dr+(Ie>>>0<Ht>>>0?1:0),Ie=Ie+Qt,J=J+mr+(Ie>>>0<Qt>>>0?1:0),Ie=Ie+ge,J=J+Br+(Ie>>>0<ge>>>0?1:0),Ie=Ie+ct,J=J+ce+(Ie>>>0<ct>>>0?1:0),Ve=zt+Qe,rt=kn+Yr+(Ve>>>0<zt>>>0?1:0);Pt=Vt,Ht=Gt,Vt=at,Gt=lt,at=St,lt=Dt,Dt=Et+Ie|0,St=Xt+J+(Dt>>>0<Et>>>0?1:0)|0,Xt=it,Et=Tt,it=Je,Tt=me,Je=Ee,me=_e,_e=Ie+Ve|0,Ee=J+rt+(_e>>>0<Ie>>>0?1:0)|0}L=S.low=L+_e,S.high=X+Ee+(L>>>0<_e>>>0?1:0),Z=A.low=Z+me,A.high=G+Je+(Z>>>0<me>>>0?1:0),pe=E.low=pe+Tt,E.high=ne+it+(pe>>>0<Tt>>>0?1:0),Se=_.low=Se+Et,_.high=ve+Xt+(Se>>>0<Et>>>0?1:0),xe=T.low=xe+Dt,T.high=Ne+St+(xe>>>0<Dt>>>0?1:0),ke=M.low=ke+lt,M.high=Ae+at+(ke>>>0<lt>>>0?1:0),ee=P.low=ee+Gt,P.high=H+Vt+(ee>>>0<Gt>>>0?1:0),ye=j.low=ye+Ht,j.high=ae+Pt+(ye>>>0<Ht>>>0?1:0)},_doFinalize:function(){var C=this._data,x=C.words,w=this._nDataBytes*8,S=C.sigBytes*8;x[S>>>5]|=128<<24-S%32,x[(S+128>>>10<<5)+30]=Math.floor(w/4294967296),x[(S+128>>>10<<5)+31]=w,C.sigBytes=x.length*4,this._process();var A=this._hash.toX32();return A},clone:function(){var C=o.clone.call(this);return C._hash=this._hash.clone(),C},blockSize:1024/32});r.SHA512=o._createHelper(y),r.HmacSHA512=o._createHmacHelper(y)}(),t.SHA512})}(a0)),a0.exports}var c0={exports:{}},nF=c0.exports,YI;function rF(){return YI||(YI=1,function(n,e){(function(t,r,i){n.exports=r(En(),Fp(),AE())})(nF,function(t){return function(){var r=t,i=r.x64,o=i.Word,a=i.WordArray,s=r.algo,l=s.SHA512,f=s.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var h=l._doFinalize.call(this);return h.sigBytes-=16,h}});r.SHA384=l._createHelper(f),r.HmacSHA384=l._createHmacHelper(f)}(),t.SHA384})}(c0)),c0.exports}var l0={exports:{}},iF=l0.exports,QI;function oF(){return QI||(QI=1,function(n,e){(function(t,r,i){n.exports=r(En(),Fp())})(iF,function(t){return function(r){var i=t,o=i.lib,a=o.WordArray,s=o.Hasher,l=i.x64,f=l.Word,h=i.algo,m=[],g=[],y=[];(function(){for(var w=1,S=0,A=0;A<24;A++){m[w+5*S]=(A+1)*(A+2)/2%64;var E=S%5,_=(2*w+3*S)%5;w=E,S=_}for(var w=0;w<5;w++)for(var S=0;S<5;S++)g[w+5*S]=S+(2*w+3*S)%5*5;for(var T=1,M=0;M<24;M++){for(var P=0,j=0,X=0;X<7;X++){if(T&1){var L=(1<<X)-1;L<32?j^=1<<L:P^=1<<L-32}T&128?T=T<<1^113:T<<=1}y[M]=f.create(P,j)}})();var C=[];(function(){for(var w=0;w<25;w++)C[w]=f.create()})();var x=h.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var w=this._state=[],S=0;S<25;S++)w[S]=new f.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(w,S){for(var A=this._state,E=this.blockSize/2,_=0;_<E;_++){var T=w[S+2*_],M=w[S+2*_+1];T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,M=(M<<8|M>>>24)&16711935|(M<<24|M>>>8)&4278255360;var P=A[_];P.high^=M,P.low^=T}for(var j=0;j<24;j++){for(var X=0;X<5;X++){for(var L=0,G=0,Z=0;Z<5;Z++){var P=A[X+5*Z];L^=P.high,G^=P.low}var ne=C[X];ne.high=L,ne.low=G}for(var X=0;X<5;X++)for(var pe=C[(X+4)%5],ve=C[(X+1)%5],Se=ve.high,Ne=ve.low,L=pe.high^(Se<<1|Ne>>>31),G=pe.low^(Ne<<1|Se>>>31),Z=0;Z<5;Z++){var P=A[X+5*Z];P.high^=L,P.low^=G}for(var xe=1;xe<25;xe++){var L,G,P=A[xe],Ae=P.high,ke=P.low,H=m[xe];H<32?(L=Ae<<H|ke>>>32-H,G=ke<<H|Ae>>>32-H):(L=ke<<H-32|Ae>>>64-H,G=Ae<<H-32|ke>>>64-H);var ee=C[g[xe]];ee.high=L,ee.low=G}var ae=C[0],ye=A[0];ae.high=ye.high,ae.low=ye.low;for(var X=0;X<5;X++)for(var Z=0;Z<5;Z++){var xe=X+5*Z,P=A[xe],Ee=C[xe],_e=C[(X+1)%5+5*Z],Je=C[(X+2)%5+5*Z];P.high=Ee.high^~_e.high&Je.high,P.low=Ee.low^~_e.low&Je.low}var P=A[0],me=y[j];P.high^=me.high,P.low^=me.low}},_doFinalize:function(){var w=this._data,S=w.words;this._nDataBytes*8;var A=w.sigBytes*8,E=this.blockSize*32;S[A>>>5]|=1<<24-A%32,S[(r.ceil((A+1)/E)*E>>>5)-1]|=128,w.sigBytes=S.length*4,this._process();for(var _=this._state,T=this.cfg.outputLength/8,M=T/8,P=[],j=0;j<M;j++){var X=_[j],L=X.high,G=X.low;L=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,G=(G<<8|G>>>24)&16711935|(G<<24|G>>>8)&4278255360,P.push(G),P.push(L)}return new a.init(P,T)},clone:function(){for(var w=s.clone.call(this),S=w._state=this._state.slice(0),A=0;A<25;A++)S[A]=S[A].clone();return w}});i.SHA3=s._createHelper(x),i.HmacSHA3=s._createHmacHelper(x)}(Math),t.SHA3})}(l0)),l0.exports}var u0={exports:{}},sF=u0.exports,JI;function aF(){return JI||(JI=1,function(n,e){(function(t,r){n.exports=r(En())})(sF,function(t){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var i=t,o=i.lib,a=o.WordArray,s=o.Hasher,l=i.algo,f=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),h=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),m=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),g=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),y=a.create([0,1518500249,1859775393,2400959708,2840853838]),C=a.create([1352829926,1548603684,1836072691,2053994217,0]),x=l.RIPEMD160=s.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(M,P){for(var j=0;j<16;j++){var X=P+j,L=M[X];M[X]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360}var G=this._hash.words,Z=y.words,ne=C.words,pe=f.words,ve=h.words,Se=m.words,Ne=g.words,xe,Ae,ke,H,ee,ae,ye,Ee,_e,Je;ae=xe=G[0],ye=Ae=G[1],Ee=ke=G[2],_e=H=G[3],Je=ee=G[4];for(var me,j=0;j<80;j+=1)me=xe+M[P+pe[j]]|0,j<16?me+=w(Ae,ke,H)+Z[0]:j<32?me+=S(Ae,ke,H)+Z[1]:j<48?me+=A(Ae,ke,H)+Z[2]:j<64?me+=E(Ae,ke,H)+Z[3]:me+=_(Ae,ke,H)+Z[4],me=me|0,me=T(me,Se[j]),me=me+ee|0,xe=ee,ee=H,H=T(ke,10),ke=Ae,Ae=me,me=ae+M[P+ve[j]]|0,j<16?me+=_(ye,Ee,_e)+ne[0]:j<32?me+=E(ye,Ee,_e)+ne[1]:j<48?me+=A(ye,Ee,_e)+ne[2]:j<64?me+=S(ye,Ee,_e)+ne[3]:me+=w(ye,Ee,_e)+ne[4],me=me|0,me=T(me,Ne[j]),me=me+Je|0,ae=Je,Je=_e,_e=T(Ee,10),Ee=ye,ye=me;me=G[1]+ke+_e|0,G[1]=G[2]+H+Je|0,G[2]=G[3]+ee+ae|0,G[3]=G[4]+xe+ye|0,G[4]=G[0]+Ae+Ee|0,G[0]=me},_doFinalize:function(){var M=this._data,P=M.words,j=this._nDataBytes*8,X=M.sigBytes*8;P[X>>>5]|=128<<24-X%32,P[(X+64>>>9<<4)+14]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,M.sigBytes=(P.length+1)*4,this._process();for(var L=this._hash,G=L.words,Z=0;Z<5;Z++){var ne=G[Z];G[Z]=(ne<<8|ne>>>24)&16711935|(ne<<24|ne>>>8)&4278255360}return L},clone:function(){var M=s.clone.call(this);return M._hash=this._hash.clone(),M}});function w(M,P,j){return M^P^j}function S(M,P,j){return M&P|~M&j}function A(M,P,j){return(M|~P)^j}function E(M,P,j){return M&j|P&~j}function _(M,P,j){return M^(P|~j)}function T(M,P){return M<<P|M>>>32-P}i.RIPEMD160=s._createHelper(x),i.HmacRIPEMD160=s._createHmacHelper(x)}(),t.RIPEMD160})}(u0)),u0.exports}var d0={exports:{}},cF=d0.exports,ew;function AC(){return ew||(ew=1,function(n,e){(function(t,r){n.exports=r(En())})(cF,function(t){(function(){var r=t,i=r.lib,o=i.Base,a=r.enc,s=a.Utf8,l=r.algo;l.HMAC=o.extend({init:function(f,h){f=this._hasher=new f.init,typeof h=="string"&&(h=s.parse(h));var m=f.blockSize,g=m*4;h.sigBytes>g&&(h=f.finalize(h)),h.clamp();for(var y=this._oKey=h.clone(),C=this._iKey=h.clone(),x=y.words,w=C.words,S=0;S<m;S++)x[S]^=1549556828,w[S]^=909522486;y.sigBytes=C.sigBytes=g,this.reset()},reset:function(){var f=this._hasher;f.reset(),f.update(this._iKey)},update:function(f){return this._hasher.update(f),this},finalize:function(f){var h=this._hasher,m=h.finalize(f);h.reset();var g=h.finalize(this._oKey.clone().concat(m));return g}})})()})}(d0)),d0.exports}var f0={exports:{}},lF=f0.exports,tw;function uF(){return tw||(tw=1,function(n,e){(function(t,r,i){n.exports=r(En(),SC(),AC())})(lF,function(t){return function(){var r=t,i=r.lib,o=i.Base,a=i.WordArray,s=r.algo,l=s.SHA256,f=s.HMAC,h=s.PBKDF2=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(m){this.cfg=this.cfg.extend(m)},compute:function(m,g){for(var y=this.cfg,C=f.create(y.hasher,m),x=a.create(),w=a.create([1]),S=x.words,A=w.words,E=y.keySize,_=y.iterations;S.length<E;){var T=C.update(g).finalize(w);C.reset();for(var M=T.words,P=M.length,j=T,X=1;X<_;X++){j=C.finalize(j),C.reset();for(var L=j.words,G=0;G<P;G++)M[G]^=L[G]}x.concat(T),A[0]++}return x.sigBytes=E*4,x}});r.PBKDF2=function(m,g,y){return h.create(y).compute(m,g)}}(),t.PBKDF2})}(f0)),f0.exports}var h0={exports:{}},dF=h0.exports,nw;function Dc(){return nw||(nw=1,function(n,e){(function(t,r,i){n.exports=r(En(),SE(),AC())})(dF,function(t){return function(){var r=t,i=r.lib,o=i.Base,a=i.WordArray,s=r.algo,l=s.MD5,f=s.EvpKDF=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:1}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,m){for(var g,y=this.cfg,C=y.hasher.create(),x=a.create(),w=x.words,S=y.keySize,A=y.iterations;w.length<S;){g&&C.update(g),g=C.update(h).finalize(m),C.reset();for(var E=1;E<A;E++)g=C.finalize(g),C.reset();x.concat(g)}return x.sigBytes=S*4,x}});r.EvpKDF=function(h,m,g){return f.create(g).compute(h,m)}}(),t.EvpKDF})}(h0)),h0.exports}var p0={exports:{}},fF=p0.exports,rw;function li(){return rw||(rw=1,function(n,e){(function(t,r,i){n.exports=r(En(),Dc())})(fF,function(t){t.lib.Cipher||function(r){var i=t,o=i.lib,a=o.Base,s=o.WordArray,l=o.BufferedBlockAlgorithm,f=i.enc;f.Utf8;var h=f.Base64,m=i.algo,g=m.EvpKDF,y=o.Cipher=l.extend({cfg:a.extend(),createEncryptor:function(L,G){return this.create(this._ENC_XFORM_MODE,L,G)},createDecryptor:function(L,G){return this.create(this._DEC_XFORM_MODE,L,G)},init:function(L,G,Z){this.cfg=this.cfg.extend(Z),this._xformMode=L,this._key=G,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(L){return this._append(L),this._process()},finalize:function(L){L&&this._append(L);var G=this._doFinalize();return G},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function L(G){return typeof G=="string"?X:M}return function(G){return{encrypt:function(Z,ne,pe){return L(ne).encrypt(G,Z,ne,pe)},decrypt:function(Z,ne,pe){return L(ne).decrypt(G,Z,ne,pe)}}}}()});o.StreamCipher=y.extend({_doFinalize:function(){var L=this._process(!0);return L},blockSize:1});var C=i.mode={},x=o.BlockCipherMode=a.extend({createEncryptor:function(L,G){return this.Encryptor.create(L,G)},createDecryptor:function(L,G){return this.Decryptor.create(L,G)},init:function(L,G){this._cipher=L,this._iv=G}}),w=C.CBC=function(){var L=x.extend();L.Encryptor=L.extend({processBlock:function(Z,ne){var pe=this._cipher,ve=pe.blockSize;G.call(this,Z,ne,ve),pe.encryptBlock(Z,ne),this._prevBlock=Z.slice(ne,ne+ve)}}),L.Decryptor=L.extend({processBlock:function(Z,ne){var pe=this._cipher,ve=pe.blockSize,Se=Z.slice(ne,ne+ve);pe.decryptBlock(Z,ne),G.call(this,Z,ne,ve),this._prevBlock=Se}});function G(Z,ne,pe){var ve,Se=this._iv;Se?(ve=Se,this._iv=r):ve=this._prevBlock;for(var Ne=0;Ne<pe;Ne++)Z[ne+Ne]^=ve[Ne]}return L}(),S=i.pad={},A=S.Pkcs7={pad:function(L,G){for(var Z=G*4,ne=Z-L.sigBytes%Z,pe=ne<<24|ne<<16|ne<<8|ne,ve=[],Se=0;Se<ne;Se+=4)ve.push(pe);var Ne=s.create(ve,ne);L.concat(Ne)},unpad:function(L){var G=L.words[L.sigBytes-1>>>2]&255;L.sigBytes-=G}};o.BlockCipher=y.extend({cfg:y.cfg.extend({mode:w,padding:A}),reset:function(){var L;y.reset.call(this);var G=this.cfg,Z=G.iv,ne=G.mode;this._xformMode==this._ENC_XFORM_MODE?L=ne.createEncryptor:(L=ne.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==L?this._mode.init(this,Z&&Z.words):(this._mode=L.call(ne,this,Z&&Z.words),this._mode.__creator=L)},_doProcessBlock:function(L,G){this._mode.processBlock(L,G)},_doFinalize:function(){var L,G=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(G.pad(this._data,this.blockSize),L=this._process(!0)):(L=this._process(!0),G.unpad(L)),L},blockSize:128/32});var E=o.CipherParams=a.extend({init:function(L){this.mixIn(L)},toString:function(L){return(L||this.formatter).stringify(this)}}),_=i.format={},T=_.OpenSSL={stringify:function(L){var G,Z=L.ciphertext,ne=L.salt;return ne?G=s.create([1398893684,1701076831]).concat(ne).concat(Z):G=Z,G.toString(h)},parse:function(L){var G,Z=h.parse(L),ne=Z.words;return ne[0]==1398893684&&ne[1]==1701076831&&(G=s.create(ne.slice(2,4)),ne.splice(0,4),Z.sigBytes-=16),E.create({ciphertext:Z,salt:G})}},M=o.SerializableCipher=a.extend({cfg:a.extend({format:T}),encrypt:function(L,G,Z,ne){ne=this.cfg.extend(ne);var pe=L.createEncryptor(Z,ne),ve=pe.finalize(G),Se=pe.cfg;return E.create({ciphertext:ve,key:Z,iv:Se.iv,algorithm:L,mode:Se.mode,padding:Se.padding,blockSize:L.blockSize,formatter:ne.format})},decrypt:function(L,G,Z,ne){ne=this.cfg.extend(ne),G=this._parse(G,ne.format);var pe=L.createDecryptor(Z,ne).finalize(G.ciphertext);return pe},_parse:function(L,G){return typeof L=="string"?G.parse(L,this):L}}),P=i.kdf={},j=P.OpenSSL={execute:function(L,G,Z,ne,pe){if(ne||(ne=s.random(64/8)),pe)var ve=g.create({keySize:G+Z,hasher:pe}).compute(L,ne);else var ve=g.create({keySize:G+Z}).compute(L,ne);var Se=s.create(ve.words.slice(G),Z*4);return ve.sigBytes=G*4,E.create({key:ve,iv:Se,salt:ne})}},X=o.PasswordBasedCipher=M.extend({cfg:M.cfg.extend({kdf:j}),encrypt:function(L,G,Z,ne){ne=this.cfg.extend(ne);var pe=ne.kdf.execute(Z,L.keySize,L.ivSize,ne.salt,ne.hasher);ne.iv=pe.iv;var ve=M.encrypt.call(this,L,G,pe.key,ne);return ve.mixIn(pe),ve},decrypt:function(L,G,Z,ne){ne=this.cfg.extend(ne),G=this._parse(G,ne.format);var pe=ne.kdf.execute(Z,L.keySize,L.ivSize,G.salt,ne.hasher);ne.iv=pe.iv;var ve=M.decrypt.call(this,L,G,pe.key,ne);return ve}})}()})}(p0)),p0.exports}var g0={exports:{}},hF=g0.exports,iw;function pF(){return iw||(iw=1,function(n,e){(function(t,r,i){n.exports=r(En(),li())})(hF,function(t){return t.mode.CFB=function(){var r=t.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(o,a){var s=this._cipher,l=s.blockSize;i.call(this,o,a,l,s),this._prevBlock=o.slice(a,a+l)}}),r.Decryptor=r.extend({processBlock:function(o,a){var s=this._cipher,l=s.blockSize,f=o.slice(a,a+l);i.call(this,o,a,l,s),this._prevBlock=f}});function i(o,a,s,l){var f,h=this._iv;h?(f=h.slice(0),this._iv=void 0):f=this._prevBlock,l.encryptBlock(f,0);for(var m=0;m<s;m++)o[a+m]^=f[m]}return r}(),t.mode.CFB})}(g0)),g0.exports}var m0={exports:{}},gF=m0.exports,ow;function mF(){return ow||(ow=1,function(n,e){(function(t,r,i){n.exports=r(En(),li())})(gF,function(t){return t.mode.CTR=function(){var r=t.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,a){var s=this._cipher,l=s.blockSize,f=this._iv,h=this._counter;f&&(h=this._counter=f.slice(0),this._iv=void 0);var m=h.slice(0);s.encryptBlock(m,0),h[l-1]=h[l-1]+1|0;for(var g=0;g<l;g++)o[a+g]^=m[g]}});return r.Decryptor=i,r}(),t.mode.CTR})}(m0)),m0.exports}var v0={exports:{}},vF=v0.exports,sw;function yF(){return sw||(sw=1,function(n,e){(function(t,r,i){n.exports=r(En(),li())})(vF,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var r=t.lib.BlockCipherMode.extend();function i(s){if((s>>24&255)===255){var l=s>>16&255,f=s>>8&255,h=s&255;l===255?(l=0,f===255?(f=0,h===255?h=0:++h):++f):++l,s=0,s+=l<<16,s+=f<<8,s+=h}else s+=1<<24;return s}function o(s){return(s[0]=i(s[0]))===0&&(s[1]=i(s[1])),s}var a=r.Encryptor=r.extend({processBlock:function(s,l){var f=this._cipher,h=f.blockSize,m=this._iv,g=this._counter;m&&(g=this._counter=m.slice(0),this._iv=void 0),o(g);var y=g.slice(0);f.encryptBlock(y,0);for(var C=0;C<h;C++)s[l+C]^=y[C]}});return r.Decryptor=a,r}(),t.mode.CTRGladman})}(v0)),v0.exports}var y0={exports:{}},CF=y0.exports,aw;function xF(){return aw||(aw=1,function(n,e){(function(t,r,i){n.exports=r(En(),li())})(CF,function(t){return t.mode.OFB=function(){var r=t.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,a){var s=this._cipher,l=s.blockSize,f=this._iv,h=this._keystream;f&&(h=this._keystream=f.slice(0),this._iv=void 0),s.encryptBlock(h,0);for(var m=0;m<l;m++)o[a+m]^=h[m]}});return r.Decryptor=i,r}(),t.mode.OFB})}(y0)),y0.exports}var C0={exports:{}},bF=C0.exports,cw;function IF(){return cw||(cw=1,function(n,e){(function(t,r,i){n.exports=r(En(),li())})(bF,function(t){return t.mode.ECB=function(){var r=t.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(i,o){this._cipher.encryptBlock(i,o)}}),r.Decryptor=r.extend({processBlock:function(i,o){this._cipher.decryptBlock(i,o)}}),r}(),t.mode.ECB})}(C0)),C0.exports}var x0={exports:{}},wF=x0.exports,lw;function SF(){return lw||(lw=1,function(n,e){(function(t,r,i){n.exports=r(En(),li())})(wF,function(t){return t.pad.AnsiX923={pad:function(r,i){var o=r.sigBytes,a=i*4,s=a-o%a,l=o+s-1;r.clamp(),r.words[l>>>2]|=s<<24-l%4*8,r.sigBytes+=s},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},t.pad.Ansix923})}(x0)),x0.exports}var b0={exports:{}},AF=b0.exports,uw;function kF(){return uw||(uw=1,function(n,e){(function(t,r,i){n.exports=r(En(),li())})(AF,function(t){return t.pad.Iso10126={pad:function(r,i){var o=i*4,a=o-r.sigBytes%o;r.concat(t.lib.WordArray.random(a-1)).concat(t.lib.WordArray.create([a<<24],1))},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},t.pad.Iso10126})}(b0)),b0.exports}var I0={exports:{}},EF=I0.exports,dw;function TF(){return dw||(dw=1,function(n,e){(function(t,r,i){n.exports=r(En(),li())})(EF,function(t){return t.pad.Iso97971={pad:function(r,i){r.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(r,i)},unpad:function(r){t.pad.ZeroPadding.unpad(r),r.sigBytes--}},t.pad.Iso97971})}(I0)),I0.exports}var w0={exports:{}},_F=w0.exports,fw;function RF(){return fw||(fw=1,function(n,e){(function(t,r,i){n.exports=r(En(),li())})(_F,function(t){return t.pad.ZeroPadding={pad:function(r,i){var o=i*4;r.clamp(),r.sigBytes+=o-(r.sigBytes%o||o)},unpad:function(r){for(var i=r.words,o=r.sigBytes-1,o=r.sigBytes-1;o>=0;o--)if(i[o>>>2]>>>24-o%4*8&255){r.sigBytes=o+1;break}}},t.pad.ZeroPadding})}(w0)),w0.exports}var S0={exports:{}},PF=S0.exports,hw;function DF(){return hw||(hw=1,function(n,e){(function(t,r,i){n.exports=r(En(),li())})(PF,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(S0)),S0.exports}var A0={exports:{}},MF=A0.exports,pw;function NF(){return pw||(pw=1,function(n,e){(function(t,r,i){n.exports=r(En(),li())})(MF,function(t){return function(r){var i=t,o=i.lib,a=o.CipherParams,s=i.enc,l=s.Hex,f=i.format;f.Hex={stringify:function(h){return h.ciphertext.toString(l)},parse:function(h){var m=l.parse(h);return a.create({ciphertext:m})}}}(),t.format.Hex})}(A0)),A0.exports}var k0={exports:{}},BF=k0.exports,gw;function OF(){return gw||(gw=1,function(n,e){(function(t,r,i){n.exports=r(En(),Rl(),Pl(),Dc(),li())})(BF,function(t){return function(){var r=t,i=r.lib,o=i.BlockCipher,a=r.algo,s=[],l=[],f=[],h=[],m=[],g=[],y=[],C=[],x=[],w=[];(function(){for(var E=[],_=0;_<256;_++)_<128?E[_]=_<<1:E[_]=_<<1^283;for(var T=0,M=0,_=0;_<256;_++){var P=M^M<<1^M<<2^M<<3^M<<4;P=P>>>8^P&255^99,s[T]=P,l[P]=T;var j=E[T],X=E[j],L=E[X],G=E[P]*257^P*16843008;f[T]=G<<24|G>>>8,h[T]=G<<16|G>>>16,m[T]=G<<8|G>>>24,g[T]=G;var G=L*16843009^X*65537^j*257^T*16843008;y[P]=G<<24|G>>>8,C[P]=G<<16|G>>>16,x[P]=G<<8|G>>>24,w[P]=G,T?(T=j^E[E[E[L^j]]],M^=E[E[M]]):T=M=1}})();var S=[0,1,2,4,8,16,32,64,128,27,54],A=a.AES=o.extend({_doReset:function(){var E;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var _=this._keyPriorReset=this._key,T=_.words,M=_.sigBytes/4,P=this._nRounds=M+6,j=(P+1)*4,X=this._keySchedule=[],L=0;L<j;L++)L<M?X[L]=T[L]:(E=X[L-1],L%M?M>6&&L%M==4&&(E=s[E>>>24]<<24|s[E>>>16&255]<<16|s[E>>>8&255]<<8|s[E&255]):(E=E<<8|E>>>24,E=s[E>>>24]<<24|s[E>>>16&255]<<16|s[E>>>8&255]<<8|s[E&255],E^=S[L/M|0]<<24),X[L]=X[L-M]^E);for(var G=this._invKeySchedule=[],Z=0;Z<j;Z++){var L=j-Z;if(Z%4)var E=X[L];else var E=X[L-4];Z<4||L<=4?G[Z]=E:G[Z]=y[s[E>>>24]]^C[s[E>>>16&255]]^x[s[E>>>8&255]]^w[s[E&255]]}}},encryptBlock:function(E,_){this._doCryptBlock(E,_,this._keySchedule,f,h,m,g,s)},decryptBlock:function(E,_){var T=E[_+1];E[_+1]=E[_+3],E[_+3]=T,this._doCryptBlock(E,_,this._invKeySchedule,y,C,x,w,l);var T=E[_+1];E[_+1]=E[_+3],E[_+3]=T},_doCryptBlock:function(E,_,T,M,P,j,X,L){for(var G=this._nRounds,Z=E[_]^T[0],ne=E[_+1]^T[1],pe=E[_+2]^T[2],ve=E[_+3]^T[3],Se=4,Ne=1;Ne<G;Ne++){var xe=M[Z>>>24]^P[ne>>>16&255]^j[pe>>>8&255]^X[ve&255]^T[Se++],Ae=M[ne>>>24]^P[pe>>>16&255]^j[ve>>>8&255]^X[Z&255]^T[Se++],ke=M[pe>>>24]^P[ve>>>16&255]^j[Z>>>8&255]^X[ne&255]^T[Se++],H=M[ve>>>24]^P[Z>>>16&255]^j[ne>>>8&255]^X[pe&255]^T[Se++];Z=xe,ne=Ae,pe=ke,ve=H}var xe=(L[Z>>>24]<<24|L[ne>>>16&255]<<16|L[pe>>>8&255]<<8|L[ve&255])^T[Se++],Ae=(L[ne>>>24]<<24|L[pe>>>16&255]<<16|L[ve>>>8&255]<<8|L[Z&255])^T[Se++],ke=(L[pe>>>24]<<24|L[ve>>>16&255]<<16|L[Z>>>8&255]<<8|L[ne&255])^T[Se++],H=(L[ve>>>24]<<24|L[Z>>>16&255]<<16|L[ne>>>8&255]<<8|L[pe&255])^T[Se++];E[_]=xe,E[_+1]=Ae,E[_+2]=ke,E[_+3]=H},keySize:256/32});r.AES=o._createHelper(A)}(),t.AES})}(k0)),k0.exports}var E0={exports:{}},FF=E0.exports,mw;function LF(){return mw||(mw=1,function(n,e){(function(t,r,i){n.exports=r(En(),Rl(),Pl(),Dc(),li())})(FF,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,a=i.BlockCipher,s=r.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],f=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],m=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],g=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],y=s.DES=a.extend({_doReset:function(){for(var S=this._key,A=S.words,E=[],_=0;_<56;_++){var T=l[_]-1;E[_]=A[T>>>5]>>>31-T%32&1}for(var M=this._subKeys=[],P=0;P<16;P++){for(var j=M[P]=[],X=h[P],_=0;_<24;_++)j[_/6|0]|=E[(f[_]-1+X)%28]<<31-_%6,j[4+(_/6|0)]|=E[28+(f[_+24]-1+X)%28]<<31-_%6;j[0]=j[0]<<1|j[0]>>>31;for(var _=1;_<7;_++)j[_]=j[_]>>>(_-1)*4+3;j[7]=j[7]<<5|j[7]>>>27}for(var L=this._invSubKeys=[],_=0;_<16;_++)L[_]=M[15-_]},encryptBlock:function(S,A){this._doCryptBlock(S,A,this._subKeys)},decryptBlock:function(S,A){this._doCryptBlock(S,A,this._invSubKeys)},_doCryptBlock:function(S,A,E){this._lBlock=S[A],this._rBlock=S[A+1],C.call(this,4,252645135),C.call(this,16,65535),x.call(this,2,858993459),x.call(this,8,16711935),C.call(this,1,1431655765);for(var _=0;_<16;_++){for(var T=E[_],M=this._lBlock,P=this._rBlock,j=0,X=0;X<8;X++)j|=m[X][((P^T[X])&g[X])>>>0];this._lBlock=P,this._rBlock=M^j}var L=this._lBlock;this._lBlock=this._rBlock,this._rBlock=L,C.call(this,1,1431655765),x.call(this,8,16711935),x.call(this,2,858993459),C.call(this,16,65535),C.call(this,4,252645135),S[A]=this._lBlock,S[A+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function C(S,A){var E=(this._lBlock>>>S^this._rBlock)&A;this._rBlock^=E,this._lBlock^=E<<S}function x(S,A){var E=(this._rBlock>>>S^this._lBlock)&A;this._lBlock^=E,this._rBlock^=E<<S}r.DES=a._createHelper(y);var w=s.TripleDES=a.extend({_doReset:function(){var S=this._key,A=S.words;if(A.length!==2&&A.length!==4&&A.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var E=A.slice(0,2),_=A.length<4?A.slice(0,2):A.slice(2,4),T=A.length<6?A.slice(0,2):A.slice(4,6);this._des1=y.createEncryptor(o.create(E)),this._des2=y.createEncryptor(o.create(_)),this._des3=y.createEncryptor(o.create(T))},encryptBlock:function(S,A){this._des1.encryptBlock(S,A),this._des2.decryptBlock(S,A),this._des3.encryptBlock(S,A)},decryptBlock:function(S,A){this._des3.decryptBlock(S,A),this._des2.encryptBlock(S,A),this._des1.decryptBlock(S,A)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=a._createHelper(w)}(),t.TripleDES})}(E0)),E0.exports}var T0={exports:{}},UF=T0.exports,vw;function jF(){return vw||(vw=1,function(n,e){(function(t,r,i){n.exports=r(En(),Rl(),Pl(),Dc(),li())})(UF,function(t){return function(){var r=t,i=r.lib,o=i.StreamCipher,a=r.algo,s=a.RC4=o.extend({_doReset:function(){for(var h=this._key,m=h.words,g=h.sigBytes,y=this._S=[],C=0;C<256;C++)y[C]=C;for(var C=0,x=0;C<256;C++){var w=C%g,S=m[w>>>2]>>>24-w%4*8&255;x=(x+y[C]+S)%256;var A=y[C];y[C]=y[x],y[x]=A}this._i=this._j=0},_doProcessBlock:function(h,m){h[m]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var h=this._S,m=this._i,g=this._j,y=0,C=0;C<4;C++){m=(m+1)%256,g=(g+h[m])%256;var x=h[m];h[m]=h[g],h[g]=x,y|=h[(h[m]+h[g])%256]<<24-C*8}return this._i=m,this._j=g,y}r.RC4=o._createHelper(s);var f=a.RC4Drop=s.extend({cfg:s.cfg.extend({drop:192}),_doReset:function(){s._doReset.call(this);for(var h=this.cfg.drop;h>0;h--)l.call(this)}});r.RC4Drop=o._createHelper(f)}(),t.RC4})}(T0)),T0.exports}var _0={exports:{}},GF=_0.exports,yw;function VF(){return yw||(yw=1,function(n,e){(function(t,r,i){n.exports=r(En(),Rl(),Pl(),Dc(),li())})(GF,function(t){return function(){var r=t,i=r.lib,o=i.StreamCipher,a=r.algo,s=[],l=[],f=[],h=a.Rabbit=o.extend({_doReset:function(){for(var g=this._key.words,y=this.cfg.iv,C=0;C<4;C++)g[C]=(g[C]<<8|g[C]>>>24)&16711935|(g[C]<<24|g[C]>>>8)&4278255360;var x=this._X=[g[0],g[3]<<16|g[2]>>>16,g[1],g[0]<<16|g[3]>>>16,g[2],g[1]<<16|g[0]>>>16,g[3],g[2]<<16|g[1]>>>16],w=this._C=[g[2]<<16|g[2]>>>16,g[0]&4294901760|g[1]&65535,g[3]<<16|g[3]>>>16,g[1]&4294901760|g[2]&65535,g[0]<<16|g[0]>>>16,g[2]&4294901760|g[3]&65535,g[1]<<16|g[1]>>>16,g[3]&4294901760|g[0]&65535];this._b=0;for(var C=0;C<4;C++)m.call(this);for(var C=0;C<8;C++)w[C]^=x[C+4&7];if(y){var S=y.words,A=S[0],E=S[1],_=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,T=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,M=_>>>16|T&4294901760,P=T<<16|_&65535;w[0]^=_,w[1]^=M,w[2]^=T,w[3]^=P,w[4]^=_,w[5]^=M,w[6]^=T,w[7]^=P;for(var C=0;C<4;C++)m.call(this)}},_doProcessBlock:function(g,y){var C=this._X;m.call(this),s[0]=C[0]^C[5]>>>16^C[3]<<16,s[1]=C[2]^C[7]>>>16^C[5]<<16,s[2]=C[4]^C[1]>>>16^C[7]<<16,s[3]=C[6]^C[3]>>>16^C[1]<<16;for(var x=0;x<4;x++)s[x]=(s[x]<<8|s[x]>>>24)&16711935|(s[x]<<24|s[x]>>>8)&4278255360,g[y+x]^=s[x]},blockSize:128/32,ivSize:64/32});function m(){for(var g=this._X,y=this._C,C=0;C<8;C++)l[C]=y[C];y[0]=y[0]+1295307597+this._b|0,y[1]=y[1]+3545052371+(y[0]>>>0<l[0]>>>0?1:0)|0,y[2]=y[2]+886263092+(y[1]>>>0<l[1]>>>0?1:0)|0,y[3]=y[3]+1295307597+(y[2]>>>0<l[2]>>>0?1:0)|0,y[4]=y[4]+3545052371+(y[3]>>>0<l[3]>>>0?1:0)|0,y[5]=y[5]+886263092+(y[4]>>>0<l[4]>>>0?1:0)|0,y[6]=y[6]+1295307597+(y[5]>>>0<l[5]>>>0?1:0)|0,y[7]=y[7]+3545052371+(y[6]>>>0<l[6]>>>0?1:0)|0,this._b=y[7]>>>0<l[7]>>>0?1:0;for(var C=0;C<8;C++){var x=g[C]+y[C],w=x&65535,S=x>>>16,A=((w*w>>>17)+w*S>>>15)+S*S,E=((x&4294901760)*x|0)+((x&65535)*x|0);f[C]=A^E}g[0]=f[0]+(f[7]<<16|f[7]>>>16)+(f[6]<<16|f[6]>>>16)|0,g[1]=f[1]+(f[0]<<8|f[0]>>>24)+f[7]|0,g[2]=f[2]+(f[1]<<16|f[1]>>>16)+(f[0]<<16|f[0]>>>16)|0,g[3]=f[3]+(f[2]<<8|f[2]>>>24)+f[1]|0,g[4]=f[4]+(f[3]<<16|f[3]>>>16)+(f[2]<<16|f[2]>>>16)|0,g[5]=f[5]+(f[4]<<8|f[4]>>>24)+f[3]|0,g[6]=f[6]+(f[5]<<16|f[5]>>>16)+(f[4]<<16|f[4]>>>16)|0,g[7]=f[7]+(f[6]<<8|f[6]>>>24)+f[5]|0}r.Rabbit=o._createHelper(h)}(),t.Rabbit})}(_0)),_0.exports}var R0={exports:{}},zF=R0.exports,Cw;function WF(){return Cw||(Cw=1,function(n,e){(function(t,r,i){n.exports=r(En(),Rl(),Pl(),Dc(),li())})(zF,function(t){return function(){var r=t,i=r.lib,o=i.StreamCipher,a=r.algo,s=[],l=[],f=[],h=a.RabbitLegacy=o.extend({_doReset:function(){var g=this._key.words,y=this.cfg.iv,C=this._X=[g[0],g[3]<<16|g[2]>>>16,g[1],g[0]<<16|g[3]>>>16,g[2],g[1]<<16|g[0]>>>16,g[3],g[2]<<16|g[1]>>>16],x=this._C=[g[2]<<16|g[2]>>>16,g[0]&4294901760|g[1]&65535,g[3]<<16|g[3]>>>16,g[1]&4294901760|g[2]&65535,g[0]<<16|g[0]>>>16,g[2]&4294901760|g[3]&65535,g[1]<<16|g[1]>>>16,g[3]&4294901760|g[0]&65535];this._b=0;for(var w=0;w<4;w++)m.call(this);for(var w=0;w<8;w++)x[w]^=C[w+4&7];if(y){var S=y.words,A=S[0],E=S[1],_=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,T=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,M=_>>>16|T&4294901760,P=T<<16|_&65535;x[0]^=_,x[1]^=M,x[2]^=T,x[3]^=P,x[4]^=_,x[5]^=M,x[6]^=T,x[7]^=P;for(var w=0;w<4;w++)m.call(this)}},_doProcessBlock:function(g,y){var C=this._X;m.call(this),s[0]=C[0]^C[5]>>>16^C[3]<<16,s[1]=C[2]^C[7]>>>16^C[5]<<16,s[2]=C[4]^C[1]>>>16^C[7]<<16,s[3]=C[6]^C[3]>>>16^C[1]<<16;for(var x=0;x<4;x++)s[x]=(s[x]<<8|s[x]>>>24)&16711935|(s[x]<<24|s[x]>>>8)&4278255360,g[y+x]^=s[x]},blockSize:128/32,ivSize:64/32});function m(){for(var g=this._X,y=this._C,C=0;C<8;C++)l[C]=y[C];y[0]=y[0]+1295307597+this._b|0,y[1]=y[1]+3545052371+(y[0]>>>0<l[0]>>>0?1:0)|0,y[2]=y[2]+886263092+(y[1]>>>0<l[1]>>>0?1:0)|0,y[3]=y[3]+1295307597+(y[2]>>>0<l[2]>>>0?1:0)|0,y[4]=y[4]+3545052371+(y[3]>>>0<l[3]>>>0?1:0)|0,y[5]=y[5]+886263092+(y[4]>>>0<l[4]>>>0?1:0)|0,y[6]=y[6]+1295307597+(y[5]>>>0<l[5]>>>0?1:0)|0,y[7]=y[7]+3545052371+(y[6]>>>0<l[6]>>>0?1:0)|0,this._b=y[7]>>>0<l[7]>>>0?1:0;for(var C=0;C<8;C++){var x=g[C]+y[C],w=x&65535,S=x>>>16,A=((w*w>>>17)+w*S>>>15)+S*S,E=((x&4294901760)*x|0)+((x&65535)*x|0);f[C]=A^E}g[0]=f[0]+(f[7]<<16|f[7]>>>16)+(f[6]<<16|f[6]>>>16)|0,g[1]=f[1]+(f[0]<<8|f[0]>>>24)+f[7]|0,g[2]=f[2]+(f[1]<<16|f[1]>>>16)+(f[0]<<16|f[0]>>>16)|0,g[3]=f[3]+(f[2]<<8|f[2]>>>24)+f[1]|0,g[4]=f[4]+(f[3]<<16|f[3]>>>16)+(f[2]<<16|f[2]>>>16)|0,g[5]=f[5]+(f[4]<<8|f[4]>>>24)+f[3]|0,g[6]=f[6]+(f[5]<<16|f[5]>>>16)+(f[4]<<16|f[4]>>>16)|0,g[7]=f[7]+(f[6]<<8|f[6]>>>24)+f[5]|0}r.RabbitLegacy=o._createHelper(h)}(),t.RabbitLegacy})}(R0)),R0.exports}var P0={exports:{}},HF=P0.exports,xw;function ZF(){return xw||(xw=1,function(n,e){(function(t,r,i){n.exports=r(En(),Rl(),Pl(),Dc(),li())})(HF,function(t){return function(){var r=t,i=r.lib,o=i.BlockCipher,a=r.algo;const s=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],f=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var h={pbox:[],sbox:[]};function m(w,S){let A=S>>24&255,E=S>>16&255,_=S>>8&255,T=S&255,M=w.sbox[0][A]+w.sbox[1][E];return M=M^w.sbox[2][_],M=M+w.sbox[3][T],M}function g(w,S,A){let E=S,_=A,T;for(let M=0;M<s;++M)E=E^w.pbox[M],_=m(w,E)^_,T=E,E=_,_=T;return T=E,E=_,_=T,_=_^w.pbox[s],E=E^w.pbox[s+1],{left:E,right:_}}function y(w,S,A){let E=S,_=A,T;for(let M=s+1;M>1;--M)E=E^w.pbox[M],_=m(w,E)^_,T=E,E=_,_=T;return T=E,E=_,_=T,_=_^w.pbox[1],E=E^w.pbox[0],{left:E,right:_}}function C(w,S,A){for(let P=0;P<4;P++){w.sbox[P]=[];for(let j=0;j<256;j++)w.sbox[P][j]=f[P][j]}let E=0;for(let P=0;P<s+2;P++)w.pbox[P]=l[P]^S[E],E++,E>=A&&(E=0);let _=0,T=0,M=0;for(let P=0;P<s+2;P+=2)M=g(w,_,T),_=M.left,T=M.right,w.pbox[P]=_,w.pbox[P+1]=T;for(let P=0;P<4;P++)for(let j=0;j<256;j+=2)M=g(w,_,T),_=M.left,T=M.right,w.sbox[P][j]=_,w.sbox[P][j+1]=T;return!0}var x=a.Blowfish=o.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var w=this._keyPriorReset=this._key,S=w.words,A=w.sigBytes/4;C(h,S,A)}},encryptBlock:function(w,S){var A=g(h,w[S],w[S+1]);w[S]=A.left,w[S+1]=A.right},decryptBlock:function(w,S){var A=y(h,w[S],w[S+1]);w[S]=A.left,w[S+1]=A.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=o._createHelper(x)}(),t.Blowfish})}(P0)),P0.exports}var XF=qh.exports,bw;function $F(){return bw||(bw=1,function(n,e){(function(t,r,i){n.exports=r(En(),Fp(),WO(),ZO(),Rl(),KO(),Pl(),SE(),SC(),eF(),AE(),rF(),oF(),aF(),AC(),uF(),Dc(),li(),pF(),mF(),yF(),xF(),IF(),SF(),kF(),TF(),RF(),DF(),NF(),OF(),LF(),jF(),VF(),WF(),ZF())})(XF,function(t){return t})}(qh)),qh.exports}var KF=$F();const Iw=Ec(KF),qF=(n,e)=>e.some(t=>n instanceof t);let ww,Sw;function YF(){return ww||(ww=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function QF(){return Sw||(Sw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kE=new WeakMap,ey=new WeakMap,EE=new WeakMap,Bm=new WeakMap,kC=new WeakMap;function JF(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(bc(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&kE.set(t,n)}).catch(()=>{}),kC.set(e,n),e}function e8(n){if(ey.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});ey.set(n,e)}let ty={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ey.get(n);if(e==="objectStoreNames")return n.objectStoreNames||EE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bc(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function t8(n){ty=n(ty)}function n8(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Om(this),e,...t);return EE.set(r,e.sort?e.sort():[e]),bc(r)}:QF().includes(n)?function(...e){return n.apply(Om(this),e),bc(kE.get(this))}:function(...e){return bc(n.apply(Om(this),e))}}function r8(n){return typeof n=="function"?n8(n):(n instanceof IDBTransaction&&e8(n),qF(n,YF())?new Proxy(n,ty):n)}function bc(n){if(n instanceof IDBRequest)return JF(n);if(Bm.has(n))return Bm.get(n);const e=r8(n);return e!==n&&(Bm.set(n,e),kC.set(e,n)),e}const Om=n=>kC.get(n);function i8(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(n,e),s=bc(a);return r&&a.addEventListener("upgradeneeded",l=>{r(bc(a.result),l.oldVersion,l.newVersion,bc(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),s.then(l=>{o&&l.addEventListener("close",()=>o()),i&&l.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),s}const o8=["get","getKey","getAll","getAllKeys","count"],s8=["put","add","delete","clear"],Fm=new Map;function Aw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Fm.get(e))return Fm.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=s8.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||o8.includes(t)))return;const o=async function(a,...s){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return r&&(f=f.index(s.shift())),(await Promise.all([f[t](...s),i&&l.done]))[0]};return Fm.set(e,o),o}t8(n=>({...n,get:(e,t,r)=>Aw(e,t)||n.get(e,t,r),has:(e,t)=>!!Aw(e,t)||n.has(e,t)}));class a8{constructor(){oe(this,"db",null);oe(this,"dbName","file-transfer-store");oe(this,"dbVersion",1)}async initialize(){this.db=await i8(this.dbName,this.dbVersion,{upgrade(e){e.objectStoreNames.contains("chunks")||e.createObjectStore("chunks",{keyPath:["hash","index"]}).createIndex("hash","hash",{unique:!1}),e.objectStoreNames.contains("metadata")||e.createObjectStore("metadata",{keyPath:"hash"}).createIndex("direction","direction",{unique:!1})}})}async saveChunk(e){this.db||await this.initialize(),await this.db.put("chunks",e);const t=await this.getFileMetadata(e.hash);t&&(t.receivedChunks.includes(e.index)||(t.receivedChunks.push(e.index),t.lastActivityTimestamp=Date.now(),await this.updateFileMetadata(t)))}async getChunk(e,t){return this.db||await this.initialize(),this.db.get("chunks",[e,t])}async getAllChunks(e){return this.db||await this.initialize(),this.db.getAllFromIndex("chunks","hash",e)}async saveFileMetadata(e){this.db||await this.initialize(),await this.db.put("metadata",e)}async updateFileMetadata(e){this.db||await this.initialize(),await this.db.put("metadata",e)}async getFileMetadata(e){return this.db||await this.initialize(),this.db.get("metadata",e)}async getAllFileMetadata(){return this.db||await this.initialize(),this.db.getAll("metadata")}async getIncompleteTransfers(e){return this.db||await this.initialize(),(await this.db.getAllFromIndex("metadata","direction",e)).filter(r=>r.receivedChunks.length<r.totalChunks)}async deleteFile(e){this.db||await this.initialize();const t=this.db.transaction(["chunks","metadata"],"readwrite"),r=await t.objectStore("chunks").getAllFromIndex("hash",e);for(const i of r)await t.objectStore("chunks").delete([e,i.index]);await t.objectStore("metadata").delete(e),await t.done}async clearAll(){this.db||await this.initialize();const e=this.db.transaction(["chunks","metadata"],"readwrite");await e.objectStore("chunks").clear(),await e.objectStore("metadata").clear(),await e.done}async close(){this.db&&(this.db.close(),this.db=null)}async reconstructFile(e){const t=await this.getFileMetadata(e);if(!t)return null;const r=await this.getAllChunks(e);return r.length!==t.totalChunks?null:(r.sort((i,o)=>i.index-o.index),new Blob(r.map(i=>i.data),{type:t.mimeType||"application/octet-stream"}))}async isTransferComplete(e){const t=await this.getFileMetadata(e);return t?t.receivedChunks.length===t.totalChunks:!1}}class Ho extends Error{constructor(e,t){super(t),this.code=e,this.name="FileTransferError"}}const js={CONNECTION_FAILED:"CONNECTION_FAILED",TRANSFER_TIMEOUT:"TRANSFER_TIMEOUT",INVALID_FILE:"INVALID_FILE",DATA_CHANNEL_ERROR:"DATA_CHANNEL_ERROR"};class c8 extends Rp{constructor(t,r){super();oe(this,"webRTCService");oe(this,"client");oe(this,"gmcpFileTransfer");oe(this,"chunkSize",16384);oe(this,"transferTimeoutInterval");oe(this,"incomingTransfers",new Map);oe(this,"outgoingTransfers",new Map);oe(this,"maxFileSize",100*1024*1024);oe(this,"transferTimeout",3e4);oe(this,"pendingOffers",new Map);oe(this,"store");oe(this,"storeInitialized",!1);this.client=t,this.gmcpFileTransfer=r,this.webRTCService=t.webRTCService,this.store=new a8,this.initializeStore(),this.setupListeners()}async initializeStore(){try{await this.store.initialize(),this.storeInitialized=!0,console.log("[FileTransferManager] Store initialized successfully")}catch(t){console.error("[FileTransferManager] Failed to initialize store:",t)}}isDataChannelReady(){return this.webRTCService.isDataChannelOpen()}setupListeners(){this.webRTCService.on("dataChannelMessage",this.handleIncomingChunk.bind(this)),this.client.on("fileTransferAccepted",this.handleAcceptedTransfer.bind(this)),this.transferTimeoutInterval=window.setInterval(()=>this.checkTransferTimeouts(),5e3)}async initializeWebRTC(){this.webRTCService.isDataChannelOpen()||await this.webRTCService.createPeerConnection()}async sendFile(t,r){if(t.size>this.maxFileSize)throw new Ho(js.INVALID_FILE,`File size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);const i=await this.computeFileHash(t);console.log(`[FileTransferManager] Computed hash for ${t.name}: ${i}`),console.log(`[FileTransferManager] Registering outgoing transfer for file: ${t.name}`),this.outgoingTransfers.set(i,{file:t,filename:t.name,hash:i,lastActivityTimestamp:Date.now()});try{await this.initializeWebRTC(),this.webRTCService.recipient=r;const o=await this.webRTCService.createOffer();console.log(`[FileTransferManager] Sending offer for file: ${t.name}`),await this.gmcpFileTransfer.sendOffer(r,t.name,t.size,JSON.stringify(o),i),await this.webRTCService.waitForConnection()}catch(o){console.error(`[FileTransferManager] Failed to send file ${t.name}:`,o),this.handleTransferError(i,t.name,"send",o instanceof Ho?o:new Ho(js.CONNECTION_FAILED,"Failed to establish connection")),this.cleanupTransfer(i)}}async computeFileHash(t){return new Promise((r,i)=>{const o=new FileReader;o.onload=()=>{if(o.result instanceof ArrayBuffer){const a=Iw.lib.WordArray.create(o.result),s=Iw.SHA256(a).toString();r(s)}else i(new Error("Failed to read file for hashing"))},o.onerror=()=>i(o.error),o.readAsArrayBuffer(t)})}async startFileTransfer(t,r){let i=0;const o=new FileReader;for(;i<t.size;){const a=t.slice(i,i+this.chunkSize),s=await new Promise((f,h)=>{o.onload=()=>{o.result instanceof ArrayBuffer?f(o.result):h(new Ho(js.INVALID_FILE,"Failed to read file chunk"))},o.onerror=()=>h(new Ho(js.INVALID_FILE,"Error reading file")),o.readAsArrayBuffer(a)});await this.sendChunk(t.name,r,s,i,t.size),i+=s.byteLength;const l={hash:r,filename:t.name,sentBytes:i,totalBytes:t.size};this.emit("fileSendProgress",l)}}async sendChunk(t,r,i,o,a){try{const s={hash:r,filename:t,chunkIndex:Math.floor(o/this.chunkSize),totalChunks:Math.ceil(a/this.chunkSize),chunkSize:i.byteLength,totalSize:a},l=JSON.stringify(s),f=new TextEncoder().encode(l),h=new ArrayBuffer(4);new DataView(h).setUint32(0,f.byteLength,!0);const m=new Uint8Array(4+f.byteLength+i.byteLength);m.set(new Uint8Array(h),0),m.set(f,4),m.set(new Uint8Array(i),4+f.byteLength),await this.webRTCService.sendData(m.buffer)}catch{throw new Ho(js.DATA_CHANNEL_ERROR,"Failed to send chunk")}}async handleAcceptedTransfer(t){console.log("[FileTransferManager] Handling accepted transfer for file transfer request ",t);const{sender:r,hash:i,filename:o,answerSdp:a}=t,s=this.outgoingTransfers.get(i);if(!s){const l=`No outgoing transfer found for hash: ${i} (${o}). Active transfers: ${Array.from(this.outgoingTransfers.keys()).join(", ")}`;console.error(`[FileTransferManager] ${l}`),this.client.onFileTransferError(i,o,"send",l);return}try{console.log(`[FileTransferManager] Processing WebRTC answer for file: ${o}`);const l=JSON.parse(a);console.log(`[FileTransferManager] Answer object for file: ${o}`,l),await this.webRTCService.handleAnswer(l),console.log(`[FileTransferManager] Waiting for data channel to open for file: ${o}`),await this.waitForDataChannel(i),console.log(`[FileTransferManager] Data channel ready for outgoing transfer of: ${o}`),await this.startFileTransfer(s.file,s.hash),console.log(`[FileTransferManager] File transfer completed successfully: ${o}`),this.client.onFileSendComplete(i,o)}catch(l){console.error(`[FileTransferManager] Error in accepted transfer for ${o}:`,l),this.handleTransferError(i,o,"send",l)}finally{console.log(`[FileTransferManager] Cleaning up successful transfer: ${o} (${i})`),this.outgoingTransfers.delete(i)}}async waitForDataChannel(t){return new Promise((r,i)=>{if(this.isDataChannelReady()){r();return}let o=0;const a=50,s=setInterval(()=>{o++,this.isDataChannelReady()?(clearInterval(s),r()):o>=a&&(clearInterval(s),i(new Ho(js.CONNECTION_FAILED,`Data channel failed to open for transfer ${t} after ${o} attempts`)))},100)})}async handleIncomingChunk(t){let r;try{if(t.byteLength<4)throw new Error("Received data is too short to contain header size");const i=new Uint8Array(t.slice(0,4)),o=new DataView(i.buffer).getUint32(0,!0);if(t.byteLength<4+o)throw new Error("Received data is too short to contain header");const a=new TextDecoder().decode(t.slice(4,4+o)),s=JSON.parse(a);if(r=s.hash,t.byteLength<4+o+s.chunkSize)throw new Error("Received data is too short to contain chunk data");const l=this.pendingOffers.get(s.hash),f=(l==null?void 0:l.sender)||"unknown";if(typeof s.chunkIndex!="number"||s.chunkIndex<0||s.chunkIndex>=s.totalChunks)throw new Error("Invalid chunk index in header");if(typeof s.totalChunks!="number"||s.totalChunks<=0)throw new Error("Invalid total chunks in header");const h=t.slice(4+o,4+o+s.chunkSize);let m=this.incomingTransfers.get(s.hash);if(!m){if(s.totalSize>this.maxFileSize){this.client.onFileTransferError(s.hash,s.filename,"receive",`Incoming file size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);return}m={hash:s.hash,filename:s.filename,totalSize:s.totalSize,receivedSize:0,chunks:new Array(s.totalChunks),lastActivityTimestamp:Date.now(),sender:f},this.incomingTransfers.set(s.hash,m),this.storeInitialized&&await this.store.saveFileMetadata({hash:s.hash,filename:s.filename,totalSize:s.totalSize,totalChunks:s.totalChunks,receivedChunks:[],direction:"incoming",sender:f,lastActivityTimestamp:Date.now()})}m.chunks[s.chunkIndex]=h,m.receivedSize+=h.byteLength,m.lastActivityTimestamp=Date.now(),this.storeInitialized&&await this.store.saveChunk({hash:s.hash,index:s.chunkIndex,data:h});const g={hash:s.hash,filename:s.filename,receivedBytes:m.receivedSize,totalBytes:m.totalSize};if(this.emit("fileReceiveProgress",g),m.receivedSize===m.totalSize)if(m.chunks.every(y=>y)){const y=new Blob(m.chunks),C=new File([y],m.filename,{type:y.type});if(await this.computeFileHash(C)!==m.hash){this.client.onFileTransferError(m.hash,s.filename,"receive","File integrity check failed - hash mismatch"),this.incomingTransfers.delete(m.hash),this.storeInitialized&&await this.store.deleteFile(m.hash);return}const w=window.URL.createObjectURL(y),S=document.createElement("a");S.href=w,S.download=s.filename,document.body.appendChild(S),S.click(),document.body.removeChild(S),window.URL.revokeObjectURL(w);const A={hash:m.hash,filename:s.filename,file:y};this.emit("fileReceiveComplete",A),this.incomingTransfers.delete(m.hash),this.storeInitialized&&await this.store.deleteFile(m.hash)}else this.client.onFileTransferError(m.hash,s.filename,"receive","Missing chunks in received file")}catch(i){const o=r||"unknown";this.handleTransferError(o,"unknown_file","receive",new Ho("UNKNOWN_ERROR",i instanceof Error?i.message:"Unknown error"))}}handleTransferError(t,r,i,o){console.error(`Error ${i}ing file ${r} (${t}):`,o);const a=o instanceof Error?o.message:"Unknown error";this.client.onFileTransferError(t,r,i,a);const s=this.outgoingTransfers.get(t),l=this.incomingTransfers.get(t);this.cleanupTransfer(t),this.attemptRecovery(t,r,i,s,l)}cleanupTransfer(t){console.log(`[FileTransferManager] Starting cleanup for hash: ${t}`);const r=this.outgoingTransfers.get(t);r&&(console.log(`[FileTransferManager] Cleaning up outgoing transfer for: ${r.filename} (${t})`),this.outgoingTransfers.delete(t));const i=this.incomingTransfers.get(t);if(i&&(console.log(`[FileTransferManager] Cleaning up incoming transfer for: ${i.filename} (${t})`),this.incomingTransfers.delete(t)),this.pendingOffers.has(t)){const o=this.pendingOffers.get(t);console.log(`[FileTransferManager] Removing pending offer for: ${o==null?void 0:o.filename} (${t})`),this.pendingOffers.delete(t)}console.log(`[FileTransferManager] Cleanup complete for hash: ${t}`)}async attemptRecovery(t,r,i,o,a){try{await this.webRTCService.createPeerConnection(),this.client.onConnectionRecovered({hash:t,filename:r,direction:i}),i==="send"&&o?(this.outgoingTransfers.set(t,o),await this.startFileTransfer(o.file,o.hash)):i==="receive"&&a&&this.gmcpFileTransfer.sendRequestResend(a.sender,t)}catch(s){console.error("Failed to recover connection:",s),this.client.onRecoveryFailed({filename:r,direction:i,error:s instanceof Error?s.message:"Unknown error"})}}checkTransferTimeouts(){const t=Date.now();this.incomingTransfers.forEach((r,i)=>{t-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"receive",new Ho(js.TRANSFER_TIMEOUT,"Transfer timeout - no data received"))}),this.outgoingTransfers.forEach((r,i)=>{t-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"send",new Ho(js.TRANSFER_TIMEOUT,"Transfer timeout - no activity"))})}cleanup(){this.transferTimeoutInterval&&(clearInterval(this.transferTimeoutInterval),this.transferTimeoutInterval=void 0),[...this.outgoingTransfers.keys()].forEach(t=>this.cancelTransfer(t)),[...this.incomingTransfers.keys()].forEach(t=>this.cancelTransfer(t)),this.incomingTransfers.clear(),this.outgoingTransfers.clear(),this.pendingOffers.clear(),this.webRTCService.cleanup(),this.storeInitialized&&(this.store.close(),this.storeInitialized=!1)}cancelTransfer(t){const r=this.outgoingTransfers.get(t)||this.incomingTransfers.get(t);r?(console.log(`[FileTransferManager] Cancelling transfer for hash: ${t} (${r.filename})`),this.cleanupTransfer(t),this.storeInitialized&&this.store.deleteFile(t).catch(i=>console.error("[FileTransferManager] Failed to delete file from store:",i)),this.client.onFileTransferCancel(this.client.worldData.playerId,t),this.gmcpFileTransfer.sendCancel(this.client.worldData.playerId,t)):console.log(`[FileTransferManager] No active transfer found for hash: ${t}`)}async acceptTransfer(t,r){if(console.log("[FileTransferManager] Accepting transfer",t,r),this.incomingTransfers.has(r))throw new Error("Already receiving this file");const i=this.pendingOffers.get(r);if(console.log("[FileTransferManager] Checking pending offers:",Array.from(this.pendingOffers.entries())),!i)throw new Ho(js.INVALID_FILE,`No pending offer found for transfer with hash: ${r}`);console.log("[FileTransferManager] Found pending offer for transfer:",{sender:t,hash:r,filename:i.filename,filesize:i.filesize});try{await this.initializeWebRTC(),this.webRTCService.recipient=t,console.log("[FileTransferManager] Setting remote description with offer"),await this.webRTCService.handleOffer(JSON.parse(i.offerSdp)),console.log("[FileTransferManager] Creating WebRTC answer");const o=await this.webRTCService.createAnswer();if(console.log("[FileTransferManager] WebRTC answer created successfully"),this.pendingOffers.has(r))await this.gmcpFileTransfer.sendAccept(t,r,i.filename,JSON.stringify(o)),await this.waitForDataChannel(r),console.log("[FileTransferManager] Data channel ready for incoming transfer"),this.pendingOffers.delete(r);else throw new Error("Transfer was cancelled during setup")}catch(o){throw console.error("Failed to accept transfer:",o),this.cleanupTransfer(r),new Ho(js.CONNECTION_FAILED,`Failed to accept transfer: ${o instanceof Error?o.message:"Unknown error"}`)}}}class l8 extends Rp{constructor(t,r){super();oe(this,"ws");oe(this,"decoder",new TextDecoder("utf8"));oe(this,"telnet");oe(this,"_connected",!1);oe(this,"intentionalDisconnect",!1);oe(this,"host");oe(this,"port");oe(this,"telnetNegotiation",!1);oe(this,"telnetBuffer","");oe(this,"gmcpHandlers",{});oe(this,"mcpHandlers",{});oe(this,"mcpMultilines",{});oe(this,"mcpAuthKey",null);oe(this,"mcp_negotiate");oe(this,"mcp_getset");oe(this,"gmcp_char");oe(this,"gmcp_fileTransfer");oe(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[],roomPlayers:[]});oe(this,"cacophony");oe(this,"editors");oe(this,"webRTCService");oe(this,"fileTransferManager");oe(this,"currentRoomInfo",null);oe(this,"_autosay",!1);oe(this,"globalMuted",!1);oe(this,"isWindowFocused",!0);this.host=t,this.port=r,this.mcp_negotiate=this.registerMcpPackage(RO),this.mcp_getset=this.registerMcpPackage(MO),this.gmcp_char=this.registerGMCPPackage(rk),this.gmcp_fileTransfer=this.registerGMCPPackage(ik),this.cacophony=new nO,this.cacophony.setGlobalVolume(lr.getState().sound.volume),this.editors=new a3(this),this.webRTCService=new OO(this),this.fileTransferManager=new c8(this,this.gmcp_fileTransfer),window.addEventListener("focus",()=>{this.isWindowFocused=!0,this.updateBackgroundMuteState()}),window.addEventListener("blur",()=>{this.isWindowFocused=!1,this.updateBackgroundMuteState()}),lr.subscribe(()=>{this.updateBackgroundMuteState()})}get connected(){return this._connected}get autosay(){return this._autosay}set autosay(t){this._autosay=t,this.emit("autosayChanged",t)}async sendFile(t,r){await this.fileTransferManager.sendFile(t,r)}cancelTransfer(t){this.fileTransferManager.cancelTransfer(t)}acceptTransfer(t,r){this.fileTransferManager.acceptTransfer(t,r).catch(i=>{console.error("[MudClient] Failed to accept transfer:",i),this.onFileTransferError(r,"unknown","receive",i.message)})}rejectTransfer(t,r){this.gmcp_fileTransfer.sendReject(t,r)}onFileTransferOffer(t,r,i,o,a){console.log("[MudClient] Emitting fileTransferOffer event:",{sender:t,hash:r,filename:i,filesize:o,offerSdp:a}),this.emit("fileTransferOffer",{sender:t,hash:r,filename:i,filesize:o,offerSdp:a})}onFileTransferAccept(t,r,i,o){console.log("[MudClient] Emitting fileTransferAccepted event:",{sender:t,hash:r,filename:i,answerSdp:o}),this.emit("fileTransferAccepted",{sender:t,hash:r,filename:i,answerSdp:o})}onFileTransferReject(t,r){this.emit("fileTransferRejected",{sender:t,hash:r})}onFileTransferCancel(t,r){this.emit("fileTransferCancelled",{sender:t,hash:r})}onFileSendComplete(t,r){this.emit("fileSendComplete",{hash:t,filename:r})}onFileTransferError(t,r,i,o){this.emit("fileTransferError",{hash:t,filename:r,direction:i,error:o})}onConnectionRecovered(t){this.emit("connectionRecovered",t)}onRecoveryFailed(t){this.emit("recoveryFailed",t)}sendFileTransferOffer(t,r,i,o,a){this.gmcp_fileTransfer.sendOffer(t,r,o,a,i)}sendFileTransferAccept(t,r,i,o){this.gmcp_fileTransfer.sendAccept(t,i,r,o)}registerGMCPPackage(t){const r=new t(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(t){const r=new t(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.intentionalDisconnect=!1,this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new r3(new n3(this.ws)),this.ws.onopen=()=>{this._connected=!0,en.resetIntentionalDisconnectFlags(),this.emit("connect"),this.emit("connectionChange",!0)},this.telnet.on("data",t=>{this.handleData(t)}),this.telnet.on("negotiation",(t,r)=>{t===Od.WILL&&r===Bd.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(Od.DO,Bd.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):t===Od.DO&&r===Bd.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(Od.WILL,Bd.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(t,r)=>{console.log("GMCP Package:",t,r);try{this.handleGmcpData(t,r)}catch(i){console.error("Calling GMCP:",i)}}),this.ws.onclose=()=>{this.cleanupConnection(),this.intentionalDisconnect||setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=t=>{this.emit("error",t)}}send(t){this.ws.send(t)}cleanupConnection(){this._connected=!1,this.mcpAuthKey=null,this.telnetBuffer="",this.telnetNegotiation=!1,this.currentRoomInfo=null,this.webRTCService.cleanup(),this.fileTransferManager.cleanup(),this.intentionalDisconnect&&(this.intentionalDisconnect=!1),this.emit("disconnect"),this.emit("connectionChange",!1)}close(){this.intentionalDisconnect=!0,this.ws&&this.ws.close(),this.cleanupConnection()}sendCommand(t){lr.getState().general.localEcho&&this.emit("command",t),this.autosay&&!t.startsWith("-")&&!t.startsWith("'")&&(t="say "+t),this.send(t+`\r
`),console.log("> "+t)}handleData(t){const r=this.decoder.decode(t).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(t){if(t.startsWith("#$#*")){const i=LI(t.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(t.startsWith("#$#:")){const i=LI(t.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=_O(t.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=UI(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(t,r){const i=t.lastIndexOf("."),o=t.substring(0,i),a=t.substring(i+1);console.log("GMCP Message:",o,a,r);const s=this.gmcpHandlers[o];if(!s){console.log("No handler for GMCP package:",o);return}const l=s["handle"+a];if(l){console.log("Calling handler for:",a,l);let f;typeof r=="string"&&r.trim()!==""?f=r:(console.warn(`GMCP message data for ${o}.${a} is missing or empty. Defaulting to {}. Original data:`,r),f="{}");try{const h=JSON.parse(f);l.call(s,h)}catch(h){console.error(`Error parsing GMCP JSON for ${o}.${a}:`,h),console.error("Attempted to parse:",f)}}else console.log("No handler on package:",o,a)}emitMessage(t){const r=lr.getState().speech.autoreadMode;r===Zv.All&&this.speak(t),r===Zv.Unfocused&&!document.hasFocus()&&this.speak(t),this.emit("message",t)}sendGmcp(t,r){console.log("Sending GMCP:",t,r),this.telnet.sendGmcp(t,r)}sendMcp(t,r){if(typeof r=="object"){let o="";for(const[a,s]of Object.entries(r))o+=` ${a}: ${s||'""'}`;r=o}const i=`#$#${t} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(t,r,i){this.send(`#$#* ${t} ${r}: ${i}\r
`)}closeMcpML(t){this.send(`#$#: ${t}\r
`)}sendMCPMultiline(t,r,i){const o=UI();r["_data-tag"]=o,this.sendMcp(t,r);for(const a of i)this.sendMcpMLLine(o,"content",a);this.closeMcpML(o)}shutdown(){Object.values(this.mcpHandlers).forEach(t=>{t.shutdown()}),Object.values(this.gmcpHandlers).forEach(t=>{t.shutdown()}),this.editors.shutdown(),this.webRTCService.cleanup(),this.fileTransferManager.cleanup()}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(t,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(t,{body:r})}speak(t){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(s3(t));r.lang="en-US";const{rate:i,pitch:o,voice:a,volume:s}=lr.getState().speech;r.rate=i,r.pitch=o,r.volume=s;const f=speechSynthesis.getVoices().find(h=>h.name===a);f&&(r.voice=f),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}updateBackgroundMuteState(){const r=lr.getState().sound.muteInBackground&&!this.isWindowFocused;this.cacophony.muted=this.globalMuted||r}setGlobalMute(t){this.globalMuted=t,this.updateBackgroundMuteState()}}class u8{constructor(){oe(this,"history",[]);oe(this,"currentIndex",-1);oe(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&this.history.push(e.trim()),this.currentIndex=-1,this.unsentInput=""}navigateUp(e){return this.currentIndex===-1&&(this.unsentInput=e),this.history.length>0&&this.currentIndex<this.history.length-1&&this.currentIndex++,this.history.length>0?this.history[this.history.length-1-this.currentIndex]:""}navigateDown(e){return this.currentIndex===-1&&(this.unsentInput=e),this.currentIndex>0?(this.currentIndex--,this.history[this.history.length-1-this.currentIndex]):(this.currentIndex=-1,this.unsentInput)}getCurrentInput(){return this.currentIndex===-1?this.unsentInput:this.history[this.history.length-1-this.currentIndex]}getHistory(){return[...this.history]}}const d8=()=>{const[,n]=O.useReducer(e=>e+1,0);return O.useEffect(()=>Pa.subscribe(n),[]),[Pa.getState(),Pa.dispatch]},kw="command_history",f8=1e3,Lm=n=>n.includes(" ")?`"${n}"`:n,Um=n=>{if(n.startsWith('"'))return{leadingPunctuation:"",namePart:n.substring(1)};{const e=n.match(/^([^\w\s"]+)(.*)$/);return e?{leadingPunctuation:e[1],namePart:e[2]}:{leadingPunctuation:"",namePart:n}}},h8=({onSend:n,inputRef:e,client:t})=>{const r=O.useRef(new u8),[i,o]=d8(),a=O.useRef([]),s=O.useRef(0),l=O.useRef(null);O.useEffect(()=>{const y=localStorage.getItem(kw);y&&JSON.parse(y).forEach(x=>{r.current.addCommand(x)})},[]),O.useEffect(()=>{Pa.registerInputRef(e)},[e]);const f=()=>{try{const C=r.current.getHistory().slice(-f8);localStorage.setItem(kw,JSON.stringify(C))}catch(y){console.warn("Failed to save command history:",y)}},h=O.useCallback(()=>{a.current=[],s.current=0,l.current=null},[]),m=O.useCallback(()=>{var C;const y=i.text;y.trim()&&(n(y),r.current.addCommand(y),f(),eM(),(C=e.current)==null||C.focus(),h())},[i.text,n,e,h]),g=O.useCallback(y=>{const C=r.current,x=i.text,w=e.current;if(y.key==="Tab"){if(!w)return;if(x===""){h();return}y.preventDefault();const S=w.selectionStart,A=x.substring(0,S),E=A.match(/(?:[^"\s]\S*|"[^"]*"?)$/),_=E?E[0]:"",T=E?A.lastIndexOf(_):-1;if(_===""&&l.current===null){h();return}let M=!1;if(l.current!==null&&a.current.length>0){const P=a.current[s.current],{leadingPunctuation:j}=Um(l.current),X=j+Lm(P.name);M=_===X}if(M){s.current=(s.current+1)%a.current.length;const P=a.current[s.current],{leadingPunctuation:j}=Um(l.current),X=Lm(P.name),L=j+X,G=x.substring(0,T)+L+x.substring(S);il(G);const Z=T+L.length;requestAnimationFrame(()=>w.setSelectionRange(Z,Z))}else{h();const{leadingPunctuation:P,namePart:j}=Um(_);if(j==="")return;const L=(t.worldData.roomPlayers||[]).filter(G=>{const Z=typeof G.name=="string"&&G.name.toLowerCase().startsWith(j.toLowerCase()),pe=(typeof G.fullname=="string"?G.fullname.toLowerCase().split(" "):[]).some(ve=>ve.startsWith(j.toLowerCase()));return Z||pe}).sort((G,Z)=>{const ne=G.name.localeCompare(Z.name);return ne!==0?ne:G.fullname.localeCompare(Z.fullname)});if(L.length>0){l.current=_,a.current=L,s.current=0;const G=L[0],Z=Lm(G.name),ne=P+Z,pe=x.substring(0,T)+ne+x.substring(S);il(pe);const ve=T+ne.length;requestAnimationFrame(()=>w.setSelectionRange(ve,ve))}}}else if(y.key==="Enter"&&!y.shiftKey)y.preventDefault(),m();else if(y.key==="ArrowUp"){y.preventDefault();const S=C.navigateUp(x);il(S),h()}else if(y.key==="ArrowDown"){y.preventDefault();const S=C.navigateDown(x);il(S),h()}else(y.key.length===1||y.key==="Backspace"||y.key==="Delete")&&h()},[i.text,t,e,n,h,m]);return K.jsxs("div",{className:"command-input-container",children:[K.jsx("textarea",{value:i.text,onChange:y=>{il(y.target.value),h()},onKeyDown:g,id:"command-input",ref:e,autoFocus:!0}),K.jsx("button",{onClick:m,className:"send-button",children:"Send"})]})},TE=7e3;let Gs=null;function Ew(n,e="assertive",t=TE){Gs?Gs.announce(n,e,t):(Gs=new p8,(typeof IS_REACT_ACT_ENVIRONMENT=="boolean"?IS_REACT_ACT_ENVIRONMENT:typeof jest<"u")?Gs.announce(n,e,t):setTimeout(()=>{Gs!=null&&Gs.isAttached()&&(Gs==null||Gs.announce(n,e,t))},100))}class p8{isAttached(){var e;return(e=this.node)===null||e===void 0?void 0:e.isConnected}createLog(e){let t=document.createElement("div");return t.setAttribute("role","log"),t.setAttribute("aria-live",e),t.setAttribute("aria-relevant","additions"),t}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,t="assertive",r=TE){var i,o;if(!this.node)return;let a=document.createElement("div");typeof e=="object"?(a.setAttribute("role","img"),a.setAttribute("aria-labelledby",e["aria-labelledby"])):a.textContent=e,t==="assertive"?(i=this.assertiveLog)===null||i===void 0||i.appendChild(a):(o=this.politeLog)===null||o===void 0||o.appendChild(a),e!==""&&setTimeout(()=>{a.remove()},r)}clear(e){this.node&&((!e||e==="assertive")&&this.assertiveLog&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&this.politeLog&&(this.politeLog.innerHTML=""))}constructor(){this.node=null,this.assertiveLog=null,this.politeLog=null,typeof document<"u"&&(this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node))}}var jm,Tw;function g8(){if(Tw)return jm;Tw=1;var n=function(){function o(a,s){for(var l=0;l<s.length;l++){var f=s[l];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(a,f.key,f)}}return function(a,s,l){return s&&o(a.prototype,s),l&&o(a,l),a}}();function e(o,a){if(!(o instanceof a))throw new TypeError("Cannot call a class as a function")}var t=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],r=/(https?:\/\/(?:[A-Za-z0-9#;/?:@=+$',_.!~*()[\]-]|&amp;|%[A-Fa-f0-9]{2})+)/gm,i=function(){n(o,null,[{key:"escapeForHtml",value:function(s){return new o().escapeForHtml(s)}},{key:"linkify",value:function(s){return new o().linkify(s)}},{key:"ansiToHtml",value:function(s,l){return new o().ansiToHtml(s,l)}},{key:"ansiToJson",value:function(s,l){return new o().ansiToJson(s,l)}},{key:"ansiToText",value:function(s){return new o().ansiToText(s)}}]);function o(){e(this,o),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return n(o,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var s=0;s<2;++s)for(var l=0;l<8;++l)this.PALETTE_COLORS.push(t[s][l].color);for(var f=[0,95,135,175,215,255],h=function(S,A,E){return f[S]+", "+f[A]+", "+f[E]},m=0;m<6;++m)for(var g=0;g<6;++g)for(var y=0;y<6;++y)this.PALETTE_COLORS.push(h(m,g,y));for(var C=8,x=0;x<24;++x,C+=10)this.PALETTE_COLORS.push(h(C,C,C))}},{key:"escapeForHtml",value:function(s){return s.replace(/[&<>\"]/gm,function(l){return l=="&"?"&amp;":l=='"'?"&quot;":l=="<"?"&lt;":l==">"?"&gt;":""})}},{key:"linkify",value:function(s){return s.replace(r,function(l){return'<a href="'+l+'">'+l+"</a>"})}},{key:"ansiToHtml",value:function(s,l){return this.process(s,l,!0)}},{key:"ansiToJson",value:function(s,l){return l=l||{},l.json=!0,l.clearLine=!1,this.process(s,l,!0)}},{key:"ansiToText",value:function(s){return this.process(s,{},!1)}},{key:"process",value:function(s,l,f){var h=this,m=this,g=s.split(/\033\[/),y=g.shift();l==null&&(l={}),l.clearLine=/\r/.test(s);var C=g.map(function(w){return h.processChunk(w,l,f)});if(l&&l.json){var x=m.processChunkJson("");return x.content=y,x.clearLine=l.clearLine,C.unshift(x),l.remove_empty&&(C=C.filter(function(w){return!w.isEmpty()})),C}else C.unshift(y);return C.join("")}},{key:"processChunkJson",value:function(s,l,f){l=typeof l>"u"?{}:l;var h=l.use_classes=typeof l.use_classes<"u"&&l.use_classes,m=l.key=h?"class":"color",g={content:s,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:l.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!g.content}},y=s.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!y)return g;g.content=y[4];var C=y[2].split(";");if(y[1]!==""||y[3]!=="m"||!f)return g;for(var x=this;C.length>0;){var w=C.shift(),S=parseInt(w);if(isNaN(S)||S===0)x.fg=x.bg=null,x.decorations=[];else if(S===1)x.decorations.push("bold");else if(S===2)x.decorations.push("dim");else if(S===3)x.decorations.push("italic");else if(S===4)x.decorations.push("underline");else if(S===5)x.decorations.push("blink");else if(S===7)x.decorations.push("reverse");else if(S===8)x.decorations.push("hidden");else if(S===9)x.decorations.push("strikethrough");else if(S===21)x.removeDecoration("bold");else if(S===22)x.removeDecoration("bold"),x.removeDecoration("dim");else if(S===23)x.removeDecoration("italic");else if(S===24)x.removeDecoration("underline");else if(S===25)x.removeDecoration("blink");else if(S===27)x.removeDecoration("reverse");else if(S===28)x.removeDecoration("hidden");else if(S===29)x.removeDecoration("strikethrough");else if(S===39)x.fg=null;else if(S===49)x.bg=null;else if(S>=30&&S<38)x.fg=t[0][S%10][m];else if(S>=90&&S<98)x.fg=t[1][S%10][m];else if(S>=40&&S<48)x.bg=t[0][S%10][m];else if(S>=100&&S<108)x.bg=t[1][S%10][m];else if(S===38||S===48){var A=S===38;if(C.length>=1){var E=C.shift();if(E==="5"&&C.length>=1){var _=parseInt(C.shift());if(_>=0&&_<=255)if(!h)this.PALETTE_COLORS||x.setupPalette(),A?x.fg=this.PALETTE_COLORS[_]:x.bg=this.PALETTE_COLORS[_];else{var T=_>=16?"ansi-palette-"+_:t[_>7?1:0][_%8].class;A?x.fg=T:x.bg=T}}else if(E==="2"&&C.length>=3){var M=parseInt(C.shift()),P=parseInt(C.shift()),j=parseInt(C.shift());if(M>=0&&M<=255&&P>=0&&P<=255&&j>=0&&j<=255){var X=M+", "+P+", "+j;h?A?(x.fg="ansi-truecolor",x.fg_truecolor=X):(x.bg="ansi-truecolor",x.bg_truecolor=X):A?x.fg=X:x.bg=X}}}}}return x.fg===null&&x.bg===null&&x.decorations.length===0||(g.fg=x.fg,g.bg=x.bg,g.fg_truecolor=x.fg_truecolor,g.bg_truecolor=x.bg_truecolor,g.decorations=x.decorations,g.decoration=x.decorations.slice(-1).pop()||null,g.was_processed=!0),g}},{key:"processChunk",value:function(s,l,f){var h=this;l=l||{};var m=this.processChunkJson(s,l,f),g=l.use_classes;if(m.decorations=m.decorations.filter(function(A){if(A==="reverse"){m.fg||(m.fg=t[0][7][g?"class":"color"]),m.bg||(m.bg=t[0][0][g?"class":"color"]);var E=m.fg;m.fg=m.bg,m.bg=E;var _=m.fg_truecolor;return m.fg_truecolor=m.bg_truecolor,m.bg_truecolor=_,m.isInverted=!0,!1}return!0}),l.json)return m;if(m.isEmpty())return"";if(!m.was_processed)return m.content;var y=[],C=[],x=[],w={},S=function(E){var _=[],T=void 0;for(T in E)E.hasOwnProperty(T)&&_.push("data-"+T+'="'+h.escapeForHtml(E[T])+'"');return _.length>0?" "+_.join(" "):""};return m.isInverted&&(w["ansi-is-inverted"]="true"),m.fg&&(g?(y.push(m.fg+"-fg"),m.fg_truecolor!==null&&(w["ansi-truecolor-fg"]=m.fg_truecolor,m.fg_truecolor=null)):y.push("color:rgb("+m.fg+")")),m.bg&&(g?(y.push(m.bg+"-bg"),m.bg_truecolor!==null&&(w["ansi-truecolor-bg"]=m.bg_truecolor,m.bg_truecolor=null)):y.push("background-color:rgb("+m.bg+")")),m.decorations.forEach(function(A){if(g){C.push("ansi-"+A);return}A==="bold"?C.push("font-weight:bold"):A==="dim"?C.push("opacity:0.5"):A==="italic"?C.push("font-style:italic"):A==="hidden"?C.push("visibility:hidden"):A==="strikethrough"?x.push("line-through"):x.push(A)}),x.length&&C.push("text-decoration:"+x.join(" ")),g?'<span class="'+y.concat(C).join(" ")+'"'+S(w)+">"+m.content+"</span>":'<span style="'+y.concat(C).join(";")+'"'+S(w)+">"+m.content+"</span>"}},{key:"removeDecoration",value:function(s){var l=this.decorations.indexOf(s);l>=0&&this.decorations.splice(l,1)}}]),o}();return jm=i,jm}var m8=g8();const v8=Ec(m8);function _w(n,e){let t=[];for(const r of n.split(`\r
`)){const i=v8.ansiToJson(r,{json:!0,remove_empty:!1});let o=[];for(const a of i){const s=b8(a,e);o=[...o,...s]}t=[...t,K.jsx("span",{children:o},t.length)]}return t}const y8=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,C8=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,x8=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function b8(n,e){const t=I8(n),r=[];let i=0,o=0;function a(h,m){let g;for(;(g=h.exec(n.content))!==null;){const y=g.index;y>i&&r.push(n.content.substring(i,y)),r.push(m(g)),i=h.lastIndex}}function s(h){const[,m,g]=h,y=g;return K.jsxs(K.Fragment,{children:[m,K.jsx("a",{href:y,target:"_blank",rel:"noreferrer",children:g})]})}function l(h){const m=h.groups.name,g=`mailto:${m}`;return K.jsxs(K.Fragment,{children:[h.groups.slorp1,K.jsx("a",{href:g,target:"_blank",rel:"noreferrer",children:m}),h.groups.slorp2]})}function f(h){const[,m,g]=h;return K.jsx("a",{onClick:()=>e(m),className:"exit",children:g})}return a(y8,s),a(C8,l),a(x8,f),i<n.content.length&&r.push(n.content.substring(i)),r.map(h=>K.jsx("span",{style:t,children:h},o++))}function I8(n){const e={};switch(n.bg&&(e.backgroundColor=`rgb(${n.bg})`),n.fg&&(e.color=`rgb(${n.fg})`),n.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}var sc={},el={},Rw;function w8(){if(Rw)return el;Rw=1;var n=mf();function e(D){for(var V="https://reactjs.org/docs/error-decoder.html?invariant="+D,Q=1;Q<arguments.length;Q++)V+="&args[]="+encodeURIComponent(arguments[Q]);return"Minified React error #"+D+"; visit "+V+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t=Object.prototype.hasOwnProperty,r=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,i={},o={};function a(D){return t.call(o,D)?!0:t.call(i,D)?!1:r.test(D)?o[D]=!0:(i[D]=!0,!1)}function s(D,V,Q,ie,Be,Te,We){this.acceptsBooleans=V===2||V===3||V===4,this.attributeName=ie,this.attributeNamespace=Be,this.mustUseProperty=Q,this.propertyName=D,this.type=V,this.sanitizeURL=Te,this.removeEmptyString=We}var l={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(D){l[D]=new s(D,0,!1,D,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(D){var V=D[0];l[V]=new s(V,1,!1,D[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(D){l[D]=new s(D,2,!1,D.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(D){l[D]=new s(D,2,!1,D,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(D){l[D]=new s(D,3,!1,D.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(D){l[D]=new s(D,3,!0,D,null,!1,!1)}),["capture","download"].forEach(function(D){l[D]=new s(D,4,!1,D,null,!1,!1)}),["cols","rows","size","span"].forEach(function(D){l[D]=new s(D,6,!1,D,null,!1,!1)}),["rowSpan","start"].forEach(function(D){l[D]=new s(D,5,!1,D.toLowerCase(),null,!1,!1)});var f=/[\-:]([a-z])/g;function h(D){return D[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(D){var V=D.replace(f,h);l[V]=new s(V,1,!1,D,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(D){var V=D.replace(f,h);l[V]=new s(V,1,!1,D,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(D){var V=D.replace(f,h);l[V]=new s(V,1,!1,D,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(D){l[D]=new s(D,1,!1,D.toLowerCase(),null,!1,!1)}),l.xlinkHref=new s("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(D){l[D]=new s(D,1,!1,D.toLowerCase(),null,!0,!0)});var m={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},g=["Webkit","ms","Moz","O"];Object.keys(m).forEach(function(D){g.forEach(function(V){V=V+D.charAt(0).toUpperCase()+D.substring(1),m[V]=m[D]})});var y=/["'&<>]/;function C(D){if(typeof D=="boolean"||typeof D=="number")return""+D;D=""+D;var V=y.exec(D);if(V){var Q="",ie,Be=0;for(ie=V.index;ie<D.length;ie++){switch(D.charCodeAt(ie)){case 34:V="&quot;";break;case 38:V="&amp;";break;case 39:V="&#x27;";break;case 60:V="&lt;";break;case 62:V="&gt;";break;default:continue}Be!==ie&&(Q+=D.substring(Be,ie)),Be=ie+1,Q+=V}D=Be!==ie?Q+D.substring(Be,ie):Q}return D}var x=/([A-Z])/g,w=/^ms-/,S=Array.isArray;function A(D,V){return{insertionMode:D,selectedValue:V}}function E(D,V,Q){switch(V){case"select":return A(1,Q.value!=null?Q.value:Q.defaultValue);case"svg":return A(2,null);case"math":return A(3,null);case"foreignObject":return A(1,null);case"table":return A(4,null);case"thead":case"tbody":case"tfoot":return A(5,null);case"colgroup":return A(7,null);case"tr":return A(6,null)}return 4<=D.insertionMode||D.insertionMode===0?A(1,null):D}var _=new Map;function T(D,V,Q){if(typeof Q!="object")throw Error(e(62));V=!0;for(var ie in Q)if(t.call(Q,ie)){var Be=Q[ie];if(Be!=null&&typeof Be!="boolean"&&Be!==""){if(ie.indexOf("--")===0){var Te=C(ie);Be=C((""+Be).trim())}else{Te=ie;var We=_.get(Te);We!==void 0||(We=C(Te.replace(x,"-$1").toLowerCase().replace(w,"-ms-")),_.set(Te,We)),Te=We,Be=typeof Be=="number"?Be===0||t.call(m,ie)?""+Be:Be+"px":C((""+Be).trim())}V?(V=!1,D.push(' style="',Te,":",Be)):D.push(";",Te,":",Be)}}V||D.push('"')}function M(D,V,Q,ie){switch(Q){case"style":T(D,V,ie);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<Q.length)||Q[0]!=="o"&&Q[0]!=="O"||Q[1]!=="n"&&Q[1]!=="N"){if(V=l.hasOwnProperty(Q)?l[Q]:null,V!==null){switch(typeof ie){case"function":case"symbol":return;case"boolean":if(!V.acceptsBooleans)return}switch(Q=V.attributeName,V.type){case 3:ie&&D.push(" ",Q,'=""');break;case 4:ie===!0?D.push(" ",Q,'=""'):ie!==!1&&D.push(" ",Q,'="',C(ie),'"');break;case 5:isNaN(ie)||D.push(" ",Q,'="',C(ie),'"');break;case 6:!isNaN(ie)&&1<=ie&&D.push(" ",Q,'="',C(ie),'"');break;default:V.sanitizeURL&&(ie=""+ie),D.push(" ",Q,'="',C(ie),'"')}}else if(a(Q)){switch(typeof ie){case"function":case"symbol":return;case"boolean":if(V=Q.toLowerCase().slice(0,5),V!=="data-"&&V!=="aria-")return}D.push(" ",Q,'="',C(ie),'"')}}}function P(D,V,Q){if(V!=null){if(Q!=null)throw Error(e(60));if(typeof V!="object"||!("__html"in V))throw Error(e(61));V=V.__html,V!=null&&D.push(""+V)}}function j(D){var V="";return n.Children.forEach(D,function(Q){Q!=null&&(V+=Q)}),V}function X(D,V,Q,ie){D.push(Z(Q));var Be=Q=null,Te;for(Te in V)if(t.call(V,Te)){var We=V[Te];if(We!=null)switch(Te){case"children":Q=We;break;case"dangerouslySetInnerHTML":Be=We;break;default:M(D,ie,Te,We)}}return D.push(">"),P(D,Be,Q),typeof Q=="string"?(D.push(C(Q)),null):Q}var L=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,G=new Map;function Z(D){var V=G.get(D);if(V===void 0){if(!L.test(D))throw Error(e(65,D));V="<"+D,G.set(D,V)}return V}function ne(D,V,Q,ie,Be){switch(V){case"select":D.push(Z("select"));var Te=null,We=null;for(sn in Q)if(t.call(Q,sn)){var dt=Q[sn];if(dt!=null)switch(sn){case"children":Te=dt;break;case"dangerouslySetInnerHTML":We=dt;break;case"defaultValue":case"value":break;default:M(D,ie,sn,dt)}}return D.push(">"),P(D,We,Te),Te;case"option":We=Be.selectedValue,D.push(Z("option"));var mt=dt=null,Kt=null,sn=null;for(Te in Q)if(t.call(Q,Te)){var Fn=Q[Te];if(Fn!=null)switch(Te){case"children":dt=Fn;break;case"selected":Kt=Fn;break;case"dangerouslySetInnerHTML":sn=Fn;break;case"value":mt=Fn;default:M(D,ie,Te,Fn)}}if(We!=null)if(Q=mt!==null?""+mt:j(dt),S(We)){for(ie=0;ie<We.length;ie++)if(""+We[ie]===Q){D.push(' selected=""');break}}else""+We===Q&&D.push(' selected=""');else Kt&&D.push(' selected=""');return D.push(">"),P(D,sn,dt),dt;case"textarea":D.push(Z("textarea")),sn=We=Te=null;for(dt in Q)if(t.call(Q,dt)&&(mt=Q[dt],mt!=null))switch(dt){case"children":sn=mt;break;case"value":Te=mt;break;case"defaultValue":We=mt;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:M(D,ie,dt,mt)}if(Te===null&&We!==null&&(Te=We),D.push(">"),sn!=null){if(Te!=null)throw Error(e(92));if(S(sn)&&1<sn.length)throw Error(e(93));Te=""+sn}return typeof Te=="string"&&Te[0]===`
`&&D.push(`
`),Te!==null&&D.push(C(""+Te)),null;case"input":D.push(Z("input")),mt=sn=dt=Te=null;for(We in Q)if(t.call(Q,We)&&(Kt=Q[We],Kt!=null))switch(We){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":mt=Kt;break;case"defaultValue":dt=Kt;break;case"checked":sn=Kt;break;case"value":Te=Kt;break;default:M(D,ie,We,Kt)}return sn!==null?M(D,ie,"checked",sn):mt!==null&&M(D,ie,"checked",mt),Te!==null?M(D,ie,"value",Te):dt!==null&&M(D,ie,"value",dt),D.push("/>"),null;case"menuitem":D.push(Z("menuitem"));for(var Ci in Q)if(t.call(Q,Ci)&&(Te=Q[Ci],Te!=null))switch(Ci){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:M(D,ie,Ci,Te)}return D.push(">"),null;case"title":D.push(Z("title")),Te=null;for(Fn in Q)if(t.call(Q,Fn)&&(We=Q[Fn],We!=null))switch(Fn){case"children":Te=We;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:M(D,ie,Fn,We)}return D.push(">"),Te;case"listing":case"pre":D.push(Z(V)),We=Te=null;for(mt in Q)if(t.call(Q,mt)&&(dt=Q[mt],dt!=null))switch(mt){case"children":Te=dt;break;case"dangerouslySetInnerHTML":We=dt;break;default:M(D,ie,mt,dt)}if(D.push(">"),We!=null){if(Te!=null)throw Error(e(60));if(typeof We!="object"||!("__html"in We))throw Error(e(61));Q=We.__html,Q!=null&&(typeof Q=="string"&&0<Q.length&&Q[0]===`
`?D.push(`
`,Q):D.push(""+Q))}return typeof Te=="string"&&Te[0]===`
`&&D.push(`
`),Te;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":D.push(Z(V));for(var xi in Q)if(t.call(Q,xi)&&(Te=Q[xi],Te!=null))switch(xi){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,V));default:M(D,ie,xi,Te)}return D.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return X(D,Q,V,ie);case"html":return Be.insertionMode===0&&D.push("<!DOCTYPE html>"),X(D,Q,V,ie);default:if(V.indexOf("-")===-1&&typeof Q.is!="string")return X(D,Q,V,ie);D.push(Z(V)),We=Te=null;for(Kt in Q)if(t.call(Q,Kt)&&(dt=Q[Kt],dt!=null))switch(Kt){case"children":Te=dt;break;case"dangerouslySetInnerHTML":We=dt;break;case"style":T(D,ie,dt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:a(Kt)&&typeof dt!="function"&&typeof dt!="symbol"&&D.push(" ",Kt,'="',C(dt),'"')}return D.push(">"),P(D,We,Te),Te}}function pe(D,V,Q){if(D.push('<!--$?--><template id="'),Q===null)throw Error(e(395));return D.push(Q),D.push('"></template>')}function ve(D,V,Q,ie){switch(Q.insertionMode){case 0:case 1:return D.push('<div hidden id="'),D.push(V.segmentPrefix),V=ie.toString(16),D.push(V),D.push('">');case 2:return D.push('<svg aria-hidden="true" style="display:none" id="'),D.push(V.segmentPrefix),V=ie.toString(16),D.push(V),D.push('">');case 3:return D.push('<math aria-hidden="true" style="display:none" id="'),D.push(V.segmentPrefix),V=ie.toString(16),D.push(V),D.push('">');case 4:return D.push('<table hidden id="'),D.push(V.segmentPrefix),V=ie.toString(16),D.push(V),D.push('">');case 5:return D.push('<table hidden><tbody id="'),D.push(V.segmentPrefix),V=ie.toString(16),D.push(V),D.push('">');case 6:return D.push('<table hidden><tr id="'),D.push(V.segmentPrefix),V=ie.toString(16),D.push(V),D.push('">');case 7:return D.push('<table hidden><colgroup id="'),D.push(V.segmentPrefix),V=ie.toString(16),D.push(V),D.push('">');default:throw Error(e(397))}}function Se(D,V){switch(V.insertionMode){case 0:case 1:return D.push("</div>");case 2:return D.push("</svg>");case 3:return D.push("</math>");case 4:return D.push("</table>");case 5:return D.push("</tbody></table>");case 6:return D.push("</tr></table>");case 7:return D.push("</colgroup></table>");default:throw Error(e(397))}}var Ne=/[<\u2028\u2029]/g;function xe(D){return JSON.stringify(D).replace(Ne,function(V){switch(V){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function Ae(D,V){return V=V===void 0?"":V,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:V+"P:",segmentPrefix:V+"S:",boundaryPrefix:V+"B:",idPrefix:V,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:D}}function ke(D,V,Q,ie){return Q.generateStaticMarkup?(D.push(C(V)),!1):(V===""?D=ie:(ie&&D.push("<!-- -->"),D.push(C(V)),D=!0),D)}var H=Object.assign,ee=Symbol.for("react.element"),ae=Symbol.for("react.portal"),ye=Symbol.for("react.fragment"),Ee=Symbol.for("react.strict_mode"),_e=Symbol.for("react.profiler"),Je=Symbol.for("react.provider"),me=Symbol.for("react.context"),it=Symbol.for("react.forward_ref"),Tt=Symbol.for("react.suspense"),Xt=Symbol.for("react.suspense_list"),Et=Symbol.for("react.memo"),St=Symbol.for("react.lazy"),Dt=Symbol.for("react.scope"),at=Symbol.for("react.debug_trace_mode"),lt=Symbol.for("react.legacy_hidden"),Vt=Symbol.for("react.default_value"),Gt=Symbol.iterator;function Pt(D){if(D==null)return null;if(typeof D=="function")return D.displayName||D.name||null;if(typeof D=="string")return D;switch(D){case ye:return"Fragment";case ae:return"Portal";case _e:return"Profiler";case Ee:return"StrictMode";case Tt:return"Suspense";case Xt:return"SuspenseList"}if(typeof D=="object")switch(D.$$typeof){case me:return(D.displayName||"Context")+".Consumer";case Je:return(D._context.displayName||"Context")+".Provider";case it:var V=D.render;return D=D.displayName,D||(D=V.displayName||V.name||"",D=D!==""?"ForwardRef("+D+")":"ForwardRef"),D;case Et:return V=D.displayName||null,V!==null?V:Pt(D.type)||"Memo";case St:V=D._payload,D=D._init;try{return Pt(D(V))}catch{}}return null}var Ht={};function on(D,V){if(D=D.contextTypes,!D)return Ht;var Q={},ie;for(ie in D)Q[ie]=V[ie];return Q}var ct=null;function ce(D,V){if(D!==V){D.context._currentValue2=D.parentValue,D=D.parent;var Q=V.parent;if(D===null){if(Q!==null)throw Error(e(401))}else{if(Q===null)throw Error(e(401));ce(D,Q)}V.context._currentValue2=V.value}}function nn(D){D.context._currentValue2=D.parentValue,D=D.parent,D!==null&&nn(D)}function pn(D){var V=D.parent;V!==null&&pn(V),D.context._currentValue2=D.value}function Un(D,V){if(D.context._currentValue2=D.parentValue,D=D.parent,D===null)throw Error(e(402));D.depth===V.depth?ce(D,V):Un(D,V)}function q(D,V){var Q=V.parent;if(Q===null)throw Error(e(402));D.depth===Q.depth?ce(D,Q):q(D,Q),V.context._currentValue2=V.value}function N(D){var V=ct;V!==D&&(V===null?pn(D):D===null?nn(V):V.depth===D.depth?ce(V,D):V.depth>D.depth?Un(V,D):q(V,D),ct=D)}var F={isMounted:function(){return!1},enqueueSetState:function(D,V){D=D._reactInternals,D.queue!==null&&D.queue.push(V)},enqueueReplaceState:function(D,V){D=D._reactInternals,D.replace=!0,D.queue=[V]},enqueueForceUpdate:function(){}};function te(D,V,Q,ie){var Be=D.state!==void 0?D.state:null;D.updater=F,D.props=Q,D.state=Be;var Te={queue:[],replace:!1};D._reactInternals=Te;var We=V.contextType;if(D.context=typeof We=="object"&&We!==null?We._currentValue2:ie,We=V.getDerivedStateFromProps,typeof We=="function"&&(We=We(Q,Be),Be=We==null?Be:H({},Be,We),D.state=Be),typeof V.getDerivedStateFromProps!="function"&&typeof D.getSnapshotBeforeUpdate!="function"&&(typeof D.UNSAFE_componentWillMount=="function"||typeof D.componentWillMount=="function"))if(V=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),V!==D.state&&F.enqueueReplaceState(D,D.state,null),Te.queue!==null&&0<Te.queue.length)if(V=Te.queue,We=Te.replace,Te.queue=null,Te.replace=!1,We&&V.length===1)D.state=V[0];else{for(Te=We?V[0]:D.state,Be=!0,We=We?1:0;We<V.length;We++){var dt=V[We];dt=typeof dt=="function"?dt.call(D,Te,Q,ie):dt,dt!=null&&(Be?(Be=!1,Te=H({},Te,dt)):H(Te,dt))}D.state=Te}else Te.queue=null}var Ce={id:1,overflow:""};function Pe(D,V,Q){var ie=D.id;D=D.overflow;var Be=32-Ge(ie)-1;ie&=~(1<<Be),Q+=1;var Te=32-Ge(V)+Be;if(30<Te){var We=Be-Be%5;return Te=(ie&(1<<We)-1).toString(32),ie>>=We,Be-=We,{id:1<<32-Ge(V)+Be|Q<<Be|ie,overflow:Te+D}}return{id:1<<Te|Q<<Be|ie,overflow:D}}var Ge=Math.clz32?Math.clz32:hn,Lt=Math.log,fn=Math.LN2;function hn(D){return D>>>=0,D===0?32:31-(Lt(D)/fn|0)|0}function yn(D,V){return D===V&&(D!==0||1/D===1/V)||D!==D&&V!==V}var un=typeof Object.is=="function"?Object.is:yn,On=null,Sr=null,mr=null,Qt=null,Yr=!1,Qe=!1,kn=0,zt=null,dr=0;function Kn(){if(On===null)throw Error(e(321));return On}function Qr(){if(0<dr)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function Br(){return Qt===null?mr===null?(Yr=!1,mr=Qt=Qr()):(Yr=!0,Qt=mr):Qt.next===null?(Yr=!1,Qt=Qt.next=Qr()):(Yr=!0,Qt=Qt.next),Qt}function ge(){Sr=On=null,Qe=!1,mr=null,dr=0,Qt=zt=null}function Ie(D,V){return typeof V=="function"?V(D):V}function J(D,V,Q){if(On=Kn(),Qt=Br(),Yr){var ie=Qt.queue;if(V=ie.dispatch,zt!==null&&(Q=zt.get(ie),Q!==void 0)){zt.delete(ie),ie=Qt.memoizedState;do ie=D(ie,Q.action),Q=Q.next;while(Q!==null);return Qt.memoizedState=ie,[ie,V]}return[Qt.memoizedState,V]}return D=D===Ie?typeof V=="function"?V():V:Q!==void 0?Q(V):V,Qt.memoizedState=D,D=Qt.queue={last:null,dispatch:null},D=D.dispatch=rt.bind(null,On,D),[Qt.memoizedState,D]}function Ve(D,V){if(On=Kn(),Qt=Br(),V=V===void 0?null:V,Qt!==null){var Q=Qt.memoizedState;if(Q!==null&&V!==null){var ie=Q[1];e:if(ie===null)ie=!1;else{for(var Be=0;Be<ie.length&&Be<V.length;Be++)if(!un(V[Be],ie[Be])){ie=!1;break e}ie=!0}if(ie)return Q[0]}}return D=D(),Qt.memoizedState=[D,V],D}function rt(D,V,Q){if(25<=dr)throw Error(e(301));if(D===On)if(Qe=!0,D={action:Q,next:null},zt===null&&(zt=new Map),Q=zt.get(V),Q===void 0)zt.set(V,D);else{for(V=Q;V.next!==null;)V=V.next;V.next=D}}function _t(){throw Error(e(394))}function Bt(){}var pt={readContext:function(D){return D._currentValue2},useContext:function(D){return Kn(),D._currentValue2},useMemo:Ve,useReducer:J,useRef:function(D){On=Kn(),Qt=Br();var V=Qt.memoizedState;return V===null?(D={current:D},Qt.memoizedState=D):V},useState:function(D){return J(Ie,D)},useInsertionEffect:Bt,useLayoutEffect:function(){},useCallback:function(D,V){return Ve(function(){return D},V)},useImperativeHandle:Bt,useEffect:Bt,useDebugValue:Bt,useDeferredValue:function(D){return Kn(),D},useTransition:function(){return Kn(),[!1,_t]},useId:function(){var D=Sr.treeContext,V=D.overflow;D=D.id,D=(D&~(1<<32-Ge(D)-1)).toString(32)+V;var Q=gt;if(Q===null)throw Error(e(404));return V=kn++,D=":"+Q.idPrefix+"R"+D,0<V&&(D+="H"+V.toString(32)),D+":"},useMutableSource:function(D,V){return Kn(),V(D._source)},useSyncExternalStore:function(D,V,Q){if(Q===void 0)throw Error(e(407));return Q()}},gt=null,bt=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Fe(D){return console.error(D),null}function ut(){}function He(D,V,Q,ie,Be,Te,We,dt,mt){var Kt=[],sn=new Set;return V={destination:null,responseState:V,progressiveChunkSize:ie===void 0?12800:ie,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:sn,pingedTasks:Kt,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Be===void 0?Fe:Be,onAllReady:ut,onShellReady:We===void 0?ut:We,onShellError:ut,onFatalError:ut},Q=st(V,0,null,Q,!1,!1),Q.parentFlushed=!0,D=Cn(V,D,null,Q,sn,Ht,null,Ce),Kt.push(D),V}function Cn(D,V,Q,ie,Be,Te,We,dt){D.allPendingTasks++,Q===null?D.pendingRootTasks++:Q.pendingTasks++;var mt={node:V,ping:function(){var Kt=D.pingedTasks;Kt.push(mt),Kt.length===1&&nr(D)},blockedBoundary:Q,blockedSegment:ie,abortSet:Be,legacyContext:Te,context:We,treeContext:dt};return Be.add(mt),mt}function st(D,V,Q,ie,Be,Te){return{status:0,id:-1,index:V,parentFlushed:!1,chunks:[],children:[],formatContext:ie,boundary:Q,lastPushedText:Be,textEmbedded:Te}}function de(D,V){if(D=D.onError(V),D!=null&&typeof D!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof D+'" instead');return D}function Xe(D,V){var Q=D.onShellError;Q(V),Q=D.onFatalError,Q(V),D.destination!==null?(D.status=2,D.destination.destroy(V)):(D.status=1,D.fatalError=V)}function It(D,V,Q,ie,Be){for(On={},Sr=V,kn=0,D=Q(ie,Be);Qe;)Qe=!1,kn=0,dr+=1,Qt=null,D=Q(ie,Be);return ge(),D}function xn(D,V,Q,ie){var Be=Q.render(),Te=ie.childContextTypes;if(Te!=null){var We=V.legacyContext;if(typeof Q.getChildContext!="function")ie=We;else{Q=Q.getChildContext();for(var dt in Q)if(!(dt in Te))throw Error(e(108,Pt(ie)||"Unknown",dt));ie=H({},We,Q)}V.legacyContext=ie,Wt(D,V,Be),V.legacyContext=We}else Wt(D,V,Be)}function Ot(D,V){if(D&&D.defaultProps){V=H({},V),D=D.defaultProps;for(var Q in D)V[Q]===void 0&&(V[Q]=D[Q]);return V}return V}function wt(D,V,Q,ie,Be){if(typeof Q=="function")if(Q.prototype&&Q.prototype.isReactComponent){Be=on(Q,V.legacyContext);var Te=Q.contextType;Te=new Q(ie,typeof Te=="object"&&Te!==null?Te._currentValue2:Be),te(Te,Q,ie,Be),xn(D,V,Te,Q)}else{Te=on(Q,V.legacyContext),Be=It(D,V,Q,ie,Te);var We=kn!==0;if(typeof Be=="object"&&Be!==null&&typeof Be.render=="function"&&Be.$$typeof===void 0)te(Be,Q,ie,Te),xn(D,V,Be,Q);else if(We){ie=V.treeContext,V.treeContext=Pe(ie,1,0);try{Wt(D,V,Be)}finally{V.treeContext=ie}}else Wt(D,V,Be)}else if(typeof Q=="string"){switch(Be=V.blockedSegment,Te=ne(Be.chunks,Q,ie,D.responseState,Be.formatContext),Be.lastPushedText=!1,We=Be.formatContext,Be.formatContext=E(We,Q,ie),Yn(D,V,Te),Be.formatContext=We,Q){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Be.chunks.push("</",Q,">")}Be.lastPushedText=!1}else{switch(Q){case lt:case at:case Ee:case _e:case ye:Wt(D,V,ie.children);return;case Xt:Wt(D,V,ie.children);return;case Dt:throw Error(e(343));case Tt:e:{Q=V.blockedBoundary,Be=V.blockedSegment,Te=ie.fallback,ie=ie.children,We=new Set;var dt={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:We,errorDigest:null},mt=st(D,Be.chunks.length,dt,Be.formatContext,!1,!1);Be.children.push(mt),Be.lastPushedText=!1;var Kt=st(D,0,null,Be.formatContext,!1,!1);Kt.parentFlushed=!0,V.blockedBoundary=dt,V.blockedSegment=Kt;try{if(Yn(D,V,ie),D.responseState.generateStaticMarkup||Kt.lastPushedText&&Kt.textEmbedded&&Kt.chunks.push("<!-- -->"),Kt.status=1,tn(dt,Kt),dt.pendingTasks===0)break e}catch(sn){Kt.status=4,dt.forceClientRender=!0,dt.errorDigest=de(D,sn)}finally{V.blockedBoundary=Q,V.blockedSegment=Be}V=Cn(D,Te,Q,mt,We,V.legacyContext,V.context,V.treeContext),D.pingedTasks.push(V)}return}if(typeof Q=="object"&&Q!==null)switch(Q.$$typeof){case it:if(ie=It(D,V,Q.render,ie,Be),kn!==0){Q=V.treeContext,V.treeContext=Pe(Q,1,0);try{Wt(D,V,ie)}finally{V.treeContext=Q}}else Wt(D,V,ie);return;case Et:Q=Q.type,ie=Ot(Q,ie),wt(D,V,Q,ie,Be);return;case Je:if(Be=ie.children,Q=Q._context,ie=ie.value,Te=Q._currentValue2,Q._currentValue2=ie,We=ct,ct=ie={parent:We,depth:We===null?0:We.depth+1,context:Q,parentValue:Te,value:ie},V.context=ie,Wt(D,V,Be),D=ct,D===null)throw Error(e(403));ie=D.parentValue,D.context._currentValue2=ie===Vt?D.context._defaultValue:ie,D=ct=D.parent,V.context=D;return;case me:ie=ie.children,ie=ie(Q._currentValue2),Wt(D,V,ie);return;case St:Be=Q._init,Q=Be(Q._payload),ie=Ot(Q,ie),wt(D,V,Q,ie,void 0);return}throw Error(e(130,Q==null?Q:typeof Q,""))}}function Wt(D,V,Q){if(V.node=Q,typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case ee:wt(D,V,Q.type,Q.props,Q.ref);return;case ae:throw Error(e(257));case St:var ie=Q._init;Q=ie(Q._payload),Wt(D,V,Q);return}if(S(Q)){qn(D,V,Q);return}if(Q===null||typeof Q!="object"?ie=null:(ie=Gt&&Q[Gt]||Q["@@iterator"],ie=typeof ie=="function"?ie:null),ie&&(ie=ie.call(Q))){if(Q=ie.next(),!Q.done){var Be=[];do Be.push(Q.value),Q=ie.next();while(!Q.done);qn(D,V,Be)}return}throw D=Object.prototype.toString.call(Q),Error(e(31,D==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":D))}typeof Q=="string"?(ie=V.blockedSegment,ie.lastPushedText=ke(V.blockedSegment.chunks,Q,D.responseState,ie.lastPushedText)):typeof Q=="number"&&(ie=V.blockedSegment,ie.lastPushedText=ke(V.blockedSegment.chunks,""+Q,D.responseState,ie.lastPushedText))}function qn(D,V,Q){for(var ie=Q.length,Be=0;Be<ie;Be++){var Te=V.treeContext;V.treeContext=Pe(Te,ie,Be);try{Yn(D,V,Q[Be])}finally{V.treeContext=Te}}}function Yn(D,V,Q){var ie=V.blockedSegment.formatContext,Be=V.legacyContext,Te=V.context;try{return Wt(D,V,Q)}catch(mt){if(ge(),typeof mt=="object"&&mt!==null&&typeof mt.then=="function"){Q=mt;var We=V.blockedSegment,dt=st(D,We.chunks.length,null,We.formatContext,We.lastPushedText,!0);We.children.push(dt),We.lastPushedText=!1,D=Cn(D,V.node,V.blockedBoundary,dt,V.abortSet,V.legacyContext,V.context,V.treeContext).ping,Q.then(D,D),V.blockedSegment.formatContext=ie,V.legacyContext=Be,V.context=Te,N(Te)}else throw V.blockedSegment.formatContext=ie,V.legacyContext=Be,V.context=Te,N(Te),mt}}function tr(D){var V=D.blockedBoundary;D=D.blockedSegment,D.status=3,gn(this,V,D)}function Nn(D,V,Q){var ie=D.blockedBoundary;D.blockedSegment.status=3,ie===null?(V.allPendingTasks--,V.status!==2&&(V.status=2,V.destination!==null&&V.destination.push(null))):(ie.pendingTasks--,ie.forceClientRender||(ie.forceClientRender=!0,D=Q===void 0?Error(e(432)):Q,ie.errorDigest=V.onError(D),ie.parentFlushed&&V.clientRenderedBoundaries.push(ie)),ie.fallbackAbortableTasks.forEach(function(Be){return Nn(Be,V,Q)}),ie.fallbackAbortableTasks.clear(),V.allPendingTasks--,V.allPendingTasks===0&&(ie=V.onAllReady,ie()))}function tn(D,V){if(V.chunks.length===0&&V.children.length===1&&V.children[0].boundary===null){var Q=V.children[0];Q.id=V.id,Q.parentFlushed=!0,Q.status===1&&tn(D,Q)}else D.completedSegments.push(V)}function gn(D,V,Q){if(V===null){if(Q.parentFlushed){if(D.completedRootSegment!==null)throw Error(e(389));D.completedRootSegment=Q}D.pendingRootTasks--,D.pendingRootTasks===0&&(D.onShellError=ut,V=D.onShellReady,V())}else V.pendingTasks--,V.forceClientRender||(V.pendingTasks===0?(Q.parentFlushed&&Q.status===1&&tn(V,Q),V.parentFlushed&&D.completedBoundaries.push(V),V.fallbackAbortableTasks.forEach(tr,D),V.fallbackAbortableTasks.clear()):Q.parentFlushed&&Q.status===1&&(tn(V,Q),V.completedSegments.length===1&&V.parentFlushed&&D.partialBoundaries.push(V)));D.allPendingTasks--,D.allPendingTasks===0&&(D=D.onAllReady,D())}function nr(D){if(D.status!==2){var V=ct,Q=bt.current;bt.current=pt;var ie=gt;gt=D.responseState;try{var Be=D.pingedTasks,Te;for(Te=0;Te<Be.length;Te++){var We=Be[Te],dt=D,mt=We.blockedSegment;if(mt.status===0){N(We.context);try{Wt(dt,We,We.node),dt.responseState.generateStaticMarkup||mt.lastPushedText&&mt.textEmbedded&&mt.chunks.push("<!-- -->"),We.abortSet.delete(We),mt.status=1,gn(dt,We.blockedBoundary,mt)}catch(Jr){if(ge(),typeof Jr=="object"&&Jr!==null&&typeof Jr.then=="function"){var Kt=We.ping;Jr.then(Kt,Kt)}else{We.abortSet.delete(We),mt.status=4;var sn=We.blockedBoundary,Fn=Jr,Ci=de(dt,Fn);if(sn===null?Xe(dt,Fn):(sn.pendingTasks--,sn.forceClientRender||(sn.forceClientRender=!0,sn.errorDigest=Ci,sn.parentFlushed&&dt.clientRenderedBoundaries.push(sn))),dt.allPendingTasks--,dt.allPendingTasks===0){var xi=dt.onAllReady;xi()}}}finally{}}}Be.splice(0,Te),D.destination!==null&&Wi(D,D.destination)}catch(Jr){de(D,Jr),Xe(D,Jr)}finally{gt=ie,bt.current=Q,Q===pt&&N(V)}}}function ui(D,V,Q){switch(Q.parentFlushed=!0,Q.status){case 0:var ie=Q.id=D.nextSegmentId++;return Q.lastPushedText=!1,Q.textEmbedded=!1,D=D.responseState,V.push('<template id="'),V.push(D.placeholderPrefix),D=ie.toString(16),V.push(D),V.push('"></template>');case 1:Q.status=2;var Be=!0;ie=Q.chunks;var Te=0;Q=Q.children;for(var We=0;We<Q.length;We++){for(Be=Q[We];Te<Be.index;Te++)V.push(ie[Te]);Be=mn(D,V,Be)}for(;Te<ie.length-1;Te++)V.push(ie[Te]);return Te<ie.length&&(Be=V.push(ie[Te])),Be;default:throw Error(e(390))}}function mn(D,V,Q){var ie=Q.boundary;if(ie===null)return ui(D,V,Q);if(ie.parentFlushed=!0,ie.forceClientRender)return D.responseState.generateStaticMarkup||(ie=ie.errorDigest,V.push("<!--$!-->"),V.push("<template"),ie&&(V.push(' data-dgst="'),ie=C(ie),V.push(ie),V.push('"')),V.push("></template>")),ui(D,V,Q),D=D.responseState.generateStaticMarkup?!0:V.push("<!--/$-->"),D;if(0<ie.pendingTasks){ie.rootSegmentID=D.nextSegmentId++,0<ie.completedSegments.length&&D.partialBoundaries.push(ie);var Be=D.responseState,Te=Be.nextSuspenseID++;return Be=Be.boundaryPrefix+Te.toString(16),ie=ie.id=Be,pe(V,D.responseState,ie),ui(D,V,Q),V.push("<!--/$-->")}if(ie.byteSize>D.progressiveChunkSize)return ie.rootSegmentID=D.nextSegmentId++,D.completedBoundaries.push(ie),pe(V,D.responseState,ie.id),ui(D,V,Q),V.push("<!--/$-->");if(D.responseState.generateStaticMarkup||V.push("<!--$-->"),Q=ie.completedSegments,Q.length!==1)throw Error(e(391));return mn(D,V,Q[0]),D=D.responseState.generateStaticMarkup?!0:V.push("<!--/$-->"),D}function jr(D,V,Q){return ve(V,D.responseState,Q.formatContext,Q.id),mn(D,V,Q),Se(V,Q.formatContext)}function At(D,V,Q){for(var ie=Q.completedSegments,Be=0;Be<ie.length;Be++)Mo(D,V,Q,ie[Be]);if(ie.length=0,D=D.responseState,ie=Q.id,Q=Q.rootSegmentID,V.push(D.startInlineScript),D.sentCompleteBoundaryFunction?V.push('$RC("'):(D.sentCompleteBoundaryFunction=!0,V.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),ie===null)throw Error(e(395));return Q=Q.toString(16),V.push(ie),V.push('","'),V.push(D.segmentPrefix),V.push(Q),V.push('")<\/script>')}function Mo(D,V,Q,ie){if(ie.status===2)return!0;var Be=ie.id;if(Be===-1){if((ie.id=Q.rootSegmentID)===-1)throw Error(e(392));return jr(D,V,ie)}return jr(D,V,ie),D=D.responseState,V.push(D.startInlineScript),D.sentCompleteSegmentFunction?V.push('$RS("'):(D.sentCompleteSegmentFunction=!0,V.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),V.push(D.segmentPrefix),Be=Be.toString(16),V.push(Be),V.push('","'),V.push(D.placeholderPrefix),V.push(Be),V.push('")<\/script>')}function Wi(D,V){try{var Q=D.completedRootSegment;if(Q!==null&&D.pendingRootTasks===0){mn(D,V,Q),D.completedRootSegment=null;var ie=D.responseState.bootstrapChunks;for(Q=0;Q<ie.length-1;Q++)V.push(ie[Q]);Q<ie.length&&V.push(ie[Q])}var Be=D.clientRenderedBoundaries,Te;for(Te=0;Te<Be.length;Te++){var We=Be[Te];ie=V;var dt=D.responseState,mt=We.id,Kt=We.errorDigest,sn=We.errorMessage,Fn=We.errorComponentStack;if(ie.push(dt.startInlineScript),dt.sentClientRenderFunction?ie.push('$RX("'):(dt.sentClientRenderFunction=!0,ie.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),mt===null)throw Error(e(395));if(ie.push(mt),ie.push('"'),Kt||sn||Fn){ie.push(",");var Ci=xe(Kt||"");ie.push(Ci)}if(sn||Fn){ie.push(",");var xi=xe(sn||"");ie.push(xi)}if(Fn){ie.push(",");var Jr=xe(Fn);ie.push(Jr)}if(!ie.push(")<\/script>")){D.destination=null,Te++,Be.splice(0,Te);return}}Be.splice(0,Te);var bi=D.completedBoundaries;for(Te=0;Te<bi.length;Te++)if(!At(D,V,bi[Te])){D.destination=null,Te++,bi.splice(0,Te);return}bi.splice(0,Te);var Ii=D.partialBoundaries;for(Te=0;Te<Ii.length;Te++){var vr=Ii[Te];e:{Be=D,We=V;var ei=vr.completedSegments;for(dt=0;dt<ei.length;dt++)if(!Mo(Be,We,vr,ei[dt])){dt++,ei.splice(0,dt);var Qn=!1;break e}ei.splice(0,dt),Qn=!0}if(!Qn){D.destination=null,Te++,Ii.splice(0,Te);return}}Ii.splice(0,Te);var Gr=D.completedBoundaries;for(Te=0;Te<Gr.length;Te++)if(!At(D,V,Gr[Te])){D.destination=null,Te++,Gr.splice(0,Te);return}Gr.splice(0,Te)}finally{D.allPendingTasks===0&&D.pingedTasks.length===0&&D.clientRenderedBoundaries.length===0&&D.completedBoundaries.length===0&&V.push(null)}}function Hi(D,V){try{var Q=D.abortableTasks;Q.forEach(function(ie){return Nn(ie,D,V)}),Q.clear(),D.destination!==null&&Wi(D,D.destination)}catch(ie){de(D,ie),Xe(D,ie)}}function kt(){}function rn(D,V,Q,ie){var Be=!1,Te=null,We="",dt={push:function(Kt){return Kt!==null&&(We+=Kt),!0},destroy:function(Kt){Be=!0,Te=Kt}},mt=!1;if(D=He(D,Ae(Q,V?V.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,kt,void 0,function(){mt=!0}),nr(D),Hi(D,ie),D.status===1)D.status=2,dt.destroy(D.fatalError);else if(D.status!==2&&D.destination===null){D.destination=dt;try{Wi(D,dt)}catch(Kt){de(D,Kt),Xe(D,Kt)}}if(Be)throw Te;if(!mt)throw Error(e(426));return We}return el.renderToNodeStream=function(){throw Error(e(207))},el.renderToStaticMarkup=function(D,V){return rn(D,V,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},el.renderToStaticNodeStream=function(){throw Error(e(208))},el.renderToString=function(D,V){return rn(D,V,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},el.version="18.3.1",el}var Rh={},Pw;function S8(){if(Pw)return Rh;Pw=1;var n=mf();function e(R){for(var z="https://reactjs.org/docs/error-decoder.html?invariant="+R,Y=1;Y<arguments.length;Y++)z+="&args[]="+encodeURIComponent(arguments[Y]);return"Minified React error #"+R+"; visit "+z+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t=null,r=0;function i(R,z){if(z.length!==0)if(512<z.length)0<r&&(R.enqueue(new Uint8Array(t.buffer,0,r)),t=new Uint8Array(512),r=0),R.enqueue(z);else{var Y=t.length-r;Y<z.length&&(Y===0?R.enqueue(t):(t.set(z.subarray(0,Y),r),R.enqueue(t),z=z.subarray(Y)),t=new Uint8Array(512),r=0),t.set(z,r),r+=z.length}}function o(R,z){return i(R,z),!0}function a(R){t&&0<r&&(R.enqueue(new Uint8Array(t.buffer,0,r)),t=null,r=0)}var s=new TextEncoder;function l(R){return s.encode(R)}function f(R){return s.encode(R)}function h(R,z){typeof R.error=="function"?R.error(z):R.close()}var m=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},C={};function x(R){return m.call(C,R)?!0:m.call(y,R)?!1:g.test(R)?C[R]=!0:(y[R]=!0,!1)}function w(R,z,Y,re,Me,Re,Ke){this.acceptsBooleans=z===2||z===3||z===4,this.attributeName=re,this.attributeNamespace=Me,this.mustUseProperty=Y,this.propertyName=R,this.type=z,this.sanitizeURL=Re,this.removeEmptyString=Ke}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(R){S[R]=new w(R,0,!1,R,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(R){var z=R[0];S[z]=new w(z,1,!1,R[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(R){S[R]=new w(R,2,!1,R.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(R){S[R]=new w(R,2,!1,R,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(R){S[R]=new w(R,3,!1,R.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(R){S[R]=new w(R,3,!0,R,null,!1,!1)}),["capture","download"].forEach(function(R){S[R]=new w(R,4,!1,R,null,!1,!1)}),["cols","rows","size","span"].forEach(function(R){S[R]=new w(R,6,!1,R,null,!1,!1)}),["rowSpan","start"].forEach(function(R){S[R]=new w(R,5,!1,R.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function E(R){return R[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(R){var z=R.replace(A,E);S[z]=new w(z,1,!1,R,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(R){var z=R.replace(A,E);S[z]=new w(z,1,!1,R,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(R){var z=R.replace(A,E);S[z]=new w(z,1,!1,R,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(R){S[R]=new w(R,1,!1,R.toLowerCase(),null,!1,!1)}),S.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(R){S[R]=new w(R,1,!1,R.toLowerCase(),null,!0,!0)});var _={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},T=["Webkit","ms","Moz","O"];Object.keys(_).forEach(function(R){T.forEach(function(z){z=z+R.charAt(0).toUpperCase()+R.substring(1),_[z]=_[R]})});var M=/["'&<>]/;function P(R){if(typeof R=="boolean"||typeof R=="number")return""+R;R=""+R;var z=M.exec(R);if(z){var Y="",re,Me=0;for(re=z.index;re<R.length;re++){switch(R.charCodeAt(re)){case 34:z="&quot;";break;case 38:z="&amp;";break;case 39:z="&#x27;";break;case 60:z="&lt;";break;case 62:z="&gt;";break;default:continue}Me!==re&&(Y+=R.substring(Me,re)),Me=re+1,Y+=z}R=Me!==re?Y+R.substring(Me,re):Y}return R}var j=/([A-Z])/g,X=/^ms-/,L=Array.isArray,G=f("<script>"),Z=f("<\/script>"),ne=f('<script src="'),pe=f('<script type="module" src="'),ve=f('" async=""><\/script>'),Se=/(<\/|<)(s)(cript)/gi;function Ne(R,z,Y,re){return""+z+(Y==="s"?"\\u0073":"\\u0053")+re}function xe(R,z,Y,re,Me){R=R===void 0?"":R,z=z===void 0?G:f('<script nonce="'+P(z)+'">');var Re=[];if(Y!==void 0&&Re.push(z,l((""+Y).replace(Se,Ne)),Z),re!==void 0)for(Y=0;Y<re.length;Y++)Re.push(ne,l(P(re[Y])),ve);if(Me!==void 0)for(re=0;re<Me.length;re++)Re.push(pe,l(P(Me[re])),ve);return{bootstrapChunks:Re,startInlineScript:z,placeholderPrefix:f(R+"P:"),segmentPrefix:f(R+"S:"),boundaryPrefix:R+"B:",idPrefix:R,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function Ae(R,z){return{insertionMode:R,selectedValue:z}}function ke(R){return Ae(R==="http://www.w3.org/2000/svg"?2:R==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function H(R,z,Y){switch(z){case"select":return Ae(1,Y.value!=null?Y.value:Y.defaultValue);case"svg":return Ae(2,null);case"math":return Ae(3,null);case"foreignObject":return Ae(1,null);case"table":return Ae(4,null);case"thead":case"tbody":case"tfoot":return Ae(5,null);case"colgroup":return Ae(7,null);case"tr":return Ae(6,null)}return 4<=R.insertionMode||R.insertionMode===0?Ae(1,null):R}var ee=f("<!-- -->");function ae(R,z,Y,re){return z===""?re:(re&&R.push(ee),R.push(l(P(z))),!0)}var ye=new Map,Ee=f(' style="'),_e=f(":"),Je=f(";");function me(R,z,Y){if(typeof Y!="object")throw Error(e(62));z=!0;for(var re in Y)if(m.call(Y,re)){var Me=Y[re];if(Me!=null&&typeof Me!="boolean"&&Me!==""){if(re.indexOf("--")===0){var Re=l(P(re));Me=l(P((""+Me).trim()))}else{Re=re;var Ke=ye.get(Re);Ke!==void 0||(Ke=f(P(Re.replace(j,"-$1").toLowerCase().replace(X,"-ms-"))),ye.set(Re,Ke)),Re=Ke,Me=typeof Me=="number"?Me===0||m.call(_,re)?l(""+Me):l(Me+"px"):l(P((""+Me).trim()))}z?(z=!1,R.push(Ee,Re,_e,Me)):R.push(Je,Re,_e,Me)}}z||R.push(Xt)}var it=f(" "),Tt=f('="'),Xt=f('"'),Et=f('=""');function St(R,z,Y,re){switch(Y){case"style":me(R,z,re);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<Y.length)||Y[0]!=="o"&&Y[0]!=="O"||Y[1]!=="n"&&Y[1]!=="N"){if(z=S.hasOwnProperty(Y)?S[Y]:null,z!==null){switch(typeof re){case"function":case"symbol":return;case"boolean":if(!z.acceptsBooleans)return}switch(Y=l(z.attributeName),z.type){case 3:re&&R.push(it,Y,Et);break;case 4:re===!0?R.push(it,Y,Et):re!==!1&&R.push(it,Y,Tt,l(P(re)),Xt);break;case 5:isNaN(re)||R.push(it,Y,Tt,l(P(re)),Xt);break;case 6:!isNaN(re)&&1<=re&&R.push(it,Y,Tt,l(P(re)),Xt);break;default:z.sanitizeURL&&(re=""+re),R.push(it,Y,Tt,l(P(re)),Xt)}}else if(x(Y)){switch(typeof re){case"function":case"symbol":return;case"boolean":if(z=Y.toLowerCase().slice(0,5),z!=="data-"&&z!=="aria-")return}R.push(it,l(Y),Tt,l(P(re)),Xt)}}}var Dt=f(">"),at=f("/>");function lt(R,z,Y){if(z!=null){if(Y!=null)throw Error(e(60));if(typeof z!="object"||!("__html"in z))throw Error(e(61));z=z.__html,z!=null&&R.push(l(""+z))}}function Vt(R){var z="";return n.Children.forEach(R,function(Y){Y!=null&&(z+=Y)}),z}var Gt=f(' selected=""');function Pt(R,z,Y,re){R.push(ce(Y));var Me=Y=null,Re;for(Re in z)if(m.call(z,Re)){var Ke=z[Re];if(Ke!=null)switch(Re){case"children":Y=Ke;break;case"dangerouslySetInnerHTML":Me=Ke;break;default:St(R,re,Re,Ke)}}return R.push(Dt),lt(R,Me,Y),typeof Y=="string"?(R.push(l(P(Y))),null):Y}var Ht=f(`
`),on=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,ct=new Map;function ce(R){var z=ct.get(R);if(z===void 0){if(!on.test(R))throw Error(e(65,R));z=f("<"+R),ct.set(R,z)}return z}var nn=f("<!DOCTYPE html>");function pn(R,z,Y,re,Me){switch(z){case"select":R.push(ce("select"));var Re=null,Ke=null;for(Zt in Y)if(m.call(Y,Zt)){var et=Y[Zt];if(et!=null)switch(Zt){case"children":Re=et;break;case"dangerouslySetInnerHTML":Ke=et;break;case"defaultValue":case"value":break;default:St(R,re,Zt,et)}}return R.push(Dt),lt(R,Ke,Re),Re;case"option":Ke=Me.selectedValue,R.push(ce("option"));var $t=et=null,ln=null,Zt=null;for(Re in Y)if(m.call(Y,Re)){var jn=Y[Re];if(jn!=null)switch(Re){case"children":et=jn;break;case"selected":ln=jn;break;case"dangerouslySetInnerHTML":Zt=jn;break;case"value":$t=jn;default:St(R,re,Re,jn)}}if(Ke!=null)if(Y=$t!==null?""+$t:Vt(et),L(Ke)){for(re=0;re<Ke.length;re++)if(""+Ke[re]===Y){R.push(Gt);break}}else""+Ke===Y&&R.push(Gt);else ln&&R.push(Gt);return R.push(Dt),lt(R,Zt,et),et;case"textarea":R.push(ce("textarea")),Zt=Ke=Re=null;for(et in Y)if(m.call(Y,et)&&($t=Y[et],$t!=null))switch(et){case"children":Zt=$t;break;case"value":Re=$t;break;case"defaultValue":Ke=$t;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:St(R,re,et,$t)}if(Re===null&&Ke!==null&&(Re=Ke),R.push(Dt),Zt!=null){if(Re!=null)throw Error(e(92));if(L(Zt)&&1<Zt.length)throw Error(e(93));Re=""+Zt}return typeof Re=="string"&&Re[0]===`
`&&R.push(Ht),Re!==null&&R.push(l(P(""+Re))),null;case"input":R.push(ce("input")),$t=Zt=et=Re=null;for(Ke in Y)if(m.call(Y,Ke)&&(ln=Y[Ke],ln!=null))switch(Ke){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":$t=ln;break;case"defaultValue":et=ln;break;case"checked":Zt=ln;break;case"value":Re=ln;break;default:St(R,re,Ke,ln)}return Zt!==null?St(R,re,"checked",Zt):$t!==null&&St(R,re,"checked",$t),Re!==null?St(R,re,"value",Re):et!==null&&St(R,re,"value",et),R.push(at),null;case"menuitem":R.push(ce("menuitem"));for(var xr in Y)if(m.call(Y,xr)&&(Re=Y[xr],Re!=null))switch(xr){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:St(R,re,xr,Re)}return R.push(Dt),null;case"title":R.push(ce("title")),Re=null;for(jn in Y)if(m.call(Y,jn)&&(Ke=Y[jn],Ke!=null))switch(jn){case"children":Re=Ke;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:St(R,re,jn,Ke)}return R.push(Dt),Re;case"listing":case"pre":R.push(ce(z)),Ke=Re=null;for($t in Y)if(m.call(Y,$t)&&(et=Y[$t],et!=null))switch($t){case"children":Re=et;break;case"dangerouslySetInnerHTML":Ke=et;break;default:St(R,re,$t,et)}if(R.push(Dt),Ke!=null){if(Re!=null)throw Error(e(60));if(typeof Ke!="object"||!("__html"in Ke))throw Error(e(61));Y=Ke.__html,Y!=null&&(typeof Y=="string"&&0<Y.length&&Y[0]===`
`?R.push(Ht,l(Y)):R.push(l(""+Y)))}return typeof Re=="string"&&Re[0]===`
`&&R.push(Ht),Re;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":R.push(ce(z));for(var wi in Y)if(m.call(Y,wi)&&(Re=Y[wi],Re!=null))switch(wi){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,z));default:St(R,re,wi,Re)}return R.push(at),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Pt(R,Y,z,re);case"html":return Me.insertionMode===0&&R.push(nn),Pt(R,Y,z,re);default:if(z.indexOf("-")===-1&&typeof Y.is!="string")return Pt(R,Y,z,re);R.push(ce(z)),Ke=Re=null;for(ln in Y)if(m.call(Y,ln)&&(et=Y[ln],et!=null))switch(ln){case"children":Re=et;break;case"dangerouslySetInnerHTML":Ke=et;break;case"style":me(R,re,et);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:x(ln)&&typeof et!="function"&&typeof et!="symbol"&&R.push(it,l(ln),Tt,l(P(et)),Xt)}return R.push(Dt),lt(R,Ke,Re),Re}}var Un=f("</"),q=f(">"),N=f('<template id="'),F=f('"></template>'),te=f("<!--$-->"),Ce=f('<!--$?--><template id="'),Pe=f('"></template>'),Ge=f("<!--$!-->"),Lt=f("<!--/$-->"),fn=f("<template"),hn=f('"'),yn=f(' data-dgst="');f(' data-msg="'),f(' data-stck="');var un=f("></template>");function On(R,z,Y){if(i(R,Ce),Y===null)throw Error(e(395));return i(R,Y),o(R,Pe)}var Sr=f('<div hidden id="'),mr=f('">'),Qt=f("</div>"),Yr=f('<svg aria-hidden="true" style="display:none" id="'),Qe=f('">'),kn=f("</svg>"),zt=f('<math aria-hidden="true" style="display:none" id="'),dr=f('">'),Kn=f("</math>"),Qr=f('<table hidden id="'),Br=f('">'),ge=f("</table>"),Ie=f('<table hidden><tbody id="'),J=f('">'),Ve=f("</tbody></table>"),rt=f('<table hidden><tr id="'),_t=f('">'),Bt=f("</tr></table>"),pt=f('<table hidden><colgroup id="'),gt=f('">'),bt=f("</colgroup></table>");function Fe(R,z,Y,re){switch(Y.insertionMode){case 0:case 1:return i(R,Sr),i(R,z.segmentPrefix),i(R,l(re.toString(16))),o(R,mr);case 2:return i(R,Yr),i(R,z.segmentPrefix),i(R,l(re.toString(16))),o(R,Qe);case 3:return i(R,zt),i(R,z.segmentPrefix),i(R,l(re.toString(16))),o(R,dr);case 4:return i(R,Qr),i(R,z.segmentPrefix),i(R,l(re.toString(16))),o(R,Br);case 5:return i(R,Ie),i(R,z.segmentPrefix),i(R,l(re.toString(16))),o(R,J);case 6:return i(R,rt),i(R,z.segmentPrefix),i(R,l(re.toString(16))),o(R,_t);case 7:return i(R,pt),i(R,z.segmentPrefix),i(R,l(re.toString(16))),o(R,gt);default:throw Error(e(397))}}function ut(R,z){switch(z.insertionMode){case 0:case 1:return o(R,Qt);case 2:return o(R,kn);case 3:return o(R,Kn);case 4:return o(R,ge);case 5:return o(R,Ve);case 6:return o(R,Bt);case 7:return o(R,bt);default:throw Error(e(397))}}var He=f('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Cn=f('$RS("'),st=f('","'),de=f('")<\/script>'),Xe=f('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),It=f('$RC("'),xn=f('","'),Ot=f('")<\/script>'),wt=f('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),Wt=f('$RX("'),qn=f('"'),Yn=f(")<\/script>"),tr=f(","),Nn=/[<\u2028\u2029]/g;function tn(R){return JSON.stringify(R).replace(Nn,function(z){switch(z){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var gn=Object.assign,nr=Symbol.for("react.element"),ui=Symbol.for("react.portal"),mn=Symbol.for("react.fragment"),jr=Symbol.for("react.strict_mode"),At=Symbol.for("react.profiler"),Mo=Symbol.for("react.provider"),Wi=Symbol.for("react.context"),Hi=Symbol.for("react.forward_ref"),kt=Symbol.for("react.suspense"),rn=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),Q=Symbol.for("react.scope"),ie=Symbol.for("react.debug_trace_mode"),Be=Symbol.for("react.legacy_hidden"),Te=Symbol.for("react.default_value"),We=Symbol.iterator;function dt(R){if(R==null)return null;if(typeof R=="function")return R.displayName||R.name||null;if(typeof R=="string")return R;switch(R){case mn:return"Fragment";case ui:return"Portal";case At:return"Profiler";case jr:return"StrictMode";case kt:return"Suspense";case rn:return"SuspenseList"}if(typeof R=="object")switch(R.$$typeof){case Wi:return(R.displayName||"Context")+".Consumer";case Mo:return(R._context.displayName||"Context")+".Provider";case Hi:var z=R.render;return R=R.displayName,R||(R=z.displayName||z.name||"",R=R!==""?"ForwardRef("+R+")":"ForwardRef"),R;case D:return z=R.displayName||null,z!==null?z:dt(R.type)||"Memo";case V:z=R._payload,R=R._init;try{return dt(R(z))}catch{}}return null}var mt={};function Kt(R,z){if(R=R.contextTypes,!R)return mt;var Y={},re;for(re in R)Y[re]=z[re];return Y}var sn=null;function Fn(R,z){if(R!==z){R.context._currentValue=R.parentValue,R=R.parent;var Y=z.parent;if(R===null){if(Y!==null)throw Error(e(401))}else{if(Y===null)throw Error(e(401));Fn(R,Y)}z.context._currentValue=z.value}}function Ci(R){R.context._currentValue=R.parentValue,R=R.parent,R!==null&&Ci(R)}function xi(R){var z=R.parent;z!==null&&xi(z),R.context._currentValue=R.value}function Jr(R,z){if(R.context._currentValue=R.parentValue,R=R.parent,R===null)throw Error(e(402));R.depth===z.depth?Fn(R,z):Jr(R,z)}function bi(R,z){var Y=z.parent;if(Y===null)throw Error(e(402));R.depth===Y.depth?Fn(R,Y):bi(R,Y),z.context._currentValue=z.value}function Ii(R){var z=sn;z!==R&&(z===null?xi(R):R===null?Ci(z):z.depth===R.depth?Fn(z,R):z.depth>R.depth?Jr(z,R):bi(z,R),sn=R)}var vr={isMounted:function(){return!1},enqueueSetState:function(R,z){R=R._reactInternals,R.queue!==null&&R.queue.push(z)},enqueueReplaceState:function(R,z){R=R._reactInternals,R.replace=!0,R.queue=[z]},enqueueForceUpdate:function(){}};function ei(R,z,Y,re){var Me=R.state!==void 0?R.state:null;R.updater=vr,R.props=Y,R.state=Me;var Re={queue:[],replace:!1};R._reactInternals=Re;var Ke=z.contextType;if(R.context=typeof Ke=="object"&&Ke!==null?Ke._currentValue:re,Ke=z.getDerivedStateFromProps,typeof Ke=="function"&&(Ke=Ke(Y,Me),Me=Ke==null?Me:gn({},Me,Ke),R.state=Me),typeof z.getDerivedStateFromProps!="function"&&typeof R.getSnapshotBeforeUpdate!="function"&&(typeof R.UNSAFE_componentWillMount=="function"||typeof R.componentWillMount=="function"))if(z=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),z!==R.state&&vr.enqueueReplaceState(R,R.state,null),Re.queue!==null&&0<Re.queue.length)if(z=Re.queue,Ke=Re.replace,Re.queue=null,Re.replace=!1,Ke&&z.length===1)R.state=z[0];else{for(Re=Ke?z[0]:R.state,Me=!0,Ke=Ke?1:0;Ke<z.length;Ke++){var et=z[Ke];et=typeof et=="function"?et.call(R,Re,Y,re):et,et!=null&&(Me?(Me=!1,Re=gn({},Re,et)):gn(Re,et))}R.state=Re}else Re.queue=null}var Qn={id:1,overflow:""};function Gr(R,z,Y){var re=R.id;R=R.overflow;var Me=32-fo(re)-1;re&=~(1<<Me),Y+=1;var Re=32-fo(z)+Me;if(30<Re){var Ke=Me-Me%5;return Re=(re&(1<<Ke)-1).toString(32),re>>=Ke,Me-=Ke,{id:1<<32-fo(z)+Me|Y<<Me|re,overflow:Re+R}}return{id:1<<Re|Y<<Me|re,overflow:R}}var fo=Math.clz32?Math.clz32:po,ho=Math.log,sa=Math.LN2;function po(R){return R>>>=0,R===0?32:31-(ho(R)/sa|0)|0}function aa(R,z){return R===z&&(R!==0||1/R===1/z)||R!==R&&z!==z}var zu=typeof Object.is=="function"?Object.is:aa,Zi=null,Ko=null,ca=null,Ln=null,yr=!1,Ct=!1,di=0,rr=null,fi=0;function Xi(){if(Zi===null)throw Error(e(321));return Zi}function la(){if(0<fi)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function No(){return Ln===null?ca===null?(yr=!1,ca=Ln=la()):(yr=!0,Ln=ca):Ln.next===null?(yr=!1,Ln=Ln.next=la()):(yr=!0,Ln=Ln.next),Ln}function Ds(){Ko=Zi=null,Ct=!1,ca=null,fi=0,Ln=rr=null}function Ua(R,z){return typeof z=="function"?z(R):z}function Vn(R,z,Y){if(Zi=Xi(),Ln=No(),yr){var re=Ln.queue;if(z=re.dispatch,rr!==null&&(Y=rr.get(re),Y!==void 0)){rr.delete(re),re=Ln.memoizedState;do re=R(re,Y.action),Y=Y.next;while(Y!==null);return Ln.memoizedState=re,[re,z]}return[Ln.memoizedState,z]}return R=R===Ua?typeof z=="function"?z():z:Y!==void 0?Y(z):z,Ln.memoizedState=R,R=Ln.queue={last:null,dispatch:null},R=R.dispatch=Vr.bind(null,Zi,R),[Ln.memoizedState,R]}function cn(R,z){if(Zi=Xi(),Ln=No(),z=z===void 0?null:z,Ln!==null){var Y=Ln.memoizedState;if(Y!==null&&z!==null){var re=Y[1];e:if(re===null)re=!1;else{for(var Me=0;Me<re.length&&Me<z.length;Me++)if(!zu(z[Me],re[Me])){re=!1;break e}re=!0}if(re)return Y[0]}}return R=R(),Ln.memoizedState=[R,z],R}function Vr(R,z,Y){if(25<=fi)throw Error(e(301));if(R===Zi)if(Ct=!0,R={action:Y,next:null},rr===null&&(rr=new Map),Y=rr.get(z),Y===void 0)rr.set(z,R);else{for(z=Y;z.next!==null;)z=z.next;z.next=R}}function Nl(){throw Error(e(394))}function qo(){}var ua={readContext:function(R){return R._currentValue},useContext:function(R){return Xi(),R._currentValue},useMemo:cn,useReducer:Vn,useRef:function(R){Zi=Xi(),Ln=No();var z=Ln.memoizedState;return z===null?(R={current:R},Ln.memoizedState=R):z},useState:function(R){return Vn(Ua,R)},useInsertionEffect:qo,useLayoutEffect:function(){},useCallback:function(R,z){return cn(function(){return R},z)},useImperativeHandle:qo,useEffect:qo,useDebugValue:qo,useDeferredValue:function(R){return Xi(),R},useTransition:function(){return Xi(),[!1,Nl]},useId:function(){var R=Ko.treeContext,z=R.overflow;R=R.id,R=(R&~(1<<32-fo(R)-1)).toString(32)+z;var Y=da;if(Y===null)throw Error(e(404));return z=di++,R=":"+Y.idPrefix+"R"+R,0<z&&(R+="H"+z.toString(32)),R+":"},useMutableSource:function(R,z){return Xi(),z(R._source)},useSyncExternalStore:function(R,z,Y){if(Y===void 0)throw Error(e(407));return Y()}},da=null,zr=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Bo(R){return console.error(R),null}function go(){}function mo(R,z,Y,re,Me,Re,Ke,et,$t){var ln=[],Zt=new Set;return z={destination:null,responseState:z,progressiveChunkSize:re===void 0?12800:re,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Zt,pingedTasks:ln,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Me===void 0?Bo:Me,onAllReady:Re===void 0?go:Re,onShellReady:Ke===void 0?go:Ke,onShellError:et===void 0?go:et,onFatalError:$t===void 0?go:$t},Y=Ms(z,0,null,Y,!1,!1),Y.parentFlushed=!0,R=Oc(z,R,null,Y,Zt,mt,null,Qn),ln.push(R),z}function Oc(R,z,Y,re,Me,Re,Ke,et){R.allPendingTasks++,Y===null?R.pendingRootTasks++:Y.pendingTasks++;var $t={node:z,ping:function(){var ln=R.pingedTasks;ln.push($t),ln.length===1&&Fo(R)},blockedBoundary:Y,blockedSegment:re,abortSet:Me,legacyContext:Re,context:Ke,treeContext:et};return Me.add($t),$t}function Ms(R,z,Y,re,Me,Re){return{status:0,id:-1,index:z,parentFlushed:!1,chunks:[],children:[],formatContext:re,boundary:Y,lastPushedText:Me,textEmbedded:Re}}function Yo(R,z){if(R=R.onError(z),R!=null&&typeof R!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof R+'" instead');return R}function Oo(R,z){var Y=R.onShellError;Y(z),Y=R.onFatalError,Y(z),R.destination!==null?(R.status=2,h(R.destination,z)):(R.status=1,R.fatalError=z)}function Ns(R,z,Y,re,Me){for(Zi={},Ko=z,di=0,R=Y(re,Me);Ct;)Ct=!1,di=0,fi+=1,Ln=null,R=Y(re,Me);return Ds(),R}function Fc(R,z,Y,re){var Me=Y.render(),Re=re.childContextTypes;if(Re!=null){var Ke=z.legacyContext;if(typeof Y.getChildContext!="function")re=Ke;else{Y=Y.getChildContext();for(var et in Y)if(!(et in Re))throw Error(e(108,dt(re)||"Unknown",et));re=gn({},Ke,Y)}z.legacyContext=re,Wr(R,z,Me),z.legacyContext=Ke}else Wr(R,z,Me)}function ja(R,z){if(R&&R.defaultProps){z=gn({},z),R=R.defaultProps;for(var Y in R)z[Y]===void 0&&(z[Y]=R[Y]);return z}return z}function Lc(R,z,Y,re,Me){if(typeof Y=="function")if(Y.prototype&&Y.prototype.isReactComponent){Me=Kt(Y,z.legacyContext);var Re=Y.contextType;Re=new Y(re,typeof Re=="object"&&Re!==null?Re._currentValue:Me),ei(Re,Y,re,Me),Fc(R,z,Re,Y)}else{Re=Kt(Y,z.legacyContext),Me=Ns(R,z,Y,re,Re);var Ke=di!==0;if(typeof Me=="object"&&Me!==null&&typeof Me.render=="function"&&Me.$$typeof===void 0)ei(Me,Y,re,Re),Fc(R,z,Me,Y);else if(Ke){re=z.treeContext,z.treeContext=Gr(re,1,0);try{Wr(R,z,Me)}finally{z.treeContext=re}}else Wr(R,z,Me)}else if(typeof Y=="string"){switch(Me=z.blockedSegment,Re=pn(Me.chunks,Y,re,R.responseState,Me.formatContext),Me.lastPushedText=!1,Ke=Me.formatContext,Me.formatContext=H(Ke,Y,re),Uc(R,z,Re),Me.formatContext=Ke,Y){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Me.chunks.push(Un,l(Y),q)}Me.lastPushedText=!1}else{switch(Y){case Be:case ie:case jr:case At:case mn:Wr(R,z,re.children);return;case rn:Wr(R,z,re.children);return;case Q:throw Error(e(343));case kt:e:{Y=z.blockedBoundary,Me=z.blockedSegment,Re=re.fallback,re=re.children,Ke=new Set;var et={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:Ke,errorDigest:null},$t=Ms(R,Me.chunks.length,et,Me.formatContext,!1,!1);Me.children.push($t),Me.lastPushedText=!1;var ln=Ms(R,0,null,Me.formatContext,!1,!1);ln.parentFlushed=!0,z.blockedBoundary=et,z.blockedSegment=ln;try{if(Uc(R,z,re),ln.lastPushedText&&ln.textEmbedded&&ln.chunks.push(ee),ln.status=1,Ga(et,ln),et.pendingTasks===0)break e}catch(Zt){ln.status=4,et.forceClientRender=!0,et.errorDigest=Yo(R,Zt)}finally{z.blockedBoundary=Y,z.blockedSegment=Me}z=Oc(R,Re,Y,$t,Ke,z.legacyContext,z.context,z.treeContext),R.pingedTasks.push(z)}return}if(typeof Y=="object"&&Y!==null)switch(Y.$$typeof){case Hi:if(re=Ns(R,z,Y.render,re,Me),di!==0){Y=z.treeContext,z.treeContext=Gr(Y,1,0);try{Wr(R,z,re)}finally{z.treeContext=Y}}else Wr(R,z,re);return;case D:Y=Y.type,re=ja(Y,re),Lc(R,z,Y,re,Me);return;case Mo:if(Me=re.children,Y=Y._context,re=re.value,Re=Y._currentValue,Y._currentValue=re,Ke=sn,sn=re={parent:Ke,depth:Ke===null?0:Ke.depth+1,context:Y,parentValue:Re,value:re},z.context=re,Wr(R,z,Me),R=sn,R===null)throw Error(e(403));re=R.parentValue,R.context._currentValue=re===Te?R.context._defaultValue:re,R=sn=R.parent,z.context=R;return;case Wi:re=re.children,re=re(Y._currentValue),Wr(R,z,re);return;case V:Me=Y._init,Y=Me(Y._payload),re=ja(Y,re),Lc(R,z,Y,re,void 0);return}throw Error(e(130,Y==null?Y:typeof Y,""))}}function Wr(R,z,Y){if(z.node=Y,typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case nr:Lc(R,z,Y.type,Y.props,Y.ref);return;case ui:throw Error(e(257));case V:var re=Y._init;Y=re(Y._payload),Wr(R,z,Y);return}if(L(Y)){Ar(R,z,Y);return}if(Y===null||typeof Y!="object"?re=null:(re=We&&Y[We]||Y["@@iterator"],re=typeof re=="function"?re:null),re&&(re=re.call(Y))){if(Y=re.next(),!Y.done){var Me=[];do Me.push(Y.value),Y=re.next();while(!Y.done);Ar(R,z,Me)}return}throw R=Object.prototype.toString.call(Y),Error(e(31,R==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":R))}typeof Y=="string"?(re=z.blockedSegment,re.lastPushedText=ae(z.blockedSegment.chunks,Y,R.responseState,re.lastPushedText)):typeof Y=="number"&&(re=z.blockedSegment,re.lastPushedText=ae(z.blockedSegment.chunks,""+Y,R.responseState,re.lastPushedText))}function Ar(R,z,Y){for(var re=Y.length,Me=0;Me<re;Me++){var Re=z.treeContext;z.treeContext=Gr(Re,re,Me);try{Uc(R,z,Y[Me])}finally{z.treeContext=Re}}}function Uc(R,z,Y){var re=z.blockedSegment.formatContext,Me=z.legacyContext,Re=z.context;try{return Wr(R,z,Y)}catch($t){if(Ds(),typeof $t=="object"&&$t!==null&&typeof $t.then=="function"){Y=$t;var Ke=z.blockedSegment,et=Ms(R,Ke.chunks.length,null,Ke.formatContext,Ke.lastPushedText,!0);Ke.children.push(et),Ke.lastPushedText=!1,R=Oc(R,z.node,z.blockedBoundary,et,z.abortSet,z.legacyContext,z.context,z.treeContext).ping,Y.then(R,R),z.blockedSegment.formatContext=re,z.legacyContext=Me,z.context=Re,Ii(Re)}else throw z.blockedSegment.formatContext=re,z.legacyContext=Me,z.context=Re,Ii(Re),$t}}function Wu(R){var z=R.blockedBoundary;R=R.blockedSegment,R.status=3,Va(this,z,R)}function Bl(R,z,Y){var re=R.blockedBoundary;R.blockedSegment.status=3,re===null?(z.allPendingTasks--,z.status!==2&&(z.status=2,z.destination!==null&&z.destination.close())):(re.pendingTasks--,re.forceClientRender||(re.forceClientRender=!0,R=Y===void 0?Error(e(432)):Y,re.errorDigest=z.onError(R),re.parentFlushed&&z.clientRenderedBoundaries.push(re)),re.fallbackAbortableTasks.forEach(function(Me){return Bl(Me,z,Y)}),re.fallbackAbortableTasks.clear(),z.allPendingTasks--,z.allPendingTasks===0&&(re=z.onAllReady,re()))}function Ga(R,z){if(z.chunks.length===0&&z.children.length===1&&z.children[0].boundary===null){var Y=z.children[0];Y.id=z.id,Y.parentFlushed=!0,Y.status===1&&Ga(R,Y)}else R.completedSegments.push(z)}function Va(R,z,Y){if(z===null){if(Y.parentFlushed){if(R.completedRootSegment!==null)throw Error(e(389));R.completedRootSegment=Y}R.pendingRootTasks--,R.pendingRootTasks===0&&(R.onShellError=go,z=R.onShellReady,z())}else z.pendingTasks--,z.forceClientRender||(z.pendingTasks===0?(Y.parentFlushed&&Y.status===1&&Ga(z,Y),z.parentFlushed&&R.completedBoundaries.push(z),z.fallbackAbortableTasks.forEach(Wu,R),z.fallbackAbortableTasks.clear()):Y.parentFlushed&&Y.status===1&&(Ga(z,Y),z.completedSegments.length===1&&z.parentFlushed&&R.partialBoundaries.push(z)));R.allPendingTasks--,R.allPendingTasks===0&&(R=R.onAllReady,R())}function Fo(R){if(R.status!==2){var z=sn,Y=zr.current;zr.current=ua;var re=da;da=R.responseState;try{var Me=R.pingedTasks,Re;for(Re=0;Re<Me.length;Re++){var Ke=Me[Re],et=R,$t=Ke.blockedSegment;if($t.status===0){Ii(Ke.context);try{Wr(et,Ke,Ke.node),$t.lastPushedText&&$t.textEmbedded&&$t.chunks.push(ee),Ke.abortSet.delete(Ke),$t.status=1,Va(et,Ke.blockedBoundary,$t)}catch(Si){if(Ds(),typeof Si=="object"&&Si!==null&&typeof Si.then=="function"){var ln=Ke.ping;Si.then(ln,ln)}else{Ke.abortSet.delete(Ke),$t.status=4;var Zt=Ke.blockedBoundary,jn=Si,xr=Yo(et,jn);if(Zt===null?Oo(et,jn):(Zt.pendingTasks--,Zt.forceClientRender||(Zt.forceClientRender=!0,Zt.errorDigest=xr,Zt.parentFlushed&&et.clientRenderedBoundaries.push(Zt))),et.allPendingTasks--,et.allPendingTasks===0){var wi=et.onAllReady;wi()}}}finally{}}}Me.splice(0,Re),R.destination!==null&&Gc(R,R.destination)}catch(Si){Yo(R,Si),Oo(R,Si)}finally{da=re,zr.current=Y,Y===ua&&Ii(z)}}}function Bs(R,z,Y){switch(Y.parentFlushed=!0,Y.status){case 0:var re=Y.id=R.nextSegmentId++;return Y.lastPushedText=!1,Y.textEmbedded=!1,R=R.responseState,i(z,N),i(z,R.placeholderPrefix),R=l(re.toString(16)),i(z,R),o(z,F);case 1:Y.status=2;var Me=!0;re=Y.chunks;var Re=0;Y=Y.children;for(var Ke=0;Ke<Y.length;Ke++){for(Me=Y[Ke];Re<Me.index;Re++)i(z,re[Re]);Me=za(R,z,Me)}for(;Re<re.length-1;Re++)i(z,re[Re]);return Re<re.length&&(Me=o(z,re[Re])),Me;default:throw Error(e(390))}}function za(R,z,Y){var re=Y.boundary;if(re===null)return Bs(R,z,Y);if(re.parentFlushed=!0,re.forceClientRender)re=re.errorDigest,o(z,Ge),i(z,fn),re&&(i(z,yn),i(z,l(P(re))),i(z,hn)),o(z,un),Bs(R,z,Y);else if(0<re.pendingTasks){re.rootSegmentID=R.nextSegmentId++,0<re.completedSegments.length&&R.partialBoundaries.push(re);var Me=R.responseState,Re=Me.nextSuspenseID++;Me=f(Me.boundaryPrefix+Re.toString(16)),re=re.id=Me,On(z,R.responseState,re),Bs(R,z,Y)}else if(re.byteSize>R.progressiveChunkSize)re.rootSegmentID=R.nextSegmentId++,R.completedBoundaries.push(re),On(z,R.responseState,re.id),Bs(R,z,Y);else{if(o(z,te),Y=re.completedSegments,Y.length!==1)throw Error(e(391));za(R,z,Y[0])}return o(z,Lt)}function Ol(R,z,Y){return Fe(z,R.responseState,Y.formatContext,Y.id),za(R,z,Y),ut(z,Y.formatContext)}function jc(R,z,Y){for(var re=Y.completedSegments,Me=0;Me<re.length;Me++)Cr(R,z,Y,re[Me]);if(re.length=0,R=R.responseState,re=Y.id,Y=Y.rootSegmentID,i(z,R.startInlineScript),R.sentCompleteBoundaryFunction?i(z,It):(R.sentCompleteBoundaryFunction=!0,i(z,Xe)),re===null)throw Error(e(395));return Y=l(Y.toString(16)),i(z,re),i(z,xn),i(z,R.segmentPrefix),i(z,Y),o(z,Ot)}function Cr(R,z,Y,re){if(re.status===2)return!0;var Me=re.id;if(Me===-1){if((re.id=Y.rootSegmentID)===-1)throw Error(e(392));return Ol(R,z,re)}return Ol(R,z,re),R=R.responseState,i(z,R.startInlineScript),R.sentCompleteSegmentFunction?i(z,Cn):(R.sentCompleteSegmentFunction=!0,i(z,He)),i(z,R.segmentPrefix),Me=l(Me.toString(16)),i(z,Me),i(z,st),i(z,R.placeholderPrefix),i(z,Me),o(z,de)}function Gc(R,z){t=new Uint8Array(512),r=0;try{var Y=R.completedRootSegment;if(Y!==null&&R.pendingRootTasks===0){za(R,z,Y),R.completedRootSegment=null;var re=R.responseState.bootstrapChunks;for(Y=0;Y<re.length-1;Y++)i(z,re[Y]);Y<re.length&&o(z,re[Y])}var Me=R.clientRenderedBoundaries,Re;for(Re=0;Re<Me.length;Re++){var Ke=Me[Re];re=z;var et=R.responseState,$t=Ke.id,ln=Ke.errorDigest,Zt=Ke.errorMessage,jn=Ke.errorComponentStack;if(i(re,et.startInlineScript),et.sentClientRenderFunction?i(re,Wt):(et.sentClientRenderFunction=!0,i(re,wt)),$t===null)throw Error(e(395));i(re,$t),i(re,qn),(ln||Zt||jn)&&(i(re,tr),i(re,l(tn(ln||"")))),(Zt||jn)&&(i(re,tr),i(re,l(tn(Zt||"")))),jn&&(i(re,tr),i(re,l(tn(jn)))),o(re,Yn)}Me.splice(0,Re);var xr=R.completedBoundaries;for(Re=0;Re<xr.length;Re++)jc(R,z,xr[Re]);xr.splice(0,Re),a(z),t=new Uint8Array(512),r=0;var wi=R.partialBoundaries;for(Re=0;Re<wi.length;Re++){var Si=wi[Re];e:{Me=R,Ke=z;var $i=Si.completedSegments;for(et=0;et<$i.length;et++)if(!Cr(Me,Ke,Si,$i[et])){et++,$i.splice(0,et);var Wa=!1;break e}$i.splice(0,et),Wa=!0}if(!Wa){R.destination=null,Re++,wi.splice(0,Re);return}}wi.splice(0,Re);var Mi=R.completedBoundaries;for(Re=0;Re<Mi.length;Re++)jc(R,z,Mi[Re]);Mi.splice(0,Re)}finally{a(z),R.allPendingTasks===0&&R.pingedTasks.length===0&&R.clientRenderedBoundaries.length===0&&R.completedBoundaries.length===0&&z.close()}}function vo(R,z){try{var Y=R.abortableTasks;Y.forEach(function(re){return Bl(re,R,z)}),Y.clear(),R.destination!==null&&Gc(R,R.destination)}catch(re){Yo(R,re),Oo(R,re)}}return Rh.renderToReadableStream=function(R,z){return new Promise(function(Y,re){var Me,Re,Ke=new Promise(function(Zt,jn){Re=Zt,Me=jn}),et=mo(R,xe(z?z.identifierPrefix:void 0,z?z.nonce:void 0,z?z.bootstrapScriptContent:void 0,z?z.bootstrapScripts:void 0,z?z.bootstrapModules:void 0),ke(z?z.namespaceURI:void 0),z?z.progressiveChunkSize:void 0,z?z.onError:void 0,Re,function(){var Zt=new ReadableStream({type:"bytes",pull:function(jn){if(et.status===1)et.status=2,h(jn,et.fatalError);else if(et.status!==2&&et.destination===null){et.destination=jn;try{Gc(et,jn)}catch(xr){Yo(et,xr),Oo(et,xr)}}},cancel:function(){vo(et)}},{highWaterMark:0});Zt.allReady=Ke,Y(Zt)},function(Zt){Ke.catch(function(){}),re(Zt)},Me);if(z&&z.signal){var $t=z.signal,ln=function(){vo(et,$t.reason),$t.removeEventListener("abort",ln)};$t.addEventListener("abort",ln)}Fo(et)})},Rh.version="18.3.1",Rh}var Dw;function A8(){if(Dw)return sc;Dw=1;var n,e;return n=w8(),e=S8(),sc.version=n.version,sc.renderToString=n.renderToString,sc.renderToStaticMarkup=n.renderToStaticMarkup,sc.renderToNodeStream=n.renderToNodeStream,sc.renderToStaticNodeStream=n.renderToStaticNodeStream,sc.renderToReadableStream=e.renderToReadableStream,sc}var k8=A8();const E8=Ec(k8);/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:_E,setPrototypeOf:Mw,isFrozen:T8,getPrototypeOf:_8,getOwnPropertyDescriptor:R8}=Object;let{freeze:Vi,seal:Xo,create:RE}=Object,{apply:ny,construct:ry}=typeof Reflect<"u"&&Reflect;Vi||(Vi=function(e){return e});Xo||(Xo=function(e){return e});ny||(ny=function(e,t,r){return e.apply(t,r)});ry||(ry=function(e,t){return new e(...t)});const Ph=zi(Array.prototype.forEach),P8=zi(Array.prototype.lastIndexOf),Nw=zi(Array.prototype.pop),xd=zi(Array.prototype.push),D8=zi(Array.prototype.splice),D0=zi(String.prototype.toLowerCase),Gm=zi(String.prototype.toString),Bw=zi(String.prototype.match),bd=zi(String.prototype.replace),M8=zi(String.prototype.indexOf),N8=zi(String.prototype.trim),ss=zi(Object.prototype.hasOwnProperty),Oi=zi(RegExp.prototype.test),Id=B8(TypeError);function zi(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return ny(n,e,r)}}function B8(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ry(n,t)}}function Sn(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:D0;Mw&&Mw(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=t(i);o!==i&&(T8(e)||(e[r]=o),i=o)}n[i]=!0}return n}function O8(n){for(let e=0;e<n.length;e++)ss(n,e)||(n[e]=null);return n}function xa(n){const e=RE(null);for(const[t,r]of _E(n))ss(n,t)&&(Array.isArray(r)?e[t]=O8(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=xa(r):e[t]=r);return e}function wd(n,e){for(;n!==null;){const r=R8(n,e);if(r){if(r.get)return zi(r.get);if(typeof r.value=="function")return zi(r.value)}n=_8(n)}function t(){return null}return t}const Ow=Vi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Vm=Vi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),zm=Vi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),F8=Vi(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Wm=Vi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),L8=Vi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Fw=Vi(["#text"]),Lw=Vi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Hm=Vi(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Uw=Vi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Dh=Vi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),U8=Xo(/\{\{[\w\W]*|[\w\W]*\}\}/gm),j8=Xo(/<%[\w\W]*|[\w\W]*%>/gm),G8=Xo(/\$\{[\w\W]*/gm),V8=Xo(/^data-[\-\w.\u00B7-\uFFFF]+$/),z8=Xo(/^aria-[\-\w]+$/),PE=Xo(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),W8=Xo(/^(?:\w+script|data):/i),H8=Xo(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DE=Xo(/^html$/i),Z8=Xo(/^[a-z][.\w]*(-[.\w]+)+$/i);var jw=Object.freeze({__proto__:null,ARIA_ATTR:z8,ATTR_WHITESPACE:H8,CUSTOM_ELEMENT:Z8,DATA_ATTR:V8,DOCTYPE_NAME:DE,ERB_EXPR:j8,IS_ALLOWED_URI:PE,IS_SCRIPT_OR_DATA:W8,MUSTACHE_EXPR:U8,TMPLIT_EXPR:G8});const Sd={element:1,text:3,progressingInstruction:7,comment:8,document:9},X8=function(){return typeof window>"u"?null:window},$8=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Gw=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function ME(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:X8();const e=st=>ME(st);if(e.version="3.2.6",e.removed=[],!n||!n.document||n.document.nodeType!==Sd.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:a,Node:s,Element:l,NodeFilter:f,NamedNodeMap:h=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:m,DOMParser:g,trustedTypes:y}=n,C=l.prototype,x=wd(C,"cloneNode"),w=wd(C,"remove"),S=wd(C,"nextSibling"),A=wd(C,"childNodes"),E=wd(C,"parentNode");if(typeof a=="function"){const st=t.createElement("template");st.content&&st.content.ownerDocument&&(t=st.content.ownerDocument)}let _,T="";const{implementation:M,createNodeIterator:P,createDocumentFragment:j,getElementsByTagName:X}=t,{importNode:L}=r;let G=Gw();e.isSupported=typeof _E=="function"&&typeof E=="function"&&M&&M.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Z,ERB_EXPR:ne,TMPLIT_EXPR:pe,DATA_ATTR:ve,ARIA_ATTR:Se,IS_SCRIPT_OR_DATA:Ne,ATTR_WHITESPACE:xe,CUSTOM_ELEMENT:Ae}=jw;let{IS_ALLOWED_URI:ke}=jw,H=null;const ee=Sn({},[...Ow,...Vm,...zm,...Wm,...Fw]);let ae=null;const ye=Sn({},[...Lw,...Hm,...Uw,...Dh]);let Ee=Object.seal(RE(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),_e=null,Je=null,me=!0,it=!0,Tt=!1,Xt=!0,Et=!1,St=!0,Dt=!1,at=!1,lt=!1,Vt=!1,Gt=!1,Pt=!1,Ht=!0,on=!1;const ct="user-content-";let ce=!0,nn=!1,pn={},Un=null;const q=Sn({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let N=null;const F=Sn({},["audio","video","img","source","image","track"]);let te=null;const Ce=Sn({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Pe="http://www.w3.org/1998/Math/MathML",Ge="http://www.w3.org/2000/svg",Lt="http://www.w3.org/1999/xhtml";let fn=Lt,hn=!1,yn=null;const un=Sn({},[Pe,Ge,Lt],Gm);let On=Sn({},["mi","mo","mn","ms","mtext"]),Sr=Sn({},["annotation-xml"]);const mr=Sn({},["title","style","font","a","script"]);let Qt=null;const Yr=["application/xhtml+xml","text/html"],Qe="text/html";let kn=null,zt=null;const dr=t.createElement("form"),Kn=function(de){return de instanceof RegExp||de instanceof Function},Qr=function(){let de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(zt&&zt===de)){if((!de||typeof de!="object")&&(de={}),de=xa(de),Qt=Yr.indexOf(de.PARSER_MEDIA_TYPE)===-1?Qe:de.PARSER_MEDIA_TYPE,kn=Qt==="application/xhtml+xml"?Gm:D0,H=ss(de,"ALLOWED_TAGS")?Sn({},de.ALLOWED_TAGS,kn):ee,ae=ss(de,"ALLOWED_ATTR")?Sn({},de.ALLOWED_ATTR,kn):ye,yn=ss(de,"ALLOWED_NAMESPACES")?Sn({},de.ALLOWED_NAMESPACES,Gm):un,te=ss(de,"ADD_URI_SAFE_ATTR")?Sn(xa(Ce),de.ADD_URI_SAFE_ATTR,kn):Ce,N=ss(de,"ADD_DATA_URI_TAGS")?Sn(xa(F),de.ADD_DATA_URI_TAGS,kn):F,Un=ss(de,"FORBID_CONTENTS")?Sn({},de.FORBID_CONTENTS,kn):q,_e=ss(de,"FORBID_TAGS")?Sn({},de.FORBID_TAGS,kn):xa({}),Je=ss(de,"FORBID_ATTR")?Sn({},de.FORBID_ATTR,kn):xa({}),pn=ss(de,"USE_PROFILES")?de.USE_PROFILES:!1,me=de.ALLOW_ARIA_ATTR!==!1,it=de.ALLOW_DATA_ATTR!==!1,Tt=de.ALLOW_UNKNOWN_PROTOCOLS||!1,Xt=de.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Et=de.SAFE_FOR_TEMPLATES||!1,St=de.SAFE_FOR_XML!==!1,Dt=de.WHOLE_DOCUMENT||!1,Vt=de.RETURN_DOM||!1,Gt=de.RETURN_DOM_FRAGMENT||!1,Pt=de.RETURN_TRUSTED_TYPE||!1,lt=de.FORCE_BODY||!1,Ht=de.SANITIZE_DOM!==!1,on=de.SANITIZE_NAMED_PROPS||!1,ce=de.KEEP_CONTENT!==!1,nn=de.IN_PLACE||!1,ke=de.ALLOWED_URI_REGEXP||PE,fn=de.NAMESPACE||Lt,On=de.MATHML_TEXT_INTEGRATION_POINTS||On,Sr=de.HTML_INTEGRATION_POINTS||Sr,Ee=de.CUSTOM_ELEMENT_HANDLING||{},de.CUSTOM_ELEMENT_HANDLING&&Kn(de.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ee.tagNameCheck=de.CUSTOM_ELEMENT_HANDLING.tagNameCheck),de.CUSTOM_ELEMENT_HANDLING&&Kn(de.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ee.attributeNameCheck=de.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),de.CUSTOM_ELEMENT_HANDLING&&typeof de.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ee.allowCustomizedBuiltInElements=de.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Et&&(it=!1),Gt&&(Vt=!0),pn&&(H=Sn({},Fw),ae=[],pn.html===!0&&(Sn(H,Ow),Sn(ae,Lw)),pn.svg===!0&&(Sn(H,Vm),Sn(ae,Hm),Sn(ae,Dh)),pn.svgFilters===!0&&(Sn(H,zm),Sn(ae,Hm),Sn(ae,Dh)),pn.mathMl===!0&&(Sn(H,Wm),Sn(ae,Uw),Sn(ae,Dh))),de.ADD_TAGS&&(H===ee&&(H=xa(H)),Sn(H,de.ADD_TAGS,kn)),de.ADD_ATTR&&(ae===ye&&(ae=xa(ae)),Sn(ae,de.ADD_ATTR,kn)),de.ADD_URI_SAFE_ATTR&&Sn(te,de.ADD_URI_SAFE_ATTR,kn),de.FORBID_CONTENTS&&(Un===q&&(Un=xa(Un)),Sn(Un,de.FORBID_CONTENTS,kn)),ce&&(H["#text"]=!0),Dt&&Sn(H,["html","head","body"]),H.table&&(Sn(H,["tbody"]),delete _e.tbody),de.TRUSTED_TYPES_POLICY){if(typeof de.TRUSTED_TYPES_POLICY.createHTML!="function")throw Id('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof de.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Id('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=de.TRUSTED_TYPES_POLICY,T=_.createHTML("")}else _===void 0&&(_=$8(y,i)),_!==null&&typeof T=="string"&&(T=_.createHTML(""));Vi&&Vi(de),zt=de}},Br=Sn({},[...Vm,...zm,...F8]),ge=Sn({},[...Wm,...L8]),Ie=function(de){let Xe=E(de);(!Xe||!Xe.tagName)&&(Xe={namespaceURI:fn,tagName:"template"});const It=D0(de.tagName),xn=D0(Xe.tagName);return yn[de.namespaceURI]?de.namespaceURI===Ge?Xe.namespaceURI===Lt?It==="svg":Xe.namespaceURI===Pe?It==="svg"&&(xn==="annotation-xml"||On[xn]):!!Br[It]:de.namespaceURI===Pe?Xe.namespaceURI===Lt?It==="math":Xe.namespaceURI===Ge?It==="math"&&Sr[xn]:!!ge[It]:de.namespaceURI===Lt?Xe.namespaceURI===Ge&&!Sr[xn]||Xe.namespaceURI===Pe&&!On[xn]?!1:!ge[It]&&(mr[It]||!Br[It]):!!(Qt==="application/xhtml+xml"&&yn[de.namespaceURI]):!1},J=function(de){xd(e.removed,{element:de});try{E(de).removeChild(de)}catch{w(de)}},Ve=function(de,Xe){try{xd(e.removed,{attribute:Xe.getAttributeNode(de),from:Xe})}catch{xd(e.removed,{attribute:null,from:Xe})}if(Xe.removeAttribute(de),de==="is")if(Vt||Gt)try{J(Xe)}catch{}else try{Xe.setAttribute(de,"")}catch{}},rt=function(de){let Xe=null,It=null;if(lt)de="<remove></remove>"+de;else{const wt=Bw(de,/^[\r\n\t ]+/);It=wt&&wt[0]}Qt==="application/xhtml+xml"&&fn===Lt&&(de='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+de+"</body></html>");const xn=_?_.createHTML(de):de;if(fn===Lt)try{Xe=new g().parseFromString(xn,Qt)}catch{}if(!Xe||!Xe.documentElement){Xe=M.createDocument(fn,"template",null);try{Xe.documentElement.innerHTML=hn?T:xn}catch{}}const Ot=Xe.body||Xe.documentElement;return de&&It&&Ot.insertBefore(t.createTextNode(It),Ot.childNodes[0]||null),fn===Lt?X.call(Xe,Dt?"html":"body")[0]:Dt?Xe.documentElement:Ot},_t=function(de){return P.call(de.ownerDocument||de,de,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},Bt=function(de){return de instanceof m&&(typeof de.nodeName!="string"||typeof de.textContent!="string"||typeof de.removeChild!="function"||!(de.attributes instanceof h)||typeof de.removeAttribute!="function"||typeof de.setAttribute!="function"||typeof de.namespaceURI!="string"||typeof de.insertBefore!="function"||typeof de.hasChildNodes!="function")},pt=function(de){return typeof s=="function"&&de instanceof s};function gt(st,de,Xe){Ph(st,It=>{It.call(e,de,Xe,zt)})}const bt=function(de){let Xe=null;if(gt(G.beforeSanitizeElements,de,null),Bt(de))return J(de),!0;const It=kn(de.nodeName);if(gt(G.uponSanitizeElement,de,{tagName:It,allowedTags:H}),St&&de.hasChildNodes()&&!pt(de.firstElementChild)&&Oi(/<[/\w!]/g,de.innerHTML)&&Oi(/<[/\w!]/g,de.textContent)||de.nodeType===Sd.progressingInstruction||St&&de.nodeType===Sd.comment&&Oi(/<[/\w]/g,de.data))return J(de),!0;if(!H[It]||_e[It]){if(!_e[It]&&ut(It)&&(Ee.tagNameCheck instanceof RegExp&&Oi(Ee.tagNameCheck,It)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(It)))return!1;if(ce&&!Un[It]){const xn=E(de)||de.parentNode,Ot=A(de)||de.childNodes;if(Ot&&xn){const wt=Ot.length;for(let Wt=wt-1;Wt>=0;--Wt){const qn=x(Ot[Wt],!0);qn.__removalCount=(de.__removalCount||0)+1,xn.insertBefore(qn,S(de))}}}return J(de),!0}return de instanceof l&&!Ie(de)||(It==="noscript"||It==="noembed"||It==="noframes")&&Oi(/<\/no(script|embed|frames)/i,de.innerHTML)?(J(de),!0):(Et&&de.nodeType===Sd.text&&(Xe=de.textContent,Ph([Z,ne,pe],xn=>{Xe=bd(Xe,xn," ")}),de.textContent!==Xe&&(xd(e.removed,{element:de.cloneNode()}),de.textContent=Xe)),gt(G.afterSanitizeElements,de,null),!1)},Fe=function(de,Xe,It){if(Ht&&(Xe==="id"||Xe==="name")&&(It in t||It in dr))return!1;if(!(it&&!Je[Xe]&&Oi(ve,Xe))){if(!(me&&Oi(Se,Xe))){if(!ae[Xe]||Je[Xe]){if(!(ut(de)&&(Ee.tagNameCheck instanceof RegExp&&Oi(Ee.tagNameCheck,de)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(de))&&(Ee.attributeNameCheck instanceof RegExp&&Oi(Ee.attributeNameCheck,Xe)||Ee.attributeNameCheck instanceof Function&&Ee.attributeNameCheck(Xe))||Xe==="is"&&Ee.allowCustomizedBuiltInElements&&(Ee.tagNameCheck instanceof RegExp&&Oi(Ee.tagNameCheck,It)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(It))))return!1}else if(!te[Xe]){if(!Oi(ke,bd(It,xe,""))){if(!((Xe==="src"||Xe==="xlink:href"||Xe==="href")&&de!=="script"&&M8(It,"data:")===0&&N[de])){if(!(Tt&&!Oi(Ne,bd(It,xe,"")))){if(It)return!1}}}}}}return!0},ut=function(de){return de!=="annotation-xml"&&Bw(de,Ae)},He=function(de){gt(G.beforeSanitizeAttributes,de,null);const{attributes:Xe}=de;if(!Xe||Bt(de))return;const It={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ae,forceKeepAttr:void 0};let xn=Xe.length;for(;xn--;){const Ot=Xe[xn],{name:wt,namespaceURI:Wt,value:qn}=Ot,Yn=kn(wt),tr=qn;let Nn=wt==="value"?tr:N8(tr);if(It.attrName=Yn,It.attrValue=Nn,It.keepAttr=!0,It.forceKeepAttr=void 0,gt(G.uponSanitizeAttribute,de,It),Nn=It.attrValue,on&&(Yn==="id"||Yn==="name")&&(Ve(wt,de),Nn=ct+Nn),St&&Oi(/((--!?|])>)|<\/(style|title)/i,Nn)){Ve(wt,de);continue}if(It.forceKeepAttr)continue;if(!It.keepAttr){Ve(wt,de);continue}if(!Xt&&Oi(/\/>/i,Nn)){Ve(wt,de);continue}Et&&Ph([Z,ne,pe],gn=>{Nn=bd(Nn,gn," ")});const tn=kn(de.nodeName);if(!Fe(tn,Yn,Nn)){Ve(wt,de);continue}if(_&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!Wt)switch(y.getAttributeType(tn,Yn)){case"TrustedHTML":{Nn=_.createHTML(Nn);break}case"TrustedScriptURL":{Nn=_.createScriptURL(Nn);break}}if(Nn!==tr)try{Wt?de.setAttributeNS(Wt,wt,Nn):de.setAttribute(wt,Nn),Bt(de)?J(de):Nw(e.removed)}catch{Ve(wt,de)}}gt(G.afterSanitizeAttributes,de,null)},Cn=function st(de){let Xe=null;const It=_t(de);for(gt(G.beforeSanitizeShadowDOM,de,null);Xe=It.nextNode();)gt(G.uponSanitizeShadowNode,Xe,null),bt(Xe),He(Xe),Xe.content instanceof o&&st(Xe.content);gt(G.afterSanitizeShadowDOM,de,null)};return e.sanitize=function(st){let de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Xe=null,It=null,xn=null,Ot=null;if(hn=!st,hn&&(st="<!-->"),typeof st!="string"&&!pt(st))if(typeof st.toString=="function"){if(st=st.toString(),typeof st!="string")throw Id("dirty is not a string, aborting")}else throw Id("toString is not a function");if(!e.isSupported)return st;if(at||Qr(de),e.removed=[],typeof st=="string"&&(nn=!1),nn){if(st.nodeName){const qn=kn(st.nodeName);if(!H[qn]||_e[qn])throw Id("root node is forbidden and cannot be sanitized in-place")}}else if(st instanceof s)Xe=rt("<!---->"),It=Xe.ownerDocument.importNode(st,!0),It.nodeType===Sd.element&&It.nodeName==="BODY"||It.nodeName==="HTML"?Xe=It:Xe.appendChild(It);else{if(!Vt&&!Et&&!Dt&&st.indexOf("<")===-1)return _&&Pt?_.createHTML(st):st;if(Xe=rt(st),!Xe)return Vt?null:Pt?T:""}Xe&&lt&&J(Xe.firstChild);const wt=_t(nn?st:Xe);for(;xn=wt.nextNode();)bt(xn),He(xn),xn.content instanceof o&&Cn(xn.content);if(nn)return st;if(Vt){if(Gt)for(Ot=j.call(Xe.ownerDocument);Xe.firstChild;)Ot.appendChild(Xe.firstChild);else Ot=Xe;return(ae.shadowroot||ae.shadowrootmode)&&(Ot=L.call(r,Ot,!0)),Ot}let Wt=Dt?Xe.outerHTML:Xe.innerHTML;return Dt&&H["!doctype"]&&Xe.ownerDocument&&Xe.ownerDocument.doctype&&Xe.ownerDocument.doctype.name&&Oi(DE,Xe.ownerDocument.doctype.name)&&(Wt="<!DOCTYPE "+Xe.ownerDocument.doctype.name+`>
`+Wt),Et&&Ph([Z,ne,pe],qn=>{Wt=bd(Wt,qn," ")}),_&&Pt?_.createHTML(Wt):Wt},e.setConfig=function(){let st=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Qr(st),at=!0},e.clearConfig=function(){zt=null,at=!1},e.isValidAttribute=function(st,de,Xe){zt||Qr({});const It=kn(st),xn=kn(de);return Fe(It,xn,Xe)},e.addHook=function(st,de){typeof de=="function"&&xd(G[st],de)},e.removeHook=function(st,de){if(de!==void 0){const Xe=P8(G[st],de);return Xe===-1?void 0:D8(G[st],Xe,1)[0]}return Nw(G[st])},e.removeHooks=function(st){G[st]=[]},e.removeAllHooks=function(){G=Gw()},e}var Vw=ME();function K8(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])}return n}function iy(n,e){return Array(e+1).join(n)}function q8(n){return n.replace(/^\n*/,"")}function Y8(n){for(var e=n.length;e>0&&n[e-1]===`
`;)e--;return n.substring(0,e)}var Q8=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function EC(n){return TC(n,Q8)}var NE=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function BE(n){return TC(n,NE)}function J8(n){return FE(n,NE)}var OE=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function eL(n){return TC(n,OE)}function tL(n){return FE(n,OE)}function TC(n,e){return e.indexOf(n.nodeName)>=0}function FE(n,e){return n.getElementsByTagName&&e.some(function(t){return n.getElementsByTagName(t).length})}var Di={};Di.paragraph={filter:"p",replacement:function(n){return`

`+n+`

`}};Di.lineBreak={filter:"br",replacement:function(n,e,t){return t.br+`
`}};Di.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(n,e,t){var r=Number(e.nodeName.charAt(1));if(t.headingStyle==="setext"&&r<3){var i=iy(r===1?"=":"-",n.length);return`

`+n+`
`+i+`

`}else return`

`+iy("#",r)+" "+n+`

`}};Di.blockquote={filter:"blockquote",replacement:function(n){return n=n.replace(/^\n+|\n+$/g,""),n=n.replace(/^/gm,"> "),`

`+n+`

`}};Di.list={filter:["ul","ol"],replacement:function(n,e){var t=e.parentNode;return t.nodeName==="LI"&&t.lastElementChild===e?`
`+n:`

`+n+`

`}};Di.listItem={filter:"li",replacement:function(n,e,t){n=n.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var r=t.bulletListMarker+"   ",i=e.parentNode;if(i.nodeName==="OL"){var o=i.getAttribute("start"),a=Array.prototype.indexOf.call(i.children,e);r=(o?Number(o)+a:a+1)+".  "}return r+n+(e.nextSibling&&!/\n$/.test(n)?`
`:"")}};Di.indentedCodeBlock={filter:function(n,e){return e.codeBlockStyle==="indented"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,e,t){return`

    `+e.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};Di.fencedCodeBlock={filter:function(n,e){return e.codeBlockStyle==="fenced"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,e,t){for(var r=e.firstChild.getAttribute("class")||"",i=(r.match(/language-(\S+)/)||[null,""])[1],o=e.firstChild.textContent,a=t.fence.charAt(0),s=3,l=new RegExp("^"+a+"{3,}","gm"),f;f=l.exec(o);)f[0].length>=s&&(s=f[0].length+1);var h=iy(a,s);return`

`+h+i+`
`+o.replace(/\n$/,"")+`
`+h+`

`}};Di.horizontalRule={filter:"hr",replacement:function(n,e,t){return`

`+t.hr+`

`}};Di.inlineLink={filter:function(n,e){return e.linkStyle==="inlined"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,e){var t=e.getAttribute("href");t&&(t=t.replace(/([()])/g,"\\$1"));var r=cp(e.getAttribute("title"));return r&&(r=' "'+r.replace(/"/g,'\\"')+'"'),"["+n+"]("+t+r+")"}};Di.referenceLink={filter:function(n,e){return e.linkStyle==="referenced"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,e,t){var r=e.getAttribute("href"),i=cp(e.getAttribute("title"));i&&(i=' "'+i+'"');var o,a;switch(t.linkReferenceStyle){case"collapsed":o="["+n+"][]",a="["+n+"]: "+r+i;break;case"shortcut":o="["+n+"]",a="["+n+"]: "+r+i;break;default:var s=this.references.length+1;o="["+n+"]["+s+"]",a="["+s+"]: "+r+i}return this.references.push(a),o},references:[],append:function(n){var e="";return this.references.length&&(e=`

`+this.references.join(`
`)+`

`,this.references=[]),e}};Di.emphasis={filter:["em","i"],replacement:function(n,e,t){return n.trim()?t.emDelimiter+n+t.emDelimiter:""}};Di.strong={filter:["strong","b"],replacement:function(n,e,t){return n.trim()?t.strongDelimiter+n+t.strongDelimiter:""}};Di.code={filter:function(n){var e=n.previousSibling||n.nextSibling,t=n.parentNode.nodeName==="PRE"&&!e;return n.nodeName==="CODE"&&!t},replacement:function(n){if(!n)return"";n=n.replace(/\r?\n|\r/g," ");for(var e=/^`|^ .*?[^ ].* $|`$/.test(n)?" ":"",t="`",r=n.match(/`+/gm)||[];r.indexOf(t)!==-1;)t=t+"`";return t+e+n+e+t}};Di.image={filter:"img",replacement:function(n,e){var t=cp(e.getAttribute("alt")),r=e.getAttribute("src")||"",i=cp(e.getAttribute("title")),o=i?' "'+i+'"':"";return r?"!["+t+"]("+r+o+")":""}};function cp(n){return n?n.replace(/(\n+\s*)+/g,`
`):""}function LE(n){this.options=n,this._keep=[],this._remove=[],this.blankRule={replacement:n.blankReplacement},this.keepReplacement=n.keepReplacement,this.defaultRule={replacement:n.defaultReplacement},this.array=[];for(var e in n.rules)this.array.push(n.rules[e])}LE.prototype={add:function(n,e){this.array.unshift(e)},keep:function(n){this._keep.unshift({filter:n,replacement:this.keepReplacement})},remove:function(n){this._remove.unshift({filter:n,replacement:function(){return""}})},forNode:function(n){if(n.isBlank)return this.blankRule;var e;return(e=Zm(this.array,n,this.options))||(e=Zm(this._keep,n,this.options))||(e=Zm(this._remove,n,this.options))?e:this.defaultRule},forEach:function(n){for(var e=0;e<this.array.length;e++)n(this.array[e],e)}};function Zm(n,e,t){for(var r=0;r<n.length;r++){var i=n[r];if(nL(i,e,t))return i}}function nL(n,e,t){var r=n.filter;if(typeof r=="string"){if(r===e.nodeName.toLowerCase())return!0}else if(Array.isArray(r)){if(r.indexOf(e.nodeName.toLowerCase())>-1)return!0}else if(typeof r=="function"){if(r.call(n,e,t))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function rL(n){var e=n.element,t=n.isBlock,r=n.isVoid,i=n.isPre||function(m){return m.nodeName==="PRE"};if(!(!e.firstChild||i(e))){for(var o=null,a=!1,s=null,l=zw(s,e,i);l!==e;){if(l.nodeType===3||l.nodeType===4){var f=l.data.replace(/[ \r\n\t]+/g," ");if((!o||/ $/.test(o.data))&&!a&&f[0]===" "&&(f=f.substr(1)),!f){l=Xm(l);continue}l.data=f,o=l}else if(l.nodeType===1)t(l)||l.nodeName==="BR"?(o&&(o.data=o.data.replace(/ $/,"")),o=null,a=!1):r(l)||i(l)?(o=null,a=!0):o&&(a=!1);else{l=Xm(l);continue}var h=zw(s,l,i);s=l,l=h}o&&(o.data=o.data.replace(/ $/,""),o.data||Xm(o))}}function Xm(n){var e=n.nextSibling||n.parentNode;return n.parentNode.removeChild(n),e}function zw(n,e,t){return n&&n.parentNode===e||t(e)?e.nextSibling||e.parentNode:e.firstChild||e.nextSibling||e.parentNode}var _C=typeof window<"u"?window:{};function iL(){var n=_C.DOMParser,e=!1;try{new n().parseFromString("","text/html")&&(e=!0)}catch{}return e}function oL(){var n=function(){};return sL()?n.prototype.parseFromString=function(e){var t=new window.ActiveXObject("htmlfile");return t.designMode="on",t.open(),t.write(e),t.close(),t}:n.prototype.parseFromString=function(e){var t=document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),t},n}function sL(){var n=!1;try{document.implementation.createHTMLDocument("").open()}catch{_C.ActiveXObject&&(n=!0)}return n}var aL=iL()?_C.DOMParser:oL();function cL(n,e){var t;if(typeof n=="string"){var r=lL().parseFromString('<x-turndown id="turndown-root">'+n+"</x-turndown>","text/html");t=r.getElementById("turndown-root")}else t=n.cloneNode(!0);return rL({element:t,isBlock:EC,isVoid:BE,isPre:e.preformattedCode?uL:null}),t}var $m;function lL(){return $m=$m||new aL,$m}function uL(n){return n.nodeName==="PRE"||n.nodeName==="CODE"}function dL(n,e){return n.isBlock=EC(n),n.isCode=n.nodeName==="CODE"||n.parentNode.isCode,n.isBlank=fL(n),n.flankingWhitespace=hL(n,e),n}function fL(n){return!BE(n)&&!eL(n)&&/^\s*$/i.test(n.textContent)&&!J8(n)&&!tL(n)}function hL(n,e){if(n.isBlock||e.preformattedCode&&n.isCode)return{leading:"",trailing:""};var t=pL(n.textContent);return t.leadingAscii&&Ww("left",n,e)&&(t.leading=t.leadingNonAscii),t.trailingAscii&&Ww("right",n,e)&&(t.trailing=t.trailingNonAscii),{leading:t.leading,trailing:t.trailing}}function pL(n){var e=n.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:e[1],leadingAscii:e[2],leadingNonAscii:e[3],trailing:e[4],trailingNonAscii:e[5],trailingAscii:e[6]}}function Ww(n,e,t){var r,i,o;return n==="left"?(r=e.previousSibling,i=/ $/):(r=e.nextSibling,i=/^ /),r&&(r.nodeType===3?o=i.test(r.nodeValue):t.preformattedCode&&r.nodeName==="CODE"?o=!1:r.nodeType===1&&!EC(r)&&(o=i.test(r.textContent))),o}var gL=Array.prototype.reduce,mL=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function Jd(n){if(!(this instanceof Jd))return new Jd(n);var e={rules:Di,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(t,r){return r.isBlock?`

`:""},keepReplacement:function(t,r){return r.isBlock?`

`+r.outerHTML+`

`:r.outerHTML},defaultReplacement:function(t,r){return r.isBlock?`

`+t+`

`:t}};this.options=K8({},e,n),this.rules=new LE(this.options)}Jd.prototype={turndown:function(n){if(!CL(n))throw new TypeError(n+" is not a string, or an element/document/fragment node.");if(n==="")return"";var e=UE.call(this,new cL(n,this.options));return vL.call(this,e)},use:function(n){if(Array.isArray(n))for(var e=0;e<n.length;e++)this.use(n[e]);else if(typeof n=="function")n(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(n,e){return this.rules.add(n,e),this},keep:function(n){return this.rules.keep(n),this},remove:function(n){return this.rules.remove(n),this},escape:function(n){return mL.reduce(function(e,t){return e.replace(t[0],t[1])},n)}};function UE(n){var e=this;return gL.call(n.childNodes,function(t,r){r=new dL(r,e.options);var i="";return r.nodeType===3?i=r.isCode?r.nodeValue:e.escape(r.nodeValue):r.nodeType===1&&(i=yL.call(e,r)),jE(t,i)},"")}function vL(n){var e=this;return this.rules.forEach(function(t){typeof t.append=="function"&&(n=jE(n,t.append(e.options)))}),n.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function yL(n){var e=this.rules.forNode(n),t=UE.call(this,n),r=n.flankingWhitespace;return(r.leading||r.trailing)&&(t=t.trim()),r.leading+e.replacement(t,n,this.options)+r.trailing}function jE(n,e){var t=Y8(n),r=q8(e),i=Math.max(n.length-t.length,e.length-r.length),o=`

`.substring(0,i);return t+o+r}function CL(n){return n!=null&&(typeof n=="string"||n.nodeType&&(n.nodeType===1||n.nodeType===9||n.nodeType===11))}const xL=({blockquoteElement:n,contentType:e})=>{const[t,r]=O.useState("default"),i=new Jd({headingStyle:"atx",emDelimiter:"*"}),o=async s=>{s.preventDefault(),s.stopPropagation();try{const l=n.cloneNode(!0);l.querySelectorAll(".blockquote-copy-button").forEach(m=>m.remove());let h;if(e==="text/markdown"){const m=l.innerHTML;h=i.turndown(m)}else h=l.textContent||"";await navigator.clipboard.writeText(h.trim()),r("copied"),setTimeout(()=>{r("default")},1500)}catch(l){console.error("Failed to copy text: ",l),r("error"),setTimeout(()=>{r("default")},1500)}},a=()=>{switch(t){case"copied":return"Copied!";case"error":return"Error";default:return"Copy"}};return K.jsx("button",{className:`blockquote-copy-button ${t!=="default"?t:""}`,onClick:o,type:"button","aria-label":"Copy blockquote content",children:a()})},Hw=({children:n,contentType:e})=>{const t=O.useRef(null),[r,i]=O.useState(!1);return O.useEffect(()=>{i(!0)},[]),K.jsxs("div",{className:"blockquote-with-copy",style:{position:"relative"},children:[K.jsx("blockquote",{ref:t,"data-content-type":e,dangerouslySetInnerHTML:typeof n=="string"?{__html:n}:void 0,children:typeof n!="string"?n:void 0}),r&&t.current&&K.jsx(xL,{blockquoteElement:t.current,contentType:e})]})},Zw=2,bL=2,cs=class cs extends vn.Component{constructor(t){super(t);oe(this,"outputRef",vn.createRef());oe(this,"messageKey",0);oe(this,"unsubscribePrefs");oe(this,"turndownService",new Jd({headingStyle:"atx",emDelimiter:"*"}));oe(this,"handlePreferencesChange",()=>{this.setState({localEchoActive:lr.getState().general.localEcho})});oe(this,"saveOutput",()=>{const t=this.state.output.map(i=>({type:i.type,sourceType:i.sourceType,sourceContent:i.sourceContent,metadata:i.metadata})).filter(i=>i.sourceContent!==""),r={version:Zw,lines:t};localStorage.setItem(cs.LOCAL_STORAGE_KEY,JSON.stringify(r))});oe(this,"recreateContentFromSource",t=>{switch(t.sourceType){case"ansi":return _w(t.sourceContent,this.handleExitClick);case"html":const r=Vw.sanitize(t.sourceContent),o=new DOMParser().parseFromString(r,"text/html");if(o.querySelectorAll("blockquote").length>0){const s=[],l=o.body;let f="";return Array.from(l.childNodes).forEach((h,m)=>{if(h.nodeName==="BLOCKQUOTE"){f.trim()&&(s.push(K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:f}},`content-${m}`)),f="");const g=h,y=g.getAttribute("data-content-type")||void 0;s.push(K.jsx(Hw,{contentType:y,children:g.innerHTML},`blockquote-${m}`))}else h.nodeType===Node.ELEMENT_NODE?f+=h.outerHTML:h.nodeType===Node.TEXT_NODE&&(f+=h.textContent||"")}),f.trim()&&s.push(K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:f}},"remaining-content")),s}else return[K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}})];case"command":return[K.jsx("span",{className:"command","aria-live":"off",children:t.sourceContent})];case"error":return[K.jsxs("h2",{children:[" Error: ",t.sourceContent]})];case"system":return[K.jsxs("h2",{children:[" ",t.sourceContent]})];default:return console.warn(`Unknown sourceType: ${t.sourceType}, falling back to text display`),[K.jsx("span",{children:t.sourceContent})]}});oe(this,"loadOutput",()=>{const t=localStorage.getItem(cs.LOCAL_STORAGE_KEY);if(t)try{const r=JSON.parse(t);if(r&&typeof r=="object"&&"version"in r&&"lines"in r){const i=r;return i.version===Zw?i.lines.map(o=>{const a=this.messageKey++,s=this.recreateContentFromSource(o),l=s.length===1?s[0]:K.jsx(K.Fragment,{children:s});return{id:a,type:o.type,content:K.jsx("div",{className:`output-line output-line-${o.type}`,children:l},a),sourceType:o.sourceType,sourceContent:o.sourceContent,metadata:o.metadata}}):(console.warn(`Unsupported log version: ${i.version}. Clearing old data.`),localStorage.removeItem(cs.LOCAL_STORAGE_KEY),[])}else return console.log("Clearing old format output log."),localStorage.removeItem(cs.LOCAL_STORAGE_KEY),[]}catch(r){return console.error("Failed to parse saved output log:",r),localStorage.removeItem(cs.LOCAL_STORAGE_KEY),[]}return[]});oe(this,"addCommand",t=>{this.addToOutput([K.jsx("span",{className:"command","aria-live":"off",children:t})],"command",!1,"command",t)});oe(this,"addError",t=>this.addToOutput([K.jsxs("h2",{children:[" Error: ",t.message]})],"errorMessage",!0,"error",t.message));oe(this,"handleConnected",()=>this.addToOutput([K.jsx("h2",{children:" Connected"})],"systemInfo",!0,"system","Connected"));oe(this,"handleDisconnected",()=>{this.addToOutput([K.jsx("h2",{children:" Disconnected"})],"systemInfo",!0,"system","Disconnected"),this.setState({sidebarVisible:!1})});oe(this,"handleUserList",t=>this.setState({sidebarVisible:!!t}));oe(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});oe(this,"isScrolledToBottom",()=>{const t=this.outputRef.current;if(!t)return!1;const r=Math.ceil(t.scrollHeight-t.scrollTop),i=Math.ceil(t.clientHeight);return r<=i+bL});oe(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});oe(this,"scrollToBottom",()=>{const t=this.outputRef.current;t&&requestAnimationFrame(()=>{t.scrollTop=t.scrollHeight})});oe(this,"handleMessage",t=>{if(!t)return;const r=_w(t,this.handleExitClick);this.addToOutput(r,"serverMessage",!0,"ansi",t)});oe(this,"handleHtml",t=>{const r=Vw.sanitize(t),o=new DOMParser().parseFromString(r,"text/html");if(o.querySelectorAll("blockquote").length>0){const s=[],l=o.body;let f="";Array.from(l.childNodes).forEach((h,m)=>{if(h.nodeName==="BLOCKQUOTE"){f.trim()&&(s.push(K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:f}},`content-${m}`)),f="");const g=h,y=g.getAttribute("data-content-type")||void 0;s.push(K.jsx(Hw,{contentType:y,children:g.innerHTML},`blockquote-${m}`))}else h.nodeType===Node.ELEMENT_NODE?f+=h.outerHTML:h.nodeType===Node.TEXT_NODE&&(f+=h.textContent||"")}),f.trim()&&s.push(K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:f}},"remaining-content")),this.addToOutput(s,"serverMessage",!0,"html",t)}else{const s=K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}});this.addToOutput([s],"serverMessage",!0,"html",t)}});oe(this,"handleExitClick",t=>{this.props.client.sendCommand(t)});oe(this,"handleDataTextClick",t=>{var o,a;const i=t.target.closest("a.command[data-text]");if(i instanceof HTMLAnchorElement){t.preventDefault();const s=i.dataset.text;s!=null&&(il(s),(a=(o=this.props).focusInput)==null||a.call(o))}});this.state={output:this.loadOutput(),sidebarVisible:!1,newLinesCount:0,localEchoActive:lr.getState().general.localEcho}}getSnapshotBeforeUpdate(t,r){return this.outputRef.current?(this.outputRef.current,this.isScrolledToBottom()):null}componentDidUpdate(t,r,i){i&&this.scrollToBottom();const o=this.state.output.slice(r.output.length);if(o.length>0){const a=o.filter(s=>this.state.localEchoActive||s.type!=="command").length;a>0&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState(s=>({newLinesCount:s.newLinesCount+a})))}this.saveOutput()}componentDidMount(){const{client:t}=this.props;t.on("message",this.handleMessage),t.on("html",this.handleHtml),t.on("connect",this.handleConnected),t.on("disconnect",this.handleDisconnected),t.on("error",this.addError),t.on("command",this.addCommand),t.on("userlist",this.handleUserList),this.unsubscribePrefs=lr.subscribe(this.handlePreferencesChange)}componentWillUnmount(){const{client:t}=this.props;this.unsubscribePrefs&&this.unsubscribePrefs(),t.removeListener("message",this.handleMessage),t.removeListener("html",this.handleHtml),t.removeListener("connect",this.handleConnected),t.removeListener("disconnect",this.handleDisconnected),t.removeListener("error",this.addError),t.removeListener("command",this.addCommand),t.removeListener("userlist",this.handleUserList)}sanitizeHtml(t){return new DOMParser().parseFromString(t,"text/html").body.textContent||""}addToOutput(t,r,i=!0,o="unknown",a="",s){i&&t.forEach(l=>{if(vn.isValidElement(l)){const f=E8.renderToString(l),h=this.sanitizeHtml(f);Ew(h)}else typeof l=="string"&&Ew(l)}),this.setState(l=>{const f=t.map(g=>{const y=this.messageKey++;return{id:y,type:r,content:K.jsx("div",{className:`output-line output-line-${r}`,children:g},y),sourceType:o,sourceContent:a,metadata:s}});return{output:[...l.output,...f].slice(-cs.MAX_OUTPUT_LENGTH)}})}saveLog(){const t=this.outputRef.current;if(t){const r=t.innerHTML,i=new Blob([r],{type:"text/html"}),o=URL.createObjectURL(i),a=document.createElement("a"),s=new Date,l=s.toLocaleDateString(),f=s.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),m=`${document.title.replace(/\s+/g,"-")}-log-${l}-${f}.html`;a.download=m,a.href=o,a.click(),URL.revokeObjectURL(o),a.remove()}}clearLog(){this.setState({output:[]}),localStorage.removeItem(cs.LOCAL_STORAGE_KEY)}copyLog(){const t=this.outputRef.current;if(t){const r=t.innerText;navigator.clipboard.writeText(r).then(()=>{console.log("Log copied to clipboard.")}).catch(i=>{console.error("Failed to copy log: ",i),alert("Failed to copy log to clipboard. See console for details.")})}}render(){var t="output";this.state.sidebarVisible&&(t+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return K.jsxs("div",{ref:this.outputRef,className:t,onScroll:this.handleScroll,onClick:this.handleDataTextClick,children:[this.state.output.filter(i=>this.state.localEchoActive||i.type!=="command").map(i=>i.content),this.state.newLinesCount>0&&K.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};oe(cs,"MAX_OUTPUT_LENGTH",7500),oe(cs,"LOCAL_STORAGE_KEY","outputLog");let oy=cs;const IL="278420afe5f66ca53b706718fdbcc534e5622d56",Do=()=>{const[,n]=O.useReducer(e=>e+1,0);return O.useEffect(()=>lr.subscribe(n),[]),[lr.getState(),lr.dispatch]},wL=()=>{const[n,e]=O.useState([]);return O.useEffect(()=>{const t=()=>{e(window.speechSynthesis.getVoices())};t(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=t)},[]),n},GE=({tabs:n})=>{const[e,t]=O.useState(0),r=O.useRef([]),i=O.useRef(!1);return O.useEffect(()=>{r.current=r.current.slice(0,n.length)},[n]),O.useEffect(()=>{const o=s=>{switch(s.key){case"ArrowLeft":i.current=!0,t(l=>l>0?l-1:n.length-1);break;case"ArrowRight":i.current=!0,t(l=>l<n.length-1?l+1:0);break;case"Home":i.current=!0,t(0);break;case"End":i.current=!0,t(n.length-1);break}},a=r.current[e];return a==null||a.addEventListener("keydown",o),()=>{a==null||a.removeEventListener("keydown",o)}},[n.length,e]),O.useEffect(()=>{var o;i.current&&((o=r.current[e])==null||o.focus())},[e]),K.jsxs("div",{className:"tabs-container",children:[K.jsx("div",{role:"tablist",children:n.map((o,a)=>K.jsx("button",{ref:s=>r.current[a]=s,role:"tab","aria-selected":e===a,id:o.id,"aria-controls":`${o.id}-panel`,onClick:()=>{console.log(`Tab onClick triggered for: ${o.label} (Index: ${a})`),i.current=!0,t(a),console.log(`Tab state updated to index: ${a}`)},tabIndex:e===a?void 0:-1,children:o.label},a))}),n.map((o,a)=>K.jsx("div",{role:"tabpanel",id:`${o.id}-panel`,"aria-labelledby":o.id,hidden:e!==a,children:K.jsx("div",{className:"sidebar-tab-content",children:o.content})},o.id))]})},SL=()=>{const[n,e]=Do();return K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.general.localEcho,onChange:t=>e({type:Zo.SetGeneral,data:{...n.general,localEcho:t.target.checked}})}),"Local Echo"]})},AL=()=>{const[n,e]=Do();return K.jsxs("label",{children:["Auto Read:",K.jsxs("select",{value:n.speech.autoreadMode,onChange:t=>e({type:Zo.SetSpeech,data:{...n.speech,autoreadMode:t.target.value}}),children:[K.jsx("option",{value:"off",children:"Off"}),K.jsx("option",{value:"unfocused",children:"Unfocused"}),K.jsx("option",{value:"all",children:"Always"})]})]})},kL=()=>{const[n,e]=Do(),t=wL();return K.jsxs("label",{children:["Voice:",K.jsx("select",{value:n.speech.voice,onChange:r=>e({type:Zo.SetSpeech,data:{...n.speech,voice:r.target.value}}),children:t.map(r=>K.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},EL=()=>{const[n,e]=Do();return K.jsxs("label",{children:["Rate (0.1 - 10.0):",K.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:n.speech.rate,onChange:t=>e({type:Zo.SetSpeech,data:{...n.speech,rate:parseFloat(t.target.value)}})})]})},TL=()=>{const[n,e]=Do();return K.jsxs("label",{children:["Pitch (0 - 2):",K.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:n.speech.pitch,onChange:t=>e({type:Zo.SetSpeech,data:{...n.speech,pitch:parseFloat(t.target.value)}})})]})},_L=()=>{const[n,e]=Do();return K.jsxs("label",{children:["Volume (0 - 1):",K.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:n.speech.volume,onChange:t=>e({type:Zo.SetSpeech,data:{...n.speech,volume:parseFloat(t.target.value)}})})]})},RL=()=>{const[n]=Do(),[e,t]=O.useState(!1),r=vn.useRef(!0);vn.useEffect(()=>()=>{r.current=!1,speechSynthesis.cancel()},[]);const i=()=>{if(e)return;t(!0),console.log("Preview button clicked");const o=()=>{if(!r.current)return;const a=new SpeechSynthesisUtterance("This is a preview of the selected voice settings."),s=speechSynthesis.getVoices();console.log("Available voices:",s.map(f=>f.name));const l=s.find(f=>f.name===n.speech.voice);console.log("Selected voice:",l?l.name:"Not found"),a.voice=l||null,a.rate=n.speech.rate,a.pitch=n.speech.pitch,a.volume=n.speech.volume,console.log("Utterance settings:",{voice:a.voice?a.voice.name:"Default",rate:a.rate,pitch:a.pitch,volume:a.volume}),a.onend=()=>{r.current&&(console.log("Speech ended"),t(!1))},a.onerror=f=>{r.current&&(console.error("Speech synthesis error:",f),t(!1))},speechSynthesis.cancel(),speechSynthesis.speak(a),console.log("Speech started")};if(speechSynthesis.getVoices().length>0)o();else{let a=()=>{a&&(speechSynthesis.onvoiceschanged=null,a=null,r.current&&o())};speechSynthesis.onvoiceschanged=a;const s=()=>{a&&(speechSynthesis.onvoiceschanged=null,a=null)};vn.useEffect(()=>s,[])}};return K.jsx("button",{onClick:i,disabled:e,children:e?"Playing...":"Preview Voice"})},PL=()=>K.jsxs("div",{children:[K.jsx(AL,{}),K.jsx("br",{}),K.jsx(kL,{}),K.jsx("br",{}),K.jsx(EL,{}),K.jsx("br",{}),K.jsx(TL,{}),K.jsx("br",{}),K.jsx(_L,{}),K.jsx("br",{}),K.jsx(RL,{})]}),DL=()=>{const[n,e]=Do();return K.jsx("div",{children:K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.sound.muteInBackground,onChange:t=>e({type:Zo.SetSound,data:{...n.sound,muteInBackground:t.target.checked}})}),"Mute sounds when in background"]})})},ML=()=>{const[n,e]=Do(),t=n.editor,r=o=>{e({type:Zo.SetEditorAutocompleteEnabled,data:o.target.checked})},i=o=>{e({type:Zo.SetEditorAccessibilityMode,data:o.target.checked})};return K.jsxs("div",{children:[K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:t.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),K.jsx("br",{}),K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:t.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),K.jsx("br",{})]})},NL=()=>{const[n,e]=Do(),t=r=>{e({type:Zo.SetMidi,data:{enabled:r.target.checked}})};return en.isSupported?K.jsxs("div",{children:[K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.midi.enabled,onChange:t}),"Enable MIDI"]}),K.jsx("br",{}),K.jsx("br",{}),n.midi.enabled&&K.jsx("p",{style:{color:"#666",fontSize:"0.9em"},children:"Device selection and management is available in the MIDI tab when connected to a server."})]}):K.jsxs("div",{children:[K.jsx("p",{children:"MIDI is not supported in this browser."}),K.jsx("p",{children:"MIDI support is available in Chrome, Edge, Opera, and Brave."})]})},BL=()=>{const n=[{label:"General",content:K.jsx(SL,{})},{label:"Speech",content:K.jsx(PL,{})},{label:"Sounds",content:K.jsx(DL,{})},{label:"Editor",content:K.jsx(ML,{})},{label:"MIDI",content:K.jsx(NL,{})}];return K.jsx(GE,{tabs:n})};function OL(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}function ef(){return ef=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ef.apply(null,arguments)}var sy="data-focus-lock",VE="data-focus-lock-disabled",FL="data-no-focus-lock",LL="data-autofocus-inside",UL="data-no-autofocus";function Km(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function jL(n,e){var t=O.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var i=t.value;i!==r&&(t.value=r,t.callback(r,i))}}}})[0];return t.callback=e,t.facade}var GL=typeof window<"u"?O.useLayoutEffect:O.useEffect,Xw=new WeakMap;function VL(n,e){var t=jL(null,function(r){return n.forEach(function(i){return Km(i,r)})});return GL(function(){var r=Xw.get(t);if(r){var i=new Set(r),o=new Set(n),a=t.current;i.forEach(function(s){o.has(s)||Km(s,null)}),o.forEach(function(s){i.has(s)||Km(s,a)})}Xw.set(t,n)},[n]),t}var qm={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},ay=function(){return ay=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ay.apply(this,arguments)};function zE(n){return n}function WE(n,e){e===void 0&&(e=zE);var t=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(o){var a=e(o,r);return t.push(a),function(){t=t.filter(function(s){return s!==a})}},assignSyncMedium:function(o){for(r=!0;t.length;){var a=t;t=[],a.forEach(o)}t={push:function(s){return o(s)},filter:function(){return t}}},assignMedium:function(o){r=!0;var a=[];if(t.length){var s=t;t=[],s.forEach(o),a=t}var l=function(){var h=a;a=[],h.forEach(o)},f=function(){return Promise.resolve().then(l)};f(),t={push:function(h){a.push(h),f()},filter:function(h){return a=a.filter(h),t}}}};return i}function RC(n,e){return e===void 0&&(e=zE),WE(n,e)}function zL(n){n===void 0&&(n={});var e=WE(null);return e.options=ay({async:!0,ssr:!1},n),e}var HE=RC({},function(n){var e=n.target,t=n.currentTarget;return{target:e,currentTarget:t}}),ZE=RC(),WL=RC(),HL=zL({async:!0,ssr:typeof document<"u"}),ZL=O.createContext(void 0),XL=[],PC=O.forwardRef(function(e,t){var r,i=O.useState(),o=i[0],a=i[1],s=O.useRef(),l=O.useRef(!1),f=O.useRef(null),h=O.useState({}),m=h[1],g=e.children,y=e.disabled,C=y===void 0?!1:y,x=e.noFocusGuards,w=x===void 0?!1:x,S=e.persistentFocus,A=S===void 0?!1:S,E=e.crossFrame,_=E===void 0?!0:E,T=e.autoFocus,M=T===void 0?!0:T;e.allowTextSelection;var P=e.group,j=e.className,X=e.whiteList,L=e.hasPositiveIndices,G=e.shards,Z=G===void 0?XL:G,ne=e.as,pe=ne===void 0?"div":ne,ve=e.lockProps,Se=ve===void 0?{}:ve,Ne=e.sideCar,xe=e.returnFocus,Ae=xe===void 0?!1:xe,ke=e.focusOptions,H=e.onActivation,ee=e.onDeactivation,ae=O.useState({}),ye=ae[0],Ee=O.useCallback(function(lt){var Vt=lt.captureFocusRestore;if(!f.current){var Gt,Pt=(Gt=document)==null?void 0:Gt.activeElement;f.current=Pt,Pt!==document.body&&(f.current=Vt(Pt))}s.current&&H&&H(s.current),l.current=!0,m()},[H]),_e=O.useCallback(function(){l.current=!1,ee&&ee(s.current),m()},[ee]),Je=O.useCallback(function(lt){var Vt=f.current;if(Vt){var Gt=(typeof Vt=="function"?Vt():Vt)||document.body,Pt=typeof Ae=="function"?Ae(Gt):Ae;if(Pt){var Ht=typeof Pt=="object"?Pt:void 0;f.current=null,lt?Promise.resolve().then(function(){return Gt.focus(Ht)}):Gt.focus(Ht)}}},[Ae]),me=O.useCallback(function(lt){l.current&&HE.useMedium(lt)},[]),it=ZE.useMedium,Tt=O.useCallback(function(lt){s.current!==lt&&(s.current=lt,a(lt))},[]),Xt=ef((r={},r[VE]=C&&"disabled",r[sy]=P,r),Se),Et=w!==!0,St=Et&&w!=="tail",Dt=VL([t,Tt]),at=O.useMemo(function(){return{observed:s,shards:Z,enabled:!C,active:l.current}},[C,l.current,Z,o]);return vn.createElement(O.Fragment,null,Et&&[vn.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:C?-1:0,style:qm}),L?vn.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:C?-1:1,style:qm}):null],!C&&vn.createElement(Ne,{id:ye,sideCar:HL,observed:o,disabled:C,persistentFocus:A,crossFrame:_,autoFocus:M,whiteList:X,shards:Z,onActivation:Ee,onDeactivation:_e,returnFocus:Je,focusOptions:ke,noFocusGuards:w}),vn.createElement(pe,ef({ref:Dt},Xt,{className:j,onBlur:it,onFocus:me}),vn.createElement(ZL.Provider,{value:at},g)),St&&vn.createElement("div",{"data-focus-guard":!0,tabIndex:C?-1:0,style:qm}))});PC.propTypes={};function cy(n,e){return cy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},cy(n,e)}function $L(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,cy(n,e)}function tf(n){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tf(n)}function KL(n,e){if(tf(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(tf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function qL(n){var e=KL(n,"string");return tf(e)=="symbol"?e:e+""}function YL(n,e,t){return(e=qL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QL(n,e){function t(r){return r.displayName||r.name||"Component"}return function(i){var o=[],a;function s(){a=n(o.map(function(f){return f.props})),e(a)}var l=function(f){$L(h,f);function h(){return f.apply(this,arguments)||this}h.peek=function(){return a};var m=h.prototype;return m.componentDidMount=function(){o.push(this),s()},m.componentDidUpdate=function(){s()},m.componentWillUnmount=function(){var y=o.indexOf(this);o.splice(y,1),s()},m.render=function(){return vn.createElement(i,this.props)},h}(O.PureComponent);return YL(l,"displayName","SideEffect("+t(i)+")"),l}}var na=function(n){for(var e=Array(n.length),t=0;t<n.length;++t)e[t]=n[t];return e},yl=function(n){return Array.isArray(n)?n:[n]},XE=function(n){return Array.isArray(n)?n[0]:n},JL=function(n){if(n.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(n,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},$E=function(n){return n.parentNode&&n.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.parentNode.host:n.parentNode},KE=function(n){return n===document||n&&n.nodeType===Node.DOCUMENT_NODE},e6=function(n){return n.hasAttribute("inert")},t6=function(n,e){return!n||KE(n)||!JL(n)&&!e6(n)&&e($E(n))},qE=function(n,e){var t=n.get(e);if(t!==void 0)return t;var r=t6(e,qE.bind(void 0,n));return n.set(e,r),r},n6=function(n,e){return n&&!KE(n)?o6(n)?e($E(n)):!1:!0},YE=function(n,e){var t=n.get(e);if(t!==void 0)return t;var r=n6(e,YE.bind(void 0,n));return n.set(e,r),r},QE=function(n){return n.dataset},r6=function(n){return n.tagName==="BUTTON"},JE=function(n){return n.tagName==="INPUT"},eT=function(n){return JE(n)&&n.type==="radio"},i6=function(n){return!((JE(n)||r6(n))&&(n.type==="hidden"||n.disabled))},o6=function(n){var e=n.getAttribute(UL);return![!0,"true",""].includes(e)},DC=function(n){var e;return!!(n&&(!((e=QE(n))===null||e===void 0)&&e.focusGuard))},ly=function(n){return!DC(n)},s6=function(n){return!!n},a6=function(n,e){var t=Math.max(0,n.tabIndex),r=Math.max(0,e.tabIndex),i=t-r,o=n.index-e.index;if(i){if(!t)return 1;if(!r)return-1}return i||o},c6=function(n){return n.tabIndex<0&&!n.hasAttribute("tabindex")?0:n.tabIndex},MC=function(n,e,t){return na(n).map(function(r,i){var o=c6(r);return{node:r,index:i,tabIndex:t&&o===-1?(r.dataset||{}).focusGuard?0:-1:o}}).filter(function(r){return!e||r.tabIndex>=0}).sort(a6)},l6=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],NC=l6.join(","),u6="".concat(NC,", [data-focus-guard]"),tT=function(n,e){return na((n.shadowRoot||n).children).reduce(function(t,r){return t.concat(r.matches(e?u6:NC)?[r]:[],tT(r))},[])},d6=function(n,e){var t;return n instanceof HTMLIFrameElement&&(!((t=n.contentDocument)===null||t===void 0)&&t.body)?_u([n.contentDocument.body],e):[n]},_u=function(n,e){return n.reduce(function(t,r){var i,o=tT(r,e),a=(i=[]).concat.apply(i,o.map(function(s){return d6(s,e)}));return t.concat(a,r.parentNode?na(r.parentNode.querySelectorAll(NC)).filter(function(s){return s===r}):[])},[])},f6=function(n){var e=n.querySelectorAll("[".concat(LL,"]"));return na(e).map(function(t){return _u([t])}).reduce(function(t,r){return t.concat(r)},[])},BC=function(n,e){return na(n).filter(function(t){return qE(e,t)}).filter(function(t){return i6(t)})},$w=function(n,e){return e===void 0&&(e=new Map),na(n).filter(function(t){return YE(e,t)})},OC=function(n,e,t){return MC(BC(_u(n,t),e),!0,t)},nf=function(n,e){return MC(BC(_u(n),e),!1)},h6=function(n,e){return BC(f6(n),e)},dl=function(n,e){return n.shadowRoot?dl(n.shadowRoot,e):Object.getPrototypeOf(n).contains!==void 0&&Object.getPrototypeOf(n).contains.call(n,e)?!0:na(n.children).some(function(t){var r;if(t instanceof HTMLIFrameElement){var i=(r=t.contentDocument)===null||r===void 0?void 0:r.body;return i?dl(i,e):!1}return dl(t,e)})},p6=function(n){for(var e=new Set,t=n.length,r=0;r<t;r+=1)for(var i=r+1;i<t;i+=1){var o=n[r].compareDocumentPosition(n[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return n.filter(function(a,s){return!e.has(s)})},nT=function(n){return n.parentNode?nT(n.parentNode):n},FC=function(n){var e=yl(n);return e.filter(Boolean).reduce(function(t,r){var i=r.getAttribute(sy);return t.push.apply(t,i?p6(na(nT(r).querySelectorAll("[".concat(sy,'="').concat(i,'"]:not([').concat(VE,'="disabled"])')))):[r]),t},[])},g6=function(n){try{return n()}catch{return}},rf=function(n){if(n===void 0&&(n=document),!(!n||!n.activeElement)){var e=n.activeElement;return e.shadowRoot?rf(e.shadowRoot):e instanceof HTMLIFrameElement&&g6(function(){return e.contentWindow.document})?rf(e.contentWindow.document):e}},m6=function(n,e){return n===e},v6=function(n,e){return!!na(n.querySelectorAll("iframe")).some(function(t){return m6(t,e)})},rT=function(n,e){return e===void 0&&(e=rf(XE(n).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:FC(n).some(function(t){return dl(t,e)||v6(t,e)})},y6=function(n){n===void 0&&(n=document);var e=rf(n);return e?na(n.querySelectorAll("[".concat(FL,"]"))).some(function(t){return dl(t,e)}):!1},C6=function(n,e){return e.filter(eT).filter(function(t){return t.name===n.name}).filter(function(t){return t.checked})[0]||n},LC=function(n,e){return eT(n)&&n.name?C6(n,e):n},x6=function(n){var e=new Set;return n.forEach(function(t){return e.add(LC(t,n))}),n.filter(function(t){return e.has(t)})},Kw=function(n){return n[0]&&n.length>1?LC(n[0],n):n[0]},qw=function(n,e){return n.indexOf(LC(e,n))},uy="NEW_FOCUS",b6=function(n,e,t,r,i){var o=n.length,a=n[0],s=n[o-1],l=DC(r);if(!(r&&n.indexOf(r)>=0)){var f=r!==void 0?t.indexOf(r):-1,h=i?t.indexOf(i):f,m=i?n.indexOf(i):-1;if(f===-1)return m!==-1?m:uy;if(m===-1)return uy;var g=f-h,y=t.indexOf(a),C=t.indexOf(s),x=x6(t),w=r!==void 0?x.indexOf(r):-1,S=i?x.indexOf(i):w,A=x.filter(function(j){return j.tabIndex>=0}),E=r!==void 0?A.indexOf(r):-1,_=i?A.indexOf(i):E,T=E>=0&&_>=0?_-E:S-w;if(!g&&m>=0||e.length===0)return m;var M=qw(n,e[0]),P=qw(n,e[e.length-1]);if(f<=y&&l&&Math.abs(g)>1)return P;if(f>=C&&l&&Math.abs(g)>1)return M;if(g&&Math.abs(T)>1)return m;if(f<=y)return P;if(f>C)return M;if(g)return Math.abs(g)>1?m:(o+m+g)%o}},I6=function(n){return function(e){var t,r=(t=QE(e))===null||t===void 0?void 0:t.autofocus;return e.autofocus||r!==void 0&&r!=="false"||n.indexOf(e)>=0}},Yw=function(n,e,t){var r=n.map(function(o){var a=o.node;return a}),i=$w(r.filter(I6(t)));return i&&i.length?Kw(i):Kw($w(e))},dy=function(n,e){return e===void 0&&(e=[]),e.push(n),n.parentNode&&dy(n.parentNode.host||n.parentNode,e),e},Ym=function(n,e){for(var t=dy(n),r=dy(e),i=0;i<t.length;i+=1){var o=t[i];if(r.indexOf(o)>=0)return o}return!1},iT=function(n,e,t){var r=yl(n),i=yl(e),o=r[0],a=!1;return i.filter(Boolean).forEach(function(s){a=Ym(a||s,s)||a,t.filter(Boolean).forEach(function(l){var f=Ym(o,l);f&&(!a||dl(f,a)?a=f:a=Ym(f,a))})}),a},Qw=function(n,e){return n.reduce(function(t,r){return t.concat(h6(r,e))},[])},w6=function(n,e){var t=new Map;return e.forEach(function(r){return t.set(r.node,r)}),n.map(function(r){return t.get(r)}).filter(s6)},S6=function(n,e){var t=rf(yl(n).length>0?document:XE(n).ownerDocument),r=FC(n).filter(ly),i=iT(t||n,n,r),o=new Map,a=nf(r,o),s=a.filter(function(C){var x=C.node;return ly(x)});if(s[0]){var l=nf([i],o).map(function(C){var x=C.node;return x}),f=w6(l,s),h=f.map(function(C){var x=C.node;return x}),m=f.filter(function(C){var x=C.tabIndex;return x>=0}).map(function(C){var x=C.node;return x}),g=b6(h,m,l,t,e);if(g===uy){var y=Yw(a,m,Qw(r,o))||Yw(a,h,Qw(r,o));if(y)return{node:y};console.warn("focus-lock: cannot find any node to move focus into");return}return g===void 0?g:f[g]}},A6=function(n){var e=FC(n).filter(ly),t=iT(n,n,e),r=MC(_u([t],!0),!0,!0),i=_u(e,!1);return r.map(function(o){var a=o.node,s=o.index;return{node:a,index:s,lockItem:i.indexOf(a)>=0,guard:DC(a)}})},UC=function(n,e){n&&("focus"in n&&n.focus(e),"contentWindow"in n&&n.contentWindow&&n.contentWindow.focus())},Qm=0,Jm=!1,oT=function(n,e,t){t===void 0&&(t={});var r=S6(n,e);if(!Jm&&r){if(Qm>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),Jm=!0,setTimeout(function(){Jm=!1},1);return}Qm++,UC(r.node,t.focusOptions),Qm--}};function Ad(n){if(!n)return null;if(typeof WeakRef>"u")return function(){return n||null};var e=n?new WeakRef(n):null;return function(){return(e==null?void 0:e.deref())||null}}var k6=function(n){if(!n)return null;for(var e=[],t=n;t&&t!==document.body;)e.push({current:Ad(t),parent:Ad(t.parentElement),left:Ad(t.previousElementSibling),right:Ad(t.nextElementSibling)}),t=t.parentElement;return{element:Ad(n),stack:e,ownerDocument:n.ownerDocument}},E6=function(n){var e,t,r,i,o;if(n)for(var a=n.stack,s=n.ownerDocument,l=new Map,f=0,h=a;f<h.length;f++){var m=h[f],g=(e=m.parent)===null||e===void 0?void 0:e.call(m);if(g&&s.contains(g)){for(var y=(t=m.left)===null||t===void 0?void 0:t.call(m),C=m.current(),x=g.contains(C)?C:void 0,w=(r=m.right)===null||r===void 0?void 0:r.call(m),S=OC([g],l),A=(o=(i=x??(y==null?void 0:y.nextElementSibling))!==null&&i!==void 0?i:w)!==null&&o!==void 0?o:y;A;){for(var E=0,_=S;E<_.length;E++){var T=_[E];if(A!=null&&A.contains(T.node))return T.node}A=A.nextElementSibling}if(S.length)return S[0].node}}},sT=function(n){var e=k6(n);return function(){return E6(e)}},T6=function(n,e,t){if(!n||!e)return console.error("no element or scope given"),{};var r=yl(e);if(r.every(function(a){return!dl(a,n)}))return console.error("Active element is not contained in the scope"),{};var i=t?OC(r,new Map):nf(r,new Map),o=i.findIndex(function(a){var s=a.node;return s===n});if(o!==-1)return{prev:i[o-1],next:i[o+1],first:i[0],last:i[i.length-1]}},_6=function(n,e){var t=e?OC(yl(n),new Map):nf(yl(n),new Map);return{first:t[0],last:t[t.length-1]}},R6=function(n){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},n)},aT=function(n,e,t){e===void 0&&(e={});var r=R6(e),i=T6(n,r.scope,r.onlyTabbable);if(i){var o=t(i,r.cycle);o&&UC(o.node,r.focusOptions)}},P6=function(n,e){e===void 0&&(e={}),aT(n,e,function(t,r){var i=t.next,o=t.first;return i||r&&o})},D6=function(n,e){e===void 0&&(e={}),aT(n,e,function(t,r){var i=t.prev,o=t.last;return i||r&&o})},cT=function(n,e,t){var r,i=_6(n,(r=e.onlyTabbable)!==null&&r!==void 0?r:!0),o=i[t];o&&UC(o.node,e.focusOptions)},M6=function(n,e){e===void 0&&(e={}),cT(n,e,"first")},N6=function(n,e){e===void 0&&(e={}),cT(n,e,"last")};function jC(n){setTimeout(n,1)}var B6=function(e){return e&&"current"in e?e.current:e},lT=function(){return document&&document.activeElement===document.body},O6=function(){return lT()||y6()},hu=null,to=null,Jw=function(){return null},pu=null,of=!1,GC=!1,F6=function(){return!0},L6=function(e){return(hu.whiteList||F6)(e)},U6=function(e,t){pu={observerNode:e,portaledElement:t}},j6=function(e){return pu&&pu.portaledElement===e};function eS(n,e,t,r){var i=null,o=n;do{var a=r[o];if(a.guard)a.node.dataset.focusAutoGuard&&(i=a);else if(a.lockItem){if(o!==n)return;i=null}else break}while((o+=t)!==e);i&&(i.node.tabIndex=0)}var G6=function(e){return e?!!of:of==="meanwhile"},V6=function n(e,t,r){return t&&(t.host===e&&(!t.activeElement||r.contains(t.activeElement))||t.parentNode&&n(e,t.parentNode,r))},z6=function(e,t){return t.some(function(r){return V6(e,r,r)})},uT=function(e){return nf(e,new Map)},W6=function(e){return!uT([e.parentNode]).some(function(t){return t.node===e})},lp=function(){var e=!1;if(hu){var t=hu,r=t.observed,i=t.persistentFocus,o=t.autoFocus,a=t.shards,s=t.crossFrame,l=t.focusOptions,f=t.noFocusGuards,h=r||pu&&pu.portaledElement;if(lT()&&to&&to!==document.body&&(!document.body.contains(to)||W6(to))){var m=Jw();m&&m.focus()}var g=document&&document.activeElement;if(h){var y=[h].concat(a.map(B6).filter(Boolean)),C=function(){if(!G6(s)||!f||!to||GC)return!1;var E=uT(y),_=E.findIndex(function(T){var M=T.node;return M===to});return _===0||_===E.length-1};if((!g||L6(g))&&(i||C()||!O6()||!to&&o)&&(h&&!(rT(y)||g&&z6(g,y)||j6(g))&&(document&&!to&&g&&!o?(g.blur&&g.blur(),document.body.focus()):(e=oT(y,to,{focusOptions:l}),pu={})),to=document&&document.activeElement,to!==document.body&&(Jw=sT(to)),of=!1),document&&g!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var x=document&&document.activeElement,w=A6(y),S=w.map(function(A){var E=A.node;return E}).indexOf(x);S>-1&&(w.filter(function(A){var E=A.guard,_=A.node;return E&&_.dataset.focusAutoGuard}).forEach(function(A){var E=A.node;return E.removeAttribute("tabIndex")}),eS(S,w.length,1,w),eS(S,-1,-1,w))}}}return e},dT=function(e){lp()&&e&&(e.stopPropagation(),e.preventDefault())},VC=function(){return jC(lp)},H6=function(e){var t=e.target,r=e.currentTarget;r.contains(t)||U6(r,t)},Z6=function(){return null},fT=function(){GC=!0},hT=function(){GC=!1,of="just",jC(function(){of="meanwhile"})},X6=function(){document.addEventListener("focusin",dT),document.addEventListener("focusout",VC),window.addEventListener("focus",fT),window.addEventListener("blur",hT)},$6=function(){document.removeEventListener("focusin",dT),document.removeEventListener("focusout",VC),window.removeEventListener("focus",fT),window.removeEventListener("blur",hT)};function K6(n){return n.filter(function(e){var t=e.disabled;return!t})}var pT={moveFocusInside:oT,focusInside:rT,focusNextElement:P6,focusPrevElement:D6,focusFirstElement:M6,focusLastElement:N6,captureFocusRestore:sT};function q6(n){var e=n.slice(-1)[0];e&&!hu&&X6();var t=hu,r=t&&e&&e.id===t.id;hu=e,t&&!r&&(t.onDeactivation(),n.filter(function(i){var o=i.id;return o===t.id}).length||t.returnFocus(!e)),e?(to=null,(!r||t.observed!==e.observed)&&e.onActivation(pT),lp(),jC(lp)):($6(),to=null)}HE.assignSyncMedium(H6);ZE.assignMedium(VC);WL.assignMedium(function(n){return n(pT)});const Y6=QL(K6,q6)(Z6);var gT=O.forwardRef(function(e,t){return vn.createElement(PC,ef({sideCar:Y6,ref:t},e))}),mT=PC.propTypes||{};mT.sideCar;OL(mT,["sideCar"]);gT.propTypes={};const Q6=vn.forwardRef((n,e)=>{const[t,r]=O.useState(!1),i=O.useRef(null);return vn.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),O.useEffect(()=>{var o;t&&((o=i.current)==null||o.focus())},[t]),O.useEffect(()=>{const o=a=>{a.key==="Escape"&&r(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]),K.jsx(gT,{disabled:!t,children:K.jsxs("dialog",{className:"preferences-dialog",open:t,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[K.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),t&&K.jsx(BL,{}),K.jsx("button",{onClick:()=>r(!1),children:"Close"}),K.jsx("br",{}),K.jsxs("span",{id:"commit-hash",children:["Version: ",IL]})]})})});var vT={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},tS=vn.createContext&&vn.createContext(vT),J6=["attr","size","title"];function e9(n,e){if(n==null)return{};var t=t9(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function t9(n,e){if(n==null)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function up(){return up=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},up.apply(this,arguments)}function nS(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function dp(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?nS(Object(t),!0).forEach(function(r){n9(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):nS(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function n9(n,e,t){return e=r9(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function r9(n){var e=i9(n,"string");return typeof e=="symbol"?e:e+""}function i9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function yT(n){return n&&n.map((e,t)=>vn.createElement(e.tag,dp({key:t},e.attr),yT(e.child)))}function Ps(n){return e=>vn.createElement(o9,up({attr:dp({},n.attr)},e),yT(n.child))}function o9(n){var e=t=>{var{attr:r,size:i,title:o}=n,a=e9(n,J6),s=i||t.size||"1em",l;return t.className&&(l=t.className),n.className&&(l=(l?l+" ":"")+n.className),vn.createElement("svg",up({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,a,{className:l,style:dp(dp({color:n.color||t.color},t.style),n.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),o&&vn.createElement("title",null,o),n.children)};return tS!==void 0?vn.createElement(tS.Consumer,null,t=>e(t)):e(vT)}function CT(n){return Ps({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(n)}function xT(n){return Ps({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(n)}function s9(n){return Ps({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(n)}function a9(n){return Ps({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32zM128 272c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(n)}function c9(n){return Ps({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"},child:[]}]})(n)}function l9(n){return Ps({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(n)}function u9(n){return Ps({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"},child:[]}]})(n)}function bT(n){return Ps({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(n)}function d9(n){return Ps({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(n)}function f9(n){return Ps({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(n)}function h9(n){return Ps({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(n)}const p9=({onFileChange:n,onRecipientChange:e,onSendFile:t,selectedFile:r,recipient:i})=>{const o=s=>{s.target.files&&s.target.files.length>0&&n(s.target.files[0])},a=s=>{e(s.target.value)};return K.jsxs("div",{className:"file-transfer-controls",children:[K.jsx("input",{type:"file",onChange:o}),K.jsx("input",{type:"text",placeholder:"Recipient",value:i,onChange:a}),K.jsx("button",{onClick:t,disabled:!r||!i,children:"Send File"})]})},g9=({progress:n})=>K.jsxs("div",{className:"progress-bar",children:[K.jsx("progress",{value:n,max:"100"}),K.jsxs("span",{children:[n.toFixed(2),"%"]})]}),m9=({offer:n,onAccept:e,onReject:t})=>K.jsxs("div",{className:"incoming-transfer",children:[K.jsxs("p",{children:["Incoming file: ",n.filename," from ",n.sender]}),K.jsx("button",{onClick:()=>e(n.sender,n.hash),children:"Accept"}),K.jsx("button",{onClick:()=>t(n.sender,n.hash),children:"Reject"})]}),v9=({history:n})=>K.jsxs("div",{className:"transfer-history","aria-live":"polite",children:[K.jsx("h4",{children:"Transfer History"}),K.jsx("ul",{children:n.map((e,t)=>K.jsx("li",{children:e},t))})]}),y9=({client:n,expanded:e})=>{const[t,r]=O.useState(null),[i,o]=O.useState(""),[a,s]=O.useState(0),[l,f]=O.useState(0),[h,m]=O.useState([]),[g,y]=O.useState([]),C=O.useCallback(G=>{y(Z=>[...Z,G].slice(-10))},[]),x=O.useCallback(G=>{const Z=G.sentBytes/G.totalBytes*100;s(Z)},[]),w=O.useCallback(G=>{const Z=G.receivedBytes/G.totalBytes*100;f(Z)},[]),S=O.useCallback(G=>{C(`File sent successfully: ${G.filename}`),s(0)},[C]),A=O.useCallback(G=>{C(`File received successfully: ${G.filename}`),f(0)},[C]),E=O.useCallback(G=>{C(`Error ${G.direction}ing file ${G.filename}: ${G.error}`),G.direction==="send"?s(0):f(0)},[C]),_=O.useCallback(G=>{C(`File transfer cancelled: ${G.filename} (${G.direction})`),G.direction==="send"?s(0):f(0)},[C]),T=O.useCallback(G=>{C(`File transfer rejected: ${G.filename} from ${G.sender}`)},[C]),M=O.useCallback(G=>{C(`File transfer accepted: ${G.filename} by ${G.sender}`)},[C]),P=O.useCallback(G=>{m(Z=>[...Z,G]),C(`Incoming file offer: ${G.filename} from ${G.sender}`)},[C]);O.useEffect(()=>(n.on("fileTransferOffer",P),n.on("fileTransferAccepted",M),n.fileTransferManager.on("fileSendProgress",x),n.fileTransferManager.on("fileReceiveProgress",w),n.on("fileTransferError",E),n.on("fileTransferCancelled",_),n.on("fileTransferRejected",T),n.on("fileSendComplete",S),n.fileTransferManager.on("fileReceiveComplete",A),()=>{n.off("fileTransferOffer",P),n.off("fileTransferAccepted",M),n.fileTransferManager.off("fileSendProgress",x),n.fileTransferManager.off("fileReceiveProgress",w),n.off("fileTransferError",E),n.off("fileTransferCancelled",_),n.off("fileTransferRejected",T),n.off("fileSendComplete",S),n.fileTransferManager.off("fileReceiveComplete",A)}),[n,P,M,x,w,E,_,T,S,A]);const j=()=>{t&&i&&n.sendFile(t,i).then(()=>{C(`Sending ${t.name} to ${i}`)}).catch(G=>{C(`Error sending file: ${G.message}`)})},X=(G,Z)=>{n.acceptTransfer(G,Z);const ne=h.find(pe=>pe.hash===Z);ne&&C(`Accepting file transfer: ${ne.filename} from ${G}`),m(pe=>pe.filter(ve=>ve.hash!==Z))},L=(G,Z)=>{n.rejectTransfer(G,Z);const ne=h.find(pe=>pe.hash===Z);ne&&C(`Rejected file transfer: ${ne.filename} from ${G}`),m(pe=>pe.filter(ve=>ve.hash!==Z))};return K.jsxs("div",{className:`file-transfer-ui ${e?"expanded":"collapsed"}`,children:[K.jsx("h3",{children:"File Transfer"}),K.jsx(p9,{onFileChange:r,onRecipientChange:o,onSendFile:j,selectedFile:t,recipient:i}),(a>0||l>0)&&K.jsx(g9,{progress:a>0?a:l}),h.map(G=>K.jsx(m9,{offer:G,onAccept:X,onReject:L},`${G.sender}-${G.filename}`)),K.jsx(v9,{history:g})]})};var rS={};function C9(n,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if(r!=="default"&&!(r in n)){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(n)}var x9=Object.defineProperty,b9=(n,e,t)=>e in n?x9(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,iS=(n,e,t)=>b9(n,typeof e!="symbol"?e+"":e,t);let ao=class{constructor(){iS(this,"_locking"),iS(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const t=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),r}};function _r(n,e){if(!n)throw new Error(e)}const I9=34028234663852886e22,w9=-34028234663852886e22,S9=4294967295,A9=2147483647,k9=-2147483648;function M0(n){if(typeof n!="number")throw new Error("invalid int 32: "+typeof n);if(!Number.isInteger(n)||n>A9||n<k9)throw new Error("invalid int 32: "+n)}function fy(n){if(typeof n!="number")throw new Error("invalid uint 32: "+typeof n);if(!Number.isInteger(n)||n>S9||n<0)throw new Error("invalid uint 32: "+n)}function IT(n){if(typeof n!="number")throw new Error("invalid float 32: "+typeof n);if(Number.isFinite(n)&&(n>I9||n<w9))throw new Error("invalid float 32: "+n)}const wT=Symbol("@bufbuild/protobuf/enum-type");function E9(n){const e=n[wT];return _r(e,"missing enum type on enum object"),e}function ST(n,e,t,r){n[wT]=AT(e,t.map(i=>({no:i.no,name:i.name,localName:n[i.no]})))}function AT(n,e,t){const r=Object.create(null),i=Object.create(null),o=[];for(const a of e){const s=kT(a);o.push(s),r[a.name]=s,i[a.no]=s}return{typeName:n,values:o,findName(a){return r[a]},findNumber(a){return i[a]}}}function T9(n,e,t){const r={};for(const i of e){const o=kT(i);r[o.localName]=o.no,r[o.no]=o.localName}return ST(r,n,e),r}function kT(n){return"localName"in n?n:Object.assign(Object.assign({},n),{localName:n.name})}class zC{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const r=this.getType(),i=r.runtime.bin,o=i.makeReadOptions(t);return i.readMessage(this,o.readerFactory(e),e.byteLength,o),this}fromJson(e,t){const r=this.getType(),i=r.runtime.json,o=i.makeReadOptions(t);return i.readMessage(r,e,o,this),this}fromJsonString(e,t){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,t)}toBinary(e){const t=this.getType(),r=t.runtime.bin,i=r.makeWriteOptions(e),o=i.writerFactory();return r.writeMessage(this,o,i),o.finish()}toJson(e){const t=this.getType(),r=t.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var t;const r=this.toJson(e);return JSON.stringify(r,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function _9(n,e,t,r){var i;const o=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),a={[o]:function(s){n.util.initFields(this),n.util.initPartial(s,this)}}[o];return Object.setPrototypeOf(a.prototype,new zC),Object.assign(a,{runtime:n,typeName:e,fields:n.util.newFieldList(t),fromBinary(s,l){return new a().fromBinary(s,l)},fromJson(s,l){return new a().fromJson(s,l)},fromJsonString(s,l){return new a().fromJsonString(s,l)},equals(s,l){return n.util.equals(a,s,l)}}),a}function R9(){let n=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(n|=(i&127)<<r,(i&128)==0)return this.assertBounds(),[n,e]}let t=this.buf[this.pos++];if(n|=(t&15)<<28,e=(t&112)>>4,(t&128)==0)return this.assertBounds(),[n,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,(i&128)==0)return this.assertBounds(),[n,e]}throw new Error("invalid varint")}function ev(n,e,t){for(let o=0;o<28;o=o+7){const a=n>>>o,s=!(!(a>>>7)&&e==0),l=(s?a|128:a)&255;if(t.push(l),!s)return}const r=n>>>28&15|(e&7)<<4,i=e>>3!=0;if(t.push((i?r|128:r)&255),!!i){for(let o=3;o<31;o=o+7){const a=e>>>o,s=!!(a>>>7),l=(s?a|128:a)&255;if(t.push(l),!s)return}t.push(e>>>31&1)}}const N0=4294967296;function oS(n){const e=n[0]==="-";e&&(n=n.slice(1));const t=1e6;let r=0,i=0;function o(a,s){const l=Number(n.slice(a,s));i*=t,r=r*t+l,r>=N0&&(i=i+(r/N0|0),r=r%N0)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),e?TT(r,i):WC(r,i)}function P9(n,e){let t=WC(n,e);const r=t.hi&2147483648;r&&(t=TT(t.lo,t.hi));const i=ET(t.lo,t.hi);return r?"-"+i:i}function ET(n,e){if({lo:n,hi:e}=D9(n,e),e<=2097151)return String(N0*e+n);const t=n&16777215,r=(n>>>24|e<<8)&16777215,i=e>>16&65535;let o=t+r*6777216+i*6710656,a=r+i*8147497,s=i*2;const l=1e7;return o>=l&&(a+=Math.floor(o/l),o%=l),a>=l&&(s+=Math.floor(a/l),a%=l),s.toString()+sS(a)+sS(o)}function D9(n,e){return{lo:n>>>0,hi:e>>>0}}function WC(n,e){return{lo:n|0,hi:e|0}}function TT(n,e){return e=~e,n?n=~n+1:e+=1,WC(n,e)}const sS=n=>{const e=String(n);return"0000000".slice(e.length)+e};function aS(n,e){if(n>=0){for(;n>127;)e.push(n&127|128),n=n>>>7;e.push(n)}else{for(let t=0;t<9;t++)e.push(n&127|128),n=n>>7;e.push(1)}}function M9(){let n=this.buf[this.pos++],e=n&127;if((n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<7,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<14,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<21,(n&128)==0)return this.assertBounds(),e;n=this.buf[this.pos++],e|=(n&15)<<28;for(let t=5;(n&128)!==0&&t<10;t++)n=this.buf[this.pos++];if((n&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function N9(){const n=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof n.getBigInt64=="function"&&typeof n.getBigUint64=="function"&&typeof n.setBigInt64=="function"&&typeof n.setBigUint64=="function"&&(typeof process!="object"||typeof rS!="object"||rS.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),a=BigInt("0"),s=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(l){const f=typeof l=="bigint"?l:BigInt(l);if(f>o||f<i)throw new Error("int64 invalid: ".concat(l));return f},uParse(l){const f=typeof l=="bigint"?l:BigInt(l);if(f>s||f<a)throw new Error("uint64 invalid: ".concat(l));return f},enc(l){return n.setBigInt64(0,this.parse(l),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},uEnc(l){return n.setBigInt64(0,this.uParse(l),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},dec(l,f){return n.setInt32(0,l,!0),n.setInt32(4,f,!0),n.getBigInt64(0,!0)},uDec(l,f){return n.setInt32(0,l,!0),n.setInt32(4,f,!0),n.getBigUint64(0,!0)}}}const t=i=>_r(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>_r(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),t(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),t(i),oS(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),oS(i)},dec(i,o){return P9(i,o)},uDec(i,o){return ET(i,o)}}}const gr=N9();var Ye;(function(n){n[n.DOUBLE=1]="DOUBLE",n[n.FLOAT=2]="FLOAT",n[n.INT64=3]="INT64",n[n.UINT64=4]="UINT64",n[n.INT32=5]="INT32",n[n.FIXED64=6]="FIXED64",n[n.FIXED32=7]="FIXED32",n[n.BOOL=8]="BOOL",n[n.STRING=9]="STRING",n[n.BYTES=12]="BYTES",n[n.UINT32=13]="UINT32",n[n.SFIXED32=15]="SFIXED32",n[n.SFIXED64=16]="SFIXED64",n[n.SINT32=17]="SINT32",n[n.SINT64=18]="SINT64"})(Ye||(Ye={}));var Ac;(function(n){n[n.BIGINT=0]="BIGINT",n[n.STRING=1]="STRING"})(Ac||(Ac={}));function ac(n,e,t){if(e===t)return!0;if(n==Ye.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}switch(n){case Ye.UINT64:case Ye.FIXED64:case Ye.INT64:case Ye.SFIXED64:case Ye.SINT64:return e==t}return!1}function Ru(n,e){switch(n){case Ye.BOOL:return!1;case Ye.UINT64:case Ye.FIXED64:case Ye.INT64:case Ye.SFIXED64:case Ye.SINT64:return e==0?gr.zero:"0";case Ye.DOUBLE:case Ye.FLOAT:return 0;case Ye.BYTES:return new Uint8Array(0);case Ye.STRING:return"";default:return 0}}function _T(n,e){switch(n){case Ye.BOOL:return e===!1;case Ye.STRING:return e==="";case Ye.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var Mr;(function(n){n[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32"})(Mr||(Mr={}));class B9{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let t=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)t.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(fy(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return M0(e),aS(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){IT(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){fy(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){M0(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return M0(e),e=(e<<1^e>>31)>>>0,aS(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=gr.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=gr.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=gr.enc(e);return ev(t.lo,t.hi,this.buf),this}sint64(e){let t=gr.enc(e),r=t.hi>>31,i=t.lo<<1^r,o=(t.hi<<1|t.lo>>>31)^r;return ev(i,o,this.buf),this}uint64(e){let t=gr.uEnc(e);return ev(t.lo,t.hi,this.buf),this}}class O9{constructor(e,t){this.varint64=R9,this.uint32=M9,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,r=e&7;if(t<=0||r<0||r>5)throw new Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e,t){let r=this.pos;switch(e){case Mr.Varint:for(;this.buf[this.pos++]&128;);break;case Mr.Bit64:this.pos+=4;case Mr.Bit32:this.pos+=4;break;case Mr.LengthDelimited:let i=this.uint32();this.pos+=i;break;case Mr.StartGroup:for(;;){const[o,a]=this.tag();if(a===Mr.EndGroup){if(t!==void 0&&o!==t)throw new Error("invalid end group tag");break}this.skip(a,o)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return gr.dec(...this.varint64())}uint64(){return gr.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(e&1);return e=(e>>>1|(t&1)<<31)^r,t=t>>>1^r,gr.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return gr.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return gr.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function F9(n,e,t,r){let i;return{typeName:e,extendee:t,get field(){if(!i){const o=typeof r=="function"?r():r;o.name=e.split(".").pop(),o.jsonName="[".concat(e,"]"),i=n.util.newFieldList([o]).list()[0]}return i},runtime:n}}function RT(n){const e=n.field.localName,t=Object.create(null);return t[e]=L9(n),[t,()=>t[e]]}function L9(n){const e=n.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return Ru(e.T,e.L);case"message":const t=e.T,r=new t;return t.fieldWrapper?t.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function U9(n,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let t=n.length-1;t>=0;--t)if(n[t].no==e.no)return[n[t]];return[]}return n.filter(t=>t.no===e.no)}let Aa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Lp=[];for(let n=0;n<Aa.length;n++)Lp[Aa[n].charCodeAt(0)]=n;Lp[45]=Aa.indexOf("+");Lp[95]=Aa.indexOf("/");const PT={dec(n){let e=n.length*3/4;n[n.length-2]=="="?e-=2:n[n.length-1]=="="&&(e-=1);let t=new Uint8Array(e),r=0,i=0,o,a=0;for(let s=0;s<n.length;s++){if(o=Lp[n.charCodeAt(s)],o===void 0)switch(n[s]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:a=o,i=1;break;case 1:t[r++]=a<<2|(o&48)>>4,a=o,i=2;break;case 2:t[r++]=(a&15)<<4|(o&60)>>2,a=o,i=3;break;case 3:t[r++]=(a&3)<<6|o,i=0;break}}if(i==1)throw Error("invalid base64 string.");return t.subarray(0,r)},enc(n){let e="",t=0,r,i=0;for(let o=0;o<n.length;o++)switch(r=n[o],t){case 0:e+=Aa[r>>2],i=(r&3)<<4,t=1;break;case 1:e+=Aa[i|r>>4],i=(r&15)<<2,t=2;break;case 2:e+=Aa[i|r>>6],e+=Aa[r&63],t=0;break}return t&&(e+=Aa[i],e+="=",t==1&&(e+="=")),e}};function j9(n,e,t){MT(e,n);const r=e.runtime.bin.makeReadOptions(t),i=U9(n.getType().runtime.bin.listUnknownFields(n),e.field),[o,a]=RT(e);for(const s of i)e.runtime.bin.readField(o,r.readerFactory(s.data),e.field,s.wireType,r);return a()}function G9(n,e,t,r){MT(e,n);const i=e.runtime.bin.makeReadOptions(r),o=e.runtime.bin.makeWriteOptions(r);if(DT(n,e)){const f=n.getType().runtime.bin.listUnknownFields(n).filter(h=>h.no!=e.field.no);n.getType().runtime.bin.discardUnknownFields(n);for(const h of f)n.getType().runtime.bin.onUnknownField(n,h.no,h.wireType,h.data)}const a=o.writerFactory();let s=e.field;!s.opt&&!s.repeated&&(s.kind=="enum"||s.kind=="scalar")&&(s=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(s,t,a,o);const l=i.readerFactory(a.finish());for(;l.pos<l.len;){const[f,h]=l.tag(),m=l.skip(h,f);n.getType().runtime.bin.onUnknownField(n,f,h,m)}}function DT(n,e){const t=n.getType();return e.extendee.typeName===t.typeName&&!!t.runtime.bin.listUnknownFields(n).find(r=>r.no==e.field.no)}function MT(n,e){_r(n.extendee.typeName==e.getType().typeName,"extension ".concat(n.typeName," can only be applied to message ").concat(n.extendee.typeName))}function NT(n,e){const t=n.localName;if(n.repeated)return e[t].length>0;if(n.oneof)return e[n.oneof.localName].case===t;switch(n.kind){case"enum":case"scalar":return n.opt||n.req?e[t]!==void 0:n.kind=="enum"?e[t]!==n.T.values[0].no:!_T(n.T,e[t]);case"message":return e[t]!==void 0;case"map":return Object.keys(e[t]).length>0}}function cS(n,e){const t=n.localName,r=!n.opt&&!n.req;if(n.repeated)e[t]=[];else if(n.oneof)e[n.oneof.localName]={case:void 0};else switch(n.kind){case"map":e[t]={};break;case"enum":e[t]=r?n.T.values[0].no:void 0;break;case"scalar":e[t]=r?Ru(n.T,n.L):void 0;break;case"message":e[t]=void 0;break}}function ka(n,e){if(n===null||typeof n!="object"||!Object.getOwnPropertyNames(zC.prototype).every(r=>r in n&&typeof n[r]=="function"))return!1;const t=n.getType();return t===null||typeof t!="function"||!("typeName"in t)||typeof t.typeName!="string"?!1:e===void 0?!0:t.typeName==e.typeName}function BT(n,e){return ka(e)||!n.fieldWrapper?e:n.fieldWrapper.wrapField(e)}Ye.DOUBLE,Ye.FLOAT,Ye.INT64,Ye.UINT64,Ye.INT32,Ye.UINT32,Ye.BOOL,Ye.STRING,Ye.BYTES;const lS={ignoreUnknownFields:!1},uS={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function V9(n){return n?Object.assign(Object.assign({},lS),n):lS}function z9(n){return n?Object.assign(Object.assign({},uS),n):uS}const fp=Symbol(),B0=Symbol();function W9(){return{makeReadOptions:V9,makeWriteOptions:z9,readMessage(n,e,t,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(Ws(e)));r=r??new n;const i=new Map,o=t.typeRegistry;for(const[a,s]of Object.entries(e)){const l=n.fields.findJsonName(a);if(l){if(l.oneof){if(s===null&&l.kind=="scalar")continue;const f=i.get(l.oneof);if(f!==void 0)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(l.oneof.name,'" present: "').concat(f,'", "').concat(a,'"'));i.set(l.oneof,a)}dS(r,s,l,t,n)}else{let f=!1;if(o!=null&&o.findExtension&&a.startsWith("[")&&a.endsWith("]")){const h=o.findExtension(a.substring(1,a.length-1));if(h&&h.extendee.typeName==n.typeName){f=!0;const[m,g]=RT(h);dS(m,s,h.field,t,h),G9(r,h,g(),t)}}if(!f&&!t.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'))}}return r},writeMessage(n,e){const t=n.getType(),r={};let i;try{for(i of t.fields.byNumber()){if(!NT(i,n)){if(i.req)throw"required field not set";if(!e.emitDefaultValues||!Z9(i))continue}const a=i.oneof?n[i.oneof.localName].value:n[i.localName],s=fS(i,a,e);s!==void 0&&(r[e.useProtoFieldName?i.name:i.jsonName]=s)}const o=e.typeRegistry;if(o!=null&&o.findExtensionFor)for(const a of t.runtime.bin.listUnknownFields(n)){const s=o.findExtensionFor(t.typeName,a.no);if(s&&DT(n,s)){const l=j9(n,s,e),f=fS(s.field,l,e);f!==void 0&&(r[s.field.jsonName]=f)}}}catch(o){const a=i?"cannot encode field ".concat(t.typeName,".").concat(i.name," to JSON"):"cannot encode message ".concat(t.typeName," to JSON"),s=o instanceof Error?o.message:String(o);throw new Error(a+(s.length>0?": ".concat(s):""))}return r},readScalar(n,e,t){return zd(n,e,t??Ac.BIGINT,!0)},writeScalar(n,e,t){if(e!==void 0&&(t||_T(n,e)))return O0(n,e)},debug:Ws}}function Ws(n){if(n===null)return"null";switch(typeof n){case"object":return Array.isArray(n)?"array":"object";case"string":return n.length>100?"string":'"'.concat(n.split('"').join('\\"'),'"');default:return String(n)}}function dS(n,e,t,r,i){let o=t.localName;if(t.repeated){if(_r(t.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ws(e)));const a=n[o];for(const s of e){if(s===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ws(s)));switch(t.kind){case"message":a.push(t.T.fromJson(s,r));break;case"enum":const l=tv(t.T,s,r.ignoreUnknownFields,!0);l!==B0&&a.push(l);break;case"scalar":try{a.push(zd(t.T,s,t.L,!0))}catch(f){let h="cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ws(s));throw f instanceof Error&&f.message.length>0&&(h+=": ".concat(f.message)),new Error(h)}break}}}else if(t.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ws(e)));const a=n[o];for(const[s,l]of Object.entries(e)){if(l===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: map value null"));let f;try{f=H9(t.K,s)}catch(h){let m="cannot decode map key for field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ws(e));throw h instanceof Error&&h.message.length>0&&(m+=": ".concat(h.message)),new Error(m)}switch(t.V.kind){case"message":a[f]=t.V.T.fromJson(l,r);break;case"enum":const h=tv(t.V.T,l,r.ignoreUnknownFields,!0);h!==B0&&(a[f]=h);break;case"scalar":try{a[f]=zd(t.V.T,l,Ac.BIGINT,!0)}catch(m){let g="cannot decode map value for field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ws(e));throw m instanceof Error&&m.message.length>0&&(g+=": ".concat(m.message)),new Error(g)}break}}}else switch(t.oneof&&(n=n[t.oneof.localName]={case:o},o="value"),t.kind){case"message":const a=t.T;if(e===null&&a.typeName!="google.protobuf.Value")return;let s=n[o];ka(s)?s.fromJson(e,r):(n[o]=s=a.fromJson(e,r),a.fieldWrapper&&!t.oneof&&(n[o]=a.fieldWrapper.unwrapField(s)));break;case"enum":const l=tv(t.T,e,r.ignoreUnknownFields,!1);switch(l){case fp:cS(t,n);break;case B0:break;default:n[o]=l;break}break;case"scalar":try{const f=zd(t.T,e,t.L,!1);switch(f){case fp:cS(t,n);break;default:n[o]=f;break}}catch(f){let h="cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ws(e));throw f instanceof Error&&f.message.length>0&&(h+=": ".concat(f.message)),new Error(h)}break}}function H9(n,e){if(n===Ye.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return zd(n,e,Ac.BIGINT,!0).toString()}function zd(n,e,t,r){if(e===null)return r?Ru(n,t):fp;switch(n){case Ye.DOUBLE:case Ye.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const i=Number(e);if(Number.isNaN(i)||!Number.isFinite(i))break;return n==Ye.FLOAT&&IT(i),i;case Ye.INT32:case Ye.FIXED32:case Ye.SFIXED32:case Ye.SINT32:case Ye.UINT32:let o;if(typeof e=="number"?o=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(o=Number(e)),o===void 0)break;return n==Ye.UINT32||n==Ye.FIXED32?fy(o):M0(o),o;case Ye.INT64:case Ye.SFIXED64:case Ye.SINT64:if(typeof e!="number"&&typeof e!="string")break;const a=gr.parse(e);return t?a.toString():a;case Ye.FIXED64:case Ye.UINT64:if(typeof e!="number"&&typeof e!="string")break;const s=gr.uParse(e);return t?s.toString():s;case Ye.BOOL:if(typeof e!="boolean")break;return e;case Ye.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case Ye.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return PT.dec(e)}throw new Error}function tv(n,e,t,r){if(e===null)return n.typeName=="google.protobuf.NullValue"?0:r?n.values[0].no:fp;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const i=n.findName(e);if(i!==void 0)return i.no;if(t)return B0;break}throw new Error("cannot decode enum ".concat(n.typeName," from JSON: ").concat(Ws(e)))}function Z9(n){return n.repeated||n.kind=="map"?!0:!(n.oneof||n.kind=="message"||n.opt||n.req)}function fS(n,e,t){if(n.kind=="map"){_r(typeof e=="object"&&e!=null);const r={},i=Object.entries(e);switch(n.V.kind){case"scalar":for(const[a,s]of i)r[a.toString()]=O0(n.V.T,s);break;case"message":for(const[a,s]of i)r[a.toString()]=s.toJson(t);break;case"enum":const o=n.V.T;for(const[a,s]of i)r[a.toString()]=nv(o,s,t.enumAsInteger);break}return t.emitDefaultValues||i.length>0?r:void 0}if(n.repeated){_r(Array.isArray(e));const r=[];switch(n.kind){case"scalar":for(let i=0;i<e.length;i++)r.push(O0(n.T,e[i]));break;case"enum":for(let i=0;i<e.length;i++)r.push(nv(n.T,e[i],t.enumAsInteger));break;case"message":for(let i=0;i<e.length;i++)r.push(e[i].toJson(t));break}return t.emitDefaultValues||r.length>0?r:void 0}switch(n.kind){case"scalar":return O0(n.T,e);case"enum":return nv(n.T,e,t.enumAsInteger);case"message":return BT(n.T,e).toJson(t)}}function nv(n,e,t){var r;if(_r(typeof e=="number"),n.typeName=="google.protobuf.NullValue")return null;if(t)return e;const i=n.findNumber(e);return(r=i==null?void 0:i.name)!==null&&r!==void 0?r:e}function O0(n,e){switch(n){case Ye.INT32:case Ye.SFIXED32:case Ye.SINT32:case Ye.FIXED32:case Ye.UINT32:return _r(typeof e=="number"),e;case Ye.FLOAT:case Ye.DOUBLE:return _r(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case Ye.STRING:return _r(typeof e=="string"),e;case Ye.BOOL:return _r(typeof e=="boolean"),e;case Ye.UINT64:case Ye.FIXED64:case Ye.INT64:case Ye.SFIXED64:case Ye.SINT64:return _r(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case Ye.BYTES:return _r(e instanceof Uint8Array),PT.enc(e)}}const su=Symbol("@bufbuild/protobuf/unknown-fields"),hS={readUnknownFields:!0,readerFactory:n=>new O9(n)},pS={writeUnknownFields:!0,writerFactory:()=>new B9};function X9(n){return n?Object.assign(Object.assign({},hS),n):hS}function $9(n){return n?Object.assign(Object.assign({},pS),n):pS}function K9(){return{makeReadOptions:X9,makeWriteOptions:$9,listUnknownFields(n){var e;return(e=n[su])!==null&&e!==void 0?e:[]},discardUnknownFields(n){delete n[su]},writeUnknownFields(n,e){const r=n[su];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(n,e,t,r){const i=n;Array.isArray(i[su])||(i[su]=[]),i[su].push({no:e,wireType:t,data:r})},readMessage(n,e,t,r,i){const o=n.getType(),a=i?e.len:e.pos+t;let s,l;for(;e.pos<a&&([s,l]=e.tag(),!(i===!0&&l==Mr.EndGroup));){const f=o.fields.find(s);if(!f){const h=e.skip(l,s);r.readUnknownFields&&this.onUnknownField(n,s,l,h);continue}gS(n,e,f,l,r)}if(i&&(l!=Mr.EndGroup||s!==t))throw new Error("invalid end group tag")},readField:gS,writeMessage(n,e,t){const r=n.getType();for(const i of r.fields.byNumber()){if(!NT(i,n)){if(i.req)throw new Error("cannot encode field ".concat(r.typeName,".").concat(i.name," to binary: required field not set"));continue}const o=i.oneof?n[i.oneof.localName].value:n[i.localName];mS(i,o,e,t)}return t.writeUnknownFields&&this.writeUnknownFields(n,e),e},writeField(n,e,t,r){e!==void 0&&mS(n,e,t,r)}}}function gS(n,e,t,r,i){let{repeated:o,localName:a}=t;switch(t.oneof&&(n=n[t.oneof.localName],n.case!=a&&delete n.value,n.case=a,a="value"),t.kind){case"scalar":case"enum":const s=t.kind=="enum"?Ye.INT32:t.T;let l=hp;if(t.kind=="scalar"&&t.L>0&&(l=Y9),o){let g=n[a];if(r==Mr.LengthDelimited&&s!=Ye.STRING&&s!=Ye.BYTES){let C=e.uint32()+e.pos;for(;e.pos<C;)g.push(l(e,s))}else g.push(l(e,s))}else n[a]=l(e,s);break;case"message":const f=t.T;o?n[a].push(F0(e,new f,i,t)):ka(n[a])?F0(e,n[a],i,t):(n[a]=F0(e,new f,i,t),f.fieldWrapper&&!t.oneof&&!t.repeated&&(n[a]=f.fieldWrapper.unwrapField(n[a])));break;case"map":let[h,m]=q9(t,e,i);n[a][h]=m;break}}function F0(n,e,t,r){const i=e.getType().runtime.bin,o=r==null?void 0:r.delimited;return i.readMessage(e,n,o?r.no:n.uint32(),t,o),e}function q9(n,e,t){const r=e.uint32(),i=e.pos+r;let o,a;for(;e.pos<i;){const[s]=e.tag();switch(s){case 1:o=hp(e,n.K);break;case 2:switch(n.V.kind){case"scalar":a=hp(e,n.V.T);break;case"enum":a=e.int32();break;case"message":a=F0(e,new n.V.T,t,void 0);break}break}}if(o===void 0&&(o=Ru(n.K,Ac.BIGINT)),typeof o!="string"&&typeof o!="number"&&(o=o.toString()),a===void 0)switch(n.V.kind){case"scalar":a=Ru(n.V.T,Ac.BIGINT);break;case"enum":a=n.V.T.values[0].no;break;case"message":a=new n.V.T;break}return[o,a]}function Y9(n,e){const t=hp(n,e);return typeof t=="bigint"?t.toString():t}function hp(n,e){switch(e){case Ye.STRING:return n.string();case Ye.BOOL:return n.bool();case Ye.DOUBLE:return n.double();case Ye.FLOAT:return n.float();case Ye.INT32:return n.int32();case Ye.INT64:return n.int64();case Ye.UINT64:return n.uint64();case Ye.FIXED64:return n.fixed64();case Ye.BYTES:return n.bytes();case Ye.FIXED32:return n.fixed32();case Ye.SFIXED32:return n.sfixed32();case Ye.SFIXED64:return n.sfixed64();case Ye.SINT64:return n.sint64();case Ye.UINT32:return n.uint32();case Ye.SINT32:return n.sint32()}}function mS(n,e,t,r){_r(e!==void 0);const i=n.repeated;switch(n.kind){case"scalar":case"enum":let o=n.kind=="enum"?Ye.INT32:n.T;if(i)if(_r(Array.isArray(e)),n.packed)J9(t,o,n.no,e);else for(const a of e)Wd(t,o,n.no,a);else Wd(t,o,n.no,e);break;case"message":if(i){_r(Array.isArray(e));for(const a of e)vS(t,r,n,a)}else vS(t,r,n,e);break;case"map":_r(typeof e=="object"&&e!=null);for(const[a,s]of Object.entries(e))Q9(t,r,n,a,s);break}}function Q9(n,e,t,r,i){n.tag(t.no,Mr.LengthDelimited),n.fork();let o=r;switch(t.K){case Ye.INT32:case Ye.FIXED32:case Ye.UINT32:case Ye.SFIXED32:case Ye.SINT32:o=Number.parseInt(r);break;case Ye.BOOL:_r(r=="true"||r=="false"),o=r=="true";break}switch(Wd(n,t.K,1,o),t.V.kind){case"scalar":Wd(n,t.V.T,2,i);break;case"enum":Wd(n,Ye.INT32,2,i);break;case"message":_r(i!==void 0),n.tag(2,Mr.LengthDelimited).bytes(i.toBinary(e));break}n.join()}function vS(n,e,t,r){const i=BT(t.T,r);t.delimited?n.tag(t.no,Mr.StartGroup).raw(i.toBinary(e)).tag(t.no,Mr.EndGroup):n.tag(t.no,Mr.LengthDelimited).bytes(i.toBinary(e))}function Wd(n,e,t,r){_r(r!==void 0);let[i,o]=OT(e);n.tag(t,i)[o](r)}function J9(n,e,t,r){if(!r.length)return;n.tag(t,Mr.LengthDelimited).fork();let[,i]=OT(e);for(let o=0;o<r.length;o++)n[i](r[o]);n.join()}function OT(n){let e=Mr.Varint;switch(n){case Ye.BYTES:case Ye.STRING:e=Mr.LengthDelimited;break;case Ye.DOUBLE:case Ye.FIXED64:case Ye.SFIXED64:e=Mr.Bit64;break;case Ye.FIXED32:case Ye.SFIXED32:case Ye.FLOAT:e=Mr.Bit32;break}const t=Ye[n].toLowerCase();return[e,t]}function e7(){return{setEnumType:ST,initPartial(n,e){if(n===void 0)return;const t=e.getType();for(const r of t.fields.byMember()){const i=r.localName,o=e,a=n;if(a[i]!=null)switch(r.kind){case"oneof":const s=a[i].case;if(s===void 0)continue;const l=r.findField(s);let f=a[i].value;l&&l.kind=="message"&&!ka(f,l.T)?f=new l.T(f):l&&l.kind==="scalar"&&l.T===Ye.BYTES&&(f=kd(f)),o[i]={case:s,value:f};break;case"scalar":case"enum":let h=a[i];r.T===Ye.BYTES&&(h=r.repeated?h.map(kd):kd(h)),o[i]=h;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===Ye.BYTES)for(const[y,C]of Object.entries(a[i]))o[i][y]=kd(C);else Object.assign(o[i],a[i]);break;case"message":const g=r.V.T;for(const y of Object.keys(a[i])){let C=a[i][y];g.fieldWrapper||(C=new g(C)),o[i][y]=C}break}break;case"message":const m=r.T;if(r.repeated)o[i]=a[i].map(g=>ka(g,m)?g:new m(g));else{const g=a[i];m.fieldWrapper?m.typeName==="google.protobuf.BytesValue"?o[i]=kd(g):o[i]=g:o[i]=ka(g,m)?g:new m(g)}break}}},equals(n,e,t){return e===t?!0:!e||!t?!1:n.fields.byMember().every(r=>{const i=e[r.localName],o=t[r.localName];if(r.repeated){if(i.length!==o.length)return!1;switch(r.kind){case"message":return i.every((a,s)=>r.T.equals(a,o[s]));case"scalar":return i.every((a,s)=>ac(r.T,a,o[s]));case"enum":return i.every((a,s)=>ac(Ye.INT32,a,o[s]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":let a=i,s=o;return r.T.fieldWrapper&&(a!==void 0&&!ka(a)&&(a=r.T.fieldWrapper.wrapField(a)),s!==void 0&&!ka(s)&&(s=r.T.fieldWrapper.wrapField(s))),r.T.equals(a,s);case"enum":return ac(Ye.INT32,i,o);case"scalar":return ac(r.T,i,o);case"oneof":if(i.case!==o.case)return!1;const l=r.findField(i.case);if(l===void 0)return!0;switch(l.kind){case"message":return l.T.equals(i.value,o.value);case"enum":return ac(Ye.INT32,i.value,o.value);case"scalar":return ac(l.T,i.value,o.value)}throw new Error("oneof cannot contain ".concat(l.kind));case"map":const f=Object.keys(i).concat(Object.keys(o));switch(r.V.kind){case"message":const h=r.V.T;return f.every(g=>h.equals(i[g],o[g]));case"enum":return f.every(g=>ac(Ye.INT32,i[g],o[g]));case"scalar":const m=r.V.T;return f.every(g=>ac(m,i[g],o[g]))}break}})},clone(n){const e=n.getType(),t=new e,r=t;for(const i of e.fields.byMember()){const o=n[i.localName];let a;if(i.repeated)a=o.map(Mh);else if(i.kind=="map"){a=r[i.localName];for(const[s,l]of Object.entries(o))a[s]=Mh(l)}else i.kind=="oneof"?a=i.findField(o.case)?{case:o.case,value:Mh(o.value)}:{case:void 0}:a=Mh(o);r[i.localName]=a}for(const i of e.runtime.bin.listUnknownFields(n))e.runtime.bin.onUnknownField(r,i.no,i.wireType,i.data);return t}}}function Mh(n){if(n===void 0)return n;if(ka(n))return n.clone();if(n instanceof Uint8Array){const e=new Uint8Array(n.byteLength);return e.set(n),e}return n}function kd(n){return n instanceof Uint8Array?n:new Uint8Array(n)}function t7(n,e,t){return{syntax:n,json:W9(),bin:K9(),util:Object.assign(Object.assign({},e7()),{newFieldList:e,initFields:t}),makeMessageType(r,i,o){return _9(this,r,i,o)},makeEnum:T9,makeEnumType:AT,getEnumType:E9,makeExtension(r,i,o){return F9(this,r,i,o)}}}class n7{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const r of this.list())t[r.jsonName]=t[r.name]=r;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const r of this.list())t[r.no]=r;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const r of this.list())r.oneof?r.oneof!==t&&(t=r.oneof,e.push(t)):e.push(r)}return this.members}}function FT(n,e){const t=LT(n);return e?t:c7(a7(t))}function r7(n){return FT(n,!1)}const i7=LT;function LT(n){let e=!1;const t=[];for(let r=0;r<n.length;r++){let i=n.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),t.push(i);break}}return t.join("")}const o7=new Set(["constructor","toString","toJSON","valueOf"]),s7=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),UT=n=>"".concat(n,"$"),a7=n=>s7.has(n)?UT(n):n,c7=n=>o7.has(n)?UT(n):n;class l7{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=r7(e)}addField(e){_r(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}function u7(n,e){var t,r,i,o,a,s;const l=[];let f;for(const h of typeof n=="function"?n():n){const m=h;if(m.localName=FT(h.name,h.oneof!==void 0),m.jsonName=(t=h.jsonName)!==null&&t!==void 0?t:i7(h.name),m.repeated=(r=h.repeated)!==null&&r!==void 0?r:!1,h.kind=="scalar"&&(m.L=(i=h.L)!==null&&i!==void 0?i:Ac.BIGINT),m.delimited=(o=h.delimited)!==null&&o!==void 0?o:!1,m.req=(a=h.req)!==null&&a!==void 0?a:!1,m.opt=(s=h.opt)!==null&&s!==void 0?s:!1,h.packed===void 0&&(m.packed=h.kind=="enum"||h.kind=="scalar"&&h.T!=Ye.BYTES&&h.T!=Ye.STRING),h.oneof!==void 0){const g=typeof h.oneof=="string"?h.oneof:h.oneof.name;(!f||f.name!=g)&&(f=new l7(g)),m.oneof=f,f.addField(m)}l.push(m)}return l}const je=t7("proto3",n=>new n7(n,e=>u7(e)),n=>{for(const e of n.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,r=n;if(e.repeated){r[t]=[];continue}switch(e.kind){case"oneof":r[t]={case:void 0};break;case"enum":r[t]=0;break;case"map":r[t]={};break;case"scalar":r[t]=Ru(e.T,e.L);break}}});class io extends zC{constructor(e){super(),this.seconds=gr.zero,this.nanos=0,je.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(je.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=gr.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(t).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return io.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new io({seconds:gr.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new io().fromBinary(e,t)}static fromJson(e,t){return new io().fromJson(e,t)}static fromJsonString(e,t){return new io().fromJsonString(e,t)}static equals(e,t){return je.util.equals(io,e,t)}}io.runtime=je;io.typeName="google.protobuf.Timestamp";io.fields=je.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const d7=je.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:io},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:f7,repeated:!0},{no:5,name:"events",kind:"message",T:p7,repeated:!0}]),f7=je.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:h7,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),h7=je.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:io},{no:3,name:"value",kind:"scalar",T:2}]),p7=je.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:io},{no:7,name:"normalized_end_timestamp",kind:"message",T:io,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),jT=je.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),Cs=je.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),Ur=je.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),HC=je.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Ud=je.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),sf=je.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),ws=je.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),au=je.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),g7=je.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),si=je.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),Up=je.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:pp,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:JT}]),pp=je.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),m7=je.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:je.getEnumType(Ur),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Cl=je.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:je.getEnumType(gu)},{no:4,name:"tracks",kind:"message",T:uu,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:m7},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:je.getEnumType(af)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:je.getEnumType(ws)},{no:18,name:"kind_details",kind:"enum",T:je.getEnumType(v7),repeated:!0}]),gu=je.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),af=je.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),v7=je.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),Eo=je.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),y7=je.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:fl,repeated:!0}]),uu=je.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:je.getEnumType(Cs)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:je.getEnumType(Ur)},{no:10,name:"layers",kind:"message",T:fl,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:y7,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:je.getEnumType(Eo)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:JT},{no:19,name:"audio_features",kind:"enum",T:je.getEnumType(si),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:je.getEnumType(jT)}]),fl=je.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:je.getEnumType(HC)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),oo=je.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:je.getEnumType(bn)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:VT,oneof:"value"},{no:3,name:"speaker",kind:"message",T:C7,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:zT,oneof:"value"},{no:7,name:"transcription",kind:"message",T:x7,oneof:"value"},{no:8,name:"metrics",kind:"message",T:d7,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:hy,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:WT,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:HT,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:ZT,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:gy,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:my,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:vy,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),bn=je.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),C7=je.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:GT,repeated:!0}]),GT=je.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),VT=je.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),zT=je.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),x7=je.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:b7,repeated:!0}]),b7=je.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),hy=je.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),WT=je.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),HT=je.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),ZT=je.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:XT,oneof:"value"}]),XT=je.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),$T=je.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),KT=je.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:je.getEnumType(qT)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),qT=je.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),I7=je.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:je.getEnumType(YT)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),YT=je.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),QT=je.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:yS},{no:2,name:"screen",kind:"message",T:yS},{no:3,name:"resume_connection",kind:"enum",T:je.getEnumType(sf)},{no:4,name:"disabled_codecs",kind:"message",T:w7},{no:5,name:"force_relay",kind:"enum",T:je.getEnumType(sf)}]),yS=je.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:je.getEnumType(sf)}]),w7=je.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:pp,repeated:!0},{no:2,name:"publish",kind:"message",T:pp,repeated:!0}]),JT=je.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),py=je.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),e_=je.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:je.getEnumType(py)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),t_=je.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),gy=je.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:je.getEnumType(Eo)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:e_,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:t_,oneof:"content_header"}],{localName:"DataStream_Header"}),my=je.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),vy=je.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),xs=je.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),yy=je.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),S7=je.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),A7=je.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:xl,oneof:"message"},{no:2,name:"answer",kind:"message",T:xl,oneof:"message"},{no:3,name:"trickle",kind:"message",T:ZC,oneof:"message"},{no:4,name:"add_track",kind:"message",T:xy,oneof:"message"},{no:5,name:"mute",kind:"message",T:XC,oneof:"message"},{no:6,name:"subscription",kind:"message",T:jp,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:n_,oneof:"message"},{no:8,name:"leave",kind:"message",T:Gp,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:i_,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:c_,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:l_,oneof:"message"},{no:13,name:"simulate",kind:"message",T:zs,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:o_,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:f_,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:r_,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:R7,oneof:"message"}]),CS=je.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:k7,oneof:"message"},{no:2,name:"answer",kind:"message",T:xl,oneof:"message"},{no:3,name:"offer",kind:"message",T:xl,oneof:"message"},{no:4,name:"trickle",kind:"message",T:ZC,oneof:"message"},{no:5,name:"update",kind:"message",T:_7,oneof:"message"},{no:6,name:"track_published",kind:"message",T:$C,oneof:"message"},{no:8,name:"leave",kind:"message",T:Gp,oneof:"message"},{no:9,name:"mute",kind:"message",T:XC,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:P7,oneof:"message"},{no:11,name:"room_update",kind:"message",T:D7,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:N7,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:O7,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:L7,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:U7,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:T7,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:E7,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:G7,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:W7,oneof:"message"},{no:22,name:"request_response",kind:"message",T:H7,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:Z7,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:j7,oneof:"message"}]),Cy=je.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),xy=je.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:je.getEnumType(Cs)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:je.getEnumType(Ur)},{no:9,name:"layers",kind:"message",T:fl,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Cy,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:je.getEnumType(Eo)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:je.getEnumType(jT)},{no:17,name:"audio_features",kind:"enum",T:je.getEnumType(si),repeated:!0}]),ZC=je.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:je.getEnumType(xs)},{no:3,name:"final",kind:"scalar",T:8}]),XC=je.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),k7=je.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:Up},{no:2,name:"participant",kind:"message",T:Cl},{no:3,name:"other_participants",kind:"message",T:Cl,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:s_,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:QT},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:KT},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:pp,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),E7=je.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:s_,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:QT},{no:3,name:"server_info",kind:"message",T:KT},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),$C=je.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:uu}]),T7=je.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),xl=je.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13}]),_7=je.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Cl,repeated:!0}]),jp=je.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:$T,repeated:!0}]),n_=je.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:je.getEnumType(HC)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),r_=je.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:je.getEnumType(si),repeated:!0}]),R7=je.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Gp=je.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:je.getEnumType(ws)},{no:3,name:"action",kind:"enum",T:je.getEnumType(mu)},{no:4,name:"regions",kind:"message",T:V7}]),mu=je.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),i_=je.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:fl,repeated:!0}]),o_=je.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),s_=je.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),P7=je.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:GT,repeated:!0}]),D7=je.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:Up}]),M7=je.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:je.getEnumType(Ud)},{no:3,name:"score",kind:"scalar",T:2}]),N7=je.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:M7,repeated:!0}]),B7=je.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:je.getEnumType(yy)}]),O7=je.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:B7,repeated:!0}]),KC=je.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:je.getEnumType(HC)},{no:2,name:"enabled",kind:"scalar",T:8}]),F7=je.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:KC,repeated:!0}]),L7=je.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:KC,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:F7,repeated:!0}]),a_=je.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),c_=je.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:a_,repeated:!0}]),U7=je.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),j7=je.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:Up},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:Cl},{no:4,name:"other_participants",kind:"message",T:Cl,repeated:!0}]),l_=je.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:xl},{no:2,name:"subscription",kind:"message",T:jp},{no:3,name:"publish_tracks",kind:"message",T:$C,repeated:!0},{no:4,name:"data_channels",kind:"message",T:d_,repeated:!0},{no:5,name:"offer",kind:"message",T:xl},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:u_,repeated:!0}]),u_=je.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),d_=je.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:je.getEnumType(xs)}]),zs=je.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:je.getEnumType(S7),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),f_=je.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),G7=je.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),V7=je.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:z7,repeated:!0}]),z7=je.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),W7=je.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:je.getEnumType(g7)}]),H7=je.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:je.getEnumType(qC)},{no:3,name:"message",kind:"scalar",T:9}]),qC=je.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),Z7=je.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function X7(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var L0={exports:{}},$7=L0.exports,xS;function K7(){return xS||(xS=1,function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})($7,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},a=null;function s(x,w){var S=x[w];if(typeof S.bind=="function")return S.bind(x);try{return Function.prototype.bind.call(S,x)}catch{return function(){return Function.prototype.apply.apply(S,[x,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function f(x){return x==="debug"&&(x="log"),typeof console===t?!1:x==="trace"&&r?l:console[x]!==void 0?s(console,x):console.log!==void 0?s(console,"log"):e}function h(){for(var x=this.getLevel(),w=0;w<i.length;w++){var S=i[w];this[S]=w<x?e:this.methodFactory(S,x,this.name)}if(this.log=this.debug,typeof console===t&&x<this.levels.SILENT)return"No console available for logging"}function m(x){return function(){typeof console!==t&&(h.call(this),this[x].apply(this,arguments))}}function g(x,w,S){return f(x)||m.apply(this,arguments)}function y(x,w){var S=this,A,E,_,T="loglevel";typeof x=="string"?T+=":"+x:typeof x=="symbol"&&(T=void 0);function M(G){var Z=(i[G]||"silent").toUpperCase();if(!(typeof window===t||!T)){try{window.localStorage[T]=Z;return}catch{}try{window.document.cookie=encodeURIComponent(T)+"="+Z+";"}catch{}}}function P(){var G;if(!(typeof window===t||!T)){try{G=window.localStorage[T]}catch{}if(typeof G===t)try{var Z=window.document.cookie,ne=encodeURIComponent(T),pe=Z.indexOf(ne+"=");pe!==-1&&(G=/^([^;]+)/.exec(Z.slice(pe+ne.length+1))[1])}catch{}return S.levels[G]===void 0&&(G=void 0),G}}function j(){if(!(typeof window===t||!T)){try{window.localStorage.removeItem(T)}catch{}try{window.document.cookie=encodeURIComponent(T)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function X(G){var Z=G;if(typeof Z=="string"&&S.levels[Z.toUpperCase()]!==void 0&&(Z=S.levels[Z.toUpperCase()]),typeof Z=="number"&&Z>=0&&Z<=S.levels.SILENT)return Z;throw new TypeError("log.setLevel() called with invalid level: "+G)}S.name=x,S.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},S.methodFactory=w||g,S.getLevel=function(){return _??E??A},S.setLevel=function(G,Z){return _=X(G),Z!==!1&&M(_),h.call(S)},S.setDefaultLevel=function(G){E=X(G),P()||S.setLevel(G,!1)},S.resetLevel=function(){_=null,j(),h.call(S)},S.enableAll=function(G){S.setLevel(S.levels.TRACE,G)},S.disableAll=function(G){S.setLevel(S.levels.SILENT,G)},S.rebuild=function(){if(a!==S&&(A=X(a.getLevel())),h.call(S),a===S)for(var G in o)o[G].rebuild()},A=X(a?a.getLevel():"WARN");var L=P();L!=null&&(_=X(L)),h.call(S)}a=new y,a.getLogger=function(w){if(typeof w!="symbol"&&typeof w!="string"||w==="")throw new TypeError("You must supply a name when creating a logger.");var S=o[w];return S||(S=o[w]=new y(w,a.methodFactory)),S};var C=typeof window!==t?window.log:void 0;return a.noConflict=function(){return typeof window!==t&&window.log===a&&(window.log=C),a},a.getLoggers=function(){return o},a.default=a,a})}(L0)),L0.exports}var Vp=K7(),by;(function(n){n[n.trace=0]="trace",n[n.debug=1]="debug",n[n.info=2]="info",n[n.warn=3]="warn",n[n.error=4]="error",n[n.silent=5]="silent"})(by||(by={}));var As;(function(n){n.Default="livekit",n.Room="livekit-room",n.Participant="livekit-participant",n.Track="livekit-track",n.Publication="livekit-track-publication",n.Engine="livekit-engine",n.Signal="livekit-signal",n.PCManager="livekit-pc-manager",n.PCTransport="livekit-pc-transport",n.E2EE="lk-e2ee"})(As||(As={}));let wn=Vp.getLogger("livekit");Object.values(As).map(n=>Vp.getLogger(n));wn.setDefaultLevel(by.info);function Ma(n){const e=Vp.getLogger(n);return e.setDefaultLevel(wn.getLevel()),e}const q7=Vp.getLogger("lk-e2ee"),Ed=7e3,Y7=[0,300,2*2*300,3*3*300,4*4*300,Ed,Ed,Ed,Ed,Ed];class Q7{constructor(e){this._retryDelays=e!==void 0?[...e]:Y7}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+Math.random()*1e3}}function J7(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function he(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function s(h){try{f(r.next(h))}catch(m){a(m)}}function l(h){try{f(r.throw(h))}catch(m){a(m)}}function f(h){h.done?o(h.value):i(h.value).then(s,l)}f((r=r.apply(n,e||[])).next())})}function bS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ea(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof bS=="function"?bS(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(a){return new Promise(function(s,l){a=n[o](a),i(s,l,a.done,a.value)})}}function i(o,a,s,l){Promise.resolve(l).then(function(f){o({value:f,done:s})},a)}}var Nh={exports:{}},IS;function eU(){if(IS)return Nh.exports;IS=1;var n=typeof Reflect=="object"?Reflect:null,e=n&&typeof n.apply=="function"?n.apply:function(T,M,P){return Function.prototype.apply.call(T,M,P)},t;n&&typeof n.ownKeys=="function"?t=n.ownKeys:Object.getOwnPropertySymbols?t=function(T){return Object.getOwnPropertyNames(T).concat(Object.getOwnPropertySymbols(T))}:t=function(T){return Object.getOwnPropertyNames(T)};function r(_){console&&console.warn&&console.warn(_)}var i=Number.isNaN||function(T){return T!==T};function o(){o.init.call(this)}Nh.exports=o,Nh.exports.once=S,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(_){if(typeof _!="number"||_<0||i(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");a=_}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(T){if(typeof T!="number"||T<0||i(T))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+T+".");return this._maxListeners=T,this};function l(_){return _._maxListeners===void 0?o.defaultMaxListeners:_._maxListeners}o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(T){for(var M=[],P=1;P<arguments.length;P++)M.push(arguments[P]);var j=T==="error",X=this._events;if(X!==void 0)j=j&&X.error===void 0;else if(!j)return!1;if(j){var L;if(M.length>0&&(L=M[0]),L instanceof Error)throw L;var G=new Error("Unhandled error."+(L?" ("+L.message+")":""));throw G.context=L,G}var Z=X[T];if(Z===void 0)return!1;if(typeof Z=="function")e(Z,this,M);else for(var ne=Z.length,pe=C(Z,ne),P=0;P<ne;++P)e(pe[P],this,M);return!0};function f(_,T,M,P){var j,X,L;if(s(M),X=_._events,X===void 0?(X=_._events=Object.create(null),_._eventsCount=0):(X.newListener!==void 0&&(_.emit("newListener",T,M.listener?M.listener:M),X=_._events),L=X[T]),L===void 0)L=X[T]=M,++_._eventsCount;else if(typeof L=="function"?L=X[T]=P?[M,L]:[L,M]:P?L.unshift(M):L.push(M),j=l(_),j>0&&L.length>j&&!L.warned){L.warned=!0;var G=new Error("Possible EventEmitter memory leak detected. "+L.length+" "+String(T)+" listeners added. Use emitter.setMaxListeners() to increase limit");G.name="MaxListenersExceededWarning",G.emitter=_,G.type=T,G.count=L.length,r(G)}return _}o.prototype.addListener=function(T,M){return f(this,T,M,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(T,M){return f(this,T,M,!0)};function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(_,T,M){var P={fired:!1,wrapFn:void 0,target:_,type:T,listener:M},j=h.bind(P);return j.listener=M,P.wrapFn=j,j}o.prototype.once=function(T,M){return s(M),this.on(T,m(this,T,M)),this},o.prototype.prependOnceListener=function(T,M){return s(M),this.prependListener(T,m(this,T,M)),this},o.prototype.removeListener=function(T,M){var P,j,X,L,G;if(s(M),j=this._events,j===void 0)return this;if(P=j[T],P===void 0)return this;if(P===M||P.listener===M)--this._eventsCount===0?this._events=Object.create(null):(delete j[T],j.removeListener&&this.emit("removeListener",T,P.listener||M));else if(typeof P!="function"){for(X=-1,L=P.length-1;L>=0;L--)if(P[L]===M||P[L].listener===M){G=P[L].listener,X=L;break}if(X<0)return this;X===0?P.shift():x(P,X),P.length===1&&(j[T]=P[0]),j.removeListener!==void 0&&this.emit("removeListener",T,G||M)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(T){var M,P,j;if(P=this._events,P===void 0)return this;if(P.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):P[T]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete P[T]),this;if(arguments.length===0){var X=Object.keys(P),L;for(j=0;j<X.length;++j)L=X[j],L!=="removeListener"&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(M=P[T],typeof M=="function")this.removeListener(T,M);else if(M!==void 0)for(j=M.length-1;j>=0;j--)this.removeListener(T,M[j]);return this};function g(_,T,M){var P=_._events;if(P===void 0)return[];var j=P[T];return j===void 0?[]:typeof j=="function"?M?[j.listener||j]:[j]:M?w(j):C(j,j.length)}o.prototype.listeners=function(T){return g(this,T,!0)},o.prototype.rawListeners=function(T){return g(this,T,!1)},o.listenerCount=function(_,T){return typeof _.listenerCount=="function"?_.listenerCount(T):y.call(_,T)},o.prototype.listenerCount=y;function y(_){var T=this._events;if(T!==void 0){var M=T[_];if(typeof M=="function")return 1;if(M!==void 0)return M.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function C(_,T){for(var M=new Array(T),P=0;P<T;++P)M[P]=_[P];return M}function x(_,T){for(;T+1<_.length;T++)_[T]=_[T+1];_.pop()}function w(_){for(var T=new Array(_.length),M=0;M<T.length;++M)T[M]=_[M].listener||_[M];return T}function S(_,T){return new Promise(function(M,P){function j(L){_.removeListener(T,X),P(L)}function X(){typeof _.removeListener=="function"&&_.removeListener("error",j),M([].slice.call(arguments))}E(_,T,X,{once:!0}),T!=="error"&&A(_,j,{once:!0})})}function A(_,T,M){typeof _.on=="function"&&E(_,"error",T,M)}function E(_,T,M,P){if(typeof _.on=="function")P.once?_.once(T,M):_.on(T,M);else if(typeof _.addEventListener=="function")_.addEventListener(T,function j(X){P.once&&_.removeEventListener(T,j),M(X)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof _)}return Nh.exports}var ra=eU();let h_=!0,p_=!0;function jd(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseFloat(r[t],10)}function Dl(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(a,s){if(a!==e)return i.apply(this,arguments);const l=f=>{const h=t(f);h&&(s.handleEvent?s.handleEvent(h):s(h))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(s,l),i.apply(this,[a,l])};const o=r.removeEventListener;r.removeEventListener=function(a,s){if(a!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(s))return o.apply(this,arguments);const l=this._eventMap[e].get(s);return this._eventMap[e].delete(s),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[a,l])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(a){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),a&&this.addEventListener(e,this["_on"+e]=a)},enumerable:!0,configurable:!0})}function tU(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(h_=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function nU(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(p_=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function g_(){if(typeof window=="object"){if(h_)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function YC(n,e){p_&&console.warn(n+" is deprecated, please use "+e+" instead.")}function rU(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.userAgentData&&t.userAgentData.brands){const r=t.userAgentData.brands.find(i=>i.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt(jd(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(jd(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(jd(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype,e._safariVersion=jd(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function wS(n){return Object.prototype.toString.call(n)==="[object Object]"}function m_(n){return wS(n)?Object.keys(n).reduce(function(e,t){const r=wS(n[t]),i=r?m_(n[t]):n[t],o=r&&!Object.keys(i).length;return i===void 0||o?e:Object.assign(e,{[t]:i})},{}):n}function Iy(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Iy(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(i=>{Iy(n,n.get(i),t)})}))}function SS(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const o=[];return n.forEach(a=>{a.type==="track"&&a.trackIdentifier===e.id&&o.push(a)}),o.forEach(a=>{n.forEach(s=>{s.type===r&&s.trackId===a.id&&Iy(n,s,i)})}),i}const AS=g_;function v_(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const r=function(s){if(typeof s!="object"||s.mandatory||s.optional)return s;const l={};return Object.keys(s).forEach(f=>{if(f==="require"||f==="advanced"||f==="mediaSource")return;const h=typeof s[f]=="object"?s[f]:{ideal:s[f]};h.exact!==void 0&&typeof h.exact=="number"&&(h.min=h.max=h.exact);const m=function(g,y){return g?g+y.charAt(0).toUpperCase()+y.slice(1):y==="deviceId"?"sourceId":y};if(h.ideal!==void 0){l.optional=l.optional||[];let g={};typeof h.ideal=="number"?(g[m("min",f)]=h.ideal,l.optional.push(g),g={},g[m("max",f)]=h.ideal,l.optional.push(g)):(g[m("",f)]=h.ideal,l.optional.push(g))}h.exact!==void 0&&typeof h.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[m("",f)]=h.exact):["min","max"].forEach(g=>{h[g]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[m(g,f)]=h[g])})}),s.advanced&&(l.optional=(l.optional||[]).concat(s.advanced)),l},i=function(s,l){if(e.version>=61)return l(s);if(s=JSON.parse(JSON.stringify(s)),s&&typeof s.audio=="object"){const f=function(h,m,g){m in h&&!(g in h)&&(h[g]=h[m],delete h[m])};s=JSON.parse(JSON.stringify(s)),f(s.audio,"autoGainControl","googAutoGainControl"),f(s.audio,"noiseSuppression","googNoiseSuppression"),s.audio=r(s.audio)}if(s&&typeof s.video=="object"){let f=s.video.facingMode;f=f&&(typeof f=="object"?f:{ideal:f});const h=e.version<66;if(f&&(f.exact==="user"||f.exact==="environment"||f.ideal==="user"||f.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!h)){delete s.video.facingMode;let m;if(f.exact==="environment"||f.ideal==="environment"?m=["back","rear"]:(f.exact==="user"||f.ideal==="user")&&(m=["front"]),m)return t.mediaDevices.enumerateDevices().then(g=>{g=g.filter(C=>C.kind==="videoinput");let y=g.find(C=>m.some(x=>C.label.toLowerCase().includes(x)));return!y&&g.length&&m.includes("back")&&(y=g[g.length-1]),y&&(s.video.deviceId=f.exact?{exact:y.deviceId}:{ideal:y.deviceId}),s.video=r(s.video),AS("chrome: "+JSON.stringify(s)),l(s)})}s.video=r(s.video)}return AS("chrome: "+JSON.stringify(s)),l(s)},o=function(s){return e.version>=64?s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[s.name]||s.name,message:s.message,constraint:s.constraint||s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(s,l,f){i(s,h=>{t.webkitGetUserMedia(h,l,m=>{f&&f(o(m))})})};if(t.getUserMedia=a.bind(t),t.mediaDevices.getUserMedia){const s=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(l){return i(l,f=>s(f).then(h=>{if(f.audio&&!h.getAudioTracks().length||f.video&&!h.getVideoTracks().length)throw h.getTracks().forEach(m=>{m.stop()}),new DOMException("","NotFoundError");return h},h=>Promise.reject(o(h))))}}}function y_(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function C_(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let o;n.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(s=>s.track&&s.track.id===i.track.id):o={track:i.track};const a=new Event("track");a.track=i.track,a.receiver=o,a.transceiver={receiver:o},a.streams=[r.stream],this.dispatchEvent(a)}),r.stream.getTracks().forEach(i=>{let o;n.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(s=>s.track&&s.track.id===i.id):o={track:i};const a=new Event("track");a.track=i,a.receiver=o,a.transceiver={receiver:o},a.streams=[r.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Dl(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function x_(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(s,l){let f=i.apply(this,arguments);return f||(f=e(this,s),this._senders.push(f)),f};const o=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(s){o.apply(this,arguments);const l=this._senders.indexOf(s);l!==-1&&this._senders.splice(l,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],t.apply(this,[o]),o.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(a=>{const s=this._senders.find(l=>l.track===a);s&&this._senders.splice(this._senders.indexOf(s),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function b_(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const o=t.apply(this,[]);return o.forEach(a=>a._pc=this),o});const r=n.RTCPeerConnection.prototype.addTrack;r&&(n.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),n.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(a=>SS(a,o.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const i=t.apply(this,[]);return i.forEach(o=>o._pc=this),i}),Dl(n,"track",r=>(r.receiver._pc=r.srcElement,r)),n.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>SS(o,i.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const r=arguments[0];let i,o,a;return this.getSenders().forEach(s=>{s.track===r&&(i?a=!0:i=s)}),this.getReceivers().forEach(s=>(s.track===r&&(o?a=!0:o=s),s.track===r)),a||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function I_(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(a,s){if(!s)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=e.apply(this,arguments);return this._shimmedLocalStreams[s.id]?this._shimmedLocalStreams[s.id].indexOf(l)===-1&&this._shimmedLocalStreams[s.id].push(l):this._shimmedLocalStreams[s.id]=[s,l],l};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(f=>{if(this.getSenders().find(m=>m.track===f))throw new DOMException("Track already exists.","InvalidAccessError")});const s=this.getSenders();t.apply(this,arguments);const l=this.getSenders().filter(f=>s.indexOf(f)===-1);this._shimmedLocalStreams[a.id]=[a].concat(l)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],r.apply(this,arguments)};const i=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(s=>{const l=this._shimmedLocalStreams[s].indexOf(a);l!==-1&&this._shimmedLocalStreams[s].splice(l,1),this._shimmedLocalStreams[s].length===1&&delete this._shimmedLocalStreams[s]}),i.apply(this,arguments)}}function w_(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return I_(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const h=t.apply(this);return this._reverseStreams=this._reverseStreams||{},h.map(m=>this._reverseStreams[m.id])};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(h){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},h.getTracks().forEach(m=>{if(this.getSenders().find(y=>y.track===m))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[h.id]){const m=new n.MediaStream(h.getTracks());this._streams[h.id]=m,this._reverseStreams[m.id]=h,h=m}r.apply(this,[h])};const i=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(h){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[h.id]||h]),delete this._reverseStreams[this._streams[h.id]?this._streams[h.id].id:h.id],delete this._streams[h.id]},n.RTCPeerConnection.prototype.addTrack=function(h,m){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const g=[].slice.call(arguments,1);if(g.length!==1||!g[0].getTracks().find(x=>x===h))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(x=>x.track===h))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const C=this._streams[m.id];if(C)C.addTrack(h),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const x=new n.MediaStream([h]);this._streams[m.id]=x,this._reverseStreams[x.id]=m,this.addStream(x)}return this.getSenders().find(x=>x.track===h)};function o(f,h){let m=h.sdp;return Object.keys(f._reverseStreams||[]).forEach(g=>{const y=f._reverseStreams[g],C=f._streams[y.id];m=m.replace(new RegExp(C.id,"g"),y.id)}),new RTCSessionDescription({type:h.type,sdp:m})}function a(f,h){let m=h.sdp;return Object.keys(f._reverseStreams||[]).forEach(g=>{const y=f._reverseStreams[g],C=f._streams[y.id];m=m.replace(new RegExp(y.id,"g"),C.id)}),new RTCSessionDescription({type:h.type,sdp:m})}["createOffer","createAnswer"].forEach(function(f){const h=n.RTCPeerConnection.prototype[f],m={[f](){const g=arguments;return arguments.length&&typeof arguments[0]=="function"?h.apply(this,[C=>{const x=o(this,C);g[0].apply(null,[x])},C=>{g[1]&&g[1].apply(null,C)},arguments[2]]):h.apply(this,arguments).then(C=>o(this,C))}};n.RTCPeerConnection.prototype[f]=m[f]});const s=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?s.apply(this,arguments):(arguments[0]=a(this,arguments[0]),s.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const f=l.get.apply(this);return f.type===""?f:o(this,f)}}),n.RTCPeerConnection.prototype.removeTrack=function(h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!h._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(h._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let g;Object.keys(this._streams).forEach(y=>{this._streams[y].getTracks().find(x=>h.track===x)&&(g=this._streams[y])}),g&&(g.getTracks().length===1?this.removeStream(this._reverseStreams[g.id]):g.removeTrack(h.track),this.dispatchEvent(new Event("negotiationneeded")))}}function wy(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=n.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=i[t]})}function S_(n,e){Dl(n,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}var kS=Object.freeze({__proto__:null,fixNegotiationNeeded:S_,shimAddTrackRemoveTrack:w_,shimAddTrackRemoveTrackWithNative:I_,shimGetSendersWithDtmf:x_,shimGetUserMedia:v_,shimMediaStream:y_,shimOnTrack:C_,shimPeerConnection:wy,shimSenderReceiverGetStats:b_});function A_(n,e){const t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(i,o,a){YC("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(i).then(o,a)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const i=function(a,s,l){s in a&&!(l in a)&&(a[l]=a[s],delete a[s])},o=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a.audio,"autoGainControl","mozAutoGainControl"),i(a.audio,"noiseSuppression","mozNoiseSuppression")),o(a)},r&&r.prototype.getSettings){const a=r.prototype.getSettings;r.prototype.getSettings=function(){const s=a.apply(this,arguments);return i(s,"mozAutoGainControl","autoGainControl"),i(s,"mozNoiseSuppression","noiseSuppression"),s}}if(r&&r.prototype.applyConstraints){const a=r.prototype.applyConstraints;r.prototype.applyConstraints=function(s){return this.kind==="audio"&&typeof s=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s,"autoGainControl","mozAutoGainControl"),i(s,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[s])}}}}function iU(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(r)})}function k_(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Sy(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=n.RTCPeerConnection.prototype[i],a={[i](){return arguments[0]=new(i==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};n.RTCPeerConnection.prototype[i]=a[i]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[o,a,s]=arguments;return r.apply(this,[o||null]).then(l=>{if(e.version<53&&!a)try{l.forEach(f=>{f.type=t[f.type]||f.type})}catch(f){if(f.name!=="TypeError")throw f;l.forEach((h,m)=>{l.set(m,Object.assign({},h,{type:t[h.type]||h.type}))})}return l}).then(a,s)}}function E_(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const i=t.apply(this,arguments);return i._pc=this,i}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function T_(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Dl(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function __(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){YC("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function R_(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function P_(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(i){const{sender:a}=o,s=a.getParameters();(!("encodings"in s)||s.encodings.length===1&&Object.keys(s.encodings[0]).length===0)&&(s.encodings=r,a.sendEncodings=r,this.setParametersPromises.push(a.setParameters(s).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return o})}function D_(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function M_(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function N_(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var ES=Object.freeze({__proto__:null,shimAddTransceiver:P_,shimCreateAnswer:N_,shimCreateOffer:M_,shimGetDisplayMedia:iU,shimGetParameters:D_,shimGetUserMedia:A_,shimOnTrack:k_,shimPeerConnection:Sy,shimRTCDataChannel:R_,shimReceiverGetStats:T_,shimRemoveStream:__,shimSenderGetStats:E_});function B_(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},n.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return o&&o.forEach(s=>{this._localStreams?this._localStreams.includes(s)||this._localStreams.push(s):this._localStreams=[s]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const i=t.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function O_(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const a=new Event("addstream");a.stream=o,r.dispatchEvent(a)})}),e.apply(r,arguments)}}}function F_(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,o=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(f,h){const m=arguments.length>=2?arguments[2]:arguments[0],g=t.apply(this,[m]);return h?(g.then(f,h),Promise.resolve()):g},e.createAnswer=function(f,h){const m=arguments.length>=2?arguments[2]:arguments[0],g=r.apply(this,[m]);return h?(g.then(f,h),Promise.resolve()):g};let s=function(l,f,h){const m=i.apply(this,[l]);return h?(m.then(f,h),Promise.resolve()):m};e.setLocalDescription=s,s=function(l,f,h){const m=o.apply(this,[l]);return h?(m.then(f,h),Promise.resolve()):m},e.setRemoteDescription=s,s=function(l,f,h){const m=a.apply(this,[l]);return h?(m.then(f,h),Promise.resolve()):m},e.addIceCandidate=s}function L_(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=i=>r(U_(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,o){e.mediaDevices.getUserMedia(r).then(i,o)}).bind(e))}function U_(n){return n&&n.video!==void 0?Object.assign({},n,{video:m_(n.video)}):n}function j_(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const o=[];for(let a=0;a<r.iceServers.length;a++){let s=r.iceServers[a];s.urls===void 0&&s.url?(YC("RTCIceServer.url","RTCIceServer.urls"),s=JSON.parse(JSON.stringify(s)),s.urls=s.url,delete s.url,o.push(s)):o.push(r.iceServers[a])}r.iceServers=o}return new e(r,i)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function G_(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function V_(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(a=>a.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function z_(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}var TS=Object.freeze({__proto__:null,shimAudioContext:z_,shimCallbacksAPI:F_,shimConstraints:U_,shimCreateOfferLegacy:V_,shimGetUserMedia:L_,shimLocalStreamsAPI:B_,shimRTCIceServerUrls:j_,shimRemoteStreamsAPI:O_,shimTrackEventTransceiver:G_}),rv={exports:{}},_S;function oU(){return _S||(_S=1,function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":i.relatedAddress=r[o+1];break;case"rport":i.relatedPort=parseInt(r[o+1],10);break;case"tcptype":i.tcpType=r[o+1];break;case"ufrag":i.ufrag=r[o+1],i.usernameFragment=r[o+1];break;default:i[r[o]]===void 0&&(i[r[o]]=r[o+1]);break}return i},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const i=t.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const o=t.type;return r.push("typ"),r.push(o),o!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let i;const o=t.substring(t.indexOf(" ")+1).split(";");for(let a=0;a<o.length;a++)i=o[a].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(t){let r="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const o=[];Object.keys(t.parameters).forEach(a=>{t.parameters[a]!==void 0?o.push(a+"="+t.parameters[a]):o.push(a)}),r+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),i={ssrc:parseInt(t.substring(7,r),10)},o=t.indexOf(":",r);return o>-1?(i.attribute=t.substring(r+1,o),i.value=t.substring(o+1)):i.attribute=t.substring(r+1),i},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let i="a=setup:"+r+`\r
`;return t.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const i=e.matchPrefix(t+r,"a=ice-ufrag:")[0],o=e.matchPrefix(t+r,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(t)[0].split(" ");r.profile=o[2];for(let s=3;s<o.length;s++){const l=o[s],f=e.matchPrefix(t,"a=rtpmap:"+l+" ")[0];if(f){const h=e.parseRtpMap(f),m=e.matchPrefix(t,"a=fmtp:"+l+" ");switch(h.parameters=m.length?e.parseFmtp(m[0]):{},h.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb),r.codecs.push(h),h.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(h.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(s=>{r.headerExtensions.push(e.parseExtmap(s))});const a=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(s=>{a.forEach(l=>{s.rtcpFeedback.find(h=>h.type===l.type&&h.parameter===l.parameter)||s.rtcpFeedback.push(l)})}),r},e.writeRtpDescription=function(t,r){let i="";i+="m="+t+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(a=>{i+=e.writeRtpMap(a),i+=e.writeFmtp(a),i+=e.writeRtcpFb(a)});let o=0;return r.codecs.forEach(a=>{a.maxptime>o&&(o=a.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(a=>{i+=e.writeExtmap(a)}),i},e.parseRtpEncodingParameters=function(t){const r=[],i=e.parseRtpParameters(t),o=i.fecMechanisms.indexOf("RED")!==-1,a=i.fecMechanisms.indexOf("ULPFEC")!==-1,s=e.matchPrefix(t,"a=ssrc:").map(g=>e.parseSsrcMedia(g)).filter(g=>g.attribute==="cname"),l=s.length>0&&s[0].ssrc;let f;const h=e.matchPrefix(t,"a=ssrc-group:FID").map(g=>g.substring(17).split(" ").map(C=>parseInt(C,10)));h.length>0&&h[0].length>1&&h[0][0]===l&&(f=h[0][1]),i.codecs.forEach(g=>{if(g.name.toUpperCase()==="RTX"&&g.parameters.apt){let y={ssrc:l,codecPayloadType:parseInt(g.parameters.apt,10)};l&&f&&(y.rtx={ssrc:f}),r.push(y),o&&(y=JSON.parse(JSON.stringify(y)),y.fec={ssrc:l,mechanism:a?"red+ulpfec":"red"},r.push(y))}}),r.length===0&&l&&r.push({ssrc:l});let m=e.matchPrefix(t,"b=");return m.length&&(m[0].indexOf("b=TIAS:")===0?m=parseInt(m[0].substring(7),10):m[0].indexOf("b=AS:")===0?m=parseInt(m[0].substring(5),10)*1e3*.95-50*40*8:m=void 0,r.forEach(g=>{g.maxBitrate=m})),r},e.parseRtcpParameters=function(t){const r={},i=e.matchPrefix(t,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const o=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const a=e.matchPrefix(t,"a=rtcp-mux");return r.mux=a.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const i=e.matchPrefix(t,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=e.matchPrefix(t,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),i=e.matchPrefix(t,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const a=e.matchPrefix(t,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const s=e.matchPrefix(t,"a=sctpmap:");if(s.length>0){const l=s[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:o}}},e.writeSctpDescription=function(t,r){let i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,i){let o;const a=r!==void 0?r:2;return t?o=t:o=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const i=e.splitLines(t);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const i=e.splitLines(t)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(t){const i=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},n.exports=e}(rv)),rv.exports}var W_=oU(),vu=X7(W_),sU=C9({__proto__:null,default:vu},[W_]);function U0(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),o=vu.parseCandidate(r.candidate);for(const a in o)a in i||Object.defineProperty(i,a,{value:o[a]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},n.RTCIceCandidate.prototype=e.prototype,Dl(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function Ay(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||Dl(n,"icecandidate",e=>{if(e.candidate){const t=vu.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function j0(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(s){if(!s||!s.sdp)return!1;const l=vu.splitSections(s.sdp);return l.shift(),l.some(f=>{const h=vu.parseMLine(f);return h&&h.kind==="application"&&h.protocol.indexOf("SCTP")!==-1})},r=function(s){const l=s.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const f=parseInt(l[1],10);return f!==f?-1:f},i=function(s){let l=65536;return e.browser==="firefox"&&(e.version<57?s===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},o=function(s,l){let f=65536;e.browser==="firefox"&&e.version===57&&(f=65535);const h=vu.matchPrefix(s.sdp,"a=max-message-size:");return h.length>0?f=parseInt(h[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(f=2147483637),f},a=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const l=r(arguments[0]),f=i(l),h=o(arguments[0],l);let m;f===0&&h===0?m=Number.POSITIVE_INFINITY:f===0||h===0?m=Math.max(f,h):m=Math.min(f,h);const g={};Object.defineProperty(g,"maxMessageSize",{get(){return m}}),this._sctp=g}return a.apply(this,arguments)}}function G0(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(r,i){const o=r.send;r.send=function(){const s=arguments[0],l=s.length||s.size||s.byteLength;if(r.readyState==="open"&&i.sctp&&l>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const i=t.apply(this,arguments);return e(i,this),i},Dl(n,"datachannel",r=>(e(r.channel,r.target),r))}function ky(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const a=new Event("connectionstatechange",i);o.dispatchEvent(a)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Ey(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&i instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return t.apply(this,arguments)}}function V0(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function z0(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return t.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?t.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>t.apply(this,[a]))})}var aU=Object.freeze({__proto__:null,removeExtmapAllowMixed:Ey,shimAddIceCandidateNullOrEmpty:V0,shimConnectionState:ky,shimMaxMessageSize:j0,shimParameterlessSetLocalDescription:z0,shimRTCIceCandidate:U0,shimRTCIceCandidateRelayProtocol:Ay,shimSendThrowTypeError:G0});function cU(){let{window:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const t=g_,r=rU(n),i={browserDetails:r,commonShim:aU,extractVersion:jd,disableLog:tU,disableWarnings:nU,sdp:sU};switch(r.browser){case"chrome":if(!kS||!wy||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),i;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),i;t("adapter.js shimming chrome."),i.browserShim=kS,V0(n,r),z0(n),v_(n,r),y_(n),wy(n,r),C_(n),w_(n,r),x_(n),b_(n),S_(n,r),U0(n),Ay(n),ky(n),j0(n,r),G0(n),Ey(n,r);break;case"firefox":if(!ES||!Sy||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),i;t("adapter.js shimming firefox."),i.browserShim=ES,V0(n,r),z0(n),A_(n,r),Sy(n,r),k_(n),__(n),E_(n),T_(n),R_(n),P_(n),D_(n),M_(n),N_(n),U0(n),ky(n),j0(n,r),G0(n);break;case"safari":if(!TS||!e.shimSafari)return t("Safari shim is not included in this adapter release."),i;t("adapter.js shimming safari."),i.browserShim=TS,V0(n,r),z0(n),j_(n),V_(n),F_(n),B_(n),O_(n),G_(n),L_(n),z_(n),U0(n),Ay(n),j0(n,r),G0(n),Ey(n,r);break;default:t("Unsupported browser!");break}return i}cU({window:typeof window>"u"?void 0:window});const lU=10,Td="lk_e2ee",uU="LKFrameEncryptionKey",dU={sharedKey:!1,ratchetSalt:uU,ratchetWindowSize:8,failureTolerance:lU,keyringSize:16};var Ic;(function(n){n.SetKey="setKey",n.RatchetRequest="ratchetRequest",n.KeyRatcheted="keyRatcheted"})(Ic||(Ic={}));var RS;(function(n){n.KeyRatcheted="keyRatcheted"})(RS||(RS={}));var xc;(function(n){n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError"})(xc||(xc={}));var PS;(function(n){n.Error="cryptorError"})(PS||(PS={}));function fU(){return hU()||Ty()}function Ty(){return typeof window.RTCRtpScriptTransform<"u"}function hU(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class gX extends ra.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(t,r,i)=>{wn.debug("key ratcheted event received",{ratchetResult:t,participantId:r,keyIndex:i})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},dU),e),this.on(Ic.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,t,r){const i={key:e,participantIdentity:t,keyIndex:r};if(!this.options.sharedKey&&!t)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(t??"shared","-").concat(r??0),i),this.emit(Ic.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,t){this.emit(Ic.RatchetRequest,e,t)}}class Oa extends Error{constructor(e,t){super(t||"an error has occured"),this.name="LiveKitError",this.code=e}}var Tn;(function(n){n[n.NotAllowed=0]="NotAllowed",n[n.ServerUnreachable=1]="ServerUnreachable",n[n.InternalError=2]="InternalError",n[n.Cancelled=3]="Cancelled",n[n.LeaveRequest=4]="LeaveRequest",n[n.Timeout=5]="Timeout"})(Tn||(Tn={}));class Zn extends Oa{constructor(e,t,r,i){super(1,e),this.name="ConnectionError",this.status=r,this.reason=t,this.context=i,this.reasonName=Tn[t]}}class QC extends Oa{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class Ta extends Oa{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class pU extends Oa{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class $r extends Oa{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class _y extends Oa{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class DS extends Oa{constructor(e,t){super(15,e),this.name="PublishTrackError",this.status=t}}class MS extends Oa{constructor(e,t){super(15,e),this.reason=t,this.reasonName=typeof t=="string"?t:qC[t]}}var bs;(function(n){n[n.AlreadyOpened=0]="AlreadyOpened",n[n.AbnormalEnd=1]="AbnormalEnd",n[n.DecodeFailed=2]="DecodeFailed",n[n.LengthExceeded=3]="LengthExceeded",n[n.Incomplete=4]="Incomplete",n[n.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered"})(bs||(bs={}));class mc extends Oa{constructor(e,t){super(16,e),this.name="DataStreamError",this.reason=t,this.reasonName=bs[t]}}var cf;(function(n){n.PermissionDenied="PermissionDenied",n.NotFound="NotFound",n.DeviceInUse="DeviceInUse",n.Other="Other"})(cf||(cf={}));(function(n){function e(t){if(t&&"name"in t)return t.name==="NotFoundError"||t.name==="DevicesNotFoundError"?n.NotFound:t.name==="NotAllowedError"||t.name==="PermissionDeniedError"?n.PermissionDenied:t.name==="NotReadableError"||t.name==="TrackStartError"?n.DeviceInUse:n.Other}n.getFailure=e})(cf||(cf={}));var NS;(function(n){n[n.InvalidKey=0]="InvalidKey",n[n.MissingKey=1]="MissingKey",n[n.InternalError=2]="InternalError"})(NS||(NS={}));var ze;(function(n){n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting",n.Reconnected="reconnected",n.Disconnected="disconnected",n.ConnectionStateChanged="connectionStateChanged",n.Moved="moved",n.MediaDevicesChanged="mediaDevicesChanged",n.ParticipantConnected="participantConnected",n.ParticipantDisconnected="participantDisconnected",n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalAudioSilenceDetected="localAudioSilenceDetected",n.ActiveSpeakersChanged="activeSpeakersChanged",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.ParticipantAttributesChanged="participantAttributesChanged",n.ParticipantActive="participantActive",n.RoomMetadataChanged="roomMetadataChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.AudioPlaybackStatusChanged="audioPlaybackChanged",n.VideoPlaybackStatusChanged="videoPlaybackChanged",n.MediaDevicesError="mediaDevicesError",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.SignalConnected="signalConnected",n.RecordingStatusChanged="recordingStatusChanged",n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ActiveDeviceChanged="activeDeviceChanged",n.ChatMessage="chatMessage",n.LocalTrackSubscribed="localTrackSubscribed",n.MetricsReceived="metricsReceived"})(ze||(ze={}));var Ze;(function(n){n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalTrackCpuConstrained="localTrackCpuConstrained",n.LocalSenderCreated="localSenderCreated",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.IsSpeakingChanged="isSpeakingChanged",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.TrackCpuConstrained="trackCpuConstrained",n.MediaDevicesError="mediaDevicesError",n.AudioStreamAcquired="audioStreamAcquired",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.PCTrackAdded="pcTrackAdded",n.AttributesChanged="attributesChanged",n.LocalTrackSubscribed="localTrackSubscribed",n.ChatMessage="chatMessage",n.Active="active"})(Ze||(Ze={}));var yt;(function(n){n.TransportsCreated="transportsCreated",n.Connected="connected",n.Disconnected="disconnected",n.Resuming="resuming",n.Resumed="resumed",n.Restarting="restarting",n.Restarted="restarted",n.SignalResumed="signalResumed",n.SignalRestarted="signalRestarted",n.Closing="closing",n.MediaTrackAdded="mediaTrackAdded",n.ActiveSpeakersUpdate="activeSpeakersUpdate",n.DataPacketReceived="dataPacketReceived",n.RTPVideoMapUpdate="rtpVideoMapUpdate",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ParticipantUpdate="participantUpdate",n.RoomUpdate="roomUpdate",n.SpeakersChanged="speakersChanged",n.StreamStateChanged="streamStateChanged",n.ConnectionQualityUpdate="connectionQualityUpdate",n.SubscriptionError="subscriptionError",n.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",n.RemoteMute="remoteMute",n.SubscribedQualityUpdate="subscribedQualityUpdate",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalTrackSubscribed="localTrackSubscribed",n.Offline="offline",n.SignalRequestResponse="signalRequestResponse",n.SignalConnected="signalConnected",n.RoomMoved="roomMoved"})(yt||(yt={}));var ht;(function(n){n.Message="message",n.Muted="muted",n.Unmuted="unmuted",n.Restarted="restarted",n.Ended="ended",n.Subscribed="subscribed",n.Unsubscribed="unsubscribed",n.CpuConstrained="cpuConstrained",n.UpdateSettings="updateSettings",n.UpdateSubscription="updateSubscription",n.AudioPlaybackStarted="audioPlaybackStarted",n.AudioPlaybackFailed="audioPlaybackFailed",n.AudioSilenceDetected="audioSilenceDetected",n.VisibilityChanged="visibilityChanged",n.VideoDimensionsChanged="videoDimensionsChanged",n.VideoPlaybackStarted="videoPlaybackStarted",n.VideoPlaybackFailed="videoPlaybackFailed",n.ElementAttached="elementAttached",n.ElementDetached="elementDetached",n.UpstreamPaused="upstreamPaused",n.UpstreamResumed="upstreamResumed",n.SubscriptionPermissionChanged="subscriptionPermissionChanged",n.SubscriptionStatusChanged="subscriptionStatusChanged",n.SubscriptionFailed="subscriptionFailed",n.TrackProcessorUpdate="trackProcessorUpdate",n.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",n.TranscriptionReceived="transcriptionReceived",n.TimeSyncUpdate="timeSyncUpdate",n.PreConnectBufferFlushed="preConnectBufferFlushed"})(ht||(ht={}));function gU(n){return typeof n>"u"?n:typeof structuredClone=="function"?typeof n=="object"&&n!==null?structuredClone(Object.assign({},n)):structuredClone(n):JSON.parse(JSON.stringify(n))}const mU=/version\/(\d+(\.?_?\d+)+)/i;let iv;function _o(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const t=navigator.userAgent.toLowerCase();if(iv===void 0||e){const r=vU.find(i=>{let{test:o}=i;return o.test(t)});iv=r==null?void 0:r.describe(t)}return iv}const vU=[{test:/firefox|iceweasel|fxios/i,describe(n){return{name:"Firefox",version:W0(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:ov(n)}}},{test:/chrom|crios|crmo/i,describe(n){return{name:"Chrome",version:W0(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("crios")?"iOS":void 0,osVersion:ov(n)}}},{test:/safari|applewebkit/i,describe(n){return{name:"Safari",version:W0(mU,n),os:n.includes("mobile/")?"iOS":"macOS",osVersion:ov(n)}}}];function W0(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(n);return r&&r.length>=t&&r[t]||""}function ov(n){return n.includes("mac os")?W0(/\(.+?(\d+_\d+(:?_\d+)?)/,n,1).replace(/_/g,"."):void 0}var yU="2.15.6";const CU=yU,xU=16;class gi{}gi.setTimeout=function(){return setTimeout(...arguments)};gi.setInterval=function(){return setInterval(...arguments)};gi.clearTimeout=function(){return clearTimeout(...arguments)};gi.clearInterval=function(){return clearInterval(...arguments)};const bU=5e3,_d=[];var To;(function(n){n[n.LOW=0]="LOW",n[n.MEDIUM=1]="MEDIUM",n[n.HIGH=2]="HIGH"})(To||(To={}));class Ue extends ra.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=Ue.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=wn,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),bU):this.handleAppVisibilityChanged()},this.log=Ma((i=r.loggerName)!==null&&i!==void 0?i:As.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Ue.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),An(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===Ue.Kind.Video&&(t="video"),this.attachedElements.length===0&&this.kind===Ue.Kind.Video&&this.addAppVisibilityListener(),e||(t==="audio"&&(_d.forEach(o=>{o.parentElement===null&&!e&&(e=o)}),e&&_d.splice(_d.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),du(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(o=>o.kind==="audio");return e.play().then(()=>{this.emit(i?ht.AudioPlaybackStarted:ht.VideoPlaybackStarted)}).catch(o=>{o.name==="NotAllowedError"?this.emit(i?ht.AudioPlaybackFailed:ht.VideoPlaybackFailed,o):o.name==="AbortError"?wn.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):wn.warn("could not playback ".concat(i?"audio":"video"),o),i&&e&&r.some(a=>a.kind==="video")&&o.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(ht.ElementAttached,e),e}detach(e){try{if(e){yu(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(ht.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(r=>{yu(this.mediaStreamTrack,r),t.push(r),this.recycleElement(r),this.emit(ht.ElementDetached,r)}),this.attachedElements=[],t}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=Ma(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),_d.forEach(r=>{r.parentElement||(t=!1)}),t&&_d.push(e)}}handleAppVisibilityChanged(){return he(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===Ue.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){so()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){so()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function du(n,e){let t;e.srcObject instanceof MediaStream?t=e.srcObject:t=new MediaStream;let r;n.kind==="audio"?r=t.getAudioTracks():r=t.getVideoTracks(),r.includes(n)||(r.forEach(i=>{t.removeTrack(i)}),t.addTrack(n)),(!Il()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=t.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==t&&(e.srcObject=t,(Il()||bl())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=t,e.play().catch(()=>{})},0))}function yu(n,e){if(e.srcObject instanceof MediaStream){const t=e.srcObject;t.removeTrack(n),t.getTracks().length>0?e.srcObject=t:e.srcObject=null}}(function(n){let e;(function(f){f.Audio="audio",f.Video="video",f.Unknown="unknown"})(e=n.Kind||(n.Kind={}));let t;(function(f){f.Camera="camera",f.Microphone="microphone",f.ScreenShare="screen_share",f.ScreenShareAudio="screen_share_audio",f.Unknown="unknown"})(t=n.Source||(n.Source={}));let r;(function(f){f.Active="active",f.Paused="paused",f.Unknown="unknown"})(r=n.StreamState||(n.StreamState={}));function i(f){switch(f){case e.Audio:return Cs.AUDIO;case e.Video:return Cs.VIDEO;default:return Cs.DATA}}n.kindToProto=i;function o(f){switch(f){case Cs.AUDIO:return e.Audio;case Cs.VIDEO:return e.Video;default:return e.Unknown}}n.kindFromProto=o;function a(f){switch(f){case t.Camera:return Ur.CAMERA;case t.Microphone:return Ur.MICROPHONE;case t.ScreenShare:return Ur.SCREEN_SHARE;case t.ScreenShareAudio:return Ur.SCREEN_SHARE_AUDIO;default:return Ur.UNKNOWN}}n.sourceToProto=a;function s(f){switch(f){case Ur.CAMERA:return t.Camera;case Ur.MICROPHONE:return t.Microphone;case Ur.SCREEN_SHARE:return t.ScreenShare;case Ur.SCREEN_SHARE_AUDIO:return t.ScreenShareAudio;default:return t.Unknown}}n.sourceFromProto=s;function l(f){switch(f){case yy.ACTIVE:return r.Active;case yy.PAUSED:return r.Paused;default:return r.Unknown}}n.streamStateFromProto=l})(Ue||(Ue={}));class Hn{constructor(e,t,r,i,o){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(t!==void 0&&r!==void 0)this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:r,maxFramerate:i,priority:o};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const IU=["vp8","h264"],wU=["vp8","h264","vp9","av1","h265"];function SU(n){return!!IU.find(e=>e===n)}var BS;(function(n){n[n.PREFER_REGRESSION=0]="PREFER_REGRESSION",n[n.SIMULCAST=1]="SIMULCAST",n[n.REGRESSION=2]="REGRESSION"})(BS||(BS={}));var Ry;(function(n){n.telephone={maxBitrate:12e3},n.speech={maxBitrate:24e3},n.music={maxBitrate:48e3},n.musicStereo={maxBitrate:64e3},n.musicHighQuality={maxBitrate:96e3},n.musicHighQualityStereo={maxBitrate:128e3}})(Ry||(Ry={}));const lf={h90:new Hn(160,90,9e4,20),h180:new Hn(320,180,16e4,20),h216:new Hn(384,216,18e4,20),h360:new Hn(640,360,45e4,20),h540:new Hn(960,540,8e5,25),h720:new Hn(1280,720,17e5,30),h1080:new Hn(1920,1080,3e6,30),h1440:new Hn(2560,1440,5e6,30),h2160:new Hn(3840,2160,8e6,30)},Py={h120:new Hn(160,120,7e4,20),h180:new Hn(240,180,125e3,20),h240:new Hn(320,240,14e4,20),h360:new Hn(480,360,33e4,20),h480:new Hn(640,480,5e5,20),h540:new Hn(720,540,6e5,25),h720:new Hn(960,720,13e5,30),h1080:new Hn(1440,1080,23e5,30),h1440:new Hn(1920,1440,38e5,30)},JC={h360fps3:new Hn(640,360,2e5,3,"medium"),h360fps15:new Hn(640,360,4e5,15,"medium"),h720fps5:new Hn(1280,720,8e5,5,"medium"),h720fps15:new Hn(1280,720,15e5,15,"medium"),h720fps30:new Hn(1280,720,2e6,30,"medium"),h1080fps15:new Hn(1920,1080,25e5,15,"medium"),h1080fps30:new Hn(1920,1080,5e6,30,"medium"),original:new Hn(0,0,7e6,30,"medium")},AU="|",OS="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function kU(n){const e=n.split(AU);return e.length>1?[e[0],n.substr(e[0].length+1)]:[n,""]}function co(n){return he(this,void 0,void 0,function*(){return new Promise(e=>gi.setTimeout(e,n))})}function Dy(){return"addTransceiver"in RTCPeerConnection.prototype}function My(){return"addTrack"in RTCPeerConnection.prototype}function EU(){if(!("getCapabilities"in RTCRtpSender)||Il()||bl())return!1;const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType==="video/AV1"){e=!0;break}}return e}function TU(){if(!("getCapabilities"in RTCRtpSender)||bl())return!1;if(Il()){const t=_o();if(t!=null&&t.version&&ks(t.version,"16")<0||(t==null?void 0:t.os)==="iOS"&&(t!=null&&t.osVersion)&&ks(t.osVersion,"16")<0)return!1}const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType==="video/VP9"){e=!0;break}}return e}function Zs(n){return n==="av1"||n==="vp9"}function Ny(n){return!document||uf()?!1:(n||(n=document.createElement("audio")),"setSinkId"in n)}function _U(){return typeof RTCPeerConnection>"u"?!1:Dy()||My()}function bl(){var n;return((n=_o())===null||n===void 0?void 0:n.name)==="Firefox"}function Il(){var n;return((n=_o())===null||n===void 0?void 0:n.name)==="Safari"}function uf(){const n=_o();return(n==null?void 0:n.name)==="Safari"||(n==null?void 0:n.os)==="iOS"}function RU(){const n=_o();return(n==null?void 0:n.name)==="Safari"&&n.version.startsWith("17.")||(n==null?void 0:n.os)==="iOS"&&!!(n!=null&&n.osVersion)&&ks(n.osVersion,"17")>=0}function PU(n){return n||(n=_o()),(n==null?void 0:n.name)==="Safari"&&ks(n.version,"18.3")>0||(n==null?void 0:n.os)==="iOS"&&!!(n!=null&&n.osVersion)&&ks(n.osVersion,"18.3")>0}function H_(){var n,e;return so()?(e=(n=navigator.userAgentData)===null||n===void 0?void 0:n.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function DU(){const n=_o(),e="17.2";if(n)return n.name!=="Safari"&&n.os!=="iOS"||n.os==="iOS"&&n.osVersion&&ks(n.osVersion,e)>=0?!0:n.name==="Safari"&&ks(n.version,e)>=0}function so(){return typeof document<"u"}function Ys(){return navigator.product=="ReactNative"}function By(n){return n.hostname.endsWith(".livekit.cloud")||n.hostname.endsWith(".livekit.run")}function Z_(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function X_(){if(!Ys())return;let n=Z_();if(n)return n.platform}function FS(){if(so())return window.devicePixelRatio;if(Ys()){let n=Z_();if(n)return n.devicePixelRatio}return 1}function ks(n,e){const t=n.split("."),r=e.split("."),i=Math.min(t.length,r.length);for(let o=0;o<i;++o){const a=parseInt(t[o],10),s=parseInt(r[o],10);if(a>s)return 1;if(a<s)return-1;if(o===i-1&&a===s)return 0}return n===""&&e!==""?-1:e===""?1:t.length==r.length?0:t.length<r.length?-1:1}function MU(n){for(const e of n)e.target.handleResize(e)}function NU(n){for(const e of n)e.target.handleVisibilityChanged(e)}let sv=null;const LS=()=>(sv||(sv=new ResizeObserver(MU)),sv);let av=null;const US=()=>(av||(av=new IntersectionObserver(NU,{root:null,rootMargin:"0px"})),av);function BU(){var n;const e=new I7({sdk:YT.JS,protocol:xU,version:CU});return Ys()&&(e.os=(n=X_())!==null&&n!==void 0?n:""),e}function jS(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=n,i.height=e;const o=i.getContext("2d");o==null||o.fillRect(0,0,i.width,i.height),r&&o&&(o.beginPath(),o.arc(n/2,e/2,50,0,Math.PI*2,!0),o.closePath(),o.fillStyle="grey",o.fill());const a=i.captureStream(),[s]=a.getTracks();if(!s)throw Error("Could not get empty media stream video track");return s.enabled=t,s}let Rd;function cv(){if(!Rd){const n=new AudioContext,e=n.createOscillator(),t=n.createGain();t.gain.setValueAtTime(0,0);const r=n.createMediaStreamDestination();if(e.connect(t),t.connect(r),e.start(),[Rd]=r.stream.getAudioTracks(),!Rd)throw Error("Could not get empty media stream audio track");Rd.enabled=!1}return Rd.clone()}class Xs{get isResolved(){return this._isResolved}constructor(e,t){this._isResolved=!1,this.onFinally=t,this.promise=new Promise((r,i)=>he(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;this._isResolved=!0,(r=this.onFinally)===null||r===void 0||r.call(this)})}}function OU(n,e){const t=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=t1();if(!r)throw new Error("Audio Context not supported on this browser");const i=t.cloneTrack?n.mediaStreamTrack.clone():n.mediaStreamTrack,o=r.createMediaStreamSource(new MediaStream([i])),a=r.createAnalyser();a.minDecibels=t.minDecibels,a.maxDecibels=t.maxDecibels,a.fftSize=t.fftSize,a.smoothingTimeConstant=t.smoothingTimeConstant,o.connect(a);const s=new Uint8Array(a.frequencyBinCount);return{calculateVolume:()=>{a.getByteFrequencyData(s);let h=0;for(const g of s)h+=Math.pow(g/255,2);return Math.sqrt(h/s.length)},analyser:a,cleanup:()=>he(this,void 0,void 0,function*(){yield r.close(),t.cloneTrack&&i.stop()})}}function FU(n){return wU.includes(n)}function wc(n){if(typeof n=="string"||typeof n=="number")return n;if(Array.isArray(n))return n[0];if(n.exact!==void 0)return Array.isArray(n.exact)?n.exact[0]:n.exact;if(n.ideal!==void 0)return Array.isArray(n.ideal)?n.ideal[0]:n.ideal;throw Error("could not unwrap constraint")}function LU(n){return n.startsWith("http")?n.replace(/^(http)/,"ws"):n}function Oy(n){return n.startsWith("ws")?n.replace(/^(ws)/,"http"):n}function UU(n,e){return n.segments.map(t=>{let{id:r,text:i,language:o,startTime:a,endTime:s,final:l}=t;var f;const h=(f=e.get(r))!==null&&f!==void 0?f:Date.now(),m=Date.now();return l?e.delete(r):e.set(r,h),{id:r,text:i,startTime:Number.parseInt(a.toString()),endTime:Number.parseInt(s.toString()),final:l,language:o,firstReceivedTime:h,lastReceivedTime:m}})}function jU(n){const{id:e,timestamp:t,message:r,editTimestamp:i}=n;return{id:e,timestamp:Number.parseInt(t.toString()),editTimestamp:i?Number.parseInt(i.toString()):void 0,message:r}}function GS(n){switch(n.reason){case Tn.LeaveRequest:return n.context;case Tn.Cancelled:return ws.CLIENT_INITIATED;case Tn.NotAllowed:return ws.USER_REJECTED;case Tn.ServerUnreachable:return ws.JOIN_FAILURE;default:return ws.UNKNOWN_REASON}}function H0(n){return n!==void 0?Number(n):void 0}function tl(n){return n!==void 0?BigInt(n):void 0}function hl(n){return!!n&&!(n instanceof MediaStreamTrack)&&n.isLocal}function $s(n){return!!n&&n.kind==Ue.Kind.Audio}function Mc(n){return!!n&&n.kind==Ue.Kind.Video}function cc(n){return hl(n)&&Mc(n)}function ba(n){return hl(n)&&$s(n)}function Fy(n){return!!n&&!n.isLocal}function GU(n){return!!n&&!n.isLocal}function lv(n){return Fy(n)&&Mc(n)}function VU(n){return n.isLocal}function zU(n,e){const t=[];let r=new TextEncoder().encode(n);for(;r.length>e;){let i=e;for(;i>0;){const o=r[i];if(o!==void 0&&(o&192)!==128)break;i--}t.push(r.slice(0,i)),r=r.slice(i)}return r.length>0&&t.push(r),t}function $_(n,e,t){var r,i,o,a;const{optionsWithoutProcessor:s,audioProcessor:l,videoProcessor:f}=q_(n??{}),h=e==null?void 0:e.processor,m=t==null?void 0:t.processor,g=s??{};return g.audio===!0&&(g.audio={}),g.video===!0&&(g.video={}),g.audio&&(Ly(g.audio,e),(r=(o=g.audio).deviceId)!==null&&r!==void 0||(o.deviceId={ideal:"default"}),(l||h)&&(g.audio.processor=l??h)),g.video&&(Ly(g.video,t),(i=(a=g.video).deviceId)!==null&&i!==void 0||(a.deviceId={ideal:"default"}),(f||m)&&(g.video.processor=f??m)),g}function Ly(n,e){return Object.keys(e).forEach(t=>{n[t]===void 0&&(n[t]=e[t])}),n}function e1(n){var e,t,r,i;const o={};if(n.video)if(typeof n.video=="object"){const a={},s=a,l=n.video;Object.keys(l).forEach(f=>{switch(f){case"resolution":Ly(s,l.resolution);break;default:s[f]=l[f]}}),o.video=a,(e=(r=o.video).deviceId)!==null&&e!==void 0||(r.deviceId={ideal:"default"})}else o.video=n.video?{deviceId:{ideal:"default"}}:!1;else o.video=!1;return n.audio?typeof n.audio=="object"?(o.audio=n.audio,(t=(i=o.audio).deviceId)!==null&&t!==void 0||(i.deviceId={ideal:"default"})):o.audio={deviceId:{ideal:"default"}}:o.audio=!1,o}function K_(n){return he(this,arguments,void 0,function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const r=t1();if(r){const i=r.createAnalyser();i.fftSize=2048;const o=i.frequencyBinCount,a=new Uint8Array(o);r.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield co(t),i.getByteTimeDomainData(a);const l=a.some(f=>f!==128&&f!==0);return r.close(),!l}return!1}()})}function t1(){var n;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const t=new e({latencyHint:"interactive"});if(t.state==="suspended"&&typeof window<"u"&&(!((n=window.document)===null||n===void 0)&&n.body)){const r=()=>he(this,void 0,void 0,function*(){var i;try{t.state==="suspended"&&(yield t.resume())}catch(o){console.warn("Error trying to auto-resume audio context",o)}(i=window.document.body)===null||i===void 0||i.removeEventListener("click",r)});window.document.body.addEventListener("click",r)}return t}}function WU(n){return n==="audioinput"?Ue.Source.Microphone:n==="videoinput"?Ue.Source.Camera:Ue.Source.Unknown}function Uy(n){return n===Ue.Source.Microphone?"audioinput":n===Ue.Source.Camera?"videoinput":void 0}function HU(n){var e,t;let r=(e=n.video)!==null&&e!==void 0?e:!0;return n.resolution&&n.resolution.width>0&&n.resolution.height>0&&(r=typeof r=="boolean"?{}:r,Il()?r=Object.assign(Object.assign({},r),{width:{max:n.resolution.width},height:{max:n.resolution.height},frameRate:n.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:n.resolution.width},height:{ideal:n.resolution.height},frameRate:n.resolution.frameRate})),{audio:(t=n.audio)!==null&&t!==void 0?t:!1,video:r,controller:n.controller,selfBrowserSurface:n.selfBrowserSurface,surfaceSwitching:n.surfaceSwitching,systemAudio:n.systemAudio,preferCurrentTab:n.preferCurrentTab}}function Hd(n){return n.split("/")[1].toLowerCase()}function ZU(n){const e=[];return n.forEach(t=>{t.track!==void 0&&e.push(new $C({cid:t.track.mediaStreamID,track:t.trackInfo}))}),e}function An(n){return"mediaStreamTrack"in n?{trackID:n.sid,source:n.source,muted:n.isMuted,enabled:n.mediaStreamTrack.enabled,kind:n.kind,streamID:n.mediaStreamID,streamTrackID:n.mediaStreamTrack.id}:{trackID:n.trackSid,enabled:n.isEnabled,muted:n.isMuted,trackInfo:Object.assign({mimeType:n.mimeType,name:n.trackName,encrypted:n.isEncrypted,kind:n.kind,source:n.source},n.track?An(n.track):{})}}function XU(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function $U(n,e){var t;n===void 0&&(n={}),e===void 0&&(e={});const r=[...Object.keys(e),...Object.keys(n)],i={};for(const o of r)n[o]!==e[o]&&(i[o]=(t=e[o])!==null&&t!==void 0?t:"");return i}function q_(n){const e=Object.assign({},n);let t,r;return typeof e.audio=="object"&&e.audio.processor&&(t=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(r=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:t,videoProcessor:r,optionsWithoutProcessor:gU(e)}}function KU(n){switch(n){case Ur.CAMERA:return Ue.Source.Camera;case Ur.MICROPHONE:return Ue.Source.Microphone;case Ur.SCREEN_SHARE:return Ue.Source.ScreenShare;case Ur.SCREEN_SHARE_AUDIO:return Ue.Source.ScreenShareAudio;default:return Ue.Source.Unknown}}function VS(n,e){return n.width*n.height<e.width*e.height}function qU(n,e){var t;return(t=n.layers)===null||t===void 0?void 0:t.find(r=>r.quality===e)}class YU extends ra.EventEmitter{constructor(e){super(),this.onWorkerMessage=t=>{var r,i;const{kind:o,data:a}=t.data;switch(o){case"error":wn.error(a.error.message),this.emit(xc.EncryptionError,a.error);break;case"initAck":a.enabled&&this.keyProvider.getKeys().forEach(s=>{this.postKey(s)});break;case"enable":if(a.enabled&&this.keyProvider.getKeys().forEach(s=>{this.postKey(s)}),this.encryptionEnabled!==a.enabled&&a.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(xc.ParticipantEncryptionStatusChanged,a.enabled,this.room.localParticipant),this.encryptionEnabled=a.enabled;else if(a.participantIdentity){const s=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(a.participantIdentity);if(!s)throw TypeError("couldn't set encryption status, participant not found".concat(a.participantIdentity));this.emit(xc.ParticipantEncryptionStatusChanged,a.enabled,s)}break;case"ratchetKey":this.keyProvider.emit(Ic.KeyRatcheted,a.ratchetResult,a.participantIdentity,a.keyIndex);break}},this.onWorkerError=t=>{wn.error("e2ee worker encountered an error:",{error:t.error}),this.emit(xc.EncryptionError,t.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!fU())throw new QC("tried to setup end-to-end encryption on an unsupported browser");if(wn.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:q7.getLevel()}};this.worker&&(wn.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){wn.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){!e||e.length===0?wn.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(yt.RTPVideoMapUpdate,t=>{this.postRTPMap(t)})}setupEventListeners(e,t){e.on(ze.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Eo.NONE,i.identity)),e.on(ze.ConnectionStateChanged,r=>{r===Pn.Connected&&e.remoteParticipants.forEach(i=>{i.trackPublications.forEach(o=>{this.setParticipantCryptorEnabled(o.trackInfo.encryption!==Eo.NONE,i.identity)})})}).on(ze.TrackUnsubscribed,(r,i,o)=>{var a;const s={kind:"removeTransform",data:{participantIdentity:o.identity,trackId:r.mediaStreamID}};(a=this.worker)===null||a===void 0||a.postMessage(s)}).on(ze.TrackSubscribed,(r,i,o)=>{this.setupE2EEReceiver(r,o.identity,i.trackInfo)}).on(ze.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");t.getKeys().forEach(r=>{this.postKey(r)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(Ze.LocalSenderCreated,(r,i)=>he(this,void 0,void 0,function*(){this.setupE2EESender(i,r)})),e.localParticipant.on(Ze.LocalTrackPublished,r=>{if(!Mc(r.track)||!uf())return;const i={kind:"updateCodec",data:{trackId:r.track.mediaStreamID,codec:Hd(r.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(i)}),t.on(Ic.SetKey,r=>this.postKey(r)).on(Ic.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(r)}postKey(e){let{key:t,participantIdentity:r,keyIndex:i}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const a={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity),key:t,keyIndex:i}};this.worker.postMessage(a)}postEnable(e,t){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((t=this.room)===null||t===void 0)&&t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,e.kind==="video"?Hd(r.mimeType):void 0)}}setupE2EESender(e,t){if(!hl(e)||!t){t||wn.warn("early return because sender is not ready");return}this.handleSender(t,e.mediaStreamID,void 0)}handleReceiver(e,t,r,i){return he(this,void 0,void 0,function*(){if(this.worker){if(Ty()){const o={kind:"decode",participantIdentity:r,trackId:t,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(Td in e&&i){const l={kind:"updateCodec",data:{trackId:t,codec:i,participantIdentity:r}};this.worker.postMessage(l);return}let o=e.writableStream,a=e.readableStream;if(!o||!a){const l=e.createEncodedStreams();e.writableStream=l.writable,o=l.writable,e.readableStream=l.readable,a=l.readable}const s={kind:"decode",data:{readableStream:a,writableStream:o,trackId:t,codec:i,participantIdentity:r,isReuse:Td in e}};this.worker.postMessage(s,[a,o])}e[Td]=!0}})}handleSender(e,t,r){var i;if(!(Td in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Ty()){wn.info("initialize script transform");const o={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{wn.info("initialize encoded streams");const o=e.createEncodedStreams(),a={kind:"encode",data:{readableStream:o.readable,writableStream:o.writable,codec:r,trackId:t,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(a,[o.readable,o.writable])}e[Td]=!0}}}const uv="default";class ai{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new ai),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o;if(((o=ai.userMediaPromiseMap)===null||o===void 0?void 0:o.size)>0){wn.debug("awaiting getUserMedia promise");try{t?yield ai.userMediaPromiseMap.get(t):yield Promise.all(ai.userMediaPromiseMap.values())}catch{wn.warn("error waiting for media permissons")}}let a=yield navigator.mediaDevices.enumerateDevices();if(i&&!(Il()&&r.hasDeviceInUse(t))&&(a.filter(l=>l.kind===t).length===0||a.some(l=>{const f=l.label==="",h=t?l.kind===t:!0;return f&&h}))){const l={video:t!=="audioinput"&&t!=="audiooutput",audio:t!=="videoinput"&&{deviceId:{ideal:"default"}}},f=yield navigator.mediaDevices.getUserMedia(l);a=yield navigator.mediaDevices.enumerateDevices(),f.getTracks().forEach(h=>{h.stop()})}return r._previousDevices=a,t&&(a=a.filter(s=>s.kind===t)),a}()})}normalizeDeviceId(e,t,r){return he(this,void 0,void 0,function*(){if(t!==uv)return t;const i=yield this.getDevices(e),o=i.find(s=>s.deviceId===uv);if(!o){wn.warn("could not reliably determine default device");return}const a=i.find(s=>s.deviceId!==uv&&s.groupId===(r??o.groupId));if(!a){wn.warn("could not reliably determine default device");return}return a==null?void 0:a.deviceId})}hasDeviceInUse(e){return e?ai.userMediaPromiseMap.has(e):ai.userMediaPromiseMap.size>0}}ai.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];ai.userMediaPromiseMap=new Map;var Zd;(function(n){n[n.WAITING=0]="WAITING",n[n.RUNNING=1]="RUNNING",n[n.COMPLETED=2]="COMPLETED"})(Zd||(Zd={}));class QU{constructor(){this.pendingTasks=new Map,this.taskMutex=new ao,this.nextTaskIndex=0}run(e){return he(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Zd.WAITING};this.pendingTasks.set(t.id,t);const r=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=Zd.RUNNING,yield e()}finally{t.status=Zd.COMPLETED,this.pendingTasks.delete(t.id),r()}})}flush(){return he(this,void 0,void 0,function*(){return this.run(()=>he(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}function JU(n,e){const t=new URL(LU(n));return e.forEach((r,i)=>{t.searchParams.set(i,r)}),Y_(t,"rtc")}function ej(n){const e=new URL(Oy(n));return Y_(e,"validate")}function tj(n){return n.endsWith("/")?n:"".concat(n,"/")}function Y_(n,e){return n.pathname="".concat(tj(n.pathname)).concat(e),n.toString()}const nj=["syncState","trickle","offer","answer","simulate","leave"];function rj(n){const e=nj.indexOf(n.case)>=0;return wn.trace("request allowed to bypass queue:",{canPass:e,req:n}),e}var cr;(function(n){n[n.CONNECTING=0]="CONNECTING",n[n.CONNECTED=1]="CONNECTED",n[n.RECONNECTING=2]="RECONNECTING",n[n.DISCONNECTING=3]="DISCONNECTING",n[n.DISCONNECTED=4]="DISCONNECTED"})(cr||(cr={}));class n1{get currentState(){return this.state}get isDisconnected(){return this.state===cr.DISCONNECTING||this.state===cr.DISCONNECTED}get isEstablishingConnection(){return this.state===cr.CONNECTING||this.state===cr.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=cr.DISCONNECTED,this.log=wn,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=Ma((r=t.loggerName)!==null&&r!==void 0?r:As.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new QU,this.queuedRequests=[],this.closingLock=new ao,this.connectionLock=new ao,this.state=cr.DISCONNECTED}get logContext(){var e,t;return(t=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&t!==void 0?t:{}}join(e,t,r,i){return he(this,void 0,void 0,function*(){return this.state=cr.CONNECTING,this.options=r,yield this.connect(e,t,r,i)})}reconnect(e,t,r,i){return he(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=cr.RECONNECTING,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,t,r,i){this.connectOptions=r;const o=BU(),a=ij(t,o,r),s=JU(e,a),l=ej(s);return new Promise((f,h)=>he(this,void 0,void 0,function*(){const m=yield this.connectionLock.lock();try{const g=()=>he(this,void 0,void 0,function*(){this.close(),clearTimeout(y),h(new Zn("room connection has been cancelled (signal)",Tn.Cancelled))}),y=setTimeout(()=>{this.close(),h(new Zn("room connection has timed out (signal)",Tn.ServerUnreachable))},r.websocketTimeout);i!=null&&i.aborted&&g(),i==null||i.addEventListener("abort",g);const C=new URL(s);C.searchParams.has("access_token")&&C.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(C),Object.assign({reconnect:r.reconnect,reconnectReason:r.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(s),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(y)},this.ws.onerror=x=>he(this,void 0,void 0,function*(){if(this.state!==cr.CONNECTED){this.state=cr.DISCONNECTED,clearTimeout(y);try{const w=yield fetch(l);if(w.status.toFixed(0).startsWith("4")){const S=yield w.text();h(new Zn(S,Tn.NotAllowed,w.status))}else h(new Zn("Encountered unknown websocket error during connection: ".concat(x.toString()),Tn.InternalError,w.status))}catch(w){h(new Zn(w instanceof Error?w.message:"server was not reachable",Tn.ServerUnreachable))}return}this.handleWSError(x)}),this.ws.onmessage=x=>he(this,void 0,void 0,function*(){var w,S,A;let E;if(typeof x.data=="string"){const _=JSON.parse(x.data);E=CS.fromJson(_,{ignoreUnknownFields:!0})}else if(x.data instanceof ArrayBuffer)E=CS.fromBinary(new Uint8Array(x.data));else{this.log.error("could not decode websocket message: ".concat(typeof x.data),this.logContext);return}if(this.state!==cr.CONNECTED){let _=!1;if(((w=E.message)===null||w===void 0?void 0:w.case)==="join"?(this.state=cr.CONNECTED,i==null||i.removeEventListener("abort",g),this.pingTimeoutDuration=E.message.value.pingTimeout,this.pingIntervalDuration=E.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),f(E.message.value)):this.state===cr.RECONNECTING&&E.message.case!=="leave"?(this.state=cr.CONNECTED,i==null||i.removeEventListener("abort",g),this.startPingInterval(),((S=E.message)===null||S===void 0?void 0:S.case)==="reconnect"?f(E.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),f(void 0),_=!0)):this.isEstablishingConnection&&E.message.case==="leave"?h(new Zn("Received leave request while trying to (re)connect",Tn.LeaveRequest,void 0,E.message.value.reason)):r.reconnect||h(new Zn("did not receive join response, got ".concat((A=E.message)===null||A===void 0?void 0:A.case," instead"),Tn.InternalError)),!_)return}this.signalLatency&&(yield co(this.signalLatency)),this.handleSignalResponse(E)}),this.ws.onclose=x=>{this.isEstablishingConnection&&h(new Zn("Websocket got closed during a (re)connection attempt",Tn.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:x.reason,code:x.code,wasClean:x.wasClean,state:this.state})),this.handleOnClose(x.reason)}}finally{m()}}))}close(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.closingLock.lock();try{if(e.clearPingInterval(),t&&(e.state=cr.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const i=new Promise(o=>{e.ws?e.ws.onclose=()=>{o()}:o()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([i,co(250)])),e.ws=void 0}}finally{t&&(e.state=cr.DISCONNECTED),r()}}()})}sendOffer(e,t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:gp(e,t)})}sendAnswer(e,t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:gp(e,t)})}sendIceCandidate(e,t){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new ZC({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new XC({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return he(this,arguments,void 0,function(r,i){var o=this;let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const s=o.getNextRequestId();return yield o.sendRequest({case:"updateMetadata",value:new o_({requestId:s,metadata:r,name:i,attributes:a})}),s}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new i_({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new c_({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:gr.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new f_({timestamp:gr.parse(Date.now()),rtt:gr.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,t){return this.sendRequest({case:"updateAudioTrack",value:new r_({trackSid:e,features:t})})}sendLeave(){return this.sendRequest({case:"leave",value:new Gp({reason:ws.CLIENT_INITIATED,action:mu.DISCONNECT})})}sendRequest(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!i&&!rj(t)&&r.state===cr.RECONNECTING){r.queuedRequests.push(()=>he(r,void 0,void 0,function*(){yield this.sendRequest(t,!0)}));return}if(i||(yield r.requestQueue.flush()),r.signalLatency&&(yield co(r.signalLatency)),r.isDisconnected){r.log.debug("skipping signal request (type: ".concat(t.case,") - SignalClient disconnected"));return}if(!r.ws||r.ws.readyState!==r.ws.OPEN){r.log.error("cannot send signal request before connected, type: ".concat(t==null?void 0:t.case),r.logContext);return}const a=new A7({message:t});try{r.useJSON?r.ws.send(a.toJsonString()):r.ws.send(a.toBinary())}catch(s){r.log.error("error sending signal message",Object.assign(Object.assign({},r.logContext),{error:s}))}}()})}handleSignalResponse(e){var t,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let o=!1;if(i.case==="answer"){const a=zS(i.value);this.onAnswer&&this.onAnswer(a,i.value.id)}else if(i.case==="offer"){const a=zS(i.value);this.onOffer&&this.onOffer(a,i.value.id)}else if(i.case==="trickle"){const a=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(a,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((t=i.value.participants)!==null&&t!==void 0?t:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):i.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(i.value):i.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(i.value.trackSid):i.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(i.value.token),this.onRoomMoved&&this.onRoomMoved(i.value)):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return he(this,void 0,void 0,function*(){if(this.state===cr.DISCONNECTED)return;const t=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=gi.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&gi.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=gi.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&gi.clearInterval(this.pingInterval)}}function zS(n){const e={type:"offer",sdp:n.sdp};switch(n.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=n.type;break}return e}function gp(n,e){return new xl({sdp:n.sdp,type:n.type,id:e})}function ij(n,e,t){var r;const i=new URLSearchParams;return i.set("access_token",n),t.reconnect&&(i.set("reconnect","1"),t.sid&&i.set("sid",t.sid)),i.set("auto_subscribe",t.autoSubscribe?"1":"0"),i.set("sdk",Ys()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),t.adaptiveStream&&i.set("adaptive_stream","1"),t.reconnectReason&&i.set("reconnect_reason",t.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),i}class WS{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const t=this.buffer[0];if(this._totalSize-t.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class oj{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,t){const r=Date.now();r-this._lastCleanup>this.ttl/2&&this.cleanup();const i=r+this.ttl;return this._map.set(e,{value:t,expiresAt:i}),this}get(e){const t=this._map.get(e);if(t){if(t.expiresAt<Date.now()){this._map.delete(e);return}return t.value}}has(e){const t=this._map.get(e);return t?t.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[t,r]of this._map.entries())r.expiresAt<e&&this._map.delete(t);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[t,r]of this._map.entries())r.expiresAt>=Date.now()&&e(r.value,t,this.asValueMap())}map(e){this.cleanup();const t=[],r=this.asValueMap();for(const[i,o]of r.entries())t.push(e(o,i,r));return t}asValueMap(){const e=new Map;for(const[t,r]of this._map.entries())r.expiresAt>=Date.now()&&e.set(t,r.value);return e}}var is={},dv={},fv={exports:{}},HS;function r1(){if(HS)return fv.exports;HS=1;var n=fv.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(n).forEach(function(e){var t=n[e];t.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),fv.exports}var ZS;function sj(){return ZS||(ZS=1,function(n){var e=function(s){return String(Number(s))===s?Number(s):s},t=function(s,l,f,h){if(h&&!f)l[h]=e(s[1]);else for(var m=0;m<f.length;m+=1)s[m+1]!=null&&(l[f[m]]=e(s[m+1]))},r=function(s,l,f){var h=s.name&&s.names;s.push&&!l[s.push]?l[s.push]=[]:h&&!l[s.name]&&(l[s.name]={});var m=s.push?{}:h?l[s.name]:l;t(f.match(s.reg),m,s.names,s.name),s.push&&l[s.push].push(m)},i=r1(),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(s){var l={},f=[],h=l;return s.split(/(\r\n|\r|\n)/).filter(o).forEach(function(m){var g=m[0],y=m.slice(2);g==="m"&&(f.push({rtp:[],fmtp:[]}),h=f[f.length-1]);for(var C=0;C<(i[g]||[]).length;C+=1){var x=i[g][C];if(x.reg.test(y))return r(x,h,y)}}),l.media=f,l};var a=function(s,l){var f=l.split(/=(.+)/,2);return f.length===2?s[f[0]]=e(f[1]):f.length===1&&l.length>1&&(s[f[0]]=void 0),s};n.parseParams=function(s){return s.split(/;\s?/).reduce(a,{})},n.parseFmtpConfig=n.parseParams,n.parsePayloads=function(s){return s.toString().split(" ").map(Number)},n.parseRemoteCandidates=function(s){for(var l=[],f=s.split(" ").map(e),h=0;h<f.length;h+=3)l.push({component:f[h],ip:f[h+1],port:f[h+2]});return l},n.parseImageAttributes=function(s){return s.split(" ").map(function(l){return l.substring(1,l.length-1).split(",").reduce(a,{})})},n.parseSimulcastStreamList=function(s){return s.split(";").map(function(l){return l.split(",").map(function(f){var h,m=!1;return f[0]!=="~"?h=e(f):(h=e(f.substring(1,f.length)),m=!0),{scid:h,paused:m}})})}}(dv)),dv}var hv,XS;function aj(){if(XS)return hv;XS=1;var n=r1(),e=/%[sdv%]/g,t=function(a){var s=1,l=arguments,f=l.length;return a.replace(e,function(h){if(s>=f)return h;var m=l[s];switch(s+=1,h){case"%%":return"%";case"%s":return String(m);case"%d":return Number(m);case"%v":return""}})},r=function(a,s,l){var f=s.format instanceof Function?s.format(s.push?l:l[s.name]):s.format,h=[a+"="+f];if(s.names)for(var m=0;m<s.names.length;m+=1){var g=s.names[m];s.name?h.push(l[s.name][g]):h.push(l[s.names[m]])}else h.push(l[s.name]);return t.apply(null,h)},i=["v","o","s","i","u","e","p","c","b","t","r","z","a"],o=["i","c","b","a"];return hv=function(a,s){s=s||{},a.version==null&&(a.version=0),a.name==null&&(a.name=" "),a.media.forEach(function(m){m.payloads==null&&(m.payloads="")});var l=s.outerOrder||i,f=s.innerOrder||o,h=[];return l.forEach(function(m){n[m].forEach(function(g){g.name in a&&a[g.name]!=null?h.push(r(m,g,a)):g.push in a&&a[g.push]!=null&&a[g.push].forEach(function(y){h.push(r(m,g,y))})})}),a.media.forEach(function(m){h.push(r("m",n.m[0],m)),f.forEach(function(g){n[g].forEach(function(y){y.name in m&&m[y.name]!=null?h.push(r(g,y,m)):y.push in m&&m[y.push]!=null&&m[y.push].forEach(function(C){h.push(r(g,y,C))})})})}),h.join(`\r
`)+`\r
`},hv}var $S;function cj(){if($S)return is;$S=1;var n=sj(),e=aj(),t=r1();return is.grammar=t,is.write=e,is.parse=n.parse,is.parseParams=n.parseParams,is.parseFmtpConfig=n.parseFmtpConfig,is.parsePayloads=n.parsePayloads,is.parseRemoteCandidates=n.parseRemoteCandidates,is.parseImageAttributes=n.parseImageAttributes,is.parseSimulcastStreamList=n.parseSimulcastStreamList,is}var pc=cj();function i1(n,e,t){var r,i,o;e===void 0&&(e=50),t===void 0&&(t={});var a=(r=t.isImmediate)!=null&&r,s=(i=t.callback)!=null&&i,l=t.maxWait,f=Date.now(),h=[];function m(){if(l!==void 0){var y=Date.now()-f;if(y+e>=l)return l-y}return e}var g=function(){var y=[].slice.call(arguments),C=this;return new Promise(function(x,w){var S=a&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,f=Date.now(),!a){var E=n.apply(C,y);s&&s(E),h.forEach(function(_){return(0,_.resolve)(E)}),h=[]}},m()),S){var A=n.apply(C,y);return s&&s(A),x(A)}h.push({resolve:x,reject:w})})};return g.cancel=function(y){o!==void 0&&clearTimeout(o),h.forEach(function(C){return(0,C.reject)(y)}),h=[]},g}const lj=.7,uj=20,Cu={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class KS extends ra.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;super(),this.log=wn,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=i1(i=>he(this,void 0,void 0,function*(){this.emit(Cu.NegotiationStarted);try{yield this.createAndSendOffer()}catch(o){if(i)i(o);else throw o}}),uj),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Ma((r=t.loggerName)!==null&&r!==void 0?r:As.PCTransport),this.loggerOptions=t,this.config=e,this._pc=this.createPC(),this.offerLock=new ao}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=t=>{var r;t.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,t.candidate))},e.onicecandidateerror=t=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,t)},e.oniceconnectionstatechange=()=>{var t;(t=this.onIceConnectionStateChange)===null||t===void 0||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;(t=this.onSignalingStatechange)===null||t===void 0||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,e.connectionState)},e.ondatachannel=t=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,t)},e.ontrack=t=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,t)},e}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return he(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,t){return he(this,void 0,void 0,function*(){var r;if(e.type==="answer"&&this.latestOfferId>0&&t>0&&t!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:t,latestOfferId:this.latestOfferId})),!1;let i;if(e.type==="offer"){let{stereoMids:o,nackMids:a}=dj(e);this.remoteStereoMids=o,this.remoteNackMids=a}else if(e.type==="answer"){const o=pc.parse((r=e.sdp)!==null&&r!==void 0?r:"");o.media.forEach(a=>{a.type==="audio"&&this.trackBitrates.some(s=>{if(!s.transceiver||a.mid!=s.transceiver.mid)return!1;let l=0;if(a.rtp.some(h=>h.codec.toUpperCase()===s.codec.toUpperCase()?(l=h.payload,!0):!1),l===0)return!0;let f=!1;for(const h of a.fmtp)if(h.payload===l){h.config=h.config.split(";").filter(m=>!m.includes("maxaveragebitrate")).join(";"),s.maxbr>0&&(h.config+=";maxaveragebitrate=".concat(s.maxbr*1e3)),f=!0;break}return f||s.maxbr>0&&a.fmtp.push({payload:l,config:"maxaveragebitrate=".concat(s.maxbr*1e3)}),!0})}),i=pc.write(o)}return yield this.setMungedSDP(e,i,!0),this.pendingCandidates.forEach(o=>{this.pc.addIceCandidate(o)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Cu.NegotiationComplete),e.sdp&&pc.parse(e.sdp).media.forEach(a=>{a.type==="video"&&this.emit(Cu.RTPVideoPayloadTypes,a.rtp)})),!0})}createAndSendOffer(e){return he(this,void 0,void 0,function*(){var t;const r=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const i=this.latestOfferId+1;this.latestOfferId=i;const o=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:o.sdp},this.logContext));const a=pc.parse((t=o.sdp)!==null&&t!==void 0?t:"");if(a.media.forEach(s=>{YS(s),s.type==="audio"?qS(s,[],[]):s.type==="video"&&this.trackBitrates.some(l=>{if(!s.msid||!l.cid||!s.msid.includes(l.cid))return!1;let f=0;if(s.rtp.some(m=>m.codec.toUpperCase()===l.codec.toUpperCase()?(f=m.payload,!0):!1),f===0||(Zs(l.codec)&&!Il()&&this.ensureVideoDDExtensionForSVC(s,a),l.codec!=="av1"))return!0;const h=Math.round(l.maxbr*lj);for(const m of s.fmtp)if(m.payload===f){m.config.includes("x-google-start-bitrate")||(m.config+=";x-google-start-bitrate=".concat(h));break}return!0})}),this.latestOfferId>i){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:i}));return}yield this.setMungedSDP(o,pc.write(a)),this.onOffer(o,this.latestOfferId)}finally{r()}})}createAndSetAnswer(){return he(this,void 0,void 0,function*(){var e;const t=yield this.pc.createAnswer(),r=pc.parse((e=t.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{YS(i),i.type==="audio"&&qS(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,pc.write(r)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new $r("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new $r("PC closed, cannot configure");return(t=this._pc)===null||t===void 0?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var t;return(t=this._pc)===null||t===void 0?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&t!==void 0?t:"closed"}getICEConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&t!==void 0?t:"closed"}getSignallingState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&t!==void 0?t:"closed"}getTransceivers(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&t!==void 0?t:[]}getSenders(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&t!==void 0?t:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return he(this,void 0,void 0,function*(){var e;if(!this._pc)return;let t="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(s=>{switch(s.type){case"transport":t=s.selectedCandidatePairId;break;case"candidate-pair":t===""&&s.selected&&(t=s.id),r.set(s.id,s);break;case"remote-candidate":i.set(s.id,"".concat(s.address,":").concat(s.port));break}}),t==="")return;const a=(e=r.get(t))===null||e===void 0?void 0:e.remoteCandidateId;if(a!==void 0)return i.get(a)})}setMungedSDP(e,t,r){return he(this,void 0,void 0,function*(){if(t){const i=e.sdp;e.sdp=t;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(o){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:o,sdp:t})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let o="unknown error";i instanceof Error?o=i.message:typeof i=="string"&&(o=i);const a={error:o,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(a.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:a})),new _y(o)}})}ensureVideoDDExtensionForSVC(e,t){var r,i;if(!((r=e.ext)===null||r===void 0?void 0:r.some(a=>a.uri===OS))){if(this.ddExtID===0){let a=0;t.media.forEach(s=>{var l;s.type==="video"&&((l=s.ext)===null||l===void 0||l.forEach(f=>{f.value>a&&(a=f.value)}))}),this.ddExtID=a+1}(i=e.ext)===null||i===void 0||i.push({value:this.ddExtID,uri:OS})}}}function qS(n,e,t){let r=0;n.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(n.rtcpFb||(n.rtcpFb=[]),t.includes(n.mid)&&!n.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&n.rtcpFb.push({payload:r,type:"nack"}),e.includes(n.mid)&&n.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function dj(n){var e;const t=[],r=[],i=pc.parse((e=n.sdp)!==null&&e!==void 0?e:"");let o=0;return i.media.forEach(a=>{var s;a.type==="audio"&&(a.rtp.some(l=>l.codec==="opus"?(o=l.payload,!0):!1),!((s=a.rtcpFb)===null||s===void 0)&&s.some(l=>l.payload===o&&l.type==="nack")&&r.push(a.mid),a.fmtp.some(l=>l.payload===o?(l.config.includes("sprop-stereo=1")&&t.push(a.mid),!0):!1))}),{stereoMids:t,nackMids:r}}function YS(n){if(n.connection){const e=n.connection.ip.indexOf(":")>=0;(n.connection.version===4&&e||n.connection.version===6&&!e)&&(n.connection.ip="0.0.0.0",n.connection.version=4)}}const jy="vp8",fj={audioPreset:Ry.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:JC.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:jy,backupCodec:!0,preConnectBuffer:!1},Q_={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},J_={deviceId:{ideal:"default"},resolution:lf.h720.resolution},hj={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new Q7,disconnectOnPageLeave:!0,webAudioMix:!1},o1={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Er;(function(n){n[n.NEW=0]="NEW",n[n.CONNECTING=1]="CONNECTING",n[n.CONNECTED=2]="CONNECTED",n[n.FAILED=3]="FAILED",n[n.CLOSING=4]="CLOSING",n[n.CLOSED=5]="CLOSED"})(Er||(Er={}));class pj{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t,r){var i;this.peerConnectionTimeout=o1.peerConnectionTimeout,this.log=wn,this.updateState=()=>{var o;const a=this.state,s=this.requiredTransports.map(l=>l.getConnectionState());s.every(l=>l==="connected")?this.state=Er.CONNECTED:s.some(l=>l==="failed")?this.state=Er.FAILED:s.some(l=>l==="connecting")?this.state=Er.CONNECTING:s.every(l=>l==="closed")?this.state=Er.CLOSED:s.some(l=>l==="closed")?this.state=Er.CLOSING:s.every(l=>l==="new")&&(this.state=Er.NEW),a!==this.state&&(this.log.debug("pc state change: from ".concat(Er[a]," to ").concat(Er[this.state]),this.logContext),(o=this.onStateChange)===null||o===void 0||o.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=Ma((i=r.loggerName)!==null&&i!==void 0?i:As.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!t,this.isSubscriberConnectionRequired=t,this.publisher=new KS(e,r),this.subscriber=new KS(e,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=o=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,o,xs.PUBLISHER)},this.subscriber.onIceCandidate=o=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,o,xs.SUBSCRIBER)},this.subscriber.onDataChannel=o=>{var a;(a=this.onDataChannel)===null||a===void 0||a.call(this,o)},this.subscriber.onTrack=o=>{var a;(a=this.onTrack)===null||a===void 0||a.call(this,o)},this.publisher.onOffer=(o,a)=>{var s;(s=this.onPublisherOffer)===null||s===void 0||s.call(this,o,a)},this.state=Er.NEW,this.connectionLock=new ao,this.remoteOfferLock=new ao}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,t){return this.publisher.setRemoteDescription(e,t)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return he(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const t of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(t)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return he(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return he(this,void 0,void 0,function*(){t===xs.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,t){return he(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const r=yield this.remoteOfferLock.lock();try{return(yield this.subscriber.setRemoteDescription(e,t))?yield this.subscriber.createAndSetAnswer():void 0}finally{r()}})}updateConfiguration(e,t){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){return he(this,void 0,void 0,function*(){var r;const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(o=>this.ensureTransportConnected(o,e,t)))}finally{i()}})}negotiate(e){return he(this,void 0,void 0,function*(){return new Promise((t,r)=>he(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),o=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",o),this.publisher.once(Cu.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Cu.NegotiationComplete,()=>{clearTimeout(i),t()})}),yield this.publisher.negotiate(a=>{clearTimeout(i),r(a)})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===xs.PUBLISHER?this.publisher.getConnectedAddress():e===xs.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,t){return he(this,arguments,void 0,function(r,i){var o=this;let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(r.getConnectionState()!=="connected")return new Promise((l,f)=>he(o,void 0,void 0,function*(){const h=()=>{this.log.warn("abort transport connection",this.logContext),gi.clearTimeout(m),f(new Zn("room connection has been cancelled",Tn.Cancelled))};i!=null&&i.signal.aborted&&h(),i==null||i.signal.addEventListener("abort",h);const m=gi.setTimeout(()=>{i==null||i.signal.removeEventListener("abort",h),f(new Zn("could not establish pc connection",Tn.InternalError))},a);for(;this.state!==Er.CONNECTED;)if(yield co(50),i!=null&&i.signal.aborted){f(new Zn("room connection has been cancelled",Tn.Cancelled));return}gi.clearTimeout(m),i==null||i.signal.removeEventListener("abort",h),l()}))}()})}}class Rr extends Error{constructor(e,t,r){super(t),this.code=e,this.message=QS(t,Rr.MAX_MESSAGE_BYTES),this.data=r?QS(r,Rr.MAX_DATA_BYTES):void 0}static fromProto(e){return new Rr(e.code,e.message,e.data)}toProto(){return new XT({code:this.code,message:this.message,data:this.data})}static builtIn(e,t){return new Rr(Rr.ErrorCode[e],Rr.ErrorMessage[e],t)}}Rr.MAX_MESSAGE_BYTES=256;Rr.MAX_DATA_BYTES=15360;Rr.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};Rr.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const e2=15360;function s1(n){return new TextEncoder().encode(n).length}function QS(n,e){if(s1(n)<=e)return n;let t=0,r=n.length;const i=new TextEncoder;for(;t<r;){const o=Math.floor((t+r+1)/2);i.encode(n.slice(0,o)).length<=e?t=o:r=o-1}return n.slice(0,t)}const a1=2e3;function zp(n,e){if(!e)return 0;let t,r;return"bytesReceived"in n?(t=n.bytesReceived,r=e.bytesReceived):"bytesSent"in n&&(t=n.bytesSent,r=e.bytesSent),t===void 0||r===void 0||n.timestamp===void 0||e.timestamp===void 0?0:(t-r)*8*1e3/(n.timestamp-e.timestamp)}const c1=typeof MediaRecorder<"u";class gj{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const mj=c1?MediaRecorder:gj;class vj extends mj{constructor(e,t){if(!c1)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),t);let r,i;const o=()=>i===void 0,a=()=>{this.removeEventListener("dataavailable",r),this.removeEventListener("stop",a),this.removeEventListener("error",s),i==null||i.close(),i=void 0},s=l=>{i==null||i.error(l),this.removeEventListener("dataavailable",r),this.removeEventListener("stop",a),this.removeEventListener("error",s),i=void 0};this.byteStream=new ReadableStream({start:l=>{i=l,r=f=>he(this,void 0,void 0,function*(){let h;if(f.data.arrayBuffer){const m=yield f.data.arrayBuffer();h=new Uint8Array(m)}else if(f.data.byteArray)h=f.data.byteArray;else throw new Error("no data available!");o()||l.enqueue(h)}),this.addEventListener("dataavailable",r)},cancel:()=>{a()}}),this.addEventListener("stop",a),this.addEventListener("error",s)}}function yj(){return c1}const Cj=1e3,xj=1e4;class t2 extends Ue{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;super(e,t,o),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=i1(()=>he(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>he(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(ht.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new ao,this.pauseUpstreamLock=new ao,this.trackChangeLock=new ao,this.trackChangeLock.lock().then(a=>he(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{a()}})),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Ue.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();if(e&&t)return{width:e,height:t}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return(t=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&t!==void 0?t:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,t){return he(this,void 0,void 0,function*(){var r;if(e===this._mediaStreamTrack&&!t)return;this._mediaStreamTrack&&(this.attachedElements.forEach(o=>{yu(this._mediaStreamTrack,o)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let i;if(this.processor&&e){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(du(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}this.sender&&((r=this.sender.transport)===null||r===void 0?void 0:r.state)!=="closed"&&(yield this.sender.replaceTrack(i??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(o=>{du(i??e,o)}))})}waitForDimensions(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Cj;return function*(){var r;if(e.kind===Ue.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((r=_o())===null||r===void 0?void 0:r.os)==="iOS"&&(yield co(10));const i=Date.now();for(;Date.now()-i<t;){const o=e.dimensions;if(o)return o;yield co(50)}throw new Ta("unable to get track dimensions after timeout")}()})}setDeviceId(e){return he(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===wc(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),wc(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===Ue.Source.ScreenShare)return;const{deviceId:r,groupId:i}=e._mediaStreamTrack.getSettings(),o=e.kind===Ue.Kind.Audio?"audioinput":"videoinput";return t?ai.getInstance().normalizeDeviceId(o,r,i):r}()})}mute(){return he(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return he(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,t){return he(this,void 0,void 0,function*(){const r=yield this.trackChangeLock.lock();try{if(!this.sender)throw new Ta("unable to replace an unpublished track");let i,o;return typeof t=="boolean"?i=t:t!==void 0&&(i=t.userProvidedTrack,o=t.stopProcessor),this.providedByUser=i??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),o&&this.processor&&(yield this.internalStopProcessor()),this}finally{r()}})}restart(e){return he(this,void 0,void 0,function*(){this.manuallyStopped=!1;const t=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:r,facingMode:i}=e,o=J7(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const a={audio:!1,video:!1};this.kind===Ue.Kind.Video?a.video=r||i?{deviceId:r,facingMode:i}:!0:a.audio=r?Object.assign({deviceId:r},o):!0,this.attachedElements.forEach(f=>{yu(this.mediaStreamTrack,f)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const l=(yield navigator.mediaDevices.getUserMedia(a)).getTracks()[0];return this.kind===Ue.Kind.Video&&(yield l.applyConstraints(o)),l.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(l),this._constraints=e,this.emit(ht.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{t()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ht.Muted:ht.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return he(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),H_()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return he(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(ht.UpstreamPaused,this);const r=_o();if((r==null?void 0:r.name)==="Safari"&&ks(r.version,"12.0")<0)throw new QC("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{t()}})}resumeUpstream(){return he(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(ht.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{t()}})}getRTCStatsReport(){return he(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o;const a=yield r.trackChangeLock.lock();try{r.log.debug("setting up processor",r.logContext);const s=document.createElement(r.kind),l={kind:r.kind,track:r._mediaStreamTrack,element:s,audioContext:r.audioContext};if(yield t.init(l),r.log.debug("processor initialized",r.logContext),r.processor&&(yield r.internalStopProcessor()),r.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(du(r._mediaStreamTrack,s),s.muted=!0,s.play().catch(f=>{f instanceof DOMException&&f.name==="AbortError"?(r.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},r.logContext),{error:f})),setTimeout(()=>{s.play().catch(h=>{r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{err:h}))})},100)):r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{error:f}))}),r.processor=t,r.processorElement=s,r.processor.processedTrack){for(const f of r.attachedElements)f!==r.processorElement&&i&&(yu(r._mediaStreamTrack,f),du(r.processor.processedTrack,f));yield(o=r.sender)===null||o===void 0?void 0:o.replaceTrack(r.processor.processedTrack)}r.emit(ht.TrackProcessorUpdate,r.processor)}finally{a()}}()})}getProcessor(){return this.processor}stopProcessor(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(t)}finally{r()}}()})}internalStopProcessor(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var r,i;e.processor&&(e.log.debug("stopping processor",e.logContext),(r=e.processor.processedTrack)===null||r===void 0||r.stop(),yield e.processor.destroy(),e.processor=void 0,t||((i=e.processorElement)===null||i===void 0||i.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(ht.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!yj()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let t="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(t)||(t="video/mp4"),this.localTrackRecorder=new vj(this,{mimeType:t})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},xj)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class mp extends t2{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(e,Ue.Kind.Audio,t,r,o),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>he(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let a;try{a=yield this.getSenderStats()}catch(s){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:s}));return}a&&this.prevStats&&(this._currentBitrate=zp(a,this.prevStats)),this.prevStats=a}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(ht.AudioTrackFeatureUpdate,this,si.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(ht.AudioTrackFeatureUpdate,this,si.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=i,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return he(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Ue.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return he(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==wc(this._constraints.deviceId);return this.source===Ue.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return he(this,void 0,void 0,function*(){let t;if(e){const r=e1({audio:e});typeof r.audio!="boolean"&&(t=r.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return he(this,void 0,void 0,function*(){const r=yield t.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){so()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},a1)))}setProcessor(e){return he(this,void 0,void 0,function*(){var t;const r=yield this.trackChangeLock.lock();try{if(!Ys()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(t=this.sender)===null||t===void 0?void 0:t.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(ht.TrackProcessorUpdate,this.processor)}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return he(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const t=yield this.sender.getStats();let r;return t.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return he(this,void 0,void 0,function*(){const e=yield K_(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(ht.AudioSilenceDetected)),e})}}function bj(n,e,t){switch(n.kind){case"audio":return new mp(n,e,!1,void 0,t);case"video":return new vp(n,e,!1,t);default:throw new Ta("unsupported track type: ".concat(n.kind))}}const Ij=Object.values(lf),wj=Object.values(Py),Sj=Object.values(JC),Aj=[lf.h180,lf.h360],kj=[Py.h180,Py.h360],Ej=n=>[{scaleResolutionDownBy:2,fps:n.encoding.maxFramerate}].map(t=>{var r,i;return new Hn(Math.floor(n.width/t.scaleResolutionDownBy),Math.floor(n.height/t.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(t.scaleResolutionDownBy,2)*(((r=n.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=t.fps)!==null&&i!==void 0?i:30))))),t.fps,n.encoding.priority)}),Gy=["q","h","f"];function Vy(n,e,t,r){var i,o;let a=r==null?void 0:r.videoEncoding;n&&(a=r==null?void 0:r.screenShareEncoding);const s=r==null?void 0:r.simulcast,l=r==null?void 0:r.scalabilityMode,f=r==null?void 0:r.videoCodec;if(!a&&!s&&!l||!e||!t)return[{}];a||(a=_j(n,e,t,f),wn.debug("using video encoding",a));const h=a.maxFramerate,m=new Hn(e,t,a.maxBitrate,a.maxFramerate,a.priority);if(l&&Zs(f)){const C=new n2(l),x=[];if(C.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(l));const w=_o();if(uf()||Ys()||(w==null?void 0:w.name)==="Chrome"&&ks(w==null?void 0:w.version,"113")<0){const S=C.suffix=="h"?2:3,A=PU(w);for(let E=0;E<C.spatial;E+=1)x.push({rid:Gy[2-E],maxBitrate:a.maxBitrate/Math.pow(S,E),maxFramerate:m.encoding.maxFramerate,scaleResolutionDownBy:A?Math.pow(2,E):void 0});x[0].scalabilityMode=l}else x.push({maxBitrate:a.maxBitrate,maxFramerate:m.encoding.maxFramerate,scalabilityMode:l});return m.encoding.priority&&(x[0].priority=m.encoding.priority,x[0].networkPriority=m.encoding.priority),wn.debug("using svc encoding",{encodings:x}),x}if(!s)return[a];let g=[];n?g=(i=eA(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:JS(n,m):g=(o=eA(r==null?void 0:r.videoSimulcastLayers))!==null&&o!==void 0?o:JS(n,m);let y;if(g.length>0){const C=g[0];g.length>1&&([,y]=g);const x=Math.max(e,t);if(x>=960&&y)return pv(e,t,[C,y,m],h);if(x>=480)return pv(e,t,[C,m],h)}return pv(e,t,[m])}function Tj(n,e,t){var r,i,o,a;if(!t.backupCodec||t.backupCodec===!0||t.backupCodec.codec===t.videoCodec)return;e!==t.backupCodec.codec&&wn.warn("requested a different codec than specified as backup",{serverRequested:e,backup:t.backupCodec.codec}),t.videoCodec=e,t.videoEncoding=t.backupCodec.encoding;const s=n.mediaStreamTrack.getSettings(),l=(r=s.width)!==null&&r!==void 0?r:(i=n.dimensions)===null||i===void 0?void 0:i.width,f=(o=s.height)!==null&&o!==void 0?o:(a=n.dimensions)===null||a===void 0?void 0:a.height;return n.source===Ue.Source.ScreenShare&&t.simulcast&&(t.simulcast=!1),Vy(n.source===Ue.Source.ScreenShare,l,f,t)}function _j(n,e,t,r){const i=Rj(n,e,t);let{encoding:o}=i[0];const a=Math.max(e,t);for(let s=0;s<i.length;s+=1){const l=i[s];if(o=l.encoding,l.width>=a)break}if(r)switch(r){case"av1":case"h265":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.7;break;case"vp9":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.85;break}return o}function Rj(n,e,t){if(n)return Sj;const r=e>t?e/t:t/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?Ij:wj}function JS(n,e){if(n)return Ej(e);const{width:t,height:r}=e,i=t>r?t/r:r/t;return Math.abs(i-16/9)<Math.abs(i-4/3)?Aj:kj}function pv(n,e,t,r){const i=[];if(t.forEach((o,a)=>{if(a>=Gy.length)return;const s=Math.min(n,e),f={rid:Gy[a],scaleResolutionDownBy:Math.max(1,s/Math.min(o.width,o.height)),maxBitrate:o.encoding.maxBitrate},h=r&&o.encoding.maxFramerate?Math.min(r,o.encoding.maxFramerate):o.encoding.maxFramerate;h&&(f.maxFramerate=h);const m=bl()||a===0;o.encoding.priority&&m&&(f.priority=o.encoding.priority,f.networkPriority=o.encoding.priority),i.push(f)}),Ys()&&X_()==="ios"){let o;i.forEach(s=>{o?s.maxFramerate&&s.maxFramerate>o&&(o=s.maxFramerate):o=s.maxFramerate});let a=!0;i.forEach(s=>{var l;s.maxFramerate!=o&&(a&&(a=!1,wn.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),wn.info('Setting framerate of encoding "'.concat((l=s.rid)!==null&&l!==void 0?l:"",'" to ').concat(o)),s.maxFramerate=o)})}return i}function eA(n){if(n)return n.sort((e,t)=>{const{encoding:r}=e,{encoding:i}=t;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class n2{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function Pj(n){return n.source===Ue.Source.ScreenShare||n.constraints.height&&wc(n.constraints.height)>=1080?"maintain-resolution":"balanced"}const Dj=5e3;class vp extends t2{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,Ue.Kind.Video,t,r,i),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>he(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(l){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:l}));return}const a=new Map(o.map(l=>[l.rid,l])),s=o.some(l=>l.qualityLimitationReason==="cpu");if(s!==this.isCpuConstrained&&(this.isCpuConstrained=s,this.isCpuConstrained&&this.emit(ht.CpuConstrained)),this.prevStats){let l=0;a.forEach((f,h)=>{var m;const g=(m=this.prevStats)===null||m===void 0?void 0:m.get(h);l+=zp(f,g)}),this._currentBitrate=l}this.prevStats=a}),this.senderLock=new ao}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!so())return;const r=(t=this.sender)===null||t===void 0?void 0:t.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},a1))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return he(this,void 0,void 0,function*(){var t,r,i,o,a;yield e.pauseUpstream.call(this);try{for(var s=!0,l=Ea(this.simulcastCodecs.values()),f;f=yield l.next(),t=f.done,!t;s=!0)o=f.value,s=!1,yield(a=o.sender)===null||a===void 0?void 0:a.replaceTrack(null)}catch(h){r={error:h}}finally{try{!s&&!t&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return he(this,void 0,void 0,function*(){var t,r,i,o,a;yield e.resumeUpstream.call(this);try{for(var s=!0,l=Ea(this.simulcastCodecs.values()),f;f=yield l.next(),t=f.done,!t;s=!0){o=f.value,s=!1;const h=o;yield(a=h.sender)===null||a===void 0?void 0:a.replaceTrack(h.mediaStreamTrack)}}catch(h){r={error:h}}finally{try{!s&&!t&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return he(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Ue.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return he(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.source===Ue.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){return he(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const t=[],r=yield this.sender.getStats();return r.forEach(i=>{var o;if(i.type==="outbound-rtp"){const a={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,framesPerSecond:i.framesPerSecond,framesSent:i.framesSent,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationDurations:i.qualityLimitationDurations,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges,rid:(o=i.rid)!==null&&o!==void 0?o:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,targetBitrate:i.targetBitrate,timestamp:i.timestamp},s=r.get(i.remoteId);s&&(a.jitter=s.jitter,a.packetsLost=s.packetsLost,a.roundTripTime=s.roundTripTime),t.push(a)}}),t.sort((i,o)=>{var a,s;return((a=o.frameWidth)!==null&&a!==void 0?a:0)-((s=i.frameWidth)!==null&&s!==void 0?s:0)}),t})}setPublishingQuality(e){const t=[];for(let r=To.LOW;r<=To.HIGH;r+=1)t.push(new KC({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(Zs(this.codec),t)}restartTrack(e){return he(this,void 0,void 0,function*(){var t,r,i,o,a;let s;if(e){const m=e1({video:e});typeof m.video!="boolean"&&(s=m.video)}yield this.restart(s),this.isCpuConstrained=!1;try{for(var l=!0,f=Ea(this.simulcastCodecs.values()),h;h=yield f.next(),t=h.done,!t;l=!0){o=h.value,l=!1;const m=o;m.sender&&((a=m.sender.transport)===null||a===void 0?void 0:a.state)!=="closed"&&(m.mediaStreamTrack=this.mediaStreamTrack.clone(),yield m.sender.replaceTrack(m.mediaStreamTrack))}}catch(m){r={error:m}}finally{try{!l&&!t&&(i=f.return)&&(yield i.call(f))}finally{if(r)throw r.error}}})}setProcessor(e){const t=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return he(this,arguments,void 0,function(r){var i=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var a,s,l,f,h,m;if(yield t.setProcessor.call(i,r,o),!((h=i.processor)===null||h===void 0)&&h.processedTrack)try{for(var g=!0,y=Ea(i.simulcastCodecs.values()),C;C=yield y.next(),a=C.done,!a;g=!0)f=C.value,g=!1,yield(m=f.sender)===null||m===void 0?void 0:m.replaceTrack(i.processor.processedTrack)}catch(x){s={error:x}}finally{try{!g&&!a&&(l=y.return)&&(yield l.call(y))}finally{if(s)throw s.error}}}()})}setDegradationPreference(e){return he(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const t=this.sender.getParameters();t.degradationPreference=e,this.sender.setParameters(t)}catch(t){this.log.warn("failed to set degradationPreference",Object.assign({error:t},this.logContext))}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,t){const r=this.simulcastCodecs.get(e);r&&(r.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},Dj))}setPublishingCodecs(e){return he(this,void 0,void 0,function*(){var t,r,i,o,a,s,l;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(Zs(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const f=[];try{for(t=!0,r=Ea(e);i=yield r.next(),o=i.done,!o;t=!0){l=i.value,t=!1;const h=l;if(!this.codec||this.codec===h.codec)yield this.setPublishingLayers(Zs(h.codec),h.qualities);else{const m=this.simulcastCodecs.get(h.codec);if(this.log.debug("try setPublishingCodec for ".concat(h.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:m})),!m||!m.sender){for(const g of h.qualities)if(g.enabled){f.push(h.codec);break}}else m.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(h.codec),this.logContext),yield tA(m.sender,m.encodings,h.qualities,this.senderLock,Zs(h.codec),this.log,this.logContext))}}}catch(h){a={error:h}}finally{try{!t&&!o&&(s=r.return)&&(yield s.call(r))}finally{if(a)throw a.error}}return f})}setPublishingLayers(e,t){return he(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:t}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),!(!this.sender||!this.encodings)&&(yield tA(this.sender,this.encodings,t,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return he(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const t=this.sender.getParameters();t.encodings=t.encodings.map((r,i)=>{var o;return Object.assign(Object.assign({},r),{active:i===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((o=this.mediaStreamTrack.getSettings().height)!==null&&o!==void 0?o:360)/360)),scalabilityMode:i===0&&Zs(this.codec)?"L1T3":void 0,maxFramerate:i===0?15:0,maxBitrate:i===0?r.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:t.encodings})),this.encodings=t.encodings,yield this.sender.setParameters(t)}catch(t){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:t})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return he(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),H_()&&this.isInBackground&&this.source===Ue.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function tA(n,e,t,r,i,o,a){return he(this,void 0,void 0,function*(){const s=yield r.lock();o.debug("setPublishingLayersForSender",Object.assign(Object.assign({},a),{sender:n,qualities:t,senderEncodings:e}));try{const l=n.getParameters(),{encodings:f}=l;if(!f)return;if(f.length!==e.length){o.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},a),{encodings:f,senderEncodings:e}));return}let h=!1;!1&&f[0].scalabilityMode||(i&&t.some(y=>y.enabled)&&t.forEach(y=>y.enabled=!0),f.forEach((g,y)=>{var C;let x=(C=g.rid)!==null&&C!==void 0?C:"";x===""&&(x="q");const w=r2(x),S=t.find(A=>A.quality===w);S&&g.active!==S.enabled&&(h=!0,g.active=S.enabled,o.debug("setting layer ".concat(S.quality," to ").concat(g.active?"enabled":"disabled"),a),bl()&&(S.enabled?(g.scaleResolutionDownBy=e[y].scaleResolutionDownBy,g.maxBitrate=e[y].maxBitrate,g.maxFrameRate=e[y].maxFrameRate):(g.scaleResolutionDownBy=4,g.maxBitrate=10,g.maxFrameRate=2)))})),h&&(l.encodings=f,o.debug("setting encodings",Object.assign(Object.assign({},a),{encodings:l.encodings})),yield n.setParameters(l))}finally{s()}})}function r2(n){switch(n){case"f":return To.HIGH;case"h":return To.MEDIUM;case"q":return To.LOW;default:return To.HIGH}}function nA(n,e,t,r){if(!t)return[new fl({quality:To.HIGH,width:n,height:e,bitrate:0,ssrc:0})];if(r){const i=t[0].scalabilityMode,o=new n2(i),a=[],s=o.suffix=="h"?1.5:2,l=o.suffix=="h"?2:3;for(let f=0;f<o.spatial;f+=1)a.push(new fl({quality:Math.min(To.HIGH,o.spatial-1)-f,width:Math.ceil(n/Math.pow(s,f)),height:Math.ceil(e/Math.pow(s,f)),bitrate:t[0].maxBitrate?Math.ceil(t[0].maxBitrate/Math.pow(l,f)):0,ssrc:0}));return a}return t.map(i=>{var o,a,s;const l=(o=i.scaleResolutionDownBy)!==null&&o!==void 0?o:1;let f=r2((a=i.rid)!==null&&a!==void 0?a:"");return new fl({quality:f,width:Math.ceil(n/l),height:Math.ceil(e/l),bitrate:(s=i.maxBitrate)!==null&&s!==void 0?s:0,ssrc:0})})}const rA="_lossy",iA="_reliable",Mj=2*1e3,gv="leave-reconnect",Nj=3e4;var as;(function(n){n[n.New=0]="New",n[n.Connected=1]="Connected",n[n.Disconnected=2]="Disconnected",n[n.Reconnecting=3]="Reconnecting",n[n.Closed=4]="Closed"})(as||(as={}));class Bj extends ra.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=o1.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=as.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=wn,this.reliableDataSequence=1,this.reliableMessageBuffer=new WS,this.reliableReceivedState=new oj(Nj),this.handleDataChannel=r=>he(this,[r],void 0,function(i){var o=this;let{channel:a}=i;return function*(){if(a){if(a.label===iA)o.reliableDCSub=a;else if(a.label===rA)o.lossyDCSub=a;else return;o.log.debug("on data channel ".concat(a.id,", ").concat(a.label),o.logContext),a.onmessage=o.handleDataMessage}}()}),this.handleDataMessage=r=>he(this,void 0,void 0,function*(){var i,o;const a=yield this.dataProcessLock.lock();try{let s;if(r.data instanceof ArrayBuffer)s=r.data;else if(r.data instanceof Blob)s=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const l=oo.fromBinary(new Uint8Array(s));if(l.sequence>0&&l.participantSid!==""){const f=this.reliableReceivedState.get(l.participantSid);if(f&&l.sequence<=f)return;this.reliableReceivedState.set(l.participantSid,l.sequence)}((i=l.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(yt.ActiveSpeakersUpdate,l.value.value.speakers):(((o=l.value)===null||o===void 0?void 0:o.case)==="user"&&Fj(l,l.value.value),this.emit(yt.DataPacketReceived,l))}finally{a()}}),this.handleDataError=r=>{const o=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:a}=r.error;this.log.error("DataChannel error on ".concat(o,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:a}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const o=r.currentTarget.maxRetransmits===0?bn.LOSSY:bn.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const o=l=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(l,"ms. giving up"),this.logContext),this.emit(yt.Disconnected),this.close()},a=Date.now()-this.reconnectStart;let s=this.getNextRetryDelay({elapsedMs:a,retryCount:this.reconnectAttempts});if(s===null){o(a);return}r===gv&&(s=0),this.log.debug("reconnecting in ".concat(s,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=gi.setTimeout(()=>this.attemptReconnect(i).finally(()=>this.reconnectTimeout=void 0),s)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===as.Connected&&r();const o=()=>{this.off(yt.Disconnected,a),r()},a=()=>{this.off(yt.Restarted,o),i()};this.once(yt.Restarted,o),this.once(yt.Disconnected,a)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(yt.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return r===bn.RELIABLE&&this.reliableMessageBuffer.alignBufferedAmount(i.bufferedAmount),i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===cr.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(au.RR_SIGNAL_DISCONNECTED))},this.log=Ma((t=e.loggerName)!==null&&t!==void 0?t:As.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new n1(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new ao,this.dataProcessLock=new ao,this.dcBufferStatus=new Map([[bn.LOSSY,!0],[bn.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(yt.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(yt.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(yt.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(yt.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(yt.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(yt.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(yt.StreamStateChanged,r),this.client.onRequestResponse=r=>this.emit(yt.SignalRequestResponse,r)}get logContext(){var e,t,r,i,o,a;return{room:(t=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||t===void 0?void 0:t.name,roomID:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,participant:(a=(o=this.latestJoinResponse)===null||o===void 0?void 0:o.participant)===null||a===void 0?void 0:a.identity,pID:this.participantSid}}join(e,t,r,i){return he(this,void 0,void 0,function*(){this.url=e,this.token=t,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(e,t,r,i);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.pcManager||(yield this.configure(o)),(!this.subscriberPrimary||o.fastPublish)&&this.negotiate(),this.clientConfiguration=o.clientConfiguration,this.emit(yt.SignalConnected,o),o}catch(o){if(o instanceof Zn&&o.reason===Tn.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,r,i);throw o}})}close(){return he(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(yt.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return he(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const t=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new WS,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupClient(){return he(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Ta("a track with the same ID has already been published");return new Promise((t,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new Zn("publication of local track timed out, no response from server",Tn.Timeout))},1e4);this.pendingTrackResolvers[e.cid]={resolve:o=>{clearTimeout(i),t(o)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(t){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:t}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return he(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return he(this,void 0,void 0,function*(){var t,r;if(this.pcManager&&this.pcManager.currentState!==Er.NEW)return;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid;const i=this.makeRTCConfiguration(e);this.pcManager=new pj(i,e.subscriberPrimary,this.loggerOptions),this.emit(yt.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(o,a)=>{this.client.sendIceCandidate(o,a)},this.pcManager.onPublisherOffer=(o,a)=>{this.client.sendOffer(o,a)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(o,a,s)=>he(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(o),this.logContext),["closed","disconnected","failed"].includes(a)&&(this.publisherConnectionPromise=void 0),o===Er.CONNECTED){const h=this.pcState===as.New;this.pcState=as.Connected,h&&this.emit(yt.Connected,e)}else o===Er.FAILED&&this.pcState===as.Connected&&(this.pcState=as.Disconnected,this.handleDisconnect("peerconnection failed",s==="failed"?au.RR_SUBSCRIBER_FAILED:au.RR_PUBLISHER_FAILED));const l=this.client.isDisconnected||this.client.currentState===cr.RECONNECTING,f=[Er.FAILED,Er.CLOSING,Er.CLOSED].includes(o);l&&f&&!this._isClosed&&this.emit(yt.Offline)}),this.pcManager.onTrack=o=>{this.emit(yt.MediaTrackAdded,o.track,o.streams[0],o.receiver)},Oj((r=e.serverInfo)===null||r===void 0?void 0:r.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,t)=>he(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e,t))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=(e,t)=>he(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=t,!this.pcManager)return;const r=yield this.pcManager.createSubscriberAnswerFromOffer(e,t);r&&this.client.sendAnswer(r,t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(t=e.track)===null||t===void 0?void 0:t.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(yt.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(yt.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(yt.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(yt.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var t;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(yt.RoomMoved,e)},this.client.onClose=()=>{this.handleDisconnect("signal",au.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case mu.DISCONNECT:this.emit(yt.Disconnected,e==null?void 0:e.reason),this.close();break;case mu.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(gv);break;case mu.RESUME:this.handleDisconnect(gv)}}}makeRTCConfiguration(e){var t;const r=Object.assign({},this.rtcConfig);if(!((t=this.signalOpts)===null||t===void 0)&&t.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(o=>{const a={urls:o.urls};o.username&&(a.username=o.username),o.credential&&(a.credential=o.credential),i.push(a)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===sf.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(rA,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(iA,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,t,r){return he(this,void 0,void 0,function*(){if(Dy())return yield this.createTransceiverRTCRtpSender(e,t,r);if(My())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new $r("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,r,i){return he(this,void 0,void 0,function*(){if(Dy())return this.createSimulcastTransceiverSender(e,t,r,i);if(My())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new $r("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,r){return he(this,void 0,void 0,function*(){if(!this.pcManager)throw new $r("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream),Mc(e)&&(e.codec=t.videoCodec);const o={direction:"sendonly",streams:i};return r&&(o.sendEncodings=r),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,o)).sender})}createSimulcastTransceiverSender(e,t,r,i){return he(this,void 0,void 0,function*(){if(!this.pcManager)throw new $r("publisher is closed");const o={direction:"sendonly"};i&&(o.sendEncodings=i);const a=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,o);if(r.videoCodec)return e.setSimulcastTrackSender(r.videoCodec,a.sender),a.sender})}createRTCRtpSender(e){return he(this,void 0,void 0,function*(){if(!this.pcManager)throw new $r("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return he(this,void 0,void 0,function*(){var t,r,i;if(!this._isClosed){if(this.attemptingReconnect){wn.warn("already attempting reconnect, returning early",this.logContext);return}(((t=this.clientConfiguration)===null||t===void 0?void 0:t.resumeConnection)===sf.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:Er.NEW)===Er.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(o){this.reconnectAttempts+=1;let a=!0;o instanceof $r?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:o})),a=!1):o instanceof cu||(this.fullReconnectOnNext=!0),a?this.handleDisconnect("reconnect",au.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(yt.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(t){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:t}))}return null}restartConnection(e){return he(this,void 0,void 0,function*(){var t,r,i;try{if(!this.url||!this.token)throw new $r("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(yt.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let o;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new cu;o=yield this.join(e??this.url,this.token,this.signalOpts)}catch(a){throw a instanceof Zn&&a.reason===Tn.NotAllowed?new $r("could not reconnect, token might be expired"):new cu}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(yt.SignalRestarted,o),yield this.waitForPCReconnected(),this.client.currentState!==cr.CONNECTED)throw new cu("Signal connection got severed during reconnect");(t=this.regionUrlProvider)===null||t===void 0||t.resetAttempts(),this.emit(yt.Restarted)}catch(o){const a=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(a){yield this.restartConnection(a);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),o}})}resumeConnection(e){return he(this,void 0,void 0,function*(){var t;if(!this.url||!this.token)throw new $r("could not reconnect, url or token not saved");if(!this.pcManager)throw new $r("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(yt.Resuming);let r;try{this.setupSignalClientCallbacks(),r=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(i){let o="";throw i instanceof Error&&(o=i.message,this.log.error(i.message,Object.assign(Object.assign({},this.logContext),{error:i}))),i instanceof Zn&&i.reason===Tn.NotAllowed?new $r("could not reconnect, token might be expired"):i instanceof Zn&&i.reason===Tn.LeaveRequest?i:new cu(o)}if(this.emit(yt.SignalResumed),r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=r.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==cr.CONNECTED)throw new cu("Signal connection got severed during reconnect");this.client.setReconnected(),((t=this.reliableDC)===null||t===void 0?void 0:t.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),r!=null&&r.lastMessageSeq&&this.resendReliableMessagesForResume(r.lastMessageSeq),this.emit(yt.Resumed)})}waitForPCInitialConnection(e,t){return he(this,void 0,void 0,function*(){if(!this.pcManager)throw new $r("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return he(this,void 0,void 0,function*(){this.pcState=as.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield co(Mj),!this.pcManager)throw new $r("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=as.Connected}catch(e){throw this.pcState=as.Disconnected,new Zn("could not establish PC connection, ".concat(e.message),Tn.InternalError)}})}publishRpcResponse(e,t,r,i){return he(this,void 0,void 0,function*(){const o=new oo({destinationIdentities:[e],kind:bn.RELIABLE,value:{case:"rpcResponse",value:new ZT({requestId:t,value:i?{case:"error",value:i.toProto()}:{case:"payload",value:r??""}})}});yield this.sendDataPacket(o,bn.RELIABLE)})}publishRpcAck(e,t){return he(this,void 0,void 0,function*(){const r=new oo({destinationIdentities:[e],kind:bn.RELIABLE,value:{case:"rpcAck",value:new HT({requestId:t})}});yield this.sendDataPacket(r,bn.RELIABLE)})}sendDataPacket(e,t){return he(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(t),t===bn.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const r=e.toBinary(),i=this.dataChannelForKind(t);if(i){if(t===bn.RELIABLE&&this.reliableMessageBuffer.push({data:r,sequence:e.sequence}),this.attemptingReconnect)return;i.send(r)}this.updateAndEmitDCBufferStatus(t)})}resendReliableMessagesForResume(e){return he(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(bn.RELIABLE);const t=this.dataChannelForKind(bn.RELIABLE);t&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(r=>{t.send(r.data)})),this.updateAndEmitDCBufferStatus(bn.RELIABLE)})}waitForBufferStatusLow(e){return new Promise((t,r)=>he(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))t();else{const i=()=>r("Engine closed");for(this.once(yt.Closing,i);!this.dcBufferStatus.get(e);)yield co(10);this.off(yt.Closing,i),t()}}))}ensureDataTransportConnected(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var o;if(!r.pcManager)throw new $r("PC manager is closed");const a=i?r.pcManager.subscriber:r.pcManager.publisher,s=i?"Subscriber":"Publisher";if(!a)throw new Zn("".concat(s," connection not set"),Tn.InternalError);let l=!1;!i&&!r.dataChannelForKind(t,i)&&(r.createDataChannels(),l=!0),!l&&!i&&!r.pcManager.publisher.isICEConnected&&r.pcManager.publisher.getICEConnectionState()!=="checking"&&(l=!0),l&&r.negotiate();const f=r.dataChannelForKind(t,i);if((f==null?void 0:f.readyState)==="open")return;const h=new Date().getTime()+r.peerConnectionTimeout;for(;new Date().getTime()<h;){if(a.isICEConnected&&((o=r.dataChannelForKind(t,i))===null||o===void 0?void 0:o.readyState)==="open")return;yield co(50)}throw new Zn("could not establish ".concat(s," connection, state: ").concat(a.getICEConnectionState()),Tn.InternalError)}()})}ensurePublisherConnected(e){return he(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Er.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return he(this,void 0,void 0,function*(){return new Promise((e,t)=>he(this,void 0,void 0,function*(){if(!this.pcManager){t(new _y("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(yt.Closing,i),this.pcManager.publisher.once(Cu.RTPVideoPayloadTypes,o=>{const a=new Map;o.forEach(s=>{const l=s.codec.toLowerCase();FU(l)&&a.set(s.payload,l)}),this.emit(yt.RTPVideoMapUpdate,a)});try{yield this.pcManager.negotiate(r),e()}catch(o){o instanceof _y&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",au.RR_UNKNOWN),t(o)}finally{this.off(yt.Closing,i)}}))})}dataChannelForKind(e,t){if(t){if(e===bn.LOSSY)return this.lossyDCSub;if(e===bn.RELIABLE)return this.reliableDCSub}else{if(e===bn.LOSSY)return this.lossyDC;if(e===bn.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const o=this.pcManager.subscriber.getLocalDescription(),a=this.pcManager.subscriber.getRemoteDescription(),s=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,l=new Array,f=new Array;e.forEach(h=>{h.isDesired!==s&&l.push(h.trackSid),h.isEnabled||f.push(h.trackSid)}),this.client.sendSyncState(new l_({answer:o?gp({sdp:o.sdp,type:o.type}):void 0,offer:a?gp({sdp:a.sdp,type:a.type}):void 0,subscription:new jp({trackSids:l,subscribe:!s,participantTracks:[]}),publishTracks:ZU(t),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:f,datachannelReceiveStates:this.reliableReceivedState.map((h,m)=>new u_({publisherSid:m,lastSeq:h}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new d_({label:r.label,id:r.id,target:i}))};return t(this.dataChannelForKind(bn.LOSSY),xs.PUBLISHER),t(this.dataChannelForKind(bn.RELIABLE),xs.PUBLISHER),t(this.dataChannelForKind(bn.LOSSY,!0),xs.SUBSCRIBER),t(this.dataChannelForKind(bn.RELIABLE,!0),xs.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&gi.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){so()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){so()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class cu extends Error{}function Oj(n){return n!==void 0&&n>13}function Fj(n,e){const t=n.participantIdentity?n.participantIdentity:e.participantIdentity;n.participantIdentity=t,e.participantIdentity=t;const r=n.destinationIdentities.length!==0?n.destinationIdentities:e.destinationIdentities;n.destinationIdentities=r,e.destinationIdentities=r}class zy{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return By(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return he(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(t.length>0){const r=t[0];return this.attemptedRegions.push(r),wn.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return he(this,void 0,void 0,function*(){const t=yield fetch("".concat(Lj(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(t.ok){const r=yield t.json();return this.lastUpdateAt=Date.now(),r}else throw new Zn("Could not fetch region settings: ".concat(t.statusText),t.status===401?Tn.NotAllowed:Tn.InternalError,t.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}function Lj(n){return"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")}class i2{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(e&&this.bytesReceived<this.totalByteSize)throw new mc("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),bs.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new mc("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),bs.LengthExceeded)}}constructor(e,t,r,i){this.reader=t,this.totalByteSize=r,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=i}}class Uj extends i2{handleChunkReceived(e){var t;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader();let t=new Xs,r=null,i=null;if(this.signal){const a=this.signal;i=()=>{var s;(s=t.reject)===null||s===void 0||s.call(t,a.reason)},a.addEventListener("abort",i),r=a}const o=()=>{e.releaseLock(),r&&i&&r.removeEventListener("abort",i),this.signal=void 0};return{next:()=>he(this,void 0,void 0,function*(){var a,s;try{const{done:l,value:f}=yield Promise.race([e.read(),t.promise,(s=(a=this.outOfBandFailureRejectingFuture)===null||a===void 0?void 0:a.promise)!==null&&s!==void 0?s:new Promise(()=>{})]);return l?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(f),{done:!1,value:f.content})}catch(l){throw o(),l}}),return(){return he(this,void 0,void 0,function*(){return o(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var r,i,o,a;let s=new Set;const l=t.signal?e.withAbortSignal(t.signal):e;try{for(var f=!0,h=Ea(l),m;m=yield h.next(),r=m.done,!r;f=!0){a=m.value,f=!1;const g=a;s.add(g)}}catch(g){i={error:g}}finally{try{!f&&!r&&(o=h.return)&&(yield o.call(h))}finally{if(i)throw i.error}}return Array.from(s)}()})}}class jj extends i2{constructor(e,t,r,i){super(e,t,r,i),this.receivedChunks=new Map}handleChunkReceived(e){var t;const r=H0(e.chunkIndex),i=this.receivedChunks.get(r);if(i&&i.version>e.version)return;this.receivedChunks.set(r,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const o=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,o)}[Symbol.asyncIterator](){const e=this.reader.getReader(),t=new TextDecoder("utf-8",{fatal:!0});let r=new Xs,i=null,o=null;if(this.signal){const s=this.signal;o=()=>{var l;(l=r.reject)===null||l===void 0||l.call(r,s.reason)},s.addEventListener("abort",o),i=s}const a=()=>{e.releaseLock(),i&&o&&i.removeEventListener("abort",o),this.signal=void 0};return{next:()=>he(this,void 0,void 0,function*(){var s,l;try{const{done:f,value:h}=yield Promise.race([e.read(),r.promise,(l=(s=this.outOfBandFailureRejectingFuture)===null||s===void 0?void 0:s.promise)!==null&&l!==void 0?l:new Promise(()=>{})]);if(f)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(h);let m;try{m=t.decode(h.content)}catch(g){throw new mc("Cannot decode datastream chunk ".concat(h.chunkIndex," as text: ").concat(g),bs.DecodeFailed)}return{done:!1,value:m}}}catch(f){throw a(),f}}),return(){return he(this,void 0,void 0,function*(){return a(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var r,i,o,a;let s="";const l=t.signal?e.withAbortSignal(t.signal):e;try{for(var f=!0,h=Ea(l),m;m=yield h.next(),r=m.done,!r;f=!0)a=m.value,f=!1,s+=a}catch(g){i={error:g}}finally{try{!f&&!r&&(o=h.return)&&(yield o.call(h))}finally{if(i)throw i.error}}return s}()})}}class Gj{constructor(){this.log=wn,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,t){if(this.textStreamHandlers.has(e))throw new mc('A text stream handler for topic "'.concat(e,'" has already been set.'),bs.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,t)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,t){if(this.byteStreamHandlers.has(e))throw new mc('A byte stream handler for topic "'.concat(e,'" has already been set.'),bs.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,t)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearHandlersAndControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear(),this.byteStreamHandlers.clear(),this.textStreamHandlers.clear()}validateParticipantHasNoActiveDataStreams(e){var t,r,i,o;const a=Array.from(this.textStreamControllers.entries()).filter(l=>l[1].sendingParticipantIdentity===e),s=Array.from(this.byteStreamControllers.entries()).filter(l=>l[1].sendingParticipantIdentity===e);if(a.length>0||s.length>0){const l=new mc("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),bs.AbnormalEnd);for(const[f,h]of s)(r=(t=h.outOfBandFailureRejectingFuture).reject)===null||r===void 0||r.call(t,l),this.byteStreamControllers.delete(f);for(const[f,h]of a)(o=(i=h.outOfBandFailureRejectingFuture).reject)===null||o===void 0||o.call(i,l),this.textStreamControllers.delete(f)}}handleDataStreamPacket(e){return he(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity);case"streamChunk":return this.handleStreamChunk(e.value.value);case"streamTrailer":return this.handleStreamTrailer(e.value.value);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,t){return he(this,void 0,void 0,function*(){var r;if(e.contentHeader.case==="byteHeader"){const i=this.byteStreamHandlers.get(e.topic);if(!i){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let o;const a=new Xs,s={id:e.streamId,name:(r=e.contentHeader.value.name)!==null&&r!==void 0?r:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:H0(e.timestamp),attributes:e.attributes},l=new ReadableStream({start:f=>{if(o=f,this.textStreamControllers.has(e.streamId))throw new mc("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),bs.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:s,controller:o,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:a})}});i(new Uj(s,l,H0(e.totalLength),a),{identity:t})}else if(e.contentHeader.case==="textHeader"){const i=this.textStreamHandlers.get(e.topic);if(!i){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let o;const a=new Xs,s={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes},l=new ReadableStream({start:f=>{if(o=f,this.textStreamControllers.has(e.streamId))throw new mc("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),bs.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:s,controller:o,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:a})}});i(new jj(s,l,H0(e.totalLength),a),{identity:t})}})}handleStreamChunk(e){const t=this.byteStreamControllers.get(e.streamId);t&&e.content.length>0&&t.controller.enqueue(e);const r=this.textStreamControllers.get(e.streamId);r&&e.content.length>0&&r.controller.enqueue(e)}handleStreamTrailer(e){const t=this.textStreamControllers.get(e.streamId);t&&(t.info.attributes=Object.assign(Object.assign({},t.info.attributes),e.attributes),t.controller.close(),this.textStreamControllers.delete(e.streamId));const r=this.byteStreamControllers.get(e.streamId);r&&(r.info.attributes=Object.assign(Object.assign({},r.info.attributes),e.attributes),r.controller.close(),this.byteStreamControllers.delete(e.streamId))}}class o2{constructor(e,t,r){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=r,this.info=t}write(e){return this.defaultWriter.write(e)}close(){return he(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class Vj extends o2{}class zj extends o2{}const oA=15e3;class Wj{constructor(e,t){this.engine=e,this.log=t}setupEngine(e){this.engine=e}sendText(e,t){return he(this,void 0,void 0,function*(){var r;const i=crypto.randomUUID(),a=new TextEncoder().encode(e).byteLength,s=(r=t==null?void 0:t.attachments)===null||r===void 0?void 0:r.map(()=>crypto.randomUUID()),l=new Array(s?s.length+1:1).fill(0),f=(m,g)=>{var y;l[g]=m;const C=l.reduce((x,w)=>x+w,0);(y=t==null?void 0:t.onProgress)===null||y===void 0||y.call(t,C)},h=yield this.streamText({streamId:i,totalSize:a,destinationIdentities:t==null?void 0:t.destinationIdentities,topic:t==null?void 0:t.topic,attachedStreamIds:s,attributes:t==null?void 0:t.attributes});return yield h.write(e),f(1,0),yield h.close(),t!=null&&t.attachments&&s&&(yield Promise.all(t.attachments.map((m,g)=>he(this,void 0,void 0,function*(){return this._sendFile(s[g],m,{topic:t.topic,mimeType:m.type,onProgress:y=>{f(y,g+1)}})})))),h.info})}streamText(e){return he(this,void 0,void 0,function*(){var t,r;const i=(t=e==null?void 0:e.streamId)!==null&&t!==void 0?t:crypto.randomUUID(),o={id:i,mimeType:"text/plain",timestamp:Date.now(),topic:(r=e==null?void 0:e.topic)!==null&&r!==void 0?r:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes},a=new gy({streamId:i,mimeType:o.mimeType,topic:o.topic,timestamp:tl(o.timestamp),totalLength:tl(e==null?void 0:e.totalSize),attributes:o.attributes,contentHeader:{case:"textHeader",value:new e_({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?py.UPDATE:py.CREATE})}}),s=e==null?void 0:e.destinationIdentities,l=new oo({destinationIdentities:s,value:{case:"streamHeader",value:a}});yield this.engine.sendDataPacket(l,bn.RELIABLE);let f=0;const h=this.engine,m=new WritableStream({write(C){return he(this,void 0,void 0,function*(){for(const x of zU(C,oA)){yield h.waitForBufferStatusLow(bn.RELIABLE);const w=new my({content:x,streamId:i,chunkIndex:tl(f)}),S=new oo({destinationIdentities:s,value:{case:"streamChunk",value:w}});yield h.sendDataPacket(S,bn.RELIABLE),f+=1}})},close(){return he(this,void 0,void 0,function*(){const C=new vy({streamId:i}),x=new oo({destinationIdentities:s,value:{case:"streamTrailer",value:C}});yield h.sendDataPacket(x,bn.RELIABLE)})},abort(C){console.log("Sink error:",C)}});let g=()=>he(this,void 0,void 0,function*(){yield y.close()});h.once(yt.Closing,g);const y=new Vj(m,o,()=>this.engine.off(yt.Closing,g));return y})}sendFile(e,t){return he(this,void 0,void 0,function*(){const r=crypto.randomUUID();return yield this._sendFile(r,e,t),{id:r}})}_sendFile(e,t,r){return he(this,void 0,void 0,function*(){var i;const o=yield this.streamBytes({streamId:e,totalSize:t.size,name:t.name,mimeType:(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:t.type,topic:r==null?void 0:r.topic,destinationIdentities:r==null?void 0:r.destinationIdentities}),a=t.stream().getReader();for(;;){const{done:s,value:l}=yield a.read();if(s)break;yield o.write(l)}return yield o.close(),o.info})}streamBytes(e){return he(this,void 0,void 0,function*(){var t,r,i,o,a;const s=(t=e==null?void 0:e.streamId)!==null&&t!==void 0?t:crypto.randomUUID(),l=e==null?void 0:e.destinationIdentities,f={id:s,mimeType:(r=e==null?void 0:e.mimeType)!==null&&r!==void 0?r:"application/octet-stream",topic:(i=e==null?void 0:e.topic)!==null&&i!==void 0?i:"",timestamp:Date.now(),attributes:e==null?void 0:e.attributes,size:e==null?void 0:e.totalSize,name:(o=e==null?void 0:e.name)!==null&&o!==void 0?o:"unknown"},h=new gy({totalLength:tl((a=f.size)!==null&&a!==void 0?a:0),mimeType:f.mimeType,streamId:s,topic:f.topic,timestamp:tl(Date.now()),attributes:f.attributes,contentHeader:{case:"byteHeader",value:new t_({name:f.name})}}),m=new oo({destinationIdentities:l,value:{case:"streamHeader",value:h}});yield this.engine.sendDataPacket(m,bn.RELIABLE);let g=0;const y=new ao,C=this.engine,x=this.log,w=new WritableStream({write(A){return he(this,void 0,void 0,function*(){const E=yield y.lock();let _=0;try{for(;_<A.byteLength;){const T=A.slice(_,_+oA);yield C.waitForBufferStatusLow(bn.RELIABLE);const M=new oo({destinationIdentities:l,value:{case:"streamChunk",value:new my({content:T,streamId:s,chunkIndex:tl(g)})}});yield C.sendDataPacket(M,bn.RELIABLE),g+=1,_+=T.byteLength}}finally{E()}})},close(){return he(this,void 0,void 0,function*(){const A=new vy({streamId:s}),E=new oo({destinationIdentities:l,value:{case:"streamTrailer",value:A}});yield C.sendDataPacket(E,bn.RELIABLE)})},abort(A){x.error("Sink error:",A)}});return new zj(w,f)})}}class s2 extends Ue{constructor(e,t,r,i,o){super(e,r,o),this.sid=t,this.receiver=i}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ht.Muted:ht.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(ht.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return he(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),a1)),XU()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var t;this.timeSyncHandle=requestAnimationFrame(()=>e());const r=(t=this.receiver)===null||t===void 0?void 0:t.getSynchronizationSources()[0];if(r){const{timestamp:i,rtpTimestamp:o}=r;o&&this.rtpTimestamp!==o&&(this.emit(ht.TimeSyncUpdate,{timestamp:i,rtpTimestamp:o}),this.rtpTimestamp=o)}};e()}}class a2 extends s2{constructor(e,t,r,i,o,a){super(e,t,Ue.Kind.Audio,r,a),this.monitorReceiver=()=>he(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=zp(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var t;for(const r of this.attachedElements)this.audioContext?(t=this.gainNode)===null||t===void 0||t.gain.setTargetAtTime(e,0,.1):r.volume=e;Ys()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Ys())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return he(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(Ny(t))return t.setSinkId(e)}))})}attach(e){const t=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Ny(e)&&e.setSinkId(this.sinkId).catch(r=>{this.log.error("Failed to set sink id on remote audio track",r,this.logContext)}),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(ht.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(ht.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,t;(e=this.gainNode)===null||e===void 0||e.disconnect(),(t=this.sourceNode)===null||t===void 0||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return he(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t;return e.forEach(r=>{r.type==="inbound-rtp"&&(t={type:"audio",streamId:r.id,timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),t})}}const mv=100;class Hj extends s2{constructor(e,t,r,i,o){super(e,t,Ue.Kind.Video,r,o),this.elementInfos=[],this.monitorReceiver=()=>he(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=zp(a,this.prevStats)),this.prevStats=a}),this.debouncedHandleResize=i1(()=>{this.updateDimensions()},mv),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}setStreamState(e){super.setStreamState(e),console.log("setStreamState",e),e===Ue.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?yu(this._mediaStreamTrack,t):du(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(t=>t.element===e)===void 0){const t=new Zj(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(t=>t===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const t=this.elementInfos.filter(r=>r===e);for(const r of t)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const r of t)this.stopObservingElement(r);return t}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return he(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,r="",i=new Map;return e.forEach(o=>{o.type==="inbound-rtp"?(r=o.codecId,t={type:"video",streamId:o.id,framesDecoded:o.framesDecoded,framesDropped:o.framesDropped,framesReceived:o.framesReceived,packetsReceived:o.packetsReceived,packetsLost:o.packetsLost,frameWidth:o.frameWidth,frameHeight:o.frameHeight,pliCount:o.pliCount,firCount:o.firCount,nackCount:o.nackCount,jitter:o.jitter,timestamp:o.timestamp,bytesReceived:o.bytesReceived,decoderImplementation:o.decoderImplementation}):o.type==="codec"&&i.set(o.id,o)}),t&&r!==""&&i.get(r)&&(t.mimeType=i.get(r).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(r=>r.element===e);for(const r of t)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return he(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var t,r;const i=this.elementInfos.reduce((l,f)=>Math.max(l,f.visibilityChangedAt||0),0),o=!((r=(t=this.adaptiveStreamSettings)===null||t===void 0?void 0:t.pauseVideoInBackground)!==null&&r!==void 0)||r?this.isInBackground:!1,a=this.elementInfos.some(l=>l.pictureInPicture),s=this.elementInfos.some(l=>l.visible)&&!o||a;if(!(this.lastVisible===s&&!e)){if(!s&&Date.now()-i<mv){gi.setTimeout(()=>{this.updateVisibility()},mv);return}this.lastVisible=s,this.emit(ht.VisibilityChanged,s,this)}}updateDimensions(){var e,t;let r=0,i=0;const o=this.getPixelDensity();for(const a of this.elementInfos){const s=a.width()*o,l=a.height()*o;s+l>r+i&&(r=s,i=l)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((t=this.lastDimensions)===null||t===void 0?void 0:t.height)===i||(this.lastDimensions={width:r,height:i},this.emit(ht.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return t==="screen"?FS():t||(FS()>2?2:1)}}class Zj{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=r=>{var i;const{target:o,isIntersecting:a}=r;o===this.element&&(this.isIntersecting=a,this.isPiP=Pd(this.element),this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r,i,o;(i=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||i===void 0||i.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Pd(this.element),(o=this.handleVisibilityChanged)===null||o===void 0||o.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=Pd(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=t??Wy(e),this.isPiP=so()&&Pd(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,t,r;this.isIntersecting=Wy(this.element),this.isPiP=Pd(this.element),this.element.handleResize=()=>{var i;(i=this.handleResize)===null||i===void 0||i.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,US().observe(this.element),LS().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(r=(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,t,r,i,o;(e=US())===null||e===void 0||e.unobserve(this.element),(t=LS())===null||t===void 0||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(r=window.documentPictureInPicture)===null||r===void 0||r.removeEventListener("enter",this.onEnterPiP),(o=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||o===void 0||o.removeEventListener("pagehide",this.onLeavePiP)}}function Pd(n){var e,t;return document.pictureInPictureElement===n?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Wy(n,(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window):!1}function Wy(n,e){const t=e||window;let r=n.offsetTop,i=n.offsetLeft;const o=n.offsetWidth,a=n.offsetHeight,{hidden:s}=n,{display:l}=getComputedStyle(n);for(;n.offsetParent;)n=n.offsetParent,r+=n.offsetTop,i+=n.offsetLeft;return r<t.pageYOffset+t.innerHeight&&i<t.pageXOffset+t.innerWidth&&r+a>t.pageYOffset&&i+o>t.pageXOffset&&!s&&l!=="none"}class wa extends ra.EventEmitter{constructor(e,t,r,i){var o;super(),this.metadataMuted=!1,this.encryption=Eo.NONE,this.log=wn,this.handleMuted=()=>{this.emit(ht.Muted)},this.handleUnmuted=()=>{this.emit(ht.Unmuted)},this.log=Ma((o=i==null?void 0:i.loggerName)!==null&&o!==void 0?o:As.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=r,this.source=Ue.Source.Unknown}setTrack(e){this.track&&(this.track.off(ht.Muted,this.handleMuted),this.track.off(ht.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(ht.Muted,this.handleMuted),e.on(ht.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),An(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Eo.NONE}get audioTrack(){if($s(this.track))return this.track}get videoTrack(){if(Mc(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Ue.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Ue.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(n){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(n.SubscriptionStatus||(n.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(n.PermissionStatus||(n.PermissionStatus={}))})(wa||(wa={}));class yp extends wa{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,t,r,i){super(e,t.sid,t.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(ht.Ended)},this.handleCpuConstrained=()=>{this.track&&Mc(this.track)&&this.emit(ht.CpuConstrained,this.track)},this.updateInfo(t),this.setTrack(r)}setTrack(e){this.track&&(this.track.off(ht.Ended,this.handleTrackEnded),this.track.off(ht.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(ht.Ended,this.handleTrackEnded),e.on(ht.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return he(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return he(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return he(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return he(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if($s(this.track)){const t=this.track.getSourceTrackSettings(),r=new Set;return t.autoGainControl&&r.add(si.TF_AUTO_GAIN_CONTROL),t.echoCancellation&&r.add(si.TF_ECHO_CANCELLATION),t.noiseSuppression&&r.add(si.TF_NOISE_SUPPRESSION),t.channelCount&&t.channelCount>1&&r.add(si.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||r.add(si.TF_NO_DTX),this.track.enhancedNoiseCancellation&&r.add(si.TF_ENHANCED_NOISE_CANCELLATION),Array.from(r.values())}else return[]}}function Wp(n,e){return he(this,void 0,void 0,function*(){n??(n={});let t=!1;const{audioProcessor:r,videoProcessor:i,optionsWithoutProcessor:o}=q_(n);let a=o.audio,s=o.video;if(r&&typeof o.audio=="object"&&(o.audio.processor=r),i&&typeof o.video=="object"&&(o.video.processor=i),n.audio&&typeof o.audio=="object"&&typeof o.audio.deviceId=="string"){const m=o.audio.deviceId;o.audio.deviceId={exact:m},t=!0,a=Object.assign(Object.assign({},o.audio),{deviceId:{ideal:m}})}if(o.video&&typeof o.video=="object"&&typeof o.video.deviceId=="string"){const m=o.video.deviceId;o.video.deviceId={exact:m},t=!0,s=Object.assign(Object.assign({},o.video),{deviceId:{ideal:m}})}(o.audio===!0||typeof o.audio=="object"&&!o.audio.deviceId)&&(o.audio={deviceId:"default"}),o.video===!0?o.video={deviceId:"default"}:typeof o.video=="object"&&!o.video.deviceId&&(o.video.deviceId="default");const l=$_(o,Q_,J_),f=e1(l),h=navigator.mediaDevices.getUserMedia(f);o.audio&&(ai.userMediaPromiseMap.set("audioinput",h),h.catch(()=>ai.userMediaPromiseMap.delete("audioinput"))),o.video&&(ai.userMediaPromiseMap.set("videoinput",h),h.catch(()=>ai.userMediaPromiseMap.delete("videoinput")));try{const m=yield h;return yield Promise.all(m.getTracks().map(g=>he(this,void 0,void 0,function*(){const y=g.kind==="audio";let C=y?l.audio:l.video;(typeof C=="boolean"||!C)&&(C={});let x;const w=y?f.audio:f.video;typeof w!="boolean"&&(x=w);const S=g.getSettings().deviceId;x!=null&&x.deviceId&&wc(x.deviceId)!==S?x.deviceId=S:x||(x={deviceId:S});const A=bj(g,x,e);return A.kind===Ue.Kind.Video?A.source=Ue.Source.Camera:A.kind===Ue.Kind.Audio&&(A.source=Ue.Source.Microphone),A.mediaStream=m,$s(A)&&r?yield A.setProcessor(r):Mc(A)&&i&&(yield A.setProcessor(i)),A})))}catch(m){if(!t)throw m;return Wp(Object.assign(Object.assign({},n),{audio:a,video:s}),e)}})}function Xj(n){return he(this,void 0,void 0,function*(){return(yield Wp({audio:!1,video:!0}))[0]})}function $j(n){return he(this,void 0,void 0,function*(){return(yield Wp({audio:!0,video:!1}))[0]})}var Is;(function(n){n.Excellent="excellent",n.Good="good",n.Poor="poor",n.Lost="lost",n.Unknown="unknown"})(Is||(Is={}));function Kj(n){switch(n){case Ud.EXCELLENT:return Is.Excellent;case Ud.GOOD:return Is.Good;case Ud.POOR:return Is.Poor;case Ud.LOST:return Is.Lost;default:return Is.Unknown}}class c2 extends ra.EventEmitter{get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===af.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===gu.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,t,r,i,o,a){let s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:af.STANDARD;var l;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Is.Unknown,this.log=wn,this.log=Ma((l=a==null?void 0:a.loggerName)!==null&&l!==void 0?l:As.Participant),this.loggerOptions=a,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=r,this.metadata=i,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=s,this._attributes=o??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,t]of this.trackPublications)if(t.source===e)return t}getTrackPublicationByName(e){for(const[,t]of this.trackPublications)if(t.trackName===e)return t}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new Xs,this.once(Ze.Active,()=>{var e,t;(t=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||t===void 0||t.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrackPublication(Ue.Source.Camera);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const t=this.getTrackPublication(Ue.Source.Microphone);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(Ue.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var t;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===gu.ACTIVE&&((t=this.participantInfo)===null||t===void 0?void 0:t.state)!==gu.ACTIVE&&this.emit(Ze.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const t=this.metadata!==e,r=this.metadata;this.metadata=e,t&&this.emit(Ze.ParticipantMetadataChanged,r)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(Ze.ParticipantNameChanged,e)}_setAttributes(e){const t=$U(this.attributes,e);this._attributes=e,Object.keys(t).length>0&&this.emit(Ze.AttributesChanged,t)}setPermissions(e){var t,r,i,o,a,s;const l=this.permissions,f=e.canPublish!==((t=this.permissions)===null||t===void 0?void 0:t.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((o=this.permissions)===null||o===void 0?void 0:o.hidden)||e.recorder!==((a=this.permissions)===null||a===void 0?void 0:a.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((h,m)=>{var g;return h!==((g=this.permissions)===null||g===void 0?void 0:g.canPublishSources[m])})||e.canSubscribeMetrics!==((s=this.permissions)===null||s===void 0?void 0:s.canSubscribeMetrics);return this.permissions=e,f&&this.emit(Ze.ParticipantPermissionsChanged,l),f}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Ze.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=Kj(e),t!==this._connectionQuality&&this.emit(Ze.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,t;this.activeFuture&&((t=(e=this.activeFuture).reject)===null||t===void 0||t.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(t=>$s(t.track)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(ht.Muted,()=>{this.emit(Ze.TrackMuted,e)}),e.on(ht.Unmuted,()=>{this.emit(Ze.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case Ue.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case Ue.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function qj(n){var e,t,r;if(!n.participantSid&&!n.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new a_({participantIdentity:(e=n.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(t=n.participantSid)!==null&&t!==void 0?t:"",allTracks:(r=n.allowAll)!==null&&r!==void 0?r:!1,trackSids:n.allowedTrackSids||[]})}class Yj extends c2{constructor(e,t,r,i,o,a){super(e,t,void 0,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Eo.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Xs)},this.handleReconnected=()=>{var s,l;(l=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||l===void 0||l.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var s,l,f,h,m,g;this.reconnectFuture&&(this.reconnectFuture.promise.catch(y=>this.log.warn(y.message,this.logContext)),(l=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||l===void 0||l.call(s,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0),this.signalConnectedFuture&&((h=(f=this.signalConnectedFuture).reject)===null||h===void 0||h.call(f,"Got disconnected without signal connected"),this.signalConnectedFuture=void 0),(g=(m=this.activeAgentFuture)===null||m===void 0?void 0:m.reject)===null||g===void 0||g.call(m,"Got disconnected without active agent present"),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=s=>{var l,f;s.participant&&this.updateInfo(s.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Xs),(f=(l=this.signalConnectedFuture).resolve)===null||f===void 0||f.call(l)},this.handleSignalRequestResponse=s=>{const{requestId:l,reason:f,message:h}=s,m=this.pendingSignalRequests.get(l);m&&(f!==qC.OK&&m.reject(new MS(h,f)),this.pendingSignalRequests.delete(l))},this.handleDataPacket=s=>{switch(s.value.case){case"rpcResponse":let l=s.value.value,f=null,h=null;l.value.case==="payload"?f=l.value.value:l.value.case==="error"&&(h=Rr.fromProto(l.value.value)),this.handleIncomingRpcResponse(l.requestId,f,h);break;case"rpcAck":let m=s.value.value;this.handleIncomingRpcAck(m.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>qj(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,l)=>{if(l===void 0&&(l=!0),!s.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),An(s)));return}this.engine.updateMuteStatus(s.sid,l)},this.onTrackUpstreamPaused=s=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),An(s))),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),An(s))),this.onTrackMuted(s,s.isMuted)},this.onTrackFeatureUpdate=s=>{const l=this.audioTrackPublications.get(s.sid);if(!l){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(s.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(l.trackSid,l.getTrackFeatures())},this.onTrackCpuConstrained=(s,l)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),An(l))),this.emit(Ze.LocalTrackCpuConstrained,s,l)},this.handleSubscribedQualityUpdate=s=>he(this,void 0,void 0,function*(){var l,f,h,m,g;if(!(!((g=this.roomOptions)===null||g===void 0)&&g.dynacast))return;const y=this.videoTrackPublications.get(s.trackSid);if(!y){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}if(!y.videoTrack)return;const C=yield y.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var x=!0,w=Ea(C),S;S=yield w.next(),l=S.done,!l;x=!0){m=S.value,x=!1;const A=m;SU(A)&&(this.log.debug("publish ".concat(A," for ").concat(y.videoTrack.sid),Object.assign(Object.assign({},this.logContext),An(y))),yield this.publishAdditionalCodecForTrack(y.videoTrack,A,y.options))}}catch(A){f={error:A}}finally{try{!x&&!l&&(h=w.return)&&(yield h.call(w))}finally{if(f)throw f.error}}}),this.handleLocalTrackUnpublished=s=>{const l=this.trackPublications.get(s.trackSid);if(!l){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}this.unpublishTrack(l.track)},this.handleTrackEnded=s=>he(this,void 0,void 0,function*(){if(s.source===Ue.Source.ScreenShare||s.source===Ue.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),An(s))),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(ba(s)||cc(s))try{if(so())try{const l=yield navigator==null?void 0:navigator.permissions.query({name:s.source===Ue.Source.Camera?"camera":"microphone"});if(l&&l.state==="denied")throw this.log.warn("user has revoked access to ".concat(s.source),Object.assign(Object.assign({},this.logContext),An(s))),l.onchange=()=>{l.state!=="denied"&&(s.isMuted||s.restartTrack(),l.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}s.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),An(s))),ba(s)?yield s.restartTrack({deviceId:"default"}):yield s.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),An(s))),yield s.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=o,this.roomOutgoingDataStreamManager=a}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Eo.NONE}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setupEngine(e){var t;this.engine=e,this.engine.on(yt.RemoteMute,(r,i)=>{const o=this.trackPublications.get(r);!o||!o.track||(i?o.mute():o.unmute())}),!((t=this.signalConnectedFuture)===null||t===void 0)&&t.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(yt.Connected,this.handleReconnected).on(yt.SignalConnected,this.handleSignalConnected).on(yt.SignalRestarted,this.handleReconnected).on(yt.SignalResumed,this.handleReconnected).on(yt.Restarting,this.handleReconnecting).on(yt.Resuming,this.handleReconnecting).on(yt.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(yt.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(yt.Closing,this.handleClosing).on(yt.SignalRequestResponse,this.handleSignalRequestResponse).on(yt.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return he(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return he(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return he(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return he(this,arguments,void 0,function(t){var r=this;let{metadata:i,name:o,attributes:a}=t;return function*(){return new Promise((s,l)=>he(r,void 0,void 0,function*(){var f,h;try{let m=!1;const g=yield this.engine.client.sendUpdateLocalMetadata((f=i??this.metadata)!==null&&f!==void 0?f:"",(h=o??this.name)!==null&&h!==void 0?h:"",a),y=performance.now();for(this.pendingSignalRequests.set(g,{resolve:s,reject:C=>{l(C),m=!0},values:{name:o,metadata:i,attributes:a}});performance.now()-y<5e3&&!m;){if((!o||this.name===o)&&(!i||this.metadata===i)&&(!a||Object.entries(a).every(C=>{let[x,w]=C;return this.attributes[x]===w||w===""&&!this.attributes[x]}))){this.pendingSignalRequests.delete(g),s();return}yield co(50)}l(new MS("Request to update local metadata timed out","TimeoutError"))}catch(m){m instanceof Error&&l(m)}}))}()})}setCameraEnabled(e,t,r){return this.setTrackEnabled(Ue.Source.Camera,e,t,r)}setMicrophoneEnabled(e,t,r){return this.setTrackEnabled(Ue.Source.Microphone,e,t,r)}setScreenShareEnabled(e,t,r){return this.setTrackEnabled(Ue.Source.ScreenShare,e,t,r)}setPermissions(e){const t=this.permissions,r=super.setPermissions(e);return r&&t&&this.emit(Ze.ParticipantPermissionsChanged,t),r}setE2EEEnabled(e){return he(this,void 0,void 0,function*(){this.encryptionType=e?Eo.GCM:Eo.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,r,i){return he(this,void 0,void 0,function*(){var o,a;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t})),this.republishPromise&&(yield this.republishPromise);let s=this.getTrackPublication(e);if(t)if(s)yield s.unmute();else{let l;if(this.pendingPublishing.has(e)){const f=yield this.waitForPendingPublicationOfSource(e);return f||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield f==null?void 0:f.unmute(),f}this.pendingPublishing.add(e);try{switch(e){case Ue.Source.Camera:l=yield this.createTracks({video:(o=r)!==null&&o!==void 0?o:!0});break;case Ue.Source.Microphone:l=yield this.createTracks({audio:(a=r)!==null&&a!==void 0?a:!0});break;case Ue.Source.ScreenShare:l=yield this.createScreenTracks(Object.assign({},r));break;default:throw new Ta(e)}}catch(f){throw l==null||l.forEach(h=>{h.stop()}),f instanceof Error&&this.emit(Ze.MediaDevicesError,f,Uy(e)),this.pendingPublishing.delete(e),f}for(const f of l){const h=Object.assign(Object.assign({},this.roomOptions.publishDefaults),r);e===Ue.Source.Microphone&&$s(f)&&h.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),f.startPreConnectBuffer())}try{const f=[];for(const m of l)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),An(m))),f.push(this.publishTrack(m,i));[s]=yield Promise.all(f)}catch(f){throw l==null||l.forEach(h=>{h.stop()}),f}finally{this.pendingPublishing.delete(e)}}else if(!(s!=null&&s.track)&&this.pendingPublishing.has(e)&&(s=yield this.waitForPendingPublicationOfSource(e),s||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),s&&s.track)if(e===Ue.Source.ScreenShare){s=yield this.unpublishTrack(s.track);const l=this.getTrackPublication(Ue.Source.ScreenShareAudio);l&&l.track&&this.unpublishTrack(l.track)}else yield s.mute();return s})}enableCameraAndMicrophone(){return he(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Ue.Source.Camera)||this.pendingPublishing.has(Ue.Source.Microphone))){this.pendingPublishing.add(Ue.Source.Camera),this.pendingPublishing.add(Ue.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(t=>this.publishTrack(t)))}finally{this.pendingPublishing.delete(Ue.Source.Camera),this.pendingPublishing.delete(Ue.Source.Microphone)}}})}createTracks(e){return he(this,void 0,void 0,function*(){var t,r;e??(e={});const i=$_(e,(t=this.roomOptions)===null||t===void 0?void 0:t.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults);try{return(yield Wp(i,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(s=>($s(s)&&(this.microphoneError=void 0,s.setAudioContext(this.audioContext),s.source=Ue.Source.Microphone,this.emit(Ze.AudioStreamAcquired)),Mc(s)&&(this.cameraError=void 0,s.source=Ue.Source.Camera),s))}catch(o){throw o instanceof Error&&(e.audio&&(this.microphoneError=o),e.video&&(this.cameraError=o)),o}})}createScreenTracks(e){return he(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new QC("getDisplayMedia not supported");e.resolution===void 0&&!RU()&&(e.resolution=JC.h1080fps30.resolution);const t=HU(e),r=yield navigator.mediaDevices.getDisplayMedia(t),i=r.getVideoTracks();if(i.length===0)throw new Ta("no video track found");const o=new vp(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=Ue.Source.ScreenShare,e.contentHint&&(o.mediaStreamTrack.contentHint=e.contentHint);const a=[o];if(r.getAudioTracks().length>0){this.emit(Ze.AudioStreamAcquired);const s=new mp(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=Ue.Source.ScreenShareAudio,a.push(s)}return a})}publishTrack(e,t){return he(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,t)})}publishOrRepublishTrack(e,t){return he(this,arguments,void 0,function(r,i){var o=this;let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var s,l,f,h;ba(r)&&r.setAudioContext(o.audioContext),yield(s=o.reconnectFuture)===null||s===void 0?void 0:s.promise,o.republishPromise&&!a&&(yield o.republishPromise),hl(r)&&o.pendingPublishPromises.has(r)&&(yield o.pendingPublishPromises.get(r));let m;if(r instanceof MediaStreamTrack)m=r.getConstraints();else{m=r.constraints;let S;switch(r.source){case Ue.Source.Microphone:S="audioinput";break;case Ue.Source.Camera:S="videoinput"}S&&o.activeDeviceMap.has(S)&&(m=Object.assign(Object.assign({},m),{deviceId:o.activeDeviceMap.get(S)}))}if(r instanceof MediaStreamTrack)switch(r.kind){case"audio":r=new mp(r,m,!0,o.audioContext,{loggerName:o.roomOptions.loggerName,loggerContextCb:()=>o.logContext});break;case"video":r=new vp(r,m,!0,{loggerName:o.roomOptions.loggerName,loggerContextCb:()=>o.logContext});break;default:throw new Ta("unsupported MediaStreamTrack kind ".concat(r.kind))}else r.updateLoggerOptions({loggerName:o.roomOptions.loggerName,loggerContextCb:()=>o.logContext});let g;if(o.trackPublications.forEach(S=>{S.track&&S.track===r&&(g=S)}),g)return o.log.warn("track has already been published, skipping",Object.assign(Object.assign({},o.logContext),An(g))),g;const y="channelCount"in r.mediaStreamTrack.getSettings()&&r.mediaStreamTrack.getSettings().channelCount===2||r.mediaStreamTrack.getConstraints().channelCount===2,C=(l=i==null?void 0:i.forceStereo)!==null&&l!==void 0?l:y;C&&(i||(i={}),i.dtx===void 0&&o.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},o.logContext),An(r))),i.red===void 0&&o.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(f=i.dtx)!==null&&f!==void 0||(i.dtx=!1),(h=i.red)!==null&&h!==void 0||(i.red=!1));const x=Object.assign(Object.assign({},o.roomOptions.publishDefaults),i);!DU()&&o.roomOptions.e2ee&&(o.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},o.logContext)),x.simulcast=!1),x.source&&(r.source=x.source);const w=new Promise((S,A)=>he(o,void 0,void 0,function*(){try{if(this.engine.client.currentState!==cr.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:An(r)}));const E=setTimeout(()=>{A(new DS("publishing rejected as engine not connected within timeout",408))},15e3);yield this.waitUntilEngineConnected(),clearTimeout(E);const _=yield this.publish(r,x,C);S(_)}else try{const E=yield this.publish(r,x,C);S(E)}catch(E){A(E)}}catch(E){A(E)}}));o.pendingPublishPromises.set(r,w);try{return yield w}catch(S){throw S}finally{o.pendingPublishPromises.delete(r)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Xs),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),An(e))),!1;const{canPublish:t,canPublishSources:r}=this.permissions;return t&&(r.length===0||r.map(i=>KU(i)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),An(e))),!1)}publish(e,t,r){return he(this,void 0,void 0,function*(){var i,o,a,s,l,f,h,m,g,y;if(!this.hasPermissionsToPublish(e))throw new DS("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(X=>hl(e)&&X.source===e.source)&&e.source!==Ue.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),An(e))),t.stopMicTrackOnMute&&$s(e)&&(e.stopOnMute=!0),e.source===Ue.Source.ScreenShare&&bl()&&(t.simulcast=!1),t.videoCodec==="av1"&&!EU()&&(t.videoCodec=void 0),t.videoCodec==="vp9"&&!TU()&&(t.videoCodec=void 0),t.videoCodec===void 0&&(t.videoCodec=jy),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(X=>t.videoCodec===Hd(X.mime))||(t.videoCodec=Hd(this.enabledPublishVideoCodecs[0].mime)));const x=t.videoCodec;e.on(ht.Muted,this.onTrackMuted),e.on(ht.Unmuted,this.onTrackUnmuted),e.on(ht.Ended,this.handleTrackEnded),e.on(ht.UpstreamPaused,this.onTrackUpstreamPaused),e.on(ht.UpstreamResumed,this.onTrackUpstreamResumed),e.on(ht.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const w=[],S=!(!((i=t.dtx)!==null&&i!==void 0)||i),A=e.getSourceTrackSettings();A.autoGainControl&&w.push(si.TF_AUTO_GAIN_CONTROL),A.echoCancellation&&w.push(si.TF_ECHO_CANCELLATION),A.noiseSuppression&&w.push(si.TF_NOISE_SUPPRESSION),A.channelCount&&A.channelCount>1&&w.push(si.TF_STEREO),S&&w.push(si.TF_NO_DTX),ba(e)&&e.hasPreConnectBuffer&&w.push(si.TF_PRECONNECT_BUFFER);const E=new xy({cid:e.mediaStreamTrack.id,name:t.name,type:Ue.kindToProto(e.kind),muted:e.isMuted,source:Ue.sourceToProto(e.source),disableDtx:S,encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((o=t.red)!==null&&o!==void 0)||o),stream:t==null?void 0:t.stream,backupCodecPolicy:t==null?void 0:t.backupCodecPolicy,audioFeatures:w});let _;if(e.kind===Ue.Kind.Video){let X={width:0,height:0};try{X=yield e.waitForDimensions()}catch{const G=(s=(a=this.roomOptions.videoCaptureDefaults)===null||a===void 0?void 0:a.resolution)!==null&&s!==void 0?s:lf.h720.resolution;X={width:G.width,height:G.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),An(e)),{dims:X}))}E.width=X.width,E.height=X.height,cc(e)&&(Zs(x)&&(e.source===Ue.Source.ScreenShare&&(t.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),An(e))))),t.scalabilityMode=(l=t.scalabilityMode)!==null&&l!==void 0?l:"L3T3_KEY"),E.simulcastCodecs=[new Cy({codec:x,cid:e.mediaStreamTrack.id})],t.backupCodec===!0&&(t.backupCodec={codec:jy}),t.backupCodec&&x!==t.backupCodec.codec&&E.encryption===Eo.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),E.simulcastCodecs.push(new Cy({codec:t.backupCodec.codec,cid:""})))),_=Vy(e.source===Ue.Source.ScreenShare,E.width,E.height,t),E.layers=nA(E.width,E.height,_,Zs(t.videoCodec))}else e.kind===Ue.Kind.Audio&&(_=[{maxBitrate:(f=t.audioPreset)===null||f===void 0?void 0:f.maxBitrate,priority:(m=(h=t.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&m!==void 0?m:"high",networkPriority:(y=(g=t.audioPreset)===null||g===void 0?void 0:g.priority)!==null&&y!==void 0?y:"high"}]);if(!this.engine||this.engine.isClosed)throw new $r("cannot publish track when not connected");const T=()=>he(this,void 0,void 0,function*(){var X,L,G;if(!this.engine.pcManager)throw new $r("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,t,_),this.emit(Ze.LocalSenderCreated,e.sender,e),cc(e)&&((X=t.degradationPreference)!==null&&X!==void 0||(t.degradationPreference=Pj(e)),e.setDegradationPreference(t.degradationPreference)),_)if(bl()&&e.kind===Ue.Kind.Audio){let Z;for(const ne of this.engine.pcManager.publisher.getTransceivers())if(ne.sender===e.sender){Z=ne;break}Z&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:Z,codec:"opus",maxbr:!((L=_[0])===null||L===void 0)&&L.maxBitrate?_[0].maxBitrate/1e3:0})}else e.codec&&Zs(e.codec)&&(!((G=_[0])===null||G===void 0)&&G.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:E.cid,codec:e.codec,maxbr:_[0].maxBitrate/1e3});yield this.engine.negotiate()});let M;const P=new Promise((X,L)=>he(this,void 0,void 0,function*(){var G;try{M=yield this.engine.addTrack(E),X(M)}catch(Z){e.sender&&(!((G=this.engine.pcManager)===null||G===void 0)&&G.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(ne=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),An(e)),{error:ne}))})),L(Z)}}));if(this.enabledPublishVideoCodecs.length>0)M=(yield Promise.all([P,T()]))[0];else{M=yield P;let X;if(M.codecs.forEach(L=>{X===void 0&&(X=L.mimeType)}),X&&e.kind===Ue.Kind.Video){const L=Hd(X);L!==x&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),An(e)),{codec:L})),t.videoCodec=L,_=Vy(e.source===Ue.Source.ScreenShare,E.width,E.height,t))}yield T()}const j=new yp(e.kind,M,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(j.on(ht.CpuConstrained,X=>this.onTrackCpuConstrained(X,j)),j.options=t,e.sid=M.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:_,trackInfo:M})),cc(e)?e.startMonitor(this.engine.client):ba(e)&&e.startMonitor(),this.addTrackPublication(j),this.emit(Ze.LocalTrackPublished,j),ba(e)&&M.audioFeatures.includes(si.TF_PRECONNECT_BUFFER)){const X=e.getPreConnectBuffer(),L=e.getPreConnectBufferMimeType();this.on(Ze.LocalTrackSubscribed,G=>{if(G.trackSid===M.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),An(e))),e.stopPreConnectBuffer()}}),X&&new Promise((Z,ne)=>he(this,void 0,void 0,function*(){var pe,ve,Se,Ne,xe,Ae;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),An(e)));const ae=setTimeout(()=>{ne(new Error("agent not active within 10 seconds"))},1e4),ye=yield this.waitUntilActiveAgentPresent();clearTimeout(ae),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),An(e)));const Ee=yield this.streamBytes({name:"preconnect-buffer",mimeType:L,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[ye.identity],attributes:{trackId:j.trackSid,sampleRate:String((xe=A.sampleRate)!==null&&xe!==void 0?xe:"48000"),channels:String((Ae=A.channelCount)!==null&&Ae!==void 0?Ae:"1")}});try{for(var ke=!0,H=Ea(X),ee;ee=yield H.next(),pe=ee.done,!pe;ke=!0){Ne=ee.value,ke=!1;const _e=Ne;yield Ee.write(_e)}}catch(_e){ve={error:_e}}finally{try{!ke&&!pe&&(Se=H.return)&&(yield Se.call(H))}finally{if(ve)throw ve.error}}yield Ee.close(),Z()}catch(ae){ne(ae)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),An(e)))}).catch(Z=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),An(e)),{error:Z}))})}return j})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,r){return he(this,void 0,void 0,function*(){var i;if(this.encryptionType!==Eo.NONE)return;let o;if(this.trackPublications.forEach(y=>{y.track&&y.track===e&&(o=y)}),!o)throw new Ta("track is not published");if(!cc(e))throw new Ta("track is not a video track");const a=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),s=Tj(e,t,a);if(!s){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),An(e)));return}const l=e.addSimulcastTrack(t,s);if(!l)return;const f=new xy({cid:l.mediaStreamTrack.id,type:Ue.kindToProto(e.kind),muted:e.isMuted,source:Ue.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:a.videoCodec,cid:l.mediaStreamTrack.id}]});if(f.layers=nA(f.width,f.height,s),!this.engine||this.engine.isClosed)throw new $r("cannot publish track when not connected");const h=()=>he(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,l,a,s),yield this.engine.negotiate()}),g=(yield Promise.all([this.engine.addTrack(f),h()]))[0];this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:s,trackInfo:g}))})}unpublishTrack(e,t){return he(this,void 0,void 0,function*(){var r,i;if(hl(e)){const f=this.pendingPublishPromises.get(e);f&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),An(e))),yield f)}const o=this.getPublicationForTrack(e),a=o?An(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),a)),!o||!o.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),a));return}e=o.track,e.off(ht.Muted,this.onTrackMuted),e.off(ht.Unmuted,this.onTrackUnmuted),e.off(ht.Ended,this.handleTrackEnded),e.off(ht.UpstreamPaused,this.onTrackUpstreamPaused),e.off(ht.UpstreamResumed,this.onTrackUpstreamResumed),e.off(ht.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),t===void 0&&(t=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),t?e.stop():e.stopMonitor();let s=!1;const l=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Er.FAILED&&l)try{for(const f of this.engine.pcManager.publisher.getTransceivers())f.sender===l&&(f.direction="inactive",s=!0);if(this.engine.removeTrack(l)&&(s=!0),cc(e)){for(const[,f]of e.simulcastCodecs)f.sender&&(this.engine.removeTrack(f.sender)&&(s=!0),f.sender=void 0);e.simulcastCodecs.clear()}}catch(f){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),a),{error:f}))}switch(this.trackPublications.delete(o.trackSid),o.kind){case Ue.Kind.Audio:this.audioTrackPublications.delete(o.trackSid);break;case Ue.Kind.Video:this.videoTrackPublications.delete(o.trackSid);break}return this.emit(Ze.LocalTrackUnpublished,o),o.setTrack(void 0),s&&(yield this.engine.negotiate()),o})}unpublishTracks(e){return he(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>!!r)})}republishAllTracks(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){r.republishPromise&&(yield r.republishPromise),r.republishPromise=new Promise((o,a)=>he(r,void 0,void 0,function*(){try{const s=[];this.trackPublications.forEach(l=>{l.track&&(t&&(l.options=Object.assign(Object.assign({},l.options),t)),s.push(l))}),yield Promise.all(s.map(l=>he(this,void 0,void 0,function*(){const f=l.track;yield this.unpublishTrack(f,!1),i&&!f.isMuted&&f.source!==Ue.Source.ScreenShare&&f.source!==Ue.Source.ScreenShareAudio&&(ba(f)||cc(f))&&!f.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:l.trackSid})),yield f.restartTrack()),yield this.publishOrRepublishTrack(f,l.options,!0)}))),o()}catch(s){a(s)}finally{this.republishPromise=void 0}})),yield r.republishPromise}()})}publishData(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const o=i.reliable?bn.RELIABLE:bn.LOSSY,a=i.destinationIdentities,s=i.topic,l=new oo({kind:o,value:{case:"user",value:new VT({participantIdentity:r.identity,payload:t,destinationIdentities:a,topic:s})}});yield r.engine.sendDataPacket(l,o)}()})}publishDtmf(e,t){return he(this,void 0,void 0,function*(){const r=new oo({kind:bn.RELIABLE,value:{case:"sipDtmf",value:new zT({code:e,digit:t})}});yield this.engine.sendDataPacket(r,bn.RELIABLE)})}sendChatMessage(e,t){return he(this,void 0,void 0,function*(){const r={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:t==null?void 0:t.attachments},i=new oo({value:{case:"chatMessage",value:new hy(Object.assign(Object.assign({},r),{timestamp:gr.parse(r.timestamp)}))}});return yield this.engine.sendDataPacket(i,bn.RELIABLE),this.emit(Ze.ChatMessage,r),r})}editChatMessage(e,t){return he(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},t),{message:e,editTimestamp:Date.now()}),i=new oo({value:{case:"chatMessage",value:new hy(Object.assign(Object.assign({},r),{timestamp:gr.parse(r.timestamp),editTimestamp:gr.parse(r.editTimestamp)}))}});return yield this.engine.sendDataPacket(i,bn.RELIABLE),this.emit(Ze.ChatMessage,r),r})}sendText(e,t){return he(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,t)})}streamText(e){return he(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,t){return he(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,t)})}streamBytes(e){return he(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){return he(this,arguments,void 0,function(t){var r=this;let{destinationIdentity:i,method:o,payload:a,responseTimeout:s=1e4}=t;return function*(){return new Promise((f,h)=>he(r,void 0,void 0,function*(){var m,g,y,C;if(s1(a)>e2){h(Rr.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((g=(m=this.engine.latestJoinResponse)===null||m===void 0?void 0:m.serverInfo)===null||g===void 0)&&g.version&&ks((C=(y=this.engine.latestJoinResponse)===null||y===void 0?void 0:y.serverInfo)===null||C===void 0?void 0:C.version,"1.8.0")<0){h(Rr.builtIn("UNSUPPORTED_SERVER"));return}const x=crypto.randomUUID();yield this.publishRpcRequest(i,x,o,a,s-2e3);const w=setTimeout(()=>{this.pendingAcks.delete(x),h(Rr.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(x),clearTimeout(S)},2e3);this.pendingAcks.set(x,{resolve:()=>{clearTimeout(w)},participantIdentity:i});const S=setTimeout(()=>{this.pendingResponses.delete(x),h(Rr.builtIn("RESPONSE_TIMEOUT"))},s);this.pendingResponses.set(x,{resolve:(A,E)=>{clearTimeout(S),this.pendingAcks.has(x)&&(console.warn("RPC response received before ack",x),this.pendingAcks.delete(x),clearTimeout(w)),E?h(E):f(A??"")},participantIdentity:i})}))}()})}registerRpcMethod(e,t){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const t=this.pendingAcks.get(e);t?(t.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,t,r){const i=this.pendingResponses.get(e);i?(i.resolve(t,r),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,t,r,i,o){return he(this,void 0,void 0,function*(){const a=new oo({destinationIdentities:[e],kind:bn.RELIABLE,value:{case:"rpcRequest",value:new WT({id:t,method:r,payload:i,responseTimeoutMs:o,version:1})}});yield this.engine.sendDataPacket(a,bn.RELIABLE)})}handleParticipantDisconnected(e){for(const[t,{participantIdentity:r}]of this.pendingAcks)r===e&&this.pendingAcks.delete(t);for(const[t,{participantIdentity:r,resolve:i}]of this.pendingResponses)r===e&&(i(null,Rr.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(t))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(t=>t.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(t=>{var r,i;const o=this.trackPublications.get(t.sid);if(o){const a=o.isMuted||((i=(r=o.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);a!==t.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),An(o)),{mutedOnServer:a})),this.engine.client.sendMuteTrack(t.sid,a))}}),!0):!1}setActiveAgent(e){var t,r,i,o;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(r=(t=this.activeAgentFuture)===null||t===void 0?void 0:t.resolve)===null||r===void 0||r.call(t,e):(o=(i=this.activeAgentFuture)===null||i===void 0?void 0:i.reject)===null||o===void 0||o.call(i,"Agent disconnected"),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Xs),this.activeAgentFuture.promise)}getPublicationForTrack(e){let t;return this.trackPublications.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(ba(i)||cc(i))&&i.mediaStreamTrack===e&&(t=r):e===i&&(t=r))}),t}waitForPendingPublicationOfSource(e){return he(this,void 0,void 0,function*(){const r=Date.now();for(;Date.now()<r+1e4;){const i=Array.from(this.pendingPublishPromises.entries()).find(o=>{let[a]=o;return a.source===e});if(i)return i[1];yield co(20)}})}}class l2 extends wa{constructor(e,t,r,i){super(e,t.sid,t.name,i),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=o=>{this.setTrack(void 0),this.emit(ht.Ended,o)},this.handleVisibilityChange=o=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(o),this.logContext),this.visible=o,this.emitTrackUpdate()},this.handleVideoDimensionsChange=o=>{this.log.debug("adaptivestream video dimensions ".concat(o.width,"x").concat(o.height),this.logContext),this.videoDimensionsAdaptiveStream=o,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new jp({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new $T({participantSid:"",trackSids:[this.trackSid]})]});this.emit(ht.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?wa.SubscriptionStatus.Unsubscribed:super.isSubscribed?wa.SubscriptionStatus.Subscribed:wa.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?wa.PermissionStatus.Allowed:wa.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,r;this.isManualOperationAllowed()&&(((t=this.requestedVideoDimensions)===null||t===void 0?void 0:t.width)===e.width&&((r=this.requestedVideoDimensions)===null||r===void 0?void 0:r.height)===e.height||(lv(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&lv(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:To.HIGH}setTrack(e){const t=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(ht.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(ht.VisibilityChanged,this.handleVisibilityChange),i.off(ht.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(ht.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(ht.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(ht.VisibilityChanged,this.handleVisibilityChange),e.on(ht.Ended,this.handleEnded),this.emit(ht.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(ht.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?ht.Muted:ht.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(ht.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(ht.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return lv(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new n_({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===Ue.Kind.Video){let t=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(t)VS(this.videoDimensionsAdaptiveStream,t)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const r=qU(this.trackInfo,this.requestedMaxQuality);r&&VS(this.videoDimensionsAdaptiveStream,r)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream;t?(e.width=Math.ceil(t.width),e.height=Math.ceil(t.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:To.HIGH})),e.quality=To.HIGH)}this.emit(ht.UpdateSettings,e)}}class Cp extends c2{static fromParticipantInfo(e,t,r){return new Cp(e,t.sid,t.identity,t.name,t.metadata,t.attributes,r,t.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,t,r,i,o,a,s){let l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:af.STANDARD;super(t,r||"",i,o,a,s,l),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(ht.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),An(e)),{settings:t})),this.signalClient.sendUpdateTrackSettings(t)}),e.on(ht.UpdateSubscription,t=>{t.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(t)}),e.on(ht.SubscriptionPermissionChanged,t=>{this.emit(Ze.TrackSubscriptionPermissionChanged,e,t)}),e.on(ht.SubscriptionStatusChanged,t=>{this.emit(Ze.TrackSubscriptionStatusChanged,e,t)}),e.on(ht.Subscribed,t=>{this.emit(Ze.TrackSubscribed,t,e)}),e.on(ht.Unsubscribed,t=>{this.emit(Ze.TrackUnsubscribed,t,e)}),e.on(ht.SubscriptionFailed,t=>{this.emit(Ze.TrackSubscriptionFailed,e.trackSid,t)})}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ue.Source.Microphone;this.volumeMap.set(t,e);const r=this.getTrackPublication(t);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ue.Source.Microphone;const t=this.getTrackPublication(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,r,i,o,a){let s=this.getTrackPublicationBySid(t);if(s||t.startsWith("TR")||this.trackPublications.forEach(h=>{!s&&e.kind===h.kind.toString()&&(s=h)}),!s){if(a===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),this.emit(Ze.TrackSubscriptionFailed,t);return}a===void 0&&(a=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,t,r,i,o,a-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),An(s))),this.emit(Ze.TrackSubscriptionFailed,t);return}const l=e.kind==="video";let f;return l?f=new Hj(e,t,i,o):f=new a2(e,t,i,this.audioContext,this.audioOutput),f.source=s.source,f.isMuted=s.isMuted,f.setMediaStream(r),f.start(),s.setTrack(f),this.volumeMap.has(s.source)&&Fy(f)&&$s(f)&&f.setVolume(this.volumeMap.get(s.source)),s}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,r=new Map;return e.tracks.forEach(i=>{var o,a;let s=this.getTrackPublicationBySid(i.sid);if(s)s.updateInfo(i);else{const l=Ue.kindFromProto(i.type);if(!l)return;s=new l2(l,i,(o=this.signalClient.connectOptions)===null||o===void 0?void 0:o.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(a=this.loggerOptions)===null||a===void 0?void 0:a.loggerName}),s.updateInfo(i),r.set(i.sid,s);const f=Array.from(this.trackPublications.values()).find(h=>h.source===(s==null?void 0:s.source));f&&s.source!==Ue.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(s.source),Object.assign(Object.assign({},this.logContext),{oldTrack:An(f),newTrack:An(s)})),this.addTrackPublication(s)}t.set(i.sid,s)}),this.trackPublications.forEach(i=>{t.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),An(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(Ze.TrackPublished,i)}),!0}unpublishTrack(e,t){const r=this.trackPublications.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.trackPublications.delete(e),r.kind){case Ue.Kind.Audio:this.audioTrackPublications.delete(e);break;case Ue.Kind.Video:this.videoTrackPublications.delete(e);break}t&&this.emit(Ze.TrackUnpublished,r)}setAudioOutput(e){return he(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTrackPublications.forEach(r=>{var i;$s(r.track)&&Fy(r.track)&&t.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}var Pn;(function(n){n.Disconnected="disconnected",n.Connecting="connecting",n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting"})(Pn||(Pn={}));const Qj=4*1e3;class Na extends ra.EventEmitter{constructor(e){var t,r,i,o;if(super(),t=this,this.state=Pn.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=wn,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(a,s,l)=>he(this,void 0,void 0,function*(){var f;if(!_U())throw Ys()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const h=yield this.disconnectLock.lock();if(this.state===Pn.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),h(),Promise.resolve();if(this.connectFuture)return h(),this.connectFuture.promise;this.setAndEmitConnectionState(Pn.Connecting),((f=this.regionUrlProvider)===null||f===void 0?void 0:f.getServerUrl().toString())!==a&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),By(new URL(a))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new zy(a,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().then(y=>{var C;(C=this.regionUrlProvider)===null||C===void 0||C.setServerReportedRegions(y)}).catch(y=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:y}))}));const m=(y,C,x)=>he(this,void 0,void 0,function*(){var w,S;this.abortController&&this.abortController.abort();const A=new AbortController;this.abortController=A,h==null||h();try{yield this.attemptConnection(x??a,s,l,A),this.abortController=void 0,y()}catch(E){if(this.regionUrlProvider&&E instanceof Zn&&E.reason!==Tn.Cancelled&&E.reason!==Tn.NotAllowed){let _=null;try{_=yield this.regionUrlProvider.getNextBestRegionUrl((w=this.abortController)===null||w===void 0?void 0:w.signal)}catch(T){if(T instanceof Zn&&(T.status===401||T.reason===Tn.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),C(T);return}}_&&!(!((S=this.abortController)===null||S===void 0)&&S.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(E.message,". Retrying with another region: ").concat(_),this.logContext),this.recreateEngine(),yield m(y,C,_)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,GS(E)),C(E))}else{let _=ws.UNKNOWN_REASON;E instanceof Zn&&(_=GS(E)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,_),C(E)}}}),g=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Xs((y,C)=>{m(y,C,g)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(a,s,l,f,h,m)=>he(this,void 0,void 0,function*(){var g,y,C;const x=yield l.join(a,s,{autoSubscribe:f.autoSubscribe,adaptiveStream:typeof h.adaptiveStream=="object"?!0:h.adaptiveStream,maxRetries:f.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:f.websocketTimeout},m.signal);let w=x.serverInfo;if(w||(w={version:x.serverVersion,region:x.serverRegion}),this.serverInfo=w,this.log.debug("connected to Livekit Server ".concat(Object.entries(w).map(S=>{let[A,E]=S;return"".concat(A,": ").concat(E)}).join(", ")),{room:(g=x.room)===null||g===void 0?void 0:g.name,roomSid:(y=x.room)===null||y===void 0?void 0:y.sid,identity:(C=x.participant)===null||C===void 0?void 0:C.identity}),!w.version)throw new pU("unknown server version");return w.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),h.dynacast=!1),x}),this.applyJoinResponse=a=>{const s=a.participant;if(this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.localParticipant.setEnabledPublishCodecs(a.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(a.sifTrailer)}catch(l){this.log.error(l instanceof Error?l.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:l}))}this.handleParticipantUpdates([s,...a.otherParticipants]),a.room&&this.handleRoomUpdate(a.room)},this.attemptConnection=(a,s,l,f)=>he(this,void 0,void 0,function*(){var h,m;this.state===Pn.Reconnecting||this.isResuming||!((h=this.engine)===null||h===void 0)&&h.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((m=this.regionUrlProvider)===null||m===void 0)&&m.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},o1),l),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const g=yield this.connectSignal(a,s,this.engine,this.connOptions,this.options,f);this.applyJoinResponse(g),this.setupLocalParticipantEvents(),this.emit(ze.SignalConnected)}catch(g){yield this.engine.close(),this.recreateEngine();const y=new Zn("could not establish signal connection",Tn.ServerUnreachable);throw g instanceof Error&&(y.message="".concat(y.message,": ").concat(g.message)),g instanceof Zn&&(y.reason=g.reason,y.status=g.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:g})),y}if(f.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Zn("Connection attempt aborted",Tn.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,f)}catch(g){throw yield this.engine.close(),this.recreateEngine(),g}so()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),so()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Pn.Connected),this.emit(ze.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return he(t,[...s],void 0,function(){var f=this;let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var m,g,y,C;const x=yield f.disconnectLock.lock();try{if(f.state===Pn.Disconnected){f.log.debug("already disconnected",f.logContext);return}f.log.info("disconnect from room",Object.assign({},f.logContext)),(f.state===Pn.Connecting||f.state===Pn.Reconnecting||f.isResuming)&&(f.log.warn("abort connection attempt",f.logContext),(m=f.abortController)===null||m===void 0||m.abort(),(y=(g=f.connectFuture)===null||g===void 0?void 0:g.reject)===null||y===void 0||y.call(g,new Zn("Client initiated disconnect",Tn.Cancelled)),f.connectFuture=void 0),!((C=f.engine)===null||C===void 0)&&C.client.isDisconnected||(yield f.engine.client.sendLeave()),f.engine&&(yield f.engine.close()),f.handleDisconnect(h,ws.CLIENT_INITIATED),f.engine=void 0}finally{x()}}()})},this.onPageLeave=()=>he(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>he(this,void 0,void 0,function*(){const a=[],s=_o();if(s&&s.os==="iOS"){const l="livekit-dummy-audio-el";let f=document.getElementById(l);if(!f){f=document.createElement("audio"),f.id=l,f.autoplay=!0,f.hidden=!0;const h=cv();h.enabled=!0;const m=new MediaStream([h]);f.srcObject=m,document.addEventListener("visibilitychange",()=>{f&&(f.srcObject=document.hidden?null:m,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(f),this.once(ze.Disconnected,()=>{f==null||f.remove(),f=null})}a.push(f)}this.remoteParticipants.forEach(l=>{l.audioTrackPublications.forEach(f=>{f.track&&f.track.attachedElements.forEach(h=>{a.push(h)})})});try{yield Promise.all([this.acquireAudioContext(),...a.map(l=>(l.muted=!1,l.play()))]),this.handleAudioPlaybackStarted()}catch(l){throw this.handleAudioPlaybackFailed(l),l}}),this.startVideo=()=>he(this,void 0,void 0,function*(){const a=[];for(const s of this.remoteParticipants.values())s.videoTrackPublications.forEach(l=>{var f;(f=l.track)===null||f===void 0||f.attachedElements.forEach(h=>{a.includes(h)||a.push(h)})});yield Promise.all(a.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const a of this.remoteParticipants.values())this.handleParticipantDisconnected(a.identity,a);this.setAndEmitConnectionState(Pn.Reconnecting)&&this.emit(ze.Reconnecting)},this.handleSignalRestarted=a=>he(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(a.serverRegion),Object.assign(Object.assign({},this.logContext),{region:a.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(a);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(s){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:s}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:a.serverRegion}))}catch{return}this.setAndEmitConnectionState(Pn.Connected),this.emit(ze.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=a=>{a.forEach(s=>{var l;if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}s.identity===""&&(s.identity=(l=this.sidToIdentity.get(s.sid))!==null&&l!==void 0?l:"");let f=this.remoteParticipants.get(s.identity);s.state===gu.DISCONNECTED?this.handleParticipantDisconnected(s.identity,f):f=this.getOrCreateParticipant(s.identity,s)})},this.handleActiveSpeakersUpdate=a=>{const s=[],l={};a.forEach(f=>{if(l[f.sid]=!0,f.sid===this.localParticipant.sid)this.localParticipant.audioLevel=f.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const h=this.getRemoteParticipantBySid(f.sid);h&&(h.audioLevel=f.level,h.setIsSpeaking(!0),s.push(h))}}),l[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(f=>{l[f.sid]||(f.audioLevel=0,f.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(ze.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=a=>{const s=new Map;this.activeSpeakers.forEach(f=>{const h=this.remoteParticipants.get(f.identity);h&&h.sid!==f.sid||s.set(f.sid,f)}),a.forEach(f=>{let h=this.getRemoteParticipantBySid(f.sid);f.sid===this.localParticipant.sid&&(h=this.localParticipant),h&&(h.audioLevel=f.level,h.setIsSpeaking(f.active),f.active?s.set(f.sid,h):s.delete(f.sid))});const l=Array.from(s.values());l.sort((f,h)=>h.audioLevel-f.audioLevel),this.activeSpeakers=l,this.emitWhenConnected(ze.ActiveSpeakersChanged,l)},this.handleStreamStateUpdate=a=>{a.streamStates.forEach(s=>{const l=this.getRemoteParticipantBySid(s.participantSid);if(!l)return;const f=l.getTrackPublicationBySid(s.trackSid);if(!f||!f.track)return;const h=Ue.streamStateFromProto(s.state);f.track.setStreamState(h),h!==f.track.streamState&&(l.emit(Ze.TrackStreamStateChanged,f,f.track.streamState),this.emitWhenConnected(ze.TrackStreamStateChanged,f,f.track.streamState,l))})},this.handleSubscriptionPermissionUpdate=a=>{const s=this.getRemoteParticipantBySid(a.participantSid);if(!s)return;const l=s.getTrackPublicationBySid(a.trackSid);l&&l.setAllowed(a.allowed)},this.handleSubscriptionError=a=>{const s=Array.from(this.remoteParticipants.values()).find(f=>f.trackPublications.has(a.trackSid));if(!s)return;const l=s.getTrackPublicationBySid(a.trackSid);l&&l.setSubscriptionError(a.err)},this.handleDataPacket=a=>{const s=this.remoteParticipants.get(a.participantIdentity);if(a.value.case==="user")this.handleUserPacket(s,a.value.value,a.kind);else if(a.value.case==="transcription")this.handleTranscription(s,a.value.value);else if(a.value.case==="sipDtmf")this.handleSipDtmf(s,a.value.value);else if(a.value.case==="chatMessage")this.handleChatMessage(s,a.value.value);else if(a.value.case==="metrics")this.handleMetrics(a.value.value,s);else if(a.value.case==="streamHeader"||a.value.case==="streamChunk"||a.value.case==="streamTrailer")this.handleDataStream(a);else if(a.value.case==="rpcRequest"){const l=a.value.value;this.handleIncomingRpcRequest(a.participantIdentity,l.id,l.method,l.payload,l.responseTimeoutMs,l.version)}},this.handleUserPacket=(a,s,l)=>{this.emit(ze.DataReceived,s.payload,a,l,s.topic),a==null||a.emit(Ze.DataReceived,s.payload,l)},this.handleSipDtmf=(a,s)=>{this.emit(ze.SipDTMFReceived,s,a),a==null||a.emit(Ze.SipDTMFReceived,s)},this.handleTranscription=(a,s)=>{const l=s.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(s.transcribedParticipantIdentity),f=l==null?void 0:l.trackPublications.get(s.trackId),h=UU(s,this.transcriptionReceivedTimes);f==null||f.emit(ht.TranscriptionReceived,h),l==null||l.emit(Ze.TranscriptionReceived,h,f),this.emit(ze.TranscriptionReceived,h,l,f)},this.handleChatMessage=(a,s)=>{const l=jU(s);this.emit(ze.ChatMessage,l,a)},this.handleMetrics=(a,s)=>{this.emit(ze.MetricsReceived,a,s)},this.handleDataStream=a=>{this.incomingDataStreamManager.handleDataStreamPacket(a)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ze.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=a=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:a})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ze.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ze.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ze.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>he(this,void 0,void 0,function*(){var a;((a=_o())===null||a===void 0?void 0:a.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(ze.MediaDevicesChanged)}),this.handleRoomUpdate=a=>{const s=this.roomInfo;this.roomInfo=a,s&&s.metadata!==a.metadata&&this.emitWhenConnected(ze.RoomMetadataChanged,a.metadata),(s==null?void 0:s.activeRecording)!==a.activeRecording&&this.emitWhenConnected(ze.RecordingStatusChanged,a.activeRecording)},this.handleConnectionQualityUpdate=a=>{a.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const l=this.getRemoteParticipantBySid(s.participantSid);l&&l.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=a=>{this.emit(ze.ParticipantMetadataChanged,a,this.localParticipant)},this.onLocalParticipantNameChanged=a=>{this.emit(ze.ParticipantNameChanged,a,this.localParticipant)},this.onLocalAttributesChanged=a=>{this.emit(ze.ParticipantAttributesChanged,a,this.localParticipant)},this.onLocalTrackMuted=a=>{this.emit(ze.TrackMuted,a,this.localParticipant)},this.onLocalTrackUnmuted=a=>{this.emit(ze.TrackUnmuted,a,this.localParticipant)},this.onTrackProcessorUpdate=a=>{var s;(s=a==null?void 0:a.onPublish)===null||s===void 0||s.call(a,this)},this.onLocalTrackPublished=a=>he(this,void 0,void 0,function*(){var s,l,f,h,m,g;(s=a.track)===null||s===void 0||s.on(ht.TrackProcessorUpdate,this.onTrackProcessorUpdate),(l=a.track)===null||l===void 0||l.on(ht.Restarted,this.onLocalTrackRestarted),(m=(h=(f=a.track)===null||f===void 0?void 0:f.getProcessor())===null||h===void 0?void 0:h.onPublish)===null||m===void 0||m.call(h,this),this.emit(ze.LocalTrackPublished,a,this.localParticipant),ba(a.track)&&(yield a.track.checkForSilence())&&this.emit(ze.LocalAudioSilenceDetected,a);const y=yield(g=a.track)===null||g===void 0?void 0:g.getDeviceId(!1),C=Uy(a.source);C&&y&&y!==this.localParticipant.activeDeviceMap.get(C)&&(this.localParticipant.activeDeviceMap.set(C,y),this.emit(ze.ActiveDeviceChanged,C,y))}),this.onLocalTrackUnpublished=a=>{var s,l;(s=a.track)===null||s===void 0||s.off(ht.TrackProcessorUpdate,this.onTrackProcessorUpdate),(l=a.track)===null||l===void 0||l.off(ht.Restarted,this.onLocalTrackRestarted),this.emit(ze.LocalTrackUnpublished,a,this.localParticipant)},this.onLocalTrackRestarted=a=>he(this,void 0,void 0,function*(){const s=yield a.getDeviceId(!1),l=Uy(a.source);l&&s&&s!==this.localParticipant.activeDeviceMap.get(l)&&(this.log.debug("local track restarted, setting ".concat(l," ").concat(s," active"),this.logContext),this.localParticipant.activeDeviceMap.set(l,s),this.emit(ze.ActiveDeviceChanged,l,s))}),this.onLocalConnectionQualityChanged=a=>{this.emit(ze.ConnectionQualityChanged,a,this.localParticipant)},this.onMediaDevicesError=(a,s)=>{this.emit(ze.MediaDevicesError,a,s)},this.onLocalParticipantPermissionsChanged=a=>{this.emit(ze.ParticipantPermissionsChanged,a,this.localParticipant)},this.onLocalChatMessageSent=a=>{this.emit(ze.ChatMessage,a,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},hj),e),this.log=Ma((r=this.options.loggerName)!==null&&r!==void 0?r:As.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},Q_),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},J_),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},fj),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new Gj,this.outgoingDataStreamManager=new Wj(this.engine,this.log),this.disconnectLock=new ao,this.localParticipant=new Yj("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",wc(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",wc(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",wc(this.options.audioOutput.deviceId)).catch(a=>this.log.warn("Could not set audio output: ".concat(a.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),so()){const a=new AbortController;(o=navigator.mediaDevices)===null||o===void 0||o.addEventListener("devicechange",this.handleDeviceChange,{signal:a.signal}),Na.cleanupRegistry&&Na.cleanupRegistry.register(this,()=>{a.abort()})}}registerTextStreamHandler(e,t){return this.incomingDataStreamManager.registerTextStreamHandler(e,t)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,t){return this.incomingDataStreamManager.registerByteStreamHandler(e,t)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,t){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return he(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new YU(this.options.e2ee),this.e2eeManager.on(xc.ParticipantEncryptionStatusChanged,(t,r)=>{VU(r)&&(this.isE2EEEnabled=t),this.emit(ze.ParticipantEncryptionStatusChanged,t,r)}),this.e2eeManager.on(xc.EncryptionError,t=>this.emit(ze.EncryptionError,t)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&t!==void 0?t:!1}getSid(){return he(this,void 0,void 0,function*(){return this.state===Pn.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,t)=>{const r=i=>{i.sid!==""&&(this.engine.off(yt.RoomUpdate,r),e(i.sid))};this.engine.on(yt.RoomUpdate,r),this.once(ze.Disconnected,()=>{this.engine.off(yt.RoomUpdate,r),t("Room disconnected before room server id was available")})})})}get name(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&t!==void 0?t:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&t!==void 0?t:0}get numPublishers(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&t!==void 0?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new Bj(this.options),this.engine.on(yt.ParticipantUpdate,this.handleParticipantUpdates).on(yt.RoomUpdate,this.handleRoomUpdate).on(yt.SpeakersChanged,this.handleSpeakersChanged).on(yt.StreamStateChanged,this.handleStreamStateUpdate).on(yt.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(yt.SubscriptionError,this.handleSubscriptionError).on(yt.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(yt.MediaTrackAdded,(e,t,r)=>{this.onTrackAdded(e,t,r)}).on(yt.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(yt.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(yt.DataPacketReceived,this.handleDataPacket).on(yt.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Pn.SignalReconnecting)&&this.emit(ze.SignalReconnecting)}).on(yt.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Pn.Connected)&&this.emit(ze.Reconnected)}).on(yt.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Pn.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(yt.Restarting,this.handleRestarting).on(yt.SignalRestarted,this.handleSignalRestarted).on(yt.Offline,()=>{this.setAndEmitConnectionState(Pn.Reconnecting)&&this.emit(ze.Reconnecting)}).on(yt.DCBufferStatusChanged,(e,t)=>{this.emit(ze.DCBufferStatusChanged,e,t)}).on(yt.LocalTrackSubscribed,e=>{const t=this.localParticipant.getTrackPublications().find(r=>{let{trackSid:i}=r;return i===e});if(!t){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(Ze.LocalTrackSubscribed,t),this.emitWhenConnected(ze.LocalTrackSubscribed,t,this.localParticipant)}).on(yt.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((t,r)=>{this.handleParticipantDisconnected(r,t)}),this.emit(ze.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return ai.getInstance().getDevices(e,t)}prepareConnection(e,t){return he(this,void 0,void 0,function*(){if(this.state===Pn.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(By(new URL(e))&&t){this.regionUrlProvider=new zy(e,t);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===Pn.Disconnected&&(this.regionUrl=r,yield fetch(Oy(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(Oy(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return he(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new zs({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new zs({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new zs({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new zs({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>he(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new zs({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>he(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new zs({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new zs({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>he(this,void 0,void 0,function*(){const o=this.engine.client.onLeave;o&&o(new Gp({reason:ws.CLIENT_INITIATED,action:mu.RECONNECT}))});break;case"subscriber-bandwidth":if(t===void 0||typeof t!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new zs({scenario:{case:"subscriberBandwidth",value:tl(t)}});break;case"leave-full-reconnect":i=new zs({scenario:{case:"leaveRequestFullReconnect",value:!0}})}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){return he(this,arguments,void 0,function(r,i){var o=this;let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return function*(){var s,l,f,h,m,g,y;let C=!0,x=!1;const w=a?{exact:i}:i;if(r==="audioinput"){x=o.localParticipant.audioTrackPublications.size===0;const S=(s=o.getActiveDevice(r))!==null&&s!==void 0?s:o.options.audioCaptureDefaults.deviceId;o.options.audioCaptureDefaults.deviceId=w;const A=Array.from(o.localParticipant.audioTrackPublications.values()).filter(_=>_.source===Ue.Source.Microphone);try{C=(yield Promise.all(A.map(_=>{var T;return(T=_.audioTrack)===null||T===void 0?void 0:T.setDeviceId(w)}))).every(_=>_===!0)}catch(_){throw o.options.audioCaptureDefaults.deviceId=S,_}const E=A.some(_=>{var T,M;return(M=(T=_.track)===null||T===void 0?void 0:T.isMuted)!==null&&M!==void 0?M:!1});C&&E&&(x=!0)}else if(r==="videoinput"){x=o.localParticipant.videoTrackPublications.size===0;const S=(l=o.getActiveDevice(r))!==null&&l!==void 0?l:o.options.videoCaptureDefaults.deviceId;o.options.videoCaptureDefaults.deviceId=w;const A=Array.from(o.localParticipant.videoTrackPublications.values()).filter(_=>_.source===Ue.Source.Camera);try{C=(yield Promise.all(A.map(_=>{var T;return(T=_.videoTrack)===null||T===void 0?void 0:T.setDeviceId(w)}))).every(_=>_===!0)}catch(_){throw o.options.videoCaptureDefaults.deviceId=S,_}const E=A.some(_=>{var T,M;return(M=(T=_.track)===null||T===void 0?void 0:T.isMuted)!==null&&M!==void 0?M:!1});C&&E&&(x=!0)}else if(r==="audiooutput"){if(x=!0,!Ny()&&!o.options.webAudioMix||o.options.webAudioMix&&o.audioContext&&!("setSinkId"in o.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");o.options.webAudioMix&&(i=(f=yield ai.getInstance().normalizeDeviceId("audiooutput",i))!==null&&f!==void 0?f:""),(h=(y=o.options).audioOutput)!==null&&h!==void 0||(y.audioOutput={});const S=(m=o.getActiveDevice(r))!==null&&m!==void 0?m:o.options.audioOutput.deviceId;o.options.audioOutput.deviceId=i;try{o.options.webAudioMix&&((g=o.audioContext)===null||g===void 0||g.setSinkId(i)),yield Promise.all(Array.from(o.remoteParticipants.values()).map(A=>A.setAudioOutput({deviceId:i})))}catch(A){throw o.options.audioOutput.deviceId=S,A}}return x&&(o.localParticipant.activeDeviceMap.set(r,i),o.emit(ze.ActiveDeviceChanged,r,i)),C}()})}setupLocalParticipantEvents(){this.localParticipant.on(Ze.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Ze.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Ze.AttributesChanged,this.onLocalAttributesChanged).on(Ze.TrackMuted,this.onLocalTrackMuted).on(Ze.TrackUnmuted,this.onLocalTrackUnmuted).on(Ze.LocalTrackPublished,this.onLocalTrackPublished).on(Ze.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Ze.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Ze.MediaDevicesError,this.onMediaDevicesError).on(Ze.AudioStreamAcquired,this.startAudio).on(Ze.ChatMessage,this.onLocalChatMessageSent).on(Ze.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,r){if(this.state===Pn.Connecting||this.state===Pn.Reconnecting){const m=()=>{this.onTrackAdded(e,t,r),g()},g=()=>{this.off(ze.Reconnected,m),this.off(ze.Connected,m),this.off(ze.Disconnected,g)};this.once(ze.Reconnected,m),this.once(ze.Connected,m),this.once(ze.Disconnected,g);return}if(this.state===Pn.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const i=kU(t.id),o=i[0];let a=i[1],s=e.id;if(a&&a.startsWith("TR")&&(s=a),o===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const l=Array.from(this.remoteParticipants.values()).find(m=>m.sid===o);if(!l){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);return}let f;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?f=this.options.adaptiveStream:f={});const h=l.addSubscribedMediaTrack(e,s,t,r,f);h!=null&&h.isEncrypted&&!this.e2eeManager&&this.emit(ze.EncryptionError,new Error("Encrypted ".concat(h.source," track received from participant ").concat(l.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearHandlersAndControllers(),this.state!==Pn.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(i=>{i.trackPublications.forEach(o=>{i.unpublishTrack(o.trackSid)})}),this.localParticipant.trackPublications.forEach(i=>{var o,a,s;i.track&&this.localParticipant.unpublishTrack(i.track,e),e?((o=i.track)===null||o===void 0||o.detach(),(a=i.track)===null||a===void 0||a.stop()):(s=i.track)===null||s===void 0||s.stopMonitor()}),this.localParticipant.off(Ze.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Ze.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Ze.AttributesChanged,this.onLocalAttributesChanged).off(Ze.TrackMuted,this.onLocalTrackMuted).off(Ze.TrackUnmuted,this.onLocalTrackUnmuted).off(Ze.LocalTrackPublished,this.onLocalTrackPublished).off(Ze.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Ze.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Ze.MediaDevicesError,this.onMediaDevicesError).off(Ze.AudioStreamAcquired,this.startAudio).off(Ze.ChatMessage,this.onLocalChatMessageSent).off(Ze.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),so()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Pn.Disconnected),this.emit(ze.Disconnected,t)}}}handleParticipantDisconnected(e,t){var r;this.remoteParticipants.delete(e),t&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),t.trackPublications.forEach(i=>{t.unpublishTrack(i.trackSid,!0)}),this.emit(ze.ParticipantDisconnected,t),t.setDisconnected(),(r=this.localParticipant)===null||r===void 0||r.handleParticipantDisconnected(t.identity))}handleIncomingRpcRequest(e,t,r,i,o,a){return he(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,t),a!==1){yield this.engine.publishRpcResponse(e,t,null,Rr.builtIn("UNSUPPORTED_VERSION"));return}const s=this.rpcHandlers.get(r);if(!s){yield this.engine.publishRpcResponse(e,t,null,Rr.builtIn("UNSUPPORTED_METHOD"));return}let l=null,f=null;try{const h=yield s({requestId:t,callerIdentity:e,payload:i,responseTimeout:o});s1(h)>e2?(l=Rr.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(r))):f=h}catch(h){h instanceof Rr?l=h:(console.warn("Uncaught error returned by RPC handler for ".concat(r,". Returning APPLICATION_ERROR instead."),h),l=Rr.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,t,f,l)})}selectDefaultDevices(){return he(this,void 0,void 0,function*(){var e,t,r;const i=ai.getInstance().previousDevices,o=yield ai.getInstance().getDevices(void 0,!1),a=_o();if((a==null?void 0:a.name)==="Chrome"&&a.os!=="iOS")for(let l of o){const f=i.find(h=>h.deviceId===l.deviceId);f&&f.label!==""&&f.kind===l.kind&&f.label!==l.label&&this.getActiveDevice(l.kind)==="default"&&this.emit(ze.ActiveDeviceChanged,l.kind,l.deviceId)}const s=["audiooutput","audioinput","videoinput"];for(let l of s){const f=WU(l),h=this.localParticipant.getTrackPublication(f);if(h&&(!((e=h.track)===null||e===void 0)&&e.isUserProvided))continue;const m=o.filter(y=>y.kind===l),g=this.getActiveDevice(l);if(g===((t=i.filter(y=>y.kind===l)[0])===null||t===void 0?void 0:t.deviceId)&&m.length>0&&((r=m[0])===null||r===void 0?void 0:r.deviceId)!==g){yield this.switchActiveDevice(l,m[0].deviceId);continue}l==="audioinput"&&!uf()||l==="videoinput"||m.length>0&&!m.find(y=>y.deviceId===this.getActiveDevice(l))&&(l!=="audiooutput"||!uf())&&(yield this.switchActiveDevice(l,m[0].deviceId))}})}acquireAudioContext(){return he(this,void 0,void 0,function*(){var e,t;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=t1())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),co(200)])}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}const r=((t=this.audioContext)===null||t===void 0?void 0:t.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(ze.AudioPlaybackStatusChanged,r))})}createParticipant(e,t){var r;let i;return t?i=Cp.fromParticipantInfo(this.engine.client,t,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):i=new Cp(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),i}getOrCreateParticipant(e,t){if(this.remoteParticipants.has(e)){const i=this.remoteParticipants.get(e);return t&&i.updateInfo(t)&&this.sidToIdentity.set(t.sid,t.identity),i}const r=this.createParticipant(e,t);return this.remoteParticipants.set(e,r),this.sidToIdentity.set(t.sid,t.identity),this.emitWhenConnected(ze.ParticipantConnected,r),r.on(Ze.TrackPublished,i=>{this.emitWhenConnected(ze.TrackPublished,i,r)}).on(Ze.TrackSubscribed,(i,o)=>{i.kind===Ue.Kind.Audio?(i.on(ht.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(ht.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===Ue.Kind.Video&&(i.on(ht.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(ht.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ze.TrackSubscribed,i,o,r)}).on(Ze.TrackUnpublished,i=>{this.emit(ze.TrackUnpublished,i,r)}).on(Ze.TrackUnsubscribed,(i,o)=>{this.emit(ze.TrackUnsubscribed,i,o,r)}).on(Ze.TrackMuted,i=>{this.emitWhenConnected(ze.TrackMuted,i,r)}).on(Ze.TrackUnmuted,i=>{this.emitWhenConnected(ze.TrackUnmuted,i,r)}).on(Ze.ParticipantMetadataChanged,i=>{this.emitWhenConnected(ze.ParticipantMetadataChanged,i,r)}).on(Ze.ParticipantNameChanged,i=>{this.emitWhenConnected(ze.ParticipantNameChanged,i,r)}).on(Ze.AttributesChanged,i=>{this.emitWhenConnected(ze.ParticipantAttributesChanged,i,r)}).on(Ze.ConnectionQualityChanged,i=>{this.emitWhenConnected(ze.ConnectionQualityChanged,i,r)}).on(Ze.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(ze.ParticipantPermissionsChanged,i,r)}).on(Ze.TrackSubscriptionStatusChanged,(i,o)=>{this.emitWhenConnected(ze.TrackSubscriptionStatusChanged,i,o,r)}).on(Ze.TrackSubscriptionFailed,(i,o)=>{this.emit(ze.TrackSubscriptionFailed,i,r,o)}).on(Ze.TrackSubscriptionPermissionChanged,(i,o)=>{this.emitWhenConnected(ze.TrackSubscriptionPermissionChanged,i,o,r)}).on(Ze.Active,()=>{this.emitWhenConnected(ze.ParticipantActive,r),r.kind===af.AGENT&&this.localParticipant.setActiveAgent(r)}),t&&r.updateInfo(t),r}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((r,i)=>(r.push(...i.getTrackPublications()),r),[]),t=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const t of e.videoTrackPublications.values())t.isSubscribed&&GU(t)&&t.emitTrackUpdate()}getRemoteParticipantBySid(e){const t=this.sidToIdentity.get(e);if(t)return this.remoteParticipants.get(t)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=gi.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,ws.STATE_MISMATCH))):e=0},Qj)}clearConnectionReconcile(){this.connectionReconcileInterval&&gi.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(ze.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,r]=e;this.emit(t,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];if(this.state===Pn.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,r]);else if(this.state===Pn.Connected)return this.emit(e,...r);return!1}simulateParticipants(e){return he(this,void 0,void 0,function*(){var t,r;const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Up({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:gr.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Cl({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ze.SignalConnected),this.emit(ze.Connected),this.setAndEmitConnectionState(Pn.Connected),i.video){const a=new yp(Ue.Kind.Video,new uu({source:Ur.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Cs.AUDIO,name:"video-dummy"}),new vp(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:jS(160*((t=o.aspectRatios[0])!==null&&t!==void 0?t:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(a),this.localParticipant.emit(Ze.LocalTrackPublished,a)}if(i.audio){const a=new yp(Ue.Kind.Audio,new uu({source:Ur.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Cs.AUDIO}),new mp(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:cv(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(a),this.localParticipant.emit(Ze.LocalTrackPublished,a)}for(let a=0;a<o.count-1;a+=1){let s=new Cl({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(a),state:gu.ACTIVE,tracks:[],joinedAt:gr.parse(Date.now())});const l=this.getOrCreateParticipant(s.identity,s);if(o.video){const f=jS(160*((r=o.aspectRatios[a%o.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),h=new uu({source:Ur.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Cs.AUDIO});l.addSubscribedMediaTrack(f,h.sid,new MediaStream([f]),new RTCRtpReceiver),s.tracks=[...s.tracks,h]}if(o.audio){const f=cv(),h=new uu({source:Ur.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Cs.AUDIO});l.addSubscribedMediaTrack(f,h.sid,new MediaStream([f]),new RTCRtpReceiver),s.tracks=[...s.tracks,h]}l.updateInfo(s)}})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];if(e!==ze.ActiveSpeakersChanged&&e!==ze.TranscriptionReceived){const o=u2(r).filter(a=>a!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:o}))}return super.emit(e,...r)}}Na.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(n=>{n()});function u2(n){return n.map(e=>{if(e)return Array.isArray(e)?u2(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var ys;(function(n){n[n.IDLE=0]="IDLE",n[n.RUNNING=1]="RUNNING",n[n.SKIPPED=2]="SKIPPED",n[n.SUCCESS=3]="SUCCESS",n[n.FAILED=4]="FAILED"})(ys||(ys={}));class Nc extends ra.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=ys.IDLE,this.logs=[],this.options={},this.url=e,this.token=t,this.name=this.constructor.name,this.room=new Na(r.roomOptions),this.connectOptions=r.connectOptions,this.options=r}run(e){return he(this,void 0,void 0,function*(){if(this.status!==ys.IDLE)throw Error("check is running already");this.setStatus(ys.RUNNING);try{yield this.perform()}catch(t){t instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(t.message):this.appendError(t.message))}return yield this.disconnect(),yield new Promise(t=>setTimeout(t,500)),this.status!==ys.SKIPPED&&this.setStatus(this.isSuccess()?ys.SUCCESS:ys.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return he(this,void 0,void 0,function*(){return this.room.state===Pn.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return he(this,void 0,void 0,function*(){this.room&&this.room.state!==Pn.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(ys.SKIPPED)}switchProtocol(e){return he(this,void 0,void 0,function*(){let t=!1,r=!1;if(this.room.on(ze.Reconnecting,()=>{t=!0}),this.room.once(ze.Reconnected,()=>{r=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(o=>setTimeout(o,1e3)),!t)return;const i=Date.now()+1e4;for(;Date.now()<i;){if(r)return;yield co(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class Jj extends Nc{get description(){return"Cloud regions"}perform(){return he(this,void 0,void 0,function*(){const e=new zy(this.url,this.token);if(!e.isCloud()){this.skip();return}const t=[],r=new Set;for(let o=0;o<3;o++){const a=yield e.getNextBestRegionUrl();if(!a)break;if(r.has(a))continue;r.add(a);const s=yield this.checkCloudRegion(a);this.appendMessage("".concat(s.region," RTT: ").concat(s.rtt,"ms, duration: ").concat(s.duration,"ms")),t.push(s)}t.sort((o,a)=>(o.duration-a.duration)*.5+(o.rtt-a.rtt)*.5);const i=t[0];this.bestStats=i,this.appendMessage("best Cloud region: ".concat(i.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return he(this,void 0,void 0,function*(){var t,r;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const i=(t=this.room.serverInfo)===null||t===void 0?void 0:t.region;if(!i)throw new Error("Region not found");const o=yield this.room.localParticipant.streamText({topic:"test"}),a=1e3,l=1e6/a,f="A".repeat(a),h=Date.now();for(let C=0;C<l;C++)yield o.write(f);yield o.close();const m=Date.now(),g=yield(r=this.room.engine.pcManager)===null||r===void 0?void 0:r.publisher.getStats(),y={region:i,rtt:1e4,duration:m-h};return g==null||g.forEach(C=>{C.type==="candidate-pair"&&C.nominated&&(y.rtt=C.currentRoundTripTime*1e3)}),yield this.disconnect(),y})}}const vv=1e4;class eG extends Nc{get description(){return"Connection via UDP vs TCP"}perform(){return he(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),t=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-t.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-t.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=t):this.appendMessage("best connection quality via udp");const r=this.bestStats;this.appendMessage("upstream bitrate: ".concat((r.bitrateTotal/r.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((r.rttTotal/r.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((r.jitterTotal/r.count*1e3).toFixed(2)," ms")),r.packetsLost>0&&this.appendWarning("packets lost: ".concat((r.packetsLost/r.packetsSent*100).toFixed(2),"%")),r.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((r.qualityLimitationDurations.bandwidth/(vv/1e3)*100).toFixed(2),"%")),r.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((r.qualityLimitationDurations.cpu/(vv/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return he(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const t=document.createElement("canvas");t.width=1280,t.height=720;const r=t.getContext("2d");if(!r)throw new Error("Could not get canvas context");let i=0;const o=()=>{i=(i+1)%360,r.fillStyle="hsl(".concat(i,", 100%, 50%)"),r.fillRect(0,0,t.width,t.height),requestAnimationFrame(o)};o();const s=t.captureStream(30).getVideoTracks()[0],f=(yield this.room.localParticipant.publishTrack(s,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,h={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},m=setInterval(()=>he(this,void 0,void 0,function*(){const g=yield f.getRTCStatsReport();g==null||g.forEach(y=>{y.type==="outbound-rtp"?(h.packetsSent=y.packetsSent,h.qualityLimitationDurations=y.qualityLimitationDurations,h.bitrateTotal+=y.targetBitrate,h.count++):y.type==="remote-inbound-rtp"&&(h.packetsLost=y.packetsLost,h.rttTotal+=y.roundTripTime,h.jitterTotal+=y.jitter)})}),1e3);return yield new Promise(g=>setTimeout(g,vv)),clearInterval(m),s.stop(),t.remove(),yield this.disconnect(),h})}}class tG extends Nc{get description(){return"Can publish audio"}perform(){return he(this,void 0,void 0,function*(){var e;const t=yield this.connect(),r=yield $j();if(yield K_(r,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),t.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const o=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let a=0;if(o.forEach(s=>{s.type==="outbound-rtp"&&(s.kind==="audio"||!s.kind&&s.mediaType==="audio")&&(a=s.packetsSent)}),a===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(a," audio packets"))})}}class nG extends Nc{get description(){return"Can publish video"}perform(){return he(this,void 0,void 0,function*(){var e;const t=yield this.connect(),r=yield Xj();yield this.checkForVideo(r.mediaStreamTrack),t.localParticipant.publishTrack(r),yield new Promise(a=>setTimeout(a,5e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(a=>{a.type==="outbound-rtp"&&(a.kind==="video"||!a.kind&&a.mediaType==="video")&&(o+=a.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," video packets"))})}checkForVideo(e){return he(this,void 0,void 0,function*(){const t=new MediaStream;t.addTrack(e.clone());const r=document.createElement("video");r.srcObject=t,r.muted=!0,yield new Promise(i=>{r.onplay=()=>{setTimeout(()=>{var o,a,s,l;const f=document.createElement("canvas"),h=e.getSettings(),m=(a=(o=h.width)!==null&&o!==void 0?o:r.videoWidth)!==null&&a!==void 0?a:1280,g=(l=(s=h.height)!==null&&s!==void 0?s:r.videoHeight)!==null&&l!==void 0?l:720;f.width=m,f.height=g;const y=f.getContext("2d");y.drawImage(r,0,0);const x=y.getImageData(0,0,f.width,f.height).data;let w=!0;for(let S=0;S<x.length;S+=4)if(x[S]!==0||x[S+1]!==0||x[S+2]!==0){w=!1;break}w?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),i()},1e3)},r.play()}),t.getTracks().forEach(i=>i.stop()),r.remove()})}}class rG extends Nc{get description(){return"Resuming connection after interruption"}perform(){return he(this,void 0,void 0,function*(){var e;const t=yield this.connect();let r=!1,i=!1,o;const a=new Promise(f=>{setTimeout(f,5e3),o=f}),s=()=>{r=!0};t.on(ze.SignalReconnecting,s).on(ze.Reconnecting,s).on(ze.Reconnected,()=>{i=!0,o(!0)}),(e=t.engine.client.ws)===null||e===void 0||e.close();const l=t.engine.client.onClose;if(l&&l(""),yield a,r){if(!i||t.state!==Pn.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class iG extends Nc{get description(){return"Can connect via TURN"}perform(){return he(this,void 0,void 0,function*(){var e,t;const r=new n1,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let o=!1,a=!1,s=!1;for(let l of i.iceServers)for(let f of l.urls)f.startsWith("turn:")?(a=!0,s=!0):f.startsWith("turns:")&&(a=!0,s=!0,o=!0),f.startsWith("stun:")&&(s=!0);s?a&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((t=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||t===void 0)&&t.iceServers||a?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(l=>setTimeout(l,0)))})}}class oG extends Nc{get description(){return"Establishing WebRTC connection"}perform(){return he(this,void 0,void 0,function*(){let e=!1,t=!1;this.room.on(ze.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,o)=>{if(i.candidate){const a=new RTCIceCandidate(i);let s="".concat(a.protocol," ").concat(a.address,":").concat(a.port," ").concat(a.type);a.address&&(sG(a.address)?s+=" (private)":a.protocol==="tcp"&&a.tcpType==="passive"?(e=!0,s+=" (passive)"):a.protocol==="udp"&&(t=!0)),this.appendMessage(s)}r&&r(i,o)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),wn.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),t||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function sG(n){const e=n.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const t=parseInt(e[1],10);if(t>=16&&t<=31)return!0}}return!1}class aG extends Nc{get description(){return"Connecting to signal connection via WebSocket"}perform(){return he(this,void 0,void 0,function*(){var e,t,r;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new n1;const o=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(o.serverVersion,".")),((e=o.serverInfo)===null||e===void 0?void 0:e.edition)===qT.Cloud&&(!((t=o.serverInfo)===null||t===void 0)&&t.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=o.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class mX extends ra.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=t,this.options=r}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:ys.IDLE,name:"",description:""}),e}updateCheck(e,t){this.checkResults.set(e,t),this.emit("checkUpdate",e,t)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==ys.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return he(this,void 0,void 0,function*(){const t=this.getNextCheckId(),r=new e(this.url,this.token,this.options),i=a=>{this.updateCheck(t,a)};r.on("update",i);const o=yield r.run();return r.off("update",i),o})}checkWebsocket(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(aG)})}checkWebRTC(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(oG)})}checkTURN(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(iG)})}checkReconnect(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(rG)})}checkPublishAudio(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(tG)})}checkPublishVideo(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(nG)})}checkConnectionProtocol(){return he(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(eG);if(e.data&&"protocol"in e.data){const t=e.data;this.options.protocol=t.protocol}return e})}checkCloudRegion(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(Jj)})}}function cG(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var t;const r=hl(n)?n.mediaStreamTrack:n,i=r.getSettings();let o={facingMode:(t=e.defaultFacingMode)!==null&&t!==void 0?t:"user",confidence:"low"};if("facingMode"in i){const a=i.facingMode;wn.trace("rawFacingMode",{rawFacingMode:a}),a&&typeof a=="string"&&dG(a)&&(o={facingMode:a,confidence:"high"})}if(["low","medium"].includes(o.confidence)){wn.trace("Try to get facing mode from device label: (".concat(r.label,")"));const a=uG(r.label);a!==void 0&&(o=a)}return o}const sA=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),lG=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function uG(n){var e;const t=n.trim().toLowerCase();if(t!=="")return sA.has(t)?sA.get(t):(e=Array.from(lG.entries()).find(r=>{let[i]=r;return t.includes(i)}))===null||e===void 0?void 0:e[1]}function dG(n){return n===void 0||["user","environment","left","right"].includes(n)}const xp=Math.min,pl=Math.max,bp=Math.round,Bh=Math.floor,Ks=n=>({x:n,y:n}),fG={left:"right",right:"left",bottom:"top",top:"bottom"},hG={start:"end",end:"start"};function aA(n,e,t){return pl(n,xp(e,t))}function Hp(n,e){return typeof n=="function"?n(e):n}function wl(n){return n.split("-")[0]}function Zp(n){return n.split("-")[1]}function d2(n){return n==="x"?"y":"x"}function f2(n){return n==="y"?"height":"width"}function Pu(n){return["top","bottom"].includes(wl(n))?"y":"x"}function h2(n){return d2(Pu(n))}function pG(n,e,t){t===void 0&&(t=!1);const r=Zp(n),i=h2(n),o=f2(i);let a=i==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(a=Ip(a)),[a,Ip(a)]}function gG(n){const e=Ip(n);return[Hy(n),e,Hy(e)]}function Hy(n){return n.replace(/start|end/g,e=>hG[e])}function mG(n,e,t){const r=["left","right"],i=["right","left"],o=["top","bottom"],a=["bottom","top"];switch(n){case"top":case"bottom":return t?e?i:r:e?r:i;case"left":case"right":return e?o:a;default:return[]}}function vG(n,e,t,r){const i=Zp(n);let o=mG(wl(n),t==="start",r);return i&&(o=o.map(a=>a+"-"+i),e&&(o=o.concat(o.map(Hy)))),o}function Ip(n){return n.replace(/left|right|bottom|top/g,e=>fG[e])}function yG(n){return{top:0,right:0,bottom:0,left:0,...n}}function CG(n){return typeof n!="number"?yG(n):{top:n,right:n,bottom:n,left:n}}function wp(n){const{x:e,y:t,width:r,height:i}=n;return{width:r,height:i,top:t,left:e,right:e+r,bottom:t+i,x:e,y:t}}function cA(n,e,t){let{reference:r,floating:i}=n;const o=Pu(e),a=h2(e),s=f2(a),l=wl(e),f=o==="y",h=r.x+r.width/2-i.width/2,m=r.y+r.height/2-i.height/2,g=r[s]/2-i[s]/2;let y;switch(l){case"top":y={x:h,y:r.y-i.height};break;case"bottom":y={x:h,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:m};break;case"left":y={x:r.x-i.width,y:m};break;default:y={x:r.x,y:r.y}}switch(Zp(e)){case"start":y[a]-=g*(t&&f?-1:1);break;case"end":y[a]+=g*(t&&f?-1:1);break}return y}const xG=async(n,e,t)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:a}=t,s=o.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(e));let f=await a.getElementRects({reference:n,floating:e,strategy:i}),{x:h,y:m}=cA(f,r,l),g=r,y={},C=0;for(let x=0;x<s.length;x++){const{name:w,fn:S}=s[x],{x:A,y:E,data:_,reset:T}=await S({x:h,y:m,initialPlacement:r,placement:g,strategy:i,middlewareData:y,rects:f,platform:a,elements:{reference:n,floating:e}});h=A??h,m=E??m,y={...y,[w]:{...y[w],..._}},T&&C<=50&&(C++,typeof T=="object"&&(T.placement&&(g=T.placement),T.rects&&(f=T.rects===!0?await a.getElementRects({reference:n,floating:e,strategy:i}):T.rects),{x:h,y:m}=cA(f,g,l)),x=-1)}return{x:h,y:m,placement:g,strategy:i,middlewareData:y}};async function p2(n,e){var t;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:a,elements:s,strategy:l}=n,{boundary:f="clippingAncestors",rootBoundary:h="viewport",elementContext:m="floating",altBoundary:g=!1,padding:y=0}=Hp(e,n),C=CG(y),x=s[g?m==="floating"?"reference":"floating":m],w=wp(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(x)))==null||t?x:x.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:f,rootBoundary:h,strategy:l})),S=m==="floating"?{x:r,y:i,width:a.floating.width,height:a.floating.height}:a.reference,A=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),E=await(o.isElement==null?void 0:o.isElement(A))?await(o.getScale==null?void 0:o.getScale(A))||{x:1,y:1}:{x:1,y:1},_=wp(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:S,offsetParent:A,strategy:l}):S);return{top:(w.top-_.top+C.top)/E.y,bottom:(_.bottom-w.bottom+C.bottom)/E.y,left:(w.left-_.left+C.left)/E.x,right:(_.right-w.right+C.right)/E.x}}const bG=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:i,middlewareData:o,rects:a,initialPlacement:s,platform:l,elements:f}=e,{mainAxis:h=!0,crossAxis:m=!0,fallbackPlacements:g,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:C="none",flipAlignment:x=!0,...w}=Hp(n,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const S=wl(i),A=Pu(s),E=wl(s)===s,_=await(l.isRTL==null?void 0:l.isRTL(f.floating)),T=g||(E||!x?[Ip(s)]:gG(s)),M=C!=="none";!g&&M&&T.push(...vG(s,x,C,_));const P=[s,...T],j=await p2(e,w),X=[];let L=((r=o.flip)==null?void 0:r.overflows)||[];if(h&&X.push(j[S]),m){const pe=pG(i,a,_);X.push(j[pe[0]],j[pe[1]])}if(L=[...L,{placement:i,overflows:X}],!X.every(pe=>pe<=0)){var G,Z;const pe=(((G=o.flip)==null?void 0:G.index)||0)+1,ve=P[pe];if(ve)return{data:{index:pe,overflows:L},reset:{placement:ve}};let Se=(Z=L.filter(Ne=>Ne.overflows[0]<=0).sort((Ne,xe)=>Ne.overflows[1]-xe.overflows[1])[0])==null?void 0:Z.placement;if(!Se)switch(y){case"bestFit":{var ne;const Ne=(ne=L.filter(xe=>{if(M){const Ae=Pu(xe.placement);return Ae===A||Ae==="y"}return!0}).map(xe=>[xe.placement,xe.overflows.filter(Ae=>Ae>0).reduce((Ae,ke)=>Ae+ke,0)]).sort((xe,Ae)=>xe[1]-Ae[1])[0])==null?void 0:ne[0];Ne&&(Se=Ne);break}case"initialPlacement":Se=s;break}if(i!==Se)return{reset:{placement:Se}}}return{}}}};async function IG(n,e){const{placement:t,platform:r,elements:i}=n,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=wl(t),s=Zp(t),l=Pu(t)==="y",f=["left","top"].includes(a)?-1:1,h=o&&l?-1:1,m=Hp(e,n);let{mainAxis:g,crossAxis:y,alignmentAxis:C}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return s&&typeof C=="number"&&(y=s==="end"?C*-1:C),l?{x:y*h,y:g*f}:{x:g*f,y:y*h}}const wG=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:i,y:o,placement:a,middlewareData:s}=e,l=await IG(e,n);return a===((t=s.offset)==null?void 0:t.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:a}}}}},SG=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:a=!1,limiter:s={fn:w=>{let{x:S,y:A}=w;return{x:S,y:A}}},...l}=Hp(n,e),f={x:t,y:r},h=await p2(e,l),m=Pu(wl(i)),g=d2(m);let y=f[g],C=f[m];if(o){const w=g==="y"?"top":"left",S=g==="y"?"bottom":"right",A=y+h[w],E=y-h[S];y=aA(A,y,E)}if(a){const w=m==="y"?"top":"left",S=m==="y"?"bottom":"right",A=C+h[w],E=C-h[S];C=aA(A,C,E)}const x=s.fn({...e,[g]:y,[m]:C});return{...x,data:{x:x.x-t,y:x.y-r,enabled:{[g]:o,[m]:a}}}}}};function Xp(){return typeof window<"u"}function Gu(n){return g2(n)?(n.nodeName||"").toLowerCase():"#document"}function Ro(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function ia(n){var e;return(e=(g2(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function g2(n){return Xp()?n instanceof Node||n instanceof Ro(n).Node:!1}function Es(n){return Xp()?n instanceof Element||n instanceof Ro(n).Element:!1}function Qs(n){return Xp()?n instanceof HTMLElement||n instanceof Ro(n).HTMLElement:!1}function lA(n){return!Xp()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Ro(n).ShadowRoot}function Tf(n){const{overflow:e,overflowX:t,overflowY:r,display:i}=Ts(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(i)}function AG(n){return["table","td","th"].includes(Gu(n))}function $p(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function l1(n){const e=u1(),t=Es(n)?Ts(n):n;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function kG(n){let e=kc(n);for(;Qs(e)&&!Du(e);){if(l1(e))return e;if($p(e))return null;e=kc(e)}return null}function u1(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Du(n){return["html","body","#document"].includes(Gu(n))}function Ts(n){return Ro(n).getComputedStyle(n)}function Kp(n){return Es(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function kc(n){if(Gu(n)==="html")return n;const e=n.assignedSlot||n.parentNode||lA(n)&&n.host||ia(n);return lA(e)?e.host:e}function m2(n){const e=kc(n);return Du(e)?n.ownerDocument?n.ownerDocument.body:n.body:Qs(e)&&Tf(e)?e:m2(e)}function df(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=m2(n),o=i===((r=n.ownerDocument)==null?void 0:r.body),a=Ro(i);if(o){const s=Zy(a);return e.concat(a,a.visualViewport||[],Tf(i)?i:[],s&&t?df(s):[])}return e.concat(i,df(i,[],t))}function Zy(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function v2(n){const e=Ts(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Qs(n),o=i?n.offsetWidth:t,a=i?n.offsetHeight:r,s=bp(t)!==o||bp(r)!==a;return s&&(t=o,r=a),{width:t,height:r,$:s}}function d1(n){return Es(n)?n:n.contextElement}function xu(n){const e=d1(n);if(!Qs(e))return Ks(1);const t=e.getBoundingClientRect(),{width:r,height:i,$:o}=v2(e);let a=(o?bp(t.width):t.width)/r,s=(o?bp(t.height):t.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}const EG=Ks(0);function y2(n){const e=Ro(n);return!u1()||!e.visualViewport?EG:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function TG(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Ro(n)?!1:e}function Sl(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=n.getBoundingClientRect(),o=d1(n);let a=Ks(1);e&&(r?Es(r)&&(a=xu(r)):a=xu(n));const s=TG(o,t,r)?y2(o):Ks(0);let l=(i.left+s.x)/a.x,f=(i.top+s.y)/a.y,h=i.width/a.x,m=i.height/a.y;if(o){const g=Ro(o),y=r&&Es(r)?Ro(r):r;let C=g,x=Zy(C);for(;x&&r&&y!==C;){const w=xu(x),S=x.getBoundingClientRect(),A=Ts(x),E=S.left+(x.clientLeft+parseFloat(A.paddingLeft))*w.x,_=S.top+(x.clientTop+parseFloat(A.paddingTop))*w.y;l*=w.x,f*=w.y,h*=w.x,m*=w.y,l+=E,f+=_,C=Ro(x),x=Zy(C)}}return wp({width:h,height:m,x:l,y:f})}function f1(n,e){const t=Kp(n).scrollLeft;return e?e.left+t:Sl(ia(n)).left+t}function C2(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),i=r.left+e.scrollLeft-(t?0:f1(n,r)),o=r.top+e.scrollTop;return{x:i,y:o}}function _G(n){let{elements:e,rect:t,offsetParent:r,strategy:i}=n;const o=i==="fixed",a=ia(r),s=e?$p(e.floating):!1;if(r===a||s&&o)return t;let l={scrollLeft:0,scrollTop:0},f=Ks(1);const h=Ks(0),m=Qs(r);if((m||!m&&!o)&&((Gu(r)!=="body"||Tf(a))&&(l=Kp(r)),Qs(r))){const y=Sl(r);f=xu(r),h.x=y.x+r.clientLeft,h.y=y.y+r.clientTop}const g=a&&!m&&!o?C2(a,l,!0):Ks(0);return{width:t.width*f.x,height:t.height*f.y,x:t.x*f.x-l.scrollLeft*f.x+h.x+g.x,y:t.y*f.y-l.scrollTop*f.y+h.y+g.y}}function RG(n){return Array.from(n.getClientRects())}function PG(n){const e=ia(n),t=Kp(n),r=n.ownerDocument.body,i=pl(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=pl(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-t.scrollLeft+f1(n);const s=-t.scrollTop;return Ts(r).direction==="rtl"&&(a+=pl(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:a,y:s}}function DG(n,e){const t=Ro(n),r=ia(n),i=t.visualViewport;let o=r.clientWidth,a=r.clientHeight,s=0,l=0;if(i){o=i.width,a=i.height;const f=u1();(!f||f&&e==="fixed")&&(s=i.offsetLeft,l=i.offsetTop)}return{width:o,height:a,x:s,y:l}}function MG(n,e){const t=Sl(n,!0,e==="fixed"),r=t.top+n.clientTop,i=t.left+n.clientLeft,o=Qs(n)?xu(n):Ks(1),a=n.clientWidth*o.x,s=n.clientHeight*o.y,l=i*o.x,f=r*o.y;return{width:a,height:s,x:l,y:f}}function uA(n,e,t){let r;if(e==="viewport")r=DG(n,t);else if(e==="document")r=PG(ia(n));else if(Es(e))r=MG(e,t);else{const i=y2(n);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return wp(r)}function x2(n,e){const t=kc(n);return t===e||!Es(t)||Du(t)?!1:Ts(t).position==="fixed"||x2(t,e)}function NG(n,e){const t=e.get(n);if(t)return t;let r=df(n,[],!1).filter(s=>Es(s)&&Gu(s)!=="body"),i=null;const o=Ts(n).position==="fixed";let a=o?kc(n):n;for(;Es(a)&&!Du(a);){const s=Ts(a),l=l1(a);!l&&s.position==="fixed"&&(i=null),(o?!l&&!i:!l&&s.position==="static"&&i&&["absolute","fixed"].includes(i.position)||Tf(a)&&!l&&x2(n,a))?r=r.filter(f=>f!==a):i=s,a=kc(a)}return e.set(n,r),r}function BG(n){let{element:e,boundary:t,rootBoundary:r,strategy:i}=n;const o=[...t==="clippingAncestors"?$p(e)?[]:NG(e,this._c):[].concat(t),r],a=o[0],s=o.reduce((l,f)=>{const h=uA(e,f,i);return l.top=pl(h.top,l.top),l.right=xp(h.right,l.right),l.bottom=xp(h.bottom,l.bottom),l.left=pl(h.left,l.left),l},uA(e,a,i));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function OG(n){const{width:e,height:t}=v2(n);return{width:e,height:t}}function FG(n,e,t){const r=Qs(e),i=ia(e),o=t==="fixed",a=Sl(n,!0,o,e);let s={scrollLeft:0,scrollTop:0};const l=Ks(0);if(r||!r&&!o)if((Gu(e)!=="body"||Tf(i))&&(s=Kp(e)),r){const g=Sl(e,!0,o,e);l.x=g.x+e.clientLeft,l.y=g.y+e.clientTop}else i&&(l.x=f1(i));const f=i&&!r&&!o?C2(i,s):Ks(0),h=a.left+s.scrollLeft-l.x-f.x,m=a.top+s.scrollTop-l.y-f.y;return{x:h,y:m,width:a.width,height:a.height}}function yv(n){return Ts(n).position==="static"}function dA(n,e){if(!Qs(n)||Ts(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return ia(n)===t&&(t=t.ownerDocument.body),t}function b2(n,e){const t=Ro(n);if($p(n))return t;if(!Qs(n)){let i=kc(n);for(;i&&!Du(i);){if(Es(i)&&!yv(i))return i;i=kc(i)}return t}let r=dA(n,e);for(;r&&AG(r)&&yv(r);)r=dA(r,e);return r&&Du(r)&&yv(r)&&!l1(r)?t:r||kG(n)||t}const LG=async function(n){const e=this.getOffsetParent||b2,t=this.getDimensions,r=await t(n.floating);return{reference:FG(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function UG(n){return Ts(n).direction==="rtl"}const jG={convertOffsetParentRelativeRectToViewportRelativeRect:_G,getDocumentElement:ia,getClippingRect:BG,getOffsetParent:b2,getElementRects:LG,getClientRects:RG,getDimensions:OG,getScale:xu,isElement:Es,isRTL:UG};function I2(n,e){return n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height}function GG(n,e){let t=null,r;const i=ia(n);function o(){var s;clearTimeout(r),(s=t)==null||s.disconnect(),t=null}function a(s,l){s===void 0&&(s=!1),l===void 0&&(l=1),o();const f=n.getBoundingClientRect(),{left:h,top:m,width:g,height:y}=f;if(s||e(),!g||!y)return;const C=Bh(m),x=Bh(i.clientWidth-(h+g)),w=Bh(i.clientHeight-(m+y)),S=Bh(h),A={rootMargin:-C+"px "+-x+"px "+-w+"px "+-S+"px",threshold:pl(0,xp(1,l))||1};let E=!0;function _(T){const M=T[0].intersectionRatio;if(M!==l){if(!E)return a();M?a(!1,M):r=setTimeout(()=>{a(!1,1e-7)},1e3)}M===1&&!I2(f,n.getBoundingClientRect())&&a(),E=!1}try{t=new IntersectionObserver(_,{...A,root:i.ownerDocument})}catch{t=new IntersectionObserver(_,A)}t.observe(n)}return a(!0),o}function VG(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,f=d1(n),h=i||o?[...f?df(f):[],...df(e)]:[];h.forEach(S=>{i&&S.addEventListener("scroll",t,{passive:!0}),o&&S.addEventListener("resize",t)});const m=f&&s?GG(f,t):null;let g=-1,y=null;a&&(y=new ResizeObserver(S=>{let[A]=S;A&&A.target===f&&y&&(y.unobserve(e),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var E;(E=y)==null||E.observe(e)})),t()}),f&&!l&&y.observe(f),y.observe(e));let C,x=l?Sl(n):null;l&&w();function w(){const S=Sl(n);x&&!I2(x,S)&&t(),x=S,C=requestAnimationFrame(w)}return t(),()=>{var S;h.forEach(A=>{i&&A.removeEventListener("scroll",t),o&&A.removeEventListener("resize",t)}),m==null||m(),(S=y)==null||S.disconnect(),y=null,l&&cancelAnimationFrame(C)}}const zG=wG,WG=SG,HG=bG,ZG=(n,e,t)=>{const r=new Map,i={platform:jG,...t},o={...i.platform,_c:r};return xG(n,e,{...i,platform:o})};var Oh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function XG(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Xy={exports:{}},$G=Xy.exports,fA;function KG(){return fA||(fA=1,function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})($G,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},a=null;function s(x,w){var S=x[w];if(typeof S.bind=="function")return S.bind(x);try{return Function.prototype.bind.call(S,x)}catch{return function(){return Function.prototype.apply.apply(S,[x,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function f(x){return x==="debug"&&(x="log"),typeof console===t?!1:x==="trace"&&r?l:console[x]!==void 0?s(console,x):console.log!==void 0?s(console,"log"):e}function h(){for(var x=this.getLevel(),w=0;w<i.length;w++){var S=i[w];this[S]=w<x?e:this.methodFactory(S,x,this.name)}if(this.log=this.debug,typeof console===t&&x<this.levels.SILENT)return"No console available for logging"}function m(x){return function(){typeof console!==t&&(h.call(this),this[x].apply(this,arguments))}}function g(x,w,S){return f(x)||m.apply(this,arguments)}function y(x,w){var S=this,A,E,_,T="loglevel";typeof x=="string"?T+=":"+x:typeof x=="symbol"&&(T=void 0);function M(G){var Z=(i[G]||"silent").toUpperCase();if(!(typeof window===t||!T)){try{window.localStorage[T]=Z;return}catch{}try{window.document.cookie=encodeURIComponent(T)+"="+Z+";"}catch{}}}function P(){var G;if(!(typeof window===t||!T)){try{G=window.localStorage[T]}catch{}if(typeof G===t)try{var Z=window.document.cookie,ne=encodeURIComponent(T),pe=Z.indexOf(ne+"=");pe!==-1&&(G=/^([^;]+)/.exec(Z.slice(pe+ne.length+1))[1])}catch{}return S.levels[G]===void 0&&(G=void 0),G}}function j(){if(!(typeof window===t||!T)){try{window.localStorage.removeItem(T)}catch{}try{window.document.cookie=encodeURIComponent(T)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function X(G){var Z=G;if(typeof Z=="string"&&S.levels[Z.toUpperCase()]!==void 0&&(Z=S.levels[Z.toUpperCase()]),typeof Z=="number"&&Z>=0&&Z<=S.levels.SILENT)return Z;throw new TypeError("log.setLevel() called with invalid level: "+G)}S.name=x,S.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},S.methodFactory=w||g,S.getLevel=function(){return _??E??A},S.setLevel=function(G,Z){return _=X(G),Z!==!1&&M(_),h.call(S)},S.setDefaultLevel=function(G){E=X(G),P()||S.setLevel(G,!1)},S.resetLevel=function(){_=null,j(),h.call(S)},S.enableAll=function(G){S.setLevel(S.levels.TRACE,G)},S.disableAll=function(G){S.setLevel(S.levels.SILENT,G)},S.rebuild=function(){if(a!==S&&(A=X(a.getLevel())),h.call(S),a===S)for(var G in o)o[G].rebuild()},A=X(a?a.getLevel():"WARN");var L=P();L!=null&&(_=X(L)),h.call(S)}a=new y,a.getLogger=function(x){if(typeof x!="symbol"&&typeof x!="string"||x==="")throw new TypeError("You must supply a name when creating a logger.");var w=o[x];return w||(w=o[x]=new y(x,a.methodFactory)),w};var C=typeof window!==t?window.log:void 0;return a.noConflict=function(){return typeof window!==t&&window.log===a&&(window.log=C),a},a.getLoggers=function(){return o},a.default=a,a})}(Xy)),Xy.exports}var qG=KG();const YG=XG(qG);var $y=function(n,e){return $y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},$y(n,e)};function Fa(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");$y(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function QG(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function s(h){try{f(r.next(h))}catch(m){a(m)}}function l(h){try{f(r.throw(h))}catch(m){a(m)}}function f(h){h.done?o(h.value):i(h.value).then(s,l)}f((r=r.apply(n,[])).next())})}function w2(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(f){return function(h){return l([f,h])}}function l(f){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,f[0]&&(t=0)),t;)try{if(r=1,i&&(o=f[0]&2?i.return:f[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,f[1])).done)return o;switch(i=0,o&&(f=[f[0]&2,o.value]),f[0]){case 0:case 1:o=f;break;case 4:return t.label++,{value:f[1],done:!1};case 5:t.label++,i=f[1],f=[0];continue;case 7:f=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(f[0]===6||f[0]===2)){t=0;continue}if(f[0]===3&&(!o||f[1]>o[0]&&f[1]<o[3])){t.label=f[1];break}if(f[0]===6&&t.label<o[1]){t.label=o[1],o=f;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(f);break}o[2]&&t.ops.pop(),t.trys.pop();continue}f=e.call(n,t)}catch(h){f=[6,h],i=0}finally{r=o=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Mu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Sp(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return o}function Ap(n,e,t){if(arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}function bu(n){return this instanceof bu?(this.v=n,this):new bu(n)}function JG(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(y){return function(C){return Promise.resolve(C).then(y,m)}}function s(y,C){r[y]&&(i[y]=function(x){return new Promise(function(w,S){o.push([y,x,w,S])>1||l(y,x)})},C&&(i[y]=C(i[y])))}function l(y,C){try{f(r[y](C))}catch(x){g(o[0][3],x)}}function f(y){y.value instanceof bu?Promise.resolve(y.value.v).then(h,m):g(o[0][2],y)}function h(y){l("next",y)}function m(y){l("throw",y)}function g(y,C){y(C),o.shift(),o.length&&l(o[0][0],o[0][1])}}function eV(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Mu=="function"?Mu(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(a){return new Promise(function(s,l){a=n[o](a),i(s,l,a.done,a.value)})}}function i(o,a,s,l){Promise.resolve(l).then(function(f){o({value:f,done:s})},a)}}function Kr(n){return typeof n=="function"}function h1(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Cv=h1(function(n){return function(e){n(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(t,r){return r+1+") "+t.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function kp(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var _f=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,i,o;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var s=Mu(a),l=s.next();!l.done;l=s.next()){var f=l.value;f.remove(this)}}catch(x){e={error:x}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else a.remove(this);var h=this.initialTeardown;if(Kr(h))try{h()}catch(x){o=x instanceof Cv?x.errors:[x]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var g=Mu(m),y=g.next();!y.done;y=g.next()){var C=y.value;try{hA(C)}catch(x){o=o??[],x instanceof Cv?o=Ap(Ap([],Sp(o)),Sp(x.errors)):o.push(x)}}}catch(x){r={error:x}}finally{try{y&&!y.done&&(i=g.return)&&i.call(g)}finally{if(r)throw r.error}}}if(o)throw new Cv(o)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)hA(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&kp(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&kp(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),S2=_f.EMPTY;function A2(n){return n instanceof _f||n&&"closed"in n&&Kr(n.remove)&&Kr(n.add)&&Kr(n.unsubscribe)}function hA(n){Kr(n)?n():n.unsubscribe()}var tV={Promise:void 0},nV={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,Ap([n,e],Sp(t)))},clearTimeout:function(n){return clearTimeout(n)},delegate:void 0};function k2(n){nV.setTimeout(function(){throw n})}function Ky(){}function Z0(n){n()}var p1=function(n){Fa(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,A2(t)&&t.add(r)):r.destination=oV,r}return e.create=function(t,r,i){return new qy(t,r,i)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(_f),rV=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){Fh(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){Fh(r)}else Fh(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){Fh(t)}},n}(),qy=function(n){Fa(e,n);function e(t,r,i){var o=n.call(this)||this,a;return Kr(t)||!t?a={next:t??void 0,error:r??void 0,complete:i??void 0}:a=t,o.destination=new rV(a),o}return e}(p1);function Fh(n){k2(n)}function iV(n){throw n}var oV={closed:!0,next:Ky,error:iV,complete:Ky},g1=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function E2(n){return n}function sV(n){return n.length===0?E2:n.length===1?n[0]:function(e){return n.reduce(function(t,r){return r(t)},e)}}var ci=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var i=this,o=cV(e)?e:new qy(e,t,r);return Z0(function(){var a=i,s=a.operator,l=a.source;o.add(s?s.call(o,l):l?i._subscribe(o):i._trySubscribe(o))}),o},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=pA(t),new t(function(i,o){var a=new qy({next:function(s){try{e(s)}catch(l){o(l),a.unsubscribe()}},error:o,complete:i});r.subscribe(a)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[g1]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return sV(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=pA(e),new e(function(r,i){var o;t.subscribe(function(a){return o=a},function(a){return i(a)},function(){return r(o)})})},n.create=function(e){return new n(e)},n}();function pA(n){var e;return(e=n??tV.Promise)!==null&&e!==void 0?e:Promise}function aV(n){return n&&Kr(n.next)&&Kr(n.error)&&Kr(n.complete)}function cV(n){return n&&n instanceof p1||aV(n)&&A2(n)}function lV(n){return Kr(n==null?void 0:n.lift)}function Bc(n){return function(e){if(lV(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Al(n,e,t,r,i){return new uV(n,e,t,r,i)}var uV=function(n){Fa(e,n);function e(t,r,i,o,a,s){var l=n.call(this,t)||this;return l.onFinalize=a,l.shouldUnsubscribe=s,l._next=r?function(f){try{r(f)}catch(h){t.error(h)}}:n.prototype._next,l._error=o?function(f){try{o(f)}catch(h){t.error(h)}finally{this.unsubscribe()}}:n.prototype._error,l._complete=i?function(){try{i()}catch(f){t.error(f)}finally{this.unsubscribe()}}:n.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(p1),dV=h1(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),kl=function(n){Fa(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new gA(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new dV},e.prototype.next=function(t){var r=this;Z0(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=Mu(r.currentObservers),s=a.next();!s.done;s=a.next()){var l=s.value;l.next(t)}}catch(f){i={error:f}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var r=this;Z0(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var i=r.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;Z0(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,i=this,o=i.hasError,a=i.isStopped,s=i.observers;return o||a?S2:(this.currentObservers=null,s.push(t),new _f(function(){r.currentObservers=null,kp(s,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,i=r.hasError,o=r.thrownError,a=r.isStopped;i?t.error(o):a&&t.complete()},e.prototype.asObservable=function(){var t=new ci;return t.source=this,t},e.create=function(t,r){return new gA(t,r)},e}(ci),gA=function(n){Fa(e,n);function e(t,r){var i=n.call(this)||this;return i.destination=t,i.source=r,i}return e.prototype.next=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,t)},e.prototype.error=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&i!==void 0?i:S2},e}(kl),T2=function(n){Fa(e,n);function e(t){var r=n.call(this)||this;return r._value=t,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=n.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,r=t.hasError,i=t.thrownError,o=t._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(t){n.prototype.next.call(this,this._value=t)},e}(kl),fV={now:function(){return Date.now()}},hV=function(n){Fa(e,n);function e(t,r){return n.call(this)||this}return e.prototype.schedule=function(t,r){return this},e}(_f),mA={setInterval:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setInterval.apply(void 0,Ap([n,e],Sp(t)))},clearInterval:function(n){return clearInterval(n)},delegate:void 0},pV=function(n){Fa(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i.pending=!1,i}return e.prototype.schedule=function(t,r){var i;if(r===void 0&&(r=0),this.closed)return this;this.state=t;var o=this.id,a=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(a,o,r)),this.pending=!0,this.delay=r,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(a,this.id,r),this},e.prototype.requestAsyncId=function(t,r,i){return i===void 0&&(i=0),mA.setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;r!=null&&mA.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var i=!1,o;try{this.work(t)}catch(a){i=!0,o=a||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),o},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,i=t.scheduler,o=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,kp(o,this),r!=null&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,n.prototype.unsubscribe.call(this)}},e}(hV),vA=function(){function n(e,t){t===void 0&&(t=n.now),this.schedulerActionCtor=e,this.now=t}return n.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},n.now=fV.now,n}(),gV=function(n){Fa(e,n);function e(t,r){r===void 0&&(r=vA.now);var i=n.call(this,t,r)||this;return i.actions=[],i._active=!1,i}return e.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var i;this._active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,i){for(;t=r.shift();)t.unsubscribe();throw i}},e}(vA);new gV(pV);function mV(n){return n&&Kr(n.schedule)}function vV(n){return n[n.length-1]}function _2(n){return mV(vV(n))?n.pop():void 0}var R2=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function P2(n){return Kr(n==null?void 0:n.then)}function D2(n){return Kr(n[g1])}function M2(n){return Symbol.asyncIterator&&Kr(n==null?void 0:n[Symbol.asyncIterator])}function N2(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function yV(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var B2=yV();function O2(n){return Kr(n==null?void 0:n[B2])}function F2(n){return JG(this,arguments,function(){var e,t,r,i;return w2(this,function(o){switch(o.label){case 0:e=n.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,bu(e.read())];case 3:return t=o.sent(),r=t.value,i=t.done,i?[4,bu(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,bu(r)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function L2(n){return Kr(n==null?void 0:n.getReader)}function Vu(n){if(n instanceof ci)return n;if(n!=null){if(D2(n))return CV(n);if(R2(n))return xV(n);if(P2(n))return bV(n);if(M2(n))return U2(n);if(O2(n))return IV(n);if(L2(n))return wV(n)}throw N2(n)}function CV(n){return new ci(function(e){var t=n[g1]();if(Kr(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function xV(n){return new ci(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function bV(n){return new ci(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,k2)})}function IV(n){return new ci(function(e){var t,r;try{for(var i=Mu(n),o=i.next();!o.done;o=i.next()){var a=o.value;if(e.next(a),e.closed)return}}catch(s){t={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.complete()})}function U2(n){return new ci(function(e){SV(n,e).catch(function(t){return e.error(t)})})}function wV(n){return U2(F2(n))}function SV(n,e){var t,r,i,o;return QG(this,void 0,void 0,function(){var a,s;return w2(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=eV(n),l.label=1;case 1:return[4,t.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=l.sent(),i={error:s},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(o=t.return)?[4,o.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function gl(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function j2(n,e){return e===void 0&&(e=0),Bc(function(t,r){t.subscribe(Al(r,function(i){return gl(r,n,function(){return r.next(i)},e)},function(){return gl(r,n,function(){return r.complete()},e)},function(i){return gl(r,n,function(){return r.error(i)},e)}))})}function G2(n,e){return e===void 0&&(e=0),Bc(function(t,r){r.add(n.schedule(function(){return t.subscribe(r)},e))})}function AV(n,e){return Vu(n).pipe(G2(e),j2(e))}function kV(n,e){return Vu(n).pipe(G2(e),j2(e))}function EV(n,e){return new ci(function(t){var r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function TV(n,e){return new ci(function(t){var r;return gl(t,e,function(){r=n[B2](),gl(t,e,function(){var i,o,a;try{i=r.next(),o=i.value,a=i.done}catch(s){t.error(s);return}a?t.complete():t.next(o)},0,!0)}),function(){return Kr(r==null?void 0:r.return)&&r.return()}})}function V2(n,e){if(!n)throw new Error("Iterable cannot be null");return new ci(function(t){gl(t,e,function(){var r=n[Symbol.asyncIterator]();gl(t,e,function(){r.next().then(function(i){i.done?t.complete():t.next(i.value)})},0,!0)})})}function _V(n,e){return V2(F2(n),e)}function RV(n,e){if(n!=null){if(D2(n))return AV(n,e);if(R2(n))return EV(n,e);if(P2(n))return kV(n,e);if(M2(n))return V2(n,e);if(O2(n))return TV(n,e);if(L2(n))return _V(n,e)}throw N2(n)}function z2(n,e){return e?RV(n,e):Vu(n)}h1(function(n){return function(e){e===void 0&&(e=null),n(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e}});function vi(n,e){return Bc(function(t,r){var i=0;t.subscribe(Al(r,function(o){r.next(n.call(e,o,i++))}))})}function PV(n,e,t,r,i,o,a,s){var l=[],f=0,h=0,m=!1,g=function(){m&&!l.length&&!f&&e.complete()},y=function(x){return f<r?C(x):l.push(x)},C=function(x){f++;var w=!1;Vu(t(x,h++)).subscribe(Al(e,function(S){e.next(S)},function(){w=!0},void 0,function(){if(w)try{f--;for(var S=function(){var A=l.shift();a||C(A)};l.length&&f<r;)S();g()}catch(A){e.error(A)}}))};return n.subscribe(Al(e,y,function(){m=!0,g()})),function(){}}function W2(n,e,t){return t===void 0&&(t=1/0),Kr(e)?W2(function(r,i){return vi(function(o,a){return e(r,o,i,a)})(Vu(n(r,i)))},t):(typeof e=="number"&&(t=e),Bc(function(r,i){return PV(r,i,n,t)}))}function DV(n){return W2(E2,n)}function MV(){return DV(1)}function Yy(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return MV()(z2(n,_2(n)))}function m1(n,e){return Bc(function(t,r){var i=0;t.subscribe(Al(r,function(o){return n.call(e,o,i++)&&r.next(o)}))})}function NV(n,e,t,r,i){return function(o,a){var s=t,l=e,f=0;o.subscribe(Al(a,function(h){var m=f++;l=s?n(l,h,m):(s=!0,h),a.next(l)},i))}}function yA(n,e){return Bc(NV(n,e,arguments.length>=2,!0))}function oa(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=_2(n);return Bc(function(r,i){(t?Yy(n,r,t):Yy(n,r)).subscribe(i)})}function CA(n){return Bc(function(e,t){Vu(n).subscribe(Al(t,function(){return t.complete()},Ky)),!t.closed&&e.subscribe(t)})}var BV=Object.defineProperty,OV=Object.defineProperties,FV=Object.getOwnPropertyDescriptors,xA=Object.getOwnPropertySymbols,LV=Object.prototype.hasOwnProperty,UV=Object.prototype.propertyIsEnumerable,bA=(n,e,t)=>e in n?BV(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,vc=(n,e)=>{for(var t in e||(e={}))LV.call(e,t)&&bA(n,t,e[t]);if(xA)for(var t of xA(e))UV.call(e,t)&&bA(n,t,e[t]);return n},Dd=(n,e)=>OV(n,FV(e)),_s=(n,e,t)=>new Promise((r,i)=>{var o=l=>{try{s(t.next(l))}catch(f){i(f)}},a=l=>{try{s(t.throw(l))}catch(f){i(f)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,a);s((t=t.apply(n,e)).next())}),H2="lk";function qp(n){return typeof n>"u"?!1:jV(n)||GV(n)}function jV(n){var e;return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&n.hasOwnProperty("track")&&typeof((e=n.publication)==null?void 0:e.track)<"u":!1}function GV(n){return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&n.hasOwnProperty("publication")&&typeof n.publication<"u":!1}function VV(n){return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&typeof n.publication>"u":!1}function v1(n){if(typeof n=="string"||typeof n=="number")return`${n}`;if(VV(n))return`${n.participant.identity}_${n.source}_placeholder`;if(qp(n))return`${n.participant.identity}_${n.publication.source}_${n.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${n}`)}function zV(n,e,t){return VG(n,e,()=>_s(this,null,function*(){const{x:r,y:i}=yield ZG(n,e,{placement:"top",middleware:[zG(6),HG(),WG({padding:5})]});t==null||t(r,i)}))}function WV(n,e){return!n.contains(e.target)}var HV=[ze.ConnectionStateChanged,ze.RoomMetadataChanged,ze.ActiveSpeakersChanged,ze.ConnectionQualityChanged,ze.ParticipantConnected,ze.ParticipantDisconnected,ze.ParticipantPermissionsChanged,ze.ParticipantMetadataChanged,ze.ParticipantNameChanged,ze.ParticipantAttributesChanged,ze.TrackMuted,ze.TrackUnmuted,ze.TrackPublished,ze.TrackUnpublished,ze.TrackStreamStateChanged,ze.TrackSubscriptionFailed,ze.TrackSubscriptionPermissionChanged,ze.TrackSubscriptionStatusChanged],ZV=[...HV,ze.LocalTrackPublished,ze.LocalTrackUnpublished];Ze.TrackPublished,Ze.TrackUnpublished,Ze.TrackMuted,Ze.TrackUnmuted,Ze.TrackStreamStateChanged,Ze.TrackSubscribed,Ze.TrackUnsubscribed,Ze.TrackSubscriptionPermissionChanged,Ze.TrackSubscriptionFailed,Ze.LocalTrackPublished,Ze.LocalTrackUnpublished;var XV=[Ze.ConnectionQualityChanged,Ze.IsSpeakingChanged,Ze.ParticipantMetadataChanged,Ze.ParticipantPermissionsChanged,Ze.TrackMuted,Ze.TrackUnmuted,Ze.TrackPublished,Ze.TrackUnpublished,Ze.TrackStreamStateChanged,Ze.TrackSubscriptionFailed,Ze.TrackSubscriptionPermissionChanged,Ze.TrackSubscriptionStatusChanged];[...XV,Ze.LocalTrackPublished,Ze.LocalTrackUnpublished];var Dn=YG.getLogger("lk-components-js");Dn.setDefaultLevel("WARN");function $V(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var KV=[],qV={showChat:!1,unreadMessages:0,showSettings:!1};function Z2(n){return typeof n=="object"}function X2(n){return Array.isArray(n)&&n.filter(Z2).length>0}function $o(n){return`${H2}-${n}`}function YV(n){const e=Qy(n),t=$2(n.participant).pipe(vi(()=>Qy(n)),oa(e));return{className:$o(n.source===Ue.Source.Camera||n.source===Ue.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:t}}function Qy(n){if(qp(n))return n.publication;{const{source:e,name:t,participant:r}=n;if(e&&t)return r.getTrackPublications().find(i=>i.source===e&&i.trackName===t);if(t)return r.getTrackPublicationByName(t);if(e)return r.getTrackPublication(e);throw new Error("At least one of source and name needs to be defined")}}function y1(n,...e){return new ci(t=>{const r=()=>{t.next(n)};return e.forEach(i=>{n.on(i,r)}),()=>{e.forEach(i=>{n.off(i,r)})}}).pipe(oa(n))}function C1(n,e){return new ci(t=>{const r=(...i)=>{t.next(i)};return n.on(e,r),()=>{n.off(e,r)}})}function QV(n){return C1(n,ze.ConnectionStateChanged).pipe(vi(([e])=>e),oa(n.state))}function JV(n,e,t=!0){const r=new ci(o=>{Na.getLocalDevices(n,t).then(a=>{o.next(a),o.complete()}).catch(a=>{e==null||e(a),o.next([]),o.complete()})}),i=new ci(o=>{var a;const s=()=>_s(this,null,function*(){try{const l=yield Na.getLocalDevices(n,t);o.next(l)}catch(l){e==null||e(l)}});if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(a=navigator==null?void 0:navigator.mediaDevices)==null||a.addEventListener("devicechange",s)}return()=>{var l;(l=navigator==null?void 0:navigator.mediaDevices)==null||l.removeEventListener("devicechange",s)}});return Yy(r,i)}function ez(n){return C1(n,ze.DataReceived)}function tz(n){return y1(n,ze.AudioPlaybackStatusChanged).pipe(vi(e=>({canPlayAudio:e.canPlaybackAudio})))}function nz(n){return y1(n,ze.VideoPlaybackStatusChanged).pipe(vi(e=>({canPlayVideo:e.canPlaybackVideo})))}function rz(n,e){return C1(n,ze.ActiveDeviceChanged).pipe(m1(([t])=>t===e),vi(([t,r])=>(Dn.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:t,deviceId:r}),r)))}function x1(n,...e){return new ci(t=>{const r=()=>{t.next(n)};return e.forEach(i=>{n.on(i,r)}),()=>{e.forEach(i=>{n.off(i,r)})}}).pipe(oa(n))}function $2(n){return x1(n,Ze.TrackMuted,Ze.TrackUnmuted,Ze.ParticipantPermissionsChanged,Ze.TrackPublished,Ze.TrackUnpublished,Ze.LocalTrackPublished,Ze.LocalTrackUnpublished,Ze.MediaDevicesError,Ze.TrackSubscriptionStatusChanged).pipe(vi(e=>{const{isMicrophoneEnabled:t,isCameraEnabled:r,isScreenShareEnabled:i}=e,o=e.getTrackPublication(Ue.Source.Microphone),a=e.getTrackPublication(Ue.Source.Camera);return{isCameraEnabled:r,isMicrophoneEnabled:t,isScreenShareEnabled:i,cameraTrack:a,microphoneTrack:o,participant:e}}))}function iz(n){return n?x1(n,Ze.ParticipantMetadataChanged,Ze.ParticipantNameChanged).pipe(vi(({name:e,identity:t,metadata:r})=>({name:e,identity:t,metadata:r})),oa({name:n.name,identity:n.identity,metadata:n.metadata})):void 0}function oz(n){return b1(n,Ze.ConnectionQualityChanged).pipe(vi(([e])=>e),oa(n.connectionQuality))}function b1(n,e){return new ci(t=>{const r=(...i)=>{t.next(i)};return n.on(e,r),()=>{n.off(e,r)}})}function K2(n){var e,t,r,i;return x1(n.participant,Ze.TrackMuted,Ze.TrackUnmuted,Ze.TrackSubscribed,Ze.TrackUnsubscribed,Ze.LocalTrackPublished,Ze.LocalTrackUnpublished).pipe(vi(o=>{var a,s;const l=(a=n.publication)!=null?a:o.getTrackPublication(n.source);return(s=l==null?void 0:l.isMuted)!=null?s:!0}),oa((i=(r=(e=n.publication)==null?void 0:e.isMuted)!=null?r:(t=n.participant.getTrackPublication(n.source))==null?void 0:t.isMuted)!=null?i:!0))}function sz(n){return b1(n,Ze.IsSpeakingChanged).pipe(vi(([e])=>e))}function az(n){return b1(n,Ze.ParticipantPermissionsChanged).pipe(vi(()=>n.permissions),oa(n.permissions))}function cz(n,e,t,r,i){const{localParticipant:o}=e,a=(h,m)=>{let g=!1;switch(h){case Ue.Source.Camera:g=m.isCameraEnabled;break;case Ue.Source.Microphone:g=m.isMicrophoneEnabled;break;case Ue.Source.ScreenShare:g=m.isScreenShareEnabled;break}return g},s=$2(o).pipe(vi(h=>a(n,h.participant)),oa(a(n,o))),l=new kl,f=(h,m)=>_s(this,null,function*(){try{switch(m??(m=t),l.next(!0),n){case Ue.Source.Camera:return yield o.setCameraEnabled(h??!o.isCameraEnabled,m,r),o.isCameraEnabled;case Ue.Source.Microphone:return yield o.setMicrophoneEnabled(h??!o.isMicrophoneEnabled,m,r),o.isMicrophoneEnabled;case Ue.Source.ScreenShare:return yield o.setScreenShareEnabled(h??!o.isScreenShareEnabled,m,r),o.isScreenShareEnabled;default:throw new TypeError("Tried to toggle unsupported source")}}catch(g){if(i&&g instanceof Error){i==null||i(g);return}else throw g}finally{l.next(!1)}});return{className:$o("button"),toggle:f,enabledObserver:s,pendingObserver:l.asObservable()}}function lz(){let n=!1;const e=new kl,t=new kl,r=i=>_s(this,null,function*(){t.next(!0),n=i??!n,e.next(n),t.next(!1)});return{className:$o("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:t.asObservable()}}function uz(n,e,t){const r=new T2(void 0),i=rz(e,n),o=(a,...s)=>_s(this,[a,...s],function*(l,f={}){var h,m,g;if(e){Dn.debug(`Switching active device of kind "${n}" with id ${l}.`),yield e.switchActiveDevice(n,l,f.exact);const y=(h=e.getActiveDevice(n))!=null?h:l;y!==l&&l!=="default"&&Dn.info(`We tried to select the device with id (${l}), but the browser decided to select the device with id (${y}) instead.`);let C;n==="audioinput"?C=(m=e.localParticipant.getTrackPublication(Ue.Source.Microphone))==null?void 0:m.track:n==="videoinput"&&(C=(g=e.localParticipant.getTrackPublication(Ue.Source.Camera))==null?void 0:g.track);const x=l==="default"&&!C||l==="default"&&(C==null?void 0:C.mediaStreamTrack.label.startsWith("Default"));r.next(x?l:y)}});return{className:$o("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:o}}function dz(n){const e=t=>{n.disconnect(t)};return{className:$o("disconnect-button"),disconnect:e}}function fz(n){const e=$o("connection-quality"),t=oz(n);return{className:e,connectionQualityObserver:t}}function hz(n){let e="track-muted-indicator-camera";switch(n.source){case Ue.Source.Camera:e="track-muted-indicator-camera";break;case Ue.Source.Microphone:e="track-muted-indicator-microphone";break}const t=$o(e),r=K2(n);return{className:t,mediaMutedObserver:r}}function pz(n){return{className:"lk-participant-name",infoObserver:iz(n)}}function gz(){return{className:$o("participant-tile")}}var mz={CHAT:"lk.chat"},vz={CHAT:"lk-chat-topic"};function q2(n,e){return _s(this,arguments,function*(t,r,i={}){const{reliable:o,destinationIdentities:a,topic:s}=i;yield t.publishData(r,{destinationIdentities:a,topic:s,reliable:o})})}function yz(n,e,t){const r=Array.isArray(e)?e:[e],i=ez(n).pipe(m1(([,,,s])=>e===void 0||s!==void 0&&r.includes(s)),vi(([s,l,,f])=>({payload:s,topic:f,from:l})));let o;const a=new ci(s=>{o=s});return{messageObservable:i,isSendingObservable:a,send:(s,...l)=>_s(this,[s,...l],function*(f,h={}){o.next(!0);try{yield q2(n.localParticipant,f,vc({topic:r[0]},h))}finally{o.next(!1)}})}}var Lh=new WeakMap;function Cz(n){return n.ignoreLegacy==!0}var xz=n=>JSON.parse(new TextDecoder().decode(n)),bz=n=>new TextEncoder().encode(JSON.stringify(n));function Iz(n,e){var t,r,i,o,a,s;const l=()=>{var T,M,P;return((T=n.serverInfo)==null?void 0:T.edition)===1||!!((M=n.serverInfo)!=null&&M.version)&&ks((P=n.serverInfo)==null?void 0:P.version,"1.8.2")>0},f=new kl,h=(t=e==null?void 0:e.channelTopic)!=null?t:mz.CHAT,m=(r=e==null?void 0:e.channelTopic)!=null?r:vz.CHAT;let g=!1;Lh.has(n)||(g=!0);const y=(i=Lh.get(n))!=null?i:new Map,C=(o=y.get(h))!=null?o:new kl;y.set(h,C),Lh.set(n,y);const x=(a=e==null?void 0:e.messageDecoder)!=null?a:xz;if(g){n.registerTextStreamHandler(h,(M,P)=>_s(this,null,function*(){const{id:j,timestamp:X}=M.info;z2(M).pipe(yA((L,G)=>L+G),vi(L=>({id:j,timestamp:X,message:L,from:n.getParticipantByIdentity(P.identity)}))).subscribe({next:L=>C.next(L)})}));const{messageObservable:T}=yz(n,[m]);T.pipe(vi(M=>{const P=x(M.payload);return Cz(P)?void 0:Dd(vc({},P),{from:M.from})}),m1(M=>!!M),CA(f)).subscribe(C)}const w=C.pipe(yA((T,M)=>{if("id"in M&&T.find(P=>{var j,X;return((j=P.from)==null?void 0:j.identity)===((X=M.from)==null?void 0:X.identity)&&P.id===M.id})){const P=T.findIndex(j=>j.id===M.id);if(P>-1){const j=T[P];T[P]=Dd(vc({},M),{timestamp:j.timestamp,editTimestamp:M.timestamp})}return[...T]}return[...T,M]},[]),CA(f)),S=new T2(!1),A=(s=e==null?void 0:e.messageEncoder)!=null?s:bz,E=(T,M)=>_s(this,null,function*(){M||(M={}),M.topic!=null||(M.topic=h),S.next(!0);try{const P={id:(yield n.localParticipant.sendText(T,M)).id,timestamp:Date.now(),message:T},j=Dd(vc({},P),{attachedFiles:M.attachments}),X=Dd(vc({},j),{from:n.localParticipant,attributes:M.attributes});C.next(X);const L=A(Dd(vc({},P),{ignoreLegacy:l()}));try{yield q2(n.localParticipant,L,{reliable:!0,topic:m})}catch(G){Dn.info("could not send message in legacy chat format",G)}return X}finally{S.next(!1)}});function _(){f.next(),f.complete(),C.complete(),Lh.delete(n),n.unregisterTextStreamHandler(h)}return n.once(ze.Disconnected,_),{messageObservable:w,isSendingObservable:S,send:E}}function wz(){const n=e=>_s(this,null,function*(){Dn.info("Start Audio for room: ",e),yield e.startAudio()});return{className:$o("start-audio-button"),roomAudioPlaybackAllowedObservable:tz,handleStartAudioPlayback:n}}function Sz(){const n=e=>_s(this,null,function*(){Dn.info("Start Video for room: ",e),yield e.startVideo()});return{className:$o("start-audio-button"),roomVideoPlaybackAllowedObservable:nz,handleStartVideoPlayback:n}}function Az(){return{className:[$o("button"),$o("chat-toggle")].join(" ")}}function kz(){return{className:"lk-room-container"}}function IA(n,e,t=!0){const r=[n.localParticipant,...Array.from(n.remoteParticipants.values())],i=[];return r.forEach(o=>{e.forEach(a=>{const s=Array.from(o.trackPublications.values()).filter(l=>l.source===a&&(!t||l.track)).map(l=>({participant:o,publication:l,source:l.source}));i.push(...s)})}),{trackReferences:i,participants:r}}function Ez(n,e,t){var r,i;const o=(r=t.additionalRoomEvents)!=null?r:ZV,a=(i=t.onlySubscribed)!=null?i:!0,s=Array.from(new Set([ze.ParticipantConnected,ze.ParticipantDisconnected,ze.ConnectionStateChanged,ze.LocalTrackPublished,ze.LocalTrackUnpublished,ze.TrackPublished,ze.TrackUnpublished,ze.TrackSubscriptionStatusChanged,...o]).values());return y1(n,...s).pipe(vi(l=>{const f=IA(l,e,a);return Dn.debug(`TrackReference[] was updated. (length ${f.trackReferences.length})`,f),f}),oa(IA(n,e,a)))}function Tz(n,e){if(typeof localStorage>"u"){Dn.error("Local storage is not available.");return}try{if(e){const t=Object.fromEntries(Object.entries(e).filter(([,r])=>r!==""));localStorage.setItem(n,JSON.stringify(t))}}catch(t){Dn.error(`Error setting item to local storage: ${t}`)}}function _z(n){if(typeof localStorage>"u"){Dn.error("Local storage is not available.");return}try{const e=localStorage.getItem(n);if(!e){Dn.warn(`Item with key ${n} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){Dn.error(`Error getting item from local storage: ${e}`);return}}function Rz(n){return{load:()=>_z(n),save:e=>Tz(n,e)}}var Pz=`${H2}-user-choices`,Md={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"default",audioDeviceId:"default",username:""},{load:Dz,save:Mz}=Rz(Pz);function Nz(n,e=!1){e!==!0&&Mz(n)}function Bz(n,e=!1){var t,r,i,o,a;const s={videoEnabled:(t=n==null?void 0:n.videoEnabled)!=null?t:Md.videoEnabled,audioEnabled:(r=n==null?void 0:n.audioEnabled)!=null?r:Md.audioEnabled,videoDeviceId:(i=n==null?void 0:n.videoDeviceId)!=null?i:Md.videoDeviceId,audioDeviceId:(o=n==null?void 0:n.audioDeviceId)!=null?o:Md.audioDeviceId,username:(a=n==null?void 0:n.username)!=null?a:Md.username};if(e)return s;{const l=Dz();return vc(vc({},s),l??{})}}function Oz(n,e){if(e.msg==="show_chat")return{...n,showChat:!0,unreadMessages:0};if(e.msg==="hide_chat")return{...n,showChat:!1};if(e.msg==="toggle_chat"){const t={...n,showChat:!n.showChat};return t.showChat===!0&&(t.unreadMessages=0),t}else return e.msg==="unread_msg"?{...n,unreadMessages:e.count}:e.msg==="toggle_settings"?{...n,showSettings:!n.showSettings}:{...n}}function Fz(n,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:{...n}}const I1=O.createContext(void 0);function Y2(){const n=O.useContext(I1);if(!n)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return n}function Lz(n){const[e,t]=O.useReducer(Fz,KV),[r,i]=O.useReducer(Oz,qV);return n??{pin:{dispatch:t,state:e},widget:{dispatch:i,state:r}}}function Q2(){return O.useContext(I1)}const w1=O.createContext(void 0);function S1(){return O.useContext(w1)}function Yp(n){const e=S1(),t=n??e;if(!t)throw new Error("No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly");return t}const Uz=O.createContext(void 0);function jz(){return O.useContext(Uz)}function Qp(n){const e=jz(),t=S1(),r=n??e??(t==null?void 0:t.participant);if(!r)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return r}const A1=O.createContext(void 0);function Jp(){const n=O.useContext(A1);if(!n)throw Error("tried to access room context outside of livekit room component");return n}function eg(){return O.useContext(A1)}function tg(n){const e=eg(),t=n??e;if(!t)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return t}const Gz=O.createContext(void 0);var wA={};function J2(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=J2(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function eR(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=J2(n))&&(r&&(r+=" "),r+=e);return r}function Vz(...n){return(...e)=>{for(const t of n)if(typeof t=="function")try{t(...e)}catch(r){console.error(r)}}}function La(...n){const e={...n[0]};for(let t=1;t<n.length;t++){const r=n[t];for(const i in r){const o=e[i],a=r[i];typeof o=="function"&&typeof a=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=Vz(o,a):(i==="className"||i==="UNSAFE_className")&&typeof o=="string"&&typeof a=="string"?e[i]=eR(o,a):e[i]=a!==void 0?a:o}}return e}function zz(n){return n!==void 0}function Ml(...n){return La(...n.filter(zz))}function k1(n,e,t){return O.Children.map(n,r=>O.isValidElement(r)&&O.Children.only(n)?(r.props.className&&(e??(e={}),e.className=eR(r.props.className,e.className),e.style={...r.props.style,...e.style}),O.cloneElement(r,{...e,key:t})):r)}function Wz(n){var e,t;if(typeof window<"u"&&typeof process<"u"&&(((e=process==null?void 0:wA)==null?void 0:e.NODE_ENV)==="dev"||((t=process==null?void 0:wA)==null?void 0:t.NODE_ENV)==="development")){const r=document.querySelector(".lk-room-container");r&&!getComputedStyle(r).getPropertyValue("--lk-has-imported-styles")&&Dn.warn("It looks like you're not using the `@livekit/components-styles package`. To render the UI with the default styling, please import it in your layout or page.")}}function Hz(n,e){return n==="processor"&&e&&typeof e=="object"&&"name"in e?e.name:n==="e2ee"&&e?"e2ee-enabled":e}const Zz={connect:!0,audio:!1,video:!1};function Xz(n){const{token:e,serverUrl:t,options:r,room:i,connectOptions:o,connect:a,audio:s,video:l,screen:f,onConnected:h,onDisconnected:m,onError:g,onMediaDeviceFailure:y,onEncryptionError:C,simulateParticipants:x,...w}={...Zz,...n};r&&i&&Dn.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[S,A]=O.useState(),E=O.useRef(a);O.useEffect(()=>{A(i??new Na(r))},[i,JSON.stringify(r,Hz)]);const _=O.useMemo(()=>{const{className:T}=kz();return La(w,{className:T})},[w]);return O.useEffect(()=>{if(!S)return;const T=()=>{const L=S.localParticipant;Dn.debug("trying to publish local tracks"),Promise.all([L.setMicrophoneEnabled(!!s,typeof s!="boolean"?s:void 0),L.setCameraEnabled(!!l,typeof l!="boolean"?l:void 0),L.setScreenShareEnabled(!!f,typeof f!="boolean"?f:void 0)]).catch(G=>{Dn.warn(G),g==null||g(G)})},M=(L,G)=>{const Z=cf.getFailure(L);y==null||y(Z,G)},P=L=>{C==null||C(L)},j=L=>{m==null||m(L)},X=()=>{h==null||h()};return S.on(ze.SignalConnected,T).on(ze.MediaDevicesError,M).on(ze.EncryptionError,P).on(ze.Disconnected,j).on(ze.Connected,X),()=>{S.off(ze.SignalConnected,T).off(ze.MediaDevicesError,M).off(ze.EncryptionError,P).off(ze.Disconnected,j).off(ze.Connected,X)}},[S,s,l,f,g,C,y,h,m]),O.useEffect(()=>{if(S){if(x){S.simulateParticipants({participants:{count:x},publish:{audio:!0,useRealTracks:!0}});return}if(a){if(E.current=!0,Dn.debug("connecting"),!e){Dn.debug("no token yet");return}if(!t){Dn.warn("no livekit url provided"),g==null||g(Error("no livekit url provided"));return}S.connect(t,e,o).catch(T=>{Dn.warn(T),E.current===!0&&(g==null||g(T))})}else Dn.debug("disconnecting because connect is false"),E.current=!1,S.disconnect()}},[a,e,JSON.stringify(o),S,g,t,x]),O.useEffect(()=>{if(S)return()=>{Dn.info("disconnecting on onmount"),S.disconnect()}},[S]),{room:S,htmlProps:_}}const $z=O.forwardRef(function(n,e){const{room:t,htmlProps:r}=Xz(n);return O.createElement("div",{ref:e,...r},t&&O.createElement(A1.Provider,{value:t},O.createElement(Gz.Provider,{value:n.featureFlags},n.children)))});function Po(n,e,t=!0){const[r,i]=O.useState(e);return O.useEffect(()=>{if(t&&i(e),typeof window>"u"||!n)return;const o=n.subscribe(i);return()=>o.unsubscribe()},[n,t]),r}function Kz(n){const e=o=>typeof window<"u"?window.matchMedia(o).matches:!1,[t,r]=O.useState(e(n));function i(){r(e(n))}return O.useEffect(()=>{const o=window.matchMedia(n);return i(),o.addListener?o.addListener(i):o.addEventListener("change",i),()=>{o.removeListener?o.removeListener(i):o.removeEventListener("change",i)}},[n]),t}function qz(n={}){const e=Qp(n.participant),{className:t,connectionQualityObserver:r}=O.useMemo(()=>fz(e),[e]),i=Po(r,e.connectionQuality);return{className:t,quality:i}}function tR(n){const e=tg(n),t=O.useMemo(()=>QV(e),[e]);return Po(t,e.state)}function Yz(n){const e=Jp(),t=tR(e);return{buttonProps:O.useMemo(()=>{const{className:r,disconnect:i}=dz(e);return La(n,{className:r,onClick:()=>i(n.stopTracks??!0),disabled:t===Pn.Disconnected})},[e,n,t])}}function Qz(n){if(n.publication instanceof yp){const e=n.publication.track;if(e){const{facingMode:t}=cG(e);return t}}return"undefined"}function SA(n,e={}){var t,r;const i=typeof n=="string"?e.participant:n.participant,o=Qp(i),a=typeof n=="string"?{participant:o,source:n}:n,[s,l]=O.useState(!!((t=a.publication)!=null&&t.isMuted||(r=o.getTrackPublication(a.source))!=null&&r.isMuted));return O.useEffect(()=>{const f=K2(a).subscribe(l);return()=>f.unsubscribe()},[v1(a)]),s}function Jz(n){const e=Qp(n),t=O.useMemo(()=>sz(e),[e]);return Po(t,e.isSpeaking)}function eW(){const n=Jp(),e=O.useMemo(()=>az(n.localParticipant),[n]);return Po(e,n.localParticipant.permissions)}function tW({kind:n,room:e,track:t,requestPermissions:r,onError:i}){const o=eg(),a=O.useMemo(()=>e??o??new Na,[e,o]),s=O.useMemo(()=>JV(n,i,r),[n,r,i]),l=Po(s,[]),[f,h]=O.useState((a==null?void 0:a.getActiveDevice(n))??"default"),{className:m,activeDeviceObservable:g,setActiveMediaDevice:y}=O.useMemo(()=>uz(n,a),[n,a,t]);return O.useEffect(()=>{const C=g.subscribe(x=>{x&&(Dn.info("setCurrentDeviceId",x),h(x))});return()=>{C==null||C.unsubscribe()}},[g]),{devices:l,className:m,activeDeviceId:f,setActiveMediaDevice:y}}function nW({trackRef:n,onParticipantClick:e,disableSpeakingIndicator:t,htmlProps:r}){const i=Yp(n),o=O.useMemo(()=>{const{className:g}=gz();return La(r,{className:g,onClick:y=>{var C;if((C=r.onClick)==null||C.call(r,y),typeof e=="function"){const x=i.publication??i.participant.getTrackPublication(i.source);e({participant:i.participant,track:x})}}})},[r,e,i.publication,i.source,i.participant]),a=i.participant.getTrackPublication(Ue.Source.Microphone),s=O.useMemo(()=>({participant:i.participant,source:Ue.Source.Microphone,publication:a}),[a,i.participant]),l=SA(i),f=SA(s),h=Jz(i.participant),m=Qz(i);return{elementProps:{"data-lk-audio-muted":f,"data-lk-video-muted":l,"data-lk-speaking":t===!0?!1:h,"data-lk-local-participant":i.participant.isLocal,"data-lk-source":i.source,"data-lk-facing-mode":m,...o}}}function rW({room:n,props:e}){const t=tg(n),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:o}=O.useMemo(()=>wz(),[]),a=O.useMemo(()=>i(t),[t,i]),{canPlayAudio:s}=Po(a,{canPlayAudio:t.canPlaybackAudio});return{mergedProps:O.useMemo(()=>La(e,{className:r,onClick:()=>{o(t)},style:{display:s?"none":"block"}}),[e,r,s,o,t]),canPlayAudio:s}}function iW({room:n,props:e}){const t=tg(n),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:o}=O.useMemo(()=>Sz(),[]),a=O.useMemo(()=>i(t),[t,i]),{canPlayVideo:s}=Po(a,{canPlayVideo:t.canPlaybackVideo});return{mergedProps:O.useMemo(()=>La(e,{className:r,onClick:()=>{o(t)},style:{display:s?"none":"block"}}),[e,r,s,o,t]),canPlayVideo:s}}function oW({props:n}){const{dispatch:e,state:t}=Y2().widget,{className:r}=O.useMemo(()=>Az(),[]);return{mergedProps:O.useMemo(()=>La(n,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":t!=null&&t.showChat?"true":"false","data-lk-unread-msgs":t?t.unreadMessages<10?t.unreadMessages.toFixed(0):"9+":"0"}),[n,r,e,t])}}function sW(n){var e,t;const r=Yp(n),{className:i,mediaMutedObserver:o}=O.useMemo(()=>hz(r),[v1(r)]);return{isMuted:Po(o,!!((e=r.publication)!=null&&e.isMuted||(t=r.participant.getTrackPublication(r.source))!=null&&t.isMuted)),className:i}}function aW({source:n,onChange:e,initialState:t,captureOptions:r,publishOptions:i,onDeviceError:o,...a}){var s;const l=eg(),f=(s=l==null?void 0:l.localParticipant)==null?void 0:s.getTrackPublication(n),h=O.useRef(!1),{toggle:m,className:g,pendingObserver:y,enabledObserver:C}=O.useMemo(()=>l?cz(n,l,r,i,o):lz(),[l,n,JSON.stringify(r),i]),x=Po(y,!1),w=Po(C,t??!!(f!=null&&f.isEnabled));O.useEffect(()=>{e==null||e(w,h.current),h.current=!1},[w,e]),O.useEffect(()=>{t!==void 0&&(Dn.debug("forcing initial toggle state",n,t),m(t))},[]);const S=O.useMemo(()=>La(a,{className:g}),[a,g]),A=O.useCallback(E=>{var _;h.current=!0,m().catch(()=>h.current=!1),(_=a.onClick)==null||_.call(a,E)},[a,m]);return{toggle:m,enabled:w,pending:x,track:f,buttonProps:{...S,"aria-pressed":w,"data-lk-source":n,"data-lk-enabled":w,disabled:x,onClick:A}}}function cW(n=[Ue.Source.Camera,Ue.Source.Microphone,Ue.Source.ScreenShare,Ue.Source.ScreenShareAudio,Ue.Source.Unknown],e={}){const t=tg(e.room),[r,i]=O.useState([]),[o,a]=O.useState([]),s=O.useMemo(()=>n.map(l=>Z2(l)?l.source:l),[JSON.stringify(n)]);return O.useEffect(()=>{const l=Ez(t,s,{additionalRoomEvents:e.updateOnlyOn,onlySubscribed:e.onlySubscribed}).subscribe(({trackReferences:f,participants:h})=>{Dn.debug("setting track bundles",f,h),i(f),a(h)});return()=>l.unsubscribe()},[t,JSON.stringify(e.onlySubscribed),JSON.stringify(e.updateOnlyOn),JSON.stringify(n)]),O.useMemo(()=>{if(X2(n)){const l=uW(n,o),f=Array.from(r);return o.forEach(h=>{l.has(h.identity)&&(l.get(h.identity)??[]).forEach(m=>{if(r.find(({participant:y,publication:C})=>h.identity===y.identity&&C.source===m))return;Dn.debug(`Add ${m} placeholder for participant ${h.identity}.`);const g={participant:h,source:m};f.push(g)})}),f}else return r},[r,o,n])}function lW(n,e){const t=new Set(n);for(const r of e)t.delete(r);return t}function uW(n,e){const t=new Map;if(X2(n)){const r=n.filter(i=>i.withPlaceholder).map(i=>i.source);e.forEach(i=>{const o=i.getTrackPublications().map(s=>{var l;return(l=s.track)==null?void 0:l.source}).filter(s=>s!==void 0),a=Array.from(lW(new Set(r),new Set(o)));a.length>0&&t.set(i.identity,a)})}return t}function dW(n){const e=Jp(),t=tR(e),r=O.useMemo(()=>t===Pn.Disconnected,[t]),i=O.useMemo(()=>Iz(e,n),[e,n,r]),o=Po(i.isSendingObservable,!1),a=Po(i.messageObservable,[]);return{send:i.send,chatMessages:a,isSending:o}}function fW(n={}){const[e,t]=O.useState(Bz(n.defaults,n.preventLoad??!1)),r=O.useCallback(l=>{t(f=>({...f,audioEnabled:l}))},[]),i=O.useCallback(l=>{t(f=>({...f,videoEnabled:l}))},[]),o=O.useCallback(l=>{t(f=>({...f,audioDeviceId:l}))},[]),a=O.useCallback(l=>{t(f=>({...f,videoDeviceId:l}))},[]),s=O.useCallback(l=>{t(f=>({...f,username:l}))},[]);return O.useEffect(()=>{Nz(e,n.preventSave??!1)},[e,n.preventSave]),{userChoices:e,saveAudioInputEnabled:r,saveVideoInputEnabled:i,saveAudioInputDeviceId:o,saveVideoInputDeviceId:a,saveUsername:s}}const hW=n=>{const e=t=>{let r=1-Math.max(-100,Math.min(-10,t))*-1/100;return r=Math.sqrt(r),r};return n.map(t=>t===-1/0?0:e(t))},pW={bands:5,loPass:100,hiPass:600,updateInterval:32,analyserOptions:{fftSize:2048}};function gW(n,e={}){var t;const r=n instanceof Ue?n:(t=n==null?void 0:n.publication)==null?void 0:t.track,i={...pW,...e},[o,a]=O.useState(new Array(i.bands).fill(0));return O.useEffect(()=>{if(!r||!(r!=null&&r.mediaStream))return;const{analyser:s,cleanup:l}=OU(r,i.analyserOptions),f=s.frequencyBinCount,h=new Float32Array(f),m=setInterval(()=>{s.getFloatFrequencyData(h);let g=new Float32Array(h.length);for(let w=0;w<h.length;w++)g[w]=h[w];g=g.slice(e.loPass,e.hiPass);const y=hW(g),C=Math.ceil(y.length/i.bands),x=[];for(let w=0;w<i.bands;w++){const S=y.slice(w*C,(w+1)*C).reduce((A,E)=>A+=E,0);x.push(S/C)}a(x)},i.updateInterval);return()=>{l(),clearInterval(m)}},[r,r==null?void 0:r.mediaStream,JSON.stringify(e)]),o}const nR=O.forwardRef(function(n,e){const{mergedProps:t}=oW({props:n});return O.createElement("button",{ref:e,...t},n.children)}),mW=O.forwardRef(function(n,e){const{buttonProps:t}=Yz(n);return O.createElement("button",{ref:e,...t},n.children)}),vW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...n},O.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),O.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),yW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...n},O.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),CW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24",...n},O.createElement("path",{fill:"#FFF",d:"M4.99 3.99a1 1 0 0 0-.697 1.717L10.586 12l-6.293 6.293a1 1 0 1 0 1.414 1.414L12 13.414l6.293 6.293a1 1 0 1 0 1.414-1.414L13.414 12l6.293-6.293a1 1 0 0 0-.727-1.717 1 1 0 0 0-.687.303L12 10.586 5.707 4.293a1 1 0 0 0-.717-.303z"})),xW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none",...n},O.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),O.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),bW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...n},O.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M8.961.894C8.875-.298 7.125-.298 7.04.894c-.066.912-1.246 1.228-1.76.472-.67-.99-2.186-.115-1.664.96.399.824-.465 1.688-1.288 1.289-1.076-.522-1.95.994-.961 1.665.756.513.44 1.693-.472 1.759-1.192.086-1.192 1.836 0 1.922.912.066 1.228 1.246.472 1.76-.99.67-.115 2.186.96 1.664.824-.399 1.688.465 1.289 1.288-.522 1.076.994 1.95 1.665.961.513-.756 1.693-.44 1.759.472.086 1.192 1.836 1.192 1.922 0 .066-.912 1.246-1.228 1.76-.472.67.99 2.186.115 1.664-.96-.399-.824.465-1.688 1.288-1.289 1.076.522 1.95-.994.961-1.665-.756-.513-.44-1.693.472-1.759 1.192-.086 1.192-1.836 0-1.922-.912-.066-1.228-1.246-.472-1.76.99-.67.115-2.186-.96-1.664-.824.399-1.688-.465-1.289-1.288.522-1.076-.994-1.95-1.665-.961-.513.756-1.693.44-1.759-.472ZM8 13A5 5 0 1 0 8 3a5 5 0 0 0 0 10Z",clipRule:"evenodd"})),IW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...n},O.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),O.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),wW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...n},O.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),O.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),SW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...n},O.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),O.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),AW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...n},O.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),O.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),kW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...n},O.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),O.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),O.createElement("g",{opacity:.25},O.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),O.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),EW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...n},O.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),O.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),O.createElement("g",{opacity:.25},O.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),O.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),O.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),TW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...n},O.createElement("g",{opacity:.25},O.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),O.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),_W=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...n},O.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),O.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),RW=n=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...n},O.createElement("g",{fill:"currentColor"},O.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),O.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),xv=O.forwardRef(function({kind:n,initialSelection:e,onActiveDeviceChange:t,onDeviceListChange:r,onDeviceSelectError:i,exactMatch:o,track:a,requestPermissions:s,onError:l,...f},h){const m=eg(),g=O.useRef("default"),y=O.useCallback(M=>{m&&m.emit(ze.MediaDevicesError,M),l==null||l(M)},[m,l]),{devices:C,activeDeviceId:x,setActiveMediaDevice:w,className:S}=tW({kind:n,room:m,track:a,requestPermissions:s,onError:y});O.useEffect(()=>{e!==void 0&&w(e)},[w]),O.useEffect(()=>{typeof r=="function"&&r(C)},[r,C]),O.useEffect(()=>{x!==g.current&&(t==null||t(x)),g.current=x},[x]);const A=async M=>{try{await w(M,{exact:o??!0})}catch(P){if(P instanceof Error)i==null||i(P);else throw P}},E=O.useMemo(()=>Ml(f,{className:S},{className:"lk-list"}),[S,f]),_=!!C.find(M=>M.label.toLowerCase().startsWith("default"));function T(M,P,j){return M===P||!_&&j===0&&P==="default"}return O.createElement("ul",{ref:h,...E},C.map((M,P)=>O.createElement("li",{key:M.deviceId,id:M.deviceId,"data-lk-active":T(M.deviceId,x,P),"aria-selected":T(M.deviceId,x,P),role:"option"},O.createElement("button",{className:"lk-button",onClick:()=>A(M.deviceId)},M.label))))}),PW=O.forwardRef(function({label:n,...e},t){const r=Jp(),{mergedProps:i,canPlayAudio:o}=rW({room:r,props:e}),{mergedProps:a,canPlayVideo:s}=iW({room:r,props:i}),{style:l,...f}=a;return l.display=o&&s?"none":"block",O.createElement("button",{ref:t,style:l,...f},n??`Start ${o?"Video":"Audio"}`)});function rR(n,e){switch(n){case Ue.Source.Microphone:return e?O.createElement(SW,null):O.createElement(wW,null);case Ue.Source.Camera:return e?O.createElement(yW,null):O.createElement(vW,null);case Ue.Source.ScreenShare:return e?O.createElement(RW,null):O.createElement(_W,null);default:return}}function DW(n){switch(n){case Is.Excellent:return O.createElement(AW,null);case Is.Good:return O.createElement(kW,null);case Is.Poor:return O.createElement(EW,null);default:return O.createElement(TW,null)}}const bv=O.forwardRef(function({showIcon:n,...e},t){const{buttonProps:r,enabled:i}=aW(e),[o,a]=O.useState(!1);return O.useEffect(()=>{a(!0)},[]),o&&O.createElement("button",{ref:t,...r},(n??!0)&&rR(e.source,i),e.children)}),MW=O.forwardRef(function(n,e){const{className:t,quality:r}=qz(n),i=O.useMemo(()=>({...Ml(n,{className:t}),"data-lk-quality":r}),[r,n,t]);return O.createElement("div",{ref:e,...i},n.children??DW(r))}),NW=O.forwardRef(function({participant:n,...e},t){const r=Qp(n),{className:i,infoObserver:o}=O.useMemo(()=>pz(r),[r]),{identity:a,name:s}=Po(o,{name:r.name,identity:r.identity,metadata:r.metadata}),l=O.useMemo(()=>Ml(e,{className:i,"data-lk-participant-name":s}),[e,i,s]);return O.createElement("span",{ref:t,...l},s!==""?s:a,e.children)}),BW=O.forwardRef(function({trackRef:n,show:e="always",...t},r){const{className:i,isMuted:o}=sW(n),a=e==="always"||e==="muted"&&o||e==="unmuted"&&!o,s=O.useMemo(()=>Ml(t,{className:i}),[i,t]);return a?O.createElement("div",{ref:r,...s,"data-lk-muted":o},t.children??rR(n.source,!o)):null});function OW(n,e={}){const[t,r]=O.useState(Qy(n)),[i,o]=O.useState(t==null?void 0:t.isMuted),[a,s]=O.useState(t==null?void 0:t.isSubscribed),[l,f]=O.useState(t==null?void 0:t.track),[h,m]=O.useState("landscape"),g=O.useRef(),{className:y,trackObserver:C}=O.useMemo(()=>YV(n),[n.participant.sid??n.participant.identity,n.source,qp(n)&&n.publication.trackSid]);return O.useEffect(()=>{const x=C.subscribe(w=>{Dn.debug("update track",w),r(w),o(w==null?void 0:w.isMuted),s(w==null?void 0:w.isSubscribed),f(w==null?void 0:w.track)});return()=>x==null?void 0:x.unsubscribe()},[C]),O.useEffect(()=>{var x,w;return l&&(g.current&&l.detach(g.current),(x=e.element)!=null&&x.current&&!(n.participant.isLocal&&(l==null?void 0:l.kind)==="audio")&&l.attach(e.element.current)),g.current=(w=e.element)==null?void 0:w.current,()=>{g.current&&(l==null||l.detach(g.current))}},[l,e.element]),O.useEffect(()=>{var x,w;if(typeof((x=t==null?void 0:t.dimensions)==null?void 0:x.width)=="number"&&typeof((w=t==null?void 0:t.dimensions)==null?void 0:w.height)=="number"){const S=t.dimensions.width>t.dimensions.height?"landscape":"portrait";m(S)}},[t]),{publication:t,isMuted:i,isSubscribed:a,track:l,elementProps:Ml(e.props,{className:y,"data-lk-local-participant":n.participant.isLocal,"data-lk-source":t==null?void 0:t.source,...(t==null?void 0:t.kind)==="video"&&{"data-lk-orientation":h}})}}var Iv,AA;function FW(){if(AA)return Iv;AA=1;var n="Expected a function",e=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,s=parseInt,l=typeof Oh=="object"&&Oh&&Oh.Object===Object&&Oh,f=typeof self=="object"&&self&&self.Object===Object&&self,h=l||f||Function("return this")(),m=Object.prototype,g=m.toString,y=Math.max,C=Math.min,x=function(){return h.Date.now()};function w(T,M,P){var j,X,L,G,Z,ne,pe=0,ve=!1,Se=!1,Ne=!0;if(typeof T!="function")throw new TypeError(n);M=_(M)||0,S(P)&&(ve=!!P.leading,Se="maxWait"in P,L=Se?y(_(P.maxWait)||0,M):L,Ne="trailing"in P?!!P.trailing:Ne);function xe(Je){var me=j,it=X;return j=X=void 0,pe=Je,G=T.apply(it,me),G}function Ae(Je){return pe=Je,Z=setTimeout(ee,M),ve?xe(Je):G}function ke(Je){var me=Je-ne,it=Je-pe,Tt=M-me;return Se?C(Tt,L-it):Tt}function H(Je){var me=Je-ne,it=Je-pe;return ne===void 0||me>=M||me<0||Se&&it>=L}function ee(){var Je=x();if(H(Je))return ae(Je);Z=setTimeout(ee,ke(Je))}function ae(Je){return Z=void 0,Ne&&j?xe(Je):(j=X=void 0,G)}function ye(){Z!==void 0&&clearTimeout(Z),pe=0,j=ne=X=Z=void 0}function Ee(){return Z===void 0?G:ae(x())}function _e(){var Je=x(),me=H(Je);if(j=arguments,X=this,ne=Je,me){if(Z===void 0)return Ae(ne);if(Se)return Z=setTimeout(ee,M),xe(ne)}return Z===void 0&&(Z=setTimeout(ee,M)),G}return _e.cancel=ye,_e.flush=Ee,_e}function S(T){var M=typeof T;return!!T&&(M=="object"||M=="function")}function A(T){return!!T&&typeof T=="object"}function E(T){return typeof T=="symbol"||A(T)&&g.call(T)==t}function _(T){if(typeof T=="number")return T;if(E(T))return e;if(S(T)){var M=typeof T.valueOf=="function"?T.valueOf():T;T=S(M)?M+"":M}if(typeof T!="string")return T===0?T:+T;T=T.replace(r,"");var P=o.test(T);return P||a.test(T)?s(T.slice(2),P?2:8):i.test(T)?e:+T}return Iv=w,Iv}FW();const LW=O.forwardRef(function({trackRef:n,onSubscriptionStatusChanged:e,volume:t,...r},i){const o=Yp(n),a=O.useRef(null);O.useImperativeHandle(i,()=>a.current);const{elementProps:s,isSubscribed:l,track:f,publication:h}=OW(o,{element:a,props:r});return O.useEffect(()=>{e==null||e(!!l)},[l,e]),O.useEffect(()=>{f===void 0||t===void 0||(f instanceof a2?f.setVolume(t):Dn.warn("Volume can only be set on remote audio tracks."))},[t,f]),O.useEffect(()=>{h===void 0||r.muted===void 0||(h instanceof l2?h.setEnabled(!r.muted):Dn.warn("Can only call setEnabled on remote track publications."))},[r.muted,h,f]),O.createElement("audio",{ref:a,...s})});function UW({tracks:n,...e}){return O.createElement(O.Fragment,null,n.map(t=>O.createElement(w1.Provider,{value:t,key:v1(t)},k1(e.children))))}function jW({value:n,onPinChange:e,onWidgetChange:t,children:r}){const i=Lz(n);return O.useEffect(()=>{Dn.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),O.useEffect(()=>{Dn.debug("Widget Updated",{widgetState:i.widget.state}),t&&i.widget.state&&t(i.widget.state)},[t,i.widget.state]),O.createElement(I1.Provider,{value:i},r)}const GW=n=>{const e=[];for(let t=0;t<n;t++)e.push([t,n-1-t]);return e},kA=n=>[[Math.floor(n/2)],[-1]],VW=(n,e,t)=>{const[r,i]=O.useState(0),[o,a]=O.useState([[]]);O.useEffect(()=>{if(n==="thinking")a(kA(e));else if(n==="connecting"||n==="initializing"){const l=[...GW(e)];a(l)}else a(n==="listening"?kA(e):n===void 0||n==="speaking"?[new Array(e).fill(0).map((l,f)=>f)]:[[]]);i(0)},[n,e]);const s=O.useRef(null);return O.useEffect(()=>{let l=performance.now();const f=h=>{h-l>=t&&(i(m=>m+1),l=h),s.current=requestAnimationFrame(f)};return s.current=requestAnimationFrame(f),()=>{s.current!==null&&cancelAnimationFrame(s.current)}},[t,e,n,o.length]),o[r%o.length]},zW=new Map([["connecting",2e3],["initializing",2e3],["listening",500],["thinking",150]]),WW=(n,e)=>{if(n===void 0)return 1e3;let t=zW.get(n);if(t)switch(n){case"connecting":t/=e;break}return t},HW=O.forwardRef(function({state:n,options:e,barCount:t=15,trackRef:r,children:i,...o},a){const s=Ml(o,{className:"lk-audio-bar-visualizer"});let l=S1();r&&(l=r);const f=gW(l,{bands:t,loPass:100,hiPass:200}),h=(e==null?void 0:e.minHeight)??20,m=(e==null?void 0:e.maxHeight)??100,g=VW(n,t,WW(n,t)??100);return O.createElement("div",{ref:a,...s,"data-lk-va-state":n},f.map((y,C)=>i?k1(i,{"data-lk-highlighted":g.includes(C),"data-lk-bar-index":C,className:"lk-audio-bar",style:{height:`${Math.min(m,Math.max(h,y*100+5))}%`}}):O.createElement("span",{key:C,"data-lk-highlighted":g.includes(C),"data-lk-bar-index":C,className:`lk-audio-bar ${g.includes(C)&&"lk-highlighted"}`,style:{height:`${Math.min(m,Math.max(h,y*100+5))}%`}})))}),ZW=O.forwardRef(function({children:n,disableSpeakingIndicator:e,onParticipantClick:t,trackRef:r,...i},o){const a=Yp(r),{elementProps:s}=nW({trackRef:a,htmlProps:i,disableSpeakingIndicator:e,onParticipantClick:t});return O.createElement("div",{ref:o,style:{position:"relative",minHeight:"160px"},...s},O.createElement(w1.Provider,{value:a},n??O.createElement(O.Fragment,null,qp(a)&&O.createElement(LW,{trackRef:a}),O.createElement(HW,{barCount:7,options:{minHeight:8}}),O.createElement("div",{className:"lk-participant-metadata"},O.createElement("div",{className:"lk-participant-metadata-item"},O.createElement(BW,{trackRef:a}),O.createElement(NW,null)),O.createElement(MW,{className:"lk-participant-metadata-item"})))))}),XW=O.forwardRef(function({entry:n,hideName:e=!1,hideTimestamp:t=!1,messageFormatter:r,...i},o){var a,s,l,f;const h=O.useMemo(()=>r?r(n.message):n.message,[n.message,r]),m=!!n.editTimestamp,g=new Date(n.timestamp),y=typeof navigator<"u"?navigator.language:"en-US",C=((a=n.from)==null?void 0:a.name)??((s=n.from)==null?void 0:s.identity);return O.createElement("li",{ref:o,className:"lk-chat-entry",title:g.toLocaleTimeString(y,{timeStyle:"full"}),"data-lk-message-origin":(l=n.from)!=null&&l.isLocal?"local":"remote",...i},(!t||!e||m)&&O.createElement("span",{className:"lk-meta-data"},!e&&O.createElement("strong",{className:"lk-participant-name"},C),(!t||m)&&O.createElement("span",{className:"lk-timestamp"},m&&"edited ",g.toLocaleTimeString(y,{timeStyle:"short"}))),O.createElement("span",{className:"lk-message-body"},h),O.createElement("span",{className:"lk-message-attachements"},(f=n.attachedFiles)==null?void 0:f.map(x=>x.type.startsWith("image/")&&O.createElement("img",{style:{maxWidth:"300px",maxHeight:"300px"},key:x.name,src:URL.createObjectURL(x),alt:x.name}))))});function $W({messageFormatter:n,messageDecoder:e,messageEncoder:t,channelTopic:r,...i}){const o=O.useRef(null),a=O.useRef(null),s=O.useMemo(()=>({messageDecoder:e,messageEncoder:t,channelTopic:r}),[e,t,r]),{chatMessages:l,send:f,isSending:h}=dW(s),m=Q2(),g=O.useRef(0);async function y(C){C.preventDefault(),a.current&&a.current.value.trim()!==""&&(await f(a.current.value),a.current.value="",a.current.focus())}return O.useEffect(()=>{var C;o&&((C=o.current)==null||C.scrollTo({top:o.current.scrollHeight}))},[o,l]),O.useEffect(()=>{var C,x,w,S,A;if(!m||l.length===0)return;if((C=m.widget.state)!=null&&C.showChat&&l.length>0&&g.current!==((x=l[l.length-1])==null?void 0:x.timestamp)){g.current=(w=l[l.length-1])==null?void 0:w.timestamp;return}const E=l.filter(T=>!g.current||T.timestamp>g.current).length,{widget:_}=m;E>0&&((S=_.state)==null?void 0:S.unreadMessages)!==E&&((A=_.dispatch)==null||A.call(_,{msg:"unread_msg",count:E}))},[l,m==null?void 0:m.widget]),O.createElement("div",{...i,className:"lk-chat"},O.createElement("div",{className:"lk-chat-header"},"Messages",m&&O.createElement(nR,{className:"lk-close-button"},O.createElement(CW,null))),O.createElement("ul",{className:"lk-list lk-chat-messages",ref:o},i.children?l.map((C,x)=>k1(i.children,{entry:C,key:C.id??x,messageFormatter:n})):l.map((C,x,w)=>{const S=x>=1&&w[x-1].from===C.from,A=x>=1&&C.timestamp-w[x-1].timestamp<6e4;return O.createElement(XW,{key:C.id??x,hideName:S,hideTimestamp:S===!1?!1:A,entry:C,messageFormatter:n})})),O.createElement("form",{className:"lk-chat-form",onSubmit:y},O.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:h,ref:a,type:"text",placeholder:"Enter a message...",onInput:C=>C.stopPropagation(),onKeyDown:C=>C.stopPropagation(),onKeyUp:C=>C.stopPropagation()}),O.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:h},"Send")))}function EA({kind:n,initialSelection:e,onActiveDeviceChange:t,tracks:r,requestPermissions:i=!1,...o}){const[a,s]=O.useState(!1),[l,f]=O.useState([]),[h,m]=O.useState(!0),[g,y]=O.useState(i),C=(A,E)=>{Dn.debug("handle device change"),s(!1),t==null||t(A,E)},x=O.useRef(null),w=O.useRef(null);O.useLayoutEffect(()=>{a&&y(!0)},[a]),O.useLayoutEffect(()=>{let A;return x.current&&w.current&&(l||h)&&(A=zV(x.current,w.current,(E,_)=>{w.current&&Object.assign(w.current.style,{left:`${E}px`,top:`${_}px`})})),m(!1),()=>{A==null||A()}},[x,w,l,h]);const S=O.useCallback(A=>{w.current&&A.target!==x.current&&a&&WV(w.current,A)&&s(!1)},[a,w,x]);return O.useEffect(()=>(document.addEventListener("click",S),()=>{document.removeEventListener("click",S)}),[S]),O.createElement(O.Fragment,null,O.createElement("button",{className:"lk-button lk-button-menu","aria-pressed":a,...o,onClick:()=>s(!a),ref:x},o.children),!o.disabled&&O.createElement("div",{className:"lk-device-menu",ref:w,style:{visibility:a?"visible":"hidden"}},n?O.createElement(xv,{initialSelection:e,onActiveDeviceChange:A=>C(n,A),onDeviceListChange:f,kind:n,track:r==null?void 0:r[n],requestPermissions:g}):O.createElement(O.Fragment,null,O.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),O.createElement(xv,{kind:"audioinput",onActiveDeviceChange:A=>C("audioinput",A),onDeviceListChange:f,track:r==null?void 0:r.audioinput,requestPermissions:g}),O.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),O.createElement(xv,{kind:"videoinput",onActiveDeviceChange:A=>C("videoinput",A),onDeviceListChange:f,track:r==null?void 0:r.videoinput,requestPermissions:g}))))}function KW(){O.useEffect(()=>{Wz()},[])}function qW({props:n}){const{dispatch:e,state:t}=Y2().widget,r="lk-button lk-settings-toggle";return{mergedProps:O.useMemo(()=>La(n,{className:r,onClick:()=>{e&&e({msg:"toggle_settings"})},"aria-pressed":t!=null&&t.showSettings?"true":"false"}),[n,r,e,t])}}const YW=O.forwardRef(function(n,e){const{mergedProps:t}=qW({props:n});return O.createElement("button",{ref:e,...t},n.children)}),QW=n=>{switch(n){case Ue.Source.Camera:return 1;case Ue.Source.Microphone:return 2;case Ue.Source.ScreenShare:return 3;default:return 0}};function JW({variation:n,controls:e,saveUserChoices:t=!0,onDeviceError:r,...i}){var o;const[a,s]=O.useState(!1),l=Q2();O.useEffect(()=>{var X,L;((X=l==null?void 0:l.widget.state)==null?void 0:X.showChat)!==void 0&&s((L=l==null?void 0:l.widget.state)==null?void 0:L.showChat)},[(o=l==null?void 0:l.widget.state)==null?void 0:o.showChat]);const f=Kz(`(max-width: ${a?1e3:760}px)`)?"minimal":"verbose";n??(n=f);const h={leave:!0,...e},m=eW();if(!m)h.camera=!1,h.chat=!1,h.microphone=!1,h.screenShare=!1;else{const X=L=>m.canPublish&&(m.canPublishSources.length===0||m.canPublishSources.includes(QW(L)));h.camera??(h.camera=X(Ue.Source.Camera)),h.microphone??(h.microphone=X(Ue.Source.Microphone)),h.screenShare??(h.screenShare=X(Ue.Source.ScreenShare)),h.chat??(h.chat=m.canPublishData&&(e==null?void 0:e.chat))}const g=O.useMemo(()=>n==="minimal"||n==="verbose",[n]),y=O.useMemo(()=>n==="textOnly"||n==="verbose",[n]),C=$V(),[x,w]=O.useState(!1),S=O.useCallback(X=>{w(X)},[w]),A=Ml({className:"lk-control-bar"},i),{saveAudioInputEnabled:E,saveVideoInputEnabled:_,saveAudioInputDeviceId:T,saveVideoInputDeviceId:M}=fW({preventSave:!t}),P=O.useCallback((X,L)=>L?E(X):null,[E]),j=O.useCallback((X,L)=>L?_(X):null,[_]);return O.createElement("div",{...A},h.microphone&&O.createElement("div",{className:"lk-button-group"},O.createElement(bv,{source:Ue.Source.Microphone,showIcon:g,onChange:P,onDeviceError:X=>r==null?void 0:r({source:Ue.Source.Microphone,error:X})},y&&"Microphone"),O.createElement("div",{className:"lk-button-group-menu"},O.createElement(EA,{kind:"audioinput",onActiveDeviceChange:(X,L)=>T(L??"default")}))),h.camera&&O.createElement("div",{className:"lk-button-group"},O.createElement(bv,{source:Ue.Source.Camera,showIcon:g,onChange:j,onDeviceError:X=>r==null?void 0:r({source:Ue.Source.Camera,error:X})},y&&"Camera"),O.createElement("div",{className:"lk-button-group-menu"},O.createElement(EA,{kind:"videoinput",onActiveDeviceChange:(X,L)=>M(L??"default")}))),h.screenShare&&C&&O.createElement(bv,{source:Ue.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:g,onChange:S,onDeviceError:X=>r==null?void 0:r({source:Ue.Source.ScreenShare,error:X})},y&&(x?"Stop screen share":"Share screen")),h.chat&&O.createElement(nR,null,g&&O.createElement(xW,null),y&&"Chat"),h.settings&&O.createElement(YW,null,g&&O.createElement(bW,null),y&&"Settings"),h.leave&&O.createElement(mW,null,g&&O.createElement(IW,null),y&&"Leave"),O.createElement(PW,null))}function eH({...n}){const[e,t]=O.useState({showChat:!1,unreadMessages:0}),r=cW([Ue.Source.Microphone]);return KW(),O.createElement(jW,{onWidgetChange:t},O.createElement("div",{className:"lk-audio-conference",...n},O.createElement("div",{className:"lk-audio-conference-stage"},O.createElement(UW,{tracks:r},O.createElement(ZW,null))),O.createElement(JW,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),e.showChat&&O.createElement($W,null)))}const tH="wss://mongoose-67t79p35.livekit.cloud",nH=({client:n})=>{const[e,t]=O.useState([]),[r,i]=O.useState(!1);return O.useEffect(()=>{const o=s=>{t(l=>[...l,s]),i(!0)},a=s=>{t(l=>{const f=l.filter(h=>h!==s);return f.length===0&&i(!1),f})};return n.on("livekitToken",o),n.on("livekitLeave",a),()=>{n.off("livekitToken",o),n.off("livekitLeave",a)}},[n]),e.length?K.jsxs("div",{"data-lk-theme":"default",children:[e.map((o,a)=>K.jsx($z,{video:!1,audio:!0,token:o,serverUrl:tH,connect:!0,onDisconnected:()=>n.emit("livekitLeave",o),children:K.jsx(eH,{})},a)),K.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null},Ep=({items:n,renderItem:e,listId:t,labelledBy:r,className:i="",itemClassName:o,getItemTextValue:a=l=>(l.name||l.id||"").toString().toLowerCase(),onSelectedIndexChange:s})=>{var C;const[l,f]=O.useState(-1),h=O.useRef(null),m=O.useCallback(x=>{f(x),s&&s(x)},[s]),g=()=>{l===-1&&n.length>0&&m(0)};O.useEffect(()=>{var x;if(l>=n.length&&m(n.length>0?0:-1),l!==-1&&n[l]){const w=`${t}-item-${(x=n[l])==null?void 0:x.id}`,S=document.getElementById(w);S&&S.scrollIntoView({block:"nearest"})}},[l,n,t]);const y=O.useCallback(x=>{if(n.length===0)return;let w=l,S=!0;switch(x.key){case"ArrowDown":w=(l+1)%n.length;break;case"ArrowUp":w=(l-1+n.length)%n.length;break;case"Home":w=0;break;case"End":w=n.length-1;break;case"PageUp":w=Math.max(l-5,0);break;case"PageDown":w=Math.min(l+5,n.length-1);break;default:if(x.key.length===1&&!x.ctrlKey&&!x.metaKey&&!x.altKey){const A=x.key.toLowerCase();let E=l===-1?0:(l+1)%n.length,_=-1;for(let T=0;T<n.length;T++){const M=(E+T)%n.length;if(a(n[M]).startsWith(A)){_=M;break}}_!==-1?w=_:S=!1}else S=!1;break}w!==l&&m(w),S&&x.preventDefault()},[l,n,a]);return K.jsx("div",{id:t,className:`accessible-list-container ${i}`,ref:h,tabIndex:0,role:"listbox","aria-labelledby":r,"aria-activedescendant":l!==-1?`${t}-item-${(C=n[l])==null?void 0:C.id}`:void 0,onFocus:g,onKeyDown:y,children:K.jsx("ul",{role:"none",className:"accessible-list-ul",children:n.map((x,w)=>{const S=w===l,A=e(x,w,S),E=o?o(x,w,S):"";return K.jsx("li",{id:`${t}-item-${x.id}`,className:`${E} ${S?"selected":""}`,role:"option","aria-selected":S,onClick:()=>m(w),children:A},x.id)})})})},rH=n=>({...n,id:n.Object}),iH=({users:n})=>{const e=n.map(rH),t=(o,a,s)=>{let l="Online";return o.away&&(l="Away"),o.idle&&(l==="Online"?l="Idle":l+=" + Idle"),K.jsxs(K.Fragment,{children:[o.Name,K.jsxs("span",{className:"sr-only",children:["",`(${l})`]})]})},r=(o,a,s)=>{let l="userlist-item";return o.away&&(l+=" away"),o.idle&&(l+=" idle"),l},i=o=>o.Name?o.Name.toLowerCase():"";return K.jsxs(K.Fragment,{children:[K.jsx("div",{className:"sidebar-header",id:"userlist-header","aria-hidden":"true",children:"Connected Players"}),K.jsxs("div",{className:"sidebar",children:[" ",K.jsxs("div",{className:"sidebar-content",children:[" ",K.jsx(Ep,{items:e,renderItem:t,listId:"userlist",labelledBy:"userlist-header",className:"userlist-accessible-container",itemClassName:r,getItemTextValue:i})]})]})]})},oH=({items:n,onItemSelected:e,listId:t,labelledBy:r})=>{const i=l=>{l>-1&&n[l]?e(n[l]):e(null)},o=(l,f,h)=>K.jsxs("span",{children:[" ",l.name]}),a=(l,f,h)=>"inventory-list-li",s=l=>l.name?l.name.toLowerCase():"";return K.jsx(Ep,{items:n,renderItem:o,listId:t,labelledBy:r,className:"inventory-accessible-list",itemClassName:a,getItemTextValue:s,onSelectedIndexChange:i})},iR=({item:n,onDrop:e,onWear:t,onRemove:r,onGet:i})=>{var h,m;const o=n.name,a=(h=n.Attrib)==null?void 0:h.includes("W"),s=(m=n.Attrib)==null?void 0:m.includes("w"),l=g=>{g.stopPropagation(),e&&e(n)},f=g=>{g.stopPropagation(),i&&i(n)};return K.jsxs("div",{className:"item-card",title:o,"data-item-id":n.id,children:[n.icon&&K.jsx("img",{src:n.icon,alt:"",className:"item-icon"}),K.jsxs("div",{className:"item-details",children:[" ",K.jsx("div",{className:"item-name",children:n.name})]}),K.jsxs("div",{className:"item-actions",children:[n.location==="room"&&i&&K.jsx("button",{className:"item-get-button",onClick:f,"aria-label":`Get ${n.name}`,tabIndex:0,accessKey:"g",children:"Get"}),n.location==="inv"&&a&&!s&&t&&K.jsx("button",{className:"item-wear-button",onClick:()=>t(n),"aria-label":`Wear ${n.name}`,tabIndex:0,accessKey:"w",children:"Wear"}),n.location==="inv"&&s&&r&&K.jsx("button",{className:"item-remove-button",onClick:()=>r(n),"aria-label":`Remove ${n.name}`,tabIndex:0,accessKey:"r",children:"Remove"}),n.location==="inv"&&e&&K.jsx("button",{className:"item-drop-button",onClick:l,"aria-label":`Drop ${n.name}`,tabIndex:0,accessKey:"d"})]})]})},sH=({client:n})=>{const[e,t]=O.useState([]),[r,i]=O.useState(null),o=O.useCallback((x,w)=>{x==="inv"&&(t(w),(w.length===0||!w.find(S=>S.id===(r==null?void 0:r.id)))&&i(null),n.emit("inventoryDataReceived"))},[n,r==null?void 0:r.id]),a=O.useCallback((x,w)=>{x==="inv"&&t(S=>{if(S.some(E=>E.id===w.id))return S;const A=[...S,w];return n.emit("inventoryDataReceived"),A})},[n]),s=O.useCallback((x,w)=>{x==="inv"&&t(S=>{const A=S.filter(E=>E.id!==w.id);return A.length<S.length&&n.emit("inventoryDataReceived"),(r==null?void 0:r.id)===w.id&&i(null),A})},[n,r==null?void 0:r.id]),l=O.useCallback((x,w)=>{x==="inv"&&(t(S=>S.map(A=>A.id===w.id?{...A,...w}:A)),(r==null?void 0:r.id)===w.id&&i(S=>S?{...S,...w}:null),n.emit("inventoryDataReceived"))},[n,r==null?void 0:r.id]);O.useEffect(()=>{const x=_=>o(_.location,_.items),w=_=>a(_.location,_.item),S=_=>s(_.location,_.item),A=_=>l(_.location,_.item);n.on("itemsList",x),n.on("itemAdd",w),n.on("itemRemove",S),n.on("itemUpdate",A);const E=n.gmcpHandlers["Char.Items"];return E!=null&&E.sendInventoryRequest&&E.sendInventoryRequest(),()=>{n.off("itemsList",x),n.off("itemAdd",w),n.off("itemRemove",S),n.off("itemUpdate",A)}},[n,o,a,s,l]);const f=x=>{i(x)},h=O.useCallback(x=>{n.sendCommand(`drop ${x.id}`)},[n]),m=O.useCallback(x=>{n.sendCommand(`wear ${x.id}`)},[n]),g=O.useCallback(x=>{n.sendCommand(`remove ${x.id}`)},[n]),y="inventory-heading";return K.jsxs("div",{className:"inventory-tab-content",role:"region","aria-labelledby":y,children:[K.jsx("h4",{id:y,tabIndex:-1,children:"Inventory"}),e.length===0?K.jsx("p",{children:"Your inventory is empty."}):K.jsx(oH,{items:e,onItemSelected:f,listId:"inventory-listbox",labelledBy:y}),r&&K.jsx("div",{className:"selected-item-card-container",style:{marginTop:"1rem"},children:K.jsx(iR,{item:r,onDrop:h,onWear:m,onRemove:g})})]})};function ff(n,e,t){const[r,i]=O.useState(t);return O.useEffect(()=>{if(!n)return i(t),()=>{};const o=a=>{i(a)};return n.on(e,o),()=>{n.off(e,o)}},[n,e,t]),r}const aH=({player:n,onLook:e,onFollow:t})=>{const r=s=>{s.stopPropagation(),fI(`page ${n.name} `)},i=s=>{s.stopPropagation(),fI(`-${n.name} `)},o=s=>{s.stopPropagation(),e(n)},a=s=>{s.stopPropagation(),t(n)};return K.jsxs("div",{className:"player-card",title:n.fullname,"data-player-name":n.name,children:[K.jsx("div",{className:"player-details",children:K.jsx("div",{className:"player-name",children:n.fullname})}),K.jsxs("div",{className:"player-actions",children:[K.jsx("button",{className:"player-page-button",onClick:r,"aria-label":`Page ${n.fullname}`,tabIndex:0,accessKey:"p",children:"Page"}),K.jsx("button",{className:"player-sayto-button",onClick:i,"aria-label":`Say to ${n.fullname} (using -${n.name})`,title:`Say to ${n.fullname} (uses -${n.name} command)`,tabIndex:0,accessKey:"s",children:"Say To"}),K.jsx("button",{className:"player-look-button",onClick:o,"aria-label":`Look at ${n.fullname}`,tabIndex:0,accessKey:"l",children:"Look"}),K.jsx("button",{className:"player-follow-button",onClick:a,"aria-label":`Follow ${n.fullname}`,tabIndex:0,accessKey:"f",children:"Follow"})]})]})},cH=({client:n})=>{const[e,t]=O.useState(n.currentRoomInfo),[r,i]=O.useState([]),[o,a]=O.useState(null),[s,l]=O.useState(n.worldData.roomPlayers||[]),[f,h]=O.useState(null),m=n.gmcpHandlers["Char.Items"],g=O.useCallback((ae,ye)=>ye.some(Ee=>ae.name.toLowerCase()===Ee.fullname.toLowerCase()),[]),y=O.useMemo(()=>r.filter(ae=>!g(ae,s)),[r,s,g]),C=O.useCallback(ae=>{t(ae)},[]);O.useEffect(()=>(n.on("roomInfo",C),m!=null&&m.sendRoomRequest&&m.sendRoomRequest(),()=>{n.off("roomInfo",C)}),[n,m,C]);const x=O.useCallback((ae,ye)=>{ae==="room"&&(i(ye),o&&!ye.find(Ee=>Ee.id===o.id)&&a(null))},[o]),w=O.useCallback((ae,ye)=>{ae==="room"&&i(Ee=>Ee.some(_e=>_e.id===ye.id)?Ee:[...Ee,ye])},[]),S=O.useCallback((ae,ye)=>{ae==="room"&&(i(Ee=>Ee.filter(_e=>_e.id!==ye.id)),(o==null?void 0:o.id)===ye.id&&a(null))},[o]);O.useEffect(()=>{const ae=_e=>x(_e.location,_e.items),ye=_e=>w(_e.location,_e.item),Ee=_e=>S(_e.location,_e.item);return n.on("itemsList",ae),n.on("itemAdd",ye),n.on("itemRemove",Ee),()=>{n.off("itemsList",ae),n.off("itemAdd",ye),n.off("itemRemove",Ee)}},[n,x,w,S]);const A=O.useCallback(ae=>{l(ae),f&&!ae.find(ye=>ye.name===f.name)&&h(null)},[f]),E=O.useCallback(ae=>{l(ye=>ye.some(Ee=>Ee.name===ae.name)?ye:[...ye,ae])},[]),_=O.useCallback(ae=>{l(ye=>ye.filter(Ee=>Ee.name!==ae)),(f==null?void 0:f.name)===ae&&h(null)},[f]);O.useEffect(()=>(n.on("roomPlayers",A),n.on("roomAddPlayer",E),n.on("roomRemovePlayer",_),()=>{n.off("roomPlayers",A),n.off("roomAddPlayer",E),n.off("roomRemovePlayer",_)}),[n,A,E,_]);const T=ae=>{n.sendCommand(ae)},M=ae=>{a(ae>-1&&y[ae]?y[ae]:null)},P=O.useCallback(ae=>{n.sendCommand(`get ${ae.id}`)},[n]),j=ae=>{h(ae>-1&&s[ae]?s[ae]:null)},X=O.useCallback(ae=>{n.sendCommand(`look ${ae.name}`)},[n]),L=O.useCallback(ae=>{n.sendCommand(`follow ${ae.name}`)},[n]),G=ae=>K.jsx("span",{children:ae.name}),Z=()=>"room-item-li",ne=ae=>ae.name.toLowerCase(),pe=ae=>K.jsx("span",{children:ae.fullname}),ve=()=>"room-player-li",Se=ae=>ae.fullname.toLowerCase(),Ne="room-info-heading",xe="room-contents-heading",Ae="room-contents-list",ke="room-players-heading",H="room-players-list";if(!e&&y.length===0)return K.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":Ne,children:[K.jsx("h4",{id:Ne,children:"Room Info"}),K.jsx("p",{children:"Waiting for room data..."})]});const ee=e!=null&&e.exits?Object.entries(e.exits).sort(([ae],[ye])=>ae.localeCompare(ye)):[];return K.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":Ne,children:[e&&K.jsxs(K.Fragment,{children:[K.jsx("h4",{id:Ne,children:e.name||"Current Room"}),e.area&&K.jsxs("p",{className:"room-area",children:["Area: ",e.area]}),ee.length>0&&K.jsxs("div",{className:"room-exits",children:[K.jsx("h5",{children:"Exits"}),K.jsx("ul",{"aria-label":"Room Exits",children:ee.map(([ae,ye])=>K.jsx("li",{children:K.jsx("button",{onClick:()=>T(ae),title:`Go ${ae} (to room ${ye})`,"aria-label":`Go ${ae}`,children:ae.toUpperCase()})},ae))})]})]}),K.jsxs("div",{className:"room-contents-section",children:[K.jsx("h5",{id:xe,tabIndex:-1,children:"Contents"}),y.length===0?K.jsx("p",{children:"Nothing on the ground."}):K.jsx(Ep,{items:y,renderItem:G,listId:Ae,labelledBy:xe,className:"room-items-accessible-list",itemClassName:Z,getItemTextValue:ne,onSelectedIndexChange:M})]}),o&&K.jsx("div",{className:"selected-room-item-card-container",style:{marginTop:"1rem"},children:K.jsx(iR,{item:o,onGet:P})}),K.jsxs("div",{className:"room-players-section",children:[K.jsx("h5",{id:ke,tabIndex:-1,children:"Players in Room"}),s.length===0?K.jsx("p",{children:"No other players here."}):K.jsx(Ep,{items:s.map(ae=>({...ae,id:ae.name})),renderItem:pe,listId:H,labelledBy:ke,className:"room-players-accessible-list",itemClassName:ve,getItemTextValue:Se,onSelectedIndexChange:j})]}),f&&K.jsx("div",{className:"selected-player-card-container",style:{marginTop:"1rem"},children:K.jsx(aH,{player:f,onLook:X,onFollow:L})})]})},lH=({client:n})=>{const[e]=Do(),[t,r]=O.useState(null),[i,o]=O.useState([]),[a,s]=O.useState([]),[l,f]=O.useState(""),[h,m]=O.useState(""),[g,y]=O.useState(en.connectionStatus),[C,x]=O.useState([]),[w,S]=O.useState({}),[A,E]=O.useState(60),[_,T]=O.useState(64),[M,P]=O.useState(!0),[j,X]=O.useState(0),[L,G]=O.useState(!1),[Z,ne]=O.useState(1e3),[pe,ve]=O.useState([]);O.useEffect(()=>{const me=n.gmcpHandlers["Client.Midi"];me&&r(me)},[n]);const Se=async()=>{if(!e.midi.enabled)return;Hs.initialized||await Hs.initialize();const me=en.getInputDevices(),it=en.getOutputDevices();o(me),s(it),y(en.connectionStatus),await Ne()},Ne=async()=>{const me=lr.getState().midi,it=en.intentionalDisconnectStatus,Tt={};if(me.lastInputDeviceId&&!g.inputConnected){const Xt=i.find(Et=>Et.id===me.lastInputDeviceId);if(Xt&&en.canReconnectToDevice(me.lastInputDeviceId,"input"))if(Tt.input=Xt,t&&!it.input)try{if(await t.connectInputDevice(me.lastInputDeviceId)){y(en.connectionStatus),x(St=>[{timestamp:new Date().toLocaleTimeString(),message:`Auto-reconnected to input: ${Xt.name}`,type:"reconnect"},...St].slice(0,10));return}}catch(Et){console.error("Error during input auto-reconnection:",Et)}else it.input&&console.log("Skipping input auto-reconnect due to intentional disconnect")}if(me.lastOutputDeviceId&&!g.outputConnected){const Xt=a.find(Et=>Et.id===me.lastOutputDeviceId);if(Xt&&en.canReconnectToDevice(me.lastOutputDeviceId,"output"))if(Tt.output=Xt,t&&!it.output)try{if(await t.connectOutputDevice(me.lastOutputDeviceId)){y(en.connectionStatus),x(St=>[{timestamp:new Date().toLocaleTimeString(),message:`Auto-reconnected to output: ${Xt.name}`,type:"reconnect"},...St].slice(0,10));return}}catch(Et){console.error("Error during output auto-reconnection:",Et)}else it.output&&console.log("Skipping output auto-reconnect due to intentional disconnect")}S(Tt)};O.useEffect(()=>{if(e.midi.enabled){!en.isInitialized&&t?t.ensureInitialized().then(()=>{Se()}):Se();const me=setInterval(()=>{Se();const Tt=en.connectionStatus;JSON.stringify(Tt)!==JSON.stringify(g)&&y(Tt)},2e3),it=en.onDeviceChange(Tt=>{const Xt=new Date().toLocaleTimeString(),Et=[];Tt.inputs.added.forEach(St=>{Et.push({timestamp:Xt,message:`Input device connected: ${St.name}`,type:"connected"})}),Tt.outputs.added.forEach(St=>{Et.push({timestamp:Xt,message:`Output device connected: ${St.name}`,type:"connected"})}),Tt.inputs.removed.forEach(St=>{Et.push({timestamp:Xt,message:`Input device disconnected: ${St.name}`,type:"disconnected"})}),Tt.outputs.removed.forEach(St=>{Et.push({timestamp:Xt,message:`Output device disconnected: ${St.name}`,type:"disconnected"})}),Et.length>0&&x(St=>[...Et,...St].slice(0,10)),Se()});return()=>{clearInterval(me),it()}}else o([]),s([]),y({inputConnected:!1,outputConnected:!1}),S({})},[e.midi.enabled,en.isInitialized]),O.useEffect(()=>{Ne()},[g,i,a,t]);const xe=async()=>{if(!t||!l)return;await t.connectInputDevice(l)&&(y(en.connectionStatus),f(""),Se())},Ae=()=>{en.disconnectWithIntent("input"),y(en.connectionStatus),Se()},ke=async()=>{if(!t||!h)return;await t.connectOutputDevice(h)&&(y(en.connectionStatus),m(""),Se())},H=()=>{en.disconnectWithIntent("output"),y(en.connectionStatus),Se()},ee=async()=>{en.refresh(),Hs.initialized||await Hs.initialize(),Se(),y(en.connectionStatus)},ae=async()=>{if(!w.input||!t)return;await en.attemptReconnect(w.input.id,"input")&&(y(en.connectionStatus),Se(),x(it=>[{timestamp:new Date().toLocaleTimeString(),message:`Reconnected to input: ${w.input.name}`,type:"reconnect"},...it].slice(0,10)))},ye=async()=>{if(!w.output||!t)return;await en.attemptReconnect(w.output.id,"output")&&(y(en.connectionStatus),Se(),x(it=>[{timestamp:new Date().toLocaleTimeString(),message:`Reconnected to output: ${w.output.name}`,type:"reconnect"},...it].slice(0,10)))};O.useEffect(()=>{if(t)return t.setDebugCallback((me,it,Tt)=>{const Xt=new Date().toLocaleTimeString(),Et={hex:me,type:it,gmcp:Tt,timestamp:Xt};ve(St=>[Et,...St].slice(0,15))}),()=>{t.setDebugCallback(()=>{})}},[t]);const Ee=()=>{t&&t.sendAllNotesOff()},_e=()=>{if(!t)return;const me=L&&M?Z:void 0;t.sendManualNote(A,_,M,j,me)},Je=me=>{const it=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Tt=Math.floor(me/12)-1;return`${it[me%12]}${Tt}`};return e.midi.enabled?K.jsxs("div",{style:{padding:"10px"},children:[K.jsx("h3",{children:"MIDI Status"}),K.jsxs("div",{style:{marginBottom:"15px"},children:[K.jsx("div",{style:{marginBottom:"8px"},children:K.jsx("strong",{children:"Input Device:"})}),g.inputConnected?K.jsxs("div",{style:{marginBottom:"8px"},children:[K.jsxs("span",{style:{color:"green"},children:[" ",g.inputDeviceName]}),K.jsx("button",{onClick:Ae,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em"},children:"Disconnect"})]}):K.jsxs("div",{style:{marginBottom:"8px"},children:[w.input&&K.jsxs("div",{style:{marginBottom:"8px",padding:"8px",backgroundColor:"#e3f2fd",border:"1px solid #2196F3",borderRadius:"4px"},children:[K.jsx("div",{style:{fontSize:"0.9em",marginBottom:"5px"},children:K.jsx("span",{style:{color:"#1976D2"},children:" Last used device available:"})}),K.jsxs("div",{children:[K.jsx("span",{children:w.input.name}),K.jsx("button",{onClick:ae,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"},children:"Reconnect"})]})]}),i.length===0?K.jsx("span",{style:{color:"#666",fontSize:"0.9em"},children:"No input devices found"}):K.jsxs(K.Fragment,{children:[K.jsxs("select",{value:l,onChange:me=>f(me.target.value),style:{marginRight:"10px"},children:[K.jsx("option",{value:"",children:"Select input device..."}),i.map(me=>K.jsx("option",{value:me.id,children:me.name},me.id))]}),K.jsx("button",{onClick:xe,disabled:!l,style:{padding:"2px 8px",fontSize:"0.8em",marginRight:"5px"},children:"Connect"})]})]})]}),K.jsxs("div",{style:{marginBottom:"15px"},children:[K.jsx("div",{style:{marginBottom:"8px"},children:K.jsx("strong",{children:"Output Device:"})}),g.outputConnected?K.jsxs("div",{style:{marginBottom:"8px"},children:[K.jsxs("span",{style:{color:"green"},children:[" ",g.outputDeviceName]}),K.jsx("button",{onClick:H,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em"},children:"Disconnect"})]}):K.jsxs("div",{style:{marginBottom:"8px"},children:[w.output&&K.jsxs("div",{style:{marginBottom:"8px",padding:"8px",backgroundColor:"#e8f5e8",border:"1px solid #4CAF50",borderRadius:"4px"},children:[K.jsx("div",{style:{fontSize:"0.9em",marginBottom:"5px"},children:K.jsx("span",{style:{color:"#2E7D32"},children:" Last used device available:"})}),K.jsxs("div",{children:[K.jsx("span",{children:w.output.name}),K.jsx("button",{onClick:ye,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"},children:"Reconnect"})]})]}),a.length===0?K.jsx("span",{style:{color:"#666",fontSize:"0.9em"},children:"No output devices found"}):K.jsxs(K.Fragment,{children:[K.jsxs("select",{value:h,onChange:me=>m(me.target.value),style:{marginRight:"10px"},children:[K.jsx("option",{value:"",children:"Select output device..."}),a.map(me=>K.jsx("option",{value:me.id,children:me.name},me.id))]}),K.jsx("button",{onClick:ke,disabled:!h,style:{padding:"2px 8px",fontSize:"0.8em",marginRight:"5px"},children:"Connect"})]})]})]}),K.jsx("div",{style:{marginBottom:"15px"},children:K.jsx("button",{onClick:ee,style:{padding:"4px 12px",fontSize:"0.8em"},children:"Refresh Devices"})}),K.jsx("div",{style:{marginBottom:"15px"},children:K.jsx("button",{onClick:Ee,children:"All Notes Off"})}),K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"Manual Note Controls"})}),K.jsxs("div",{style:{padding:"10px 0"},children:[K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Note:"})," ",K.jsx("input",{type:"number",min:"0",max:"127",value:A,onChange:me=>E(parseInt(me.target.value)),style:{width:"60px",marginRight:"10px"}}),K.jsxs("span",{style:{fontSize:"0.9em",color:"#666"},children:["(",Je(A),")"]})]})}),K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Velocity:"})," ",K.jsx("input",{type:"range",min:"1",max:"127",value:_,onChange:me=>T(parseInt(me.target.value)),style:{width:"100px",marginRight:"10px"}}),K.jsx("span",{style:{fontSize:"0.9em"},children:_})]})}),K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Channel:"})," ",K.jsx("select",{value:j,onChange:me=>X(parseInt(me.target.value)),style:{marginRight:"10px"},children:Array.from({length:16},(me,it)=>K.jsx("option",{value:it,children:it+1},it))})]})}),K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:L,onChange:me=>G(me.target.checked),style:{marginRight:"8px"}}),K.jsx("strong",{children:"Use Duration"})," (auto Note Off)"]})}),L?K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Duration:"})," ",K.jsx("input",{type:"number",min:"100",max:"10000",step:"100",value:Z,onChange:me=>ne(parseInt(me.target.value)),style:{width:"80px",marginRight:"10px"}}),K.jsx("span",{style:{fontSize:"0.9em",color:"#666"},children:"ms"})]})}):K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:M,onChange:me=>P(me.target.checked),style:{marginRight:"8px"}}),K.jsx("strong",{children:"Note On"})," (unchecked = Note Off)"]})}),K.jsx("div",{style:{marginBottom:"15px"},children:K.jsx("button",{onClick:_e,style:{padding:"8px 16px",backgroundColor:L?"#2196F3":M?"#4CAF50":"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:L?`Send Note (${Z}ms duration)`:`Send ${M?"Note On":"Note Off"} to Server`})})]})]}),C.length>0&&K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"Device Connection Events"})}),K.jsx("div",{style:{padding:"10px 0"},children:K.jsx("div",{style:{maxHeight:"200px",overflow:"auto",fontFamily:"monospace",fontSize:"0.8em",backgroundColor:"#f9f9f9",padding:"10px",border:"1px solid #ddd",marginBottom:"15px"},children:C.map((me,it)=>K.jsxs("div",{style:{marginBottom:"5px",paddingBottom:"5px",borderBottom:it<C.length-1?"1px solid #eee":"none",color:me.type==="connected"?"#2E7D32":me.type==="disconnected"?"#D32F2F":"#1976D2"},children:[K.jsx("span",{style:{color:"#666"},children:me.timestamp})," - ",me.message]},it))})})]}),K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"MIDI Debug Monitor"})}),K.jsx("div",{style:{padding:"10px 0"},children:K.jsxs("div",{style:{maxHeight:"300px",overflow:"auto",fontFamily:"monospace",fontSize:"0.8em",backgroundColor:"#f5f5f5",padding:"10px",border:"1px solid #ddd",marginBottom:"15px"},children:[pe.length===0?K.jsx("div",{style:{color:"#999"},children:"No MIDI messages received yet"}):pe.map((me,it)=>K.jsxs("div",{style:{marginBottom:"8px",paddingBottom:"8px",borderBottom:it<pe.length-1?"1px solid #ddd":"none"},children:[K.jsxs("div",{children:[K.jsx("strong",{children:"MIDI:"})," ",me.hex," (",me.type,") ",K.jsx("span",{style:{color:"#666",fontSize:"0.9em"},children:me.timestamp})]}),K.jsxs("div",{children:[K.jsx("strong",{children:"GMCP:"})," ",me.gmcp]})]},it)),K.jsx("div",{style:{marginTop:"10px",color:"#666",fontSize:"0.9em",borderTop:"1px solid #ddd",paddingTop:"5px"},children:"Showing last 15 messages  Active Sensing (0xFE) suppressed"})]})})]}),K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"Usage"})}),K.jsxs("div",{style:{padding:"10px 0",fontSize:"0.9em",color:"#666"},children:[K.jsx("p",{children:" Press keys on your MIDI keyboard to send notes to the server"}),K.jsx("p",{children:" Server can send notes back to play on your MIDI device"}),K.jsx("p",{children:" Use manual controls above to test server communication"}),K.jsxs("p",{children:[" ",K.jsx("strong",{children:"Duration Mode:"})," Send Note On with auto Note Off after specified time"]}),K.jsxs("p",{children:[" ",K.jsx("strong",{children:"Manual Mode:"})," Send explicit Note On/Off messages"]}),K.jsx("p",{children:" Press Escape to stop all sounds and MIDI notes"}),K.jsx("p",{children:" MIDI notes: 0-127 (60 = Middle C, 69 = A4-440Hz)"})]})]})]}):K.jsx("div",{style:{padding:"10px"},children:K.jsx("p",{children:"MIDI is disabled. Enable it in preferences to use MIDI features."})})},uH=vn.forwardRef(({client:n,collapsed:e,onToggleCollapse:t},r)=>{const i=ff(n,"userlist",[]),[o]=Do(),[a,s]=O.useState(!0),[l,f]=O.useState(!1),[h,m]=O.useState(!!n.currentRoomInfo);O.useEffect(()=>{const C=n.gmcpHandlers["Client.Midi"];C&&n.connected&&(o.midi.enabled?C.advertiseMidiSupport():C.unadvertiseMidiSupport())},[o.midi.enabled,n]),O.useEffect(()=>{const C=()=>f(!0);return n.on("itemsList",C),()=>{n.off("itemsList",C)}},[n]),O.useEffect(()=>{const C=()=>{h||m(!0)};return n.on("roomInfo",C),()=>{n.off("roomInfo",C)}},[n,h]);const g=[{id:"room-tab",label:"Room",content:K.jsx(cH,{client:n}),condition:h},{id:"inventory-tab",label:"Inventory",content:K.jsx(sH,{client:n}),condition:l},{id:"users-tab",label:"Users",content:K.jsx(iH,{users:i}),condition:!0},{id:"midi-tab",label:"MIDI",content:K.jsx(lH,{client:n}),condition:o.midi.enabled},{id:"files-tab",label:"Files",content:K.jsx(y9,{client:n,expanded:a}),condition:!0},{id:"audio-tab",label:"Audio",content:K.jsx(nH,{client:n}),condition:!0}],y=vn.useMemo(()=>g.filter(C=>C.condition??!0),[h,l,o.midi.enabled]);return vn.useImperativeHandle(r,()=>({switchToTab:C=>{var x;if(C>=0&&C<y.length){const w=(x=y[C])==null?void 0:x.id;if(w){console.log(`switchToTab: Trying index ${C}, ID: ${w}`);const S=document.getElementById(w);S?(console.log("switchToTab: Found button element, attempting click..."),S.click(),console.log("switchToTab: Click simulation finished.")):console.error(`switchToTab: Could not find button element with ID: ${w}`)}else console.warn(`switchToTab: Could not determine targetTabId for index ${C}. Visible tabs:`,y)}else console.warn(`switchToTab: Invalid targetIndex ${C}. Visible tabs count: ${y.length}`)}}),[y]),O.useEffect(()=>{const C=()=>s(!0);return n.on("fileTransferOffer",C),()=>{n.off("fileTransferOffer",C)}},[n]),K.jsxs("div",{className:`sidebar ${e?"collapsed":""}`,children:[" ",K.jsxs("button",{className:"sidebar-collapse-btn",onClick:t,title:e?"Expand sidebar":"Collapse sidebar","aria-label":e?"Expand sidebar":"Collapse sidebar",children:[e?K.jsx(CT,{}):K.jsx(xT,{}),K.jsx("span",{children:e?"Expand":"Collapse"})]}),!e&&K.jsxs("div",{className:"sidebar-content",children:[K.jsx(GE,{tabs:y})," "]})]})}),dH=({client:n})=>{const[e,t]=O.useState("Not connected"),[r,i]=O.useState(null),o=O.useCallback(g=>t(g),[]),a=O.useCallback(()=>t("Connected"),[]),s=O.useCallback(()=>{t("Disconnected"),i(null)},[]),l=O.useCallback(g=>i(g),[]);O.useEffect(()=>(n.on("statustext",o),n.on("connect",a),n.on("disconnect",s),n.on("vitals",l),()=>{n.off("statustext",o),n.off("connect",a),n.off("disconnect",s),n.off("vitals",l)}),[n,o,a,s,l]);const f=(g,y)=>g===void 0||y===void 0?null:`${g}/${y}`,h=f(r==null?void 0:r.hp,r==null?void 0:r.maxhp),m=f(r==null?void 0:r.mp,r==null?void 0:r.maxmp);return K.jsxs("div",{className:"statusbar",children:[K.jsx("span",{className:"status-connection",children:e}),r&&K.jsxs("span",{className:"status-vitals",children:[h&&` HP: ${h}`,m&&` MP: ${m}`]})]})},fH=({client:n,onClearLog:e,onSaveLog:t,onCopyLog:r,onToggleSidebar:i,onOpenPrefs:o,showSidebar:a})=>{const s=ff(n,"connectionChange",n.connected),[l,f]=vn.useState(n.cacophony.muted),h=ff(n,"autosayChanged",n.autosay)||!1,[m,g]=vn.useState(lr.getState().sound.volume),y=O.useCallback(()=>{const S=!l;f(S),n.setGlobalMute(S)},[l,n]),C=O.useCallback(S=>{const A=Number(S.target.value)/100;g(A),n.cacophony.setGlobalVolume(A),lr.dispatch({type:Zo.SetSound,data:{...lr.getState().sound,volume:A}})},[n]),x=O.useCallback(S=>{n.autosay=S.target.checked},[n]),w=O.useCallback(()=>{s?n.close():n.connect()},[s,n]);return K.jsxs("div",{className:"toolbar",children:[K.jsxs("button",{onClick:t,accessKey:"l",children:[K.jsx(bT,{}),"Save Log (Alt+L)"]}),K.jsxs("button",{onClick:r,accessKey:"C",children:[K.jsx(c9,{}),"Copy Log (Alt+Shift+C)"]}),K.jsxs("button",{onClick:e,accessKey:"E",children:[" ",K.jsx(u9,{}),"Clear Log (Alt+E)"]}),K.jsxs("button",{onClick:o,accessKey:"p",children:[K.jsx(s9,{}),"Preferences (Alt+P)"]}),K.jsxs("button",{onClick:y,accessKey:"M",children:[l?K.jsx(h9,{}):K.jsx(f9,{}),l?"Unmute":"Mute"]}),K.jsxs("label",{children:["Volume",K.jsx("input",{type:"range",min:"0",max:"100",value:m*100,onChange:C,accessKey:"V"})]}),K.jsxs("label",{children:[K.jsx(a9,{}),"Autosay",K.jsx("input",{type:"checkbox",checked:h,onChange:x})]}),K.jsx("button",{onClick:w,children:s?"Disconnect":"Connect"}),K.jsxs("button",{onClick:i,accessKey:"U",title:a?"Hide Sidebar (Alt+U)":"Show Sidebar (Alt+U)","aria-label":a?"Hide Sidebar":"Show Sidebar","aria-expanded":a,children:[a?K.jsx(xT,{}):K.jsx(CT,{}),a?"Hide Sidebar":"Show Sidebar"]})]})};function hH(){const[n,e]=O.useState(null),[t,r]=O.useState(!1),[i,o]=O.useState(!1),[a,s]=O.useState(!1),[l,f]=O.useState(!1);ff(n,"userlist",[]);const h=vn.useRef(null),m=vn.useRef(null),g=vn.useRef(null),y=vn.useRef(null),C=O.useRef(!1),x=()=>{h.current&&h.current.saveLog()},w=()=>{h.current&&h.current.clearLog()},S=()=>{h.current&&h.current.copyLog()},A=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);O.useEffect(()=>{if(C.current)return;const M=new l8("mongoose.moo.mud.org",8765);M.registerGMCPPackage(yO),M.registerGMCPPackage(iO),M.registerGMCPPackage(pO),M.registerGMCPPackage(gO),M.registerGMCPPackage(tM),M.registerGMCPPackage(CO),M.registerGMCPPackage(mO),M.registerGMCPPackage(vO),M.registerGMCPPackage(c3),M.registerGMCPPackage(Q3),M.registerGMCPPackage(g3),M.registerGMCPPackage(ik),M.registerGMCPPackage(IO),M.registerGMCPPackage(d3),M.registerGMCPPackage(rk),M.registerGMCPPackage(l3),M.registerGMCPPackage(u3),M.registerGMCPPackage(f3),M.registerGMCPPackage(h3),M.registerGMCPPackage(p3),M.registerGMCPPackage(xO),M.registerGMCPPackage(bO),M.registerGMCPPackage(wO),M.registerGMCPPackage(SO),M.registerGMCPPackage(AO),M.registerGMCPPackage(kO),M.registerGMCPPackage(EO),M.registerMcpPackage(PO),M.registerMcpPackage(DO),M.registerMcpPackage(NO),M.registerMcpPackage(BO),M.connect(),M.requestNotificationPermission();const P=new URLSearchParams(window.location.search),j=P.get("username"),X=P.get("password");j&&X&&M.once("connect",()=>{console.log("Auto-logging in with URL params..."),setTimeout(()=>{M.sendCommand(j),setTimeout(()=>{M.sendCommand(X)},500)},1e3)}),e(M),r(!A),window.mudClient=M,C.current=!0,Hs.initialize().then(Z=>{console.log(Z?"Virtual MIDI synthesizer initialized":"Failed to initialize virtual MIDI synthesizer")}).catch(Z=>{console.error("Error initializing virtual MIDI synthesizer:",Z)});const L=Z=>{if(M&&(Z.key==="Control"&&M.cancelSpeech(),Z.key==="Escape")){M.stopAllSounds();const ne=M.gmcpHandlers["Client.Midi"];ne&&ne.sendAllNotesOff()}};window.addEventListener("keydown",L);const G=()=>{var Z;(Z=m.current)==null||Z.focus()};return document.addEventListener("focus",G),()=>{window.removeEventListener("keydown",L),document.removeEventListener("focus",G)}},[A]),O.useEffect(()=>{const M=P=>{var X;if(!t||!P.ctrlKey)return;const j=parseInt(P.key,10);if(!isNaN(j)&&j>=1&&j<=9){const L=j-1;P.preventDefault(),console.log(`App: Detected CTRL+${j}, calling switchToTab(${L})`),(X=y.current)==null||X.switchToTab(L)}};return document.addEventListener("keydown",M,!0),()=>{document.removeEventListener("keydown",M,!0)}},[t]);const E=ff(n,"fileTransferOffer",null),_=O.useCallback(M=>{n&&n.sendCommand(M)},[n]),T=O.useCallback(()=>{var M;(M=m.current)==null||M.focus()},[]);return O.useEffect(()=>{E!==null&&(f(!0),s(!0),n==null||n.sendNotification("File Transfer Offer",`${E.sender} wants to send you ${E.filename} (${Math.round(E.filesize/1024)} KB)`))},[E,n]),nk(M=>{n&&n.shutdown()}),O.useEffect(()=>{var M;(M=m.current)==null||M.focus()},[]),n?K.jsxs("div",{className:`App ${t?i?"sidebar-collapsed":"sidebar-shown":""}`,children:[K.jsx("header",{role:"banner",style:{gridArea:"header"},children:K.jsx(fH,{client:n,onSaveLog:x,onClearLog:w,onCopyLog:S,onToggleSidebar:()=>r(!t),onOpenPrefs:()=>{var M;return(M=g.current)==null?void 0:M.open()},showSidebar:t})}),K.jsx("main",{role:"main",style:{gridArea:"main"},children:K.jsx(oy,{client:n,ref:h,focusInput:T})}),K.jsx("div",{role:"region","aria-label":"Command input",style:{gridArea:"input"},children:K.jsx(h8,{onSend:_,inputRef:m,client:n})}),t&&K.jsx("aside",{role:"complementary","aria-roledescription":"Sidebar",style:{gridArea:"sidebar"},children:K.jsx(uH,{ref:y,client:n,collapsed:i,onToggleCollapse:()=>o(!i)})}),K.jsx("footer",{role:"contentinfo",style:{gridArea:"status"},children:K.jsx(dH,{client:n})}),K.jsx(Q6,{ref:g})]}):null}function pH(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TA(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function _A(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?TA(Object(t),!0).forEach(function(r){pH(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):TA(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function gH(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function mH(n,e){if(n==null)return{};var t=gH(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function vH(n,e){return yH(n)||CH(n,e)||xH(n,e)||bH()}function yH(n){if(Array.isArray(n))return n}function CH(n,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(n)))){var t=[],r=!0,i=!1,o=void 0;try{for(var a=n[Symbol.iterator](),s;!(r=(s=a.next()).done)&&(t.push(s.value),!(e&&t.length===e));r=!0);}catch(l){i=!0,o=l}finally{try{!r&&a.return!=null&&a.return()}finally{if(i)throw o}}return t}}function xH(n,e){if(n){if(typeof n=="string")return RA(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return RA(n,e)}}function RA(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function bH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IH(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function PA(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function DA(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?PA(Object(t),!0).forEach(function(r){IH(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):PA(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function wH(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(r){return e.reduceRight(function(i,o){return o(i)},r)}}function Gd(n){return function e(){for(var t=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=n.length?n.apply(this,i):function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return e.apply(t,[].concat(i,s))}}}function Tp(n){return{}.toString.call(n).includes("Object")}function SH(n){return!Object.keys(n).length}function hf(n){return typeof n=="function"}function AH(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function kH(n,e){return Tp(e)||Sc("changeType"),Object.keys(e).some(function(t){return!AH(n,t)})&&Sc("changeField"),e}function EH(n){hf(n)||Sc("selectorType")}function TH(n){hf(n)||Tp(n)||Sc("handlerType"),Tp(n)&&Object.values(n).some(function(e){return!hf(e)})&&Sc("handlersType")}function _H(n){n||Sc("initialIsRequired"),Tp(n)||Sc("initialType"),SH(n)&&Sc("initialContent")}function RH(n,e){throw new Error(n[e]||n.default)}var PH={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Sc=Gd(RH)(PH),Uh={changes:kH,selector:EH,handler:TH,initial:_H};function DH(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Uh.initial(n),Uh.handler(e);var t={current:n},r=Gd(BH)(t,e),i=Gd(NH)(t),o=Gd(Uh.changes)(n),a=Gd(MH)(t);function s(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(h){return h};return Uh.selector(f),f(t.current)}function l(f){wH(r,i,o,a)(f)}return[s,l]}function MH(n,e){return hf(e)?e(n.current):e}function NH(n,e){return n.current=DA(DA({},n.current),e),e}function BH(n,e,t){return hf(e)?e(n.current):Object.keys(t).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,n.current[r])}),t}var OH={create:DH},FH={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function LH(n){return function e(){for(var t=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=n.length?n.apply(this,i):function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return e.apply(t,[].concat(i,s))}}}function UH(n){return{}.toString.call(n).includes("Object")}function jH(n){return n||MA("configIsRequired"),UH(n)||MA("configType"),n.urls?(GH(),{paths:{vs:n.urls.monacoBase}}):n}function GH(){console.warn(oR.deprecation)}function VH(n,e){throw new Error(n[e]||n.default)}var oR={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},MA=LH(VH)(oR),zH={config:jH},WH=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(i){return t.reduceRight(function(o,a){return a(o)},i)}};function sR(n,e){return Object.keys(e).forEach(function(t){e[t]instanceof Object&&n[t]&&Object.assign(e[t],sR(n[t],e[t]))}),_A(_A({},n),e)}var HH={type:"cancelation",msg:"operation is manually canceled"};function wv(n){var e=!1,t=new Promise(function(r,i){n.then(function(o){return e?i(HH):r(o)}),n.catch(i)});return t.cancel=function(){return e=!0},t}var ZH=OH.create({config:FH,isInitialized:!1,resolve:null,reject:null,monaco:null}),aR=vH(ZH,2),Rf=aR[0],ng=aR[1];function XH(n){var e=zH.config(n),t=e.monaco,r=mH(e,["monaco"]);ng(function(i){return{config:sR(i.config,r),monaco:t}})}function $H(){var n=Rf(function(e){var t=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:t,isInitialized:r,resolve:i}});if(!n.isInitialized){if(ng({isInitialized:!0}),n.monaco)return n.resolve(n.monaco),wv(Sv);if(window.monaco&&window.monaco.editor)return cR(window.monaco),n.resolve(window.monaco),wv(Sv);WH(KH,YH)(QH)}return wv(Sv)}function KH(n){return document.body.appendChild(n)}function qH(n){var e=document.createElement("script");return n&&(e.src=n),e}function YH(n){var e=Rf(function(r){var i=r.config,o=r.reject;return{config:i,reject:o}}),t=qH("".concat(e.config.paths.vs,"/loader.js"));return t.onload=function(){return n()},t.onerror=e.reject,t}function QH(){var n=Rf(function(t){var r=t.config,i=t.resolve,o=t.reject;return{config:r,resolve:i,reject:o}}),e=window.require;e.config(n.config),e(["vs/editor/editor.main"],function(t){cR(t),n.resolve(t)},function(t){n.reject(t)})}function cR(n){Rf().monaco||ng({monaco:n})}function JH(){return Rf(function(n){var e=n.monaco;return e})}var Sv=new Promise(function(n,e){return ng({resolve:n,reject:e})}),lR={config:XH,init:$H,__getMonacoInstance:JH},eZ={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Av=eZ,tZ={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},nZ=tZ;function rZ({children:n}){return vn.createElement("div",{style:nZ.container},n)}var iZ=rZ,oZ=iZ;function sZ({width:n,height:e,isEditorReady:t,loading:r,_ref:i,className:o,wrapperProps:a}){return vn.createElement("section",{style:{...Av.wrapper,width:n,height:e},...a},!t&&vn.createElement(oZ,null,r),vn.createElement("div",{ref:i,style:{...Av.fullWidth,...!t&&Av.hide},className:o}))}var aZ=sZ,uR=O.memo(aZ);function cZ(n){O.useEffect(n,[])}var dR=cZ;function lZ(n,e,t=!0){let r=O.useRef(!0);O.useEffect(r.current||!t?()=>{r.current=!1}:n,e)}var ko=lZ;function Xd(){}function fu(n,e,t,r){return uZ(n,r)||dZ(n,e,t,r)}function uZ(n,e){return n.editor.getModel(fR(n,e))}function dZ(n,e,t,r){return n.editor.createModel(e,t,r?fR(n,r):void 0)}function fR(n,e){return n.Uri.parse(e)}function fZ({original:n,modified:e,language:t,originalLanguage:r,modifiedLanguage:i,originalModelPath:o,modifiedModelPath:a,keepCurrentOriginalModel:s=!1,keepCurrentModifiedModel:l=!1,theme:f="light",loading:h="Loading...",options:m={},height:g="100%",width:y="100%",className:C,wrapperProps:x={},beforeMount:w=Xd,onMount:S=Xd}){let[A,E]=O.useState(!1),[_,T]=O.useState(!0),M=O.useRef(null),P=O.useRef(null),j=O.useRef(null),X=O.useRef(S),L=O.useRef(w),G=O.useRef(!1);dR(()=>{let ve=lR.init();return ve.then(Se=>(P.current=Se)&&T(!1)).catch(Se=>(Se==null?void 0:Se.type)!=="cancelation"&&console.error("Monaco initialization: error:",Se)),()=>M.current?pe():ve.cancel()}),ko(()=>{if(M.current&&P.current){let ve=M.current.getOriginalEditor(),Se=fu(P.current,n||"",r||t||"text",o||"");Se!==ve.getModel()&&ve.setModel(Se)}},[o],A),ko(()=>{if(M.current&&P.current){let ve=M.current.getModifiedEditor(),Se=fu(P.current,e||"",i||t||"text",a||"");Se!==ve.getModel()&&ve.setModel(Se)}},[a],A),ko(()=>{let ve=M.current.getModifiedEditor();ve.getOption(P.current.editor.EditorOption.readOnly)?ve.setValue(e||""):e!==ve.getValue()&&(ve.executeEdits("",[{range:ve.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),ve.pushUndoStop())},[e],A),ko(()=>{var ve,Se;(Se=(ve=M.current)==null?void 0:ve.getModel())==null||Se.original.setValue(n||"")},[n],A),ko(()=>{let{original:ve,modified:Se}=M.current.getModel();P.current.editor.setModelLanguage(ve,r||t||"text"),P.current.editor.setModelLanguage(Se,i||t||"text")},[t,r,i],A),ko(()=>{var ve;(ve=P.current)==null||ve.editor.setTheme(f)},[f],A),ko(()=>{var ve;(ve=M.current)==null||ve.updateOptions(m)},[m],A);let Z=O.useCallback(()=>{var Ne;if(!P.current)return;L.current(P.current);let ve=fu(P.current,n||"",r||t||"text",o||""),Se=fu(P.current,e||"",i||t||"text",a||"");(Ne=M.current)==null||Ne.setModel({original:ve,modified:Se})},[t,e,i,n,r,o,a]),ne=O.useCallback(()=>{var ve;!G.current&&j.current&&(M.current=P.current.editor.createDiffEditor(j.current,{automaticLayout:!0,...m}),Z(),(ve=P.current)==null||ve.editor.setTheme(f),E(!0),G.current=!0)},[m,f,Z]);O.useEffect(()=>{A&&X.current(M.current,P.current)},[A]),O.useEffect(()=>{!_&&!A&&ne()},[_,A,ne]);function pe(){var Se,Ne,xe,Ae;let ve=(Se=M.current)==null?void 0:Se.getModel();s||((Ne=ve==null?void 0:ve.original)==null||Ne.dispose()),l||((xe=ve==null?void 0:ve.modified)==null||xe.dispose()),(Ae=M.current)==null||Ae.dispose()}return vn.createElement(uR,{width:y,height:g,isEditorReady:A,loading:h,_ref:j,className:C,wrapperProps:x})}var hZ=fZ;O.memo(hZ);function pZ(n){let e=O.useRef();return O.useEffect(()=>{e.current=n},[n]),e.current}var gZ=pZ,jh=new Map;function mZ({defaultValue:n,defaultLanguage:e,defaultPath:t,value:r,language:i,path:o,theme:a="light",line:s,loading:l="Loading...",options:f={},overrideServices:h={},saveViewState:m=!0,keepCurrentModel:g=!1,width:y="100%",height:C="100%",className:x,wrapperProps:w={},beforeMount:S=Xd,onMount:A=Xd,onChange:E,onValidate:_=Xd}){let[T,M]=O.useState(!1),[P,j]=O.useState(!0),X=O.useRef(null),L=O.useRef(null),G=O.useRef(null),Z=O.useRef(A),ne=O.useRef(S),pe=O.useRef(),ve=O.useRef(r),Se=gZ(o),Ne=O.useRef(!1),xe=O.useRef(!1);dR(()=>{let H=lR.init();return H.then(ee=>(X.current=ee)&&j(!1)).catch(ee=>(ee==null?void 0:ee.type)!=="cancelation"&&console.error("Monaco initialization: error:",ee)),()=>L.current?ke():H.cancel()}),ko(()=>{var ee,ae,ye,Ee;let H=fu(X.current,n||r||"",e||i||"",o||t||"");H!==((ee=L.current)==null?void 0:ee.getModel())&&(m&&jh.set(Se,(ae=L.current)==null?void 0:ae.saveViewState()),(ye=L.current)==null||ye.setModel(H),m&&((Ee=L.current)==null||Ee.restoreViewState(jh.get(o))))},[o],T),ko(()=>{var H;(H=L.current)==null||H.updateOptions(f)},[f],T),ko(()=>{!L.current||r===void 0||(L.current.getOption(X.current.editor.EditorOption.readOnly)?L.current.setValue(r):r!==L.current.getValue()&&(xe.current=!0,L.current.executeEdits("",[{range:L.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),L.current.pushUndoStop(),xe.current=!1))},[r],T),ko(()=>{var ee,ae;let H=(ee=L.current)==null?void 0:ee.getModel();H&&i&&((ae=X.current)==null||ae.editor.setModelLanguage(H,i))},[i],T),ko(()=>{var H;s!==void 0&&((H=L.current)==null||H.revealLine(s))},[s],T),ko(()=>{var H;(H=X.current)==null||H.editor.setTheme(a)},[a],T);let Ae=O.useCallback(()=>{var H;if(!(!G.current||!X.current)&&!Ne.current){ne.current(X.current);let ee=o||t,ae=fu(X.current,r||n||"",e||i||"",ee||"");L.current=(H=X.current)==null?void 0:H.editor.create(G.current,{model:ae,automaticLayout:!0,...f},h),m&&L.current.restoreViewState(jh.get(ee)),X.current.editor.setTheme(a),s!==void 0&&L.current.revealLine(s),M(!0),Ne.current=!0}},[n,e,t,r,i,o,f,h,m,a,s]);O.useEffect(()=>{T&&Z.current(L.current,X.current)},[T]),O.useEffect(()=>{!P&&!T&&Ae()},[P,T,Ae]),ve.current=r,O.useEffect(()=>{var H,ee;T&&E&&((H=pe.current)==null||H.dispose(),pe.current=(ee=L.current)==null?void 0:ee.onDidChangeModelContent(ae=>{xe.current||E(L.current.getValue(),ae)}))},[T,E]),O.useEffect(()=>{if(T){let H=X.current.editor.onDidChangeMarkers(ee=>{var ye;let ae=(ye=L.current.getModel())==null?void 0:ye.uri;if(ae&&ee.find(Ee=>Ee.path===ae.path)){let Ee=X.current.editor.getModelMarkers({resource:ae});_==null||_(Ee)}});return()=>{H==null||H.dispose()}}return()=>{}},[T,_]);function ke(){var H,ee;(H=pe.current)==null||H.dispose(),g?m&&jh.set(o,L.current.saveViewState()):(ee=L.current.getModel())==null||ee.dispose(),L.current.dispose()}return vn.createElement(uR,{width:y,height:C,isEditorReady:T,loading:l,_ref:G,className:x,wrapperProps:w})}var vZ=mZ,yZ=O.memo(vZ),CZ=yZ,xZ={restoreOnUnmount:!1};function bZ(n,e){e===void 0&&(e=xZ);var t=O.useRef(document.title);document.title!==n&&(document.title=n),O.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=t.current}},[])}const IZ=typeof document<"u"?bZ:function(n){};function wZ({onSave:n,onRevert:e,onDownload:t}){return K.jsx("div",{className:"editor-toolbar",children:K.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[K.jsxs("button",{onClick:n,accessKey:"s",title:"Save (Alt+S)",children:[K.jsx(bT,{"aria-hidden":"true"}),"Save"]}),K.jsxs("button",{onClick:e,accessKey:"r",title:"Revert (Alt+R)",children:[K.jsx(d9,{"aria-hidden":"true"}),"Revert"]}),K.jsxs("button",{onClick:t,accessKey:"d",title:"Download (Alt+D)",children:[K.jsx(l9,{"aria-hidden":"true"}),"Download"]})]})})}const SZ=({docstate:n,session:e})=>K.jsxs("div",{"aria-live":"polite",className:"editor-statusbar",children:[K.jsx("span",{children:n}),K.jsx("span",{"aria-hidden":"true",children:"|"}),K.jsx("span",{children:e.reference}),K.jsx("span",{"aria-hidden":"true",children:"|"}),K.jsx("span",{children:e.type})]});function AZ(){const n=ek(),e=vn.useRef(null),[t,r]=O.useState(""),[i,o]=O.useState(""),[a,s]=O.useState(""),[l,f]=O.useState(0),[h,m]=O.useState({name:"none",contents:[],reference:"",type:""}),g=(ne,pe)=>{e.current=ne},[y,C]=Do();console.log(y);const x=y.editor.accessibilityMode,w=y.editor.autocompleteEnabled;nk(ne=>{T.postMessage({type:"close",id:P}),l===1&&ne.preventDefault()});const[S,A]=O.useState(!1),E=S?`${h.name} - Mongoose Editor`:"Mongoose Editor";IZ(E);const _=O.useMemo(()=>{switch(l){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[l]),T=O.useMemo(()=>new BroadcastChannel("editor"),[]),M=new URLSearchParams(n.search),P=decodeURIComponent(M.get("reference")||"");O.useEffect(()=>{if(!P)return;console.log("ID: "+P),console.log("Sending ready message"),T.postMessage({type:"ready",id:P});const ne=pe=>{switch(console.log(pe.data),pe.data.type){case"load":if(t!=="")return;const ve=pe.data.session.contents.join(`
`);o(ve),s(ve),m(pe.data.session),f(0),r(pe.data.clientId),A(!0),setTimeout(Z,100);break;case"shutdown":if(console.log("Received shutdown message"),l===1&&!window.confirm("You have unsaved changes. Are you sure you want to close this editor?"))return;T.close(),window.close();break;default:console.warn("Unknown message type received",pe.data.type)}};return T.addEventListener("message",ne),()=>{T.removeEventListener("message",ne),T.postMessage({type:"close",id:P})}},[T,t,P,l]);const j=()=>{o(a),f(0)},X=ne=>{const pe=i.split(/\r\n|\r|\n/),ve={...h,contents:pe};T.postMessage({type:"save",session:ve,id:P}),f(2),Z(),ne.preventDefault()},L=ne=>{ne!==void 0&&(console.log("Original: "+a),console.log("New: "+ne),o(ne),ne.split(/\r\n|\r|\n/).join(`
`)!==a?f(1):f(0),S||A(!0))},G=()=>{const ne=new Blob([i],{type:"text/plain"}),pe=URL.createObjectURL(ne),ve=document.createElement("a"),Se=new Date,Ne=Se.toLocaleDateString().replace(/\//g,"-"),xe=Se.toLocaleTimeString().replace(/:/g,"-"),Ae=`${h.name}-${Ne}-${xe}.txt`;ve.download=Ae,ve.href=pe,ve.click(),URL.revokeObjectURL(pe),ve.remove()};return K.jsxs("div",{id:"editor-window",children:[K.jsx(wZ,{onSave:X,onRevert:j,onDownload:G}),K.jsx(CZ,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:L,options:{wordWrap:"on",accessibilitySupport:x?"on":"off",quickSuggestions:w},onMount:g,path:h.reference}),K.jsx(SZ,{docstate:_,session:h})]});function Z(){e.current!==null&&e.current.focus()}}const kZ="modulepreload",EZ=function(n){return"/"+n},NA={},hR=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let a=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),l=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=a(t.map(f=>{if(f=EZ(f),f in NA)return;NA[f]=!0;const h=f.endsWith(".css"),m=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${m}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":kZ,h||(g.as="script"),g.crossOrigin="",g.href=f,l&&g.setAttribute("nonce",l),document.head.appendChild(g),h)return new Promise((y,C)=>{g.addEventListener("load",y),g.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${f}`)))})}))}function o(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return i.then(a=>{for(const s of a||[])s.status==="rejected"&&o(s.reason);return e().catch(o)})},TZ=n=>{n&&n instanceof Function&&hR(async()=>{const{getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:o}=await import("./web-vitals-CFnx-5Zt.js");return{getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:o}},[]).then(({getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:o})=>{e(n),t(n),r(n),i(n),o(n)})};function _Z(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:o,onRegisterError:a}=n;let s,l;const f=async(m=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(s=await hR(async()=>{const{Workbox:m}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:m}},[]).then(({Workbox:m})=>new m("/sw.js",{scope:"/",type:"classic"})).catch(m=>{a==null||a(m)}),!s)return;s.addEventListener("activated",m=>{(m.isUpdate||m.isExternal)&&window.location.reload()}),s.addEventListener("installed",m=>{m.isUpdate||r==null||r()}),s.register({immediate:e}).then(m=>{o?o("/sw.js",m):i==null||i(m)}).catch(m=>{a==null||a(m)})}}return l=h(),f}const RZ=UD([{path:"/",element:K.jsx(hH,{})},{path:"/editor",element:K.jsx(AZ,{})}]),PZ=wP.createRoot(document.getElementById("root"));PZ.render(K.jsx(vn.StrictMode,{children:K.jsx($D,{router:RZ})}));TZ(console.log);_Z();

var gP=Object.defineProperty;var zx=t=>{throw TypeError(t)};var mP=(t,e,n)=>e in t?gP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var L=(t,e,n)=>mP(t,typeof e!="symbol"?e+"":e,n),ng=(t,e,n)=>e.has(t)||zx("Cannot "+n);var O=(t,e,n)=>(ng(t,e,"read from private field"),n?n.call(t):e.get(t)),ct=(t,e,n)=>e.has(t)?zx("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Fe=(t,e,n,r)=>(ng(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ee=(t,e,n)=>(ng(t,e,"access private method"),n);var Nf=(t,e,n,r)=>({set _(i){Fe(t,e,i,n)},get _(){return O(t,e,r)}});function ok(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function vP(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var sk={exports:{}},up={},ak={exports:{}},qe={},hf=Symbol.for("react.element"),CP=Symbol.for("react.portal"),yP=Symbol.for("react.fragment"),xP=Symbol.for("react.strict_mode"),IP=Symbol.for("react.profiler"),bP=Symbol.for("react.provider"),AP=Symbol.for("react.context"),wP=Symbol.for("react.forward_ref"),SP=Symbol.for("react.suspense"),kP=Symbol.for("react.memo"),EP=Symbol.for("react.lazy"),jx=Symbol.iterator;function TP(t){return t===null||typeof t!="object"?null:(t=jx&&t[jx]||t["@@iterator"],typeof t=="function"?t:null)}var lk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ck=Object.assign,uk={};function tu(t,e,n){this.props=t,this.context=e,this.refs=uk,this.updater=n||lk}tu.prototype.isReactComponent={};tu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};tu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dk(){}dk.prototype=tu.prototype;function gy(t,e,n){this.props=t,this.context=e,this.refs=uk,this.updater=n||lk}var my=gy.prototype=new dk;my.constructor=gy;ck(my,tu.prototype);my.isPureReactComponent=!0;var Hx=Array.isArray,fk=Object.prototype.hasOwnProperty,vy={current:null},hk={key:!0,ref:!0,__self:!0,__source:!0};function pk(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)fk.call(e,r)&&!hk.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:hf,type:t,key:o,ref:s,props:i,_owner:vy.current}}function RP(t,e){return{$$typeof:hf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Cy(t){return typeof t=="object"&&t!==null&&t.$$typeof===hf}function _P(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Zx=/\/+/g;function rg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?_P(""+t.key):e.toString(36)}function ph(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case hf:case CP:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+rg(s,0):r,Hx(i)?(n="",t!=null&&(n=t.replace(Zx,"$&/")+"/"),ph(i,e,n,"",function(c){return c})):i!=null&&(Cy(i)&&(i=RP(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Zx,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",Hx(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+rg(o,a);s+=ph(o,e,n,l,i)}else if(l=TP(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+rg(o,a++),s+=ph(o,e,n,l,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Bf(t,e,n){if(t==null)return t;var r=[],i=0;return ph(t,r,"","",function(o){return e.call(n,o,i++)}),r}function DP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var hr={current:null},gh={transition:null},PP={ReactCurrentDispatcher:hr,ReactCurrentBatchConfig:gh,ReactCurrentOwner:vy};function gk(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:Bf,forEach:function(t,e,n){Bf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Bf(t,function(){e++}),e},toArray:function(t){return Bf(t,function(e){return e})||[]},only:function(t){if(!Cy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qe.Component=tu;qe.Fragment=yP;qe.Profiler=IP;qe.PureComponent=gy;qe.StrictMode=xP;qe.Suspense=SP;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PP;qe.act=gk;qe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=ck({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=vy.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)fk.call(e,l)&&!hk.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:hf,type:t.type,key:i,ref:o,props:r,_owner:s}};qe.createContext=function(t){return t={$$typeof:AP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:bP,_context:t},t.Consumer=t};qe.createElement=pk;qe.createFactory=function(t){var e=pk.bind(null,t);return e.type=t,e};qe.createRef=function(){return{current:null}};qe.forwardRef=function(t){return{$$typeof:wP,render:t}};qe.isValidElement=Cy;qe.lazy=function(t){return{$$typeof:EP,_payload:{_status:-1,_result:t},_init:DP}};qe.memo=function(t,e){return{$$typeof:kP,type:t,compare:e===void 0?null:e}};qe.startTransition=function(t){var e=gh.transition;gh.transition={};try{t()}finally{gh.transition=e}};qe.unstable_act=gk;qe.useCallback=function(t,e){return hr.current.useCallback(t,e)};qe.useContext=function(t){return hr.current.useContext(t)};qe.useDebugValue=function(){};qe.useDeferredValue=function(t){return hr.current.useDeferredValue(t)};qe.useEffect=function(t,e){return hr.current.useEffect(t,e)};qe.useId=function(){return hr.current.useId()};qe.useImperativeHandle=function(t,e,n){return hr.current.useImperativeHandle(t,e,n)};qe.useInsertionEffect=function(t,e){return hr.current.useInsertionEffect(t,e)};qe.useLayoutEffect=function(t,e){return hr.current.useLayoutEffect(t,e)};qe.useMemo=function(t,e){return hr.current.useMemo(t,e)};qe.useReducer=function(t,e,n){return hr.current.useReducer(t,e,n)};qe.useRef=function(t){return hr.current.useRef(t)};qe.useState=function(t){return hr.current.useState(t)};qe.useSyncExternalStore=function(t,e,n){return hr.current.useSyncExternalStore(t,e,n)};qe.useTransition=function(){return hr.current.useTransition()};qe.version="18.3.1";ak.exports=qe;var S=ak.exports;const He=eu(S),NP=ok({__proto__:null,default:He},[S]);var BP=S,FP=Symbol.for("react.element"),OP=Symbol.for("react.fragment"),MP=Object.prototype.hasOwnProperty,LP=BP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,UP={key:!0,ref:!0,__self:!0,__source:!0};function mk(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)MP.call(e,r)&&!UP.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:FP,type:t,key:o,ref:s,props:i,_owner:LP.current}}up.Fragment=OP;up.jsx=mk;up.jsxs=mk;sk.exports=up;var X=sk.exports,qm={},vk={exports:{}},ti={},Ck={exports:{}},yk={};(function(t){function e(Z,Q){var ne=Z.length;Z.push(Q);e:for(;0<ne;){var F=ne-1>>>1,z=Z[F];if(0<i(z,Q))Z[F]=Q,Z[ne]=z,ne=F;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var Q=Z[0],ne=Z.pop();if(ne!==Q){Z[0]=ne;e:for(var F=0,z=Z.length,J=z>>>1;F<J;){var ee=2*(F+1)-1,se=Z[ee],me=ee+1,Be=Z[me];if(0>i(se,ne))me<z&&0>i(Be,se)?(Z[F]=Be,Z[me]=ne,F=me):(Z[F]=se,Z[ee]=ne,F=ee);else if(me<z&&0>i(Be,ne))Z[F]=Be,Z[me]=ne,F=me;else break e}}return Q}function i(Z,Q){var ne=Z.sortIndex-Q.sortIndex;return ne!==0?ne:Z.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,f=3,h=!1,p=!1,m=!1,C=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Z){for(var Q=n(c);Q!==null;){if(Q.callback===null)r(c);else if(Q.startTime<=Z)r(c),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=n(c)}}function I(Z){if(m=!1,y(Z),!p)if(n(l)!==null)p=!0,q(b);else{var Q=n(c);Q!==null&&ie(I,Q.startTime-Z)}}function b(Z,Q){p=!1,m&&(m=!1,v(k),k=-1),h=!0;var ne=f;try{for(y(Q),d=n(l);d!==null&&(!(d.expirationTime>Q)||Z&&!R());){var F=d.callback;if(typeof F=="function"){d.callback=null,f=d.priorityLevel;var z=F(d.expirationTime<=Q);Q=t.unstable_now(),typeof z=="function"?d.callback=z:d===n(l)&&r(l),y(Q)}else r(l);d=n(l)}if(d!==null)var J=!0;else{var ee=n(c);ee!==null&&ie(I,ee.startTime-Q),J=!1}return J}finally{d=null,f=ne,h=!1}}var E=!1,w=null,k=-1,D=5,T=-1;function R(){return!(t.unstable_now()-T<D)}function P(){if(w!==null){var Z=t.unstable_now();T=Z;var Q=!0;try{Q=w(!0,Z)}finally{Q?M():(E=!1,w=null)}}else E=!1}var M;if(typeof g=="function")M=function(){g(P)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,H=G.port2;G.port1.onmessage=P,M=function(){H.postMessage(null)}}else M=function(){C(P,0)};function q(Z){w=Z,E||(E=!0,M())}function ie(Z,Q){k=C(function(){Z(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,q(b))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Z){switch(f){case 1:case 2:case 3:var Q=3;break;default:Q=f}var ne=f;f=Q;try{return Z()}finally{f=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,Q){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ne=f;f=Z;try{return Q()}finally{f=ne}},t.unstable_scheduleCallback=function(Z,Q,ne){var F=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?F+ne:F):ne=F,Z){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=ne+z,Z={id:u++,callback:Q,priorityLevel:Z,startTime:ne,expirationTime:z,sortIndex:-1},ne>F?(Z.sortIndex=ne,e(c,Z),n(l)===null&&Z===n(c)&&(m?(v(k),k=-1):m=!0,ie(I,ne-F))):(Z.sortIndex=z,e(l,Z),p||h||(p=!0,q(b))),Z},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(Z){var Q=f;return function(){var ne=f;f=Q;try{return Z.apply(this,arguments)}finally{f=ne}}}})(yk);Ck.exports=yk;var VP=Ck.exports,GP=S,Qr=VP;function fe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xk=new Set,kd={};function Bl(t,e){Oc(t,e),Oc(t+"Capture",e)}function Oc(t,e){for(kd[t]=e,t=0;t<e.length;t++)xk.add(e[t])}var Ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qm=Object.prototype.hasOwnProperty,WP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$x={},Xx={};function zP(t){return Qm.call(Xx,t)?!0:Qm.call($x,t)?!1:WP.test(t)?Xx[t]=!0:($x[t]=!0,!1)}function jP(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function HP(t,e,n,r){if(e===null||typeof e>"u"||jP(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function pr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Mn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Mn[t]=new pr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Mn[e]=new pr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Mn[t]=new pr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Mn[t]=new pr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Mn[t]=new pr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Mn[t]=new pr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Mn[t]=new pr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Mn[t]=new pr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Mn[t]=new pr(t,5,!1,t.toLowerCase(),null,!1,!1)});var yy=/[\-:]([a-z])/g;function xy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(yy,xy);Mn[e]=new pr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(yy,xy);Mn[e]=new pr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(yy,xy);Mn[e]=new pr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Mn[t]=new pr(t,1,!1,t.toLowerCase(),null,!1,!1)});Mn.xlinkHref=new pr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Mn[t]=new pr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Iy(t,e,n,r){var i=Mn.hasOwnProperty(e)?Mn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(HP(e,n,i,r)&&(n=null),r||i===null?zP(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Us=GP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ff=Symbol.for("react.element"),tc=Symbol.for("react.portal"),nc=Symbol.for("react.fragment"),by=Symbol.for("react.strict_mode"),ev=Symbol.for("react.profiler"),Ik=Symbol.for("react.provider"),bk=Symbol.for("react.context"),Ay=Symbol.for("react.forward_ref"),tv=Symbol.for("react.suspense"),nv=Symbol.for("react.suspense_list"),wy=Symbol.for("react.memo"),ia=Symbol.for("react.lazy"),Ak=Symbol.for("react.offscreen"),Kx=Symbol.iterator;function bu(t){return t===null||typeof t!="object"?null:(t=Kx&&t[Kx]||t["@@iterator"],typeof t=="function"?t:null)}var Xt=Object.assign,ig;function $u(t){if(ig===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ig=e&&e[1]||""}return`
`+ig+t}var og=!1;function sg(t,e){if(!t||og)return"";og=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{og=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?$u(t):""}function ZP(t){switch(t.tag){case 5:return $u(t.type);case 16:return $u("Lazy");case 13:return $u("Suspense");case 19:return $u("SuspenseList");case 0:case 2:case 15:return t=sg(t.type,!1),t;case 11:return t=sg(t.type.render,!1),t;case 1:return t=sg(t.type,!0),t;default:return""}}function rv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case nc:return"Fragment";case tc:return"Portal";case ev:return"Profiler";case by:return"StrictMode";case tv:return"Suspense";case nv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case bk:return(t.displayName||"Context")+".Consumer";case Ik:return(t._context.displayName||"Context")+".Provider";case Ay:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case wy:return e=t.displayName||null,e!==null?e:rv(t.type)||"Memo";case ia:e=t._payload,t=t._init;try{return rv(t(e))}catch{}}return null}function $P(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rv(e);case 8:return e===by?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Da(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function wk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function XP(t){var e=wk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Of(t){t._valueTracker||(t._valueTracker=XP(t))}function Sk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=wk(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function e0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function iv(t,e){var n=e.checked;return Xt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Jx(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Da(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function kk(t,e){e=e.checked,e!=null&&Iy(t,"checked",e,!1)}function ov(t,e){kk(t,e);var n=Da(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?sv(t,e.type,n):e.hasOwnProperty("defaultValue")&&sv(t,e.type,Da(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Yx(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function sv(t,e,n){(e!=="number"||e0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Xu=Array.isArray;function mc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Da(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function av(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(fe(91));return Xt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function qx(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(fe(92));if(Xu(n)){if(1<n.length)throw Error(fe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Da(n)}}function Ek(t,e){var n=Da(e.value),r=Da(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Qx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Tk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Tk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Mf,Rk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Mf=Mf||document.createElement("div"),Mf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Mf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ed(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ld={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},KP=["Webkit","ms","Moz","O"];Object.keys(ld).forEach(function(t){KP.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ld[e]=ld[t]})});function _k(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ld.hasOwnProperty(t)&&ld[t]?(""+e).trim():e+"px"}function Dk(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=_k(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var JP=Xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cv(t,e){if(e){if(JP[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(fe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(fe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(fe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(fe(62))}}function uv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dv=null;function Sy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fv=null,vc=null,Cc=null;function eI(t){if(t=mf(t)){if(typeof fv!="function")throw Error(fe(280));var e=t.stateNode;e&&(e=gp(e),fv(t.stateNode,t.type,e))}}function Pk(t){vc?Cc?Cc.push(t):Cc=[t]:vc=t}function Nk(){if(vc){var t=vc,e=Cc;if(Cc=vc=null,eI(t),e)for(t=0;t<e.length;t++)eI(e[t])}}function Bk(t,e){return t(e)}function Fk(){}var ag=!1;function Ok(t,e,n){if(ag)return t(e,n);ag=!0;try{return Bk(t,e,n)}finally{ag=!1,(vc!==null||Cc!==null)&&(Fk(),Nk())}}function Td(t,e){var n=t.stateNode;if(n===null)return null;var r=gp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(fe(231,e,typeof n));return n}var hv=!1;if(Ds)try{var Au={};Object.defineProperty(Au,"passive",{get:function(){hv=!0}}),window.addEventListener("test",Au,Au),window.removeEventListener("test",Au,Au)}catch{hv=!1}function YP(t,e,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var cd=!1,t0=null,n0=!1,pv=null,qP={onError:function(t){cd=!0,t0=t}};function QP(t,e,n,r,i,o,s,a,l){cd=!1,t0=null,YP.apply(qP,arguments)}function eN(t,e,n,r,i,o,s,a,l){if(QP.apply(this,arguments),cd){if(cd){var c=t0;cd=!1,t0=null}else throw Error(fe(198));n0||(n0=!0,pv=c)}}function Fl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Mk(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function tI(t){if(Fl(t)!==t)throw Error(fe(188))}function tN(t){var e=t.alternate;if(!e){if(e=Fl(t),e===null)throw Error(fe(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return tI(i),t;if(o===r)return tI(i),e;o=o.sibling}throw Error(fe(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(fe(189))}}if(n.alternate!==r)throw Error(fe(190))}if(n.tag!==3)throw Error(fe(188));return n.stateNode.current===n?t:e}function Lk(t){return t=tN(t),t!==null?Uk(t):null}function Uk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Uk(t);if(e!==null)return e;t=t.sibling}return null}var Vk=Qr.unstable_scheduleCallback,nI=Qr.unstable_cancelCallback,nN=Qr.unstable_shouldYield,rN=Qr.unstable_requestPaint,nn=Qr.unstable_now,iN=Qr.unstable_getCurrentPriorityLevel,ky=Qr.unstable_ImmediatePriority,Gk=Qr.unstable_UserBlockingPriority,r0=Qr.unstable_NormalPriority,oN=Qr.unstable_LowPriority,Wk=Qr.unstable_IdlePriority,dp=null,No=null;function sN(t){if(No&&typeof No.onCommitFiberRoot=="function")try{No.onCommitFiberRoot(dp,t,void 0,(t.current.flags&128)===128)}catch{}}var Zi=Math.clz32?Math.clz32:cN,aN=Math.log,lN=Math.LN2;function cN(t){return t>>>=0,t===0?32:31-(aN(t)/lN|0)|0}var Lf=64,Uf=4194304;function Ku(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function i0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Ku(a):(o&=s,o!==0&&(r=Ku(o)))}else s=n&~i,s!==0?r=Ku(s):o!==0&&(r=Ku(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Zi(e),i=1<<n,r|=t[n],e&=~i;return r}function uN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-Zi(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=uN(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function gv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function zk(){var t=Lf;return Lf<<=1,!(Lf&4194240)&&(Lf=64),t}function lg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function pf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Zi(e),t[e]=n}function fN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Zi(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function Ey(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Zi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var yt=0;function jk(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Hk,Ty,Zk,$k,Xk,mv=!1,Vf=[],Ia=null,ba=null,Aa=null,Rd=new Map,_d=new Map,aa=[],hN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rI(t,e){switch(t){case"focusin":case"focusout":Ia=null;break;case"dragenter":case"dragleave":ba=null;break;case"mouseover":case"mouseout":Aa=null;break;case"pointerover":case"pointerout":Rd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_d.delete(e.pointerId)}}function wu(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=mf(e),e!==null&&Ty(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function pN(t,e,n,r,i){switch(e){case"focusin":return Ia=wu(Ia,t,e,n,r,i),!0;case"dragenter":return ba=wu(ba,t,e,n,r,i),!0;case"mouseover":return Aa=wu(Aa,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Rd.set(o,wu(Rd.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,_d.set(o,wu(_d.get(o)||null,t,e,n,r,i)),!0}return!1}function Kk(t){var e=il(t.target);if(e!==null){var n=Fl(e);if(n!==null){if(e=n.tag,e===13){if(e=Mk(n),e!==null){t.blockedOn=e,Xk(t.priority,function(){Zk(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function mh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=vv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);dv=r,n.target.dispatchEvent(r),dv=null}else return e=mf(n),e!==null&&Ty(e),t.blockedOn=n,!1;e.shift()}return!0}function iI(t,e,n){mh(t)&&n.delete(e)}function gN(){mv=!1,Ia!==null&&mh(Ia)&&(Ia=null),ba!==null&&mh(ba)&&(ba=null),Aa!==null&&mh(Aa)&&(Aa=null),Rd.forEach(iI),_d.forEach(iI)}function Su(t,e){t.blockedOn===e&&(t.blockedOn=null,mv||(mv=!0,Qr.unstable_scheduleCallback(Qr.unstable_NormalPriority,gN)))}function Dd(t){function e(i){return Su(i,t)}if(0<Vf.length){Su(Vf[0],t);for(var n=1;n<Vf.length;n++){var r=Vf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ia!==null&&Su(Ia,t),ba!==null&&Su(ba,t),Aa!==null&&Su(Aa,t),Rd.forEach(e),_d.forEach(e),n=0;n<aa.length;n++)r=aa[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<aa.length&&(n=aa[0],n.blockedOn===null);)Kk(n),n.blockedOn===null&&aa.shift()}var yc=Us.ReactCurrentBatchConfig,o0=!0;function mN(t,e,n,r){var i=yt,o=yc.transition;yc.transition=null;try{yt=1,Ry(t,e,n,r)}finally{yt=i,yc.transition=o}}function vN(t,e,n,r){var i=yt,o=yc.transition;yc.transition=null;try{yt=4,Ry(t,e,n,r)}finally{yt=i,yc.transition=o}}function Ry(t,e,n,r){if(o0){var i=vv(t,e,n,r);if(i===null)Cg(t,e,r,s0,n),rI(t,r);else if(pN(i,t,e,n,r))r.stopPropagation();else if(rI(t,r),e&4&&-1<hN.indexOf(t)){for(;i!==null;){var o=mf(i);if(o!==null&&Hk(o),o=vv(t,e,n,r),o===null&&Cg(t,e,r,s0,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Cg(t,e,r,null,n)}}var s0=null;function vv(t,e,n,r){if(s0=null,t=Sy(r),t=il(t),t!==null)if(e=Fl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Mk(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return s0=t,null}function Jk(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(iN()){case ky:return 1;case Gk:return 4;case r0:case oN:return 16;case Wk:return 536870912;default:return 16}default:return 16}}var ua=null,_y=null,vh=null;function Yk(){if(vh)return vh;var t,e=_y,n=e.length,r,i="value"in ua?ua.value:ua.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return vh=i.slice(t,1<r?1-r:void 0)}function Ch(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Gf(){return!0}function oI(){return!1}function ni(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Gf:oI,this.isPropagationStopped=oI,this}return Xt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Gf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Gf)},persist:function(){},isPersistent:Gf}),e}var nu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dy=ni(nu),gf=Xt({},nu,{view:0,detail:0}),CN=ni(gf),cg,ug,ku,fp=Xt({},gf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Py,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ku&&(ku&&t.type==="mousemove"?(cg=t.screenX-ku.screenX,ug=t.screenY-ku.screenY):ug=cg=0,ku=t),cg)},movementY:function(t){return"movementY"in t?t.movementY:ug}}),sI=ni(fp),yN=Xt({},fp,{dataTransfer:0}),xN=ni(yN),IN=Xt({},gf,{relatedTarget:0}),dg=ni(IN),bN=Xt({},nu,{animationName:0,elapsedTime:0,pseudoElement:0}),AN=ni(bN),wN=Xt({},nu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),SN=ni(wN),kN=Xt({},nu,{data:0}),aI=ni(kN),EN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _N(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=RN[t])?!!e[t]:!1}function Py(){return _N}var DN=Xt({},gf,{key:function(t){if(t.key){var e=EN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ch(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?TN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Py,charCode:function(t){return t.type==="keypress"?Ch(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ch(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),PN=ni(DN),NN=Xt({},fp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lI=ni(NN),BN=Xt({},gf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Py}),FN=ni(BN),ON=Xt({},nu,{propertyName:0,elapsedTime:0,pseudoElement:0}),MN=ni(ON),LN=Xt({},fp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),UN=ni(LN),VN=[9,13,27,32],Ny=Ds&&"CompositionEvent"in window,ud=null;Ds&&"documentMode"in document&&(ud=document.documentMode);var GN=Ds&&"TextEvent"in window&&!ud,qk=Ds&&(!Ny||ud&&8<ud&&11>=ud),cI=" ",uI=!1;function Qk(t,e){switch(t){case"keyup":return VN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var rc=!1;function WN(t,e){switch(t){case"compositionend":return eE(e);case"keypress":return e.which!==32?null:(uI=!0,cI);case"textInput":return t=e.data,t===cI&&uI?null:t;default:return null}}function zN(t,e){if(rc)return t==="compositionend"||!Ny&&Qk(t,e)?(t=Yk(),vh=_y=ua=null,rc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return qk&&e.locale!=="ko"?null:e.data;default:return null}}var jN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!jN[t.type]:e==="textarea"}function tE(t,e,n,r){Pk(r),e=a0(e,"onChange"),0<e.length&&(n=new Dy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var dd=null,Pd=null;function HN(t){fE(t,0)}function hp(t){var e=sc(t);if(Sk(e))return t}function ZN(t,e){if(t==="change")return e}var nE=!1;if(Ds){var fg;if(Ds){var hg="oninput"in document;if(!hg){var fI=document.createElement("div");fI.setAttribute("oninput","return;"),hg=typeof fI.oninput=="function"}fg=hg}else fg=!1;nE=fg&&(!document.documentMode||9<document.documentMode)}function hI(){dd&&(dd.detachEvent("onpropertychange",rE),Pd=dd=null)}function rE(t){if(t.propertyName==="value"&&hp(Pd)){var e=[];tE(e,Pd,t,Sy(t)),Ok(HN,e)}}function $N(t,e,n){t==="focusin"?(hI(),dd=e,Pd=n,dd.attachEvent("onpropertychange",rE)):t==="focusout"&&hI()}function XN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return hp(Pd)}function KN(t,e){if(t==="click")return hp(e)}function JN(t,e){if(t==="input"||t==="change")return hp(e)}function YN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ki=typeof Object.is=="function"?Object.is:YN;function Nd(t,e){if(Ki(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Qm.call(e,i)||!Ki(t[i],e[i]))return!1}return!0}function pI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function gI(t,e){var n=pI(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=pI(n)}}function iE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?iE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function oE(){for(var t=window,e=e0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=e0(t.document)}return e}function By(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function qN(t){var e=oE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&iE(n.ownerDocument.documentElement,n)){if(r!==null&&By(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=gI(n,o);var s=gI(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var QN=Ds&&"documentMode"in document&&11>=document.documentMode,ic=null,Cv=null,fd=null,yv=!1;function mI(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;yv||ic==null||ic!==e0(r)||(r=ic,"selectionStart"in r&&By(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),fd&&Nd(fd,r)||(fd=r,r=a0(Cv,"onSelect"),0<r.length&&(e=new Dy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ic)))}function Wf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var oc={animationend:Wf("Animation","AnimationEnd"),animationiteration:Wf("Animation","AnimationIteration"),animationstart:Wf("Animation","AnimationStart"),transitionend:Wf("Transition","TransitionEnd")},pg={},sE={};Ds&&(sE=document.createElement("div").style,"AnimationEvent"in window||(delete oc.animationend.animation,delete oc.animationiteration.animation,delete oc.animationstart.animation),"TransitionEvent"in window||delete oc.transitionend.transition);function pp(t){if(pg[t])return pg[t];if(!oc[t])return t;var e=oc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in sE)return pg[t]=e[n];return t}var aE=pp("animationend"),lE=pp("animationiteration"),cE=pp("animationstart"),uE=pp("transitionend"),dE=new Map,vI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oa(t,e){dE.set(t,e),Bl(e,[t])}for(var gg=0;gg<vI.length;gg++){var mg=vI[gg],e5=mg.toLowerCase(),t5=mg[0].toUpperCase()+mg.slice(1);Oa(e5,"on"+t5)}Oa(aE,"onAnimationEnd");Oa(lE,"onAnimationIteration");Oa(cE,"onAnimationStart");Oa("dblclick","onDoubleClick");Oa("focusin","onFocus");Oa("focusout","onBlur");Oa(uE,"onTransitionEnd");Oc("onMouseEnter",["mouseout","mouseover"]);Oc("onMouseLeave",["mouseout","mouseover"]);Oc("onPointerEnter",["pointerout","pointerover"]);Oc("onPointerLeave",["pointerout","pointerover"]);Bl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Bl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Bl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Bl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Bl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Bl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ju="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),n5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ju));function CI(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,eN(r,e,void 0,t),t.currentTarget=null}function fE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;CI(i,a,c),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;CI(i,a,c),o=l}}}if(n0)throw t=pv,n0=!1,pv=null,t}function Nt(t,e){var n=e[wv];n===void 0&&(n=e[wv]=new Set);var r=t+"__bubble";n.has(r)||(hE(e,t,2,!1),n.add(r))}function vg(t,e,n){var r=0;e&&(r|=4),hE(n,t,r,e)}var zf="_reactListening"+Math.random().toString(36).slice(2);function Bd(t){if(!t[zf]){t[zf]=!0,xk.forEach(function(n){n!=="selectionchange"&&(n5.has(n)||vg(n,!1,t),vg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[zf]||(e[zf]=!0,vg("selectionchange",!1,e))}}function hE(t,e,n,r){switch(Jk(e)){case 1:var i=mN;break;case 4:i=vN;break;default:i=Ry}n=i.bind(null,e,n,t),i=void 0,!hv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Cg(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=il(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}Ok(function(){var c=o,u=Sy(n),d=[];e:{var f=dE.get(t);if(f!==void 0){var h=Dy,p=t;switch(t){case"keypress":if(Ch(n)===0)break e;case"keydown":case"keyup":h=PN;break;case"focusin":p="focus",h=dg;break;case"focusout":p="blur",h=dg;break;case"beforeblur":case"afterblur":h=dg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=sI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=xN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=FN;break;case aE:case lE:case cE:h=AN;break;case uE:h=MN;break;case"scroll":h=CN;break;case"wheel":h=UN;break;case"copy":case"cut":case"paste":h=SN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=lI}var m=(e&4)!==0,C=!m&&t==="scroll",v=m?f!==null?f+"Capture":null:f;m=[];for(var g=c,y;g!==null;){y=g;var I=y.stateNode;if(y.tag===5&&I!==null&&(y=I,v!==null&&(I=Td(g,v),I!=null&&m.push(Fd(g,I,y)))),C)break;g=g.return}0<m.length&&(f=new h(f,p,null,n,u),d.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==dv&&(p=n.relatedTarget||n.fromElement)&&(il(p)||p[Ps]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=c,p=p?il(p):null,p!==null&&(C=Fl(p),p!==C||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=c),h!==p)){if(m=sI,I="onMouseLeave",v="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(m=lI,I="onPointerLeave",v="onPointerEnter",g="pointer"),C=h==null?f:sc(h),y=p==null?f:sc(p),f=new m(I,g+"leave",h,n,u),f.target=C,f.relatedTarget=y,I=null,il(u)===c&&(m=new m(v,g+"enter",p,n,u),m.target=y,m.relatedTarget=C,I=m),C=I,h&&p)t:{for(m=h,v=p,g=0,y=m;y;y=$l(y))g++;for(y=0,I=v;I;I=$l(I))y++;for(;0<g-y;)m=$l(m),g--;for(;0<y-g;)v=$l(v),y--;for(;g--;){if(m===v||v!==null&&m===v.alternate)break t;m=$l(m),v=$l(v)}m=null}else m=null;h!==null&&yI(d,f,h,m,!1),p!==null&&C!==null&&yI(d,C,p,m,!0)}}e:{if(f=c?sc(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var b=ZN;else if(dI(f))if(nE)b=JN;else{b=XN;var E=$N}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=KN);if(b&&(b=b(t,c))){tE(d,b,n,u);break e}E&&E(t,f,c),t==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&sv(f,"number",f.value)}switch(E=c?sc(c):window,t){case"focusin":(dI(E)||E.contentEditable==="true")&&(ic=E,Cv=c,fd=null);break;case"focusout":fd=Cv=ic=null;break;case"mousedown":yv=!0;break;case"contextmenu":case"mouseup":case"dragend":yv=!1,mI(d,n,u);break;case"selectionchange":if(QN)break;case"keydown":case"keyup":mI(d,n,u)}var w;if(Ny)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else rc?Qk(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(qk&&n.locale!=="ko"&&(rc||k!=="onCompositionStart"?k==="onCompositionEnd"&&rc&&(w=Yk()):(ua=u,_y="value"in ua?ua.value:ua.textContent,rc=!0)),E=a0(c,k),0<E.length&&(k=new aI(k,t,null,n,u),d.push({event:k,listeners:E}),w?k.data=w:(w=eE(n),w!==null&&(k.data=w)))),(w=GN?WN(t,n):zN(t,n))&&(c=a0(c,"onBeforeInput"),0<c.length&&(u=new aI("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=w))}fE(d,e)})}function Fd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function a0(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Td(t,n),o!=null&&r.unshift(Fd(t,o,i)),o=Td(t,e),o!=null&&r.push(Fd(t,o,i))),t=t.return}return r}function $l(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function yI(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=Td(n,o),l!=null&&s.unshift(Fd(n,l,a))):i||(l=Td(n,o),l!=null&&s.push(Fd(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var r5=/\r\n?/g,i5=/\u0000|\uFFFD/g;function xI(t){return(typeof t=="string"?t:""+t).replace(r5,`
`).replace(i5,"")}function jf(t,e,n){if(e=xI(e),xI(t)!==e&&n)throw Error(fe(425))}function l0(){}var xv=null,Iv=null;function bv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Av=typeof setTimeout=="function"?setTimeout:void 0,o5=typeof clearTimeout=="function"?clearTimeout:void 0,II=typeof Promise=="function"?Promise:void 0,s5=typeof queueMicrotask=="function"?queueMicrotask:typeof II<"u"?function(t){return II.resolve(null).then(t).catch(a5)}:Av;function a5(t){setTimeout(function(){throw t})}function yg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Dd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Dd(e)}function wa(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function bI(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ru=Math.random().toString(36).slice(2),ho="__reactFiber$"+ru,Od="__reactProps$"+ru,Ps="__reactContainer$"+ru,wv="__reactEvents$"+ru,l5="__reactListeners$"+ru,c5="__reactHandles$"+ru;function il(t){var e=t[ho];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ps]||n[ho]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=bI(t);t!==null;){if(n=t[ho])return n;t=bI(t)}return e}t=n,n=t.parentNode}return null}function mf(t){return t=t[ho]||t[Ps],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function sc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(fe(33))}function gp(t){return t[Od]||null}var Sv=[],ac=-1;function Ma(t){return{current:t}}function Lt(t){0>ac||(t.current=Sv[ac],Sv[ac]=null,ac--)}function _t(t,e){ac++,Sv[ac]=t.current,t.current=e}var Pa={},Yn=Ma(Pa),Er=Ma(!1),yl=Pa;function Mc(t,e){var n=t.type.contextTypes;if(!n)return Pa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Tr(t){return t=t.childContextTypes,t!=null}function c0(){Lt(Er),Lt(Yn)}function AI(t,e,n){if(Yn.current!==Pa)throw Error(fe(168));_t(Yn,e),_t(Er,n)}function pE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(fe(108,$P(t)||"Unknown",i));return Xt({},n,r)}function u0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Pa,yl=Yn.current,_t(Yn,t),_t(Er,Er.current),!0}function wI(t,e,n){var r=t.stateNode;if(!r)throw Error(fe(169));n?(t=pE(t,e,yl),r.__reactInternalMemoizedMergedChildContext=t,Lt(Er),Lt(Yn),_t(Yn,t)):Lt(Er),_t(Er,n)}var Jo=null,mp=!1,xg=!1;function gE(t){Jo===null?Jo=[t]:Jo.push(t)}function u5(t){mp=!0,gE(t)}function La(){if(!xg&&Jo!==null){xg=!0;var t=0,e=yt;try{var n=Jo;for(yt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Jo=null,mp=!1}catch(i){throw Jo!==null&&(Jo=Jo.slice(t+1)),Vk(ky,La),i}finally{yt=e,xg=!1}}return null}var lc=[],cc=0,d0=null,f0=0,ai=[],li=0,xl=null,ts=1,ns="";function Xa(t,e){lc[cc++]=f0,lc[cc++]=d0,d0=t,f0=e}function mE(t,e,n){ai[li++]=ts,ai[li++]=ns,ai[li++]=xl,xl=t;var r=ts;t=ns;var i=32-Zi(r)-1;r&=~(1<<i),n+=1;var o=32-Zi(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,ts=1<<32-Zi(e)+i|n<<i|r,ns=o+t}else ts=1<<o|n<<i|r,ns=t}function Fy(t){t.return!==null&&(Xa(t,1),mE(t,1,0))}function Oy(t){for(;t===d0;)d0=lc[--cc],lc[cc]=null,f0=lc[--cc],lc[cc]=null;for(;t===xl;)xl=ai[--li],ai[li]=null,ns=ai[--li],ai[li]=null,ts=ai[--li],ai[li]=null}var Yr=null,Kr=null,Ht=!1,Li=null;function vE(t,e){var n=ui(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function SI(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Yr=t,Kr=wa(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Yr=t,Kr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=xl!==null?{id:ts,overflow:ns}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ui(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Yr=t,Kr=null,!0):!1;default:return!1}}function kv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ev(t){if(Ht){var e=Kr;if(e){var n=e;if(!SI(t,e)){if(kv(t))throw Error(fe(418));e=wa(n.nextSibling);var r=Yr;e&&SI(t,e)?vE(r,n):(t.flags=t.flags&-4097|2,Ht=!1,Yr=t)}}else{if(kv(t))throw Error(fe(418));t.flags=t.flags&-4097|2,Ht=!1,Yr=t}}}function kI(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Yr=t}function Hf(t){if(t!==Yr)return!1;if(!Ht)return kI(t),Ht=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!bv(t.type,t.memoizedProps)),e&&(e=Kr)){if(kv(t))throw CE(),Error(fe(418));for(;e;)vE(t,e),e=wa(e.nextSibling)}if(kI(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(fe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Kr=wa(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Kr=null}}else Kr=Yr?wa(t.stateNode.nextSibling):null;return!0}function CE(){for(var t=Kr;t;)t=wa(t.nextSibling)}function Lc(){Kr=Yr=null,Ht=!1}function My(t){Li===null?Li=[t]:Li.push(t)}var d5=Us.ReactCurrentBatchConfig;function Eu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(fe(309));var r=n.stateNode}if(!r)throw Error(fe(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(fe(284));if(!n._owner)throw Error(fe(290,t))}return t}function Zf(t,e){throw t=Object.prototype.toString.call(e),Error(fe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function EI(t){var e=t._init;return e(t._payload)}function yE(t){function e(v,g){if(t){var y=v.deletions;y===null?(v.deletions=[g],v.flags|=16):y.push(g)}}function n(v,g){if(!t)return null;for(;g!==null;)e(v,g),g=g.sibling;return null}function r(v,g){for(v=new Map;g!==null;)g.key!==null?v.set(g.key,g):v.set(g.index,g),g=g.sibling;return v}function i(v,g){return v=Ta(v,g),v.index=0,v.sibling=null,v}function o(v,g,y){return v.index=y,t?(y=v.alternate,y!==null?(y=y.index,y<g?(v.flags|=2,g):y):(v.flags|=2,g)):(v.flags|=1048576,g)}function s(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,g,y,I){return g===null||g.tag!==6?(g=Eg(y,v.mode,I),g.return=v,g):(g=i(g,y),g.return=v,g)}function l(v,g,y,I){var b=y.type;return b===nc?u(v,g,y.props.children,I,y.key):g!==null&&(g.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ia&&EI(b)===g.type)?(I=i(g,y.props),I.ref=Eu(v,g,y),I.return=v,I):(I=Sh(y.type,y.key,y.props,null,v.mode,I),I.ref=Eu(v,g,y),I.return=v,I)}function c(v,g,y,I){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=Tg(y,v.mode,I),g.return=v,g):(g=i(g,y.children||[]),g.return=v,g)}function u(v,g,y,I,b){return g===null||g.tag!==7?(g=hl(y,v.mode,I,b),g.return=v,g):(g=i(g,y),g.return=v,g)}function d(v,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Eg(""+g,v.mode,y),g.return=v,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ff:return y=Sh(g.type,g.key,g.props,null,v.mode,y),y.ref=Eu(v,null,g),y.return=v,y;case tc:return g=Tg(g,v.mode,y),g.return=v,g;case ia:var I=g._init;return d(v,I(g._payload),y)}if(Xu(g)||bu(g))return g=hl(g,v.mode,y,null),g.return=v,g;Zf(v,g)}return null}function f(v,g,y,I){var b=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return b!==null?null:a(v,g,""+y,I);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ff:return y.key===b?l(v,g,y,I):null;case tc:return y.key===b?c(v,g,y,I):null;case ia:return b=y._init,f(v,g,b(y._payload),I)}if(Xu(y)||bu(y))return b!==null?null:u(v,g,y,I,null);Zf(v,y)}return null}function h(v,g,y,I,b){if(typeof I=="string"&&I!==""||typeof I=="number")return v=v.get(y)||null,a(g,v,""+I,b);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Ff:return v=v.get(I.key===null?y:I.key)||null,l(g,v,I,b);case tc:return v=v.get(I.key===null?y:I.key)||null,c(g,v,I,b);case ia:var E=I._init;return h(v,g,y,E(I._payload),b)}if(Xu(I)||bu(I))return v=v.get(y)||null,u(g,v,I,b,null);Zf(g,I)}return null}function p(v,g,y,I){for(var b=null,E=null,w=g,k=g=0,D=null;w!==null&&k<y.length;k++){w.index>k?(D=w,w=null):D=w.sibling;var T=f(v,w,y[k],I);if(T===null){w===null&&(w=D);break}t&&w&&T.alternate===null&&e(v,w),g=o(T,g,k),E===null?b=T:E.sibling=T,E=T,w=D}if(k===y.length)return n(v,w),Ht&&Xa(v,k),b;if(w===null){for(;k<y.length;k++)w=d(v,y[k],I),w!==null&&(g=o(w,g,k),E===null?b=w:E.sibling=w,E=w);return Ht&&Xa(v,k),b}for(w=r(v,w);k<y.length;k++)D=h(w,v,k,y[k],I),D!==null&&(t&&D.alternate!==null&&w.delete(D.key===null?k:D.key),g=o(D,g,k),E===null?b=D:E.sibling=D,E=D);return t&&w.forEach(function(R){return e(v,R)}),Ht&&Xa(v,k),b}function m(v,g,y,I){var b=bu(y);if(typeof b!="function")throw Error(fe(150));if(y=b.call(y),y==null)throw Error(fe(151));for(var E=b=null,w=g,k=g=0,D=null,T=y.next();w!==null&&!T.done;k++,T=y.next()){w.index>k?(D=w,w=null):D=w.sibling;var R=f(v,w,T.value,I);if(R===null){w===null&&(w=D);break}t&&w&&R.alternate===null&&e(v,w),g=o(R,g,k),E===null?b=R:E.sibling=R,E=R,w=D}if(T.done)return n(v,w),Ht&&Xa(v,k),b;if(w===null){for(;!T.done;k++,T=y.next())T=d(v,T.value,I),T!==null&&(g=o(T,g,k),E===null?b=T:E.sibling=T,E=T);return Ht&&Xa(v,k),b}for(w=r(v,w);!T.done;k++,T=y.next())T=h(w,v,k,T.value,I),T!==null&&(t&&T.alternate!==null&&w.delete(T.key===null?k:T.key),g=o(T,g,k),E===null?b=T:E.sibling=T,E=T);return t&&w.forEach(function(P){return e(v,P)}),Ht&&Xa(v,k),b}function C(v,g,y,I){if(typeof y=="object"&&y!==null&&y.type===nc&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Ff:e:{for(var b=y.key,E=g;E!==null;){if(E.key===b){if(b=y.type,b===nc){if(E.tag===7){n(v,E.sibling),g=i(E,y.props.children),g.return=v,v=g;break e}}else if(E.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ia&&EI(b)===E.type){n(v,E.sibling),g=i(E,y.props),g.ref=Eu(v,E,y),g.return=v,v=g;break e}n(v,E);break}else e(v,E);E=E.sibling}y.type===nc?(g=hl(y.props.children,v.mode,I,y.key),g.return=v,v=g):(I=Sh(y.type,y.key,y.props,null,v.mode,I),I.ref=Eu(v,g,y),I.return=v,v=I)}return s(v);case tc:e:{for(E=y.key;g!==null;){if(g.key===E)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(v,g.sibling),g=i(g,y.children||[]),g.return=v,v=g;break e}else{n(v,g);break}else e(v,g);g=g.sibling}g=Tg(y,v.mode,I),g.return=v,v=g}return s(v);case ia:return E=y._init,C(v,g,E(y._payload),I)}if(Xu(y))return p(v,g,y,I);if(bu(y))return m(v,g,y,I);Zf(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(v,g.sibling),g=i(g,y),g.return=v,v=g):(n(v,g),g=Eg(y,v.mode,I),g.return=v,v=g),s(v)):n(v,g)}return C}var Uc=yE(!0),xE=yE(!1),h0=Ma(null),p0=null,uc=null,Ly=null;function Uy(){Ly=uc=p0=null}function Vy(t){var e=h0.current;Lt(h0),t._currentValue=e}function Tv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function xc(t,e){p0=t,Ly=uc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Sr=!0),t.firstContext=null)}function mi(t){var e=t._currentValue;if(Ly!==t)if(t={context:t,memoizedValue:e,next:null},uc===null){if(p0===null)throw Error(fe(308));uc=t,p0.dependencies={lanes:0,firstContext:t}}else uc=uc.next=t;return e}var ol=null;function Gy(t){ol===null?ol=[t]:ol.push(t)}function IE(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Gy(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ns(t,r)}function Ns(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var oa=!1;function Wy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Es(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Sa(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,dt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ns(t,n)}return i=r.interleaved,i===null?(e.next=e,Gy(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ns(t,n)}function yh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ey(t,n)}}function TI(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function g0(t,e,n,r){var i=t.updateQueue;oa=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=i.baseState;s=0,u=c=l=null,a=o;do{var f=a.lane,h=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(f=e,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Xt({},d,f);break e;case 2:oa=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=h,l=d):u=u.next=h,s|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);bl|=s,t.lanes=s,t.memoizedState=d}}function RI(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(fe(191,i));i.call(r)}}}var vf={},Bo=Ma(vf),Md=Ma(vf),Ld=Ma(vf);function sl(t){if(t===vf)throw Error(fe(174));return t}function zy(t,e){switch(_t(Ld,e),_t(Md,t),_t(Bo,vf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=lv(e,t)}Lt(Bo),_t(Bo,e)}function Vc(){Lt(Bo),Lt(Md),Lt(Ld)}function AE(t){sl(Ld.current);var e=sl(Bo.current),n=lv(e,t.type);e!==n&&(_t(Md,t),_t(Bo,n))}function jy(t){Md.current===t&&(Lt(Bo),Lt(Md))}var Zt=Ma(0);function m0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ig=[];function Hy(){for(var t=0;t<Ig.length;t++)Ig[t]._workInProgressVersionPrimary=null;Ig.length=0}var xh=Us.ReactCurrentDispatcher,bg=Us.ReactCurrentBatchConfig,Il=0,$t=null,vn=null,Sn=null,v0=!1,hd=!1,Ud=0,f5=0;function jn(){throw Error(fe(321))}function Zy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ki(t[n],e[n]))return!1;return!0}function $y(t,e,n,r,i,o){if(Il=o,$t=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xh.current=t===null||t.memoizedState===null?m5:v5,t=n(r,i),hd){o=0;do{if(hd=!1,Ud=0,25<=o)throw Error(fe(301));o+=1,Sn=vn=null,e.updateQueue=null,xh.current=C5,t=n(r,i)}while(hd)}if(xh.current=C0,e=vn!==null&&vn.next!==null,Il=0,Sn=vn=$t=null,v0=!1,e)throw Error(fe(300));return t}function Xy(){var t=Ud!==0;return Ud=0,t}function uo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sn===null?$t.memoizedState=Sn=t:Sn=Sn.next=t,Sn}function vi(){if(vn===null){var t=$t.alternate;t=t!==null?t.memoizedState:null}else t=vn.next;var e=Sn===null?$t.memoizedState:Sn.next;if(e!==null)Sn=e,vn=t;else{if(t===null)throw Error(fe(310));vn=t,t={memoizedState:vn.memoizedState,baseState:vn.baseState,baseQueue:vn.baseQueue,queue:vn.queue,next:null},Sn===null?$t.memoizedState=Sn=t:Sn=Sn.next=t}return Sn}function Vd(t,e){return typeof e=="function"?e(t):e}function Ag(t){var e=vi(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var r=vn,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,c=o;do{var u=c.lane;if((Il&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,s=r):l=l.next=d,$t.lanes|=u,bl|=u}c=c.next}while(c!==null&&c!==o);l===null?s=r:l.next=a,Ki(r,e.memoizedState)||(Sr=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,$t.lanes|=o,bl|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function wg(t){var e=vi(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);Ki(o,e.memoizedState)||(Sr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function wE(){}function SE(t,e){var n=$t,r=vi(),i=e(),o=!Ki(r.memoizedState,i);if(o&&(r.memoizedState=i,Sr=!0),r=r.queue,Ky(TE.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Sn!==null&&Sn.memoizedState.tag&1){if(n.flags|=2048,Gd(9,EE.bind(null,n,r,i,e),void 0,null),En===null)throw Error(fe(349));Il&30||kE(n,e,i)}return i}function kE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=$t.updateQueue,e===null?(e={lastEffect:null,stores:null},$t.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function EE(t,e,n,r){e.value=n,e.getSnapshot=r,RE(e)&&_E(t)}function TE(t,e,n){return n(function(){RE(e)&&_E(t)})}function RE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ki(t,n)}catch{return!0}}function _E(t){var e=Ns(t,1);e!==null&&$i(e,t,1,-1)}function _I(t){var e=uo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vd,lastRenderedState:t},e.queue=t,t=t.dispatch=g5.bind(null,$t,t),[e.memoizedState,t]}function Gd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=$t.updateQueue,e===null?(e={lastEffect:null,stores:null},$t.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function DE(){return vi().memoizedState}function Ih(t,e,n,r){var i=uo();$t.flags|=t,i.memoizedState=Gd(1|e,n,void 0,r===void 0?null:r)}function vp(t,e,n,r){var i=vi();r=r===void 0?null:r;var o=void 0;if(vn!==null){var s=vn.memoizedState;if(o=s.destroy,r!==null&&Zy(r,s.deps)){i.memoizedState=Gd(e,n,o,r);return}}$t.flags|=t,i.memoizedState=Gd(1|e,n,o,r)}function DI(t,e){return Ih(8390656,8,t,e)}function Ky(t,e){return vp(2048,8,t,e)}function PE(t,e){return vp(4,2,t,e)}function NE(t,e){return vp(4,4,t,e)}function BE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function FE(t,e,n){return n=n!=null?n.concat([t]):null,vp(4,4,BE.bind(null,e,t),n)}function Jy(){}function OE(t,e){var n=vi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ME(t,e){var n=vi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function LE(t,e,n){return Il&21?(Ki(n,e)||(n=zk(),$t.lanes|=n,bl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Sr=!0),t.memoizedState=n)}function h5(t,e){var n=yt;yt=n!==0&&4>n?n:4,t(!0);var r=bg.transition;bg.transition={};try{t(!1),e()}finally{yt=n,bg.transition=r}}function UE(){return vi().memoizedState}function p5(t,e,n){var r=Ea(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},VE(t))GE(e,n);else if(n=IE(t,e,n,r),n!==null){var i=ur();$i(n,t,r,i),WE(n,e,r)}}function g5(t,e,n){var r=Ea(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(VE(t))GE(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Ki(a,s)){var l=e.interleaved;l===null?(i.next=i,Gy(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=IE(t,e,i,r),n!==null&&(i=ur(),$i(n,t,r,i),WE(n,e,r))}}function VE(t){var e=t.alternate;return t===$t||e!==null&&e===$t}function GE(t,e){hd=v0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function WE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ey(t,n)}}var C0={readContext:mi,useCallback:jn,useContext:jn,useEffect:jn,useImperativeHandle:jn,useInsertionEffect:jn,useLayoutEffect:jn,useMemo:jn,useReducer:jn,useRef:jn,useState:jn,useDebugValue:jn,useDeferredValue:jn,useTransition:jn,useMutableSource:jn,useSyncExternalStore:jn,useId:jn,unstable_isNewReconciler:!1},m5={readContext:mi,useCallback:function(t,e){return uo().memoizedState=[t,e===void 0?null:e],t},useContext:mi,useEffect:DI,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ih(4194308,4,BE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ih(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ih(4,2,t,e)},useMemo:function(t,e){var n=uo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=uo();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=p5.bind(null,$t,t),[r.memoizedState,t]},useRef:function(t){var e=uo();return t={current:t},e.memoizedState=t},useState:_I,useDebugValue:Jy,useDeferredValue:function(t){return uo().memoizedState=t},useTransition:function(){var t=_I(!1),e=t[0];return t=h5.bind(null,t[1]),uo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=$t,i=uo();if(Ht){if(n===void 0)throw Error(fe(407));n=n()}else{if(n=e(),En===null)throw Error(fe(349));Il&30||kE(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,DI(TE.bind(null,r,o,t),[t]),r.flags|=2048,Gd(9,EE.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=uo(),e=En.identifierPrefix;if(Ht){var n=ns,r=ts;n=(r&~(1<<32-Zi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ud++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=f5++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},v5={readContext:mi,useCallback:OE,useContext:mi,useEffect:Ky,useImperativeHandle:FE,useInsertionEffect:PE,useLayoutEffect:NE,useMemo:ME,useReducer:Ag,useRef:DE,useState:function(){return Ag(Vd)},useDebugValue:Jy,useDeferredValue:function(t){var e=vi();return LE(e,vn.memoizedState,t)},useTransition:function(){var t=Ag(Vd)[0],e=vi().memoizedState;return[t,e]},useMutableSource:wE,useSyncExternalStore:SE,useId:UE,unstable_isNewReconciler:!1},C5={readContext:mi,useCallback:OE,useContext:mi,useEffect:Ky,useImperativeHandle:FE,useInsertionEffect:PE,useLayoutEffect:NE,useMemo:ME,useReducer:wg,useRef:DE,useState:function(){return wg(Vd)},useDebugValue:Jy,useDeferredValue:function(t){var e=vi();return vn===null?e.memoizedState=t:LE(e,vn.memoizedState,t)},useTransition:function(){var t=wg(Vd)[0],e=vi().memoizedState;return[t,e]},useMutableSource:wE,useSyncExternalStore:SE,useId:UE,unstable_isNewReconciler:!1};function ki(t,e){if(t&&t.defaultProps){e=Xt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Rv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Xt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Cp={isMounted:function(t){return(t=t._reactInternals)?Fl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ur(),i=Ea(t),o=Es(r,i);o.payload=e,n!=null&&(o.callback=n),e=Sa(t,o,i),e!==null&&($i(e,t,i,r),yh(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ur(),i=Ea(t),o=Es(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Sa(t,o,i),e!==null&&($i(e,t,i,r),yh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ur(),r=Ea(t),i=Es(n,r);i.tag=2,e!=null&&(i.callback=e),e=Sa(t,i,r),e!==null&&($i(e,t,r,n),yh(e,t,r))}};function PI(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Nd(n,r)||!Nd(i,o):!0}function zE(t,e,n){var r=!1,i=Pa,o=e.contextType;return typeof o=="object"&&o!==null?o=mi(o):(i=Tr(e)?yl:Yn.current,r=e.contextTypes,o=(r=r!=null)?Mc(t,i):Pa),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Cp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function NI(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Cp.enqueueReplaceState(e,e.state,null)}function _v(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Wy(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=mi(o):(o=Tr(e)?yl:Yn.current,i.context=Mc(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Rv(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Cp.enqueueReplaceState(i,i.state,null),g0(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Gc(t,e){try{var n="",r=e;do n+=ZP(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Sg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Dv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var y5=typeof WeakMap=="function"?WeakMap:Map;function jE(t,e,n){n=Es(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){x0||(x0=!0,Gv=r),Dv(t,e)},n}function HE(t,e,n){n=Es(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Dv(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Dv(t,e),typeof r!="function"&&(ka===null?ka=new Set([this]):ka.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function BI(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new y5;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=N5.bind(null,t,e,n),e.then(t,t))}function FI(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function OI(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Es(-1,1),e.tag=2,Sa(n,e,1))),n.lanes|=1),t)}var x5=Us.ReactCurrentOwner,Sr=!1;function nr(t,e,n,r){e.child=t===null?xE(e,null,n,r):Uc(e,t.child,n,r)}function MI(t,e,n,r,i){n=n.render;var o=e.ref;return xc(e,i),r=$y(t,e,n,r,o,i),n=Xy(),t!==null&&!Sr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Bs(t,e,i)):(Ht&&n&&Fy(e),e.flags|=1,nr(t,e,r,i),e.child)}function LI(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!i1(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,ZE(t,e,o,r,i)):(t=Sh(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Nd,n(s,r)&&t.ref===e.ref)return Bs(t,e,i)}return e.flags|=1,t=Ta(o,r),t.ref=e.ref,t.return=e,e.child=t}function ZE(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Nd(o,r)&&t.ref===e.ref)if(Sr=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Sr=!0);else return e.lanes=t.lanes,Bs(t,e,i)}return Pv(t,e,n,r,i)}function $E(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(fc,Gr),Gr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_t(fc,Gr),Gr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,_t(fc,Gr),Gr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,_t(fc,Gr),Gr|=r;return nr(t,e,i,n),e.child}function XE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Pv(t,e,n,r,i){var o=Tr(n)?yl:Yn.current;return o=Mc(e,o),xc(e,i),n=$y(t,e,n,r,o,i),r=Xy(),t!==null&&!Sr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Bs(t,e,i)):(Ht&&r&&Fy(e),e.flags|=1,nr(t,e,n,i),e.child)}function UI(t,e,n,r,i){if(Tr(n)){var o=!0;u0(e)}else o=!1;if(xc(e,i),e.stateNode===null)bh(t,e),zE(e,n,r),_v(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=mi(c):(c=Tr(n)?yl:Yn.current,c=Mc(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&NI(e,s,r,c),oa=!1;var f=e.memoizedState;s.state=f,g0(e,r,s,i),l=e.memoizedState,a!==r||f!==l||Er.current||oa?(typeof u=="function"&&(Rv(e,n,u,r),l=e.memoizedState),(a=oa||PI(e,n,a,r,f,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,bE(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:ki(e.type,a),s.props=c,d=e.pendingProps,f=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=mi(l):(l=Tr(n)?yl:Yn.current,l=Mc(e,l));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||f!==l)&&NI(e,s,r,l),oa=!1,f=e.memoizedState,s.state=f,g0(e,r,s,i);var p=e.memoizedState;a!==d||f!==p||Er.current||oa?(typeof h=="function"&&(Rv(e,n,h,r),p=e.memoizedState),(c=oa||PI(e,n,c,r,f,p,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Nv(t,e,n,r,o,i)}function Nv(t,e,n,r,i,o){XE(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&wI(e,n,!1),Bs(t,e,o);r=e.stateNode,x5.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=Uc(e,t.child,null,o),e.child=Uc(e,null,a,o)):nr(t,e,a,o),e.memoizedState=r.state,i&&wI(e,n,!0),e.child}function KE(t){var e=t.stateNode;e.pendingContext?AI(t,e.pendingContext,e.pendingContext!==e.context):e.context&&AI(t,e.context,!1),zy(t,e.containerInfo)}function VI(t,e,n,r,i){return Lc(),My(i),e.flags|=256,nr(t,e,n,r),e.child}var Bv={dehydrated:null,treeContext:null,retryLane:0};function Fv(t){return{baseLanes:t,cachePool:null,transitions:null}}function JE(t,e,n){var r=e.pendingProps,i=Zt.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),_t(Zt,i&1),t===null)return Ev(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Ip(s,r,0,null),t=hl(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Fv(n),e.memoizedState=Bv,t):Yy(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return I5(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ta(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=Ta(a,o):(o=hl(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?Fv(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Bv,r}return o=t.child,t=o.sibling,r=Ta(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Yy(t,e){return e=Ip({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $f(t,e,n,r){return r!==null&&My(r),Uc(e,t.child,null,n),t=Yy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function I5(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=Sg(Error(fe(422))),$f(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Ip({mode:"visible",children:r.children},i,0,null),o=hl(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Uc(e,t.child,null,s),e.child.memoizedState=Fv(s),e.memoizedState=Bv,o);if(!(e.mode&1))return $f(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(fe(419)),r=Sg(o,r,void 0),$f(t,e,s,r)}if(a=(s&t.childLanes)!==0,Sr||a){if(r=En,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Ns(t,i),$i(r,t,i,-1))}return r1(),r=Sg(Error(fe(421))),$f(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=B5.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Kr=wa(i.nextSibling),Yr=e,Ht=!0,Li=null,t!==null&&(ai[li++]=ts,ai[li++]=ns,ai[li++]=xl,ts=t.id,ns=t.overflow,xl=e),e=Yy(e,r.children),e.flags|=4096,e)}function GI(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Tv(t.return,e,n)}function kg(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function YE(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(nr(t,e,r.children,n),r=Zt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&GI(t,n,e);else if(t.tag===19)GI(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(_t(Zt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&m0(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),kg(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&m0(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}kg(e,!0,n,null,o);break;case"together":kg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function bh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Bs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),bl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(fe(153));if(e.child!==null){for(t=e.child,n=Ta(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ta(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function b5(t,e,n){switch(e.tag){case 3:KE(e),Lc();break;case 5:AE(e);break;case 1:Tr(e.type)&&u0(e);break;case 4:zy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;_t(h0,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(_t(Zt,Zt.current&1),e.flags|=128,null):n&e.child.childLanes?JE(t,e,n):(_t(Zt,Zt.current&1),t=Bs(t,e,n),t!==null?t.sibling:null);_t(Zt,Zt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return YE(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),_t(Zt,Zt.current),r)break;return null;case 22:case 23:return e.lanes=0,$E(t,e,n)}return Bs(t,e,n)}var qE,Ov,QE,eT;qE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ov=function(){};QE=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,sl(Bo.current);var o=null;switch(n){case"input":i=iv(t,i),r=iv(t,r),o=[];break;case"select":i=Xt({},i,{value:void 0}),r=Xt({},r,{value:void 0}),o=[];break;case"textarea":i=av(t,i),r=av(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=l0)}cv(n,r);var s;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(kd.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(kd.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Nt("scroll",t),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};eT=function(t,e,n,r){n!==r&&(e.flags|=4)};function Tu(t,e){if(!Ht)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Hn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function A5(t,e,n){var r=e.pendingProps;switch(Oy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hn(e),null;case 1:return Tr(e.type)&&c0(),Hn(e),null;case 3:return r=e.stateNode,Vc(),Lt(Er),Lt(Yn),Hy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Hf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Li!==null&&(jv(Li),Li=null))),Ov(t,e),Hn(e),null;case 5:jy(e);var i=sl(Ld.current);if(n=e.type,t!==null&&e.stateNode!=null)QE(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(fe(166));return Hn(e),null}if(t=sl(Bo.current),Hf(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[ho]=e,r[Od]=o,t=(e.mode&1)!==0,n){case"dialog":Nt("cancel",r),Nt("close",r);break;case"iframe":case"object":case"embed":Nt("load",r);break;case"video":case"audio":for(i=0;i<Ju.length;i++)Nt(Ju[i],r);break;case"source":Nt("error",r);break;case"img":case"image":case"link":Nt("error",r),Nt("load",r);break;case"details":Nt("toggle",r);break;case"input":Jx(r,o),Nt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Nt("invalid",r);break;case"textarea":qx(r,o),Nt("invalid",r)}cv(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&jf(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&jf(r.textContent,a,t),i=["children",""+a]):kd.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Nt("scroll",r)}switch(n){case"input":Of(r),Yx(r,o,!0);break;case"textarea":Of(r),Qx(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=l0)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Tk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[ho]=e,t[Od]=r,qE(t,e,!1,!1),e.stateNode=t;e:{switch(s=uv(n,r),n){case"dialog":Nt("cancel",t),Nt("close",t),i=r;break;case"iframe":case"object":case"embed":Nt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ju.length;i++)Nt(Ju[i],t);i=r;break;case"source":Nt("error",t),i=r;break;case"img":case"image":case"link":Nt("error",t),Nt("load",t),i=r;break;case"details":Nt("toggle",t),i=r;break;case"input":Jx(t,r),i=iv(t,r),Nt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Xt({},r,{value:void 0}),Nt("invalid",t);break;case"textarea":qx(t,r),i=av(t,r),Nt("invalid",t);break;default:i=r}cv(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?Dk(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Rk(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ed(t,l):typeof l=="number"&&Ed(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(kd.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Nt("scroll",t):l!=null&&Iy(t,o,l,s))}switch(n){case"input":Of(t),Yx(t,r,!1);break;case"textarea":Of(t),Qx(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Da(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?mc(t,!!r.multiple,o,!1):r.defaultValue!=null&&mc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=l0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Hn(e),null;case 6:if(t&&e.stateNode!=null)eT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(fe(166));if(n=sl(Ld.current),sl(Bo.current),Hf(e)){if(r=e.stateNode,n=e.memoizedProps,r[ho]=e,(o=r.nodeValue!==n)&&(t=Yr,t!==null))switch(t.tag){case 3:jf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&jf(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ho]=e,e.stateNode=r}return Hn(e),null;case 13:if(Lt(Zt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ht&&Kr!==null&&e.mode&1&&!(e.flags&128))CE(),Lc(),e.flags|=98560,o=!1;else if(o=Hf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(fe(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(fe(317));o[ho]=e}else Lc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Hn(e),o=!1}else Li!==null&&(jv(Li),Li=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Zt.current&1?Cn===0&&(Cn=3):r1())),e.updateQueue!==null&&(e.flags|=4),Hn(e),null);case 4:return Vc(),Ov(t,e),t===null&&Bd(e.stateNode.containerInfo),Hn(e),null;case 10:return Vy(e.type._context),Hn(e),null;case 17:return Tr(e.type)&&c0(),Hn(e),null;case 19:if(Lt(Zt),o=e.memoizedState,o===null)return Hn(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Tu(o,!1);else{if(Cn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=m0(t),s!==null){for(e.flags|=128,Tu(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _t(Zt,Zt.current&1|2),e.child}t=t.sibling}o.tail!==null&&nn()>Wc&&(e.flags|=128,r=!0,Tu(o,!1),e.lanes=4194304)}else{if(!r)if(t=m0(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Tu(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Ht)return Hn(e),null}else 2*nn()-o.renderingStartTime>Wc&&n!==1073741824&&(e.flags|=128,r=!0,Tu(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=nn(),e.sibling=null,n=Zt.current,_t(Zt,r?n&1|2:n&1),e):(Hn(e),null);case 22:case 23:return n1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Gr&1073741824&&(Hn(e),e.subtreeFlags&6&&(e.flags|=8192)):Hn(e),null;case 24:return null;case 25:return null}throw Error(fe(156,e.tag))}function w5(t,e){switch(Oy(e),e.tag){case 1:return Tr(e.type)&&c0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Vc(),Lt(Er),Lt(Yn),Hy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return jy(e),null;case 13:if(Lt(Zt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(fe(340));Lc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Lt(Zt),null;case 4:return Vc(),null;case 10:return Vy(e.type._context),null;case 22:case 23:return n1(),null;case 24:return null;default:return null}}var Xf=!1,$n=!1,S5=typeof WeakSet=="function"?WeakSet:Set,we=null;function dc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qt(t,e,r)}else n.current=null}function Mv(t,e,n){try{n()}catch(r){qt(t,e,r)}}var WI=!1;function k5(t,e){if(xv=o0,t=oE(),By(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=t,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++c===i&&(a=s),f===o&&++u===r&&(l=s),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Iv={focusedElem:t,selectionRange:n},o0=!1,we=e;we!==null;)if(e=we,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,we=t;else for(;we!==null;){e=we;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,C=p.memoizedState,v=e.stateNode,g=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:ki(e.type,m),C);v.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fe(163))}}catch(I){qt(e,e.return,I)}if(t=e.sibling,t!==null){t.return=e.return,we=t;break}we=e.return}return p=WI,WI=!1,p}function pd(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Mv(e,n,o)}i=i.next}while(i!==r)}}function yp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Lv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function tT(t){var e=t.alternate;e!==null&&(t.alternate=null,tT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ho],delete e[Od],delete e[wv],delete e[l5],delete e[c5])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function nT(t){return t.tag===5||t.tag===3||t.tag===4}function zI(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||nT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Uv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=l0));else if(r!==4&&(t=t.child,t!==null))for(Uv(t,e,n),t=t.sibling;t!==null;)Uv(t,e,n),t=t.sibling}function Vv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Vv(t,e,n),t=t.sibling;t!==null;)Vv(t,e,n),t=t.sibling}var _n=null,Fi=!1;function $s(t,e,n){for(n=n.child;n!==null;)rT(t,e,n),n=n.sibling}function rT(t,e,n){if(No&&typeof No.onCommitFiberUnmount=="function")try{No.onCommitFiberUnmount(dp,n)}catch{}switch(n.tag){case 5:$n||dc(n,e);case 6:var r=_n,i=Fi;_n=null,$s(t,e,n),_n=r,Fi=i,_n!==null&&(Fi?(t=_n,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):_n.removeChild(n.stateNode));break;case 18:_n!==null&&(Fi?(t=_n,n=n.stateNode,t.nodeType===8?yg(t.parentNode,n):t.nodeType===1&&yg(t,n),Dd(t)):yg(_n,n.stateNode));break;case 4:r=_n,i=Fi,_n=n.stateNode.containerInfo,Fi=!0,$s(t,e,n),_n=r,Fi=i;break;case 0:case 11:case 14:case 15:if(!$n&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Mv(n,e,s),i=i.next}while(i!==r)}$s(t,e,n);break;case 1:if(!$n&&(dc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){qt(n,e,a)}$s(t,e,n);break;case 21:$s(t,e,n);break;case 22:n.mode&1?($n=(r=$n)||n.memoizedState!==null,$s(t,e,n),$n=r):$s(t,e,n);break;default:$s(t,e,n)}}function jI(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new S5),e.forEach(function(r){var i=F5.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ii(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:_n=a.stateNode,Fi=!1;break e;case 3:_n=a.stateNode.containerInfo,Fi=!0;break e;case 4:_n=a.stateNode.containerInfo,Fi=!0;break e}a=a.return}if(_n===null)throw Error(fe(160));rT(o,s,i),_n=null,Fi=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){qt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)iT(e,t),e=e.sibling}function iT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ii(e,t),io(t),r&4){try{pd(3,t,t.return),yp(3,t)}catch(m){qt(t,t.return,m)}try{pd(5,t,t.return)}catch(m){qt(t,t.return,m)}}break;case 1:Ii(e,t),io(t),r&512&&n!==null&&dc(n,n.return);break;case 5:if(Ii(e,t),io(t),r&512&&n!==null&&dc(n,n.return),t.flags&32){var i=t.stateNode;try{Ed(i,"")}catch(m){qt(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&kk(i,o),uv(a,s);var c=uv(a,o);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?Dk(i,d):u==="dangerouslySetInnerHTML"?Rk(i,d):u==="children"?Ed(i,d):Iy(i,u,d,c)}switch(a){case"input":ov(i,o);break;case"textarea":Ek(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?mc(i,!!o.multiple,h,!1):f!==!!o.multiple&&(o.defaultValue!=null?mc(i,!!o.multiple,o.defaultValue,!0):mc(i,!!o.multiple,o.multiple?[]:"",!1))}i[Od]=o}catch(m){qt(t,t.return,m)}}break;case 6:if(Ii(e,t),io(t),r&4){if(t.stateNode===null)throw Error(fe(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(m){qt(t,t.return,m)}}break;case 3:if(Ii(e,t),io(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Dd(e.containerInfo)}catch(m){qt(t,t.return,m)}break;case 4:Ii(e,t),io(t);break;case 13:Ii(e,t),io(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(e1=nn())),r&4&&jI(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?($n=(c=$n)||u,Ii(e,t),$n=c):Ii(e,t),io(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(we=t,u=t.child;u!==null;){for(d=we=u;we!==null;){switch(f=we,h=f.child,f.tag){case 0:case 11:case 14:case 15:pd(4,f,f.return);break;case 1:dc(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){qt(r,n,m)}}break;case 5:dc(f,f.return);break;case 22:if(f.memoizedState!==null){ZI(d);continue}}h!==null?(h.return=f,we=h):ZI(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=_k("display",s))}catch(m){qt(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){qt(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ii(e,t),io(t),r&4&&jI(t);break;case 21:break;default:Ii(e,t),io(t)}}function io(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(nT(n)){var r=n;break e}n=n.return}throw Error(fe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ed(i,""),r.flags&=-33);var o=zI(t);Vv(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=zI(t);Uv(t,a,s);break;default:throw Error(fe(161))}}catch(l){qt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function E5(t,e,n){we=t,oT(t)}function oT(t,e,n){for(var r=(t.mode&1)!==0;we!==null;){var i=we,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Xf;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||$n;a=Xf;var c=$n;if(Xf=s,($n=l)&&!c)for(we=i;we!==null;)s=we,l=s.child,s.tag===22&&s.memoizedState!==null?$I(i):l!==null?(l.return=s,we=l):$I(i);for(;o!==null;)we=o,oT(o),o=o.sibling;we=i,Xf=a,$n=c}HI(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,we=o):HI(t)}}function HI(t){for(;we!==null;){var e=we;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$n||yp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!$n)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ki(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&RI(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}RI(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Dd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fe(163))}$n||e.flags&512&&Lv(e)}catch(f){qt(e,e.return,f)}}if(e===t){we=null;break}if(n=e.sibling,n!==null){n.return=e.return,we=n;break}we=e.return}}function ZI(t){for(;we!==null;){var e=we;if(e===t){we=null;break}var n=e.sibling;if(n!==null){n.return=e.return,we=n;break}we=e.return}}function $I(t){for(;we!==null;){var e=we;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{yp(4,e)}catch(l){qt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){qt(e,i,l)}}var o=e.return;try{Lv(e)}catch(l){qt(e,o,l)}break;case 5:var s=e.return;try{Lv(e)}catch(l){qt(e,s,l)}}}catch(l){qt(e,e.return,l)}if(e===t){we=null;break}var a=e.sibling;if(a!==null){a.return=e.return,we=a;break}we=e.return}}var T5=Math.ceil,y0=Us.ReactCurrentDispatcher,qy=Us.ReactCurrentOwner,gi=Us.ReactCurrentBatchConfig,dt=0,En=null,un=null,Fn=0,Gr=0,fc=Ma(0),Cn=0,Wd=null,bl=0,xp=0,Qy=0,gd=null,Ar=null,e1=0,Wc=1/0,Xo=null,x0=!1,Gv=null,ka=null,Kf=!1,da=null,I0=0,md=0,Wv=null,Ah=-1,wh=0;function ur(){return dt&6?nn():Ah!==-1?Ah:Ah=nn()}function Ea(t){return t.mode&1?dt&2&&Fn!==0?Fn&-Fn:d5.transition!==null?(wh===0&&(wh=zk()),wh):(t=yt,t!==0||(t=window.event,t=t===void 0?16:Jk(t.type)),t):1}function $i(t,e,n,r){if(50<md)throw md=0,Wv=null,Error(fe(185));pf(t,n,r),(!(dt&2)||t!==En)&&(t===En&&(!(dt&2)&&(xp|=n),Cn===4&&la(t,Fn)),Rr(t,r),n===1&&dt===0&&!(e.mode&1)&&(Wc=nn()+500,mp&&La()))}function Rr(t,e){var n=t.callbackNode;dN(t,e);var r=i0(t,t===En?Fn:0);if(r===0)n!==null&&nI(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&nI(n),e===1)t.tag===0?u5(XI.bind(null,t)):gE(XI.bind(null,t)),s5(function(){!(dt&6)&&La()}),n=null;else{switch(jk(r)){case 1:n=ky;break;case 4:n=Gk;break;case 16:n=r0;break;case 536870912:n=Wk;break;default:n=r0}n=hT(n,sT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function sT(t,e){if(Ah=-1,wh=0,dt&6)throw Error(fe(327));var n=t.callbackNode;if(Ic()&&t.callbackNode!==n)return null;var r=i0(t,t===En?Fn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=b0(t,r);else{e=r;var i=dt;dt|=2;var o=lT();(En!==t||Fn!==e)&&(Xo=null,Wc=nn()+500,fl(t,e));do try{D5();break}catch(a){aT(t,a)}while(!0);Uy(),y0.current=o,dt=i,un!==null?e=0:(En=null,Fn=0,e=Cn)}if(e!==0){if(e===2&&(i=gv(t),i!==0&&(r=i,e=zv(t,i))),e===1)throw n=Wd,fl(t,0),la(t,r),Rr(t,nn()),n;if(e===6)la(t,r);else{if(i=t.current.alternate,!(r&30)&&!R5(i)&&(e=b0(t,r),e===2&&(o=gv(t),o!==0&&(r=o,e=zv(t,o))),e===1))throw n=Wd,fl(t,0),la(t,r),Rr(t,nn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(fe(345));case 2:Ka(t,Ar,Xo);break;case 3:if(la(t,r),(r&130023424)===r&&(e=e1+500-nn(),10<e)){if(i0(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){ur(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Av(Ka.bind(null,t,Ar,Xo),e);break}Ka(t,Ar,Xo);break;case 4:if(la(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-Zi(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=nn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*T5(r/1960))-r,10<r){t.timeoutHandle=Av(Ka.bind(null,t,Ar,Xo),r);break}Ka(t,Ar,Xo);break;case 5:Ka(t,Ar,Xo);break;default:throw Error(fe(329))}}}return Rr(t,nn()),t.callbackNode===n?sT.bind(null,t):null}function zv(t,e){var n=gd;return t.current.memoizedState.isDehydrated&&(fl(t,e).flags|=256),t=b0(t,e),t!==2&&(e=Ar,Ar=n,e!==null&&jv(e)),t}function jv(t){Ar===null?Ar=t:Ar.push.apply(Ar,t)}function R5(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Ki(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function la(t,e){for(e&=~Qy,e&=~xp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Zi(e),r=1<<n;t[n]=-1,e&=~r}}function XI(t){if(dt&6)throw Error(fe(327));Ic();var e=i0(t,0);if(!(e&1))return Rr(t,nn()),null;var n=b0(t,e);if(t.tag!==0&&n===2){var r=gv(t);r!==0&&(e=r,n=zv(t,r))}if(n===1)throw n=Wd,fl(t,0),la(t,e),Rr(t,nn()),n;if(n===6)throw Error(fe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ka(t,Ar,Xo),Rr(t,nn()),null}function t1(t,e){var n=dt;dt|=1;try{return t(e)}finally{dt=n,dt===0&&(Wc=nn()+500,mp&&La())}}function Al(t){da!==null&&da.tag===0&&!(dt&6)&&Ic();var e=dt;dt|=1;var n=gi.transition,r=yt;try{if(gi.transition=null,yt=1,t)return t()}finally{yt=r,gi.transition=n,dt=e,!(dt&6)&&La()}}function n1(){Gr=fc.current,Lt(fc)}function fl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,o5(n)),un!==null)for(n=un.return;n!==null;){var r=n;switch(Oy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&c0();break;case 3:Vc(),Lt(Er),Lt(Yn),Hy();break;case 5:jy(r);break;case 4:Vc();break;case 13:Lt(Zt);break;case 19:Lt(Zt);break;case 10:Vy(r.type._context);break;case 22:case 23:n1()}n=n.return}if(En=t,un=t=Ta(t.current,null),Fn=Gr=e,Cn=0,Wd=null,Qy=xp=bl=0,Ar=gd=null,ol!==null){for(e=0;e<ol.length;e++)if(n=ol[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}ol=null}return t}function aT(t,e){do{var n=un;try{if(Uy(),xh.current=C0,v0){for(var r=$t.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}v0=!1}if(Il=0,Sn=vn=$t=null,hd=!1,Ud=0,qy.current=null,n===null||n.return===null){Cn=1,Wd=e,un=null;break}e:{var o=t,s=n.return,a=n,l=e;if(e=Fn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=FI(s);if(h!==null){h.flags&=-257,OI(h,s,a,o,e),h.mode&1&&BI(o,c,e),e=h,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){BI(o,c,e),r1();break e}l=Error(fe(426))}}else if(Ht&&a.mode&1){var C=FI(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),OI(C,s,a,o,e),My(Gc(l,a));break e}}o=l=Gc(l,a),Cn!==4&&(Cn=2),gd===null?gd=[o]:gd.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var v=jE(o,l,e);TI(o,v);break e;case 1:a=l;var g=o.type,y=o.stateNode;if(!(o.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ka===null||!ka.has(y)))){o.flags|=65536,e&=-e,o.lanes|=e;var I=HE(o,a,e);TI(o,I);break e}}o=o.return}while(o!==null)}uT(n)}catch(b){e=b,un===n&&n!==null&&(un=n=n.return);continue}break}while(!0)}function lT(){var t=y0.current;return y0.current=C0,t===null?C0:t}function r1(){(Cn===0||Cn===3||Cn===2)&&(Cn=4),En===null||!(bl&268435455)&&!(xp&268435455)||la(En,Fn)}function b0(t,e){var n=dt;dt|=2;var r=lT();(En!==t||Fn!==e)&&(Xo=null,fl(t,e));do try{_5();break}catch(i){aT(t,i)}while(!0);if(Uy(),dt=n,y0.current=r,un!==null)throw Error(fe(261));return En=null,Fn=0,Cn}function _5(){for(;un!==null;)cT(un)}function D5(){for(;un!==null&&!nN();)cT(un)}function cT(t){var e=fT(t.alternate,t,Gr);t.memoizedProps=t.pendingProps,e===null?uT(t):un=e,qy.current=null}function uT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=w5(n,e),n!==null){n.flags&=32767,un=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Cn=6,un=null;return}}else if(n=A5(n,e,Gr),n!==null){un=n;return}if(e=e.sibling,e!==null){un=e;return}un=e=t}while(e!==null);Cn===0&&(Cn=5)}function Ka(t,e,n){var r=yt,i=gi.transition;try{gi.transition=null,yt=1,P5(t,e,n,r)}finally{gi.transition=i,yt=r}return null}function P5(t,e,n,r){do Ic();while(da!==null);if(dt&6)throw Error(fe(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(fe(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(fN(t,o),t===En&&(un=En=null,Fn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Kf||(Kf=!0,hT(r0,function(){return Ic(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=gi.transition,gi.transition=null;var s=yt;yt=1;var a=dt;dt|=4,qy.current=null,k5(t,n),iT(n,t),qN(Iv),o0=!!xv,Iv=xv=null,t.current=n,E5(n),rN(),dt=a,yt=s,gi.transition=o}else t.current=n;if(Kf&&(Kf=!1,da=t,I0=i),o=t.pendingLanes,o===0&&(ka=null),sN(n.stateNode),Rr(t,nn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(x0)throw x0=!1,t=Gv,Gv=null,t;return I0&1&&t.tag!==0&&Ic(),o=t.pendingLanes,o&1?t===Wv?md++:(md=0,Wv=t):md=0,La(),null}function Ic(){if(da!==null){var t=jk(I0),e=gi.transition,n=yt;try{if(gi.transition=null,yt=16>t?16:t,da===null)var r=!1;else{if(t=da,da=null,I0=0,dt&6)throw Error(fe(331));var i=dt;for(dt|=4,we=t.current;we!==null;){var o=we,s=o.child;if(we.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(we=c;we!==null;){var u=we;switch(u.tag){case 0:case 11:case 15:pd(8,u,o)}var d=u.child;if(d!==null)d.return=u,we=d;else for(;we!==null;){u=we;var f=u.sibling,h=u.return;if(tT(u),u===c){we=null;break}if(f!==null){f.return=h,we=f;break}we=h}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var C=m.sibling;m.sibling=null,m=C}while(m!==null)}}we=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,we=s;else e:for(;we!==null;){if(o=we,o.flags&2048)switch(o.tag){case 0:case 11:case 15:pd(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,we=v;break e}we=o.return}}var g=t.current;for(we=g;we!==null;){s=we;var y=s.child;if(s.subtreeFlags&2064&&y!==null)y.return=s,we=y;else e:for(s=g;we!==null;){if(a=we,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:yp(9,a)}}catch(b){qt(a,a.return,b)}if(a===s){we=null;break e}var I=a.sibling;if(I!==null){I.return=a.return,we=I;break e}we=a.return}}if(dt=i,La(),No&&typeof No.onPostCommitFiberRoot=="function")try{No.onPostCommitFiberRoot(dp,t)}catch{}r=!0}return r}finally{yt=n,gi.transition=e}}return!1}function KI(t,e,n){e=Gc(n,e),e=jE(t,e,1),t=Sa(t,e,1),e=ur(),t!==null&&(pf(t,1,e),Rr(t,e))}function qt(t,e,n){if(t.tag===3)KI(t,t,n);else for(;e!==null;){if(e.tag===3){KI(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ka===null||!ka.has(r))){t=Gc(n,t),t=HE(e,t,1),e=Sa(e,t,1),t=ur(),e!==null&&(pf(e,1,t),Rr(e,t));break}}e=e.return}}function N5(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ur(),t.pingedLanes|=t.suspendedLanes&n,En===t&&(Fn&n)===n&&(Cn===4||Cn===3&&(Fn&130023424)===Fn&&500>nn()-e1?fl(t,0):Qy|=n),Rr(t,e)}function dT(t,e){e===0&&(t.mode&1?(e=Uf,Uf<<=1,!(Uf&130023424)&&(Uf=4194304)):e=1);var n=ur();t=Ns(t,e),t!==null&&(pf(t,e,n),Rr(t,n))}function B5(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),dT(t,n)}function F5(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(fe(314))}r!==null&&r.delete(e),dT(t,n)}var fT;fT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Er.current)Sr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Sr=!1,b5(t,e,n);Sr=!!(t.flags&131072)}else Sr=!1,Ht&&e.flags&1048576&&mE(e,f0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;bh(t,e),t=e.pendingProps;var i=Mc(e,Yn.current);xc(e,n),i=$y(null,e,r,t,i,n);var o=Xy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Tr(r)?(o=!0,u0(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Wy(e),i.updater=Cp,e.stateNode=i,i._reactInternals=e,_v(e,r,t,n),e=Nv(null,e,r,!0,o,n)):(e.tag=0,Ht&&o&&Fy(e),nr(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(bh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=M5(r),t=ki(r,t),i){case 0:e=Pv(null,e,r,t,n);break e;case 1:e=UI(null,e,r,t,n);break e;case 11:e=MI(null,e,r,t,n);break e;case 14:e=LI(null,e,r,ki(r.type,t),n);break e}throw Error(fe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ki(r,i),Pv(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ki(r,i),UI(t,e,r,i,n);case 3:e:{if(KE(e),t===null)throw Error(fe(387));r=e.pendingProps,o=e.memoizedState,i=o.element,bE(t,e),g0(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=Gc(Error(fe(423)),e),e=VI(t,e,r,n,i);break e}else if(r!==i){i=Gc(Error(fe(424)),e),e=VI(t,e,r,n,i);break e}else for(Kr=wa(e.stateNode.containerInfo.firstChild),Yr=e,Ht=!0,Li=null,n=xE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Lc(),r===i){e=Bs(t,e,n);break e}nr(t,e,r,n)}e=e.child}return e;case 5:return AE(e),t===null&&Ev(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,bv(r,i)?s=null:o!==null&&bv(r,o)&&(e.flags|=32),XE(t,e),nr(t,e,s,n),e.child;case 6:return t===null&&Ev(e),null;case 13:return JE(t,e,n);case 4:return zy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Uc(e,null,r,n):nr(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ki(r,i),MI(t,e,r,i,n);case 7:return nr(t,e,e.pendingProps,n),e.child;case 8:return nr(t,e,e.pendingProps.children,n),e.child;case 12:return nr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,_t(h0,r._currentValue),r._currentValue=s,o!==null)if(Ki(o.value,s)){if(o.children===i.children&&!Er.current){e=Bs(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=Es(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Tv(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(fe(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Tv(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}nr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,xc(e,n),i=mi(i),r=r(i),e.flags|=1,nr(t,e,r,n),e.child;case 14:return r=e.type,i=ki(r,e.pendingProps),i=ki(r.type,i),LI(t,e,r,i,n);case 15:return ZE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ki(r,i),bh(t,e),e.tag=1,Tr(r)?(t=!0,u0(e)):t=!1,xc(e,n),zE(e,r,i),_v(e,r,i,n),Nv(null,e,r,!0,t,n);case 19:return YE(t,e,n);case 22:return $E(t,e,n)}throw Error(fe(156,e.tag))};function hT(t,e){return Vk(t,e)}function O5(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ui(t,e,n,r){return new O5(t,e,n,r)}function i1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function M5(t){if(typeof t=="function")return i1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ay)return 11;if(t===wy)return 14}return 2}function Ta(t,e){var n=t.alternate;return n===null?(n=ui(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Sh(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")i1(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case nc:return hl(n.children,i,o,e);case by:s=8,i|=8;break;case ev:return t=ui(12,n,e,i|2),t.elementType=ev,t.lanes=o,t;case tv:return t=ui(13,n,e,i),t.elementType=tv,t.lanes=o,t;case nv:return t=ui(19,n,e,i),t.elementType=nv,t.lanes=o,t;case Ak:return Ip(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ik:s=10;break e;case bk:s=9;break e;case Ay:s=11;break e;case wy:s=14;break e;case ia:s=16,r=null;break e}throw Error(fe(130,t==null?t:typeof t,""))}return e=ui(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function hl(t,e,n,r){return t=ui(7,t,r,e),t.lanes=n,t}function Ip(t,e,n,r){return t=ui(22,t,r,e),t.elementType=Ak,t.lanes=n,t.stateNode={isHidden:!1},t}function Eg(t,e,n){return t=ui(6,t,null,e),t.lanes=n,t}function Tg(t,e,n){return e=ui(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function L5(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=lg(0),this.expirationTimes=lg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function o1(t,e,n,r,i,o,s,a,l){return t=new L5(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=ui(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wy(o),t}function U5(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:tc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function pT(t){if(!t)return Pa;t=t._reactInternals;e:{if(Fl(t)!==t||t.tag!==1)throw Error(fe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Tr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(fe(171))}if(t.tag===1){var n=t.type;if(Tr(n))return pE(t,n,e)}return e}function gT(t,e,n,r,i,o,s,a,l){return t=o1(n,r,!0,t,i,o,s,a,l),t.context=pT(null),n=t.current,r=ur(),i=Ea(n),o=Es(r,i),o.callback=e??null,Sa(n,o,i),t.current.lanes=i,pf(t,i,r),Rr(t,r),t}function bp(t,e,n,r){var i=e.current,o=ur(),s=Ea(i);return n=pT(n),e.context===null?e.context=n:e.pendingContext=n,e=Es(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Sa(i,e,s),t!==null&&($i(t,i,s,o),yh(t,i,s)),s}function A0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function JI(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function s1(t,e){JI(t,e),(t=t.alternate)&&JI(t,e)}function V5(){return null}var mT=typeof reportError=="function"?reportError:function(t){console.error(t)};function a1(t){this._internalRoot=t}Ap.prototype.render=a1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(fe(409));bp(t,e,null,null)};Ap.prototype.unmount=a1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Al(function(){bp(null,t,null,null)}),e[Ps]=null}};function Ap(t){this._internalRoot=t}Ap.prototype.unstable_scheduleHydration=function(t){if(t){var e=$k();t={blockedOn:null,target:t,priority:e};for(var n=0;n<aa.length&&e!==0&&e<aa[n].priority;n++);aa.splice(n,0,t),n===0&&Kk(t)}};function l1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function wp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function YI(){}function G5(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=A0(s);o.call(c)}}var s=gT(e,r,t,0,null,!1,!1,"",YI);return t._reactRootContainer=s,t[Ps]=s.current,Bd(t.nodeType===8?t.parentNode:t),Al(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=A0(l);a.call(c)}}var l=o1(t,0,!1,null,null,!1,!1,"",YI);return t._reactRootContainer=l,t[Ps]=l.current,Bd(t.nodeType===8?t.parentNode:t),Al(function(){bp(e,l,n,r)}),l}function Sp(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=A0(s);a.call(l)}}bp(e,s,t,i)}else s=G5(n,e,t,i,r);return A0(s)}Hk=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ku(e.pendingLanes);n!==0&&(Ey(e,n|1),Rr(e,nn()),!(dt&6)&&(Wc=nn()+500,La()))}break;case 13:Al(function(){var r=Ns(t,1);if(r!==null){var i=ur();$i(r,t,1,i)}}),s1(t,1)}};Ty=function(t){if(t.tag===13){var e=Ns(t,134217728);if(e!==null){var n=ur();$i(e,t,134217728,n)}s1(t,134217728)}};Zk=function(t){if(t.tag===13){var e=Ea(t),n=Ns(t,e);if(n!==null){var r=ur();$i(n,t,e,r)}s1(t,e)}};$k=function(){return yt};Xk=function(t,e){var n=yt;try{return yt=t,e()}finally{yt=n}};fv=function(t,e,n){switch(e){case"input":if(ov(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=gp(r);if(!i)throw Error(fe(90));Sk(r),ov(r,i)}}}break;case"textarea":Ek(t,n);break;case"select":e=n.value,e!=null&&mc(t,!!n.multiple,e,!1)}};Bk=t1;Fk=Al;var W5={usingClientEntryPoint:!1,Events:[mf,sc,gp,Pk,Nk,t1]},Ru={findFiberByHostInstance:il,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},z5={bundleType:Ru.bundleType,version:Ru.version,rendererPackageName:Ru.rendererPackageName,rendererConfig:Ru.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Us.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Lk(t),t===null?null:t.stateNode},findFiberByHostInstance:Ru.findFiberByHostInstance||V5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jf.isDisabled&&Jf.supportsFiber)try{dp=Jf.inject(z5),No=Jf}catch{}}ti.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W5;ti.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!l1(e))throw Error(fe(200));return U5(t,e,null,n)};ti.createRoot=function(t,e){if(!l1(t))throw Error(fe(299));var n=!1,r="",i=mT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=o1(t,1,!1,null,null,n,!1,r,i),t[Ps]=e.current,Bd(t.nodeType===8?t.parentNode:t),new a1(e)};ti.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(fe(188)):(t=Object.keys(t).join(","),Error(fe(268,t)));return t=Lk(e),t=t===null?null:t.stateNode,t};ti.flushSync=function(t){return Al(t)};ti.hydrate=function(t,e,n){if(!wp(e))throw Error(fe(200));return Sp(null,t,e,!0,n)};ti.hydrateRoot=function(t,e,n){if(!l1(t))throw Error(fe(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=mT;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=gT(e,null,t,1,n??null,i,!1,o,s),t[Ps]=e.current,Bd(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Ap(e)};ti.render=function(t,e,n){if(!wp(e))throw Error(fe(200));return Sp(null,t,e,!1,n)};ti.unmountComponentAtNode=function(t){if(!wp(t))throw Error(fe(40));return t._reactRootContainer?(Al(function(){Sp(null,null,t,!1,function(){t._reactRootContainer=null,t[Ps]=null})}),!0):!1};ti.unstable_batchedUpdates=t1;ti.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!wp(n))throw Error(fe(200));if(t==null||t._reactInternals===void 0)throw Error(fe(38));return Sp(t,e,n,!1,r)};ti.version="18.3.1-next-f1338f8080-20240426";function vT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vT)}catch(t){console.error(t)}}vT(),vk.exports=ti;var c1=vk.exports;const j5=eu(c1),H5=ok({__proto__:null,default:j5},[c1]);var qI=c1;qm.createRoot=qI.createRoot,qm.hydrateRoot=qI.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zt(){return zt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zt.apply(this,arguments)}var cn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(cn||(cn={}));const QI="popstate";function Z5(t){t===void 0&&(t={});function e(r,i){let{pathname:o,search:s,hash:a}=r.location;return zd("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Cf(i)}return X5(e,n,null,t)}function ut(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function $5(){return Math.random().toString(36).substr(2,8)}function eb(t,e){return{usr:t.state,key:t.key,idx:e}}function zd(t,e,n,r){return n===void 0&&(n=null),zt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ua(e):e,{state:n,key:e&&e.key||r||$5()})}function Cf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ua(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function X5(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,a=cn.Pop,l=null,c=u();c==null&&(c=0,s.replaceState(zt({},s.state,{idx:c}),""));function u(){return(s.state||{idx:null}).idx}function d(){a=cn.Pop;let C=u(),v=C==null?null:C-c;c=C,l&&l({action:a,location:m.location,delta:v})}function f(C,v){a=cn.Push;let g=zd(m.location,C,v);c=u()+1;let y=eb(g,c),I=m.createHref(g);try{s.pushState(y,"",I)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;i.location.assign(I)}o&&l&&l({action:a,location:m.location,delta:1})}function h(C,v){a=cn.Replace;let g=zd(m.location,C,v);c=u();let y=eb(g,c),I=m.createHref(g);s.replaceState(y,"",I),o&&l&&l({action:a,location:m.location,delta:0})}function p(C){let v=i.location.origin!=="null"?i.location.origin:i.location.href,g=typeof C=="string"?C:Cf(C);return g=g.replace(/ $/,"%20"),ut(v,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,v)}let m={get action(){return a},get location(){return t(i,s)},listen(C){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(QI,d),l=C,()=>{i.removeEventListener(QI,d),l=null}},createHref(C){return e(i,C)},createURL:p,encodeLocation(C){let v=p(C);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:h,go(C){return s.go(C)}};return m}var mt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(mt||(mt={}));const K5=new Set(["lazy","caseSensitive","path","id","index","children"]);function J5(t){return t.index===!0}function w0(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((i,o)=>{let s=[...n,String(o)],a=typeof i.id=="string"?i.id:s.join("-");if(ut(i.index!==!0||!i.children,"Cannot specify children on an index route"),ut(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),J5(i)){let l=zt({},i,e(i),{id:a});return r[a]=l,l}else{let l=zt({},i,e(i),{id:a,children:void 0});return r[a]=l,i.children&&(l.children=w0(i.children,e,s,r)),l}})}function Ya(t,e,n){return n===void 0&&(n="/"),kh(t,e,n,!1)}function kh(t,e,n,r){let i=typeof e=="string"?Ua(e):e,o=yf(i.pathname||"/",n);if(o==null)return null;let s=CT(t);q5(s);let a=null;for(let l=0;a==null&&l<s.length;++l){let c=cB(o);a=aB(s[l],c,r)}return a}function Y5(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function CT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(o,s,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};l.relativePath.startsWith("/")&&(ut(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=pl([r,l.relativePath]),u=n.concat(l);o.children&&o.children.length>0&&(ut(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),CT(o.children,e,u,c)),!(o.path==null&&!o.index)&&e.push({path:c,score:oB(c,o.index),routesMeta:u})};return t.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let l of yT(o.path))i(o,s,l)}),e}function yT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let s=yT(r.join("/")),a=[];return a.push(...s.map(l=>l===""?o:[o,l].join("/"))),i&&a.push(...s),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function q5(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:sB(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Q5=/^:[\w-]+$/,eB=3,tB=2,nB=1,rB=10,iB=-2,tb=t=>t==="*";function oB(t,e){let n=t.split("/"),r=n.length;return n.some(tb)&&(r+=iB),e&&(r+=tB),n.filter(i=>!tb(i)).reduce((i,o)=>i+(Q5.test(o)?eB:o===""?nB:rB),r)}function sB(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function aB(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,i={},o="/",s=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=o==="/"?e:e.slice(o.length)||"/",d=nb({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=nb({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),s.push({params:i,pathname:pl([o,d.pathname]),pathnameBase:pB(pl([o,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(o=pl([o,d.pathnameBase]))}return s}function nb(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=lB(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,u,d)=>{let{paramName:f,isOptional:h}=u;if(f==="*"){let m=a[d]||"";s=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?c[f]=void 0:c[f]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:s,pattern:t}}function lB(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),zc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function cB(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function yf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function uB(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Ua(t):t;return{pathname:n?n.startsWith("/")?n:dB(n,e):e,search:gB(r),hash:mB(i)}}function dB(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Rg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function xT(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function fB(t,e){let n=xT(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function hB(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Ua(t):(i=zt({},t),ut(!i.pathname||!i.pathname.includes("?"),Rg("?","pathname","search",i)),ut(!i.pathname||!i.pathname.includes("#"),Rg("#","pathname","hash",i)),ut(!i.search||!i.search.includes("#"),Rg("#","search","hash",i)));let o=t===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=n;else{let d=e.length-1;if(!r&&s.startsWith("..")){let f=s.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?e[d]:"/"}let l=uB(i,a),c=s&&s!=="/"&&s.endsWith("/"),u=(o||s===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const pl=t=>t.join("/").replace(/\/\/+/g,"/"),pB=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),gB=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,mB=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class S0{constructor(e,n,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function jd(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const IT=["post","put","patch","delete"],vB=new Set(IT),CB=["get",...IT],yB=new Set(CB),xB=new Set([301,302,303,307,308]),IB=new Set([307,308]),_g={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},bB={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},_u={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},u1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,AB=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),bT="remix-router-transitions";function wB(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;ut(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let V=t.detectErrorBoundary;i=j=>({hasErrorBoundary:V(j)})}else i=AB;let o={},s=w0(t.routes,i,void 0,o),a,l=t.basename||"/",c=t.dataStrategy||TB,u=t.patchRoutesOnNavigation,d=zt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,h=new Set,p=null,m=null,C=null,v=t.hydrationData!=null,g=Ya(s,t.history.location,l),y=!1,I=null;if(g==null&&!u){let V=yr(404,{pathname:t.history.location.pathname}),{matches:j,route:K}=hb(s);g=j,I={[K.id]:V}}g&&!t.hydrationData&&Hs(g,s,t.history.location.pathname).active&&(g=null);let b;if(g)if(g.some(V=>V.route.lazy))b=!1;else if(!g.some(V=>V.route.loader))b=!0;else if(d.v7_partialHydration){let V=t.hydrationData?t.hydrationData.loaderData:null,j=t.hydrationData?t.hydrationData.errors:null;if(j){let K=g.findIndex(ce=>j[ce.route.id]!==void 0);b=g.slice(0,K+1).every(ce=>!Zv(ce.route,V,j))}else b=g.every(K=>!Zv(K.route,V,j))}else b=t.hydrationData!=null;else if(b=!1,g=[],d.v7_partialHydration){let V=Hs(null,s,t.history.location.pathname);V.active&&V.matches&&(y=!0,g=V.matches)}let E,w={historyAction:t.history.action,location:t.history.location,matches:g,initialized:b,navigation:_g,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||I,fetchers:new Map,blockers:new Map},k=cn.Pop,D=!1,T,R=!1,P=new Map,M=null,G=!1,H=!1,q=[],ie=new Set,Z=new Map,Q=0,ne=-1,F=new Map,z=new Set,J=new Map,ee=new Map,se=new Set,me=new Map,Be=new Map,ae;function Pt(){if(f=t.history.listen(V=>{let{action:j,location:K,delta:ce}=V;if(ae){ae(),ae=void 0;return}zc(Be.size===0||ce!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ge=ro({currentLocation:w.location,nextLocation:K,historyAction:j});if(ge&&ce!=null){let De=new Promise(Oe=>{ae=Oe});t.history.go(ce*-1),xi(ge,{state:"blocked",location:K,proceed(){xi(ge,{state:"proceeding",proceed:void 0,reset:void 0,location:K}),De.then(()=>t.history.go(ce))},reset(){let Oe=new Map(w.blockers);Oe.set(ge,_u),ze({blockers:Oe})}});return}return Ce(j,K)}),n){WB(e,P);let V=()=>zB(e,P);e.addEventListener("pagehide",V),M=()=>e.removeEventListener("pagehide",V)}return w.initialized||Ce(cn.Pop,w.location,{initialHydration:!0}),E}function Vt(){f&&f(),M&&M(),h.clear(),T&&T.abort(),w.fetchers.forEach((V,j)=>W(j)),w.blockers.forEach((V,j)=>nt(j))}function dn(V){return h.add(V),()=>h.delete(V)}function ze(V,j){j===void 0&&(j={}),w=zt({},w,V);let K=[],ce=[];d.v7_fetcherPersist&&w.fetchers.forEach((ge,De)=>{ge.state==="idle"&&(se.has(De)?ce.push(De):K.push(De))}),se.forEach(ge=>{!w.fetchers.has(ge)&&!Z.has(ge)&&ce.push(ge)}),[...h].forEach(ge=>ge(w,{deletedFetchers:ce,viewTransitionOpts:j.viewTransitionOpts,flushSync:j.flushSync===!0})),d.v7_fetcherPersist?(K.forEach(ge=>w.fetchers.delete(ge)),ce.forEach(ge=>W(ge))):ce.forEach(ge=>se.delete(ge))}function at(V,j,K){var ce,ge;let{flushSync:De}=K===void 0?{}:K,Oe=w.actionData!=null&&w.navigation.formMethod!=null&&Oi(w.navigation.formMethod)&&w.navigation.state==="loading"&&((ce=V.state)==null?void 0:ce._isRedirect)!==!0,ke;j.actionData?Object.keys(j.actionData).length>0?ke=j.actionData:ke=null:Oe?ke=w.actionData:ke=null;let Ie=j.loaderData?db(w.loaderData,j.loaderData,j.matches||[],j.errors):w.loaderData,be=w.blockers;be.size>0&&(be=new Map(be),be.forEach((Je,fn)=>be.set(fn,_u)));let Re=D===!0||w.navigation.formMethod!=null&&Oi(w.navigation.formMethod)&&((ge=V.state)==null?void 0:ge._isRedirect)!==!0;a&&(s=a,a=void 0),G||k===cn.Pop||(k===cn.Push?t.history.push(V,V.state):k===cn.Replace&&t.history.replace(V,V.state));let Ve;if(k===cn.Pop){let Je=P.get(w.location.pathname);Je&&Je.has(V.pathname)?Ve={currentLocation:w.location,nextLocation:V}:P.has(V.pathname)&&(Ve={currentLocation:V,nextLocation:w.location})}else if(R){let Je=P.get(w.location.pathname);Je?Je.add(V.pathname):(Je=new Set([V.pathname]),P.set(w.location.pathname,Je)),Ve={currentLocation:w.location,nextLocation:V}}ze(zt({},j,{actionData:ke,loaderData:Ie,historyAction:k,location:V,initialized:!0,navigation:_g,revalidation:"idle",restoreScrollPosition:ii(V,j.matches||w.matches),preventScrollReset:Re,blockers:be}),{viewTransitionOpts:Ve,flushSync:De===!0}),k=cn.Pop,D=!1,R=!1,G=!1,H=!1,q=[]}async function ot(V,j){if(typeof V=="number"){t.history.go(V);return}let K=Hv(w.location,w.matches,l,d.v7_prependBasename,V,d.v7_relativeSplatPath,j==null?void 0:j.fromRouteId,j==null?void 0:j.relative),{path:ce,submission:ge,error:De}=rb(d.v7_normalizeFormMethod,!1,K,j),Oe=w.location,ke=zd(w.location,ce,j&&j.state);ke=zt({},ke,t.history.encodeLocation(ke));let Ie=j&&j.replace!=null?j.replace:void 0,be=cn.Push;Ie===!0?be=cn.Replace:Ie===!1||ge!=null&&Oi(ge.formMethod)&&ge.formAction===w.location.pathname+w.location.search&&(be=cn.Replace);let Re=j&&"preventScrollReset"in j?j.preventScrollReset===!0:void 0,Ve=(j&&j.flushSync)===!0,Je=ro({currentLocation:Oe,nextLocation:ke,historyAction:be});if(Je){xi(Je,{state:"blocked",location:ke,proceed(){xi(Je,{state:"proceeding",proceed:void 0,reset:void 0,location:ke}),ot(V,j)},reset(){let fn=new Map(w.blockers);fn.set(Je,_u),ze({blockers:fn})}});return}return await Ce(be,ke,{submission:ge,pendingError:De,preventScrollReset:Re,replace:j&&j.replace,enableViewTransition:j&&j.viewTransition,flushSync:Ve})}function he(){if(_(),ze({revalidation:"loading"}),w.navigation.state!=="submitting"){if(w.navigation.state==="idle"){Ce(w.historyAction,w.location,{startUninterruptedRevalidation:!0});return}Ce(k||w.historyAction,w.navigation.location,{overrideNavigation:w.navigation,enableViewTransition:R===!0})}}async function Ce(V,j,K){T&&T.abort(),T=null,k=V,G=(K&&K.startUninterruptedRevalidation)===!0,Kt(w.location,w.matches),D=(K&&K.preventScrollReset)===!0,R=(K&&K.enableViewTransition)===!0;let ce=a||s,ge=K&&K.overrideNavigation,De=K!=null&&K.initialHydration&&w.matches&&w.matches.length>0&&!y?w.matches:Ya(ce,j,l),Oe=(K&&K.flushSync)===!0;if(De&&w.initialized&&!H&&BB(w.location,j)&&!(K&&K.submission&&Oi(K.submission.formMethod))){at(j,{matches:De},{flushSync:Oe});return}let ke=Hs(De,ce,j.pathname);if(ke.active&&ke.matches&&(De=ke.matches),!De){let{error:pe,notFoundMatches:U,route:oe}=Ha(j.pathname);at(j,{matches:U,loaderData:{},errors:{[oe.id]:pe}},{flushSync:Oe});return}T=new AbortController;let Ie=Xl(t.history,j,T.signal,K&&K.submission),be;if(K&&K.pendingError)be=[qa(De).route.id,{type:mt.error,error:K.pendingError}];else if(K&&K.submission&&Oi(K.submission.formMethod)){let pe=await Ue(Ie,j,K.submission,De,ke.active,{replace:K.replace,flushSync:Oe});if(pe.shortCircuited)return;if(pe.pendingActionResult){let[U,oe]=pe.pendingActionResult;if(Zr(oe)&&jd(oe.error)&&oe.error.status===404){T=null,at(j,{matches:pe.matches,loaderData:{},errors:{[U]:oe.error}});return}}De=pe.matches||De,be=pe.pendingActionResult,ge=Dg(j,K.submission),Oe=!1,ke.active=!1,Ie=Xl(t.history,Ie.url,Ie.signal)}let{shortCircuited:Re,matches:Ve,loaderData:Je,errors:fn}=await Le(Ie,j,De,ke.active,ge,K&&K.submission,K&&K.fetcherSubmission,K&&K.replace,K&&K.initialHydration===!0,Oe,be);Re||(T=null,at(j,zt({matches:Ve||De},fb(be),{loaderData:Je,errors:fn})))}async function Ue(V,j,K,ce,ge,De){De===void 0&&(De={}),_();let Oe=VB(j,K);if(ze({navigation:Oe},{flushSync:De.flushSync===!0}),ge){let be=await Zo(ce,j.pathname,V.signal);if(be.type==="aborted")return{shortCircuited:!0};if(be.type==="error"){let Re=qa(be.partialMatches).route.id;return{matches:be.partialMatches,pendingActionResult:[Re,{type:mt.error,error:be.error}]}}else if(be.matches)ce=be.matches;else{let{notFoundMatches:Re,error:Ve,route:Je}=Ha(j.pathname);return{matches:Re,pendingActionResult:[Je.id,{type:mt.error,error:Ve}]}}}let ke,Ie=Yu(ce,j);if(!Ie.route.action&&!Ie.route.lazy)ke={type:mt.error,error:yr(405,{method:V.method,pathname:j.pathname,routeId:Ie.route.id})};else if(ke=(await wt("action",w,V,[Ie],ce,null))[Ie.route.id],V.signal.aborted)return{shortCircuited:!0};if(al(ke)){let be;return De&&De.replace!=null?be=De.replace:be=lb(ke.response.headers.get("Location"),new URL(V.url),l)===w.location.pathname+w.location.search,await Wt(V,ke,!0,{submission:K,replace:be}),{shortCircuited:!0}}if(fa(ke))throw yr(400,{type:"defer-action"});if(Zr(ke)){let be=qa(ce,Ie.route.id);return(De&&De.replace)!==!0&&(k=cn.Push),{matches:ce,pendingActionResult:[be.route.id,ke]}}return{matches:ce,pendingActionResult:[Ie.route.id,ke]}}async function Le(V,j,K,ce,ge,De,Oe,ke,Ie,be,Re){let Ve=ge||Dg(j,De),Je=De||Oe||gb(Ve),fn=!G&&(!d.v7_partialHydration||!Ie);if(ce){if(fn){let Jt=Pe(Re);ze(zt({navigation:Ve},Jt!==void 0?{actionData:Jt}:{}),{flushSync:be})}let rt=await Zo(K,j.pathname,V.signal);if(rt.type==="aborted")return{shortCircuited:!0};if(rt.type==="error"){let Jt=qa(rt.partialMatches).route.id;return{matches:rt.partialMatches,loaderData:{},errors:{[Jt]:rt.error}}}else if(rt.matches)K=rt.matches;else{let{error:Jt,notFoundMatches:Hl,route:Iu}=Ha(j.pathname);return{matches:Hl,loaderData:{},errors:{[Iu.id]:Jt}}}}let pe=a||s,[U,oe]=ob(t.history,w,K,Je,j,d.v7_partialHydration&&Ie===!0,d.v7_skipActionErrorRevalidation,H,q,ie,se,J,z,pe,l,Re);if(ri(rt=>!(K&&K.some(Jt=>Jt.route.id===rt))||U&&U.some(Jt=>Jt.route.id===rt)),ne=++Q,U.length===0&&oe.length===0){let rt=tt();return at(j,zt({matches:K,loaderData:{},errors:Re&&Zr(Re[1])?{[Re[0]]:Re[1].error}:null},fb(Re),rt?{fetchers:new Map(w.fetchers)}:{}),{flushSync:be}),{shortCircuited:!0}}if(fn){let rt={};if(!ce){rt.navigation=Ve;let Jt=Pe(Re);Jt!==void 0&&(rt.actionData=Jt)}oe.length>0&&(rt.fetchers=$e(oe)),ze(rt,{flushSync:be})}oe.forEach(rt=>{te(rt.key),rt.controller&&Z.set(rt.key,rt.controller)});let Ae=()=>oe.forEach(rt=>te(rt.key));T&&T.signal.addEventListener("abort",Ae);let{loaderResults:pt,fetcherResults:St}=await on(w,K,U,oe,V);if(V.signal.aborted)return{shortCircuited:!0};T&&T.signal.removeEventListener("abort",Ae),oe.forEach(rt=>Z.delete(rt.key));let xt=Yf(pt);if(xt)return await Wt(V,xt.result,!0,{replace:ke}),{shortCircuited:!0};if(xt=Yf(St),xt)return z.add(xt.key),await Wt(V,xt.result,!0,{replace:ke}),{shortCircuited:!0};let{loaderData:bn,errors:zn}=ub(w,K,pt,Re,oe,St,me);me.forEach((rt,Jt)=>{rt.subscribe(Hl=>{(Hl||rt.done)&&me.delete(Jt)})}),d.v7_partialHydration&&Ie&&w.errors&&(zn=zt({},w.errors,zn));let Nr=tt(),sn=lt(ne),Za=Nr||sn||oe.length>0;return zt({matches:K,loaderData:bn,errors:zn},Za?{fetchers:new Map(w.fetchers)}:{})}function Pe(V){if(V&&!Zr(V[1]))return{[V[0]]:V[1].data};if(w.actionData)return Object.keys(w.actionData).length===0?null:w.actionData}function $e(V){return V.forEach(j=>{let K=w.fetchers.get(j.key),ce=Du(void 0,K?K.data:void 0);w.fetchers.set(j.key,ce)}),new Map(w.fetchers)}function st(V,j,K,ce){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");te(V);let ge=(ce&&ce.flushSync)===!0,De=a||s,Oe=Hv(w.location,w.matches,l,d.v7_prependBasename,K,d.v7_relativeSplatPath,j,ce==null?void 0:ce.relative),ke=Ya(De,Oe,l),Ie=Hs(ke,De,Oe);if(Ie.active&&Ie.matches&&(ke=Ie.matches),!ke){A(V,j,yr(404,{pathname:Oe}),{flushSync:ge});return}let{path:be,submission:Re,error:Ve}=rb(d.v7_normalizeFormMethod,!0,Oe,ce);if(Ve){A(V,j,Ve,{flushSync:ge});return}let Je=Yu(ke,be),fn=(ce&&ce.preventScrollReset)===!0;if(Re&&Oi(Re.formMethod)){Qe(V,j,be,Je,ke,Ie.active,ge,fn,Re);return}J.set(V,{routeId:j,path:be}),Gt(V,j,be,Je,ke,Ie.active,ge,fn,Re)}async function Qe(V,j,K,ce,ge,De,Oe,ke,Ie){_(),J.delete(V);function be(an){if(!an.route.action&&!an.route.lazy){let Zl=yr(405,{method:Ie.formMethod,pathname:K,routeId:j});return A(V,j,Zl,{flushSync:Oe}),!0}return!1}if(!De&&be(ce))return;let Re=w.fetchers.get(V);x(V,GB(Ie,Re),{flushSync:Oe});let Ve=new AbortController,Je=Xl(t.history,K,Ve.signal,Ie);if(De){let an=await Zo(ge,new URL(Je.url).pathname,Je.signal,V);if(an.type==="aborted")return;if(an.type==="error"){A(V,j,an.error,{flushSync:Oe});return}else if(an.matches){if(ge=an.matches,ce=Yu(ge,K),be(ce))return}else{A(V,j,yr(404,{pathname:K}),{flushSync:Oe});return}}Z.set(V,Ve);let fn=Q,U=(await wt("action",w,Je,[ce],ge,V))[ce.route.id];if(Je.signal.aborted){Z.get(V)===Ve&&Z.delete(V);return}if(d.v7_fetcherPersist&&se.has(V)){if(al(U)||Zr(U)){x(V,Ys(void 0));return}}else{if(al(U))if(Z.delete(V),ne>fn){x(V,Ys(void 0));return}else return z.add(V),x(V,Du(Ie)),Wt(Je,U,!1,{fetcherSubmission:Ie,preventScrollReset:ke});if(Zr(U)){A(V,j,U.error);return}}if(fa(U))throw yr(400,{type:"defer-action"});let oe=w.navigation.location||w.location,Ae=Xl(t.history,oe,Ve.signal),pt=a||s,St=w.navigation.state!=="idle"?Ya(pt,w.navigation.location,l):w.matches;ut(St,"Didn't find any matches after fetcher action");let xt=++Q;F.set(V,xt);let bn=Du(Ie,U.data);w.fetchers.set(V,bn);let[zn,Nr]=ob(t.history,w,St,Ie,oe,!1,d.v7_skipActionErrorRevalidation,H,q,ie,se,J,z,pt,l,[ce.route.id,U]);Nr.filter(an=>an.key!==V).forEach(an=>{let Zl=an.key,Wx=w.fetchers.get(Zl),pP=Du(void 0,Wx?Wx.data:void 0);w.fetchers.set(Zl,pP),te(Zl),an.controller&&Z.set(Zl,an.controller)}),ze({fetchers:new Map(w.fetchers)});let sn=()=>Nr.forEach(an=>te(an.key));Ve.signal.addEventListener("abort",sn);let{loaderResults:Za,fetcherResults:rt}=await on(w,St,zn,Nr,Ae);if(Ve.signal.aborted)return;Ve.signal.removeEventListener("abort",sn),F.delete(V),Z.delete(V),Nr.forEach(an=>Z.delete(an.key));let Jt=Yf(Za);if(Jt)return Wt(Ae,Jt.result,!1,{preventScrollReset:ke});if(Jt=Yf(rt),Jt)return z.add(Jt.key),Wt(Ae,Jt.result,!1,{preventScrollReset:ke});let{loaderData:Hl,errors:Iu}=ub(w,St,Za,void 0,Nr,rt,me);if(w.fetchers.has(V)){let an=Ys(U.data);w.fetchers.set(V,an)}lt(xt),w.navigation.state==="loading"&&xt>ne?(ut(k,"Expected pending action"),T&&T.abort(),at(w.navigation.location,{matches:St,loaderData:Hl,errors:Iu,fetchers:new Map(w.fetchers)})):(ze({errors:Iu,loaderData:db(w.loaderData,Hl,St,Iu),fetchers:new Map(w.fetchers)}),H=!1)}async function Gt(V,j,K,ce,ge,De,Oe,ke,Ie){let be=w.fetchers.get(V);x(V,Du(Ie,be?be.data:void 0),{flushSync:Oe});let Re=new AbortController,Ve=Xl(t.history,K,Re.signal);if(De){let U=await Zo(ge,new URL(Ve.url).pathname,Ve.signal,V);if(U.type==="aborted")return;if(U.type==="error"){A(V,j,U.error,{flushSync:Oe});return}else if(U.matches)ge=U.matches,ce=Yu(ge,K);else{A(V,j,yr(404,{pathname:K}),{flushSync:Oe});return}}Z.set(V,Re);let Je=Q,pe=(await wt("loader",w,Ve,[ce],ge,V))[ce.route.id];if(fa(pe)&&(pe=await d1(pe,Ve.signal,!0)||pe),Z.get(V)===Re&&Z.delete(V),!Ve.signal.aborted){if(se.has(V)){x(V,Ys(void 0));return}if(al(pe))if(ne>Je){x(V,Ys(void 0));return}else{z.add(V),await Wt(Ve,pe,!1,{preventScrollReset:ke});return}if(Zr(pe)){A(V,j,pe.error);return}ut(!fa(pe),"Unhandled fetcher deferred data"),x(V,Ys(pe.data))}}async function Wt(V,j,K,ce){let{submission:ge,fetcherSubmission:De,preventScrollReset:Oe,replace:ke}=ce===void 0?{}:ce;j.response.headers.has("X-Remix-Revalidate")&&(H=!0);let Ie=j.response.headers.get("Location");ut(Ie,"Expected a Location header on the redirect Response"),Ie=lb(Ie,new URL(V.url),l);let be=zd(w.location,Ie,{_isRedirect:!0});if(n){let U=!1;if(j.response.headers.has("X-Remix-Reload-Document"))U=!0;else if(u1.test(Ie)){const oe=t.history.createURL(Ie);U=oe.origin!==e.location.origin||yf(oe.pathname,l)==null}if(U){ke?e.location.replace(Ie):e.location.assign(Ie);return}}T=null;let Re=ke===!0||j.response.headers.has("X-Remix-Replace")?cn.Replace:cn.Push,{formMethod:Ve,formAction:Je,formEncType:fn}=w.navigation;!ge&&!De&&Ve&&Je&&fn&&(ge=gb(w.navigation));let pe=ge||De;if(IB.has(j.response.status)&&pe&&Oi(pe.formMethod))await Ce(Re,be,{submission:zt({},pe,{formAction:Ie}),preventScrollReset:Oe||D,enableViewTransition:K?R:void 0});else{let U=Dg(be,ge);await Ce(Re,be,{overrideNavigation:U,fetcherSubmission:De,preventScrollReset:Oe||D,enableViewTransition:K?R:void 0})}}async function wt(V,j,K,ce,ge,De){let Oe,ke={};try{Oe=await RB(c,V,j,K,ce,ge,De,o,i)}catch(Ie){return ce.forEach(be=>{ke[be.route.id]={type:mt.error,error:Ie}}),ke}for(let[Ie,be]of Object.entries(Oe))if(FB(be)){let Re=be.result;ke[Ie]={type:mt.redirect,response:PB(Re,K,Ie,ge,l,d.v7_relativeSplatPath)}}else ke[Ie]=await DB(be);return ke}async function on(V,j,K,ce,ge){let De=V.matches,Oe=wt("loader",V,ge,K,j,null),ke=Promise.all(ce.map(async Re=>{if(Re.matches&&Re.match&&Re.controller){let Je=(await wt("loader",V,Xl(t.history,Re.path,Re.controller.signal),[Re.match],Re.matches,Re.key))[Re.match.route.id];return{[Re.key]:Je}}else return Promise.resolve({[Re.key]:{type:mt.error,error:yr(404,{pathname:Re.path})}})})),Ie=await Oe,be=(await ke).reduce((Re,Ve)=>Object.assign(Re,Ve),{});return await Promise.all([LB(j,Ie,ge.signal,De,V.loaderData),UB(j,be,ce)]),{loaderResults:Ie,fetcherResults:be}}function _(){H=!0,q.push(...ri()),J.forEach((V,j)=>{Z.has(j)&&ie.add(j),te(j)})}function x(V,j,K){K===void 0&&(K={}),w.fetchers.set(V,j),ze({fetchers:new Map(w.fetchers)},{flushSync:(K&&K.flushSync)===!0})}function A(V,j,K,ce){ce===void 0&&(ce={});let ge=qa(w.matches,j);W(V),ze({errors:{[ge.route.id]:K},fetchers:new Map(w.fetchers)},{flushSync:(ce&&ce.flushSync)===!0})}function B(V){return ee.set(V,(ee.get(V)||0)+1),se.has(V)&&se.delete(V),w.fetchers.get(V)||bB}function W(V){let j=w.fetchers.get(V);Z.has(V)&&!(j&&j.state==="loading"&&F.has(V))&&te(V),J.delete(V),F.delete(V),z.delete(V),d.v7_fetcherPersist&&se.delete(V),ie.delete(V),w.fetchers.delete(V)}function Y(V){let j=(ee.get(V)||0)-1;j<=0?(ee.delete(V),se.add(V),d.v7_fetcherPersist||W(V)):ee.set(V,j),ze({fetchers:new Map(w.fetchers)})}function te(V){let j=Z.get(V);j&&(j.abort(),Z.delete(V))}function Ne(V){for(let j of V){let K=B(j),ce=Ys(K.data);w.fetchers.set(j,ce)}}function tt(){let V=[],j=!1;for(let K of z){let ce=w.fetchers.get(K);ut(ce,"Expected fetcher: "+K),ce.state==="loading"&&(z.delete(K),V.push(K),j=!0)}return Ne(V),j}function lt(V){let j=[];for(let[K,ce]of F)if(ce<V){let ge=w.fetchers.get(K);ut(ge,"Expected fetcher: "+K),ge.state==="loading"&&(te(K),F.delete(K),j.push(K))}return Ne(j),j.length>0}function ht(V,j){let K=w.blockers.get(V)||_u;return Be.get(V)!==j&&Be.set(V,j),K}function nt(V){w.blockers.delete(V),Be.delete(V)}function xi(V,j){let K=w.blockers.get(V)||_u;ut(K.state==="unblocked"&&j.state==="blocked"||K.state==="blocked"&&j.state==="blocked"||K.state==="blocked"&&j.state==="proceeding"||K.state==="blocked"&&j.state==="unblocked"||K.state==="proceeding"&&j.state==="unblocked","Invalid blocker state transition: "+K.state+" -> "+j.state);let ce=new Map(w.blockers);ce.set(V,j),ze({blockers:ce})}function ro(V){let{currentLocation:j,nextLocation:K,historyAction:ce}=V;if(Be.size===0)return;Be.size>1&&zc(!1,"A router only supports one blocker at a time");let ge=Array.from(Be.entries()),[De,Oe]=ge[ge.length-1],ke=w.blockers.get(De);if(!(ke&&ke.state==="proceeding")&&Oe({currentLocation:j,nextLocation:K,historyAction:ce}))return De}function Ha(V){let j=yr(404,{pathname:V}),K=a||s,{matches:ce,route:ge}=hb(K);return ri(),{notFoundMatches:ce,route:ge,error:j}}function ri(V){let j=[];return me.forEach((K,ce)=>{(!V||V(ce))&&(K.cancel(),j.push(ce),me.delete(ce))}),j}function xu(V,j,K){if(p=V,C=j,m=K||null,!v&&w.navigation===_g){v=!0;let ce=ii(w.location,w.matches);ce!=null&&ze({restoreScrollPosition:ce})}return()=>{p=null,C=null,m=null}}function zl(V,j){return m&&m(V,j.map(ce=>Y5(ce,w.loaderData)))||V.key}function Kt(V,j){if(p&&C){let K=zl(V,j);p[K]=C()}}function ii(V,j){if(p){let K=zl(V,j),ce=p[K];if(typeof ce=="number")return ce}return null}function Hs(V,j,K){if(u)if(V){if(Object.keys(V[0].params).length>0)return{active:!0,matches:kh(j,K,l,!0)}}else return{active:!0,matches:kh(j,K,l,!0)||[]};return{active:!1,matches:null}}async function Zo(V,j,K,ce){if(!u)return{type:"success",matches:V};let ge=V;for(;;){let De=a==null,Oe=a||s,ke=o;try{await u({signal:K,path:j,matches:ge,fetcherKey:ce,patch:(Re,Ve)=>{K.aborted||ab(Re,Ve,Oe,ke,i)}})}catch(Re){return{type:"error",error:Re,partialMatches:ge}}finally{De&&!K.aborted&&(s=[...s])}if(K.aborted)return{type:"aborted"};let Ie=Ya(Oe,j,l);if(Ie)return{type:"success",matches:Ie};let be=kh(Oe,j,l,!0);if(!be||ge.length===be.length&&ge.every((Re,Ve)=>Re.route.id===be[Ve].route.id))return{type:"success",matches:null};ge=be}}function Zs(V){o={},a=w0(V,i,void 0,o)}function jl(V,j){let K=a==null;ab(V,j,a||s,o,i),K&&(s=[...s],ze({}))}return E={get basename(){return l},get future(){return d},get state(){return w},get routes(){return s},get window(){return e},initialize:Pt,subscribe:dn,enableScrollRestoration:xu,navigate:ot,fetch:st,revalidate:he,createHref:V=>t.history.createHref(V),encodeLocation:V=>t.history.encodeLocation(V),getFetcher:B,deleteFetcher:Y,dispose:Vt,getBlocker:ht,deleteBlocker:nt,patchRoutes:jl,_internalFetchControllers:Z,_internalActiveDeferreds:me,_internalSetRoutes:Zs},E}function SB(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Hv(t,e,n,r,i,o,s,a){let l,c;if(s){l=[];for(let d of e)if(l.push(d),d.route.id===s){c=d;break}}else l=e,c=e[e.length-1];let u=hB(i||".",fB(l,o),yf(t.pathname,n)||t.pathname,a==="path");if(i==null&&(u.search=t.search,u.hash=t.hash),(i==null||i===""||i===".")&&c){let d=f1(u.search);if(c.route.index&&!d)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&d){let f=new URLSearchParams(u.search),h=f.getAll("index");f.delete("index"),h.filter(m=>m).forEach(m=>f.append("index",m));let p=f.toString();u.search=p?"?"+p:""}}return r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:pl([n,u.pathname])),Cf(u)}function rb(t,e,n,r){if(!r||!SB(r))return{path:n};if(r.formMethod&&!MB(r.formMethod))return{path:n,error:yr(405,{method:r.formMethod})};let i=()=>({path:n,error:yr(400,{type:"invalid-body"})}),o=r.formMethod||"get",s=t?o.toUpperCase():o.toLowerCase(),a=ST(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Oi(s))return i();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[m,C]=p;return""+h+m+"="+C+`
`},""):String(r.body);return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!Oi(s))return i();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:s,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return i()}}}ut(typeof FormData=="function","FormData is not available in this environment");let l,c;if(r.formData)l=$v(r.formData),c=r.formData;else if(r.body instanceof FormData)l=$v(r.body),c=r.body;else if(r.body instanceof URLSearchParams)l=r.body,c=cb(l);else if(r.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(r.body),c=cb(l)}catch{return i()}let u={formMethod:s,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(Oi(u.formMethod))return{path:n,submission:u};let d=Ua(n);return e&&d.search&&f1(d.search)&&l.append("index",""),d.search="?"+l,{path:Cf(d),submission:u}}function ib(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(i=>i.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function ob(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,m){let C=m?Zr(m[1])?m[1].error:m[1].data:void 0,v=t.createURL(e.location),g=t.createURL(i),y=n;o&&e.errors?y=ib(n,Object.keys(e.errors)[0],!0):m&&Zr(m[1])&&(y=ib(n,m[0]));let I=m?m[1].statusCode:void 0,b=s&&I&&I>=400,E=y.filter((k,D)=>{let{route:T}=k;if(T.lazy)return!0;if(T.loader==null)return!1;if(o)return Zv(T,e.loaderData,e.errors);if(kB(e.loaderData,e.matches[D],k)||l.some(M=>M===k.route.id))return!0;let R=e.matches[D],P=k;return sb(k,zt({currentUrl:v,currentParams:R.params,nextUrl:g,nextParams:P.params},r,{actionResult:C,actionStatus:I,defaultShouldRevalidate:b?!1:a||v.pathname+v.search===g.pathname+g.search||v.search!==g.search||AT(R,P)}))}),w=[];return d.forEach((k,D)=>{if(o||!n.some(G=>G.route.id===k.routeId)||u.has(D))return;let T=Ya(h,k.path,p);if(!T){w.push({key:D,routeId:k.routeId,path:k.path,matches:null,match:null,controller:null});return}let R=e.fetchers.get(D),P=Yu(T,k.path),M=!1;f.has(D)?M=!1:c.has(D)?(c.delete(D),M=!0):R&&R.state!=="idle"&&R.data===void 0?M=a:M=sb(P,zt({currentUrl:v,currentParams:e.matches[e.matches.length-1].params,nextUrl:g,nextParams:n[n.length-1].params},r,{actionResult:C,actionStatus:I,defaultShouldRevalidate:b?!1:a})),M&&w.push({key:D,routeId:k.routeId,path:k.path,matches:T,match:P,controller:new AbortController})}),[E,w]}function Zv(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,i=n!=null&&n[t.id]!==void 0;return!r&&i?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!i}function kB(t,e,n){let r=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return r||i}function AT(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function sb(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function ab(t,e,n,r,i){var o;let s;if(t){let c=r[t];ut(c,"No route found to patch children into: routeId = "+t),c.children||(c.children=[]),s=c.children}else s=n;let a=e.filter(c=>!s.some(u=>wT(c,u))),l=w0(a,i,[t||"_","patch",String(((o=s)==null?void 0:o.length)||"0")],r);s.push(...l)}function wT(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var i;return(i=e.children)==null?void 0:i.some(o=>wT(n,o))}):!1}async function EB(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let i=n[t.id];ut(i,"No route found in manifest");let o={};for(let s in r){let l=i[s]!==void 0&&s!=="hasErrorBoundary";zc(!l,'Route "'+i.id+'" has a static property "'+s+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+s+'" will be ignored.')),!l&&!K5.has(s)&&(o[s]=r[s])}Object.assign(i,o),Object.assign(i,zt({},e(i),{lazy:void 0}))}async function TB(t){let{matches:e}=t,n=e.filter(i=>i.shouldLoad);return(await Promise.all(n.map(i=>i.resolve()))).reduce((i,o,s)=>Object.assign(i,{[n[s].route.id]:o}),{})}async function RB(t,e,n,r,i,o,s,a,l,c){let u=o.map(h=>h.route.lazy?EB(h.route,l,a):void 0),d=o.map((h,p)=>{let m=u[p],C=i.some(g=>g.route.id===h.route.id);return zt({},h,{shouldLoad:C,resolve:async g=>(g&&r.method==="GET"&&(h.route.lazy||h.route.loader)&&(C=!0),C?_B(e,r,h,m,g,c):Promise.resolve({type:mt.data,result:void 0}))})}),f=await t({matches:d,request:r,params:o[0].params,fetcherKey:s,context:c});try{await Promise.all(u)}catch{}return f}async function _B(t,e,n,r,i,o){let s,a,l=c=>{let u,d=new Promise((p,m)=>u=m);a=()=>u(),e.signal.addEventListener("abort",a);let f=p=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):c({request:e,params:n.params,context:o},...p!==void 0?[p]:[]),h=(async()=>{try{return{type:"data",result:await(i?i(m=>f(m)):f())}}catch(p){return{type:"error",result:p}}})();return Promise.race([h,d])};try{let c=n.route[t];if(r)if(c){let u,[d]=await Promise.all([l(c).catch(f=>{u=f}),r]);if(u!==void 0)throw u;s=d}else if(await r,c=n.route[t],c)s=await l(c);else if(t==="action"){let u=new URL(e.url),d=u.pathname+u.search;throw yr(405,{method:e.method,pathname:d,routeId:n.route.id})}else return{type:mt.data,result:void 0};else if(c)s=await l(c);else{let u=new URL(e.url),d=u.pathname+u.search;throw yr(404,{pathname:d})}ut(s.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:mt.error,result:c}}finally{a&&e.signal.removeEventListener("abort",a)}return s}async function DB(t){let{result:e,type:n}=t;if(kT(e)){let d;try{let f=e.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?e.body==null?d=null:d=await e.json():d=await e.text()}catch(f){return{type:mt.error,error:f}}return n===mt.error?{type:mt.error,error:new S0(e.status,e.statusText,d),statusCode:e.status,headers:e.headers}:{type:mt.data,data:d,statusCode:e.status,headers:e.headers}}if(n===mt.error){if(pb(e)){var r,i;if(e.data instanceof Error){var o,s;return{type:mt.error,error:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:mt.error,error:new S0(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:jd(e)?e.status:void 0,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:mt.error,error:e,statusCode:jd(e)?e.status:void 0}}if(OB(e)){var a,l;return{type:mt.deferred,deferredData:e,statusCode:(a=e.init)==null?void 0:a.status,headers:((l=e.init)==null?void 0:l.headers)&&new Headers(e.init.headers)}}if(pb(e)){var c,u;return{type:mt.data,data:e.data,statusCode:(c=e.init)==null?void 0:c.status,headers:(u=e.init)!=null&&u.headers?new Headers(e.init.headers):void 0}}return{type:mt.data,data:e}}function PB(t,e,n,r,i,o){let s=t.headers.get("Location");if(ut(s,"Redirects returned/thrown from loaders/actions must have a Location header"),!u1.test(s)){let a=r.slice(0,r.findIndex(l=>l.route.id===n)+1);s=Hv(new URL(e.url),a,i,!0,s,o),t.headers.set("Location",s)}return t}function lb(t,e,n){if(u1.test(t)){let r=t,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),o=yf(i.pathname,n)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return t}function Xl(t,e,n,r){let i=t.createURL(ST(e)).toString(),o={signal:n};if(r&&Oi(r.formMethod)){let{formMethod:s,formEncType:a}=r;o.method=s.toUpperCase(),a==="application/json"?(o.headers=new Headers({"Content-Type":a}),o.body=JSON.stringify(r.json)):a==="text/plain"?o.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?o.body=$v(r.formData):o.body=r.formData}return new Request(i,o)}function $v(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function cb(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function NB(t,e,n,r,i){let o={},s=null,a,l=!1,c={},u=n&&Zr(n[1])?n[1].error:void 0;return t.forEach(d=>{if(!(d.route.id in e))return;let f=d.route.id,h=e[f];if(ut(!al(h),"Cannot handle redirect results in processLoaderData"),Zr(h)){let p=h.error;u!==void 0&&(p=u,u=void 0),s=s||{};{let m=qa(t,f);s[m.route.id]==null&&(s[m.route.id]=p)}o[f]=void 0,l||(l=!0,a=jd(h.error)?h.error.status:500),h.headers&&(c[f]=h.headers)}else fa(h)?(r.set(f,h.deferredData),o[f]=h.deferredData.data,h.statusCode!=null&&h.statusCode!==200&&!l&&(a=h.statusCode),h.headers&&(c[f]=h.headers)):(o[f]=h.data,h.statusCode&&h.statusCode!==200&&!l&&(a=h.statusCode),h.headers&&(c[f]=h.headers))}),u!==void 0&&n&&(s={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:s,statusCode:a||200,loaderHeaders:c}}function ub(t,e,n,r,i,o,s){let{loaderData:a,errors:l}=NB(e,n,r,s);return i.forEach(c=>{let{key:u,match:d,controller:f}=c,h=o[u];if(ut(h,"Did not find corresponding fetcher result"),!(f&&f.signal.aborted))if(Zr(h)){let p=qa(t.matches,d==null?void 0:d.route.id);l&&l[p.route.id]||(l=zt({},l,{[p.route.id]:h.error})),t.fetchers.delete(u)}else if(al(h))ut(!1,"Unhandled fetcher revalidation redirect");else if(fa(h))ut(!1,"Unhandled fetcher deferred data");else{let p=Ys(h.data);t.fetchers.set(u,p)}}),{loaderData:a,errors:l}}function db(t,e,n,r){let i=zt({},e);for(let o of n){let s=o.route.id;if(e.hasOwnProperty(s)?e[s]!==void 0&&(i[s]=e[s]):t[s]!==void 0&&o.route.loader&&(i[s]=t[s]),r&&r.hasOwnProperty(s))break}return i}function fb(t){return t?Zr(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function qa(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function hb(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function yr(t,e){let{pathname:n,routeId:r,method:i,type:o,message:s}=e===void 0?{}:e,a="Unknown Server Error",l="Unknown @remix-run/router error";return t===400?(a="Bad Request",i&&n&&r?l="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?l="defer() is not supported in actions":o==="invalid-body"&&(l="Unable to encode submission body")):t===403?(a="Forbidden",l='Route "'+r+'" does not match URL "'+n+'"'):t===404?(a="Not Found",l='No route matches URL "'+n+'"'):t===405&&(a="Method Not Allowed",i&&n&&r?l="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(l='Invalid request method "'+i.toUpperCase()+'"')),new S0(t||500,a,new Error(l),!0)}function Yf(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,i]=e[n];if(al(i))return{key:r,result:i}}}function ST(t){let e=typeof t=="string"?Ua(t):t;return Cf(zt({},e,{hash:""}))}function BB(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function FB(t){return kT(t.result)&&xB.has(t.result.status)}function fa(t){return t.type===mt.deferred}function Zr(t){return t.type===mt.error}function al(t){return(t&&t.type)===mt.redirect}function pb(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function OB(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function kT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function MB(t){return yB.has(t.toLowerCase())}function Oi(t){return vB.has(t.toLowerCase())}async function LB(t,e,n,r,i){let o=Object.entries(e);for(let s=0;s<o.length;s++){let[a,l]=o[s],c=t.find(f=>(f==null?void 0:f.route.id)===a);if(!c)continue;let u=r.find(f=>f.route.id===c.route.id),d=u!=null&&!AT(u,c)&&(i&&i[c.route.id])!==void 0;fa(l)&&d&&await d1(l,n,!1).then(f=>{f&&(e[a]=f)})}}async function UB(t,e,n){for(let r=0;r<n.length;r++){let{key:i,routeId:o,controller:s}=n[r],a=e[i];t.find(c=>(c==null?void 0:c.route.id)===o)&&fa(a)&&(ut(s,"Expected an AbortController for revalidating fetcher deferred result"),await d1(a,s.signal,!0).then(c=>{c&&(e[i]=c)}))}}async function d1(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:mt.data,data:t.deferredData.unwrappedData}}catch(i){return{type:mt.error,error:i}}return{type:mt.data,data:t.deferredData.data}}}function f1(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Yu(t,e){let n=typeof e=="string"?Ua(e).search:e.search;if(t[t.length-1].route.index&&f1(n||""))return t[t.length-1];let r=xT(t);return r[r.length-1]}function gb(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:o,json:s}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(s!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:s,text:void 0}}}function Dg(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function VB(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Du(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function GB(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Ys(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function WB(t,e){try{let n=t.sessionStorage.getItem(bT);if(n){let r=JSON.parse(n);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function zB(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(bT,JSON.stringify(n))}catch(r){zc(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xv(){return Xv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Xv.apply(this,arguments)}const ET=S.createContext(null),TT=S.createContext(null),RT=S.createContext(null),h1=S.createContext(null),kp=S.createContext({outlet:null,matches:[],isDataRoute:!1}),_T=S.createContext(null);function p1(){return S.useContext(h1)!=null}function DT(){return p1()||ut(!1),S.useContext(h1).location}function jB(t,e,n,r){p1()||ut(!1);let{navigator:i,static:o}=S.useContext(RT),{matches:s}=S.useContext(kp),a=s[s.length-1],l=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=DT(),d;d=u;let f=d.pathname||"/",h=f;if(c!=="/"){let C=c.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(C.length).join("/")}let p=!o&&n&&n.matches&&n.matches.length>0?n.matches:Ya(t,{pathname:h});return KB(p&&p.map(C=>Object.assign({},C,{params:Object.assign({},l,C.params),pathname:pl([c,i.encodeLocation?i.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?c:pl([c,i.encodeLocation?i.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),s,n,r)}function HB(){let t=QB(),e=jd(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),n?S.createElement("pre",{style:i},n):null,null)}const ZB=S.createElement(HB,null);class $B extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?S.createElement(kp.Provider,{value:this.props.routeContext},S.createElement(_T.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function XB(t){let{routeContext:e,match:n,children:r}=t,i=S.useContext(ET);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(kp.Provider,{value:e},r)}function KB(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=s.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||ut(!1),s=s.slice(0,Math.min(s.length,u+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,d,f)=>{let h,p=!1,m=null,C=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||ZB,l&&(c<0&&f===0?(e4("route-fallback"),p=!0,C=null):c===f&&(p=!0,C=d.route.hydrateFallbackElement||null)));let v=e.concat(s.slice(0,f+1)),g=()=>{let y;return h?y=m:p?y=C:d.route.Component?y=S.createElement(d.route.Component,null):d.route.element?y=d.route.element:y=u,S.createElement(XB,{match:d,routeContext:{outlet:u,matches:v,isDataRoute:n!=null},children:y})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?S.createElement($B,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:g(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):g()},null)}var PT=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(PT||{});function JB(t){let e=S.useContext(TT);return e||ut(!1),e}function YB(t){let e=S.useContext(kp);return e||ut(!1),e}function qB(t){let e=YB(),n=e.matches[e.matches.length-1];return n.route.id||ut(!1),n.route.id}function QB(){var t;let e=S.useContext(_T),n=JB(PT.UseRouteError),r=qB();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}const mb={};function e4(t,e,n){mb[t]||(mb[t]=!0)}function t4(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function n4(t){let{basename:e="/",children:n=null,location:r,navigationType:i=cn.Pop,navigator:o,static:s=!1,future:a}=t;p1()&&ut(!1);let l=e.replace(/^\/*/,"/"),c=S.useMemo(()=>({basename:l,navigator:o,static:s,future:Xv({v7_relativeSplatPath:!1},a)}),[l,a,o,s]);typeof r=="string"&&(r=Ua(r));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,m=S.useMemo(()=>{let C=yf(u,l);return C==null?null:{location:{pathname:C,search:d,hash:f,state:h,key:p},navigationType:i}},[l,u,d,f,h,p,i]);return m==null?null:S.createElement(RT.Provider,{value:c},S.createElement(h1.Provider,{children:n,value:m}))}new Promise(()=>{});function r4(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:S.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:S.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:S.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function k0(){return k0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},k0.apply(this,arguments)}const i4="6";try{window.__reactRouterVersion=i4}catch{}function o4(t,e){return wB({basename:void 0,future:k0({},void 0,{v7_prependBasename:!0}),history:Z5({window:void 0}),hydrationData:s4(),routes:t,mapRouteProperties:r4,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function s4(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=k0({},e,{errors:a4(e.errors)})),e}function a4(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new S0(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let s=new o(i.message);s.stack="",n[r]=s}catch{}}if(n[r]==null){let o=new Error(i.message);o.stack="",n[r]=o}}else n[r]=i;return n}const l4=S.createContext({isTransitioning:!1}),c4=S.createContext(new Map),u4="startTransition",vb=NP[u4],d4="flushSync",Cb=H5[d4];function f4(t){vb?vb(t):t()}function Pu(t){Cb?Cb(t):t()}class h4{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function p4(t){let{fallbackElement:e,router:n,future:r}=t,[i,o]=S.useState(n.state),[s,a]=S.useState(),[l,c]=S.useState({isTransitioning:!1}),[u,d]=S.useState(),[f,h]=S.useState(),[p,m]=S.useState(),C=S.useRef(new Map),{v7_startTransition:v}=r||{},g=S.useCallback(k=>{v?f4(k):k()},[v]),y=S.useCallback((k,D)=>{let{deletedFetchers:T,flushSync:R,viewTransitionOpts:P}=D;k.fetchers.forEach((G,H)=>{G.data!==void 0&&C.current.set(H,G.data)}),T.forEach(G=>C.current.delete(G));let M=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!P||M){R?Pu(()=>o(k)):g(()=>o(k));return}if(R){Pu(()=>{f&&(u&&u.resolve(),f.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:P.currentLocation,nextLocation:P.nextLocation})});let G=n.window.document.startViewTransition(()=>{Pu(()=>o(k))});G.finished.finally(()=>{Pu(()=>{d(void 0),h(void 0),a(void 0),c({isTransitioning:!1})})}),Pu(()=>h(G));return}f?(u&&u.resolve(),f.skipTransition(),m({state:k,currentLocation:P.currentLocation,nextLocation:P.nextLocation})):(a(k),c({isTransitioning:!0,flushSync:!1,currentLocation:P.currentLocation,nextLocation:P.nextLocation}))},[n.window,f,u,C,g]);S.useLayoutEffect(()=>n.subscribe(y),[n,y]),S.useEffect(()=>{l.isTransitioning&&!l.flushSync&&d(new h4)},[l]),S.useEffect(()=>{if(u&&s&&n.window){let k=s,D=u.promise,T=n.window.document.startViewTransition(async()=>{g(()=>o(k)),await D});T.finished.finally(()=>{d(void 0),h(void 0),a(void 0),c({isTransitioning:!1})}),h(T)}},[g,s,u,n.window]),S.useEffect(()=>{u&&s&&i.location.key===s.location.key&&u.resolve()},[u,f,i.location,s]),S.useEffect(()=>{!l.isTransitioning&&p&&(a(p.state),c({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),m(void 0))},[l.isTransitioning,p]),S.useEffect(()=>{},[]);let I=S.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:k=>n.navigate(k),push:(k,D,T)=>n.navigate(k,{state:D,preventScrollReset:T==null?void 0:T.preventScrollReset}),replace:(k,D,T)=>n.navigate(k,{replace:!0,state:D,preventScrollReset:T==null?void 0:T.preventScrollReset})}),[n]),b=n.basename||"/",E=S.useMemo(()=>({router:n,navigator:I,static:!1,basename:b}),[n,I,b]),w=S.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return S.useEffect(()=>t4(r,n.future),[r,n.future]),S.createElement(S.Fragment,null,S.createElement(ET.Provider,{value:E},S.createElement(TT.Provider,{value:i},S.createElement(c4.Provider,{value:C.current},S.createElement(l4.Provider,{value:l},S.createElement(n4,{basename:b,location:i.location,navigationType:i.historyAction,navigator:I,future:w},i.initialized||n.future.v7_partialHydration?S.createElement(g4,{routes:n.routes,future:n.future,state:i}):e))))),null)}const g4=S.memo(m4);function m4(t){let{routes:e,future:n,state:r}=t;return jB(e,void 0,r,n)}var yb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(yb||(yb={}));var xb;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(xb||(xb={}));const NT=t=>{const e=typeof t=="function",n=S.useRef(t);S.useEffect(()=>{n.current=t}),S.useEffect(()=>{if(e){const r=i=>{const o=n.current(i);if(typeof o=="string")return i.preventDefault(),i.returnValue=o;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])};var BT={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function o(l,c,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new i(u,d||l,f),p=n?n+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],h]:l._events[p].push(h):(l._events[p]=h,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,f,h,p){var m=n?n+c:c;if(!this._events[m])return!1;var C=this._events[m],v=arguments.length,g,y;if(C.fn){switch(C.once&&this.removeListener(c,C.fn,void 0,!0),v){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,u),!0;case 3:return C.fn.call(C.context,u,d),!0;case 4:return C.fn.call(C.context,u,d,f),!0;case 5:return C.fn.call(C.context,u,d,f,h),!0;case 6:return C.fn.call(C.context,u,d,f,h,p),!0}for(y=1,g=new Array(v-1);y<v;y++)g[y-1]=arguments[y];C.fn.apply(C.context,g)}else{var I=C.length,b;for(y=0;y<I;y++)switch(C[y].once&&this.removeListener(c,C[y].fn,void 0,!0),v){case 1:C[y].fn.call(C[y].context);break;case 2:C[y].fn.call(C[y].context,u);break;case 3:C[y].fn.call(C[y].context,u,d);break;case 4:C[y].fn.call(C[y].context,u,d,f);break;default:if(!g)for(b=1,g=new Array(v-1);b<v;b++)g[b-1]=arguments[b];C[y].fn.apply(C[y].context,g)}}return!0},a.prototype.on=function(c,u,d){return o(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return o(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,f){var h=n?n+c:c;if(!this._events[h])return this;if(!u)return s(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&s(this,h);else{for(var m=0,C=[],v=p.length;m<v;m++)(p[m].fn!==u||f&&!p[m].once||d&&p[m].context!==d)&&C.push(p[m]);C.length?this._events[h]=C.length===1?C[0]:C:s(this,h)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&s(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(BT);var v4=BT.exports;const Ep=eu(v4);var Rn={},Tp={};Tp.byteLength=x4;Tp.toByteArray=b4;Tp.fromByteArray=S4;var po=[],oi=[],C4=typeof Uint8Array<"u"?Uint8Array:Array,Pg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Kl=0,y4=Pg.length;Kl<y4;++Kl)po[Kl]=Pg[Kl],oi[Pg.charCodeAt(Kl)]=Kl;oi[45]=62;oi[95]=63;function FT(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function x4(t){var e=FT(t),n=e[0],r=e[1];return(n+r)*3/4-r}function I4(t,e,n){return(e+n)*3/4-n}function b4(t){var e,n=FT(t),r=n[0],i=n[1],o=new C4(I4(t,r,i)),s=0,a=i>0?r-4:r,l;for(l=0;l<a;l+=4)e=oi[t.charCodeAt(l)]<<18|oi[t.charCodeAt(l+1)]<<12|oi[t.charCodeAt(l+2)]<<6|oi[t.charCodeAt(l+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=oi[t.charCodeAt(l)]<<2|oi[t.charCodeAt(l+1)]>>4,o[s++]=e&255),i===1&&(e=oi[t.charCodeAt(l)]<<10|oi[t.charCodeAt(l+1)]<<4|oi[t.charCodeAt(l+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function A4(t){return po[t>>18&63]+po[t>>12&63]+po[t>>6&63]+po[t&63]}function w4(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(A4(r));return i.join("")}function S4(t){for(var e,n=t.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(w4(t,s,s+o>a?a:s+o));return r===1?(e=t[n-1],i.push(po[e>>2]+po[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(po[e>>10]+po[e>>4&63]+po[e<<2&63]+"=")),i.join("")}var g1={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */g1.read=function(t,e,n,r,i){var o,s,a=i*8-r-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?i-1:0,f=n?-1:1,h=t[e+d];for(d+=f,o=h&(1<<-u)-1,h>>=-u,u+=a;u>0;o=o*256+t[e+d],d+=f,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=s*256+t[e+d],d+=f,u-=8);if(o===0)o=1-c;else{if(o===l)return s?NaN:(h?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-c}return(h?-1:1)*s*Math.pow(2,o-r)};g1.write=function(t,e,n,r,i,o){var s,a,l,c=o*8-i-1,u=(1<<c)-1,d=u>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+d>=1?e+=f/l:e+=f*Math.pow(2,1-d),e*l>=2&&(s++,l/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(e*l-1)*Math.pow(2,i),s=s+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;t[n+h]=a&255,h+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+h]=s&255,h+=p,s/=256,c-=8);t[n+h-p]|=m*128};(function(t){const e=Tp,n=g1,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=g,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const _=new Uint8Array(1),x={foo:function(){return 42}};return Object.setPrototypeOf(x,Uint8Array.prototype),Object.setPrototypeOf(_,x),_.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(_){if(_>i)throw new RangeError('The value "'+_+'" is invalid for option "size"');const x=new Uint8Array(_);return Object.setPrototypeOf(x,a.prototype),x}function a(_,x,A){if(typeof _=="number"){if(typeof x=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(_)}return l(_,x,A)}a.poolSize=8192;function l(_,x,A){if(typeof _=="string")return f(_,x);if(ArrayBuffer.isView(_))return p(_);if(_==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _);if(Qe(_,ArrayBuffer)||_&&Qe(_.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Qe(_,SharedArrayBuffer)||_&&Qe(_.buffer,SharedArrayBuffer)))return m(_,x,A);if(typeof _=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const B=_.valueOf&&_.valueOf();if(B!=null&&B!==_)return a.from(B,x,A);const W=C(_);if(W)return W;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof _[Symbol.toPrimitive]=="function")return a.from(_[Symbol.toPrimitive]("string"),x,A);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _)}a.from=function(_,x,A){return l(_,x,A)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(_){if(typeof _!="number")throw new TypeError('"size" argument must be of type number');if(_<0)throw new RangeError('The value "'+_+'" is invalid for option "size"')}function u(_,x,A){return c(_),_<=0?s(_):x!==void 0?typeof A=="string"?s(_).fill(x,A):s(_).fill(x):s(_)}a.alloc=function(_,x,A){return u(_,x,A)};function d(_){return c(_),s(_<0?0:v(_)|0)}a.allocUnsafe=function(_){return d(_)},a.allocUnsafeSlow=function(_){return d(_)};function f(_,x){if((typeof x!="string"||x==="")&&(x="utf8"),!a.isEncoding(x))throw new TypeError("Unknown encoding: "+x);const A=y(_,x)|0;let B=s(A);const W=B.write(_,x);return W!==A&&(B=B.slice(0,W)),B}function h(_){const x=_.length<0?0:v(_.length)|0,A=s(x);for(let B=0;B<x;B+=1)A[B]=_[B]&255;return A}function p(_){if(Qe(_,Uint8Array)){const x=new Uint8Array(_);return m(x.buffer,x.byteOffset,x.byteLength)}return h(_)}function m(_,x,A){if(x<0||_.byteLength<x)throw new RangeError('"offset" is outside of buffer bounds');if(_.byteLength<x+(A||0))throw new RangeError('"length" is outside of buffer bounds');let B;return x===void 0&&A===void 0?B=new Uint8Array(_):A===void 0?B=new Uint8Array(_,x):B=new Uint8Array(_,x,A),Object.setPrototypeOf(B,a.prototype),B}function C(_){if(a.isBuffer(_)){const x=v(_.length)|0,A=s(x);return A.length===0||_.copy(A,0,0,x),A}if(_.length!==void 0)return typeof _.length!="number"||Gt(_.length)?s(0):h(_);if(_.type==="Buffer"&&Array.isArray(_.data))return h(_.data)}function v(_){if(_>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return _|0}function g(_){return+_!=_&&(_=0),a.alloc(+_)}a.isBuffer=function(x){return x!=null&&x._isBuffer===!0&&x!==a.prototype},a.compare=function(x,A){if(Qe(x,Uint8Array)&&(x=a.from(x,x.offset,x.byteLength)),Qe(A,Uint8Array)&&(A=a.from(A,A.offset,A.byteLength)),!a.isBuffer(x)||!a.isBuffer(A))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(x===A)return 0;let B=x.length,W=A.length;for(let Y=0,te=Math.min(B,W);Y<te;++Y)if(x[Y]!==A[Y]){B=x[Y],W=A[Y];break}return B<W?-1:W<B?1:0},a.isEncoding=function(x){switch(String(x).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(x,A){if(!Array.isArray(x))throw new TypeError('"list" argument must be an Array of Buffers');if(x.length===0)return a.alloc(0);let B;if(A===void 0)for(A=0,B=0;B<x.length;++B)A+=x[B].length;const W=a.allocUnsafe(A);let Y=0;for(B=0;B<x.length;++B){let te=x[B];if(Qe(te,Uint8Array))Y+te.length>W.length?(a.isBuffer(te)||(te=a.from(te)),te.copy(W,Y)):Uint8Array.prototype.set.call(W,te,Y);else if(a.isBuffer(te))te.copy(W,Y);else throw new TypeError('"list" argument must be an Array of Buffers');Y+=te.length}return W};function y(_,x){if(a.isBuffer(_))return _.length;if(ArrayBuffer.isView(_)||Qe(_,ArrayBuffer))return _.byteLength;if(typeof _!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof _);const A=_.length,B=arguments.length>2&&arguments[2]===!0;if(!B&&A===0)return 0;let W=!1;for(;;)switch(x){case"ascii":case"latin1":case"binary":return A;case"utf8":case"utf-8":return Ue(_).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A*2;case"hex":return A>>>1;case"base64":return $e(_).length;default:if(W)return B?-1:Ue(_).length;x=(""+x).toLowerCase(),W=!0}}a.byteLength=y;function I(_,x,A){let B=!1;if((x===void 0||x<0)&&(x=0),x>this.length||((A===void 0||A>this.length)&&(A=this.length),A<=0)||(A>>>=0,x>>>=0,A<=x))return"";for(_||(_="utf8");;)switch(_){case"hex":return Q(this,x,A);case"utf8":case"utf-8":return G(this,x,A);case"ascii":return ie(this,x,A);case"latin1":case"binary":return Z(this,x,A);case"base64":return M(this,x,A);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne(this,x,A);default:if(B)throw new TypeError("Unknown encoding: "+_);_=(_+"").toLowerCase(),B=!0}}a.prototype._isBuffer=!0;function b(_,x,A){const B=_[x];_[x]=_[A],_[A]=B}a.prototype.swap16=function(){const x=this.length;if(x%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let A=0;A<x;A+=2)b(this,A,A+1);return this},a.prototype.swap32=function(){const x=this.length;if(x%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let A=0;A<x;A+=4)b(this,A,A+3),b(this,A+1,A+2);return this},a.prototype.swap64=function(){const x=this.length;if(x%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let A=0;A<x;A+=8)b(this,A,A+7),b(this,A+1,A+6),b(this,A+2,A+5),b(this,A+3,A+4);return this},a.prototype.toString=function(){const x=this.length;return x===0?"":arguments.length===0?G(this,0,x):I.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(x){if(!a.isBuffer(x))throw new TypeError("Argument must be a Buffer");return this===x?!0:a.compare(this,x)===0},a.prototype.inspect=function(){let x="";const A=t.INSPECT_MAX_BYTES;return x=this.toString("hex",0,A).replace(/(.{2})/g,"$1 ").trim(),this.length>A&&(x+=" ... "),"<Buffer "+x+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(x,A,B,W,Y){if(Qe(x,Uint8Array)&&(x=a.from(x,x.offset,x.byteLength)),!a.isBuffer(x))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof x);if(A===void 0&&(A=0),B===void 0&&(B=x?x.length:0),W===void 0&&(W=0),Y===void 0&&(Y=this.length),A<0||B>x.length||W<0||Y>this.length)throw new RangeError("out of range index");if(W>=Y&&A>=B)return 0;if(W>=Y)return-1;if(A>=B)return 1;if(A>>>=0,B>>>=0,W>>>=0,Y>>>=0,this===x)return 0;let te=Y-W,Ne=B-A;const tt=Math.min(te,Ne),lt=this.slice(W,Y),ht=x.slice(A,B);for(let nt=0;nt<tt;++nt)if(lt[nt]!==ht[nt]){te=lt[nt],Ne=ht[nt];break}return te<Ne?-1:Ne<te?1:0};function E(_,x,A,B,W){if(_.length===0)return-1;if(typeof A=="string"?(B=A,A=0):A>2147483647?A=2147483647:A<-2147483648&&(A=-2147483648),A=+A,Gt(A)&&(A=W?0:_.length-1),A<0&&(A=_.length+A),A>=_.length){if(W)return-1;A=_.length-1}else if(A<0)if(W)A=0;else return-1;if(typeof x=="string"&&(x=a.from(x,B)),a.isBuffer(x))return x.length===0?-1:w(_,x,A,B,W);if(typeof x=="number")return x=x&255,typeof Uint8Array.prototype.indexOf=="function"?W?Uint8Array.prototype.indexOf.call(_,x,A):Uint8Array.prototype.lastIndexOf.call(_,x,A):w(_,[x],A,B,W);throw new TypeError("val must be string, number or Buffer")}function w(_,x,A,B,W){let Y=1,te=_.length,Ne=x.length;if(B!==void 0&&(B=String(B).toLowerCase(),B==="ucs2"||B==="ucs-2"||B==="utf16le"||B==="utf-16le")){if(_.length<2||x.length<2)return-1;Y=2,te/=2,Ne/=2,A/=2}function tt(ht,nt){return Y===1?ht[nt]:ht.readUInt16BE(nt*Y)}let lt;if(W){let ht=-1;for(lt=A;lt<te;lt++)if(tt(_,lt)===tt(x,ht===-1?0:lt-ht)){if(ht===-1&&(ht=lt),lt-ht+1===Ne)return ht*Y}else ht!==-1&&(lt-=lt-ht),ht=-1}else for(A+Ne>te&&(A=te-Ne),lt=A;lt>=0;lt--){let ht=!0;for(let nt=0;nt<Ne;nt++)if(tt(_,lt+nt)!==tt(x,nt)){ht=!1;break}if(ht)return lt}return-1}a.prototype.includes=function(x,A,B){return this.indexOf(x,A,B)!==-1},a.prototype.indexOf=function(x,A,B){return E(this,x,A,B,!0)},a.prototype.lastIndexOf=function(x,A,B){return E(this,x,A,B,!1)};function k(_,x,A,B){A=Number(A)||0;const W=_.length-A;B?(B=Number(B),B>W&&(B=W)):B=W;const Y=x.length;B>Y/2&&(B=Y/2);let te;for(te=0;te<B;++te){const Ne=parseInt(x.substr(te*2,2),16);if(Gt(Ne))return te;_[A+te]=Ne}return te}function D(_,x,A,B){return st(Ue(x,_.length-A),_,A,B)}function T(_,x,A,B){return st(Le(x),_,A,B)}function R(_,x,A,B){return st($e(x),_,A,B)}function P(_,x,A,B){return st(Pe(x,_.length-A),_,A,B)}a.prototype.write=function(x,A,B,W){if(A===void 0)W="utf8",B=this.length,A=0;else if(B===void 0&&typeof A=="string")W=A,B=this.length,A=0;else if(isFinite(A))A=A>>>0,isFinite(B)?(B=B>>>0,W===void 0&&(W="utf8")):(W=B,B=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Y=this.length-A;if((B===void 0||B>Y)&&(B=Y),x.length>0&&(B<0||A<0)||A>this.length)throw new RangeError("Attempt to write outside buffer bounds");W||(W="utf8");let te=!1;for(;;)switch(W){case"hex":return k(this,x,A,B);case"utf8":case"utf-8":return D(this,x,A,B);case"ascii":case"latin1":case"binary":return T(this,x,A,B);case"base64":return R(this,x,A,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,x,A,B);default:if(te)throw new TypeError("Unknown encoding: "+W);W=(""+W).toLowerCase(),te=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function M(_,x,A){return x===0&&A===_.length?e.fromByteArray(_):e.fromByteArray(_.slice(x,A))}function G(_,x,A){A=Math.min(_.length,A);const B=[];let W=x;for(;W<A;){const Y=_[W];let te=null,Ne=Y>239?4:Y>223?3:Y>191?2:1;if(W+Ne<=A){let tt,lt,ht,nt;switch(Ne){case 1:Y<128&&(te=Y);break;case 2:tt=_[W+1],(tt&192)===128&&(nt=(Y&31)<<6|tt&63,nt>127&&(te=nt));break;case 3:tt=_[W+1],lt=_[W+2],(tt&192)===128&&(lt&192)===128&&(nt=(Y&15)<<12|(tt&63)<<6|lt&63,nt>2047&&(nt<55296||nt>57343)&&(te=nt));break;case 4:tt=_[W+1],lt=_[W+2],ht=_[W+3],(tt&192)===128&&(lt&192)===128&&(ht&192)===128&&(nt=(Y&15)<<18|(tt&63)<<12|(lt&63)<<6|ht&63,nt>65535&&nt<1114112&&(te=nt))}}te===null?(te=65533,Ne=1):te>65535&&(te-=65536,B.push(te>>>10&1023|55296),te=56320|te&1023),B.push(te),W+=Ne}return q(B)}const H=4096;function q(_){const x=_.length;if(x<=H)return String.fromCharCode.apply(String,_);let A="",B=0;for(;B<x;)A+=String.fromCharCode.apply(String,_.slice(B,B+=H));return A}function ie(_,x,A){let B="";A=Math.min(_.length,A);for(let W=x;W<A;++W)B+=String.fromCharCode(_[W]&127);return B}function Z(_,x,A){let B="";A=Math.min(_.length,A);for(let W=x;W<A;++W)B+=String.fromCharCode(_[W]);return B}function Q(_,x,A){const B=_.length;(!x||x<0)&&(x=0),(!A||A<0||A>B)&&(A=B);let W="";for(let Y=x;Y<A;++Y)W+=Wt[_[Y]];return W}function ne(_,x,A){const B=_.slice(x,A);let W="";for(let Y=0;Y<B.length-1;Y+=2)W+=String.fromCharCode(B[Y]+B[Y+1]*256);return W}a.prototype.slice=function(x,A){const B=this.length;x=~~x,A=A===void 0?B:~~A,x<0?(x+=B,x<0&&(x=0)):x>B&&(x=B),A<0?(A+=B,A<0&&(A=0)):A>B&&(A=B),A<x&&(A=x);const W=this.subarray(x,A);return Object.setPrototypeOf(W,a.prototype),W};function F(_,x,A){if(_%1!==0||_<0)throw new RangeError("offset is not uint");if(_+x>A)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(x,A,B){x=x>>>0,A=A>>>0,B||F(x,A,this.length);let W=this[x],Y=1,te=0;for(;++te<A&&(Y*=256);)W+=this[x+te]*Y;return W},a.prototype.readUintBE=a.prototype.readUIntBE=function(x,A,B){x=x>>>0,A=A>>>0,B||F(x,A,this.length);let W=this[x+--A],Y=1;for(;A>0&&(Y*=256);)W+=this[x+--A]*Y;return W},a.prototype.readUint8=a.prototype.readUInt8=function(x,A){return x=x>>>0,A||F(x,1,this.length),this[x]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(x,A){return x=x>>>0,A||F(x,2,this.length),this[x]|this[x+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(x,A){return x=x>>>0,A||F(x,2,this.length),this[x]<<8|this[x+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(x,A){return x=x>>>0,A||F(x,4,this.length),(this[x]|this[x+1]<<8|this[x+2]<<16)+this[x+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(x,A){return x=x>>>0,A||F(x,4,this.length),this[x]*16777216+(this[x+1]<<16|this[x+2]<<8|this[x+3])},a.prototype.readBigUInt64LE=wt(function(x){x=x>>>0,at(x,"offset");const A=this[x],B=this[x+7];(A===void 0||B===void 0)&&ot(x,this.length-8);const W=A+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24,Y=this[++x]+this[++x]*2**8+this[++x]*2**16+B*2**24;return BigInt(W)+(BigInt(Y)<<BigInt(32))}),a.prototype.readBigUInt64BE=wt(function(x){x=x>>>0,at(x,"offset");const A=this[x],B=this[x+7];(A===void 0||B===void 0)&&ot(x,this.length-8);const W=A*2**24+this[++x]*2**16+this[++x]*2**8+this[++x],Y=this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+B;return(BigInt(W)<<BigInt(32))+BigInt(Y)}),a.prototype.readIntLE=function(x,A,B){x=x>>>0,A=A>>>0,B||F(x,A,this.length);let W=this[x],Y=1,te=0;for(;++te<A&&(Y*=256);)W+=this[x+te]*Y;return Y*=128,W>=Y&&(W-=Math.pow(2,8*A)),W},a.prototype.readIntBE=function(x,A,B){x=x>>>0,A=A>>>0,B||F(x,A,this.length);let W=A,Y=1,te=this[x+--W];for(;W>0&&(Y*=256);)te+=this[x+--W]*Y;return Y*=128,te>=Y&&(te-=Math.pow(2,8*A)),te},a.prototype.readInt8=function(x,A){return x=x>>>0,A||F(x,1,this.length),this[x]&128?(255-this[x]+1)*-1:this[x]},a.prototype.readInt16LE=function(x,A){x=x>>>0,A||F(x,2,this.length);const B=this[x]|this[x+1]<<8;return B&32768?B|4294901760:B},a.prototype.readInt16BE=function(x,A){x=x>>>0,A||F(x,2,this.length);const B=this[x+1]|this[x]<<8;return B&32768?B|4294901760:B},a.prototype.readInt32LE=function(x,A){return x=x>>>0,A||F(x,4,this.length),this[x]|this[x+1]<<8|this[x+2]<<16|this[x+3]<<24},a.prototype.readInt32BE=function(x,A){return x=x>>>0,A||F(x,4,this.length),this[x]<<24|this[x+1]<<16|this[x+2]<<8|this[x+3]},a.prototype.readBigInt64LE=wt(function(x){x=x>>>0,at(x,"offset");const A=this[x],B=this[x+7];(A===void 0||B===void 0)&&ot(x,this.length-8);const W=this[x+4]+this[x+5]*2**8+this[x+6]*2**16+(B<<24);return(BigInt(W)<<BigInt(32))+BigInt(A+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24)}),a.prototype.readBigInt64BE=wt(function(x){x=x>>>0,at(x,"offset");const A=this[x],B=this[x+7];(A===void 0||B===void 0)&&ot(x,this.length-8);const W=(A<<24)+this[++x]*2**16+this[++x]*2**8+this[++x];return(BigInt(W)<<BigInt(32))+BigInt(this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+B)}),a.prototype.readFloatLE=function(x,A){return x=x>>>0,A||F(x,4,this.length),n.read(this,x,!0,23,4)},a.prototype.readFloatBE=function(x,A){return x=x>>>0,A||F(x,4,this.length),n.read(this,x,!1,23,4)},a.prototype.readDoubleLE=function(x,A){return x=x>>>0,A||F(x,8,this.length),n.read(this,x,!0,52,8)},a.prototype.readDoubleBE=function(x,A){return x=x>>>0,A||F(x,8,this.length),n.read(this,x,!1,52,8)};function z(_,x,A,B,W,Y){if(!a.isBuffer(_))throw new TypeError('"buffer" argument must be a Buffer instance');if(x>W||x<Y)throw new RangeError('"value" argument is out of bounds');if(A+B>_.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(x,A,B,W){if(x=+x,A=A>>>0,B=B>>>0,!W){const Ne=Math.pow(2,8*B)-1;z(this,x,A,B,Ne,0)}let Y=1,te=0;for(this[A]=x&255;++te<B&&(Y*=256);)this[A+te]=x/Y&255;return A+B},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(x,A,B,W){if(x=+x,A=A>>>0,B=B>>>0,!W){const Ne=Math.pow(2,8*B)-1;z(this,x,A,B,Ne,0)}let Y=B-1,te=1;for(this[A+Y]=x&255;--Y>=0&&(te*=256);)this[A+Y]=x/te&255;return A+B},a.prototype.writeUint8=a.prototype.writeUInt8=function(x,A,B){return x=+x,A=A>>>0,B||z(this,x,A,1,255,0),this[A]=x&255,A+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(x,A,B){return x=+x,A=A>>>0,B||z(this,x,A,2,65535,0),this[A]=x&255,this[A+1]=x>>>8,A+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(x,A,B){return x=+x,A=A>>>0,B||z(this,x,A,2,65535,0),this[A]=x>>>8,this[A+1]=x&255,A+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(x,A,B){return x=+x,A=A>>>0,B||z(this,x,A,4,4294967295,0),this[A+3]=x>>>24,this[A+2]=x>>>16,this[A+1]=x>>>8,this[A]=x&255,A+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(x,A,B){return x=+x,A=A>>>0,B||z(this,x,A,4,4294967295,0),this[A]=x>>>24,this[A+1]=x>>>16,this[A+2]=x>>>8,this[A+3]=x&255,A+4};function J(_,x,A,B,W){ze(x,B,W,_,A,7);let Y=Number(x&BigInt(4294967295));_[A++]=Y,Y=Y>>8,_[A++]=Y,Y=Y>>8,_[A++]=Y,Y=Y>>8,_[A++]=Y;let te=Number(x>>BigInt(32)&BigInt(4294967295));return _[A++]=te,te=te>>8,_[A++]=te,te=te>>8,_[A++]=te,te=te>>8,_[A++]=te,A}function ee(_,x,A,B,W){ze(x,B,W,_,A,7);let Y=Number(x&BigInt(4294967295));_[A+7]=Y,Y=Y>>8,_[A+6]=Y,Y=Y>>8,_[A+5]=Y,Y=Y>>8,_[A+4]=Y;let te=Number(x>>BigInt(32)&BigInt(4294967295));return _[A+3]=te,te=te>>8,_[A+2]=te,te=te>>8,_[A+1]=te,te=te>>8,_[A]=te,A+8}a.prototype.writeBigUInt64LE=wt(function(x,A=0){return J(this,x,A,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=wt(function(x,A=0){return ee(this,x,A,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(x,A,B,W){if(x=+x,A=A>>>0,!W){const tt=Math.pow(2,8*B-1);z(this,x,A,B,tt-1,-tt)}let Y=0,te=1,Ne=0;for(this[A]=x&255;++Y<B&&(te*=256);)x<0&&Ne===0&&this[A+Y-1]!==0&&(Ne=1),this[A+Y]=(x/te>>0)-Ne&255;return A+B},a.prototype.writeIntBE=function(x,A,B,W){if(x=+x,A=A>>>0,!W){const tt=Math.pow(2,8*B-1);z(this,x,A,B,tt-1,-tt)}let Y=B-1,te=1,Ne=0;for(this[A+Y]=x&255;--Y>=0&&(te*=256);)x<0&&Ne===0&&this[A+Y+1]!==0&&(Ne=1),this[A+Y]=(x/te>>0)-Ne&255;return A+B},a.prototype.writeInt8=function(x,A,B){return x=+x,A=A>>>0,B||z(this,x,A,1,127,-128),x<0&&(x=255+x+1),this[A]=x&255,A+1},a.prototype.writeInt16LE=function(x,A,B){return x=+x,A=A>>>0,B||z(this,x,A,2,32767,-32768),this[A]=x&255,this[A+1]=x>>>8,A+2},a.prototype.writeInt16BE=function(x,A,B){return x=+x,A=A>>>0,B||z(this,x,A,2,32767,-32768),this[A]=x>>>8,this[A+1]=x&255,A+2},a.prototype.writeInt32LE=function(x,A,B){return x=+x,A=A>>>0,B||z(this,x,A,4,2147483647,-2147483648),this[A]=x&255,this[A+1]=x>>>8,this[A+2]=x>>>16,this[A+3]=x>>>24,A+4},a.prototype.writeInt32BE=function(x,A,B){return x=+x,A=A>>>0,B||z(this,x,A,4,2147483647,-2147483648),x<0&&(x=4294967295+x+1),this[A]=x>>>24,this[A+1]=x>>>16,this[A+2]=x>>>8,this[A+3]=x&255,A+4},a.prototype.writeBigInt64LE=wt(function(x,A=0){return J(this,x,A,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=wt(function(x,A=0){return ee(this,x,A,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function se(_,x,A,B,W,Y){if(A+B>_.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("Index out of range")}function me(_,x,A,B,W){return x=+x,A=A>>>0,W||se(_,x,A,4),n.write(_,x,A,B,23,4),A+4}a.prototype.writeFloatLE=function(x,A,B){return me(this,x,A,!0,B)},a.prototype.writeFloatBE=function(x,A,B){return me(this,x,A,!1,B)};function Be(_,x,A,B,W){return x=+x,A=A>>>0,W||se(_,x,A,8),n.write(_,x,A,B,52,8),A+8}a.prototype.writeDoubleLE=function(x,A,B){return Be(this,x,A,!0,B)},a.prototype.writeDoubleBE=function(x,A,B){return Be(this,x,A,!1,B)},a.prototype.copy=function(x,A,B,W){if(!a.isBuffer(x))throw new TypeError("argument should be a Buffer");if(B||(B=0),!W&&W!==0&&(W=this.length),A>=x.length&&(A=x.length),A||(A=0),W>0&&W<B&&(W=B),W===B||x.length===0||this.length===0)return 0;if(A<0)throw new RangeError("targetStart out of bounds");if(B<0||B>=this.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("sourceEnd out of bounds");W>this.length&&(W=this.length),x.length-A<W-B&&(W=x.length-A+B);const Y=W-B;return this===x&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(A,B,W):Uint8Array.prototype.set.call(x,this.subarray(B,W),A),Y},a.prototype.fill=function(x,A,B,W){if(typeof x=="string"){if(typeof A=="string"?(W=A,A=0,B=this.length):typeof B=="string"&&(W=B,B=this.length),W!==void 0&&typeof W!="string")throw new TypeError("encoding must be a string");if(typeof W=="string"&&!a.isEncoding(W))throw new TypeError("Unknown encoding: "+W);if(x.length===1){const te=x.charCodeAt(0);(W==="utf8"&&te<128||W==="latin1")&&(x=te)}}else typeof x=="number"?x=x&255:typeof x=="boolean"&&(x=Number(x));if(A<0||this.length<A||this.length<B)throw new RangeError("Out of range index");if(B<=A)return this;A=A>>>0,B=B===void 0?this.length:B>>>0,x||(x=0);let Y;if(typeof x=="number")for(Y=A;Y<B;++Y)this[Y]=x;else{const te=a.isBuffer(x)?x:a.from(x,W),Ne=te.length;if(Ne===0)throw new TypeError('The value "'+x+'" is invalid for argument "value"');for(Y=0;Y<B-A;++Y)this[Y+A]=te[Y%Ne]}return this};const ae={};function Pt(_,x,A){ae[_]=class extends A{constructor(){super(),Object.defineProperty(this,"message",{value:x.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${_}]`,this.stack,delete this.name}get code(){return _}set code(W){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:W,writable:!0})}toString(){return`${this.name} [${_}]: ${this.message}`}}}Pt("ERR_BUFFER_OUT_OF_BOUNDS",function(_){return _?`${_} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Pt("ERR_INVALID_ARG_TYPE",function(_,x){return`The "${_}" argument must be of type number. Received type ${typeof x}`},TypeError),Pt("ERR_OUT_OF_RANGE",function(_,x,A){let B=`The value of "${_}" is out of range.`,W=A;return Number.isInteger(A)&&Math.abs(A)>2**32?W=Vt(String(A)):typeof A=="bigint"&&(W=String(A),(A>BigInt(2)**BigInt(32)||A<-(BigInt(2)**BigInt(32)))&&(W=Vt(W)),W+="n"),B+=` It must be ${x}. Received ${W}`,B},RangeError);function Vt(_){let x="",A=_.length;const B=_[0]==="-"?1:0;for(;A>=B+4;A-=3)x=`_${_.slice(A-3,A)}${x}`;return`${_.slice(0,A)}${x}`}function dn(_,x,A){at(x,"offset"),(_[x]===void 0||_[x+A]===void 0)&&ot(x,_.length-(A+1))}function ze(_,x,A,B,W,Y){if(_>A||_<x){const te=typeof x=="bigint"?"n":"";let Ne;throw x===0||x===BigInt(0)?Ne=`>= 0${te} and < 2${te} ** ${(Y+1)*8}${te}`:Ne=`>= -(2${te} ** ${(Y+1)*8-1}${te}) and < 2 ** ${(Y+1)*8-1}${te}`,new ae.ERR_OUT_OF_RANGE("value",Ne,_)}dn(B,W,Y)}function at(_,x){if(typeof _!="number")throw new ae.ERR_INVALID_ARG_TYPE(x,"number",_)}function ot(_,x,A){throw Math.floor(_)!==_?(at(_,A),new ae.ERR_OUT_OF_RANGE("offset","an integer",_)):x<0?new ae.ERR_BUFFER_OUT_OF_BOUNDS:new ae.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${x}`,_)}const he=/[^+/0-9A-Za-z-_]/g;function Ce(_){if(_=_.split("=")[0],_=_.trim().replace(he,""),_.length<2)return"";for(;_.length%4!==0;)_=_+"=";return _}function Ue(_,x){x=x||1/0;let A;const B=_.length;let W=null;const Y=[];for(let te=0;te<B;++te){if(A=_.charCodeAt(te),A>55295&&A<57344){if(!W){if(A>56319){(x-=3)>-1&&Y.push(239,191,189);continue}else if(te+1===B){(x-=3)>-1&&Y.push(239,191,189);continue}W=A;continue}if(A<56320){(x-=3)>-1&&Y.push(239,191,189),W=A;continue}A=(W-55296<<10|A-56320)+65536}else W&&(x-=3)>-1&&Y.push(239,191,189);if(W=null,A<128){if((x-=1)<0)break;Y.push(A)}else if(A<2048){if((x-=2)<0)break;Y.push(A>>6|192,A&63|128)}else if(A<65536){if((x-=3)<0)break;Y.push(A>>12|224,A>>6&63|128,A&63|128)}else if(A<1114112){if((x-=4)<0)break;Y.push(A>>18|240,A>>12&63|128,A>>6&63|128,A&63|128)}else throw new Error("Invalid code point")}return Y}function Le(_){const x=[];for(let A=0;A<_.length;++A)x.push(_.charCodeAt(A)&255);return x}function Pe(_,x){let A,B,W;const Y=[];for(let te=0;te<_.length&&!((x-=2)<0);++te)A=_.charCodeAt(te),B=A>>8,W=A%256,Y.push(W),Y.push(B);return Y}function $e(_){return e.toByteArray(Ce(_))}function st(_,x,A,B){let W;for(W=0;W<B&&!(W+A>=x.length||W>=_.length);++W)x[W+A]=_[W];return W}function Qe(_,x){return _ instanceof x||_!=null&&_.constructor!=null&&_.constructor.name!=null&&_.constructor.name===x.name}function Gt(_){return _!==_}const Wt=function(){const _="0123456789abcdef",x=new Array(256);for(let A=0;A<16;++A){const B=A*16;for(let W=0;W<16;++W)x[B+W]=_[A]+_[W]}return x}();function wt(_){return typeof BigInt>"u"?on:_}function on(){throw new Error("BigInt not supported")}})(Rn);var qu=(t=>(t[t.BINARY=0]="BINARY",t[t.ECHO=1]="ECHO",t[t.RCP=2]="RCP",t[t.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",t[t.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",t[t.STATUS=5]="STATUS",t[t.TIMING_MARK=6]="TIMING_MARK",t[t.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",t[t.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",t[t.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",t[t.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",t[t.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",t[t.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",t[t.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",t[t.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",t[t.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",t[t.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",t[t.EXTENDED_ASCII=17]="EXTENDED_ASCII",t[t.LOGOUT=18]="LOGOUT",t[t.BYTE_MACRO=19]="BYTE_MACRO",t[t.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",t[t.SUPDUP=21]="SUPDUP",t[t.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",t[t.SEND_LOCATION=23]="SEND_LOCATION",t[t.TERMINAL_TYPE=24]="TERMINAL_TYPE",t[t.END_OF_RECORD=25]="END_OF_RECORD",t[t.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",t[t.OUTPUT_MARKING=27]="OUTPUT_MARKING",t[t.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",t[t.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",t[t.X_3_PAD=30]="X_3_PAD",t[t.NAWS=31]="NAWS",t[t.TERMINAL_SPEED=32]="TERMINAL_SPEED",t[t.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",t[t.LINEMODE=34]="LINEMODE",t[t.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",t[t.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",t[t.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",t[t.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",t[t.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",t[t.TN3270E=40]="TN3270E",t[t.XAUTH=41]="XAUTH",t[t.CHARSET=42]="CHARSET",t[t.RSP=43]="RSP",t[t.COM_PORT_OPTION=44]="COM_PORT_OPTION",t[t.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",t[t.START_TLS=46]="START_TLS",t[t.KERMIT=47]="KERMIT",t[t.SEND_URL=48]="SEND_URL",t[t.FORWARD_X=49]="FORWARD_X",t[t.PRAGMA_LOGON=138]="PRAGMA_LOGON",t[t.GMCP=201]="GMCP",t))(qu||{}),Qu=(t=>(t[t.SE=240]="SE",t[t.NOP=241]="NOP",t[t.DM=242]="DM",t[t.BRK=243]="BRK",t[t.IP=244]="IP",t[t.AO=245]="AO",t[t.AYT=246]="AYT",t[t.EC=247]="EC",t[t.EL=248]="EL",t[t.GA=249]="GA",t[t.SB=250]="SB",t[t.WILL=251]="WILL",t[t.WONT=252]="WONT",t[t.DO=253]="DO",t[t.DONT=254]="DONT",t[t.IAC=255]="IAC",t))(Qu||{});class k4{constructor(e){L(this,"ws");this.ws=e}on(e,n){if(e==="data"){this.ws.onmessage=i=>{n(i.data)};return}const r="on"+e;this[r]=n}write(e){this.ws.send(e)}}class E4 extends Ep{constructor(n){super();L(this,"state");L(this,"buffer");L(this,"subBuffer");L(this,"iacSEBuffer",Rn.Buffer.from([255,240]));L(this,"negotiationByte",0);L(this,"stream");this.state=0,this.buffer=Rn.Buffer.alloc(0),this.subBuffer=Rn.Buffer.alloc(0),n&&n.on("data",r=>this.parse(r)),this.stream=n}parse(n){for(this.buffer=Rn.Buffer.concat([this.buffer,Rn.Buffer.from(n)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const n=this.buffer.indexOf(255);if(n===-1){this.emit("data",this.buffer),this.buffer=Rn.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,n)),this.buffer=this.buffer.slice(n),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const n=this.buffer[1];switch(this.buffer=this.buffer.slice(2),n){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=Rn.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=n,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const n=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",n,r),this.state=0,!1}handleSubnegotiation(){let n=this.buffer.indexOf(this.iacSEBuffer);if(n===-1)return!0;this.state=0;let r=this.buffer.slice(0,n);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(n+2),!1}handleGmcp(n){const r=n.toString(),[i,o]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,o)}sendNegotiation(n,r){this.stream.write(Rn.Buffer.from([255,n,r]))}sendGmcp(n,r){const i=n+" "+r,o=Rn.Buffer.from(i),s=Rn.Buffer.concat([Rn.Buffer.from([255,250]),Rn.Buffer.from([201]),o,this.iacSEBuffer]);this.stream.write(s)}sendTerminalType(n){const r=Rn.Buffer.from(n),i=Rn.Buffer.concat([Rn.Buffer.from([255,250]),Rn.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}function T4({onlyFirst:t=!1}={}){const n=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(n,t?void 0:"g")}const R4=T4();function _4(t){if(typeof t!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof t}\``);return t.replace(R4,"")}class D4{constructor(e){L(this,"editors");L(this,"channel");this.client=e,this.editors=new Map,this.channel=new BroadcastChannel("editor"),this.setupChannelListeners()}openEditorWindow(e){console.log("Opening editor window for session:",e);const n=e.reference,r=this.editors.get(n);if(r&&r.state===1&&r.window&&!r.window.closed)r.window.focus();else{const i=encodeURIComponent(n),o=window.open(`/editor?reference=${i}`,"_blank"),s={...e,window:o,state:0};this.editors.set(n,s),o&&o.focus()}}saveEditorWindow(e){const n={reference:e.reference,type:e.type,"content*":""};this.client.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",n,e.contents)}setupChannelListeners(){this.channel.onmessage=e=>{console.log("Editor window message:",e);const{type:n,id:r,session:i}=e.data;switch(n){case"ready":console.log("Editor window ready, id:",r);const o=this.editors.get(r);if(o){o.state=1;const{window:a,...l}=o;this.channel.postMessage({type:"load",session:l})}else console.error(`No session found for id: ${r}`);break;case"save":console.log("Saving editor window with session:",i),this.saveEditorWindow(i);break;case"close":console.log("Closing editor window, id:",r);const s=this.editors.get(r);s&&(s.state=2);break}}}shutdown(){console.log("Shutting down EditorManager"),this.editors.forEach((e,n)=>{try{e.state===1&&e.window&&(console.log(`Closing editor window for ${n}`),e.window.close(),this.channel.postMessage({type:"shutdown",id:n}))}catch(r){console.error(`Error closing editor window ${n}:`,r)}}),this.editors.clear(),console.log("Closing broadcast channel"),this.channel.close(),console.log("EditorManager shutdown complete")}}class eo{constructor(e){L(this,"packageName");L(this,"packageVersion",1);L(this,"client");this.client=e}sendData(e,n){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(n))}shutdown(){}}class P4 extends eo{constructor(){super(...arguments);L(this,"packageName","Auth.Autologin")}handleToken(n){localStorage.setItem("LoginRefreshToken",n)}sendLogin(){var n=localStorage.getItem("LoginRefreshToken");n&&this.sendData("Login",n)}}class N4 extends eo{constructor(){super(...arguments);L(this,"packageName","Char")}handleName(n){this.client.worldData.playerId=n.name,this.client.worldData.playerName=n.fullname,this.client.emit("statustext",`Logged in as ${n.fullname}`)}sendLogin(n,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:n,password:r}))}}class B4{constructor(){L(this,"state",{text:""});L(this,"listeners",new Set);L(this,"dispatch",e=>{const n=this.state;this.state=this.reducer(this.state,e),this.state!==n&&this.listeners.forEach(r=>r())})}reducer(e,n){switch(n.type){case"SET_INPUT":return e.text!==n.data?{...e,text:n.data}:e;case"CLEAR_INPUT":return e.text!==""?{...e,text:""}:e;default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const bc=new B4,Eh=t=>{bc.dispatch({type:"SET_INPUT",data:t})},F4=()=>{bc.dispatch({type:"CLEAR_INPUT"})};class O4 extends eo{constructor(n){super(n);L(this,"packageName","Client.Keystrokes");L(this,"bindings",[]);L(this,"boundKeyDownHandler");this.boundKeyDownHandler=this.handleKeydown.bind(this),document.addEventListener("keydown",this.boundKeyDownHandler)}handleKeydown(n){const r=this.findBinding(n);if(r){n.preventDefault();const i=bc.getState().text,o=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(o):this.placeInInputField(o)}}shutdown(){document.removeEventListener("keydown",this.boundKeyDownHandler)}findBinding(n){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==n.key.toLowerCase())return!1;const i=new Set([n.altKey&&"alt",n.ctrlKey&&"control",n.shiftKey&&"shift",n.metaKey&&"meta"].filter(Boolean)),o=new Set((r.modifiers||[]).map(s=>s.toLowerCase()));return i.size!==o.size?!1:Array.from(o).every(s=>i.has(s))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(n,r){const i=r.trim().split(/\s+/);return n.replace(/%(\d+|\*)/g,(o,s)=>{if(s==="*")return r;const a=parseInt(s,10)-1;return a>=0&&a<i.length?i[a]:o})}placeInInputField(n){Eh(n)}bindKey(n){const r={key:n.key,modifiers:n.modifiers,command:n.command,autosend:n.autosend};this.bindings.push(r)}unbindKey(n){const r=new Set((n.modifiers||[]).map(i=>i.toLowerCase()));this.bindings=this.bindings.filter(i=>{const o=new Set((i.modifiers||[]).map(a=>a.toLowerCase()));return i.key.toLowerCase()!==n.key.toLowerCase()||o.size!==r.size?!0:!Array.from(r).every(a=>o.has(a))})}unbindAll(){this.bindings=[]}handleBind(n){this.bindKey(n)}handleUnbind(n){this.unbindKey(n)}handleBind_all(n){this.bindings=n.bindings.map(r=>({...r}))}handleUnbindAll(n){console.log("Received Client.Keystrokes.UnbindAll, clearing all bindings."),this.unbindAll()}handleListBindings(n){console.log("Received Client.Keystrokes.ListBindings request, sending current bindings.");const r=this.listBindings();this.sendData("BindingsList",r)}listBindings(){return[...this.bindings]}}const Ib=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),bb=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),Kv=(t,e)=>({startTime:e,type:"setValue",value:t}),OT=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),MT=(t,e,{startTime:n,target:r,timeConstant:i})=>r+(e-r)*Math.exp((n-t)/i),hc=t=>t.type==="exponentialRampToValue",E0=t=>t.type==="linearRampToValue",sa=t=>hc(t)||E0(t),m1=t=>t.type==="setValue",Ko=t=>t.type==="setValueCurve",T0=(t,e,n,r)=>{const i=t[e];return i===void 0?r:sa(i)||m1(i)?i.value:Ko(i)?i.values[i.values.length-1]:MT(n,T0(t,e-1,i.startTime,r),i)},Ab=(t,e,n,r,i)=>n===void 0?[r.insertTime,i]:sa(n)?[n.endTime,n.value]:m1(n)?[n.startTime,n.value]:Ko(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,T0(t,e-1,n.startTime,i)],Jv=t=>t.type==="cancelAndHold",Yv=t=>t.type==="cancelScheduledValues",Xs=t=>Jv(t)||Yv(t)?t.cancelTime:hc(t)||E0(t)?t.endTime:t.startTime,wb=(t,e,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((t-e)/(r-e)):0,Sb=(t,e,n,{endTime:r,value:i})=>n+(t-e)/(r-e)*(i-n),M4=(t,e)=>{const n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},L4=(t,{duration:e,startTime:n,values:r})=>{const i=(t-n)/e*(r.length-1);return M4(r,i)},qf=t=>t.type==="setTarget";class U4{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=Xs(e);if(Jv(e)||Yv(e)){const r=this._automationEvents.findIndex(o=>Yv(e)&&Ko(o)?o.startTime+o.duration>=n:Xs(o)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Jv(e)){const o=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&sa(i)){if(o!==void 0&&qf(o))throw new Error("The internal list is malformed.");const s=o===void 0?i.insertTime:Ko(o)?o.startTime+o.duration:Xs(o),a=o===void 0?this._defaultValue:Ko(o)?o.values[o.values.length-1]:o.value,l=hc(i)?wb(n,s,a,i):Sb(n,s,a,i),c=hc(i)?Ib(l,n,this._currenTime):bb(l,n,this._currenTime);this._automationEvents.push(c)}if(o!==void 0&&qf(o)&&this._automationEvents.push(Kv(this.getValue(n),n)),o!==void 0&&Ko(o)&&o.startTime+o.duration>n){const s=n-o.startTime,a=(o.values.length-1)/o.duration,l=Math.max(2,1+Math.ceil(s*a)),c=s/(l-1)*a,u=o.values.slice(0,l);if(c<1)for(let d=1;d<l;d+=1){const f=c*d%1;u[d]=o.values[d-1]*(1-f)+o.values[d]*f}this._automationEvents[this._automationEvents.length-1]=OT(u,o.startTime,s)}}}else{const r=this._automationEvents.findIndex(s=>Xs(s)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Ko(i)&&Xs(i)+i.duration>n)return!1;const o=hc(e)?Ib(e.value,e.endTime,this._currenTime):E0(e)?bb(e.value,n,this._currenTime):e;if(r===-1)this._automationEvents.push(o);else{if(Ko(e)&&n+e.duration>Xs(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(e){const n=this._automationEvents.findIndex(r=>Xs(r)>e);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];qf(i)&&r.unshift(Kv(T0(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(s=>Xs(s)>e),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,o=this._automationEvents[i];if(o!==void 0&&qf(o)&&(r===void 0||!sa(r)||r.insertTime>e))return MT(e,T0(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(o!==void 0&&m1(o)&&(r===void 0||!sa(r)))return o.value;if(o!==void 0&&Ko(o)&&(r===void 0||!sa(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?L4(e,o):o.values[o.values.length-1];if(o!==void 0&&sa(o)&&(r===void 0||!sa(r)))return o.value;if(r!==void 0&&hc(r)){const[s,a]=Ab(this._automationEvents,i,o,r,this._defaultValue);return wb(e,s,a,r)}if(r!==void 0&&E0(r)){const[s,a]=Ab(this._automationEvents,i,o,r,this._defaultValue);return Sb(e,s,a,r)}return this._defaultValue}}const V4=t=>({cancelTime:t,type:"cancelAndHold"}),G4=t=>({cancelTime:t,type:"cancelScheduledValues"}),W4=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),z4=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),j4=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),H4=()=>new DOMException("","AbortError"),Z4=t=>(e,n,[r,i,o],s)=>{t(e[i],[n,r,o],a=>a[0]===n&&a[1]===r,s)},$4=t=>(e,n,r)=>{const i=[];for(let o=0;o<r.numberOfInputs;o+=1)i.push(new Set);t.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},X4=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},jc=new WeakSet,LT=new WeakMap,UT=new WeakMap,VT=new WeakMap,GT=new WeakMap,WT=new WeakMap,zT=new WeakMap,qv=new WeakMap,Qv=new WeakMap,eC=new WeakMap,jT={construct(){return jT}},K4=t=>{try{const e=new Proxy(t,jT);new e}catch{return!1}return!0},kb=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Eb=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),i=r.match(kb);for(;i!==null;){const o=i[1].slice(1,-1),s=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());n.push(s),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(kb)}return[n.join(";"),r]},Tb=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Rb=t=>{if(!K4(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},J4=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>{let h=0;return(p,m,C={credentials:"omit"})=>{const v=u.get(p);if(v!==void 0&&v.has(m))return Promise.resolve();const g=c.get(p);if(g!==void 0){const b=g.get(m);if(b!==void 0)return b}const y=o(p),I=y.audioWorklet===void 0?i(m).then(([b,E])=>{const[w,k]=Eb(b,E),D=`${w};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${k}
})})(window,'_AWGS')`;return n(D)}).then(()=>{const b=f._AWGS.pop();if(b===void 0)throw new SyntaxError;r(y.currentTime,y.sampleRate,()=>b(class{},void 0,(E,w)=>{if(E.trim()==="")throw e();const k=Qv.get(y);if(k!==void 0){if(k.has(E))throw e();Rb(w),Tb(w.parameterDescriptors),k.set(E,w)}else Rb(w),Tb(w.parameterDescriptors),Qv.set(y,new Map([[E,w]]))},y.sampleRate,void 0,void 0))}):Promise.all([i(m),Promise.resolve(t(d,d))]).then(([[b,E],w])=>{const k=h+1;h=k;const[D,T]=Eb(b,E),G=`${D};((AudioWorkletProcessor,registerProcessor)=>{${T}
})(${w?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${w?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${w?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${k}',class extends AudioWorkletProcessor{process(){return !1}})`,H=new Blob([G],{type:"application/javascript; charset=utf-8"}),q=URL.createObjectURL(H);return y.audioWorklet.addModule(q,C).then(()=>{if(a(y))return y;const ie=s(y);return ie.audioWorklet.addModule(q,C).then(()=>ie)}).then(ie=>{if(l===null)throw new SyntaxError;try{new l(ie,`__sac${k}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(q))});return g===void 0?c.set(p,new Map([[m,I]])):g.set(m,I),I.then(()=>{const b=u.get(p);b===void 0?u.set(p,new Set([m])):b.add(m)}).finally(()=>{const b=c.get(p);b!==void 0&&b.delete(m)}),I}},Ji=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},Rp=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return t.delete(r),r},HT=(t,e,n,r)=>{const i=Ji(t,e),o=Rp(i,s=>s[0]===n&&s[1]===r);return i.size===0&&t.delete(e),o},xf=t=>Ji(zT,t),Hc=t=>{if(jc.has(t))throw new Error("The AudioNode is already stored.");jc.add(t),xf(t).forEach(e=>e(!0))},ZT=t=>"port"in t,If=t=>{if(!jc.has(t))throw new Error("The AudioNode is not stored.");jc.delete(t),xf(t).forEach(e=>e(!1))},tC=(t,e)=>{!ZT(t)&&e.every(n=>n.size===0)&&If(t)},Y4=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>{const h=new WeakMap;return(p,m,C,v,g)=>{const{activeInputs:y,passiveInputs:I}=o(m),{outputs:b}=o(p),E=a(p),w=k=>{const D=l(m),T=l(p);if(k){const R=HT(I,p,C,v);t(y,p,R,!1),!g&&!d(p)&&n(T,D,C,v),f(m)&&Hc(m)}else{const R=r(y,p,C,v);e(I,v,R,!1),!g&&!d(p)&&i(T,D,C,v);const P=s(m);if(P===0)u(m)&&tC(m,y);else{const M=h.get(m);M!==void 0&&clearTimeout(M),h.set(m,setTimeout(()=>{u(m)&&tC(m,y)},P*1e3))}}};return c(b,[m,C,v],k=>k[0]===m&&k[1]===C&&k[2]===v,!0)?(E.add(w),u(p)?t(y,p,[C,v,w],!0):e(I,v,[p,C,w],!0),!0):!1}},q4=t=>(e,n,[r,i,o],s)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[i,n,o]])):t(a,[i,n,o],l=>l[0]===i&&l[1]===n,s)},Q4=t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},eF=t=>(e,n)=>{t(e).add(n)},tF={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},nF=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=i(a),u={...tF,...l},d=r(c,u),f=o(c)?e():null;super(a,!1,d,f),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},qn=(t,e)=>t.context===e,rF=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},nC=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Vo=()=>new DOMException("","IndexSizeError"),$T=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(r){throw r.code===12?Vo():r}})(t.getChannelData)},iF={numberOfChannels:1},oF=(t,e,n,r,i,o,s,a)=>{let l=null;return class XT{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:f,sampleRate:h}={...iF,...u};l===null&&(l=new i(1,1,44100));const p=r!==null&&e(o,o)?new r({length:d,numberOfChannels:f,sampleRate:h}):l.createBuffer(f,d,h);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(s(p),$T(p)):e(nC,()=>nC(p))||a(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===XT.prototype||t.has(u)}}},Xr=-34028234663852886e22,rr=34028234663852886e22,Ts=t=>jc.has(t),sF={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},aF=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f={...sF,...u},h=i(d,f),p=s(d),m=p?e():null;super(c,!1,h,m),this._audioBufferSourceNodeRenderer=m,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=n(this,p,h.playbackRate,rr,Xr)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(c){if(this._nativeAudioBufferSourceNode.buffer=c,c!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(c){this._nativeAudioBufferSourceNode.loop=c}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(c){this._nativeAudioBufferSourceNode.loopEnd=c}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(c){this._nativeAudioBufferSourceNode.loopStart=c}get onended(){return this._onended}set onended(c){const u=typeof c=="function"?a(this,c):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?c:d}get playbackRate(){return this._playbackRate}start(c=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(c,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[c,u]:[c,u,d]),this.context.state!=="closed"){Hc(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),Ts(this)&&If(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(c=0){this._nativeAudioBufferSourceNode.stop(c),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=c)}},lF=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const l=async(c,u)=>{let d=n(c);const f=qn(d,u);if(!f){const h={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(u,h),s!==null&&d.start(...s),a!==null&&d.stop(a)}return o.set(u,d),f?await t(u,c.playbackRate,d.playbackRate):await r(u,c.playbackRate,d.playbackRate),await i(c,u,d),d};return{set start(c){s=c},set stop(c){a=c},render(c,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):l(c,u)}}},cF=t=>"playbackRate"in t,uF=t=>"frequency"in t&&"gain"in t,dF=t=>"offset"in t,fF=t=>!("frequency"in t)&&"gain"in t,hF=t=>"detune"in t&&"frequency"in t&&!("gain"in t),pF=t=>"pan"in t,sr=t=>Ji(LT,t),bf=t=>Ji(VT,t),rC=(t,e)=>{const{activeInputs:n}=sr(t);n.forEach(i=>i.forEach(([o])=>{e.includes(t)||rC(o,[...e,t])}));const r=cF(t)?[t.playbackRate]:ZT(t)?Array.from(t.parameters.values()):uF(t)?[t.Q,t.detune,t.frequency,t.gain]:dF(t)?[t.offset]:fF(t)?[t.gain]:hF(t)?[t.detune,t.frequency]:pF(t)?[t.pan]:[];for(const i of r){const o=bf(i);o!==void 0&&o.activeInputs.forEach(([s])=>rC(s,e))}Ts(t)&&If(t)},gF=t=>{rC(t.destination,[])},mF=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),vF=(t,e,n,r,i,o,s,a,l)=>class extends t{constructor(u={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new l(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(d===null)throw r();if(!mF(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw n();super(d,2);const{latencyHint:f}=u,{sampleRate:h}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:f==="balanced"?512/h:f==="interactive"||f===void 0?256/h:f==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(f*h/128)))*128/h,this._nativeAudioContext=d,l.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",p)};d.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),gF(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(u){return new s(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},CF=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f=s(d),h=i(d,u,f),p=f?e(a):null;super(c,!1,h,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(c>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=c}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=c}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},yF=t=>{const e=new WeakMap,n=async(r,i)=>{const o=i.destination;return e.set(i,o),await t(r,i,o),o};return{render(r,i){const o=e.get(i);return o!==void 0?Promise.resolve(o):n(r,i)}}},xF=(t,e,n,r,i,o,s,a)=>(l,c)=>{const u=c.listener,d=()=>{const b=new Float32Array(1),E=e(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),w=s(c);let k=!1,D=[0,0,-1,0,1,0],T=[0,0,0];const R=()=>{if(k)return;k=!0;const H=r(c,256,9,0);H.onaudioprocess=({inputBuffer:q})=>{const ie=[o(q,b,0),o(q,b,1),o(q,b,2),o(q,b,3),o(q,b,4),o(q,b,5)];ie.some((Q,ne)=>Q!==D[ne])&&(u.setOrientation(...ie),D=ie);const Z=[o(q,b,6),o(q,b,7),o(q,b,8)];Z.some((Q,ne)=>Q!==T[ne])&&(u.setPosition(...Z),T=Z)},E.connect(H)},P=H=>q=>{q!==D[H]&&(D[H]=q,u.setOrientation(...D))},M=H=>q=>{q!==T[H]&&(T[H]=q,u.setPosition(...T))},G=(H,q,ie)=>{const Z=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:q});Z.connect(E,0,H),Z.start(),Object.defineProperty(Z.offset,"defaultValue",{get(){return q}});const Q=t({context:l},w,Z.offset,rr,Xr);return a(Q,"value",ne=>()=>ne.call(Q),ne=>F=>{try{ne.call(Q,F)}catch(z){if(z.code!==9)throw z}R(),w&&ie(F)}),Q.cancelAndHoldAtTime=(ne=>w?()=>{throw i()}:(...F)=>{const z=ne.apply(Q,F);return R(),z})(Q.cancelAndHoldAtTime),Q.cancelScheduledValues=(ne=>w?()=>{throw i()}:(...F)=>{const z=ne.apply(Q,F);return R(),z})(Q.cancelScheduledValues),Q.exponentialRampToValueAtTime=(ne=>w?()=>{throw i()}:(...F)=>{const z=ne.apply(Q,F);return R(),z})(Q.exponentialRampToValueAtTime),Q.linearRampToValueAtTime=(ne=>w?()=>{throw i()}:(...F)=>{const z=ne.apply(Q,F);return R(),z})(Q.linearRampToValueAtTime),Q.setTargetAtTime=(ne=>w?()=>{throw i()}:(...F)=>{const z=ne.apply(Q,F);return R(),z})(Q.setTargetAtTime),Q.setValueAtTime=(ne=>w?()=>{throw i()}:(...F)=>{const z=ne.apply(Q,F);return R(),z})(Q.setValueAtTime),Q.setValueCurveAtTime=(ne=>w?()=>{throw i()}:(...F)=>{const z=ne.apply(Q,F);return R(),z})(Q.setValueCurveAtTime),Q};return{forwardX:G(0,0,P(0)),forwardY:G(1,0,P(1)),forwardZ:G(2,-1,P(2)),positionX:G(6,0,M(0)),positionY:G(7,0,M(1)),positionZ:G(8,0,M(2)),upX:G(3,0,P(3)),upY:G(4,1,P(4)),upZ:G(5,0,P(5))}},{forwardX:f,forwardY:h,forwardZ:p,positionX:m,positionY:C,positionZ:v,upX:g,upY:y,upZ:I}=u.forwardX===void 0?d():u;return{get forwardX(){return f},get forwardY(){return h},get forwardZ(){return p},get positionX(){return m},get positionY(){return C},get positionZ(){return v},get upX(){return g},get upY(){return y},get upZ(){return I}}},R0=t=>"context"in t,Af=t=>R0(t[0]),Ol=(t,e,n,r)=>{for(const i of t)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},_b=(t,e,[n,r],i)=>{Ol(t,[e,n,r],o=>o[0]===e&&o[1]===n,i)},Db=(t,[e,n,r],i)=>{const o=t.get(e);o===void 0?t.set(e,new Set([[n,r]])):Ol(o,[n,r],s=>s[0]===n,i)},iu=t=>"inputs"in t,_0=(t,e,n,r)=>{if(iu(e)){const i=e.inputs[r];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,r),[e,n,r]},KT=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},IF=(t,e,n)=>Rp(t,r=>r[0]===e&&r[1]===n),JT=(t,e)=>{if(!xf(t).delete(e))throw new Error("Missing the expected event listener.")},YT=(t,e,n)=>{const r=Ji(t,e),i=Rp(r,o=>o[0]===n);return r.size===0&&t.delete(e),i},D0=(t,e,n,r)=>{iu(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},Ut=t=>Ji(UT,t),Hd=t=>Ji(GT,t),wl=t=>qv.has(t),Th=t=>!jc.has(t),Pb=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const r=t.createScriptProcessor(256,1,1),i=t.createGain(),o=t.createBuffer(1,2,44100),s=o.getChannelData(0);s[0]=1,s[1]=1;const a=t.createBufferSource();a.buffer=o,a.loop=!0,a.connect(r).connect(t.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=l=>{const c=l.inputBuffer.getChannelData(0);Array.prototype.some.call(c,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}}),Ng=(t,e)=>{const n=new Map;for(const r of t)for(const i of r){const o=n.get(i);n.set(i,o===void 0?1:o+1)}n.forEach((r,i)=>e(i,r))},P0=t=>"context"in t,bF=t=>{const e=new Map;t.connect=(n=>(r,i=0,o=0)=>{const s=P0(r)?n(r,i,o):n(r,i),a=e.get(r);return a===void 0?e.set(r,[{input:o,output:i}]):a.every(l=>l.input!==o||l.output!==i)&&a.push({input:o,output:i}),s})(t.connect.bind(t)),t.disconnect=(n=>(r,i,o)=>{if(n.apply(t),r===void 0)e.clear();else if(typeof r=="number")for(const[s,a]of e){const l=a.filter(c=>c.output!==r);l.length===0?e.delete(s):e.set(s,l)}else if(e.has(r))if(i===void 0)e.delete(r);else{const s=e.get(r);if(s!==void 0){const a=s.filter(l=>l.output!==i&&(l.input!==o||o===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[s,a]of e)a.forEach(l=>{P0(s)?t.connect(s,l.output,l.input):t.connect(s,l.output)})})(t.disconnect)},AF=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=bf(e),{outputs:s}=sr(t),a=xf(t),l=c=>{const u=Ut(t),d=Hd(e);if(c){const f=YT(o,t,n);_b(i,t,f,!1),!r&&!wl(t)&&u.connect(d,n)}else{const f=IF(i,t,n);Db(o,f,!1),!r&&!wl(t)&&u.disconnect(d,n)}};return Ol(s,[e,n],c=>c[0]===e&&c[1]===n,!0)?(a.add(l),Ts(t)?_b(i,t,[n,l],!0):Db(o,[t,n,l],!0),!0):!1},wF=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:o}=sr(e),s=KT(i[r],t,n);return s===null?[HT(o,t,n,r)[2],!1]:[s[2],!0]},SF=(t,e,n)=>{const{activeInputs:r,passiveInputs:i}=bf(e),o=KT(r,t,n);return o===null?[YT(i,t,n)[1],!1]:[o[2],!0]},v1=(t,e,n,r,i)=>{const[o,s]=wF(t,n,r,i);if(o!==null&&(JT(t,o),s&&!e&&!wl(t)&&D0(Ut(t),Ut(n),r,i)),Ts(n)){const{activeInputs:a}=sr(n);tC(n,a)}},C1=(t,e,n,r)=>{const[i,o]=SF(t,n,r);i!==null&&(JT(t,i),o&&!e&&!wl(t)&&Ut(t).disconnect(Hd(n),r))},kF=(t,e)=>{const n=sr(t),r=[];for(const i of n.outputs)Af(i)?v1(t,e,...i):C1(t,e,...i),r.push(i[0]);return n.outputs.clear(),r},EF=(t,e,n)=>{const r=sr(t),i=[];for(const o of r.outputs)o[1]===n&&(Af(o)?v1(t,e,...o):C1(t,e,...o),i.push(o[0]),r.outputs.delete(o));return i},TF=(t,e,n,r,i)=>{const o=sr(t);return Array.from(o.outputs).filter(s=>s[0]===n&&(r===void 0||s[1]===r)&&(i===void 0||s[2]===i)).map(s=>(Af(s)?v1(t,e,...s):C1(t,e,...s),o.outputs.delete(s),s[0]))},RF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,m)=>class extends c{constructor(v,g,y,I){super(y),this._context=v,this._nativeAudioNode=y;const b=u(v);d(b)&&n(Pb,()=>Pb(b,m))!==!0&&bF(y),UT.set(this,y),zT.set(this,new Set),v.state!=="closed"&&g&&Hc(this),t(this,I,y)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(v){this._nativeAudioNode.channelCount=v}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(v){this._nativeAudioNode.channelCountMode=v}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(v){this._nativeAudioNode.channelInterpretation=v}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(v,g=0,y=0){if(g<0||g>=this._nativeAudioNode.numberOfOutputs)throw i();const I=u(this._context),b=p(I);if(f(v)||h(v))throw o();if(R0(v)){const k=Ut(v);try{const T=_0(this._nativeAudioNode,k,g,y),R=Th(this);(b||R)&&this._nativeAudioNode.disconnect(...T),this.context.state!=="closed"&&!R&&Th(v)&&Hc(v)}catch(T){throw T.code===12?o():T}if(e(this,v,g,y,b)){const T=l([this],v);Ng(T,r(b))}return v}const E=Hd(v);if(E.name==="playbackRate"&&E.maxValue===1024)throw s();try{this._nativeAudioNode.connect(E,g),(b||Th(this))&&this._nativeAudioNode.disconnect(E,g)}catch(k){throw k.code===12?o():k}if(AF(this,v,g,b)){const k=l([this],v);Ng(k,r(b))}}disconnect(v,g,y){let I;const b=u(this._context),E=p(b);if(v===void 0)I=kF(this,E);else if(typeof v=="number"){if(v<0||v>=this.numberOfOutputs)throw i();I=EF(this,E,v)}else{if(g!==void 0&&(g<0||g>=this.numberOfOutputs)||R0(v)&&y!==void 0&&(y<0||y>=v.numberOfInputs))throw i();if(I=TF(this,E,v,g,y),I.length===0)throw o()}for(const w of I){const k=l([this],w);Ng(k,a)}}},_F=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>(h,p,m,C=null,v=null)=>{const g=m.value,y=new U4(g),I=p?r(y):null,b={get defaultValue(){return g},get maxValue(){return C===null?m.maxValue:C},get minValue(){return v===null?m.minValue:v},get value(){return m.value},set value(E){m.value=E,b.setValueAtTime(E,h.context.currentTime)},cancelAndHoldAtTime(E){if(typeof m.cancelAndHoldAtTime=="function")I===null&&y.flush(h.context.currentTime),y.add(i(E)),m.cancelAndHoldAtTime(E);else{const w=Array.from(y).pop();I===null&&y.flush(h.context.currentTime),y.add(i(E));const k=Array.from(y).pop();m.cancelScheduledValues(E),w!==k&&k!==void 0&&(k.type==="exponentialRampToValue"?m.exponentialRampToValueAtTime(k.value,k.endTime):k.type==="linearRampToValue"?m.linearRampToValueAtTime(k.value,k.endTime):k.type==="setValue"?m.setValueAtTime(k.value,k.startTime):k.type==="setValueCurve"&&m.setValueCurveAtTime(k.values,k.startTime,k.duration))}return b},cancelScheduledValues(E){return I===null&&y.flush(h.context.currentTime),y.add(o(E)),m.cancelScheduledValues(E),b},exponentialRampToValueAtTime(E,w){if(E===0)throw new RangeError;if(!Number.isFinite(w)||w<0)throw new RangeError;const k=h.context.currentTime;return I===null&&y.flush(k),Array.from(y).length===0&&(y.add(c(g,k)),m.setValueAtTime(g,k)),y.add(s(E,w)),m.exponentialRampToValueAtTime(E,w),b},linearRampToValueAtTime(E,w){const k=h.context.currentTime;return I===null&&y.flush(k),Array.from(y).length===0&&(y.add(c(g,k)),m.setValueAtTime(g,k)),y.add(a(E,w)),m.linearRampToValueAtTime(E,w),b},setTargetAtTime(E,w,k){return I===null&&y.flush(h.context.currentTime),y.add(l(E,w,k)),m.setTargetAtTime(E,w,k),b},setValueAtTime(E,w){return I===null&&y.flush(h.context.currentTime),y.add(c(E,w)),m.setValueAtTime(E,w),b},setValueCurveAtTime(E,w,k){const D=E instanceof Float32Array?E:new Float32Array(E);if(d!==null&&d.name==="webkitAudioContext"){const T=w+k,R=h.context.sampleRate,P=Math.ceil(w*R),M=Math.floor(T*R),G=M-P,H=new Float32Array(G);for(let ie=0;ie<G;ie+=1){const Z=(D.length-1)/k*((P+ie)/R-w),Q=Math.floor(Z),ne=Math.ceil(Z);H[ie]=Q===ne?D[Q]:(1-(Z-Q))*D[Q]+(1-(ne-Z))*D[ne]}I===null&&y.flush(h.context.currentTime),y.add(u(H,w,k)),m.setValueCurveAtTime(H,w,k);const q=M/R;q<T&&f(b,H[H.length-1],q),f(b,D[D.length-1],T)}else I===null&&y.flush(h.context.currentTime),y.add(u(D,w,k)),m.setValueCurveAtTime(D,w,k);return b}};return n.set(b,m),e.set(b,h),t(b,I),b},DF=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;e.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;e.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:o}=n;e.setTargetAtTime(i,r,o)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;e.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:o}=n;e.setValueCurveAtTime(o,i,r)}else throw new Error("Can't apply an unknown automation.")}});class qT{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((r,i)=>e.call(n,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const PF={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},NF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h)=>class extends e{constructor(m,C,v){var g;const y=a(m),I=l(y),b=u({...PF,...v});f(b);const E=Qv.get(y),w=E==null?void 0:E.get(C),k=I||y.state!=="closed"?y:(g=s(y))!==null&&g!==void 0?g:y,D=i(k,I?null:m.baseLatency,c,C,w,b),T=I?r(C,b,w):null;super(m,!0,D,T);const R=[];D.parameters.forEach((M,G)=>{const H=n(this,I,M);R.push([G,H])}),this._nativeAudioWorkletNode=D,this._onprocessorerror=null,this._parameters=new qT(R),I&&t(y,this);const{activeInputs:P}=o(this);d(D,P)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(m){const C=typeof m=="function"?h(this,m):null;this._nativeAudioWorkletNode.onprocessorerror=C;const v=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=v!==null&&v===C?m:v}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function N0(t,e,n,r,i){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],r,i);else{const o=t.getChannelData(r);if(e[n].byteLength===0)e[n]=o.slice(i,i+128);else{const s=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(s)}}}const QT=(t,e,n,r,i)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],r,i):e[n].byteLength!==0&&t.getChannelData(r).set(e[n],i)},B0=(t,e)=>{const n=[];for(let r=0;r<t;r+=1){const i=[],o=typeof e=="number"?e:e[r];for(let s=0;s<o;s+=1)i.push(new Float32Array(128));n.push(i)}return n},BF=(t,e)=>{const n=Ji(eC,t),r=Ut(e);return Ji(n,r)},FF=async(t,e,n,r,i,o,s)=>{const a=e===null?Math.ceil(t.context.length/128)*128:e.length,l=r.channelCount*r.numberOfInputs,c=i.reduce((C,v)=>C+v,0),u=c===0?null:n.createBuffer(c,a,n.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const d=sr(t),f=await BF(n,t),h=B0(r.numberOfInputs,r.channelCount),p=B0(r.numberOfOutputs,i),m=Array.from(t.parameters.keys()).reduce((C,v)=>({...C,[v]:new Float32Array(128)}),{});for(let C=0;C<a;C+=128){if(r.numberOfInputs>0&&e!==null)for(let v=0;v<r.numberOfInputs;v+=1)for(let g=0;g<r.channelCount;g+=1)N0(e,h[v],g,g,C);o.parameterDescriptors!==void 0&&e!==null&&o.parameterDescriptors.forEach(({name:v},g)=>{N0(e,m,v,l+g,C)});for(let v=0;v<r.numberOfInputs;v+=1)for(let g=0;g<i[v];g+=1)p[v][g].byteLength===0&&(p[v][g]=new Float32Array(128));try{const v=h.map((y,I)=>d.activeInputs[I].size===0?[]:y),g=s(C/n.sampleRate,n.sampleRate,()=>f.process(v,p,m));if(u!==null)for(let y=0,I=0;y<r.numberOfOutputs;y+=1){for(let b=0;b<i[y];b+=1)QT(u,p[y],b,I+b,C);I+=i[y]}if(!g)break}catch(v){t.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return u},OF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,m)=>(C,v,g)=>{const y=new WeakMap;let I=null;const b=async(E,w)=>{let k=u(E),D=null;const T=qn(k,w),R=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(d===null){const P=R.reduce((q,ie)=>q+ie,0),M=i(w,{channelCount:Math.max(1,P),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,P)}),G=[];for(let q=0;q<E.numberOfOutputs;q+=1)G.push(r(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:R[q]}));const H=s(w,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});H.connect=e.bind(null,G),H.disconnect=l.bind(null,G),D=[M,G,H]}else T||(k=new d(w,C));if(y.set(w,D===null?k:D[2]),D!==null){if(I===null){if(g===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const ie=E.channelCount*E.numberOfInputs,Z=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length,Q=ie+Z;I=FF(E,Q===0?null:await(async()=>{const F=new f(Q,Math.ceil(E.context.length/128)*128,w.sampleRate),z=[],J=[];for(let me=0;me<v.numberOfInputs;me+=1)z.push(s(F,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),J.push(i(F,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const ee=await Promise.all(Array.from(E.parameters.values()).map(async me=>{const Be=o(F,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:me.value});return await h(F,me,Be.offset),Be})),se=r(F,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,ie+Z)});for(let me=0;me<v.numberOfInputs;me+=1){z[me].connect(J[me]);for(let Be=0;Be<v.channelCount;Be+=1)J[me].connect(se,Be,me*v.channelCount+Be)}for(const[me,Be]of ee.entries())Be.connect(se,0,ie+me),Be.start(0);return se.connect(F.destination),await Promise.all(z.map(me=>p(E,F,me))),m(F)})(),w,v,R,g,c)}const P=await I,M=n(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[G,H,q]=D;P!==null&&(M.buffer=P,M.start(0)),M.connect(G);for(let ie=0,Z=0;ie<E.numberOfOutputs;ie+=1){const Q=H[ie];for(let ne=0;ne<R[ie];ne+=1)G.connect(Q,Z+ne,ne);Z+=R[ie]}return q}if(T)for(const[P,M]of E.parameters.entries())await t(w,M,k.parameters.get(P));else for(const[P,M]of E.parameters.entries())await h(w,M,k.parameters.get(P));return await p(E,w,k),k};return{render(E,w){a(w,E);const k=y.get(w);return k!==void 0?Promise.resolve(k):b(E,w)}}},MF=(t,e,n,r,i,o,s,a,l,c,u,d,f,h,p,m,C,v,g,y)=>class extends p{constructor(b,E){super(b,E),this._nativeContext=b,this._audioWorklet=t===void 0?void 0:{addModule:(w,k)=>t(this,w,k)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(b,E,w){return new n({length:E,numberOfChannels:b,sampleRate:w})}createBufferSource(){return new r(this)}createChannelMerger(b=6){return new o(this,{numberOfInputs:b})}createChannelSplitter(b=6){return new s(this,{numberOfOutputs:b})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(b=1){return new u(this,{maxDelayTime:b})}createDynamicsCompressor(){return new d(this)}createGain(){return new f(this)}createIIRFilter(b,E){return new h(this,{feedback:E,feedforward:b})}createOscillator(){return new m(this)}createPanner(){return new C(this)}createPeriodicWave(b,E,w={disableNormalization:!1}){return new v(this,{...w,imag:E,real:b})}createStereoPanner(){return new g(this)}createWaveShaper(){return new y(this)}decodeAudioData(b,E,w){return c(this._nativeContext,b).then(k=>(typeof E=="function"&&E(k),k),k=>{throw typeof w=="function"&&w(k),k})}},LF={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},UF=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f={...LF,...u},h=i(d,f),p=s(d),m=p?n():null;super(c,!1,h,m),this._Q=e(this,p,h.Q,rr,Xr),this._detune=e(this,p,h.detune,1200*Math.log2(rr),-1200*Math.log2(rr)),this._frequency=e(this,p,h.frequency,c.sampleRate/2,0),this._gain=e(this,p,h.gain,40*Math.log10(rr),Xr),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(c){this._nativeBiquadFilterNode.type=c}getFrequencyResponse(c,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(c,u,d)}catch(f){throw f.code===11?r():f}if(c.length!==u.length||u.length!==d.length)throw r()}},VF=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=qn(c,l);if(!u){const d={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=e(l,d)}return o.set(l,c),u?(await t(l,a.Q,c.Q),await t(l,a.detune,c.detune),await t(l,a.frequency,c.frequency),await t(l,a.gain,c.gain)):(await r(l,a.Q,c.Q),await r(l,a.detune,c.detune),await r(l,a.frequency,c.frequency),await r(l,a.gain,c.gain)),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},GF=(t,e)=>(n,r)=>{const i=e.get(n);if(i!==void 0)return i;const o=t.get(n);if(o!==void 0)return o;try{const s=r();return s instanceof Promise?(t.set(n,s),s.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,s),s)}catch{return e.set(n,!1),!1}},WF={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},zF=(t,e,n,r,i)=>class extends t{constructor(s,a){const l=r(s),c={...WF,...a},u=n(l,c),d=i(l)?e():null;super(s,!1,u,d)}},jF=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},HF={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},ZF=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=r(a),u=o({...HF,...l}),d=n(c,u),f=i(c)?e():null;super(a,!1,d,f)}},$F=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(s,c)}return r.set(s,a),await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},XF=t=>(e,n,r)=>t(n,e,r),KF=t=>(e,n,r=0,i=0)=>{const o=e[r];if(o===void 0)throw t();return P0(n)?o.connect(n,0,i):o.connect(n,0)},JF=t=>(e,n)=>{const r=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},YF={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},qF=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...YF,...c},f=r(u,d),h=o(u),p=h?n():null;super(l,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=e(this,h,f.offset,rr,Xr),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?s(this,l):null;this._nativeConstantSourceNode.onended=c;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===c?l:u}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Hc(this);const c=()=>{this._nativeConstantSourceNode.removeEventListener("ended",c),Ts(this)&&If(this)};this._nativeConstantSourceNode.addEventListener("ended",c)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},QF=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null;const l=async(c,u)=>{let d=n(c);const f=qn(d,u);if(!f){const h={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=e(u,h),s!==null&&d.start(s),a!==null&&d.stop(a)}return o.set(u,d),f?await t(u,c.offset,d.offset):await r(u,c.offset,d.offset),await i(c,u,d),d};return{set start(c){s=c},set stop(c){a=c},render(c,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):l(c,u)}}},eO=t=>e=>(t[0]=e,t[0]),tO={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},nO=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=r(a),u={...tO,...l},d=n(c,u),h=i(c)?e():null;super(a,!1,d,h),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&o(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},rO=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!qn(a,s)){const c={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(s,c)}return r.set(s,a),iu(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},iO=()=>new DOMException("","DataCloneError"),Nb=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,e.close(),n.close(),r()};n.onmessage=()=>i();try{e.postMessage(t,[t])}catch{}finally{i()}})},oO=(t,e,n,r,i,o,s,a,l,c,u)=>(d,f)=>{const h=s(d)?d:o(d);if(i.has(f)){const p=n();return Promise.reject(p)}try{i.add(f)}catch{}return e(l,()=>l(h))?h.decodeAudioData(f).then(p=>(Nb(f).catch(()=>{}),e(a,()=>a(p))||u(p),t.add(p),p)):new Promise((p,m)=>{const C=async()=>{try{await Nb(f)}catch{}},v=g=>{m(g),C()};try{h.decodeAudioData(f,g=>{typeof g.copyFromChannel!="function"&&(c(g),$T(g)),t.add(g),C().then(()=>p(g))},g=>{v(g===null?r():g)})}catch(g){v(g)}})},sO=(t,e,n,r,i,o,s,a)=>(l,c)=>{const u=e.get(l);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=o(l.context),f=a(d);if(u===c){if(e.delete(l),!f&&s(l)){const h=r(l),{outputs:p}=n(l);for(const m of p)if(Af(m)){const C=r(m[0]);t(h,C,m[1],m[2])}else{const C=i(m[0]);h.connect(C,m[1])}}}else e.set(l,u-c)},aO={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},lO=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...aO,...c},f=r(u,d),h=o(u),p=h?n(d.maxDelayTime):null;super(l,!1,f,p),this._delayTime=e(this,h,f.delayTime),s(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},cO=(t,e,n,r,i)=>o=>{const s=new WeakMap,a=async(l,c)=>{let u=n(l);const d=qn(u,c);if(!d){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=e(c,f)}return s.set(c,u),d?await t(c,l.delayTime,u.delayTime):await r(c,l.delayTime,u.delayTime),await i(l,c,u),u};return{render(l,c){const u=s.get(c);return u!==void 0?Promise.resolve(u):a(l,c)}}},uO=t=>(e,n,r,i)=>t(e[i],o=>o[0]===n&&o[1]===r),dO=t=>(e,n)=>{t(e).delete(n)},fO=t=>"delayTime"in t,hO=(t,e,n)=>function r(i,o){const s=R0(o)?o:n(t,o);if(fO(s))return[];if(i[0]===s)return[i];if(i.includes(s))return[];const{outputs:a}=e(s);return Array.from(a).map(l=>r([...i,s],l[0])).reduce((l,c)=>l.concat(c),[])},Qf=(t,e,n)=>{const r=e[n];if(r===void 0)throw t();return r},pO=t=>(e,n=void 0,r=void 0,i=0)=>n===void 0?e.forEach(o=>o.disconnect()):typeof n=="number"?Qf(t,e,n).disconnect():P0(n)?r===void 0?e.forEach(o=>o.disconnect(n)):i===void 0?Qf(t,e,r).disconnect(n,0):Qf(t,e,r).disconnect(n,0,i):r===void 0?e.forEach(o=>o.disconnect(n)):Qf(t,e,r).disconnect(n,0),gO={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},mO=(t,e,n,r,i,o,s,a)=>class extends t{constructor(c,u){const d=o(c),f={...gO,...u},h=r(d,f),p=s(d),m=p?n():null;super(c,!1,h,m),this._attack=e(this,p,h.attack),this._knee=e(this,p,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=e(this,p,h.ratio),this._release=e(this,p,h.release),this._threshold=e(this,p,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(c){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=c,c>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(c){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=c,c==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},vO=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=qn(c,l);if(!u){const d={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=e(l,d)}return o.set(l,c),u?(await t(l,a.attack,c.attack),await t(l,a.knee,c.knee),await t(l,a.ratio,c.ratio),await t(l,a.release,c.release),await t(l,a.threshold,c.threshold)):(await r(l,a.attack,c.attack),await r(l,a.knee,c.knee),await r(l,a.ratio,c.ratio),await r(l,a.release,c.release),await r(l,a.threshold,c.threshold)),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},CO=()=>new DOMException("","EncodingError"),yO=t=>e=>new Promise((n,r)=>{if(t===null){r(new SyntaxError);return}const i=t.document.head;if(i===null)r(new SyntaxError);else{const o=t.document.createElement("script"),s=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(s),l=t.onerror,c=()=>{t.onerror=l,URL.revokeObjectURL(a)};t.onerror=(u,d,f,h,p)=>{if(d===a||d===t.location.href&&f===1&&h===1)return c(),r(p),!1;if(l!==null)return l(u,d,f,h,p)},o.onerror=()=>{c(),r(new SyntaxError)},o.onload=()=>{c(),n()},o.src=a,o.type="module",i.appendChild(o)}}),xO=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=t(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(n,o,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,o===void 0?null:o,i)}},IO=t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},bO=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},AO={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},wO=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=i(a),u={...AO,...l},d=r(c,u),f=o(c),h=f?n():null;super(a,!1,d,h),this._gain=e(this,f,d.gain,rr,Xr)}get gain(){return this._gain}},SO=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=qn(c,l);if(!u){const d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=e(l,d)}return o.set(l,c),u?await t(l,a.gain,c.gain):await r(l,a.gain,c.gain),await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},kO=(t,e)=>n=>e(t,n),EO=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},TO=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},RO=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},_O=t=>e=>t.get(e),On=()=>new DOMException("","InvalidStateError"),DO=t=>e=>{const n=t.get(e);if(n===void 0)throw On();return n},PO=(t,e)=>n=>{let r=t.get(n);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),t.set(n,r),r},NO=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},_p=()=>new DOMException("","InvalidAccessError"),BO=t=>{t.getFrequencyResponse=(e=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw _p();return e.call(t,n,r,i)})(t.getFrequencyResponse)},FO={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},OO=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=r(a),u=i(c),d={...FO,...l},f=e(c,u?null:a.baseLatency,d),h=u?n(d.feedback,d.feedforward):null;super(a,!1,f,h),BO(f),this._nativeIIRFilterNode=f,o(this,1)}getFrequencyResponse(a,l,c){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,c)}},e2=(t,e,n,r,i,o,s,a,l,c,u)=>{const d=c.length;let f=a;for(let h=0;h<d;h+=1){let p=n[0]*c[h];for(let m=1;m<i;m+=1){const C=f-m&l-1;p+=n[m]*o[C],p-=t[m]*s[C]}for(let m=i;m<r;m+=1)p+=n[m]*o[f-m&l-1];for(let m=i;m<e;m+=1)p-=t[m]*s[f-m&l-1];o[f]=c[h],s[f]=p,f=f+1&l-1,u[h]=p}return f},MO=(t,e,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),o=r instanceof Float64Array?r:new Float64Array(r),s=i.length,a=o.length,l=Math.min(s,a);if(i[0]!==1){for(let p=0;p<s;p+=1)o[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const c=32,u=new Float32Array(c),d=new Float32Array(c),f=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),h=t.numberOfChannels;for(let p=0;p<h;p+=1){const m=t.getChannelData(p),C=f.getChannelData(p);u.fill(0),d.fill(0),e2(i,s,o,a,l,u,d,0,c,m,C)}return f},LO=(t,e,n,r,i)=>(o,s)=>{const a=new WeakMap;let l=null;const c=async(u,d)=>{let f=null,h=e(u);const p=qn(h,d);if(d.createIIRFilter===void 0?f=t(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(h=d.createIIRFilter(s,o)),a.set(d,f===null?h:f),f!==null){if(l===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const C=new n(u.context.destination.channelCount,u.context.length,d.sampleRate);l=(async()=>{await r(u,C,C.destination);const v=await i(C);return MO(v,d,o,s)})()}const m=await l;return f.buffer=m,f.start(0),f}return await r(u,d,h),h};return{render(u,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):c(u,d)}}},UO=(t,e,n,r,i,o)=>s=>(a,l)=>{const c=t.get(a);if(c===void 0){if(!s&&o(a)){const u=r(a),{outputs:d}=n(a);for(const f of d)if(Af(f)){const h=r(f[0]);e(u,h,f[1],f[2])}else{const h=i(f[0]);u.disconnect(h,f[1])}}t.set(a,l)}else t.set(a,c+l)},VO=t=>e=>t!==null&&e instanceof t,GO=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,WO=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,zO=(t,e)=>n=>t(n)||e(n),jO=t=>e=>t!==null&&e instanceof t,HO=t=>t!==null&&t.isSecureContext,ZO=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),l=e(a,s);if(r(a))throw TypeError();super(o,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},$O={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},XO=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o);if(r(a))throw new TypeError;const l={...$O,...s},c=e(a,l);super(o,!1,c,null),this._nativeMediaStreamAudioDestinationNode=c}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},KO=(t,e,n,r)=>class extends t{constructor(o,s){const a=n(o),l=e(a,s);if(r(a))throw new TypeError;super(o,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},JO=(t,e,n)=>class extends t{constructor(i,o){const s=n(i),a=e(s,o);super(i,!0,a,null)}},YO=(t,e,n,r,i,o)=>class extends n{constructor(a,l){super(a),this._nativeContext=a,WT.set(this,a),r(a)&&i.set(a,new Set),this._destination=new t(this,l),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const l=typeof a=="function"?o(this,a):null;this._nativeContext.onstatechange=l;const c=this._nativeContext.onstatechange;this._onstatechange=c!==null&&c===l?a:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},iC=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},qO=(t,e)=>(n,r,i)=>{const o=new Set;return n.connect=(s=>(a,l=0,c=0)=>{const u=o.size===0;if(e(a))return s.call(n,a,l,c),t(o,[a,l,c],d=>d[0]===a&&d[1]===l&&d[2]===c,!0),u&&r(),a;s.call(n,a,l),t(o,[a,l],d=>d[0]===a&&d[1]===l,!0),u&&r()})(n.connect),n.disconnect=(s=>(a,l,c)=>{const u=o.size>0;if(a===void 0)s.apply(n),o.clear();else if(typeof a=="number"){s.call(n,a);for(const f of o)f[1]===a&&o.delete(f)}else{e(a)?s.call(n,a,l,c):s.call(n,a,l);for(const f of o)f[0]===a&&(l===void 0||f[1]===l)&&(c===void 0||f[2]===c)&&o.delete(f)}const d=o.size===0;u&&d&&i()})(n.disconnect),n},jt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n]&&(t[n]=r)},In=(t,e)=>{jt(t,e,"channelCount"),jt(t,e,"channelCountMode"),jt(t,e,"channelInterpretation")},Bb=t=>typeof t.getFloatTimeDomainData=="function",QO=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const r=Math.max(n.length,t.fftSize);for(let i=0;i<r;i+=1)e[i]=(n[i]-128)*.0078125;return e}},eM=(t,e)=>(n,r)=>{const i=n.createAnalyser();if(In(i,r),!(r.maxDecibels>r.minDecibels))throw e();return jt(i,r,"fftSize"),jt(i,r,"maxDecibels"),jt(i,r,"minDecibels"),jt(i,r,"smoothingTimeConstant"),t(Bb,()=>Bb(i))||QO(i),i},tM=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,Qt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n].value&&(t[n].value=r)},nM=t=>{t.start=(e=>{let n=!1;return(r=0,i=0,o)=>{if(n)throw On();e.call(t,r,i,o),n=!0}})(t.start)},y1=t=>{t.start=(e=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,i)})(t.start)},x1=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},rM=(t,e,n,r,i,o,s,a,l,c,u)=>(d,f)=>{const h=d.createBufferSource();return In(h,f),Qt(h,f,"playbackRate"),jt(h,f,"buffer"),jt(h,f,"loop"),jt(h,f,"loopEnd"),jt(h,f,"loopStart"),e(n,()=>n(d))||nM(h),e(r,()=>r(d))||l(h),e(i,()=>i(d))||c(h,d),e(o,()=>o(d))||y1(h),e(s,()=>s(d))||u(h,d),e(a,()=>a(d))||x1(h),t(d,h),h},iM=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,oM=(t,e)=>(n,r,i)=>{const o=n.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}i&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const s=t(n,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(s,"channelCount",a=>()=>a.call(s),a=>l=>{a.call(s,l);try{o.channelCount=l}catch(c){if(l>o.maxChannelCount)throw c}}),e(s,"channelCountMode",a=>()=>a.call(s),a=>l=>{a.call(s,l),o.channelCountMode=l}),e(s,"channelInterpretation",a=>()=>a.call(s),a=>l=>{a.call(s,l),o.channelInterpretation=l}),Object.defineProperty(s,"maxChannelCount",{get:()=>o.maxChannelCount}),s.connect(o),s},sM=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,aM=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},lM=(t,e,n,r,i)=>(o,s,a,l,c,u)=>{if(a!==null)try{const d=new a(o,l,u),f=new Map;let h=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>h,set:p=>{typeof h=="function"&&d.removeEventListener("processorerror",h),h=typeof p=="function"?p:null,typeof h=="function"&&d.addEventListener("processorerror",h)}}}),d.addEventListener=(p=>(...m)=>{if(m[0]==="processorerror"){const C=typeof m[1]=="function"?m[1]:typeof m[1]=="object"&&m[1]!==null&&typeof m[1].handleEvent=="function"?m[1].handleEvent:null;if(C!==null){const v=f.get(m[1]);v!==void 0?m[1]=v:(m[1]=g=>{g.type==="error"?(Object.defineProperties(g,{type:{value:"processorerror"}}),C(g)):C(new ErrorEvent(m[0],{...g}))},f.set(C,m[1]))}}return p.call(d,"error",m[1],m[2]),p.call(d,...m)})(d.addEventListener),d.removeEventListener=(p=>(...m)=>{if(m[0]==="processorerror"){const C=f.get(m[1]);C!==void 0&&(f.delete(m[1]),m[1]=C)}return p.call(d,"error",m[1],m[2]),p.call(d,m[0],m[1],m[2])})(d.removeEventListener),u.numberOfOutputs!==0){const p=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(p).connect(o.destination),i(d,()=>p.disconnect(),()=>p.connect(o.destination))}return d}catch(d){throw d.code===11?r():d}if(c===void 0)throw r();return aM(u),e(o,s,c,u)},t2=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),cM=t=>new Promise((e,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:o})=>{r.close(),i.close(),e(o)},r.onmessageerror=({data:o})=>{r.close(),i.close(),n(o)},i.postMessage(t)}),uM=async(t,e)=>{const n=await cM(e);return new t(n)},dM=(t,e,n,r)=>{let i=eC.get(t);i===void 0&&(i=new WeakMap,eC.set(t,i));const o=uM(n,r);return i.set(e,o),o},fM=(t,e,n,r,i,o,s,a,l,c,u,d,f)=>(h,p,m,C)=>{if(C.numberOfInputs===0&&C.numberOfOutputs===0)throw l();const v=Array.isArray(C.outputChannelCount)?C.outputChannelCount:Array.from(C.outputChannelCount);if(v.some(he=>he<1))throw l();if(v.length!==C.numberOfOutputs)throw e();if(C.channelCountMode!=="explicit")throw l();const g=C.channelCount*C.numberOfInputs,y=v.reduce((he,Ce)=>he+Ce,0),I=m.parameterDescriptors===void 0?0:m.parameterDescriptors.length;if(g+I>6||y>6)throw l();const b=new MessageChannel,E=[],w=[];for(let he=0;he<C.numberOfInputs;he+=1)E.push(s(h,{channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation,gain:1})),w.push(i(h,{channelCount:C.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:C.channelCount}));const k=[];if(m.parameterDescriptors!==void 0)for(const{defaultValue:he,maxValue:Ce,minValue:Ue,name:Le}of m.parameterDescriptors){const Pe=o(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:C.parameterData[Le]!==void 0?C.parameterData[Le]:he===void 0?0:he});Object.defineProperties(Pe.offset,{defaultValue:{get:()=>he===void 0?0:he},maxValue:{get:()=>Ce===void 0?rr:Ce},minValue:{get:()=>Ue===void 0?Xr:Ue}}),k.push(Pe)}const D=r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,g+I)}),T=t2(p,h.sampleRate),R=a(h,T,g+I,Math.max(1,y)),P=i(h,{channelCount:Math.max(1,y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,y)}),M=[];for(let he=0;he<C.numberOfOutputs;he+=1)M.push(r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[he]}));for(let he=0;he<C.numberOfInputs;he+=1){E[he].connect(w[he]);for(let Ce=0;Ce<C.channelCount;Ce+=1)w[he].connect(D,Ce,he*C.channelCount+Ce)}const G=new qT(m.parameterDescriptors===void 0?[]:m.parameterDescriptors.map(({name:he},Ce)=>{const Ue=k[Ce];return Ue.connect(D,0,g+Ce),Ue.start(0),[he,Ue.offset]}));D.connect(R);let H=C.channelInterpretation,q=null;const ie=C.numberOfOutputs===0?[R]:M,Z={get bufferSize(){return T},get channelCount(){return C.channelCount},set channelCount(he){throw n()},get channelCountMode(){return C.channelCountMode},set channelCountMode(he){throw n()},get channelInterpretation(){return H},set channelInterpretation(he){for(const Ce of E)Ce.channelInterpretation=he;H=he},get context(){return R.context},get inputs(){return E},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get onprocessorerror(){return q},set onprocessorerror(he){typeof q=="function"&&Z.removeEventListener("processorerror",q),q=typeof he=="function"?he:null,typeof q=="function"&&Z.addEventListener("processorerror",q)},get parameters(){return G},get port(){return b.port2},addEventListener(...he){return R.addEventListener(he[0],he[1],he[2])},connect:t.bind(null,ie),disconnect:c.bind(null,ie),dispatchEvent(...he){return R.dispatchEvent(he[0])},removeEventListener(...he){return R.removeEventListener(he[0],he[1],he[2])}},Q=new Map;b.port1.addEventListener=(he=>(...Ce)=>{if(Ce[0]==="message"){const Ue=typeof Ce[1]=="function"?Ce[1]:typeof Ce[1]=="object"&&Ce[1]!==null&&typeof Ce[1].handleEvent=="function"?Ce[1].handleEvent:null;if(Ue!==null){const Le=Q.get(Ce[1]);Le!==void 0?Ce[1]=Le:(Ce[1]=Pe=>{u(h.currentTime,h.sampleRate,()=>Ue(Pe))},Q.set(Ue,Ce[1]))}}return he.call(b.port1,Ce[0],Ce[1],Ce[2])})(b.port1.addEventListener),b.port1.removeEventListener=(he=>(...Ce)=>{if(Ce[0]==="message"){const Ue=Q.get(Ce[1]);Ue!==void 0&&(Q.delete(Ce[1]),Ce[1]=Ue)}return he.call(b.port1,Ce[0],Ce[1],Ce[2])})(b.port1.removeEventListener);let ne=null;Object.defineProperty(b.port1,"onmessage",{get:()=>ne,set:he=>{typeof ne=="function"&&b.port1.removeEventListener("message",ne),ne=typeof he=="function"?he:null,typeof ne=="function"&&(b.port1.addEventListener("message",ne),b.port1.start())}}),m.prototype.port=b.port1;let F=null;dM(h,Z,m,C).then(he=>F=he);const J=B0(C.numberOfInputs,C.channelCount),ee=B0(C.numberOfOutputs,v),se=m.parameterDescriptors===void 0?[]:m.parameterDescriptors.reduce((he,{name:Ce})=>({...he,[Ce]:new Float32Array(128)}),{});let me=!0;const Be=()=>{C.numberOfOutputs>0&&R.disconnect(P);for(let he=0,Ce=0;he<C.numberOfOutputs;he+=1){const Ue=M[he];for(let Le=0;Le<v[he];Le+=1)P.disconnect(Ue,Ce+Le,Le);Ce+=v[he]}},ae=new Map;R.onaudioprocess=({inputBuffer:he,outputBuffer:Ce})=>{if(F!==null){const Ue=d(Z);for(let Le=0;Le<T;Le+=128){for(let Pe=0;Pe<C.numberOfInputs;Pe+=1)for(let $e=0;$e<C.channelCount;$e+=1)N0(he,J[Pe],$e,$e,Le);m.parameterDescriptors!==void 0&&m.parameterDescriptors.forEach(({name:Pe},$e)=>{N0(he,se,Pe,g+$e,Le)});for(let Pe=0;Pe<C.numberOfInputs;Pe+=1)for(let $e=0;$e<v[Pe];$e+=1)ee[Pe][$e].byteLength===0&&(ee[Pe][$e]=new Float32Array(128));try{const Pe=J.map((st,Qe)=>{if(Ue[Qe].size>0)return ae.set(Qe,T/128),st;const Wt=ae.get(Qe);return Wt===void 0?[]:(st.every(wt=>wt.every(on=>on===0))&&(Wt===1?ae.delete(Qe):ae.set(Qe,Wt-1)),st)});me=u(h.currentTime+Le/h.sampleRate,h.sampleRate,()=>F.process(Pe,ee,se));for(let st=0,Qe=0;st<C.numberOfOutputs;st+=1){for(let Gt=0;Gt<v[st];Gt+=1)QT(Ce,ee[st],Gt,Qe+Gt,Le);Qe+=v[st]}}catch(Pe){me=!1,Z.dispatchEvent(new ErrorEvent("processorerror",{colno:Pe.colno,filename:Pe.filename,lineno:Pe.lineno,message:Pe.message}))}if(!me){for(let Pe=0;Pe<C.numberOfInputs;Pe+=1){E[Pe].disconnect(w[Pe]);for(let $e=0;$e<C.channelCount;$e+=1)w[Le].disconnect(D,$e,Pe*C.channelCount+$e)}if(m.parameterDescriptors!==void 0){const Pe=m.parameterDescriptors.length;for(let $e=0;$e<Pe;$e+=1){const st=k[$e];st.disconnect(D,0,g+$e),st.stop()}}D.disconnect(R),R.onaudioprocess=null,Pt?Be():ze();break}}}};let Pt=!1;const Vt=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),dn=()=>R.connect(Vt).connect(h.destination),ze=()=>{R.disconnect(Vt),Vt.disconnect()},at=()=>{if(me){ze(),C.numberOfOutputs>0&&R.connect(P);for(let he=0,Ce=0;he<C.numberOfOutputs;he+=1){const Ue=M[he];for(let Le=0;Le<v[he];Le+=1)P.connect(Ue,Ce+Le,Le);Ce+=v[he]}}Pt=!0},ot=()=>{me&&(dn(),Be()),Pt=!1};return dn(),f(Z,at,ot)},n2=(t,e)=>{const n=t.createBiquadFilter();return In(n,e),Qt(n,e,"Q"),Qt(n,e,"detune"),Qt(n,e,"frequency"),Qt(n,e,"gain"),jt(n,e,"type"),n},hM=(t,e)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,i),In(i,r),i},pM=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw On()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw On()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw On()}})},wf=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return In(n,e),pM(n),n},gM=(t,e,n,r,i)=>(o,s)=>{if(o.createConstantSource===void 0)return n(o,s);const a=o.createConstantSource();return In(a,s),Qt(a,s,"offset"),e(r,()=>r(o))||y1(a),e(i,()=>i(o))||x1(a),t(o,a),a},ou=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),mM=(t,e,n,r)=>(i,{offset:o,...s})=>{const a=i.createBuffer(1,2,44100),l=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=n(i,{...s,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,l.buffer=a,l.loop=!0;const d={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(p){c.channelCount=p},get channelCountMode(){return c.channelCountMode},set channelCountMode(p){c.channelCountMode=p},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(p){c.channelInterpretation=p},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(p){l.onended=p},addEventListener(...p){return l.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return l.dispatchEvent(p[0])},removeEventListener(...p){return l.removeEventListener(p[0],p[1],p[2])},start(p=0){l.start.call(l,p)},stop(p=0){l.stop.call(l,p)}},f=()=>l.connect(c),h=()=>l.disconnect(c);return t(i,l),r(ou(d,c),f,h)},vM=(t,e)=>(n,r)=>{const i=n.createConvolver();if(In(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),jt(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",o=>()=>o.call(i),o=>s=>{if(s>2)throw t();return o.call(i,s)}),r.channelCountMode==="max"))throw t();return e(i,"channelCountMode",o=>()=>o.call(i),o=>s=>{if(s==="max")throw t();return o.call(i,s)}),i},r2=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return In(n,e),Qt(n,e,"delayTime"),n},CM=t=>(e,n)=>{const r=e.createDynamicsCompressor();if(In(r,n),n.channelCount>2||n.channelCountMode==="max")throw t();return Qt(r,n,"attack"),Qt(r,n,"knee"),Qt(r,n,"ratio"),Qt(r,n,"release"),Qt(r,n,"threshold"),r},Dr=(t,e)=>{const n=t.createGain();return In(n,e),Qt(n,e,"gain"),n},yM=t=>(e,n,r)=>{if(e.createIIRFilter===void 0)return t(e,n,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return In(i,r),i};function xM(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function IM(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function Fb(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)n=IM(n,e),n[0]+=t[r];return n}const bM=(t,e,n,r)=>(i,o,{channelCount:s,channelCountMode:a,channelInterpretation:l,feedback:c,feedforward:u})=>{const d=t2(o,i.sampleRate),f=c instanceof Float64Array?c:new Float64Array(c),h=u instanceof Float64Array?u:new Float64Array(u),p=f.length,m=h.length,C=Math.min(p,m);if(p===0||p>20)throw r();if(f[0]===0)throw e();if(m===0||m>20)throw r();if(h[0]===0)throw e();if(f[0]!==1){for(let k=0;k<m;k+=1)h[k]/=f[0];for(let k=1;k<p;k+=1)f[k]/=f[0]}const v=n(i,d,s,s);v.channelCount=s,v.channelCountMode=a,v.channelInterpretation=l;const g=32,y=[],I=[],b=[];for(let k=0;k<s;k+=1){y.push(0);const D=new Float32Array(g),T=new Float32Array(g);D.fill(0),T.fill(0),I.push(D),b.push(T)}v.onaudioprocess=k=>{const D=k.inputBuffer,T=k.outputBuffer,R=D.numberOfChannels;for(let P=0;P<R;P+=1){const M=D.getChannelData(P),G=T.getChannelData(P);y[P]=e2(f,p,h,m,C,I[P],b[P],y[P],g,M,G)}};const E=i.sampleRate/2;return ou({get bufferSize(){return d},get channelCount(){return v.channelCount},set channelCount(k){v.channelCount=k},get channelCountMode(){return v.channelCountMode},set channelCountMode(k){v.channelCountMode=k},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(k){v.channelInterpretation=k},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener(...k){return v.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return v.dispatchEvent(k[0])},getFrequencyResponse(k,D,T){if(k.length!==D.length||D.length!==T.length)throw t();const R=k.length;for(let P=0;P<R;P+=1){const M=-Math.PI*(k[P]/E),G=[Math.cos(M),Math.sin(M)],H=Fb(h,G),q=Fb(f,G),ie=xM(H,q);D[P]=Math.sqrt(ie[0]*ie[0]+ie[1]*ie[1]),T[P]=Math.atan2(ie[1],ie[0])}},removeEventListener(...k){return v.removeEventListener(k[0],k[1],k[2])}},v)},AM=(t,e)=>t.createMediaElementSource(e.mediaElement),wM=(t,e)=>{const n=t.createMediaStreamDestination();return In(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},SM=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((o,s)=>o.id<s.id?-1:o.id>s.id?1:0);const r=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},kM=(t,e)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),o=n.createMediaStreamSource(i);if(r.kind!=="audio")throw t();if(e(n))throw new TypeError;return o},EM=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,TM=(t,e,n,r,i,o)=>(s,a)=>{const l=s.createOscillator();return In(l,a),Qt(l,a,"detune"),Qt(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):jt(l,a,"type"),e(n,()=>n(s))||y1(l),e(r,()=>r(s))||o(l,s),e(i,()=>i(s))||x1(l),t(s,l),l},RM=t=>(e,n)=>{const r=e.createPanner();return r.orientationX===void 0?t(e,n):(In(r,n),Qt(r,n,"orientationX"),Qt(r,n,"orientationY"),Qt(r,n,"orientationZ"),Qt(r,n,"positionX"),Qt(r,n,"positionY"),Qt(r,n,"positionZ"),jt(r,n,"coneInnerAngle"),jt(r,n,"coneOuterAngle"),jt(r,n,"coneOuterGain"),jt(r,n,"distanceModel"),jt(r,n,"maxDistance"),jt(r,n,"panningModel"),jt(r,n,"refDistance"),jt(r,n,"rolloffFactor"),r)},_M=(t,e,n,r,i,o,s,a,l,c)=>(u,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:h,distanceModel:p,maxDistance:m,orientationX:C,orientationY:v,orientationZ:g,panningModel:y,positionX:I,positionY:b,positionZ:E,refDistance:w,rolloffFactor:k,...D})=>{const T=u.createPanner();if(D.channelCount>2||D.channelCountMode==="max")throw s();In(T,D);const R={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},P=n(u,{...R,channelInterpretation:"speakers",numberOfInputs:6}),M=r(u,{...D,gain:1}),G=r(u,{...R,gain:1}),H=r(u,{...R,gain:0}),q=r(u,{...R,gain:0}),ie=r(u,{...R,gain:0}),Z=r(u,{...R,gain:0}),Q=r(u,{...R,gain:0}),ne=i(u,256,6,1),F=o(u,{...R,curve:new Float32Array([1,1]),oversample:"none"});let z=[C,v,g],J=[I,b,E];const ee=new Float32Array(1);ne.onaudioprocess=({inputBuffer:ae})=>{const Pt=[l(ae,ee,0),l(ae,ee,1),l(ae,ee,2)];Pt.some((dn,ze)=>dn!==z[ze])&&(T.setOrientation(...Pt),z=Pt);const Vt=[l(ae,ee,3),l(ae,ee,4),l(ae,ee,5)];Vt.some((dn,ze)=>dn!==J[ze])&&(T.setPosition(...Vt),J=Vt)},Object.defineProperty(H.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ie.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Q.gain,"defaultValue",{get:()=>0});const se={get bufferSize(){},get channelCount(){return T.channelCount},set channelCount(ae){if(ae>2)throw s();M.channelCount=ae,T.channelCount=ae},get channelCountMode(){return T.channelCountMode},set channelCountMode(ae){if(ae==="max")throw s();M.channelCountMode=ae,T.channelCountMode=ae},get channelInterpretation(){return T.channelInterpretation},set channelInterpretation(ae){M.channelInterpretation=ae,T.channelInterpretation=ae},get coneInnerAngle(){return T.coneInnerAngle},set coneInnerAngle(ae){T.coneInnerAngle=ae},get coneOuterAngle(){return T.coneOuterAngle},set coneOuterAngle(ae){T.coneOuterAngle=ae},get coneOuterGain(){return T.coneOuterGain},set coneOuterGain(ae){if(ae<0||ae>1)throw e();T.coneOuterGain=ae},get context(){return T.context},get distanceModel(){return T.distanceModel},set distanceModel(ae){T.distanceModel=ae},get inputs(){return[M]},get maxDistance(){return T.maxDistance},set maxDistance(ae){if(ae<0)throw new RangeError;T.maxDistance=ae},get numberOfInputs(){return T.numberOfInputs},get numberOfOutputs(){return T.numberOfOutputs},get orientationX(){return G.gain},get orientationY(){return H.gain},get orientationZ(){return q.gain},get panningModel(){return T.panningModel},set panningModel(ae){T.panningModel=ae},get positionX(){return ie.gain},get positionY(){return Z.gain},get positionZ(){return Q.gain},get refDistance(){return T.refDistance},set refDistance(ae){if(ae<0)throw new RangeError;T.refDistance=ae},get rolloffFactor(){return T.rolloffFactor},set rolloffFactor(ae){if(ae<0)throw new RangeError;T.rolloffFactor=ae},addEventListener(...ae){return M.addEventListener(ae[0],ae[1],ae[2])},dispatchEvent(...ae){return M.dispatchEvent(ae[0])},removeEventListener(...ae){return M.removeEventListener(ae[0],ae[1],ae[2])}};d!==se.coneInnerAngle&&(se.coneInnerAngle=d),f!==se.coneOuterAngle&&(se.coneOuterAngle=f),h!==se.coneOuterGain&&(se.coneOuterGain=h),p!==se.distanceModel&&(se.distanceModel=p),m!==se.maxDistance&&(se.maxDistance=m),C!==se.orientationX.value&&(se.orientationX.value=C),v!==se.orientationY.value&&(se.orientationY.value=v),g!==se.orientationZ.value&&(se.orientationZ.value=g),y!==se.panningModel&&(se.panningModel=y),I!==se.positionX.value&&(se.positionX.value=I),b!==se.positionY.value&&(se.positionY.value=b),E!==se.positionZ.value&&(se.positionZ.value=E),w!==se.refDistance&&(se.refDistance=w),k!==se.rolloffFactor&&(se.rolloffFactor=k),(z[0]!==1||z[1]!==0||z[2]!==0)&&T.setOrientation(...z),(J[0]!==0||J[1]!==0||J[2]!==0)&&T.setPosition(...J);const me=()=>{M.connect(T),t(M,F,0,0),F.connect(G).connect(P,0,0),F.connect(H).connect(P,0,1),F.connect(q).connect(P,0,2),F.connect(ie).connect(P,0,3),F.connect(Z).connect(P,0,4),F.connect(Q).connect(P,0,5),P.connect(ne).connect(u.destination)},Be=()=>{M.disconnect(T),a(M,F,0,0),F.disconnect(G),G.disconnect(P),F.disconnect(H),H.disconnect(P),F.disconnect(q),q.disconnect(P),F.disconnect(ie),ie.disconnect(P),F.disconnect(Z),Z.disconnect(P),F.disconnect(Q),Q.disconnect(P),P.disconnect(ne),ne.disconnect(u.destination)};return c(ou(se,T),me,Be)},DM=t=>(e,{disableNormalization:n,imag:r,real:i})=>{const o=r instanceof Float32Array?r:new Float32Array(r),s=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(s,o,{disableNormalization:n});if(Array.from(r).length<2)throw t();return a},Sf=(t,e,n,r)=>t.createScriptProcessor(e,n,r),PM=(t,e)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,r);const o=n.createStereoPanner();return In(o,r),Qt(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:s=>{if(s!==i)throw e()}}),o},NM=(t,e,n,r,i,o)=>{const a=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},d=(p,m,C,v)=>{const g=new Float32Array(16385),y=new Float32Array(16385);for(let D=0;D<16385;D+=1){const T=D/16384*l;g[D]=Math.cos(T),y[D]=Math.sin(T)}const I=n(p,{...c,gain:0}),b=r(p,{...u,curve:g}),E=r(p,{...u,curve:a}),w=n(p,{...c,gain:0}),k=r(p,{...u,curve:y});return{connectGraph(){m.connect(I),m.connect(E.inputs===void 0?E:E.inputs[0]),m.connect(w),E.connect(C),C.connect(b.inputs===void 0?b:b.inputs[0]),C.connect(k.inputs===void 0?k:k.inputs[0]),b.connect(I.gain),k.connect(w.gain),I.connect(v,0,0),w.connect(v,0,1)},disconnectGraph(){m.disconnect(I),m.disconnect(E.inputs===void 0?E:E.inputs[0]),m.disconnect(w),E.disconnect(C),C.disconnect(b.inputs===void 0?b:b.inputs[0]),C.disconnect(k.inputs===void 0?k:k.inputs[0]),b.disconnect(I.gain),k.disconnect(w.gain),I.disconnect(v,0,0),w.disconnect(v,0,1)}}},f=(p,m,C,v)=>{const g=new Float32Array(16385),y=new Float32Array(16385),I=new Float32Array(16385),b=new Float32Array(16385),E=Math.floor(16385/2);for(let ie=0;ie<16385;ie+=1)if(ie>E){const Z=(ie-E)/(16384-E)*l;g[ie]=Math.cos(Z),y[ie]=Math.sin(Z),I[ie]=0,b[ie]=1}else{const Z=ie/(16384-E)*l;g[ie]=1,y[ie]=0,I[ie]=Math.cos(Z),b[ie]=Math.sin(Z)}const w=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),k=n(p,{...c,gain:0}),D=r(p,{...u,curve:g}),T=n(p,{...c,gain:0}),R=r(p,{...u,curve:y}),P=r(p,{...u,curve:a}),M=n(p,{...c,gain:0}),G=r(p,{...u,curve:I}),H=n(p,{...c,gain:0}),q=r(p,{...u,curve:b});return{connectGraph(){m.connect(w),m.connect(P.inputs===void 0?P:P.inputs[0]),w.connect(k,0),w.connect(T,0),w.connect(M,1),w.connect(H,1),P.connect(C),C.connect(D.inputs===void 0?D:D.inputs[0]),C.connect(R.inputs===void 0?R:R.inputs[0]),C.connect(G.inputs===void 0?G:G.inputs[0]),C.connect(q.inputs===void 0?q:q.inputs[0]),D.connect(k.gain),R.connect(T.gain),G.connect(M.gain),q.connect(H.gain),k.connect(v,0,0),M.connect(v,0,0),T.connect(v,0,1),H.connect(v,0,1)},disconnectGraph(){m.disconnect(w),m.disconnect(P.inputs===void 0?P:P.inputs[0]),w.disconnect(k,0),w.disconnect(T,0),w.disconnect(M,1),w.disconnect(H,1),P.disconnect(C),C.disconnect(D.inputs===void 0?D:D.inputs[0]),C.disconnect(R.inputs===void 0?R:R.inputs[0]),C.disconnect(G.inputs===void 0?G:G.inputs[0]),C.disconnect(q.inputs===void 0?q:q.inputs[0]),D.disconnect(k.gain),R.disconnect(T.gain),G.disconnect(M.gain),q.disconnect(H.gain),k.disconnect(v,0,0),M.disconnect(v,0,0),T.disconnect(v,0,1),H.disconnect(v,0,1)}}},h=(p,m,C,v,g)=>{if(m===1)return d(p,C,v,g);if(m===2)return f(p,C,v,g);throw i()};return(p,{channelCount:m,channelCountMode:C,pan:v,...g})=>{if(C==="max")throw i();const y=t(p,{...g,channelCount:1,channelCountMode:C,numberOfInputs:2}),I=n(p,{...g,channelCount:m,channelCountMode:C,gain:1}),b=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:v});let{connectGraph:E,disconnectGraph:w}=h(p,m,I,b,y);Object.defineProperty(b.gain,"defaultValue",{get:()=>0}),Object.defineProperty(b.gain,"maxValue",{get:()=>1}),Object.defineProperty(b.gain,"minValue",{get:()=>-1});const k={get bufferSize(){},get channelCount(){return I.channelCount},set channelCount(P){I.channelCount!==P&&(D&&w(),{connectGraph:E,disconnectGraph:w}=h(p,P,I,b,y),D&&E()),I.channelCount=P},get channelCountMode(){return I.channelCountMode},set channelCountMode(P){if(P==="clamped-max"||P==="max")throw i();I.channelCountMode=P},get channelInterpretation(){return I.channelInterpretation},set channelInterpretation(P){I.channelInterpretation=P},get context(){return I.context},get inputs(){return[I]},get numberOfInputs(){return I.numberOfInputs},get numberOfOutputs(){return I.numberOfOutputs},get pan(){return b.gain},addEventListener(...P){return I.addEventListener(P[0],P[1],P[2])},dispatchEvent(...P){return I.dispatchEvent(P[0])},removeEventListener(...P){return I.removeEventListener(P[0],P[1],P[2])}};let D=!1;const T=()=>{E(),D=!0},R=()=>{w(),D=!1};return o(ou(k,y),T,R)}},BM=(t,e,n,r,i,o,s)=>(a,l)=>{const c=a.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,l);In(c,l);const u=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(u!==null&&u.length<2)throw e();jt(c,{curve:u},"curve"),jt(c,l,"oversample");let d=null,f=!1;return s(c,"curve",m=>()=>m.call(c),m=>C=>(m.call(c,C),f&&(r(C)&&d===null?d=t(a,c):!r(C)&&d!==null&&(d(),d=null)),C)),i(c,()=>{f=!0,r(c.curve)&&(d=t(a,c))},()=>{f=!1,d!==null&&(d(),d=null)})},FM=(t,e,n,r,i)=>(o,{curve:s,oversample:a,...l})=>{const c=o.createWaveShaper(),u=o.createWaveShaper();In(c,l),In(u,l);const d=n(o,{...l,gain:1}),f=n(o,{...l,gain:-1}),h=n(o,{...l,gain:1}),p=n(o,{...l,gain:-1});let m=null,C=!1,v=null;const g={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(b){d.channelCount=b,f.channelCount=b,c.channelCount=b,h.channelCount=b,u.channelCount=b,p.channelCount=b},get channelCountMode(){return c.channelCountMode},set channelCountMode(b){d.channelCountMode=b,f.channelCountMode=b,c.channelCountMode=b,h.channelCountMode=b,u.channelCountMode=b,p.channelCountMode=b},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(b){d.channelInterpretation=b,f.channelInterpretation=b,c.channelInterpretation=b,h.channelInterpretation=b,u.channelInterpretation=b,p.channelInterpretation=b},get context(){return c.context},get curve(){return v},set curve(b){if(b!==null&&b.length<2)throw e();if(b===null)c.curve=b,u.curve=b;else{const E=b.length,w=new Float32Array(E+2-E%2),k=new Float32Array(E+2-E%2);w[0]=b[0],k[0]=-b[E-1];const D=Math.ceil((E+1)/2),T=(E+1)/2-1;for(let R=1;R<D;R+=1){const P=R/D*T,M=Math.floor(P),G=Math.ceil(P);w[R]=M===G?b[M]:(1-(P-M))*b[M]+(1-(G-P))*b[G],k[R]=M===G?-b[E-1-M]:-((1-(P-M))*b[E-1-M])-(1-(G-P))*b[E-1-G]}w[D]=E%2===1?b[D-1]:(b[D-2]+b[D-1])/2,c.curve=w,u.curve=k}v=b,C&&(r(v)&&m===null?m=t(o,d):m!==null&&(m(),m=null))},get inputs(){return[d]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(b){c.oversample=b,u.oversample=b},addEventListener(...b){return d.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return d.dispatchEvent(b[0])},removeEventListener(...b){return d.removeEventListener(b[0],b[1],b[2])}};s!==null&&(g.curve=s instanceof Float32Array?s:new Float32Array(s)),a!==g.oversample&&(g.oversample=a);const y=()=>{d.connect(c).connect(h),d.connect(f).connect(u).connect(p).connect(h),C=!0,r(v)&&(m=t(o,d))},I=()=>{d.disconnect(c),c.disconnect(h),d.disconnect(f),f.disconnect(u),u.disconnect(p),p.disconnect(h),C=!1,m!==null&&(m(),m=null)};return i(ou(g,h),y,I)},Pr=()=>new DOMException("","NotSupportedError"),OM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},MM=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...OM,...c},f=n(u,d),h=o(u),p=h?r():null,m=l.sampleRate/2;super(l,!1,f,p),this._detune=e(this,h,f.detune,153600,-153600),this._frequency=e(this,h,f.frequency,m,-m),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?s(this,l):null;this._nativeOscillatorNode.onended=c;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===c?l:u}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Hc(this);const c=()=>{this._nativeOscillatorNode.removeEventListener("ended",c),Ts(this)&&If(this)};this._nativeOscillatorNode.addEventListener("ended",c)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},LM=(t,e,n,r,i)=>()=>{const o=new WeakMap;let s=null,a=null,l=null;const c=async(u,d)=>{let f=n(u);const h=qn(f,d);if(!h){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:s===null?void 0:s,type:f.type};f=e(d,p),a!==null&&f.start(a),l!==null&&f.stop(l)}return o.set(d,f),h?(await t(d,u.detune,f.detune),await t(d,u.frequency,f.frequency)):(await r(d,u.detune,f.detune),await r(d,u.frequency,f.frequency)),await i(u,d,f),f};return{set periodicWave(u){s=u},set start(u){a=u},set stop(u){l=u},render(u,d){const f=o.get(d);return f!==void 0?Promise.resolve(f):c(u,d)}}},UM={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},VM=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...UM,...c},f=n(u,d),h=o(u),p=h?r():null;super(l,!1,f,p),this._nativePannerNode=f,this._orientationX=e(this,h,f.orientationX,rr,Xr),this._orientationY=e(this,h,f.orientationY,rr,Xr),this._orientationZ=e(this,h,f.orientationZ,rr,Xr),this._positionX=e(this,h,f.positionX,rr,Xr),this._positionY=e(this,h,f.positionY,rr,Xr),this._positionZ=e(this,h,f.positionZ,rr,Xr),s(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},GM=(t,e,n,r,i,o,s,a,l,c)=>()=>{const u=new WeakMap;let d=null;const f=async(h,p)=>{let m=null,C=o(h);const v={channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation},g={...v,coneInnerAngle:C.coneInnerAngle,coneOuterAngle:C.coneOuterAngle,coneOuterGain:C.coneOuterGain,distanceModel:C.distanceModel,maxDistance:C.maxDistance,panningModel:C.panningModel,refDistance:C.refDistance,rolloffFactor:C.rolloffFactor},y=qn(C,p);if("bufferSize"in C)m=r(p,{...v,gain:1});else if(!y){const I={...g,orientationX:C.orientationX.value,orientationY:C.orientationY.value,orientationZ:C.orientationZ.value,positionX:C.positionX.value,positionY:C.positionY.value,positionZ:C.positionZ.value};C=i(p,I)}if(u.set(p,m===null?C:m),m!==null){if(d===null){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const R=new s(6,h.context.length,p.sampleRate),P=e(R,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});P.connect(R.destination),d=(async()=>{const M=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map(async(G,H)=>{const q=n(R,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:H===0?1:0});return await a(R,G,q.offset),q}));for(let G=0;G<6;G+=1)M[G].connect(P,0,G),M[G].start(0);return c(R)})()}const I=await d,b=r(p,{...v,gain:1});await l(h,p,b);const E=[];for(let R=0;R<I.numberOfChannels;R+=1)E.push(I.getChannelData(R));let w=[E[0][0],E[1][0],E[2][0]],k=[E[3][0],E[4][0],E[5][0]],D=r(p,{...v,gain:1}),T=i(p,{...g,orientationX:w[0],orientationY:w[1],orientationZ:w[2],positionX:k[0],positionY:k[1],positionZ:k[2]});b.connect(D).connect(T.inputs[0]),T.connect(m);for(let R=128;R<I.length;R+=128){const P=[E[0][R],E[1][R],E[2][R]],M=[E[3][R],E[4][R],E[5][R]];if(P.some((G,H)=>G!==w[H])||M.some((G,H)=>G!==k[H])){w=P,k=M;const G=R/p.sampleRate;D.gain.setValueAtTime(0,G),D=r(p,{...v,gain:0}),T=i(p,{...g,orientationX:w[0],orientationY:w[1],orientationZ:w[2],positionX:k[0],positionY:k[1],positionZ:k[2]}),D.gain.setValueAtTime(1,G),b.connect(D).connect(T.inputs[0]),T.connect(m)}}return m}return y?(await t(p,h.orientationX,C.orientationX),await t(p,h.orientationY,C.orientationY),await t(p,h.orientationZ,C.orientationZ),await t(p,h.positionX,C.positionX),await t(p,h.positionY,C.positionY),await t(p,h.positionZ,C.positionZ)):(await a(p,h.orientationX,C.orientationX),await a(p,h.orientationY,C.orientationY),await a(p,h.orientationZ,C.orientationZ),await a(p,h.positionX,C.positionX),await a(p,h.positionY,C.positionY),await a(p,h.positionZ,C.positionZ)),iu(C)?await l(h,p,C.inputs[0]):await l(h,p,C),C};return{render(h,p){const m=u.get(p);return m!==void 0?Promise.resolve(m):f(h,p)}}},WM={disableNormalization:!1},zM=(t,e,n,r)=>class i2{constructor(o,s){const a=e(o),l=r({...WM,...s}),c=t(a,l);return n.add(c),c}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===i2.prototype||n.has(o)}},jM=(t,e)=>(n,r,i)=>(t(r).replay(i),e(r,n,i)),HM=(t,e,n)=>async(r,i,o)=>{const s=t(r);await Promise.all(s.activeInputs.map((a,l)=>Array.from(a).map(async([c,u])=>{const f=await e(c).render(c,i),h=r.context.destination;!n(c)&&(r!==h||!n(r))&&f.connect(o,u,l)})).reduce((a,l)=>[...a,...l],[]))},ZM=(t,e,n)=>async(r,i,o)=>{const s=e(r);await Promise.all(Array.from(s.activeInputs).map(async([a,l])=>{const u=await t(a).render(a,i);n(a)||u.connect(o,l)}))},$M=(t,e,n,r)=>i=>t(iC,()=>iC(i))?Promise.resolve(t(r,r)).then(o=>{if(!o){const s=n(i,512,0,1);i.oncomplete=()=>{s.onaudioprocess=null,s.disconnect()},s.onaudioprocess=()=>i.currentTime,s.connect(i.destination)}return i.startRendering()}):new Promise(o=>{const s=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{s.disconnect(),o(a.renderedBuffer)},s.connect(i.destination),i.startRendering()}),XM=t=>(e,n)=>{t.set(e,n)},KM=t=>(e,n)=>t.set(e,n),JM={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},YM=(t,e,n,r,i,o)=>class extends t{constructor(a,l){const c=i(a),u={...JM,...l},d=n(c,u),f=o(c),h=f?r():null;super(a,!1,d,h),this._pan=e(this,f,d.pan)}get pan(){return this._pan}},qM=(t,e,n,r,i)=>()=>{const o=new WeakMap,s=async(a,l)=>{let c=n(a);const u=qn(c,l);if(!u){const d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=e(l,d)}return o.set(l,c),u?await t(l,a.pan,c.pan):await r(l,a.pan,c.pan),iu(c)?await i(a,l,c.inputs[0]):await i(a,l,c),c};return{render(a,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):s(a,l)}}},QM=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},e8=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(n);let o=!1,s=!1;try{await r.audioWorklet.addModule(i);const a=new t(r,"a",{numberOfOutputs:0}),l=r.createOscillator();a.port.onmessage=()=>o=!0,a.onprocessorerror=()=>s=!0,l.connect(a),l.start(0),await r.startRendering(),await new Promise(c=>setTimeout(c))}catch{}finally{URL.revokeObjectURL(i)}return o&&!s},t8=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},n8=()=>new DOMException("","UnknownError"),r8={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},i8=(t,e,n,r,i,o,s)=>class extends t{constructor(l,c){const u=i(l),d={...r8,...c},f=n(u,d),p=o(u)?r():null;super(l,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,s(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},o8=(t,e,n)=>()=>{const r=new WeakMap,i=async(o,s)=>{let a=e(o);if(!qn(a,s)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(s,c)}return r.set(s,a),iu(a)?await n(o,s,a.inputs[0]):await n(o,s,a),a};return{render(o,s){const a=r.get(s);return a!==void 0?Promise.resolve(a):i(o,s)}}},s8=()=>typeof window>"u"?null:window,a8=(t,e)=>n=>{n.copyFromChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const l=n.length,c=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<l&&d<u;d+=1)r[d]=c[d+s]},n.copyToChannel=(r,i,o=0)=>{const s=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const l=n.length,c=n.getChannelData(a),u=r.length;for(let d=s<0?-s:0;d+s<l&&d<u;d+=1)c[d+s]=r[d]}},l8=t=>e=>{e.copyFromChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyFromChannel),e.copyToChannel=(n=>(r,i,o=0)=>{const s=t(o),a=t(i);if(s<e.length)return n.call(e,r,a,s)})(e.copyToChannel)},c8=t=>(e,n)=>{const r=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),t(e,"buffer",i=>()=>{const o=i.call(e);return o===r?null:o},i=>o=>i.call(e,o===null?r:o))},u8=(t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let l=0;l<a;l+=1)i.connect(r,0,l)},()=>i.disconnect(r))},o2=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),s2=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},kf=(t,e,n,r)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:s}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(o),set:r(s)})},d8=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),f8=t=>({...t,channelCount:t.numberOfOutputs}),h8=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},a2=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(r){if(r.code!==9)throw r;a2(t,e,n+1e-7)}},p8=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},g8=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},m8=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},I1=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},l2=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},b1=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},v8=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},C8=t=>{t.start=(e=>(n=0,r=0,i)=>{const o=t.buffer,s=o===null?r:Math.min(o.duration,r);o!==null&&s>o.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,s,i)})(t.start)},c2=(t,e)=>{const n=e.createGain();t.connect(n);const r=(i=>()=>{i.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),ou(t,n),t.stop=(i=>{let o=!1;return(s=0)=>{if(o)try{i.call(t,s)}catch{n.gain.setValueAtTime(0,s)}else i.call(t,s),o=!0}})(t.stop)},su=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},y8=Z4(Ol),x8=q4(Ol),I8=uO(Rp),u2=new WeakMap,b8=TO(u2),Vs=GF(new Map,new WeakMap),Oo=s8(),d2=eM(Vs,Vo),f2=EO(sr),Wn=HM(sr,f2,wl),A8=rF(d2,Ut,Wn),Dt=DO(WT),Va=EM(Oo),At=jO(Va),h2=new WeakMap,p2=xO(su),Ef=iM(Oo),g2=VO(Ef),m2=GO(Oo),w8=WO(Oo),Zd=sM(Oo),rn=RF($4(LT),Y4(y8,x8,_0,I8,D0,sr,b8,xf,Ut,Ol,Ts,wl,Th),Vs,UO(qv,D0,sr,Ut,Hd,Ts),Vo,_p,Pr,sO(_0,qv,sr,Ut,Hd,Dt,Ts,At),hO(h2,sr,Ji),p2,Dt,g2,m2,w8,At,Zd),S8=nF(rn,A8,Vo,d2,Dt,At),v2=new WeakSet,Ob=tM(Oo),C2=eO(new Uint32Array(1)),y2=a8(C2,Vo),x2=l8(C2),k8=oF(v2,Vs,Pr,Ob,Va,QM(Ob),y2,x2),Dp=Q4(Dr),I2=ZM(f2,bf,wl),Go=XF(I2),au=rM(Dp,Vs,p8,g8,m8,I1,l2,b1,C8,c8(kf),c2),Wo=jM(RO(bf),I2),E8=lF(Go,au,Ut,Wo,Wn),to=_F(X4(VT),h2,GT,DF,V4,G4,W4,z4,j4,Kv,OT,Ef,a2),T8=aF(rn,E8,to,On,au,Dt,At,su),R8=CF(rn,yF,Vo,On,oM(Dr,kf),Dt,At,Wn),_8=VF(Go,n2,Ut,Wo,Wn),Ml=KM(u2),D8=UF(rn,to,_8,_p,n2,Dt,At,Ml),Ga=qO(Ol,m2),P8=u8(On,Ga),Wa=hM(Ef,P8),N8=jF(Wa,Ut,Wn),B8=zF(rn,N8,Wa,Dt,At),F8=$F(wf,Ut,Wn),O8=ZF(rn,F8,wf,Dt,At,f8),M8=mM(Dp,au,Dr,Ga),lu=gM(Dp,Vs,M8,I1,b1),L8=QF(Go,lu,Ut,Wo,Wn),U8=qF(rn,to,L8,lu,Dt,At,su),b2=vM(Pr,kf),V8=rO(b2,Ut,Wn),G8=nO(rn,V8,b2,Dt,At,Ml),W8=cO(Go,r2,Ut,Wo,Wn),z8=lO(rn,to,W8,r2,Dt,At,Ml),A2=CM(Pr),j8=vO(Go,A2,Ut,Wo,Wn),H8=mO(rn,to,j8,A2,Pr,Dt,At,Ml),Z8=SO(Go,Dr,Ut,Wo,Wn),$8=wO(rn,to,Z8,Dr,Dt,At),X8=bM(_p,On,Sf,Pr),A1=$M(Vs,Dr,Sf,t8(Dr,Va)),K8=LO(au,Ut,Va,Wn,A1),J8=yM(X8),Y8=OO(rn,J8,K8,Dt,At,Ml),q8=xF(to,Wa,lu,Sf,Pr,o2,At,kf),w2=new WeakMap,Q8=YO(R8,q8,p2,At,w2,su),S2=TM(Dp,Vs,I1,l2,b1,c2),eL=LM(Go,S2,Ut,Wo,Wn),tL=MM(rn,to,S2,eL,Dt,At,su),k2=JF(au),nL=FM(k2,On,Dr,s2,Ga),Pp=BM(k2,On,nL,s2,Ga,Ef,kf),rL=_M(_0,On,Wa,Dr,Sf,Pp,Pr,D0,o2,Ga),E2=RM(rL),iL=GM(Go,Wa,lu,Dr,E2,Ut,Va,Wo,Wn,A1),oL=VM(rn,to,E2,iL,Dt,At,Ml),sL=DM(Vo),aL=zM(sL,Dt,new WeakSet,h8),lL=NM(Wa,wf,Dr,Pp,Pr,Ga),T2=PM(lL,Pr),cL=qM(Go,T2,Ut,Wo,Wn),uL=YM(rn,to,T2,cL,Dt,At),dL=o8(Pp,Ut,Wn),fL=i8(rn,On,Pp,dL,Dt,At,Ml),R2=HO(Oo),w1=IO(Oo),_2=new WeakMap,hL=PO(_2,Va),pL=R2?J4(Vs,Pr,yO(Oo),w1,bO(H4),Dt,hL,At,Zd,new WeakMap,new WeakMap,e8(Zd,Va),Oo):void 0,gL=zO(g2,At),mL=oO(v2,Vs,iO,CO,new WeakSet,Dt,gL,nC,iC,y2,x2),vL=MF(pL,S8,k8,T8,D8,B8,O8,U8,G8,mL,z8,H8,$8,Y8,Q8,tL,oL,aL,uL,fL),CL=ZO(rn,AM,Dt,At),yL=XO(rn,wM,Dt,At),xL=KO(rn,SM,Dt,At),IL=kM(On,At),bL=JO(rn,IL,Dt),AL=vF(vL,On,Pr,n8,CL,yL,xL,bL,Ef),D2=NO(w2),wL=eF(D2),P2=KF(Vo),SL=dO(D2),N2=pO(Vo),B2=new WeakMap,kL=kO(B2,Ji),EL=fM(P2,Vo,On,Wa,wf,lu,Dr,Sf,Pr,N2,w1,kL,Ga),TL=lM(On,EL,Dr,Pr,Ga),RL=OF(Go,P2,au,Wa,wf,lu,Dr,SL,N2,w1,Ut,Zd,Va,Wo,Wn,A1),_L=_O(_2),DL=XM(B2),Mb=R2?NF(wL,rn,to,RL,TL,sr,_L,Dt,At,Zd,d8,DL,v8,su):void 0,PL="data:text/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";let Lb=class{constructor(e){L(this,"maxSize");L(this,"cache");this.maxSize=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const n=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,n),n}set(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}has(e){return this.cache.has(e)}};const Ub=100;var kt;let NL=(kt=class{static setCacheExpirationTime(e){this.cacheExpirationTime=e}static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getBufferFromCache(e,n){try{const r=await n.match(e);return r&&r.ok?await r.arrayBuffer():null}catch(r){return console.error("Failed to get data from cache:",r),null}}static async fetchAndCacheBuffer(e,n,r,i){try{const o=new Headers;r&&o.append("If-None-Match",r),i&&o.append("If-Modified-Since",i);const s=await fetch(e,{headers:o}),a=s.clone();if(s.status===200){const l=s.headers.get("ETag")||void 0,c=s.headers.get("Last-Modified")||void 0,u={url:e,etag:l,lastModified:c,timestamp:Date.now()};await n.put(e,a),await n.put(e+":meta",new Response(JSON.stringify(u),{headers:{"Content-Type":"application/json"}}))}else if(s.status===304){const l=await n.match(e);if(l)return await l.arrayBuffer()}return await s.arrayBuffer()}catch(o){throw console.error("Failed to fetch and cache data:",o),o}}static async decodeAudioData(e,n){try{return await e.decodeAudioData(n)}catch(r){throw console.error("Failed to decode audio data:",r),r}}static async getMetadataFromCache(e,n){try{const r=await n.match(e+":meta");return r&&r.ok?await r.json():null}catch(r){return console.error("Failed to get metadata from cache:",r),null}}async getAudioBuffer(e,n){if(kt.decodedBuffers.has(n))return kt.decodedBuffers.get(n);if(n.startsWith("data:")){const a=n.split(",")[1],l=Uint8Array.from(atob(a),u=>u.charCodeAt(0)).buffer,c=await kt.decodeAudioData(e,l);return kt.decodedBuffers.set(n,c),c}const r=await kt.openCache();let i=kt.pendingRequests.get(n);if(i)return i;const o=await kt.getMetadataFromCache(n,r);let s=!o;if(o&&(o.etag||o.lastModified?s=!1:o.timestamp?s=Date.now()-o.timestamp>kt.cacheExpirationTime:s=!0),s)return i=kt.fetchAndCacheBuffer(n,r,o==null?void 0:o.etag,o==null?void 0:o.lastModified).then(a=>kt.decodeAudioData(e,a)).then(a=>(kt.decodedBuffers.set(n,a),a)).finally(()=>{kt.pendingRequests.delete(n)}),kt.pendingRequests.set(n,i),i;{const a=await kt.getBufferFromCache(n,r);if(a){const l=await kt.decodeAudioData(e,a);return kt.decodedBuffers.set(n,l),l}}throw new Error("Failed to retrieve audio buffer")}clearMemoryCache(){kt.decodedBuffers=new Lb(Ub),kt.pendingRequests.clear()}},L(kt,"pendingRequests",new Map),L(kt,"decodedBuffers",new Lb(Ub)),L(kt,"cacheExpirationTime",24*60*60*1e3),kt),Vb=class{constructor(e=[]){L(this,"_position",[0,0,0]);L(this,"loopCount",0);L(this,"playIndex",0);this.sounds=e}preplayRandom(){if(this.sounds.length===0)return;const e=this.randomSound().preplay();return e.length>0?e[0]:void 0}playRandom(){const e=this.preplayRandom();return e&&e.play(),e}preplayOrdered(e=!0){if(this.sounds.length===0)return;const n=this.sounds[this.playIndex].preplay();if(n.length!==0)return this.playIndex=(this.playIndex+1)%this.sounds.length,!e&&this.playIndex===0&&(this.playIndex=this.sounds.length),n[0]}playOrdered(e=!0){const n=this.preplayOrdered(e);return n&&n.play(),n}get duration(){return this.sounds.map(e=>e.duration).reduce((e,n)=>Math.max(e,n),0)}seek(e){this.sounds.forEach(n=>n.seek&&n.seek(e))}addSound(e){this.sounds.push(e)}randomSound(){if(this.sounds.length===0)throw new Error("Cannot get a random sound from an empty group");const e=Math.floor(Math.random()*this.sounds.length);return this.sounds[e]}preplay(){return this.sounds.map(e=>e.preplay()).flat()}play(){const e=[];return this.preplay().forEach(n=>{n.play(),e.push(n)}),e}get isPlaying(){return this.sounds.some(e=>e.isPlaying)}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(n=>n.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(n=>n.addFilter(e))}removeFilter(e){this.sounds.forEach(n=>n.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(n=>n.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,n)=>e+n,0)/this.sounds.length}set volume(e){this.sounds.forEach(n=>n.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(n=>n.playbackRate=e)}},cu=class{constructor(){L(this,"_filters",[])}addFilter(e){this._filters.push(e)}removeFilter(e){this._filters=this._filters.filter(n=>n.frequency.value!==e.frequency.value&&n.type!==e.type&&n.Q.value!==e.Q.value&&n.gain.value!==e.gain.value)}applyFilters(e){return this._filters.reduce((n,r)=>(n.connect(r),r),e),this._filters.length>0?this._filters[this._filters.length-1]:e}get filters(){return this._filters}addFilters(e){e.forEach(n=>this.addFilter(n))}removeFilters(e){e.forEach(n=>this.removeFilter(n))}},BL=class extends cu{constructor(n,r,i,o=0){super();L(this,"context");L(this,"source");L(this,"gainNode");L(this,"panner");this.source=n,this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}get isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!0)}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,o]=n;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=o}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.source;this.source.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(n){}},FL=class extends cu{constructor(n){super();L(this,"context");L(this,"_position",[0,0,0]);L(this,"loopCount",0);L(this,"prevVolume",1);L(this,"microphoneGainNode");L(this,"streamPlayback");L(this,"stream");L(this,"streamSource");this.context=n,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{this.stream=n,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new BL(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(n=>{console.error("Error initializing microphone stream:",n)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(n){}get isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(n){this.streamPlayback&&this.streamPlayback.addFilter(n)}removeFilter(n){this.streamPlayback&&this.streamPlayback.removeFilter(n)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(n){this.streamPlayback&&(this.streamPlayback.volume=n)}get position(){return[0,0,0]}set position(n){}loop(n){return 0}get playbackRate(){return 1}set playbackRate(n){}};function F2(t){class e extends t{constructor(){super(...arguments);L(this,"playbacks",[]);L(this,"_position",[0,0,0]);L(this,"_stereoPan",0);L(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});L(this,"_volume",1)}play(){const i=this.preplay();return i.forEach(o=>o.play()),i}stop(){this.playbacks.forEach(i=>i.stop()),this.playbacks=[]}pause(){this.playbacks.forEach(i=>i.pause())}addFilter(i){super.addFilter(i),this.playbacks.forEach(o=>o.addFilter(i))}removeFilter(i){super.removeFilter(i),this.playbacks.forEach(o=>o.removeFilter(i))}get isPlaying(){return this.playbacks.some(i=>i.isPlaying)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}set position(i){this._threeDOptions.positionX=i[0],this._threeDOptions.positionY=i[1],this._threeDOptions.positionZ=i[2],this.playbacks.forEach(o=>o.position=i)}get threeDOptions(){return this._threeDOptions}set threeDOptions(i){this._threeDOptions={...this._threeDOptions,...i},this.playbacks.forEach(o=>o.threeDOptions=this._threeDOptions)}get stereoPan(){return this._stereoPan}set stereoPan(i){this._stereoPan=i,this.playbacks.forEach(o=>o.stereoPan=i)}get volume(){return this._volume}set volume(i){this._volume=i,this.playbacks.forEach(o=>o.volume=i)}}return e}function O2(t){class e extends t{constructor(){super(...arguments);L(this,"panner");L(this,"_panType","stereo")}get panType(){return this._panType}setPanType(i,o){this._panType===i&&this.panner||(this.panner&&this.panner.disconnect(),this._panType=i,i==="stereo"?this.panner=o.createStereoPanner():this.panner=o.createPanner())}setPannerNode(i){this.panner=i}get stereoPan(){return this.panType==="stereo"?this.panner.pan.value:null}set stereoPan(i){if(this.panType!=="stereo")throw new Error("Stereo panning is not available when using HRTF.");if(!this.panner)throw new Error("Cannot set stereo pan of a sound that has been cleaned up");i=Gb(i,-1,1),this.panner.pan.setValueAtTime(Gb(i,-1,1),this.panner.context.currentTime)}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get 3D options of a sound that is not using HRTF");const i=this.panner;return{coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,channelCount:this.panner.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,panningModel:i.panningModel,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,positionX:i.positionX.value,positionY:i.positionY.value,positionZ:i.positionZ.value,orientationX:i.orientationX.value,orientationY:i.orientationY.value,orientationZ:i.orientationZ.value}}set threeDOptions(i){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot set 3D options of a sound that is not using HRTF");const o=this.panner;o.coneInnerAngle=i.coneInnerAngle!==void 0?i.coneInnerAngle:o.coneInnerAngle,o.coneOuterAngle=i.coneOuterAngle!==void 0?i.coneOuterAngle:o.coneOuterAngle,o.coneOuterGain=i.coneOuterGain!==void 0?i.coneOuterGain:o.coneOuterGain,o.distanceModel=i.distanceModel||o.distanceModel,o.maxDistance=i.maxDistance!==void 0?i.maxDistance:o.maxDistance,o.channelCount=i.channelCount!==void 0?i.channelCount:o.channelCount,o.channelCountMode=i.channelCountMode||o.channelCountMode,o.channelInterpretation=i.channelInterpretation||o.channelInterpretation,o.panningModel=i.panningModel||o.panningModel,o.refDistance=i.refDistance!==void 0?i.refDistance:o.refDistance,o.rolloffFactor=i.rolloffFactor!==void 0?i.rolloffFactor:o.rolloffFactor,o.positionX.value=i.positionX!==void 0?i.positionX:o.positionX.value,o.positionY.value=i.positionY!==void 0?i.positionY:o.positionY.value,o.positionZ.value=i.positionZ!==void 0?i.positionZ:o.positionZ.value,o.orientationX.value=i.orientationX!==void 0?i.orientationX:o.orientationX.value,o.orientationY.value=i.orientationY!==void 0?i.orientationY:o.orientationY.value,o.orientationZ.value=i.orientationZ!==void 0?i.orientationZ:o.orientationZ.value}set position(i){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot move a sound that is not using HRTF");const[o,s,a]=i,l=this.panner;l.positionX.value=o,l.positionY.value=s,l.positionZ.value=a}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get position of a sound that is not using HRTF");const i=this.panner;return[i.positionX.value,i.positionY.value,i.positionZ.value]}}return e}function Gb(t,e,n){return Math.min(Math.max(t,e),n)}function M2(t){class e extends t{constructor(){super(...arguments);L(this,"gainNode")}setGainNode(i){this.gainNode=i}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(i){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=i}}return e}let L2=class extends O2(M2(cu)){constructor(){super(...arguments);L(this,"source");L(this,"_playing",!1);L(this,"origin")}get isPlaying(){return this.source?this._playing:!1}};class S1 extends L2{constructor(n,r,i){super();L(this,"context");L(this,"loopCount",0);L(this,"currentLoop",0);L(this,"buffer");L(this,"_offset",0);L(this,"_startTime",0);L(this,"_state",0);L(this,"_playbackRate",1);L(this,"loopEnded",()=>{!this.source||this._state!==1||(this.currentLoop++,this.loopCount!=="infinite"&&this.currentLoop>this.loopCount?this.stop():(this.seek(0),this._state=1,"start"in this.source&&this.source.start?this.source.start(0,this._offset):"mediaElement"in this.source&&this.source.mediaElement&&this.source.mediaElement.play()))});this.origin=n,this.context=n.context,this.loopCount=n.loopCount,this.setPanType(n.panType,n.context),this.source=r,"buffer"in r&&r.buffer&&(this.buffer=r.buffer),this.setupSourceNode(r),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}setupSourceNode(n){if("mediaElement"in n&&n.mediaElement)n.mediaElement.onended=this.loopEnded;else if("onended"in n)n.onended=this.loopEnded;else throw new Error("Unsupported source type")}get isPlaying(){return this._state===1}get duration(){if(!this.source)throw new Error("Cannot get duration of a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.duration:this.buffer?this.buffer.duration||NaN:NaN}get playbackRate(){return this._playbackRate}set playbackRate(n){if(n<=0)throw new Error("Playback rate must be greater than 0");if(this._state===1){const r=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=r,this._startTime=this.context.currentTime}this._playbackRate=n,this.source&&("playbackRate"in this.source&&(this.source.playbackRate.value=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=n))}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return this._state===1?[this]:(this._state===2?"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():(this.recreateSource(),"start"in this.source&&this.source.start&&this.source.start(0,this._offset)):"mediaElement"in this.source&&this.source.mediaElement?(this.source.mediaElement.currentTime=this._offset,this.source.mediaElement.play()):"start"in this.source&&this.source.start&&(this.recreateSource(),this.source.start(0,this._offset)),this._startTime=this.context.currentTime,this._state=1,[this])}pause(){if(!this.source||this._state!==1)return;const n=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=n,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.pause():this.recreateSource(),this._state=2}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this._state===3||this._state===0||("stop"in this.source&&this._state===1&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this._offset=0,this._startTime=0,this._state=3)}seek(n){if(!this.source||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");if(!isFinite(n)||n<0)throw new Error("Invalid time value for seek");const r=this._state===1;r&&this.pause(),this._offset=n,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.currentTime=n:this.recreateSource(),r&&this.play()}get currentTime(){if(this._state===1){const n=(this.context.currentTime-this._startTime)*this._playbackRate;return this._offset+n}else return this._offset}recreateSource(){if(!this.buffer||!this.panner||!this.context||!this.gainNode)throw new Error("Cannot recreate source of a sound that has been cleaned up");this.source&&this.source.disconnect(),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.panner),this.source.onended=this.loopEnded,this.playbackRate=this._playbackRate,this.refreshFilters()}set sourceLoop(n){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=n)}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this._filters.forEach(n=>{n&&n.disconnect()}),this._filters=[]}loop(n){if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(n!==void 0&&(this.loopCount=n==="infinite"?"infinite":Math.max(0,n),this.currentLoop=0),"mediaElement"in this.source&&this.source.mediaElement){const r=this.source.mediaElement;r.loop=this.loopCount==="infinite"}else if("loop"in this.source)this.source.loop=this.loopCount==="infinite",this.source.buffer&&(this.source.loopEnd=this.source.buffer.duration,this.source.loopStart=0);else throw new Error("Unsupported source type");return this.loopCount}addFilter(n){const r=this.context.createBiquadFilter();r.type=n.type,r.frequency.value=n.frequency.value,r.Q.value=n.Q.value,r.gain.value=n.gain.value,this._filters.push(r),this.refreshFilters()}removeFilter(n){const r=this._filters.indexOf(n);r!==-1&&this._filters.splice(r,1)[0].disconnect(),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}clone(n={}){if(!this.source||!this.gainNode||!this.context)throw new Error("Cannot clone a sound that has been cleaned up");const r=n.panType||this.panType,i=this.context.createGain();let o;if("buffer"in this.source&&this.source.buffer)o=this.context.createBufferSource(),o.buffer=this.source.buffer;else if("mediaElement"in this.source&&this.source.mediaElement)o=this.context.createMediaElementSource(this.source.mediaElement);else throw new Error("Unsupported source type");const s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=new S1(this.origin,o,i);return a.loopCount=s,a.currentLoop=this.currentLoop,a.setPanType(r,this.context),a.volume=this.volume,a.playbackRate=this._playbackRate,a._offset=this._offset,a._state=this._state,this._filters.forEach(l=>{const c=this.context.createBiquadFilter();c.type=l.type,c.frequency.value=l.frequency.value,c.Q.value=l.Q.value,c.gain.value=l.gain.value,a.addFilter(c)}),this._state===1&&a.play(),a}}let eh=class U2 extends F2(cu){constructor(n,r,i,o,s=$d.Buffer,a="HRTF"){super();L(this,"buffer");L(this,"context");L(this,"loopCount",0);L(this,"_playbackRate",1);this.url=n,this.globalGainNode=o,this.soundType=s,this.panType=a,this.buffer=r,this.context=i}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan,o=n.threeDOptions||this.threeDOptions,s=n.loopCount!==void 0?n.loopCount:this.loopCount,a=n.playbackRate||this.playbackRate,l=n.volume!==void 0?n.volume:this.volume,c=n.position!==void 0?n.position:this.position,u=n.filters&&n.filters.length?n.filters:this._filters,d=new U2(this.url,this.buffer,this.context,this.globalGainNode,this.soundType,r);return d.loop(s),d.playbackRate=a,d.volume=l,r==="HRTF"?(d.threeDOptions=o,d.position=c):d.stereoPan=i,d.addFilters(u),d}preplay(){let n;if(this.buffer)n=this.context.createBufferSource(),n.buffer=this.buffer;else{const o=new Audio;o.crossOrigin="anonymous",o.src=this.url,o.preload="auto",n=this.context.createMediaElementSource(o)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new S1(this,n,r);return i.setGainNode(r),i.volume=this.volume,i.playbackRate=this.playbackRate,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}seek(n){this.playbacks.forEach(r=>r.seek(n))}get duration(){var n;return this.playbacks.length>0?this.playbacks[0].duration:((n=this.buffer)==null?void 0:n.duration)||NaN}loop(n){return n===void 0?this.loopCount:(this.loopCount=n,this.playbacks.forEach(r=>r.loop(n)),this.loopCount)}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.playbacks.forEach(r=>r.playbackRate=n)}};function OL(t){class e extends L2{constructor(){super(...arguments);L(this,"_oscillatorOptions",{})}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(i){this._oscillatorOptions=i,this.source&&this.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type))}play(){if(!this.source)throw new Error("No source node found");return this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type),this.source.start(),this._playing=!0,[this]}stop(){this.source&&this.source.stop&&(this.source.stop(),this._playing=!1)}pause(){this.stop()}get frequency(){return this.source.frequency.value}set frequency(i){this.source.frequency.value=i,this.oscillatorOptions.frequency=i}get detune(){return this.source.detune.value}set detune(i){this.source.detune.value=i,this.oscillatorOptions.detune=i}get type(){return this.source.type}set type(i){this.source.type=i,this.oscillatorOptions.type=i}}return e}let ML=class extends OL(O2(M2(cu))){constructor(n,r,i){super();L(this,"context");this.origin=n,this.source=r,this.context=n.context,this.setPanType(n.panType,n.context),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}},LL=class V2 extends F2(cu){constructor(n,r,i=$d.Oscillator,o="HRTF",s={}){super();L(this,"_oscillatorOptions");L(this,"playbacks",[]);this.context=n,this.globalGainNode=r,this.soundType=i,this.panType=o,this.context=n,this._oscillatorOptions=s}clone(n={}){const r=n.panType||this.panType,i=n.stereoPan!==void 0?n.stereoPan:this.stereoPan??0,o=n.threeDOptions||this.threeDOptions,s=n.volume!==void 0?n.volume:this.volume,a=n.position&&n.position.length?n.position:this.position,l=n.filters&&n.filters.length?n.filters:this._filters,c=n.oscillatorOptions||this._oscillatorOptions,u=new V2(this.context,this.globalGainNode,this.soundType,r,c);return u._volume=s,u._position=a,u._stereoPan=i,u._threeDOptions=o,u.addFilters(l),u}preplay(){const n=this.context.createOscillator();this.oscillatorOptions.detune&&(n.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(n.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(n.type=this.oscillatorOptions.type);const r=this.context.createGain();r.connect(this.globalGainNode);const i=new ML(this,n,r);return i.volume=this.volume,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(n){this._oscillatorOptions=n,this.playbacks.forEach(r=>{r.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(r.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(r.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(r.source.type=this.oscillatorOptions.type))})}get frequency(){return this.oscillatorOptions.frequency||440}set frequency(n){this._oscillatorOptions.frequency=n,this.playbacks.forEach(r=>r.frequency=n)}get detune(){return this.oscillatorOptions.detune}set detune(n){this._oscillatorOptions.detune=n,this.playbacks.forEach(r=>r.detune=n)}get type(){return this.oscillatorOptions.type||"sine"}set type(n){this._oscillatorOptions.type=n,this.playbacks.forEach(r=>r.type=n)}};var $d=(t=>(t.HTML="HTML",t.Streaming="Streaming",t.Buffer="Buffer",t.Oscillator="oscillator",t))($d||{});let UL=class{constructor(e,n){L(this,"context");L(this,"globalGainNode");L(this,"listener");L(this,"prevVolume",1);L(this,"finalizationRegistry");L(this,"cache");L(this,"createBiquadFilter",({type:e,frequency:n,gain:r,Q:i})=>{n===void 0&&(n=350);const o=this.context.createBiquadFilter();return o.type=e||"lowpass",o.frequency.value=n,o.gain.value=r||0,o.Q.value=i||1,o});this.context=e||new AL,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.cache=n||new NL,this.finalizationRegistry=new FinalizationRegistry(r=>{r.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",PL):console.warn("AudioWorklet not supported")}async createWorkletNode(e,n){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new Mb(this.context,e)}catch(r){console.error(r),console.log("Loading worklet from url",n);try{await this.context.audioWorklet.addModule(n)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${n}`)}return new Mb(this.context,e)}}clearMemoryCache(){this.cache.clearMemoryCache()}createOscillator(e,n="HRTF"){return new LL(this.context,this.globalGainNode,"oscillator",n,e)}async createSound(e,n="Buffer",r="HRTF"){if(typeof e=="object")return Promise.resolve(new eh("",e,this.context,this.globalGainNode,"Buffer",r));const i=e;if(n==="HTML"){const o=new Audio;return o.src=i,o.crossOrigin="anonymous",new eh(i,void 0,this.context,this.globalGainNode,"HTML",r)}return this.cache.getAudioBuffer(this.context,i).then(o=>new eh(i,o,this.context,this.globalGainNode,n,r))}async createGroup(e){const n=new Vb;return e.forEach(r=>n.addSound(r)),n}async createGroupFromUrls(e,n="Buffer",r="HRTF"){const i=new Vb;return(await Promise.all(e.map(o=>this.createSound(o,n,r)))).forEach(o=>i.addSound(o)),i}async createStream(e){return new eh(e,void 0,this.context,this.globalGainNode,"Streaming")}createPanner({coneInnerAngle:e,coneOuterAngle:n,coneOuterGain:r,distanceModel:i,maxDistance:o,channelCount:s,channelCountMode:a,channelInterpretation:l,panningModel:c,refDistance:u,rolloffFactor:d,positionX:f,positionY:h,positionZ:p,orientationX:m,orientationY:C,orientationZ:v}){const g=this.context.createPanner();return g.coneInnerAngle=e||360,g.coneOuterAngle=n||360,g.coneOuterGain=r||0,g.distanceModel=i||"inverse",g.maxDistance=o||1e4,g.channelCount=s||2,g.channelCountMode=a||"clamped-max",g.channelInterpretation=l||"speakers",g.panningModel=c||"HRTF",g.refDistance=u||1,g.rolloffFactor=d||1,g.positionX.value=f||0,g.positionY.value=h||0,g.positionZ.value=p||0,g.orientationX.value=m||0,g.orientationY.value=C||0,g.orientationZ.value=v||0,g}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new FL(this.context);i.play(),e(i)}).catch(r=>{n(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:n,up:r}=e,[i,o,s]=n,[a,l,c]=r;this.listener.forwardX.value=i,this.listener.forwardY.value=o,this.listener.forwardZ.value=s,this.listener.upX.value=a,this.listener.upY.value=l,this.listener.upZ.value=c}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[n,r,i]=e;this.listener.upX.value=n,this.listener.upY.value=r,this.listener.upZ.value=i}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[n,r,i]=e;this.listener.forwardX.value=n,this.listener.forwardY.value=r,this.listener.forwardZ.value=i}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[n,r,i]=e,o=this.context.currentTime;this.listener.positionX.setValueAtTime(n,o),this.listener.positionY.setValueAtTime(r,o),this.listener.positionZ.setValueAtTime(i,o)}};const VL="https://mongoose.world:9080/?url=";class GL extends eo{constructor(){super(...arguments);L(this,"packageName","Client.Media");L(this,"sounds",{});L(this,"defaultUrl","")}handleDefault(n){this.defaultUrl=n}async handleLoad(n){const r=(n.url||this.defaultUrl)+n.name,i=n.url+n.name;if(!this.sounds[i]){let s=await this.client.cacophony.createSound(r);s.key=i,this.sounds[i]=s}}mediaUrl(n){var i;let r=(n.url||this.defaultUrl)+n.name;return((i=n.type)==null?void 0:i.toLowerCase())==="music"&&(r=VL+encodeURIComponent(r)),r}async handlePlay(n){let r=this.mediaUrl(n);n.key=n.key||r;let i=this.sounds[n.key];const o=n.is3d?"HRTF":"stereo";if((!i||i.url!==r)&&(n.type==="music"?i=await this.client.cacophony.createSound(r,$d.HTML,o):i=await this.client.cacophony.createSound(r,$d.Buffer,o)),n.volume!==void 0&&(i.volume=n.volume/100),n.loops!==void 0){const s=n.loops===-1?1/0:n.loops-1;i.loop(s)}if(n.start&&i.seek(n.start/1e3),n.end&&setTimeout(()=>{delete this.sounds[i.key],i.stop()},n.end),n.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[n.position[0],n.position[1],n.position[2]]),n.priority){for(let s in this.sounds){const a=this.sounds[s];a.priority&&a.priority<n.priority&&a.stop()}i.priority=n.priority}i.isPlaying||(i.play()[0],n.fadein,n.fadeout),i.key=n.key,this.sounds[i.key]=i}handleStop(n){n.name&&this.soundsByName(n.name).forEach(r=>this.stopSound(r)),n.type&&this.soundsByType(n.type).forEach(r=>this.stopSound(r)),n.tag&&this.soundsByTag(n.tag).forEach(r=>this.stopSound(r)),n.key&&this.soundsByKey(n.key).forEach(r=>this.stopSound(r)),!n.name&&!n.type&&!n.tag&&!n.key&&(this.allSounds.forEach(r=>r.stop()),this.sounds={})}stopSound(n){delete this.sounds[n.key],n.stop()}handleListenerPosition(n){var r;(r=n.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=n.position)}handleListenerOrientation(n){n.up&&n.up.length&&(this.client.cacophony.listenerUpOrientation=n.up),n.forward&&n.forward.length&&(this.client.cacophony.listenerForwardOrientation=n.forward)}soundsByName(n){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(n))}soundsByKey(n){return Object.values(this.sounds).filter(r=>r.key===n)}soundsByTag(n){return Object.values(this.sounds).filter(r=>r.tag===n)}soundsByType(n){return Object.values(this.sounds).filter(r=>r.mediaType===n)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(n=>n.stop()),this.sounds={}}}class WL extends eo{constructor(){super(...arguments);L(this,"packageName","Client.Speech")}handleSpeak(n){const r=new SpeechSynthesisUtterance(n.text);r.rate=n.rate,r.pitch=n.pitch,r.volume=n.volume,speechSynthesis.speak(r)}}class zL extends eo{constructor(){super(...arguments);L(this,"packageName","Comm.Channel");L(this,"channels",[])}handleList(n){this.channels=n}sendList(){this.sendData("List")}handleText(n){n.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${n.talker}`,`${n.text}`))}}class G2 extends eo{constructor(){super(...arguments);L(this,"packageName","Client.FileTransfer")}sendCandidate(n,r){this.sendData("Candidate",{recipient:n,candidate:JSON.stringify(r)})}handleCandidate(n){const r=JSON.parse(n.candidate);this.client.webRTCService.handleIceCandidate(r)}handleOffer(n){console.log("[GMCPClientFileTransfer] Received offer:",n),this.client.fileTransferManager.pendingOffers.set(`${n.hash}`,n),this.client.onFileTransferOffer(n.sender,n.hash,n.filename,n.filesize,n.offerSdp)}handleAccept(n){this.client.onFileTransferAccept(n.sender,n.hash,n.filename,n.answerSdp)}handleReject(n){this.client.onFileTransferReject(n.sender,n.hash)}handleCancel(n){this.client.onFileTransferCancel(n.sender,n.hash)}sendOffer(n,r,i,o,s){this.sendData("Offer",{recipient:n,filename:r,filesize:i,offerSdp:o,hash:s})}sendAccept(n,r,i,o){this.sendData("Accept",{sender:n,hash:r,filename:i,answerSdp:o})}sendReject(n,r){this.sendData("Reject",{sender:n,hash:r})}sendCancel(n,r){this.sendData("Cancel",{recipient:n,hash:r})}sendRequestResend(n,r){this.sendData("RequestResend",{sender:n,hash:r})}}class jL extends eo{constructor(){super(...arguments);L(this,"packageName","Comm.LiveKit")}handleroom_token(n){this.client.worldData.liveKitTokens.push(n.token),this.client.emit("livekitToken",n.token)}handleroom_leave(n){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==n.token),this.client.emit("livekitLeave",n.token)}}class HL extends eo{constructor(){super(...arguments);L(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}}class ZL extends eo{constructor(){super(...arguments);L(this,"packageName","Core.Supports")}sendSet(){const n=Object.values(this.client.gmcpHandlers).map(r=>r.packageName+" "+r.packageVersion.toString());this.sendData("Set",n)}}function k1(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Ll=k1();function W2(t){Ll=t}const vd={exec:()=>null};function gt(t,e=""){let n=typeof t=="string"?t:t.source;const r={replace:(i,o)=>{let s=typeof o=="string"?o:o.source;return s=s.replace(ar.caret,"$1"),n=n.replace(i,s),r},getRegex:()=>new RegExp(n,e)};return r}const ar={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},$L=/^(?:[ \t]*(?:\n|$))+/,XL=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,KL=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Tf=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,JL=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,E1=/(?:[*+-]|\d{1,9}[.)])/,z2=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,j2=gt(z2).replace(/bull/g,E1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),YL=gt(z2).replace(/bull/g,E1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),T1=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,qL=/^[^\n]+/,R1=/(?!\s*\])(?:\\.|[^\[\]\\])+/,QL=gt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",R1).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),e6=gt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,E1).getRegex(),Np="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_1=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,t6=gt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",_1).replace("tag",Np).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),H2=gt(T1).replace("hr",Tf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Np).getRegex(),n6=gt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",H2).getRegex(),D1={blockquote:n6,code:XL,def:QL,fences:KL,heading:JL,hr:Tf,html:t6,lheading:j2,list:e6,newline:$L,paragraph:H2,table:vd,text:qL},Wb=gt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Tf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Np).getRegex(),r6={...D1,lheading:YL,table:Wb,paragraph:gt(T1).replace("hr",Tf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Wb).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Np).getRegex()},i6={...D1,html:gt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",_1).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:vd,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:gt(T1).replace("hr",Tf).replace("heading",` *#{1,6} *[^
]`).replace("lheading",j2).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},o6=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,s6=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Z2=/^( {2,}|\\)\n(?!\s*$)/,a6=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Bp=/[\p{P}\p{S}]/u,P1=/[\s\p{P}\p{S}]/u,$2=/[^\s\p{P}\p{S}]/u,l6=gt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,P1).getRegex(),X2=/(?!~)[\p{P}\p{S}]/u,c6=/(?!~)[\s\p{P}\p{S}]/u,u6=/(?:[^\s\p{P}\p{S}]|~)/u,d6=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,K2=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,f6=gt(K2,"u").replace(/punct/g,Bp).getRegex(),h6=gt(K2,"u").replace(/punct/g,X2).getRegex(),J2="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",p6=gt(J2,"gu").replace(/notPunctSpace/g,$2).replace(/punctSpace/g,P1).replace(/punct/g,Bp).getRegex(),g6=gt(J2,"gu").replace(/notPunctSpace/g,u6).replace(/punctSpace/g,c6).replace(/punct/g,X2).getRegex(),m6=gt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,$2).replace(/punctSpace/g,P1).replace(/punct/g,Bp).getRegex(),v6=gt(/\\(punct)/,"gu").replace(/punct/g,Bp).getRegex(),C6=gt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),y6=gt(_1).replace("(?:-->|$)","-->").getRegex(),x6=gt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",y6).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),F0=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,I6=gt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",F0).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Y2=gt(/^!?\[(label)\]\[(ref)\]/).replace("label",F0).replace("ref",R1).getRegex(),q2=gt(/^!?\[(ref)\](?:\[\])?/).replace("ref",R1).getRegex(),b6=gt("reflink|nolink(?!\\()","g").replace("reflink",Y2).replace("nolink",q2).getRegex(),N1={_backpedal:vd,anyPunctuation:v6,autolink:C6,blockSkip:d6,br:Z2,code:s6,del:vd,emStrongLDelim:f6,emStrongRDelimAst:p6,emStrongRDelimUnd:m6,escape:o6,link:I6,nolink:q2,punctuation:l6,reflink:Y2,reflinkSearch:b6,tag:x6,text:a6,url:vd},A6={...N1,link:gt(/^!?\[(label)\]\((.*?)\)/).replace("label",F0).getRegex(),reflink:gt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",F0).getRegex()},oC={...N1,emStrongRDelimAst:g6,emStrongLDelim:h6,url:gt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},w6={...oC,br:gt(Z2).replace("{2,}","*").getRegex(),text:gt(oC.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},th={normal:D1,gfm:r6,pedantic:i6},Nu={normal:N1,gfm:oC,breaks:w6,pedantic:A6},S6={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},zb=t=>S6[t];function so(t,e){if(e){if(ar.escapeTest.test(t))return t.replace(ar.escapeReplace,zb)}else if(ar.escapeTestNoEncode.test(t))return t.replace(ar.escapeReplaceNoEncode,zb);return t}function jb(t){try{t=encodeURI(t).replace(ar.percentDecode,"%")}catch{return null}return t}function Hb(t,e){var o;const n=t.replace(ar.findPipe,(s,a,l)=>{let c=!1,u=a;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(ar.splitPipe);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!((o=r.at(-1))!=null&&o.trim())&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(ar.slashPipe,"|");return r}function Bu(t,e,n){const r=t.length;if(r===0)return"";let i=0;for(;i<r&&t.charAt(r-i-1)===e;)i++;return t.slice(0,r-i)}function k6(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&(n--,n<0))return r;return-1}function Zb(t,e,n,r,i){const o=e.href,s=e.title||null,a=t[1].replace(i.other.outputLinkReplace,"$1");if(t[0].charAt(0)!=="!"){r.state.inLink=!0;const l={type:"link",raw:n,href:o,title:s,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,l}return{type:"image",raw:n,href:o,title:s,text:a}}function E6(t,e,n){const r=t.match(n.other.indentCodeCompensation);if(r===null)return e;const i=r[1];return e.split(`
`).map(o=>{const s=o.match(n.other.beginningSpace);if(s===null)return o;const[a]=s;return a.length>=i.length?o.slice(i.length):o}).join(`
`)}class O0{constructor(e){L(this,"options");L(this,"rules");L(this,"lexer");this.options=e||Ll}space(e){const n=this.rules.block.newline.exec(e);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(e){const n=this.rules.block.code.exec(e);if(n){const r=n[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Bu(r,`
`)}}}fences(e){const n=this.rules.block.fences.exec(e);if(n){const r=n[0],i=E6(r,n[3]||"",this.rules);return{type:"code",raw:r,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:i}}}heading(e){const n=this.rules.block.heading.exec(e);if(n){let r=n[2].trim();if(this.rules.other.endingHash.test(r)){const i=Bu(r,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(r=i.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const n=this.rules.block.hr.exec(e);if(n)return{type:"hr",raw:Bu(n[0],`
`)}}blockquote(e){const n=this.rules.block.blockquote.exec(e);if(n){let r=Bu(n[0],`
`).split(`
`),i="",o="";const s=[];for(;r.length>0;){let a=!1;const l=[];let c;for(c=0;c<r.length;c++)if(this.rules.other.blockquoteStart.test(r[c]))l.push(r[c]),a=!0;else if(!a)l.push(r[c]);else break;r=r.slice(c);const u=l.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${u}`:u,o=o?`${o}
${d}`:d;const f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,s,!0),this.lexer.state.top=f,r.length===0)break;const h=s.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const p=h,m=p.raw+`
`+r.join(`
`),C=this.blockquote(m);s[s.length-1]=C,i=i.substring(0,i.length-p.raw.length)+C.raw,o=o.substring(0,o.length-p.text.length)+C.text;break}else if((h==null?void 0:h.type)==="list"){const p=h,m=p.raw+`
`+r.join(`
`),C=this.list(m);s[s.length-1]=C,i=i.substring(0,i.length-h.raw.length)+C.raw,o=o.substring(0,o.length-p.raw.length)+C.raw,r=m.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:s,text:o}}}list(e){let n=this.rules.block.list.exec(e);if(n){let r=n[1].trim();const i=r.length>1,o={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const s=this.rules.other.listItemRegex(r);let a=!1;for(;e;){let c=!1,u="",d="";if(!(n=s.exec(e))||this.rules.block.hr.test(e))break;u=n[0],e=e.substring(u.length);let f=n[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,g=>" ".repeat(3*g.length)),h=e.split(`
`,1)[0],p=!f.trim(),m=0;if(this.options.pedantic?(m=2,d=f.trimStart()):p?m=n[1].length+1:(m=n[2].search(this.rules.other.nonSpaceChar),m=m>4?1:m,d=f.slice(m),m+=n[1].length),p&&this.rules.other.blankLine.test(h)&&(u+=h+`
`,e=e.substring(h.length+1),c=!0),!c){const g=this.rules.other.nextBulletRegex(m),y=this.rules.other.hrRegex(m),I=this.rules.other.fencesBeginRegex(m),b=this.rules.other.headingBeginRegex(m),E=this.rules.other.htmlBeginRegex(m);for(;e;){const w=e.split(`
`,1)[0];let k;if(h=w,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),k=h):k=h.replace(this.rules.other.tabCharGlobal,"    "),I.test(h)||b.test(h)||E.test(h)||g.test(h)||y.test(h))break;if(k.search(this.rules.other.nonSpaceChar)>=m||!h.trim())d+=`
`+k.slice(m);else{if(p||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||I.test(f)||b.test(f)||y.test(f))break;d+=`
`+h}!p&&!h.trim()&&(p=!0),u+=w+`
`,e=e.substring(w.length+1),f=k.slice(m)}}o.loose||(a?o.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(a=!0));let C=null,v;this.options.gfm&&(C=this.rules.other.listIsTask.exec(d),C&&(v=C[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),o.items.push({type:"list_item",raw:u,task:!!C,checked:v,loose:!1,text:d,tokens:[]}),o.raw+=u}const l=o.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;o.raw=o.raw.trimEnd();for(let c=0;c<o.items.length;c++)if(this.lexer.state.top=!1,o.items[c].tokens=this.lexer.blockTokens(o.items[c].text,[]),!o.loose){const u=o.items[c].tokens.filter(f=>f.type==="space"),d=u.length>0&&u.some(f=>this.rules.other.anyLine.test(f.raw));o.loose=d}if(o.loose)for(let c=0;c<o.items.length;c++)o.items[c].loose=!0;return o}}html(e){const n=this.rules.block.html.exec(e);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(e){const n=this.rules.block.def.exec(e);if(n){const r=n[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=n[2]?n[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:r,raw:n[0],href:i,title:o}}}table(e){var a;const n=this.rules.block.table.exec(e);if(!n||!this.rules.other.tableDelimiter.test(n[2]))return;const r=Hb(n[1]),i=n[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=(a=n[3])!=null&&a.trim()?n[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:n[0],header:[],align:[],rows:[]};if(r.length===i.length){for(const l of i)this.rules.other.tableAlignRight.test(l)?s.align.push("right"):this.rules.other.tableAlignCenter.test(l)?s.align.push("center"):this.rules.other.tableAlignLeft.test(l)?s.align.push("left"):s.align.push(null);for(let l=0;l<r.length;l++)s.header.push({text:r[l],tokens:this.lexer.inline(r[l]),header:!0,align:s.align[l]});for(const l of o)s.rows.push(Hb(l,s.header.length).map((c,u)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:s.align[u]})));return s}}lheading(e){const n=this.rules.block.lheading.exec(e);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(e){const n=this.rules.block.paragraph.exec(e);if(n){const r=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const n=this.rules.block.text.exec(e);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(e){const n=this.rules.inline.escape.exec(e);if(n)return{type:"escape",raw:n[0],text:n[1]}}tag(e){const n=this.rules.inline.tag.exec(e);if(n)return!this.lexer.state.inLink&&this.rules.other.startATag.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(e){const n=this.rules.inline.link.exec(e);if(n){const r=n[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;const s=Bu(r.slice(0,-1),"\\");if((r.length-s.length)%2===0)return}else{const s=k6(n[2],"()");if(s>-1){const l=(n[0].indexOf("!")===0?5:4)+n[1].length+s;n[2]=n[2].substring(0,s),n[0]=n[0].substring(0,l).trim(),n[3]=""}}let i=n[2],o="";if(this.options.pedantic){const s=this.rules.other.pedanticHrefTitle.exec(i);s&&(i=s[1],o=s[3])}else o=n[3]?n[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?i=i.slice(1):i=i.slice(1,-1)),Zb(n,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer,this.rules)}}reflink(e,n){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const i=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),o=n[i.toLowerCase()];if(!o){const s=r[0].charAt(0);return{type:"text",raw:s,text:s}}return Zb(r,o,r[0],this.lexer,this.rules)}}emStrong(e,n,r=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!i||i[3]&&r.match(this.rules.other.unicodeAlphaNumeric))return;if(!(i[1]||i[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const s=[...i[0]].length-1;let a,l,c=s,u=0;const d=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,n=n.slice(-1*e.length+s);(i=d.exec(n))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(l=[...a].length,i[3]||i[4]){c+=l;continue}else if((i[5]||i[6])&&s%3&&!((s+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);const f=[...i[0]][0].length,h=e.slice(0,s+i.index+f+l);if(Math.min(s,l)%2){const m=h.slice(1,-1);return{type:"em",raw:h,text:m,tokens:this.lexer.inlineTokens(m)}}const p=h.slice(2,-2);return{type:"strong",raw:h,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const n=this.rules.inline.code.exec(e);if(n){let r=n[2].replace(this.rules.other.newLineCharGlobal," ");const i=this.rules.other.nonSpaceChar.test(r),o=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return i&&o&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:n[0],text:r}}}br(e){const n=this.rules.inline.br.exec(e);if(n)return{type:"br",raw:n[0]}}del(e){const n=this.rules.inline.del.exec(e);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(e){const n=this.rules.inline.autolink.exec(e);if(n){let r,i;return n[2]==="@"?(r=n[1],i="mailto:"+r):(r=n[1],i=r),{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var r;let n;if(n=this.rules.inline.url.exec(e)){let i,o;if(n[2]==="@")i=n[0],o="mailto:"+i;else{let s;do s=n[0],n[0]=((r=this.rules.inline._backpedal.exec(n[0]))==null?void 0:r[0])??"";while(s!==n[0]);i=n[0],n[1]==="www."?o="http://"+n[0]:o=n[0]}return{type:"link",raw:n[0],text:i,href:o,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const n=this.rules.inline.text.exec(e);if(n){const r=this.lexer.state.inRawBlock;return{type:"text",raw:n[0],text:n[0],escaped:r}}}}class di{constructor(e){L(this,"tokens");L(this,"options");L(this,"state");L(this,"tokenizer");L(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ll,this.options.tokenizer=this.options.tokenizer||new O0,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:ar,block:th.normal,inline:Nu.normal};this.options.pedantic?(n.block=th.pedantic,n.inline=Nu.pedantic):this.options.gfm&&(n.block=th.gfm,this.options.breaks?n.inline=Nu.breaks:n.inline=Nu.gfm),this.tokenizer.rules=n}static get rules(){return{block:th,inline:Nu}}static lex(e,n){return new di(n).lex(e)}static lexInline(e,n){return new di(n).inlineTokens(e)}lex(e){e=e.replace(ar.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],r=!1){var i,o,s;for(this.options.pedantic&&(e=e.replace(ar.tabCharGlobal,"    ").replace(ar.spaceLine,""));e;){let a;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(c=>(a=c.call({lexer:this},e,n))?(e=e.substring(a.raw.length),n.push(a),!0):!1))continue;if(a=this.tokenizer.space(e)){e=e.substring(a.raw.length);const c=n.at(-1);a.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(a);continue}if(a=this.tokenizer.code(e)){e=e.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.at(-1).src=c.text):n.push(a);continue}if(a=this.tokenizer.fences(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.heading(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.hr(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.blockquote(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.list(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.html(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.def(e)){e=e.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if(a=this.tokenizer.table(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.lheading(e)){e=e.substring(a.raw.length),n.push(a);continue}let l=e;if((s=this.options.extensions)!=null&&s.startBlock){let c=1/0;const u=e.slice(1);let d;this.options.extensions.startBlock.forEach(f=>{d=f.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=e.substring(0,c+1))}if(this.state.top&&(a=this.tokenizer.paragraph(l))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(a),r=l.length!==e.length,e=e.substring(a.raw.length);continue}if(a=this.tokenizer.text(e)){e=e.substring(a.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(a);continue}if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var a,l,c;let r=e,i=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o=!1,s="";for(;e;){o||(s=""),o=!1;let u;if((l=(a=this.options.extensions)==null?void 0:a.inline)!=null&&l.some(f=>(u=f.call({lexer:this},e,n))?(e=e.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(u.raw.length);const f=n.at(-1);u.type==="text"&&(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(e,r,s)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(e)){e=e.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(e))){e=e.substring(u.raw.length),n.push(u);continue}let d=e;if((c=this.options.extensions)!=null&&c.startInline){let f=1/0;const h=e.slice(1);let p;this.options.extensions.startInline.forEach(m=>{p=m.call({lexer:this},h),typeof p=="number"&&p>=0&&(f=Math.min(f,p))}),f<1/0&&f>=0&&(d=e.substring(0,f+1))}if(u=this.tokenizer.inlineText(d)){e=e.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(s=u.raw.slice(-1)),o=!0;const f=n.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):n.push(u);continue}if(e){const f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return n}}class M0{constructor(e){L(this,"options");L(this,"parser");this.options=e||Ll}space(e){return""}code({text:e,lang:n,escaped:r}){var s;const i=(s=(n||"").match(ar.notSpaceStart))==null?void 0:s[0],o=e.replace(ar.endingNewline,"")+`
`;return i?'<pre><code class="language-'+so(i)+'">'+(r?o:so(o,!0))+`</code></pre>
`:"<pre><code>"+(r?o:so(o,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:n}){return`<h${n}>${this.parser.parseInline(e)}</h${n}>
`}hr(e){return`<hr>
`}list(e){const n=e.ordered,r=e.start;let i="";for(let a=0;a<e.items.length;a++){const l=e.items[a];i+=this.listitem(l)}const o=n?"ol":"ul",s=n&&r!==1?' start="'+r+'"':"";return"<"+o+s+`>
`+i+"</"+o+`>
`}listitem(e){var r;let n="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?((r=e.tokens[0])==null?void 0:r.type)==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+so(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):n+=i+" "}return n+=this.parser.parse(e.tokens,!!e.loose),`<li>${n}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let n="",r="";for(let o=0;o<e.header.length;o++)r+=this.tablecell(e.header[o]);n+=this.tablerow({text:r});let i="";for(let o=0;o<e.rows.length;o++){const s=e.rows[o];r="";for(let a=0;a<s.length;a++)r+=this.tablecell(s[a]);i+=this.tablerow({text:r})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const n=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+n+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${so(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:n,tokens:r}){const i=this.parser.parseInline(r),o=jb(e);if(o===null)return i;e=o;let s='<a href="'+e+'"';return n&&(s+=' title="'+so(n)+'"'),s+=">"+i+"</a>",s}image({href:e,title:n,text:r}){const i=jb(e);if(i===null)return so(r);e=i;let o=`<img src="${e}" alt="${r}"`;return n&&(o+=` title="${so(n)}"`),o+=">",o}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:so(e.text)}}class B1{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class fi{constructor(e){L(this,"options");L(this,"renderer");L(this,"textRenderer");this.options=e||Ll,this.options.renderer=this.options.renderer||new M0,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new B1}static parse(e,n){return new fi(n).parse(e)}static parseInline(e,n){return new fi(n).parseInline(e)}parse(e,n=!0){var i,o;let r="";for(let s=0;s<e.length;s++){const a=e[s];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[a.type]){const c=a,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const l=a;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;s+1<e.length&&e[s+1].type==="text";)c=e[++s],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(e,n=this.renderer){var i,o;let r="";for(let s=0;s<e.length;s++){const a=e[s];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[a.type]){const c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=c||"";continue}}const l=a;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}}class Cd{constructor(e){L(this,"options");L(this,"block");this.options=e||Ll}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?di.lex:di.lexInline}provideParser(){return this.block?fi.parse:fi.parseInline}}L(Cd,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class T6{constructor(...e){L(this,"defaults",k1());L(this,"options",this.setOptions);L(this,"parse",this.parseMarkdown(!0));L(this,"parseInline",this.parseMarkdown(!1));L(this,"Parser",fi);L(this,"Renderer",M0);L(this,"TextRenderer",B1);L(this,"Lexer",di);L(this,"Tokenizer",O0);L(this,"Hooks",Cd);this.use(...e)}walkTokens(e,n){var i,o;let r=[];for(const s of e)switch(r=r.concat(n.call(this,s)),s.type){case"table":{const a=s;for(const l of a.header)r=r.concat(this.walkTokens(l.tokens,n));for(const l of a.rows)for(const c of l)r=r.concat(this.walkTokens(c.tokens,n));break}case"list":{const a=s;r=r.concat(this.walkTokens(a.items,n));break}default:{const a=s;(o=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&o[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{const c=a[l].flat(1/0);r=r.concat(this.walkTokens(c,n))}):a.tokens&&(r=r.concat(this.walkTokens(a.tokens,n)))}}return r}use(...e){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){const s=n.renderers[o.name];s?n.renderers[o.name]=function(...a){let l=o.renderer.apply(this,a);return l===!1&&(l=s.apply(this,a)),l}:n.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=n[o.level];s?s.unshift(o.tokenizer):n[o.level]=[o.tokenizer],o.start&&(o.level==="block"?n.startBlock?n.startBlock.push(o.start):n.startBlock=[o.start]:o.level==="inline"&&(n.startInline?n.startInline.push(o.start):n.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(n.childTokens[o.name]=o.childTokens)}),i.extensions=n),r.renderer){const o=this.defaults.renderer||new M0(this.defaults);for(const s in r.renderer){if(!(s in o))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const a=s,l=r.renderer[a],c=o[a];o[a]=(...u)=>{let d=l.apply(o,u);return d===!1&&(d=c.apply(o,u)),d||""}}i.renderer=o}if(r.tokenizer){const o=this.defaults.tokenizer||new O0(this.defaults);for(const s in r.tokenizer){if(!(s in o))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const a=s,l=r.tokenizer[a],c=o[a];o[a]=(...u)=>{let d=l.apply(o,u);return d===!1&&(d=c.apply(o,u)),d}}i.tokenizer=o}if(r.hooks){const o=this.defaults.hooks||new Cd;for(const s in r.hooks){if(!(s in o))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const a=s,l=r.hooks[a],c=o[a];Cd.passThroughHooks.has(s)?o[a]=u=>{if(this.defaults.async)return Promise.resolve(l.call(o,u)).then(f=>c.call(o,f));const d=l.call(o,u);return c.call(o,d)}:o[a]=(...u)=>{let d=l.apply(o,u);return d===!1&&(d=c.apply(o,u)),d}}i.hooks=o}if(r.walkTokens){const o=this.defaults.walkTokens,s=r.walkTokens;i.walkTokens=function(a){let l=[];return l.push(s.call(this,a)),o&&(l=l.concat(o.call(this,a))),l}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,n){return di.lex(e,n??this.defaults)}parser(e,n){return fi.parse(e,n??this.defaults)}parseMarkdown(e){return(r,i)=>{const o={...i},s={...this.defaults,...o},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&o.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof r>"u"||r===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=e);const l=s.hooks?s.hooks.provideLexer():e?di.lex:di.lexInline,c=s.hooks?s.hooks.provideParser():e?fi.parse:fi.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(r):r).then(u=>l(u,s)).then(u=>s.hooks?s.hooks.processAllTokens(u):u).then(u=>s.walkTokens?Promise.all(this.walkTokens(u,s.walkTokens)).then(()=>u):u).then(u=>c(u,s)).then(u=>s.hooks?s.hooks.postprocess(u):u).catch(a);try{s.hooks&&(r=s.hooks.preprocess(r));let u=l(r,s);s.hooks&&(u=s.hooks.processAllTokens(u)),s.walkTokens&&this.walkTokens(u,s.walkTokens);let d=c(u,s);return s.hooks&&(d=s.hooks.postprocess(d)),d}catch(u){return a(u)}}}onError(e,n){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+so(r.message+"",!0)+"</pre>";return n?Promise.resolve(i):i}if(n)return Promise.reject(r);throw r}}}const Sl=new T6;function Ct(t,e){return Sl.parse(t,e)}Ct.options=Ct.setOptions=function(t){return Sl.setOptions(t),Ct.defaults=Sl.defaults,W2(Ct.defaults),Ct};Ct.getDefaults=k1;Ct.defaults=Ll;Ct.use=function(...t){return Sl.use(...t),Ct.defaults=Sl.defaults,W2(Ct.defaults),Ct};Ct.walkTokens=function(t,e){return Sl.walkTokens(t,e)};Ct.parseInline=Sl.parseInline;Ct.Parser=fi;Ct.parser=fi.parse;Ct.Renderer=M0;Ct.TextRenderer=B1;Ct.Lexer=di;Ct.lexer=di.lex;Ct.Tokenizer=O0;Ct.Hooks=Cd;Ct.parse=Ct;Ct.options;Ct.setOptions;Ct.use;Ct.walkTokens;Ct.parseInline;fi.parse;di.lex;class R6 extends eo{constructor(n){super(n);L(this,"packageName","Client.Html")}handleAdd_html(n){this.client.emit("html",n.data.join(`
`))}handleAdd_markdown(n){const r=n.data.join(`
`),i=Ct(r);this.client.emit("html",i)}}const Jl=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Q2=new Set,sC=typeof process=="object"&&process?process:{},eR=(t,e,n,r)=>{typeof sC.emitWarning=="function"?sC.emitWarning(t,e,n,r):console.error(`[${n}] ${e}: ${t}`)};let L0=globalThis.AbortController,$b=globalThis.AbortSignal;var nk;if(typeof L0>"u"){$b=class{constructor(){L(this,"onabort");L(this,"_onabort",[]);L(this,"reason");L(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},L0=class{constructor(){L(this,"signal",new $b);e()}abort(r){var i,o;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const s of this.signal._onabort)s(r);(o=(i=this.signal).onabort)==null||o.call(i,r)}}};let t=((nk=sC.env)==null?void 0:nk.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{t&&(t=!1,eR("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const _6=t=>!Q2.has(t),qs=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),tR=t=>qs(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?Rh:null:null;class Rh extends Array{constructor(e){super(e),this.fill(0)}}var Pc;const nl=class nl{constructor(e,n){L(this,"heap");L(this,"length");if(!O(nl,Pc))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(e),this.length=0}static create(e){const n=tR(e);if(!n)return[];Fe(nl,Pc,!0);const r=new nl(e,n);return Fe(nl,Pc,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};Pc=new WeakMap,ct(nl,Pc,!1);let aC=nl;var rk,ik,Ei,Mr,Ti,Ri,Nc,Bc,hn,_i,ln,Ft,Ge,er,Lr,Zn,An,Di,wn,Pi,Ni,Ur,Bi,ca,tr,ve,cC,ul,Qo,df,Vr,nR,dl,Fc,ff,Qs,ea,uC,_h,Dh,Bt,dC,ed,ta,fC;const Gx=class Gx{constructor(e){ct(this,ve);ct(this,Ei);ct(this,Mr);ct(this,Ti);ct(this,Ri);ct(this,Nc);ct(this,Bc);L(this,"ttl");L(this,"ttlResolution");L(this,"ttlAutopurge");L(this,"updateAgeOnGet");L(this,"updateAgeOnHas");L(this,"allowStale");L(this,"noDisposeOnSet");L(this,"noUpdateTTL");L(this,"maxEntrySize");L(this,"sizeCalculation");L(this,"noDeleteOnFetchRejection");L(this,"noDeleteOnStaleGet");L(this,"allowStaleOnFetchAbort");L(this,"allowStaleOnFetchRejection");L(this,"ignoreFetchAbort");ct(this,hn);ct(this,_i);ct(this,ln);ct(this,Ft);ct(this,Ge);ct(this,er);ct(this,Lr);ct(this,Zn);ct(this,An);ct(this,Di);ct(this,wn);ct(this,Pi);ct(this,Ni);ct(this,Ur);ct(this,Bi);ct(this,ca);ct(this,tr);ct(this,ul,()=>{});ct(this,Qo,()=>{});ct(this,df,()=>{});ct(this,Vr,()=>!1);ct(this,dl,e=>{});ct(this,Fc,(e,n,r)=>{});ct(this,ff,(e,n,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});L(this,rk,"LRUCache");const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:s,updateAgeOnHas:a,allowStale:l,dispose:c,disposeAfter:u,noDisposeOnSet:d,noUpdateTTL:f,maxSize:h=0,maxEntrySize:p=0,sizeCalculation:m,fetchMethod:C,memoMethod:v,noDeleteOnFetchRejection:g,noDeleteOnStaleGet:y,allowStaleOnFetchRejection:I,allowStaleOnFetchAbort:b,ignoreFetchAbort:E}=e;if(n!==0&&!qs(n))throw new TypeError("max option must be a nonnegative integer");const w=n?tR(n):Array;if(!w)throw new Error("invalid max value: "+n);if(Fe(this,Ei,n),Fe(this,Mr,h),this.maxEntrySize=p||O(this,Mr),this.sizeCalculation=m,this.sizeCalculation){if(!O(this,Mr)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(v!==void 0&&typeof v!="function")throw new TypeError("memoMethod must be a function if defined");if(Fe(this,Bc,v),C!==void 0&&typeof C!="function")throw new TypeError("fetchMethod must be a function if specified");if(Fe(this,Nc,C),Fe(this,ca,!!C),Fe(this,ln,new Map),Fe(this,Ft,new Array(n).fill(void 0)),Fe(this,Ge,new Array(n).fill(void 0)),Fe(this,er,new w(n)),Fe(this,Lr,new w(n)),Fe(this,Zn,0),Fe(this,An,0),Fe(this,Di,aC.create(n)),Fe(this,hn,0),Fe(this,_i,0),typeof c=="function"&&Fe(this,Ti,c),typeof u=="function"?(Fe(this,Ri,u),Fe(this,wn,[])):(Fe(this,Ri,void 0),Fe(this,wn,void 0)),Fe(this,Bi,!!O(this,Ti)),Fe(this,tr,!!O(this,Ri)),this.noDisposeOnSet=!!d,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!g,this.allowStaleOnFetchRejection=!!I,this.allowStaleOnFetchAbort=!!b,this.ignoreFetchAbort=!!E,this.maxEntrySize!==0){if(O(this,Mr)!==0&&!qs(O(this,Mr)))throw new TypeError("maxSize must be a positive integer if specified");if(!qs(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Ee(this,ve,nR).call(this)}if(this.allowStale=!!l,this.noDeleteOnStaleGet=!!y,this.updateAgeOnGet=!!s,this.updateAgeOnHas=!!a,this.ttlResolution=qs(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=r||0,this.ttl){if(!qs(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Ee(this,ve,cC).call(this)}if(O(this,Ei)===0&&this.ttl===0&&O(this,Mr)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!O(this,Ei)&&!O(this,Mr)){const k="LRU_CACHE_UNBOUNDED";_6(k)&&(Q2.add(k),eR("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",k,Gx))}}static unsafeExposeInternals(e){return{starts:O(e,Ni),ttls:O(e,Ur),sizes:O(e,Pi),keyMap:O(e,ln),keyList:O(e,Ft),valList:O(e,Ge),next:O(e,er),prev:O(e,Lr),get head(){return O(e,Zn)},get tail(){return O(e,An)},free:O(e,Di),isBackgroundFetch:n=>{var r;return Ee(r=e,ve,Bt).call(r,n)},backgroundFetch:(n,r,i,o)=>{var s;return Ee(s=e,ve,Dh).call(s,n,r,i,o)},moveToTail:n=>{var r;return Ee(r=e,ve,ed).call(r,n)},indexes:n=>{var r;return Ee(r=e,ve,Qs).call(r,n)},rindexes:n=>{var r;return Ee(r=e,ve,ea).call(r,n)},isStale:n=>{var r;return O(r=e,Vr).call(r,n)}}}get max(){return O(this,Ei)}get maxSize(){return O(this,Mr)}get calculatedSize(){return O(this,_i)}get size(){return O(this,hn)}get fetchMethod(){return O(this,Nc)}get memoMethod(){return O(this,Bc)}get dispose(){return O(this,Ti)}get disposeAfter(){return O(this,Ri)}getRemainingTTL(e){return O(this,ln).has(e)?1/0:0}*entries(){for(const e of Ee(this,ve,Qs).call(this))O(this,Ge)[e]!==void 0&&O(this,Ft)[e]!==void 0&&!Ee(this,ve,Bt).call(this,O(this,Ge)[e])&&(yield[O(this,Ft)[e],O(this,Ge)[e]])}*rentries(){for(const e of Ee(this,ve,ea).call(this))O(this,Ge)[e]!==void 0&&O(this,Ft)[e]!==void 0&&!Ee(this,ve,Bt).call(this,O(this,Ge)[e])&&(yield[O(this,Ft)[e],O(this,Ge)[e]])}*keys(){for(const e of Ee(this,ve,Qs).call(this)){const n=O(this,Ft)[e];n!==void 0&&!Ee(this,ve,Bt).call(this,O(this,Ge)[e])&&(yield n)}}*rkeys(){for(const e of Ee(this,ve,ea).call(this)){const n=O(this,Ft)[e];n!==void 0&&!Ee(this,ve,Bt).call(this,O(this,Ge)[e])&&(yield n)}}*values(){for(const e of Ee(this,ve,Qs).call(this))O(this,Ge)[e]!==void 0&&!Ee(this,ve,Bt).call(this,O(this,Ge)[e])&&(yield O(this,Ge)[e])}*rvalues(){for(const e of Ee(this,ve,ea).call(this))O(this,Ge)[e]!==void 0&&!Ee(this,ve,Bt).call(this,O(this,Ge)[e])&&(yield O(this,Ge)[e])}[(ik=Symbol.iterator,rk=Symbol.toStringTag,ik)](){return this.entries()}find(e,n={}){for(const r of Ee(this,ve,Qs).call(this)){const i=O(this,Ge)[r],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;if(o!==void 0&&e(o,O(this,Ft)[r],this))return this.get(O(this,Ft)[r],n)}}forEach(e,n=this){for(const r of Ee(this,ve,Qs).call(this)){const i=O(this,Ge)[r],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,O(this,Ft)[r],this)}}rforEach(e,n=this){for(const r of Ee(this,ve,ea).call(this)){const i=O(this,Ge)[r],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(n,o,O(this,Ft)[r],this)}}purgeStale(){let e=!1;for(const n of Ee(this,ve,ea).call(this,{allowStale:!0}))O(this,Vr).call(this,n)&&(Ee(this,ve,ta).call(this,O(this,Ft)[n],"expire"),e=!0);return e}info(e){const n=O(this,ln).get(e);if(n===void 0)return;const r=O(this,Ge)[n],i=Ee(this,ve,Bt).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const o={value:i};if(O(this,Ur)&&O(this,Ni)){const s=O(this,Ur)[n],a=O(this,Ni)[n];if(s&&a){const l=s-(Jl.now()-a);o.ttl=l,o.start=Date.now()}}return O(this,Pi)&&(o.size=O(this,Pi)[n]),o}dump(){const e=[];for(const n of Ee(this,ve,Qs).call(this,{allowStale:!0})){const r=O(this,Ft)[n],i=O(this,Ge)[n],o=Ee(this,ve,Bt).call(this,i)?i.__staleWhileFetching:i;if(o===void 0||r===void 0)continue;const s={value:o};if(O(this,Ur)&&O(this,Ni)){s.ttl=O(this,Ur)[n];const a=Jl.now()-O(this,Ni)[n];s.start=Math.floor(Date.now()-a)}O(this,Pi)&&(s.size=O(this,Pi)[n]),e.unshift([r,s])}return e}load(e){this.clear();for(const[n,r]of e){if(r.start){const i=Date.now()-r.start;r.start=Jl.now()-i}this.set(n,r.value,r)}}set(e,n,r={}){var f,h,p,m,C;if(n===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:l}=r;let{noUpdateTTL:c=this.noUpdateTTL}=r;const u=O(this,ff).call(this,e,n,r.size||0,a);if(this.maxEntrySize&&u>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),Ee(this,ve,ta).call(this,e,"set"),this;let d=O(this,hn)===0?void 0:O(this,ln).get(e);if(d===void 0)d=O(this,hn)===0?O(this,An):O(this,Di).length!==0?O(this,Di).pop():O(this,hn)===O(this,Ei)?Ee(this,ve,_h).call(this,!1):O(this,hn),O(this,Ft)[d]=e,O(this,Ge)[d]=n,O(this,ln).set(e,d),O(this,er)[O(this,An)]=d,O(this,Lr)[d]=O(this,An),Fe(this,An,d),Nf(this,hn)._++,O(this,Fc).call(this,d,u,l),l&&(l.set="add"),c=!1;else{Ee(this,ve,ed).call(this,d);const v=O(this,Ge)[d];if(n!==v){if(O(this,ca)&&Ee(this,ve,Bt).call(this,v)){v.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:g}=v;g!==void 0&&!s&&(O(this,Bi)&&((f=O(this,Ti))==null||f.call(this,g,e,"set")),O(this,tr)&&((h=O(this,wn))==null||h.push([g,e,"set"])))}else s||(O(this,Bi)&&((p=O(this,Ti))==null||p.call(this,v,e,"set")),O(this,tr)&&((m=O(this,wn))==null||m.push([v,e,"set"])));if(O(this,dl).call(this,d),O(this,Fc).call(this,d,u,l),O(this,Ge)[d]=n,l){l.set="replace";const g=v&&Ee(this,ve,Bt).call(this,v)?v.__staleWhileFetching:v;g!==void 0&&(l.oldValue=g)}}else l&&(l.set="update")}if(i!==0&&!O(this,Ur)&&Ee(this,ve,cC).call(this),O(this,Ur)&&(c||O(this,df).call(this,d,i,o),l&&O(this,Qo).call(this,l,d)),!s&&O(this,tr)&&O(this,wn)){const v=O(this,wn);let g;for(;g=v==null?void 0:v.shift();)(C=O(this,Ri))==null||C.call(this,...g)}return this}pop(){var e;try{for(;O(this,hn);){const n=O(this,Ge)[O(this,Zn)];if(Ee(this,ve,_h).call(this,!0),Ee(this,ve,Bt).call(this,n)){if(n.__staleWhileFetching)return n.__staleWhileFetching}else if(n!==void 0)return n}}finally{if(O(this,tr)&&O(this,wn)){const n=O(this,wn);let r;for(;r=n==null?void 0:n.shift();)(e=O(this,Ri))==null||e.call(this,...r)}}}has(e,n={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=n,o=O(this,ln).get(e);if(o!==void 0){const s=O(this,Ge)[o];if(Ee(this,ve,Bt).call(this,s)&&s.__staleWhileFetching===void 0)return!1;if(O(this,Vr).call(this,o))i&&(i.has="stale",O(this,Qo).call(this,i,o));else return r&&O(this,ul).call(this,o),i&&(i.has="hit",O(this,Qo).call(this,i,o)),!0}else i&&(i.has="miss");return!1}peek(e,n={}){const{allowStale:r=this.allowStale}=n,i=O(this,ln).get(e);if(i===void 0||!r&&O(this,Vr).call(this,i))return;const o=O(this,Ge)[i];return Ee(this,ve,Bt).call(this,o)?o.__staleWhileFetching:o}async fetch(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:l=0,sizeCalculation:c=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:m,forceRefresh:C=!1,status:v,signal:g}=n;if(!O(this,ca))return v&&(v.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,status:v});const y={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:l,sizeCalculation:c,noUpdateTTL:u,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:p,ignoreFetchAbort:h,status:v,signal:g};let I=O(this,ln).get(e);if(I===void 0){v&&(v.fetch="miss");const b=Ee(this,ve,Dh).call(this,e,I,y,m);return b.__returned=b}else{const b=O(this,Ge)[I];if(Ee(this,ve,Bt).call(this,b)){const T=r&&b.__staleWhileFetching!==void 0;return v&&(v.fetch="inflight",T&&(v.returnedStale=!0)),T?b.__staleWhileFetching:b.__returned=b}const E=O(this,Vr).call(this,I);if(!C&&!E)return v&&(v.fetch="hit"),Ee(this,ve,ed).call(this,I),i&&O(this,ul).call(this,I),v&&O(this,Qo).call(this,v,I),b;const w=Ee(this,ve,Dh).call(this,e,I,y,m),D=w.__staleWhileFetching!==void 0&&r;return v&&(v.fetch=E?"stale":"refresh",D&&E&&(v.returnedStale=!0)),D?w.__staleWhileFetching:w.__returned=w}}async forceFetch(e,n={}){const r=await this.fetch(e,n);if(r===void 0)throw new Error("fetch() returned undefined");return r}memo(e,n={}){const r=O(this,Bc);if(!r)throw new Error("no memoMethod provided to constructor");const{context:i,forceRefresh:o,...s}=n,a=this.get(e,s);if(!o&&a!==void 0)return a;const l=r(e,a,{options:s,context:i});return this.set(e,l,s),l}get(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:s}=n,a=O(this,ln).get(e);if(a!==void 0){const l=O(this,Ge)[a],c=Ee(this,ve,Bt).call(this,l);return s&&O(this,Qo).call(this,s,a),O(this,Vr).call(this,a)?(s&&(s.get="stale"),c?(s&&r&&l.__staleWhileFetching!==void 0&&(s.returnedStale=!0),r?l.__staleWhileFetching:void 0):(o||Ee(this,ve,ta).call(this,e,"expire"),s&&r&&(s.returnedStale=!0),r?l:void 0)):(s&&(s.get="hit"),c?l.__staleWhileFetching:(Ee(this,ve,ed).call(this,a),i&&O(this,ul).call(this,a),l))}else s&&(s.get="miss")}delete(e){return Ee(this,ve,ta).call(this,e,"delete")}clear(){return Ee(this,ve,fC).call(this,"delete")}};Ei=new WeakMap,Mr=new WeakMap,Ti=new WeakMap,Ri=new WeakMap,Nc=new WeakMap,Bc=new WeakMap,hn=new WeakMap,_i=new WeakMap,ln=new WeakMap,Ft=new WeakMap,Ge=new WeakMap,er=new WeakMap,Lr=new WeakMap,Zn=new WeakMap,An=new WeakMap,Di=new WeakMap,wn=new WeakMap,Pi=new WeakMap,Ni=new WeakMap,Ur=new WeakMap,Bi=new WeakMap,ca=new WeakMap,tr=new WeakMap,ve=new WeakSet,cC=function(){const e=new Rh(O(this,Ei)),n=new Rh(O(this,Ei));Fe(this,Ur,e),Fe(this,Ni,n),Fe(this,df,(o,s,a=Jl.now())=>{if(n[o]=s!==0?a:0,e[o]=s,s!==0&&this.ttlAutopurge){const l=setTimeout(()=>{O(this,Vr).call(this,o)&&Ee(this,ve,ta).call(this,O(this,Ft)[o],"expire")},s+1);l.unref&&l.unref()}}),Fe(this,ul,o=>{n[o]=e[o]!==0?Jl.now():0}),Fe(this,Qo,(o,s)=>{if(e[s]){const a=e[s],l=n[s];if(!a||!l)return;o.ttl=a,o.start=l,o.now=r||i();const c=o.now-l;o.remainingTTL=a-c}});let r=0;const i=()=>{const o=Jl.now();if(this.ttlResolution>0){r=o;const s=setTimeout(()=>r=0,this.ttlResolution);s.unref&&s.unref()}return o};this.getRemainingTTL=o=>{const s=O(this,ln).get(o);if(s===void 0)return 0;const a=e[s],l=n[s];if(!a||!l)return 1/0;const c=(r||i())-l;return a-c},Fe(this,Vr,o=>{const s=n[o],a=e[o];return!!a&&!!s&&(r||i())-s>a})},ul=new WeakMap,Qo=new WeakMap,df=new WeakMap,Vr=new WeakMap,nR=function(){const e=new Rh(O(this,Ei));Fe(this,_i,0),Fe(this,Pi,e),Fe(this,dl,n=>{Fe(this,_i,O(this,_i)-e[n]),e[n]=0}),Fe(this,ff,(n,r,i,o)=>{if(Ee(this,ve,Bt).call(this,r))return 0;if(!qs(i))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(i=o(r,n),!qs(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Fe(this,Fc,(n,r,i)=>{if(e[n]=r,O(this,Mr)){const o=O(this,Mr)-e[n];for(;O(this,_i)>o;)Ee(this,ve,_h).call(this,!0)}Fe(this,_i,O(this,_i)+e[n]),i&&(i.entrySize=r,i.totalCalculatedSize=O(this,_i))})},dl=new WeakMap,Fc=new WeakMap,ff=new WeakMap,Qs=function*({allowStale:e=this.allowStale}={}){if(O(this,hn))for(let n=O(this,An);!(!Ee(this,ve,uC).call(this,n)||((e||!O(this,Vr).call(this,n))&&(yield n),n===O(this,Zn)));)n=O(this,Lr)[n]},ea=function*({allowStale:e=this.allowStale}={}){if(O(this,hn))for(let n=O(this,Zn);!(!Ee(this,ve,uC).call(this,n)||((e||!O(this,Vr).call(this,n))&&(yield n),n===O(this,An)));)n=O(this,er)[n]},uC=function(e){return e!==void 0&&O(this,ln).get(O(this,Ft)[e])===e},_h=function(e){var o,s;const n=O(this,Zn),r=O(this,Ft)[n],i=O(this,Ge)[n];return O(this,ca)&&Ee(this,ve,Bt).call(this,i)?i.__abortController.abort(new Error("evicted")):(O(this,Bi)||O(this,tr))&&(O(this,Bi)&&((o=O(this,Ti))==null||o.call(this,i,r,"evict")),O(this,tr)&&((s=O(this,wn))==null||s.push([i,r,"evict"]))),O(this,dl).call(this,n),e&&(O(this,Ft)[n]=void 0,O(this,Ge)[n]=void 0,O(this,Di).push(n)),O(this,hn)===1?(Fe(this,Zn,Fe(this,An,0)),O(this,Di).length=0):Fe(this,Zn,O(this,er)[n]),O(this,ln).delete(r),Nf(this,hn)._--,n},Dh=function(e,n,r,i){const o=n===void 0?void 0:O(this,Ge)[n];if(Ee(this,ve,Bt).call(this,o))return o;const s=new L0,{signal:a}=r;a==null||a.addEventListener("abort",()=>s.abort(a.reason),{signal:s.signal});const l={signal:s.signal,options:r,context:i},c=(m,C=!1)=>{const{aborted:v}=s.signal,g=r.ignoreFetchAbort&&m!==void 0;if(r.status&&(v&&!C?(r.status.fetchAborted=!0,r.status.fetchError=s.signal.reason,g&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),v&&!g&&!C)return d(s.signal.reason);const y=h;return O(this,Ge)[n]===h&&(m===void 0?y.__staleWhileFetching?O(this,Ge)[n]=y.__staleWhileFetching:Ee(this,ve,ta).call(this,e,"fetch"):(r.status&&(r.status.fetchUpdated=!0),this.set(e,m,l.options))),m},u=m=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=m),d(m)),d=m=>{const{aborted:C}=s.signal,v=C&&r.allowStaleOnFetchAbort,g=v||r.allowStaleOnFetchRejection,y=g||r.noDeleteOnFetchRejection,I=h;if(O(this,Ge)[n]===h&&(!y||I.__staleWhileFetching===void 0?Ee(this,ve,ta).call(this,e,"fetch"):v||(O(this,Ge)[n]=I.__staleWhileFetching)),g)return r.status&&I.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),I.__staleWhileFetching;if(I.__returned===I)throw m},f=(m,C)=>{var g;const v=(g=O(this,Nc))==null?void 0:g.call(this,e,o,l);v&&v instanceof Promise&&v.then(y=>m(y===void 0?void 0:y),C),s.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(m(void 0),r.allowStaleOnFetchAbort&&(m=y=>c(y,!0)))})};r.status&&(r.status.fetchDispatched=!0);const h=new Promise(f).then(c,u),p=Object.assign(h,{__abortController:s,__staleWhileFetching:o,__returned:void 0});return n===void 0?(this.set(e,p,{...l.options,status:void 0}),n=O(this,ln).get(e)):O(this,Ge)[n]=p,p},Bt=function(e){if(!O(this,ca))return!1;const n=e;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof L0},dC=function(e,n){O(this,Lr)[n]=e,O(this,er)[e]=n},ed=function(e){e!==O(this,An)&&(e===O(this,Zn)?Fe(this,Zn,O(this,er)[e]):Ee(this,ve,dC).call(this,O(this,Lr)[e],O(this,er)[e]),Ee(this,ve,dC).call(this,O(this,An),e),Fe(this,An,e))},ta=function(e,n){var i,o,s,a;let r=!1;if(O(this,hn)!==0){const l=O(this,ln).get(e);if(l!==void 0)if(r=!0,O(this,hn)===1)Ee(this,ve,fC).call(this,n);else{O(this,dl).call(this,l);const c=O(this,Ge)[l];if(Ee(this,ve,Bt).call(this,c)?c.__abortController.abort(new Error("deleted")):(O(this,Bi)||O(this,tr))&&(O(this,Bi)&&((i=O(this,Ti))==null||i.call(this,c,e,n)),O(this,tr)&&((o=O(this,wn))==null||o.push([c,e,n]))),O(this,ln).delete(e),O(this,Ft)[l]=void 0,O(this,Ge)[l]=void 0,l===O(this,An))Fe(this,An,O(this,Lr)[l]);else if(l===O(this,Zn))Fe(this,Zn,O(this,er)[l]);else{const u=O(this,Lr)[l];O(this,er)[u]=O(this,er)[l];const d=O(this,er)[l];O(this,Lr)[d]=O(this,Lr)[l]}Nf(this,hn)._--,O(this,Di).push(l)}}if(O(this,tr)&&((s=O(this,wn))!=null&&s.length)){const l=O(this,wn);let c;for(;c=l==null?void 0:l.shift();)(a=O(this,Ri))==null||a.call(this,...c)}return r},fC=function(e){var n,r,i;for(const o of Ee(this,ve,ea).call(this,{allowStale:!0})){const s=O(this,Ge)[o];if(Ee(this,ve,Bt).call(this,s))s.__abortController.abort(new Error("deleted"));else{const a=O(this,Ft)[o];O(this,Bi)&&((n=O(this,Ti))==null||n.call(this,s,a,e)),O(this,tr)&&((r=O(this,wn))==null||r.push([s,a,e]))}}if(O(this,ln).clear(),O(this,Ge).fill(void 0),O(this,Ft).fill(void 0),O(this,Ur)&&O(this,Ni)&&(O(this,Ur).fill(0),O(this,Ni).fill(0)),O(this,Pi)&&O(this,Pi).fill(0),Fe(this,Zn,0),Fe(this,An,0),O(this,Di).length=0,Fe(this,_i,0),Fe(this,hn,0),O(this,tr)&&O(this,wn)){const o=O(this,wn);let s;for(;s=o==null?void 0:o.shift();)(i=O(this,Ri))==null||i.call(this,...s)}};let lC=Gx;function D6(t){const e=t.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+t+"`"),null;const n=e[1],r=e[2],i={},o=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let s;for(;s=o.exec(e[3]);){const a=s[1]||s[3],l=s[2]||s[4];a in i?console.log(`Invalid message format: duplicate key ${a} detected`):i[a]=l}return{name:n,authKey:r,keyvals:i}}function Xb(t){const e=t.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+t+"`"),null;const n=e[1]||e[4],r=void 0,i=e[2],o=e[3],s={};return s[i]=o,{name:n,authKey:r,keyvals:s}}function Kb(){return(Math.random()+1).toString(36).substring(3,9)}class uu{constructor(e){L(this,"packageName");L(this,"minVersion",1);L(this,"maxVersion",1);L(this,"packageVersion",0);L(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,n){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,n)}}class P6 extends uu{constructor(){super(...arguments);L(this,"packageName","mcp-negotiate");L(this,"minVersion",2);L(this,"maxVersion",2)}handle(n){switch(n.name){}}sendNegotiate(){var n,r;for(const i of Object.values(this.client.mcpHandlers)){let o=(n=i.minVersion)==null?void 0:n.toFixed(1),s=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":o,"max-version":s})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class N6 extends uu{constructor(){super(...arguments);L(this,"packageName","dns-com-awns-status")}handle(n){console.log(n),this.client.emit("statustext",n.keyvals.text)}}class B6 extends uu{constructor(n){super(n);L(this,"packageName","dns-org-mud-moo-simpleedit");L(this,"currentSession",null)}handle(n){n.name==="dns-org-mud-moo-simpleedit-content"?this.currentSession={name:n.keyvals.name,reference:n.keyvals.reference,type:n.keyvals.type,contents:[]}:console.log(`Unexpected simpleedit message ${n}`)}handleMultiline(n){this.currentSession&&"content"in n.keyvals?this.currentSession.contents.push(n.keyvals.content):console.log(`Unexpected simpleedit ML ${n}`)}closeMultiline(n){console.log(`Closing multiline ${n.name}`),this.currentSession&&(this.client.editors.openEditorWindow(this.currentSession),this.currentSession=null)}}class F6 extends uu{constructor(){super(...arguments);L(this,"packageName","dns-com-awns-getset");L(this,"id",1);L(this,"cache",new lC({max:10}));L(this,"LocalCache",{})}handle(n){switch(n.name){case"dns-com-awns-getset-ack":const r=this.cache.get(n.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${n.keyvals.id}`);break}const i=n.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(n){const r=(this.id++).toString();this.cache.set(r,n),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:n})}sendSet(n,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:n,value:r})}sendDrop(n){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:n})}}class O6 extends uu{constructor(){super(...arguments);L(this,"packageName","dns-com-vmoo-userlist");L(this,"maxVersion",1.1);L(this,"player");L(this,"fields",["Object","Name","Icon"]);L(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);L(this,"players",[])}handle(n){switch(n.name){case"dns-com-vmoo-userlist-you":this.player=n.keyvals.nr;break}}handleMultiline(n){if("fields"in n.keyvals&&(this.fields=Ai(n.keyvals.fields.trim())),"icons"in n.keyvals&&(this.icons=Ai(n.keyvals.icons.trim())),"d"in n.keyvals){const o=n.keyvals.d[0];switch(o){case"=":var r=Ai(n.keyvals.d.slice(1));this.players=r.map(a=>this.playerFromArray(a));break;case"+":this.players.push(this.playerFromArray(Ai(n.keyvals.d.slice(1))));break;case"-":var i=Ai(n.keyvals.d.slice(1));this.players=this.players.filter(a=>!i.includes(a.Object));break;case"*":const s=this.playerFromArray(Ai(n.keyvals.d.slice(1)));this.updatePlayer(s);break;case"<":i=Ai(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.idle=!0,this.players[l]=a)});break;case">":i=Ai(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.idle=!1,this.players[l]=a)});break;case"[":i=Ai(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.away=!0,this.players[l]=a)});break;case"]":i=Ai(n.keyvals.d.slice(1)),this.players.forEach((a,l)=>{i.includes(a.Object)&&(a.away=!1,this.players[l]=a)});break;default:console.log(`Unknown userlist mode ${o} in ${n.keyvals.d}`);break}this.update()}}updatePlayer(n){const r=this.players.findIndex(i=>i.Object===n.Object);r!==-1?this.players[r]=n:this.players.push(n)}update(){this.players.sort((r,i)=>n(i)-n(r)),this.client.emit("userlist",this.players);function n(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(n){const r={};return n.forEach((i,o)=>{r[this.fields[o]]=i}),r.away=!1,r.idle=!1,r}}function Ai(t){t=t.slice(1,-1);let e=[],n="",r=0;for(let o=0;o<t.length;o++){const s=t[o];if(s==="{")r++;else if(s==="}")r--;else if(s===","&&r===0){i(),n="";continue}n+=s}return n.length>0&&i(),e;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?e.push(Ai(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?e.push(n.slice(1,-1)):e.push(n):e.push(Number(n))}}class M6 extends uu{constructor(){super(...arguments);L(this,"packageName","dns-com-awns-ping");L(this,"id",1)}handle(n){switch(n.name){case"dns-com-awns-ping":this.send("reply",n.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}var hC=(t=>(t.Off="off",t.Unfocused="unfocused",t.All="all",t))(hC||{}),Mo=(t=>(t.SetGeneral="SET_GENERAL",t.SetSpeech="SET_SPEECH",t.SetChannels="SET_CHANNELS",t.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",t.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",t))(Mo||{});class L6{constructor(){L(this,"state");L(this,"listeners",new Set);L(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(n=>n())});const e=localStorage.getItem("preferences"),n=this.getInitialPreferences();this.state=e?this.mergePreferences(n,JSON.parse(e)):n}getInitialPreferences(){return{general:{localEcho:!1,volume:1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(e,n){return{...e,general:{...e.general,...n.general},speech:{...e.speech,...n.speech},channels:n.channels?{...e.channels,...n.channels}:e.channels,editor:{...e.editor,...n.editor}}}reducer(e,n){switch(n.type){case"SET_GENERAL":return{...e,general:n.data};case"SET_SPEECH":return{...e,speech:n.data};case"SET_CHANNELS":return{...e,channels:n.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:n.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:n.data}};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const go=new L6;class U6 extends Ep{constructor(n){super();L(this,"peerConnection",null);L(this,"dataChannel",null);L(this,"client");L(this,"connectionTimeout",3e5);L(this,"connectionTimeoutId");L(this,"recipient","");L(this,"pendingCandidates",[]);L(this,"remoteOfferReceived",!1);this.client=n}isDataChannelOpen(){return this.dataChannel!==null&&this.dataChannel.readyState==="open"}async createPeerConnection(){try{const n={iceServers:[{urls:["turn:mongoose.world:3478","stun:mongoose.world:3478"],username:"p2p",credential:"p2p"},{urls:"stun:stun.l.google.com:19302"}],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};this.peerConnection=new RTCPeerConnection(n),this.peerConnection.onconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.connectionState;switch(console.log("[WebRTCService] Connection state changed to:",r),this.emit("webRTCStateChange",`Connection: ${r}`),r){case"connected":console.log("[WebRTCService] Peer connection established successfully"),this.emit("webRTCConnected");break;case"disconnected":console.log("[WebRTCService] Connection temporarily disconnected"),this.emit("webRTCDisconnected"),setTimeout(()=>{var o;((o=this.peerConnection)==null?void 0:o.connectionState)==="disconnected"&&this.attemptRecovery()},5e3);break;case"failed":console.log("[WebRTCService] Connection failed - attempting immediate recovery"),this.attemptRecovery();break}},this.peerConnection.oniceconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceConnectionState;console.log("[WebRTCService] ICE connection state changed to:",r),this.emit("webRTCStateChange",`ICE: ${r}`),r==="failed"&&(console.log("[WebRTCService] ICE connection failed"),this.attemptRecovery())},this.peerConnection.onsignalingstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.signalingState;console.log("[WebRTCService] Signaling state changed to:",r),this.emit("webRTCStateChange",`Signaling: ${r}`),r==="stable"&&console.log("[WebRTCService] Signaling completed successfully")},this.peerConnection.onicegatheringstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceGatheringState;console.log("[WebRTCService] ICE gathering state changed to:",r),this.emit("webRTCStateChange",`ICE Gathering: ${r}`),r==="complete"&&(console.log("[WebRTCService] ICE gathering completed"),this.emit("iceGatheringComplete"))},this.peerConnection.onicecandidate=r=>{r.candidate?(console.debug("[WebRTCService] New ICE candidate:",{type:r.candidate.type,protocol:r.candidate.protocol,address:r.candidate.address,port:r.candidate.port}),this.recipient&&this.client.gmcp_fileTransfer.sendCandidate(this.recipient,r.candidate)):console.log("[WebRTCService] ICE gathering complete")},this.peerConnection.ondatachannel=r=>{console.log("[WebRTCService] Received data channel"),this.dataChannel=r.channel,this.setupDataChannel()},this.dataChannel||(console.log("[WebRTCService] Creating data channel"),this.dataChannel=this.peerConnection.createDataChannel("fileTransfer",{ordered:!0}),this.setupDataChannel())}catch(n){throw console.error("Error creating peer connection:",n),n}}setupDataChannel(){this.dataChannel&&(console.log("[WebRTCService] Setting up data channel with initial state:",this.dataChannel.readyState),this.dataChannel.readyState==="open"&&(console.log("[WebRTCService] Data channel already open during setup"),this.emit("dataChannelOpen")),this.dataChannel.onopen=()=>{var n;console.log("[WebRTCService] Data channel opened with state:",(n=this.dataChannel)==null?void 0:n.readyState),this.emit("dataChannelOpen")},this.dataChannel.onclose=()=>{console.log("[WebRTCService] Data channel closed"),this.emit("dataChannelClose")},this.dataChannel.onerror=n=>{console.error("[WebRTCService] Data channel error:",n),this.emit("dataChannelError",n)},this.dataChannel.onmessage=n=>{n.data instanceof ArrayBuffer&&this.emit("dataChannelMessage",n.data)},this.on("connectionCheck",()=>{var n,r,i,o,s;if(((n=this.dataChannel)==null?void 0:n.readyState)!=="open"){if(console.log("[WebRTCService] Connection check - data channel not open, current state:",(r=this.dataChannel)==null?void 0:r.readyState),((i=this.dataChannel)==null?void 0:i.readyState)==="connecting"){console.log("[WebRTCService] Data channel still connecting, waiting...");return}if(((o=this.dataChannel)==null?void 0:o.readyState)==="closed"||((s=this.dataChannel)==null?void 0:s.readyState)==="closing"){console.log("[WebRTCService] Data channel closed/closing during connection check, attempting to recreate");try{this.peerConnection&&this.peerConnection.connectionState!=="closed"&&(this.dataChannel=this.peerConnection.createDataChannel("fileTransfer",{ordered:!0}),this.setupDataChannel())}catch(a){console.error("[WebRTCService] Failed to recreate data channel during connection check:",a)}}}}))}async attemptRecovery(){try{console.log("[WebRTCService] Attempting connection recovery"),this.close(),await new Promise(n=>setTimeout(n,1e3)),await this.createPeerConnection(),console.log("[WebRTCService] Recovery attempt completed")}catch(n){console.error("[WebRTCService] Recovery attempt failed:",n)}}async attemptChannelRecovery(){var n;try{if(console.log("[WebRTCService] Attempting data channel recovery"),!this.peerConnection){console.log("[WebRTCService] Creating new peer connection for channel recovery"),await this.createPeerConnection();return}return this.dataChannel&&(console.log("[WebRTCService] Closing existing data channel"),this.dataChannel.close()),console.log("[WebRTCService] Creating new data channel"),this.dataChannel=this.peerConnection.createDataChannel("fileTransfer",{ordered:!0}),this.setupDataChannel(),((n=this.dataChannel)==null?void 0:n.readyState)==="open"?(console.log("[WebRTCService] New data channel already open"),Promise.resolve()):this.listeners("dataChannelOpen").length>0?(console.log("[WebRTCService] Detected test environment with dataChannelOpen listeners"),Promise.resolve()):new Promise((i,o)=>{var c;const s=setTimeout(()=>{l(),o(new Error("Data channel recovery timed out"))},1e4),a=()=>{console.log("[WebRTCService] New data channel opened successfully"),l(),i()},l=()=>{clearTimeout(s),this.dataChannel&&this.dataChannel.removeEventListener("open",a),this.off("dataChannelOpen",a)};(c=this.dataChannel)==null||c.addEventListener("open",a),this.once("dataChannelOpen",a)})}catch(r){return console.error("[WebRTCService] Failed to recover data channel:",r),this.emit("dataChannelRecoveryFailed",r),Promise.reject(r)}}async sendData(n){if(!this.dataChannel)throw new Error("Data channel not initialized");if(this.dataChannel.readyState!=="open")throw new Error("Data channel is not open");try{for(;this.dataChannel.bufferedAmount>1048576;)await new Promise(i=>{var s;const o=()=>{var a;(a=this.dataChannel)==null||a.removeEventListener("bufferedamountlow",o),i()};(s=this.dataChannel)==null||s.addEventListener("bufferedamountlow",o),this.dataChannel.bufferedAmountLowThreshold=1048576/2});this.dataChannel.send(n)}catch(r){throw console.error("[WebRTCService] Error sending data:",r),r}}async createOffer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const n=await this.peerConnection.createOffer();return await this.peerConnection.setLocalDescription(n),n}catch(n){throw console.error("Error creating offer:",n),n}}async createAnswer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const n=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(n),n}catch(n){throw console.error("Error creating answer:",n),n}}async handleAnswer(n){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{console.log("[WebRTCService] Received WebRTC answer:",n),console.log("[WebRTCService] Current connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Current signaling state:",this.peerConnection.signalingState),await this.peerConnection.setRemoteDescription(new RTCSessionDescription(n)),console.log("[WebRTCService] Remote description set successfully"),console.log("[WebRTCService] Updated connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Updated signaling state:",this.peerConnection.signalingState),this.pendingCandidates.length>0?(console.log(`[WebRTCService] Adding ${this.pendingCandidates.length} pending ICE candidates`),await Promise.all(this.pendingCandidates.map(async(r,i)=>{console.log(`[WebRTCService] Adding ICE candidate ${i+1}/${this.pendingCandidates.length}`),await this.peerConnection.addIceCandidate(new RTCIceCandidate(r))})),console.log("[WebRTCService] All pending ICE candidates added successfully"),this.pendingCandidates=[]):console.log("[WebRTCService] No pending ICE candidates to add")}catch(r){throw console.error("Error handling answer:",r),r}}async handleIceCandidate(n){if(!this.peerConnection||!this.peerConnection.remoteDescription){console.log("[WebRTCService] Storing ICE candidate until peer connection is ready"),this.pendingCandidates.push(n);return}try{console.log("[WebRTCService] Adding ICE candidate immediately"),await this.peerConnection.addIceCandidate(new RTCIceCandidate(n))}catch(r){throw console.error("Error handling ICE candidate:",r),r}}async reconnect(){this.close(),await this.createPeerConnection(),this.emit("webRTCReconnecting")}cleanup(){this.connectionTimeoutId&&(clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=void 0),this.close()}close(){this.pendingCandidates=[],this.dataChannel&&(this.dataChannel.close(),this.dataChannel=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.emit("webRTCClosed")}reset(){this.pendingCandidates=[],this.dataChannel=null,this.peerConnection=null,this.emit("webRTCClosed")}async waitForConnection(){return new Promise((n,r)=>{if(this.connectionTimeoutId=window.setTimeout(()=>{s(),r(new Error("Connection timeout"))},this.connectionTimeout),this.isDataChannelOpen())return clearTimeout(this.connectionTimeoutId),n();const i=()=>{clearTimeout(this.connectionTimeoutId),s(),n()},o=()=>{var l;((l=this.peerConnection)==null?void 0:l.connectionState)==="failed"&&(clearTimeout(this.connectionTimeoutId),s(),r(new Error("Connection failed")))},s=()=>{this.dataChannel&&this.dataChannel.removeEventListener("open",i),this.peerConnection&&this.peerConnection.removeEventListener("connectionstatechange",o),this.off("dataChannelOpen",i),this.off("webRTCFailed",a)},a=()=>{clearTimeout(this.connectionTimeoutId),s(),r(new Error("Connection failed"))};this.dataChannel&&this.dataChannel.addEventListener("open",i),this.peerConnection&&this.peerConnection.addEventListener("connectionstatechange",o),this.on("dataChannelOpen",i),this.on("webRTCFailed",a)})}isPeerConnectionInitialized(){var n;return console.log("[WebRTCService] Peer connection state:",(n=this.peerConnection)==null?void 0:n.connectionState),this.peerConnection!==null&&this.peerConnection.connectionState!=="closed"}hasRemoteOffer(){return this.remoteOfferReceived}async waitForRemoteOffer(n=3e4){return console.log("[WebRTCService] Waiting for remote offer..."),new Promise((r,i)=>{const o=setTimeout(()=>{a(),console.log("[WebRTCService] Timeout waiting for remote offer"),i(new Error("Timeout waiting for remote offer"))},n),s=()=>{console.log("[WebRTCService] Remote offer received"),clearTimeout(o),a(),r()},a=()=>{this.client.off("remoteOfferReceived",s)};if(this.remoteOfferReceived){console.log("[WebRTCService] Remote offer already received"),clearTimeout(o),r();return}this.client.on("remoteOfferReceived",s)})}async handleOffer(n){console.log("[WebRTCService] Handling WebRTC offer:",n),this.peerConnection||(console.log("[WebRTCService] Creating new peer connection for offer"),await this.createPeerConnection());try{if(await this.peerConnection.setRemoteDescription(new RTCSessionDescription(n)),this.remoteOfferReceived=!0,this.client.emit("remoteOfferReceived"),console.log("[WebRTCService] Remote offer set successfully"),this.pendingCandidates.length>0){console.log(`[WebRTCService] Processing ${this.pendingCandidates.length} pending ICE candidates`);const r=[...this.pendingCandidates];this.pendingCandidates=[];for(const i of r)try{await this.peerConnection.addIceCandidate(new RTCIceCandidate(i)),console.log("[WebRTCService] Successfully added pending ICE candidate")}catch(o){console.warn("[WebRTCService] Failed to add pending ICE candidate:",o)}}}catch(r){throw console.error("[WebRTCService] Error handling offer:",r),r}}}var rR={exports:{}};function V6(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Bg={exports:{}};const G6={},W6=Object.freeze(Object.defineProperty({__proto__:null,default:G6},Symbol.toStringTag,{value:"Module"})),z6=vP(W6);var Jb;function it(){return Jb||(Jb=1,function(t,e){(function(n,r){t.exports=r()})(Ze,function(){var n=n||function(r,i){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof Ze<"u"&&Ze.crypto&&(o=Ze.crypto),!o&&typeof V6=="function")try{o=z6}catch{}var s=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function g(){}return function(y){var I;return g.prototype=y,I=new g,g.prototype=null,I}}(),l={},c=l.lib={},u=c.Base=function(){return{extend:function(g){var y=a(this);return g&&y.mixIn(g),(!y.hasOwnProperty("init")||this.init===y.init)&&(y.init=function(){y.$super.init.apply(this,arguments)}),y.init.prototype=y,y.$super=this,y},create:function(){var g=this.extend();return g.init.apply(g,arguments),g},init:function(){},mixIn:function(g){for(var y in g)g.hasOwnProperty(y)&&(this[y]=g[y]);g.hasOwnProperty("toString")&&(this.toString=g.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=c.WordArray=u.extend({init:function(g,y){g=this.words=g||[],y!=i?this.sigBytes=y:this.sigBytes=g.length*4},toString:function(g){return(g||h).stringify(this)},concat:function(g){var y=this.words,I=g.words,b=this.sigBytes,E=g.sigBytes;if(this.clamp(),b%4)for(var w=0;w<E;w++){var k=I[w>>>2]>>>24-w%4*8&255;y[b+w>>>2]|=k<<24-(b+w)%4*8}else for(var D=0;D<E;D+=4)y[b+D>>>2]=I[D>>>2];return this.sigBytes+=E,this},clamp:function(){var g=this.words,y=this.sigBytes;g[y>>>2]&=4294967295<<32-y%4*8,g.length=r.ceil(y/4)},clone:function(){var g=u.clone.call(this);return g.words=this.words.slice(0),g},random:function(g){for(var y=[],I=0;I<g;I+=4)y.push(s());return new d.init(y,g)}}),f=l.enc={},h=f.Hex={stringify:function(g){for(var y=g.words,I=g.sigBytes,b=[],E=0;E<I;E++){var w=y[E>>>2]>>>24-E%4*8&255;b.push((w>>>4).toString(16)),b.push((w&15).toString(16))}return b.join("")},parse:function(g){for(var y=g.length,I=[],b=0;b<y;b+=2)I[b>>>3]|=parseInt(g.substr(b,2),16)<<24-b%8*4;return new d.init(I,y/2)}},p=f.Latin1={stringify:function(g){for(var y=g.words,I=g.sigBytes,b=[],E=0;E<I;E++){var w=y[E>>>2]>>>24-E%4*8&255;b.push(String.fromCharCode(w))}return b.join("")},parse:function(g){for(var y=g.length,I=[],b=0;b<y;b++)I[b>>>2]|=(g.charCodeAt(b)&255)<<24-b%4*8;return new d.init(I,y)}},m=f.Utf8={stringify:function(g){try{return decodeURIComponent(escape(p.stringify(g)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(g){return p.parse(unescape(encodeURIComponent(g)))}},C=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(g){typeof g=="string"&&(g=m.parse(g)),this._data.concat(g),this._nDataBytes+=g.sigBytes},_process:function(g){var y,I=this._data,b=I.words,E=I.sigBytes,w=this.blockSize,k=w*4,D=E/k;g?D=r.ceil(D):D=r.max((D|0)-this._minBufferSize,0);var T=D*w,R=r.min(T*4,E);if(T){for(var P=0;P<T;P+=w)this._doProcessBlock(b,P);y=b.splice(0,T),I.sigBytes-=R}return new d.init(y,R)},clone:function(){var g=u.clone.call(this);return g._data=this._data.clone(),g},_minBufferSize:0});c.Hasher=C.extend({cfg:u.extend(),init:function(g){this.cfg=this.cfg.extend(g),this.reset()},reset:function(){C.reset.call(this),this._doReset()},update:function(g){return this._append(g),this._process(),this},finalize:function(g){g&&this._append(g);var y=this._doFinalize();return y},blockSize:16,_createHelper:function(g){return function(y,I){return new g.init(I).finalize(y)}},_createHmacHelper:function(g){return function(y,I){return new v.HMAC.init(g,I).finalize(y)}}});var v=l.algo={};return l}(Math);return n})}(Bg)),Bg.exports}var Fg={exports:{}},Yb;function Fp(){return Yb||(Yb=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.Base,a=o.WordArray,l=i.x64={};l.Word=s.extend({init:function(c,u){this.high=c,this.low=u}}),l.WordArray=s.extend({init:function(c,u){c=this.words=c||[],u!=r?this.sigBytes=u:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,u=c.length,d=[],f=0;f<u;f++){var h=c[f];d.push(h.high),d.push(h.low)}return a.create(d,this.sigBytes)},clone:function(){for(var c=s.clone.call(this),u=c.words=this.words.slice(0),d=u.length,f=0;f<d;f++)u[f]=u[f].clone();return c}})}(),n})}(Fg)),Fg.exports}var Og={exports:{}},qb;function j6(){return qb||(qb=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(){if(typeof ArrayBuffer=="function"){var r=n,i=r.lib,o=i.WordArray,s=o.init,a=o.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,u=[],d=0;d<c;d++)u[d>>>2]|=l[d]<<24-d%4*8;s.call(this,u,c)}else s.apply(this,arguments)};a.prototype=o}}(),n.lib.WordArray})}(Og)),Og.exports}var Mg={exports:{}},Qb;function H6(){return Qb||(Qb=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.enc;s.Utf16=s.Utf16BE={stringify:function(l){for(var c=l.words,u=l.sigBytes,d=[],f=0;f<u;f+=2){var h=c[f>>>2]>>>16-f%4*8&65535;d.push(String.fromCharCode(h))}return d.join("")},parse:function(l){for(var c=l.length,u=[],d=0;d<c;d++)u[d>>>1]|=l.charCodeAt(d)<<16-d%2*16;return o.create(u,c*2)}},s.Utf16LE={stringify:function(l){for(var c=l.words,u=l.sigBytes,d=[],f=0;f<u;f+=2){var h=a(c[f>>>2]>>>16-f%4*8&65535);d.push(String.fromCharCode(h))}return d.join("")},parse:function(l){for(var c=l.length,u=[],d=0;d<c;d++)u[d>>>1]|=a(l.charCodeAt(d)<<16-d%2*16);return o.create(u,c*2)}};function a(l){return l<<8&4278255360|l>>>8&16711935}}(),n.enc.Utf16})}(Mg)),Mg.exports}var Lg={exports:{}},eA;function Ul(){return eA||(eA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.enc;s.Base64={stringify:function(l){var c=l.words,u=l.sigBytes,d=this._map;l.clamp();for(var f=[],h=0;h<u;h+=3)for(var p=c[h>>>2]>>>24-h%4*8&255,m=c[h+1>>>2]>>>24-(h+1)%4*8&255,C=c[h+2>>>2]>>>24-(h+2)%4*8&255,v=p<<16|m<<8|C,g=0;g<4&&h+g*.75<u;g++)f.push(d.charAt(v>>>6*(3-g)&63));var y=d.charAt(64);if(y)for(;f.length%4;)f.push(y);return f.join("")},parse:function(l){var c=l.length,u=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var f=0;f<u.length;f++)d[u.charCodeAt(f)]=f}var h=u.charAt(64);if(h){var p=l.indexOf(h);p!==-1&&(c=p)}return a(l,c,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(l,c,u){for(var d=[],f=0,h=0;h<c;h++)if(h%4){var p=u[l.charCodeAt(h-1)]<<h%4*2,m=u[l.charCodeAt(h)]>>>6-h%4*2,C=p|m;d[f>>>2]|=C<<24-f%4*8,f++}return o.create(d,f)}}(),n.enc.Base64})}(Lg)),Lg.exports}var Ug={exports:{}},tA;function Z6(){return tA||(tA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.enc;s.Base64url={stringify:function(l,c){c===void 0&&(c=!0);var u=l.words,d=l.sigBytes,f=c?this._safe_map:this._map;l.clamp();for(var h=[],p=0;p<d;p+=3)for(var m=u[p>>>2]>>>24-p%4*8&255,C=u[p+1>>>2]>>>24-(p+1)%4*8&255,v=u[p+2>>>2]>>>24-(p+2)%4*8&255,g=m<<16|C<<8|v,y=0;y<4&&p+y*.75<d;y++)h.push(f.charAt(g>>>6*(3-y)&63));var I=f.charAt(64);if(I)for(;h.length%4;)h.push(I);return h.join("")},parse:function(l,c){c===void 0&&(c=!0);var u=l.length,d=c?this._safe_map:this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var h=0;h<d.length;h++)f[d.charCodeAt(h)]=h}var p=d.charAt(64);if(p){var m=l.indexOf(p);m!==-1&&(u=m)}return a(l,u,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function a(l,c,u){for(var d=[],f=0,h=0;h<c;h++)if(h%4){var p=u[l.charCodeAt(h-1)]<<h%4*2,m=u[l.charCodeAt(h)]>>>6-h%4*2,C=p|m;d[f>>>2]|=C<<24-f%4*8,f++}return o.create(d,f)}}(),n.enc.Base64url})}(Ug)),Ug.exports}var Vg={exports:{}},nA;function Vl(){return nA||(nA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.algo,c=[];(function(){for(var m=0;m<64;m++)c[m]=r.abs(r.sin(m+1))*4294967296|0})();var u=l.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(m,C){for(var v=0;v<16;v++){var g=C+v,y=m[g];m[g]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}var I=this._hash.words,b=m[C+0],E=m[C+1],w=m[C+2],k=m[C+3],D=m[C+4],T=m[C+5],R=m[C+6],P=m[C+7],M=m[C+8],G=m[C+9],H=m[C+10],q=m[C+11],ie=m[C+12],Z=m[C+13],Q=m[C+14],ne=m[C+15],F=I[0],z=I[1],J=I[2],ee=I[3];F=d(F,z,J,ee,b,7,c[0]),ee=d(ee,F,z,J,E,12,c[1]),J=d(J,ee,F,z,w,17,c[2]),z=d(z,J,ee,F,k,22,c[3]),F=d(F,z,J,ee,D,7,c[4]),ee=d(ee,F,z,J,T,12,c[5]),J=d(J,ee,F,z,R,17,c[6]),z=d(z,J,ee,F,P,22,c[7]),F=d(F,z,J,ee,M,7,c[8]),ee=d(ee,F,z,J,G,12,c[9]),J=d(J,ee,F,z,H,17,c[10]),z=d(z,J,ee,F,q,22,c[11]),F=d(F,z,J,ee,ie,7,c[12]),ee=d(ee,F,z,J,Z,12,c[13]),J=d(J,ee,F,z,Q,17,c[14]),z=d(z,J,ee,F,ne,22,c[15]),F=f(F,z,J,ee,E,5,c[16]),ee=f(ee,F,z,J,R,9,c[17]),J=f(J,ee,F,z,q,14,c[18]),z=f(z,J,ee,F,b,20,c[19]),F=f(F,z,J,ee,T,5,c[20]),ee=f(ee,F,z,J,H,9,c[21]),J=f(J,ee,F,z,ne,14,c[22]),z=f(z,J,ee,F,D,20,c[23]),F=f(F,z,J,ee,G,5,c[24]),ee=f(ee,F,z,J,Q,9,c[25]),J=f(J,ee,F,z,k,14,c[26]),z=f(z,J,ee,F,M,20,c[27]),F=f(F,z,J,ee,Z,5,c[28]),ee=f(ee,F,z,J,w,9,c[29]),J=f(J,ee,F,z,P,14,c[30]),z=f(z,J,ee,F,ie,20,c[31]),F=h(F,z,J,ee,T,4,c[32]),ee=h(ee,F,z,J,M,11,c[33]),J=h(J,ee,F,z,q,16,c[34]),z=h(z,J,ee,F,Q,23,c[35]),F=h(F,z,J,ee,E,4,c[36]),ee=h(ee,F,z,J,D,11,c[37]),J=h(J,ee,F,z,P,16,c[38]),z=h(z,J,ee,F,H,23,c[39]),F=h(F,z,J,ee,Z,4,c[40]),ee=h(ee,F,z,J,b,11,c[41]),J=h(J,ee,F,z,k,16,c[42]),z=h(z,J,ee,F,R,23,c[43]),F=h(F,z,J,ee,G,4,c[44]),ee=h(ee,F,z,J,ie,11,c[45]),J=h(J,ee,F,z,ne,16,c[46]),z=h(z,J,ee,F,w,23,c[47]),F=p(F,z,J,ee,b,6,c[48]),ee=p(ee,F,z,J,P,10,c[49]),J=p(J,ee,F,z,Q,15,c[50]),z=p(z,J,ee,F,T,21,c[51]),F=p(F,z,J,ee,ie,6,c[52]),ee=p(ee,F,z,J,k,10,c[53]),J=p(J,ee,F,z,H,15,c[54]),z=p(z,J,ee,F,E,21,c[55]),F=p(F,z,J,ee,M,6,c[56]),ee=p(ee,F,z,J,ne,10,c[57]),J=p(J,ee,F,z,R,15,c[58]),z=p(z,J,ee,F,Z,21,c[59]),F=p(F,z,J,ee,D,6,c[60]),ee=p(ee,F,z,J,q,10,c[61]),J=p(J,ee,F,z,w,15,c[62]),z=p(z,J,ee,F,G,21,c[63]),I[0]=I[0]+F|0,I[1]=I[1]+z|0,I[2]=I[2]+J|0,I[3]=I[3]+ee|0},_doFinalize:function(){var m=this._data,C=m.words,v=this._nDataBytes*8,g=m.sigBytes*8;C[g>>>5]|=128<<24-g%32;var y=r.floor(v/4294967296),I=v;C[(g+64>>>9<<4)+15]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,C[(g+64>>>9<<4)+14]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,m.sigBytes=(C.length+1)*4,this._process();for(var b=this._hash,E=b.words,w=0;w<4;w++){var k=E[w];E[w]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}return b},clone:function(){var m=a.clone.call(this);return m._hash=this._hash.clone(),m}});function d(m,C,v,g,y,I,b){var E=m+(C&v|~C&g)+y+b;return(E<<I|E>>>32-I)+C}function f(m,C,v,g,y,I,b){var E=m+(C&g|v&~g)+y+b;return(E<<I|E>>>32-I)+C}function h(m,C,v,g,y,I,b){var E=m+(C^v^g)+y+b;return(E<<I|E>>>32-I)+C}function p(m,C,v,g,y,I,b){var E=m+(v^(C|~g))+y+b;return(E<<I|E>>>32-I)+C}i.MD5=a._createHelper(u),i.HmacMD5=a._createHmacHelper(u)}(Math),n.MD5})}(Vg)),Vg.exports}var Gg={exports:{}},rA;function iR(){return rA||(rA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=i.Hasher,a=r.algo,l=[],c=a.SHA1=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,d){for(var f=this._hash.words,h=f[0],p=f[1],m=f[2],C=f[3],v=f[4],g=0;g<80;g++){if(g<16)l[g]=u[d+g]|0;else{var y=l[g-3]^l[g-8]^l[g-14]^l[g-16];l[g]=y<<1|y>>>31}var I=(h<<5|h>>>27)+v+l[g];g<20?I+=(p&m|~p&C)+1518500249:g<40?I+=(p^m^C)+1859775393:g<60?I+=(p&m|p&C|m&C)-1894007588:I+=(p^m^C)-899497514,v=C,C=m,m=p<<30|p>>>2,p=h,h=I}f[0]=f[0]+h|0,f[1]=f[1]+p|0,f[2]=f[2]+m|0,f[3]=f[3]+C|0,f[4]=f[4]+v|0},_doFinalize:function(){var u=this._data,d=u.words,f=this._nDataBytes*8,h=u.sigBytes*8;return d[h>>>5]|=128<<24-h%32,d[(h+64>>>9<<4)+14]=Math.floor(f/4294967296),d[(h+64>>>9<<4)+15]=f,u.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var u=s.clone.call(this);return u._hash=this._hash.clone(),u}});r.SHA1=s._createHelper(c),r.HmacSHA1=s._createHmacHelper(c)}(),n.SHA1})}(Gg)),Gg.exports}var Wg={exports:{}},iA;function F1(){return iA||(iA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.algo,c=[],u=[];(function(){function h(v){for(var g=r.sqrt(v),y=2;y<=g;y++)if(!(v%y))return!1;return!0}function p(v){return(v-(v|0))*4294967296|0}for(var m=2,C=0;C<64;)h(m)&&(C<8&&(c[C]=p(r.pow(m,1/2))),u[C]=p(r.pow(m,1/3)),C++),m++})();var d=[],f=l.SHA256=a.extend({_doReset:function(){this._hash=new s.init(c.slice(0))},_doProcessBlock:function(h,p){for(var m=this._hash.words,C=m[0],v=m[1],g=m[2],y=m[3],I=m[4],b=m[5],E=m[6],w=m[7],k=0;k<64;k++){if(k<16)d[k]=h[p+k]|0;else{var D=d[k-15],T=(D<<25|D>>>7)^(D<<14|D>>>18)^D>>>3,R=d[k-2],P=(R<<15|R>>>17)^(R<<13|R>>>19)^R>>>10;d[k]=T+d[k-7]+P+d[k-16]}var M=I&b^~I&E,G=C&v^C&g^v&g,H=(C<<30|C>>>2)^(C<<19|C>>>13)^(C<<10|C>>>22),q=(I<<26|I>>>6)^(I<<21|I>>>11)^(I<<7|I>>>25),ie=w+q+M+u[k]+d[k],Z=H+G;w=E,E=b,b=I,I=y+ie|0,y=g,g=v,v=C,C=ie+Z|0}m[0]=m[0]+C|0,m[1]=m[1]+v|0,m[2]=m[2]+g|0,m[3]=m[3]+y|0,m[4]=m[4]+I|0,m[5]=m[5]+b|0,m[6]=m[6]+E|0,m[7]=m[7]+w|0},_doFinalize:function(){var h=this._data,p=h.words,m=this._nDataBytes*8,C=h.sigBytes*8;return p[C>>>5]|=128<<24-C%32,p[(C+64>>>9<<4)+14]=r.floor(m/4294967296),p[(C+64>>>9<<4)+15]=m,h.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var h=a.clone.call(this);return h._hash=this._hash.clone(),h}});i.SHA256=a._createHelper(f),i.HmacSHA256=a._createHmacHelper(f)}(Math),n.SHA256})}(Wg)),Wg.exports}var zg={exports:{}},oA;function $6(){return oA||(oA=1,function(t,e){(function(n,r,i){t.exports=r(it(),F1())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=r.algo,a=s.SHA256,l=s.SHA224=a.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=a._doFinalize.call(this);return c.sigBytes-=4,c}});r.SHA224=a._createHelper(l),r.HmacSHA224=a._createHmacHelper(l)}(),n.SHA224})}(zg)),zg.exports}var jg={exports:{}},sA;function oR(){return sA||(sA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Fp())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.Hasher,s=r.x64,a=s.Word,l=s.WordArray,c=r.algo;function u(){return a.create.apply(a,arguments)}var d=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],f=[];(function(){for(var p=0;p<80;p++)f[p]=u()})();var h=c.SHA512=o.extend({_doReset:function(){this._hash=new l.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(p,m){for(var C=this._hash.words,v=C[0],g=C[1],y=C[2],I=C[3],b=C[4],E=C[5],w=C[6],k=C[7],D=v.high,T=v.low,R=g.high,P=g.low,M=y.high,G=y.low,H=I.high,q=I.low,ie=b.high,Z=b.low,Q=E.high,ne=E.low,F=w.high,z=w.low,J=k.high,ee=k.low,se=D,me=T,Be=R,ae=P,Pt=M,Vt=G,dn=H,ze=q,at=ie,ot=Z,he=Q,Ce=ne,Ue=F,Le=z,Pe=J,$e=ee,st=0;st<80;st++){var Qe,Gt,Wt=f[st];if(st<16)Gt=Wt.high=p[m+st*2]|0,Qe=Wt.low=p[m+st*2+1]|0;else{var wt=f[st-15],on=wt.high,_=wt.low,x=(on>>>1|_<<31)^(on>>>8|_<<24)^on>>>7,A=(_>>>1|on<<31)^(_>>>8|on<<24)^(_>>>7|on<<25),B=f[st-2],W=B.high,Y=B.low,te=(W>>>19|Y<<13)^(W<<3|Y>>>29)^W>>>6,Ne=(Y>>>19|W<<13)^(Y<<3|W>>>29)^(Y>>>6|W<<26),tt=f[st-7],lt=tt.high,ht=tt.low,nt=f[st-16],xi=nt.high,ro=nt.low;Qe=A+ht,Gt=x+lt+(Qe>>>0<A>>>0?1:0),Qe=Qe+Ne,Gt=Gt+te+(Qe>>>0<Ne>>>0?1:0),Qe=Qe+ro,Gt=Gt+xi+(Qe>>>0<ro>>>0?1:0),Wt.high=Gt,Wt.low=Qe}var Ha=at&he^~at&Ue,ri=ot&Ce^~ot&Le,xu=se&Be^se&Pt^Be&Pt,zl=me&ae^me&Vt^ae&Vt,Kt=(se>>>28|me<<4)^(se<<30|me>>>2)^(se<<25|me>>>7),ii=(me>>>28|se<<4)^(me<<30|se>>>2)^(me<<25|se>>>7),Hs=(at>>>14|ot<<18)^(at>>>18|ot<<14)^(at<<23|ot>>>9),Zo=(ot>>>14|at<<18)^(ot>>>18|at<<14)^(ot<<23|at>>>9),Zs=d[st],jl=Zs.high,V=Zs.low,j=$e+Zo,K=Pe+Hs+(j>>>0<$e>>>0?1:0),j=j+ri,K=K+Ha+(j>>>0<ri>>>0?1:0),j=j+V,K=K+jl+(j>>>0<V>>>0?1:0),j=j+Qe,K=K+Gt+(j>>>0<Qe>>>0?1:0),ce=ii+zl,ge=Kt+xu+(ce>>>0<ii>>>0?1:0);Pe=Ue,$e=Le,Ue=he,Le=Ce,he=at,Ce=ot,ot=ze+j|0,at=dn+K+(ot>>>0<ze>>>0?1:0)|0,dn=Pt,ze=Vt,Pt=Be,Vt=ae,Be=se,ae=me,me=j+ce|0,se=K+ge+(me>>>0<j>>>0?1:0)|0}T=v.low=T+me,v.high=D+se+(T>>>0<me>>>0?1:0),P=g.low=P+ae,g.high=R+Be+(P>>>0<ae>>>0?1:0),G=y.low=G+Vt,y.high=M+Pt+(G>>>0<Vt>>>0?1:0),q=I.low=q+ze,I.high=H+dn+(q>>>0<ze>>>0?1:0),Z=b.low=Z+ot,b.high=ie+at+(Z>>>0<ot>>>0?1:0),ne=E.low=ne+Ce,E.high=Q+he+(ne>>>0<Ce>>>0?1:0),z=w.low=z+Le,w.high=F+Ue+(z>>>0<Le>>>0?1:0),ee=k.low=ee+$e,k.high=J+Pe+(ee>>>0<$e>>>0?1:0)},_doFinalize:function(){var p=this._data,m=p.words,C=this._nDataBytes*8,v=p.sigBytes*8;m[v>>>5]|=128<<24-v%32,m[(v+128>>>10<<5)+30]=Math.floor(C/4294967296),m[(v+128>>>10<<5)+31]=C,p.sigBytes=m.length*4,this._process();var g=this._hash.toX32();return g},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p},blockSize:1024/32});r.SHA512=o._createHelper(h),r.HmacSHA512=o._createHmacHelper(h)}(),n.SHA512})}(jg)),jg.exports}var Hg={exports:{}},aA;function X6(){return aA||(aA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Fp(),oR())})(Ze,function(n){return function(){var r=n,i=r.x64,o=i.Word,s=i.WordArray,a=r.algo,l=a.SHA512,c=a.SHA384=l.extend({_doReset:function(){this._hash=new s.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var u=l._doFinalize.call(this);return u.sigBytes-=16,u}});r.SHA384=l._createHelper(c),r.HmacSHA384=l._createHmacHelper(c)}(),n.SHA384})}(Hg)),Hg.exports}var Zg={exports:{}},lA;function K6(){return lA||(lA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Fp())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.x64,c=l.Word,u=i.algo,d=[],f=[],h=[];(function(){for(var C=1,v=0,g=0;g<24;g++){d[C+5*v]=(g+1)*(g+2)/2%64;var y=v%5,I=(2*C+3*v)%5;C=y,v=I}for(var C=0;C<5;C++)for(var v=0;v<5;v++)f[C+5*v]=v+(2*C+3*v)%5*5;for(var b=1,E=0;E<24;E++){for(var w=0,k=0,D=0;D<7;D++){if(b&1){var T=(1<<D)-1;T<32?k^=1<<T:w^=1<<T-32}b&128?b=b<<1^113:b<<=1}h[E]=c.create(w,k)}})();var p=[];(function(){for(var C=0;C<25;C++)p[C]=c.create()})();var m=u.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var C=this._state=[],v=0;v<25;v++)C[v]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(C,v){for(var g=this._state,y=this.blockSize/2,I=0;I<y;I++){var b=C[v+2*I],E=C[v+2*I+1];b=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360;var w=g[I];w.high^=E,w.low^=b}for(var k=0;k<24;k++){for(var D=0;D<5;D++){for(var T=0,R=0,P=0;P<5;P++){var w=g[D+5*P];T^=w.high,R^=w.low}var M=p[D];M.high=T,M.low=R}for(var D=0;D<5;D++)for(var G=p[(D+4)%5],H=p[(D+1)%5],q=H.high,ie=H.low,T=G.high^(q<<1|ie>>>31),R=G.low^(ie<<1|q>>>31),P=0;P<5;P++){var w=g[D+5*P];w.high^=T,w.low^=R}for(var Z=1;Z<25;Z++){var T,R,w=g[Z],Q=w.high,ne=w.low,F=d[Z];F<32?(T=Q<<F|ne>>>32-F,R=ne<<F|Q>>>32-F):(T=ne<<F-32|Q>>>64-F,R=Q<<F-32|ne>>>64-F);var z=p[f[Z]];z.high=T,z.low=R}var J=p[0],ee=g[0];J.high=ee.high,J.low=ee.low;for(var D=0;D<5;D++)for(var P=0;P<5;P++){var Z=D+5*P,w=g[Z],se=p[Z],me=p[(D+1)%5+5*P],Be=p[(D+2)%5+5*P];w.high=se.high^~me.high&Be.high,w.low=se.low^~me.low&Be.low}var w=g[0],ae=h[k];w.high^=ae.high,w.low^=ae.low}},_doFinalize:function(){var C=this._data,v=C.words;this._nDataBytes*8;var g=C.sigBytes*8,y=this.blockSize*32;v[g>>>5]|=1<<24-g%32,v[(r.ceil((g+1)/y)*y>>>5)-1]|=128,C.sigBytes=v.length*4,this._process();for(var I=this._state,b=this.cfg.outputLength/8,E=b/8,w=[],k=0;k<E;k++){var D=I[k],T=D.high,R=D.low;T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,w.push(R),w.push(T)}return new s.init(w,b)},clone:function(){for(var C=a.clone.call(this),v=C._state=this._state.slice(0),g=0;g<25;g++)v[g]=v[g].clone();return C}});i.SHA3=a._createHelper(m),i.HmacSHA3=a._createHmacHelper(m)}(Math),n.SHA3})}(Zg)),Zg.exports}var $g={exports:{}},cA;function J6(){return cA||(cA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var i=n,o=i.lib,s=o.WordArray,a=o.Hasher,l=i.algo,c=s.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=s.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),d=s.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=s.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),h=s.create([0,1518500249,1859775393,2400959708,2840853838]),p=s.create([1352829926,1548603684,1836072691,2053994217,0]),m=l.RIPEMD160=a.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(E,w){for(var k=0;k<16;k++){var D=w+k,T=E[D];E[D]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}var R=this._hash.words,P=h.words,M=p.words,G=c.words,H=u.words,q=d.words,ie=f.words,Z,Q,ne,F,z,J,ee,se,me,Be;J=Z=R[0],ee=Q=R[1],se=ne=R[2],me=F=R[3],Be=z=R[4];for(var ae,k=0;k<80;k+=1)ae=Z+E[w+G[k]]|0,k<16?ae+=C(Q,ne,F)+P[0]:k<32?ae+=v(Q,ne,F)+P[1]:k<48?ae+=g(Q,ne,F)+P[2]:k<64?ae+=y(Q,ne,F)+P[3]:ae+=I(Q,ne,F)+P[4],ae=ae|0,ae=b(ae,q[k]),ae=ae+z|0,Z=z,z=F,F=b(ne,10),ne=Q,Q=ae,ae=J+E[w+H[k]]|0,k<16?ae+=I(ee,se,me)+M[0]:k<32?ae+=y(ee,se,me)+M[1]:k<48?ae+=g(ee,se,me)+M[2]:k<64?ae+=v(ee,se,me)+M[3]:ae+=C(ee,se,me)+M[4],ae=ae|0,ae=b(ae,ie[k]),ae=ae+Be|0,J=Be,Be=me,me=b(se,10),se=ee,ee=ae;ae=R[1]+ne+me|0,R[1]=R[2]+F+Be|0,R[2]=R[3]+z+J|0,R[3]=R[4]+Z+ee|0,R[4]=R[0]+Q+se|0,R[0]=ae},_doFinalize:function(){var E=this._data,w=E.words,k=this._nDataBytes*8,D=E.sigBytes*8;w[D>>>5]|=128<<24-D%32,w[(D+64>>>9<<4)+14]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,E.sigBytes=(w.length+1)*4,this._process();for(var T=this._hash,R=T.words,P=0;P<5;P++){var M=R[P];R[P]=(M<<8|M>>>24)&16711935|(M<<24|M>>>8)&4278255360}return T},clone:function(){var E=a.clone.call(this);return E._hash=this._hash.clone(),E}});function C(E,w,k){return E^w^k}function v(E,w,k){return E&w|~E&k}function g(E,w,k){return(E|~w)^k}function y(E,w,k){return E&k|w&~k}function I(E,w,k){return E^(w|~k)}function b(E,w){return E<<w|E>>>32-w}i.RIPEMD160=a._createHelper(m),i.HmacRIPEMD160=a._createHmacHelper(m)}(),n.RIPEMD160})}($g)),$g.exports}var Xg={exports:{}},uA;function O1(){return uA||(uA=1,function(t,e){(function(n,r){t.exports=r(it())})(Ze,function(n){(function(){var r=n,i=r.lib,o=i.Base,s=r.enc,a=s.Utf8,l=r.algo;l.HMAC=o.extend({init:function(c,u){c=this._hasher=new c.init,typeof u=="string"&&(u=a.parse(u));var d=c.blockSize,f=d*4;u.sigBytes>f&&(u=c.finalize(u)),u.clamp();for(var h=this._oKey=u.clone(),p=this._iKey=u.clone(),m=h.words,C=p.words,v=0;v<d;v++)m[v]^=1549556828,C[v]^=909522486;h.sigBytes=p.sigBytes=f,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var u=this._hasher,d=u.finalize(c);u.reset();var f=u.finalize(this._oKey.clone().concat(d));return f}})})()})}(Xg)),Xg.exports}var Kg={exports:{}},dA;function Y6(){return dA||(dA=1,function(t,e){(function(n,r,i){t.exports=r(it(),F1(),O1())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.Base,s=i.WordArray,a=r.algo,l=a.SHA256,c=a.HMAC,u=a.PBKDF2=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,f){for(var h=this.cfg,p=c.create(h.hasher,d),m=s.create(),C=s.create([1]),v=m.words,g=C.words,y=h.keySize,I=h.iterations;v.length<y;){var b=p.update(f).finalize(C);p.reset();for(var E=b.words,w=E.length,k=b,D=1;D<I;D++){k=p.finalize(k),p.reset();for(var T=k.words,R=0;R<w;R++)E[R]^=T[R]}m.concat(b),g[0]++}return m.sigBytes=y*4,m}});r.PBKDF2=function(d,f,h){return u.create(h).compute(d,f)}}(),n.PBKDF2})}(Kg)),Kg.exports}var Jg={exports:{}},fA;function za(){return fA||(fA=1,function(t,e){(function(n,r,i){t.exports=r(it(),iR(),O1())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.Base,s=i.WordArray,a=r.algo,l=a.MD5,c=a.EvpKDF=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,d){for(var f,h=this.cfg,p=h.hasher.create(),m=s.create(),C=m.words,v=h.keySize,g=h.iterations;C.length<v;){f&&p.update(f),f=p.update(u).finalize(d),p.reset();for(var y=1;y<g;y++)f=p.finalize(f),p.reset();m.concat(f)}return m.sigBytes=v*4,m}});r.EvpKDF=function(u,d,f){return c.create(f).compute(u,d)}}(),n.EvpKDF})}(Jg)),Jg.exports}var Yg={exports:{}},hA;function Tn(){return hA||(hA=1,function(t,e){(function(n,r,i){t.exports=r(it(),za())})(Ze,function(n){n.lib.Cipher||function(r){var i=n,o=i.lib,s=o.Base,a=o.WordArray,l=o.BufferedBlockAlgorithm,c=i.enc;c.Utf8;var u=c.Base64,d=i.algo,f=d.EvpKDF,h=o.Cipher=l.extend({cfg:s.extend(),createEncryptor:function(T,R){return this.create(this._ENC_XFORM_MODE,T,R)},createDecryptor:function(T,R){return this.create(this._DEC_XFORM_MODE,T,R)},init:function(T,R,P){this.cfg=this.cfg.extend(P),this._xformMode=T,this._key=R,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(T){return this._append(T),this._process()},finalize:function(T){T&&this._append(T);var R=this._doFinalize();return R},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function T(R){return typeof R=="string"?D:E}return function(R){return{encrypt:function(P,M,G){return T(M).encrypt(R,P,M,G)},decrypt:function(P,M,G){return T(M).decrypt(R,P,M,G)}}}}()});o.StreamCipher=h.extend({_doFinalize:function(){var T=this._process(!0);return T},blockSize:1});var p=i.mode={},m=o.BlockCipherMode=s.extend({createEncryptor:function(T,R){return this.Encryptor.create(T,R)},createDecryptor:function(T,R){return this.Decryptor.create(T,R)},init:function(T,R){this._cipher=T,this._iv=R}}),C=p.CBC=function(){var T=m.extend();T.Encryptor=T.extend({processBlock:function(P,M){var G=this._cipher,H=G.blockSize;R.call(this,P,M,H),G.encryptBlock(P,M),this._prevBlock=P.slice(M,M+H)}}),T.Decryptor=T.extend({processBlock:function(P,M){var G=this._cipher,H=G.blockSize,q=P.slice(M,M+H);G.decryptBlock(P,M),R.call(this,P,M,H),this._prevBlock=q}});function R(P,M,G){var H,q=this._iv;q?(H=q,this._iv=r):H=this._prevBlock;for(var ie=0;ie<G;ie++)P[M+ie]^=H[ie]}return T}(),v=i.pad={},g=v.Pkcs7={pad:function(T,R){for(var P=R*4,M=P-T.sigBytes%P,G=M<<24|M<<16|M<<8|M,H=[],q=0;q<M;q+=4)H.push(G);var ie=a.create(H,M);T.concat(ie)},unpad:function(T){var R=T.words[T.sigBytes-1>>>2]&255;T.sigBytes-=R}};o.BlockCipher=h.extend({cfg:h.cfg.extend({mode:C,padding:g}),reset:function(){var T;h.reset.call(this);var R=this.cfg,P=R.iv,M=R.mode;this._xformMode==this._ENC_XFORM_MODE?T=M.createEncryptor:(T=M.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==T?this._mode.init(this,P&&P.words):(this._mode=T.call(M,this,P&&P.words),this._mode.__creator=T)},_doProcessBlock:function(T,R){this._mode.processBlock(T,R)},_doFinalize:function(){var T,R=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(R.pad(this._data,this.blockSize),T=this._process(!0)):(T=this._process(!0),R.unpad(T)),T},blockSize:128/32});var y=o.CipherParams=s.extend({init:function(T){this.mixIn(T)},toString:function(T){return(T||this.formatter).stringify(this)}}),I=i.format={},b=I.OpenSSL={stringify:function(T){var R,P=T.ciphertext,M=T.salt;return M?R=a.create([1398893684,1701076831]).concat(M).concat(P):R=P,R.toString(u)},parse:function(T){var R,P=u.parse(T),M=P.words;return M[0]==1398893684&&M[1]==1701076831&&(R=a.create(M.slice(2,4)),M.splice(0,4),P.sigBytes-=16),y.create({ciphertext:P,salt:R})}},E=o.SerializableCipher=s.extend({cfg:s.extend({format:b}),encrypt:function(T,R,P,M){M=this.cfg.extend(M);var G=T.createEncryptor(P,M),H=G.finalize(R),q=G.cfg;return y.create({ciphertext:H,key:P,iv:q.iv,algorithm:T,mode:q.mode,padding:q.padding,blockSize:T.blockSize,formatter:M.format})},decrypt:function(T,R,P,M){M=this.cfg.extend(M),R=this._parse(R,M.format);var G=T.createDecryptor(P,M).finalize(R.ciphertext);return G},_parse:function(T,R){return typeof T=="string"?R.parse(T,this):T}}),w=i.kdf={},k=w.OpenSSL={execute:function(T,R,P,M,G){if(M||(M=a.random(64/8)),G)var H=f.create({keySize:R+P,hasher:G}).compute(T,M);else var H=f.create({keySize:R+P}).compute(T,M);var q=a.create(H.words.slice(R),P*4);return H.sigBytes=R*4,y.create({key:H,iv:q,salt:M})}},D=o.PasswordBasedCipher=E.extend({cfg:E.cfg.extend({kdf:k}),encrypt:function(T,R,P,M){M=this.cfg.extend(M);var G=M.kdf.execute(P,T.keySize,T.ivSize,M.salt,M.hasher);M.iv=G.iv;var H=E.encrypt.call(this,T,R,G.key,M);return H.mixIn(G),H},decrypt:function(T,R,P,M){M=this.cfg.extend(M),R=this._parse(R,M.format);var G=M.kdf.execute(P,T.keySize,T.ivSize,R.salt,M.hasher);M.iv=G.iv;var H=E.decrypt.call(this,T,R,G.key,M);return H}})}()})}(Yg)),Yg.exports}var qg={exports:{}},pA;function q6(){return pA||(pA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Tn())})(Ze,function(n){return n.mode.CFB=function(){var r=n.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize;i.call(this,o,s,l,a),this._prevBlock=o.slice(s,s+l)}}),r.Decryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize,c=o.slice(s,s+l);i.call(this,o,s,l,a),this._prevBlock=c}});function i(o,s,a,l){var c,u=this._iv;u?(c=u.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var d=0;d<a;d++)o[s+d]^=c[d]}return r}(),n.mode.CFB})}(qg)),qg.exports}var Qg={exports:{}},gA;function Q6(){return gA||(gA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Tn())})(Ze,function(n){return n.mode.CTR=function(){var r=n.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize,c=this._iv,u=this._counter;c&&(u=this._counter=c.slice(0),this._iv=void 0);var d=u.slice(0);a.encryptBlock(d,0),u[l-1]=u[l-1]+1|0;for(var f=0;f<l;f++)o[s+f]^=d[f]}});return r.Decryptor=i,r}(),n.mode.CTR})}(Qg)),Qg.exports}var em={exports:{}},mA;function e9(){return mA||(mA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Tn())})(Ze,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=function(){var r=n.lib.BlockCipherMode.extend();function i(a){if((a>>24&255)===255){var l=a>>16&255,c=a>>8&255,u=a&255;l===255?(l=0,c===255?(c=0,u===255?u=0:++u):++c):++l,a=0,a+=l<<16,a+=c<<8,a+=u}else a+=1<<24;return a}function o(a){return(a[0]=i(a[0]))===0&&(a[1]=i(a[1])),a}var s=r.Encryptor=r.extend({processBlock:function(a,l){var c=this._cipher,u=c.blockSize,d=this._iv,f=this._counter;d&&(f=this._counter=d.slice(0),this._iv=void 0),o(f);var h=f.slice(0);c.encryptBlock(h,0);for(var p=0;p<u;p++)a[l+p]^=h[p]}});return r.Decryptor=s,r}(),n.mode.CTRGladman})}(em)),em.exports}var tm={exports:{}},vA;function t9(){return vA||(vA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Tn())})(Ze,function(n){return n.mode.OFB=function(){var r=n.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,s){var a=this._cipher,l=a.blockSize,c=this._iv,u=this._keystream;c&&(u=this._keystream=c.slice(0),this._iv=void 0),a.encryptBlock(u,0);for(var d=0;d<l;d++)o[s+d]^=u[d]}});return r.Decryptor=i,r}(),n.mode.OFB})}(tm)),tm.exports}var nm={exports:{}},CA;function n9(){return CA||(CA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Tn())})(Ze,function(n){return n.mode.ECB=function(){var r=n.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(i,o){this._cipher.encryptBlock(i,o)}}),r.Decryptor=r.extend({processBlock:function(i,o){this._cipher.decryptBlock(i,o)}}),r}(),n.mode.ECB})}(nm)),nm.exports}var rm={exports:{}},yA;function r9(){return yA||(yA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Tn())})(Ze,function(n){return n.pad.AnsiX923={pad:function(r,i){var o=r.sigBytes,s=i*4,a=s-o%s,l=o+a-1;r.clamp(),r.words[l>>>2]|=a<<24-l%4*8,r.sigBytes+=a},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},n.pad.Ansix923})}(rm)),rm.exports}var im={exports:{}},xA;function i9(){return xA||(xA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Tn())})(Ze,function(n){return n.pad.Iso10126={pad:function(r,i){var o=i*4,s=o-r.sigBytes%o;r.concat(n.lib.WordArray.random(s-1)).concat(n.lib.WordArray.create([s<<24],1))},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},n.pad.Iso10126})}(im)),im.exports}var om={exports:{}},IA;function o9(){return IA||(IA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Tn())})(Ze,function(n){return n.pad.Iso97971={pad:function(r,i){r.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(r,i)},unpad:function(r){n.pad.ZeroPadding.unpad(r),r.sigBytes--}},n.pad.Iso97971})}(om)),om.exports}var sm={exports:{}},bA;function s9(){return bA||(bA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Tn())})(Ze,function(n){return n.pad.ZeroPadding={pad:function(r,i){var o=i*4;r.clamp(),r.sigBytes+=o-(r.sigBytes%o||o)},unpad:function(r){for(var i=r.words,o=r.sigBytes-1,o=r.sigBytes-1;o>=0;o--)if(i[o>>>2]>>>24-o%4*8&255){r.sigBytes=o+1;break}}},n.pad.ZeroPadding})}(sm)),sm.exports}var am={exports:{}},AA;function a9(){return AA||(AA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Tn())})(Ze,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})}(am)),am.exports}var lm={exports:{}},wA;function l9(){return wA||(wA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Tn())})(Ze,function(n){return function(r){var i=n,o=i.lib,s=o.CipherParams,a=i.enc,l=a.Hex,c=i.format;c.Hex={stringify:function(u){return u.ciphertext.toString(l)},parse:function(u){var d=l.parse(u);return s.create({ciphertext:d})}}}(),n.format.Hex})}(lm)),lm.exports}var cm={exports:{}},SA;function c9(){return SA||(SA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Ul(),Vl(),za(),Tn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.BlockCipher,s=r.algo,a=[],l=[],c=[],u=[],d=[],f=[],h=[],p=[],m=[],C=[];(function(){for(var y=[],I=0;I<256;I++)I<128?y[I]=I<<1:y[I]=I<<1^283;for(var b=0,E=0,I=0;I<256;I++){var w=E^E<<1^E<<2^E<<3^E<<4;w=w>>>8^w&255^99,a[b]=w,l[w]=b;var k=y[b],D=y[k],T=y[D],R=y[w]*257^w*16843008;c[b]=R<<24|R>>>8,u[b]=R<<16|R>>>16,d[b]=R<<8|R>>>24,f[b]=R;var R=T*16843009^D*65537^k*257^b*16843008;h[w]=R<<24|R>>>8,p[w]=R<<16|R>>>16,m[w]=R<<8|R>>>24,C[w]=R,b?(b=k^y[y[y[T^k]]],E^=y[y[E]]):b=E=1}})();var v=[0,1,2,4,8,16,32,64,128,27,54],g=s.AES=o.extend({_doReset:function(){var y;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var I=this._keyPriorReset=this._key,b=I.words,E=I.sigBytes/4,w=this._nRounds=E+6,k=(w+1)*4,D=this._keySchedule=[],T=0;T<k;T++)T<E?D[T]=b[T]:(y=D[T-1],T%E?E>6&&T%E==4&&(y=a[y>>>24]<<24|a[y>>>16&255]<<16|a[y>>>8&255]<<8|a[y&255]):(y=y<<8|y>>>24,y=a[y>>>24]<<24|a[y>>>16&255]<<16|a[y>>>8&255]<<8|a[y&255],y^=v[T/E|0]<<24),D[T]=D[T-E]^y);for(var R=this._invKeySchedule=[],P=0;P<k;P++){var T=k-P;if(P%4)var y=D[T];else var y=D[T-4];P<4||T<=4?R[P]=y:R[P]=h[a[y>>>24]]^p[a[y>>>16&255]]^m[a[y>>>8&255]]^C[a[y&255]]}}},encryptBlock:function(y,I){this._doCryptBlock(y,I,this._keySchedule,c,u,d,f,a)},decryptBlock:function(y,I){var b=y[I+1];y[I+1]=y[I+3],y[I+3]=b,this._doCryptBlock(y,I,this._invKeySchedule,h,p,m,C,l);var b=y[I+1];y[I+1]=y[I+3],y[I+3]=b},_doCryptBlock:function(y,I,b,E,w,k,D,T){for(var R=this._nRounds,P=y[I]^b[0],M=y[I+1]^b[1],G=y[I+2]^b[2],H=y[I+3]^b[3],q=4,ie=1;ie<R;ie++){var Z=E[P>>>24]^w[M>>>16&255]^k[G>>>8&255]^D[H&255]^b[q++],Q=E[M>>>24]^w[G>>>16&255]^k[H>>>8&255]^D[P&255]^b[q++],ne=E[G>>>24]^w[H>>>16&255]^k[P>>>8&255]^D[M&255]^b[q++],F=E[H>>>24]^w[P>>>16&255]^k[M>>>8&255]^D[G&255]^b[q++];P=Z,M=Q,G=ne,H=F}var Z=(T[P>>>24]<<24|T[M>>>16&255]<<16|T[G>>>8&255]<<8|T[H&255])^b[q++],Q=(T[M>>>24]<<24|T[G>>>16&255]<<16|T[H>>>8&255]<<8|T[P&255])^b[q++],ne=(T[G>>>24]<<24|T[H>>>16&255]<<16|T[P>>>8&255]<<8|T[M&255])^b[q++],F=(T[H>>>24]<<24|T[P>>>16&255]<<16|T[M>>>8&255]<<8|T[G&255])^b[q++];y[I]=Z,y[I+1]=Q,y[I+2]=ne,y[I+3]=F},keySize:256/32});r.AES=o._createHelper(g)}(),n.AES})}(cm)),cm.exports}var um={exports:{}},kA;function u9(){return kA||(kA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Ul(),Vl(),za(),Tn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.WordArray,s=i.BlockCipher,a=r.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=a.DES=s.extend({_doReset:function(){for(var v=this._key,g=v.words,y=[],I=0;I<56;I++){var b=l[I]-1;y[I]=g[b>>>5]>>>31-b%32&1}for(var E=this._subKeys=[],w=0;w<16;w++){for(var k=E[w]=[],D=u[w],I=0;I<24;I++)k[I/6|0]|=y[(c[I]-1+D)%28]<<31-I%6,k[4+(I/6|0)]|=y[28+(c[I+24]-1+D)%28]<<31-I%6;k[0]=k[0]<<1|k[0]>>>31;for(var I=1;I<7;I++)k[I]=k[I]>>>(I-1)*4+3;k[7]=k[7]<<5|k[7]>>>27}for(var T=this._invSubKeys=[],I=0;I<16;I++)T[I]=E[15-I]},encryptBlock:function(v,g){this._doCryptBlock(v,g,this._subKeys)},decryptBlock:function(v,g){this._doCryptBlock(v,g,this._invSubKeys)},_doCryptBlock:function(v,g,y){this._lBlock=v[g],this._rBlock=v[g+1],p.call(this,4,252645135),p.call(this,16,65535),m.call(this,2,858993459),m.call(this,8,16711935),p.call(this,1,1431655765);for(var I=0;I<16;I++){for(var b=y[I],E=this._lBlock,w=this._rBlock,k=0,D=0;D<8;D++)k|=d[D][((w^b[D])&f[D])>>>0];this._lBlock=w,this._rBlock=E^k}var T=this._lBlock;this._lBlock=this._rBlock,this._rBlock=T,p.call(this,1,1431655765),m.call(this,8,16711935),m.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),v[g]=this._lBlock,v[g+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function p(v,g){var y=(this._lBlock>>>v^this._rBlock)&g;this._rBlock^=y,this._lBlock^=y<<v}function m(v,g){var y=(this._rBlock>>>v^this._lBlock)&g;this._lBlock^=y,this._rBlock^=y<<v}r.DES=s._createHelper(h);var C=a.TripleDES=s.extend({_doReset:function(){var v=this._key,g=v.words;if(g.length!==2&&g.length!==4&&g.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var y=g.slice(0,2),I=g.length<4?g.slice(0,2):g.slice(2,4),b=g.length<6?g.slice(0,2):g.slice(4,6);this._des1=h.createEncryptor(o.create(y)),this._des2=h.createEncryptor(o.create(I)),this._des3=h.createEncryptor(o.create(b))},encryptBlock:function(v,g){this._des1.encryptBlock(v,g),this._des2.decryptBlock(v,g),this._des3.encryptBlock(v,g)},decryptBlock:function(v,g){this._des3.decryptBlock(v,g),this._des2.encryptBlock(v,g),this._des1.decryptBlock(v,g)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=s._createHelper(C)}(),n.TripleDES})}(um)),um.exports}var dm={exports:{}},EA;function d9(){return EA||(EA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Ul(),Vl(),za(),Tn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.StreamCipher,s=r.algo,a=s.RC4=o.extend({_doReset:function(){for(var u=this._key,d=u.words,f=u.sigBytes,h=this._S=[],p=0;p<256;p++)h[p]=p;for(var p=0,m=0;p<256;p++){var C=p%f,v=d[C>>>2]>>>24-C%4*8&255;m=(m+h[p]+v)%256;var g=h[p];h[p]=h[m],h[m]=g}this._i=this._j=0},_doProcessBlock:function(u,d){u[d]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var u=this._S,d=this._i,f=this._j,h=0,p=0;p<4;p++){d=(d+1)%256,f=(f+u[d])%256;var m=u[d];u[d]=u[f],u[f]=m,h|=u[(u[d]+u[f])%256]<<24-p*8}return this._i=d,this._j=f,h}r.RC4=o._createHelper(a);var c=s.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)l.call(this)}});r.RC4Drop=o._createHelper(c)}(),n.RC4})}(dm)),dm.exports}var fm={exports:{}},TA;function f9(){return TA||(TA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Ul(),Vl(),za(),Tn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.StreamCipher,s=r.algo,a=[],l=[],c=[],u=s.Rabbit=o.extend({_doReset:function(){for(var f=this._key.words,h=this.cfg.iv,p=0;p<4;p++)f[p]=(f[p]<<8|f[p]>>>24)&16711935|(f[p]<<24|f[p]>>>8)&4278255360;var m=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],C=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var p=0;p<4;p++)d.call(this);for(var p=0;p<8;p++)C[p]^=m[p+4&7];if(h){var v=h.words,g=v[0],y=v[1],I=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,E=I>>>16|b&4294901760,w=b<<16|I&65535;C[0]^=I,C[1]^=E,C[2]^=b,C[3]^=w,C[4]^=I,C[5]^=E,C[6]^=b,C[7]^=w;for(var p=0;p<4;p++)d.call(this)}},_doProcessBlock:function(f,h){var p=this._X;d.call(this),a[0]=p[0]^p[5]>>>16^p[3]<<16,a[1]=p[2]^p[7]>>>16^p[5]<<16,a[2]=p[4]^p[1]>>>16^p[7]<<16,a[3]=p[6]^p[3]>>>16^p[1]<<16;for(var m=0;m<4;m++)a[m]=(a[m]<<8|a[m]>>>24)&16711935|(a[m]<<24|a[m]>>>8)&4278255360,f[h+m]^=a[m]},blockSize:128/32,ivSize:64/32});function d(){for(var f=this._X,h=this._C,p=0;p<8;p++)l[p]=h[p];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var p=0;p<8;p++){var m=f[p]+h[p],C=m&65535,v=m>>>16,g=((C*C>>>17)+C*v>>>15)+v*v,y=((m&4294901760)*m|0)+((m&65535)*m|0);c[p]=g^y}f[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,f[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,f[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,f[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,f[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,f[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,f[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,f[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.Rabbit=o._createHelper(u)}(),n.Rabbit})}(fm)),fm.exports}var hm={exports:{}},RA;function h9(){return RA||(RA=1,function(t,e){(function(n,r,i){t.exports=r(it(),Ul(),Vl(),za(),Tn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.StreamCipher,s=r.algo,a=[],l=[],c=[],u=s.RabbitLegacy=o.extend({_doReset:function(){var f=this._key.words,h=this.cfg.iv,p=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],m=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var C=0;C<4;C++)d.call(this);for(var C=0;C<8;C++)m[C]^=p[C+4&7];if(h){var v=h.words,g=v[0],y=v[1],I=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,E=I>>>16|b&4294901760,w=b<<16|I&65535;m[0]^=I,m[1]^=E,m[2]^=b,m[3]^=w,m[4]^=I,m[5]^=E,m[6]^=b,m[7]^=w;for(var C=0;C<4;C++)d.call(this)}},_doProcessBlock:function(f,h){var p=this._X;d.call(this),a[0]=p[0]^p[5]>>>16^p[3]<<16,a[1]=p[2]^p[7]>>>16^p[5]<<16,a[2]=p[4]^p[1]>>>16^p[7]<<16,a[3]=p[6]^p[3]>>>16^p[1]<<16;for(var m=0;m<4;m++)a[m]=(a[m]<<8|a[m]>>>24)&16711935|(a[m]<<24|a[m]>>>8)&4278255360,f[h+m]^=a[m]},blockSize:128/32,ivSize:64/32});function d(){for(var f=this._X,h=this._C,p=0;p<8;p++)l[p]=h[p];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var p=0;p<8;p++){var m=f[p]+h[p],C=m&65535,v=m>>>16,g=((C*C>>>17)+C*v>>>15)+v*v,y=((m&4294901760)*m|0)+((m&65535)*m|0);c[p]=g^y}f[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,f[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,f[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,f[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,f[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,f[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,f[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,f[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.RabbitLegacy=o._createHelper(u)}(),n.RabbitLegacy})}(hm)),hm.exports}var pm={exports:{}},_A;function p9(){return _A||(_A=1,function(t,e){(function(n,r,i){t.exports=r(it(),Ul(),Vl(),za(),Tn())})(Ze,function(n){return function(){var r=n,i=r.lib,o=i.BlockCipher,s=r.algo;const a=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function d(C,v){let g=v>>24&255,y=v>>16&255,I=v>>8&255,b=v&255,E=C.sbox[0][g]+C.sbox[1][y];return E=E^C.sbox[2][I],E=E+C.sbox[3][b],E}function f(C,v,g){let y=v,I=g,b;for(let E=0;E<a;++E)y=y^C.pbox[E],I=d(C,y)^I,b=y,y=I,I=b;return b=y,y=I,I=b,I=I^C.pbox[a],y=y^C.pbox[a+1],{left:y,right:I}}function h(C,v,g){let y=v,I=g,b;for(let E=a+1;E>1;--E)y=y^C.pbox[E],I=d(C,y)^I,b=y,y=I,I=b;return b=y,y=I,I=b,I=I^C.pbox[1],y=y^C.pbox[0],{left:y,right:I}}function p(C,v,g){for(let w=0;w<4;w++){C.sbox[w]=[];for(let k=0;k<256;k++)C.sbox[w][k]=c[w][k]}let y=0;for(let w=0;w<a+2;w++)C.pbox[w]=l[w]^v[y],y++,y>=g&&(y=0);let I=0,b=0,E=0;for(let w=0;w<a+2;w+=2)E=f(C,I,b),I=E.left,b=E.right,C.pbox[w]=I,C.pbox[w+1]=b;for(let w=0;w<4;w++)for(let k=0;k<256;k+=2)E=f(C,I,b),I=E.left,b=E.right,C.sbox[w][k]=I,C.sbox[w][k+1]=b;return!0}var m=s.Blowfish=o.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var C=this._keyPriorReset=this._key,v=C.words,g=C.sigBytes/4;p(u,v,g)}},encryptBlock:function(C,v){var g=f(u,C[v],C[v+1]);C[v]=g.left,C[v+1]=g.right},decryptBlock:function(C,v){var g=h(u,C[v],C[v+1]);C[v]=g.left,C[v+1]=g.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=o._createHelper(m)}(),n.Blowfish})}(pm)),pm.exports}(function(t,e){(function(n,r,i){t.exports=r(it(),Fp(),j6(),H6(),Ul(),Z6(),Vl(),iR(),F1(),$6(),oR(),X6(),K6(),J6(),O1(),Y6(),za(),Tn(),q6(),Q6(),e9(),t9(),n9(),r9(),i9(),o9(),s9(),a9(),l9(),c9(),u9(),d9(),f9(),h9(),p9())})(Ze,function(n){return n})})(rR);var g9=rR.exports;const DA=eu(g9);class Br extends Error{constructor(e,n){super(n),this.code=e,this.name="FileTransferError"}}const bi={CONNECTION_FAILED:"CONNECTION_FAILED",TRANSFER_TIMEOUT:"TRANSFER_TIMEOUT",INVALID_FILE:"INVALID_FILE",DATA_CHANNEL_ERROR:"DATA_CHANNEL_ERROR"};class m9 extends Ep{constructor(n,r){super();L(this,"webRTCService");L(this,"client");L(this,"gmcpFileTransfer");L(this,"chunkSize",16384);L(this,"transferTimeoutInterval");L(this,"incomingTransfers",new Map);L(this,"outgoingTransfers",new Map);L(this,"maxFileSize",100*1024*1024);L(this,"transferTimeout",3e4);L(this,"pendingOffers",new Map);this.client=n,this.gmcpFileTransfer=r,this.webRTCService=n.webRTCService,this.setupListeners()}isDataChannelReady(){return this.webRTCService.isDataChannelOpen()}setupListeners(){this.webRTCService.on("dataChannelMessage",this.handleIncomingChunk.bind(this)),this.client.on("fileTransferAccepted",this.handleAcceptedTransfer.bind(this)),this.transferTimeoutInterval=window.setInterval(()=>this.checkTransferTimeouts(),5e3)}async initializeWebRTC(){await this.webRTCService.createPeerConnection()}async sendFile(n,r){if(n.size>this.maxFileSize)throw new Br(bi.INVALID_FILE,`File size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);const i=await this.computeFileHash(n);console.log(`[FileTransferManager] Computed hash for ${n.name}: ${i}`),console.log(`[FileTransferManager] Registering outgoing transfer for file: ${n.name}`),this.outgoingTransfers.set(i,{file:n,filename:n.name,hash:i,lastActivityTimestamp:Date.now()});try{await this.initializeWebRTC(),this.webRTCService.recipient=r;const o=await this.webRTCService.createOffer();console.log(`[FileTransferManager] Sending offer for file: ${n.name}`),await this.gmcpFileTransfer.sendOffer(r,n.name,n.size,JSON.stringify(o),i),await this.webRTCService.waitForConnection()}catch(o){console.error(`[FileTransferManager] Failed to send file ${n.name}:`,o),this.handleTransferError(i,n.name,"send",o instanceof Br?o:new Br(bi.CONNECTION_FAILED,"Failed to establish connection")),this.cleanupTransfer(i)}}async computeFileHash(n){return new Promise((r,i)=>{const o=new FileReader;o.onload=()=>{if(o.result instanceof ArrayBuffer){const s=DA.lib.WordArray.create(o.result),a=DA.SHA256(s).toString();r(a)}else i(new Error("Failed to read file for hashing"))},o.onerror=()=>i(o.error),o.readAsArrayBuffer(n)})}async startFileTransfer(n,r){let i=0;const o=new FileReader;for(;i<n.size;){const s=n.slice(i,i+this.chunkSize),a=await new Promise((c,u)=>{o.onload=()=>{o.result instanceof ArrayBuffer?c(o.result):u(new Br(bi.INVALID_FILE,"Failed to read file chunk"))},o.onerror=()=>u(new Br(bi.INVALID_FILE,"Error reading file")),o.readAsArrayBuffer(s)});await this.sendChunk(n.name,r,a,i,n.size),i+=a.byteLength;const l={hash:r,filename:n.name,sentBytes:i,totalBytes:n.size};this.emit("fileSendProgress",l)}}async sendChunk(n,r,i,o,s){try{const a={hash:r,filename:n,chunkIndex:Math.floor(o/this.chunkSize),totalChunks:Math.ceil(s/this.chunkSize),chunkSize:i.byteLength,totalSize:s},l=JSON.stringify(a),c=new TextEncoder().encode(l),u=new ArrayBuffer(4);new DataView(u).setUint32(0,c.byteLength,!0);const d=new Uint8Array(4+c.byteLength+i.byteLength);d.set(new Uint8Array(u),0),d.set(c,4),d.set(new Uint8Array(i),4+c.byteLength),await this.webRTCService.sendData(d.buffer)}catch{throw new Br(bi.DATA_CHANNEL_ERROR,"Failed to send chunk")}}async handleAcceptedTransfer(n){console.log("[FileTransferManager] Handling accepted transfer for file transfer request ",n);const{sender:r,hash:i,filename:o,answerSdp:s}=n,a=this.outgoingTransfers.get(i);if(!a){const l=`No outgoing transfer found for hash: ${i} (${o}). Active transfers: ${Array.from(this.outgoingTransfers.keys()).join(", ")}`;console.error(`[FileTransferManager] ${l}`),this.client.onFileTransferError(i,o,"send",l);return}try{console.log(`[FileTransferManager] Processing WebRTC answer for file: ${o}`);const l=JSON.parse(s);console.log(`[FileTransferManager] Answer object for file: ${o}`,l),await this.webRTCService.handleAnswer(l),console.log(`[FileTransferManager] Waiting for data channel to open for file: ${o}`),await this.waitForDataChannel(i),console.log(`[FileTransferManager] Data channel ready for outgoing transfer of: ${o}`),await this.startFileTransfer(a.file,a.hash),console.log(`[FileTransferManager] File transfer completed successfully: ${o}`),this.client.onFileSendComplete(i,o)}catch(l){console.error(`[FileTransferManager] Error in accepted transfer for ${o}:`,l),this.handleTransferError(i,o,"send",l)}finally{console.log(`[FileTransferManager] Cleaning up successful transfer: ${o} (${i})`),this.outgoingTransfers.delete(i)}}async waitForDataChannel(n){return new Promise((r,i)=>{if(this.isDataChannelReady()){console.log(`[FileTransferManager] Data channel already ready for ${n}`),r();return}console.log(`[FileTransferManager] Waiting for data channel to open for ${n}`);const o=()=>{console.log(`[FileTransferManager] Data channel opened via event for ${n}`),clearInterval(l),clearTimeout(c),this.webRTCService.off("dataChannelOpen",o),r()};this.webRTCService.on("dataChannelOpen",o);let s=0;const a=150,l=setInterval(()=>{s++,console.log(`[FileTransferManager] Data channel check attempt ${s}/${a} for ${n}`),this.isDataChannelReady()?(console.log(`[FileTransferManager] Data channel ready on attempt ${s} for ${n}`),clearInterval(l),clearTimeout(c),this.webRTCService.off("dataChannelOpen",o),r()):s%30===0&&(console.log(`[FileTransferManager] Attempting to nudge WebRTC connection for ${n}`),this.webRTCService.emit("connectionCheck"))},100),c=setTimeout(()=>{console.log(`[FileTransferManager] Data channel timeout after ${a} attempts for ${n}`),clearInterval(l),this.webRTCService.off("dataChannelOpen",o),this.webRTCService.attemptChannelRecovery().then(()=>{this.isDataChannelReady()?(console.log(`[FileTransferManager] Data channel recovered after timeout for ${n}`),r()):i(new Br(bi.CONNECTION_FAILED,`Data channel failed to open for transfer ${n} after ${a} attempts`))}).catch(u=>{i(new Br(bi.CONNECTION_FAILED,`Data channel recovery failed for ${n}: ${u.message}`))})},a*100+1e3)})}async handleIncomingChunk(n){try{if(n.byteLength<4)throw new Error("Received data is too short to contain header size");const r=new Uint8Array(n.slice(0,4)),i=new DataView(r.buffer).getUint32(0,!0);if(n.byteLength<4+i)throw new Error("Received data is too short to contain header");const o=new TextDecoder().decode(n.slice(4,4+i)),s=JSON.parse(o);if(n.byteLength<4+i+s.chunkSize)throw new Error("Received data is too short to contain chunk data");const a=this.pendingOffers.get(s.hash),l=(a==null?void 0:a.sender)||"unknown";if(typeof s.chunkIndex!="number"||s.chunkIndex<0||s.chunkIndex>=s.totalChunks)throw new Error("Invalid chunk index in header");if(typeof s.totalChunks!="number"||s.totalChunks<=0)throw new Error("Invalid total chunks in header");const c=n.slice(4+i,4+i+s.chunkSize);let u=this.incomingTransfers.get(s.hash);if(!u){if(s.totalSize>this.maxFileSize){this.client.onFileTransferError(s.hash,s.filename,"receive",`Incoming file size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);return}u={hash:s.hash,filename:s.filename,totalSize:s.totalSize,receivedSize:0,chunks:new Array(s.totalChunks),lastActivityTimestamp:Date.now(),sender:l},this.incomingTransfers.set(s.hash,u)}u.chunks[s.chunkIndex]=c,u.receivedSize+=c.byteLength,u.lastActivityTimestamp=Date.now();const d={hash:s.hash,filename:s.filename,receivedBytes:u.receivedSize,totalBytes:u.totalSize};if(this.emit("fileReceiveProgress",d),u.receivedSize===u.totalSize)if(u.chunks.every(f=>f)){const f=new Blob(u.chunks),h=new File([f],u.filename,{type:f.type});if(await this.computeFileHash(h)!==u.hash){this.client.onFileTransferError(u.hash,s.filename,"receive","File integrity check failed - hash mismatch"),this.incomingTransfers.delete(u.hash);return}const m=window.URL.createObjectURL(f),C=document.createElement("a");C.href=m,C.download=s.filename,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(m);const v={hash:u.hash,filename:s.filename,file:f};this.emit("fileReceiveComplete",v),this.incomingTransfers.delete(u.hash)}else this.client.onFileTransferError(u.hash,s.filename,"receive","Missing chunks in received file")}catch(r){this.handleTransferError("unknown","unknown_file","receive",new Br("UNKNOWN_ERROR",r instanceof Error?r.message:"Unknown error"))}}handleTransferError(n,r,i,o){console.error(`Error ${i}ing file ${r} (${n}):`,o);const s=o instanceof Error?o.message:"Unknown error";this.client.onFileTransferError(n,r,i,s),this.cleanupTransfer(n),this.attemptRecovery(n,r,i)}cleanupTransfer(n){console.log(`[FileTransferManager] Starting cleanup for hash: ${n}`);const r=this.outgoingTransfers.get(n);r&&(console.log(`[FileTransferManager] Cleaning up outgoing transfer for: ${r.filename} (${n})`),this.outgoingTransfers.delete(n));const i=this.incomingTransfers.get(n);if(i&&(console.log(`[FileTransferManager] Cleaning up incoming transfer for: ${i.filename} (${n})`),this.incomingTransfers.delete(n)),this.pendingOffers.has(n)){const o=this.pendingOffers.get(n);console.log(`[FileTransferManager] Removing pending offer for: ${o==null?void 0:o.filename} (${n})`),this.pendingOffers.delete(n)}console.log(`[FileTransferManager] Cleanup complete for hash: ${n}`)}async attemptRecovery(n,r,i){try{if(await this.webRTCService.createPeerConnection(),this.client.onConnectionRecovered({hash:n,filename:r,direction:i}),i==="send"){const o=this.outgoingTransfers.get(n);o&&await this.startFileTransfer(o.file,o.hash)}else if(i==="receive"){const o=this.incomingTransfers.get(n);o&&this.gmcpFileTransfer.sendRequestResend(o.sender,n)}}catch(o){console.error("Failed to recover connection:",o),this.client.onRecoveryFailed({filename:r,direction:i,error:o instanceof Error?o.message:"Unknown error"})}}checkTransferTimeouts(){const n=Date.now();this.incomingTransfers.forEach((r,i)=>{n-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"receive",new Br(bi.TRANSFER_TIMEOUT,"Transfer timeout - no data received"))}),this.outgoingTransfers.forEach((r,i)=>{n-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"send",new Br(bi.TRANSFER_TIMEOUT,"Transfer timeout - no activity"))})}cleanup(){this.transferTimeoutInterval&&(clearInterval(this.transferTimeoutInterval),this.transferTimeoutInterval=void 0),[...this.outgoingTransfers.keys()].forEach(n=>this.cancelTransfer(n)),[...this.incomingTransfers.keys()].forEach(n=>this.cancelTransfer(n)),this.incomingTransfers.clear(),this.outgoingTransfers.clear(),this.pendingOffers.clear(),this.webRTCService.cleanup()}cancelTransfer(n){const r=this.outgoingTransfers.get(n)||this.incomingTransfers.get(n);r?(console.log(`[FileTransferManager] Cancelling transfer for hash: ${n} (${r.filename})`),this.cleanupTransfer(n),this.client.onFileTransferCancel(this.client.worldData.playerId,n),this.gmcpFileTransfer.sendCancel(this.client.worldData.playerId,n)):console.log(`[FileTransferManager] No active transfer found for hash: ${n}`)}async acceptTransfer(n,r){if(console.log("[FileTransferManager] Accepting transfer",n,r),this.incomingTransfers.has(r))throw new Error("Already receiving this file");const i=this.pendingOffers.get(r);if(console.log("[FileTransferManager] Checking pending offers:",Array.from(this.pendingOffers.entries())),!i)throw new Br(bi.INVALID_FILE,`No pending offer found for transfer with hash: ${r}`);console.log("[FileTransferManager] Found pending offer for transfer:",{sender:n,hash:r,filename:i.filename,filesize:i.filesize});try{typeof this.webRTCService.close=="function"?this.webRTCService.close():console.log("[FileTransferManager] WebRTCService.close not available, skipping connection close"),await this.initializeWebRTC(),this.webRTCService.recipient=n,console.log("[FileTransferManager] Setting remote description with offer"),await this.webRTCService.handleOffer(JSON.parse(i.offerSdp)),console.log("[FileTransferManager] Creating WebRTC answer");const o=await this.webRTCService.createAnswer();if(console.log("[FileTransferManager] WebRTC answer created successfully"),this.pendingOffers.has(r)){await this.gmcpFileTransfer.sendAccept(n,r,i.filename,JSON.stringify(o));try{console.log("[FileTransferManager] Waiting for data channel to open"),await this.waitForDataChannel(r),console.log("[FileTransferManager] Data channel ready for incoming transfer"),this.pendingOffers.delete(r)}catch(s){console.error("[FileTransferManager] Data channel failed to open:",s),console.log("[FileTransferManager] Attempting one more connection with fresh WebRTC setup"),typeof this.webRTCService.close=="function"?this.webRTCService.close():console.log("[FileTransferManager] WebRTCService.close not available, skipping connection close"),await this.initializeWebRTC(),this.webRTCService.recipient=n,await this.webRTCService.handleOffer(JSON.parse(i.offerSdp));const a=await this.webRTCService.createAnswer();await this.gmcpFileTransfer.sendAccept(n,r,i.filename,JSON.stringify(a)),await this.waitForDataChannel(r),console.log("[FileTransferManager] Data channel ready after retry"),this.pendingOffers.delete(r)}}else throw new Error("Transfer was cancelled during setup")}catch(o){throw console.error("Failed to accept transfer:",o),this.cleanupTransfer(r),new Br(bi.CONNECTION_FAILED,`Failed to accept transfer: ${o instanceof Error?o.message:"Unknown error"}`)}}}class v9 extends Ep{constructor(n,r){super();L(this,"ws");L(this,"decoder",new TextDecoder("utf8"));L(this,"telnet");L(this,"_connected",!1);L(this,"intentionalDisconnect",!1);L(this,"host");L(this,"port");L(this,"telnetNegotiation",!1);L(this,"telnetBuffer","");L(this,"gmcpHandlers",{});L(this,"mcpHandlers",{});L(this,"mcpMultilines",{});L(this,"mcpAuthKey",null);L(this,"mcp_negotiate");L(this,"mcp_getset");L(this,"gmcp_char");L(this,"gmcp_fileTransfer");L(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[]});L(this,"cacophony");L(this,"editors");L(this,"webRTCService");L(this,"fileTransferManager");L(this,"_autosay",!1);this.host=n,this.port=r,this.mcp_negotiate=this.registerMcpPackage(P6),this.mcp_getset=this.registerMcpPackage(F6),this.gmcp_char=this.registerGMCPPackage(N4),this.gmcp_fileTransfer=this.registerGMCPPackage(G2),this.cacophony=new UL,this.cacophony.setGlobalVolume(go.getState().general.volume),this.editors=new D4(this),this.webRTCService=new U6(this),this.fileTransferManager=new m9(this,this.gmcp_fileTransfer)}get connected(){return this._connected}get autosay(){return this._autosay}set autosay(n){this._autosay=n,this.emit("autosayChanged",n)}async sendFile(n,r){await this.fileTransferManager.sendFile(n,r)}cancelTransfer(n){this.fileTransferManager.cancelTransfer(n)}acceptTransfer(n,r){this.fileTransferManager.acceptTransfer(n,r)}rejectTransfer(n,r){this.gmcp_fileTransfer.sendReject(n,r)}onFileTransferOffer(n,r,i,o,s){console.log("[MudClient] Emitting fileTransferOffer event:",{sender:n,hash:r,filename:i,filesize:o,offerSdp:s}),this.emit("fileTransferOffer",{sender:n,hash:r,filename:i,filesize:o,offerSdp:s})}onFileTransferAccept(n,r,i,o){console.log("[MudClient] Emitting fileTransferAccepted event:",{sender:n,hash:r,filename:i,answerSdp:o}),this.emit("fileTransferAccepted",{sender:n,hash:r,filename:i,answerSdp:o})}onFileTransferReject(n,r){this.emit("fileTransferRejected",{sender:n,hash:r})}onFileTransferCancel(n,r){this.emit("fileTransferCancelled",{sender:n,hash:r})}onFileSendComplete(n,r){this.emit("fileSendComplete",{hash:n,filename:r})}onFileTransferError(n,r,i,o){this.emit("fileTransferError",{hash:n,filename:r,direction:i,error:o})}onConnectionRecovered(n){this.emit("connectionRecovered",n)}onRecoveryFailed(n){this.emit("recoveryFailed",n)}sendFileTransferOffer(n,r,i,o,s){this.gmcp_fileTransfer.sendOffer(n,r,o,s,i)}sendFileTransferAccept(n,r,i,o){this.gmcp_fileTransfer.sendAccept(n,i,r,o)}registerGMCPPackage(n){const r=new n(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(n){const r=new n(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.intentionalDisconnect=!1,this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new E4(new k4(this.ws)),this.ws.onopen=()=>{this._connected=!0,this.emit("connect"),this.emit("connectionChange",!0)},this.telnet.on("data",n=>{this.handleData(n)}),this.telnet.on("negotiation",(n,r)=>{n===Qu.WILL&&r===qu.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(Qu.DO,qu.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):n===Qu.DO&&r===qu.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(Qu.WILL,qu.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(n,r)=>{console.log("GMCP Package:",n,r);try{this.handleGmcpData(n,r)}catch(i){console.error("Calling GMCP:",i)}}),this.ws.onclose=()=>{this.cleanupConnection(),this.intentionalDisconnect||setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=n=>{this.emit("error",n)}}send(n){this.ws.send(n)}cleanupConnection(){this._connected=!1,this.mcpAuthKey=null,this.telnetBuffer="",this.telnetNegotiation=!1,this.webRTCService.cleanup(),this.fileTransferManager.cleanup(),this.emit("disconnect"),this.emit("connectionChange",!1)}close(){this.intentionalDisconnect=!0,this.ws&&this.ws.close(),this.cleanupConnection()}sendCommand(n){go.getState().general.localEcho&&this.emit("command",n),this.autosay&&!n.startsWith("-")&&!n.startsWith("'")&&(n="say "+n),this.send(n+`\r
`),console.log("> "+n)}handleData(n){const r=this.decoder.decode(n).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(n){if(n.startsWith("#$#*")){const i=Xb(n.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(n.startsWith("#$#:")){const i=Xb(n.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=D6(n.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=Kb(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(n,r){const i=n.lastIndexOf("."),o=n.substring(0,i),s=n.substring(i+1);console.log("GMCP Message:",o,s,r);const a=this.gmcpHandlers[o];if(!a){console.log("No handler for GMCP package:",o);return}const l=a["handle"+s];if(l){console.log("Calling handler for:",s,l);let c;typeof r=="string"&&r.trim()!==""?c=r:(console.warn(`GMCP message data for ${o}.${s} is missing or empty. Defaulting to {}. Original data:`,r),c="{}");try{const u=JSON.parse(c);l.call(a,u)}catch(u){console.error(`Error parsing GMCP JSON for ${o}.${s}:`,u),console.error("Attempted to parse:",c)}}else console.log("No handler on package:",o,s)}emitMessage(n){const r=go.getState().speech.autoreadMode;r===hC.All&&this.speak(n),r===hC.Unfocused&&!document.hasFocus()&&this.speak(n),this.emit("message",n)}sendGmcp(n,r){console.log("Sending GMCP:",n,r),this.telnet.sendGmcp(n,r)}sendMcp(n,r){if(typeof r=="object"){let o="";for(const[s,a]of Object.entries(r))o+=` ${s}: ${a||'""'}`;r=o}const i=`#$#${n} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(n,r,i){this.send(`#$#* ${n} ${r}: ${i}\r
`)}closeMcpML(n){this.send(`#$#: ${n}\r
`)}sendMCPMultiline(n,r,i){const o=Kb();r["_data-tag"]=o,this.sendMcp(n,r);for(const s of i)this.sendMcpMLLine(o,"content",s);this.closeMcpML(o)}shutdown(){Object.values(this.mcpHandlers).forEach(n=>{n.shutdown()}),Object.values(this.gmcpHandlers).forEach(n=>{n.shutdown()}),this.editors.shutdown(),this.webRTCService.cleanup(),this.fileTransferManager.cleanup()}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(n,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(n,{body:r})}speak(n){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(_4(n));r.lang="en-US";const{rate:i,pitch:o,voice:s,volume:a}=go.getState().speech;r.rate=i,r.pitch=o,r.volume=a;const c=speechSynthesis.getVoices().find(u=>u.name===s);c&&(r.voice=c),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}}class C9{constructor(){L(this,"history",[]);L(this,"currentIndex",-1);L(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&this.history.push(e.trim()),this.currentIndex=-1,this.unsentInput=""}navigateUp(e){return this.currentIndex===-1&&(this.unsentInput=e),this.history.length>0&&this.currentIndex<this.history.length-1&&this.currentIndex++,this.history.length>0?this.history[this.history.length-1-this.currentIndex]:""}navigateDown(e){return this.currentIndex===-1&&(this.unsentInput=e),this.currentIndex>0?(this.currentIndex--,this.history[this.history.length-1-this.currentIndex]):(this.currentIndex=-1,this.unsentInput)}getCurrentInput(){return this.currentIndex===-1?this.unsentInput:this.history[this.history.length-1-this.currentIndex]}getHistory(){return[...this.history]}}const y9=()=>{const[,t]=S.useReducer(e=>e+1,0);return S.useEffect(()=>bc.subscribe(t),[]),[bc.getState(),bc.dispatch]},PA="command_history",x9=1e3,I9=({onSend:t,inputRef:e})=>{const n=S.useRef(new C9),[r,i]=y9();S.useEffect(()=>{const l=localStorage.getItem(PA);l&&JSON.parse(l).forEach(u=>{n.current.addCommand(u)})},[]);const o=()=>{try{const c=n.current.getHistory().slice(-x9);localStorage.setItem(PA,JSON.stringify(c))}catch(l){console.warn("Failed to save command history:",l)}},s=S.useCallback(l=>{const c=n.current,u=r.text;if(l.key==="Enter"&&!l.shiftKey)l.preventDefault(),a();else if(l.key==="ArrowUp"){l.preventDefault();const d=c.navigateUp(u);Eh(d)}else if(l.key==="ArrowDown"){l.preventDefault();const d=c.navigateDown(u);Eh(d)}},[r.text]),a=S.useCallback(()=>{var c;const l=r.text;l.trim()&&(t(l),n.current.addCommand(l),o(),F4(),(c=e.current)==null||c.focus())},[r.text,t,e]);return X.jsxs("div",{className:"command-input-container",children:[X.jsx("textarea",{value:r.text,onChange:l=>Eh(l.target.value),onKeyDown:s,id:"command-input",ref:e,autoFocus:!0}),X.jsx("button",{onClick:a,className:"send-button",children:"Send"})]})},sR=7e3;let oo=null;function NA(t,e="assertive",n=sR){oo?oo.announce(t,e,n):(oo=new b9,(typeof IS_REACT_ACT_ENVIRONMENT=="boolean"?IS_REACT_ACT_ENVIRONMENT:typeof jest<"u")?oo.announce(t,e,n):setTimeout(()=>{oo!=null&&oo.isAttached()&&(oo==null||oo.announce(t,e,n))},100))}class b9{isAttached(){var e;return(e=this.node)===null||e===void 0?void 0:e.isConnected}createLog(e){let n=document.createElement("div");return n.setAttribute("role","log"),n.setAttribute("aria-live",e),n.setAttribute("aria-relevant","additions"),n}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,n="assertive",r=sR){var i,o;if(!this.node)return;let s=document.createElement("div");typeof e=="object"?(s.setAttribute("role","img"),s.setAttribute("aria-labelledby",e["aria-labelledby"])):s.textContent=e,n==="assertive"?(i=this.assertiveLog)===null||i===void 0||i.appendChild(s):(o=this.politeLog)===null||o===void 0||o.appendChild(s),e!==""&&setTimeout(()=>{s.remove()},r)}clear(e){this.node&&((!e||e==="assertive")&&this.assertiveLog&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&this.politeLog&&(this.politeLog.innerHTML=""))}constructor(){this.node=null,this.assertiveLog=null,this.politeLog=null,typeof document<"u"&&(this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node))}}var BA=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function A9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Ks=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],w9=/(https?:\/\/(?:[A-Za-z0-9#;/?:@=+$',_.!~*()[\]-]|&amp;|%[A-Fa-f0-9]{2})+)/gm,S9=function(){BA(t,null,[{key:"escapeForHtml",value:function(n){return new t().escapeForHtml(n)}},{key:"linkify",value:function(n){return new t().linkify(n)}},{key:"ansiToHtml",value:function(n,r){return new t().ansiToHtml(n,r)}},{key:"ansiToJson",value:function(n,r){return new t().ansiToJson(n,r)}},{key:"ansiToText",value:function(n){return new t().ansiToText(n)}}]);function t(){A9(this,t),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return BA(t,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var n=0;n<2;++n)for(var r=0;r<8;++r)this.PALETTE_COLORS.push(Ks[n][r].color);for(var i=[0,95,135,175,215,255],o=function(f,h,p){return i[f]+", "+i[h]+", "+i[p]},s=0;s<6;++s)for(var a=0;a<6;++a)for(var l=0;l<6;++l)this.PALETTE_COLORS.push(o(s,a,l));for(var c=8,u=0;u<24;++u,c+=10)this.PALETTE_COLORS.push(o(c,c,c))}},{key:"escapeForHtml",value:function(n){return n.replace(/[&<>\"]/gm,function(r){return r=="&"?"&amp;":r=='"'?"&quot;":r=="<"?"&lt;":r==">"?"&gt;":""})}},{key:"linkify",value:function(n){return n.replace(w9,function(r){return'<a href="'+r+'">'+r+"</a>"})}},{key:"ansiToHtml",value:function(n,r){return this.process(n,r,!0)}},{key:"ansiToJson",value:function(n,r){return r=r||{},r.json=!0,r.clearLine=!1,this.process(n,r,!0)}},{key:"ansiToText",value:function(n){return this.process(n,{},!1)}},{key:"process",value:function(n,r,i){var o=this,s=this,a=n.split(/\033\[/),l=a.shift();r==null&&(r={}),r.clearLine=/\r/.test(n);var c=a.map(function(d){return o.processChunk(d,r,i)});if(r&&r.json){var u=s.processChunkJson("");return u.content=l,u.clearLine=r.clearLine,c.unshift(u),r.remove_empty&&(c=c.filter(function(d){return!d.isEmpty()})),c}else c.unshift(l);return c.join("")}},{key:"processChunkJson",value:function(n,r,i){r=typeof r>"u"?{}:r;var o=r.use_classes=typeof r.use_classes<"u"&&r.use_classes,s=r.key=o?"class":"color",a={content:n,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:r.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!a.content}},l=n.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!l)return a;a.content=l[4];var c=l[2].split(";");if(l[1]!==""||l[3]!=="m"||!i)return a;for(var u=this;c.length>0;){var d=c.shift(),f=parseInt(d);if(isNaN(f)||f===0)u.fg=u.bg=null,u.decorations=[];else if(f===1)u.decorations.push("bold");else if(f===2)u.decorations.push("dim");else if(f===3)u.decorations.push("italic");else if(f===4)u.decorations.push("underline");else if(f===5)u.decorations.push("blink");else if(f===7)u.decorations.push("reverse");else if(f===8)u.decorations.push("hidden");else if(f===9)u.decorations.push("strikethrough");else if(f===21)u.removeDecoration("bold");else if(f===22)u.removeDecoration("bold"),u.removeDecoration("dim");else if(f===23)u.removeDecoration("italic");else if(f===24)u.removeDecoration("underline");else if(f===25)u.removeDecoration("blink");else if(f===27)u.removeDecoration("reverse");else if(f===28)u.removeDecoration("hidden");else if(f===29)u.removeDecoration("strikethrough");else if(f===39)u.fg=null;else if(f===49)u.bg=null;else if(f>=30&&f<38)u.fg=Ks[0][f%10][s];else if(f>=90&&f<98)u.fg=Ks[1][f%10][s];else if(f>=40&&f<48)u.bg=Ks[0][f%10][s];else if(f>=100&&f<108)u.bg=Ks[1][f%10][s];else if(f===38||f===48){var h=f===38;if(c.length>=1){var p=c.shift();if(p==="5"&&c.length>=1){var m=parseInt(c.shift());if(m>=0&&m<=255)if(!o)this.PALETTE_COLORS||u.setupPalette(),h?u.fg=this.PALETTE_COLORS[m]:u.bg=this.PALETTE_COLORS[m];else{var C=m>=16?"ansi-palette-"+m:Ks[m>7?1:0][m%8].class;h?u.fg=C:u.bg=C}}else if(p==="2"&&c.length>=3){var v=parseInt(c.shift()),g=parseInt(c.shift()),y=parseInt(c.shift());if(v>=0&&v<=255&&g>=0&&g<=255&&y>=0&&y<=255){var I=v+", "+g+", "+y;o?h?(u.fg="ansi-truecolor",u.fg_truecolor=I):(u.bg="ansi-truecolor",u.bg_truecolor=I):h?u.fg=I:u.bg=I}}}}}return u.fg===null&&u.bg===null&&u.decorations.length===0||(a.fg=u.fg,a.bg=u.bg,a.fg_truecolor=u.fg_truecolor,a.bg_truecolor=u.bg_truecolor,a.decorations=u.decorations,a.decoration=u.decorations.slice(-1).pop()||null,a.was_processed=!0),a}},{key:"processChunk",value:function(n,r,i){var o=this;r=r||{};var s=this.processChunkJson(n,r,i),a=r.use_classes;if(s.decorations=s.decorations.filter(function(h){if(h==="reverse"){s.fg||(s.fg=Ks[0][7][a?"class":"color"]),s.bg||(s.bg=Ks[0][0][a?"class":"color"]);var p=s.fg;s.fg=s.bg,s.bg=p;var m=s.fg_truecolor;return s.fg_truecolor=s.bg_truecolor,s.bg_truecolor=m,s.isInverted=!0,!1}return!0}),r.json)return s;if(s.isEmpty())return"";if(!s.was_processed)return s.content;var l=[],c=[],u=[],d={},f=function(p){var m=[],C=void 0;for(C in p)p.hasOwnProperty(C)&&m.push("data-"+C+'="'+o.escapeForHtml(p[C])+'"');return m.length>0?" "+m.join(" "):""};return s.isInverted&&(d["ansi-is-inverted"]="true"),s.fg&&(a?(l.push(s.fg+"-fg"),s.fg_truecolor!==null&&(d["ansi-truecolor-fg"]=s.fg_truecolor,s.fg_truecolor=null)):l.push("color:rgb("+s.fg+")")),s.bg&&(a?(l.push(s.bg+"-bg"),s.bg_truecolor!==null&&(d["ansi-truecolor-bg"]=s.bg_truecolor,s.bg_truecolor=null)):l.push("background-color:rgb("+s.bg+")")),s.decorations.forEach(function(h){if(a){c.push("ansi-"+h);return}h==="bold"?c.push("font-weight:bold"):h==="dim"?c.push("opacity:0.5"):h==="italic"?c.push("font-style:italic"):h==="hidden"?c.push("visibility:hidden"):h==="strikethrough"?u.push("line-through"):u.push(h)}),u.length&&c.push("text-decoration:"+u.join(" ")),a?'<span class="'+l.concat(c).join(" ")+'"'+f(d)+">"+s.content+"</span>":'<span style="'+l.concat(c).join(";")+'"'+f(d)+">"+s.content+"</span>"}},{key:"removeDecoration",value:function(n){var r=this.decorations.indexOf(n);r>=0&&this.decorations.splice(r,1)}}]),t}(),k9=S9;const E9=eu(k9);function T9(t,e){let n=[];for(const r of t.split(`\r
`)){const i=E9.ansiToJson(r,{json:!0,remove_empty:!1});let o=[];for(const s of i){const a=P9(s,e);o=[...o,...a]}n=[...n,X.jsx("span",{children:o},n.length)]}return n}const R9=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,_9=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,D9=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function P9(t,e){const n=N9(t),r=[];let i=0,o=0;function s(u,d){let f;for(;(f=u.exec(t.content))!==null;){const h=f.index;h>i&&r.push(t.content.substring(i,h)),r.push(d(f)),i=u.lastIndex}}function a(u){const[,d,f]=u,h=f;return X.jsxs(X.Fragment,{children:[d,X.jsx("a",{href:h,target:"_blank",rel:"noreferrer",children:f})]})}function l(u){const d=u.groups.name,f=`mailto:${d}`;return X.jsxs(X.Fragment,{children:[u.groups.slorp1,X.jsx("a",{href:f,target:"_blank",rel:"noreferrer",children:d}),u.groups.slorp2]})}function c(u){const[,d,f]=u;return X.jsx("a",{onClick:()=>e(d),className:"exit",children:f})}return s(R9,a),s(_9,l),s(D9,c),i<t.content.length&&r.push(t.content.substring(i)),r.map(u=>X.jsx("span",{style:n,children:u},o++))}function N9(t){const e={};switch(t.bg&&(e.backgroundColor=`rgb(${t.bg})`),t.fg&&(e.color=`rgb(${t.fg})`),t.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}var Na={},du={},aR=S;function We(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xr=Object.prototype.hasOwnProperty,B9=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,FA={},OA={};function lR(t){return xr.call(OA,t)?!0:xr.call(FA,t)?!1:B9.test(t)?OA[t]=!0:(FA[t]=!0,!1)}function gr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ln[t]=new gr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ln[e]=new gr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ln[t]=new gr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ln[t]=new gr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ln[t]=new gr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ln[t]=new gr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ln[t]=new gr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ln[t]=new gr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ln[t]=new gr(t,5,!1,t.toLowerCase(),null,!1,!1)});var M1=/[\-:]([a-z])/g;function L1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(M1,L1);Ln[e]=new gr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(M1,L1);Ln[e]=new gr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(M1,L1);Ln[e]=new gr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ln[t]=new gr(t,1,!1,t.toLowerCase(),null,!1,!1)});Ln.xlinkHref=new gr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ln[t]=new gr(t,1,!1,t.toLowerCase(),null,!0,!0)});var Ph={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},F9=["Webkit","ms","Moz","O"];Object.keys(Ph).forEach(function(t){F9.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ph[e]=Ph[t]})});var O9=/["'&<>]/;function or(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=O9.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var M9=/([A-Z])/g,L9=/^ms-/,pC=Array.isArray;function $o(t,e){return{insertionMode:t,selectedValue:e}}function U9(t,e,n){switch(e){case"select":return $o(1,n.value!=null?n.value:n.defaultValue);case"svg":return $o(2,null);case"math":return $o(3,null);case"foreignObject":return $o(1,null);case"table":return $o(4,null);case"thead":case"tbody":case"tfoot":return $o(5,null);case"colgroup":return $o(7,null);case"tr":return $o(6,null)}return 4<=t.insertionMode||t.insertionMode===0?$o(1,null):t}var MA=new Map;function cR(t,e,n){if(typeof n!="object")throw Error(We(62));e=!0;for(var r in n)if(xr.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=or(r);i=or((""+i).trim())}else{o=r;var s=MA.get(o);s!==void 0||(s=or(o.replace(M9,"-$1").toLowerCase().replace(L9,"-ms-")),MA.set(o,s)),o=s,i=typeof i=="number"?i===0||xr.call(Ph,r)?""+i:i+"px":or((""+i).trim())}e?(e=!1,t.push(' style="',o,":",i)):t.push(";",o,":",i)}}e||t.push('"')}function Fr(t,e,n,r){switch(n){case"style":cR(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=Ln.hasOwnProperty(n)?Ln[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=e.attributeName,e.type){case 3:r&&t.push(" ",n,'=""');break;case 4:r===!0?t.push(" ",n,'=""'):r!==!1&&t.push(" ",n,'="',or(r),'"');break;case 5:isNaN(r)||t.push(" ",n,'="',or(r),'"');break;case 6:!isNaN(r)&&1<=r&&t.push(" ",n,'="',or(r),'"');break;default:e.sanitizeURL&&(r=""+r),t.push(" ",n,'="',or(r),'"')}}else if(lR(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(" ",n,'="',or(r),'"')}}}function Nh(t,e,n){if(e!=null){if(n!=null)throw Error(We(60));if(typeof e!="object"||!("__html"in e))throw Error(We(61));e=e.__html,e!=null&&t.push(""+e)}}function V9(t){var e="";return aR.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}function gm(t,e,n,r){t.push(ao(n));var i=n=null,o;for(o in e)if(xr.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:Fr(t,r,o,s)}}return t.push(">"),Nh(t,i,n),typeof n=="string"?(t.push(or(n)),null):n}var G9=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,LA=new Map;function ao(t){var e=LA.get(t);if(e===void 0){if(!G9.test(t))throw Error(We(65,t));e="<"+t,LA.set(t,e)}return e}function W9(t,e,n,r,i){switch(e){case"select":t.push(ao("select"));var o=null,s=null;for(u in n)if(xr.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:Fr(t,r,u,a)}}return t.push(">"),Nh(t,s,o),o;case"option":s=i.selectedValue,t.push(ao("option"));var l=a=null,c=null,u=null;for(o in n)if(xr.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":c=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":l=d;default:Fr(t,r,o,d)}}if(s!=null)if(n=l!==null?""+l:V9(a),pC(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(' selected=""');break}}else""+s===n&&t.push(' selected=""');else c&&t.push(' selected=""');return t.push(">"),Nh(t,u,a),a;case"textarea":t.push(ao("textarea")),u=s=o=null;for(a in n)if(xr.call(n,a)&&(l=n[a],l!=null))switch(a){case"children":u=l;break;case"value":o=l;break;case"defaultValue":s=l;break;case"dangerouslySetInnerHTML":throw Error(We(91));default:Fr(t,r,a,l)}if(o===null&&s!==null&&(o=s),t.push(">"),u!=null){if(o!=null)throw Error(We(92));if(pC(u)&&1<u.length)throw Error(We(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o!==null&&t.push(or(""+o)),null;case"input":t.push(ao("input")),l=u=a=o=null;for(s in n)if(xr.call(n,s)&&(c=n[s],c!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(We(399,"input"));case"defaultChecked":l=c;break;case"defaultValue":a=c;break;case"checked":u=c;break;case"value":o=c;break;default:Fr(t,r,s,c)}return u!==null?Fr(t,r,"checked",u):l!==null&&Fr(t,r,"checked",l),o!==null?Fr(t,r,"value",o):a!==null&&Fr(t,r,"value",a),t.push("/>"),null;case"menuitem":t.push(ao("menuitem"));for(var f in n)if(xr.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(We(400));default:Fr(t,r,f,o)}return t.push(">"),null;case"title":t.push(ao("title")),o=null;for(d in n)if(xr.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(We(434));default:Fr(t,r,d,s)}return t.push(">"),o;case"listing":case"pre":t.push(ao(e)),s=o=null;for(l in n)if(xr.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:Fr(t,r,l,a)}if(t.push(">"),s!=null){if(o!=null)throw Error(We(60));if(typeof s!="object"||!("__html"in s))throw Error(We(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(`
`,n):t.push(""+n))}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(ao(e));for(var h in n)if(xr.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(We(399,e));default:Fr(t,r,h,o)}return t.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return gm(t,n,e,r);case"html":return i.insertionMode===0&&t.push("<!DOCTYPE html>"),gm(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return gm(t,n,e,r);t.push(ao(e)),s=o=null;for(c in n)if(xr.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":cR(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:lR(c)&&typeof a!="function"&&typeof a!="symbol"&&t.push(" ",c,'="',or(a),'"')}return t.push(">"),Nh(t,s,o),o}}function UA(t,e,n){if(t.push('<!--$?--><template id="'),n===null)throw Error(We(395));return t.push(n),t.push('"></template>')}function z9(t,e,n,r){switch(n.insertionMode){case 0:case 1:return t.push('<div hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 2:return t.push('<svg aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 3:return t.push('<math aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 4:return t.push('<table hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 5:return t.push('<table hidden><tbody id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 6:return t.push('<table hidden><tr id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 7:return t.push('<table hidden><colgroup id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');default:throw Error(We(397))}}function j9(t,e){switch(e.insertionMode){case 0:case 1:return t.push("</div>");case 2:return t.push("</svg>");case 3:return t.push("</math>");case 4:return t.push("</table>");case 5:return t.push("</tbody></table>");case 6:return t.push("</tr></table>");case 7:return t.push("</colgroup></table>");default:throw Error(We(397))}}var H9=/[<\u2028\u2029]/g;function mm(t){return JSON.stringify(t).replace(H9,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function Z9(t,e){return e=e===void 0?"":e,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:e+"P:",segmentPrefix:e+"S:",boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:t}}function VA(t,e,n,r){return n.generateStaticMarkup?(t.push(or(e)),!1):(e===""?t=r:(r&&t.push("<!-- -->"),t.push(or(e)),t=!0),t)}var yd=Object.assign,$9=Symbol.for("react.element"),uR=Symbol.for("react.portal"),dR=Symbol.for("react.fragment"),fR=Symbol.for("react.strict_mode"),hR=Symbol.for("react.profiler"),pR=Symbol.for("react.provider"),gR=Symbol.for("react.context"),mR=Symbol.for("react.forward_ref"),vR=Symbol.for("react.suspense"),CR=Symbol.for("react.suspense_list"),yR=Symbol.for("react.memo"),U1=Symbol.for("react.lazy"),X9=Symbol.for("react.scope"),K9=Symbol.for("react.debug_trace_mode"),J9=Symbol.for("react.legacy_hidden"),Y9=Symbol.for("react.default_value"),GA=Symbol.iterator;function gC(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case dR:return"Fragment";case uR:return"Portal";case hR:return"Profiler";case fR:return"StrictMode";case vR:return"Suspense";case CR:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gR:return(t.displayName||"Context")+".Consumer";case pR:return(t._context.displayName||"Context")+".Provider";case mR:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case yR:return e=t.displayName||null,e!==null?e:gC(t.type)||"Memo";case U1:e=t._payload,t=t._init;try{return gC(t(e))}catch{}}return null}var xR={};function WA(t,e){if(t=t.contextTypes,!t)return xR;var n={},r;for(r in t)n[r]=e[r];return n}var ll=null;function Op(t,e){if(t!==e){t.context._currentValue2=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(We(401))}else{if(n===null)throw Error(We(401));Op(t,n)}e.context._currentValue2=e.value}}function IR(t){t.context._currentValue2=t.parentValue,t=t.parent,t!==null&&IR(t)}function bR(t){var e=t.parent;e!==null&&bR(e),t.context._currentValue2=t.value}function AR(t,e){if(t.context._currentValue2=t.parentValue,t=t.parent,t===null)throw Error(We(402));t.depth===e.depth?Op(t,e):AR(t,e)}function wR(t,e){var n=e.parent;if(n===null)throw Error(We(402));t.depth===n.depth?Op(t,n):wR(t,n),e.context._currentValue2=e.value}function U0(t){var e=ll;e!==t&&(e===null?bR(t):t===null?IR(e):e.depth===t.depth?Op(e,t):e.depth>t.depth?AR(e,t):wR(e,t),ll=t)}var zA={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function jA(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=zA,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue2:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:yd({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&zA.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=yd({},o,a)):yd(o,a))}t.state=o}else o.queue=null}var q9={id:1,overflow:""};function mC(t,e,n){var r=t.id;t=t.overflow;var i=32-Bh(r)-1;r&=~(1<<i),n+=1;var o=32-Bh(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-Bh(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var Bh=Math.clz32?Math.clz32:t7,Q9=Math.log,e7=Math.LN2;function t7(t){return t>>>=0,t===0?32:31-(Q9(t)/e7|0)|0}function n7(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var r7=typeof Object.is=="function"?Object.is:n7,Fs=null,V1=null,Fh=null,Et=null,td=!1,V0=!1,Xd=0,ha=null,Mp=0;function Qa(){if(Fs===null)throw Error(We(321));return Fs}function HA(){if(0<Mp)throw Error(We(312));return{memoizedState:null,queue:null,next:null}}function G1(){return Et===null?Fh===null?(td=!1,Fh=Et=HA()):(td=!0,Et=Fh):Et.next===null?(td=!1,Et=Et.next=HA()):(td=!0,Et=Et.next),Et}function W1(){V1=Fs=null,V0=!1,Fh=null,Mp=0,Et=ha=null}function SR(t,e){return typeof e=="function"?e(t):e}function ZA(t,e,n){if(Fs=Qa(),Et=G1(),td){var r=Et.queue;if(e=r.dispatch,ha!==null&&(n=ha.get(r),n!==void 0)){ha.delete(r),r=Et.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return Et.memoizedState=r,[r,e]}return[Et.memoizedState,e]}return t=t===SR?typeof e=="function"?e():e:n!==void 0?n(e):e,Et.memoizedState=t,t=Et.queue={last:null,dispatch:null},t=t.dispatch=i7.bind(null,Fs,t),[Et.memoizedState,t]}function $A(t,e){if(Fs=Qa(),Et=G1(),e=e===void 0?null:e,Et!==null){var n=Et.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!r7(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),Et.memoizedState=[t,e],t}function i7(t,e,n){if(25<=Mp)throw Error(We(301));if(t===Fs)if(V0=!0,t={action:n,next:null},ha===null&&(ha=new Map),n=ha.get(e),n===void 0)ha.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function o7(){throw Error(We(394))}function nh(){}var XA={readContext:function(t){return t._currentValue2},useContext:function(t){return Qa(),t._currentValue2},useMemo:$A,useReducer:ZA,useRef:function(t){Fs=Qa(),Et=G1();var e=Et.memoizedState;return e===null?(t={current:t},Et.memoizedState=t):e},useState:function(t){return ZA(SR,t)},useInsertionEffect:nh,useLayoutEffect:function(){},useCallback:function(t,e){return $A(function(){return t},e)},useImperativeHandle:nh,useEffect:nh,useDebugValue:nh,useDeferredValue:function(t){return Qa(),t},useTransition:function(){return Qa(),[!1,o7]},useId:function(){var t=V1.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-Bh(t)-1)).toString(32)+e;var n=Oh;if(n===null)throw Error(We(404));return e=Xd++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return Qa(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(We(407));return n()}},Oh=null,vm=aR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function s7(t){return console.error(t),null}function nd(){}function a7(t,e,n,r,i,o,s,a,l){var c=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?s7:i,onAllReady:nd,onShellReady:s===void 0?nd:s,onShellError:nd,onFatalError:nd},n=G0(e,0,null,n,!1,!1),n.parentFlushed=!0,t=z1(e,t,null,n,u,xR,null,q9),c.push(t),e}function z1(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var l={node:e,ping:function(){var c=t.pingedTasks;c.push(l),c.length===1&&TR(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(l),l}function G0(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function Kd(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function W0(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,t.destination.destroy(e)):(t.status=1,t.fatalError=e)}function KA(t,e,n,r,i){for(Fs={},V1=e,Xd=0,t=n(r,i);V0;)V0=!1,Xd=0,Mp+=1,Et=null,t=n(r,i);return W1(),t}function JA(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(We(108,gC(r)||"Unknown",a));r=yd({},s,n)}e.legacyContext=r,Wr(t,e,i),e.legacyContext=s}else Wr(t,e,i)}function YA(t,e){if(t&&t.defaultProps){e=yd({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function vC(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=WA(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue2:i),jA(o,n,r,i),JA(t,e,o,n)}else{o=WA(n,e.legacyContext),i=KA(t,e,n,r,o);var s=Xd!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)jA(i,n,r,o),JA(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=mC(r,1,0);try{Wr(t,e,i)}finally{e.treeContext=r}}else Wr(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=W9(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=U9(s,n,r),CC(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push("</",n,">")}i.lastPushedText=!1}else{switch(n){case J9:case K9:case fR:case hR:case dR:Wr(t,e,r.children);return;case CR:Wr(t,e,r.children);return;case X9:throw Error(We(343));case vR:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},l=G0(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(l),i.lastPushedText=!1;var c=G0(t,0,null,i.formatContext,!1,!1);c.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=c;try{if(CC(t,e,r),t.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("<!-- -->"),c.status=1,z0(a,c),a.pendingTasks===0)break e}catch(u){c.status=4,a.forceClientRender=!0,a.errorDigest=Kd(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=z1(t,o,n,l,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case mR:if(r=KA(t,e,n.render,r,i),Xd!==0){n=e.treeContext,e.treeContext=mC(n,1,0);try{Wr(t,e,r)}finally{e.treeContext=n}}else Wr(t,e,r);return;case yR:n=n.type,r=YA(n,r),vC(t,e,n,r,i);return;case pR:if(i=r.children,n=n._context,r=r.value,o=n._currentValue2,n._currentValue2=r,s=ll,ll=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,Wr(t,e,i),t=ll,t===null)throw Error(We(403));r=t.parentValue,t.context._currentValue2=r===Y9?t.context._defaultValue:r,t=ll=t.parent,e.context=t;return;case gR:r=r.children,r=r(n._currentValue2),Wr(t,e,r);return;case U1:i=n._init,n=i(n._payload),r=YA(n,r),vC(t,e,n,r,void 0);return}throw Error(We(130,n==null?n:typeof n,""))}}function Wr(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case $9:vC(t,e,n.type,n.props,n.ref);return;case uR:throw Error(We(257));case U1:var r=n._init;n=r(n._payload),Wr(t,e,n);return}if(pC(n)){qA(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=GA&&n[GA]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);qA(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(We(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=VA(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=VA(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function qA(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=mC(o,r,i);try{CC(t,e,n[i])}finally{e.treeContext=o}}}function CC(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return Wr(t,e,n)}catch(l){if(W1(),typeof l=="object"&&l!==null&&typeof l.then=="function"){n=l;var s=e.blockedSegment,a=G0(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=z1(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,U0(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,U0(o),l}}function l7(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,ER(this,e,t)}function kR(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.push(null))):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(We(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return kR(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function z0(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&z0(t,n)}else t.completedSegments.push(e)}function ER(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(We(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=nd,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&z0(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(l7,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(z0(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function TR(t){if(t.status!==2){var e=ll,n=vm.current;vm.current=XA;var r=Oh;Oh=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,l=s.blockedSegment;if(l.status===0){U0(s.context);try{Wr(a,s,s.node),a.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),s.abortSet.delete(s),l.status=1,ER(a,s.blockedBoundary,l)}catch(p){if(W1(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var c=s.ping;p.then(c,c)}else{s.abortSet.delete(s),l.status=4;var u=s.blockedBoundary,d=p,f=Kd(a,d);if(u===null?W0(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,o),t.destination!==null&&j1(t,t.destination)}catch(p){Kd(t,p),W0(t,p)}finally{Oh=r,vm.current=n,n===XA&&U0(e)}}}function rh(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,e.push('<template id="'),e.push(t.placeholderPrefix),t=r.toString(16),e.push(t),e.push('"></template>');case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)e.push(r[o]);i=Lp(t,e,i)}for(;o<r.length-1;o++)e.push(r[o]);return o<r.length&&(i=e.push(r[o])),i;default:throw Error(We(390))}}function Lp(t,e,n){var r=n.boundary;if(r===null)return rh(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)return t.responseState.generateStaticMarkup||(r=r.errorDigest,e.push("<!--$!-->"),e.push("<template"),r&&(e.push(' data-dgst="'),r=or(r),e.push(r),e.push('"')),e.push("></template>")),rh(t,e,n),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t;if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;return i=i.boundaryPrefix+o.toString(16),r=r.id=i,UA(e,t.responseState,r),rh(t,e,n),e.push("<!--/$-->")}if(r.byteSize>t.progressiveChunkSize)return r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),UA(e,t.responseState,r.id),rh(t,e,n),e.push("<!--/$-->");if(t.responseState.generateStaticMarkup||e.push("<!--$-->"),n=r.completedSegments,n.length!==1)throw Error(We(391));return Lp(t,e,n[0]),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t}function QA(t,e,n){return z9(e,t.responseState,n.formatContext,n.id),Lp(t,e,n),j9(e,n.formatContext)}function ew(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)RR(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,e.push(t.startInlineScript),t.sentCompleteBoundaryFunction?e.push('$RC("'):(t.sentCompleteBoundaryFunction=!0,e.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),r===null)throw Error(We(395));return n=n.toString(16),e.push(r),e.push('","'),e.push(t.segmentPrefix),e.push(n),e.push('")<\/script>')}function RR(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(We(392));return QA(t,e,r)}return QA(t,e,r),t=t.responseState,e.push(t.startInlineScript),t.sentCompleteSegmentFunction?e.push('$RS("'):(t.sentCompleteSegmentFunction=!0,e.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),e.push(t.segmentPrefix),i=i.toString(16),e.push(i),e.push('","'),e.push(t.placeholderPrefix),e.push(i),e.push('")<\/script>')}function j1(t,e){try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){Lp(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)e.push(r[n]);n<r.length&&e.push(r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,l=s.id,c=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(r.push(a.startInlineScript),a.sentClientRenderFunction?r.push('$RX("'):(a.sentClientRenderFunction=!0,r.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),l===null)throw Error(We(395));if(r.push(l),r.push('"'),c||u||d){r.push(",");var f=mm(c||"");r.push(f)}if(u||d){r.push(",");var h=mm(u||"");r.push(h)}if(d){r.push(",");var p=mm(d);r.push(p)}if(!r.push(")<\/script>")){t.destination=null,o++,i.splice(0,o);return}}i.splice(0,o);var m=t.completedBoundaries;for(o=0;o<m.length;o++)if(!ew(t,e,m[o])){t.destination=null,o++,m.splice(0,o);return}m.splice(0,o);var C=t.partialBoundaries;for(o=0;o<C.length;o++){var v=C[o];e:{i=t,s=e;var g=v.completedSegments;for(a=0;a<g.length;a++)if(!RR(i,s,v,g[a])){a++,g.splice(0,a);var y=!1;break e}g.splice(0,a),y=!0}if(!y){t.destination=null,o++,C.splice(0,o);return}}C.splice(0,o);var I=t.completedBoundaries;for(o=0;o<I.length;o++)if(!ew(t,e,I[o])){t.destination=null,o++,I.splice(0,o);return}I.splice(0,o)}finally{t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.push(null)}}function c7(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return kR(r,t,e)}),n.clear(),t.destination!==null&&j1(t,t.destination)}catch(r){Kd(t,r),W0(t,r)}}function u7(){}function _R(t,e,n,r){var i=!1,o=null,s="",a={push:function(c){return c!==null&&(s+=c),!0},destroy:function(c){i=!0,o=c}},l=!1;if(t=a7(t,Z9(n,e?e.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,u7,void 0,function(){l=!0}),TR(t),c7(t,r),t.status===1)t.status=2,a.destroy(t.fatalError);else if(t.status!==2&&t.destination===null){t.destination=a;try{j1(t,a)}catch(c){Kd(t,c),W0(t,c)}}if(i)throw o;if(!l)throw Error(We(426));return s}du.renderToNodeStream=function(){throw Error(We(207))};du.renderToStaticMarkup=function(t,e){return _R(t,e,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};du.renderToStaticNodeStream=function(){throw Error(We(208))};du.renderToString=function(t,e){return _R(t,e,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};du.version="18.3.1";var H1={},DR=S;function Xe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zr=null,jr=0;function _e(t,e){if(e.length!==0)if(512<e.length)0<jr&&(t.enqueue(new Uint8Array(zr.buffer,0,jr)),zr=new Uint8Array(512),jr=0),t.enqueue(e);else{var n=zr.length-jr;n<e.length&&(n===0?t.enqueue(zr):(zr.set(e.subarray(0,n),jr),t.enqueue(zr),e=e.subarray(n)),zr=new Uint8Array(512),jr=0),zr.set(e,jr),jr+=e.length}}function Mt(t,e){return _e(t,e),!0}function tw(t){zr&&0<jr&&(t.enqueue(new Uint8Array(zr.buffer,0,jr)),zr=null,jr=0)}var PR=new TextEncoder;function Ke(t){return PR.encode(t)}function ye(t){return PR.encode(t)}function NR(t,e){typeof t.error=="function"?t.error(e):t.close()}var Ir=Object.prototype.hasOwnProperty,d7=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,nw={},rw={};function BR(t){return Ir.call(rw,t)?!0:Ir.call(nw,t)?!1:d7.test(t)?rw[t]=!0:(nw[t]=!0,!1)}function mr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Un={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Un[t]=new mr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Un[e]=new mr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Un[t]=new mr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Un[t]=new mr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Un[t]=new mr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Un[t]=new mr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Un[t]=new mr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Un[t]=new mr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Un[t]=new mr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Z1=/[\-:]([a-z])/g;function $1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Z1,$1);Un[e]=new mr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Z1,$1);Un[e]=new mr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Z1,$1);Un[e]=new mr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Un[t]=new mr(t,1,!1,t.toLowerCase(),null,!1,!1)});Un.xlinkHref=new mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Un[t]=new mr(t,1,!1,t.toLowerCase(),null,!0,!0)});var Mh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},f7=["Webkit","ms","Moz","O"];Object.keys(Mh).forEach(function(t){f7.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Mh[e]=Mh[t]})});var h7=/["'&<>]/;function Nn(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=h7.exec(t);if(e){var n="",r,i=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}i!==r&&(n+=t.substring(i,r)),i=r+1,n+=e}t=i!==r?n+t.substring(i,r):n}return t}var p7=/([A-Z])/g,g7=/^ms-/,yC=Array.isArray,m7=ye("<script>"),v7=ye("<\/script>"),C7=ye('<script src="'),y7=ye('<script type="module" src="'),iw=ye('" async=""><\/script>'),x7=/(<\/|<)(s)(cript)/gi;function I7(t,e,n,r){return""+e+(n==="s"?"\\u0073":"\\u0053")+r}function b7(t,e,n,r,i){t=t===void 0?"":t,e=e===void 0?m7:ye('<script nonce="'+Nn(e)+'">');var o=[];if(n!==void 0&&o.push(e,Ke((""+n).replace(x7,I7)),v7),r!==void 0)for(n=0;n<r.length;n++)o.push(C7,Ke(Nn(r[n])),iw);if(i!==void 0)for(r=0;r<i.length;r++)o.push(y7,Ke(Nn(i[r])),iw);return{bootstrapChunks:o,startInlineScript:e,placeholderPrefix:ye(t+"P:"),segmentPrefix:ye(t+"S:"),boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function lo(t,e){return{insertionMode:t,selectedValue:e}}function A7(t){return lo(t==="http://www.w3.org/2000/svg"?2:t==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function w7(t,e,n){switch(e){case"select":return lo(1,n.value!=null?n.value:n.defaultValue);case"svg":return lo(2,null);case"math":return lo(3,null);case"foreignObject":return lo(1,null);case"table":return lo(4,null);case"thead":case"tbody":case"tfoot":return lo(5,null);case"colgroup":return lo(7,null);case"tr":return lo(6,null)}return 4<=t.insertionMode||t.insertionMode===0?lo(1,null):t}var X1=ye("<!-- -->");function ow(t,e,n,r){return e===""?r:(r&&t.push(X1),t.push(Ke(Nn(e))),!0)}var sw=new Map,S7=ye(' style="'),aw=ye(":"),k7=ye(";");function FR(t,e,n){if(typeof n!="object")throw Error(Xe(62));e=!0;for(var r in n)if(Ir.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var o=Ke(Nn(r));i=Ke(Nn((""+i).trim()))}else{o=r;var s=sw.get(o);s!==void 0||(s=ye(Nn(o.replace(p7,"-$1").toLowerCase().replace(g7,"-ms-"))),sw.set(o,s)),o=s,i=typeof i=="number"?i===0||Ir.call(Mh,r)?Ke(""+i):Ke(i+"px"):Ke(Nn((""+i).trim()))}e?(e=!1,t.push(S7,o,aw,i)):t.push(k7,o,aw,i)}}e||t.push(el)}var na=ye(" "),Ql=ye('="'),el=ye('"'),lw=ye('=""');function Or(t,e,n,r){switch(n){case"style":FR(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=Un.hasOwnProperty(n)?Un[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=Ke(e.attributeName),e.type){case 3:r&&t.push(na,n,lw);break;case 4:r===!0?t.push(na,n,lw):r!==!1&&t.push(na,n,Ql,Ke(Nn(r)),el);break;case 5:isNaN(r)||t.push(na,n,Ql,Ke(Nn(r)),el);break;case 6:!isNaN(r)&&1<=r&&t.push(na,n,Ql,Ke(Nn(r)),el);break;default:e.sanitizeURL&&(r=""+r),t.push(na,n,Ql,Ke(Nn(r)),el)}}else if(BR(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(na,Ke(n),Ql,Ke(Nn(r)),el)}}}var ra=ye(">"),cw=ye("/>");function Lh(t,e,n){if(e!=null){if(n!=null)throw Error(Xe(60));if(typeof e!="object"||!("__html"in e))throw Error(Xe(61));e=e.__html,e!=null&&t.push(Ke(""+e))}}function E7(t){var e="";return DR.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}var Cm=ye(' selected=""');function ym(t,e,n,r){t.push(co(n));var i=n=null,o;for(o in e)if(Ir.call(e,o)){var s=e[o];if(s!=null)switch(o){case"children":n=s;break;case"dangerouslySetInnerHTML":i=s;break;default:Or(t,r,o,s)}}return t.push(ra),Lh(t,i,n),typeof n=="string"?(t.push(Ke(Nn(n))),null):n}var xm=ye(`
`),T7=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,uw=new Map;function co(t){var e=uw.get(t);if(e===void 0){if(!T7.test(t))throw Error(Xe(65,t));e=ye("<"+t),uw.set(t,e)}return e}var R7=ye("<!DOCTYPE html>");function _7(t,e,n,r,i){switch(e){case"select":t.push(co("select"));var o=null,s=null;for(u in n)if(Ir.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"defaultValue":case"value":break;default:Or(t,r,u,a)}}return t.push(ra),Lh(t,s,o),o;case"option":s=i.selectedValue,t.push(co("option"));var l=a=null,c=null,u=null;for(o in n)if(Ir.call(n,o)){var d=n[o];if(d!=null)switch(o){case"children":a=d;break;case"selected":c=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":l=d;default:Or(t,r,o,d)}}if(s!=null)if(n=l!==null?""+l:E7(a),yC(s)){for(r=0;r<s.length;r++)if(""+s[r]===n){t.push(Cm);break}}else""+s===n&&t.push(Cm);else c&&t.push(Cm);return t.push(ra),Lh(t,u,a),a;case"textarea":t.push(co("textarea")),u=s=o=null;for(a in n)if(Ir.call(n,a)&&(l=n[a],l!=null))switch(a){case"children":u=l;break;case"value":o=l;break;case"defaultValue":s=l;break;case"dangerouslySetInnerHTML":throw Error(Xe(91));default:Or(t,r,a,l)}if(o===null&&s!==null&&(o=s),t.push(ra),u!=null){if(o!=null)throw Error(Xe(92));if(yC(u)&&1<u.length)throw Error(Xe(93));o=""+u}return typeof o=="string"&&o[0]===`
`&&t.push(xm),o!==null&&t.push(Ke(Nn(""+o))),null;case"input":t.push(co("input")),l=u=a=o=null;for(s in n)if(Ir.call(n,s)&&(c=n[s],c!=null))switch(s){case"children":case"dangerouslySetInnerHTML":throw Error(Xe(399,"input"));case"defaultChecked":l=c;break;case"defaultValue":a=c;break;case"checked":u=c;break;case"value":o=c;break;default:Or(t,r,s,c)}return u!==null?Or(t,r,"checked",u):l!==null&&Or(t,r,"checked",l),o!==null?Or(t,r,"value",o):a!==null&&Or(t,r,"value",a),t.push(cw),null;case"menuitem":t.push(co("menuitem"));for(var f in n)if(Ir.call(n,f)&&(o=n[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(Xe(400));default:Or(t,r,f,o)}return t.push(ra),null;case"title":t.push(co("title")),o=null;for(d in n)if(Ir.call(n,d)&&(s=n[d],s!=null))switch(d){case"children":o=s;break;case"dangerouslySetInnerHTML":throw Error(Xe(434));default:Or(t,r,d,s)}return t.push(ra),o;case"listing":case"pre":t.push(co(e)),s=o=null;for(l in n)if(Ir.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;default:Or(t,r,l,a)}if(t.push(ra),s!=null){if(o!=null)throw Error(Xe(60));if(typeof s!="object"||!("__html"in s))throw Error(Xe(61));n=s.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(xm,Ke(n)):t.push(Ke(""+n)))}return typeof o=="string"&&o[0]===`
`&&t.push(xm),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(co(e));for(var h in n)if(Ir.call(n,h)&&(o=n[h],o!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(Xe(399,e));default:Or(t,r,h,o)}return t.push(cw),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return ym(t,n,e,r);case"html":return i.insertionMode===0&&t.push(R7),ym(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return ym(t,n,e,r);t.push(co(e)),s=o=null;for(c in n)if(Ir.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":s=a;break;case"style":FR(t,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:BR(c)&&typeof a!="function"&&typeof a!="symbol"&&t.push(na,Ke(c),Ql,Ke(Nn(a)),el)}return t.push(ra),Lh(t,s,o),o}}var D7=ye("</"),P7=ye(">"),N7=ye('<template id="'),B7=ye('"></template>'),F7=ye("<!--$-->"),O7=ye('<!--$?--><template id="'),M7=ye('"></template>'),L7=ye("<!--$!-->"),U7=ye("<!--/$-->"),V7=ye("<template"),G7=ye('"'),W7=ye(' data-dgst="');ye(' data-msg="');ye(' data-stck="');var z7=ye("></template>");function dw(t,e,n){if(_e(t,O7),n===null)throw Error(Xe(395));return _e(t,n),Mt(t,M7)}var j7=ye('<div hidden id="'),H7=ye('">'),Z7=ye("</div>"),$7=ye('<svg aria-hidden="true" style="display:none" id="'),X7=ye('">'),K7=ye("</svg>"),J7=ye('<math aria-hidden="true" style="display:none" id="'),Y7=ye('">'),q7=ye("</math>"),Q7=ye('<table hidden id="'),eU=ye('">'),tU=ye("</table>"),nU=ye('<table hidden><tbody id="'),rU=ye('">'),iU=ye("</tbody></table>"),oU=ye('<table hidden><tr id="'),sU=ye('">'),aU=ye("</tr></table>"),lU=ye('<table hidden><colgroup id="'),cU=ye('">'),uU=ye("</colgroup></table>");function dU(t,e,n,r){switch(n.insertionMode){case 0:case 1:return _e(t,j7),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,H7);case 2:return _e(t,$7),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,X7);case 3:return _e(t,J7),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,Y7);case 4:return _e(t,Q7),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,eU);case 5:return _e(t,nU),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,rU);case 6:return _e(t,oU),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,sU);case 7:return _e(t,lU),_e(t,e.segmentPrefix),_e(t,Ke(r.toString(16))),Mt(t,cU);default:throw Error(Xe(397))}}function fU(t,e){switch(e.insertionMode){case 0:case 1:return Mt(t,Z7);case 2:return Mt(t,K7);case 3:return Mt(t,q7);case 4:return Mt(t,tU);case 5:return Mt(t,iU);case 6:return Mt(t,aU);case 7:return Mt(t,uU);default:throw Error(Xe(397))}}var hU=ye('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),pU=ye('$RS("'),gU=ye('","'),mU=ye('")<\/script>'),vU=ye('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),CU=ye('$RC("'),yU=ye('","'),xU=ye('")<\/script>'),IU=ye('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),bU=ye('$RX("'),AU=ye('"'),wU=ye(")<\/script>"),Im=ye(","),SU=/[<\u2028\u2029]/g;function bm(t){return JSON.stringify(t).replace(SU,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var xd=Object.assign,kU=Symbol.for("react.element"),OR=Symbol.for("react.portal"),MR=Symbol.for("react.fragment"),LR=Symbol.for("react.strict_mode"),UR=Symbol.for("react.profiler"),VR=Symbol.for("react.provider"),GR=Symbol.for("react.context"),WR=Symbol.for("react.forward_ref"),zR=Symbol.for("react.suspense"),jR=Symbol.for("react.suspense_list"),HR=Symbol.for("react.memo"),K1=Symbol.for("react.lazy"),EU=Symbol.for("react.scope"),TU=Symbol.for("react.debug_trace_mode"),RU=Symbol.for("react.legacy_hidden"),_U=Symbol.for("react.default_value"),fw=Symbol.iterator;function xC(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case MR:return"Fragment";case OR:return"Portal";case UR:return"Profiler";case LR:return"StrictMode";case zR:return"Suspense";case jR:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case GR:return(t.displayName||"Context")+".Consumer";case VR:return(t._context.displayName||"Context")+".Provider";case WR:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case HR:return e=t.displayName||null,e!==null?e:xC(t.type)||"Memo";case K1:e=t._payload,t=t._init;try{return xC(t(e))}catch{}}return null}var ZR={};function hw(t,e){if(t=t.contextTypes,!t)return ZR;var n={},r;for(r in t)n[r]=e[r];return n}var cl=null;function Up(t,e){if(t!==e){t.context._currentValue=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(Xe(401))}else{if(n===null)throw Error(Xe(401));Up(t,n)}e.context._currentValue=e.value}}function $R(t){t.context._currentValue=t.parentValue,t=t.parent,t!==null&&$R(t)}function XR(t){var e=t.parent;e!==null&&XR(e),t.context._currentValue=t.value}function KR(t,e){if(t.context._currentValue=t.parentValue,t=t.parent,t===null)throw Error(Xe(402));t.depth===e.depth?Up(t,e):KR(t,e)}function JR(t,e){var n=e.parent;if(n===null)throw Error(Xe(402));t.depth===n.depth?Up(t,n):JR(t,n),e.context._currentValue=e.value}function j0(t){var e=cl;e!==t&&(e===null?XR(t):t===null?$R(e):e.depth===t.depth?Up(e,t):e.depth>t.depth?KR(e,t):JR(e,t),cl=t)}var pw={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function gw(t,e,n,r){var i=t.state!==void 0?t.state:null;t.updater=pw,t.props=n,t.state=i;var o={queue:[],replace:!1};t._reactInternals=o;var s=e.contextType;if(t.context=typeof s=="object"&&s!==null?s._currentValue:r,s=e.getDerivedStateFromProps,typeof s=="function"&&(s=s(n,i),i=s==null?i:xd({},i,s),t.state=i),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&pw.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&e.length===1)t.state=e[0];else{for(o=s?e[0]:t.state,i=!0,s=s?1:0;s<e.length;s++){var a=e[s];a=typeof a=="function"?a.call(t,o,n,r):a,a!=null&&(i?(i=!1,o=xd({},o,a)):xd(o,a))}t.state=o}else o.queue=null}var DU={id:1,overflow:""};function IC(t,e,n){var r=t.id;t=t.overflow;var i=32-Uh(r)-1;r&=~(1<<i),n+=1;var o=32-Uh(e)+i;if(30<o){var s=i-i%5;return o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,{id:1<<32-Uh(e)+i|n<<i|r,overflow:o+t}}return{id:1<<o|n<<i|r,overflow:t}}var Uh=Math.clz32?Math.clz32:BU,PU=Math.log,NU=Math.LN2;function BU(t){return t>>>=0,t===0?32:31-(PU(t)/NU|0)|0}function FU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var OU=typeof Object.is=="function"?Object.is:FU,Os=null,J1=null,Vh=null,Tt=null,rd=!1,H0=!1,Jd=0,pa=null,Vp=0;function tl(){if(Os===null)throw Error(Xe(321));return Os}function mw(){if(0<Vp)throw Error(Xe(312));return{memoizedState:null,queue:null,next:null}}function Y1(){return Tt===null?Vh===null?(rd=!1,Vh=Tt=mw()):(rd=!0,Tt=Vh):Tt.next===null?(rd=!1,Tt=Tt.next=mw()):(rd=!0,Tt=Tt.next),Tt}function q1(){J1=Os=null,H0=!1,Vh=null,Vp=0,Tt=pa=null}function YR(t,e){return typeof e=="function"?e(t):e}function vw(t,e,n){if(Os=tl(),Tt=Y1(),rd){var r=Tt.queue;if(e=r.dispatch,pa!==null&&(n=pa.get(r),n!==void 0)){pa.delete(r),r=Tt.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return Tt.memoizedState=r,[r,e]}return[Tt.memoizedState,e]}return t=t===YR?typeof e=="function"?e():e:n!==void 0?n(e):e,Tt.memoizedState=t,t=Tt.queue={last:null,dispatch:null},t=t.dispatch=MU.bind(null,Os,t),[Tt.memoizedState,t]}function Cw(t,e){if(Os=tl(),Tt=Y1(),e=e===void 0?null:e,Tt!==null){var n=Tt.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<e.length;i++)if(!OU(e[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),Tt.memoizedState=[t,e],t}function MU(t,e,n){if(25<=Vp)throw Error(Xe(301));if(t===Os)if(H0=!0,t={action:n,next:null},pa===null&&(pa=new Map),n=pa.get(e),n===void 0)pa.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function LU(){throw Error(Xe(394))}function ih(){}var yw={readContext:function(t){return t._currentValue},useContext:function(t){return tl(),t._currentValue},useMemo:Cw,useReducer:vw,useRef:function(t){Os=tl(),Tt=Y1();var e=Tt.memoizedState;return e===null?(t={current:t},Tt.memoizedState=t):e},useState:function(t){return vw(YR,t)},useInsertionEffect:ih,useLayoutEffect:function(){},useCallback:function(t,e){return Cw(function(){return t},e)},useImperativeHandle:ih,useEffect:ih,useDebugValue:ih,useDeferredValue:function(t){return tl(),t},useTransition:function(){return tl(),[!1,LU]},useId:function(){var t=J1.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-Uh(t)-1)).toString(32)+e;var n=Gh;if(n===null)throw Error(Xe(404));return e=Jd++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return tl(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(Xe(407));return n()}},Gh=null,Am=DR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function UU(t){return console.error(t),null}function id(){}function VU(t,e,n,r,i,o,s,a,l){var c=[],u=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?UU:i,onAllReady:o===void 0?id:o,onShellReady:s===void 0?id:s,onShellError:a===void 0?id:a,onFatalError:l===void 0?id:l},n=Z0(e,0,null,n,!1,!1),n.parentFlushed=!0,t=Q1(e,t,null,n,u,ZR,null,DU),c.push(t),e}function Q1(t,e,n,r,i,o,s,a){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var l={node:e,ping:function(){var c=t.pingedTasks;c.push(l),c.length===1&&e_(t)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:o,context:s,treeContext:a};return i.add(l),l}function Z0(t,e,n,r,i,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:o}}function Yd(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function $0(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,NR(t.destination,e)):(t.status=1,t.fatalError=e)}function xw(t,e,n,r,i){for(Os={},J1=e,Jd=0,t=n(r,i);H0;)H0=!1,Jd=0,Vp+=1,Tt=null,t=n(r,i);return q1(),t}function Iw(t,e,n,r){var i=n.render(),o=r.childContextTypes;if(o!=null){var s=e.legacyContext;if(typeof n.getChildContext!="function")r=s;else{n=n.getChildContext();for(var a in n)if(!(a in o))throw Error(Xe(108,xC(r)||"Unknown",a));r=xd({},s,n)}e.legacyContext=r,Hr(t,e,i),e.legacyContext=s}else Hr(t,e,i)}function bw(t,e){if(t&&t.defaultProps){e=xd({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function bC(t,e,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=hw(n,e.legacyContext);var o=n.contextType;o=new n(r,typeof o=="object"&&o!==null?o._currentValue:i),gw(o,n,r,i),Iw(t,e,o,n)}else{o=hw(n,e.legacyContext),i=xw(t,e,n,r,o);var s=Jd!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)gw(i,n,r,o),Iw(t,e,i,n);else if(s){r=e.treeContext,e.treeContext=IC(r,1,0);try{Hr(t,e,i)}finally{e.treeContext=r}}else Hr(t,e,i)}else if(typeof n=="string"){switch(i=e.blockedSegment,o=_7(i.chunks,n,r,t.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=w7(s,n,r),AC(t,e,o),i.formatContext=s,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push(D7,Ke(n),P7)}i.lastPushedText=!1}else{switch(n){case RU:case TU:case LR:case UR:case MR:Hr(t,e,r.children);return;case jR:Hr(t,e,r.children);return;case EU:throw Error(Xe(343));case zR:e:{n=e.blockedBoundary,i=e.blockedSegment,o=r.fallback,r=r.children,s=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s,errorDigest:null},l=Z0(t,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(l),i.lastPushedText=!1;var c=Z0(t,0,null,i.formatContext,!1,!1);c.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=c;try{if(AC(t,e,r),c.lastPushedText&&c.textEmbedded&&c.chunks.push(X1),c.status=1,X0(a,c),a.pendingTasks===0)break e}catch(u){c.status=4,a.forceClientRender=!0,a.errorDigest=Yd(t,u)}finally{e.blockedBoundary=n,e.blockedSegment=i}e=Q1(t,o,n,l,s,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case WR:if(r=xw(t,e,n.render,r,i),Jd!==0){n=e.treeContext,e.treeContext=IC(n,1,0);try{Hr(t,e,r)}finally{e.treeContext=n}}else Hr(t,e,r);return;case HR:n=n.type,r=bw(n,r),bC(t,e,n,r,i);return;case VR:if(i=r.children,n=n._context,r=r.value,o=n._currentValue,n._currentValue=r,s=cl,cl=r={parent:s,depth:s===null?0:s.depth+1,context:n,parentValue:o,value:r},e.context=r,Hr(t,e,i),t=cl,t===null)throw Error(Xe(403));r=t.parentValue,t.context._currentValue=r===_U?t.context._defaultValue:r,t=cl=t.parent,e.context=t;return;case GR:r=r.children,r=r(n._currentValue),Hr(t,e,r);return;case K1:i=n._init,n=i(n._payload),r=bw(n,r),bC(t,e,n,r,void 0);return}throw Error(Xe(130,n==null?n:typeof n,""))}}function Hr(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case kU:bC(t,e,n.type,n.props,n.ref);return;case OR:throw Error(Xe(257));case K1:var r=n._init;n=r(n._payload),Hr(t,e,n);return}if(yC(n)){Aw(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=fw&&n[fw]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);Aw(t,e,i)}return}throw t=Object.prototype.toString.call(n),Error(Xe(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=ow(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=ow(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function Aw(t,e,n){for(var r=n.length,i=0;i<r;i++){var o=e.treeContext;e.treeContext=IC(o,r,i);try{AC(t,e,n[i])}finally{e.treeContext=o}}}function AC(t,e,n){var r=e.blockedSegment.formatContext,i=e.legacyContext,o=e.context;try{return Hr(t,e,n)}catch(l){if(q1(),typeof l=="object"&&l!==null&&typeof l.then=="function"){n=l;var s=e.blockedSegment,a=Z0(t,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,t=Q1(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,j0(o)}else throw e.blockedSegment.formatContext=r,e.legacyContext=i,e.context=o,j0(o),l}}function GU(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,QR(this,e,t)}function qR(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.close())):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(Xe(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return qR(i,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function X0(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&X0(t,n)}else t.completedSegments.push(e)}function QR(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(Xe(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=id,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&X0(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(GU,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(X0(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function e_(t){if(t.status!==2){var e=cl,n=Am.current;Am.current=yw;var r=Gh;Gh=t.responseState;try{var i=t.pingedTasks,o;for(o=0;o<i.length;o++){var s=i[o],a=t,l=s.blockedSegment;if(l.status===0){j0(s.context);try{Hr(a,s,s.node),l.lastPushedText&&l.textEmbedded&&l.chunks.push(X1),s.abortSet.delete(s),l.status=1,QR(a,s.blockedBoundary,l)}catch(p){if(q1(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var c=s.ping;p.then(c,c)}else{s.abortSet.delete(s),l.status=4;var u=s.blockedBoundary,d=p,f=Yd(a,d);if(u===null?$0(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,o),t.destination!==null&&ex(t,t.destination)}catch(p){Yd(t,p),$0(t,p)}finally{Gh=r,Am.current=n,n===yw&&j0(e)}}}function oh(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,_e(e,N7),_e(e,t.placeholderPrefix),t=Ke(r.toString(16)),_e(e,t),Mt(e,B7);case 1:n.status=2;var i=!0;r=n.chunks;var o=0;n=n.children;for(var s=0;s<n.length;s++){for(i=n[s];o<i.index;o++)_e(e,r[o]);i=Gp(t,e,i)}for(;o<r.length-1;o++)_e(e,r[o]);return o<r.length&&(i=Mt(e,r[o])),i;default:throw Error(Xe(390))}}function Gp(t,e,n){var r=n.boundary;if(r===null)return oh(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)r=r.errorDigest,Mt(e,L7),_e(e,V7),r&&(_e(e,W7),_e(e,Ke(Nn(r))),_e(e,G7)),Mt(e,z7),oh(t,e,n);else if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var i=t.responseState,o=i.nextSuspenseID++;i=ye(i.boundaryPrefix+o.toString(16)),r=r.id=i,dw(e,t.responseState,r),oh(t,e,n)}else if(r.byteSize>t.progressiveChunkSize)r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),dw(e,t.responseState,r.id),oh(t,e,n);else{if(Mt(e,F7),n=r.completedSegments,n.length!==1)throw Error(Xe(391));Gp(t,e,n[0])}return Mt(e,U7)}function ww(t,e,n){return dU(e,t.responseState,n.formatContext,n.id),Gp(t,e,n),fU(e,n.formatContext)}function Sw(t,e,n){for(var r=n.completedSegments,i=0;i<r.length;i++)t_(t,e,n,r[i]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,_e(e,t.startInlineScript),t.sentCompleteBoundaryFunction?_e(e,CU):(t.sentCompleteBoundaryFunction=!0,_e(e,vU)),r===null)throw Error(Xe(395));return n=Ke(n.toString(16)),_e(e,r),_e(e,yU),_e(e,t.segmentPrefix),_e(e,n),Mt(e,xU)}function t_(t,e,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(Xe(392));return ww(t,e,r)}return ww(t,e,r),t=t.responseState,_e(e,t.startInlineScript),t.sentCompleteSegmentFunction?_e(e,pU):(t.sentCompleteSegmentFunction=!0,_e(e,hU)),_e(e,t.segmentPrefix),i=Ke(i.toString(16)),_e(e,i),_e(e,gU),_e(e,t.placeholderPrefix),_e(e,i),Mt(e,mU)}function ex(t,e){zr=new Uint8Array(512),jr=0;try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){Gp(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)_e(e,r[n]);n<r.length&&Mt(e,r[n])}var i=t.clientRenderedBoundaries,o;for(o=0;o<i.length;o++){var s=i[o];r=e;var a=t.responseState,l=s.id,c=s.errorDigest,u=s.errorMessage,d=s.errorComponentStack;if(_e(r,a.startInlineScript),a.sentClientRenderFunction?_e(r,bU):(a.sentClientRenderFunction=!0,_e(r,IU)),l===null)throw Error(Xe(395));_e(r,l),_e(r,AU),(c||u||d)&&(_e(r,Im),_e(r,Ke(bm(c||"")))),(u||d)&&(_e(r,Im),_e(r,Ke(bm(u||"")))),d&&(_e(r,Im),_e(r,Ke(bm(d)))),Mt(r,wU)}i.splice(0,o);var f=t.completedBoundaries;for(o=0;o<f.length;o++)Sw(t,e,f[o]);f.splice(0,o),tw(e),zr=new Uint8Array(512),jr=0;var h=t.partialBoundaries;for(o=0;o<h.length;o++){var p=h[o];e:{i=t,s=e;var m=p.completedSegments;for(a=0;a<m.length;a++)if(!t_(i,s,p,m[a])){a++,m.splice(0,a);var C=!1;break e}m.splice(0,a),C=!0}if(!C){t.destination=null,o++,h.splice(0,o);return}}h.splice(0,o);var v=t.completedBoundaries;for(o=0;o<v.length;o++)Sw(t,e,v[o]);v.splice(0,o)}finally{tw(e),t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.close()}}function kw(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return qR(r,t,e)}),n.clear(),t.destination!==null&&ex(t,t.destination)}catch(r){Yd(t,r),$0(t,r)}}H1.renderToReadableStream=function(t,e){return new Promise(function(n,r){var i,o,s=new Promise(function(u,d){o=u,i=d}),a=VU(t,b7(e?e.identifierPrefix:void 0,e?e.nonce:void 0,e?e.bootstrapScriptContent:void 0,e?e.bootstrapScripts:void 0,e?e.bootstrapModules:void 0),A7(e?e.namespaceURI:void 0),e?e.progressiveChunkSize:void 0,e?e.onError:void 0,o,function(){var u=new ReadableStream({type:"bytes",pull:function(d){if(a.status===1)a.status=2,NR(d,a.fatalError);else if(a.status!==2&&a.destination===null){a.destination=d;try{ex(a,d)}catch(f){Yd(a,f),$0(a,f)}}},cancel:function(){kw(a)}},{highWaterMark:0});u.allReady=s,n(u)},function(u){s.catch(function(){}),r(u)},i);if(e&&e.signal){var l=e.signal,c=function(){kw(a,l.reason),l.removeEventListener("abort",c)};l.addEventListener("abort",c)}e_(a)})};H1.version="18.3.1";var fu,n_;fu=du,n_=H1;Na.version=fu.version;Na.renderToString=fu.renderToString;Na.renderToStaticMarkup=fu.renderToStaticMarkup;Na.renderToNodeStream=fu.renderToNodeStream;Na.renderToStaticNodeStream=fu.renderToStaticNodeStream;Na.renderToReadableStream=n_.renderToReadableStream;/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:r_,setPrototypeOf:Ew,isFrozen:WU,getPrototypeOf:zU,getOwnPropertyDescriptor:jU}=Object;let{freeze:dr,seal:Ci,create:i_}=Object,{apply:wC,construct:SC}=typeof Reflect<"u"&&Reflect;dr||(dr=function(e){return e});Ci||(Ci=function(e){return e});wC||(wC=function(e,n,r){return e.apply(n,r)});SC||(SC=function(e,n){return new e(...n)});const sh=fr(Array.prototype.forEach),HU=fr(Array.prototype.lastIndexOf),Tw=fr(Array.prototype.pop),Fu=fr(Array.prototype.push),ZU=fr(Array.prototype.splice),Wh=fr(String.prototype.toLowerCase),wm=fr(String.prototype.toString),Rw=fr(String.prototype.match),Ou=fr(String.prototype.replace),$U=fr(String.prototype.indexOf),XU=fr(String.prototype.trim),wi=fr(Object.prototype.hasOwnProperty),Qn=fr(RegExp.prototype.test),Mu=KU(TypeError);function fr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return wC(t,e,r)}}function KU(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return SC(t,n)}}function Ye(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Wh;Ew&&Ew(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(WU(e)||(e[r]=o),i=o)}t[i]=!0}return t}function JU(t){for(let e=0;e<t.length;e++)wi(t,e)||(t[e]=null);return t}function Ja(t){const e=i_(null);for(const[n,r]of r_(t))wi(t,n)&&(Array.isArray(r)?e[n]=JU(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Ja(r):e[n]=r);return e}function Lu(t,e){for(;t!==null;){const r=jU(t,e);if(r){if(r.get)return fr(r.get);if(typeof r.value=="function")return fr(r.value)}t=zU(t)}function n(){return null}return n}const _w=dr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Sm=dr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),km=dr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),YU=dr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Em=dr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),qU=dr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Dw=dr(["#text"]),Pw=dr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Tm=dr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Nw=dr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ah=dr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),QU=Ci(/\{\{[\w\W]*|[\w\W]*\}\}/gm),eV=Ci(/<%[\w\W]*|[\w\W]*%>/gm),tV=Ci(/\$\{[\w\W]*/gm),nV=Ci(/^data-[\-\w.\u00B7-\uFFFF]+$/),rV=Ci(/^aria-[\-\w]+$/),o_=Ci(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),iV=Ci(/^(?:\w+script|data):/i),oV=Ci(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),s_=Ci(/^html$/i),sV=Ci(/^[a-z][.\w]*(-[.\w]+)+$/i);var Bw=Object.freeze({__proto__:null,ARIA_ATTR:rV,ATTR_WHITESPACE:oV,CUSTOM_ELEMENT:sV,DATA_ATTR:nV,DOCTYPE_NAME:s_,ERB_EXPR:eV,IS_ALLOWED_URI:o_,IS_SCRIPT_OR_DATA:iV,MUSTACHE_EXPR:QU,TMPLIT_EXPR:tV});const Uu={element:1,text:3,progressingInstruction:7,comment:8,document:9},aV=function(){return typeof window>"u"?null:window},lV=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Fw=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function a_(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:aV();const e=pe=>a_(pe);if(e.version="3.2.4",e.removed=[],!t||!t.document||t.document.nodeType!==Uu.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:f,trustedTypes:h}=t,p=l.prototype,m=Lu(p,"cloneNode"),C=Lu(p,"remove"),v=Lu(p,"nextSibling"),g=Lu(p,"childNodes"),y=Lu(p,"parentNode");if(typeof s=="function"){const pe=n.createElement("template");pe.content&&pe.content.ownerDocument&&(n=pe.content.ownerDocument)}let I,b="";const{implementation:E,createNodeIterator:w,createDocumentFragment:k,getElementsByTagName:D}=n,{importNode:T}=r;let R=Fw();e.isSupported=typeof r_=="function"&&typeof y=="function"&&E&&E.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:P,ERB_EXPR:M,TMPLIT_EXPR:G,DATA_ATTR:H,ARIA_ATTR:q,IS_SCRIPT_OR_DATA:ie,ATTR_WHITESPACE:Z,CUSTOM_ELEMENT:Q}=Bw;let{IS_ALLOWED_URI:ne}=Bw,F=null;const z=Ye({},[..._w,...Sm,...km,...Em,...Dw]);let J=null;const ee=Ye({},[...Pw,...Tm,...Nw,...ah]);let se=Object.seal(i_(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),me=null,Be=null,ae=!0,Pt=!0,Vt=!1,dn=!0,ze=!1,at=!0,ot=!1,he=!1,Ce=!1,Ue=!1,Le=!1,Pe=!1,$e=!0,st=!1;const Qe="user-content-";let Gt=!0,Wt=!1,wt={},on=null;const _=Ye({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let x=null;const A=Ye({},["audio","video","img","source","image","track"]);let B=null;const W=Ye({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Y="http://www.w3.org/1998/Math/MathML",te="http://www.w3.org/2000/svg",Ne="http://www.w3.org/1999/xhtml";let tt=Ne,lt=!1,ht=null;const nt=Ye({},[Y,te,Ne],wm);let xi=Ye({},["mi","mo","mn","ms","mtext"]),ro=Ye({},["annotation-xml"]);const Ha=Ye({},["title","style","font","a","script"]);let ri=null;const xu=["application/xhtml+xml","text/html"],zl="text/html";let Kt=null,ii=null;const Hs=n.createElement("form"),Zo=function(U){return U instanceof RegExp||U instanceof Function},Zs=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ii&&ii===U)){if((!U||typeof U!="object")&&(U={}),U=Ja(U),ri=xu.indexOf(U.PARSER_MEDIA_TYPE)===-1?zl:U.PARSER_MEDIA_TYPE,Kt=ri==="application/xhtml+xml"?wm:Wh,F=wi(U,"ALLOWED_TAGS")?Ye({},U.ALLOWED_TAGS,Kt):z,J=wi(U,"ALLOWED_ATTR")?Ye({},U.ALLOWED_ATTR,Kt):ee,ht=wi(U,"ALLOWED_NAMESPACES")?Ye({},U.ALLOWED_NAMESPACES,wm):nt,B=wi(U,"ADD_URI_SAFE_ATTR")?Ye(Ja(W),U.ADD_URI_SAFE_ATTR,Kt):W,x=wi(U,"ADD_DATA_URI_TAGS")?Ye(Ja(A),U.ADD_DATA_URI_TAGS,Kt):A,on=wi(U,"FORBID_CONTENTS")?Ye({},U.FORBID_CONTENTS,Kt):_,me=wi(U,"FORBID_TAGS")?Ye({},U.FORBID_TAGS,Kt):{},Be=wi(U,"FORBID_ATTR")?Ye({},U.FORBID_ATTR,Kt):{},wt=wi(U,"USE_PROFILES")?U.USE_PROFILES:!1,ae=U.ALLOW_ARIA_ATTR!==!1,Pt=U.ALLOW_DATA_ATTR!==!1,Vt=U.ALLOW_UNKNOWN_PROTOCOLS||!1,dn=U.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ze=U.SAFE_FOR_TEMPLATES||!1,at=U.SAFE_FOR_XML!==!1,ot=U.WHOLE_DOCUMENT||!1,Ue=U.RETURN_DOM||!1,Le=U.RETURN_DOM_FRAGMENT||!1,Pe=U.RETURN_TRUSTED_TYPE||!1,Ce=U.FORCE_BODY||!1,$e=U.SANITIZE_DOM!==!1,st=U.SANITIZE_NAMED_PROPS||!1,Gt=U.KEEP_CONTENT!==!1,Wt=U.IN_PLACE||!1,ne=U.ALLOWED_URI_REGEXP||o_,tt=U.NAMESPACE||Ne,xi=U.MATHML_TEXT_INTEGRATION_POINTS||xi,ro=U.HTML_INTEGRATION_POINTS||ro,se=U.CUSTOM_ELEMENT_HANDLING||{},U.CUSTOM_ELEMENT_HANDLING&&Zo(U.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(se.tagNameCheck=U.CUSTOM_ELEMENT_HANDLING.tagNameCheck),U.CUSTOM_ELEMENT_HANDLING&&Zo(U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(se.attributeNameCheck=U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),U.CUSTOM_ELEMENT_HANDLING&&typeof U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(se.allowCustomizedBuiltInElements=U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ze&&(Pt=!1),Le&&(Ue=!0),wt&&(F=Ye({},Dw),J=[],wt.html===!0&&(Ye(F,_w),Ye(J,Pw)),wt.svg===!0&&(Ye(F,Sm),Ye(J,Tm),Ye(J,ah)),wt.svgFilters===!0&&(Ye(F,km),Ye(J,Tm),Ye(J,ah)),wt.mathMl===!0&&(Ye(F,Em),Ye(J,Nw),Ye(J,ah))),U.ADD_TAGS&&(F===z&&(F=Ja(F)),Ye(F,U.ADD_TAGS,Kt)),U.ADD_ATTR&&(J===ee&&(J=Ja(J)),Ye(J,U.ADD_ATTR,Kt)),U.ADD_URI_SAFE_ATTR&&Ye(B,U.ADD_URI_SAFE_ATTR,Kt),U.FORBID_CONTENTS&&(on===_&&(on=Ja(on)),Ye(on,U.FORBID_CONTENTS,Kt)),Gt&&(F["#text"]=!0),ot&&Ye(F,["html","head","body"]),F.table&&(Ye(F,["tbody"]),delete me.tbody),U.TRUSTED_TYPES_POLICY){if(typeof U.TRUSTED_TYPES_POLICY.createHTML!="function")throw Mu('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof U.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Mu('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');I=U.TRUSTED_TYPES_POLICY,b=I.createHTML("")}else I===void 0&&(I=lV(h,i)),I!==null&&typeof b=="string"&&(b=I.createHTML(""));dr&&dr(U),ii=U}},jl=Ye({},[...Sm,...km,...YU]),V=Ye({},[...Em,...qU]),j=function(U){let oe=y(U);(!oe||!oe.tagName)&&(oe={namespaceURI:tt,tagName:"template"});const Ae=Wh(U.tagName),pt=Wh(oe.tagName);return ht[U.namespaceURI]?U.namespaceURI===te?oe.namespaceURI===Ne?Ae==="svg":oe.namespaceURI===Y?Ae==="svg"&&(pt==="annotation-xml"||xi[pt]):!!jl[Ae]:U.namespaceURI===Y?oe.namespaceURI===Ne?Ae==="math":oe.namespaceURI===te?Ae==="math"&&ro[pt]:!!V[Ae]:U.namespaceURI===Ne?oe.namespaceURI===te&&!ro[pt]||oe.namespaceURI===Y&&!xi[pt]?!1:!V[Ae]&&(Ha[Ae]||!jl[Ae]):!!(ri==="application/xhtml+xml"&&ht[U.namespaceURI]):!1},K=function(U){Fu(e.removed,{element:U});try{y(U).removeChild(U)}catch{C(U)}},ce=function(U,oe){try{Fu(e.removed,{attribute:oe.getAttributeNode(U),from:oe})}catch{Fu(e.removed,{attribute:null,from:oe})}if(oe.removeAttribute(U),U==="is")if(Ue||Le)try{K(oe)}catch{}else try{oe.setAttribute(U,"")}catch{}},ge=function(U){let oe=null,Ae=null;if(Ce)U="<remove></remove>"+U;else{const xt=Rw(U,/^[\r\n\t ]+/);Ae=xt&&xt[0]}ri==="application/xhtml+xml"&&tt===Ne&&(U='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+U+"</body></html>");const pt=I?I.createHTML(U):U;if(tt===Ne)try{oe=new f().parseFromString(pt,ri)}catch{}if(!oe||!oe.documentElement){oe=E.createDocument(tt,"template",null);try{oe.documentElement.innerHTML=lt?b:pt}catch{}}const St=oe.body||oe.documentElement;return U&&Ae&&St.insertBefore(n.createTextNode(Ae),St.childNodes[0]||null),tt===Ne?D.call(oe,ot?"html":"body")[0]:ot?oe.documentElement:St},De=function(U){return w.call(U.ownerDocument||U,U,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Oe=function(U){return U instanceof d&&(typeof U.nodeName!="string"||typeof U.textContent!="string"||typeof U.removeChild!="function"||!(U.attributes instanceof u)||typeof U.removeAttribute!="function"||typeof U.setAttribute!="function"||typeof U.namespaceURI!="string"||typeof U.insertBefore!="function"||typeof U.hasChildNodes!="function")},ke=function(U){return typeof a=="function"&&U instanceof a};function Ie(pe,U,oe){sh(pe,Ae=>{Ae.call(e,U,oe,ii)})}const be=function(U){let oe=null;if(Ie(R.beforeSanitizeElements,U,null),Oe(U))return K(U),!0;const Ae=Kt(U.nodeName);if(Ie(R.uponSanitizeElement,U,{tagName:Ae,allowedTags:F}),U.hasChildNodes()&&!ke(U.firstElementChild)&&Qn(/<[/\w]/g,U.innerHTML)&&Qn(/<[/\w]/g,U.textContent)||U.nodeType===Uu.progressingInstruction||at&&U.nodeType===Uu.comment&&Qn(/<[/\w]/g,U.data))return K(U),!0;if(!F[Ae]||me[Ae]){if(!me[Ae]&&Ve(Ae)&&(se.tagNameCheck instanceof RegExp&&Qn(se.tagNameCheck,Ae)||se.tagNameCheck instanceof Function&&se.tagNameCheck(Ae)))return!1;if(Gt&&!on[Ae]){const pt=y(U)||U.parentNode,St=g(U)||U.childNodes;if(St&&pt){const xt=St.length;for(let bn=xt-1;bn>=0;--bn){const zn=m(St[bn],!0);zn.__removalCount=(U.__removalCount||0)+1,pt.insertBefore(zn,v(U))}}}return K(U),!0}return U instanceof l&&!j(U)||(Ae==="noscript"||Ae==="noembed"||Ae==="noframes")&&Qn(/<\/no(script|embed|frames)/i,U.innerHTML)?(K(U),!0):(ze&&U.nodeType===Uu.text&&(oe=U.textContent,sh([P,M,G],pt=>{oe=Ou(oe,pt," ")}),U.textContent!==oe&&(Fu(e.removed,{element:U.cloneNode()}),U.textContent=oe)),Ie(R.afterSanitizeElements,U,null),!1)},Re=function(U,oe,Ae){if($e&&(oe==="id"||oe==="name")&&(Ae in n||Ae in Hs))return!1;if(!(Pt&&!Be[oe]&&Qn(H,oe))){if(!(ae&&Qn(q,oe))){if(!J[oe]||Be[oe]){if(!(Ve(U)&&(se.tagNameCheck instanceof RegExp&&Qn(se.tagNameCheck,U)||se.tagNameCheck instanceof Function&&se.tagNameCheck(U))&&(se.attributeNameCheck instanceof RegExp&&Qn(se.attributeNameCheck,oe)||se.attributeNameCheck instanceof Function&&se.attributeNameCheck(oe))||oe==="is"&&se.allowCustomizedBuiltInElements&&(se.tagNameCheck instanceof RegExp&&Qn(se.tagNameCheck,Ae)||se.tagNameCheck instanceof Function&&se.tagNameCheck(Ae))))return!1}else if(!B[oe]){if(!Qn(ne,Ou(Ae,Z,""))){if(!((oe==="src"||oe==="xlink:href"||oe==="href")&&U!=="script"&&$U(Ae,"data:")===0&&x[U])){if(!(Vt&&!Qn(ie,Ou(Ae,Z,"")))){if(Ae)return!1}}}}}}return!0},Ve=function(U){return U!=="annotation-xml"&&Rw(U,Q)},Je=function(U){Ie(R.beforeSanitizeAttributes,U,null);const{attributes:oe}=U;if(!oe||Oe(U))return;const Ae={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:J,forceKeepAttr:void 0};let pt=oe.length;for(;pt--;){const St=oe[pt],{name:xt,namespaceURI:bn,value:zn}=St,Nr=Kt(xt);let sn=xt==="value"?zn:XU(zn);if(Ae.attrName=Nr,Ae.attrValue=sn,Ae.keepAttr=!0,Ae.forceKeepAttr=void 0,Ie(R.uponSanitizeAttribute,U,Ae),sn=Ae.attrValue,st&&(Nr==="id"||Nr==="name")&&(ce(xt,U),sn=Qe+sn),at&&Qn(/((--!?|])>)|<\/(style|title)/i,sn)){ce(xt,U);continue}if(Ae.forceKeepAttr||(ce(xt,U),!Ae.keepAttr))continue;if(!dn&&Qn(/\/>/i,sn)){ce(xt,U);continue}ze&&sh([P,M,G],rt=>{sn=Ou(sn,rt," ")});const Za=Kt(U.nodeName);if(Re(Za,Nr,sn)){if(I&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!bn)switch(h.getAttributeType(Za,Nr)){case"TrustedHTML":{sn=I.createHTML(sn);break}case"TrustedScriptURL":{sn=I.createScriptURL(sn);break}}try{bn?U.setAttributeNS(bn,xt,sn):U.setAttribute(xt,sn),Oe(U)?K(U):Tw(e.removed)}catch{}}}Ie(R.afterSanitizeAttributes,U,null)},fn=function pe(U){let oe=null;const Ae=De(U);for(Ie(R.beforeSanitizeShadowDOM,U,null);oe=Ae.nextNode();)Ie(R.uponSanitizeShadowNode,oe,null),be(oe),Je(oe),oe.content instanceof o&&pe(oe.content);Ie(R.afterSanitizeShadowDOM,U,null)};return e.sanitize=function(pe){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},oe=null,Ae=null,pt=null,St=null;if(lt=!pe,lt&&(pe="<!-->"),typeof pe!="string"&&!ke(pe))if(typeof pe.toString=="function"){if(pe=pe.toString(),typeof pe!="string")throw Mu("dirty is not a string, aborting")}else throw Mu("toString is not a function");if(!e.isSupported)return pe;if(he||Zs(U),e.removed=[],typeof pe=="string"&&(Wt=!1),Wt){if(pe.nodeName){const zn=Kt(pe.nodeName);if(!F[zn]||me[zn])throw Mu("root node is forbidden and cannot be sanitized in-place")}}else if(pe instanceof a)oe=ge("<!---->"),Ae=oe.ownerDocument.importNode(pe,!0),Ae.nodeType===Uu.element&&Ae.nodeName==="BODY"||Ae.nodeName==="HTML"?oe=Ae:oe.appendChild(Ae);else{if(!Ue&&!ze&&!ot&&pe.indexOf("<")===-1)return I&&Pe?I.createHTML(pe):pe;if(oe=ge(pe),!oe)return Ue?null:Pe?b:""}oe&&Ce&&K(oe.firstChild);const xt=De(Wt?pe:oe);for(;pt=xt.nextNode();)be(pt),Je(pt),pt.content instanceof o&&fn(pt.content);if(Wt)return pe;if(Ue){if(Le)for(St=k.call(oe.ownerDocument);oe.firstChild;)St.appendChild(oe.firstChild);else St=oe;return(J.shadowroot||J.shadowrootmode)&&(St=T.call(r,St,!0)),St}let bn=ot?oe.outerHTML:oe.innerHTML;return ot&&F["!doctype"]&&oe.ownerDocument&&oe.ownerDocument.doctype&&oe.ownerDocument.doctype.name&&Qn(s_,oe.ownerDocument.doctype.name)&&(bn="<!DOCTYPE "+oe.ownerDocument.doctype.name+`>
`+bn),ze&&sh([P,M,G],zn=>{bn=Ou(bn,zn," ")}),I&&Pe?I.createHTML(bn):bn},e.setConfig=function(){let pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zs(pe),he=!0},e.clearConfig=function(){ii=null,he=!1},e.isValidAttribute=function(pe,U,oe){ii||Zs({});const Ae=Kt(pe),pt=Kt(U);return Re(Ae,pt,oe)},e.addHook=function(pe,U){typeof U=="function"&&Fu(R[pe],U)},e.removeHook=function(pe,U){if(U!==void 0){const oe=HU(R[pe],U);return oe===-1?void 0:ZU(R[pe],oe,1)[0]}return Tw(R[pe])},e.removeHooks=function(pe){R[pe]=[]},e.removeAllHooks=function(){R=Fw()},e}var cV=a_();const uV=2,rl=class rl extends He.Component{constructor(n){super(n);L(this,"outputRef",He.createRef());L(this,"messageKey",0);L(this,"saveOutput",()=>{const n=this.state.output.map(r=>Na.renderToStaticMarkup(r));localStorage.setItem(rl.LOCAL_STORAGE_KEY,JSON.stringify(n))});L(this,"loadOutput",()=>{const n=localStorage.getItem(rl.LOCAL_STORAGE_KEY);return n?JSON.parse(n).map(i=>He.createElement("div",{dangerouslySetInnerHTML:{__html:i}})):[]});L(this,"addCommand",n=>{this.addToOutput([X.jsx("span",{className:"command","aria-live":"off",children:n})],!1)});L(this,"addError",n=>this.addToOutput([X.jsxs("h2",{children:[" Error: ",n.message]})]));L(this,"handleConnected",()=>this.addToOutput([X.jsx("h2",{children:" Connected"})]));L(this,"handleDisconnected",()=>{this.addToOutput([X.jsx("h2",{children:" Disconnected"})]),this.setState({sidebarVisible:!1})});L(this,"handleUserList",n=>this.setState({sidebarVisible:!!n}));L(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});L(this,"isScrolledToBottom",()=>{const n=this.outputRef.current;if(!n)return!1;const r=Math.ceil(n.scrollHeight-n.scrollTop),i=Math.ceil(n.clientHeight);return r<=i+uV});L(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});L(this,"scrollToBottom",()=>{const n=this.outputRef.current;n&&requestAnimationFrame(()=>{n.scrollTop=n.scrollHeight})});L(this,"handleMessage",n=>{if(!n)return;const r=T9(n,this.handleExitClick);this.addToOutput(r)});L(this,"handleHtml",n=>{const r=cV.sanitize(n),i=X.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}});this.addToOutput([i])});L(this,"handleExitClick",n=>{this.props.client.sendCommand(n)});this.state={output:this.loadOutput(),sidebarVisible:!1,newLinesCount:0}}getSnapshotBeforeUpdate(n,r){return this.outputRef.current?(this.outputRef.current,this.isScrolledToBottom()):null}componentDidUpdate(n,r,i){i&&this.scrollToBottom(),this.state.output.length>r.output.length&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState({newLinesCount:this.state.newLinesCount+(this.state.output.length-r.output.length)})),this.saveOutput()}componentDidMount(){const{client:n}=this.props;n.on("message",this.handleMessage),n.on("html",this.handleHtml),n.on("connect",this.handleConnected),n.on("disconnect",this.handleDisconnected),n.on("error",this.addError),n.on("command",this.addCommand),n.on("userlist",this.handleUserList)}componentWillUnmount(){const{client:n}=this.props;n.removeListener("message",this.handleMessage),n.removeListener("html",this.handleHtml),n.removeListener("connect",this.handleConnected),n.removeListener("disconnect",this.handleDisconnected),n.removeListener("error",this.addError),n.removeListener("command",this.addCommand),n.removeListener("userlist",this.handleUserList)}sanitizeHtml(n){return new DOMParser().parseFromString(n,"text/html").body.textContent||""}addToOutput(n,r=!0){r&&n.forEach(i=>{if(He.isValidElement(i)){const o=Na.renderToString(i),s=this.sanitizeHtml(o);NA(s)}else typeof i=="string"&&NA(i)}),this.setState(i=>{const o=n.map((l,c)=>X.jsx("div",{children:l},this.messageKey+c));return this.messageKey+=n.length,{output:[...i.output,...o].slice(-rl.MAX_OUTPUT_LENGTH)}})}saveLog(){const n=this.outputRef.current;if(n){const r=n.innerHTML,i=new Blob([r],{type:"text/html"}),o=URL.createObjectURL(i),s=document.createElement("a"),a=new Date,l=a.toLocaleDateString(),c=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=`${document.title.replace(/\s+/g,"-")}-log-${l}-${c}.html`;s.download=d,s.href=o,s.click(),URL.revokeObjectURL(o),s.remove()}}clearLog(){this.setState({output:[]})}render(){var n="output";this.state.sidebarVisible&&(n+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return X.jsxs("div",{ref:this.outputRef,className:n,onScroll:this.handleScroll,children:[this.state.output,this.state.newLinesCount>0&&X.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};L(rl,"MAX_OUTPUT_LENGTH",7500),L(rl,"LOCAL_STORAGE_KEY","outputLog");let kC=rl;const dV="fa3ebb86324506ecbcb0a0d24771b4612e65806e",Gs=()=>{const[,t]=S.useReducer(e=>e+1,0);return S.useEffect(()=>go.subscribe(t),[]),[go.getState(),go.dispatch]},fV=()=>{const[t,e]=S.useState([]);return S.useEffect(()=>{const n=()=>{e(window.speechSynthesis.getVoices())};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)},[]),t},l_=({tabs:t})=>{const[e,n]=S.useState(0),r=S.useRef([]),i=S.useRef(!1);return S.useEffect(()=>{r.current=r.current.slice(0,t.length)},[t]),S.useEffect(()=>{const o=a=>{switch(a.key){case"ArrowLeft":i.current=!0,n(l=>l>0?l-1:t.length-1);break;case"ArrowRight":i.current=!0,n(l=>l<t.length-1?l+1:0);break}},s=r.current[e];return s==null||s.addEventListener("keydown",o),()=>{s==null||s.removeEventListener("keydown",o)}},[t.length,e]),S.useEffect(()=>{var o;i.current&&((o=r.current[e])==null||o.focus())},[e]),X.jsxs("div",{children:[X.jsx("div",{role:"tablist",children:t.map((o,s)=>X.jsx("button",{ref:a=>r.current[s]=a,role:"tab","aria-selected":e===s,id:`${o.label}-tab`,"aria-controls":`${o.label}-panel`,onClick:()=>{i.current=!0,n(s)},tabIndex:e===s?void 0:-1,children:o.label},s))}),t.map((o,s)=>X.jsx("div",{role:"tabpanel",id:`${o.label}-panel`,hidden:e!==s,children:o.content},s))]})},hV=()=>{const[t,e]=Gs();return X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:t.general.localEcho,onChange:n=>e({type:Mo.SetGeneral,data:{...t.general,localEcho:n.target.checked}})}),"Local Echo"]})},pV=()=>{const[t,e]=Gs();return X.jsxs("label",{children:["Auto Read:",X.jsxs("select",{value:t.speech.autoreadMode,onChange:n=>e({type:Mo.SetSpeech,data:{...t.speech,autoreadMode:n.target.value}}),children:[X.jsx("option",{value:"off",children:"Off"}),X.jsx("option",{value:"unfocused",children:"Unfocused"}),X.jsx("option",{value:"all",children:"Always"})]})]})},gV=()=>{const[t,e]=Gs(),n=fV();return X.jsxs("label",{children:["Voice:",X.jsx("select",{value:t.speech.voice,onChange:r=>e({type:Mo.SetSpeech,data:{...t.speech,voice:r.target.value}}),children:n.map(r=>X.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},mV=()=>{const[t,e]=Gs();return X.jsxs("label",{children:["Rate (0.1 - 10.0):",X.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:t.speech.rate,onChange:n=>e({type:Mo.SetSpeech,data:{...t.speech,rate:parseFloat(n.target.value)}})})]})},vV=()=>{const[t,e]=Gs();return X.jsxs("label",{children:["Pitch (0 - 2):",X.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:t.speech.pitch,onChange:n=>e({type:Mo.SetSpeech,data:{...t.speech,pitch:parseFloat(n.target.value)}})})]})},CV=()=>{const[t,e]=Gs();return X.jsxs("label",{children:["Volume (0 - 1):",X.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:t.speech.volume,onChange:n=>e({type:Mo.SetSpeech,data:{...t.speech,volume:parseFloat(n.target.value)}})})]})},yV=()=>{const[t]=Gs(),[e,n]=S.useState(!1),r=He.useRef(!0);He.useEffect(()=>()=>{r.current=!1,speechSynthesis.cancel()},[]);const i=()=>{if(e)return;n(!0),console.log("Preview button clicked");const o=()=>{if(!r.current)return;const s=new SpeechSynthesisUtterance("This is a preview of the selected voice settings."),a=speechSynthesis.getVoices();console.log("Available voices:",a.map(c=>c.name));const l=a.find(c=>c.name===t.speech.voice);console.log("Selected voice:",l?l.name:"Not found"),s.voice=l||null,s.rate=t.speech.rate,s.pitch=t.speech.pitch,s.volume=t.speech.volume,console.log("Utterance settings:",{voice:s.voice?s.voice.name:"Default",rate:s.rate,pitch:s.pitch,volume:s.volume}),s.onend=()=>{r.current&&(console.log("Speech ended"),n(!1))},s.onerror=c=>{r.current&&(console.error("Speech synthesis error:",c),n(!1))},speechSynthesis.cancel(),speechSynthesis.speak(s),console.log("Speech started")};if(speechSynthesis.getVoices().length>0)o();else{let s=()=>{s&&(speechSynthesis.onvoiceschanged=null,s=null,r.current&&o())};speechSynthesis.onvoiceschanged=s;const a=()=>{s&&(speechSynthesis.onvoiceschanged=null,s=null)};He.useEffect(()=>a,[])}};return X.jsx("button",{onClick:i,disabled:e,children:e?"Playing...":"Preview Voice"})},xV=()=>X.jsxs("div",{children:[X.jsx(pV,{}),X.jsx("br",{}),X.jsx(gV,{}),X.jsx("br",{}),X.jsx(mV,{}),X.jsx("br",{}),X.jsx(vV,{}),X.jsx("br",{}),X.jsx(CV,{}),X.jsx("br",{}),X.jsx(yV,{})]}),IV=()=>{const[t,e]=Gs(),n=t.editor,r=o=>{e({type:Mo.SetEditorAutocompleteEnabled,data:o.target.checked})},i=o=>{e({type:Mo.SetEditorAccessibilityMode,data:o.target.checked})};return X.jsxs("div",{children:[X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),X.jsx("br",{}),X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:n.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),X.jsx("br",{})]})},bV=()=>{const t=[{label:"General",content:X.jsx(hV,{})},{label:"Speech",content:X.jsx(xV,{})},{label:"Editor",content:X.jsx(IV,{})}];return X.jsx(l_,{tabs:t})};function AV(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function qd(){return qd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qd.apply(null,arguments)}var EC="data-focus-lock",c_="data-focus-lock-disabled",wV="data-no-focus-lock",SV="data-autofocus-inside",kV="data-no-autofocus";function Rm(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function EV(t,e){var n=S.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var TV=typeof window<"u"?S.useLayoutEffect:S.useEffect,Ow=new WeakMap;function RV(t,e){var n=EV(null,function(r){return t.forEach(function(i){return Rm(i,r)})});return TV(function(){var r=Ow.get(n);if(r){var i=new Set(r),o=new Set(t),s=n.current;i.forEach(function(a){o.has(a)||Rm(a,null)}),o.forEach(function(a){i.has(a)||Rm(a,s)})}Ow.set(n,t)},[t]),n}var _m={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},TC=function(t,e){return TC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},TC(t,e)};function hu(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");TC(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var RC=function(){return RC=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},RC.apply(this,arguments)};function _V(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function u_(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Zc(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function _C(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function DC(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function Ac(t){return this instanceof Ac?(this.v=t,this):new Ac(t)}function DV(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(h){return function(p){return Promise.resolve(p).then(h,d)}}function a(h,p){r[h]&&(i[h]=function(m){return new Promise(function(C,v){o.push([h,m,C,v])>1||l(h,m)})},p&&(i[h]=p(i[h])))}function l(h,p){try{c(r[h](p))}catch(m){f(o[0][3],m)}}function c(h){h.value instanceof Ac?Promise.resolve(h.value.v).then(u,d):f(o[0][2],h)}function u(h){l("next",h)}function d(h){l("throw",h)}function f(h,p){h(p),o.shift(),o.length&&l(o[0][0],o[0][1])}}function PV(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Zc=="function"?Zc(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){s=t[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}function d_(t){return t}function f_(t,e){e===void 0&&(e=d_);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(o){var s=e(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var l=function(){var u=s;s=[],u.forEach(o)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),n}}}};return i}function tx(t,e){return e===void 0&&(e=d_),f_(t,e)}function NV(t){t===void 0&&(t={});var e=f_(null);return e.options=RC({async:!0,ssr:!1},t),e}var h_=tx({},function(t){var e=t.target,n=t.currentTarget;return{target:e,currentTarget:n}}),p_=tx(),BV=tx(),FV=NV({async:!0,ssr:typeof document<"u"}),OV=S.createContext(void 0),MV=[],nx=S.forwardRef(function(e,n){var r,i=S.useState(),o=i[0],s=i[1],a=S.useRef(),l=S.useRef(!1),c=S.useRef(null),u=S.useState({}),d=u[1],f=e.children,h=e.disabled,p=h===void 0?!1:h,m=e.noFocusGuards,C=m===void 0?!1:m,v=e.persistentFocus,g=v===void 0?!1:v,y=e.crossFrame,I=y===void 0?!0:y,b=e.autoFocus,E=b===void 0?!0:b;e.allowTextSelection;var w=e.group,k=e.className,D=e.whiteList,T=e.hasPositiveIndices,R=e.shards,P=R===void 0?MV:R,M=e.as,G=M===void 0?"div":M,H=e.lockProps,q=H===void 0?{}:H,ie=e.sideCar,Z=e.returnFocus,Q=Z===void 0?!1:Z,ne=e.focusOptions,F=e.onActivation,z=e.onDeactivation,J=S.useState({}),ee=J[0],se=S.useCallback(function(Ce){var Ue=Ce.captureFocusRestore;if(!c.current){var Le,Pe=(Le=document)==null?void 0:Le.activeElement;c.current=Pe,Pe!==document.body&&(c.current=Ue(Pe))}a.current&&F&&F(a.current),l.current=!0,d()},[F]),me=S.useCallback(function(){l.current=!1,z&&z(a.current),d()},[z]),Be=S.useCallback(function(Ce){var Ue=c.current;if(Ue){var Le=(typeof Ue=="function"?Ue():Ue)||document.body,Pe=typeof Q=="function"?Q(Le):Q;if(Pe){var $e=typeof Pe=="object"?Pe:void 0;c.current=null,Ce?Promise.resolve().then(function(){return Le.focus($e)}):Le.focus($e)}}},[Q]),ae=S.useCallback(function(Ce){l.current&&h_.useMedium(Ce)},[]),Pt=p_.useMedium,Vt=S.useCallback(function(Ce){a.current!==Ce&&(a.current=Ce,s(Ce))},[]),dn=qd((r={},r[c_]=p&&"disabled",r[EC]=w,r),q),ze=C!==!0,at=ze&&C!=="tail",ot=RV([n,Vt]),he=S.useMemo(function(){return{observed:a,shards:P,enabled:!p,active:l.current}},[p,l.current,P,o]);return He.createElement(S.Fragment,null,ze&&[He.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:p?-1:0,style:_m}),T?He.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:p?-1:1,style:_m}):null],!p&&He.createElement(ie,{id:ee,sideCar:FV,observed:o,disabled:p,persistentFocus:g,crossFrame:I,autoFocus:E,whiteList:D,shards:P,onActivation:se,onDeactivation:me,returnFocus:Be,focusOptions:ne,noFocusGuards:C}),He.createElement(G,qd({ref:ot},dn,{className:k,onBlur:Pt,onFocus:ae}),He.createElement(OV.Provider,{value:he},f)),at&&He.createElement("div",{"data-focus-guard":!0,tabIndex:p?-1:0,style:_m}))});nx.propTypes={};function PC(t,e){return PC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},PC(t,e)}function LV(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,PC(t,e)}function Qd(t){"@babel/helpers - typeof";return Qd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qd(t)}function UV(t,e){if(Qd(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Qd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VV(t){var e=UV(t,"string");return Qd(e)=="symbol"?e:e+""}function GV(t,e,n){return(e=VV(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WV(t,e){function n(r){return r.displayName||r.name||"Component"}return function(i){var o=[],s;function a(){s=t(o.map(function(c){return c.props})),e(s)}var l=function(c){LV(u,c);function u(){return c.apply(this,arguments)||this}u.peek=function(){return s};var d=u.prototype;return d.componentDidMount=function(){o.push(this),a()},d.componentDidUpdate=function(){a()},d.componentWillUnmount=function(){var h=o.indexOf(this);o.splice(h,1),a()},d.render=function(){return He.createElement(i,this.props)},u}(S.PureComponent);return GV(l,"displayName","SideEffect("+n(i)+")"),l}}var zo=function(t){for(var e=Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e},kl=function(t){return Array.isArray(t)?t:[t]},g_=function(t){return Array.isArray(t)?t[0]:t},zV=function(t){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(t,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},m_=function(t){return t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.host:t.parentNode},v_=function(t){return t===document||t&&t.nodeType===Node.DOCUMENT_NODE},jV=function(t){return t.hasAttribute("inert")},HV=function(t,e){return!t||v_(t)||!zV(t)&&!jV(t)&&e(m_(t))},C_=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=HV(e,C_.bind(void 0,t));return t.set(e,r),r},ZV=function(t,e){return t&&!v_(t)?KV(t)?e(m_(t)):!1:!0},y_=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=ZV(e,y_.bind(void 0,t));return t.set(e,r),r},x_=function(t){return t.dataset},$V=function(t){return t.tagName==="BUTTON"},I_=function(t){return t.tagName==="INPUT"},b_=function(t){return I_(t)&&t.type==="radio"},XV=function(t){return!((I_(t)||$V(t))&&(t.type==="hidden"||t.disabled))},KV=function(t){var e=t.getAttribute(kV);return![!0,"true",""].includes(e)},rx=function(t){var e;return!!(t&&(!((e=x_(t))===null||e===void 0)&&e.focusGuard))},NC=function(t){return!rx(t)},JV=function(t){return!!t},YV=function(t,e){var n=Math.max(0,t.tabIndex),r=Math.max(0,e.tabIndex),i=n-r,o=t.index-e.index;if(i){if(!n)return 1;if(!r)return-1}return i||o},qV=function(t){return t.tabIndex<0&&!t.hasAttribute("tabindex")?0:t.tabIndex},ix=function(t,e,n){return zo(t).map(function(r,i){var o=qV(r);return{node:r,index:i,tabIndex:n&&o===-1?(r.dataset||{}).focusGuard?0:-1:o}}).filter(function(r){return!e||r.tabIndex>=0}).sort(YV)},QV=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],ox=QV.join(","),eG="".concat(ox,", [data-focus-guard]"),A_=function(t,e){return zo((t.shadowRoot||t).children).reduce(function(n,r){return n.concat(r.matches(e?eG:ox)?[r]:[],A_(r))},[])},tG=function(t,e){var n;return t instanceof HTMLIFrameElement&&(!((n=t.contentDocument)===null||n===void 0)&&n.body)?$c([t.contentDocument.body],e):[t]},$c=function(t,e){return t.reduce(function(n,r){var i,o=A_(r,e),s=(i=[]).concat.apply(i,o.map(function(a){return tG(a,e)}));return n.concat(s,r.parentNode?zo(r.parentNode.querySelectorAll(ox)).filter(function(a){return a===r}):[])},[])},nG=function(t){var e=t.querySelectorAll("[".concat(SV,"]"));return zo(e).map(function(n){return $c([n])}).reduce(function(n,r){return n.concat(r)},[])},sx=function(t,e){return zo(t).filter(function(n){return C_(e,n)}).filter(function(n){return XV(n)})},Mw=function(t,e){return e===void 0&&(e=new Map),zo(t).filter(function(n){return y_(e,n)})},ax=function(t,e,n){return ix(sx($c(t,n),e),!0,n)},ef=function(t,e){return ix(sx($c(t),e),!1)},rG=function(t,e){return sx(nG(t),e)},gl=function(t,e){return t.shadowRoot?gl(t.shadowRoot,e):Object.getPrototypeOf(t).contains!==void 0&&Object.getPrototypeOf(t).contains.call(t,e)?!0:zo(t.children).some(function(n){var r;if(n instanceof HTMLIFrameElement){var i=(r=n.contentDocument)===null||r===void 0?void 0:r.body;return i?gl(i,e):!1}return gl(n,e)})},iG=function(t){for(var e=new Set,n=t.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var o=t[r].compareDocumentPosition(t[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return t.filter(function(s,a){return!e.has(a)})},w_=function(t){return t.parentNode?w_(t.parentNode):t},lx=function(t){var e=kl(t);return e.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(EC);return n.push.apply(n,i?iG(zo(w_(r).querySelectorAll("[".concat(EC,'="').concat(i,'"]:not([').concat(c_,'="disabled"])')))):[r]),n},[])},oG=function(t){try{return t()}catch{return}},tf=function(t){if(t===void 0&&(t=document),!(!t||!t.activeElement)){var e=t.activeElement;return e.shadowRoot?tf(e.shadowRoot):e instanceof HTMLIFrameElement&&oG(function(){return e.contentWindow.document})?tf(e.contentWindow.document):e}},sG=function(t,e){return t===e},aG=function(t,e){return!!zo(t.querySelectorAll("iframe")).some(function(n){return sG(n,e)})},S_=function(t,e){return e===void 0&&(e=tf(g_(t).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:lx(t).some(function(n){return gl(n,e)||aG(n,e)})},lG=function(t){t===void 0&&(t=document);var e=tf(t);return e?zo(t.querySelectorAll("[".concat(wV,"]"))).some(function(n){return gl(n,e)}):!1},cG=function(t,e){return e.filter(b_).filter(function(n){return n.name===t.name}).filter(function(n){return n.checked})[0]||t},cx=function(t,e){return b_(t)&&t.name?cG(t,e):t},uG=function(t){var e=new Set;return t.forEach(function(n){return e.add(cx(n,t))}),t.filter(function(n){return e.has(n)})},Lw=function(t){return t[0]&&t.length>1?cx(t[0],t):t[0]},Uw=function(t,e){return t.indexOf(cx(e,t))},BC="NEW_FOCUS",dG=function(t,e,n,r,i){var o=t.length,s=t[0],a=t[o-1],l=rx(r);if(!(r&&t.indexOf(r)>=0)){var c=r!==void 0?n.indexOf(r):-1,u=i?n.indexOf(i):c,d=i?t.indexOf(i):-1;if(c===-1)return d!==-1?d:BC;if(d===-1)return BC;var f=c-u,h=n.indexOf(s),p=n.indexOf(a),m=uG(n),C=r!==void 0?m.indexOf(r):-1,v=i?m.indexOf(i):C,g=m.filter(function(k){return k.tabIndex>=0}),y=r!==void 0?g.indexOf(r):-1,I=i?g.indexOf(i):y,b=y>=0&&I>=0?I-y:v-C;if(!f&&d>=0||e.length===0)return d;var E=Uw(t,e[0]),w=Uw(t,e[e.length-1]);if(c<=h&&l&&Math.abs(f)>1)return w;if(c>=p&&l&&Math.abs(f)>1)return E;if(f&&Math.abs(b)>1)return d;if(c<=h)return w;if(c>p)return E;if(f)return Math.abs(f)>1?d:(o+d+f)%o}},fG=function(t){return function(e){var n,r=(n=x_(e))===null||n===void 0?void 0:n.autofocus;return e.autofocus||r!==void 0&&r!=="false"||t.indexOf(e)>=0}},Vw=function(t,e,n){var r=t.map(function(o){var s=o.node;return s}),i=Mw(r.filter(fG(n)));return i&&i.length?Lw(i):Lw(Mw(e))},FC=function(t,e){return e===void 0&&(e=[]),e.push(t),t.parentNode&&FC(t.parentNode.host||t.parentNode,e),e},Dm=function(t,e){for(var n=FC(t),r=FC(e),i=0;i<n.length;i+=1){var o=n[i];if(r.indexOf(o)>=0)return o}return!1},k_=function(t,e,n){var r=kl(t),i=kl(e),o=r[0],s=!1;return i.filter(Boolean).forEach(function(a){s=Dm(s||a,a)||s,n.filter(Boolean).forEach(function(l){var c=Dm(o,l);c&&(!s||gl(c,s)?s=c:s=Dm(c,s))})}),s},Gw=function(t,e){return t.reduce(function(n,r){return n.concat(rG(r,e))},[])},hG=function(t,e){var n=new Map;return e.forEach(function(r){return n.set(r.node,r)}),t.map(function(r){return n.get(r)}).filter(JV)},pG=function(t,e){var n=tf(kl(t).length>0?document:g_(t).ownerDocument),r=lx(t).filter(NC),i=k_(n||t,t,r),o=new Map,s=ef(r,o),a=s.filter(function(p){var m=p.node;return NC(m)});if(a[0]){var l=ef([i],o).map(function(p){var m=p.node;return m}),c=hG(l,a),u=c.map(function(p){var m=p.node;return m}),d=c.filter(function(p){var m=p.tabIndex;return m>=0}).map(function(p){var m=p.node;return m}),f=dG(u,d,l,n,e);if(f===BC){var h=Vw(s,d,Gw(r,o))||Vw(s,u,Gw(r,o));if(h)return{node:h};console.warn("focus-lock: cannot find any node to move focus into");return}return f===void 0?f:c[f]}},gG=function(t){var e=lx(t).filter(NC),n=k_(t,t,e),r=ix($c([n],!0),!0,!0),i=$c(e,!1);return r.map(function(o){var s=o.node,a=o.index;return{node:s,index:a,lockItem:i.indexOf(s)>=0,guard:rx(s)}})},ux=function(t,e){t&&("focus"in t&&t.focus(e),"contentWindow"in t&&t.contentWindow&&t.contentWindow.focus())},Pm=0,Nm=!1,E_=function(t,e,n){n===void 0&&(n={});var r=pG(t,e);if(!Nm&&r){if(Pm>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),Nm=!0,setTimeout(function(){Nm=!1},1);return}Pm++,ux(r.node,n.focusOptions),Pm--}};function Vu(t){if(!t)return null;if(typeof WeakRef>"u")return function(){return t||null};var e=t?new WeakRef(t):null;return function(){return(e==null?void 0:e.deref())||null}}var mG=function(t){if(!t)return null;for(var e=[],n=t;n&&n!==document.body;)e.push({current:Vu(n),parent:Vu(n.parentElement),left:Vu(n.previousElementSibling),right:Vu(n.nextElementSibling)}),n=n.parentElement;return{element:Vu(t),stack:e,ownerDocument:t.ownerDocument}},vG=function(t){var e,n,r,i,o;if(t)for(var s=t.stack,a=t.ownerDocument,l=new Map,c=0,u=s;c<u.length;c++){var d=u[c],f=(e=d.parent)===null||e===void 0?void 0:e.call(d);if(f&&a.contains(f)){for(var h=(n=d.left)===null||n===void 0?void 0:n.call(d),p=d.current(),m=f.contains(p)?p:void 0,C=(r=d.right)===null||r===void 0?void 0:r.call(d),v=ax([f],l),g=(o=(i=m??(h==null?void 0:h.nextElementSibling))!==null&&i!==void 0?i:C)!==null&&o!==void 0?o:h;g;){for(var y=0,I=v;y<I.length;y++){var b=I[y];if(g!=null&&g.contains(b.node))return b.node}g=g.nextElementSibling}if(v.length)return v[0].node}}},T_=function(t){var e=mG(t);return function(){return vG(e)}},CG=function(t,e,n){if(!t||!e)return console.error("no element or scope given"),{};var r=kl(e);if(r.every(function(s){return!gl(s,t)}))return console.error("Active element is not contained in the scope"),{};var i=n?ax(r,new Map):ef(r,new Map),o=i.findIndex(function(s){var a=s.node;return a===t});if(o!==-1)return{prev:i[o-1],next:i[o+1],first:i[0],last:i[i.length-1]}},yG=function(t,e){var n=e?ax(kl(t),new Map):ef(kl(t),new Map);return{first:n[0],last:n[n.length-1]}},xG=function(t){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},t)},R_=function(t,e,n){e===void 0&&(e={});var r=xG(e),i=CG(t,r.scope,r.onlyTabbable);if(i){var o=n(i,r.cycle);o&&ux(o.node,r.focusOptions)}},IG=function(t,e){e===void 0&&(e={}),R_(t,e,function(n,r){var i=n.next,o=n.first;return i||r&&o})},bG=function(t,e){e===void 0&&(e={}),R_(t,e,function(n,r){var i=n.prev,o=n.last;return i||r&&o})},__=function(t,e,n){var r,i=yG(t,(r=e.onlyTabbable)!==null&&r!==void 0?r:!0),o=i[n];o&&ux(o.node,e.focusOptions)},AG=function(t,e){e===void 0&&(e={}),__(t,e,"first")},wG=function(t,e){e===void 0&&(e={}),__(t,e,"last")};function dx(t){setTimeout(t,1)}var SG=function(e){return e&&"current"in e?e.current:e},D_=function(){return document&&document.activeElement===document.body},kG=function(){return D_()||lG()},wc=null,Cr=null,Ww=function(){return null},Sc=null,nf=!1,fx=!1,EG=function(){return!0},TG=function(e){return(wc.whiteList||EG)(e)},RG=function(e,n){Sc={observerNode:e,portaledElement:n}},_G=function(e){return Sc&&Sc.portaledElement===e};function zw(t,e,n,r){var i=null,o=t;do{var s=r[o];if(s.guard)s.node.dataset.focusAutoGuard&&(i=s);else if(s.lockItem){if(o!==t)return;i=null}else break}while((o+=n)!==e);i&&(i.node.tabIndex=0)}var DG=function(e){return e?!!nf:nf==="meanwhile"},PG=function t(e,n,r){return n&&(n.host===e&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&t(e,n.parentNode,r))},NG=function(e,n){return n.some(function(r){return PG(e,r,r)})},P_=function(e){return ef(e,new Map)},BG=function(e){return!P_([e.parentNode]).some(function(n){return n.node===e})},K0=function(){var e=!1;if(wc){var n=wc,r=n.observed,i=n.persistentFocus,o=n.autoFocus,s=n.shards,a=n.crossFrame,l=n.focusOptions,c=n.noFocusGuards,u=r||Sc&&Sc.portaledElement;if(D_()&&Cr&&Cr!==document.body&&(!document.body.contains(Cr)||BG(Cr))){var d=Ww();d&&d.focus()}var f=document&&document.activeElement;if(u){var h=[u].concat(s.map(SG).filter(Boolean)),p=function(){if(!DG(a)||!c||!Cr||fx)return!1;var y=P_(h),I=y.findIndex(function(b){var E=b.node;return E===Cr});return I===0||I===y.length-1};if((!f||TG(f))&&(i||p()||!kG()||!Cr&&o)&&(u&&!(S_(h)||f&&NG(f,h)||_G(f))&&(document&&!Cr&&f&&!o?(f.blur&&f.blur(),document.body.focus()):(e=E_(h,Cr,{focusOptions:l}),Sc={})),Cr=document&&document.activeElement,Cr!==document.body&&(Ww=T_(Cr)),nf=!1),document&&f!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var m=document&&document.activeElement,C=gG(h),v=C.map(function(g){var y=g.node;return y}).indexOf(m);v>-1&&(C.filter(function(g){var y=g.guard,I=g.node;return y&&I.dataset.focusAutoGuard}).forEach(function(g){var y=g.node;return y.removeAttribute("tabIndex")}),zw(v,C.length,1,C),zw(v,-1,-1,C))}}}return e},N_=function(e){K0()&&e&&(e.stopPropagation(),e.preventDefault())},hx=function(){return dx(K0)},FG=function(e){var n=e.target,r=e.currentTarget;r.contains(n)||RG(r,n)},OG=function(){return null},B_=function(){fx=!0},F_=function(){fx=!1,nf="just",dx(function(){nf="meanwhile"})},MG=function(){document.addEventListener("focusin",N_),document.addEventListener("focusout",hx),window.addEventListener("focus",B_),window.addEventListener("blur",F_)},LG=function(){document.removeEventListener("focusin",N_),document.removeEventListener("focusout",hx),window.removeEventListener("focus",B_),window.removeEventListener("blur",F_)};function UG(t){return t.filter(function(e){var n=e.disabled;return!n})}var O_={moveFocusInside:E_,focusInside:S_,focusNextElement:IG,focusPrevElement:bG,focusFirstElement:AG,focusLastElement:wG,captureFocusRestore:T_};function VG(t){var e=t.slice(-1)[0];e&&!wc&&MG();var n=wc,r=n&&e&&e.id===n.id;wc=e,n&&!r&&(n.onDeactivation(),t.filter(function(i){var o=i.id;return o===n.id}).length||n.returnFocus(!e)),e?(Cr=null,(!r||n.observed!==e.observed)&&e.onActivation(O_),K0(),dx(K0)):(LG(),Cr=null)}h_.assignSyncMedium(FG);p_.assignMedium(hx);BV.assignMedium(function(t){return t(O_)});const GG=WV(UG,VG)(OG);var M_=S.forwardRef(function(e,n){return He.createElement(nx,qd({sideCar:GG,ref:n},e))}),L_=nx.propTypes||{};L_.sideCar;AV(L_,["sideCar"]);M_.propTypes={};const WG=He.forwardRef((t,e)=>{const[n,r]=S.useState(!1),i=S.useRef(null);return He.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),S.useEffect(()=>{var o;n&&((o=i.current)==null||o.focus())},[n]),S.useEffect(()=>{const o=s=>{s.key==="Escape"&&r(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]),X.jsx(M_,{disabled:!n,children:X.jsxs("dialog",{className:"preferences-dialog",open:n,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[X.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),n&&X.jsx(bV,{}),X.jsx("button",{onClick:()=>r(!1),children:"Close"}),X.jsx("br",{}),X.jsxs("span",{id:"commit-hash",children:["Version: ",dV]})]})})}),zG=({users:t})=>{const[e,n]=S.useState(-1),r=S.useRef(null),i=()=>{e===-1&&t.length>0&&n(0)};S.useEffect(()=>{if(e!==-1){const s=document.getElementById(`userlist-option-${e}`);s&&s.scrollIntoView({block:"nearest"})}},[e]);const o=s=>{if(t.length!==0){if(s.key==="ArrowDown")n(a=>(a+1)%t.length),s.preventDefault();else if(s.key==="ArrowUp")n(a=>(a-1+t.length)%t.length),s.preventDefault();else if(s.key==="Home")n(0),s.preventDefault();else if(s.key==="End")n(t.length-1),s.preventDefault();else if(s.key==="PageUp")n(a=>Math.max(a-5,0)),s.preventDefault();else if(s.key==="PageDown")n(a=>Math.min(a+5,t.length-1)),s.preventDefault();else if(s.key.length===1){const a=s.key.toLowerCase();let l=e===-1?0:(e+1)%t.length,c=-1;for(let u=0;u<t.length;u++){const d=(l+u)%t.length;if(t[d].Name&&t[d].Name[0].toLowerCase()===a){c=d;break}}c!==-1&&(n(c),s.preventDefault())}}};return X.jsxs(X.Fragment,{children:[X.jsx("div",{className:"sidebar-header",id:"userlist-header","aria-hidden":"true",children:"Connected Players"}),X.jsx("div",{className:"sidebar",ref:r,tabIndex:0,role:"listbox","aria-labelledby":"userlist-header","aria-activedescendant":e!==-1?`userlist-option-${e}`:void 0,onFocus:i,onKeyDown:o,children:X.jsx("div",{className:"sidebar-content",children:X.jsx("ul",{role:"none",children:t.map((s,a)=>{let l="",c="Online";return s.away&&(l+=" away",c="Away"),s.idle&&(l+=" idle",c==="Online"&&(c="Idle")),a===e&&(l+=" selected"),X.jsxs("li",{id:`userlist-option-${a}`,className:l,role:"option","aria-selected":a===e,children:[s.Name,X.jsxs("span",{className:"sr-only",children:["",`(${c})`]})]},s.Object)})})})})]})},jG=({onFileChange:t,onRecipientChange:e,onSendFile:n,selectedFile:r,recipient:i})=>{const o=a=>{a.target.files&&a.target.files.length>0&&t(a.target.files[0])},s=a=>{e(a.target.value)};return X.jsxs("div",{className:"file-transfer-controls",children:[X.jsx("input",{type:"file",onChange:o}),X.jsx("input",{type:"text",placeholder:"Recipient",value:i,onChange:s}),X.jsx("button",{onClick:n,disabled:!r||!i,children:"Send File"})]})},HG=({progress:t})=>X.jsxs("div",{className:"progress-bar",children:[X.jsx("progress",{value:t,max:"100"}),X.jsxs("span",{children:[t.toFixed(2),"%"]})]}),ZG=({offer:t,onAccept:e,onReject:n})=>X.jsxs("div",{className:"incoming-transfer",children:[X.jsxs("p",{children:["Incoming file: ",t.filename," from ",t.sender]}),X.jsx("button",{onClick:()=>e(t.sender,t.hash),children:"Accept"}),X.jsx("button",{onClick:()=>n(t.sender,t.hash),children:"Reject"})]}),$G=({history:t})=>X.jsxs("div",{className:"transfer-history","aria-live":"polite",children:[X.jsx("h4",{children:"Transfer History"}),X.jsx("ul",{children:t.map((e,n)=>X.jsx("li",{children:e},n))})]}),XG=({client:t,expanded:e})=>{const[n,r]=S.useState(null),[i,o]=S.useState(""),[s,a]=S.useState(0),[l,c]=S.useState(0),[u,d]=S.useState([]),[f,h]=S.useState([]),p=S.useCallback(R=>{h(P=>[...P,R].slice(-10))},[]),m=S.useCallback(R=>{const P=R.sentBytes/R.totalBytes*100;a(P)},[]),C=S.useCallback(R=>{const P=R.receivedBytes/R.totalBytes*100;c(P)},[]),v=S.useCallback(R=>{p(`File sent successfully: ${R.filename}`),a(0)},[p]),g=S.useCallback(R=>{p(`File received successfully: ${R.filename}`),c(0)},[p]),y=S.useCallback(R=>{p(`Error ${R.direction}ing file ${R.filename}: ${R.error}`),R.direction==="send"?a(0):c(0)},[p]),I=S.useCallback(R=>{p(`File transfer cancelled: ${R.filename} (${R.direction})`),R.direction==="send"?a(0):c(0)},[p]),b=S.useCallback(R=>{p(`File transfer rejected: ${R.filename} from ${R.sender}`)},[p]),E=S.useCallback(R=>{p(`File transfer accepted: ${R.filename} by ${R.sender}`)},[p]),w=S.useCallback(R=>{d(P=>[...P,R]),p(`Incoming file offer: ${R.filename} from ${R.sender}`)},[p]);S.useEffect(()=>(t.on("fileTransferOffer",w),t.on("fileTransferAccepted",E),t.fileTransferManager.on("fileSendProgress",m),t.fileTransferManager.on("fileReceiveProgress",C),t.on("fileTransferError",y),t.on("fileTransferCancelled",I),t.on("fileTransferRejected",b),t.on("fileSendComplete",v),t.fileTransferManager.on("fileReceiveComplete",g),()=>{t.off("fileTransferOffer",w),t.off("fileTransferAccepted",E),t.fileTransferManager.off("fileSendProgress",m),t.fileTransferManager.off("fileReceiveProgress",C),t.off("fileTransferError",y),t.off("fileTransferCancelled",I),t.off("fileTransferRejected",b),t.off("fileSendComplete",v),t.fileTransferManager.off("fileReceiveComplete",g)}),[t,w,E,m,C,y,I,b,v,g]);const k=()=>{n&&i&&t.sendFile(n,i).then(()=>{p(`Sending ${n.name} to ${i}`)}).catch(R=>{p(`Error sending file: ${R.message}`)})},D=(R,P)=>{t.acceptTransfer(R,P);const M=u.find(G=>G.hash===P);M&&p(`Accepting file transfer: ${M.filename} from ${R}`),d(G=>G.filter(H=>H.hash!==P))},T=(R,P)=>{t.rejectTransfer(R,P);const M=u.find(G=>G.hash===P);M&&p(`Rejected file transfer: ${M.filename} from ${R}`),d(G=>G.filter(H=>H.hash!==P))};return X.jsxs("div",{className:`file-transfer-ui ${e?"expanded":"collapsed"}`,children:[X.jsx("h3",{children:"File Transfer"}),X.jsx(jG,{onFileChange:r,onRecipientChange:o,onSendFile:k,selectedFile:n,recipient:i}),(s>0||l>0)&&X.jsx(HG,{progress:s>0?s:l}),u.map(R=>X.jsx(ZG,{offer:R,onAccept:D,onReject:T},`${R.sender}-${R.filename}`)),X.jsx($G,{history:f})]})};var jw={};function KG(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var JG=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function YG(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var U_={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(JG,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function o(m,C){var v=m[C];if(typeof v.bind=="function")return v.bind(m);try{return Function.prototype.bind.call(v,m)}catch{return function(){return Function.prototype.apply.apply(v,[m,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?s:console[m]!==void 0?o(console,m):console.log!==void 0?o(console,"log"):e}function l(m,C){for(var v=0;v<i.length;v++){var g=i[v];this[g]=v<m?e:this.methodFactory(g,m,C)}this.log=this.debug}function c(m,C,v){return function(){typeof console!==n&&(l.call(this,C,v),this[m].apply(this,arguments))}}function u(m,C,v){return a(m)||c.apply(this,arguments)}function d(m,C,v){var g=this,y;C=C??"WARN";var I="loglevel";typeof m=="string"?I+=":"+m:typeof m=="symbol"&&(I=void 0);function b(D){var T=(i[D]||"silent").toUpperCase();if(!(typeof window===n||!I)){try{window.localStorage[I]=T;return}catch{}try{window.document.cookie=encodeURIComponent(I)+"="+T+";"}catch{}}}function E(){var D;if(!(typeof window===n||!I)){try{D=window.localStorage[I]}catch{}if(typeof D===n)try{var T=window.document.cookie,R=T.indexOf(encodeURIComponent(I)+"=");R!==-1&&(D=/^([^;]+)/.exec(T.slice(R))[1])}catch{}return g.levels[D]===void 0&&(D=void 0),D}}function w(){if(!(typeof window===n||!I)){try{window.localStorage.removeItem(I);return}catch{}try{window.document.cookie=encodeURIComponent(I)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}g.name=m,g.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},g.methodFactory=v||u,g.getLevel=function(){return y},g.setLevel=function(D,T){if(typeof D=="string"&&g.levels[D.toUpperCase()]!==void 0&&(D=g.levels[D.toUpperCase()]),typeof D=="number"&&D>=0&&D<=g.levels.SILENT){if(y=D,T!==!1&&b(D),l.call(g,D,m),typeof console===n&&D<g.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+D},g.setDefaultLevel=function(D){C=D,E()||g.setLevel(D,!1)},g.resetLevel=function(){g.setLevel(C,!1),w()},g.enableAll=function(D){g.setLevel(g.levels.TRACE,D)},g.disableAll=function(D){g.setLevel(g.levels.SILENT,D)};var k=E();k==null&&(k=C),g.setLevel(k,!1)}var f=new d,h={};f.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var v=h[C];return v||(v=h[C]=new d(C,f.getLevel(),f.methodFactory)),v};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(U_);var px=U_.exports,OC;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(OC||(OC={}));var Lo;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(Lo||(Lo={}));let et=px.getLogger("livekit");et.setDefaultLevel(OC.info);function Ms(t){const e=px.getLogger(t);return e.setDefaultLevel(et.getLevel()),e}px.getLogger("lk-e2ee");function wr(t,e){if(!t)throw new Error(e)}const qG=34028234663852886e22,QG=-34028234663852886e22,eW=4294967295,tW=2147483647,nW=-2147483648;function zh(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>tW||t<nW)throw new Error("invalid int 32: "+t)}function MC(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>eW||t<0)throw new Error("invalid uint 32: "+t)}function V_(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>qG||t<QG))throw new Error("invalid float 32: "+t)}const G_=Symbol("@bufbuild/protobuf/enum-type");function rW(t){const e=t[G_];return wr(e,"missing enum type on enum object"),e}function W_(t,e,n,r){t[G_]=z_(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function z_(t,e,n){const r=Object.create(null),i=Object.create(null),o=[];for(const s of e){const a=j_(s);o.push(a),r[s.name]=a,i[s.no]=a}return{typeName:t,values:o,findName(s){return r[s]},findNumber(s){return i[s]}}}function iW(t,e,n){const r={};for(const i of e){const o=j_(i);r[o.localName]=o.no,r[o.no]=o.localName}return W_(r,t,e),r}function j_(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class Se{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,o=i.makeReadOptions(n);return i.readMessage(this,o.readerFactory(e),e.byteLength,o),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,o=i.makeReadOptions(n);return i.readMessage(r,e,o,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),o=i.writerFactory();return r.writeMessage(this,o,i),o.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function oW(t,e,n,r){var i;const o=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),s={[o]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[o];return Object.setPrototypeOf(s.prototype,new Se),Object.assign(s,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,l){return new s().fromBinary(a,l)},fromJson(a,l){return new s().fromJson(a,l)},fromJsonString(a,l){return new s().fromJsonString(a,l)},equals(a,l){return t.util.equals(s,a,l)}}),s}function sW(t,e,n,r){return{syntax:t,json:e,bin:n,util:r,makeMessageType(i,o,s){return oW(this,i,o,s)},makeEnum:iW,makeEnumType:z_,getEnumType:rW}}var le;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(le||(le={}));var El;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(El||(El={}));function aW(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Bm(t,e,n){for(let o=0;o<28;o=o+7){const s=t>>>o,a=!(!(s>>>7)&&e==0),l=(a?s|128:s)&255;if(n.push(l),!a)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let o=3;o<31;o=o+7){const s=e>>>o,a=!!(s>>>7),l=(a?s|128:s)&255;if(n.push(l),!a)return}n.push(e>>>31&1)}}const jh=4294967296;function Hw(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function o(s,a){const l=Number(t.slice(s,a));i*=n,r=r*n+l,r>=jh&&(i=i+(r/jh|0),r=r%jh)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),e?Z_(r,i):gx(r,i)}function lW(t,e){let n=gx(t,e);const r=n.hi&2147483648;r&&(n=Z_(n.lo,n.hi));const i=H_(n.lo,n.hi);return r?"-"+i:i}function H_(t,e){if({lo:t,hi:e}=cW(t,e),e<=2097151)return String(jh*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let o=n+r*6777216+i*6710656,s=r+i*8147497,a=i*2;const l=1e7;return o>=l&&(s+=Math.floor(o/l),o%=l),s>=l&&(a+=Math.floor(s/l),s%=l),a.toString()+Zw(s)+Zw(o)}function cW(t,e){return{lo:t>>>0,hi:e>>>0}}function gx(t,e){return{lo:t|0,hi:e|0}}function Z_(t,e){return e=~e,t?t=~t+1:e+=1,gx(t,e)}const Zw=t=>{const e=String(t);return"0000000".slice(e.length)+e};function $w(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function uW(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function dW(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof jw!="object"||jw.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(l){const c=typeof l=="bigint"?l:BigInt(l);if(c>o||c<i)throw new Error("int64 invalid: ".concat(l));return c},uParse(l){const c=typeof l=="bigint"?l:BigInt(l);if(c>a||c<s)throw new Error("uint64 invalid: ".concat(l));return c},enc(l){return t.setBigInt64(0,this.parse(l),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(l){return t.setBigInt64(0,this.uParse(l),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(l,c){return t.setInt32(0,l,!0),t.setInt32(4,c,!0),t.getBigInt64(0,!0)},uDec(l,c){return t.setInt32(0,l,!0),t.setInt32(4,c,!0),t.getBigUint64(0,!0)}}}const n=i=>wr(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>wr(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),Hw(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),Hw(i)},dec(i,o){return lW(i,o)},uDec(i,o){return H_(i,o)}}}const je=dW();var en;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(en||(en={}));class fW{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(MC(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return zh(e),$w(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){V_(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){MC(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){zh(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return zh(e),e=(e<<1^e>>31)>>>0,$w(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=je.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=je.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=je.enc(e);return Bm(n.lo,n.hi,this.buf),this}sint64(e){let n=je.enc(e),r=n.hi>>31,i=n.lo<<1^r,o=(n.hi<<1|n.lo>>>31)^r;return Bm(i,o,this.buf),this}uint64(e){let n=je.uEnc(e);return Bm(n.lo,n.hi,this.buf),this}}class hW{constructor(e,n){this.varint64=aW,this.uint32=uW,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e){let n=this.pos;switch(e){case en.Varint:for(;this.buf[this.pos++]&128;);break;case en.Bit64:this.pos+=4;case en.Bit32:this.pos+=4;break;case en.LengthDelimited:let r=this.uint32();this.pos+=r;break;case en.StartGroup:let i;for(;(i=this.tag()[1])!==en.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return je.dec(...this.varint64())}uint64(){return je.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,je.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return je.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return je.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function LC(t,e){return e instanceof Se||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}le.DOUBLE,le.FLOAT,le.INT64,le.UINT64,le.INT32,le.UINT32,le.BOOL,le.STRING,le.BYTES;function Js(t,e,n){if(e===n)return!0;if(t==le.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case le.UINT64:case le.FIXED64:case le.INT64:case le.SFIXED64:case le.SINT64:return e==n}return!1}function UC(t,e){switch(t){case le.BOOL:return!1;case le.UINT64:case le.FIXED64:case le.INT64:case le.SFIXED64:case le.SINT64:return e==0?je.zero:"0";case le.DOUBLE:case le.FLOAT:return 0;case le.BYTES:return new Uint8Array(0);case le.STRING:return"";default:return 0}}function $_(t,e){const n=e===void 0;let r=en.Varint,i=e===0;switch(t){case le.STRING:i=n||!e.length,r=en.LengthDelimited;break;case le.BOOL:i=e===!1;break;case le.DOUBLE:r=en.Bit64;break;case le.FLOAT:r=en.Bit32;break;case le.INT64:i=n||e==0;break;case le.UINT64:i=n||e==0;break;case le.FIXED64:i=n||e==0,r=en.Bit64;break;case le.BYTES:i=n||!e.byteLength,r=en.LengthDelimited;break;case le.FIXED32:r=en.Bit32;break;case le.SFIXED32:r=en.Bit32;break;case le.SFIXED64:i=n||e==0,r=en.Bit64;break;case le.SINT64:i=n||e==0;break}const o=le[t].toLowerCase();return[r,o,n||i]}const Yl=Symbol("@bufbuild/protobuf/unknown-fields"),Xw={readUnknownFields:!0,readerFactory:t=>new hW(t)},Kw={writeUnknownFields:!0,writerFactory:()=>new fW};function pW(t){return t?Object.assign(Object.assign({},Xw),t):Xw}function gW(t){return t?Object.assign(Object.assign({},Kw),t):Kw}function mW(){return{makeReadOptions:pW,makeWriteOptions:gW,listUnknownFields(t){var e;return(e=t[Yl])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[Yl]},writeUnknownFields(t,e){const r=t[Yl];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[Yl])||(i[Yl]=[]),i[Yl].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r){const i=t.getType(),o=n===void 0?e.len:e.pos+n;for(;e.pos<o;){const[s,a]=e.tag(),l=i.fields.find(s);if(!l){const f=e.skip(a);r.readUnknownFields&&this.onUnknownField(t,s,a,f);continue}let c=t,u=l.repeated,d=l.localName;switch(l.oneof&&(c=c[l.oneof.localName],c.case!=d&&delete c.value,c.case=d,d="value"),l.kind){case"scalar":case"enum":const f=l.kind=="enum"?le.INT32:l.T;let h=J0;if(l.kind=="scalar"&&l.L>0&&(h=CW),u){let v=c[d];if(a==en.LengthDelimited&&f!=le.STRING&&f!=le.BYTES){let g=e.uint32()+e.pos;for(;e.pos<g;)v.push(h(e,f))}else v.push(h(e,f))}else c[d]=h(e,f);break;case"message":const p=l.T;u?c[d].push(Hh(e,new p,r)):c[d]instanceof Se?Hh(e,c[d],r):(c[d]=Hh(e,new p,r),p.fieldWrapper&&!l.oneof&&!l.repeated&&(c[d]=p.fieldWrapper.unwrapField(c[d])));break;case"map":let[m,C]=vW(l,e,r);c[d][m]=C;break}}}}}function Hh(t,e,n){return e.getType().runtime.bin.readMessage(e,t,t.uint32(),n),e}function vW(t,e,n){const r=e.uint32(),i=e.pos+r;let o,s;for(;e.pos<i;){let[a]=e.tag();switch(a){case 1:o=J0(e,t.K);break;case 2:switch(t.V.kind){case"scalar":s=J0(e,t.V.T);break;case"enum":s=e.int32();break;case"message":s=Hh(e,new t.V.T,n);break}break}}if(o===void 0){let a=UC(t.K,El.BIGINT);o=t.K==le.BOOL?a.toString():a}if(typeof o!="string"&&typeof o!="number"&&(o=o.toString()),s===void 0)switch(t.V.kind){case"scalar":s=UC(t.V.T,El.BIGINT);break;case"enum":s=0;break;case"message":s=new t.V.T;break}return[o,s]}function CW(t,e){const n=J0(t,e);return typeof n=="bigint"?n.toString():n}function J0(t,e){switch(e){case le.STRING:return t.string();case le.BOOL:return t.bool();case le.DOUBLE:return t.double();case le.FLOAT:return t.float();case le.INT32:return t.int32();case le.INT64:return t.int64();case le.UINT64:return t.uint64();case le.FIXED64:return t.fixed64();case le.BYTES:return t.bytes();case le.FIXED32:return t.fixed32();case le.SFIXED32:return t.sfixed32();case le.SFIXED64:return t.sfixed64();case le.SINT64:return t.sint64();case le.UINT32:return t.uint32();case le.SINT32:return t.sint32()}}function yW(t,e,n,r,i){t.tag(n.no,en.LengthDelimited),t.fork();let o=r;switch(n.K){case le.INT32:case le.FIXED32:case le.UINT32:case le.SFIXED32:case le.SINT32:o=Number.parseInt(r);break;case le.BOOL:wr(r=="true"||r=="false"),o=r=="true";break}switch(Id(t,n.K,1,o,!0),n.V.kind){case"scalar":Id(t,n.V.T,2,i,!0);break;case"enum":Id(t,le.INT32,2,i,!0);break;case"message":VC(t,e,n.V.T,2,i);break}t.join()}function VC(t,e,n,r,i){if(i!==void 0){const o=LC(n,i);t.tag(r,en.LengthDelimited).bytes(o.toBinary(e))}}function Id(t,e,n,r,i){let[o,s,a]=$_(e,r);(!a||i)&&t.tag(n,o)[s](r)}function xW(t,e,n,r){if(!r.length)return;t.tag(n,en.LengthDelimited).fork();let[,i]=$_(e);for(let o=0;o<r.length;o++)t[i](r[o]);t.join()}function IW(){return Object.assign(Object.assign({},mW()),{writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){let o,s=i.repeated,a=i.localName;if(i.oneof){const l=t[i.oneof.localName];if(l.case!==a)continue;o=l.value}else o=t[a];switch(i.kind){case"scalar":case"enum":let l=i.kind=="enum"?le.INT32:i.T;if(s)if(i.packed)xW(e,l,i.no,o);else for(const c of o)Id(e,l,i.no,c,!0);else o!==void 0&&Id(e,l,i.no,o,!!i.oneof||i.opt);break;case"message":if(s)for(const c of o)VC(e,n,i.T,i.no,c);else VC(e,n,i.T,i.no,o);break;case"map":for(const[c,u]of Object.entries(o))yW(e,n,i,c,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}let es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Wp=[];for(let t=0;t<es.length;t++)Wp[es[t].charCodeAt(0)]=t;Wp[45]=es.indexOf("+");Wp[95]=es.indexOf("/");const X_={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,o,s=0;for(let a=0;a<t.length;a++){if(o=Wp[t.charCodeAt(a)],o===void 0)switch(t[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:s=o,i=1;break;case 1:n[r++]=s<<2|(o&48)>>4,s=o,i=2;break;case 2:n[r++]=(s&15)<<4|(o&60)>>2,s=o,i=3;break;case 3:n[r++]=(s&3)<<6|o,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let o=0;o<t.length;o++)switch(r=t[o],n){case 0:e+=es[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=es[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=es[i|r>>6],e+=es[r&63],n=0;break}return n&&(e+=es[i],e+="=",n==1&&(e+="=")),e}},Jw={ignoreUnknownFields:!1},Yw={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function bW(t){return t?Object.assign(Object.assign({},Jw),t):Jw}function AW(t){return t?Object.assign(Object.assign({},Yw),t):Yw}function wW(t){const e=t(SW,qw);return{makeReadOptions:bW,makeWriteOptions:AW,readMessage(n,r,i,o){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(r)));o=o??new n;const s={};for(const[a,l]of Object.entries(r)){const c=n.fields.findJsonName(a);if(!c){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let u=c.localName,d=o;if(c.oneof){if(l===null&&c.kind=="scalar")continue;const f=s[c.oneof.localName];if(f)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(c.oneof.name,'" present: "').concat(f,'", "').concat(a,'"'));s[c.oneof.localName]=a,d=d[c.oneof.localName]={case:u},u="value"}if(c.repeated){if(l===null)continue;if(!Array.isArray(l))throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l)));const f=d[u];for(const h of l){if(h===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(h)));let p;switch(c.kind){case"message":p=c.T.fromJson(h,i);break;case"enum":if(p=Fm(c.T,h,i.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=Gu(c.T,h,c.L)}catch(m){let C="cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(h));throw m instanceof Error&&m.message.length>0&&(C+=": ".concat(m.message)),new Error(C)}break}f.push(p)}}else if(c.kind=="map"){if(l===null)continue;if(Array.isArray(l)||typeof l!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l)));const f=d[u];for(const[h,p]of Object.entries(l)){if(p===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: map value null"));let m;switch(c.V.kind){case"message":m=c.V.T.fromJson(p,i);break;case"enum":if(m=Fm(c.V.T,p,i.ignoreUnknownFields),m===void 0)continue;break;case"scalar":try{m=Gu(c.V.T,p,El.BIGINT)}catch(C){let v="cannot decode map value for field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw C instanceof Error&&C.message.length>0&&(v+=": ".concat(C.message)),new Error(v)}break}try{f[Gu(c.K,c.K==le.BOOL?h=="true"?!0:h=="false"?!1:h:h,El.BIGINT).toString()]=m}catch(C){let v="cannot decode map key for field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw C instanceof Error&&C.message.length>0&&(v+=": ".concat(C.message)),new Error(v)}}}else switch(c.kind){case"message":const f=c.T;if(l===null&&f.typeName!="google.protobuf.Value"){if(c.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}d[u]instanceof Se?d[u].fromJson(l,i):(d[u]=f.fromJson(l,i),f.fieldWrapper&&!c.oneof&&(d[u]=f.fieldWrapper.unwrapField(d[u])));break;case"enum":const h=Fm(c.T,l,i.ignoreUnknownFields);h!==void 0&&(d[u]=h);break;case"scalar":try{d[u]=Gu(c.T,l,c.L)}catch(p){let m="cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw p instanceof Error&&p.message.length>0&&(m+=": ".concat(p.message)),new Error(m)}break}}return o},writeMessage(n,r){const i=n.getType(),o={};let s;try{for(const a of i.fields.byMember()){let l;if(a.kind=="oneof"){const c=n[a.localName];if(c.value===void 0)continue;if(s=a.findField(c.case),!s)throw"oneof case not found: "+c.case;l=e(s,c.value,r)}else s=a,l=e(s,n[s.localName],r);l!==void 0&&(o[r.useProtoFieldName?s.name:s.jsonName]=l)}}catch(a){const l=s?"cannot encode field ".concat(i.typeName,".").concat(s.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),c=a instanceof Error?a.message:String(a);throw new Error(l+(c.length>0?": ".concat(c):""))}return o},readScalar:Gu,writeScalar:qw,debug:K_}}function K_(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function Gu(t,e,n){switch(t){case le.DOUBLE:case le.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==le.FLOAT&&V_(r),r;case le.INT32:case le.FIXED32:case le.SFIXED32:case le.SINT32:case le.UINT32:if(e===null)return 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return t==le.UINT32?MC(i):zh(i),i;case le.INT64:case le.SFIXED64:case le.SINT64:if(e===null)return je.zero;if(typeof e!="number"&&typeof e!="string")break;const o=je.parse(e);return n?o.toString():o;case le.FIXED64:case le.UINT64:if(e===null)return je.zero;if(typeof e!="number"&&typeof e!="string")break;const s=je.uParse(e);return n?s.toString():s;case le.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case le.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case le.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return X_.dec(e)}throw new Error}function Fm(t,e,n){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=t.findName(e);if(r||n)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(K_(e)))}function SW(t,e,n,r){var i;if(e===void 0)return e;if(e===0&&!n)return;if(r)return e;if(t.typeName=="google.protobuf.NullValue")return null;const o=t.findNumber(e);return(i=o==null?void 0:o.name)!==null&&i!==void 0?i:e}function qw(t,e,n){if(e!==void 0)switch(t){case le.INT32:case le.SFIXED32:case le.SINT32:case le.FIXED32:case le.UINT32:return wr(typeof e=="number"),e!=0||n?e:void 0;case le.FLOAT:case le.DOUBLE:return wr(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case le.STRING:return wr(typeof e=="string"),e.length>0||n?e:void 0;case le.BOOL:return wr(typeof e=="boolean"),e||n?e:void 0;case le.UINT64:case le.FIXED64:case le.INT64:case le.SFIXED64:case le.SINT64:return wr(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case le.BYTES:return wr(e instanceof Uint8Array),n||e.byteLength>0?X_.enc(e):void 0}}function kW(){return wW((t,e)=>function(r,i,o){if(r.kind=="map"){const s={};switch(r.V.kind){case"scalar":for(const[l,c]of Object.entries(i)){const u=e(r.V.T,c,!0);wr(u!==void 0),s[l.toString()]=u}break;case"message":for(const[l,c]of Object.entries(i))s[l.toString()]=c.toJson(o);break;case"enum":const a=r.V.T;for(const[l,c]of Object.entries(i)){wr(c===void 0||typeof c=="number");const u=t(a,c,!0,o.enumAsInteger);wr(u!==void 0),s[l.toString()]=u}break}return o.emitDefaultValues||Object.keys(s).length>0?s:void 0}else if(r.repeated){const s=[];switch(r.kind){case"scalar":for(let a=0;a<i.length;a++)s.push(e(r.T,i[a],!0));break;case"enum":for(let a=0;a<i.length;a++)s.push(t(r.T,i[a],!0,o.enumAsInteger));break;case"message":for(let a=0;a<i.length;a++)s.push(LC(r.T,i[a]).toJson(o));break}return o.emitDefaultValues||s.length>0?s:void 0}else switch(r.kind){case"scalar":return e(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues);case"enum":return t(r.T,i,!!r.oneof||r.opt||o.emitDefaultValues,o.enumAsInteger);case"message":return i!==void 0?LC(r.T,i).toJson(o):void 0}})}function EW(){return{setEnumType:W_,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,o=e,s=t;if(s[i]!==void 0)switch(r.kind){case"oneof":const a=s[i].case;if(a===void 0)continue;const l=r.findField(a);let c=s[i].value;l&&l.kind=="message"&&!(c instanceof l.T)?c=new l.T(c):l&&l.kind==="scalar"&&l.T===le.BYTES&&(c=Wu(c)),o[i]={case:a,value:c};break;case"scalar":case"enum":let u=s[i];r.T===le.BYTES&&(u=r.repeated?u.map(Wu):Wu(u)),o[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===le.BYTES)for(const[h,p]of Object.entries(s[i]))o[i][h]=Wu(p);else Object.assign(o[i],s[i]);break;case"message":const f=r.V.T;for(const h of Object.keys(s[i])){let p=s[i][h];f.fieldWrapper||(p=new f(p)),o[i][h]=p}break}break;case"message":const d=r.T;if(r.repeated)o[i]=s[i].map(f=>f instanceof d?f:new d(f));else if(s[i]!==void 0){const f=s[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?o[i]=Wu(f):o[i]=f:o[i]=f instanceof d?f:new d(f)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],o=n[r.localName];if(r.repeated){if(i.length!==o.length)return!1;switch(r.kind){case"message":return i.every((s,a)=>r.T.equals(s,o[a]));case"scalar":return i.every((s,a)=>Js(r.T,s,o[a]));case"enum":return i.every((s,a)=>Js(le.INT32,s,o[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,o);case"enum":return Js(le.INT32,i,o);case"scalar":return Js(r.T,i,o);case"oneof":if(i.case!==o.case)return!1;const s=r.findField(i.case);if(s===void 0)return!0;switch(s.kind){case"message":return s.T.equals(i.value,o.value);case"enum":return Js(le.INT32,i.value,o.value);case"scalar":return Js(s.T,i.value,o.value)}throw new Error("oneof cannot contain ".concat(s.kind));case"map":const a=Object.keys(i).concat(Object.keys(o));switch(r.V.kind){case"message":const l=r.V.T;return a.every(u=>l.equals(i[u],o[u]));case"enum":return a.every(u=>Js(le.INT32,i[u],o[u]));case"scalar":const c=r.V.T;return a.every(u=>Js(c,i[u],o[u]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const o=t[i.localName];let s;if(i.repeated)s=o.map(lh);else if(i.kind=="map"){s=r[i.localName];for(const[a,l]of Object.entries(o))s[a]=lh(l)}else i.kind=="oneof"?s=i.findField(o.case)?{case:o.case,value:lh(o.value)}:{case:void 0}:s=lh(o);r[i.localName]=s}return n}}}function lh(t){if(t===void 0)return t;if(t instanceof Se)return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function Wu(t){return t instanceof Uint8Array?t:new Uint8Array(t)}class TW{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function J_(t,e){const n=Y_(t);return e?n:BW(NW(n))}function RW(t){return J_(t,!1)}const _W=Y_;function Y_(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const DW=new Set(["constructor","toString","toJSON","valueOf"]),PW=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),q_=t=>"".concat(t,"$"),NW=t=>PW.has(t)?q_(t):t,BW=t=>DW.has(t)?q_(t):t;class FW{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=RW(e)}addField(e){wr(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}const N=sW("proto3",kW(),IW(),Object.assign(Object.assign({},EW()),{newFieldList(t){return new TW(t,OW)},initFields(t){for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=UC(e.T,e.L);break}}}}));function OW(t){var e,n,r,i;const o=[];let s;for(const a of typeof t=="function"?t():t){const l=a;if(l.localName=J_(a.name,a.oneof!==void 0),l.jsonName=(e=a.jsonName)!==null&&e!==void 0?e:_W(a.name),l.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(l.L=(r=a.L)!==null&&r!==void 0?r:El.BIGINT),l.packed=(i=a.packed)!==null&&i!==void 0?i:a.kind=="enum"||a.kind=="scalar"&&a.T!=le.BYTES&&a.T!=le.STRING,a.oneof!==void 0){const c=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!s||s.name!=c)&&(s=new FW(c)),l.oneof=s,s.addField(l)}o.push(l)}return o}class kn extends Se{constructor(e){super(),this.seconds=je.zero,this.nanos=0,N.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(N.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=je.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return kn.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new kn({seconds:je.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new kn().fromBinary(e,n)}static fromJson(e,n){return new kn().fromJson(e,n)}static fromJsonString(e,n){return new kn().fromJsonString(e,n)}static equals(e,n){return N.util.equals(kn,e,n)}}kn.runtime=N;kn.typeName="google.protobuf.Timestamp";kn.fields=N.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var GC;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC"})(GC||(GC={}));N.util.setEnumType(GC,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var WC;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8"})(WC||(WC={}));N.util.setEnumType(WC,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var zC;(function(t){t[t.IC_DEFAULT=0]="IC_DEFAULT",t[t.IC_JPEG=1]="IC_JPEG"})(zC||(zC={}));N.util.setEnumType(zC,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var Xn;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA"})(Xn||(Xn={}));N.util.setEnumType(Xn,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var tn;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(tn||(tn={}));N.util.setEnumType(tn,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var yn;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF"})(yn||(yn={}));N.util.setEnumType(yn,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var rs;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.LOST=3]="LOST"})(rs||(rs={}));N.util.setEnumType(rs,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var Yi;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED"})(Yi||(Yi={}));N.util.setEnumType(Yi,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var Rs;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE"})(Rs||(Rs={}));N.util.setEnumType(Rs,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var Yo;(function(t){t[t.RR_UNKNOWN=0]="RR_UNKNOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(Yo||(Yo={}));N.util.setEnumType(Yo,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var rf;(function(t){t[t.SE_UNKNOWN=0]="SE_UNKNOWN",t[t.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",t[t.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(rf||(rf={}));N.util.setEnumType(rf,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let pu=class od extends Se{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=je.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new od().fromBinary(e,n)}static fromJson(e,n){return new od().fromJson(e,n)}static fromJsonString(e,n){return new od().fromJsonString(e,n)}static equals(e,n){return N.util.equals(od,e,n)}};pu.runtime=N;pu.typeName="livekit.Room";pu.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Ui,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class Ui extends Se{constructor(e){super(),this.mime="",this.fmtpLine="",N.util.initPartial(e,this)}static fromBinary(e,n){return new Ui().fromBinary(e,n)}static fromJson(e,n){return new Ui().fromJson(e,n)}static fromJsonString(e,n){return new Ui().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Ui,e,n)}}Ui.runtime=N;Ui.typeName="livekit.Codec";Ui.fields=N.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class ga extends Se{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new ga().fromBinary(e,n)}static fromJson(e,n){return new ga().fromJson(e,n)}static fromJsonString(e,n){return new ga().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ga,e,n)}}ga.runtime=N;ga.typeName="livekit.PlayoutDelay";ga.fields=N.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class is extends Se{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new is().fromBinary(e,n)}static fromJson(e,n){return new is().fromJson(e,n)}static fromJsonString(e,n){return new is().fromJsonString(e,n)}static equals(e,n){return N.util.equals(is,e,n)}}is.runtime=N;is.typeName="livekit.ParticipantPermission";is.fields=N.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:N.getEnumType(tn),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class Jr extends Se{constructor(e){super(),this.sid="",this.identity="",this.state=Tl.JOINING,this.tracks=[],this.metadata="",this.joinedAt=je.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new Jr().fromBinary(e,n)}static fromJson(e,n){return new Jr().fromJson(e,n)}static fromJsonString(e,n){return new Jr().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Jr,e,n)}}Jr.runtime=N;Jr.typeName="livekit.ParticipantInfo";Jr.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:N.getEnumType(Tl)},{no:4,name:"tracks",kind:"message",T:kr,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:is},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var Tl;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED"})(Tl||(Tl={}));N.util.setEnumType(Tl,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class ma extends Se{constructor(e){super(),N.util.initPartial(e,this)}static fromBinary(e,n){return new ma().fromBinary(e,n)}static fromJson(e,n){return new ma().fromJson(e,n)}static fromJsonString(e,n){return new ma().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ma,e,n)}}ma.runtime=N;ma.typeName="livekit.Encryption";ma.fields=N.util.newFieldList(()=>[]);var Pn;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM"})(Pn||(Pn={}));N.util.setEnumType(Pn,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class os extends Se{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new os().fromBinary(e,n)}static fromJson(e,n){return new os().fromJson(e,n)}static fromJsonString(e,n){return new os().fromJsonString(e,n)}static equals(e,n){return N.util.equals(os,e,n)}}os.runtime=N;os.typeName="livekit.SimulcastCodecInfo";os.fields=N.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:lr,repeated:!0}]);class kr extends Se{constructor(e){super(),this.sid="",this.type=Xn.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=tn.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=Pn.NONE,this.stream="",N.util.initPartial(e,this)}static fromBinary(e,n){return new kr().fromBinary(e,n)}static fromJson(e,n){return new kr().fromJson(e,n)}static fromJsonString(e,n){return new kr().fromJsonString(e,n)}static equals(e,n){return N.util.equals(kr,e,n)}}kr.runtime=N;kr.typeName="livekit.TrackInfo";kr.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:N.getEnumType(Xn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:N.getEnumType(tn)},{no:10,name:"layers",kind:"message",T:lr,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:os,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:N.getEnumType(Pn)},{no:17,name:"stream",kind:"scalar",T:9}]);class lr extends Se{constructor(e){super(),this.quality=yn.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new lr().fromBinary(e,n)}static fromJson(e,n){return new lr().fromJson(e,n)}static fromJsonString(e,n){return new lr().fromJsonString(e,n)}static equals(e,n){return N.util.equals(lr,e,n)}}lr.runtime=N;lr.typeName="livekit.VideoLayer";lr.fields=N.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:N.getEnumType(yn)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class mo extends Se{constructor(e){super(),this.kind=gn.RELIABLE,this.value={case:void 0},N.util.initPartial(e,this)}static fromBinary(e,n){return new mo().fromBinary(e,n)}static fromJson(e,n){return new mo().fromJson(e,n)}static fromJsonString(e,n){return new mo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(mo,e,n)}}mo.runtime=N;mo.typeName="livekit.DataPacket";mo.fields=N.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:N.getEnumType(gn)},{no:2,name:"user",kind:"message",T:Co,oneof:"value"},{no:3,name:"speaker",kind:"message",T:ss,oneof:"value"}]);var gn;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY"})(gn||(gn={}));N.util.setEnumType(gn,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class ss extends Se{constructor(e){super(),this.speakers=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new ss().fromBinary(e,n)}static fromJson(e,n){return new ss().fromJson(e,n)}static fromJsonString(e,n){return new ss().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ss,e,n)}}ss.runtime=N;ss.typeName="livekit.ActiveSpeakerUpdate";ss.fields=N.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:vo,repeated:!0}]);class vo extends Se{constructor(e){super(),this.sid="",this.level=0,this.active=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new vo().fromBinary(e,n)}static fromJson(e,n){return new vo().fromJson(e,n)}static fromJsonString(e,n){return new vo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(vo,e,n)}}vo.runtime=N;vo.typeName="livekit.SpeakerInfo";vo.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class Co extends Se{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new Co().fromBinary(e,n)}static fromJson(e,n){return new Co().fromJson(e,n)}static fromJsonString(e,n){return new Co().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Co,e,n)}}Co.runtime=N;Co.typeName="livekit.UserPacket";Co.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class yo extends Se{constructor(e){super(),this.participantSid="",this.trackSids=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new yo().fromBinary(e,n)}static fromJson(e,n){return new yo().fromJson(e,n)}static fromJsonString(e,n){return new yo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(yo,e,n)}}yo.runtime=N;yo.typeName="livekit.ParticipantTracks";yo.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class as extends Se{constructor(e){super(),this.edition=Xc.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",N.util.initPartial(e,this)}static fromBinary(e,n){return new as().fromBinary(e,n)}static fromJson(e,n){return new as().fromJson(e,n)}static fromJsonString(e,n){return new as().fromJsonString(e,n)}static equals(e,n){return N.util.equals(as,e,n)}}as.runtime=N;as.typeName="livekit.ServerInfo";as.fields=N.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:N.getEnumType(Xc)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var Xc;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud"})(Xc||(Xc={}));N.util.setEnumType(Xc,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class ls extends Se{constructor(e){super(),this.sdk=Kc.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",N.util.initPartial(e,this)}static fromBinary(e,n){return new ls().fromBinary(e,n)}static fromJson(e,n){return new ls().fromJson(e,n)}static fromJsonString(e,n){return new ls().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ls,e,n)}}ls.runtime=N;ls.typeName="livekit.ClientInfo";ls.fields=N.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:N.getEnumType(Kc)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var Kc;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.PYTHON=9]="PYTHON",t[t.CPP=10]="CPP"})(Kc||(Kc={}));N.util.setEnumType(Kc,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class xo extends Se{constructor(e){super(),this.resumeConnection=Yi.UNSET,this.forceRelay=Yi.UNSET,N.util.initPartial(e,this)}static fromBinary(e,n){return new xo().fromBinary(e,n)}static fromJson(e,n){return new xo().fromJson(e,n)}static fromJsonString(e,n){return new xo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(xo,e,n)}}xo.runtime=N;xo.typeName="livekit.ClientConfiguration";xo.fields=N.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:Io},{no:2,name:"screen",kind:"message",T:Io},{no:3,name:"resume_connection",kind:"enum",T:N.getEnumType(Yi)},{no:4,name:"disabled_codecs",kind:"message",T:cs},{no:5,name:"force_relay",kind:"enum",T:N.getEnumType(Yi)}]);class Io extends Se{constructor(e){super(),this.hardwareEncoder=Yi.UNSET,N.util.initPartial(e,this)}static fromBinary(e,n){return new Io().fromBinary(e,n)}static fromJson(e,n){return new Io().fromJson(e,n)}static fromJsonString(e,n){return new Io().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Io,e,n)}}Io.runtime=N;Io.typeName="livekit.VideoConfiguration";Io.fields=N.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:N.getEnumType(Yi)}]);class cs extends Se{constructor(e){super(),this.codecs=[],this.publish=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new cs().fromBinary(e,n)}static fromJson(e,n){return new cs().fromJson(e,n)}static fromJsonString(e,n){return new cs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(cs,e,n)}}cs.runtime=N;cs.typeName="livekit.DisabledCodecs";cs.fields=N.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:Ui,repeated:!0},{no:2,name:"publish",kind:"message",T:Ui,repeated:!0}]);class bo extends Se{constructor(e){super(),this.duration=0,this.startTimestamp=je.zero,this.endTimestamp=je.zero,this.rtpClockTicks=je.zero,this.driftSamples=je.zero,this.driftMs=0,this.clockRate=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new bo().fromBinary(e,n)}static fromJson(e,n){return new bo().fromJson(e,n)}static fromJsonString(e,n){return new bo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(bo,e,n)}}bo.runtime=N;bo.typeName="livekit.RTPDrift";bo.fields=N.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:kn},{no:2,name:"end_time",kind:"message",T:kn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class va extends Se{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=je.zero,this.headerBytes=je.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=je.zero,this.headerBytesDuplicate=je.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=je.zero,this.headerBytesPadding=je.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new va().fromBinary(e,n)}static fromJson(e,n){return new va().fromJson(e,n)}static fromJsonString(e,n){return new va().fromJsonString(e,n)}static equals(e,n){return N.util.equals(va,e,n)}}va.runtime=N;va.typeName="livekit.RTPStats";va.fields=N.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:kn},{no:2,name:"end_time",kind:"message",T:kn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:kn},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:kn},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:kn},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:kn},{no:44,name:"packet_drift",kind:"message",T:bo},{no:45,name:"report_drift",kind:"message",T:bo}]);class Ca extends Se{constructor(e){super(),this.unixMicro=je.zero,this.ticks=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new Ca().fromBinary(e,n)}static fromJson(e,n){return new Ca().fromJson(e,n)}static fromJsonString(e,n){return new Ca().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Ca,e,n)}}Ca.runtime=N;Ca.typeName="livekit.TimedVersion";Ca.fields=N.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const zu=7e3,MW=[0,300,2*2*300,3*3*300,4*4*300,zu,zu,zu,zu,zu];class LW{constructor(e){this._retryDelays=e!==void 0?[...e]:MW}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function $(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,[])).next())})}function Qw(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ec(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Qw=="function"?Qw(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){s=t[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var mx={exports:{}},kc=typeof Reflect=="object"?Reflect:null,eS=kc&&typeof kc.apply=="function"?kc.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Zh;kc&&typeof kc.ownKeys=="function"?Zh=kc.ownKeys:Object.getOwnPropertySymbols?Zh=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Zh=function(e){return Object.getOwnPropertyNames(e)};function UW(t){console&&console.warn&&console.warn(t)}var Q_=Number.isNaN||function(e){return e!==e};function bt(){bt.init.call(this)}mx.exports=bt;mx.exports.once=zW;bt.EventEmitter=bt;bt.prototype._events=void 0;bt.prototype._eventsCount=0;bt.prototype._maxListeners=void 0;var tS=10;function zp(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(bt,"defaultMaxListeners",{enumerable:!0,get:function(){return tS},set:function(t){if(typeof t!="number"||t<0||Q_(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");tS=t}});bt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};bt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Q_(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function eD(t){return t._maxListeners===void 0?bt.defaultMaxListeners:t._maxListeners}bt.prototype.getMaxListeners=function(){return eD(this)};bt.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(n.length>0&&(s=n[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")eS(l,this,n);else for(var c=l.length,u=oD(l,c),r=0;r<c;++r)eS(u[r],this,n);return!0};function tD(t,e,n,r){var i,o,s;if(zp(n),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),s===void 0)s=o[e]=n,++t._eventsCount;else if(typeof s=="function"?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=eD(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,UW(a)}return t}bt.prototype.addListener=function(e,n){return tD(this,e,n,!1)};bt.prototype.on=bt.prototype.addListener;bt.prototype.prependListener=function(e,n){return tD(this,e,n,!0)};function VW(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function nD(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=VW.bind(r);return i.listener=n,r.wrapFn=i,i}bt.prototype.once=function(e,n){return zp(n),this.on(e,nD(this,e,n)),this};bt.prototype.prependOnceListener=function(e,n){return zp(n),this.prependListener(e,nD(this,e,n)),this};bt.prototype.removeListener=function(e,n){var r,i,o,s,a;if(zp(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===n||r[s].listener===n){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():GW(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};bt.prototype.off=bt.prototype.removeListener;bt.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function rD(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?WW(i):oD(i,i.length)}bt.prototype.listeners=function(e){return rD(this,e,!0)};bt.prototype.rawListeners=function(e){return rD(this,e,!1)};bt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):iD.call(t,e)};bt.prototype.listenerCount=iD;function iD(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}bt.prototype.eventNames=function(){return this._eventsCount>0?Zh(this._events):[]};function oD(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function GW(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function WW(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function zW(t,e){return new Promise(function(n,r){function i(s){t.removeListener(e,o),r(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}sD(t,e,o,{once:!0}),e!=="error"&&jW(t,i,{once:!0})})}function jW(t,e,n){typeof t.on=="function"&&sD(t,"error",e,n)}function sD(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){r.once&&t.removeEventListener(e,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var jo=mx.exports;let aD=!0,lD=!0;function $h(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function Gl(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(s,a){if(s!==e)return i.apply(this,arguments);const l=c=>{const u=n(c);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,l),i.apply(this,[s,l])};const o=r.removeEventListener;r.removeEventListener=function(s,a){if(s!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(a))return o.apply(this,arguments);const l=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[s,l])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(s){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),s&&this.addEventListener(e,this["_on"+e]=s)},enumerable:!0,configurable:!0})}function HW(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(aD=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function ZW(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(lD=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function cD(){if(typeof window=="object"){if(aD)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function vx(t,e){lD&&console.warn(t+" is deprecated, please use "+e+" instead.")}function $W(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=$h(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=$h(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=$h(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function nS(t){return Object.prototype.toString.call(t)==="[object Object]"}function uD(t){return nS(t)?Object.keys(t).reduce(function(e,n){const r=nS(t[n]),i=r?uD(t[n]):t[n],o=r&&!Object.keys(i).length;return i===void 0||o?e:Object.assign(e,{[n]:i})},{}):t}function jC(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?jC(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{jC(t,t.get(i),n)})}))}function rS(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const o=[];return t.forEach(s=>{s.type==="track"&&s.trackIdentifier===e.id&&o.push(s)}),o.forEach(s=>{t.forEach(a=>{a.type===r&&a.trackId===s.id&&jC(t,a,i)})}),i}const iS=cD;function dD(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const l={};return Object.keys(a).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;const u=typeof a[c]=="object"?a[c]:{ideal:a[c]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(f,h){return f?f+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(u.ideal!==void 0){l.optional=l.optional||[];let f={};typeof u.ideal=="number"?(f[d("min",c)]=u.ideal,l.optional.push(f),f={},f[d("max",c)]=u.ideal,l.optional.push(f)):(f[d("",c)]=u.ideal,l.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[d("",c)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[d(f,c)]=u[f])})}),a.advanced&&(l.optional=(l.optional||[]).concat(a.advanced)),l},i=function(a,l){if(e.version>=61)return l(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const c=function(u,d,f){d in u&&!(f in u)&&(u[f]=u[d],delete u[d])};a=JSON.parse(JSON.stringify(a)),c(a.audio,"autoGainControl","googAutoGainControl"),c(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let c=a.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});const u=e.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let d;if(c.exact==="environment"||c.ideal==="environment"?d=["back","rear"]:(c.exact==="user"||c.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(p=>p.kind==="videoinput");let h=f.find(p=>d.some(m=>p.label.toLowerCase().includes(m)));return!h&&f.length&&d.includes("back")&&(h=f[f.length-1]),h&&(a.video.deviceId=c.exact?{exact:h.deviceId}:{ideal:h.deviceId}),a.video=r(a.video),iS("chrome: "+JSON.stringify(a)),l(a)})}a.video=r(a.video)}return iS("chrome: "+JSON.stringify(a)),l(a)},o=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},s=function(a,l,c){i(a,u=>{n.webkitGetUserMedia(u,l,d=>{c&&c(o(d))})})};if(n.getUserMedia=s.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(l){return i(l,c=>a(c).then(u=>{if(c.audio&&!u.getAudioTracks().length||c.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(o(u))))}}}function XW(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const o=r.video&&r.video.width,s=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},o&&(r.video.mandatory.maxWidth=o),s&&(r.video.mandatory.maxHeight=s),t.navigator.mediaDevices.getUserMedia(r)})}}}function fD(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function hD(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):o={track:i.track};const s=new Event("track");s.track=i.track,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)}),r.stream.getTracks().forEach(i=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(a=>a.track&&a.track.id===i.id):o={track:i};const s=new Event("track");s.track=i,s.receiver=o,s.transceiver={receiver:o},s.streams=[r.stream],this.dispatchEvent(s)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Gl(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function pD(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,l){let c=i.apply(this,arguments);return c||(c=e(this,a),this._senders.push(c)),c};const o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){o.apply(this,arguments);const l=this._senders.indexOf(a);l!==-1&&this._senders.splice(l,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(s=>{this._senders.push(e(this,s))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(s=>{const a=this._senders.find(l=>l.track===s);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function gD(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[r,i,o]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const s=function(l){const c={};return l.result().forEach(d=>{const f={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach(h=>{f[h]=d.stat(h)}),c[f.id]=f}),c},a=function(l){return new Map(Object.keys(l).map(c=>[c,l[c]]))};if(arguments.length>=2){const l=function(c){i(a(s(c)))};return e.apply(this,[l,r])}return new Promise((l,c)=>{e.apply(this,[function(u){l(a(s(u)))},c])}).then(i,o)}}function mD(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const o=n.apply(this,[]);return o.forEach(s=>s._pc=this),o});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),t.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(s=>rS(s,o.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(o=>o._pc=this),i}),Gl(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>rS(o,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,o,s;return this.getSenders().forEach(a=>{a.track===r&&(i?s=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(o?s=!0:o=a),a.track===r)),s||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function vD(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(s=>this._shimmedLocalStreams[s][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(s,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(l)===-1&&this._shimmedLocalStreams[a.id].push(l):this._shimmedLocalStreams[a.id]=[a,l],l};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._shimmedLocalStreams=this._shimmedLocalStreams||{},s.getTracks().forEach(c=>{if(this.getSenders().find(d=>d.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const l=this.getSenders().filter(c=>a.indexOf(c)===-1);this._shimmedLocalStreams[s.id]=[s].concat(l)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[s.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},s&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const l=this._shimmedLocalStreams[a].indexOf(s);l!==-1&&this._shimmedLocalStreams[a].splice(l,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function CD(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return vD(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(d=>this._reverseStreams[d.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(d=>{if(this.getSenders().find(h=>h.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const d=new t.MediaStream(u.getTracks());this._streams[u.id]=d,this._reverseStreams[d.id]=u,u=d}r.apply(this,[u])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(m=>m===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(m=>m.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[d.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const m=new t.MediaStream([u]);this._streams[d.id]=m,this._reverseStreams[m.id]=d,this.addStream(m)}return this.getSenders().find(m=>m.track===u)};function o(c,u){let d=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(f=>{const h=c._reverseStreams[f],p=c._streams[h.id];d=d.replace(new RegExp(p.id,"g"),h.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function s(c,u){let d=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(f=>{const h=c._reverseStreams[f],p=c._streams[h.id];d=d.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(c){const u=t.RTCPeerConnection.prototype[c],d={[c](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const m=o(this,p);f[0].apply(null,[m])},p=>{f[1]&&f[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>o(this,p))}};t.RTCPeerConnection.prototype[c]=d[c]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=s(this,arguments[0]),a.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const c=l.get.apply(this);return c.type===""?c:o(this,c)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(m=>u.track===m)&&(f=this._streams[h])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function HC(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function yD(t,e){Gl(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var oS=Object.freeze({__proto__:null,fixNegotiationNeeded:yD,shimAddTrackRemoveTrack:CD,shimAddTrackRemoveTrackWithNative:vD,shimGetDisplayMedia:XW,shimGetSendersWithDtmf:pD,shimGetStats:gD,shimGetUserMedia:dD,shimMediaStream:fD,shimOnTrack:hD,shimPeerConnection:HC,shimSenderReceiverGetStats:mD});function xD(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,o,s){vx("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(o,s)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(s,a,l){a in s&&!(l in s)&&(s[l]=s[a],delete s[a])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(s){return typeof s=="object"&&typeof s.audio=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s.audio,"autoGainControl","mozAutoGainControl"),i(s.audio,"noiseSuppression","mozNoiseSuppression")),o(s)},r&&r.prototype.getSettings){const s=r.prototype.getSettings;r.prototype.getSettings=function(){const a=s.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[a])}}}}function KW(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function ID(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ZC(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=t.RTCPeerConnection.prototype[i],s={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=s[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[o,s,a]=arguments;return r.apply(this,[o||null]).then(l=>{if(e.version<53&&!s)try{l.forEach(c=>{c.type=n[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;l.forEach((u,d)=>{l.set(d,Object.assign({},u,{type:n[u.type]||u.type}))})}return l}).then(s,a)}}function bD(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function AD(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Gl(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function wD(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){vx("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function SD(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function kD(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(s=>{if("rid"in s&&!/^[a-z0-9]{0,16}$/i.test(s.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in s&&!(parseFloat(s.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in s&&!(parseFloat(s.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(i){const{sender:s}=o,a=s.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,s.sendEncodings=r,this.setParametersPromises.push(s.setParameters(a).then(()=>{delete s.sendEncodings}).catch(()=>{delete s.sendEncodings})))}return o})}function ED(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function TD(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function RD(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var sS=Object.freeze({__proto__:null,shimAddTransceiver:kD,shimCreateAnswer:RD,shimCreateOffer:TD,shimGetDisplayMedia:KW,shimGetParameters:ED,shimGetUserMedia:xD,shimOnTrack:ID,shimPeerConnection:ZC,shimRTCDataChannel:SD,shimReceiverGetStats:AD,shimRemoveStream:wD,shimSenderGetStats:bD});function _D(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return o&&o.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function DD(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const s=new Event("addstream");s.stream=o,r.dispatchEvent(s)})}),e.apply(r,arguments)}}}function PD(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,o=e.setRemoteDescription,s=e.addIceCandidate;e.createOffer=function(c,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[d]);return u?(f.then(c,u),Promise.resolve()):f},e.createAnswer=function(c,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[d]);return u?(f.then(c,u),Promise.resolve()):f};let a=function(l,c,u){const d=i.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d};e.setLocalDescription=a,a=function(l,c,u){const d=o.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d},e.setRemoteDescription=a,a=function(l,c,u){const d=s.apply(this,[l]);return u?(d.then(c,u),Promise.resolve()):d},e.addIceCandidate=a}function ND(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(BD(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,o){e.mediaDevices.getUserMedia(r).then(i,o)}).bind(e))}function BD(t){return t&&t.video!==void 0?Object.assign({},t,{video:uD(t.video)}):t}function FD(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const o=[];for(let s=0;s<r.iceServers.length;s++){let a=r.iceServers[s];a.urls===void 0&&a.url?(vx("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,o.push(a)):o.push(r.iceServers[s])}r.iceServers=o}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function OD(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function MD(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(s=>s.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(s=>s.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function LD(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var aS=Object.freeze({__proto__:null,shimAudioContext:LD,shimCallbacksAPI:PD,shimConstraints:BD,shimCreateOfferLegacy:MD,shimGetUserMedia:ND,shimLocalStreamsAPI:_D,shimRTCIceServerUrls:FD,shimRemoteStreamsAPI:DD,shimTrackEventTransceiver:OD}),UD={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":i.relatedAddress=r[o+1];break;case"rport":i.relatedPort=parseInt(r[o+1],10);break;case"tcptype":i.tcpType=r[o+1];break;case"ufrag":i.ufrag=r[o+1],i.usernameFragment=r[o+1];break;default:i[r[o]]===void 0&&(i[r[o]]=r[o+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const o=n.type;return r.push("typ"),r.push(o),o!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const o=n.substring(n.indexOf(" ")+1).split(";");for(let s=0;s<o.length;s++)i=o[s].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const o=[];Object.keys(n.parameters).forEach(s=>{n.parameters[s]!==void 0?o.push(s+"="+n.parameters[s]):o.push(s)}),r+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},o=n.indexOf(":",r);return o>-1?(i.attribute=n.substring(r+1,o),i.value=n.substring(o+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],o=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(n)[0].split(" ");r.profile=o[2];for(let a=3;a<o.length;a++){const l=o[a],c=e.matchPrefix(n,"a=rtpmap:"+l+" ")[0];if(c){const u=e.parseRtpMap(c),d=e.matchPrefix(n,"a=fmtp:"+l+" ");switch(u.parameters=d.length?e.parseFmtp(d[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const s=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{s.forEach(l=>{a.rtcpFeedback.find(u=>u.type===l.type&&u.parameter===l.parameter)||a.rtcpFeedback.push(l)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(s=>s.preferredPayloadType!==void 0?s.preferredPayloadType:s.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(s=>{i+=e.writeRtpMap(s),i+=e.writeFmtp(s),i+=e.writeRtcpFb(s)});let o=0;return r.codecs.forEach(s=>{s.maxptime>o&&(o=s.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(s=>{i+=e.writeExtmap(s)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),o=i.fecMechanisms.indexOf("RED")!==-1,s=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(n,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),l=a.length>0&&a[0].ssrc;let c;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===l&&(c=u[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let h={ssrc:l,codecPayloadType:parseInt(f.parameters.apt,10)};l&&c&&(h.rtx={ssrc:c}),r.push(h),o&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:l,mechanism:s?"red+ulpfec":"red"},r.push(h))}}),r.length===0&&l&&r.push({ssrc:l});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(f=>{f.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const o=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const s=e.matchPrefix(n,"a=rtcp-mux");return r.mux=s.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=e.matchPrefix(n,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const s=e.matchPrefix(n,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const a=e.matchPrefix(n,"a=sctpmap:");if(a.length>0){const l=a[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:o}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let o;const s=r!==void 0?r:2;return n?o=n:o=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+s+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const i=e.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(n){const i=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e})(UD);var VD=UD.exports,Ec=YG(VD),JW=KG({__proto__:null,default:Ec},[VD]);function Xh(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),o=Ec.parseCandidate(r.candidate);for(const s in o)s in i||Object.defineProperty(i,s,{value:o[s]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,Gl(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function $C(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Gl(t,"icecandidate",e=>{if(e.candidate){const n=Ec.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Kh(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const l=Ec.splitSections(a.sdp);return l.shift(),l.some(c=>{const u=Ec.parseMLine(c);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(a){const l=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const c=parseInt(l[1],10);return c!==c?-1:c},i=function(a){let l=65536;return e.browser==="firefox"&&(e.version<57?a===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},o=function(a,l){let c=65536;e.browser==="firefox"&&e.version===57&&(c=65535);const u=Ec.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?c=parseInt(u[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(c=2147483637),c},s=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const l=r(arguments[0]),c=i(l),u=o(arguments[0],l);let d;c===0&&u===0?d=Number.POSITIVE_INFINITY:c===0||u===0?d=Math.max(c,u):d=Math.min(c,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return s.apply(this,arguments)}}function Jh(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const o=r.send;r.send=function(){const a=arguments[0],l=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&l>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},Gl(t,"datachannel",r=>(e(r.channel,r.target),r))}function XC(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const s=new Event("connectionstatechange",i);o.dispatchEvent(s)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function KC(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(s=>s.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return n.apply(this,arguments)}}function Yh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function qh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(s=>n.apply(this,[s]))})}var YW=Object.freeze({__proto__:null,removeExtmapAllowMixed:KC,shimAddIceCandidateNullOrEmpty:Yh,shimConnectionState:XC,shimMaxMessageSize:Kh,shimParameterlessSetLocalDescription:qh,shimRTCIceCandidate:Xh,shimRTCIceCandidateRelayProtocol:$C,shimSendThrowTypeError:Jh});function qW(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=cD,r=$W(t),i={browserDetails:r,commonShim:YW,extractVersion:$h,disableLog:HW,disableWarnings:ZW,sdp:JW};switch(r.browser){case"chrome":if(!oS||!HC||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=oS,Yh(t,r),qh(t),dD(t,r),fD(t),HC(t,r),hD(t),CD(t,r),pD(t),gD(t),mD(t),yD(t,r),Xh(t),$C(t),XC(t),Kh(t,r),Jh(t),KC(t,r);break;case"firefox":if(!sS||!ZC||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=sS,Yh(t,r),qh(t),xD(t,r),ZC(t,r),ID(t),wD(t),bD(t),AD(t),SD(t),kD(t),ED(t),TD(t),RD(t),Xh(t),XC(t),Kh(t,r),Jh(t);break;case"safari":if(!aS||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=aS,Yh(t,r),qh(t),FD(t),MD(t),PD(t),_D(t),DD(t),OD(t),ND(t),LD(t),Xh(t),$C(t),Kh(t,r),Jh(t),KC(t,r);break;default:n("Unsupported browser!");break}return i}qW({window:typeof window>"u"?void 0:window});const QW=10,ch="lk_e2ee",ez="LKFrameEncryptionKey",tz={sharedKey:!1,ratchetSalt:ez,ratchetWindowSize:8,failureTolerance:QW};var Ra;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(Ra||(Ra={}));var lS;(function(t){t.KeyRatcheted="keyRatcheted"})(lS||(lS={}));var ya;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(ya||(ya={}));var cS;(function(t){t.Error="cryptorError"})(cS||(cS={}));function nz(){return rz()||JC()}function JC(){return typeof window.RTCRtpScriptTransform<"u"}function rz(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class FJ extends jo.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{et.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},tz),e),this.on(Ra.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(Ra.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(Ra.RatchetRequest,e,n)}}class gu extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}class Rt extends gu{constructor(e,n,r){super(1,e),this.status=r,this.reason=n}}class Cx extends gu{constructor(e){super(21,e??"device is unsupported")}}class fo extends gu{constructor(e){super(20,e??"track is invalid")}}class iz extends gu{constructor(e){super(10,e??"unsupported server")}}class pn extends gu{constructor(e){super(12,e??"unexpected connection state")}}class YC extends gu{constructor(e){super(13,e??"unable to negotiate")}}var of;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(of||(of={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(of||(of={}));var ue;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.StateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged"})(ue||(ue={}));var de;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded"})(de||(de={}));var Te;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished"})(Te||(Te={}));var xe;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed"})(xe||(xe={}));function yx(t,e,n){var r,i,o;e===void 0&&(e=50),n===void 0&&(n={});var s=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,l=n.maxWait,c=Date.now(),u=[];function d(){if(l!==void 0){var h=Date.now()-c;if(h+e>=l)return l-h}return e}var f=function(){var h=[].slice.call(arguments),p=this;return new Promise(function(m,C){var v=s&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,c=Date.now(),!s){var y=t.apply(p,h);a&&a(y),u.forEach(function(I){return(0,I.resolve)(y)}),u=[]}},d()),v){var g=t.apply(p,h);return a&&a(g),m(g)}u.push({resolve:m,reject:C})})};return f.cancel=function(h){o!==void 0&&clearTimeout(o),u.forEach(function(p){return(0,p.reject)(h)}),u=[]},f}const oz=/version\/(\d+(\.?_?\d+)+)/i;let Om;function Ls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(Om===void 0||e){const r=sz.find(i=>{let{test:o}=i;return o.test(n)});Om=r==null?void 0:r.describe(n)}return Om}const sz=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Mm(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Mm(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Mm(oz,t),os:t.includes("mobile/")?"iOS":"macOS"}}}];function Mm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}var az="1.15.13";const lz=az,cz=11;class Bn{}Bn.setTimeout=function(){return setTimeout(...arguments)};Bn.setInterval=function(){return setInterval(...arguments)};Bn.clearTimeout=function(){return clearTimeout(...arguments)};Bn.clearInterval=function(){return clearInterval(...arguments)};class It{constructor(e,n,r,i,o){this.width=e,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i,priority:o}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const uz=["vp8","h264"],GD=["vp8","h264","vp9","av1"];function dz(t){return!!uz.find(e=>e===t)}var Y0;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:2e4},t.music={maxBitrate:32e3},t.musicStereo={maxBitrate:48e3},t.musicHighQuality={maxBitrate:64e3},t.musicHighQualityStereo={maxBitrate:96e3}})(Y0||(Y0={}));const sf={h90:new It(160,90,9e4,20),h180:new It(320,180,16e4,20),h216:new It(384,216,18e4,20),h360:new It(640,360,45e4,20),h540:new It(960,540,8e5,25),h720:new It(1280,720,17e5,30),h1080:new It(1920,1080,3e6,30),h1440:new It(2560,1440,5e6,30),h2160:new It(3840,2160,8e6,30)},qC={h120:new It(160,120,7e4,20),h180:new It(240,180,125e3,20),h240:new It(320,240,14e4,20),h360:new It(480,360,33e4,20),h480:new It(640,480,5e5,20),h540:new It(720,540,6e5,25),h720:new It(960,720,13e5,30),h1080:new It(1440,1080,23e5,30),h1440:new It(1920,1440,38e5,30)},xx={h360fps3:new It(640,360,2e5,3,"medium"),h360fps15:new It(640,360,4e5,15,"medium"),h720fps5:new It(1280,720,8e5,5,"medium"),h720fps15:new It(1280,720,15e5,15,"medium"),h720fps30:new It(1280,720,2e6,30,"medium"),h1080fps15:new It(1920,1080,25e5,15,"medium"),h1080fps30:new It(1920,1080,5e6,30,"medium"),original:new It(0,0,7e6,30,"medium")};var Kn;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER"})(Kn||(Kn={}));N.util.setEnumType(Kn,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var Rl;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.PAUSED=1]="PAUSED"})(Rl||(Rl={}));N.util.setEnumType(Rl,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var q0;(function(t){t[t.UDP=0]="UDP",t[t.TCP=1]="TCP",t[t.TLS=2]="TLS"})(q0||(q0={}));N.util.setEnumType(q0,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class us extends Se{constructor(e){super(),this.message={case:void 0},N.util.initPartial(e,this)}static fromBinary(e,n){return new us().fromBinary(e,n)}static fromJson(e,n){return new us().fromJson(e,n)}static fromJsonString(e,n){return new us().fromJsonString(e,n)}static equals(e,n){return N.util.equals(us,e,n)}}us.runtime=N;us.typeName="livekit.SignalRequest";us.fields=N.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:cr,oneof:"message"},{no:2,name:"answer",kind:"message",T:cr,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Wi,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Gi,oneof:"message"},{no:5,name:"mute",kind:"message",T:zi,oneof:"message"},{no:6,name:"subscription",kind:"message",T:hi,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:wo,oneof:"message"},{no:8,name:"leave",kind:"message",T:pi,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:So,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Ro,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:_o,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Dn,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:ko,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Po,oneof:"message"}]);class Ao extends Se{constructor(e){super(),this.message={case:void 0},N.util.initPartial(e,this)}static fromBinary(e,n){return new Ao().fromBinary(e,n)}static fromJson(e,n){return new Ao().fromJson(e,n)}static fromJsonString(e,n){return new Ao().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Ao,e,n)}}Ao.runtime=N;Ao.typeName="livekit.SignalResponse";Ao.fields=N.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:ds,oneof:"message"},{no:2,name:"answer",kind:"message",T:cr,oneof:"message"},{no:3,name:"offer",kind:"message",T:cr,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Wi,oneof:"message"},{no:5,name:"update",kind:"message",T:ps,oneof:"message"},{no:6,name:"track_published",kind:"message",T:ji,oneof:"message"},{no:8,name:"leave",kind:"message",T:pi,oneof:"message"},{no:9,name:"mute",kind:"message",T:zi,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:gs,oneof:"message"},{no:11,name:"room_update",kind:"message",T:ms,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:Cs,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:xs,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:bs,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:As,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:hs,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:fs,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:ws,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:ks,oneof:"message"}]);class Vi extends Se{constructor(e){super(),this.codec="",this.cid="",N.util.initPartial(e,this)}static fromBinary(e,n){return new Vi().fromBinary(e,n)}static fromJson(e,n){return new Vi().fromJson(e,n)}static fromJsonString(e,n){return new Vi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Vi,e,n)}}Vi.runtime=N;Vi.typeName="livekit.SimulcastCodec";Vi.fields=N.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class Gi extends Se{constructor(e){super(),this.cid="",this.name="",this.type=Xn.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=tn.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=Pn.NONE,this.stream="",N.util.initPartial(e,this)}static fromBinary(e,n){return new Gi().fromBinary(e,n)}static fromJson(e,n){return new Gi().fromJson(e,n)}static fromJsonString(e,n){return new Gi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Gi,e,n)}}Gi.runtime=N;Gi.typeName="livekit.AddTrackRequest";Gi.fields=N.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:N.getEnumType(Xn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:N.getEnumType(tn)},{no:9,name:"layers",kind:"message",T:lr,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Vi,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:N.getEnumType(Pn)},{no:15,name:"stream",kind:"scalar",T:9}]);class Wi extends Se{constructor(e){super(),this.candidateInit="",this.target=Kn.PUBLISHER,N.util.initPartial(e,this)}static fromBinary(e,n){return new Wi().fromBinary(e,n)}static fromJson(e,n){return new Wi().fromJson(e,n)}static fromJsonString(e,n){return new Wi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Wi,e,n)}}Wi.runtime=N;Wi.typeName="livekit.TrickleRequest";Wi.fields=N.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:N.getEnumType(Kn)}]);class zi extends Se{constructor(e){super(),this.sid="",this.muted=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new zi().fromBinary(e,n)}static fromJson(e,n){return new zi().fromJson(e,n)}static fromJsonString(e,n){return new zi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(zi,e,n)}}zi.runtime=N;zi.typeName="livekit.MuteTrackRequest";zi.fields=N.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class ds extends Se{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),N.util.initPartial(e,this)}static fromBinary(e,n){return new ds().fromBinary(e,n)}static fromJson(e,n){return new ds().fromJson(e,n)}static fromJsonString(e,n){return new ds().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ds,e,n)}}ds.runtime=N;ds.typeName="livekit.JoinResponse";ds.fields=N.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:pu},{no:2,name:"participant",kind:"message",T:Jr},{no:3,name:"other_participants",kind:"message",T:Jr,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Eo,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:xo},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:as},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class fs extends Se{constructor(e){super(),this.iceServers=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new fs().fromBinary(e,n)}static fromJson(e,n){return new fs().fromJson(e,n)}static fromJsonString(e,n){return new fs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(fs,e,n)}}fs.runtime=N;fs.typeName="livekit.ReconnectResponse";fs.fields=N.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:Eo,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:xo}]);class ji extends Se{constructor(e){super(),this.cid="",N.util.initPartial(e,this)}static fromBinary(e,n){return new ji().fromBinary(e,n)}static fromJson(e,n){return new ji().fromJson(e,n)}static fromJsonString(e,n){return new ji().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ji,e,n)}}ji.runtime=N;ji.typeName="livekit.TrackPublishedResponse";ji.fields=N.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:kr}]);class hs extends Se{constructor(e){super(),this.trackSid="",N.util.initPartial(e,this)}static fromBinary(e,n){return new hs().fromBinary(e,n)}static fromJson(e,n){return new hs().fromJson(e,n)}static fromJsonString(e,n){return new hs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(hs,e,n)}}hs.runtime=N;hs.typeName="livekit.TrackUnpublishedResponse";hs.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class cr extends Se{constructor(e){super(),this.type="",this.sdp="",N.util.initPartial(e,this)}static fromBinary(e,n){return new cr().fromBinary(e,n)}static fromJson(e,n){return new cr().fromJson(e,n)}static fromJsonString(e,n){return new cr().fromJsonString(e,n)}static equals(e,n){return N.util.equals(cr,e,n)}}cr.runtime=N;cr.typeName="livekit.SessionDescription";cr.fields=N.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class ps extends Se{constructor(e){super(),this.participants=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new ps().fromBinary(e,n)}static fromJson(e,n){return new ps().fromJson(e,n)}static fromJsonString(e,n){return new ps().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ps,e,n)}}ps.runtime=N;ps.typeName="livekit.ParticipantUpdate";ps.fields=N.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:Jr,repeated:!0}]);class hi extends Se{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new hi().fromBinary(e,n)}static fromJson(e,n){return new hi().fromJson(e,n)}static fromJsonString(e,n){return new hi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(hi,e,n)}}hi.runtime=N;hi.typeName="livekit.UpdateSubscription";hi.fields=N.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:yo,repeated:!0}]);class wo extends Se{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=yn.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new wo().fromBinary(e,n)}static fromJson(e,n){return new wo().fromJson(e,n)}static fromJsonString(e,n){return new wo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(wo,e,n)}}wo.runtime=N;wo.typeName="livekit.UpdateTrackSettings";wo.fields=N.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:N.getEnumType(yn)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class pi extends Se{constructor(e){super(),this.canReconnect=!1,this.reason=Rs.UNKNOWN_REASON,N.util.initPartial(e,this)}static fromBinary(e,n){return new pi().fromBinary(e,n)}static fromJson(e,n){return new pi().fromJson(e,n)}static fromJsonString(e,n){return new pi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(pi,e,n)}}pi.runtime=N;pi.typeName="livekit.LeaveRequest";pi.fields=N.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:N.getEnumType(Rs)}]);class So extends Se{constructor(e){super(),this.trackSid="",this.layers=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new So().fromBinary(e,n)}static fromJson(e,n){return new So().fromJson(e,n)}static fromJsonString(e,n){return new So().fromJsonString(e,n)}static equals(e,n){return N.util.equals(So,e,n)}}So.runtime=N;So.typeName="livekit.UpdateVideoLayers";So.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:lr,repeated:!0}]);class ko extends Se{constructor(e){super(),this.metadata="",this.name="",N.util.initPartial(e,this)}static fromBinary(e,n){return new ko().fromBinary(e,n)}static fromJson(e,n){return new ko().fromJson(e,n)}static fromJsonString(e,n){return new ko().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ko,e,n)}}ko.runtime=N;ko.typeName="livekit.UpdateParticipantMetadata";ko.fields=N.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class Eo extends Se{constructor(e){super(),this.urls=[],this.username="",this.credential="",N.util.initPartial(e,this)}static fromBinary(e,n){return new Eo().fromBinary(e,n)}static fromJson(e,n){return new Eo().fromJson(e,n)}static fromJsonString(e,n){return new Eo().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Eo,e,n)}}Eo.runtime=N;Eo.typeName="livekit.ICEServer";Eo.fields=N.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class gs extends Se{constructor(e){super(),this.speakers=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new gs().fromBinary(e,n)}static fromJson(e,n){return new gs().fromJson(e,n)}static fromJsonString(e,n){return new gs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(gs,e,n)}}gs.runtime=N;gs.typeName="livekit.SpeakersChanged";gs.fields=N.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:vo,repeated:!0}]);class ms extends Se{constructor(e){super(),N.util.initPartial(e,this)}static fromBinary(e,n){return new ms().fromBinary(e,n)}static fromJson(e,n){return new ms().fromJson(e,n)}static fromJsonString(e,n){return new ms().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ms,e,n)}}ms.runtime=N;ms.typeName="livekit.RoomUpdate";ms.fields=N.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:pu}]);class vs extends Se{constructor(e){super(),this.participantSid="",this.quality=rs.POOR,this.score=0,N.util.initPartial(e,this)}static fromBinary(e,n){return new vs().fromBinary(e,n)}static fromJson(e,n){return new vs().fromJson(e,n)}static fromJsonString(e,n){return new vs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(vs,e,n)}}vs.runtime=N;vs.typeName="livekit.ConnectionQualityInfo";vs.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:N.getEnumType(rs)},{no:3,name:"score",kind:"scalar",T:2}]);class Cs extends Se{constructor(e){super(),this.updates=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new Cs().fromBinary(e,n)}static fromJson(e,n){return new Cs().fromJson(e,n)}static fromJsonString(e,n){return new Cs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Cs,e,n)}}Cs.runtime=N;Cs.typeName="livekit.ConnectionQualityUpdate";Cs.fields=N.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:vs,repeated:!0}]);class ys extends Se{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=Rl.ACTIVE,N.util.initPartial(e,this)}static fromBinary(e,n){return new ys().fromBinary(e,n)}static fromJson(e,n){return new ys().fromJson(e,n)}static fromJsonString(e,n){return new ys().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ys,e,n)}}ys.runtime=N;ys.typeName="livekit.StreamStateInfo";ys.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:N.getEnumType(Rl)}]);class xs extends Se{constructor(e){super(),this.streamStates=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new xs().fromBinary(e,n)}static fromJson(e,n){return new xs().fromJson(e,n)}static fromJsonString(e,n){return new xs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(xs,e,n)}}xs.runtime=N;xs.typeName="livekit.StreamStateUpdate";xs.fields=N.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:ys,repeated:!0}]);class Hi extends Se{constructor(e){super(),this.quality=yn.LOW,this.enabled=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new Hi().fromBinary(e,n)}static fromJson(e,n){return new Hi().fromJson(e,n)}static fromJsonString(e,n){return new Hi().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Hi,e,n)}}Hi.runtime=N;Hi.typeName="livekit.SubscribedQuality";Hi.fields=N.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:N.getEnumType(yn)},{no:2,name:"enabled",kind:"scalar",T:8}]);class Is extends Se{constructor(e){super(),this.codec="",this.qualities=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new Is().fromBinary(e,n)}static fromJson(e,n){return new Is().fromJson(e,n)}static fromJsonString(e,n){return new Is().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Is,e,n)}}Is.runtime=N;Is.typeName="livekit.SubscribedCodec";Is.fields=N.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Hi,repeated:!0}]);class bs extends Se{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new bs().fromBinary(e,n)}static fromJson(e,n){return new bs().fromJson(e,n)}static fromJsonString(e,n){return new bs().fromJsonString(e,n)}static equals(e,n){return N.util.equals(bs,e,n)}}bs.runtime=N;bs.typeName="livekit.SubscribedQualityUpdate";bs.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Hi,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:Is,repeated:!0}]);class To extends Se{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",N.util.initPartial(e,this)}static fromBinary(e,n){return new To().fromBinary(e,n)}static fromJson(e,n){return new To().fromJson(e,n)}static fromJsonString(e,n){return new To().fromJsonString(e,n)}static equals(e,n){return N.util.equals(To,e,n)}}To.runtime=N;To.typeName="livekit.TrackPermission";To.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class Ro extends Se{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new Ro().fromBinary(e,n)}static fromJson(e,n){return new Ro().fromJson(e,n)}static fromJsonString(e,n){return new Ro().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Ro,e,n)}}Ro.runtime=N;Ro.typeName="livekit.SubscriptionPermission";Ro.fields=N.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:To,repeated:!0}]);class As extends Se{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,N.util.initPartial(e,this)}static fromBinary(e,n){return new As().fromBinary(e,n)}static fromJson(e,n){return new As().fromJson(e,n)}static fromJsonString(e,n){return new As().fromJsonString(e,n)}static equals(e,n){return N.util.equals(As,e,n)}}As.runtime=N;As.typeName="livekit.SubscriptionPermissionUpdate";As.fields=N.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class _o extends Se{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new _o().fromBinary(e,n)}static fromJson(e,n){return new _o().fromJson(e,n)}static fromJsonString(e,n){return new _o().fromJsonString(e,n)}static equals(e,n){return N.util.equals(_o,e,n)}}_o.runtime=N;_o.typeName="livekit.SyncState";_o.fields=N.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:cr},{no:2,name:"subscription",kind:"message",T:hi},{no:3,name:"publish_tracks",kind:"message",T:ji,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Do,repeated:!0},{no:5,name:"offer",kind:"message",T:cr}]);class Do extends Se{constructor(e){super(),this.label="",this.id=0,this.target=Kn.PUBLISHER,N.util.initPartial(e,this)}static fromBinary(e,n){return new Do().fromBinary(e,n)}static fromJson(e,n){return new Do().fromJson(e,n)}static fromJsonString(e,n){return new Do().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Do,e,n)}}Do.runtime=N;Do.typeName="livekit.DataChannelInfo";Do.fields=N.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:N.getEnumType(Kn)}]);class Dn extends Se{constructor(e){super(),this.scenario={case:void 0},N.util.initPartial(e,this)}static fromBinary(e,n){return new Dn().fromBinary(e,n)}static fromJson(e,n){return new Dn().fromJson(e,n)}static fromJsonString(e,n){return new Dn().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Dn,e,n)}}Dn.runtime=N;Dn.typeName="livekit.SimulateScenario";Dn.fields=N.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:N.getEnumType(q0),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]);class Po extends Se{constructor(e){super(),this.timestamp=je.zero,this.rtt=je.zero,N.util.initPartial(e,this)}static fromBinary(e,n){return new Po().fromBinary(e,n)}static fromJson(e,n){return new Po().fromJson(e,n)}static fromJsonString(e,n){return new Po().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Po,e,n)}}Po.runtime=N;Po.typeName="livekit.Ping";Po.fields=N.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class ws extends Se{constructor(e){super(),this.lastPingTimestamp=je.zero,this.timestamp=je.zero,N.util.initPartial(e,this)}static fromBinary(e,n){return new ws().fromBinary(e,n)}static fromJson(e,n){return new ws().fromJson(e,n)}static fromJsonString(e,n){return new ws().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ws,e,n)}}ws.runtime=N;ws.typeName="livekit.Pong";ws.fields=N.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class xa extends Se{constructor(e){super(),this.regions=[],N.util.initPartial(e,this)}static fromBinary(e,n){return new xa().fromBinary(e,n)}static fromJson(e,n){return new xa().fromJson(e,n)}static fromJsonString(e,n){return new xa().fromJsonString(e,n)}static equals(e,n){return N.util.equals(xa,e,n)}}xa.runtime=N;xa.typeName="livekit.RegionSettings";xa.fields=N.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:Ss,repeated:!0}]);class Ss extends Se{constructor(e){super(),this.region="",this.url="",this.distance=je.zero,N.util.initPartial(e,this)}static fromBinary(e,n){return new Ss().fromBinary(e,n)}static fromJson(e,n){return new Ss().fromJson(e,n)}static fromJsonString(e,n){return new Ss().fromJsonString(e,n)}static equals(e,n){return N.util.equals(Ss,e,n)}}Ss.runtime=N;Ss.typeName="livekit.RegionInfo";Ss.fields=N.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class ks extends Se{constructor(e){super(),this.trackSid="",this.err=rf.SE_UNKNOWN,N.util.initPartial(e,this)}static fromBinary(e,n){return new ks().fromBinary(e,n)}static fromJson(e,n){return new ks().fromJson(e,n)}static fromJsonString(e,n){return new ks().fromJsonString(e,n)}static equals(e,n){return N.util.equals(ks,e,n)}}ks.runtime=N;ks.typeName="livekit.SubscriptionResponse";ks.fields=N.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:N.getEnumType(rf)}]);function fz(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const hz=5e3,ju=[];class re extends jo.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=re.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=et,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),hz):this.handleAppVisibilityChanged()},this.log=Ms((i=r.loggerName)!==null&&i!==void 0?i:Lo.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=re.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ot(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===re.Kind.Video&&(n="video"),this.attachedElements.length===0&&re.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(ju.forEach(o=>{o.parentElement===null&&!e&&(e=o)}),e&&ju.splice(ju.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),pc(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(o=>o.kind==="audio");return e.play().then(()=>{this.emit(i?xe.AudioPlaybackStarted:xe.VideoPlaybackStarted)}).catch(o=>{o.name==="NotAllowedError"?this.emit(i?xe.AudioPlaybackFailed:xe.VideoPlaybackFailed,o):o.name==="AbortError"?et.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):et.warn("could not playback ".concat(i?"audio":"video"),o),i&&e&&r.some(s=>s.kind==="video")&&o.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(xe.ElementAttached,e),e}detach(e){try{if(e){Tc(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(xe.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{Tc(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(xe.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(e){e.loggerName&&(this.log=Ms(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),ju.forEach(r=>{r.parentElement||(n=!1)}),n&&ju.push(e)}}handleAppVisibilityChanged(){return $(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){_r()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){_r()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function pc(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!_l()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(_l()||Jc())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function Tc(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(c){c.Audio="audio",c.Video="video",c.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(c){c.Camera="camera",c.Microphone="microphone",c.ScreenShare="screen_share",c.ScreenShareAudio="screen_share_audio",c.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(c){c.Active="active",c.Paused="paused",c.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(c){switch(c){case e.Audio:return Xn.AUDIO;case e.Video:return Xn.VIDEO;default:return Xn.DATA}}t.kindToProto=i;function o(c){switch(c){case Xn.AUDIO:return e.Audio;case Xn.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=o;function s(c){switch(c){case n.Camera:return tn.CAMERA;case n.Microphone:return tn.MICROPHONE;case n.ScreenShare:return tn.SCREEN_SHARE;case n.ScreenShareAudio:return tn.SCREEN_SHARE_AUDIO;default:return tn.UNKNOWN}}t.sourceToProto=s;function a(c){switch(c){case tn.CAMERA:return n.Camera;case tn.MICROPHONE:return n.Microphone;case tn.SCREEN_SHARE:return n.ScreenShare;case tn.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=a;function l(c){switch(c){case Rl.ACTIVE:return r.Active;case Rl.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=l})(re||(re={}));function WD(t,e,n){var r;const i=(r=fz(t))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&QC(i.audio,e),i.video&&QC(i.video,n),i}function QC(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function jp(t){const e={};if(t.video)if(typeof t.video=="object"){const n={},r=n,i=t.video;Object.keys(i).forEach(o=>{switch(o){case"resolution":QC(r,i.resolution);break;default:r[o]=i[o]}}),e.video=n}else e.video=t.video;else e.video=!1;return t.audio?typeof t.audio=="object"?e.audio=t.audio:e.audio=!0:e.audio=!1,e}function pz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return $(this,void 0,void 0,function*(){const n=Ix();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,o=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(r),yield _s(e),r.getByteTimeDomainData(o);const a=o.some(l=>l!==128&&l!==0);return n.close(),!a}return!1})}function Ix(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function gz(t){return t===re.Source.Microphone?"audioinput":t===re.Source.Camera?"videoinput":void 0}function mz(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(r=typeof r=="boolean"?{}:r,_l()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio}}function zD(t){const e=t.split("/")[1].toLowerCase();if(!GD.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function vz(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new ji({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function Ot(t){return t instanceof re?{trackSid:t.sid,trackSource:t.source,trackMuted:t.isMuted,trackEnabled:t.mediaStreamTrack.enabled,trackKind:t.kind}:{trackSid:t.trackSid,trackName:t.trackName,track:t.track?Ot(t.track):void 0,trackEnabled:t.isEnabled,trackEncrypted:t.isEncrypted,trackMimeType:t.mimeType}}const Cz="|",uS="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function yz(t){const e=t.split(Cz);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function _s(t){return $(this,void 0,void 0,function*(){return new Promise(e=>Bn.setTimeout(e,t))})}function dS(){return"addTransceiver"in RTCPeerConnection.prototype}function fS(){return"addTrack"in RTCPeerConnection.prototype}function xz(){if(!("getCapabilities"in RTCRtpSender)||_l())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function Iz(){if(!("getCapabilities"in RTCRtpSender)||Jc())return!1;if(_l()){const n=Ls();if(n!=null&&n.version&&bx(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function bd(t){return t==="av1"||t==="vp9"}function ey(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}const bz={Chrome:"100",Safari:"15",Firefox:"100"};function Az(t){if(!_r()||!("setCodecPreferences"in t))return!1;const e=Ls();if(!(e!=null&&e.name)||!e.version)return!1;const n=bz[e.name];return n?bx(e.version,n)>=0:!1}function Jc(){var t;return((t=Ls())===null||t===void 0?void 0:t.name)==="Firefox"}function wz(){var t;return((t=Ls())===null||t===void 0?void 0:t.name)==="Chrome"}function _l(){var t;return((t=Ls())===null||t===void 0?void 0:t.name)==="Safari"}function Sz(){const t=Ls();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")}function jD(){return _r()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function _r(){return typeof document<"u"}function Dl(){return navigator.product=="ReactNative"}function ty(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function HD(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function ZD(){if(!Dl())return;let t=HD();if(t)return t.platform}function hS(){if(_r())return window.devicePixelRatio;if(Dl()){let t=HD();if(t)return t.devicePixelRatio}return 1}function bx(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let o=0;o<i;++o){const s=parseInt(n[o],10),a=parseInt(r[o],10);if(s>a)return 1;if(s<a)return-1;if(o===i-1&&s===a)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function kz(t){for(const e of t)e.target.handleResize(e)}function Ez(t){for(const e of t)e.target.handleVisibilityChanged(e)}let Lm=null;const pS=()=>(Lm||(Lm=new ResizeObserver(kz)),Lm);let Um=null;const gS=()=>(Um||(Um=new IntersectionObserver(Ez,{root:null,rootMargin:"0px"})),Um);function Tz(){var t;const e=new ls({sdk:Kc.JS,protocol:cz,version:lz});return Dl()&&(e.os=(t=ZD())!==null&&t!==void 0?t:""),e}function mS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const o=i.getContext("2d");o==null||o.fillRect(0,0,i.width,i.height),r&&o&&(o.beginPath(),o.arc(t/2,e/2,50,0,Math.PI*2,!0),o.closePath(),o.fillStyle="grey",o.fill());const s=i.captureStream(),[a]=s.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let Hu;function Vm(){if(!Hu){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[Hu]=r.stream.getAudioTracks(),!Hu)throw Error("Could not get empty media stream audio track");Hu.enabled=!1}return Hu.clone()}class $D{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>$(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function Rz(t,e){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=Ix();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?t.mediaStreamTrack.clone():t.mediaStreamTrack,o=r.createMediaStreamSource(new MediaStream([i])),s=r.createAnalyser();s.minDecibels=n.minDecibels,s.maxDecibels=n.maxDecibels,s.fftSize=n.fftSize,s.smoothingTimeConstant=n.smoothingTimeConstant,o.connect(s);const a=new Uint8Array(s.frequencyBinCount);return{calculateVolume:()=>{s.getByteFrequencyData(a);let u=0;for(const f of a)u+=Math.pow(f/255,2);return Math.sqrt(u/a.length)},analyser:s,cleanup:()=>$(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&i.stop()})}}class Xi{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function _z(t){return GD.includes(t)}function ml(t){if(typeof t=="string")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function Dz(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function vS(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}const CS="default";class ir{static getInstance(){return this.instance===void 0&&(this.instance=new ir),this.instance}getDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return $(this,void 0,void 0,function*(){if(((r=ir.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){et.debug("awaiting getUserMedia promise");try{e?yield ir.userMediaPromiseMap.get(e):yield Promise.all(ir.userMediaPromiseMap.values())}catch{et.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(n&&!(_l()&&this.hasDeviceInUse(e))&&(i.length===0||i.some(s=>{const a=s.label==="",l=e?s.kind===e:!0;return a&&l}))){const s={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(s);i=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(l=>{l.stop()})}return e&&(i=i.filter(o=>o.kind===e)),i})}normalizeDeviceId(e,n,r){return $(this,void 0,void 0,function*(){if(n!==CS)return n;const o=(yield this.getDevices(e)).find(s=>s.groupId===r&&s.deviceId!==CS);return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?ir.userMediaPromiseMap.has(e):ir.userMediaPromiseMap.size>0}}ir.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];ir.userMediaPromiseMap=new Map;const Pz=1e3;class Yc extends re{get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;super(e,n,o),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=yx(()=>$(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>$(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(xe.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new Xi,this.pauseUpstreamLock=new Xi,this.processorLock=new Xi,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==re.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(e,n){return $(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{Tc(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");pc(e,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{pc(r??e,i)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pz;var n;return $(this,void 0,void 0,function*(){if(this.kind===re.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=Ls())===null||n===void 0?void 0:n.os)==="iOS"&&(yield _s(10));const r=Date.now();for(;Date.now()-r<e;){const i=this.dimensions;if(i)return i;yield _s(50)}throw new fo("unable to get track dimensions after timeout")})}getDeviceId(){return $(this,void 0,void 0,function*(){if(this.source===re.Source.ScreenShare)return;const{deviceId:e,groupId:n}=this._mediaStreamTrack.getSettings(),r=this.kind===re.Kind.Audio?"audioinput":"videoinput";return ir.getInstance().normalizeDeviceId(r,e,n)})}mute(){return $(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return $(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return $(this,void 0,void 0,function*(){if(!this.sender)throw new fo("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(e){return $(this,void 0,void 0,function*(){e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const n={audio:!1,video:!1};this.kind===re.Kind.Video?n.video=e:n.audio=e,this.attachedElements.forEach(o=>{Tc(this.mediaStreamTrack,o)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(i),this._constraints=e,this.emit(xe.Restarted,this),this})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?xe.Muted:xe.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return $(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),jD()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return $(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(xe.UpstreamPaused,this);const n=Ls();if((n==null?void 0:n.name)==="Safari"&&bx(n.version,"12.0")<0)throw new Cx("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return $(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(xe.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return $(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return $(this,void 0,void 0,function*(){const o=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),pc(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch(a=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:a})));const s={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(s),this.processor=e,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&n&&(Tc(this._mediaStreamTrack,a),pc(this.processor.processedTrack,a));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{o()}})}getProcessor(){return this.processor}stopProcessor(){var e,n;return $(this,void 0,void 0,function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class Nz extends jo.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:o,data:s}=n.data;switch(o){case"error":et.error(s.error.message),this.emit(ya.EncryptionError,s.error);break;case"initAck":s.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==s.enabled&&s.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(ya.ParticipantEncryptionStatusChanged,s.enabled,this.room.localParticipant),this.encryptionEnabled=s.enabled;else if(s.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(s.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(s.participantIdentity));this.emit(ya.ParticipantEncryptionStatusChanged,s.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(Ra.KeyRatcheted,s.material,s.keyIndex);break}},this.onWorkerError=n=>{et.error("e2ee worker encountered an error:",{error:n.error}),this.emit(ya.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!nz())throw new Cx("tried to setup end-to-end encryption on an unsupported browser");if(et.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(et.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){et.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?et.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(Te.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(ue.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Pn.NONE,i.identity)),e.on(ue.ConnectionStateChanged,r=>{r===ft.Connected&&e.participants.forEach(i=>{i.tracks.forEach(o=>{this.setParticipantCryptorEnabled(o.trackInfo.encryption!==Pn.NONE,i.identity)})})}).on(ue.TrackUnsubscribed,(r,i,o)=>{var s;const a={kind:"removeTransform",data:{participantIdentity:o.identity,trackId:r.mediaStreamID}};(s=this.worker)===null||s===void 0||s.postMessage(a)}).on(ue.TrackSubscribed,(r,i,o)=>{this.setupE2EEReceiver(r,o.identity,i.trackInfo)}).on(ue.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(r=>{this.postKey(r)})}),e.localParticipant.on(de.LocalTrackPublished,r=>$(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(Ra.SetKey,r=>this.postKey(r)).on(Ra.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const s={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(s)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?zD(r.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof Yc)||!n){n||et.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return $(this,void 0,void 0,function*(){if(this.worker){if(JC()){const o={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(ch in e&&i){const l={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(l);return}let o=e.writableStream,s=e.readableStream;if(!o||!s){const l=e.createEncodedStreams();e.writableStream=l.writable,o=l.writable,e.readableStream=l.readable,s=l.readable}const a={kind:"decode",data:{readableStream:s,writableStream:o,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[s,o])}e[ch]=!0}})}handleSender(e,n,r){var i;if(!(ch in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(JC()){et.info("initialize script transform");const o={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{et.info("initialize encoded streams");const o=e.createEncodedStreams(),s={kind:"encode",data:{readableStream:o.readable,writableStream:o.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s,[o.readable,o.writable])}e[ch]=!0}}}var Ad;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(Ad||(Ad={}));class Bz{constructor(){this.pendingTasks=new Map,this.taskMutex=new Xi,this.nextTaskIndex=0}run(e){return $(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Ad.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Ad.RUNNING,yield e()}finally{n.status=Ad.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return $(this,void 0,void 0,function*(){return this.run(()=>$(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const Fz=["syncState","trickle","offer","answer","simulate","leave"];function Oz(t){const e=Fz.indexOf(t.case)>=0;return et.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var Yt;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(Yt||(Yt={}));class Ax{get currentState(){return this.state}get isDisconnected(){return this.state===Yt.DISCONNECTING||this.state===Yt.DISCONNECTED}get isEstablishingConnection(){return this.state===Yt.CONNECTING||this.state===Yt.RECONNECTING}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=Yt.DISCONNECTED,this.log=et,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=Ms((r=n.loggerName)!==null&&r!==void 0?r:Lo.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new Bz,this.queuedRequests=[],this.closingLock=new Xi,this.connectionLock=new Xi,this.state=Yt.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,i){return $(this,void 0,void 0,function*(){return this.state=Yt.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return $(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Yt.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r,e=Dz(e),e=e.replace(/\/$/,""),e+="/rtc";const o=Tz(),s=Mz(n,o,r);return new Promise((a,l)=>$(this,void 0,void 0,function*(){const c=yield this.connectionLock.lock();try{const u=()=>$(this,void 0,void 0,function*(){this.close(),clearTimeout(d),l(new Rt("room connection has been cancelled (signal)"))}),d=setTimeout(()=>{this.close(),l(new Rt("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&u(),i==null||i.addEventListener("abort",u),this.log.debug("connecting to ".concat(e+s),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+s),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=f=>$(this,void 0,void 0,function*(){if(this.state!==Yt.CONNECTED){clearTimeout(d);try{const h=yield fetch("http".concat(e.substring(2),"/validate").concat(s));if(h.status.toFixed(0).startsWith("4")){const p=yield h.text();l(new Rt(p,0,h.status))}else l(new Rt("Internal error",2,h.status))}catch{l(new Rt("server was not reachable",1))}return}this.handleWSError(f)}),this.ws.onmessage=f=>$(this,void 0,void 0,function*(){var h,p,m,C;let v;if(typeof f.data=="string"){const g=JSON.parse(f.data);v=Ao.fromJson(g)}else if(f.data instanceof ArrayBuffer)v=Ao.fromBinary(new Uint8Array(f.data));else{this.log.error("could not decode websocket message: ".concat(typeof f.data),this.logContext);return}if(this.state!==Yt.CONNECTED){let g=!1;if(((h=v.message)===null||h===void 0?void 0:h.case)==="join"?(this.state=Yt.CONNECTED,i==null||i.removeEventListener("abort",u),this.pingTimeoutDuration=v.message.value.pingTimeout,this.pingIntervalDuration=v.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),a(v.message.value)):this.state===Yt.RECONNECTING&&v.message.case!=="leave"?(this.state=Yt.CONNECTED,i==null||i.removeEventListener("abort",u),this.startPingInterval(),((p=v.message)===null||p===void 0?void 0:p.case)==="reconnect"?a((m=v.message)===null||m===void 0?void 0:m.value):(a(),g=!0)):this.isEstablishingConnection&&v.message.case==="leave"?l(new Rt("Received leave request while trying to (re)connect",4)):r.reconnect||l(new Rt("did not receive join response, got ".concat((C=v.message)===null||C===void 0?void 0:C.case," instead"))),!g)return}this.signalLatency&&(yield _s(this.signalLatency)),this.handleSignalResponse(v)}),this.ws.onclose=f=>{this.isEstablishingConnection&&l(new Rt("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:f.reason,state:this.state})),this.handleOnClose(f.reason)}}finally{c()}}))}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return $(this,void 0,void 0,function*(){const n=yield this.closingLock.lock();try{if(e&&(this.state=Yt.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const r=new Promise(i=>{this.ws?this.ws.onclose=()=>{i()}:i()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([r,_s(250)])),this.ws=void 0}}finally{e&&(this.state=Yt.DISCONNECTED),this.clearPingInterval(),n()}})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Q0(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Q0(e)})}sendIceCandidate(e,n){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Wi({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new zi({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return this.sendRequest({case:"updateMetadata",value:new ko({metadata:e,name:n})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new So({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new Ro({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:je.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Po({timestamp:je.parse(Date.now()),rtt:je.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new pi({canReconnect:!1,reason:Rs.CLIENT_INITIATED})})}sendRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return $(this,void 0,void 0,function*(){if(!n&&!Oz(e)&&this.state===Yt.RECONNECTING){this.queuedRequests.push(()=>$(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield _s(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){this.log.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case),this.logContext);return}const i=new us({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(o){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:o}))}})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let o=!1;if(i.case==="answer"){const s=yS(i.value);this.onAnswer&&this.onAnswer(s)}else if(i.case==="offer"){const s=yS(i.value);this.onOffer&&this.onOffer(s)}else if(i.case==="trickle"){const s=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(s,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return $(this,void 0,void 0,function*(){if(this.state===Yt.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Bn.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Bn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Bn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Bn.clearInterval(this.pingInterval)}}function yS(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function Q0(t){return new cr({sdp:t.sdp,type:t.type})}function Mz(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",Dl()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.publishOnly!==void 0&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var XD={},KD={exports:{}},xS=KD.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(xS).forEach(function(t){var e=xS[t];e.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var JD=KD.exports;(function(t){var e=function(a){return String(Number(a))===a?Number(a):a},n=function(a,l,c,u){if(u&&!c)l[u]=e(a[1]);else for(var d=0;d<c.length;d+=1)a[d+1]!=null&&(l[c[d]]=e(a[d+1]))},r=function(a,l,c){var u=a.name&&a.names;a.push&&!l[a.push]?l[a.push]=[]:u&&!l[a.name]&&(l[a.name]={});var d=a.push?{}:u?l[a.name]:l;n(c.match(a.reg),d,a.names,a.name),a.push&&l[a.push].push(d)},i=JD,o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var l={},c=[],u=l;return a.split(/(\r\n|\r|\n)/).filter(o).forEach(function(d){var f=d[0],h=d.slice(2);f==="m"&&(c.push({rtp:[],fmtp:[]}),u=c[c.length-1]);for(var p=0;p<(i[f]||[]).length;p+=1){var m=i[f][p];if(m.reg.test(h))return r(m,u,h)}}),l.media=c,l};var s=function(a,l){var c=l.split(/=(.+)/,2);return c.length===2?a[c[0]]=e(c[1]):c.length===1&&l.length>1&&(a[c[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(s,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var l=[],c=a.split(" ").map(e),u=0;u<c.length;u+=3)l.push({component:c[u],ip:c[u+1],port:c[u+2]});return l},t.parseImageAttributes=function(a){return a.split(" ").map(function(l){return l.substring(1,l.length-1).split(",").reduce(s,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(l){return l.split(",").map(function(c){var u,d=!1;return c[0]!=="~"?u=e(c):(u=e(c.substring(1,c.length)),d=!0),{scid:u,paused:d}})})}})(XD);var Gm=JD,Lz=/%[sdv%]/g,Uz=function(t){var e=1,n=arguments,r=n.length;return t.replace(Lz,function(i){if(e>=r)return i;var o=n[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},Zu=function(t,e,n){var r=e.format instanceof Function?e.format(e.push?n:n[e.name]):e.format,i=[t+"="+r];if(e.names)for(var o=0;o<e.names.length;o+=1){var s=e.names[o];e.name?i.push(n[e.name][s]):i.push(n[e.names[o]])}else i.push(n[e.name]);return Uz.apply(null,i)},Vz=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Gz=["i","c","b","a"],Wz=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(o){o.payloads==null&&(o.payloads="")});var n=e.outerOrder||Vz,r=e.innerOrder||Gz,i=[];return n.forEach(function(o){Gm[o].forEach(function(s){s.name in t&&t[s.name]!=null?i.push(Zu(o,s,t)):s.push in t&&t[s.push]!=null&&t[s.push].forEach(function(a){i.push(Zu(o,s,a))})})}),t.media.forEach(function(o){i.push(Zu("m",Gm.m[0],o)),r.forEach(function(s){Gm[s].forEach(function(a){a.name in o&&o[a.name]!=null?i.push(Zu(s,a,o)):a.push in o&&o[a.push]!=null&&o[a.push].forEach(function(l){i.push(Zu(s,a,l))})})})}),i.join(`\r
`)+`\r
`},zz=XD,jz=Wz,Wm=jz,sd=zz.parse;const IS=.7,Rc={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class bS extends jo.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.log=et,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=yx(o=>$(this,void 0,void 0,function*(){this.emit(Rc.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(o)o(s);else throw s}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Ms((i=r.loggerName)!==null&&i!==void 0?i:Lo.PCTransport),this.loggerOptions=r,this.config=e,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const e=wz()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return $(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var n;return $(this,void 0,void 0,function*(){let r;if(e.type==="offer"){let{stereoMids:i,nackMids:o}=Zz(e);this.remoteStereoMids=i,this.remoteNackMids=o}else if(e.type==="answer"){const i=sd((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"&&this.trackBitrates.some(s=>{if(!s.transceiver||o.mid!=s.transceiver.mid)return!1;let a=0;if(o.rtp.some(c=>c.codec.toUpperCase()===s.codec.toUpperCase()?(a=c.payload,!0):!1),a===0)return!0;let l=!1;for(const c of o.fmtp)if(c.payload===a){c.config=c.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),s.maxbr>0&&(c.config+=";maxaveragebitrate=".concat(s.maxbr*1e3)),l=!0;break}return l||s.maxbr>0&&o.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(s.maxbr*1e3)}),!0})}),r=Wm(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Rc.NegotiationComplete),e.sdp&&sd(e.sdp).media.forEach(o=>{o.type==="video"&&this.emit(Rc.RTPVideoPayloadTypes,o.rtp)}))})}createAndSendOffer(e){var n;return $(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const o=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&o)yield this._pc.setRemoteDescription(o);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e),i=sd((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(o=>{o.type==="audio"?AS(o,[],[]):o.type==="video"&&(Hz(o),this.trackBitrates.some(s=>{if(!o.msid||!s.cid||!o.msid.includes(s.cid))return!1;let a=0;if(o.rtp.some(c=>c.codec.toUpperCase()===s.codec.toUpperCase()?(a=c.payload,!0):!1),a===0)return!0;let l=!1;for(const c of o.fmtp)if(c.payload===a){c.config.includes("x-google-start-bitrate")||(c.config+=";x-google-start-bitrate=".concat(Math.round(s.maxbr*IS))),c.config.includes("x-google-max-bitrate")||(c.config+=";x-google-max-bitrate=".concat(s.maxbr)),l=!0;break}return l||o.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(Math.round(s.maxbr*IS),";x-google-max-bitrate=").concat(s.maxbr)}),!0}))}),yield this.setMungedSDP(r,Wm(i)),this.onOffer(r)})}createAndSetAnswer(){var e;return $(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),r=sd((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{i.type==="audio"&&AS(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Wm(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new pn("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new pn("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return $(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const s=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(s!==void 0)return i.get(s)})}setMungedSDP(e,n,r){return $(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(o){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:o,sdp:n})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let o="unknown error";i instanceof Error?o=i.message:typeof i=="string"&&(o=i);const s={error:o,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(s.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:s})),new YC(o)}})}}function AS(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function Hz(t){var e,n,r,i;const o=(n=(e=t.rtp[0])===null||e===void 0?void 0:e.codec)===null||n===void 0?void 0:n.toLowerCase();if(!bd(o))return;let s=0;((r=t.ext)===null||r===void 0?void 0:r.some(l=>l.uri===uS?!0:(l.value>s&&(s=l.value),!1)))||(i=t.ext)===null||i===void 0||i.push({value:s+1,uri:uS})}function Zz(t){var e;const n=[],r=[],i=sd((e=t.sdp)!==null&&e!==void 0?e:"");let o=0;return i.media.forEach(s=>{var a;s.type==="audio"&&(s.rtp.some(l=>l.codec==="opus"?(o=l.payload,!0):!1),!((a=s.rtcpFb)===null||a===void 0)&&a.some(l=>l.payload===o&&l.type==="nack")&&r.push(s.mid),s.fmtp.some(l=>l.payload===o?(l.config.includes("sprop-stereo=1")&&n.push(s.mid),!0):!1))}),{stereoMids:n,nackMids:r}}const ny="vp8",$z={audioBitrate:Y0.music.maxBitrate,audioPreset:Y0.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:xx.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:ny,backupCodec:!0},YD={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},qD={resolution:sf.h720.resolution},Xz={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new LW,disconnectOnPageLeave:!0,expWebAudioMix:!1},wx={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var mn;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(mn||(mn={}));class Kz{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,r){var i;this.peerConnectionTimeout=wx.peerConnectionTimeout,this.log=et,this.updateState=()=>{var s;const a=this.state,l=this.requiredTransports.map(c=>c.getConnectionState());l.every(c=>c==="connected")?this.state=mn.CONNECTED:l.some(c=>c==="failed")?this.state=mn.FAILED:l.some(c=>c==="connecting")?this.state=mn.CONNECTING:l.every(c=>c==="closed")?this.state=mn.CLOSED:l.some(c=>c==="closed")?this.state=mn.CLOSING:l.every(c=>c==="new")&&(this.state=mn.NEW),a!==this.state&&(this.log.debug("pc state change: from ".concat(mn[a]," to ").concat(mn[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=Ms((i=r.loggerName)!==null&&i!==void 0?i:Lo.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const o={optional:[{googDscp:!0}]};this.publisher=new bS(e,o,r),this.subscriber=new bS(e,void 0,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,Kn.PUBLISHER)},this.subscriber.onIceCandidate=s=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,s,Kn.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var a;(a=this.onDataChannel)===null||a===void 0||a.call(this,s)},this.subscriber.onTrack=s=>{var a;(a=this.onTrack)===null||a===void 0||a.call(this,s)},this.publisher.onOffer=s=>{var a;(a=this.onPublisherOffer)===null||a===void 0||a.call(this,s)},this.state=mn.NEW,this.connectionLock=new Xi}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return $(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return $(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return $(this,void 0,void 0,function*(){n===Kn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return $(this,void 0,void 0,function*(){return this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){var r;return $(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(o=>this.ensureTransportConnected(o,e,n)))}finally{i()}})}negotiate(e){return $(this,void 0,void 0,function*(){return new Promise((n,r)=>$(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),o=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",o),this.publisher.once(Rc.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Rc.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(s=>{clearTimeout(i),r(s)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===Kn.PUBLISHER?this.publisher.getConnectedAddress():e===Kn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return $(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((o,s)=>$(this,void 0,void 0,function*(){const a=()=>{this.log.warn("abort transport connection",this.logContext),Bn.clearTimeout(l),s(new Rt("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&a(),n==null||n.signal.addEventListener("abort",a);const l=Bn.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",a),s(new Rt("could not establish pc connection"))},r);for(;this.state!==mn.CONNECTED;)if(yield _s(50),n!=null&&n.signal.aborted){s(new Rt("room connection has been cancelled",3));return}Bn.clearTimeout(l),n==null||n.signal.removeEventListener("abort",a),o()}))})}}const wS="_lossy",SS="_reliable",Jz=2*1e3,kS="leave-reconnect";var Si;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(Si||(Si={}));class Yz extends jo.EventEmitter{get isClosed(){return this._isClosed}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=wx.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=Si.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=et,this.handleDataChannel=r=>{let{channel:i}=r;return $(this,void 0,void 0,function*(){if(i){if(i.label===SS)this.reliableDCSub=i;else if(i.label===wS)this.lossyDCSub=i;else return;this.log.debug("on data channel ".concat(i.id,", ").concat(i.label),this.logContext),i.onmessage=this.handleDataMessage}})},this.handleDataMessage=r=>$(this,void 0,void 0,function*(){var i,o;const s=yield this.dataProcessLock.lock();try{let a;if(r.data instanceof ArrayBuffer)a=r.data;else if(r.data instanceof Blob)a=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const l=mo.fromBinary(new Uint8Array(a));((i=l.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(Te.ActiveSpeakersUpdate,l.value.value.speakers):((o=l.value)===null||o===void 0?void 0:o.case)==="user"&&this.emit(Te.DataPacketReceived,l.value.value,l.kind)}finally{s()}}),this.handleDataError=r=>{const o=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:s}=r.error;this.log.error("DataChannel error on ".concat(o,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:s}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const o=r.currentTarget.maxRetransmits===0?gn.LOSSY:gn.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const o=l=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(l,"ms. giving up"),this.logContext),this.emit(Te.Disconnected),this.close()},s=Date.now()-this.reconnectStart;let a=this.getNextRetryDelay({elapsedMs:s,retryCount:this.reconnectAttempts});if(a===null){o(s);return}r===kS&&(a=0),this.log.debug("reconnecting in ".concat(a,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Bn.setTimeout(()=>this.attemptReconnect(i),a)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===Si.Connected&&r();const o=()=>{this.off(Te.Disconnected,s),r()},s=()=>{this.off(Te.Restarted,o),i()};this.once(Te.Restarted,o),this.once(Te.Disconnected,s)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(Te.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Yt.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(Yo.RR_SIGNAL_DISCONNECTED))},this.log=Ms((n=e.loggerName)!==null&&n!==void 0?n:Lo.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Ax(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Xi,this.dataProcessLock=new Xi,this.dcBufferStatus=new Map([[gn.LOSSY,!0],[gn.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(Te.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(Te.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(Te.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(Te.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(Te.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(Te.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(Te.StreamStateChanged,r)}get logContext(){var e,n,r,i,o,s;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomSid:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,identity:(s=(o=this.latestJoinResponse)===null||o===void 0?void 0:o.participant)===null||s===void 0?void 0:s.identity}}join(e,n,r,i){return $(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.pcManager||(yield this.configure(o)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=o.clientConfiguration,o}catch(o){if(o instanceof Rt&&o.reason===1&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw o}})}close(){return $(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(Te.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return $(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return $(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new fo("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new Rt("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:o=>{clearTimeout(i),n(o)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return $(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var n;return $(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==mn.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new Kz(r,e.subscriberPrimary,this.loggerOptions),this.emit(Te.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,o)=>{this.client.sendIceCandidate(i,o)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,o,s)=>$(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(i),this.logContext),i===mn.CONNECTED){const a=this.pcState===Si.New;this.pcState=Si.Connected,a&&this.emit(Te.Connected,e)}else i===mn.FAILED&&this.pcState===Si.Connected&&(this.pcState=Si.Disconnected,this.handleDisconnect("peerconnection failed",s==="failed"?Yo.RR_SUBSCRIBER_FAILED:Yo.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(Te.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>$(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>$(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Te.LocalTrackUnpublished,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(Te.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Te.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",Yo.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(kS)):(this.emit(Te.Disconnected,e==null?void 0:e.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason}))}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(o=>{const s={urls:o.urls};o.username&&(s.username=o.username),o.credential&&(s.credential=o.credential),i.push(s)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Yi.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(wS,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(SS,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,n,r){if(!("getCapabilities"in RTCRtpReceiver))return;const i=RTCRtpReceiver.getCapabilities(n);if(!i)return;this.log.debug("get receiver capabilities",Object.assign(Object.assign({},this.logContext),{cap:i}));const o=[],s=[],a=[];i.codecs.forEach(l=>{const c=l.mimeType.toLowerCase();if(c==="audio/opus"){o.push(l);return}if(!(c==="video/".concat(r))){a.push(l);return}if(r==="h264"){l.sdpFmtpLine&&l.sdpFmtpLine.includes("profile-level-id=42e01f")?o.push(l):s.push(l);return}o.push(l)}),Az(e)&&e.setCodecPreferences(o.concat(s,a))}createSender(e,n,r){return $(this,void 0,void 0,function*(){if(dS())return yield this.createTransceiverRTCRtpSender(e,n,r);if(fS())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new pn("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return $(this,void 0,void 0,function*(){if(dS())return this.createSimulcastTransceiverSender(e,n,r,i);if(fS())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new pn("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return $(this,void 0,void 0,function*(){if(!this.pcManager)throw new pn("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const o={direction:"sendonly",streams:i};r&&(o.sendEncodings=r);const s=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,o);return e.kind===re.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(s,e.kind,n.videoCodec),e.codec=n.videoCodec),s.sender})}createSimulcastTransceiverSender(e,n,r,i){return $(this,void 0,void 0,function*(){if(!this.pcManager)throw new pn("publisher is closed");const o={direction:"sendonly"};i&&(o.sendEncodings=i);const s=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,o);if(r.videoCodec)return this.setPreferredCodec(s,e.kind,r.videoCodec),e.setSimulcastTrackSender(r.videoCodec,s.sender),s.sender})}createRTCRtpSender(e){return $(this,void 0,void 0,function*(){if(!this.pcManager)throw new pn("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var n,r,i;return $(this,void 0,void 0,function*(){if(!this._isClosed){if(this.attemptingReconnect){et.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Yi.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:mn.NEW)===mn.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(o){this.reconnectAttempts+=1;let s=!0;o instanceof pn?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:o})),s=!1):o instanceof ql||(this.fullReconnectOnNext=!0),s?this.handleDisconnect("reconnect",Yo.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Te.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){var n,r,i;return $(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new pn("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Te.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let o;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new ql;o=yield this.join(e??this.url,this.token,this.signalOpts)}catch(s){throw s instanceof Rt&&s.reason===0?new pn("could not reconnect, token might be expired"):new ql}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Te.SignalRestarted,o),yield this.waitForPCReconnected(),this.client.currentState!==Yt.CONNECTED)throw new ql("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(Te.Restarted)}catch(o){const s=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(s){yield this.restartConnection(s);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),o}})}resumeConnection(e){var n;return $(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new pn("could not reconnect, url or token not saved");if(!this.pcManager)throw new pn("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Te.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,this.log.error(r.message,Object.assign(Object.assign({},this.logContext),{error:r}))),r instanceof Rt&&r.reason===0?new pn("could not reconnect, token might be expired"):r instanceof Rt&&r.reason===4?r:new ql(i)}if(this.emit(Te.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Yt.CONNECTED)throw new ql("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(Te.Resumed)})}waitForPCInitialConnection(e,n){return $(this,void 0,void 0,function*(){if(!this.pcManager)throw new pn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return $(this,void 0,void 0,function*(){this.pcState=Si.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield _s(Jz),!this.pcManager)throw new pn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Si.Connected}catch(e){throw this.pcState=Si.Disconnected,new Rt("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,n){return $(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return $(this,void 0,void 0,function*(){if(!this.pcManager)throw new pn("PC manager is closed");const i=n?this.pcManager.subscriber:this.pcManager.publisher,o=n?"Subscriber":"Publisher";if(!i)throw new Rt("".concat(o," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const s=this.dataChannelForKind(e,n);if((s==null?void 0:s.readyState)==="open")return;const a=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<a;){if(i.isICEConnected&&((r=this.dataChannelForKind(e,n))===null||r===void 0?void 0:r.readyState)==="open")return;yield _s(50)}throw new Rt("could not establish ".concat(o," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(e){return $(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==mn.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return $(this,void 0,void 0,function*(){return new Promise((e,n)=>$(this,void 0,void 0,function*(){if(!this.pcManager){n(new YC("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(Te.Closing,i),this.pcManager.publisher.once(Rc.RTPVideoPayloadTypes,o=>{const s=new Map;o.forEach(a=>{const l=a.codec.toLowerCase();_z(l)&&s.set(a.payload,l)}),this.emit(Te.RTPVideoMapUpdate,s)});try{yield this.pcManager.negotiate(r),e()}catch(o){o instanceof YC&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Yo.RR_UNKNOWN),n(o)}finally{this.off(Te.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===gn.LOSSY)return this.lossyDCSub;if(e===gn.RELIABLE)return this.reliableDCSub}else{if(e===gn.LOSSY)return this.lossyDC;if(e===gn.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const o=this.pcManager.subscriber.getLocalDescription(),s=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,l=new Array;e.forEach(c=>{c.isDesired!==a&&l.push(c.trackSid)}),this.client.sendSyncState(new _o({answer:o?Q0({sdp:o.sdp,type:o.type}):void 0,offer:s?Q0({sdp:s.sdp,type:s.type}):void 0,subscription:new hi({trackSids:l,subscribe:!a,participantTracks:[]}),publishTracks:vz(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new Do({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(gn.LOSSY),Kn.PUBLISHER),n(this.dataChannelForKind(gn.RELIABLE),Kn.PUBLISHER),n(this.dataChannelForKind(gn.LOSSY,!0),Kn.SUBSCRIBER),n(this.dataChannelForKind(gn.RELIABLE,!0),Kn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Bn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){_r()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){_r()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class ql extends Error{}class ES{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return ty(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return $(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),et.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return $(this,void 0,void 0,function*(){const n=yield fetch("".concat(qz(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new Rt("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function qz(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}const Sx=2e3;function Hp(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}class br extends Yc{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(e,re.Kind.Audio,n,r,o),this.stopOnMute=!1,this.monitorSender=()=>$(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}s&&this.prevStats&&(this._currentBitrate=Hp(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return $(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||ml(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return $(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===re.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return $(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==ml(this._constraints.deviceId);return this.source===re.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return $(this,void 0,void 0,function*(){let n;if(e){const r=jp({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return $(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){_r()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Sx)))}setProcessor(e){var n;return $(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return $(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return $(this,void 0,void 0,function*(){const e=yield pz(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(xe.AudioSilenceDetected)),e})}}function QD(t,e,n){switch(t.kind){case"audio":return new br(t,e,!1,void 0,n);case"video":return new si(t,e,!1,n);default:throw new fo("unsupported track type: ".concat(t.kind))}}const Qz=Object.values(sf),ej=Object.values(qC),tj=Object.values(xx),nj=[sf.h180,sf.h360],rj=[qC.h180,qC.h360],ij=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var r,i;return new It(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=n.fps)!==null&&i!==void 0?i:30))))),n.fps,t.encoding.priority)}),ry=["q","h","f"];function iy(t,e,n,r){var i,o;let s=r==null?void 0:r.videoEncoding;t&&(s=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,l=r==null?void 0:r.scalabilityMode,c=r==null?void 0:r.videoCodec;if(!s&&!a&&!l||!e||!n)return[{}];s||(s=sj(t,e,n,c),et.debug("using video encoding",s));const u=new It(e,n,s.maxBitrate,s.maxFramerate,s.priority);if(l&&bd(c)){et.debug("using svc with scalabilityMode ".concat(l));const h=new e3(l),p=[];if(h.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(l));for(let m=0;m<h.spatial;m+=1)p.push({rid:ry[2-m],maxBitrate:s.maxBitrate/Math.pow(3,m),maxFramerate:u.encoding.maxFramerate});return p[0].scalabilityMode=l,et.debug("encodings",p),p}if(!a)return[s];let d=[];t?d=(i=RS(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:TS(t,u):d=(o=RS(r==null?void 0:r.videoSimulcastLayers))!==null&&o!==void 0?o:TS(t,u);let f;if(d.length>0){const h=d[0];d.length>1&&([,f]=d);const p=Math.max(e,n);if(p>=960&&f)return zm(e,n,[h,f,u]);if(p>=480)return zm(e,n,[h,u])}return zm(e,n,[u])}function oj(t,e,n){var r,i,o,s;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&et.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const a=t.mediaStreamTrack.getSettings(),l=(r=a.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,c=(o=a.height)!==null&&o!==void 0?o:(s=t.dimensions)===null||s===void 0?void 0:s.height;return iy(t.source===re.Source.ScreenShare,l,c,n)}function sj(t,e,n,r){const i=aj(t,e,n);let{encoding:o}=i[0];const s=Math.max(e,n);for(let a=0;a<i.length;a+=1){const l=i[a];if(o=l.encoding,l.width>=s)break}if(r)switch(r){case"av1":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.7;break;case"vp9":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.85;break}return o}function aj(t,e,n){if(t)return tj;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?Qz:ej}function TS(t,e){if(t)return ij(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?nj:rj}function zm(t,e,n){const r=[];if(n.forEach((i,o)=>{if(o>=ry.length)return;const s=Math.min(t,e),l={rid:ry[o],scaleResolutionDownBy:Math.max(1,s/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(l.maxFramerate=i.encoding.maxFramerate);const c=Jc()||o===0;i.encoding.priority&&c&&(l.priority=i.encoding.priority,l.networkPriority=i.encoding.priority),r.push(l)}),Dl()&&ZD()==="ios"){let i;r.forEach(s=>{i?s.maxFramerate&&s.maxFramerate>i&&(i=s.maxFramerate):i=s.maxFramerate});let o=!0;r.forEach(s=>{var a;s.maxFramerate!=i&&(o&&(o=!1,et.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),et.info('Setting framerate of encoding "'.concat((a=s.rid)!==null&&a!==void 0?a:"",'" to ').concat(i)),s.maxFramerate=i)})}return r}function RS(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class e3{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const lj=5e3;class si extends Yc{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,re.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.monitorSender=()=>$(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}const s=new Map(o.map(a=>[a.rid,a]));if(this.prevStats){let a=0;s.forEach((l,c)=>{var u;const d=(u=this.prevStats)===null||u===void 0?void 0:u.get(c);a+=Hp(l,d)}),this._currentBitrate=a}this.prevStats=s}),this.senderLock=new Xi}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!_r())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Sx))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,r,i,o,s;return $(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var a=!0,l=ec(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0)o=c.value,a=!1,yield(s=o.sender)===null||s===void 0?void 0:s.replaceTrack(null)}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,r,i,o,s;return $(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var a=!0,l=ec(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0){o=c.value,a=!1;const u=o;yield(s=u.sender)===null||s===void 0?void 0:s.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return $(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===re.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return $(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===re.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return $(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var o;if(i.type==="outbound-rtp"){const s={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(o=i.rid)!==null&&o!==void 0?o:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},a=r.get(i.remoteId);a&&(s.jitter=a.jitter,s.packetsLost=a.packetsLost,s.roundTripTime=a.roundTripTime),n.push(s)}}),n})}setPublishingQuality(e){const n=[];for(let r=yn.LOW;r<=yn.HIGH;r+=1)n.push(new Hi({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(n)}setDeviceId(e){return $(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===ml(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||ml(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var n,r,i,o;return $(this,void 0,void 0,function*(){let s;if(e){const u=jp({video:e});typeof u.video!="boolean"&&(s=u.video)}yield this.restart(s);try{for(var a=!0,l=ec(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;a=!0){o=c.value,a=!1;const u=o;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,o,s,a,l,c;return $(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,e,n),!((l=this.processor)===null||l===void 0)&&l.processedTrack)try{for(var u=!0,d=ec(this.simulcastCodecs.values()),f;f=yield d.next(),i=f.done,!i;u=!0)a=f.value,u=!1,yield(c=a.sender)===null||c===void 0?void 0:c.replaceTrack(this.processor.processedTrack)}catch(h){o={error:h}}finally{try{!u&&!i&&(s=d.return)&&(yield s.call(d))}finally{if(o)throw o.error}}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},lj))}setPublishingCodecs(e){var n,r,i,o,s,a,l;return $(this,void 0,void 0,function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(n=!0,r=ec(e);i=yield r.next(),o=i.done,!o;n=!0){l=i.value,n=!1;const u=l;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(this.log.debug("try setPublishingCodec for ".concat(u.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const f of u.qualities)if(f.enabled){c.push(u.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(u.codec),this.logContext),yield _S(d.sender,d.encodings,u.qualities,this.senderLock,this.log,this.logContext))}}}catch(u){s={error:u}}finally{try{!n&&!o&&(a=r.return)&&(yield a.call(r))}finally{if(s)throw s.error}}return c})}setPublishingLayers(e){return $(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield _S(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return $(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),jD()&&this.isInBackground&&this.source===re.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function _S(t,e,n,r,i,o){return $(this,void 0,void 0,function*(){const s=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:t,qualities:n,senderEncodings:e}));try{const a=t.getParameters(),{encodings:l}=a;if(!l)return;if(l.length!==e.length){i.warn("cannot set publishing layers, encodings mismatch");return}let c=!1;!1&&l[0].scalabilityMode||l.forEach((d,f)=>{var h;let p=(h=d.rid)!==null&&h!==void 0?h:"";p===""&&(p="q");const m=t3(p),C=n.find(v=>v.quality===m);C&&d.active!==C.enabled&&(c=!0,d.active=C.enabled,i.debug("setting layer ".concat(C.quality," to ").concat(d.active?"enabled":"disabled"),o),Jc()&&(C.enabled?(d.scaleResolutionDownBy=e[f].scaleResolutionDownBy,d.maxBitrate=e[f].maxBitrate,d.maxFrameRate=e[f].maxFrameRate):(d.scaleResolutionDownBy=4,d.maxBitrate=10,d.maxFrameRate=2)))}),c&&(a.encodings=l,i.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:a.encodings})),yield t.setParameters(a))}finally{s()}})}function t3(t){switch(t){case"f":return yn.HIGH;case"h":return yn.MEDIUM;case"q":return yn.LOW;default:return yn.HIGH}}function DS(t,e,n,r){if(!n)return[new lr({quality:yn.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,o=new e3(i),s=[];for(let a=0;a<o.spatial;a+=1)s.push(new lr({quality:yn.HIGH-a,width:Math.ceil(t/Math.pow(2,a)),height:Math.ceil(e/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return s}return n.map(i=>{var o,s,a;const l=(o=i.scaleResolutionDownBy)!==null&&o!==void 0?o:1;let c=t3((s=i.rid)!==null&&s!==void 0?s:"");return new lr({quality:c,width:Math.ceil(t/l),height:Math.ceil(e/l),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class n3 extends re{constructor(e,n,r,i,o){super(e,r,o),this.sid=n,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?xe.Muted:xe.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(xe.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return $(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Sx))}}class vl extends n3{constructor(e,n,r,i,o,s){super(e,n,re.Kind.Audio,r,s),this.monitorReceiver=()=>$(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=Hp(a,this.prevStats)),this.prevStats=a}),this.audioContext=i,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;Dl()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Dl())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return $(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(ey(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&ey(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(xe.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(xe.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return $(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const jm=100;class wd extends n3{constructor(e,n,r,i,o){super(e,n,re.Kind.Video,r,o),this.elementInfos=[],this.monitorReceiver=()=>$(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=Hp(s,this.prevStats)),this.prevStats=s}),this.debouncedHandleResize=yx(()=>{this.updateDimensions()},jm),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?Tc(this._mediaStreamTrack,n):pc(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new cj(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return $(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(o=>{o.type==="inbound-rtp"?(r=o.codecId,n={type:"video",framesDecoded:o.framesDecoded,framesDropped:o.framesDropped,framesReceived:o.framesReceived,packetsReceived:o.packetsReceived,packetsLost:o.packetsLost,frameWidth:o.frameWidth,frameHeight:o.frameHeight,pliCount:o.pliCount,firCount:o.firCount,nackCount:o.nackCount,jitter:o.jitter,timestamp:o.timestamp,bytesReceived:o.bytesReceived,decoderImplementation:o.decoderImplementation}):o.type==="codec"&&i.set(o.id,o)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return $(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((a,l)=>Math.max(a,l.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,o=this.elementInfos.some(a=>a.pictureInPicture),s=this.elementInfos.some(a=>a.visible)&&!i||o;if(this.lastVisible!==s){if(!s&&Date.now()-r<jm){Bn.setTimeout(()=>{this.updateVisibility()},jm);return}this.lastVisible=s,this.emit(xe.VisibilityChanged,s,this)}}updateDimensions(){var e,n;let r=0,i=0;const o=this.getPixelDensity();for(const s of this.elementInfos){const a=s.width()*o,l=s.height()*o;a+l>r+i&&(r=a,i=l)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(xe.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?hS():n||(hS()>2?2:1)}}class cj{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:o,isIntersecting:s}=r;o===this.element&&(this.isIntersecting=s,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??PS(e),this.isPiP=_r()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=PS(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,gS().observe(this.element),pS().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,n;(e=gS())===null||e===void 0||e.unobserve(this.element),(n=pS())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function PS(t){let e=t.offsetTop,n=t.offsetLeft;const r=t.offsetWidth,i=t.offsetHeight,{hidden:o}=t,{opacity:s,display:a}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+i>window.pageYOffset&&n+r>window.pageXOffset&&!o&&(s!==""?parseFloat(s)>0:!0)&&a!=="none"}class qo extends jo.EventEmitter{constructor(e,n,r,i){var o;super(),this.metadataMuted=!1,this.encryption=Pn.NONE,this.log=et,this.handleMuted=()=>{this.emit(xe.Muted)},this.handleUnmuted=()=>{this.emit(xe.Unmuted)},this.log=Ms((o=i==null?void 0:i.loggerName)!==null&&o!==void 0?o:Lo.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=re.Source.Unknown}setTrack(e){this.track&&(this.track.off(xe.Muted,this.handleMuted),this.track.off(xe.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(xe.Muted,this.handleMuted),e.on(xe.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ot(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Pn.NONE}get audioTrack(){if(this.track instanceof br||this.track instanceof vl)return this.track}get videoTrack(){if(this.track instanceof si||this.track instanceof wd)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=re.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===re.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(qo||(qo={}));class af extends qo{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(xe.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(xe.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(xe.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return $(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return $(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return $(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return $(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var ci;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(ci||(ci={}));function uj(t){switch(t){case rs.EXCELLENT:return ci.Excellent;case rs.GOOD:return ci.Good;case rs.POOR:return ci.Poor;case rs.LOST:return ci.Lost;default:return ci.Unknown}}class r3 extends jo.EventEmitter{get logContext(){var e,n;return Object.assign(Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,n;return(n=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&n!==void 0?n:!1}constructor(e,n,r,i,o){var s;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=ci.Unknown,this.log=et,this.log=Ms((s=o==null?void 0:o.loggerName)!==null&&s!==void 0?s:Lo.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,n]of this.tracks)if(n.source===e)return n}getTrackByName(e){for(const[,n]of this.tracks)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrack(re.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrack(re.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(re.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(de.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(de.ParticipantNameChanged,e)}setPermissions(e){var n,r,i,o,s;const a=this.permissions,l=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((o=this.permissions)===null||o===void 0?void 0:o.hidden)||e.recorder!==((s=this.permissions)===null||s===void 0?void 0:s.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((c,u)=>{var d;return c!==((d=this.permissions)===null||d===void 0?void 0:d.canPublishSources[u])});return this.permissions=e,l&&this.emit(de.ParticipantPermissionsChanged,a),l}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(de.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=uj(e),n!==this._connectionQuality&&this.emit(de.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(n=>(n.track instanceof vl||n.track instanceof br)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(xe.Muted,()=>{this.emit(de.TrackMuted,e)}),e.on(xe.Unmuted,()=>{this.emit(de.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case re.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case re.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function dj(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new To({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}class kx extends qo{constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=yn.HIGH,this.handleEnded=o=>{this.setTrack(void 0),this.emit(xe.Ended,o)},this.handleVisibilityChange=o=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(o),this.logContext),this.disabled=!o,this.emitTrackUpdate()},this.handleVideoDimensionsChange=o=>{this.log.debug("adaptivestream video dimensions ".concat(o.width,"x").concat(o.height),this.logContext),this.videoDimensions=o,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new hi({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new yo({participantSid:"",trackSids:[this.trackSid]})]});this.emit(xe.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?qo.SubscriptionStatus.Unsubscribed:super.isSubscribed?qo.SubscriptionStatus.Subscribed:qo.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?qo.PermissionStatus.Allowed:qo.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof wd&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof wd&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(xe.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(xe.VisibilityChanged,this.handleVisibilityChange),i.off(xe.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(xe.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(xe.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(xe.VisibilityChanged,this.handleVisibilityChange),e.on(xe.Ended,this.handleEnded),this.emit(xe.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(xe.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?xe.Muted:xe.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(xe.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(xe.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===re.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof wd&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new wo({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=yn.HIGH,this.emit(xe.UpdateSettings,e)}}class lf extends r3{static fromParticipantInfo(e,n){return new lf(e,n.sid,n.identity,n.name,n.metadata)}constructor(e,n,r,i,o,s){super(n,r||"",i,o,s),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(xe.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),Ot(e))),this.signalClient.sendUpdateTrackSettings(n)}),e.on(xe.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(xe.SubscriptionPermissionChanged,n=>{this.emit(de.TrackSubscriptionPermissionChanged,e,n)}),e.on(xe.SubscriptionStatusChanged,n=>{this.emit(de.TrackSubscriptionStatusChanged,e,n)}),e.on(xe.Subscribed,n=>{this.emit(de.TrackSubscribed,n,e)}),e.on(xe.Unsubscribed,n=>{this.emit(de.TrackUnsubscribed,n,e)}),e.on(xe.SubscriptionFailed,n=>{this.emit(de.TrackSubscriptionFailed,e.trackSid,n)})}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:re.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrack(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:re.Source.Microphone;const n=this.getTrack(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,o,s){let a=this.getTrackPublication(n);if(a||n.startsWith("TR")||this.tracks.forEach(u=>{!a&&e.kind===u.kind.toString()&&(a=u)}),!a){if(s===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(de.TrackSubscriptionFailed,n);return}s===void 0&&(s=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,o,s-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Ot(a))),this.emit(de.TrackSubscriptionFailed,n);return}const l=e.kind==="video";let c;return l?c=new wd(e,n,i,o):c=new vl(e,n,i,this.audioContext,this.audioOutput),c.source=a.source,c.isMuted=a.isMuted,c.setMediaStream(r),c.start(),a.setTrack(c),this.volumeMap.has(a.source)&&c instanceof vl&&c.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var o,s;let a=this.getTrackPublication(i.sid);if(a)a.updateInfo(i);else{const l=re.kindFromProto(i.type);if(!l)return;a=new kx(l,i,(o=this.signalClient.connectOptions)===null||o===void 0?void 0:o.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(s=this.loggerOptions)===null||s===void 0?void 0:s.loggerName}),a.updateInfo(i),r.set(i.sid,a);const c=Array.from(this.tracks.values()).find(u=>u.source===(a==null?void 0:a.source));c&&a.source!==re.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Ot(c),newTrack:Ot(a)})),this.addTrackPublication(a)}n.set(i.sid,a)}),this.tracks.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Ot(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(de.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.tracks.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(e),r.kind){case re.Kind.Audio:this.audioTracks.delete(e);break;case re.Kind.Video:this.videoTracks.delete(e);break}n&&this.emit(de.TrackUnpublished,r)}setAudioOutput(e){return $(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTracks.forEach(r=>{var i;r.track instanceof vl&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}class oy extends r3{constructor(e,n,r,i){super(e,n,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Pn.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new $D)},this.handleReconnected=()=>{var o,s;(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.resolve)===null||s===void 0||s.call(o),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var o,s;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>this.log.warn(a.message,this.logContext)),(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.reject)===null||s===void 0||s.call(o,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(o=>dj(o)))},this.onTrackUnmuted=o=>{this.onTrackMuted(o,o.isUpstreamPaused)},this.onTrackMuted=(o,s)=>{if(s===void 0&&(s=!0),!o.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Ot(o)));return}this.engine.updateMuteStatus(o.sid,s)},this.onTrackUpstreamPaused=o=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Ot(o))),this.onTrackMuted(o,!0)},this.onTrackUpstreamResumed=o=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Ot(o))),this.onTrackMuted(o,o.isMuted)},this.handleSubscribedQualityUpdate=o=>$(this,void 0,void 0,function*(){var s,a,l,c,u,d;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const f=this.videoTracks.get(o.trackSid);if(!f){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}if(o.subscribedCodecs.length>0){if(!f.videoTrack)return;const C=yield f.videoTrack.setPublishingCodecs(o.subscribedCodecs);try{for(var h=!0,p=ec(C),m;m=yield p.next(),s=m.done,!s;h=!0){c=m.value,h=!1;const v=c;dz(v)&&(this.log.debug("publish ".concat(v," for ").concat(f.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Ot(f))),yield this.publishAdditionalCodecForTrack(f.videoTrack,v,f.options))}}catch(v){a={error:v}}finally{try{!h&&!s&&(l=p.return)&&(yield l.call(p))}finally{if(a)throw a.error}}}else o.subscribedQualities.length>0&&(yield(d=f.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(o.subscribedQualities))}),this.handleLocalTrackUnpublished=o=>{const s=this.tracks.get(o.trackSid);if(!s){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}this.unpublishTrack(s.track)},this.handleTrackEnded=o=>$(this,void 0,void 0,function*(){if(o.source===re.Source.ScreenShare||o.source===re.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Ot(o))),this.unpublishTrack(o);else if(o.isUserProvided)yield o.mute();else if(o instanceof br||o instanceof si)try{if(_r())try{const s=yield navigator==null?void 0:navigator.permissions.query({name:o.source===re.Source.Camera?"camera":"microphone"});if(s&&s.state==="denied")throw this.log.warn("user has revoked access to ".concat(o.source),Object.assign(Object.assign({},this.logContext),Ot(o))),s.onchange=()=>{s.state!=="denied"&&(o.isMuted||o.restartTrack(),s.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}o.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Ot(o))),yield o.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Ot(o))),yield o.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Pn.NONE}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(Te.RemoteMute,(n,r)=>{const i=this.tracks.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(Te.Connected,this.handleReconnected).on(Te.SignalRestarted,this.handleReconnected).on(Te.SignalResumed,this.handleReconnected).on(Te.Restarting,this.handleReconnecting).on(Te.Resuming,this.handleReconnecting).on(Te.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Te.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Te.Disconnected,this.handleDisconnected)}setMetadata(e){var n;this.engine.client.sendUpdateLocalMetadata(e,(n=this.name)!==null&&n!==void 0?n:"")}setName(e){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",e)}setCameraEnabled(e,n,r){return this.setTrackEnabled(re.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(re.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(re.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(de.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return $(this,void 0,void 0,function*(){this.encryptionType=e?Pn.GCM:Pn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){var o,s;return $(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n}));let a=this.getTrack(e);if(n)if(a)yield a.unmute();else{let l;if(this.pendingPublishing.has(e)){this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:e}));return}this.pendingPublishing.add(e);try{switch(e){case re.Source.Camera:l=yield this.createTracks({video:(o=r)!==null&&o!==void 0?o:!0});break;case re.Source.Microphone:l=yield this.createTracks({audio:(s=r)!==null&&s!==void 0?s:!0});break;case re.Source.ScreenShare:l=yield this.createScreenTracks(Object.assign({},r));break;default:throw new fo(e)}const c=[];for(const d of l)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Ot(d))),c.push(this.publishTrack(d,i));[a]=yield Promise.all(c)}catch(c){throw l==null||l.forEach(u=>{u.stop()}),c instanceof Error&&!(c instanceof fo)&&this.emit(de.MediaDevicesError,c),c}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===re.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const l=this.getTrack(re.Source.ScreenShareAudio);l&&l.track&&this.unpublishTrack(l.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return $(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(re.Source.Camera)||this.pendingPublishing.has(re.Source.Microphone))){this.pendingPublishing.add(re.Source.Camera),this.pendingPublishing.add(re.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(re.Source.Camera),this.pendingPublishing.delete(re.Source.Microphone)}}})}createTracks(e){var n,r;return $(this,void 0,void 0,function*(){const i=WD(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),o=jp(i);let s;try{s=yield navigator.mediaDevices.getUserMedia(o)}catch(a){throw a instanceof Error&&(o.audio&&(this.microphoneError=a),o.video&&(this.cameraError=a)),a}return o.audio&&(this.microphoneError=void 0,this.emit(de.AudioStreamAcquired)),o.video&&(this.cameraError=void 0),s.getTracks().map(a=>{const l=a.kind==="audio";l?e.audio:e.video;let c;const u=l?o.audio:o.video;typeof u!="boolean"&&(c=u);const d=QD(a,c,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return d.kind===re.Kind.Video?d.source=re.Source.Camera:d.kind===re.Kind.Audio&&(d.source=re.Source.Microphone),d.mediaStream=s,d})})}createScreenTracks(e){return $(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new Cx("getDisplayMedia not supported");e.resolution===void 0&&!Sz()&&(e.resolution=xx.h1080fps30.resolution);const n=mz(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new fo("no video track found");const o=new si(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=re.Source.ScreenShare,e.contentHint&&(o.mediaStreamTrack.contentHint=e.contentHint);const s=[o];if(r.getAudioTracks().length>0){this.emit(de.AudioStreamAcquired);const a=new br(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=re.Source.ScreenShareAudio,s.push(a)}return s})}publishTrack(e,n){var r,i,o,s;return $(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,e instanceof Yc&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let a;if(e instanceof MediaStreamTrack)a=e.getConstraints();else{a=e.constraints;let h;switch(e.source){case re.Source.Microphone:h="audioinput";break;case re.Source.Camera:h="videoinput"}h&&this.activeDeviceMap.has(h)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(h)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new br(e,a,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":e=new si(e,a,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new fo("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e instanceof br&&e.setAudioContext(this.audioContext);let l;if(this.tracks.forEach(h=>{h.track&&h.track===e&&(l=h)}),l)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),Ot(l))),l;const c="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,u=(i=n==null?void 0:n.forceStereo)!==null&&i!==void 0?i:c;u&&(n||(n={}),n.dtx===void 0&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),Ot(e))),n.red===void 0&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(o=n.dtx)!==null&&o!==void 0||(n.dtx=!1),(s=n.red)!==null&&s!==void 0||(n.red=!1));const d=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);_l()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),d.simulcast=!1),d.source&&(e.source=d.source);const f=this.publish(e,d,u);this.pendingPublishPromises.set(e,f);try{return yield f}catch(h){throw h}finally{this.pendingPublishPromises.delete(e)}})}publish(e,n,r){var i,o,s,a,l,c,u,d,f,h,p,m,C;return $(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(k=>e instanceof Yc&&k.source===e.source)&&e.source!==re.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Ot(e))),n.stopMicTrackOnMute&&e instanceof br&&(e.stopOnMute=!0),e.source===re.Source.ScreenShare&&Jc()&&(n.simulcast=!1),n.videoCodec==="av1"&&!xz()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!Iz()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=ny);const g=n.videoCodec;e.on(xe.Muted,this.onTrackMuted),e.on(xe.Unmuted,this.onTrackUnmuted),e.on(xe.Ended,this.handleTrackEnded),e.on(xe.UpstreamPaused,this.onTrackUpstreamPaused),e.on(xe.UpstreamResumed,this.onTrackUpstreamResumed);const y=new Gi({cid:e.mediaStreamTrack.id,name:n.name,type:re.kindToProto(e.kind),muted:e.isMuted,source:re.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((o=n.red)!==null&&o!==void 0)||o),stream:n==null?void 0:n.stream});let I;if(e.kind===re.Kind.Video){let k={width:0,height:0};try{k=yield e.waitForDimensions()}catch{const T=(a=(s=this.roomOptions.videoCaptureDefaults)===null||s===void 0?void 0:s.resolution)!==null&&a!==void 0?a:sf.h720.resolution;k={width:T.width,height:T.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Ot(e)),{dims:k}))}y.width=k.width,y.height=k.height,e instanceof si&&(bd(g)&&(e.source===re.Source.ScreenShare&&g==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(l=n.scalabilityMode)!==null&&l!==void 0?l:"L3T3_KEY"),y.simulcastCodecs=[new Vi({codec:g,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:ny}),n.backupCodec&&g!==n.backupCodec.codec&&y.encryption===Pn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),y.simulcastCodecs.push(new Vi({codec:n.backupCodec.codec,cid:""})))),I=iy(e.source===re.Source.ScreenShare,y.width,y.height,n),y.layers=DS(y.width,y.height,I,bd(n.videoCodec))}else e.kind===re.Kind.Audio&&(I=[{maxBitrate:(u=(c=n.audioPreset)===null||c===void 0?void 0:c.maxBitrate)!==null&&u!==void 0?u:n.audioBitrate,priority:(f=(d=n.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&f!==void 0?f:"high",networkPriority:(p=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new pn("cannot publish track when not connected");const b=yield this.engine.addTrack(y);let E;if(b.codecs.forEach(k=>{E===void 0&&(E=k.mimeType)}),E&&e.kind===re.Kind.Video){const k=zD(E);k!==g&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Ot(e)),{codec:k})),n.videoCodec=k,I=iy(e.source===re.Source.ScreenShare,y.width,y.height,n))}const w=new af(e.kind,b,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(w.options=n,e.sid=b.sid,!this.engine.pcManager)throw new pn("pcManager is not ready");if(this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:I,trackInfo:b})),e.sender=yield this.engine.createSender(e,n,I),I)if(Jc()&&e.kind===re.Kind.Audio){let k;for(const D of this.engine.pcManager.publisher.getTransceivers())if(D.sender===e.sender){k=D;break}k&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:k,codec:"opus",maxbr:!((m=I[0])===null||m===void 0)&&m.maxBitrate?I[0].maxBitrate/1e3:0})}else e.codec&&bd(e.codec)&&(!((C=I[0])===null||C===void 0)&&C.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:y.cid,codec:e.codec,maxbr:I[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof si?e.startMonitor(this.engine.client):e instanceof br&&e.startMonitor(),this.addTrackPublication(w),this.emit(de.LocalTrackPublished,w),w})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){var i;return $(this,void 0,void 0,function*(){if(this.encryptionType!==Pn.NONE)return;let o;if(this.tracks.forEach(d=>{d.track&&d.track===e&&(o=d)}),!o)throw new fo("track is not published");if(!(e instanceof si))throw new fo("track is not a video track");const s=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=oj(e,n,s);if(!a){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Ot(e)));return}const l=e.addSimulcastTrack(n,a),c=new Gi({cid:l.mediaStreamTrack.id,type:re.kindToProto(e.kind),muted:e.isMuted,source:re.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:s.videoCodec,cid:l.mediaStreamTrack.id}]});if(c.layers=DS(c.width,c.height,a),!this.engine||this.engine.isClosed)throw new pn("cannot publish track when not connected");const u=yield this.engine.addTrack(c);yield this.engine.createSimulcastSender(e,l,s,a),yield this.engine.negotiate(),this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:u}))})}unpublishTrack(e,n){var r,i;return $(this,void 0,void 0,function*(){const o=this.getPublicationForTrack(e),s=o?Ot(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),s)),!o||!o.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),s));return}e=o.track,e.off(xe.Muted,this.onTrackMuted),e.off(xe.Unmuted,this.onTrackUnmuted),e.off(xe.Ended,this.handleTrackEnded),e.off(xe.UpstreamPaused,this.onTrackUpstreamPaused),e.off(xe.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n&&e.stop();let a=!1;const l=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<mn.FAILED&&l)try{for(const c of this.engine.pcManager.publisher.getTransceivers())c.sender===l&&(c.direction="inactive",a=!0);if(this.engine.removeTrack(l)&&(a=!0),e instanceof si){for(const[,c]of e.simulcastCodecs)c.sender&&(this.engine.removeTrack(c.sender)&&(a=!0),c.sender=void 0);e.simulcastCodecs.clear()}}catch(c){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),s),{error:c}))}switch(this.tracks.delete(o.trackSid),o.kind){case re.Kind.Audio:this.audioTracks.delete(o.trackSid);break;case re.Kind.Video:this.videoTracks.delete(o.trackSid);break}return this.emit(de.LocalTrackUnpublished,o),o.setTrack(void 0),a&&(yield this.engine.negotiate()),o})}unpublishTracks(e){return $(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof af)})}republishAllTracks(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return $(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(e&&(i.options=Object.assign(Object.assign({},i.options),e)),r.push(i))}),yield Promise.all(r.map(i=>$(this,void 0,void 0,function*(){const o=i.track;yield this.unpublishTrack(o,!1),n&&!o.isMuted&&o.source!==re.Source.ScreenShare&&o.source!==re.Source.ScreenShareAudio&&(o instanceof br||o instanceof si)&&!o.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:i.trackSid})),yield o.restartTrack()),yield this.publishTrack(o,i.options)})))})}publishData(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return $(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,o=[],s=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(l=>{l instanceof lf?o.push(l.sid):o.push(l)});const a=new mo({kind:n,value:{case:"user",value:new Co({participantSid:this.sid,payload:e,destinationSids:o,topic:s})}});yield this.engine.sendDataPacket(a,n)})}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const o=this.tracks.get(n.sid);if(o){const s=o.isMuted||((i=(r=o.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);s!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Ot(o)),{mutedOnServer:s})),this.engine.client.sendMuteTrack(n.sid,s))}}),!0)}getPublicationForTrack(e){let n;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof br||i instanceof si)&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}}var ft;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting"})(ft||(ft={}));const fj=2*1e3;class ep extends jo.EventEmitter{constructor(e){var n,r,i;super(),n=this,this.state=ft.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=et,this.bufferedEvents=[],this.connect=(o,s,a)=>$(this,void 0,void 0,function*(){var l;const c=yield this.disconnectLock.lock();if(this.state===ft.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),c(),Promise.resolve();if(this.connectFuture)return c(),this.connectFuture.promise;this.setAndEmitConnectionState(ft.Connecting),((l=this.regionUrlProvider)===null||l===void 0?void 0:l.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),ty(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new ES(o,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().catch(f=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:f}))}));const u=(f,h,p)=>$(this,void 0,void 0,function*(){var m;this.abortController&&this.abortController.abort();const C=new AbortController;this.abortController=C,c==null||c();try{yield this.attemptConnection(p??o,s,a,C),this.abortController=void 0,f()}catch(v){if(this.regionUrlProvider&&v instanceof Rt&&v.reason!==3&&v.reason!==0){let g=null;try{g=yield this.regionUrlProvider.getNextBestRegionUrl((m=this.abortController)===null||m===void 0?void 0:m.signal)}catch(y){if(y instanceof Rt&&(y.status===401||y.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(y);return}}g?(this.log.info("Initial connection failed with ConnectionError: ".concat(v.message,". Retrying with another region: ").concat(g),this.logContext),yield u(f,h,g)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(v))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(v)}}),d=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new $D((f,h)=>{u(f,h,d)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,s,a,l,c,u)=>$(this,void 0,void 0,function*(){var d,f,h;const p=yield a.join(o,s,{autoSubscribe:l.autoSubscribe,publishOnly:l.publishOnly,adaptiveStream:typeof c.adaptiveStream=="object"?!0:c.adaptiveStream,maxRetries:l.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:l.websocketTimeout},u.signal);let m=p.serverInfo;if(m||(m={version:p.serverVersion,region:p.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(m).map(C=>{let[v,g]=C;return"".concat(v,": ").concat(g)}).join(", ")),{room:(d=p.room)===null||d===void 0?void 0:d.name,roomSid:(f=p.room)===null||f===void 0?void 0:f.sid,identity:(h=p.participant)===null||h===void 0?void 0:h.identity}),!p.serverVersion)throw new iz("unknown server version");return p.serverVersion==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),c.dynacast=!1),p}),this.applyJoinResponse=o=>{const s=o.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(o.sifTrailer)},this.attemptConnection=(o,s,a,l)=>$(this,void 0,void 0,function*(){var c,u;this.state===ft.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((c=this.regionUrlProvider)===null||c===void 0)&&c.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},wx),a),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const d=yield this.connectSignal(o,s,this.engine,this.connOptions,this.options,l);this.applyJoinResponse(d),this.setupLocalParticipantEvents(),this.emit(ue.SignalConnected)}catch(d){yield this.engine.close(),this.recreateEngine();const f=new Rt("could not establish signal connection");throw d instanceof Error&&(f.message="".concat(f.message,": ").concat(d.message)),d instanceof Rt&&(f.reason=d.reason,f.status=d.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:d})),f}if(l.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Rt("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,l)}catch(d){throw yield this.engine.close(),this.recreateEngine(),d}_r()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),_r()&&(document.addEventListener("freeze",this.onPageLeave),(u=navigator.mediaDevices)===null||u===void 0||u.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(ft.Connected),this.emit(ue.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return $(n,void 0,void 0,function*(){var s,a,l,c;const u=yield this.disconnectLock.lock();try{if(this.state===ft.Disconnected){this.log.debug("already disconnected",this.logContext);return}this.log.info("disconnect from room",Object.assign({},this.logContext)),(this.state===ft.Connecting||this.state===ft.Reconnecting)&&(this.log.warn("abort connection attempt",this.logContext),(s=this.abortController)===null||s===void 0||s.abort(),(l=(a=this.connectFuture)===null||a===void 0?void 0:a.reject)===null||l===void 0||l.call(a,new Rt("Client initiated disconnect")),this.connectFuture=void 0),!((c=this.engine)===null||c===void 0)&&c.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(o,Rs.CLIENT_INITIATED),this.engine=void 0}finally{u()}})},this.onPageLeave=()=>$(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>$(this,void 0,void 0,function*(){const o=[],s=Ls();if(s&&s.os==="iOS"){const a="livekit-dummy-audio-el";let l=document.getElementById(a);if(!l){l=document.createElement("audio"),l.id=a,l.autoplay=!0,l.hidden=!0;const c=Vm();c.enabled=!0;const u=new MediaStream([c]);l.srcObject=u,document.addEventListener("visibilitychange",()=>{l&&(l.srcObject=document.hidden?null:u,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(l),this.once(ue.Disconnected,()=>{l==null||l.remove(),l=null})}o.push(l)}this.participants.forEach(a=>{a.audioTracks.forEach(l=>{l.track&&l.track.attachedElements.forEach(c=>{o.push(c)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(a=>(a.muted=!1,a.play()))]),this.handleAudioPlaybackStarted()}catch(a){throw this.handleAudioPlaybackFailed(a),a}}),this.startVideo=()=>$(this,void 0,void 0,function*(){const o=[];for(const s of this.participants.values())s.videoTracks.forEach(a=>{var l;(l=a.track)===null||l===void 0||l.attachedElements.forEach(c=>{o.includes(c)||o.push(c)})});yield Promise.all(o.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const o of this.participants.values())this.handleParticipantDisconnected(o.sid,o);this.setAndEmitConnectionState(ft.Reconnecting)&&this.emit(ue.Reconnecting)},this.handleSignalRestarted=o=>$(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(s){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:s}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(ft.Connected),this.emit(ue.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const a=this.identityToSid.get(s.identity);a&&a!==s.sid&&this.handleParticipantDisconnected(a,this.participants.get(a));let l=this.participants.get(s.sid);const c=!l;s.state===Tl.DISCONNECTED?this.handleParticipantDisconnected(s.sid,l):(l=this.getOrCreateParticipant(s.sid,s),c||l.updateInfo(s))})},this.handleActiveSpeakersUpdate=o=>{const s=[],a={};o.forEach(l=>{if(a[l.sid]=!0,l.sid===this.localParticipant.sid)this.localParticipant.audioLevel=l.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const c=this.participants.get(l.sid);c&&(c.audioLevel=l.level,c.setIsSpeaking(!0),s.push(c))}}),a[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(l=>{a[l.sid]||(l.audioLevel=0,l.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(ue.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=o=>{const s=new Map;this.activeSpeakers.forEach(l=>{s.set(l.sid,l)}),o.forEach(l=>{let c=this.participants.get(l.sid);l.sid===this.localParticipant.sid&&(c=this.localParticipant),c&&(c.audioLevel=l.level,c.setIsSpeaking(l.active),l.active?s.set(l.sid,c):s.delete(l.sid))});const a=Array.from(s.values());a.sort((l,c)=>c.audioLevel-l.audioLevel),this.activeSpeakers=a,this.emitWhenConnected(ue.ActiveSpeakersChanged,a)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(s=>{const a=this.participants.get(s.participantSid);if(!a)return;const l=a.getTrackPublication(s.trackSid);!l||!l.track||(l.track.streamState=re.streamStateFromProto(s.state),a.emit(de.TrackStreamStateChanged,l,l.track.streamState),this.emitWhenConnected(ue.TrackStreamStateChanged,l,l.track.streamState,a))})},this.handleSubscriptionPermissionUpdate=o=>{const s=this.participants.get(o.participantSid);if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const s=Array.from(this.participants.values()).find(l=>l.tracks.has(o.trackSid));if(!s)return;const a=s.getTrackPublication(o.trackSid);a&&a.setSubscriptionError(o.err)},this.handleDataPacket=(o,s)=>{const a=this.participants.get(o.participantSid);this.emit(ue.DataReceived,o.payload,a,s,o.topic),a==null||a.emit(de.DataReceived,o.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ue.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ue.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ue.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ue.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>$(this,void 0,void 0,function*(){this.emit(ue.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const s=this.roomInfo;this.roomInfo=o,s&&s.metadata!==o.metadata&&this.emitWhenConnected(ue.RoomMetadataChanged,o.metadata),(s==null?void 0:s.activeRecording)!==o.activeRecording&&this.emitWhenConnected(ue.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const a=this.participants.get(s.participantSid);a&&a.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(ue.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(ue.ParticipantNameChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(ue.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(ue.TrackUnmuted,o,this.localParticipant)},this.onLocalTrackPublished=o=>$(this,void 0,void 0,function*(){var s;this.emit(ue.LocalTrackPublished,o,this.localParticipant),o.track instanceof br&&(yield o.track.checkForSilence())&&this.emit(ue.LocalAudioSilenceDetected,o);const a=yield(s=o.track)===null||s===void 0?void 0:s.getDeviceId(),l=gz(o.source);l&&a&&a!==this.localParticipant.activeDeviceMap.get(l)&&(this.localParticipant.activeDeviceMap.set(l,a),this.emit(ue.ActiveDeviceChanged,l,a))}),this.onLocalTrackUnpublished=o=>{this.emit(ue.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalConnectionQualityChanged=o=>{this.emit(ue.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(ue.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(ue.ParticipantPermissionsChanged,o,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},Xz),e),this.log=Ms((r=this.options.loggerName)!==null&&r!==void 0?r:Lo.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},YD),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},qD),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},$z),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Xi,this.localParticipant=new oy("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",ml(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",ml(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",ml(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return $(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new Nz(this.options.e2ee),this.e2eeManager.on(ya.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof oy&&(this.isE2EEEnabled=n),this.emit(ue.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(ya.EncryptionError,n=>this.emit(ue.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&n!==void 0?n:""}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new Yz(this.options),this.engine.on(Te.ParticipantUpdate,this.handleParticipantUpdates).on(Te.RoomUpdate,this.handleRoomUpdate).on(Te.SpeakersChanged,this.handleSpeakersChanged).on(Te.StreamStateChanged,this.handleStreamStateUpdate).on(Te.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Te.SubscriptionError,this.handleSubscriptionError).on(Te.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Te.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(Te.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Te.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Te.DataPacketReceived,this.handleDataPacket).on(Te.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(ft.Reconnecting)&&this.emit(ue.Reconnecting)}).on(Te.Resumed,()=>{this.setAndEmitConnectionState(ft.Connected),this.emit(ue.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()}).on(Te.SignalResumed,()=>{this.bufferedEvents=[],this.state===ft.Reconnecting&&this.sendSyncState()}).on(Te.Restarting,this.handleRestarting).on(Te.SignalRestarted,this.handleSignalRestarted).on(Te.DCBufferStatusChanged,(e,n)=>{this.emit(ue.DCBufferStatusChanged,e,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return ir.getInstance().getDevices(e,n)}prepareConnection(e,n){return $(this,void 0,void 0,function*(){if(this.state===ft.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(ty(new URL(e))&&n){this.regionUrlProvider=new ES(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===ft.Disconnected&&(this.regionUrl=r,yield fetch(vS(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(vS(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const n=this.identityToSid.get(e);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return $(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new Dn({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new Dn({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new Dn({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new Dn({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>$(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Dn({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>$(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Dn({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new Dn({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>$(this,void 0,void 0,function*(){const o=this.engine.client.onLeave;o&&o(new pi({reason:Rs.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new Dn({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,n;return(n=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,o,s;return $(this,void 0,void 0,function*(){let a=!1,l=!0;const c=r?{exact:n}:n;if(e==="audioinput"){const u=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=c,a=u!==c;const d=Array.from(this.localParticipant.audioTracks.values()).filter(f=>f.source===re.Source.Microphone);try{l=(yield Promise.all(d.map(f=>{var h;return(h=f.audioTrack)===null||h===void 0?void 0:h.setDeviceId(c)}))).every(f=>f===!0)}catch(f){throw this.options.audioCaptureDefaults.deviceId=u,f}}else if(e==="videoinput"){const u=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=c,a=u!==c;const d=Array.from(this.localParticipant.videoTracks.values()).filter(f=>f.source===re.Source.Camera);try{l=(yield Promise.all(d.map(f=>{var h;return(h=f.videoTrack)===null||h===void 0?void 0:h.setDeviceId(c)}))).every(f=>f===!0)}catch(f){throw this.options.videoCaptureDefaults.deviceId=u,f}}else if(e==="audiooutput"){if(!ey()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(s=this.options).audioOutput)!==null&&i!==void 0||(s.audioOutput={});const u=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,a=u!==c;try{this.options.expWebAudioMix?(o=this.audioContext)===null||o===void 0||o.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(d=>d.setAudioOutput({deviceId:n})))}catch(d){throw this.options.audioOutput.deviceId=u,d}}return a&&l&&(this.localParticipant.activeDeviceMap.set(e,n),this.emit(ue.ActiveDeviceChanged,e,n)),l})}setupLocalParticipantEvents(){this.localParticipant.on(de.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(de.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(de.TrackMuted,this.onLocalTrackMuted).on(de.TrackUnmuted,this.onLocalTrackUnmuted).on(de.LocalTrackPublished,this.onLocalTrackPublished).on(de.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(de.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(de.MediaDevicesError,this.onMediaDevicesError).on(de.AudioStreamAcquired,this.startAudio).on(de.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===ft.Connecting||this.state===ft.Reconnecting){const u=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(ue.Reconnected,u),this.off(ue.Connected,u),this.off(ue.Disconnected,d)};this.once(ue.Reconnected,u),this.once(ue.Connected,u),this.once(ue.Disconnected,d);return}if(this.state===ft.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const i=yz(n.id),o=i[0];let s=i[1],a=e.id;if(s&&s.startsWith("TR")&&(a=s),o===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const l=this.participants.get(o);if(!l){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);return}let c;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?c=this.options.adaptiveStream:c={}),l.addSubscribedMediaTrack(e,a,n,r,c)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==ft.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(o=>{i.unpublishTrack(o.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var o,s;i.track&&this.localParticipant.unpublishTrack(i.track,e),e&&((o=i.track)===null||o===void 0||o.detach(),(s=i.track)===null||s===void 0||s.stop())}),this.localParticipant.off(de.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(de.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(de.TrackMuted,this.onLocalTrackMuted).off(de.TrackUnmuted,this.onLocalTrackUnmuted).off(de.LocalTrackPublished,this.onLocalTrackPublished).off(de.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(de.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(de.MediaDevicesError,this.onMediaDevicesError).off(de.AudioStreamAcquired,this.startAudio).off(de.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),_r()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(ft.Disconnected),this.emit(ue.Disconnected,n)}}}handleParticipantDisconnected(e,n){this.participants.delete(e),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(ue.ParticipantDisconnected,n))}acquireAudioContext(){var e,n;return $(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=Ix())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(ue.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=lf.fromParticipantInfo(this.engine.client,n):i=new lf(this.engine.client,e,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),i}getOrCreateParticipant(e,n){if(this.participants.has(e))return this.participants.get(e);const r=this.createParticipant(e,n);return this.participants.set(e,r),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(ue.ParticipantConnected,r),r.on(de.TrackPublished,i=>{this.emitWhenConnected(ue.TrackPublished,i,r)}).on(de.TrackSubscribed,(i,o)=>{i.kind===re.Kind.Audio?(i.on(xe.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(xe.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===re.Kind.Video&&(i.on(xe.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(xe.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ue.TrackSubscribed,i,o,r)}).on(de.TrackUnpublished,i=>{this.emit(ue.TrackUnpublished,i,r)}).on(de.TrackUnsubscribed,(i,o)=>{this.emit(ue.TrackUnsubscribed,i,o,r)}).on(de.TrackSubscriptionFailed,i=>{this.emit(ue.TrackSubscriptionFailed,i,r)}).on(de.TrackMuted,i=>{this.emitWhenConnected(ue.TrackMuted,i,r)}).on(de.TrackUnmuted,i=>{this.emitWhenConnected(ue.TrackUnmuted,i,r)}).on(de.ParticipantMetadataChanged,i=>{this.emitWhenConnected(ue.ParticipantMetadataChanged,i,r)}).on(de.ParticipantNameChanged,i=>{this.emitWhenConnected(ue.ParticipantNameChanged,i,r)}).on(de.ConnectionQualityChanged,i=>{this.emitWhenConnected(ue.ConnectionQualityChanged,i,r)}).on(de.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(ue.ParticipantPermissionsChanged,i,r)}).on(de.TrackSubscriptionStatusChanged,(i,o)=>{this.emitWhenConnected(ue.TrackSubscriptionStatusChanged,i,o,r)}).on(de.TrackSubscriptionFailed,(i,o)=>{this.emit(ue.TrackSubscriptionFailed,i,r,o)}).on(de.TrackSubscriptionPermissionChanged,(i,o)=>{this.emitWhenConnected(ue.TrackSubscriptionPermissionChanged,i,o,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.participants.values())for(const n of e.videoTracks.values())n.isSubscribed&&n instanceof kx&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Bn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Rs.STATE_MISMATCH))):e=0},fj)}clearConnectionReconcile(){this.connectionReconcileInterval&&Bn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(ue.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.state===ft.Connected?this.emit(e,...r):(this.state===ft.Reconnecting&&this.bufferedEvents.push([e,r]),!1)}simulateParticipants(e){var n,r;return $(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new pu({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:je.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Jr({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ue.SignalConnected),this.emit(ue.Connected),this.setAndEmitConnectionState(ft.Connected),i.video){const s=new af(re.Kind.Video,new kr({source:tn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Xn.AUDIO,name:"video-dummy"}),new si(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:mS(160*((n=o.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(de.LocalTrackPublished,s)}if(i.audio){const s=new af(re.Kind.Audio,new kr({source:tn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Xn.AUDIO}),new br(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Vm(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(s),this.localParticipant.emit(de.LocalTrackPublished,s)}for(let s=0;s<o.count-1;s+=1){let a=new Jr({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(s),state:Tl.ACTIVE,tracks:[],joinedAt:je.parse(Date.now())});const l=this.getOrCreateParticipant(a.identity,a);if(o.video){const c=mS(160*((r=o.aspectRatios[s%o.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),u=new kr({source:tn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Xn.AUDIO});l.addSubscribedMediaTrack(c,u.sid,new MediaStream([c])),a.tracks=[...a.tracks,u]}if(o.audio){const c=Vm(),u=new kr({source:tn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Xn.AUDIO});l.addSubscribedMediaTrack(c,u.sid,new MediaStream([c])),a.tracks=[...a.tracks,u]}l.updateInfo(a)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(e!==ue.ActiveSpeakersChanged){const o=i3(r).filter(s=>s!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:o}))}return super.emit(e,...r)}}function i3(t){return t.map(e=>{if(e)return Array.isArray(e)?i3(e):typeof e=="object"?"logContext"in e&&e.logContext:e})}var Mi;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(Mi||(Mi={}));class mu extends jo.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Mi.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new ep(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return $(this,void 0,void 0,function*(){if(this.status!==Mi.IDLE)throw Error("check is running already");this.setStatus(Mi.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==Mi.SKIPPED&&this.setStatus(this.isSuccess()?Mi.SUCCESS:Mi.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return $(this,void 0,void 0,function*(){return this.room.state===ft.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return $(this,void 0,void 0,function*(){this.room&&this.room.state!==ft.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(Mi.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function o3(t){var e,n;return $(this,void 0,void 0,function*(){t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio=!0),(n=t.video)!==null&&n!==void 0||(t.video=!0);const r=WD(t,YD,qD),i=jp(r),o=navigator.mediaDevices.getUserMedia(i);t.audio&&(ir.userMediaPromiseMap.set("audioinput",o),o.catch(()=>ir.userMediaPromiseMap.delete("audioinput"))),t.video&&(ir.userMediaPromiseMap.set("videoinput",o),o.catch(()=>ir.userMediaPromiseMap.delete("videoinput")));const s=yield o;return s.getTracks().map(a=>{const l=a.kind==="audio";l?t.audio:t.video;let c;const u=l?i.audio:i.video;typeof u!="boolean"&&(c=u),c?c.deviceId=a.getSettings().deviceId:c={deviceId:a.getSettings().deviceId};const d=QD(a,c);return d.kind===re.Kind.Video?d.source=re.Source.Camera:d.kind===re.Kind.Audio&&(d.source=re.Source.Microphone),d.mediaStream=s,d})})}function hj(t){return $(this,void 0,void 0,function*(){return(yield o3({audio:!1,video:t}))[0]})}function pj(t){return $(this,void 0,void 0,function*(){return(yield o3({audio:t,video:!1}))[0]})}class gj extends mu{get description(){return"Can publish audio"}perform(){var e;return $(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield pj();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="audio"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," audio packets"))})}}class mj extends mu{get description(){return"Can publish video"}perform(){var e;return $(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield hj();n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(s=>{s.type==="outbound-rtp"&&s.mediaType==="video"&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," video packets"))})}}class vj extends mu{get description(){return"Resuming connection after interruption"}perform(){var e;return $(this,void 0,void 0,function*(){const n=yield this.connect();let r=!1,i=!1,o;const s=new Promise(l=>{setTimeout(l,5e3),o=l});n.on(ue.Reconnecting,()=>{r=!0}).on(ue.Reconnected,()=>{i=!0,o(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const a=n.engine.client.onClose;if(a&&a(""),yield s,r){if(!i||n.state!==ft.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class Cj extends mu{get description(){return"Can connect via TURN"}perform(){var e,n;return $(this,void 0,void 0,function*(){const r=new Ax,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let o=!1,s=!1,a=!1;for(let l of i.iceServers)for(let c of l.urls)c.startsWith("turn:")?(s=!0,a=!0):c.startsWith("turns:")&&(s=!0,a=!0,o=!0),c.startsWith("stun:")&&(a=!0);a?s&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||s?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(l=>setTimeout(l,0)))})}}class yj extends mu{get description(){return"Establishing WebRTC connection"}perform(){return $(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(ue.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,o)=>{if(i.candidate){const s=new RTCIceCandidate(i);let a="".concat(s.protocol," ").concat(s.address,":").concat(s.port," ").concat(s.type);s.address&&(xj(s.address)?a+=" (private)":s.protocol==="tcp"&&s.tcpType==="passive"?(e=!0,a+=" (passive)"):s.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,o)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),et.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function xj(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class Ij extends mu{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,n,r;return $(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new Ax;const o=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(o.serverVersion,".")),((e=o.serverInfo)===null||e===void 0?void 0:e.edition)===Xc.Cloud&&(!((n=o.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=o.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class OJ extends jo.EventEmitter{constructor(e,n){super(),this.checkResults=new Map,this.url=e,this.token=n}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Mi.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==Mi.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return $(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token),i=s=>{this.updateCheck(n,s)};r.on("update",i);const o=yield r.run();return r.off("update",i),o})}checkWebsocket(){return $(this,void 0,void 0,function*(){return this.createAndRunCheck(Ij)})}checkWebRTC(){return $(this,void 0,void 0,function*(){return this.createAndRunCheck(yj)})}checkTURN(){return $(this,void 0,void 0,function*(){return this.createAndRunCheck(Cj)})}checkReconnect(){return $(this,void 0,void 0,function*(){return this.createAndRunCheck(vj)})}checkPublishAudio(){return $(this,void 0,void 0,function*(){return this.createAndRunCheck(gj)})}checkPublishVideo(){return $(this,void 0,void 0,function*(){return this.createAndRunCheck(mj)})}}function bj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=t instanceof Yc?t.mediaStreamTrack:t,i=r.getSettings();let o={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const s=i.facingMode;et.debug("rawFacingMode",{rawFacingMode:s}),s&&typeof s=="string"&&Sj(s)&&(o={facingMode:s,confidence:"high"})}if(["low","medium"].includes(o.confidence)){et.debug("Try to get facing mode from device label: (".concat(r.label,")"));const s=wj(r.label);s!==void 0&&(o=s)}return o}const NS=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),Aj=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function wj(t){var e;const n=t.trim().toLowerCase();if(n!=="")return NS.has(n)?NS.get(n):(e=Array.from(Aj.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||e===void 0?void 0:e[1]}function Sj(t){return t===void 0||["user","environment","left","right"].includes(t)}const sy=Math.min,_c=Math.max,tp=Math.round,Fo=t=>({x:t,y:t}),kj={left:"right",right:"left",bottom:"top",top:"bottom"},Ej={start:"end",end:"start"};function BS(t,e,n){return _c(t,sy(e,n))}function Zp(t,e){return typeof t=="function"?t(e):t}function Pl(t){return t.split("-")[0]}function $p(t){return t.split("-")[1]}function s3(t){return t==="x"?"y":"x"}function a3(t){return t==="y"?"height":"width"}function qc(t){return["top","bottom"].includes(Pl(t))?"y":"x"}function l3(t){return s3(qc(t))}function Tj(t,e,n){n===void 0&&(n=!1);const r=$p(t),i=l3(t),o=a3(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=np(s)),[s,np(s)]}function Rj(t){const e=np(t);return[ay(t),e,ay(e)]}function ay(t){return t.replace(/start|end/g,e=>Ej[e])}function _j(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function Dj(t,e,n,r){const i=$p(t);let o=_j(Pl(t),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(ay)))),o}function np(t){return t.replace(/left|right|bottom|top/g,e=>kj[e])}function Pj(t){return{top:0,right:0,bottom:0,left:0,...t}}function Nj(t){return typeof t!="number"?Pj(t):{top:t,right:t,bottom:t,left:t}}function rp(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function FS(t,e,n){let{reference:r,floating:i}=t;const o=qc(e),s=l3(e),a=a3(s),l=Pl(e),c=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[a]/2-i[a]/2;let h;switch(l){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-i.width,y:d};break;default:h={x:r.x,y:r.y}}switch($p(e)){case"start":h[s]-=f*(n&&c?-1:1);break;case"end":h[s]+=f*(n&&c?-1:1);break}return h}const Bj=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=FS(c,r,l),f=r,h={},p=0;for(let m=0;m<a.length;m++){const{name:C,fn:v}=a[m],{x:g,y,data:I,reset:b}=await v({x:u,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:h,rects:c,platform:s,elements:{reference:t,floating:e}});u=g??u,d=y??d,h={...h,[C]:{...h[C],...I}},b&&p<=50&&(p++,typeof b=="object"&&(b.placement&&(f=b.placement),b.rects&&(c=b.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):b.rects),{x:u,y:d}=FS(c,f,l)),m=-1)}return{x:u,y:d,placement:f,strategy:i,middlewareData:h}};async function c3(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=Zp(e,t),p=Nj(h),C=a[f?d==="floating"?"reference":"floating":d],v=rp(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(C)))==null||n?C:C.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),g=d==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,y=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),I=await(o.isElement==null?void 0:o.isElement(y))?await(o.getScale==null?void 0:o.getScale(y))||{x:1,y:1}:{x:1,y:1},b=rp(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:g,offsetParent:y,strategy:l}):g);return{top:(v.top-b.top+p.top)/I.y,bottom:(b.bottom-v.bottom+p.bottom)/I.y,left:(v.left-b.left+p.left)/I.x,right:(b.right-v.right+p.right)/I.x}}const Fj=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...C}=Zp(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const v=Pl(i),g=qc(a),y=Pl(a)===a,I=await(l.isRTL==null?void 0:l.isRTL(c.floating)),b=f||(y||!m?[np(a)]:Rj(a)),E=p!=="none";!f&&E&&b.push(...Dj(a,m,p,I));const w=[a,...b],k=await c3(e,C),D=[];let T=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&D.push(k[v]),d){const G=Tj(i,s,I);D.push(k[G[0]],k[G[1]])}if(T=[...T,{placement:i,overflows:D}],!D.every(G=>G<=0)){var R,P;const G=(((R=o.flip)==null?void 0:R.index)||0)+1,H=w[G];if(H)return{data:{index:G,overflows:T},reset:{placement:H}};let q=(P=T.filter(ie=>ie.overflows[0]<=0).sort((ie,Z)=>ie.overflows[1]-Z.overflows[1])[0])==null?void 0:P.placement;if(!q)switch(h){case"bestFit":{var M;const ie=(M=T.filter(Z=>{if(E){const Q=qc(Z.placement);return Q===g||Q==="y"}return!0}).map(Z=>[Z.placement,Z.overflows.filter(Q=>Q>0).reduce((Q,ne)=>Q+ne,0)]).sort((Z,Q)=>Z[1]-Q[1])[0])==null?void 0:M[0];ie&&(q=ie);break}case"initialPlacement":q=a;break}if(i!==q)return{reset:{placement:q}}}return{}}}};async function Oj(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=Pl(n),a=$p(n),l=qc(n)==="y",c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,d=Zp(e,t);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),l?{x:h*u,y:f*c}:{x:f*c,y:h*u}}const Mj=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=e,l=await Oj(e,t);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:s}}}}},Lj=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:C=>{let{x:v,y:g}=C;return{x:v,y:g}}},...l}=Zp(t,e),c={x:n,y:r},u=await c3(e,l),d=qc(Pl(i)),f=s3(d);let h=c[f],p=c[d];if(o){const C=f==="y"?"top":"left",v=f==="y"?"bottom":"right",g=h+u[C],y=h-u[v];h=BS(g,h,y)}if(s){const C=d==="y"?"top":"left",v=d==="y"?"bottom":"right",g=p+u[C],y=p-u[v];p=BS(g,p,y)}const m=a.fn({...e,[f]:h,[d]:p});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[f]:o,[d]:s}}}}}};function Xp(){return typeof window<"u"}function vu(t){return u3(t)?(t.nodeName||"").toLowerCase():"#document"}function qr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Ws(t){var e;return(e=(u3(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function u3(t){return Xp()?t instanceof Node||t instanceof qr(t).Node:!1}function qi(t){return Xp()?t instanceof Element||t instanceof qr(t).Element:!1}function Uo(t){return Xp()?t instanceof HTMLElement||t instanceof qr(t).HTMLElement:!1}function OS(t){return!Xp()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof qr(t).ShadowRoot}function Rf(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Qi(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function Uj(t){return["table","td","th"].includes(vu(t))}function Kp(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Ex(t){const e=Tx(),n=qi(t)?Qi(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Vj(t){let e=Ba(t);for(;Uo(e)&&!Qc(e);){if(Ex(e))return e;if(Kp(e))return null;e=Ba(e)}return null}function Tx(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Qc(t){return["html","body","#document"].includes(vu(t))}function Qi(t){return qr(t).getComputedStyle(t)}function Jp(t){return qi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ba(t){if(vu(t)==="html")return t;const e=t.assignedSlot||t.parentNode||OS(t)&&t.host||Ws(t);return OS(e)?e.host:e}function d3(t){const e=Ba(t);return Qc(e)?t.ownerDocument?t.ownerDocument.body:t.body:Uo(e)&&Rf(e)?e:d3(e)}function f3(t,e,n){var r;e===void 0&&(e=[]);const i=d3(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),s=qr(i);return o?(ly(s),e.concat(s,s.visualViewport||[],Rf(i)?i:[],[])):e.concat(i,f3(i,[]))}function ly(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function h3(t){const e=Qi(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Uo(t),o=i?t.offsetWidth:n,s=i?t.offsetHeight:r,a=tp(n)!==o||tp(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function p3(t){return qi(t)?t:t.contextElement}function Dc(t){const e=p3(t);if(!Uo(e))return Fo(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=h3(e);let s=(o?tp(n.width):n.width)/r,a=(o?tp(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const Gj=Fo(0);function g3(t){const e=qr(t);return!Tx()||!e.visualViewport?Gj:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Wj(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==qr(t)?!1:e}function cf(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=p3(t);let s=Fo(1);e&&(r?qi(r)&&(s=Dc(r)):s=Dc(t));const a=Wj(o,n,r)?g3(o):Fo(0);let l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const f=qr(o),h=r&&qi(r)?qr(r):r;let p=f,m=ly(p);for(;m&&r&&h!==p;){const C=Dc(m),v=m.getBoundingClientRect(),g=Qi(m),y=v.left+(m.clientLeft+parseFloat(g.paddingLeft))*C.x,I=v.top+(m.clientTop+parseFloat(g.paddingTop))*C.y;l*=C.x,c*=C.y,u*=C.x,d*=C.y,l+=y,c+=I,p=qr(m),m=ly(p)}}return rp({width:u,height:d,x:l,y:c})}function Rx(t,e){const n=Jp(t).scrollLeft;return e?e.left+n:cf(Ws(t)).left+n}function m3(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=r.left+e.scrollLeft-(n?0:Rx(t,r)),o=r.top+e.scrollTop;return{x:i,y:o}}function zj(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const o=i==="fixed",s=Ws(r),a=e?Kp(e.floating):!1;if(r===s||a&&o)return n;let l={scrollLeft:0,scrollTop:0},c=Fo(1);const u=Fo(0),d=Uo(r);if((d||!d&&!o)&&((vu(r)!=="body"||Rf(s))&&(l=Jp(r)),Uo(r))){const h=cf(r);c=Dc(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}const f=s&&!d&&!o?m3(s,l,!0):Fo(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:n.y*c.y-l.scrollTop*c.y+u.y+f.y}}function jj(t){return Array.from(t.getClientRects())}function Hj(t){const e=Ws(t),n=Jp(t),r=t.ownerDocument.body,i=_c(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=_c(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+Rx(t);const a=-n.scrollTop;return Qi(r).direction==="rtl"&&(s+=_c(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function Zj(t,e){const n=qr(t),r=Ws(t),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;const c=Tx();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}function $j(t,e){const n=cf(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=Uo(t)?Dc(t):Fo(1),s=t.clientWidth*o.x,a=t.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function MS(t,e,n){let r;if(e==="viewport")r=Zj(t,n);else if(e==="document")r=Hj(Ws(t));else if(qi(e))r=$j(e,n);else{const i=g3(t);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return rp(r)}function v3(t,e){const n=Ba(t);return n===e||!qi(n)||Qc(n)?!1:Qi(n).position==="fixed"||v3(n,e)}function Xj(t,e){const n=e.get(t);if(n)return n;let r=f3(t,[]).filter(a=>qi(a)&&vu(a)!=="body"),i=null;const o=Qi(t).position==="fixed";let s=o?Ba(t):t;for(;qi(s)&&!Qc(s);){const a=Qi(s),l=Ex(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Rf(s)&&!l&&v3(t,s))?r=r.filter(u=>u!==s):i=a,s=Ba(s)}return e.set(t,r),r}function Kj(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?Kp(e)?[]:Xj(e,this._c):[].concat(n),r],a=s[0],l=s.reduce((c,u)=>{const d=MS(e,u,i);return c.top=_c(d.top,c.top),c.right=sy(d.right,c.right),c.bottom=sy(d.bottom,c.bottom),c.left=_c(d.left,c.left),c},MS(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Jj(t){const{width:e,height:n}=h3(t);return{width:e,height:n}}function Yj(t,e,n){const r=Uo(e),i=Ws(e),o=n==="fixed",s=cf(t,!0,o,e);let a={scrollLeft:0,scrollTop:0};const l=Fo(0);if(r||!r&&!o)if((vu(e)!=="body"||Rf(i))&&(a=Jp(e)),r){const f=cf(e,!0,o,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else i&&(l.x=Rx(i));const c=i&&!r&&!o?m3(i,a):Fo(0),u=s.left+a.scrollLeft-l.x-c.x,d=s.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:s.width,height:s.height}}function Hm(t){return Qi(t).position==="static"}function LS(t,e){if(!Uo(t)||Qi(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Ws(t)===n&&(n=n.ownerDocument.body),n}function C3(t,e){const n=qr(t);if(Kp(t))return n;if(!Uo(t)){let i=Ba(t);for(;i&&!Qc(i);){if(qi(i)&&!Hm(i))return i;i=Ba(i)}return n}let r=LS(t,e);for(;r&&Uj(r)&&Hm(r);)r=LS(r,e);return r&&Qc(r)&&Hm(r)&&!Ex(r)?n:r||Vj(t)||n}const qj=async function(t){const e=this.getOffsetParent||C3,n=this.getDimensions,r=await n(t.floating);return{reference:Yj(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Qj(t){return Qi(t).direction==="rtl"}const eH={convertOffsetParentRelativeRectToViewportRelativeRect:zj,getDocumentElement:Ws,getClippingRect:Kj,getOffsetParent:C3,getElementRects:qj,getClientRects:jj,getDimensions:Jj,getScale:Dc,isElement:qi,isRTL:Qj},tH=Mj,nH=Lj,rH=Fj,iH=(t,e,n)=>{const r=new Map,i={platform:eH,...n},o={...i.platform,_c:r};return Bj(t,e,{...i,platform:o})};var y3={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(Ze,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},s=null;function a(m,C){var v=m[C];if(typeof v.bind=="function")return v.bind(m);try{return Function.prototype.bind.call(v,m)}catch{return function(){return Function.prototype.apply.apply(v,[m,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?l:console[m]!==void 0?a(console,m):console.log!==void 0?a(console,"log"):e}function u(){for(var m=this.getLevel(),C=0;C<i.length;C++){var v=i[C];this[v]=C<m?e:this.methodFactory(v,m,this.name)}if(this.log=this.debug,typeof console===n&&m<this.levels.SILENT)return"No console available for logging"}function d(m){return function(){typeof console!==n&&(u.call(this),this[m].apply(this,arguments))}}function f(m,C,v){return c(m)||d.apply(this,arguments)}function h(m,C){var v=this,g,y,I,b="loglevel";typeof m=="string"?b+=":"+m:typeof m=="symbol"&&(b=void 0);function E(R){var P=(i[R]||"silent").toUpperCase();if(!(typeof window===n||!b)){try{window.localStorage[b]=P;return}catch{}try{window.document.cookie=encodeURIComponent(b)+"="+P+";"}catch{}}}function w(){var R;if(!(typeof window===n||!b)){try{R=window.localStorage[b]}catch{}if(typeof R===n)try{var P=window.document.cookie,M=encodeURIComponent(b),G=P.indexOf(M+"=");G!==-1&&(R=/^([^;]+)/.exec(P.slice(G+M.length+1))[1])}catch{}return v.levels[R]===void 0&&(R=void 0),R}}function k(){if(!(typeof window===n||!b)){try{window.localStorage.removeItem(b)}catch{}try{window.document.cookie=encodeURIComponent(b)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function D(R){var P=R;if(typeof P=="string"&&v.levels[P.toUpperCase()]!==void 0&&(P=v.levels[P.toUpperCase()]),typeof P=="number"&&P>=0&&P<=v.levels.SILENT)return P;throw new TypeError("log.setLevel() called with invalid level: "+R)}v.name=m,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=C||f,v.getLevel=function(){return I??y??g},v.setLevel=function(R,P){return I=D(R),P!==!1&&E(I),u.call(v)},v.setDefaultLevel=function(R){y=D(R),w()||v.setLevel(R,!1)},v.resetLevel=function(){I=null,k(),u.call(v)},v.enableAll=function(R){v.setLevel(v.levels.TRACE,R)},v.disableAll=function(R){v.setLevel(v.levels.SILENT,R)},v.rebuild=function(){if(s!==v&&(g=D(s.getLevel())),u.call(v),s===v)for(var R in o)o[R].rebuild()},g=D(s?s.getLevel():"WARN");var T=w();T!=null&&(I=D(T)),u.call(v)}s=new h,s.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var v=o[C];return v||(v=o[C]=new h(C,s.methodFactory)),v};var p=typeof window!==n?window.log:void 0;return s.noConflict=function(){return typeof window!==n&&window.log===s&&(window.log=p),s},s.getLoggers=function(){return o},s.default=s,s})})(y3);var oH=y3.exports;const sH=eu(oH);function xn(t){return typeof t=="function"}function x3(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Zm=x3(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function cy(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Yp=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=Zc(s),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(m){e={error:m}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else s.remove(this);var u=this.initialTeardown;if(xn(u))try{u()}catch(m){o=m instanceof Zm?m.errors:[m]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=Zc(d),h=f.next();!h.done;h=f.next()){var p=h.value;try{US(p)}catch(m){o=o??[],m instanceof Zm?o=DC(DC([],_C(o)),_C(m.errors)):o.push(m)}}}catch(m){r={error:m}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(o)throw new Zm(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)US(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&cy(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&cy(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),I3=Yp.EMPTY;function b3(t){return t instanceof Yp||t&&"closed"in t&&xn(t.remove)&&xn(t.add)&&xn(t.unsubscribe)}function US(t){xn(t)?t():t.unsubscribe()}var aH={Promise:void 0},lH={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,DC([t,e],_C(n)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function A3(t){lH.setTimeout(function(){throw t})}function uy(){}function Qh(t){t()}var _x=function(t){hu(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,b3(n)&&n.add(r)):r.destination=dH,r}return e.create=function(n,r,i){return new dy(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Yp),cH=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){uh(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){uh(r)}else uh(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){uh(n)}},t}(),dy=function(t){hu(e,t);function e(n,r,i){var o=t.call(this)||this,s;return xn(n)||!n?s={next:n??void 0,error:r??void 0,complete:i??void 0}:s=n,o.destination=new cH(s),o}return e}(_x);function uh(t){A3(t)}function uH(t){throw t}var dH={closed:!0,next:uy,error:uH,complete:uy},Dx=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function w3(t){return t}function fH(t){return t.length===0?w3:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var Vn=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,o=pH(e)?e:new dy(e,n,r);return Qh(function(){var s=i,a=s.operator,l=s.source;o.add(a?a.call(o,l):l?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=VS(n),new n(function(i,o){var s=new dy({next:function(a){try{e(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:i});r.subscribe(s)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[Dx]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return fH(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=VS(e),new e(function(r,i){var o;n.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},t.create=function(e){return new t(e)},t}();function VS(t){var e;return(e=t??aH.Promise)!==null&&e!==void 0?e:Promise}function hH(t){return t&&xn(t.next)&&xn(t.error)&&xn(t.complete)}function pH(t){return t&&t instanceof _x||hH(t)&&b3(t)}function gH(t){return xn(t==null?void 0:t.lift)}function zs(t){return function(e){if(gH(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Nl(t,e,n,r,i){return new mH(t,e,n,r,i)}var mH=function(t){hu(e,t);function e(n,r,i,o,s,a){var l=t.call(this,n)||this;return l.onFinalize=s,l.shouldUnsubscribe=a,l._next=r?function(c){try{r(c)}catch(u){n.error(u)}}:t.prototype._next,l._error=o?function(c){try{o(c)}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=i?function(){try{i()}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(_x),vH=x3(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Fa=function(t){hu(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new GS(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new vH},e.prototype.next=function(n){var r=this;Qh(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var s=Zc(r.currentObservers),a=s.next();!a.done;a=s.next()){var l=a.value;l.next(n)}}catch(c){i={error:c}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;Qh(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;Qh(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,o=i.hasError,s=i.isStopped,a=i.observers;return o||s?I3:(this.currentObservers=null,a.push(n),new Yp(function(){r.currentObservers=null,cy(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,o=r.thrownError,s=r.isStopped;i?n.error(o):s&&n.complete()},e.prototype.asObservable=function(){var n=new Vn;return n.source=this,n},e.create=function(n,r){return new GS(n,r)},e}(Vn),GS=function(t){hu(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:I3},e}(Fa),S3=function(t){hu(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,o=n._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(Fa);function CH(t){return t&&xn(t.schedule)}function yH(t){return t[t.length-1]}function k3(t){return CH(yH(t))?t.pop():void 0}var E3=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function T3(t){return xn(t==null?void 0:t.then)}function R3(t){return xn(t[Dx])}function _3(t){return Symbol.asyncIterator&&xn(t==null?void 0:t[Symbol.asyncIterator])}function D3(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function xH(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var P3=xH();function N3(t){return xn(t==null?void 0:t[P3])}function B3(t){return DV(this,arguments,function(){var n,r,i,o;return u_(this,function(s){switch(s.label){case 0:n=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,Ac(n.read())];case 3:return r=s.sent(),i=r.value,o=r.done,o?[4,Ac(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,Ac(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function F3(t){return xn(t==null?void 0:t.getReader)}function Cu(t){if(t instanceof Vn)return t;if(t!=null){if(R3(t))return IH(t);if(E3(t))return bH(t);if(T3(t))return AH(t);if(_3(t))return O3(t);if(N3(t))return wH(t);if(F3(t))return SH(t)}throw D3(t)}function IH(t){return new Vn(function(e){var n=t[Dx]();if(xn(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function bH(t){return new Vn(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function AH(t){return new Vn(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,A3)})}function wH(t){return new Vn(function(e){var n,r;try{for(var i=Zc(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function O3(t){return new Vn(function(e){kH(t,e).catch(function(n){return e.error(n)})})}function SH(t){return O3(B3(t))}function kH(t,e){var n,r,i,o;return _V(this,void 0,void 0,function(){var s,a;return u_(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=PV(t),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(s=r.value,e.next(s),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),i={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Cl(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function M3(t,e){return e===void 0&&(e=0),zs(function(n,r){n.subscribe(Nl(r,function(i){return Cl(r,t,function(){return r.next(i)},e)},function(){return Cl(r,t,function(){return r.complete()},e)},function(i){return Cl(r,t,function(){return r.error(i)},e)}))})}function L3(t,e){return e===void 0&&(e=0),zs(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function EH(t,e){return Cu(t).pipe(L3(e),M3(e))}function TH(t,e){return Cu(t).pipe(L3(e),M3(e))}function RH(t,e){return new Vn(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function _H(t,e){return new Vn(function(n){var r;return Cl(n,e,function(){r=t[P3](),Cl(n,e,function(){var i,o,s;try{i=r.next(),o=i.value,s=i.done}catch(a){n.error(a);return}s?n.complete():n.next(o)},0,!0)}),function(){return xn(r==null?void 0:r.return)&&r.return()}})}function U3(t,e){if(!t)throw new Error("Iterable cannot be null");return new Vn(function(n){Cl(n,e,function(){var r=t[Symbol.asyncIterator]();Cl(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function DH(t,e){return U3(B3(t),e)}function PH(t,e){if(t!=null){if(R3(t))return EH(t,e);if(E3(t))return RH(t,e);if(T3(t))return TH(t,e);if(_3(t))return U3(t,e);if(N3(t))return _H(t,e);if(F3(t))return DH(t,e)}throw D3(t)}function NH(t,e){return e?PH(t,e):Cu(t)}function vr(t,e){return zs(function(n,r){var i=0;n.subscribe(Nl(r,function(o){r.next(t.call(e,o,i++))}))})}function BH(t,e,n,r,i,o,s,a){var l=[],c=0,u=0,d=!1,f=function(){d&&!l.length&&!c&&e.complete()},h=function(m){return c<r?p(m):l.push(m)},p=function(m){c++;var C=!1;Cu(n(m,u++)).subscribe(Nl(e,function(v){e.next(v)},function(){C=!0},void 0,function(){if(C)try{c--;for(var v=function(){var g=l.shift();s||p(g)};l.length&&c<r;)v();f()}catch(g){e.error(g)}}))};return t.subscribe(Nl(e,h,function(){d=!0,f()})),function(){}}function V3(t,e,n){return n===void 0&&(n=1/0),xn(e)?V3(function(r,i){return vr(function(o,s){return e(r,o,i,s)})(Cu(t(r,i)))},n):(typeof e=="number"&&(n=e),zs(function(r,i){return BH(r,i,t,n)}))}function FH(t){return V3(w3,t)}function OH(){return FH(1)}function fy(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return OH()(NH(t,k3(t)))}function G3(t,e){return zs(function(n,r){var i=0;n.subscribe(Nl(r,function(o){return t.call(e,o,i++)&&r.next(o)}))})}function MH(t,e,n,r,i){return function(o,s){var a=n,l=e,c=0;o.subscribe(Nl(s,function(u){var d=c++;l=a?t(l,u,d):(a=!0,u),s.next(l)},i))}}function LH(t){return zs(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function UH(t,e){return zs(MH(t,e,arguments.length>=2,!0))}function no(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=k3(t);return zs(function(r,i){(n?fy(t,r,n):fy(t,r)).subscribe(i)})}function WS(t){return zs(function(e,n){Cu(t).subscribe(Nl(n,function(){return n.complete()},uy)),!n.closed&&e.subscribe(n)})}var VH=Object.defineProperty,GH=Object.defineProperties,WH=Object.getOwnPropertyDescriptors,ip=Object.getOwnPropertySymbols,W3=Object.prototype.hasOwnProperty,z3=Object.prototype.propertyIsEnumerable,zS=(t,e,n)=>e in t?VH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hy=(t,e)=>{for(var n in e||(e={}))W3.call(e,n)&&zS(t,n,e[n]);if(ip)for(var n of ip(e))z3.call(e,n)&&zS(t,n,e[n]);return t},zH=(t,e)=>GH(t,WH(e)),jH=(t,e)=>{var n={};for(var r in t)W3.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&ip)for(var r of ip(t))e.indexOf(r)<0&&z3.call(t,r)&&(n[r]=t[r]);return n},js=(t,e,n)=>new Promise((r,i)=>{var o=l=>{try{a(n.next(l))}catch(c){i(c)}},s=l=>{try{a(n.throw(l))}catch(c){i(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,s);a((n=n.apply(t,e)).next())}),j3="lk";function Px(t){return typeof t>"u"?!1:HH(t)||ZH(t)}function HH(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function ZH(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function $H(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function H3(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if($H(t))return`${t.participant.identity}_${t.source}_placeholder`;if(Px(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function XH(t){return t instanceof oy}function KH(t,e){return js(this,null,function*(){const{x:n,y:r}=yield iH(t,e,{placement:"top",middleware:[tH(6),rH(),nH({padding:5})]});return{x:n,y:r}})}function JH(t,e){return!t.contains(e.target)}var YH=[ue.ConnectionStateChanged,ue.RoomMetadataChanged,ue.ActiveSpeakersChanged,ue.ConnectionQualityChanged,ue.ParticipantConnected,ue.ParticipantDisconnected,ue.ParticipantPermissionsChanged,ue.ParticipantMetadataChanged,ue.TrackMuted,ue.TrackUnmuted,ue.TrackPublished,ue.TrackUnpublished,ue.TrackStreamStateChanged,ue.TrackSubscriptionFailed,ue.TrackSubscriptionPermissionChanged,ue.TrackSubscriptionStatusChanged],qH=[...YH,ue.LocalTrackPublished,ue.LocalTrackUnpublished],QH=[de.ConnectionQualityChanged,de.IsSpeakingChanged,de.ParticipantMetadataChanged,de.ParticipantPermissionsChanged,de.TrackMuted,de.TrackUnmuted,de.TrackPublished,de.TrackUnpublished,de.TrackStreamStateChanged,de.TrackSubscriptionFailed,de.TrackSubscriptionPermissionChanged,de.TrackSubscriptionStatusChanged];[...QH,de.LocalTrackPublished,de.LocalTrackUnpublished];var vt=sH.getLogger("lk-components-js");vt.setDefaultLevel("WARN");function eZ(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var tZ=[],nZ={showChat:!1,unreadMessages:0};function Nx(t,...e){return new Vn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(no(t))}function Bx(t,e){return new Vn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function rZ(t){return Bx(t,ue.ConnectionStateChanged).pipe(vr(([e])=>e),no(t.state))}function iZ(t,e,n=!0){var r;const i=()=>js(this,null,function*(){try{const a=yield ep.getLocalDevices(t,n);o.next(a)}catch(a){e==null||e(a)}}),o=new Fa,s=o.pipe(LH(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return fy(ep.getLocalDevices(t,n).catch(a=>e==null?void 0:e(a)),s)}function oZ(t){return Bx(t,ue.DataReceived)}function sZ(t){return Nx(t,ue.AudioPlaybackStatusChanged).pipe(vr(n=>({canPlayAudio:n.canPlaybackAudio})))}function aZ(t){return Nx(t,ue.VideoPlaybackStatusChanged).pipe(vr(n=>({canPlayVideo:n.canPlaybackVideo})))}function lZ(t,e){return Bx(t,ue.ActiveDeviceChanged).pipe(G3(([n])=>n===e),vr(([n,r])=>(vt.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)),no(t.getActiveDevice(e)))}function yi(t){return`${j3}-${t}`}function cZ(t){const e=py(t),n=Ox(t.participant).pipe(vr(()=>py(t)),no(e));return{className:yi(t.source===re.Source.Camera||t.source===re.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function py(t){if(Px(t))return t.publication;{const{source:e,name:n,participant:r}=t;if(e&&n)return r.getTracks().find(i=>i.source===e&&i.trackName===n);if(n)return r.getTrackByName(n);if(e)return r.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function Fx(t,...e){return new Vn(r=>{const i=()=>{r.next(t)};return e.forEach(s=>{t.on(s,i)}),()=>{e.forEach(s=>{t.off(s,i)})}}).pipe(no(t))}function Ox(t){return Fx(t,de.TrackMuted,de.TrackUnmuted,de.ParticipantPermissionsChanged,de.TrackPublished,de.TrackUnpublished,de.LocalTrackPublished,de.LocalTrackUnpublished,de.MediaDevicesError,de.TrackSubscriptionStatusChanged).pipe(vr(n=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:o}=n,s=n.getTrack(re.Source.Microphone),a=n.getTrack(re.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:o,cameraTrack:a,microphoneTrack:s,participant:n}}))}function uZ(t){return Fx(t,de.ParticipantMetadataChanged).pipe(vr(({name:n,identity:r,metadata:i})=>({name:n,identity:r,metadata:i})),no({name:t.name,identity:t.identity,metadata:t.metadata}))}function dZ(t){return Mx(t,de.ConnectionQualityChanged).pipe(vr(([n])=>n),no(t.connectionQuality))}function Mx(t,e){return new Vn(r=>{const i=(...s)=>{r.next(s)};return t.on(e,i),()=>{t.off(e,i)}})}function Z3(t){var e,n,r,i;return Fx(t.participant,de.TrackMuted,de.TrackUnmuted,de.TrackSubscribed,de.TrackUnsubscribed,de.LocalTrackPublished,de.LocalTrackUnpublished).pipe(vr(o=>{var s,a;const l=(s=t.publication)!=null?s:o.getTrack(t.source);return(a=l==null?void 0:l.isMuted)!=null?a:!0}),no((i=(r=(e=t.publication)==null?void 0:e.isMuted)!=null?r:(n=t.participant.getTrack(t.source))==null?void 0:n.isMuted)!=null?i:!0))}function fZ(t){return Mx(t,de.IsSpeakingChanged).pipe(vr(([e])=>e))}function hZ(t,e={}){var n;let r;const i=new Vn(l=>(r=l,()=>a.unsubscribe())).pipe(no(Array.from(t.participants.values()))),o=(n=e.additionalRoomEvents)!=null?n:qH,s=Array.from(new Set([ue.ParticipantConnected,ue.ParticipantDisconnected,ue.ConnectionStateChanged,...o])),a=Nx(t,...s).subscribe(l=>r==null?void 0:r.next(Array.from(l.participants.values())));return t.participants.size>0&&(r==null||r.next(Array.from(t.participants.values()))),i}function pZ(t){return Mx(t,de.ParticipantPermissionsChanged).pipe(vr(()=>t.permissions),no(t.permissions))}function gZ(t,e,n){const{localParticipant:r}=e,i=(c,u)=>{let d=!1;switch(c){case re.Source.Camera:d=u.isCameraEnabled;break;case re.Source.Microphone:d=u.isMicrophoneEnabled;break;case re.Source.ScreenShare:d=u.isScreenShareEnabled;break}return d},o=Ox(r).pipe(vr(c=>i(t,c.participant)),no(i(t,r))),s=new Fa,a=(c,u)=>js(this,null,function*(){try{switch(u??(u=n),s.next(!0),t){case re.Source.Camera:yield r.setCameraEnabled(c??!r.isCameraEnabled,u);break;case re.Source.Microphone:yield r.setMicrophoneEnabled(c??!r.isMicrophoneEnabled,u);break;case re.Source.ScreenShare:yield r.setScreenShareEnabled(c??!r.isScreenShareEnabled,u);break;default:break}}finally{s.next(!1)}});return{className:yi("button"),toggle:a,enabledObserver:o,pendingObserver:s.asObservable()}}function mZ(){let t=!1;const e=new Fa,n=new Fa,r=o=>{n.next(!0),t=o??!t,e.next(t),n.next(!1)};return{className:yi("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function vZ(t,e,n){const r=new S3(void 0),i=e?lZ(e,t):r.asObservable(),o=(a,...l)=>js(this,[a,...l],function*(c,u={}){var d,f,h;if(e){vt.debug(`Switching active device of kind "${t}" with id ${c}.`),yield e.switchActiveDevice(t,c,u.exact);const p=(d=e.getActiveDevice(t))!=null?d:c;p!==c&&c!=="default"&&vt.info(`We tried to select the device with id (${c}), but the browser decided to select the device with id (${p}) instead.`);let m;t==="audioinput"?m=(f=e.localParticipant.getTrack(re.Source.Microphone))==null?void 0:f.track:t==="videoinput"&&(m=(h=e.localParticipant.getTrack(re.Source.Camera))==null?void 0:h.track);const C=c==="default"&&!m||c==="default"&&(m==null?void 0:m.mediaStreamTrack.label.startsWith("Default"));r.next(C?c:p)}else if(n){yield n.setDeviceId(u.exact?{exact:c}:c);const p=yield n.getDeviceId();r.next(c==="default"&&n.mediaStreamTrack.label.startsWith("Default")?c:p)}else r.value!==c&&(vt.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(c))});return{className:yi("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:o}}function CZ(t){const e=r=>{t.disconnect(r)};return{className:yi("disconnect-button"),disconnect:e}}function yZ(t){const e=yi("connection-quality"),n=dZ(t);return{className:e,connectionQualityObserver:n}}function xZ(t){let e="track-muted-indicator-camera";switch(t.source){case re.Source.Camera:e="track-muted-indicator-camera";break;case re.Source.Microphone:e="track-muted-indicator-microphone";break}const n=yi(e),r=Z3(t);return{className:n,mediaMutedObserver:r}}function IZ(t){return{className:"lk-participant-name",infoObserver:uZ(t)}}function bZ(){return{className:yi("participant-tile")}}var AZ={CHAT:"lk-chat-topic"};function $3(t,e,n){return js(this,arguments,function*(r,i,o,s={}){const{kind:a,destination:l}=s;yield r.publishData(i,a??gn.RELIABLE,{destination:l,topic:o})})}function wZ(t,e,n){const r=oZ(t).pipe(G3(([,,,a])=>e===void 0||a===e),vr(([a,l,,c])=>({payload:a,topic:c,from:l})));let i;const o=new Vn(a=>{i=a});return{messageObservable:r,isSendingObservable:o,send:(a,...l)=>js(this,[a,...l],function*(c,u={}){i.next(!0);try{yield $3(t.localParticipant,c,e,u)}finally{i.next(!1)}})}}var SZ=new TextEncoder,kZ=new TextDecoder,dh=new Map,EZ=t=>SZ.encode(JSON.stringify({message:t.message,timestamp:t.timestamp})),TZ=t=>JSON.parse(kZ.decode(t));function RZ(t,e){var n,r;const i=new Fa,{messageDecoder:o,messageEncoder:s,channelTopic:a}=e??{},l=a??AZ.CHAT;let c=!1;dh.has(t)||(c=!0);const u=(n=dh.get(t))!=null?n:new Map,d=(r=u.get(l))!=null?r:new Fa;if(u.set(l,d),dh.set(t,u),c){const{messageObservable:g}=wZ(t,l);g.pipe(WS(i)).subscribe(d)}const f=o??TZ,h=d.pipe(vr(g=>{const y=f(g.payload);return zH(hy({},y),{from:g.from})}),UH((g,y)=>[...g,y],[]),WS(i)),p=new S3(!1),m=s??EZ,C=g=>js(this,null,function*(){const y=Date.now(),I=m({message:g,timestamp:y});p.next(!0);try{yield $3(t.localParticipant,I,l,{kind:gn.RELIABLE}),d.next({payload:I,topic:l,from:t.localParticipant})}finally{p.next(!1)}});function v(){i.next(),i.complete(),dh.clear()}return t.once(ue.Disconnected,v),{messageObservable:h,isSendingObservable:p,send:C}}function _Z(){const t=n=>js(this,null,function*(){vt.info("Start Audio for room: ",n),yield n.startAudio()});return{className:yi("start-audio-button"),roomAudioPlaybackAllowedObservable:sZ,handleStartAudioPlayback:t}}function DZ(){const t=n=>js(this,null,function*(){vt.info("Start Video for room: ",n),yield n.startVideo()});return{className:yi("start-audio-button"),roomVideoPlaybackAllowedObservable:aZ,handleStartVideoPlayback:t}}function PZ(){return{className:[yi("button"),yi("chat-toggle")].join(" ")}}function NZ(){return{className:"lk-room-container"}}function BZ(t,e){if(typeof localStorage>"u"){vt.error("Local storage is not available.");return}try{localStorage.setItem(t,JSON.stringify(e))}catch(n){vt.error(`Error setting item to local storage: ${n}`)}}function FZ(t){if(typeof localStorage>"u"){vt.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){vt.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){vt.error(`Error getting item from local storage: ${e}`);return}}function OZ(t){return{load:()=>FZ(t),save:e=>BZ(t,e)}}var MZ=`${j3}-user-choices`,$a={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:LZ,save:UZ}=OZ(MZ);function VZ(t,e=!1){if(e===!0)return;const n=t,{e2ee:r,sharedPassphrase:i}=n,o=jH(n,["e2ee","sharedPassphrase"]);UZ(o)}function GZ(t,e=!1){var n,r,i,o,s,a,l;const c={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:$a.videoEnabled,audioEnabled:(r=t==null?void 0:t.audioEnabled)!=null?r:$a.audioEnabled,videoDeviceId:(i=t==null?void 0:t.videoDeviceId)!=null?i:$a.videoDeviceId,audioDeviceId:(o=t==null?void 0:t.audioDeviceId)!=null?o:$a.audioDeviceId,username:(s=t==null?void 0:t.username)!=null?s:$a.username,e2ee:(a=t==null?void 0:t.e2ee)!=null?a:$a.e2ee,sharedPassphrase:(l=t==null?void 0:t.sharedPassphrase)!=null?l:$a.sharedPassphrase};if(e)return c;{const u=LZ();return hy(hy({},c),u??{})}}function X3(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=X3(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function WZ(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=X3(t))&&(r&&(r+=" "),r+=e);return r}var zZ=Object.defineProperty,jZ=Object.defineProperties,HZ=Object.getOwnPropertyDescriptors,op=Object.getOwnPropertySymbols,K3=Object.prototype.hasOwnProperty,J3=Object.prototype.propertyIsEnumerable,jS=(t,e,n)=>e in t?zZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Me=(t,e)=>{for(var n in e||(e={}))K3.call(e,n)&&jS(t,n,e[n]);if(op)for(var n of op(e))J3.call(e,n)&&jS(t,n,e[n]);return t},Jn=(t,e)=>jZ(t,HZ(e)),Gn=(t,e)=>{var n={};for(var r in t)K3.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&op)for(var r of op(t))e.indexOf(r)<0&&J3.call(t,r)&&(n[r]=t[r]);return n},Y3=(t,e,n)=>new Promise((r,i)=>{var o=l=>{try{a(n.next(l))}catch(c){i(c)}},s=l=>{try{a(n.throw(l))}catch(c){i(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,s);a((n=n.apply(t,e)).next())});function ei(t,e){const[n,r]=S.useState(e);return S.useEffect(()=>{if(typeof window>"u"||!t)return;const i=t.subscribe(r);return()=>i.unsubscribe()},[t]),n}function ZZ(t){const e=o=>typeof window<"u"?window.matchMedia(o).matches:!1,[n,r]=S.useState(e(t));function i(){r(e(t))}return S.useEffect(()=>{const o=window.matchMedia(t);return i(),o.addListener?o.addListener(i):o.addEventListener("change",i),()=>{o.removeListener?o.removeListener(i):o.removeEventListener("change",i)}},[t]),n}function $Z(t,e){if(e.msg==="show_chat")return Jn(Me({},t),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return Jn(Me({},t),{showChat:!1});if(e.msg==="toggle_chat"){const n=Jn(Me({},t),{showChat:!t.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?Jn(Me({},t),{unreadMessages:e.count}):Me({},t)}function XZ(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:Me({},t)}var Lx=S.createContext(void 0);function KZ(){const t=S.useContext(Lx);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function JZ(t){const[e,n]=S.useReducer(XZ,tZ),[r,i]=S.useReducer($Z,nZ);return t??{pin:{dispatch:n,state:e},widget:{dispatch:i,state:r}}}function q3(){return S.useContext(Lx)}var YZ=S.createContext(void 0);function _f(){return S.useContext(YZ)}var Ux=S.createContext(void 0);function qp(){return S.useContext(Ux)}function Wl(t){var e;const n=qp(),r=_f(),i=(e=t??n)!=null?e:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var Vx=S.createContext(void 0);function Qp(){const t=S.useContext(Vx);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function eg(){return S.useContext(Vx)}function Df(t){const e=eg(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var qZ=S.createContext(void 0);function QZ(...t){return(...e)=>{for(const n of t)typeof n=="function"&&n(...e)}}function ja(...t){const e=Me({},t[0]);for(let n=1;n<t.length;n++){const r=t[n];for(const i in r){const o=e[i],s=r[i];typeof o=="function"&&typeof s=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=QZ(o,s):(i==="className"||i==="UNSAFE_className")&&typeof o=="string"&&typeof s=="string"?e[i]=WZ(o,s):e[i]=s!==void 0?s:o}}return e}function e$(t={}){const e=Wl(t.participant),{className:n,connectionQualityObserver:r}=S.useMemo(()=>yZ(e),[e]),i=ei(r,ci.Unknown);return{className:n,quality:i}}function t$(t){const e=Df(t),n=S.useMemo(()=>rZ(e),[e]);return ei(n,e.state)}function n$(t){const e=Qp(),n=t$(e);return{buttonProps:S.useMemo(()=>{const{className:i,disconnect:o}=CZ(e);return ja(t,{className:i,onClick:()=>{var a;return o((a=t.stopTracks)!=null?a:!0)},disabled:n===ft.Disconnected})},[e,t,n])}}function r$(t){if(t.publication instanceof af){const e=t.publication.track;if(e){const{facingMode:n}=bj(e);return n}}return"undefined"}function HS(t,e={}){var n,r;const i=typeof t=="string"?e.participant:t.participant,o=Wl(i),s=typeof t=="string"?{participant:o,source:t}:t,[a,l]=S.useState(!!((n=s.publication)!=null&&n.isMuted||(r=o.getTrack(s.source))!=null&&r.isMuted));return S.useEffect(()=>{const c=Z3(s).subscribe(l);return()=>c.unsubscribe()},[H3(s)]),a}function i$(t){const e=Wl(t),n=S.useMemo(()=>fZ(e),[e]);return ei(n,e.isSpeaking)}var o$={connect:!0,audio:!1,video:!1};function s$(t){const e=Me(Me({},o$),t),{token:n,serverUrl:r,options:i,room:o,connectOptions:s,connect:a,audio:l,video:c,screen:u,onConnected:d,onDisconnected:f,onError:h,onMediaDeviceFailure:p,onEncryptionError:m,simulateParticipants:C}=e,v=Gn(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&o&&vt.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[g,y]=S.useState();S.useEffect(()=>{y(o??new ep(i))},[o]);const I=S.useMemo(()=>{const{className:b}=NZ();return ja(v,{className:b})},[v]);return S.useEffect(()=>{if(!g)return;const b=()=>{const k=g.localParticipant;vt.debug("trying to publish local tracks"),Promise.all([k.setMicrophoneEnabled(!!l,typeof l!="boolean"?l:void 0),k.setCameraEnabled(!!c,typeof c!="boolean"?c:void 0),k.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(D=>{vt.warn(D),h==null||h(D)})},E=k=>{const D=of.getFailure(k);p==null||p(D)},w=k=>{m==null||m(k)};return g.on(ue.SignalConnected,b).on(ue.MediaDevicesError,E).on(ue.EncryptionError,w),()=>{g.off(ue.SignalConnected,b).off(ue.MediaDevicesError,E).off(ue.EncryptionError,w)}},[g,l,c,u,h,m,p]),S.useEffect(()=>{if(g){if(C){g.simulateParticipants({participants:{count:C},publish:{audio:!0,useRealTracks:!0}});return}if(!n){vt.debug("no token yet");return}if(!r){vt.warn("no livekit url provided"),h==null||h(Error("no livekit url provided"));return}a?(vt.debug("connecting"),g.connect(r,n,s).catch(b=>{vt.warn(b),h==null||h(b)})):(vt.debug("disconnecting because connect is false"),g.disconnect())}},[a,n,JSON.stringify(s),g,h,r,C]),S.useEffect(()=>{if(!g)return;const b=E=>{switch(E){case ft.Disconnected:f&&f();break;case ft.Connected:d&&d();break}};return g.on(ue.ConnectionStateChanged,b),()=>{g.off(ue.ConnectionStateChanged,b)}},[n,d,f,g]),S.useEffect(()=>{if(g)return()=>{vt.info("disconnecting on onmount"),g.disconnect()}},[g]),{room:g,htmlProps:I}}function a$(t={}){const e=Df(t.room),[n,r]=S.useState(e.localParticipant),[i,o]=S.useState(n.isMicrophoneEnabled),[s,a]=S.useState(n.isMicrophoneEnabled),[l,c]=S.useState(n.lastMicrophoneError),[u,d]=S.useState(n.lastCameraError),[f,h]=S.useState(n.isMicrophoneEnabled),[p,m]=S.useState(void 0),[C,v]=S.useState(void 0),g=y=>{a(y.isCameraEnabled),o(y.isMicrophoneEnabled),h(y.isScreenShareEnabled),v(y.cameraTrack),m(y.microphoneTrack),c(y.participant.lastMicrophoneError),d(y.participant.lastCameraError),r(y.participant)};return S.useEffect(()=>{const y=Ox(n).subscribe(g);return()=>y.unsubscribe()},[n]),{isMicrophoneEnabled:i,isScreenShareEnabled:f,isCameraEnabled:s,microphoneTrack:p,cameraTrack:C,lastMicrophoneError:l,lastCameraError:u,localParticipant:n}}function l$(){const t=Qp(),e=S.useMemo(()=>pZ(t.localParticipant),[t]);return ei(e,t.localParticipant.permissions)}function c$({kind:t,room:e,track:n,requestPermissions:r,onError:i}){const o=eg(),s=S.useMemo(()=>iZ(t,i,r),[t,r,i]),a=ei(s,[]),[l,c]=S.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:f}=S.useMemo(()=>vZ(t,e??o,n),[t,e,o,n]);return S.useEffect(()=>{const h=d.subscribe(p=>{vt.info("setCurrentDeviceId",p),p&&c(p)});return()=>{h==null||h.unsubscribe()}},[d]),{devices:a,className:u,activeDeviceId:l,setActiveMediaDevice:f}}function u$(t){return t!==void 0}function yu(...t){return ja(...t.filter(u$))}function Q3(t,e,n){return S.Children.map(t,r=>S.isValidElement(r)&&S.Children.only(t)?S.cloneElement(r,Jn(Me({},e),{key:n})):r)}function eP(t,e={}){var n;const[r,i]=S.useState(py(t)),[o,s]=S.useState(r==null?void 0:r.isMuted),[a,l]=S.useState(r==null?void 0:r.isSubscribed),[c,u]=S.useState(r==null?void 0:r.track),[d,f]=S.useState("landscape"),h=S.useRef(),{className:p,trackObserver:m}=S.useMemo(()=>cZ(t),[(n=t.participant.sid)!=null?n:t.participant.identity,t.source,Px(t)&&t.publication.trackSid]);return S.useEffect(()=>{const C=m.subscribe(v=>{vt.debug("update track",v),i(v),s(v==null?void 0:v.isMuted),l(v==null?void 0:v.isSubscribed),u(v==null?void 0:v.track)});return()=>C==null?void 0:C.unsubscribe()},[m]),S.useEffect(()=>{var C,v;return c&&(h.current&&c.detach(h.current),(C=e.element)!=null&&C.current&&!(XH(t.participant)&&(c==null?void 0:c.kind)==="audio")&&c.attach(e.element.current)),h.current=(v=e.element)==null?void 0:v.current,()=>{h.current&&(c==null||c.detach(h.current))}},[c,e.element]),S.useEffect(()=>{var C,v;if(typeof((C=r==null?void 0:r.dimensions)==null?void 0:C.width)=="number"&&typeof((v=r==null?void 0:r.dimensions)==null?void 0:v.height)=="number"){const g=r.dimensions.width>r.dimensions.height?"landscape":"portrait";f(g)}},[r]),{publication:r,isMuted:o,isSubscribed:a,track:c,elementProps:yu(e.props,Me({className:p,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":d}))}}function d$({trackRef:t,participant:e,source:n,publication:r,onParticipantClick:i,disableSpeakingIndicator:o,htmlProps:s}){const a=_f(),l=Wl(e),c=S.useMemo(()=>{var m,C,v,g,y,I;const b=(C=(m=t==null?void 0:t.source)!=null?m:a==null?void 0:a.source)!=null?C:n;if(b===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(g=(v=t==null?void 0:t.participant)!=null?v:a==null?void 0:a.participant)!=null?g:l,publication:(I=(y=t==null?void 0:t.publication)!=null?y:a==null?void 0:a.publication)!=null?I:r,source:b}},[t==null?void 0:t.participant,t==null?void 0:t.source,t==null?void 0:t.publication,a==null?void 0:a.participant,a==null?void 0:a.source,a==null?void 0:a.publication,l,n,r]),u=S.useMemo(()=>{const{className:m}=bZ();return ja(s,{className:m,onClick:C=>{var v,g;if((v=s.onClick)==null||v.call(s,C),typeof i=="function"){const y=(g=c.publication)!=null?g:c.participant.getTrack(c.source);i({participant:c.participant,track:y})}}})},[s,i,c.publication,c.source,c.participant]),d=HS(re.Source.Camera,{participant:c.participant}),f=HS(re.Source.Microphone,{participant:c.participant}),h=i$(c.participant),p=r$(c);return{elementProps:Me({"data-lk-audio-muted":f,"data-lk-video-muted":d,"data-lk-speaking":o===!0?!1:h,"data-lk-local-participant":c.participant.isLocal,"data-lk-source":c.source,"data-lk-facing-mode":p},u)}}function f$(t={}){const e=Df(t.room),[n,r]=S.useState([]);return S.useEffect(()=>{const i=hZ(e,{additionalRoomEvents:t.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[e,JSON.stringify(t.updateOnlyOn)]),n}function h$(t={}){const e=f$(t),{localParticipant:n}=a$(t);return[n,...e]}function p$({room:t,props:e}){const n=Df(t),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:o}=S.useMemo(()=>_Z(),[]),s=S.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=ei(s,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:S.useMemo(()=>ja(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayAudio:a}}function g$({room:t,props:e}){const n=Df(t),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:o}=S.useMemo(()=>DZ(),[]),s=S.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=ei(s,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:S.useMemo(()=>ja(e,{className:r,onClick:()=>{o(n)},style:{display:a?"none":"block"}}),[e,r,a,o,n]),canPlayVideo:a}}function m$({props:t}){const{dispatch:e,state:n}=KZ().widget,{className:r}=S.useMemo(()=>PZ(),[]);return{mergedProps:S.useMemo(()=>ja(t,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,r,e,n])}}function v$(t,e={}){var n,r,i,o;let s=_f();const a=(r=(n=qp())!=null?n:e.participant)!=null?r:s==null?void 0:s.participant;if(typeof t=="string"){if(!a)throw Error("Participant missing, either provide it via context or pass it in directly");s={participant:a,source:t}}else if(t)s=t;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:l,mediaMutedObserver:c}=S.useMemo(()=>xZ(s),[H3(s)]);return{isMuted:ei(c,!!((i=s.publication)!=null&&i.isMuted||(o=s.participant.getTrack(s.source))!=null&&o.isMuted)),className:l}}function C$(t){var e=t,{source:n,onChange:r,initialState:i,captureOptions:o}=e,s=Gn(e,["source","onChange","initialState","captureOptions"]),a;const l=eg(),c=(a=l==null?void 0:l.localParticipant)==null?void 0:a.getTrack(n),{toggle:u,className:d,pendingObserver:f,enabledObserver:h}=S.useMemo(()=>l?gZ(n,l,o):mZ(),[l,n,JSON.stringify(o)]),p=ei(f,!1),m=ei(h,i??!!(c!=null&&c.isEnabled));S.useEffect(()=>{r==null||r(m)},[m,r]),S.useEffect(()=>{i!==void 0&&(vt.debug("forcing initial toggle state",n,i),u(i))},[]);const C=S.useMemo(()=>ja(s,{className:d}),[s,d]),v=S.useCallback(g=>{var y;u(),(y=s.onClick)==null||y.call(s,g)},[s,u]);return{toggle:u,enabled:m,pending:p,track:c,buttonProps:Jn(Me({},C),{"aria-pressed":m,"data-lk-source":n,"data-lk-enabled":m,disabled:p,onClick:v})}}function y$(t,e={}){return eP(t,e)}function x$(t){const e=Qp(),[n,r]=S.useState(),i=ei(n==null?void 0:n.isSendingObservable,!1),o=ei(n==null?void 0:n.messageObservable,[]);return S.useEffect(()=>{const s=RZ(e,t);r(s)},[e,t]),{send:n==null?void 0:n.send,chatMessages:o,isSending:i}}function I$(t={}){var e;const[n,r]=S.useState(GZ(t.defaults,(e=t.preventLoad)!=null?e:!1)),i=S.useCallback(c=>{r(u=>Jn(Me({},u),{audioEnabled:c}))},[]),o=S.useCallback(c=>{r(u=>Jn(Me({},u),{videoEnabled:c}))},[]),s=S.useCallback(c=>{r(u=>Jn(Me({},u),{audioDeviceId:c}))},[]),a=S.useCallback(c=>{r(u=>Jn(Me({},u),{videoDeviceId:c}))},[]),l=S.useCallback(c=>{r(u=>Jn(Me({},u),{username:c}))},[]);return S.useEffect(()=>{var c;VZ(n,(c=t.preventSave)!=null?c:!1)},[n,t.preventSave]),{userChoices:n,saveAudioInputEnabled:i,saveVideoInputEnabled:o,saveAudioInputDeviceId:s,saveVideoInputDeviceId:a,saveUsername:l}}function b$(t){const{mergedProps:e}=m$({props:t});return S.createElement("button",Me({},e),t.children)}function A$(t){const{buttonProps:e}=n$(t);return S.createElement("button",Me({},e),t.children)}var w$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),S.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),S.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),S$=w$,k$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),S.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),E$=k$,T$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),R$=T$,_$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),D$=_$,P$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),S.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),S.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),N$=P$,B$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),S.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),S.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),F$=B$,O$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),M$=O$,L$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("g",{opacity:.25},S.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),U$=L$,V$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("g",{opacity:.25},S.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),S.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),G$=V$,W$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),S.createElement("g",{opacity:.25},S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),S.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),z$=W$,j$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),S.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),H$=j$,Z$=t=>S.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),S.createElement("g",{fill:"currentColor"},S.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),S.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),$$=Z$;function $m(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:o,onDeviceSelectError:s,exactMatch:a,track:l,requestPermissions:c,onError:u}=e,d=Gn(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const f=eg(),h=S.useCallback(b=>{f&&f.emit(ue.MediaDevicesError,b),u==null||u(b)},[f,u]),{devices:p,activeDeviceId:m,setActiveMediaDevice:C,className:v}=c$({kind:n,room:f,track:l,requestPermissions:c,onError:h});S.useEffect(()=>{r!==void 0&&C(r)},[C]),S.useEffect(()=>{typeof o=="function"&&o(p)},[o,p]),S.useEffect(()=>{m&&m!==""&&(i==null||i(m))},[m]);const g=b=>Y3(this,null,function*(){try{yield C(b,{exact:a})}catch(E){if(E instanceof Error)s==null||s(E);else throw E}}),y=S.useMemo(()=>yu(d,{className:v},{className:"lk-list"}),[v,d]);function I(b,E,w){return b===E||w===0&&E==="default"}return S.createElement("ul",Me({},y),p.map((b,E)=>S.createElement("li",{key:b.deviceId,id:b.deviceId,"data-lk-active":I(b.deviceId,m,E),"aria-selected":I(b.deviceId,m,E),role:"option"},S.createElement("button",{className:"lk-button",onClick:()=>g(b.deviceId)},b.label))))}function tP(t,e){switch(t){case re.Source.Microphone:return e?S.createElement(F$,null):S.createElement(N$,null);case re.Source.Camera:return e?S.createElement(E$,null):S.createElement(S$,null);case re.Source.ScreenShare:return e?S.createElement($$,null):S.createElement(H$,null);default:return}}function X$(t){switch(t){case ci.Excellent:return S.createElement(M$,null);case ci.Good:return S.createElement(U$,null);case ci.Poor:return S.createElement(G$,null);default:return S.createElement(z$,null)}}function Xm(t){var e=t,{showIcon:n}=e,r=Gn(e,["showIcon"]);const{buttonProps:i,enabled:o}=C$(r);return S.createElement("button",Me({},i),(n??!0)&&tP(r.source,o),r.children)}function K$(t){var e;const{className:n,quality:r}=e$(t),i=S.useMemo(()=>Jn(Me({},yu(t,{className:n})),{"data-lk-quality":r}),[r,t,n]);return S.createElement("div",Me({},i),(e=t.children)!=null?e:X$(r))}function J$(t){var e=t,{participant:n}=e,r=Gn(e,["participant"]);const i=Wl(n),{className:o,infoObserver:s}=S.useMemo(()=>IZ(i),[i]),{identity:a,name:l}=ei(s,{name:i.name,identity:i.identity,metadata:i.metadata}),c=S.useMemo(()=>yu(r,{className:o,"data-lk-participant-name":l}),[r,o,l]);return S.createElement("span",Me({},c),l!==""?l:a,r.children)}function Y$(t){var e=t,{source:n,participant:r,trackRef:i,show:o="always"}=e,s=Gn(e,["source","participant","trackRef","show"]),a,l;const{className:c,isMuted:u}=v$(i??n,{participant:r}),d=o==="always"||o==="muted"&&u||o==="unmuted"&&!u,f=S.useMemo(()=>yu(s,{className:c}),[c,s]);return d?S.createElement("div",Jn(Me({},f),{"data-lk-muted":u}),(l=s.children)!=null?l:tP((a=i==null?void 0:i.source)!=null?a:n,!u)):null}function q$(t){var e=t,{trackRef:n,onSubscriptionStatusChanged:r,volume:i,source:o,name:s,publication:a,participant:l}=e,c=Gn(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),u,d,f,h,p,m,C,v,g,y;const I=_f(),b=(h=(f=(u=n==null?void 0:n.publication)==null?void 0:u.trackName)!=null?f:(d=I==null?void 0:I.publication)==null?void 0:d.trackName)!=null?h:s,E=(m=(p=n==null?void 0:n.source)!=null?p:I==null?void 0:I.source)!=null?m:o,w=(v=(C=n==null?void 0:n.publication)!=null?C:I==null?void 0:I.publication)!=null?v:a,k=(y=(g=n==null?void 0:n.participant)!=null?g:I==null?void 0:I.participant)!=null?y:l;if(E===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const D=S.useRef(null),T=Wl(k),{elementProps:R,isSubscribed:P,track:M,publication:G}=eP({source:E,name:b,participant:T,publication:w},{element:D,props:c});return S.useEffect(()=>{r==null||r(!!P)},[P,r]),S.useEffect(()=>{M===void 0||i===void 0||(M instanceof vl?M.setVolume(i):vt.warn("Volume can only be set on remote audio tracks."))},[i,M]),S.useEffect(()=>{G===void 0||c.muted===void 0||(G instanceof kx?G.setEnabled(!c.muted):vt.warn("Can only call setEnabled on remote track publications."))},[c.muted,G,M]),S.createElement("audio",Me({ref:D},R))}function Q$(t){const e=!!qp();return t.participant&&!e?S.createElement(Ux.Provider,{value:t.participant},t.children):S.createElement(S.Fragment,null,t.children)}function eX({value:t,onPinChange:e,onWidgetChange:n,children:r}){const i=JZ(t);return S.useEffect(()=>{vt.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),S.useEffect(()=>{vt.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),S.createElement(Lx.Provider,{value:i},r)}function tX(t){const{room:e,htmlProps:n}=s$(t);return S.createElement("div",Me({},n),e&&S.createElement(Vx.Provider,{value:e},S.createElement(qZ.Provider,{value:t.featureFlags},t.children)))}function nX(t){var e=t,{participant:n,trackRef:r}=e,i=Gn(e,["participant","trackRef"]),o,s;const[a,l]=S.useState([]),c=200,u=90,d=6,f=4,h=50,p=7,m=(o=qp())!=null?o:n;let C=(s=_f())!=null?s:r;if(!C){if(!m)throw Error("Participant missing, provide it directly or within a context");C={participant:m,source:re.Source.Microphone}}const{track:v}=y$(C);return S.useEffect(()=>{if(!v||!(v instanceof br||v instanceof vl))return;const{analyser:g,cleanup:y}=Rz(v,{smoothingTimeConstant:.8,fftSize:64}),I=new Uint8Array(g.frequencyBinCount),b=()=>{g.getByteFrequencyData(I);const w=new Array(p).fill(0);I.slice(1);const k=6;for(let D=0;D<p/2;D+=1){const T=Math.floor(p/2-D);for(let R=0;R<k;R+=1)w[T]+=Math.pow(I[D*k+R]/255,2);w[T]/=k}for(let D=0;D<p/2;D+=1){const T=Math.floor(p/2+D);if(w[T]===0){for(let R=0;R<k;R+=1)w[T]+=Math.pow(I[D*k+R]/255,2);w[T]/=k}}return w.map(D=>D*h)},E=setInterval(()=>{const w=b();l(w)},100);return()=>{clearInterval(E),y()}},[v]),S.createElement("svg",Jn(Me({width:"100%",height:"100%",viewBox:`0 0 ${c} ${u}`},i),{className:"lk-audio-visualizer"}),S.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),S.createElement("g",{style:{transform:`translate(${(c-p*(d+f))/2}px, 0)`}},a.map((g,y)=>S.createElement("rect",{key:y,x:y*(d+f),y:u/2-g/2,width:d,height:g}))))}function rX(t){var e=t,{participants:n}=e,r=Gn(e,["participants"]);return S.createElement(S.Fragment,null,n.map(i=>S.createElement(Ux.Provider,{value:i,key:i.identity},Q3(r.children))))}function iX(t){var e=t,{participant:n,children:r,source:i,publication:o,disableSpeakingIndicator:s,onParticipantClick:a}=e,l=Gn(e,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const c=Wl(n),{elementProps:u}=d$({participant:c,htmlProps:l,disableSpeakingIndicator:s,source:re.Source.Microphone,publication:o,onParticipantClick:a});return S.createElement("div",Me({style:{position:"relative"}},u),S.createElement(Q$,{participant:c},r??S.createElement(S.Fragment,null,S.createElement(q$,{source:i??re.Source.Microphone}),S.createElement(nX,null),S.createElement("div",{className:"lk-participant-metadata"},S.createElement("div",{className:"lk-participant-metadata-item"},S.createElement(Y$,{source:re.Source.Microphone}),S.createElement(J$,null)),S.createElement(K$,{className:"lk-participant-metadata-item"})))))}function oX(t){var e=t,{entry:n,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:o}=e,s=Gn(e,["entry","hideName","hideTimestamp","messageFormatter"]),a,l,c,u;const d=S.useMemo(()=>o?o(n.message):n.message,[n.message,o]),f=new Date(n.timestamp),h=navigator?navigator.language:"en-US";return S.createElement("li",Me({className:"lk-chat-entry",title:f.toLocaleTimeString(h,{timeStyle:"full"}),"data-lk-message-origin":(a=n.from)!=null&&a.isLocal?"local":"remote"},s),(!i||!r)&&S.createElement("span",{className:"lk-meta-data"},!r&&S.createElement("strong",{className:"lk-participant-name"},(u=(l=n.from)==null?void 0:l.name)!=null?u:(c=n.from)==null?void 0:c.identity),!i&&S.createElement("span",{className:"lk-timestamp"},f.toLocaleTimeString(h,{timeStyle:"short"}))),S.createElement("span",{className:"lk-message-body"},d))}function sX(t){var e=t,{messageFormatter:n,messageDecoder:r,messageEncoder:i,channelTopic:o}=e,s=Gn(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const a=S.useRef(null),l=S.useRef(null),c=S.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:o}),[r,i,o]),{send:u,chatMessages:d,isSending:f}=x$(c),h=q3(),p=S.useRef(0);function m(C){return Y3(this,null,function*(){C.preventDefault(),a.current&&a.current.value.trim()!==""&&u&&(yield u(a.current.value),a.current.value="",a.current.focus())})}return S.useEffect(()=>{var C;l&&((C=l.current)==null||C.scrollTo({top:l.current.scrollHeight}))},[l,d]),S.useEffect(()=>{var C,v,g,y,I;if(!h||d.length===0)return;if((C=h.widget.state)!=null&&C.showChat&&d.length>0&&p.current!==((v=d[d.length-1])==null?void 0:v.timestamp)){p.current=(g=d[d.length-1])==null?void 0:g.timestamp;return}const b=d.filter(w=>!p.current||w.timestamp>p.current).length,{widget:E}=h;b>0&&((y=E.state)==null?void 0:y.unreadMessages)!==b&&((I=E.dispatch)==null||I.call(E,{msg:"unread_msg",count:b}))},[d,h==null?void 0:h.widget]),S.createElement("div",Jn(Me({},s),{className:"lk-chat"}),S.createElement("ul",{className:"lk-list lk-chat-messages",ref:l},s.children?d.map((C,v)=>Q3(s.children,{entry:C,key:v,messageFormatter:n})):d.map((C,v,g)=>{const y=v>=1&&g[v-1].from===C.from,I=v>=1&&C.timestamp-g[v-1].timestamp<6e4;return S.createElement(oX,{key:v,hideName:y,hideTimestamp:y===!1?!1:I,entry:C,messageFormatter:n})})),S.createElement("form",{className:"lk-chat-form",onSubmit:m},S.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:f,ref:a,type:"text",placeholder:"Enter a message..."}),S.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:f},"Send")))}function ZS(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,tracks:o,requestPermissions:s=!1}=e,a=Gn(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[l,c]=S.useState(!1),[u,d]=S.useState([]),[f,h]=S.useState(!0),p=(g,y)=>{vt.debug("handle device change"),c(!1),i==null||i(g,y)},m=S.useRef(null),C=S.useRef(null);S.useLayoutEffect(()=>{m.current&&C.current&&(u||f)&&KH(m.current,C.current).then(({x:g,y})=>{C.current&&Object.assign(C.current.style,{left:`${g}px`,top:`${y}px`})}),h(!1)},[m,C,u,f]);const v=S.useCallback(g=>{C.current&&g.target!==m.current&&l&&JH(C.current,g)&&c(!1)},[l,C,m]);return S.useEffect(()=>(document.addEventListener("click",v),window.addEventListener("resize",()=>h(!0)),()=>{document.removeEventListener("click",v),window.removeEventListener("resize",()=>h(!0))}),[v,h]),S.createElement(S.Fragment,null,S.createElement("button",Jn(Me({className:"lk-button lk-button-menu","aria-pressed":l},a),{onClick:()=>c(!l),ref:m}),a.children),!a.disabled&&S.createElement("div",{className:"lk-device-menu",ref:C,style:{visibility:l?"visible":"hidden"}},n?S.createElement($m,{initialSelection:r,onActiveDeviceChange:g=>p(n,g),onDeviceListChange:d,kind:n,track:o==null?void 0:o[n],requestPermissions:s}):S.createElement(S.Fragment,null,S.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),S.createElement($m,{kind:"audioinput",onActiveDeviceChange:g=>p("audioinput",g),onDeviceListChange:d,track:o==null?void 0:o.audioinput,requestPermissions:s}),S.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),S.createElement($m,{kind:"videoinput",onActiveDeviceChange:g=>p("videoinput",g),onDeviceListChange:d,track:o==null?void 0:o.videoinput,requestPermissions:s}))))}function aX(t){var e=t,{label:n}=e,r=Gn(e,["label"]);const i=Qp(),{mergedProps:o,canPlayAudio:s}=p$({room:i,props:r}),{mergedProps:a,canPlayVideo:l}=g$({room:i,props:o}),c=a,{style:u}=c,d=Gn(c,["style"]);return u.display=s&&l?"none":"block",S.createElement("button",Me({style:u},d),n??`Start ${s?"Video":"Audio"}`)}function lX(t){var e=t,{variation:n,controls:r,saveUserChoices:i=!0}=e,o=Gn(e,["variation","controls","saveUserChoices"]),s,a,l,c,u;const[d,f]=S.useState(!1),h=q3();S.useEffect(()=>{var M,G;((M=h==null?void 0:h.widget.state)==null?void 0:M.showChat)!==void 0&&f((G=h==null?void 0:h.widget.state)==null?void 0:G.showChat)},[(s=h==null?void 0:h.widget.state)==null?void 0:s.showChat]);const m=ZZ(`(max-width: ${d?1e3:760}px)`)?"minimal":"verbose";n??(n=m);const C=Me({leave:!0},r),v=l$();v?((a=C.camera)!=null||(C.camera=v.canPublish),(l=C.microphone)!=null||(C.microphone=v.canPublish),(c=C.screenShare)!=null||(C.screenShare=v.canPublish),(u=C.chat)!=null||(C.chat=v.canPublishData&&(r==null?void 0:r.chat))):(C.camera=!1,C.chat=!1,C.microphone=!1,C.screenShare=!1);const g=S.useMemo(()=>n==="minimal"||n==="verbose",[n]),y=S.useMemo(()=>n==="textOnly"||n==="verbose",[n]),I=eZ(),[b,E]=S.useState(!1),w=M=>{E(M)},k=yu({className:"lk-control-bar"},o),{saveAudioInputEnabled:D,saveVideoInputEnabled:T,saveAudioInputDeviceId:R,saveVideoInputDeviceId:P}=I$({preventSave:!i});return S.createElement("div",Me({},k),C.microphone&&S.createElement("div",{className:"lk-button-group"},S.createElement(Xm,{source:re.Source.Microphone,showIcon:g,onChange:D},y&&"Microphone"),S.createElement("div",{className:"lk-button-group-menu"},S.createElement(ZS,{kind:"audioinput",onActiveDeviceChange:(M,G)=>R(G??"")}))),C.camera&&S.createElement("div",{className:"lk-button-group"},S.createElement(Xm,{source:re.Source.Camera,showIcon:g,onChange:T},y&&"Camera"),S.createElement("div",{className:"lk-button-group-menu"},S.createElement(ZS,{kind:"videoinput",onActiveDeviceChange:(M,G)=>P(G??"")}))),C.screenShare&&I&&S.createElement(Xm,{source:re.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:g,onChange:w},y&&(b?"Stop screen share":"Share screen")),C.chat&&S.createElement(b$,null,g&&S.createElement(R$,null),y&&"Chat"),C.leave&&S.createElement(A$,null,g&&S.createElement(D$,null),y&&"Leave"),S.createElement(aX,null))}function cX(t){var e=Gn(t,[]);const[n,r]=S.useState({showChat:!1,unreadMessages:0}),i=h$();return S.createElement(eX,{onWidgetChange:r},S.createElement("div",Me({className:"lk-audio-conference"},e),S.createElement("div",{className:"lk-audio-conference-stage"},S.createElement(rX,{participants:i},S.createElement(iX,null))),S.createElement(lX,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),n.showChat&&S.createElement(sX,null)))}const uX="wss://mongoose-67t79p35.livekit.cloud",dX=({client:t})=>{const[e,n]=S.useState([]),[r,i]=S.useState(!1);return S.useEffect(()=>{const o=a=>{n(l=>[...l,a]),i(!0)},s=a=>{n(l=>{const c=l.filter(u=>u!==a);return c.length===0&&i(!1),c})};return t.on("livekitToken",o),t.on("livekitLeave",s),()=>{t.off("livekitToken",o),t.off("livekitLeave",s)}},[t]),e.length?X.jsxs("div",{"data-lk-theme":"default",children:[e.map((o,s)=>X.jsx(tX,{video:!1,audio:!0,token:o,serverUrl:uX,connect:!0,onDisconnected:()=>t.emit("livekitLeave",o),children:X.jsx(cX,{})},s)),X.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null},fX=({users:t,client:e,fileTransferExpanded:n})=>{const r=[{label:"Users",content:X.jsx(zG,{users:t})},{label:"File Transfer",content:X.jsx(XG,{client:e,expanded:n})},{label:"Audio",content:X.jsx(dX,{client:e})}];return X.jsx("div",{className:"sidebar-content",children:X.jsx(l_,{tabs:r})})};class hX extends He.Component{constructor(e){super(e),this.state={statusText:"Not connected"},e.client.on("statustext",n=>this.setState({statusText:n})),e.client.on("connect",()=>this.setState({statusText:"Connected"})),e.client.on("disconnect",()=>this.setState({statusText:"Disconnected"}))}render(){return X.jsx("div",{className:"statusbar",children:this.state.statusText})}}var nP={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},$S=He.createContext&&He.createContext(nP),pX=["attr","size","title"];function gX(t,e){if(t==null)return{};var n=mX(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function mX(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function sp(){return sp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sp.apply(this,arguments)}function XS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ap(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?XS(Object(n),!0).forEach(function(r){vX(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):XS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function vX(t,e,n){return e=CX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CX(t){var e=yX(t,"string");return typeof e=="symbol"?e:e+""}function yX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rP(t){return t&&t.map((e,n)=>He.createElement(e.tag,ap({key:n},e.attr),rP(e.child)))}function Ho(t){return e=>He.createElement(xX,sp({attr:ap({},t.attr)},e),rP(t.child))}function xX(t){var e=n=>{var{attr:r,size:i,title:o}=t,s=gX(t,pX),a=i||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),He.createElement("svg",sp({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:l,style:ap(ap({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&He.createElement("title",null,o),t.children)};return $S!==void 0?He.createElement($S.Consumer,null,n=>e(n)):e(nP)}function IX(t){return Ho({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(t)}function bX(t){return Ho({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(t)}function AX(t){return Ho({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(t)}function wX(t){return Ho({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32zM128 272c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(t)}function SX(t){return Ho({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(t)}function kX(t){return Ho({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"},child:[]}]})(t)}function iP(t){return Ho({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(t)}function EX(t){return Ho({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(t)}function TX(t){return Ho({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(t)}function RX(t){return Ho({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(t)}function lp(t,e,n){const[r,i]=S.useState(n);return S.useEffect(()=>{if(!t)return i(n),()=>{};const o=s=>{i(s)};return t.on(e,o),()=>{t.off(e,o)}},[t,e,n]),r}const _X=({client:t,onClearLog:e,onSaveLog:n,onToggleSidebar:r,onOpenPrefs:i,showSidebar:o})=>{const s=lp(t,"connectionChange",t.connected),[a,l]=He.useState(t.cacophony.muted),c=lp(t,"autosayChanged",t.autosay)||!1,[u,d]=He.useState(go.getState().general.volume),f=S.useCallback(()=>{l(!a),t.cacophony.muted=!a},[a,t]),h=S.useCallback(C=>{const v=Number(C.target.value)/100;d(v),t.cacophony.setGlobalVolume(v),go.dispatch({type:Mo.SetGeneral,data:{...go.getState().general,volume:v}})},[t]),p=S.useCallback(C=>{t.autosay=C.target.checked},[t]),m=S.useCallback(()=>{s?t.close():t.connect()},[s,t]);return X.jsxs("div",{className:"toolbar",children:[X.jsxs("button",{onClick:n,accessKey:"l",children:[X.jsx(iP,{}),"Save Log"]}),X.jsxs("button",{onClick:e,accessKey:"c",children:[X.jsx(kX,{}),"Clear Log"]}),X.jsxs("button",{onClick:i,accessKey:"p",children:[X.jsx(AX,{}),"Preferences"]}),X.jsxs("button",{onClick:f,accessKey:"m",children:[a?X.jsx(RX,{}):X.jsx(TX,{}),a?"Unmute":"Mute"]}),X.jsxs("label",{children:["Volume",X.jsx("input",{type:"range",min:"0",max:"100",value:u*100,onChange:h,accessKey:"v"})]}),X.jsxs("label",{children:[X.jsx(wX,{}),"Autosay",X.jsx("input",{type:"checkbox",checked:c,onChange:p})]}),X.jsx("button",{onClick:m,children:s?"Disconnect":"Connect"}),X.jsxs("button",{onClick:r,accessKey:"u",children:[o?X.jsx(bX,{}):X.jsx(IX,{}),o?"Hide Sidebar":"Show Sidebar"]})]})};function DX(){const[t,e]=S.useState(null),[n,r]=S.useState(!1),[i,o]=S.useState(!1),[s,a]=S.useState(!1),l=lp(t,"userlist",[])||[],c=He.useRef(null),u=He.useRef(null),d=He.useRef(null),f=S.useRef(!1),h=()=>{c.current&&c.current.saveLog()},p=()=>{c.current&&c.current.clearLog()},m=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);S.useEffect(()=>{if(f.current)return;const g=new v9("mongoose.moo.mud.org",8765);g.registerGMCPPackage(HL),g.registerGMCPPackage(GL),g.registerGMCPPackage(WL),g.registerGMCPPackage(O4),g.registerGMCPPackage(ZL),g.registerGMCPPackage(zL),g.registerGMCPPackage(jL),g.registerGMCPPackage(P4),g.registerGMCPPackage(R6),g.registerGMCPPackage(G2),g.registerMcpPackage(N6),g.registerMcpPackage(B6),g.registerMcpPackage(O6),g.registerMcpPackage(M6),g.connect(),g.requestNotificationPermission(),e(g),r(!m),window.mudClient=g,f.current=!0;const y=b=>{g&&(b.key==="Control"&&g.cancelSpeech(),b.key==="Escape"&&g.stopAllSounds())};window.addEventListener("keydown",y);const I=()=>{var b;(b=u.current)==null||b.focus()};return document.addEventListener("focus",I),()=>{window.removeEventListener("keydown",y),document.removeEventListener("focus",I)}},[m]);const C=lp(t,"fileTransferOffer",null),v=S.useCallback(g=>{t&&t.sendCommand(g)},[t]);return S.useEffect(()=>{C!==null&&(a(!0),o(!0),t==null||t.sendNotification("File Transfer Offer",`${C.sender} wants to send you ${C.filename} (${Math.round(C.filesize/1024)} KB)`))},[C,t]),NT(g=>{t&&t.shutdown()}),S.useEffect(()=>{var g;(g=u.current)==null||g.focus()},[]),t?X.jsxs("div",{className:"App",children:[X.jsx("header",{role:"banner",style:{gridArea:"header"},children:X.jsx(_X,{client:t,onSaveLog:h,onClearLog:p,onToggleSidebar:()=>r(!n),onOpenPrefs:()=>{var g;return(g=d.current)==null?void 0:g.open()},showSidebar:n})}),X.jsx("main",{role:"main",style:{gridArea:"main"},children:X.jsx(kC,{client:t,ref:c})}),X.jsxs("aside",{role:"complementary","aria-roledescription":"Sidebar",style:{gridArea:"sidebar"},className:n?"sidebar-visible":"sidebar-hidden",children:[X.jsx(fX,{users:l,client:t,fileTransferExpanded:s})," "]}),X.jsx("div",{role:"region","aria-label":"Command input",style:{gridArea:"input"},children:X.jsx(I9,{onSend:v,inputRef:u})}),X.jsx("footer",{role:"contentinfo",style:{gridArea:"status"},children:X.jsx(hX,{client:t})}),X.jsx(WG,{ref:d})]}):null}function PX(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function JS(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?KS(Object(n),!0).forEach(function(r){PX(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function NX(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function BX(t,e){if(t==null)return{};var n=NX(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function FX(t,e){return OX(t)||MX(t,e)||LX(t,e)||UX()}function OX(t){if(Array.isArray(t))return t}function MX(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var s=t[Symbol.iterator](),a;!(r=(a=s.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(l){i=!0,o=l}finally{try{!r&&s.return!=null&&s.return()}finally{if(i)throw o}}return n}}function LX(t,e){if(t){if(typeof t=="string")return YS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YS(t,e)}}function YS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function UX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VX(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function QS(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qS(Object(n),!0).forEach(function(r){VX(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function GX(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return e.reduceRight(function(i,o){return o(i)},r)}}function ad(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return e.apply(n,[].concat(i,a))}}}function cp(t){return{}.toString.call(t).includes("Object")}function WX(t){return!Object.keys(t).length}function uf(t){return typeof t=="function"}function zX(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function jX(t,e){return cp(e)||_a("changeType"),Object.keys(e).some(function(n){return!zX(t,n)})&&_a("changeField"),e}function HX(t){uf(t)||_a("selectorType")}function ZX(t){uf(t)||cp(t)||_a("handlerType"),cp(t)&&Object.values(t).some(function(e){return!uf(e)})&&_a("handlersType")}function $X(t){t||_a("initialIsRequired"),cp(t)||_a("initialType"),WX(t)&&_a("initialContent")}function XX(t,e){throw new Error(t[e]||t.default)}var KX={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},_a=ad(XX)(KX),fh={changes:jX,selector:HX,handler:ZX,initial:$X};function JX(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};fh.initial(t),fh.handler(e);var n={current:t},r=ad(QX)(n,e),i=ad(qX)(n),o=ad(fh.changes)(t),s=ad(YX)(n);function a(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return fh.selector(c),c(n.current)}function l(c){GX(r,i,o,s)(c)}return[a,l]}function YX(t,e){return uf(e)?e(t.current):e}function qX(t,e){return t.current=QS(QS({},t.current),e),e}function QX(t,e,n){return uf(e)?e(t.current):Object.keys(n).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,t.current[r])}),n}var eK={create:JX},tK={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function nK(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=t.length?t.apply(this,i):function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return e.apply(n,[].concat(i,a))}}}function rK(t){return{}.toString.call(t).includes("Object")}function iK(t){return t||ek("configIsRequired"),rK(t)||ek("configType"),t.urls?(oK(),{paths:{vs:t.urls.monacoBase}}):t}function oK(){console.warn(oP.deprecation)}function sK(t,e){throw new Error(t[e]||t.default)}var oP={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},ek=nK(sK)(oP),aK={config:iK},lK=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(o,s){return s(o)},i)}};function sP(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],sP(t[n],e[n]))}),JS(JS({},t),e)}var cK={type:"cancelation",msg:"operation is manually canceled"};function Km(t){var e=!1,n=new Promise(function(r,i){t.then(function(o){return e?i(cK):r(o)}),t.catch(i)});return n.cancel=function(){return e=!0},n}var uK=eK.create({config:tK,isInitialized:!1,resolve:null,reject:null,monaco:null}),aP=FX(uK,2),Pf=aP[0],tg=aP[1];function dK(t){var e=aK.config(t),n=e.monaco,r=BX(e,["monaco"]);tg(function(i){return{config:sP(i.config,r),monaco:n}})}function fK(){var t=Pf(function(e){var n=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!t.isInitialized){if(tg({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),Km(Jm);if(window.monaco&&window.monaco.editor)return lP(window.monaco),t.resolve(window.monaco),Km(Jm);lK(hK,gK)(mK)}return Km(Jm)}function hK(t){return document.body.appendChild(t)}function pK(t){var e=document.createElement("script");return t&&(e.src=t),e}function gK(t){var e=Pf(function(r){var i=r.config,o=r.reject;return{config:i,reject:o}}),n=pK("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function mK(){var t=Pf(function(n){var r=n.config,i=n.resolve,o=n.reject;return{config:r,resolve:i,reject:o}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){lP(n),t.resolve(n)},function(n){t.reject(n)})}function lP(t){Pf().monaco||tg({monaco:t})}function vK(){return Pf(function(t){var e=t.monaco;return e})}var Jm=new Promise(function(t,e){return tg({resolve:t,reject:e})}),cP={config:dK,init:fK,__getMonacoInstance:vK},CK={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Ym=CK,yK={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},xK=yK;function IK({children:t}){return He.createElement("div",{style:xK.container},t)}var bK=IK,AK=bK;function wK({width:t,height:e,isEditorReady:n,loading:r,_ref:i,className:o,wrapperProps:s}){return He.createElement("section",{style:{...Ym.wrapper,width:t,height:e},...s},!n&&He.createElement(AK,null,r),He.createElement("div",{ref:i,style:{...Ym.fullWidth,...!n&&Ym.hide},className:o}))}var SK=wK,uP=S.memo(SK);function kK(t){S.useEffect(t,[])}var dP=kK;function EK(t,e,n=!0){let r=S.useRef(!0);S.useEffect(r.current||!n?()=>{r.current=!1}:t,e)}var $r=EK;function Sd(){}function gc(t,e,n,r){return TK(t,r)||RK(t,e,n,r)}function TK(t,e){return t.editor.getModel(fP(t,e))}function RK(t,e,n,r){return t.editor.createModel(e,n,r?fP(t,r):void 0)}function fP(t,e){return t.Uri.parse(e)}function _K({original:t,modified:e,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:o,modifiedModelPath:s,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:l=!1,theme:c="light",loading:u="Loading...",options:d={},height:f="100%",width:h="100%",className:p,wrapperProps:m={},beforeMount:C=Sd,onMount:v=Sd}){let[g,y]=S.useState(!1),[I,b]=S.useState(!0),E=S.useRef(null),w=S.useRef(null),k=S.useRef(null),D=S.useRef(v),T=S.useRef(C),R=S.useRef(!1);dP(()=>{let H=cP.init();return H.then(q=>(w.current=q)&&b(!1)).catch(q=>(q==null?void 0:q.type)!=="cancelation"&&console.error("Monaco initialization: error:",q)),()=>E.current?G():H.cancel()}),$r(()=>{if(E.current&&w.current){let H=E.current.getOriginalEditor(),q=gc(w.current,t||"",r||n||"text",o||"");q!==H.getModel()&&H.setModel(q)}},[o],g),$r(()=>{if(E.current&&w.current){let H=E.current.getModifiedEditor(),q=gc(w.current,e||"",i||n||"text",s||"");q!==H.getModel()&&H.setModel(q)}},[s],g),$r(()=>{let H=E.current.getModifiedEditor();H.getOption(w.current.editor.EditorOption.readOnly)?H.setValue(e||""):e!==H.getValue()&&(H.executeEdits("",[{range:H.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),H.pushUndoStop())},[e],g),$r(()=>{var H,q;(q=(H=E.current)==null?void 0:H.getModel())==null||q.original.setValue(t||"")},[t],g),$r(()=>{let{original:H,modified:q}=E.current.getModel();w.current.editor.setModelLanguage(H,r||n||"text"),w.current.editor.setModelLanguage(q,i||n||"text")},[n,r,i],g),$r(()=>{var H;(H=w.current)==null||H.editor.setTheme(c)},[c],g),$r(()=>{var H;(H=E.current)==null||H.updateOptions(d)},[d],g);let P=S.useCallback(()=>{var ie;if(!w.current)return;T.current(w.current);let H=gc(w.current,t||"",r||n||"text",o||""),q=gc(w.current,e||"",i||n||"text",s||"");(ie=E.current)==null||ie.setModel({original:H,modified:q})},[n,e,i,t,r,o,s]),M=S.useCallback(()=>{var H;!R.current&&k.current&&(E.current=w.current.editor.createDiffEditor(k.current,{automaticLayout:!0,...d}),P(),(H=w.current)==null||H.editor.setTheme(c),y(!0),R.current=!0)},[d,c,P]);S.useEffect(()=>{g&&D.current(E.current,w.current)},[g]),S.useEffect(()=>{!I&&!g&&M()},[I,g,M]);function G(){var q,ie,Z,Q;let H=(q=E.current)==null?void 0:q.getModel();a||((ie=H==null?void 0:H.original)==null||ie.dispose()),l||((Z=H==null?void 0:H.modified)==null||Z.dispose()),(Q=E.current)==null||Q.dispose()}return He.createElement(uP,{width:h,height:f,isEditorReady:g,loading:u,_ref:k,className:p,wrapperProps:m})}var DK=_K;S.memo(DK);function PK(t){let e=S.useRef();return S.useEffect(()=>{e.current=t},[t]),e.current}var NK=PK,hh=new Map;function BK({defaultValue:t,defaultLanguage:e,defaultPath:n,value:r,language:i,path:o,theme:s="light",line:a,loading:l="Loading...",options:c={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:f=!1,width:h="100%",height:p="100%",className:m,wrapperProps:C={},beforeMount:v=Sd,onMount:g=Sd,onChange:y,onValidate:I=Sd}){let[b,E]=S.useState(!1),[w,k]=S.useState(!0),D=S.useRef(null),T=S.useRef(null),R=S.useRef(null),P=S.useRef(g),M=S.useRef(v),G=S.useRef(),H=S.useRef(r),q=NK(o),ie=S.useRef(!1),Z=S.useRef(!1);dP(()=>{let F=cP.init();return F.then(z=>(D.current=z)&&k(!1)).catch(z=>(z==null?void 0:z.type)!=="cancelation"&&console.error("Monaco initialization: error:",z)),()=>T.current?ne():F.cancel()}),$r(()=>{var z,J,ee,se;let F=gc(D.current,t||r||"",e||i||"",o||n||"");F!==((z=T.current)==null?void 0:z.getModel())&&(d&&hh.set(q,(J=T.current)==null?void 0:J.saveViewState()),(ee=T.current)==null||ee.setModel(F),d&&((se=T.current)==null||se.restoreViewState(hh.get(o))))},[o],b),$r(()=>{var F;(F=T.current)==null||F.updateOptions(c)},[c],b),$r(()=>{!T.current||r===void 0||(T.current.getOption(D.current.editor.EditorOption.readOnly)?T.current.setValue(r):r!==T.current.getValue()&&(Z.current=!0,T.current.executeEdits("",[{range:T.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),T.current.pushUndoStop(),Z.current=!1))},[r],b),$r(()=>{var z,J;let F=(z=T.current)==null?void 0:z.getModel();F&&i&&((J=D.current)==null||J.editor.setModelLanguage(F,i))},[i],b),$r(()=>{var F;a!==void 0&&((F=T.current)==null||F.revealLine(a))},[a],b),$r(()=>{var F;(F=D.current)==null||F.editor.setTheme(s)},[s],b);let Q=S.useCallback(()=>{var F;if(!(!R.current||!D.current)&&!ie.current){M.current(D.current);let z=o||n,J=gc(D.current,r||t||"",e||i||"",z||"");T.current=(F=D.current)==null?void 0:F.editor.create(R.current,{model:J,automaticLayout:!0,...c},u),d&&T.current.restoreViewState(hh.get(z)),D.current.editor.setTheme(s),a!==void 0&&T.current.revealLine(a),E(!0),ie.current=!0}},[t,e,n,r,i,o,c,u,d,s,a]);S.useEffect(()=>{b&&P.current(T.current,D.current)},[b]),S.useEffect(()=>{!w&&!b&&Q()},[w,b,Q]),H.current=r,S.useEffect(()=>{var F,z;b&&y&&((F=G.current)==null||F.dispose(),G.current=(z=T.current)==null?void 0:z.onDidChangeModelContent(J=>{Z.current||y(T.current.getValue(),J)}))},[b,y]),S.useEffect(()=>{if(b){let F=D.current.editor.onDidChangeMarkers(z=>{var ee;let J=(ee=T.current.getModel())==null?void 0:ee.uri;if(J&&z.find(se=>se.path===J.path)){let se=D.current.editor.getModelMarkers({resource:J});I==null||I(se)}});return()=>{F==null||F.dispose()}}return()=>{}},[b,I]);function ne(){var F,z;(F=G.current)==null||F.dispose(),f?d&&hh.set(o,T.current.saveViewState()):(z=T.current.getModel())==null||z.dispose(),T.current.dispose()}return He.createElement(uP,{width:h,height:p,isEditorReady:b,loading:l,_ref:R,className:m,wrapperProps:C})}var FK=BK,OK=S.memo(FK),MK=OK,LK={restoreOnUnmount:!1};function UK(t,e){e===void 0&&(e=LK);var n=S.useRef(document.title);document.title!==t&&(document.title=t),S.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=n.current}},[])}const VK=typeof document<"u"?UK:function(t){};function GK({onSave:t,onRevert:e,onDownload:n}){return X.jsx("div",{className:"toolbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderBottom:"1px solid #e8e8e8"},children:X.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[X.jsxs("button",{onClick:t,accessKey:"s",children:[X.jsx(iP,{}),"Save"]}),X.jsxs("button",{onClick:e,accessKey:"r",children:[X.jsx(EX,{}),"Revert"]}),X.jsxs("button",{onClick:n,accessKey:"d",children:[X.jsx(SX,{}),"Download"]})]})})}const WK=({docstate:t,session:e})=>X.jsxs("div",{"aria-live":"polite",className:"statusbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderTop:"1px solid #e8e8e8"},children:[X.jsx("span",{children:t}),X.jsx("span",{children:"|"}),X.jsx("span",{children:e.reference}),X.jsx("span",{children:"|"}),X.jsx("span",{children:e.type})]});function zK(){const t=DT(),e=He.useRef(null),[n,r]=S.useState(""),[i,o]=S.useState(""),[s,a]=S.useState(""),[l,c]=S.useState(0),[u,d]=S.useState({name:"none",contents:[],reference:"",type:""}),f=(M,G)=>{e.current=M},[h,p]=Gs();console.log(h);const m=h.editor.accessibilityMode,C=h.editor.autocompleteEnabled;NT(M=>{b.postMessage({type:"close",id:w}),l===1&&M.preventDefault()});const[v,g]=S.useState(!1),y=v?`${u.name} - Mongoose Editor`:"Mongoose Editor";VK(y);const I=S.useMemo(()=>{switch(l){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[l]),b=S.useMemo(()=>new BroadcastChannel("editor"),[]),E=new URLSearchParams(t.search),w=decodeURIComponent(E.get("reference")||"");S.useEffect(()=>{if(!w)return;console.log("ID: "+w),console.log("Sending ready message"),b.postMessage({type:"ready",id:w});const M=G=>{switch(console.log(G.data),G.data.type){case"load":if(n!=="")return;const H=G.data.session.contents.join(`
`);o(H),a(H),d(G.data.session),c(0),r(G.data.clientId),g(!0),setTimeout(P,100);break;case"shutdown":if(console.log("Received shutdown message"),l===1&&!window.confirm("You have unsaved changes. Are you sure you want to close this editor?"))return;b.close(),window.close();break;default:console.warn("Unknown message type received",G.data.type)}};return b.addEventListener("message",M),()=>{b.removeEventListener("message",M),b.postMessage({type:"close",id:w})}},[b,n,w,l]);const k=()=>{o(s),c(0)},D=M=>{const G=i.split(/\r\n|\r|\n/),H={...u,contents:G};b.postMessage({type:"save",session:H,id:w}),c(2),P(),M.preventDefault()},T=M=>{M!==void 0&&(console.log("Original: "+s),console.log("New: "+M),o(M),M.split(/\r\n|\r|\n/).join(`
`)!==s?c(1):c(0),v||g(!0))},R=()=>{const M=new Blob([i],{type:"text/plain"}),G=URL.createObjectURL(M),H=document.createElement("a"),q=new Date,ie=q.toLocaleDateString().replace(/\//g,"-"),Z=q.toLocaleTimeString().replace(/:/g,"-"),Q=`${u.name}-${ie}-${Z}.txt`;H.download=Q,H.href=G,H.click(),URL.revokeObjectURL(G),H.remove()};return X.jsxs("div",{id:"editor",children:[X.jsx(GK,{onSave:D,onRevert:k,onDownload:R}),X.jsx(MK,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:T,options:{wordWrap:"on",accessibilitySupport:m?"on":"off",quickSuggestions:C},onMount:f,path:u.reference}),X.jsx(WK,{docstate:I,session:u})]});function P(){e.current!==null&&e.current.focus()}}const jK="modulepreload",HK=function(t){return"/"+t},tk={},hP=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=HK(l),l in tk)return;tk[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":jK,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})},ZK=t=>{t&&t instanceof Function&&hP(async()=>{const{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}=await import("./web-vitals-CFnx-5Zt.js");return{getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o}},[]).then(({getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:o})=>{e(t),n(t),r(t),i(t),o(t)})};function $K(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:o,onRegisterError:s}=t;let a,l;const c=async(d=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(a=await hP(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:d}},[]).then(({Workbox:d})=>new d("/sw.js",{scope:"/",type:"classic"})).catch(d=>{s==null||s(d)}),!a)return;a.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),a.addEventListener("installed",d=>{d.isUpdate||r==null||r()}),a.register({immediate:e}).then(d=>{o?o("/sw.js",d):i==null||i(d)}).catch(d=>{s==null||s(d)})}}return l=u(),c}const XK=o4([{path:"/",element:X.jsx(DX,{})},{path:"/editor",element:X.jsx(zK,{})}]),KK=qm.createRoot(document.getElementById("root"));KK.render(X.jsx(He.StrictMode,{children:X.jsx(p4,{router:XK})}));ZK(console.log);$K();

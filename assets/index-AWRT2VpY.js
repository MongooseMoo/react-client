var Ux=Object.defineProperty;var jx=(t,e,n)=>e in t?Ux(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Wx=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var H=(t,e,n)=>(jx(t,typeof e!="symbol"?e+"":e,n),n),dg=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var x=(t,e,n)=>(dg(t,e,"read from private field"),n?n.call(t):e.get(t)),Me=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Ce=(t,e,n,r)=>(dg(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var Tf=(t,e,n,r)=>({set _(i){Ce(t,e,i,n)},get _(){return x(t,e,r)}}),ye=(t,e,n)=>(dg(t,e,"access private method"),n);var nQ=Wx((jQ,Dx)=>{function Z1(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Vx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var K1={exports:{}},Kp={},Y1={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xd=Symbol.for("react.element"),zx=Symbol.for("react.portal"),$x=Symbol.for("react.fragment"),Hx=Symbol.for("react.strict_mode"),Gx=Symbol.for("react.profiler"),qx=Symbol.for("react.provider"),Jx=Symbol.for("react.context"),Zx=Symbol.for("react.forward_ref"),Kx=Symbol.for("react.suspense"),Yx=Symbol.for("react.memo"),Xx=Symbol.for("react.lazy"),Rw=Symbol.iterator;function Qx(t){return t===null||typeof t!="object"?null:(t=Rw&&t[Rw]||t["@@iterator"],typeof t=="function"?t:null)}var X1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Q1=Object.assign,eT={};function $l(t,e,n){this.props=t,this.context=e,this.refs=eT,this.updater=n||X1}$l.prototype.isReactComponent={};$l.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};$l.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function tT(){}tT.prototype=$l.prototype;function Q0(t,e,n){this.props=t,this.context=e,this.refs=eT,this.updater=n||X1}var eS=Q0.prototype=new tT;eS.constructor=Q0;Q1(eS,$l.prototype);eS.isPureReactComponent=!0;var Pw=Array.isArray,nT=Object.prototype.hasOwnProperty,tS={current:null},rT={key:!0,ref:!0,__self:!0,__source:!0};function iT(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)nT.call(e,r)&&!rT.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Xd,type:t,key:s,ref:o,props:i,_owner:tS.current}}function eO(t,e){return{$$typeof:Xd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function nS(t){return typeof t=="object"&&t!==null&&t.$$typeof===Xd}function tO(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Aw=/\/+/g;function fg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?tO(""+t.key):e.toString(36)}function lh(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Xd:case zx:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+fg(o,0):r,Pw(i)?(n="",t!=null&&(n=t.replace(Aw,"$&/")+"/"),lh(i,e,n,"",function(l){return l})):i!=null&&(nS(i)&&(i=eO(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Aw,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Pw(t))for(var a=0;a<t.length;a++){s=t[a];var c=r+fg(s,a);o+=lh(s,e,n,c,i)}else if(c=Qx(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=r+fg(s,a++),o+=lh(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function _f(t,e,n){if(t==null)return t;var r=[],i=0;return lh(t,r,"","",function(s){return e.call(n,s,i++)}),r}function nO(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var rr={current:null},uh={transition:null},rO={ReactCurrentDispatcher:rr,ReactCurrentBatchConfig:uh,ReactCurrentOwner:tS};Ve.Children={map:_f,forEach:function(t,e,n){_f(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return _f(t,function(){e++}),e},toArray:function(t){return _f(t,function(e){return e})||[]},only:function(t){if(!nS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ve.Component=$l;Ve.Fragment=$x;Ve.Profiler=Gx;Ve.PureComponent=Q0;Ve.StrictMode=Hx;Ve.Suspense=Kx;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rO;Ve.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Q1({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=tS.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)nT.call(e,c)&&!rT.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:Xd,type:t.type,key:i,ref:s,props:r,_owner:o}};Ve.createContext=function(t){return t={$$typeof:Jx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:qx,_context:t},t.Consumer=t};Ve.createElement=iT;Ve.createFactory=function(t){var e=iT.bind(null,t);return e.type=t,e};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(t){return{$$typeof:Zx,render:t}};Ve.isValidElement=nS;Ve.lazy=function(t){return{$$typeof:Xx,_payload:{_status:-1,_result:t},_init:nO}};Ve.memo=function(t,e){return{$$typeof:Yx,type:t,compare:e===void 0?null:e}};Ve.startTransition=function(t){var e=uh.transition;uh.transition={};try{t()}finally{uh.transition=e}};Ve.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ve.useCallback=function(t,e){return rr.current.useCallback(t,e)};Ve.useContext=function(t){return rr.current.useContext(t)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(t){return rr.current.useDeferredValue(t)};Ve.useEffect=function(t,e){return rr.current.useEffect(t,e)};Ve.useId=function(){return rr.current.useId()};Ve.useImperativeHandle=function(t,e,n){return rr.current.useImperativeHandle(t,e,n)};Ve.useInsertionEffect=function(t,e){return rr.current.useInsertionEffect(t,e)};Ve.useLayoutEffect=function(t,e){return rr.current.useLayoutEffect(t,e)};Ve.useMemo=function(t,e){return rr.current.useMemo(t,e)};Ve.useReducer=function(t,e,n){return rr.current.useReducer(t,e,n)};Ve.useRef=function(t){return rr.current.useRef(t)};Ve.useState=function(t){return rr.current.useState(t)};Ve.useSyncExternalStore=function(t,e,n){return rr.current.useSyncExternalStore(t,e,n)};Ve.useTransition=function(){return rr.current.useTransition()};Ve.version="18.2.0";Y1.exports=Ve;var E=Y1.exports;const wt=Yd(E),iO=Z1({__proto__:null,default:wt},[E]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sO=E,oO=Symbol.for("react.element"),aO=Symbol.for("react.fragment"),cO=Object.prototype.hasOwnProperty,lO=sO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,uO={key:!0,ref:!0,__self:!0,__source:!0};function sT(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)cO.call(e,r)&&!uO.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:oO,type:t,key:s,ref:o,props:i,_owner:lO.current}}Kp.Fragment=aO;Kp.jsx=sT;Kp.jsxs=sT;K1.exports=Kp;var X=K1.exports,kv={},oT={exports:{}},Nr={},aT={exports:{}},cT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,Z){var ie=z.length;z.push(Z);e:for(;0<ie;){var q=ie-1>>>1,se=z[q];if(0<i(se,Z))z[q]=Z,z[ie]=se,ie=q;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var Z=z[0],ie=z.pop();if(ie!==Z){z[0]=ie;e:for(var q=0,se=z.length,ke=se>>>1;q<ke;){var Ee=2*(q+1)-1,me=z[Ee],Te=Ee+1,Ue=z[Te];if(0>i(me,ie))Te<se&&0>i(Ue,me)?(z[q]=Ue,z[Te]=ie,q=Te):(z[q]=me,z[Ee]=ie,q=Ee);else if(Te<se&&0>i(Ue,ie))z[q]=Ue,z[Te]=ie,q=Te;else break e}}return Z}function i(z,Z){var ie=z.sortIndex-Z.sortIndex;return ie!==0?ie:z.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],l=[],u=1,d=null,f=3,h=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(z){for(var Z=n(l);Z!==null;){if(Z.callback===null)r(l);else if(Z.startTime<=z)r(l),Z.sortIndex=Z.expirationTime,e(c,Z);else break;Z=n(l)}}function _(z){if(g=!1,w(z),!p)if(n(c)!==null)p=!0,G(C);else{var Z=n(l);Z!==null&&te(_,Z.startTime-z)}}function C(z,Z){p=!1,g&&(g=!1,m(R),R=-1),h=!0;var ie=f;try{for(w(Z),d=n(c);d!==null&&(!(d.expirationTime>Z)||z&&!O());){var q=d.callback;if(typeof q=="function"){d.callback=null,f=d.priorityLevel;var se=q(d.expirationTime<=Z);Z=t.unstable_now(),typeof se=="function"?d.callback=se:d===n(c)&&r(c),w(Z)}else r(c);d=n(c)}if(d!==null)var ke=!0;else{var Ee=n(l);Ee!==null&&te(_,Ee.startTime-Z),ke=!1}return ke}finally{d=null,f=ie,h=!1}}var k=!1,T=null,R=-1,A=5,M=-1;function O(){return!(t.unstable_now()-M<A)}function D(){if(T!==null){var z=t.unstable_now();M=z;var Z=!0;try{Z=T(!0,z)}finally{Z?j():(k=!1,T=null)}}else k=!1}var j;if(typeof v=="function")j=function(){v(D)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,J=V.port2;V.port1.onmessage=D,j=function(){J.postMessage(null)}}else j=function(){y(D,0)};function G(z){T=z,k||(k=!0,j())}function te(z,Z){R=y(function(){z(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,G(C))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(z){switch(f){case 1:case 2:case 3:var Z=3;break;default:Z=f}var ie=f;f=Z;try{return z()}finally{f=ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,Z){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var ie=f;f=z;try{return Z()}finally{f=ie}},t.unstable_scheduleCallback=function(z,Z,ie){var q=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?q+ie:q):ie=q,z){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=ie+se,z={id:u++,callback:Z,priorityLevel:z,startTime:ie,expirationTime:se,sortIndex:-1},ie>q?(z.sortIndex=ie,e(l,z),n(c)===null&&z===n(l)&&(g?(m(R),R=-1):g=!0,te(_,ie-q))):(z.sortIndex=se,e(c,z),p||h||(p=!0,G(C))),z},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(z){var Z=f;return function(){var ie=f;f=Z;try{return z.apply(this,arguments)}finally{f=ie}}}})(cT);aT.exports=cT;var dO=aT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lT=E,Pr=dO;function ae(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var uT=new Set,cd={};function sc(t,e){wl(t,e),wl(t+"Capture",e)}function wl(t,e){for(cd[t]=e,t=0;t<e.length;t++)uT.add(e[t])}var ro=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ev=Object.prototype.hasOwnProperty,fO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Nw={},Mw={};function hO(t){return Ev.call(Mw,t)?!0:Ev.call(Nw,t)?!1:fO.test(t)?Mw[t]=!0:(Nw[t]=!0,!1)}function pO(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function mO(t,e,n,r){if(e===null||typeof e>"u"||pO(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ir(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Rn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Rn[t]=new ir(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Rn[e]=new ir(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Rn[t]=new ir(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Rn[t]=new ir(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Rn[t]=new ir(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Rn[t]=new ir(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Rn[t]=new ir(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Rn[t]=new ir(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Rn[t]=new ir(t,5,!1,t.toLowerCase(),null,!1,!1)});var rS=/[\-:]([a-z])/g;function iS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(rS,iS);Rn[e]=new ir(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(rS,iS);Rn[e]=new ir(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(rS,iS);Rn[e]=new ir(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Rn[t]=new ir(t,1,!1,t.toLowerCase(),null,!1,!1)});Rn.xlinkHref=new ir("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Rn[t]=new ir(t,1,!1,t.toLowerCase(),null,!0,!0)});function sS(t,e,n,r){var i=Rn.hasOwnProperty(e)?Rn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(mO(e,n,i,r)&&(n=null),r||i===null?hO(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var fo=lT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,If=Symbol.for("react.element"),Rc=Symbol.for("react.portal"),Pc=Symbol.for("react.fragment"),oS=Symbol.for("react.strict_mode"),Cv=Symbol.for("react.profiler"),dT=Symbol.for("react.provider"),fT=Symbol.for("react.context"),aS=Symbol.for("react.forward_ref"),Tv=Symbol.for("react.suspense"),_v=Symbol.for("react.suspense_list"),cS=Symbol.for("react.memo"),Io=Symbol.for("react.lazy"),hT=Symbol.for("react.offscreen"),xw=Symbol.iterator;function lu(t){return t===null||typeof t!="object"?null:(t=xw&&t[xw]||t["@@iterator"],typeof t=="function"?t:null)}var Nt=Object.assign,hg;function Nu(t){if(hg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);hg=e&&e[1]||""}return`
`+hg+t}var pg=!1;function mg(t,e){if(!t||pg)return"";pg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{pg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Nu(t):""}function gO(t){switch(t.tag){case 5:return Nu(t.type);case 16:return Nu("Lazy");case 13:return Nu("Suspense");case 19:return Nu("SuspenseList");case 0:case 2:case 15:return t=mg(t.type,!1),t;case 11:return t=mg(t.type.render,!1),t;case 1:return t=mg(t.type,!0),t;default:return""}}function Iv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Pc:return"Fragment";case Rc:return"Portal";case Cv:return"Profiler";case oS:return"StrictMode";case Tv:return"Suspense";case _v:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case fT:return(t.displayName||"Context")+".Consumer";case dT:return(t._context.displayName||"Context")+".Provider";case aS:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cS:return e=t.displayName||null,e!==null?e:Iv(t.type)||"Memo";case Io:e=t._payload,t=t._init;try{return Iv(t(e))}catch{}}return null}function vO(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Iv(e);case 8:return e===oS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function oa(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function pT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yO(t){var e=pT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Rf(t){t._valueTracker||(t._valueTracker=yO(t))}function mT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=pT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Uh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Rv(t,e){var n=e.checked;return Nt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ow(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=oa(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function gT(t,e){e=e.checked,e!=null&&sS(t,"checked",e,!1)}function Pv(t,e){gT(t,e);var n=oa(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Av(t,e.type,n):e.hasOwnProperty("defaultValue")&&Av(t,e.type,oa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Dw(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Av(t,e,n){(e!=="number"||Uh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Mu=Array.isArray;function Kc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+oa(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Nv(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ae(91));return Nt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Lw(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ae(92));if(Mu(n)){if(1<n.length)throw Error(ae(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:oa(n)}}function vT(t,e){var n=oa(e.value),r=oa(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Fw(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Pf,ST=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Pf=Pf||document.createElement("div"),Pf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Pf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ld(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Vu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},SO=["Webkit","ms","Moz","O"];Object.keys(Vu).forEach(function(t){SO.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Vu[e]=Vu[t]})});function bT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Vu.hasOwnProperty(t)&&Vu[t]?(""+e).trim():e+"px"}function wT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=bT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var bO=Nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xv(t,e){if(e){if(bO[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ae(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ae(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ae(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ae(62))}}function Ov(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dv=null;function lS(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Lv=null,Yc=null,Xc=null;function Bw(t){if(t=tf(t)){if(typeof Lv!="function")throw Error(ae(280));var e=t.stateNode;e&&(e=tm(e),Lv(t.stateNode,t.type,e))}}function kT(t){Yc?Xc?Xc.push(t):Xc=[t]:Yc=t}function ET(){if(Yc){var t=Yc,e=Xc;if(Xc=Yc=null,Bw(t),e)for(t=0;t<e.length;t++)Bw(e[t])}}function CT(t,e){return t(e)}function TT(){}var gg=!1;function _T(t,e,n){if(gg)return t(e,n);gg=!0;try{return CT(t,e,n)}finally{gg=!1,(Yc!==null||Xc!==null)&&(TT(),ET())}}function ud(t,e){var n=t.stateNode;if(n===null)return null;var r=tm(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ae(231,e,typeof n));return n}var Fv=!1;if(ro)try{var uu={};Object.defineProperty(uu,"passive",{get:function(){Fv=!0}}),window.addEventListener("test",uu,uu),window.removeEventListener("test",uu,uu)}catch{Fv=!1}function wO(t,e,n,r,i,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var zu=!1,jh=null,Wh=!1,Bv=null,kO={onError:function(t){zu=!0,jh=t}};function EO(t,e,n,r,i,s,o,a,c){zu=!1,jh=null,wO.apply(kO,arguments)}function CO(t,e,n,r,i,s,o,a,c){if(EO.apply(this,arguments),zu){if(zu){var l=jh;zu=!1,jh=null}else throw Error(ae(198));Wh||(Wh=!0,Bv=l)}}function oc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function IT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Uw(t){if(oc(t)!==t)throw Error(ae(188))}function TO(t){var e=t.alternate;if(!e){if(e=oc(t),e===null)throw Error(ae(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Uw(i),t;if(s===r)return Uw(i),e;s=s.sibling}throw Error(ae(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ae(189))}}if(n.alternate!==r)throw Error(ae(190))}if(n.tag!==3)throw Error(ae(188));return n.stateNode.current===n?t:e}function RT(t){return t=TO(t),t!==null?PT(t):null}function PT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=PT(t);if(e!==null)return e;t=t.sibling}return null}var AT=Pr.unstable_scheduleCallback,jw=Pr.unstable_cancelCallback,_O=Pr.unstable_shouldYield,IO=Pr.unstable_requestPaint,zt=Pr.unstable_now,RO=Pr.unstable_getCurrentPriorityLevel,uS=Pr.unstable_ImmediatePriority,NT=Pr.unstable_UserBlockingPriority,Vh=Pr.unstable_NormalPriority,PO=Pr.unstable_LowPriority,MT=Pr.unstable_IdlePriority,Yp=null,as=null;function AO(t){if(as&&typeof as.onCommitFiberRoot=="function")try{as.onCommitFiberRoot(Yp,t,void 0,(t.current.flags&128)===128)}catch{}}var bi=Math.clz32?Math.clz32:xO,NO=Math.log,MO=Math.LN2;function xO(t){return t>>>=0,t===0?32:31-(NO(t)/MO|0)|0}var Af=64,Nf=4194304;function xu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function zh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=xu(a):(s&=o,s!==0&&(r=xu(s)))}else o=n&~i,o!==0?r=xu(o):s!==0&&(r=xu(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-bi(e),i=1<<n,r|=t[n],e&=~i;return r}function OO(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function DO(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-bi(s),a=1<<o,c=i[o];c===-1?(!(a&n)||a&r)&&(i[o]=OO(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function Uv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function xT(){var t=Af;return Af<<=1,!(Af&4194240)&&(Af=64),t}function vg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Qd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-bi(e),t[e]=n}function LO(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-bi(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function dS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-bi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var et=0;function OT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var DT,fS,LT,FT,BT,jv=!1,Mf=[],Go=null,qo=null,Jo=null,dd=new Map,fd=new Map,xo=[],FO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ww(t,e){switch(t){case"focusin":case"focusout":Go=null;break;case"dragenter":case"dragleave":qo=null;break;case"mouseover":case"mouseout":Jo=null;break;case"pointerover":case"pointerout":dd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fd.delete(e.pointerId)}}function du(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=tf(e),e!==null&&fS(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function BO(t,e,n,r,i){switch(e){case"focusin":return Go=du(Go,t,e,n,r,i),!0;case"dragenter":return qo=du(qo,t,e,n,r,i),!0;case"mouseover":return Jo=du(Jo,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return dd.set(s,du(dd.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,fd.set(s,du(fd.get(s)||null,t,e,n,r,i)),!0}return!1}function UT(t){var e=Ra(t.target);if(e!==null){var n=oc(e);if(n!==null){if(e=n.tag,e===13){if(e=IT(n),e!==null){t.blockedOn=e,BT(t.priority,function(){LT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function dh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Wv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Dv=r,n.target.dispatchEvent(r),Dv=null}else return e=tf(n),e!==null&&fS(e),t.blockedOn=n,!1;e.shift()}return!0}function Vw(t,e,n){dh(t)&&n.delete(e)}function UO(){jv=!1,Go!==null&&dh(Go)&&(Go=null),qo!==null&&dh(qo)&&(qo=null),Jo!==null&&dh(Jo)&&(Jo=null),dd.forEach(Vw),fd.forEach(Vw)}function fu(t,e){t.blockedOn===e&&(t.blockedOn=null,jv||(jv=!0,Pr.unstable_scheduleCallback(Pr.unstable_NormalPriority,UO)))}function hd(t){function e(i){return fu(i,t)}if(0<Mf.length){fu(Mf[0],t);for(var n=1;n<Mf.length;n++){var r=Mf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Go!==null&&fu(Go,t),qo!==null&&fu(qo,t),Jo!==null&&fu(Jo,t),dd.forEach(e),fd.forEach(e),n=0;n<xo.length;n++)r=xo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<xo.length&&(n=xo[0],n.blockedOn===null);)UT(n),n.blockedOn===null&&xo.shift()}var Qc=fo.ReactCurrentBatchConfig,$h=!0;function jO(t,e,n,r){var i=et,s=Qc.transition;Qc.transition=null;try{et=1,hS(t,e,n,r)}finally{et=i,Qc.transition=s}}function WO(t,e,n,r){var i=et,s=Qc.transition;Qc.transition=null;try{et=4,hS(t,e,n,r)}finally{et=i,Qc.transition=s}}function hS(t,e,n,r){if($h){var i=Wv(t,e,n,r);if(i===null)Ig(t,e,r,Hh,n),Ww(t,r);else if(BO(i,t,e,n,r))r.stopPropagation();else if(Ww(t,r),e&4&&-1<FO.indexOf(t)){for(;i!==null;){var s=tf(i);if(s!==null&&DT(s),s=Wv(t,e,n,r),s===null&&Ig(t,e,r,Hh,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Ig(t,e,r,null,n)}}var Hh=null;function Wv(t,e,n,r){if(Hh=null,t=lS(r),t=Ra(t),t!==null)if(e=oc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=IT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Hh=t,null}function jT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RO()){case uS:return 1;case NT:return 4;case Vh:case PO:return 16;case MT:return 536870912;default:return 16}default:return 16}}var Fo=null,pS=null,fh=null;function WT(){if(fh)return fh;var t,e=pS,n=e.length,r,i="value"in Fo?Fo.value:Fo.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return fh=i.slice(t,1<r?1-r:void 0)}function hh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function xf(){return!0}function zw(){return!1}function Mr(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?xf:zw,this.isPropagationStopped=zw,this}return Nt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=xf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=xf)},persist:function(){},isPersistent:xf}),e}var Hl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mS=Mr(Hl),ef=Nt({},Hl,{view:0,detail:0}),VO=Mr(ef),yg,Sg,hu,Xp=Nt({},ef,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==hu&&(hu&&t.type==="mousemove"?(yg=t.screenX-hu.screenX,Sg=t.screenY-hu.screenY):Sg=yg=0,hu=t),yg)},movementY:function(t){return"movementY"in t?t.movementY:Sg}}),$w=Mr(Xp),zO=Nt({},Xp,{dataTransfer:0}),$O=Mr(zO),HO=Nt({},ef,{relatedTarget:0}),bg=Mr(HO),GO=Nt({},Hl,{animationName:0,elapsedTime:0,pseudoElement:0}),qO=Mr(GO),JO=Nt({},Hl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ZO=Mr(JO),KO=Nt({},Hl,{data:0}),Hw=Mr(KO),YO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},XO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eD(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=QO[t])?!!e[t]:!1}function gS(){return eD}var tD=Nt({},ef,{key:function(t){if(t.key){var e=YO[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=hh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?XO[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gS,charCode:function(t){return t.type==="keypress"?hh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?hh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),nD=Mr(tD),rD=Nt({},Xp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gw=Mr(rD),iD=Nt({},ef,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gS}),sD=Mr(iD),oD=Nt({},Hl,{propertyName:0,elapsedTime:0,pseudoElement:0}),aD=Mr(oD),cD=Nt({},Xp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),lD=Mr(cD),uD=[9,13,27,32],vS=ro&&"CompositionEvent"in window,$u=null;ro&&"documentMode"in document&&($u=document.documentMode);var dD=ro&&"TextEvent"in window&&!$u,VT=ro&&(!vS||$u&&8<$u&&11>=$u),qw=" ",Jw=!1;function zT(t,e){switch(t){case"keyup":return uD.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $T(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ac=!1;function fD(t,e){switch(t){case"compositionend":return $T(e);case"keypress":return e.which!==32?null:(Jw=!0,qw);case"textInput":return t=e.data,t===qw&&Jw?null:t;default:return null}}function hD(t,e){if(Ac)return t==="compositionend"||!vS&&zT(t,e)?(t=WT(),fh=pS=Fo=null,Ac=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return VT&&e.locale!=="ko"?null:e.data;default:return null}}var pD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!pD[t.type]:e==="textarea"}function HT(t,e,n,r){kT(r),e=Gh(e,"onChange"),0<e.length&&(n=new mS("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Hu=null,pd=null;function mD(t){n_(t,0)}function Qp(t){var e=xc(t);if(mT(e))return t}function gD(t,e){if(t==="change")return e}var GT=!1;if(ro){var wg;if(ro){var kg="oninput"in document;if(!kg){var Kw=document.createElement("div");Kw.setAttribute("oninput","return;"),kg=typeof Kw.oninput=="function"}wg=kg}else wg=!1;GT=wg&&(!document.documentMode||9<document.documentMode)}function Yw(){Hu&&(Hu.detachEvent("onpropertychange",qT),pd=Hu=null)}function qT(t){if(t.propertyName==="value"&&Qp(pd)){var e=[];HT(e,pd,t,lS(t)),_T(mD,e)}}function vD(t,e,n){t==="focusin"?(Yw(),Hu=e,pd=n,Hu.attachEvent("onpropertychange",qT)):t==="focusout"&&Yw()}function yD(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qp(pd)}function SD(t,e){if(t==="click")return Qp(e)}function bD(t,e){if(t==="input"||t==="change")return Qp(e)}function wD(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ci=typeof Object.is=="function"?Object.is:wD;function md(t,e){if(Ci(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Ev.call(e,i)||!Ci(t[i],e[i]))return!1}return!0}function Xw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Qw(t,e){var n=Xw(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Xw(n)}}function JT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?JT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ZT(){for(var t=window,e=Uh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Uh(t.document)}return e}function yS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function kD(t){var e=ZT(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&JT(n.ownerDocument.documentElement,n)){if(r!==null&&yS(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Qw(n,s);var o=Qw(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ED=ro&&"documentMode"in document&&11>=document.documentMode,Nc=null,Vv=null,Gu=null,zv=!1;function ek(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;zv||Nc==null||Nc!==Uh(r)||(r=Nc,"selectionStart"in r&&yS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Gu&&md(Gu,r)||(Gu=r,r=Gh(Vv,"onSelect"),0<r.length&&(e=new mS("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Nc)))}function Of(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Mc={animationend:Of("Animation","AnimationEnd"),animationiteration:Of("Animation","AnimationIteration"),animationstart:Of("Animation","AnimationStart"),transitionend:Of("Transition","TransitionEnd")},Eg={},KT={};ro&&(KT=document.createElement("div").style,"AnimationEvent"in window||(delete Mc.animationend.animation,delete Mc.animationiteration.animation,delete Mc.animationstart.animation),"TransitionEvent"in window||delete Mc.transitionend.transition);function em(t){if(Eg[t])return Eg[t];if(!Mc[t])return t;var e=Mc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in KT)return Eg[t]=e[n];return t}var YT=em("animationend"),XT=em("animationiteration"),QT=em("animationstart"),e_=em("transitionend"),t_=new Map,tk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ha(t,e){t_.set(t,e),sc(e,[t])}for(var Cg=0;Cg<tk.length;Cg++){var Tg=tk[Cg],CD=Tg.toLowerCase(),TD=Tg[0].toUpperCase()+Tg.slice(1);ha(CD,"on"+TD)}ha(YT,"onAnimationEnd");ha(XT,"onAnimationIteration");ha(QT,"onAnimationStart");ha("dblclick","onDoubleClick");ha("focusin","onFocus");ha("focusout","onBlur");ha(e_,"onTransitionEnd");wl("onMouseEnter",["mouseout","mouseover"]);wl("onMouseLeave",["mouseout","mouseover"]);wl("onPointerEnter",["pointerout","pointerover"]);wl("onPointerLeave",["pointerout","pointerover"]);sc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sc("onBeforeInput",["compositionend","keypress","textInput","paste"]);sc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ou="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_D=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ou));function nk(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,CO(r,e,void 0,t),t.currentTarget=null}function n_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;nk(i,a,l),s=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;nk(i,a,l),s=c}}}if(Wh)throw t=Bv,Wh=!1,Bv=null,t}function vt(t,e){var n=e[Jv];n===void 0&&(n=e[Jv]=new Set);var r=t+"__bubble";n.has(r)||(r_(e,t,2,!1),n.add(r))}function _g(t,e,n){var r=0;e&&(r|=4),r_(n,t,r,e)}var Df="_reactListening"+Math.random().toString(36).slice(2);function gd(t){if(!t[Df]){t[Df]=!0,uT.forEach(function(n){n!=="selectionchange"&&(_D.has(n)||_g(n,!1,t),_g(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Df]||(e[Df]=!0,_g("selectionchange",!1,e))}}function r_(t,e,n,r){switch(jT(e)){case 1:var i=jO;break;case 4:i=WO;break;default:i=hS}n=i.bind(null,e,n,t),i=void 0,!Fv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Ig(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ra(a),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}a=a.parentNode}}r=r.return}_T(function(){var l=s,u=lS(n),d=[];e:{var f=t_.get(t);if(f!==void 0){var h=mS,p=t;switch(t){case"keypress":if(hh(n)===0)break e;case"keydown":case"keyup":h=nD;break;case"focusin":p="focus",h=bg;break;case"focusout":p="blur",h=bg;break;case"beforeblur":case"afterblur":h=bg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=$w;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=$O;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=sD;break;case YT:case XT:case QT:h=qO;break;case e_:h=aD;break;case"scroll":h=VO;break;case"wheel":h=lD;break;case"copy":case"cut":case"paste":h=ZO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Gw}var g=(e&4)!==0,y=!g&&t==="scroll",m=g?f!==null?f+"Capture":null:f;g=[];for(var v=l,w;v!==null;){w=v;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,m!==null&&(_=ud(v,m),_!=null&&g.push(vd(v,_,w)))),y)break;v=v.return}0<g.length&&(f=new h(f,p,null,n,u),d.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Dv&&(p=n.relatedTarget||n.fromElement)&&(Ra(p)||p[io]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?Ra(p):null,p!==null&&(y=oc(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(g=$w,_="onMouseLeave",m="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(g=Gw,_="onPointerLeave",m="onPointerEnter",v="pointer"),y=h==null?f:xc(h),w=p==null?f:xc(p),f=new g(_,v+"leave",h,n,u),f.target=y,f.relatedTarget=w,_=null,Ra(u)===l&&(g=new g(m,v+"enter",p,n,u),g.target=w,g.relatedTarget=y,_=g),y=_,h&&p)t:{for(g=h,m=p,v=0,w=g;w;w=Sc(w))v++;for(w=0,_=m;_;_=Sc(_))w++;for(;0<v-w;)g=Sc(g),v--;for(;0<w-v;)m=Sc(m),w--;for(;v--;){if(g===m||m!==null&&g===m.alternate)break t;g=Sc(g),m=Sc(m)}g=null}else g=null;h!==null&&rk(d,f,h,g,!1),p!==null&&y!==null&&rk(d,y,p,g,!0)}}e:{if(f=l?xc(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var C=gD;else if(Zw(f))if(GT)C=bD;else{C=yD;var k=vD}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=SD);if(C&&(C=C(t,l))){HT(d,C,n,u);break e}k&&k(t,f,l),t==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&Av(f,"number",f.value)}switch(k=l?xc(l):window,t){case"focusin":(Zw(k)||k.contentEditable==="true")&&(Nc=k,Vv=l,Gu=null);break;case"focusout":Gu=Vv=Nc=null;break;case"mousedown":zv=!0;break;case"contextmenu":case"mouseup":case"dragend":zv=!1,ek(d,n,u);break;case"selectionchange":if(ED)break;case"keydown":case"keyup":ek(d,n,u)}var T;if(vS)e:{switch(t){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Ac?zT(t,n)&&(R="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(VT&&n.locale!=="ko"&&(Ac||R!=="onCompositionStart"?R==="onCompositionEnd"&&Ac&&(T=WT()):(Fo=u,pS="value"in Fo?Fo.value:Fo.textContent,Ac=!0)),k=Gh(l,R),0<k.length&&(R=new Hw(R,t,null,n,u),d.push({event:R,listeners:k}),T?R.data=T:(T=$T(n),T!==null&&(R.data=T)))),(T=dD?fD(t,n):hD(t,n))&&(l=Gh(l,"onBeforeInput"),0<l.length&&(u=new Hw("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:l}),u.data=T))}n_(d,e)})}function vd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Gh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ud(t,n),s!=null&&r.unshift(vd(t,s,i)),s=ud(t,e),s!=null&&r.push(vd(t,s,i))),t=t.return}return r}function Sc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function rk(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&l!==null&&(a=l,i?(c=ud(n,s),c!=null&&o.unshift(vd(n,c,a))):i||(c=ud(n,s),c!=null&&o.push(vd(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var ID=/\r\n?/g,RD=/\u0000|\uFFFD/g;function ik(t){return(typeof t=="string"?t:""+t).replace(ID,`
`).replace(RD,"")}function Lf(t,e,n){if(e=ik(e),ik(t)!==e&&n)throw Error(ae(425))}function qh(){}var $v=null,Hv=null;function Gv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var qv=typeof setTimeout=="function"?setTimeout:void 0,PD=typeof clearTimeout=="function"?clearTimeout:void 0,sk=typeof Promise=="function"?Promise:void 0,AD=typeof queueMicrotask=="function"?queueMicrotask:typeof sk<"u"?function(t){return sk.resolve(null).then(t).catch(ND)}:qv;function ND(t){setTimeout(function(){throw t})}function Rg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),hd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);hd(e)}function Zo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ok(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Gl=Math.random().toString(36).slice(2),Ui="__reactFiber$"+Gl,yd="__reactProps$"+Gl,io="__reactContainer$"+Gl,Jv="__reactEvents$"+Gl,MD="__reactListeners$"+Gl,xD="__reactHandles$"+Gl;function Ra(t){var e=t[Ui];if(e)return e;for(var n=t.parentNode;n;){if(e=n[io]||n[Ui]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ok(t);t!==null;){if(n=t[Ui])return n;t=ok(t)}return e}t=n,n=t.parentNode}return null}function tf(t){return t=t[Ui]||t[io],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ae(33))}function tm(t){return t[yd]||null}var Zv=[],Oc=-1;function pa(t){return{current:t}}function bt(t){0>Oc||(t.current=Zv[Oc],Zv[Oc]=null,Oc--)}function mt(t,e){Oc++,Zv[Oc]=t.current,t.current=e}var aa={},jn=pa(aa),dr=pa(!1),Va=aa;function kl(t,e){var n=t.type.contextTypes;if(!n)return aa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function fr(t){return t=t.childContextTypes,t!=null}function Jh(){bt(dr),bt(jn)}function ak(t,e,n){if(jn.current!==aa)throw Error(ae(168));mt(jn,e),mt(dr,n)}function i_(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ae(108,vO(t)||"Unknown",i));return Nt({},n,r)}function Zh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||aa,Va=jn.current,mt(jn,t),mt(dr,dr.current),!0}function ck(t,e,n){var r=t.stateNode;if(!r)throw Error(ae(169));n?(t=i_(t,e,Va),r.__reactInternalMemoizedMergedChildContext=t,bt(dr),bt(jn),mt(jn,t)):bt(dr),mt(dr,n)}var ks=null,nm=!1,Pg=!1;function s_(t){ks===null?ks=[t]:ks.push(t)}function OD(t){nm=!0,s_(t)}function ma(){if(!Pg&&ks!==null){Pg=!0;var t=0,e=et;try{var n=ks;for(et=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ks=null,nm=!1}catch(i){throw ks!==null&&(ks=ks.slice(t+1)),AT(uS,ma),i}finally{et=e,Pg=!1}}return null}var Dc=[],Lc=0,Kh=null,Yh=0,Fr=[],Br=0,za=null,Is=1,Rs="";function Ta(t,e){Dc[Lc++]=Yh,Dc[Lc++]=Kh,Kh=t,Yh=e}function o_(t,e,n){Fr[Br++]=Is,Fr[Br++]=Rs,Fr[Br++]=za,za=t;var r=Is;t=Rs;var i=32-bi(r)-1;r&=~(1<<i),n+=1;var s=32-bi(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Is=1<<32-bi(e)+i|n<<i|r,Rs=s+t}else Is=1<<s|n<<i|r,Rs=t}function SS(t){t.return!==null&&(Ta(t,1),o_(t,1,0))}function bS(t){for(;t===Kh;)Kh=Dc[--Lc],Dc[Lc]=null,Yh=Dc[--Lc],Dc[Lc]=null;for(;t===za;)za=Fr[--Br],Fr[Br]=null,Rs=Fr[--Br],Fr[Br]=null,Is=Fr[--Br],Fr[Br]=null}var Ir=null,Tr=null,_t=!1,di=null;function a_(t,e){var n=jr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function lk(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ir=t,Tr=Zo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ir=t,Tr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=za!==null?{id:Is,overflow:Rs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=jr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ir=t,Tr=null,!0):!1;default:return!1}}function Kv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Yv(t){if(_t){var e=Tr;if(e){var n=e;if(!lk(t,e)){if(Kv(t))throw Error(ae(418));e=Zo(n.nextSibling);var r=Ir;e&&lk(t,e)?a_(r,n):(t.flags=t.flags&-4097|2,_t=!1,Ir=t)}}else{if(Kv(t))throw Error(ae(418));t.flags=t.flags&-4097|2,_t=!1,Ir=t}}}function uk(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ir=t}function Ff(t){if(t!==Ir)return!1;if(!_t)return uk(t),_t=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Gv(t.type,t.memoizedProps)),e&&(e=Tr)){if(Kv(t))throw c_(),Error(ae(418));for(;e;)a_(t,e),e=Zo(e.nextSibling)}if(uk(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ae(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Tr=Zo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Tr=null}}else Tr=Ir?Zo(t.stateNode.nextSibling):null;return!0}function c_(){for(var t=Tr;t;)t=Zo(t.nextSibling)}function El(){Tr=Ir=null,_t=!1}function wS(t){di===null?di=[t]:di.push(t)}var DD=fo.ReactCurrentBatchConfig;function Qr(t,e){if(t&&t.defaultProps){e=Nt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Xh=pa(null),Qh=null,Fc=null,kS=null;function ES(){kS=Fc=Qh=null}function CS(t){var e=Xh.current;bt(Xh),t._currentValue=e}function Xv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function el(t,e){Qh=t,kS=Fc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(lr=!0),t.firstContext=null)}function Hr(t){var e=t._currentValue;if(kS!==t)if(t={context:t,memoizedValue:e,next:null},Fc===null){if(Qh===null)throw Error(ae(308));Fc=t,Qh.dependencies={lanes:0,firstContext:t}}else Fc=Fc.next=t;return e}var Pa=null;function TS(t){Pa===null?Pa=[t]:Pa.push(t)}function l_(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,TS(e)):(n.next=i.next,i.next=n),e.interleaved=n,so(t,r)}function so(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ro=!1;function _S(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function u_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ko(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,so(t,n)}return i=r.interleaved,i===null?(e.next=e,TS(r)):(e.next=i.next,i.next=e),r.interleaved=e,so(t,n)}function ph(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,dS(t,n)}}function dk(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ep(t,e,n,r){var i=t.updateQueue;Ro=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?s=l:o.next=l,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(s!==null){var d=i.baseState;o=0,u=l=c=null,a=s;do{var f=a.lane,h=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,g=a;switch(f=e,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Nt({},d,f);break e;case 2:Ro=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=h,c=d):u=u.next=h,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ha|=o,t.lanes=o,t.memoizedState=d}}function fk(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ae(191,i));i.call(r)}}}var d_=new lT.Component().refs;function Qv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Nt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var rm={isMounted:function(t){return(t=t._reactInternals)?oc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=nr(),i=Xo(t),s=Qs(r,i);s.payload=e,n!=null&&(s.callback=n),e=Ko(t,s,i),e!==null&&(wi(e,t,i,r),ph(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=nr(),i=Xo(t),s=Qs(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ko(t,s,i),e!==null&&(wi(e,t,i,r),ph(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=nr(),r=Xo(t),i=Qs(n,r);i.tag=2,e!=null&&(i.callback=e),e=Ko(t,i,r),e!==null&&(wi(e,t,r,n),ph(e,t,r))}};function hk(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!md(n,r)||!md(i,s):!0}function f_(t,e,n){var r=!1,i=aa,s=e.contextType;return typeof s=="object"&&s!==null?s=Hr(s):(i=fr(e)?Va:jn.current,r=e.contextTypes,s=(r=r!=null)?kl(t,i):aa),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=rm,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function pk(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&rm.enqueueReplaceState(e,e.state,null)}function ey(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=d_,_S(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Hr(s):(s=fr(e)?Va:jn.current,i.context=kl(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Qv(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&rm.enqueueReplaceState(i,i.state,null),ep(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function pu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ae(309));var r=n.stateNode}if(!r)throw Error(ae(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===d_&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ae(284));if(!n._owner)throw Error(ae(290,t))}return t}function Bf(t,e){throw t=Object.prototype.toString.call(e),Error(ae(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function mk(t){var e=t._init;return e(t._payload)}function h_(t){function e(m,v){if(t){var w=m.deletions;w===null?(m.deletions=[v],m.flags|=16):w.push(v)}}function n(m,v){if(!t)return null;for(;v!==null;)e(m,v),v=v.sibling;return null}function r(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function i(m,v){return m=Qo(m,v),m.index=0,m.sibling=null,m}function s(m,v,w){return m.index=w,t?(w=m.alternate,w!==null?(w=w.index,w<v?(m.flags|=2,v):w):(m.flags|=2,v)):(m.flags|=1048576,v)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,v,w,_){return v===null||v.tag!==6?(v=Lg(w,m.mode,_),v.return=m,v):(v=i(v,w),v.return=m,v)}function c(m,v,w,_){var C=w.type;return C===Pc?u(m,v,w.props.children,_,w.key):v!==null&&(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Io&&mk(C)===v.type)?(_=i(v,w.props),_.ref=pu(m,v,w),_.return=m,_):(_=bh(w.type,w.key,w.props,null,m.mode,_),_.ref=pu(m,v,w),_.return=m,_)}function l(m,v,w,_){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=Fg(w,m.mode,_),v.return=m,v):(v=i(v,w.children||[]),v.return=m,v)}function u(m,v,w,_,C){return v===null||v.tag!==7?(v=Ba(w,m.mode,_,C),v.return=m,v):(v=i(v,w),v.return=m,v)}function d(m,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Lg(""+v,m.mode,w),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case If:return w=bh(v.type,v.key,v.props,null,m.mode,w),w.ref=pu(m,null,v),w.return=m,w;case Rc:return v=Fg(v,m.mode,w),v.return=m,v;case Io:var _=v._init;return d(m,_(v._payload),w)}if(Mu(v)||lu(v))return v=Ba(v,m.mode,w,null),v.return=m,v;Bf(m,v)}return null}function f(m,v,w,_){var C=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:a(m,v,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case If:return w.key===C?c(m,v,w,_):null;case Rc:return w.key===C?l(m,v,w,_):null;case Io:return C=w._init,f(m,v,C(w._payload),_)}if(Mu(w)||lu(w))return C!==null?null:u(m,v,w,_,null);Bf(m,w)}return null}function h(m,v,w,_,C){if(typeof _=="string"&&_!==""||typeof _=="number")return m=m.get(w)||null,a(v,m,""+_,C);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case If:return m=m.get(_.key===null?w:_.key)||null,c(v,m,_,C);case Rc:return m=m.get(_.key===null?w:_.key)||null,l(v,m,_,C);case Io:var k=_._init;return h(m,v,w,k(_._payload),C)}if(Mu(_)||lu(_))return m=m.get(w)||null,u(v,m,_,C,null);Bf(v,_)}return null}function p(m,v,w,_){for(var C=null,k=null,T=v,R=v=0,A=null;T!==null&&R<w.length;R++){T.index>R?(A=T,T=null):A=T.sibling;var M=f(m,T,w[R],_);if(M===null){T===null&&(T=A);break}t&&T&&M.alternate===null&&e(m,T),v=s(M,v,R),k===null?C=M:k.sibling=M,k=M,T=A}if(R===w.length)return n(m,T),_t&&Ta(m,R),C;if(T===null){for(;R<w.length;R++)T=d(m,w[R],_),T!==null&&(v=s(T,v,R),k===null?C=T:k.sibling=T,k=T);return _t&&Ta(m,R),C}for(T=r(m,T);R<w.length;R++)A=h(T,m,R,w[R],_),A!==null&&(t&&A.alternate!==null&&T.delete(A.key===null?R:A.key),v=s(A,v,R),k===null?C=A:k.sibling=A,k=A);return t&&T.forEach(function(O){return e(m,O)}),_t&&Ta(m,R),C}function g(m,v,w,_){var C=lu(w);if(typeof C!="function")throw Error(ae(150));if(w=C.call(w),w==null)throw Error(ae(151));for(var k=C=null,T=v,R=v=0,A=null,M=w.next();T!==null&&!M.done;R++,M=w.next()){T.index>R?(A=T,T=null):A=T.sibling;var O=f(m,T,M.value,_);if(O===null){T===null&&(T=A);break}t&&T&&O.alternate===null&&e(m,T),v=s(O,v,R),k===null?C=O:k.sibling=O,k=O,T=A}if(M.done)return n(m,T),_t&&Ta(m,R),C;if(T===null){for(;!M.done;R++,M=w.next())M=d(m,M.value,_),M!==null&&(v=s(M,v,R),k===null?C=M:k.sibling=M,k=M);return _t&&Ta(m,R),C}for(T=r(m,T);!M.done;R++,M=w.next())M=h(T,m,R,M.value,_),M!==null&&(t&&M.alternate!==null&&T.delete(M.key===null?R:M.key),v=s(M,v,R),k===null?C=M:k.sibling=M,k=M);return t&&T.forEach(function(D){return e(m,D)}),_t&&Ta(m,R),C}function y(m,v,w,_){if(typeof w=="object"&&w!==null&&w.type===Pc&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case If:e:{for(var C=w.key,k=v;k!==null;){if(k.key===C){if(C=w.type,C===Pc){if(k.tag===7){n(m,k.sibling),v=i(k,w.props.children),v.return=m,m=v;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Io&&mk(C)===k.type){n(m,k.sibling),v=i(k,w.props),v.ref=pu(m,k,w),v.return=m,m=v;break e}n(m,k);break}else e(m,k);k=k.sibling}w.type===Pc?(v=Ba(w.props.children,m.mode,_,w.key),v.return=m,m=v):(_=bh(w.type,w.key,w.props,null,m.mode,_),_.ref=pu(m,v,w),_.return=m,m=_)}return o(m);case Rc:e:{for(k=w.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(m,v.sibling),v=i(v,w.children||[]),v.return=m,m=v;break e}else{n(m,v);break}else e(m,v);v=v.sibling}v=Fg(w,m.mode,_),v.return=m,m=v}return o(m);case Io:return k=w._init,y(m,v,k(w._payload),_)}if(Mu(w))return p(m,v,w,_);if(lu(w))return g(m,v,w,_);Bf(m,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(m,v.sibling),v=i(v,w),v.return=m,m=v):(n(m,v),v=Lg(w,m.mode,_),v.return=m,m=v),o(m)):n(m,v)}return y}var Cl=h_(!0),p_=h_(!1),nf={},cs=pa(nf),Sd=pa(nf),bd=pa(nf);function Aa(t){if(t===nf)throw Error(ae(174));return t}function IS(t,e){switch(mt(bd,e),mt(Sd,t),mt(cs,nf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Mv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Mv(e,t)}bt(cs),mt(cs,e)}function Tl(){bt(cs),bt(Sd),bt(bd)}function m_(t){Aa(bd.current);var e=Aa(cs.current),n=Mv(e,t.type);e!==n&&(mt(Sd,t),mt(cs,n))}function RS(t){Sd.current===t&&(bt(cs),bt(Sd))}var It=pa(0);function tp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ag=[];function PS(){for(var t=0;t<Ag.length;t++)Ag[t]._workInProgressVersionPrimary=null;Ag.length=0}var mh=fo.ReactCurrentDispatcher,Ng=fo.ReactCurrentBatchConfig,$a=0,At=null,en=null,pn=null,np=!1,qu=!1,wd=0,LD=0;function Mn(){throw Error(ae(321))}function AS(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ci(t[n],e[n]))return!1;return!0}function NS(t,e,n,r,i,s){if($a=s,At=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,mh.current=t===null||t.memoizedState===null?jD:WD,t=n(r,i),qu){s=0;do{if(qu=!1,wd=0,25<=s)throw Error(ae(301));s+=1,pn=en=null,e.updateQueue=null,mh.current=VD,t=n(r,i)}while(qu)}if(mh.current=rp,e=en!==null&&en.next!==null,$a=0,pn=en=At=null,np=!1,e)throw Error(ae(300));return t}function MS(){var t=wd!==0;return wd=0,t}function xi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?At.memoizedState=pn=t:pn=pn.next=t,pn}function Gr(){if(en===null){var t=At.alternate;t=t!==null?t.memoizedState:null}else t=en.next;var e=pn===null?At.memoizedState:pn.next;if(e!==null)pn=e,en=t;else{if(t===null)throw Error(ae(310));en=t,t={memoizedState:en.memoizedState,baseState:en.baseState,baseQueue:en.baseQueue,queue:en.queue,next:null},pn===null?At.memoizedState=pn=t:pn=pn.next=t}return pn}function kd(t,e){return typeof e=="function"?e(t):e}function Mg(t){var e=Gr(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var r=en,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,c=null,l=s;do{var u=l.lane;if(($a&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=d,o=r):c=c.next=d,At.lanes|=u,Ha|=u}l=l.next}while(l!==null&&l!==s);c===null?o=r:c.next=a,Ci(r,e.memoizedState)||(lr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,At.lanes|=s,Ha|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function xg(t){var e=Gr(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ci(s,e.memoizedState)||(lr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function g_(){}function v_(t,e){var n=At,r=Gr(),i=e(),s=!Ci(r.memoizedState,i);if(s&&(r.memoizedState=i,lr=!0),r=r.queue,xS(b_.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||pn!==null&&pn.memoizedState.tag&1){if(n.flags|=2048,Ed(9,S_.bind(null,n,r,i,e),void 0,null),vn===null)throw Error(ae(349));$a&30||y_(n,e,i)}return i}function y_(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=At.updateQueue,e===null?(e={lastEffect:null,stores:null},At.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function S_(t,e,n,r){e.value=n,e.getSnapshot=r,w_(e)&&k_(t)}function b_(t,e,n){return n(function(){w_(e)&&k_(t)})}function w_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ci(t,n)}catch{return!0}}function k_(t){var e=so(t,1);e!==null&&wi(e,t,1,-1)}function gk(t){var e=xi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kd,lastRenderedState:t},e.queue=t,t=t.dispatch=UD.bind(null,At,t),[e.memoizedState,t]}function Ed(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=At.updateQueue,e===null?(e={lastEffect:null,stores:null},At.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function E_(){return Gr().memoizedState}function gh(t,e,n,r){var i=xi();At.flags|=t,i.memoizedState=Ed(1|e,n,void 0,r===void 0?null:r)}function im(t,e,n,r){var i=Gr();r=r===void 0?null:r;var s=void 0;if(en!==null){var o=en.memoizedState;if(s=o.destroy,r!==null&&AS(r,o.deps)){i.memoizedState=Ed(e,n,s,r);return}}At.flags|=t,i.memoizedState=Ed(1|e,n,s,r)}function vk(t,e){return gh(8390656,8,t,e)}function xS(t,e){return im(2048,8,t,e)}function C_(t,e){return im(4,2,t,e)}function T_(t,e){return im(4,4,t,e)}function __(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function I_(t,e,n){return n=n!=null?n.concat([t]):null,im(4,4,__.bind(null,e,t),n)}function OS(){}function R_(t,e){var n=Gr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&AS(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function P_(t,e){var n=Gr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&AS(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function A_(t,e,n){return $a&21?(Ci(n,e)||(n=xT(),At.lanes|=n,Ha|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,lr=!0),t.memoizedState=n)}function FD(t,e){var n=et;et=n!==0&&4>n?n:4,t(!0);var r=Ng.transition;Ng.transition={};try{t(!1),e()}finally{et=n,Ng.transition=r}}function N_(){return Gr().memoizedState}function BD(t,e,n){var r=Xo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},M_(t))x_(e,n);else if(n=l_(t,e,n,r),n!==null){var i=nr();wi(n,t,r,i),O_(n,e,r)}}function UD(t,e,n){var r=Xo(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(M_(t))x_(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Ci(a,o)){var c=e.interleaved;c===null?(i.next=i,TS(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=l_(t,e,i,r),n!==null&&(i=nr(),wi(n,t,r,i),O_(n,e,r))}}function M_(t){var e=t.alternate;return t===At||e!==null&&e===At}function x_(t,e){qu=np=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function O_(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,dS(t,n)}}var rp={readContext:Hr,useCallback:Mn,useContext:Mn,useEffect:Mn,useImperativeHandle:Mn,useInsertionEffect:Mn,useLayoutEffect:Mn,useMemo:Mn,useReducer:Mn,useRef:Mn,useState:Mn,useDebugValue:Mn,useDeferredValue:Mn,useTransition:Mn,useMutableSource:Mn,useSyncExternalStore:Mn,useId:Mn,unstable_isNewReconciler:!1},jD={readContext:Hr,useCallback:function(t,e){return xi().memoizedState=[t,e===void 0?null:e],t},useContext:Hr,useEffect:vk,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,gh(4194308,4,__.bind(null,e,t),n)},useLayoutEffect:function(t,e){return gh(4194308,4,t,e)},useInsertionEffect:function(t,e){return gh(4,2,t,e)},useMemo:function(t,e){var n=xi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=xi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=BD.bind(null,At,t),[r.memoizedState,t]},useRef:function(t){var e=xi();return t={current:t},e.memoizedState=t},useState:gk,useDebugValue:OS,useDeferredValue:function(t){return xi().memoizedState=t},useTransition:function(){var t=gk(!1),e=t[0];return t=FD.bind(null,t[1]),xi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=At,i=xi();if(_t){if(n===void 0)throw Error(ae(407));n=n()}else{if(n=e(),vn===null)throw Error(ae(349));$a&30||y_(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,vk(b_.bind(null,r,s,t),[t]),r.flags|=2048,Ed(9,S_.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=xi(),e=vn.identifierPrefix;if(_t){var n=Rs,r=Is;n=(r&~(1<<32-bi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=wd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=LD++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},WD={readContext:Hr,useCallback:R_,useContext:Hr,useEffect:xS,useImperativeHandle:I_,useInsertionEffect:C_,useLayoutEffect:T_,useMemo:P_,useReducer:Mg,useRef:E_,useState:function(){return Mg(kd)},useDebugValue:OS,useDeferredValue:function(t){var e=Gr();return A_(e,en.memoizedState,t)},useTransition:function(){var t=Mg(kd)[0],e=Gr().memoizedState;return[t,e]},useMutableSource:g_,useSyncExternalStore:v_,useId:N_,unstable_isNewReconciler:!1},VD={readContext:Hr,useCallback:R_,useContext:Hr,useEffect:xS,useImperativeHandle:I_,useInsertionEffect:C_,useLayoutEffect:T_,useMemo:P_,useReducer:xg,useRef:E_,useState:function(){return xg(kd)},useDebugValue:OS,useDeferredValue:function(t){var e=Gr();return en===null?e.memoizedState=t:A_(e,en.memoizedState,t)},useTransition:function(){var t=xg(kd)[0],e=Gr().memoizedState;return[t,e]},useMutableSource:g_,useSyncExternalStore:v_,useId:N_,unstable_isNewReconciler:!1};function _l(t,e){try{var n="",r=e;do n+=gO(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Og(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ty(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var zD=typeof WeakMap=="function"?WeakMap:Map;function D_(t,e,n){n=Qs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){sp||(sp=!0,dy=r),ty(t,e)},n}function L_(t,e,n){n=Qs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){ty(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){ty(t,e),typeof r!="function"&&(Yo===null?Yo=new Set([this]):Yo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function yk(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new zD;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=rL.bind(null,t,e,n),e.then(t,t))}function Sk(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function bk(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Qs(-1,1),e.tag=2,Ko(n,e,1))),n.lanes|=1),t)}var $D=fo.ReactCurrentOwner,lr=!1;function Gn(t,e,n,r){e.child=t===null?p_(e,null,n,r):Cl(e,t.child,n,r)}function wk(t,e,n,r,i){n=n.render;var s=e.ref;return el(e,i),r=NS(t,e,n,r,s,i),n=MS(),t!==null&&!lr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oo(t,e,i)):(_t&&n&&SS(e),e.flags|=1,Gn(t,e,r,i),e.child)}function kk(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!VS(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,F_(t,e,s,r,i)):(t=bh(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:md,n(o,r)&&t.ref===e.ref)return oo(t,e,i)}return e.flags|=1,t=Qo(s,r),t.ref=e.ref,t.return=e,e.child=t}function F_(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(md(s,r)&&t.ref===e.ref)if(lr=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(lr=!0);else return e.lanes=t.lanes,oo(t,e,i)}return ny(t,e,n,r,i)}function B_(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(Uc,kr),kr|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,mt(Uc,kr),kr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,mt(Uc,kr),kr|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,mt(Uc,kr),kr|=r;return Gn(t,e,i,n),e.child}function U_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ny(t,e,n,r,i){var s=fr(n)?Va:jn.current;return s=kl(e,s),el(e,i),n=NS(t,e,n,r,s,i),r=MS(),t!==null&&!lr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oo(t,e,i)):(_t&&r&&SS(e),e.flags|=1,Gn(t,e,n,i),e.child)}function Ek(t,e,n,r,i){if(fr(n)){var s=!0;Zh(e)}else s=!1;if(el(e,i),e.stateNode===null)vh(t,e),f_(e,n,r),ey(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=Hr(l):(l=fr(n)?Va:jn.current,l=kl(e,l));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==l)&&pk(e,o,r,l),Ro=!1;var f=e.memoizedState;o.state=f,ep(e,r,o,i),c=e.memoizedState,a!==r||f!==c||dr.current||Ro?(typeof u=="function"&&(Qv(e,n,u,r),c=e.memoizedState),(a=Ro||hk(e,n,a,r,f,c,l))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=l,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,u_(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:Qr(e.type,a),o.props=l,d=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Hr(c):(c=fr(n)?Va:jn.current,c=kl(e,c));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==c)&&pk(e,o,r,c),Ro=!1,f=e.memoizedState,o.state=f,ep(e,r,o,i);var p=e.memoizedState;a!==d||f!==p||dr.current||Ro?(typeof h=="function"&&(Qv(e,n,h,r),p=e.memoizedState),(l=Ro||hk(e,n,l,r,f,p,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=c,r=l):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return ry(t,e,n,r,s,i)}function ry(t,e,n,r,i,s){U_(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&ck(e,n,!1),oo(t,e,s);r=e.stateNode,$D.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Cl(e,t.child,null,s),e.child=Cl(e,null,a,s)):Gn(t,e,a,s),e.memoizedState=r.state,i&&ck(e,n,!0),e.child}function j_(t){var e=t.stateNode;e.pendingContext?ak(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ak(t,e.context,!1),IS(t,e.containerInfo)}function Ck(t,e,n,r,i){return El(),wS(i),e.flags|=256,Gn(t,e,n,r),e.child}var iy={dehydrated:null,treeContext:null,retryLane:0};function sy(t){return{baseLanes:t,cachePool:null,transitions:null}}function W_(t,e,n){var r=e.pendingProps,i=It.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),mt(It,i&1),t===null)return Yv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=am(o,r,0,null),t=Ba(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=sy(n),e.memoizedState=iy,t):DS(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return HD(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Qo(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Qo(a,s):(s=Ba(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?sy(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=iy,r}return s=t.child,t=s.sibling,r=Qo(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function DS(t,e){return e=am({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Uf(t,e,n,r){return r!==null&&wS(r),Cl(e,t.child,null,n),t=DS(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function HD(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Og(Error(ae(422))),Uf(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=am({mode:"visible",children:r.children},i,0,null),s=Ba(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Cl(e,t.child,null,o),e.child.memoizedState=sy(o),e.memoizedState=iy,s);if(!(e.mode&1))return Uf(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ae(419)),r=Og(s,r,void 0),Uf(t,e,o,r)}if(a=(o&t.childLanes)!==0,lr||a){if(r=vn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,so(t,i),wi(r,t,i,-1))}return WS(),r=Og(Error(ae(421))),Uf(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=iL.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Tr=Zo(i.nextSibling),Ir=e,_t=!0,di=null,t!==null&&(Fr[Br++]=Is,Fr[Br++]=Rs,Fr[Br++]=za,Is=t.id,Rs=t.overflow,za=e),e=DS(e,r.children),e.flags|=4096,e)}function Tk(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Xv(t.return,e,n)}function Dg(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function V_(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Gn(t,e,r.children,n),r=It.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Tk(t,n,e);else if(t.tag===19)Tk(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(mt(It,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&tp(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Dg(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&tp(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Dg(e,!0,n,null,s);break;case"together":Dg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function vh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function oo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ha|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ae(153));if(e.child!==null){for(t=e.child,n=Qo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Qo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function GD(t,e,n){switch(e.tag){case 3:j_(e),El();break;case 5:m_(e);break;case 1:fr(e.type)&&Zh(e);break;case 4:IS(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;mt(Xh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(mt(It,It.current&1),e.flags|=128,null):n&e.child.childLanes?W_(t,e,n):(mt(It,It.current&1),t=oo(t,e,n),t!==null?t.sibling:null);mt(It,It.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return V_(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),mt(It,It.current),r)break;return null;case 22:case 23:return e.lanes=0,B_(t,e,n)}return oo(t,e,n)}var z_,oy,$_,H_;z_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};oy=function(){};$_=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Aa(cs.current);var s=null;switch(n){case"input":i=Rv(t,i),r=Rv(t,r),s=[];break;case"select":i=Nt({},i,{value:void 0}),r=Nt({},r,{value:void 0}),s=[];break;case"textarea":i=Nv(t,i),r=Nv(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=qh)}xv(n,r);var o;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(cd.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in r){var c=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(cd.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&vt("scroll",t),s||a===c||(s=[])):(s=s||[]).push(l,c))}n&&(s=s||[]).push("style",n);var l=s;(e.updateQueue=l)&&(e.flags|=4)}};H_=function(t,e,n,r){n!==r&&(e.flags|=4)};function mu(t,e){if(!_t)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function xn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function qD(t,e,n){var r=e.pendingProps;switch(bS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xn(e),null;case 1:return fr(e.type)&&Jh(),xn(e),null;case 3:return r=e.stateNode,Tl(),bt(dr),bt(jn),PS(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ff(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,di!==null&&(py(di),di=null))),oy(t,e),xn(e),null;case 5:RS(e);var i=Aa(bd.current);if(n=e.type,t!==null&&e.stateNode!=null)$_(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ae(166));return xn(e),null}if(t=Aa(cs.current),Ff(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ui]=e,r[yd]=s,t=(e.mode&1)!==0,n){case"dialog":vt("cancel",r),vt("close",r);break;case"iframe":case"object":case"embed":vt("load",r);break;case"video":case"audio":for(i=0;i<Ou.length;i++)vt(Ou[i],r);break;case"source":vt("error",r);break;case"img":case"image":case"link":vt("error",r),vt("load",r);break;case"details":vt("toggle",r);break;case"input":Ow(r,s),vt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},vt("invalid",r);break;case"textarea":Lw(r,s),vt("invalid",r)}xv(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Lf(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Lf(r.textContent,a,t),i=["children",""+a]):cd.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&vt("scroll",r)}switch(n){case"input":Rf(r),Dw(r,s,!0);break;case"textarea":Rf(r),Fw(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=qh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ui]=e,t[yd]=r,z_(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ov(n,r),n){case"dialog":vt("cancel",t),vt("close",t),i=r;break;case"iframe":case"object":case"embed":vt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ou.length;i++)vt(Ou[i],t);i=r;break;case"source":vt("error",t),i=r;break;case"img":case"image":case"link":vt("error",t),vt("load",t),i=r;break;case"details":vt("toggle",t),i=r;break;case"input":Ow(t,r),i=Rv(t,r),vt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Nt({},r,{value:void 0}),vt("invalid",t);break;case"textarea":Lw(t,r),i=Nv(t,r),vt("invalid",t);break;default:i=r}xv(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?wT(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ST(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ld(t,c):typeof c=="number"&&ld(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(cd.hasOwnProperty(s)?c!=null&&s==="onScroll"&&vt("scroll",t):c!=null&&sS(t,s,c,o))}switch(n){case"input":Rf(t),Dw(t,r,!1);break;case"textarea":Rf(t),Fw(t);break;case"option":r.value!=null&&t.setAttribute("value",""+oa(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Kc(t,!!r.multiple,s,!1):r.defaultValue!=null&&Kc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=qh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return xn(e),null;case 6:if(t&&e.stateNode!=null)H_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ae(166));if(n=Aa(bd.current),Aa(cs.current),Ff(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ui]=e,(s=r.nodeValue!==n)&&(t=Ir,t!==null))switch(t.tag){case 3:Lf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Lf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ui]=e,e.stateNode=r}return xn(e),null;case 13:if(bt(It),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(_t&&Tr!==null&&e.mode&1&&!(e.flags&128))c_(),El(),e.flags|=98560,s=!1;else if(s=Ff(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ae(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ae(317));s[Ui]=e}else El(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;xn(e),s=!1}else di!==null&&(py(di),di=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||It.current&1?rn===0&&(rn=3):WS())),e.updateQueue!==null&&(e.flags|=4),xn(e),null);case 4:return Tl(),oy(t,e),t===null&&gd(e.stateNode.containerInfo),xn(e),null;case 10:return CS(e.type._context),xn(e),null;case 17:return fr(e.type)&&Jh(),xn(e),null;case 19:if(bt(It),s=e.memoizedState,s===null)return xn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)mu(s,!1);else{if(rn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=tp(t),o!==null){for(e.flags|=128,mu(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return mt(It,It.current&1|2),e.child}t=t.sibling}s.tail!==null&&zt()>Il&&(e.flags|=128,r=!0,mu(s,!1),e.lanes=4194304)}else{if(!r)if(t=tp(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),mu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!_t)return xn(e),null}else 2*zt()-s.renderingStartTime>Il&&n!==1073741824&&(e.flags|=128,r=!0,mu(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=zt(),e.sibling=null,n=It.current,mt(It,r?n&1|2:n&1),e):(xn(e),null);case 22:case 23:return jS(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?kr&1073741824&&(xn(e),e.subtreeFlags&6&&(e.flags|=8192)):xn(e),null;case 24:return null;case 25:return null}throw Error(ae(156,e.tag))}function JD(t,e){switch(bS(e),e.tag){case 1:return fr(e.type)&&Jh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Tl(),bt(dr),bt(jn),PS(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return RS(e),null;case 13:if(bt(It),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ae(340));El()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return bt(It),null;case 4:return Tl(),null;case 10:return CS(e.type._context),null;case 22:case 23:return jS(),null;case 24:return null;default:return null}}var jf=!1,Dn=!1,ZD=typeof WeakSet=="function"?WeakSet:Set,he=null;function Bc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Lt(t,e,r)}else n.current=null}function ay(t,e,n){try{n()}catch(r){Lt(t,e,r)}}var _k=!1;function KD(t,e){if($v=$h,t=ZT(),yS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,l=0,u=0,d=t,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(c=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++l===i&&(a=o),f===s&&++u===r&&(c=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Hv={focusedElem:t,selectionRange:n},$h=!1,he=e;he!==null;)if(e=he,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,he=t;else for(;he!==null;){e=he;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,y=p.memoizedState,m=e.stateNode,v=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:Qr(e.type,g),y);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(_){Lt(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,he=t;break}he=e.return}return p=_k,_k=!1,p}function Ju(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&ay(e,n,s)}i=i.next}while(i!==r)}}function sm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function cy(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function G_(t){var e=t.alternate;e!==null&&(t.alternate=null,G_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ui],delete e[yd],delete e[Jv],delete e[MD],delete e[xD])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function q_(t){return t.tag===5||t.tag===3||t.tag===4}function Ik(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||q_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ly(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=qh));else if(r!==4&&(t=t.child,t!==null))for(ly(t,e,n),t=t.sibling;t!==null;)ly(t,e,n),t=t.sibling}function uy(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(uy(t,e,n),t=t.sibling;t!==null;)uy(t,e,n),t=t.sibling}var En=null,ci=!1;function So(t,e,n){for(n=n.child;n!==null;)J_(t,e,n),n=n.sibling}function J_(t,e,n){if(as&&typeof as.onCommitFiberUnmount=="function")try{as.onCommitFiberUnmount(Yp,n)}catch{}switch(n.tag){case 5:Dn||Bc(n,e);case 6:var r=En,i=ci;En=null,So(t,e,n),En=r,ci=i,En!==null&&(ci?(t=En,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):En.removeChild(n.stateNode));break;case 18:En!==null&&(ci?(t=En,n=n.stateNode,t.nodeType===8?Rg(t.parentNode,n):t.nodeType===1&&Rg(t,n),hd(t)):Rg(En,n.stateNode));break;case 4:r=En,i=ci,En=n.stateNode.containerInfo,ci=!0,So(t,e,n),En=r,ci=i;break;case 0:case 11:case 14:case 15:if(!Dn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&ay(n,e,o),i=i.next}while(i!==r)}So(t,e,n);break;case 1:if(!Dn&&(Bc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Lt(n,e,a)}So(t,e,n);break;case 21:So(t,e,n);break;case 22:n.mode&1?(Dn=(r=Dn)||n.memoizedState!==null,So(t,e,n),Dn=r):So(t,e,n);break;default:So(t,e,n)}}function Rk(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ZD),e.forEach(function(r){var i=sL.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Zr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:En=a.stateNode,ci=!1;break e;case 3:En=a.stateNode.containerInfo,ci=!0;break e;case 4:En=a.stateNode.containerInfo,ci=!0;break e}a=a.return}if(En===null)throw Error(ae(160));J_(s,o,i),En=null,ci=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){Lt(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Z_(e,t),e=e.sibling}function Z_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zr(e,t),Ni(t),r&4){try{Ju(3,t,t.return),sm(3,t)}catch(g){Lt(t,t.return,g)}try{Ju(5,t,t.return)}catch(g){Lt(t,t.return,g)}}break;case 1:Zr(e,t),Ni(t),r&512&&n!==null&&Bc(n,n.return);break;case 5:if(Zr(e,t),Ni(t),r&512&&n!==null&&Bc(n,n.return),t.flags&32){var i=t.stateNode;try{ld(i,"")}catch(g){Lt(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&gT(i,s),Ov(a,o);var l=Ov(a,s);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?wT(i,d):u==="dangerouslySetInnerHTML"?ST(i,d):u==="children"?ld(i,d):sS(i,u,d,l)}switch(a){case"input":Pv(i,s);break;case"textarea":vT(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?Kc(i,!!s.multiple,h,!1):f!==!!s.multiple&&(s.defaultValue!=null?Kc(i,!!s.multiple,s.defaultValue,!0):Kc(i,!!s.multiple,s.multiple?[]:"",!1))}i[yd]=s}catch(g){Lt(t,t.return,g)}}break;case 6:if(Zr(e,t),Ni(t),r&4){if(t.stateNode===null)throw Error(ae(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){Lt(t,t.return,g)}}break;case 3:if(Zr(e,t),Ni(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{hd(e.containerInfo)}catch(g){Lt(t,t.return,g)}break;case 4:Zr(e,t),Ni(t);break;case 13:Zr(e,t),Ni(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(BS=zt())),r&4&&Rk(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Dn=(l=Dn)||u,Zr(e,t),Dn=l):Zr(e,t),Ni(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!u&&t.mode&1)for(he=t,u=t.child;u!==null;){for(d=he=u;he!==null;){switch(f=he,h=f.child,f.tag){case 0:case 11:case 14:case 15:Ju(4,f,f.return);break;case 1:Bc(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){Lt(r,n,g)}}break;case 5:Bc(f,f.return);break;case 22:if(f.memoizedState!==null){Ak(d);continue}}h!==null?(h.return=f,he=h):Ak(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,l?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=bT("display",o))}catch(g){Lt(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(g){Lt(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Zr(e,t),Ni(t),r&4&&Rk(t);break;case 21:break;default:Zr(e,t),Ni(t)}}function Ni(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(q_(n)){var r=n;break e}n=n.return}throw Error(ae(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ld(i,""),r.flags&=-33);var s=Ik(t);uy(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Ik(t);ly(t,a,o);break;default:throw Error(ae(161))}}catch(c){Lt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function YD(t,e,n){he=t,K_(t)}function K_(t,e,n){for(var r=(t.mode&1)!==0;he!==null;){var i=he,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||jf;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Dn;a=jf;var l=Dn;if(jf=o,(Dn=c)&&!l)for(he=i;he!==null;)o=he,c=o.child,o.tag===22&&o.memoizedState!==null?Nk(i):c!==null?(c.return=o,he=c):Nk(i);for(;s!==null;)he=s,K_(s),s=s.sibling;he=i,jf=a,Dn=l}Pk(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,he=s):Pk(t)}}function Pk(t){for(;he!==null;){var e=he;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Dn||sm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Dn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Qr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&fk(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}fk(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&hd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}Dn||e.flags&512&&cy(e)}catch(f){Lt(e,e.return,f)}}if(e===t){he=null;break}if(n=e.sibling,n!==null){n.return=e.return,he=n;break}he=e.return}}function Ak(t){for(;he!==null;){var e=he;if(e===t){he=null;break}var n=e.sibling;if(n!==null){n.return=e.return,he=n;break}he=e.return}}function Nk(t){for(;he!==null;){var e=he;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{sm(4,e)}catch(c){Lt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Lt(e,i,c)}}var s=e.return;try{cy(e)}catch(c){Lt(e,s,c)}break;case 5:var o=e.return;try{cy(e)}catch(c){Lt(e,o,c)}}}catch(c){Lt(e,e.return,c)}if(e===t){he=null;break}var a=e.sibling;if(a!==null){a.return=e.return,he=a;break}he=e.return}}var XD=Math.ceil,ip=fo.ReactCurrentDispatcher,LS=fo.ReactCurrentOwner,$r=fo.ReactCurrentBatchConfig,qe=0,vn=null,Jt=null,_n=0,kr=0,Uc=pa(0),rn=0,Cd=null,Ha=0,om=0,FS=0,Zu=null,or=null,BS=0,Il=1/0,Ss=null,sp=!1,dy=null,Yo=null,Wf=!1,Bo=null,op=0,Ku=0,fy=null,yh=-1,Sh=0;function nr(){return qe&6?zt():yh!==-1?yh:yh=zt()}function Xo(t){return t.mode&1?qe&2&&_n!==0?_n&-_n:DD.transition!==null?(Sh===0&&(Sh=xT()),Sh):(t=et,t!==0||(t=window.event,t=t===void 0?16:jT(t.type)),t):1}function wi(t,e,n,r){if(50<Ku)throw Ku=0,fy=null,Error(ae(185));Qd(t,n,r),(!(qe&2)||t!==vn)&&(t===vn&&(!(qe&2)&&(om|=n),rn===4&&Oo(t,_n)),hr(t,r),n===1&&qe===0&&!(e.mode&1)&&(Il=zt()+500,nm&&ma()))}function hr(t,e){var n=t.callbackNode;DO(t,e);var r=zh(t,t===vn?_n:0);if(r===0)n!==null&&jw(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&jw(n),e===1)t.tag===0?OD(Mk.bind(null,t)):s_(Mk.bind(null,t)),AD(function(){!(qe&6)&&ma()}),n=null;else{switch(OT(r)){case 1:n=uS;break;case 4:n=NT;break;case 16:n=Vh;break;case 536870912:n=MT;break;default:n=Vh}n=iI(n,Y_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Y_(t,e){if(yh=-1,Sh=0,qe&6)throw Error(ae(327));var n=t.callbackNode;if(tl()&&t.callbackNode!==n)return null;var r=zh(t,t===vn?_n:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ap(t,r);else{e=r;var i=qe;qe|=2;var s=Q_();(vn!==t||_n!==e)&&(Ss=null,Il=zt()+500,Fa(t,e));do try{tL();break}catch(a){X_(t,a)}while(!0);ES(),ip.current=s,qe=i,Jt!==null?e=0:(vn=null,_n=0,e=rn)}if(e!==0){if(e===2&&(i=Uv(t),i!==0&&(r=i,e=hy(t,i))),e===1)throw n=Cd,Fa(t,0),Oo(t,r),hr(t,zt()),n;if(e===6)Oo(t,r);else{if(i=t.current.alternate,!(r&30)&&!QD(i)&&(e=ap(t,r),e===2&&(s=Uv(t),s!==0&&(r=s,e=hy(t,s))),e===1))throw n=Cd,Fa(t,0),Oo(t,r),hr(t,zt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ae(345));case 2:_a(t,or,Ss);break;case 3:if(Oo(t,r),(r&130023424)===r&&(e=BS+500-zt(),10<e)){if(zh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){nr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=qv(_a.bind(null,t,or,Ss),e);break}_a(t,or,Ss);break;case 4:if(Oo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-bi(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=zt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*XD(r/1960))-r,10<r){t.timeoutHandle=qv(_a.bind(null,t,or,Ss),r);break}_a(t,or,Ss);break;case 5:_a(t,or,Ss);break;default:throw Error(ae(329))}}}return hr(t,zt()),t.callbackNode===n?Y_.bind(null,t):null}function hy(t,e){var n=Zu;return t.current.memoizedState.isDehydrated&&(Fa(t,e).flags|=256),t=ap(t,e),t!==2&&(e=or,or=n,e!==null&&py(e)),t}function py(t){or===null?or=t:or.push.apply(or,t)}function QD(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ci(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Oo(t,e){for(e&=~FS,e&=~om,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-bi(e),r=1<<n;t[n]=-1,e&=~r}}function Mk(t){if(qe&6)throw Error(ae(327));tl();var e=zh(t,0);if(!(e&1))return hr(t,zt()),null;var n=ap(t,e);if(t.tag!==0&&n===2){var r=Uv(t);r!==0&&(e=r,n=hy(t,r))}if(n===1)throw n=Cd,Fa(t,0),Oo(t,e),hr(t,zt()),n;if(n===6)throw Error(ae(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,_a(t,or,Ss),hr(t,zt()),null}function US(t,e){var n=qe;qe|=1;try{return t(e)}finally{qe=n,qe===0&&(Il=zt()+500,nm&&ma())}}function Ga(t){Bo!==null&&Bo.tag===0&&!(qe&6)&&tl();var e=qe;qe|=1;var n=$r.transition,r=et;try{if($r.transition=null,et=1,t)return t()}finally{et=r,$r.transition=n,qe=e,!(qe&6)&&ma()}}function jS(){kr=Uc.current,bt(Uc)}function Fa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,PD(n)),Jt!==null)for(n=Jt.return;n!==null;){var r=n;switch(bS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Jh();break;case 3:Tl(),bt(dr),bt(jn),PS();break;case 5:RS(r);break;case 4:Tl();break;case 13:bt(It);break;case 19:bt(It);break;case 10:CS(r.type._context);break;case 22:case 23:jS()}n=n.return}if(vn=t,Jt=t=Qo(t.current,null),_n=kr=e,rn=0,Cd=null,FS=om=Ha=0,or=Zu=null,Pa!==null){for(e=0;e<Pa.length;e++)if(n=Pa[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Pa=null}return t}function X_(t,e){do{var n=Jt;try{if(ES(),mh.current=rp,np){for(var r=At.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}np=!1}if($a=0,pn=en=At=null,qu=!1,wd=0,LS.current=null,n===null||n.return===null){rn=1,Cd=e,Jt=null;break}e:{var s=t,o=n.return,a=n,c=e;if(e=_n,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=Sk(o);if(h!==null){h.flags&=-257,bk(h,o,a,s,e),h.mode&1&&yk(s,l,e),e=h,c=l;var p=e.updateQueue;if(p===null){var g=new Set;g.add(c),e.updateQueue=g}else p.add(c);break e}else{if(!(e&1)){yk(s,l,e),WS();break e}c=Error(ae(426))}}else if(_t&&a.mode&1){var y=Sk(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),bk(y,o,a,s,e),wS(_l(c,a));break e}}s=c=_l(c,a),rn!==4&&(rn=2),Zu===null?Zu=[s]:Zu.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=D_(s,c,e);dk(s,m);break e;case 1:a=c;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Yo===null||!Yo.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=L_(s,a,e);dk(s,_);break e}}s=s.return}while(s!==null)}tI(n)}catch(C){e=C,Jt===n&&n!==null&&(Jt=n=n.return);continue}break}while(!0)}function Q_(){var t=ip.current;return ip.current=rp,t===null?rp:t}function WS(){(rn===0||rn===3||rn===2)&&(rn=4),vn===null||!(Ha&268435455)&&!(om&268435455)||Oo(vn,_n)}function ap(t,e){var n=qe;qe|=2;var r=Q_();(vn!==t||_n!==e)&&(Ss=null,Fa(t,e));do try{eL();break}catch(i){X_(t,i)}while(!0);if(ES(),qe=n,ip.current=r,Jt!==null)throw Error(ae(261));return vn=null,_n=0,rn}function eL(){for(;Jt!==null;)eI(Jt)}function tL(){for(;Jt!==null&&!_O();)eI(Jt)}function eI(t){var e=rI(t.alternate,t,kr);t.memoizedProps=t.pendingProps,e===null?tI(t):Jt=e,LS.current=null}function tI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=JD(n,e),n!==null){n.flags&=32767,Jt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{rn=6,Jt=null;return}}else if(n=qD(n,e,kr),n!==null){Jt=n;return}if(e=e.sibling,e!==null){Jt=e;return}Jt=e=t}while(e!==null);rn===0&&(rn=5)}function _a(t,e,n){var r=et,i=$r.transition;try{$r.transition=null,et=1,nL(t,e,n,r)}finally{$r.transition=i,et=r}return null}function nL(t,e,n,r){do tl();while(Bo!==null);if(qe&6)throw Error(ae(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ae(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(LO(t,s),t===vn&&(Jt=vn=null,_n=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Wf||(Wf=!0,iI(Vh,function(){return tl(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=$r.transition,$r.transition=null;var o=et;et=1;var a=qe;qe|=4,LS.current=null,KD(t,n),Z_(n,t),kD(Hv),$h=!!$v,Hv=$v=null,t.current=n,YD(n),IO(),qe=a,et=o,$r.transition=s}else t.current=n;if(Wf&&(Wf=!1,Bo=t,op=i),s=t.pendingLanes,s===0&&(Yo=null),AO(n.stateNode),hr(t,zt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(sp)throw sp=!1,t=dy,dy=null,t;return op&1&&t.tag!==0&&tl(),s=t.pendingLanes,s&1?t===fy?Ku++:(Ku=0,fy=t):Ku=0,ma(),null}function tl(){if(Bo!==null){var t=OT(op),e=$r.transition,n=et;try{if($r.transition=null,et=16>t?16:t,Bo===null)var r=!1;else{if(t=Bo,Bo=null,op=0,qe&6)throw Error(ae(331));var i=qe;for(qe|=4,he=t.current;he!==null;){var s=he,o=s.child;if(he.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(he=l;he!==null;){var u=he;switch(u.tag){case 0:case 11:case 15:Ju(8,u,s)}var d=u.child;if(d!==null)d.return=u,he=d;else for(;he!==null;){u=he;var f=u.sibling,h=u.return;if(G_(u),u===l){he=null;break}if(f!==null){f.return=h,he=f;break}he=h}}}var p=s.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}he=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,he=o;else e:for(;he!==null;){if(s=he,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ju(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,he=m;break e}he=s.return}}var v=t.current;for(he=v;he!==null;){o=he;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,he=w;else e:for(o=v;he!==null;){if(a=he,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:sm(9,a)}}catch(C){Lt(a,a.return,C)}if(a===o){he=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,he=_;break e}he=a.return}}if(qe=i,ma(),as&&typeof as.onPostCommitFiberRoot=="function")try{as.onPostCommitFiberRoot(Yp,t)}catch{}r=!0}return r}finally{et=n,$r.transition=e}}return!1}function xk(t,e,n){e=_l(n,e),e=D_(t,e,1),t=Ko(t,e,1),e=nr(),t!==null&&(Qd(t,1,e),hr(t,e))}function Lt(t,e,n){if(t.tag===3)xk(t,t,n);else for(;e!==null;){if(e.tag===3){xk(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Yo===null||!Yo.has(r))){t=_l(n,t),t=L_(e,t,1),e=Ko(e,t,1),t=nr(),e!==null&&(Qd(e,1,t),hr(e,t));break}}e=e.return}}function rL(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=nr(),t.pingedLanes|=t.suspendedLanes&n,vn===t&&(_n&n)===n&&(rn===4||rn===3&&(_n&130023424)===_n&&500>zt()-BS?Fa(t,0):FS|=n),hr(t,e)}function nI(t,e){e===0&&(t.mode&1?(e=Nf,Nf<<=1,!(Nf&130023424)&&(Nf=4194304)):e=1);var n=nr();t=so(t,e),t!==null&&(Qd(t,e,n),hr(t,n))}function iL(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),nI(t,n)}function sL(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ae(314))}r!==null&&r.delete(e),nI(t,n)}var rI;rI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||dr.current)lr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return lr=!1,GD(t,e,n);lr=!!(t.flags&131072)}else lr=!1,_t&&e.flags&1048576&&o_(e,Yh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;vh(t,e),t=e.pendingProps;var i=kl(e,jn.current);el(e,n),i=NS(null,e,r,t,i,n);var s=MS();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,fr(r)?(s=!0,Zh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,_S(e),i.updater=rm,e.stateNode=i,i._reactInternals=e,ey(e,r,t,n),e=ry(null,e,r,!0,s,n)):(e.tag=0,_t&&s&&SS(e),Gn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(vh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=aL(r),t=Qr(r,t),i){case 0:e=ny(null,e,r,t,n);break e;case 1:e=Ek(null,e,r,t,n);break e;case 11:e=wk(null,e,r,t,n);break e;case 14:e=kk(null,e,r,Qr(r.type,t),n);break e}throw Error(ae(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qr(r,i),ny(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qr(r,i),Ek(t,e,r,i,n);case 3:e:{if(j_(e),t===null)throw Error(ae(387));r=e.pendingProps,s=e.memoizedState,i=s.element,u_(t,e),ep(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=_l(Error(ae(423)),e),e=Ck(t,e,r,n,i);break e}else if(r!==i){i=_l(Error(ae(424)),e),e=Ck(t,e,r,n,i);break e}else for(Tr=Zo(e.stateNode.containerInfo.firstChild),Ir=e,_t=!0,di=null,n=p_(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(El(),r===i){e=oo(t,e,n);break e}Gn(t,e,r,n)}e=e.child}return e;case 5:return m_(e),t===null&&Yv(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Gv(r,i)?o=null:s!==null&&Gv(r,s)&&(e.flags|=32),U_(t,e),Gn(t,e,o,n),e.child;case 6:return t===null&&Yv(e),null;case 13:return W_(t,e,n);case 4:return IS(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Cl(e,null,r,n):Gn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qr(r,i),wk(t,e,r,i,n);case 7:return Gn(t,e,e.pendingProps,n),e.child;case 8:return Gn(t,e,e.pendingProps.children,n),e.child;case 12:return Gn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,mt(Xh,r._currentValue),r._currentValue=o,s!==null)if(Ci(s.value,o)){if(s.children===i.children&&!dr.current){e=oo(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Qs(-1,n&-n),c.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Xv(s.return,n,e),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ae(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Xv(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Gn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,el(e,n),i=Hr(i),r=r(i),e.flags|=1,Gn(t,e,r,n),e.child;case 14:return r=e.type,i=Qr(r,e.pendingProps),i=Qr(r.type,i),kk(t,e,r,i,n);case 15:return F_(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qr(r,i),vh(t,e),e.tag=1,fr(r)?(t=!0,Zh(e)):t=!1,el(e,n),f_(e,r,i),ey(e,r,i,n),ry(null,e,r,!0,t,n);case 19:return V_(t,e,n);case 22:return B_(t,e,n)}throw Error(ae(156,e.tag))};function iI(t,e){return AT(t,e)}function oL(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jr(t,e,n,r){return new oL(t,e,n,r)}function VS(t){return t=t.prototype,!(!t||!t.isReactComponent)}function aL(t){if(typeof t=="function")return VS(t)?1:0;if(t!=null){if(t=t.$$typeof,t===aS)return 11;if(t===cS)return 14}return 2}function Qo(t,e){var n=t.alternate;return n===null?(n=jr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function bh(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")VS(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Pc:return Ba(n.children,i,s,e);case oS:o=8,i|=8;break;case Cv:return t=jr(12,n,e,i|2),t.elementType=Cv,t.lanes=s,t;case Tv:return t=jr(13,n,e,i),t.elementType=Tv,t.lanes=s,t;case _v:return t=jr(19,n,e,i),t.elementType=_v,t.lanes=s,t;case hT:return am(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case dT:o=10;break e;case fT:o=9;break e;case aS:o=11;break e;case cS:o=14;break e;case Io:o=16,r=null;break e}throw Error(ae(130,t==null?t:typeof t,""))}return e=jr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Ba(t,e,n,r){return t=jr(7,t,r,e),t.lanes=n,t}function am(t,e,n,r){return t=jr(22,t,r,e),t.elementType=hT,t.lanes=n,t.stateNode={isHidden:!1},t}function Lg(t,e,n){return t=jr(6,t,null,e),t.lanes=n,t}function Fg(t,e,n){return e=jr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function cL(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vg(0),this.expirationTimes=vg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zS(t,e,n,r,i,s,o,a,c){return t=new cL(t,e,n,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=jr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_S(s),t}function lL(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Rc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function sI(t){if(!t)return aa;t=t._reactInternals;e:{if(oc(t)!==t||t.tag!==1)throw Error(ae(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(fr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ae(171))}if(t.tag===1){var n=t.type;if(fr(n))return i_(t,n,e)}return e}function oI(t,e,n,r,i,s,o,a,c){return t=zS(n,r,!0,t,i,s,o,a,c),t.context=sI(null),n=t.current,r=nr(),i=Xo(n),s=Qs(r,i),s.callback=e??null,Ko(n,s,i),t.current.lanes=i,Qd(t,i,r),hr(t,r),t}function cm(t,e,n,r){var i=e.current,s=nr(),o=Xo(i);return n=sI(n),e.context===null?e.context=n:e.pendingContext=n,e=Qs(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ko(i,e,o),t!==null&&(wi(t,i,o,s),ph(t,i,o)),o}function cp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ok(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function $S(t,e){Ok(t,e),(t=t.alternate)&&Ok(t,e)}function uL(){return null}var aI=typeof reportError=="function"?reportError:function(t){console.error(t)};function HS(t){this._internalRoot=t}lm.prototype.render=HS.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ae(409));cm(t,e,null,null)};lm.prototype.unmount=HS.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ga(function(){cm(null,t,null,null)}),e[io]=null}};function lm(t){this._internalRoot=t}lm.prototype.unstable_scheduleHydration=function(t){if(t){var e=FT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<xo.length&&e!==0&&e<xo[n].priority;n++);xo.splice(n,0,t),n===0&&UT(t)}};function GS(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function um(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Dk(){}function dL(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var l=cp(o);s.call(l)}}var o=oI(e,r,t,0,null,!1,!1,"",Dk);return t._reactRootContainer=o,t[io]=o.current,gd(t.nodeType===8?t.parentNode:t),Ga(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=cp(c);a.call(l)}}var c=zS(t,0,!1,null,null,!1,!1,"",Dk);return t._reactRootContainer=c,t[io]=c.current,gd(t.nodeType===8?t.parentNode:t),Ga(function(){cm(e,c,n,r)}),c}function dm(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=cp(o);a.call(c)}}cm(e,o,t,i)}else o=dL(n,e,t,i,r);return cp(o)}DT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=xu(e.pendingLanes);n!==0&&(dS(e,n|1),hr(e,zt()),!(qe&6)&&(Il=zt()+500,ma()))}break;case 13:Ga(function(){var r=so(t,1);if(r!==null){var i=nr();wi(r,t,1,i)}}),$S(t,1)}};fS=function(t){if(t.tag===13){var e=so(t,134217728);if(e!==null){var n=nr();wi(e,t,134217728,n)}$S(t,134217728)}};LT=function(t){if(t.tag===13){var e=Xo(t),n=so(t,e);if(n!==null){var r=nr();wi(n,t,e,r)}$S(t,e)}};FT=function(){return et};BT=function(t,e){var n=et;try{return et=t,e()}finally{et=n}};Lv=function(t,e,n){switch(e){case"input":if(Pv(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=tm(r);if(!i)throw Error(ae(90));mT(r),Pv(r,i)}}}break;case"textarea":vT(t,n);break;case"select":e=n.value,e!=null&&Kc(t,!!n.multiple,e,!1)}};CT=US;TT=Ga;var fL={usingClientEntryPoint:!1,Events:[tf,xc,tm,kT,ET,US]},gu={findFiberByHostInstance:Ra,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},hL={bundleType:gu.bundleType,version:gu.version,rendererPackageName:gu.rendererPackageName,rendererConfig:gu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=RT(t),t===null?null:t.stateNode},findFiberByHostInstance:gu.findFiberByHostInstance||uL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vf.isDisabled&&Vf.supportsFiber)try{Yp=Vf.inject(hL),as=Vf}catch{}}Nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fL;Nr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!GS(e))throw Error(ae(200));return lL(t,e,null,n)};Nr.createRoot=function(t,e){if(!GS(t))throw Error(ae(299));var n=!1,r="",i=aI;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=zS(t,1,!1,null,null,n,!1,r,i),t[io]=e.current,gd(t.nodeType===8?t.parentNode:t),new HS(e)};Nr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ae(188)):(t=Object.keys(t).join(","),Error(ae(268,t)));return t=RT(e),t=t===null?null:t.stateNode,t};Nr.flushSync=function(t){return Ga(t)};Nr.hydrate=function(t,e,n){if(!um(e))throw Error(ae(200));return dm(null,t,e,!0,n)};Nr.hydrateRoot=function(t,e,n){if(!GS(t))throw Error(ae(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=aI;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=oI(e,null,t,1,n??null,i,!1,s,o),t[io]=e.current,gd(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new lm(e)};Nr.render=function(t,e,n){if(!um(e))throw Error(ae(200));return dm(null,t,e,!1,n)};Nr.unmountComponentAtNode=function(t){if(!um(t))throw Error(ae(40));return t._reactRootContainer?(Ga(function(){dm(null,null,t,!1,function(){t._reactRootContainer=null,t[io]=null})}),!0):!1};Nr.unstable_batchedUpdates=US;Nr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!um(n))throw Error(ae(200));if(t==null||t._reactInternals===void 0)throw Error(ae(38));return dm(t,e,n,!1,r)};Nr.version="18.2.0-next-9e3b772b8-20220608";function cI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cI)}catch(t){console.error(t)}}cI(),oT.exports=Nr;var qS=oT.exports;const pL=Yd(qS),mL=Z1({__proto__:null,default:pL},[qS]);var Lk=qS;kv.createRoot=Lk.createRoot,kv.hydrateRoot=Lk.hydrateRoot;/**
 * @remix-run/router v1.14.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ft(){return Ft=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ft.apply(this,arguments)}var jt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(jt||(jt={}));const Fk="popstate";function gL(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return Td("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:rf(i)}return yL(e,n,null,t)}function $e(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function qa(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function vL(){return Math.random().toString(36).substr(2,8)}function Bk(t,e){return{usr:t.state,key:t.key,idx:e}}function Td(t,e,n,r){return n===void 0&&(n=null),Ft({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ho(e):e,{state:n,key:e&&e.key||r||vL()})}function rf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ho(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function yL(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=jt.Pop,c=null,l=u();l==null&&(l=0,o.replaceState(Ft({},o.state,{idx:l}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=jt.Pop;let y=u(),m=y==null?null:y-l;l=y,c&&c({action:a,location:g.location,delta:m})}function f(y,m){a=jt.Push;let v=Td(g.location,y,m);n&&n(v,y),l=u()+1;let w=Bk(v,l),_=g.createHref(v);try{o.pushState(w,"",_)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;i.location.assign(_)}s&&c&&c({action:a,location:g.location,delta:1})}function h(y,m){a=jt.Replace;let v=Td(g.location,y,m);n&&n(v,y),l=u();let w=Bk(v,l),_=g.createHref(v);o.replaceState(w,"",_),s&&c&&c({action:a,location:g.location,delta:0})}function p(y){let m=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof y=="string"?y:rf(y);return $e(m,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,m)}let g={get action(){return a},get location(){return t(i,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(Fk,d),c=y,()=>{i.removeEventListener(Fk,d),c=null}},createHref(y){return e(i,y)},createURL:p,encodeLocation(y){let m=p(y);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:f,replace:h,go(y){return o.go(y)}};return g}var Dt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Dt||(Dt={}));const SL=new Set(["lazy","caseSensitive","path","id","index","children"]);function bL(t){return t.index===!0}function my(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((i,s)=>{let o=[...n,s],a=typeof i.id=="string"?i.id:o.join("-");if($e(i.index!==!0||!i.children,"Cannot specify children on an index route"),$e(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),bL(i)){let c=Ft({},i,e(i),{id:a});return r[a]=c,c}else{let c=Ft({},i,e(i),{id:a,children:void 0});return r[a]=c,i.children&&(c.children=my(i.children,e,o,r)),c}})}function jc(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?ho(e):e,i=sf(r.pathname||"/",n);if(i==null)return null;let s=lI(t);kL(s);let o=null;for(let a=0;o==null&&a<s.length;++a)o=NL(s[a],OL(i));return o}function wL(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function lI(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let c={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&($e(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let l=Ua([r,c.relativePath]),u=n.concat(c);s.children&&s.children.length>0&&($e(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),lI(s.children,e,u,l)),!(s.path==null&&!s.index)&&e.push({path:l,score:PL(l,s.index),routesMeta:u})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let c of uI(s.path))i(s,o,c)}),e}function uI(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=uI(r.join("/")),a=[];return a.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&a.push(...o),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function kL(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:AL(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const EL=/^:\w+$/,CL=3,TL=2,_L=1,IL=10,RL=-2,Uk=t=>t==="*";function PL(t,e){let n=t.split("/"),r=n.length;return n.some(Uk)&&(r+=RL),e&&(r+=TL),n.filter(i=>!Uk(i)).reduce((i,s)=>i+(EL.test(s)?CL:s===""?_L:IL),r)}function AL(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function NL(t,e){let{routesMeta:n}=t,r={},i="/",s=[];for(let o=0;o<n.length;++o){let a=n[o],c=o===n.length-1,l=i==="/"?e:e.slice(i.length)||"/",u=ML({path:a.relativePath,caseSensitive:a.caseSensitive,end:c},l);if(!u)return null;Object.assign(r,u.params);let d=a.route;s.push({params:r,pathname:Ua([i,u.pathname]),pathnameBase:jL(Ua([i,u.pathnameBase])),route:d}),u.pathnameBase!=="/"&&(i=Ua([i,u.pathnameBase]))}return s}function ML(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=xL(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((l,u,d)=>{let{paramName:f,isOptional:h}=u;if(f==="*"){let g=a[d]||"";o=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?l[f]=void 0:l[f]=DL(p||"",f),l},{}),pathname:s,pathnameBase:o,pattern:t}}function xL(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),qa(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(o,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function OL(t){try{return decodeURI(t)}catch(e){return qa(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function DL(t,e){try{return decodeURIComponent(t)}catch(n){return qa(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function sf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function LL(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?ho(t):t;return{pathname:n?n.startsWith("/")?n:FL(n,e):e,search:WL(r),hash:VL(i)}}function FL(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Bg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function dI(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function BL(t,e){let n=dI(t);return e?n.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function UL(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=ho(t):(i=Ft({},t),$e(!i.pathname||!i.pathname.includes("?"),Bg("?","pathname","search",i)),$e(!i.pathname||!i.pathname.includes("#"),Bg("#","pathname","hash",i)),$e(!i.search||!i.search.includes("#"),Bg("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?e[d]:"/"}let c=LL(i,a),l=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}const Ua=t=>t.join("/").replace(/\/\/+/g,"/"),jL=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),WL=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,VL=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class JS{constructor(e,n,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function fI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const hI=["post","put","patch","delete"],zL=new Set(hI),$L=["get",...hI],HL=new Set($L),GL=new Set([301,302,303,307,308]),qL=new Set([307,308]),Ug={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},JL={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},vu={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},pI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ZL=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),mI="remix-router-transitions";function KL(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;$e(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let B=t.detectErrorBoundary;i=$=>({hasErrorBoundary:B($)})}else i=ZL;let s={},o=my(t.routes,i,void 0,s),a,c=t.basename||"/",l=Ft({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1},t.future),u=null,d=new Set,f=null,h=null,p=null,g=t.hydrationData!=null,y=jc(o,t.history.location,c),m=null;if(y==null){let B=Lr(404,{pathname:t.history.location.pathname}),{matches:$,route:ee}=qk(o);y=$,m={[ee.id]:B}}let v,w=y.some(B=>B.route.lazy),_=y.some(B=>B.route.loader);if(w)v=!1;else if(!_)v=!0;else if(l.v7_partialHydration){let B=t.hydrationData?t.hydrationData.loaderData:null,$=t.hydrationData?t.hydrationData.errors:null;v=y.every(ee=>ee.route.loader&&ee.route.loader.hydrate!==!0&&(B&&B[ee.route.id]!==void 0||$&&$[ee.route.id]!==void 0))}else v=t.hydrationData!=null;let C,k={historyAction:t.history.action,location:t.history.location,matches:y,initialized:v,navigation:Ug,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||m,fetchers:new Map,blockers:new Map},T=jt.Pop,R=!1,A,M=!1,O=new Map,D=null,j=!1,V=!1,J=[],G=[],te=new Map,z=0,Z=-1,ie=new Map,q=new Set,se=new Map,ke=new Map,Ee=new Set,me=new Map,Te=new Map,Ue=!1;function ce(){if(u=t.history.listen(B=>{let{action:$,location:ee,delta:de}=B;if(Ue){Ue=!1;return}qa(Te.size===0||de!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ve=it({currentLocation:k.location,nextLocation:ee,historyAction:$});if(ve&&de!=null){Ue=!0,t.history.go(de*-1),rt(ve,{state:"blocked",location:ee,proceed(){rt(ve,{state:"proceeding",proceed:void 0,reset:void 0,location:ee}),t.history.go(de)},reset(){let We=new Map(k.blockers);We.set(ve,vu),Et({blockers:We})}});return}return le($,ee)}),n){aF(e,O);let B=()=>cF(e,O);e.addEventListener("pagehide",B),D=()=>e.removeEventListener("pagehide",B)}return k.initialized||le(jt.Pop,k.location,{initialHydration:!0}),C}function xt(){u&&u(),D&&D(),d.clear(),A&&A.abort(),k.fetchers.forEach((B,$)=>I($)),k.blockers.forEach((B,$)=>Ne($))}function cn(B){return d.add(B),()=>d.delete(B)}function Et(B,$){$===void 0&&($={}),k=Ft({},k,B);let ee=[],de=[];l.v7_fetcherPersist&&k.fetchers.forEach((ve,We)=>{ve.state==="idle"&&(Ee.has(We)?de.push(We):ee.push(We))}),[...d].forEach(ve=>ve(k,{deletedFetchers:de,unstable_viewTransitionOpts:$.viewTransitionOpts,unstable_flushSync:$.flushSync===!0})),l.v7_fetcherPersist&&(ee.forEach(ve=>k.fetchers.delete(ve)),de.forEach(ve=>I(ve)))}function Sn(B,$,ee){var de,ve;let{flushSync:We}=ee===void 0?{}:ee,Pe=k.actionData!=null&&k.navigation.formMethod!=null&&li(k.navigation.formMethod)&&k.navigation.state==="loading"&&((de=B.state)==null?void 0:de._isRedirect)!==!0,Ie;$.actionData?Object.keys($.actionData).length>0?Ie=$.actionData:Ie=null:Pe?Ie=k.actionData:Ie=null;let be=$.loaderData?Gk(k.loaderData,$.loaderData,$.matches||[],$.errors):k.loaderData,ze=k.blockers;ze.size>0&&(ze=new Map(ze),ze.forEach((dt,wn)=>ze.set(wn,vu)));let ln=R===!0||k.navigation.formMethod!=null&&li(k.navigation.formMethod)&&((ve=B.state)==null?void 0:ve._isRedirect)!==!0;a&&(o=a,a=void 0),j||T===jt.Pop||(T===jt.Push?t.history.push(B,B.state):T===jt.Replace&&t.history.replace(B,B.state));let De;if(T===jt.Pop){let dt=O.get(k.location.pathname);dt&&dt.has(B.pathname)?De={currentLocation:k.location,nextLocation:B}:O.has(B.pathname)&&(De={currentLocation:B,nextLocation:k.location})}else if(M){let dt=O.get(k.location.pathname);dt?dt.add(B.pathname):(dt=new Set([B.pathname]),O.set(k.location.pathname,dt)),De={currentLocation:k.location,nextLocation:B}}Et(Ft({},$,{actionData:Ie,loaderData:be,historyAction:T,location:B,initialized:!0,navigation:Ug,revalidation:"idle",restoreScrollPosition:Iw(B,$.matches||k.matches),preventScrollReset:ln,blockers:ze}),{viewTransitionOpts:De,flushSync:We===!0}),T=jt.Pop,R=!1,M=!1,j=!1,V=!1,J=[],G=[]}async function Zt(B,$){if(typeof B=="number"){t.history.go(B);return}let ee=gy(k.location,k.matches,c,l.v7_prependBasename,B,l.v7_relativeSplatPath,$==null?void 0:$.fromRouteId,$==null?void 0:$.relative),{path:de,submission:ve,error:We}=jk(l.v7_normalizeFormMethod,!1,ee,$),Pe=k.location,Ie=Td(k.location,de,$&&$.state);Ie=Ft({},Ie,t.history.encodeLocation(Ie));let be=$&&$.replace!=null?$.replace:void 0,ze=jt.Push;be===!0?ze=jt.Replace:be===!1||ve!=null&&li(ve.formMethod)&&ve.formAction===k.location.pathname+k.location.search&&(ze=jt.Replace);let ln=$&&"preventScrollReset"in $?$.preventScrollReset===!0:void 0,De=($&&$.unstable_flushSync)===!0,dt=it({currentLocation:Pe,nextLocation:Ie,historyAction:ze});if(dt){rt(dt,{state:"blocked",location:Ie,proceed(){rt(dt,{state:"proceeding",proceed:void 0,reset:void 0,location:Ie}),Zt(B,$)},reset(){let wn=new Map(k.blockers);wn.set(dt,vu),Et({blockers:wn})}});return}return await le(ze,Ie,{submission:ve,pendingError:We,preventScrollReset:ln,replace:$&&$.replace,enableViewTransition:$&&$.unstable_viewTransition,flushSync:De})}function bn(){if(Ut(),Et({revalidation:"loading"}),k.navigation.state!=="submitting"){if(k.navigation.state==="idle"){le(k.historyAction,k.location,{startUninterruptedRevalidation:!0});return}le(T||k.historyAction,k.navigation.location,{overrideNavigation:k.navigation})}}async function le(B,$,ee){A&&A.abort(),A=null,T=B,j=(ee&&ee.startUninterruptedRevalidation)===!0,Lx(k.location,k.matches),R=(ee&&ee.preventScrollReset)===!0,M=(ee&&ee.enableViewTransition)===!0;let de=a||o,ve=ee&&ee.overrideNavigation,We=jc(de,$,c),Pe=(ee&&ee.flushSync)===!0;if(!We){let wn=Lr(404,{pathname:$.pathname}),{matches:Or,route:un}=qk(de);ut(),Sn($,{matches:Or,loaderData:{},errors:{[un.id]:wn}},{flushSync:Pe});return}if(k.initialized&&!V&&tF(k.location,$)&&!(ee&&ee.submission&&li(ee.submission.formMethod))){Sn($,{matches:We},{flushSync:Pe});return}A=new AbortController;let Ie=Su(t.history,$,A.signal,ee&&ee.submission),be,ze;if(ee&&ee.pendingError)ze={[Yu(We).route.id]:ee.pendingError};else if(ee&&ee.submission&&li(ee.submission.formMethod)){let wn=await Se(Ie,$,ee.submission,We,{replace:ee.replace,flushSync:Pe});if(wn.shortCircuited)return;be=wn.pendingActionData,ze=wn.pendingActionError,ve=jg($,ee.submission),Pe=!1,Ie=new Request(Ie.url,{signal:Ie.signal})}let{shortCircuited:ln,loaderData:De,errors:dt}=await Ye(Ie,$,We,ve,ee&&ee.submission,ee&&ee.fetcherSubmission,ee&&ee.replace,ee&&ee.initialHydration===!0,Pe,be,ze);ln||(A=null,Sn($,Ft({matches:We},be?{actionData:be}:{},{loaderData:De,errors:dt})))}async function Se(B,$,ee,de,ve){ve===void 0&&(ve={}),Ut();let We=sF($,ee);Et({navigation:We},{flushSync:ve.flushSync===!0});let Pe,Ie=yy(de,$);if(!Ie.route.action&&!Ie.route.lazy)Pe={type:Dt.error,error:Lr(405,{method:B.method,pathname:$.pathname,routeId:Ie.route.id})};else if(Pe=await yu("action",B,Ie,de,s,i,c,l.v7_relativeSplatPath),B.signal.aborted)return{shortCircuited:!0};if(Ma(Pe)){let be;return ve&&ve.replace!=null?be=ve.replace:be=Pe.location===k.location.pathname+k.location.search,await Re(k,Pe,{submission:ee,replace:be}),{shortCircuited:!0}}if(Wc(Pe)){let be=Yu(de,Ie.route.id);return(ve&&ve.replace)!==!0&&(T=jt.Push),{pendingActionData:{},pendingActionError:{[be.route.id]:Pe.error}}}if(Na(Pe))throw Lr(400,{type:"defer-action"});return{pendingActionData:{[Ie.route.id]:Pe.data}}}async function Ye(B,$,ee,de,ve,We,Pe,Ie,be,ze,ln){let De=de||jg($,ve),dt=ve||We||Kk(De),wn=a||o,[Or,un]=Wk(t.history,k,ee,dt,$,l.v7_partialHydration&&Ie===!0,V,J,G,Ee,se,q,wn,c,ze,ln);if(ut(st=>!(ee&&ee.some(Ct=>Ct.route.id===st))||Or&&Or.some(Ct=>Ct.route.id===st)),Z=++z,Or.length===0&&un.length===0){let st=L();return Sn($,Ft({matches:ee,loaderData:{},errors:ln||null},ze?{actionData:ze}:{},st?{fetchers:new Map(k.fetchers)}:{}),{flushSync:be}),{shortCircuited:!0}}if(!j&&(!l.v7_partialHydration||!Ie)){un.forEach(Ct=>{let Ai=k.fetchers.get(Ct.key),Cf=bu(void 0,Ai?Ai.data:void 0);k.fetchers.set(Ct.key,Cf)});let st=ze||k.actionData;Et(Ft({navigation:De},st?Object.keys(st).length===0?{actionData:null}:{actionData:st}:{},un.length>0?{fetchers:new Map(k.fetchers)}:{}),{flushSync:be})}un.forEach(st=>{te.has(st.key)&&b(st.key),st.controller&&te.set(st.key,st.controller)});let gc=()=>un.forEach(st=>b(st.key));A&&A.signal.addEventListener("abort",gc);let{results:ag,loaderResults:vc,fetcherResults:yo}=await je(k.matches,ee,Or,un,B);if(B.signal.aborted)return{shortCircuited:!0};A&&A.signal.removeEventListener("abort",gc),un.forEach(st=>te.delete(st.key));let Ea=Jk(ag);if(Ea){if(Ea.idx>=Or.length){let st=un[Ea.idx-Or.length].key;q.add(st)}return await Re(k,Ea.result,{replace:Pe}),{shortCircuited:!0}}let{loaderData:cg,errors:lg}=Hk(k,ee,Or,vc,ln,un,yo,me);me.forEach((st,Ct)=>{st.subscribe(Ai=>{(Ai||st.done)&&me.delete(Ct)})});let ug=L(),yc=W(Z),Ef=ug||yc||un.length>0;return Ft({loaderData:cg,errors:lg},Ef?{fetchers:new Map(k.fetchers)}:{})}function Je(B,$,ee,de){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");te.has(B)&&b(B);let ve=(de&&de.unstable_flushSync)===!0,We=a||o,Pe=gy(k.location,k.matches,c,l.v7_prependBasename,ee,l.v7_relativeSplatPath,$,de==null?void 0:de.relative),Ie=jc(We,Pe,c);if(!Ie){Ht(B,$,Lr(404,{pathname:Pe}),{flushSync:ve});return}let{path:be,submission:ze,error:ln}=jk(l.v7_normalizeFormMethod,!0,Pe,de);if(ln){Ht(B,$,ln,{flushSync:ve});return}let De=yy(Ie,be);if(R=(de&&de.preventScrollReset)===!0,ze&&li(ze.formMethod)){ue(B,$,be,De,Ie,ve,ze);return}se.set(B,{routeId:$,path:be}),Le(B,$,be,De,Ie,ve,ze)}async function ue(B,$,ee,de,ve,We,Pe){if(Ut(),se.delete(B),!de.route.action&&!de.route.lazy){let Ct=Lr(405,{method:Pe.formMethod,pathname:ee,routeId:$});Ht(B,$,Ct,{flushSync:We});return}let Ie=k.fetchers.get(B);Oe(B,oF(Pe,Ie),{flushSync:We});let be=new AbortController,ze=Su(t.history,ee,be.signal,Pe);te.set(B,be);let ln=z,De=await yu("action",ze,de,ve,s,i,c,l.v7_relativeSplatPath);if(ze.signal.aborted){te.get(B)===be&&te.delete(B);return}if(l.v7_fetcherPersist&&Ee.has(B)){if(Ma(De)||Wc(De)){Oe(B,Eo(void 0));return}}else{if(Ma(De))if(te.delete(B),Z>ln){Oe(B,Eo(void 0));return}else return q.add(B),Oe(B,bu(Pe)),Re(k,De,{fetcherSubmission:Pe});if(Wc(De)){Ht(B,$,De.error);return}}if(Na(De))throw Lr(400,{type:"defer-action"});let dt=k.navigation.location||k.location,wn=Su(t.history,dt,be.signal),Or=a||o,un=k.navigation.state!=="idle"?jc(Or,k.navigation.location,c):k.matches;$e(un,"Didn't find any matches after fetcher action");let gc=++z;ie.set(B,gc);let ag=bu(Pe,De.data);k.fetchers.set(B,ag);let[vc,yo]=Wk(t.history,k,un,Pe,dt,!1,V,J,G,Ee,se,q,Or,c,{[de.route.id]:De.data},void 0);yo.filter(Ct=>Ct.key!==B).forEach(Ct=>{let Ai=Ct.key,Cf=k.fetchers.get(Ai),Bx=bu(void 0,Cf?Cf.data:void 0);k.fetchers.set(Ai,Bx),te.has(Ai)&&b(Ai),Ct.controller&&te.set(Ai,Ct.controller)}),Et({fetchers:new Map(k.fetchers)});let Ea=()=>yo.forEach(Ct=>b(Ct.key));be.signal.addEventListener("abort",Ea);let{results:cg,loaderResults:lg,fetcherResults:ug}=await je(k.matches,un,vc,yo,wn);if(be.signal.aborted)return;be.signal.removeEventListener("abort",Ea),ie.delete(B),te.delete(B),yo.forEach(Ct=>te.delete(Ct.key));let yc=Jk(cg);if(yc){if(yc.idx>=vc.length){let Ct=yo[yc.idx-vc.length].key;q.add(Ct)}return Re(k,yc.result)}let{loaderData:Ef,errors:st}=Hk(k,k.matches,vc,lg,void 0,yo,ug,me);if(k.fetchers.has(B)){let Ct=Eo(De.data);k.fetchers.set(B,Ct)}W(gc),k.navigation.state==="loading"&&gc>Z?($e(T,"Expected pending action"),A&&A.abort(),Sn(k.navigation.location,{matches:un,loaderData:Ef,errors:st,fetchers:new Map(k.fetchers)})):(Et({errors:st,loaderData:Gk(k.loaderData,Ef,un,st),fetchers:new Map(k.fetchers)}),V=!1)}async function Le(B,$,ee,de,ve,We,Pe){let Ie=k.fetchers.get(B);Oe(B,bu(Pe,Ie?Ie.data:void 0),{flushSync:We});let be=new AbortController,ze=Su(t.history,ee,be.signal);te.set(B,be);let ln=z,De=await yu("loader",ze,de,ve,s,i,c,l.v7_relativeSplatPath);if(Na(De)&&(De=await yI(De,ze.signal,!0)||De),te.get(B)===be&&te.delete(B),!ze.signal.aborted){if(Ee.has(B)){Oe(B,Eo(void 0));return}if(Ma(De))if(Z>ln){Oe(B,Eo(void 0));return}else{q.add(B),await Re(k,De);return}if(Wc(De)){Ht(B,$,De.error);return}$e(!Na(De),"Unhandled fetcher deferred data"),Oe(B,Eo(De.data))}}async function Re(B,$,ee){let{submission:de,fetcherSubmission:ve,replace:We}=ee===void 0?{}:ee;$.revalidate&&(V=!0);let Pe=Td(B.location,$.location,{_isRedirect:!0});if($e(Pe,"Expected a location on the redirect navigation"),n){let dt=!1;if($.reloadDocument)dt=!0;else if(pI.test($.location)){const wn=t.history.createURL($.location);dt=wn.origin!==e.location.origin||sf(wn.pathname,c)==null}if(dt){We?e.location.replace($.location):e.location.assign($.location);return}}A=null;let Ie=We===!0?jt.Replace:jt.Push,{formMethod:be,formAction:ze,formEncType:ln}=B.navigation;!de&&!ve&&be&&ze&&ln&&(de=Kk(B.navigation));let De=de||ve;if(qL.has($.status)&&De&&li(De.formMethod))await le(Ie,Pe,{submission:Ft({},De,{formAction:$.location}),preventScrollReset:R});else{let dt=jg(Pe,de);await le(Ie,Pe,{overrideNavigation:dt,fetcherSubmission:ve,preventScrollReset:R})}}async function je(B,$,ee,de,ve){let We=await Promise.all([...ee.map(be=>yu("loader",ve,be,$,s,i,c,l.v7_relativeSplatPath)),...de.map(be=>be.matches&&be.match&&be.controller?yu("loader",Su(t.history,be.path,be.controller.signal),be.match,be.matches,s,i,c,l.v7_relativeSplatPath):{type:Dt.error,error:Lr(404,{pathname:be.path})})]),Pe=We.slice(0,ee.length),Ie=We.slice(ee.length);return await Promise.all([Zk(B,ee,Pe,Pe.map(()=>ve.signal),!1,k.loaderData),Zk(B,de.map(be=>be.match),Ie,de.map(be=>be.controller?be.controller.signal:null),!0)]),{results:We,loaderResults:Pe,fetcherResults:Ie}}function Ut(){V=!0,J.push(...ut()),se.forEach((B,$)=>{te.has($)&&(G.push($),b($))})}function Oe(B,$,ee){ee===void 0&&(ee={}),k.fetchers.set(B,$),Et({fetchers:new Map(k.fetchers)},{flushSync:(ee&&ee.flushSync)===!0})}function Ht(B,$,ee,de){de===void 0&&(de={});let ve=Yu(k.matches,$);I(B),Et({errors:{[ve.route.id]:ee},fetchers:new Map(k.fetchers)},{flushSync:(de&&de.flushSync)===!0})}function mc(B){return l.v7_fetcherPersist&&(ke.set(B,(ke.get(B)||0)+1),Ee.has(B)&&Ee.delete(B)),k.fetchers.get(B)||JL}function I(B){let $=k.fetchers.get(B);te.has(B)&&!($&&$.state==="loading"&&ie.has(B))&&b(B),se.delete(B),ie.delete(B),q.delete(B),Ee.delete(B),k.fetchers.delete(B)}function S(B){if(l.v7_fetcherPersist){let $=(ke.get(B)||0)-1;$<=0?(ke.delete(B),Ee.add(B)):ke.set(B,$)}else I(B);Et({fetchers:new Map(k.fetchers)})}function b(B){let $=te.get(B);$e($,"Expected fetch controller: "+B),$.abort(),te.delete(B)}function N(B){for(let $ of B){let ee=mc($),de=Eo(ee.data);k.fetchers.set($,de)}}function L(){let B=[],$=!1;for(let ee of q){let de=k.fetchers.get(ee);$e(de,"Expected fetcher: "+ee),de.state==="loading"&&(q.delete(ee),B.push(ee),$=!0)}return N(B),$}function W(B){let $=[];for(let[ee,de]of ie)if(de<B){let ve=k.fetchers.get(ee);$e(ve,"Expected fetcher: "+ee),ve.state==="loading"&&(b(ee),ie.delete(ee),$.push(ee))}return N($),$.length>0}function Q(B,$){let ee=k.blockers.get(B)||vu;return Te.get(B)!==$&&Te.set(B,$),ee}function Ne(B){k.blockers.delete(B),Te.delete(B)}function rt(B,$){let ee=k.blockers.get(B)||vu;$e(ee.state==="unblocked"&&$.state==="blocked"||ee.state==="blocked"&&$.state==="blocked"||ee.state==="blocked"&&$.state==="proceeding"||ee.state==="blocked"&&$.state==="unblocked"||ee.state==="proceeding"&&$.state==="unblocked","Invalid blocker state transition: "+ee.state+" -> "+$.state);let de=new Map(k.blockers);de.set(B,$),Et({blockers:de})}function it(B){let{currentLocation:$,nextLocation:ee,historyAction:de}=B;if(Te.size===0)return;Te.size>1&&qa(!1,"A router only supports one blocker at a time");let ve=Array.from(Te.entries()),[We,Pe]=ve[ve.length-1],Ie=k.blockers.get(We);if(!(Ie&&Ie.state==="proceeding")&&Pe({currentLocation:$,nextLocation:ee,historyAction:de}))return We}function ut(B){let $=[];return me.forEach((ee,de)=>{(!B||B(de))&&(ee.cancel(),$.push(de),me.delete(de))}),$}function Xe(B,$,ee){if(f=B,p=$,h=ee||null,!g&&k.navigation===Ug){g=!0;let de=Iw(k.location,k.matches);de!=null&&Et({restoreScrollPosition:de})}return()=>{f=null,p=null,h=null}}function _w(B,$){return h&&h(B,$.map(de=>wL(de,k.loaderData)))||B.key}function Lx(B,$){if(f&&p){let ee=_w(B,$);f[ee]=p()}}function Iw(B,$){if(f){let ee=_w(B,$),de=f[ee];if(typeof de=="number")return de}return null}function Fx(B){s={},a=my(B,i,void 0,s)}return C={get basename(){return c},get future(){return l},get state(){return k},get routes(){return o},get window(){return e},initialize:ce,subscribe:cn,enableScrollRestoration:Xe,navigate:Zt,fetch:Je,revalidate:bn,createHref:B=>t.history.createHref(B),encodeLocation:B=>t.history.encodeLocation(B),getFetcher:mc,deleteFetcher:S,dispose:xt,getBlocker:Q,deleteBlocker:Ne,_internalFetchControllers:te,_internalActiveDeferreds:me,_internalSetRoutes:Fx},C}function YL(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function gy(t,e,n,r,i,s,o,a){let c,l;if(o){c=[];for(let d of e)if(c.push(d),d.route.id===o){l=d;break}}else c=e,l=e[e.length-1];let u=UL(i||".",BL(c,s),sf(t.pathname,n)||t.pathname,a==="path");return i==null&&(u.search=t.search,u.hash=t.hash),(i==null||i===""||i===".")&&l&&l.route.index&&!ZS(u.search)&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:Ua([n,u.pathname])),rf(u)}function jk(t,e,n,r){if(!r||!YL(r))return{path:n};if(r.formMethod&&!iF(r.formMethod))return{path:n,error:Lr(405,{method:r.formMethod})};let i=()=>({path:n,error:Lr(400,{type:"invalid-body"})}),s=r.formMethod||"get",o=t?s.toUpperCase():s.toLowerCase(),a=vI(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!li(o))return i();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[g,y]=p;return""+h+g+"="+y+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!li(o))return i();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return i()}}}$e(typeof FormData=="function","FormData is not available in this environment");let c,l;if(r.formData)c=vy(r.formData),l=r.formData;else if(r.body instanceof FormData)c=vy(r.body),l=r.body;else if(r.body instanceof URLSearchParams)c=r.body,l=$k(c);else if(r.body==null)c=new URLSearchParams,l=new FormData;else try{c=new URLSearchParams(r.body),l=$k(c)}catch{return i()}let u={formMethod:o,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:l,json:void 0,text:void 0};if(li(u.formMethod))return{path:n,submission:u};let d=ho(n);return e&&d.search&&ZS(d.search)&&c.append("index",""),d.search="?"+c,{path:rf(d),submission:u}}function XL(t,e){let n=t;if(e){let r=t.findIndex(i=>i.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function Wk(t,e,n,r,i,s,o,a,c,l,u,d,f,h,p,g){let y=g?Object.values(g)[0]:p?Object.values(p)[0]:void 0,m=t.createURL(e.location),v=t.createURL(i),w=g?Object.keys(g)[0]:void 0,C=XL(n,w).filter((T,R)=>{let{route:A}=T;if(A.lazy)return!0;if(A.loader==null)return!1;if(s)return A.loader.hydrate?!0:e.loaderData[A.id]===void 0&&(!e.errors||e.errors[A.id]===void 0);if(QL(e.loaderData,e.matches[R],T)||a.some(D=>D===T.route.id))return!0;let M=e.matches[R],O=T;return Vk(T,Ft({currentUrl:m,currentParams:M.params,nextUrl:v,nextParams:O.params},r,{actionResult:y,defaultShouldRevalidate:o||m.pathname+m.search===v.pathname+v.search||m.search!==v.search||gI(M,O)}))}),k=[];return u.forEach((T,R)=>{if(s||!n.some(j=>j.route.id===T.routeId)||l.has(R))return;let A=jc(f,T.path,h);if(!A){k.push({key:R,routeId:T.routeId,path:T.path,matches:null,match:null,controller:null});return}let M=e.fetchers.get(R),O=yy(A,T.path),D=!1;d.has(R)?D=!1:c.includes(R)?D=!0:M&&M.state!=="idle"&&M.data===void 0?D=o:D=Vk(O,Ft({currentUrl:m,currentParams:e.matches[e.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params},r,{actionResult:y,defaultShouldRevalidate:o})),D&&k.push({key:R,routeId:T.routeId,path:T.path,matches:A,match:O,controller:new AbortController})}),[C,k]}function QL(t,e,n){let r=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return r||i}function gI(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function Vk(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function zk(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let i=n[t.id];$e(i,"No route found in manifest");let s={};for(let o in r){let c=i[o]!==void 0&&o!=="hasErrorBoundary";qa(!c,'Route "'+i.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!c&&!SL.has(o)&&(s[o]=r[o])}Object.assign(i,s),Object.assign(i,Ft({},e(i),{lazy:void 0}))}async function yu(t,e,n,r,i,s,o,a,c){c===void 0&&(c={});let l,u,d,f=g=>{let y,m=new Promise((v,w)=>y=w);return d=()=>y(),e.signal.addEventListener("abort",d),Promise.race([g({request:e,params:n.params,context:c.requestContext}),m])};try{let g=n.route[t];if(n.route.lazy)if(g){let y,m=await Promise.all([f(g).catch(v=>{y=v}),zk(n.route,s,i)]);if(y)throw y;u=m[0]}else if(await zk(n.route,s,i),g=n.route[t],g)u=await f(g);else if(t==="action"){let y=new URL(e.url),m=y.pathname+y.search;throw Lr(405,{method:e.method,pathname:m,routeId:n.route.id})}else return{type:Dt.data,data:void 0};else if(g)u=await f(g);else{let y=new URL(e.url),m=y.pathname+y.search;throw Lr(404,{pathname:m})}$e(u!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(g){l=Dt.error,u=g}finally{d&&e.signal.removeEventListener("abort",d)}if(rF(u)){let g=u.status;if(GL.has(g)){let m=u.headers.get("Location");if($e(m,"Redirects returned/thrown from loaders/actions must have a Location header"),!pI.test(m))m=gy(new URL(e.url),r.slice(0,r.indexOf(n)+1),o,!0,m,a);else if(!c.isStaticRequest){let v=new URL(e.url),w=m.startsWith("//")?new URL(v.protocol+m):new URL(m),_=sf(w.pathname,o)!=null;w.origin===v.origin&&_&&(m=w.pathname+w.search+w.hash)}if(c.isStaticRequest)throw u.headers.set("Location",m),u;return{type:Dt.redirect,status:g,location:m,revalidate:u.headers.get("X-Remix-Revalidate")!==null,reloadDocument:u.headers.get("X-Remix-Reload-Document")!==null}}if(c.isRouteRequest)throw{type:l===Dt.error?Dt.error:Dt.data,response:u};let y;try{let m=u.headers.get("Content-Type");m&&/\bapplication\/json\b/.test(m)?y=await u.json():y=await u.text()}catch(m){return{type:Dt.error,error:m}}return l===Dt.error?{type:l,error:new JS(g,u.statusText,y),headers:u.headers}:{type:Dt.data,data:y,statusCode:u.status,headers:u.headers}}if(l===Dt.error)return{type:l,error:u};if(nF(u)){var h,p;return{type:Dt.deferred,deferredData:u,statusCode:(h=u.init)==null?void 0:h.status,headers:((p=u.init)==null?void 0:p.headers)&&new Headers(u.init.headers)}}return{type:Dt.data,data:u}}function Su(t,e,n,r){let i=t.createURL(vI(e)).toString(),s={signal:n};if(r&&li(r.formMethod)){let{formMethod:o,formEncType:a}=r;s.method=o.toUpperCase(),a==="application/json"?(s.headers=new Headers({"Content-Type":a}),s.body=JSON.stringify(r.json)):a==="text/plain"?s.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?s.body=vy(r.formData):s.body=r.formData}return new Request(i,s)}function vy(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function $k(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function eF(t,e,n,r,i){let s={},o=null,a,c=!1,l={};return n.forEach((u,d)=>{let f=e[d].route.id;if($e(!Ma(u),"Cannot handle redirect results in processLoaderData"),Wc(u)){let h=Yu(t,f),p=u.error;r&&(p=Object.values(r)[0],r=void 0),o=o||{},o[h.route.id]==null&&(o[h.route.id]=p),s[f]=void 0,c||(c=!0,a=fI(u.error)?u.error.status:500),u.headers&&(l[f]=u.headers)}else Na(u)?(i.set(f,u.deferredData),s[f]=u.deferredData.data):s[f]=u.data,u.statusCode!=null&&u.statusCode!==200&&!c&&(a=u.statusCode),u.headers&&(l[f]=u.headers)}),r&&(o=r,s[Object.keys(r)[0]]=void 0),{loaderData:s,errors:o,statusCode:a||200,loaderHeaders:l}}function Hk(t,e,n,r,i,s,o,a){let{loaderData:c,errors:l}=eF(e,n,r,i,a);for(let u=0;u<s.length;u++){let{key:d,match:f,controller:h}=s[u];$e(o!==void 0&&o[u]!==void 0,"Did not find corresponding fetcher result");let p=o[u];if(!(h&&h.signal.aborted))if(Wc(p)){let g=Yu(t.matches,f==null?void 0:f.route.id);l&&l[g.route.id]||(l=Ft({},l,{[g.route.id]:p.error})),t.fetchers.delete(d)}else if(Ma(p))$e(!1,"Unhandled fetcher revalidation redirect");else if(Na(p))$e(!1,"Unhandled fetcher deferred data");else{let g=Eo(p.data);t.fetchers.set(d,g)}}return{loaderData:c,errors:l}}function Gk(t,e,n,r){let i=Ft({},e);for(let s of n){let o=s.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(i[o]=e[o]):t[o]!==void 0&&s.route.loader&&(i[o]=t[o]),r&&r.hasOwnProperty(o))break}return i}function Yu(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function qk(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Lr(t,e){let{pathname:n,routeId:r,method:i,type:s}=e===void 0?{}:e,o="Unknown Server Error",a="Unknown @remix-run/router error";return t===400?(o="Bad Request",i&&n&&r?a="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":s==="defer-action"?a="defer() is not supported in actions":s==="invalid-body"&&(a="Unable to encode submission body")):t===403?(o="Forbidden",a='Route "'+r+'" does not match URL "'+n+'"'):t===404?(o="Not Found",a='No route matches URL "'+n+'"'):t===405&&(o="Method Not Allowed",i&&n&&r?a="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(a='Invalid request method "'+i.toUpperCase()+'"')),new JS(t||500,o,new Error(a),!0)}function Jk(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(Ma(n))return{result:n,idx:e}}}function vI(t){let e=typeof t=="string"?ho(t):t;return rf(Ft({},e,{hash:""}))}function tF(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function Na(t){return t.type===Dt.deferred}function Wc(t){return t.type===Dt.error}function Ma(t){return(t&&t.type)===Dt.redirect}function nF(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function rF(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function iF(t){return HL.has(t.toLowerCase())}function li(t){return zL.has(t.toLowerCase())}async function Zk(t,e,n,r,i,s){for(let o=0;o<n.length;o++){let a=n[o],c=e[o];if(!c)continue;let l=t.find(d=>d.route.id===c.route.id),u=l!=null&&!gI(l,c)&&(s&&s[c.route.id])!==void 0;if(Na(a)&&(i||u)){let d=r[o];$e(d,"Expected an AbortSignal for revalidating fetcher deferred result"),await yI(a,d,i).then(f=>{f&&(n[o]=f||n[o])})}}}async function yI(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Dt.data,data:t.deferredData.unwrappedData}}catch(i){return{type:Dt.error,error:i}}return{type:Dt.data,data:t.deferredData.data}}}function ZS(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function yy(t,e){let n=typeof e=="string"?ho(e).search:e.search;if(t[t.length-1].route.index&&ZS(n||""))return t[t.length-1];let r=dI(t);return r[r.length-1]}function Kk(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:s,json:o}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:s,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function jg(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function sF(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function bu(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function oF(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Eo(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function aF(t,e){try{let n=t.sessionStorage.getItem(mI);if(n){let r=JSON.parse(n);for(let[i,s]of Object.entries(r||{}))s&&Array.isArray(s)&&e.set(i,new Set(s||[]))}}catch{}}function cF(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(mI,JSON.stringify(n))}catch(r){qa(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lp(){return lp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lp.apply(this,arguments)}const SI=E.createContext(null),bI=E.createContext(null),wI=E.createContext(null),fm=E.createContext(null),hm=E.createContext({outlet:null,matches:[],isDataRoute:!1}),kI=E.createContext(null);function KS(){return E.useContext(fm)!=null}function EI(){return KS()||$e(!1),E.useContext(fm).location}function lF(t,e,n,r){KS()||$e(!1);let{navigator:i}=E.useContext(wI),{matches:s}=E.useContext(hm),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let l=EI(),u;if(e){var d;let y=typeof e=="string"?ho(e):e;c==="/"||(d=y.pathname)!=null&&d.startsWith(c)||$e(!1),u=y}else u=l;let f=u.pathname||"/",h=c==="/"?f:f.slice(c.length)||"/",p=jc(t,{pathname:h}),g=pF(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:Ua([c,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Ua([c,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,n,r);return e&&g?E.createElement(fm.Provider,{value:{location:lp({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:jt.Pop}},g):g}function uF(){let t=yF(),e=fI(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),n?E.createElement("pre",{style:i},n):null,s)}const dF=E.createElement(uF,null);class fF extends E.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?E.createElement(hm.Provider,{value:this.props.routeContext},E.createElement(kI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function hF(t){let{routeContext:e,match:n,children:r}=t,i=E.useContext(SI);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),E.createElement(hm.Provider,{value:e},r)}function pF(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id]));u>=0||$e(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=u),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){c=!0,l>=0?o=o.slice(0,l+1):o=[o[0]];break}}}return o.reduceRight((u,d,f)=>{let h,p=!1,g=null,y=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,g=d.route.errorElement||dF,c&&(l<0&&f===0?(SF("route-fallback",!1),p=!0,y=null):l===f&&(p=!0,y=d.route.hydrateFallbackElement||null)));let m=e.concat(o.slice(0,f+1)),v=()=>{let w;return h?w=g:p?w=y:d.route.Component?w=E.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=u,E.createElement(hF,{match:d,routeContext:{outlet:u,matches:m,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?E.createElement(fF,{location:n.location,revalidation:n.revalidation,component:g,error:h,children:v(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):v()},null)}var Sy=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Sy||{});function mF(t){let e=E.useContext(bI);return e||$e(!1),e}function gF(t){let e=E.useContext(hm);return e||$e(!1),e}function vF(t){let e=gF(),n=e.matches[e.matches.length-1];return n.route.id||$e(!1),n.route.id}function yF(){var t;let e=E.useContext(kI),n=mF(Sy.UseRouteError),r=vF(Sy.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}const Yk={};function SF(t,e,n){!e&&!Yk[t]&&(Yk[t]=!0)}function bF(t){let{basename:e="/",children:n=null,location:r,navigationType:i=jt.Pop,navigator:s,static:o=!1,future:a}=t;KS()&&$e(!1);let c=e.replace(/^\/*/,"/"),l=E.useMemo(()=>({basename:c,navigator:s,static:o,future:lp({v7_relativeSplatPath:!1},a)}),[c,a,s,o]);typeof r=="string"&&(r=ho(r));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,g=E.useMemo(()=>{let y=sf(u,c);return y==null?null:{location:{pathname:y,search:d,hash:f,state:h,key:p},navigationType:i}},[c,u,d,f,h,p,i]);return g==null?null:E.createElement(wI.Provider,{value:l},E.createElement(fm.Provider,{children:n,value:g}))}new Promise(()=>{});function wF(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:E.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:E.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:E.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function up(){return up=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},up.apply(this,arguments)}function kF(t,e){return KL({basename:e==null?void 0:e.basename,future:up({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:gL({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||EF(),routes:t,mapRouteProperties:wF,window:e==null?void 0:e.window}).initialize()}function EF(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=up({},e,{errors:CF(e.errors)})),e}function CF(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new JS(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let o=new s(i.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let s=new Error(i.message);s.stack="",n[r]=s}}else n[r]=i;return n}const TF=E.createContext({isTransitioning:!1}),_F=E.createContext(new Map),IF="startTransition",Xk=iO[IF],RF="flushSync",Qk=mL[RF];function PF(t){Xk?Xk(t):t()}function wu(t){Qk?Qk(t):t()}class AF{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function NF(t){let{fallbackElement:e,router:n,future:r}=t,[i,s]=E.useState(n.state),[o,a]=E.useState(),[c,l]=E.useState({isTransitioning:!1}),[u,d]=E.useState(),[f,h]=E.useState(),[p,g]=E.useState(),y=E.useRef(new Map),{v7_startTransition:m}=r||{},v=E.useCallback(T=>{m?PF(T):T()},[m]),w=E.useCallback((T,R)=>{let{deletedFetchers:A,unstable_flushSync:M,unstable_viewTransitionOpts:O}=R;A.forEach(j=>y.current.delete(j)),T.fetchers.forEach((j,V)=>{j.data!==void 0&&y.current.set(V,j.data)});let D=n.window==null||typeof n.window.document.startViewTransition!="function";if(!O||D){M?wu(()=>s(T)):v(()=>s(T));return}if(M){wu(()=>{f&&(u&&u.resolve(),f.skipTransition()),l({isTransitioning:!0,flushSync:!0,currentLocation:O.currentLocation,nextLocation:O.nextLocation})});let j=n.window.document.startViewTransition(()=>{wu(()=>s(T))});j.finished.finally(()=>{wu(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})})}),wu(()=>h(j));return}f?(u&&u.resolve(),f.skipTransition(),g({state:T,currentLocation:O.currentLocation,nextLocation:O.nextLocation})):(a(T),l({isTransitioning:!0,flushSync:!1,currentLocation:O.currentLocation,nextLocation:O.nextLocation}))},[n.window,f,u,y,v]);E.useLayoutEffect(()=>n.subscribe(w),[n,w]),E.useEffect(()=>{c.isTransitioning&&!c.flushSync&&d(new AF)},[c]),E.useEffect(()=>{if(u&&o&&n.window){let T=o,R=u.promise,A=n.window.document.startViewTransition(async()=>{v(()=>s(T)),await R});A.finished.finally(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})}),h(A)}},[v,o,u,n.window]),E.useEffect(()=>{u&&o&&i.location.key===o.location.key&&u.resolve()},[u,f,i.location,o]),E.useEffect(()=>{!c.isTransitioning&&p&&(a(p.state),l({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),g(void 0))},[c.isTransitioning,p]),E.useEffect(()=>{},[]);let _=E.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:T=>n.navigate(T),push:(T,R,A)=>n.navigate(T,{state:R,preventScrollReset:A==null?void 0:A.preventScrollReset}),replace:(T,R,A)=>n.navigate(T,{replace:!0,state:R,preventScrollReset:A==null?void 0:A.preventScrollReset})}),[n]),C=n.basename||"/",k=E.useMemo(()=>({router:n,navigator:_,static:!1,basename:C}),[n,_,C]);return E.createElement(E.Fragment,null,E.createElement(SI.Provider,{value:k},E.createElement(bI.Provider,{value:i},E.createElement(_F.Provider,{value:y.current},E.createElement(TF.Provider,{value:c},E.createElement(bF,{basename:C,location:i.location,navigationType:i.historyAction,navigator:_,future:{v7_relativeSplatPath:n.future.v7_relativeSplatPath}},i.initialized||n.future.v7_partialHydration?E.createElement(MF,{routes:n.routes,future:n.future,state:i}):e))))),null)}function MF(t){let{routes:e,future:n,state:r}=t;return lF(e,void 0,r,n)}var eE;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(eE||(eE={}));var tE;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(tE||(tE={}));const CI=t=>{const e=typeof t=="function",n=E.useRef(t);E.useEffect(()=>{n.current=t}),E.useEffect(()=>{if(e){const r=i=>{const s=n.current(i);if(typeof s=="string")return i.preventDefault(),i.returnValue=s;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])};var nE=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function xF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var bo=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],OF=function(){nE(t,null,[{key:"escapeForHtml",value:function(n){return new t().escapeForHtml(n)}},{key:"linkify",value:function(n){return new t().linkify(n)}},{key:"ansiToHtml",value:function(n,r){return new t().ansiToHtml(n,r)}},{key:"ansiToJson",value:function(n,r){return new t().ansiToJson(n,r)}},{key:"ansiToText",value:function(n){return new t().ansiToText(n)}}]);function t(){xF(this,t),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return nE(t,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var n=0;n<2;++n)for(var r=0;r<8;++r)this.PALETTE_COLORS.push(bo[n][r].color);for(var i=[0,95,135,175,215,255],s=function(f,h,p){return i[f]+", "+i[h]+", "+i[p]},o=0;o<6;++o)for(var a=0;a<6;++a)for(var c=0;c<6;++c)this.PALETTE_COLORS.push(s(o,a,c));for(var l=8,u=0;u<24;++u,l+=10)this.PALETTE_COLORS.push(s(l,l,l))}},{key:"escapeForHtml",value:function(n){return n.replace(/[&<>\"]/gm,function(r){return r=="&"?"&amp;":r=='"'?"&quot;":r=="<"?"&lt;":r==">"?"&gt;":""})}},{key:"linkify",value:function(n){return n.replace(/(https?:\/\/[^\s]+)/gm,function(r){return'<a href="'+r+'">'+r+"</a>"})}},{key:"ansiToHtml",value:function(n,r){return this.process(n,r,!0)}},{key:"ansiToJson",value:function(n,r){return r=r||{},r.json=!0,r.clearLine=!1,this.process(n,r,!0)}},{key:"ansiToText",value:function(n){return this.process(n,{},!1)}},{key:"process",value:function(n,r,i){var s=this,o=this,a=n.split(/\033\[/),c=a.shift();r==null&&(r={}),r.clearLine=/\r/.test(n);var l=a.map(function(d){return s.processChunk(d,r,i)});if(r&&r.json){var u=o.processChunkJson("");return u.content=c,u.clearLine=r.clearLine,l.unshift(u),r.remove_empty&&(l=l.filter(function(d){return!d.isEmpty()})),l}else l.unshift(c);return l.join("")}},{key:"processChunkJson",value:function(n,r,i){r=typeof r>"u"?{}:r;var s=r.use_classes=typeof r.use_classes<"u"&&r.use_classes,o=r.key=s?"class":"color",a={content:n,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:r.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!a.content}},c=n.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!c)return a;a.content=c[4];var l=c[2].split(";");if(c[1]!==""||c[3]!=="m"||!i)return a;for(var u=this;l.length>0;){var d=l.shift(),f=parseInt(d);if(isNaN(f)||f===0)u.fg=u.bg=null,u.decorations=[];else if(f===1)u.decorations.push("bold");else if(f===2)u.decorations.push("dim");else if(f===3)u.decorations.push("italic");else if(f===4)u.decorations.push("underline");else if(f===5)u.decorations.push("blink");else if(f===7)u.decorations.push("reverse");else if(f===8)u.decorations.push("hidden");else if(f===9)u.decorations.push("strikethrough");else if(f===21)u.removeDecoration("bold");else if(f===22)u.removeDecoration("bold"),u.removeDecoration("dim");else if(f===23)u.removeDecoration("italic");else if(f===24)u.removeDecoration("underline");else if(f===25)u.removeDecoration("blink");else if(f===27)u.removeDecoration("reverse");else if(f===28)u.removeDecoration("hidden");else if(f===29)u.removeDecoration("strikethrough");else if(f===39)u.fg=null;else if(f===49)u.bg=null;else if(f>=30&&f<38)u.fg=bo[0][f%10][o];else if(f>=90&&f<98)u.fg=bo[1][f%10][o];else if(f>=40&&f<48)u.bg=bo[0][f%10][o];else if(f>=100&&f<108)u.bg=bo[1][f%10][o];else if(f===38||f===48){var h=f===38;if(l.length>=1){var p=l.shift();if(p==="5"&&l.length>=1){var g=parseInt(l.shift());if(g>=0&&g<=255)if(!s)this.PALETTE_COLORS||u.setupPalette(),h?u.fg=this.PALETTE_COLORS[g]:u.bg=this.PALETTE_COLORS[g];else{var y=g>=16?"ansi-palette-"+g:bo[g>7?1:0][g%8].class;h?u.fg=y:u.bg=y}}else if(p==="2"&&l.length>=3){var m=parseInt(l.shift()),v=parseInt(l.shift()),w=parseInt(l.shift());if(m>=0&&m<=255&&v>=0&&v<=255&&w>=0&&w<=255){var _=m+", "+v+", "+w;s?h?(u.fg="ansi-truecolor",u.fg_truecolor=_):(u.bg="ansi-truecolor",u.bg_truecolor=_):h?u.fg=_:u.bg=_}}}}}return u.fg===null&&u.bg===null&&u.decorations.length===0||(a.fg=u.fg,a.bg=u.bg,a.fg_truecolor=u.fg_truecolor,a.bg_truecolor=u.bg_truecolor,a.decorations=u.decorations,a.decoration=u.decorations.slice(-1).pop()||null,a.was_processed=!0),a}},{key:"processChunk",value:function(n,r,i){var s=this;r=r||{};var o=this.processChunkJson(n,r,i),a=r.use_classes;if(o.decorations=o.decorations.filter(function(h){if(h==="reverse"){o.fg||(o.fg=bo[0][7][a?"class":"color"]),o.bg||(o.bg=bo[0][0][a?"class":"color"]);var p=o.fg;o.fg=o.bg,o.bg=p;var g=o.fg_truecolor;return o.fg_truecolor=o.bg_truecolor,o.bg_truecolor=g,o.isInverted=!0,!1}return!0}),r.json)return o;if(o.isEmpty())return"";if(!o.was_processed)return o.content;var c=[],l=[],u=[],d={},f=function(p){var g=[],y=void 0;for(y in p)p.hasOwnProperty(y)&&g.push("data-"+y+'="'+s.escapeForHtml(p[y])+'"');return g.length>0?" "+g.join(" "):""};return o.isInverted&&(d["ansi-is-inverted"]="true"),o.fg&&(a?(c.push(o.fg+"-fg"),o.fg_truecolor!==null&&(d["ansi-truecolor-fg"]=o.fg_truecolor,o.fg_truecolor=null)):c.push("color:rgb("+o.fg+")")),o.bg&&(a?(c.push(o.bg+"-bg"),o.bg_truecolor!==null&&(d["ansi-truecolor-bg"]=o.bg_truecolor,o.bg_truecolor=null)):c.push("background-color:rgb("+o.bg+")")),o.decorations.forEach(function(h){if(a){l.push("ansi-"+h);return}h==="bold"?l.push("font-weight:bold"):h==="dim"?l.push("opacity:0.5"):h==="italic"?l.push("font-style:italic"):h==="hidden"?l.push("visibility:hidden"):h==="strikethrough"?u.push("line-through"):u.push(h)}),u.length&&l.push("text-decoration:"+u.join(" ")),a?'<span class="'+c.concat(l).join(" ")+'"'+f(d)+">"+o.content+"</span>":'<span style="'+c.concat(l).join(";")+'"'+f(d)+">"+o.content+"</span>"}},{key:"removeDecoration",value:function(n){var r=this.decorations.indexOf(n);r>=0&&this.decorations.splice(r,1)}}]),t}(),DF=OF;const LF=Yd(DF);function FF(t,e){let n=[];for(const r of t.split(`\r
`)){const i=LF.ansiToJson(r,{json:!0,remove_empty:!1});let s=[];for(const o of i){const a=WF(o,e);s=[...s,...a]}n=[...n,X.jsx("span",{children:s},n.length)]}return n}const BF=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,UF=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,jF=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function WF(t,e){const n=VF(t),r=[];let i=0;function s(l,u){let d;for(;(d=l.exec(t.content))!==null;){const f=d.index;f>i&&r.push(t.content.substring(i,f)),r.push(u(d)),i=l.lastIndex}}function o(l){const[,u,d]=l,f=d;return X.jsxs(X.Fragment,{children:[u,X.jsx("a",{href:f,target:"_blank",rel:"noreferrer",children:d})]})}function a(l){const u=l.groups.name,d=`mailto:${u}`;return X.jsxs(X.Fragment,{children:[l.groups.slorp1,X.jsx("a",{href:d,target:"_blank",rel:"noreferrer",children:u}),l.groups.slorp2]})}function c(l){const[,u,d]=l;return X.jsx("a",{onClick:()=>e(u),className:"exit",children:d})}return s(BF,o),s(UF,a),s(jF,c),i<t.content.length&&r.push(t.content.substring(i)),r.map(l=>X.jsx("span",{style:n,children:l}))}function VF(t){const e={};switch(t.bg&&(e.backgroundColor=`rgb(${t.bg})`),t.fg&&(e.color=`rgb(${t.fg})`),t.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}class zF extends wt.Component{constructor(n){super(n);H(this,"outputRef",wt.createRef());H(this,"state",{output:[],sidebarVisible:!1});H(this,"addCommand",n=>{this.addToOutput([X.jsx("span",{className:"command","aria-live":"off",children:n})])});H(this,"addError",n=>this.addToOutput([X.jsxs("h2",{children:[" Error: ",n.message]})]));H(this,"handleConnected",()=>this.addToOutput([X.jsx("h2",{children:" Connected"})]));H(this,"handleDisconnected",()=>{this.addToOutput([X.jsx("h2",{children:" Disconnected"})]),this.state.sidebarVisible=!1});H(this,"handleUserList",n=>this.setState({sidebarVisible:!!n}));H(this,"scrollToBottom",()=>{const n=this.outputRef.current;n&&(n.scrollTop=n.scrollHeight)});H(this,"handleMessage",n=>{const r=FF(n,this.handleExitClick);this.addToOutput(r)});H(this,"handleExitClick",n=>{this.props.client.sendCommand(n)});this.props.client.on("message",this.handleMessage),this.props.client.on("connect",this.handleConnected),this.props.client.on("disconnect",this.handleDisconnected),this.props.client.on("error",this.addError),this.props.client.on("command",this.addCommand),this.props.client.on("userlist",this.handleUserList)}componentDidUpdate(){this.scrollToBottom()}componentWillUnmount(){this.props.client.removeListener("message",this.handleMessage)}addToOutput(n){this.setState(r=>{const i=r.output.length,s=n.map((o,a)=>X.jsx("div",{children:o},i+a));return{output:[...r.output,...s]}})}saveLog(){const n=this.outputRef.current;if(n){const r=n.innerHTML,i=new Blob([r],{type:"text/html"}),s=URL.createObjectURL(i),o=document.createElement("a"),a=new Date,c=a.toLocaleDateString(),l=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=`${document.title.replace(/\s+/g,"-")}-log-${c}-${l}.html`;o.download=d,o.href=s,o.click(),URL.revokeObjectURL(s),o.remove()}}clearLog(){this.setState({output:[]})}render(){var n="output";return this.state.sidebarVisible&&(n+=" sidebar-visible"),X.jsx("div",{ref:this.outputRef,className:n,"aria-live":"polite",role:"log",children:this.state.output})}}var TI={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function s(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new i(u,d||c,f),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],h]:c._events[p].push(h):(c._events[p]=h,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,f,h,p){var g=n?n+l:l;if(!this._events[g])return!1;var y=this._events[g],m=arguments.length,v,w;if(y.fn){switch(y.once&&this.removeListener(l,y.fn,void 0,!0),m){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,d),!0;case 4:return y.fn.call(y.context,u,d,f),!0;case 5:return y.fn.call(y.context,u,d,f,h),!0;case 6:return y.fn.call(y.context,u,d,f,h,p),!0}for(w=1,v=new Array(m-1);w<m;w++)v[w-1]=arguments[w];y.fn.apply(y.context,v)}else{var _=y.length,C;for(w=0;w<_;w++)switch(y[w].once&&this.removeListener(l,y[w].fn,void 0,!0),m){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,u);break;case 3:y[w].fn.call(y[w].context,u,d);break;case 4:y[w].fn.call(y[w].context,u,d,f);break;default:if(!v)for(C=1,v=new Array(m-1);C<m;C++)v[C-1]=arguments[C];y[w].fn.apply(y[w].context,v)}}return!0},a.prototype.on=function(l,u,d){return s(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return s(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,f){var h=n?n+l:l;if(!this._events[h])return this;if(!u)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&o(this,h);else{for(var g=0,y=[],m=p.length;g<m;g++)(p[g].fn!==u||f&&!p[g].once||d&&p[g].context!==d)&&y.push(p[g]);y.length?this._events[h]=y.length===1?y[0]:y:o(this,h)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(TI);var $F=TI.exports;const _I=Yd($F);var kn={},pm={};pm.byteLength=qF;pm.toByteArray=ZF;pm.fromByteArray=XF;var ji=[],Dr=[],HF=typeof Uint8Array<"u"?Uint8Array:Array,Wg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var bc=0,GF=Wg.length;bc<GF;++bc)ji[bc]=Wg[bc],Dr[Wg.charCodeAt(bc)]=bc;Dr[45]=62;Dr[95]=63;function II(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function qF(t){var e=II(t),n=e[0],r=e[1];return(n+r)*3/4-r}function JF(t,e,n){return(e+n)*3/4-n}function ZF(t){var e,n=II(t),r=n[0],i=n[1],s=new HF(JF(t,r,i)),o=0,a=i>0?r-4:r,c;for(c=0;c<a;c+=4)e=Dr[t.charCodeAt(c)]<<18|Dr[t.charCodeAt(c+1)]<<12|Dr[t.charCodeAt(c+2)]<<6|Dr[t.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=Dr[t.charCodeAt(c)]<<2|Dr[t.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=Dr[t.charCodeAt(c)]<<10|Dr[t.charCodeAt(c+1)]<<4|Dr[t.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function KF(t){return ji[t>>18&63]+ji[t>>12&63]+ji[t>>6&63]+ji[t&63]}function YF(t,e,n){for(var r,i=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(KF(r));return i.join("")}function XF(t){for(var e,n=t.length,r=n%3,i=[],s=16383,o=0,a=n-r;o<a;o+=s)i.push(YF(t,o,o+s>a?a:o+s));return r===1?(e=t[n-1],i.push(ji[e>>2]+ji[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(ji[e>>10]+ji[e>>4&63]+ji[e<<2&63]+"=")),i.join("")}var YS={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */YS.read=function(t,e,n,r,i){var s,o,a=i*8-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?i-1:0,f=n?-1:1,h=t[e+d];for(d+=f,s=h&(1<<-u)-1,h>>=-u,u+=a;u>0;s=s*256+t[e+d],d+=f,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=r;u>0;o=o*256+t[e+d],d+=f,u-=8);if(s===0)s=1-l;else{if(s===c)return o?NaN:(h?-1:1)*(1/0);o=o+Math.pow(2,r),s=s-l}return(h?-1:1)*o*Math.pow(2,s-r)};YS.write=function(t,e,n,r,i,s){var o,a,c,l=s*8-i-1,u=(1<<l)-1,d=u>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:s-1,p=r?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=f/c:e+=f*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*c-1)*Math.pow(2,i),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;t[n+h]=a&255,h+=p,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;t[n+h]=o&255,h+=p,o/=256,l-=8);t[n+h-p]|=g*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=pm,n=YS,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const I=new Uint8Array(1),S={foo:function(){return 42}};return Object.setPrototypeOf(S,Uint8Array.prototype),Object.setPrototypeOf(I,S),I.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(I){if(I>i)throw new RangeError('The value "'+I+'" is invalid for option "size"');const S=new Uint8Array(I);return Object.setPrototypeOf(S,a.prototype),S}function a(I,S,b){if(typeof I=="number"){if(typeof S=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(I)}return c(I,S,b)}a.poolSize=8192;function c(I,S,b){if(typeof I=="string")return f(I,S);if(ArrayBuffer.isView(I))return p(I);if(I==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof I);if(je(I,ArrayBuffer)||I&&je(I.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(je(I,SharedArrayBuffer)||I&&je(I.buffer,SharedArrayBuffer)))return g(I,S,b);if(typeof I=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const N=I.valueOf&&I.valueOf();if(N!=null&&N!==I)return a.from(N,S,b);const L=y(I);if(L)return L;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof I[Symbol.toPrimitive]=="function")return a.from(I[Symbol.toPrimitive]("string"),S,b);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof I)}a.from=function(I,S,b){return c(I,S,b)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(I){if(typeof I!="number")throw new TypeError('"size" argument must be of type number');if(I<0)throw new RangeError('The value "'+I+'" is invalid for option "size"')}function u(I,S,b){return l(I),I<=0?o(I):S!==void 0?typeof b=="string"?o(I).fill(S,b):o(I).fill(S):o(I)}a.alloc=function(I,S,b){return u(I,S,b)};function d(I){return l(I),o(I<0?0:m(I)|0)}a.allocUnsafe=function(I){return d(I)},a.allocUnsafeSlow=function(I){return d(I)};function f(I,S){if((typeof S!="string"||S==="")&&(S="utf8"),!a.isEncoding(S))throw new TypeError("Unknown encoding: "+S);const b=w(I,S)|0;let N=o(b);const L=N.write(I,S);return L!==b&&(N=N.slice(0,L)),N}function h(I){const S=I.length<0?0:m(I.length)|0,b=o(S);for(let N=0;N<S;N+=1)b[N]=I[N]&255;return b}function p(I){if(je(I,Uint8Array)){const S=new Uint8Array(I);return g(S.buffer,S.byteOffset,S.byteLength)}return h(I)}function g(I,S,b){if(S<0||I.byteLength<S)throw new RangeError('"offset" is outside of buffer bounds');if(I.byteLength<S+(b||0))throw new RangeError('"length" is outside of buffer bounds');let N;return S===void 0&&b===void 0?N=new Uint8Array(I):b===void 0?N=new Uint8Array(I,S):N=new Uint8Array(I,S,b),Object.setPrototypeOf(N,a.prototype),N}function y(I){if(a.isBuffer(I)){const S=m(I.length)|0,b=o(S);return b.length===0||I.copy(b,0,0,S),b}if(I.length!==void 0)return typeof I.length!="number"||Ut(I.length)?o(0):h(I);if(I.type==="Buffer"&&Array.isArray(I.data))return h(I.data)}function m(I){if(I>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return I|0}function v(I){return+I!=I&&(I=0),a.alloc(+I)}a.isBuffer=function(S){return S!=null&&S._isBuffer===!0&&S!==a.prototype},a.compare=function(S,b){if(je(S,Uint8Array)&&(S=a.from(S,S.offset,S.byteLength)),je(b,Uint8Array)&&(b=a.from(b,b.offset,b.byteLength)),!a.isBuffer(S)||!a.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(S===b)return 0;let N=S.length,L=b.length;for(let W=0,Q=Math.min(N,L);W<Q;++W)if(S[W]!==b[W]){N=S[W],L=b[W];break}return N<L?-1:L<N?1:0},a.isEncoding=function(S){switch(String(S).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(S,b){if(!Array.isArray(S))throw new TypeError('"list" argument must be an Array of Buffers');if(S.length===0)return a.alloc(0);let N;if(b===void 0)for(b=0,N=0;N<S.length;++N)b+=S[N].length;const L=a.allocUnsafe(b);let W=0;for(N=0;N<S.length;++N){let Q=S[N];if(je(Q,Uint8Array))W+Q.length>L.length?(a.isBuffer(Q)||(Q=a.from(Q)),Q.copy(L,W)):Uint8Array.prototype.set.call(L,Q,W);else if(a.isBuffer(Q))Q.copy(L,W);else throw new TypeError('"list" argument must be an Array of Buffers');W+=Q.length}return L};function w(I,S){if(a.isBuffer(I))return I.length;if(ArrayBuffer.isView(I)||je(I,ArrayBuffer))return I.byteLength;if(typeof I!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof I);const b=I.length,N=arguments.length>2&&arguments[2]===!0;if(!N&&b===0)return 0;let L=!1;for(;;)switch(S){case"ascii":case"latin1":case"binary":return b;case"utf8":case"utf-8":return Ye(I).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b*2;case"hex":return b>>>1;case"base64":return Le(I).length;default:if(L)return N?-1:Ye(I).length;S=(""+S).toLowerCase(),L=!0}}a.byteLength=w;function _(I,S,b){let N=!1;if((S===void 0||S<0)&&(S=0),S>this.length||((b===void 0||b>this.length)&&(b=this.length),b<=0)||(b>>>=0,S>>>=0,b<=S))return"";for(I||(I="utf8");;)switch(I){case"hex":return Z(this,S,b);case"utf8":case"utf-8":return V(this,S,b);case"ascii":return te(this,S,b);case"latin1":case"binary":return z(this,S,b);case"base64":return j(this,S,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,S,b);default:if(N)throw new TypeError("Unknown encoding: "+I);I=(I+"").toLowerCase(),N=!0}}a.prototype._isBuffer=!0;function C(I,S,b){const N=I[S];I[S]=I[b],I[b]=N}a.prototype.swap16=function(){const S=this.length;if(S%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let b=0;b<S;b+=2)C(this,b,b+1);return this},a.prototype.swap32=function(){const S=this.length;if(S%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let b=0;b<S;b+=4)C(this,b,b+3),C(this,b+1,b+2);return this},a.prototype.swap64=function(){const S=this.length;if(S%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let b=0;b<S;b+=8)C(this,b,b+7),C(this,b+1,b+6),C(this,b+2,b+5),C(this,b+3,b+4);return this},a.prototype.toString=function(){const S=this.length;return S===0?"":arguments.length===0?V(this,0,S):_.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(S){if(!a.isBuffer(S))throw new TypeError("Argument must be a Buffer");return this===S?!0:a.compare(this,S)===0},a.prototype.inspect=function(){let S="";const b=t.INSPECT_MAX_BYTES;return S=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(S+=" ... "),"<Buffer "+S+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(S,b,N,L,W){if(je(S,Uint8Array)&&(S=a.from(S,S.offset,S.byteLength)),!a.isBuffer(S))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof S);if(b===void 0&&(b=0),N===void 0&&(N=S?S.length:0),L===void 0&&(L=0),W===void 0&&(W=this.length),b<0||N>S.length||L<0||W>this.length)throw new RangeError("out of range index");if(L>=W&&b>=N)return 0;if(L>=W)return-1;if(b>=N)return 1;if(b>>>=0,N>>>=0,L>>>=0,W>>>=0,this===S)return 0;let Q=W-L,Ne=N-b;const rt=Math.min(Q,Ne),it=this.slice(L,W),ut=S.slice(b,N);for(let Xe=0;Xe<rt;++Xe)if(it[Xe]!==ut[Xe]){Q=it[Xe],Ne=ut[Xe];break}return Q<Ne?-1:Ne<Q?1:0};function k(I,S,b,N,L){if(I.length===0)return-1;if(typeof b=="string"?(N=b,b=0):b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b=+b,Ut(b)&&(b=L?0:I.length-1),b<0&&(b=I.length+b),b>=I.length){if(L)return-1;b=I.length-1}else if(b<0)if(L)b=0;else return-1;if(typeof S=="string"&&(S=a.from(S,N)),a.isBuffer(S))return S.length===0?-1:T(I,S,b,N,L);if(typeof S=="number")return S=S&255,typeof Uint8Array.prototype.indexOf=="function"?L?Uint8Array.prototype.indexOf.call(I,S,b):Uint8Array.prototype.lastIndexOf.call(I,S,b):T(I,[S],b,N,L);throw new TypeError("val must be string, number or Buffer")}function T(I,S,b,N,L){let W=1,Q=I.length,Ne=S.length;if(N!==void 0&&(N=String(N).toLowerCase(),N==="ucs2"||N==="ucs-2"||N==="utf16le"||N==="utf-16le")){if(I.length<2||S.length<2)return-1;W=2,Q/=2,Ne/=2,b/=2}function rt(ut,Xe){return W===1?ut[Xe]:ut.readUInt16BE(Xe*W)}let it;if(L){let ut=-1;for(it=b;it<Q;it++)if(rt(I,it)===rt(S,ut===-1?0:it-ut)){if(ut===-1&&(ut=it),it-ut+1===Ne)return ut*W}else ut!==-1&&(it-=it-ut),ut=-1}else for(b+Ne>Q&&(b=Q-Ne),it=b;it>=0;it--){let ut=!0;for(let Xe=0;Xe<Ne;Xe++)if(rt(I,it+Xe)!==rt(S,Xe)){ut=!1;break}if(ut)return it}return-1}a.prototype.includes=function(S,b,N){return this.indexOf(S,b,N)!==-1},a.prototype.indexOf=function(S,b,N){return k(this,S,b,N,!0)},a.prototype.lastIndexOf=function(S,b,N){return k(this,S,b,N,!1)};function R(I,S,b,N){b=Number(b)||0;const L=I.length-b;N?(N=Number(N),N>L&&(N=L)):N=L;const W=S.length;N>W/2&&(N=W/2);let Q;for(Q=0;Q<N;++Q){const Ne=parseInt(S.substr(Q*2,2),16);if(Ut(Ne))return Q;I[b+Q]=Ne}return Q}function A(I,S,b,N){return Re(Ye(S,I.length-b),I,b,N)}function M(I,S,b,N){return Re(Je(S),I,b,N)}function O(I,S,b,N){return Re(Le(S),I,b,N)}function D(I,S,b,N){return Re(ue(S,I.length-b),I,b,N)}a.prototype.write=function(S,b,N,L){if(b===void 0)L="utf8",N=this.length,b=0;else if(N===void 0&&typeof b=="string")L=b,N=this.length,b=0;else if(isFinite(b))b=b>>>0,isFinite(N)?(N=N>>>0,L===void 0&&(L="utf8")):(L=N,N=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const W=this.length-b;if((N===void 0||N>W)&&(N=W),S.length>0&&(N<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");L||(L="utf8");let Q=!1;for(;;)switch(L){case"hex":return R(this,S,b,N);case"utf8":case"utf-8":return A(this,S,b,N);case"ascii":case"latin1":case"binary":return M(this,S,b,N);case"base64":return O(this,S,b,N);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,S,b,N);default:if(Q)throw new TypeError("Unknown encoding: "+L);L=(""+L).toLowerCase(),Q=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function j(I,S,b){return S===0&&b===I.length?e.fromByteArray(I):e.fromByteArray(I.slice(S,b))}function V(I,S,b){b=Math.min(I.length,b);const N=[];let L=S;for(;L<b;){const W=I[L];let Q=null,Ne=W>239?4:W>223?3:W>191?2:1;if(L+Ne<=b){let rt,it,ut,Xe;switch(Ne){case 1:W<128&&(Q=W);break;case 2:rt=I[L+1],(rt&192)===128&&(Xe=(W&31)<<6|rt&63,Xe>127&&(Q=Xe));break;case 3:rt=I[L+1],it=I[L+2],(rt&192)===128&&(it&192)===128&&(Xe=(W&15)<<12|(rt&63)<<6|it&63,Xe>2047&&(Xe<55296||Xe>57343)&&(Q=Xe));break;case 4:rt=I[L+1],it=I[L+2],ut=I[L+3],(rt&192)===128&&(it&192)===128&&(ut&192)===128&&(Xe=(W&15)<<18|(rt&63)<<12|(it&63)<<6|ut&63,Xe>65535&&Xe<1114112&&(Q=Xe))}}Q===null?(Q=65533,Ne=1):Q>65535&&(Q-=65536,N.push(Q>>>10&1023|55296),Q=56320|Q&1023),N.push(Q),L+=Ne}return G(N)}const J=4096;function G(I){const S=I.length;if(S<=J)return String.fromCharCode.apply(String,I);let b="",N=0;for(;N<S;)b+=String.fromCharCode.apply(String,I.slice(N,N+=J));return b}function te(I,S,b){let N="";b=Math.min(I.length,b);for(let L=S;L<b;++L)N+=String.fromCharCode(I[L]&127);return N}function z(I,S,b){let N="";b=Math.min(I.length,b);for(let L=S;L<b;++L)N+=String.fromCharCode(I[L]);return N}function Z(I,S,b){const N=I.length;(!S||S<0)&&(S=0),(!b||b<0||b>N)&&(b=N);let L="";for(let W=S;W<b;++W)L+=Oe[I[W]];return L}function ie(I,S,b){const N=I.slice(S,b);let L="";for(let W=0;W<N.length-1;W+=2)L+=String.fromCharCode(N[W]+N[W+1]*256);return L}a.prototype.slice=function(S,b){const N=this.length;S=~~S,b=b===void 0?N:~~b,S<0?(S+=N,S<0&&(S=0)):S>N&&(S=N),b<0?(b+=N,b<0&&(b=0)):b>N&&(b=N),b<S&&(b=S);const L=this.subarray(S,b);return Object.setPrototypeOf(L,a.prototype),L};function q(I,S,b){if(I%1!==0||I<0)throw new RangeError("offset is not uint");if(I+S>b)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(S,b,N){S=S>>>0,b=b>>>0,N||q(S,b,this.length);let L=this[S],W=1,Q=0;for(;++Q<b&&(W*=256);)L+=this[S+Q]*W;return L},a.prototype.readUintBE=a.prototype.readUIntBE=function(S,b,N){S=S>>>0,b=b>>>0,N||q(S,b,this.length);let L=this[S+--b],W=1;for(;b>0&&(W*=256);)L+=this[S+--b]*W;return L},a.prototype.readUint8=a.prototype.readUInt8=function(S,b){return S=S>>>0,b||q(S,1,this.length),this[S]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(S,b){return S=S>>>0,b||q(S,2,this.length),this[S]|this[S+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(S,b){return S=S>>>0,b||q(S,2,this.length),this[S]<<8|this[S+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(S,b){return S=S>>>0,b||q(S,4,this.length),(this[S]|this[S+1]<<8|this[S+2]<<16)+this[S+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(S,b){return S=S>>>0,b||q(S,4,this.length),this[S]*16777216+(this[S+1]<<16|this[S+2]<<8|this[S+3])},a.prototype.readBigUInt64LE=Ht(function(S){S=S>>>0,Zt(S,"offset");const b=this[S],N=this[S+7];(b===void 0||N===void 0)&&bn(S,this.length-8);const L=b+this[++S]*2**8+this[++S]*2**16+this[++S]*2**24,W=this[++S]+this[++S]*2**8+this[++S]*2**16+N*2**24;return BigInt(L)+(BigInt(W)<<BigInt(32))}),a.prototype.readBigUInt64BE=Ht(function(S){S=S>>>0,Zt(S,"offset");const b=this[S],N=this[S+7];(b===void 0||N===void 0)&&bn(S,this.length-8);const L=b*2**24+this[++S]*2**16+this[++S]*2**8+this[++S],W=this[++S]*2**24+this[++S]*2**16+this[++S]*2**8+N;return(BigInt(L)<<BigInt(32))+BigInt(W)}),a.prototype.readIntLE=function(S,b,N){S=S>>>0,b=b>>>0,N||q(S,b,this.length);let L=this[S],W=1,Q=0;for(;++Q<b&&(W*=256);)L+=this[S+Q]*W;return W*=128,L>=W&&(L-=Math.pow(2,8*b)),L},a.prototype.readIntBE=function(S,b,N){S=S>>>0,b=b>>>0,N||q(S,b,this.length);let L=b,W=1,Q=this[S+--L];for(;L>0&&(W*=256);)Q+=this[S+--L]*W;return W*=128,Q>=W&&(Q-=Math.pow(2,8*b)),Q},a.prototype.readInt8=function(S,b){return S=S>>>0,b||q(S,1,this.length),this[S]&128?(255-this[S]+1)*-1:this[S]},a.prototype.readInt16LE=function(S,b){S=S>>>0,b||q(S,2,this.length);const N=this[S]|this[S+1]<<8;return N&32768?N|4294901760:N},a.prototype.readInt16BE=function(S,b){S=S>>>0,b||q(S,2,this.length);const N=this[S+1]|this[S]<<8;return N&32768?N|4294901760:N},a.prototype.readInt32LE=function(S,b){return S=S>>>0,b||q(S,4,this.length),this[S]|this[S+1]<<8|this[S+2]<<16|this[S+3]<<24},a.prototype.readInt32BE=function(S,b){return S=S>>>0,b||q(S,4,this.length),this[S]<<24|this[S+1]<<16|this[S+2]<<8|this[S+3]},a.prototype.readBigInt64LE=Ht(function(S){S=S>>>0,Zt(S,"offset");const b=this[S],N=this[S+7];(b===void 0||N===void 0)&&bn(S,this.length-8);const L=this[S+4]+this[S+5]*2**8+this[S+6]*2**16+(N<<24);return(BigInt(L)<<BigInt(32))+BigInt(b+this[++S]*2**8+this[++S]*2**16+this[++S]*2**24)}),a.prototype.readBigInt64BE=Ht(function(S){S=S>>>0,Zt(S,"offset");const b=this[S],N=this[S+7];(b===void 0||N===void 0)&&bn(S,this.length-8);const L=(b<<24)+this[++S]*2**16+this[++S]*2**8+this[++S];return(BigInt(L)<<BigInt(32))+BigInt(this[++S]*2**24+this[++S]*2**16+this[++S]*2**8+N)}),a.prototype.readFloatLE=function(S,b){return S=S>>>0,b||q(S,4,this.length),n.read(this,S,!0,23,4)},a.prototype.readFloatBE=function(S,b){return S=S>>>0,b||q(S,4,this.length),n.read(this,S,!1,23,4)},a.prototype.readDoubleLE=function(S,b){return S=S>>>0,b||q(S,8,this.length),n.read(this,S,!0,52,8)},a.prototype.readDoubleBE=function(S,b){return S=S>>>0,b||q(S,8,this.length),n.read(this,S,!1,52,8)};function se(I,S,b,N,L,W){if(!a.isBuffer(I))throw new TypeError('"buffer" argument must be a Buffer instance');if(S>L||S<W)throw new RangeError('"value" argument is out of bounds');if(b+N>I.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(S,b,N,L){if(S=+S,b=b>>>0,N=N>>>0,!L){const Ne=Math.pow(2,8*N)-1;se(this,S,b,N,Ne,0)}let W=1,Q=0;for(this[b]=S&255;++Q<N&&(W*=256);)this[b+Q]=S/W&255;return b+N},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(S,b,N,L){if(S=+S,b=b>>>0,N=N>>>0,!L){const Ne=Math.pow(2,8*N)-1;se(this,S,b,N,Ne,0)}let W=N-1,Q=1;for(this[b+W]=S&255;--W>=0&&(Q*=256);)this[b+W]=S/Q&255;return b+N},a.prototype.writeUint8=a.prototype.writeUInt8=function(S,b,N){return S=+S,b=b>>>0,N||se(this,S,b,1,255,0),this[b]=S&255,b+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(S,b,N){return S=+S,b=b>>>0,N||se(this,S,b,2,65535,0),this[b]=S&255,this[b+1]=S>>>8,b+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(S,b,N){return S=+S,b=b>>>0,N||se(this,S,b,2,65535,0),this[b]=S>>>8,this[b+1]=S&255,b+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(S,b,N){return S=+S,b=b>>>0,N||se(this,S,b,4,4294967295,0),this[b+3]=S>>>24,this[b+2]=S>>>16,this[b+1]=S>>>8,this[b]=S&255,b+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(S,b,N){return S=+S,b=b>>>0,N||se(this,S,b,4,4294967295,0),this[b]=S>>>24,this[b+1]=S>>>16,this[b+2]=S>>>8,this[b+3]=S&255,b+4};function ke(I,S,b,N,L){Sn(S,N,L,I,b,7);let W=Number(S&BigInt(4294967295));I[b++]=W,W=W>>8,I[b++]=W,W=W>>8,I[b++]=W,W=W>>8,I[b++]=W;let Q=Number(S>>BigInt(32)&BigInt(4294967295));return I[b++]=Q,Q=Q>>8,I[b++]=Q,Q=Q>>8,I[b++]=Q,Q=Q>>8,I[b++]=Q,b}function Ee(I,S,b,N,L){Sn(S,N,L,I,b,7);let W=Number(S&BigInt(4294967295));I[b+7]=W,W=W>>8,I[b+6]=W,W=W>>8,I[b+5]=W,W=W>>8,I[b+4]=W;let Q=Number(S>>BigInt(32)&BigInt(4294967295));return I[b+3]=Q,Q=Q>>8,I[b+2]=Q,Q=Q>>8,I[b+1]=Q,Q=Q>>8,I[b]=Q,b+8}a.prototype.writeBigUInt64LE=Ht(function(S,b=0){return ke(this,S,b,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Ht(function(S,b=0){return Ee(this,S,b,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(S,b,N,L){if(S=+S,b=b>>>0,!L){const rt=Math.pow(2,8*N-1);se(this,S,b,N,rt-1,-rt)}let W=0,Q=1,Ne=0;for(this[b]=S&255;++W<N&&(Q*=256);)S<0&&Ne===0&&this[b+W-1]!==0&&(Ne=1),this[b+W]=(S/Q>>0)-Ne&255;return b+N},a.prototype.writeIntBE=function(S,b,N,L){if(S=+S,b=b>>>0,!L){const rt=Math.pow(2,8*N-1);se(this,S,b,N,rt-1,-rt)}let W=N-1,Q=1,Ne=0;for(this[b+W]=S&255;--W>=0&&(Q*=256);)S<0&&Ne===0&&this[b+W+1]!==0&&(Ne=1),this[b+W]=(S/Q>>0)-Ne&255;return b+N},a.prototype.writeInt8=function(S,b,N){return S=+S,b=b>>>0,N||se(this,S,b,1,127,-128),S<0&&(S=255+S+1),this[b]=S&255,b+1},a.prototype.writeInt16LE=function(S,b,N){return S=+S,b=b>>>0,N||se(this,S,b,2,32767,-32768),this[b]=S&255,this[b+1]=S>>>8,b+2},a.prototype.writeInt16BE=function(S,b,N){return S=+S,b=b>>>0,N||se(this,S,b,2,32767,-32768),this[b]=S>>>8,this[b+1]=S&255,b+2},a.prototype.writeInt32LE=function(S,b,N){return S=+S,b=b>>>0,N||se(this,S,b,4,2147483647,-2147483648),this[b]=S&255,this[b+1]=S>>>8,this[b+2]=S>>>16,this[b+3]=S>>>24,b+4},a.prototype.writeInt32BE=function(S,b,N){return S=+S,b=b>>>0,N||se(this,S,b,4,2147483647,-2147483648),S<0&&(S=4294967295+S+1),this[b]=S>>>24,this[b+1]=S>>>16,this[b+2]=S>>>8,this[b+3]=S&255,b+4},a.prototype.writeBigInt64LE=Ht(function(S,b=0){return ke(this,S,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Ht(function(S,b=0){return Ee(this,S,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function me(I,S,b,N,L,W){if(b+N>I.length)throw new RangeError("Index out of range");if(b<0)throw new RangeError("Index out of range")}function Te(I,S,b,N,L){return S=+S,b=b>>>0,L||me(I,S,b,4),n.write(I,S,b,N,23,4),b+4}a.prototype.writeFloatLE=function(S,b,N){return Te(this,S,b,!0,N)},a.prototype.writeFloatBE=function(S,b,N){return Te(this,S,b,!1,N)};function Ue(I,S,b,N,L){return S=+S,b=b>>>0,L||me(I,S,b,8),n.write(I,S,b,N,52,8),b+8}a.prototype.writeDoubleLE=function(S,b,N){return Ue(this,S,b,!0,N)},a.prototype.writeDoubleBE=function(S,b,N){return Ue(this,S,b,!1,N)},a.prototype.copy=function(S,b,N,L){if(!a.isBuffer(S))throw new TypeError("argument should be a Buffer");if(N||(N=0),!L&&L!==0&&(L=this.length),b>=S.length&&(b=S.length),b||(b=0),L>0&&L<N&&(L=N),L===N||S.length===0||this.length===0)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if(N<0||N>=this.length)throw new RangeError("Index out of range");if(L<0)throw new RangeError("sourceEnd out of bounds");L>this.length&&(L=this.length),S.length-b<L-N&&(L=S.length-b+N);const W=L-N;return this===S&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(b,N,L):Uint8Array.prototype.set.call(S,this.subarray(N,L),b),W},a.prototype.fill=function(S,b,N,L){if(typeof S=="string"){if(typeof b=="string"?(L=b,b=0,N=this.length):typeof N=="string"&&(L=N,N=this.length),L!==void 0&&typeof L!="string")throw new TypeError("encoding must be a string");if(typeof L=="string"&&!a.isEncoding(L))throw new TypeError("Unknown encoding: "+L);if(S.length===1){const Q=S.charCodeAt(0);(L==="utf8"&&Q<128||L==="latin1")&&(S=Q)}}else typeof S=="number"?S=S&255:typeof S=="boolean"&&(S=Number(S));if(b<0||this.length<b||this.length<N)throw new RangeError("Out of range index");if(N<=b)return this;b=b>>>0,N=N===void 0?this.length:N>>>0,S||(S=0);let W;if(typeof S=="number")for(W=b;W<N;++W)this[W]=S;else{const Q=a.isBuffer(S)?S:a.from(S,L),Ne=Q.length;if(Ne===0)throw new TypeError('The value "'+S+'" is invalid for argument "value"');for(W=0;W<N-b;++W)this[W+b]=Q[W%Ne]}return this};const ce={};function xt(I,S,b){ce[I]=class extends b{constructor(){super(),Object.defineProperty(this,"message",{value:S.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${I}]`,this.stack,delete this.name}get code(){return I}set code(L){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:L,writable:!0})}toString(){return`${this.name} [${I}]: ${this.message}`}}}xt("ERR_BUFFER_OUT_OF_BOUNDS",function(I){return I?`${I} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),xt("ERR_INVALID_ARG_TYPE",function(I,S){return`The "${I}" argument must be of type number. Received type ${typeof S}`},TypeError),xt("ERR_OUT_OF_RANGE",function(I,S,b){let N=`The value of "${I}" is out of range.`,L=b;return Number.isInteger(b)&&Math.abs(b)>2**32?L=cn(String(b)):typeof b=="bigint"&&(L=String(b),(b>BigInt(2)**BigInt(32)||b<-(BigInt(2)**BigInt(32)))&&(L=cn(L)),L+="n"),N+=` It must be ${S}. Received ${L}`,N},RangeError);function cn(I){let S="",b=I.length;const N=I[0]==="-"?1:0;for(;b>=N+4;b-=3)S=`_${I.slice(b-3,b)}${S}`;return`${I.slice(0,b)}${S}`}function Et(I,S,b){Zt(S,"offset"),(I[S]===void 0||I[S+b]===void 0)&&bn(S,I.length-(b+1))}function Sn(I,S,b,N,L,W){if(I>b||I<S){const Q=typeof S=="bigint"?"n":"";let Ne;throw W>3?S===0||S===BigInt(0)?Ne=`>= 0${Q} and < 2${Q} ** ${(W+1)*8}${Q}`:Ne=`>= -(2${Q} ** ${(W+1)*8-1}${Q}) and < 2 ** ${(W+1)*8-1}${Q}`:Ne=`>= ${S}${Q} and <= ${b}${Q}`,new ce.ERR_OUT_OF_RANGE("value",Ne,I)}Et(N,L,W)}function Zt(I,S){if(typeof I!="number")throw new ce.ERR_INVALID_ARG_TYPE(S,"number",I)}function bn(I,S,b){throw Math.floor(I)!==I?(Zt(I,b),new ce.ERR_OUT_OF_RANGE(b||"offset","an integer",I)):S<0?new ce.ERR_BUFFER_OUT_OF_BOUNDS:new ce.ERR_OUT_OF_RANGE(b||"offset",`>= ${b?1:0} and <= ${S}`,I)}const le=/[^+/0-9A-Za-z-_]/g;function Se(I){if(I=I.split("=")[0],I=I.trim().replace(le,""),I.length<2)return"";for(;I.length%4!==0;)I=I+"=";return I}function Ye(I,S){S=S||1/0;let b;const N=I.length;let L=null;const W=[];for(let Q=0;Q<N;++Q){if(b=I.charCodeAt(Q),b>55295&&b<57344){if(!L){if(b>56319){(S-=3)>-1&&W.push(239,191,189);continue}else if(Q+1===N){(S-=3)>-1&&W.push(239,191,189);continue}L=b;continue}if(b<56320){(S-=3)>-1&&W.push(239,191,189),L=b;continue}b=(L-55296<<10|b-56320)+65536}else L&&(S-=3)>-1&&W.push(239,191,189);if(L=null,b<128){if((S-=1)<0)break;W.push(b)}else if(b<2048){if((S-=2)<0)break;W.push(b>>6|192,b&63|128)}else if(b<65536){if((S-=3)<0)break;W.push(b>>12|224,b>>6&63|128,b&63|128)}else if(b<1114112){if((S-=4)<0)break;W.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw new Error("Invalid code point")}return W}function Je(I){const S=[];for(let b=0;b<I.length;++b)S.push(I.charCodeAt(b)&255);return S}function ue(I,S){let b,N,L;const W=[];for(let Q=0;Q<I.length&&!((S-=2)<0);++Q)b=I.charCodeAt(Q),N=b>>8,L=b%256,W.push(L),W.push(N);return W}function Le(I){return e.toByteArray(Se(I))}function Re(I,S,b,N){let L;for(L=0;L<N&&!(L+b>=S.length||L>=I.length);++L)S[L+b]=I[L];return L}function je(I,S){return I instanceof S||I!=null&&I.constructor!=null&&I.constructor.name!=null&&I.constructor.name===S.name}function Ut(I){return I!==I}const Oe=function(){const I="0123456789abcdef",S=new Array(256);for(let b=0;b<16;++b){const N=b*16;for(let L=0;L<16;++L)S[N+L]=I[b]+I[L]}return S}();function Ht(I){return typeof BigInt>"u"?mc:I}function mc(){throw new Error("BigInt not supported")}})(kn);var Du=(t=>(t[t.BINARY=0]="BINARY",t[t.ECHO=1]="ECHO",t[t.RCP=2]="RCP",t[t.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",t[t.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",t[t.STATUS=5]="STATUS",t[t.TIMING_MARK=6]="TIMING_MARK",t[t.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",t[t.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",t[t.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",t[t.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",t[t.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",t[t.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",t[t.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",t[t.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",t[t.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",t[t.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",t[t.EXTENDED_ASCII=17]="EXTENDED_ASCII",t[t.LOGOUT=18]="LOGOUT",t[t.BYTE_MACRO=19]="BYTE_MACRO",t[t.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",t[t.SUPDUP=21]="SUPDUP",t[t.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",t[t.SEND_LOCATION=23]="SEND_LOCATION",t[t.TERMINAL_TYPE=24]="TERMINAL_TYPE",t[t.END_OF_RECORD=25]="END_OF_RECORD",t[t.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",t[t.OUTPUT_MARKING=27]="OUTPUT_MARKING",t[t.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",t[t.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",t[t.X_3_PAD=30]="X_3_PAD",t[t.NAWS=31]="NAWS",t[t.TERMINAL_SPEED=32]="TERMINAL_SPEED",t[t.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",t[t.LINEMODE=34]="LINEMODE",t[t.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",t[t.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",t[t.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",t[t.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",t[t.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",t[t.TN3270E=40]="TN3270E",t[t.XAUTH=41]="XAUTH",t[t.CHARSET=42]="CHARSET",t[t.RSP=43]="RSP",t[t.COM_PORT_OPTION=44]="COM_PORT_OPTION",t[t.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",t[t.START_TLS=46]="START_TLS",t[t.KERMIT=47]="KERMIT",t[t.SEND_URL=48]="SEND_URL",t[t.FORWARD_X=49]="FORWARD_X",t[t.PRAGMA_LOGON=138]="PRAGMA_LOGON",t[t.GMCP=201]="GMCP",t))(Du||{}),Lu=(t=>(t[t.SE=240]="SE",t[t.NOP=241]="NOP",t[t.DM=242]="DM",t[t.BRK=243]="BRK",t[t.IP=244]="IP",t[t.AO=245]="AO",t[t.AYT=246]="AYT",t[t.EC=247]="EC",t[t.EL=248]="EL",t[t.GA=249]="GA",t[t.SB=250]="SB",t[t.WILL=251]="WILL",t[t.WONT=252]="WONT",t[t.DO=253]="DO",t[t.DONT=254]="DONT",t[t.IAC=255]="IAC",t))(Lu||{});class QF{constructor(e){H(this,"ws");this.ws=e}on(e,n){if(e==="data"){this.ws.onmessage=i=>{n(i.data)};return}const r="on"+e;this[r]=n}write(e){this.ws.send(e)}}class e2 extends _I{constructor(n){super();H(this,"state");H(this,"buffer");H(this,"subBuffer");H(this,"iacSEBuffer",kn.Buffer.from([255,240]));H(this,"negotiationByte",0);H(this,"stream");this.state=0,this.buffer=kn.Buffer.alloc(0),this.subBuffer=kn.Buffer.alloc(0),n&&n.on("data",r=>this.parse(r)),this.stream=n}parse(n){for(this.buffer=kn.Buffer.concat([this.buffer,kn.Buffer.from(n)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const n=this.buffer.indexOf(255);if(n===-1){this.emit("data",this.buffer),this.buffer=kn.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,n)),this.buffer=this.buffer.slice(n),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const n=this.buffer[1];switch(this.buffer=this.buffer.slice(2),n){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=kn.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=n,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const n=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",n,r),this.state=0,!1}handleSubnegotiation(){let n=this.buffer.indexOf(this.iacSEBuffer);if(n===-1)return!0;this.state=0;let r=this.buffer.slice(0,n);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(n+2),!1}handleGmcp(n){const r=n.toString(),[i,s]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,s)}sendNegotiation(n,r){this.stream.write(kn.Buffer.from([255,n,r]))}sendGmcp(n,r){const i=n+" "+r,s=kn.Buffer.from(i),o=kn.Buffer.concat([kn.Buffer.from([255,250]),kn.Buffer.from([201]),s,this.iacSEBuffer]);this.stream.write(o)}sendTerminalType(n){const r=kn.Buffer.from(n),i=kn.Buffer.concat([kn.Buffer.from([255,250]),kn.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}class po{constructor(e){H(this,"packageName");H(this,"packageVersion",1);H(this,"client");this.client=e}sendData(e,n){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(n))}shutdown(){}}class t2 extends po{constructor(){super(...arguments);H(this,"packageName","Auth.Autologin")}handleToken(n){localStorage.setItem("LoginRefreshToken",n)}sendLogin(){var n=localStorage.getItem("LoginRefreshToken");n&&this.sendData("Login",n)}}class n2 extends po{constructor(){super(...arguments);H(this,"packageName","Char")}handleName(n){this.client.worldData.playerId=n.name,this.client.worldData.playerName=n.fullname,this.client.emit("statustext",`Logged in as ${n.fullname}`)}sendLogin(n,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:n,password:r}))}}class r2 extends po{constructor(n){super(n);H(this,"packageName","Client.Keystrokes");H(this,"bindings",[]);document.addEventListener("keyup",this.handleKeyup.bind(this))}handleKeyup(n){const r=this.findBinding(n);if(r){const i=this.client.getInput(),s=this.parseCommand(r.command,i);r.autosend?this.sendCommand(s):this.placeInInputField(s)}}findBinding(n){return this.bindings.find(r=>r.key===n.key&&r.modifiers.every(i=>n[`${i}Key`]))}parseCommand(n,r){const i=r.trim().split(/\s+/);return n.replace(/%(\d+|\*)/g,(s,o)=>{if(o==="*")return r;const a=parseInt(o,10)-1;return a>=0&&a<i.length?i[a]:s})}sendCommand(n){this.sendData("ExecuteCommand",{command:n})}placeInInputField(n){this.client.setInput(n)}bindKey(n){const r={key:n.key,modifiers:n.modifiers,command:n.command,autosend:n.autosend};this.bindings.push(r)}unbindKey(n){this.bindings=this.bindings.filter(r=>r.key!==n.key||!r.modifiers.every(i=>n.modifiers.includes(i)))}unbindAll(){this.bindings=[]}bindAll(n){this.bindings=n.bindings}listBindings(){return this.bindings}}const rE=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),iE=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),by=(t,e)=>({startTime:e,type:"setValue",value:t}),RI=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),PI=(t,e,{startTime:n,target:r,timeConstant:i})=>r+(e-r)*Math.exp((n-t)/i),Vc=t=>t.type==="exponentialRampToValue",dp=t=>t.type==="linearRampToValue",Po=t=>Vc(t)||dp(t),XS=t=>t.type==="setValue",bs=t=>t.type==="setValueCurve",fp=(t,e,n,r)=>{const i=t[e];return i===void 0?r:Po(i)||XS(i)?i.value:bs(i)?i.values[i.values.length-1]:PI(n,fp(t,e-1,i.startTime,r),i)},sE=(t,e,n,r,i)=>n===void 0?[r.insertTime,i]:Po(n)?[n.endTime,n.value]:XS(n)?[n.startTime,n.value]:bs(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,fp(t,e-1,n.startTime,i)],wy=t=>t.type==="cancelAndHold",ky=t=>t.type==="cancelScheduledValues",wo=t=>wy(t)||ky(t)?t.cancelTime:Vc(t)||dp(t)?t.endTime:t.startTime,oE=(t,e,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((t-e)/(r-e)):0,aE=(t,e,n,{endTime:r,value:i})=>n+(t-e)/(r-e)*(i-n),i2=(t,e)=>{const n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},s2=(t,{duration:e,startTime:n,values:r})=>{const i=(t-n)/e*(r.length-1);return i2(r,i)},zf=t=>t.type==="setTarget";class o2{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=wo(e);if(wy(e)||ky(e)){const r=this._automationEvents.findIndex(s=>ky(e)&&bs(s)?s.startTime+s.duration>=n:wo(s)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),wy(e)){const s=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&Po(i)){if(s!==void 0&&zf(s))throw new Error("The internal list is malformed.");const o=s===void 0?i.insertTime:bs(s)?s.startTime+s.duration:wo(s),a=s===void 0?this._defaultValue:bs(s)?s.values[s.values.length-1]:s.value,c=Vc(i)?oE(n,o,a,i):aE(n,o,a,i),l=Vc(i)?rE(c,n,this._currenTime):iE(c,n,this._currenTime);this._automationEvents.push(l)}if(s!==void 0&&zf(s)&&this._automationEvents.push(by(this.getValue(n),n)),s!==void 0&&bs(s)&&s.startTime+s.duration>n){const o=n-s.startTime,a=(s.values.length-1)/s.duration,c=Math.max(2,1+Math.ceil(o*a)),l=o/(c-1)*a,u=s.values.slice(0,c);if(l<1)for(let d=1;d<c;d+=1){const f=l*d%1;u[d]=s.values[d-1]*(1-f)+s.values[d]*f}this._automationEvents[this._automationEvents.length-1]=RI(u,s.startTime,o)}}}else{const r=this._automationEvents.findIndex(o=>wo(o)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&bs(i)&&wo(i)+i.duration>n)return!1;const s=Vc(e)?rE(e.value,e.endTime,this._currenTime):dp(e)?iE(e.value,n,this._currenTime):e;if(r===-1)this._automationEvents.push(s);else{if(bs(e)&&n+e.duration>wo(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(e){const n=this._automationEvents.findIndex(r=>wo(r)>e);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];zf(i)&&r.unshift(by(fp(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(o=>wo(o)>e),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,s=this._automationEvents[i];if(s!==void 0&&zf(s)&&(r===void 0||!Po(r)||r.insertTime>e))return PI(e,fp(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(s!==void 0&&XS(s)&&(r===void 0||!Po(r)))return s.value;if(s!==void 0&&bs(s)&&(r===void 0||!Po(r)||s.startTime+s.duration>e))return e<s.startTime+s.duration?s2(e,s):s.values[s.values.length-1];if(s!==void 0&&Po(s)&&(r===void 0||!Po(r)))return s.value;if(r!==void 0&&Vc(r)){const[o,a]=sE(this._automationEvents,i,s,r,this._defaultValue);return oE(e,o,a,r)}if(r!==void 0&&dp(r)){const[o,a]=sE(this._automationEvents,i,s,r,this._defaultValue);return aE(e,o,a,r)}return this._defaultValue}}const a2=t=>({cancelTime:t,type:"cancelAndHold"}),c2=t=>({cancelTime:t,type:"cancelScheduledValues"}),l2=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),u2=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),d2=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),f2=()=>new DOMException("","AbortError"),h2=t=>(e,n,[r,i,s],o)=>{t(e[i],[n,r,s],a=>a[0]===n&&a[1]===r,o)},p2=t=>(e,n,r)=>{const i=[];for(let s=0;s<r.numberOfInputs;s+=1)i.push(new Set);t.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},m2=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Rl=new WeakSet,AI=new WeakMap,NI=new WeakMap,MI=new WeakMap,xI=new WeakMap,OI=new WeakMap,DI=new WeakMap,Ey=new WeakMap,Cy=new WeakMap,Ty=new WeakMap,LI={construct(){return LI}},g2=t=>{try{const e=new Proxy(t,LI);new e}catch{return!1}return!0},cE=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,lE=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),i=r.match(cE);for(;i!==null;){const s=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());n.push(o),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(cE)}return[n.join(";"),r]},uE=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},dE=t=>{if(!g2(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},v2=(t,e,n,r,i,s,o,a,c,l,u,d,f)=>{let h=0;return(p,g,y={credentials:"omit"})=>{const m=u.get(p);if(m!==void 0&&m.has(g))return Promise.resolve();const v=l.get(p);if(v!==void 0){const C=v.get(g);if(C!==void 0)return C}const w=s(p),_=w.audioWorklet===void 0?i(g).then(([C,k])=>{const[T,R]=lE(C,k),A=`${T};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${R}
})})(window,'_AWGS')`;return n(A)}).then(()=>{const C=f._AWGS.pop();if(C===void 0)throw new SyntaxError;r(w.currentTime,w.sampleRate,()=>C(class{},void 0,(k,T)=>{if(k.trim()==="")throw e();const R=Cy.get(w);if(R!==void 0){if(R.has(k))throw e();dE(T),uE(T.parameterDescriptors),R.set(k,T)}else dE(T),uE(T.parameterDescriptors),Cy.set(w,new Map([[k,T]]))},w.sampleRate,void 0,void 0))}):Promise.all([i(g),Promise.resolve(t(d,d))]).then(([[C,k],T])=>{const R=h+1;h=R;const[A,M]=lE(C,k),V=`${A};((AudioWorkletProcessor,registerProcessor)=>{${M}
})(${T?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${T?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${T?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${R}',class extends AudioWorkletProcessor{process(){return !1}})`,J=new Blob([V],{type:"application/javascript; charset=utf-8"}),G=URL.createObjectURL(J);return w.audioWorklet.addModule(G,y).then(()=>{if(a(w))return w;const te=o(w);return te.audioWorklet.addModule(G,y).then(()=>te)}).then(te=>{if(c===null)throw new SyntaxError;try{new c(te,`__sac${R}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(G))});return v===void 0?l.set(p,new Map([[g,_]])):v.set(g,_),_.then(()=>{const C=u.get(p);C===void 0?u.set(p,new Set([g])):C.add(g)}).finally(()=>{const C=l.get(p);C!==void 0&&C.delete(g)}),_}},Ti=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},mm=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return t.delete(r),r},FI=(t,e,n,r)=>{const i=Ti(t,e),s=mm(i,o=>o[0]===n&&o[1]===r);return i.size===0&&t.delete(e),s},of=t=>Ti(DI,t),Pl=t=>{if(Rl.has(t))throw new Error("The AudioNode is already stored.");Rl.add(t),of(t).forEach(e=>e(!0))},BI=t=>"port"in t,af=t=>{if(!Rl.has(t))throw new Error("The AudioNode is not stored.");Rl.delete(t),of(t).forEach(e=>e(!1))},_y=(t,e)=>{!BI(t)&&e.every(n=>n.size===0)&&af(t)},y2=(t,e,n,r,i,s,o,a,c,l,u,d,f)=>{const h=new WeakMap;return(p,g,y,m,v)=>{const{activeInputs:w,passiveInputs:_}=s(g),{outputs:C}=s(p),k=a(p),T=R=>{const A=c(g),M=c(p);if(R){const O=FI(_,p,y,m);t(w,p,O,!1),!v&&!d(p)&&n(M,A,y,m),f(g)&&Pl(g)}else{const O=r(w,p,y,m);e(_,m,O,!1),!v&&!d(p)&&i(M,A,y,m);const D=o(g);if(D===0)u(g)&&_y(g,w);else{const j=h.get(g);j!==void 0&&clearTimeout(j),h.set(g,setTimeout(()=>{u(g)&&_y(g,w)},D*1e3))}}};return l(C,[g,y,m],R=>R[0]===g&&R[1]===y&&R[2]===m,!0)?(k.add(T),u(p)?t(w,p,[y,m,T],!0):e(_,m,[p,y,T],!0),!0):!1}},S2=t=>(e,n,[r,i,s],o)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[i,n,s]])):t(a,[i,n,s],c=>c[0]===i&&c[1]===n,o)},b2=t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},w2=t=>(e,n)=>{t(e).add(n)},k2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},E2=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=i(a),u={...k2,...c},d=r(l,u),f=s(l)?e():null;super(a,!1,d,f),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},Vn=(t,e)=>t.context===e,C2=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Vn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},Iy=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},hs=()=>new DOMException("","IndexSizeError"),UI=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(r){throw r.code===12?hs():r}})(t.getChannelData)},T2={numberOfChannels:1},_2=(t,e,n,r,i,s,o,a)=>{let c=null;return class jI{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:f,sampleRate:h}={...T2,...u};c===null&&(c=new i(1,1,44100));const p=r!==null&&e(s,s)?new r({length:d,numberOfChannels:f,sampleRate:h}):c.createBuffer(f,d,h);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(o(p),UI(p)):e(Iy,()=>Iy(p))||a(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===jI.prototype||t.has(u)}}},ar=-34028234663852886e22,Zn=-ar,eo=t=>Rl.has(t),I2={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},R2=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f={...I2,...u},h=i(d,f),p=o(d),g=p?e():null;super(l,!1,h,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=n(this,p,h.playbackRate,Zn,ar)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?l:d}get playbackRate(){return this._playbackRate}start(l=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(l,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[l,u]:[l,u,d]),this.context.state!=="closed"){Pl(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),eo(this)&&af(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},P2=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let d=n(l);const f=Vn(d,u);if(!f){const h={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(u,h),o!==null&&d.start(...o),a!==null&&d.stop(a)}return s.set(u,d),f?await t(u,l.playbackRate,d.playbackRate):await r(u,l.playbackRate,d.playbackRate),await i(l,u,d),d};return{set start(l){o=l},set stop(l){a=l},render(l,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},A2=t=>"playbackRate"in t,N2=t=>"frequency"in t&&"gain"in t,M2=t=>"offset"in t,x2=t=>!("frequency"in t)&&"gain"in t,O2=t=>"detune"in t&&"frequency"in t,D2=t=>"pan"in t,Qn=t=>Ti(AI,t),cf=t=>Ti(MI,t),Ry=(t,e)=>{const{activeInputs:n}=Qn(t);n.forEach(i=>i.forEach(([s])=>{e.includes(t)||Ry(s,[...e,t])}));const r=A2(t)?[t.playbackRate]:BI(t)?Array.from(t.parameters.values()):N2(t)?[t.Q,t.detune,t.frequency,t.gain]:M2(t)?[t.offset]:x2(t)?[t.gain]:O2(t)?[t.detune,t.frequency]:D2(t)?[t.pan]:[];for(const i of r){const s=cf(i);s!==void 0&&s.activeInputs.forEach(([o])=>Ry(o,e))}eo(t)&&af(t)},L2=t=>{Ry(t.destination,[])},F2=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),B2=(t,e,n,r,i,s,o,a,c)=>class extends t{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new c(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(d===null)throw r();if(!F2(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw n();super(d,2);const{latencyHint:f}=u,{sampleRate:h}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:f==="balanced"?512/h:f==="interactive"||f===void 0?256/h:f==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(f*h/128)))*128/h,this._nativeAudioContext=d,c.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",p)};d.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),L2(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(u){return new o(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},U2=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f=o(d),h=i(d,u,f),p=f?e(a):null;super(l,!1,h,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},j2=t=>{const e=new WeakMap,n=async(r,i)=>{const s=i.destination;return e.set(i,s),await t(r,i,s),s};return{render(r,i){const s=e.get(i);return s!==void 0?Promise.resolve(s):n(r,i)}}},W2=(t,e,n,r,i,s,o,a)=>(c,l)=>{const u=l.listener,d=()=>{const C=new Float32Array(1),k=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),T=o(l);let R=!1,A=[0,0,-1,0,1,0],M=[0,0,0];const O=()=>{if(R)return;R=!0;const J=r(l,256,9,0);J.onaudioprocess=({inputBuffer:G})=>{const te=[s(G,C,0),s(G,C,1),s(G,C,2),s(G,C,3),s(G,C,4),s(G,C,5)];te.some((Z,ie)=>Z!==A[ie])&&(u.setOrientation(...te),A=te);const z=[s(G,C,6),s(G,C,7),s(G,C,8)];z.some((Z,ie)=>Z!==M[ie])&&(u.setPosition(...z),M=z)},k.connect(J)},D=J=>G=>{G!==A[J]&&(A[J]=G,u.setOrientation(...A))},j=J=>G=>{G!==M[J]&&(M[J]=G,u.setPosition(...M))},V=(J,G,te)=>{const z=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:G});z.connect(k,0,J),z.start(),Object.defineProperty(z.offset,"defaultValue",{get(){return G}});const Z=t({context:c},T,z.offset,Zn,ar);return a(Z,"value",ie=>()=>ie.call(Z),ie=>q=>{try{ie.call(Z,q)}catch(se){if(se.code!==9)throw se}O(),T&&te(q)}),Z.cancelAndHoldAtTime=(ie=>T?()=>{throw i()}:(...q)=>{const se=ie.apply(Z,q);return O(),se})(Z.cancelAndHoldAtTime),Z.cancelScheduledValues=(ie=>T?()=>{throw i()}:(...q)=>{const se=ie.apply(Z,q);return O(),se})(Z.cancelScheduledValues),Z.exponentialRampToValueAtTime=(ie=>T?()=>{throw i()}:(...q)=>{const se=ie.apply(Z,q);return O(),se})(Z.exponentialRampToValueAtTime),Z.linearRampToValueAtTime=(ie=>T?()=>{throw i()}:(...q)=>{const se=ie.apply(Z,q);return O(),se})(Z.linearRampToValueAtTime),Z.setTargetAtTime=(ie=>T?()=>{throw i()}:(...q)=>{const se=ie.apply(Z,q);return O(),se})(Z.setTargetAtTime),Z.setValueAtTime=(ie=>T?()=>{throw i()}:(...q)=>{const se=ie.apply(Z,q);return O(),se})(Z.setValueAtTime),Z.setValueCurveAtTime=(ie=>T?()=>{throw i()}:(...q)=>{const se=ie.apply(Z,q);return O(),se})(Z.setValueCurveAtTime),Z};return{forwardX:V(0,0,D(0)),forwardY:V(1,0,D(1)),forwardZ:V(2,-1,D(2)),positionX:V(6,0,j(0)),positionY:V(7,0,j(1)),positionZ:V(8,0,j(2)),upX:V(3,0,D(3)),upY:V(4,1,D(4)),upZ:V(5,0,D(5))}},{forwardX:f,forwardY:h,forwardZ:p,positionX:g,positionY:y,positionZ:m,upX:v,upY:w,upZ:_}=u.forwardX===void 0?d():u;return{get forwardX(){return f},get forwardY(){return h},get forwardZ(){return p},get positionX(){return g},get positionY(){return y},get positionZ(){return m},get upX(){return v},get upY(){return w},get upZ(){return _}}},hp=t=>"context"in t,lf=t=>hp(t[0]),ac=(t,e,n,r)=>{for(const i of t)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},fE=(t,e,[n,r],i)=>{ac(t,[e,n,r],s=>s[0]===e&&s[1]===n,i)},hE=(t,[e,n,r],i)=>{const s=t.get(e);s===void 0?t.set(e,new Set([[n,r]])):ac(s,[n,r],o=>o[0]===n,i)},ql=t=>"inputs"in t,pp=(t,e,n,r)=>{if(ql(e)){const i=e.inputs[r];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,r),[e,n,r]},WI=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},V2=(t,e,n)=>mm(t,r=>r[0]===e&&r[1]===n),VI=(t,e)=>{if(!of(t).delete(e))throw new Error("Missing the expected event listener.")},zI=(t,e,n)=>{const r=Ti(t,e),i=mm(r,s=>s[0]===n);return r.size===0&&t.delete(e),i},mp=(t,e,n,r)=>{ql(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},kt=t=>Ti(NI,t),_d=t=>Ti(xI,t),Ja=t=>Ey.has(t),wh=t=>!Rl.has(t),pE=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const r=t.createScriptProcessor(256,1,1),i=t.createGain(),s=t.createBuffer(1,2,44100),o=s.getChannelData(0);o[0]=1,o[1]=1;const a=t.createBufferSource();a.buffer=s,a.loop=!0,a.connect(r).connect(t.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}}),Vg=(t,e)=>{const n=new Map;for(const r of t)for(const i of r){const s=n.get(i);n.set(i,s===void 0?1:s+1)}n.forEach((r,i)=>e(i,r))},gp=t=>"context"in t,z2=t=>{const e=new Map;t.connect=(n=>(r,i=0,s=0)=>{const o=gp(r)?n(r,i,s):n(r,i),a=e.get(r);return a===void 0?e.set(r,[{input:s,output:i}]):a.every(c=>c.input!==s||c.output!==i)&&a.push({input:s,output:i}),o})(t.connect.bind(t)),t.disconnect=(n=>(r,i,s)=>{if(n.apply(t),r===void 0)e.clear();else if(typeof r=="number")for(const[o,a]of e){const c=a.filter(l=>l.output!==r);c.length===0?e.delete(o):e.set(o,c)}else if(e.has(r))if(i===void 0)e.delete(r);else{const o=e.get(r);if(o!==void 0){const a=o.filter(c=>c.output!==i&&(c.input!==s||s===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[o,a]of e)a.forEach(c=>{gp(o)?t.connect(o,c.output,c.input):t.connect(o,c.output)})})(t.disconnect)},$2=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:s}=cf(e),{outputs:o}=Qn(t),a=of(t),c=l=>{const u=kt(t),d=_d(e);if(l){const f=zI(s,t,n);fE(i,t,f,!1),!r&&!Ja(t)&&u.connect(d,n)}else{const f=V2(i,t,n);hE(s,f,!1),!r&&!Ja(t)&&u.disconnect(d,n)}};return ac(o,[e,n],l=>l[0]===e&&l[1]===n,!0)?(a.add(c),eo(t)?fE(i,t,[n,c],!0):hE(s,[t,n,c],!0),!0):!1},H2=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:s}=Qn(e),o=WI(i[r],t,n);return o===null?[FI(s,t,n,r)[2],!1]:[o[2],!0]},G2=(t,e,n)=>{const{activeInputs:r,passiveInputs:i}=cf(e),s=WI(r,t,n);return s===null?[zI(i,t,n)[1],!1]:[s[2],!0]},QS=(t,e,n,r,i)=>{const[s,o]=H2(t,n,r,i);if(s!==null&&(VI(t,s),o&&!e&&!Ja(t)&&mp(kt(t),kt(n),r,i)),eo(n)){const{activeInputs:a}=Qn(n);_y(n,a)}},eb=(t,e,n,r)=>{const[i,s]=G2(t,n,r);i!==null&&(VI(t,i),s&&!e&&!Ja(t)&&kt(t).disconnect(_d(n),r))},q2=(t,e)=>{const n=Qn(t),r=[];for(const i of n.outputs)lf(i)?QS(t,e,...i):eb(t,e,...i),r.push(i[0]);return n.outputs.clear(),r},J2=(t,e,n)=>{const r=Qn(t),i=[];for(const s of r.outputs)s[1]===n&&(lf(s)?QS(t,e,...s):eb(t,e,...s),i.push(s[0]),r.outputs.delete(s));return i},Z2=(t,e,n,r,i)=>{const s=Qn(t);return Array.from(s.outputs).filter(o=>o[0]===n&&(r===void 0||o[1]===r)&&(i===void 0||o[2]===i)).map(o=>(lf(o)?QS(t,e,...o):eb(t,e,...o),s.outputs.delete(o),o[0]))},K2=(t,e,n,r,i,s,o,a,c,l,u,d,f,h,p,g)=>class extends l{constructor(m,v,w,_){super(w),this._context=m,this._nativeAudioNode=w;const C=u(m);d(C)&&n(pE,()=>pE(C,g))!==!0&&z2(w),NI.set(this,w),DI.set(this,new Set),m.state!=="closed"&&v&&Pl(this),t(this,_,w)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(m){this._nativeAudioNode.channelCount=m}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(m){this._nativeAudioNode.channelCountMode=m}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(m){this._nativeAudioNode.channelInterpretation=m}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(m,v=0,w=0){if(v<0||v>=this._nativeAudioNode.numberOfOutputs)throw i();const _=u(this._context),C=p(_);if(f(m)||h(m))throw s();if(hp(m)){const R=kt(m);try{const M=pp(this._nativeAudioNode,R,v,w),O=wh(this);(C||O)&&this._nativeAudioNode.disconnect(...M),this.context.state!=="closed"&&!O&&wh(m)&&Pl(m)}catch(M){throw M.code===12?s():M}if(e(this,m,v,w,C)){const M=c([this],m);Vg(M,r(C))}return m}const k=_d(m);if(k.name==="playbackRate"&&k.maxValue===1024)throw o();try{this._nativeAudioNode.connect(k,v),(C||wh(this))&&this._nativeAudioNode.disconnect(k,v)}catch(R){throw R.code===12?s():R}if($2(this,m,v,C)){const R=c([this],m);Vg(R,r(C))}}disconnect(m,v,w){let _;const C=u(this._context),k=p(C);if(m===void 0)_=q2(this,k);else if(typeof m=="number"){if(m<0||m>=this.numberOfOutputs)throw i();_=J2(this,k,m)}else{if(v!==void 0&&(v<0||v>=this.numberOfOutputs)||hp(m)&&w!==void 0&&(w<0||w>=m.numberOfInputs))throw i();if(_=Z2(this,k,m,v,w),_.length===0)throw s()}for(const T of _){const R=c([this],T);Vg(R,a)}}},Y2=(t,e,n,r,i,s,o,a,c,l,u,d,f)=>(h,p,g,y=null,m=null)=>{const v=g.value,w=new o2(v),_=p?r(w):null,C={get defaultValue(){return v},get maxValue(){return y===null?g.maxValue:y},get minValue(){return m===null?g.minValue:m},get value(){return g.value},set value(k){g.value=k,C.setValueAtTime(k,h.context.currentTime)},cancelAndHoldAtTime(k){if(typeof g.cancelAndHoldAtTime=="function")_===null&&w.flush(h.context.currentTime),w.add(i(k)),g.cancelAndHoldAtTime(k);else{const T=Array.from(w).pop();_===null&&w.flush(h.context.currentTime),w.add(i(k));const R=Array.from(w).pop();g.cancelScheduledValues(k),T!==R&&R!==void 0&&(R.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(R.value,R.endTime):R.type==="linearRampToValue"?g.linearRampToValueAtTime(R.value,R.endTime):R.type==="setValue"?g.setValueAtTime(R.value,R.startTime):R.type==="setValueCurve"&&g.setValueCurveAtTime(R.values,R.startTime,R.duration))}return C},cancelScheduledValues(k){return _===null&&w.flush(h.context.currentTime),w.add(s(k)),g.cancelScheduledValues(k),C},exponentialRampToValueAtTime(k,T){if(k===0)throw new RangeError;if(!Number.isFinite(T)||T<0)throw new RangeError;const R=h.context.currentTime;return _===null&&w.flush(R),Array.from(w).length===0&&(w.add(l(v,R)),g.setValueAtTime(v,R)),w.add(o(k,T)),g.exponentialRampToValueAtTime(k,T),C},linearRampToValueAtTime(k,T){const R=h.context.currentTime;return _===null&&w.flush(R),Array.from(w).length===0&&(w.add(l(v,R)),g.setValueAtTime(v,R)),w.add(a(k,T)),g.linearRampToValueAtTime(k,T),C},setTargetAtTime(k,T,R){return _===null&&w.flush(h.context.currentTime),w.add(c(k,T,R)),g.setTargetAtTime(k,T,R),C},setValueAtTime(k,T){return _===null&&w.flush(h.context.currentTime),w.add(l(k,T)),g.setValueAtTime(k,T),C},setValueCurveAtTime(k,T,R){const A=k instanceof Float32Array?k:new Float32Array(k);if(d!==null&&d.name==="webkitAudioContext"){const M=T+R,O=h.context.sampleRate,D=Math.ceil(T*O),j=Math.floor(M*O),V=j-D,J=new Float32Array(V);for(let te=0;te<V;te+=1){const z=(A.length-1)/R*((D+te)/O-T),Z=Math.floor(z),ie=Math.ceil(z);J[te]=Z===ie?A[Z]:(1-(z-Z))*A[Z]+(1-(ie-z))*A[ie]}_===null&&w.flush(h.context.currentTime),w.add(u(J,T,R)),g.setValueCurveAtTime(J,T,R);const G=j/O;G<M&&f(C,J[J.length-1],G),f(C,A[A.length-1],M)}else _===null&&w.flush(h.context.currentTime),w.add(u(A,T,R)),g.setValueCurveAtTime(A,T,R);return C}};return n.set(C,g),e.set(C,h),t(C,_),C},X2=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;e.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;e.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:s}=n;e.setTargetAtTime(i,r,s)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;e.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:s}=n;e.setValueCurveAtTime(s,i,r)}else throw new Error("Can't apply an unknown automation.")}});class $I{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((r,i)=>e.call(n,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const Q2={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},e5=(t,e,n,r,i,s,o,a,c,l,u,d,f,h)=>class extends e{constructor(g,y,m){var v;const w=a(g),_=c(w),C=u({...Q2,...m});f(C);const k=Cy.get(w),T=k==null?void 0:k.get(y),R=_||w.state!=="closed"?w:(v=o(w))!==null&&v!==void 0?v:w,A=i(R,_?null:g.baseLatency,l,y,T,C),M=_?r(y,C,T):null;super(g,!0,A,M);const O=[];A.parameters.forEach((j,V)=>{const J=n(this,_,j);O.push([V,J])}),this._nativeAudioWorkletNode=A,this._onprocessorerror=null,this._parameters=new $I(O),_&&t(w,this);const{activeInputs:D}=s(this);d(A,D)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const y=typeof g=="function"?h(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=y;const m=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=m!==null&&m===y?g:m}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function vp(t,e,n,r,i){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],r,i);else{const s=t.getChannelData(r);if(e[n].byteLength===0)e[n]=s.slice(i,i+128);else{const o=new Float32Array(s.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(o)}}}const HI=(t,e,n,r,i)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],r,i):e[n].byteLength!==0&&t.getChannelData(r).set(e[n],i)},yp=(t,e)=>{const n=[];for(let r=0;r<t;r+=1){const i=[],s=typeof e=="number"?e:e[r];for(let o=0;o<s;o+=1)i.push(new Float32Array(128));n.push(i)}return n},t5=(t,e)=>{const n=Ti(Ty,t),r=kt(e);return Ti(n,r)},n5=async(t,e,n,r,i,s,o)=>{const a=e===null?Math.ceil(t.context.length/128)*128:e.length,c=r.channelCount*r.numberOfInputs,l=i.reduce((y,m)=>y+m,0),u=l===0?null:n.createBuffer(l,a,n.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const d=Qn(t),f=await t5(n,t),h=yp(r.numberOfInputs,r.channelCount),p=yp(r.numberOfOutputs,i),g=Array.from(t.parameters.keys()).reduce((y,m)=>({...y,[m]:new Float32Array(128)}),{});for(let y=0;y<a;y+=128){if(r.numberOfInputs>0&&e!==null)for(let m=0;m<r.numberOfInputs;m+=1)for(let v=0;v<r.channelCount;v+=1)vp(e,h[m],v,v,y);s.parameterDescriptors!==void 0&&e!==null&&s.parameterDescriptors.forEach(({name:m},v)=>{vp(e,g,m,c+v,y)});for(let m=0;m<r.numberOfInputs;m+=1)for(let v=0;v<i[m];v+=1)p[m][v].byteLength===0&&(p[m][v]=new Float32Array(128));try{const m=h.map((w,_)=>d.activeInputs[_].size===0?[]:w),v=o(y/n.sampleRate,n.sampleRate,()=>f.process(m,p,g));if(u!==null)for(let w=0,_=0;w<r.numberOfOutputs;w+=1){for(let C=0;C<i[w];C+=1)HI(u,p[w],C,_+C,y);_+=i[w]}if(!v)break}catch(m){t.dispatchEvent(new ErrorEvent("processorerror",{colno:m.colno,filename:m.filename,lineno:m.lineno,message:m.message}));break}}return u},r5=(t,e,n,r,i,s,o,a,c,l,u,d,f,h,p,g)=>(y,m,v)=>{const w=new WeakMap;let _=null;const C=async(k,T)=>{let R=u(k),A=null;const M=Vn(R,T),O=Array.isArray(m.outputChannelCount)?m.outputChannelCount:Array.from(m.outputChannelCount);if(d===null){const D=O.reduce((G,te)=>G+te,0),j=i(T,{channelCount:Math.max(1,D),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,D)}),V=[];for(let G=0;G<k.numberOfOutputs;G+=1)V.push(r(T,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:O[G]}));const J=o(T,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1});J.connect=e.bind(null,V),J.disconnect=c.bind(null,V),A=[j,V,J]}else M||(R=new d(T,y));if(w.set(T,A===null?R:A[2]),A!==null){if(_===null){if(v===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const te=k.channelCount*k.numberOfInputs,z=v.parameterDescriptors===void 0?0:v.parameterDescriptors.length,Z=te+z;_=n5(k,Z===0?null:await(async()=>{const q=new f(Z,Math.ceil(k.context.length/128)*128,T.sampleRate),se=[],ke=[];for(let Te=0;Te<m.numberOfInputs;Te+=1)se.push(o(q,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1})),ke.push(i(q,{channelCount:m.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:m.channelCount}));const Ee=await Promise.all(Array.from(k.parameters.values()).map(async Te=>{const Ue=s(q,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Te.value});return await h(q,Te,Ue.offset),Ue})),me=r(q,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,te+z)});for(let Te=0;Te<m.numberOfInputs;Te+=1){se[Te].connect(ke[Te]);for(let Ue=0;Ue<m.channelCount;Ue+=1)ke[Te].connect(me,Ue,Te*m.channelCount+Ue)}for(const[Te,Ue]of Ee.entries())Ue.connect(me,0,te+Te),Ue.start(0);return me.connect(q.destination),await Promise.all(se.map(Te=>p(k,q,Te))),g(q)})(),T,m,O,v,l)}const D=await _,j=n(T,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[V,J,G]=A;D!==null&&(j.buffer=D,j.start(0)),j.connect(V);for(let te=0,z=0;te<k.numberOfOutputs;te+=1){const Z=J[te];for(let ie=0;ie<O[te];ie+=1)V.connect(Z,z+ie,ie);z+=O[te]}return G}if(M)for(const[D,j]of k.parameters.entries())await t(T,j,R.parameters.get(D));else for(const[D,j]of k.parameters.entries())await h(T,j,R.parameters.get(D));return await p(k,T,R),R};return{render(k,T){a(T,k);const R=w.get(T);return R!==void 0?Promise.resolve(R):C(k,T)}}},i5=(t,e,n,r,i,s,o,a,c,l,u,d,f,h,p,g,y,m,v,w)=>class extends p{constructor(C,k){super(C,k),this._nativeContext=C,this._audioWorklet=t===void 0?void 0:{addModule:(T,R)=>t(this,T,R)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(C,k,T){return new n({length:k,numberOfChannels:C,sampleRate:T})}createBufferSource(){return new r(this)}createChannelMerger(C=6){return new s(this,{numberOfInputs:C})}createChannelSplitter(C=6){return new o(this,{numberOfOutputs:C})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(C=1){return new u(this,{maxDelayTime:C})}createDynamicsCompressor(){return new d(this)}createGain(){return new f(this)}createIIRFilter(C,k){return new h(this,{feedback:k,feedforward:C})}createOscillator(){return new g(this)}createPanner(){return new y(this)}createPeriodicWave(C,k,T={disableNormalization:!1}){return new m(this,{...T,imag:k,real:C})}createStereoPanner(){return new v(this)}createWaveShaper(){return new w(this)}decodeAudioData(C,k,T){return l(this._nativeContext,C).then(R=>(typeof k=="function"&&k(R),R),R=>{throw typeof T=="function"&&T(R),R})}},s5={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},o5=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f={...s5,...u},h=i(d,f),p=o(d),g=p?n():null;super(l,!1,h,g),this._Q=e(this,p,h.Q,Zn,ar),this._detune=e(this,p,h.detune,1200*Math.log2(Zn),-1200*Math.log2(Zn)),this._frequency=e(this,p,h.frequency,l.sampleRate/2,0),this._gain=e(this,p,h.gain,40*Math.log10(Zn),ar),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,d)}catch(f){throw f.code===11?r():f}if(l.length!==u.length||u.length!==d.length)throw r()}},a5=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Vn(l,c);if(!u){const d={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,d)}return s.set(c,l),u?(await t(c,a.Q,l.Q),await t(c,a.detune,l.detune),await t(c,a.frequency,l.frequency),await t(c,a.gain,l.gain)):(await r(c,a.Q,l.Q),await r(c,a.detune,l.detune),await r(c,a.frequency,l.frequency),await r(c,a.gain,l.gain)),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},c5=(t,e)=>(n,r)=>{const i=e.get(n);if(i!==void 0)return i;const s=t.get(n);if(s!==void 0)return s;try{const o=r();return o instanceof Promise?(t.set(n,o),o.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,o),o)}catch{return e.set(n,!1),!1}},l5={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},u5=(t,e,n,r,i)=>class extends t{constructor(o,a){const c=r(o),l={...l5,...a},u=n(c,l),d=i(c)?e():null;super(o,!1,u,d)}},d5=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Vn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},f5={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},h5=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=r(a),u=s({...f5,...c}),d=n(l,u),f=i(l)?e():null;super(a,!1,d,f)}},p5=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Vn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},m5=t=>(e,n,r)=>t(n,e,r),g5=t=>(e,n,r=0,i=0)=>{const s=e[r];if(s===void 0)throw t();return gp(n)?s.connect(n,0,i):s.connect(n,0)},v5=t=>(e,n)=>{const r=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},y5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},S5=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...y5,...l},f=r(u,d),h=s(u),p=h?n():null;super(c,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=e(this,h,f.offset,Zn,ar),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){Pl(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),eo(this)&&af(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},b5=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let d=n(l);const f=Vn(d,u);if(!f){const h={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=e(u,h),o!==null&&d.start(o),a!==null&&d.stop(a)}return s.set(u,d),f?await t(u,l.offset,d.offset):await r(u,l.offset,d.offset),await i(l,u,d),d};return{set start(l){o=l},set stop(l){a=l},render(l,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},w5=t=>e=>(t[0]=e,t[0]),k5={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},E5=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=r(a),u={...k5,...c},d=n(l,u),h=i(l)?e():null;super(a,!1,d,h),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},C5=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Vn(a,o)){const l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(o,l)}return r.set(o,a),ql(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},T5=()=>new DOMException("","DataCloneError"),mE=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,e.close(),n.close(),r()};n.onmessage=()=>i();try{e.postMessage(t,[t])}catch{}finally{i()}})},_5=(t,e,n,r,i,s,o,a,c,l,u)=>(d,f)=>{const h=o(d)?d:s(d);if(i.has(f)){const p=n();return Promise.reject(p)}try{i.add(f)}catch{}return e(c,()=>c(h))?h.decodeAudioData(f).then(p=>(mE(f).catch(()=>{}),e(a,()=>a(p))||u(p),t.add(p),p)):new Promise((p,g)=>{const y=async()=>{try{await mE(f)}catch{}},m=v=>{g(v),y()};try{h.decodeAudioData(f,v=>{typeof v.copyFromChannel!="function"&&(l(v),UI(v)),t.add(v),y().then(()=>p(v))},v=>{m(v===null?r():v)})}catch(v){m(v)}})},I5=(t,e,n,r,i,s,o,a)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=s(c.context),f=a(d);if(u===l){if(e.delete(c),!f&&o(c)){const h=r(c),{outputs:p}=n(c);for(const g of p)if(lf(g)){const y=r(g[0]);t(h,y,g[1],g[2])}else{const y=i(g[0]);h.connect(y,g[1])}}}else e.set(c,u-l)},R5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},P5=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...R5,...l},f=r(u,d),h=s(u),p=h?n(d.maxDelayTime):null;super(c,!1,f,p),this._delayTime=e(this,h,f.delayTime),o(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},A5=(t,e,n,r,i)=>s=>{const o=new WeakMap,a=async(c,l)=>{let u=n(c);const d=Vn(u,l);if(!d){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=e(l,f)}return o.set(l,u),d?await t(l,c.delayTime,u.delayTime):await r(l,c.delayTime,u.delayTime),await i(c,l,u),u};return{render(c,l){const u=o.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}},N5=t=>(e,n,r,i)=>t(e[i],s=>s[0]===n&&s[1]===r),M5=t=>(e,n)=>{t(e).delete(n)},x5=t=>"delayTime"in t,O5=(t,e,n)=>function r(i,s){const o=hp(s)?s:n(t,s);if(x5(o))return[];if(i[0]===o)return[i];if(i.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(c=>r([...i,o],c[0])).reduce((c,l)=>c.concat(l),[])},$f=(t,e,n)=>{const r=e[n];if(r===void 0)throw t();return r},D5=t=>(e,n=void 0,r=void 0,i=0)=>n===void 0?e.forEach(s=>s.disconnect()):typeof n=="number"?$f(t,e,n).disconnect():gp(n)?r===void 0?e.forEach(s=>s.disconnect(n)):i===void 0?$f(t,e,r).disconnect(n,0):$f(t,e,r).disconnect(n,0,i):r===void 0?e.forEach(s=>s.disconnect(n)):$f(t,e,r).disconnect(n,0),L5={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},F5=(t,e,n,r,i,s,o,a)=>class extends t{constructor(l,u){const d=s(l),f={...L5,...u},h=r(d,f),p=o(d),g=p?n():null;super(l,!1,h,g),this._attack=e(this,p,h.attack),this._knee=e(this,p,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=e(this,p,h.ratio),this._release=e(this,p,h.release),this._threshold=e(this,p,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},B5=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Vn(l,c);if(!u){const d={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,d)}return s.set(c,l),u?(await t(c,a.attack,l.attack),await t(c,a.knee,l.knee),await t(c,a.ratio,l.ratio),await t(c,a.release,l.release),await t(c,a.threshold,l.threshold)):(await r(c,a.attack,l.attack),await r(c,a.knee,l.knee),await r(c,a.ratio,l.ratio),await r(c,a.release,l.release),await r(c,a.threshold,l.threshold)),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},U5=()=>new DOMException("","EncodingError"),j5=t=>e=>new Promise((n,r)=>{if(t===null){r(new SyntaxError);return}const i=t.document.head;if(i===null)r(new SyntaxError);else{const s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(u,d,f,h,p)=>{if(d===a||d===t.location.href&&f===1&&h===1)return l(),r(p),!1;if(c!==null)return c(u,d,f,h,p)},s.onerror=()=>{l(),r(new SyntaxError)},s.onload=()=>{l(),n()},s.src=a,s.type="module",i.appendChild(s)}}),W5=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=t(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(n,s,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,s===void 0?null:s,i)}},V5=t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},z5=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},$5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},H5=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=i(a),u={...$5,...c},d=r(l,u),f=s(l),h=f?n():null;super(a,!1,d,h),this._gain=e(this,f,d.gain,Zn,ar)}get gain(){return this._gain}},G5=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Vn(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,d)}return s.set(c,l),u?await t(c,a.gain,l.gain):await r(c,a.gain,l.gain),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},q5=(t,e)=>n=>e(t,n),J5=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},Z5=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},K5=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},Y5=t=>e=>t.get(e),In=()=>new DOMException("","InvalidStateError"),X5=t=>e=>{const n=t.get(e);if(n===void 0)throw In();return n},Q5=(t,e)=>n=>{let r=t.get(n);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),t.set(n,r),r},e3=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},gm=()=>new DOMException("","InvalidAccessError"),t3=t=>{t.getFrequencyResponse=(e=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw gm();return e.call(t,n,r,i)})(t.getFrequencyResponse)},n3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},r3=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=r(a),u=i(l),d={...n3,...c},f=e(l,u?null:a.baseLatency,d),h=u?n(d.feedback,d.feedforward):null;super(a,!1,f,h),t3(f),this._nativeIIRFilterNode=f,s(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}},GI=(t,e,n,r,i,s,o,a,c,l,u)=>{const d=l.length;let f=a;for(let h=0;h<d;h+=1){let p=n[0]*l[h];for(let g=1;g<i;g+=1){const y=f-g&c-1;p+=n[g]*s[y],p-=t[g]*o[y]}for(let g=i;g<r;g+=1)p+=n[g]*s[f-g&c-1];for(let g=i;g<e;g+=1)p-=t[g]*o[f-g&c-1];s[f]=l[h],o[f]=p,f=f+1&c-1,u[h]=p}return f},i3=(t,e,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),s=r instanceof Float64Array?r:new Float64Array(r),o=i.length,a=s.length,c=Math.min(o,a);if(i[0]!==1){for(let p=0;p<o;p+=1)s[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const l=32,u=new Float32Array(l),d=new Float32Array(l),f=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),h=t.numberOfChannels;for(let p=0;p<h;p+=1){const g=t.getChannelData(p),y=f.getChannelData(p);u.fill(0),d.fill(0),GI(i,o,s,a,c,u,d,0,l,g,y)}return f},s3=(t,e,n,r,i)=>(s,o)=>{const a=new WeakMap;let c=null;const l=async(u,d)=>{let f=null,h=e(u);const p=Vn(h,d);if(d.createIIRFilter===void 0?f=t(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(h=d.createIIRFilter(o,s)),a.set(d,f===null?h:f),f!==null){if(c===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const y=new n(u.context.destination.channelCount,u.context.length,d.sampleRate);c=(async()=>{await r(u,y,y.destination);const m=await i(y);return i3(m,d,s,o)})()}const g=await c;return f.buffer=g,f.start(0),f}return await r(u,d,h),h};return{render(u,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):l(u,d)}}},o3=(t,e,n,r,i,s)=>o=>(a,c)=>{const l=t.get(a);if(l===void 0){if(!o&&s(a)){const u=r(a),{outputs:d}=n(a);for(const f of d)if(lf(f)){const h=r(f[0]);e(u,h,f[1],f[2])}else{const h=i(f[0]);u.disconnect(h,f[1])}}t.set(a,c)}else t.set(a,l+c)},a3=t=>e=>t!==null&&e instanceof t,c3=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,l3=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,u3=(t,e)=>n=>t(n)||e(n),d3=t=>e=>t!==null&&e instanceof t,f3=t=>t!==null&&t.isSecureContext,h3=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s),c=e(a,o);if(r(a))throw TypeError();super(s,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},p3={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},m3=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s);if(r(a))throw new TypeError;const c={...p3,...o},l=e(a,c);super(s,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},g3=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s),c=e(a,o);if(r(a))throw new TypeError;super(s,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},v3=(t,e,n)=>class extends t{constructor(i,s){const o=n(i),a=e(o,s);super(i,!0,a,null)}},y3=(t,e,n,r,i,s)=>class extends n{constructor(a,c){super(a),this._nativeContext=a,OI.set(this,a),r(a)&&i.set(a,new Set),this._destination=new t(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Py=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},S3=(t,e)=>(n,r,i)=>{const s=new Set;return n.connect=(o=>(a,c=0,l=0)=>{const u=s.size===0;if(e(a))return o.call(n,a,c,l),t(s,[a,c,l],d=>d[0]===a&&d[1]===c&&d[2]===l,!0),u&&r(),a;o.call(n,a,c),t(s,[a,c],d=>d[0]===a&&d[1]===c,!0),u&&r()})(n.connect),n.disconnect=(o=>(a,c,l)=>{const u=s.size>0;if(a===void 0)o.apply(n),s.clear();else if(typeof a=="number"){o.call(n,a);for(const f of s)f[1]===a&&s.delete(f)}else{e(a)?o.call(n,a,c,l):o.call(n,a,c);for(const f of s)f[0]===a&&(c===void 0||f[1]===c)&&(l===void 0||f[2]===l)&&s.delete(f)}const d=s.size===0;u&&d&&i()})(n.disconnect),n},Tt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n]&&(t[n]=r)},an=(t,e)=>{Tt(t,e,"channelCount"),Tt(t,e,"channelCountMode"),Tt(t,e,"channelInterpretation")},gE=t=>typeof t.getFloatTimeDomainData=="function",b3=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const r=Math.max(n.length,t.fftSize);for(let i=0;i<r;i+=1)e[i]=(n[i]-128)*.0078125;return e}},w3=(t,e)=>(n,r)=>{const i=n.createAnalyser();if(an(i,r),!(r.maxDecibels>r.minDecibels))throw e();return Tt(i,r,"fftSize"),Tt(i,r,"maxDecibels"),Tt(i,r,"minDecibels"),Tt(i,r,"smoothingTimeConstant"),t(gE,()=>gE(i))||b3(i),i},k3=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,Bt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n].value&&(t[n].value=r)},E3=t=>{t.start=(e=>{let n=!1;return(r=0,i=0,s)=>{if(n)throw In();e.call(t,r,i,s),n=!0}})(t.start)},tb=t=>{t.start=(e=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,i)})(t.start)},nb=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},C3=(t,e,n,r,i,s,o,a,c,l,u)=>(d,f)=>{const h=d.createBufferSource();return an(h,f),Bt(h,f,"playbackRate"),Tt(h,f,"buffer"),Tt(h,f,"loop"),Tt(h,f,"loopEnd"),Tt(h,f,"loopStart"),e(n,()=>n(d))||E3(h),e(r,()=>r(d))||c(h),e(i,()=>i(d))||l(h,d),e(s,()=>s(d))||tb(h),e(o,()=>o(d))||u(h,d),e(a,()=>a(d))||nb(h),t(d,h),h},T3=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,_3=(t,e)=>(n,r,i)=>{const s=n.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}i&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});const o=t(n,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",a=>()=>a.call(o),a=>c=>{a.call(o,c);try{s.channelCount=c}catch(l){if(c>s.maxChannelCount)throw l}}),e(o,"channelCountMode",a=>()=>a.call(o),a=>c=>{a.call(o,c),s.channelCountMode=c}),e(o,"channelInterpretation",a=>()=>a.call(o),a=>c=>{a.call(o,c),s.channelInterpretation=c}),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o},I3=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,R3=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},P3=(t,e,n,r,i)=>(s,o,a,c,l,u)=>{if(a!==null)try{const d=new a(s,c,u),f=new Map;let h=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>h,set:p=>{typeof h=="function"&&d.removeEventListener("processorerror",h),h=typeof p=="function"?p:null,typeof h=="function"&&d.addEventListener("processorerror",h)}}}),d.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const y=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(y!==null){const m=f.get(g[1]);m!==void 0?g[1]=m:(g[1]=v=>{v.type==="error"?(Object.defineProperties(v,{type:{value:"processorerror"}}),y(v)):y(new ErrorEvent(g[0],{...v}))},f.set(y,g[1]))}}return p.call(d,"error",g[1],g[2]),p.call(d,...g)})(d.addEventListener),d.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const y=f.get(g[1]);y!==void 0&&(f.delete(g[1]),g[1]=y)}return p.call(d,"error",g[1],g[2]),p.call(d,g[0],g[1],g[2])})(d.removeEventListener),u.numberOfOutputs!==0){const p=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(p).connect(s.destination),i(d,()=>p.disconnect(),()=>p.connect(s.destination))}return d}catch(d){throw d.code===11?r():d}if(l===void 0)throw r();return R3(u),e(s,o,l,u)},qI=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),A3=t=>new Promise((e,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:s})=>{r.close(),i.close(),e(s)},r.onmessageerror=({data:s})=>{r.close(),i.close(),n(s)},i.postMessage(t)}),N3=async(t,e)=>{const n=await A3(e);return new t(n)},M3=(t,e,n,r)=>{let i=Ty.get(t);i===void 0&&(i=new WeakMap,Ty.set(t,i));const s=N3(n,r);return i.set(e,s),s},x3=(t,e,n,r,i,s,o,a,c,l,u,d,f)=>(h,p,g,y)=>{if(y.numberOfInputs===0&&y.numberOfOutputs===0)throw c();const m=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(m.some(le=>le<1))throw c();if(m.length!==y.numberOfOutputs)throw e();if(y.channelCountMode!=="explicit")throw c();const v=y.channelCount*y.numberOfInputs,w=m.reduce((le,Se)=>le+Se,0),_=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(v+_>6||w>6)throw c();const C=new MessageChannel,k=[],T=[];for(let le=0;le<y.numberOfInputs;le+=1)k.push(o(h,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),T.push(i(h,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const R=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:le,maxValue:Se,minValue:Ye,name:Je}of g.parameterDescriptors){const ue=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:y.parameterData[Je]!==void 0?y.parameterData[Je]:le===void 0?0:le});Object.defineProperties(ue.offset,{defaultValue:{get:()=>le===void 0?0:le},maxValue:{get:()=>Se===void 0?Zn:Se},minValue:{get:()=>Ye===void 0?ar:Ye}}),R.push(ue)}const A=r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+_)}),M=qI(p,h.sampleRate),O=a(h,M,v+_,Math.max(1,w)),D=i(h,{channelCount:Math.max(1,w),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,w)}),j=[];for(let le=0;le<y.numberOfOutputs;le+=1)j.push(r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:m[le]}));for(let le=0;le<y.numberOfInputs;le+=1){k[le].connect(T[le]);for(let Se=0;Se<y.channelCount;Se+=1)T[le].connect(A,Se,le*y.channelCount+Se)}const V=new $I(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:le},Se)=>{const Ye=R[Se];return Ye.connect(A,0,v+Se),Ye.start(0),[le,Ye.offset]}));A.connect(O);let J=y.channelInterpretation,G=null;const te=y.numberOfOutputs===0?[O]:j,z={get bufferSize(){return M},get channelCount(){return y.channelCount},set channelCount(le){throw n()},get channelCountMode(){return y.channelCountMode},set channelCountMode(le){throw n()},get channelInterpretation(){return J},set channelInterpretation(le){for(const Se of k)Se.channelInterpretation=le;J=le},get context(){return O.context},get inputs(){return k},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},get onprocessorerror(){return G},set onprocessorerror(le){typeof G=="function"&&z.removeEventListener("processorerror",G),G=typeof le=="function"?le:null,typeof G=="function"&&z.addEventListener("processorerror",G)},get parameters(){return V},get port(){return C.port2},addEventListener(...le){return O.addEventListener(le[0],le[1],le[2])},connect:t.bind(null,te),disconnect:l.bind(null,te),dispatchEvent(...le){return O.dispatchEvent(le[0])},removeEventListener(...le){return O.removeEventListener(le[0],le[1],le[2])}},Z=new Map;C.port1.addEventListener=(le=>(...Se)=>{if(Se[0]==="message"){const Ye=typeof Se[1]=="function"?Se[1]:typeof Se[1]=="object"&&Se[1]!==null&&typeof Se[1].handleEvent=="function"?Se[1].handleEvent:null;if(Ye!==null){const Je=Z.get(Se[1]);Je!==void 0?Se[1]=Je:(Se[1]=ue=>{u(h.currentTime,h.sampleRate,()=>Ye(ue))},Z.set(Ye,Se[1]))}}return le.call(C.port1,Se[0],Se[1],Se[2])})(C.port1.addEventListener),C.port1.removeEventListener=(le=>(...Se)=>{if(Se[0]==="message"){const Ye=Z.get(Se[1]);Ye!==void 0&&(Z.delete(Se[1]),Se[1]=Ye)}return le.call(C.port1,Se[0],Se[1],Se[2])})(C.port1.removeEventListener);let ie=null;Object.defineProperty(C.port1,"onmessage",{get:()=>ie,set:le=>{typeof ie=="function"&&C.port1.removeEventListener("message",ie),ie=typeof le=="function"?le:null,typeof ie=="function"&&(C.port1.addEventListener("message",ie),C.port1.start())}}),g.prototype.port=C.port1;let q=null;M3(h,z,g,y).then(le=>q=le);const ke=yp(y.numberOfInputs,y.channelCount),Ee=yp(y.numberOfOutputs,m),me=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((le,{name:Se})=>({...le,[Se]:new Float32Array(128)}),{});let Te=!0;const Ue=()=>{y.numberOfOutputs>0&&O.disconnect(D);for(let le=0,Se=0;le<y.numberOfOutputs;le+=1){const Ye=j[le];for(let Je=0;Je<m[le];Je+=1)D.disconnect(Ye,Se+Je,Je);Se+=m[le]}},ce=new Map;O.onaudioprocess=({inputBuffer:le,outputBuffer:Se})=>{if(q!==null){const Ye=d(z);for(let Je=0;Je<M;Je+=128){for(let ue=0;ue<y.numberOfInputs;ue+=1)for(let Le=0;Le<y.channelCount;Le+=1)vp(le,ke[ue],Le,Le,Je);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:ue},Le)=>{vp(le,me,ue,v+Le,Je)});for(let ue=0;ue<y.numberOfInputs;ue+=1)for(let Le=0;Le<m[ue];Le+=1)Ee[ue][Le].byteLength===0&&(Ee[ue][Le]=new Float32Array(128));try{const ue=ke.map((Re,je)=>{if(Ye[je].size>0)return ce.set(je,M/128),Re;const Oe=ce.get(je);return Oe===void 0?[]:(Re.every(Ht=>Ht.every(mc=>mc===0))&&(Oe===1?ce.delete(je):ce.set(je,Oe-1)),Re)});Te=u(h.currentTime+Je/h.sampleRate,h.sampleRate,()=>q.process(ue,Ee,me));for(let Re=0,je=0;Re<y.numberOfOutputs;Re+=1){for(let Ut=0;Ut<m[Re];Ut+=1)HI(Se,Ee[Re],Ut,je+Ut,Je);je+=m[Re]}}catch(ue){Te=!1,z.dispatchEvent(new ErrorEvent("processorerror",{colno:ue.colno,filename:ue.filename,lineno:ue.lineno,message:ue.message}))}if(!Te){for(let ue=0;ue<y.numberOfInputs;ue+=1){k[ue].disconnect(T[ue]);for(let Le=0;Le<y.channelCount;Le+=1)T[Je].disconnect(A,Le,ue*y.channelCount+Le)}if(g.parameterDescriptors!==void 0){const ue=g.parameterDescriptors.length;for(let Le=0;Le<ue;Le+=1){const Re=R[Le];Re.disconnect(A,0,v+Le),Re.stop()}}A.disconnect(O),O.onaudioprocess=null,xt?Ue():Sn();break}}}};let xt=!1;const cn=o(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Et=()=>O.connect(cn).connect(h.destination),Sn=()=>{O.disconnect(cn),cn.disconnect()},Zt=()=>{if(Te){Sn(),y.numberOfOutputs>0&&O.connect(D);for(let le=0,Se=0;le<y.numberOfOutputs;le+=1){const Ye=j[le];for(let Je=0;Je<m[le];Je+=1)D.connect(Ye,Se+Je,Je);Se+=m[le]}}xt=!0},bn=()=>{Te&&(Et(),Ue()),xt=!1};return Et(),f(z,Zt,bn)},JI=(t,e)=>{const n=t.createBiquadFilter();return an(n,e),Bt(n,e,"Q"),Bt(n,e,"detune"),Bt(n,e,"frequency"),Bt(n,e,"gain"),Tt(n,e,"type"),n},O3=(t,e)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,i),an(i,r),i},D3=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw In()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw In()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw In()}})},uf=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return an(n,e),D3(n),n},L3=(t,e,n,r,i)=>(s,o)=>{if(s.createConstantSource===void 0)return n(s,o);const a=s.createConstantSource();return an(a,o),Bt(a,o,"offset"),e(r,()=>r(s))||tb(a),e(i,()=>i(s))||nb(a),t(s,a),a},Jl=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),F3=(t,e,n,r)=>(i,{offset:s,...o})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(i,{...o,gain:s}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const d={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(p){l.channelCount=p},get channelCountMode(){return l.channelCountMode},set channelCountMode(p){l.channelCountMode=p},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(p){l.channelInterpretation=p},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(p){c.onended=p},addEventListener(...p){return c.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return c.dispatchEvent(p[0])},removeEventListener(...p){return c.removeEventListener(p[0],p[1],p[2])},start(p=0){c.start.call(c,p)},stop(p=0){c.stop.call(c,p)}},f=()=>c.connect(l),h=()=>c.disconnect(l);return t(i,c),r(Jl(d,l),f,h)},B3=(t,e)=>(n,r)=>{const i=n.createConvolver();if(an(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),Tt(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",s=>()=>s.call(i),s=>o=>{if(o>2)throw t();return s.call(i,o)}),r.channelCountMode==="max"))throw t();return e(i,"channelCountMode",s=>()=>s.call(i),s=>o=>{if(o==="max")throw t();return s.call(i,o)}),i},ZI=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return an(n,e),Bt(n,e,"delayTime"),n},U3=t=>(e,n)=>{const r=e.createDynamicsCompressor();if(an(r,n),n.channelCount>2||n.channelCountMode==="max")throw t();return Bt(r,n,"attack"),Bt(r,n,"knee"),Bt(r,n,"ratio"),Bt(r,n,"release"),Bt(r,n,"threshold"),r},mr=(t,e)=>{const n=t.createGain();return an(n,e),Bt(n,e,"gain"),n},j3=t=>(e,n,r)=>{if(e.createIIRFilter===void 0)return t(e,n,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return an(i,r),i};function W3(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function V3(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function vE(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)n=V3(n,e),n[0]+=t[r];return n}const z3=(t,e,n,r)=>(i,s,{channelCount:o,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const d=qI(s,i.sampleRate),f=l instanceof Float64Array?l:new Float64Array(l),h=u instanceof Float64Array?u:new Float64Array(u),p=f.length,g=h.length,y=Math.min(p,g);if(p===0||p>20)throw r();if(f[0]===0)throw e();if(g===0||g>20)throw r();if(h[0]===0)throw e();if(f[0]!==1){for(let R=0;R<g;R+=1)h[R]/=f[0];for(let R=1;R<p;R+=1)f[R]/=f[0]}const m=n(i,d,o,o);m.channelCount=o,m.channelCountMode=a,m.channelInterpretation=c;const v=32,w=[],_=[],C=[];for(let R=0;R<o;R+=1){w.push(0);const A=new Float32Array(v),M=new Float32Array(v);A.fill(0),M.fill(0),_.push(A),C.push(M)}m.onaudioprocess=R=>{const A=R.inputBuffer,M=R.outputBuffer,O=A.numberOfChannels;for(let D=0;D<O;D+=1){const j=A.getChannelData(D),V=M.getChannelData(D);w[D]=GI(f,p,h,g,y,_[D],C[D],w[D],v,j,V)}};const k=i.sampleRate/2;return Jl({get bufferSize(){return d},get channelCount(){return m.channelCount},set channelCount(R){m.channelCount=R},get channelCountMode(){return m.channelCountMode},set channelCountMode(R){m.channelCountMode=R},get channelInterpretation(){return m.channelInterpretation},set channelInterpretation(R){m.channelInterpretation=R},get context(){return m.context},get inputs(){return[m]},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},addEventListener(...R){return m.addEventListener(R[0],R[1],R[2])},dispatchEvent(...R){return m.dispatchEvent(R[0])},getFrequencyResponse(R,A,M){if(R.length!==A.length||A.length!==M.length)throw t();const O=R.length;for(let D=0;D<O;D+=1){const j=-Math.PI*(R[D]/k),V=[Math.cos(j),Math.sin(j)],J=vE(h,V),G=vE(f,V),te=W3(J,G);A[D]=Math.sqrt(te[0]*te[0]+te[1]*te[1]),M[D]=Math.atan2(te[1],te[0])}},removeEventListener(...R){return m.removeEventListener(R[0],R[1],R[2])}},m)},$3=(t,e)=>t.createMediaElementSource(e.mediaElement),H3=(t,e)=>{const n=t.createMediaStreamDestination();return an(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},G3=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((s,o)=>s.id<o.id?-1:s.id>o.id?1:0);const r=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},q3=(t,e)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),s=n.createMediaStreamSource(i);if(r.kind!=="audio")throw t();if(e(n))throw new TypeError;return s},J3=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,Z3=(t,e,n,r,i,s)=>(o,a)=>{const c=o.createOscillator();return an(c,a),Bt(c,a,"detune"),Bt(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):Tt(c,a,"type"),e(n,()=>n(o))||tb(c),e(r,()=>r(o))||s(c,o),e(i,()=>i(o))||nb(c),t(o,c),c},K3=t=>(e,n)=>{const r=e.createPanner();return r.orientationX===void 0?t(e,n):(an(r,n),Bt(r,n,"orientationX"),Bt(r,n,"orientationY"),Bt(r,n,"orientationZ"),Bt(r,n,"positionX"),Bt(r,n,"positionY"),Bt(r,n,"positionZ"),Tt(r,n,"coneInnerAngle"),Tt(r,n,"coneOuterAngle"),Tt(r,n,"coneOuterGain"),Tt(r,n,"distanceModel"),Tt(r,n,"maxDistance"),Tt(r,n,"panningModel"),Tt(r,n,"refDistance"),Tt(r,n,"rolloffFactor"),r)},Y3=(t,e,n,r,i,s,o,a,c,l)=>(u,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:h,distanceModel:p,maxDistance:g,orientationX:y,orientationY:m,orientationZ:v,panningModel:w,positionX:_,positionY:C,positionZ:k,refDistance:T,rolloffFactor:R,...A})=>{const M=u.createPanner();if(A.channelCount>2||A.channelCountMode==="max")throw o();an(M,A);const O={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},D=n(u,{...O,channelInterpretation:"speakers",numberOfInputs:6}),j=r(u,{...A,gain:1}),V=r(u,{...O,gain:1}),J=r(u,{...O,gain:0}),G=r(u,{...O,gain:0}),te=r(u,{...O,gain:0}),z=r(u,{...O,gain:0}),Z=r(u,{...O,gain:0}),ie=i(u,256,6,1),q=s(u,{...O,curve:new Float32Array([1,1]),oversample:"none"});let se=[y,m,v],ke=[_,C,k];const Ee=new Float32Array(1);ie.onaudioprocess=({inputBuffer:ce})=>{const xt=[c(ce,Ee,0),c(ce,Ee,1),c(ce,Ee,2)];xt.some((Et,Sn)=>Et!==se[Sn])&&(M.setOrientation(...xt),se=xt);const cn=[c(ce,Ee,3),c(ce,Ee,4),c(ce,Ee,5)];cn.some((Et,Sn)=>Et!==ke[Sn])&&(M.setPosition(...cn),ke=cn)},Object.defineProperty(J.gain,"defaultValue",{get:()=>0}),Object.defineProperty(G.gain,"defaultValue",{get:()=>0}),Object.defineProperty(te.gain,"defaultValue",{get:()=>0}),Object.defineProperty(z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Z.gain,"defaultValue",{get:()=>0});const me={get bufferSize(){},get channelCount(){return M.channelCount},set channelCount(ce){if(ce>2)throw o();j.channelCount=ce,M.channelCount=ce},get channelCountMode(){return M.channelCountMode},set channelCountMode(ce){if(ce==="max")throw o();j.channelCountMode=ce,M.channelCountMode=ce},get channelInterpretation(){return M.channelInterpretation},set channelInterpretation(ce){j.channelInterpretation=ce,M.channelInterpretation=ce},get coneInnerAngle(){return M.coneInnerAngle},set coneInnerAngle(ce){M.coneInnerAngle=ce},get coneOuterAngle(){return M.coneOuterAngle},set coneOuterAngle(ce){M.coneOuterAngle=ce},get coneOuterGain(){return M.coneOuterGain},set coneOuterGain(ce){if(ce<0||ce>1)throw e();M.coneOuterGain=ce},get context(){return M.context},get distanceModel(){return M.distanceModel},set distanceModel(ce){M.distanceModel=ce},get inputs(){return[j]},get maxDistance(){return M.maxDistance},set maxDistance(ce){if(ce<0)throw new RangeError;M.maxDistance=ce},get numberOfInputs(){return M.numberOfInputs},get numberOfOutputs(){return M.numberOfOutputs},get orientationX(){return V.gain},get orientationY(){return J.gain},get orientationZ(){return G.gain},get panningModel(){return M.panningModel},set panningModel(ce){M.panningModel=ce},get positionX(){return te.gain},get positionY(){return z.gain},get positionZ(){return Z.gain},get refDistance(){return M.refDistance},set refDistance(ce){if(ce<0)throw new RangeError;M.refDistance=ce},get rolloffFactor(){return M.rolloffFactor},set rolloffFactor(ce){if(ce<0)throw new RangeError;M.rolloffFactor=ce},addEventListener(...ce){return j.addEventListener(ce[0],ce[1],ce[2])},dispatchEvent(...ce){return j.dispatchEvent(ce[0])},removeEventListener(...ce){return j.removeEventListener(ce[0],ce[1],ce[2])}};d!==me.coneInnerAngle&&(me.coneInnerAngle=d),f!==me.coneOuterAngle&&(me.coneOuterAngle=f),h!==me.coneOuterGain&&(me.coneOuterGain=h),p!==me.distanceModel&&(me.distanceModel=p),g!==me.maxDistance&&(me.maxDistance=g),y!==me.orientationX.value&&(me.orientationX.value=y),m!==me.orientationY.value&&(me.orientationY.value=m),v!==me.orientationZ.value&&(me.orientationZ.value=v),w!==me.panningModel&&(me.panningModel=w),_!==me.positionX.value&&(me.positionX.value=_),C!==me.positionY.value&&(me.positionY.value=C),k!==me.positionZ.value&&(me.positionZ.value=k),T!==me.refDistance&&(me.refDistance=T),R!==me.rolloffFactor&&(me.rolloffFactor=R),(se[0]!==1||se[1]!==0||se[2]!==0)&&M.setOrientation(...se),(ke[0]!==0||ke[1]!==0||ke[2]!==0)&&M.setPosition(...ke);const Te=()=>{j.connect(M),t(j,q,0,0),q.connect(V).connect(D,0,0),q.connect(J).connect(D,0,1),q.connect(G).connect(D,0,2),q.connect(te).connect(D,0,3),q.connect(z).connect(D,0,4),q.connect(Z).connect(D,0,5),D.connect(ie).connect(u.destination)},Ue=()=>{j.disconnect(M),a(j,q,0,0),q.disconnect(V),V.disconnect(D),q.disconnect(J),J.disconnect(D),q.disconnect(G),G.disconnect(D),q.disconnect(te),te.disconnect(D),q.disconnect(z),z.disconnect(D),q.disconnect(Z),Z.disconnect(D),D.disconnect(ie),ie.disconnect(u.destination)};return l(Jl(me,M),Te,Ue)},X3=t=>(e,{disableNormalization:n,imag:r,real:i})=>{const s=r instanceof Float32Array?r:new Float32Array(r),o=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(o,s,{disableNormalization:n});if(Array.from(r).length<2)throw t();return a},df=(t,e,n,r)=>t.createScriptProcessor(e,n,r),Q3=(t,e)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,r);const s=n.createStereoPanner();return an(s,r),Bt(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:o=>{if(o!==i)throw e()}}),s},eB=(t,e,n,r,i,s)=>{const a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},d=(p,g,y,m)=>{const v=new Float32Array(16385),w=new Float32Array(16385);for(let A=0;A<16385;A+=1){const M=A/16384*c;v[A]=Math.cos(M),w[A]=Math.sin(M)}const _=n(p,{...l,gain:0}),C=r(p,{...u,curve:v}),k=r(p,{...u,curve:a}),T=n(p,{...l,gain:0}),R=r(p,{...u,curve:w});return{connectGraph(){g.connect(_),g.connect(k.inputs===void 0?k:k.inputs[0]),g.connect(T),k.connect(y),y.connect(C.inputs===void 0?C:C.inputs[0]),y.connect(R.inputs===void 0?R:R.inputs[0]),C.connect(_.gain),R.connect(T.gain),_.connect(m,0,0),T.connect(m,0,1)},disconnectGraph(){g.disconnect(_),g.disconnect(k.inputs===void 0?k:k.inputs[0]),g.disconnect(T),k.disconnect(y),y.disconnect(C.inputs===void 0?C:C.inputs[0]),y.disconnect(R.inputs===void 0?R:R.inputs[0]),C.disconnect(_.gain),R.disconnect(T.gain),_.disconnect(m,0,0),T.disconnect(m,0,1)}}},f=(p,g,y,m)=>{const v=new Float32Array(16385),w=new Float32Array(16385),_=new Float32Array(16385),C=new Float32Array(16385),k=Math.floor(16385/2);for(let te=0;te<16385;te+=1)if(te>k){const z=(te-k)/(16384-k)*c;v[te]=Math.cos(z),w[te]=Math.sin(z),_[te]=0,C[te]=1}else{const z=te/(16384-k)*c;v[te]=1,w[te]=0,_[te]=Math.cos(z),C[te]=Math.sin(z)}const T=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),R=n(p,{...l,gain:0}),A=r(p,{...u,curve:v}),M=n(p,{...l,gain:0}),O=r(p,{...u,curve:w}),D=r(p,{...u,curve:a}),j=n(p,{...l,gain:0}),V=r(p,{...u,curve:_}),J=n(p,{...l,gain:0}),G=r(p,{...u,curve:C});return{connectGraph(){g.connect(T),g.connect(D.inputs===void 0?D:D.inputs[0]),T.connect(R,0),T.connect(M,0),T.connect(j,1),T.connect(J,1),D.connect(y),y.connect(A.inputs===void 0?A:A.inputs[0]),y.connect(O.inputs===void 0?O:O.inputs[0]),y.connect(V.inputs===void 0?V:V.inputs[0]),y.connect(G.inputs===void 0?G:G.inputs[0]),A.connect(R.gain),O.connect(M.gain),V.connect(j.gain),G.connect(J.gain),R.connect(m,0,0),j.connect(m,0,0),M.connect(m,0,1),J.connect(m,0,1)},disconnectGraph(){g.disconnect(T),g.disconnect(D.inputs===void 0?D:D.inputs[0]),T.disconnect(R,0),T.disconnect(M,0),T.disconnect(j,1),T.disconnect(J,1),D.disconnect(y),y.disconnect(A.inputs===void 0?A:A.inputs[0]),y.disconnect(O.inputs===void 0?O:O.inputs[0]),y.disconnect(V.inputs===void 0?V:V.inputs[0]),y.disconnect(G.inputs===void 0?G:G.inputs[0]),A.disconnect(R.gain),O.disconnect(M.gain),V.disconnect(j.gain),G.disconnect(J.gain),R.disconnect(m,0,0),j.disconnect(m,0,0),M.disconnect(m,0,1),J.disconnect(m,0,1)}}},h=(p,g,y,m,v)=>{if(g===1)return d(p,y,m,v);if(g===2)return f(p,y,m,v);throw i()};return(p,{channelCount:g,channelCountMode:y,pan:m,...v})=>{if(y==="max")throw i();const w=t(p,{...v,channelCount:1,channelCountMode:y,numberOfInputs:2}),_=n(p,{...v,channelCount:g,channelCountMode:y,gain:1}),C=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:m});let{connectGraph:k,disconnectGraph:T}=h(p,g,_,C,w);Object.defineProperty(C.gain,"defaultValue",{get:()=>0}),Object.defineProperty(C.gain,"maxValue",{get:()=>1}),Object.defineProperty(C.gain,"minValue",{get:()=>-1});const R={get bufferSize(){},get channelCount(){return _.channelCount},set channelCount(D){_.channelCount!==D&&(A&&T(),{connectGraph:k,disconnectGraph:T}=h(p,D,_,C,w),A&&k()),_.channelCount=D},get channelCountMode(){return _.channelCountMode},set channelCountMode(D){if(D==="clamped-max"||D==="max")throw i();_.channelCountMode=D},get channelInterpretation(){return _.channelInterpretation},set channelInterpretation(D){_.channelInterpretation=D},get context(){return _.context},get inputs(){return[_]},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get pan(){return C.gain},addEventListener(...D){return _.addEventListener(D[0],D[1],D[2])},dispatchEvent(...D){return _.dispatchEvent(D[0])},removeEventListener(...D){return _.removeEventListener(D[0],D[1],D[2])}};let A=!1;const M=()=>{k(),A=!0},O=()=>{T(),A=!1};return s(Jl(R,w),M,O)}},tB=(t,e,n,r,i,s,o)=>(a,c)=>{const l=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,c);an(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();Tt(l,{curve:u},"curve"),Tt(l,c,"oversample");let d=null,f=!1;return o(l,"curve",g=>()=>g.call(l),g=>y=>(g.call(l,y),f&&(r(y)&&d===null?d=t(a,l):!r(y)&&d!==null&&(d(),d=null)),y)),i(l,()=>{f=!0,r(l.curve)&&(d=t(a,l))},()=>{f=!1,d!==null&&(d(),d=null)})},nB=(t,e,n,r,i)=>(s,{curve:o,oversample:a,...c})=>{const l=s.createWaveShaper(),u=s.createWaveShaper();an(l,c),an(u,c);const d=n(s,{...c,gain:1}),f=n(s,{...c,gain:-1}),h=n(s,{...c,gain:1}),p=n(s,{...c,gain:-1});let g=null,y=!1,m=null;const v={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(C){d.channelCount=C,f.channelCount=C,l.channelCount=C,h.channelCount=C,u.channelCount=C,p.channelCount=C},get channelCountMode(){return l.channelCountMode},set channelCountMode(C){d.channelCountMode=C,f.channelCountMode=C,l.channelCountMode=C,h.channelCountMode=C,u.channelCountMode=C,p.channelCountMode=C},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(C){d.channelInterpretation=C,f.channelInterpretation=C,l.channelInterpretation=C,h.channelInterpretation=C,u.channelInterpretation=C,p.channelInterpretation=C},get context(){return l.context},get curve(){return m},set curve(C){if(C!==null&&C.length<2)throw e();if(C===null)l.curve=C,u.curve=C;else{const k=C.length,T=new Float32Array(k+2-k%2),R=new Float32Array(k+2-k%2);T[0]=C[0],R[0]=-C[k-1];const A=Math.ceil((k+1)/2),M=(k+1)/2-1;for(let O=1;O<A;O+=1){const D=O/A*M,j=Math.floor(D),V=Math.ceil(D);T[O]=j===V?C[j]:(1-(D-j))*C[j]+(1-(V-D))*C[V],R[O]=j===V?-C[k-1-j]:-((1-(D-j))*C[k-1-j])-(1-(V-D))*C[k-1-V]}T[A]=k%2===1?C[A-1]:(C[A-2]+C[A-1])/2,l.curve=T,u.curve=R}m=C,y&&(r(m)&&g===null?g=t(s,d):g!==null&&(g(),g=null))},get inputs(){return[d]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(C){l.oversample=C,u.oversample=C},addEventListener(...C){return d.addEventListener(C[0],C[1],C[2])},dispatchEvent(...C){return d.dispatchEvent(C[0])},removeEventListener(...C){return d.removeEventListener(C[0],C[1],C[2])}};o!==null&&(v.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==v.oversample&&(v.oversample=a);const w=()=>{d.connect(l).connect(h),d.connect(f).connect(u).connect(p).connect(h),y=!0,r(m)&&(g=t(s,d))},_=()=>{d.disconnect(l),l.disconnect(h),d.disconnect(f),f.disconnect(u),u.disconnect(p),p.disconnect(h),y=!1,g!==null&&(g(),g=null)};return i(Jl(v,h),w,_)},gr=()=>new DOMException("","NotSupportedError"),rB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},iB=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...rB,...l},f=n(u,d),h=s(u),p=h?r():null,g=c.sampleRate/2;super(c,!1,f,p),this._detune=e(this,h,f.detune,153600,-153600),this._frequency=e(this,h,f.frequency,g,-g),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){Pl(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),eo(this)&&af(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},sB=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null,c=null;const l=async(u,d)=>{let f=n(u);const h=Vn(f,d);if(!h){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:o===null?void 0:o,type:f.type};f=e(d,p),a!==null&&f.start(a),c!==null&&f.stop(c)}return s.set(d,f),h?(await t(d,u.detune,f.detune),await t(d,u.frequency,f.frequency)):(await r(d,u.detune,f.detune),await r(d,u.frequency,f.frequency)),await i(u,d,f),f};return{set periodicWave(u){o=u},set start(u){a=u},set stop(u){c=u},render(u,d){const f=s.get(d);return f!==void 0?Promise.resolve(f):l(u,d)}}},oB={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},aB=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...oB,...l},f=n(u,d),h=s(u),p=h?r():null;super(c,!1,f,p),this._nativePannerNode=f,this._orientationX=e(this,h,f.orientationX,Zn,ar),this._orientationY=e(this,h,f.orientationY,Zn,ar),this._orientationZ=e(this,h,f.orientationZ,Zn,ar),this._positionX=e(this,h,f.positionX,Zn,ar),this._positionY=e(this,h,f.positionY,Zn,ar),this._positionZ=e(this,h,f.positionZ,Zn,ar),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},cB=(t,e,n,r,i,s,o,a,c,l)=>()=>{const u=new WeakMap;let d=null;const f=async(h,p)=>{let g=null,y=s(h);const m={channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation},v={...m,coneInnerAngle:y.coneInnerAngle,coneOuterAngle:y.coneOuterAngle,coneOuterGain:y.coneOuterGain,distanceModel:y.distanceModel,maxDistance:y.maxDistance,panningModel:y.panningModel,refDistance:y.refDistance,rolloffFactor:y.rolloffFactor},w=Vn(y,p);if("bufferSize"in y)g=r(p,{...m,gain:1});else if(!w){const _={...v,orientationX:y.orientationX.value,orientationY:y.orientationY.value,orientationZ:y.orientationZ.value,positionX:y.positionX.value,positionY:y.positionY.value,positionZ:y.positionZ.value};y=i(p,_)}if(u.set(p,g===null?y:g),g!==null){if(d===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const O=new o(6,h.context.length,p.sampleRate),D=e(O,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});D.connect(O.destination),d=(async()=>{const j=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map(async(V,J)=>{const G=n(O,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:J===0?1:0});return await a(O,V,G.offset),G}));for(let V=0;V<6;V+=1)j[V].connect(D,0,V),j[V].start(0);return l(O)})()}const _=await d,C=r(p,{...m,gain:1});await c(h,p,C);const k=[];for(let O=0;O<_.numberOfChannels;O+=1)k.push(_.getChannelData(O));let T=[k[0][0],k[1][0],k[2][0]],R=[k[3][0],k[4][0],k[5][0]],A=r(p,{...m,gain:1}),M=i(p,{...v,orientationX:T[0],orientationY:T[1],orientationZ:T[2],positionX:R[0],positionY:R[1],positionZ:R[2]});C.connect(A).connect(M.inputs[0]),M.connect(g);for(let O=128;O<_.length;O+=128){const D=[k[0][O],k[1][O],k[2][O]],j=[k[3][O],k[4][O],k[5][O]];if(D.some((V,J)=>V!==T[J])||j.some((V,J)=>V!==R[J])){T=D,R=j;const V=O/p.sampleRate;A.gain.setValueAtTime(0,V),A=r(p,{...m,gain:0}),M=i(p,{...v,orientationX:T[0],orientationY:T[1],orientationZ:T[2],positionX:R[0],positionY:R[1],positionZ:R[2]}),A.gain.setValueAtTime(1,V),C.connect(A).connect(M.inputs[0]),M.connect(g)}}return g}return w?(await t(p,h.orientationX,y.orientationX),await t(p,h.orientationY,y.orientationY),await t(p,h.orientationZ,y.orientationZ),await t(p,h.positionX,y.positionX),await t(p,h.positionY,y.positionY),await t(p,h.positionZ,y.positionZ)):(await a(p,h.orientationX,y.orientationX),await a(p,h.orientationY,y.orientationY),await a(p,h.orientationZ,y.orientationZ),await a(p,h.positionX,y.positionX),await a(p,h.positionY,y.positionY),await a(p,h.positionZ,y.positionZ)),ql(y)?await c(h,p,y.inputs[0]):await c(h,p,y),y};return{render(h,p){const g=u.get(p);return g!==void 0?Promise.resolve(g):f(h,p)}}},lB={disableNormalization:!1},uB=(t,e,n,r)=>class KI{constructor(s,o){const a=e(s),c=r({...lB,...o}),l=t(a,c);return n.add(l),l}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===KI.prototype||n.has(s)}},dB=(t,e)=>(n,r,i)=>(t(r).replay(i),e(r,n,i)),fB=(t,e,n)=>async(r,i,s)=>{const o=t(r);await Promise.all(o.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{const f=await e(l).render(l,i),h=r.context.destination;!n(l)&&(r!==h||!n(r))&&f.connect(s,u,c)})).reduce((a,c)=>[...a,...c],[]))},hB=(t,e,n)=>async(r,i,s)=>{const o=e(r);await Promise.all(Array.from(o.activeInputs).map(async([a,c])=>{const u=await t(a).render(a,i);n(a)||u.connect(s,c)}))},pB=(t,e,n,r)=>i=>t(Py,()=>Py(i))?Promise.resolve(t(r,r)).then(s=>{if(!s){const o=n(i,512,0,1);i.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>i.currentTime,o.connect(i.destination)}return i.startRendering()}):new Promise(s=>{const o=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{o.disconnect(),s(a.renderedBuffer)},o.connect(i.destination),i.startRendering()}),mB=t=>(e,n)=>{t.set(e,n)},gB=t=>(e,n)=>t.set(e,n),vB={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},yB=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const l=i(a),u={...vB,...c},d=n(l,u),f=s(l),h=f?r():null;super(a,!1,d,h),this._pan=e(this,f,d.pan)}get pan(){return this._pan}},SB=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=Vn(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,d)}return s.set(c,l),u?await t(c,a.pan,l.pan):await r(c,a.pan,l.pan),ql(l)?await i(a,c,l.inputs[0]):await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},bB=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},wB=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(n);let s=!1,o=!1;try{await r.audioWorklet.addModule(i);const a=new t(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>o=!0,c.connect(a),c.start(0),await r.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(i)}return s&&!o},kB=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},EB=()=>new DOMException("","UnknownError"),CB={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},TB=(t,e,n,r,i,s,o)=>class extends t{constructor(c,l){const u=i(c),d={...CB,...l},f=n(u,d),p=s(u)?r():null;super(c,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},_B=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!Vn(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(o,l)}return r.set(o,a),ql(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},IB=()=>typeof window>"u"?null:window,RB=(t,e)=>n=>{n.copyFromChannel=(r,i,s=0)=>{const o=t(s),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=o<0?-o:0;d+o<c&&d<u;d+=1)r[d]=l[d+o]},n.copyToChannel=(r,i,s=0)=>{const o=t(s),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=o<0?-o:0;d+o<c&&d<u;d+=1)l[d+o]=r[d]}},PB=t=>e=>{e.copyFromChannel=(n=>(r,i,s=0)=>{const o=t(s),a=t(i);if(o<e.length)return n.call(e,r,a,o)})(e.copyFromChannel),e.copyToChannel=(n=>(r,i,s=0)=>{const o=t(s),a=t(i);if(o<e.length)return n.call(e,r,a,o)})(e.copyToChannel)},AB=t=>(e,n)=>{const r=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),t(e,"buffer",i=>()=>{const s=i.call(e);return s===r?null:s},i=>s=>i.call(e,s===null?r:s))},NB=(t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let c=0;c<a;c+=1)i.connect(r,0,c)},()=>i.disconnect(r))},YI=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),XI=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},ff=(t,e,n,r)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:s,set:o}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(s),set:r(o)})},MB=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),xB=t=>({...t,channelCount:t.numberOfOutputs}),OB=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},QI=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(r){if(r.code!==9)throw r;QI(t,e,n+1e-7)}},DB=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},LB=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},FB=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},rb=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},eR=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},ib=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},BB=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},UB=t=>{t.start=(e=>(n=0,r=0,i)=>{const s=t.buffer,o=s===null?r:Math.min(s.duration,r);s!==null&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,i)})(t.start)},tR=(t,e)=>{const n=e.createGain();t.connect(n);const r=(i=>()=>{i.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),Jl(t,n),t.stop=(i=>{let s=!1;return(o=0)=>{if(s)try{i.call(t,o)}catch{n.gain.setValueAtTime(0,o)}else i.call(t,o),s=!0}})(t.stop)},Zl=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},jB=h2(ac),WB=S2(ac),VB=N5(mm),nR=new WeakMap,zB=Z5(nR),mo=c5(new Map,new WeakMap),ds=IB(),rR=w3(mo,hs),iR=J5(Qn),Nn=fB(Qn,iR,Ja),$B=C2(rR,kt,Nn),gt=X5(OI),ga=J3(ds),lt=d3(ga),sR=new WeakMap,oR=W5(Zl),hf=T3(ds),aR=a3(hf),cR=c3(ds),HB=l3(ds),Id=I3(ds),$t=K2(p2(AI),y2(jB,WB,pp,VB,mp,Qn,zB,of,kt,ac,eo,Ja,wh),mo,o3(Ey,mp,Qn,kt,_d,eo),hs,gm,gr,I5(pp,Ey,Qn,kt,_d,gt,eo,lt),O5(sR,Qn,Ti),oR,gt,aR,cR,HB,lt,Id),GB=E2($t,$B,hs,rR,gt,lt),lR=new WeakSet,yE=k3(ds),uR=w5(new Uint32Array(1)),dR=RB(uR,hs),fR=PB(uR),qB=_2(lR,mo,gr,yE,ga,bB(yE),dR,fR),vm=b2(mr),hR=hB(iR,cf,Ja),ps=m5(hR),Kl=C3(vm,mo,DB,LB,FB,rb,eR,ib,UB,AB(ff),tR),ms=dB(K5(cf),hR),JB=P2(ps,Kl,kt,ms,Nn),Ri=Y2(m2(MI),sR,xI,X2,a2,c2,l2,u2,d2,by,RI,hf,QI),ZB=R2($t,JB,Ri,In,Kl,gt,lt,Zl),KB=U2($t,j2,hs,In,_3(mr,ff),gt,lt,Nn),YB=a5(ps,JI,kt,ms,Nn),cc=gB(nR),XB=o5($t,Ri,YB,gm,JI,gt,lt,cc),va=S3(ac,cR),QB=NB(In,va),ya=O3(hf,QB),eU=d5(ya,kt,Nn),tU=u5($t,eU,ya,gt,lt),nU=p5(uf,kt,Nn),rU=h5($t,nU,uf,gt,lt,xB),iU=F3(vm,Kl,mr,va),Yl=L3(vm,mo,iU,rb,ib),sU=b5(ps,Yl,kt,ms,Nn),oU=S5($t,Ri,sU,Yl,gt,lt,Zl),pR=B3(gr,ff),aU=C5(pR,kt,Nn),cU=E5($t,aU,pR,gt,lt,cc),lU=A5(ps,ZI,kt,ms,Nn),uU=P5($t,Ri,lU,ZI,gt,lt,cc),mR=U3(gr),dU=B5(ps,mR,kt,ms,Nn),fU=F5($t,Ri,dU,mR,gr,gt,lt,cc),hU=G5(ps,mr,kt,ms,Nn),pU=H5($t,Ri,hU,mr,gt,lt),mU=z3(gm,In,df,gr),sb=pB(mo,mr,df,kB(mr,ga)),gU=s3(Kl,kt,ga,Nn,sb),vU=j3(mU),yU=r3($t,vU,gU,gt,lt,cc),SU=W2(Ri,ya,Yl,df,gr,YI,lt,ff),gR=new WeakMap,bU=y3(KB,SU,oR,lt,gR,Zl),vR=Z3(vm,mo,rb,eR,ib,tR),wU=sB(ps,vR,kt,ms,Nn),kU=iB($t,Ri,vR,wU,gt,lt,Zl),yR=v5(Kl),EU=nB(yR,In,mr,XI,va),ym=tB(yR,In,EU,XI,va,hf,ff),CU=Y3(pp,In,ya,mr,df,ym,gr,mp,YI,va),SR=K3(CU),TU=cB(ps,ya,Yl,mr,SR,kt,ga,ms,Nn,sb),_U=aB($t,Ri,SR,TU,gt,lt,cc),IU=X3(hs),RU=uB(IU,gt,new WeakSet,OB),PU=eB(ya,uf,mr,ym,gr,va),bR=Q3(PU,gr),AU=SB(ps,bR,kt,ms,Nn),NU=yB($t,Ri,bR,AU,gt,lt),MU=_B(ym,kt,Nn),xU=TB($t,In,ym,MU,gt,lt,cc),wR=f3(ds),ob=V5(ds),kR=new WeakMap,OU=Q5(kR,ga),DU=wR?v2(mo,gr,j5(ds),ob,z5(f2),gt,OU,lt,Id,new WeakMap,new WeakMap,wB(Id,ga),ds):void 0,LU=u3(aR,lt),FU=_5(lR,mo,T5,U5,new WeakSet,gt,LU,Iy,Py,dR,fR),BU=i5(DU,GB,qB,ZB,XB,tU,rU,oU,cU,FU,uU,fU,pU,yU,bU,kU,_U,RU,NU,xU),UU=h3($t,$3,gt,lt),jU=m3($t,H3,gt,lt),WU=g3($t,G3,gt,lt),VU=q3(In,lt),zU=v3($t,VU,gt),$U=B2(BU,In,gr,EB,UU,jU,WU,zU,hf),ER=e3(gR),HU=w2(ER),CR=g5(hs),GU=M5(ER),TR=D5(hs),_R=new WeakMap,qU=q5(_R,Ti),JU=x3(CR,hs,In,ya,uf,Yl,mr,df,gr,TR,ob,qU,va),ZU=P3(In,JU,mr,gr,va),KU=r5(ps,CR,Kl,ya,uf,Yl,mr,GU,TR,ob,kt,Id,ga,ms,Nn,sb),YU=Y5(kR),XU=mB(_R),SE=wR?e5(HU,$t,Ri,KU,ZU,Qn,YU,gt,lt,Id,MB,XU,BB,Zl):void 0;var wv;let QU=(wv=class{static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getAudioBufferFromCache(e,n,r){try{const i=await n.match(e);if(i){const s=await i.arrayBuffer();return r.decodeAudioData(s)}return null}catch(i){throw console.error("Failed to get audio data from cache:",i),i}}static async fetchAndCacheAudioBuffer(e,n,r){try{const i=await fetch(e),s=i.clone();n.put(e,s);const o=await i.arrayBuffer();return r.decodeAudioData(o)}catch(i){throw console.error("Failed to fetch and cache audio data:",i),i}}static async getAudioBuffer(e,n){const r=await this.openCache();let i=this.pendingRequests.get(e);return i||await this.getAudioBufferFromCache(e,r,n)||(i=this.fetchAndCacheAudioBuffer(e,r,n),this.pendingRequests.set(e,i),i)}},H(wv,"pendingRequests",new Map),wv);const e4=(t,e)=>{var n=new Uint8Array(t.byteLength+e.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),t.byteLength),n.buffer};function t4(t,e){const n=[];let r=0;fetch(t).then(function(s){if(!s.ok)throw new Error("HTTP error, status = "+s.status);if(!s.body)throw new Error("Missing body");var o=s.body.getReader();let a=new ArrayBuffer(0);function c(){return o.read().then(({value:l,done:u})=>{let d=null;if(l){if(a.byteLength?d=e4(a,l.buffer):(a=l.buffer.slice(0,44),d=l.buffer),e.decodeAudioData(d,function(f){n.push(f),n.length&&i()},function(f){console.log("err(decodeAudioData): "+f)}),u){console.log("done");return}c()}})}c()});function i(){for(;n.length;){let s=n.shift();const o=e.createBufferSource();if(!s)return;o.buffer=s,o.connect(e.destination),r==0&&(r=e.currentTime+.02),o.start(r),r+=o.buffer.duration}}}const n4="data:video/mp2t;base64,aW1wb3J0IE9MQVByb2Nlc3NvciBmcm9tICcuL29sYS50cyc7CmltcG9ydCBGRlQgZnJvbSAnZmZ0LmpzJzsKCmNvbnN0IEJVRkZFUkVEX0JMT0NLX1NJWkUgPSAyMDQ4OwoKZnVuY3Rpb24gZ2VuSGFubldpbmRvdyhsZW5ndGg6IG51bWJlcik6IEZsb2F0MzJBcnJheSB7CiAgICBsZXQgd2luID0gbmV3IEZsb2F0MzJBcnJheShsZW5ndGgpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICB9CiAgICByZXR1cm4gd2luOwp9CgppbnRlcmZhY2UgUGhhc2VWb2NvZGVyTm9kZU9wdGlvbnMgZXh0ZW5kcyBBdWRpb1dvcmtsZXROb2RlT3B0aW9ucyB7CiAgICBwcm9jZXNzb3JPcHRpb25zOiB7CiAgICAgICAgYmxvY2tTaXplOiBudW1iZXI7CiAgICB9Owp9CgpjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgZmZ0U2l6ZTogbnVtYmVyOwogICAgdGltZUN1cnNvcjogbnVtYmVyOwogICAgaGFubldpbmRvdzogRmxvYXQzMkFycmF5OwogICAgZmZ0OiBGRlQ7CiAgICBmcmVxQ29tcGxleEJ1ZmZlcjogYW55OwogICAgZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkOiBhbnk7CiAgICB0aW1lQ29tcGxleEJ1ZmZlcjogYW55OwogICAgbWFnbml0dWRlczogRmxvYXQzMkFycmF5OwogICAgcGVha0luZGV4ZXM6IEludDMyQXJyYXk7CiAgICBuYlBlYWtzOiBudW1iZXI7CgogICAgc3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpIHsKICAgICAgICByZXR1cm4gW3sKICAgICAgICAgICAgbmFtZTogJ3BpdGNoRmFjdG9yJywKICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICB9XTsKICAgIH0KCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zOiBQaGFzZVZvY29kZXJOb2RlT3B0aW9ucykgewogICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgYmxvY2tTaXplOiBCVUZGRVJFRF9CTE9DS19TSVpFLAogICAgICAgIH07CiAgICAgICAgc3VwZXIob3B0aW9ucyk7CgogICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgIHRoaXMudGltZUN1cnNvciA9IDA7CgogICAgICAgIHRoaXMuaGFubldpbmRvdyA9IGdlbkhhbm5XaW5kb3codGhpcy5ibG9ja1NpemUpOwoKICAgICAgICAvLyBwcmVwYXJlIEZGVCBhbmQgcHJlLWFsbG9jYXRlIGJ1ZmZlcnMKICAgICAgICB0aGlzLmZmdCA9IG5ldyBGRlQodGhpcy5mZnRTaXplKTsKICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyID0gdGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCkgYXMgRmxvYXQzMkFycmF5W107CiAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKSBhcyBGbG9hdDMyQXJyYXlbXTsKICAgICAgICB0aGlzLnRpbWVDb21wbGV4QnVmZmVyID0gdGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCk7CiAgICAgICAgdGhpcy5tYWduaXR1ZGVzID0gbmV3IEZsb2F0MzJBcnJheSh0aGlzLmZmdFNpemUgLyAyICsgMSk7CiAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgIHRoaXMubmJQZWFrcyA9IDA7CiAgICB9CgogICAgcHJvY2Vzc09MQShpbnB1dHM6IEZsb2F0MzJBcnJheVtdW10sIG91dHB1dHM6IEZsb2F0MzJBcnJheVtdW10sIHBhcmFtZXRlcnM6IEF1ZGlvUGFyYW1NYXApIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBjb25zdCBwaXRjaEZhY3RvciA9IHBhcmFtZXRlcnMuZ2V0KCdwaXRjaEZhY3RvcicpW3BhcmFtZXRlcnMuZ2V0KCJwaXRjaEZhY3RvciIpLmxlbmd0aCAtIDFdOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGlucHV0c1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CgogICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwoKICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwoKICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgIHRoaXMuZmluZFBlYWtzKCk7CiAgICAgICAgICAgICAgICB0aGlzLnNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpOwoKICAgICAgICAgICAgICAgIHRoaXMuZmZ0LmNvbXBsZXRlU3BlY3RydW0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQpOwogICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICB0aGlzLmZmdC5mcm9tQ29tcGxleEFycmF5KHRoaXMudGltZUNvbXBsZXhCdWZmZXIsIG91dHB1dCk7CgogICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3cob3V0cHV0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2YXRlIGFwcGx5SGFubldpbmRvdyhpbnB1dDogRmxvYXQzMkFycmF5KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJsb2NrU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgaiA9IDA7IGkgPCB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoOyBpKyssIGogKz0gMikgewogICAgICAgICAgICBjb25zdCByZWFsID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltqXTsKICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXNbaV0gPSByZWFsICoqIDIgKyBpbWFnICoqIDI7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgZmluZFBlYWtzKCkgewogICAgICAgIHRoaXMubmJQZWFrcyA9IDA7CiAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgY29uc3QgbWFnID0gdGhpcy5tYWduaXR1ZGVzW2ldOwoKICAgICAgICAgICAgaWYgKHRoaXMubWFnbml0dWRlc1tpIC0gMV0gPj0gbWFnIHx8IHRoaXMubWFnbml0dWRlc1tpIC0gMl0gPj0gbWFnIHx8IHRoaXMubWFnbml0dWRlc1tpICsgMV0gPj0gbWFnIHx8IHRoaXMubWFnbml0dWRlc1tpICsgMl0gPj0gbWFnKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3I6IG51bWJlcikgewogICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkLmZpbGwoMCk7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYlBlYWtzOyBpKyspIHsKICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgY29uc3QgcGVha0luZGV4U2hpZnRlZCA9IE1hdGgucm91bmQocGVha0luZGV4ICogcGl0Y2hGYWN0b3IpOwoKICAgICAgICAgICAgaWYgKHBlYWtJbmRleFNoaWZ0ZWQgPiB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICBsZXQgZW5kSW5kZXggPSAoaSA8IHRoaXMubmJQZWFrcyAtIDEpID8gcGVha0luZGV4ICsgTWF0aC5jZWlsKCh0aGlzLnBlYWtJbmRleGVzW2kgKyAxXSAtIHBlYWtJbmRleCkgLyAyKSA6IHRoaXMuZmZ0U2l6ZTsKCiAgICAgICAgICAgIGZvciAobGV0IGogPSBzdGFydEluZGV4IC0gcGVha0luZGV4OyBqIDwgZW5kSW5kZXggLSBwZWFrSW5kZXg7IGorKykgewogICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXggPSBwZWFrSW5kZXggKyBqOwogICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CgogICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29uc3Qgb21lZ2FEZWx0YSA9IDIgKiBNYXRoLlBJICogKGJpbkluZGV4U2hpZnRlZCAtIGJpbkluZGV4KSAvIHRoaXMuZmZ0U2l6ZTsKICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICBjb25zdCBwaGFzZVNoaWZ0SW1hZyA9IE1hdGguc2luKG9tZWdhRGVsdGEgKiB0aGlzLnRpbWVDdXJzb3IpOwoKICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4UmVhbCA9IGJpbkluZGV4ICogMjsKICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4SW1hZyA9IGluZGV4UmVhbCArIDE7CiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZUltYWcgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4SW1hZ107CgogICAgICAgICAgICAgICAgY29uc3QgdmFsdWVTaGlmdGVkUmVhbCA9IHZhbHVlUmVhbCAqIHBoYXNlU2hpZnRSZWFsIC0gdmFsdWVJbWFnICogcGhhc2VTaGlmdEltYWc7CiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVNoaWZ0ZWRJbWFnID0gdmFsdWVSZWFsICogcGhhc2VTaGlmdEltYWcgKyB2YWx1ZUltYWcgKiBwaGFzZVNoaWZ0UmVhbDsKCiAgICAgICAgICAgICAgICBjb25zdCBpbmRleFNoaWZ0ZWRSZWFsID0gYmluSW5kZXhTaGlmdGVkICogMjsKICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZFJlYWxdICs9IHZhbHVlU2hpZnRlZFJlYWw7CiAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRJbWFnXSArPSB2YWx1ZVNoaWZ0ZWRJbWFnOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgovLyBAdHMtaWdub3JlCnJlZ2lzdGVyUHJvY2Vzc29yKCJwaGFzZS12b2NvZGVyLXByb2Nlc3NvciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7Cg==";var IR=(t=>(t.HTML="HTML",t.Streaming="Streaming",t.Buffer="Buffer",t))(IR||{});class r4{constructor(e){H(this,"context");H(this,"globalGainNode");H(this,"listener");H(this,"prevVolume",1);H(this,"finalizationRegistry");this.context=e||new $U,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.finalizationRegistry=new FinalizationRegistry(n=>{n.cleanup()})}async loadWorklets(){this.context.audioWorklet?await a4(this.context,"phase-vocoder",n4):console.warn("AudioWorklet not supported")}async createSound(e,n="Buffer"){if(e instanceof AudioBuffer)return Promise.resolve(new Hf("",e,this.context,this.globalGainNode,"Buffer"));const r=e;if(n==="HTML"){const i=new Audio;return i.src=r,i.crossOrigin="anonymous",new Hf(r,void 0,this.context,this.globalGainNode,"HTML")}return QU.getAudioBuffer(r,this.context).then(i=>new Hf(r,i,this.context,this.globalGainNode,n))}async createGroup(e){const n=new bE;return e.forEach(r=>n.addSound(r)),n}async createGroupFromUrls(e){const n=new bE;return(await Promise.all(e.map(r=>this.createSound(r)))).forEach(r=>n.addSound(r)),n}async createStream(e){return await t4(e,this.context),new Hf(e,void 0,this.context,this.globalGainNode,"Streaming")}createBiquadFilter(e){const n=this.context.createBiquadFilter();return n.type=e,n}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new o4(this.context);i.play(),e(i)}).catch(r=>{n(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:n,up:r}=e,[i,s,o]=n,[a,c,l]=r;this.listener.forwardX.setValueAtTime(i,this.context.currentTime),this.listener.forwardY.setValueAtTime(s,this.context.currentTime),this.listener.forwardZ.setValueAtTime(o,this.context.currentTime),this.listener.upX.setValueAtTime(a,this.context.currentTime),this.listener.upY.setValueAtTime(c,this.context.currentTime),this.listener.upZ.setValueAtTime(l,this.context.currentTime)}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[n,r,i]=e;this.listener.upX.setValueAtTime(n,this.context.currentTime),this.listener.upY.setValueAtTime(r,this.context.currentTime),this.listener.upZ.setValueAtTime(i,this.context.currentTime)}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[n,r,i]=e;this.listener.forwardX.setValueAtTime(n,this.context.currentTime),this.listener.forwardY.setValueAtTime(r,this.context.currentTime),this.listener.forwardZ.setValueAtTime(i,this.context.currentTime)}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[n,r,i]=e;this.listener.positionX.setValueAtTime(n,this.context.currentTime),this.listener.positionY.setValueAtTime(r,this.context.currentTime),this.listener.positionZ.setValueAtTime(i,this.context.currentTime)}}class Sm{constructor(){H(this,"filters",[])}addFilter(e){this.filters.push(e)}removeFilter(e){this.filters=this.filters.filter(n=>n!==e)}applyFilters(e){return this.filters.reduce((n,r)=>(n.connect(r),r),e),this.filters.length>0?this.filters[this.filters.length-1]:e}}let Hf=class extends Sm{constructor(n,r,i,s,o="Buffer"){super();H(this,"buffer");H(this,"context");H(this,"playbacks",[]);H(this,"globalGainNode");H(this,"_position",[0,0,0]);H(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});H(this,"loopCount",0);H(this,"_playbackRate",1);H(this,"_volume",1);this.url=n,this.type=o,this.buffer=r,this.context=i,this.globalGainNode=s,this._position=[0,0,0]}preplay(){let n;if(this.buffer)n=this.context.createBufferSource(),n.buffer=this.buffer;else{const s=new Audio;s.crossOrigin="anonymous",s.src=this.url,s.preload="auto",n=this.context.createMediaElementSource(s)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new i4(n,r,this.context,this.loopCount);return i.volume=this.volume,i.playbackRate=this.playbackRate,this.filters.forEach(s=>i.addFilter(s)),i.threeDOptions=this.threeDOptions,i.position=this.position,this.playbacks.push(i),[i]}play(){const n=this.preplay();return n.forEach(r=>r.play()),n}stop(){this.playbacks.forEach(n=>n.stop())}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}seek(n){this.playbacks.forEach(r=>r.seek(n))}get duration(){var n;return((n=this.buffer)==null?void 0:n.duration)||0}set position(n){this._threeDOptions.positionX=n[0],this._threeDOptions.positionY=n[1],this._threeDOptions.positionZ=n[2],this.playbacks.forEach(r=>r.position=n)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}get threeDOptions(){return this._threeDOptions}set threeDOptions(n){this._threeDOptions={...this._threeDOptions,...n},this.playbacks.forEach(r=>r.threeDOptions=this._threeDOptions)}loop(n){return n===void 0?this.loopCount:(this.loopCount=n,this.playbacks.forEach(r=>r.sourceLoop=!0),this.loopCount)}addFilter(n){super.addFilter(n),this.playbacks.forEach(r=>r.addFilter(n))}removeFilter(n){super.removeFilter(n),this.playbacks.forEach(r=>r.removeFilter(n))}get volume(){return this._volume}set volume(n){this._volume=n,this.playbacks.forEach(r=>r.volume=n)}isPlaying(){return this.playbacks.some(n=>n.isPlaying())}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.playbacks.forEach(r=>r.playbackRate=n)}};class i4 extends Sm{constructor(n,r,i,s=0){super();H(this,"context");H(this,"source");H(this,"gainNode");H(this,"panner");H(this,"loopCount",0);H(this,"currentLoop",0);H(this,"buffer");H(this,"playing",!1);this.loopCount=s,this.source=n,"buffer"in n&&n.buffer&&(this.buffer=n.buffer),"mediaElement"in n&&n.mediaElement?n.mediaElement.onended=this.handleLoop.bind(this):"onended"in n&&(n.onended=this.handleLoop.bind(this)),this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner),this.panner.connect(this.gainNode),this.refreshFilters()}get duration(){if(!this.buffer)throw new Error("Cannot get duration of a sound that has been cleaned up");return this.buffer.duration}get playbackRate(){if(!this.source)throw new Error("Cannot get playback rate of a sound that has been cleaned up");if("playbackRate"in this.source)return this.source.playbackRate.value;if("mediaElement"in this.source&&this.source.mediaElement)return this.source.mediaElement.playbackRate;throw new Error("Unsupported source type")}set playbackRate(n){if(!this.source)throw new Error("Cannot set playback rate of a sound that has been cleaned up");"playbackRate"in this.source&&(this.source.playbackRate.value=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=n)}handleLoop(){this.buffer?(this.source=this.context.createBufferSource(),this.source.buffer=this.buffer):this.seek(0),this.loopCount==="infinite"||this.currentLoop<this.loopCount?(this.currentLoop++,this.playing&&this.play()):this.playing=!1}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():"start"in this.source&&this.source.start&&this.source.start(),this.playing=!0,[this]}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");return{coneInnerAngle:this.panner.coneInnerAngle,coneOuterAngle:this.panner.coneOuterAngle,coneOuterGain:this.panner.coneOuterGain,distanceModel:this.panner.distanceModel,maxDistance:this.panner.maxDistance,channelCount:this.panner.channelCount,channelCountMode:this.panner.channelCountMode,channelInterpretation:this.panner.channelInterpretation,panningModel:this.panner.panningModel,refDistance:this.panner.refDistance,rolloffFactor:this.panner.rolloffFactor,positionX:this.panner.positionX.value,positionY:this.panner.positionY.value,positionZ:this.panner.positionZ.value,orientationX:this.panner.orientationX.value,orientationY:this.panner.orientationY.value,orientationZ:this.panner.orientationZ.value}}set threeDOptions(n){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");this.panner.coneInnerAngle=n.coneInnerAngle||this.panner.coneInnerAngle,this.panner.coneOuterAngle=n.coneOuterAngle||this.panner.coneOuterAngle,this.panner.coneOuterGain=n.coneOuterGain||this.panner.coneOuterGain,this.panner.distanceModel=n.distanceModel||this.panner.distanceModel,this.panner.maxDistance=n.maxDistance||this.panner.maxDistance,this.panner.channelCount=n.channelCount||this.panner.channelCount,this.panner.channelCountMode=n.channelCountMode||this.panner.channelCountMode,this.panner.channelInterpretation=n.channelInterpretation||this.panner.channelInterpretation,this.panner.panningModel=n.panningModel||this.panner.panningModel,this.panner.refDistance=n.refDistance||this.panner.refDistance,this.panner.rolloffFactor=n.rolloffFactor||this.panner.rolloffFactor,this.panner.positionX.value=n.positionX||this.panner.positionX.value,this.panner.positionY.value=n.positionY||this.panner.positionY.value,this.panner.positionZ.value=n.positionZ||this.panner.positionZ.value,this.panner.orientationX.value=n.orientationX||this.panner.orientationX.value,this.panner.orientationY.value=n.orientationY||this.panner.orientationY.value,this.panner.orientationZ.value=n.orientationZ||this.panner.orientationZ.value}seek(n){if(!this.source||!this.buffer||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");const r=this.isPlaying();this.stop(),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.refreshFilters(),this.source.connect(this.panner).connect(this.gainNode),r&&this.source.start(0,n)}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}set sourceLoop(n){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=n)}fadeIn(n,r="linear"){return new Promise(i=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value;const s=1;switch(this.gainNode.gain.value=0,r){case"exponential":this.gainNode.gain.setValueAtTime(.01,this.context.currentTime),this.gainNode.gain.exponentialRampToValueAtTime(s,this.context.currentTime+n);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(s,this.context.currentTime+n);break}setTimeout(()=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value=s,i()},n*1e3)})}fadeOut(n,r="linear"){return new Promise(i=>{if(!this.gainNode)throw new Error("Cannot fade out a sound that has been cleaned up");switch(this.gainNode.gain.value,r){case"exponential":this.gainNode.gain.exponentialRampToValueAtTime(.01,this.context.currentTime+n);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+n)}setTimeout(()=>i(),n*1e3)})}isPlaying(){if(!this.source)throw new Error("Cannot check if a sound is playing that has been cleaned up");return this.playing}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this.filters.forEach(n=>{n&&n.disconnect()}),this.filters=[]}loop(n){var r;if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(this.source instanceof AudioBufferSourceNode)return n===void 0?this.source.loop===!0?"infinite":0:(this.source.loop=!0,this.source.loopEnd=((r=this.source.buffer)==null?void 0:r.duration)||0,this.source.loopStart=0,this.source.loop===!0?"infinite":0);if("mediaElement"in this.source&&this.source.mediaElement){const i=this.source.mediaElement;return n===void 0||(i.loop=!0),i.loop===!0?"infinite":0}throw new Error("Unsupported source type")}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.isPlaying()&&("stop"in this.source&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this.playing=!1)}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");"suspend"in this.source.context&&this.source.context.suspend()}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");"resume"in this.source.context&&this.source.context.resume()}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,s]=n;this.panner.positionX.setValueAtTime(r,this.context.currentTime),this.panner.positionY.setValueAtTime(i,this.context.currentTime),this.panner.positionZ.setValueAtTime(s,this.context.currentTime)}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}}let bE=class{constructor(){H(this,"sounds",[]);H(this,"_position",[0,0,0]);H(this,"loopCount",0)}get duration(){return this.sounds.map(e=>e.duration).reduce((e,n)=>Math.max(e,n),0)}seek(e){this.sounds.forEach(n=>n.seek&&n.seek(e))}addSound(e){this.sounds.push(e)}preplay(){return this.sounds.reduce((e,n)=>(n.loop&&n.loop(this.loopCount),e.concat(n.preplay())),[])}play(){return this.preplay().map(e=>(e.play(),e))}isPlaying(){return this.sounds.some(e=>e.isPlaying())}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}resume(){this.sounds.forEach(e=>e.resume())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(n=>n.loop&&n.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(n=>n.addFilter(e))}removeFilter(e){this.sounds.forEach(n=>n.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(n=>n.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,n)=>e+n,0)/this.sounds.length}set volume(e){this.sounds.forEach(n=>n.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(n=>n.playbackRate=e)}},s4=class extends Sm{constructor(n,r,i,s=0){super();H(this,"context");H(this,"source");H(this,"gainNode");H(this,"panner");this.source=n,this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!0)}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,s]=n;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=s}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.source;this.source.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(n){}};class o4 extends Sm{constructor(n){super();H(this,"context");H(this,"_position",[0,0,0]);H(this,"loopCount",0);H(this,"prevVolume",1);H(this,"microphoneGainNode");H(this,"streamPlayback");H(this,"stream");H(this,"streamSource");this.context=n,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{this.stream=n,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new s4(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(n=>{console.error("Error initializing microphone stream:",n)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(n){}isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(n){this.streamPlayback&&this.streamPlayback.addFilter(n)}removeFilter(n){this.streamPlayback&&this.streamPlayback.removeFilter(n)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(n){this.streamPlayback&&(this.streamPlayback.volume=n)}get position(){return[0,0,0]}set position(n){}loop(n){return 0}get playbackRate(){return 1}set playbackRate(n){}}async function a4(t,e,n){if(!t.audioWorklet)throw new Error("AudioWorklet not supported");try{return new SE(t,e)}catch{return console.log("Loading worklet from url",n),console.log("Loading worklet from url",n),await t.audioWorklet.addModule(n),new SE(t,e)}}const c4="https://mongoose.world:9080/?url=";class l4 extends po{constructor(){super(...arguments);H(this,"packageName","Client.Media");H(this,"sounds",{});H(this,"defaultUrl","")}handleDefault(n){this.defaultUrl=n}async handleLoad(n){const r=(n.url||this.defaultUrl)+n.name,i=n.url+n.name;if(!this.sounds[i]){let o=await this.client.cacophony.createSound(r);o.key=i,this.sounds[i]=o}}async handlePlay(n){let r=(n.url||this.defaultUrl)+n.name;n.key=n.key||r;let i=this.sounds[n.key];if((!i||i.url!==r)&&(n.type==="music"?(r=c4+encodeURIComponent(r),i=await this.client.cacophony.createSound(r,IR.HTML)):i=await this.client.cacophony.createSound(r)),n.volume!==void 0&&(i.volume=n.volume/100),n.loops!==void 0&&i.loop&&i.loop(n.loops===-1?"infinite":n.loops),n.start&&i.seek(n.start),n.end&&setTimeout(()=>{i.stop()},n.end),n.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[n.position[0],n.position[1],n.position[2]]),n.priority){for(let s in this.sounds){const o=this.sounds[s];o.priority&&o.priority<n.priority&&o.stop()}i.priority=n.priority}if(!i.isPlaying()){const s=i.play()[0];n.fadein&&s.fadeIn(n.fadein),n.fadeout&&s.fadeOut(n.fadeout)}this.sounds[n.key]=i,i.key=n.key}handleStop(n){n.name&&this.soundsByName(n.name).forEach(r=>r.stop()),n.type&&this.soundsByType(n.type).forEach(r=>r.stop()),n.tag&&this.soundsByTag(n.tag).forEach(r=>r.stop()),n.key&&this.soundsByKey(n.key).forEach(r=>r.stop()),!n.name&&!n.type&&!n.tag&&!n.key&&this.allSounds.forEach(r=>r.stop())}handleListenerPosition(n){var r;(r=n.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=n.position)}handleListenerOrientation(n){n.up&&n.up.length&&(this.client.cacophony.listenerUpOrientation=n.up),n.forward&&n.forward.length&&(this.client.cacophony.listenerForwardOrientation=n.forward)}soundsByName(n){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(n))}soundsByKey(n){return Object.values(this.sounds).filter(r=>r.key===n)}soundsByTag(n){return Object.values(this.sounds).filter(r=>r.tag===n)}soundsByType(n){return Object.values(this.sounds).filter(r=>r.mediaType===n)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(n=>n.stop()),this.sounds={}}}class u4 extends po{constructor(){super(...arguments);H(this,"packageName","Client.Speech")}handleSpeak(n){const r=new SpeechSynthesisUtterance(n.text);r.rate=n.rate,r.pitch=n.pitch,r.volume=n.volume,speechSynthesis.speak(r)}}class d4 extends po{constructor(){super(...arguments);H(this,"packageName","Comm.Channel");H(this,"channels",[])}handleList(n){this.channels=n}sendList(){this.sendData("List")}handleText(n){n.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${n.talker}`,`${n.text}`))}}class f4 extends po{constructor(){super(...arguments);H(this,"packageName","Comm.LiveKit")}handleroom_token(n){this.client.worldData.liveKitTokens.push(n.token),this.client.emit("livekitToken",n.token)}handleroom_leave(n){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==n.token),this.client.emit("livekitLeave",n.token)}}class h4 extends po{constructor(){super(...arguments);H(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}}class p4 extends po{constructor(){super(...arguments);H(this,"packageName","Core.Supports")}sendSet(){const n=Object.values(this.client.gmcpHandlers).map(r=>r.packageName+" "+r.packageVersion.toString());this.sendData("Set",n)}}const wc=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,RR=new Set,Ay=typeof process=="object"&&process?process:{},PR=(t,e,n,r)=>{typeof Ay.emitWarning=="function"?Ay.emitWarning(t,e,n,r):console.error(`[${n}] ${e}: ${t}`)};let Sp=globalThis.AbortController,wE=globalThis.AbortSignal;var J1;if(typeof Sp>"u"){wE=class{constructor(){H(this,"onabort");H(this,"_onabort",[]);H(this,"reason");H(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},Sp=class{constructor(){H(this,"signal",new wE);e()}abort(r){var i,s;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const o of this.signal._onabort)o(r);(s=(i=this.signal).onabort)==null||s.call(i,r)}}};let t=((J1=Ay.env)==null?void 0:J1.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{t&&(t=!1,PR("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const m4=t=>!RR.has(t),Co=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),AR=t=>Co(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?kh:null:null;class kh extends Array{constructor(e){super(e),this.fill(0)}}var gl;const Ia=class Ia{constructor(e,n){H(this,"heap");H(this,"length");if(!x(Ia,gl))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(e),this.length=0}static create(e){const n=AR(e);if(!n)return[];Ce(Ia,gl,!0);const r=new Ia(e,n);return Ce(Ia,gl,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};gl=new WeakMap,Me(Ia,gl,!1);let Ny=Ia;var ei,vr,ti,ni,vl,Kt,ri,qt,St,Ae,$n,yr,On,fn,ii,hn,si,oi,Sr,ai,Lo,Hn,Gd,xy,Oa,Ts,qd,br,Zp,NR,Da,yl,Jd,Di,To,Li,_o,Zd,Oy,Sl,Eh,bl,Ch,ot,yt,Kd,Dy,La,Fu;const Tw=class Tw{constructor(e){Me(this,Gd);Me(this,Zp);Me(this,Di);Me(this,Li);Me(this,Zd);Me(this,Sl);Me(this,bl);Me(this,ot);Me(this,Kd);Me(this,La);Me(this,ei,void 0);Me(this,vr,void 0);Me(this,ti,void 0);Me(this,ni,void 0);Me(this,vl,void 0);H(this,"ttl");H(this,"ttlResolution");H(this,"ttlAutopurge");H(this,"updateAgeOnGet");H(this,"updateAgeOnHas");H(this,"allowStale");H(this,"noDisposeOnSet");H(this,"noUpdateTTL");H(this,"maxEntrySize");H(this,"sizeCalculation");H(this,"noDeleteOnFetchRejection");H(this,"noDeleteOnStaleGet");H(this,"allowStaleOnFetchAbort");H(this,"allowStaleOnFetchRejection");H(this,"ignoreFetchAbort");Me(this,Kt,void 0);Me(this,ri,void 0);Me(this,qt,void 0);Me(this,St,void 0);Me(this,Ae,void 0);Me(this,$n,void 0);Me(this,yr,void 0);Me(this,On,void 0);Me(this,fn,void 0);Me(this,ii,void 0);Me(this,hn,void 0);Me(this,si,void 0);Me(this,oi,void 0);Me(this,Sr,void 0);Me(this,ai,void 0);Me(this,Lo,void 0);Me(this,Hn,void 0);Me(this,Oa,()=>{});Me(this,Ts,()=>{});Me(this,qd,()=>{});Me(this,br,()=>!1);Me(this,Da,e=>{});Me(this,yl,(e,n,r)=>{});Me(this,Jd,(e,n,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:s,updateAgeOnGet:o,updateAgeOnHas:a,allowStale:c,dispose:l,disposeAfter:u,noDisposeOnSet:d,noUpdateTTL:f,maxSize:h=0,maxEntrySize:p=0,sizeCalculation:g,fetchMethod:y,noDeleteOnFetchRejection:m,noDeleteOnStaleGet:v,allowStaleOnFetchRejection:w,allowStaleOnFetchAbort:_,ignoreFetchAbort:C}=e;if(n!==0&&!Co(n))throw new TypeError("max option must be a nonnegative integer");const k=n?AR(n):Array;if(!k)throw new Error("invalid max value: "+n);if(Ce(this,ei,n),Ce(this,vr,h),this.maxEntrySize=p||x(this,vr),this.sizeCalculation=g,this.sizeCalculation){if(!x(this,vr)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(y!==void 0&&typeof y!="function")throw new TypeError("fetchMethod must be a function if specified");if(Ce(this,vl,y),Ce(this,Lo,!!y),Ce(this,qt,new Map),Ce(this,St,new Array(n).fill(void 0)),Ce(this,Ae,new Array(n).fill(void 0)),Ce(this,$n,new k(n)),Ce(this,yr,new k(n)),Ce(this,On,0),Ce(this,fn,0),Ce(this,ii,Ny.create(n)),Ce(this,Kt,0),Ce(this,ri,0),typeof l=="function"&&Ce(this,ti,l),typeof u=="function"?(Ce(this,ni,u),Ce(this,hn,[])):(Ce(this,ni,void 0),Ce(this,hn,void 0)),Ce(this,ai,!!x(this,ti)),Ce(this,Hn,!!x(this,ni)),this.noDisposeOnSet=!!d,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!m,this.allowStaleOnFetchRejection=!!w,this.allowStaleOnFetchAbort=!!_,this.ignoreFetchAbort=!!C,this.maxEntrySize!==0){if(x(this,vr)!==0&&!Co(x(this,vr)))throw new TypeError("maxSize must be a positive integer if specified");if(!Co(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");ye(this,Zp,NR).call(this)}if(this.allowStale=!!c,this.noDeleteOnStaleGet=!!v,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!a,this.ttlResolution=Co(i)||i===0?i:1,this.ttlAutopurge=!!s,this.ttl=r||0,this.ttl){if(!Co(this.ttl))throw new TypeError("ttl must be a positive integer if specified");ye(this,Gd,xy).call(this)}if(x(this,ei)===0&&this.ttl===0&&x(this,vr)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!x(this,ei)&&!x(this,vr)){const T="LRU_CACHE_UNBOUNDED";m4(T)&&(RR.add(T),PR("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",T,Tw))}}static unsafeExposeInternals(e){return{starts:x(e,oi),ttls:x(e,Sr),sizes:x(e,si),keyMap:x(e,qt),keyList:x(e,St),valList:x(e,Ae),next:x(e,$n),prev:x(e,yr),get head(){return x(e,On)},get tail(){return x(e,fn)},free:x(e,ii),isBackgroundFetch:n=>{var r;return ye(r=e,ot,yt).call(r,n)},backgroundFetch:(n,r,i,s)=>{var o;return ye(o=e,bl,Ch).call(o,n,r,i,s)},moveToTail:n=>{var r;return ye(r=e,La,Fu).call(r,n)},indexes:n=>{var r;return ye(r=e,Di,To).call(r,n)},rindexes:n=>{var r;return ye(r=e,Li,_o).call(r,n)},isStale:n=>{var r;return x(r=e,br).call(r,n)}}}get max(){return x(this,ei)}get maxSize(){return x(this,vr)}get calculatedSize(){return x(this,ri)}get size(){return x(this,Kt)}get fetchMethod(){return x(this,vl)}get dispose(){return x(this,ti)}get disposeAfter(){return x(this,ni)}getRemainingTTL(e){return x(this,qt).has(e)?1/0:0}*entries(){for(const e of ye(this,Di,To).call(this))x(this,Ae)[e]!==void 0&&x(this,St)[e]!==void 0&&!ye(this,ot,yt).call(this,x(this,Ae)[e])&&(yield[x(this,St)[e],x(this,Ae)[e]])}*rentries(){for(const e of ye(this,Li,_o).call(this))x(this,Ae)[e]!==void 0&&x(this,St)[e]!==void 0&&!ye(this,ot,yt).call(this,x(this,Ae)[e])&&(yield[x(this,St)[e],x(this,Ae)[e]])}*keys(){for(const e of ye(this,Di,To).call(this)){const n=x(this,St)[e];n!==void 0&&!ye(this,ot,yt).call(this,x(this,Ae)[e])&&(yield n)}}*rkeys(){for(const e of ye(this,Li,_o).call(this)){const n=x(this,St)[e];n!==void 0&&!ye(this,ot,yt).call(this,x(this,Ae)[e])&&(yield n)}}*values(){for(const e of ye(this,Di,To).call(this))x(this,Ae)[e]!==void 0&&!ye(this,ot,yt).call(this,x(this,Ae)[e])&&(yield x(this,Ae)[e])}*rvalues(){for(const e of ye(this,Li,_o).call(this))x(this,Ae)[e]!==void 0&&!ye(this,ot,yt).call(this,x(this,Ae)[e])&&(yield x(this,Ae)[e])}[Symbol.iterator](){return this.entries()}find(e,n={}){for(const r of ye(this,Di,To).call(this)){const i=x(this,Ae)[r],s=ye(this,ot,yt).call(this,i)?i.__staleWhileFetching:i;if(s!==void 0&&e(s,x(this,St)[r],this))return this.get(x(this,St)[r],n)}}forEach(e,n=this){for(const r of ye(this,Di,To).call(this)){const i=x(this,Ae)[r],s=ye(this,ot,yt).call(this,i)?i.__staleWhileFetching:i;s!==void 0&&e.call(n,s,x(this,St)[r],this)}}rforEach(e,n=this){for(const r of ye(this,Li,_o).call(this)){const i=x(this,Ae)[r],s=ye(this,ot,yt).call(this,i)?i.__staleWhileFetching:i;s!==void 0&&e.call(n,s,x(this,St)[r],this)}}purgeStale(){let e=!1;for(const n of ye(this,Li,_o).call(this,{allowStale:!0}))x(this,br).call(this,n)&&(this.delete(x(this,St)[n]),e=!0);return e}info(e){const n=x(this,qt).get(e);if(n===void 0)return;const r=x(this,Ae)[n],i=ye(this,ot,yt).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const s={value:i};if(x(this,Sr)&&x(this,oi)){const o=x(this,Sr)[n],a=x(this,oi)[n];if(o&&a){const c=o-(wc.now()-a);s.ttl=c,s.start=Date.now()}}return x(this,si)&&(s.size=x(this,si)[n]),s}dump(){const e=[];for(const n of ye(this,Di,To).call(this,{allowStale:!0})){const r=x(this,St)[n],i=x(this,Ae)[n],s=ye(this,ot,yt).call(this,i)?i.__staleWhileFetching:i;if(s===void 0||r===void 0)continue;const o={value:s};if(x(this,Sr)&&x(this,oi)){o.ttl=x(this,Sr)[n];const a=wc.now()-x(this,oi)[n];o.start=Math.floor(Date.now()-a)}x(this,si)&&(o.size=x(this,si)[n]),e.unshift([r,o])}return e}load(e){this.clear();for(const[n,r]of e){if(r.start){const i=Date.now()-r.start;r.start=wc.now()-i}this.set(n,r.value,r)}}set(e,n,r={}){var f,h,p,g,y;if(n===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:s,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:c}=r;let{noUpdateTTL:l=this.noUpdateTTL}=r;const u=x(this,Jd).call(this,e,n,r.size||0,a);if(this.maxEntrySize&&u>this.maxEntrySize)return c&&(c.set="miss",c.maxEntrySizeExceeded=!0),this.delete(e),this;let d=x(this,Kt)===0?void 0:x(this,qt).get(e);if(d===void 0)d=x(this,Kt)===0?x(this,fn):x(this,ii).length!==0?x(this,ii).pop():x(this,Kt)===x(this,ei)?ye(this,Sl,Eh).call(this,!1):x(this,Kt),x(this,St)[d]=e,x(this,Ae)[d]=n,x(this,qt).set(e,d),x(this,$n)[x(this,fn)]=d,x(this,yr)[d]=x(this,fn),Ce(this,fn,d),Tf(this,Kt)._++,x(this,yl).call(this,d,u,c),c&&(c.set="add"),l=!1;else{ye(this,La,Fu).call(this,d);const m=x(this,Ae)[d];if(n!==m){if(x(this,Lo)&&ye(this,ot,yt).call(this,m)){m.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:v}=m;v!==void 0&&!o&&(x(this,ai)&&((f=x(this,ti))==null||f.call(this,v,e,"set")),x(this,Hn)&&((h=x(this,hn))==null||h.push([v,e,"set"])))}else o||(x(this,ai)&&((p=x(this,ti))==null||p.call(this,m,e,"set")),x(this,Hn)&&((g=x(this,hn))==null||g.push([m,e,"set"])));if(x(this,Da).call(this,d),x(this,yl).call(this,d,u,c),x(this,Ae)[d]=n,c){c.set="replace";const v=m&&ye(this,ot,yt).call(this,m)?m.__staleWhileFetching:m;v!==void 0&&(c.oldValue=v)}}else c&&(c.set="update")}if(i!==0&&!x(this,Sr)&&ye(this,Gd,xy).call(this),x(this,Sr)&&(l||x(this,qd).call(this,d,i,s),c&&x(this,Ts).call(this,c,d)),!o&&x(this,Hn)&&x(this,hn)){const m=x(this,hn);let v;for(;v=m==null?void 0:m.shift();)(y=x(this,ni))==null||y.call(this,...v)}return this}pop(){var e;try{for(;x(this,Kt);){const n=x(this,Ae)[x(this,On)];if(ye(this,Sl,Eh).call(this,!0),ye(this,ot,yt).call(this,n)){if(n.__staleWhileFetching)return n.__staleWhileFetching}else if(n!==void 0)return n}}finally{if(x(this,Hn)&&x(this,hn)){const n=x(this,hn);let r;for(;r=n==null?void 0:n.shift();)(e=x(this,ni))==null||e.call(this,...r)}}}has(e,n={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=n,s=x(this,qt).get(e);if(s!==void 0){const o=x(this,Ae)[s];if(ye(this,ot,yt).call(this,o)&&o.__staleWhileFetching===void 0)return!1;if(x(this,br).call(this,s))i&&(i.has="stale",x(this,Ts).call(this,i,s));else return r&&x(this,Oa).call(this,s),i&&(i.has="hit",x(this,Ts).call(this,i,s)),!0}else i&&(i.has="miss");return!1}peek(e,n={}){const{allowStale:r=this.allowStale}=n,i=x(this,qt).get(e);if(i===void 0||!r&&x(this,br).call(this,i))return;const s=x(this,Ae)[i];return ye(this,ot,yt).call(this,s)?s.__staleWhileFetching:s}async fetch(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:g,forceRefresh:y=!1,status:m,signal:v}=n;if(!x(this,Lo))return m&&(m.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:s,status:m});const w={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:s,ttl:o,noDisposeOnSet:a,size:c,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:p,ignoreFetchAbort:h,status:m,signal:v};let _=x(this,qt).get(e);if(_===void 0){m&&(m.fetch="miss");const C=ye(this,bl,Ch).call(this,e,_,w,g);return C.__returned=C}else{const C=x(this,Ae)[_];if(ye(this,ot,yt).call(this,C)){const M=r&&C.__staleWhileFetching!==void 0;return m&&(m.fetch="inflight",M&&(m.returnedStale=!0)),M?C.__staleWhileFetching:C.__returned=C}const k=x(this,br).call(this,_);if(!y&&!k)return m&&(m.fetch="hit"),ye(this,La,Fu).call(this,_),i&&x(this,Oa).call(this,_),m&&x(this,Ts).call(this,m,_),C;const T=ye(this,bl,Ch).call(this,e,_,w,g),A=T.__staleWhileFetching!==void 0&&r;return m&&(m.fetch=k?"stale":"refresh",A&&k&&(m.returnedStale=!0)),A?T.__staleWhileFetching:T.__returned=T}}get(e,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:o}=n,a=x(this,qt).get(e);if(a!==void 0){const c=x(this,Ae)[a],l=ye(this,ot,yt).call(this,c);return o&&x(this,Ts).call(this,o,a),x(this,br).call(this,a)?(o&&(o.get="stale"),l?(o&&r&&c.__staleWhileFetching!==void 0&&(o.returnedStale=!0),r?c.__staleWhileFetching:void 0):(s||this.delete(e),o&&r&&(o.returnedStale=!0),r?c:void 0)):(o&&(o.get="hit"),l?c.__staleWhileFetching:(ye(this,La,Fu).call(this,a),i&&x(this,Oa).call(this,a),c))}else o&&(o.get="miss")}delete(e){var r,i,s,o;let n=!1;if(x(this,Kt)!==0){const a=x(this,qt).get(e);if(a!==void 0)if(n=!0,x(this,Kt)===1)this.clear();else{x(this,Da).call(this,a);const c=x(this,Ae)[a];if(ye(this,ot,yt).call(this,c)?c.__abortController.abort(new Error("deleted")):(x(this,ai)||x(this,Hn))&&(x(this,ai)&&((r=x(this,ti))==null||r.call(this,c,e,"delete")),x(this,Hn)&&((i=x(this,hn))==null||i.push([c,e,"delete"]))),x(this,qt).delete(e),x(this,St)[a]=void 0,x(this,Ae)[a]=void 0,a===x(this,fn))Ce(this,fn,x(this,yr)[a]);else if(a===x(this,On))Ce(this,On,x(this,$n)[a]);else{const l=x(this,yr)[a];x(this,$n)[l]=x(this,$n)[a];const u=x(this,$n)[a];x(this,yr)[u]=x(this,yr)[a]}Tf(this,Kt)._--,x(this,ii).push(a)}}if(x(this,Hn)&&((s=x(this,hn))!=null&&s.length)){const a=x(this,hn);let c;for(;c=a==null?void 0:a.shift();)(o=x(this,ni))==null||o.call(this,...c)}return n}clear(){var e,n,r;for(const i of ye(this,Li,_o).call(this,{allowStale:!0})){const s=x(this,Ae)[i];if(ye(this,ot,yt).call(this,s))s.__abortController.abort(new Error("deleted"));else{const o=x(this,St)[i];x(this,ai)&&((e=x(this,ti))==null||e.call(this,s,o,"delete")),x(this,Hn)&&((n=x(this,hn))==null||n.push([s,o,"delete"]))}}if(x(this,qt).clear(),x(this,Ae).fill(void 0),x(this,St).fill(void 0),x(this,Sr)&&x(this,oi)&&(x(this,Sr).fill(0),x(this,oi).fill(0)),x(this,si)&&x(this,si).fill(0),Ce(this,On,0),Ce(this,fn,0),x(this,ii).length=0,Ce(this,ri,0),Ce(this,Kt,0),x(this,Hn)&&x(this,hn)){const i=x(this,hn);let s;for(;s=i==null?void 0:i.shift();)(r=x(this,ni))==null||r.call(this,...s)}}};ei=new WeakMap,vr=new WeakMap,ti=new WeakMap,ni=new WeakMap,vl=new WeakMap,Kt=new WeakMap,ri=new WeakMap,qt=new WeakMap,St=new WeakMap,Ae=new WeakMap,$n=new WeakMap,yr=new WeakMap,On=new WeakMap,fn=new WeakMap,ii=new WeakMap,hn=new WeakMap,si=new WeakMap,oi=new WeakMap,Sr=new WeakMap,ai=new WeakMap,Lo=new WeakMap,Hn=new WeakMap,Gd=new WeakSet,xy=function(){const e=new kh(x(this,ei)),n=new kh(x(this,ei));Ce(this,Sr,e),Ce(this,oi,n),Ce(this,qd,(s,o,a=wc.now())=>{if(n[s]=o!==0?a:0,e[s]=o,o!==0&&this.ttlAutopurge){const c=setTimeout(()=>{x(this,br).call(this,s)&&this.delete(x(this,St)[s])},o+1);c.unref&&c.unref()}}),Ce(this,Oa,s=>{n[s]=e[s]!==0?wc.now():0}),Ce(this,Ts,(s,o)=>{if(e[o]){const a=e[o],c=n[o];if(!a||!c)return;s.ttl=a,s.start=c,s.now=r||i();const l=s.now-c;s.remainingTTL=a-l}});let r=0;const i=()=>{const s=wc.now();if(this.ttlResolution>0){r=s;const o=setTimeout(()=>r=0,this.ttlResolution);o.unref&&o.unref()}return s};this.getRemainingTTL=s=>{const o=x(this,qt).get(s);if(o===void 0)return 0;const a=e[o],c=n[o];if(!a||!c)return 1/0;const l=(r||i())-c;return a-l},Ce(this,br,s=>{const o=n[s],a=e[s];return!!a&&!!o&&(r||i())-o>a})},Oa=new WeakMap,Ts=new WeakMap,qd=new WeakMap,br=new WeakMap,Zp=new WeakSet,NR=function(){const e=new kh(x(this,ei));Ce(this,ri,0),Ce(this,si,e),Ce(this,Da,n=>{Ce(this,ri,x(this,ri)-e[n]),e[n]=0}),Ce(this,Jd,(n,r,i,s)=>{if(ye(this,ot,yt).call(this,r))return 0;if(!Co(i))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(i=s(r,n),!Co(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Ce(this,yl,(n,r,i)=>{if(e[n]=r,x(this,vr)){const s=x(this,vr)-e[n];for(;x(this,ri)>s;)ye(this,Sl,Eh).call(this,!0)}Ce(this,ri,x(this,ri)+e[n]),i&&(i.entrySize=r,i.totalCalculatedSize=x(this,ri))})},Da=new WeakMap,yl=new WeakMap,Jd=new WeakMap,Di=new WeakSet,To=function*({allowStale:e=this.allowStale}={}){if(x(this,Kt))for(let n=x(this,fn);!(!ye(this,Zd,Oy).call(this,n)||((e||!x(this,br).call(this,n))&&(yield n),n===x(this,On)));)n=x(this,yr)[n]},Li=new WeakSet,_o=function*({allowStale:e=this.allowStale}={}){if(x(this,Kt))for(let n=x(this,On);!(!ye(this,Zd,Oy).call(this,n)||((e||!x(this,br).call(this,n))&&(yield n),n===x(this,fn)));)n=x(this,$n)[n]},Zd=new WeakSet,Oy=function(e){return e!==void 0&&x(this,qt).get(x(this,St)[e])===e},Sl=new WeakSet,Eh=function(e){var s,o;const n=x(this,On),r=x(this,St)[n],i=x(this,Ae)[n];return x(this,Lo)&&ye(this,ot,yt).call(this,i)?i.__abortController.abort(new Error("evicted")):(x(this,ai)||x(this,Hn))&&(x(this,ai)&&((s=x(this,ti))==null||s.call(this,i,r,"evict")),x(this,Hn)&&((o=x(this,hn))==null||o.push([i,r,"evict"]))),x(this,Da).call(this,n),e&&(x(this,St)[n]=void 0,x(this,Ae)[n]=void 0,x(this,ii).push(n)),x(this,Kt)===1?(Ce(this,On,Ce(this,fn,0)),x(this,ii).length=0):Ce(this,On,x(this,$n)[n]),x(this,qt).delete(r),Tf(this,Kt)._--,n},bl=new WeakSet,Ch=function(e,n,r,i){const s=n===void 0?void 0:x(this,Ae)[n];if(ye(this,ot,yt).call(this,s))return s;const o=new Sp,{signal:a}=r;a==null||a.addEventListener("abort",()=>o.abort(a.reason),{signal:o.signal});const c={signal:o.signal,options:r,context:i},l=(g,y=!1)=>{const{aborted:m}=o.signal,v=r.ignoreFetchAbort&&g!==void 0;if(r.status&&(m&&!y?(r.status.fetchAborted=!0,r.status.fetchError=o.signal.reason,v&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),m&&!v&&!y)return d(o.signal.reason);const w=h;return x(this,Ae)[n]===h&&(g===void 0?w.__staleWhileFetching?x(this,Ae)[n]=w.__staleWhileFetching:this.delete(e):(r.status&&(r.status.fetchUpdated=!0),this.set(e,g,c.options))),g},u=g=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=g),d(g)),d=g=>{const{aborted:y}=o.signal,m=y&&r.allowStaleOnFetchAbort,v=m||r.allowStaleOnFetchRejection,w=v||r.noDeleteOnFetchRejection,_=h;if(x(this,Ae)[n]===h&&(!w||_.__staleWhileFetching===void 0?this.delete(e):m||(x(this,Ae)[n]=_.__staleWhileFetching)),v)return r.status&&_.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),_.__staleWhileFetching;if(_.__returned===_)throw g},f=(g,y)=>{var v;const m=(v=x(this,vl))==null?void 0:v.call(this,e,s,c);m&&m instanceof Promise&&m.then(w=>g(w===void 0?void 0:w),y),o.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(g(void 0),r.allowStaleOnFetchAbort&&(g=w=>l(w,!0)))})};r.status&&(r.status.fetchDispatched=!0);const h=new Promise(f).then(l,u),p=Object.assign(h,{__abortController:o,__staleWhileFetching:s,__returned:void 0});return n===void 0?(this.set(e,p,{...c.options,status:void 0}),n=x(this,qt).get(e)):x(this,Ae)[n]=p,p},ot=new WeakSet,yt=function(e){if(!x(this,Lo))return!1;const n=e;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof Sp},Kd=new WeakSet,Dy=function(e,n){x(this,yr)[n]=e,x(this,$n)[e]=n},La=new WeakSet,Fu=function(e){e!==x(this,fn)&&(e===x(this,On)?Ce(this,On,x(this,$n)[e]):ye(this,Kd,Dy).call(this,x(this,yr)[e],x(this,$n)[e]),ye(this,Kd,Dy).call(this,x(this,fn),e),Ce(this,fn,e))};let My=Tw;function g4(t){const e=t.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+t+"`"),null;const n=e[1],r=e[2],i={},s=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let o;for(;o=s.exec(e[3]);){const a=o[1]||o[3],c=o[2]||o[4];a in i?console.log(`Invalid message format: duplicate key ${a} detected`):i[a]=c}return{name:n,authKey:r,keyvals:i}}function kE(t){const e=t.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+t+"`"),null;const n=e[1]||e[4],r=void 0,i=e[2],s=e[3],o={};return o[i]=s,{name:n,authKey:r,keyvals:o}}function Ly(){return(Math.random()+1).toString(36).substring(3,9)}class Xl{constructor(e){H(this,"packageName");H(this,"minVersion",1);H(this,"maxVersion",1);H(this,"packageVersion",0);H(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,n){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,n)}}class v4 extends Xl{constructor(){super(...arguments);H(this,"packageName","mcp-negotiate");H(this,"minVersion",2);H(this,"maxVersion",2)}handle(n){switch(n.name){}}sendNegotiate(){var n,r;for(const i of Object.values(this.client.mcpHandlers)){let s=(n=i.minVersion)==null?void 0:n.toFixed(1),o=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":s,"max-version":o})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class y4 extends Xl{constructor(){super(...arguments);H(this,"packageName","dns-com-awns-status")}handle(n){console.log(n),this.client.emit("statustext",n.keyvals.text)}}class S4 extends Xl{constructor(n){super(n);H(this,"packageName","dns-org-mud-moo-simpleedit");H(this,"sessions",{});H(this,"clientId");this.clientId=Ly()}handle(n){if(n.name==="dns-org-mud-moo-simpleedit-content"){const r={name:n.keyvals.name,reference:n.keyvals.reference,type:n.keyvals.type,contents:[]};this.sessions[n.keyvals["_data-tag"]]=r}else console.log(`Unexpected simpleedit message ${n}`)}handleMultiline(n){"content"in n.keyvals?this.sessions[n.name].contents.push(n.keyvals.content):console.log(`Unexpected simpleedit ML ${n}`)}closeMultiline(n){console.log(`Closing multiline ${n.name}`),this.client.openEditorWindow(this.sessions[n.name])}shutdown(){new BroadcastChannel("editor").postMessage({type:"shutdown"})}}class b4 extends Xl{constructor(){super(...arguments);H(this,"packageName","dns-com-awns-getset");H(this,"id",1);H(this,"cache",new My({max:10}));H(this,"LocalCache",{})}handle(n){switch(n.name){case"dns-com-awns-getset-ack":const r=this.cache.get(n.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${n.keyvals.id}`);break}const i=n.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(n){const r=(this.id++).toString();this.cache.set(r,n),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:n})}sendSet(n,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:n,value:r})}sendDrop(n){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:n})}}class w4 extends Xl{constructor(){super(...arguments);H(this,"packageName","dns-com-vmoo-userlist");H(this,"maxVersion",1.1);H(this,"player");H(this,"fields",["Object","Name","Icon"]);H(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);H(this,"players",[])}handle(n){switch(n.name){case"dns-com-vmoo-userlist-you":this.player=n.keyvals.nr;break}}handleMultiline(n){if("fields"in n.keyvals&&(this.fields=Kr(n.keyvals.fields.trim())),"icons"in n.keyvals&&(this.icons=Kr(n.keyvals.icons.trim())),"d"in n.keyvals){const s=n.keyvals.d[0];switch(s){case"=":var r=Kr(n.keyvals.d.slice(1));this.players=r.map(a=>this.playerFromArray(a));break;case"+":this.players.push(this.playerFromArray(Kr(n.keyvals.d.slice(1))));break;case"-":var i=Kr(n.keyvals.d.slice(1));this.players=this.players.filter(a=>!i.includes(a.Object));break;case"*":const o=this.playerFromArray(Kr(n.keyvals.d.slice(1)));this.updatePlayer(o);break;case"<":i=Kr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!0,this.players[c]=a)});break;case">":i=Kr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!1,this.players[c]=a)});break;case"[":i=Kr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!0,this.players[c]=a)});break;case"]":i=Kr(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!1,this.players[c]=a)});break;default:console.log(`Unknown userlist mode ${s} in ${n.keyvals.d}`);break}this.update()}}updatePlayer(n){const r=this.players.findIndex(i=>i.Object===n.Object);r!==-1?this.players[r]=n:this.players.push(n)}update(){this.players.sort((r,i)=>n(i)-n(r)),this.client.emit("userlist",this.players);function n(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(n){const r={};return n.forEach((i,s)=>{r[this.fields[s]]=i}),r.away=!1,r.idle=!1,r}}function Kr(t){t=t.slice(1,-1);let e=[],n="",r=0;for(let s=0;s<t.length;s++){const o=t[s];if(o==="{")r++;else if(o==="}")r--;else if(o===","&&r===0){i(),n="";continue}n+=o}return n.length>0&&i(),e;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?e.push(Kr(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?e.push(n.slice(1,-1)):e.push(n):e.push(Number(n))}}class k4 extends Xl{constructor(){super(...arguments);H(this,"packageName","dns-com-awns-ping");H(this,"id",1)}handle(n){switch(n.name){case"dns-com-awns-ping":this.send("reply",n.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}function E4({onlyFirst:t=!1}={}){const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,t?void 0:"g")}const C4=E4();function T4(t){if(typeof t!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof t}\``);return t.replace(C4,"")}var Fy=(t=>(t.Off="off",t.Unfocused="unfocused",t.All="all",t))(Fy||{}),ao=(t=>(t.SetGeneral="SET_GENERAL",t.SetSpeech="SET_SPEECH",t.SetChannels="SET_CHANNELS",t.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",t.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",t))(ao||{});class _4{constructor(){H(this,"state");H(this,"listeners",new Set);H(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(n=>n())});const e=localStorage.getItem("preferences"),n=this.getInitialPreferences();this.state=e?this.mergePreferences(n,JSON.parse(e)):n}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(e,n){return{...e,general:{...e.general,...n.general},speech:{...e.speech,...n.speech},channels:n.channels?{...e.channels,...n.channels}:e.channels,editor:{...e.editor,...n.editor}}}reducer(e,n){switch(n.type){case"SET_GENERAL":return{...e,general:n.data};case"SET_SPEECH":return{...e,speech:n.data};case"SET_CHANNELS":return{...e,channels:n.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:n.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:n.data}};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const nl=new _4;class I4 extends _I{constructor(n,r){super();H(this,"ws");H(this,"decoder",new TextDecoder("utf8"));H(this,"telnet");H(this,"host");H(this,"port");H(this,"telnetNegotiation",!1);H(this,"telnetBuffer","");H(this,"gmcpHandlers",{});H(this,"mcpHandlers",{});H(this,"mcpMultilines",{});H(this,"mcpAuthKey",null);H(this,"mcp_negotiate");H(this,"mcp_getset");H(this,"gmcp_char");H(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[]});H(this,"cacophony");this.host=n,this.port=r,this.mcp_negotiate=this.registerMcpPackage(v4),this.mcp_getset=this.registerMcpPackage(b4),this.gmcp_char=this.registerGMCPPackage(n2),this.cacophony=new r4}registerGMCPPackage(n){const r=new n(this);return this.gmcpHandlers[r.packageName]=r,r}registerMcpPackage(n){const r=new n(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new e2(new QF(this.ws)),this.ws.onopen=()=>{this.emit("connect")},this.telnet.on("data",n=>{this.handleData(n)}),this.telnet.on("negotiation",(n,r)=>{n===Lu.WILL&&r===Du.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(Lu.DO,Du.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):n===Lu.DO&&r===Du.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(Lu.WILL,Du.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose React Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(n,r)=>{console.log("GMCP Package:",n,r),this.handleGmcpData(n,r)}),this.ws.onclose=()=>{this.emit("disconnect"),this.mcpAuthKey=null,setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=n=>{this.emit("error",n)}}send(n){this.ws.send(n)}close(){this.ws.close()}sendCommand(n){nl.getState().general.localEcho&&this.emit("command",n),this.send(n+`\r
`),console.log("> "+n)}handleData(n){const r=this.decoder.decode(n).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(n){if(n.startsWith("#$#*")){const i=kE(n.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(n.startsWith("#$#:")){const i=kE(n.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=g4(n.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=Ly(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(n,r){const i=n.lastIndexOf("."),s=n.substring(0,i),o=n.substring(i+1);console.log("GMCP Message:",s,o,r);const a=this.gmcpHandlers[s];if(!a){console.log("No handler for GMCP package:",s);return}const c=a["handle"+o];c?(console.log("Calling handler:",c),c.call(a,JSON.parse(r))):console.log("No handler for GMCP package:",s)}emitMessage(n){const r=nl.getState().speech.autoreadMode;r===Fy.All&&this.speak(n),r===Fy.Unfocused&&!document.hasFocus()&&this.speak(n),this.emit("message",n)}sendGmcp(n,r){console.log("Sending GMCP:",n,r),this.telnet.sendGmcp(n,r)}sendMcp(n,r){if(typeof r=="object"){let s="";for(const[o,a]of Object.entries(r))s+=` ${o}: ${a||'""'}`;r=s}const i=`#$#${n} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpML(n,r,i){this.send(`#$#* ${n} ${r}: ${i}\r
`)}closeMcpML(n){this.send(`#$#: ${n}\r
`)}openEditorWindow(n){console.log(n);const r=new BroadcastChannel("editor"),i=n.reference,s=encodeURIComponent(i);window.open(`/editor?reference=${s}`,"_blank"),r.onmessage=o=>{console.log("editor window message",o),o.data.id===i&&(o.data.type==="ready"?(console.log("sending editor window session",n),r.postMessage({type:"load",session:n})):o.data.type==="save"?(console.log("saving editor window with session",o.data.session),this.saveEditorWindow(o.data.session)):o.data.type==="close"&&(console.log("closing editor window"),r.close(),r.onmessage=null))}}saveEditorWindow(n){const r=Ly(),i={};i.reference=n.reference,i.type=n.type,i["content*"]="",i["_data-tag"]=r,this.sendMcp("dns-org-mud-moo-simpleedit-set",i);for(const s of n.contents)this.sendMcpML(r,"content",s);this.closeMcpML(r)}shutdown(){Object.values(this.mcpHandlers).forEach(n=>{n.shutdown()}),Object.values(this.gmcpHandlers).forEach(n=>{n.shutdown()})}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(n,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(n,{body:r})}speak(n){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(T4(n));r.lang="en-US";const{rate:i,pitch:s,voice:o,volume:a}=nl.getState().speech;r.rate=i,r.pitch=s,r.volume=a;const l=speechSynthesis.getVoices().find(u=>u.name===o);l&&(r.voice=l),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}getInput(){var n;return((n=document.getElementById("command-input"))==null?void 0:n.textContent)||""}setInput(n){const r=document.getElementById("command-input");r&&(r.textContent=n)}}class R4{constructor(){H(this,"history",[]);H(this,"currentIndex",null);H(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&(this.history.push(e.trim()),this.currentIndex=null,this.unsentInput="")}navigateUp(e){return this.currentIndex===null&&(this.unsentInput=e),this.history.length>0&&(this.currentIndex==null||this.currentIndex>0)?(this.currentIndex=this.currentIndex==null?this.history.length-1:this.currentIndex-1,this.history[this.currentIndex]):e}navigateDown(e){return this.currentIndex!==null?this.currentIndex<this.history.length-1?(this.currentIndex++,this.history[this.currentIndex]):(this.currentIndex=null,""):this.unsentInput}getCurrentInput(){return this.currentIndex===null?this.unsentInput:this.history[this.currentIndex]}}const P4=({onSend:t})=>{const[e,n]=E.useState(""),r=E.useRef(new R4),i=s=>{const o=r.current;if(s.key==="Enter"&&!s.shiftKey)s.preventDefault(),t(e),o.addCommand(e),n("");else if(s.key==="ArrowUp"){s.preventDefault();const a=o.navigateUp(e);n(a)}else if(s.key==="ArrowDown"){s.preventDefault();const a=o.navigateDown(e);n(a)}};return X.jsx("textarea",{value:e,onChange:s=>n(s.target.value),onKeyDown:i,autoFocus:!0,id:"command-input"})},Sa=()=>{const[,t]=E.useReducer(e=>e+1,0);return E.useEffect(()=>nl.subscribe(t),[]),[nl.getState(),nl.dispatch]},A4=()=>{const[t,e]=E.useState([]);return E.useEffect(()=>{const n=()=>{e(window.speechSynthesis.getVoices())};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)},[]),t},N4=({tabs:t})=>{const[e,n]=E.useState(0),r=E.useRef([]);return E.useEffect(()=>{r.current=r.current.slice(0,t.length)},[t]),E.useEffect(()=>{const i=o=>{switch(o.key){case"ArrowLeft":n(a=>a>0?a-1:t.length-1);break;case"ArrowRight":n(a=>a<t.length-1?a+1:0);break}},s=r.current[e];return s==null||s.addEventListener("keydown",i),()=>{s==null||s.removeEventListener("keydown",i)}},[t.length,e]),E.useEffect(()=>{var i;(i=r.current[e])==null||i.focus()},[e]),X.jsxs("div",{children:[X.jsx("div",{role:"tablist","aria-label":"Tabs",children:t.map((i,s)=>X.jsx("button",{ref:o=>r.current[s]=o,role:"tab","aria-selected":e===s,id:`${i.label}-tab`,"aria-controls":`${i.label}-panel`,onClick:()=>n(s),tabIndex:e===s?void 0:-1,children:i.label},s))}),t.map((i,s)=>X.jsx("div",{role:"tabpanel",id:`${i.label}-panel`,"aria-labelledby":`${i.label}-tab`,hidden:e!==s,tabIndex:e===s?0:-1,children:i.content},s))]})},M4=()=>{const[t,e]=Sa();return X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:t.general.localEcho,onChange:n=>e({type:ao.SetGeneral,data:{...t.general,localEcho:n.target.checked}})}),"Local Echo"]})},x4=()=>{const[t,e]=Sa();return X.jsxs("label",{children:["Auto Read:",X.jsxs("select",{value:t.speech.autoreadMode,onChange:n=>e({type:ao.SetSpeech,data:{...t.speech,autoreadMode:n.target.value}}),children:[X.jsx("option",{value:"off",children:"Off"}),X.jsx("option",{value:"unfocused",children:"Unfocused"}),X.jsx("option",{value:"all",children:"Always"})]})]})},O4=()=>{const[t,e]=Sa(),n=A4();return X.jsxs("label",{children:["Voice:",X.jsx("select",{value:t.speech.voice,onChange:r=>e({type:ao.SetSpeech,data:{...t.speech,voice:r.target.value}}),children:n.map(r=>X.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},D4=()=>{const[t,e]=Sa();return X.jsxs("label",{children:["Rate (0.1 - 10.0):",X.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:t.speech.rate,onChange:n=>e({type:ao.SetSpeech,data:{...t.speech,rate:parseFloat(n.target.value)}})})]})},L4=()=>{const[t,e]=Sa();return X.jsxs("label",{children:["Pitch (0 - 2):",X.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:t.speech.pitch,onChange:n=>e({type:ao.SetSpeech,data:{...t.speech,pitch:parseFloat(n.target.value)}})})]})},F4=()=>{const[t,e]=Sa();return X.jsxs("label",{children:["Volume (0 - 1):",X.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:t.speech.volume,onChange:n=>e({type:ao.SetSpeech,data:{...t.speech,volume:parseFloat(n.target.value)}})})]})},B4=()=>X.jsxs("div",{children:[X.jsx(x4,{}),X.jsx("br",{}),X.jsx(O4,{}),X.jsx("br",{}),X.jsx(D4,{}),X.jsx("br",{}),X.jsx(L4,{}),X.jsx("br",{}),X.jsx(F4,{}),X.jsx("br",{})]}),U4=()=>{const[t,e]=Sa(),n=t.editor,r=s=>{e({type:ao.SetEditorAutocompleteEnabled,data:s.target.checked})},i=s=>{e({type:ao.SetEditorAccessibilityMode,data:s.target.checked})};return X.jsxs("div",{children:[X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),X.jsx("br",{}),X.jsxs("label",{children:[X.jsx("input",{type:"checkbox",checked:n.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),X.jsx("br",{})]})},j4=()=>{const t=[{label:"General",content:X.jsx(M4,{})},{label:"Speech",content:X.jsx(B4,{})},{label:"Editor",content:X.jsx(U4,{})}];return X.jsx(N4,{tabs:t})};function W4(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Rd(){return Rd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Rd.apply(this,arguments)}var By="data-focus-lock",MR="data-focus-lock-disabled",V4="data-no-focus-lock",z4="data-autofocus-inside",$4="data-no-autofocus";function H4(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function G4(t,e){var n=E.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}function q4(t,e){return G4(e||null,function(n){return t.forEach(function(r){return H4(r,n)})})}var zg={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},Uy=function(t,e){return Uy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Uy(t,e)};function Ql(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Uy(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var jy=function(){return jy=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},jy.apply(this,arguments)};function J4(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function xR(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(n=0)),n;)try{if(r=1,i&&(s=l[0]&2?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){n.label=l[1];break}if(l[0]===6&&n.label<s[1]){n.label=s[1],s=l;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(l);break}s[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],i=0}finally{r=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Al(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function bp(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function wp(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}function rl(t){return this instanceof rl?(this.v=t,this):new rl(t)}function Z4(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(f){r[f]&&(i[f]=function(h){return new Promise(function(p,g){s.push([f,h,p,g])>1||a(f,h)})})}function a(f,h){try{c(r[f](h))}catch(p){d(s[0][3],p)}}function c(f){f.value instanceof rl?Promise.resolve(f.value.v).then(l,u):d(s[0][2],f)}function l(f){a("next",f)}function u(f){a("throw",f)}function d(f,h){f(h),s.shift(),s.length&&a(s[0][0],s[0][1])}}function K4(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Al=="function"?Al(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}function OR(t){return t}function DR(t,e){e===void 0&&(e=OR);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(r=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var c=function(){var u=o;o=[],u.forEach(s)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){o.push(u),l()},filter:function(u){return o=o.filter(u),n}}}};return i}function ab(t,e){return e===void 0&&(e=OR),DR(t,e)}function Y4(t){t===void 0&&(t={});var e=DR(null);return e.options=jy({async:!0,ssr:!1},t),e}var LR=ab({},function(t){var e=t.target,n=t.currentTarget;return{target:e,currentTarget:n}}),FR=ab(),X4=ab(),Q4=Y4({async:!0}),e6=[],cb=E.forwardRef(function(e,n){var r,i=E.useState(),s=i[0],o=i[1],a=E.useRef(),c=E.useRef(!1),l=E.useRef(null),u=e.children,d=e.disabled,f=e.noFocusGuards,h=e.persistentFocus,p=e.crossFrame,g=e.autoFocus;e.allowTextSelection;var y=e.group,m=e.className,v=e.whiteList,w=e.hasPositiveIndices,_=e.shards,C=_===void 0?e6:_,k=e.as,T=k===void 0?"div":k,R=e.lockProps,A=R===void 0?{}:R,M=e.sideCar,O=e.returnFocus,D=e.focusOptions,j=e.onActivation,V=e.onDeactivation,J=E.useState({}),G=J[0],te=E.useCallback(function(){l.current=l.current||document&&document.activeElement,a.current&&j&&j(a.current),c.current=!0},[j]),z=E.useCallback(function(){c.current=!1,V&&V(a.current)},[V]);E.useEffect(function(){d||(l.current=null)},[]);var Z=E.useCallback(function(Ue){var ce=l.current;if(ce&&ce.focus){var xt=typeof O=="function"?O(ce):O;if(xt){var cn=typeof xt=="object"?xt:void 0;l.current=null,Ue?Promise.resolve().then(function(){return ce.focus(cn)}):ce.focus(cn)}}},[O]),ie=E.useCallback(function(Ue){c.current&&LR.useMedium(Ue)},[]),q=FR.useMedium,se=E.useCallback(function(Ue){a.current!==Ue&&(a.current=Ue,o(Ue))},[]),ke=Rd((r={},r[MR]=d&&"disabled",r[By]=y,r),A),Ee=f!==!0,me=Ee&&f!=="tail",Te=q4([n,se]);return E.createElement(E.Fragment,null,Ee&&[E.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:d?-1:0,style:zg}),w?E.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:d?-1:1,style:zg}):null],!d&&E.createElement(M,{id:G,sideCar:Q4,observed:s,disabled:d,persistentFocus:h,crossFrame:p,autoFocus:g,whiteList:v,shards:C,onActivation:te,onDeactivation:z,returnFocus:Z,focusOptions:D}),E.createElement(T,Rd({ref:Te},ke,{className:m,onBlur:q,onFocus:ie}),u),me&&E.createElement("div",{"data-focus-guard":!0,tabIndex:d?-1:0,style:zg}))});cb.propTypes={};cb.defaultProps={children:void 0,disabled:!1,returnFocus:!1,focusOptions:void 0,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,hasPositiveIndices:void 0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};const BR=cb;function Wy(t,e){return Wy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Wy(t,e)}function t6(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Wy(t,e)}function Pd(t){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pd(t)}function n6(t,e){if(Pd(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Pd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function r6(t){var e=n6(t,"string");return Pd(e)=="symbol"?e:String(e)}function i6(t,e,n){return e=r6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s6(t,e){function n(r){return r.displayName||r.name||"Component"}return function(i){var s=[],o;function a(){o=t(s.map(function(l){return l.props})),e(o)}var c=function(l){t6(u,l);function u(){return l.apply(this,arguments)||this}u.peek=function(){return o};var d=u.prototype;return d.componentDidMount=function(){s.push(this),a()},d.componentDidUpdate=function(){a()},d.componentWillUnmount=function(){var h=s.indexOf(this);s.splice(h,1),a()},d.render=function(){return wt.createElement(i,this.props)},u}(E.PureComponent);return i6(c,"displayName","SideEffect("+n(i)+")"),c}}var gs=function(t){for(var e=Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e},kp=function(t){return Array.isArray(t)?t:[t]},UR=function(t){return Array.isArray(t)?t[0]:t},o6=function(t){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(t,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},jR=function(t){return t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.host:t.parentNode},WR=function(t){return t===document||t&&t.nodeType===Node.DOCUMENT_NODE},a6=function(t,e){return!t||WR(t)||!o6(t)&&e(jR(t))},VR=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=a6(e,VR.bind(void 0,t));return t.set(e,r),r},c6=function(t,e){return t&&!WR(t)?d6(t)?e(jR(t)):!1:!0},zR=function(t,e){var n=t.get(e);if(n!==void 0)return n;var r=c6(e,zR.bind(void 0,t));return t.set(e,r),r},$R=function(t){return t.dataset},l6=function(t){return t.tagName==="BUTTON"},HR=function(t){return t.tagName==="INPUT"},GR=function(t){return HR(t)&&t.type==="radio"},u6=function(t){return!((HR(t)||l6(t))&&(t.type==="hidden"||t.disabled))},d6=function(t){var e=t.getAttribute($4);return![!0,"true",""].includes(e)},lb=function(t){var e;return!!(t&&(!((e=$R(t))===null||e===void 0)&&e.focusGuard))},Ep=function(t){return!lb(t)},f6=function(t){return!!t},h6=function(t,e){var n=t.tabIndex-e.tabIndex,r=t.index-e.index;if(n){if(!t.tabIndex)return 1;if(!e.tabIndex)return-1}return n||r},qR=function(t,e,n){return gs(t).map(function(r,i){return{node:r,index:i,tabIndex:n&&r.tabIndex===-1?(r.dataset||{}).focusGuard?0:-1:r.tabIndex}}).filter(function(r){return!e||r.tabIndex>=0}).sort(h6)},p6=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],ub=p6.join(","),m6="".concat(ub,", [data-focus-guard]"),JR=function(t,e){return gs((t.shadowRoot||t).children).reduce(function(n,r){return n.concat(r.matches(e?m6:ub)?[r]:[],JR(r))},[])},g6=function(t,e){var n;return t instanceof HTMLIFrameElement&&(!((n=t.contentDocument)===null||n===void 0)&&n.body)?bm([t.contentDocument.body],e):[t]},bm=function(t,e){return t.reduce(function(n,r){var i,s=JR(r,e),o=(i=[]).concat.apply(i,s.map(function(a){return g6(a,e)}));return n.concat(o,r.parentNode?gs(r.parentNode.querySelectorAll(ub)).filter(function(a){return a===r}):[])},[])},v6=function(t){var e=t.querySelectorAll("[".concat(z4,"]"));return gs(e).map(function(n){return bm([n])}).reduce(function(n,r){return n.concat(r)},[])},db=function(t,e){return gs(t).filter(function(n){return VR(e,n)}).filter(function(n){return u6(n)})},EE=function(t,e){return e===void 0&&(e=new Map),gs(t).filter(function(n){return zR(e,n)})},Vy=function(t,e,n){return qR(db(bm(t,n),e),!0,n)},CE=function(t,e){return qR(db(bm(t),e),!1)},y6=function(t,e){return db(v6(t),e)},il=function(t,e){return t.shadowRoot?il(t.shadowRoot,e):Object.getPrototypeOf(t).contains!==void 0&&Object.getPrototypeOf(t).contains.call(t,e)?!0:gs(t.children).some(function(n){var r;if(n instanceof HTMLIFrameElement){var i=(r=n.contentDocument)===null||r===void 0?void 0:r.body;return i?il(i,e):!1}return il(n,e)})},S6=function(t){for(var e=new Set,n=t.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var s=t[r].compareDocumentPosition(t[i]);(s&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(s&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return t.filter(function(o,a){return!e.has(a)})},ZR=function(t){return t.parentNode?ZR(t.parentNode):t},fb=function(t){var e=kp(t);return e.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(By);return n.push.apply(n,i?S6(gs(ZR(r).querySelectorAll("[".concat(By,'="').concat(i,'"]:not([').concat(MR,'="disabled"])')))):[r]),n},[])},b6=function(t){try{return t()}catch{return}},Ad=function(t){if(t===void 0&&(t=document),!(!t||!t.activeElement)){var e=t.activeElement;return e.shadowRoot?Ad(e.shadowRoot):e instanceof HTMLIFrameElement&&b6(function(){return e.contentWindow.document})?Ad(e.contentWindow.document):e}},w6=function(t,e){return t===e},k6=function(t,e){return!!gs(t.querySelectorAll("iframe")).some(function(n){return w6(n,e)})},KR=function(t,e){return e===void 0&&(e=Ad(UR(t).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:fb(t).some(function(n){return il(n,e)||k6(n,e)})},E6=function(t){t===void 0&&(t=document);var e=Ad(t);return e?gs(t.querySelectorAll("[".concat(V4,"]"))).some(function(n){return il(n,e)}):!1},C6=function(t,e){return e.filter(GR).filter(function(n){return n.name===t.name}).filter(function(n){return n.checked})[0]||t},hb=function(t,e){return GR(t)&&t.name?C6(t,e):t},T6=function(t){var e=new Set;return t.forEach(function(n){return e.add(hb(n,t))}),t.filter(function(n){return e.has(n)})},TE=function(t){return t[0]&&t.length>1?hb(t[0],t):t[0]},_E=function(t,e){return t.length>1?t.indexOf(hb(t[e],t)):e},YR="NEW_FOCUS",_6=function(t,e,n,r){var i=t.length,s=t[0],o=t[i-1],a=lb(n);if(!(n&&t.indexOf(n)>=0)){var c=n!==void 0?e.indexOf(n):-1,l=r?e.indexOf(r):c,u=r?t.indexOf(r):-1,d=c-l,f=e.indexOf(s),h=e.indexOf(o),p=T6(e),g=n!==void 0?p.indexOf(n):-1,y=g-(r?p.indexOf(r):c),m=_E(t,0),v=_E(t,i-1);if(c===-1||u===-1)return YR;if(!d&&u>=0)return u;if(c<=f&&a&&Math.abs(d)>1)return v;if(c>=h&&a&&Math.abs(d)>1)return m;if(d&&Math.abs(y)>1)return u;if(c<=f)return v;if(c>h)return m;if(d)return Math.abs(d)>1?u:(i+u+d)%i}},I6=function(t){return function(e){var n,r=(n=$R(e))===null||n===void 0?void 0:n.autofocus;return e.autofocus||r!==void 0&&r!=="false"||t.indexOf(e)>=0}},R6=function(t,e,n){var r=t.map(function(s){var o=s.node;return o}),i=EE(r.filter(I6(n)));return i&&i.length?TE(i):TE(EE(e))},zy=function(t,e){return e===void 0&&(e=[]),e.push(t),t.parentNode&&zy(t.parentNode.host||t.parentNode,e),e},$g=function(t,e){for(var n=zy(t),r=zy(e),i=0;i<n.length;i+=1){var s=n[i];if(r.indexOf(s)>=0)return s}return!1},XR=function(t,e,n){var r=kp(t),i=kp(e),s=r[0],o=!1;return i.filter(Boolean).forEach(function(a){o=$g(o||a,a)||o,n.filter(Boolean).forEach(function(c){var l=$g(s,c);l&&(!o||il(l,o)?o=l:o=$g(l,o))})}),o},P6=function(t,e){return t.reduce(function(n,r){return n.concat(y6(r,e))},[])},A6=function(t,e){var n=new Map;return e.forEach(function(r){return n.set(r.node,r)}),t.map(function(r){return n.get(r)}).filter(f6)},N6=function(t,e){var n=Ad(kp(t).length>0?document:UR(t).ownerDocument),r=fb(t).filter(Ep),i=XR(n||t,t,r),s=new Map,o=CE(r,s),a=Vy(r,s).filter(function(h){var p=h.node;return Ep(p)});if(!(!a[0]&&(a=o,!a[0]))){var c=CE([i],s).map(function(h){var p=h.node;return p}),l=A6(c,a),u=l.map(function(h){var p=h.node;return p}),d=_6(u,c,n,e);if(d===YR){var f=R6(o,u,P6(r,s));if(f)return{node:f};console.warn("focus-lock: cannot find any node to move focus into");return}return d===void 0?d:l[d]}},M6=function(t){var e=fb(t).filter(Ep),n=XR(t,t,e),r=new Map,i=Vy([n],r,!0),s=Vy(e,r).filter(function(o){var a=o.node;return Ep(a)}).map(function(o){var a=o.node;return a});return i.map(function(o){var a=o.node,c=o.index;return{node:a,index:c,lockItem:s.indexOf(a)>=0,guard:lb(a)}})},x6=function(t,e){"focus"in t&&t.focus(e),"contentWindow"in t&&t.contentWindow&&t.contentWindow.focus()},Hg=0,Gg=!1,QR=function(t,e,n){n===void 0&&(n={});var r=N6(t,e);if(!Gg&&r){if(Hg>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),Gg=!0,setTimeout(function(){Gg=!1},1);return}Hg++,x6(r.node,n.focusOptions),Hg--}};function pb(t){setTimeout(t,1)}var O6=function(){return document&&document.activeElement===document.body},D6=function(){return O6()||E6()},sl=null,zc=null,ol=null,Nd=!1,L6=function(){return!0},F6=function(e){return(sl.whiteList||L6)(e)},B6=function(e,n){ol={observerNode:e,portaledElement:n}},U6=function(e){return ol&&ol.portaledElement===e};function IE(t,e,n,r){var i=null,s=t;do{var o=r[s];if(o.guard)o.node.dataset.focusAutoGuard&&(i=o);else if(o.lockItem){if(s!==t)return;i=null}else break}while((s+=n)!==e);i&&(i.node.tabIndex=0)}var j6=function(e){return e&&"current"in e?e.current:e},W6=function(e){return e?!!Nd:Nd==="meanwhile"},V6=function t(e,n,r){return n&&(n.host===e&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&t(e,n.parentNode,r))},z6=function(e,n){return n.some(function(r){return V6(e,r,r)})},Cp=function(){var e=!1;if(sl){var n=sl,r=n.observed,i=n.persistentFocus,s=n.autoFocus,o=n.shards,a=n.crossFrame,c=n.focusOptions,l=r||ol&&ol.portaledElement,u=document&&document.activeElement;if(l){var d=[l].concat(o.map(j6).filter(Boolean));if((!u||F6(u))&&(i||W6(a)||!D6()||!zc&&s)&&(l&&!(KR(d)||u&&z6(u,d)||U6(u))&&(document&&!zc&&u&&!s?(u.blur&&u.blur(),document.body.focus()):(e=QR(d,zc,{focusOptions:c}),ol={})),Nd=!1,zc=document&&document.activeElement),document){var f=document&&document.activeElement,h=M6(d),p=h.map(function(g){var y=g.node;return y}).indexOf(f);p>-1&&(h.filter(function(g){var y=g.guard,m=g.node;return y&&m.dataset.focusAutoGuard}).forEach(function(g){var y=g.node;return y.removeAttribute("tabIndex")}),IE(p,h.length,1,h),IE(p,-1,-1,h))}}}return e},eP=function(e){Cp()&&e&&(e.stopPropagation(),e.preventDefault())},mb=function(){return pb(Cp)},$6=function(e){var n=e.target,r=e.currentTarget;r.contains(n)||B6(r,n)},H6=function(){return null},tP=function(){Nd="just",pb(function(){Nd="meanwhile"})},G6=function(){document.addEventListener("focusin",eP),document.addEventListener("focusout",mb),window.addEventListener("blur",tP)},q6=function(){document.removeEventListener("focusin",eP),document.removeEventListener("focusout",mb),window.removeEventListener("blur",tP)};function J6(t){return t.filter(function(e){var n=e.disabled;return!n})}function Z6(t){var e=t.slice(-1)[0];e&&!sl&&G6();var n=sl,r=n&&e&&e.id===n.id;sl=e,n&&!r&&(n.onDeactivation(),t.filter(function(i){var s=i.id;return s===n.id}).length||n.returnFocus(!e)),e?(zc=null,(!r||n.observed!==e.observed)&&e.onActivation(),Cp(),pb(Cp)):(q6(),zc=null)}LR.assignSyncMedium($6);FR.assignMedium(mb);X4.assignMedium(function(t){return t({moveFocusInside:QR,focusInside:KR})});const K6=s6(J6,Z6)(H6);var nP=E.forwardRef(function(e,n){return E.createElement(BR,Rd({sideCar:K6,ref:n},e))}),rP=BR.propTypes||{};rP.sideCar;W4(rP,["sideCar"]);nP.propTypes={};const Y6=nP,X6=wt.forwardRef((t,e)=>{const[n,r]=E.useState(!1),i=E.useRef(null);return wt.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),E.useEffect(()=>{var s;n&&((s=i.current)==null||s.focus())},[n]),E.useEffect(()=>{const s=o=>{o.key==="Escape"&&r(!1)};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[]),X.jsx(Y6,{disabled:!n,children:X.jsxs("dialog",{className:"preferences-dialog",open:n,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[n&&X.jsx(j4,{}),X.jsx("button",{onClick:()=>r(!1),children:"Close"})]})})});var iP={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},RE=wt.createContext&&wt.createContext(iP),ea=function(){return ea=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},ea.apply(this,arguments)},Q6=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function sP(t){return t&&t.map(function(e,n){return wt.createElement(e.tag,ea({key:n},e.attr),sP(e.child))})}function lc(t){return function(e){return wt.createElement(e8,ea({attr:ea({},t.attr)},e),sP(t.child))}}function e8(t){var e=function(n){var r=t.attr,i=t.size,s=t.title,o=Q6(t,["attr","size","title"]),a=i||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),wt.createElement("svg",ea({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:c,style:ea(ea({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&wt.createElement("title",null,s),t.children)};return RE!==void 0?wt.createElement(RE.Consumer,null,function(n){return e(n)}):e(iP)}function t8(t){return lc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}}]})(t)}function n8(t){return lc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(t)}function r8(t){return lc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"}}]})(t)}function oP(t){return lc({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(t)}function i8(t){return lc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"}}]})(t)}function s8(t){return lc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"}}]})(t)}function o8(t){return lc({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"}}]})(t)}const a8=({client:t,onClearLog:e,onSaveLog:n,onToggleUsers:r,onOpenPrefs:i})=>{const[s,o]=wt.useState(t.cacophony.muted);return X.jsxs("div",{className:"toolbar",children:[X.jsxs("button",{onClick:n,accessKey:"l",children:[X.jsx(oP,{}),"Save Log"]}),X.jsxs("button",{onClick:e,accessKey:"c",children:[X.jsx(r8,{}),"Clear Log"]}),X.jsxs("button",{onClick:i,accessKey:"p",children:[X.jsx(t8,{}),"Preferences"]}),X.jsxs("button",{onClick:()=>{o(!s),t.cacophony.muted=!s},accessKey:"m",children:[s?X.jsx(o8,{}):X.jsx(s8,{}),s?"Unmute":"Mute"]}),X.jsx("button",{onClick:r,accessKey:"u",children:"Show/Hide Users"}),X.jsxs("label",{children:["Volume",X.jsx("input",{type:"range",min:"0",max:"100",onChange:a=>t.cacophony.setGlobalVolume(Number(a.target.value)/100)})]})]})};class c8 extends wt.Component{constructor(e){super(e),this.state={statusText:"Not connected"},e.client.on("statustext",n=>this.setState({statusText:n})),e.client.on("connect",()=>this.setState({statusText:"Connected"})),e.client.on("disconnect",()=>this.setState({statusText:"Disconnected"}))}render(){return X.jsx("div",{className:"statusbar",children:this.state.statusText})}}const l8=({users:t})=>X.jsxs("div",{className:"sidebar",children:[X.jsx("div",{className:"sidebar-header",role:"heading","aria-level":2,children:"Connected Players"}),X.jsx("div",{className:"sidebar-content",children:X.jsx("ul",{children:t.map(e=>{let n="";return e.away&&(n+=" away"),e.idle&&(n+=" idle"),X.jsx("li",{className:n,children:e.Name},e.Object)})})})]});var PE={};function u8(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var d8=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function f8(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var aP={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(d8,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function s(g,y){var m=g[y];if(typeof m.bind=="function")return m.bind(g);try{return Function.prototype.bind.call(m,g)}catch{return function(){return Function.prototype.apply.apply(m,[g,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?o:console[g]!==void 0?s(console,g):console.log!==void 0?s(console,"log"):e}function c(g,y){for(var m=0;m<i.length;m++){var v=i[m];this[v]=m<g?e:this.methodFactory(v,g,y)}this.log=this.debug}function l(g,y,m){return function(){typeof console!==n&&(c.call(this,y,m),this[g].apply(this,arguments))}}function u(g,y,m){return a(g)||l.apply(this,arguments)}function d(g,y,m){var v=this,w;y=y??"WARN";var _="loglevel";typeof g=="string"?_+=":"+g:typeof g=="symbol"&&(_=void 0);function C(A){var M=(i[A]||"silent").toUpperCase();if(!(typeof window===n||!_)){try{window.localStorage[_]=M;return}catch{}try{window.document.cookie=encodeURIComponent(_)+"="+M+";"}catch{}}}function k(){var A;if(!(typeof window===n||!_)){try{A=window.localStorage[_]}catch{}if(typeof A===n)try{var M=window.document.cookie,O=M.indexOf(encodeURIComponent(_)+"=");O!==-1&&(A=/^([^;]+)/.exec(M.slice(O))[1])}catch{}return v.levels[A]===void 0&&(A=void 0),A}}function T(){if(!(typeof window===n||!_)){try{window.localStorage.removeItem(_);return}catch{}try{window.document.cookie=encodeURIComponent(_)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}v.name=g,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=m||u,v.getLevel=function(){return w},v.setLevel=function(A,M){if(typeof A=="string"&&v.levels[A.toUpperCase()]!==void 0&&(A=v.levels[A.toUpperCase()]),typeof A=="number"&&A>=0&&A<=v.levels.SILENT){if(w=A,M!==!1&&C(A),c.call(v,A,g),typeof console===n&&A<v.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+A},v.setDefaultLevel=function(A){y=A,k()||v.setLevel(A,!1)},v.resetLevel=function(){v.setLevel(y,!1),T()},v.enableAll=function(A){v.setLevel(v.levels.TRACE,A)},v.disableAll=function(A){v.setLevel(v.levels.SILENT,A)};var R=k();R==null&&(R=y),v.setLevel(R,!1)}var f=new d,h={};f.getLogger=function(y){if(typeof y!="symbol"&&typeof y!="string"||y==="")throw new TypeError("You must supply a name when creating a logger.");var m=h[y];return m||(m=h[y]=new d(y,f.getLevel(),f.methodFactory)),m};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(aP);var cP=aP.exports,$y;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})($y||($y={}));const F=cP.getLogger("livekit");F.setDefaultLevel($y.info);cP.getLogger("lk-e2ee");function cr(t,e){if(!t)throw new Error(e)}const h8=34028234663852886e22,p8=-34028234663852886e22,m8=4294967295,g8=2147483647,v8=-2147483648;function Th(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>g8||t<v8)throw new Error("invalid int 32: "+t)}function Hy(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>m8||t<0)throw new Error("invalid uint 32: "+t)}function lP(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>h8||t<p8))throw new Error("invalid float 32: "+t)}const uP=Symbol("@bufbuild/protobuf/enum-type");function y8(t){const e=t[uP];return cr(e,"missing enum type on enum object"),e}function dP(t,e,n,r){t[uP]=fP(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function fP(t,e,n){const r=Object.create(null),i=Object.create(null),s=[];for(const o of e){const a=hP(o);s.push(a),r[o.name]=a,i[o.no]=a}return{typeName:t,values:s,findName(o){return r[o]},findNumber(o){return i[o]}}}function S8(t,e,n){const r={};for(const i of e){const s=hP(i);r[s.localName]=s.no,r[s.no]=s.localName}return dP(r,t,e),r}function hP(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class pe{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,s=i.makeReadOptions(n);return i.readMessage(this,s.readerFactory(e),e.byteLength,s),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,s=i.makeReadOptions(n);return i.readMessage(r,e,s,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),s=i.writerFactory();return r.writeMessage(this,s,i),s.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function b8(t,e,n,r){var i;const s=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),o={[s]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[s];return Object.setPrototypeOf(o.prototype,new pe),Object.assign(o,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,c){return new o().fromBinary(a,c)},fromJson(a,c){return new o().fromJson(a,c)},fromJsonString(a,c){return new o().fromJsonString(a,c)},equals(a,c){return t.util.equals(o,a,c)}}),o}function w8(t,e,n,r){return{syntax:t,json:e,bin:n,util:r,makeMessageType(i,s,o){return b8(this,i,s,o)},makeEnum:S8,makeEnumType:fP,getEnumType:y8}}var re;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(re||(re={}));var Za;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Za||(Za={}));function k8(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function qg(t,e,n){for(let s=0;s<28;s=s+7){const o=t>>>s,a=!(!(o>>>7)&&e==0),c=(a?o|128:o)&255;if(n.push(c),!a)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let s=3;s<31;s=s+7){const o=e>>>s,a=!!(o>>>7),c=(a?o|128:o)&255;if(n.push(c),!a)return}n.push(e>>>31&1)}}const _h=4294967296;function AE(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function s(o,a){const c=Number(t.slice(o,a));i*=n,r=r*n+c,r>=_h&&(i=i+(r/_h|0),r=r%_h)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),e?mP(r,i):gb(r,i)}function E8(t,e){let n=gb(t,e);const r=n.hi&2147483648;r&&(n=mP(n.lo,n.hi));const i=pP(n.lo,n.hi);return r?"-"+i:i}function pP(t,e){if({lo:t,hi:e}=C8(t,e),e<=2097151)return String(_h*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let s=n+r*6777216+i*6710656,o=r+i*8147497,a=i*2;const c=1e7;return s>=c&&(o+=Math.floor(s/c),s%=c),o>=c&&(a+=Math.floor(o/c),o%=c),a.toString()+NE(o)+NE(s)}function C8(t,e){return{lo:t>>>0,hi:e>>>0}}function gb(t,e){return{lo:t|0,hi:e|0}}function mP(t,e){return e=~e,t?t=~t+1:e+=1,gb(t,e)}const NE=t=>{const e=String(t);return"0000000".slice(e.length)+e};function ME(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function T8(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function _8(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof PE!="object"||PE.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),s=BigInt("9223372036854775807"),o=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>s||l<i)throw new Error("int64 invalid: ".concat(c));return l},uParse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>a||l<o)throw new Error("uint64 invalid: ".concat(c));return l},enc(c){return t.setBigInt64(0,this.parse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(c){return t.setBigInt64(0,this.uParse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigInt64(0,!0)},uDec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigUint64(0,!0)}}}const n=i=>cr(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>cr(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),AE(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),AE(i)},dec(i,s){return E8(i,s)},uDec(i,s){return pP(i,s)}}}const xe=_8();var Wt;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(Wt||(Wt={}));class I8{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Hy(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Th(e),ME(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){lP(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Hy(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Th(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Th(e),e=(e<<1^e>>31)>>>0,ME(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=xe.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=xe.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=xe.enc(e);return qg(n.lo,n.hi,this.buf),this}sint64(e){let n=xe.enc(e),r=n.hi>>31,i=n.lo<<1^r,s=(n.hi<<1|n.lo>>>31)^r;return qg(i,s,this.buf),this}uint64(e){let n=xe.uEnc(e);return qg(n.lo,n.hi,this.buf),this}}class R8{constructor(e,n){this.varint64=k8,this.uint32=T8,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e){let n=this.pos;switch(e){case Wt.Varint:for(;this.buf[this.pos++]&128;);break;case Wt.Bit64:this.pos+=4;case Wt.Bit32:this.pos+=4;break;case Wt.LengthDelimited:let r=this.uint32();this.pos+=r;break;case Wt.StartGroup:let i;for(;(i=this.tag()[1])!==Wt.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return xe.dec(...this.varint64())}uint64(){return xe.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,xe.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return xe.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return xe.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function Gy(t,e){return e instanceof pe||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}re.DOUBLE,re.FLOAT,re.INT64,re.UINT64,re.INT32,re.UINT32,re.BOOL,re.STRING,re.BYTES;function ko(t,e,n){if(e===n)return!0;if(t==re.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case re.UINT64:case re.FIXED64:case re.INT64:case re.SFIXED64:case re.SINT64:return e==n}return!1}function qy(t,e){switch(t){case re.BOOL:return!1;case re.UINT64:case re.FIXED64:case re.INT64:case re.SFIXED64:case re.SINT64:return e==0?xe.zero:"0";case re.DOUBLE:case re.FLOAT:return 0;case re.BYTES:return new Uint8Array(0);case re.STRING:return"";default:return 0}}function gP(t,e){const n=e===void 0;let r=Wt.Varint,i=e===0;switch(t){case re.STRING:i=n||!e.length,r=Wt.LengthDelimited;break;case re.BOOL:i=e===!1;break;case re.DOUBLE:r=Wt.Bit64;break;case re.FLOAT:r=Wt.Bit32;break;case re.INT64:i=n||e==0;break;case re.UINT64:i=n||e==0;break;case re.FIXED64:i=n||e==0,r=Wt.Bit64;break;case re.BYTES:i=n||!e.byteLength,r=Wt.LengthDelimited;break;case re.FIXED32:r=Wt.Bit32;break;case re.SFIXED32:r=Wt.Bit32;break;case re.SFIXED64:i=n||e==0,r=Wt.Bit64;break;case re.SINT64:i=n||e==0;break}const s=re[t].toLowerCase();return[r,s,n||i]}const kc=Symbol("@bufbuild/protobuf/unknown-fields"),xE={readUnknownFields:!0,readerFactory:t=>new R8(t)},OE={writeUnknownFields:!0,writerFactory:()=>new I8};function P8(t){return t?Object.assign(Object.assign({},xE),t):xE}function A8(t){return t?Object.assign(Object.assign({},OE),t):OE}function N8(){return{makeReadOptions:P8,makeWriteOptions:A8,listUnknownFields(t){var e;return(e=t[kc])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[kc]},writeUnknownFields(t,e){const r=t[kc];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[kc])||(i[kc]=[]),i[kc].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r){const i=t.getType(),s=n===void 0?e.len:e.pos+n;for(;e.pos<s;){const[o,a]=e.tag(),c=i.fields.find(o);if(!c){const f=e.skip(a);r.readUnknownFields&&this.onUnknownField(t,o,a,f);continue}let l=t,u=c.repeated,d=c.localName;switch(c.oneof&&(l=l[c.oneof.localName],l.case!=d&&delete l.value,l.case=d,d="value"),c.kind){case"scalar":case"enum":const f=c.kind=="enum"?re.INT32:c.T;let h=Tp;if(c.kind=="scalar"&&c.L>0&&(h=x8),u){let m=l[d];if(a==Wt.LengthDelimited&&f!=re.STRING&&f!=re.BYTES){let v=e.uint32()+e.pos;for(;e.pos<v;)m.push(h(e,f))}else m.push(h(e,f))}else l[d]=h(e,f);break;case"message":const p=c.T;u?l[d].push(Ih(e,new p,r)):l[d]instanceof pe?Ih(e,l[d],r):(l[d]=Ih(e,new p,r),p.fieldWrapper&&!c.oneof&&!c.repeated&&(l[d]=p.fieldWrapper.unwrapField(l[d])));break;case"map":let[g,y]=M8(c,e,r);l[d][g]=y;break}}}}}function Ih(t,e,n){return e.getType().runtime.bin.readMessage(e,t,t.uint32(),n),e}function M8(t,e,n){const r=e.uint32(),i=e.pos+r;let s,o;for(;e.pos<i;){let[a]=e.tag();switch(a){case 1:s=Tp(e,t.K);break;case 2:switch(t.V.kind){case"scalar":o=Tp(e,t.V.T);break;case"enum":o=e.int32();break;case"message":o=Ih(e,new t.V.T,n);break}break}}if(s===void 0){let a=qy(t.K,Za.BIGINT);s=t.K==re.BOOL?a.toString():a}if(typeof s!="string"&&typeof s!="number"&&(s=s.toString()),o===void 0)switch(t.V.kind){case"scalar":o=qy(t.V.T,Za.BIGINT);break;case"enum":o=0;break;case"message":o=new t.V.T;break}return[s,o]}function x8(t,e){const n=Tp(t,e);return typeof n=="bigint"?n.toString():n}function Tp(t,e){switch(e){case re.STRING:return t.string();case re.BOOL:return t.bool();case re.DOUBLE:return t.double();case re.FLOAT:return t.float();case re.INT32:return t.int32();case re.INT64:return t.int64();case re.UINT64:return t.uint64();case re.FIXED64:return t.fixed64();case re.BYTES:return t.bytes();case re.FIXED32:return t.fixed32();case re.SFIXED32:return t.sfixed32();case re.SFIXED64:return t.sfixed64();case re.SINT64:return t.sint64();case re.UINT32:return t.uint32();case re.SINT32:return t.sint32()}}function O8(t,e,n,r,i){t.tag(n.no,Wt.LengthDelimited),t.fork();let s=r;switch(n.K){case re.INT32:case re.FIXED32:case re.UINT32:case re.SFIXED32:case re.SINT32:s=Number.parseInt(r);break;case re.BOOL:cr(r=="true"||r=="false"),s=r=="true";break}switch(Xu(t,n.K,1,s,!0),n.V.kind){case"scalar":Xu(t,n.V.T,2,i,!0);break;case"enum":Xu(t,re.INT32,2,i,!0);break;case"message":Jy(t,e,n.V.T,2,i);break}t.join()}function Jy(t,e,n,r,i){if(i!==void 0){const s=Gy(n,i);t.tag(r,Wt.LengthDelimited).bytes(s.toBinary(e))}}function Xu(t,e,n,r,i){let[s,o,a]=gP(e,r);(!a||i)&&t.tag(n,s)[o](r)}function D8(t,e,n,r){if(!r.length)return;t.tag(n,Wt.LengthDelimited).fork();let[,i]=gP(e);for(let s=0;s<r.length;s++)t[i](r[s]);t.join()}function L8(){return Object.assign(Object.assign({},N8()),{writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){let s,o=i.repeated,a=i.localName;if(i.oneof){const c=t[i.oneof.localName];if(c.case!==a)continue;s=c.value}else s=t[a];switch(i.kind){case"scalar":case"enum":let c=i.kind=="enum"?re.INT32:i.T;if(o)if(i.packed)D8(e,c,i.no,s);else for(const l of s)Xu(e,c,i.no,l,!0);else s!==void 0&&Xu(e,c,i.no,s,!!i.oneof||i.opt);break;case"message":if(o)for(const l of s)Jy(e,n,i.T,i.no,l);else Jy(e,n,i.T,i.no,s);break;case"map":for(const[l,u]of Object.entries(s))O8(e,n,i,l,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}let _s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),wm=[];for(let t=0;t<_s.length;t++)wm[_s[t].charCodeAt(0)]=t;wm[45]=_s.indexOf("+");wm[95]=_s.indexOf("/");const vP={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,s,o=0;for(let a=0;a<t.length;a++){if(s=wm[t.charCodeAt(a)],s===void 0)switch(t[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:o=s,i=1;break;case 1:n[r++]=o<<2|(s&48)>>4,o=s,i=2;break;case 2:n[r++]=(o&15)<<4|(s&60)>>2,o=s,i=3;break;case 3:n[r++]=(o&3)<<6|s,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let s=0;s<t.length;s++)switch(r=t[s],n){case 0:e+=_s[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=_s[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=_s[i|r>>6],e+=_s[r&63],n=0;break}return n&&(e+=_s[i],e+="=",n==1&&(e+="=")),e}},DE={ignoreUnknownFields:!1},LE={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function F8(t){return t?Object.assign(Object.assign({},DE),t):DE}function B8(t){return t?Object.assign(Object.assign({},LE),t):LE}function U8(t){const e=t(j8,FE);return{makeReadOptions:F8,makeWriteOptions:B8,readMessage(n,r,i,s){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(r)));s=s??new n;const o={};for(const[a,c]of Object.entries(r)){const l=n.fields.findJsonName(a);if(!l){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let u=l.localName,d=s;if(l.oneof){if(c===null&&l.kind=="scalar")continue;const f=o[l.oneof.localName];if(f)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(l.oneof.name,'" present: "').concat(f,'", "').concat(a,'"'));o[l.oneof.localName]=a,d=d[l.oneof.localName]={case:u},u="value"}if(l.repeated){if(c===null)continue;if(!Array.isArray(c))throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const f=d[u];for(const h of c){if(h===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(h)));let p;switch(l.kind){case"message":p=l.T.fromJson(h,i);break;case"enum":if(p=Jg(l.T,h,i.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=ku(l.T,h,l.L)}catch(g){let y="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(h));throw g instanceof Error&&g.message.length>0&&(y+=": ".concat(g.message)),new Error(y)}break}f.push(p)}}else if(l.kind=="map"){if(c===null)continue;if(Array.isArray(c)||typeof c!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const f=d[u];for(const[h,p]of Object.entries(c)){if(p===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: map value null"));let g;switch(l.V.kind){case"message":g=l.V.T.fromJson(p,i);break;case"enum":if(g=Jg(l.V.T,p,i.ignoreUnknownFields),g===void 0)continue;break;case"scalar":try{g=ku(l.V.T,p,Za.BIGINT)}catch(y){let m="cannot decode map value for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw y instanceof Error&&y.message.length>0&&(m+=": ".concat(y.message)),new Error(m)}break}try{f[ku(l.K,l.K==re.BOOL?h=="true"?!0:h=="false"?!1:h:h,Za.BIGINT).toString()]=g}catch(y){let m="cannot decode map key for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw y instanceof Error&&y.message.length>0&&(m+=": ".concat(y.message)),new Error(m)}}}else switch(l.kind){case"message":const f=l.T;if(c===null&&f.typeName!="google.protobuf.Value"){if(l.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}d[u]instanceof pe?d[u].fromJson(c,i):(d[u]=f.fromJson(c,i),f.fieldWrapper&&!l.oneof&&(d[u]=f.fieldWrapper.unwrapField(d[u])));break;case"enum":const h=Jg(l.T,c,i.ignoreUnknownFields);h!==void 0&&(d[u]=h);break;case"scalar":try{d[u]=ku(l.T,c,l.L)}catch(p){let g="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw p instanceof Error&&p.message.length>0&&(g+=": ".concat(p.message)),new Error(g)}break}}return s},writeMessage(n,r){const i=n.getType(),s={};let o;try{for(const a of i.fields.byMember()){let c;if(a.kind=="oneof"){const l=n[a.localName];if(l.value===void 0)continue;if(o=a.findField(l.case),!o)throw"oneof case not found: "+l.case;c=e(o,l.value,r)}else o=a,c=e(o,n[o.localName],r);c!==void 0&&(s[r.useProtoFieldName?o.name:o.jsonName]=c)}}catch(a){const c=o?"cannot encode field ".concat(i.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),l=a instanceof Error?a.message:String(a);throw new Error(c+(l.length>0?": ".concat(l):""))}return s},readScalar:ku,writeScalar:FE,debug:yP}}function yP(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function ku(t,e,n){switch(t){case re.DOUBLE:case re.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==re.FLOAT&&lP(r),r;case re.INT32:case re.FIXED32:case re.SFIXED32:case re.SINT32:case re.UINT32:if(e===null)return 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return t==re.UINT32?Hy(i):Th(i),i;case re.INT64:case re.SFIXED64:case re.SINT64:if(e===null)return xe.zero;if(typeof e!="number"&&typeof e!="string")break;const s=xe.parse(e);return n?s.toString():s;case re.FIXED64:case re.UINT64:if(e===null)return xe.zero;if(typeof e!="number"&&typeof e!="string")break;const o=xe.uParse(e);return n?o.toString():o;case re.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case re.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case re.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return vP.dec(e)}throw new Error}function Jg(t,e,n){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=t.findName(e);if(r||n)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(yP(e)))}function j8(t,e,n,r){var i;if(e===void 0)return e;if(e===0&&!n)return;if(r)return e;if(t.typeName=="google.protobuf.NullValue")return null;const s=t.findNumber(e);return(i=s==null?void 0:s.name)!==null&&i!==void 0?i:e}function FE(t,e,n){if(e!==void 0)switch(t){case re.INT32:case re.SFIXED32:case re.SINT32:case re.FIXED32:case re.UINT32:return cr(typeof e=="number"),e!=0||n?e:void 0;case re.FLOAT:case re.DOUBLE:return cr(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case re.STRING:return cr(typeof e=="string"),e.length>0||n?e:void 0;case re.BOOL:return cr(typeof e=="boolean"),e||n?e:void 0;case re.UINT64:case re.FIXED64:case re.INT64:case re.SFIXED64:case re.SINT64:return cr(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case re.BYTES:return cr(e instanceof Uint8Array),n||e.byteLength>0?vP.enc(e):void 0}}function W8(){return U8((t,e)=>function(r,i,s){if(r.kind=="map"){const o={};switch(r.V.kind){case"scalar":for(const[c,l]of Object.entries(i)){const u=e(r.V.T,l,!0);cr(u!==void 0),o[c.toString()]=u}break;case"message":for(const[c,l]of Object.entries(i))o[c.toString()]=l.toJson(s);break;case"enum":const a=r.V.T;for(const[c,l]of Object.entries(i)){cr(l===void 0||typeof l=="number");const u=t(a,l,!0,s.enumAsInteger);cr(u!==void 0),o[c.toString()]=u}break}return s.emitDefaultValues||Object.keys(o).length>0?o:void 0}else if(r.repeated){const o=[];switch(r.kind){case"scalar":for(let a=0;a<i.length;a++)o.push(e(r.T,i[a],!0));break;case"enum":for(let a=0;a<i.length;a++)o.push(t(r.T,i[a],!0,s.enumAsInteger));break;case"message":for(let a=0;a<i.length;a++)o.push(Gy(r.T,i[a]).toJson(s));break}return s.emitDefaultValues||o.length>0?o:void 0}else switch(r.kind){case"scalar":return e(r.T,i,!!r.oneof||r.opt||s.emitDefaultValues);case"enum":return t(r.T,i,!!r.oneof||r.opt||s.emitDefaultValues,s.enumAsInteger);case"message":return i!==void 0?Gy(r.T,i).toJson(s):void 0}})}function V8(){return{setEnumType:dP,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,s=e,o=t;if(o[i]!==void 0)switch(r.kind){case"oneof":const a=o[i].case;if(a===void 0)continue;const c=r.findField(a);let l=o[i].value;c&&c.kind=="message"&&!(l instanceof c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===re.BYTES&&(l=Eu(l)),s[i]={case:a,value:l};break;case"scalar":case"enum":let u=o[i];r.T===re.BYTES&&(u=r.repeated?u.map(Eu):Eu(u)),s[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===re.BYTES)for(const[h,p]of Object.entries(o[i]))s[i][h]=Eu(p);else Object.assign(s[i],o[i]);break;case"message":const f=r.V.T;for(const h of Object.keys(o[i])){let p=o[i][h];f.fieldWrapper||(p=new f(p)),s[i][h]=p}break}break;case"message":const d=r.T;if(r.repeated)s[i]=o[i].map(f=>f instanceof d?f:new d(f));else if(o[i]!==void 0){const f=o[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?s[i]=Eu(f):s[i]=f:s[i]=f instanceof d?f:new d(f)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],s=n[r.localName];if(r.repeated){if(i.length!==s.length)return!1;switch(r.kind){case"message":return i.every((o,a)=>r.T.equals(o,s[a]));case"scalar":return i.every((o,a)=>ko(r.T,o,s[a]));case"enum":return i.every((o,a)=>ko(re.INT32,o,s[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,s);case"enum":return ko(re.INT32,i,s);case"scalar":return ko(r.T,i,s);case"oneof":if(i.case!==s.case)return!1;const o=r.findField(i.case);if(o===void 0)return!0;switch(o.kind){case"message":return o.T.equals(i.value,s.value);case"enum":return ko(re.INT32,i.value,s.value);case"scalar":return ko(o.T,i.value,s.value)}throw new Error("oneof cannot contain ".concat(o.kind));case"map":const a=Object.keys(i).concat(Object.keys(s));switch(r.V.kind){case"message":const c=r.V.T;return a.every(u=>c.equals(i[u],s[u]));case"enum":return a.every(u=>ko(re.INT32,i[u],s[u]));case"scalar":const l=r.V.T;return a.every(u=>ko(l,i[u],s[u]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const s=t[i.localName];let o;if(i.repeated)o=s.map(Gf);else if(i.kind=="map"){o=r[i.localName];for(const[a,c]of Object.entries(s))o[a]=Gf(c)}else i.kind=="oneof"?o=i.findField(s.case)?{case:s.case,value:Gf(s.value)}:{case:void 0}:o=Gf(s);r[i.localName]=o}return n}}}function Gf(t){if(t===void 0)return t;if(t instanceof pe)return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function Eu(t){return t instanceof Uint8Array?t:new Uint8Array(t)}class z8{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function SP(t,e){const n=bP(t);return e?n:Z8(J8(n))}function $8(t){return SP(t,!1)}const H8=bP;function bP(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const G8=new Set(["constructor","toString","toJSON","valueOf"]),q8=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),wP=t=>"".concat(t,"$"),J8=t=>q8.has(t)?wP(t):t,Z8=t=>G8.has(t)?wP(t):t;class K8{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=$8(e)}addField(e){cr(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}const P=w8("proto3",W8(),L8(),Object.assign(Object.assign({},V8()),{newFieldList(t){return new z8(t,Y8)},initFields(t){for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=qy(e.T,e.L);break}}}}));function Y8(t){var e,n,r,i;const s=[];let o;for(const a of typeof t=="function"?t():t){const c=a;if(c.localName=SP(a.name,a.oneof!==void 0),c.jsonName=(e=a.jsonName)!==null&&e!==void 0?e:H8(a.name),c.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(c.L=(r=a.L)!==null&&r!==void 0?r:Za.BIGINT),c.packed=(i=a.packed)!==null&&i!==void 0?i:a.kind=="enum"||a.kind=="scalar"&&a.T!=re.BYTES&&a.T!=re.STRING,a.oneof!==void 0){const l=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!o||o.name!=l)&&(o=new K8(l)),c.oneof=o,o.addField(c)}s.push(c)}return s}class mn extends pe{constructor(e){super(),this.seconds=xe.zero,this.nanos=0,P.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(P.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=xe.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return mn.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new mn({seconds:xe.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new mn().fromBinary(e,n)}static fromJson(e,n){return new mn().fromJson(e,n)}static fromJsonString(e,n){return new mn().fromJsonString(e,n)}static equals(e,n){return P.util.equals(mn,e,n)}}mn.runtime=P;mn.typeName="google.protobuf.Timestamp";mn.fields=P.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var Zy;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC"})(Zy||(Zy={}));P.util.setEnumType(Zy,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var Ky;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8"})(Ky||(Ky={}));P.util.setEnumType(Ky,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var Yy;(function(t){t[t.IC_DEFAULT=0]="IC_DEFAULT",t[t.IC_JPEG=1]="IC_JPEG"})(Yy||(Yy={}));P.util.setEnumType(Yy,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var Ln;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA"})(Ln||(Ln={}));P.util.setEnumType(Ln,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var Vt;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(Vt||(Vt={}));P.util.setEnumType(Vt,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var sn;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF"})(sn||(sn={}));P.util.setEnumType(sn,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var Ps;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.LOST=3]="LOST"})(Ps||(Ps={}));P.util.setEnumType(Ps,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var _i;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED"})(_i||(_i={}));P.util.setEnumType(_i,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var to;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE"})(to||(to={}));P.util.setEnumType(to,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var Es;(function(t){t[t.RR_UNKNOWN=0]="RR_UNKNOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(Es||(Es={}));P.util.setEnumType(Es,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var Md;(function(t){t[t.SE_UNKNOWN=0]="SE_UNKNOWN",t[t.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",t[t.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(Md||(Md={}));P.util.setEnumType(Md,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let eu=class Bu extends pe{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=xe.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new Bu().fromBinary(e,n)}static fromJson(e,n){return new Bu().fromJson(e,n)}static fromJsonString(e,n){return new Bu().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Bu,e,n)}};eu.runtime=P;eu.typeName="livekit.Room";eu.fields=P.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:hi,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class hi extends pe{constructor(e){super(),this.mime="",this.fmtpLine="",P.util.initPartial(e,this)}static fromBinary(e,n){return new hi().fromBinary(e,n)}static fromJson(e,n){return new hi().fromJson(e,n)}static fromJsonString(e,n){return new hi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(hi,e,n)}}hi.runtime=P;hi.typeName="livekit.Codec";hi.fields=P.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class Uo extends pe{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Uo().fromBinary(e,n)}static fromJson(e,n){return new Uo().fromJson(e,n)}static fromJsonString(e,n){return new Uo().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Uo,e,n)}}Uo.runtime=P;Uo.typeName="livekit.PlayoutDelay";Uo.fields=P.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class As extends pe{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new As().fromBinary(e,n)}static fromJson(e,n){return new As().fromJson(e,n)}static fromJsonString(e,n){return new As().fromJsonString(e,n)}static equals(e,n){return P.util.equals(As,e,n)}}As.runtime=P;As.typeName="livekit.ParticipantPermission";As.fields=P.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:P.getEnumType(Vt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class _r extends pe{constructor(e){super(),this.sid="",this.identity="",this.state=Ka.JOINING,this.tracks=[],this.metadata="",this.joinedAt=xe.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new _r().fromBinary(e,n)}static fromJson(e,n){return new _r().fromJson(e,n)}static fromJsonString(e,n){return new _r().fromJsonString(e,n)}static equals(e,n){return P.util.equals(_r,e,n)}}_r.runtime=P;_r.typeName="livekit.ParticipantInfo";_r.fields=P.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:P.getEnumType(Ka)},{no:4,name:"tracks",kind:"message",T:ur,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:As},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var Ka;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED"})(Ka||(Ka={}));P.util.setEnumType(Ka,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class jo extends pe{constructor(e){super(),P.util.initPartial(e,this)}static fromBinary(e,n){return new jo().fromBinary(e,n)}static fromJson(e,n){return new jo().fromJson(e,n)}static fromJsonString(e,n){return new jo().fromJsonString(e,n)}static equals(e,n){return P.util.equals(jo,e,n)}}jo.runtime=P;jo.typeName="livekit.Encryption";jo.fields=P.util.newFieldList(()=>[]);var Cn;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM"})(Cn||(Cn={}));P.util.setEnumType(Cn,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class Ns extends pe{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Ns().fromBinary(e,n)}static fromJson(e,n){return new Ns().fromJson(e,n)}static fromJsonString(e,n){return new Ns().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ns,e,n)}}Ns.runtime=P;Ns.typeName="livekit.SimulcastCodecInfo";Ns.fields=P.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:er,repeated:!0}]);class ur extends pe{constructor(e){super(),this.sid="",this.type=Ln.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=Vt.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=Cn.NONE,this.stream="",P.util.initPartial(e,this)}static fromBinary(e,n){return new ur().fromBinary(e,n)}static fromJson(e,n){return new ur().fromJson(e,n)}static fromJsonString(e,n){return new ur().fromJsonString(e,n)}static equals(e,n){return P.util.equals(ur,e,n)}}ur.runtime=P;ur.typeName="livekit.TrackInfo";ur.fields=P.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:P.getEnumType(Ln)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:P.getEnumType(Vt)},{no:10,name:"layers",kind:"message",T:er,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Ns,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:P.getEnumType(Cn)},{no:17,name:"stream",kind:"scalar",T:9}]);class er extends pe{constructor(e){super(),this.quality=sn.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new er().fromBinary(e,n)}static fromJson(e,n){return new er().fromJson(e,n)}static fromJsonString(e,n){return new er().fromJsonString(e,n)}static equals(e,n){return P.util.equals(er,e,n)}}er.runtime=P;er.typeName="livekit.VideoLayer";er.fields=P.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:P.getEnumType(sn)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class Vi extends pe{constructor(e){super(),this.kind=Xt.RELIABLE,this.value={case:void 0},P.util.initPartial(e,this)}static fromBinary(e,n){return new Vi().fromBinary(e,n)}static fromJson(e,n){return new Vi().fromJson(e,n)}static fromJsonString(e,n){return new Vi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Vi,e,n)}}Vi.runtime=P;Vi.typeName="livekit.DataPacket";Vi.fields=P.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:P.getEnumType(Xt)},{no:2,name:"user",kind:"message",T:$i,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Ms,oneof:"value"}]);var Xt;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY"})(Xt||(Xt={}));P.util.setEnumType(Xt,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class Ms extends pe{constructor(e){super(),this.speakers=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Ms().fromBinary(e,n)}static fromJson(e,n){return new Ms().fromJson(e,n)}static fromJsonString(e,n){return new Ms().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ms,e,n)}}Ms.runtime=P;Ms.typeName="livekit.ActiveSpeakerUpdate";Ms.fields=P.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:zi,repeated:!0}]);class zi extends pe{constructor(e){super(),this.sid="",this.level=0,this.active=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new zi().fromBinary(e,n)}static fromJson(e,n){return new zi().fromJson(e,n)}static fromJsonString(e,n){return new zi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(zi,e,n)}}zi.runtime=P;zi.typeName="livekit.SpeakerInfo";zi.fields=P.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class $i extends pe{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new $i().fromBinary(e,n)}static fromJson(e,n){return new $i().fromJson(e,n)}static fromJsonString(e,n){return new $i().fromJsonString(e,n)}static equals(e,n){return P.util.equals($i,e,n)}}$i.runtime=P;$i.typeName="livekit.UserPacket";$i.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class Hi extends pe{constructor(e){super(),this.participantSid="",this.trackSids=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Hi().fromBinary(e,n)}static fromJson(e,n){return new Hi().fromJson(e,n)}static fromJsonString(e,n){return new Hi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Hi,e,n)}}Hi.runtime=P;Hi.typeName="livekit.ParticipantTracks";Hi.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class xs extends pe{constructor(e){super(),this.edition=Nl.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",P.util.initPartial(e,this)}static fromBinary(e,n){return new xs().fromBinary(e,n)}static fromJson(e,n){return new xs().fromJson(e,n)}static fromJsonString(e,n){return new xs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(xs,e,n)}}xs.runtime=P;xs.typeName="livekit.ServerInfo";xs.fields=P.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:P.getEnumType(Nl)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var Nl;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud"})(Nl||(Nl={}));P.util.setEnumType(Nl,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class Os extends pe{constructor(e){super(),this.sdk=Ml.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",P.util.initPartial(e,this)}static fromBinary(e,n){return new Os().fromBinary(e,n)}static fromJson(e,n){return new Os().fromJson(e,n)}static fromJsonString(e,n){return new Os().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Os,e,n)}}Os.runtime=P;Os.typeName="livekit.ClientInfo";Os.fields=P.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:P.getEnumType(Ml)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var Ml;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.PYTHON=9]="PYTHON",t[t.CPP=10]="CPP"})(Ml||(Ml={}));P.util.setEnumType(Ml,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class Gi extends pe{constructor(e){super(),this.resumeConnection=_i.UNSET,this.forceRelay=_i.UNSET,P.util.initPartial(e,this)}static fromBinary(e,n){return new Gi().fromBinary(e,n)}static fromJson(e,n){return new Gi().fromJson(e,n)}static fromJsonString(e,n){return new Gi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Gi,e,n)}}Gi.runtime=P;Gi.typeName="livekit.ClientConfiguration";Gi.fields=P.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:qi},{no:2,name:"screen",kind:"message",T:qi},{no:3,name:"resume_connection",kind:"enum",T:P.getEnumType(_i)},{no:4,name:"disabled_codecs",kind:"message",T:Ds},{no:5,name:"force_relay",kind:"enum",T:P.getEnumType(_i)}]);class qi extends pe{constructor(e){super(),this.hardwareEncoder=_i.UNSET,P.util.initPartial(e,this)}static fromBinary(e,n){return new qi().fromBinary(e,n)}static fromJson(e,n){return new qi().fromJson(e,n)}static fromJsonString(e,n){return new qi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(qi,e,n)}}qi.runtime=P;qi.typeName="livekit.VideoConfiguration";qi.fields=P.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:P.getEnumType(_i)}]);class Ds extends pe{constructor(e){super(),this.codecs=[],this.publish=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Ds().fromBinary(e,n)}static fromJson(e,n){return new Ds().fromJson(e,n)}static fromJsonString(e,n){return new Ds().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ds,e,n)}}Ds.runtime=P;Ds.typeName="livekit.DisabledCodecs";Ds.fields=P.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:hi,repeated:!0},{no:2,name:"publish",kind:"message",T:hi,repeated:!0}]);class Ji extends pe{constructor(e){super(),this.duration=0,this.startTimestamp=xe.zero,this.endTimestamp=xe.zero,this.rtpClockTicks=xe.zero,this.driftSamples=xe.zero,this.driftMs=0,this.clockRate=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Ji().fromBinary(e,n)}static fromJson(e,n){return new Ji().fromJson(e,n)}static fromJsonString(e,n){return new Ji().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ji,e,n)}}Ji.runtime=P;Ji.typeName="livekit.RTPDrift";Ji.fields=P.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:mn},{no:2,name:"end_time",kind:"message",T:mn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class Wo extends pe{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=xe.zero,this.headerBytes=xe.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=xe.zero,this.headerBytesDuplicate=xe.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=xe.zero,this.headerBytesPadding=xe.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Wo().fromBinary(e,n)}static fromJson(e,n){return new Wo().fromJson(e,n)}static fromJsonString(e,n){return new Wo().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Wo,e,n)}}Wo.runtime=P;Wo.typeName="livekit.RTPStats";Wo.fields=P.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:mn},{no:2,name:"end_time",kind:"message",T:mn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:mn},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:mn},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:mn},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:mn},{no:44,name:"packet_drift",kind:"message",T:Ji},{no:45,name:"report_drift",kind:"message",T:Ji}]);class Vo extends pe{constructor(e){super(),this.unixMicro=xe.zero,this.ticks=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Vo().fromBinary(e,n)}static fromJson(e,n){return new Vo().fromJson(e,n)}static fromJsonString(e,n){return new Vo().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Vo,e,n)}}Vo.runtime=P;Vo.typeName="livekit.TimedVersion";Vo.fields=P.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const Cu=7e3,X8=[0,300,2*2*300,3*3*300,4*4*300,Cu,Cu,Cu,Cu,Cu];class Q8{constructor(e){this._retryDelays=e!==void 0?[...e]:X8}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function U(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function BE(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Tc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof BE=="function"?BE(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var vb={exports:{}},al=typeof Reflect=="object"?Reflect:null,UE=al&&typeof al.apply=="function"?al.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Rh;al&&typeof al.ownKeys=="function"?Rh=al.ownKeys:Object.getOwnPropertySymbols?Rh=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Rh=function(e){return Object.getOwnPropertyNames(e)};function ej(t){console&&console.warn&&console.warn(t)}var kP=Number.isNaN||function(e){return e!==e};function nt(){nt.init.call(this)}vb.exports=nt;vb.exports.once=ij;nt.EventEmitter=nt;nt.prototype._events=void 0;nt.prototype._eventsCount=0;nt.prototype._maxListeners=void 0;var jE=10;function km(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(nt,"defaultMaxListeners",{enumerable:!0,get:function(){return jE},set:function(t){if(typeof t!="number"||t<0||kP(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");jE=t}});nt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};nt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||kP(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function EP(t){return t._maxListeners===void 0?nt.defaultMaxListeners:t._maxListeners}nt.prototype.getMaxListeners=function(){return EP(this)};nt.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")UE(c,this,n);else for(var l=c.length,u=RP(c,l),r=0;r<l;++r)UE(u[r],this,n);return!0};function CP(t,e,n,r){var i,s,o;if(km(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),i=EP(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,ej(a)}return t}nt.prototype.addListener=function(e,n){return CP(this,e,n,!1)};nt.prototype.on=nt.prototype.addListener;nt.prototype.prependListener=function(e,n){return CP(this,e,n,!0)};function tj(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function TP(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=tj.bind(r);return i.listener=n,r.wrapFn=i,i}nt.prototype.once=function(e,n){return km(n),this.on(e,TP(this,e,n)),this};nt.prototype.prependOnceListener=function(e,n){return km(n),this.prependListener(e,TP(this,e,n)),this};nt.prototype.removeListener=function(e,n){var r,i,s,o,a;if(km(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():nj(r,s),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};nt.prototype.off=nt.prototype.removeListener;nt.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function _P(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?rj(i):RP(i,i.length)}nt.prototype.listeners=function(e){return _P(this,e,!0)};nt.prototype.rawListeners=function(e){return _P(this,e,!1)};nt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):IP.call(t,e)};nt.prototype.listenerCount=IP;function IP(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}nt.prototype.eventNames=function(){return this._eventsCount>0?Rh(this._events):[]};function RP(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function nj(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function rj(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function ij(t,e){return new Promise(function(n,r){function i(o){t.removeListener(e,s),r(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}PP(t,e,s,{once:!0}),e!=="error"&&sj(t,i,{once:!0})})}function sj(t,e,n){typeof t.on=="function"&&PP(t,"error",e,n)}function PP(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){r.once&&t.removeEventListener(e,i),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var vs=vb.exports;let AP=!0,NP=!0;function Ph(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function uc(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(o,a){if(o!==e)return i.apply(this,arguments);const c=l=>{const u=n(l);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,c),i.apply(this,[o,c])};const s=r.removeEventListener;r.removeEventListener=function(o,a){if(o!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(a))return s.apply(this,arguments);const c=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[o,c])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function oj(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(AP=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function aj(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(NP=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function MP(){if(typeof window=="object"){if(AP)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function yb(t,e){NP&&console.warn(t+" is deprecated, please use "+e+" instead.")}function cj(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=Ph(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=Ph(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Ph(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function WE(t){return Object.prototype.toString.call(t)==="[object Object]"}function xP(t){return WE(t)?Object.keys(t).reduce(function(e,n){const r=WE(t[n]),i=r?xP(t[n]):t[n],s=r&&!Object.keys(i).length;return i===void 0||s?e:Object.assign(e,{[n]:i})},{}):t}function Xy(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Xy(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{Xy(t,t.get(i),n)})}))}function VE(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const s=[];return t.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&s.push(o)}),s.forEach(o=>{t.forEach(a=>{a.type===r&&a.trackId===o.id&&Xy(t,a,i)})}),i}const zE=MP;function OP(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const c={};return Object.keys(a).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof a[l]=="object"?a[l]:{ideal:a[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(f,h){return f?f+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(u.ideal!==void 0){c.optional=c.optional||[];let f={};typeof u.ideal=="number"?(f[d("min",l)]=u.ideal,c.optional.push(f),f={},f[d("max",l)]=u.ideal,c.optional.push(f)):(f[d("",l)]=u.ideal,c.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[d("",l)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[d(f,l)]=u[f])})}),a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced)),c},i=function(a,c){if(e.version>=61)return c(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const l=function(u,d,f){d in u&&!(f in u)&&(u[f]=u[d],delete u[d])};a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","googAutoGainControl"),l(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let l=a.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let d;if(l.exact==="environment"||l.ideal==="environment"?d=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(p=>p.kind==="videoinput");let h=f.find(p=>d.some(g=>p.label.toLowerCase().includes(g)));return!h&&f.length&&d.includes("back")&&(h=f[f.length-1]),h&&(a.video.deviceId=l.exact?{exact:h.deviceId}:{ideal:h.deviceId}),a.video=r(a.video),zE("chrome: "+JSON.stringify(a)),c(a)})}a.video=r(a.video)}return zE("chrome: "+JSON.stringify(a)),c(a)},s=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(a,c,l){i(a,u=>{n.webkitGetUserMedia(u,c,d=>{l&&l(s(d))})})};if(n.getUserMedia=o.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return i(c,l=>a(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(s(u))))}}}function lj(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const s=r.video&&r.video.width,o=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},s&&(r.video.mandatory.maxWidth=s),o&&(r.video.mandatory.maxHeight=o),t.navigator.mediaDevices.getUserMedia(r)})}}}function DP(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function LP(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):s={track:i.track};const o=new Event("track");o.track=i.track,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(i=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.id):s={track:i};const o=new Event("track");o.track=i,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else uc(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function FP(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=i.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,c){let l=i.apply(this,arguments);return l||(l=e(this,a),this._senders.push(l)),l};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){s.apply(this,arguments);const c=this._senders.indexOf(a);c!==-1&&this._senders.splice(c,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],n.apply(this,[s]),s.getTracks().forEach(o=>{this._senders.push(e(this,o))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],r.apply(this,[s]),s.getTracks().forEach(o=>{const a=this._senders.find(c=>c.track===o);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function BP(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[r,i,s]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const o=function(c){const l={};return c.result().forEach(d=>{const f={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach(h=>{f[h]=d.stat(h)}),l[f.id]=f}),l},a=function(c){return new Map(Object.keys(c).map(l=>[l,c[l]]))};if(arguments.length>=2){const c=function(l){i(a(o(l)))};return e.apply(this,[c,r])}return new Promise((c,l)=>{e.apply(this,[function(u){c(a(o(u)))},l])}).then(i,s)}}function UP(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=n.apply(this,[]);return s.forEach(o=>o._pc=this),s});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(o=>VE(o,s.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(s=>s._pc=this),i}),uc(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(s=>VE(s,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,s,o;return this.getSenders().forEach(a=>{a.track===r&&(i?o=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(s?o=!0:s=a),a.track===r)),o||i&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function jP(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(c)===-1&&this._shimmedLocalStreams[a.id].push(c):this._shimmedLocalStreams[a.id]=[a,c],c};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(l=>{if(this.getSenders().find(d=>d.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(l=>a.indexOf(l)===-1);this._shimmedLocalStreams[o.id]=[o].concat(c)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const c=this._shimmedLocalStreams[a].indexOf(o);c!==-1&&this._shimmedLocalStreams[a].splice(c,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function WP(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return jP(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(d=>this._reverseStreams[d.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(d=>{if(this.getSenders().find(h=>h.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const d=new t.MediaStream(u.getTracks());this._streams[u.id]=d,this._reverseStreams[d.id]=u,u=d}r.apply(this,[u])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(g=>g===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(g=>g.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[d.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const g=new t.MediaStream([u]);this._streams[d.id]=g,this._reverseStreams[g.id]=d,this.addStream(g)}return this.getSenders().find(g=>g.track===u)};function s(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const h=l._reverseStreams[f],p=l._streams[h.id];d=d.replace(new RegExp(p.id,"g"),h.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function o(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const h=l._reverseStreams[f],p=l._streams[h.id];d=d.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],d={[l](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const g=s(this,p);f[0].apply(null,[g])},p=>{f[1]&&f[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>s(this,p))}};t.RTCPeerConnection.prototype[l]=d[l]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=o(this,arguments[0]),a.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:s(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(g=>u.track===g)&&(f=this._streams[h])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Qy(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function VP(t,e){uc(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var $E=Object.freeze({__proto__:null,fixNegotiationNeeded:VP,shimAddTrackRemoveTrack:WP,shimAddTrackRemoveTrackWithNative:jP,shimGetDisplayMedia:lj,shimGetSendersWithDtmf:FP,shimGetStats:BP,shimGetUserMedia:OP,shimMediaStream:DP,shimOnTrack:LP,shimPeerConnection:Qy,shimSenderReceiverGetStats:UP});function zP(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,s,o){yb("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(s,o)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(o,a,c){a in o&&!(c in o)&&(o[c]=o[a],delete o[a])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o.audio,"autoGainControl","mozAutoGainControl"),i(o.audio,"noiseSuppression","mozNoiseSuppression")),s(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const a=o.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[a])}}}}function uj(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function $P(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function e0(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=t.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=o[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[s,o,a]=arguments;return r.apply(this,[s||null]).then(c=>{if(e.version<53&&!o)try{c.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((u,d)=>{c.set(d,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(o,a)}}function HP(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(s=>s._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function GP(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),uc(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function qP(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){yb("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function JP(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function ZP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(i){const{sender:o}=s,a=o.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(a).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return s})}function KP(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function YP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function XP(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var HE=Object.freeze({__proto__:null,shimAddTransceiver:ZP,shimCreateAnswer:XP,shimCreateOffer:YP,shimGetDisplayMedia:uj,shimGetParameters:KP,shimGetUserMedia:zP,shimOnTrack:$P,shimPeerConnection:e0,shimRTCDataChannel:JP,shimReceiverGetStats:GP,shimRemoveStream:qP,shimSenderGetStats:HP});function QP(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return s&&s.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(s=>{i.includes(s.track)&&this.removeTrack(s)})})}}function eA(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const s=new Event("addstream");s.stream=i,this.dispatchEvent(s)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(s=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(s)>=0)return;r._remoteStreams.push(s);const o=new Event("addstream");o.stream=s,r.dispatchEvent(o)})}),e.apply(r,arguments)}}}function tA(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,s=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[d]);return u?(f.then(l,u),Promise.resolve()):f},e.createAnswer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[d]);return u?(f.then(l,u),Promise.resolve()):f};let a=function(c,l,u){const d=i.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d};e.setLocalDescription=a,a=function(c,l,u){const d=s.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.setRemoteDescription=a,a=function(c,l,u){const d=o.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.addIceCandidate=a}function nA(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(rA(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,s){e.mediaDevices.getUserMedia(r).then(i,s)}).bind(e))}function rA(t){return t&&t.video!==void 0?Object.assign({},t,{video:xP(t.video)}):t}function iA(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const s=[];for(let o=0;o<r.iceServers.length;o++){let a=r.iceServers[o];a.urls===void 0&&a.url?(yb("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,s.push(a)):s.push(r.iceServers[o])}r.iceServers=s}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function sA(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function oA(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const s=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function aA(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var GE=Object.freeze({__proto__:null,shimAudioContext:aA,shimCallbacksAPI:tA,shimConstraints:rA,shimCreateOfferLegacy:oA,shimGetUserMedia:nA,shimLocalStreamsAPI:QP,shimRTCIceServerUrls:iA,shimRemoteStreamsAPI:eA,shimTrackEventTransceiver:sA}),cA={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((i,s)=>(s>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":i.relatedAddress=r[s+1];break;case"rport":i.relatedPort=parseInt(r[s+1],10);break;case"tcptype":i.tcpType=r[s+1];break;case"ufrag":i.ufrag=r[s+1],i.usernameFragment=r[s+1];break;default:i[r[s]]===void 0&&(i[r[s]]=r[s+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const s=n.type;return r.push("typ"),r.push(s),s!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const s=n.substring(n.indexOf(" ")+1).split(";");for(let o=0;o<s.length;o++)i=s[o].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const s=[];Object.keys(n.parameters).forEach(o=>{n.parameters[o]!==void 0?s.push(o+"="+n.parameters[o]):s.push(o)}),r+="a=fmtp:"+i+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+i+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},s=n.indexOf(":",r);return s>-1?(i.attribute=n.substring(r+1,s),i.value=n.substring(s+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(s=>{i+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],s=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(n)[0].split(" ");r.profile=s[2];for(let a=3;a<s.length;a++){const c=s[a],l=e.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(l){const u=e.parseRtpMap(l),d=e.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=d.length?e.parseFmtp(d[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const o=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{o.forEach(c=>{a.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||a.rtcpFeedback.push(c)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{i+=e.writeRtpMap(o),i+=e.writeFmtp(o),i+=e.writeRtcpFb(o)});let s=0;return r.codecs.forEach(o=>{o.maxptime>s&&(s=o.maxptime)}),s>0&&(i+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{i+=e.writeExtmap(o)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),s=i.fecMechanisms.indexOf("RED")!==-1,o=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(n,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),c=a.length>0&&a[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let h={ssrc:c,codecPayloadType:parseInt(f.parameters.apt,10)};c&&l&&(h.rtx={ssrc:l}),r.push(h),s&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},r.push(h))}}),r.length===0&&c&&r.push({ssrc:c});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(f=>{f.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const s=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const o=e.matchPrefix(n,"a=rtcp-mux");return r.mux=o.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let s;i.length>0&&(s=parseInt(i[0].substring(19),10)),isNaN(s)&&(s=65536);const o=e.matchPrefix(n,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const a=e.matchPrefix(n,"a=sctpmap:");if(a.length>0){const c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:s}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let s;const o=r!==void 0?r:2;return n?s=n:s=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+s+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let s=0;s<i.length;s++)switch(i[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const i=e.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(n){const i=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e})(cA);var lA=cA.exports,cl=f8(lA),dj=u8({__proto__:null,default:cl},[lA]);function Ah(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),s=cl.parseCandidate(r.candidate);for(const o in s)o in i||Object.defineProperty(i,o,{value:s[o]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,uc(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function t0(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||uc(t,"icecandidate",e=>{if(e.candidate){const n=cl.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Nh(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const c=cl.splitSections(a.sdp);return c.shift(),c.some(l=>{const u=cl.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(a){const c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},i=function(a){let c=65536;return e.browser==="firefox"&&(e.version<57?a===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},s=function(a,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=cl.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=r(arguments[0]),l=i(c),u=s(arguments[0],c);let d;l===0&&u===0?d=Number.POSITIVE_INFINITY:l===0||u===0?d=Math.max(l,u):d=Math.min(l,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return o.apply(this,arguments)}}function Mh(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const s=r.send;r.send=function(){const a=arguments[0],c=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&c>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},uc(t,"datachannel",r=>(e(r.channel,r.target),r))}function n0(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const s=i.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const o=new Event("connectionstatechange",i);s.dispatchEvent(o)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function r0(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=i.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:s}):i.sdp=s}return n.apply(this,arguments)}}function xh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Oh(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>n.apply(this,[o]))})}var fj=Object.freeze({__proto__:null,removeExtmapAllowMixed:r0,shimAddIceCandidateNullOrEmpty:xh,shimConnectionState:n0,shimMaxMessageSize:Nh,shimParameterlessSetLocalDescription:Oh,shimRTCIceCandidate:Ah,shimRTCIceCandidateRelayProtocol:t0,shimSendThrowTypeError:Mh});function hj(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=MP,r=cj(t),i={browserDetails:r,commonShim:fj,extractVersion:Ph,disableLog:oj,disableWarnings:aj,sdp:dj};switch(r.browser){case"chrome":if(!$E||!Qy||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=$E,xh(t,r),Oh(t),OP(t,r),DP(t),Qy(t,r),LP(t),WP(t,r),FP(t),BP(t),UP(t),VP(t,r),Ah(t),t0(t),n0(t),Nh(t,r),Mh(t),r0(t,r);break;case"firefox":if(!HE||!e0||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=HE,xh(t,r),Oh(t),zP(t,r),e0(t,r),$P(t),qP(t),HP(t),GP(t),JP(t),ZP(t),KP(t),YP(t),XP(t),Ah(t),n0(t),Nh(t,r),Mh(t);break;case"safari":if(!GE||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=GE,xh(t,r),Oh(t),iA(t),oA(t),tA(t),QP(t),eA(t),sA(t),nA(t),aA(t),Ah(t),t0(t),Nh(t,r),Mh(t),r0(t,r);break;default:n("Unsupported browser!");break}return i}hj({window:typeof window>"u"?void 0:window});const pj=10,qf="lk_e2ee",mj="LKFrameEncryptionKey",gj={sharedKey:!1,ratchetSalt:mj,ratchetWindowSize:8,failureTolerance:pj};var ta;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(ta||(ta={}));var qE;(function(t){t.KeyRatcheted="keyRatcheted"})(qE||(qE={}));var zo;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(zo||(zo={}));var JE;(function(t){t.Error="cryptorError"})(JE||(JE={}));function vj(){return yj()||i0()}function i0(){return typeof window.RTCRtpScriptTransform<"u"}function yj(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class BQ extends vs.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{F.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},gj),e),this.on(ta.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(ta.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(ta.RatchetRequest,e,n)}}class tu extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}class Pt extends tu{constructor(e,n,r){super(1,e),this.status=r,this.reason=n}}class Sb extends tu{constructor(e){super(21,e??"device is unsupported")}}class Fi extends tu{constructor(e){super(20,e??"track is invalid")}}class Sj extends tu{constructor(e){super(10,e??"unsupported server")}}class Yt extends tu{constructor(e){super(12,e??"unexpected connection state")}}class s0 extends tu{constructor(e){super(13,e??"unable to negotiate")}}var xd;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(xd||(xd={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(xd||(xd={}));var ne;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.StateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged"})(ne||(ne={}));var oe;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded"})(oe||(oe={}));var ge;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished"})(ge||(ge={}));var fe;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed"})(fe||(fe={}));function bb(t,e,n){var r,i,s;e===void 0&&(e=50),n===void 0&&(n={});var o=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,c=n.maxWait,l=Date.now(),u=[];function d(){if(c!==void 0){var h=Date.now()-l;if(h+e>=c)return c-h}return e}var f=function(){var h=[].slice.call(arguments),p=this;return new Promise(function(g,y){var m=o&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,l=Date.now(),!o){var w=t.apply(p,h);a&&a(w),u.forEach(function(_){return(0,_.resolve)(w)}),u=[]}},d()),m){var v=t.apply(p,h);return a&&a(v),g(v)}u.push({resolve:g,reject:y})})};return f.cancel=function(h){s!==void 0&&clearTimeout(s),u.forEach(function(p){return(0,p.reject)(h)}),u=[]},f}const bj=/version\/(\d+(\.?_?\d+)+)/i;let Zg;function ca(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof t>"u"&&typeof navigator>"u")return;const n=(t??navigator.userAgent).toLowerCase();if(Zg===void 0||e){const r=wj.find(i=>{let{test:s}=i;return s.test(n)});Zg=r==null?void 0:r.describe(n)}return Zg}const wj=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Kg(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Kg(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Kg(bj,t),os:t.includes("mobile/")?"iOS":"macOS"}}}];function Kg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}var kj="1.15.5";const Ej=kj,Cj=11;class Tn{}Tn.setTimeout=function(){return setTimeout(...arguments)};Tn.setInterval=function(){return setInterval(...arguments)};Tn.clearTimeout=function(){return clearTimeout(...arguments)};Tn.clearInterval=function(){return clearInterval(...arguments)};class pt{constructor(e,n,r,i,s){this.width=e,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i,priority:s}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const Tj=["vp8","h264"],uA=["vp8","h264","vp9","av1"];function _j(t){return!!Tj.find(e=>e===t)}var _p;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:2e4},t.music={maxBitrate:32e3},t.musicStereo={maxBitrate:48e3},t.musicHighQuality={maxBitrate:64e3},t.musicHighQualityStereo={maxBitrate:96e3}})(_p||(_p={}));const Od={h90:new pt(160,90,9e4,20),h180:new pt(320,180,16e4,20),h216:new pt(384,216,18e4,20),h360:new pt(640,360,45e4,20),h540:new pt(960,540,8e5,25),h720:new pt(1280,720,17e5,30),h1080:new pt(1920,1080,3e6,30),h1440:new pt(2560,1440,5e6,30),h2160:new pt(3840,2160,8e6,30)},o0={h120:new pt(160,120,7e4,20),h180:new pt(240,180,125e3,20),h240:new pt(320,240,14e4,20),h360:new pt(480,360,33e4,20),h480:new pt(640,480,5e5,20),h540:new pt(720,540,6e5,25),h720:new pt(960,720,13e5,30),h1080:new pt(1440,1080,23e5,30),h1440:new pt(1920,1440,38e5,30)},dA={h360fps3:new pt(640,360,2e5,3,"medium"),h720fps5:new pt(1280,720,4e5,5,"medium"),h720fps15:new pt(1280,720,15e5,15,"medium"),h720fps30:new pt(1280,720,2e6,30,"medium"),h1080fps15:new pt(1920,1080,25e5,15,"medium"),h1080fps30:new pt(1920,1080,4e6,30,"medium")};var Fn;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER"})(Fn||(Fn={}));P.util.setEnumType(Fn,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var Ya;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.PAUSED=1]="PAUSED"})(Ya||(Ya={}));P.util.setEnumType(Ya,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var Ip;(function(t){t[t.UDP=0]="UDP",t[t.TCP=1]="TCP",t[t.TLS=2]="TLS"})(Ip||(Ip={}));P.util.setEnumType(Ip,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class Ls extends pe{constructor(e){super(),this.message={case:void 0},P.util.initPartial(e,this)}static fromBinary(e,n){return new Ls().fromBinary(e,n)}static fromJson(e,n){return new Ls().fromJson(e,n)}static fromJsonString(e,n){return new Ls().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ls,e,n)}}Ls.runtime=P;Ls.typeName="livekit.SignalRequest";Ls.fields=P.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:tr,oneof:"message"},{no:2,name:"answer",kind:"message",T:tr,oneof:"message"},{no:3,name:"trickle",kind:"message",T:gi,oneof:"message"},{no:4,name:"add_track",kind:"message",T:mi,oneof:"message"},{no:5,name:"mute",kind:"message",T:vi,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Wr,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:Ki,oneof:"message"},{no:8,name:"leave",kind:"message",T:Vr,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Yi,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:ts,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:ns,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Kn,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Xi,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:is,oneof:"message"}]);class Zi extends pe{constructor(e){super(),this.message={case:void 0},P.util.initPartial(e,this)}static fromBinary(e,n){return new Zi().fromBinary(e,n)}static fromJson(e,n){return new Zi().fromJson(e,n)}static fromJsonString(e,n){return new Zi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Zi,e,n)}}Zi.runtime=P;Zi.typeName="livekit.SignalResponse";Zi.fields=P.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:Fs,oneof:"message"},{no:2,name:"answer",kind:"message",T:tr,oneof:"message"},{no:3,name:"offer",kind:"message",T:tr,oneof:"message"},{no:4,name:"trickle",kind:"message",T:gi,oneof:"message"},{no:5,name:"update",kind:"message",T:js,oneof:"message"},{no:6,name:"track_published",kind:"message",T:yi,oneof:"message"},{no:8,name:"leave",kind:"message",T:Vr,oneof:"message"},{no:9,name:"mute",kind:"message",T:vi,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Ws,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Vs,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:$s,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:Gs,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Js,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Zs,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:Us,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:Bs,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Ks,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Xs,oneof:"message"}]);class pi extends pe{constructor(e){super(),this.codec="",this.cid="",P.util.initPartial(e,this)}static fromBinary(e,n){return new pi().fromBinary(e,n)}static fromJson(e,n){return new pi().fromJson(e,n)}static fromJsonString(e,n){return new pi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(pi,e,n)}}pi.runtime=P;pi.typeName="livekit.SimulcastCodec";pi.fields=P.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class mi extends pe{constructor(e){super(),this.cid="",this.name="",this.type=Ln.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=Vt.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=Cn.NONE,this.stream="",P.util.initPartial(e,this)}static fromBinary(e,n){return new mi().fromBinary(e,n)}static fromJson(e,n){return new mi().fromJson(e,n)}static fromJsonString(e,n){return new mi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(mi,e,n)}}mi.runtime=P;mi.typeName="livekit.AddTrackRequest";mi.fields=P.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:P.getEnumType(Ln)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:P.getEnumType(Vt)},{no:9,name:"layers",kind:"message",T:er,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:pi,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:P.getEnumType(Cn)},{no:15,name:"stream",kind:"scalar",T:9}]);class gi extends pe{constructor(e){super(),this.candidateInit="",this.target=Fn.PUBLISHER,P.util.initPartial(e,this)}static fromBinary(e,n){return new gi().fromBinary(e,n)}static fromJson(e,n){return new gi().fromJson(e,n)}static fromJsonString(e,n){return new gi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(gi,e,n)}}gi.runtime=P;gi.typeName="livekit.TrickleRequest";gi.fields=P.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:P.getEnumType(Fn)}]);class vi extends pe{constructor(e){super(),this.sid="",this.muted=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new vi().fromBinary(e,n)}static fromJson(e,n){return new vi().fromJson(e,n)}static fromJsonString(e,n){return new vi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(vi,e,n)}}vi.runtime=P;vi.typeName="livekit.MuteTrackRequest";vi.fields=P.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class Fs extends pe{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),P.util.initPartial(e,this)}static fromBinary(e,n){return new Fs().fromBinary(e,n)}static fromJson(e,n){return new Fs().fromJson(e,n)}static fromJsonString(e,n){return new Fs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Fs,e,n)}}Fs.runtime=P;Fs.typeName="livekit.JoinResponse";Fs.fields=P.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:eu},{no:2,name:"participant",kind:"message",T:_r},{no:3,name:"other_participants",kind:"message",T:_r,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Qi,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Gi},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:xs},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class Bs extends pe{constructor(e){super(),this.iceServers=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Bs().fromBinary(e,n)}static fromJson(e,n){return new Bs().fromJson(e,n)}static fromJsonString(e,n){return new Bs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Bs,e,n)}}Bs.runtime=P;Bs.typeName="livekit.ReconnectResponse";Bs.fields=P.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:Qi,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Gi}]);class yi extends pe{constructor(e){super(),this.cid="",P.util.initPartial(e,this)}static fromBinary(e,n){return new yi().fromBinary(e,n)}static fromJson(e,n){return new yi().fromJson(e,n)}static fromJsonString(e,n){return new yi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(yi,e,n)}}yi.runtime=P;yi.typeName="livekit.TrackPublishedResponse";yi.fields=P.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:ur}]);class Us extends pe{constructor(e){super(),this.trackSid="",P.util.initPartial(e,this)}static fromBinary(e,n){return new Us().fromBinary(e,n)}static fromJson(e,n){return new Us().fromJson(e,n)}static fromJsonString(e,n){return new Us().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Us,e,n)}}Us.runtime=P;Us.typeName="livekit.TrackUnpublishedResponse";Us.fields=P.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class tr extends pe{constructor(e){super(),this.type="",this.sdp="",P.util.initPartial(e,this)}static fromBinary(e,n){return new tr().fromBinary(e,n)}static fromJson(e,n){return new tr().fromJson(e,n)}static fromJsonString(e,n){return new tr().fromJsonString(e,n)}static equals(e,n){return P.util.equals(tr,e,n)}}tr.runtime=P;tr.typeName="livekit.SessionDescription";tr.fields=P.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class js extends pe{constructor(e){super(),this.participants=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new js().fromBinary(e,n)}static fromJson(e,n){return new js().fromJson(e,n)}static fromJsonString(e,n){return new js().fromJsonString(e,n)}static equals(e,n){return P.util.equals(js,e,n)}}js.runtime=P;js.typeName="livekit.ParticipantUpdate";js.fields=P.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:_r,repeated:!0}]);class Wr extends pe{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Wr().fromBinary(e,n)}static fromJson(e,n){return new Wr().fromJson(e,n)}static fromJsonString(e,n){return new Wr().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Wr,e,n)}}Wr.runtime=P;Wr.typeName="livekit.UpdateSubscription";Wr.fields=P.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Hi,repeated:!0}]);class Ki extends pe{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=sn.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new Ki().fromBinary(e,n)}static fromJson(e,n){return new Ki().fromJson(e,n)}static fromJsonString(e,n){return new Ki().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ki,e,n)}}Ki.runtime=P;Ki.typeName="livekit.UpdateTrackSettings";Ki.fields=P.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:P.getEnumType(sn)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class Vr extends pe{constructor(e){super(),this.canReconnect=!1,this.reason=to.UNKNOWN_REASON,P.util.initPartial(e,this)}static fromBinary(e,n){return new Vr().fromBinary(e,n)}static fromJson(e,n){return new Vr().fromJson(e,n)}static fromJsonString(e,n){return new Vr().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Vr,e,n)}}Vr.runtime=P;Vr.typeName="livekit.LeaveRequest";Vr.fields=P.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:P.getEnumType(to)}]);class Yi extends pe{constructor(e){super(),this.trackSid="",this.layers=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Yi().fromBinary(e,n)}static fromJson(e,n){return new Yi().fromJson(e,n)}static fromJsonString(e,n){return new Yi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Yi,e,n)}}Yi.runtime=P;Yi.typeName="livekit.UpdateVideoLayers";Yi.fields=P.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:er,repeated:!0}]);class Xi extends pe{constructor(e){super(),this.metadata="",this.name="",P.util.initPartial(e,this)}static fromBinary(e,n){return new Xi().fromBinary(e,n)}static fromJson(e,n){return new Xi().fromJson(e,n)}static fromJsonString(e,n){return new Xi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Xi,e,n)}}Xi.runtime=P;Xi.typeName="livekit.UpdateParticipantMetadata";Xi.fields=P.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class Qi extends pe{constructor(e){super(),this.urls=[],this.username="",this.credential="",P.util.initPartial(e,this)}static fromBinary(e,n){return new Qi().fromBinary(e,n)}static fromJson(e,n){return new Qi().fromJson(e,n)}static fromJsonString(e,n){return new Qi().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Qi,e,n)}}Qi.runtime=P;Qi.typeName="livekit.ICEServer";Qi.fields=P.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class Ws extends pe{constructor(e){super(),this.speakers=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Ws().fromBinary(e,n)}static fromJson(e,n){return new Ws().fromJson(e,n)}static fromJsonString(e,n){return new Ws().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ws,e,n)}}Ws.runtime=P;Ws.typeName="livekit.SpeakersChanged";Ws.fields=P.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:zi,repeated:!0}]);class Vs extends pe{constructor(e){super(),P.util.initPartial(e,this)}static fromBinary(e,n){return new Vs().fromBinary(e,n)}static fromJson(e,n){return new Vs().fromJson(e,n)}static fromJsonString(e,n){return new Vs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Vs,e,n)}}Vs.runtime=P;Vs.typeName="livekit.RoomUpdate";Vs.fields=P.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:eu}]);class zs extends pe{constructor(e){super(),this.participantSid="",this.quality=Ps.POOR,this.score=0,P.util.initPartial(e,this)}static fromBinary(e,n){return new zs().fromBinary(e,n)}static fromJson(e,n){return new zs().fromJson(e,n)}static fromJsonString(e,n){return new zs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(zs,e,n)}}zs.runtime=P;zs.typeName="livekit.ConnectionQualityInfo";zs.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:P.getEnumType(Ps)},{no:3,name:"score",kind:"scalar",T:2}]);class $s extends pe{constructor(e){super(),this.updates=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new $s().fromBinary(e,n)}static fromJson(e,n){return new $s().fromJson(e,n)}static fromJsonString(e,n){return new $s().fromJsonString(e,n)}static equals(e,n){return P.util.equals($s,e,n)}}$s.runtime=P;$s.typeName="livekit.ConnectionQualityUpdate";$s.fields=P.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:zs,repeated:!0}]);class Hs extends pe{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=Ya.ACTIVE,P.util.initPartial(e,this)}static fromBinary(e,n){return new Hs().fromBinary(e,n)}static fromJson(e,n){return new Hs().fromJson(e,n)}static fromJsonString(e,n){return new Hs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Hs,e,n)}}Hs.runtime=P;Hs.typeName="livekit.StreamStateInfo";Hs.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:P.getEnumType(Ya)}]);class Gs extends pe{constructor(e){super(),this.streamStates=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Gs().fromBinary(e,n)}static fromJson(e,n){return new Gs().fromJson(e,n)}static fromJsonString(e,n){return new Gs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Gs,e,n)}}Gs.runtime=P;Gs.typeName="livekit.StreamStateUpdate";Gs.fields=P.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:Hs,repeated:!0}]);class Si extends pe{constructor(e){super(),this.quality=sn.LOW,this.enabled=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new Si().fromBinary(e,n)}static fromJson(e,n){return new Si().fromJson(e,n)}static fromJsonString(e,n){return new Si().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Si,e,n)}}Si.runtime=P;Si.typeName="livekit.SubscribedQuality";Si.fields=P.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:P.getEnumType(sn)},{no:2,name:"enabled",kind:"scalar",T:8}]);class qs extends pe{constructor(e){super(),this.codec="",this.qualities=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new qs().fromBinary(e,n)}static fromJson(e,n){return new qs().fromJson(e,n)}static fromJsonString(e,n){return new qs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(qs,e,n)}}qs.runtime=P;qs.typeName="livekit.SubscribedCodec";qs.fields=P.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Si,repeated:!0}]);class Js extends pe{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new Js().fromBinary(e,n)}static fromJson(e,n){return new Js().fromJson(e,n)}static fromJsonString(e,n){return new Js().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Js,e,n)}}Js.runtime=P;Js.typeName="livekit.SubscribedQualityUpdate";Js.fields=P.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Si,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:qs,repeated:!0}]);class es extends pe{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",P.util.initPartial(e,this)}static fromBinary(e,n){return new es().fromBinary(e,n)}static fromJson(e,n){return new es().fromJson(e,n)}static fromJsonString(e,n){return new es().fromJsonString(e,n)}static equals(e,n){return P.util.equals(es,e,n)}}es.runtime=P;es.typeName="livekit.TrackPermission";es.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class ts extends pe{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new ts().fromBinary(e,n)}static fromJson(e,n){return new ts().fromJson(e,n)}static fromJsonString(e,n){return new ts().fromJsonString(e,n)}static equals(e,n){return P.util.equals(ts,e,n)}}ts.runtime=P;ts.typeName="livekit.SubscriptionPermission";ts.fields=P.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:es,repeated:!0}]);class Zs extends pe{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,P.util.initPartial(e,this)}static fromBinary(e,n){return new Zs().fromBinary(e,n)}static fromJson(e,n){return new Zs().fromJson(e,n)}static fromJsonString(e,n){return new Zs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Zs,e,n)}}Zs.runtime=P;Zs.typeName="livekit.SubscriptionPermissionUpdate";Zs.fields=P.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class ns extends pe{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new ns().fromBinary(e,n)}static fromJson(e,n){return new ns().fromJson(e,n)}static fromJsonString(e,n){return new ns().fromJsonString(e,n)}static equals(e,n){return P.util.equals(ns,e,n)}}ns.runtime=P;ns.typeName="livekit.SyncState";ns.fields=P.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:tr},{no:2,name:"subscription",kind:"message",T:Wr},{no:3,name:"publish_tracks",kind:"message",T:yi,repeated:!0},{no:4,name:"data_channels",kind:"message",T:rs,repeated:!0},{no:5,name:"offer",kind:"message",T:tr}]);class rs extends pe{constructor(e){super(),this.label="",this.id=0,this.target=Fn.PUBLISHER,P.util.initPartial(e,this)}static fromBinary(e,n){return new rs().fromBinary(e,n)}static fromJson(e,n){return new rs().fromJson(e,n)}static fromJsonString(e,n){return new rs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(rs,e,n)}}rs.runtime=P;rs.typeName="livekit.DataChannelInfo";rs.fields=P.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:P.getEnumType(Fn)}]);class Kn extends pe{constructor(e){super(),this.scenario={case:void 0},P.util.initPartial(e,this)}static fromBinary(e,n){return new Kn().fromBinary(e,n)}static fromJson(e,n){return new Kn().fromJson(e,n)}static fromJsonString(e,n){return new Kn().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Kn,e,n)}}Kn.runtime=P;Kn.typeName="livekit.SimulateScenario";Kn.fields=P.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:P.getEnumType(Ip),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"}]);class is extends pe{constructor(e){super(),this.timestamp=xe.zero,this.rtt=xe.zero,P.util.initPartial(e,this)}static fromBinary(e,n){return new is().fromBinary(e,n)}static fromJson(e,n){return new is().fromJson(e,n)}static fromJsonString(e,n){return new is().fromJsonString(e,n)}static equals(e,n){return P.util.equals(is,e,n)}}is.runtime=P;is.typeName="livekit.Ping";is.fields=P.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class Ks extends pe{constructor(e){super(),this.lastPingTimestamp=xe.zero,this.timestamp=xe.zero,P.util.initPartial(e,this)}static fromBinary(e,n){return new Ks().fromBinary(e,n)}static fromJson(e,n){return new Ks().fromJson(e,n)}static fromJsonString(e,n){return new Ks().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ks,e,n)}}Ks.runtime=P;Ks.typeName="livekit.Pong";Ks.fields=P.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class $o extends pe{constructor(e){super(),this.regions=[],P.util.initPartial(e,this)}static fromBinary(e,n){return new $o().fromBinary(e,n)}static fromJson(e,n){return new $o().fromJson(e,n)}static fromJsonString(e,n){return new $o().fromJsonString(e,n)}static equals(e,n){return P.util.equals($o,e,n)}}$o.runtime=P;$o.typeName="livekit.RegionSettings";$o.fields=P.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:Ys,repeated:!0}]);class Ys extends pe{constructor(e){super(),this.region="",this.url="",this.distance=xe.zero,P.util.initPartial(e,this)}static fromBinary(e,n){return new Ys().fromBinary(e,n)}static fromJson(e,n){return new Ys().fromJson(e,n)}static fromJsonString(e,n){return new Ys().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Ys,e,n)}}Ys.runtime=P;Ys.typeName="livekit.RegionInfo";Ys.fields=P.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class Xs extends pe{constructor(e){super(),this.trackSid="",this.err=Md.SE_UNKNOWN,P.util.initPartial(e,this)}static fromBinary(e,n){return new Xs().fromBinary(e,n)}static fromJson(e,n){return new Xs().fromJson(e,n)}static fromJsonString(e,n){return new Xs().fromJsonString(e,n)}static equals(e,n){return P.util.equals(Xs,e,n)}}Xs.runtime=P;Xs.typeName="livekit.SubscriptionResponse";Xs.fields=P.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:P.getEnumType(Md)}]);function Ij(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const Rj=5e3,Tu=[];class Y extends vs.EventEmitter{constructor(e,n){super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Y.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),Rj):this.handleAppVisibilityChanged()},this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Y.Source.Unknown}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===Y.Kind.Video&&(n="video"),this.attachedElements.length===0&&Y.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(Tu.forEach(s=>{s.parentElement===null&&!e&&(e=s)}),e&&Tu.splice(Tu.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),$c(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(s=>s.kind==="audio");return e.play().then(()=>{this.emit(i?fe.AudioPlaybackStarted:fe.VideoPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(i?fe.AudioPlaybackFailed:fe.VideoPlaybackFailed,s):s.name==="AbortError"?F.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):F.warn("could not playback ".concat(i?"audio":"video"),s),i&&e&&r.some(o=>o.kind==="video")&&s.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(fe.ElementAttached,e),e}detach(e){try{if(e){ll(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(fe.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{ll(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(fe.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),Tu.forEach(r=>{r.parentElement||(n=!1)}),n&&Tu.push(e)}}handleAppVisibilityChanged(){return U(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){pr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){pr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function $c(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!Xa()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(Xa()||xl())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function ll(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(l){l.Audio="audio",l.Video="video",l.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(l){l.Camera="camera",l.Microphone="microphone",l.ScreenShare="screen_share",l.ScreenShareAudio="screen_share_audio",l.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(l){l.Active="active",l.Paused="paused",l.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(l){switch(l){case e.Audio:return Ln.AUDIO;case e.Video:return Ln.VIDEO;default:return Ln.DATA}}t.kindToProto=i;function s(l){switch(l){case Ln.AUDIO:return e.Audio;case Ln.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=s;function o(l){switch(l){case n.Camera:return Vt.CAMERA;case n.Microphone:return Vt.MICROPHONE;case n.ScreenShare:return Vt.SCREEN_SHARE;case n.ScreenShareAudio:return Vt.SCREEN_SHARE_AUDIO;default:return Vt.UNKNOWN}}t.sourceToProto=o;function a(l){switch(l){case Vt.CAMERA:return n.Camera;case Vt.MICROPHONE:return n.Microphone;case Vt.SCREEN_SHARE:return n.ScreenShare;case Vt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=a;function c(l){switch(l){case Ya.ACTIVE:return r.Active;case Ya.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=c})(Y||(Y={}));function fA(t,e,n){var r;const i=(r=Ij(t))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&a0(i.audio,e),i.video&&a0(i.video,n),i}function a0(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function Em(t){const e={};if(t.video)if(typeof t.video=="object"){const n={},r=n,i=t.video;Object.keys(i).forEach(s=>{switch(s){case"resolution":a0(r,i.resolution);break;default:r[s]=i[s]}}),e.video=n}else e.video=t.video;else e.video=!1;return t.audio?typeof t.audio=="object"?e.audio=t.audio:e.audio=!0:e.audio=!1,e}function Pj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return U(this,void 0,void 0,function*(){const n=wb();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,s=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(r),yield no(e),r.getByteTimeDomainData(s);const a=s.some(c=>c!==128&&c!==0);return n.close(),!a}return!1})}function wb(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function Aj(t){return t===Y.Source.Microphone?"audioinput":t===Y.Source.Camera?"videoinput":void 0}function Nj(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&(r=typeof r=="boolean"?{}:r,Xa()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio}}function hA(t){const e=t.split("/")[1].toLowerCase();if(!uA.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function Mj(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new yi({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}const xj="|",ZE="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function Oj(t){const e=t.split(xj);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function no(t){return U(this,void 0,void 0,function*(){return new Promise(e=>Tn.setTimeout(e,t))})}function KE(){return"addTransceiver"in RTCPeerConnection.prototype}function YE(){return"addTrack"in RTCPeerConnection.prototype}function Dj(){if(!("getCapabilities"in RTCRtpSender)||Xa())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function Lj(){if(!("getCapabilities"in RTCRtpSender)||xl())return!1;if(Xa()){const n=ca();if(n!=null&&n.version&&kb(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function Qu(t){return t==="av1"||t==="vp9"}function c0(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}const Fj={Chrome:"100",Safari:"15",Firefox:"100"};function Bj(t){if(!pr()||!("setCodecPreferences"in t))return!1;const e=ca();if(!(e!=null&&e.name)||!e.version)return!1;const n=Fj[e.name];return n?kb(e.version,n)>=0:!1}function xl(){var t;return((t=ca())===null||t===void 0?void 0:t.name)==="Firefox"}function Uj(){var t;return((t=ca())===null||t===void 0?void 0:t.name)==="Chrome"}function Xa(){var t;return((t=ca())===null||t===void 0?void 0:t.name)==="Safari"}function pA(){return pr()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function pr(){return typeof document<"u"}function Qa(){return navigator.product=="ReactNative"}function l0(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function mA(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function gA(){if(!Qa())return;let t=mA();if(t)return t.platform}function XE(){if(pr())return window.devicePixelRatio;if(Qa()){let t=mA();if(t)return t.devicePixelRatio}return 1}function kb(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let s=0;s<i;++s){const o=parseInt(n[s],10),a=parseInt(r[s],10);if(o>a)return 1;if(o<a)return-1;if(s===i-1&&o===a)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function jj(t){for(const e of t)e.target.handleResize(e)}function Wj(t){for(const e of t)e.target.handleVisibilityChanged(e)}let Yg=null;const QE=()=>(Yg||(Yg=new ResizeObserver(jj)),Yg);let Xg=null;const eC=()=>(Xg||(Xg=new IntersectionObserver(Wj,{root:null,rootMargin:"0px"})),Xg);function Vj(){var t;const e=new Os({sdk:Ml.JS,protocol:Cj,version:Ej});return Qa()&&(e.os=(t=gA())!==null&&t!==void 0?t:""),e}function tC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const s=i.getContext("2d");s==null||s.fillRect(0,0,i.width,i.height),r&&s&&(s.beginPath(),s.arc(t/2,e/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const o=i.captureStream(),[a]=o.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let _u;function Qg(){if(!_u){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[_u]=r.stream.getAudioTracks(),!_u)throw Error("Could not get empty media stream audio track");_u.enabled=!1}return _u.clone()}class vA{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>U(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function zj(t,e){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=wb();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?t.mediaStreamTrack.clone():t.mediaStreamTrack,s=r.createMediaStreamSource(new MediaStream([i])),o=r.createAnalyser();o.minDecibels=n.minDecibels,o.maxDecibels=n.maxDecibels,o.fftSize=n.fftSize,o.smoothingTimeConstant=n.smoothingTimeConstant,s.connect(o);const a=new Uint8Array(o.frequencyBinCount);return{calculateVolume:()=>{o.getByteFrequencyData(a);let u=0;for(const f of a)u+=Math.pow(f/255,2);return Math.sqrt(u/a.length)},analyser:o,cleanup:()=>U(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&i.stop()})}}class ki{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function $j(t){return uA.includes(t)}function ja(t){if(typeof t=="string")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function Hj(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function nC(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}const rC="default";class Yn{static getInstance(){return this.instance===void 0&&(this.instance=new Yn),this.instance}getDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return U(this,void 0,void 0,function*(){if(((r=Yn.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){F.debug("awaiting getUserMedia promise");try{e?yield Yn.userMediaPromiseMap.get(e):yield Promise.all(Yn.userMediaPromiseMap.values())}catch{F.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(n&&!(Xa()&&this.hasDeviceInUse(e))&&(i.length===0||i.some(o=>{const a=o.label==="",c=e?o.kind===e:!0;return a&&c}))){const o={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(o);i=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(c=>{c.stop()})}return e&&(i=i.filter(s=>s.kind===e)),i})}normalizeDeviceId(e,n,r){return U(this,void 0,void 0,function*(){if(n!==rC)return n;const s=(yield this.getDevices(e)).find(o=>o.groupId===r&&o.deviceId!==rC);return s==null?void 0:s.deviceId})}hasDeviceInUse(e){return e?Yn.userMediaPromiseMap.has(e):Yn.userMediaPromiseMap.size>0}}Yn.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Yn.userMediaPromiseMap=new Map;const Gj=1e3;class Ol extends Y{get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;super(e,n),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>F.debug("track mute bounce got cancelled by an unmute event")),this.debouncedTrackMuteHandler=bb(()=>U(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>U(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(fe.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new ki,this.pauseUpstreamLock=new ki,this.processorLock=new ki,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Y.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(e,n){return U(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{ll(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop()),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e&&this.processorElement){if(F.debug("restarting processor"),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");$c(e,this.processorElement),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??e)),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{$c(r??e,i)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Gj;var n;return U(this,void 0,void 0,function*(){if(this.kind===Y.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=ca())===null||n===void 0?void 0:n.os)==="iOS"&&(yield no(10));const r=Date.now();for(;Date.now()-r<e;){const i=this.dimensions;if(i)return i;yield no(50)}throw new Fi("unable to get track dimensions after timeout")})}getDeviceId(){return U(this,void 0,void 0,function*(){if(this.source===Y.Source.ScreenShare)return;const{deviceId:e,groupId:n}=this._mediaStreamTrack.getSettings(),r=this.kind===Y.Kind.Audio?"audioinput":"videoinput";return Yn.getInstance().normalizeDeviceId(r,e,n)})}mute(){return U(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return U(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return U(this,void 0,void 0,function*(){if(!this.sender)throw new Fi("unable to replace an unpublished track");return F.debug("replace MediaStreamTrack"),yield this.setMediaStreamTrack(e),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(e){return U(this,void 0,void 0,function*(){e||(e=this._constraints),F.debug("restarting track with constraints",e);const n={audio:!1,video:!1};this.kind===Y.Kind.Video?n.video=e:n.audio=e,this.attachedElements.forEach(s=>{ll(this.mediaStreamTrack,s)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),F.debug("re-acquired MediaStreamTrack"),yield this.setMediaStreamTrack(i),this._constraints=e,this.emit(fe.Restarted,this),this})}setTrackMuted(e){F.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted")),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?fe.Muted:fe.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return U(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),pA()&&(F.debug("visibility changed, is in Background: ".concat(this.isInBackground)),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(F.debug("track needs to be reacquired, restarting ".concat(this.source)),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return U(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){F.warn("unable to pause upstream for an unpublished track");return}this._isUpstreamPaused=!0,this.emit(fe.UpstreamPaused,this);const n=ca();if((n==null?void 0:n.name)==="Safari"&&kb(n.version,"12.0")<0)throw new Sb("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return U(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){F.warn("unable to resume upstream for an unpublished track");return}this._isUpstreamPaused=!1,this.emit(fe.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return U(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return U(this,void 0,void 0,function*(){const s=yield this.processorLock.lock();try{if(F.debug("setting up processor"),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),this.processorElement.muted=!0,$c(this._mediaStreamTrack,this.processorElement),this.processorElement.play().catch(a=>F.error("failed to play processor element",{error:a}));const o={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(o),this.processor=e,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&n&&(ll(this._mediaStreamTrack,a),$c(this.processor.processedTrack,a));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{s()}})}getProcessor(){return this.processor}stopProcessor(){var e,n;return U(this,void 0,void 0,function*(){this.processor&&(F.debug("stopping processor"),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class qj extends vs.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:s,data:o}=n.data;switch(s){case"error":F.error(o.error.message),this.emit(zo.EncryptionError,o.error);break;case"initAck":o.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==o.enabled&&o.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(zo.ParticipantEncryptionStatusChanged,o.enabled,this.room.localParticipant),this.encryptionEnabled=o.enabled;else if(o.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(o.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(o.participantIdentity));this.emit(zo.ParticipantEncryptionStatusChanged,o.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(ta.KeyRatcheted,o.material,o.keyIndex);break}},this.onWorkerError=n=>{F.error("e2ee worker encountered an error:",{error:n.error}),this.emit(zo.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!vj())throw new Sb("tried to setup end-to-end encryption on an unsupported browser");if(F.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(F.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){F.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?F.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(ge.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(ne.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Cn.NONE,i.identity)),e.on(ne.ConnectionStateChanged,r=>{r===Ze.Connected&&e.participants.forEach(i=>{i.tracks.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==Cn.NONE,i.identity)})})}).on(ne.TrackUnsubscribed,(r,i,s)=>{var o;const a={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:r.mediaStreamID}};(o=this.worker)===null||o===void 0||o.postMessage(a)}).on(ne.TrackSubscribed,(r,i,s)=>{this.setupE2EEReceiver(r,s.identity,i.trackInfo)}).on(ne.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(r=>{this.postKey(r)})}),e.localParticipant.on(oe.LocalTrackPublished,r=>U(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(ta.SetKey,r=>this.postKey(r)).on(ta.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var s;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(o)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?hA(r.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof Ol)||!n){n||F.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return U(this,void 0,void 0,function*(){if(this.worker){if(i0()){const s={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(qf in e&&i){const c={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(c);return}let s=e.writableStream,o=e.readableStream;if(!s||!o){const c=e.createEncodedStreams();e.writableStream=c.writable,s=c.writable,e.readableStream=c.readable,o=c.readable}const a={kind:"decode",data:{readableStream:o,writableStream:s,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[o,s])}e[qf]=!0}})}handleSender(e,n,r){var i;if(!(qf in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(i0()){F.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{F.info("initialize encoded streams");const s=e.createEncodedStreams(),o={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o,[s.readable,s.writable])}e[qf]=!0}}}var ed;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(ed||(ed={}));class Jj{constructor(){this.pendingTasks=new Map,this.taskMutex=new ki,this.nextTaskIndex=0}run(e){return U(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:ed.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=ed.RUNNING,yield e()}finally{n.status=ed.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return U(this,void 0,void 0,function*(){return this.run(()=>U(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const Zj=["syncState","trickle","offer","answer","simulate","leave"];function Kj(t){const e=Zj.indexOf(t.case)>=0;return F.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var dn;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(dn||(dn={}));class Eb{get currentState(){return this.state}get isDisconnected(){return this.state===dn.DISCONNECTING||this.state===dn.DISCONNECTED}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.rtt=0,this.state=dn.DISCONNECTED,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.useJSON=e,this.requestQueue=new Jj,this.queuedRequests=[],this.closingLock=new ki,this.connectionLock=new ki,this.state=dn.DISCONNECTED}join(e,n,r,i){return U(this,void 0,void 0,function*(){return this.state=dn.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return U(this,void 0,void 0,function*(){if(!this.options){F.warn("attempted to reconnect without signal options being set, ignoring");return}return this.state=dn.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r,e=Hj(e),e=e.replace(/\/$/,""),e+="/rtc";const s=Vj(),o=Yj(n,s,r);return new Promise((a,c)=>U(this,void 0,void 0,function*(){const l=yield this.connectionLock.lock();try{const u=()=>U(this,void 0,void 0,function*(){this.close(),clearTimeout(d),c(new Pt("room connection has been cancelled (signal)"))}),d=setTimeout(()=>{this.close(),c(new Pt("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&u(),i==null||i.addEventListener("abort",u),F.debug("connecting to ".concat(e+o)),this.ws&&(yield this.close()),this.ws=new WebSocket(e+o),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=f=>U(this,void 0,void 0,function*(){if(this.state!==dn.CONNECTED){clearTimeout(d);try{const h=yield fetch("http".concat(e.substring(2),"/validate").concat(o));if(h.status.toFixed(0).startsWith("4")){const p=yield h.text();c(new Pt(p,0,h.status))}else c(new Pt("Internal error",2,h.status))}catch{c(new Pt("server was not reachable",1))}return}this.handleWSError(f)}),this.ws.onmessage=f=>U(this,void 0,void 0,function*(){var h,p,g,y;let m;if(typeof f.data=="string"){const v=JSON.parse(f.data);m=Zi.fromJson(v)}else if(f.data instanceof ArrayBuffer)m=Zi.fromBinary(new Uint8Array(f.data));else{F.error("could not decode websocket message: ".concat(typeof f.data));return}if(this.state!==dn.CONNECTED){let v=!1;if(((h=m.message)===null||h===void 0?void 0:h.case)==="join"?(this.state=dn.CONNECTED,i==null||i.removeEventListener("abort",u),this.pingTimeoutDuration=m.message.value.pingTimeout,this.pingIntervalDuration=m.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(F.debug("ping config",{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration}),this.startPingInterval()),a(m.message.value)):this.state===dn.RECONNECTING?(this.state=dn.CONNECTED,i==null||i.removeEventListener("abort",u),this.startPingInterval(),((p=m.message)===null||p===void 0?void 0:p.case)==="reconnect"?a((g=m.message)===null||g===void 0?void 0:g.value):(a(),v=!0)):r.reconnect||c(new Pt("did not receive join response, got ".concat((y=m.message)===null||y===void 0?void 0:y.case," instead"))),!v)return}this.signalLatency&&(yield no(this.signalLatency)),this.handleSignalResponse(m)}),this.ws.onclose=f=>{F.warn("websocket closed",{ev:f}),this.handleOnClose(f.reason)}}finally{l()}}))}close(){return U(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();try{if(this.state=dn.DISCONNECTING,this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const n=new Promise(r=>{this.ws?this.ws.onclose=()=>{r()}:r()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([n,no(250)])),this.ws=void 0}}finally{this.state=dn.DISCONNECTED,this.clearPingInterval(),e()}})}sendOffer(e){F.debug("sending offer",e),this.sendRequest({case:"offer",value:Rp(e)})}sendAnswer(e){return F.debug("sending answer"),this.sendRequest({case:"answer",value:Rp(e)})}sendIceCandidate(e,n){return F.trace("sending ice candidate",e),this.sendRequest({case:"trickle",value:new gi({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new vi({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return this.sendRequest({case:"updateMetadata",value:new Xi({metadata:e,name:n})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new Yi({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new ts({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:xe.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new is({timestamp:xe.parse(Date.now()),rtt:xe.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new Vr({canReconnect:!1,reason:to.CLIENT_INITIATED})})}sendRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return U(this,void 0,void 0,function*(){if(!n&&!Kj(e)&&this.state===dn.RECONNECTING){this.queuedRequests.push(()=>U(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield no(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){F.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case));return}const i=new Ls({message:e});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(s){F.error("error sending signal message",{error:s})}})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){F.debug("received unsupported message");return}let s=!1;if(i.case==="answer"){const o=iC(i.value);this.onAnswer&&this.onAnswer(o)}else if(i.case==="offer"){const o=iC(i.value);this.onOffer&&this.onOffer(o)}else if(i.case==="trickle"){const o=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(o,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),s=!0):F.debug("unsupported message",i));s||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return U(this,void 0,void 0,function*(){if(this.state===dn.DISCONNECTED)return;const n=this.onClose;yield this.close(),F.debug("websocket connection closed: ".concat(e)),n&&n(e)})}handleWSError(e){F.error("websocket error",e)}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){F.warn("ping timeout duration not set");return}this.pingTimeout=Tn.setTimeout(()=>{F.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString())),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Tn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){F.warn("ping interval duration not set");return}F.debug("start ping interval"),this.pingInterval=Tn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){F.debug("clearing ping interval"),this.clearPingTimeout(),this.pingInterval&&Tn.clearInterval(this.pingInterval)}}function iC(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function Rp(t){return new tr({sdp:t.sdp,type:t.type})}function Yj(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",Qa()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.publishOnly!==void 0&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var yA={},SA={exports:{}},sC=SA.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(sC).forEach(function(t){var e=sC[t];e.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var bA=SA.exports;(function(t){var e=function(a){return String(Number(a))===a?Number(a):a},n=function(a,c,l,u){if(u&&!l)c[u]=e(a[1]);else for(var d=0;d<l.length;d+=1)a[d+1]!=null&&(c[l[d]]=e(a[d+1]))},r=function(a,c,l){var u=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:u&&!c[a.name]&&(c[a.name]={});var d=a.push?{}:u?c[a.name]:c;n(l.match(a.reg),d,a.names,a.name),a.push&&c[a.push].push(d)},i=bA,s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var c={},l=[],u=c;return a.split(/(\r\n|\r|\n)/).filter(s).forEach(function(d){var f=d[0],h=d.slice(2);f==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var p=0;p<(i[f]||[]).length;p+=1){var g=i[f][p];if(g.reg.test(h))return r(g,u,h)}}),c.media=l,c};var o=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=e(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(e),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},t.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var u,d=!1;return l[0]!=="~"?u=e(l):(u=e(l.substring(1,l.length)),d=!0),{scid:u,paused:d}})})}})(yA);var ev=bA,Xj=/%[sdv%]/g,Qj=function(t){var e=1,n=arguments,r=n.length;return t.replace(Xj,function(i){if(e>=r)return i;var s=n[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}})},Iu=function(t,e,n){var r=e.format instanceof Function?e.format(e.push?n:n[e.name]):e.format,i=[t+"="+r];if(e.names)for(var s=0;s<e.names.length;s+=1){var o=e.names[s];e.name?i.push(n[e.name][o]):i.push(n[e.names[s]])}else i.push(n[e.name]);return Qj.apply(null,i)},eW=["v","o","s","i","u","e","p","c","b","t","r","z","a"],tW=["i","c","b","a"],nW=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(s){s.payloads==null&&(s.payloads="")});var n=e.outerOrder||eW,r=e.innerOrder||tW,i=[];return n.forEach(function(s){ev[s].forEach(function(o){o.name in t&&t[o.name]!=null?i.push(Iu(s,o,t)):o.push in t&&t[o.push]!=null&&t[o.push].forEach(function(a){i.push(Iu(s,o,a))})})}),t.media.forEach(function(s){i.push(Iu("m",ev.m[0],s)),r.forEach(function(o){ev[o].forEach(function(a){a.name in s&&s[a.name]!=null?i.push(Iu(o,a,s)):a.push in s&&s[a.push]!=null&&s[a.push].forEach(function(c){i.push(Iu(o,a,c))})})})}),i.join(`\r
`)+`\r
`},rW=yA,iW=nW,tv=iW,Uu=rW.parse;const oC=.7,ul={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class aC extends vs.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=bb(r=>U(this,void 0,void 0,function*(){this.emit(ul.NegotiationStarted);try{yield this.createAndSendOffer()}catch(i){if(r)r(i);else throw i}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.config=e,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const e=Uj()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return U(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var n;return U(this,void 0,void 0,function*(){let r;if(e.type==="offer"){let{stereoMids:i,nackMids:s}=oW(e);this.remoteStereoMids=i,this.remoteNackMids=s}else if(e.type==="answer"){const i=Uu((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(s=>{s.type==="audio"&&this.trackBitrates.some(o=>{if(!o.transceiver||s.mid!=o.transceiver.mid)return!1;let a=0;if(s.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of s.fmtp)if(l.payload===a){l.config=l.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),o.maxbr>0&&(l.config+=";maxaveragebitrate=".concat(o.maxbr*1e3)),c=!0;break}return c||o.maxbr>0&&s.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(o.maxbr*1e3)}),!0})}),r=tv(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(ul.NegotiationComplete),e.sdp&&Uu(e.sdp).media.forEach(s=>{s.type==="video"&&this.emit(ul.RTPVideoPayloadTypes,s.rtp)}))})}createAndSendOffer(e){var n;return U(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(F.debug("restarting ICE"),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){F.warn("could not createOffer with closed peer connection");return}F.debug("starting to negotiate");const r=yield this.pc.createOffer(e),i=Uu((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(s=>{s.type==="audio"?cC(s,[],[]):s.type==="video"&&(sW(s),this.trackBitrates.some(o=>{if(!s.msid||!o.cid||!s.msid.includes(o.cid))return!1;let a=0;if(s.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of s.fmtp)if(l.payload===a){l.config.includes("x-google-start-bitrate")||(l.config+=";x-google-start-bitrate=".concat(Math.round(o.maxbr*oC))),l.config.includes("x-google-max-bitrate")||(l.config+=";x-google-max-bitrate=".concat(o.maxbr)),c=!0;break}return c||s.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(Math.round(o.maxbr*oC),";x-google-max-bitrate=").concat(o.maxbr)}),!0}))}),yield this.setMungedSDP(r,tv(i)),this.onOffer(r)})}createAndSetAnswer(){var e;return U(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),r=Uu((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{i.type==="audio"&&cC(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,tv(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new Yt("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new Yt("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return U(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const o=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(o!==void 0)return i.get(o)})}setMungedSDP(e,n,r){return U(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{F.debug("setting munged ".concat(r?"remote":"local"," description")),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(s){F.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),{error:s,sdp:n}),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let s="unknown error";i instanceof Error?s=i.message:typeof i=="string"&&(s=i);const o={error:s,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),F.error("unable to set ".concat(e.type),o),new s0(s)}})}}function cC(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function sW(t){var e,n,r,i;const s=(n=(e=t.rtp[0])===null||e===void 0?void 0:e.codec)===null||n===void 0?void 0:n.toLowerCase();if(!Qu(s))return;let o=0;((r=t.ext)===null||r===void 0?void 0:r.some(c=>c.uri===ZE?!0:(c.value>o&&(o=c.value),!1)))||(i=t.ext)===null||i===void 0||i.push({value:o+1,uri:ZE})}function oW(t){var e;const n=[],r=[],i=Uu((e=t.sdp)!==null&&e!==void 0?e:"");let s=0;return i.media.forEach(o=>{var a;o.type==="audio"&&(o.rtp.some(c=>c.codec==="opus"?(s=c.payload,!0):!1),!((a=o.rtcpFb)===null||a===void 0)&&a.some(c=>c.payload===s&&c.type==="nack")&&r.push(o.mid),o.fmtp.some(c=>c.payload===s?(c.config.includes("sprop-stereo=1")&&n.push(o.mid),!0):!1))}),{stereoMids:n,nackMids:r}}const u0="vp8",aW={audioBitrate:_p.music.maxBitrate,audioPreset:_p.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:dA.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:u0,backupCodec:!0},wA={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},kA={resolution:Od.h720.resolution},cW={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new Q8,disconnectOnPageLeave:!0,expWebAudioMix:!1},Cb={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Qt;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(Qt||(Qt={}));class lW{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n){this.peerConnectionTimeout=Cb.peerConnectionTimeout,this.updateState=()=>{var i;const s=this.state,o=this.requiredTransports.map(a=>a.getConnectionState());o.every(a=>a==="connected")?this.state=Qt.CONNECTED:o.some(a=>a==="failed")?this.state=Qt.FAILED:o.some(a=>a==="connecting")?this.state=Qt.CONNECTING:o.every(a=>a==="closed")?this.state=Qt.CLOSED:o.some(a=>a==="closed")?this.state=Qt.CLOSING:o.every(a=>a==="new")&&(this.state=Qt.NEW),s!==this.state&&(F.debug("pc state change: from ".concat(Qt[s]," to ").concat(Qt[this.state])),(i=this.onStateChange)===null||i===void 0||i.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const r={optional:[{googDscp:!0}]};this.publisher=new aC(e,r),this.subscriber=new aC(e),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=i=>{var s;(s=this.onIceCandidate)===null||s===void 0||s.call(this,i,Fn.PUBLISHER)},this.subscriber.onIceCandidate=i=>{var s;(s=this.onIceCandidate)===null||s===void 0||s.call(this,i,Fn.SUBSCRIBER)},this.subscriber.onDataChannel=i=>{var s;(s=this.onDataChannel)===null||s===void 0||s.call(this,i)},this.subscriber.onTrack=i=>{var s;(s=this.onTrack)===null||s===void 0||s.call(this,i)},this.publisher.onOffer=i=>{var s;(s=this.onPublisherOffer)===null||s===void 0||s.call(this,i)},this.state=Qt.NEW,this.connectionLock=new ki}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return U(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){F.warn("could not removeTrack",{error:r})}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return U(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return U(this,void 0,void 0,function*(){n===Fn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return U(this,void 0,void 0,function*(){return F.debug("received server offer",{RTCSdpType:e.type,signalingState:this.subscriber.getSignallingState().toString()}),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){var r;return U(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(F.debug("negotiation required, start negotiating"),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(s=>this.ensureTransportConnected(s,e,n)))}finally{i()}})}negotiate(e){return U(this,void 0,void 0,function*(){return new Promise((n,r)=>U(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),s=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",s),this.publisher.once(ul.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(ul.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(o=>{clearTimeout(i),r(o)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===Fn.PUBLISHER?this.publisher.getConnectedAddress():e===Fn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return U(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((s,o)=>U(this,void 0,void 0,function*(){const a=()=>{F.warn("abort transport connection"),Tn.clearTimeout(c),o(new Pt("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&a(),n==null||n.signal.addEventListener("abort",a);const c=Tn.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",a),o(new Pt("could not establish pc connection"))},r);for(;this.state!==Qt.CONNECTED;)if(yield no(50),n!=null&&n.signal.aborted){o(new Pt("room connection has been cancelled",3));return}Tn.clearTimeout(c),n==null||n.signal.removeEventListener("abort",a),s()}))})}}const lC="_lossy",uC="_reliable",uW=2*1e3,dC="leave-reconnect";var Yr;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(Yr||(Yr={}));class dW extends vs.EventEmitter{get isClosed(){return this._isClosed}constructor(e){super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Cb.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=Yr.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.handleDataChannel=n=>{let{channel:r}=n;return U(this,void 0,void 0,function*(){if(r){if(r.label===uC)this.reliableDCSub=r;else if(r.label===lC)this.lossyDCSub=r;else return;F.debug("on data channel ".concat(r.id,", ").concat(r.label)),r.onmessage=this.handleDataMessage}})},this.handleDataMessage=n=>U(this,void 0,void 0,function*(){var r,i;const s=yield this.dataProcessLock.lock();try{let o;if(n.data instanceof ArrayBuffer)o=n.data;else if(n.data instanceof Blob)o=yield n.data.arrayBuffer();else{F.error("unsupported data type",n.data);return}const a=Vi.fromBinary(new Uint8Array(o));((r=a.value)===null||r===void 0?void 0:r.case)==="speaker"?this.emit(ge.ActiveSpeakersUpdate,a.value.value.speakers):((i=a.value)===null||i===void 0?void 0:i.case)==="user"&&this.emit(ge.DataPacketReceived,a.value.value,a.kind)}finally{s()}}),this.handleDataError=n=>{const i=n.currentTarget.maxRetransmits===0?"lossy":"reliable";if(n instanceof ErrorEvent&&n.error){const{error:s}=n.error;F.error("DataChannel error on ".concat(i,": ").concat(n.message),s)}else F.error("Unknown DataChannel error on ".concat(i),n)},this.handleBufferedAmountLow=n=>{const i=n.currentTarget.maxRetransmits===0?Xt.LOSSY:Xt.RELIABLE;this.updateAndEmitDCBufferStatus(i)},this.handleDisconnect=(n,r)=>{if(this._isClosed)return;F.warn("".concat(n," disconnected")),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const i=a=>{F.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(a,"ms. giving up")),this.emit(ge.Disconnected),this.close()},s=Date.now()-this.reconnectStart;let o=this.getNextRetryDelay({elapsedMs:s,retryCount:this.reconnectAttempts});if(o===null){i(s);return}n===dC&&(o=0),F.debug("reconnecting in ".concat(o,"ms")),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Tn.setTimeout(()=>this.attemptReconnect(r),o)},this.waitForRestarted=()=>new Promise((n,r)=>{this.pcState===Yr.Connected&&n();const i=()=>{this.off(ge.Disconnected,s),n()},s=()=>{this.off(ge.Restarted,i),r()};this.once(ge.Restarted,i),this.once(ge.Disconnected,s)}),this.updateAndEmitDCBufferStatus=n=>{const r=this.isBufferStatusLow(n);typeof r<"u"&&r!==this.dcBufferStatus.get(n)&&(this.dcBufferStatus.set(n,r),this.emit(ge.DCBufferStatusChanged,r,n))},this.isBufferStatusLow=n=>{const r=this.dataChannelForKind(n);if(r)return r.bufferedAmount<=r.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===dn.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(Es.RR_SIGNAL_DISCONNECTED))},this.client=new Eb,this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new ki,this.dataProcessLock=new ki,this.dcBufferStatus=new Map([[Xt.LOSSY,!0],[Xt.RELIABLE,!0]]),this.client.onParticipantUpdate=n=>this.emit(ge.ParticipantUpdate,n),this.client.onConnectionQuality=n=>this.emit(ge.ConnectionQualityUpdate,n),this.client.onRoomUpdate=n=>this.emit(ge.RoomUpdate,n),this.client.onSubscriptionError=n=>this.emit(ge.SubscriptionError,n),this.client.onSubscriptionPermissionUpdate=n=>this.emit(ge.SubscriptionPermissionUpdate,n),this.client.onSpeakersChanged=n=>this.emit(ge.SpeakersChanged,n),this.client.onStreamStateUpdate=n=>this.emit(ge.StreamStateChanged,n)}join(e,n,r,i){return U(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.pcManager||(yield this.configure(s)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=s.clientConfiguration,s}catch(s){if(s instanceof Pt&&s.reason===1&&(F.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts)),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw s}})}close(){return U(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(ge.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return U(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return U(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Fi("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new Pt("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:s=>{clearTimeout(i),n(s)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){F.warn("failed to remove track",{error:n,method:"removeTrack"})}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return U(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var n;return U(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==Qt.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new lW(r,e.subscriberPrimary),this.emit(ge.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,s)=>{this.client.sendIceCandidate(i,s)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,s,o)=>U(this,void 0,void 0,function*(){if(F.debug("primary PC state changed ".concat(i)),i===Qt.CONNECTED){const a=this.pcState===Yr.New;this.pcState=Yr.Connected,a&&this.emit(ge.Connected,e)}else i===Qt.FAILED&&this.pcState===Yr.Connected&&(this.pcState=Yr.Disconnected,this.handleDisconnect("peerconnection failed",o==="failed"?Es.RR_SUBSCRIBER_FAILED:Es.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(ge.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>U(this,void 0,void 0,function*(){this.pcManager&&(F.debug("received server answer",{RTCSdpType:e.type}),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(F.trace("got ICE candidate from peer",{candidate:e,target:n}),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>U(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{if(F.debug("received trackPublishedResponse",e),!this.pendingTrackResolvers[e.cid]){F.error("missing track resolver for ".concat(e.cid));return}const{resolve:n}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],n(e.track)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(ge.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(ge.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",Es.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(dC)):(this.emit(ge.Disconnected,e==null?void 0:e.reason),this.close()),F.trace("leave request",{leave:e})}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(F.debug("E2EE - setting up transports with insertable streams"),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(s=>{const o={urls:s.urls};s.username&&(o.username=s.username),s.credential&&(o.credential=s.credential),i.push(o)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===_i.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(lC,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(uC,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,n,r){if(!("getCapabilities"in RTCRtpSender))return;const i=RTCRtpSender.getCapabilities(n);if(!i)return;F.debug("get capabilities",i);const s=[],o=[],a=[];i.codecs.forEach(c=>{const l=c.mimeType.toLowerCase();if(l==="audio/opus"){s.push(c);return}if(!(l==="video/".concat(r))){a.push(c);return}if(r==="h264"){c.sdpFmtpLine&&c.sdpFmtpLine.includes("profile-level-id=42e01f")?s.push(c):o.push(c);return}s.push(c)}),Bj(e)&&e.setCodecPreferences(s.concat(o,a))}createSender(e,n,r){return U(this,void 0,void 0,function*(){if(KE())return yield this.createTransceiverRTCRtpSender(e,n,r);if(YE())return F.warn("using add-track fallback"),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Yt("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return U(this,void 0,void 0,function*(){if(KE())return this.createSimulcastTransceiverSender(e,n,r,i);if(YE())return F.debug("using add-track fallback"),this.createRTCRtpSender(e.mediaStreamTrack);throw new Yt("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yt("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream);const s={direction:"sendonly",streams:i};r&&(s.sendEncodings=r);const o=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,s);return e.kind===Y.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(o,e.kind,n.videoCodec),e.codec=n.videoCodec),o.sender})}createSimulcastTransceiverSender(e,n,r,i){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yt("publisher is closed");const s={direction:"sendonly"};i&&(s.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,s);if(r.videoCodec)return this.setPreferredCodec(o,e.kind,r.videoCodec),e.setSimulcastTrackSender(r.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yt("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var n,r,i;return U(this,void 0,void 0,function*(){if(!this._isClosed&&!this.attemptingReconnect){(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===_i.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:Qt.NEW)===Qt.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let o=!0;s instanceof Yt?(F.debug("received unrecoverable error",{error:s}),o=!1):s instanceof Jf||(this.fullReconnectOnNext=!0),o?this.handleDisconnect("reconnect",Es.RR_UNKNOWN):(F.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up")),this.emit(ge.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){F.warn("encountered error in reconnect policy",{error:n})}return null}restartConnection(e){var n,r,i;return U(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new Yt("could not reconnect, url or token not saved");F.info("reconnecting, attempt: ".concat(this.reconnectAttempts)),this.emit(ge.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw F.warn("attempted connection restart, without signal options present"),new Jf;s=yield this.join(e??this.url,this.token,this.signalOpts)}catch(o){throw o instanceof Pt&&o.reason===0?new Yt("could not reconnect, token might be expired"):new Jf}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");this.client.setReconnected(),this.emit(ge.SignalRestarted,s),yield this.waitForPCReconnected(),(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(ge.Restarted)}catch(s){const o=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(o){yield this.restartConnection(o);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),s}})}resumeConnection(e){var n;return U(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new Yt("could not reconnect, url or token not saved");if(!this.pcManager)throw new Yt("publisher and subscriber connections unset");F.info("resuming signal connection, attempt ".concat(this.reconnectAttempts)),this.emit(ge.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,F.error(r.message)),r instanceof Pt&&r.reason===0?new Yt("could not reconnect, token might be expired"):new Jf(i)}if(this.emit(ge.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(ge.Resumed)})}waitForPCInitialConnection(e,n){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return U(this,void 0,void 0,function*(){this.pcState=Yr.Reconnecting,F.debug("waiting for peer connection to reconnect");try{if(yield no(uW),!this.pcManager)throw new Yt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Yr.Connected}catch(e){throw this.pcState=Yr.Disconnected,new Pt("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,n){return U(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yt("PC manager is closed");const i=n?this.pcManager.subscriber:this.pcManager.publisher,s=n?"Subscriber":"Publisher";if(!i)throw new Pt("".concat(s," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const o=this.dataChannelForKind(e,n);if((o==null?void 0:o.readyState)==="open")return;const a=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<a;){if(i.isICEConnected&&((r=this.dataChannelForKind(e,n))===null||r===void 0?void 0:r.readyState)==="open")return;yield no(50)}throw new Pt("could not establish ".concat(s," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(e){return U(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Qt.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return U(this,void 0,void 0,function*(){return new Promise((e,n)=>U(this,void 0,void 0,function*(){if(!this.pcManager){n(new s0("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),F.debug("engine disconnected while negotiation was ongoing"),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(ge.Closing,i),this.pcManager.publisher.once(ul.RTPVideoPayloadTypes,s=>{const o=new Map;s.forEach(a=>{const c=a.codec.toLowerCase();$j(c)&&o.set(a.payload,c)}),this.emit(ge.RTPVideoMapUpdate,o)});try{yield this.pcManager.negotiate(r),e()}catch(s){s instanceof s0&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Es.RR_UNKNOWN),n(s)}finally{this.off(ge.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===Xt.LOSSY)return this.lossyDCSub;if(e===Xt.RELIABLE)return this.reliableDCSub}else{if(e===Xt.LOSSY)return this.lossyDC;if(e===Xt.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){F.warn("sync state cannot be sent without peer connection setup");return}const s=this.pcManager.subscriber.getLocalDescription(),o=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,c=new Array;e.forEach(l=>{l.isDesired!==a&&c.push(l.trackSid)}),this.client.sendSyncState(new ns({answer:s?Rp({sdp:s.sdp,type:s.type}):void 0,offer:o?Rp({sdp:o.sdp,type:o.type}):void 0,subscription:new Wr({trackSids:c,subscribe:!a,participantTracks:[]}),publishTracks:Mj(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new rs({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(Xt.LOSSY),Fn.PUBLISHER),n(this.dataChannelForKind(Xt.RELIABLE),Fn.PUBLISHER),n(this.dataChannelForKind(Xt.LOSSY,!0),Fn.SUBSCRIBER),n(this.dataChannelForKind(Xt.RELIABLE,!0),Fn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Tn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){pr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){pr()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class Jf extends Error{}class fC{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return l0(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return U(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),F.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return U(this,void 0,void 0,function*(){const n=yield fetch("".concat(fW(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new Pt("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function fW(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}const Tb=2e3;function Cm(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}class qn extends Ol{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,Y.Kind.Audio,n,r),this.stopOnMute=!1,this.monitorSender=()=>U(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(o){F.error("could not get audio sender stats",{error:o});return}s&&this.prevStats&&(this._currentBitrate=Cm(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.checkForSilence()}setDeviceId(e){return U(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||ja(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return U(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(F.debug("stopping mic track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return U(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==ja(this._constraints.deviceId);return this.source===Y.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(F.debug("reacquiring mic track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return U(this,void 0,void 0,function*(){let n;if(e){const r=Em({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return U(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){pr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Tb)))}setProcessor(e){var n;return U(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};F.debug("setting up audio processor ".concat(e.name)),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return U(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return U(this,void 0,void 0,function*(){const e=yield Pj(this);return e&&(this.isMuted||F.warn("silence detected on local audio track"),this.emit(fe.AudioSilenceDetected)),e})}}function EA(t,e){switch(t.kind){case"audio":return new qn(t,e,!1);case"video":return new wr(t,e,!1);default:throw new Fi("unsupported track type: ".concat(t.kind))}}const hW=Object.values(Od),pW=Object.values(o0),mW=Object.values(dA),gW=[Od.h180,Od.h360],vW=[o0.h180,o0.h360],yW=t=>[{scaleResolutionDownBy:2,fps:3}].map(n=>{var r;return new pt(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/n.fps)))),n.fps,t.encoding.priority)}),d0=["q","h","f"];function f0(t,e,n,r){var i,s;let o=r==null?void 0:r.videoEncoding;t&&(o=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,c=r==null?void 0:r.scalabilityMode,l=r==null?void 0:r.videoCodec;if(!o&&!a&&!c||!e||!n)return[{}];o||(o=bW(t,e,n,l),F.debug("using video encoding",o));const u=new pt(e,n,o.maxBitrate,o.maxFramerate,o.priority);if(c&&Qu(l)){F.debug("using svc with scalabilityMode ".concat(c));const h=new CA(c),p=[];if(h.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));for(let g=0;g<h.spatial;g+=1)p.push({rid:d0[2-g],maxBitrate:o.maxBitrate/Math.pow(3,g),maxFramerate:u.encoding.maxFramerate});return p[0].scalabilityMode=c,F.debug("encodings",p),p}if(!a)return[o];let d=[];t?d=(i=pC(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:hC(t,u):d=(s=pC(r==null?void 0:r.videoSimulcastLayers))!==null&&s!==void 0?s:hC(t,u);let f;if(d.length>0){const h=d[0];d.length>1&&([,f]=d);const p=Math.max(e,n);if(p>=960&&f)return nv(e,n,[h,f,u]);if(p>=480)return nv(e,n,[h,u])}return nv(e,n,[u])}function SW(t,e,n){var r,i,s,o;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&F.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const a=t.mediaStreamTrack.getSettings(),c=(r=a.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,l=(s=a.height)!==null&&s!==void 0?s:(o=t.dimensions)===null||o===void 0?void 0:o.height;return f0(t.source===Y.Source.ScreenShare,c,l,n)}function bW(t,e,n,r){const i=wW(t,e,n);let{encoding:s}=i[0];const o=Math.max(e,n);for(let a=0;a<i.length;a+=1){const c=i[a];if(s=c.encoding,c.width>=o)break}if(r)switch(r){case"av1":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function wW(t,e,n){if(t)return mW;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?hW:pW}function hC(t,e){if(t)return yW(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?gW:vW}function nv(t,e,n){const r=[];if(n.forEach((i,s)=>{if(s>=d0.length)return;const o=Math.min(t,e),c={rid:d0[s],scaleResolutionDownBy:Math.max(1,o/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(c.maxFramerate=i.encoding.maxFramerate);const l=xl()||s===0;i.encoding.priority&&l&&(c.priority=i.encoding.priority,c.networkPriority=i.encoding.priority),r.push(c)}),Qa()&&gA()==="ios"){let i;r.forEach(o=>{i?o.maxFramerate&&o.maxFramerate>i&&(i=o.maxFramerate):i=o.maxFramerate});let s=!0;r.forEach(o=>{var a;o.maxFramerate!=i&&(s&&(s=!1,F.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),F.info('Setting framerate of encoding "'.concat((a=o.rid)!==null&&a!==void 0?a:"",'" to ').concat(i)),o.maxFramerate=i)})}return r}function pC(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class CA{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const kW=5e3;class wr extends Ol{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;super(e,Y.Kind.Video,n,r),this.simulcastCodecs=new Map,this.monitorSender=()=>U(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let i;try{i=yield this.getSenderStats()}catch(o){F.error("could not get audio sender stats",{error:o});return}const s=new Map(i.map(o=>[o.rid,o]));if(this.prevStats){let o=0;s.forEach((a,c)=>{var l;const u=(l=this.prevStats)===null||l===void 0?void 0:l.get(c);o+=Cm(a,u)}),this._currentBitrate=o}this.prevStats=s}),this.senderLock=new ki}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!pr())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Tb))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,r,i,s,o;return U(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var a=!0,c=Tc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0)s=l.value,a=!1,yield(o=s.sender)===null||o===void 0?void 0:o.replaceTrack(null)}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,r,i,s,o;return U(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var a=!0,c=Tc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){s=l.value,a=!1;const u=s;yield(o=u.sender)===null||o===void 0?void 0:o.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return U(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Camera&&!this.isUserProvided&&(F.debug("stopping camera track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return U(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Camera&&!this.isUserProvided&&(F.debug("reacquiring camera track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return U(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var s;if(i.type==="outbound-rtp"){const o={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(s=i.rid)!==null&&s!==void 0?s:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},a=r.get(i.remoteId);a&&(o.jitter=a.jitter,o.packetsLost=a.packetsLost,o.roundTripTime=a.roundTripTime),n.push(o)}}),n})}setPublishingQuality(e){const n=[];for(let r=sn.LOW;r<=sn.HIGH;r+=1)n.push(new Si({quality:r,enabled:r<=e}));F.debug("setting publishing quality. max quality ".concat(e)),this.setPublishingLayers(n)}setDeviceId(e){return U(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===ja(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||ja(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var n,r,i,s;return U(this,void 0,void 0,function*(){let o;if(e){const u=Em({video:e});typeof u.video!="boolean"&&(o=u.video)}yield this.restart(o);try{for(var a=!0,c=Tc(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){s=l.value,a=!1;const u=s;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,s,o,a,c,l;return U(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,e,n),!((c=this.processor)===null||c===void 0)&&c.processedTrack)try{for(var u=!0,d=Tc(this.simulcastCodecs.values()),f;f=yield d.next(),i=f.done,!i;u=!0)a=f.value,u=!1,yield(l=a.sender)===null||l===void 0?void 0:l.replaceTrack(this.processor.processedTrack)}catch(h){s={error:h}}finally{try{!u&&!i&&(o=d.return)&&(yield o.call(d))}finally{if(s)throw s.error}}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},kW))}setPublishingCodecs(e){var n,r,i,s,o,a,c;return U(this,void 0,void 0,function*(){if(F.debug("setting publishing codecs",{codecs:e,currentCodec:this.codec}),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const l=[];try{for(n=!0,r=Tc(e);i=yield r.next(),s=i.done,!s;n=!0){c=i.value,n=!1;const u=c;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(F.debug("try setPublishingCodec for ".concat(u.codec),d),!d||!d.sender){for(const f of u.qualities)if(f.enabled){l.push(u.codec);break}}else d.encodings&&(F.debug("try setPublishingLayersForSender ".concat(u.codec)),yield mC(d.sender,d.encodings,u.qualities,this.senderLock))}}}catch(u){o={error:u}}finally{try{!n&&!s&&(a=r.return)&&(yield a.call(r))}finally{if(o)throw o.error}}return l})}setPublishingLayers(e){return U(this,void 0,void 0,function*(){F.debug("setting publishing layers",e),!(!this.sender||!this.encodings)&&(yield mC(this.sender,this.encodings,e,this.senderLock))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return U(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),pA()&&this.isInBackground&&this.source===Y.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function mC(t,e,n,r){return U(this,void 0,void 0,function*(){const i=yield r.lock();F.debug("setPublishingLayersForSender",{sender:t,qualities:n,senderEncodings:e});try{const s=t.getParameters(),{encodings:o}=s;if(!o)return;if(o.length!==e.length){F.warn("cannot set publishing layers, encodings mismatch");return}let a=!1;!1&&o[0].scalabilityMode||o.forEach((l,u)=>{var d;let f=(d=l.rid)!==null&&d!==void 0?d:"";f===""&&(f="q");const h=TA(f),p=n.find(g=>g.quality===h);p&&l.active!==p.enabled&&(a=!0,l.active=p.enabled,F.debug("setting layer ".concat(p.quality," to ").concat(l.active?"enabled":"disabled")),xl()&&(p.enabled?(l.scaleResolutionDownBy=e[u].scaleResolutionDownBy,l.maxBitrate=e[u].maxBitrate,l.maxFrameRate=e[u].maxFrameRate):(l.scaleResolutionDownBy=4,l.maxBitrate=10,l.maxFrameRate=2)))}),a&&(s.encodings=o,F.debug("setting encodings",s.encodings),yield t.setParameters(s))}finally{i()}})}function TA(t){switch(t){case"f":return sn.HIGH;case"h":return sn.MEDIUM;case"q":return sn.LOW;default:return sn.HIGH}}function gC(t,e,n,r){if(!n)return[new er({quality:sn.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,s=new CA(i),o=[];for(let a=0;a<s.spatial;a+=1)o.push(new er({quality:sn.HIGH-a,width:Math.ceil(t/Math.pow(2,a)),height:Math.ceil(e/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return o}return n.map(i=>{var s,o,a;const c=(s=i.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let l=TA((o=i.rid)!==null&&o!==void 0?o:"");return new er({quality:l,width:Math.ceil(t/c),height:Math.ceil(e/c),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class _A extends Y{constructor(e,n,r,i){super(e,r),this.sid=n,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?fe.Muted:fe.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(fe.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return U(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Tb))}}class Wa extends _A{constructor(e,n,r,i,s){super(e,n,Y.Kind.Audio,r),this.monitorReceiver=()=>U(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const o=yield this.getReceiverStats();o&&this.prevStats&&this.receiver&&(this._currentBitrate=Cm(o,this.prevStats)),this.prevStats=o}),this.audioContext=i,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;Qa()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Qa())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return U(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(c0(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&c0(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(F.debug("using audio context mapping"),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(fe.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(fe.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return U(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const rv=100;class td extends _A{constructor(e,n,r,i){super(e,n,Y.Kind.Video,r),this.elementInfos=[],this.monitorReceiver=()=>U(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=Cm(s,this.prevStats)),this.prevStats=s}),this.debouncedHandleResize=bb(()=>{this.updateDimensions()},rv),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?ll(this._mediaStreamTrack,n):$c(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new EW(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):F.warn("visibility resize observer not triggered")}stopObservingElementInfo(e){if(!this.isAdaptiveStream){F.warn("stopObservingElementInfo ignored");return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return U(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(s=>{s.type==="inbound-rtp"?(r=s.codecId,n={type:"video",framesDecoded:s.framesDecoded,framesDropped:s.framesDropped,framesReceived:s.framesReceived,packetsReceived:s.packetsReceived,packetsLost:s.packetsLost,frameWidth:s.frameWidth,frameHeight:s.frameHeight,pliCount:s.pliCount,firCount:s.firCount,nackCount:s.nackCount,jitter:s.jitter,timestamp:s.timestamp,bytesReceived:s.bytesReceived,decoderImplementation:s.decoderImplementation}):s.type==="codec"&&i.set(s.id,s)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return U(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((a,c)=>Math.max(a,c.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,s=this.elementInfos.some(a=>a.pictureInPicture),o=this.elementInfos.some(a=>a.visible)&&!i||s;if(this.lastVisible!==o){if(!o&&Date.now()-r<rv){Tn.setTimeout(()=>{this.updateVisibility()},rv);return}this.lastVisible=o,this.emit(fe.VisibilityChanged,o,this)}}updateDimensions(){var e,n;let r=0,i=0;const s=this.getPixelDensity();for(const o of this.elementInfos){const a=o.width()*s,c=o.height()*s;a+c>r+i&&(r=a,i=c)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(fe.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?XE():n||(XE()>2?2:1)}}class EW{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:s,isIntersecting:o}=r;s===this.element&&(this.isIntersecting=o,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??vC(e),this.isPiP=pr()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=vC(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,eC().observe(this.element),QE().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,n;(e=eC())===null||e===void 0||e.unobserve(this.element),(n=QE())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function vC(t){let e=t.offsetTop,n=t.offsetLeft;const r=t.offsetWidth,i=t.offsetHeight,{hidden:s}=t,{opacity:o,display:a}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+i>window.pageYOffset&&n+r>window.pageXOffset&&!s&&(o!==""?parseFloat(o)>0:!0)&&a!=="none"}class Cs extends vs.EventEmitter{constructor(e,n,r){super(),this.metadataMuted=!1,this.encryption=Cn.NONE,this.handleMuted=()=>{this.emit(fe.Muted)},this.handleUnmuted=()=>{this.emit(fe.Unmuted)},this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=Y.Source.Unknown}setTrack(e){this.track&&(this.track.off(fe.Muted,this.handleMuted),this.track.off(fe.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(fe.Muted,this.handleMuted),e.on(fe.Unmuted,this.handleUnmuted))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Cn.NONE}get audioTrack(){if(this.track instanceof qn||this.track instanceof Wa)return this.track}get videoTrack(){if(this.track instanceof wr||this.track instanceof td)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Y.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Y.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,F.debug("update publication info",{info:e})}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(Cs||(Cs={}));class Dd extends Cs{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r){super(e,n.sid,n.name),this.track=void 0,this.handleTrackEnded=()=>{this.emit(fe.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(fe.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(fe.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return U(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return U(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return U(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return U(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var Ur;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(Ur||(Ur={}));function CW(t){switch(t){case Ps.EXCELLENT:return Ur.Excellent;case Ps.GOOD:return Ur.Good;case Ps.POOR:return Ur.Poor;case Ps.LOST:return Ur.Lost;default:return Ur.Unknown}}class IA extends vs.EventEmitter{get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,n;return(n=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&n!==void 0?n:!1}constructor(e,n,r,i){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Ur.Unknown,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,n]of this.tracks)if(n.source===e)return n}getTrackByName(e){for(const[,n]of this.tracks)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrack(Y.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrack(Y.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(Y.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,F.trace("update participant info",{info:e}),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(oe.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(oe.ParticipantNameChanged,e)}setPermissions(e){var n,r,i,s,o;const a=this.permissions,c=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||e.recorder!==((o=this.permissions)===null||o===void 0?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((l,u)=>{var d;return l!==((d=this.permissions)===null||d===void 0?void 0:d.canPublishSources[u])});return this.permissions=e,c&&this.emit(oe.ParticipantPermissionsChanged,a),c}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(oe.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=CW(e),n!==this._connectionQuality&&this.emit(oe.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(n=>(n.track instanceof Wa||n.track instanceof qn)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(fe.Muted,()=>{this.emit(oe.TrackMuted,e)}),e.on(fe.Unmuted,()=>{this.emit(oe.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case Y.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case Y.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function TW(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new es({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}class _b extends Cs{constructor(e,n,r){super(e,n.sid,n.name),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=sn.HIGH,this.handleEnded=i=>{this.setTrack(void 0),this.emit(fe.Ended,i)},this.handleVisibilityChange=i=>{F.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(i),{trackSid:this.trackSid}),this.disabled=!i,this.emitTrackUpdate()},this.handleVideoDimensionsChange=i=>{F.debug("adaptivestream video dimensions ".concat(i.width,"x").concat(i.height),{trackSid:this.trackSid}),this.videoDimensions=i,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new Wr({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Hi({participantSid:"",trackSids:[this.trackSid]})]});this.emit(fe.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?Cs.SubscriptionStatus.Unsubscribed:super.isSubscribed?Cs.SubscriptionStatus.Subscribed:Cs.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Cs.PermissionStatus.Allowed:Cs.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof td&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof td&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(fe.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(fe.VisibilityChanged,this.handleVisibilityChange),i.off(fe.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(fe.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(fe.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(fe.VisibilityChanged,this.handleVisibilityChange),e.on(fe.Ended,this.handleEnded),this.emit(fe.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(fe.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?fe.Muted:fe.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(fe.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(fe.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===Y.Kind.Video&&this.isAdaptiveStream?(F.warn("adaptive stream is enabled, cannot change video track settings",{trackSid:this.trackSid}),!1):this.isDesired?!0:(F.warn("cannot update track settings when not subscribed",{trackSid:this.trackSid}),!1)}get isAdaptiveStream(){return this.track instanceof td&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new Ki({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=sn.HIGH,this.emit(fe.UpdateSettings,e)}}class Ld extends IA{static fromParticipantInfo(e,n){return new Ld(e,n.sid,n.identity,n.name,n.metadata)}constructor(e,n,r,i,s){super(n,r||"",i,s),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(fe.UpdateSettings,n=>{F.debug("send update settings",n),this.signalClient.sendUpdateTrackSettings(n)}),e.on(fe.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(fe.SubscriptionPermissionChanged,n=>{this.emit(oe.TrackSubscriptionPermissionChanged,e,n)}),e.on(fe.SubscriptionStatusChanged,n=>{this.emit(oe.TrackSubscriptionStatusChanged,e,n)}),e.on(fe.Subscribed,n=>{this.emit(oe.TrackSubscribed,n,e)}),e.on(fe.Unsubscribed,n=>{this.emit(oe.TrackUnsubscribed,n,e)}),e.on(fe.SubscriptionFailed,n=>{this.emit(oe.TrackSubscriptionFailed,e.trackSid,n)})}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrack(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y.Source.Microphone;const n=this.getTrack(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,s,o){let a=this.getTrackPublication(n);if(a||n.startsWith("TR")||this.tracks.forEach(u=>{!a&&e.kind===u.kind.toString()&&(a=u)}),!a){if(o===0){F.error("could not find published track",{participant:this.sid,trackSid:n}),this.emit(oe.TrackSubscriptionFailed,n);return}o===void 0&&(o=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,s,o-1)},150);return}if(e.readyState==="ended"){F.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",{participant:this.sid,trackSid:n}),this.emit(oe.TrackSubscriptionFailed,n);return}const c=e.kind==="video";let l;return c?l=new td(e,n,i,s):l=new Wa(e,n,i,this.audioContext,this.audioOutput),l.source=a.source,l.isMuted=a.isMuted,l.setMediaStream(r),l.start(),a.setTrack(l),this.volumeMap.has(a.source)&&l instanceof Wa&&l.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var s;let o=this.getTrackPublication(i.sid);if(o)o.updateInfo(i);else{const a=Y.kindFromProto(i.type);if(!a)return;o=new _b(a,i,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe),o.updateInfo(i),r.set(i.sid,o);const c=Array.from(this.tracks.values()).find(l=>l.source===(o==null?void 0:o.source));c&&o.source!==Y.Source.Unknown&&F.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(o.source),{oldTrack:c,newTrack:o,participant:this,participantInfo:e}),this.addTrackPublication(o)}n.set(i.sid,o)}),this.tracks.forEach(i=>{n.has(i.trackSid)||(F.trace("detected removed track on remote participant, unpublishing",{publication:i,participantSid:this.sid}),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(oe.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.tracks.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(e),r.kind){case Y.Kind.Audio:this.audioTracks.delete(e);break;case Y.Kind.Video:this.videoTracks.delete(e);break}n&&this.emit(oe.TrackUnpublished,r)}setAudioOutput(e){return U(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTracks.forEach(r=>{var i;r.track instanceof Wa&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return F.trace("participant event",{participant:this.sid,event:e,args:r}),super.emit(e,...r)}}class h0 extends IA{constructor(e,n,r,i){super(e,n),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Cn.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new vA)},this.handleReconnected=()=>{var s,o;(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||o===void 0||o.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var s,o;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>F.warn(a)),(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||o===void 0||o.call(s,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{F.debug("updating track subscription permissions",{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions}),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>TW(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,o)=>{if(o===void 0&&(o=!0),!s.sid){F.error("could not update mute status for unpublished track",s);return}this.engine.updateMuteStatus(s.sid,o)},this.onTrackUpstreamPaused=s=>{F.debug("upstream paused"),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{F.debug("upstream resumed"),this.onTrackMuted(s,s.isMuted)},this.handleSubscribedQualityUpdate=s=>U(this,void 0,void 0,function*(){var o,a,c,l,u,d;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const f=this.videoTracks.get(s.trackSid);if(!f){F.warn("received subscribed quality update for unknown track",{method:"handleSubscribedQualityUpdate",sid:s.trackSid});return}if(s.subscribedCodecs.length>0){if(!f.videoTrack)return;const y=yield f.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var h=!0,p=Tc(y),g;g=yield p.next(),o=g.done,!o;h=!0){l=g.value,h=!1;const m=l;_j(m)&&(F.debug("publish ".concat(m," for ").concat(f.videoTrack.sid)),yield this.publishAdditionalCodecForTrack(f.videoTrack,m,f.options))}}catch(m){a={error:m}}finally{try{!h&&!o&&(c=p.return)&&(yield c.call(p))}finally{if(a)throw a.error}}}else s.subscribedQualities.length>0&&(yield(d=f.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(s.subscribedQualities))}),this.handleLocalTrackUnpublished=s=>{const o=this.tracks.get(s.trackSid);if(!o){F.warn("received unpublished event for unknown track",{method:"handleLocalTrackUnpublished",trackSid:s.trackSid});return}this.unpublishTrack(o.track)},this.handleTrackEnded=s=>U(this,void 0,void 0,function*(){if(s.source===Y.Source.ScreenShare||s.source===Y.Source.ScreenShareAudio)F.debug("unpublishing local track due to TrackEnded",{track:s.sid}),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(s instanceof qn||s instanceof wr)try{if(pr())try{const o=yield navigator==null?void 0:navigator.permissions.query({name:s.source===Y.Source.Camera?"camera":"microphone"});if(o&&o.state==="denied")throw F.warn("user has revoked access to ".concat(s.source)),o.onchange=()=>{o.state!=="denied"&&(s.isMuted||s.restartTrack(),o.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}s.isMuted||(F.debug("track ended, attempting to use a different device"),yield s.restartTrack())}catch{F.warn("could not restart track, muting instead"),yield s.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Cn.NONE}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(ge.RemoteMute,(n,r)=>{const i=this.tracks.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(ge.Connected,this.handleReconnected).on(ge.SignalRestarted,this.handleReconnected).on(ge.SignalResumed,this.handleReconnected).on(ge.Restarting,this.handleReconnecting).on(ge.Resuming,this.handleReconnecting).on(ge.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(ge.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(ge.Disconnected,this.handleDisconnected)}setMetadata(e){var n;this.engine.client.sendUpdateLocalMetadata(e,(n=this.name)!==null&&n!==void 0?n:"")}setName(e){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",e)}setCameraEnabled(e,n,r){return this.setTrackEnabled(Y.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(Y.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(Y.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(oe.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return U(this,void 0,void 0,function*(){this.encryptionType=e?Cn.GCM:Cn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){var s,o;return U(this,void 0,void 0,function*(){F.debug("setTrackEnabled",{source:e,enabled:n});let a=this.getTrack(e);if(n)if(a)yield a.unmute();else{let c;if(this.pendingPublishing.has(e)){F.info("skipping duplicate published source",{source:e});return}this.pendingPublishing.add(e);try{switch(e){case Y.Source.Camera:c=yield this.createTracks({video:(s=r)!==null&&s!==void 0?s:!0});break;case Y.Source.Microphone:c=yield this.createTracks({audio:(o=r)!==null&&o!==void 0?o:!0});break;case Y.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},r));break;default:throw new Fi(e)}const l=[];for(const d of c)F.info("publishing track",{localTrack:d}),l.push(this.publishTrack(d,i));[a]=yield Promise.all(l)}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l instanceof Error&&!(l instanceof Fi)&&this.emit(oe.MediaDevicesError,l),l}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===Y.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const c=this.getTrack(Y.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return U(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Y.Source.Camera)||this.pendingPublishing.has(Y.Source.Microphone))){this.pendingPublishing.add(Y.Source.Camera),this.pendingPublishing.add(Y.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(Y.Source.Camera),this.pendingPublishing.delete(Y.Source.Microphone)}}})}createTracks(e){var n,r;return U(this,void 0,void 0,function*(){const i=fA(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),s=Em(i);let o;try{o=yield navigator.mediaDevices.getUserMedia(s)}catch(a){throw a instanceof Error&&(s.audio&&(this.microphoneError=a),s.video&&(this.cameraError=a)),a}return s.audio&&(this.microphoneError=void 0,this.emit(oe.AudioStreamAcquired)),s.video&&(this.cameraError=void 0),o.getTracks().map(a=>{const c=a.kind==="audio";c?e.audio:e.video;let l;const u=c?s.audio:s.video;typeof u!="boolean"&&(l=u);const d=EA(a,l);return d.kind===Y.Kind.Video?d.source=Y.Source.Camera:d.kind===Y.Kind.Audio&&(d.source=Y.Source.Microphone),d.mediaStream=o,d})})}createScreenTracks(e){return U(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new Sb("getDisplayMedia not supported");const n=Nj(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new Fi("no video track found");const s=new wr(i[0],void 0,!1);s.source=Y.Source.ScreenShare;const o=[s];if(r.getAudioTracks().length>0){this.emit(oe.AudioStreamAcquired);const a=new qn(r.getAudioTracks()[0],void 0,!1,this.audioContext);a.source=Y.Source.ScreenShareAudio,o.push(a)}return o})}publishTrack(e,n){var r,i,s,o;return U(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,e instanceof Ol&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let a;if(e instanceof MediaStreamTrack)a=e.getConstraints();else{a=e.constraints;let h;switch(e.source){case Y.Source.Microphone:h="audioinput";break;case Y.Source.Camera:h="videoinput"}h&&this.activeDeviceMap.has(h)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(h)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new qn(e,a,!0,this.audioContext);break;case"video":e=new wr(e,a,!0);break;default:throw new Fi("unsupported MediaStreamTrack kind ".concat(e.kind))}e instanceof qn&&e.setAudioContext(this.audioContext);let c;if(this.tracks.forEach(h=>{h.track&&h.track===e&&(c=h)}),c)return F.warn("track has already been published, skipping"),c;const l="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,u=(i=n==null?void 0:n.forceStereo)!==null&&i!==void 0?i:l;u&&(n||(n={}),n.dtx===void 0&&F.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work."),n.red===void 0&&F.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(s=n.dtx)!==null&&s!==void 0||(n.dtx=!1),(o=n.red)!==null&&o!==void 0||(n.red=!1));const d=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);Xa()&&this.roomOptions.e2ee&&(F.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari"),d.simulcast=!1),d.source&&(e.source=d.source);const f=this.publish(e,d,u);this.pendingPublishPromises.set(e,f);try{return yield f}catch(h){throw h}finally{this.pendingPublishPromises.delete(e)}})}publish(e,n,r){var i,s,o,a,c,l,u,d,f,h,p,g,y;return U(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(R=>e instanceof Ol&&R.source===e.source)&&e.source!==Y.Source.Unknown&&F.info("publishing a second track with the same source: ".concat(e.source)),n.stopMicTrackOnMute&&e instanceof qn&&(e.stopOnMute=!0),e.source===Y.Source.ScreenShare&&xl()&&(n.simulcast=!1),n.videoCodec==="av1"&&!Dj()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!Lj()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=u0);const v=n.videoCodec;e.on(fe.Muted,this.onTrackMuted),e.on(fe.Unmuted,this.onTrackUnmuted),e.on(fe.Ended,this.handleTrackEnded),e.on(fe.UpstreamPaused,this.onTrackUpstreamPaused),e.on(fe.UpstreamResumed,this.onTrackUpstreamResumed);const w=new mi({cid:e.mediaStreamTrack.id,name:n.name,type:Y.kindToProto(e.kind),muted:e.isMuted,source:Y.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((s=n.red)!==null&&s!==void 0)||s),stream:n==null?void 0:n.stream});let _;if(e.kind===Y.Kind.Video){let R={width:0,height:0};try{R=yield e.waitForDimensions()}catch{const M=(a=(o=this.roomOptions.videoCaptureDefaults)===null||o===void 0?void 0:o.resolution)!==null&&a!==void 0?a:Od.h720.resolution;R={width:M.width,height:M.height},F.error("could not determine track dimensions, using defaults",R)}w.width=R.width,w.height=R.height,e instanceof wr&&(Qu(v)&&(e.source===Y.Source.ScreenShare&&v==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(c=n.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),w.simulcastCodecs=[new pi({codec:v,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:u0}),n.backupCodec&&v!==n.backupCodec.codec&&w.encryption===Cn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),w.simulcastCodecs.push(new pi({codec:n.backupCodec.codec,cid:""})))),_=f0(e.source===Y.Source.ScreenShare,w.width,w.height,n),w.layers=gC(w.width,w.height,_,Qu(n.videoCodec))}else e.kind===Y.Kind.Audio&&(_=[{maxBitrate:(u=(l=n.audioPreset)===null||l===void 0?void 0:l.maxBitrate)!==null&&u!==void 0?u:n.audioBitrate,priority:(f=(d=n.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&f!==void 0?f:"high",networkPriority:(p=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new Yt("cannot publish track when not connected");const C=yield this.engine.addTrack(w);let k;if(C.codecs.forEach(R=>{k===void 0&&(k=R.mimeType)}),k&&e.kind===Y.Kind.Video){const R=hA(k);R!==v&&(F.debug("falling back to server selected codec",{codec:R}),n.videoCodec=R,_=f0(e.source===Y.Source.ScreenShare,w.width,w.height,n))}const T=new Dd(e.kind,C,e);if(T.options=n,e.sid=C.sid,!this.engine.pcManager)throw new Yt("pcManager is not ready");if(F.debug("publishing ".concat(e.kind," with encodings"),{encodings:_,trackInfo:C}),e.sender=yield this.engine.createSender(e,n,_),_)if(xl()&&e.kind===Y.Kind.Audio){let R;for(const A of this.engine.pcManager.publisher.getTransceivers())if(A.sender===e.sender){R=A;break}R&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:R,codec:"opus",maxbr:!((g=_[0])===null||g===void 0)&&g.maxBitrate?_[0].maxBitrate/1e3:0})}else e.codec&&Qu(e.codec)&&(!((y=_[0])===null||y===void 0)&&y.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:w.cid,codec:e.codec,maxbr:_[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof wr?e.startMonitor(this.engine.client):e instanceof qn&&e.startMonitor(),this.addTrackPublication(T),this.emit(oe.LocalTrackPublished,T),T})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){var i;return U(this,void 0,void 0,function*(){if(this.encryptionType!==Cn.NONE)return;let s;if(this.tracks.forEach(d=>{d.track&&d.track===e&&(s=d)}),!s)throw new Fi("track is not published");if(!(e instanceof wr))throw new Fi("track is not a video track");const o=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=SW(e,n,o);if(!a){F.info("backup codec has been disabled, ignoring request to add additional codec for track");return}const c=e.addSimulcastTrack(n,a),l=new mi({cid:c.mediaStreamTrack.id,type:Y.kindToProto(e.kind),muted:e.isMuted,source:Y.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:c.mediaStreamTrack.id}]});if(l.layers=gC(l.width,l.height,a),!this.engine||this.engine.isClosed)throw new Yt("cannot publish track when not connected");const u=yield this.engine.addTrack(l);yield this.engine.createSimulcastSender(e,c,o,a),yield this.engine.negotiate(),F.debug("published ".concat(n," for track ").concat(e.sid),{encodings:a,trackInfo:u})})}unpublishTrack(e,n){var r,i;return U(this,void 0,void 0,function*(){const s=this.getPublicationForTrack(e);if(F.debug("unpublishing track",{track:e,method:"unpublishTrack"}),!s||!s.track){F.warn("track was not unpublished because no publication was found",{track:e,method:"unpublishTrack"});return}e=s.track,e.off(fe.Muted,this.onTrackMuted),e.off(fe.Unmuted,this.onTrackUnmuted),e.off(fe.Ended,this.handleTrackEnded),e.off(fe.UpstreamPaused,this.onTrackUpstreamPaused),e.off(fe.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n&&e.stop();let o=!1;const a=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Qt.FAILED&&a)try{for(const c of this.engine.pcManager.publisher.getTransceivers())c.sender===a&&(c.direction="inactive",o=!0);if(this.engine.removeTrack(a)&&(o=!0),e instanceof wr){for(const[,c]of e.simulcastCodecs)c.sender&&(this.engine.removeTrack(c.sender)&&(o=!0),c.sender=void 0);e.simulcastCodecs.clear()}}catch(c){F.warn("failed to unpublish track",{error:c,method:"unpublishTrack"})}switch(this.tracks.delete(s.trackSid),s.kind){case Y.Kind.Audio:this.audioTracks.delete(s.trackSid);break;case Y.Kind.Video:this.videoTracks.delete(s.trackSid);break}return this.emit(oe.LocalTrackUnpublished,s),s.setTrack(void 0),o&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return U(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof Dd)})}republishAllTracks(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return U(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(e&&(i.options=Object.assign(Object.assign({},i.options),e)),r.push(i))}),yield Promise.all(r.map(i=>U(this,void 0,void 0,function*(){const s=i.track;yield this.unpublishTrack(s,!1),n&&!s.isMuted&&(s instanceof qn||s instanceof wr)&&!s.isUserProvided&&(F.debug("restarting existing track",{track:i.trackSid}),yield s.restartTrack()),yield this.publishTrack(s,i.options)})))})}publishData(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return U(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,s=[],o=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(c=>{c instanceof Ld?s.push(c.sid):s.push(c)});const a=new Vi({kind:n,value:{case:"user",value:new $i({participantSid:this.sid,payload:e,destinationSids:s,topic:o})}});yield this.engine.sendDataPacket(a,n)})}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const s=this.tracks.get(n.sid);if(s){const o=s.isMuted||((i=(r=s.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);o!==n.muted&&(F.debug("updating server mute state after reconcile",{sid:n.sid,muted:o}),this.engine.client.sendMuteTrack(n.sid,o))}}),!0)}getPublicationForTrack(e){let n;return this.tracks.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof qn||i instanceof wr)&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}}var Ze;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting"})(Ze||(Ze={}));const _W=2*1e3;class Pp extends vs.EventEmitter{constructor(e){var n,r;super(),n=this,this.state=Ze.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.connect=(i,s,o)=>U(this,void 0,void 0,function*(){var a;const c=yield this.disconnectLock.lock();if(this.state===Ze.Connected)return F.info("already connected to room ".concat(this.name)),c(),Promise.resolve();if(this.connectFuture)return c(),this.connectFuture.promise;this.setAndEmitConnectionState(Ze.Connecting),((a=this.regionUrlProvider)===null||a===void 0?void 0:a.getServerUrl().toString())!==i&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),l0(new URL(i))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new fC(i,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().catch(d=>{F.warn("could not fetch region settings",{error:d})}));const l=(d,f,h)=>U(this,void 0,void 0,function*(){var p;this.abortController&&this.abortController.abort();const g=new AbortController;this.abortController=g,c==null||c();try{yield this.attemptConnection(h??i,s,o,g),this.abortController=void 0,d()}catch(y){if(this.regionUrlProvider&&y instanceof Pt&&y.reason!==3&&y.reason!==0){let m=null;try{m=yield this.regionUrlProvider.getNextBestRegionUrl((p=this.abortController)===null||p===void 0?void 0:p.signal)}catch(v){if(v instanceof Pt&&(v.status===401||v.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(v);return}}m?(F.info("Initial connection failed with ConnectionError: ".concat(y.message,". Retrying with another region: ").concat(m)),yield l(d,f,m)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(y))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(y)}}),u=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new vA((d,f)=>{l(d,f,u)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(i,s,o,a,c,l)=>U(this,void 0,void 0,function*(){const u=yield o.join(i,s,{autoSubscribe:a.autoSubscribe,publishOnly:a.publishOnly,adaptiveStream:typeof c.adaptiveStream=="object"?!0:c.adaptiveStream,maxRetries:a.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:a.websocketTimeout},l.signal);let d=u.serverInfo;if(d||(d={version:u.serverVersion,region:u.serverRegion}),F.debug("connected to Livekit Server ".concat(Object.entries(d).map(f=>{let[h,p]=f;return"".concat(h,": ").concat(p)}).join(", "))),!u.serverVersion)throw new Sj("unknown server version");return u.serverVersion==="0.15.1"&&this.options.dynacast&&(F.debug("disabling dynacast due to server version"),c.dynacast=!1),u}),this.applyJoinResponse=i=>{const s=i.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...i.otherParticipants]),i.room&&this.handleRoomUpdate(i.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(i.sifTrailer)},this.attemptConnection=(i,s,o,a)=>U(this,void 0,void 0,function*(){var c,l;this.state===Ze.Reconnecting?(F.info("Reconnection attempt replaced by new connection attempt"),this.recreateEngine()):this.maybeCreateEngine(),!((c=this.regionUrlProvider)===null||c===void 0)&&c.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Cb),o),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const u=yield this.connectSignal(i,s,this.engine,this.connOptions,this.options,a);this.applyJoinResponse(u),this.setupLocalParticipantEvents(),this.emit(ne.SignalConnected)}catch(u){yield this.engine.close(),this.recreateEngine();const d=new Pt("could not establish signal connection");throw u instanceof Error&&(d.message="".concat(d.message,": ").concat(u.message)),u instanceof Pt&&(d.reason=u.reason,d.status=u.status),F.debug("error trying to establish signal connection",{error:u}),d}if(a.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Pt("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,a)}catch(u){throw yield this.engine.close(),this.recreateEngine(),u}pr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),pr()&&(document.addEventListener("freeze",this.onPageLeave),(l=navigator.mediaDevices)===null||l===void 0||l.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(Ze.Connected),this.emit(ne.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return U(n,void 0,void 0,function*(){var s,o,a,c;const l=yield this.disconnectLock.lock();try{if(this.state===Ze.Disconnected){F.debug("already disconnected");return}F.info("disconnect from room",{identity:this.localParticipant.identity}),(this.state===Ze.Connecting||this.state===Ze.Reconnecting)&&(F.warn("abort connection attempt"),(s=this.abortController)===null||s===void 0||s.abort(),(a=(o=this.connectFuture)===null||o===void 0?void 0:o.reject)===null||a===void 0||a.call(o,new Pt("Client initiated disconnect")),this.connectFuture=void 0),!((c=this.engine)===null||c===void 0)&&c.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(i,to.CLIENT_INITIATED),this.engine=void 0}finally{l()}})},this.onPageLeave=()=>U(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>U(this,void 0,void 0,function*(){const i=[],s=ca();if(s&&s.os==="iOS"){const o="livekit-dummy-audio-el";let a=document.getElementById(o);if(!a){a=document.createElement("audio"),a.id=o,a.autoplay=!0,a.hidden=!0;const c=Qg();c.enabled=!0;const l=new MediaStream([c]);a.srcObject=l,document.addEventListener("visibilitychange",()=>{a&&(a.srcObject=document.hidden?null:l)}),document.body.append(a),this.once(ne.Disconnected,()=>{a==null||a.remove()})}i.push(a)}this.participants.forEach(o=>{o.audioTracks.forEach(a=>{a.track&&a.track.attachedElements.forEach(c=>{i.push(c)})})});try{yield Promise.all([this.acquireAudioContext(),...i.map(o=>(o.muted=!1,o.play()))]),this.handleAudioPlaybackStarted()}catch(o){throw this.handleAudioPlaybackFailed(o),o}}),this.startVideo=()=>U(this,void 0,void 0,function*(){const i=[];for(const s of this.participants.values())s.videoTracks.forEach(o=>{var a;(a=o.track)===null||a===void 0||a.attachedElements.forEach(c=>{i.includes(c)||i.push(c)})});yield Promise.all(i.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():F.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler")})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const i of this.participants.values())this.handleParticipantDisconnected(i.sid,i);this.setAndEmitConnectionState(Ze.Reconnecting)&&this.emit(ne.Reconnecting)},this.handleSignalRestarted=i=>U(this,void 0,void 0,function*(){F.debug("signal reconnected to server",{region:i.serverRegion}),this.cachedParticipantSids=[],this.applyJoinResponse(i);try{const s=[];this.localParticipant.tracks.forEach(o=>{o.track&&s.push(o)}),yield Promise.all(s.map(o=>U(this,void 0,void 0,function*(){const a=o.track;this.localParticipant.unpublishTrack(a,!1),a.isMuted||((a instanceof qn||a instanceof wr)&&a.source!==Y.Source.ScreenShare&&a.source!==Y.Source.ScreenShareAudio&&!a.isUserProvided&&(F.debug("restarting existing track",{track:o.trackSid}),yield a.restartTrack()),F.debug("publishing new track",{track:o.trackSid}),yield this.localParticipant.publishTrack(a,o.options))})))}catch(s){F.error("error trying to re-publish tracks after reconnection",{error:s})}try{yield this.engine.waitForRestarted(),F.debug("fully reconnected to server",{region:i.serverRegion})}catch{return}this.setAndEmitConnectionState(Ze.Connected),this.emit(ne.Reconnected),this.registerConnectionReconcile(),this.participants.forEach(s=>{this.emit(ne.ParticipantConnected,s)})}),this.handleParticipantUpdates=i=>{i.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const o=this.identityToSid.get(s.identity);o&&o!==s.sid&&this.handleParticipantDisconnected(o,this.participants.get(o));let a=this.participants.get(s.sid);const c=!a;s.state===Ka.DISCONNECTED?this.handleParticipantDisconnected(s.sid,a):(a=this.getOrCreateParticipant(s.sid,s),c||a.updateInfo(s))})},this.handleActiveSpeakersUpdate=i=>{const s=[],o={};i.forEach(a=>{if(o[a.sid]=!0,a.sid===this.localParticipant.sid)this.localParticipant.audioLevel=a.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const c=this.participants.get(a.sid);c&&(c.audioLevel=a.level,c.setIsSpeaking(!0),s.push(c))}}),o[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(a=>{o[a.sid]||(a.audioLevel=0,a.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(ne.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=i=>{const s=new Map;this.activeSpeakers.forEach(a=>{s.set(a.sid,a)}),i.forEach(a=>{let c=this.participants.get(a.sid);a.sid===this.localParticipant.sid&&(c=this.localParticipant),c&&(c.audioLevel=a.level,c.setIsSpeaking(a.active),a.active?s.set(a.sid,c):s.delete(a.sid))});const o=Array.from(s.values());o.sort((a,c)=>c.audioLevel-a.audioLevel),this.activeSpeakers=o,this.emitWhenConnected(ne.ActiveSpeakersChanged,o)},this.handleStreamStateUpdate=i=>{i.streamStates.forEach(s=>{const o=this.participants.get(s.participantSid);if(!o)return;const a=o.getTrackPublication(s.trackSid);!a||!a.track||(a.track.streamState=Y.streamStateFromProto(s.state),o.emit(oe.TrackStreamStateChanged,a,a.track.streamState),this.emitWhenConnected(ne.TrackStreamStateChanged,a,a.track.streamState,o))})},this.handleSubscriptionPermissionUpdate=i=>{const s=this.participants.get(i.participantSid);if(!s)return;const o=s.getTrackPublication(i.trackSid);o&&o.setAllowed(i.allowed)},this.handleSubscriptionError=i=>{const s=Array.from(this.participants.values()).find(a=>a.tracks.has(i.trackSid));if(!s)return;const o=s.getTrackPublication(i.trackSid);o&&o.setSubscriptionError(i.err)},this.handleDataPacket=(i,s)=>{const o=this.participants.get(i.participantSid);this.emit(ne.DataReceived,i.payload,o,s,i.topic),o==null||o.emit(oe.DataReceived,i.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ne.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=i=>{F.warn("could not playback audio",i),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ne.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ne.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ne.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>U(this,void 0,void 0,function*(){this.emit(ne.MediaDevicesChanged)}),this.handleRoomUpdate=i=>{const s=this.roomInfo;this.roomInfo=i,s&&s.metadata!==i.metadata&&this.emitWhenConnected(ne.RoomMetadataChanged,i.metadata),(s==null?void 0:s.activeRecording)!==i.activeRecording&&this.emitWhenConnected(ne.RecordingStatusChanged,i.activeRecording)},this.handleConnectionQualityUpdate=i=>{i.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const o=this.participants.get(s.participantSid);o&&o.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=i=>{this.emit(ne.ParticipantMetadataChanged,i,this.localParticipant)},this.onLocalParticipantNameChanged=i=>{this.emit(ne.ParticipantNameChanged,i,this.localParticipant)},this.onLocalTrackMuted=i=>{this.emit(ne.TrackMuted,i,this.localParticipant)},this.onLocalTrackUnmuted=i=>{this.emit(ne.TrackUnmuted,i,this.localParticipant)},this.onLocalTrackPublished=i=>U(this,void 0,void 0,function*(){var s;this.emit(ne.LocalTrackPublished,i,this.localParticipant),i.track instanceof qn&&(yield i.track.checkForSilence())&&this.emit(ne.LocalAudioSilenceDetected,i);const o=yield(s=i.track)===null||s===void 0?void 0:s.getDeviceId(),a=Aj(i.source);a&&o&&o!==this.localParticipant.activeDeviceMap.get(a)&&(this.localParticipant.activeDeviceMap.set(a,o),this.emit(ne.ActiveDeviceChanged,a,o))}),this.onLocalTrackUnpublished=i=>{this.emit(ne.LocalTrackUnpublished,i,this.localParticipant)},this.onLocalConnectionQualityChanged=i=>{this.emit(ne.ConnectionQualityChanged,i,this.localParticipant)},this.onMediaDevicesError=i=>{this.emit(ne.MediaDevicesError,i)},this.onLocalParticipantPermissionsChanged=i=>{this.emit(ne.ParticipantPermissionsChanged,i,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.cachedParticipantSids=[],this.identityToSid=new Map,this.options=Object.assign(Object.assign({},cW),e),this.options.audioCaptureDefaults=Object.assign(Object.assign({},wA),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},kA),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},aW),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new ki,this.localParticipant=new h0("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",ja(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",ja(this.options.audioCaptureDefaults.deviceId)),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&this.switchActiveDevice("audiooutput",ja(this.options.audioOutput.deviceId)).catch(i=>F.warn("Could not set audio output: ".concat(i.message))),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return U(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new qj(this.options.e2ee),this.e2eeManager.on(zo.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof h0&&(this.isE2EEEnabled=n),this.emit(ne.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(zo.EncryptionError,n=>this.emit(ne.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&n!==void 0?n:""}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new dW(this.options),this.engine.on(ge.ParticipantUpdate,this.handleParticipantUpdates).on(ge.RoomUpdate,this.handleRoomUpdate).on(ge.SpeakersChanged,this.handleSpeakersChanged).on(ge.StreamStateChanged,this.handleStreamStateUpdate).on(ge.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(ge.SubscriptionError,this.handleSubscriptionError).on(ge.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(ge.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(ge.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(ge.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(ge.DataPacketReceived,this.handleDataPacket).on(ge.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(Ze.Reconnecting)&&this.emit(ne.Reconnecting),this.cachedParticipantSids=Array.from(this.participants.keys())}).on(ge.Resumed,()=>{this.setAndEmitConnectionState(Ze.Connected),this.emit(ne.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),Array.from(this.participants.values()).filter(n=>!this.cachedParticipantSids.includes(n.sid)).forEach(n=>this.emit(ne.ParticipantConnected,n)),this.cachedParticipantSids=[]}).on(ge.SignalResumed,()=>{this.state===Ze.Reconnecting&&this.sendSyncState()}).on(ge.Restarting,this.handleRestarting).on(ge.SignalRestarted,this.handleSignalRestarted).on(ge.DCBufferStatusChanged,(e,n)=>{this.emit(ne.DCBufferStatusChanged,e,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Yn.getInstance().getDevices(e,n)}prepareConnection(e,n){return U(this,void 0,void 0,function*(){if(this.state===Ze.Disconnected){F.debug("prepareConnection to ".concat(e));try{if(l0(new URL(e))&&n){this.regionUrlProvider=new fC(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===Ze.Disconnected&&(this.regionUrl=r,yield fetch(nC(r),{method:"HEAD"}),F.debug("prepared connection to ".concat(r)))}else yield fetch(nC(e),{method:"HEAD"})}catch(r){F.warn("could not prepare connection",{error:r})}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const n=this.identityToSid.get(e);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return U(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new Kn({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new Kn({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new Kn({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new Kn({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new Kn({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>U(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new Vr({reason:to.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new Kn({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}i&&(this.engine.client.sendSimulateScenario(i),r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,n;return(n=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,s,o;return U(this,void 0,void 0,function*(){let a=!1,c=!0;const l=r?{exact:n}:n;if(e==="audioinput"){const u=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.audioTracks.values()).filter(f=>f.source===Y.Source.Microphone);try{c=(yield Promise.all(d.map(f=>{var h;return(h=f.audioTrack)===null||h===void 0?void 0:h.setDeviceId(l)}))).every(f=>f===!0)}catch(f){throw this.options.audioCaptureDefaults.deviceId=u,f}}else if(e==="videoinput"){const u=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.videoTracks.values()).filter(f=>f.source===Y.Source.Camera);try{c=(yield Promise.all(d.map(f=>{var h;return(h=f.videoTrack)===null||h===void 0?void 0:h.setDeviceId(l)}))).every(f=>f===!0)}catch(f){throw this.options.videoCaptureDefaults.deviceId=u,f}}else if(e==="audiooutput"){if(!c0()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(o=this.options).audioOutput)!==null&&i!==void 0||(o.audioOutput={});const u=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,a=u!==l;try{this.options.expWebAudioMix?(s=this.audioContext)===null||s===void 0||s.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(d=>d.setAudioOutput({deviceId:n})))}catch(d){throw this.options.audioOutput.deviceId=u,d}}return a&&c&&(this.localParticipant.activeDeviceMap.set(e,n),this.emit(ne.ActiveDeviceChanged,e,n)),c})}setupLocalParticipantEvents(){this.localParticipant.on(oe.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(oe.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(oe.TrackMuted,this.onLocalTrackMuted).on(oe.TrackUnmuted,this.onLocalTrackUnmuted).on(oe.LocalTrackPublished,this.onLocalTrackPublished).on(oe.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(oe.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(oe.MediaDevicesError,this.onMediaDevicesError).on(oe.AudioStreamAcquired,this.startAudio).on(oe.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===Ze.Connecting||this.state===Ze.Reconnecting){const u=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(ne.Reconnected,u),this.off(ne.Connected,u),this.off(ne.Disconnected,d)};this.once(ne.Reconnected,u),this.once(ne.Connected,u),this.once(ne.Disconnected,d);return}if(this.state===Ze.Disconnected){F.warn("skipping incoming track after Room disconnected");return}const i=Oj(n.id),s=i[0];let o=i[1],a=e.id;if(o&&o.startsWith("TR")&&(a=o),s===this.localParticipant.sid){F.warn("tried to create RemoteParticipant for local participant");return}const c=this.participants.get(s);if(!c){F.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s));return}let l;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?l=this.options.adaptiveStream:l={}),c.addSubscribedMediaTrack(e,a,n,r,l)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.state!==Ze.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(s=>{i.unpublishTrack(s.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var s,o;i.track&&this.localParticipant.unpublishTrack(i.track,e),e&&((s=i.track)===null||s===void 0||s.detach(),(o=i.track)===null||o===void 0||o.stop())}),this.localParticipant.off(oe.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(oe.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(oe.TrackMuted,this.onLocalTrackMuted).off(oe.TrackUnmuted,this.onLocalTrackUnmuted).off(oe.LocalTrackPublished,this.onLocalTrackPublished).off(oe.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(oe.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(oe.MediaDevicesError,this.onMediaDevicesError).off(oe.AudioStreamAcquired,this.startAudio).off(oe.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),pr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ze.Disconnected),this.emit(ne.Disconnected,n)}}}handleParticipantDisconnected(e,n){this.participants.delete(e),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(ne.ParticipantDisconnected,n))}acquireAudioContext(){var e,n;return U(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=wb())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){F.warn(i)}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(ne.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=Ld.fromParticipantInfo(this.engine.client,n):i=new Ld(this.engine.client,e,"",void 0,void 0),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(s=>F.warn("Could not set audio output: ".concat(s.message))),i}getOrCreateParticipant(e,n){if(this.participants.has(e))return this.participants.get(e);const r=this.createParticipant(e,n);return this.participants.set(e,r),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(ne.ParticipantConnected,r),r.on(oe.TrackPublished,i=>{this.emitWhenConnected(ne.TrackPublished,i,r)}).on(oe.TrackSubscribed,(i,s)=>{i.kind===Y.Kind.Audio?(i.on(fe.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(fe.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===Y.Kind.Video&&(i.on(fe.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(fe.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ne.TrackSubscribed,i,s,r)}).on(oe.TrackUnpublished,i=>{this.emit(ne.TrackUnpublished,i,r)}).on(oe.TrackUnsubscribed,(i,s)=>{this.emit(ne.TrackUnsubscribed,i,s,r)}).on(oe.TrackSubscriptionFailed,i=>{this.emit(ne.TrackSubscriptionFailed,i,r)}).on(oe.TrackMuted,i=>{this.emitWhenConnected(ne.TrackMuted,i,r)}).on(oe.TrackUnmuted,i=>{this.emitWhenConnected(ne.TrackUnmuted,i,r)}).on(oe.ParticipantMetadataChanged,i=>{this.emitWhenConnected(ne.ParticipantMetadataChanged,i,r)}).on(oe.ParticipantNameChanged,i=>{this.emitWhenConnected(ne.ParticipantNameChanged,i,r)}).on(oe.ConnectionQualityChanged,i=>{this.emitWhenConnected(ne.ConnectionQualityChanged,i,r)}).on(oe.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(ne.ParticipantPermissionsChanged,i,r)}).on(oe.TrackSubscriptionStatusChanged,(i,s)=>{this.emitWhenConnected(ne.TrackSubscriptionStatusChanged,i,s,r)}).on(oe.TrackSubscriptionFailed,(i,s)=>{this.emit(ne.TrackSubscriptionFailed,i,r,s)}).on(oe.TrackSubscriptionPermissionChanged,(i,s)=>{this.emitWhenConnected(ne.TrackSubscriptionPermissionChanged,i,s,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.participants.values())for(const n of e.videoTracks.values())n.isSubscribed&&n instanceof _b&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Tn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,F.warn("detected connection state mismatch",{numFailures:e}),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,to.STATE_MISMATCH))):e=0},_W)}clearConnectionReconcile(){this.connectionReconcileInterval&&Tn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(ne.ConnectionStateChanged,this.state),!0)}emitWhenConnected(e){if(this.state===Ze.Connected){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.emit(e,...r)}return!1}simulateParticipants(e){var n,r;return U(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new eu({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:xe.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new _r({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ne.SignalConnected),this.emit(ne.Connected),this.setAndEmitConnectionState(Ze.Connected),i.video){const o=new Dd(Y.Kind.Video,new ur({source:Vt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Ln.AUDIO,name:"video-dummy"}),new wr(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:tC((n=160*s.aspectRatios[0])!==null&&n!==void 0?n:1,160,!0,!0)));this.localParticipant.addTrackPublication(o),this.localParticipant.emit(oe.LocalTrackPublished,o)}if(i.audio){const o=new Dd(Y.Kind.Audio,new ur({source:Vt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Ln.AUDIO}),new qn(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Qg()));this.localParticipant.addTrackPublication(o),this.localParticipant.emit(oe.LocalTrackPublished,o)}for(let o=0;o<s.count-1;o+=1){let a=new _r({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(o),state:Ka.ACTIVE,tracks:[],joinedAt:xe.parse(Date.now())});const c=this.getOrCreateParticipant(a.identity,a);if(s.video){const l=tC((r=160*s.aspectRatios[o%s.aspectRatios.length])!==null&&r!==void 0?r:1,160,!1,!0),u=new ur({source:Vt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Ln.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}if(s.audio){const l=Qg(),u=new ur({source:Vt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Ln.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}c.updateInfo(a)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e!==ne.ActiveSpeakersChanged&&F.debug("room event ".concat(e),{event:e,args:r}),super.emit(e,...r)}}var ui;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(ui||(ui={}));class nu extends vs.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=ui.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Pp(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return U(this,void 0,void 0,function*(){if(this.status!==ui.IDLE)throw Error("check is running already");this.setStatus(ui.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==ui.SKIPPED&&this.setStatus(this.isSuccess()?ui.SUCCESS:ui.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return U(this,void 0,void 0,function*(){return this.room.state===Ze.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return U(this,void 0,void 0,function*(){this.room&&this.room.state!==Ze.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(ui.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function RA(t){var e,n;return U(this,void 0,void 0,function*(){t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio=!0),(n=t.video)!==null&&n!==void 0||(t.video=!0);const r=fA(t,wA,kA),i=Em(r),s=navigator.mediaDevices.getUserMedia(i);t.audio&&(Yn.userMediaPromiseMap.set("audioinput",s),s.catch(()=>Yn.userMediaPromiseMap.delete("audioinput"))),t.video&&(Yn.userMediaPromiseMap.set("videoinput",s),s.catch(()=>Yn.userMediaPromiseMap.delete("videoinput")));const o=yield s;return o.getTracks().map(a=>{const c=a.kind==="audio";c?t.audio:t.video;let l;const u=c?i.audio:i.video;typeof u!="boolean"&&(l=u),l?l.deviceId=a.getSettings().deviceId:l={deviceId:a.getSettings().deviceId};const d=EA(a,l);return d.kind===Y.Kind.Video?d.source=Y.Source.Camera:d.kind===Y.Kind.Audio&&(d.source=Y.Source.Microphone),d.mediaStream=o,d})})}function IW(t){return U(this,void 0,void 0,function*(){return(yield RA({audio:!1,video:t}))[0]})}function RW(t){return U(this,void 0,void 0,function*(){return(yield RA({audio:t,video:!1}))[0]})}class PW extends nu{get description(){return"Can publish audio"}perform(){var e;return U(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield RW();n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&o.mediaType==="audio"&&(s=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class AW extends nu{get description(){return"Can publish video"}perform(){var e;return U(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield IW();n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&o.mediaType==="video"&&(s=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}}class NW extends nu{get description(){return"Resuming connection after interruption"}perform(){var e;return U(this,void 0,void 0,function*(){const n=yield this.connect();let r=!1,i=!1,s;const o=new Promise(c=>{setTimeout(c,5e3),s=c});n.on(ne.Reconnecting,()=>{r=!0}).on(ne.Reconnected,()=>{i=!0,s(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const a=n.engine.client.onClose;if(a&&a(""),yield o,r){if(!i||n.state!==Ze.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class MW extends nu{get description(){return"Can connect via TURN"}perform(){var e,n;return U(this,void 0,void 0,function*(){const r=new Eb,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let s=!1,o=!1,a=!1;for(let c of i.iceServers)for(let l of c.urls)l.startsWith("turn:")?(o=!0,a=!0):l.startsWith("turns:")&&(o=!0,a=!0,s=!0),l.startsWith("stun:")&&(a=!0);a?o&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||o?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(c=>setTimeout(c,0)))})}}class xW extends nu{get description(){return"Establishing WebRTC connection"}perform(){return U(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(ne.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,s)=>{if(i.candidate){const o=new RTCIceCandidate(i);let a="".concat(o.protocol," ").concat(o.address,":").concat(o.port," ").concat(o.type);o.address&&(OW(o.address)?a+=" (private)":o.protocol==="tcp"&&o.tcpType==="passive"?(e=!0,a+=" (passive)"):o.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,s)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),F.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function OW(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class DW extends nu{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,n,r;return U(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new Eb;const s=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((e=s.serverInfo)===null||e===void 0?void 0:e.edition)===Nl.Cloud&&(!((n=s.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=s.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class UQ extends vs.EventEmitter{constructor(e,n){super(),this.checkResults=new Map,this.url=e,this.token=n}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:ui.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==ui.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return U(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token),i=o=>{this.updateCheck(n,o)};r.on("update",i);const s=yield r.run();return r.off("update",i),s})}checkWebsocket(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(DW)})}checkWebRTC(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(xW)})}checkTURN(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(MW)})}checkReconnect(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(NW)})}checkPublishAudio(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(PW)})}checkPublishVideo(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(AW)})}}function LW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=t instanceof Ol?t.mediaStreamTrack:t,i=r.getSettings();let s={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const o=i.facingMode;F.debug("rawFacingMode",{rawFacingMode:o}),o&&typeof o=="string"&&UW(o)&&(s={facingMode:o,confidence:"high"})}if(["low","medium"].includes(s.confidence)){F.debug("Try to get facing mode from device label: (".concat(r.label,")"));const o=BW(r.label);o!==void 0&&(s=o)}return s}const yC=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),FW=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function BW(t){var e;const n=t.trim().toLowerCase();if(n!=="")return yC.has(n)?yC.get(n):(e=Array.from(FW.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||e===void 0?void 0:e[1]}function UW(t){return t===void 0||["user","environment","left","right"].includes(t)}const p0=Math.min,dl=Math.max,Ap=Math.round,la=t=>({x:t,y:t}),jW={left:"right",right:"left",bottom:"top",top:"bottom"},WW={start:"end",end:"start"};function SC(t,e,n){return dl(t,p0(e,n))}function Tm(t,e){return typeof t=="function"?t(e):t}function ec(t){return t.split("-")[0]}function _m(t){return t.split("-")[1]}function PA(t){return t==="x"?"y":"x"}function AA(t){return t==="y"?"height":"width"}function Im(t){return["top","bottom"].includes(ec(t))?"y":"x"}function NA(t){return PA(Im(t))}function VW(t,e,n){n===void 0&&(n=!1);const r=_m(t),i=NA(t),s=AA(i);let o=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=Np(o)),[o,Np(o)]}function zW(t){const e=Np(t);return[m0(t),e,m0(e)]}function m0(t){return t.replace(/start|end/g,e=>WW[e])}function $W(t,e,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?s:o;default:return[]}}function HW(t,e,n,r){const i=_m(t);let s=$W(ec(t),n==="start",r);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(m0)))),s}function Np(t){return t.replace(/left|right|bottom|top/g,e=>jW[e])}function GW(t){return{top:0,right:0,bottom:0,left:0,...t}}function qW(t){return typeof t!="number"?GW(t):{top:t,right:t,bottom:t,left:t}}function Mp(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function bC(t,e,n){let{reference:r,floating:i}=t;const s=Im(e),o=NA(e),a=AA(o),c=ec(e),l=s==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[a]/2-i[a]/2;let h;switch(c){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-i.width,y:d};break;default:h={x:r.x,y:r.y}}switch(_m(e)){case"start":h[o]-=f*(n&&l?-1:1);break;case"end":h[o]+=f*(n&&l?-1:1);break}return h}const JW=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let l=await o.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=bC(l,r,c),f=r,h={},p=0;for(let g=0;g<a.length;g++){const{name:y,fn:m}=a[g],{x:v,y:w,data:_,reset:C}=await m({x:u,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:h,rects:l,platform:o,elements:{reference:t,floating:e}});if(u=v??u,d=w??d,h={...h,[y]:{...h[y],..._}},C&&p<=50){p++,typeof C=="object"&&(C.placement&&(f=C.placement),C.rects&&(l=C.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:i}):C.rects),{x:u,y:d}=bC(l,f,c)),g=-1;continue}}return{x:u,y:d,placement:f,strategy:i,middlewareData:h}};async function MA(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=Tm(e,t),p=qW(h),y=a[f?d==="floating"?"reference":"floating":d],m=Mp(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(y)))==null||n?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),v=d==="floating"?{...o.floating,x:r,y:i}:o.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),_=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},C=Mp(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:v,offsetParent:w,strategy:c}):v);return{top:(m.top-C.top+p.top)/_.y,bottom:(C.bottom-m.bottom+p.bottom)/_.y,left:(m.left-C.left+p.left)/_.x,right:(C.right-m.right+p.right)/_.x}}const ZW=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...y}=Tm(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const m=ec(i),v=ec(a)===a,w=await(c.isRTL==null?void 0:c.isRTL(l.floating)),_=f||(v||!g?[Np(a)]:zW(a));!f&&p!=="none"&&_.push(...HW(a,g,p,w));const C=[a,..._],k=await MA(e,y),T=[];let R=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&T.push(k[m]),d){const D=VW(i,o,w);T.push(k[D[0]],k[D[1]])}if(R=[...R,{placement:i,overflows:T}],!T.every(D=>D<=0)){var A,M;const D=(((A=s.flip)==null?void 0:A.index)||0)+1,j=C[D];if(j)return{data:{index:D,overflows:R},reset:{placement:j}};let V=(M=R.filter(J=>J.overflows[0]<=0).sort((J,G)=>J.overflows[1]-G.overflows[1])[0])==null?void 0:M.placement;if(!V)switch(h){case"bestFit":{var O;const J=(O=R.map(G=>[G.placement,G.overflows.filter(te=>te>0).reduce((te,z)=>te+z,0)]).sort((G,te)=>G[1]-te[1])[0])==null?void 0:O[0];J&&(V=J);break}case"initialPlacement":V=a;break}if(i!==V)return{reset:{placement:V}}}return{}}}};async function KW(t,e){const{placement:n,platform:r,elements:i}=t,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=ec(n),a=_m(n),c=Im(n)==="y",l=["left","top"].includes(o)?-1:1,u=s&&c?-1:1,d=Tm(e,t);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),c?{x:h*u,y:f*l}:{x:f*l,y:h*u}}const YW=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:s,placement:o,middlewareData:a}=e,c=await KW(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+c.x,y:s+c.y,data:{...c,placement:o}}}}},XW=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:y=>{let{x:m,y:v}=y;return{x:m,y:v}}},...c}=Tm(t,e),l={x:n,y:r},u=await MA(e,c),d=Im(ec(i)),f=PA(d);let h=l[f],p=l[d];if(s){const y=f==="y"?"top":"left",m=f==="y"?"bottom":"right",v=h+u[y],w=h-u[m];h=SC(v,h,w)}if(o){const y=d==="y"?"top":"left",m=d==="y"?"bottom":"right",v=p+u[y],w=p-u[m];p=SC(v,p,w)}const g=a.fn({...e,[f]:h,[d]:p});return{...g,data:{x:g.x-n,y:g.y-r}}}}};function ua(t){return xA(t)?(t.nodeName||"").toLowerCase():"#document"}function Rr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function ba(t){var e;return(e=(xA(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function xA(t){return t instanceof Node||t instanceof Rr(t).Node}function co(t){return t instanceof Element||t instanceof Rr(t).Element}function fs(t){return t instanceof HTMLElement||t instanceof Rr(t).HTMLElement}function wC(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Rr(t).ShadowRoot}function pf(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=qr(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function QW(t){return["table","td","th"].includes(ua(t))}function Ib(t){const e=Rb(),n=qr(t);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function eV(t){let e=Dl(t);for(;fs(e)&&!Rm(e);){if(Ib(e))return e;e=Dl(e)}return null}function Rb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Rm(t){return["html","body","#document"].includes(ua(t))}function qr(t){return Rr(t).getComputedStyle(t)}function Pm(t){return co(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Dl(t){if(ua(t)==="html")return t;const e=t.assignedSlot||t.parentNode||wC(t)&&t.host||ba(t);return wC(e)?e.host:e}function OA(t){const e=Dl(t);return Rm(e)?t.ownerDocument?t.ownerDocument.body:t.body:fs(e)&&pf(e)?e:OA(e)}function g0(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=OA(t),s=i===((r=t.ownerDocument)==null?void 0:r.body),o=Rr(i);return s?e.concat(o,o.visualViewport||[],pf(i)?i:[],o.frameElement&&n?g0(o.frameElement):[]):e.concat(i,g0(i,[],n))}function DA(t){const e=qr(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=fs(t),s=i?t.offsetWidth:n,o=i?t.offsetHeight:r,a=Ap(n)!==s||Ap(r)!==o;return a&&(n=s,r=o),{width:n,height:r,$:a}}function LA(t){return co(t)?t:t.contextElement}function fl(t){const e=LA(t);if(!fs(e))return la(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:s}=DA(e);let o=(s?Ap(n.width):n.width)/r,a=(s?Ap(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const tV=la(0);function FA(t){const e=Rr(t);return!Rb()||!e.visualViewport?tV:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function nV(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Rr(t)?!1:e}function Fd(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),s=LA(t);let o=la(1);e&&(r?co(r)&&(o=fl(r)):o=fl(t));const a=nV(s,n,r)?FA(s):la(0);let c=(i.left+a.x)/o.x,l=(i.top+a.y)/o.y,u=i.width/o.x,d=i.height/o.y;if(s){const f=Rr(s),h=r&&co(r)?Rr(r):r;let p=f.frameElement;for(;p&&r&&h!==f;){const g=fl(p),y=p.getBoundingClientRect(),m=qr(p),v=y.left+(p.clientLeft+parseFloat(m.paddingLeft))*g.x,w=y.top+(p.clientTop+parseFloat(m.paddingTop))*g.y;c*=g.x,l*=g.y,u*=g.x,d*=g.y,c+=v,l+=w,p=Rr(p).frameElement}}return Mp({width:u,height:d,x:c,y:l})}function rV(t){let{rect:e,offsetParent:n,strategy:r}=t;const i=fs(n),s=ba(n);if(n===s)return e;let o={scrollLeft:0,scrollTop:0},a=la(1);const c=la(0);if((i||!i&&r!=="fixed")&&((ua(n)!=="body"||pf(s))&&(o=Pm(n)),fs(n))){const l=Fd(n);a=fl(n),c.x=l.x+n.clientLeft,c.y=l.y+n.clientTop}return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-o.scrollLeft*a.x+c.x,y:e.y*a.y-o.scrollTop*a.y+c.y}}function iV(t){return Array.from(t.getClientRects())}function BA(t){return Fd(ba(t)).left+Pm(t).scrollLeft}function sV(t){const e=ba(t),n=Pm(t),r=t.ownerDocument.body,i=dl(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=dl(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+BA(t);const a=-n.scrollTop;return qr(r).direction==="rtl"&&(o+=dl(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:a}}function oV(t,e){const n=Rr(t),r=ba(t),i=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,c=0;if(i){s=i.width,o=i.height;const l=Rb();(!l||l&&e==="fixed")&&(a=i.offsetLeft,c=i.offsetTop)}return{width:s,height:o,x:a,y:c}}function aV(t,e){const n=Fd(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,s=fs(t)?fl(t):la(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,c=i*s.x,l=r*s.y;return{width:o,height:a,x:c,y:l}}function kC(t,e,n){let r;if(e==="viewport")r=oV(t,n);else if(e==="document")r=sV(ba(t));else if(co(e))r=aV(e,n);else{const i=FA(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return Mp(r)}function UA(t,e){const n=Dl(t);return n===e||!co(n)||Rm(n)?!1:qr(n).position==="fixed"||UA(n,e)}function cV(t,e){const n=e.get(t);if(n)return n;let r=g0(t,[],!1).filter(a=>co(a)&&ua(a)!=="body"),i=null;const s=qr(t).position==="fixed";let o=s?Dl(t):t;for(;co(o)&&!Rm(o);){const a=qr(o),c=Ib(o);!c&&a.position==="fixed"&&(i=null),(s?!c&&!i:!c&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||pf(o)&&!c&&UA(t,o))?r=r.filter(u=>u!==o):i=a,o=Dl(o)}return e.set(t,r),r}function lV(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const o=[...n==="clippingAncestors"?cV(e,this._c):[].concat(n),r],a=o[0],c=o.reduce((l,u)=>{const d=kC(e,u,i);return l.top=dl(d.top,l.top),l.right=p0(d.right,l.right),l.bottom=p0(d.bottom,l.bottom),l.left=dl(d.left,l.left),l},kC(e,a,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function uV(t){return DA(t)}function dV(t,e,n){const r=fs(e),i=ba(e),s=n==="fixed",o=Fd(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const c=la(0);if(r||!r&&!s)if((ua(e)!=="body"||pf(i))&&(a=Pm(e)),r){const l=Fd(e,!0,s,e);c.x=l.x+e.clientLeft,c.y=l.y+e.clientTop}else i&&(c.x=BA(i));return{x:o.left+a.scrollLeft-c.x,y:o.top+a.scrollTop-c.y,width:o.width,height:o.height}}function EC(t,e){return!fs(t)||qr(t).position==="fixed"?null:e?e(t):t.offsetParent}function jA(t,e){const n=Rr(t);if(!fs(t))return n;let r=EC(t,e);for(;r&&QW(r)&&qr(r).position==="static";)r=EC(r,e);return r&&(ua(r)==="html"||ua(r)==="body"&&qr(r).position==="static"&&!Ib(r))?n:r||eV(t)||n}const fV=async function(t){let{reference:e,floating:n,strategy:r}=t;const i=this.getOffsetParent||jA,s=this.getDimensions;return{reference:dV(e,await i(n),r),floating:{x:0,y:0,...await s(n)}}};function hV(t){return qr(t).direction==="rtl"}const pV={convertOffsetParentRelativeRectToViewportRelativeRect:rV,getDocumentElement:ba,getClippingRect:lV,getOffsetParent:jA,getElementRects:fV,getClientRects:iV,getDimensions:uV,getScale:fl,isElement:co,isRTL:hV},mV=(t,e,n)=>{const r=new Map,i={platform:pV,...n},s={...i.platform,_c:r};return JW(t,e,{...i,platform:s})};var WA={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(Vx,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function s(g,y){var m=g[y];if(typeof m.bind=="function")return m.bind(g);try{return Function.prototype.bind.call(m,g)}catch{return function(){return Function.prototype.apply.apply(m,[g,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(g){return g==="debug"&&(g="log"),typeof console===n?!1:g==="trace"&&r?o:console[g]!==void 0?s(console,g):console.log!==void 0?s(console,"log"):e}function c(g,y){for(var m=0;m<i.length;m++){var v=i[m];this[v]=m<g?e:this.methodFactory(v,g,y)}this.log=this.debug}function l(g,y,m){return function(){typeof console!==n&&(c.call(this,y,m),this[g].apply(this,arguments))}}function u(g,y,m){return a(g)||l.apply(this,arguments)}function d(g,y,m){var v=this,w;y=y??"WARN";var _="loglevel";typeof g=="string"?_+=":"+g:typeof g=="symbol"&&(_=void 0);function C(A){var M=(i[A]||"silent").toUpperCase();if(!(typeof window===n||!_)){try{window.localStorage[_]=M;return}catch{}try{window.document.cookie=encodeURIComponent(_)+"="+M+";"}catch{}}}function k(){var A;if(!(typeof window===n||!_)){try{A=window.localStorage[_]}catch{}if(typeof A===n)try{var M=window.document.cookie,O=M.indexOf(encodeURIComponent(_)+"=");O!==-1&&(A=/^([^;]+)/.exec(M.slice(O))[1])}catch{}return v.levels[A]===void 0&&(A=void 0),A}}function T(){if(!(typeof window===n||!_)){try{window.localStorage.removeItem(_);return}catch{}try{window.document.cookie=encodeURIComponent(_)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}v.name=g,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=m||u,v.getLevel=function(){return w},v.setLevel=function(A,M){if(typeof A=="string"&&v.levels[A.toUpperCase()]!==void 0&&(A=v.levels[A.toUpperCase()]),typeof A=="number"&&A>=0&&A<=v.levels.SILENT){if(w=A,M!==!1&&C(A),c.call(v,A,g),typeof console===n&&A<v.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+A},v.setDefaultLevel=function(A){y=A,k()||v.setLevel(A,!1)},v.resetLevel=function(){v.setLevel(y,!1),T()},v.enableAll=function(A){v.setLevel(v.levels.TRACE,A)},v.disableAll=function(A){v.setLevel(v.levels.SILENT,A)};var R=k();R==null&&(R=y),v.setLevel(R,!1)}var f=new d,h={};f.getLogger=function(y){if(typeof y!="symbol"&&typeof y!="string"||y==="")throw new TypeError("You must supply a name when creating a logger.");var m=h[y];return m||(m=h[y]=new d(y,f.getLevel(),f.methodFactory)),m};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(WA);var gV=WA.exports;const vV=Yd(gV);function on(t){return typeof t=="function"}function VA(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var iv=VA(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function v0(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Am=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Al(o),c=a.next();!c.done;c=a.next()){var l=c.value;l.remove(this)}}catch(g){e={error:g}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(on(u))try{u()}catch(g){s=g instanceof iv?g.errors:[g]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=Al(d),h=f.next();!h.done;h=f.next()){var p=h.value;try{CC(p)}catch(g){s=s??[],g instanceof iv?s=wp(wp([],bp(s)),bp(g.errors)):s.push(g)}}}catch(g){r={error:g}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(s)throw new iv(s)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)CC(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&v0(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&v0(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),zA=Am.EMPTY;function $A(t){return t instanceof Am||t&&"closed"in t&&on(t.remove)&&on(t.add)&&on(t.unsubscribe)}function CC(t){on(t)?t():t.unsubscribe()}var HA={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},y0={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=y0.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,wp([t,e],bp(n))):setTimeout.apply(void 0,wp([t,e],bp(n)))},clearTimeout:function(t){var e=y0.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function GA(t){y0.setTimeout(function(){throw t})}function S0(){}function Dh(t){t()}var Pb=function(t){Ql(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,$A(n)&&n.add(r)):r.destination=wV,r}return e.create=function(n,r,i){return new b0(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Am),yV=Function.prototype.bind;function sv(t,e){return yV.call(t,e)}var SV=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){Zf(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){Zf(r)}else Zf(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){Zf(n)}},t}(),b0=function(t){Ql(e,t);function e(n,r,i){var s=t.call(this)||this,o;if(on(n)||!n)o={next:n??void 0,error:r??void 0,complete:i??void 0};else{var a;s&&HA.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return s.unsubscribe()},o={next:n.next&&sv(n.next,a),error:n.error&&sv(n.error,a),complete:n.complete&&sv(n.complete,a)}):o=n}return s.destination=new SV(o),s}return e}(Pb);function Zf(t){GA(t)}function bV(t){throw t}var wV={closed:!0,next:S0,error:bV,complete:S0},Ab=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function qA(t){return t}function kV(t){return t.length===0?qA:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var Pn=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,s=CV(e)?e:new b0(e,n,r);return Dh(function(){var o=i,a=o.operator,c=o.source;s.add(a?a.call(s,c):c?i._subscribe(s):i._trySubscribe(s))}),s},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=TC(n),new n(function(i,s){var o=new b0({next:function(a){try{e(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});r.subscribe(o)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[Ab]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return kV(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=TC(e),new e(function(r,i){var s;n.subscribe(function(o){return s=o},function(o){return i(o)},function(){return r(s)})})},t.create=function(e){return new t(e)},t}();function TC(t){var e;return(e=t??HA.Promise)!==null&&e!==void 0?e:Promise}function EV(t){return t&&on(t.next)&&on(t.error)&&on(t.complete)}function CV(t){return t&&t instanceof Pb||EV(t)&&$A(t)}function TV(t){return on(t==null?void 0:t.lift)}function go(t){return function(e){if(TV(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function tc(t,e,n,r,i){return new _V(t,e,n,r,i)}var _V=function(t){Ql(e,t);function e(n,r,i,s,o,a){var c=t.call(this,n)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=r?function(l){try{r(l)}catch(u){n.error(u)}}:t.prototype._next,c._error=s?function(l){try{s(l)}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._error,c._complete=i?function(){try{i()}catch(l){n.error(l)}finally{this.unsubscribe()}}:t.prototype._complete,c}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(Pb),IV=VA(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),da=function(t){Ql(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new _C(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new IV},e.prototype.next=function(n){var r=this;Dh(function(){var i,s;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var o=Al(r.currentObservers),a=o.next();!a.done;a=o.next()){var c=a.value;c.next(n)}}catch(l){i={error:l}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;Dh(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;Dh(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,s=i.hasError,o=i.isStopped,a=i.observers;return s||o?zA:(this.currentObservers=null,a.push(n),new Am(function(){r.currentObservers=null,v0(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,s=r.thrownError,o=r.isStopped;i?n.error(s):o&&n.complete()},e.prototype.asObservable=function(){var n=new Pn;return n.source=this,n},e.create=function(n,r){return new _C(n,r)},e}(Pn),_C=function(t){Ql(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:zA},e}(da),JA=function(t){Ql(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,s=n._value;if(r)throw i;return this._throwIfClosed(),s},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(da);function RV(t){return t&&on(t.schedule)}function PV(t){return t[t.length-1]}function ZA(t){return RV(PV(t))?t.pop():void 0}var KA=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function YA(t){return on(t==null?void 0:t.then)}function XA(t){return on(t[Ab])}function QA(t){return Symbol.asyncIterator&&on(t==null?void 0:t[Symbol.asyncIterator])}function eN(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function AV(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var tN=AV();function nN(t){return on(t==null?void 0:t[tN])}function rN(t){return Z4(this,arguments,function(){var n,r,i,s;return xR(this,function(o){switch(o.label){case 0:n=t.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,rl(n.read())];case 3:return r=o.sent(),i=r.value,s=r.done,s?[4,rl(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,rl(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function iN(t){return on(t==null?void 0:t.getReader)}function ru(t){if(t instanceof Pn)return t;if(t!=null){if(XA(t))return NV(t);if(KA(t))return MV(t);if(YA(t))return xV(t);if(QA(t))return sN(t);if(nN(t))return OV(t);if(iN(t))return DV(t)}throw eN(t)}function NV(t){return new Pn(function(e){var n=t[Ab]();if(on(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function MV(t){return new Pn(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function xV(t){return new Pn(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,GA)})}function OV(t){return new Pn(function(e){var n,r;try{for(var i=Al(t),s=i.next();!s.done;s=i.next()){var o=s.value;if(e.next(o),e.closed)return}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function sN(t){return new Pn(function(e){LV(t,e).catch(function(n){return e.error(n)})})}function DV(t){return sN(rN(t))}function LV(t,e){var n,r,i,s;return J4(this,void 0,void 0,function(){var o,a;return xR(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=K4(t),c.label=1;case 1:return[4,n.next()];case 2:if(r=c.sent(),!!r.done)return[3,4];if(o=r.value,e.next(o),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function na(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function oN(t,e){return e===void 0&&(e=0),go(function(n,r){n.subscribe(tc(r,function(i){return na(r,t,function(){return r.next(i)},e)},function(){return na(r,t,function(){return r.complete()},e)},function(i){return na(r,t,function(){return r.error(i)},e)}))})}function aN(t,e){return e===void 0&&(e=0),go(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function FV(t,e){return ru(t).pipe(aN(e),oN(e))}function BV(t,e){return ru(t).pipe(aN(e),oN(e))}function UV(t,e){return new Pn(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function jV(t,e){return new Pn(function(n){var r;return na(n,e,function(){r=t[tN](),na(n,e,function(){var i,s,o;try{i=r.next(),s=i.value,o=i.done}catch(a){n.error(a);return}o?n.complete():n.next(s)},0,!0)}),function(){return on(r==null?void 0:r.return)&&r.return()}})}function cN(t,e){if(!t)throw new Error("Iterable cannot be null");return new Pn(function(n){na(n,e,function(){var r=t[Symbol.asyncIterator]();na(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function WV(t,e){return cN(rN(t),e)}function VV(t,e){if(t!=null){if(XA(t))return FV(t,e);if(KA(t))return UV(t,e);if(YA(t))return BV(t,e);if(QA(t))return cN(t,e);if(nN(t))return jV(t,e);if(iN(t))return WV(t,e)}throw eN(t)}function zV(t,e){return e?VV(t,e):ru(t)}function sr(t,e){return go(function(n,r){var i=0;n.subscribe(tc(r,function(s){r.next(t.call(e,s,i++))}))})}function $V(t,e,n,r,i,s,o,a){var c=[],l=0,u=0,d=!1,f=function(){d&&!c.length&&!l&&e.complete()},h=function(g){return l<r?p(g):c.push(g)},p=function(g){s&&e.next(g),l++;var y=!1;ru(n(g,u++)).subscribe(tc(e,function(m){i==null||i(m),s?h(m):e.next(m)},function(){y=!0},void 0,function(){if(y)try{l--;for(var m=function(){var v=c.shift();o?na(e,o,function(){return p(v)}):p(v)};c.length&&l<r;)m();f()}catch(v){e.error(v)}}))};return t.subscribe(tc(e,h,function(){d=!0,f()})),function(){a==null||a()}}function lN(t,e,n){return n===void 0&&(n=1/0),on(e)?lN(function(r,i){return sr(function(s,o){return e(r,s,i,o)})(ru(t(r,i)))},n):(typeof e=="number"&&(n=e),go(function(r,i){return $V(r,i,t,n)}))}function HV(t){return t===void 0&&(t=1/0),lN(qA,t)}function GV(){return HV(1)}function w0(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return GV()(zV(t,ZA(t)))}function uN(t,e){return go(function(n,r){var i=0;n.subscribe(tc(r,function(s){return t.call(e,s,i++)&&r.next(s)}))})}function qV(t,e,n,r,i){return function(s,o){var a=n,c=e,l=0;s.subscribe(tc(o,function(u){var d=l++;c=a?t(c,u,d):(a=!0,u),r&&o.next(c)},i&&function(){a&&o.next(c),o.complete()}))}}function JV(t){return go(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function ZV(t,e){return go(qV(t,e,arguments.length>=2,!0))}function Pi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=ZA(t);return go(function(r,i){(n?w0(t,r,n):w0(t,r)).subscribe(i)})}function IC(t){return go(function(e,n){ru(t).subscribe(tc(n,function(){return n.complete()},S0)),!n.closed&&e.subscribe(n)})}var KV=Object.defineProperty,YV=Object.defineProperties,XV=Object.getOwnPropertyDescriptors,xp=Object.getOwnPropertySymbols,dN=Object.prototype.hasOwnProperty,fN=Object.prototype.propertyIsEnumerable,RC=(t,e,n)=>e in t?KV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,k0=(t,e)=>{for(var n in e||(e={}))dN.call(e,n)&&RC(t,n,e[n]);if(xp)for(var n of xp(e))fN.call(e,n)&&RC(t,n,e[n]);return t},QV=(t,e)=>YV(t,XV(e)),e7=(t,e)=>{var n={};for(var r in t)dN.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&xp)for(var r of xp(t))e.indexOf(r)<0&&fN.call(t,r)&&(n[r]=t[r]);return n},vo=(t,e,n)=>new Promise((r,i)=>{var s=c=>{try{a(n.next(c))}catch(l){i(l)}},o=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((n=n.apply(t,e)).next())}),hN="lk";function Nb(t){return typeof t>"u"?!1:t7(t)||n7(t)}function t7(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function n7(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function r7(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function pN(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(r7(t))return`${t.participant.identity}_${t.source}_placeholder`;if(Nb(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function i7(t){return t instanceof h0}function s7(t,e){return vo(this,null,function*(){const{x:n,y:r}=yield mV(t,e,{placement:"top",middleware:[YW(6),ZW(),XW({padding:5})]});return{x:n,y:r}})}function o7(t,e){return!t.contains(e.target)}var a7=[ne.ConnectionStateChanged,ne.RoomMetadataChanged,ne.ActiveSpeakersChanged,ne.ConnectionQualityChanged,ne.ParticipantConnected,ne.ParticipantDisconnected,ne.ParticipantPermissionsChanged,ne.ParticipantMetadataChanged,ne.TrackMuted,ne.TrackUnmuted,ne.TrackPublished,ne.TrackUnpublished,ne.TrackStreamStateChanged,ne.TrackSubscriptionFailed,ne.TrackSubscriptionPermissionChanged,ne.TrackSubscriptionStatusChanged],c7=[...a7,ne.LocalTrackPublished,ne.LocalTrackUnpublished],l7=[oe.ConnectionQualityChanged,oe.IsSpeakingChanged,oe.ParticipantMetadataChanged,oe.ParticipantPermissionsChanged,oe.TrackMuted,oe.TrackUnmuted,oe.TrackPublished,oe.TrackUnpublished,oe.TrackStreamStateChanged,oe.TrackSubscriptionFailed,oe.TrackSubscriptionPermissionChanged,oe.TrackSubscriptionStatusChanged];[...l7,oe.LocalTrackPublished,oe.LocalTrackUnpublished];var Qe=vV.getLogger("lk-components-js");Qe.setDefaultLevel("WARN");function u7(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var d7=[],f7={showChat:!1,unreadMessages:0};function Mb(t,...e){return new Pn(r=>{const i=()=>{r.next(t)};return e.forEach(o=>{t.on(o,i)}),()=>{e.forEach(o=>{t.off(o,i)})}}).pipe(Pi(t))}function xb(t,e){return new Pn(r=>{const i=(...o)=>{r.next(o)};return t.on(e,i),()=>{t.off(e,i)}})}function h7(t){return xb(t,ne.ConnectionStateChanged).pipe(sr(([e])=>e),Pi(t.state))}function p7(t,e,n=!0){var r;const i=()=>vo(this,null,function*(){try{const a=yield Pp.getLocalDevices(t,n);s.next(a)}catch(a){e==null||e(a)}}),s=new da,o=s.pipe(JV(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return w0(Pp.getLocalDevices(t,n).catch(a=>e==null?void 0:e(a)),o)}function m7(t){return xb(t,ne.DataReceived)}function g7(t){return Mb(t,ne.AudioPlaybackStatusChanged).pipe(sr(n=>({canPlayAudio:n.canPlaybackAudio})))}function v7(t){return Mb(t,ne.VideoPlaybackStatusChanged).pipe(sr(n=>({canPlayVideo:n.canPlaybackVideo})))}function y7(t,e){return xb(t,ne.ActiveDeviceChanged).pipe(uN(([n])=>n===e),sr(([n,r])=>(Qe.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)),Pi(t.getActiveDevice(e)))}function Jr(t){return`${hN}-${t}`}function S7(t){const e=E0(t),n=Db(t.participant).pipe(sr(()=>E0(t)),Pi(e));return{className:Jr(t.source===Y.Source.Camera||t.source===Y.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function E0(t){if(Nb(t))return t.publication;{const{source:e,name:n,participant:r}=t;if(e&&n)return r.getTracks().find(i=>i.source===e&&i.trackName===n);if(n)return r.getTrackByName(n);if(e)return r.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function Ob(t,...e){return new Pn(r=>{const i=()=>{r.next(t)};return e.forEach(o=>{t.on(o,i)}),()=>{e.forEach(o=>{t.off(o,i)})}}).pipe(Pi(t))}function Db(t){return Ob(t,oe.TrackMuted,oe.TrackUnmuted,oe.ParticipantPermissionsChanged,oe.TrackPublished,oe.TrackUnpublished,oe.LocalTrackPublished,oe.LocalTrackUnpublished,oe.MediaDevicesError,oe.TrackSubscriptionStatusChanged).pipe(sr(n=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:s}=n,o=n.getTrack(Y.Source.Microphone),a=n.getTrack(Y.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:s,cameraTrack:a,microphoneTrack:o,participant:n}}))}function b7(t){return Ob(t,oe.ParticipantMetadataChanged).pipe(sr(({name:n,identity:r,metadata:i})=>({name:n,identity:r,metadata:i})),Pi({name:t.name,identity:t.identity,metadata:t.metadata}))}function w7(t){return Lb(t,oe.ConnectionQualityChanged).pipe(sr(([n])=>n),Pi(t.connectionQuality))}function Lb(t,e){return new Pn(r=>{const i=(...o)=>{r.next(o)};return t.on(e,i),()=>{t.off(e,i)}})}function mN(t){var e,n,r,i;return Ob(t.participant,oe.TrackMuted,oe.TrackUnmuted,oe.TrackSubscribed,oe.TrackUnsubscribed,oe.LocalTrackPublished,oe.LocalTrackUnpublished).pipe(sr(s=>{var o,a;const c=(o=t.publication)!=null?o:s.getTrack(t.source);return(a=c==null?void 0:c.isMuted)!=null?a:!0}),Pi((i=(r=(e=t.publication)==null?void 0:e.isMuted)!=null?r:(n=t.participant.getTrack(t.source))==null?void 0:n.isMuted)!=null?i:!0))}function k7(t){return Lb(t,oe.IsSpeakingChanged).pipe(sr(([e])=>e))}function E7(t,e={}){var n;let r;const i=new Pn(c=>(r=c,()=>a.unsubscribe())).pipe(Pi(Array.from(t.participants.values()))),s=(n=e.additionalRoomEvents)!=null?n:c7,o=Array.from(new Set([ne.ParticipantConnected,ne.ParticipantDisconnected,ne.ConnectionStateChanged,...s])),a=Mb(t,...o).subscribe(c=>r==null?void 0:r.next(Array.from(c.participants.values())));return t.participants.size>0&&(r==null||r.next(Array.from(t.participants.values()))),i}function C7(t){return Lb(t,oe.ParticipantPermissionsChanged).pipe(sr(()=>t.permissions),Pi(t.permissions))}function T7(t,e,n){const{localParticipant:r}=e,i=(l,u)=>{let d=!1;switch(l){case Y.Source.Camera:d=u.isCameraEnabled;break;case Y.Source.Microphone:d=u.isMicrophoneEnabled;break;case Y.Source.ScreenShare:d=u.isScreenShareEnabled;break}return d},s=Db(r).pipe(sr(l=>i(t,l.participant)),Pi(i(t,r))),o=new da,a=(l,u)=>vo(this,null,function*(){try{switch(u??(u=n),o.next(!0),t){case Y.Source.Camera:yield r.setCameraEnabled(l??!r.isCameraEnabled,u);break;case Y.Source.Microphone:yield r.setMicrophoneEnabled(l??!r.isMicrophoneEnabled,u);break;case Y.Source.ScreenShare:yield r.setScreenShareEnabled(l??!r.isScreenShareEnabled,u);break;default:break}}finally{o.next(!1)}});return{className:Jr("button"),toggle:a,enabledObserver:s,pendingObserver:o.asObservable()}}function _7(){let t=!1;const e=new da,n=new da,r=s=>{n.next(!0),t=s??!t,e.next(t),n.next(!1)};return{className:Jr("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function I7(t,e,n){const r=new JA(void 0),i=e?y7(e,t):r.asObservable(),s=(a,...c)=>vo(this,[a,...c],function*(l,u={}){var d,f,h;if(e){Qe.debug(`Switching active device of kind "${t}" with id ${l}.`),yield e.switchActiveDevice(t,l,u.exact);const p=(d=e.getActiveDevice(t))!=null?d:l;p!==l&&l!=="default"&&Qe.info(`We tried to select the device with id (${l}), but the browser decided to select the device with id (${p}) instead.`);let g;t==="audioinput"?g=(f=e.localParticipant.getTrack(Y.Source.Microphone))==null?void 0:f.track:t==="videoinput"&&(g=(h=e.localParticipant.getTrack(Y.Source.Camera))==null?void 0:h.track);const y=l==="default"&&!g||l==="default"&&(g==null?void 0:g.mediaStreamTrack.label.startsWith("Default"));r.next(y?l:p)}else if(n){yield n.setDeviceId(u.exact?{exact:l}:l);const p=yield n.getDeviceId();r.next(l==="default"&&n.mediaStreamTrack.label.startsWith("Default")?l:p)}else r.value!==l&&(Qe.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(l))});return{className:Jr("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:s}}function R7(t){const e=r=>{t.disconnect(r)};return{className:Jr("disconnect-button"),disconnect:e}}function P7(t){const e=Jr("connection-quality"),n=w7(t);return{className:e,connectionQualityObserver:n}}function A7(t){let e="track-muted-indicator-camera";switch(t.source){case Y.Source.Camera:e="track-muted-indicator-camera";break;case Y.Source.Microphone:e="track-muted-indicator-microphone";break}const n=Jr(e),r=mN(t);return{className:n,mediaMutedObserver:r}}function N7(t){return{className:"lk-participant-name",infoObserver:b7(t)}}function M7(){return{className:Jr("participant-tile")}}var x7={CHAT:"lk-chat-topic"};function gN(t,e,n){return vo(this,arguments,function*(r,i,s,o={}){const{kind:a,destination:c}=o;yield r.publishData(i,a??Xt.RELIABLE,{destination:c,topic:s})})}function O7(t,e,n){const r=m7(t).pipe(uN(([,,,a])=>e===void 0||a===e),sr(([a,c,,l])=>{const u={payload:a,topic:l,from:c};return n==null||n(u),u}));let i;const s=new Pn(a=>{i=a});return{messageObservable:r,isSendingObservable:s,send:(a,...c)=>vo(this,[a,...c],function*(l,u={}){i.next(!0);try{yield gN(t.localParticipant,l,e,u)}finally{i.next(!1)}})}}var D7=new TextEncoder,L7=new TextDecoder,Kf=new Map,F7=t=>D7.encode(JSON.stringify({message:t.message,timestamp:t.timestamp})),B7=t=>JSON.parse(L7.decode(t));function U7(t,e){var n,r;const i=new da,{messageDecoder:s,messageEncoder:o,channelTopic:a}=e??{},c=a??x7.CHAT;let l=!1;Kf.has(t)||(l=!0);const u=(n=Kf.get(t))!=null?n:new Map,d=(r=u.get(c))!=null?r:new da;if(u.set(c,d),Kf.set(t,u),l){const{messageObservable:v}=O7(t,c);v.pipe(IC(i)).subscribe(d)}const f=s??B7,h=d.pipe(sr(v=>{const w=f(v.payload);return QV(k0({},w),{from:v.from})}),ZV((v,w)=>[...v,w],[]),IC(i)),p=new JA(!1),g=o??F7,y=v=>vo(this,null,function*(){const w=Date.now(),_=g({message:v,timestamp:w});p.next(!0);try{yield gN(t.localParticipant,_,c,{kind:Xt.RELIABLE}),d.next({payload:_,topic:c,from:t.localParticipant})}finally{p.next(!1)}});function m(){i.next(),i.complete(),Kf.clear()}return t.once(ne.Disconnected,m),{messageObservable:h,isSendingObservable:p,send:y}}function j7(){const t=n=>vo(this,null,function*(){Qe.info("Start Audio for room: ",n),yield n.startAudio()});return{className:Jr("start-audio-button"),roomAudioPlaybackAllowedObservable:g7,handleStartAudioPlayback:t}}function W7(){const t=n=>vo(this,null,function*(){Qe.info("Start Video for room: ",n),yield n.startVideo()});return{className:Jr("start-audio-button"),roomVideoPlaybackAllowedObservable:v7,handleStartVideoPlayback:t}}function V7(){return{className:[Jr("button"),Jr("chat-toggle")].join(" ")}}function z7(){return{className:"lk-room-container"}}function $7(t,e){if(typeof localStorage>"u"){Qe.error("Local storage is not available.");return}try{localStorage.setItem(t,JSON.stringify(e))}catch(n){Qe.error(`Error setting item to local storage: ${n}`)}}function H7(t){if(typeof localStorage>"u"){Qe.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){Qe.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){Qe.error(`Error getting item from local storage: ${e}`);return}}function G7(t){return{load:()=>H7(t),save:e=>$7(t,e)}}var q7=`${hN}-user-choices`,Ca={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:J7,save:Z7}=G7(q7);function K7(t,e=!1){if(e===!0)return;const n=t,r=e7(n,["e2ee","sharedPassphrase"]);Z7(r)}function Y7(t,e=!1){var n,r,i,s,o,a,c;const l={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:Ca.videoEnabled,audioEnabled:(r=t==null?void 0:t.audioEnabled)!=null?r:Ca.audioEnabled,videoDeviceId:(i=t==null?void 0:t.videoDeviceId)!=null?i:Ca.videoDeviceId,audioDeviceId:(s=t==null?void 0:t.audioDeviceId)!=null?s:Ca.audioDeviceId,username:(o=t==null?void 0:t.username)!=null?o:Ca.username,e2ee:(a=t==null?void 0:t.e2ee)!=null?a:Ca.e2ee,sharedPassphrase:(c=t==null?void 0:t.sharedPassphrase)!=null?c:Ca.sharedPassphrase};if(e)return l;{const u=J7();return k0(k0({},l),u??{})}}function vN(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=vN(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function X7(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=vN(t))&&(r&&(r+=" "),r+=e);return r}var Q7=Object.defineProperty,ez=Object.defineProperties,tz=Object.getOwnPropertyDescriptors,Op=Object.getOwnPropertySymbols,yN=Object.prototype.hasOwnProperty,SN=Object.prototype.propertyIsEnumerable,PC=(t,e,n)=>e in t?Q7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_e=(t,e)=>{for(var n in e||(e={}))yN.call(e,n)&&PC(t,n,e[n]);if(Op)for(var n of Op(e))SN.call(e,n)&&PC(t,n,e[n]);return t},Bn=(t,e)=>ez(t,tz(e)),An=(t,e)=>{var n={};for(var r in t)yN.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Op)for(var r of Op(t))e.indexOf(r)<0&&SN.call(t,r)&&(n[r]=t[r]);return n},bN=(t,e,n)=>new Promise((r,i)=>{var s=c=>{try{a(n.next(c))}catch(l){i(l)}},o=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((n=n.apply(t,e)).next())});function Ar(t,e){const[n,r]=E.useState(e);return E.useEffect(()=>{if(typeof window>"u"||!t)return;const i=t.subscribe(r);return()=>i.unsubscribe()},[t]),n}function nz(t){const e=s=>typeof window<"u"?window.matchMedia(s).matches:!1,[n,r]=E.useState(e(t));function i(){r(e(t))}return E.useEffect(()=>{const s=window.matchMedia(t);return i(),s.addListener?s.addListener(i):s.addEventListener("change",i),()=>{s.removeListener?s.removeListener(i):s.removeEventListener("change",i)}},[t]),n}function rz(t,e){if(e.msg==="show_chat")return Bn(_e({},t),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return Bn(_e({},t),{showChat:!1});if(e.msg==="toggle_chat"){const n=Bn(_e({},t),{showChat:!t.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?Bn(_e({},t),{unreadMessages:e.count}):_e({},t)}function iz(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:_e({},t)}var Fb=E.createContext(void 0);function sz(){const t=E.useContext(Fb);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function oz(t){const[e,n]=E.useReducer(iz,d7),[r,i]=E.useReducer(rz,f7);return t??{pin:{dispatch:n,state:e},widget:{dispatch:i,state:r}}}function wN(){return E.useContext(Fb)}var az=E.createContext(void 0);function mf(){return E.useContext(az)}var Bb=E.createContext(void 0);function Nm(){return E.useContext(Bb)}function dc(t){var e;const n=Nm(),r=mf(),i=(e=t??n)!=null?e:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var Ub=E.createContext(void 0);function Mm(){const t=E.useContext(Ub);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function xm(){return E.useContext(Ub)}function gf(t){const e=xm(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var cz=E.createContext(void 0);function lz(...t){return(...e)=>{for(const n of t)typeof n=="function"&&n(...e)}}function wa(...t){const e=_e({},t[0]);for(let n=1;n<t.length;n++){const r=t[n];for(const i in r){const s=e[i],o=r[i];typeof s=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=lz(s,o):(i==="className"||i==="UNSAFE_className")&&typeof s=="string"&&typeof o=="string"?e[i]=X7(s,o):e[i]=o!==void 0?o:s}}return e}function uz(t={}){const e=dc(t.participant),{className:n,connectionQualityObserver:r}=E.useMemo(()=>P7(e),[e]),i=Ar(r,Ur.Unknown);return{className:n,quality:i}}function dz(t){const e=gf(t),n=E.useMemo(()=>h7(e),[e]);return Ar(n,e.state)}function fz(t){const e=Mm(),n=dz(e);return{buttonProps:E.useMemo(()=>{const{className:i,disconnect:s}=R7(e);return wa(t,{className:i,onClick:()=>{var a;return s((a=t.stopTracks)!=null?a:!0)},disabled:n===Ze.Disconnected})},[e,t,n])}}function hz(t){if(t.publication instanceof Dd){const e=t.publication.track;if(e){const{facingMode:n}=LW(e);return n}}return"undefined"}function AC(t,e={}){var n,r;const i=typeof t=="string"?e.participant:t.participant,s=dc(i),o=typeof t=="string"?{participant:s,source:t}:t,[a,c]=E.useState(!!((n=o.publication)!=null&&n.isMuted||(r=s.getTrack(o.source))!=null&&r.isMuted));return E.useEffect(()=>{const l=mN(o).subscribe(c);return()=>l.unsubscribe()},[pN(o)]),a}function pz(t){const e=dc(t),n=E.useMemo(()=>k7(e),[e]);return Ar(n,e.isSpeaking)}var mz={connect:!0,audio:!1,video:!1};function gz(t){const e=_e(_e({},mz),t),{token:n,serverUrl:r,options:i,room:s,connectOptions:o,connect:a,audio:c,video:l,screen:u,onConnected:d,onDisconnected:f,onError:h,onMediaDeviceFailure:p,onEncryptionError:g,simulateParticipants:y}=e,m=An(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&s&&Qe.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[v,w]=E.useState();E.useEffect(()=>{w(s??new Pp(i))},[s]);const _=E.useMemo(()=>{const{className:C}=z7();return wa(m,{className:C})},[m]);return E.useEffect(()=>{if(!v)return;const C=()=>{const R=v.localParticipant;Qe.debug("trying to publish local tracks"),Promise.all([R.setMicrophoneEnabled(!!c,typeof c!="boolean"?c:void 0),R.setCameraEnabled(!!l,typeof l!="boolean"?l:void 0),R.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(A=>{Qe.warn(A),h==null||h(A)})},k=R=>{const A=xd.getFailure(R);p==null||p(A)},T=R=>{g==null||g(R)};return v.on(ne.SignalConnected,C).on(ne.MediaDevicesError,k).on(ne.EncryptionError,T),()=>{v.off(ne.SignalConnected,C).off(ne.MediaDevicesError,k).off(ne.EncryptionError,T)}},[v,c,l,u,h,g,p]),E.useEffect(()=>{if(v){if(y){v.simulateParticipants({participants:{count:y},publish:{audio:!0,useRealTracks:!0}});return}if(!n){Qe.debug("no token yet");return}if(!r){Qe.warn("no livekit url provided"),h==null||h(Error("no livekit url provided"));return}a?(Qe.debug("connecting"),v.connect(r,n,o).catch(C=>{Qe.warn(C),h==null||h(C)})):(Qe.debug("disconnecting because connect is false"),v.disconnect())}},[a,n,JSON.stringify(o),v,h,r,y]),E.useEffect(()=>{if(!v)return;const C=k=>{switch(k){case Ze.Disconnected:f&&f();break;case Ze.Connected:d&&d();break}};return v.on(ne.ConnectionStateChanged,C),()=>{v.off(ne.ConnectionStateChanged,C)}},[n,d,f,v]),E.useEffect(()=>{if(v)return()=>{Qe.info("disconnecting on onmount"),v.disconnect()}},[v]),{room:v,htmlProps:_}}function vz(t={}){const e=gf(t.room),[n,r]=E.useState(e.localParticipant),[i,s]=E.useState(n.isMicrophoneEnabled),[o,a]=E.useState(n.isMicrophoneEnabled),[c,l]=E.useState(n.lastMicrophoneError),[u,d]=E.useState(n.lastCameraError),[f,h]=E.useState(n.isMicrophoneEnabled),[p,g]=E.useState(void 0),[y,m]=E.useState(void 0),v=w=>{a(w.isCameraEnabled),s(w.isMicrophoneEnabled),h(w.isScreenShareEnabled),m(w.cameraTrack),g(w.microphoneTrack),l(w.participant.lastMicrophoneError),d(w.participant.lastCameraError),r(w.participant)};return E.useEffect(()=>{const w=Db(n).subscribe(v);return()=>w.unsubscribe()},[n]),{isMicrophoneEnabled:i,isScreenShareEnabled:f,isCameraEnabled:o,microphoneTrack:p,cameraTrack:y,lastMicrophoneError:c,lastCameraError:u,localParticipant:n}}function yz(){const t=Mm(),e=E.useMemo(()=>C7(t.localParticipant),[t]);return Ar(e,t.localParticipant.permissions)}function Sz({kind:t,room:e,track:n,requestPermissions:r,onError:i}){const s=xm(),o=E.useMemo(()=>p7(t,i,r),[t,r,i]),a=Ar(o,[]),[c,l]=E.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:f}=E.useMemo(()=>I7(t,e??s,n),[t,e,s,n]);return E.useEffect(()=>{const h=d.subscribe(p=>{Qe.info("setCurrentDeviceId",p),p&&l(p)});return()=>{h==null||h.unsubscribe()}},[d]),{devices:a,className:u,activeDeviceId:c,setActiveMediaDevice:f}}function bz(t){return t!==void 0}function iu(...t){return wa(...t.filter(bz))}function kN(t,e,n){return E.Children.map(t,r=>E.isValidElement(r)&&E.Children.only(t)?E.cloneElement(r,Bn(_e({},e),{key:n})):r)}function EN(t,e={}){var n;const[r,i]=E.useState(E0(t)),[s,o]=E.useState(r==null?void 0:r.isMuted),[a,c]=E.useState(r==null?void 0:r.isSubscribed),[l,u]=E.useState(r==null?void 0:r.track),[d,f]=E.useState("landscape"),h=E.useRef(),{className:p,trackObserver:g}=E.useMemo(()=>S7(t),[(n=t.participant.sid)!=null?n:t.participant.identity,t.source,Nb(t)&&t.publication.trackSid]);return E.useEffect(()=>{const y=g.subscribe(m=>{Qe.debug("update track",m),i(m),o(m==null?void 0:m.isMuted),c(m==null?void 0:m.isSubscribed),u(m==null?void 0:m.track)});return()=>y==null?void 0:y.unsubscribe()},[g]),E.useEffect(()=>{var y,m;return l&&(h.current&&l.detach(h.current),(y=e.element)!=null&&y.current&&!(i7(t.participant)&&(l==null?void 0:l.kind)==="audio")&&l.attach(e.element.current)),h.current=(m=e.element)==null?void 0:m.current,()=>{h.current&&(l==null||l.detach(h.current))}},[l,e.element]),E.useEffect(()=>{var y,m;if(typeof((y=r==null?void 0:r.dimensions)==null?void 0:y.width)=="number"&&typeof((m=r==null?void 0:r.dimensions)==null?void 0:m.height)=="number"){const v=r.dimensions.width>r.dimensions.height?"landscape":"portrait";f(v)}},[r]),{publication:r,isMuted:s,isSubscribed:a,track:l,elementProps:iu(e.props,_e({className:p,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":d}))}}function wz({trackRef:t,participant:e,source:n,publication:r,onParticipantClick:i,disableSpeakingIndicator:s,htmlProps:o}){const a=mf(),c=dc(e),l=E.useMemo(()=>{var g,y,m,v,w,_;const C=(y=(g=t==null?void 0:t.source)!=null?g:a==null?void 0:a.source)!=null?y:n;if(C===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(v=(m=t==null?void 0:t.participant)!=null?m:a==null?void 0:a.participant)!=null?v:c,publication:(_=(w=t==null?void 0:t.publication)!=null?w:a==null?void 0:a.publication)!=null?_:r,source:C}},[t==null?void 0:t.participant,t==null?void 0:t.source,t==null?void 0:t.publication,a==null?void 0:a.participant,a==null?void 0:a.source,a==null?void 0:a.publication,c,n,r]),u=E.useMemo(()=>{const{className:g}=M7();return wa(o,{className:g,onClick:y=>{var m,v;if((m=o.onClick)==null||m.call(o,y),typeof i=="function"){const w=(v=l.publication)!=null?v:l.participant.getTrack(l.source);i({participant:l.participant,track:w})}}})},[o,i,l.publication,l.source,l.participant]),d=AC(Y.Source.Camera,{participant:l.participant}),f=AC(Y.Source.Microphone,{participant:l.participant}),h=pz(l.participant),p=hz(l);return{elementProps:_e({"data-lk-audio-muted":f,"data-lk-video-muted":d,"data-lk-speaking":s===!0?!1:h,"data-lk-local-participant":l.participant.isLocal,"data-lk-source":l.source,"data-lk-facing-mode":p},u)}}function kz(t={}){const e=gf(t.room),[n,r]=E.useState([]);return E.useEffect(()=>{const i=E7(e,{additionalRoomEvents:t.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[e,JSON.stringify(t.updateOnlyOn)]),n}function Ez(t={}){const e=kz(t),{localParticipant:n}=vz(t);return[n,...e]}function Cz({room:t,props:e}){const n=gf(t),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:s}=E.useMemo(()=>j7(),[]),o=E.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=Ar(o,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:E.useMemo(()=>wa(e,{className:r,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[e,r,a,s,n]),canPlayAudio:a}}function Tz({room:t,props:e}){const n=gf(t),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:s}=E.useMemo(()=>W7(),[]),o=E.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=Ar(o,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:E.useMemo(()=>wa(e,{className:r,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[e,r,a,s,n]),canPlayVideo:a}}function _z({props:t}){const{dispatch:e,state:n}=sz().widget,{className:r}=E.useMemo(()=>V7(),[]);return{mergedProps:E.useMemo(()=>wa(t,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,r,e,n])}}function Iz(t,e={}){var n,r,i,s;let o=mf();const a=(r=(n=Nm())!=null?n:e.participant)!=null?r:o==null?void 0:o.participant;if(typeof t=="string"){if(!a)throw Error("Participant missing, either provide it via context or pass it in directly");o={participant:a,source:t}}else if(t)o=t;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:c,mediaMutedObserver:l}=E.useMemo(()=>A7(o),[pN(o)]);return{isMuted:Ar(l,!!((i=o.publication)!=null&&i.isMuted||(s=o.participant.getTrack(o.source))!=null&&s.isMuted)),className:c}}function Rz(t){var e=t,{source:n,onChange:r,initialState:i,captureOptions:s}=e,o=An(e,["source","onChange","initialState","captureOptions"]),a;const c=xm(),l=(a=c==null?void 0:c.localParticipant)==null?void 0:a.getTrack(n),{toggle:u,className:d,pendingObserver:f,enabledObserver:h}=E.useMemo(()=>c?T7(n,c,s):_7(),[c,n,JSON.stringify(s)]),p=Ar(f,!1),g=Ar(h,i??!!(l!=null&&l.isEnabled));E.useEffect(()=>{r==null||r(g)},[g,r]),E.useEffect(()=>{i!==void 0&&(Qe.debug("forcing initial toggle state",n,i),u(i))},[]);const y=E.useMemo(()=>wa(o,{className:d}),[o,d]),m=E.useCallback(v=>{var w;u(),(w=o.onClick)==null||w.call(o,v)},[o,u]);return{toggle:u,enabled:g,pending:p,track:l,buttonProps:Bn(_e({},y),{"aria-pressed":g,"data-lk-source":n,"data-lk-enabled":g,disabled:p,onClick:m})}}function Pz(t,e={}){return EN(t,e)}function Az(t){const e=Mm(),[n,r]=E.useState(),i=Ar(n==null?void 0:n.isSendingObservable,!1),s=Ar(n==null?void 0:n.messageObservable,[]);return E.useEffect(()=>{const o=U7(e,t);r(o)},[e,t]),{send:n==null?void 0:n.send,chatMessages:s,isSending:i}}function Nz(t={}){var e;const[n,r]=E.useState(Y7(t.defaults,(e=t.preventLoad)!=null?e:!1)),i=E.useCallback(l=>{r(u=>Bn(_e({},u),{audioEnabled:l}))},[]),s=E.useCallback(l=>{r(u=>Bn(_e({},u),{videoEnabled:l}))},[]),o=E.useCallback(l=>{r(u=>Bn(_e({},u),{audioDeviceId:l}))},[]),a=E.useCallback(l=>{r(u=>Bn(_e({},u),{videoDeviceId:l}))},[]),c=E.useCallback(l=>{r(u=>Bn(_e({},u),{username:l}))},[]);return E.useEffect(()=>{var l;K7(n,(l=t.preventSave)!=null?l:!1)},[n,t.preventSave]),{userChoices:n,saveAudioInputEnabled:i,saveVideoInputEnabled:s,saveAudioInputDeviceId:o,saveVideoInputDeviceId:a,saveUsername:c}}function Mz(t){const{mergedProps:e}=_z({props:t});return E.createElement("button",_e({},e),t.children)}function xz(t){const{buttonProps:e}=fz(t);return E.createElement("button",_e({},e),t.children)}var Oz=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),E.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),E.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),Dz=Oz,Lz=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),E.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),Fz=Lz,Bz=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),Uz=Bz,jz=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),Wz=jz,Vz=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),E.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),E.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),zz=Vz,$z=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),E.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),E.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),Hz=$z,Gz=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),qz=Gz,Jz=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("g",{opacity:.25},E.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),Zz=Jz,Kz=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("g",{opacity:.25},E.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),E.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),Yz=Kz,Xz=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),E.createElement("g",{opacity:.25},E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),E.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),Qz=Xz,e$=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),E.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),t$=e$,n$=t=>E.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),E.createElement("g",{fill:"currentColor"},E.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),E.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),r$=n$;function ov(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:s,onDeviceSelectError:o,exactMatch:a,track:c,requestPermissions:l,onError:u}=e,d=An(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const f=xm(),h=E.useCallback(C=>{f&&f.emit(ne.MediaDevicesError,C),u==null||u(C)},[f,u]),{devices:p,activeDeviceId:g,setActiveMediaDevice:y,className:m}=Sz({kind:n,room:f,track:c,requestPermissions:l,onError:h});E.useEffect(()=>{r!==void 0&&y(r)},[y]),E.useEffect(()=>{typeof s=="function"&&s(p)},[s,p]),E.useEffect(()=>{g&&g!==""&&(i==null||i(g))},[g]);const v=C=>bN(this,null,function*(){try{yield y(C,{exact:a})}catch(k){if(k instanceof Error)o==null||o(k);else throw k}}),w=E.useMemo(()=>iu(d,{className:m},{className:"lk-list"}),[m,d]);function _(C,k,T){return C===k||T===0&&k==="default"}return E.createElement("ul",_e({},w),p.map((C,k)=>E.createElement("li",{key:C.deviceId,id:C.deviceId,"data-lk-active":_(C.deviceId,g,k),"aria-selected":_(C.deviceId,g,k),role:"option"},E.createElement("button",{className:"lk-button",onClick:()=>v(C.deviceId)},C.label))))}function CN(t,e){switch(t){case Y.Source.Microphone:return e?E.createElement(Hz,null):E.createElement(zz,null);case Y.Source.Camera:return e?E.createElement(Fz,null):E.createElement(Dz,null);case Y.Source.ScreenShare:return e?E.createElement(r$,null):E.createElement(t$,null);default:return}}function i$(t){switch(t){case Ur.Excellent:return E.createElement(qz,null);case Ur.Good:return E.createElement(Zz,null);case Ur.Poor:return E.createElement(Yz,null);default:return E.createElement(Qz,null)}}function av(t){var e=t,{showIcon:n}=e,r=An(e,["showIcon"]);const{buttonProps:i,enabled:s}=Rz(r);return E.createElement("button",_e({},i),(n??!0)&&CN(r.source,s),r.children)}function s$(t){var e;const{className:n,quality:r}=uz(t),i=E.useMemo(()=>Bn(_e({},iu(t,{className:n})),{"data-lk-quality":r}),[r,t,n]);return E.createElement("div",_e({},i),(e=t.children)!=null?e:i$(r))}function o$(t){var e=t,{participant:n}=e,r=An(e,["participant"]);const i=dc(n),{className:s,infoObserver:o}=E.useMemo(()=>N7(i),[i]),{identity:a,name:c}=Ar(o,{name:i.name,identity:i.identity,metadata:i.metadata}),l=E.useMemo(()=>iu(r,{className:s,"data-lk-participant-name":c}),[r,s,c]);return E.createElement("span",_e({},l),c!==""?c:a,r.children)}function a$(t){var e=t,{source:n,participant:r,trackRef:i,show:s="always"}=e,o=An(e,["source","participant","trackRef","show"]),a,c;const{className:l,isMuted:u}=Iz(i??n,{participant:r}),d=s==="always"||s==="muted"&&u||s==="unmuted"&&!u,f=E.useMemo(()=>iu(o,{className:l}),[l,o]);return d?E.createElement("div",Bn(_e({},f),{"data-lk-muted":u}),(c=o.children)!=null?c:CN((a=i==null?void 0:i.source)!=null?a:n,!u)):null}function c$(t){var e=t,{trackRef:n,onSubscriptionStatusChanged:r,volume:i,source:s,name:o,publication:a,participant:c}=e,l=An(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),u,d,f,h,p,g,y,m,v,w;const _=mf(),C=(h=(f=(u=n==null?void 0:n.publication)==null?void 0:u.trackName)!=null?f:(d=_==null?void 0:_.publication)==null?void 0:d.trackName)!=null?h:o,k=(g=(p=n==null?void 0:n.source)!=null?p:_==null?void 0:_.source)!=null?g:s,T=(m=(y=n==null?void 0:n.publication)!=null?y:_==null?void 0:_.publication)!=null?m:a,R=(w=(v=n==null?void 0:n.participant)!=null?v:_==null?void 0:_.participant)!=null?w:c;if(k===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const A=E.useRef(null),M=dc(R),{elementProps:O,isSubscribed:D,track:j,publication:V}=EN({source:k,name:C,participant:M,publication:T},{element:A,props:l});return E.useEffect(()=>{r==null||r(!!D)},[D,r]),E.useEffect(()=>{j===void 0||i===void 0||(j instanceof Wa?j.setVolume(i):Qe.warn("Volume can only be set on remote audio tracks."))},[i,j]),E.useEffect(()=>{V===void 0||l.muted===void 0||(V instanceof _b?V.setEnabled(!l.muted):Qe.warn("Can only call setEnabled on remote track publications."))},[l.muted,V,j]),E.createElement("audio",_e({ref:A},O))}function l$(t){const e=!!Nm();return t.participant&&!e?E.createElement(Bb.Provider,{value:t.participant},t.children):E.createElement(E.Fragment,null,t.children)}function u$({value:t,onPinChange:e,onWidgetChange:n,children:r}){const i=oz(t);return E.useEffect(()=>{Qe.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),E.useEffect(()=>{Qe.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),E.createElement(Fb.Provider,{value:i},r)}function d$(t){const{room:e,htmlProps:n}=gz(t);return E.createElement("div",_e({},n),e&&E.createElement(Ub.Provider,{value:e},E.createElement(cz.Provider,{value:t.featureFlags},t.children)))}function f$(t){var e=t,{participant:n,trackRef:r}=e,i=An(e,["participant","trackRef"]),s,o;const[a,c]=E.useState([]),l=200,u=90,d=6,f=4,h=50,p=7,g=(s=Nm())!=null?s:n;let y=(o=mf())!=null?o:r;if(!y){if(!g)throw Error("Participant missing, provide it directly or within a context");y={participant:g,source:Y.Source.Microphone}}const{track:m}=Pz(y);return E.useEffect(()=>{if(!m||!(m instanceof qn||m instanceof Wa))return;const{analyser:v,cleanup:w}=zj(m,{smoothingTimeConstant:.8,fftSize:64}),_=new Uint8Array(v.frequencyBinCount),C=()=>{v.getByteFrequencyData(_);const T=new Array(p).fill(0);_.slice(1);const R=6;for(let A=0;A<p/2;A+=1){const M=Math.floor(p/2-A);for(let O=0;O<R;O+=1)T[M]+=Math.pow(_[A*R+O]/255,2);T[M]/=R}for(let A=0;A<p/2;A+=1){const M=Math.floor(p/2+A);if(T[M]===0){for(let O=0;O<R;O+=1)T[M]+=Math.pow(_[A*R+O]/255,2);T[M]/=R}}return T.map(A=>A*h)},k=setInterval(()=>{const T=C();c(T)},100);return()=>{clearInterval(k),w()}},[m]),E.createElement("svg",Bn(_e({width:"100%",height:"100%",viewBox:`0 0 ${l} ${u}`},i),{className:"lk-audio-visualizer"}),E.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),E.createElement("g",{style:{transform:`translate(${(l-p*(d+f))/2}px, 0)`}},a.map((v,w)=>E.createElement("rect",{key:w,x:w*(d+f),y:u/2-v/2,width:d,height:v}))))}function h$(t){var e=t,{participants:n}=e,r=An(e,["participants"]);return E.createElement(E.Fragment,null,n.map(i=>E.createElement(Bb.Provider,{value:i,key:i.identity},kN(r.children))))}function p$(t){var e=t,{participant:n,children:r,source:i,publication:s,disableSpeakingIndicator:o,onParticipantClick:a}=e,c=An(e,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const l=dc(n),{elementProps:u}=wz({participant:l,htmlProps:c,disableSpeakingIndicator:o,source:Y.Source.Microphone,publication:s,onParticipantClick:a});return E.createElement("div",_e({style:{position:"relative"}},u),E.createElement(l$,{participant:l},r??E.createElement(E.Fragment,null,E.createElement(c$,{source:i??Y.Source.Microphone}),E.createElement(f$,null),E.createElement("div",{className:"lk-participant-metadata"},E.createElement("div",{className:"lk-participant-metadata-item"},E.createElement(a$,{source:Y.Source.Microphone}),E.createElement(o$,null)),E.createElement(s$,{className:"lk-participant-metadata-item"})))))}function m$(t){var e=t,{entry:n,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:s}=e,o=An(e,["entry","hideName","hideTimestamp","messageFormatter"]),a,c,l,u;const d=E.useMemo(()=>s?s(n.message):n.message,[n.message,s]),f=new Date(n.timestamp),h=navigator?navigator.language:"en-US";return E.createElement("li",_e({className:"lk-chat-entry",title:f.toLocaleTimeString(h,{timeStyle:"full"}),"data-lk-message-origin":(a=n.from)!=null&&a.isLocal?"local":"remote"},o),(!i||!r)&&E.createElement("span",{className:"lk-meta-data"},!r&&E.createElement("strong",{className:"lk-participant-name"},(u=(c=n.from)==null?void 0:c.name)!=null?u:(l=n.from)==null?void 0:l.identity),!i&&E.createElement("span",{className:"lk-timestamp"},f.toLocaleTimeString(h,{timeStyle:"short"}))),E.createElement("span",{className:"lk-message-body"},d))}function g$(t){var e=t,{messageFormatter:n,messageDecoder:r,messageEncoder:i,channelTopic:s}=e,o=An(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const a=E.useRef(null),c=E.useRef(null),l=E.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:s}),[r,i,s]),{send:u,chatMessages:d,isSending:f}=Az(l),h=wN(),p=E.useRef(0);function g(y){return bN(this,null,function*(){y.preventDefault(),a.current&&a.current.value.trim()!==""&&u&&(yield u(a.current.value),a.current.value="",a.current.focus())})}return E.useEffect(()=>{var y;c&&((y=c.current)==null||y.scrollTo({top:c.current.scrollHeight}))},[c,d]),E.useEffect(()=>{var y,m,v,w,_;if(!h||d.length===0)return;if((y=h.widget.state)!=null&&y.showChat&&d.length>0&&p.current!==((m=d[d.length-1])==null?void 0:m.timestamp)){p.current=(v=d[d.length-1])==null?void 0:v.timestamp;return}const C=d.filter(T=>!p.current||T.timestamp>p.current).length,{widget:k}=h;C>0&&((w=k.state)==null?void 0:w.unreadMessages)!==C&&((_=k.dispatch)==null||_.call(k,{msg:"unread_msg",count:C}))},[d,h==null?void 0:h.widget]),E.createElement("div",Bn(_e({},o),{className:"lk-chat"}),E.createElement("ul",{className:"lk-list lk-chat-messages",ref:c},o.children?d.map((y,m)=>kN(o.children,{entry:y,key:m,messageFormatter:n})):d.map((y,m,v)=>{const w=m>=1&&v[m-1].from===y.from,_=m>=1&&y.timestamp-v[m-1].timestamp<6e4;return E.createElement(m$,{key:m,hideName:w,hideTimestamp:w===!1?!1:_,entry:y,messageFormatter:n})})),E.createElement("form",{className:"lk-chat-form",onSubmit:g},E.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:f,ref:a,type:"text",placeholder:"Enter a message..."}),E.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:f},"Send")))}function NC(t){var e=t,{kind:n,initialSelection:r,onActiveDeviceChange:i,tracks:s,requestPermissions:o=!1}=e,a=An(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[c,l]=E.useState(!1),[u,d]=E.useState([]),[f,h]=E.useState(!0),p=(v,w)=>{Qe.debug("handle device change"),l(!1),i==null||i(v,w)},g=E.useRef(null),y=E.useRef(null);E.useLayoutEffect(()=>{g.current&&y.current&&(u||f)&&s7(g.current,y.current).then(({x:v,y:w})=>{y.current&&Object.assign(y.current.style,{left:`${v}px`,top:`${w}px`})}),h(!1)},[g,y,u,f]);const m=E.useCallback(v=>{y.current&&v.target!==g.current&&c&&o7(y.current,v)&&l(!1)},[c,y,g]);return E.useEffect(()=>(document.addEventListener("click",m),window.addEventListener("resize",()=>h(!0)),()=>{document.removeEventListener("click",m),window.removeEventListener("resize",()=>h(!0))}),[m,h]),E.createElement(E.Fragment,null,E.createElement("button",Bn(_e({className:"lk-button lk-button-menu","aria-pressed":c},a),{onClick:()=>l(!c),ref:g}),a.children),!a.disabled&&E.createElement("div",{className:"lk-device-menu",ref:y,style:{visibility:c?"visible":"hidden"}},n?E.createElement(ov,{initialSelection:r,onActiveDeviceChange:v=>p(n,v),onDeviceListChange:d,kind:n,track:s==null?void 0:s[n],requestPermissions:o}):E.createElement(E.Fragment,null,E.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),E.createElement(ov,{kind:"audioinput",onActiveDeviceChange:v=>p("audioinput",v),onDeviceListChange:d,track:s==null?void 0:s.audioinput,requestPermissions:o}),E.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),E.createElement(ov,{kind:"videoinput",onActiveDeviceChange:v=>p("videoinput",v),onDeviceListChange:d,track:s==null?void 0:s.videoinput,requestPermissions:o}))))}function v$(t){var e=t,{label:n}=e,r=An(e,["label"]);const i=Mm(),{mergedProps:s,canPlayAudio:o}=Cz({room:i,props:r}),{mergedProps:a,canPlayVideo:c}=Tz({room:i,props:s}),l=a,{style:u}=l,d=An(l,["style"]);return u.display=o&&c?"none":"block",E.createElement("button",_e({style:u},d),n??`Start ${o?"Video":"Audio"}`)}function y$(t){var e=t,{variation:n,controls:r,saveUserChoices:i=!0}=e,s=An(e,["variation","controls","saveUserChoices"]),o,a,c,l,u;const[d,f]=E.useState(!1),h=wN();E.useEffect(()=>{var j,V;((j=h==null?void 0:h.widget.state)==null?void 0:j.showChat)!==void 0&&f((V=h==null?void 0:h.widget.state)==null?void 0:V.showChat)},[(o=h==null?void 0:h.widget.state)==null?void 0:o.showChat]);const g=nz(`(max-width: ${d?1e3:760}px)`)?"minimal":"verbose";n??(n=g);const y=_e({leave:!0},r),m=yz();m?((a=y.camera)!=null||(y.camera=m.canPublish),(c=y.microphone)!=null||(y.microphone=m.canPublish),(l=y.screenShare)!=null||(y.screenShare=m.canPublish),(u=y.chat)!=null||(y.chat=m.canPublishData&&(r==null?void 0:r.chat))):(y.camera=!1,y.chat=!1,y.microphone=!1,y.screenShare=!1);const v=E.useMemo(()=>n==="minimal"||n==="verbose",[n]),w=E.useMemo(()=>n==="textOnly"||n==="verbose",[n]),_=u7(),[C,k]=E.useState(!1),T=j=>{k(j)},R=iu({className:"lk-control-bar"},s),{saveAudioInputEnabled:A,saveVideoInputEnabled:M,saveAudioInputDeviceId:O,saveVideoInputDeviceId:D}=Nz({preventSave:!i});return E.createElement("div",_e({},R),y.microphone&&E.createElement("div",{className:"lk-button-group"},E.createElement(av,{source:Y.Source.Microphone,showIcon:v,onChange:A},w&&"Microphone"),E.createElement("div",{className:"lk-button-group-menu"},E.createElement(NC,{kind:"audioinput",onActiveDeviceChange:(j,V)=>O(V??"")}))),y.camera&&E.createElement("div",{className:"lk-button-group"},E.createElement(av,{source:Y.Source.Camera,showIcon:v,onChange:M},w&&"Camera"),E.createElement("div",{className:"lk-button-group-menu"},E.createElement(NC,{kind:"videoinput",onActiveDeviceChange:(j,V)=>D(V??"")}))),y.screenShare&&_&&E.createElement(av,{source:Y.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:v,onChange:T},w&&(C?"Stop screen share":"Share screen")),y.chat&&E.createElement(Mz,null,v&&E.createElement(Uz,null),w&&"Chat"),y.leave&&E.createElement(xz,null,v&&E.createElement(Wz,null),w&&"Leave"),E.createElement(v$,null))}function S$(t){var e=An(t,[]);const[n,r]=E.useState({showChat:!1,unreadMessages:0}),i=Ez();return E.createElement(u$,{onWidgetChange:r},E.createElement("div",_e({className:"lk-audio-conference"},e),E.createElement("div",{className:"lk-audio-conference-stage"},E.createElement(h$,{participants:i},E.createElement(p$,null))),E.createElement(y$,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),n.showChat&&E.createElement(g$,null)))}const b$="wss://mongoose-67t79p35.livekit.cloud",w$=({client:t})=>{const[e,n]=E.useState([]),[r,i]=E.useState(!1);return E.useEffect(()=>{const s=a=>{n(c=>[...c,a]),i(!0)},o=a=>{n(c=>{const l=c.filter(u=>u!==a);return l.length===0&&i(!1),l})};return t.on("livekitToken",s),t.on("livekitLeave",o),()=>{t.off("livekitToken",s),t.off("livekitLeave",o)}},[t]),e.length?X.jsxs("div",{"data-lk-theme":"default",children:[e.map((s,o)=>X.jsx(d$,{video:!1,audio:!0,token:s,serverUrl:b$,connect:!0,onDisconnected:()=>t.emit("livekitLeave",s),children:X.jsx(S$,{})},o)),X.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null},TN=Object.prototype.toString;function jb(t){switch(TN.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return lo(t,Error)}}function su(t,e){return TN.call(t)===`[object ${e}]`}function Wb(t){return su(t,"ErrorEvent")}function MC(t){return su(t,"DOMError")}function k$(t){return su(t,"DOMException")}function ls(t){return su(t,"String")}function Vb(t){return t===null||typeof t!="object"&&typeof t!="function"}function Ll(t){return su(t,"Object")}function Om(t){return typeof Event<"u"&&lo(t,Event)}function E$(t){return typeof Element<"u"&&lo(t,Element)}function C$(t){return su(t,"RegExp")}function zb(t){return!!(t&&t.then&&typeof t.then=="function")}function T$(t){return Ll(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function _N(t){return typeof t=="number"&&t!==t}function lo(t,e){try{return t instanceof e}catch{return!1}}function IN(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}function hl(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function xC(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const i=t[r];try{IN(i)?n.push("[VueViewModel]"):n.push(String(i))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function _$(t,e,n=!1){return ls(t)?C$(e)?e.test(t):ls(e)?n?t===e:t.includes(e):!1:!1}function ou(t,e=[],n=!1){return e.some(r=>_$(t,r,n))}function I$(t,e,n=250,r,i,s,o){if(!s.exception||!s.exception.values||!o||!lo(o.originalException,Error))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;a&&(s.exception.values=R$(C0(t,e,i,o.originalException,r,s.exception.values,a,0),n))}function C0(t,e,n,r,i,s,o,a){if(s.length>=n+1)return s;let c=[...s];if(lo(r[i],Error)){OC(o,a);const l=t(e,r[i]),u=c.length;DC(l,i,u,a),c=C0(t,e,n,r[i],i,[l,...c],l,u)}return Array.isArray(r.errors)&&r.errors.forEach((l,u)=>{if(lo(l,Error)){OC(o,a);const d=t(e,l),f=c.length;DC(d,`errors[${u}]`,f,a),c=C0(t,e,n,l,i,[d,...c],d,f)}}),c}function OC(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,is_exception_group:!0,exception_id:e}}function DC(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function R$(t,e){return t.map(n=>(n.value&&(n.value=hl(n.value,e)),n))}function Yf(t){return t&&t.Math==Math?t:void 0}const Ke=typeof globalThis=="object"&&Yf(globalThis)||typeof window=="object"&&Yf(window)||typeof self=="object"&&Yf(self)||typeof global=="object"&&Yf(global)||function(){return this}()||{};function Dm(){return Ke}function RN(t,e,n){const r=n||Ke,i=r.__SENTRY__=r.__SENTRY__||{};return i[t]||(i[t]=e())}const pl=Dm(),P$=80;function nc(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,i=[];let s=0,o=0;const a=" > ",c=a.length;let l;const u=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||P$;for(;n&&s++<r&&(l=A$(n,u),!(l==="html"||s>1&&o+i.length*c+l.length>=d));)i.push(l),o+=l.length,n=n.parentNode;return i.reverse().join(a)}catch{return"<unknown>"}}function A$(t,e){const n=t,r=[];let i,s,o,a,c;if(!n||!n.tagName)return"";if(pl.HTMLElement&&n instanceof HTMLElement&&n.dataset&&n.dataset.sentryComponent)return n.dataset.sentryComponent;r.push(n.tagName.toLowerCase());const l=e&&e.length?e.filter(d=>n.getAttribute(d)).map(d=>[d,n.getAttribute(d)]):null;if(l&&l.length)l.forEach(d=>{r.push(`[${d[0]}="${d[1]}"]`)});else if(n.id&&r.push(`#${n.id}`),i=n.className,i&&ls(i))for(s=i.split(/\s+/),c=0;c<s.length;c++)r.push(`.${s[c]}`);const u=["aria-label","type","name","title","alt"];for(c=0;c<u.length;c++)o=u[c],a=n.getAttribute(o),a&&r.push(`[${o}="${a}"]`);return r.join("")}function N$(){try{return pl.document.location.href}catch{return""}}function M$(t){return pl.document&&pl.document.querySelector?pl.document.querySelector(t):null}function PN(t){if(!pl.HTMLElement)return null;let e=t;const n=5;for(let r=0;r<n;r++){if(!e)return null;if(e instanceof HTMLElement&&e.dataset.sentryComponent)return e.dataset.sentryComponent;e=e.parentNode}return null}const au=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,x$="Sentry Logger ",T0=["debug","info","warn","error","log","assert","trace"],Dp={};function rc(t){if(!("console"in Ke))return t();const e=Ke.console,n={},r=Object.keys(Dp);r.forEach(i=>{const s=Dp[i];n[i]=e[i],e[i]=s});try{return t()}finally{r.forEach(i=>{e[i]=n[i]})}}function O$(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return au?T0.forEach(n=>{e[n]=(...r)=>{t&&rc(()=>{Ke.console[n](`${x$}[${n}]:`,...r)})}}):T0.forEach(n=>{e[n]=()=>{}}),e}const K=O$(),D$=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function L$(t){return t==="http"||t==="https"}function cu(t,e=!1){const{host:n,path:r,pass:i,port:s,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&i?`:${i}`:""}@${n}${s?`:${s}`:""}/${r&&`${r}/`}${o}`}function F$(t){const e=D$.exec(t);if(!e){rc(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,r,i="",s,o="",a]=e.slice(1);let c="",l=a;const u=l.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),l=u.pop()),l){const d=l.match(/^\d+/);d&&(l=d[0])}return AN({host:s,pass:i,path:c,projectId:l,port:o,protocol:n,publicKey:r})}function AN(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function B$(t){if(!au)return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(K.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?L$(r)?e&&isNaN(parseInt(e,10))?(K.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(K.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(K.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function NN(t){const e=typeof t=="string"?F$(t):AN(t);if(!(!e||!B$(e)))return e}class Wi extends Error{constructor(e,n="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}}function gn(t,e,n){if(!(e in t))return;const r=t[e],i=n(r);typeof i=="function"&&MN(i,r),t[e]=i}function Bd(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{au&&K.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function MN(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,Bd(t,"__sentry_original__",e)}catch{}}function $b(t){return t.__sentry_original__}function U$(t){return Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}function xN(t){if(jb(t))return{message:t.message,name:t.name,stack:t.stack,...FC(t)};if(Om(t)){const e={type:t.type,target:LC(t.target),currentTarget:LC(t.currentTarget),...FC(t)};return typeof CustomEvent<"u"&&lo(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function LC(t){try{return E$(t)?nc(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function FC(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function j$(t,e=40){const n=Object.keys(xN(t));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=e)return hl(n[0],e);for(let r=n.length;r>0;r--){const i=n.slice(0,r).join(", ");if(!(i.length>e))return r===n.length?i:hl(i,e)}return""}function us(t){return _0(t,new Map)}function _0(t,e){if(Ll(t)){const n=e.get(t);if(n!==void 0)return n;const r={};e.set(t,r);for(const i of Object.keys(t))typeof t[i]<"u"&&(r[i]=_0(t[i],e));return r}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const r=[];return e.set(t,r),t.forEach(i=>{r.push(_0(i,e))}),r}return t}const ON=50,BC=/\(error: (.*)\)/,UC=/captureMessage|captureException/;function DN(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0)=>{const i=[],s=n.split(`
`);for(let o=r;o<s.length;o++){const a=s[o];if(a.length>1024)continue;const c=BC.test(a)?a.replace(BC,"$1"):a;if(!c.match(/\S*Error: /)){for(const l of e){const u=l(c);if(u){i.push(u);break}}if(i.length>=ON)break}}return V$(i)}}function W$(t){return Array.isArray(t)?DN(...t):t}function V$(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(e[e.length-1].function||"")&&e.pop(),e.reverse(),UC.test(e[e.length-1].function||"")&&(e.pop(),UC.test(e[e.length-1].function||"")&&e.pop()),e.slice(0,ON).map(n=>({...n,filename:n.filename||e[e.length-1].filename,function:n.function||"?"}))}const cv="<anonymous>";function uo(t){try{return!t||typeof t!="function"?cv:t.name||cv}catch{return cv}}const Lh={},jC={};function fc(t,e){Lh[t]=Lh[t]||[],Lh[t].push(e)}function hc(t,e){jC[t]||(e(),jC[t]=!0)}function Ei(t,e){const n=t&&Lh[t];if(n)for(const r of n)try{r(e)}catch(i){au&&K.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${uo(r)}
Error:`,i)}}function z$(t){const e="console";fc(e,t),hc(e,$$)}function $$(){"console"in Ke&&T0.forEach(function(t){t in Ke.console&&gn(Ke.console,t,function(e){return Dp[t]=e,function(...n){Ei("console",{args:n,level:t});const i=Dp[t];i&&i.apply(Ke.console,n)}})})}function Un(){const t=Ke,e=t.crypto||t.msCrypto;let n=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>{const r=new Uint8Array(1);return e.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(n()&15)>>r/4).toString(16))}function LN(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function Do(t){const{message:e,event_id:n}=t;if(e)return e;const r=LN(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function I0(t,e,n){const r=t.exception=t.exception||{},i=r.values=r.values||[],s=i[0]=i[0]||{};s.value||(s.value=e||""),s.type||(s.type=n||"Error")}function Ud(t,e){const n=LN(t);if(!n)return;const r={type:"generic",handled:!0},i=n.mechanism;if(n.mechanism={...r,...i,...e},e&&"data"in e){const s={...i&&i.data,...e.data};n.mechanism.data=s}}function WC(t){if(t&&t.__sentry_captured__)return!0;try{Bd(t,"__sentry_captured__",!0)}catch{}return!1}function FN(t){return Array.isArray(t)?t:[t]}const _c=Ke,H$=1e3;let VC,R0,P0;function BN(t){const e="dom";fc(e,t),hc(e,G$)}function G$(){if(!_c.document)return;const t=Ei.bind(null,"dom"),e=zC(t,!0);_c.document.addEventListener("click",e,!1),_c.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{const r=_c[n]&&_c[n].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(gn(r,"addEventListener",function(i){return function(s,o,a){if(s==="click"||s=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__=c.__sentry_instrumentation_handlers__||{},u=l[s]=l[s]||{refCount:0};if(!u.handler){const d=zC(t);u.handler=d,i.call(this,s,d,a)}u.refCount++}catch{}return i.call(this,s,o,a)}}),gn(r,"removeEventListener",function(i){return function(s,o,a){if(s==="click"||s=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__||{},u=l[s];u&&(u.refCount--,u.refCount<=0&&(i.call(this,s,u.handler,a),u.handler=void 0,delete l[s]),Object.keys(l).length===0&&delete c.__sentry_instrumentation_handlers__)}catch{}return i.call(this,s,o,a)}}))})}function q$(t){if(t.type!==R0)return!1;try{if(!t.target||t.target._sentryId!==P0)return!1}catch{}return!0}function J$(t,e){return t!=="keypress"?!1:!e||!e.tagName?!0:!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)}function zC(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=Z$(n);if(J$(n.type,r))return;Bd(n,"_sentryCaptured",!0),r&&!r._sentryId&&Bd(r,"_sentryId",Un());const i=n.type==="keypress"?"input":n.type;q$(n)||(t({event:n,name:i,global:e}),R0=n.type,P0=r?r._sentryId:void 0),clearTimeout(VC),VC=_c.setTimeout(()=>{P0=void 0,R0=void 0},H$)}}function Z$(t){try{return t.target}catch{return null}}const A0=Dm();function UN(){if(!("fetch"in A0))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function N0(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function K$(){if(typeof EdgeRuntime=="string")return!0;if(!UN())return!1;if(N0(A0.fetch))return!0;let t=!1;const e=A0.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=N0(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){au&&K.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}function Hb(t){const e="fetch";fc(e,t),hc(e,Y$)}function Y$(){K$()&&gn(Ke,"fetch",function(t){return function(...e){const{method:n,url:r}=X$(e),i={args:e,fetchData:{method:n,url:r},startTimestamp:Date.now()};return Ei("fetch",{...i}),t.apply(Ke,e).then(s=>{const o={...i,endTimestamp:Date.now(),response:s};return Ei("fetch",o),s},s=>{const o={...i,endTimestamp:Date.now(),error:s};throw Ei("fetch",o),s})}})}function M0(t,e){return!!t&&typeof t=="object"&&!!t[e]}function $C(t){return typeof t=="string"?t:t?M0(t,"url")?t.url:t.toString?t.toString():"":""}function X$(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,r]=t;return{url:$C(n),method:M0(r,"method")?String(r.method).toUpperCase():"GET"}}const e=t[0];return{url:$C(e),method:M0(e,"method")?String(e.method).toUpperCase():"GET"}}let Xf=null;function jN(t){const e="error";fc(e,t),hc(e,Q$)}function Q$(){Xf=Ke.onerror,Ke.onerror=function(t,e,n,r,i){return Ei("error",{column:r,error:i,line:n,msg:t,url:e}),Xf&&!Xf.__SENTRY_LOADER__?Xf.apply(this,arguments):!1},Ke.onerror.__SENTRY_INSTRUMENTED__=!0}let Qf=null;function WN(t){const e="unhandledrejection";fc(e,t),hc(e,e9)}function e9(){Qf=Ke.onunhandledrejection,Ke.onunhandledrejection=function(t){return Ei("unhandledrejection",t),Qf&&!Qf.__SENTRY_LOADER__?Qf.apply(this,arguments):!0},Ke.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const eh=Dm();function t9(){const t=eh.chrome,e=t&&t.app&&t.app.runtime,n="history"in eh&&!!eh.history.pushState&&!!eh.history.replaceState;return!e&&n}const Ru=Ke;let th;function Lm(t){const e="history";fc(e,t),hc(e,n9)}function n9(){if(!t9())return;const t=Ru.onpopstate;Ru.onpopstate=function(...n){const r=Ru.location.href,i=th;if(th=r,Ei("history",{from:i,to:r}),t)try{return t.apply(this,n)}catch{}};function e(n){return function(...r){const i=r.length>2?r[2]:void 0;if(i){const s=th,o=String(i);th=o,Ei("history",{from:s,to:o})}return n.apply(this,r)}}gn(Ru.history,"pushState",e),gn(Ru.history,"replaceState",e)}const r9=Ke,Ho="__sentry_xhr_v3__";function Gb(t){const e="xhr";fc(e,t),hc(e,i9)}function i9(){if(!r9.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;gn(t,"open",function(e){return function(...n){const r=Date.now(),i=ls(n[0])?n[0].toUpperCase():void 0,s=s9(n[1]);if(!i||!s)return e.apply(this,n);this[Ho]={method:i,url:s,request_headers:{}},i==="POST"&&s.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const o=()=>{const a=this[Ho];if(a&&this.readyState===4){try{a.status_code=this.status}catch{}const c={args:[i,s],endTimestamp:Date.now(),startTimestamp:r,xhr:this};Ei("xhr",c)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?gn(this,"onreadystatechange",function(a){return function(...c){return o(),a.apply(this,c)}}):this.addEventListener("readystatechange",o),gn(this,"setRequestHeader",function(a){return function(...c){const[l,u]=c,d=this[Ho];return d&&ls(l)&&ls(u)&&(d.request_headers[l.toLowerCase()]=u),a.apply(this,c)}}),e.apply(this,n)}}),gn(t,"send",function(e){return function(...n){const r=this[Ho];if(!r)return e.apply(this,n);n[0]!==void 0&&(r.body=n[0]);const i={args:[r.method,r.url],startTimestamp:Date.now(),xhr:this};return Ei("xhr",i),e.apply(this,n)}})}function s9(t){if(ls(t))return t;try{return t.toString()}catch{}}function o9(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function a9(){return"npm"}function VN(){return!o9()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function c9(t,e){return t.require(e)}function HC(){return typeof window<"u"&&(!VN()||l9())}function l9(){return Ke.process!==void 0&&Ke.process.type==="renderer"}function u9(){const t=typeof WeakSet=="function",e=t?new WeakSet:[];function n(i){if(t)return e.has(i)?!0:(e.add(i),!1);for(let s=0;s<e.length;s++)if(e[s]===i)return!0;return e.push(i),!1}function r(i){if(t)e.delete(i);else for(let s=0;s<e.length;s++)if(e[s]===i){e.splice(s,1);break}}return[n,r]}function Bi(t,e=100,n=1/0){try{return x0("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function zN(t,e=3,n=100*1024){const r=Bi(t,e);return p9(r)>n?zN(t,e-1,n):r}function x0(t,e,n=1/0,r=1/0,i=u9()){const[s,o]=i;if(e==null||["number","boolean","string"].includes(typeof e)&&!_N(e))return e;const a=d9(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(s(e))return"[Circular ~]";const l=e;if(l&&typeof l.toJSON=="function")try{const h=l.toJSON();return x0("",h,c-1,r,i)}catch{}const u=Array.isArray(e)?[]:{};let d=0;const f=xN(e);for(const h in f){if(!Object.prototype.hasOwnProperty.call(f,h))continue;if(d>=r){u[h]="[MaxProperties ~]";break}const p=f[h];u[h]=x0(h,p,c-1,r,i),d++}return o(e),u}function d9(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(IN(e))return"[VueViewModel]";if(T$(e))return"[SyntheticEvent]";if(typeof e=="number"&&e!==e)return"[NaN]";if(typeof e=="function")return`[Function: ${uo(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=f9(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function f9(t){const e=Object.getPrototypeOf(t);return e?e.constructor.name:"null prototype"}function h9(t){return~-encodeURI(t).split(/%..|./).length}function p9(t){return h9(JSON.stringify(t))}var ws;(function(t){t[t.PENDING=0]="PENDING";const n=1;t[t.RESOLVED=n]="RESOLVED";const r=2;t[t.REJECTED=r]="REJECTED"})(ws||(ws={}));function Fl(t){return new Cr(e=>{e(t)})}function qb(t){return new Cr((e,n)=>{n(t)})}class Cr{constructor(e){Cr.prototype.__init.call(this),Cr.prototype.__init2.call(this),Cr.prototype.__init3.call(this),Cr.prototype.__init4.call(this),this._state=ws.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new Cr((r,i)=>{this._handlers.push([!1,s=>{if(!e)r(s);else try{r(e(s))}catch(o){i(o)}},s=>{if(!n)i(s);else try{r(n(s))}catch(o){i(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new Cr((n,r)=>{let i,s;return this.then(o=>{s=!1,i=o,e&&e()},o=>{s=!0,i=o,e&&e()}).then(()=>{if(s){r(i);return}n(i)})})}__init(){this._resolve=e=>{this._setResult(ws.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(ws.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{if(this._state===ws.PENDING){if(zb(n)){n.then(this._resolve,this._reject);return}this._state=e,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===ws.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===ws.RESOLVED&&n[1](this._value),this._state===ws.REJECTED&&n[2](this._value),n[0]=!0)})}}}function m9(t){const e=[];function n(){return t===void 0||e.length<t}function r(o){return e.splice(e.indexOf(o),1)[0]}function i(o){if(!n())return qb(new Wi("Not adding Promise because buffer limit was reached."));const a=o();return e.indexOf(a)===-1&&e.push(a),a.then(()=>r(a)).then(null,()=>r(a).then(null,()=>{})),a}function s(o){return new Cr((a,c)=>{let l=e.length;if(!l)return a(!0);const u=setTimeout(()=>{o&&o>0&&a(!1)},o);e.forEach(d=>{Fl(d).then(()=>{--l||(clearTimeout(u),a(!0))},c)})})}return{$:e,add:i,drain:s}}function lv(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}const g9=["fatal","error","warning","log","info","debug"];function v9(t){return t==="warn"?"warning":g9.includes(t)?t:"log"}const $N=Dm(),O0={nowSeconds:()=>Date.now()/1e3};function y9(){const{performance:t}=$N;if(!t||!t.now)return;const e=Date.now()-t.now();return{now:()=>t.now(),timeOrigin:e}}function S9(){try{return c9(Dx,"perf_hooks").performance}catch{return}}const uv=VN()?S9():y9(),GC=uv===void 0?O0:{nowSeconds:()=>(uv.timeOrigin+uv.now())/1e3},Fm=O0.nowSeconds.bind(O0),ic=GC.nowSeconds.bind(GC),Ii=(()=>{const{performance:t}=$N;if(!t||!t.now)return;const e=3600*1e3,n=t.now(),r=Date.now(),i=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,s=i<e,o=t.timing&&t.timing.navigationStart,c=typeof o=="number"?Math.abs(o+n-r):e,l=c<e;return s||l?i<=c?t.timeOrigin:o:r})(),D0="baggage",HN="sentry-",b9=/^sentry-/,w9=8192;function k9(t){if(!ls(t)&&!Array.isArray(t))return;let e={};if(Array.isArray(t))e=t.reduce((r,i)=>{const s=qC(i);return{...r,...s}},{});else{if(!t)return;e=qC(t)}const n=Object.entries(e).reduce((r,[i,s])=>{if(i.match(b9)){const o=i.slice(HN.length);r[o]=s}return r},{});if(Object.keys(n).length>0)return n}function L0(t){if(!t)return;const e=Object.entries(t).reduce((n,[r,i])=>(i&&(n[`${HN}${r}`]=i),n),{});return E9(e)}function qC(t){return t.split(",").map(e=>e.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((e,[n,r])=>(e[n]=r,e),{})}function E9(t){if(Object.keys(t).length!==0)return Object.entries(t).reduce((e,[n,r],i)=>{const s=`${encodeURIComponent(n)}=${encodeURIComponent(r)}`,o=i===0?s:`${e},${s}`;return o.length>w9?(au&&K.warn(`Not adding key: ${n} with val: ${r} to baggage header due to exceeding baggage size limits.`),e):o},"")}const C9=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function T9(t){if(!t)return;const e=t.match(C9);if(!e)return;let n;return e[3]==="1"?n=!0:e[3]==="0"&&(n=!1),{traceId:e[1],parentSampled:n,parentSpanId:e[2]}}function _9(t,e){const n=T9(t),r=k9(e),{traceId:i,parentSpanId:s,parentSampled:o}=n||{},a={traceId:i||Un(),spanId:Un().substring(16),sampled:o};return s&&(a.parentSpanId=s),r&&(a.dsc=r),{traceparentData:n,dynamicSamplingContext:r,propagationContext:a}}function Jb(t=Un(),e=Un().substring(16),n){let r="";return n!==void 0&&(r=n?"-1":"-0"),`${t}-${e}${r}`}function pc(t,e=[]){return[t,e]}function I9(t,e){const[n,r]=t;return[n,[...r,e]]}function JC(t,e){const n=t[1];for(const r of n){const i=r[0].type;if(e(r,i))return!0}return!1}function F0(t,e){return(e||new TextEncoder).encode(t)}function R9(t,e){const[n,r]=t;let i=JSON.stringify(n);function s(o){typeof i=="string"?i=typeof o=="string"?i+o:[F0(i,e),o]:i.push(typeof o=="string"?F0(o,e):o)}for(const o of r){const[a,c]=o;if(s(`
${JSON.stringify(a)}
`),typeof c=="string"||c instanceof Uint8Array)s(c);else{let l;try{l=JSON.stringify(c)}catch{l=JSON.stringify(Bi(c))}s(l)}}return typeof i=="string"?i:P9(i)}function P9(t){const e=t.reduce((i,s)=>i+s.length,0),n=new Uint8Array(e);let r=0;for(const i of t)n.set(i,r),r+=i.length;return n}function A9(t,e){const n=typeof t.data=="string"?F0(t.data,e):t.data;return[us({type:"attachment",length:n.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),n]}const N9={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",statsd:"unknown"};function ZC(t){return N9[t]}function Zb(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function GN(t,e,n,r){const i=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&r&&{dsn:cu(r)},...i&&{trace:us({...i})}}}function M9(t,e,n){const r=[{type:"client_report"},{timestamp:n||Fm(),discarded_events:t}];return pc(e?{dsn:e}:{},[r])}const x9=60*1e3;function O9(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?x9:r-e}function D9(t,e){return t[e]||t.all||0}function qN(t,e,n=Date.now()){return D9(t,e)>n}function JN(t,{statusCode:e,headers:n},r=Date.now()){const i={...t},s=n&&n["x-sentry-rate-limits"],o=n&&n["retry-after"];if(s)for(const a of s.trim().split(",")){const[c,l]=a.split(":",2),u=parseInt(c,10),d=(isNaN(u)?60:u)*1e3;if(!l)i.all=r+d;else for(const f of l.split(";"))i[f]=r+d}else o?i.all=r+O9(o,r):e===429&&(i.all=r+60*1e3);return i}const we=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Kb="production";function Yb(){return RN("globalEventProcessors",()=>[])}function L9(t){Yb().push(t)}function Lp(t,e,n,r=0){return new Cr((i,s)=>{const o=t[r];if(e===null||typeof o!="function")i(e);else{const a=o({...e},n);we&&o.id&&a===null&&K.log(`Event processor "${o.id}" dropped event`),zb(a)?a.then(c=>Lp(t,c,n,r+1).then(i)).then(null,s):Lp(t,a,n,r+1).then(i).then(null,s)}})}function F9(t){const e=ic(),n={sid:Un(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>U9(n)};return t&&Bl(n,t),n}function Bl(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||ic(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:Un()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function B9(t,e){let n={};e?n={status:e}:t.status==="ok"&&(n={status:"exited"}),Bl(t,n)}function U9(t){return us({sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}function ZN(t,e){const{fingerprint:n,span:r,breadcrumbs:i,sdkProcessingMetadata:s,propagationContext:o}=e;j9(t,e),r&&z9(t,r),$9(t,n),W9(t,i),V9(t,s,o)}function KC(t,e){const{extra:n,tags:r,user:i,contexts:s,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:l,eventProcessors:u,attachments:d,propagationContext:f,transactionName:h,span:p}=e;Pu(t,"extra",n),Pu(t,"tags",r),Pu(t,"user",i),Pu(t,"contexts",s),Pu(t,"sdkProcessingMetadata",a),o&&(t.level=o),h&&(t.transactionName=h),p&&(t.span=p),c.length&&(t.breadcrumbs=[...t.breadcrumbs,...c]),l.length&&(t.fingerprint=[...t.fingerprint,...l]),u.length&&(t.eventProcessors=[...t.eventProcessors,...u]),d.length&&(t.attachments=[...t.attachments,...d]),t.propagationContext={...t.propagationContext,...f}}function Pu(t,e,n){n&&Object.keys(n).length&&(t[e]={...t[e],...n})}function j9(t,e){const{extra:n,tags:r,user:i,contexts:s,level:o,transactionName:a}=e;n&&Object.keys(n).length&&(t.extra={...n,...t.extra}),r&&Object.keys(r).length&&(t.tags={...r,...t.tags}),i&&Object.keys(i).length&&(t.user={...i,...t.user}),s&&Object.keys(s).length&&(t.contexts={...s,...t.contexts}),o&&(t.level=o),a&&(t.transaction=a)}function W9(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function V9(t,e,n){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e,propagationContext:n}}function z9(t,e){t.contexts={trace:e.getTraceContext(),...t.contexts};const n=e.transaction;if(n){t.sdkProcessingMetadata={dynamicSamplingContext:n.getDynamicSamplingContext(),...t.sdkProcessingMetadata};const r=n.name;r&&(t.tags={transaction:r,...t.tags})}}function $9(t,e){t.fingerprint=t.fingerprint?FN(t.fingerprint):[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}const H9=100;let dv;class ss{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=YC()}static clone(e){return e?e.clone():new ss}clone(){const e=new ss;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._span=this._span,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{},this._session&&Bl(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this.getSpan();return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if(typeof e=="function"){const n=e(this);return n instanceof ss?n:this}return e instanceof ss?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession),e._propagationContext&&(this._propagationContext=e._propagationContext)):Ll(e)&&(e=e,this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=YC(),this}addBreadcrumb(e,n){const r=typeof n=="number"?n:H9;if(r<=0)return this;const i={timestamp:Fm(),...e},s=this._breadcrumbs;return s.push(i),this._breadcrumbs=s.length>r?s.slice(-r):s,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:e,_attachments:n,_contexts:r,_tags:i,_extra:s,_user:o,_level:a,_fingerprint:c,_eventProcessors:l,_propagationContext:u,_sdkProcessingMetadata:d,_transactionName:f,_span:h}=this;return{breadcrumbs:e,attachments:n,contexts:r,tags:i,extra:s,user:o,level:a,fingerprint:c||[],eventProcessors:l,propagationContext:u,sdkProcessingMetadata:d,transactionName:f,span:h}}applyToEvent(e,n={},r=[]){ZN(e,this.getScopeData());const i=[...r,...Yb(),...this._eventProcessors];return Lp(i,e,n)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function G9(){return dv||(dv=new ss),dv}function YC(){return{traceId:Un(),spanId:Un().substring(16)}}const jd="7.91.0",KN=parseFloat(jd),q9=100;class YN{constructor(e,n=new ss,r=new ss,i=KN){this._version=i,this._stack=[{scope:n}],e&&this.bindClient(e),this._isolationScope=r}isOlderThan(e){return this._version<e}bindClient(e){const n=this.getStackTop();n.client=e,e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(e){const n=this.pushScope();try{return e(n)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,n){const r=this._lastEventId=n&&n.event_id?n.event_id:Un(),i=new Error("Sentry syntheticException");return this._withClient((s,o)=>{s.captureException(e,{originalException:e,syntheticException:i,...n,event_id:r},o)}),r}captureMessage(e,n,r){const i=this._lastEventId=r&&r.event_id?r.event_id:Un(),s=new Error(e);return this._withClient((o,a)=>{o.captureMessage(e,n,{originalException:e,syntheticException:s,...r,event_id:i},a)}),i}captureEvent(e,n){const r=n&&n.event_id?n.event_id:Un();return e.type||(this._lastEventId=r),this._withClient((i,s)=>{i.captureEvent(e,{...n,event_id:r},s)}),r}lastEventId(){return this._lastEventId}addBreadcrumb(e,n){const{scope:r,client:i}=this.getStackTop();if(!i)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:o=q9}=i.getOptions&&i.getOptions()||{};if(o<=0)return;const c={timestamp:Fm(),...e},l=s?rc(()=>s(c,n)):c;l!==null&&(i.emit&&i.emit("beforeAddBreadcrumb",l,n),r.addBreadcrumb(l,o))}setUser(e){this.getScope().setUser(e)}setTags(e){this.getScope().setTags(e)}setExtras(e){this.getScope().setExtras(e)}setTag(e,n){this.getScope().setTag(e,n)}setExtra(e,n){this.getScope().setExtra(e,n)}setContext(e,n){this.getScope().setContext(e,n)}configureScope(e){const{scope:n,client:r}=this.getStackTop();r&&e(n)}run(e){const n=XC(this);try{e(this)}finally{XC(n)}}getIntegration(e){const n=this.getClient();if(!n)return null;try{return n.getIntegration(e)}catch{return we&&K.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,n){const r=this._callExtensionMethod("startTransaction",e,n);return we&&!r&&(this.getClient()?K.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):K.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),r}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const n=this.getStackTop().scope,r=n.getSession();r&&B9(r),this._sendSessionUpdate(),n.setSession()}startSession(e){const{scope:n,client:r}=this.getStackTop(),{release:i,environment:s=Kb}=r&&r.getOptions()||{},{userAgent:o}=Ke.navigator||{},a=F9({release:i,environment:s,user:n.getUser(),...o&&{userAgent:o},...e}),c=n.getSession&&n.getSession();return c&&c.status==="ok"&&Bl(c,{status:"exited"}),this.endSession(),n.setSession(a),a}shouldSendDefaultPii(){const e=this.getClient(),n=e&&e.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:n}=this.getStackTop(),r=e.getSession();r&&n&&n.captureSession&&n.captureSession(r)}_withClient(e){const{scope:n,client:r}=this.getStackTop();r&&e(r,n)}_callExtensionMethod(e,...n){const i=vf().__SENTRY__;if(i&&i.extensions&&typeof i.extensions[e]=="function")return i.extensions[e].apply(this,n);we&&K.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function vf(){return Ke.__SENTRY__=Ke.__SENTRY__||{extensions:{},hub:void 0},Ke}function XC(t){const e=vf(),n=B0(e);return QN(e,t),n}function Wn(){const t=vf();if(t.__SENTRY__&&t.__SENTRY__.acs){const e=t.__SENTRY__.acs.getCurrentHub();if(e)return e}return J9(t)}function XN(){return Wn().getIsolationScope()}function J9(t=vf()){return(!Z9(t)||B0(t).isOlderThan(KN))&&QN(t,new YN),B0(t)}function Z9(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function B0(t){return RN("hub",()=>new YN,t)}function QN(t,e){if(!t)return!1;const n=t.__SENTRY__=t.__SENTRY__||{};return n.hub=e,!0}function yf(t){return(t||Wn()).getScope().getTransaction()}function Xb(t){return t>9999999999?t/1e3:t}let QC=!1;function K9(){QC||(QC=!0,jN(U0),WN(U0))}function U0(){const t=yf();if(t){const e="internal_error";we&&K.log(`[Tracing] Transaction: ${e} -> Global error occured`),t.setStatus(e)}}U0.tag="sentry_tracingErrorCallback";class eM{constructor(e=1e3){this._maxlen=e,this.spans=[]}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class Qb{constructor(e={}){this.traceId=e.traceId||Un(),this.spanId=e.spanId||Un().substring(16),this.startTimestamp=e.startTimestamp||ic(),this.tags=e.tags||{},this.data=e.data||{},this.instrumenter=e.instrumenter||"sentry",this.origin=e.origin||"manual",e.parentSpanId&&(this.parentSpanId=e.parentSpanId),"sampled"in e&&(this.sampled=e.sampled),e.op&&(this.op=e.op),e.description&&(this.description=e.description),e.name&&(this.description=e.name),e.status&&(this.status=e.status),e.endTimestamp&&(this.endTimestamp=e.endTimestamp)}get name(){return this.description||""}set name(e){this.setName(e)}startChild(e){const n=new Qb({...e,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(n.spanRecorder=this.spanRecorder,n.spanRecorder&&n.spanRecorder.add(n),n.transaction=this.transaction,we&&n.transaction){const r=e&&e.op||"< unknown op >",i=n.transaction.name||"< unknown name >",s=n.transaction.spanId,o=`[Tracing] Starting '${r}' span on transaction '${i}' (${s}).`;n.transaction.metadata.spanMetadata[n.spanId]={logMessage:o},K.log(o)}return n}setTag(e,n){return this.tags={...this.tags,[e]:n},this}setData(e,n){return this.data={...this.data,[e]:n},this}setStatus(e){return this.status=e,this}setHttpStatus(e){this.setTag("http.status_code",String(e)),this.setData("http.response.status_code",e);const n=Y9(e);return n!=="unknown_error"&&this.setStatus(n),this}setName(e){this.description=e}isSuccess(){return this.status==="ok"}finish(e){return this.end(e)}end(e){if(we&&this.transaction&&this.transaction.spanId!==this.spanId){const{logMessage:n}=this.transaction.metadata.spanMetadata[this.spanId];n&&K.log(n.replace("Starting","Finishing"))}this.endTimestamp=typeof e=="number"?Xb(e):ic()}toTraceparent(){return Jb(this.traceId,this.spanId,this.sampled)}toContext(){return us({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(e){return this.data=e.data||{},this.description=e.description,this.endTimestamp=e.endTimestamp,this.op=e.op,this.parentSpanId=e.parentSpanId,this.sampled=e.sampled,this.spanId=e.spanId||this.spanId,this.startTimestamp=e.startTimestamp||this.startTimestamp,this.status=e.status,this.tags=e.tags||{},this.traceId=e.traceId||this.traceId,this}getTraceContext(){return us({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId,origin:this.origin})}toJSON(){return us({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId,origin:this.origin})}}function Y9(t){if(t<400&&t>=100)return"ok";if(t>=400&&t<500)switch(t){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(t>=500&&t<600)switch(t){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}function Bm(t,e,n){const r=e.getOptions(),{publicKey:i}=e.getDsn()||{},{segment:s}=n&&n.getUser()||{},o=us({environment:r.environment||Kb,release:r.release,user_segment:s,public_key:i,trace_id:t});return e.emit&&e.emit("createDsc",o),o}class tM extends Qb{constructor(e,n){super(e),delete this.description,this._measurements={},this._contexts={},this._hub=n||Wn(),this._name=e.name||"",this.metadata={source:"custom",...e.metadata,spanMetadata:{}},this._trimEnd=e.trimEnd,this.transaction=this;const r=this.metadata.dynamicSamplingContext;r&&(this._frozenDynamicSamplingContext={...r})}get name(){return this._name}set name(e){this.setName(e)}setName(e,n="custom"){this._name=e,this.metadata.source=n}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new eM(e)),this.spanRecorder.add(this)}setContext(e,n){n===null?delete this._contexts[e]:this._contexts[e]=n}setMeasurement(e,n,r=""){this._measurements[e]={value:n,unit:r}}setMetadata(e){this.metadata={...this.metadata,...e}}end(e){const n=typeof e=="number"?Xb(e):ic(),r=this._finishTransaction(n);if(r)return this._hub.captureEvent(r)}toContext(){const e=super.toContext();return us({...e,name:this.name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this.name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;const e=this._hub||Wn(),n=e.getClient();if(!n)return{};const r=e.getScope(),i=Bm(this.traceId,n,r),s=this.metadata.sampleRate;s!==void 0&&(i.sample_rate=`${s}`);const o=this.metadata.source;return o&&o!=="url"&&(i.transaction=this.name),this.sampled!==void 0&&(i.sampled=String(this.sampled)),i}setHub(e){this._hub=e}_finishTransaction(e){if(this.endTimestamp!==void 0)return;this.name||(we&&K.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.end(e);const n=this._hub.getClient();if(n&&n.emit&&n.emit("finishTransaction",this),this.sampled!==!0){we&&K.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),n&&n.recordDroppedEvent("sample_rate","transaction");return}const r=this.spanRecorder?this.spanRecorder.spans.filter(a=>a!==this&&a.endTimestamp):[];this._trimEnd&&r.length>0&&(this.endTimestamp=r.reduce((a,c)=>a.endTimestamp&&c.endTimestamp?a.endTimestamp>c.endTimestamp?a:c:a).endTimestamp);const i=this.metadata,s={contexts:{...this._contexts,trace:this.getTraceContext()},spans:r,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...i,dynamicSamplingContext:this.getDynamicSamplingContext()},...i.source&&{transaction_info:{source:i.source}}};return Object.keys(this._measurements).length>0&&(we&&K.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),s.measurements=this._measurements),we&&K.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),s}}const Fh={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},X9="finishReason",Ec=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class Q9 extends eM{constructor(e,n,r,i){super(i),this._pushActivity=e,this._popActivity=n,this.transactionSpanId=r}add(e){if(e.spanId!==this.transactionSpanId){const n=e.end;e.end=(...r)=>(this._popActivity(e.spanId),n.apply(e,r)),e.endTimestamp===void 0&&this._pushActivity(e.spanId)}super.add(e)}}class eH extends tM{constructor(e,n,r=Fh.idleTimeout,i=Fh.finalTimeout,s=Fh.heartbeatInterval,o=!1){super(e,n),this._idleHub=n,this._idleTimeout=r,this._finalTimeout=i,this._heartbeatInterval=s,this._onScope=o,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=Ec[4],o&&(we&&K.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`),n.getScope().setSpan(this)),this._restartIdleTimeout(),setTimeout(()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=Ec[3],this.end())},this._finalTimeout)}end(e=ic()){const n=Xb(e);if(this._finished=!0,this.activities={},this.op==="ui.action.click"&&this.setTag(X9,this._finishReason),this.spanRecorder){we&&K.log("[Tracing] finishing IdleTransaction",new Date(n*1e3).toISOString(),this.op);for(const r of this._beforeFinishCallbacks)r(this,e);this.spanRecorder.spans=this.spanRecorder.spans.filter(r=>{if(r.spanId===this.spanId)return!0;r.endTimestamp||(r.endTimestamp=n,r.setStatus("cancelled"),we&&K.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(r,void 0,2)));const i=r.startTimestamp<n,s=(this._finalTimeout+this._idleTimeout)/1e3,o=r.endTimestamp-this.startTimestamp<s;if(we){const a=JSON.stringify(r,void 0,2);i?o||K.log("[Tracing] discarding Span since it finished after Transaction final timeout",a):K.log("[Tracing] discarding Span since it happened after Transaction was finished",a)}return i&&o}),we&&K.log("[Tracing] flushing IdleTransaction")}else we&&K.log("[Tracing] No active IdleTransaction");if(this._onScope){const r=this._idleHub.getScope();r.getTransaction()===this&&r.setSpan(void 0)}return super.end(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){const n=i=>{this._finished||this._pushActivity(i)},r=i=>{this._finished||this._popActivity(i)};this.spanRecorder=new Q9(n,r,this.spanId,e),we&&K.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:n}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=n===!1,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,Object.keys(this.activities).length===0&&this._idleTimeoutCanceledPermanently&&(this._finishReason=Ec[5],this.end(e)))}setFinishReason(e){this._finishReason=e}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout(()=>{!this._finished&&Object.keys(this.activities).length===0&&(this._finishReason=Ec[1],this.end(e))},this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),we&&K.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,we&&K.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&(we&&K.log(`[Tracing] popActivity ${e}`),delete this.activities[e],we&&K.log("[Tracing] new activities count",Object.keys(this.activities).length)),Object.keys(this.activities).length===0){const n=ic();this._idleTimeoutCanceledPermanently?(this._finishReason=Ec[5],this.end(n)):this._restartIdleTimeout(n+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?(we&&K.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=Ec[0],this.end()):this._pingHeartbeat()}_pingHeartbeat(){we&&K.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout(()=>{this._beat()},this._heartbeatInterval)}}function nM(t,e,n,r,i,s){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,c={...e,event_id:e.event_id||n.event_id||Un(),timestamp:e.timestamp||Fm()},l=n.integrations||t.integrations.map(y=>y.name);tH(c,t),iH(c,l),e.type===void 0&&nH(c,t.stackParser);const u=oH(r,n.captureContext);n.mechanism&&Ud(c,n.mechanism);const d=i&&i.getEventProcessors?i.getEventProcessors():[],f=G9().getScopeData();if(s){const y=s.getScopeData();KC(f,y)}if(u){const y=u.getScopeData();KC(f,y)}const h=[...n.attachments||[],...f.attachments];h.length&&(n.attachments=h),ZN(c,f);const p=[...d,...Yb(),...f.eventProcessors];return Lp(p,c,n).then(y=>(y&&rH(y),typeof o=="number"&&o>0?sH(y,o,a):y))}function tH(t,e){const{environment:n,release:r,dist:i,maxValueLength:s=250}=e;"environment"in t||(t.environment="environment"in e?n:Kb),t.release===void 0&&r!==void 0&&(t.release=r),t.dist===void 0&&i!==void 0&&(t.dist=i),t.message&&(t.message=hl(t.message,s));const o=t.exception&&t.exception.values&&t.exception.values[0];o&&o.value&&(o.value=hl(o.value,s));const a=t.request;a&&a.url&&(a.url=hl(a.url,s))}const e1=new WeakMap;function nH(t,e){const n=Ke._sentryDebugIds;if(!n)return;let r;const i=e1.get(e);i?r=i:(r=new Map,e1.set(e,r));const s=Object.keys(n).reduce((o,a)=>{let c;const l=r.get(a);l?c=l:(c=e(a),r.set(a,c));for(let u=c.length-1;u>=0;u--){const d=c[u];if(d.filename){o[d.filename]=n[a];break}}return o},{});try{t.exception.values.forEach(o=>{o.stacktrace.frames.forEach(a=>{a.filename&&(a.debug_id=s[a.filename])})})}catch{}}function rH(t){const e={};try{t.exception.values.forEach(r=>{r.stacktrace.frames.forEach(i=>{i.debug_id&&(i.abs_path?e[i.abs_path]=i.debug_id:i.filename&&(e[i.filename]=i.debug_id),delete i.debug_id)})})}catch{}if(Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.keys(e).forEach(r=>{n.push({type:"sourcemap",code_file:r,debug_id:e[r]})})}function iH(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function sH(t,e,n){if(!t)return null;const r={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(i=>({...i,...i.data&&{data:Bi(i.data,e,n)}}))},...t.user&&{user:Bi(t.user,e,n)},...t.contexts&&{contexts:Bi(t.contexts,e,n)},...t.extra&&{extra:Bi(t.extra,e,n)}};return t.contexts&&t.contexts.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=Bi(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(i=>(i.data&&(i.data=Bi(i.data,e,n)),i))),r}function oH(t,e){if(!e)return t;const n=t?t.clone():new ss;return n.update(e),n}function aH(t){if(t)return cH(t)?{captureContext:t}:uH(t)?{captureContext:t}:t}function cH(t){return t instanceof ss||typeof t=="function"}const lH=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function uH(t){return Object.keys(t).some(e=>lH.includes(e))}function Um(t,e){return Wn().captureException(t,aH(e))}function rM(t,e){return Wn().captureEvent(t,e)}function fa(t,e){Wn().addBreadcrumb(t,e)}function dH(t,e){Wn().setContext(t,e)}function iM(t){return Wn().withScope(t)}function Mt(){return Wn().getClient()}function Sf(){return Wn().getScope()}function ew(t){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=Mt(),n=t||e&&e.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function sM(t,e,n){if(!ew(e))return t.sampled=!1,t;if(t.sampled!==void 0)return t.setMetadata({sampleRate:Number(t.sampled)}),t;let r;return typeof e.tracesSampler=="function"?(r=e.tracesSampler(n),t.setMetadata({sampleRate:Number(r)})):n.parentSampled!==void 0?r=n.parentSampled:typeof e.tracesSampleRate<"u"?(r=e.tracesSampleRate,t.setMetadata({sampleRate:Number(r)})):(r=1,t.setMetadata({sampleRate:r})),fH(r)?r?(t.sampled=Math.random()<r,t.sampled?(we&&K.log(`[Tracing] starting ${t.op} transaction - ${t.name}`),t):(we&&K.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(r)})`),t)):(we&&K.log(`[Tracing] Discarding transaction because ${typeof e.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),t.sampled=!1,t):(we&&K.warn("[Tracing] Discarding transaction because of invalid sample rate."),t.sampled=!1,t)}function fH(t){return _N(t)||!(typeof t=="number"||typeof t=="boolean")?(we&&K.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(t)} of type ${JSON.stringify(typeof t)}.`),!1):t<0||t>1?(we&&K.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${t}.`),!1):!0}function hH(){const e=this.getScope().getSpan();return e?{"sentry-trace":e.toTraceparent()}:{}}function pH(t,e){const n=this.getClient(),r=n&&n.getOptions()||{},i=r.instrumenter||"sentry",s=t.instrumenter||"sentry";i!==s&&(we&&K.error(`A transaction was started with instrumenter=\`${s}\`, but the SDK is configured with the \`${i}\` instrumenter.
The transaction will not be sampled. Please use the ${i} instrumentation to start transactions.`),t.sampled=!1);let o=new tM(t,this);return o=sM(o,r,{parentSampled:t.parentSampled,transactionContext:t,...e}),o.sampled&&o.initSpanRecorder(r._experiments&&r._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",o),o}function t1(t,e,n,r,i,s,o){const a=t.getClient(),c=a&&a.getOptions()||{};let l=new eH(e,t,n,r,o,i);return l=sM(l,c,{parentSampled:e.parentSampled,transactionContext:e,...s}),l.sampled&&l.initSpanRecorder(c._experiments&&c._experiments.maxSpans),a&&a.emit&&a.emit("startTransaction",l),l}function mH(){const t=vf();t.__SENTRY__&&(t.__SENTRY__.extensions=t.__SENTRY__.extensions||{},t.__SENTRY__.extensions.startTransaction||(t.__SENTRY__.extensions.startTransaction=pH),t.__SENTRY__.extensions.traceHeaders||(t.__SENTRY__.extensions.traceHeaders=hH),K9())}function gH(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function vH(t,e,n,r){const i=Zb(n),s={sent_at:new Date().toISOString(),...i&&{sdk:i},...!!r&&e&&{dsn:cu(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return pc(s,[o])}function yH(t,e,n,r){const i=Zb(n),s=t.type&&t.type!=="replay_event"?t.type:"event";gH(t,n&&n.sdk);const o=GN(t,i,r,e);return delete t.sdkProcessingMetadata,pc(o,[[{type:s},t]])}const SH="7";function oM(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function bH(t){return`${oM(t)}${t.projectId}/envelope/`}function wH(t,e){return U$({sentry_key:t.publicKey,sentry_version:SH,...e&&{sentry_client:`${e.name}/${e.version}`}})}function kH(t,e={}){const n=typeof e=="string"?e:e.tunnel,r=typeof e=="string"||!e._metadata?void 0:e._metadata.sdk;return n||`${bH(t)}?${wH(t,r)}`}function EH(t,e){const n=NN(t);if(!n)return"";const r=`${oM(n)}embed/error-page/`;let i=`dsn=${cu(n)}`;for(const s in e)if(s!=="dsn"&&s!=="onClose")if(s==="user"){const o=e.user;if(!o)continue;o.name&&(i+=`&name=${encodeURIComponent(o.name)}`),o.email&&(i+=`&email=${encodeURIComponent(o.email)}`)}else i+=`&${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`;return`${r}?${i}`}const n1=[];function CH(t){const e={};return t.forEach(n=>{const{name:r}=n,i=e[r];i&&!i.isDefaultInstance&&n.isDefaultInstance||(e[r]=n)}),Object.keys(e).map(n=>e[n])}function TH(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(o=>{o.isDefaultInstance=!0});let r;Array.isArray(n)?r=[...e,...n]:typeof n=="function"?r=FN(n(e)):r=e;const i=CH(r),s=IH(i,o=>o.name==="Debug");if(s!==-1){const[o]=i.splice(s,1);i.push(o)}return i}function _H(t,e){const n={};return e.forEach(r=>{r&&aM(t,r,n)}),n}function aM(t,e,n){if(n[e.name]=e,n1.indexOf(e.name)===-1&&(e.setupOnce(L9,Wn),n1.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),t.on&&typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(i,s)=>r(i,s,t))}if(t.addEventProcessor&&typeof e.processEvent=="function"){const r=e.processEvent.bind(e),i=Object.assign((s,o)=>r(s,o,t),{id:e.name});t.addEventProcessor(i)}we&&K.log(`Integration installed: ${e.name}`)}function IH(t,e){for(let n=0;n<t.length;n++)if(e(t[n])===!0)return n;return-1}function ka(t,e){return Object.assign(function(...r){return{setupOnce:()=>{},...e(...r)}},{id:t})}function RH(t){let e="";for(const n of t){const r=Object.entries(n.tags),i=r.length>0?`|#${r.map(([s,o])=>`${s}:${o}`).join(",")}`:"";e+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${i}|T${n.timestamp}
`}return e}function PH(t,e,n,r){const i={sent_at:new Date().toISOString()};n&&n.sdk&&(i.sdk={name:n.sdk.name,version:n.sdk.version}),r&&e&&(i.dsn=cu(e));const s=AH(t);return pc(i,[s])}function AH(t){const e=RH(t);return[{type:"statsd",length:e.length},e]}const r1="Not capturing exception because it's already been captured.";class NH{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=NN(e.dsn):we&&K.warn("No DSN provided, client will not send events."),this._dsn){const n=kH(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}}captureException(e,n,r){if(WC(e)){we&&K.log(r1);return}let i=n&&n.event_id;return this._process(this.eventFromException(e,n).then(s=>this._captureEvent(s,n,r)).then(s=>{i=s})),i}captureMessage(e,n,r,i){let s=r&&r.event_id;const o=Vb(e)?this.eventFromMessage(String(e),n,r):this.eventFromException(e,r);return this._process(o.then(a=>this._captureEvent(a,r,i)).then(a=>{s=a})),s}captureEvent(e,n,r){if(n&&n.originalException&&WC(n.originalException)){we&&K.log(r1);return}let i=n&&n.event_id;return this._process(this._captureEvent(e,n,r).then(s=>{i=s})),i}captureSession(e){typeof e.release!="string"?we&&K.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),Bl(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(e).then(r=>n.flush(e).then(i=>r&&i))):Fl(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&(this._integrations=_H(this,this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch{return we&&K.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){aM(this,e,this._integrations)}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=yH(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])r=I9(r,A9(s,this._options.transportOptions&&this._options.transportOptions.textEncoder));const i=this._sendEnvelope(r);i&&i.then(s=>this.emit("afterSendEvent",e,s),null)}sendSession(e){const n=vH(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}recordDroppedEvent(e,n,r){if(this._options.sendClientReports){const i=`${e}:${n}`;we&&K.log(`Adding outcome: "${i}"`),this._outcomes[i]=this._outcomes[i]+1||1}}captureAggregateMetrics(e){we&&K.log(`Flushing aggregated metrics, number of metrics: ${e.length}`);const n=PH(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}on(e,n){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(n)}emit(e,...n){this._hooks[e]&&this._hooks[e].forEach(r=>r(...n))}_updateSessionFromEvent(e,n){let r=!1,i=!1;const s=n.exception&&n.exception.values;if(s){i=!0;for(const c of s){const l=c.mechanism;if(l&&l.handled===!1){r=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&(Bl(e,{...r&&{status:"crashed"},errors:e.errors||Number(i||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Cr(n=>{let r=0;const i=1,s=setInterval(()=>{this._numProcessing==0?(clearInterval(s),n(!0)):(r+=i,e&&r>=e&&(clearInterval(s),n(!1)))},i)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r,i=XN()){const s=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&o.length>0&&(n.integrations=o),this.emit("preprocessEvent",e,n),nM(s,e,n,r,this,i).then(a=>{if(a===null)return a;const{propagationContext:c}=a.sdkProcessingMetadata||{};if(!(a.contexts&&a.contexts.trace)&&c){const{traceId:u,spanId:d,parentSpanId:f,dsc:h}=c;a.contexts={trace:{trace_id:u,span_id:d,parent_span_id:f},...a.contexts};const p=h||Bm(u,this,r);a.sdkProcessingMetadata={dynamicSamplingContext:p,...a.sdkProcessingMetadata}}return a})}_captureEvent(e,n={},r){return this._processEvent(e,n,r).then(i=>i.event_id,i=>{if(we){const s=i;s.logLevel==="log"?K.log(s.message):K.warn(s)}})}_processEvent(e,n,r){const i=this.getOptions(),{sampleRate:s}=i,o=lM(e),a=cM(e),c=e.type||"error",l=`before send for type \`${c}\``;if(a&&typeof s=="number"&&Math.random()>s)return this.recordDroppedEvent("sample_rate","error",e),qb(new Wi(`Discarding event because it's not included in the random sample (sampling rate = ${s})`,"log"));const u=c==="replay_event"?"replay":c;return this._prepareEvent(e,n,r).then(d=>{if(d===null)throw this.recordDroppedEvent("event_processor",u,e),new Wi("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return d;const h=xH(i,d,n);return MH(h,l)}).then(d=>{if(d===null)throw this.recordDroppedEvent("before_send",u,e),new Wi(`${l} returned \`null\`, will not send event.`,"log");const f=r&&r.getSession();!o&&f&&this._updateSessionFromEvent(f,d);const h=d.transaction_info;if(o&&h&&d.transaction!==e.transaction){const p="custom";d.transaction_info={...h,source:p}}return this.sendEvent(d,n),d}).then(null,d=>{throw d instanceof Wi?d:(this.captureException(d,{data:{__sentry__:!0},originalException:d}),new Wi(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${d}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,n=>{we&&K.error("Error while sending event:",n)});we&&K.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map(n=>{const[r,i]=n.split(":");return{reason:r,category:i,quantity:e[n]}})}}function MH(t,e){const n=`${e} must return \`null\` or a valid event.`;if(zb(t))return t.then(r=>{if(!Ll(r)&&r!==null)throw new Wi(n);return r},r=>{throw new Wi(`${e} rejected with ${r}`)});if(!Ll(t)&&t!==null)throw new Wi(n);return t}function xH(t,e,n){const{beforeSend:r,beforeSendTransaction:i}=t;return cM(e)&&r?r(e,n):lM(e)&&i?i(e,n):e}function cM(t){return t.type===void 0}function lM(t){return t.type==="transaction"}function OH(t){const e=Mt();!e||!e.addEventProcessor||e.addEventProcessor(t)}function DH(t,e){e.debug===!0&&(we?K.enable():rc(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")}));const n=Wn();n.getScope().update(e.initialScope);const i=new t(e);n.bindClient(i)}const LH=30;function uM(t,e,n=m9(t.bufferSize||LH)){let r={};const i=o=>n.drain(o);function s(o){const a=[];if(JC(o,(d,f)=>{const h=ZC(f);if(qN(r,h)){const p=i1(d,f);t.recordDroppedEvent("ratelimit_backoff",h,p)}else a.push(d)}),a.length===0)return Fl();const c=pc(o[0],a),l=d=>{JC(c,(f,h)=>{const p=i1(f,h);t.recordDroppedEvent(d,ZC(h),p)})},u=()=>e({body:R9(c,t.textEncoder)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&we&&K.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=JN(r,d),d),d=>{throw l("network_error"),d});return n.add(u).then(d=>d,d=>{if(d instanceof Wi)return we&&K.error("Skipped sending event because buffer is full."),l("queue_overflow"),Fl();throw d})}return s.__sentry__baseTransport__=!0,{send:s,flush:i}}function i1(t,e){if(!(e!=="event"&&e!=="transaction"))return Array.isArray(t)?t[1]:void 0}let s1;const dM="FunctionToString",FH=()=>({name:dM,setupOnce(){s1=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=$b(this)||this;return s1.apply(e,t)}}catch{}}}),BH=ka(dM,FH),UH=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],jH=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],fM="InboundFilters",WH=t=>({name:fM,processEvent(e,n,r){const i=r.getOptions(),s=zH(t,i);return $H(e,s)?null:e}}),VH=ka(fM,WH);function zH(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:UH],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[],...t.disableTransactionDefaults?[]:jH],ignoreInternal:t.ignoreInternal!==void 0?t.ignoreInternal:!0}}function $H(t,e){return e.ignoreInternal&&KH(t)?(we&&K.warn(`Event dropped due to being internal Sentry Error.
Event: ${Do(t)}`),!0):HH(t,e.ignoreErrors)?(we&&K.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Do(t)}`),!0):GH(t,e.ignoreTransactions)?(we&&K.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Do(t)}`),!0):qH(t,e.denyUrls)?(we&&K.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Do(t)}.
Url: ${Fp(t)}`),!0):JH(t,e.allowUrls)?!1:(we&&K.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Do(t)}.
Url: ${Fp(t)}`),!0)}function HH(t,e){return t.type||!e||!e.length?!1:ZH(t).some(n=>ou(n,e))}function GH(t,e){if(t.type!=="transaction"||!e||!e.length)return!1;const n=t.transaction;return n?ou(n,e):!1}function qH(t,e){if(!e||!e.length)return!1;const n=Fp(t);return n?ou(n,e):!1}function JH(t,e){if(!e||!e.length)return!0;const n=Fp(t);return n?ou(n,e):!0}function ZH(t){const e=[];t.message&&e.push(t.message);let n;try{n=t.exception.values[t.exception.values.length-1]}catch{}return n&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`)),we&&e.length===0&&K.error(`Could not extract message for event ${Do(t)}`),e}function KH(t){try{return t.exception.values[0].type==="SentryError"}catch{}return!1}function YH(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Fp(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?YH(e):null}catch{return we&&K.error(`Cannot extract url for event ${Do(t)}`),null}}function XH(t,e){const n=e&&tG(e)?e.getClient():e,r=n&&n.getDsn(),i=n&&n.getOptions().tunnel;return eG(t,r)||QH(t,i)}function QH(t,e){return e?o1(t)===o1(e):!1}function eG(t,e){return e?t.includes(e.host):!1}function o1(t){return t[t.length-1]==="/"?t.slice(0,-1):t}function tG(t){return t.getClient!==void 0}const Ge=Ke;let j0=0;function hM(){return j0>0}function nG(){j0++,setTimeout(()=>{j0--})}function Ul(t,e={},n){if(typeof t!="function")return t;try{const i=t.__sentry_wrapped__;if(i)return i;if($b(t))return t}catch{return t}const r=function(){const i=Array.prototype.slice.call(arguments);try{n&&typeof n=="function"&&n.apply(this,arguments);const s=i.map(o=>Ul(o,e));return t.apply(this,s)}catch(s){throw nG(),iM(o=>{o.addEventProcessor(a=>(e.mechanism&&(I0(a,void 0,void 0),Ud(a,e.mechanism)),a.extra={...a.extra,arguments:i},a)),Um(s)}),s}};try{for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}catch{}MN(r,t),Bd(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch{}return r}const zr=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function pM(t,e){const n=tw(t,e),r={type:e&&e.name,value:oG(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function rG(t,e,n,r){const i=Mt(),s=i&&i.getOptions().normalizeDepth,o={exception:{values:[{type:Om(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:lG(e,{isUnhandledRejection:r})}]},extra:{__serialized__:zN(e,s)}};if(n){const a=tw(t,n);a.length&&(o.exception.values[0].stacktrace={frames:a})}return o}function fv(t,e){return{exception:{values:[pM(t,e)]}}}function tw(t,e){const n=e.stacktrace||e.stack||"",r=sG(e);try{return t(n,r)}catch{}return[]}const iG=/Minified React error #\d+;/i;function sG(t){if(t){if(typeof t.framesToPop=="number")return t.framesToPop;if(iG.test(t.message))return 1}return 0}function oG(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function aG(t,e,n,r){const i=n&&n.syntheticException||void 0,s=nw(t,e,i,r);return Ud(s),s.level="error",n&&n.event_id&&(s.event_id=n.event_id),Fl(s)}function cG(t,e,n="info",r,i){const s=r&&r.syntheticException||void 0,o=W0(t,e,s,i);return o.level=n,r&&r.event_id&&(o.event_id=r.event_id),Fl(o)}function nw(t,e,n,r,i){let s;if(Wb(e)&&e.error)return fv(t,e.error);if(MC(e)||k$(e)){const o=e;if("stack"in e)s=fv(t,e);else{const a=o.name||(MC(o)?"DOMError":"DOMException"),c=o.message?`${a}: ${o.message}`:a;s=W0(t,c,n,r),I0(s,c)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":`${o.code}`}),s}return jb(e)?fv(t,e):Ll(e)||Om(e)?(s=rG(t,e,n,i),Ud(s,{synthetic:!0}),s):(s=W0(t,e,n,r),I0(s,`${e}`,void 0),Ud(s,{synthetic:!0}),s)}function W0(t,e,n,r){const i={message:e};if(r&&n){const s=tw(t,n);s.length&&(i.exception={values:[{value:e,stacktrace:{frames:s}}]})}return i}function lG(t,{isUnhandledRejection:e}){const n=j$(t),r=e?"promise rejection":"exception";return Wb(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:Om(t)?`Event \`${uG(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function uG(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function dG(t,{metadata:e,tunnel:n,dsn:r}){const i={event_id:t.event_id,sent_at:new Date().toISOString(),...e&&e.sdk&&{sdk:{name:e.sdk.name,version:e.sdk.version}},...!!n&&!!r&&{dsn:cu(r)}},s=fG(t);return pc(i,[s])}function fG(t){return[{type:"user_report"},t]}class hG extends NH{constructor(e){const n=Ge.SENTRY_SDK_SOURCE||a9();e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${n}:@sentry/browser`,version:jd}],version:jd},super(e),e.sendClientReports&&Ge.document&&Ge.document.addEventListener("visibilitychange",()=>{Ge.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,n){return aG(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return cG(this._options.stackParser,e,n,r,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled()){zr&&K.warn("SDK not enabled, will not capture user feedback.");return}const n=dG(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(n)}_prepareEvent(e,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r)}_flushOutcomes(){const e=this._clearOutcomes();if(e.length===0){zr&&K.log("No outcomes to send");return}if(!this._dsn){zr&&K.log("No dsn provided, will not send outcomes");return}zr&&K.log("Sending outcomes:",e);const n=M9(e,this._options.tunnel&&cu(this._dsn));this._sendEnvelope(n)}}let ju;function pG(){if(ju)return ju;if(N0(Ge.fetch))return ju=Ge.fetch.bind(Ge);const t=Ge.document;let e=Ge.fetch;if(t&&typeof t.createElement=="function")try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n);const r=n.contentWindow;r&&r.fetch&&(e=r.fetch),t.head.removeChild(n)}catch(n){zr&&K.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return ju=e.bind(Ge)}function mG(){ju=void 0}function gG(t,e=pG()){let n=0,r=0;function i(s){const o=s.body.length;n+=o,r++;const a={body:s.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};try{return e(t.url,a).then(c=>(n-=o,r--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return mG(),n-=o,r--,qb(c)}}return uM(t,i)}const vG=4;function yG(t){function e(n){return new Cr((r,i)=>{const s=new XMLHttpRequest;s.onerror=i,s.onreadystatechange=()=>{s.readyState===vG&&r({statusCode:s.status,headers:{"x-sentry-rate-limits":s.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":s.getResponseHeader("Retry-After")}})},s.open("POST",t.url);for(const o in t.headers)Object.prototype.hasOwnProperty.call(t.headers,o)&&s.setRequestHeader(o,t.headers[o]);s.send(n.body)})}return uM(t,e)}const jm="?",SG=30,bG=40,wG=50;function rw(t,e,n,r){const i={filename:t,function:e,in_app:!0};return n!==void 0&&(i.lineno=n),r!==void 0&&(i.colno=r),i}const kG=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,EG=/\((\S*)(?::(\d+))(?::(\d+))\)/,CG=t=>{const e=kG.exec(t);if(e){if(e[2]&&e[2].indexOf("eval")===0){const s=EG.exec(e[2]);s&&(e[2]=s[1],e[3]=s[2],e[4]=s[3])}const[r,i]=mM(e[1]||jm,e[2]);return rw(i,r,e[3]?+e[3]:void 0,e[4]?+e[4]:void 0)}},TG=[SG,CG],_G=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,IG=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,RG=t=>{const e=_G.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const s=IG.exec(e[3]);s&&(e[1]=e[1]||"eval",e[3]=s[1],e[4]=s[2],e[5]="")}let r=e[3],i=e[1]||jm;return[i,r]=mM(i,r),rw(r,i,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},PG=[wG,RG],AG=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,NG=t=>{const e=AG.exec(t);return e?rw(e[2],e[1]||jm,+e[3],e[4]?+e[4]:void 0):void 0},MG=[bG,NG],xG=[TG,PG,MG],OG=DN(...xG),mM=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:jm,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},gM="GlobalHandlers",DG=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:gM,setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&(FG(n),a1("onerror")),e.onunhandledrejection&&(BG(n),a1("onunhandledrejection"))}}},LG=ka(gM,DG);function FG(t){jN(e=>{const{stackParser:n,attachStacktrace:r}=yM();if(Mt()!==t||hM())return;const{msg:i,url:s,line:o,column:a,error:c}=e,l=c===void 0&&ls(i)?WG(i,s,o,a):vM(nw(n,c||i,void 0,r,!1),s,o,a);l.level="error",rM(l,{originalException:c,mechanism:{handled:!1,type:"onerror"}})})}function BG(t){WN(e=>{const{stackParser:n,attachStacktrace:r}=yM();if(Mt()!==t||hM())return;const i=UG(e),s=Vb(i)?jG(i):nw(n,i,void 0,r,!0);s.level="error",rM(s,{originalException:i,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function UG(t){if(Vb(t))return t;const e=t;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return t}function jG(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function WG(t,e,n,r){const i=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let s=Wb(t)?t.message:t,o="Error";const a=s.match(i);return a&&(o=a[1],s=a[2]),vM({exception:{values:[{type:o,value:s}]}},e,n,r)}function vM(t,e,n,r){const i=t.exception=t.exception||{},s=i.values=i.values||[],o=s[0]=s[0]||{},a=o.stacktrace=o.stacktrace||{},c=a.frames=a.frames||[],l=isNaN(parseInt(r,10))?void 0:r,u=isNaN(parseInt(n,10))?void 0:n,d=ls(e)&&e.length>0?e:N$();return c.length===0&&c.push({colno:l,filename:d,function:"?",in_app:!0,lineno:u}),t}function a1(t){zr&&K.log(`Global Handler attached: ${t}`)}function yM(){const t=Mt();return t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const VG=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],SM="TryCatch",zG=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t};return{name:SM,setupOnce(){e.setTimeout&&gn(Ge,"setTimeout",c1),e.setInterval&&gn(Ge,"setInterval",c1),e.requestAnimationFrame&&gn(Ge,"requestAnimationFrame",HG),e.XMLHttpRequest&&"XMLHttpRequest"in Ge&&gn(XMLHttpRequest.prototype,"send",GG);const n=e.eventTarget;n&&(Array.isArray(n)?n:VG).forEach(qG)}}},$G=ka(SM,zG);function c1(t){return function(...e){const n=e[0];return e[0]=Ul(n,{mechanism:{data:{function:uo(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function HG(t){return function(e){return t.apply(this,[Ul(e,{mechanism:{data:{function:"requestAnimationFrame",handler:uo(t)},handled:!1,type:"instrument"}})])}}function GG(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(i=>{i in n&&typeof n[i]=="function"&&gn(n,i,function(s){const o={mechanism:{data:{function:i,handler:uo(s)},handled:!1,type:"instrument"}},a=$b(s);return a&&(o.mechanism.data.handler=uo(a)),Ul(s,o)})}),t.apply(this,e)}}function qG(t){const e=Ge,n=e[t]&&e[t].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(gn(n,"addEventListener",function(r){return function(i,s,o){try{typeof s.handleEvent=="function"&&(s.handleEvent=Ul(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:uo(s),target:t},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[i,Ul(s,{mechanism:{data:{function:"addEventListener",handler:uo(s),target:t},handled:!1,type:"instrument"}}),o])}}),gn(n,"removeEventListener",function(r){return function(i,s,o){const a=s;try{const c=a&&a.__sentry_wrapped__;c&&r.call(this,i,c,o)}catch{}return r.call(this,i,a,o)}}))}const nh=1024,bM="Breadcrumbs",JG=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:bM,setup(n){e.console&&z$(XG(n)),e.dom&&BN(YG(n,e.dom)),e.xhr&&Gb(QG(n)),e.fetch&&Hb(eq(n)),e.history&&Lm(tq(n)),e.sentry&&n.on&&n.on("beforeSendEvent",KG(n))}}},ZG=ka(bM,JG);function KG(t){return function(n){Mt()===t&&fa({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:Do(n)},{event:n})}}function YG(t,e){return function(r){if(Mt()!==t)return;let i,s,o=typeof e=="object"?e.serializeAttribute:void 0,a=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;a&&a>nh&&(zr&&K.warn(`\`dom.maxStringLength\` cannot exceed ${nh}, but a value of ${a} was configured. Sentry will use ${nh} instead.`),a=nh),typeof o=="string"&&(o=[o]);try{const l=r.event,u=nq(l)?l.target:l;i=nc(u,{keyAttrs:o,maxStringLength:a}),s=PN(u)}catch{i="<unknown>"}if(i.length===0)return;const c={category:`ui.${r.name}`,message:i};s&&(c.data={"ui.component_name":s}),fa(c,{event:r.event,name:r.name,global:r.global})}}function XG(t){return function(n){if(Mt()!==t)return;const r={category:"console",data:{arguments:n.args,logger:"console"},level:v9(n.level),message:xC(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)r.message=`Assertion failed: ${xC(n.args.slice(1)," ")||"console.assert"}`,r.data.arguments=n.args.slice(1);else return;fa(r,{input:n.args,level:n.level})}}function QG(t){return function(n){if(Mt()!==t)return;const{startTimestamp:r,endTimestamp:i}=n,s=n.xhr[Ho];if(!r||!i||!s)return;const{method:o,url:a,status_code:c,body:l}=s,u={method:o,url:a,status_code:c},d={xhr:n.xhr,input:l,startTimestamp:r,endTimestamp:i};fa({category:"xhr",data:u,type:"http"},d)}}function eq(t){return function(n){if(Mt()!==t)return;const{startTimestamp:r,endTimestamp:i}=n;if(i&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.error){const s=n.fetchData,o={data:n.error,input:n.args,startTimestamp:r,endTimestamp:i};fa({category:"fetch",data:s,level:"error",type:"http"},o)}else{const s=n.response,o={...n.fetchData,status_code:s&&s.status},a={input:n.args,response:s,startTimestamp:r,endTimestamp:i};fa({category:"fetch",data:o,type:"http"},a)}}}function tq(t){return function(n){if(Mt()!==t)return;let r=n.from,i=n.to;const s=lv(Ge.location.href);let o=r?lv(r):void 0;const a=lv(i);(!o||!o.path)&&(o=s),s.protocol===a.protocol&&s.host===a.host&&(i=a.relative),s.protocol===o.protocol&&s.host===o.host&&(r=o.relative),fa({category:"navigation",data:{from:r,to:i}})}}function nq(t){return!!t&&!!t.target}const rq="cause",iq=5,wM="LinkedErrors",sq=(t={})=>{const e=t.limit||iq,n=t.key||rq;return{name:wM,preprocessEvent(r,i,s){const o=s.getOptions();I$(pM,o.stackParser,o.maxValueLength,n,e,r,i)}}},oq=ka(wM,sq),kM="HttpContext",aq=()=>({name:kM,preprocessEvent(t){if(!Ge.navigator&&!Ge.location&&!Ge.document)return;const e=t.request&&t.request.url||Ge.location&&Ge.location.href,{referrer:n}=Ge.document||{},{userAgent:r}=Ge.navigator||{},i={...t.request&&t.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},s={...t.request,...e&&{url:e},headers:i};t.request=s}}),cq=ka(kM,aq),EM="Dedupe",lq=()=>{let t;return{name:EM,processEvent(e){if(e.type)return e;try{if(dq(e,t))return zr&&K.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}},uq=ka(EM,lq);function dq(t,e){return e?!!(fq(t,e)||hq(t,e)):!1}function fq(t,e){const n=t.message,r=e.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!TM(t,e)||!CM(t,e))}function hq(t,e){const n=l1(e),r=l1(t);return!(!n||!r||n.type!==r.type||n.value!==r.value||!TM(t,e)||!CM(t,e))}function CM(t,e){let n=u1(t),r=u1(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let i=0;i<r.length;i++){const s=r[i],o=n[i];if(s.filename!==o.filename||s.lineno!==o.lineno||s.colno!==o.colno||s.function!==o.function)return!1}return!0}function TM(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function l1(t){return t.exception&&t.exception.values&&t.exception.values[0]}function u1(t){const e=t.exception;if(e)try{return e.values[0].stacktrace.frames}catch{return}}const pq=[new VH,new BH,new $G,new ZG,new LG,new oq,new uq,new cq];function mq(t={}){t.defaultIntegrations===void 0&&(t.defaultIntegrations=pq),t.release===void 0&&(typeof __SENTRY_RELEASE__=="string"&&(t.release=__SENTRY_RELEASE__),Ge.SENTRY_RELEASE&&Ge.SENTRY_RELEASE.id&&(t.release=Ge.SENTRY_RELEASE.id)),t.autoSessionTracking===void 0&&(t.autoSessionTracking=!0),t.sendClientReports===void 0&&(t.sendClientReports=!0);const e={...t,stackParser:W$(t.stackParser||OG),integrations:TH(t),transport:t.transport||(UN()?gG:yG)};DH(hG,e),t.autoSessionTracking&&gq()}function d1(t={},e=Wn()){if(!Ge.document){zr&&K.error("Global document not defined in showReportDialog call");return}const{client:n,scope:r}=e.getStackTop(),i=t.dsn||n&&n.getDsn();if(!i){zr&&K.error("DSN not configured for showReportDialog call");return}r&&(t.user={...r.getUser(),...t.user}),t.eventId||(t.eventId=e.lastEventId());const s=Ge.document.createElement("script");s.async=!0,s.crossOrigin="anonymous",s.src=EH(i,t),t.onLoad&&(s.onload=t.onLoad);const{onClose:o}=t;if(o){const c=l=>{if(l.data==="__sentry_reportdialog_closed__")try{o()}finally{Ge.removeEventListener("message",c)}};Ge.addEventListener("message",c)}const a=Ge.document.head||Ge.document.body;a?a.appendChild(s):zr&&K.error("Not injecting report dialog. No injection point found in HTML")}function f1(t){t.startSession({ignoreDuration:!0}),t.captureSession()}function gq(){if(typeof Ge.document>"u"){zr&&K.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}const t=Wn();t.captureSession&&(f1(t),Lm(({from:e,to:n})=>{e!==void 0&&e!==n&&f1(Wn())}))}const Rt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,at=Ke;function vq(){at&&at.document?at.document.addEventListener("visibilitychange",()=>{const t=yf();if(at.document.hidden&&t){const e="cancelled";Rt&&K.log(`[Tracing] Transaction: ${e} -> since tab moved to the background, op: ${t.op}`),t.status||t.setStatus(e),t.setTag("visibilitychange","document.hidden"),t.end()}}):Rt&&K.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const iw=(t,e,n)=>{let r,i;return s=>{e.value>=0&&(s||n)&&(i=e.value-(r||0),(i||r===void 0)&&(r=e.value,e.delta=i,t(e)))}},yq=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,Sq=()=>{const t=at.performance.timing,e=at.performance.navigation.type,n={entryType:"navigation",startTime:0,type:e==2?"back_forward":e===1?"reload":"navigate"};for(const r in t)r!=="navigationStart"&&r!=="toJSON"&&(n[r]=Math.max(t[r]-t.navigationStart,0));return n},_M=()=>at.__WEB_VITALS_POLYFILL__?at.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||Sq()):at.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],IM=()=>{const t=_M();return t&&t.activationStart||0},sw=(t,e)=>{const n=_M();let r="navigate";return n&&(at.document.prerendering||IM()>0?r="prerender":r=n.type.replace(/_/g,"-")),{name:t,value:typeof e>"u"?-1:e,rating:"good",delta:0,entries:[],id:yq(),navigationType:r}},Wm=(t,e,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(i=>{e(i.getEntries())});return r.observe(Object.assign({type:t,buffered:!0},n||{})),r}}catch{}},Vm=(t,e)=>{const n=r=>{(r.type==="pagehide"||at.document.visibilityState==="hidden")&&(t(r),e&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},bq=t=>{const e=sw("CLS",0);let n,r=0,i=[];const s=a=>{a.forEach(c=>{if(!c.hadRecentInput){const l=i[0],u=i[i.length-1];r&&i.length!==0&&c.startTime-u.startTime<1e3&&c.startTime-l.startTime<5e3?(r+=c.value,i.push(c)):(r=c.value,i=[c]),r>e.value&&(e.value=r,e.entries=i,n&&n())}})},o=Wm("layout-shift",s);if(o){n=iw(t,e);const a=()=>{s(o.takeRecords()),n(!0)};return Vm(a),a}};let Bh=-1;const wq=()=>at.document.visibilityState==="hidden"&&!at.document.prerendering?0:1/0,kq=()=>{Vm(({timeStamp:t})=>{Bh=t},!0)},ow=()=>(Bh<0&&(Bh=wq(),kq()),{get firstHiddenTime(){return Bh}}),Eq=t=>{const e=ow(),n=sw("FID");let r;const i=a=>{a.startTime<e.firstHiddenTime&&(n.value=a.processingStart-a.startTime,n.entries.push(a),r(!0))},s=a=>{a.forEach(i)},o=Wm("first-input",s);r=iw(t,n),o&&Vm(()=>{s(o.takeRecords()),o.disconnect()},!0)},h1={},Cq=t=>{const e=ow(),n=sw("LCP");let r;const i=o=>{const a=o[o.length-1];if(a){const c=Math.max(a.startTime-IM(),0);c<e.firstHiddenTime&&(n.value=c,n.entries=[a],r())}},s=Wm("largest-contentful-paint",i);if(s){r=iw(t,n);const o=()=>{h1[n.id]||(i(s.takeRecords()),s.disconnect(),h1[n.id]=!0,r(!0))};return["keydown","click"].forEach(a=>{addEventListener(a,o,{once:!0,capture:!0})}),Vm(o,!0),o}},nd={},Bp={};let RM,PM,AM;function Tq(t){return aw("cls",t,Iq,RM)}function NM(t){return aw("lcp",t,Pq,AM)}function _q(t){return aw("fid",t,Rq,PM)}function zm(t,e){return MM(t,e),Bp[t]||(Aq(t),Bp[t]=!0),xM(t,e)}function $m(t,e){const n=nd[t];if(!(!n||!n.length))for(const r of n)try{r(e)}catch(i){Rt&&K.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${uo(r)}
Error:`,i)}}function Iq(){bq(t=>{$m("cls",{metric:t}),RM=t})}function Rq(){Eq(t=>{$m("fid",{metric:t}),PM=t})}function Pq(){Cq(t=>{$m("lcp",{metric:t}),AM=t})}function aw(t,e,n,r){return MM(t,e),Bp[t]||(n(),Bp[t]=!0),r&&e({metric:r}),xM(t,e)}function Aq(t){const e={};t==="event"&&(e.durationThreshold=0),Wm(t,n=>{$m(t,{entries:n})},e)}function MM(t,e){nd[t]=nd[t]||[],nd[t].push(e)}function xM(t,e){return()=>{const n=nd[t];if(!n)return;const r=n.indexOf(e);r!==-1&&n.splice(r,1)}}function hv(t){return typeof t=="number"&&isFinite(t)}function jl(t,{startTimestamp:e,...n}){return e&&t.startTimestamp>e&&(t.startTimestamp=e),t.startChild({startTimestamp:e,...n})}const Nq=2147483647;function tn(t){return t/1e3}function OM(){return at&&at.addEventListener&&at.performance}let p1=0,Ot={},Oi,rd;function Mq(){const t=OM();if(t&&Ii){t.mark&&at.performance.mark("sentry-tracing-init");const e=Fq(),n=Dq(),r=Lq();return()=>{e(),n(),r()}}return()=>{}}function xq(){zm("longtask",({entries:t})=>{for(const e of t){const n=yf();if(!n)return;const r=tn(Ii+e.startTime),i=tn(e.duration);n.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i})}})}function Oq(){zm("event",({entries:t})=>{for(const e of t){const n=yf();if(!n)return;if(e.name==="click"){const r=tn(Ii+e.startTime),i=tn(e.duration),s={description:nc(e.target),op:`ui.interaction.${e.name}`,origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i},o=PN(e.target);o&&(s.data={"ui.component_name":o}),n.startChild(s)}}})}function Dq(){return Tq(({metric:t})=>{const e=t.entries.pop();e&&(Rt&&K.log("[Measurements] Adding CLS"),Ot.cls={value:t.value,unit:""},rd=e)})}function Lq(){return NM(({metric:t})=>{const e=t.entries.pop();e&&(Rt&&K.log("[Measurements] Adding LCP"),Ot.lcp={value:t.value,unit:"millisecond"},Oi=e)})}function Fq(){return _q(({metric:t})=>{const e=t.entries.pop();if(!e)return;const n=tn(Ii),r=tn(e.startTime);Rt&&K.log("[Measurements] Adding FID"),Ot.fid={value:t.value,unit:"millisecond"},Ot["mark.fid"]={value:n+r,unit:"second"}})}function Bq(t){const e=OM();if(!e||!at.performance.getEntries||!Ii)return;Rt&&K.log("[Tracing] Adding & adjusting spans using Performance API");const n=tn(Ii),r=e.getEntries();let i,s;if(r.slice(p1).forEach(o=>{const a=tn(o.startTime),c=tn(o.duration);if(!(t.op==="navigation"&&n+a<t.startTimestamp))switch(o.entryType){case"navigation":{jq(t,o,n),i=n+tn(o.responseStart),s=n+tn(o.requestStart);break}case"mark":case"paint":case"measure":{Uq(t,o,a,c,n);const l=ow(),u=o.startTime<l.firstHiddenTime;o.name==="first-paint"&&u&&(Rt&&K.log("[Measurements] Adding FP"),Ot.fp={value:o.startTime,unit:"millisecond"}),o.name==="first-contentful-paint"&&u&&(Rt&&K.log("[Measurements] Adding FCP"),Ot.fcp={value:o.startTime,unit:"millisecond"});break}case"resource":{const l=o.name.replace(at.location.origin,"");Vq(t,o,l,a,c,n);break}}}),p1=Math.max(r.length-1,0),zq(t),t.op==="pageload"){typeof i=="number"&&(Rt&&K.log("[Measurements] Adding TTFB"),Ot.ttfb={value:(i-t.startTimestamp)*1e3,unit:"millisecond"},typeof s=="number"&&s<=i&&(Ot["ttfb.requestTime"]={value:(i-s)*1e3,unit:"millisecond"})),["fcp","fp","lcp"].forEach(a=>{if(!Ot[a]||n>=t.startTimestamp)return;const c=Ot[a].value,l=n+tn(c),u=Math.abs((l-t.startTimestamp)*1e3),d=u-c;Rt&&K.log(`[Measurements] Normalized ${a} from ${c} to ${u} (${d})`),Ot[a].value=u});const o=Ot["mark.fid"];o&&Ot.fid&&(jl(t,{description:"first input delay",endTimestamp:o.value+tn(Ot.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:o.value}),delete Ot["mark.fid"]),"fcp"in Ot||delete Ot.cls,Object.keys(Ot).forEach(a=>{t.setMeasurement(a,Ot[a].value,Ot[a].unit)}),$q(t)}Oi=void 0,rd=void 0,Ot={}}function Uq(t,e,n,r,i){const s=i+n,o=s+r;return jl(t,{description:e.name,endTimestamp:o,op:e.entryType,origin:"auto.resource.browser.metrics",startTimestamp:s}),s}function jq(t,e,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(r=>{rh(t,e,r,n)}),rh(t,e,"secureConnection",n,"TLS/SSL","connectEnd"),rh(t,e,"fetch",n,"cache","domainLookupStart"),rh(t,e,"domainLookup",n,"DNS"),Wq(t,e,n)}function rh(t,e,n,r,i,s){const o=s?e[s]:e[`${n}End`],a=e[`${n}Start`];!a||!o||jl(t,{op:"browser",origin:"auto.browser.browser.metrics",description:i||n,startTimestamp:r+tn(a),endTimestamp:r+tn(o)})}function Wq(t,e,n){jl(t,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:n+tn(e.requestStart),endTimestamp:n+tn(e.responseEnd)}),jl(t,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:n+tn(e.responseStart),endTimestamp:n+tn(e.responseEnd)})}function Vq(t,e,n,r,i,s){if(e.initiatorType==="xmlhttprequest"||e.initiatorType==="fetch")return;const o={};pv(o,e,"transferSize","http.response_transfer_size"),pv(o,e,"encodedBodySize","http.response_content_length"),pv(o,e,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in e&&(o["resource.render_blocking_status"]=e.renderBlockingStatus);const a=s+r,c=a+i;jl(t,{description:n,endTimestamp:c,op:e.initiatorType?`resource.${e.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:a,data:o})}function zq(t){const e=at.navigator;if(!e)return;const n=e.connection;n&&(n.effectiveType&&t.setTag("effectiveConnectionType",n.effectiveType),n.type&&t.setTag("connectionType",n.type),hv(n.rtt)&&(Ot["connection.rtt"]={value:n.rtt,unit:"millisecond"})),hv(e.deviceMemory)&&t.setTag("deviceMemory",`${e.deviceMemory} GB`),hv(e.hardwareConcurrency)&&t.setTag("hardwareConcurrency",String(e.hardwareConcurrency))}function $q(t){Oi&&(Rt&&K.log("[Measurements] Adding LCP Data"),Oi.element&&t.setTag("lcp.element",nc(Oi.element)),Oi.id&&t.setTag("lcp.id",Oi.id),Oi.url&&t.setTag("lcp.url",Oi.url.trim().slice(0,200)),t.setTag("lcp.size",Oi.size)),rd&&rd.sources&&(Rt&&K.log("[Measurements] Adding CLS Data"),rd.sources.forEach((e,n)=>t.setTag(`cls.source.${n+1}`,nc(e.node))))}function pv(t,e,n,r){const i=e[n];i!=null&&i<Nq&&(t[r]=i)}function Hq(t,e,n,r,i="auto.http.browser"){if(!ew()||!t.fetchData)return;const s=e(t.fetchData.url);if(t.endTimestamp&&s){const f=t.fetchData.__span;if(!f)return;const h=r[f];if(h){if(t.response){h.setHttpStatus(t.response.status);const p=t.response&&t.response.headers&&t.response.headers.get("content-length");if(p){const g=parseInt(p);g>0&&h.setData("http.response_content_length",g)}}else t.error&&h.setStatus("internal_error");h.end(),delete r[f]}return}const o=Sf(),a=Mt(),c=o.getSpan(),{method:l,url:u}=t.fetchData,d=s&&c?c.startChild({data:{url:u,type:"fetch","http.method":l},description:`${l} ${u}`,op:"http.client",origin:i}):void 0;if(d&&(t.fetchData.__span=d.spanId,r[d.spanId]=d),n(t.fetchData.url)&&a){const f=t.args[0];t.args[1]=t.args[1]||{};const h=t.args[1];h.headers=Gq(f,a,o,h,d)}return d}function Gq(t,e,n,r,i){const s=i||n.getSpan(),o=s&&s.transaction,{traceId:a,sampled:c,dsc:l}=n.getPropagationContext(),u=s?s.toTraceparent():Jb(a,void 0,c),d=o?o.getDynamicSamplingContext():l||Bm(a,e,n),f=L0(d),h=typeof Request<"u"&&lo(t,Request)?t.headers:r.headers;if(h)if(typeof Headers<"u"&&lo(h,Headers)){const p=new Headers(h);return p.append("sentry-trace",u),f&&p.append(D0,f),p}else if(Array.isArray(h)){const p=[...h,["sentry-trace",u]];return f&&p.push([D0,f]),p}else{const p="baggage"in h?h.baggage:void 0,g=[];return Array.isArray(p)?g.push(...p):p&&g.push(p),f&&g.push(f),{...h,"sentry-trace":u,baggage:g.length>0?g.join(","):void 0}}else return{"sentry-trace":u,baggage:f}}const V0=["localhost",/^\/(?!\/)/],z0={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:V0,tracePropagationTargets:V0};function qq(t){const{traceFetch:e,traceXHR:n,tracePropagationTargets:r,tracingOrigins:i,shouldCreateSpanForRequest:s,enableHTTPTimings:o}={traceFetch:z0.traceFetch,traceXHR:z0.traceXHR,...t},a=typeof s=="function"?s:u=>!0,c=u=>Yq(u,r||i),l={};e&&Hb(u=>{const d=Hq(u,a,c,l);o&&d&&m1(d)}),n&&Gb(u=>{const d=Xq(u,a,c,l);o&&d&&m1(d)})}function Jq(t){return t.entryType==="resource"&&"initiatorType"in t&&typeof t.nextHopProtocol=="string"&&(t.initiatorType==="fetch"||t.initiatorType==="xmlhttprequest")}function m1(t){const e=t.data.url;if(!e)return;const n=zm("resource",({entries:r})=>{r.forEach(i=>{Jq(i)&&i.name.endsWith(e)&&(Kq(i).forEach(o=>t.setData(...o)),setTimeout(n))})})}function Zq(t){let e="unknown",n="unknown",r="";for(const i of t){if(i==="/"){[e,n]=t.split("/");break}if(!isNaN(Number(i))){e=r==="h"?"http":r,n=t.split(r)[1];break}r+=i}return r===t&&(e=r),{name:e,version:n}}function Mi(t=0){return((Ii||performance.timeOrigin)+t)/1e3}function Kq(t){const{name:e,version:n}=Zq(t.nextHopProtocol),r=[];return r.push(["network.protocol.version",n],["network.protocol.name",e]),Ii?[...r,["http.request.redirect_start",Mi(t.redirectStart)],["http.request.fetch_start",Mi(t.fetchStart)],["http.request.domain_lookup_start",Mi(t.domainLookupStart)],["http.request.domain_lookup_end",Mi(t.domainLookupEnd)],["http.request.connect_start",Mi(t.connectStart)],["http.request.secure_connection_start",Mi(t.secureConnectionStart)],["http.request.connection_end",Mi(t.connectEnd)],["http.request.request_start",Mi(t.requestStart)],["http.request.response_start",Mi(t.responseStart)],["http.request.response_end",Mi(t.responseEnd)]]:r}function Yq(t,e){return ou(t,e||V0)}function Xq(t,e,n,r){const i=t.xhr,s=i&&i[Ho];if(!ew()||!i||i.__sentry_own_request__||!s)return;const o=e(s.url);if(t.endTimestamp&&o){const u=i.__sentry_xhr_span_id__;if(!u)return;const d=r[u];d&&s.status_code!==void 0&&(d.setHttpStatus(s.status_code),d.end(),delete r[u]);return}const a=Sf(),c=a.getSpan(),l=o&&c?c.startChild({data:{type:"xhr","http.method":s.method,url:s.url},description:`${s.method} ${s.url}`,op:"http.client",origin:"auto.http.browser"}):void 0;if(l&&(i.__sentry_xhr_span_id__=l.spanId,r[i.__sentry_xhr_span_id__]=l),i.setRequestHeader&&n(s.url))if(l){const u=l&&l.transaction,d=u&&u.getDynamicSamplingContext(),f=L0(d);g1(i,l.toTraceparent(),f)}else{const u=Mt(),{traceId:d,sampled:f,dsc:h}=a.getPropagationContext(),p=Jb(d,void 0,f),g=h||(u?Bm(d,u,a):void 0),y=L0(g);g1(i,p,y)}return l}function g1(t,e,n){try{t.setRequestHeader("sentry-trace",e),n&&t.setRequestHeader(D0,n)}catch{}}function Qq(t,e=!0,n=!0){if(!at||!at.location){Rt&&K.warn("Could not initialize routing instrumentation due to invalid location");return}let r=at.location.href,i;e&&(i=t({name:at.location.pathname,startTimestamp:Ii?Ii/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),n&&Lm(({to:s,from:o})=>{if(o===void 0&&r&&r.indexOf(s)!==-1){r=void 0;return}o!==s&&(r=void 0,i&&(Rt&&K.log(`[Tracing] Finishing current transaction with op: ${i.op}`),i.end()),i=t({name:at.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))})}const eJ="BrowserTracing",tJ={...Fh,markBackgroundTransactions:!0,routingInstrumentation:Qq,startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...z0};class nJ{constructor(e){this.name=eJ,this._hasSetTracePropagationTargets=!1,mH(),Rt&&(this._hasSetTracePropagationTargets=!!(e&&(e.tracePropagationTargets||e.tracingOrigins))),this.options={...tJ,...e},this.options._experiments.enableLongTask!==void 0&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=Mq(),this.options.enableLongTask&&xq(),this.options._experiments.enableInteractions&&Oq()}setupOnce(e,n){this._getCurrentHub=n;const i=n().getClient(),s=i&&i.getOptions(),{routingInstrumentation:o,startTransactionOnLocationChange:a,startTransactionOnPageLoad:c,markBackgroundTransactions:l,traceFetch:u,traceXHR:d,shouldCreateSpanForRequest:f,enableHTTPTimings:h,_experiments:p}=this.options,g=s&&s.tracePropagationTargets,y=g||this.options.tracePropagationTargets;Rt&&this._hasSetTracePropagationTargets&&g&&K.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),o(m=>{const v=this._createRouteTransaction(m);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(v,m,n),v},c,a),l&&vq(),p.enableInteractions&&this._registerInteractionListener(),qq({traceFetch:u,traceXHR:d,tracePropagationTargets:y,shouldCreateSpanForRequest:f,enableHTTPTimings:h})}_createRouteTransaction(e){if(!this._getCurrentHub){Rt&&K.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`);return}const n=this._getCurrentHub(),{beforeNavigate:r,idleTimeout:i,finalTimeout:s,heartbeatInterval:o}=this.options,a=e.op==="pageload",c=a?v1("sentry-trace"):"",l=a?v1("baggage"):"",{traceparentData:u,dynamicSamplingContext:d,propagationContext:f}=_9(c,l),h={...e,...u,metadata:{...e.metadata,dynamicSamplingContext:u&&!d?{}:d},trimEnd:!0},p=typeof r=="function"?r(h):h,g=p===void 0?{...h,sampled:!1}:p;g.metadata=g.name!==h.name?{...g.metadata,source:"custom"}:g.metadata,this._latestRouteName=g.name,this._latestRouteSource=g.metadata&&g.metadata.source,g.sampled===!1&&Rt&&K.log(`[Tracing] Will not send ${g.op} transaction because of beforeNavigate.`),Rt&&K.log(`[Tracing] Starting ${g.op} transaction on scope`);const{location:y}=at,m=t1(n,g,i,s,!0,{location:y},o),v=n.getScope();return a&&u?v.setPropagationContext(f):v.setPropagationContext({traceId:m.traceId,spanId:m.spanId,parentSpanId:m.parentSpanId,sampled:m.sampled}),m.registerBeforeFinishCallback(w=>{this._collectWebVitals(),Bq(w)}),m}_registerInteractionListener(){let e;const n=()=>{const{idleTimeout:r,finalTimeout:i,heartbeatInterval:s}=this.options,o="ui.action.click",a=yf();if(a&&a.op&&["navigation","pageload"].includes(a.op)){Rt&&K.warn(`[Tracing] Did not create ${o} transaction because a pageload or navigation transaction is in progress.`);return}if(e&&(e.setFinishReason("interactionInterrupted"),e.end(),e=void 0),!this._getCurrentHub){Rt&&K.warn(`[Tracing] Did not create ${o} transaction because _getCurrentHub is invalid.`);return}if(!this._latestRouteName){Rt&&K.warn(`[Tracing] Did not create ${o} transaction because _latestRouteName is missing.`);return}const c=this._getCurrentHub(),{location:l}=at,u={name:this._latestRouteName,op:o,trimEnd:!0,metadata:{source:this._latestRouteSource||"url"}};e=t1(c,u,r,i,!0,{location:l},s)};["click"].forEach(r=>{addEventListener(r,n,{once:!1,capture:!0})})}}function v1(t){const e=M$(`meta[name=${t}]`);return e?e.getAttribute("content"):void 0}const ht=Ke,cw="sentryReplaySession",rJ="replay_event",lw="Unable to send Replay",iJ=3e5,sJ=9e5,oJ=5e3,aJ=5500,cJ=6e4,lJ=5e3,uJ=3,y1=15e4,ih=5e3,dJ=3e3,fJ=300,uw=2e7,hJ=4999,pJ=15e3,S1=36e5,b1={low:{sampling:{canvas:1},dataURLOptions:{type:"image/webp",quality:.25}},medium:{sampling:{canvas:2},dataURLOptions:{type:"image/webp",quality:.4}},high:{sampling:{canvas:4},dataURLOptions:{type:"image/webp",quality:.5}}};var nn;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(nn||(nn={}));function mJ(t){return t.nodeType===t.ELEMENT_NODE}function id(t){const e=t==null?void 0:t.host;return(e==null?void 0:e.shadowRoot)===t}function sd(t){return Object.prototype.toString.call(t)==="[object ShadowRoot]"}function gJ(t){return t.includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t}function vJ(t){const{cssText:e}=t;if(e.split('"').length<3)return e;const n=["@import",`url(${JSON.stringify(t.href)})`];return t.layerName===""?n.push("layer"):t.layerName&&n.push(`layer(${t.layerName})`),t.supportsText&&n.push(`supports(${t.supportsText})`),t.media.length&&n.push(t.media.mediaText),n.join(" ")+";"}function Up(t){try{const e=t.rules||t.cssRules;return e?gJ(Array.from(e,DM).join("")):null}catch{return null}}function DM(t){let e;if(SJ(t))try{e=Up(t.styleSheet)||vJ(t)}catch{}else if(bJ(t)&&t.selectorText.includes(":"))return yJ(t.cssText);return e||t.cssText}function yJ(t){const e=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return t.replace(e,"$1\\$2")}function SJ(t){return"styleSheet"in t}function bJ(t){return"selectorText"in t}class LM{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var n;if(!e)return-1;const r=(n=this.getMeta(e))===null||n===void 0?void 0:n.id;return r??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){const r=n.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,n)}replace(e,n){const r=this.getNode(e);if(r){const i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(n,i)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function wJ(){return new LM}function Hm({maskInputOptions:t,tagName:e,type:n}){return e==="OPTION"&&(e="SELECT"),!!(t[e.toLowerCase()]||n&&t[n]||n==="password"||e==="INPUT"&&!n&&t.text)}function Wd({isMasked:t,element:e,value:n,maskInputFn:r}){let i=n||"";return t?(r&&(i=r(i,e)),"*".repeat(i.length)):i}function Wl(t){return t.toLowerCase()}function $0(t){return t.toUpperCase()}const w1="__rrweb_original__";function kJ(t){const e=t.getContext("2d");if(!e)return!0;const n=50;for(let r=0;r<t.width;r+=n)for(let i=0;i<t.height;i+=n){const s=e.getImageData,o=w1 in s?s[w1]:s;if(new Uint32Array(o.call(e,r,i,Math.min(n,t.width-r),Math.min(n,t.height-i)).data.buffer).some(c=>c!==0))return!1}return!0}function dw(t){const e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?Wl(e):null}function jp(t,e,n){return e==="INPUT"&&(n==="radio"||n==="checkbox")?t.getAttribute("value")||"":t.value}let EJ=1;const CJ=new RegExp("[^a-z0-9-_:]"),Vd=-2;function fw(){return EJ++}function TJ(t){if(t instanceof HTMLFormElement)return"form";const e=Wl(t.tagName);return CJ.test(e)?"div":e}function _J(t){let e="";return t.indexOf("//")>-1?e=t.split("/").slice(0,3).join("/"):e=t.split("/")[0],e=e.split("?")[0],e}let Cc,k1;const IJ=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,RJ=/^(?:[a-z+]+:)?\/\//i,PJ=/^www\..*/i,AJ=/^(data:)([^,]*),(.*)/i;function Wp(t,e){return(t||"").replace(IJ,(n,r,i,s,o,a)=>{const c=i||o||a,l=r||s||"";if(!c)return n;if(RJ.test(c)||PJ.test(c))return`url(${l}${c}${l})`;if(AJ.test(c))return`url(${l}${c}${l})`;if(c[0]==="/")return`url(${l}${_J(e)+c}${l})`;const u=e.split("/"),d=c.split("/");u.pop();for(const f of d)f!=="."&&(f===".."?u.pop():u.push(f));return`url(${l}${u.join("/")}${l})`})}const NJ=/^[^ \t\n\r\u000c]+/,MJ=/^[, \t\n\r\u000c]+/;function xJ(t,e){if(e.trim()==="")return e;let n=0;function r(s){let o;const a=s.exec(e.substring(n));return a?(o=a[0],n+=o.length,o):""}const i=[];for(;r(MJ),!(n>=e.length);){let s=r(NJ);if(s.slice(-1)===",")s=Hc(t,s.substring(0,s.length-1)),i.push(s);else{let o="";s=Hc(t,s);let a=!1;for(;;){const c=e.charAt(n);if(c===""){i.push((s+o).trim());break}else if(a)c===")"&&(a=!1);else if(c===","){n+=1,i.push((s+o).trim());break}else c==="("&&(a=!0);o+=c,n+=1}}}return i.join(", ")}function Hc(t,e){if(!e||e.trim()==="")return e;const n=t.createElement("a");return n.href=e,n.href}function OJ(t){return!!(t.tagName==="svg"||t.ownerSVGElement)}function hw(){const t=document.createElement("a");return t.href="",t.href}function FM(t,e,n,r,i,s){return r&&(n==="src"||n==="href"&&!(e==="use"&&r[0]==="#")||n==="xlink:href"&&r[0]!=="#"||n==="background"&&(e==="table"||e==="td"||e==="th")?Hc(t,r):n==="srcset"?xJ(t,r):n==="style"?Wp(r,hw()):e==="object"&&n==="data"?Hc(t,r):typeof s=="function"?s(n,r,i):r)}function BM(t,e,n){return(t==="video"||t==="audio")&&e==="autoplay"}function DJ(t,e,n,r){try{if(r&&t.matches(r))return!1;if(typeof e=="string"){if(t.classList.contains(e))return!0}else for(let i=t.classList.length;i--;){const s=t.classList[i];if(e.test(s))return!0}if(n)return t.matches(n)}catch{}return!1}function LJ(t,e){for(let n=t.classList.length;n--;){const r=t.classList[n];if(e.test(r))return!0}return!1}function xa(t,e,n=1/0,r=0){return!t||t.nodeType!==t.ELEMENT_NODE||r>n?-1:e(t)?r:xa(t.parentNode,e,n,r+1)}function Gc(t,e){return n=>{const r=n;if(r===null)return!1;if(t){if(typeof t=="string"){if(r.matches(`.${t}`))return!0}else if(LJ(r,t))return!0}return!!(e&&r.matches(e))}}function Vl(t,e,n,r,i,s){try{const o=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(o===null)return!1;let a=-1,c=-1;if(s){if(c=xa(o,Gc(r,i)),c<0)return!0;a=xa(o,Gc(e,n),c>=0?c:1/0)}else{if(a=xa(o,Gc(e,n)),a<0)return!1;c=xa(o,Gc(r,i),a>=0?a:1/0)}return a>=0?c>=0?a<=c:!0:c>=0?!1:!!s}catch{}return!!s}function FJ(t,e,n){const r=t.contentWindow;if(!r)return;let i=!1,s;try{s=r.document.readyState}catch{return}if(s!=="complete"){const a=setTimeout(()=>{i||(e(),i=!0)},n);t.addEventListener("load",()=>{clearTimeout(a),i=!0,e()});return}const o="about:blank";if(r.location.href!==o||t.src===o||t.src==="")return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}function BJ(t,e,n){let r=!1,i;try{i=t.sheet}catch{return}if(i)return;const s=setTimeout(()=>{r||(e(),r=!0)},n);t.addEventListener("load",()=>{clearTimeout(s),r=!0,e()})}function UJ(t,e){const{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskAttributeFn:c,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f,inlineStylesheet:h,maskInputOptions:p={},maskTextFn:g,maskInputFn:y,dataURLOptions:m={},inlineImages:v,recordCanvas:w,keepIframeSrcFn:_,newlyAddedElement:C=!1}=e,k=jJ(n,r);switch(t.nodeType){case t.DOCUMENT_NODE:return t.compatMode!=="CSS1Compat"?{type:nn.Document,childNodes:[],compatMode:t.compatMode}:{type:nn.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:nn.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:k};case t.ELEMENT_NODE:return VJ(t,{doc:n,blockClass:i,blockSelector:s,unblockSelector:o,inlineStylesheet:h,maskAttributeFn:c,maskInputOptions:p,maskInputFn:y,dataURLOptions:m,inlineImages:v,recordCanvas:w,keepIframeSrcFn:_,newlyAddedElement:C,rootId:k,maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f});case t.TEXT_NODE:return WJ(t,{maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f,maskTextFn:g,maskInputOptions:p,maskInputFn:y,rootId:k});case t.CDATA_SECTION_NODE:return{type:nn.CDATA,textContent:"",rootId:k};case t.COMMENT_NODE:return{type:nn.Comment,textContent:t.textContent||"",rootId:k};default:return!1}}function jJ(t,e){if(!e.hasNode(t))return;const n=e.getId(t);return n===1?void 0:n}function WJ(t,e){var n;const{maskAllText:r,maskTextClass:i,unmaskTextClass:s,maskTextSelector:o,unmaskTextSelector:a,maskTextFn:c,maskInputOptions:l,maskInputFn:u,rootId:d}=e,f=t.parentNode&&t.parentNode.tagName;let h=t.textContent;const p=f==="STYLE"?!0:void 0,g=f==="SCRIPT"?!0:void 0,y=f==="TEXTAREA"?!0:void 0;if(p&&h){try{t.nextSibling||t.previousSibling||!((n=t.parentNode.sheet)===null||n===void 0)&&n.cssRules&&(h=Up(t.parentNode.sheet))}catch(v){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${v}`,t)}h=Wp(h,hw())}g&&(h="SCRIPT_PLACEHOLDER");const m=Vl(t,i,o,s,a,r);if(!p&&!g&&!y&&h&&m&&(h=c?c(h):h.replace(/[\S]/g,"*")),y&&h&&(l.textarea||m)&&(h=u?u(h,t.parentNode):h.replace(/[\S]/g,"*")),f==="OPTION"&&h){const v=Hm({type:null,tagName:f,maskInputOptions:l});h=Wd({isMasked:Vl(t,i,o,s,a,v),element:t,value:h,maskInputFn:u})}return{type:nn.Text,textContent:h||"",isStyle:p,rootId:d}}function VJ(t,e){const{doc:n,blockClass:r,blockSelector:i,unblockSelector:s,inlineStylesheet:o,maskInputOptions:a={},maskAttributeFn:c,maskInputFn:l,dataURLOptions:u={},inlineImages:d,recordCanvas:f,keepIframeSrcFn:h,newlyAddedElement:p=!1,rootId:g,maskAllText:y,maskTextClass:m,unmaskTextClass:v,maskTextSelector:w,unmaskTextSelector:_}=e,C=DJ(t,r,i,s),k=TJ(t);let T={};const R=t.attributes.length;for(let M=0;M<R;M++){const O=t.attributes[M];BM(k,O.name,O.value)||(T[O.name]=FM(n,k,Wl(O.name),O.value,t,c))}if(k==="link"&&o){const M=Array.from(n.styleSheets).find(D=>D.href===t.href);let O=null;M&&(O=Up(M)),O&&(delete T.rel,delete T.href,T._cssText=Wp(O,M.href))}if(k==="style"&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){const M=Up(t.sheet);M&&(T._cssText=Wp(M,hw()))}if(k==="input"||k==="textarea"||k==="select"||k==="option"){const M=t,O=dw(M),D=jp(M,$0(k),O),j=M.checked;if(O!=="submit"&&O!=="button"&&D){const V=Vl(M,m,w,v,_,Hm({type:O,tagName:$0(k),maskInputOptions:a}));T.value=Wd({isMasked:V,element:M,value:D,maskInputFn:l})}j&&(T.checked=j)}if(k==="option"&&(t.selected&&!a.select?T.selected=!0:delete T.selected),k==="canvas"&&f){if(t.__context==="2d")kJ(t)||(T.rr_dataURL=t.toDataURL(u.type,u.quality));else if(!("__context"in t)){const M=t.toDataURL(u.type,u.quality),O=document.createElement("canvas");O.width=t.width,O.height=t.height;const D=O.toDataURL(u.type,u.quality);M!==D&&(T.rr_dataURL=M)}}if(k==="img"&&d){Cc||(Cc=n.createElement("canvas"),k1=Cc.getContext("2d"));const M=t,O=M.crossOrigin;M.crossOrigin="anonymous";const D=()=>{M.removeEventListener("load",D);try{Cc.width=M.naturalWidth,Cc.height=M.naturalHeight,k1.drawImage(M,0,0),T.rr_dataURL=Cc.toDataURL(u.type,u.quality)}catch(j){console.warn(`Cannot inline img src=${M.currentSrc}! Error: ${j}`)}O?T.crossOrigin=O:M.removeAttribute("crossorigin")};M.complete&&M.naturalWidth!==0?D():M.addEventListener("load",D)}if((k==="audio"||k==="video")&&(T.rr_mediaState=t.paused?"paused":"played",T.rr_mediaCurrentTime=t.currentTime),p||(t.scrollLeft&&(T.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(T.rr_scrollTop=t.scrollTop)),C){const{width:M,height:O}=t.getBoundingClientRect();T={class:T.class,rr_width:`${M}px`,rr_height:`${O}px`}}k==="iframe"&&!h(T.src)&&(t.contentDocument||(T.rr_src=T.src),delete T.src);let A;try{customElements.get(k)&&(A=!0)}catch{}return{type:nn.Element,tagName:k,attributes:T,childNodes:[],isSVG:OJ(t)||void 0,needBlock:C,rootId:g,isCustom:A}}function ft(t){return t==null?"":t.toLowerCase()}function zJ(t,e){if(e.comment&&t.type===nn.Comment)return!0;if(t.type===nn.Element){if(e.script&&(t.tagName==="script"||t.tagName==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||t.tagName==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&t.attributes.href.endsWith(".js")))return!0;if(e.headFavicon&&(t.tagName==="link"&&t.attributes.rel==="shortcut icon"||t.tagName==="meta"&&(ft(t.attributes.name).match(/^msapplication-tile(image|color)$/)||ft(t.attributes.name)==="application-name"||ft(t.attributes.rel)==="icon"||ft(t.attributes.rel)==="apple-touch-icon"||ft(t.attributes.rel)==="shortcut icon")))return!0;if(t.tagName==="meta"){if(e.headMetaDescKeywords&&ft(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(ft(t.attributes.property).match(/^(og|twitter|fb):/)||ft(t.attributes.name).match(/^(og|twitter):/)||ft(t.attributes.name)==="pinterest"))return!0;if(e.headMetaRobots&&(ft(t.attributes.name)==="robots"||ft(t.attributes.name)==="googlebot"||ft(t.attributes.name)==="bingbot"))return!0;if(e.headMetaHttpEquiv&&t.attributes["http-equiv"]!==void 0)return!0;if(e.headMetaAuthorship&&(ft(t.attributes.name)==="author"||ft(t.attributes.name)==="generator"||ft(t.attributes.name)==="framework"||ft(t.attributes.name)==="publisher"||ft(t.attributes.name)==="progid"||ft(t.attributes.property).match(/^article:/)||ft(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&(ft(t.attributes.name)==="google-site-verification"||ft(t.attributes.name)==="yandex-verification"||ft(t.attributes.name)==="csrf-token"||ft(t.attributes.name)==="p:domain_verify"||ft(t.attributes.name)==="verify-v1"||ft(t.attributes.name)==="verification"||ft(t.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function qc(t,e){const{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:f=!1,inlineStylesheet:h=!0,maskInputOptions:p={},maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOMOptions:v,dataURLOptions:w={},inlineImages:_=!1,recordCanvas:C=!1,onSerialize:k,onIframeLoad:T,iframeLoadTimeout:R=5e3,onStylesheetLoad:A,stylesheetLoadTimeout:M=5e3,keepIframeSrcFn:O=()=>!1,newlyAddedElement:D=!1}=e;let{preserveWhiteSpace:j=!0}=e;const V=UJ(t,{doc:n,mirror:r,blockClass:i,blockSelector:s,maskAllText:a,unblockSelector:o,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,dataURLOptions:w,inlineImages:_,recordCanvas:C,keepIframeSrcFn:O,newlyAddedElement:D});if(!V)return console.warn(t,"not serialized"),null;let J;r.hasNode(t)?J=r.getId(t):zJ(V,v)||!j&&V.type===nn.Text&&!V.isStyle&&!V.textContent.replace(/^\s+|\s+$/gm,"").length?J=Vd:J=fw();const G=Object.assign(V,{id:J});if(r.add(t,G),J===Vd)return null;k&&k(t);let te=!f;if(G.type===nn.Element){te=te&&!G.needBlock,delete G.needBlock;const z=t.shadowRoot;z&&sd(z)&&(G.isShadowHost=!0)}if((G.type===nn.Document||G.type===nn.Element)&&te){v.headWhitespace&&G.type===nn.Element&&G.tagName==="head"&&(j=!1);const z={doc:n,mirror:r,blockClass:i,blockSelector:s,maskAllText:a,unblockSelector:o,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:f,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOMOptions:v,dataURLOptions:w,inlineImages:_,recordCanvas:C,preserveWhiteSpace:j,onSerialize:k,onIframeLoad:T,iframeLoadTimeout:R,onStylesheetLoad:A,stylesheetLoadTimeout:M,keepIframeSrcFn:O};for(const Z of Array.from(t.childNodes)){const ie=qc(Z,z);ie&&G.childNodes.push(ie)}if(mJ(t)&&t.shadowRoot)for(const Z of Array.from(t.shadowRoot.childNodes)){const ie=qc(Z,z);ie&&(sd(t.shadowRoot)&&(ie.isShadow=!0),G.childNodes.push(ie))}}return t.parentNode&&id(t.parentNode)&&sd(t.parentNode)&&(G.isShadow=!0),G.type===nn.Element&&G.tagName==="iframe"&&FJ(t,()=>{const z=t.contentDocument;if(z&&T){const Z=qc(z,{doc:z,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOMOptions:v,dataURLOptions:w,inlineImages:_,recordCanvas:C,preserveWhiteSpace:j,onSerialize:k,onIframeLoad:T,iframeLoadTimeout:R,onStylesheetLoad:A,stylesheetLoadTimeout:M,keepIframeSrcFn:O});Z&&T(t,Z)}},R),G.type===nn.Element&&G.tagName==="link"&&G.attributes.rel==="stylesheet"&&BJ(t,()=>{if(A){const z=qc(t,{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOMOptions:v,dataURLOptions:w,inlineImages:_,recordCanvas:C,preserveWhiteSpace:j,onSerialize:k,onIframeLoad:T,iframeLoadTimeout:R,onStylesheetLoad:A,stylesheetLoadTimeout:M,keepIframeSrcFn:O});z&&A(t,z)}},M),G}function $J(t,e){const{mirror:n=new LM,blockClass:r="rr-block",blockSelector:i=null,unblockSelector:s=null,maskAllText:o=!1,maskTextClass:a="rr-mask",unmaskTextClass:c=null,maskTextSelector:l=null,unmaskTextSelector:u=null,inlineStylesheet:d=!0,inlineImages:f=!1,recordCanvas:h=!1,maskAllInputs:p=!1,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOM:v=!1,dataURLOptions:w,preserveWhiteSpace:_,onSerialize:C,onIframeLoad:k,iframeLoadTimeout:T,onStylesheetLoad:R,stylesheetLoadTimeout:A,keepIframeSrcFn:M=()=>!1}=e||{};return qc(t,{doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,maskAllText:o,maskTextClass:a,unmaskTextClass:c,maskTextSelector:l,unmaskTextSelector:u,skipChild:!1,inlineStylesheet:d,maskInputOptions:p===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:p===!1?{}:p,maskAttributeFn:g,maskTextFn:y,maskInputFn:m,slimDOMOptions:v===!0||v==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:v==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:v===!1?{}:v,dataURLOptions:w,inlineImages:f,recordCanvas:h,preserveWhiteSpace:_,onSerialize:C,onIframeLoad:k,iframeLoadTimeout:T,onStylesheetLoad:R,stylesheetLoadTimeout:A,keepIframeSrcFn:M,newlyAddedElement:!1})}function Xn(t,e,n=document){const r={capture:!0,passive:!0};return n.addEventListener(t,e,r),()=>n.removeEventListener(t,e,r)}const Ic=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let E1={map:{},getId(){return console.error(Ic),-1},getNode(){return console.error(Ic),null},removeNodeFromMap(){console.error(Ic)},has(){return console.error(Ic),!1},reset(){console.error(Ic)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(E1=new Proxy(E1,{get(t,e,n){return e==="map"&&console.error(Ic),Reflect.get(t,e,n)}}));function zd(t,e,n={}){let r=null,i=0;return function(...s){const o=Date.now();!i&&n.leading===!1&&(i=o);const a=e-(o-i),c=this;a<=0||a>e?(r&&(clearTimeout(r),r=null),i=o,t.apply(c,s)):!r&&n.trailing!==!1&&(r=setTimeout(()=>{i=n.leading===!1?0:Date.now(),r=null,t.apply(c,s)},a))}}function UM(t,e,n,r,i=window){const s=i.Object.getOwnPropertyDescriptor(t,e);return i.Object.defineProperty(t,e,r?n:{set(o){setTimeout(()=>{n.set.call(this,o)},0),s&&s.set&&s.set.call(this,o)}}),()=>UM(t,e,s||{},!0)}function pw(t,e,n){try{if(!(e in t))return()=>{};const r=t[e],i=n(r);return typeof i=="function"&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:r}})),t[e]=i,()=>{t[e]=r}}catch{return()=>{}}}let Vp=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(Vp=()=>new Date().getTime());function jM(t){var e,n,r,i,s,o;const a=t.document;return{left:a.scrollingElement?a.scrollingElement.scrollLeft:t.pageXOffset!==void 0?t.pageXOffset:(a==null?void 0:a.documentElement.scrollLeft)||((n=(e=a==null?void 0:a.body)===null||e===void 0?void 0:e.parentElement)===null||n===void 0?void 0:n.scrollLeft)||((r=a==null?void 0:a.body)===null||r===void 0?void 0:r.scrollLeft)||0,top:a.scrollingElement?a.scrollingElement.scrollTop:t.pageYOffset!==void 0?t.pageYOffset:(a==null?void 0:a.documentElement.scrollTop)||((s=(i=a==null?void 0:a.body)===null||i===void 0?void 0:i.parentElement)===null||s===void 0?void 0:s.scrollTop)||((o=a==null?void 0:a.body)===null||o===void 0?void 0:o.scrollTop)||0}}function WM(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function VM(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function fi(t,e,n,r,i){if(!t)return!1;const s=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(!s)return!1;const o=Gc(e,n);if(!i){const l=r&&s.matches(r);return o(s)&&!l}const a=xa(s,o);let c=-1;return a<0?!1:(r&&(c=xa(s,Gc(null,r))),a>-1&&c<0?!0:a<c)}function HJ(t,e){return e.getId(t)!==-1}function mv(t,e){return e.getId(t)===Vd}function zM(t,e){if(id(t))return!1;const n=e.getId(t);return e.has(n)?t.parentNode&&t.parentNode.nodeType===t.DOCUMENT_NODE?!1:t.parentNode?zM(t.parentNode,e):!0:!0}function H0(t){return!!t.changedTouches}function GJ(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let n=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function $M(t,e){return!!(t.nodeName==="IFRAME"&&e.getMeta(t))}function HM(t,e){return!!(t.nodeName==="LINK"&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&t.getAttribute("rel")==="stylesheet"&&e.getMeta(t))}function G0(t){return!!(t!=null&&t.shadowRoot)}class qJ{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var n;return(n=this.styleIDMap.get(e))!==null&&n!==void 0?n:-1}has(e){return this.styleIDMap.has(e)}add(e,n){if(this.has(e))return this.getId(e);let r;return n===void 0?r=this.id++:r=n,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function GM(t){var e,n;let r=null;return((n=(e=t.getRootNode)===null||e===void 0?void 0:e.call(t))===null||n===void 0?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host&&(r=t.getRootNode().host),r}function JJ(t){let e=t,n;for(;n=GM(e);)e=n;return e}function ZJ(t){const e=t.ownerDocument;if(!e)return!1;const n=JJ(t);return e.contains(n)}function qM(t){const e=t.ownerDocument;return e?e.contains(t)||ZJ(t):!1}var Fe=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(Fe||{}),Be=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t))(Be||{}),zn=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(zn||{}),ys=(t=>(t[t.Mouse=0]="Mouse",t[t.Pen=1]="Pen",t[t.Touch=2]="Touch",t))(ys||{});function C1(t){return"__ln"in t}class KJ{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let n=this.head;for(let r=0;r<e;r++)n=(n==null?void 0:n.next)||null;return n}addNode(e){const n={value:e,previous:null,next:null};if(e.__ln=n,e.previousSibling&&C1(e.previousSibling)){const r=e.previousSibling.__ln.next;n.next=r,n.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=n,r&&(r.previous=n)}else if(e.nextSibling&&C1(e.nextSibling)&&e.nextSibling.__ln.previous){const r=e.nextSibling.__ln.previous;n.previous=r,n.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=n,r&&(r.next=n)}else this.head&&(this.head.previous=n),n.next=this.head,this.head=n;n.next===null&&(this.tail=n),this.length++}removeNode(e){const n=e.__ln;this.head&&(n.previous?(n.previous.next=n.next,n.next?n.next.previous=n.previous:this.tail=n.previous):(this.head=n.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const T1=(t,e)=>`${t}@${e}`;class YJ{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],n=new Set,r=new KJ,i=c=>{let l=c,u=Vd;for(;u===Vd;)l=l&&l.nextSibling,u=l&&this.mirror.getId(l);return u},s=c=>{if(!c.parentNode||!qM(c))return;const l=id(c.parentNode)?this.mirror.getId(GM(c)):this.mirror.getId(c.parentNode),u=i(c);if(l===-1||u===-1)return r.addNode(c);const d=qc(c,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:f=>{$M(f,this.mirror)&&this.iframeManager.addIframe(f),HM(f,this.mirror)&&this.stylesheetManager.trackLinkElement(f),G0(c)&&this.shadowDomManager.addShadowRoot(c.shadowRoot,this.doc)},onIframeLoad:(f,h)=>{this.iframeManager.attachIframe(f,h),this.shadowDomManager.observeAttachShadow(f)},onStylesheetLoad:(f,h)=>{this.stylesheetManager.attachLinkElement(f,h)}});d&&(e.push({parentId:l,nextId:u,node:d}),n.add(d.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const c of this.movedSet)_1(this.removes,c,this.mirror)&&!this.movedSet.has(c.parentNode)||s(c);for(const c of this.addedSet)!I1(this.droppedSet,c)&&!_1(this.removes,c,this.mirror)||I1(this.movedSet,c)?s(c):this.droppedSet.add(c);let o=null;for(;r.length;){let c=null;if(o){const l=this.mirror.getId(o.value.parentNode),u=i(o.value);l!==-1&&u!==-1&&(c=o)}if(!c){let l=r.tail;for(;l;){const u=l;if(l=l.previous,u){const d=this.mirror.getId(u.value.parentNode);if(i(u.value)===-1)continue;if(d!==-1){c=u;break}else{const h=u.value;if(h.parentNode&&h.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const p=h.parentNode.host;if(this.mirror.getId(p)!==-1){c=u;break}}}}}}if(!c){for(;r.head;)r.removeNode(r.head.value);break}o=c.previous,r.removeNode(c.value),s(c.value)}const a={texts:this.texts.map(c=>({id:this.mirror.getId(c.node),value:c.value})).filter(c=>!n.has(c.id)).filter(c=>this.mirror.has(c.id)),attributes:this.attributes.map(c=>{const{attributes:l}=c;if(typeof l.style=="string"){const u=JSON.stringify(c.styleDiff),d=JSON.stringify(c._unchangedStyles);u.length<l.style.length&&(u+d).split("var(").length===l.style.split("var(").length&&(l.style=c.styleDiff)}return{id:this.mirror.getId(c.node),attributes:l}}).filter(c=>!n.has(c.id)).filter(c=>this.mirror.has(c.id)),removes:this.removes,adds:e};!a.texts.length&&!a.attributes.length&&!a.removes.length&&!a.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(a))},this.processMutation=e=>{if(mv(e.target,this.mirror))return;let n;try{n=document.implementation.createHTMLDocument()}catch{n=this.doc}switch(e.type){case"characterData":{const r=e.target.textContent;!fi(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)&&r!==e.oldValue&&this.texts.push({value:Vl(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&r?this.maskTextFn?this.maskTextFn(r):r.replace(/[\S]/g,"*"):r,node:e.target});break}case"attributes":{const r=e.target;let i=e.attributeName,s=e.target.getAttribute(i);if(i==="value"){const a=dw(r),c=r.tagName;s=jp(r,c,a);const l=Hm({maskInputOptions:this.maskInputOptions,tagName:c,type:a}),u=Vl(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,l);s=Wd({isMasked:u,element:r,value:s,maskInputFn:this.maskInputFn})}if(fi(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||s===e.oldValue)return;let o=this.attributes.find(a=>a.node===e.target);if(r.tagName==="IFRAME"&&i==="src"&&!this.keepIframeSrcFn(s))if(!r.contentDocument)i="rr_src";else return;if(o||(o={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(o)),i==="type"&&r.tagName==="INPUT"&&(e.oldValue||"").toLowerCase()==="password"&&r.setAttribute("data-rr-is-password","true"),!BM(r.tagName,i)&&(o.attributes[i]=FM(this.doc,Wl(r.tagName),Wl(i),s,r,this.maskAttributeFn),i==="style")){const a=n.createElement("span");e.oldValue&&a.setAttribute("style",e.oldValue);for(const c of Array.from(r.style)){const l=r.style.getPropertyValue(c),u=r.style.getPropertyPriority(c);l!==a.style.getPropertyValue(c)||u!==a.style.getPropertyPriority(c)?u===""?o.styleDiff[c]=l:o.styleDiff[c]=[l,u]:o._unchangedStyles[c]=[l,u]}for(const c of Array.from(a.style))r.style.getPropertyValue(c)===""&&(o.styleDiff[c]=!1)}break}case"childList":{if(fi(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;e.addedNodes.forEach(r=>this.genAdds(r,e.target)),e.removedNodes.forEach(r=>{const i=this.mirror.getId(r),s=id(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);fi(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||mv(r,this.mirror)||!HJ(r,this.mirror)||(this.addedSet.has(r)?(q0(this.addedSet,r),this.droppedSet.add(r)):this.addedSet.has(e.target)&&i===-1||zM(e.target,this.mirror)||(this.movedSet.has(r)&&this.movedMap[T1(i,s)]?q0(this.movedSet,r):this.removes.push({parentId:s,id:i,isShadow:id(e.target)&&sd(e.target)?!0:void 0})),this.mapRemoves.push(r))});break}}},this.genAdds=(e,n)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!(this.addedSet.has(e)||this.movedSet.has(e))){if(this.mirror.hasNode(e)){if(mv(e,this.mirror))return;this.movedSet.add(e);let r=null;n&&this.mirror.hasNode(n)&&(r=this.mirror.getId(n)),r&&r!==-1&&(this.movedMap[T1(this.mirror.getId(e),r)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);fi(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(e.childNodes.forEach(r=>this.genAdds(r)),G0(e)&&e.shadowRoot.childNodes.forEach(r=>{this.processedNodeManager.add(r,this),this.genAdds(r,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(n=>{this[n]=e[n]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function q0(t,e){t.delete(e),e.childNodes.forEach(n=>q0(t,n))}function _1(t,e,n){return t.length===0?!1:JM(t,e,n)}function JM(t,e,n){const{parentNode:r}=e;if(!r)return!1;const i=n.getId(r);return t.some(s=>s.id===i)?!0:JM(t,r,n)}function I1(t,e){return t.size===0?!1:ZM(t,e)}function ZM(t,e){const{parentNode:n}=e;return n?t.has(n)?!0:ZM(t,n):!1}let od;function XJ(t){od=t}function QJ(){od=void 0}const He=t=>od?(...n)=>{try{return t(...n)}catch(r){if(od&&od(r)===!0)return()=>{};throw r}}:t,Jc=[];function bf(t){try{if("composedPath"in t){const e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch{}return t&&t.target}function KM(t,e){var n,r;const i=new YJ;Jc.push(i),i.init(t);let s=window.MutationObserver||window.__rrMutationObserver;const o=(r=(n=window==null?void 0:window.Zone)===null||n===void 0?void 0:n.__symbol__)===null||r===void 0?void 0:r.call(n,"MutationObserver");o&&window[o]&&(s=window[o]);const a=new s(He(c=>{t.onMutation&&t.onMutation(c)===!1||i.processMutations.bind(i)(c)}));return a.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function eZ({mousemoveCb:t,sampling:e,doc:n,mirror:r}){if(e.mousemove===!1)return()=>{};const i=typeof e.mousemove=="number"?e.mousemove:50,s=typeof e.mousemoveCallback=="number"?e.mousemoveCallback:500;let o=[],a;const c=zd(He(d=>{const f=Date.now()-a;t(o.map(h=>(h.timeOffset-=f,h)),d),o=[],a=null}),s),l=He(zd(He(d=>{const f=bf(d),{clientX:h,clientY:p}=H0(d)?d.changedTouches[0]:d;a||(a=Vp()),o.push({x:h,y:p,id:r.getId(f),timeOffset:Vp()-a}),c(typeof DragEvent<"u"&&d instanceof DragEvent?Be.Drag:d instanceof MouseEvent?Be.MouseMove:Be.TouchMove)}),i,{trailing:!1})),u=[Xn("mousemove",l,n),Xn("touchmove",l,n),Xn("drag",l,n)];return He(()=>{u.forEach(d=>d())})}function tZ({mouseInteractionCb:t,doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,sampling:o}){if(o.mouseInteraction===!1)return()=>{};const a=o.mouseInteraction===!0||o.mouseInteraction===void 0?{}:o.mouseInteraction,c=[];let l=null;const u=d=>f=>{const h=bf(f);if(fi(h,r,i,s,!0))return;let p=null,g=d;if("pointerType"in f){switch(f.pointerType){case"mouse":p=ys.Mouse;break;case"touch":p=ys.Touch;break;case"pen":p=ys.Pen;break}p===ys.Touch?zn[d]===zn.MouseDown?g="TouchStart":zn[d]===zn.MouseUp&&(g="TouchEnd"):ys.Pen}else H0(f)&&(p=ys.Touch);p!==null?(l=p,(g.startsWith("Touch")&&p===ys.Touch||g.startsWith("Mouse")&&p===ys.Mouse)&&(p=null)):zn[d]===zn.Click&&(p=l,l=null);const y=H0(f)?f.changedTouches[0]:f;if(!y)return;const m=n.getId(h),{clientX:v,clientY:w}=y;He(t)(Object.assign({type:zn[g],id:m,x:v,y:w},p!==null&&{pointerType:p}))};return Object.keys(zn).filter(d=>Number.isNaN(Number(d))&&!d.endsWith("_Departed")&&a[d]!==!1).forEach(d=>{let f=Wl(d);const h=u(d);if(window.PointerEvent)switch(zn[d]){case zn.MouseDown:case zn.MouseUp:f=f.replace("mouse","pointer");break;case zn.TouchStart:case zn.TouchEnd:return}c.push(Xn(f,h,e))}),He(()=>{c.forEach(d=>d())})}function YM({scrollCb:t,doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,sampling:o}){const a=He(zd(He(c=>{const l=bf(c);if(!l||fi(l,r,i,s,!0))return;const u=n.getId(l);if(l===e&&e.defaultView){const d=jM(e.defaultView);t({id:u,x:d.left,y:d.top})}else t({id:u,x:l.scrollLeft,y:l.scrollTop})}),o.scroll||100));return Xn("scroll",a,e)}function nZ({viewportResizeCb:t},{win:e}){let n=-1,r=-1;const i=He(zd(He(()=>{const s=WM(),o=VM();(n!==s||r!==o)&&(t({width:Number(o),height:Number(s)}),n=s,r=o)}),200));return Xn("resize",i,e)}const rZ=["INPUT","TEXTAREA","SELECT"],R1=new WeakMap;function iZ({inputCb:t,doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,ignoreClass:o,ignoreSelector:a,maskInputOptions:c,maskInputFn:l,sampling:u,userTriggeredOnInput:d,maskTextClass:f,unmaskTextClass:h,maskTextSelector:p,unmaskTextSelector:g}){function y(T){let R=bf(T);const A=T.isTrusted,M=R&&$0(R.tagName);if(M==="OPTION"&&(R=R.parentElement),!R||!M||rZ.indexOf(M)<0||fi(R,r,i,s,!0))return;const O=R;if(O.classList.contains(o)||a&&O.matches(a))return;const D=dw(R);let j=jp(O,M,D),V=!1;const J=Hm({maskInputOptions:c,tagName:M,type:D}),G=Vl(R,f,p,h,g,J);(D==="radio"||D==="checkbox")&&(V=R.checked),j=Wd({isMasked:G,element:R,value:j,maskInputFn:l}),m(R,d?{text:j,isChecked:V,userTriggered:A}:{text:j,isChecked:V});const te=R.name;D==="radio"&&te&&V&&e.querySelectorAll(`input[type="radio"][name="${te}"]`).forEach(z=>{if(z!==R){const Z=Wd({isMasked:G,element:z,value:jp(z,M,D),maskInputFn:l});m(z,d?{text:Z,isChecked:!V,userTriggered:!1}:{text:Z,isChecked:!V})}})}function m(T,R){const A=R1.get(T);if(!A||A.text!==R.text||A.isChecked!==R.isChecked){R1.set(T,R);const M=n.getId(T);He(t)(Object.assign(Object.assign({},R),{id:M}))}}const w=(u.input==="last"?["change"]:["input","change"]).map(T=>Xn(T,He(y),e)),_=e.defaultView;if(!_)return()=>{w.forEach(T=>T())};const C=_.Object.getOwnPropertyDescriptor(_.HTMLInputElement.prototype,"value"),k=[[_.HTMLInputElement.prototype,"value"],[_.HTMLInputElement.prototype,"checked"],[_.HTMLSelectElement.prototype,"value"],[_.HTMLTextAreaElement.prototype,"value"],[_.HTMLSelectElement.prototype,"selectedIndex"],[_.HTMLOptionElement.prototype,"selected"]];return C&&C.set&&w.push(...k.map(T=>UM(T[0],T[1],{set(){He(y)({target:this,isTrusted:!1})}},!1,_))),He(()=>{w.forEach(T=>T())})}function zp(t){const e=[];function n(r,i){if(sh("CSSGroupingRule")&&r.parentRule instanceof CSSGroupingRule||sh("CSSMediaRule")&&r.parentRule instanceof CSSMediaRule||sh("CSSSupportsRule")&&r.parentRule instanceof CSSSupportsRule||sh("CSSConditionRule")&&r.parentRule instanceof CSSConditionRule){const o=Array.from(r.parentRule.cssRules).indexOf(r);i.unshift(o)}else if(r.parentStyleSheet){const o=Array.from(r.parentStyleSheet.cssRules).indexOf(r);i.unshift(o)}return i}return n(t,e)}function Ao(t,e,n){let r,i;return t?(t.ownerNode?r=e.getId(t.ownerNode):i=n.getId(t),{styleId:i,id:r}):{}}function sZ({styleSheetRuleCb:t,mirror:e,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const i=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(i,{apply:He((u,d,f)=>{const[h,p]=f,{id:g,styleId:y}=Ao(d,e,n.styleMirror);return(g&&g!==-1||y&&y!==-1)&&t({id:g,styleId:y,adds:[{rule:h,index:p}]}),u.apply(d,f)})});const s=r.CSSStyleSheet.prototype.deleteRule;r.CSSStyleSheet.prototype.deleteRule=new Proxy(s,{apply:He((u,d,f)=>{const[h]=f,{id:p,styleId:g}=Ao(d,e,n.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,removes:[{index:h}]}),u.apply(d,f)})});let o;r.CSSStyleSheet.prototype.replace&&(o=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(o,{apply:He((u,d,f)=>{const[h]=f,{id:p,styleId:g}=Ao(d,e,n.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,replace:h}),u.apply(d,f)})}));let a;r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:He((u,d,f)=>{const[h]=f,{id:p,styleId:g}=Ao(d,e,n.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,replaceSync:h}),u.apply(d,f)})}));const c={};oh("CSSGroupingRule")?c.CSSGroupingRule=r.CSSGroupingRule:(oh("CSSMediaRule")&&(c.CSSMediaRule=r.CSSMediaRule),oh("CSSConditionRule")&&(c.CSSConditionRule=r.CSSConditionRule),oh("CSSSupportsRule")&&(c.CSSSupportsRule=r.CSSSupportsRule));const l={};return Object.entries(c).forEach(([u,d])=>{l[u]={insertRule:d.prototype.insertRule,deleteRule:d.prototype.deleteRule},d.prototype.insertRule=new Proxy(l[u].insertRule,{apply:He((f,h,p)=>{const[g,y]=p,{id:m,styleId:v}=Ao(h.parentStyleSheet,e,n.styleMirror);return(m&&m!==-1||v&&v!==-1)&&t({id:m,styleId:v,adds:[{rule:g,index:[...zp(h),y||0]}]}),f.apply(h,p)})}),d.prototype.deleteRule=new Proxy(l[u].deleteRule,{apply:He((f,h,p)=>{const[g]=p,{id:y,styleId:m}=Ao(h.parentStyleSheet,e,n.styleMirror);return(y&&y!==-1||m&&m!==-1)&&t({id:y,styleId:m,removes:[{index:[...zp(h),g]}]}),f.apply(h,p)})})}),He(()=>{r.CSSStyleSheet.prototype.insertRule=i,r.CSSStyleSheet.prototype.deleteRule=s,o&&(r.CSSStyleSheet.prototype.replace=o),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(c).forEach(([u,d])=>{d.prototype.insertRule=l[u].insertRule,d.prototype.deleteRule=l[u].deleteRule})})}function XM({mirror:t,stylesheetManager:e},n){var r,i,s;let o=null;n.nodeName==="#document"?o=t.getId(n):o=t.getId(n.host);const a=n.nodeName==="#document"?(r=n.defaultView)===null||r===void 0?void 0:r.Document:(s=(i=n.ownerDocument)===null||i===void 0?void 0:i.defaultView)===null||s===void 0?void 0:s.ShadowRoot,c=a!=null&&a.prototype?Object.getOwnPropertyDescriptor(a==null?void 0:a.prototype,"adoptedStyleSheets"):void 0;return o===null||o===-1||!a||!c?()=>{}:(Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get(){var l;return(l=c.get)===null||l===void 0?void 0:l.call(this)},set(l){var u;const d=(u=c.set)===null||u===void 0?void 0:u.call(this,l);if(o!==null&&o!==-1)try{e.adoptStyleSheets(l,o)}catch{}return d}}),He(()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get:c.get,set:c.set})}))}function oZ({styleDeclarationCb:t,mirror:e,ignoreCSSAttributes:n,stylesheetManager:r},{win:i}){const s=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:He((a,c,l)=>{var u;const[d,f,h]=l;if(n.has(d))return s.apply(c,[d,f,h]);const{id:p,styleId:g}=Ao((u=c.parentRule)===null||u===void 0?void 0:u.parentStyleSheet,e,r.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,set:{property:d,value:f,priority:h},index:zp(c.parentRule)}),a.apply(c,l)})});const o=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(o,{apply:He((a,c,l)=>{var u;const[d]=l;if(n.has(d))return o.apply(c,[d]);const{id:f,styleId:h}=Ao((u=c.parentRule)===null||u===void 0?void 0:u.parentStyleSheet,e,r.styleMirror);return(f&&f!==-1||h&&h!==-1)&&t({id:f,styleId:h,remove:{property:d},index:zp(c.parentRule)}),a.apply(c,l)})}),He(()=>{i.CSSStyleDeclaration.prototype.setProperty=s,i.CSSStyleDeclaration.prototype.removeProperty=o})}function aZ({mediaInteractionCb:t,blockClass:e,blockSelector:n,unblockSelector:r,mirror:i,sampling:s,doc:o}){const a=He(l=>zd(He(u=>{const d=bf(u);if(!d||fi(d,e,n,r,!0))return;const{currentTime:f,volume:h,muted:p,playbackRate:g}=d;t({type:l,id:i.getId(d),currentTime:f,volume:h,muted:p,playbackRate:g})}),s.media||500)),c=[Xn("play",a(0),o),Xn("pause",a(1),o),Xn("seeked",a(2),o),Xn("volumechange",a(3),o),Xn("ratechange",a(4),o)];return He(()=>{c.forEach(l=>l())})}function cZ({fontCb:t,doc:e}){const n=e.defaultView;if(!n)return()=>{};const r=[],i=new WeakMap,s=n.FontFace;n.FontFace=function(c,l,u){const d=new s(c,l,u);return i.set(d,{family:c,buffer:typeof l!="string",descriptors:u,fontSource:typeof l=="string"?l:JSON.stringify(Array.from(new Uint8Array(l)))}),d};const o=pw(e.fonts,"add",function(a){return function(c){return setTimeout(He(()=>{const l=i.get(c);l&&(t(l),i.delete(c))}),0),a.apply(this,[c])}});return r.push(()=>{n.FontFace=s}),r.push(o),He(()=>{r.forEach(a=>a())})}function lZ(t){const{doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,selectionCb:o}=t;let a=!0;const c=He(()=>{const l=e.getSelection();if(!l||a&&(l!=null&&l.isCollapsed))return;a=l.isCollapsed||!1;const u=[],d=l.rangeCount||0;for(let f=0;f<d;f++){const h=l.getRangeAt(f),{startContainer:p,startOffset:g,endContainer:y,endOffset:m}=h;fi(p,r,i,s,!0)||fi(y,r,i,s,!0)||u.push({start:n.getId(p),startOffset:g,end:n.getId(y),endOffset:m})}o({ranges:u})});return c(),Xn("selectionchange",c)}function uZ({doc:t,customElementCb:e}){const n=t.defaultView;return!n||!n.customElements?()=>{}:pw(n.customElements,"define",function(i){return function(s,o,a){try{e({define:{name:s}})}catch{}return i.apply(this,[s,o,a])}})}function dZ(t,e={}){const n=t.doc.defaultView;if(!n)return()=>{};const r=KM(t,t.doc),i=eZ(t),s=tZ(t),o=YM(t),a=nZ(t,{win:n}),c=iZ(t),l=aZ(t),u=sZ(t,{win:n}),d=XM(t,t.doc),f=oZ(t,{win:n}),h=t.collectFonts?cZ(t):()=>{},p=lZ(t),g=uZ(t),y=[];for(const m of t.plugins)y.push(m.observer(m.callback,n,m.options));return He(()=>{Jc.forEach(m=>m.reset()),r.disconnect(),i(),s(),o(),a(),c(),l(),u(),d(),f(),h(),p(),g(),y.forEach(m=>m())})}function sh(t){return typeof window[t]<"u"}function oh(t){return!!(typeof window[t]<"u"&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}class J0{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,n,r,i){const s=r||this.getIdToRemoteIdMap(e),o=i||this.getRemoteIdToIdMap(e);let a=s.get(n);return a||(a=this.generateIdFn(),s.set(n,a),o.set(a,n)),a}getIds(e,n){const r=this.getIdToRemoteIdMap(e),i=this.getRemoteIdToIdMap(e);return n.map(s=>this.getId(e,s,r,i))}getRemoteId(e,n,r){const i=r||this.getRemoteIdToIdMap(e);if(typeof n!="number")return n;const s=i.get(n);return s||-1}getRemoteIds(e,n){const r=this.getRemoteIdToIdMap(e);return n.map(i=>this.getRemoteId(e,i,r))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let n=this.iframeIdToRemoteIdMap.get(e);return n||(n=new Map,this.iframeIdToRemoteIdMap.set(e,n)),n}getRemoteIdToIdMap(e){let n=this.iframeRemoteIdToIdMap.get(e);return n||(n=new Map,this.iframeRemoteIdToIdMap.set(e,n)),n}}class fZ{constructor(){this.crossOriginIframeMirror=new J0(fw),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class hZ{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new J0(fw),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new J0(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,n){var r;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:n}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(r=this.loadListener)===null||r===void 0||r.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const n=e;if(n.data.type!=="rrweb"||n.origin!==n.data.origin||!e.source)return;const i=this.crossOriginIframeMap.get(e.source);if(!i)return;const s=this.transformCrossOriginEvent(i,n.data.event);s&&this.wrappedEmit(s,n.data.isCheckout)}transformCrossOriginEvent(e,n){var r;switch(n.type){case Fe.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(n.data.node,e);const i=n.data.node.id;return this.crossOriginIframeRootIdMap.set(e,i),this.patchRootIdOnNode(n.data.node,i),{timestamp:n.timestamp,type:Fe.IncrementalSnapshot,data:{source:Be.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:n.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case Fe.Meta:case Fe.Load:case Fe.DomContentLoaded:return!1;case Fe.Plugin:return n;case Fe.Custom:return this.replaceIds(n.data.payload,e,["id","parentId","previousId","nextId"]),n;case Fe.IncrementalSnapshot:switch(n.data.source){case Be.Mutation:return n.data.adds.forEach(i=>{this.replaceIds(i,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(i.node,e);const s=this.crossOriginIframeRootIdMap.get(e);s&&this.patchRootIdOnNode(i.node,s)}),n.data.removes.forEach(i=>{this.replaceIds(i,e,["parentId","id"])}),n.data.attributes.forEach(i=>{this.replaceIds(i,e,["id"])}),n.data.texts.forEach(i=>{this.replaceIds(i,e,["id"])}),n;case Be.Drag:case Be.TouchMove:case Be.MouseMove:return n.data.positions.forEach(i=>{this.replaceIds(i,e,["id"])}),n;case Be.ViewportResize:return!1;case Be.MediaInteraction:case Be.MouseInteraction:case Be.Scroll:case Be.CanvasMutation:case Be.Input:return this.replaceIds(n.data,e,["id"]),n;case Be.StyleSheetRule:case Be.StyleDeclaration:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleId"]),n;case Be.Font:return n;case Be.Selection:return n.data.ranges.forEach(i=>{this.replaceIds(i,e,["start","end"])}),n;case Be.AdoptedStyleSheet:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleIds"]),(r=n.data.styles)===null||r===void 0||r.forEach(i=>{this.replaceStyleIds(i,e,["styleId"])}),n}}return!1}replace(e,n,r,i){for(const s of i)!Array.isArray(n[s])&&typeof n[s]!="number"||(Array.isArray(n[s])?n[s]=e.getIds(r,n[s]):n[s]=e.getId(r,n[s]));return n}replaceIds(e,n,r){return this.replace(this.crossOriginIframeMirror,e,n,r)}replaceStyleIds(e,n,r){return this.replace(this.crossOriginIframeStyleMirror,e,n,r)}replaceIdOnNode(e,n){this.replaceIds(e,n,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(r=>{this.replaceIdOnNode(r,n)})}patchRootIdOnNode(e,n){e.type!==nn.Document&&!e.rootId&&(e.rootId=n),"childNodes"in e&&e.childNodes.forEach(r=>{this.patchRootIdOnNode(r,n)})}}class pZ{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class mZ{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,n){if(!sd(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e);const r=KM(Object.assign(Object.assign({},this.bypassOptions),{doc:n,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push(()=>r.disconnect()),this.restoreHandlers.push(YM(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(XM({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){!e.contentWindow||!e.contentDocument||this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,n){const r=this;this.restoreHandlers.push(pw(e.prototype,"attachShadow",function(i){return function(s){const o=i.call(this,s);return this.shadowRoot&&qM(this)&&r.addShadowRoot(this.shadowRoot,n),o}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}class gZ{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}}class vZ{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new qJ,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,n){"_cssText"in n.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:n.id,attributes:n.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,n){if(e.length===0)return;const r={id:n,styleIds:[]},i=[];for(const s of e){let o;this.styleMirror.has(s)?o=this.styleMirror.getId(s):(o=this.styleMirror.add(s),i.push({styleId:o,rules:Array.from(s.rules||CSSRule,(a,c)=>({rule:DM(a),index:c}))})),r.styleIds.push(o)}i.length>0&&(r.styles=i),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class yZ{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(e,n){const r=this.nodeMap.get(e);return r&&Array.from(r).some(i=>i!==n)}add(e,n){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(n))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}function Gt(t){const e=t;return e.timestamp=Vp(),e}let Z0,$p;const Xr=wJ();function ra(t={}){const{emit:e,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:i="rr-block",blockSelector:s=null,unblockSelector:o=null,ignoreClass:a="rr-ignore",ignoreSelector:c=null,maskAllText:l=!1,maskTextClass:u="rr-mask",unmaskTextClass:d=null,maskTextSelector:f=null,unmaskTextSelector:h=null,inlineStylesheet:p=!0,maskAllInputs:g,maskInputOptions:y,slimDOMOptions:m,maskAttributeFn:v,maskInputFn:w,maskTextFn:_,packFn:C,sampling:k={},dataURLOptions:T={},mousemoveWait:R,recordCanvas:A=!1,recordCrossOriginIframes:M=!1,recordAfter:O=t.recordAfter==="DOMContentLoaded"?t.recordAfter:"load",userTriggeredOnInput:D=!1,collectFonts:j=!1,inlineImages:V=!1,plugins:J,keepIframeSrcFn:G=()=>!1,ignoreCSSAttributes:te=new Set([]),errorHandler:z,onMutation:Z,getCanvasManager:ie}=t;XJ(z);const q=M?window.parent===window:!0;let se=!1;if(!q)try{window.parent.document&&(se=!1)}catch{se=!0}if(q&&!e)throw new Error("emit function is required");R!==void 0&&k.mousemove===void 0&&(k.mousemove=R),Xr.reset();const ke=g===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:y!==void 0?y:{},Ee=m===!0||m==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:m==="all",headMetaDescKeywords:m==="all"}:m||{};GJ();let me,Te=0;const Ue=ue=>{for(const Le of J||[])Le.eventProcessor&&(ue=Le.eventProcessor(ue));return C&&!se&&(ue=C(ue)),ue},ce=(ue,Le)=>{var Re;if(!((Re=Jc[0])===null||Re===void 0)&&Re.isFrozen()&&ue.type!==Fe.FullSnapshot&&!(ue.type===Fe.IncrementalSnapshot&&ue.data.source===Be.Mutation)&&Jc.forEach(je=>je.unfreeze()),q)e==null||e(Ue(ue),Le);else if(se){const je={type:"rrweb",event:Ue(ue),origin:window.location.origin,isCheckout:Le};window.parent.postMessage(je,"*")}if(ue.type===Fe.FullSnapshot)me=ue,Te=0;else if(ue.type===Fe.IncrementalSnapshot){if(ue.data.source===Be.Mutation&&ue.data.isAttachIframe)return;Te++;const je=r&&Te>=r,Ut=n&&ue.timestamp-me.timestamp>n;(je||Ut)&&Je(!0)}};Z0=ce;const xt=ue=>{ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.Mutation},ue)}))},cn=ue=>ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.Scroll},ue)})),Et=ue=>ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.CanvasMutation},ue)})),Sn=ue=>ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.AdoptedStyleSheet},ue)})),Zt=new vZ({mutationCb:xt,adoptedStyleSheetCb:Sn}),bn=typeof __RRWEB_EXCLUDE_IFRAME__=="boolean"&&__RRWEB_EXCLUDE_IFRAME__?new fZ:new hZ({mirror:Xr,mutationCb:xt,stylesheetManager:Zt,recordCrossOriginIframes:M,wrappedEmit:ce});for(const ue of J||[])ue.getMirror&&ue.getMirror({nodeMirror:Xr,crossOriginIframeMirror:bn.crossOriginIframeMirror,crossOriginIframeStyleMirror:bn.crossOriginIframeStyleMirror});const le=new yZ,Se=wZ(ie,{recordCanvas:A,blockClass:i,blockSelector:s,unblockSelector:o,sampling:k.canvas,dataURLOptions:T}),Ye=typeof __RRWEB_EXCLUDE_SHADOW_DOM__=="boolean"&&__RRWEB_EXCLUDE_SHADOW_DOM__?new pZ:new mZ({mutationCb:xt,scrollCb:cn,bypassOptions:{onMutation:Z,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,inlineStylesheet:p,maskInputOptions:ke,dataURLOptions:T,maskAttributeFn:v,maskTextFn:_,maskInputFn:w,recordCanvas:A,inlineImages:V,sampling:k,slimDOMOptions:Ee,iframeManager:bn,stylesheetManager:Zt,canvasManager:Se,keepIframeSrcFn:G,processedNodeManager:le},mirror:Xr}),Je=(ue=!1)=>{ce(Gt({type:Fe.Meta,data:{href:window.location.href,width:VM(),height:WM()}}),ue),Zt.reset(),Ye.init(),Jc.forEach(Re=>Re.lock());const Le=$J(document,{mirror:Xr,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,inlineStylesheet:p,maskAllInputs:ke,maskAttributeFn:v,maskInputFn:w,maskTextFn:_,slimDOM:Ee,dataURLOptions:T,recordCanvas:A,inlineImages:V,onSerialize:Re=>{$M(Re,Xr)&&bn.addIframe(Re),HM(Re,Xr)&&Zt.trackLinkElement(Re),G0(Re)&&Ye.addShadowRoot(Re.shadowRoot,document)},onIframeLoad:(Re,je)=>{bn.attachIframe(Re,je),Ye.observeAttachShadow(Re)},onStylesheetLoad:(Re,je)=>{Zt.attachLinkElement(Re,je)},keepIframeSrcFn:G});if(!Le)return console.warn("Failed to snapshot the document");ce(Gt({type:Fe.FullSnapshot,data:{node:Le,initialOffset:jM(window)}})),Jc.forEach(Re=>Re.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&Zt.adoptStyleSheets(document.adoptedStyleSheets,Xr.getId(document))};$p=Je;try{const ue=[],Le=je=>{var Ut;return He(dZ)({onMutation:Z,mutationCb:xt,mousemoveCb:(Oe,Ht)=>ce(Gt({type:Fe.IncrementalSnapshot,data:{source:Ht,positions:Oe}})),mouseInteractionCb:Oe=>ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.MouseInteraction},Oe)})),scrollCb:cn,viewportResizeCb:Oe=>ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.ViewportResize},Oe)})),inputCb:Oe=>ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.Input},Oe)})),mediaInteractionCb:Oe=>ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.MediaInteraction},Oe)})),styleSheetRuleCb:Oe=>ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.StyleSheetRule},Oe)})),styleDeclarationCb:Oe=>ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.StyleDeclaration},Oe)})),canvasMutationCb:Et,fontCb:Oe=>ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.Font},Oe)})),selectionCb:Oe=>{ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.Selection},Oe)}))},customElementCb:Oe=>{ce(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.CustomElement},Oe)}))},blockClass:i,ignoreClass:a,ignoreSelector:c,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,maskInputOptions:ke,inlineStylesheet:p,sampling:k,recordCanvas:A,inlineImages:V,userTriggeredOnInput:D,collectFonts:j,doc:je,maskAttributeFn:v,maskInputFn:w,maskTextFn:_,keepIframeSrcFn:G,blockSelector:s,unblockSelector:o,slimDOMOptions:Ee,dataURLOptions:T,mirror:Xr,iframeManager:bn,stylesheetManager:Zt,shadowDomManager:Ye,processedNodeManager:le,canvasManager:Se,ignoreCSSAttributes:te,plugins:((Ut=J==null?void 0:J.filter(Oe=>Oe.observer))===null||Ut===void 0?void 0:Ut.map(Oe=>({observer:Oe.observer,options:Oe.options,callback:Ht=>ce(Gt({type:Fe.Plugin,data:{plugin:Oe.name,payload:Ht}}))})))||[]},{})};bn.addLoadListener(je=>{try{ue.push(Le(je.contentDocument))}catch(Ut){console.warn(Ut)}});const Re=()=>{Je(),ue.push(Le(document))};return document.readyState==="interactive"||document.readyState==="complete"?Re():(ue.push(Xn("DOMContentLoaded",()=>{ce(Gt({type:Fe.DomContentLoaded,data:{}})),O==="DOMContentLoaded"&&Re()})),ue.push(Xn("load",()=>{ce(Gt({type:Fe.Load,data:{}})),O==="load"&&Re()},window))),()=>{ue.forEach(je=>je()),le.destroy(),$p=void 0,QJ()}}catch(ue){console.warn(ue)}}function SZ(t){if(!$p)throw new Error("please take full snapshot after start recording");$p(t)}function bZ(t){Z0&&Z0(t)}ra.mirror=Xr;ra.takeFullSnapshot=SZ;function wZ(t,e){return t?t(Object.assign(Object.assign({},e),{mirror:Xr,win:window,mutationCb:n=>bZ(Gt({type:Fe.IncrementalSnapshot,data:Object.assign({source:Be.CanvasMutation},n)}))})):new gZ}const kZ=3,EZ=5;function mw(t){return t>9999999999?t:t*1e3}function gv(t){return t>9999999999?t/1e3:t}function wf(t,e){e.category!=="sentry.transaction"&&(["ui.click","ui.input"].includes(e.category)?t.triggerUserActivity():t.checkAndHandleExpiredSession(),t.addUpdate(()=>(t.throttledAddEvent({type:Fe.Custom,timestamp:(e.timestamp||0)*1e3,data:{tag:"breadcrumb",payload:Bi(e,10,1e3)}}),e.category==="console")))}const CZ="button,a";function QM(t){return t.closest(CZ)||t}function ex(t){const e=tx(t);return!e||!(e instanceof Element)?e:QM(e)}function tx(t){return TZ(t)?t.target:t}function TZ(t){return typeof t=="object"&&!!t&&"target"in t}let No;function _Z(t){return No||(No=[],IZ()),No.push(t),()=>{const e=No?No.indexOf(t):-1;e>-1&&No.splice(e,1)}}function IZ(){gn(ht,"open",function(t){return function(...e){if(No)try{No.forEach(n=>n())}catch{}return t.apply(ht,e)}})}function RZ(t,e,n){t.handleClick(e,n)}class PZ{constructor(e,n,r=wf){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=n.timeout/1e3,this._threshold=n.threshold/1e3,this._scollTimeout=n.scrollTimeout/1e3,this._replay=e,this._ignoreSelector=n.ignoreSelector,this._addBreadcrumbEvent=r}addListeners(){const e=_Z(()=>{this._lastMutation=P1()});this._teardown=()=>{e(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(e,n){if(NZ(n,this._ignoreSelector)||!MZ(e))return;const r={timestamp:gv(e.timestamp),clickBreadcrumb:e,clickCount:0,node:n};this._clicks.some(i=>i.node===r.node&&Math.abs(i.timestamp-r.timestamp)<1)||(this._clicks.push(r),this._clicks.length===1&&this._scheduleCheckClicks())}registerMutation(e=Date.now()){this._lastMutation=gv(e)}registerScroll(e=Date.now()){this._lastScroll=gv(e)}registerClick(e){const n=QM(e);this._handleMultiClick(n)}_handleMultiClick(e){this._getClicks(e).forEach(n=>{n.clickCount++})}_getClicks(e){return this._clicks.filter(n=>n.node===e)}_checkClicks(){const e=[],n=P1();this._clicks.forEach(r=>{!r.mutationAfter&&this._lastMutation&&(r.mutationAfter=r.timestamp<=this._lastMutation?this._lastMutation-r.timestamp:void 0),!r.scrollAfter&&this._lastScroll&&(r.scrollAfter=r.timestamp<=this._lastScroll?this._lastScroll-r.timestamp:void 0),r.timestamp+this._timeout<=n&&e.push(r)});for(const r of e){const i=this._clicks.indexOf(r);i>-1&&(this._generateBreadcrumbs(r),this._clicks.splice(i,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(e){const n=this._replay,r=e.scrollAfter&&e.scrollAfter<=this._scollTimeout,i=e.mutationAfter&&e.mutationAfter<=this._threshold,s=!r&&!i,{clickCount:o,clickBreadcrumb:a}=e;if(s){const c=Math.min(e.mutationAfter||this._timeout,this._timeout)*1e3,l=c<this._timeout*1e3?"mutation":"timeout",u={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.slowClickDetected",data:{...a.data,url:ht.location.href,route:n.getCurrentRoute(),timeAfterClickMs:c,endReason:l,clickCount:o||1}};this._addBreadcrumbEvent(n,u);return}if(o>1){const c={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.multiClick",data:{...a.data,url:ht.location.href,route:n.getCurrentRoute(),clickCount:o,metric:!0}};this._addBreadcrumbEvent(n,c)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=setTimeout(()=>this._checkClicks(),1e3)}}const AZ=["A","BUTTON","INPUT"];function NZ(t,e){return!!(!AZ.includes(t.tagName)||t.tagName==="INPUT"&&!["submit","button"].includes(t.getAttribute("type")||"")||t.tagName==="A"&&(t.hasAttribute("download")||t.hasAttribute("target")&&t.getAttribute("target")!=="_self")||e&&t.matches(e))}function MZ(t){return!!(t.data&&typeof t.data.nodeId=="number"&&t.timestamp)}function P1(){return Date.now()/1e3}function xZ(t,e){try{if(!OZ(e))return;const{source:n}=e.data;if(n===Be.Mutation&&t.registerMutation(e.timestamp),n===Be.Scroll&&t.registerScroll(e.timestamp),DZ(e)){const{type:r,id:i}=e.data,s=ra.mirror.getNode(i);s instanceof HTMLElement&&r===zn.Click&&t.registerClick(s)}}catch{}}function OZ(t){return t.type===kZ}function DZ(t){return t.data.source===Be.MouseInteraction}function os(t){return{timestamp:Date.now()/1e3,type:"default",...t}}var Hp;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(Hp||(Hp={}));const LZ=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function FZ(t){const e={};for(const n in t)if(LZ.has(n)){let r=n;(n==="data-testid"||n==="data-test-id")&&(r="testId"),e[r]=t[n]}return e}const BZ=t=>e=>{if(!t.isEnabled())return;const n=UZ(e);if(!n)return;const r=e.name==="click",i=r?e.event:void 0;r&&t.clickDetector&&i&&i.target&&!i.altKey&&!i.metaKey&&!i.ctrlKey&&!i.shiftKey&&RZ(t.clickDetector,n,ex(e.event)),wf(t,n)};function nx(t,e){const n=ra.mirror.getId(t),r=n&&ra.mirror.getNode(n),i=r&&ra.mirror.getMeta(r),s=i&&WZ(i)?i:null;return{message:e,data:s?{nodeId:n,node:{id:n,tagName:s.tagName,textContent:Array.from(s.childNodes).map(o=>o.type===Hp.Text&&o.textContent).filter(Boolean).map(o=>o.trim()).join(""),attributes:FZ(s.attributes)}}:{}}}function UZ(t){const{target:e,message:n}=jZ(t);return os({category:`ui.${t.name}`,...nx(e,n)})}function jZ(t){const e=t.name==="click";let n,r=null;try{r=e?ex(t.event):tx(t.event),n=nc(r,{maxStringLength:200})||"<unknown>"}catch{n="<unknown>"}return{target:r,message:n}}function WZ(t){return t.type===Hp.Element}function VZ(t,e){if(!t.isEnabled())return;t.updateUserActivity();const n=zZ(e);n&&wf(t,n)}function zZ(t){const{metaKey:e,shiftKey:n,ctrlKey:r,altKey:i,key:s,target:o}=t;if(!o||$Z(o)||!s)return null;const a=e||r||i,c=s.length===1;if(!a&&c)return null;const l=nc(o,{maxStringLength:200})||"<unknown>",u=nx(o,l);return os({category:"ui.keyDown",message:l,data:{...u.data,metaKey:e,shiftKey:n,ctrlKey:r,altKey:i,key:s}})}function $Z(t){return t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable}const A1={resource:ZZ,paint:qZ,navigation:JZ};function HZ(t){return t.map(GZ).filter(Boolean)}function GZ(t){return A1[t.entryType]?A1[t.entryType](t):null}function zl(t){return((Ii||ht.performance.timeOrigin)+t)/1e3}function qZ(t){const{duration:e,entryType:n,name:r,startTime:i}=t,s=zl(i);return{type:n,name:r,start:s,end:s+e,data:void 0}}function JZ(t){const{entryType:e,name:n,decodedBodySize:r,duration:i,domComplete:s,encodedBodySize:o,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,domInteractive:l,loadEventStart:u,loadEventEnd:d,redirectCount:f,startTime:h,transferSize:p,type:g}=t;return i===0?null:{type:`${e}.${g}`,start:zl(h),end:zl(s),name:n,data:{size:p,decodedBodySize:r,encodedBodySize:o,duration:i,domInteractive:l,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,loadEventStart:u,loadEventEnd:d,domComplete:s,redirectCount:f}}}function ZZ(t){const{entryType:e,initiatorType:n,name:r,responseEnd:i,startTime:s,decodedBodySize:o,encodedBodySize:a,responseStatus:c,transferSize:l}=t;return["fetch","xmlhttprequest"].includes(n)?null:{type:`${e}.${n}`,start:zl(s),end:zl(i),name:r,data:{size:l,statusCode:c,decodedBodySize:o,encodedBodySize:a}}}function KZ(t){const e=t.entries,n=e[e.length-1],r=n?n.element:void 0,i=t.value,s=zl(i);return{type:"largest-contentful-paint",name:"largest-contentful-paint",start:s,end:s,data:{value:i,size:i,nodeId:r?ra.mirror.getId(r):void 0}}}function YZ(t){function e(i){t.performanceEntries.includes(i)||t.performanceEntries.push(i)}function n({entries:i}){i.forEach(e)}const r=[];return["navigation","paint","resource"].forEach(i=>{r.push(zm(i,n))}),r.push(NM(({metric:i})=>{t.replayPerformanceEntries.push(KZ(i))})),()=>{r.forEach(i=>i())}}const ct=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,XZ='var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var i=new n(31),a=0;a<31;++a)i[a]=e+=1<<t[a-1];var s=new r(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return{b:i,r:s}},o=s(e,2),f=o.b,h=o.r;f[28]=258,h[258]=28;for(var l=s(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,a=0,s=new n(r);a<i;++a)t[a]&&++s[t[a]-1];var o,f=new n(r);for(a=1;a<r;++a)f[a]=f[a-1]+s[a-1]<<1;if(e){o=new n(1<<r);var h=15-r;for(a=0;a<i;++a)if(t[a])for(var l=a<<4|t[a],c=r-t[a],v=f[t[a]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>h]=l}else for(o=new n(i),a=0;a<i;++a)t[a]&&(o[a]=u[f[t[a]-1]++]>>15-t[a]);return o},g=new t(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var w=new t(32);for(c=0;c<32;++c)w[c]=5;var p=d(g,9,0),y=d(w,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==r||r<0)&&(r=0),(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},A=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},_=function(r,e){for(var i=[],a=0;a<r.length;++a)r[a]&&i.push({s:a,f:r[a]});var s=i.length,o=i.slice();if(!s)return{t:F,l:0};if(1==s){var f=new t(i[0].s+1);return f[i[0].s]=1,{t:f,l:1}}i.sort((function(t,n){return t.f-n.f})),i.push({s:-1,f:25001});var h=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:h.f+l.f,l:h,r:l};c!=s-1;)h=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:h.f+l.f,l:h,r:l};var d=o[0].s;for(a=1;a<s;++a)o[a].s>d&&(d=o[a].s);var g=new n(d+1),w=x(i[c-1],g,0);if(w>e){a=0;var p=0,y=w-e,m=1<<y;for(o.sort((function(t,n){return g[n.s]-g[t.s]||t.f-n.f}));a<s;++a){var b=o[a].s;if(!(g[b]>e))break;p+=m-(1<<w-g[b]),g[b]=e}for(p>>=y;p>0;){var M=o[a].s;g[M]<e?p-=1<<e-g[M]++-1:++a}for(;a>=0&&p;--a){var E=o[a].s;g[E]==e&&(--g[E],++p)}w=e}return{t:new t(g),l:w}},x=function(t,n,r){return-1==t.s?Math.max(x(t.l,n,r+1),x(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,a=t[0],s=1,o=function(t){e[i++]=t},f=1;f<=r;++f)if(t[f]==a&&f!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[f]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var a=0;a<e;++a)t[i+a+4]=r[a];return 8*(i+4+e)},C=function(t,r,s,o,f,h,l,u,c,v,m){z(r,m++,s),++f[256];for(var b=_(f,15),M=b.t,E=b.l,x=_(h,15),C=x.t,U=x.l,F=D(M),I=F.c,S=F.n,L=D(C),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=_(q,7),H=G.t,J=G.l,K=19;K>4&&!H[a[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(f,g)+T(h,w)+l,X=T(f,M)+T(h,C)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(C,U,0),R=C;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[a[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=p,P=g,Q=y,R=w;for(B=0;B<u;++B){var rt=o[B];if(rt>255){A(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;A(r,m,Q[et]),m+=R[et],et>3&&(A(r,m,rt>>5&8191),m+=i[et])}else A(r,m,N[rt]),m+=P[rt]}return A(r,m,N[256]),m+P[256]},U=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,a=0|r.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=e+=r[s];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},L=function(a,s,o,f,u){if(!u&&(u={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),v=new t(c.length+a.length);v.set(c),v.set(a,c.length),a=v,u.w=c.length}return function(a,s,o,f,u,c){var v=c.z||a.length,d=new t(f+v+5*(1+Math.ceil(v/7e3))+u),g=d.subarray(f,d.length-u),w=c.l,p=7&(c.r||0);if(s){p&&(g[0]=c.r>>3);for(var y=U[s-1],M=y>>13,E=8191&y,z=(1<<o)-1,A=c.p||new n(32768),_=c.h||new n(z+1),x=Math.ceil(o/3),D=2*x,T=function(t){return(a[t]^a[t+1]<<x^a[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=_[H];if(A[J]=K,_[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!w)){p=C(a,g,0,F,I,S,O,q,G,j-G,p),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(a[j+Q]==a[j+Q-W]){for(var $=0;$<Z&&a[j+$]==a[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-A[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=A[J])&32767}if(R){F[q++]=268435456|h[Q]<<18|l[R];var it=31&h[Q],at=31&l[R];O+=e[it]+i[at],++I[257+it],++S[at],B=j+Q,++L}else F[q++]=a[j],++I[a[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=a[j],++I[a[j]];p=C(a,g,w,F,I,S,O,q,G,j-G,p),w||(c.r=7&p|g[p/8|0]<<3,p-=7,c.h=_,c.p=A,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+w;j+=65535){var st=j+65535;st>=v&&(g[p/8|0]=w,st=v),p=k(g,p+1,a.subarray(j,st))}c.i=v}return b(d,0,f+m(p)+u)}(a,null==s.level?6:s.level,null==s.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+s.mem,o,f,u)},O=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},j=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(L(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var a=this.b.length-this.s.z;a&&(this.b.set(n.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1)),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(a),32768),this.s.z=n.length-a+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n}();function q(t,n){n||(n={});var r=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}}(),e=t.length;r.p(t);var i,a=L(t,n,10+((i=n).filename?i.filename.length+1:0),8),s=a.length;return function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&O(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}}(a,n),O(a,s-8,r.d()),O(a,s-4,e),a}var B=function(){function t(t,n){this.c=S(),this.v=1,j.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),j.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=L(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=S();i.p(n.dictionary),O(t,2,i.d())}}(r,this.o),this.v=0),n&&O(r,r.length-4,this.c.d()),this.ondata(r,n)},t}(),G="undefined"!=typeof TextEncoder&&new TextEncoder,H="undefined"!=typeof TextDecoder&&new TextDecoder;try{H.decode(F,{stream:!0})}catch(t){}var J=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(K(t),this.d=n||!1)},t}();function K(n,r){if(r){for(var e=new t(n.length),i=0;i<n.length;++i)e[i]=n.charCodeAt(i);return e}if(G)return G.encode(n);var a=n.length,s=new t(n.length+(n.length>>1)),o=0,f=function(t){s[o++]=t};for(i=0;i<a;++i){if(o+5>s.length){var h=new t(o+8+(a-i<<1));h.set(s),s=h}var l=n.charCodeAt(i);l<128||r?f(l):l<2048?(f(192|l>>6),f(128|63&l)):l>55295&&l<57344?(f(240|(l=65536+(1047552&l)|1023&n.charCodeAt(++i))>>18),f(128|l>>12&63),f(128|l>>6&63),f(128|63&l)):(f(224|l>>12),f(128|l>>6&63),f(128|63&l))}return b(s,0,o)}const N=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(let r=0,e=t.length;r<e;r++)n+=t[r].length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new B,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new J(((t,n)=>{this.deflate.push(t,n)})),this.stream.push("[")}},P={clear:()=>{N.clear()},addEvent:t=>N.addEvent(t),finish:()=>N.finish(),compress:t=>function(t){return q(K(t))}(t)};addEventListener("message",(function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in P&&"function"==typeof P[n])try{const t=P[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});';function QZ(){const t=new Blob([XZ]);return URL.createObjectURL(t)}function Jn(t,e){ct&&(K.info(t),e&&rx(t))}function ml(t,e){ct&&(K.info(t),e&&setTimeout(()=>{rx(t)},0))}function rx(t){fa({category:"console",data:{logger:"replay"},level:"info",message:t},{level:"info"})}class gw extends Error{constructor(){super(`Event buffer exceeded maximum size of ${uw}.`)}}class ix{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(e){const n=JSON.stringify(e).length;if(this._totalSize+=n,this._totalSize>uw)throw new gw;this.events.push(e)}finish(){return new Promise(e=>{const n=this.events;this.clear(),e(JSON.stringify(n))})}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const e=this.events.map(n=>n.timestamp).sort()[0];return e?mw(e):null}}class eK{constructor(e){this._worker=e,this._id=0}ensureReady(){return this._ensureReadyPromise?this._ensureReadyPromise:(this._ensureReadyPromise=new Promise((e,n)=>{this._worker.addEventListener("message",({data:r})=>{r.success?e():n()},{once:!0}),this._worker.addEventListener("error",r=>{n(r)},{once:!0})}),this._ensureReadyPromise)}destroy(){Jn("[Replay] Destroying compression worker"),this._worker.terminate()}postMessage(e,n){const r=this._getAndIncrementId();return new Promise((i,s)=>{const o=({data:a})=>{const c=a;if(c.method===e&&c.id===r){if(this._worker.removeEventListener("message",o),!c.success){ct&&K.error("[Replay]",c.response),s(new Error("Error in compression worker"));return}i(c.response)}};this._worker.addEventListener("message",o),this._worker.postMessage({id:r,method:e,arg:n})})}_getAndIncrementId(){return this._id++}}class tK{constructor(e){this._worker=new eK(e),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(e){const n=mw(e.timestamp);(!this._earliestTimestamp||n<this._earliestTimestamp)&&(this._earliestTimestamp=n);const r=JSON.stringify(e);return this._totalSize+=r.length,this._totalSize>uw?Promise.reject(new gw):this._sendEventToWorker(r)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear").then(null,e=>{ct&&K.warn('[Replay] Sending "clear" message to worker failed',e)})}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(e){return this._worker.postMessage("addEvent",e)}async _finishRequest(){const e=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,e}}class nK{constructor(e){this._fallback=new ix,this._compression=new tK(e),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(e){this._used.hasCheckout=e}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(e){return this._used.addEvent(e)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch{Jn("[Replay] Failed to load the compression worker, falling back to simple buffer");return}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:e,hasCheckout:n}=this._fallback,r=[];for(const i of e)r.push(this._compression.addEvent(i));this._compression.hasCheckout=n,this._used=this._compression;try{await Promise.all(r)}catch(i){ct&&K.warn("[Replay] Failed to add events when switching buffers.",i)}}}function rK({useCompression:t,workerUrl:e}){if(t&&window.Worker){const n=iK(e);if(n)return n}return Jn("[Replay] Using simple buffer"),new ix}function iK(t){try{const e=t||sK();if(!e)return;Jn(`[Replay] Using compression worker${t?` from ${t}`:""}`);const n=new Worker(e);return new nK(n)}catch{Jn("[Replay] Failed to create compression worker")}}function sK(){return typeof __SENTRY_EXCLUDE_REPLAY_WORKER__>"u"||!__SENTRY_EXCLUDE_REPLAY_WORKER__?QZ():""}function vw(){try{return"sessionStorage"in ht&&!!ht.sessionStorage}catch{return!1}}function oK(t){aK(),t.session=void 0}function aK(){if(vw())try{ht.sessionStorage.removeItem(cw)}catch{}}function sx(t){return t===void 0?!1:Math.random()<t}function ox(t){const e=Date.now(),n=t.id||Un(),r=t.started||e,i=t.lastActivity||e,s=t.segmentId||0,o=t.sampled,a=t.previousSessionId;return{id:n,started:r,lastActivity:i,segmentId:s,sampled:o,previousSessionId:a}}function yw(t){if(vw())try{ht.sessionStorage.setItem(cw,JSON.stringify(t))}catch{}}function cK(t,e){return sx(t)?"session":e?"buffer":!1}function N1({sessionSampleRate:t,allowBuffering:e,stickySession:n=!1},{previousSessionId:r}={}){const i=cK(t,e),s=ox({sampled:i,previousSessionId:r});return n&&yw(s),s}function lK(t){if(!vw())return null;try{const e=ht.sessionStorage.getItem(cw);if(!e)return null;const n=JSON.parse(e);return ml("[Replay] Loading existing session",t),ox(n)}catch{return null}}function K0(t,e,n=+new Date){return t===null||e===void 0||e<0?!0:e===0?!1:t+e<=n}function ax(t,{maxReplayDuration:e,sessionIdleExpire:n,targetTime:r=Date.now()}){return K0(t.started,e,r)||K0(t.lastActivity,n,r)}function cx(t,{sessionIdleExpire:e,maxReplayDuration:n}){return!(!ax(t,{sessionIdleExpire:e,maxReplayDuration:n})||t.sampled==="buffer"&&t.segmentId===0)}function vv({traceInternals:t,sessionIdleExpire:e,maxReplayDuration:n,previousSessionId:r},i){const s=i.stickySession&&lK(t);return s?cx(s,{sessionIdleExpire:e,maxReplayDuration:n})?(ml("[Replay] Session in sessionStorage is expired, creating new one..."),N1(i,{previousSessionId:s.id})):s:(ml("[Replay] Creating new session",t),N1(i,{previousSessionId:r}))}function uK(t){return t.type===Fe.Custom}function Sw(t,e,n){return ux(t,e)?(lx(t,e,n),!0):!1}function dK(t,e,n){return ux(t,e)?lx(t,e,n):Promise.resolve(null)}async function lx(t,e,n){if(!t.eventBuffer)return null;try{n&&t.recordingMode==="buffer"&&t.eventBuffer.clear(),n&&(t.eventBuffer.hasCheckout=!0);const r=t.getOptions(),i=fK(e,r.beforeAddRecordingEvent);return i?await t.eventBuffer.addEvent(i):void 0}catch(r){const i=r&&r instanceof gw?"addEventSizeExceeded":"addEvent";ct&&K.error(r),await t.stop({reason:i});const s=Mt();s&&s.recordDroppedEvent("internal_sdk_error","replay")}}function ux(t,e){if(!t.eventBuffer||t.isPaused()||!t.isEnabled())return!1;const n=mw(e.timestamp);return n+t.timeouts.sessionIdlePause<Date.now()?!1:n>t.getContext().initialTimestamp+t.getOptions().maxReplayDuration?(Jn(`[Replay] Skipping event with timestamp ${n} because it is after maxReplayDuration`,t.getOptions()._experiments.traceInternals),!1):!0}function fK(t,e){try{if(typeof e=="function"&&uK(t))return e(t)}catch(n){return ct&&K.error("[Replay] An error occured in the `beforeAddRecordingEvent` callback, skipping the event...",n),null}return t}function bw(t){return!t.type}function Y0(t){return t.type==="transaction"}function hK(t){return t.type==="replay_event"}function M1(t){return t.type==="feedback"}function dx(t){const e=gK();return(n,r)=>{if(!t.isEnabled()||!bw(n)&&!Y0(n))return;const i=r&&r.statusCode;if(!(e&&(!i||i<200||i>=300))){if(Y0(n)){pK(t,n);return}mK(t,n)}}}function pK(t,e){const n=t.getContext();e.contexts&&e.contexts.trace&&e.contexts.trace.trace_id&&n.traceIds.size<100&&n.traceIds.add(e.contexts.trace.trace_id)}function mK(t,e){const n=t.getContext();if(e.event_id&&n.errorIds.size<100&&n.errorIds.add(e.event_id),t.recordingMode!=="buffer"||!e.tags||!e.tags.replayId)return;const{beforeErrorSampling:r}=t.getOptions();typeof r=="function"&&!r(e)||setTimeout(()=>{t.sendBufferedReplayOrFlush()})}function gK(){const t=Mt();if(!t)return!1;const e=t.getTransport();return e&&e.send.__sentry__baseTransport__||!1}function vK(t){return e=>{!t.isEnabled()||!bw(e)||yK(t,e)}}function yK(t,e){const n=e.exception&&e.exception.values&&e.exception.values[0].value;if(typeof n=="string"&&(n.match(/reactjs\.org\/docs\/error-decoder\.html\?invariant=(418|419|422|423|425)/)||n.match(/(does not match server-rendered HTML|Hydration failed because)/i))){const r=os({category:"replay.hydrate-error"});wf(t,r)}}function SK(t,e){return t.type||!t.exception||!t.exception.values||!t.exception.values.length?!1:!!(e.originalException&&e.originalException.__rrweb__)}function bK(t,e){t.triggerUserActivity(),t.addUpdate(()=>e.timestamp?(t.throttledAddEvent({type:Fe.Custom,timestamp:e.timestamp*1e3,data:{timestamp:e.timestamp,tag:"breadcrumb",payload:{category:"sentry.feedback",data:{feedbackId:e.event_id}}}}),!1):!0)}function wK(t,e){return t.recordingMode!=="buffer"||e.message===lw||!e.exception||e.type?!1:sx(t.getOptions().errorSampleRate)}function kK(t,e=!1){const n=e?dx(t):void 0;return Object.assign((r,i)=>t.isEnabled()?hK(r)?(delete r.breadcrumbs,r):!bw(r)&&!Y0(r)&&!M1(r)||!t.checkAndHandleExpiredSession()?r:M1(r)?(t.flush(),r.contexts.feedback.replay_id=t.getSessionId(),bK(t,r),r):SK(r,i)&&!t.getOptions()._experiments.captureExceptions?(ct&&K.log("[Replay] Ignoring error from rrweb internals",r),null):((wK(t,r)||t.recordingMode==="session")&&(r.tags={...r.tags,replayId:t.getSessionId()}),n&&n(r,{statusCode:200}),r):r,{id:"Replay"})}function Gm(t,e){return e.map(({type:n,start:r,end:i,name:s,data:o})=>{const a=t.throttledAddEvent({type:Fe.Custom,timestamp:r,data:{tag:"performanceSpan",payload:{op:n,description:s,startTimestamp:r,endTimestamp:i,data:o}}});return typeof a=="string"?Promise.resolve(null):a})}function EK(t){const{from:e,to:n}=t,r=Date.now()/1e3;return{type:"navigation.push",start:r,end:r,name:n,data:{previous:e}}}function CK(t){return e=>{if(!t.isEnabled())return;const n=EK(e);n!==null&&(t.getContext().urls.push(n.name),t.triggerUserActivity(),t.addUpdate(()=>(Gm(t,[n]),!1)))}}function TK(t,e){return ct&&t.getOptions()._experiments.traceInternals?!1:XH(e,Mt())}function qm(t,e){t.isEnabled()&&e!==null&&(TK(t,e.name)||t.addUpdate(()=>(Gm(t,[e]),!0)))}function _K(t){const{startTimestamp:e,endTimestamp:n,fetchData:r,response:i}=t;if(!n)return null;const{method:s,url:o}=r;return{type:"resource.fetch",start:e/1e3,end:n/1e3,name:o,data:{method:s,statusCode:i?i.status:void 0}}}function IK(t){return e=>{if(!t.isEnabled())return;const n=_K(e);qm(t,n)}}function RK(t){const{startTimestamp:e,endTimestamp:n,xhr:r}=t,i=r[Ho];if(!e||!n||!i)return null;const{method:s,url:o,status_code:a}=i;return o===void 0?null:{type:"resource.xhr",name:o,start:e/1e3,end:n/1e3,data:{method:s,statusCode:a}}}function PK(t){return e=>{if(!t.isEnabled())return;const n=RK(e);qm(t,n)}}function Jm(t,e){if(t)try{if(typeof t=="string")return e.encode(t).length;if(t instanceof URLSearchParams)return e.encode(t.toString()).length;if(t instanceof FormData){const n=mx(t);return e.encode(n).length}if(t instanceof Blob)return t.size;if(t instanceof ArrayBuffer)return t.byteLength}catch{}}function fx(t){if(!t)return;const e=parseInt(t,10);return isNaN(e)?void 0:e}function hx(t){try{if(typeof t=="string")return[t];if(t instanceof URLSearchParams)return[t.toString()];if(t instanceof FormData)return[mx(t)];if(!t)return[void 0]}catch{return ct&&K.warn("[Replay] Failed to serialize body",t),[void 0,"BODY_PARSE_ERROR"]}return ct&&K.info("[Replay] Skipping network body because of body type",t),[void 0,"UNPARSEABLE_BODY_TYPE"]}function Gp(t,e){if(!t)return{headers:{},size:void 0,_meta:{warnings:[e]}};const n={...t._meta},r=n.warnings||[];return n.warnings=[...r,e],t._meta=n,t}function px(t,e){if(!e)return null;const{startTimestamp:n,endTimestamp:r,url:i,method:s,statusCode:o,request:a,response:c}=e;return{type:t,start:n/1e3,end:r/1e3,name:i,data:us({method:s,statusCode:o,request:a,response:c})}}function $d(t){return{headers:{},size:t,_meta:{warnings:["URL_SKIPPED"]}}}function ia(t,e,n){if(!e&&Object.keys(t).length===0)return;if(!e)return{headers:t};if(!n)return{headers:t,size:e};const r={headers:t,size:e},{body:i,warnings:s}=AK(n);return r.body=i,s&&s.length>0&&(r._meta={warnings:s}),r}function X0(t,e){return Object.keys(t).reduce((n,r)=>{const i=r.toLowerCase();return e.includes(i)&&t[r]&&(n[i]=t[r]),n},{})}function mx(t){return new URLSearchParams(t).toString()}function AK(t){if(!t||typeof t!="string")return{body:t};const e=t.length>y1,n=NK(t);if(e){const r=t.slice(0,y1);return n?{body:r,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${r}`,warnings:["TEXT_TRUNCATED"]}}if(n)try{return{body:JSON.parse(t)}}catch{}return{body:t}}function NK(t){const e=t[0],n=t[t.length-1];return e==="["&&n==="]"||e==="{"&&n==="}"}function qp(t,e){const n=MK(t);return ou(n,e)}function MK(t,e=ht.document.baseURI){if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith(ht.location.origin))return t;const n=new URL(t,e);if(n.origin!==new URL(e).origin)return t;const r=n.href;return!t.endsWith("/")&&r.endsWith("/")?r.slice(0,-1):r}async function xK(t,e,n){try{const r=await DK(t,e,n),i=px("resource.fetch",r);qm(n.replay,i)}catch(r){ct&&K.error("[Replay] Failed to capture fetch breadcrumb",r)}}function OK(t,e,n){const{input:r,response:i}=e,s=r?gx(r):void 0,o=Jm(s,n.textEncoder),a=i?fx(i.headers.get("content-length")):void 0;o!==void 0&&(t.data.request_body_size=o),a!==void 0&&(t.data.response_body_size=a)}async function DK(t,e,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:s=r}=e,{url:o,method:a,status_code:c=0,request_body_size:l,response_body_size:u}=t.data,d=qp(o,n.networkDetailAllowUrls)&&!qp(o,n.networkDetailDenyUrls),f=d?LK(n,e.input,l):$d(l),h=await FK(d,n,e.response,u);return{startTimestamp:i,endTimestamp:s,url:o,method:a,statusCode:c,request:f,response:h}}function LK({networkCaptureBodies:t,networkRequestHeaders:e},n,r){const i=n?jK(n,e):{};if(!t)return ia(i,r,void 0);const s=gx(n),[o,a]=hx(s),c=ia(i,r,o);return a?Gp(c,a):c}async function FK(t,{networkCaptureBodies:e,textEncoder:n,networkResponseHeaders:r},i,s){if(!t&&s!==void 0)return $d(s);const o=i?vx(i.headers,r):{};if(!i||!e&&s!==void 0)return ia(o,s,void 0);const[a,c]=await UK(i),l=BK(a,{networkCaptureBodies:e,textEncoder:n,responseBodySize:s,captureDetails:t,headers:o});return c?Gp(l,c):l}function BK(t,{networkCaptureBodies:e,textEncoder:n,responseBodySize:r,captureDetails:i,headers:s}){try{const o=t&&t.length&&r===void 0?Jm(t,n):r;return i?e?ia(s,o,t):ia(s,o,void 0):$d(o)}catch(o){return ct&&K.warn("[Replay] Failed to serialize response body",o),ia(s,r,void 0)}}async function UK(t){const e=WK(t);if(!e)return[void 0,"BODY_PARSE_ERROR"];try{return[await VK(e)]}catch(n){return ct&&K.warn("[Replay] Failed to get text body from response",n),[void 0,"BODY_PARSE_ERROR"]}}function gx(t=[]){if(!(t.length!==2||typeof t[1]!="object"))return t[1].body}function vx(t,e){const n={};return e.forEach(r=>{t.get(r)&&(n[r]=t.get(r))}),n}function jK(t,e){return t.length===1&&typeof t[0]!="string"?x1(t[0],e):t.length===2?x1(t[1],e):{}}function x1(t,e){if(!t)return{};const n=t.headers;return n?n instanceof Headers?vx(n,e):Array.isArray(n)?{}:X0(n,e):{}}function WK(t){try{return t.clone()}catch(e){ct&&K.warn("[Replay] Failed to clone response body",e)}}function VK(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error("Timeout while trying to read response body")),500);zK(t).then(i=>e(i),i=>n(i)).finally(()=>clearTimeout(r))})}async function zK(t){return await t.text()}async function $K(t,e,n){try{const r=GK(t,e,n),i=px("resource.xhr",r);qm(n.replay,i)}catch(r){ct&&K.error("[Replay] Failed to capture xhr breadcrumb",r)}}function HK(t,e,n){const{xhr:r,input:i}=e;if(!r)return;const s=Jm(i,n.textEncoder),o=r.getResponseHeader("content-length")?fx(r.getResponseHeader("content-length")):KK(r.response,r.responseType,n.textEncoder);s!==void 0&&(t.data.request_body_size=s),o!==void 0&&(t.data.response_body_size=o)}function GK(t,e,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:s=r,input:o,xhr:a}=e,{url:c,method:l,status_code:u=0,request_body_size:d,response_body_size:f}=t.data;if(!c)return null;if(!a||!qp(c,n.networkDetailAllowUrls)||qp(c,n.networkDetailDenyUrls)){const k=$d(d),T=$d(f);return{startTimestamp:i,endTimestamp:s,url:c,method:l,statusCode:u,request:k,response:T}}const h=a[Ho],p=h?X0(h.request_headers,n.networkRequestHeaders):{},g=X0(qK(a),n.networkResponseHeaders),[y,m]=n.networkCaptureBodies?hx(o):[void 0],[v,w]=n.networkCaptureBodies?JK(a):[void 0],_=ia(p,d,y),C=ia(g,f,v);return{startTimestamp:i,endTimestamp:s,url:c,method:l,statusCode:u,request:m?Gp(_,m):_,response:w?Gp(C,w):C}}function qK(t){const e=t.getAllResponseHeaders();return e?e.split(`\r
`).reduce((n,r)=>{const[i,s]=r.split(": ");return n[i.toLowerCase()]=s,n},{}):{}}function JK(t){const e=[];try{return[t.responseText]}catch(n){e.push(n)}try{return ZK(t.response,t.responseType)}catch(n){e.push(n)}return ct&&K.warn("[Replay] Failed to get xhr response body",...e),[void 0]}function ZK(t,e){try{if(typeof t=="string")return[t];if(t instanceof Document)return[t.body.outerHTML];if(e==="json"&&t&&typeof t=="object")return[JSON.stringify(t)];if(!t)return[void 0]}catch{return ct&&K.warn("[Replay] Failed to serialize body",t),[void 0,"BODY_PARSE_ERROR"]}return ct&&K.info("[Replay] Skipping network body because of body type",t),[void 0,"UNPARSEABLE_BODY_TYPE"]}function KK(t,e,n){try{const r=e==="json"&&t&&typeof t=="object"?JSON.stringify(t):t;return Jm(r,n)}catch{return}}function YK(t){const e=Mt();try{const n=new TextEncoder,{networkDetailAllowUrls:r,networkDetailDenyUrls:i,networkCaptureBodies:s,networkRequestHeaders:o,networkResponseHeaders:a}=t.getOptions(),c={replay:t,textEncoder:n,networkDetailAllowUrls:r,networkDetailDenyUrls:i,networkCaptureBodies:s,networkRequestHeaders:o,networkResponseHeaders:a};e&&e.on?e.on("beforeAddBreadcrumb",(l,u)=>XK(c,l,u)):(Hb(IK(t)),Gb(PK(t)))}catch{}}function XK(t,e,n){if(e.data)try{QK(e)&&tY(n)&&(HK(e,n,t),$K(e,n,t)),eY(e)&&nY(n)&&(OK(e,n,t),xK(e,n,t))}catch{ct&&K.warn("Error when enriching network breadcrumb")}}function QK(t){return t.category==="xhr"}function eY(t){return t.category==="fetch"}function tY(t){return t&&t.xhr}function nY(t){return t&&t.response}let O1=null;function rY(t){return!!t.category}const iY=t=>e=>{if(!t.isEnabled())return;const n=sY(e);n&&wf(t,n)};function sY(t){const e=t.getLastBreadcrumb&&t.getLastBreadcrumb();return O1===e||!e||(O1=e,!rY(e)||["fetch","xhr","sentry.event","sentry.transaction"].includes(e.category)||e.category.startsWith("ui."))?null:e.category==="console"?oY(e):os(e)}function oY(t){const e=t.data&&t.data.arguments;if(!Array.isArray(e)||e.length===0)return os(t);let n=!1;const r=e.map(i=>{if(!i)return i;if(typeof i=="string")return i.length>ih?(n=!0,`${i.slice(0,ih)}`):i;if(typeof i=="object")try{const s=Bi(i,7);return JSON.stringify(s).length>ih?(n=!0,`${JSON.stringify(s,null,2).slice(0,ih)}`):s}catch{}return i});return os({...t,data:{...t.data,arguments:r,...n?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}function aY(t){const e=Sf(),n=Mt();e.addScopeListener(iY(t)),BN(BZ(t)),Lm(CK(t)),YK(t);const r=kK(t,!D1(n));n&&n.addEventProcessor?n.addEventProcessor(r):OH(r),D1(n)&&(n.on("beforeSendEvent",vK(t)),n.on("afterSendEvent",dx(t)),n.on("createDsc",i=>{const s=t.getSessionId();s&&t.isEnabled()&&t.recordingMode==="session"&&t.checkAndHandleExpiredSession()&&(i.replay_id=s)}),n.on("startTransaction",i=>{t.lastTransaction=i}),n.on("finishTransaction",i=>{t.lastTransaction=i}),n.on("beforeSendFeedback",(i,s)=>{const o=t.getSessionId();s&&s.includeReplay&&t.isEnabled()&&o&&(t.flush(),i.contexts&&i.contexts.feedback&&(i.contexts.feedback.replay_id=o))}))}function D1(t){return!!(t&&t.on)}async function cY(t){try{return Promise.all(Gm(t,[lY(ht.performance.memory)]))}catch{return[]}}function lY(t){const{jsHeapSizeLimit:e,totalJSHeapSize:n,usedJSHeapSize:r}=t,i=Date.now()/1e3;return{type:"memory",name:"memory",start:i,end:i,data:{memory:{jsHeapSizeLimit:e,totalJSHeapSize:n,usedJSHeapSize:r}}}}function uY(t,e,n){let r,i,s;const o=n&&n.maxWait?Math.max(n.maxWait,e):0;function a(){return c(),r=t(),r}function c(){i!==void 0&&clearTimeout(i),s!==void 0&&clearTimeout(s),i=s=void 0}function l(){return i!==void 0||s!==void 0?a():r}function u(){return i&&clearTimeout(i),i=setTimeout(a,e),o&&s===void 0&&(s=setTimeout(a,o)),r}return u.cancel=c,u.flush=l,u}function dY(t){let e=!1;return(n,r)=>{if(!t.checkAndHandleExpiredSession()){ct&&K.warn("[Replay] Received replay event after session expired.");return}const i=r||!e;e=!0,t.clickDetector&&xZ(t.clickDetector,n),t.addUpdate(()=>{if(t.recordingMode==="buffer"&&i&&t.setInitialState(),!Sw(t,n,i))return!0;if(!i)return!1;if(hY(t,i),t.session&&t.session.previousSessionId)return!0;if(t.recordingMode==="buffer"&&t.session&&t.eventBuffer){const s=t.eventBuffer.getEarliestTimestamp();s&&(Jn(`[Replay] Updating session start time to earliest event in buffer to ${new Date(s)}`,t.getOptions()._experiments.traceInternals),t.session.started=s,t.getOptions().stickySession&&yw(t.session))}return t.recordingMode==="session"&&t.flush(),!0})}}function fY(t){const e=t.getOptions();return{type:Fe.Custom,timestamp:Date.now(),data:{tag:"options",payload:{sessionSampleRate:e.sessionSampleRate,errorSampleRate:e.errorSampleRate,useCompressionOption:e.useCompression,blockAllMedia:e.blockAllMedia,maskAllText:e.maskAllText,maskAllInputs:e.maskAllInputs,useCompression:t.eventBuffer?t.eventBuffer.type==="worker":!1,networkDetailHasUrls:e.networkDetailAllowUrls.length>0,networkCaptureBodies:e.networkCaptureBodies,networkRequestHasHeaders:e.networkRequestHeaders.length>0,networkResponseHasHeaders:e.networkResponseHeaders.length>0}}}}function hY(t,e){!e||!t.session||t.session.segmentId!==0||Sw(t,fY(t),!1)}function pY(t,e,n,r){return pc(GN(t,Zb(t),r,n),[[{type:"replay_event"},t],[{type:"replay_recording",length:typeof e=="string"?new TextEncoder().encode(e).length:e.length},e]])}function mY({recordingData:t,headers:e}){let n;const r=`${JSON.stringify(e)}
`;if(typeof t=="string")n=`${r}${t}`;else{const s=new TextEncoder().encode(r);n=new Uint8Array(s.length+t.length),n.set(s),n.set(t,s.length)}return n}async function gY({client:t,scope:e,replayId:n,event:r}){const i=typeof t._integrations=="object"&&t._integrations!==null&&!Array.isArray(t._integrations)?Object.keys(t._integrations):void 0,s={event_id:n,integrations:i};t.emit&&t.emit("preprocessEvent",r,s);const o=await nM(t.getOptions(),r,s,e,t,XN());if(!o)return null;o.platform=o.platform||"javascript";const a=t.getSdkMetadata&&t.getSdkMetadata(),{name:c,version:l}=a&&a.sdk||{};return o.sdk={...o.sdk,name:c||"sentry.javascript.unknown",version:l||"0.0.0"},o}async function vY({recordingData:t,replayId:e,segmentId:n,eventContext:r,timestamp:i,session:s}){const o=mY({recordingData:t,headers:{segment_id:n}}),{urls:a,errorIds:c,traceIds:l,initialTimestamp:u}=r,d=Mt(),f=Sf(),h=d&&d.getTransport(),p=d&&d.getDsn();if(!d||!h||!p||!s.sampled)return;const g={type:rJ,replay_start_timestamp:u/1e3,timestamp:i/1e3,error_ids:c,trace_ids:l,urls:a,replay_id:e,segment_id:n,replay_type:s.sampled},y=await gY({scope:f,client:d,replayId:e,event:g});if(!y){d.recordDroppedEvent("event_processor","replay",g),Jn("An event processor returned `null`, will not send event.");return}delete y.sdkProcessingMetadata;const m=pY(y,o,p,d.getOptions().tunnel);let v;try{v=await h.send(m)}catch(_){const C=new Error(lw);try{C.cause=_}catch{}throw C}if(!v)return v;if(typeof v.statusCode=="number"&&(v.statusCode<200||v.statusCode>=300))throw new yx(v.statusCode);const w=JN({},v);if(qN(w,"replay"))throw new Sx(w);return v}class yx extends Error{constructor(e){super(`Transport returned status code ${e}`)}}class Sx extends Error{constructor(e){super("Rate limit hit"),this.rateLimits=e}}async function bx(t,e={count:0,interval:lJ}){const{recordingData:n,options:r}=t;if(n.length)try{return await vY(t),!0}catch(i){if(i instanceof yx||i instanceof Sx)throw i;if(dH("Replays",{_retryCount:e.count}),ct&&r._experiments&&r._experiments.captureExceptions&&Um(i),e.count>=uJ){const s=new Error(`${lw} - max retries exceeded`);try{s.cause=i}catch{}throw s}return e.interval*=++e.count,new Promise((s,o)=>{setTimeout(async()=>{try{await bx(t,e),s(!0)}catch(a){o(a)}},e.interval)})}}const wx="__THROTTLED",yY="__SKIPPED";function SY(t,e,n){const r=new Map,i=a=>{const c=a-n;r.forEach((l,u)=>{u<c&&r.delete(u)})},s=()=>[...r.values()].reduce((a,c)=>a+c,0);let o=!1;return(...a)=>{const c=Math.floor(Date.now()/1e3);if(i(c),s()>=e){const u=o;return o=!0,u?yY:wx}o=!1;const l=r.get(c)||0;return r.set(c,l+1),t(...a)}}class Mo{constructor({options:e,recordingOptions:n}){Mo.prototype.__init.call(this),Mo.prototype.__init2.call(this),Mo.prototype.__init3.call(this),Mo.prototype.__init4.call(this),Mo.prototype.__init5.call(this),Mo.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:iJ,sessionIdleExpire:sJ},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=n,this._options=e,this._debouncedFlush=uY(()=>this._flush(),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=SY((o,a)=>dK(this,o,a),300,5);const{slowClickTimeout:r,slowClickIgnoreSelectors:i}=this.getOptions(),s=r?{threshold:Math.min(dJ,r),timeout:r,scrollTimeout:fJ,ignoreSelector:i?i.join(","):""}:void 0;s&&(this.clickDetector=new PZ(this,s))}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}getOptions(){return this._options}initializeSampling(e){const{errorSampleRate:n,sessionSampleRate:r}=this._options;if(!(n<=0&&r<=0)){if(this._initializeSessionForSampling(e),!this.session){this._handleException(new Error("Unable to initialize and create session"));return}this.session.sampled!==!1&&(this.recordingMode=this.session.sampled==="buffer"&&this.session.segmentId===0?"buffer":"session",ml(`[Replay] Starting replay in ${this.recordingMode} mode`,this._options._experiments.traceInternals),this._initializeRecording())}}start(){if(this._isEnabled&&this.recordingMode==="session")throw new Error("Replay recording is already in progress");if(this._isEnabled&&this.recordingMode==="buffer")throw new Error("Replay buffering is in progress, call `flush()` to save the replay");ml("[Replay] Starting replay in session mode",this._options._experiments.traceInternals);const e=vv({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=e,this._initializeRecording()}startBuffering(){if(this._isEnabled)throw new Error("Replay recording is already in progress");ml("[Replay] Starting replay in buffer mode",this._options._experiments.traceInternals);const e=vv({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=e,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{const e=this._options._experiments.canvas;this._stopRecording=ra({...this._recordingOptions,...this.recordingMode==="buffer"&&{checkoutEveryNms:cJ},emit:dY(this),onMutation:this._onMutationHandler,...e&&e.manager&&{recordCanvas:!0,getCanvasManager:e.manager,...b1[e.quality||"medium"]||b1.medium}})}catch(e){this._handleException(e)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(e){return this._handleException(e),!1}}async stop({forceFlush:e=!1,reason:n}={}){if(this._isEnabled){this._isEnabled=!1;try{Jn(`[Replay] Stopping Replay${n?` triggered by ${n}`:""}`,this._options._experiments.traceInternals),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),e&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,oK(this)}catch(r){this._handleException(r)}}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),Jn("[Replay] Pausing replay",this._options._experiments.traceInternals))}resume(){!this._isPaused||!this._checkSession()||(this._isPaused=!1,this.startRecording(),Jn("[Replay] Resuming replay",this._options._experiments.traceInternals))}async sendBufferedReplayOrFlush({continueRecording:e=!0}={}){if(this.recordingMode==="session")return this.flushImmediate();const n=Date.now();Jn("[Replay] Converting buffer to session",this._options._experiments.traceInternals),await this.flushImmediate();const r=this.stopRecording();!e||!r||this.recordingMode!=="session"&&(this.recordingMode="session",this.session&&(this._updateUserActivity(n),this._updateSessionActivity(n),this._maybeSaveSession()),this.startRecording())}addUpdate(e){const n=e();this.recordingMode!=="buffer"&&n!==!0&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),!this._stopRecording){if(!this._checkSession())return;this.resume();return}this.checkAndHandleExpiredSession(),this._updateSessionActivity()}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return this.recordingMode==="buffer"?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){if(this._lastActivity&&K0(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&this.session.sampled==="session"){this.pause();return}return!!this._checkSession()}setInitialState(){const e=`${ht.location.pathname}${ht.location.hash}${ht.location.search}`,n=`${ht.location.origin}${e}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=n,this._context.initialTimestamp=Date.now(),this._context.urls.push(n)}throttledAddEvent(e,n){const r=this._throttledAddEvent(e,n);if(r===wx){const i=os({category:"replay.throttled"});this.addUpdate(()=>!Sw(this,{type:EZ,timestamp:i.timestamp||0,data:{tag:"breadcrumb",payload:i,metric:!0}}))}return r}getCurrentRoute(){const e=this.lastTransaction||Sf().getTransaction();if(!(!e||!["route","custom"].includes(e.metadata.source)))return e.name}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=rK({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_handleException(e){ct&&K.error("[Replay]",e),ct&&this._options._experiments&&this._options._experiments.captureExceptions&&Um(e)}_initializeSessionForSampling(e){const n=this._options.errorSampleRate>0,r=vv({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals,previousSessionId:e},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:n});this.session=r}_checkSession(){if(!this.session)return!1;const e=this.session;return cx(e,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})?(this._refreshSession(e),!1):!0}async _refreshSession(e){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(e.id))}_addListeners(){try{ht.document.addEventListener("visibilitychange",this._handleVisibilityChange),ht.addEventListener("blur",this._handleWindowBlur),ht.addEventListener("focus",this._handleWindowFocus),ht.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(aY(this),this._hasInitializedCoreListeners=!0)}catch(e){this._handleException(e)}this._performanceCleanupCallback=YZ(this)}_removeListeners(){try{ht.document.removeEventListener("visibilitychange",this._handleVisibilityChange),ht.removeEventListener("blur",this._handleWindowBlur),ht.removeEventListener("focus",this._handleWindowFocus),ht.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(e){this._handleException(e)}}__init(){this._handleVisibilityChange=()=>{ht.document.visibilityState==="visible"?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const e=os({category:"ui.blur"});this._doChangeToBackgroundTasks(e)}}__init3(){this._handleWindowFocus=()=>{const e=os({category:"ui.focus"});this._doChangeToForegroundTasks(e)}}__init4(){this._handleKeyboardEvent=e=>{VZ(this,e)}}_doChangeToBackgroundTasks(e){!this.session||ax(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(e&&this._createCustomBreadcrumb(e),this.conditionalFlush())}_doChangeToForegroundTasks(e){if(!this.session)return;if(!this.checkAndHandleExpiredSession()){Jn("[Replay] Document has become active, but session has expired");return}e&&this._createCustomBreadcrumb(e)}_updateUserActivity(e=Date.now()){this._lastActivity=e}_updateSessionActivity(e=Date.now()){this.session&&(this.session.lastActivity=e,this._maybeSaveSession())}_createCustomBreadcrumb(e){this.addUpdate(()=>{this.throttledAddEvent({type:Fe.Custom,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e}})})}_addPerformanceEntries(){const e=HZ(this.performanceEntries).concat(this.replayPerformanceEntries);return this.performanceEntries=[],this.replayPerformanceEntries=[],Promise.all(Gm(this,e))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:e,eventBuffer:n}=this;if(!e||!n||e.segmentId)return;const r=n.getEarliestTimestamp();r&&r<this._context.initialTimestamp&&(this._context.initialTimestamp=r)}_popEventContext(){const e={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),e}async _runFlush(){const e=this.getSessionId();if(!this.session||!this.eventBuffer||!e){ct&&K.error("[Replay] No session or eventBuffer found to flush.");return}if(await this._addPerformanceEntries(),!(!this.eventBuffer||!this.eventBuffer.hasEvents)&&(await cY(this),!!this.eventBuffer&&e===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const n=Date.now();if(n-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const r=this._popEventContext(),i=this.session.segmentId++;this._maybeSaveSession();const s=await this.eventBuffer.finish();await bx({replayId:e,recordingData:s,segmentId:i,eventContext:r,session:this.session,options:this.getOptions(),timestamp:n})}catch(n){this._handleException(n),this.stop({reason:"sendReplay"});const r=Mt();r&&r.recordDroppedEvent("send_error","replay")}}__init5(){this._flush=async({force:e=!1}={})=>{if(!this._isEnabled&&!e)return;if(!this.checkAndHandleExpiredSession()){ct&&K.error("[Replay] Attempting to finish replay event after session expired.");return}if(!this.session)return;const n=this.session.started,i=Date.now()-n;this._debouncedFlush.cancel();const s=i<this._options.minReplayDuration,o=i>this._options.maxReplayDuration+5e3;if(s||o){Jn(`[Replay] Session duration (${Math.floor(i/1e3)}s) is too ${s?"short":"long"}, not sending replay.`,this._options._experiments.traceInternals),s&&this._debouncedFlush();return}const a=this.eventBuffer;if(a&&this.session.segmentId===0&&!a.hasCheckout&&Jn("[Replay] Flushing initial segment without checkout.",this._options._experiments.traceInternals),!this._flushLock){this._flushLock=this._runFlush(),await this._flushLock,this._flushLock=void 0;return}try{await this._flushLock}catch(c){ct&&K.error(c)}finally{this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&yw(this.session)}__init6(){this._onMutationHandler=e=>{const n=e.length,r=this._options.mutationLimit,i=this._options.mutationBreadcrumbLimit,s=r&&n>r;if(n>i||s){const o=os({category:"replay.mutations",data:{count:n,limit:s}});this._createCustomBreadcrumb(o)}return s?(this.stop({reason:"mutationLimit",forceFlush:this.recordingMode==="session"}),!1):!0}}}function Au(t,e,n,r){const i=typeof r=="string"?r.split(","):[],s=[...t,...i,...e];return typeof n<"u"&&(typeof n=="string"&&s.push(`.${n}`),rc(()=>{console.warn("[Replay] You are using a deprecated configuration item for privacy. Read the documentation on how to use the new privacy configuration.")})),s.join(",")}function bY({mask:t,unmask:e,block:n,unblock:r,ignore:i,blockClass:s,blockSelector:o,maskTextClass:a,maskTextSelector:c,ignoreClass:l}){const u=['base[href="/"]'],d=Au(t,[".sentry-mask","[data-sentry-mask]"],a,c),f=Au(e,[".sentry-unmask","[data-sentry-unmask]"]),h={maskTextSelector:d,unmaskTextSelector:f,blockSelector:Au(n,[".sentry-block","[data-sentry-block]",...u],s,o),unblockSelector:Au(r,[".sentry-unblock","[data-sentry-unblock]"]),ignoreSelector:Au(i,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'],l)};return s instanceof RegExp&&(h.blockClass=s),a instanceof RegExp&&(h.maskTextClass=a),h}function wY({el:t,key:e,maskAttributes:n,maskAllText:r,privacyOptions:i,value:s}){return!r||i.unmaskTextSelector&&t.matches(i.unmaskTextSelector)?s:n.includes(e)||e==="value"&&t.tagName==="INPUT"&&["submit","button"].includes(t.getAttribute("type")||"")?s.replace(/[\S]/g,"*"):s}const L1='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',kY=["content-length","content-type","accept"];let F1=!1;class Zm{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:e=oJ,flushMaxDelay:n=aJ,minReplayDuration:r=hJ,maxReplayDuration:i=S1,stickySession:s=!0,useCompression:o=!0,workerUrl:a,_experiments:c={},sessionSampleRate:l,errorSampleRate:u,maskAllText:d=!0,maskAllInputs:f=!0,blockAllMedia:h=!0,mutationBreadcrumbLimit:p=750,mutationLimit:g=1e4,slowClickTimeout:y=7e3,slowClickIgnoreSelectors:m=[],networkDetailAllowUrls:v=[],networkDetailDenyUrls:w=[],networkCaptureBodies:_=!0,networkRequestHeaders:C=[],networkResponseHeaders:k=[],mask:T=[],maskAttributes:R=["title","placeholder"],unmask:A=[],block:M=[],unblock:O=[],ignore:D=[],maskFn:j,beforeAddRecordingEvent:V,beforeErrorSampling:J,blockClass:G,blockSelector:te,maskInputOptions:z,maskTextClass:Z,maskTextSelector:ie,ignoreClass:q}={}){this.name=Zm.id;const se=bY({mask:T,unmask:A,block:M,unblock:O,ignore:D,blockClass:G,blockSelector:te,maskTextClass:Z,maskTextSelector:ie,ignoreClass:q});if(this._recordingOptions={maskAllInputs:f,maskAllText:d,maskInputOptions:{...z||{},password:!0},maskTextFn:j,maskInputFn:j,maskAttributeFn:(ke,Ee,me)=>wY({maskAttributes:R,maskAllText:d,privacyOptions:se,key:ke,value:Ee,el:me}),...se,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:ke=>{try{ke.__rrweb__=!0}catch{}}},this._initialOptions={flushMinDelay:e,flushMaxDelay:n,minReplayDuration:Math.min(r,pJ),maxReplayDuration:Math.min(i,S1),stickySession:s,sessionSampleRate:l,errorSampleRate:u,useCompression:o,workerUrl:a,blockAllMedia:h,maskAllInputs:f,maskAllText:d,mutationBreadcrumbLimit:p,mutationLimit:g,slowClickTimeout:y,slowClickIgnoreSelectors:m,networkDetailAllowUrls:v,networkDetailDenyUrls:w,networkCaptureBodies:_,networkRequestHeaders:B1(C),networkResponseHeaders:B1(k),beforeAddRecordingEvent:V,beforeErrorSampling:J,_experiments:c},typeof l=="number"&&(console.warn(`[Replay] You are passing \`sessionSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysSessionSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysSessionSampleRate: ${l} })`),this._initialOptions.sessionSampleRate=l),typeof u=="number"&&(console.warn(`[Replay] You are passing \`errorSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysOnErrorSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysOnErrorSampleRate: ${u} })`),this._initialOptions.errorSampleRate=u),this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${L1}`:L1),this._isInitialized&&HC())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return F1}set _isInitialized(e){F1=e}setupOnce(){HC()&&(this._setup(),setTimeout(()=>this._initialize()))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:this._replay.recordingMode==="session"}):Promise.resolve()}flush(e){return!this._replay||!this._replay.isEnabled()?Promise.resolve():this._replay.sendBufferedReplayOrFlush(e)}getReplayId(){if(!(!this._replay||!this._replay.isEnabled()))return this._replay.getSessionId()}_initialize(){this._replay&&this._replay.initializeSampling()}_setup(){const e=EY(this._initialOptions);this._replay=new Mo({options:e,recordingOptions:this._recordingOptions})}}Zm.__initStatic();function EY(t){const e=Mt(),n=e&&e.getOptions(),r={sessionSampleRate:0,errorSampleRate:0,...us(t)};return n?(t.sessionSampleRate==null&&t.errorSampleRate==null&&n.replaysSessionSampleRate==null&&n.replaysOnErrorSampleRate==null&&rc(()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}),typeof n.replaysSessionSampleRate=="number"&&(r.sessionSampleRate=n.replaysSessionSampleRate),typeof n.replaysOnErrorSampleRate=="number"&&(r.errorSampleRate=n.replaysOnErrorSampleRate),r):(rc(()=>{console.warn("SDK client is not available.")}),r)}function B1(t){return[...kY,...t.map(e=>e.toLowerCase())]}function CY(t){const e={_metadata:{},...t};e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.react",packages:[{name:"npm:@sentry/react",version:jd}],version:jd},mq(e)}var kx={exports:{}},tt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yn=typeof Symbol=="function"&&Symbol.for,ww=yn?Symbol.for("react.element"):60103,kw=yn?Symbol.for("react.portal"):60106,Km=yn?Symbol.for("react.fragment"):60107,Ym=yn?Symbol.for("react.strict_mode"):60108,Xm=yn?Symbol.for("react.profiler"):60114,Qm=yn?Symbol.for("react.provider"):60109,eg=yn?Symbol.for("react.context"):60110,Ew=yn?Symbol.for("react.async_mode"):60111,tg=yn?Symbol.for("react.concurrent_mode"):60111,ng=yn?Symbol.for("react.forward_ref"):60112,rg=yn?Symbol.for("react.suspense"):60113,TY=yn?Symbol.for("react.suspense_list"):60120,ig=yn?Symbol.for("react.memo"):60115,sg=yn?Symbol.for("react.lazy"):60116,_Y=yn?Symbol.for("react.block"):60121,IY=yn?Symbol.for("react.fundamental"):60117,RY=yn?Symbol.for("react.responder"):60118,PY=yn?Symbol.for("react.scope"):60119;function xr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case ww:switch(t=t.type,t){case Ew:case tg:case Km:case Xm:case Ym:case rg:return t;default:switch(t=t&&t.$$typeof,t){case eg:case ng:case sg:case ig:case Qm:return t;default:return e}}case kw:return e}}}function Ex(t){return xr(t)===tg}tt.AsyncMode=Ew;tt.ConcurrentMode=tg;tt.ContextConsumer=eg;tt.ContextProvider=Qm;tt.Element=ww;tt.ForwardRef=ng;tt.Fragment=Km;tt.Lazy=sg;tt.Memo=ig;tt.Portal=kw;tt.Profiler=Xm;tt.StrictMode=Ym;tt.Suspense=rg;tt.isAsyncMode=function(t){return Ex(t)||xr(t)===Ew};tt.isConcurrentMode=Ex;tt.isContextConsumer=function(t){return xr(t)===eg};tt.isContextProvider=function(t){return xr(t)===Qm};tt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===ww};tt.isForwardRef=function(t){return xr(t)===ng};tt.isFragment=function(t){return xr(t)===Km};tt.isLazy=function(t){return xr(t)===sg};tt.isMemo=function(t){return xr(t)===ig};tt.isPortal=function(t){return xr(t)===kw};tt.isProfiler=function(t){return xr(t)===Xm};tt.isStrictMode=function(t){return xr(t)===Ym};tt.isSuspense=function(t){return xr(t)===rg};tt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Km||t===tg||t===Xm||t===Ym||t===rg||t===TY||typeof t=="object"&&t!==null&&(t.$$typeof===sg||t.$$typeof===ig||t.$$typeof===Qm||t.$$typeof===eg||t.$$typeof===ng||t.$$typeof===IY||t.$$typeof===RY||t.$$typeof===PY||t.$$typeof===_Y)};tt.typeOf=xr;kx.exports=tt;var AY=kx.exports,Cx=AY,NY={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},MY={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Tx={};Tx[Cx.ForwardRef]=NY;Tx[Cx.Memo]=MY;const xY=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function OY(t){const e=t.match(/^([^.]+)/);return e!==null&&parseInt(e[0])>=17}const U1={componentStack:null,error:null,eventId:null};function DY(t,e){const n=new WeakMap;function r(i,s){if(!n.has(i)){if(i.cause)return n.set(i,!0),r(i.cause,s);i.cause=s}}r(t,e)}class Cw extends E.Component{constructor(e){super(e),Cw.prototype.__init.call(this),this.state=U1,this._openFallbackReportDialog=!0;const n=Mt();n&&n.on&&e.showDialog&&(this._openFallbackReportDialog=!1,n.on("afterSendEvent",r=>{!r.type&&r.event_id===this._lastEventId&&d1({...e.dialogOptions,eventId:this._lastEventId})}))}componentDidCatch(e,{componentStack:n}){const{beforeCapture:r,onError:i,showDialog:s,dialogOptions:o}=this.props;iM(a=>{if(OY(E.version)&&jb(e)){const l=new Error(e.message);l.name=`React ErrorBoundary ${e.name}`,l.stack=n,DY(e,l)}r&&r(a,e,n);const c=Um(e,{captureContext:{contexts:{react:{componentStack:n}}},mechanism:{handled:!1}});i&&i(e,n,c),s&&(this._lastEventId=c,this._openFallbackReportDialog&&d1({...o,eventId:c})),this.setState({error:e,componentStack:n,eventId:c})})}componentDidMount(){const{onMount:e}=this.props;e&&e()}componentWillUnmount(){const{error:e,componentStack:n,eventId:r}=this.state,{onUnmount:i}=this.props;i&&i(e,n,r)}__init(){this.resetErrorBoundary=()=>{const{onReset:e}=this.props,{error:n,componentStack:r,eventId:i}=this.state;e&&e(n,r,i),this.setState(U1)}}render(){const{fallback:e,children:n}=this.props,r=this.state;if(r.error){let i;return typeof e=="function"?i=e({error:r.error,componentStack:r.componentStack,resetError:this.resetErrorBoundary,eventId:r.eventId}):i=e,E.isValidElement(i)?i:(e&&xY&&K.warn("fallback did not produce a valid ReactElement"),null)}return typeof n=="function"?n():n}}function LY(){const[t,e]=E.useState(null),[n,r]=E.useState(!1),[i,s]=E.useState([]),o=wt.useRef(null),a=wt.useRef(null),c=E.useRef(!1),l=()=>{o.current&&o.current.saveLog()},u=()=>{o.current&&o.current.clearLog()},d=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return E.useEffect(()=>{if(c.current)return;const f=new I4("mongoose.moo.mud.org",8765);f.registerGMCPPackage(h4),f.registerGMCPPackage(l4),f.registerGMCPPackage(u4),f.registerGMCPPackage(p4),f.registerGMCPPackage(d4),f.registerGMCPPackage(f4),f.registerGMCPPackage(t2),f.registerGMCPPackage(r2),f.registerMcpPackage(y4),f.registerMcpPackage(S4),f.registerMcpPackage(w4),f.registerMcpPackage(k4),f.connect(),f.requestNotificationPermission(),e(f),r(!d),window.mudClient=f,c.current=!0;const h=p=>{f&&(p.key==="Control"&&f.cancelSpeech(),p.key==="Escape"&&f.stopAllSounds())};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[d]),E.useEffect(()=>{if(t){const f=p=>{s(p)},h=()=>{s([])};return t.on("userlist",f),t.on("disconnect",h),()=>{t.off("userlist",f),t.off("disconnect",h)}}},[t]),CI(f=>{t&&t.shutdown()}),t?X.jsx(Cw,{fallback:X.jsx("p",{children:"An error has occurred"}),children:X.jsxs("div",{className:"App",children:[X.jsx("header",{className:"App-header"}),X.jsx(a8,{client:t,onSaveLog:l,onClearLog:u,onToggleUsers:()=>r(!n),onOpenPrefs:()=>{var f;return(f=a.current)==null?void 0:f.open()}}),X.jsxs("div",{children:[X.jsx(zF,{client:t,ref:o}),n&&X.jsx(l8,{users:i}),X.jsx(w$,{client:t})]}),X.jsx(P4,{onSend:f=>t.sendCommand(f)}),X.jsx(c8,{client:t}),X.jsx(X6,{ref:a})]})}):null}function FY(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function W1(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?j1(Object(n),!0).forEach(function(r){FY(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function BY(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function UY(t,e){if(t==null)return{};var n=BY(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function jY(t,e){return WY(t)||VY(t,e)||zY(t,e)||$Y()}function WY(t){if(Array.isArray(t))return t}function VY(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,s=void 0;try{for(var o=t[Symbol.iterator](),a;!(r=(a=o.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(c){i=!0,s=c}finally{try{!r&&o.return!=null&&o.return()}finally{if(i)throw s}}return n}}function zY(t,e){if(t){if(typeof t=="string")return V1(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V1(t,e)}}function V1(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $Y(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HY(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function $1(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?z1(Object(n),!0).forEach(function(r){HY(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function GY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return e.reduceRight(function(i,s){return s(i)},r)}}function Wu(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=t.length?t.apply(this,i):function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function Jp(t){return{}.toString.call(t).includes("Object")}function qY(t){return!Object.keys(t).length}function Hd(t){return typeof t=="function"}function JY(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ZY(t,e){return Jp(e)||sa("changeType"),Object.keys(e).some(function(n){return!JY(t,n)})&&sa("changeField"),e}function KY(t){Hd(t)||sa("selectorType")}function YY(t){Hd(t)||Jp(t)||sa("handlerType"),Jp(t)&&Object.values(t).some(function(e){return!Hd(e)})&&sa("handlersType")}function XY(t){t||sa("initialIsRequired"),Jp(t)||sa("initialType"),qY(t)&&sa("initialContent")}function QY(t,e){throw new Error(t[e]||t.default)}var eX={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},sa=Wu(QY)(eX),ah={changes:ZY,selector:KY,handler:YY,initial:XY};function tX(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ah.initial(t),ah.handler(e);var n={current:t},r=Wu(iX)(n,e),i=Wu(rX)(n),s=Wu(ah.changes)(t),o=Wu(nX)(n);function a(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return ah.selector(l),l(n.current)}function c(l){GY(r,i,s,o)(l)}return[a,c]}function nX(t,e){return Hd(e)?e(t.current):e}function rX(t,e){return t.current=$1($1({},t.current),e),e}function iX(t,e,n){return Hd(e)?e(t.current):Object.keys(n).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,t.current[r])}),n}var sX={create:tX},oX={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function aX(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=t.length?t.apply(this,i):function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return e.apply(n,[].concat(i,a))}}}function cX(t){return{}.toString.call(t).includes("Object")}function lX(t){return t||H1("configIsRequired"),cX(t)||H1("configType"),t.urls?(uX(),{paths:{vs:t.urls.monacoBase}}):t}function uX(){console.warn(_x.deprecation)}function dX(t,e){throw new Error(t[e]||t.default)}var _x={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},H1=aX(dX)(_x),fX={config:lX},hX=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(s,o){return o(s)},i)}};function Ix(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],Ix(t[n],e[n]))}),W1(W1({},t),e)}var pX={type:"cancelation",msg:"operation is manually canceled"};function yv(t){var e=!1,n=new Promise(function(r,i){t.then(function(s){return e?i(pX):r(s)}),t.catch(i)});return n.cancel=function(){return e=!0},n}var mX=sX.create({config:oX,isInitialized:!1,resolve:null,reject:null,monaco:null}),Rx=jY(mX,2),kf=Rx[0],og=Rx[1];function gX(t){var e=fX.config(t),n=e.monaco,r=UY(e,["monaco"]);og(function(i){return{config:Ix(i.config,r),monaco:n}})}function vX(){var t=kf(function(e){var n=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!t.isInitialized){if(og({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),yv(Sv);if(window.monaco&&window.monaco.editor)return Px(window.monaco),t.resolve(window.monaco),yv(Sv);hX(yX,bX)(wX)}return yv(Sv)}function yX(t){return document.body.appendChild(t)}function SX(t){var e=document.createElement("script");return t&&(e.src=t),e}function bX(t){var e=kf(function(r){var i=r.config,s=r.reject;return{config:i,reject:s}}),n=SX("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function wX(){var t=kf(function(n){var r=n.config,i=n.resolve,s=n.reject;return{config:r,resolve:i,reject:s}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){Px(n),t.resolve(n)},function(n){t.reject(n)})}function Px(t){kf().monaco||og({monaco:t})}function kX(){return kf(function(t){var e=t.monaco;return e})}var Sv=new Promise(function(t,e){return og({resolve:t,reject:e})}),Ax={config:gX,init:vX,__getMonacoInstance:kX},EX={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},bv=EX,CX={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},TX=CX;function _X({children:t}){return wt.createElement("div",{style:TX.container},t)}var IX=_X,RX=IX;function PX({width:t,height:e,isEditorReady:n,loading:r,_ref:i,className:s,wrapperProps:o}){return wt.createElement("section",{style:{...bv.wrapper,width:t,height:e},...o},!n&&wt.createElement(RX,null,r),wt.createElement("div",{ref:i,style:{...bv.fullWidth,...!n&&bv.hide},className:s}))}var AX=PX,Nx=E.memo(AX);function NX(t){E.useEffect(t,[])}var Mx=NX;function MX(t,e,n=!0){let r=E.useRef(!0);E.useEffect(r.current||!n?()=>{r.current=!1}:t,e)}var Er=MX;function ad(){}function Zc(t,e,n,r){return xX(t,r)||OX(t,e,n,r)}function xX(t,e){return t.editor.getModel(xx(t,e))}function OX(t,e,n,r){return t.editor.createModel(e,n,r?xx(t,r):void 0)}function xx(t,e){return t.Uri.parse(e)}function DX({original:t,modified:e,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:s,modifiedModelPath:o,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:c=!1,theme:l="light",loading:u="Loading...",options:d={},height:f="100%",width:h="100%",className:p,wrapperProps:g={},beforeMount:y=ad,onMount:m=ad}){let[v,w]=E.useState(!1),[_,C]=E.useState(!0),k=E.useRef(null),T=E.useRef(null),R=E.useRef(null),A=E.useRef(m),M=E.useRef(y),O=E.useRef(!1);Mx(()=>{let J=Ax.init();return J.then(G=>(T.current=G)&&C(!1)).catch(G=>(G==null?void 0:G.type)!=="cancelation"&&console.error("Monaco initialization: error:",G)),()=>k.current?V():J.cancel()}),Er(()=>{if(k.current&&T.current){let J=k.current.getOriginalEditor(),G=Zc(T.current,t||"",r||n||"text",s||"");G!==J.getModel()&&J.setModel(G)}},[s],v),Er(()=>{if(k.current&&T.current){let J=k.current.getModifiedEditor(),G=Zc(T.current,e||"",i||n||"text",o||"");G!==J.getModel()&&J.setModel(G)}},[o],v),Er(()=>{let J=k.current.getModifiedEditor();J.getOption(T.current.editor.EditorOption.readOnly)?J.setValue(e||""):e!==J.getValue()&&(J.executeEdits("",[{range:J.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),J.pushUndoStop())},[e],v),Er(()=>{var J,G;(G=(J=k.current)==null?void 0:J.getModel())==null||G.original.setValue(t||"")},[t],v),Er(()=>{let{original:J,modified:G}=k.current.getModel();T.current.editor.setModelLanguage(J,r||n||"text"),T.current.editor.setModelLanguage(G,i||n||"text")},[n,r,i],v),Er(()=>{var J;(J=T.current)==null||J.editor.setTheme(l)},[l],v),Er(()=>{var J;(J=k.current)==null||J.updateOptions(d)},[d],v);let D=E.useCallback(()=>{var te;if(!T.current)return;M.current(T.current);let J=Zc(T.current,t||"",r||n||"text",s||""),G=Zc(T.current,e||"",i||n||"text",o||"");(te=k.current)==null||te.setModel({original:J,modified:G})},[n,e,i,t,r,s,o]),j=E.useCallback(()=>{var J;!O.current&&R.current&&(k.current=T.current.editor.createDiffEditor(R.current,{automaticLayout:!0,...d}),D(),(J=T.current)==null||J.editor.setTheme(l),w(!0),O.current=!0)},[d,l,D]);E.useEffect(()=>{v&&A.current(k.current,T.current)},[v]),E.useEffect(()=>{!_&&!v&&j()},[_,v,j]);function V(){var G,te,z,Z;let J=(G=k.current)==null?void 0:G.getModel();a||((te=J==null?void 0:J.original)==null||te.dispose()),c||((z=J==null?void 0:J.modified)==null||z.dispose()),(Z=k.current)==null||Z.dispose()}return wt.createElement(Nx,{width:h,height:f,isEditorReady:v,loading:u,_ref:R,className:p,wrapperProps:g})}var LX=DX;E.memo(LX);function FX(t){let e=E.useRef();return E.useEffect(()=>{e.current=t},[t]),e.current}var BX=FX,ch=new Map;function UX({defaultValue:t,defaultLanguage:e,defaultPath:n,value:r,language:i,path:s,theme:o="light",line:a,loading:c="Loading...",options:l={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:f=!1,width:h="100%",height:p="100%",className:g,wrapperProps:y={},beforeMount:m=ad,onMount:v=ad,onChange:w,onValidate:_=ad}){let[C,k]=E.useState(!1),[T,R]=E.useState(!0),A=E.useRef(null),M=E.useRef(null),O=E.useRef(null),D=E.useRef(v),j=E.useRef(m),V=E.useRef(),J=E.useRef(r),G=BX(s),te=E.useRef(!1),z=E.useRef(!1);Mx(()=>{let q=Ax.init();return q.then(se=>(A.current=se)&&R(!1)).catch(se=>(se==null?void 0:se.type)!=="cancelation"&&console.error("Monaco initialization: error:",se)),()=>M.current?ie():q.cancel()}),Er(()=>{var se,ke,Ee,me;let q=Zc(A.current,t||r||"",e||i||"",s||n||"");q!==((se=M.current)==null?void 0:se.getModel())&&(d&&ch.set(G,(ke=M.current)==null?void 0:ke.saveViewState()),(Ee=M.current)==null||Ee.setModel(q),d&&((me=M.current)==null||me.restoreViewState(ch.get(s))))},[s],C),Er(()=>{var q;(q=M.current)==null||q.updateOptions(l)},[l],C),Er(()=>{!M.current||r===void 0||(M.current.getOption(A.current.editor.EditorOption.readOnly)?M.current.setValue(r):r!==M.current.getValue()&&(z.current=!0,M.current.executeEdits("",[{range:M.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),M.current.pushUndoStop(),z.current=!1))},[r],C),Er(()=>{var se,ke;let q=(se=M.current)==null?void 0:se.getModel();q&&i&&((ke=A.current)==null||ke.editor.setModelLanguage(q,i))},[i],C),Er(()=>{var q;a!==void 0&&((q=M.current)==null||q.revealLine(a))},[a],C),Er(()=>{var q;(q=A.current)==null||q.editor.setTheme(o)},[o],C);let Z=E.useCallback(()=>{var q;if(!(!O.current||!A.current)&&!te.current){j.current(A.current);let se=s||n,ke=Zc(A.current,r||t||"",e||i||"",se||"");M.current=(q=A.current)==null?void 0:q.editor.create(O.current,{model:ke,automaticLayout:!0,...l},u),d&&M.current.restoreViewState(ch.get(se)),A.current.editor.setTheme(o),a!==void 0&&M.current.revealLine(a),k(!0),te.current=!0}},[t,e,n,r,i,s,l,u,d,o,a]);E.useEffect(()=>{C&&D.current(M.current,A.current)},[C]),E.useEffect(()=>{!T&&!C&&Z()},[T,C,Z]),J.current=r,E.useEffect(()=>{var q,se;C&&w&&((q=V.current)==null||q.dispose(),V.current=(se=M.current)==null?void 0:se.onDidChangeModelContent(ke=>{z.current||w(M.current.getValue(),ke)}))},[C,w]),E.useEffect(()=>{if(C){let q=A.current.editor.onDidChangeMarkers(se=>{var Ee;let ke=(Ee=M.current.getModel())==null?void 0:Ee.uri;if(ke&&se.find(me=>me.path===ke.path)){let me=A.current.editor.getModelMarkers({resource:ke});_==null||_(me)}});return()=>{q==null||q.dispose()}}return()=>{}},[C,_]);function ie(){var q,se;(q=V.current)==null||q.dispose(),f?d&&ch.set(s,M.current.saveViewState()):(se=M.current.getModel())==null||se.dispose(),M.current.dispose()}return wt.createElement(Nx,{width:h,height:p,isEditorReady:C,loading:c,_ref:O,className:g,wrapperProps:y})}var jX=UX,WX=E.memo(jX),VX=WX,zX={restoreOnUnmount:!1};function $X(t,e){e===void 0&&(e=zX);var n=E.useRef(document.title);document.title!==t&&(document.title=t),E.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=n.current}},[])}const HX=typeof document<"u"?$X:function(t){};function GX(){const t=EI(),e=wt.useRef(null),[n,r]=E.useState(""),[i,s]=E.useState(""),[o,a]=E.useState(""),[c,l]=E.useState(0),[u,d]=E.useState({name:"none",contents:[],reference:"",type:""}),f=(D,j)=>{e.current=D,e.current=D},[h,p]=Sa();console.log(h);const g=h.editor.accessibilityMode,y=h.editor.autocompleteEnabled;CI(D=>{C.postMessage({type:"close",id:T}),c===1&&D.preventDefault()});const[m,v]=E.useState(!1),w=m?`${u.name} - Mongoose Editor`:"Mongoose Editor";HX(w);const _=E.useMemo(()=>{switch(c){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[c]),C=E.useMemo(()=>new BroadcastChannel("editor"),[]),k=new URLSearchParams(t.search),T=decodeURIComponent(k.get("reference")||"");E.useEffect(()=>{if(!T)return;console.log("ID: "+T),console.log("Sending ready message"),C.postMessage({type:"ready",id:T});const D=j=>{if(console.log(j.data),j.data.type==="load"){if(n!=="")return;const V=j.data.session.contents.join(`
`);s(V),a(V),d(j.data.session),l(0),r(j.data.clientId)}else if(j.data.type==="shutdown"){if(j.data.clientId!==n)return;C.close(),window.close()}};return C.addEventListener("message",D),()=>C.removeEventListener("message",D)},[C,n,T]);const R=()=>{s(o),l(0)},A=D=>{const j=i.split(/\r\n|\r|\n/),V={...u,contents:j};C.postMessage({type:"save",session:V,id:T}),l(2),e.current!==null&&e.current.focus(),D.preventDefault()},M=D=>{D!==void 0&&(console.log("Original: "+o),console.log("New: "+D),s(D),D.split(/\r\n|\r|\n/).join(`
`)!==o?l(1):l(0),m||v(!0))},O=()=>{const D=new Blob([i],{type:"text/plain"}),j=URL.createObjectURL(D),V=document.createElement("a"),J=new Date,G=J.toLocaleDateString().replace(/\//g,"-"),te=J.toLocaleTimeString().replace(/:/g,"-"),z=`${u.name}-${G}-${te}.txt`;V.download=z,V.href=j,V.click(),URL.revokeObjectURL(j),V.remove()};return X.jsxs(X.Fragment,{children:[X.jsx("div",{className:"toolbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderBottom:"1px solid #e8e8e8"},children:X.jsxs("form",{onSubmit:D=>D.preventDefault(),children:[X.jsxs("button",{onClick:A,accessKey:"s",children:[X.jsx(oP,{}),"Save"]}),X.jsxs("button",{onClick:R,accessKey:"r",children:[X.jsx(i8,{}),"Revert"]}),X.jsxs("button",{onClick:O,accessKey:"d",children:[X.jsx(n8,{}),"Download"]})]})}),X.jsx(VX,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:M,options:{wordWrap:"on",accessibilitySupport:g?"on":"off",quickSuggestions:y},onMount:f}),X.jsxs("div",{"aria-live":"polite",className:"statusbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderTop:"1px solid #e8e8e8"},children:[X.jsx("span",{children:_}),X.jsx("span",{children:"|"}),X.jsx("span",{children:u.reference}),X.jsx("span",{children:"|"}),X.jsx("span",{children:u.type})]})]})}const qX="modulepreload",JX=function(t){return"/"+t},G1={},ZX=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link");i=Promise.all(n.map(o=>{if(o=JX(o),o in G1)return;G1[o]=!0;const a=o.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===o&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${c}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":qX,a||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),a)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})}))}return i.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},KX=t=>{t&&t instanceof Function&&ZX(()=>import("./web-vitals-GXdahIIP.js"),__vite__mapDeps([])).then(({getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:s})=>{e(t),n(t),r(t),i(t),s(t)})};var q1={};const YX=!!(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function XX(t){if("serviceWorker"in navigator){if(new URL(q1.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const n=`${q1.PUBLIC_URL}/service-worker.js`;YX?(QX(n,t),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Ox(n,t)})}}function Ox(t,e){navigator.serviceWorker.register(t).then(n=>{n.onupdatefound=()=>{const r=n.installing;r!=null&&(r.onstatechange=()=>{r.state==="installed"&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(n)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(n)))})}}).catch(n=>{console.error("Error during service worker registration:",n)})}function QX(t,e){fetch(t).then(n=>{const r=n.headers.get("content-type");n.status===404||r!=null&&r.indexOf("javascript")===-1?navigator.serviceWorker.ready.then(i=>{i.unregister().then(()=>{window.location.reload()})}):Ox(t,e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}CY({dsn:"https://2356c3ef12dad1afcb30defd749d96f1@new.q-continuum.net/2",integrations:[new nJ({tracePropagationTargets:["localhost",/^https:\/\/client\.rustytelephone\.net\//]}),new Zm],tracesSampleRate:1,replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1});const eQ=kF([{path:"/",element:X.jsx(LY,{})},{path:"/editor",element:X.jsx(GX,{})}]),tQ=kv.createRoot(document.getElementById("root"));tQ.render(X.jsx(wt.StrictMode,{children:X.jsx(NF,{router:eQ})}));KX(console.log);XX()});export default nQ();
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
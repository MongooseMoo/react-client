var ND=Object.defineProperty;var jb=n=>{throw TypeError(n)};var OD=(n,e,t)=>e in n?ND(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var oe=(n,e,t)=>OD(n,typeof e!="symbol"?e+"":e,t),Lm=(n,e,t)=>e.has(n)||jb("Cannot "+t);var le=(n,e,t)=>(Lm(n,e,"read from private field"),t?t.call(n):e.get(n)),Pn=(n,e,t)=>e.has(n)?jb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Jt=(n,e,t,r)=>(Lm(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),Nt=(n,e,t)=>(Lm(n,e,"access private method"),t);var Mh=(n,e,t,r)=>({set _(i){Jt(n,e,i,t)},get _(){return le(n,e,r)}});function sk(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(n,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var Jh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nc(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function FD(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var Um={exports:{}},bd={},jm={exports:{}},wn={},Vb;function BD(){if(Vb)return wn;Vb=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function g(H){return H===null||typeof H!="object"?null:(H=p&&H[p]||H["@@iterator"],typeof H=="function"?H:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,x={};function w(H,ee,ae){this.props=H,this.context=ee,this.refs=x,this.updater=ae||y}w.prototype.isReactComponent={},w.prototype.setState=function(H,ee){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ee,"setState")},w.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function S(){}S.prototype=w.prototype;function E(H,ee,ae){this.props=H,this.context=ee,this.refs=x,this.updater=ae||y}var R=E.prototype=new S;R.constructor=E,C(R,w.prototype),R.isPureReactComponent=!0;var k=Array.isArray,A=Object.prototype.hasOwnProperty,_={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function j(H,ee,ae){var ye,Ee={},_e=null,Je=null;if(ee!=null)for(ye in ee.ref!==void 0&&(Je=ee.ref),ee.key!==void 0&&(_e=""+ee.key),ee)A.call(ee,ye)&&!D.hasOwnProperty(ye)&&(Ee[ye]=ee[ye]);var me=arguments.length-2;if(me===1)Ee.children=ae;else if(1<me){for(var it=Array(me),Tt=0;Tt<me;Tt++)it[Tt]=arguments[Tt+2];Ee.children=it}if(H&&H.defaultProps)for(ye in me=H.defaultProps,me)Ee[ye]===void 0&&(Ee[ye]=me[ye]);return{$$typeof:n,type:H,key:_e,ref:Je,props:Ee,_owner:_.current}}function Z(H,ee){return{$$typeof:n,type:H.type,key:ee,ref:H.ref,props:H.props,_owner:H._owner}}function F(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function V(H){var ee={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ae){return ee[ae]})}var X=/\/+/g;function te(H,ee){return typeof H=="object"&&H!==null&&H.key!=null?V(""+H.key):ee.toString(36)}function pe(H,ee,ae,ye,Ee){var _e=typeof H;(_e==="undefined"||_e==="boolean")&&(H=null);var Je=!1;if(H===null)Je=!0;else switch(_e){case"string":case"number":Je=!0;break;case"object":switch(H.$$typeof){case n:case e:Je=!0}}if(Je)return Je=H,Ee=Ee(Je),H=ye===""?"."+te(Je,0):ye,k(Ee)?(ae="",H!=null&&(ae=H.replace(X,"$&/")+"/"),pe(Ee,ee,ae,"",function(Tt){return Tt})):Ee!=null&&(F(Ee)&&(Ee=Z(Ee,ae+(!Ee.key||Je&&Je.key===Ee.key?"":(""+Ee.key).replace(X,"$&/")+"/")+H)),ee.push(Ee)),1;if(Je=0,ye=ye===""?".":ye+":",k(H))for(var me=0;me<H.length;me++){_e=H[me];var it=ye+te(_e,me);Je+=pe(_e,ee,ae,it,Ee)}else if(it=g(H),typeof it=="function")for(H=it.call(H),me=0;!(_e=H.next()).done;)_e=_e.value,it=ye+te(_e,me++),Je+=pe(_e,ee,ae,it,Ee);else if(_e==="object")throw ee=String(H),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.");return Je}function ve(H,ee,ae){if(H==null)return H;var ye=[],Ee=0;return pe(H,ye,"","",function(_e){return ee.call(ae,_e,Ee++)}),ye}function Ie(H){if(H._status===-1){var ee=H._result;ee=ee(),ee.then(function(ae){(H._status===0||H._status===-1)&&(H._status=1,H._result=ae)},function(ae){(H._status===0||H._status===-1)&&(H._status=2,H._result=ae)}),H._status===-1&&(H._status=0,H._result=ee)}if(H._status===1)return H._result.default;throw H._result}var Re={current:null},xe={transition:null},Ae={ReactCurrentDispatcher:Re,ReactCurrentBatchConfig:xe,ReactCurrentOwner:_};function ke(){throw Error("act(...) is not supported in production builds of React.")}return wn.Children={map:ve,forEach:function(H,ee,ae){ve(H,function(){ee.apply(this,arguments)},ae)},count:function(H){var ee=0;return ve(H,function(){ee++}),ee},toArray:function(H){return ve(H,function(ee){return ee})||[]},only:function(H){if(!F(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},wn.Component=w,wn.Fragment=t,wn.Profiler=i,wn.PureComponent=E,wn.StrictMode=r,wn.Suspense=l,wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ae,wn.act=ke,wn.cloneElement=function(H,ee,ae){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var ye=C({},H.props),Ee=H.key,_e=H.ref,Je=H._owner;if(ee!=null){if(ee.ref!==void 0&&(_e=ee.ref,Je=_.current),ee.key!==void 0&&(Ee=""+ee.key),H.type&&H.type.defaultProps)var me=H.type.defaultProps;for(it in ee)A.call(ee,it)&&!D.hasOwnProperty(it)&&(ye[it]=ee[it]===void 0&&me!==void 0?me[it]:ee[it])}var it=arguments.length-2;if(it===1)ye.children=ae;else if(1<it){me=Array(it);for(var Tt=0;Tt<it;Tt++)me[Tt]=arguments[Tt+2];ye.children=me}return{$$typeof:n,type:H.type,key:Ee,ref:_e,props:ye,_owner:Je}},wn.createContext=function(H){return H={$$typeof:c,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:o,_context:H},H.Consumer=H},wn.createElement=j,wn.createFactory=function(H){var ee=j.bind(null,H);return ee.type=H,ee},wn.createRef=function(){return{current:null}},wn.forwardRef=function(H){return{$$typeof:s,render:H}},wn.isValidElement=F,wn.lazy=function(H){return{$$typeof:h,_payload:{_status:-1,_result:H},_init:Ie}},wn.memo=function(H,ee){return{$$typeof:d,type:H,compare:ee===void 0?null:ee}},wn.startTransition=function(H){var ee=xe.transition;xe.transition={};try{H()}finally{xe.transition=ee}},wn.unstable_act=ke,wn.useCallback=function(H,ee){return Re.current.useCallback(H,ee)},wn.useContext=function(H){return Re.current.useContext(H)},wn.useDebugValue=function(){},wn.useDeferredValue=function(H){return Re.current.useDeferredValue(H)},wn.useEffect=function(H,ee){return Re.current.useEffect(H,ee)},wn.useId=function(){return Re.current.useId()},wn.useImperativeHandle=function(H,ee,ae){return Re.current.useImperativeHandle(H,ee,ae)},wn.useInsertionEffect=function(H,ee){return Re.current.useInsertionEffect(H,ee)},wn.useLayoutEffect=function(H,ee){return Re.current.useLayoutEffect(H,ee)},wn.useMemo=function(H,ee){return Re.current.useMemo(H,ee)},wn.useReducer=function(H,ee,ae){return Re.current.useReducer(H,ee,ae)},wn.useRef=function(H){return Re.current.useRef(H)},wn.useState=function(H){return Re.current.useState(H)},wn.useSyncExternalStore=function(H,ee,ae){return Re.current.useSyncExternalStore(H,ee,ae)},wn.useTransition=function(){return Re.current.useTransition()},wn.version="18.3.1",wn}var Gb;function kf(){return Gb||(Gb=1,jm.exports=BD()),jm.exports}var Wb;function LD(){if(Wb)return bd;Wb=1;var n=kf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(s,l,d){var h,p={},g=null,y=null;d!==void 0&&(g=""+d),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(y=l.ref);for(h in l)r.call(l,h)&&!o.hasOwnProperty(h)&&(p[h]=l[h]);if(s&&s.defaultProps)for(h in l=s.defaultProps,l)p[h]===void 0&&(p[h]=l[h]);return{$$typeof:e,type:s,key:g,ref:y,props:p,_owner:i.current}}return bd.Fragment=t,bd.jsx=c,bd.jsxs=c,bd}var zb;function UD(){return zb||(zb=1,Um.exports=LD()),Um.exports}var K=UD(),B=kf();const Cn=Nc(B),jD=sk({__proto__:null,default:Cn},[B]);var Nh={},Vm={exports:{}},lo={},Gm={exports:{}},Wm={},Hb;function VD(){return Hb||(Hb=1,function(n){function e(xe,Ae){var ke=xe.length;xe.push(Ae);e:for(;0<ke;){var H=ke-1>>>1,ee=xe[H];if(0<i(ee,Ae))xe[H]=Ae,xe[ke]=ee,ke=H;else break e}}function t(xe){return xe.length===0?null:xe[0]}function r(xe){if(xe.length===0)return null;var Ae=xe[0],ke=xe.pop();if(ke!==Ae){xe[0]=ke;e:for(var H=0,ee=xe.length,ae=ee>>>1;H<ae;){var ye=2*(H+1)-1,Ee=xe[ye],_e=ye+1,Je=xe[_e];if(0>i(Ee,ke))_e<ee&&0>i(Je,Ee)?(xe[H]=Je,xe[_e]=ke,H=_e):(xe[H]=Ee,xe[ye]=ke,H=ye);else if(_e<ee&&0>i(Je,ke))xe[H]=Je,xe[_e]=ke,H=_e;else break e}}return Ae}function i(xe,Ae){var ke=xe.sortIndex-Ae.sortIndex;return ke!==0?ke:xe.id-Ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var c=Date,s=c.now();n.unstable_now=function(){return c.now()-s}}var l=[],d=[],h=1,p=null,g=3,y=!1,C=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(xe){for(var Ae=t(d);Ae!==null;){if(Ae.callback===null)r(d);else if(Ae.startTime<=xe)r(d),Ae.sortIndex=Ae.expirationTime,e(l,Ae);else break;Ae=t(d)}}function k(xe){if(x=!1,R(xe),!C)if(t(l)!==null)C=!0,Ie(A);else{var Ae=t(d);Ae!==null&&Re(k,Ae.startTime-xe)}}function A(xe,Ae){C=!1,x&&(x=!1,S(j),j=-1),y=!0;var ke=g;try{for(R(Ae),p=t(l);p!==null&&(!(p.expirationTime>Ae)||xe&&!V());){var H=p.callback;if(typeof H=="function"){p.callback=null,g=p.priorityLevel;var ee=H(p.expirationTime<=Ae);Ae=n.unstable_now(),typeof ee=="function"?p.callback=ee:p===t(l)&&r(l),R(Ae)}else r(l);p=t(l)}if(p!==null)var ae=!0;else{var ye=t(d);ye!==null&&Re(k,ye.startTime-Ae),ae=!1}return ae}finally{p=null,g=ke,y=!1}}var _=!1,D=null,j=-1,Z=5,F=-1;function V(){return!(n.unstable_now()-F<Z)}function X(){if(D!==null){var xe=n.unstable_now();F=xe;var Ae=!0;try{Ae=D(!0,xe)}finally{Ae?te():(_=!1,D=null)}}else _=!1}var te;if(typeof E=="function")te=function(){E(X)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,ve=pe.port2;pe.port1.onmessage=X,te=function(){ve.postMessage(null)}}else te=function(){w(X,0)};function Ie(xe){D=xe,_||(_=!0,te())}function Re(xe,Ae){j=w(function(){xe(n.unstable_now())},Ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(xe){xe.callback=null},n.unstable_continueExecution=function(){C||y||(C=!0,Ie(A))},n.unstable_forceFrameRate=function(xe){0>xe||125<xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<xe?Math.floor(1e3/xe):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(xe){switch(g){case 1:case 2:case 3:var Ae=3;break;default:Ae=g}var ke=g;g=Ae;try{return xe()}finally{g=ke}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(xe,Ae){switch(xe){case 1:case 2:case 3:case 4:case 5:break;default:xe=3}var ke=g;g=xe;try{return Ae()}finally{g=ke}},n.unstable_scheduleCallback=function(xe,Ae,ke){var H=n.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?H+ke:H):ke=H,xe){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=ke+ee,xe={id:h++,callback:Ae,priorityLevel:xe,startTime:ke,expirationTime:ee,sortIndex:-1},ke>H?(xe.sortIndex=ke,e(d,xe),t(l)===null&&xe===t(d)&&(x?(S(j),j=-1):x=!0,Re(k,ke-H))):(xe.sortIndex=ee,e(l,xe),C||y||(C=!0,Ie(A))),xe},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(xe){var Ae=g;return function(){var ke=g;g=Ae;try{return xe.apply(this,arguments)}finally{g=ke}}}}(Wm)),Wm}var Zb;function GD(){return Zb||(Zb=1,Gm.exports=VD()),Gm.exports}var Xb;function WD(){if(Xb)return lo;Xb=1;var n=kf(),e=GD();function t(a){for(var f="https://reactjs.org/docs/error-decoder.html?invariant="+a,v=1;v<arguments.length;v++)f+="&args[]="+encodeURIComponent(arguments[v]);return"Minified React error #"+a+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function o(a,f){c(a,f),c(a+"Capture",f)}function c(a,f){for(i[a]=f,a=0;a<f.length;a++)r.add(f[a])}var s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function g(a){return l.call(p,a)?!0:l.call(h,a)?!1:d.test(a)?p[a]=!0:(h[a]=!0,!1)}function y(a,f,v,b){if(v!==null&&v.type===0)return!1;switch(typeof f){case"function":case"symbol":return!0;case"boolean":return b?!1:v!==null?!v.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function C(a,f,v,b){if(f===null||typeof f>"u"||y(a,f,v,b))return!0;if(b)return!1;if(v!==null)switch(v.type){case 3:return!f;case 4:return f===!1;case 5:return isNaN(f);case 6:return isNaN(f)||1>f}return!1}function x(a,f,v,b,T,O,$){this.acceptsBooleans=f===2||f===3||f===4,this.attributeName=b,this.attributeNamespace=T,this.mustUseProperty=v,this.propertyName=a,this.type=f,this.sanitizeURL=O,this.removeEmptyString=$}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){w[a]=new x(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var f=a[0];w[f]=new x(f,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){w[a]=new x(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){w[a]=new x(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){w[a]=new x(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){w[a]=new x(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){w[a]=new x(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){w[a]=new x(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){w[a]=new x(a,5,!1,a.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function E(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var f=a.replace(S,E);w[f]=new x(f,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var f=a.replace(S,E);w[f]=new x(f,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var f=a.replace(S,E);w[f]=new x(f,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){w[a]=new x(a,1,!1,a.toLowerCase(),null,!1,!1)}),w.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){w[a]=new x(a,1,!1,a.toLowerCase(),null,!0,!0)});function R(a,f,v,b){var T=w.hasOwnProperty(f)?w[f]:null;(T!==null?T.type!==0:b||!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(C(f,v,T,b)&&(v=null),b||T===null?g(f)&&(v===null?a.removeAttribute(f):a.setAttribute(f,""+v)):T.mustUseProperty?a[T.propertyName]=v===null?T.type===3?!1:"":v:(f=T.attributeName,b=T.attributeNamespace,v===null?a.removeAttribute(f):(T=T.type,v=T===3||T===4&&v===!0?"":""+v,b?a.setAttributeNS(b,f,v):a.setAttribute(f,v))))}var k=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),_=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),Z=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),V=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),pe=Symbol.for("react.suspense_list"),ve=Symbol.for("react.memo"),Ie=Symbol.for("react.lazy"),Re=Symbol.for("react.offscreen"),xe=Symbol.iterator;function Ae(a){return a===null||typeof a!="object"?null:(a=xe&&a[xe]||a["@@iterator"],typeof a=="function"?a:null)}var ke=Object.assign,H;function ee(a){if(H===void 0)try{throw Error()}catch(v){var f=v.stack.trim().match(/\n( *(at )?)/);H=f&&f[1]||""}return`
`+H+a}var ae=!1;function ye(a,f){if(!a||ae)return"";ae=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(f)if(f=function(){throw Error()},Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(Ue){var b=Ue}Reflect.construct(a,[],f)}else{try{f.call()}catch(Ue){b=Ue}a.call(f.prototype)}else{try{throw Error()}catch(Ue){b=Ue}a()}}catch(Ue){if(Ue&&b&&typeof Ue.stack=="string"){for(var T=Ue.stack.split(`
`),O=b.stack.split(`
`),$=T.length-1,ue=O.length-1;1<=$&&0<=ue&&T[$]!==O[ue];)ue--;for(;1<=$&&0<=ue;$--,ue--)if(T[$]!==O[ue]){if($!==1||ue!==1)do if($--,ue--,0>ue||T[$]!==O[ue]){var be=`
`+T[$].replace(" at new "," at ");return a.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",a.displayName)),be}while(1<=$&&0<=ue);break}}}finally{ae=!1,Error.prepareStackTrace=v}return(a=a?a.displayName||a.name:"")?ee(a):""}function Ee(a){switch(a.tag){case 5:return ee(a.type);case 16:return ee("Lazy");case 13:return ee("Suspense");case 19:return ee("SuspenseList");case 0:case 2:case 15:return a=ye(a.type,!1),a;case 11:return a=ye(a.type.render,!1),a;case 1:return a=ye(a.type,!0),a;default:return""}}function _e(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case D:return"Fragment";case _:return"Portal";case Z:return"Profiler";case j:return"StrictMode";case te:return"Suspense";case pe:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case V:return(a.displayName||"Context")+".Consumer";case F:return(a._context.displayName||"Context")+".Provider";case X:var f=a.render;return a=a.displayName,a||(a=f.displayName||f.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case ve:return f=a.displayName||null,f!==null?f:_e(a.type)||"Memo";case Ie:f=a._payload,a=a._init;try{return _e(a(f))}catch{}}return null}function Je(a){var f=a.type;switch(a.tag){case 24:return"Cache";case 9:return(f.displayName||"Context")+".Consumer";case 10:return(f._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=f.render,a=a.displayName||a.name||"",f.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return f;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _e(f);case 8:return f===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f}return null}function me(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function it(a){var f=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function Tt(a){var f=it(a)?"checked":"value",v=Object.getOwnPropertyDescriptor(a.constructor.prototype,f),b=""+a[f];if(!a.hasOwnProperty(f)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var T=v.get,O=v.set;return Object.defineProperty(a,f,{configurable:!0,get:function(){return T.call(this)},set:function($){b=""+$,O.call(this,$)}}),Object.defineProperty(a,f,{enumerable:v.enumerable}),{getValue:function(){return b},setValue:function($){b=""+$},stopTracking:function(){a._valueTracker=null,delete a[f]}}}}function Xt(a){a._valueTracker||(a._valueTracker=Tt(a))}function Et(a){if(!a)return!1;var f=a._valueTracker;if(!f)return!0;var v=f.getValue(),b="";return a&&(b=it(a)?a.checked?"true":"false":a.value),a=b,a!==v?(f.setValue(a),!0):!1}function St(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Pt(a,f){var v=f.checked;return ke({},f,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:v??a._wrapperState.initialChecked})}function at(a,f){var v=f.defaultValue==null?"":f.defaultValue,b=f.checked!=null?f.checked:f.defaultChecked;v=me(f.value!=null?f.value:v),a._wrapperState={initialChecked:b,initialValue:v,controlled:f.type==="checkbox"||f.type==="radio"?f.checked!=null:f.value!=null}}function lt(a,f){f=f.checked,f!=null&&R(a,"checked",f,!1)}function Gt(a,f){lt(a,f);var v=me(f.value),b=f.type;if(v!=null)b==="number"?(v===0&&a.value===""||a.value!=v)&&(a.value=""+v):a.value!==""+v&&(a.value=""+v);else if(b==="submit"||b==="reset"){a.removeAttribute("value");return}f.hasOwnProperty("value")?Dt(a,f.type,v):f.hasOwnProperty("defaultValue")&&Dt(a,f.type,me(f.defaultValue)),f.checked==null&&f.defaultChecked!=null&&(a.defaultChecked=!!f.defaultChecked)}function Vt(a,f,v){if(f.hasOwnProperty("value")||f.hasOwnProperty("defaultValue")){var b=f.type;if(!(b!=="submit"&&b!=="reset"||f.value!==void 0&&f.value!==null))return;f=""+a._wrapperState.initialValue,v||f===a.value||(a.value=f),a.defaultValue=f}v=a.name,v!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,v!==""&&(a.name=v)}function Dt(a,f,v){(f!=="number"||St(a.ownerDocument)!==a)&&(v==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+v&&(a.defaultValue=""+v))}var Ht=Array.isArray;function sn(a,f,v,b){if(a=a.options,f){f={};for(var T=0;T<v.length;T++)f["$"+v[T]]=!0;for(v=0;v<a.length;v++)T=f.hasOwnProperty("$"+a[v].value),a[v].selected!==T&&(a[v].selected=T),T&&b&&(a[v].defaultSelected=!0)}else{for(v=""+me(v),f=null,T=0;T<a.length;T++){if(a[T].value===v){a[T].selected=!0,b&&(a[T].defaultSelected=!0);return}f!==null||a[T].disabled||(f=a[T])}f!==null&&(f.selected=!0)}}function ct(a,f){if(f.dangerouslySetInnerHTML!=null)throw Error(t(91));return ke({},f,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function ce(a,f){var v=f.value;if(v==null){if(v=f.children,f=f.defaultValue,v!=null){if(f!=null)throw Error(t(92));if(Ht(v)){if(1<v.length)throw Error(t(93));v=v[0]}f=v}f==null&&(f=""),v=f}a._wrapperState={initialValue:me(v)}}function rn(a,f){var v=me(f.value),b=me(f.defaultValue);v!=null&&(v=""+v,v!==a.value&&(a.value=v),f.defaultValue==null&&a.defaultValue!==v&&(a.defaultValue=v)),b!=null&&(a.defaultValue=""+b)}function mn(a){var f=a.textContent;f===a._wrapperState.initialValue&&f!==""&&f!==null&&(a.value=f)}function Vn(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function q(a,f){return a==null||a==="http://www.w3.org/1999/xhtml"?Vn(f):a==="http://www.w3.org/2000/svg"&&f==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var N,L=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(f,v,b,T){MSApp.execUnsafeLocalFunction(function(){return a(f,v,b,T)})}:a}(function(a,f){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=f;else{for(N=N||document.createElement("div"),N.innerHTML="<svg>"+f.valueOf().toString()+"</svg>",f=N.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;f.firstChild;)a.appendChild(f.firstChild)}});function ne(a,f){if(f){var v=a.firstChild;if(v&&v===a.lastChild&&v.nodeType===3){v.nodeValue=f;return}}a.textContent=f}var Ce={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pe=["Webkit","ms","Moz","O"];Object.keys(Ce).forEach(function(a){Pe.forEach(function(f){f=f+a.charAt(0).toUpperCase()+a.substring(1),Ce[f]=Ce[a]})});function Ve(a,f,v){return f==null||typeof f=="boolean"||f===""?"":v||typeof f!="number"||f===0||Ce.hasOwnProperty(a)&&Ce[a]?(""+f).trim():f+"px"}function Lt(a,f){a=a.style;for(var v in f)if(f.hasOwnProperty(v)){var b=v.indexOf("--")===0,T=Ve(v,f[v],b);v==="float"&&(v="cssFloat"),b?a.setProperty(v,T):a[v]=T}}var hn=ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pn(a,f){if(f){if(hn[a]&&(f.children!=null||f.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(f.dangerouslySetInnerHTML!=null){if(f.children!=null)throw Error(t(60));if(typeof f.dangerouslySetInnerHTML!="object"||!("__html"in f.dangerouslySetInnerHTML))throw Error(t(61))}if(f.style!=null&&typeof f.style!="object")throw Error(t(62))}}function xn(a,f){if(a.indexOf("-")===-1)return typeof f.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dn=null;function Ln(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var kr=null,yr=null,Qt=null;function ei(a){if(a=sd(a)){if(typeof kr!="function")throw Error(t(280));var f=a.stateNode;f&&(f=$f(f),kr(a.stateNode,a.type,f))}}function Qe(a){yr?Qt?Qt.push(a):Qt=[a]:yr=a}function Tn(){if(yr){var a=yr,f=Qt;if(Qt=yr=null,ei(a),f)for(a=0;a<f.length;a++)ei(f[a])}}function Wt(a,f){return a(f)}function hr(){}var Qn=!1;function ti(a,f,v){if(Qn)return a(f,v);Qn=!0;try{return Wt(a,f,v)}finally{Qn=!1,(yr!==null||Qt!==null)&&(hr(),Tn())}}function Lr(a,f){var v=a.stateNode;if(v===null)return null;var b=$f(v);if(b===null)return null;v=b[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(a=a.type,b=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!b;break e;default:a=!1}if(a)return null;if(v&&typeof v!="function")throw Error(t(231,f,typeof v));return v}var ge=!1;if(s)try{var we={};Object.defineProperty(we,"passive",{get:function(){ge=!0}}),window.addEventListener("test",we,we),window.removeEventListener("test",we,we)}catch{ge=!1}function J(a,f,v,b,T,O,$,ue,be){var Ue=Array.prototype.slice.call(arguments,3);try{f.apply(v,Ue)}catch(nt){this.onError(nt)}}var Ge=!1,rt=null,_t=!1,Ot=null,pt={onError:function(a){Ge=!0,rt=a}};function gt(a,f,v,b,T,O,$,ue,be){Ge=!1,rt=null,J.apply(pt,arguments)}function bt(a,f,v,b,T,O,$,ue,be){if(gt.apply(this,arguments),Ge){if(Ge){var Ue=rt;Ge=!1,rt=null}else throw Error(t(198));_t||(_t=!0,Ot=Ue)}}function Le(a){var f=a,v=a;if(a.alternate)for(;f.return;)f=f.return;else{a=f;do f=a,(f.flags&4098)!==0&&(v=f.return),a=f.return;while(a)}return f.tag===3?v:null}function ut(a){if(a.tag===13){var f=a.memoizedState;if(f===null&&(a=a.alternate,a!==null&&(f=a.memoizedState)),f!==null)return f.dehydrated}return null}function He(a){if(Le(a)!==a)throw Error(t(188))}function bn(a){var f=a.alternate;if(!f){if(f=Le(a),f===null)throw Error(t(188));return f!==a?null:a}for(var v=a,b=f;;){var T=v.return;if(T===null)break;var O=T.alternate;if(O===null){if(b=T.return,b!==null){v=b;continue}break}if(T.child===O.child){for(O=T.child;O;){if(O===v)return He(T),a;if(O===b)return He(T),f;O=O.sibling}throw Error(t(188))}if(v.return!==b.return)v=T,b=O;else{for(var $=!1,ue=T.child;ue;){if(ue===v){$=!0,v=T,b=O;break}if(ue===b){$=!0,b=T,v=O;break}ue=ue.sibling}if(!$){for(ue=O.child;ue;){if(ue===v){$=!0,v=O,b=T;break}if(ue===b){$=!0,b=O,v=T;break}ue=ue.sibling}if(!$)throw Error(t(189))}}if(v.alternate!==b)throw Error(t(190))}if(v.tag!==3)throw Error(t(188));return v.stateNode.current===v?a:f}function st(a){return a=bn(a),a!==null?de(a):null}function de(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var f=de(a);if(f!==null)return f;a=a.sibling}return null}var Ze=e.unstable_scheduleCallback,It=e.unstable_cancelCallback,In=e.unstable_shouldYield,Ft=e.unstable_requestPaint,wt=e.unstable_now,zt=e.unstable_getCurrentPriorityLevel,Jn=e.unstable_ImmediatePriority,er=e.unstable_UserBlockingPriority,ir=e.unstable_NormalPriority,Fn=e.unstable_LowPriority,nn=e.unstable_IdlePriority,vn=null,or=null;function hi(a){if(or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(vn,a,void 0,(a.current.flags&128)===128)}catch{}}var yn=Math.clz32?Math.clz32:Lo,Wr=Math.log,At=Math.LN2;function Lo(a){return a>>>=0,a===0?32:31-(Wr(a)/At|0)|0}var Ji=64,eo=4194304;function kt(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function on(a,f){var v=a.pendingLanes;if(v===0)return 0;var b=0,T=a.suspendedLanes,O=a.pingedLanes,$=v&268435455;if($!==0){var ue=$&~T;ue!==0?b=kt(ue):(O&=$,O!==0&&(b=kt(O)))}else $=v&~T,$!==0?b=kt($):O!==0&&(b=kt(O));if(b===0)return 0;if(f!==0&&f!==b&&(f&T)===0&&(T=b&-b,O=f&-f,T>=O||T===16&&(O&4194240)!==0))return f;if((b&4)!==0&&(b|=v&16),f=a.entangledLanes,f!==0)for(a=a.entanglements,f&=b;0<f;)v=31-yn(f),T=1<<v,b|=a[v],f&=~T;return b}function M(a,f){switch(a){case 1:case 2:case 4:return f+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function G(a,f){for(var v=a.suspendedLanes,b=a.pingedLanes,T=a.expirationTimes,O=a.pendingLanes;0<O;){var $=31-yn(O),ue=1<<$,be=T[$];be===-1?((ue&v)===0||(ue&b)!==0)&&(T[$]=M(ue,f)):be<=f&&(a.expiredLanes|=ue),O&=~ue}}function Q(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function ie(){var a=Ji;return Ji<<=1,(Ji&4194240)===0&&(Ji=64),a}function Oe(a){for(var f=[],v=0;31>v;v++)f.push(a);return f}function Te(a,f,v){a.pendingLanes|=f,f!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,f=31-yn(f),a[f]=v}function ze(a,f){var v=a.pendingLanes&~f;a.pendingLanes=f,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=f,a.mutableReadLanes&=f,a.entangledLanes&=f,f=a.entanglements;var b=a.eventTimes;for(a=a.expirationTimes;0<v;){var T=31-yn(v),O=1<<T;f[T]=0,b[T]=-1,a[T]=-1,v&=~O}}function dt(a,f){var v=a.entangledLanes|=f;for(a=a.entanglements;v;){var b=31-yn(v),T=1<<b;T&f|a[b]&f&&(a[b]|=f),v&=~T}}var mt=0;function Kt(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var an,Un,wi,Si,ni,Ai=!1,ki=[],Cr=null,ri=null,tr=null,zr=new Map,Co=new Map,xo=[],fa="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bo(a,f){switch(a){case"focusin":case"focusout":Cr=null;break;case"dragenter":case"dragleave":ri=null;break;case"mouseover":case"mouseout":tr=null;break;case"pointerover":case"pointerout":zr.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":Co.delete(f.pointerId)}}function ha(a,f,v,b,T,O){return a===null||a.nativeEvent!==O?(a={blockedOn:f,domEventName:v,eventSystemFlags:b,nativeEvent:O,targetContainers:[T]},f!==null&&(f=sd(f),f!==null&&Un(f)),a):(a.eventSystemFlags|=b,f=a.targetContainers,T!==null&&f.indexOf(T)===-1&&f.push(T),a)}function Yu(a,f,v,b,T){switch(f){case"focusin":return Cr=ha(Cr,a,f,v,b,T),!0;case"dragenter":return ri=ha(ri,a,f,v,b,T),!0;case"mouseover":return tr=ha(tr,a,f,v,b,T),!0;case"pointerover":var O=T.pointerId;return zr.set(O,ha(zr.get(O)||null,a,f,v,b,T)),!0;case"gotpointercapture":return O=T.pointerId,Co.set(O,ha(Co.get(O)||null,a,f,v,b,T)),!0}return!1}function to(a){var f=Kc(a.target);if(f!==null){var v=Le(f);if(v!==null){if(f=v.tag,f===13){if(f=ut(v),f!==null){a.blockedOn=f,ni(a.priority,function(){wi(v)});return}}else if(f===3&&v.stateNode.current.memoizedState.isDehydrated){a.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}a.blockedOn=null}function rs(a){if(a.blockedOn!==null)return!1;for(var f=a.targetContainers;0<f.length;){var v=Us(a.domEventName,a.eventSystemFlags,f[0],a.nativeEvent);if(v===null){v=a.nativeEvent;var b=new v.constructor(v.type,v);dn=b,v.target.dispatchEvent(b),dn=null}else return f=sd(v),f!==null&&Un(f),a.blockedOn=v,!1;f.shift()}return!0}function pa(a,f,v){rs(a)&&v.delete(f)}function jn(){Ai=!1,Cr!==null&&rs(Cr)&&(Cr=null),ri!==null&&rs(ri)&&(ri=null),tr!==null&&rs(tr)&&(tr=null),zr.forEach(pa),Co.forEach(pa)}function xr(a,f){a.blockedOn===f&&(a.blockedOn=null,Ai||(Ai=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,jn)))}function Ct(a){function f(T){return xr(T,a)}if(0<ki.length){xr(ki[0],a);for(var v=1;v<ki.length;v++){var b=ki[v];b.blockedOn===a&&(b.blockedOn=null)}}for(Cr!==null&&xr(Cr,a),ri!==null&&xr(ri,a),tr!==null&&xr(tr,a),zr.forEach(f),Co.forEach(f),v=0;v<xo.length;v++)b=xo[v],b.blockedOn===a&&(b.blockedOn=null);for(;0<xo.length&&(v=xo[0],v.blockedOn===null);)to(v),v.blockedOn===null&&xo.shift()}var pi=k.ReactCurrentBatchConfig,sr=!0;function gi(a,f,v,b){var T=mt,O=pi.transition;pi.transition=null;try{mt=1,ga(a,f,v,b)}finally{mt=T,pi.transition=O}}function no(a,f,v,b){var T=mt,O=pi.transition;pi.transition=null;try{mt=4,ga(a,f,v,b)}finally{mt=T,pi.transition=O}}function ga(a,f,v,b){if(sr){var T=Us(a,f,v,b);if(T===null)Tg(a,f,b,Uo,v),bo(a,b);else if(Yu(T,a,f,v,b))b.stopPropagation();else if(bo(a,b),f&4&&-1<fa.indexOf(a)){for(;T!==null;){var O=sd(T);if(O!==null&&an(O),O=Us(a,f,v,b),O===null&&Tg(a,f,b,Uo,v),O===T)break;T=O}T!==null&&b.stopPropagation()}else Tg(a,f,b,null,v)}}var Uo=null;function Us(a,f,v,b){if(Uo=null,a=Ln(b),a=Kc(a),a!==null)if(f=Le(a),f===null)a=null;else if(v=f.tag,v===13){if(a=ut(f),a!==null)return a;a=null}else if(v===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;a=null}else f!==a&&(a=null);return Uo=a,null}function za(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zt()){case Jn:return 1;case er:return 4;case ir:case Fn:return 16;case nn:return 536870912;default:return 16}default:return 16}}var Hn=null,ln=null,Hr=null;function jl(){if(Hr)return Hr;var a,f=ln,v=f.length,b,T="value"in Hn?Hn.value:Hn.textContent,O=T.length;for(a=0;a<v&&f[a]===T[a];a++);var $=v-a;for(b=1;b<=$&&f[v-b]===T[O-b];b++);return Hr=T.slice(a,1<b?1-b:void 0)}function is(a){var f=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&f===13&&(a=13)):a=f,a===10&&(a=13),32<=a||a===13?a:0}function ma(){return!0}function va(){return!1}function Zr(a){function f(v,b,T,O,$){this._reactName=v,this._targetInst=T,this.type=b,this.nativeEvent=O,this.target=$,this.currentTarget=null;for(var ue in a)a.hasOwnProperty(ue)&&(v=a[ue],this[ue]=v?v(O):O[ue]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?ma:va,this.isPropagationStopped=va,this}return ke(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=ma)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=ma)},persist:function(){},isPersistent:ma}),f}var jo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Io=Zr(jo),wo=ke({},jo,{view:0,detail:0}),Wc=Zr(wo),js,os,Vo,Vs=ke({},wo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:br,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Vo&&(Vo&&a.type==="mousemove"?(js=a.screenX-Vo.screenX,os=a.screenY-Vo.screenY):os=js=0,Vo=a),js)},movementY:function(a){return"movementY"in a?a.movementY:os}}),zc=Zr(Vs),Ha=ke({},Vs,{dataTransfer:0}),Hc=Zr(Ha),Xr=ke({},wo,{relatedTarget:0}),Er=Zr(Xr),Zc=ke({},jo,{animationName:0,elapsedTime:0,pseudoElement:0}),Qu=Zr(Zc),Vl=ke({},jo,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Za=Zr(Vl),Xa=ke({},jo,{data:0}),Go=Zr(Xa),Gs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$a={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xc(a){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(a):(a=Gl[a])?!!f[a]:!1}function br(){return Xc}var $c=ke({},wo,{key:function(a){if(a.key){var f=Gs[a.key]||a.key;if(f!=="Unidentified")return f}return a.type==="keypress"?(a=is(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?$a[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:br,charCode:function(a){return a.type==="keypress"?is(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?is(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),So=Zr($c),P=ke({},Vs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),W=Zr(P),Y=ke({},wo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:br}),re=Zr(Y),Ne=ke({},jo,{propertyName:0,elapsedTime:0,pseudoElement:0}),De=Zr(Ne),Ke=ke({},Vs,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),et=Zr(Ke),$t=[9,13,27,32],un=s&&"CompositionEvent"in window,Zt=null;s&&"documentMode"in document&&(Zt=document.documentMode);var Gn=s&&"TextEvent"in window&&!Zt,Ir=s&&(!un||Zt&&8<Zt&&11>=Zt),Ei=" ",Ti=!1;function ro(a,f){switch(a){case"keyup":return $t.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ka(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Bi=!1;function Wl(a,f){switch(a){case"compositionend":return Ka(f);case"keypress":return f.which!==32?null:(Ti=!0,Ei);case"textInput":return a=f.data,a===Ei&&Ti?null:a;default:return null}}function Cg(a,f){if(Bi)return a==="compositionend"||!un&&ro(a,f)?(a=jl(),Hr=ln=Hn=null,Bi=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return Ir&&f.locale!=="ko"?null:f.data;default:return null}}var xg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function u(a){var f=a&&a.nodeName&&a.nodeName.toLowerCase();return f==="input"?!!xg[a.type]:f==="textarea"}function m(a,f,v,b){Qe(b),f=Hf(f,"onChange"),0<f.length&&(v=new Io("onChange","change",null,v,b),a.push({event:v,listeners:f}))}var I=null,U=null;function z(a){nx(a,0)}function se(a){var f=Kl(a);if(Et(f))return a}function fe(a,f){if(a==="change")return f}var Xe=!1;if(s){var qe;if(s){var yt="oninput"in document;if(!yt){var wr=document.createElement("div");wr.setAttribute("oninput","return;"),yt=typeof wr.oninput=="function"}qe=yt}else qe=!1;Xe=qe&&(!document.documentMode||9<document.documentMode)}function Wo(){I&&(I.detachEvent("onpropertychange",zl),U=I=null)}function zl(a){if(a.propertyName==="value"&&se(U)){var f=[];m(f,U,a,Ln(a)),ti(z,f)}}function Ju(a,f,v){a==="focusin"?(Wo(),I=f,U=v,I.attachEvent("onpropertychange",zl)):a==="focusout"&&Wo()}function BR(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return se(U)}function LR(a,f){if(a==="click")return se(f)}function UR(a,f){if(a==="input"||a==="change")return se(f)}function jR(a,f){return a===f&&(a!==0||1/a===1/f)||a!==a&&f!==f}var ss=typeof Object.is=="function"?Object.is:jR;function ed(a,f){if(ss(a,f))return!0;if(typeof a!="object"||a===null||typeof f!="object"||f===null)return!1;var v=Object.keys(a),b=Object.keys(f);if(v.length!==b.length)return!1;for(b=0;b<v.length;b++){var T=v[b];if(!l.call(f,T)||!ss(a[T],f[T]))return!1}return!0}function W1(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function z1(a,f){var v=W1(a);a=0;for(var b;v;){if(v.nodeType===3){if(b=a+v.textContent.length,a<=f&&b>=f)return{node:v,offset:f-a};a=b}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=W1(v)}}function H1(a,f){return a&&f?a===f?!0:a&&a.nodeType===3?!1:f&&f.nodeType===3?H1(a,f.parentNode):"contains"in a?a.contains(f):a.compareDocumentPosition?!!(a.compareDocumentPosition(f)&16):!1:!1}function Z1(){for(var a=window,f=St();f instanceof a.HTMLIFrameElement;){try{var v=typeof f.contentWindow.location.href=="string"}catch{v=!1}if(v)a=f.contentWindow;else break;f=St(a.document)}return f}function bg(a){var f=a&&a.nodeName&&a.nodeName.toLowerCase();return f&&(f==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||f==="textarea"||a.contentEditable==="true")}function VR(a){var f=Z1(),v=a.focusedElem,b=a.selectionRange;if(f!==v&&v&&v.ownerDocument&&H1(v.ownerDocument.documentElement,v)){if(b!==null&&bg(v)){if(f=b.start,a=b.end,a===void 0&&(a=f),"selectionStart"in v)v.selectionStart=f,v.selectionEnd=Math.min(a,v.value.length);else if(a=(f=v.ownerDocument||document)&&f.defaultView||window,a.getSelection){a=a.getSelection();var T=v.textContent.length,O=Math.min(b.start,T);b=b.end===void 0?O:Math.min(b.end,T),!a.extend&&O>b&&(T=b,b=O,O=T),T=z1(v,O);var $=z1(v,b);T&&$&&(a.rangeCount!==1||a.anchorNode!==T.node||a.anchorOffset!==T.offset||a.focusNode!==$.node||a.focusOffset!==$.offset)&&(f=f.createRange(),f.setStart(T.node,T.offset),a.removeAllRanges(),O>b?(a.addRange(f),a.extend($.node,$.offset)):(f.setEnd($.node,$.offset),a.addRange(f)))}}for(f=[],a=v;a=a.parentNode;)a.nodeType===1&&f.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<f.length;v++)a=f[v],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var GR=s&&"documentMode"in document&&11>=document.documentMode,Hl=null,Ig=null,td=null,wg=!1;function X1(a,f,v){var b=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;wg||Hl==null||Hl!==St(b)||(b=Hl,"selectionStart"in b&&bg(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),td&&ed(td,b)||(td=b,b=Hf(Ig,"onSelect"),0<b.length&&(f=new Io("onSelect","select",null,f,v),a.push({event:f,listeners:b}),f.target=Hl)))}function Gf(a,f){var v={};return v[a.toLowerCase()]=f.toLowerCase(),v["Webkit"+a]="webkit"+f,v["Moz"+a]="moz"+f,v}var Zl={animationend:Gf("Animation","AnimationEnd"),animationiteration:Gf("Animation","AnimationIteration"),animationstart:Gf("Animation","AnimationStart"),transitionend:Gf("Transition","TransitionEnd")},Sg={},$1={};s&&($1=document.createElement("div").style,"AnimationEvent"in window||(delete Zl.animationend.animation,delete Zl.animationiteration.animation,delete Zl.animationstart.animation),"TransitionEvent"in window||delete Zl.transitionend.transition);function Wf(a){if(Sg[a])return Sg[a];if(!Zl[a])return a;var f=Zl[a],v;for(v in f)if(f.hasOwnProperty(v)&&v in $1)return Sg[a]=f[v];return a}var K1=Wf("animationend"),q1=Wf("animationiteration"),Y1=Wf("animationstart"),Q1=Wf("transitionend"),J1=new Map,ex="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qa(a,f){J1.set(a,f),o(f,[a])}for(var Ag=0;Ag<ex.length;Ag++){var kg=ex[Ag],WR=kg.toLowerCase(),zR=kg[0].toUpperCase()+kg.slice(1);qa(WR,"on"+zR)}qa(K1,"onAnimationEnd"),qa(q1,"onAnimationIteration"),qa(Y1,"onAnimationStart"),qa("dblclick","onDoubleClick"),qa("focusin","onFocus"),qa("focusout","onBlur"),qa(Q1,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HR=new Set("cancel close invalid load scroll toggle".split(" ").concat(nd));function tx(a,f,v){var b=a.type||"unknown-event";a.currentTarget=v,bt(b,f,void 0,a),a.currentTarget=null}function nx(a,f){f=(f&4)!==0;for(var v=0;v<a.length;v++){var b=a[v],T=b.event;b=b.listeners;e:{var O=void 0;if(f)for(var $=b.length-1;0<=$;$--){var ue=b[$],be=ue.instance,Ue=ue.currentTarget;if(ue=ue.listener,be!==O&&T.isPropagationStopped())break e;tx(T,ue,Ue),O=be}else for($=0;$<b.length;$++){if(ue=b[$],be=ue.instance,Ue=ue.currentTarget,ue=ue.listener,be!==O&&T.isPropagationStopped())break e;tx(T,ue,Ue),O=be}}}if(_t)throw a=Ot,_t=!1,Ot=null,a}function ar(a,f){var v=f[Ng];v===void 0&&(v=f[Ng]=new Set);var b=a+"__bubble";v.has(b)||(rx(f,a,2,!1),v.add(b))}function Eg(a,f,v){var b=0;f&&(b|=4),rx(v,a,b,f)}var zf="_reactListening"+Math.random().toString(36).slice(2);function rd(a){if(!a[zf]){a[zf]=!0,r.forEach(function(v){v!=="selectionchange"&&(HR.has(v)||Eg(v,!1,a),Eg(v,!0,a))});var f=a.nodeType===9?a:a.ownerDocument;f===null||f[zf]||(f[zf]=!0,Eg("selectionchange",!1,f))}}function rx(a,f,v,b){switch(za(f)){case 1:var T=gi;break;case 4:T=no;break;default:T=ga}v=T.bind(null,f,v,a),T=void 0,!ge||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(T=!0),b?T!==void 0?a.addEventListener(f,v,{capture:!0,passive:T}):a.addEventListener(f,v,!0):T!==void 0?a.addEventListener(f,v,{passive:T}):a.addEventListener(f,v,!1)}function Tg(a,f,v,b,T){var O=b;if((f&1)===0&&(f&2)===0&&b!==null)e:for(;;){if(b===null)return;var $=b.tag;if($===3||$===4){var ue=b.stateNode.containerInfo;if(ue===T||ue.nodeType===8&&ue.parentNode===T)break;if($===4)for($=b.return;$!==null;){var be=$.tag;if((be===3||be===4)&&(be=$.stateNode.containerInfo,be===T||be.nodeType===8&&be.parentNode===T))return;$=$.return}for(;ue!==null;){if($=Kc(ue),$===null)return;if(be=$.tag,be===5||be===6){b=O=$;continue e}ue=ue.parentNode}}b=b.return}ti(function(){var Ue=O,nt=Ln(v),ot=[];e:{var tt=J1.get(a);if(tt!==void 0){var Rt=Io,Bt=a;switch(a){case"keypress":if(is(v)===0)break e;case"keydown":case"keyup":Rt=So;break;case"focusin":Bt="focus",Rt=Er;break;case"focusout":Bt="blur",Rt=Er;break;case"beforeblur":case"afterblur":Rt=Er;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Rt=zc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Rt=Hc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Rt=re;break;case K1:case q1:case Y1:Rt=Qu;break;case Q1:Rt=De;break;case"scroll":Rt=Wc;break;case"wheel":Rt=et;break;case"copy":case"cut":case"paste":Rt=Za;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Rt=W}var Ut=(f&4)!==0,Mr=!Ut&&a==="scroll",Me=Ut?tt!==null?tt+"Capture":null:tt;Ut=[];for(var Se=Ue,Be;Se!==null;){Be=Se;var ft=Be.stateNode;if(Be.tag===5&&ft!==null&&(Be=ft,Me!==null&&(ft=Lr(Se,Me),ft!=null&&Ut.push(id(Se,ft,Be)))),Mr)break;Se=Se.return}0<Ut.length&&(tt=new Rt(tt,Bt,null,v,nt),ot.push({event:tt,listeners:Ut}))}}if((f&7)===0){e:{if(tt=a==="mouseover"||a==="pointerover",Rt=a==="mouseout"||a==="pointerout",tt&&v!==dn&&(Bt=v.relatedTarget||v.fromElement)&&(Kc(Bt)||Bt[ya]))break e;if((Rt||tt)&&(tt=nt.window===nt?nt:(tt=nt.ownerDocument)?tt.defaultView||tt.parentWindow:window,Rt?(Bt=v.relatedTarget||v.toElement,Rt=Ue,Bt=Bt?Kc(Bt):null,Bt!==null&&(Mr=Le(Bt),Bt!==Mr||Bt.tag!==5&&Bt.tag!==6)&&(Bt=null)):(Rt=null,Bt=Ue),Rt!==Bt)){if(Ut=zc,ft="onMouseLeave",Me="onMouseEnter",Se="mouse",(a==="pointerout"||a==="pointerover")&&(Ut=W,ft="onPointerLeave",Me="onPointerEnter",Se="pointer"),Mr=Rt==null?tt:Kl(Rt),Be=Bt==null?tt:Kl(Bt),tt=new Ut(ft,Se+"leave",Rt,v,nt),tt.target=Mr,tt.relatedTarget=Be,ft=null,Kc(nt)===Ue&&(Ut=new Ut(Me,Se+"enter",Bt,v,nt),Ut.target=Be,Ut.relatedTarget=Mr,ft=Ut),Mr=ft,Rt&&Bt)t:{for(Ut=Rt,Me=Bt,Se=0,Be=Ut;Be;Be=Xl(Be))Se++;for(Be=0,ft=Me;ft;ft=Xl(ft))Be++;for(;0<Se-Be;)Ut=Xl(Ut),Se--;for(;0<Be-Se;)Me=Xl(Me),Be--;for(;Se--;){if(Ut===Me||Me!==null&&Ut===Me.alternate)break t;Ut=Xl(Ut),Me=Xl(Me)}Ut=null}else Ut=null;Rt!==null&&ix(ot,tt,Rt,Ut,!1),Bt!==null&&Mr!==null&&ix(ot,Mr,Bt,Ut,!0)}}e:{if(tt=Ue?Kl(Ue):window,Rt=tt.nodeName&&tt.nodeName.toLowerCase(),Rt==="select"||Rt==="input"&&tt.type==="file")var jt=fe;else if(u(tt))if(Xe)jt=UR;else{jt=BR;var qt=Ju}else(Rt=tt.nodeName)&&Rt.toLowerCase()==="input"&&(tt.type==="checkbox"||tt.type==="radio")&&(jt=LR);if(jt&&(jt=jt(a,Ue))){m(ot,jt,v,nt);break e}qt&&qt(a,tt,Ue),a==="focusout"&&(qt=tt._wrapperState)&&qt.controlled&&tt.type==="number"&&Dt(tt,"number",tt.value)}switch(qt=Ue?Kl(Ue):window,a){case"focusin":(u(qt)||qt.contentEditable==="true")&&(Hl=qt,Ig=Ue,td=null);break;case"focusout":td=Ig=Hl=null;break;case"mousedown":wg=!0;break;case"contextmenu":case"mouseup":case"dragend":wg=!1,X1(ot,v,nt);break;case"selectionchange":if(GR)break;case"keydown":case"keyup":X1(ot,v,nt)}var Yt;if(un)e:{switch(a){case"compositionstart":var cn="onCompositionStart";break e;case"compositionend":cn="onCompositionEnd";break e;case"compositionupdate":cn="onCompositionUpdate";break e}cn=void 0}else Bi?ro(a,v)&&(cn="onCompositionEnd"):a==="keydown"&&v.keyCode===229&&(cn="onCompositionStart");cn&&(Ir&&v.locale!=="ko"&&(Bi||cn!=="onCompositionStart"?cn==="onCompositionEnd"&&Bi&&(Yt=jl()):(Hn=nt,ln="value"in Hn?Hn.value:Hn.textContent,Bi=!0)),qt=Hf(Ue,cn),0<qt.length&&(cn=new Go(cn,a,null,v,nt),ot.push({event:cn,listeners:qt}),Yt?cn.data=Yt:(Yt=Ka(v),Yt!==null&&(cn.data=Yt)))),(Yt=Gn?Wl(a,v):Cg(a,v))&&(Ue=Hf(Ue,"onBeforeInput"),0<Ue.length&&(nt=new Go("onBeforeInput","beforeinput",null,v,nt),ot.push({event:nt,listeners:Ue}),nt.data=Yt))}nx(ot,f)})}function id(a,f,v){return{instance:a,listener:f,currentTarget:v}}function Hf(a,f){for(var v=f+"Capture",b=[];a!==null;){var T=a,O=T.stateNode;T.tag===5&&O!==null&&(T=O,O=Lr(a,v),O!=null&&b.unshift(id(a,O,T)),O=Lr(a,f),O!=null&&b.push(id(a,O,T))),a=a.return}return b}function Xl(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function ix(a,f,v,b,T){for(var O=f._reactName,$=[];v!==null&&v!==b;){var ue=v,be=ue.alternate,Ue=ue.stateNode;if(be!==null&&be===b)break;ue.tag===5&&Ue!==null&&(ue=Ue,T?(be=Lr(v,O),be!=null&&$.unshift(id(v,be,ue))):T||(be=Lr(v,O),be!=null&&$.push(id(v,be,ue)))),v=v.return}$.length!==0&&a.push({event:f,listeners:$})}var ZR=/\r\n?/g,XR=/\u0000|\uFFFD/g;function ox(a){return(typeof a=="string"?a:""+a).replace(ZR,`
`).replace(XR,"")}function Zf(a,f,v){if(f=ox(f),ox(a)!==f&&v)throw Error(t(425))}function Xf(){}var _g=null,Rg=null;function Dg(a,f){return a==="textarea"||a==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var Pg=typeof setTimeout=="function"?setTimeout:void 0,$R=typeof clearTimeout=="function"?clearTimeout:void 0,sx=typeof Promise=="function"?Promise:void 0,KR=typeof queueMicrotask=="function"?queueMicrotask:typeof sx<"u"?function(a){return sx.resolve(null).then(a).catch(qR)}:Pg;function qR(a){setTimeout(function(){throw a})}function Mg(a,f){var v=f,b=0;do{var T=v.nextSibling;if(a.removeChild(v),T&&T.nodeType===8)if(v=T.data,v==="/$"){if(b===0){a.removeChild(T),Ct(f);return}b--}else v!=="$"&&v!=="$?"&&v!=="$!"||b++;v=T}while(v);Ct(f)}function Ya(a){for(;a!=null;a=a.nextSibling){var f=a.nodeType;if(f===1||f===3)break;if(f===8){if(f=a.data,f==="$"||f==="$!"||f==="$?")break;if(f==="/$")return null}}return a}function ax(a){a=a.previousSibling;for(var f=0;a;){if(a.nodeType===8){var v=a.data;if(v==="$"||v==="$!"||v==="$?"){if(f===0)return a;f--}else v==="/$"&&f++}a=a.previousSibling}return null}var $l=Math.random().toString(36).slice(2),Ws="__reactFiber$"+$l,od="__reactProps$"+$l,ya="__reactContainer$"+$l,Ng="__reactEvents$"+$l,YR="__reactListeners$"+$l,QR="__reactHandles$"+$l;function Kc(a){var f=a[Ws];if(f)return f;for(var v=a.parentNode;v;){if(f=v[ya]||v[Ws]){if(v=f.alternate,f.child!==null||v!==null&&v.child!==null)for(a=ax(a);a!==null;){if(v=a[Ws])return v;a=ax(a)}return f}a=v,v=a.parentNode}return null}function sd(a){return a=a[Ws]||a[ya],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function Kl(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function $f(a){return a[od]||null}var Og=[],ql=-1;function Qa(a){return{current:a}}function cr(a){0>ql||(a.current=Og[ql],Og[ql]=null,ql--)}function nr(a,f){ql++,Og[ql]=a.current,a.current=f}var Ja={},_i=Qa(Ja),io=Qa(!1),qc=Ja;function Yl(a,f){var v=a.type.contextTypes;if(!v)return Ja;var b=a.stateNode;if(b&&b.__reactInternalMemoizedUnmaskedChildContext===f)return b.__reactInternalMemoizedMaskedChildContext;var T={},O;for(O in v)T[O]=f[O];return b&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=f,a.__reactInternalMemoizedMaskedChildContext=T),T}function oo(a){return a=a.childContextTypes,a!=null}function Kf(){cr(io),cr(_i)}function cx(a,f,v){if(_i.current!==Ja)throw Error(t(168));nr(_i,f),nr(io,v)}function lx(a,f,v){var b=a.stateNode;if(f=f.childContextTypes,typeof b.getChildContext!="function")return v;b=b.getChildContext();for(var T in b)if(!(T in f))throw Error(t(108,Je(a)||"Unknown",T));return ke({},v,b)}function qf(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Ja,qc=_i.current,nr(_i,a),nr(io,io.current),!0}function ux(a,f,v){var b=a.stateNode;if(!b)throw Error(t(169));v?(a=lx(a,f,qc),b.__reactInternalMemoizedMergedChildContext=a,cr(io),cr(_i),nr(_i,a)):cr(io),nr(io,v)}var Ca=null,Yf=!1,Fg=!1;function dx(a){Ca===null?Ca=[a]:Ca.push(a)}function JR(a){Yf=!0,dx(a)}function ec(){if(!Fg&&Ca!==null){Fg=!0;var a=0,f=mt;try{var v=Ca;for(mt=1;a<v.length;a++){var b=v[a];do b=b(!0);while(b!==null)}Ca=null,Yf=!1}catch(T){throw Ca!==null&&(Ca=Ca.slice(a+1)),Ze(Jn,ec),T}finally{mt=f,Fg=!1}}return null}var Ql=[],Jl=0,Qf=null,Jf=0,zo=[],Ho=0,Yc=null,xa=1,ba="";function Qc(a,f){Ql[Jl++]=Jf,Ql[Jl++]=Qf,Qf=a,Jf=f}function fx(a,f,v){zo[Ho++]=xa,zo[Ho++]=ba,zo[Ho++]=Yc,Yc=a;var b=xa;a=ba;var T=32-yn(b)-1;b&=~(1<<T),v+=1;var O=32-yn(f)+T;if(30<O){var $=T-T%5;O=(b&(1<<$)-1).toString(32),b>>=$,T-=$,xa=1<<32-yn(f)+T|v<<T|b,ba=O+a}else xa=1<<O|v<<T|b,ba=a}function Bg(a){a.return!==null&&(Qc(a,1),fx(a,1,0))}function Lg(a){for(;a===Qf;)Qf=Ql[--Jl],Ql[Jl]=null,Jf=Ql[--Jl],Ql[Jl]=null;for(;a===Yc;)Yc=zo[--Ho],zo[Ho]=null,ba=zo[--Ho],zo[Ho]=null,xa=zo[--Ho],zo[Ho]=null}var Ao=null,ko=null,pr=!1,as=null;function hx(a,f){var v=Ko(5,null,null,0);v.elementType="DELETED",v.stateNode=f,v.return=a,f=a.deletions,f===null?(a.deletions=[v],a.flags|=16):f.push(v)}function px(a,f){switch(a.tag){case 5:var v=a.type;return f=f.nodeType!==1||v.toLowerCase()!==f.nodeName.toLowerCase()?null:f,f!==null?(a.stateNode=f,Ao=a,ko=Ya(f.firstChild),!0):!1;case 6:return f=a.pendingProps===""||f.nodeType!==3?null:f,f!==null?(a.stateNode=f,Ao=a,ko=null,!0):!1;case 13:return f=f.nodeType!==8?null:f,f!==null?(v=Yc!==null?{id:xa,overflow:ba}:null,a.memoizedState={dehydrated:f,treeContext:v,retryLane:1073741824},v=Ko(18,null,null,0),v.stateNode=f,v.return=a,a.child=v,Ao=a,ko=null,!0):!1;default:return!1}}function Ug(a){return(a.mode&1)!==0&&(a.flags&128)===0}function jg(a){if(pr){var f=ko;if(f){var v=f;if(!px(a,f)){if(Ug(a))throw Error(t(418));f=Ya(v.nextSibling);var b=Ao;f&&px(a,f)?hx(b,v):(a.flags=a.flags&-4097|2,pr=!1,Ao=a)}}else{if(Ug(a))throw Error(t(418));a.flags=a.flags&-4097|2,pr=!1,Ao=a}}}function gx(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Ao=a}function eh(a){if(a!==Ao)return!1;if(!pr)return gx(a),pr=!0,!1;var f;if((f=a.tag!==3)&&!(f=a.tag!==5)&&(f=a.type,f=f!=="head"&&f!=="body"&&!Dg(a.type,a.memoizedProps)),f&&(f=ko)){if(Ug(a))throw mx(),Error(t(418));for(;f;)hx(a,f),f=Ya(f.nextSibling)}if(gx(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,f=0;a;){if(a.nodeType===8){var v=a.data;if(v==="/$"){if(f===0){ko=Ya(a.nextSibling);break e}f--}else v!=="$"&&v!=="$!"&&v!=="$?"||f++}a=a.nextSibling}ko=null}}else ko=Ao?Ya(a.stateNode.nextSibling):null;return!0}function mx(){for(var a=ko;a;)a=Ya(a.nextSibling)}function eu(){ko=Ao=null,pr=!1}function Vg(a){as===null?as=[a]:as.push(a)}var eD=k.ReactCurrentBatchConfig;function ad(a,f,v){if(a=v.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(v._owner){if(v=v._owner,v){if(v.tag!==1)throw Error(t(309));var b=v.stateNode}if(!b)throw Error(t(147,a));var T=b,O=""+a;return f!==null&&f.ref!==null&&typeof f.ref=="function"&&f.ref._stringRef===O?f.ref:(f=function($){var ue=T.refs;$===null?delete ue[O]:ue[O]=$},f._stringRef=O,f)}if(typeof a!="string")throw Error(t(284));if(!v._owner)throw Error(t(290,a))}return a}function th(a,f){throw a=Object.prototype.toString.call(f),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":a))}function vx(a){var f=a._init;return f(a._payload)}function yx(a){function f(Me,Se){if(a){var Be=Me.deletions;Be===null?(Me.deletions=[Se],Me.flags|=16):Be.push(Se)}}function v(Me,Se){if(!a)return null;for(;Se!==null;)f(Me,Se),Se=Se.sibling;return null}function b(Me,Se){for(Me=new Map;Se!==null;)Se.key!==null?Me.set(Se.key,Se):Me.set(Se.index,Se),Se=Se.sibling;return Me}function T(Me,Se){return Me=cc(Me,Se),Me.index=0,Me.sibling=null,Me}function O(Me,Se,Be){return Me.index=Be,a?(Be=Me.alternate,Be!==null?(Be=Be.index,Be<Se?(Me.flags|=2,Se):Be):(Me.flags|=2,Se)):(Me.flags|=1048576,Se)}function $(Me){return a&&Me.alternate===null&&(Me.flags|=2),Me}function ue(Me,Se,Be,ft){return Se===null||Se.tag!==6?(Se=Pm(Be,Me.mode,ft),Se.return=Me,Se):(Se=T(Se,Be),Se.return=Me,Se)}function be(Me,Se,Be,ft){var jt=Be.type;return jt===D?nt(Me,Se,Be.props.children,ft,Be.key):Se!==null&&(Se.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Ie&&vx(jt)===Se.type)?(ft=T(Se,Be.props),ft.ref=ad(Me,Se,Be),ft.return=Me,ft):(ft=Ah(Be.type,Be.key,Be.props,null,Me.mode,ft),ft.ref=ad(Me,Se,Be),ft.return=Me,ft)}function Ue(Me,Se,Be,ft){return Se===null||Se.tag!==4||Se.stateNode.containerInfo!==Be.containerInfo||Se.stateNode.implementation!==Be.implementation?(Se=Mm(Be,Me.mode,ft),Se.return=Me,Se):(Se=T(Se,Be.children||[]),Se.return=Me,Se)}function nt(Me,Se,Be,ft,jt){return Se===null||Se.tag!==7?(Se=sl(Be,Me.mode,ft,jt),Se.return=Me,Se):(Se=T(Se,Be),Se.return=Me,Se)}function ot(Me,Se,Be){if(typeof Se=="string"&&Se!==""||typeof Se=="number")return Se=Pm(""+Se,Me.mode,Be),Se.return=Me,Se;if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case A:return Be=Ah(Se.type,Se.key,Se.props,null,Me.mode,Be),Be.ref=ad(Me,null,Se),Be.return=Me,Be;case _:return Se=Mm(Se,Me.mode,Be),Se.return=Me,Se;case Ie:var ft=Se._init;return ot(Me,ft(Se._payload),Be)}if(Ht(Se)||Ae(Se))return Se=sl(Se,Me.mode,Be,null),Se.return=Me,Se;th(Me,Se)}return null}function tt(Me,Se,Be,ft){var jt=Se!==null?Se.key:null;if(typeof Be=="string"&&Be!==""||typeof Be=="number")return jt!==null?null:ue(Me,Se,""+Be,ft);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case A:return Be.key===jt?be(Me,Se,Be,ft):null;case _:return Be.key===jt?Ue(Me,Se,Be,ft):null;case Ie:return jt=Be._init,tt(Me,Se,jt(Be._payload),ft)}if(Ht(Be)||Ae(Be))return jt!==null?null:nt(Me,Se,Be,ft,null);th(Me,Be)}return null}function Rt(Me,Se,Be,ft,jt){if(typeof ft=="string"&&ft!==""||typeof ft=="number")return Me=Me.get(Be)||null,ue(Se,Me,""+ft,jt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case A:return Me=Me.get(ft.key===null?Be:ft.key)||null,be(Se,Me,ft,jt);case _:return Me=Me.get(ft.key===null?Be:ft.key)||null,Ue(Se,Me,ft,jt);case Ie:var qt=ft._init;return Rt(Me,Se,Be,qt(ft._payload),jt)}if(Ht(ft)||Ae(ft))return Me=Me.get(Be)||null,nt(Se,Me,ft,jt,null);th(Se,ft)}return null}function Bt(Me,Se,Be,ft){for(var jt=null,qt=null,Yt=Se,cn=Se=0,si=null;Yt!==null&&cn<Be.length;cn++){Yt.index>cn?(si=Yt,Yt=null):si=Yt.sibling;var Bn=tt(Me,Yt,Be[cn],ft);if(Bn===null){Yt===null&&(Yt=si);break}a&&Yt&&Bn.alternate===null&&f(Me,Yt),Se=O(Bn,Se,cn),qt===null?jt=Bn:qt.sibling=Bn,qt=Bn,Yt=si}if(cn===Be.length)return v(Me,Yt),pr&&Qc(Me,cn),jt;if(Yt===null){for(;cn<Be.length;cn++)Yt=ot(Me,Be[cn],ft),Yt!==null&&(Se=O(Yt,Se,cn),qt===null?jt=Yt:qt.sibling=Yt,qt=Yt);return pr&&Qc(Me,cn),jt}for(Yt=b(Me,Yt);cn<Be.length;cn++)si=Rt(Yt,Me,cn,Be[cn],ft),si!==null&&(a&&si.alternate!==null&&Yt.delete(si.key===null?cn:si.key),Se=O(si,Se,cn),qt===null?jt=si:qt.sibling=si,qt=si);return a&&Yt.forEach(function(lc){return f(Me,lc)}),pr&&Qc(Me,cn),jt}function Ut(Me,Se,Be,ft){var jt=Ae(Be);if(typeof jt!="function")throw Error(t(150));if(Be=jt.call(Be),Be==null)throw Error(t(151));for(var qt=jt=null,Yt=Se,cn=Se=0,si=null,Bn=Be.next();Yt!==null&&!Bn.done;cn++,Bn=Be.next()){Yt.index>cn?(si=Yt,Yt=null):si=Yt.sibling;var lc=tt(Me,Yt,Bn.value,ft);if(lc===null){Yt===null&&(Yt=si);break}a&&Yt&&lc.alternate===null&&f(Me,Yt),Se=O(lc,Se,cn),qt===null?jt=lc:qt.sibling=lc,qt=lc,Yt=si}if(Bn.done)return v(Me,Yt),pr&&Qc(Me,cn),jt;if(Yt===null){for(;!Bn.done;cn++,Bn=Be.next())Bn=ot(Me,Bn.value,ft),Bn!==null&&(Se=O(Bn,Se,cn),qt===null?jt=Bn:qt.sibling=Bn,qt=Bn);return pr&&Qc(Me,cn),jt}for(Yt=b(Me,Yt);!Bn.done;cn++,Bn=Be.next())Bn=Rt(Yt,Me,cn,Bn.value,ft),Bn!==null&&(a&&Bn.alternate!==null&&Yt.delete(Bn.key===null?cn:Bn.key),Se=O(Bn,Se,cn),qt===null?jt=Bn:qt.sibling=Bn,qt=Bn);return a&&Yt.forEach(function(MD){return f(Me,MD)}),pr&&Qc(Me,cn),jt}function Mr(Me,Se,Be,ft){if(typeof Be=="object"&&Be!==null&&Be.type===D&&Be.key===null&&(Be=Be.props.children),typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case A:e:{for(var jt=Be.key,qt=Se;qt!==null;){if(qt.key===jt){if(jt=Be.type,jt===D){if(qt.tag===7){v(Me,qt.sibling),Se=T(qt,Be.props.children),Se.return=Me,Me=Se;break e}}else if(qt.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Ie&&vx(jt)===qt.type){v(Me,qt.sibling),Se=T(qt,Be.props),Se.ref=ad(Me,qt,Be),Se.return=Me,Me=Se;break e}v(Me,qt);break}else f(Me,qt);qt=qt.sibling}Be.type===D?(Se=sl(Be.props.children,Me.mode,ft,Be.key),Se.return=Me,Me=Se):(ft=Ah(Be.type,Be.key,Be.props,null,Me.mode,ft),ft.ref=ad(Me,Se,Be),ft.return=Me,Me=ft)}return $(Me);case _:e:{for(qt=Be.key;Se!==null;){if(Se.key===qt)if(Se.tag===4&&Se.stateNode.containerInfo===Be.containerInfo&&Se.stateNode.implementation===Be.implementation){v(Me,Se.sibling),Se=T(Se,Be.children||[]),Se.return=Me,Me=Se;break e}else{v(Me,Se);break}else f(Me,Se);Se=Se.sibling}Se=Mm(Be,Me.mode,ft),Se.return=Me,Me=Se}return $(Me);case Ie:return qt=Be._init,Mr(Me,Se,qt(Be._payload),ft)}if(Ht(Be))return Bt(Me,Se,Be,ft);if(Ae(Be))return Ut(Me,Se,Be,ft);th(Me,Be)}return typeof Be=="string"&&Be!==""||typeof Be=="number"?(Be=""+Be,Se!==null&&Se.tag===6?(v(Me,Se.sibling),Se=T(Se,Be),Se.return=Me,Me=Se):(v(Me,Se),Se=Pm(Be,Me.mode,ft),Se.return=Me,Me=Se),$(Me)):v(Me,Se)}return Mr}var tu=yx(!0),Cx=yx(!1),nh=Qa(null),rh=null,nu=null,Gg=null;function Wg(){Gg=nu=rh=null}function zg(a){var f=nh.current;cr(nh),a._currentValue=f}function Hg(a,f,v){for(;a!==null;){var b=a.alternate;if((a.childLanes&f)!==f?(a.childLanes|=f,b!==null&&(b.childLanes|=f)):b!==null&&(b.childLanes&f)!==f&&(b.childLanes|=f),a===v)break;a=a.return}}function ru(a,f){rh=a,Gg=nu=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&f)!==0&&(so=!0),a.firstContext=null)}function Zo(a){var f=a._currentValue;if(Gg!==a)if(a={context:a,memoizedValue:f,next:null},nu===null){if(rh===null)throw Error(t(308));nu=a,rh.dependencies={lanes:0,firstContext:a}}else nu=nu.next=a;return f}var Jc=null;function Zg(a){Jc===null?Jc=[a]:Jc.push(a)}function xx(a,f,v,b){var T=f.interleaved;return T===null?(v.next=v,Zg(f)):(v.next=T.next,T.next=v),f.interleaved=v,Ia(a,b)}function Ia(a,f){a.lanes|=f;var v=a.alternate;for(v!==null&&(v.lanes|=f),v=a,a=a.return;a!==null;)a.childLanes|=f,v=a.alternate,v!==null&&(v.childLanes|=f),v=a,a=a.return;return v.tag===3?v.stateNode:null}var tc=!1;function Xg(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bx(a,f){a=a.updateQueue,f.updateQueue===a&&(f.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function wa(a,f){return{eventTime:a,lane:f,tag:0,payload:null,callback:null,next:null}}function nc(a,f,v){var b=a.updateQueue;if(b===null)return null;if(b=b.shared,(Dn&2)!==0){var T=b.pending;return T===null?f.next=f:(f.next=T.next,T.next=f),b.pending=f,Ia(a,v)}return T=b.interleaved,T===null?(f.next=f,Zg(b)):(f.next=T.next,T.next=f),b.interleaved=f,Ia(a,v)}function ih(a,f,v){if(f=f.updateQueue,f!==null&&(f=f.shared,(v&4194240)!==0)){var b=f.lanes;b&=a.pendingLanes,v|=b,f.lanes=v,dt(a,v)}}function Ix(a,f){var v=a.updateQueue,b=a.alternate;if(b!==null&&(b=b.updateQueue,v===b)){var T=null,O=null;if(v=v.firstBaseUpdate,v!==null){do{var $={eventTime:v.eventTime,lane:v.lane,tag:v.tag,payload:v.payload,callback:v.callback,next:null};O===null?T=O=$:O=O.next=$,v=v.next}while(v!==null);O===null?T=O=f:O=O.next=f}else T=O=f;v={baseState:b.baseState,firstBaseUpdate:T,lastBaseUpdate:O,shared:b.shared,effects:b.effects},a.updateQueue=v;return}a=v.lastBaseUpdate,a===null?v.firstBaseUpdate=f:a.next=f,v.lastBaseUpdate=f}function oh(a,f,v,b){var T=a.updateQueue;tc=!1;var O=T.firstBaseUpdate,$=T.lastBaseUpdate,ue=T.shared.pending;if(ue!==null){T.shared.pending=null;var be=ue,Ue=be.next;be.next=null,$===null?O=Ue:$.next=Ue,$=be;var nt=a.alternate;nt!==null&&(nt=nt.updateQueue,ue=nt.lastBaseUpdate,ue!==$&&(ue===null?nt.firstBaseUpdate=Ue:ue.next=Ue,nt.lastBaseUpdate=be))}if(O!==null){var ot=T.baseState;$=0,nt=Ue=be=null,ue=O;do{var tt=ue.lane,Rt=ue.eventTime;if((b&tt)===tt){nt!==null&&(nt=nt.next={eventTime:Rt,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var Bt=a,Ut=ue;switch(tt=f,Rt=v,Ut.tag){case 1:if(Bt=Ut.payload,typeof Bt=="function"){ot=Bt.call(Rt,ot,tt);break e}ot=Bt;break e;case 3:Bt.flags=Bt.flags&-65537|128;case 0:if(Bt=Ut.payload,tt=typeof Bt=="function"?Bt.call(Rt,ot,tt):Bt,tt==null)break e;ot=ke({},ot,tt);break e;case 2:tc=!0}}ue.callback!==null&&ue.lane!==0&&(a.flags|=64,tt=T.effects,tt===null?T.effects=[ue]:tt.push(ue))}else Rt={eventTime:Rt,lane:tt,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},nt===null?(Ue=nt=Rt,be=ot):nt=nt.next=Rt,$|=tt;if(ue=ue.next,ue===null){if(ue=T.shared.pending,ue===null)break;tt=ue,ue=tt.next,tt.next=null,T.lastBaseUpdate=tt,T.shared.pending=null}}while(!0);if(nt===null&&(be=ot),T.baseState=be,T.firstBaseUpdate=Ue,T.lastBaseUpdate=nt,f=T.shared.interleaved,f!==null){T=f;do $|=T.lane,T=T.next;while(T!==f)}else O===null&&(T.shared.lanes=0);nl|=$,a.lanes=$,a.memoizedState=ot}}function wx(a,f,v){if(a=f.effects,f.effects=null,a!==null)for(f=0;f<a.length;f++){var b=a[f],T=b.callback;if(T!==null){if(b.callback=null,b=v,typeof T!="function")throw Error(t(191,T));T.call(b)}}}var cd={},zs=Qa(cd),ld=Qa(cd),ud=Qa(cd);function el(a){if(a===cd)throw Error(t(174));return a}function $g(a,f){switch(nr(ud,f),nr(ld,a),nr(zs,cd),a=f.nodeType,a){case 9:case 11:f=(f=f.documentElement)?f.namespaceURI:q(null,"");break;default:a=a===8?f.parentNode:f,f=a.namespaceURI||null,a=a.tagName,f=q(f,a)}cr(zs),nr(zs,f)}function iu(){cr(zs),cr(ld),cr(ud)}function Sx(a){el(ud.current);var f=el(zs.current),v=q(f,a.type);f!==v&&(nr(ld,a),nr(zs,v))}function Kg(a){ld.current===a&&(cr(zs),cr(ld))}var Sr=Qa(0);function sh(a){for(var f=a;f!==null;){if(f.tag===13){var v=f.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||v.data==="$?"||v.data==="$!"))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===a)break;for(;f.sibling===null;){if(f.return===null||f.return===a)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var qg=[];function Yg(){for(var a=0;a<qg.length;a++)qg[a]._workInProgressVersionPrimary=null;qg.length=0}var ah=k.ReactCurrentDispatcher,Qg=k.ReactCurrentBatchConfig,tl=0,Ar=null,$r=null,ii=null,ch=!1,dd=!1,fd=0,tD=0;function Ri(){throw Error(t(321))}function Jg(a,f){if(f===null)return!1;for(var v=0;v<f.length&&v<a.length;v++)if(!ss(a[v],f[v]))return!1;return!0}function em(a,f,v,b,T,O){if(tl=O,Ar=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,ah.current=a===null||a.memoizedState===null?oD:sD,a=v(b,T),dd){O=0;do{if(dd=!1,fd=0,25<=O)throw Error(t(301));O+=1,ii=$r=null,f.updateQueue=null,ah.current=aD,a=v(b,T)}while(dd)}if(ah.current=dh,f=$r!==null&&$r.next!==null,tl=0,ii=$r=Ar=null,ch=!1,f)throw Error(t(300));return a}function tm(){var a=fd!==0;return fd=0,a}function Hs(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ii===null?Ar.memoizedState=ii=a:ii=ii.next=a,ii}function Xo(){if($r===null){var a=Ar.alternate;a=a!==null?a.memoizedState:null}else a=$r.next;var f=ii===null?Ar.memoizedState:ii.next;if(f!==null)ii=f,$r=a;else{if(a===null)throw Error(t(310));$r=a,a={memoizedState:$r.memoizedState,baseState:$r.baseState,baseQueue:$r.baseQueue,queue:$r.queue,next:null},ii===null?Ar.memoizedState=ii=a:ii=ii.next=a}return ii}function hd(a,f){return typeof f=="function"?f(a):f}function nm(a){var f=Xo(),v=f.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=a;var b=$r,T=b.baseQueue,O=v.pending;if(O!==null){if(T!==null){var $=T.next;T.next=O.next,O.next=$}b.baseQueue=T=O,v.pending=null}if(T!==null){O=T.next,b=b.baseState;var ue=$=null,be=null,Ue=O;do{var nt=Ue.lane;if((tl&nt)===nt)be!==null&&(be=be.next={lane:0,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null}),b=Ue.hasEagerState?Ue.eagerState:a(b,Ue.action);else{var ot={lane:nt,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null};be===null?(ue=be=ot,$=b):be=be.next=ot,Ar.lanes|=nt,nl|=nt}Ue=Ue.next}while(Ue!==null&&Ue!==O);be===null?$=b:be.next=ue,ss(b,f.memoizedState)||(so=!0),f.memoizedState=b,f.baseState=$,f.baseQueue=be,v.lastRenderedState=b}if(a=v.interleaved,a!==null){T=a;do O=T.lane,Ar.lanes|=O,nl|=O,T=T.next;while(T!==a)}else T===null&&(v.lanes=0);return[f.memoizedState,v.dispatch]}function rm(a){var f=Xo(),v=f.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=a;var b=v.dispatch,T=v.pending,O=f.memoizedState;if(T!==null){v.pending=null;var $=T=T.next;do O=a(O,$.action),$=$.next;while($!==T);ss(O,f.memoizedState)||(so=!0),f.memoizedState=O,f.baseQueue===null&&(f.baseState=O),v.lastRenderedState=O}return[O,b]}function Ax(){}function kx(a,f){var v=Ar,b=Xo(),T=f(),O=!ss(b.memoizedState,T);if(O&&(b.memoizedState=T,so=!0),b=b.queue,im(_x.bind(null,v,b,a),[a]),b.getSnapshot!==f||O||ii!==null&&ii.memoizedState.tag&1){if(v.flags|=2048,pd(9,Tx.bind(null,v,b,T,f),void 0,null),oi===null)throw Error(t(349));(tl&30)!==0||Ex(v,f,T)}return T}function Ex(a,f,v){a.flags|=16384,a={getSnapshot:f,value:v},f=Ar.updateQueue,f===null?(f={lastEffect:null,stores:null},Ar.updateQueue=f,f.stores=[a]):(v=f.stores,v===null?f.stores=[a]:v.push(a))}function Tx(a,f,v,b){f.value=v,f.getSnapshot=b,Rx(f)&&Dx(a)}function _x(a,f,v){return v(function(){Rx(f)&&Dx(a)})}function Rx(a){var f=a.getSnapshot;a=a.value;try{var v=f();return!ss(a,v)}catch{return!0}}function Dx(a){var f=Ia(a,1);f!==null&&ds(f,a,1,-1)}function Px(a){var f=Hs();return typeof a=="function"&&(a=a()),f.memoizedState=f.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hd,lastRenderedState:a},f.queue=a,a=a.dispatch=iD.bind(null,Ar,a),[f.memoizedState,a]}function pd(a,f,v,b){return a={tag:a,create:f,destroy:v,deps:b,next:null},f=Ar.updateQueue,f===null?(f={lastEffect:null,stores:null},Ar.updateQueue=f,f.lastEffect=a.next=a):(v=f.lastEffect,v===null?f.lastEffect=a.next=a:(b=v.next,v.next=a,a.next=b,f.lastEffect=a)),a}function Mx(){return Xo().memoizedState}function lh(a,f,v,b){var T=Hs();Ar.flags|=a,T.memoizedState=pd(1|f,v,void 0,b===void 0?null:b)}function uh(a,f,v,b){var T=Xo();b=b===void 0?null:b;var O=void 0;if($r!==null){var $=$r.memoizedState;if(O=$.destroy,b!==null&&Jg(b,$.deps)){T.memoizedState=pd(f,v,O,b);return}}Ar.flags|=a,T.memoizedState=pd(1|f,v,O,b)}function Nx(a,f){return lh(8390656,8,a,f)}function im(a,f){return uh(2048,8,a,f)}function Ox(a,f){return uh(4,2,a,f)}function Fx(a,f){return uh(4,4,a,f)}function Bx(a,f){if(typeof f=="function")return a=a(),f(a),function(){f(null)};if(f!=null)return a=a(),f.current=a,function(){f.current=null}}function Lx(a,f,v){return v=v!=null?v.concat([a]):null,uh(4,4,Bx.bind(null,f,a),v)}function om(){}function Ux(a,f){var v=Xo();f=f===void 0?null:f;var b=v.memoizedState;return b!==null&&f!==null&&Jg(f,b[1])?b[0]:(v.memoizedState=[a,f],a)}function jx(a,f){var v=Xo();f=f===void 0?null:f;var b=v.memoizedState;return b!==null&&f!==null&&Jg(f,b[1])?b[0]:(a=a(),v.memoizedState=[a,f],a)}function Vx(a,f,v){return(tl&21)===0?(a.baseState&&(a.baseState=!1,so=!0),a.memoizedState=v):(ss(v,f)||(v=ie(),Ar.lanes|=v,nl|=v,a.baseState=!0),f)}function nD(a,f){var v=mt;mt=v!==0&&4>v?v:4,a(!0);var b=Qg.transition;Qg.transition={};try{a(!1),f()}finally{mt=v,Qg.transition=b}}function Gx(){return Xo().memoizedState}function rD(a,f,v){var b=sc(a);if(v={lane:b,action:v,hasEagerState:!1,eagerState:null,next:null},Wx(a))zx(f,v);else if(v=xx(a,f,v,b),v!==null){var T=Ui();ds(v,a,b,T),Hx(v,f,b)}}function iD(a,f,v){var b=sc(a),T={lane:b,action:v,hasEagerState:!1,eagerState:null,next:null};if(Wx(a))zx(f,T);else{var O=a.alternate;if(a.lanes===0&&(O===null||O.lanes===0)&&(O=f.lastRenderedReducer,O!==null))try{var $=f.lastRenderedState,ue=O($,v);if(T.hasEagerState=!0,T.eagerState=ue,ss(ue,$)){var be=f.interleaved;be===null?(T.next=T,Zg(f)):(T.next=be.next,be.next=T),f.interleaved=T;return}}catch{}finally{}v=xx(a,f,T,b),v!==null&&(T=Ui(),ds(v,a,b,T),Hx(v,f,b))}}function Wx(a){var f=a.alternate;return a===Ar||f!==null&&f===Ar}function zx(a,f){dd=ch=!0;var v=a.pending;v===null?f.next=f:(f.next=v.next,v.next=f),a.pending=f}function Hx(a,f,v){if((v&4194240)!==0){var b=f.lanes;b&=a.pendingLanes,v|=b,f.lanes=v,dt(a,v)}}var dh={readContext:Zo,useCallback:Ri,useContext:Ri,useEffect:Ri,useImperativeHandle:Ri,useInsertionEffect:Ri,useLayoutEffect:Ri,useMemo:Ri,useReducer:Ri,useRef:Ri,useState:Ri,useDebugValue:Ri,useDeferredValue:Ri,useTransition:Ri,useMutableSource:Ri,useSyncExternalStore:Ri,useId:Ri,unstable_isNewReconciler:!1},oD={readContext:Zo,useCallback:function(a,f){return Hs().memoizedState=[a,f===void 0?null:f],a},useContext:Zo,useEffect:Nx,useImperativeHandle:function(a,f,v){return v=v!=null?v.concat([a]):null,lh(4194308,4,Bx.bind(null,f,a),v)},useLayoutEffect:function(a,f){return lh(4194308,4,a,f)},useInsertionEffect:function(a,f){return lh(4,2,a,f)},useMemo:function(a,f){var v=Hs();return f=f===void 0?null:f,a=a(),v.memoizedState=[a,f],a},useReducer:function(a,f,v){var b=Hs();return f=v!==void 0?v(f):f,b.memoizedState=b.baseState=f,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:f},b.queue=a,a=a.dispatch=rD.bind(null,Ar,a),[b.memoizedState,a]},useRef:function(a){var f=Hs();return a={current:a},f.memoizedState=a},useState:Px,useDebugValue:om,useDeferredValue:function(a){return Hs().memoizedState=a},useTransition:function(){var a=Px(!1),f=a[0];return a=nD.bind(null,a[1]),Hs().memoizedState=a,[f,a]},useMutableSource:function(){},useSyncExternalStore:function(a,f,v){var b=Ar,T=Hs();if(pr){if(v===void 0)throw Error(t(407));v=v()}else{if(v=f(),oi===null)throw Error(t(349));(tl&30)!==0||Ex(b,f,v)}T.memoizedState=v;var O={value:v,getSnapshot:f};return T.queue=O,Nx(_x.bind(null,b,O,a),[a]),b.flags|=2048,pd(9,Tx.bind(null,b,O,v,f),void 0,null),v},useId:function(){var a=Hs(),f=oi.identifierPrefix;if(pr){var v=ba,b=xa;v=(b&~(1<<32-yn(b)-1)).toString(32)+v,f=":"+f+"R"+v,v=fd++,0<v&&(f+="H"+v.toString(32)),f+=":"}else v=tD++,f=":"+f+"r"+v.toString(32)+":";return a.memoizedState=f},unstable_isNewReconciler:!1},sD={readContext:Zo,useCallback:Ux,useContext:Zo,useEffect:im,useImperativeHandle:Lx,useInsertionEffect:Ox,useLayoutEffect:Fx,useMemo:jx,useReducer:nm,useRef:Mx,useState:function(){return nm(hd)},useDebugValue:om,useDeferredValue:function(a){var f=Xo();return Vx(f,$r.memoizedState,a)},useTransition:function(){var a=nm(hd)[0],f=Xo().memoizedState;return[a,f]},useMutableSource:Ax,useSyncExternalStore:kx,useId:Gx,unstable_isNewReconciler:!1},aD={readContext:Zo,useCallback:Ux,useContext:Zo,useEffect:im,useImperativeHandle:Lx,useInsertionEffect:Ox,useLayoutEffect:Fx,useMemo:jx,useReducer:rm,useRef:Mx,useState:function(){return rm(hd)},useDebugValue:om,useDeferredValue:function(a){var f=Xo();return $r===null?f.memoizedState=a:Vx(f,$r.memoizedState,a)},useTransition:function(){var a=rm(hd)[0],f=Xo().memoizedState;return[a,f]},useMutableSource:Ax,useSyncExternalStore:kx,useId:Gx,unstable_isNewReconciler:!1};function cs(a,f){if(a&&a.defaultProps){f=ke({},f),a=a.defaultProps;for(var v in a)f[v]===void 0&&(f[v]=a[v]);return f}return f}function sm(a,f,v,b){f=a.memoizedState,v=v(b,f),v=v==null?f:ke({},f,v),a.memoizedState=v,a.lanes===0&&(a.updateQueue.baseState=v)}var fh={isMounted:function(a){return(a=a._reactInternals)?Le(a)===a:!1},enqueueSetState:function(a,f,v){a=a._reactInternals;var b=Ui(),T=sc(a),O=wa(b,T);O.payload=f,v!=null&&(O.callback=v),f=nc(a,O,T),f!==null&&(ds(f,a,T,b),ih(f,a,T))},enqueueReplaceState:function(a,f,v){a=a._reactInternals;var b=Ui(),T=sc(a),O=wa(b,T);O.tag=1,O.payload=f,v!=null&&(O.callback=v),f=nc(a,O,T),f!==null&&(ds(f,a,T,b),ih(f,a,T))},enqueueForceUpdate:function(a,f){a=a._reactInternals;var v=Ui(),b=sc(a),T=wa(v,b);T.tag=2,f!=null&&(T.callback=f),f=nc(a,T,b),f!==null&&(ds(f,a,b,v),ih(f,a,b))}};function Zx(a,f,v,b,T,O,$){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(b,O,$):f.prototype&&f.prototype.isPureReactComponent?!ed(v,b)||!ed(T,O):!0}function Xx(a,f,v){var b=!1,T=Ja,O=f.contextType;return typeof O=="object"&&O!==null?O=Zo(O):(T=oo(f)?qc:_i.current,b=f.contextTypes,O=(b=b!=null)?Yl(a,T):Ja),f=new f(v,O),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=fh,a.stateNode=f,f._reactInternals=a,b&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=T,a.__reactInternalMemoizedMaskedChildContext=O),f}function $x(a,f,v,b){a=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(v,b),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(v,b),f.state!==a&&fh.enqueueReplaceState(f,f.state,null)}function am(a,f,v,b){var T=a.stateNode;T.props=v,T.state=a.memoizedState,T.refs={},Xg(a);var O=f.contextType;typeof O=="object"&&O!==null?T.context=Zo(O):(O=oo(f)?qc:_i.current,T.context=Yl(a,O)),T.state=a.memoizedState,O=f.getDerivedStateFromProps,typeof O=="function"&&(sm(a,f,O,v),T.state=a.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(f=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),f!==T.state&&fh.enqueueReplaceState(T,T.state,null),oh(a,v,T,b),T.state=a.memoizedState),typeof T.componentDidMount=="function"&&(a.flags|=4194308)}function ou(a,f){try{var v="",b=f;do v+=Ee(b),b=b.return;while(b);var T=v}catch(O){T=`
Error generating stack: `+O.message+`
`+O.stack}return{value:a,source:f,stack:T,digest:null}}function cm(a,f,v){return{value:a,source:null,stack:v??null,digest:f??null}}function lm(a,f){try{console.error(f.value)}catch(v){setTimeout(function(){throw v})}}var cD=typeof WeakMap=="function"?WeakMap:Map;function Kx(a,f,v){v=wa(-1,v),v.tag=3,v.payload={element:null};var b=f.value;return v.callback=function(){Ch||(Ch=!0,Sm=b),lm(a,f)},v}function qx(a,f,v){v=wa(-1,v),v.tag=3;var b=a.type.getDerivedStateFromError;if(typeof b=="function"){var T=f.value;v.payload=function(){return b(T)},v.callback=function(){lm(a,f)}}var O=a.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(v.callback=function(){lm(a,f),typeof b!="function"&&(ic===null?ic=new Set([this]):ic.add(this));var $=f.stack;this.componentDidCatch(f.value,{componentStack:$!==null?$:""})}),v}function Yx(a,f,v){var b=a.pingCache;if(b===null){b=a.pingCache=new cD;var T=new Set;b.set(f,T)}else T=b.get(f),T===void 0&&(T=new Set,b.set(f,T));T.has(v)||(T.add(v),a=ID.bind(null,a,f,v),f.then(a,a))}function Qx(a){do{var f;if((f=a.tag===13)&&(f=a.memoizedState,f=f!==null?f.dehydrated!==null:!0),f)return a;a=a.return}while(a!==null);return null}function Jx(a,f,v,b,T){return(a.mode&1)===0?(a===f?a.flags|=65536:(a.flags|=128,v.flags|=131072,v.flags&=-52805,v.tag===1&&(v.alternate===null?v.tag=17:(f=wa(-1,1),f.tag=2,nc(v,f,1))),v.lanes|=1),a):(a.flags|=65536,a.lanes=T,a)}var lD=k.ReactCurrentOwner,so=!1;function Li(a,f,v,b){f.child=a===null?Cx(f,null,v,b):tu(f,a.child,v,b)}function eb(a,f,v,b,T){v=v.render;var O=f.ref;return ru(f,T),b=em(a,f,v,b,O,T),v=tm(),a!==null&&!so?(f.updateQueue=a.updateQueue,f.flags&=-2053,a.lanes&=~T,Sa(a,f,T)):(pr&&v&&Bg(f),f.flags|=1,Li(a,f,b,T),f.child)}function tb(a,f,v,b,T){if(a===null){var O=v.type;return typeof O=="function"&&!Dm(O)&&O.defaultProps===void 0&&v.compare===null&&v.defaultProps===void 0?(f.tag=15,f.type=O,nb(a,f,O,b,T)):(a=Ah(v.type,null,b,f,f.mode,T),a.ref=f.ref,a.return=f,f.child=a)}if(O=a.child,(a.lanes&T)===0){var $=O.memoizedProps;if(v=v.compare,v=v!==null?v:ed,v($,b)&&a.ref===f.ref)return Sa(a,f,T)}return f.flags|=1,a=cc(O,b),a.ref=f.ref,a.return=f,f.child=a}function nb(a,f,v,b,T){if(a!==null){var O=a.memoizedProps;if(ed(O,b)&&a.ref===f.ref)if(so=!1,f.pendingProps=b=O,(a.lanes&T)!==0)(a.flags&131072)!==0&&(so=!0);else return f.lanes=a.lanes,Sa(a,f,T)}return um(a,f,v,b,T)}function rb(a,f,v){var b=f.pendingProps,T=b.children,O=a!==null?a.memoizedState:null;if(b.mode==="hidden")if((f.mode&1)===0)f.memoizedState={baseLanes:0,cachePool:null,transitions:null},nr(au,Eo),Eo|=v;else{if((v&1073741824)===0)return a=O!==null?O.baseLanes|v:v,f.lanes=f.childLanes=1073741824,f.memoizedState={baseLanes:a,cachePool:null,transitions:null},f.updateQueue=null,nr(au,Eo),Eo|=a,null;f.memoizedState={baseLanes:0,cachePool:null,transitions:null},b=O!==null?O.baseLanes:v,nr(au,Eo),Eo|=b}else O!==null?(b=O.baseLanes|v,f.memoizedState=null):b=v,nr(au,Eo),Eo|=b;return Li(a,f,T,v),f.child}function ib(a,f){var v=f.ref;(a===null&&v!==null||a!==null&&a.ref!==v)&&(f.flags|=512,f.flags|=2097152)}function um(a,f,v,b,T){var O=oo(v)?qc:_i.current;return O=Yl(f,O),ru(f,T),v=em(a,f,v,b,O,T),b=tm(),a!==null&&!so?(f.updateQueue=a.updateQueue,f.flags&=-2053,a.lanes&=~T,Sa(a,f,T)):(pr&&b&&Bg(f),f.flags|=1,Li(a,f,v,T),f.child)}function ob(a,f,v,b,T){if(oo(v)){var O=!0;qf(f)}else O=!1;if(ru(f,T),f.stateNode===null)ph(a,f),Xx(f,v,b),am(f,v,b,T),b=!0;else if(a===null){var $=f.stateNode,ue=f.memoizedProps;$.props=ue;var be=$.context,Ue=v.contextType;typeof Ue=="object"&&Ue!==null?Ue=Zo(Ue):(Ue=oo(v)?qc:_i.current,Ue=Yl(f,Ue));var nt=v.getDerivedStateFromProps,ot=typeof nt=="function"||typeof $.getSnapshotBeforeUpdate=="function";ot||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ue!==b||be!==Ue)&&$x(f,$,b,Ue),tc=!1;var tt=f.memoizedState;$.state=tt,oh(f,b,$,T),be=f.memoizedState,ue!==b||tt!==be||io.current||tc?(typeof nt=="function"&&(sm(f,v,nt,b),be=f.memoizedState),(ue=tc||Zx(f,v,ue,b,tt,be,Ue))?(ot||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(f.flags|=4194308)):(typeof $.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=b,f.memoizedState=be),$.props=b,$.state=be,$.context=Ue,b=ue):(typeof $.componentDidMount=="function"&&(f.flags|=4194308),b=!1)}else{$=f.stateNode,bx(a,f),ue=f.memoizedProps,Ue=f.type===f.elementType?ue:cs(f.type,ue),$.props=Ue,ot=f.pendingProps,tt=$.context,be=v.contextType,typeof be=="object"&&be!==null?be=Zo(be):(be=oo(v)?qc:_i.current,be=Yl(f,be));var Rt=v.getDerivedStateFromProps;(nt=typeof Rt=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ue!==ot||tt!==be)&&$x(f,$,b,be),tc=!1,tt=f.memoizedState,$.state=tt,oh(f,b,$,T);var Bt=f.memoizedState;ue!==ot||tt!==Bt||io.current||tc?(typeof Rt=="function"&&(sm(f,v,Rt,b),Bt=f.memoizedState),(Ue=tc||Zx(f,v,Ue,b,tt,Bt,be)||!1)?(nt||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(b,Bt,be),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(b,Bt,be)),typeof $.componentDidUpdate=="function"&&(f.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof $.componentDidUpdate!="function"||ue===a.memoizedProps&&tt===a.memoizedState||(f.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ue===a.memoizedProps&&tt===a.memoizedState||(f.flags|=1024),f.memoizedProps=b,f.memoizedState=Bt),$.props=b,$.state=Bt,$.context=be,b=Ue):(typeof $.componentDidUpdate!="function"||ue===a.memoizedProps&&tt===a.memoizedState||(f.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ue===a.memoizedProps&&tt===a.memoizedState||(f.flags|=1024),b=!1)}return dm(a,f,v,b,O,T)}function dm(a,f,v,b,T,O){ib(a,f);var $=(f.flags&128)!==0;if(!b&&!$)return T&&ux(f,v,!1),Sa(a,f,O);b=f.stateNode,lD.current=f;var ue=$&&typeof v.getDerivedStateFromError!="function"?null:b.render();return f.flags|=1,a!==null&&$?(f.child=tu(f,a.child,null,O),f.child=tu(f,null,ue,O)):Li(a,f,ue,O),f.memoizedState=b.state,T&&ux(f,v,!0),f.child}function sb(a){var f=a.stateNode;f.pendingContext?cx(a,f.pendingContext,f.pendingContext!==f.context):f.context&&cx(a,f.context,!1),$g(a,f.containerInfo)}function ab(a,f,v,b,T){return eu(),Vg(T),f.flags|=256,Li(a,f,v,b),f.child}var fm={dehydrated:null,treeContext:null,retryLane:0};function hm(a){return{baseLanes:a,cachePool:null,transitions:null}}function cb(a,f,v){var b=f.pendingProps,T=Sr.current,O=!1,$=(f.flags&128)!==0,ue;if((ue=$)||(ue=a!==null&&a.memoizedState===null?!1:(T&2)!==0),ue?(O=!0,f.flags&=-129):(a===null||a.memoizedState!==null)&&(T|=1),nr(Sr,T&1),a===null)return jg(f),a=f.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((f.mode&1)===0?f.lanes=1:a.data==="$!"?f.lanes=8:f.lanes=1073741824,null):($=b.children,a=b.fallback,O?(b=f.mode,O=f.child,$={mode:"hidden",children:$},(b&1)===0&&O!==null?(O.childLanes=0,O.pendingProps=$):O=kh($,b,0,null),a=sl(a,b,v,null),O.return=f,a.return=f,O.sibling=a,f.child=O,f.child.memoizedState=hm(v),f.memoizedState=fm,a):pm(f,$));if(T=a.memoizedState,T!==null&&(ue=T.dehydrated,ue!==null))return uD(a,f,$,b,ue,T,v);if(O){O=b.fallback,$=f.mode,T=a.child,ue=T.sibling;var be={mode:"hidden",children:b.children};return($&1)===0&&f.child!==T?(b=f.child,b.childLanes=0,b.pendingProps=be,f.deletions=null):(b=cc(T,be),b.subtreeFlags=T.subtreeFlags&14680064),ue!==null?O=cc(ue,O):(O=sl(O,$,v,null),O.flags|=2),O.return=f,b.return=f,b.sibling=O,f.child=b,b=O,O=f.child,$=a.child.memoizedState,$=$===null?hm(v):{baseLanes:$.baseLanes|v,cachePool:null,transitions:$.transitions},O.memoizedState=$,O.childLanes=a.childLanes&~v,f.memoizedState=fm,b}return O=a.child,a=O.sibling,b=cc(O,{mode:"visible",children:b.children}),(f.mode&1)===0&&(b.lanes=v),b.return=f,b.sibling=null,a!==null&&(v=f.deletions,v===null?(f.deletions=[a],f.flags|=16):v.push(a)),f.child=b,f.memoizedState=null,b}function pm(a,f){return f=kh({mode:"visible",children:f},a.mode,0,null),f.return=a,a.child=f}function hh(a,f,v,b){return b!==null&&Vg(b),tu(f,a.child,null,v),a=pm(f,f.pendingProps.children),a.flags|=2,f.memoizedState=null,a}function uD(a,f,v,b,T,O,$){if(v)return f.flags&256?(f.flags&=-257,b=cm(Error(t(422))),hh(a,f,$,b)):f.memoizedState!==null?(f.child=a.child,f.flags|=128,null):(O=b.fallback,T=f.mode,b=kh({mode:"visible",children:b.children},T,0,null),O=sl(O,T,$,null),O.flags|=2,b.return=f,O.return=f,b.sibling=O,f.child=b,(f.mode&1)!==0&&tu(f,a.child,null,$),f.child.memoizedState=hm($),f.memoizedState=fm,O);if((f.mode&1)===0)return hh(a,f,$,null);if(T.data==="$!"){if(b=T.nextSibling&&T.nextSibling.dataset,b)var ue=b.dgst;return b=ue,O=Error(t(419)),b=cm(O,b,void 0),hh(a,f,$,b)}if(ue=($&a.childLanes)!==0,so||ue){if(b=oi,b!==null){switch($&-$){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(b.suspendedLanes|$))!==0?0:T,T!==0&&T!==O.retryLane&&(O.retryLane=T,Ia(a,T),ds(b,a,T,-1))}return Rm(),b=cm(Error(t(421))),hh(a,f,$,b)}return T.data==="$?"?(f.flags|=128,f.child=a.child,f=wD.bind(null,a),T._reactRetry=f,null):(a=O.treeContext,ko=Ya(T.nextSibling),Ao=f,pr=!0,as=null,a!==null&&(zo[Ho++]=xa,zo[Ho++]=ba,zo[Ho++]=Yc,xa=a.id,ba=a.overflow,Yc=f),f=pm(f,b.children),f.flags|=4096,f)}function lb(a,f,v){a.lanes|=f;var b=a.alternate;b!==null&&(b.lanes|=f),Hg(a.return,f,v)}function gm(a,f,v,b,T){var O=a.memoizedState;O===null?a.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:b,tail:v,tailMode:T}:(O.isBackwards=f,O.rendering=null,O.renderingStartTime=0,O.last=b,O.tail=v,O.tailMode=T)}function ub(a,f,v){var b=f.pendingProps,T=b.revealOrder,O=b.tail;if(Li(a,f,b.children,v),b=Sr.current,(b&2)!==0)b=b&1|2,f.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=f.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&lb(a,v,f);else if(a.tag===19)lb(a,v,f);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===f)break e;for(;a.sibling===null;){if(a.return===null||a.return===f)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}b&=1}if(nr(Sr,b),(f.mode&1)===0)f.memoizedState=null;else switch(T){case"forwards":for(v=f.child,T=null;v!==null;)a=v.alternate,a!==null&&sh(a)===null&&(T=v),v=v.sibling;v=T,v===null?(T=f.child,f.child=null):(T=v.sibling,v.sibling=null),gm(f,!1,T,v,O);break;case"backwards":for(v=null,T=f.child,f.child=null;T!==null;){if(a=T.alternate,a!==null&&sh(a)===null){f.child=T;break}a=T.sibling,T.sibling=v,v=T,T=a}gm(f,!0,v,null,O);break;case"together":gm(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function ph(a,f){(f.mode&1)===0&&a!==null&&(a.alternate=null,f.alternate=null,f.flags|=2)}function Sa(a,f,v){if(a!==null&&(f.dependencies=a.dependencies),nl|=f.lanes,(v&f.childLanes)===0)return null;if(a!==null&&f.child!==a.child)throw Error(t(153));if(f.child!==null){for(a=f.child,v=cc(a,a.pendingProps),f.child=v,v.return=f;a.sibling!==null;)a=a.sibling,v=v.sibling=cc(a,a.pendingProps),v.return=f;v.sibling=null}return f.child}function dD(a,f,v){switch(f.tag){case 3:sb(f),eu();break;case 5:Sx(f);break;case 1:oo(f.type)&&qf(f);break;case 4:$g(f,f.stateNode.containerInfo);break;case 10:var b=f.type._context,T=f.memoizedProps.value;nr(nh,b._currentValue),b._currentValue=T;break;case 13:if(b=f.memoizedState,b!==null)return b.dehydrated!==null?(nr(Sr,Sr.current&1),f.flags|=128,null):(v&f.child.childLanes)!==0?cb(a,f,v):(nr(Sr,Sr.current&1),a=Sa(a,f,v),a!==null?a.sibling:null);nr(Sr,Sr.current&1);break;case 19:if(b=(v&f.childLanes)!==0,(a.flags&128)!==0){if(b)return ub(a,f,v);f.flags|=128}if(T=f.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),nr(Sr,Sr.current),b)break;return null;case 22:case 23:return f.lanes=0,rb(a,f,v)}return Sa(a,f,v)}var db,mm,fb,hb;db=function(a,f){for(var v=f.child;v!==null;){if(v.tag===5||v.tag===6)a.appendChild(v.stateNode);else if(v.tag!==4&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},mm=function(){},fb=function(a,f,v,b){var T=a.memoizedProps;if(T!==b){a=f.stateNode,el(zs.current);var O=null;switch(v){case"input":T=Pt(a,T),b=Pt(a,b),O=[];break;case"select":T=ke({},T,{value:void 0}),b=ke({},b,{value:void 0}),O=[];break;case"textarea":T=ct(a,T),b=ct(a,b),O=[];break;default:typeof T.onClick!="function"&&typeof b.onClick=="function"&&(a.onclick=Xf)}pn(v,b);var $;v=null;for(Ue in T)if(!b.hasOwnProperty(Ue)&&T.hasOwnProperty(Ue)&&T[Ue]!=null)if(Ue==="style"){var ue=T[Ue];for($ in ue)ue.hasOwnProperty($)&&(v||(v={}),v[$]="")}else Ue!=="dangerouslySetInnerHTML"&&Ue!=="children"&&Ue!=="suppressContentEditableWarning"&&Ue!=="suppressHydrationWarning"&&Ue!=="autoFocus"&&(i.hasOwnProperty(Ue)?O||(O=[]):(O=O||[]).push(Ue,null));for(Ue in b){var be=b[Ue];if(ue=T!=null?T[Ue]:void 0,b.hasOwnProperty(Ue)&&be!==ue&&(be!=null||ue!=null))if(Ue==="style")if(ue){for($ in ue)!ue.hasOwnProperty($)||be&&be.hasOwnProperty($)||(v||(v={}),v[$]="");for($ in be)be.hasOwnProperty($)&&ue[$]!==be[$]&&(v||(v={}),v[$]=be[$])}else v||(O||(O=[]),O.push(Ue,v)),v=be;else Ue==="dangerouslySetInnerHTML"?(be=be?be.__html:void 0,ue=ue?ue.__html:void 0,be!=null&&ue!==be&&(O=O||[]).push(Ue,be)):Ue==="children"?typeof be!="string"&&typeof be!="number"||(O=O||[]).push(Ue,""+be):Ue!=="suppressContentEditableWarning"&&Ue!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ue)?(be!=null&&Ue==="onScroll"&&ar("scroll",a),O||ue===be||(O=[])):(O=O||[]).push(Ue,be))}v&&(O=O||[]).push("style",v);var Ue=O;(f.updateQueue=Ue)&&(f.flags|=4)}},hb=function(a,f,v,b){v!==b&&(f.flags|=4)};function gd(a,f){if(!pr)switch(a.tailMode){case"hidden":f=a.tail;for(var v=null;f!==null;)f.alternate!==null&&(v=f),f=f.sibling;v===null?a.tail=null:v.sibling=null;break;case"collapsed":v=a.tail;for(var b=null;v!==null;)v.alternate!==null&&(b=v),v=v.sibling;b===null?f||a.tail===null?a.tail=null:a.tail.sibling=null:b.sibling=null}}function Di(a){var f=a.alternate!==null&&a.alternate.child===a.child,v=0,b=0;if(f)for(var T=a.child;T!==null;)v|=T.lanes|T.childLanes,b|=T.subtreeFlags&14680064,b|=T.flags&14680064,T.return=a,T=T.sibling;else for(T=a.child;T!==null;)v|=T.lanes|T.childLanes,b|=T.subtreeFlags,b|=T.flags,T.return=a,T=T.sibling;return a.subtreeFlags|=b,a.childLanes=v,f}function fD(a,f,v){var b=f.pendingProps;switch(Lg(f),f.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Di(f),null;case 1:return oo(f.type)&&Kf(),Di(f),null;case 3:return b=f.stateNode,iu(),cr(io),cr(_i),Yg(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(a===null||a.child===null)&&(eh(f)?f.flags|=4:a===null||a.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,as!==null&&(Em(as),as=null))),mm(a,f),Di(f),null;case 5:Kg(f);var T=el(ud.current);if(v=f.type,a!==null&&f.stateNode!=null)fb(a,f,v,b,T),a.ref!==f.ref&&(f.flags|=512,f.flags|=2097152);else{if(!b){if(f.stateNode===null)throw Error(t(166));return Di(f),null}if(a=el(zs.current),eh(f)){b=f.stateNode,v=f.type;var O=f.memoizedProps;switch(b[Ws]=f,b[od]=O,a=(f.mode&1)!==0,v){case"dialog":ar("cancel",b),ar("close",b);break;case"iframe":case"object":case"embed":ar("load",b);break;case"video":case"audio":for(T=0;T<nd.length;T++)ar(nd[T],b);break;case"source":ar("error",b);break;case"img":case"image":case"link":ar("error",b),ar("load",b);break;case"details":ar("toggle",b);break;case"input":at(b,O),ar("invalid",b);break;case"select":b._wrapperState={wasMultiple:!!O.multiple},ar("invalid",b);break;case"textarea":ce(b,O),ar("invalid",b)}pn(v,O),T=null;for(var $ in O)if(O.hasOwnProperty($)){var ue=O[$];$==="children"?typeof ue=="string"?b.textContent!==ue&&(O.suppressHydrationWarning!==!0&&Zf(b.textContent,ue,a),T=["children",ue]):typeof ue=="number"&&b.textContent!==""+ue&&(O.suppressHydrationWarning!==!0&&Zf(b.textContent,ue,a),T=["children",""+ue]):i.hasOwnProperty($)&&ue!=null&&$==="onScroll"&&ar("scroll",b)}switch(v){case"input":Xt(b),Vt(b,O,!0);break;case"textarea":Xt(b),mn(b);break;case"select":case"option":break;default:typeof O.onClick=="function"&&(b.onclick=Xf)}b=T,f.updateQueue=b,b!==null&&(f.flags|=4)}else{$=T.nodeType===9?T:T.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Vn(v)),a==="http://www.w3.org/1999/xhtml"?v==="script"?(a=$.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof b.is=="string"?a=$.createElement(v,{is:b.is}):(a=$.createElement(v),v==="select"&&($=a,b.multiple?$.multiple=!0:b.size&&($.size=b.size))):a=$.createElementNS(a,v),a[Ws]=f,a[od]=b,db(a,f,!1,!1),f.stateNode=a;e:{switch($=xn(v,b),v){case"dialog":ar("cancel",a),ar("close",a),T=b;break;case"iframe":case"object":case"embed":ar("load",a),T=b;break;case"video":case"audio":for(T=0;T<nd.length;T++)ar(nd[T],a);T=b;break;case"source":ar("error",a),T=b;break;case"img":case"image":case"link":ar("error",a),ar("load",a),T=b;break;case"details":ar("toggle",a),T=b;break;case"input":at(a,b),T=Pt(a,b),ar("invalid",a);break;case"option":T=b;break;case"select":a._wrapperState={wasMultiple:!!b.multiple},T=ke({},b,{value:void 0}),ar("invalid",a);break;case"textarea":ce(a,b),T=ct(a,b),ar("invalid",a);break;default:T=b}pn(v,T),ue=T;for(O in ue)if(ue.hasOwnProperty(O)){var be=ue[O];O==="style"?Lt(a,be):O==="dangerouslySetInnerHTML"?(be=be?be.__html:void 0,be!=null&&L(a,be)):O==="children"?typeof be=="string"?(v!=="textarea"||be!=="")&&ne(a,be):typeof be=="number"&&ne(a,""+be):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(i.hasOwnProperty(O)?be!=null&&O==="onScroll"&&ar("scroll",a):be!=null&&R(a,O,be,$))}switch(v){case"input":Xt(a),Vt(a,b,!1);break;case"textarea":Xt(a),mn(a);break;case"option":b.value!=null&&a.setAttribute("value",""+me(b.value));break;case"select":a.multiple=!!b.multiple,O=b.value,O!=null?sn(a,!!b.multiple,O,!1):b.defaultValue!=null&&sn(a,!!b.multiple,b.defaultValue,!0);break;default:typeof T.onClick=="function"&&(a.onclick=Xf)}switch(v){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}}b&&(f.flags|=4)}f.ref!==null&&(f.flags|=512,f.flags|=2097152)}return Di(f),null;case 6:if(a&&f.stateNode!=null)hb(a,f,a.memoizedProps,b);else{if(typeof b!="string"&&f.stateNode===null)throw Error(t(166));if(v=el(ud.current),el(zs.current),eh(f)){if(b=f.stateNode,v=f.memoizedProps,b[Ws]=f,(O=b.nodeValue!==v)&&(a=Ao,a!==null))switch(a.tag){case 3:Zf(b.nodeValue,v,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Zf(b.nodeValue,v,(a.mode&1)!==0)}O&&(f.flags|=4)}else b=(v.nodeType===9?v:v.ownerDocument).createTextNode(b),b[Ws]=f,f.stateNode=b}return Di(f),null;case 13:if(cr(Sr),b=f.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(pr&&ko!==null&&(f.mode&1)!==0&&(f.flags&128)===0)mx(),eu(),f.flags|=98560,O=!1;else if(O=eh(f),b!==null&&b.dehydrated!==null){if(a===null){if(!O)throw Error(t(318));if(O=f.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(t(317));O[Ws]=f}else eu(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Di(f),O=!1}else as!==null&&(Em(as),as=null),O=!0;if(!O)return f.flags&65536?f:null}return(f.flags&128)!==0?(f.lanes=v,f):(b=b!==null,b!==(a!==null&&a.memoizedState!==null)&&b&&(f.child.flags|=8192,(f.mode&1)!==0&&(a===null||(Sr.current&1)!==0?Kr===0&&(Kr=3):Rm())),f.updateQueue!==null&&(f.flags|=4),Di(f),null);case 4:return iu(),mm(a,f),a===null&&rd(f.stateNode.containerInfo),Di(f),null;case 10:return zg(f.type._context),Di(f),null;case 17:return oo(f.type)&&Kf(),Di(f),null;case 19:if(cr(Sr),O=f.memoizedState,O===null)return Di(f),null;if(b=(f.flags&128)!==0,$=O.rendering,$===null)if(b)gd(O,!1);else{if(Kr!==0||a!==null&&(a.flags&128)!==0)for(a=f.child;a!==null;){if($=sh(a),$!==null){for(f.flags|=128,gd(O,!1),b=$.updateQueue,b!==null&&(f.updateQueue=b,f.flags|=4),f.subtreeFlags=0,b=v,v=f.child;v!==null;)O=v,a=b,O.flags&=14680066,$=O.alternate,$===null?(O.childLanes=0,O.lanes=a,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=$.childLanes,O.lanes=$.lanes,O.child=$.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=$.memoizedProps,O.memoizedState=$.memoizedState,O.updateQueue=$.updateQueue,O.type=$.type,a=$.dependencies,O.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),v=v.sibling;return nr(Sr,Sr.current&1|2),f.child}a=a.sibling}O.tail!==null&&wt()>cu&&(f.flags|=128,b=!0,gd(O,!1),f.lanes=4194304)}else{if(!b)if(a=sh($),a!==null){if(f.flags|=128,b=!0,v=a.updateQueue,v!==null&&(f.updateQueue=v,f.flags|=4),gd(O,!0),O.tail===null&&O.tailMode==="hidden"&&!$.alternate&&!pr)return Di(f),null}else 2*wt()-O.renderingStartTime>cu&&v!==1073741824&&(f.flags|=128,b=!0,gd(O,!1),f.lanes=4194304);O.isBackwards?($.sibling=f.child,f.child=$):(v=O.last,v!==null?v.sibling=$:f.child=$,O.last=$)}return O.tail!==null?(f=O.tail,O.rendering=f,O.tail=f.sibling,O.renderingStartTime=wt(),f.sibling=null,v=Sr.current,nr(Sr,b?v&1|2:v&1),f):(Di(f),null);case 22:case 23:return _m(),b=f.memoizedState!==null,a!==null&&a.memoizedState!==null!==b&&(f.flags|=8192),b&&(f.mode&1)!==0?(Eo&1073741824)!==0&&(Di(f),f.subtreeFlags&6&&(f.flags|=8192)):Di(f),null;case 24:return null;case 25:return null}throw Error(t(156,f.tag))}function hD(a,f){switch(Lg(f),f.tag){case 1:return oo(f.type)&&Kf(),a=f.flags,a&65536?(f.flags=a&-65537|128,f):null;case 3:return iu(),cr(io),cr(_i),Yg(),a=f.flags,(a&65536)!==0&&(a&128)===0?(f.flags=a&-65537|128,f):null;case 5:return Kg(f),null;case 13:if(cr(Sr),a=f.memoizedState,a!==null&&a.dehydrated!==null){if(f.alternate===null)throw Error(t(340));eu()}return a=f.flags,a&65536?(f.flags=a&-65537|128,f):null;case 19:return cr(Sr),null;case 4:return iu(),null;case 10:return zg(f.type._context),null;case 22:case 23:return _m(),null;case 24:return null;default:return null}}var gh=!1,Pi=!1,pD=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function su(a,f){var v=a.ref;if(v!==null)if(typeof v=="function")try{v(null)}catch(b){Tr(a,f,b)}else v.current=null}function vm(a,f,v){try{v()}catch(b){Tr(a,f,b)}}var pb=!1;function gD(a,f){if(_g=sr,a=Z1(),bg(a)){if("selectionStart"in a)var v={start:a.selectionStart,end:a.selectionEnd};else e:{v=(v=a.ownerDocument)&&v.defaultView||window;var b=v.getSelection&&v.getSelection();if(b&&b.rangeCount!==0){v=b.anchorNode;var T=b.anchorOffset,O=b.focusNode;b=b.focusOffset;try{v.nodeType,O.nodeType}catch{v=null;break e}var $=0,ue=-1,be=-1,Ue=0,nt=0,ot=a,tt=null;t:for(;;){for(var Rt;ot!==v||T!==0&&ot.nodeType!==3||(ue=$+T),ot!==O||b!==0&&ot.nodeType!==3||(be=$+b),ot.nodeType===3&&($+=ot.nodeValue.length),(Rt=ot.firstChild)!==null;)tt=ot,ot=Rt;for(;;){if(ot===a)break t;if(tt===v&&++Ue===T&&(ue=$),tt===O&&++nt===b&&(be=$),(Rt=ot.nextSibling)!==null)break;ot=tt,tt=ot.parentNode}ot=Rt}v=ue===-1||be===-1?null:{start:ue,end:be}}else v=null}v=v||{start:0,end:0}}else v=null;for(Rg={focusedElem:a,selectionRange:v},sr=!1,Mt=f;Mt!==null;)if(f=Mt,a=f.child,(f.subtreeFlags&1028)!==0&&a!==null)a.return=f,Mt=a;else for(;Mt!==null;){f=Mt;try{var Bt=f.alternate;if((f.flags&1024)!==0)switch(f.tag){case 0:case 11:case 15:break;case 1:if(Bt!==null){var Ut=Bt.memoizedProps,Mr=Bt.memoizedState,Me=f.stateNode,Se=Me.getSnapshotBeforeUpdate(f.elementType===f.type?Ut:cs(f.type,Ut),Mr);Me.__reactInternalSnapshotBeforeUpdate=Se}break;case 3:var Be=f.stateNode.containerInfo;Be.nodeType===1?Be.textContent="":Be.nodeType===9&&Be.documentElement&&Be.removeChild(Be.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ft){Tr(f,f.return,ft)}if(a=f.sibling,a!==null){a.return=f.return,Mt=a;break}Mt=f.return}return Bt=pb,pb=!1,Bt}function md(a,f,v){var b=f.updateQueue;if(b=b!==null?b.lastEffect:null,b!==null){var T=b=b.next;do{if((T.tag&a)===a){var O=T.destroy;T.destroy=void 0,O!==void 0&&vm(f,v,O)}T=T.next}while(T!==b)}}function mh(a,f){if(f=f.updateQueue,f=f!==null?f.lastEffect:null,f!==null){var v=f=f.next;do{if((v.tag&a)===a){var b=v.create;v.destroy=b()}v=v.next}while(v!==f)}}function ym(a){var f=a.ref;if(f!==null){var v=a.stateNode;switch(a.tag){case 5:a=v;break;default:a=v}typeof f=="function"?f(a):f.current=a}}function gb(a){var f=a.alternate;f!==null&&(a.alternate=null,gb(f)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(f=a.stateNode,f!==null&&(delete f[Ws],delete f[od],delete f[Ng],delete f[YR],delete f[QR])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function mb(a){return a.tag===5||a.tag===3||a.tag===4}function vb(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||mb(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Cm(a,f,v){var b=a.tag;if(b===5||b===6)a=a.stateNode,f?v.nodeType===8?v.parentNode.insertBefore(a,f):v.insertBefore(a,f):(v.nodeType===8?(f=v.parentNode,f.insertBefore(a,v)):(f=v,f.appendChild(a)),v=v._reactRootContainer,v!=null||f.onclick!==null||(f.onclick=Xf));else if(b!==4&&(a=a.child,a!==null))for(Cm(a,f,v),a=a.sibling;a!==null;)Cm(a,f,v),a=a.sibling}function xm(a,f,v){var b=a.tag;if(b===5||b===6)a=a.stateNode,f?v.insertBefore(a,f):v.appendChild(a);else if(b!==4&&(a=a.child,a!==null))for(xm(a,f,v),a=a.sibling;a!==null;)xm(a,f,v),a=a.sibling}var mi=null,ls=!1;function rc(a,f,v){for(v=v.child;v!==null;)yb(a,f,v),v=v.sibling}function yb(a,f,v){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(vn,v)}catch{}switch(v.tag){case 5:Pi||su(v,f);case 6:var b=mi,T=ls;mi=null,rc(a,f,v),mi=b,ls=T,mi!==null&&(ls?(a=mi,v=v.stateNode,a.nodeType===8?a.parentNode.removeChild(v):a.removeChild(v)):mi.removeChild(v.stateNode));break;case 18:mi!==null&&(ls?(a=mi,v=v.stateNode,a.nodeType===8?Mg(a.parentNode,v):a.nodeType===1&&Mg(a,v),Ct(a)):Mg(mi,v.stateNode));break;case 4:b=mi,T=ls,mi=v.stateNode.containerInfo,ls=!0,rc(a,f,v),mi=b,ls=T;break;case 0:case 11:case 14:case 15:if(!Pi&&(b=v.updateQueue,b!==null&&(b=b.lastEffect,b!==null))){T=b=b.next;do{var O=T,$=O.destroy;O=O.tag,$!==void 0&&((O&2)!==0||(O&4)!==0)&&vm(v,f,$),T=T.next}while(T!==b)}rc(a,f,v);break;case 1:if(!Pi&&(su(v,f),b=v.stateNode,typeof b.componentWillUnmount=="function"))try{b.props=v.memoizedProps,b.state=v.memoizedState,b.componentWillUnmount()}catch(ue){Tr(v,f,ue)}rc(a,f,v);break;case 21:rc(a,f,v);break;case 22:v.mode&1?(Pi=(b=Pi)||v.memoizedState!==null,rc(a,f,v),Pi=b):rc(a,f,v);break;default:rc(a,f,v)}}function Cb(a){var f=a.updateQueue;if(f!==null){a.updateQueue=null;var v=a.stateNode;v===null&&(v=a.stateNode=new pD),f.forEach(function(b){var T=SD.bind(null,a,b);v.has(b)||(v.add(b),b.then(T,T))})}}function us(a,f){var v=f.deletions;if(v!==null)for(var b=0;b<v.length;b++){var T=v[b];try{var O=a,$=f,ue=$;e:for(;ue!==null;){switch(ue.tag){case 5:mi=ue.stateNode,ls=!1;break e;case 3:mi=ue.stateNode.containerInfo,ls=!0;break e;case 4:mi=ue.stateNode.containerInfo,ls=!0;break e}ue=ue.return}if(mi===null)throw Error(t(160));yb(O,$,T),mi=null,ls=!1;var be=T.alternate;be!==null&&(be.return=null),T.return=null}catch(Ue){Tr(T,f,Ue)}}if(f.subtreeFlags&12854)for(f=f.child;f!==null;)xb(f,a),f=f.sibling}function xb(a,f){var v=a.alternate,b=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(us(f,a),Zs(a),b&4){try{md(3,a,a.return),mh(3,a)}catch(Ut){Tr(a,a.return,Ut)}try{md(5,a,a.return)}catch(Ut){Tr(a,a.return,Ut)}}break;case 1:us(f,a),Zs(a),b&512&&v!==null&&su(v,v.return);break;case 5:if(us(f,a),Zs(a),b&512&&v!==null&&su(v,v.return),a.flags&32){var T=a.stateNode;try{ne(T,"")}catch(Ut){Tr(a,a.return,Ut)}}if(b&4&&(T=a.stateNode,T!=null)){var O=a.memoizedProps,$=v!==null?v.memoizedProps:O,ue=a.type,be=a.updateQueue;if(a.updateQueue=null,be!==null)try{ue==="input"&&O.type==="radio"&&O.name!=null&&lt(T,O),xn(ue,$);var Ue=xn(ue,O);for($=0;$<be.length;$+=2){var nt=be[$],ot=be[$+1];nt==="style"?Lt(T,ot):nt==="dangerouslySetInnerHTML"?L(T,ot):nt==="children"?ne(T,ot):R(T,nt,ot,Ue)}switch(ue){case"input":Gt(T,O);break;case"textarea":rn(T,O);break;case"select":var tt=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!O.multiple;var Rt=O.value;Rt!=null?sn(T,!!O.multiple,Rt,!1):tt!==!!O.multiple&&(O.defaultValue!=null?sn(T,!!O.multiple,O.defaultValue,!0):sn(T,!!O.multiple,O.multiple?[]:"",!1))}T[od]=O}catch(Ut){Tr(a,a.return,Ut)}}break;case 6:if(us(f,a),Zs(a),b&4){if(a.stateNode===null)throw Error(t(162));T=a.stateNode,O=a.memoizedProps;try{T.nodeValue=O}catch(Ut){Tr(a,a.return,Ut)}}break;case 3:if(us(f,a),Zs(a),b&4&&v!==null&&v.memoizedState.isDehydrated)try{Ct(f.containerInfo)}catch(Ut){Tr(a,a.return,Ut)}break;case 4:us(f,a),Zs(a);break;case 13:us(f,a),Zs(a),T=a.child,T.flags&8192&&(O=T.memoizedState!==null,T.stateNode.isHidden=O,!O||T.alternate!==null&&T.alternate.memoizedState!==null||(wm=wt())),b&4&&Cb(a);break;case 22:if(nt=v!==null&&v.memoizedState!==null,a.mode&1?(Pi=(Ue=Pi)||nt,us(f,a),Pi=Ue):us(f,a),Zs(a),b&8192){if(Ue=a.memoizedState!==null,(a.stateNode.isHidden=Ue)&&!nt&&(a.mode&1)!==0)for(Mt=a,nt=a.child;nt!==null;){for(ot=Mt=nt;Mt!==null;){switch(tt=Mt,Rt=tt.child,tt.tag){case 0:case 11:case 14:case 15:md(4,tt,tt.return);break;case 1:su(tt,tt.return);var Bt=tt.stateNode;if(typeof Bt.componentWillUnmount=="function"){b=tt,v=tt.return;try{f=b,Bt.props=f.memoizedProps,Bt.state=f.memoizedState,Bt.componentWillUnmount()}catch(Ut){Tr(b,v,Ut)}}break;case 5:su(tt,tt.return);break;case 22:if(tt.memoizedState!==null){wb(ot);continue}}Rt!==null?(Rt.return=tt,Mt=Rt):wb(ot)}nt=nt.sibling}e:for(nt=null,ot=a;;){if(ot.tag===5){if(nt===null){nt=ot;try{T=ot.stateNode,Ue?(O=T.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none"):(ue=ot.stateNode,be=ot.memoizedProps.style,$=be!=null&&be.hasOwnProperty("display")?be.display:null,ue.style.display=Ve("display",$))}catch(Ut){Tr(a,a.return,Ut)}}}else if(ot.tag===6){if(nt===null)try{ot.stateNode.nodeValue=Ue?"":ot.memoizedProps}catch(Ut){Tr(a,a.return,Ut)}}else if((ot.tag!==22&&ot.tag!==23||ot.memoizedState===null||ot===a)&&ot.child!==null){ot.child.return=ot,ot=ot.child;continue}if(ot===a)break e;for(;ot.sibling===null;){if(ot.return===null||ot.return===a)break e;nt===ot&&(nt=null),ot=ot.return}nt===ot&&(nt=null),ot.sibling.return=ot.return,ot=ot.sibling}}break;case 19:us(f,a),Zs(a),b&4&&Cb(a);break;case 21:break;default:us(f,a),Zs(a)}}function Zs(a){var f=a.flags;if(f&2){try{e:{for(var v=a.return;v!==null;){if(mb(v)){var b=v;break e}v=v.return}throw Error(t(160))}switch(b.tag){case 5:var T=b.stateNode;b.flags&32&&(ne(T,""),b.flags&=-33);var O=vb(a);xm(a,O,T);break;case 3:case 4:var $=b.stateNode.containerInfo,ue=vb(a);Cm(a,ue,$);break;default:throw Error(t(161))}}catch(be){Tr(a,a.return,be)}a.flags&=-3}f&4096&&(a.flags&=-4097)}function mD(a,f,v){Mt=a,bb(a)}function bb(a,f,v){for(var b=(a.mode&1)!==0;Mt!==null;){var T=Mt,O=T.child;if(T.tag===22&&b){var $=T.memoizedState!==null||gh;if(!$){var ue=T.alternate,be=ue!==null&&ue.memoizedState!==null||Pi;ue=gh;var Ue=Pi;if(gh=$,(Pi=be)&&!Ue)for(Mt=T;Mt!==null;)$=Mt,be=$.child,$.tag===22&&$.memoizedState!==null?Sb(T):be!==null?(be.return=$,Mt=be):Sb(T);for(;O!==null;)Mt=O,bb(O),O=O.sibling;Mt=T,gh=ue,Pi=Ue}Ib(a)}else(T.subtreeFlags&8772)!==0&&O!==null?(O.return=T,Mt=O):Ib(a)}}function Ib(a){for(;Mt!==null;){var f=Mt;if((f.flags&8772)!==0){var v=f.alternate;try{if((f.flags&8772)!==0)switch(f.tag){case 0:case 11:case 15:Pi||mh(5,f);break;case 1:var b=f.stateNode;if(f.flags&4&&!Pi)if(v===null)b.componentDidMount();else{var T=f.elementType===f.type?v.memoizedProps:cs(f.type,v.memoizedProps);b.componentDidUpdate(T,v.memoizedState,b.__reactInternalSnapshotBeforeUpdate)}var O=f.updateQueue;O!==null&&wx(f,O,b);break;case 3:var $=f.updateQueue;if($!==null){if(v=null,f.child!==null)switch(f.child.tag){case 5:v=f.child.stateNode;break;case 1:v=f.child.stateNode}wx(f,$,v)}break;case 5:var ue=f.stateNode;if(v===null&&f.flags&4){v=ue;var be=f.memoizedProps;switch(f.type){case"button":case"input":case"select":case"textarea":be.autoFocus&&v.focus();break;case"img":be.src&&(v.src=be.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(f.memoizedState===null){var Ue=f.alternate;if(Ue!==null){var nt=Ue.memoizedState;if(nt!==null){var ot=nt.dehydrated;ot!==null&&Ct(ot)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Pi||f.flags&512&&ym(f)}catch(tt){Tr(f,f.return,tt)}}if(f===a){Mt=null;break}if(v=f.sibling,v!==null){v.return=f.return,Mt=v;break}Mt=f.return}}function wb(a){for(;Mt!==null;){var f=Mt;if(f===a){Mt=null;break}var v=f.sibling;if(v!==null){v.return=f.return,Mt=v;break}Mt=f.return}}function Sb(a){for(;Mt!==null;){var f=Mt;try{switch(f.tag){case 0:case 11:case 15:var v=f.return;try{mh(4,f)}catch(be){Tr(f,v,be)}break;case 1:var b=f.stateNode;if(typeof b.componentDidMount=="function"){var T=f.return;try{b.componentDidMount()}catch(be){Tr(f,T,be)}}var O=f.return;try{ym(f)}catch(be){Tr(f,O,be)}break;case 5:var $=f.return;try{ym(f)}catch(be){Tr(f,$,be)}}}catch(be){Tr(f,f.return,be)}if(f===a){Mt=null;break}var ue=f.sibling;if(ue!==null){ue.return=f.return,Mt=ue;break}Mt=f.return}}var vD=Math.ceil,vh=k.ReactCurrentDispatcher,bm=k.ReactCurrentOwner,$o=k.ReactCurrentBatchConfig,Dn=0,oi=null,Ur=null,vi=0,Eo=0,au=Qa(0),Kr=0,vd=null,nl=0,yh=0,Im=0,yd=null,ao=null,wm=0,cu=1/0,Aa=null,Ch=!1,Sm=null,ic=null,xh=!1,oc=null,bh=0,Cd=0,Am=null,Ih=-1,wh=0;function Ui(){return(Dn&6)!==0?wt():Ih!==-1?Ih:Ih=wt()}function sc(a){return(a.mode&1)===0?1:(Dn&2)!==0&&vi!==0?vi&-vi:eD.transition!==null?(wh===0&&(wh=ie()),wh):(a=mt,a!==0||(a=window.event,a=a===void 0?16:za(a.type)),a)}function ds(a,f,v,b){if(50<Cd)throw Cd=0,Am=null,Error(t(185));Te(a,v,b),((Dn&2)===0||a!==oi)&&(a===oi&&((Dn&2)===0&&(yh|=v),Kr===4&&ac(a,vi)),co(a,b),v===1&&Dn===0&&(f.mode&1)===0&&(cu=wt()+500,Yf&&ec()))}function co(a,f){var v=a.callbackNode;G(a,f);var b=on(a,a===oi?vi:0);if(b===0)v!==null&&It(v),a.callbackNode=null,a.callbackPriority=0;else if(f=b&-b,a.callbackPriority!==f){if(v!=null&&It(v),f===1)a.tag===0?JR(kb.bind(null,a)):dx(kb.bind(null,a)),KR(function(){(Dn&6)===0&&ec()}),v=null;else{switch(Kt(b)){case 1:v=Jn;break;case 4:v=er;break;case 16:v=ir;break;case 536870912:v=nn;break;default:v=ir}v=Nb(v,Ab.bind(null,a))}a.callbackPriority=f,a.callbackNode=v}}function Ab(a,f){if(Ih=-1,wh=0,(Dn&6)!==0)throw Error(t(327));var v=a.callbackNode;if(lu()&&a.callbackNode!==v)return null;var b=on(a,a===oi?vi:0);if(b===0)return null;if((b&30)!==0||(b&a.expiredLanes)!==0||f)f=Sh(a,b);else{f=b;var T=Dn;Dn|=2;var O=Tb();(oi!==a||vi!==f)&&(Aa=null,cu=wt()+500,il(a,f));do try{xD();break}catch(ue){Eb(a,ue)}while(!0);Wg(),vh.current=O,Dn=T,Ur!==null?f=0:(oi=null,vi=0,f=Kr)}if(f!==0){if(f===2&&(T=Q(a),T!==0&&(b=T,f=km(a,T))),f===1)throw v=vd,il(a,0),ac(a,b),co(a,wt()),v;if(f===6)ac(a,b);else{if(T=a.current.alternate,(b&30)===0&&!yD(T)&&(f=Sh(a,b),f===2&&(O=Q(a),O!==0&&(b=O,f=km(a,O))),f===1))throw v=vd,il(a,0),ac(a,b),co(a,wt()),v;switch(a.finishedWork=T,a.finishedLanes=b,f){case 0:case 1:throw Error(t(345));case 2:ol(a,ao,Aa);break;case 3:if(ac(a,b),(b&130023424)===b&&(f=wm+500-wt(),10<f)){if(on(a,0)!==0)break;if(T=a.suspendedLanes,(T&b)!==b){Ui(),a.pingedLanes|=a.suspendedLanes&T;break}a.timeoutHandle=Pg(ol.bind(null,a,ao,Aa),f);break}ol(a,ao,Aa);break;case 4:if(ac(a,b),(b&4194240)===b)break;for(f=a.eventTimes,T=-1;0<b;){var $=31-yn(b);O=1<<$,$=f[$],$>T&&(T=$),b&=~O}if(b=T,b=wt()-b,b=(120>b?120:480>b?480:1080>b?1080:1920>b?1920:3e3>b?3e3:4320>b?4320:1960*vD(b/1960))-b,10<b){a.timeoutHandle=Pg(ol.bind(null,a,ao,Aa),b);break}ol(a,ao,Aa);break;case 5:ol(a,ao,Aa);break;default:throw Error(t(329))}}}return co(a,wt()),a.callbackNode===v?Ab.bind(null,a):null}function km(a,f){var v=yd;return a.current.memoizedState.isDehydrated&&(il(a,f).flags|=256),a=Sh(a,f),a!==2&&(f=ao,ao=v,f!==null&&Em(f)),a}function Em(a){ao===null?ao=a:ao.push.apply(ao,a)}function yD(a){for(var f=a;;){if(f.flags&16384){var v=f.updateQueue;if(v!==null&&(v=v.stores,v!==null))for(var b=0;b<v.length;b++){var T=v[b],O=T.getSnapshot;T=T.value;try{if(!ss(O(),T))return!1}catch{return!1}}}if(v=f.child,f.subtreeFlags&16384&&v!==null)v.return=f,f=v;else{if(f===a)break;for(;f.sibling===null;){if(f.return===null||f.return===a)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function ac(a,f){for(f&=~Im,f&=~yh,a.suspendedLanes|=f,a.pingedLanes&=~f,a=a.expirationTimes;0<f;){var v=31-yn(f),b=1<<v;a[v]=-1,f&=~b}}function kb(a){if((Dn&6)!==0)throw Error(t(327));lu();var f=on(a,0);if((f&1)===0)return co(a,wt()),null;var v=Sh(a,f);if(a.tag!==0&&v===2){var b=Q(a);b!==0&&(f=b,v=km(a,b))}if(v===1)throw v=vd,il(a,0),ac(a,f),co(a,wt()),v;if(v===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=f,ol(a,ao,Aa),co(a,wt()),null}function Tm(a,f){var v=Dn;Dn|=1;try{return a(f)}finally{Dn=v,Dn===0&&(cu=wt()+500,Yf&&ec())}}function rl(a){oc!==null&&oc.tag===0&&(Dn&6)===0&&lu();var f=Dn;Dn|=1;var v=$o.transition,b=mt;try{if($o.transition=null,mt=1,a)return a()}finally{mt=b,$o.transition=v,Dn=f,(Dn&6)===0&&ec()}}function _m(){Eo=au.current,cr(au)}function il(a,f){a.finishedWork=null,a.finishedLanes=0;var v=a.timeoutHandle;if(v!==-1&&(a.timeoutHandle=-1,$R(v)),Ur!==null)for(v=Ur.return;v!==null;){var b=v;switch(Lg(b),b.tag){case 1:b=b.type.childContextTypes,b!=null&&Kf();break;case 3:iu(),cr(io),cr(_i),Yg();break;case 5:Kg(b);break;case 4:iu();break;case 13:cr(Sr);break;case 19:cr(Sr);break;case 10:zg(b.type._context);break;case 22:case 23:_m()}v=v.return}if(oi=a,Ur=a=cc(a.current,null),vi=Eo=f,Kr=0,vd=null,Im=yh=nl=0,ao=yd=null,Jc!==null){for(f=0;f<Jc.length;f++)if(v=Jc[f],b=v.interleaved,b!==null){v.interleaved=null;var T=b.next,O=v.pending;if(O!==null){var $=O.next;O.next=T,b.next=$}v.pending=b}Jc=null}return a}function Eb(a,f){do{var v=Ur;try{if(Wg(),ah.current=dh,ch){for(var b=Ar.memoizedState;b!==null;){var T=b.queue;T!==null&&(T.pending=null),b=b.next}ch=!1}if(tl=0,ii=$r=Ar=null,dd=!1,fd=0,bm.current=null,v===null||v.return===null){Kr=1,vd=f,Ur=null;break}e:{var O=a,$=v.return,ue=v,be=f;if(f=vi,ue.flags|=32768,be!==null&&typeof be=="object"&&typeof be.then=="function"){var Ue=be,nt=ue,ot=nt.tag;if((nt.mode&1)===0&&(ot===0||ot===11||ot===15)){var tt=nt.alternate;tt?(nt.updateQueue=tt.updateQueue,nt.memoizedState=tt.memoizedState,nt.lanes=tt.lanes):(nt.updateQueue=null,nt.memoizedState=null)}var Rt=Qx($);if(Rt!==null){Rt.flags&=-257,Jx(Rt,$,ue,O,f),Rt.mode&1&&Yx(O,Ue,f),f=Rt,be=Ue;var Bt=f.updateQueue;if(Bt===null){var Ut=new Set;Ut.add(be),f.updateQueue=Ut}else Bt.add(be);break e}else{if((f&1)===0){Yx(O,Ue,f),Rm();break e}be=Error(t(426))}}else if(pr&&ue.mode&1){var Mr=Qx($);if(Mr!==null){(Mr.flags&65536)===0&&(Mr.flags|=256),Jx(Mr,$,ue,O,f),Vg(ou(be,ue));break e}}O=be=ou(be,ue),Kr!==4&&(Kr=2),yd===null?yd=[O]:yd.push(O),O=$;do{switch(O.tag){case 3:O.flags|=65536,f&=-f,O.lanes|=f;var Me=Kx(O,be,f);Ix(O,Me);break e;case 1:ue=be;var Se=O.type,Be=O.stateNode;if((O.flags&128)===0&&(typeof Se.getDerivedStateFromError=="function"||Be!==null&&typeof Be.componentDidCatch=="function"&&(ic===null||!ic.has(Be)))){O.flags|=65536,f&=-f,O.lanes|=f;var ft=qx(O,ue,f);Ix(O,ft);break e}}O=O.return}while(O!==null)}Rb(v)}catch(jt){f=jt,Ur===v&&v!==null&&(Ur=v=v.return);continue}break}while(!0)}function Tb(){var a=vh.current;return vh.current=dh,a===null?dh:a}function Rm(){(Kr===0||Kr===3||Kr===2)&&(Kr=4),oi===null||(nl&268435455)===0&&(yh&268435455)===0||ac(oi,vi)}function Sh(a,f){var v=Dn;Dn|=2;var b=Tb();(oi!==a||vi!==f)&&(Aa=null,il(a,f));do try{CD();break}catch(T){Eb(a,T)}while(!0);if(Wg(),Dn=v,vh.current=b,Ur!==null)throw Error(t(261));return oi=null,vi=0,Kr}function CD(){for(;Ur!==null;)_b(Ur)}function xD(){for(;Ur!==null&&!In();)_b(Ur)}function _b(a){var f=Mb(a.alternate,a,Eo);a.memoizedProps=a.pendingProps,f===null?Rb(a):Ur=f,bm.current=null}function Rb(a){var f=a;do{var v=f.alternate;if(a=f.return,(f.flags&32768)===0){if(v=fD(v,f,Eo),v!==null){Ur=v;return}}else{if(v=hD(v,f),v!==null){v.flags&=32767,Ur=v;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Kr=6,Ur=null;return}}if(f=f.sibling,f!==null){Ur=f;return}Ur=f=a}while(f!==null);Kr===0&&(Kr=5)}function ol(a,f,v){var b=mt,T=$o.transition;try{$o.transition=null,mt=1,bD(a,f,v,b)}finally{$o.transition=T,mt=b}return null}function bD(a,f,v,b){do lu();while(oc!==null);if((Dn&6)!==0)throw Error(t(327));v=a.finishedWork;var T=a.finishedLanes;if(v===null)return null;if(a.finishedWork=null,a.finishedLanes=0,v===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var O=v.lanes|v.childLanes;if(ze(a,O),a===oi&&(Ur=oi=null,vi=0),(v.subtreeFlags&2064)===0&&(v.flags&2064)===0||xh||(xh=!0,Nb(ir,function(){return lu(),null})),O=(v.flags&15990)!==0,(v.subtreeFlags&15990)!==0||O){O=$o.transition,$o.transition=null;var $=mt;mt=1;var ue=Dn;Dn|=4,bm.current=null,gD(a,v),xb(v,a),VR(Rg),sr=!!_g,Rg=_g=null,a.current=v,mD(v),Ft(),Dn=ue,mt=$,$o.transition=O}else a.current=v;if(xh&&(xh=!1,oc=a,bh=T),O=a.pendingLanes,O===0&&(ic=null),hi(v.stateNode),co(a,wt()),f!==null)for(b=a.onRecoverableError,v=0;v<f.length;v++)T=f[v],b(T.value,{componentStack:T.stack,digest:T.digest});if(Ch)throw Ch=!1,a=Sm,Sm=null,a;return(bh&1)!==0&&a.tag!==0&&lu(),O=a.pendingLanes,(O&1)!==0?a===Am?Cd++:(Cd=0,Am=a):Cd=0,ec(),null}function lu(){if(oc!==null){var a=Kt(bh),f=$o.transition,v=mt;try{if($o.transition=null,mt=16>a?16:a,oc===null)var b=!1;else{if(a=oc,oc=null,bh=0,(Dn&6)!==0)throw Error(t(331));var T=Dn;for(Dn|=4,Mt=a.current;Mt!==null;){var O=Mt,$=O.child;if((Mt.flags&16)!==0){var ue=O.deletions;if(ue!==null){for(var be=0;be<ue.length;be++){var Ue=ue[be];for(Mt=Ue;Mt!==null;){var nt=Mt;switch(nt.tag){case 0:case 11:case 15:md(8,nt,O)}var ot=nt.child;if(ot!==null)ot.return=nt,Mt=ot;else for(;Mt!==null;){nt=Mt;var tt=nt.sibling,Rt=nt.return;if(gb(nt),nt===Ue){Mt=null;break}if(tt!==null){tt.return=Rt,Mt=tt;break}Mt=Rt}}}var Bt=O.alternate;if(Bt!==null){var Ut=Bt.child;if(Ut!==null){Bt.child=null;do{var Mr=Ut.sibling;Ut.sibling=null,Ut=Mr}while(Ut!==null)}}Mt=O}}if((O.subtreeFlags&2064)!==0&&$!==null)$.return=O,Mt=$;else e:for(;Mt!==null;){if(O=Mt,(O.flags&2048)!==0)switch(O.tag){case 0:case 11:case 15:md(9,O,O.return)}var Me=O.sibling;if(Me!==null){Me.return=O.return,Mt=Me;break e}Mt=O.return}}var Se=a.current;for(Mt=Se;Mt!==null;){$=Mt;var Be=$.child;if(($.subtreeFlags&2064)!==0&&Be!==null)Be.return=$,Mt=Be;else e:for($=Se;Mt!==null;){if(ue=Mt,(ue.flags&2048)!==0)try{switch(ue.tag){case 0:case 11:case 15:mh(9,ue)}}catch(jt){Tr(ue,ue.return,jt)}if(ue===$){Mt=null;break e}var ft=ue.sibling;if(ft!==null){ft.return=ue.return,Mt=ft;break e}Mt=ue.return}}if(Dn=T,ec(),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(vn,a)}catch{}b=!0}return b}finally{mt=v,$o.transition=f}}return!1}function Db(a,f,v){f=ou(v,f),f=Kx(a,f,1),a=nc(a,f,1),f=Ui(),a!==null&&(Te(a,1,f),co(a,f))}function Tr(a,f,v){if(a.tag===3)Db(a,a,v);else for(;f!==null;){if(f.tag===3){Db(f,a,v);break}else if(f.tag===1){var b=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(ic===null||!ic.has(b))){a=ou(v,a),a=qx(f,a,1),f=nc(f,a,1),a=Ui(),f!==null&&(Te(f,1,a),co(f,a));break}}f=f.return}}function ID(a,f,v){var b=a.pingCache;b!==null&&b.delete(f),f=Ui(),a.pingedLanes|=a.suspendedLanes&v,oi===a&&(vi&v)===v&&(Kr===4||Kr===3&&(vi&130023424)===vi&&500>wt()-wm?il(a,0):Im|=v),co(a,f)}function Pb(a,f){f===0&&((a.mode&1)===0?f=1:(f=eo,eo<<=1,(eo&130023424)===0&&(eo=4194304)));var v=Ui();a=Ia(a,f),a!==null&&(Te(a,f,v),co(a,v))}function wD(a){var f=a.memoizedState,v=0;f!==null&&(v=f.retryLane),Pb(a,v)}function SD(a,f){var v=0;switch(a.tag){case 13:var b=a.stateNode,T=a.memoizedState;T!==null&&(v=T.retryLane);break;case 19:b=a.stateNode;break;default:throw Error(t(314))}b!==null&&b.delete(f),Pb(a,v)}var Mb;Mb=function(a,f,v){if(a!==null)if(a.memoizedProps!==f.pendingProps||io.current)so=!0;else{if((a.lanes&v)===0&&(f.flags&128)===0)return so=!1,dD(a,f,v);so=(a.flags&131072)!==0}else so=!1,pr&&(f.flags&1048576)!==0&&fx(f,Jf,f.index);switch(f.lanes=0,f.tag){case 2:var b=f.type;ph(a,f),a=f.pendingProps;var T=Yl(f,_i.current);ru(f,v),T=em(null,f,b,a,T,v);var O=tm();return f.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(f.tag=1,f.memoizedState=null,f.updateQueue=null,oo(b)?(O=!0,qf(f)):O=!1,f.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,Xg(f),T.updater=fh,f.stateNode=T,T._reactInternals=f,am(f,b,a,v),f=dm(null,f,b,!0,O,v)):(f.tag=0,pr&&O&&Bg(f),Li(null,f,T,v),f=f.child),f;case 16:b=f.elementType;e:{switch(ph(a,f),a=f.pendingProps,T=b._init,b=T(b._payload),f.type=b,T=f.tag=kD(b),a=cs(b,a),T){case 0:f=um(null,f,b,a,v);break e;case 1:f=ob(null,f,b,a,v);break e;case 11:f=eb(null,f,b,a,v);break e;case 14:f=tb(null,f,b,cs(b.type,a),v);break e}throw Error(t(306,b,""))}return f;case 0:return b=f.type,T=f.pendingProps,T=f.elementType===b?T:cs(b,T),um(a,f,b,T,v);case 1:return b=f.type,T=f.pendingProps,T=f.elementType===b?T:cs(b,T),ob(a,f,b,T,v);case 3:e:{if(sb(f),a===null)throw Error(t(387));b=f.pendingProps,O=f.memoizedState,T=O.element,bx(a,f),oh(f,b,null,v);var $=f.memoizedState;if(b=$.element,O.isDehydrated)if(O={element:b,isDehydrated:!1,cache:$.cache,pendingSuspenseBoundaries:$.pendingSuspenseBoundaries,transitions:$.transitions},f.updateQueue.baseState=O,f.memoizedState=O,f.flags&256){T=ou(Error(t(423)),f),f=ab(a,f,b,v,T);break e}else if(b!==T){T=ou(Error(t(424)),f),f=ab(a,f,b,v,T);break e}else for(ko=Ya(f.stateNode.containerInfo.firstChild),Ao=f,pr=!0,as=null,v=Cx(f,null,b,v),f.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(eu(),b===T){f=Sa(a,f,v);break e}Li(a,f,b,v)}f=f.child}return f;case 5:return Sx(f),a===null&&jg(f),b=f.type,T=f.pendingProps,O=a!==null?a.memoizedProps:null,$=T.children,Dg(b,T)?$=null:O!==null&&Dg(b,O)&&(f.flags|=32),ib(a,f),Li(a,f,$,v),f.child;case 6:return a===null&&jg(f),null;case 13:return cb(a,f,v);case 4:return $g(f,f.stateNode.containerInfo),b=f.pendingProps,a===null?f.child=tu(f,null,b,v):Li(a,f,b,v),f.child;case 11:return b=f.type,T=f.pendingProps,T=f.elementType===b?T:cs(b,T),eb(a,f,b,T,v);case 7:return Li(a,f,f.pendingProps,v),f.child;case 8:return Li(a,f,f.pendingProps.children,v),f.child;case 12:return Li(a,f,f.pendingProps.children,v),f.child;case 10:e:{if(b=f.type._context,T=f.pendingProps,O=f.memoizedProps,$=T.value,nr(nh,b._currentValue),b._currentValue=$,O!==null)if(ss(O.value,$)){if(O.children===T.children&&!io.current){f=Sa(a,f,v);break e}}else for(O=f.child,O!==null&&(O.return=f);O!==null;){var ue=O.dependencies;if(ue!==null){$=O.child;for(var be=ue.firstContext;be!==null;){if(be.context===b){if(O.tag===1){be=wa(-1,v&-v),be.tag=2;var Ue=O.updateQueue;if(Ue!==null){Ue=Ue.shared;var nt=Ue.pending;nt===null?be.next=be:(be.next=nt.next,nt.next=be),Ue.pending=be}}O.lanes|=v,be=O.alternate,be!==null&&(be.lanes|=v),Hg(O.return,v,f),ue.lanes|=v;break}be=be.next}}else if(O.tag===10)$=O.type===f.type?null:O.child;else if(O.tag===18){if($=O.return,$===null)throw Error(t(341));$.lanes|=v,ue=$.alternate,ue!==null&&(ue.lanes|=v),Hg($,v,f),$=O.sibling}else $=O.child;if($!==null)$.return=O;else for($=O;$!==null;){if($===f){$=null;break}if(O=$.sibling,O!==null){O.return=$.return,$=O;break}$=$.return}O=$}Li(a,f,T.children,v),f=f.child}return f;case 9:return T=f.type,b=f.pendingProps.children,ru(f,v),T=Zo(T),b=b(T),f.flags|=1,Li(a,f,b,v),f.child;case 14:return b=f.type,T=cs(b,f.pendingProps),T=cs(b.type,T),tb(a,f,b,T,v);case 15:return nb(a,f,f.type,f.pendingProps,v);case 17:return b=f.type,T=f.pendingProps,T=f.elementType===b?T:cs(b,T),ph(a,f),f.tag=1,oo(b)?(a=!0,qf(f)):a=!1,ru(f,v),Xx(f,b,T),am(f,b,T,v),dm(null,f,b,!0,a,v);case 19:return ub(a,f,v);case 22:return rb(a,f,v)}throw Error(t(156,f.tag))};function Nb(a,f){return Ze(a,f)}function AD(a,f,v,b){this.tag=a,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ko(a,f,v,b){return new AD(a,f,v,b)}function Dm(a){return a=a.prototype,!(!a||!a.isReactComponent)}function kD(a){if(typeof a=="function")return Dm(a)?1:0;if(a!=null){if(a=a.$$typeof,a===X)return 11;if(a===ve)return 14}return 2}function cc(a,f){var v=a.alternate;return v===null?(v=Ko(a.tag,f,a.key,a.mode),v.elementType=a.elementType,v.type=a.type,v.stateNode=a.stateNode,v.alternate=a,a.alternate=v):(v.pendingProps=f,v.type=a.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=a.flags&14680064,v.childLanes=a.childLanes,v.lanes=a.lanes,v.child=a.child,v.memoizedProps=a.memoizedProps,v.memoizedState=a.memoizedState,v.updateQueue=a.updateQueue,f=a.dependencies,v.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},v.sibling=a.sibling,v.index=a.index,v.ref=a.ref,v}function Ah(a,f,v,b,T,O){var $=2;if(b=a,typeof a=="function")Dm(a)&&($=1);else if(typeof a=="string")$=5;else e:switch(a){case D:return sl(v.children,T,O,f);case j:$=8,T|=8;break;case Z:return a=Ko(12,v,f,T|2),a.elementType=Z,a.lanes=O,a;case te:return a=Ko(13,v,f,T),a.elementType=te,a.lanes=O,a;case pe:return a=Ko(19,v,f,T),a.elementType=pe,a.lanes=O,a;case Re:return kh(v,T,O,f);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case F:$=10;break e;case V:$=9;break e;case X:$=11;break e;case ve:$=14;break e;case Ie:$=16,b=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return f=Ko($,v,f,T),f.elementType=a,f.type=b,f.lanes=O,f}function sl(a,f,v,b){return a=Ko(7,a,b,f),a.lanes=v,a}function kh(a,f,v,b){return a=Ko(22,a,b,f),a.elementType=Re,a.lanes=v,a.stateNode={isHidden:!1},a}function Pm(a,f,v){return a=Ko(6,a,null,f),a.lanes=v,a}function Mm(a,f,v){return f=Ko(4,a.children!==null?a.children:[],a.key,f),f.lanes=v,f.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},f}function ED(a,f,v,b,T){this.tag=f,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Oe(0),this.expirationTimes=Oe(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oe(0),this.identifierPrefix=b,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function Nm(a,f,v,b,T,O,$,ue,be){return a=new ED(a,f,v,ue,be),f===1?(f=1,O===!0&&(f|=8)):f=0,O=Ko(3,null,null,f),a.current=O,O.stateNode=a,O.memoizedState={element:b,isDehydrated:v,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xg(O),a}function TD(a,f,v){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_,key:b==null?null:""+b,children:a,containerInfo:f,implementation:v}}function Ob(a){if(!a)return Ja;a=a._reactInternals;e:{if(Le(a)!==a||a.tag!==1)throw Error(t(170));var f=a;do{switch(f.tag){case 3:f=f.stateNode.context;break e;case 1:if(oo(f.type)){f=f.stateNode.__reactInternalMemoizedMergedChildContext;break e}}f=f.return}while(f!==null);throw Error(t(171))}if(a.tag===1){var v=a.type;if(oo(v))return lx(a,v,f)}return f}function Fb(a,f,v,b,T,O,$,ue,be){return a=Nm(v,b,!0,a,T,O,$,ue,be),a.context=Ob(null),v=a.current,b=Ui(),T=sc(v),O=wa(b,T),O.callback=f??null,nc(v,O,T),a.current.lanes=T,Te(a,T,b),co(a,b),a}function Eh(a,f,v,b){var T=f.current,O=Ui(),$=sc(T);return v=Ob(v),f.context===null?f.context=v:f.pendingContext=v,f=wa(O,$),f.payload={element:a},b=b===void 0?null:b,b!==null&&(f.callback=b),a=nc(T,f,$),a!==null&&(ds(a,T,$,O),ih(a,T,$)),$}function Th(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function Bb(a,f){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var v=a.retryLane;a.retryLane=v!==0&&v<f?v:f}}function Om(a,f){Bb(a,f),(a=a.alternate)&&Bb(a,f)}function _D(){return null}var Lb=typeof reportError=="function"?reportError:function(a){console.error(a)};function Fm(a){this._internalRoot=a}_h.prototype.render=Fm.prototype.render=function(a){var f=this._internalRoot;if(f===null)throw Error(t(409));Eh(a,f,null,null)},_h.prototype.unmount=Fm.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var f=a.containerInfo;rl(function(){Eh(null,a,null,null)}),f[ya]=null}};function _h(a){this._internalRoot=a}_h.prototype.unstable_scheduleHydration=function(a){if(a){var f=Si();a={blockedOn:null,target:a,priority:f};for(var v=0;v<xo.length&&f!==0&&f<xo[v].priority;v++);xo.splice(v,0,a),v===0&&to(a)}};function Bm(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Rh(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function Ub(){}function RD(a,f,v,b,T){if(T){if(typeof b=="function"){var O=b;b=function(){var Ue=Th($);O.call(Ue)}}var $=Fb(f,b,a,0,null,!1,!1,"",Ub);return a._reactRootContainer=$,a[ya]=$.current,rd(a.nodeType===8?a.parentNode:a),rl(),$}for(;T=a.lastChild;)a.removeChild(T);if(typeof b=="function"){var ue=b;b=function(){var Ue=Th(be);ue.call(Ue)}}var be=Nm(a,0,!1,null,null,!1,!1,"",Ub);return a._reactRootContainer=be,a[ya]=be.current,rd(a.nodeType===8?a.parentNode:a),rl(function(){Eh(f,be,v,b)}),be}function Dh(a,f,v,b,T){var O=v._reactRootContainer;if(O){var $=O;if(typeof T=="function"){var ue=T;T=function(){var be=Th($);ue.call(be)}}Eh(f,$,a,T)}else $=RD(v,f,a,T,b);return Th($)}an=function(a){switch(a.tag){case 3:var f=a.stateNode;if(f.current.memoizedState.isDehydrated){var v=kt(f.pendingLanes);v!==0&&(dt(f,v|1),co(f,wt()),(Dn&6)===0&&(cu=wt()+500,ec()))}break;case 13:rl(function(){var b=Ia(a,1);if(b!==null){var T=Ui();ds(b,a,1,T)}}),Om(a,1)}},Un=function(a){if(a.tag===13){var f=Ia(a,134217728);if(f!==null){var v=Ui();ds(f,a,134217728,v)}Om(a,134217728)}},wi=function(a){if(a.tag===13){var f=sc(a),v=Ia(a,f);if(v!==null){var b=Ui();ds(v,a,f,b)}Om(a,f)}},Si=function(){return mt},ni=function(a,f){var v=mt;try{return mt=a,f()}finally{mt=v}},kr=function(a,f,v){switch(f){case"input":if(Gt(a,v),f=v.name,v.type==="radio"&&f!=null){for(v=a;v.parentNode;)v=v.parentNode;for(v=v.querySelectorAll("input[name="+JSON.stringify(""+f)+'][type="radio"]'),f=0;f<v.length;f++){var b=v[f];if(b!==a&&b.form===a.form){var T=$f(b);if(!T)throw Error(t(90));Et(b),Gt(b,T)}}}break;case"textarea":rn(a,v);break;case"select":f=v.value,f!=null&&sn(a,!!v.multiple,f,!1)}},Wt=Tm,hr=rl;var DD={usingClientEntryPoint:!1,Events:[sd,Kl,$f,Qe,Tn,Tm]},xd={findFiberByHostInstance:Kc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},PD={bundleType:xd.bundleType,version:xd.version,rendererPackageName:xd.rendererPackageName,rendererConfig:xd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=st(a),a===null?null:a.stateNode},findFiberByHostInstance:xd.findFiberByHostInstance||_D,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ph=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ph.isDisabled&&Ph.supportsFiber)try{vn=Ph.inject(PD),or=Ph}catch{}}return lo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DD,lo.createPortal=function(a,f){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bm(f))throw Error(t(200));return TD(a,f,null,v)},lo.createRoot=function(a,f){if(!Bm(a))throw Error(t(299));var v=!1,b="",T=Lb;return f!=null&&(f.unstable_strictMode===!0&&(v=!0),f.identifierPrefix!==void 0&&(b=f.identifierPrefix),f.onRecoverableError!==void 0&&(T=f.onRecoverableError)),f=Nm(a,1,!1,null,null,v,!1,b,T),a[ya]=f.current,rd(a.nodeType===8?a.parentNode:a),new Fm(f)},lo.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var f=a._reactInternals;if(f===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=st(f),a=a===null?null:a.stateNode,a},lo.flushSync=function(a){return rl(a)},lo.hydrate=function(a,f,v){if(!Rh(f))throw Error(t(200));return Dh(null,a,f,!0,v)},lo.hydrateRoot=function(a,f,v){if(!Bm(a))throw Error(t(405));var b=v!=null&&v.hydratedSources||null,T=!1,O="",$=Lb;if(v!=null&&(v.unstable_strictMode===!0&&(T=!0),v.identifierPrefix!==void 0&&(O=v.identifierPrefix),v.onRecoverableError!==void 0&&($=v.onRecoverableError)),f=Fb(f,null,a,1,v??null,T,!1,O,$),a[ya]=f.current,rd(a),b)for(a=0;a<b.length;a++)v=b[a],T=v._getVersion,T=T(v._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[v,T]:f.mutableSourceEagerHydrationData.push(v,T);return new _h(f)},lo.render=function(a,f,v){if(!Rh(f))throw Error(t(200));return Dh(null,a,f,!1,v)},lo.unmountComponentAtNode=function(a){if(!Rh(a))throw Error(t(40));return a._reactRootContainer?(rl(function(){Dh(null,null,a,!1,function(){a._reactRootContainer=null,a[ya]=null})}),!0):!1},lo.unstable_batchedUpdates=Tm,lo.unstable_renderSubtreeIntoContainer=function(a,f,v,b){if(!Rh(v))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Dh(a,f,v,!1,b)},lo.version="18.3.1-next-f1338f8080-20240426",lo}var $b;function ak(){if($b)return Vm.exports;$b=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Vm.exports=WD(),Vm.exports}var Kb;function zD(){if(Kb)return Nh;Kb=1;var n=ak();return Nh.createRoot=n.createRoot,Nh.hydrateRoot=n.hydrateRoot,Nh}var HD=zD();const ZD=Nc(HD);var ck=ak();const XD=Nc(ck),$D=sk({__proto__:null,default:XD},[ck]);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gr(){return gr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},gr.apply(this,arguments)}var Vr;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Vr||(Vr={}));const qb="popstate";function KD(n){n===void 0&&(n={});function e(r,i){let{pathname:o,search:c,hash:s}=r.location;return nf("",{pathname:o,search:c,hash:s},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:Ef(i)}return YD(e,t,null,n)}function On(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Nu(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function qD(){return Math.random().toString(36).substr(2,8)}function Yb(n,e){return{usr:n.state,key:n.key,idx:e}}function nf(n,e,t,r){return t===void 0&&(t=null),gr({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Oc(e):e,{state:t,key:e&&e.key||r||qD()})}function Ef(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Oc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function YD(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,c=i.history,s=Vr.Pop,l=null,d=h();d==null&&(d=0,c.replaceState(gr({},c.state,{idx:d}),""));function h(){return(c.state||{idx:null}).idx}function p(){s=Vr.Pop;let w=h(),S=w==null?null:w-d;d=w,l&&l({action:s,location:x.location,delta:S})}function g(w,S){s=Vr.Push;let E=nf(x.location,w,S);d=h()+1;let R=Yb(E,d),k=x.createHref(E);try{c.pushState(R,"",k)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;i.location.assign(k)}o&&l&&l({action:s,location:x.location,delta:1})}function y(w,S){s=Vr.Replace;let E=nf(x.location,w,S);d=h();let R=Yb(E,d),k=x.createHref(E);c.replaceState(R,"",k),o&&l&&l({action:s,location:x.location,delta:0})}function C(w){let S=i.location.origin!=="null"?i.location.origin:i.location.href,E=typeof w=="string"?w:Ef(w);return E=E.replace(/ $/,"%20"),On(S,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,S)}let x={get action(){return s},get location(){return n(i,c)},listen(w){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(qb,p),l=w,()=>{i.removeEventListener(qb,p),l=null}},createHref(w){return e(i,w)},createURL:C,encodeLocation(w){let S=C(w);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:g,replace:y,go(w){return c.go(w)}};return x}var Zn;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Zn||(Zn={}));const QD=new Set(["lazy","caseSensitive","path","id","index","children"]);function JD(n){return n.index===!0}function op(n,e,t,r){return t===void 0&&(t=[]),r===void 0&&(r={}),n.map((i,o)=>{let c=[...t,String(o)],s=typeof i.id=="string"?i.id:c.join("-");if(On(i.index!==!0||!i.children,"Cannot specify children on an index route"),On(!r[s],'Found a route id collision on id "'+s+`".  Route id's must be globally unique within Data Router usages`),JD(i)){let l=gr({},i,e(i),{id:s});return r[s]=l,l}else{let l=gr({},i,e(i),{id:s,children:void 0});return r[s]=l,i.children&&(l.children=op(i.children,e,c,r)),l}})}function ul(n,e,t){return t===void 0&&(t="/"),e0(n,e,t,!1)}function e0(n,e,t,r){let i=typeof e=="string"?Oc(e):e,o=Tf(i.pathname||"/",t);if(o==null)return null;let c=lk(n);tP(c);let s=null;for(let l=0;s==null&&l<c.length;++l){let d=fP(o);s=uP(c[l],d,r)}return s}function eP(n,e){let{route:t,pathname:r,params:i}=n;return{id:t.id,pathname:r,params:i,data:e[t.id],handle:t.handle}}function lk(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(o,c,s)=>{let l={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};l.relativePath.startsWith("/")&&(On(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let d=yl([r,l.relativePath]),h=t.concat(l);o.children&&o.children.length>0&&(On(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),lk(o.children,e,h,d)),!(o.path==null&&!o.index)&&e.push({path:d,score:cP(d,o.index),routesMeta:h})};return n.forEach((o,c)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))i(o,c);else for(let l of uk(o.path))i(o,c,l)}),e}function uk(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let c=uk(r.join("/")),s=[];return s.push(...c.map(l=>l===""?o:[o,l].join("/"))),i&&s.push(...c),s.map(l=>n.startsWith("/")&&l===""?"/":l)}function tP(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:lP(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const nP=/^:[\w-]+$/,rP=3,iP=2,oP=1,sP=10,aP=-2,Qb=n=>n==="*";function cP(n,e){let t=n.split("/"),r=t.length;return t.some(Qb)&&(r+=aP),e&&(r+=iP),t.filter(i=>!Qb(i)).reduce((i,o)=>i+(nP.test(o)?rP:o===""?oP:sP),r)}function lP(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function uP(n,e,t){t===void 0&&(t=!1);let{routesMeta:r}=n,i={},o="/",c=[];for(let s=0;s<r.length;++s){let l=r[s],d=s===r.length-1,h=o==="/"?e:e.slice(o.length)||"/",p=Jb({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),g=l.route;if(!p&&d&&t&&!r[r.length-1].route.index&&(p=Jb({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),c.push({params:i,pathname:yl([o,p.pathname]),pathnameBase:vP(yl([o,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(o=yl([o,p.pathnameBase]))}return c}function Jb(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=dP(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let o=i[0],c=o.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((d,h,p)=>{let{paramName:g,isOptional:y}=h;if(g==="*"){let x=s[p]||"";c=o.slice(0,o.length-x.length).replace(/(.)\/+$/,"$1")}const C=s[p];return y&&!C?d[g]=void 0:d[g]=(C||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:c,pattern:n}}function dP(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Nu(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,s,l)=>(r.push({paramName:s,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function fP(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Nu(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Tf(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function hP(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Oc(n):n;return{pathname:t?t.startsWith("/")?t:pP(t,e):e,search:yP(r),hash:CP(i)}}function pP(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function zm(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function dk(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function gP(n,e){let t=dk(n);return e?t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function mP(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=Oc(n):(i=gr({},n),On(!i.pathname||!i.pathname.includes("?"),zm("?","pathname","search",i)),On(!i.pathname||!i.pathname.includes("#"),zm("#","pathname","hash",i)),On(!i.search||!i.search.includes("#"),zm("#","search","hash",i)));let o=n===""||i.pathname==="",c=o?"/":i.pathname,s;if(c==null)s=t;else{let p=e.length-1;if(!r&&c.startsWith("..")){let g=c.split("/");for(;g[0]==="..";)g.shift(),p-=1;i.pathname=g.join("/")}s=p>=0?e[p]:"/"}let l=hP(i,s),d=c&&c!=="/"&&c.endsWith("/"),h=(o||c===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}const yl=n=>n.join("/").replace(/\/\/+/g,"/"),vP=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),yP=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,CP=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;class sp{constructor(e,t,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=t||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function rf(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const fk=["post","put","patch","delete"],xP=new Set(fk),bP=["get",...fk],IP=new Set(bP),wP=new Set([301,302,303,307,308]),SP=new Set([307,308]),Hm={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},AP={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Id={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},aC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kP=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),hk="remix-router-transitions";function EP(n){const e=n.window?n.window:typeof window<"u"?window:void 0,t=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!t;On(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(n.mapRouteProperties)i=n.mapRouteProperties;else if(n.detectErrorBoundary){let ge=n.detectErrorBoundary;i=we=>({hasErrorBoundary:ge(we)})}else i=kP;let o={},c=op(n.routes,i,void 0,o),s,l=n.basename||"/",d=n.dataStrategy||DP,h=n.patchRoutesOnNavigation,p=gr({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},n.future),g=null,y=new Set,C=null,x=null,w=null,S=n.hydrationData!=null,E=ul(c,n.history.location,l),R=!1,k=null;if(E==null&&!h){let ge=fo(404,{pathname:n.history.location.pathname}),{matches:we,route:J}=uI(c);E=we,k={[J.id]:ge}}E&&!n.hydrationData&&hr(E,c,n.history.location.pathname).active&&(E=null);let A;if(E)if(E.some(ge=>ge.route.lazy))A=!1;else if(!E.some(ge=>ge.route.loader))A=!0;else if(p.v7_partialHydration){let ge=n.hydrationData?n.hydrationData.loaderData:null,we=n.hydrationData?n.hydrationData.errors:null;if(we){let J=E.findIndex(Ge=>we[Ge.route.id]!==void 0);A=E.slice(0,J+1).every(Ge=>!Hv(Ge.route,ge,we))}else A=E.every(J=>!Hv(J.route,ge,we))}else A=n.hydrationData!=null;else if(A=!1,E=[],p.v7_partialHydration){let ge=hr(null,c,n.history.location.pathname);ge.active&&ge.matches&&(R=!0,E=ge.matches)}let _,D={historyAction:n.history.action,location:n.history.location,matches:E,initialized:A,navigation:Hm,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||k,fetchers:new Map,blockers:new Map},j=Vr.Pop,Z=!1,F,V=!1,X=new Map,te=null,pe=!1,ve=!1,Ie=[],Re=new Set,xe=new Map,Ae=0,ke=-1,H=new Map,ee=new Set,ae=new Map,ye=new Map,Ee=new Set,_e=new Map,Je=new Map,me;function it(){if(g=n.history.listen(ge=>{let{action:we,location:J,delta:Ge}=ge;if(me){me(),me=void 0;return}Nu(Je.size===0||Ge!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let rt=kr({currentLocation:D.location,nextLocation:J,historyAction:we});if(rt&&Ge!=null){let _t=new Promise(Ot=>{me=Ot});n.history.go(Ge*-1),Ln(rt,{state:"blocked",location:J,proceed(){Ln(rt,{state:"proceeding",proceed:void 0,reset:void 0,location:J}),_t.then(()=>n.history.go(Ge))},reset(){let Ot=new Map(D.blockers);Ot.set(rt,Id),Et({blockers:Ot})}});return}return lt(we,J)}),t){HP(e,X);let ge=()=>ZP(e,X);e.addEventListener("pagehide",ge),te=()=>e.removeEventListener("pagehide",ge)}return D.initialized||lt(Vr.Pop,D.location,{initialHydration:!0}),_}function Tt(){g&&g(),te&&te(),y.clear(),F&&F.abort(),D.fetchers.forEach((ge,we)=>Ce(we)),D.blockers.forEach((ge,we)=>dn(we))}function Xt(ge){return y.add(ge),()=>y.delete(ge)}function Et(ge,we){we===void 0&&(we={}),D=gr({},D,ge);let J=[],Ge=[];p.v7_fetcherPersist&&D.fetchers.forEach((rt,_t)=>{rt.state==="idle"&&(Ee.has(_t)?Ge.push(_t):J.push(_t))}),Ee.forEach(rt=>{!D.fetchers.has(rt)&&!xe.has(rt)&&Ge.push(rt)}),[...y].forEach(rt=>rt(D,{deletedFetchers:Ge,viewTransitionOpts:we.viewTransitionOpts,flushSync:we.flushSync===!0})),p.v7_fetcherPersist?(J.forEach(rt=>D.fetchers.delete(rt)),Ge.forEach(rt=>Ce(rt))):Ge.forEach(rt=>Ee.delete(rt))}function St(ge,we,J){var Ge,rt;let{flushSync:_t}=J===void 0?{}:J,Ot=D.actionData!=null&&D.navigation.formMethod!=null&&Ss(D.navigation.formMethod)&&D.navigation.state==="loading"&&((Ge=ge.state)==null?void 0:Ge._isRedirect)!==!0,pt;we.actionData?Object.keys(we.actionData).length>0?pt=we.actionData:pt=null:Ot?pt=D.actionData:pt=null;let gt=we.loaderData?cI(D.loaderData,we.loaderData,we.matches||[],we.errors):D.loaderData,bt=D.blockers;bt.size>0&&(bt=new Map(bt),bt.forEach((He,bn)=>bt.set(bn,Id)));let Le=Z===!0||D.navigation.formMethod!=null&&Ss(D.navigation.formMethod)&&((rt=ge.state)==null?void 0:rt._isRedirect)!==!0;s&&(c=s,s=void 0),pe||j===Vr.Pop||(j===Vr.Push?n.history.push(ge,ge.state):j===Vr.Replace&&n.history.replace(ge,ge.state));let ut;if(j===Vr.Pop){let He=X.get(D.location.pathname);He&&He.has(ge.pathname)?ut={currentLocation:D.location,nextLocation:ge}:X.has(ge.pathname)&&(ut={currentLocation:ge,nextLocation:D.location})}else if(V){let He=X.get(D.location.pathname);He?He.add(ge.pathname):(He=new Set([ge.pathname]),X.set(D.location.pathname,He)),ut={currentLocation:D.location,nextLocation:ge}}Et(gr({},we,{actionData:pt,loaderData:gt,historyAction:j,location:ge,initialized:!0,navigation:Hm,revalidation:"idle",restoreScrollPosition:Wt(ge,we.matches||D.matches),preventScrollReset:Le,blockers:bt}),{viewTransitionOpts:ut,flushSync:_t===!0}),j=Vr.Pop,Z=!1,V=!1,pe=!1,ve=!1,Ie=[]}async function Pt(ge,we){if(typeof ge=="number"){n.history.go(ge);return}let J=zv(D.location,D.matches,l,p.v7_prependBasename,ge,p.v7_relativeSplatPath,we==null?void 0:we.fromRouteId,we==null?void 0:we.relative),{path:Ge,submission:rt,error:_t}=eI(p.v7_normalizeFormMethod,!1,J,we),Ot=D.location,pt=nf(D.location,Ge,we&&we.state);pt=gr({},pt,n.history.encodeLocation(pt));let gt=we&&we.replace!=null?we.replace:void 0,bt=Vr.Push;gt===!0?bt=Vr.Replace:gt===!1||rt!=null&&Ss(rt.formMethod)&&rt.formAction===D.location.pathname+D.location.search&&(bt=Vr.Replace);let Le=we&&"preventScrollReset"in we?we.preventScrollReset===!0:void 0,ut=(we&&we.flushSync)===!0,He=kr({currentLocation:Ot,nextLocation:pt,historyAction:bt});if(He){Ln(He,{state:"blocked",location:pt,proceed(){Ln(He,{state:"proceeding",proceed:void 0,reset:void 0,location:pt}),Pt(ge,we)},reset(){let bn=new Map(D.blockers);bn.set(He,Id),Et({blockers:bn})}});return}return await lt(bt,pt,{submission:rt,pendingError:_t,preventScrollReset:Le,replace:we&&we.replace,enableViewTransition:we&&we.viewTransition,flushSync:ut})}function at(){if(q(),Et({revalidation:"loading"}),D.navigation.state!=="submitting"){if(D.navigation.state==="idle"){lt(D.historyAction,D.location,{startUninterruptedRevalidation:!0});return}lt(j||D.historyAction,D.navigation.location,{overrideNavigation:D.navigation,enableViewTransition:V===!0})}}async function lt(ge,we,J){F&&F.abort(),F=null,j=ge,pe=(J&&J.startUninterruptedRevalidation)===!0,Tn(D.location,D.matches),Z=(J&&J.preventScrollReset)===!0,V=(J&&J.enableViewTransition)===!0;let Ge=s||c,rt=J&&J.overrideNavigation,_t=J!=null&&J.initialHydration&&D.matches&&D.matches.length>0&&!R?D.matches:ul(Ge,we,l),Ot=(J&&J.flushSync)===!0;if(_t&&D.initialized&&!ve&&BP(D.location,we)&&!(J&&J.submission&&Ss(J.submission.formMethod))){St(we,{matches:_t},{flushSync:Ot});return}let pt=hr(_t,Ge,we.pathname);if(pt.active&&pt.matches&&(_t=pt.matches),!_t){let{error:st,notFoundMatches:de,route:Ze}=yr(we.pathname);St(we,{matches:de,loaderData:{},errors:{[Ze.id]:st}},{flushSync:Ot});return}F=new AbortController;let gt=uu(n.history,we,F.signal,J&&J.submission),bt;if(J&&J.pendingError)bt=[dl(_t).route.id,{type:Zn.error,error:J.pendingError}];else if(J&&J.submission&&Ss(J.submission.formMethod)){let st=await Gt(gt,we,J.submission,_t,pt.active,{replace:J.replace,flushSync:Ot});if(st.shortCircuited)return;if(st.pendingActionResult){let[de,Ze]=st.pendingActionResult;if(Po(Ze)&&rf(Ze.error)&&Ze.error.status===404){F=null,St(we,{matches:st.matches,loaderData:{},errors:{[de]:Ze.error}});return}}_t=st.matches||_t,bt=st.pendingActionResult,rt=Zm(we,J.submission),Ot=!1,pt.active=!1,gt=uu(n.history,gt.url,gt.signal)}let{shortCircuited:Le,matches:ut,loaderData:He,errors:bn}=await Vt(gt,we,_t,pt.active,rt,J&&J.submission,J&&J.fetcherSubmission,J&&J.replace,J&&J.initialHydration===!0,Ot,bt);Le||(F=null,St(we,gr({matches:ut||_t},lI(bt),{loaderData:He,errors:bn})))}async function Gt(ge,we,J,Ge,rt,_t){_t===void 0&&(_t={}),q();let Ot=WP(we,J);if(Et({navigation:Ot},{flushSync:_t.flushSync===!0}),rt){let bt=await Qn(Ge,we.pathname,ge.signal);if(bt.type==="aborted")return{shortCircuited:!0};if(bt.type==="error"){let Le=dl(bt.partialMatches).route.id;return{matches:bt.partialMatches,pendingActionResult:[Le,{type:Zn.error,error:bt.error}]}}else if(bt.matches)Ge=bt.matches;else{let{notFoundMatches:Le,error:ut,route:He}=yr(we.pathname);return{matches:Le,pendingActionResult:[He.id,{type:Zn.error,error:ut}]}}}let pt,gt=Gd(Ge,we);if(!gt.route.action&&!gt.route.lazy)pt={type:Zn.error,error:fo(405,{method:ge.method,pathname:we.pathname,routeId:gt.route.id})};else if(pt=(await mn("action",D,ge,[gt],Ge,null))[gt.route.id],ge.signal.aborted)return{shortCircuited:!0};if(gl(pt)){let bt;return _t&&_t.replace!=null?bt=_t.replace:bt=oI(pt.response.headers.get("Location"),new URL(ge.url),l)===D.location.pathname+D.location.search,await rn(ge,pt,!0,{submission:J,replace:bt}),{shortCircuited:!0}}if(wc(pt))throw fo(400,{type:"defer-action"});if(Po(pt)){let bt=dl(Ge,gt.route.id);return(_t&&_t.replace)!==!0&&(j=Vr.Push),{matches:Ge,pendingActionResult:[bt.route.id,pt]}}return{matches:Ge,pendingActionResult:[gt.route.id,pt]}}async function Vt(ge,we,J,Ge,rt,_t,Ot,pt,gt,bt,Le){let ut=rt||Zm(we,_t),He=_t||Ot||fI(ut),bn=!pe&&(!p.v7_partialHydration||!gt);if(Ge){if(bn){let vn=Dt(Le);Et(gr({navigation:ut},vn!==void 0?{actionData:vn}:{}),{flushSync:bt})}let nn=await Qn(J,we.pathname,ge.signal);if(nn.type==="aborted")return{shortCircuited:!0};if(nn.type==="error"){let vn=dl(nn.partialMatches).route.id;return{matches:nn.partialMatches,loaderData:{},errors:{[vn]:nn.error}}}else if(nn.matches)J=nn.matches;else{let{error:vn,notFoundMatches:or,route:hi}=yr(we.pathname);return{matches:or,loaderData:{},errors:{[hi.id]:vn}}}}let st=s||c,[de,Ze]=nI(n.history,D,J,He,we,p.v7_partialHydration&&gt===!0,p.v7_skipActionErrorRevalidation,ve,Ie,Re,Ee,ae,ee,st,l,Le);if(Qt(nn=>!(J&&J.some(vn=>vn.route.id===nn))||de&&de.some(vn=>vn.route.id===nn)),ke=++Ae,de.length===0&&Ze.length===0){let nn=hn();return St(we,gr({matches:J,loaderData:{},errors:Le&&Po(Le[1])?{[Le[0]]:Le[1].error}:null},lI(Le),nn?{fetchers:new Map(D.fetchers)}:{}),{flushSync:bt}),{shortCircuited:!0}}if(bn){let nn={};if(!Ge){nn.navigation=ut;let vn=Dt(Le);vn!==void 0&&(nn.actionData=vn)}Ze.length>0&&(nn.fetchers=Ht(Ze)),Et(nn,{flushSync:bt})}Ze.forEach(nn=>{Ve(nn.key),nn.controller&&xe.set(nn.key,nn.controller)});let It=()=>Ze.forEach(nn=>Ve(nn.key));F&&F.signal.addEventListener("abort",It);let{loaderResults:In,fetcherResults:Ft}=await Vn(D,J,de,Ze,ge);if(ge.signal.aborted)return{shortCircuited:!0};F&&F.signal.removeEventListener("abort",It),Ze.forEach(nn=>xe.delete(nn.key));let wt=Oh(In);if(wt)return await rn(ge,wt.result,!0,{replace:pt}),{shortCircuited:!0};if(wt=Oh(Ft),wt)return ee.add(wt.key),await rn(ge,wt.result,!0,{replace:pt}),{shortCircuited:!0};let{loaderData:zt,errors:Jn}=aI(D,J,In,Le,Ze,Ft,_e);_e.forEach((nn,vn)=>{nn.subscribe(or=>{(or||nn.done)&&_e.delete(vn)})}),p.v7_partialHydration&&gt&&D.errors&&(Jn=gr({},D.errors,Jn));let er=hn(),ir=pn(ke),Fn=er||ir||Ze.length>0;return gr({matches:J,loaderData:zt,errors:Jn},Fn?{fetchers:new Map(D.fetchers)}:{})}function Dt(ge){if(ge&&!Po(ge[1]))return{[ge[0]]:ge[1].data};if(D.actionData)return Object.keys(D.actionData).length===0?null:D.actionData}function Ht(ge){return ge.forEach(we=>{let J=D.fetchers.get(we.key),Ge=wd(void 0,J?J.data:void 0);D.fetchers.set(we.key,Ge)}),new Map(D.fetchers)}function sn(ge,we,J,Ge){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Ve(ge);let rt=(Ge&&Ge.flushSync)===!0,_t=s||c,Ot=zv(D.location,D.matches,l,p.v7_prependBasename,J,p.v7_relativeSplatPath,we,Ge==null?void 0:Ge.relative),pt=ul(_t,Ot,l),gt=hr(pt,_t,Ot);if(gt.active&&gt.matches&&(pt=gt.matches),!pt){L(ge,we,fo(404,{pathname:Ot}),{flushSync:rt});return}let{path:bt,submission:Le,error:ut}=eI(p.v7_normalizeFormMethod,!0,Ot,Ge);if(ut){L(ge,we,ut,{flushSync:rt});return}let He=Gd(pt,bt),bn=(Ge&&Ge.preventScrollReset)===!0;if(Le&&Ss(Le.formMethod)){ct(ge,we,bt,He,pt,gt.active,rt,bn,Le);return}ae.set(ge,{routeId:we,path:bt}),ce(ge,we,bt,He,pt,gt.active,rt,bn,Le)}async function ct(ge,we,J,Ge,rt,_t,Ot,pt,gt){q(),ae.delete(ge);function bt(yn){if(!yn.route.action&&!yn.route.lazy){let Wr=fo(405,{method:gt.formMethod,pathname:J,routeId:we});return L(ge,we,Wr,{flushSync:Ot}),!0}return!1}if(!_t&&bt(Ge))return;let Le=D.fetchers.get(ge);N(ge,zP(gt,Le),{flushSync:Ot});let ut=new AbortController,He=uu(n.history,J,ut.signal,gt);if(_t){let yn=await Qn(rt,new URL(He.url).pathname,He.signal,ge);if(yn.type==="aborted")return;if(yn.type==="error"){L(ge,we,yn.error,{flushSync:Ot});return}else if(yn.matches){if(rt=yn.matches,Ge=Gd(rt,J),bt(Ge))return}else{L(ge,we,fo(404,{pathname:J}),{flushSync:Ot});return}}xe.set(ge,ut);let bn=Ae,de=(await mn("action",D,He,[Ge],rt,ge))[Ge.route.id];if(He.signal.aborted){xe.get(ge)===ut&&xe.delete(ge);return}if(p.v7_fetcherPersist&&Ee.has(ge)){if(gl(de)||Po(de)){N(ge,pc(void 0));return}}else{if(gl(de))if(xe.delete(ge),ke>bn){N(ge,pc(void 0));return}else return ee.add(ge),N(ge,wd(gt)),rn(He,de,!1,{fetcherSubmission:gt,preventScrollReset:pt});if(Po(de)){L(ge,we,de.error);return}}if(wc(de))throw fo(400,{type:"defer-action"});let Ze=D.navigation.location||D.location,It=uu(n.history,Ze,ut.signal),In=s||c,Ft=D.navigation.state!=="idle"?ul(In,D.navigation.location,l):D.matches;On(Ft,"Didn't find any matches after fetcher action");let wt=++Ae;H.set(ge,wt);let zt=wd(gt,de.data);D.fetchers.set(ge,zt);let[Jn,er]=nI(n.history,D,Ft,gt,Ze,!1,p.v7_skipActionErrorRevalidation,ve,Ie,Re,Ee,ae,ee,In,l,[Ge.route.id,de]);er.filter(yn=>yn.key!==ge).forEach(yn=>{let Wr=yn.key,At=D.fetchers.get(Wr),Lo=wd(void 0,At?At.data:void 0);D.fetchers.set(Wr,Lo),Ve(Wr),yn.controller&&xe.set(Wr,yn.controller)}),Et({fetchers:new Map(D.fetchers)});let ir=()=>er.forEach(yn=>Ve(yn.key));ut.signal.addEventListener("abort",ir);let{loaderResults:Fn,fetcherResults:nn}=await Vn(D,Ft,Jn,er,It);if(ut.signal.aborted)return;ut.signal.removeEventListener("abort",ir),H.delete(ge),xe.delete(ge),er.forEach(yn=>xe.delete(yn.key));let vn=Oh(Fn);if(vn)return rn(It,vn.result,!1,{preventScrollReset:pt});if(vn=Oh(nn),vn)return ee.add(vn.key),rn(It,vn.result,!1,{preventScrollReset:pt});let{loaderData:or,errors:hi}=aI(D,Ft,Fn,void 0,er,nn,_e);if(D.fetchers.has(ge)){let yn=pc(de.data);D.fetchers.set(ge,yn)}pn(wt),D.navigation.state==="loading"&&wt>ke?(On(j,"Expected pending action"),F&&F.abort(),St(D.navigation.location,{matches:Ft,loaderData:or,errors:hi,fetchers:new Map(D.fetchers)})):(Et({errors:hi,loaderData:cI(D.loaderData,or,Ft,hi),fetchers:new Map(D.fetchers)}),ve=!1)}async function ce(ge,we,J,Ge,rt,_t,Ot,pt,gt){let bt=D.fetchers.get(ge);N(ge,wd(gt,bt?bt.data:void 0),{flushSync:Ot});let Le=new AbortController,ut=uu(n.history,J,Le.signal);if(_t){let de=await Qn(rt,new URL(ut.url).pathname,ut.signal,ge);if(de.type==="aborted")return;if(de.type==="error"){L(ge,we,de.error,{flushSync:Ot});return}else if(de.matches)rt=de.matches,Ge=Gd(rt,J);else{L(ge,we,fo(404,{pathname:J}),{flushSync:Ot});return}}xe.set(ge,Le);let He=Ae,st=(await mn("loader",D,ut,[Ge],rt,ge))[Ge.route.id];if(wc(st)&&(st=await cC(st,ut.signal,!0)||st),xe.get(ge)===Le&&xe.delete(ge),!ut.signal.aborted){if(Ee.has(ge)){N(ge,pc(void 0));return}if(gl(st))if(ke>He){N(ge,pc(void 0));return}else{ee.add(ge),await rn(ut,st,!1,{preventScrollReset:pt});return}if(Po(st)){L(ge,we,st.error);return}On(!wc(st),"Unhandled fetcher deferred data"),N(ge,pc(st.data))}}async function rn(ge,we,J,Ge){let{submission:rt,fetcherSubmission:_t,preventScrollReset:Ot,replace:pt}=Ge===void 0?{}:Ge;we.response.headers.has("X-Remix-Revalidate")&&(ve=!0);let gt=we.response.headers.get("Location");On(gt,"Expected a Location header on the redirect Response"),gt=oI(gt,new URL(ge.url),l);let bt=nf(D.location,gt,{_isRedirect:!0});if(t){let de=!1;if(we.response.headers.has("X-Remix-Reload-Document"))de=!0;else if(aC.test(gt)){const Ze=n.history.createURL(gt);de=Ze.origin!==e.location.origin||Tf(Ze.pathname,l)==null}if(de){pt?e.location.replace(gt):e.location.assign(gt);return}}F=null;let Le=pt===!0||we.response.headers.has("X-Remix-Replace")?Vr.Replace:Vr.Push,{formMethod:ut,formAction:He,formEncType:bn}=D.navigation;!rt&&!_t&&ut&&He&&bn&&(rt=fI(D.navigation));let st=rt||_t;if(SP.has(we.response.status)&&st&&Ss(st.formMethod))await lt(Le,bt,{submission:gr({},st,{formAction:gt}),preventScrollReset:Ot||Z,enableViewTransition:J?V:void 0});else{let de=Zm(bt,rt);await lt(Le,bt,{overrideNavigation:de,fetcherSubmission:_t,preventScrollReset:Ot||Z,enableViewTransition:J?V:void 0})}}async function mn(ge,we,J,Ge,rt,_t){let Ot,pt={};try{Ot=await PP(d,ge,we,J,Ge,rt,_t,o,i)}catch(gt){return Ge.forEach(bt=>{pt[bt.route.id]={type:Zn.error,error:gt}}),pt}for(let[gt,bt]of Object.entries(Ot))if(LP(bt)){let Le=bt.result;pt[gt]={type:Zn.redirect,response:OP(Le,J,gt,rt,l,p.v7_relativeSplatPath)}}else pt[gt]=await NP(bt);return pt}async function Vn(ge,we,J,Ge,rt){let _t=ge.matches,Ot=mn("loader",ge,rt,J,we,null),pt=Promise.all(Ge.map(async Le=>{if(Le.matches&&Le.match&&Le.controller){let He=(await mn("loader",ge,uu(n.history,Le.path,Le.controller.signal),[Le.match],Le.matches,Le.key))[Le.match.route.id];return{[Le.key]:He}}else return Promise.resolve({[Le.key]:{type:Zn.error,error:fo(404,{pathname:Le.path})}})})),gt=await Ot,bt=(await pt).reduce((Le,ut)=>Object.assign(Le,ut),{});return await Promise.all([VP(we,gt,rt.signal,_t,ge.loaderData),GP(we,bt,Ge)]),{loaderResults:gt,fetcherResults:bt}}function q(){ve=!0,Ie.push(...Qt()),ae.forEach((ge,we)=>{xe.has(we)&&Re.add(we),Ve(we)})}function N(ge,we,J){J===void 0&&(J={}),D.fetchers.set(ge,we),Et({fetchers:new Map(D.fetchers)},{flushSync:(J&&J.flushSync)===!0})}function L(ge,we,J,Ge){Ge===void 0&&(Ge={});let rt=dl(D.matches,we);Ce(ge),Et({errors:{[rt.route.id]:J},fetchers:new Map(D.fetchers)},{flushSync:(Ge&&Ge.flushSync)===!0})}function ne(ge){return ye.set(ge,(ye.get(ge)||0)+1),Ee.has(ge)&&Ee.delete(ge),D.fetchers.get(ge)||AP}function Ce(ge){let we=D.fetchers.get(ge);xe.has(ge)&&!(we&&we.state==="loading"&&H.has(ge))&&Ve(ge),ae.delete(ge),H.delete(ge),ee.delete(ge),p.v7_fetcherPersist&&Ee.delete(ge),Re.delete(ge),D.fetchers.delete(ge)}function Pe(ge){let we=(ye.get(ge)||0)-1;we<=0?(ye.delete(ge),Ee.add(ge),p.v7_fetcherPersist||Ce(ge)):ye.set(ge,we),Et({fetchers:new Map(D.fetchers)})}function Ve(ge){let we=xe.get(ge);we&&(we.abort(),xe.delete(ge))}function Lt(ge){for(let we of ge){let J=ne(we),Ge=pc(J.data);D.fetchers.set(we,Ge)}}function hn(){let ge=[],we=!1;for(let J of ee){let Ge=D.fetchers.get(J);On(Ge,"Expected fetcher: "+J),Ge.state==="loading"&&(ee.delete(J),ge.push(J),we=!0)}return Lt(ge),we}function pn(ge){let we=[];for(let[J,Ge]of H)if(Ge<ge){let rt=D.fetchers.get(J);On(rt,"Expected fetcher: "+J),rt.state==="loading"&&(Ve(J),H.delete(J),we.push(J))}return Lt(we),we.length>0}function xn(ge,we){let J=D.blockers.get(ge)||Id;return Je.get(ge)!==we&&Je.set(ge,we),J}function dn(ge){D.blockers.delete(ge),Je.delete(ge)}function Ln(ge,we){let J=D.blockers.get(ge)||Id;On(J.state==="unblocked"&&we.state==="blocked"||J.state==="blocked"&&we.state==="blocked"||J.state==="blocked"&&we.state==="proceeding"||J.state==="blocked"&&we.state==="unblocked"||J.state==="proceeding"&&we.state==="unblocked","Invalid blocker state transition: "+J.state+" -> "+we.state);let Ge=new Map(D.blockers);Ge.set(ge,we),Et({blockers:Ge})}function kr(ge){let{currentLocation:we,nextLocation:J,historyAction:Ge}=ge;if(Je.size===0)return;Je.size>1&&Nu(!1,"A router only supports one blocker at a time");let rt=Array.from(Je.entries()),[_t,Ot]=rt[rt.length-1],pt=D.blockers.get(_t);if(!(pt&&pt.state==="proceeding")&&Ot({currentLocation:we,nextLocation:J,historyAction:Ge}))return _t}function yr(ge){let we=fo(404,{pathname:ge}),J=s||c,{matches:Ge,route:rt}=uI(J);return Qt(),{notFoundMatches:Ge,route:rt,error:we}}function Qt(ge){let we=[];return _e.forEach((J,Ge)=>{(!ge||ge(Ge))&&(J.cancel(),we.push(Ge),_e.delete(Ge))}),we}function ei(ge,we,J){if(C=ge,w=we,x=J||null,!S&&D.navigation===Hm){S=!0;let Ge=Wt(D.location,D.matches);Ge!=null&&Et({restoreScrollPosition:Ge})}return()=>{C=null,w=null,x=null}}function Qe(ge,we){return x&&x(ge,we.map(Ge=>eP(Ge,D.loaderData)))||ge.key}function Tn(ge,we){if(C&&w){let J=Qe(ge,we);C[J]=w()}}function Wt(ge,we){if(C){let J=Qe(ge,we),Ge=C[J];if(typeof Ge=="number")return Ge}return null}function hr(ge,we,J){if(h)if(ge){if(Object.keys(ge[0].params).length>0)return{active:!0,matches:e0(we,J,l,!0)}}else return{active:!0,matches:e0(we,J,l,!0)||[]};return{active:!1,matches:null}}async function Qn(ge,we,J,Ge){if(!h)return{type:"success",matches:ge};let rt=ge;for(;;){let _t=s==null,Ot=s||c,pt=o;try{await h({signal:J,path:we,matches:rt,fetcherKey:Ge,patch:(Le,ut)=>{J.aborted||iI(Le,ut,Ot,pt,i)}})}catch(Le){return{type:"error",error:Le,partialMatches:rt}}finally{_t&&!J.aborted&&(c=[...c])}if(J.aborted)return{type:"aborted"};let gt=ul(Ot,we,l);if(gt)return{type:"success",matches:gt};let bt=e0(Ot,we,l,!0);if(!bt||rt.length===bt.length&&rt.every((Le,ut)=>Le.route.id===bt[ut].route.id))return{type:"success",matches:null};rt=bt}}function ti(ge){o={},s=op(ge,i,void 0,o)}function Lr(ge,we){let J=s==null;iI(ge,we,s||c,o,i),J&&(c=[...c],Et({}))}return _={get basename(){return l},get future(){return p},get state(){return D},get routes(){return c},get window(){return e},initialize:it,subscribe:Xt,enableScrollRestoration:ei,navigate:Pt,fetch:sn,revalidate:at,createHref:ge=>n.history.createHref(ge),encodeLocation:ge=>n.history.encodeLocation(ge),getFetcher:ne,deleteFetcher:Pe,dispose:Tt,getBlocker:xn,deleteBlocker:dn,patchRoutes:Lr,_internalFetchControllers:xe,_internalActiveDeferreds:_e,_internalSetRoutes:ti},_}function TP(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function zv(n,e,t,r,i,o,c,s){let l,d;if(c){l=[];for(let p of e)if(l.push(p),p.route.id===c){d=p;break}}else l=e,d=e[e.length-1];let h=mP(i||".",gP(l,o),Tf(n.pathname,t)||n.pathname,s==="path");if(i==null&&(h.search=n.search,h.hash=n.hash),(i==null||i===""||i===".")&&d){let p=lC(h.search);if(d.route.index&&!p)h.search=h.search?h.search.replace(/^\?/,"?index&"):"?index";else if(!d.route.index&&p){let g=new URLSearchParams(h.search),y=g.getAll("index");g.delete("index"),y.filter(x=>x).forEach(x=>g.append("index",x));let C=g.toString();h.search=C?"?"+C:""}}return r&&t!=="/"&&(h.pathname=h.pathname==="/"?t:yl([t,h.pathname])),Ef(h)}function eI(n,e,t,r){if(!r||!TP(r))return{path:t};if(r.formMethod&&!jP(r.formMethod))return{path:t,error:fo(405,{method:r.formMethod})};let i=()=>({path:t,error:fo(400,{type:"invalid-body"})}),o=r.formMethod||"get",c=n?o.toUpperCase():o.toLowerCase(),s=mk(t);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Ss(c))return i();let g=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((y,C)=>{let[x,w]=C;return""+y+x+"="+w+`
`},""):String(r.body);return{path:t,submission:{formMethod:c,formAction:s,formEncType:r.formEncType,formData:void 0,json:void 0,text:g}}}else if(r.formEncType==="application/json"){if(!Ss(c))return i();try{let g=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:t,submission:{formMethod:c,formAction:s,formEncType:r.formEncType,formData:void 0,json:g,text:void 0}}}catch{return i()}}}On(typeof FormData=="function","FormData is not available in this environment");let l,d;if(r.formData)l=Zv(r.formData),d=r.formData;else if(r.body instanceof FormData)l=Zv(r.body),d=r.body;else if(r.body instanceof URLSearchParams)l=r.body,d=sI(l);else if(r.body==null)l=new URLSearchParams,d=new FormData;else try{l=new URLSearchParams(r.body),d=sI(l)}catch{return i()}let h={formMethod:c,formAction:s,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:d,json:void 0,text:void 0};if(Ss(h.formMethod))return{path:t,submission:h};let p=Oc(t);return e&&p.search&&lC(p.search)&&l.append("index",""),p.search="?"+l,{path:Ef(p),submission:h}}function tI(n,e,t){t===void 0&&(t=!1);let r=n.findIndex(i=>i.route.id===e);return r>=0?n.slice(0,t?r+1:r):n}function nI(n,e,t,r,i,o,c,s,l,d,h,p,g,y,C,x){let w=x?Po(x[1])?x[1].error:x[1].data:void 0,S=n.createURL(e.location),E=n.createURL(i),R=t;o&&e.errors?R=tI(t,Object.keys(e.errors)[0],!0):x&&Po(x[1])&&(R=tI(t,x[0]));let k=x?x[1].statusCode:void 0,A=c&&k&&k>=400,_=R.filter((j,Z)=>{let{route:F}=j;if(F.lazy)return!0;if(F.loader==null)return!1;if(o)return Hv(F,e.loaderData,e.errors);if(_P(e.loaderData,e.matches[Z],j)||l.some(te=>te===j.route.id))return!0;let V=e.matches[Z],X=j;return rI(j,gr({currentUrl:S,currentParams:V.params,nextUrl:E,nextParams:X.params},r,{actionResult:w,actionStatus:k,defaultShouldRevalidate:A?!1:s||S.pathname+S.search===E.pathname+E.search||S.search!==E.search||pk(V,X)}))}),D=[];return p.forEach((j,Z)=>{if(o||!t.some(pe=>pe.route.id===j.routeId)||h.has(Z))return;let F=ul(y,j.path,C);if(!F){D.push({key:Z,routeId:j.routeId,path:j.path,matches:null,match:null,controller:null});return}let V=e.fetchers.get(Z),X=Gd(F,j.path),te=!1;g.has(Z)?te=!1:d.has(Z)?(d.delete(Z),te=!0):V&&V.state!=="idle"&&V.data===void 0?te=s:te=rI(X,gr({currentUrl:S,currentParams:e.matches[e.matches.length-1].params,nextUrl:E,nextParams:t[t.length-1].params},r,{actionResult:w,actionStatus:k,defaultShouldRevalidate:A?!1:s})),te&&D.push({key:Z,routeId:j.routeId,path:j.path,matches:F,match:X,controller:new AbortController})}),[_,D]}function Hv(n,e,t){if(n.lazy)return!0;if(!n.loader)return!1;let r=e!=null&&e[n.id]!==void 0,i=t!=null&&t[n.id]!==void 0;return!r&&i?!1:typeof n.loader=="function"&&n.loader.hydrate===!0?!0:!r&&!i}function _P(n,e,t){let r=!e||t.route.id!==e.route.id,i=n[t.route.id]===void 0;return r||i}function pk(n,e){let t=n.route.path;return n.pathname!==e.pathname||t!=null&&t.endsWith("*")&&n.params["*"]!==e.params["*"]}function rI(n,e){if(n.route.shouldRevalidate){let t=n.route.shouldRevalidate(e);if(typeof t=="boolean")return t}return e.defaultShouldRevalidate}function iI(n,e,t,r,i){var o;let c;if(n){let d=r[n];On(d,"No route found to patch children into: routeId = "+n),d.children||(d.children=[]),c=d.children}else c=t;let s=e.filter(d=>!c.some(h=>gk(d,h))),l=op(s,i,[n||"_","patch",String(((o=c)==null?void 0:o.length)||"0")],r);c.push(...l)}function gk(n,e){return"id"in n&&"id"in e&&n.id===e.id?!0:n.index===e.index&&n.path===e.path&&n.caseSensitive===e.caseSensitive?(!n.children||n.children.length===0)&&(!e.children||e.children.length===0)?!0:n.children.every((t,r)=>{var i;return(i=e.children)==null?void 0:i.some(o=>gk(t,o))}):!1}async function RP(n,e,t){if(!n.lazy)return;let r=await n.lazy();if(!n.lazy)return;let i=t[n.id];On(i,"No route found in manifest");let o={};for(let c in r){let l=i[c]!==void 0&&c!=="hasErrorBoundary";Nu(!l,'Route "'+i.id+'" has a static property "'+c+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+c+'" will be ignored.')),!l&&!QD.has(c)&&(o[c]=r[c])}Object.assign(i,o),Object.assign(i,gr({},e(i),{lazy:void 0}))}async function DP(n){let{matches:e}=n,t=e.filter(i=>i.shouldLoad);return(await Promise.all(t.map(i=>i.resolve()))).reduce((i,o,c)=>Object.assign(i,{[t[c].route.id]:o}),{})}async function PP(n,e,t,r,i,o,c,s,l,d){let h=o.map(y=>y.route.lazy?RP(y.route,l,s):void 0),p=o.map((y,C)=>{let x=h[C],w=i.some(E=>E.route.id===y.route.id);return gr({},y,{shouldLoad:w,resolve:async E=>(E&&r.method==="GET"&&(y.route.lazy||y.route.loader)&&(w=!0),w?MP(e,r,y,x,E,d):Promise.resolve({type:Zn.data,result:void 0}))})}),g=await n({matches:p,request:r,params:o[0].params,fetcherKey:c,context:d});try{await Promise.all(h)}catch{}return g}async function MP(n,e,t,r,i,o){let c,s,l=d=>{let h,p=new Promise((C,x)=>h=x);s=()=>h(),e.signal.addEventListener("abort",s);let g=C=>typeof d!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+n+'" [routeId: '+t.route.id+"]"))):d({request:e,params:t.params,context:o},...C!==void 0?[C]:[]),y=(async()=>{try{return{type:"data",result:await(i?i(x=>g(x)):g())}}catch(C){return{type:"error",result:C}}})();return Promise.race([y,p])};try{let d=t.route[n];if(r)if(d){let h,[p]=await Promise.all([l(d).catch(g=>{h=g}),r]);if(h!==void 0)throw h;c=p}else if(await r,d=t.route[n],d)c=await l(d);else if(n==="action"){let h=new URL(e.url),p=h.pathname+h.search;throw fo(405,{method:e.method,pathname:p,routeId:t.route.id})}else return{type:Zn.data,result:void 0};else if(d)c=await l(d);else{let h=new URL(e.url),p=h.pathname+h.search;throw fo(404,{pathname:p})}On(c.result!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+t.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(d){return{type:Zn.error,result:d}}finally{s&&e.signal.removeEventListener("abort",s)}return c}async function NP(n){let{result:e,type:t}=n;if(vk(e)){let p;try{let g=e.headers.get("Content-Type");g&&/\bapplication\/json\b/.test(g)?e.body==null?p=null:p=await e.json():p=await e.text()}catch(g){return{type:Zn.error,error:g}}return t===Zn.error?{type:Zn.error,error:new sp(e.status,e.statusText,p),statusCode:e.status,headers:e.headers}:{type:Zn.data,data:p,statusCode:e.status,headers:e.headers}}if(t===Zn.error){if(dI(e)){var r,i;if(e.data instanceof Error){var o,c;return{type:Zn.error,error:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(c=e.init)!=null&&c.headers?new Headers(e.init.headers):void 0}}return{type:Zn.error,error:new sp(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:rf(e)?e.status:void 0,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:Zn.error,error:e,statusCode:rf(e)?e.status:void 0}}if(UP(e)){var s,l;return{type:Zn.deferred,deferredData:e,statusCode:(s=e.init)==null?void 0:s.status,headers:((l=e.init)==null?void 0:l.headers)&&new Headers(e.init.headers)}}if(dI(e)){var d,h;return{type:Zn.data,data:e.data,statusCode:(d=e.init)==null?void 0:d.status,headers:(h=e.init)!=null&&h.headers?new Headers(e.init.headers):void 0}}return{type:Zn.data,data:e}}function OP(n,e,t,r,i,o){let c=n.headers.get("Location");if(On(c,"Redirects returned/thrown from loaders/actions must have a Location header"),!aC.test(c)){let s=r.slice(0,r.findIndex(l=>l.route.id===t)+1);c=zv(new URL(e.url),s,i,!0,c,o),n.headers.set("Location",c)}return n}function oI(n,e,t){if(aC.test(n)){let r=n,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),o=Tf(i.pathname,t)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return n}function uu(n,e,t,r){let i=n.createURL(mk(e)).toString(),o={signal:t};if(r&&Ss(r.formMethod)){let{formMethod:c,formEncType:s}=r;o.method=c.toUpperCase(),s==="application/json"?(o.headers=new Headers({"Content-Type":s}),o.body=JSON.stringify(r.json)):s==="text/plain"?o.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?o.body=Zv(r.formData):o.body=r.formData}return new Request(i,o)}function Zv(n){let e=new URLSearchParams;for(let[t,r]of n.entries())e.append(t,typeof r=="string"?r:r.name);return e}function sI(n){let e=new FormData;for(let[t,r]of n.entries())e.append(t,r);return e}function FP(n,e,t,r,i){let o={},c=null,s,l=!1,d={},h=t&&Po(t[1])?t[1].error:void 0;return n.forEach(p=>{if(!(p.route.id in e))return;let g=p.route.id,y=e[g];if(On(!gl(y),"Cannot handle redirect results in processLoaderData"),Po(y)){let C=y.error;h!==void 0&&(C=h,h=void 0),c=c||{};{let x=dl(n,g);c[x.route.id]==null&&(c[x.route.id]=C)}o[g]=void 0,l||(l=!0,s=rf(y.error)?y.error.status:500),y.headers&&(d[g]=y.headers)}else wc(y)?(r.set(g,y.deferredData),o[g]=y.deferredData.data,y.statusCode!=null&&y.statusCode!==200&&!l&&(s=y.statusCode),y.headers&&(d[g]=y.headers)):(o[g]=y.data,y.statusCode&&y.statusCode!==200&&!l&&(s=y.statusCode),y.headers&&(d[g]=y.headers))}),h!==void 0&&t&&(c={[t[0]]:h},o[t[0]]=void 0),{loaderData:o,errors:c,statusCode:s||200,loaderHeaders:d}}function aI(n,e,t,r,i,o,c){let{loaderData:s,errors:l}=FP(e,t,r,c);return i.forEach(d=>{let{key:h,match:p,controller:g}=d,y=o[h];if(On(y,"Did not find corresponding fetcher result"),!(g&&g.signal.aborted))if(Po(y)){let C=dl(n.matches,p==null?void 0:p.route.id);l&&l[C.route.id]||(l=gr({},l,{[C.route.id]:y.error})),n.fetchers.delete(h)}else if(gl(y))On(!1,"Unhandled fetcher revalidation redirect");else if(wc(y))On(!1,"Unhandled fetcher deferred data");else{let C=pc(y.data);n.fetchers.set(h,C)}}),{loaderData:s,errors:l}}function cI(n,e,t,r){let i=gr({},e);for(let o of t){let c=o.route.id;if(e.hasOwnProperty(c)?e[c]!==void 0&&(i[c]=e[c]):n[c]!==void 0&&o.route.loader&&(i[c]=n[c]),r&&r.hasOwnProperty(c))break}return i}function lI(n){return n?Po(n[1])?{actionData:{}}:{actionData:{[n[0]]:n[1].data}}:{}}function dl(n,e){return(e?n.slice(0,n.findIndex(r=>r.route.id===e)+1):[...n]).reverse().find(r=>r.route.hasErrorBoundary===!0)||n[0]}function uI(n){let e=n.length===1?n[0]:n.find(t=>t.index||!t.path||t.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function fo(n,e){let{pathname:t,routeId:r,method:i,type:o,message:c}=e===void 0?{}:e,s="Unknown Server Error",l="Unknown @remix-run/router error";return n===400?(s="Bad Request",i&&t&&r?l="You made a "+i+' request to "'+t+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?l="defer() is not supported in actions":o==="invalid-body"&&(l="Unable to encode submission body")):n===403?(s="Forbidden",l='Route "'+r+'" does not match URL "'+t+'"'):n===404?(s="Not Found",l='No route matches URL "'+t+'"'):n===405&&(s="Method Not Allowed",i&&t&&r?l="You made a "+i.toUpperCase()+' request to "'+t+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(l='Invalid request method "'+i.toUpperCase()+'"')),new sp(n||500,s,new Error(l),!0)}function Oh(n){let e=Object.entries(n);for(let t=e.length-1;t>=0;t--){let[r,i]=e[t];if(gl(i))return{key:r,result:i}}}function mk(n){let e=typeof n=="string"?Oc(n):n;return Ef(gr({},e,{hash:""}))}function BP(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function LP(n){return vk(n.result)&&wP.has(n.result.status)}function wc(n){return n.type===Zn.deferred}function Po(n){return n.type===Zn.error}function gl(n){return(n&&n.type)===Zn.redirect}function dI(n){return typeof n=="object"&&n!=null&&"type"in n&&"data"in n&&"init"in n&&n.type==="DataWithResponseInit"}function UP(n){let e=n;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function vk(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function jP(n){return IP.has(n.toLowerCase())}function Ss(n){return xP.has(n.toLowerCase())}async function VP(n,e,t,r,i){let o=Object.entries(e);for(let c=0;c<o.length;c++){let[s,l]=o[c],d=n.find(g=>(g==null?void 0:g.route.id)===s);if(!d)continue;let h=r.find(g=>g.route.id===d.route.id),p=h!=null&&!pk(h,d)&&(i&&i[d.route.id])!==void 0;wc(l)&&p&&await cC(l,t,!1).then(g=>{g&&(e[s]=g)})}}async function GP(n,e,t){for(let r=0;r<t.length;r++){let{key:i,routeId:o,controller:c}=t[r],s=e[i];n.find(d=>(d==null?void 0:d.route.id)===o)&&wc(s)&&(On(c,"Expected an AbortController for revalidating fetcher deferred result"),await cC(s,c.signal,!0).then(d=>{d&&(e[i]=d)}))}}async function cC(n,e,t){if(t===void 0&&(t=!1),!await n.deferredData.resolveData(e)){if(t)try{return{type:Zn.data,data:n.deferredData.unwrappedData}}catch(i){return{type:Zn.error,error:i}}return{type:Zn.data,data:n.deferredData.data}}}function lC(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function Gd(n,e){let t=typeof e=="string"?Oc(e).search:e.search;if(n[n.length-1].route.index&&lC(t||""))return n[n.length-1];let r=dk(n);return r[r.length-1]}function fI(n){let{formMethod:e,formAction:t,formEncType:r,text:i,formData:o,json:c}=n;if(!(!e||!t||!r)){if(i!=null)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:t,formEncType:r,formData:o,json:void 0,text:void 0};if(c!==void 0)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:c,text:void 0}}}function Zm(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function WP(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function wd(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function zP(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function pc(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function HP(n,e){try{let t=n.sessionStorage.getItem(hk);if(t){let r=JSON.parse(t);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function ZP(n,e){if(e.size>0){let t={};for(let[r,i]of e)t[r]=[...i];try{n.sessionStorage.setItem(hk,JSON.stringify(t))}catch(r){Nu(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xv(){return Xv=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Xv.apply(this,arguments)}const yk=B.createContext(null),Ck=B.createContext(null),xk=B.createContext(null),uC=B.createContext(null),zp=B.createContext({outlet:null,matches:[],isDataRoute:!1}),bk=B.createContext(null);function dC(){return B.useContext(uC)!=null}function Ik(){return dC()||On(!1),B.useContext(uC).location}function XP(n,e,t,r){dC()||On(!1);let{navigator:i}=B.useContext(xk),{matches:o}=B.useContext(zp),c=o[o.length-1],s=c?c.params:{};c&&c.pathname;let l=c?c.pathnameBase:"/";c&&c.route;let d=Ik(),h;h=d;let p=h.pathname||"/",g=p;if(l!=="/"){let x=l.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(x.length).join("/")}let y=ul(n,{pathname:g});return QP(y&&y.map(x=>Object.assign({},x,{params:Object.assign({},s,x.params),pathname:yl([l,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:yl([l,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),o,t,r)}function $P(){let n=n3(),e=rf(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},e),t?B.createElement("pre",{style:i},t):null,null)}const KP=B.createElement($P,null);class qP extends B.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?B.createElement(zp.Provider,{value:this.props.routeContext},B.createElement(bk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YP(n){let{routeContext:e,match:t,children:r}=n,i=B.useContext(yk);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),B.createElement(zp.Provider,{value:e},r)}function QP(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var o;if(!t)return null;if(t.errors)n=t.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,s=(i=t)==null?void 0:i.errors;if(s!=null){let h=c.findIndex(p=>p.route.id&&(s==null?void 0:s[p.route.id])!==void 0);h>=0||On(!1),c=c.slice(0,Math.min(c.length,h+1))}let l=!1,d=-1;if(t&&r&&r.v7_partialHydration)for(let h=0;h<c.length;h++){let p=c[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:g,errors:y}=t,C=p.route.loader&&g[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||C){l=!0,d>=0?c=c.slice(0,d+1):c=[c[0]];break}}}return c.reduceRight((h,p,g)=>{let y,C=!1,x=null,w=null;t&&(y=s&&p.route.id?s[p.route.id]:void 0,x=p.route.errorElement||KP,l&&(d<0&&g===0?(r3("route-fallback"),C=!0,w=null):d===g&&(C=!0,w=p.route.hydrateFallbackElement||null)));let S=e.concat(c.slice(0,g+1)),E=()=>{let R;return y?R=x:C?R=w:p.route.Component?R=B.createElement(p.route.Component,null):p.route.element?R=p.route.element:R=h,B.createElement(YP,{match:p,routeContext:{outlet:h,matches:S,isDataRoute:t!=null},children:R})};return t&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?B.createElement(qP,{location:t.location,revalidation:t.revalidation,component:x,error:y,children:E(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):E()},null)}var wk=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(wk||{});function JP(n){let e=B.useContext(Ck);return e||On(!1),e}function e3(n){let e=B.useContext(zp);return e||On(!1),e}function t3(n){let e=e3(),t=e.matches[e.matches.length-1];return t.route.id||On(!1),t.route.id}function n3(){var n;let e=B.useContext(bk),t=JP(wk.UseRouteError),r=t3();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}const hI={};function r3(n,e,t){hI[n]||(hI[n]=!0)}function i3(n,e){n==null||n.v7_startTransition,(n==null?void 0:n.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function o3(n){let{basename:e="/",children:t=null,location:r,navigationType:i=Vr.Pop,navigator:o,static:c=!1,future:s}=n;dC()&&On(!1);let l=e.replace(/^\/*/,"/"),d=B.useMemo(()=>({basename:l,navigator:o,static:c,future:Xv({v7_relativeSplatPath:!1},s)}),[l,s,o,c]);typeof r=="string"&&(r=Oc(r));let{pathname:h="/",search:p="",hash:g="",state:y=null,key:C="default"}=r,x=B.useMemo(()=>{let w=Tf(h,l);return w==null?null:{location:{pathname:w,search:p,hash:g,state:y,key:C},navigationType:i}},[l,h,p,g,y,C,i]);return x==null?null:B.createElement(xk.Provider,{value:d},B.createElement(uC.Provider,{children:t,value:x}))}new Promise(()=>{});function s3(n){let e={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(e,{element:B.createElement(n.Component),Component:void 0}),n.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:B.createElement(n.HydrateFallback),HydrateFallback:void 0}),n.ErrorBoundary&&Object.assign(e,{errorElement:B.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ap(){return ap=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ap.apply(this,arguments)}const a3="6";try{window.__reactRouterVersion=a3}catch{}function c3(n,e){return EP({basename:void 0,future:ap({},void 0,{v7_prependBasename:!0}),history:KD({window:void 0}),hydrationData:l3(),routes:n,mapRouteProperties:s3,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function l3(){var n;let e=(n=window)==null?void 0:n.__staticRouterHydrationData;return e&&e.errors&&(e=ap({},e,{errors:u3(e.errors)})),e}function u3(n){if(!n)return null;let e=Object.entries(n),t={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")t[r]=new sp(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let c=new o(i.message);c.stack="",t[r]=c}catch{}}if(t[r]==null){let o=new Error(i.message);o.stack="",t[r]=o}}else t[r]=i;return t}const d3=B.createContext({isTransitioning:!1}),f3=B.createContext(new Map),h3="startTransition",pI=jD[h3],p3="flushSync",gI=$D[p3];function g3(n){pI?pI(n):n()}function Sd(n){gI?gI(n):n()}class m3{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",t(r))}})}}function v3(n){let{fallbackElement:e,router:t,future:r}=n,[i,o]=B.useState(t.state),[c,s]=B.useState(),[l,d]=B.useState({isTransitioning:!1}),[h,p]=B.useState(),[g,y]=B.useState(),[C,x]=B.useState(),w=B.useRef(new Map),{v7_startTransition:S}=r||{},E=B.useCallback(j=>{S?g3(j):j()},[S]),R=B.useCallback((j,Z)=>{let{deletedFetchers:F,flushSync:V,viewTransitionOpts:X}=Z;j.fetchers.forEach((pe,ve)=>{pe.data!==void 0&&w.current.set(ve,pe.data)}),F.forEach(pe=>w.current.delete(pe));let te=t.window==null||t.window.document==null||typeof t.window.document.startViewTransition!="function";if(!X||te){V?Sd(()=>o(j)):E(()=>o(j));return}if(V){Sd(()=>{g&&(h&&h.resolve(),g.skipTransition()),d({isTransitioning:!0,flushSync:!0,currentLocation:X.currentLocation,nextLocation:X.nextLocation})});let pe=t.window.document.startViewTransition(()=>{Sd(()=>o(j))});pe.finished.finally(()=>{Sd(()=>{p(void 0),y(void 0),s(void 0),d({isTransitioning:!1})})}),Sd(()=>y(pe));return}g?(h&&h.resolve(),g.skipTransition(),x({state:j,currentLocation:X.currentLocation,nextLocation:X.nextLocation})):(s(j),d({isTransitioning:!0,flushSync:!1,currentLocation:X.currentLocation,nextLocation:X.nextLocation}))},[t.window,g,h,w,E]);B.useLayoutEffect(()=>t.subscribe(R),[t,R]),B.useEffect(()=>{l.isTransitioning&&!l.flushSync&&p(new m3)},[l]),B.useEffect(()=>{if(h&&c&&t.window){let j=c,Z=h.promise,F=t.window.document.startViewTransition(async()=>{E(()=>o(j)),await Z});F.finished.finally(()=>{p(void 0),y(void 0),s(void 0),d({isTransitioning:!1})}),y(F)}},[E,c,h,t.window]),B.useEffect(()=>{h&&c&&i.location.key===c.location.key&&h.resolve()},[h,g,i.location,c]),B.useEffect(()=>{!l.isTransitioning&&C&&(s(C.state),d({isTransitioning:!0,flushSync:!1,currentLocation:C.currentLocation,nextLocation:C.nextLocation}),x(void 0))},[l.isTransitioning,C]),B.useEffect(()=>{},[]);let k=B.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:j=>t.navigate(j),push:(j,Z,F)=>t.navigate(j,{state:Z,preventScrollReset:F==null?void 0:F.preventScrollReset}),replace:(j,Z,F)=>t.navigate(j,{replace:!0,state:Z,preventScrollReset:F==null?void 0:F.preventScrollReset})}),[t]),A=t.basename||"/",_=B.useMemo(()=>({router:t,navigator:k,static:!1,basename:A}),[t,k,A]),D=B.useMemo(()=>({v7_relativeSplatPath:t.future.v7_relativeSplatPath}),[t.future.v7_relativeSplatPath]);return B.useEffect(()=>i3(r,t.future),[r,t.future]),B.createElement(B.Fragment,null,B.createElement(yk.Provider,{value:_},B.createElement(Ck.Provider,{value:i},B.createElement(f3.Provider,{value:w.current},B.createElement(d3.Provider,{value:l},B.createElement(o3,{basename:A,location:i.location,navigationType:i.historyAction,navigator:k,future:D},i.initialized||t.future.v7_partialHydration?B.createElement(y3,{routes:t.routes,future:t.future,state:i}):e))))),null)}const y3=B.memo(C3);function C3(n){let{routes:e,future:t,state:r}=n;return XP(e,void 0,r,t)}var mI;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(mI||(mI={}));var vI;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(vI||(vI={}));const Sk=n=>{const e=typeof n=="function",t=B.useRef(n);B.useEffect(()=>{t.current=n}),B.useEffect(()=>{if(e){const r=i=>{const o=t.current(i);if(typeof o=="string")return i.preventDefault(),i.returnValue=o;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[e])};var Xm={exports:{}},yI;function x3(){return yI||(yI=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(l,d,h){this.fn=l,this.context=d,this.once=h||!1}function o(l,d,h,p,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var y=new i(h,p||l,g),C=t?t+d:d;return l._events[C]?l._events[C].fn?l._events[C]=[l._events[C],y]:l._events[C].push(y):(l._events[C]=y,l._eventsCount++),l}function c(l,d){--l._eventsCount===0?l._events=new r:delete l._events[d]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var d=[],h,p;if(this._eventsCount===0)return d;for(p in h=this._events)e.call(h,p)&&d.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(h)):d},s.prototype.listeners=function(d){var h=t?t+d:d,p=this._events[h];if(!p)return[];if(p.fn)return[p.fn];for(var g=0,y=p.length,C=new Array(y);g<y;g++)C[g]=p[g].fn;return C},s.prototype.listenerCount=function(d){var h=t?t+d:d,p=this._events[h];return p?p.fn?1:p.length:0},s.prototype.emit=function(d,h,p,g,y,C){var x=t?t+d:d;if(!this._events[x])return!1;var w=this._events[x],S=arguments.length,E,R;if(w.fn){switch(w.once&&this.removeListener(d,w.fn,void 0,!0),S){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,h),!0;case 3:return w.fn.call(w.context,h,p),!0;case 4:return w.fn.call(w.context,h,p,g),!0;case 5:return w.fn.call(w.context,h,p,g,y),!0;case 6:return w.fn.call(w.context,h,p,g,y,C),!0}for(R=1,E=new Array(S-1);R<S;R++)E[R-1]=arguments[R];w.fn.apply(w.context,E)}else{var k=w.length,A;for(R=0;R<k;R++)switch(w[R].once&&this.removeListener(d,w[R].fn,void 0,!0),S){case 1:w[R].fn.call(w[R].context);break;case 2:w[R].fn.call(w[R].context,h);break;case 3:w[R].fn.call(w[R].context,h,p);break;case 4:w[R].fn.call(w[R].context,h,p,g);break;default:if(!E)for(A=1,E=new Array(S-1);A<S;A++)E[A-1]=arguments[A];w[R].fn.apply(w[R].context,E)}}return!0},s.prototype.on=function(d,h,p){return o(this,d,h,p,!1)},s.prototype.once=function(d,h,p){return o(this,d,h,p,!0)},s.prototype.removeListener=function(d,h,p,g){var y=t?t+d:d;if(!this._events[y])return this;if(!h)return c(this,y),this;var C=this._events[y];if(C.fn)C.fn===h&&(!g||C.once)&&(!p||C.context===p)&&c(this,y);else{for(var x=0,w=[],S=C.length;x<S;x++)(C[x].fn!==h||g&&!C[x].once||p&&C[x].context!==p)&&w.push(C[x]);w.length?this._events[y]=w.length===1?w[0]:w:c(this,y)}return this},s.prototype.removeAllListeners=function(d){var h;return d?(h=t?t+d:d,this._events[h]&&c(this,h)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=t,s.EventEmitter=s,n.exports=s}(Xm)),Xm.exports}var b3=x3();const Hp=Nc(b3);var $m={},Ad={},CI;function I3(){if(CI)return Ad;CI=1,Ad.byteLength=s,Ad.toByteArray=d,Ad.fromByteArray=g;for(var n=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=r.length;i<o;++i)n[i]=r[i],e[r.charCodeAt(i)]=i;e[45]=62,e[95]=63;function c(y){var C=y.length;if(C%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=y.indexOf("=");x===-1&&(x=C);var w=x===C?0:4-x%4;return[x,w]}function s(y){var C=c(y),x=C[0],w=C[1];return(x+w)*3/4-w}function l(y,C,x){return(C+x)*3/4-x}function d(y){var C,x=c(y),w=x[0],S=x[1],E=new t(l(y,w,S)),R=0,k=S>0?w-4:w,A;for(A=0;A<k;A+=4)C=e[y.charCodeAt(A)]<<18|e[y.charCodeAt(A+1)]<<12|e[y.charCodeAt(A+2)]<<6|e[y.charCodeAt(A+3)],E[R++]=C>>16&255,E[R++]=C>>8&255,E[R++]=C&255;return S===2&&(C=e[y.charCodeAt(A)]<<2|e[y.charCodeAt(A+1)]>>4,E[R++]=C&255),S===1&&(C=e[y.charCodeAt(A)]<<10|e[y.charCodeAt(A+1)]<<4|e[y.charCodeAt(A+2)]>>2,E[R++]=C>>8&255,E[R++]=C&255),E}function h(y){return n[y>>18&63]+n[y>>12&63]+n[y>>6&63]+n[y&63]}function p(y,C,x){for(var w,S=[],E=C;E<x;E+=3)w=(y[E]<<16&16711680)+(y[E+1]<<8&65280)+(y[E+2]&255),S.push(h(w));return S.join("")}function g(y){for(var C,x=y.length,w=x%3,S=[],E=16383,R=0,k=x-w;R<k;R+=E)S.push(p(y,R,R+E>k?k:R+E));return w===1?(C=y[x-1],S.push(n[C>>2]+n[C<<4&63]+"==")):w===2&&(C=(y[x-2]<<8)+y[x-1],S.push(n[C>>10]+n[C>>4&63]+n[C<<2&63]+"=")),S.join("")}return Ad}var Fh={},xI;function w3(){if(xI)return Fh;xI=1;/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */return Fh.read=function(n,e,t,r,i){var o,c,s=i*8-r-1,l=(1<<s)-1,d=l>>1,h=-7,p=t?i-1:0,g=t?-1:1,y=n[e+p];for(p+=g,o=y&(1<<-h)-1,y>>=-h,h+=s;h>0;o=o*256+n[e+p],p+=g,h-=8);for(c=o&(1<<-h)-1,o>>=-h,h+=r;h>0;c=c*256+n[e+p],p+=g,h-=8);if(o===0)o=1-d;else{if(o===l)return c?NaN:(y?-1:1)*(1/0);c=c+Math.pow(2,r),o=o-d}return(y?-1:1)*c*Math.pow(2,o-r)},Fh.write=function(n,e,t,r,i,o){var c,s,l,d=o*8-i-1,h=(1<<d)-1,p=h>>1,g=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=r?0:o-1,C=r?1:-1,x=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,c=h):(c=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-c))<1&&(c--,l*=2),c+p>=1?e+=g/l:e+=g*Math.pow(2,1-p),e*l>=2&&(c++,l/=2),c+p>=h?(s=0,c=h):c+p>=1?(s=(e*l-1)*Math.pow(2,i),c=c+p):(s=e*Math.pow(2,p-1)*Math.pow(2,i),c=0));i>=8;n[t+y]=s&255,y+=C,s/=256,i-=8);for(c=c<<i|s,d+=i;d>0;n[t+y]=c&255,y+=C,c/=256,d-=8);n[t+y-C]|=x*128},Fh}var bI;function S3(){return bI||(bI=1,function(n){const e=I3(),t=w3(),r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=s,n.SlowBuffer=E,n.INSPECT_MAX_BYTES=50;const i=2147483647;n.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=o(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const q=new Uint8Array(1),N={foo:function(){return 42}};return Object.setPrototypeOf(N,Uint8Array.prototype),Object.setPrototypeOf(q,N),q.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function c(q){if(q>i)throw new RangeError('The value "'+q+'" is invalid for option "size"');const N=new Uint8Array(q);return Object.setPrototypeOf(N,s.prototype),N}function s(q,N,L){if(typeof q=="number"){if(typeof N=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(q)}return l(q,N,L)}s.poolSize=8192;function l(q,N,L){if(typeof q=="string")return g(q,N);if(ArrayBuffer.isView(q))return C(q);if(q==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof q);if(ct(q,ArrayBuffer)||q&&ct(q.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ct(q,SharedArrayBuffer)||q&&ct(q.buffer,SharedArrayBuffer)))return x(q,N,L);if(typeof q=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ne=q.valueOf&&q.valueOf();if(ne!=null&&ne!==q)return s.from(ne,N,L);const Ce=w(q);if(Ce)return Ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof q[Symbol.toPrimitive]=="function")return s.from(q[Symbol.toPrimitive]("string"),N,L);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof q)}s.from=function(q,N,L){return l(q,N,L)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function d(q){if(typeof q!="number")throw new TypeError('"size" argument must be of type number');if(q<0)throw new RangeError('The value "'+q+'" is invalid for option "size"')}function h(q,N,L){return d(q),q<=0?c(q):N!==void 0?typeof L=="string"?c(q).fill(N,L):c(q).fill(N):c(q)}s.alloc=function(q,N,L){return h(q,N,L)};function p(q){return d(q),c(q<0?0:S(q)|0)}s.allocUnsafe=function(q){return p(q)},s.allocUnsafeSlow=function(q){return p(q)};function g(q,N){if((typeof N!="string"||N==="")&&(N="utf8"),!s.isEncoding(N))throw new TypeError("Unknown encoding: "+N);const L=R(q,N)|0;let ne=c(L);const Ce=ne.write(q,N);return Ce!==L&&(ne=ne.slice(0,Ce)),ne}function y(q){const N=q.length<0?0:S(q.length)|0,L=c(N);for(let ne=0;ne<N;ne+=1)L[ne]=q[ne]&255;return L}function C(q){if(ct(q,Uint8Array)){const N=new Uint8Array(q);return x(N.buffer,N.byteOffset,N.byteLength)}return y(q)}function x(q,N,L){if(N<0||q.byteLength<N)throw new RangeError('"offset" is outside of buffer bounds');if(q.byteLength<N+(L||0))throw new RangeError('"length" is outside of buffer bounds');let ne;return N===void 0&&L===void 0?ne=new Uint8Array(q):L===void 0?ne=new Uint8Array(q,N):ne=new Uint8Array(q,N,L),Object.setPrototypeOf(ne,s.prototype),ne}function w(q){if(s.isBuffer(q)){const N=S(q.length)|0,L=c(N);return L.length===0||q.copy(L,0,0,N),L}if(q.length!==void 0)return typeof q.length!="number"||ce(q.length)?c(0):y(q);if(q.type==="Buffer"&&Array.isArray(q.data))return y(q.data)}function S(q){if(q>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return q|0}function E(q){return+q!=q&&(q=0),s.alloc(+q)}s.isBuffer=function(N){return N!=null&&N._isBuffer===!0&&N!==s.prototype},s.compare=function(N,L){if(ct(N,Uint8Array)&&(N=s.from(N,N.offset,N.byteLength)),ct(L,Uint8Array)&&(L=s.from(L,L.offset,L.byteLength)),!s.isBuffer(N)||!s.isBuffer(L))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(N===L)return 0;let ne=N.length,Ce=L.length;for(let Pe=0,Ve=Math.min(ne,Ce);Pe<Ve;++Pe)if(N[Pe]!==L[Pe]){ne=N[Pe],Ce=L[Pe];break}return ne<Ce?-1:Ce<ne?1:0},s.isEncoding=function(N){switch(String(N).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(N,L){if(!Array.isArray(N))throw new TypeError('"list" argument must be an Array of Buffers');if(N.length===0)return s.alloc(0);let ne;if(L===void 0)for(L=0,ne=0;ne<N.length;++ne)L+=N[ne].length;const Ce=s.allocUnsafe(L);let Pe=0;for(ne=0;ne<N.length;++ne){let Ve=N[ne];if(ct(Ve,Uint8Array))Pe+Ve.length>Ce.length?(s.isBuffer(Ve)||(Ve=s.from(Ve)),Ve.copy(Ce,Pe)):Uint8Array.prototype.set.call(Ce,Ve,Pe);else if(s.isBuffer(Ve))Ve.copy(Ce,Pe);else throw new TypeError('"list" argument must be an Array of Buffers');Pe+=Ve.length}return Ce};function R(q,N){if(s.isBuffer(q))return q.length;if(ArrayBuffer.isView(q)||ct(q,ArrayBuffer))return q.byteLength;if(typeof q!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof q);const L=q.length,ne=arguments.length>2&&arguments[2]===!0;if(!ne&&L===0)return 0;let Ce=!1;for(;;)switch(N){case"ascii":case"latin1":case"binary":return L;case"utf8":case"utf-8":return Gt(q).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L*2;case"hex":return L>>>1;case"base64":return Ht(q).length;default:if(Ce)return ne?-1:Gt(q).length;N=(""+N).toLowerCase(),Ce=!0}}s.byteLength=R;function k(q,N,L){let ne=!1;if((N===void 0||N<0)&&(N=0),N>this.length||((L===void 0||L>this.length)&&(L=this.length),L<=0)||(L>>>=0,N>>>=0,L<=N))return"";for(q||(q="utf8");;)switch(q){case"hex":return Ae(this,N,L);case"utf8":case"utf-8":return pe(this,N,L);case"ascii":return Re(this,N,L);case"latin1":case"binary":return xe(this,N,L);case"base64":return te(this,N,L);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ke(this,N,L);default:if(ne)throw new TypeError("Unknown encoding: "+q);q=(q+"").toLowerCase(),ne=!0}}s.prototype._isBuffer=!0;function A(q,N,L){const ne=q[N];q[N]=q[L],q[L]=ne}s.prototype.swap16=function(){const N=this.length;if(N%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let L=0;L<N;L+=2)A(this,L,L+1);return this},s.prototype.swap32=function(){const N=this.length;if(N%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let L=0;L<N;L+=4)A(this,L,L+3),A(this,L+1,L+2);return this},s.prototype.swap64=function(){const N=this.length;if(N%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let L=0;L<N;L+=8)A(this,L,L+7),A(this,L+1,L+6),A(this,L+2,L+5),A(this,L+3,L+4);return this},s.prototype.toString=function(){const N=this.length;return N===0?"":arguments.length===0?pe(this,0,N):k.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(N){if(!s.isBuffer(N))throw new TypeError("Argument must be a Buffer");return this===N?!0:s.compare(this,N)===0},s.prototype.inspect=function(){let N="";const L=n.INSPECT_MAX_BYTES;return N=this.toString("hex",0,L).replace(/(.{2})/g,"$1 ").trim(),this.length>L&&(N+=" ... "),"<Buffer "+N+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(N,L,ne,Ce,Pe){if(ct(N,Uint8Array)&&(N=s.from(N,N.offset,N.byteLength)),!s.isBuffer(N))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof N);if(L===void 0&&(L=0),ne===void 0&&(ne=N?N.length:0),Ce===void 0&&(Ce=0),Pe===void 0&&(Pe=this.length),L<0||ne>N.length||Ce<0||Pe>this.length)throw new RangeError("out of range index");if(Ce>=Pe&&L>=ne)return 0;if(Ce>=Pe)return-1;if(L>=ne)return 1;if(L>>>=0,ne>>>=0,Ce>>>=0,Pe>>>=0,this===N)return 0;let Ve=Pe-Ce,Lt=ne-L;const hn=Math.min(Ve,Lt),pn=this.slice(Ce,Pe),xn=N.slice(L,ne);for(let dn=0;dn<hn;++dn)if(pn[dn]!==xn[dn]){Ve=pn[dn],Lt=xn[dn];break}return Ve<Lt?-1:Lt<Ve?1:0};function _(q,N,L,ne,Ce){if(q.length===0)return-1;if(typeof L=="string"?(ne=L,L=0):L>2147483647?L=2147483647:L<-2147483648&&(L=-2147483648),L=+L,ce(L)&&(L=Ce?0:q.length-1),L<0&&(L=q.length+L),L>=q.length){if(Ce)return-1;L=q.length-1}else if(L<0)if(Ce)L=0;else return-1;if(typeof N=="string"&&(N=s.from(N,ne)),s.isBuffer(N))return N.length===0?-1:D(q,N,L,ne,Ce);if(typeof N=="number")return N=N&255,typeof Uint8Array.prototype.indexOf=="function"?Ce?Uint8Array.prototype.indexOf.call(q,N,L):Uint8Array.prototype.lastIndexOf.call(q,N,L):D(q,[N],L,ne,Ce);throw new TypeError("val must be string, number or Buffer")}function D(q,N,L,ne,Ce){let Pe=1,Ve=q.length,Lt=N.length;if(ne!==void 0&&(ne=String(ne).toLowerCase(),ne==="ucs2"||ne==="ucs-2"||ne==="utf16le"||ne==="utf-16le")){if(q.length<2||N.length<2)return-1;Pe=2,Ve/=2,Lt/=2,L/=2}function hn(xn,dn){return Pe===1?xn[dn]:xn.readUInt16BE(dn*Pe)}let pn;if(Ce){let xn=-1;for(pn=L;pn<Ve;pn++)if(hn(q,pn)===hn(N,xn===-1?0:pn-xn)){if(xn===-1&&(xn=pn),pn-xn+1===Lt)return xn*Pe}else xn!==-1&&(pn-=pn-xn),xn=-1}else for(L+Lt>Ve&&(L=Ve-Lt),pn=L;pn>=0;pn--){let xn=!0;for(let dn=0;dn<Lt;dn++)if(hn(q,pn+dn)!==hn(N,dn)){xn=!1;break}if(xn)return pn}return-1}s.prototype.includes=function(N,L,ne){return this.indexOf(N,L,ne)!==-1},s.prototype.indexOf=function(N,L,ne){return _(this,N,L,ne,!0)},s.prototype.lastIndexOf=function(N,L,ne){return _(this,N,L,ne,!1)};function j(q,N,L,ne){L=Number(L)||0;const Ce=q.length-L;ne?(ne=Number(ne),ne>Ce&&(ne=Ce)):ne=Ce;const Pe=N.length;ne>Pe/2&&(ne=Pe/2);let Ve;for(Ve=0;Ve<ne;++Ve){const Lt=parseInt(N.substr(Ve*2,2),16);if(ce(Lt))return Ve;q[L+Ve]=Lt}return Ve}function Z(q,N,L,ne){return sn(Gt(N,q.length-L),q,L,ne)}function F(q,N,L,ne){return sn(Vt(N),q,L,ne)}function V(q,N,L,ne){return sn(Ht(N),q,L,ne)}function X(q,N,L,ne){return sn(Dt(N,q.length-L),q,L,ne)}s.prototype.write=function(N,L,ne,Ce){if(L===void 0)Ce="utf8",ne=this.length,L=0;else if(ne===void 0&&typeof L=="string")Ce=L,ne=this.length,L=0;else if(isFinite(L))L=L>>>0,isFinite(ne)?(ne=ne>>>0,Ce===void 0&&(Ce="utf8")):(Ce=ne,ne=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Pe=this.length-L;if((ne===void 0||ne>Pe)&&(ne=Pe),N.length>0&&(ne<0||L<0)||L>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ce||(Ce="utf8");let Ve=!1;for(;;)switch(Ce){case"hex":return j(this,N,L,ne);case"utf8":case"utf-8":return Z(this,N,L,ne);case"ascii":case"latin1":case"binary":return F(this,N,L,ne);case"base64":return V(this,N,L,ne);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,N,L,ne);default:if(Ve)throw new TypeError("Unknown encoding: "+Ce);Ce=(""+Ce).toLowerCase(),Ve=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function te(q,N,L){return N===0&&L===q.length?e.fromByteArray(q):e.fromByteArray(q.slice(N,L))}function pe(q,N,L){L=Math.min(q.length,L);const ne=[];let Ce=N;for(;Ce<L;){const Pe=q[Ce];let Ve=null,Lt=Pe>239?4:Pe>223?3:Pe>191?2:1;if(Ce+Lt<=L){let hn,pn,xn,dn;switch(Lt){case 1:Pe<128&&(Ve=Pe);break;case 2:hn=q[Ce+1],(hn&192)===128&&(dn=(Pe&31)<<6|hn&63,dn>127&&(Ve=dn));break;case 3:hn=q[Ce+1],pn=q[Ce+2],(hn&192)===128&&(pn&192)===128&&(dn=(Pe&15)<<12|(hn&63)<<6|pn&63,dn>2047&&(dn<55296||dn>57343)&&(Ve=dn));break;case 4:hn=q[Ce+1],pn=q[Ce+2],xn=q[Ce+3],(hn&192)===128&&(pn&192)===128&&(xn&192)===128&&(dn=(Pe&15)<<18|(hn&63)<<12|(pn&63)<<6|xn&63,dn>65535&&dn<1114112&&(Ve=dn))}}Ve===null?(Ve=65533,Lt=1):Ve>65535&&(Ve-=65536,ne.push(Ve>>>10&1023|55296),Ve=56320|Ve&1023),ne.push(Ve),Ce+=Lt}return Ie(ne)}const ve=4096;function Ie(q){const N=q.length;if(N<=ve)return String.fromCharCode.apply(String,q);let L="",ne=0;for(;ne<N;)L+=String.fromCharCode.apply(String,q.slice(ne,ne+=ve));return L}function Re(q,N,L){let ne="";L=Math.min(q.length,L);for(let Ce=N;Ce<L;++Ce)ne+=String.fromCharCode(q[Ce]&127);return ne}function xe(q,N,L){let ne="";L=Math.min(q.length,L);for(let Ce=N;Ce<L;++Ce)ne+=String.fromCharCode(q[Ce]);return ne}function Ae(q,N,L){const ne=q.length;(!N||N<0)&&(N=0),(!L||L<0||L>ne)&&(L=ne);let Ce="";for(let Pe=N;Pe<L;++Pe)Ce+=rn[q[Pe]];return Ce}function ke(q,N,L){const ne=q.slice(N,L);let Ce="";for(let Pe=0;Pe<ne.length-1;Pe+=2)Ce+=String.fromCharCode(ne[Pe]+ne[Pe+1]*256);return Ce}s.prototype.slice=function(N,L){const ne=this.length;N=~~N,L=L===void 0?ne:~~L,N<0?(N+=ne,N<0&&(N=0)):N>ne&&(N=ne),L<0?(L+=ne,L<0&&(L=0)):L>ne&&(L=ne),L<N&&(L=N);const Ce=this.subarray(N,L);return Object.setPrototypeOf(Ce,s.prototype),Ce};function H(q,N,L){if(q%1!==0||q<0)throw new RangeError("offset is not uint");if(q+N>L)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(N,L,ne){N=N>>>0,L=L>>>0,ne||H(N,L,this.length);let Ce=this[N],Pe=1,Ve=0;for(;++Ve<L&&(Pe*=256);)Ce+=this[N+Ve]*Pe;return Ce},s.prototype.readUintBE=s.prototype.readUIntBE=function(N,L,ne){N=N>>>0,L=L>>>0,ne||H(N,L,this.length);let Ce=this[N+--L],Pe=1;for(;L>0&&(Pe*=256);)Ce+=this[N+--L]*Pe;return Ce},s.prototype.readUint8=s.prototype.readUInt8=function(N,L){return N=N>>>0,L||H(N,1,this.length),this[N]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(N,L){return N=N>>>0,L||H(N,2,this.length),this[N]|this[N+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(N,L){return N=N>>>0,L||H(N,2,this.length),this[N]<<8|this[N+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(N,L){return N=N>>>0,L||H(N,4,this.length),(this[N]|this[N+1]<<8|this[N+2]<<16)+this[N+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(N,L){return N=N>>>0,L||H(N,4,this.length),this[N]*16777216+(this[N+1]<<16|this[N+2]<<8|this[N+3])},s.prototype.readBigUInt64LE=mn(function(N){N=N>>>0,St(N,"offset");const L=this[N],ne=this[N+7];(L===void 0||ne===void 0)&&Pt(N,this.length-8);const Ce=L+this[++N]*2**8+this[++N]*2**16+this[++N]*2**24,Pe=this[++N]+this[++N]*2**8+this[++N]*2**16+ne*2**24;return BigInt(Ce)+(BigInt(Pe)<<BigInt(32))}),s.prototype.readBigUInt64BE=mn(function(N){N=N>>>0,St(N,"offset");const L=this[N],ne=this[N+7];(L===void 0||ne===void 0)&&Pt(N,this.length-8);const Ce=L*2**24+this[++N]*2**16+this[++N]*2**8+this[++N],Pe=this[++N]*2**24+this[++N]*2**16+this[++N]*2**8+ne;return(BigInt(Ce)<<BigInt(32))+BigInt(Pe)}),s.prototype.readIntLE=function(N,L,ne){N=N>>>0,L=L>>>0,ne||H(N,L,this.length);let Ce=this[N],Pe=1,Ve=0;for(;++Ve<L&&(Pe*=256);)Ce+=this[N+Ve]*Pe;return Pe*=128,Ce>=Pe&&(Ce-=Math.pow(2,8*L)),Ce},s.prototype.readIntBE=function(N,L,ne){N=N>>>0,L=L>>>0,ne||H(N,L,this.length);let Ce=L,Pe=1,Ve=this[N+--Ce];for(;Ce>0&&(Pe*=256);)Ve+=this[N+--Ce]*Pe;return Pe*=128,Ve>=Pe&&(Ve-=Math.pow(2,8*L)),Ve},s.prototype.readInt8=function(N,L){return N=N>>>0,L||H(N,1,this.length),this[N]&128?(255-this[N]+1)*-1:this[N]},s.prototype.readInt16LE=function(N,L){N=N>>>0,L||H(N,2,this.length);const ne=this[N]|this[N+1]<<8;return ne&32768?ne|4294901760:ne},s.prototype.readInt16BE=function(N,L){N=N>>>0,L||H(N,2,this.length);const ne=this[N+1]|this[N]<<8;return ne&32768?ne|4294901760:ne},s.prototype.readInt32LE=function(N,L){return N=N>>>0,L||H(N,4,this.length),this[N]|this[N+1]<<8|this[N+2]<<16|this[N+3]<<24},s.prototype.readInt32BE=function(N,L){return N=N>>>0,L||H(N,4,this.length),this[N]<<24|this[N+1]<<16|this[N+2]<<8|this[N+3]},s.prototype.readBigInt64LE=mn(function(N){N=N>>>0,St(N,"offset");const L=this[N],ne=this[N+7];(L===void 0||ne===void 0)&&Pt(N,this.length-8);const Ce=this[N+4]+this[N+5]*2**8+this[N+6]*2**16+(ne<<24);return(BigInt(Ce)<<BigInt(32))+BigInt(L+this[++N]*2**8+this[++N]*2**16+this[++N]*2**24)}),s.prototype.readBigInt64BE=mn(function(N){N=N>>>0,St(N,"offset");const L=this[N],ne=this[N+7];(L===void 0||ne===void 0)&&Pt(N,this.length-8);const Ce=(L<<24)+this[++N]*2**16+this[++N]*2**8+this[++N];return(BigInt(Ce)<<BigInt(32))+BigInt(this[++N]*2**24+this[++N]*2**16+this[++N]*2**8+ne)}),s.prototype.readFloatLE=function(N,L){return N=N>>>0,L||H(N,4,this.length),t.read(this,N,!0,23,4)},s.prototype.readFloatBE=function(N,L){return N=N>>>0,L||H(N,4,this.length),t.read(this,N,!1,23,4)},s.prototype.readDoubleLE=function(N,L){return N=N>>>0,L||H(N,8,this.length),t.read(this,N,!0,52,8)},s.prototype.readDoubleBE=function(N,L){return N=N>>>0,L||H(N,8,this.length),t.read(this,N,!1,52,8)};function ee(q,N,L,ne,Ce,Pe){if(!s.isBuffer(q))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>Ce||N<Pe)throw new RangeError('"value" argument is out of bounds');if(L+ne>q.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(N,L,ne,Ce){if(N=+N,L=L>>>0,ne=ne>>>0,!Ce){const Lt=Math.pow(2,8*ne)-1;ee(this,N,L,ne,Lt,0)}let Pe=1,Ve=0;for(this[L]=N&255;++Ve<ne&&(Pe*=256);)this[L+Ve]=N/Pe&255;return L+ne},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(N,L,ne,Ce){if(N=+N,L=L>>>0,ne=ne>>>0,!Ce){const Lt=Math.pow(2,8*ne)-1;ee(this,N,L,ne,Lt,0)}let Pe=ne-1,Ve=1;for(this[L+Pe]=N&255;--Pe>=0&&(Ve*=256);)this[L+Pe]=N/Ve&255;return L+ne},s.prototype.writeUint8=s.prototype.writeUInt8=function(N,L,ne){return N=+N,L=L>>>0,ne||ee(this,N,L,1,255,0),this[L]=N&255,L+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(N,L,ne){return N=+N,L=L>>>0,ne||ee(this,N,L,2,65535,0),this[L]=N&255,this[L+1]=N>>>8,L+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(N,L,ne){return N=+N,L=L>>>0,ne||ee(this,N,L,2,65535,0),this[L]=N>>>8,this[L+1]=N&255,L+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(N,L,ne){return N=+N,L=L>>>0,ne||ee(this,N,L,4,4294967295,0),this[L+3]=N>>>24,this[L+2]=N>>>16,this[L+1]=N>>>8,this[L]=N&255,L+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(N,L,ne){return N=+N,L=L>>>0,ne||ee(this,N,L,4,4294967295,0),this[L]=N>>>24,this[L+1]=N>>>16,this[L+2]=N>>>8,this[L+3]=N&255,L+4};function ae(q,N,L,ne,Ce){Et(N,ne,Ce,q,L,7);let Pe=Number(N&BigInt(4294967295));q[L++]=Pe,Pe=Pe>>8,q[L++]=Pe,Pe=Pe>>8,q[L++]=Pe,Pe=Pe>>8,q[L++]=Pe;let Ve=Number(N>>BigInt(32)&BigInt(4294967295));return q[L++]=Ve,Ve=Ve>>8,q[L++]=Ve,Ve=Ve>>8,q[L++]=Ve,Ve=Ve>>8,q[L++]=Ve,L}function ye(q,N,L,ne,Ce){Et(N,ne,Ce,q,L,7);let Pe=Number(N&BigInt(4294967295));q[L+7]=Pe,Pe=Pe>>8,q[L+6]=Pe,Pe=Pe>>8,q[L+5]=Pe,Pe=Pe>>8,q[L+4]=Pe;let Ve=Number(N>>BigInt(32)&BigInt(4294967295));return q[L+3]=Ve,Ve=Ve>>8,q[L+2]=Ve,Ve=Ve>>8,q[L+1]=Ve,Ve=Ve>>8,q[L]=Ve,L+8}s.prototype.writeBigUInt64LE=mn(function(N,L=0){return ae(this,N,L,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=mn(function(N,L=0){return ye(this,N,L,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(N,L,ne,Ce){if(N=+N,L=L>>>0,!Ce){const hn=Math.pow(2,8*ne-1);ee(this,N,L,ne,hn-1,-hn)}let Pe=0,Ve=1,Lt=0;for(this[L]=N&255;++Pe<ne&&(Ve*=256);)N<0&&Lt===0&&this[L+Pe-1]!==0&&(Lt=1),this[L+Pe]=(N/Ve>>0)-Lt&255;return L+ne},s.prototype.writeIntBE=function(N,L,ne,Ce){if(N=+N,L=L>>>0,!Ce){const hn=Math.pow(2,8*ne-1);ee(this,N,L,ne,hn-1,-hn)}let Pe=ne-1,Ve=1,Lt=0;for(this[L+Pe]=N&255;--Pe>=0&&(Ve*=256);)N<0&&Lt===0&&this[L+Pe+1]!==0&&(Lt=1),this[L+Pe]=(N/Ve>>0)-Lt&255;return L+ne},s.prototype.writeInt8=function(N,L,ne){return N=+N,L=L>>>0,ne||ee(this,N,L,1,127,-128),N<0&&(N=255+N+1),this[L]=N&255,L+1},s.prototype.writeInt16LE=function(N,L,ne){return N=+N,L=L>>>0,ne||ee(this,N,L,2,32767,-32768),this[L]=N&255,this[L+1]=N>>>8,L+2},s.prototype.writeInt16BE=function(N,L,ne){return N=+N,L=L>>>0,ne||ee(this,N,L,2,32767,-32768),this[L]=N>>>8,this[L+1]=N&255,L+2},s.prototype.writeInt32LE=function(N,L,ne){return N=+N,L=L>>>0,ne||ee(this,N,L,4,2147483647,-2147483648),this[L]=N&255,this[L+1]=N>>>8,this[L+2]=N>>>16,this[L+3]=N>>>24,L+4},s.prototype.writeInt32BE=function(N,L,ne){return N=+N,L=L>>>0,ne||ee(this,N,L,4,2147483647,-2147483648),N<0&&(N=4294967295+N+1),this[L]=N>>>24,this[L+1]=N>>>16,this[L+2]=N>>>8,this[L+3]=N&255,L+4},s.prototype.writeBigInt64LE=mn(function(N,L=0){return ae(this,N,L,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=mn(function(N,L=0){return ye(this,N,L,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ee(q,N,L,ne,Ce,Pe){if(L+ne>q.length)throw new RangeError("Index out of range");if(L<0)throw new RangeError("Index out of range")}function _e(q,N,L,ne,Ce){return N=+N,L=L>>>0,Ce||Ee(q,N,L,4),t.write(q,N,L,ne,23,4),L+4}s.prototype.writeFloatLE=function(N,L,ne){return _e(this,N,L,!0,ne)},s.prototype.writeFloatBE=function(N,L,ne){return _e(this,N,L,!1,ne)};function Je(q,N,L,ne,Ce){return N=+N,L=L>>>0,Ce||Ee(q,N,L,8),t.write(q,N,L,ne,52,8),L+8}s.prototype.writeDoubleLE=function(N,L,ne){return Je(this,N,L,!0,ne)},s.prototype.writeDoubleBE=function(N,L,ne){return Je(this,N,L,!1,ne)},s.prototype.copy=function(N,L,ne,Ce){if(!s.isBuffer(N))throw new TypeError("argument should be a Buffer");if(ne||(ne=0),!Ce&&Ce!==0&&(Ce=this.length),L>=N.length&&(L=N.length),L||(L=0),Ce>0&&Ce<ne&&(Ce=ne),Ce===ne||N.length===0||this.length===0)return 0;if(L<0)throw new RangeError("targetStart out of bounds");if(ne<0||ne>=this.length)throw new RangeError("Index out of range");if(Ce<0)throw new RangeError("sourceEnd out of bounds");Ce>this.length&&(Ce=this.length),N.length-L<Ce-ne&&(Ce=N.length-L+ne);const Pe=Ce-ne;return this===N&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(L,ne,Ce):Uint8Array.prototype.set.call(N,this.subarray(ne,Ce),L),Pe},s.prototype.fill=function(N,L,ne,Ce){if(typeof N=="string"){if(typeof L=="string"?(Ce=L,L=0,ne=this.length):typeof ne=="string"&&(Ce=ne,ne=this.length),Ce!==void 0&&typeof Ce!="string")throw new TypeError("encoding must be a string");if(typeof Ce=="string"&&!s.isEncoding(Ce))throw new TypeError("Unknown encoding: "+Ce);if(N.length===1){const Ve=N.charCodeAt(0);(Ce==="utf8"&&Ve<128||Ce==="latin1")&&(N=Ve)}}else typeof N=="number"?N=N&255:typeof N=="boolean"&&(N=Number(N));if(L<0||this.length<L||this.length<ne)throw new RangeError("Out of range index");if(ne<=L)return this;L=L>>>0,ne=ne===void 0?this.length:ne>>>0,N||(N=0);let Pe;if(typeof N=="number")for(Pe=L;Pe<ne;++Pe)this[Pe]=N;else{const Ve=s.isBuffer(N)?N:s.from(N,Ce),Lt=Ve.length;if(Lt===0)throw new TypeError('The value "'+N+'" is invalid for argument "value"');for(Pe=0;Pe<ne-L;++Pe)this[Pe+L]=Ve[Pe%Lt]}return this};const me={};function it(q,N,L){me[q]=class extends L{constructor(){super(),Object.defineProperty(this,"message",{value:N.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${q}]`,this.stack,delete this.name}get code(){return q}set code(Ce){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ce,writable:!0})}toString(){return`${this.name} [${q}]: ${this.message}`}}}it("ERR_BUFFER_OUT_OF_BOUNDS",function(q){return q?`${q} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),it("ERR_INVALID_ARG_TYPE",function(q,N){return`The "${q}" argument must be of type number. Received type ${typeof N}`},TypeError),it("ERR_OUT_OF_RANGE",function(q,N,L){let ne=`The value of "${q}" is out of range.`,Ce=L;return Number.isInteger(L)&&Math.abs(L)>2**32?Ce=Tt(String(L)):typeof L=="bigint"&&(Ce=String(L),(L>BigInt(2)**BigInt(32)||L<-(BigInt(2)**BigInt(32)))&&(Ce=Tt(Ce)),Ce+="n"),ne+=` It must be ${N}. Received ${Ce}`,ne},RangeError);function Tt(q){let N="",L=q.length;const ne=q[0]==="-"?1:0;for(;L>=ne+4;L-=3)N=`_${q.slice(L-3,L)}${N}`;return`${q.slice(0,L)}${N}`}function Xt(q,N,L){St(N,"offset"),(q[N]===void 0||q[N+L]===void 0)&&Pt(N,q.length-(L+1))}function Et(q,N,L,ne,Ce,Pe){if(q>L||q<N){const Ve=typeof N=="bigint"?"n":"";let Lt;throw N===0||N===BigInt(0)?Lt=`>= 0${Ve} and < 2${Ve} ** ${(Pe+1)*8}${Ve}`:Lt=`>= -(2${Ve} ** ${(Pe+1)*8-1}${Ve}) and < 2 ** ${(Pe+1)*8-1}${Ve}`,new me.ERR_OUT_OF_RANGE("value",Lt,q)}Xt(ne,Ce,Pe)}function St(q,N){if(typeof q!="number")throw new me.ERR_INVALID_ARG_TYPE(N,"number",q)}function Pt(q,N,L){throw Math.floor(q)!==q?(St(q,L),new me.ERR_OUT_OF_RANGE("offset","an integer",q)):N<0?new me.ERR_BUFFER_OUT_OF_BOUNDS:new me.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${N}`,q)}const at=/[^+/0-9A-Za-z-_]/g;function lt(q){if(q=q.split("=")[0],q=q.trim().replace(at,""),q.length<2)return"";for(;q.length%4!==0;)q=q+"=";return q}function Gt(q,N){N=N||1/0;let L;const ne=q.length;let Ce=null;const Pe=[];for(let Ve=0;Ve<ne;++Ve){if(L=q.charCodeAt(Ve),L>55295&&L<57344){if(!Ce){if(L>56319){(N-=3)>-1&&Pe.push(239,191,189);continue}else if(Ve+1===ne){(N-=3)>-1&&Pe.push(239,191,189);continue}Ce=L;continue}if(L<56320){(N-=3)>-1&&Pe.push(239,191,189),Ce=L;continue}L=(Ce-55296<<10|L-56320)+65536}else Ce&&(N-=3)>-1&&Pe.push(239,191,189);if(Ce=null,L<128){if((N-=1)<0)break;Pe.push(L)}else if(L<2048){if((N-=2)<0)break;Pe.push(L>>6|192,L&63|128)}else if(L<65536){if((N-=3)<0)break;Pe.push(L>>12|224,L>>6&63|128,L&63|128)}else if(L<1114112){if((N-=4)<0)break;Pe.push(L>>18|240,L>>12&63|128,L>>6&63|128,L&63|128)}else throw new Error("Invalid code point")}return Pe}function Vt(q){const N=[];for(let L=0;L<q.length;++L)N.push(q.charCodeAt(L)&255);return N}function Dt(q,N){let L,ne,Ce;const Pe=[];for(let Ve=0;Ve<q.length&&!((N-=2)<0);++Ve)L=q.charCodeAt(Ve),ne=L>>8,Ce=L%256,Pe.push(Ce),Pe.push(ne);return Pe}function Ht(q){return e.toByteArray(lt(q))}function sn(q,N,L,ne){let Ce;for(Ce=0;Ce<ne&&!(Ce+L>=N.length||Ce>=q.length);++Ce)N[Ce+L]=q[Ce];return Ce}function ct(q,N){return q instanceof N||q!=null&&q.constructor!=null&&q.constructor.name!=null&&q.constructor.name===N.name}function ce(q){return q!==q}const rn=function(){const q="0123456789abcdef",N=new Array(256);for(let L=0;L<16;++L){const ne=L*16;for(let Ce=0;Ce<16;++Ce)N[ne+Ce]=q[L]+q[Ce]}return N}();function mn(q){return typeof BigInt>"u"?Vn:q}function Vn(){throw new Error("BigInt not supported")}}($m)),$m}var Mi=S3(),Wd=(n=>(n[n.BINARY=0]="BINARY",n[n.ECHO=1]="ECHO",n[n.RCP=2]="RCP",n[n.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",n[n.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",n[n.STATUS=5]="STATUS",n[n.TIMING_MARK=6]="TIMING_MARK",n[n.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",n[n.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",n[n.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",n[n.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",n[n.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",n[n.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",n[n.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",n[n.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",n[n.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",n[n.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",n[n.EXTENDED_ASCII=17]="EXTENDED_ASCII",n[n.LOGOUT=18]="LOGOUT",n[n.BYTE_MACRO=19]="BYTE_MACRO",n[n.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",n[n.SUPDUP=21]="SUPDUP",n[n.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",n[n.SEND_LOCATION=23]="SEND_LOCATION",n[n.TERMINAL_TYPE=24]="TERMINAL_TYPE",n[n.END_OF_RECORD=25]="END_OF_RECORD",n[n.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",n[n.OUTPUT_MARKING=27]="OUTPUT_MARKING",n[n.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",n[n.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",n[n.X_3_PAD=30]="X_3_PAD",n[n.NAWS=31]="NAWS",n[n.TERMINAL_SPEED=32]="TERMINAL_SPEED",n[n.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",n[n.LINEMODE=34]="LINEMODE",n[n.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",n[n.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",n[n.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",n[n.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",n[n.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",n[n.TN3270E=40]="TN3270E",n[n.XAUTH=41]="XAUTH",n[n.CHARSET=42]="CHARSET",n[n.RSP=43]="RSP",n[n.COM_PORT_OPTION=44]="COM_PORT_OPTION",n[n.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",n[n.START_TLS=46]="START_TLS",n[n.KERMIT=47]="KERMIT",n[n.SEND_URL=48]="SEND_URL",n[n.FORWARD_X=49]="FORWARD_X",n[n.PRAGMA_LOGON=138]="PRAGMA_LOGON",n[n.GMCP=201]="GMCP",n))(Wd||{}),zd=(n=>(n[n.SE=240]="SE",n[n.NOP=241]="NOP",n[n.DM=242]="DM",n[n.BRK=243]="BRK",n[n.IP=244]="IP",n[n.AO=245]="AO",n[n.AYT=246]="AYT",n[n.EC=247]="EC",n[n.EL=248]="EL",n[n.GA=249]="GA",n[n.SB=250]="SB",n[n.WILL=251]="WILL",n[n.WONT=252]="WONT",n[n.DO=253]="DO",n[n.DONT=254]="DONT",n[n.IAC=255]="IAC",n))(zd||{});let A3=class{constructor(e){oe(this,"ws");this.ws=e}on(e,t){if(e==="data"){this.ws.onmessage=i=>{t(i.data)};return}const r="on"+e;this[r]=t}write(e){this.ws.send(e)}};class k3 extends Hp{constructor(t){super();oe(this,"state");oe(this,"buffer");oe(this,"subBuffer");oe(this,"iacSEBuffer",Mi.Buffer.from([255,240]));oe(this,"negotiationByte",0);oe(this,"stream");this.state=0,this.buffer=Mi.Buffer.alloc(0),this.subBuffer=Mi.Buffer.alloc(0),t&&t.on("data",r=>this.parse(r)),this.stream=t}parse(t){for(this.buffer=Mi.Buffer.concat([this.buffer,Mi.Buffer.from(t)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const t=this.buffer.indexOf(255);if(t===-1){this.emit("data",this.buffer),this.buffer=Mi.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,t)),this.buffer=this.buffer.slice(t),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const t=this.buffer[1];switch(this.buffer=this.buffer.slice(2),t){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=Mi.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=t,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const t=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",t,r),this.state=0,!1}handleSubnegotiation(){let t=this.buffer.indexOf(this.iacSEBuffer);if(t===-1)return!0;this.state=0;let r=this.buffer.slice(0,t);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(t+2),!1}handleGmcp(t){const r=t.toString(),[i,o]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,o)}sendNegotiation(t,r){this.stream.write(Mi.Buffer.from([255,t,r]))}sendGmcp(t,r){const i=t+" "+r,o=Mi.Buffer.from(i),c=Mi.Buffer.concat([Mi.Buffer.from([255,250]),Mi.Buffer.from([201]),o,this.iacSEBuffer]);this.stream.write(c)}sendTerminalType(t){const r=Mi.Buffer.from(t),i=Mi.Buffer.concat([Mi.Buffer.from([255,250]),Mi.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}function E3({onlyFirst:n=!1}={}){const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(t,n?void 0:"g")}const T3=E3();function _3(n){if(typeof n!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof n}\``);return n.replace(T3,"")}class R3{constructor(e){oe(this,"editors");oe(this,"channel");this.client=e,this.editors=new Map,this.channel=new BroadcastChannel("editor"),this.setupChannelListeners()}openEditorWindow(e){console.log("Opening editor window for session:",e);const t=e.reference,r=this.editors.get(t);if(r&&r.state===1&&r.window&&!r.window.closed)r.window.focus();else{const i=encodeURIComponent(t),o=window.open(`/editor?reference=${i}`,"_blank"),c={...e,window:o,state:0};this.editors.set(t,c),o&&o.focus()}}saveEditorWindow(e){const t={reference:e.reference,type:e.type,"content*":""};this.client.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",t,e.contents)}setupChannelListeners(){this.channel.onmessage=e=>{console.log("Editor window message:",e);const{type:t,id:r,session:i}=e.data;switch(t){case"ready":console.log("Editor window ready, id:",r);const o=this.editors.get(r);if(o){o.state=1;const{window:s,...l}=o;this.channel.postMessage({type:"load",session:l})}else console.error(`No session found for id: ${r}`);break;case"save":console.log("Saving editor window with session:",i),this.saveEditorWindow(i);break;case"close":console.log("Closing editor window, id:",r);const c=this.editors.get(r);c&&(c.state=2);break}}}shutdown(){console.log("Shutting down EditorManager"),this.editors.forEach((e,t)=>{try{e.state===1&&e.window&&(console.log(`Closing editor window for ${t}`),e.window.close(),this.channel.postMessage({type:"shutdown",id:t}))}catch(r){console.error(`Error closing editor window ${t}:`,r)}}),this.editors.clear(),console.log("Closing broadcast channel"),this.channel.close(),console.log("EditorManager shutdown complete")}}class Yn{constructor(e){oe(this,"packageName");oe(this,"packageVersion",1);oe(this,"client");this.client=e}get enabled(){return!0}sendData(e,t){this.client.sendGmcp(this.packageName+"."+e,JSON.stringify(t))}shutdown(){}}class D3 extends Yn{constructor(){super(...arguments);oe(this,"packageName","Auth.Autologin")}handleToken(t){localStorage.setItem("LoginRefreshToken",t)}sendLogin(){var t=localStorage.getItem("LoginRefreshToken");t&&this.sendData("Login",t)}}class Ak extends Yn{constructor(){super(...arguments);oe(this,"packageName","Char")}handleName(t){this.client.worldData.playerId=t.name,this.client.worldData.playerName=t.fullname,this.client.emit("statustext",`Logged in as ${t.fullname}`)}handleVitals(t){console.log("Received Char.Vitals:",t),this.client.emit("vitals",t)}handleStatusVars(t){console.log("Received Char.StatusVars:",t),this.client.emit("statusVars",t)}handleStatus(t){console.log("Received Char.Status:",t),this.client.emit("statusUpdate",t)}sendLogin(t,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:t,password:r}))}}class P3 extends Yn{constructor(){super(...arguments);oe(this,"packageName","Char.Offer")}handleOffer(t){console.log("Received Char.Offer:",t),this.client.emit("offer",t)}sendOfferRequest(){this.sendData("Offer",{})}}class M3 extends Yn{constructor(){super(...arguments);oe(this,"packageName","Char.Prompt")}handlePrompt(t){console.log("Received Char.Prompt:",t),this.client.emit("prompt",t)}sendPromptRequest(){this.sendData("Prompt",{})}}class N3 extends Yn{constructor(){super(...arguments);oe(this,"packageName","Char.Status")}handleStatus(t){console.log("Received Char.Status:",t),this.client.emit("status",t)}sendStatusRequest(){this.sendData("Status",{})}}class O3 extends Yn{constructor(){super(...arguments);oe(this,"packageName","Char.Status.AffectedBy")}handleAffectedBy(t){console.log("Received Char.Status.AffectedBy:",t),this.client.emit("statusAffectedBy",t)}sendAffectedByRequest(){this.sendData("AffectedBy",{})}}class F3 extends Yn{constructor(){super(...arguments);oe(this,"packageName","Char.Status.Conditions")}handleConditions(t){console.log("Received Char.Status.Conditions:",t),this.client.emit("statusConditions",t)}sendConditionsRequest(){this.sendData("Conditions",{})}}class B3 extends Yn{constructor(){super(...arguments);oe(this,"packageName","Char.Status.Timers")}handleTimers(t){console.log("Received Char.Status.Timers:",t),this.client.emit("statusTimers",t)}sendTimersRequest(){this.sendData("Timers",{})}}class L3 extends Yn{constructor(t){super(t);oe(this,"packageName","Client.File")}handleDownload(t){console.log("[GMCPClientFile] Received download request:",t),t.url&&window.open(t.url,"_blank")}}class kk extends Yn{constructor(){super(...arguments);oe(this,"packageName","Client.FileTransfer")}sendCandidate(t,r){this.sendData("Candidate",{recipient:t,candidate:JSON.stringify(r)})}handleCandidate(t){const r=JSON.parse(t.candidate);this.client.webRTCService.handleIceCandidate(r)}handleOffer(t){console.log("[GMCPClientFileTransfer] Received offer:",t),this.client.fileTransferManager.pendingOffers.set(`${t.hash}`,t),this.client.onFileTransferOffer(t.sender,t.hash,t.filename,t.filesize,t.offerSdp)}handleAccept(t){this.client.onFileTransferAccept(t.sender,t.hash,t.filename,t.answerSdp)}handleReject(t){this.client.onFileTransferReject(t.sender,t.hash)}handleCancel(t){this.client.onFileTransferCancel(t.sender,t.hash)}sendOffer(t,r,i,o,c){this.sendData("Offer",{recipient:t,filename:r,filesize:i,offerSdp:o,hash:c})}sendAccept(t,r,i,o){this.sendData("Accept",{sender:t,hash:r,filename:i,answerSdp:o})}sendReject(t,r){this.sendData("Reject",{sender:t,hash:r})}sendCancel(t,r){this.sendData("Cancel",{recipient:t,hash:r})}sendRequestResend(t,r){this.sendData("RequestResend",{sender:t,hash:r})}}function fC(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Ml=fC();function Ek(n){Ml=n}var qd={exec:()=>null};function zn(n,e=""){let t=typeof n=="string"?n:n.source;const r={replace:(i,o)=>{let c=typeof o=="string"?o:o.source;return c=c.replace(Zi.caret,"$1"),t=t.replace(i,c),r},getRegex:()=>new RegExp(t,e)};return r}var Zi={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},U3=/^(?:[ \t]*(?:\n|$))+/,j3=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,V3=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,_f=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,G3=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hC=/(?:[*+-]|\d{1,9}[.)])/,Tk=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_k=zn(Tk).replace(/bull/g,hC).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),W3=zn(Tk).replace(/bull/g,hC).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),pC=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,z3=/^[^\n]+/,gC=/(?!\s*\])(?:\\.|[^\[\]\\])+/,H3=zn(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",gC).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Z3=zn(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,hC).getRegex(),Zp="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",mC=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,X3=zn("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",mC).replace("tag",Zp).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Rk=zn(pC).replace("hr",_f).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Zp).getRegex(),$3=zn(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Rk).getRegex(),vC={blockquote:$3,code:j3,def:H3,fences:V3,heading:G3,hr:_f,html:X3,lheading:_k,list:Z3,newline:U3,paragraph:Rk,table:qd,text:z3},II=zn("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",_f).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Zp).getRegex(),K3={...vC,lheading:W3,table:II,paragraph:zn(pC).replace("hr",_f).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",II).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Zp).getRegex()},q3={...vC,html:zn(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",mC).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:qd,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:zn(pC).replace("hr",_f).replace("heading",` *#{1,6} *[^
]`).replace("lheading",_k).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Y3=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Q3=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Dk=/^( {2,}|\\)\n(?!\s*$)/,J3=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Xp=/[\p{P}\p{S}]/u,yC=/[\s\p{P}\p{S}]/u,Pk=/[^\s\p{P}\p{S}]/u,eM=zn(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,yC).getRegex(),Mk=/(?!~)[\p{P}\p{S}]/u,tM=/(?!~)[\s\p{P}\p{S}]/u,nM=/(?:[^\s\p{P}\p{S}]|~)/u,rM=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Nk=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,iM=zn(Nk,"u").replace(/punct/g,Xp).getRegex(),oM=zn(Nk,"u").replace(/punct/g,Mk).getRegex(),Ok="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",sM=zn(Ok,"gu").replace(/notPunctSpace/g,Pk).replace(/punctSpace/g,yC).replace(/punct/g,Xp).getRegex(),aM=zn(Ok,"gu").replace(/notPunctSpace/g,nM).replace(/punctSpace/g,tM).replace(/punct/g,Mk).getRegex(),cM=zn("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Pk).replace(/punctSpace/g,yC).replace(/punct/g,Xp).getRegex(),lM=zn(/\\(punct)/,"gu").replace(/punct/g,Xp).getRegex(),uM=zn(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),dM=zn(mC).replace("(?:-->|$)","-->").getRegex(),fM=zn("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",dM).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),cp=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,hM=zn(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",cp).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Fk=zn(/^!?\[(label)\]\[(ref)\]/).replace("label",cp).replace("ref",gC).getRegex(),Bk=zn(/^!?\[(ref)\](?:\[\])?/).replace("ref",gC).getRegex(),pM=zn("reflink|nolink(?!\\()","g").replace("reflink",Fk).replace("nolink",Bk).getRegex(),CC={_backpedal:qd,anyPunctuation:lM,autolink:uM,blockSkip:rM,br:Dk,code:Q3,del:qd,emStrongLDelim:iM,emStrongRDelimAst:sM,emStrongRDelimUnd:cM,escape:Y3,link:hM,nolink:Bk,punctuation:eM,reflink:Fk,reflinkSearch:pM,tag:fM,text:J3,url:qd},gM={...CC,link:zn(/^!?\[(label)\]\((.*?)\)/).replace("label",cp).getRegex(),reflink:zn(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",cp).getRegex()},$v={...CC,emStrongRDelimAst:aM,emStrongLDelim:oM,url:zn(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},mM={...$v,br:zn(Dk).replace("{2,}","*").getRegex(),text:zn($v.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Bh={normal:vC,gfm:K3,pedantic:q3},kd={normal:CC,gfm:$v,breaks:mM,pedantic:gM},vM={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},wI=n=>vM[n];function Ks(n,e){if(e){if(Zi.escapeTest.test(n))return n.replace(Zi.escapeReplace,wI)}else if(Zi.escapeTestNoEncode.test(n))return n.replace(Zi.escapeReplaceNoEncode,wI);return n}function SI(n){try{n=encodeURI(n).replace(Zi.percentDecode,"%")}catch{return null}return n}function AI(n,e){var o;const t=n.replace(Zi.findPipe,(c,s,l)=>{let d=!1,h=s;for(;--h>=0&&l[h]==="\\";)d=!d;return d?"|":" |"}),r=t.split(Zi.splitPipe);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!((o=r.at(-1))!=null&&o.trim())&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(Zi.slashPipe,"|");return r}function Ed(n,e,t){const r=n.length;if(r===0)return"";let i=0;for(;i<r&&n.charAt(r-i-1)===e;)i++;return n.slice(0,r-i)}function yM(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return t>0?-2:-1}function kI(n,e,t,r,i){const o=e.href,c=e.title||null,s=n[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;const l={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:o,title:c,text:s,tokens:r.inlineTokens(s)};return r.state.inLink=!1,l}function CM(n,e,t){const r=n.match(t.other.indentCodeCompensation);if(r===null)return e;const i=r[1];return e.split(`
`).map(o=>{const c=o.match(t.other.beginningSpace);if(c===null)return o;const[s]=c;return s.length>=i.length?o.slice(i.length):o}).join(`
`)}var lp=class{constructor(n){oe(this,"options");oe(this,"rules");oe(this,"lexer");this.options=n||Ml}space(n){const e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){const e=this.rules.block.code.exec(n);if(e){const t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:Ed(t,`
`)}}}fences(n){const e=this.rules.block.fences.exec(n);if(e){const t=e[0],r=CM(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(n){const e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){const r=Ed(t,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(t=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){const e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:Ed(e[0],`
`)}}blockquote(n){const e=this.rules.block.blockquote.exec(n);if(e){let t=Ed(e[0],`
`).split(`
`),r="",i="";const o=[];for(;t.length>0;){let c=!1;const s=[];let l;for(l=0;l<t.length;l++)if(this.rules.other.blockquoteStart.test(t[l]))s.push(t[l]),c=!0;else if(!c)s.push(t[l]);else break;t=t.slice(l);const d=s.join(`
`),h=d.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${d}`:d,i=i?`${i}
${h}`:h;const p=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,o,!0),this.lexer.state.top=p,t.length===0)break;const g=o.at(-1);if((g==null?void 0:g.type)==="code")break;if((g==null?void 0:g.type)==="blockquote"){const y=g,C=y.raw+`
`+t.join(`
`),x=this.blockquote(C);o[o.length-1]=x,r=r.substring(0,r.length-y.raw.length)+x.raw,i=i.substring(0,i.length-y.text.length)+x.text;break}else if((g==null?void 0:g.type)==="list"){const y=g,C=y.raw+`
`+t.join(`
`),x=this.list(C);o[o.length-1]=x,r=r.substring(0,r.length-g.raw.length)+x.raw,i=i.substring(0,i.length-y.raw.length)+x.raw,t=C.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:i}}}list(n){let e=this.rules.block.list.exec(n);if(e){let t=e[1].trim();const r=t.length>1,i={type:"list",raw:"",ordered:r,start:r?+t.slice(0,-1):"",loose:!1,items:[]};t=r?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=r?t:"[*+-]");const o=this.rules.other.listItemRegex(t);let c=!1;for(;n;){let l=!1,d="",h="";if(!(e=o.exec(n))||this.rules.block.hr.test(n))break;d=e[0],n=n.substring(d.length);let p=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,S=>" ".repeat(3*S.length)),g=n.split(`
`,1)[0],y=!p.trim(),C=0;if(this.options.pedantic?(C=2,h=p.trimStart()):y?C=e[1].length+1:(C=e[2].search(this.rules.other.nonSpaceChar),C=C>4?1:C,h=p.slice(C),C+=e[1].length),y&&this.rules.other.blankLine.test(g)&&(d+=g+`
`,n=n.substring(g.length+1),l=!0),!l){const S=this.rules.other.nextBulletRegex(C),E=this.rules.other.hrRegex(C),R=this.rules.other.fencesBeginRegex(C),k=this.rules.other.headingBeginRegex(C),A=this.rules.other.htmlBeginRegex(C);for(;n;){const _=n.split(`
`,1)[0];let D;if(g=_,this.options.pedantic?(g=g.replace(this.rules.other.listReplaceNesting,"  "),D=g):D=g.replace(this.rules.other.tabCharGlobal,"    "),R.test(g)||k.test(g)||A.test(g)||S.test(g)||E.test(g))break;if(D.search(this.rules.other.nonSpaceChar)>=C||!g.trim())h+=`
`+D.slice(C);else{if(y||p.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||R.test(p)||k.test(p)||E.test(p))break;h+=`
`+g}!y&&!g.trim()&&(y=!0),d+=_+`
`,n=n.substring(_.length+1),p=D.slice(C)}}i.loose||(c?i.loose=!0:this.rules.other.doubleBlankLine.test(d)&&(c=!0));let x=null,w;this.options.gfm&&(x=this.rules.other.listIsTask.exec(h),x&&(w=x[0]!=="[ ] ",h=h.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:d,task:!!x,checked:w,loose:!1,text:h,tokens:[]}),i.raw+=d}const s=i.items.at(-1);if(s)s.raw=s.raw.trimEnd(),s.text=s.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let l=0;l<i.items.length;l++)if(this.lexer.state.top=!1,i.items[l].tokens=this.lexer.blockTokens(i.items[l].text,[]),!i.loose){const d=i.items[l].tokens.filter(p=>p.type==="space"),h=d.length>0&&d.some(p=>this.rules.other.anyLine.test(p.raw));i.loose=h}if(i.loose)for(let l=0;l<i.items.length;l++)i.items[l].loose=!0;return i}}html(n){const e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){const e=this.rules.block.def.exec(n);if(e){const t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:r,title:i}}}table(n){var c;const e=this.rules.block.table.exec(n);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const t=AI(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(c=e[3])!=null&&c.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===r.length){for(const s of r)this.rules.other.tableAlignRight.test(s)?o.align.push("right"):this.rules.other.tableAlignCenter.test(s)?o.align.push("center"):this.rules.other.tableAlignLeft.test(s)?o.align.push("left"):o.align.push(null);for(let s=0;s<t.length;s++)o.header.push({text:t[s],tokens:this.lexer.inline(t[s]),header:!0,align:o.align[s]});for(const s of i)o.rows.push(AI(s,o.header.length).map((l,d)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:o.align[d]})));return o}}lheading(n){const e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){const e=this.rules.block.paragraph.exec(n);if(e){const t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){const e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){const e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(n){const e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){const e=this.rules.inline.link.exec(n);if(e){const t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;const o=Ed(t.slice(0,-1),"\\");if((t.length-o.length)%2===0)return}else{const o=yM(e[2],"()");if(o===-2)return;if(o>-1){const s=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,s).trim(),e[3]=""}}let r=e[2],i="";if(this.options.pedantic){const o=this.rules.other.pedanticHrefTitle.exec(r);o&&(r=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?r=r.slice(1):r=r.slice(1,-1)),kI(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){const r=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[r.toLowerCase()];if(!i){const o=t[0].charAt(0);return{type:"text",raw:o,text:o}}return kI(t,i,t[0],this.lexer,this.rules)}}emStrong(n,e,t=""){let r=this.rules.inline.emStrongLDelim.exec(n);if(!r||r[3]&&t.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const o=[...r[0]].length-1;let c,s,l=o,d=0;const h=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*n.length+o);(r=h.exec(e))!=null;){if(c=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!c)continue;if(s=[...c].length,r[3]||r[4]){l+=s;continue}else if((r[5]||r[6])&&o%3&&!((o+s)%3)){d+=s;continue}if(l-=s,l>0)continue;s=Math.min(s,s+l+d);const p=[...r[0]][0].length,g=n.slice(0,o+r.index+p+s);if(Math.min(o,s)%2){const C=g.slice(1,-1);return{type:"em",raw:g,text:C,tokens:this.lexer.inlineTokens(C)}}const y=g.slice(2,-2);return{type:"strong",raw:g,text:y,tokens:this.lexer.inlineTokens(y)}}}}codespan(n){const e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(t),i=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return r&&i&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(n){const e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){const e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){const e=this.rules.inline.autolink.exec(n);if(e){let t,r;return e[2]==="@"?(t=e[1],r="mailto:"+t):(t=e[1],r=t),{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}url(n){var t;let e;if(e=this.rules.inline.url.exec(n)){let r,i;if(e[2]==="@")r=e[0],i="mailto:"+r;else{let o;do o=e[0],e[0]=((t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])??"";while(o!==e[0]);r=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(n){const e=this.rules.inline.text.exec(n);if(e){const t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},Oa=class Kv{constructor(e){oe(this,"tokens");oe(this,"options");oe(this,"state");oe(this,"tokenizer");oe(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ml,this.options.tokenizer=this.options.tokenizer||new lp,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:Zi,block:Bh.normal,inline:kd.normal};this.options.pedantic?(t.block=Bh.pedantic,t.inline=kd.pedantic):this.options.gfm&&(t.block=Bh.gfm,this.options.breaks?t.inline=kd.breaks:t.inline=kd.gfm),this.tokenizer.rules=t}static get rules(){return{block:Bh,inline:kd}}static lex(e,t){return new Kv(t).lex(e)}static lexInline(e,t){return new Kv(t).inlineTokens(e)}lex(e){e=e.replace(Zi.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){var i,o,c;for(this.options.pedantic&&(e=e.replace(Zi.tabCharGlobal,"    ").replace(Zi.spaceLine,""));e;){let s;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(d=>(s=d.call({lexer:this},e,t))?(e=e.substring(s.raw.length),t.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);const d=t.at(-1);s.raw.length===1&&d!==void 0?d.raw+=`
`:t.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);const d=t.at(-1);(d==null?void 0:d.type)==="paragraph"||(d==null?void 0:d.type)==="text"?(d.raw+=`
`+s.raw,d.text+=`
`+s.text,this.inlineQueue.at(-1).src=d.text):t.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);const d=t.at(-1);(d==null?void 0:d.type)==="paragraph"||(d==null?void 0:d.type)==="text"?(d.raw+=`
`+s.raw,d.text+=`
`+s.raw,this.inlineQueue.at(-1).src=d.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),t.push(s);continue}let l=e;if((c=this.options.extensions)!=null&&c.startBlock){let d=1/0;const h=e.slice(1);let p;this.options.extensions.startBlock.forEach(g=>{p=g.call({lexer:this},h),typeof p=="number"&&p>=0&&(d=Math.min(d,p))}),d<1/0&&d>=0&&(l=e.substring(0,d+1))}if(this.state.top&&(s=this.tokenizer.paragraph(l))){const d=t.at(-1);r&&(d==null?void 0:d.type)==="paragraph"?(d.raw+=`
`+s.raw,d.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):t.push(s),r=l.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);const d=t.at(-1);(d==null?void 0:d.type)==="text"?(d.raw+=`
`+s.raw,d.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):t.push(s);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var s,l,d;let r=e,i=null;if(this.tokens.links){const h=Object.keys(this.tokens.links);if(h.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)h.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,c="";for(;e;){o||(c=""),o=!1;let h;if((l=(s=this.options.extensions)==null?void 0:s.inline)!=null&&l.some(g=>(h=g.call({lexer:this},e,t))?(e=e.substring(h.raw.length),t.push(h),!0):!1))continue;if(h=this.tokenizer.escape(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.tag(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.link(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(h.raw.length);const g=t.at(-1);h.type==="text"&&(g==null?void 0:g.type)==="text"?(g.raw+=h.raw,g.text+=h.text):t.push(h);continue}if(h=this.tokenizer.emStrong(e,r,c)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.codespan(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.br(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.del(e)){e=e.substring(h.raw.length),t.push(h);continue}if(h=this.tokenizer.autolink(e)){e=e.substring(h.raw.length),t.push(h);continue}if(!this.state.inLink&&(h=this.tokenizer.url(e))){e=e.substring(h.raw.length),t.push(h);continue}let p=e;if((d=this.options.extensions)!=null&&d.startInline){let g=1/0;const y=e.slice(1);let C;this.options.extensions.startInline.forEach(x=>{C=x.call({lexer:this},y),typeof C=="number"&&C>=0&&(g=Math.min(g,C))}),g<1/0&&g>=0&&(p=e.substring(0,g+1))}if(h=this.tokenizer.inlineText(p)){e=e.substring(h.raw.length),h.raw.slice(-1)!=="_"&&(c=h.raw.slice(-1)),o=!0;const g=t.at(-1);(g==null?void 0:g.type)==="text"?(g.raw+=h.raw,g.text+=h.text):t.push(h);continue}if(e){const g="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return t}},up=class{constructor(n){oe(this,"options");oe(this,"parser");this.options=n||Ml}space(n){return""}code({text:n,lang:e,escaped:t}){var o;const r=(o=(e||"").match(Zi.notSpaceStart))==null?void 0:o[0],i=n.replace(Zi.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Ks(r)+'">'+(t?i:Ks(i,!0))+`</code></pre>
`:"<pre><code>"+(t?i:Ks(i,!0))+`</code></pre>
`}blockquote({tokens:n}){return`<blockquote>
${this.parser.parse(n)}</blockquote>
`}html({text:n}){return n}heading({tokens:n,depth:e}){return`<h${e}>${this.parser.parseInline(n)}</h${e}>
`}hr(n){return`<hr>
`}list(n){const e=n.ordered,t=n.start;let r="";for(let c=0;c<n.items.length;c++){const s=n.items[c];r+=this.listitem(s)}const i=e?"ol":"ul",o=e&&t!==1?' start="'+t+'"':"";return"<"+i+o+`>
`+r+"</"+i+`>
`}listitem(n){var t;let e="";if(n.task){const r=this.checkbox({checked:!!n.checked});n.loose?((t=n.tokens[0])==null?void 0:t.type)==="paragraph"?(n.tokens[0].text=r+" "+n.tokens[0].text,n.tokens[0].tokens&&n.tokens[0].tokens.length>0&&n.tokens[0].tokens[0].type==="text"&&(n.tokens[0].tokens[0].text=r+" "+Ks(n.tokens[0].tokens[0].text),n.tokens[0].tokens[0].escaped=!0)):n.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):e+=r+" "}return e+=this.parser.parse(n.tokens,!!n.loose),`<li>${e}</li>
`}checkbox({checked:n}){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:n}){return`<p>${this.parser.parseInline(n)}</p>
`}table(n){let e="",t="";for(let i=0;i<n.header.length;i++)t+=this.tablecell(n.header[i]);e+=this.tablerow({text:t});let r="";for(let i=0;i<n.rows.length;i++){const o=n.rows[i];t="";for(let c=0;c<o.length;c++)t+=this.tablecell(o[c]);r+=this.tablerow({text:t})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:n}){return`<tr>
${n}</tr>
`}tablecell(n){const e=this.parser.parseInline(n.tokens),t=n.header?"th":"td";return(n.align?`<${t} align="${n.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:n}){return`<strong>${this.parser.parseInline(n)}</strong>`}em({tokens:n}){return`<em>${this.parser.parseInline(n)}</em>`}codespan({text:n}){return`<code>${Ks(n,!0)}</code>`}br(n){return"<br>"}del({tokens:n}){return`<del>${this.parser.parseInline(n)}</del>`}link({href:n,title:e,tokens:t}){const r=this.parser.parseInline(t),i=SI(n);if(i===null)return r;n=i;let o='<a href="'+n+'"';return e&&(o+=' title="'+Ks(e)+'"'),o+=">"+r+"</a>",o}image({href:n,title:e,text:t,tokens:r}){r&&(t=this.parser.parseInline(r,this.parser.textRenderer));const i=SI(n);if(i===null)return Ks(t);n=i;let o=`<img src="${n}" alt="${t}"`;return e&&(o+=` title="${Ks(e)}"`),o+=">",o}text(n){return"tokens"in n&&n.tokens?this.parser.parseInline(n.tokens):"escaped"in n&&n.escaped?n.text:Ks(n.text)}},xC=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}},Fa=class qv{constructor(e){oe(this,"options");oe(this,"renderer");oe(this,"textRenderer");this.options=e||Ml,this.options.renderer=this.options.renderer||new up,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new xC}static parse(e,t){return new qv(t).parse(e)}static parseInline(e,t){return new qv(t).parseInline(e)}parse(e,t=!0){var i,o;let r="";for(let c=0;c<e.length;c++){const s=e[c];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[s.type]){const d=s,h=this.options.extensions.renderers[d.type].call({parser:this},d);if(h!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(d.type)){r+=h||"";continue}}const l=s;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let d=l,h=this.renderer.text(d);for(;c+1<e.length&&e[c+1].type==="text";)d=e[++c],h+=`
`+this.renderer.text(d);t?r+=this.renderer.paragraph({type:"paragraph",raw:h,text:h,tokens:[{type:"text",raw:h,text:h,escaped:!0}]}):r+=h;continue}default:{const d='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return r}parseInline(e,t=this.renderer){var i,o;let r="";for(let c=0;c<e.length;c++){const s=e[c];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[s.type]){const d=this.options.extensions.renderers[s.type].call({parser:this},s);if(d!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=d||"";continue}}const l=s;switch(l.type){case"escape":{r+=t.text(l);break}case"html":{r+=t.html(l);break}case"link":{r+=t.link(l);break}case"image":{r+=t.image(l);break}case"strong":{r+=t.strong(l);break}case"em":{r+=t.em(l);break}case"codespan":{r+=t.codespan(l);break}case"br":{r+=t.br(l);break}case"del":{r+=t.del(l);break}case"text":{r+=t.text(l);break}default:{const d='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return r}},Wv,t0=(Wv=class{constructor(n){oe(this,"options");oe(this,"block");this.options=n||Ml}preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}provideLexer(){return this.block?Oa.lex:Oa.lexInline}provideParser(){return this.block?Fa.parse:Fa.parseInline}},oe(Wv,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),Wv),xM=class{constructor(...n){oe(this,"defaults",fC());oe(this,"options",this.setOptions);oe(this,"parse",this.parseMarkdown(!0));oe(this,"parseInline",this.parseMarkdown(!1));oe(this,"Parser",Fa);oe(this,"Renderer",up);oe(this,"TextRenderer",xC);oe(this,"Lexer",Oa);oe(this,"Tokenizer",lp);oe(this,"Hooks",t0);this.use(...n)}walkTokens(n,e){var r,i;let t=[];for(const o of n)switch(t=t.concat(e.call(this,o)),o.type){case"table":{const c=o;for(const s of c.header)t=t.concat(this.walkTokens(s.tokens,e));for(const s of c.rows)for(const l of s)t=t.concat(this.walkTokens(l.tokens,e));break}case"list":{const c=o;t=t.concat(this.walkTokens(c.items,e));break}default:{const c=o;(i=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&i[c.type]?this.defaults.extensions.childTokens[c.type].forEach(s=>{const l=c[s].flat(1/0);t=t.concat(this.walkTokens(l,e))}):c.tokens&&(t=t.concat(this.walkTokens(c.tokens,e)))}}return t}use(...n){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{const r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const o=e.renderers[i.name];o?e.renderers[i.name]=function(...c){let s=i.renderer.apply(this,c);return s===!1&&(s=o.apply(this,c)),s}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),r.extensions=e),t.renderer){const i=this.defaults.renderer||new up(this.defaults);for(const o in t.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const c=o,s=t.renderer[c],l=i[c];i[c]=(...d)=>{let h=s.apply(i,d);return h===!1&&(h=l.apply(i,d)),h||""}}r.renderer=i}if(t.tokenizer){const i=this.defaults.tokenizer||new lp(this.defaults);for(const o in t.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const c=o,s=t.tokenizer[c],l=i[c];i[c]=(...d)=>{let h=s.apply(i,d);return h===!1&&(h=l.apply(i,d)),h}}r.tokenizer=i}if(t.hooks){const i=this.defaults.hooks||new t0;for(const o in t.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;const c=o,s=t.hooks[c],l=i[c];t0.passThroughHooks.has(o)?i[c]=d=>{if(this.defaults.async)return Promise.resolve(s.call(i,d)).then(p=>l.call(i,p));const h=s.call(i,d);return l.call(i,h)}:i[c]=(...d)=>{let h=s.apply(i,d);return h===!1&&(h=l.apply(i,d)),h}}r.hooks=i}if(t.walkTokens){const i=this.defaults.walkTokens,o=t.walkTokens;r.walkTokens=function(c){let s=[];return s.push(o.call(this,c)),i&&(s=s.concat(i.call(this,c))),s}}this.defaults={...this.defaults,...r}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,e){return Oa.lex(n,e??this.defaults)}parser(n,e){return Fa.parse(n,e??this.defaults)}parseMarkdown(n){return(t,r)=>{const i={...r},o={...this.defaults,...i},c=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&i.async===!1)return c(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return c(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return c(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=n);const s=o.hooks?o.hooks.provideLexer():n?Oa.lex:Oa.lexInline,l=o.hooks?o.hooks.provideParser():n?Fa.parse:Fa.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(t):t).then(d=>s(d,o)).then(d=>o.hooks?o.hooks.processAllTokens(d):d).then(d=>o.walkTokens?Promise.all(this.walkTokens(d,o.walkTokens)).then(()=>d):d).then(d=>l(d,o)).then(d=>o.hooks?o.hooks.postprocess(d):d).catch(c);try{o.hooks&&(t=o.hooks.preprocess(t));let d=s(t,o);o.hooks&&(d=o.hooks.processAllTokens(d)),o.walkTokens&&this.walkTokens(d,o.walkTokens);let h=l(d,o);return o.hooks&&(h=o.hooks.postprocess(h)),h}catch(d){return c(d)}}}onError(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){const r="<p>An error occurred:</p><pre>"+Ks(t.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(t);throw t}}},wl=new xM;function Wn(n,e){return wl.parse(n,e)}Wn.options=Wn.setOptions=function(n){return wl.setOptions(n),Wn.defaults=wl.defaults,Ek(Wn.defaults),Wn};Wn.getDefaults=fC;Wn.defaults=Ml;Wn.use=function(...n){return wl.use(...n),Wn.defaults=wl.defaults,Ek(Wn.defaults),Wn};Wn.walkTokens=function(n,e){return wl.walkTokens(n,e)};Wn.parseInline=wl.parseInline;Wn.Parser=Fa;Wn.parser=Fa.parse;Wn.Renderer=up;Wn.TextRenderer=xC;Wn.Lexer=Oa;Wn.lexer=Oa.lex;Wn.Tokenizer=lp;Wn.Hooks=t0;Wn.parse=Wn;Wn.options;Wn.setOptions;Wn.use;Wn.walkTokens;Wn.parseInline;Fa.parse;Oa.lex;Wn.setOptions({breaks:!0,gfm:!0});class bM extends Yn{constructor(t){super(t);oe(this,"packageName","Client.Html")}handleAdd_html(t){this.client.emit("html",t.data.join(`
`))}handleAdd_markdown(t){const r=t.data.join(`
`),i=Wn(r);this.client.emit("html",typeof i=="string"?i.trimEnd():i)}}class IM{constructor(){oe(this,"state",{text:""});oe(this,"listeners",new Set);oe(this,"inputRef",null);oe(this,"dispatch",e=>{const t=this.state;this.state=this.reducer(this.state,e),this.state!==t&&this.listeners.forEach(r=>r())})}reducer(e,t){switch(t.type){case"SET_INPUT":return e.text!==t.data?{...e,text:t.data}:e;case"CLEAR_INPUT":return e.text!==""?{...e,text:""}:e;default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}registerInputRef(e){this.inputRef=e}focusInput(){var e;(e=this.inputRef)!=null&&e.current&&this.inputRef.current.focus()}}const Ba=new IM,fl=n=>{Ba.dispatch({type:"SET_INPUT",data:n})},EI=n=>{Ba.dispatch({type:"SET_INPUT",data:n}),Ba.focusInput()},wM=()=>{Ba.dispatch({type:"CLEAR_INPUT"})};class SM extends Yn{constructor(t){super(t);oe(this,"packageName","Client.Keystrokes");oe(this,"bindings",[]);oe(this,"boundKeyDownHandler");this.boundKeyDownHandler=this.handleKeydown.bind(this),document.addEventListener("keydown",this.boundKeyDownHandler)}handleKeydown(t){const r=this.findBinding(t);if(r){t.preventDefault();const i=Ba.getState().text,o=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(o):this.placeInInputField(o)}}shutdown(){document.removeEventListener("keydown",this.boundKeyDownHandler)}findBinding(t){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==t.key.toLowerCase())return!1;const i=new Set([t.altKey&&"alt",t.ctrlKey&&"control",t.shiftKey&&"shift",t.metaKey&&"meta"].filter(Boolean)),o=new Set((r.modifiers||[]).map(c=>c.toLowerCase()));return i.size!==o.size?!1:Array.from(o).every(c=>i.has(c))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(t,r){const i=r.trim().split(/\s+/);return t.replace(/%(\d+|\*)/g,(o,c)=>{if(c==="*")return r;const s=parseInt(c,10)-1;return s>=0&&s<i.length?i[s]:o})}placeInInputField(t){fl(t)}bindKey(t){const r={key:t.key,modifiers:t.modifiers,command:t.command,autosend:t.autosend};this.bindings.push(r)}unbindKey(t){const r=new Set((t.modifiers||[]).map(i=>i.toLowerCase()));this.bindings=this.bindings.filter(i=>{const o=new Set((i.modifiers||[]).map(s=>s.toLowerCase()));return i.key.toLowerCase()!==t.key.toLowerCase()||o.size!==r.size?!0:!Array.from(r).every(s=>o.has(s))})}unbindAll(){this.bindings=[]}handleBind(t){this.bindKey(t)}handleUnbind(t){this.unbindKey(t)}handleBind_all(t){this.bindings=t.bindings.map(r=>({...r}))}handleUnbindAll(t){console.log("Received Client.Keystrokes.UnbindAll, clearing all bindings."),this.unbindAll()}handleListBindings(t){console.log("Received Client.Keystrokes.ListBindings request, sending current bindings.");const r=this.listBindings();this.sendData("BindingsList",r)}listBindings(){return[...this.bindings]}}const TI=(n,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:n}),_I=(n,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:n}),Yv=(n,e)=>({startTime:e,type:"setValue",value:n}),Lk=(n,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:n}),Uk=(n,e,{startTime:t,target:r,timeConstant:i})=>r+(e-r)*Math.exp((t-n)/i),pu=n=>n.type==="exponentialRampToValue",dp=n=>n.type==="linearRampToValue",xc=n=>pu(n)||dp(n),bC=n=>n.type==="setValue",Ta=n=>n.type==="setValueCurve",fp=(n,e,t,r)=>{const i=n[e];return i===void 0?r:xc(i)||bC(i)?i.value:Ta(i)?i.values[i.values.length-1]:Uk(t,fp(n,e-1,i.startTime,r),i)},RI=(n,e,t,r,i)=>t===void 0?[r.insertTime,i]:xc(t)?[t.endTime,t.value]:bC(t)?[t.startTime,t.value]:Ta(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,fp(n,e-1,t.startTime,i)],Qv=n=>n.type==="cancelAndHold",Jv=n=>n.type==="cancelScheduledValues",uc=n=>Qv(n)||Jv(n)?n.cancelTime:pu(n)||dp(n)?n.endTime:n.startTime,DI=(n,e,t,{endTime:r,value:i})=>t===i?i:0<t&&0<i||t<0&&i<0?t*(i/t)**((n-e)/(r-e)):0,PI=(n,e,t,{endTime:r,value:i})=>t+(n-e)/(r-e)*(i-t),AM=(n,e)=>{const t=Math.floor(e),r=Math.ceil(e);return t===r?n[t]:(1-(e-t))*n[t]+(1-(r-e))*n[r]},kM=(n,{duration:e,startTime:t,values:r})=>{const i=(n-t)/e*(r.length-1);return AM(r,i)},Lh=n=>n.type==="setTarget";class EM{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=uc(e);if(Qv(e)||Jv(e)){const r=this._automationEvents.findIndex(o=>Jv(e)&&Ta(o)?o.startTime+o.duration>=t:uc(o)>=t),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Qv(e)){const o=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&xc(i)){if(o!==void 0&&Lh(o))throw new Error("The internal list is malformed.");const c=o===void 0?i.insertTime:Ta(o)?o.startTime+o.duration:uc(o),s=o===void 0?this._defaultValue:Ta(o)?o.values[o.values.length-1]:o.value,l=pu(i)?DI(t,c,s,i):PI(t,c,s,i),d=pu(i)?TI(l,t,this._currenTime):_I(l,t,this._currenTime);this._automationEvents.push(d)}if(o!==void 0&&Lh(o)&&this._automationEvents.push(Yv(this.getValue(t),t)),o!==void 0&&Ta(o)&&o.startTime+o.duration>t){const c=t-o.startTime,s=(o.values.length-1)/o.duration,l=Math.max(2,1+Math.ceil(c*s)),d=c/(l-1)*s,h=o.values.slice(0,l);if(d<1)for(let p=1;p<l;p+=1){const g=d*p%1;h[p]=o.values[p-1]*(1-g)+o.values[p]*g}this._automationEvents[this._automationEvents.length-1]=Lk(h,o.startTime,c)}}}else{const r=this._automationEvents.findIndex(c=>uc(c)>t),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Ta(i)&&uc(i)+i.duration>t)return!1;const o=pu(e)?TI(e.value,e.endTime,this._currenTime):dp(e)?_I(e.value,t,this._currenTime):e;if(r===-1)this._automationEvents.push(o);else{if(Ta(e)&&t+e.duration>uc(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(e){const t=this._automationEvents.findIndex(r=>uc(r)>e);if(t>1){const r=this._automationEvents.slice(t-1),i=r[0];Lh(i)&&r.unshift(Yv(fp(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(c=>uc(c)>e),r=this._automationEvents[t],i=(t===-1?this._automationEvents.length:t)-1,o=this._automationEvents[i];if(o!==void 0&&Lh(o)&&(r===void 0||!xc(r)||r.insertTime>e))return Uk(e,fp(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(o!==void 0&&bC(o)&&(r===void 0||!xc(r)))return o.value;if(o!==void 0&&Ta(o)&&(r===void 0||!xc(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?kM(e,o):o.values[o.values.length-1];if(o!==void 0&&xc(o)&&(r===void 0||!xc(r)))return o.value;if(r!==void 0&&pu(r)){const[c,s]=RI(this._automationEvents,i,o,r,this._defaultValue);return DI(e,c,s,r)}if(r!==void 0&&dp(r)){const[c,s]=RI(this._automationEvents,i,o,r,this._defaultValue);return PI(e,c,s,r)}return this._defaultValue}}const TM=n=>({cancelTime:n,type:"cancelAndHold"}),_M=n=>({cancelTime:n,type:"cancelScheduledValues"}),RM=(n,e)=>({endTime:e,type:"exponentialRampToValue",value:n}),DM=(n,e)=>({endTime:e,type:"linearRampToValue",value:n}),PM=(n,e,t)=>({startTime:e,target:n,timeConstant:t,type:"setTarget"}),MM=()=>new DOMException("","AbortError"),NM=n=>(e,t,[r,i,o],c)=>{n(e[i],[t,r,o],s=>s[0]===t&&s[1]===r,c)},OM=n=>(e,t,r)=>{const i=[];for(let o=0;o<r.numberOfInputs;o+=1)i.push(new Set);n.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},FM=n=>(e,t)=>{n.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Ou=new WeakSet,jk=new WeakMap,Vk=new WeakMap,Gk=new WeakMap,Wk=new WeakMap,zk=new WeakMap,Hk=new WeakMap,ey=new WeakMap,ty=new WeakMap,ny=new WeakMap,Zk={construct(){return Zk}},BM=n=>{try{const e=new Proxy(n,Zk);new e}catch{return!1}return!0},MI=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,NI=(n,e)=>{const t=[];let r=n.replace(/^[\s]+/,""),i=r.match(MI);for(;i!==null;){const o=i[1].slice(1,-1),c=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());t.push(c),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(MI)}return[t.join(";"),r]},OI=n=>{if(n!==void 0&&!Array.isArray(n))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},FI=n=>{if(!BM(n))throw new TypeError("The given value for processorCtor should be a constructor.");if(n.prototype===null||typeof n.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},LM=(n,e,t,r,i,o,c,s,l,d,h,p,g)=>{let y=0;return(C,x,w={credentials:"omit"})=>{const S=h.get(C);if(S!==void 0&&S.has(x))return Promise.resolve();const E=d.get(C);if(E!==void 0){const A=E.get(x);if(A!==void 0)return A}const R=o(C),k=R.audioWorklet===void 0?i(x).then(([A,_])=>{const[D,j]=NI(A,_),Z=`${D};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${j}
})})(window,'_AWGS')`;return t(Z)}).then(()=>{const A=g._AWGS.pop();if(A===void 0)throw new SyntaxError;r(R.currentTime,R.sampleRate,()=>A(class{},void 0,(_,D)=>{if(_.trim()==="")throw e();const j=ty.get(R);if(j!==void 0){if(j.has(_))throw e();FI(D),OI(D.parameterDescriptors),j.set(_,D)}else FI(D),OI(D.parameterDescriptors),ty.set(R,new Map([[_,D]]))},R.sampleRate,void 0,void 0))}):Promise.all([i(x),Promise.resolve(n(p,p))]).then(([[A,_],D])=>{const j=y+1;y=j;const[Z,F]=NI(A,_),pe=`${Z};((AudioWorkletProcessor,registerProcessor)=>{${F}
})(${D?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${D?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${D?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${j}',class extends AudioWorkletProcessor{process(){return !1}})`,ve=new Blob([pe],{type:"application/javascript; charset=utf-8"}),Ie=URL.createObjectURL(ve);return R.audioWorklet.addModule(Ie,w).then(()=>{if(s(R))return R;const Re=c(R);return Re.audioWorklet.addModule(Ie,w).then(()=>Re)}).then(Re=>{if(l===null)throw new SyntaxError;try{new l(Re,`__sac${j}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(Ie))});return E===void 0?d.set(C,new Map([[x,k]])):E.set(x,k),k.then(()=>{const A=h.get(C);A===void 0?h.set(C,new Set([x])):A.add(x)}).finally(()=>{const A=d.get(C);A!==void 0&&A.delete(x)}),k}},Ds=(n,e)=>{const t=n.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},$p=(n,e)=>{const t=Array.from(n).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[r]=t;return n.delete(r),r},Xk=(n,e,t,r)=>{const i=Ds(n,e),o=$p(i,c=>c[0]===t&&c[1]===r);return i.size===0&&n.delete(e),o},Rf=n=>Ds(Hk,n),Fu=n=>{if(Ou.has(n))throw new Error("The AudioNode is already stored.");Ou.add(n),Rf(n).forEach(e=>e(!0))},$k=n=>"port"in n,Df=n=>{if(!Ou.has(n))throw new Error("The AudioNode is not stored.");Ou.delete(n),Rf(n).forEach(e=>e(!1))},ry=(n,e)=>{!$k(n)&&e.every(t=>t.size===0)&&Df(n)},UM=(n,e,t,r,i,o,c,s,l,d,h,p,g)=>{const y=new WeakMap;return(C,x,w,S,E)=>{const{activeInputs:R,passiveInputs:k}=o(x),{outputs:A}=o(C),_=s(C),D=j=>{const Z=l(x),F=l(C);if(j){const V=Xk(k,C,w,S);n(R,C,V,!1),!E&&!p(C)&&t(F,Z,w,S),g(x)&&Fu(x)}else{const V=r(R,C,w,S);e(k,S,V,!1),!E&&!p(C)&&i(F,Z,w,S);const X=c(x);if(X===0)h(x)&&ry(x,R);else{const te=y.get(x);te!==void 0&&clearTimeout(te),y.set(x,setTimeout(()=>{h(x)&&ry(x,R)},X*1e3))}}};return d(A,[x,w,S],j=>j[0]===x&&j[1]===w&&j[2]===S,!0)?(_.add(D),h(C)?n(R,C,[w,S,D],!0):e(k,S,[C,w,D],!0),!0):!1}},jM=n=>(e,t,[r,i,o],c)=>{const s=e.get(r);s===void 0?e.set(r,new Set([[i,t,o]])):n(s,[i,t,o],l=>l[0]===i&&l[1]===t,c)},VM=n=>(e,t)=>{const r=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(e.destination);const i=()=>{t.removeEventListener("ended",i),t.disconnect(r),r.disconnect()};t.addEventListener("ended",i)},GM=n=>(e,t)=>{n(e).add(t)},WM={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},zM=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const d=i(s),h={...WM,...l},p=r(d,h),g=o(d)?e():null;super(s,!1,p,g),this._nativeAnalyserNode=p}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(s){this._nativeAnalyserNode.fftSize=s}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(s){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=s,!(s>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(s){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=s,!(this._nativeAnalyserNode.maxDecibels>s))throw this._nativeAnalyserNode.minDecibels=l,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(s){this._nativeAnalyserNode.smoothingTimeConstant=s}getByteFrequencyData(s){this._nativeAnalyserNode.getByteFrequencyData(s)}getByteTimeDomainData(s){this._nativeAnalyserNode.getByteTimeDomainData(s)}getFloatFrequencyData(s){this._nativeAnalyserNode.getFloatFrequencyData(s)}getFloatTimeDomainData(s){this._nativeAnalyserNode.getFloatTimeDomainData(s)}},Oi=(n,e)=>n.context===e,HM=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,c)=>{let s=e(o);if(!Oi(s,c)){const d={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,fftSize:s.fftSize,maxDecibels:s.maxDecibels,minDecibels:s.minDecibels,smoothingTimeConstant:s.smoothingTimeConstant};s=n(c,d)}return r.set(c,s),await t(o,c,s),s};return{render(o,c){const s=r.get(c);return s!==void 0?Promise.resolve(s):i(o,c)}}},iy=n=>{try{n.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},ia=()=>new DOMException("","IndexSizeError"),Kk=n=>{n.getChannelData=(e=>t=>{try{return e.call(n,t)}catch(r){throw r.code===12?ia():r}})(n.getChannelData)},ZM={numberOfChannels:1},XM=(n,e,t,r,i,o,c,s)=>{let l=null;return class qk{constructor(h){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:p,numberOfChannels:g,sampleRate:y}={...ZM,...h};l===null&&(l=new i(1,1,44100));const C=r!==null&&e(o,o)?new r({length:p,numberOfChannels:g,sampleRate:y}):l.createBuffer(g,p,y);if(C.numberOfChannels===0)throw t();return typeof C.copyFromChannel!="function"?(c(C),Kk(C)):e(iy,()=>iy(C))||s(C),n.add(C),C}static[Symbol.hasInstance](h){return h!==null&&typeof h=="object"&&Object.getPrototypeOf(h)===qk.prototype||n.has(h)}}},ho=-34028234663852886e22,zi=-ho,La=n=>Ou.has(n),$M={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},KM=(n,e,t,r,i,o,c,s)=>class extends n{constructor(d,h){const p=o(d),g={...$M,...h},y=i(p,g),C=c(p),x=C?e():null;super(d,!1,y,x),this._audioBufferSourceNodeRenderer=x,this._isBufferNullified=!1,this._isBufferSet=g.buffer!==null,this._nativeAudioBufferSourceNode=y,this._onended=null,this._playbackRate=t(this,C,y.playbackRate,zi,ho)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(d){if(this._nativeAudioBufferSourceNode.buffer=d,d!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(d){this._nativeAudioBufferSourceNode.loop=d}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(d){this._nativeAudioBufferSourceNode.loopEnd=d}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(d){this._nativeAudioBufferSourceNode.loopStart=d}get onended(){return this._onended}set onended(d){const h=typeof d=="function"?s(this,d):null;this._nativeAudioBufferSourceNode.onended=h;const p=this._nativeAudioBufferSourceNode.onended;this._onended=p!==null&&p===h?d:p}get playbackRate(){return this._playbackRate}start(d=0,h=0,p){if(this._nativeAudioBufferSourceNode.start(d,h,p),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=p===void 0?[d,h]:[d,h,p]),this.context.state!=="closed"){Fu(this);const g=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",g),La(this)&&Df(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",g)}}stop(d=0){this._nativeAudioBufferSourceNode.stop(d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=d)}},qM=(n,e,t,r,i)=>()=>{const o=new WeakMap;let c=null,s=null;const l=async(d,h)=>{let p=t(d);const g=Oi(p,h);if(!g){const y={buffer:p.buffer,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,loop:p.loop,loopEnd:p.loopEnd,loopStart:p.loopStart,playbackRate:p.playbackRate.value};p=e(h,y),c!==null&&p.start(...c),s!==null&&p.stop(s)}return o.set(h,p),g?await n(h,d.playbackRate,p.playbackRate):await r(h,d.playbackRate,p.playbackRate),await i(d,h,p),p};return{set start(d){c=d},set stop(d){s=d},render(d,h){const p=o.get(h);return p!==void 0?Promise.resolve(p):l(d,h)}}},YM=n=>"playbackRate"in n,QM=n=>"frequency"in n&&"gain"in n,JM=n=>"offset"in n,e4=n=>!("frequency"in n)&&"gain"in n,t4=n=>"detune"in n&&"frequency"in n&&!("gain"in n),n4=n=>"pan"in n,Xi=n=>Ds(jk,n),Pf=n=>Ds(Gk,n),oy=(n,e)=>{const{activeInputs:t}=Xi(n);t.forEach(i=>i.forEach(([o])=>{e.includes(n)||oy(o,[...e,n])}));const r=YM(n)?[n.playbackRate]:$k(n)?Array.from(n.parameters.values()):QM(n)?[n.Q,n.detune,n.frequency,n.gain]:JM(n)?[n.offset]:e4(n)?[n.gain]:t4(n)?[n.detune,n.frequency]:n4(n)?[n.pan]:[];for(const i of r){const o=Pf(i);o!==void 0&&o.activeInputs.forEach(([c])=>oy(c,e))}La(n)&&Df(n)},r4=n=>{oy(n.destination,[])},i4=n=>n===void 0||typeof n=="number"||typeof n=="string"&&(n==="balanced"||n==="interactive"||n==="playback"),o4=(n,e,t,r,i,o,c,s,l)=>class extends n{constructor(h={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let p;try{p=new l(h)}catch(C){throw C.code===12&&C.message==="sampleRate is not in range"?t():C}if(p===null)throw r();if(!i4(h.latencyHint))throw new TypeError(`The provided value '${h.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(h.sampleRate!==void 0&&p.sampleRate!==h.sampleRate)throw t();super(p,2);const{latencyHint:g}=h,{sampleRate:y}=p;if(this._baseLatency=typeof p.baseLatency=="number"?p.baseLatency:g==="balanced"?512/y:g==="interactive"||g===void 0?256/y:g==="playback"?1024/y:Math.max(2,Math.min(128,Math.round(g*y/128)))*128/y,this._nativeAudioContext=p,l.name==="webkitAudioContext"?(this._nativeGainNode=p.createGain(),this._nativeOscillatorNode=p.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(p.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,p.state==="running"){this._state="suspended";const C=()=>{this._state==="suspended"&&(this._state=null),p.removeEventListener("statechange",C)};p.addEventListener("statechange",C)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),r4(this)}))}createMediaElementSource(h){return new i(this,{mediaElement:h})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(h){return new c(this,{mediaStream:h})}createMediaStreamTrackSource(h){return new s(this,{mediaStreamTrack:h})}resume(){return this._state==="suspended"?new Promise((h,p)=>{const g=()=>{this._nativeAudioContext.removeEventListener("statechange",g),this._nativeAudioContext.state==="running"?h():this.resume().then(h,p)};this._nativeAudioContext.addEventListener("statechange",g)}):this._nativeAudioContext.resume().catch(h=>{throw h===void 0||h.code===15?e():h})}suspend(){return this._nativeAudioContext.suspend().catch(h=>{throw h===void 0?e():h})}},s4=(n,e,t,r,i,o,c,s)=>class extends n{constructor(d,h){const p=o(d),g=c(p),y=i(p,h,g),C=g?e(s):null;super(d,!1,y,C),this._isNodeOfNativeOfflineAudioContext=g,this._nativeAudioDestinationNode=y}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(d){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(d>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=d}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(d){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=d}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},a4=n=>{const e=new WeakMap,t=async(r,i)=>{const o=i.destination;return e.set(i,o),await n(r,i,o),o};return{render(r,i){const o=e.get(i);return o!==void 0?Promise.resolve(o):t(r,i)}}},c4=(n,e,t,r,i,o,c,s)=>(l,d)=>{const h=d.listener,p=()=>{const A=new Float32Array(1),_=e(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),D=c(d);let j=!1,Z=[0,0,-1,0,1,0],F=[0,0,0];const V=()=>{if(j)return;j=!0;const ve=r(d,256,9,0);ve.onaudioprocess=({inputBuffer:Ie})=>{const Re=[o(Ie,A,0),o(Ie,A,1),o(Ie,A,2),o(Ie,A,3),o(Ie,A,4),o(Ie,A,5)];Re.some((Ae,ke)=>Ae!==Z[ke])&&(h.setOrientation(...Re),Z=Re);const xe=[o(Ie,A,6),o(Ie,A,7),o(Ie,A,8)];xe.some((Ae,ke)=>Ae!==F[ke])&&(h.setPosition(...xe),F=xe)},_.connect(ve)},X=ve=>Ie=>{Ie!==Z[ve]&&(Z[ve]=Ie,h.setOrientation(...Z))},te=ve=>Ie=>{Ie!==F[ve]&&(F[ve]=Ie,h.setPosition(...F))},pe=(ve,Ie,Re)=>{const xe=t(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Ie});xe.connect(_,0,ve),xe.start(),Object.defineProperty(xe.offset,"defaultValue",{get(){return Ie}});const Ae=n({context:l},D,xe.offset,zi,ho);return s(Ae,"value",ke=>()=>ke.call(Ae),ke=>H=>{try{ke.call(Ae,H)}catch(ee){if(ee.code!==9)throw ee}V(),D&&Re(H)}),Ae.cancelAndHoldAtTime=(ke=>D?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return V(),ee})(Ae.cancelAndHoldAtTime),Ae.cancelScheduledValues=(ke=>D?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return V(),ee})(Ae.cancelScheduledValues),Ae.exponentialRampToValueAtTime=(ke=>D?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return V(),ee})(Ae.exponentialRampToValueAtTime),Ae.linearRampToValueAtTime=(ke=>D?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return V(),ee})(Ae.linearRampToValueAtTime),Ae.setTargetAtTime=(ke=>D?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return V(),ee})(Ae.setTargetAtTime),Ae.setValueAtTime=(ke=>D?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return V(),ee})(Ae.setValueAtTime),Ae.setValueCurveAtTime=(ke=>D?()=>{throw i()}:(...H)=>{const ee=ke.apply(Ae,H);return V(),ee})(Ae.setValueCurveAtTime),Ae};return{forwardX:pe(0,0,X(0)),forwardY:pe(1,0,X(1)),forwardZ:pe(2,-1,X(2)),positionX:pe(6,0,te(0)),positionY:pe(7,0,te(1)),positionZ:pe(8,0,te(2)),upX:pe(3,0,X(3)),upY:pe(4,1,X(4)),upZ:pe(5,0,X(5))}},{forwardX:g,forwardY:y,forwardZ:C,positionX:x,positionY:w,positionZ:S,upX:E,upY:R,upZ:k}=h.forwardX===void 0?p():h;return{get forwardX(){return g},get forwardY(){return y},get forwardZ(){return C},get positionX(){return x},get positionY(){return w},get positionZ(){return S},get upX(){return E},get upY(){return R},get upZ(){return k}}},hp=n=>"context"in n,Mf=n=>hp(n[0]),Nl=(n,e,t,r)=>{for(const i of n)if(t(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return n.add(e),!0},BI=(n,e,[t,r],i)=>{Nl(n,[e,t,r],o=>o[0]===e&&o[1]===t,i)},LI=(n,[e,t,r],i)=>{const o=n.get(e);o===void 0?n.set(e,new Set([[t,r]])):Nl(o,[t,r],c=>c[0]===t,i)},Gu=n=>"inputs"in n,pp=(n,e,t,r)=>{if(Gu(e)){const i=e.inputs[r];return n.connect(i,t,0),[i,t,0]}return n.connect(e,t,r),[e,t,r]},Yk=(n,e,t)=>{for(const r of n)if(r[0]===e&&r[1]===t)return n.delete(r),r;return null},l4=(n,e,t)=>$p(n,r=>r[0]===e&&r[1]===t),Qk=(n,e)=>{if(!Rf(n).delete(e))throw new Error("Missing the expected event listener.")},Jk=(n,e,t)=>{const r=Ds(n,e),i=$p(r,o=>o[0]===t);return r.size===0&&n.delete(e),i},gp=(n,e,t,r)=>{Gu(e)?n.disconnect(e.inputs[r],t,0):n.disconnect(e,t,r)},fr=n=>Ds(Vk,n),of=n=>Ds(Wk,n),Sl=n=>ey.has(n),n0=n=>!Ou.has(n),UI=(n,e)=>new Promise(t=>{if(e!==null)t(!0);else{const r=n.createScriptProcessor(256,1,1),i=n.createGain(),o=n.createBuffer(1,2,44100),c=o.getChannelData(0);c[0]=1,c[1]=1;const s=n.createBufferSource();s.buffer=o,s.loop=!0,s.connect(r).connect(n.destination),s.connect(i),s.disconnect(i),r.onaudioprocess=l=>{const d=l.inputBuffer.getChannelData(0);Array.prototype.some.call(d,h=>h===1)?t(!0):t(!1),s.stop(),r.onaudioprocess=null,s.disconnect(r),r.disconnect(n.destination)},s.start()}}),Km=(n,e)=>{const t=new Map;for(const r of n)for(const i of r){const o=t.get(i);t.set(i,o===void 0?1:o+1)}t.forEach((r,i)=>e(i,r))},mp=n=>"context"in n,u4=n=>{const e=new Map;n.connect=(t=>(r,i=0,o=0)=>{const c=mp(r)?t(r,i,o):t(r,i),s=e.get(r);return s===void 0?e.set(r,[{input:o,output:i}]):s.every(l=>l.input!==o||l.output!==i)&&s.push({input:o,output:i}),c})(n.connect.bind(n)),n.disconnect=(t=>(r,i,o)=>{if(t.apply(n),r===void 0)e.clear();else if(typeof r=="number")for(const[c,s]of e){const l=s.filter(d=>d.output!==r);l.length===0?e.delete(c):e.set(c,l)}else if(e.has(r))if(i===void 0)e.delete(r);else{const c=e.get(r);if(c!==void 0){const s=c.filter(l=>l.output!==i&&(l.input!==o||o===void 0));s.length===0?e.delete(r):e.set(r,s)}}for(const[c,s]of e)s.forEach(l=>{mp(c)?n.connect(c,l.output,l.input):n.connect(c,l.output)})})(n.disconnect)},d4=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:o}=Pf(e),{outputs:c}=Xi(n),s=Rf(n),l=d=>{const h=fr(n),p=of(e);if(d){const g=Jk(o,n,t);BI(i,n,g,!1),!r&&!Sl(n)&&h.connect(p,t)}else{const g=l4(i,n,t);LI(o,g,!1),!r&&!Sl(n)&&h.disconnect(p,t)}};return Nl(c,[e,t],d=>d[0]===e&&d[1]===t,!0)?(s.add(l),La(n)?BI(i,n,[t,l],!0):LI(o,[n,t,l],!0),!0):!1},f4=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:o}=Xi(e),c=Yk(i[r],n,t);return c===null?[Xk(o,n,t,r)[2],!1]:[c[2],!0]},h4=(n,e,t)=>{const{activeInputs:r,passiveInputs:i}=Pf(e),o=Yk(r,n,t);return o===null?[Jk(i,n,t)[1],!1]:[o[2],!0]},IC=(n,e,t,r,i)=>{const[o,c]=f4(n,t,r,i);if(o!==null&&(Qk(n,o),c&&!e&&!Sl(n)&&gp(fr(n),fr(t),r,i)),La(t)){const{activeInputs:s}=Xi(t);ry(t,s)}},wC=(n,e,t,r)=>{const[i,o]=h4(n,t,r);i!==null&&(Qk(n,i),o&&!e&&!Sl(n)&&fr(n).disconnect(of(t),r))},p4=(n,e)=>{const t=Xi(n),r=[];for(const i of t.outputs)Mf(i)?IC(n,e,...i):wC(n,e,...i),r.push(i[0]);return t.outputs.clear(),r},g4=(n,e,t)=>{const r=Xi(n),i=[];for(const o of r.outputs)o[1]===t&&(Mf(o)?IC(n,e,...o):wC(n,e,...o),i.push(o[0]),r.outputs.delete(o));return i},m4=(n,e,t,r,i)=>{const o=Xi(n);return Array.from(o.outputs).filter(c=>c[0]===t&&(r===void 0||c[1]===r)&&(i===void 0||c[2]===i)).map(c=>(Mf(c)?IC(n,e,...c):wC(n,e,...c),o.outputs.delete(c),c[0]))},v4=(n,e,t,r,i,o,c,s,l,d,h,p,g,y,C,x)=>class extends d{constructor(S,E,R,k){super(R),this._context=S,this._nativeAudioNode=R;const A=h(S);p(A)&&t(UI,()=>UI(A,x))!==!0&&u4(R),Vk.set(this,R),Hk.set(this,new Set),S.state!=="closed"&&E&&Fu(this),n(this,k,R)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(S){this._nativeAudioNode.channelCount=S}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(S){this._nativeAudioNode.channelCountMode=S}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(S){this._nativeAudioNode.channelInterpretation=S}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(S,E=0,R=0){if(E<0||E>=this._nativeAudioNode.numberOfOutputs)throw i();const k=h(this._context),A=C(k);if(g(S)||y(S))throw o();if(hp(S)){const j=fr(S);try{const F=pp(this._nativeAudioNode,j,E,R),V=n0(this);(A||V)&&this._nativeAudioNode.disconnect(...F),this.context.state!=="closed"&&!V&&n0(S)&&Fu(S)}catch(F){throw F.code===12?o():F}if(e(this,S,E,R,A)){const F=l([this],S);Km(F,r(A))}return S}const _=of(S);if(_.name==="playbackRate"&&_.maxValue===1024)throw c();try{this._nativeAudioNode.connect(_,E),(A||n0(this))&&this._nativeAudioNode.disconnect(_,E)}catch(j){throw j.code===12?o():j}if(d4(this,S,E,A)){const j=l([this],S);Km(j,r(A))}}disconnect(S,E,R){let k;const A=h(this._context),_=C(A);if(S===void 0)k=p4(this,_);else if(typeof S=="number"){if(S<0||S>=this.numberOfOutputs)throw i();k=g4(this,_,S)}else{if(E!==void 0&&(E<0||E>=this.numberOfOutputs)||hp(S)&&R!==void 0&&(R<0||R>=S.numberOfInputs))throw i();if(k=m4(this,_,S,E,R),k.length===0)throw o()}for(const D of k){const j=l([this],D);Km(j,s)}}},y4=(n,e,t,r,i,o,c,s,l,d,h,p,g)=>(y,C,x,w=null,S=null)=>{const E=x.value,R=new EM(E),k=C?r(R):null,A={get defaultValue(){return E},get maxValue(){return w===null?x.maxValue:w},get minValue(){return S===null?x.minValue:S},get value(){return x.value},set value(_){x.value=_,A.setValueAtTime(_,y.context.currentTime)},cancelAndHoldAtTime(_){if(typeof x.cancelAndHoldAtTime=="function")k===null&&R.flush(y.context.currentTime),R.add(i(_)),x.cancelAndHoldAtTime(_);else{const D=Array.from(R).pop();k===null&&R.flush(y.context.currentTime),R.add(i(_));const j=Array.from(R).pop();x.cancelScheduledValues(_),D!==j&&j!==void 0&&(j.type==="exponentialRampToValue"?x.exponentialRampToValueAtTime(j.value,j.endTime):j.type==="linearRampToValue"?x.linearRampToValueAtTime(j.value,j.endTime):j.type==="setValue"?x.setValueAtTime(j.value,j.startTime):j.type==="setValueCurve"&&x.setValueCurveAtTime(j.values,j.startTime,j.duration))}return A},cancelScheduledValues(_){return k===null&&R.flush(y.context.currentTime),R.add(o(_)),x.cancelScheduledValues(_),A},exponentialRampToValueAtTime(_,D){if(_===0)throw new RangeError;if(!Number.isFinite(D)||D<0)throw new RangeError;const j=y.context.currentTime;return k===null&&R.flush(j),Array.from(R).length===0&&(R.add(d(E,j)),x.setValueAtTime(E,j)),R.add(c(_,D)),x.exponentialRampToValueAtTime(_,D),A},linearRampToValueAtTime(_,D){const j=y.context.currentTime;return k===null&&R.flush(j),Array.from(R).length===0&&(R.add(d(E,j)),x.setValueAtTime(E,j)),R.add(s(_,D)),x.linearRampToValueAtTime(_,D),A},setTargetAtTime(_,D,j){return k===null&&R.flush(y.context.currentTime),R.add(l(_,D,j)),x.setTargetAtTime(_,D,j),A},setValueAtTime(_,D){return k===null&&R.flush(y.context.currentTime),R.add(d(_,D)),x.setValueAtTime(_,D),A},setValueCurveAtTime(_,D,j){const Z=_ instanceof Float32Array?_:new Float32Array(_);if(p!==null&&p.name==="webkitAudioContext"){const F=D+j,V=y.context.sampleRate,X=Math.ceil(D*V),te=Math.floor(F*V),pe=te-X,ve=new Float32Array(pe);for(let Re=0;Re<pe;Re+=1){const xe=(Z.length-1)/j*((X+Re)/V-D),Ae=Math.floor(xe),ke=Math.ceil(xe);ve[Re]=Ae===ke?Z[Ae]:(1-(xe-Ae))*Z[Ae]+(1-(ke-xe))*Z[ke]}k===null&&R.flush(y.context.currentTime),R.add(h(ve,D,j)),x.setValueCurveAtTime(ve,D,j);const Ie=te/V;Ie<F&&g(A,ve[ve.length-1],Ie),g(A,Z[Z.length-1],F)}else k===null&&R.flush(y.context.currentTime),R.add(h(Z,D,j)),x.setValueCurveAtTime(Z,D,j);return A}};return t.set(A,x),e.set(A,y),n(A,k),A},C4=n=>({replay(e){for(const t of n)if(t.type==="exponentialRampToValue"){const{endTime:r,value:i}=t;e.exponentialRampToValueAtTime(i,r)}else if(t.type==="linearRampToValue"){const{endTime:r,value:i}=t;e.linearRampToValueAtTime(i,r)}else if(t.type==="setTarget"){const{startTime:r,target:i,timeConstant:o}=t;e.setTargetAtTime(i,r,o)}else if(t.type==="setValue"){const{startTime:r,value:i}=t;e.setValueAtTime(i,r)}else if(t.type==="setValueCurve"){const{duration:r,startTime:i,values:o}=t;e.setValueCurveAtTime(o,i,r)}else throw new Error("Can't apply an unknown automation.")}});class eE{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((r,i)=>e.call(t,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const x4={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},b4=(n,e,t,r,i,o,c,s,l,d,h,p,g,y)=>class extends e{constructor(x,w,S){var E;const R=s(x),k=l(R),A=h({...x4,...S});g(A);const _=ty.get(R),D=_==null?void 0:_.get(w),j=k||R.state!=="closed"?R:(E=c(R))!==null&&E!==void 0?E:R,Z=i(j,k?null:x.baseLatency,d,w,D,A),F=k?r(w,A,D):null;super(x,!0,Z,F);const V=[];Z.parameters.forEach((te,pe)=>{const ve=t(this,k,te);V.push([pe,ve])}),this._nativeAudioWorkletNode=Z,this._onprocessorerror=null,this._parameters=new eE(V),k&&n(R,this);const{activeInputs:X}=o(this);p(Z,X)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(x){const w=typeof x=="function"?y(this,x):null;this._nativeAudioWorkletNode.onprocessorerror=w;const S=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=S!==null&&S===w?x:S}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function vp(n,e,t,r,i){if(typeof n.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),n.copyFromChannel(e[t],r,i);else{const o=n.getChannelData(r);if(e[t].byteLength===0)e[t]=o.slice(i,i+128);else{const c=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(c)}}}const tE=(n,e,t,r,i)=>{typeof n.copyToChannel=="function"?e[t].byteLength!==0&&n.copyToChannel(e[t],r,i):e[t].byteLength!==0&&n.getChannelData(r).set(e[t],i)},yp=(n,e)=>{const t=[];for(let r=0;r<n;r+=1){const i=[],o=typeof e=="number"?e:e[r];for(let c=0;c<o;c+=1)i.push(new Float32Array(128));t.push(i)}return t},I4=(n,e)=>{const t=Ds(ny,n),r=fr(e);return Ds(t,r)},w4=async(n,e,t,r,i,o,c)=>{const s=e===null?Math.ceil(n.context.length/128)*128:e.length,l=r.channelCount*r.numberOfInputs,d=i.reduce((w,S)=>w+S,0),h=d===0?null:t.createBuffer(d,s,t.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const p=Xi(n),g=await I4(t,n),y=yp(r.numberOfInputs,r.channelCount),C=yp(r.numberOfOutputs,i),x=Array.from(n.parameters.keys()).reduce((w,S)=>({...w,[S]:new Float32Array(128)}),{});for(let w=0;w<s;w+=128){if(r.numberOfInputs>0&&e!==null)for(let S=0;S<r.numberOfInputs;S+=1)for(let E=0;E<r.channelCount;E+=1)vp(e,y[S],E,E,w);o.parameterDescriptors!==void 0&&e!==null&&o.parameterDescriptors.forEach(({name:S},E)=>{vp(e,x,S,l+E,w)});for(let S=0;S<r.numberOfInputs;S+=1)for(let E=0;E<i[S];E+=1)C[S][E].byteLength===0&&(C[S][E]=new Float32Array(128));try{const S=y.map((R,k)=>p.activeInputs[k].size===0?[]:R),E=c(w/t.sampleRate,t.sampleRate,()=>g.process(S,C,x));if(h!==null)for(let R=0,k=0;R<r.numberOfOutputs;R+=1){for(let A=0;A<i[R];A+=1)tE(h,C[R],A,k+A,w);k+=i[R]}if(!E)break}catch(S){n.dispatchEvent(new ErrorEvent("processorerror",{colno:S.colno,filename:S.filename,lineno:S.lineno,message:S.message}));break}}return h},S4=(n,e,t,r,i,o,c,s,l,d,h,p,g,y,C,x)=>(w,S,E)=>{const R=new WeakMap;let k=null;const A=async(_,D)=>{let j=h(_),Z=null;const F=Oi(j,D),V=Array.isArray(S.outputChannelCount)?S.outputChannelCount:Array.from(S.outputChannelCount);if(p===null){const X=V.reduce((Ie,Re)=>Ie+Re,0),te=i(D,{channelCount:Math.max(1,X),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,X)}),pe=[];for(let Ie=0;Ie<_.numberOfOutputs;Ie+=1)pe.push(r(D,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:V[Ie]}));const ve=c(D,{channelCount:S.channelCount,channelCountMode:S.channelCountMode,channelInterpretation:S.channelInterpretation,gain:1});ve.connect=e.bind(null,pe),ve.disconnect=l.bind(null,pe),Z=[te,pe,ve]}else F||(j=new p(D,w));if(R.set(D,Z===null?j:Z[2]),Z!==null){if(k===null){if(E===void 0)throw new Error("Missing the processor constructor.");if(g===null)throw new Error("Missing the native OfflineAudioContext constructor.");const Re=_.channelCount*_.numberOfInputs,xe=E.parameterDescriptors===void 0?0:E.parameterDescriptors.length,Ae=Re+xe;k=w4(_,Ae===0?null:await(async()=>{const H=new g(Ae,Math.ceil(_.context.length/128)*128,D.sampleRate),ee=[],ae=[];for(let _e=0;_e<S.numberOfInputs;_e+=1)ee.push(c(H,{channelCount:S.channelCount,channelCountMode:S.channelCountMode,channelInterpretation:S.channelInterpretation,gain:1})),ae.push(i(H,{channelCount:S.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:S.channelCount}));const ye=await Promise.all(Array.from(_.parameters.values()).map(async _e=>{const Je=o(H,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:_e.value});return await y(H,_e,Je.offset),Je})),Ee=r(H,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,Re+xe)});for(let _e=0;_e<S.numberOfInputs;_e+=1){ee[_e].connect(ae[_e]);for(let Je=0;Je<S.channelCount;Je+=1)ae[_e].connect(Ee,Je,_e*S.channelCount+Je)}for(const[_e,Je]of ye.entries())Je.connect(Ee,0,Re+_e),Je.start(0);return Ee.connect(H.destination),await Promise.all(ee.map(_e=>C(_,H,_e))),x(H)})(),D,S,V,E,d)}const X=await k,te=t(D,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[pe,ve,Ie]=Z;X!==null&&(te.buffer=X,te.start(0)),te.connect(pe);for(let Re=0,xe=0;Re<_.numberOfOutputs;Re+=1){const Ae=ve[Re];for(let ke=0;ke<V[Re];ke+=1)pe.connect(Ae,xe+ke,ke);xe+=V[Re]}return Ie}if(F)for(const[X,te]of _.parameters.entries())await n(D,te,j.parameters.get(X));else for(const[X,te]of _.parameters.entries())await y(D,te,j.parameters.get(X));return await C(_,D,j),j};return{render(_,D){s(D,_);const j=R.get(D);return j!==void 0?Promise.resolve(j):A(_,D)}}},A4=(n,e,t,r,i,o,c,s,l,d,h,p,g,y,C,x,w,S,E,R)=>class extends C{constructor(A,_){super(A,_),this._nativeContext=A,this._audioWorklet=n===void 0?void 0:{addModule:(D,j)=>n(this,D,j)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(A,_,D){return new t({length:_,numberOfChannels:A,sampleRate:D})}createBufferSource(){return new r(this)}createChannelMerger(A=6){return new o(this,{numberOfInputs:A})}createChannelSplitter(A=6){return new c(this,{numberOfOutputs:A})}createConstantSource(){return new s(this)}createConvolver(){return new l(this)}createDelay(A=1){return new h(this,{maxDelayTime:A})}createDynamicsCompressor(){return new p(this)}createGain(){return new g(this)}createIIRFilter(A,_){return new y(this,{feedback:_,feedforward:A})}createOscillator(){return new x(this)}createPanner(){return new w(this)}createPeriodicWave(A,_,D={disableNormalization:!1}){return new S(this,{...D,imag:_,real:A})}createStereoPanner(){return new E(this)}createWaveShaper(){return new R(this)}decodeAudioData(A,_,D){return d(this._nativeContext,A).then(j=>(typeof _=="function"&&_(j),j),j=>{throw typeof D=="function"&&D(j),j})}},k4={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},E4=(n,e,t,r,i,o,c,s)=>class extends n{constructor(d,h){const p=o(d),g={...k4,...h},y=i(p,g),C=c(p),x=C?t():null;super(d,!1,y,x),this._Q=e(this,C,y.Q,zi,ho),this._detune=e(this,C,y.detune,1200*Math.log2(zi),-1200*Math.log2(zi)),this._frequency=e(this,C,y.frequency,d.sampleRate/2,0),this._gain=e(this,C,y.gain,40*Math.log10(zi),ho),this._nativeBiquadFilterNode=y,s(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(d){this._nativeBiquadFilterNode.type=d}getFrequencyResponse(d,h,p){try{this._nativeBiquadFilterNode.getFrequencyResponse(d,h,p)}catch(g){throw g.code===11?r():g}if(d.length!==h.length||h.length!==p.length)throw r()}},T4=(n,e,t,r,i)=>()=>{const o=new WeakMap,c=async(s,l)=>{let d=t(s);const h=Oi(d,l);if(!h){const p={Q:d.Q.value,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,gain:d.gain.value,type:d.type};d=e(l,p)}return o.set(l,d),h?(await n(l,s.Q,d.Q),await n(l,s.detune,d.detune),await n(l,s.frequency,d.frequency),await n(l,s.gain,d.gain)):(await r(l,s.Q,d.Q),await r(l,s.detune,d.detune),await r(l,s.frequency,d.frequency),await r(l,s.gain,d.gain)),await i(s,l,d),d};return{render(s,l){const d=o.get(l);return d!==void 0?Promise.resolve(d):c(s,l)}}},_4=(n,e)=>(t,r)=>{const i=e.get(t);if(i!==void 0)return i;const o=n.get(t);if(o!==void 0)return o;try{const c=r();return c instanceof Promise?(n.set(t,c),c.catch(()=>!1).then(s=>(n.delete(t),e.set(t,s),s))):(e.set(t,c),c)}catch{return e.set(t,!1),!1}},R4={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},D4=(n,e,t,r,i)=>class extends n{constructor(c,s){const l=r(c),d={...R4,...s},h=t(l,d),p=i(l)?e():null;super(c,!1,h,p)}},P4=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,c)=>{let s=e(o);if(!Oi(s,c)){const d={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfInputs:s.numberOfInputs};s=n(c,d)}return r.set(c,s),await t(o,c,s),s};return{render(o,c){const s=r.get(c);return s!==void 0?Promise.resolve(s):i(o,c)}}},M4={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},N4=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const d=r(s),h=o({...M4,...l}),p=t(d,h),g=i(d)?e():null;super(s,!1,p,g)}},O4=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,c)=>{let s=e(o);if(!Oi(s,c)){const d={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfOutputs:s.numberOfOutputs};s=n(c,d)}return r.set(c,s),await t(o,c,s),s};return{render(o,c){const s=r.get(c);return s!==void 0?Promise.resolve(s):i(o,c)}}},F4=n=>(e,t,r)=>n(t,e,r),B4=n=>(e,t,r=0,i=0)=>{const o=e[r];if(o===void 0)throw n();return mp(t)?o.connect(t,0,i):o.connect(t,0)},L4=n=>(e,t)=>{const r=n(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}},U4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},j4=(n,e,t,r,i,o,c)=>class extends n{constructor(l,d){const h=i(l),p={...U4,...d},g=r(h,p),y=o(h),C=y?t():null;super(l,!1,g,C),this._constantSourceNodeRenderer=C,this._nativeConstantSourceNode=g,this._offset=e(this,y,g.offset,zi,ho),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const d=typeof l=="function"?c(this,l):null;this._nativeConstantSourceNode.onended=d;const h=this._nativeConstantSourceNode.onended;this._onended=h!==null&&h===d?l:h}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Fu(this);const d=()=>{this._nativeConstantSourceNode.removeEventListener("ended",d),La(this)&&Df(this)};this._nativeConstantSourceNode.addEventListener("ended",d)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},V4=(n,e,t,r,i)=>()=>{const o=new WeakMap;let c=null,s=null;const l=async(d,h)=>{let p=t(d);const g=Oi(p,h);if(!g){const y={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,offset:p.offset.value};p=e(h,y),c!==null&&p.start(c),s!==null&&p.stop(s)}return o.set(h,p),g?await n(h,d.offset,p.offset):await r(h,d.offset,p.offset),await i(d,h,p),p};return{set start(d){c=d},set stop(d){s=d},render(d,h){const p=o.get(h);return p!==void 0?Promise.resolve(p):l(d,h)}}},G4=n=>e=>(n[0]=e,n[0]),W4={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},z4=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const d=r(s),h={...W4,...l},p=t(d,h),y=i(d)?e():null;super(s,!1,p,y),this._isBufferNullified=!1,this._nativeConvolverNode=p,h.buffer!==null&&o(this,h.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(s){if(this._nativeConvolverNode.buffer=s,s===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(s){this._nativeConvolverNode.normalize=s}},H4=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,c)=>{let s=e(o);if(!Oi(s,c)){const d={buffer:s.buffer,channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,disableNormalization:!s.normalize};s=n(c,d)}return r.set(c,s),Gu(s)?await t(o,c,s.inputs[0]):await t(o,c,s),s};return{render(o,c){const s=r.get(c);return s!==void 0?Promise.resolve(s):i(o,c)}}},Z4=()=>new DOMException("","DataCloneError"),jI=n=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(r=>{const i=()=>{t.onmessage=null,e.close(),t.close(),r()};t.onmessage=()=>i();try{e.postMessage(n,[n])}catch{}finally{i()}})},X4=(n,e,t,r,i,o,c,s,l,d,h)=>(p,g)=>{const y=c(p)?p:o(p);if(i.has(g)){const C=t();return Promise.reject(C)}try{i.add(g)}catch{}return e(l,()=>l(y))?y.decodeAudioData(g).then(C=>(jI(g).catch(()=>{}),e(s,()=>s(C))||h(C),n.add(C),C)):new Promise((C,x)=>{const w=async()=>{try{await jI(g)}catch{}},S=E=>{x(E),w()};try{y.decodeAudioData(g,E=>{typeof E.copyFromChannel!="function"&&(d(E),Kk(E)),n.add(E),w().then(()=>C(E))},E=>{S(E===null?r():E)})}catch(E){S(E)}})},$4=(n,e,t,r,i,o,c,s)=>(l,d)=>{const h=e.get(l);if(h===void 0)throw new Error("Missing the expected cycle count.");const p=o(l.context),g=s(p);if(h===d){if(e.delete(l),!g&&c(l)){const y=r(l),{outputs:C}=t(l);for(const x of C)if(Mf(x)){const w=r(x[0]);n(y,w,x[1],x[2])}else{const w=i(x[0]);y.connect(w,x[1])}}}else e.set(l,h-d)},K4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},q4=(n,e,t,r,i,o,c)=>class extends n{constructor(l,d){const h=i(l),p={...K4,...d},g=r(h,p),y=o(h),C=y?t(p.maxDelayTime):null;super(l,!1,g,C),this._delayTime=e(this,y,g.delayTime),c(this,p.maxDelayTime)}get delayTime(){return this._delayTime}},Y4=(n,e,t,r,i)=>o=>{const c=new WeakMap,s=async(l,d)=>{let h=t(l);const p=Oi(h,d);if(!p){const g={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:o};h=e(d,g)}return c.set(d,h),p?await n(d,l.delayTime,h.delayTime):await r(d,l.delayTime,h.delayTime),await i(l,d,h),h};return{render(l,d){const h=c.get(d);return h!==void 0?Promise.resolve(h):s(l,d)}}},Q4=n=>(e,t,r,i)=>n(e[i],o=>o[0]===t&&o[1]===r),J4=n=>(e,t)=>{n(e).delete(t)},e5=n=>"delayTime"in n,t5=(n,e,t)=>function r(i,o){const c=hp(o)?o:t(n,o);if(e5(c))return[];if(i[0]===c)return[i];if(i.includes(c))return[];const{outputs:s}=e(c);return Array.from(s).map(l=>r([...i,c],l[0])).reduce((l,d)=>l.concat(d),[])},Uh=(n,e,t)=>{const r=e[t];if(r===void 0)throw n();return r},n5=n=>(e,t=void 0,r=void 0,i=0)=>t===void 0?e.forEach(o=>o.disconnect()):typeof t=="number"?Uh(n,e,t).disconnect():mp(t)?r===void 0?e.forEach(o=>o.disconnect(t)):i===void 0?Uh(n,e,r).disconnect(t,0):Uh(n,e,r).disconnect(t,0,i):r===void 0?e.forEach(o=>o.disconnect(t)):Uh(n,e,r).disconnect(t,0),r5={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},i5=(n,e,t,r,i,o,c,s)=>class extends n{constructor(d,h){const p=o(d),g={...r5,...h},y=r(p,g),C=c(p),x=C?t():null;super(d,!1,y,x),this._attack=e(this,C,y.attack),this._knee=e(this,C,y.knee),this._nativeDynamicsCompressorNode=y,this._ratio=e(this,C,y.ratio),this._release=e(this,C,y.release),this._threshold=e(this,C,y.threshold),s(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(d){const h=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=d,d>2)throw this._nativeDynamicsCompressorNode.channelCount=h,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(d){const h=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=d,d==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=h,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},o5=(n,e,t,r,i)=>()=>{const o=new WeakMap,c=async(s,l)=>{let d=t(s);const h=Oi(d,l);if(!h){const p={attack:d.attack.value,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,knee:d.knee.value,ratio:d.ratio.value,release:d.release.value,threshold:d.threshold.value};d=e(l,p)}return o.set(l,d),h?(await n(l,s.attack,d.attack),await n(l,s.knee,d.knee),await n(l,s.ratio,d.ratio),await n(l,s.release,d.release),await n(l,s.threshold,d.threshold)):(await r(l,s.attack,d.attack),await r(l,s.knee,d.knee),await r(l,s.ratio,d.ratio),await r(l,s.release,d.release),await r(l,s.threshold,d.threshold)),await i(s,l,d),d};return{render(s,l){const d=o.get(l);return d!==void 0?Promise.resolve(d):c(s,l)}}},s5=()=>new DOMException("","EncodingError"),a5=n=>e=>new Promise((t,r)=>{if(n===null){r(new SyntaxError);return}const i=n.document.head;if(i===null)r(new SyntaxError);else{const o=n.document.createElement("script"),c=new Blob([e],{type:"application/javascript"}),s=URL.createObjectURL(c),l=n.onerror,d=()=>{n.onerror=l,URL.revokeObjectURL(s)};n.onerror=(h,p,g,y,C)=>{if(p===s||p===n.location.href&&g===1&&y===1)return d(),r(C),!1;if(l!==null)return l(h,p,g,y,C)},o.onerror=()=>{d(),r(new SyntaxError)},o.onload=()=>{d(),t()},o.src=s,o.type="module",i.appendChild(o)}}),c5=n=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,i){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=n(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(t,o,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,i){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,o===void 0?null:o,i)}},l5=n=>(e,t,r)=>{Object.defineProperties(n,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{n!==null&&(delete n.currentFrame,delete n.currentTime)}},u5=n=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw n()},d5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},f5=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const d=i(s),h={...d5,...l},p=r(d,h),g=o(d),y=g?t():null;super(s,!1,p,y),this._gain=e(this,g,p.gain,zi,ho)}get gain(){return this._gain}},h5=(n,e,t,r,i)=>()=>{const o=new WeakMap,c=async(s,l)=>{let d=t(s);const h=Oi(d,l);if(!h){const p={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,gain:d.gain.value};d=e(l,p)}return o.set(l,d),h?await n(l,s.gain,d.gain):await r(l,s.gain,d.gain),await i(s,l,d),d};return{render(s,l){const d=o.get(l);return d!==void 0?Promise.resolve(d):c(s,l)}}},p5=(n,e)=>t=>e(n,t),g5=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},m5=n=>e=>{var t;return(t=n.get(e))!==null&&t!==void 0?t:0},v5=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},y5=n=>e=>n.get(e),xi=()=>new DOMException("","InvalidStateError"),C5=n=>e=>{const t=n.get(e);if(t===void 0)throw xi();return t},x5=(n,e)=>t=>{let r=n.get(t);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),n.set(t,r),r},b5=n=>e=>{const t=n.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},Kp=()=>new DOMException("","InvalidAccessError"),I5=n=>{n.getFrequencyResponse=(e=>(t,r,i)=>{if(t.length!==r.length||r.length!==i.length)throw Kp();return e.call(n,t,r,i)})(n.getFrequencyResponse)},w5={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},S5=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const d=r(s),h=i(d),p={...w5,...l},g=e(d,h?null:s.baseLatency,p),y=h?t(p.feedback,p.feedforward):null;super(s,!1,g,y),I5(g),this._nativeIIRFilterNode=g,o(this,1)}getFrequencyResponse(s,l,d){return this._nativeIIRFilterNode.getFrequencyResponse(s,l,d)}},nE=(n,e,t,r,i,o,c,s,l,d,h)=>{const p=d.length;let g=s;for(let y=0;y<p;y+=1){let C=t[0]*d[y];for(let x=1;x<i;x+=1){const w=g-x&l-1;C+=t[x]*o[w],C-=n[x]*c[w]}for(let x=i;x<r;x+=1)C+=t[x]*o[g-x&l-1];for(let x=i;x<e;x+=1)C-=n[x]*c[g-x&l-1];o[g]=d[y],c[g]=C,g=g+1&l-1,h[y]=C}return g},A5=(n,e,t,r)=>{const i=t instanceof Float64Array?t:new Float64Array(t),o=r instanceof Float64Array?r:new Float64Array(r),c=i.length,s=o.length,l=Math.min(c,s);if(i[0]!==1){for(let C=0;C<c;C+=1)o[C]/=i[0];for(let C=1;C<s;C+=1)i[C]/=i[0]}const d=32,h=new Float32Array(d),p=new Float32Array(d),g=e.createBuffer(n.numberOfChannels,n.length,n.sampleRate),y=n.numberOfChannels;for(let C=0;C<y;C+=1){const x=n.getChannelData(C),w=g.getChannelData(C);h.fill(0),p.fill(0),nE(i,c,o,s,l,h,p,0,d,x,w)}return g},k5=(n,e,t,r,i)=>(o,c)=>{const s=new WeakMap;let l=null;const d=async(h,p)=>{let g=null,y=e(h);const C=Oi(y,p);if(p.createIIRFilter===void 0?g=n(p,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):C||(y=p.createIIRFilter(c,o)),s.set(p,g===null?y:g),g!==null){if(l===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const w=new t(h.context.destination.channelCount,h.context.length,p.sampleRate);l=(async()=>{await r(h,w,w.destination);const S=await i(w);return A5(S,p,o,c)})()}const x=await l;return g.buffer=x,g.start(0),g}return await r(h,p,y),y};return{render(h,p){const g=s.get(p);return g!==void 0?Promise.resolve(g):d(h,p)}}},E5=(n,e,t,r,i,o)=>c=>(s,l)=>{const d=n.get(s);if(d===void 0){if(!c&&o(s)){const h=r(s),{outputs:p}=t(s);for(const g of p)if(Mf(g)){const y=r(g[0]);e(h,y,g[1],g[2])}else{const y=i(g[0]);h.disconnect(y,g[1])}}n.set(s,l)}else n.set(s,d+l)},T5=n=>e=>n!==null&&e instanceof n,_5=n=>e=>n!==null&&typeof n.AudioNode=="function"&&e instanceof n.AudioNode,R5=n=>e=>n!==null&&typeof n.AudioParam=="function"&&e instanceof n.AudioParam,D5=(n,e)=>t=>n(t)||e(t),P5=n=>e=>n!==null&&e instanceof n,M5=n=>n!==null&&n.isSecureContext,N5=(n,e,t,r)=>class extends n{constructor(o,c){const s=t(o),l=e(s,c);if(r(s))throw TypeError();super(o,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},O5={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},F5=(n,e,t,r)=>class extends n{constructor(o,c){const s=t(o);if(r(s))throw new TypeError;const l={...O5,...c},d=e(s,l);super(o,!1,d,null),this._nativeMediaStreamAudioDestinationNode=d}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},B5=(n,e,t,r)=>class extends n{constructor(o,c){const s=t(o),l=e(s,c);if(r(s))throw new TypeError;super(o,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},L5=(n,e,t)=>class extends n{constructor(i,o){const c=t(i),s=e(c,o);super(i,!0,s,null)}},U5=(n,e,t,r,i,o)=>class extends t{constructor(s,l){super(s),this._nativeContext=s,zk.set(this,s),r(s)&&i.set(s,new Set),this._destination=new n(this,l),this._listener=e(this,s),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(s){const l=typeof s=="function"?o(this,s):null;this._nativeContext.onstatechange=l;const d=this._nativeContext.onstatechange;this._onstatechange=d!==null&&d===l?s:d}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},sy=n=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=n.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},j5=(n,e)=>(t,r,i)=>{const o=new Set;return t.connect=(c=>(s,l=0,d=0)=>{const h=o.size===0;if(e(s))return c.call(t,s,l,d),n(o,[s,l,d],p=>p[0]===s&&p[1]===l&&p[2]===d,!0),h&&r(),s;c.call(t,s,l),n(o,[s,l],p=>p[0]===s&&p[1]===l,!0),h&&r()})(t.connect),t.disconnect=(c=>(s,l,d)=>{const h=o.size>0;if(s===void 0)c.apply(t),o.clear();else if(typeof s=="number"){c.call(t,s);for(const g of o)g[1]===s&&o.delete(g)}else{e(s)?c.call(t,s,l,d):c.call(t,s,l);for(const g of o)g[0]===s&&(l===void 0||g[1]===l)&&(d===void 0||g[2]===d)&&o.delete(g)}const p=o.size===0;h&&p&&i()})(t.disconnect),t},mr=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t]&&(n[t]=r)},Jr=(n,e)=>{mr(n,e,"channelCount"),mr(n,e,"channelCountMode"),mr(n,e,"channelInterpretation")},VI=n=>typeof n.getFloatTimeDomainData=="function",V5=n=>{n.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);n.getByteTimeDomainData(t);const r=Math.max(t.length,n.fftSize);for(let i=0;i<r;i+=1)e[i]=(t[i]-128)*.0078125;return e}},G5=(n,e)=>(t,r)=>{const i=t.createAnalyser();if(Jr(i,r),!(r.maxDecibels>r.minDecibels))throw e();return mr(i,r,"fftSize"),mr(i,r,"maxDecibels"),mr(i,r,"minDecibels"),mr(i,r,"smoothingTimeConstant"),n(VI,()=>VI(i))||V5(i),i},W5=n=>n===null?null:n.hasOwnProperty("AudioBuffer")?n.AudioBuffer:null,Rr=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t].value&&(n[t].value=r)},z5=n=>{n.start=(e=>{let t=!1;return(r=0,i=0,o)=>{if(t)throw xi();e.call(n,r,i,o),t=!0}})(n.start)},SC=n=>{n.start=(e=>(t=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(n,t,r,i)})(n.start)},AC=n=>{n.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(n,t)})(n.stop)},H5=(n,e,t,r,i,o,c,s,l,d,h)=>(p,g)=>{const y=p.createBufferSource();return Jr(y,g),Rr(y,g,"playbackRate"),mr(y,g,"buffer"),mr(y,g,"loop"),mr(y,g,"loopEnd"),mr(y,g,"loopStart"),e(t,()=>t(p))||z5(y),e(r,()=>r(p))||l(y),e(i,()=>i(p))||d(y,p),e(o,()=>o(p))||SC(y),e(c,()=>c(p))||h(y,p),e(s,()=>s(p))||AC(y),n(p,y),y},Z5=n=>n===null?null:n.hasOwnProperty("AudioContext")?n.AudioContext:n.hasOwnProperty("webkitAudioContext")?n.webkitAudioContext:null,X5=(n,e)=>(t,r,i)=>{const o=t.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}i&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const c=n(t,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(c,"channelCount",s=>()=>s.call(c),s=>l=>{s.call(c,l);try{o.channelCount=l}catch(d){if(l>o.maxChannelCount)throw d}}),e(c,"channelCountMode",s=>()=>s.call(c),s=>l=>{s.call(c,l),o.channelCountMode=l}),e(c,"channelInterpretation",s=>()=>s.call(c),s=>l=>{s.call(c,l),o.channelInterpretation=l}),Object.defineProperty(c,"maxChannelCount",{get:()=>o.maxChannelCount}),c.connect(o),c},$5=n=>n===null?null:n.hasOwnProperty("AudioWorkletNode")?n.AudioWorkletNode:null,K5=n=>{const{port1:e}=new MessageChannel;try{e.postMessage(n)}finally{e.close()}},q5=(n,e,t,r,i)=>(o,c,s,l,d,h)=>{if(s!==null)try{const p=new s(o,l,h),g=new Map;let y=null;if(Object.defineProperties(p,{channelCount:{get:()=>h.channelCount,set:()=>{throw n()}},channelCountMode:{get:()=>"explicit",set:()=>{throw n()}},onprocessorerror:{get:()=>y,set:C=>{typeof y=="function"&&p.removeEventListener("processorerror",y),y=typeof C=="function"?C:null,typeof y=="function"&&p.addEventListener("processorerror",y)}}}),p.addEventListener=(C=>(...x)=>{if(x[0]==="processorerror"){const w=typeof x[1]=="function"?x[1]:typeof x[1]=="object"&&x[1]!==null&&typeof x[1].handleEvent=="function"?x[1].handleEvent:null;if(w!==null){const S=g.get(x[1]);S!==void 0?x[1]=S:(x[1]=E=>{E.type==="error"?(Object.defineProperties(E,{type:{value:"processorerror"}}),w(E)):w(new ErrorEvent(x[0],{...E}))},g.set(w,x[1]))}}return C.call(p,"error",x[1],x[2]),C.call(p,...x)})(p.addEventListener),p.removeEventListener=(C=>(...x)=>{if(x[0]==="processorerror"){const w=g.get(x[1]);w!==void 0&&(g.delete(x[1]),x[1]=w)}return C.call(p,"error",x[1],x[2]),C.call(p,x[0],x[1],x[2])})(p.removeEventListener),h.numberOfOutputs!==0){const C=t(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return p.connect(C).connect(o.destination),i(p,()=>C.disconnect(),()=>C.connect(o.destination))}return p}catch(p){throw p.code===11?r():p}if(d===void 0)throw r();return K5(h),e(o,c,d,h)},rE=(n,e)=>n===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(n*e))))),Y5=n=>new Promise((e,t)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:o})=>{r.close(),i.close(),e(o)},r.onmessageerror=({data:o})=>{r.close(),i.close(),t(o)},i.postMessage(n)}),Q5=async(n,e)=>{const t=await Y5(e);return new n(t)},J5=(n,e,t,r)=>{let i=ny.get(n);i===void 0&&(i=new WeakMap,ny.set(n,i));const o=Q5(t,r);return i.set(e,o),o},eN=(n,e,t,r,i,o,c,s,l,d,h,p,g)=>(y,C,x,w)=>{if(w.numberOfInputs===0&&w.numberOfOutputs===0)throw l();const S=Array.isArray(w.outputChannelCount)?w.outputChannelCount:Array.from(w.outputChannelCount);if(S.some(at=>at<1))throw l();if(S.length!==w.numberOfOutputs)throw e();if(w.channelCountMode!=="explicit")throw l();const E=w.channelCount*w.numberOfInputs,R=S.reduce((at,lt)=>at+lt,0),k=x.parameterDescriptors===void 0?0:x.parameterDescriptors.length;if(E+k>6||R>6)throw l();const A=new MessageChannel,_=[],D=[];for(let at=0;at<w.numberOfInputs;at+=1)_.push(c(y,{channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation,gain:1})),D.push(i(y,{channelCount:w.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:w.channelCount}));const j=[];if(x.parameterDescriptors!==void 0)for(const{defaultValue:at,maxValue:lt,minValue:Gt,name:Vt}of x.parameterDescriptors){const Dt=o(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:w.parameterData[Vt]!==void 0?w.parameterData[Vt]:at===void 0?0:at});Object.defineProperties(Dt.offset,{defaultValue:{get:()=>at===void 0?0:at},maxValue:{get:()=>lt===void 0?zi:lt},minValue:{get:()=>Gt===void 0?ho:Gt}}),j.push(Dt)}const Z=r(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,E+k)}),F=rE(C,y.sampleRate),V=s(y,F,E+k,Math.max(1,R)),X=i(y,{channelCount:Math.max(1,R),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,R)}),te=[];for(let at=0;at<w.numberOfOutputs;at+=1)te.push(r(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:S[at]}));for(let at=0;at<w.numberOfInputs;at+=1){_[at].connect(D[at]);for(let lt=0;lt<w.channelCount;lt+=1)D[at].connect(Z,lt,at*w.channelCount+lt)}const pe=new eE(x.parameterDescriptors===void 0?[]:x.parameterDescriptors.map(({name:at},lt)=>{const Gt=j[lt];return Gt.connect(Z,0,E+lt),Gt.start(0),[at,Gt.offset]}));Z.connect(V);let ve=w.channelInterpretation,Ie=null;const Re=w.numberOfOutputs===0?[V]:te,xe={get bufferSize(){return F},get channelCount(){return w.channelCount},set channelCount(at){throw t()},get channelCountMode(){return w.channelCountMode},set channelCountMode(at){throw t()},get channelInterpretation(){return ve},set channelInterpretation(at){for(const lt of _)lt.channelInterpretation=at;ve=at},get context(){return V.context},get inputs(){return _},get numberOfInputs(){return w.numberOfInputs},get numberOfOutputs(){return w.numberOfOutputs},get onprocessorerror(){return Ie},set onprocessorerror(at){typeof Ie=="function"&&xe.removeEventListener("processorerror",Ie),Ie=typeof at=="function"?at:null,typeof Ie=="function"&&xe.addEventListener("processorerror",Ie)},get parameters(){return pe},get port(){return A.port2},addEventListener(...at){return V.addEventListener(at[0],at[1],at[2])},connect:n.bind(null,Re),disconnect:d.bind(null,Re),dispatchEvent(...at){return V.dispatchEvent(at[0])},removeEventListener(...at){return V.removeEventListener(at[0],at[1],at[2])}},Ae=new Map;A.port1.addEventListener=(at=>(...lt)=>{if(lt[0]==="message"){const Gt=typeof lt[1]=="function"?lt[1]:typeof lt[1]=="object"&&lt[1]!==null&&typeof lt[1].handleEvent=="function"?lt[1].handleEvent:null;if(Gt!==null){const Vt=Ae.get(lt[1]);Vt!==void 0?lt[1]=Vt:(lt[1]=Dt=>{h(y.currentTime,y.sampleRate,()=>Gt(Dt))},Ae.set(Gt,lt[1]))}}return at.call(A.port1,lt[0],lt[1],lt[2])})(A.port1.addEventListener),A.port1.removeEventListener=(at=>(...lt)=>{if(lt[0]==="message"){const Gt=Ae.get(lt[1]);Gt!==void 0&&(Ae.delete(lt[1]),lt[1]=Gt)}return at.call(A.port1,lt[0],lt[1],lt[2])})(A.port1.removeEventListener);let ke=null;Object.defineProperty(A.port1,"onmessage",{get:()=>ke,set:at=>{typeof ke=="function"&&A.port1.removeEventListener("message",ke),ke=typeof at=="function"?at:null,typeof ke=="function"&&(A.port1.addEventListener("message",ke),A.port1.start())}}),x.prototype.port=A.port1;let H=null;J5(y,xe,x,w).then(at=>H=at);const ae=yp(w.numberOfInputs,w.channelCount),ye=yp(w.numberOfOutputs,S),Ee=x.parameterDescriptors===void 0?[]:x.parameterDescriptors.reduce((at,{name:lt})=>({...at,[lt]:new Float32Array(128)}),{});let _e=!0;const Je=()=>{w.numberOfOutputs>0&&V.disconnect(X);for(let at=0,lt=0;at<w.numberOfOutputs;at+=1){const Gt=te[at];for(let Vt=0;Vt<S[at];Vt+=1)X.disconnect(Gt,lt+Vt,Vt);lt+=S[at]}},me=new Map;V.onaudioprocess=({inputBuffer:at,outputBuffer:lt})=>{if(H!==null){const Gt=p(xe);for(let Vt=0;Vt<F;Vt+=128){for(let Dt=0;Dt<w.numberOfInputs;Dt+=1)for(let Ht=0;Ht<w.channelCount;Ht+=1)vp(at,ae[Dt],Ht,Ht,Vt);x.parameterDescriptors!==void 0&&x.parameterDescriptors.forEach(({name:Dt},Ht)=>{vp(at,Ee,Dt,E+Ht,Vt)});for(let Dt=0;Dt<w.numberOfInputs;Dt+=1)for(let Ht=0;Ht<S[Dt];Ht+=1)ye[Dt][Ht].byteLength===0&&(ye[Dt][Ht]=new Float32Array(128));try{const Dt=ae.map((sn,ct)=>{if(Gt[ct].size>0)return me.set(ct,F/128),sn;const rn=me.get(ct);return rn===void 0?[]:(sn.every(mn=>mn.every(Vn=>Vn===0))&&(rn===1?me.delete(ct):me.set(ct,rn-1)),sn)});_e=h(y.currentTime+Vt/y.sampleRate,y.sampleRate,()=>H.process(Dt,ye,Ee));for(let sn=0,ct=0;sn<w.numberOfOutputs;sn+=1){for(let ce=0;ce<S[sn];ce+=1)tE(lt,ye[sn],ce,ct+ce,Vt);ct+=S[sn]}}catch(Dt){_e=!1,xe.dispatchEvent(new ErrorEvent("processorerror",{colno:Dt.colno,filename:Dt.filename,lineno:Dt.lineno,message:Dt.message}))}if(!_e){for(let Dt=0;Dt<w.numberOfInputs;Dt+=1){_[Dt].disconnect(D[Dt]);for(let Ht=0;Ht<w.channelCount;Ht+=1)D[Vt].disconnect(Z,Ht,Dt*w.channelCount+Ht)}if(x.parameterDescriptors!==void 0){const Dt=x.parameterDescriptors.length;for(let Ht=0;Ht<Dt;Ht+=1){const sn=j[Ht];sn.disconnect(Z,0,E+Ht),sn.stop()}}Z.disconnect(V),V.onaudioprocess=null,it?Je():Et();break}}}};let it=!1;const Tt=c(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Xt=()=>V.connect(Tt).connect(y.destination),Et=()=>{V.disconnect(Tt),Tt.disconnect()},St=()=>{if(_e){Et(),w.numberOfOutputs>0&&V.connect(X);for(let at=0,lt=0;at<w.numberOfOutputs;at+=1){const Gt=te[at];for(let Vt=0;Vt<S[at];Vt+=1)X.connect(Gt,lt+Vt,Vt);lt+=S[at]}}it=!0},Pt=()=>{_e&&(Xt(),Je()),it=!1};return Xt(),g(xe,St,Pt)},iE=(n,e)=>{const t=n.createBiquadFilter();return Jr(t,e),Rr(t,e,"Q"),Rr(t,e,"detune"),Rr(t,e,"frequency"),Rr(t,e,"gain"),mr(t,e,"type"),t},tN=(n,e)=>(t,r)=>{const i=t.createChannelMerger(r.numberOfInputs);return n!==null&&n.name==="webkitAudioContext"&&e(t,i),Jr(i,r),i},nN=n=>{const e=n.numberOfOutputs;Object.defineProperty(n,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw xi()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw xi()}}),Object.defineProperty(n,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw xi()}})},Nf=(n,e)=>{const t=n.createChannelSplitter(e.numberOfOutputs);return Jr(t,e),nN(t),t},rN=(n,e,t,r,i)=>(o,c)=>{if(o.createConstantSource===void 0)return t(o,c);const s=o.createConstantSource();return Jr(s,c),Rr(s,c,"offset"),e(r,()=>r(o))||SC(s),e(i,()=>i(o))||AC(s),n(o,s),s},Wu=(n,e)=>(n.connect=e.connect.bind(e),n.disconnect=e.disconnect.bind(e),n),iN=(n,e,t,r)=>(i,{offset:o,...c})=>{const s=i.createBuffer(1,2,44100),l=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),d=t(i,{...c,gain:o}),h=s.getChannelData(0);h[0]=1,h[1]=1,l.buffer=s,l.loop=!0;const p={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(C){d.channelCount=C},get channelCountMode(){return d.channelCountMode},set channelCountMode(C){d.channelCountMode=C},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(C){d.channelInterpretation=C},get context(){return d.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get offset(){return d.gain},get onended(){return l.onended},set onended(C){l.onended=C},addEventListener(...C){return l.addEventListener(C[0],C[1],C[2])},dispatchEvent(...C){return l.dispatchEvent(C[0])},removeEventListener(...C){return l.removeEventListener(C[0],C[1],C[2])},start(C=0){l.start.call(l,C)},stop(C=0){l.stop.call(l,C)}},g=()=>l.connect(d),y=()=>l.disconnect(d);return n(i,l),r(Wu(p,d),g,y)},oN=(n,e)=>(t,r)=>{const i=t.createConvolver();if(Jr(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),mr(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",o=>()=>o.call(i),o=>c=>{if(c>2)throw n();return o.call(i,c)}),r.channelCountMode==="max"))throw n();return e(i,"channelCountMode",o=>()=>o.call(i),o=>c=>{if(c==="max")throw n();return o.call(i,c)}),i},oE=(n,e)=>{const t=n.createDelay(e.maxDelayTime);return Jr(t,e),Rr(t,e,"delayTime"),t},sN=n=>(e,t)=>{const r=e.createDynamicsCompressor();if(Jr(r,t),t.channelCount>2||t.channelCountMode==="max")throw n();return Rr(r,t,"attack"),Rr(r,t,"knee"),Rr(r,t,"ratio"),Rr(r,t,"release"),Rr(r,t,"threshold"),r},vo=(n,e)=>{const t=n.createGain();return Jr(t,e),Rr(t,e,"gain"),t},aN=n=>(e,t,r)=>{if(e.createIIRFilter===void 0)return n(e,t,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return Jr(i,r),i};function cN(n,e){const t=e[0]*e[0]+e[1]*e[1];return[(n[0]*e[0]+n[1]*e[1])/t,(n[1]*e[0]-n[0]*e[1])/t]}function lN(n,e){return[n[0]*e[0]-n[1]*e[1],n[0]*e[1]+n[1]*e[0]]}function GI(n,e){let t=[0,0];for(let r=n.length-1;r>=0;r-=1)t=lN(t,e),t[0]+=n[r];return t}const uN=(n,e,t,r)=>(i,o,{channelCount:c,channelCountMode:s,channelInterpretation:l,feedback:d,feedforward:h})=>{const p=rE(o,i.sampleRate),g=d instanceof Float64Array?d:new Float64Array(d),y=h instanceof Float64Array?h:new Float64Array(h),C=g.length,x=y.length,w=Math.min(C,x);if(C===0||C>20)throw r();if(g[0]===0)throw e();if(x===0||x>20)throw r();if(y[0]===0)throw e();if(g[0]!==1){for(let j=0;j<x;j+=1)y[j]/=g[0];for(let j=1;j<C;j+=1)g[j]/=g[0]}const S=t(i,p,c,c);S.channelCount=c,S.channelCountMode=s,S.channelInterpretation=l;const E=32,R=[],k=[],A=[];for(let j=0;j<c;j+=1){R.push(0);const Z=new Float32Array(E),F=new Float32Array(E);Z.fill(0),F.fill(0),k.push(Z),A.push(F)}S.onaudioprocess=j=>{const Z=j.inputBuffer,F=j.outputBuffer,V=Z.numberOfChannels;for(let X=0;X<V;X+=1){const te=Z.getChannelData(X),pe=F.getChannelData(X);R[X]=nE(g,C,y,x,w,k[X],A[X],R[X],E,te,pe)}};const _=i.sampleRate/2;return Wu({get bufferSize(){return p},get channelCount(){return S.channelCount},set channelCount(j){S.channelCount=j},get channelCountMode(){return S.channelCountMode},set channelCountMode(j){S.channelCountMode=j},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(j){S.channelInterpretation=j},get context(){return S.context},get inputs(){return[S]},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},addEventListener(...j){return S.addEventListener(j[0],j[1],j[2])},dispatchEvent(...j){return S.dispatchEvent(j[0])},getFrequencyResponse(j,Z,F){if(j.length!==Z.length||Z.length!==F.length)throw n();const V=j.length;for(let X=0;X<V;X+=1){const te=-Math.PI*(j[X]/_),pe=[Math.cos(te),Math.sin(te)],ve=GI(y,pe),Ie=GI(g,pe),Re=cN(ve,Ie);Z[X]=Math.sqrt(Re[0]*Re[0]+Re[1]*Re[1]),F[X]=Math.atan2(Re[1],Re[0])}},removeEventListener(...j){return S.removeEventListener(j[0],j[1],j[2])}},S)},dN=(n,e)=>n.createMediaElementSource(e.mediaElement),fN=(n,e)=>{const t=n.createMediaStreamDestination();return Jr(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},hN=(n,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((o,c)=>o.id<c.id?-1:o.id>c.id?1:0);const r=t.slice(0,1),i=n.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},pN=(n,e)=>(t,{mediaStreamTrack:r})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(r);const i=new MediaStream([r]),o=t.createMediaStreamSource(i);if(r.kind!=="audio")throw n();if(e(t))throw new TypeError;return o},gN=n=>n===null?null:n.hasOwnProperty("OfflineAudioContext")?n.OfflineAudioContext:n.hasOwnProperty("webkitOfflineAudioContext")?n.webkitOfflineAudioContext:null,mN=(n,e,t,r,i,o)=>(c,s)=>{const l=c.createOscillator();return Jr(l,s),Rr(l,s,"detune"),Rr(l,s,"frequency"),s.periodicWave!==void 0?l.setPeriodicWave(s.periodicWave):mr(l,s,"type"),e(t,()=>t(c))||SC(l),e(r,()=>r(c))||o(l,c),e(i,()=>i(c))||AC(l),n(c,l),l},vN=n=>(e,t)=>{const r=e.createPanner();return r.orientationX===void 0?n(e,t):(Jr(r,t),Rr(r,t,"orientationX"),Rr(r,t,"orientationY"),Rr(r,t,"orientationZ"),Rr(r,t,"positionX"),Rr(r,t,"positionY"),Rr(r,t,"positionZ"),mr(r,t,"coneInnerAngle"),mr(r,t,"coneOuterAngle"),mr(r,t,"coneOuterGain"),mr(r,t,"distanceModel"),mr(r,t,"maxDistance"),mr(r,t,"panningModel"),mr(r,t,"refDistance"),mr(r,t,"rolloffFactor"),r)},yN=(n,e,t,r,i,o,c,s,l,d)=>(h,{coneInnerAngle:p,coneOuterAngle:g,coneOuterGain:y,distanceModel:C,maxDistance:x,orientationX:w,orientationY:S,orientationZ:E,panningModel:R,positionX:k,positionY:A,positionZ:_,refDistance:D,rolloffFactor:j,...Z})=>{const F=h.createPanner();if(Z.channelCount>2||Z.channelCountMode==="max")throw c();Jr(F,Z);const V={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},X=t(h,{...V,channelInterpretation:"speakers",numberOfInputs:6}),te=r(h,{...Z,gain:1}),pe=r(h,{...V,gain:1}),ve=r(h,{...V,gain:0}),Ie=r(h,{...V,gain:0}),Re=r(h,{...V,gain:0}),xe=r(h,{...V,gain:0}),Ae=r(h,{...V,gain:0}),ke=i(h,256,6,1),H=o(h,{...V,curve:new Float32Array([1,1]),oversample:"none"});let ee=[w,S,E],ae=[k,A,_];const ye=new Float32Array(1);ke.onaudioprocess=({inputBuffer:me})=>{const it=[l(me,ye,0),l(me,ye,1),l(me,ye,2)];it.some((Xt,Et)=>Xt!==ee[Et])&&(F.setOrientation(...it),ee=it);const Tt=[l(me,ye,3),l(me,ye,4),l(me,ye,5)];Tt.some((Xt,Et)=>Xt!==ae[Et])&&(F.setPosition(...Tt),ae=Tt)},Object.defineProperty(ve.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Ie.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Re.gain,"defaultValue",{get:()=>0}),Object.defineProperty(xe.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Ae.gain,"defaultValue",{get:()=>0});const Ee={get bufferSize(){},get channelCount(){return F.channelCount},set channelCount(me){if(me>2)throw c();te.channelCount=me,F.channelCount=me},get channelCountMode(){return F.channelCountMode},set channelCountMode(me){if(me==="max")throw c();te.channelCountMode=me,F.channelCountMode=me},get channelInterpretation(){return F.channelInterpretation},set channelInterpretation(me){te.channelInterpretation=me,F.channelInterpretation=me},get coneInnerAngle(){return F.coneInnerAngle},set coneInnerAngle(me){F.coneInnerAngle=me},get coneOuterAngle(){return F.coneOuterAngle},set coneOuterAngle(me){F.coneOuterAngle=me},get coneOuterGain(){return F.coneOuterGain},set coneOuterGain(me){if(me<0||me>1)throw e();F.coneOuterGain=me},get context(){return F.context},get distanceModel(){return F.distanceModel},set distanceModel(me){F.distanceModel=me},get inputs(){return[te]},get maxDistance(){return F.maxDistance},set maxDistance(me){if(me<0)throw new RangeError;F.maxDistance=me},get numberOfInputs(){return F.numberOfInputs},get numberOfOutputs(){return F.numberOfOutputs},get orientationX(){return pe.gain},get orientationY(){return ve.gain},get orientationZ(){return Ie.gain},get panningModel(){return F.panningModel},set panningModel(me){F.panningModel=me},get positionX(){return Re.gain},get positionY(){return xe.gain},get positionZ(){return Ae.gain},get refDistance(){return F.refDistance},set refDistance(me){if(me<0)throw new RangeError;F.refDistance=me},get rolloffFactor(){return F.rolloffFactor},set rolloffFactor(me){if(me<0)throw new RangeError;F.rolloffFactor=me},addEventListener(...me){return te.addEventListener(me[0],me[1],me[2])},dispatchEvent(...me){return te.dispatchEvent(me[0])},removeEventListener(...me){return te.removeEventListener(me[0],me[1],me[2])}};p!==Ee.coneInnerAngle&&(Ee.coneInnerAngle=p),g!==Ee.coneOuterAngle&&(Ee.coneOuterAngle=g),y!==Ee.coneOuterGain&&(Ee.coneOuterGain=y),C!==Ee.distanceModel&&(Ee.distanceModel=C),x!==Ee.maxDistance&&(Ee.maxDistance=x),w!==Ee.orientationX.value&&(Ee.orientationX.value=w),S!==Ee.orientationY.value&&(Ee.orientationY.value=S),E!==Ee.orientationZ.value&&(Ee.orientationZ.value=E),R!==Ee.panningModel&&(Ee.panningModel=R),k!==Ee.positionX.value&&(Ee.positionX.value=k),A!==Ee.positionY.value&&(Ee.positionY.value=A),_!==Ee.positionZ.value&&(Ee.positionZ.value=_),D!==Ee.refDistance&&(Ee.refDistance=D),j!==Ee.rolloffFactor&&(Ee.rolloffFactor=j),(ee[0]!==1||ee[1]!==0||ee[2]!==0)&&F.setOrientation(...ee),(ae[0]!==0||ae[1]!==0||ae[2]!==0)&&F.setPosition(...ae);const _e=()=>{te.connect(F),n(te,H,0,0),H.connect(pe).connect(X,0,0),H.connect(ve).connect(X,0,1),H.connect(Ie).connect(X,0,2),H.connect(Re).connect(X,0,3),H.connect(xe).connect(X,0,4),H.connect(Ae).connect(X,0,5),X.connect(ke).connect(h.destination)},Je=()=>{te.disconnect(F),s(te,H,0,0),H.disconnect(pe),pe.disconnect(X),H.disconnect(ve),ve.disconnect(X),H.disconnect(Ie),Ie.disconnect(X),H.disconnect(Re),Re.disconnect(X),H.disconnect(xe),xe.disconnect(X),H.disconnect(Ae),Ae.disconnect(X),X.disconnect(ke),ke.disconnect(h.destination)};return d(Wu(Ee,F),_e,Je)},CN=n=>(e,{disableNormalization:t,imag:r,real:i})=>{const o=r instanceof Float32Array?r:new Float32Array(r),c=i instanceof Float32Array?i:new Float32Array(i),s=e.createPeriodicWave(c,o,{disableNormalization:t});if(Array.from(r).length<2)throw n();return s},Of=(n,e,t,r)=>n.createScriptProcessor(e,t,r),xN=(n,e)=>(t,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(t.createStereoPanner===void 0)return n(t,r);const o=t.createStereoPanner();return Jr(o,r),Rr(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:c=>{if(c!==i)throw e()}}),o},bN=(n,e,t,r,i,o)=>{const s=new Float32Array([1,1]),l=Math.PI/2,d={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h={...d,oversample:"none"},p=(C,x,w,S)=>{const E=new Float32Array(16385),R=new Float32Array(16385);for(let Z=0;Z<16385;Z+=1){const F=Z/16384*l;E[Z]=Math.cos(F),R[Z]=Math.sin(F)}const k=t(C,{...d,gain:0}),A=r(C,{...h,curve:E}),_=r(C,{...h,curve:s}),D=t(C,{...d,gain:0}),j=r(C,{...h,curve:R});return{connectGraph(){x.connect(k),x.connect(_.inputs===void 0?_:_.inputs[0]),x.connect(D),_.connect(w),w.connect(A.inputs===void 0?A:A.inputs[0]),w.connect(j.inputs===void 0?j:j.inputs[0]),A.connect(k.gain),j.connect(D.gain),k.connect(S,0,0),D.connect(S,0,1)},disconnectGraph(){x.disconnect(k),x.disconnect(_.inputs===void 0?_:_.inputs[0]),x.disconnect(D),_.disconnect(w),w.disconnect(A.inputs===void 0?A:A.inputs[0]),w.disconnect(j.inputs===void 0?j:j.inputs[0]),A.disconnect(k.gain),j.disconnect(D.gain),k.disconnect(S,0,0),D.disconnect(S,0,1)}}},g=(C,x,w,S)=>{const E=new Float32Array(16385),R=new Float32Array(16385),k=new Float32Array(16385),A=new Float32Array(16385),_=Math.floor(16385/2);for(let Re=0;Re<16385;Re+=1)if(Re>_){const xe=(Re-_)/(16384-_)*l;E[Re]=Math.cos(xe),R[Re]=Math.sin(xe),k[Re]=0,A[Re]=1}else{const xe=Re/(16384-_)*l;E[Re]=1,R[Re]=0,k[Re]=Math.cos(xe),A[Re]=Math.sin(xe)}const D=e(C,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),j=t(C,{...d,gain:0}),Z=r(C,{...h,curve:E}),F=t(C,{...d,gain:0}),V=r(C,{...h,curve:R}),X=r(C,{...h,curve:s}),te=t(C,{...d,gain:0}),pe=r(C,{...h,curve:k}),ve=t(C,{...d,gain:0}),Ie=r(C,{...h,curve:A});return{connectGraph(){x.connect(D),x.connect(X.inputs===void 0?X:X.inputs[0]),D.connect(j,0),D.connect(F,0),D.connect(te,1),D.connect(ve,1),X.connect(w),w.connect(Z.inputs===void 0?Z:Z.inputs[0]),w.connect(V.inputs===void 0?V:V.inputs[0]),w.connect(pe.inputs===void 0?pe:pe.inputs[0]),w.connect(Ie.inputs===void 0?Ie:Ie.inputs[0]),Z.connect(j.gain),V.connect(F.gain),pe.connect(te.gain),Ie.connect(ve.gain),j.connect(S,0,0),te.connect(S,0,0),F.connect(S,0,1),ve.connect(S,0,1)},disconnectGraph(){x.disconnect(D),x.disconnect(X.inputs===void 0?X:X.inputs[0]),D.disconnect(j,0),D.disconnect(F,0),D.disconnect(te,1),D.disconnect(ve,1),X.disconnect(w),w.disconnect(Z.inputs===void 0?Z:Z.inputs[0]),w.disconnect(V.inputs===void 0?V:V.inputs[0]),w.disconnect(pe.inputs===void 0?pe:pe.inputs[0]),w.disconnect(Ie.inputs===void 0?Ie:Ie.inputs[0]),Z.disconnect(j.gain),V.disconnect(F.gain),pe.disconnect(te.gain),Ie.disconnect(ve.gain),j.disconnect(S,0,0),te.disconnect(S,0,0),F.disconnect(S,0,1),ve.disconnect(S,0,1)}}},y=(C,x,w,S,E)=>{if(x===1)return p(C,w,S,E);if(x===2)return g(C,w,S,E);throw i()};return(C,{channelCount:x,channelCountMode:w,pan:S,...E})=>{if(w==="max")throw i();const R=n(C,{...E,channelCount:1,channelCountMode:w,numberOfInputs:2}),k=t(C,{...E,channelCount:x,channelCountMode:w,gain:1}),A=t(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:S});let{connectGraph:_,disconnectGraph:D}=y(C,x,k,A,R);Object.defineProperty(A.gain,"defaultValue",{get:()=>0}),Object.defineProperty(A.gain,"maxValue",{get:()=>1}),Object.defineProperty(A.gain,"minValue",{get:()=>-1});const j={get bufferSize(){},get channelCount(){return k.channelCount},set channelCount(X){k.channelCount!==X&&(Z&&D(),{connectGraph:_,disconnectGraph:D}=y(C,X,k,A,R),Z&&_()),k.channelCount=X},get channelCountMode(){return k.channelCountMode},set channelCountMode(X){if(X==="clamped-max"||X==="max")throw i();k.channelCountMode=X},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(X){k.channelInterpretation=X},get context(){return k.context},get inputs(){return[k]},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get pan(){return A.gain},addEventListener(...X){return k.addEventListener(X[0],X[1],X[2])},dispatchEvent(...X){return k.dispatchEvent(X[0])},removeEventListener(...X){return k.removeEventListener(X[0],X[1],X[2])}};let Z=!1;const F=()=>{_(),Z=!0},V=()=>{D(),Z=!1};return o(Wu(j,R),F,V)}},IN=(n,e,t,r,i,o,c)=>(s,l)=>{const d=s.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&s.createGain().gain.automationRate===void 0)return t(s,l);Jr(d,l);const h=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(h!==null&&h.length<2)throw e();mr(d,{curve:h},"curve"),mr(d,l,"oversample");let p=null,g=!1;return c(d,"curve",x=>()=>x.call(d),x=>w=>(x.call(d,w),g&&(r(w)&&p===null?p=n(s,d):!r(w)&&p!==null&&(p(),p=null)),w)),i(d,()=>{g=!0,r(d.curve)&&(p=n(s,d))},()=>{g=!1,p!==null&&(p(),p=null)})},wN=(n,e,t,r,i)=>(o,{curve:c,oversample:s,...l})=>{const d=o.createWaveShaper(),h=o.createWaveShaper();Jr(d,l),Jr(h,l);const p=t(o,{...l,gain:1}),g=t(o,{...l,gain:-1}),y=t(o,{...l,gain:1}),C=t(o,{...l,gain:-1});let x=null,w=!1,S=null;const E={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(A){p.channelCount=A,g.channelCount=A,d.channelCount=A,y.channelCount=A,h.channelCount=A,C.channelCount=A},get channelCountMode(){return d.channelCountMode},set channelCountMode(A){p.channelCountMode=A,g.channelCountMode=A,d.channelCountMode=A,y.channelCountMode=A,h.channelCountMode=A,C.channelCountMode=A},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(A){p.channelInterpretation=A,g.channelInterpretation=A,d.channelInterpretation=A,y.channelInterpretation=A,h.channelInterpretation=A,C.channelInterpretation=A},get context(){return d.context},get curve(){return S},set curve(A){if(A!==null&&A.length<2)throw e();if(A===null)d.curve=A,h.curve=A;else{const _=A.length,D=new Float32Array(_+2-_%2),j=new Float32Array(_+2-_%2);D[0]=A[0],j[0]=-A[_-1];const Z=Math.ceil((_+1)/2),F=(_+1)/2-1;for(let V=1;V<Z;V+=1){const X=V/Z*F,te=Math.floor(X),pe=Math.ceil(X);D[V]=te===pe?A[te]:(1-(X-te))*A[te]+(1-(pe-X))*A[pe],j[V]=te===pe?-A[_-1-te]:-((1-(X-te))*A[_-1-te])-(1-(pe-X))*A[_-1-pe]}D[Z]=_%2===1?A[Z-1]:(A[Z-2]+A[Z-1])/2,d.curve=D,h.curve=j}S=A,w&&(r(S)&&x===null?x=n(o,p):x!==null&&(x(),x=null))},get inputs(){return[p]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get oversample(){return d.oversample},set oversample(A){d.oversample=A,h.oversample=A},addEventListener(...A){return p.addEventListener(A[0],A[1],A[2])},dispatchEvent(...A){return p.dispatchEvent(A[0])},removeEventListener(...A){return p.removeEventListener(A[0],A[1],A[2])}};c!==null&&(E.curve=c instanceof Float32Array?c:new Float32Array(c)),s!==E.oversample&&(E.oversample=s);const R=()=>{p.connect(d).connect(y),p.connect(g).connect(h).connect(C).connect(y),w=!0,r(S)&&(x=n(o,p))},k=()=>{p.disconnect(d),d.disconnect(y),p.disconnect(g),g.disconnect(h),h.disconnect(C),C.disconnect(y),w=!1,x!==null&&(x(),x=null)};return i(Wu(E,y),R,k)},yo=()=>new DOMException("","NotSupportedError"),SN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},AN=(n,e,t,r,i,o,c)=>class extends n{constructor(l,d){const h=i(l),p={...SN,...d},g=t(h,p),y=o(h),C=y?r():null,x=l.sampleRate/2;super(l,!1,g,C),this._detune=e(this,y,g.detune,153600,-153600),this._frequency=e(this,y,g.frequency,x,-x),this._nativeOscillatorNode=g,this._onended=null,this._oscillatorNodeRenderer=C,this._oscillatorNodeRenderer!==null&&p.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=p.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const d=typeof l=="function"?c(this,l):null;this._nativeOscillatorNode.onended=d;const h=this._nativeOscillatorNode.onended;this._onended=h!==null&&h===d?l:h}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Fu(this);const d=()=>{this._nativeOscillatorNode.removeEventListener("ended",d),La(this)&&Df(this)};this._nativeOscillatorNode.addEventListener("ended",d)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},kN=(n,e,t,r,i)=>()=>{const o=new WeakMap;let c=null,s=null,l=null;const d=async(h,p)=>{let g=t(h);const y=Oi(g,p);if(!y){const C={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,detune:g.detune.value,frequency:g.frequency.value,periodicWave:c===null?void 0:c,type:g.type};g=e(p,C),s!==null&&g.start(s),l!==null&&g.stop(l)}return o.set(p,g),y?(await n(p,h.detune,g.detune),await n(p,h.frequency,g.frequency)):(await r(p,h.detune,g.detune),await r(p,h.frequency,g.frequency)),await i(h,p,g),g};return{set periodicWave(h){c=h},set start(h){s=h},set stop(h){l=h},render(h,p){const g=o.get(p);return g!==void 0?Promise.resolve(g):d(h,p)}}},EN={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},TN=(n,e,t,r,i,o,c)=>class extends n{constructor(l,d){const h=i(l),p={...EN,...d},g=t(h,p),y=o(h),C=y?r():null;super(l,!1,g,C),this._nativePannerNode=g,this._orientationX=e(this,y,g.orientationX,zi,ho),this._orientationY=e(this,y,g.orientationY,zi,ho),this._orientationZ=e(this,y,g.orientationZ,zi,ho),this._positionX=e(this,y,g.positionX,zi,ho),this._positionY=e(this,y,g.positionY,zi,ho),this._positionZ=e(this,y,g.positionZ,zi,ho),c(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},_N=(n,e,t,r,i,o,c,s,l,d)=>()=>{const h=new WeakMap;let p=null;const g=async(y,C)=>{let x=null,w=o(y);const S={channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation},E={...S,coneInnerAngle:w.coneInnerAngle,coneOuterAngle:w.coneOuterAngle,coneOuterGain:w.coneOuterGain,distanceModel:w.distanceModel,maxDistance:w.maxDistance,panningModel:w.panningModel,refDistance:w.refDistance,rolloffFactor:w.rolloffFactor},R=Oi(w,C);if("bufferSize"in w)x=r(C,{...S,gain:1});else if(!R){const k={...E,orientationX:w.orientationX.value,orientationY:w.orientationY.value,orientationZ:w.orientationZ.value,positionX:w.positionX.value,positionY:w.positionY.value,positionZ:w.positionZ.value};w=i(C,k)}if(h.set(C,x===null?w:x),x!==null){if(p===null){if(c===null)throw new Error("Missing the native OfflineAudioContext constructor.");const V=new c(6,y.context.length,C.sampleRate),X=e(V,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});X.connect(V.destination),p=(async()=>{const te=await Promise.all([y.orientationX,y.orientationY,y.orientationZ,y.positionX,y.positionY,y.positionZ].map(async(pe,ve)=>{const Ie=t(V,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ve===0?1:0});return await s(V,pe,Ie.offset),Ie}));for(let pe=0;pe<6;pe+=1)te[pe].connect(X,0,pe),te[pe].start(0);return d(V)})()}const k=await p,A=r(C,{...S,gain:1});await l(y,C,A);const _=[];for(let V=0;V<k.numberOfChannels;V+=1)_.push(k.getChannelData(V));let D=[_[0][0],_[1][0],_[2][0]],j=[_[3][0],_[4][0],_[5][0]],Z=r(C,{...S,gain:1}),F=i(C,{...E,orientationX:D[0],orientationY:D[1],orientationZ:D[2],positionX:j[0],positionY:j[1],positionZ:j[2]});A.connect(Z).connect(F.inputs[0]),F.connect(x);for(let V=128;V<k.length;V+=128){const X=[_[0][V],_[1][V],_[2][V]],te=[_[3][V],_[4][V],_[5][V]];if(X.some((pe,ve)=>pe!==D[ve])||te.some((pe,ve)=>pe!==j[ve])){D=X,j=te;const pe=V/C.sampleRate;Z.gain.setValueAtTime(0,pe),Z=r(C,{...S,gain:0}),F=i(C,{...E,orientationX:D[0],orientationY:D[1],orientationZ:D[2],positionX:j[0],positionY:j[1],positionZ:j[2]}),Z.gain.setValueAtTime(1,pe),A.connect(Z).connect(F.inputs[0]),F.connect(x)}}return x}return R?(await n(C,y.orientationX,w.orientationX),await n(C,y.orientationY,w.orientationY),await n(C,y.orientationZ,w.orientationZ),await n(C,y.positionX,w.positionX),await n(C,y.positionY,w.positionY),await n(C,y.positionZ,w.positionZ)):(await s(C,y.orientationX,w.orientationX),await s(C,y.orientationY,w.orientationY),await s(C,y.orientationZ,w.orientationZ),await s(C,y.positionX,w.positionX),await s(C,y.positionY,w.positionY),await s(C,y.positionZ,w.positionZ)),Gu(w)?await l(y,C,w.inputs[0]):await l(y,C,w),w};return{render(y,C){const x=h.get(C);return x!==void 0?Promise.resolve(x):g(y,C)}}},RN={disableNormalization:!1},DN=(n,e,t,r)=>class sE{constructor(o,c){const s=e(o),l=r({...RN,...c}),d=n(s,l);return t.add(d),d}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===sE.prototype||t.has(o)}},PN=(n,e)=>(t,r,i)=>(n(r).replay(i),e(r,t,i)),MN=(n,e,t)=>async(r,i,o)=>{const c=n(r);await Promise.all(c.activeInputs.map((s,l)=>Array.from(s).map(async([d,h])=>{const g=await e(d).render(d,i),y=r.context.destination;!t(d)&&(r!==y||!t(r))&&g.connect(o,h,l)})).reduce((s,l)=>[...s,...l],[]))},NN=(n,e,t)=>async(r,i,o)=>{const c=e(r);await Promise.all(Array.from(c.activeInputs).map(async([s,l])=>{const h=await n(s).render(s,i);t(s)||h.connect(o,l)}))},ON=(n,e,t,r)=>i=>n(sy,()=>sy(i))?Promise.resolve(n(r,r)).then(o=>{if(!o){const c=t(i,512,0,1);i.oncomplete=()=>{c.onaudioprocess=null,c.disconnect()},c.onaudioprocess=()=>i.currentTime,c.connect(i.destination)}return i.startRendering()}):new Promise(o=>{const c=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=s=>{c.disconnect(),o(s.renderedBuffer)},c.connect(i.destination),i.startRendering()}),FN=n=>(e,t)=>{n.set(e,t)},BN=n=>(e,t)=>n.set(e,t),LN={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},UN=(n,e,t,r,i,o)=>class extends n{constructor(s,l){const d=i(s),h={...LN,...l},p=t(d,h),g=o(d),y=g?r():null;super(s,!1,p,y),this._pan=e(this,g,p.pan)}get pan(){return this._pan}},jN=(n,e,t,r,i)=>()=>{const o=new WeakMap,c=async(s,l)=>{let d=t(s);const h=Oi(d,l);if(!h){const p={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,pan:d.pan.value};d=e(l,p)}return o.set(l,d),h?await n(l,s.pan,d.pan):await r(l,s.pan,d.pan),Gu(d)?await i(s,l,d.inputs[0]):await i(s,l,d),d};return{render(s,l){const d=o.get(l);return d!==void 0?Promise.resolve(d):c(s,l)}}},VN=n=>()=>{if(n===null)return!1;try{new n({length:1,sampleRate:44100})}catch{return!1}return!0},GN=(n,e)=>async()=>{if(n===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(t);let o=!1,c=!1;try{await r.audioWorklet.addModule(i);const s=new n(r,"a",{numberOfOutputs:0}),l=r.createOscillator();s.port.onmessage=()=>o=!0,s.onprocessorerror=()=>c=!0,l.connect(s),l.start(0),await r.startRendering(),await new Promise(d=>setTimeout(d))}catch{}finally{URL.revokeObjectURL(i)}return o&&!c},WN=(n,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{t.oncomplete=()=>{r.disconnect(),i(t.currentTime!==0)},t.startRendering()})},zN=()=>new DOMException("","UnknownError"),HN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ZN=(n,e,t,r,i,o,c)=>class extends n{constructor(l,d){const h=i(l),p={...HN,...d},g=t(h,p),C=o(h)?r():null;super(l,!0,g,C),this._isCurveNullified=!1,this._nativeWaveShaperNode=g,c(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},XN=(n,e,t)=>()=>{const r=new WeakMap,i=async(o,c)=>{let s=e(o);if(!Oi(s,c)){const d={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,curve:s.curve,oversample:s.oversample};s=n(c,d)}return r.set(c,s),Gu(s)?await t(o,c,s.inputs[0]):await t(o,c,s),s};return{render(o,c){const s=r.get(c);return s!==void 0?Promise.resolve(s):i(o,c)}}},$N=()=>typeof window>"u"?null:window,KN=(n,e)=>t=>{t.copyFromChannel=(r,i,o=0)=>{const c=n(o),s=n(i);if(s>=t.numberOfChannels)throw e();const l=t.length,d=t.getChannelData(s),h=r.length;for(let p=c<0?-c:0;p+c<l&&p<h;p+=1)r[p]=d[p+c]},t.copyToChannel=(r,i,o=0)=>{const c=n(o),s=n(i);if(s>=t.numberOfChannels)throw e();const l=t.length,d=t.getChannelData(s),h=r.length;for(let p=c<0?-c:0;p+c<l&&p<h;p+=1)d[p+c]=r[p]}},qN=n=>e=>{e.copyFromChannel=(t=>(r,i,o=0)=>{const c=n(o),s=n(i);if(c<e.length)return t.call(e,r,s,c)})(e.copyFromChannel),e.copyToChannel=(t=>(r,i,o=0)=>{const c=n(o),s=n(i);if(c<e.length)return t.call(e,r,s,c)})(e.copyToChannel)},YN=n=>(e,t)=>{const r=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),n(e,"buffer",i=>()=>{const o=i.call(e);return o===r?null:o},i=>o=>i.call(e,o===null?r:o))},QN=(n,e)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw n()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw n()}});const i=t.createBufferSource();e(r,()=>{const s=r.numberOfInputs;for(let l=0;l<s;l+=1)i.connect(r,0,l)},()=>i.disconnect(r))},aE=(n,e,t)=>n.copyFromChannel===void 0?n.getChannelData(t)[0]:(n.copyFromChannel(e,t),e[0]),cE=n=>{if(n===null)return!1;const e=n.length;return e%2!==0?n[Math.floor(e/2)]!==0:n[e/2-1]+n[e/2]!==0},Ff=(n,e,t,r)=>{let i=n;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:c}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(n,e,{get:t(o),set:r(c)})},JN=n=>({...n,outputChannelCount:n.outputChannelCount!==void 0?n.outputChannelCount:n.numberOfInputs===1&&n.numberOfOutputs===1?[n.channelCount]:Array.from({length:n.numberOfOutputs},()=>1)}),eO=n=>({...n,channelCount:n.numberOfOutputs}),tO=n=>{const{imag:e,real:t}=n;return e===void 0?t===void 0?{...n,imag:[0,0],real:[0,0]}:{...n,imag:Array.from(t,()=>0),real:t}:t===void 0?{...n,imag:e,real:Array.from(e,()=>0)}:{...n,imag:e,real:t}},lE=(n,e,t)=>{try{n.setValueAtTime(e,t)}catch(r){if(r.code!==9)throw r;lE(n,e,t+1e-7)}},nO=n=>{const e=n.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},rO=n=>{const e=n.createBufferSource(),t=n.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},iO=n=>{const e=n.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},kC=n=>{const e=n.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},uE=n=>{const e=n.createBuffer(1,1,44100),t=n.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},EC=n=>{const e=n.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},oO=n=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(n)}finally{e.close(),t.close()}},sO=n=>{n.start=(e=>(t=0,r=0,i)=>{const o=n.buffer,c=o===null?r:Math.min(o.duration,r);o!==null&&c>o.duration-.5/n.context.sampleRate?e.call(n,t,0,0):e.call(n,t,c,i)})(n.start)},dE=(n,e)=>{const t=e.createGain();n.connect(t);const r=(i=>()=>{i.call(n,t),n.removeEventListener("ended",r)})(n.disconnect);n.addEventListener("ended",r),Wu(n,t),n.stop=(i=>{let o=!1;return(c=0)=>{if(o)try{i.call(n,c)}catch{t.gain.setValueAtTime(0,c)}else i.call(n,c),o=!0}})(n.stop)},zu=(n,e)=>t=>{const r={value:n};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof e=="function"?e.call(n,t):e.handleEvent.call(n,t)},aO=NM(Nl),cO=jM(Nl),lO=Q4($p),fE=new WeakMap,uO=m5(fE),Va=_4(new Map,new WeakMap),ta=$N(),hE=G5(Va,ia),pE=g5(Xi),Ii=MN(Xi,pE,Sl),dO=HM(hE,fr,Ii),rr=C5(zk),Fc=gN(ta),qn=P5(Fc),gE=new WeakMap,mE=c5(zu),Bf=Z5(ta),vE=T5(Bf),yE=_5(ta),fO=R5(ta),sf=$5(ta),Br=v4(OM(jk),UM(aO,cO,pp,lO,gp,Xi,uO,Rf,fr,Nl,La,Sl,n0),Va,E5(ey,gp,Xi,fr,of,La),ia,Kp,yo,$4(pp,ey,Xi,fr,of,rr,La,qn),t5(gE,Xi,Ds),mE,rr,vE,yE,fO,qn,sf),hO=zM(Br,dO,ia,hE,rr,qn),CE=new WeakSet,WI=W5(ta),xE=G4(new Uint32Array(1)),bE=KN(xE,ia),IE=qN(xE),pO=XM(CE,Va,yo,WI,Fc,VN(WI),bE,IE),qp=VM(vo),wE=NN(pE,Pf,Sl),oa=F4(wE),Hu=H5(qp,Va,nO,rO,iO,kC,uE,EC,sO,YN(Ff),dE),sa=PN(v5(Pf),wE),gO=qM(oa,Hu,fr,sa,Ii),Bs=y4(FM(Gk),gE,Wk,C4,TM,_M,RM,DM,PM,Yv,Lk,Bf,lE),mO=KM(Br,gO,Bs,xi,Hu,rr,qn,zu),vO=s4(Br,a4,ia,xi,X5(vo,Ff),rr,qn,Ii),yO=T4(oa,iE,fr,sa,Ii),Ol=BN(fE),CO=E4(Br,Bs,yO,Kp,iE,rr,qn,Ol),Bc=j5(Nl,yE),xO=QN(xi,Bc),Lc=tN(Bf,xO),bO=P4(Lc,fr,Ii),IO=D4(Br,bO,Lc,rr,qn),wO=O4(Nf,fr,Ii),SO=N4(Br,wO,Nf,rr,qn,eO),AO=iN(qp,Hu,vo,Bc),Zu=rN(qp,Va,AO,kC,EC),kO=V4(oa,Zu,fr,sa,Ii),EO=j4(Br,Bs,kO,Zu,rr,qn,zu),SE=oN(yo,Ff),TO=H4(SE,fr,Ii),_O=z4(Br,TO,SE,rr,qn,Ol),RO=Y4(oa,oE,fr,sa,Ii),DO=q4(Br,Bs,RO,oE,rr,qn,Ol),AE=sN(yo),PO=o5(oa,AE,fr,sa,Ii),MO=i5(Br,Bs,PO,AE,yo,rr,qn,Ol),NO=h5(oa,vo,fr,sa,Ii),OO=f5(Br,Bs,NO,vo,rr,qn),FO=uN(Kp,xi,Of,yo),TC=ON(Va,vo,Of,WN(vo,Fc)),BO=k5(Hu,fr,Fc,Ii,TC),LO=aN(FO),UO=S5(Br,LO,BO,rr,qn,Ol),jO=c4(Bs,Lc,Zu,Of,yo,aE,qn,Ff),kE=new WeakMap,VO=U5(vO,jO,mE,qn,kE,zu),EE=mN(qp,Va,kC,uE,EC,dE),GO=kN(oa,EE,fr,sa,Ii),WO=AN(Br,Bs,EE,GO,rr,qn,zu),TE=L4(Hu),zO=wN(TE,xi,vo,cE,Bc),Yp=IN(TE,xi,zO,cE,Bc,Bf,Ff),HO=yN(pp,xi,Lc,vo,Of,Yp,yo,gp,aE,Bc),_E=vN(HO),ZO=_N(oa,Lc,Zu,vo,_E,fr,Fc,sa,Ii,TC),XO=TN(Br,Bs,_E,ZO,rr,qn,Ol),$O=CN(ia),KO=DN($O,rr,new WeakSet,tO),qO=bN(Lc,Nf,vo,Yp,yo,Bc),RE=xN(qO,yo),YO=jN(oa,RE,fr,sa,Ii),QO=UN(Br,Bs,RE,YO,rr,qn),JO=XN(Yp,fr,Ii),eF=ZN(Br,xi,Yp,JO,rr,qn,Ol),DE=M5(ta),_C=l5(ta),PE=new WeakMap,tF=x5(PE,Fc),nF=DE?LM(Va,yo,a5(ta),_C,u5(MM),rr,tF,qn,sf,new WeakMap,new WeakMap,GN(sf,Fc),ta):void 0,rF=D5(vE,qn),iF=X4(CE,Va,Z4,s5,new WeakSet,rr,rF,iy,sy,bE,IE),oF=A4(nF,hO,pO,mO,CO,IO,SO,EO,_O,iF,DO,MO,OO,UO,VO,WO,XO,KO,QO,eF),sF=N5(Br,dN,rr,qn),aF=F5(Br,fN,rr,qn),cF=B5(Br,hN,rr,qn),lF=pN(xi,qn),uF=L5(Br,lF,rr),dF=o4(oF,xi,yo,zN,sF,aF,cF,uF,Bf),ME=b5(kE),fF=GM(ME),NE=B4(ia),hF=J4(ME),OE=n5(ia),FE=new WeakMap,pF=p5(FE,Ds),gF=eN(NE,ia,xi,Lc,Nf,Zu,vo,Of,yo,OE,_C,pF,Bc),mF=q5(xi,gF,vo,yo,Bc),vF=S4(oa,NE,Hu,Lc,Nf,Zu,vo,hF,OE,_C,fr,sf,Fc,sa,Ii,TC),yF=y5(PE),CF=FN(FE),zI=DE?b4(fF,Br,Bs,vF,mF,Xi,yF,rr,qn,sf,JN,CF,oO,zu):void 0,xF="data:text/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";let HI=class{constructor(e){oe(this,"maxSize");oe(this,"cache");this.maxSize=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const r=this.cache.keys().next().value;r!==void 0&&this.cache.delete(r)}this.cache.set(e,t)}has(e){return this.cache.has(e)}};const ZI=100,Nr=class Nr{static setCacheExpirationTime(e){this.cacheExpirationTime=e}static async openCache(){try{return await caches.open("audio-cache")}catch(e){throw console.error("Failed to open cache:",e),e}}static async getOrCreatePendingRequest(e,t){let r=this.pendingRequests.get(e);if(!r){const i=(async()=>{try{const o=await t();if(o===void 0)throw new Error("Failed to create audio buffer.");return o}finally{this.pendingRequests.delete(e)}})();return this.pendingRequests.set(e,i),i}return r}static async updateMetadata(e,t,r){const i={url:t,timestamp:Date.now(),...r};await e.put(`${t}:meta`,new Response(JSON.stringify(i),{headers:{"Content-Type":"application/json"}}))}static async getBufferFromCache(e,t){try{const r=await t.match(e);return r&&r.ok?await r.arrayBuffer():null}catch(r){return console.error("Failed to get data from cache:",r),null}}static async fetchAndCacheBuffer(e,t,r,i){const o=new Headers;r&&o.append("If-None-Match",r),i&&o.append("If-Modified-Since",i);const c=await fetch(e,{headers:o});if(c.status===304){const s=await t.match(e);if(s){const l=Date.now();return await this.updateMetadata(t,e,{timestamp:l,etag:r,lastModified:i}),await s.arrayBuffer()}else{console.warn(`Cache inconsistency detected for ${e}: 304 response but no cached body. Re-fetching.`);const l=await fetch(e);if(l.status===200){const d=l.clone(),h=l.headers.get("ETag"),p=l.headers.get("Last-Modified");try{await Promise.all([t.put(e,d),this.updateMetadata(t,e,{timestamp:Date.now(),etag:h||void 0,lastModified:p||void 0})])}catch(g){throw await t.delete(e),await t.delete(`${e}:meta`),g}return await l.arrayBuffer()}else throw new Error(`Failed to fetch resource after cache inconsistency: ${l.status} ${l.statusText}`)}}if(c.status===200){const s=c.clone(),l=c.headers.get("ETag"),d=c.headers.get("Last-Modified");try{await Promise.all([t.put(e,s),this.updateMetadata(t,e,{timestamp:Date.now(),etag:l||void 0,lastModified:d||void 0})])}catch(h){throw await t.delete(e),await t.delete(`${e}:meta`),h}}return await c.arrayBuffer()}static async decodeAudioData(e,t){try{return await e.decodeAudioData(t)}catch(r){throw console.error("Failed to decode audio data:",r),r}}static async getMetadataFromCache(e,t){try{const r=await t.match(e+":meta");return r&&r.ok?await r.json():null}catch(r){return console.error("Failed to get metadata from cache:",r),null}}async getAudioBuffer(e,t){if(Nr.decodedBuffers.has(t))return Nr.decodedBuffers.get(t);if(t.startsWith("data:")){const c=t.split(",")[1],s=Uint8Array.from(atob(c),d=>d.charCodeAt(0)).buffer,l=await Nr.decodeAudioData(e,s);return Nr.decodedBuffers.set(t,l),l}const r=await Nr.openCache(),i=await Nr.getMetadataFromCache(t,r),o=!i||i.etag||i.lastModified||Date.now()-i.timestamp>Nr.cacheExpirationTime;return Nr.getOrCreatePendingRequest(t,async()=>{if(o){const c=await Nr.fetchAndCacheBuffer(t,r,i==null?void 0:i.etag,i==null?void 0:i.lastModified),s=await Nr.decodeAudioData(e,c);return Nr.decodedBuffers.set(t,s),s}else{const c=await Nr.getBufferFromCache(t,r);if(c){const s=await Nr.decodeAudioData(e,c);return Nr.decodedBuffers.set(t,s),s}}})}clearMemoryCache(){Nr.decodedBuffers=new HI(ZI),Nr.pendingRequests.clear()}};oe(Nr,"pendingRequests",new Map),oe(Nr,"decodedBuffers",new HI(ZI)),oe(Nr,"cacheExpirationTime",24*60*60*1e3);let ay=Nr,XI=class{constructor(e=[]){oe(this,"_position",[0,0,0]);oe(this,"loopCount",0);oe(this,"playIndex",0);this.sounds=e}preplayRandom(){if(this.sounds.length===0)return;const e=this.randomSound().preplay();return e.length>0?e[0]:void 0}playRandom(){const e=this.preplayRandom();return e&&e.play(),e}preplayOrdered(e=!0){if(this.sounds.length===0)return;const t=this.sounds[this.playIndex].preplay();if(t.length!==0)return this.playIndex=(this.playIndex+1)%this.sounds.length,!e&&this.playIndex===0&&(this.playIndex=this.sounds.length),t[0]}playOrdered(e=!0){const t=this.preplayOrdered(e);return t&&t.play(),t}get duration(){return this.sounds.map(e=>e.duration).reduce((e,t)=>Math.max(e,t),0)}seek(e){this.sounds.forEach(t=>t.seek&&t.seek(e))}addSound(e){this.sounds.push(e)}randomSound(){if(this.sounds.length===0)throw new Error("Cannot get a random sound from an empty group");const e=Math.floor(Math.random()*this.sounds.length);return this.sounds[e]}preplay(){return this.sounds.map(e=>e.preplay()).flat()}play(){const e=[];return this.preplay().forEach(t=>{t.play(),e.push(t)}),e}get isPlaying(){return this.sounds.some(e=>e.isPlaying)}stop(){this.sounds.forEach(e=>e.stop())}pause(){this.sounds.forEach(e=>e.pause())}loop(e){return e===void 0?this.loopCount:(this.loopCount=e,this.sounds.forEach(t=>t.loop(e)),this.loopCount)}addFilter(e){this.sounds.forEach(t=>t.addFilter(e))}removeFilter(e){this.sounds.forEach(t=>t.removeFilter(e))}set position(e){this._position=e,this.sounds.forEach(t=>t.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(e=>e.volume).reduce((e,t)=>e+t,0)/this.sounds.length}set volume(e){this.sounds.forEach(t=>t.volume=e)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(e){this.sounds.forEach(t=>t.playbackRate=e)}};class Xu{constructor(){oe(this,"_filters",[])}addFilter(e){this._filters.push(e)}removeFilter(e){this._filters=this._filters.filter(t=>t.frequency.value!==e.frequency.value&&t.type!==e.type&&t.Q.value!==e.Q.value&&t.gain.value!==e.gain.value)}applyFilters(e){return this._filters.reduce((t,r)=>(t.connect(r),r),e),this._filters.length>0?this._filters[this._filters.length-1]:e}get filters(){return this._filters}addFilters(e){e.forEach(t=>this.addFilter(t))}removeFilters(e){e.forEach(t=>this.removeFilter(t))}}let bF=class extends Xu{constructor(t,r,i,o=0){super();oe(this,"context");oe(this,"source");oe(this,"gainNode");oe(this,"panner");this.source=t,this.gainNode=r,this.context=i,this.panner=i.createPanner(),t.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}get isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(t){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=t}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(t=>t.enabled=!0)}addFilter(t){super.addFilter(t),this.refreshFilters()}removeFilter(t){super.removeFilter(t),this.refreshFilters()}set position(t){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,o]=t;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=o}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.source;this.source.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(t){}},IF=class extends Xu{constructor(t){super();oe(this,"context");oe(this,"_position",[0,0,0]);oe(this,"loopCount",0);oe(this,"prevVolume",1);oe(this,"microphoneGainNode");oe(this,"streamPlayback");oe(this,"stream");oe(this,"streamSource");this.context=t,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(t=>{this.stream=t,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new bF(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(t=>{console.error("Error initializing microphone stream:",t)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(t){}get isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(t){this.streamPlayback&&this.streamPlayback.addFilter(t)}removeFilter(t){this.streamPlayback&&this.streamPlayback.removeFilter(t)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(t){this.streamPlayback&&(this.streamPlayback.volume=t)}get position(){return[0,0,0]}set position(t){}loop(t){return 0}get playbackRate(){return 1}set playbackRate(t){}};function BE(n){class e extends n{constructor(){super(...arguments);oe(this,"playbacks",[]);oe(this,"_position",[0,0,0]);oe(this,"_stereoPan",0);oe(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});oe(this,"_volume",1)}play(){const i=this.preplay();return i.forEach(o=>o.play()),i}stop(){this.playbacks.forEach(i=>i.stop()),this.playbacks=[]}pause(){this.playbacks.forEach(i=>i.pause())}addFilter(i){super.addFilter(i),this.playbacks.forEach(o=>o.addFilter(i))}removeFilter(i){super.removeFilter(i),this.playbacks.forEach(o=>o.removeFilter(i))}get isPlaying(){return this.playbacks.some(i=>i.isPlaying)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}set position(i){this._threeDOptions.positionX=i[0],this._threeDOptions.positionY=i[1],this._threeDOptions.positionZ=i[2],this.playbacks.forEach(o=>o.position=i)}get threeDOptions(){return this._threeDOptions}set threeDOptions(i){this._threeDOptions={...this._threeDOptions,...i},this.playbacks.forEach(o=>o.threeDOptions=this._threeDOptions)}get stereoPan(){return this._stereoPan}set stereoPan(i){this._stereoPan=i,this.playbacks.forEach(o=>o.stereoPan=i)}get volume(){return this._volume}set volume(i){this._volume=i,this.playbacks.forEach(o=>o.volume=i)}}return e}function LE(n){class e extends n{constructor(){super(...arguments);oe(this,"panner");oe(this,"_panType","stereo")}get panType(){return this._panType}setPanType(i,o){this._panType===i&&this.panner||(this.panner&&this.panner.disconnect(),this._panType=i,i==="stereo"?this.panner=o.createStereoPanner():this.panner=o.createPanner())}setPannerNode(i){this.panner=i}get stereoPan(){return this.panType==="stereo"?this.panner.pan.value:null}set stereoPan(i){if(this.panType!=="stereo")throw new Error("Stereo panning is not available when using HRTF.");if(!this.panner)throw new Error("Cannot set stereo pan of a sound that has been cleaned up");i=$I(i,-1,1),this.panner.pan.setValueAtTime($I(i,-1,1),this.panner.context.currentTime)}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get 3D options of a sound that is not using HRTF");const i=this.panner;return{coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,channelCount:this.panner.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,panningModel:i.panningModel,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,positionX:i.positionX.value,positionY:i.positionY.value,positionZ:i.positionZ.value,orientationX:i.orientationX.value,orientationY:i.orientationY.value,orientationZ:i.orientationZ.value}}set threeDOptions(i){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot set 3D options of a sound that is not using HRTF");const o=this.panner;o.coneInnerAngle=i.coneInnerAngle!==void 0?i.coneInnerAngle:o.coneInnerAngle,o.coneOuterAngle=i.coneOuterAngle!==void 0?i.coneOuterAngle:o.coneOuterAngle,o.coneOuterGain=i.coneOuterGain!==void 0?i.coneOuterGain:o.coneOuterGain,o.distanceModel=i.distanceModel||o.distanceModel,o.maxDistance=i.maxDistance!==void 0?i.maxDistance:o.maxDistance,o.channelCount=i.channelCount!==void 0?i.channelCount:o.channelCount,o.channelCountMode=i.channelCountMode||o.channelCountMode,o.channelInterpretation=i.channelInterpretation||o.channelInterpretation,o.panningModel=i.panningModel||o.panningModel,o.refDistance=i.refDistance!==void 0?i.refDistance:o.refDistance,o.rolloffFactor=i.rolloffFactor!==void 0?i.rolloffFactor:o.rolloffFactor,o.positionX.value=i.positionX!==void 0?i.positionX:o.positionX.value,o.positionY.value=i.positionY!==void 0?i.positionY:o.positionY.value,o.positionZ.value=i.positionZ!==void 0?i.positionZ:o.positionZ.value,o.orientationX.value=i.orientationX!==void 0?i.orientationX:o.orientationX.value,o.orientationY.value=i.orientationY!==void 0?i.orientationY:o.orientationY.value,o.orientationZ.value=i.orientationZ!==void 0?i.orientationZ:o.orientationZ.value}set position(i){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot move a sound that is not using HRTF");const[o,c,s]=i,l=this.panner;l.positionX.value=o,l.positionY.value=c,l.positionZ.value=s}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");if(this.panType!=="HRTF")throw new Error("Cannot get position of a sound that is not using HRTF");const i=this.panner;return[i.positionX.value,i.positionY.value,i.positionZ.value]}}return e}function $I(n,e,t){return Math.min(Math.max(n,e),t)}function UE(n){class e extends n{constructor(){super(...arguments);oe(this,"gainNode")}setGainNode(i){this.gainNode=i}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(i){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=i}}return e}class jE extends LE(UE(Xu)){constructor(){super(...arguments);oe(this,"source");oe(this,"_playing",!1);oe(this,"origin")}get isPlaying(){return this.source?this._playing:!1}}class RC extends jE{constructor(t,r,i){super();oe(this,"context");oe(this,"loopCount",0);oe(this,"currentLoop",0);oe(this,"buffer");oe(this,"_offset",0);oe(this,"_startTime",0);oe(this,"_state",0);oe(this,"_playbackRate",1);oe(this,"loopEnded",()=>{!this.source||this._state!==1||(this.currentLoop++,this.loopCount!=="infinite"&&this.currentLoop>this.loopCount?this.stop():(this.seek(0),"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():this.play()))});this.origin=t,this.context=t.context,this.loopCount=t.loopCount,this.setPanType(t.panType,t.context),this.source=r,"buffer"in r&&r.buffer&&(this.buffer=r.buffer),this.setupSourceNode(r),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}setupSourceNode(t){if("mediaElement"in t&&t.mediaElement)t.mediaElement.onended=this.loopEnded;else if("onended"in t)t.onended=this.loopEnded;else throw new Error("Unsupported source type")}get isPlaying(){return this._state===1}get duration(){if(!this.source)throw new Error("Cannot get duration of a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.duration:this.buffer?this.buffer.duration||NaN:NaN}get playbackRate(){return this._playbackRate}set playbackRate(t){if(t<=0)throw new Error("Playback rate must be greater than 0");if(this._state===1){const r=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=r,this._startTime=this.context.currentTime}this._playbackRate=t,this.source&&("playbackRate"in this.source&&(this.source.playbackRate.value=t),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=t))}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return this._state===1?[this]:(this._state===2?"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():(this.recreateSource(),"start"in this.source&&this.source.start&&this.source.start(0,this._offset)):"mediaElement"in this.source&&this.source.mediaElement?(this.source.mediaElement.currentTime=this._offset,this.source.mediaElement.play()):"start"in this.source&&this.source.start&&(this.recreateSource(),this.source.start(0,this._offset)),this._startTime=this.context.currentTime,this._state=1,[this])}pause(){if(!this.source||this._state!==1)return;const t=(this.context.currentTime-this._startTime)*this._playbackRate;this._offset+=t,"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.pause():"stop"in this.source&&this.source.stop(),this._state=2}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this._state===3||this._state===0||("stop"in this.source&&this._state===1&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this._offset=0,this._startTime=0,this._state=3)}seek(t){if(!this.source||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");if(!isFinite(t)||t<0)throw new Error("Invalid time value for seek");const r=this._state===1;r&&this.pause(),this._offset=t,"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.currentTime=t),r&&this.play()}get currentTime(){if(this._state===1){const t=(this.context.currentTime-this._startTime)*this._playbackRate;return this._offset+t}else return this._offset}recreateSource(){if(!this.buffer||!this.panner||!this.context||!this.gainNode)throw new Error("Cannot recreate source of a sound that has been cleaned up");this.source&&(!("mediaElement"in this.source)&&"onended"in this.source&&(this.source.onended=null),this.source.disconnect()),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.panner),this.source.onended=this.loopEnded,this.playbackRate=this._playbackRate,this.refreshFilters()}set sourceLoop(t){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=t),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=t)}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this._filters.forEach(t=>{t&&t.disconnect()}),this._filters=[]}loop(t){if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(t!==void 0&&(this.loopCount=t==="infinite"?"infinite":Math.max(0,t),this.currentLoop=0),"mediaElement"in this.source&&this.source.mediaElement){const r=this.source.mediaElement;r.loop=this.loopCount==="infinite"}else if("loop"in this.source)this.source.loop=this.loopCount==="infinite",this.source.buffer&&(this.source.loopEnd=this.source.buffer.duration,this.source.loopStart=0);else throw new Error("Unsupported source type");return this.loopCount}addFilter(t){const r=this.context.createBiquadFilter();r.type=t.type,r.frequency.value=t.frequency.value,r.Q.value=t.Q.value,r.gain.value=t.gain.value,this._filters.push(r),this.refreshFilters()}removeFilter(t){const r=this._filters.indexOf(t);r!==-1&&this._filters.splice(r,1)[0].disconnect(),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.panner;t.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}clone(t={}){if(!this.source||!this.gainNode||!this.context)throw new Error("Cannot clone a sound that has been cleaned up");const r=t.panType||this.panType,i=this.context.createGain();let o;if("buffer"in this.source&&this.source.buffer)o=this.context.createBufferSource(),o.buffer=this.source.buffer;else if("mediaElement"in this.source&&this.source.mediaElement)o=this.context.createMediaElementSource(this.source.mediaElement);else throw new Error("Unsupported source type");const c=t.loopCount!==void 0?t.loopCount:this.loopCount,s=new RC(this.origin,o,i);return s.loopCount=c,s.currentLoop=this.currentLoop,s.setPanType(r,this.context),s.volume=this.volume,s.playbackRate=this._playbackRate,s._offset=this._offset,s._state=this._state,this._filters.forEach(l=>{const d=this.context.createBiquadFilter();d.type=l.type,d.frequency.value=l.frequency.value,d.Q.value=l.Q.value,d.gain.value=l.gain.value,s.addFilter(d)}),this._state===1&&s.play(),s}}let jh=class VE extends BE(Xu){constructor(t,r,i,o,c=af.Buffer,s="HRTF"){super();oe(this,"buffer");oe(this,"context");oe(this,"loopCount",0);oe(this,"_playbackRate",1);this.url=t,this.globalGainNode=o,this.soundType=c,this.panType=s,this.buffer=r,this.context=i}clone(t={}){const r=t.panType||this.panType,i=t.stereoPan!==void 0?t.stereoPan:this.stereoPan,o=t.threeDOptions||this.threeDOptions,c=t.loopCount!==void 0?t.loopCount:this.loopCount,s=t.playbackRate||this.playbackRate,l=t.volume!==void 0?t.volume:this.volume,d=t.position!==void 0?t.position:this.position,h=t.filters&&t.filters.length?t.filters:this._filters,p=new VE(this.url,this.buffer,this.context,this.globalGainNode,this.soundType,r);return p.loop(c),p.playbackRate=s,p.volume=l,r==="HRTF"?(p.threeDOptions=o,p.position=d):p.stereoPan=i,p.addFilters(h),p}preplay(){let t;if(this.buffer)t=this.context.createBufferSource(),t.buffer=this.buffer;else{const o=new Audio;o.crossOrigin="anonymous",o.src=this.url,o.preload="auto",t=this.context.createMediaElementSource(o)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new RC(this,t,r);return i.setGainNode(r),i.volume=this.volume,i.playbackRate=this.playbackRate,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}seek(t){this.playbacks.forEach(r=>r.seek(t))}get duration(){var t;return this.playbacks.length>0?this.playbacks[0].duration:((t=this.buffer)==null?void 0:t.duration)||NaN}loop(t){return t===void 0?this.loopCount:(this.loopCount=t,this.playbacks.forEach(r=>r.loop(t)),this.loopCount)}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this.playbacks.forEach(r=>r.playbackRate=t)}};function wF(n){class e extends jE{constructor(){super(...arguments);oe(this,"_oscillatorOptions",{})}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(i){this._oscillatorOptions=i,this.source&&this.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type))}play(){if(!this.source)throw new Error("No source node found");return this.oscillatorOptions.detune&&(this.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(this.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(this.source.type=this.oscillatorOptions.type),this.source.start(),this._playing=!0,[this]}stop(){this.source&&this.source.stop&&(this.source.stop(),this._playing=!1)}pause(){this.stop()}get frequency(){return this.source.frequency.value}set frequency(i){this.source.frequency.value=i,this.oscillatorOptions.frequency=i}get detune(){return this.source.detune.value}set detune(i){this.source.detune.value=i,this.oscillatorOptions.detune=i}get type(){return this.source.type}set type(i){this.source.type=i,this.oscillatorOptions.type=i}}return e}class SF extends wF(LE(UE(Xu))){constructor(t,r,i){super();oe(this,"context");this.origin=t,this.source=r,this.context=t.context,this.setPanType(t.panType,t.context),this.source.connect(this.panner),this.setGainNode(i),this.panner.connect(this.gainNode),this.refreshFilters()}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let t=this.panner;t.disconnect(),t=this.applyFilters(t),t.connect(this.gainNode)}}class DC extends BE(Xu){constructor(t,r,i=af.Oscillator,o="HRTF",c={}){super();oe(this,"_oscillatorOptions");oe(this,"playbacks",[]);this.context=t,this.globalGainNode=r,this.soundType=i,this.panType=o,this.context=t,this._oscillatorOptions=c}clone(t={}){const r=t.panType||this.panType,i=t.stereoPan!==void 0?t.stereoPan:this.stereoPan??0,o=t.threeDOptions||this.threeDOptions,c=t.volume!==void 0?t.volume:this.volume,s=t.position&&t.position.length?t.position:this.position,l=t.filters&&t.filters.length?t.filters:this._filters,d=t.oscillatorOptions||this._oscillatorOptions,h=new DC(this.context,this.globalGainNode,this.soundType,r,d);return h._volume=c,h._position=s,h._stereoPan=i,h._threeDOptions=o,h.addFilters(l),h}preplay(){const t=this.context.createOscillator();this.oscillatorOptions.detune&&(t.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(t.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(t.type=this.oscillatorOptions.type);const r=this.context.createGain();r.connect(this.globalGainNode);const i=new SF(this,t,r);return i.volume=this.volume,this._filters.forEach(o=>i.addFilter(o)),this.panType==="HRTF"?(i.threeDOptions=this.threeDOptions,i.position=this.position):this.panType==="stereo"&&(i.stereoPan=this.stereoPan),this.playbacks.push(i),[i]}get oscillatorOptions(){return this._oscillatorOptions}set oscillatorOptions(t){this._oscillatorOptions=t,this.playbacks.forEach(r=>{r.source instanceof OscillatorNode&&(this.oscillatorOptions.detune&&(r.source.detune.value=this.oscillatorOptions.detune),this.oscillatorOptions.frequency&&(r.source.frequency.value=this.oscillatorOptions.frequency),this.oscillatorOptions.type&&(r.source.type=this.oscillatorOptions.type))})}get frequency(){return this.oscillatorOptions.frequency||440}set frequency(t){this._oscillatorOptions.frequency=t,this.playbacks.forEach(r=>r.frequency=t)}get detune(){return this.oscillatorOptions.detune}set detune(t){this._oscillatorOptions.detune=t,this.playbacks.forEach(r=>r.detune=t)}get type(){return this.oscillatorOptions.type||"sine"}set type(t){this._oscillatorOptions.type=t,this.playbacks.forEach(r=>r.type=t)}}var af=(n=>(n.HTML="HTML",n.Streaming="Streaming",n.Buffer="Buffer",n.Oscillator="oscillator",n))(af||{});let AF=class{constructor(e,t){oe(this,"context");oe(this,"globalGainNode");oe(this,"listener");oe(this,"prevVolume",1);oe(this,"finalizationRegistry");oe(this,"cache");oe(this,"createBiquadFilter",({type:e,frequency:t,gain:r,Q:i})=>{t===void 0&&(t=350);const o=this.context.createBiquadFilter();return o.type=e||"lowpass",o.frequency.value=t,o.gain.value=r||0,o.Q.value=i||1,o});this.context=e||new dF,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.cache=t||new ay,this.finalizationRegistry=new FinalizationRegistry(r=>{r.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",xF):console.warn("AudioWorklet not supported")}async createWorkletNode(e,t){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new zI(this.context,e)}catch(r){console.error(r),console.log("Loading worklet from url",t);try{await this.context.audioWorklet.addModule(t)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${t}`)}return new zI(this.context,e)}}clearMemoryCache(){this.cache.clearMemoryCache()}createOscillator(e,t="HRTF"){return new DC(this.context,this.globalGainNode,"oscillator",t,e)}async createSound(e,t="Buffer",r="HRTF"){if(typeof e=="object")return Promise.resolve(new jh("",e,this.context,this.globalGainNode,"Buffer",r));const i=e;if(t==="HTML"){const o=new Audio;return o.src=i,o.crossOrigin="anonymous",new jh(i,void 0,this.context,this.globalGainNode,"HTML",r)}return this.cache.getAudioBuffer(this.context,i).then(o=>new jh(i,o,this.context,this.globalGainNode,t,r))}async createGroup(e){const t=new XI;return e.forEach(r=>t.addSound(r)),t}async createGroupFromUrls(e,t="Buffer",r="HRTF"){const i=new XI;return(await Promise.all(e.map(o=>this.createSound(o,t,r)))).forEach(o=>i.addSound(o)),i}async createStream(e){return new jh(e,void 0,this.context,this.globalGainNode,"Streaming")}createPanner({coneInnerAngle:e,coneOuterAngle:t,coneOuterGain:r,distanceModel:i,maxDistance:o,channelCount:c,channelCountMode:s,channelInterpretation:l,panningModel:d,refDistance:h,rolloffFactor:p,positionX:g,positionY:y,positionZ:C,orientationX:x,orientationY:w,orientationZ:S}){const E=this.context.createPanner();return E.coneInnerAngle=e||360,E.coneOuterAngle=t||360,E.coneOuterGain=r||0,E.distanceModel=i||"inverse",E.maxDistance=o||1e4,E.channelCount=c||2,E.channelCountMode=s||"clamped-max",E.channelInterpretation=l||"speakers",E.panningModel=d||"HRTF",E.refDistance=h||1,E.rolloffFactor=p||1,E.positionX.value=g||0,E.positionY.value=y||0,E.positionZ.value=C||0,E.orientationX.value=x||0,E.orientationY.value=w||0,E.orientationZ.value=S||0,E}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(e){this.globalGainNode.gain.value=e}get volume(){return this.globalGainNode.gain.value}set volume(e){if(this.muted){this.prevVolume=e;return}this.setGlobalVolume(e)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(e){e!==this.muted&&(e?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((e,t)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new IF(this.context);i.play(),e(i)}).catch(r=>{t(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(e){const{forward:t,up:r}=e,[i,o,c]=t,[s,l,d]=r;this.listener.forwardX.value=i,this.listener.forwardY.value=o,this.listener.forwardZ.value=c,this.listener.upX.value=s,this.listener.upY.value=l,this.listener.upZ.value=d}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(e){const[t,r,i]=e;this.listener.upX.value=t,this.listener.upY.value=r,this.listener.upZ.value=i}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(e){const[t,r,i]=e;this.listener.forwardX.value=t,this.listener.forwardY.value=r,this.listener.forwardZ.value=i}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(e){const[t,r,i]=e,o=this.context.currentTime;this.listener.positionX.setValueAtTime(t,o),this.listener.positionY.setValueAtTime(r,o),this.listener.positionZ.setValueAtTime(i,o)}};const kF="https://mongoose.world:9080/?url=";class EF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Client.Media");oe(this,"sounds",{});oe(this,"defaultUrl","")}handleDefault(t){this.defaultUrl=t}async handleLoad(t){const r=(t.url||this.defaultUrl)+t.name,i=t.url+t.name;if(!this.sounds[i]){let c=await this.client.cacophony.createSound(r);c.key=i,this.sounds[i]=c}}mediaUrl(t){var i;let r=(t.url||this.defaultUrl)+t.name;return((i=t.type)==null?void 0:i.toLowerCase())==="music"&&(r=kF+encodeURIComponent(r)),r}async handlePlay(t){let r=this.mediaUrl(t);t.key=t.key||r;let i=this.sounds[t.key];const o=t.is3d?"HRTF":"stereo";if((!i||i.url!==r)&&(t.type==="music"?i=await this.client.cacophony.createSound(r,af.HTML,o):i=await this.client.cacophony.createSound(r,af.Buffer,o)),t.volume!==void 0&&(i.volume=t.volume/100),t.loops!==void 0){const c=t.loops===-1?1/0:t.loops-1;i.loop(c)}if(t.start&&i.seek(t.start/1e3),t.end&&setTimeout(()=>{delete this.sounds[i.key],i.stop()},t.end),t.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[t.position[0],t.position[1],t.position[2]]),t.priority){for(let c in this.sounds){const s=this.sounds[c];s.priority&&s.priority<t.priority&&s.stop()}i.priority=t.priority}i.isPlaying||(i.play()[0],t.fadein,t.fadeout),i.key=t.key,this.sounds[i.key]=i}handleStop(t){t.name&&this.soundsByName(t.name).forEach(r=>this.stopSound(r)),t.type&&this.soundsByType(t.type).forEach(r=>this.stopSound(r)),t.tag&&this.soundsByTag(t.tag).forEach(r=>this.stopSound(r)),t.key&&this.soundsByKey(t.key).forEach(r=>this.stopSound(r)),!t.name&&!t.type&&!t.tag&&!t.key&&(this.allSounds.forEach(r=>r.stop()),this.sounds={})}stopSound(t){delete this.sounds[t.key],t.stop()}handleListenerPosition(t){var r;(r=t.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=t.position)}handleListenerOrientation(t){t.up&&t.up.length&&(this.client.cacophony.listenerUpOrientation=t.up),t.forward&&t.forward.length&&(this.client.cacophony.listenerForwardOrientation=t.forward)}soundsByName(t){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(t))}soundsByKey(t){return Object.values(this.sounds).filter(r=>r.key===t)}soundsByTag(t){return Object.values(this.sounds).filter(r=>r.tag===t)}soundsByType(t){return Object.values(this.sounds).filter(r=>r.mediaType===t)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(t=>t.stop()),this.sounds={}}}var r0={exports:{}},qm,KI;function TF(){return KI||(KI=1,qm=void 0),qm}var _F=r0.exports,qI;function RF(){return qI||(qI=1,function(n,e){(function(t,r){n.exports=r()})(_F,function(){var t=typeof window>"u"?Jh:window,r="1.9.3",i,o,c,s,l,d=Date.now||function(){return new Date().getTime()},h=d(),p=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return d()-h},g=function(u){setTimeout(u,0)};function y(){}function C(u){return typeof u=="function"}function x(){this._orig=this,this._ready=!1,this._queue=[],this._log=[]}x.prototype._exec=function(){for(;this._ready&&this._queue.length;){var u=this._queue.shift();u[0].apply(this,u[1])}},x.prototype._push=function(u,m){this._queue.push([u,m]),x.prototype._exec.apply(this)},x.prototype._slip=function(u,m){this._queue.unshift([u,m])},x.prototype._pause=function(){this._ready=!1},x.prototype._resume=function(){this._ready=!0,x.prototype._exec.apply(this)},x.prototype._break=function(u){this._orig._bad=!0,this._orig._log.push(u||"Unknown JZZ error")},x.prototype._repair=function(){this._orig._bad=!1},x.prototype._crash=function(u){this._break(u),this._resume()},x.prototype._err=function(){return this._log[this._log.length-1]},x.prototype.log=function(){return X(this._log)},x.prototype._dup=function(){var u=function(){};u.prototype=this._orig;var m=new u;return m._ready=!1,m._queue=[],m},x.prototype._image=function(){return this._dup()},x.prototype._thenable=function(){if(this.then)return this;var u=this,m=function(){};m.prototype=u;var I=new m;return I.then=function(U,z){return u._push(w,[U,z]),this},I};function w(u,m){this._bad?C(m)&&m.apply(this,[new Error(this._err())]):C(u)&&u.apply(this,[this])}function S(u,m){this._bad?u._crash(this._err()):setTimeout(function(){u._resume()},m)}x.prototype.wait=function(u){if(!u)return this;var m=this._image();return this._push(S,[m,u]),m._thenable()};function E(u){this._bad&&u._break(this._err()),u._resume()}function R(u,m,I){u[I]=function(){var U=arguments,z=m._image();return this._push(E,[z]),z[I].apply(z,U)}}function k(u){this._bad||(C(u)?u.apply(this):console.log(u))}x.prototype.and=function(u){return this._push(k,[u]),this._thenable()};function A(u){this._bad&&(C(u)?u.apply(this):console.log(u))}x.prototype.or=function(u){return this._push(A,[u]),this._thenable()},x.prototype._info={},x.prototype.info=function(){var u=X(this._orig._info);return typeof u.engine>"u"&&(u.engine="none"),typeof u.sysex>"u"&&(u.sysex=!0),u},x.prototype.name=function(){return this.info().name};function _(u){this._bad?u._crash(this._err()):(this._break("Closed"),u._resume())}x.prototype.close=function(){var u=new x;return this._close&&this._push(this._close,[]),this._push(_,[u]),u._thenable()};function D(u){if(!u.length){this._break();return}var m=u.shift();if(u.length){var I=this;this._slip(A,[function(){D.apply(I,[u])}])}try{this._repair(),m.apply(this)}catch(U){this._break(U.toString())}}function j(u,m){for(var I=0;I<u.length;I++)if(u[I]===m)return;u.push(m)}function Z(u,m){for(var I=0;I<u.length;I++)if(u[I]===m){u.splice(I,1);return}}function F(){x.apply(this)}F.prototype=new x;function V(u,m){for(var I in u)u.hasOwnProperty(I)&&m.call(this,I)}function X(u,m,I){if(typeof m>"u")return X(u,[],[]);if(u instanceof Object){for(var U=0;U<m.length;U++)if(m[U]===u)return I[U];var z;return u instanceof Array?z=[]:z={},m.push(u),I.push(z),V(u,function(se){z[se]=X(u[se],m,I)}),z}return u}F.prototype._info={name:"JZZ.js",ver:r,version:r,inputs:[],outputs:[]};var te=[],pe=[],ve=[],Ie=[],Re={},xe={};function Ae(){ct._info.engine=ce._type,ct._info.version=ce._version,ct._info.sysex=ce._sysex,ct._info.inputs=[],ct._info.outputs=[],te=[],pe=[],ce._allOuts={},ce._allIns={};var u,m;for(u=0;u<ce._outs.length;u++)m=ce._outs[u],!Re[m.name]&&(m.engine=ce,ce._allOuts[m.name]=m,ct._info.outputs.push({id:m.name,name:m.name,manufacturer:m.manufacturer,version:m.version,engine:ce._type}),te.push(m));for(u=0;u<rn._outs.length;u++)m=rn._outs[u],!Re[m.name]&&(ct._info.outputs.push({id:m.name,name:m.name,manufacturer:m.manufacturer,version:m.version,engine:m.type}),te.push(m));for(u=0;u<ce._ins.length;u++)m=ce._ins[u],!xe[m.name]&&(m.engine=ce,ce._allIns[m.name]=m,ct._info.inputs.push({id:m.name,name:m.name,manufacturer:m.manufacturer,version:m.version,engine:ce._type}),pe.push(m));for(u=0;u<rn._ins.length;u++)m=rn._ins[u],!xe[m.name]&&(ct._info.inputs.push({id:m.name,name:m.name,manufacturer:m.manufacturer,version:m.version,engine:m.type}),pe.push(m));if(ct._watcher&&ct._watcher._handles.length){var I=Ht(Ie,ve,ct._info.inputs,ct._info.outputs);if(I){for(o=0;o<I.inputs.removed.length;o++)m=ce._inMap[I.inputs.removed[o].name],m&&m._closeAll();for(o=0;o<I.outputs.removed.length;o++)m=ce._outMap[I.outputs.removed[o].name],m&&m._closeAll();g(function(){sn(I)})}}Ie=ct._info.inputs,ve=ct._info.outputs}function ke(){this._bad||ce._refresh(this)}F.prototype.refresh=function(){return this._push(ke,[]),this._thenable()};function H(u,m){var I,U;C(u)&&(u=u(m)),u instanceof Array||(u=[u]);var z=[],se=[],fe=m.slice(),Xe=z;for(I=0;I<u.length;I++)if(typeof u[I]>"u")Xe=se;else if(u[I]instanceof RegExp)for(U=0;U<fe.length;U++)u[I].test(fe[U].name)&&(Xe.push(fe[U]),fe.splice(U,1),U--);else for(U=0;U<fe.length;U++)(u[I]+""==U+""||u[I]===fe[U].name||u[I]instanceof Object&&u[I].name===fe[U].name)&&(Xe.push(fe[U]),fe.splice(U,1),U--);return Xe==z?z:z.concat(fe).concat(se)}function ee(u,m){var I;m instanceof RegExp?I="Port matching "+m+" not found":m instanceof Object||typeof m>"u"?I="Port not found":I='Port "'+m+'" not found',u._crash(I)}function ae(u,m){if(this._bad)u._crash(this._err());else{var I=H(m,te);if(!I.length){ee(u,m);return}for(var U=function(se){return function(){se.engine._openOut(this,se.name)}},z=0;z<I.length;z++)I[z]=U(I[z]);u._slip(D,[I]),u._resume()}}F.prototype.openMidiOut=function(u){var m=new _e;return this._push(ke,[]),this._push(ae,[m,u]),m._thenable()},F.prototype._openMidiOutNR=function(u){var m=new _e;return this._push(ae,[m,u]),m._thenable()};function ye(u,m){if(this._bad)u._crash(this._err());else{var I=H(m,pe);if(!I.length){ee(u,m);return}for(var U=function(se){return function(){se.engine._openIn(this,se.name)}},z=0;z<I.length;z++)I[z]=U(I[z]);u._slip(D,[I]),u._resume()}}F.prototype.openMidiIn=function(u){var m=new _e;return this._push(ke,[]),this._push(ye,[m,u]),m._thenable()},F.prototype._openMidiInNR=function(u){var m=new _e;return this._push(ye,[m,u]),m._thenable()};function Ee(u,m){this._bad?u._crash():(u._slip(Gt,[m]),u._resume())}F.prototype.onChange=function(u){this._orig._watcher||(this._orig._watcher=new lt);var m=this._orig._watcher._image();return this._push(Ee,[m,u]),m._thenable()},F.prototype._close=function(){ce._close();for(var u=mn.slice(),m=0;m<u.length;m++)u[m]&&(u[m]._close?u[m]._close():u[m].close&&u[m].close())};function _e(){x.apply(this),this._handles=[],this._outs=[]}_e.prototype=new x,_e.prototype._filter=function(u){if(this._orig._mpe){var m,I=0;this._handles&&this._handles.length&&(I=this._handles.length,m=this._handles[0]),this._outs&&this._outs.length&&(I=this._outs.length,m=this._outs[0]),I==1&&!m._mpe&&(u=this._orig._mpe.filter(u))}return u},_e.prototype._receive=function(u){this._emit(this._filter(u))};function Je(u){this._bad||this._receive(u)}_e.prototype.send=function(){return this._push(Je,[me.apply(null,arguments)]),this._thenable()},_e.prototype.note=function(u,m,I,U){return this.noteOn(u,m,I),typeof this._ch>"u"&&typeof this._master>"u"?U>0&&this.wait(U).noteOff(u,m):I>0&&this.wait(I).noteOff(u),this._thenable()};function me(u){return u.isMidi2?new Ct(u):J.apply(null,arguments)}_e.prototype._emit=function(u){var m,I;for(m=0;m<this._handles.length;m++)I=me(u),this._handles[m].apply(this,[I._stamp(this)]);for(m=0;m<this._outs.length;m++)I=me(u),I._stamped(this._outs[m])||this._outs[m].send(I._stamp(this))};function it(u){this._emit(u)}_e.prototype.emit=function(u){return this._push(it,[u]),this._thenable()};function Tt(u){C(u)?j(this._orig._handles,u):j(this._orig._outs,u)}function Xt(u){typeof u>"u"?(this._orig._handles=[],this._orig._outs=[]):C(u)?Z(this._orig._handles,u):Z(this._orig._outs,u)}_e.prototype.connect=function(u){return this._push(Tt,[u]),this._thenable()},_e.prototype.disconnect=function(u){return this._push(Xt,[u]),this._thenable()},_e.prototype.connected=function(){return this._orig._handles.length+this._orig._outs.length},_e.prototype._image=function(){var u=this._dup();return u._gr=this._gr,u._ch=this._ch,u._sxid=this._sxid,u._master=this._master,u._band=this._band,u},_e.prototype._sxid=127,_e.prototype.sxId=function(u){if(typeof u>"u"&&(u=_e.prototype._sxid),u==this._sxid)return this._thenable();u=He(u);var m=this._image();return m._sxid=u,this._push(E,[m]),m._thenable()},_e.prototype.ch=function(u){if(u==this._ch||typeof u>"u"&&typeof this._ch>"u")return this._thenable();var m=this._image();return typeof u<"u"&&(u=Le(u)),m._ch=u,m._master=void 0,m._band=void 0,this._push(E,[m]),m._thenable()},_e.prototype.MIDI1=function(){var u=this._image();return u._ch=void 0,u._sxid=_e.prototype._sxid,u._master=void 0,u._band=void 0,this._push(E,[u]),u._thenable()},_e.prototype.MIDI2=function(){var u=this._image();u._ch=void 0,u._sxid=_e.prototype._sxid,u._master=void 0,u._band=void 0;var m=new Pt(u);return this._push(E,[m]),m._thenable()};function Et(u,m){this._orig._mpe||(this._orig._mpe=new xr),this._orig._mpe.setup(u,m)}_e.prototype.mpe=function(u,m){if(u==this._master&&m==this._band||typeof u>"u"&&typeof this._master>"u")return this._thenable();if(typeof u<"u"&&xr.validate(u,m),!m)return this.ch(u);var I=this._image();return I._ch=void 0,I._master=u,I._band=m,this._push(Et,[u,m]),this._push(E,[I]),I._thenable()};function St(u){if(u!=parseInt(u)||u<0||u>15)throw RangeError("Bad channel value (must not be less than 0 or more than 15): "+u)}function Pt(u){x.apply(this),this._sink=u}Pt.prototype=new x,Pt.prototype._sxid=_e.prototype._sxid,Pt.prototype._receive=function(u){this._sink._receive(u)};function at(u){return u.isMidi&&!u.isMidi2?new J(u):Ct.apply(null,arguments)}Pt.prototype.send=function(){return this._push(Je,[at.apply(null,arguments)]),this._thenable()},Pt.prototype._image=_e.prototype._image,Pt.prototype.connect=function(u){return this._sink.connect(u),this._push(E,[this._sink]),this._thenable()},Pt.prototype.disconnect=function(u){return this._sink.disconnect(u),this._push(E,[this._sink]),this._thenable()},Pt.prototype.connected=function(){return this._sink.connected()},Pt.prototype.sxId=_e.prototype.sxId,Pt.prototype.ch=_e.prototype.ch,Pt.prototype.gr=function(u){if(u==this._gr||typeof u>"u"&&typeof this._gr>"u")return this._thenable();var m=this._image();return typeof u<"u"&&(u=He(u)),m._gr=u,this._push(E,[m]),m._thenable()},Pt.prototype.MIDI1=function(){var u=this._sink._image();return this._push(E,[u]),u._thenable()},Pt.prototype.MIDI2=function(){var u=this._image();return u._gr=void 0,u._ch=void 0,u._sxid=_e.prototype._sxid,this._push(E,[u]),u._thenable()};function lt(){x.apply(this),this._handles=[],R(this,ct,"refresh"),R(this,ct,"openMidiOut"),R(this,ct,"openMidiIn"),R(this,ct,"onChange"),R(this,ct,"close")}lt.prototype=new x;function Gt(u){C(u)&&(this._orig._handles.length||ce._watch(),j(this._orig._handles,u))}function Vt(u){typeof u>"u"?this._orig._handles=[]:Z(this._orig._handles,u),this._orig._handles.length||ce._unwatch()}lt.prototype.connect=function(u){return this._push(Gt,[u]),this._thenable()},lt.prototype.disconnect=function(u){return this._push(Vt,[u]),this._thenable()};function Dt(u,m,I,U){var z;if(u.length!=I.length||m.length!=U.length)return!0;for(z=0;z<u.length;z++)if(u[z].name!=I[z].name)return!0;for(z=0;z<m.length;z++)if(m[z].name!=U[z].name)return!0;return!1}function Ht(u,m,I,U){if(Dt(u,m,I,U)){var z=[],se=[],fe=[],Xe=[],qe,yt={};for(qe=0;qe<u.length;qe++)yt[u[qe].name]=!0;for(qe=0;qe<I.length;qe++)yt[I[qe].name]||z.push(I[qe]);for(yt={},qe=0;qe<I.length;qe++)yt[I[qe].name]=!0;for(qe=0;qe<u.length;qe++)yt[u[qe].name]||fe.push(u[qe]);for(yt={},qe=0;qe<m.length;qe++)yt[m[qe].name]=!0;for(qe=0;qe<U.length;qe++)yt[U[qe].name]||se.push(U[qe]);for(yt={},qe=0;qe<U.length;qe++)yt[U[qe].name]=!0;for(qe=0;qe<m.length;qe++)yt[m[qe].name]||Xe.push(m[qe]);return{inputs:{added:z,removed:fe},outputs:{added:se,removed:Xe}}}}function sn(u){for(i=0;i<ct._watcher._handles.length;i++)ct._watcher._handles[i].apply(ct,[u])}var ct,ce={_outs:[],_ins:[],_close:y},rn={_outs:[],_ins:[]},mn=[];function Vn(){if(n.exports){var u=TF();if(u){kr(u);return}}this._break()}function q(){var u=document.createElement("div");u.style.visibility="hidden",document.body.appendChild(u);var m=document.createElement("object");if(m.style.visibility="hidden",m.style.width="0px",m.style.height="0px",m.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",m.type="audio/x-jazz",document.body.appendChild(m),m.isJazz){yr(m);return}this._break()}var N,L;function ne(){if(typeof navigator<"u"&&navigator.requestMIDIAccess){N=navigator,L=navigator.requestMIDIAccess;try{L.toString().indexOf("JZZ(")!=-1&&(L=void 0)}catch{}}}function Ce(){if(ne(),L){var u=this,m=function(z){Qt(z),u._resume()},I=function(z){u._crash(z)},U={};L.call(N,U).then(m,I),this._pause();return}this._break()}function Pe(){if(ne(),L){var u=this,m=function(z){Qt(z,!0),u._resume()},I=function(z){u._crash(z)},U={sysex:!0};L.call(N,U).then(m,I),this._pause();return}this._break()}function Ve(){var u=this,m,I;function U(z){m=!0;var se=z.detail;if(!se){if(I||(I=document.getElementById("jazz-midi-msg")),!I)return;try{se=JSON.parse(I.innerText)}catch{}I.innerText=""}document.removeEventListener("jazz-midi-msg",U),se[0]==="version"?(ei(I,se[2]),u._resume()):u._crash()}this._pause();try{document.addEventListener("jazz-midi-msg",U),document.dispatchEvent(new Event("jazz-midi"))}catch{}setTimeout(function(){m||u._crash()},50)}function Lt(){this._pause();var u=this;g(function(){u._crash()})}function hn(u){for(var m=[],I=pn(u),U=0;U<I.length;U++)I[U]=="webmidi"?(u&&u.sysex===!0&&m.push(Pe),(!u||u.sysex!==!0||u.degrade===!0)&&m.push(Ce)):I[U]=="node"?(m.push(Vn),m.push(Lt)):I[U]=="extension"?m.push(Ve):I[U]=="plugin"&&m.push(q);return m.push(dn),m}function pn(u){var m=["node","extension","plugin","webmidi"];if(!u||!u.engine)return m;var I=u.engine instanceof Array?u.engine:[u.engine],U={},z,se,fe=[],Xe=[],qe;for(qe=0;qe<I.length;qe++){var yt=I[qe].toString().toLowerCase();U[yt]||(U[yt]=!0,yt==="none"&&(z=!0),(yt==="etc"||typeof yt>"u")&&(se=!0),se?Xe.push(yt):fe.push(yt),Z(m,yt))}return(se||fe.length||Xe.length)&&(z=!1),z?[]:fe.concat(se?m:Xe)}function xn(u){ct=new F,ct._options=u,ct._push(D,[hn(u)]),ct.refresh(),ct._resume()}function dn(){ce._type="none",ce._version=r,ce._sysex=!0,ce._outs=[],ce._ins=[],ce._outMap={},ce._inMap={},ce._refresh=function(){Ae()},ce._watch=y,ce._unwatch=y,ce._close=y}function Ln(){ce._inArr=[],ce._outArr=[],ce._inMap={},ce._outMap={},ce._outsW=[],ce._insW=[],ce._version=ce._main.version,ce._sysex=!0;var u;function m(){for(var I=0;I<this.clients.length;I++)this._close(this.clients[I])}ce._refresh=function(){ce._outs=[],ce._ins=[];var I,U;for(I=0;(U=ce._main.MidiOutInfo(I)).length;I++)ce._outs.push({type:ce._type,name:U[0],manufacturer:U[1],version:U[2]});for(I=0;(U=ce._main.MidiInInfo(I)).length;I++)ce._ins.push({type:ce._type,name:U[0],manufacturer:U[1],version:U[2]});Ae()},ce._openOut=function(I,U){var z=ce._outMap[U];if(!z){ce._pool.length<=ce._outArr.length&&ce._pool.push(ce._newPlugin()),z={name:U,clients:[],info:{name:U,manufacturer:ce._allOuts[U].manufacturer,version:ce._allOuts[U].version,type:"MIDI-out",sysex:ce._sysex,engine:ce._type},_close:function(Xe){ce._closeOut(Xe)},_closeAll:m,_receive:function(Xe){Xe.length&&this.plugin.MidiOutRaw(Xe.slice())}};var se=ce._pool[ce._outArr.length];z.plugin=se,ce._outArr.push(z),ce._outMap[U]=z}if(!z.open){var fe=z.plugin.MidiOutOpen(U);if(fe!==U){fe&&z.plugin.MidiOutClose(),I._break();return}z.open=!0}I._orig._impl=z,j(z.clients,I._orig),I._info=z.info,I._receive=function(Xe){z._receive(Xe)},I._close=function(){z._close(this)}},ce._openIn=function(I,U){var z=ce._inMap[U];if(!z){ce._pool.length<=ce._inArr.length&&ce._pool.push(ce._newPlugin()),z={name:U,clients:[],info:{name:U,manufacturer:ce._allIns[U].manufacturer,version:ce._allIns[U].version,type:"MIDI-in",sysex:ce._sysex,engine:ce._type},_close:function(qe){ce._closeIn(qe)},_closeAll:m,handle:function(qe,yt){for(var wr=0;wr<this.clients.length;wr++){var Wo=J(yt);this.clients[wr]._emit(Wo)}}};var se=function(qe){return function(yt,wr){qe.handle(yt,wr)}};z.onmidi=se(z);var fe=ce._pool[ce._inArr.length];z.plugin=fe,ce._inArr.push(z),ce._inMap[U]=z}if(!z.open){var Xe=z.plugin.MidiInOpen(U,z.onmidi);if(Xe!==U){Xe&&z.plugin.MidiInClose(),I._break();return}z.open=!0}I._orig._impl=z,j(z.clients,I._orig),I._info=z.info,I._close=function(){z._close(this)}},ce._closeOut=function(I){var U=I._impl;Z(U.clients,I._orig),!U.clients.length&&U.open&&(U.open=!1,U.plugin.MidiOutClose())},ce._closeIn=function(I){var U=I._impl;Z(U.clients,I._orig),!U.clients.length&&U.open&&(U.open=!1,U.plugin.MidiInClose())},ce._close=function(){for(var I=0;I<ce._inArr.length;I++)ce._inArr[I].open&&ce._inArr[I].plugin.MidiInClose();ce._unwatch()},ce._watch=function(){u||(u=setInterval(function(){ce._refresh()},250))},ce._unwatch=function(){u&&clearInterval(u),u=void 0}}function kr(u){ce._type="node",ce._main=u,ce._pool=[],ce._newPlugin=function(){return new u.MIDI},Ln()}function yr(u){ce._type="plugin",ce._main=u,ce._pool=[u],ce._newPlugin=function(){var m=document.createElement("object");return m.style.visibility="hidden",m.style.width="0px",u.style.height="0px",m.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",m.type="audio/x-jazz",document.body.appendChild(m),m.isJazz?m:void 0},Ln()}function Qt(u,m){ce._type="webmidi",ce._version=43,ce._sysex=!!m,ce._access=u,ce._inMap={},ce._outMap={},ce._outsW=[],ce._insW=[];var I;function U(){for(var z=0;z<this.clients.length;z++)this._close(this.clients[z])}ce._refresh=function(){ce._outs=[],ce._ins=[],ce._access.outputs.forEach(function(z){ce._outs.push({type:ce._type,name:z.name,manufacturer:z.manufacturer,version:z.version})}),ce._access.inputs.forEach(function(z){ce._ins.push({type:ce._type,name:z.name,manufacturer:z.manufacturer,version:z.version})}),Ae()},ce._openOut=function(z,se){var fe=ce._outMap[se];fe||(fe={name:se,clients:[],info:{name:se,manufacturer:ce._allOuts[se].manufacturer,version:ce._allOuts[se].version,type:"MIDI-out",sysex:ce._sysex,engine:ce._type},_close:function(qe){ce._closeOut(qe)},_closeAll:U,_receive:function(qe){fe.dev&&qe.length&&this.dev.send(qe.slice())}});var Xe;ce._access.outputs.forEach(function(qe){qe.name===se&&(Xe=qe)}),Xe?(fe.dev=Xe,ce._outMap[se]=fe,z._orig._impl=fe,j(fe.clients,z._orig),z._info=fe.info,z._receive=function(qe){fe._receive(qe)},z._close=function(){fe._close(this)},fe.dev.open&&(z._pause(),fe.dev.open().then(function(){z._resume()},function(){z._crash()}))):z._break()},ce._openIn=function(z,se){var fe=ce._inMap[se];fe||(fe={name:se,clients:[],info:{name:se,manufacturer:ce._allIns[se].manufacturer,version:ce._allIns[se].version,type:"MIDI-in",sysex:ce._sysex,engine:ce._type},_close:function(yt){ce._closeIn(yt)},_closeAll:U,handle:function(yt){for(var wr=0;wr<this.clients.length;wr++){var Wo=J([].slice.call(yt.data));this.clients[wr]._emit(Wo)}}});var Xe;if(ce._access.inputs.forEach(function(yt){yt.name===se&&(Xe=yt)}),Xe){fe.dev=Xe;var qe=function(yt){return function(wr){yt.handle(wr)}};fe.dev.onmidimessage=qe(fe),ce._inMap[se]=fe,z._orig._impl=fe,j(fe.clients,z._orig),z._info=fe.info,z._close=function(){fe._close(this)},fe.dev.open&&(z._pause(),fe.dev.open().then(function(){z._resume()},function(){z._crash()}))}else z._break()},ce._closeOut=function(z){var se=z._impl;Z(se.clients,z._orig),se.clients.length||(se.dev&&se.dev.close&&se.dev.close(),se.dev=void 0)},ce._closeIn=function(z){var se=z._impl;Z(se.clients,z._orig),se.clients.length||(se.dev&&(se.dev.onmidimessage=null,se.dev.close&&se.dev.close()),se.dev=void 0)},ce._close=function(){ce._unwatch()},ce._watch=function(){ce._access.onstatechange=function(){I=!0,g(function(){I&&(ce._refresh(),I=!1)})}},ce._unwatch=function(){ce._access.onstatechange=void 0}}function ei(u,m){ce._type="extension",ce._version=m,ce._sysex=!0,ce._pool=[],ce._outs=[],ce._ins=[],ce._inArr=[],ce._outArr=[],ce._inMap={},ce._outMap={},ce._outsW=[],ce._insW=[],ce.refreshClients=[],ce._msg=u,ce._newPlugin=function(){var z={id:ce._pool.length};ce._pool.push(z),z.id?document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["new"]})):z.ready=!0},ce._newPlugin(),ce._refresh=function(z){ce.refreshClients.push(z),z._pause(),g(function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["refresh"]}))})};function I(){for(var z=0;z<this.clients.length;z++)this._close(this.clients[z])}ce._openOut=function(z,se){var fe=ce._outMap[se];if(!fe){ce._pool.length<=ce._outArr.length&&ce._newPlugin();var Xe=ce._pool[ce._outArr.length];fe={name:se,clients:[],info:{name:se,manufacturer:ce._allOuts[se].manufacturer,version:ce._allOuts[se].version,type:"MIDI-out",sysex:ce._sysex,engine:ce._type},_start:function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["openout",Xe.id,se]}))},_close:function(qe){ce._closeOut(qe)},_closeAll:I,_receive:function(qe){if(qe.length){var yt=qe.slice();yt.splice(0,0,"play",Xe.id),document.dispatchEvent(new CustomEvent("jazz-midi",{detail:yt}))}}},fe.plugin=Xe,Xe.output=fe,ce._outArr.push(fe),ce._outMap[se]=fe}z._orig._impl=fe,j(fe.clients,z._orig),z._info=fe.info,z._receive=function(qe){fe._receive(qe)},z._close=function(){fe._close(this)},fe.open||(z._pause(),fe.plugin.ready&&fe._start())},ce._openIn=function(z,se){var fe=ce._inMap[se];if(!fe){ce._pool.length<=ce._inArr.length&&ce._newPlugin();var Xe=ce._pool[ce._inArr.length];fe={name:se,clients:[],info:{name:se,manufacturer:ce._allIns[se].manufacturer,version:ce._allIns[se].version,type:"MIDI-in",sysex:ce._sysex,engine:ce._type},_start:function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["openin",Xe.id,se]}))},_close:function(qe){ce._closeIn(qe)},_closeAll:I},fe.plugin=Xe,Xe.input=fe,ce._inArr.push(fe),ce._inMap[se]=fe}z._orig._impl=fe,j(fe.clients,z._orig),z._info=fe.info,z._close=function(){fe._close(this)},fe.open||(z._pause(),fe.plugin.ready&&fe._start())},ce._closeOut=function(z){var se=z._impl;Z(se.clients,z._orig),!se.clients.length&&se.open&&(se.open=!1,document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["closeout",se.plugin.id]})))},ce._closeIn=function(z){var se=z._impl;Z(se.clients,z._orig),!se.clients.length&&se.open&&(se.open=!1,document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["closein",se.plugin.id]})))},ce._close=function(){ce._unwatch()};var U;ce._watch=function(){ce._insW=ce._ins,ce._outsW=ce._outs,U=setInterval(function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["refresh"]}))},250)},ce._unwatch=function(){clearInterval(U),U=void 0},document.addEventListener("jazz-midi-msg",function(z){var se,fe,Xe,qe=z.detail?[z.detail]:void 0;if(!qe)for(qe=ce._msg.innerText.split(`
`),ce._msg.innerText="",se=0;se<qe.length;se++)try{qe[se]=JSON.parse(qe[se])}catch{qe[se]=[]}for(se=0;se<qe.length;se++){var yt=qe[se];if(yt.length){if(yt[0]==="refresh"){if(yt[1].ins){for(fe=0;fe<yt[1].ins.length;fe++)yt[1].ins[fe].type=ce._type;ce._ins=yt[1].ins}if(yt[1].outs){for(fe=0;fe<yt[1].outs.length;fe++)yt[1].outs[fe].type=ce._type;ce._outs=yt[1].outs}for(Ae(),fe=0;fe<ce.refreshClients.length;fe++)ce.refreshClients[fe]._resume();ce.refreshClients=[]}else if(yt[0]==="version"){var wr=ce._pool[yt[1]];wr&&(wr.ready=!0,wr.input&&wr.input._start(),wr.output&&wr.output._start())}else if(yt[0]==="openout"){if(Xe=ce._pool[yt[1]].output,Xe){if(yt[2]==Xe.name){if(Xe.open=!0,Xe.clients)for(fe=0;fe<Xe.clients.length;fe++)Xe.clients[fe]._resume()}else if(Xe.clients)for(fe=0;fe<Xe.clients.length;fe++)Xe.clients[fe]._crash()}}else if(yt[0]==="openin"){if(Xe=ce._pool[yt[1]].input,Xe){if(yt[2]==Xe.name){if(Xe.open=!0,Xe.clients)for(fe=0;fe<Xe.clients.length;fe++)Xe.clients[fe]._resume()}else if(Xe.clients)for(fe=0;fe<Xe.clients.length;fe++)Xe.clients[fe]._crash()}}else if(yt[0]==="midi"&&(Xe=ce._pool[yt[1]].input,Xe&&Xe.clients))for(fe=0;fe<Xe.clients.length;fe++){var Wo=J(yt.slice(3));Xe.clients[fe]._emit(Wo)}}}})}var Qe=function(u){return ct||xn(u),ct._thenable()};Qe.JZZ=Qe,Qe.version=r,Qe.info=function(){return F.prototype.info()};function Tn(u){var m=new _e;return u instanceof Object&&V(u,function(I){m[I]=u[I]}),m._resume(),m}Qe.Widget=Tn,F.prototype.Widget=Qe.Widget,Qe.addMidiIn=function(u,m){var I=X(m._info||{});I.name=u,I.type=I.type||"javascript",I.manufacturer=I.manufacturer||"virtual",I.version=I.version||"0.0";var U={_info:function(){return I},_openIn:function(z){z._pause(),z._info=X(I),z._close=function(){m.disconnect(z)},m.connect(z),z._resume()}};return Qe.lib.registerMidiIn(u,U)},F.prototype.addMidiIn=Qe.addMidiIn,Qe.addMidiOut=function(u,m){var I=X(m._info||{});I.name=u,I.type=I.type||"javascript",I.manufacturer=I.manufacturer||"virtual",I.version=I.version||"0.0";var U={_info:function(){return I},_openOut:function(z){z._pause(),z._info=X(I),z._close=function(){z.disconnect()},Tt.apply(z,[m]),z._resume()}};return Qe.lib.registerMidiOut(u,U)},F.prototype.addMidiOut=Qe.addMidiOut,Qe.removeMidiOut=function(u){return Qe.lib.unregisterMidiOut(u)},F.prototype.removeMidiOut=Qe.removeMidiOut,Qe.removeMidiIn=function(u){return Qe.lib.unregisterMidiIn(u)},F.prototype.removeMidiIn=Qe.removeMidiIn,Qe.maskMidiIn=function(u){xe[u]=!0},F.prototype.maskMidiIn=Qe.maskMidiIn,Qe.unmaskMidiIn=function(u){delete xe[u]},F.prototype.unmaskMidiIn=Qe.unmaskMidiIn,Qe.maskMidiOut=function(u){Re[u]=!0},F.prototype.maskMidiOut=Qe.maskMidiOut,Qe.unmaskMidiOut=function(u){delete Re[u]},F.prototype.unmaskMidiOut=Qe.unmaskMidiOut;function Wt(){var u=this instanceof Wt?this:u=new Wt;return Wt.prototype.reset.apply(u,arguments),u}Wt.prototype.reset=function(u){if(u instanceof Wt)return this.setType(u.getType()),this.setHour(u.getHour()),this.setMinute(u.getMinute()),this.setSecond(u.getSecond()),this.setFrame(u.getFrame()),this.setQuarter(u.getQuarter()),this;var m=u instanceof Array?u:arguments;return this.setType(m[0]),this.setHour(m[1]),this.setMinute(m[2]),this.setSecond(m[3]),this.setFrame(m[4]),this.setQuarter(m[5]),this};function hr(){this.type==29.97&&!this.second&&this.frame<2&&this.minute%10&&(this.frame=2)}Wt.prototype.isFullFrame=function(){return this.quarter==0||this.quarter==4},Wt.prototype.getType=function(){return this.type},Wt.prototype.getHour=function(){return this.hour},Wt.prototype.getMinute=function(){return this.minute},Wt.prototype.getSecond=function(){return this.second},Wt.prototype.getFrame=function(){return this.frame},Wt.prototype.getQuarter=function(){return this.quarter},Wt.prototype.setType=function(u){if(typeof u>"u"||u==24)this.type=24;else if(u==25)this.type=25;else if(u==29.97)this.type=29.97,hr.apply(this);else if(u==30)this.type=30;else throw RangeError("Bad SMPTE frame rate: "+u);return this.frame>=this.type&&(this.frame=this.type-1),this},Wt.prototype.setHour=function(u){if(typeof u>"u"&&(u=0),u!=parseInt(u)||u<0||u>=24)throw RangeError("Bad SMPTE hours value: "+u);return this.hour=u,this},Wt.prototype.setMinute=function(u){if(typeof u>"u"&&(u=0),u!=parseInt(u)||u<0||u>=60)throw RangeError("Bad SMPTE minutes value: "+u);return this.minute=u,hr.apply(this),this},Wt.prototype.setSecond=function(u){if(typeof u>"u"&&(u=0),u!=parseInt(u)||u<0||u>=60)throw RangeError("Bad SMPTE seconds value: "+u);return this.second=u,hr.apply(this),this},Wt.prototype.setFrame=function(u){if(typeof u>"u"&&(u=0),u!=parseInt(u)||u<0||u>=this.type)throw RangeError("Bad SMPTE frame number: "+u);return this.frame=u,hr.apply(this),this},Wt.prototype.setQuarter=function(u){if(typeof u>"u"&&(u=0),u!=parseInt(u)||u<0||u>=8)throw RangeError("Bad SMPTE quarter frame: "+u);return this.quarter=u,this},Wt.prototype.incrFrame=function(){return this.frame++,this.frame>=this.type&&(this.frame=0,this.second++,this.second>=60&&(this.second=0,this.minute++,this.minute>=60&&(this.minute=0,this.hour=this.hour>=23?0:this.hour+1))),hr.apply(this),this},Wt.prototype.decrFrame=function(){return!this.second&&this.frame==2&&this.type==29.97&&this.minute%10&&(this.frame=0),this.frame--,this.frame<0&&(this.frame=this.type==29.97?29:this.type-1,this.second--,this.second<0&&(this.second=59,this.minute--,this.minute<0&&(this.minute=59,this.hour=this.hour?this.hour-1:23))),this},Wt.prototype.incrQF=function(){return this.backwards=!1,this.quarter=this.quarter+1&7,(this.quarter==0||this.quarter==4)&&this.incrFrame(),this},Wt.prototype.decrQF=function(){return this.backwards=!0,this.quarter=this.quarter+7&7,(this.quarter==3||this.quarter==7)&&this.decrFrame(),this};function Qn(u){return[[24,25,29.97,30][u[7]>>1&3],(u[7]&1)<<4|u[6],u[5]<<4|u[4],u[3]<<4|u[2],u[1]<<4|u[0]]}Wt.prototype.read=function(u){if(u instanceof J||(u=J.apply(null,arguments)),u[0]==240&&u[1]==127&&u[3]==1&&u[4]==1&&u[9]==247)return this.type=[24,25,29.97,30][u[5]>>5&3],this.hour=u[5]&31,this.minute=u[6],this.second=u[7],this.frame=u[8],this.quarter=0,this._=void 0,this._b=void 0,this._f=void 0,!0;if(u[0]==241&&typeof u[1]<"u"){var m=u[1]>>4,I=u[1]&15;return m==0?this._==7&&(this._f==7&&(this.reset(Qn(this._a)),this.incrFrame()),this.incrFrame()):m==3?this._==4&&this.decrFrame():m==4?this._==3&&this.incrFrame():m==7&&this._===0&&(this._b===0&&(this.reset(Qn(this._a)),this.decrFrame()),this.decrFrame()),this._a||(this._a=[]),this._a[m]=I,this._f=this._f===m-1||m==0?m:void 0,this._b=this._b===m+1||m==7?m:void 0,this._=m,this.quarter=m,!0}return!1};function ti(u){!u.backwards&&u.quarter>=4?u.decrFrame():u.backwards&&u.quarter<4&&u.incrFrame();var m;switch(u.quarter>>1){case 0:m=u.frame;break;case 1:m=u.second;break;case 2:m=u.minute;break;default:m=u.hour}return u.quarter&1?m>>=4:m&=15,u.quarter==7&&(u.type==25?m|=2:u.type==29.97?m|=4:u.type==30&&(m|=6)),!u.backwards&&u.quarter>=4?u.incrFrame():u.backwards&&u.quarter<4&&u.decrFrame(),m|u.quarter<<4}function Lr(u){return u.type==25?u.hour|32:u.type==29.97?u.hour|64:u.type==30?u.hour|96:u.hour}function ge(u){return u<10?"0"+u:u}function we(u){for(var m=[],I=0;I<u.length;I++)m[I]=ge(I?u[I]:u[I]&31);return m.join(":")}Wt.prototype.toString=function(){return we([this.hour,this.minute,this.second,this.frame])},Qe.SMPTE=Wt,F.prototype.SMPTE=Wt;function J(u){var m=this instanceof J?this:m=new J,I;if(u instanceof J)return m._from=u._from.slice(),V(u,function(z){z!="_from"&&(m[z]=u[z])}),m;if(m._from=[],typeof u>"u")return m;var U=u instanceof Array?u:arguments;for(I=0;I<U.length;I++)l=U[I],I==1&&(m[0]>=128&&m[0]<=175&&(l=J.noteValue(l)),m[0]>=192&&m[0]<=207&&(l=J.programValue(l))),(l!=parseInt(l)||l<0||l>255)&&pt(U[I]),m.push(l);return m}J.prototype=[],J.prototype.constructor=J,J.prototype.isMidi=function(){return 1};var Ge={};J.noteValue=function(u){return typeof u>"u"?void 0:Ge[u.toString().toLowerCase()]},J.programValue=function(u){return u},J.octaveValue=function(u){var m=Ge[u.toString().toLowerCase()];return typeof m>"u"&&(m=Ge[u.toString().toLowerCase()+"1"]),typeof m>"u"?void 0:m%12},J.freq=function(u,m){return typeof m>"u"&&(m=440),rt(m),u!=parseFloat(u)&&(u=Ft(u)),m*Math.pow(2,(u-69)/12)};function rt(u){if(u!=parseFloat(u))throw TypeError("Not a number: "+u)}J.shift=function(u,m){return typeof m>"u"&&(m=440),rt(u),rt(m),Math.log2(u/m)*12},J.midi=function(u,m){return u!=parseFloat(u)?Ft(u):J.shift(u,m)+69},J.to7b=function(u){return rt(u),u<=0?0:u>=1?127:Math.floor(u*128)},J.to14b=function(u){return rt(u),u<=0?0:u>=1?16383:Math.floor(u*16384)},J.to21b=function(u){return typeof u>"u"?2097151:(rt(u),u<=0?0:(u=(Math.floor(u)<<14)+J.to14b(u-Math.floor(u)),u<2097151?u:2097150))},J.to32b=function(u){return rt(u),u<=0?0:u>=1?4294967295:Math.floor(u*4294967296)};function _t(){}_t.prototype=J,J._sxid=127,J.sxId=function(u){if(typeof u>"u"&&(u=J._sxid),u==this._sxid)return this;u=He(u);var m=new _t;return m._ch=this._ch,m._sxid=u,m},J.ch=function(u){if(u==this._ch||typeof u>"u"&&typeof this._ch>"u")return this;var m=new _t;return typeof u<"u"&&(u=Le(u)),m._ch=u,m._sxid=this._sxid,m};var Ot={c:0,d:2,e:4,f:5,g:7,a:9,b:11,h:11};for(V(Ot,function(u){for(l=0;l<12&&(s=Ot[u]+l*12,!(s>127));l++)Ge[u+l]=s,Ge[u+""+l]=s,s>0&&(Ge[u+"b"+l]=s-1,Ge[u+""+l]=s-1,Ge[u+"bb"+l]=s-2,Ge[u+""+l]=s-2,Ge[u+""+l]=s-2),s<127&&(Ge[u+"#"+l]=s+1,Ge[u+""+l]=s+1,Ge[u+"##"+l]=s+2,Ge[u+""+l]=s+2,Ge[u+""+l]=s+2)}),l=0;l<128;l++)Ge[l]=l;function pt(u){throw RangeError("Bad MIDI value: "+u)}function gt(u){throw TypeError("Invalid value: "+u)}function bt(u){throw RangeError("Out of range: "+u)}function Le(u){return St(u),parseInt(u)}function ut(u){if(u!=parseInt(u)||u<0||u>15)throw RangeError("Expected a 4-bit value: "+u);return parseInt(u)}function He(u,m){return(u!=parseInt(u)||u<0||u>127)&&pt(typeof m>"u"?u:m),parseInt(u)}function bn(u){return(u!=parseInt(u)||u<0||u>255)&&pt(u),parseInt(u)}function st(u){return(u!=parseInt(u)||u<0||u>16383)&&pt(u),parseInt(u)}function de(u){if(u!=parseInt(u)||u<0||u>65535)throw RangeError("Expected a 16-bit value: "+u);return parseInt(u)}function Ze(u){if(u!=parseInt(u)||u<0||u>1048575)throw RangeError("Expected a 20-bit value: "+u);return parseInt(u)}function It(u){return(u!=parseInt(u)||u<0||u>2097151)&&pt(u),parseInt(u)}function In(u){return(u!=parseInt(u)||u<0||u>4294967295)&&pt(u),parseInt(u)}function Ft(u){return He(J.noteValue(u),u)}function wt(u){return st(u)&127}function zt(u){return st(u)>>7}function Jn(u){u=""+u;for(var m=0;m<u.length;m++)u.charCodeAt(m)>255&&pt(u[m]);return u}function er(u){return[u>>14,u>>7&127,u&127]}function ir(u,m){return u!=parseFloat(u)&&gt(typeof m>"u"?u:m),(u<0||u>1)&&bt(typeof m>"u"?u:m),parseFloat(u)}function Fn(u){return typeof u<"u"&&!u?126:127}function nn(u){var m,I,U=[],z={};V(u,function(fe){if(I=It(u[fe]),fe=Ft(fe),fe in z)throw RangeError("Duplicate MIDI value: "+fe);U.push(fe),z[fe]=I}),U.sort();var se=[U.length];for(m=0;m<U.length;m++)se=se.concat([U[m]],er(z[U[m]]));return se}function vn(u){var m={};return V(u,function(I){m[I]=J.to21b(u[I]==parseFloat(u[I])?u[I]:Ft(u[I]))}),m}function or(u){var m={};return V(u,function(I){m[I]=J.to21b(J.midi(u[I]))}),m}function hi(u){var m=[];if(!(u instanceof Array)||u.length!=12)throw TypeError("Expected an array of size 12");for(var I=0;I<12;I++)m.push(He(u[I]));return m}function yn(u){var m=[];if(!(u instanceof Array)||u.length!=12)throw TypeError("Expected an array of size 12");for(var I=0;I<12;I++)m.push(zt(u[I])),m.push(wt(u[I]));return m}var Wr={noteOff:function(u,m,I){return typeof I>"u"&&(I=64),[128+Le(u),Ft(m),He(I)]},noteOn:function(u,m,I){return typeof I>"u"&&(I=127),[144+Le(u),Ft(m),He(I)]},aftertouch:function(u,m,I){return[160+Le(u),Ft(m),He(I)]}},At={control:function(u,m,I){return[176+Le(u),He(m),He(I)]},program:function(u,m){return[192+Le(u),He(J.programValue(m),m)]},pressure:function(u,m){return[208+Le(u),He(m)]},pitchBend:function(u,m,I){return typeof I>"u"?[224+Le(u),wt(m),zt(m)]:[224+Le(u),He(I),He(m)]},pitchBendF:function(u,m){return At.pitchBend(u,J.to14b((m+1)/2))},bankMSB:function(u,m){return[176+Le(u),0,He(m)]},bankLSB:function(u,m){return[176+Le(u),32,He(m)]},modMSB:function(u,m){return[176+Le(u),1,He(m)]},modLSB:function(u,m){return[176+Le(u),33,He(m)]},breathMSB:function(u,m){return[176+Le(u),2,He(m)]},breathLSB:function(u,m){return[176+Le(u),34,He(m)]},footMSB:function(u,m){return[176+Le(u),4,He(m)]},footLSB:function(u,m){return[176+Le(u),36,He(m)]},portamentoMSB:function(u,m){return[176+Le(u),5,He(m)]},portamentoLSB:function(u,m){return[176+Le(u),37,He(m)]},dataMSB:function(u,m){return[176+Le(u),6,He(m)]},dataLSB:function(u,m){return[176+Le(u),38,He(m)]},volumeMSB:function(u,m){return[176+Le(u),7,He(m)]},volumeLSB:function(u,m){return[176+Le(u),39,He(m)]},balanceMSB:function(u,m){return[176+Le(u),8,He(m)]},balanceLSB:function(u,m){return[176+Le(u),40,He(m)]},panMSB:function(u,m){return[176+Le(u),10,He(m)]},panLSB:function(u,m){return[176+Le(u),42,He(m)]},expressionMSB:function(u,m){return[176+Le(u),11,He(m)]},expressionLSB:function(u,m){return[176+Le(u),43,He(m)]},damper:function(u,m){return typeof m>"u"&&(m=!0),[176+Le(u),64,m?127:0]},portamento:function(u,m){return typeof m>"u"&&(m=!0),[176+Le(u),65,m?127:0]},sostenuto:function(u,m){return typeof m>"u"&&(m=!0),[176+Le(u),66,m?127:0]},soft:function(u,m){return typeof m>"u"&&(m=!0),[176+Le(u),67,m?127:0]},legato:function(u,m){return typeof m>"u"&&(m=!0),[176+Le(u),68,m?127:0]},hold2:function(u,m){return typeof m>"u"&&(m=!0),[176+Le(u),69,m?127:0]},soundVariation:function(u,m){return[176+Le(u),70,Ft(m)]},filterResonance:function(u,m){return[176+Le(u),71,Ft(m)]},releaseTime:function(u,m){return[176+Le(u),72,Ft(m)]},attackTime:function(u,m){return[176+Le(u),73,Ft(m)]},brightness:function(u,m){return[176+Le(u),74,Ft(m)]},decayTime:function(u,m){return[176+Le(u),75,Ft(m)]},vibratoRate:function(u,m){return[176+Le(u),76,Ft(m)]},vibratoDepth:function(u,m){return[176+Le(u),77,Ft(m)]},vibratoDelay:function(u,m){return[176+Le(u),78,Ft(m)]},ptc:function(u,m){return[176+Le(u),84,Ft(m)]},dataIncr:function(u){return[176+Le(u),96,0]},dataDecr:function(u){return[176+Le(u),97,0]},nrpnLSB:function(u,m){return[176+Le(u),98,He(m)]},nrpnMSB:function(u,m){return[176+Le(u),99,He(m)]},rpnLSB:function(u,m){return[176+Le(u),100,He(m)]},rpnMSB:function(u,m){return[176+Le(u),101,He(m)]},allSoundOff:function(u){return[176+Le(u),120,0]},resetAllControllers:function(u){return[176+Le(u),121,0]},localControl:function(u,m){return typeof m>"u"&&(m=!0),[176+Le(u),122,m?127:0]},allNotesOff:function(u){return[176+Le(u),123,0]},omni:function(u,m){return typeof m>"u"&&(m=!0),[176+Le(u),m?125:124,0]},mono:function(u,m){return typeof m>"u"&&(m=1),[176+Le(u),126,He(m)]},poly:function(u){return[176+Le(u),127,0]}};function Lo(u,m,I,U){return typeof m<"u"?[He(u),He(m),He(I),He(U)]:((u!=parseInt(u)||u<0||u>65535)&&gt(u),u=parseInt(u),[u>>12&15,u>>8&15,u>>4&15,u&15])}function Ji(u){return rt(u),u=Math.round(u*65536+16384),u<0?0:u>65535?65535:u}var eo={mtc:function(u){return[241,ti(u)]},songPosition:function(u,m){return typeof m>"u"?[242,wt(u),zt(u)]:[242,He(m),He(u)]},songSelect:function(u){return[243,He(u)]},tune:function(){return[246]},clock:function(){return[248]},start:function(){return[250]},continue:function(){return[251]},stop:function(){return[252]},active:function(){return[254]},reset:function(){return[255]}},kt={sxIdRequest:function(){return[240,126,this._sxid,6,1,247]},sxTuningDumpRequest:function(u,m){return typeof m>"u"?[240,126,this._sxid,8,0,He(u),247]:[240,126,this._sxid,8,3,He(u),He(m),247]},sxFullFrame:function(u){return[240,127,this._sxid,1,1,Lr(u),u.getMinute(),u.getSecond(),u.getFrame(),247]},sxMasterVolume:function(u,m){return typeof m>"u"?[240,127,this._sxid,4,1,wt(u),zt(u),247]:[240,127,this._sxid,4,1,He(m),He(u),247]},sxMasterVolumeF:function(u){return kt.sxMasterVolume.call(this,J.to14b(ir(u)))},sxMasterFineTuning:function(u,m){return typeof m>"u"?[240,127,this._sxid,4,3,wt(u),zt(u),247]:[240,127,this._sxid,4,3,He(m),He(u),247]},sxMasterFineTuningF:function(u){return kt.sxMasterFineTuning.call(this,J.to14b(ir((u%1+1)/2,u)))},sxMasterCoarseTuning:function(u){return[240,127,this._sxid,4,4,0,He(u),247]},sxMasterCoarseTuningF:function(u){return kt.sxMasterCoarseTuning.call(this,64+(u-u%1))},sxNoteTuning:function(u,m,I,U){return m==parseInt(m)?[240,Fn(U),this._sxid,8,7,He(u),He(m)].concat(nn(I),[247]):[240,127,this._sxid,8,2,He(u)].concat(nn(m),[247])},sxNoteTuningF:function(u,m,I,U){return m==parseInt(m)?kt.sxNoteTuning.call(this,u,m,vn(I),U):kt.sxNoteTuning.call(this,u,vn(m))},sxNoteTuningHZ:function(u,m,I,U){return m==parseInt(m)?kt.sxNoteTuning.call(this,u,m,or(I),U):kt.sxNoteTuning.call(this,u,or(m))},sxScaleTuning1:function(u,m,I){return u==parseInt(u)?[240,Fn(I),this._sxid,8,8].concat(er(de(u)),hi(m),[247]):kt.sxScaleTuning1.call(this,65535,u,m)},sxScaleTuning1F:function(u,m,I){if(u!=parseInt(u))return kt.sxScaleTuning1F.call(this,65535,u,m);for(var U=[],z=0;z<m.length;z++){if(m[z]<-.64||m[z]>.63)throw RangeError("Out of range: "+m[z]);U.push(Math.floor(m[z]*100+64))}return kt.sxScaleTuning1.call(this,u,U,I)},sxScaleTuning2:function(u,m,I){return u==parseInt(u)?[240,Fn(I),this._sxid,8,9].concat(er(de(u)),yn(m),[247]):kt.sxScaleTuning2.call(this,65535,u,m)},sxScaleTuning2F:function(u,m,I){if(u!=parseInt(u))return kt.sxScaleTuning2F.call(this,65535,u,m);for(var U=[],z=0;z<m.length;z++){var se=(m[z]+1)/2;if(se<-1||se>1)throw RangeError("Out of range: "+m[z]);U.push(J.to14b((m[z]+1)/2))}return kt.sxScaleTuning2.call(this,u,U,I)},sxGM:function(u){return typeof u>"u"&&(u=1),[240,126,this._sxid,9,u?u==2?3:1:2,247]},sxGS:function(u){for(var m=typeof u>"u"?[64,0,127,0]:u instanceof Array?u:arguments,I=0,U=[240,65,this._sxid,66,18],z=0;z<m.length;z++){var se=He(m[z]);U.push(se),I+=se}return I%=128,U.push(I?128-I:0),U.push(247),U},sxXG:function(u){var m=typeof u>"u"?[0,0,126,0]:u instanceof Array?u:arguments,I=this._sxid==127?0:this._sxid;I>15&&pt("Bad Yamaha device number: "+I);for(var U=[240,67,16+I,76],z=0;z<m.length;z++)U.push(He(m[z]));return U.push(247),U},sxMidiSoft:function(u,m){var I=[240,0,32,36,0,He(u||0)];m=typeof m>"u"?"":""+m;for(var U=0;U<m.length;U++)I.push(He(m.charCodeAt(U)));return I.push(247),I},gsMasterVolume:function(u){return kt.sxGS.call(this,[64,0,4,He(u)])},gsMasterVolumeF:function(u){return kt.gsMasterVolume.call(this,J.to7b(ir(u)))},gsMasterFineTuning:function(u,m,I,U){return u=Lo(u,m,I,U),kt.sxGS.call(this,[64,0,0,u[0],u[1],u[2],u[3]])},gsMasterFineTuningF:function(u){return kt.gsMasterFineTuning.call(this,Ji(u%1))},gsMasterCoarseTuning:function(u){return kt.sxGS.call(this,[64,0,5,He(u)])},gsMasterCoarseTuningF:function(u){return kt.gsMasterCoarseTuning.call(this,64+(u-u%1))},gsOctaveTuning:function(u,m,I){return kt.sxGS.call(this,[64,16+[1,2,3,4,5,6,7,8,9,0,11,12,13,14,15][Le(u)],64+J.octaveValue(m),He(I)])},gsOctaveTuningF:function(u,m,I){if(I<-.64||I>.63)throw RangeError("Out of range: "+I);return kt.gsOctaveTuning.call(this,u,m,Math.floor(I*100+64))},xgMasterVolume:function(u){return kt.sxXG.call(this,[0,0,4,He(u)])},xgMasterVolumeF:function(u){return kt.xgMasterVolume.call(this,J.to7b(ir(u)))},xgMasterFineTuning:function(u,m,I,U){return u=Lo(u,m,I,U),kt.sxXG.call(this,[0,0,0,u[0],u[1],u[2],u[3]])},xgMasterFineTuningF:function(u){return kt.xgMasterFineTuning.call(this,Ji(u%1))},xgMasterCoarseTuning:function(u){return kt.sxXG.call(this,[0,0,6,He(u)])},xgMasterCoarseTuningF:function(u){return kt.xgMasterCoarseTuning.call(this,64+(u-u%1))},xgOctaveTuning:function(u,m,I){return kt.sxXG.call(this,[8,Le(u),65+J.octaveValue(m),He(I)])},xgOctaveTuningF:function(u,m,I){if(I<-.64||I>.63)throw RangeError("Out of range: "+I);return kt.xgOctaveTuning.call(this,u,m,Math.floor(I*100+64))}};kt.sxScaleTuning=kt.sxScaleTuning2,kt.sxScaleTuningF=kt.sxScaleTuning2F,kt.sxMasterTranspose=kt.sxMasterCoarseTuning,kt.sxMasterTransposeF=kt.sxMasterCoarseTuningF,kt.gsMasterTranspose=kt.gsMasterCoarseTuning,kt.gsMasterTransposeF=kt.gsMasterCoarseTuningF,kt.xgMasterTranspose=kt.xgMasterCoarseTuning,kt.xgMasterTransposeF=kt.xgMasterCoarseTuningF;var on={bank:function(u,m,I){return typeof I>"u"?[At.bankMSB(u,zt(m)),At.bankLSB(u,wt(m))]:[At.bankMSB(u,m),At.bankLSB(u,I)]},modF:function(u,m){return on.mod(u,J.to14b(m))},mod:function(u,m,I){return typeof I>"u"?[At.modMSB(u,zt(m)),At.modLSB(u,wt(m))]:[At.modMSB(u,m),At.modLSB(u,I)]},breathF:function(u,m){return on.breath(u,J.to14b(m))},breath:function(u,m,I){return typeof I>"u"?[At.breathMSB(u,zt(m)),At.breathLSB(u,wt(m))]:[At.breathMSB(u,m),At.breathLSB(u,I)]},footF:function(u,m){return on.foot(u,J.to14b(m))},foot:function(u,m,I){return typeof I>"u"?[At.footMSB(u,zt(m)),At.footLSB(u,wt(m))]:[At.footMSB(u,m),At.footLSB(u,I)]},portamentoTimeF:function(u,m){return on.portamentoTime(u,J.to14b(m))},portamentoTime:function(u,m,I){return typeof I>"u"?[At.portamentoMSB(u,zt(m)),At.portamentoLSB(u,wt(m))]:[At.portamentoMSB(u,m),At.portamentoLSB(u,I)]},dataF:function(u,m){return on.data(u,J.to14b(m))},data:function(u,m,I){return typeof I>"u"?[At.dataMSB(u,zt(m)),At.dataLSB(u,wt(m))]:[At.dataMSB(u,m),At.dataLSB(u,I)]},volumeF:function(u,m){return on.volume(u,J.to14b(m))},volume:function(u,m,I){return typeof I>"u"?[At.volumeMSB(u,zt(m)),At.volumeLSB(u,wt(m))]:[At.volumeMSB(u,m),At.volumeLSB(u,I)]},balanceF:function(u,m){return on.balance(u,J.to14b((m+1)/2))},balance:function(u,m,I){return typeof I>"u"?[At.balanceMSB(u,zt(m)),At.balanceLSB(u,wt(m))]:[At.balanceMSB(u,m),At.balanceLSB(u,I)]},panF:function(u,m){return on.pan(u,J.to14b((m+1)/2))},pan:function(u,m,I){return typeof I>"u"?[At.panMSB(u,zt(m)),At.panLSB(u,wt(m))]:[At.panMSB(u,m),At.panLSB(u,I)]},expressionF:function(u,m){return on.expression(u,J.to14b(m))},expression:function(u,m,I){return typeof I>"u"?[At.expressionMSB(u,zt(m)),At.expressionLSB(u,wt(m))]:[At.expressionMSB(u,m),At.expressionLSB(u,I)]},nrpn:function(u,m,I){return typeof I>"u"?[At.nrpnMSB(u,zt(m)),At.nrpnLSB(u,wt(m))]:[At.nrpnMSB(u,m),At.nrpnLSB(u,I)]},rpn:function(u,m,I){return typeof I>"u"?[At.rpnMSB(u,zt(m)),At.rpnLSB(u,wt(m))]:[At.rpnMSB(u,m),At.rpnLSB(u,I)]},rpnPitchBendRange:function(u,m,I){return on.rpn(u,0,0).concat(on.data(u,m,I))},rpnPitchBendRangeF:function(u,m){return on.rpnPitchBendRange(u,He(m-m%1),Math.floor(m%1*100))},rpnFineTuning:function(u,m,I){return on.rpn(u,0,1).concat(on.data(u,m,I))},rpnFineTuningF:function(u,m){return on.rpn(u,0,1).concat(on.dataF(u,(m%1+1)/2))},rpnCoarseTuning:function(u,m){return on.rpn(u,0,2).concat([At.dataMSB(u,m)])},rpnCoarseTuningF:function(u,m){return on.rpn(u,0,2).concat([At.dataMSB(u,64+(m-m%1))])},rpnTuning:function(u,m,I,U){return on.rpnCoarseTuning(u,m).concat(on.rpnFineTuning(u,I,U))},rpnTuningF:function(u,m){return on.rpnCoarseTuningF(u,m).concat(on.rpnFineTuningF(u,m))},rpnTuningA:function(u,m){return on.rpnTuningF(u,J.shift(m))},rpnSelectTuningProgram:function(u,m){return on.rpn(u,0,3).concat([At.dataMSB(u,m)])},rpnSelectTuningBank:function(u,m){return on.rpn(u,0,4).concat([At.dataMSB(u,m)])},rpnSelectTuning:function(u,m,I){return typeof I>"u"?on.rpnSelectTuningProgram(u,m):on.rpnSelectTuningBank(u,m).concat(on.rpnSelectTuningProgram(u,I))},rpnModulationDepthRange:function(u,m,I){return on.rpn(u,0,5).concat(on.data(u,m,I))},rpnModulationDepthRangeF:function(u,m){return on.rpnModulationDepthRange(u,He(m-m%1),Math.floor(m%1*128))},rpnNull:function(u){return on.rpn(u,127,127)},mode1:function(u){return[At.omni(u,!0),At.poly(u)]},mode2:function(u){return[At.omni(u,!0),At.mono(u)]},mode3:function(u){return[At.omni(u,!1),At.poly(u)]},mode4:function(u){return[At.omni(u,!1),At.mono(u)]}};on.rpnTranspose=on.rpnCoarseTuningF;var M={sxMasterTuning:function(u,m,I){return[kt.sxMasterCoarseTuning.call(this,u),kt.sxMasterFineTuning.call(this,m,I)]},sxMasterTuningF:function(u){return[kt.sxMasterCoarseTuningF.call(this,u),kt.sxMasterFineTuningF.call(this,u)]},gsMasterTuningF:function(u){return[kt.gsMasterCoarseTuningF.call(this,u),kt.gsMasterFineTuningF.call(this,u)]},xgMasterTuningF:function(u){return[kt.xgMasterCoarseTuningF.call(this,u),kt.xgMasterFineTuningF.call(this,u)]},sxMasterTuningA:function(u){return M.sxMasterTuningF.call(this,J.shift(u))},gsMasterTuningA:function(u){return M.gsMasterTuningF.call(this,J.shift(u))},xgMasterTuningA:function(u){return M.xgMasterTuningF.call(this,J.shift(u))},gsScaleTuning:function(u,m){var I=[];if(m.length!=12)throw RangeError("Wrong input size: "+m.length);for(var U=0;U<12;U++)I.push(kt.gsOctaveTuning.call(this,u,U,m[U]));return I},gsScaleTuningF:function(u,m){var I=[];if(m.length!=12)throw RangeError("Wrong input size: "+m.length);for(var U=0;U<12;U++)I.push(kt.gsOctaveTuningF.call(this,u,U,m[U]));return I},xgScaleTuning:function(u,m){var I=[];if(m.length!=12)throw RangeError("Wrong input size: "+m.length);for(var U=0;U<12;U++)I.push(kt.xgOctaveTuning.call(this,u,U,m[U]));return I},xgScaleTuningF:function(u,m){var I=[];if(m.length!=12)throw RangeError("Wrong input size: "+m.length);for(var U=0;U<12;U++)I.push(kt.xgOctaveTuningF.call(this,u,U,m[U]));return I}};function G(u,m){var I=new J;return I.ff=bn(u),I.dd=typeof m>"u"?"":Jn(m),I}var Q={smf:function(u){if(u instanceof J)return new J(u);var m=u instanceof Array?u:arguments,I=bn(m[0]),U="";return m.length==2?U=Cr(m[1]):m.length>2&&(U=Cr(Array.prototype.slice.call(m,1))),G(I,U)},smfSeqNumber:function(u){if(u==parseInt(u)){if(u<0||u>65535)throw RangeError("Sequence number out of range: "+u);u=String.fromCharCode(u>>8)+String.fromCharCode(u&255)}else if(u=""+u,u.length==0)u="\0\0";else if(u.length==1)u="\0"+u;else if(u.length>2)throw RangeError("Sequence number out of range"+bo(u));return G(0,u)},smfText:function(u){return G(1,Qe.lib.toUTF8(u))},smfCopyright:function(u){return G(2,Qe.lib.toUTF8(u))},smfSeqName:function(u){return G(3,Qe.lib.toUTF8(u))},smfInstrName:function(u){return G(4,Qe.lib.toUTF8(u))},smfLyric:function(u){return G(5,Qe.lib.toUTF8(u))},smfMarker:function(u){return G(6,Qe.lib.toUTF8(u))},smfCuePoint:function(u){return G(7,Qe.lib.toUTF8(u))},smfProgName:function(u){return G(8,Qe.lib.toUTF8(u))},smfDevName:function(u){return G(9,Qe.lib.toUTF8(u))},smfChannelPrefix:function(u){if(u==parseInt(u))St(u),u=String.fromCharCode(u);else if(u=""+u,u.length==0)u="\0";else if(u.length>1||u.charCodeAt(0)>15)throw RangeError("Channel number out of range"+bo(u));return G(32,u)},smfMidiPort:function(u){if(u==parseInt(u)){if(u<0||u>127)throw RangeError("Port number out of range: "+u);u=String.fromCharCode(u)}else if(u=""+u,u.length==0)u="\0";else if(u.length>1||u.charCodeAt(0)>127)throw RangeError("Port number out of range"+bo(u));return G(33,u)},smfEndOfTrack:function(u){if(Cr(u)!="")throw RangeError("Unexpected data"+bo(Cr(u)));return G(47)},smfTempo:function(u){if((""+u).length==3)return G(81,u);if(u==parseInt(u)&&u>0&&u<=16777215)return G(81,String.fromCharCode(u>>16)+String.fromCharCode(u>>8&255)+String.fromCharCode(u&255));throw RangeError("Out of range"+bo(Cr(u)))},smfBPM:function(u){return Q.smfTempo(Math.round(6e7/u))},smfSMPTE:function(u){if(u instanceof Wt)return G(84,String.fromCharCode(u.hour)+String.fromCharCode(u.minute)+String.fromCharCode(u.second)+String.fromCharCode(u.frame)+String.fromCharCode(u.quarter%4*25));var m=""+u;if(m.length==5)return G(84,u);var I=u instanceof Array?u:Array.prototype.slice.call(arguments);return I.splice(0,0,30),Q.smfSMPTE(new Wt(I))},smfTimeSignature:function(u,m,I,U){var z,se,fe,Xe,qe=(""+u).match(/^\s*(\d+)\s*\/\s*(\d+)\s*$/);if(qe){if(z=parseInt(qe[1]),se=parseInt(qe[2]),z>0&&z<256&&se>0&&!(se&se-1)){for(fe=se,se=0,fe>>=1;fe;fe>>=1)se++;return fe=m==parseInt(m)?m:24,Xe=I==parseInt(I)?I:8,G(88,String.fromCharCode(z)+String.fromCharCode(se)+String.fromCharCode(fe)+String.fromCharCode(Xe))}else if((""+u).length==4)return G(88,u)}else if(u==parseInt(u)&&m==parseInt(m)){if(u>0&&u<256&&m>0&&!(m&m-1)){for(z=u,se=0,fe=m,fe>>=1;fe;fe>>=1)se++;return fe=I==parseInt(I)?I:24,Xe=U==parseInt(U)?U:8,G(88,String.fromCharCode(z)+String.fromCharCode(se)+String.fromCharCode(fe)+String.fromCharCode(Xe))}else if((""+u).length==4)return G(88,u);u=u+"/"+m}else if((""+u).length==4)return G(88,u);throw RangeError("Wrong time signature"+bo(Cr(""+u)))},smfKeySignature:function(u){u=""+u;var m=u.match(/^\s*([A-H][b#]?)\s*(|maj|major|dur|m|min|minor|moll)\s*$/i);if(m){var I={CB:0,GB:1,DB:2,AB:3,EB:4,BB:5,F:6,C:7,G:8,D:9,A:10,E:11,B:12,H:12,"F#":13,"C#":14,"G#":15,"D#":16,"A#":17}[m[1].toUpperCase()],U={"":0,MAJ:0,MAJOR:0,DUR:0,M:1,MIN:1,MINOR:1,MOLL:1}[m[2].toUpperCase()];typeof I<"u"&&typeof U<"u"&&(U&&(I-=3),I-=7,I>=-7&&I<0?u=String.fromCharCode(256+I)+String.fromCharCode(U):I>=0&&I<=7&&(u=String.fromCharCode(I)+String.fromCharCode(U)))}if(u.length==2&&u.charCodeAt(1)<=1&&(u.charCodeAt(0)<=7||u.charCodeAt(0)<=255&&u.charCodeAt(0)>=249))return G(89,u);throw RangeError("Incorrect key signature"+bo(u))},smfSequencer:function(u){return G(127,Cr(u))}},ie={};function Oe(u,m){J[u]=function(){return new J(m.apply(this,arguments))},ie[u]=function(){return this.send(m.apply(this,arguments))}}function Te(u,m){J[u]=function(){return m.apply(this,arguments)},ie[u]=function(){return this.send(m.apply(this,arguments))}}function ze(u,m){J[u]=function(){var I,U=[],z=m.apply(this,arguments);for(I=0;I<z.length;I++)U.push(new J(z[I]));return U},ie[u]=function(){for(var I=m.apply(this,arguments),U=this,z=0;z<I.length;z++)U=U.send(I[z]);return U}}function dt(u,m){J[u]=function(){return new J(m.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))},ie[u]=function(){if(typeof this._master<"u"){var I=new J(m.apply(this,[this._master].concat(Array.prototype.slice.call(arguments))));return I._mpe=I[1],this.send(I)}return this.send(m.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))}}function mt(u,m){J[u]=function(){return new J(m.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))},ie[u]=function(){if(typeof this._master<"u"){var I,U=Array.prototype.slice.call(arguments);U.length<m.length?U=[this._master].concat(U):(I=Ft(U[0]),U[0]=this._master);var z=new J(m.apply(this,U));return z._mpe=I,this.send(z)}return this.send(m.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))))}}function Kt(u,m){J[u]=function(){var I,U=[],z=m.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments)));for(I=0;I<z.length;I++)U.push(new J(z[I]));return U},ie[u]=function(){var I,U,z;if(typeof this._master<"u"){var se,fe=Array.prototype.slice.call(arguments);for(fe.length<m.length?fe=[this._master].concat(fe):(se=Ft(fe[0]),fe[0]=this._master),U=m.apply(this,fe),z=this,I=0;I<U.length;I++){var Xe=J(U[I]);Xe._mpe=se,z=z.send(Xe)}return z}for(U=m.apply(this,typeof this._ch>"u"?arguments:[this._ch].concat(Array.prototype.slice.call(arguments))),z=this,I=0;I<U.length;I++)z=z.send(U[I]);return z}}V(eo,function(u){Oe(u,eo[u])}),V(kt,function(u){Oe(u,kt[u])}),V(Q,function(u){Te(u,Q[u])}),V(M,function(u){ze(u,M[u])}),V(Wr,function(u){dt(u,Wr[u])}),V(At,function(u){mt(u,At[u])}),V(on,function(u){Kt(u,on[u])});function an(u){V(ie,function(m){u.prototype[m]=ie[m]})}an(_e);var Un={a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};for(c=0;c<16;c++)Un[c]=c;J.prototype.getChannel=function(){if(this.ff==32&&this.dd.length==1&&this.dd.charCodeAt(0)<16)return this.dd.charCodeAt(0);var u=this[0];if(!(typeof u>"u"||u<128||u>239))return u&15},J.prototype.setChannel=function(u){if(u=Un[u],typeof u>"u")return this;if(this.ff==32)this.dd=String.fromCharCode(u);else{var m=this[0];typeof m<"u"&&m>=128&&m<=239&&(this[0]=m&240|u)}return this},J.prototype.getNote=function(){var u=this[0];if(!(typeof u>"u"||u<128||u>175))return this[1]},J.prototype.setNote=function(u){var m=this[0];return typeof m>"u"||m<128||m>175?this:(u=J.noteValue(u),typeof u<"u"&&(this[1]=u),this)},J.prototype.getVelocity=function(){var u=this[0];if(!(typeof u>"u"||u<128||u>159))return this[2]},J.prototype.setVelocity=function(u){var m=this[0];return typeof m>"u"||m<128||m>159?this:(u=parseInt(u),u>=0&&u<128&&(this[2]=u),this)},J.prototype.getSysExId=function(){if(this[0]==240)return this[2]},J.prototype.setSysExId=function(u){return this[0]==240&&this.length>2&&(u=parseInt(u),u>=0&&u<128&&(this[2]=u)),this},J.prototype.getData=function(){if(typeof this.dd<"u")return this.dd.toString()},J.prototype.setData=function(u){return this.dd=Cr(u),this};function wi(u,m){return u==127&&typeof m<"u"&&m.charCodeAt(0)==67&&m.charCodeAt(1)==123}function Si(u,m){return wi(u,m)&&m.charCodeAt(2)==1}function ni(u,m){if(u>=0&&u<=127&&m>=0&&m<=127){var I=u&15,U=u>>4;if(I>0&&I<8&&U<7)I=["C","D","E","F","G","A","B"][I-1]+["bbb","bb","b","","#","##","###"][U];else return"-";return m>34?I+"?":I+["","6","Maj7","Maj7(#11)","(9)","Maj7(9)","6(9)","aug","m","m6","m7","m7b5","m(9)","m7(9)","m7(11)","m+7","m+7(9)","dim","dim7","7","7sus4","7b5","7(9)","7(#11)","7(13)","7(b9)","7(b13)","7(#9)","Maj7aug","7aug","1+8","1+5","sus4","1+2+5","cc"][m]}return"-"}J.prototype.getText=function(){if(typeof this.dd<"u")return Si(this.ff,this.dd)?ni(this.dd.charCodeAt(3),this.dd.charCodeAt(4)):Qe.lib.fromUTF8(this.dd);if(this.isMidiSoft()){for(var u=[],m=6;m<this.length-1;m++)u.push(String.fromCharCode(this[m]));return u.join("")}},J.prototype.setText=function(u){return this.dd=Qe.lib.toUTF8(u),this},J.prototype.getTempo=function(){if(this.ff==81&&typeof this.dd<"u")return this.dd.charCodeAt(0)*65536+this.dd.charCodeAt(1)*256+this.dd.charCodeAt(2)},J.prototype.getBPM=function(){var u=this.getTempo();if(u)return 6e7/u},J.prototype.getTimeSignature=function(){if(this.ff==88&&typeof this.dd<"u")return[this.dd.charCodeAt(0),1<<this.dd.charCodeAt(1)]},J.prototype.getTimeSignature4=function(){if(this.ff==88&&typeof this.dd<"u"){var u=[this.dd.charCodeAt(0),1<<this.dd.charCodeAt(1)];return this.dd.length==4&&u.push(this.dd.charCodeAt(2),this.dd.charCodeAt(3)),u}},J.prototype.getKeySignature=function(){if(this.ff==89&&typeof this.dd<"u"){var u=this.dd.charCodeAt(0),m=this.dd.charCodeAt(1);if(u&128&&(u=u-256),u>=-7&&u<=7&&m>=0&&m<=1)return[u,["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#","G#","D#","A#"][m?u+10:u+7],!!m]}},J.prototype.isNoteOn=function(){var u=this[0];return typeof u>"u"||u<144||u>159?!1:this[2]>0},J.prototype.isNoteOff=function(){var u=this[0];return typeof u>"u"||u<128||u>159?!1:u<144?!0:this[2]==0},J.prototype.isSysEx=function(){return this[0]==240},J.prototype.isFullSysEx=function(){return this[0]==240&&this[this.length-1]==247},J.prototype.isMidiSoft=function(){return this.isFullSysEx()&&this[1]==0&&this[2]==32&&this[3]==36&&this[4]==0},J.prototype.isSMF=function(){return this.ff>=0&&this.ff<=127},J.prototype.isEOT=function(){return this.ff==47},J.prototype.isText=function(){return this.ff==1},J.prototype.isCopyright=function(){return this.ff==2},J.prototype.isSeqName=function(){return this.ff==3},J.prototype.isInstrName=function(){return this.ff==4},J.prototype.isLyric=function(){return this.ff==5},J.prototype.isMarker=function(){return this.ff==6},J.prototype.isCuePoint=function(){return this.ff==7},J.prototype.isProgName=function(){return this.ff==8},J.prototype.isDevName=function(){return this.ff==9},J.prototype.isTempo=function(){return this.ff==81},J.prototype.isTimeSignature=function(){return this.ff==88},J.prototype.isKeySignature=function(){return this.ff==89},J.prototype.isGmReset=function(){return this.match([240,126,[0,0],9,[0,0],247])},J.prototype.isGsReset=function(){return this.match([240,65,[0,0],66,18,64,0,127,0,65,247])},J.prototype.isXgReset=function(){return this.match([240,67,[16,240],76,0,0,126,0,247])},J.prototype.match=function(u){var m,I;for(m=0;m<u.length;m++)if(I=u[m][1],typeof I>"u"){if(this[m]!=u[m])return!1}else if((this[m]&I)!=(u[m][0]&I))return!1;return!0};function Ai(u){for(var m=[],I=0;I<u.length;I++)m[I]=u.charCodeAt(I);return m}function ki(u){for(var m="",I=0;I<u.length;I++)m+=String.fromCharCode(u[I]);return m}function Cr(u){return u instanceof Array?ki(u):typeof u>"u"?"":""+u}function ri(u){for(var m=0,I=0;I<u.length;I++)m=(m<<8)+u.charCodeAt(I);return m}function tr(u){return(u<16?"0":"")+u.toString(16)}function zr(u){for(var m=[],I=0;I<u.length;I++)m.push(tr(u[I]));return m.join(" ")}function Co(u){for(var m=[],I=0;I<u.length;I++)I&&I%4==0&&m.push(" "),m.push(tr(u[I]));return m.join("")}function xo(u){for(var m="",I=0;I<u.length;I++)u[I]==`
`?m+="\\n":u[I]=="\r"?m+="\\r":u[I]=="	"?m+="\\t":u.charCodeAt(I)<32?m+="\\x"+tr(u.charCodeAt(I)):m+=u[I];return m}function fa(u){return u.length?": "+zr(Ai(u)):""}function bo(u){return u.length?": "+xo(Qe.lib.fromUTF8(u)):""}J.prototype.label=function(u){return this.lbl=this.lbl?this.lbl+", "+u:u,this},J.prototype.toString=function(){return this.lbl?this._str()+" ("+this.lbl+")":this._str()},J.prototype._str=function(){var u,m;if(this.length)u=zr(this);else{if(typeof this.ff>"u")return"empty";u="ff"+tr(this.ff)}return m=this._string(),m?u+" -- "+m:u},J.prototype._string=function(){var u="",m;if(!this.length){if(this.ff==0)u+="Sequence Number: "+ri(this.dd);else if(this.ff>0&&this.ff<10)u+=["","Text","Copyright","Sequence Name","Instrument Name","Lyric","Marker","Cue Point","Program Name","Device Name"][this.ff]+bo(this.dd);else if(this.ff==32)u+="Channel Prefix"+fa(this.dd);else if(this.ff==33)u+="MIDI Port"+fa(this.dd);else if(this.ff==47)u+="End of Track"+fa(this.dd);else if(this.ff==81){var I=Math.round(this.getBPM()*100)/100;u+="Tempo: "+I+" bpm"}else if(this.ff==84)u+="SMPTE Offset: "+we(Ai(this.dd));else if(this.ff==88){var U=1<<this.dd.charCodeAt(1);u+="Time Signature: "+this.dd.charCodeAt(0)+"/"+U,u+=" "+this.dd.charCodeAt(2)+" "+this.dd.charCodeAt(3)}else if(this.ff==89){u+="Key Signature: ";var z=this.getKeySignature();z?(u+=z[1],z[2]&&(u+=" min")):u+="invalid"}else if(this.ff==127){if(this.dd.charCodeAt(0)==67&&this.dd.charCodeAt(1)==123)return u+="[XF:"+tr(this.dd.charCodeAt(2))+"]",m={0:"Version",1:"Chord",2:"Rehearsal Mark",3:"Phrase Mark",4:"Max Phrase Mark",5:"Fingering Number",12:"Guide Track Flag",16:"Guitar Info",18:"Chord Voicing",127:"XG Song Data Number"}[this.dd.charCodeAt(2)],u+=m?" "+m:"",u+=": ",this.dd.charCodeAt(2)==0?u+this.dd.substring(3,7)+" "+zr(Ai(this.dd.substring(7))):this.dd.charCodeAt(2)==1?u+this.getText():u+zr(Ai(this.dd.substring(3)));u+="Sequencer Specific"+fa(this.dd)}else u+="SMF"+fa(this.dd);return u}if(m={241:"MIDI Time Code",242:"Song Position",243:"Song Select",244:"Undefined",245:"Undefined",246:"Tune request",248:"Timing clock",249:"Undefined",250:"Start",251:"Continue",252:"Stop",253:"Undefined",254:"Active Sensing",255:"Reset"}[this[0]],m)return m;if(this.isMidiSoft())return m=xo(this.getText()),m&&(m=" "+m),"[K:"+tr(this[5])+"]"+m;var se=this[0]>>4;return m={8:"Note Off",10:"Aftertouch",12:"Program Change",13:"Channel Aftertouch",14:"Pitch Wheel"}[se],m||(se==9?this[2]?"Note On":"Note Off":se!=11?u:(m={0:"Bank Select MSB",1:"Modulation Wheel MSB",2:"Breath Controller MSB",4:"Foot Controller MSB",5:"Portamento Time MSB",6:"Data Entry MSB",7:"Channel Volume MSB",8:"Balance MSB",10:"Pan MSB",11:"Expression Controller MSB",12:"Effect Control 1 MSB",13:"Effect Control 2 MSB",16:"General Purpose Controller 1 MSB",17:"General Purpose Controller 2 MSB",18:"General Purpose Controller 3 MSB",19:"General Purpose Controller 4 MSB",31:"Karaoke",32:"Bank Select LSB",33:"Modulation Wheel LSB",34:"Breath Controller LSB",36:"Foot Controller LSB",37:"Portamento Time LSB",38:"Data Entry LSB",39:"Channel Volume LSB",40:"Balance LSB",42:"Pan LSB",43:"Expression Controller LSB",44:"Effect control 1 LSB",45:"Effect control 2 LSB",48:"General Purpose Controller 1 LSB",49:"General Purpose Controller 2 LSB",50:"General Purpose Controller 3 LSB",51:"General Purpose Controller 4 LSB",64:"Damper Pedal",65:"Portamento",66:"Sostenuto",67:"Soft Pedal",68:"Legato",69:"Hold 2",70:"Sound Variation",71:"Filter Resonance",72:"Release Time",73:"Attack Time",74:"Brightness",75:"Decay Time",76:"Vibrato Rate",77:"Vibrato Depth",78:"Vibrato Delay",79:"Sound Controller 10",80:"General Purpose Controller 5",81:"General Purpose Controller 6",82:"General Purpose Controller 7",83:"General Purpose Controller 8",84:"Portamento Control",88:"High Resolution Velocity Prefix",91:"Effects 1 Depth",92:"Effects 2 Depth",93:"Effects 3 Depth",94:"Effects 4 Depth",95:"Effects 5 Depth",96:"Data Increment",97:"Data Decrement",98:"Non-Registered Parameter Number LSB",99:"Non-Registered Parameter Number MSB",100:"Registered Parameter Number LSB",101:"Registered Parameter Number MSB",120:"All Sound Off",121:"Reset All Controllers",122:"Local Control On/Off",123:"All Notes Off",124:"Omni Mode Off",125:"Omni Mode On",126:"Mono Mode On",127:"Poly Mode On"}[this[1]],this[1]>=64&&this[1]<=69&&(m+=this[2]<64?" Off":" On"),m||(m="Undefined"),m))},J.prototype._stamp=function(u){return this._from.push(u._orig?u._orig:u),this},J.prototype._unstamp=function(u){if(typeof u>"u")this._from=[];else{u._orig&&(u=u._orig);var m=this._from.indexOf(u);m>-1&&this._from.splice(m,1)}return this},J.prototype._stamped=function(u){u._orig&&(u=u._orig);for(var m=0;m<this._from.length;m++)if(this._from[m]==u)return!0;return!1},Qe.MIDI=J,F.prototype.MIDI=J;function ha(u){typeof u>"u"?this._cc={}:this._cc[u]={}}function Yu(u,m){var I=typeof u>"u"?"??":tr(u),U=typeof m>"u"?"??":tr(m),z={"0000":"Pitch Bend Sensitivity","0001":"Channel Fine Tuning","0002":"Channel Coarse Tuning","0003":"Select Tuning Program","0004":"Select Tuning Bank","0005":"Vibrato Depth Range","7f7f":"NONE"}[I+""+U];return"RPN "+I+" "+U+(z?": "+z:"")}function to(u,m){var I=typeof u>"u"?"??":tr(u),U=typeof m>"u"?"??":tr(m);return"NRPN "+I+" "+U}function rs(u){var m,I="";for(m=0;m<u.length&&u[m];m++)I+=String.fromCharCode(u[m]);return Qe.lib.fromUTF8(I)}function pa(u){var m,I,U,z,se,fe,Xe,qe="x",yt="x";if(u.isMidi2?(U=u[0]>>4,qe=(u[0]&15).toString(16),I=qe,this._cc[I]||(this._cc[I]={}),U==2?m=new J(u.slice(1)):U==3?(z=u[1]>>4,se=u[1]&15,fe=u.slice(2,2+se),z==0&&(m=new J([240].concat(fe,[247])),this._cc[I].sx=void 0),z==1&&(this._cc[I].sx=fe),z==2&&this._cc[I].sx&&(this._cc[I].sx=this._cc[I].sx.concat(fe)),z==3&&this._cc[I].sx&&(fe=this._cc[I].sx.concat(fe),m=new J([240].concat(fe,[247])),this._cc[I].sx=void 0)):U==4?(z=u[1]>>4,yt=(u[1]&15).toString(16),I=qe+yt,this._cc[I]||(this._cc[I]={}),z==12&&(u[3]&1&&(this._cc[I].bm=u[6],this._cc[I].bl=u[7]),u._bm=this._cc[I].bm,u._bl=this._cc[I].bl,Qe.MIDI.programName&&u.label(Qe.MIDI.programName(u[4],u._bm,u._bl)))):U==13&&(z=u[1]>>6,u[1]&48||(yt=(u[1]&15).toString(16)),I=qe+yt,this._cc[I]||(this._cc[I]={}),fe=u.slice(4),z==0&&(u.label(rs(fe)),this._cc[I].tx=void 0),z==1&&(this._cc[I].tx=fe),z==2&&this._cc[I].tx&&(this._cc[I].tx=this._cc[I].tx.concat(fe)),z==3&&this._cc[I].tx&&(fe=this._cc[I].tx.concat(fe),u.label(rs(fe)),this._cc[I].tx=void 0))):m=u,!m||!m.length||m[0]<128)return u;if(m[0]==255)return this._clear(),u;if(z=m[0]>>4,yt=(m[0]&15).toString(16),I=z==15?qe:qe+yt,this._cc[I]||(this._cc[I]={}),z==12)m._bm=this._cc[I].bm,m._bl=this._cc[I].bl,Qe.MIDI.programName&&u.label(Qe.MIDI.programName(m[1],m._bm,m._bl));else if(z==11)switch(m[1]){case 0:this._cc[I].bm=m[2];break;case 32:this._cc[I].bl=m[2];break;case 98:this._cc[I].nl=m[2],this._cc[I].rn="n";break;case 99:this._cc[I].nm=m[2],this._cc[I].rn="n";break;case 100:this._cc[I].rl=m[2],this._cc[I].rn="r";break;case 101:this._cc[I].rm=m[2],this._cc[I].rn="r";break;case 6:case 38:case 96:case 97:this._cc[I].rn=="r"&&(m._rm=this._cc[I].rm,m._rl=this._cc[I].rl,u.label(Yu(this._cc[I].rm,this._cc[I].rl))),this._cc[I].rn=="n"&&(m._nm=this._cc[I].rm,m._nl=this._cc[I].nl,u.label(to(this._cc[I].nm,this._cc[I].nl)));break}else m.isFullSysEx()&&(m[1]==127?m[3]==4?(Xe={1:"Master Volume",2:"Master Balance",3:"Master Fine Tuning",4:"Master Coarse Tuning"}[m[4]],Xe&&u.label(Xe)):m[3]==8&&(Xe={2:"Note Tuning",7:"Note Tuning, Bank",8:"Scale Tuning, 1 byte format",9:"Scale Tuning, 2 byte format"}[m[4]],Xe&&u.label(Xe)):m[1]==126?m[3]==6?m[4]==1?u.label("Device ID Request"):m[4]==2&&u.label("Device ID Response"):m[3]==8?(Xe={0:"Bulk Tuning Dump Request",1:"Bulk Tuning Dump",3:"Bulk Tuning Dump Request, Bank",4:"Bulk Tuning Dump, Bank",5:"Scale Tuning Dump, 1 byte format",6:"Scale Tuning Dump, 2 byte format",7:"Note Tuning, Bank",8:"Scale Tuning, 1 byte format",9:"Scale Tuning, 2 byte format"}[m[4]],Xe&&u.label(Xe)):m[3]==9&&(m[4]==1?(u.label("GM1 System On"),this._clear(qe),this._cc[qe].gm="1"):m[4]==2?(u.label("GM System Off"),this._clear(qe),this._cc[qe].gm="0"):m[4]==3&&(u.label("GM2 System On"),this._clear(qe),this._cc[qe].gm="2")):m[1]==67?(m[2]&240)==16&&m[3]==76&&(m[4]==0&&m[5]==0&&m[6]==126&&m[7]==0?(u.label("XG System On"),this._clear(qe),this._cc[qe].gm="Y"):m[4]==0&&m[5]==0&&m[6]==0?u.label("XG Master Tuning"):m[4]==0&&m[5]==0&&m[6]==4?u.label("XG Master Volume"):m[4]==0&&m[5]==0&&m[6]==6?u.label("XG Master Transpose"):m[4]==8&&m[5]<16&&m[6]>=65&&m[6]<=76?u.label("XG Scale Tuning"):u.label("XG Parameter")):m[1]==65&&m[3]==66&&m[4]==18&&(m[5]==64&&(m[6]==0?m[7]==127&&m[8]==0&&m[9]==65?(u.label("GS Reset"),this._clear(qe),this._cc[qe].gm="R"):m[7]==0?u.label("GS Master Tuning"):m[7]==4?u.label("GS Master Volume"):m[7]==5?u.label("GS Master Transpose"):u.label("GS Parameter"):(m[6]&240)==16&&m[7]==21?u.label("GS Drum Part Change"):(m[6]&240)==16&&m[7]>=64&&m[7]<=75?u.label("GS Scale Tuning"):u.label("GS Parameter")),m[5]==65&&u.label("GS Parameter")));return u}function jn(){var u=new _e;return u._clear=ha,u._read=pa,u._receive=function(m){this._emit(this._read(m))},u.gm=function(m){return typeof m>"u"&&(m="x"),this._cc[m]&&this._cc[m].gm||0},u._clear(),u._resume(),u}Qe.Context=jn,F.prototype.Context=jn;function xr(){var u=this instanceof xr?this:u=new xr;return u.reset(),arguments.length&&xr.prototype.setup.apply(u,arguments),u}xr.validate=function(u){var m=u instanceof Array?u:arguments;if(m[0]!=parseInt(m[0])||m[0]<0||m[0]>14)throw RangeError("Bad master channel value: "+m[0]);if(m[1]!=parseInt(m[1])||m[1]<0||m[0]+m[1]>15)throw RangeError("Bad zone size value: "+m[1])},xr.prototype.reset=function(){for(var u=0;u<16;u++)this[u]={band:0,master:u}},xr.prototype.setup=function(u,m){xr.validate(u,m);var I,U=u+m;if(!(this[u].master==u&&this[u].band==m)&&!(!m&&!this[u].band)){for(this[u].band?(I=u+this[u].band,U<I&&(U=I)):this[u].master==u-1?(I=u-1,I=I+this[I].band,U<I&&(U=I),this[u-1]={band:0,master:u-1}):this[u].master!=u&&(I=this[u].master,I=I+this[I].band,U<I&&(U=I),this[this[u].master].band=u-this[u].master-1),this[u].master=u,this[u].band=m,I=u+1;I<=u+m;I++)this[I].band&&U<I+this[I].band&&(U=I+this[I].band),this[I]={band:0,master:u};for(;I<=U;I++)this[I]={band:0,master:I}}},xr.prototype.filter=function(u){var m=u.getChannel();if(!this[m]||!this[this[m].master].band)return u;var I=this[m].master,U=this[I].band,z,se,fe;if(typeof u._mpe<"u"){for(fe=256,z=I+1;z<=I+U;z++)if(!this[z].notes)fe>0&&(m=z,fe=0);else for(fe>this[z].notes.length&&(m=z,fe=this[z].notes.length),se=0;se<this[z].notes.length;se++)if(this[z].notes[se]==u._mpe){m=z,fe=-1;break}u.setChannel(m),u._mpe=void 0}return m==I||(u.isNoteOn()?(this[m].notes||(this[m].notes=[]),j(this[m].notes,u.getNote())):u.isNoteOff()&&this[m].notes&&Z(this[m].notes,u.getNote())),u},Qe.MPE=xr;function Ct(u){var m=this instanceof Ct?this:m=new Ct,I;if(u instanceof Ct)return m._from=u._from.slice(),V(u,function(z){z!="_from"&&(m[z]=u[z])}),m;m._from=[],typeof u>"u"&&(u=[0,0,0,0]);var U=u instanceof Array?u:arguments;for(m.length=0,I=0;I<U.length;I++)l=U[I],(l!=parseInt(l)||l<0||l>255)&&pt(U[I]),m.push(l);if(m.length!=[4,4,4,8,8,16,4,4,8,8,8,12,12,16,16,16][m[0]>>4])throw RangeError("Wrong UMP size");return m}Ct.prototype=[],Ct.prototype.constructor=Ct,Ct.prototype.isMidi=function(){return 2},Ct.prototype.isMidi2=!0,Ct.prototype.dump=function(){var u,m="";for(u=0;u<this.length;u++)m+=String.fromCharCode(this[u]);return m};function pi(){}pi.prototype=Ct,Ct._sxid=127,Ct.sxId=function(u){if(typeof u>"u"&&(u=Ct._sxid),u==this._sxid)return this;u=He(u);var m=new pi;return m._ch=this._ch,m._gr=this._gr,m._sxid=u,m},Ct.ch=function(u){if(u==this._ch||typeof u>"u"&&typeof this._ch>"u")return this;var m=new pi;return typeof u<"u"&&(u=Le(u)),m._ch=u,m._gr=this._gr,m._sxid=this._sxid,m},Ct.gr=function(u){if(u==this._gr||typeof u>"u"&&typeof this._gr>"u")return this;var m=new pi;return typeof u<"u"&&(u=ut(u)),m._ch=this._ch,m._gr=u,m._sxid=this._sxid,m},Ct.prototype.getGroup=function(){if(this[0]){var u=this[0]>>4;if(u==1||u==2||u==3||u==4||u==5||u==13)return this[0]&15}};var sr=[0,0,0,0,0,0,0,0,0,0,0,0,0];function gi(u,m,I,U){return typeof m<"u"?[bn(u),bn(m),bn(I),bn(U)]:(u=In(u),[u>>24&255,u>>16&255,u>>8&255,u&255])}function no(u){return u=Math.floor(u*4294967296),u>4294967295?4294967295:u<0?0:u}var ga={noop:function(){return[0,0,0,0]},umpClock:function(u){return u=de(u),[0,16,u>>8,u&255]},umpTimestamp:function(u){return u=de(u),[0,32,u>>8,u&255]},umpTicksPQN:function(u){return u=de(u),[0,48,u>>8,u&255]},umpDelta:function(u){return u=u||0,u=Ze(u),[0,64+(u>>16),u>>8&255,u&255]},umpStartClip:function(){return[240,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},umpEndClip:function(){return[240,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Uo={umpTempo:function(u,m){return[208+ut(u),16,0,0].concat(gi(m),[0,0,0,0,0,0,0,0])},umpBPM:function(u,m){return Uo.umpTempo(u,Math.round(6e9/m))},umpTimeSignature:function(u,m,I){var U,z,se,fe=(""+m).match(/^\s*(\d+)\s*\/\s*(\d+)\s*$/);if(fe?(U=parseInt(fe[1]),z=parseInt(fe[2])):m==parseInt(m)&&I==parseInt(I)&&(U=parseInt(m),z=parseInt(I)),U>0&&U<256&&z>0&&!(z&z-1)){for(se=0,z>>=1;z;z>>=1)se++;if(z=Math.round(U*32/(1<<se)),z<256)return[208+ut(u),16,0,1,U,se,z,0,0,0,0,0,0,0,0,0]}throw RangeError("Wrong time signature "+m+(typeof I>"u"?"":"/"+I))}},Us={umpMetadata:function(u,m){return ln.umpCustomText(u,0,1,1,0,m)},umpProjectName:function(u,m){return ln.umpCustomText(u,0,1,1,1,m)},umpCompositionName:function(u,m){return ln.umpCustomText(u,0,1,1,2,m)},umpClipName:function(u,m){return ln.umpCustomText(u,0,1,1,3,m)},umpCopyright:function(u,m){return ln.umpCustomText(u,0,1,1,4,m)},umpComposerName:function(u,m){return ln.umpCustomText(u,0,1,1,5,m)},umpLyricistName:function(u,m){return ln.umpCustomText(u,0,1,1,6,m)},umpArrangerName:function(u,m){return ln.umpCustomText(u,0,1,1,7,m)},umpPublisherName:function(u,m){return ln.umpCustomText(u,0,1,1,8,m)},umpPerformerName:function(u,m){return ln.umpCustomText(u,0,1,1,9,m)},umpAccPerformerName:function(u,m){return ln.umpCustomText(u,0,1,1,10,m)},umpRecordingDate:function(u,m){return ln.umpCustomText(u,0,1,1,11,m)},umpRecordingLocation:function(u,m){return ln.umpCustomText(u,0,1,1,12,m)},umpText:function(u,m){return ln.umpCustomText(u,0,1,2,0,m)},umpLyrics:function(u,m){return ln.umpCustomText(u,0,1,2,1,m)},umpLyricsLanguage:function(u,m){return ln.umpCustomText(u,0,1,2,2,m)},umpRuby:function(u,m){return ln.umpCustomText(u,0,1,2,3,m)},umpRubyLanguage:function(u,m){return ln.umpCustomText(u,0,1,2,4,m)},umpData:function(u,m,I){typeof I>"u"&&(I=m,m=0);var U,z=Io(Wc(I),13);for(U=0;U<z.length;U++)z[U]=[80+ut(u),jo(z.length,U)*16+z[U].length,bn(m)].concat(z[U],sr).slice(0,16);return z}},za=[0,6,32,38,98,99,100,101],Hn={umpNoteOn:function(u,m,I,U,z,se){return typeof U>"u"&&(U=65535),z=z||0,se=se||0,U=de(U),se=de(se),[64+ut(u),144+Le(m),Ft(I),bn(z),U>>8,U&255,se>>8,se&255]},umpNoteOff:function(u,m,I,U,z,se){return U=U||0,z=z||0,se=se||0,U=de(U),se=de(se),[64+ut(u),128+Le(m),Ft(I),bn(z),U>>8,U&255,se>>8,se&255]},umpAftertouch:function(u,m,I,U,z,se,fe){return[64+ut(u),160+Le(m),Ft(I),0].concat(gi(U,z,se,fe))},umpAftertouchF:function(u,m,I,U){return Hn.umpAftertouch(u,m,I,no(U))},umpControl:function(u,m,I,U,z,se,fe){return za.includes(I)&&pt(I),[64+ut(u),176+Le(m),He(I),0].concat(gi(U,z,se,fe))},umpPortamento:function(u,m,I){return[64+ut(u),176+Le(m),84,0,Ft(I),0,0,0]},umpPressure:function(u,m,I,U,z,se){return[64+ut(u),208+Le(m),0,0].concat(gi(I,U,z,se))},umpPressureF:function(u,m,I){return Hn.umpPressure(u,m,no(I))},umpProgram:function(u,m,I,U,z){return typeof U>"u"&&typeof z>"u"?[64+ut(u),192+Le(m),0,0,Ft(I),0,0,0]:typeof z>"u"?[64+ut(u),192+Le(m),0,1,Ft(I),0,zt(U),wt(U)]:[64+ut(u),192+Le(m),0,1,Ft(I),0,He(U),He(z)]},umpPitchBend:function(u,m,I,U,z,se){return[64+ut(u),224+Le(m),0,0].concat(gi(I,U,z,se))},umpPitchBendF:function(u,m,I){return Hn.umpPitchBend(u,m,no((I+1)/2))},umpPnPitchBend:function(u,m,I,U,z,se,fe){return[64+ut(u),96+Le(m),Ft(I),0].concat(gi(U,z,se,fe))},umpPnPitchBendF:function(u,m,I,U){return Hn.umpPnPitchBend(u,m,I,no((U+1)/2))},umpRPN:function(u,m,I,U,z,se,fe,Xe){return[64+ut(u),32+Le(m),He(I),He(U)].concat(gi(z,se,fe,Xe))},umpNRPN:function(u,m,I,U,z,se,fe,Xe){return[64+ut(u),48+Le(m),He(I),He(U)].concat(gi(z,se,fe,Xe))},umpPnRPN:function(u,m,I,U,z,se,fe,Xe){return[64+ut(u),0+Le(m),Ft(I),bn(U)].concat(gi(z,se,fe,Xe))},umpPnNRPN:function(u,m,I,U,z,se,fe,Xe){return[64+ut(u),16+Le(m),Ft(I),bn(U)].concat(gi(z,se,fe,Xe))},umpFineTuning:function(u,m,I,U,z,se){return Hn.umpRPN(u,m,0,1,I,U,z,se)},umpFineTuningF:function(u,m,I){return Hn.umpFineTuning(u,m,J.to32b(ir((I%1+1)/2,I)))},umpCoarseTuning:function(u,m,I){return[64+ut(u),32+Le(m),0,2,He(I)*2,0,0,0]},umpCoarseTuningF:function(u,m,I){return Hn.umpCoarseTuning(u,m,64+(I-I%1))},umpTuningProgram:function(u,m,I){return[64+ut(u),32+Le(m),0,3,He(I)*2,0,0,0]},umpTuningBank:function(u,m,I){return[64+ut(u),32+Le(m),0,4,He(I)*2,0,0,0]},umpPnManagement:function(u,m,I,U){for(var z=U.toString().split(""),se=0,fe=0;fe<z.length;fe++)if(z[fe]=="S"&&!(se&1))se|=1;else if(z[fe]=="D"&&!(se&2))se|=2;else{se=U;break}return[64+ut(u),240+Le(m),Ft(I),bn(se),0,0,0,0]}};Hn.umpPnPressure=Hn.umpAftertouch,Hn.umpPnPressureF=Hn.umpAftertouchF,Hn.umpTranspose=Hn.umpCoarseTuningF;var ln={umpTuningF:function(u,m,I){return[Hn.umpCoarseTuningF(u,m,I),Hn.umpFineTuningF(u,m,I)]},umpTuningA:function(u,m,I){return ln.umpTuningF(u,m,J.shift(I))},umpCustomText:function(u,m,I,U,z,se){var fe,Xe=[];for(se=Qe.lib.toUTF8(""+se),fe=0;fe<se.length;fe++)Xe.push(se.charCodeAt(fe));for(Xe=Io(Xe,12),fe=0;fe<Xe.length;fe++)Xe[fe]=[208+ut(u),jo(Xe.length,fe)*64+(I?16:0)+Le(m),U,z].concat(Xe[fe],sr).slice(0,16);return Xe},umpCMetadata:function(u,m,I){return ln.umpCustomText(u,m,0,1,0,I)},umpCProjectName:function(u,m,I){return ln.umpCustomText(u,m,0,1,1,I)},umpCCompositionName:function(u,m,I){return ln.umpCustomText(u,m,0,1,2,I)},umpCClipName:function(u,m,I){return ln.umpCustomText(u,m,0,1,3,I)},umpCCopyright:function(u,m,I){return ln.umpCustomText(u,m,0,1,4,I)},umpCComposerName:function(u,m,I){return ln.umpCustomText(u,m,0,1,5,I)},umpCLyricistName:function(u,m,I){return ln.umpCustomText(u,m,0,1,6,I)},umpCArrangerName:function(u,m,I){return ln.umpCustomText(u,m,0,1,7,I)},umpCPublisherName:function(u,m,I){return ln.umpCustomText(u,m,0,1,8,I)},umpCPerformerName:function(u,m,I){return ln.umpCustomText(u,m,0,1,9,I)},umpCAccPerformerName:function(u,m,I){return ln.umpCustomText(u,m,0,1,10,I)},umpCRecordingDate:function(u,m,I){return ln.umpCustomText(u,m,0,1,11,I)},umpCRecordingLocation:function(u,m,I){return ln.umpCustomText(u,m,0,1,12,I)},umpCText:function(u,m,I){return ln.umpCustomText(u,m,0,2,0,I)},umpCLyrics:function(u,m,I){return ln.umpCustomText(u,m,0,2,1,I)},umpCLyricsLanguage:function(u,m,I){return ln.umpCustomText(u,m,0,2,2,I)},umpCRuby:function(u,m,I){return ln.umpCustomText(u,m,0,2,3,I)},umpCRubyLanguage:function(u,m,I){return ln.umpCustomText(u,m,0,2,4,I)}},Hr={};function jl(u,m){Ct[u]=function(){return new Ct(m.apply(this,arguments))},Hr[u]=function(){return this.send(m.apply(this,arguments))}}function is(u,m){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),new Ct(m.apply(this,I))},Hr[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),this.send(m.apply(this,I))}}function ma(u,m){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var U=m.apply(this,I),z=0;z<U.length;z++)U[z]=new Ct(U[z]);return U},Hr[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var U=m.apply(this,I),z=0;z<U.length;z++)this.send(U[z]);return this}}function va(u,m){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),new Ct(m.apply(this,I))},Hr[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),this.send(m.apply(this,I))}}function Zr(u,m){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var U=m.apply(this,I),z=0;z<U.length;z++)U[z]=new Ct(U[z]);return U},Hr[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var U=m.apply(this,I),z=0;z<U.length;z++)this.send(U[z]);return this}}function jo(u,m){return u==1?0:m==0?1:m==u-1?3:2}function Io(u,m){for(var I=[],U=u;U.length;U=U.slice(m))I.push(U.slice(0,m));return I.length?I:[[]]}function wo(u,m){for(var I=Io(m.slice(1,m.length-1),6),U=0;U<I.length;U++)I[U]=new Ct([48+u,jo(I.length,U)*16+I[U].length].concat(I[U],sr).slice(0,8));return I}function Wc(u){var m,I=[];if(typeof u=="string")for(m=0;m<u.length;m++)I.push(u.charCodeAt(m));else for(m=0;m<u.length;m++)I.push(u[m]);for(m=0;m<I.length;m++)if(I[m]!=parseInt(I[m])||I[m]<0||I[m]>255)throw RangeError("Bad data");return I}function js(u,m){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),wo(ut(I[0]),m.apply(this,I.slice(1)))},Hr[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var U=wo(ut(I[0]),m.apply(this,I.slice(1))),z=this,se=0;se<U.length;se++)z=z.send(U[se]);return z}}function os(u,m){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var U=m.apply(this,I.slice(1)),z=[],se=0;se<U.length;se++)z=z.concat(wo(ut(I[0]),U[se]));return z},Hr[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I));for(var U=m.apply(this,I.slice(1)),z=this,se=0;se<U.length;se++)for(var fe=wo(ut(I[0]),U[se]),Xe=0;Xe<fe.length;Xe++)z=z.send(fe[Xe]);return z}}function Vo(u,m){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),new Ct([16+ut(I[0])].concat(m.apply(this,I.slice(1)),sr).slice(0,4))},Hr[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),this.send([16+ut(I[0])].concat(m.apply(this,I.slice(1)),sr).slice(0,4))}}function Vs(u,m){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),new Ct([32+ut(I[0])].concat(m.apply(this,I.slice(1)),sr).slice(0,4))},Hr[u]=function(){var I=Array.prototype.slice.call(arguments);return typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1))),this.send([32+ut(I[0])].concat(m.apply(this,I.slice(1)),sr).slice(0,4))}}function zc(u,m){Ct[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var U=m.apply(this,I.slice(1)),z=0;z<U.length;z++)U[z]=new Ct([32+ut(I[0])].concat(U[z],sr).slice(0,4));return U},Hr[u]=function(){var I=Array.prototype.slice.call(arguments);typeof this._gr<"u"&&(I=[this._gr].concat(I)),typeof this._ch<"u"&&(I=[I[0]].concat([this._ch]).concat(I.slice(1)));for(var U=m.apply(this,I.slice(1)),z=this,se=0;se<U.length;se++)z=z.send([32+ut(I[0])].concat(U[se],sr).slice(0,4));return z}}V(ga,function(u){jl(u,ga[u])}),V(Uo,function(u){is(u,Uo[u])}),V(Us,function(u){ma(u,Us[u])}),V(Hn,function(u){va(u,Hn[u])}),V(ln,function(u){Zr(u,ln[u])}),V(eo,function(u){Vo(u,eo[u])}),V(Wr,function(u){Vs(u,Wr[u])}),V(At,function(u){Vs(u,At[u])}),V(on,function(u){zc(u,on[u])}),V(kt,function(u){js(u,kt[u])}),V(M,function(u){os(u,M[u])});function Ha(u){V(Hr,function(m){u.prototype[m]=Hr[m]})}Ha(Pt),Ct.prototype.getTempo=function(){if(this.isTempo())return(this[4]<<24)+(this[5]<<16)+(this[6]<<8)+this[7]},Ct.prototype.getBPM=function(){var u=this.getTempo();if(u)return Math.round(6e9/u)},Ct.prototype.getTimeSignature=function(){if(this.isTimeSignature())return[this[4],1<<this[5]]},Ct.prototype.getTicksPQN=function(){if(this.isTicksPQN())return(this[2]<<8)+this[3]},Ct.prototype.getDelta=function(){if(this.isDelta())return((this[1]&15)<<16)+(this[2]<<8)+this[3]},Ct.prototype.getStatus=function(){if(this.isFlex())return this[1]>>6;if(this.isData()||this.isSX())return this[1]>>4},Ct.prototype.isTempo=function(){return this[0]>>4==13&&this[1]>>4==1&&this[2]==0&&this[3]==0},Ct.prototype.isTimeSignature=function(){return this[0]>>4==13&&this[1]>>4==1&&this[2]==0&&this[3]==1},Ct.prototype.isTicksPQN=function(){return this[0]==0&&this[1]>>4==3},Ct.prototype.isDelta=function(){return this[0]==0&&this[1]>>4==4},Ct.prototype.isStartClip=function(){return this.match([240,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},Ct.prototype.isEndClip=function(){return this.match([240,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},Ct.prototype.isData=function(){return(this[0]&240)==80},Ct.prototype.isFlex=function(){return(this[0]&240)==208},Ct.prototype.isText=function(){return(this[0]&240)==208&&(this[2]==1||this[2]==2)},Ct.prototype.isSX=function(){return(this[0]&240)==48},Ct.prototype.isNoteOn=function(){var u=(this[0]||0)>>4,m=(this[1]||0)>>4;return u==4?m==9:u==2?m==9&&!!this[3]:!1},Ct.prototype.isNoteOff=function(){var u=(this[0]||0)>>4,m=(this[1]||0)>>4;return u==4?m==8:u==2?m==8||m==9&&!this[3]:!1},Ct.prototype.label=J.prototype.label,Ct.prototype.toString=J.prototype.toString,Ct.prototype._str=function(){var u=this._string();return u?Co(this)+" -- "+u:Co(this)},Ct.prototype._string=function(){var u,m,I,U=this[0]>>4;return U==1||U==2?new J(this.slice(1))._string():(U==0?(u=this[1]>>4,m=["NOOP","JR Clock","JR Timestamp","Ticks Per Quarter Note","Delta Ticks"][u]):U==3?m="SysEx":U==4?(u=this[1]>>4,m={0:"Registered Per-Note Controller",1:"Assignable Per-Note Controller",2:"Registered Controller",3:"Assignable Controller",4:"Relative Registered Controller",5:"Relative Assignable Controller",6:"Per-Note Pitch Bend",8:"Note Off",9:"Note On",10:"Poly Pressure",11:"Control Change",12:"Program Change",13:"Channel Pressure",14:"Pitch Bend",15:"Per-Note Management"}[u],u==11&&(m={84:"Portamento"}[this[2]]||m),u==2&&(I={"0000":"Pitch Bend Sensitivity","0001":"Fine Tuning","0002":"Coarse Tuning","0003":"Select Tuning Program","0004":"Select Tuning Bank","0005":"Vibrato Depth Range","7f7f":"NONE"}[tr(this[2])+""+tr(this[3])],I&&(m+=": "+I))):U==5?m="Data":U==13&&(u=this[2],u==0?(u=this[3],m={0:"Tempo ",1:"Time Signature ",2:"Metronome",5:"Key Signature",6:"Chord Name"}[u],u==0?m+=this.getBPM()+" BPM":u==1&&(m+=this.getTimeSignature().join("/"))):u==1?(u=this[3],m={0:"Metadata",1:"Project Name",2:"Composition Name",3:"Clip Name",4:"Copyright",5:"Composer Name",6:"Lyricist Name",7:"Arranger Name",8:"Publisher Name",9:"Primary Performer Name",10:"Accompanying Performer Name",11:"Recording Date",12:"Recording Location"}[u]||"Unknown Text"):u==2&&(u=this[3],m={0:"Text",1:"Lyrics",2:"Lyrics Language",3:"Ruby",4:"Ruby Language"}[u]||"Unknown Text")),U==15&&(m={32:"Start of Clip",33:"End of Clip"}[this[1]]),m)},Ct.prototype._stamp=J.prototype._stamp,Ct.prototype._unstamp=J.prototype._unstamp,Ct.prototype._stamped=J.prototype._stamped,Ct.prototype.match=J.prototype.match,Qe.UMP=Ct,F.prototype.UMP=Ct,Qe.MIDI2=Ct,F.prototype.MIDI2=Ct;function Hc(u,m){var I=u*256+m;return I?I>>9||1:0}function Xr(u,m,I,U){var z=u*16777216+m*65536+I*256+U;return z>>25&127}function Er(u,m){return u.gr=m,u}function Zc(u){if(u.isMidi2){var m,I,U,z=u[0]>>4,se=u[0]&15;if(z==1||z==2)this._emit(Er(new J(u.slice(1)),se));else if(z==3)I=u[1]>>4,m=u[1]&15,I==0?(this._emit(Er(new J([240].concat(u.slice(2,2+m),[247])),se)),this._sx[se]=void 0):I==1?this._sx[se]=u.slice(2,2+m):I==2?this._sx[se]&&(this._sx[se]=this._sx[se].concat(u.slice(2,2+m))):I==3&&(this._sx[se]&&this._emit(Er(new J([240].concat(this._sx[se],u.slice(2,2+m),[247])),se)),this._sx[se]=void 0);else if(z==4){if(m=u[1]>>4,I=u[1]&15,m==2||m==3?(this._emit(Er(new J([176+I,m==2?101:99,u[2]]),se)),this._emit(Er(new J([176+I,m==2?100:98,u[3]]),se)),this._emit(Er(new J([176+I,6,u[4]>>1]),se)),this._emit(Er(new J([176+I,38,(u[4]&1)*64+(u[4]>>2)]),se))):(m==8||m==9)&&this._emit(Er(new J([u[1],u[2],Hc(u[4],u[5])]),se)),m==10&&this._emit(Er(new J([u[1],u[2],Xr(u[4],u[5],u[6],u[7])]),se)),m==11){if(za.includes(u[2]))return;this._emit(Er(new J([u[1],u[2],Xr(u[4],u[5],u[6],u[7])]),se))}m==13&&this._emit(Er(new J([u[1],Xr(u[4],u[5],u[6],u[7])]),se)),m==14?(U=u[4]*16777216+u[5]*65536+u[6]*256+u[4]>>18,this._emit(Er(new J([u[1],U&127,U>>7&127]),se))):m==12&&(u[3]&&(this._emit(Er(new J([176+I,0,u[6]]),se)),this._emit(Er(new J([176+I,32,u[7]]),se))),this._emit(Er(new J([u[1],u[4]]),se)))}}else this._emit(u)}function Qu(){var u=new _e;return u._sx=[],u._receive=Zc,u._resume(),u.MIDI2()}Qe.M2M1=Qu,F.prototype.M2M1=Qe.M2M1;function Vl(u){if(u.isMidi2)this._emit(u);else{var m=u.gr>=0&&u.gr<=15?u.gr:0;if(u[0]>=128&&u[0]<240)this._emit(Qe.MIDI2([32+m].concat(u.slice(),sr).slice(0,4)));else if(u[0]>240&&u[0]<=255&&u[0]!=247)this._emit(Qe.MIDI2([16+m].concat(u.slice(),sr).slice(0,4)));else if(u.isFullSysEx())for(var I=wo(m,u.slice()),U=0;U<I.length;U++)this._emit(Qe.MIDI2(I[U]))}}function Za(){var u=new _e;return u._receive=Vl,u._resume(),u}Qe.M1M2=Za,F.prototype.M1M2=Qe.M1M2,Qe.lib={},Qe.lib.now=p,Qe.lib.schedule=g,Qe.lib.R=x;var Xa=[],Go,Gs=0;try{var $a=URL.createObjectURL(new Blob(["(",(function(){function u(){postMessage({}),setTimeout(u,0)}u()}).toString(),")()"],{type:"application/javascript"})),Gl=function(){for(var u=Xa.length,m=0;m<u;m++)Xa.shift()();Gs++,Gs>20&&Go&&(Go.terminate(),Go=void 0)},Xc=function(u){Xa.push(u),Gs=0,Go||(Go=new Worker($a),Go.onmessage=Gl)};Xc(function(){Qe.lib.schedule=Xc})}catch{}Qe.lib.openMidiOut=function(u,m){var I=new _e;return m._openOut(I),I._info=m._info(u),I},Qe.lib.openMidiIn=function(u,m){var I=new _e;return m._openIn(I),I._info=m._info(u),I},Qe.lib.registerMidiOut=function(u,m){for(var I=m._info(u),U=0;U<rn._outs.length;U++)if(rn._outs[U].name==I.name)return!1;return I.engine=m,rn._outs.push(I),ct&&(Ae(),ct._bad&&(ct._repair(),ct._resume())),!0},Qe.lib.registerMidiIn=function(u,m){for(var I=m._info(u),U=0;U<rn._ins.length;U++)if(rn._ins[U].name==I.name)return!1;return I.engine=m,rn._ins.push(I),ct&&(Ae(),ct._bad&&(ct._repair(),ct._resume())),!0},Qe.lib.unregisterMidiOut=function(u){for(var m=0;m<rn._outs.length;m++)if(rn._outs[m].name==u)return rn._outs.splice(m,m+1),ct&&Ae(),!0;return!1},Qe.lib.unregisterMidiIn=function(u){for(var m=0;m<rn._ins.length;m++)if(rn._ins[m].name==u)return rn._ins.splice(m,m+1),ct&&Ae(),!0;return!1},Qe.lib.plug=function(u){for(var m=0;m<mn.length;m++)if(mn[m]==u)return;mn.push(u)},Qe.lib.unplug=function(u){for(var m=0;m<mn.length;m++)if(mn[m]==u){mn.splice(m,1);return}};var br;function $c(){if(!br&&typeof window<"u"){var u=window.AudioContext||window.webkitAudioContext;if(u){br=new u,br&&!br.createGain&&(br.createGain=br.createGainNode);var m=function(){if(br.state!="running"){br.resume();var I=br.createOscillator(),U=br.createGain();try{U.gain.value=0}catch{}U.gain.setTargetAtTime(0,br.currentTime,.01),I.connect(U),U.connect(br.destination),I.start||(I.start=I.noteOn),I.stop||(I.stop=I.noteOff),I.start(.1),I.stop(.11)}else typeof document<"u"&&(document.removeEventListener("touchstart",m),document.removeEventListener("touchend",m),document.removeEventListener("mousedown",m),document.removeEventListener("keydown",m))};typeof document<"u"&&(document.addEventListener("touchstart",m),document.addEventListener("touchend",m),document.addEventListener("mousedown",m),document.addEventListener("keydown",m)),m()}}}Qe.lib.copyMidiHelpers=an,Qe.lib.copyMidi2Helpers=Ha,Qe.lib.copyUmpHelpers=Ha,Qe.lib.getAudioContext=function(){return $c(),br},Qe.lib.closeAudioContext=function(){br&&br.close(),br=void 0};var So="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Qe.lib.fromBase64=function(u){var m="",I,U,z,se,fe,Xe,qe,yt=0;for(u=u.replace(/[^A-Za-z0-9+/=]/g,"");yt<u.length;)se=So.indexOf(u.charAt(yt++)),fe=So.indexOf(u.charAt(yt++)),Xe=So.indexOf(u.charAt(yt++)),qe=So.indexOf(u.charAt(yt++)),I=se<<2|fe>>4,U=(fe&15)<<4|Xe>>2,z=(Xe&3)<<6|qe,m=m+String.fromCharCode(I),Xe!=64&&(m=m+String.fromCharCode(U)),qe!=64&&(m=m+String.fromCharCode(z));return m},Qe.lib.toBase64=function(u){var m,I,U,z,se,fe,Xe,qe,yt=0,wr=0,Wo="",zl=[];if(!u)return u;do m=u.charCodeAt(yt++),I=u.charCodeAt(yt++),U=u.charCodeAt(yt++),qe=m<<16|I<<8|U,z=qe>>18&63,se=qe>>12&63,fe=qe>>6&63,Xe=qe&63,zl[wr++]=So.charAt(z)+So.charAt(se)+So.charAt(fe)+So.charAt(Xe);while(yt<u.length);Wo=zl.join("");var Ju=u.length%3;return Ju?Wo.slice(0,Ju-3)+"===".slice(Ju):Wo},Qe.lib.fromUTF8=function(u){u=typeof u>"u"?"":""+u;var m="",I,U,z;for(I=0;I<u.length;I++){if(U=u.charCodeAt(I),U>255)return u;if(U<128)m+=u[I];else if((U&224)==192){if(U=(U&31)<<6,I++,I>=u.length||(z=u.charCodeAt(I),(z&192)!=128))return u;U+=z&63,m+=String.fromCharCode(U)}else if((U&240)==224){if(U=(U&15)<<12,I++,I>=u.length||(z=u.charCodeAt(I),(z&192)!=128)||(U+=(z&63)<<6,I++,I>=u.length)||(z=u.charCodeAt(I),(z&192)!=128))return u;U+=z&63,m+=String.fromCharCode(U)}else if((U&248)==240){if(U=(U&7)<<18,I++,I>=u.length||(z=u.charCodeAt(I),(z&192)!=128)||(U+=(z&63)<<12,I++,I>=u.length)||(z=u.charCodeAt(I),(z&192)!=128)||(U+=(z&63)<<6,I++,I>=u.length)||(z=u.charCodeAt(I),(z&192)!=128)||(U+=z&63,U>1114111))return u;U-=65536,m+=String.fromCharCode(55296+(U>>10)),m+=String.fromCharCode(56320+(U&1023))}}return m},Qe.lib.toUTF8=function(u){u=typeof u>"u"?"":""+u;var m="",I,U;for(I=0;I<u.length;I++)U=u.charCodeAt(I),U<128?m+=u[I]:U<2048?(m+=String.fromCharCode(192+(U>>6)),m+=String.fromCharCode(128+(U&63))):U<65536?(m+=String.fromCharCode(224+(U>>12)),m+=String.fromCharCode(128+(U>>6&63)),m+=String.fromCharCode(128+(U&63))):(m+=String.fromCharCode(240+(U>>18)),m+=String.fromCharCode(128+(U>>12&63)),m+=String.fromCharCode(128+(U>>6&63)),m+=String.fromCharCode(128+(U&63)));return m};var P=[],W={},Y={},re=t.Promise;typeof re!="function"&&(re=function(u){this.executor=u},re.prototype.then=function(u,m){typeof u!="function"&&(u=y),typeof m!="function"&&(m=y),this.executor(u,m)});function Ne(u,m,I){this.name=u,this.message=m,this.code=I}function De(u,m){this.bubbles=!1,this.cancelBubble=!1,this.cancelable=!1,this.currentTarget=m,this.defaultPrevented=!1,this.eventPhase=0,this.path=[],this.port=u,this.returnValue=!0,this.srcElement=m,this.target=m,this.timeStamp=p(),this.type="statechange"}function Ke(u,m){this.bubbles=!1,this.cancelBubble=!1,this.cancelable=!1,this.currentTarget=u,this.data=m,this.defaultPrevented=!1,this.eventPhase=0,this.path=[],this.receivedTime=p(),this.returnValue=!0,this.srcElement=u,this.target=u,this.timeStamp=this.receivedTime,this.type="midimessage"}function et(u,m){u&&(u.onstatechange&&u.onstatechange(new De(u,u)),m.onstatechange&&m.onstatechange(new De(u,m)))}function $t(u,m){var I=this,U=!1,z=null,se=null;this.type="input",this.id=m.id,this.name=m.name,this.manufacturer=m.man,this.version=m.ver,Object.defineProperty(this,"state",{get:function(){return m.connected?"connected":"disconnected"},enumerable:!0}),Object.defineProperty(this,"connection",{get:function(){return U?m.proxy?"open":"pending":"closed"},enumerable:!0}),Object.defineProperty(this,"onmidimessage",{get:function(){return se},set:function(fe){C(fe)?(se=fe,U||I.open().then(y,y)):se=null},enumerable:!0}),Object.defineProperty(this,"onstatechange",{get:function(){return z},set:function(fe){C(fe)?z=fe:z=null},enumerable:!0}),this.open=function(){return new re(function(fe,Xe){U?fe(I):m.open().then(function(){U||(U=!0,et(I,u)),fe(I)},function(){Xe(new Ne("InvalidAccessError","Port is not available",15))})})},this.close=function(){return new re(function(fe){U&&(U=!1,m.close(),et(I,u)),fe(I)})},Object.freeze(this)}function un(u){for(var m,I;u.length;){for(m=0;m<u.length&&!(u[m]==parseInt(u[m])&&u[m]>=128&&u[m]<=255&&u[m]!=247);m++);if(u.splice(0,m),!u.length)return;if(u[0]==240){for(m=1;m<u.length&&u[m]!=247;m++);return m==u.length?void 0:u.splice(0,m+1)}else{if(I=Gn(u[0])+1,I>u.length)return;for(m=1;m<I&&!(u[m]!=parseInt(u[m])||u[m]<0||u[m]>=128);m++);if(m==I)return u.splice(0,m);u.splice(0,m)}}}function Zt(u,m,I,U){var z=this;this.id=u,this.name=m,this.man=I,this.ver=U,this.connected=!0,this.ports=[],this.pending=[],this.proxy=void 0,this.queue=[],this.onmidi=function(se){var fe;for(z.queue=z.queue.concat(se.slice()),fe=un(z.queue);fe;fe=un(z.queue))for(i=0;i<z.ports.length;i++)z.ports[i][0].onmidimessage&&(fe[0]!=240||z.ports[i][1])&&z.ports[i][0].onmidimessage(new Ke(z,new Uint8Array(fe)))}}Zt.prototype.open=function(){var u=this;return new re(function(m,I){var U;u.proxy||!u.connected?m():(u.pending.push([m,I]),u.pending.length==1&&Qe().openMidiIn(u.name).or(function(){for(U=0;U<u.pending.length;U++)u.pending[U][1]();u.pending=[]}).and(function(){for(u.proxy=this,u.proxy.connect(u.onmidi),U=0;U<u.pending.length;U++)u.pending[U][0]();u.pending=[]}))})},Zt.prototype.close=function(){var u;if(this.proxy){for(u=0;u<this.ports.length;u++)if(this.ports[u].connection=="open")return;this.proxy.close(),this.proxy=void 0}},Zt.prototype.disconnect=function(){this.connected=!1,this.proxy&&(this.proxy.close(),this.proxy=void 0)},Zt.prototype.reconnect=function(){var u=this,m,I,U=[];for(this.connected=!0,m=0;m<P.length;m++)I=P[m].inputs.get(this.id),I.connection=="closed"?et(I,P[m]):U.push([I,P[m]]);U.length&&Qe()._openMidiInNR(u.name).or(function(){for(m=0;m<U.length;m++)U[m][0].close()}).and(function(){for(u.proxy=this,u.proxy.connect(u.onmidi),m=0;m<U.length;m++)et(U[m][0],U[m][1])})};function Gn(u){return u>=128&&u<=191||u>=224&&u<=239||u==242?2:u>=192&&u<=223||u==241||u==243?1:0}var Ir="Failed to execute 'send' on 'MIDIOutput': ";function Ei(u,m){var I,U,z,se=[];for(I=0;I<u.length;I++)if(u[I]!=parseInt(u[I])||u[I]<0||u[I]>255)throw TypeError(Ir+u[I]+" is not a UInt8 value.");for(U=0,I=0;I<u.length;I++)if(U){if(u[I]>127)throw TypeError(Ir+"Unexpected status byte at index "+I+" ("+u[I]+").");z.push(u[I]),U--}else{if(u[I]<128)throw TypeError(Ir+"Running status is not allowed at index "+I+" ("+u[I]+").");if(u[I]==247)throw TypeError(Ir+"Unexpected end of system exclusive message at index "+I+" ("+u[I]+").");if(z=[u[I]],se.push(z),u[I]==240){if(!m)throw new Ne("InvalidAccessError",Ir+"System exclusive messag is not allowed at index "+I+" ("+u[I]+").",15);for(U=-1;I<u.length;I++)if(z.push(u[I]),u[I]==247){U=0;break}}else U=Gn(u[I])}if(U)throw TypeError(Ir+"Message is incomplete");return[se]}function Ti(u,m){var I=this,U=!1,z=null;this.type="output",this.id=m.id,this.name=m.name,this.manufacturer=m.man,this.version=m.ver,Object.defineProperty(this,"state",{get:function(){return m.connected?"connected":"disconnected"},enumerable:!0}),Object.defineProperty(this,"connection",{get:function(){return U?m.proxy?"open":"pending":"closed"},enumerable:!0}),Object.defineProperty(this,"onstatechange",{get:function(){return z},set:function(se){C(se)?z=se:z=null},enumerable:!0}),this.open=function(){return new re(function(se,fe){U?se(I):m.open().then(function(){U||(U=!0,et(I,u)),se(I)},function(){fe(new Ne("InvalidAccessError","Port is not available",15))})})},this.close=function(){return new re(function(se){U&&(U=!1,I.clear(),m.close(),et(I,u)),se(I)})},this.clear=function(){},this.send=function(se,fe){if(Ei(se,u.sysexEnabled),!m.connected)throw new Ne("InvalidStateError","Port is not connected",11);if(U){var Xe=p();fe>Xe?setTimeout(function(){m.proxy.send(se)},fe-Xe):m.proxy.send(se)}else this.open().then(function(){I.send(se,fe)},y)},Object.freeze(this)}function ro(u,m,I,U){this.id=u,this.name=m,this.man=I,this.ver=U,this.connected=!0,this.ports=[],this.pending=[],this.proxy=void 0}ro.prototype.open=function(){var u=this;return new re(function(m,I){var U;u.proxy||!u.connected?m():(u.pending.push([m,I]),u.pending.length==1&&Qe().openMidiOut(u.name).or(function(){for(U=0;U<u.pending.length;U++)u.pending[U][1]();u.pending=[]}).and(function(){for(u.proxy=this,U=0;U<u.pending.length;U++)u.pending[U][0]();u.pending=[]}))})},ro.prototype.close=function(){var u;if(this.proxy){for(u=0;u<this.ports.length;u++)if(this.ports[u].connection=="open")return;this.proxy.close(),this.proxy=void 0}},ro.prototype.disconnect=function(){this.connected=!1,this.proxy&&(this.proxy.close(),this.proxy=void 0)},ro.prototype.reconnect=function(){var u=this,m,I,U=[];for(this.connected=!0,m=0;m<P.length;m++)I=P[m].outputs.get(this.id),I.connection=="closed"?et(I,P[m]):U.push([I,P[m]]);U.length&&Qe()._openMidiOutNR(u.name).or(function(){for(m=0;m<U.length;m++)U[m][0].close()}).and(function(){for(u.proxy=this,m=0;m<U.length;m++)et(U[m][0],U[m][1])})};function Ka(u){this.has=function(m){return u.hasOwnProperty(m)&&u[m].connected},this.keys=function(){try{var m=new Map;for(var I in u)this.has(I)&&m.set(I,this.get(I));return m.keys()}catch{}},this.values=function(){try{var m=new Map;for(var I in u)this.has(I)&&m.set(I,this.get(I));return m.values()}catch{}},this.entries=function(){try{var m=new Map;for(var I in u)this.has(I)&&m.set(I,this.get(I));return m.entries()}catch{}},this.forEach=function(m,I){typeof I>"u"&&(I=this);for(var U in u)this.has(U)&&m.call(I,this.get(U),U,this)},Object.defineProperty(this,"size",{get:function(){var m=0;for(var I in u)this.has(I)&&m++;return m},enumerable:!0})}function Bi(u,m){this.get=function(I){if(Y.hasOwnProperty(I)&&Y[I].connected)return m[I]||(m[I]=new $t(u,Y[I]),Y[I].ports.push([m[I],u.sysexEnabled])),m[I]},Object.freeze(this)}Bi.prototype=new Ka(Y),Bi.prototype.constructor=Bi;function Wl(u,m){this.get=function(I){if(W.hasOwnProperty(I)&&W[I].connected)return m[I]||(m[I]=new Ti(u,W[I]),W[I].ports.push([m[I],u.sysexEnabled])),m[I]},Object.freeze(this)}Wl.prototype=new Ka(W),Wl.prototype.constructor=Wl;function Cg(u){var m,I,U,z;for(m=0;m<u.inputs.added.length;m++)U=u.inputs.added[m],Y.hasOwnProperty(U.id)||(Y[U.id]=new Zt(U.id,U.name,U.manufacturer,U.version)),Y[U.id].reconnect();for(m=0;m<u.outputs.added.length;m++)U=u.outputs.added[m],W.hasOwnProperty(U.id)||(W[U.id]=new ro(U.id,U.name,U.manufacturer,U.version)),W[U.id].reconnect();for(m=0;m<u.inputs.removed.length;m++)if(U=u.inputs.removed[m],Y.hasOwnProperty(U.id)){for(z=[],I=0;I<P.length;I++)z.push([P[I].inputs.get(U.id),P[I]]);for(Y[U.id].disconnect(),I=0;I<z.length;I++)et(z[I][0],z[I][1])}for(m=0;m<u.outputs.removed.length;m++)if(U=u.outputs.removed[m],W.hasOwnProperty(U.id)){for(z=[],I=0;I<P.length;I++)z.push([P[I].outputs.get(U.id),P[I]]);for(W[U.id].disconnect(),I=0;I<z.length;I++)et(z[I][0],z[I][1])}}function xg(u){var m={},I={},U=null,z=this;this.sysexEnabled=u,this.inputs=new Bi(z,m),this.outputs=new Wl(z,I),Object.defineProperty(this,"onstatechange",{get:function(){return U},set:function(qe){U=C(qe)?qe:null},enumerable:!0}),Object.freeze(this);var se,fe,Xe=ct._info;for(se=0;se<Xe.inputs.length;se++)fe=Xe.inputs[se],Y.hasOwnProperty(fe.id)||(Y[fe.id]=new Zt(fe.id,fe.name,fe.manufacturer,fe.version));for(se=0;se<Xe.outputs.length;se++)fe=Xe.outputs[se],W.hasOwnProperty(fe.id)||(W[fe.id]=new ro(fe.id,fe.name,fe.manufacturer,fe.version));P.length||Qe().onChange(Cg),P.push(this)}return Qe.requestMIDIAccess=function(u){return new re(function(m,I){Qe.JZZ(u).or(function(){}).and(function(){var U=!!(u&&u.sysex);if(U&&!this.info().sysex)I(new Ne("SecurityError","Sysex is not allowed",18));else{var z=new xg(U);m(z)}})})},typeof navigator<"u"&&!navigator.requestMIDIAccess&&(navigator.requestMIDIAccess=Qe.requestMIDIAccess),Qe.close=function(){ce._close&&ce._close()},Qe})}(r0)),r0.exports}var DF=RF();const Hd=Nc(DF);var i0={exports:{}},PF=i0.exports,YI;function MF(){return YI||(YI=1,function(n,e){(function(t,r){r.Tiny=r,n.exports=r})(PF,function(t){if(!t||(t.synth||(t.synth={}),t.synth.Tiny))return;var r="1.4.3";function i(h){this.__proto__=this.sy={is:"webaudio-tinysynth",properties:{masterVol:{type:Number,value:.5,observer:"setMasterVol"},reverbLev:{type:Number,value:.3,observer:"setReverbLev"},quality:{type:Number,value:1,observer:"setQuality"},debug:{type:Number,value:0},src:{type:String,value:null,observer:"loadMIDIUrl"},loop:{type:Number,value:0},tsmode:{type:Number,value:0},voices:{type:Number,value:64},useReverb:{type:Number,value:1}},program:[],drummap:[],program1:[[{w:"sine",v:.4,d:.7,r:.1},{w:"triangle",v:3,d:.7,s:.1,g:1,a:.01,k:-1.2}],[{w:"triangle",v:.4,d:.7,r:.1},{w:"triangle",v:4,t:3,d:.4,s:.1,g:1,k:-1,a:.01}],[{w:"sine",d:.7,r:.1},{w:"triangle",v:4,f:2,d:.5,s:.5,g:1,k:-1}],[{w:"sine",d:.7,v:.2},{w:"triangle",v:4,t:3,f:2,d:.3,g:1,k:-1,a:.01,s:.5}],[{w:"sine",v:.35,d:.7},{w:"sine",v:3,t:7,f:1,d:1,s:1,g:1,k:-.7}],[{w:"sine",v:.35,d:.7},{w:"sine",v:8,t:7,f:1,d:.5,s:1,g:1,k:-.7}],[{w:"sawtooth",v:.34,d:2},{w:"sine",v:8,f:.1,d:2,s:1,r:2,g:1}],[{w:"triangle",v:.34,d:1.5},{w:"square",v:6,f:.1,d:1.5,s:.5,r:2,g:1}],[{w:"sine",d:.3,r:.3},{w:"sine",v:7,t:11,d:.03,g:1}],[{w:"sine",d:.3,r:.3},{w:"sine",v:11,t:6,d:.2,s:.4,g:1}],[{w:"sine",v:.2,d:.3,r:.3},{w:"sine",v:11,t:5,d:.1,s:.4,g:1}],[{w:"sine",v:.2,d:.6,r:.6},{w:"triangle",v:11,t:5,f:1,s:.5,g:1}],[{w:"sine",v:.3,d:.2,r:.2},{w:"sine",v:6,t:5,d:.02,g:1}],[{w:"sine",v:.3,d:.2,r:.2},{w:"sine",v:7,t:11,d:.03,g:1}],[{w:"sine",v:.2,d:1,r:1},{w:"sine",v:11,t:3.5,d:1,r:1,g:1}],[{w:"triangle",v:.2,d:.5,r:.2},{w:"sine",v:6,t:2.5,d:.2,s:.1,r:.2,g:1}],[{w:"w9999",v:.22,s:.9},{w:"w9999",v:.22,t:2,f:2,s:.9}],[{w:"w9999",v:.2,s:1},{w:"sine",v:11,t:6,f:2,s:.1,g:1,h:.006,r:.002,d:.002},{w:"w9999",v:.2,t:2,f:1,h:0,s:1}],[{w:"w9999",v:.2,d:.1,s:.9},{w:"w9999",v:.25,t:4,f:2,s:.5}],[{w:"w9999",v:.3,a:.04,s:.9},{w:"w9999",v:.2,t:8,f:2,a:.04,s:.9}],[{w:"sine",v:.2,a:.02,d:.05,s:1},{w:"sine",v:6,t:3,f:1,a:.02,d:.05,s:1,g:1}],[{w:"triangle",v:.2,a:.02,d:.05,s:.8},{w:"square",v:7,t:3,f:1,d:.05,s:1.5,g:1}],[{w:"square",v:.2,a:.02,d:.2,s:.5},{w:"square",v:1,d:.03,s:2,g:1}],[{w:"square",v:.2,a:.02,d:.1,s:.8},{w:"square",v:1,a:.3,d:.1,s:2,g:1}],[{w:"sine",v:.3,d:.5,f:1},{w:"triangle",v:5,t:3,f:-1,d:1,s:.1,g:1}],[{w:"sine",v:.4,d:.6,f:1},{w:"triangle",v:12,t:3,d:.6,s:.1,g:1,f:-1}],[{w:"triangle",v:.3,d:1,f:1},{w:"triangle",v:6,f:-1,d:.4,s:.5,g:1,t:3}],[{w:"sine",v:.3,d:1,f:-1},{w:"triangle",v:11,f:1,d:.4,s:.5,g:1,t:3}],[{w:"sine",v:.4,d:.1,r:.01},{w:"sine",v:7,g:1}],[{w:"triangle",v:.4,d:1,f:1},{w:"square",v:4,f:-1,d:1,s:.7,g:1}],[{w:"triangle",v:.35,d:1,f:1},{w:"square",v:7,f:-1,d:.3,s:.5,g:1}],[{w:"sine",v:.2,t:1.5,a:.005,h:.2,d:.6},{w:"sine",v:11,t:5,f:2,d:1,s:.5,g:1}],[{w:"sine",d:.3},{w:"sine",v:4,t:3,d:1,s:1,g:1}],[{w:"sine",d:.3},{w:"sine",v:4,t:3,d:1,s:1,g:1}],[{w:"w9999",d:.3,v:.7,s:.5},{w:"sawtooth",v:1.2,d:.02,s:.5,g:1,h:0,r:.02}],[{w:"sine",d:.3},{w:"sine",v:4,t:3,d:1,s:1,g:1}],[{w:"triangle",v:.3,t:2,d:1},{w:"triangle",v:15,t:2.5,d:.04,s:.1,g:1}],[{w:"triangle",v:.3,t:2,d:1},{w:"triangle",v:15,t:2.5,d:.04,s:.1,g:1}],[{w:"triangle",d:.7},{w:"square",v:.4,t:.5,f:1,d:.2,s:10,g:1}],[{w:"triangle",d:.7},{w:"square",v:.4,t:.5,f:1,d:.2,s:10,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,d:11,s:.2,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,d:11,s:.2,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,t:.5,d:11,s:.2,g:1}],[{w:"sawtooth",v:.4,a:.1,d:11},{w:"sine",v:5,t:.5,d:11,s:.2,g:1}],[{w:"sine",v:.4,a:.1,d:11},{w:"sine",v:6,f:2.5,d:.05,s:1.1,g:1}],[{w:"sine",v:.3,d:.1,r:.1},{w:"square",v:4,t:3,d:1,s:.2,g:1}],[{w:"sine",v:.3,d:.5,r:.5},{w:"sine",v:7,t:2,f:2,d:1,r:1,g:1}],[{w:"triangle",v:.6,h:.03,d:.3,r:.3,t:.5},{w:"n0",v:8,t:1.5,d:.08,r:.08,g:1}],[{w:"sawtooth",v:.3,a:.03,s:.5},{w:"sawtooth",v:.2,t:2,f:2,d:1,s:2}],[{w:"sawtooth",v:.3,f:-2,a:.03,s:.5},{w:"sawtooth",v:.2,t:2,f:2,d:1,s:2}],[{w:"sawtooth",v:.2,a:.02,s:1},{w:"sawtooth",v:.2,t:2,f:2,a:1,d:1,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1},{w:"sawtooth",v:.2,f:2,a:.02,d:1,s:1}],[{w:"triangle",v:.3,a:.03,s:1},{w:"sine",v:3,t:5,f:1,d:1,s:1,g:1}],[{w:"sine",v:.4,a:.03,s:.9},{w:"sine",v:1,t:2,f:3,d:.03,s:.2,g:1}],[{w:"triangle",v:.6,a:.05,s:.5},{w:"sine",v:1,f:.8,d:.2,s:.2,g:1}],[{w:"square",v:.15,a:.01,d:.2,r:.2,t:.5,h:.03},{w:"square",v:4,f:.5,d:.2,r:11,a:.01,g:1,h:.02},{w:"square",v:.15,t:4,f:1,a:.02,d:.15,r:.15,h:.03},{g:3,w:"square",v:4,f:-.5,a:.01,h:.02,d:.15,r:11}],[{w:"square",v:.2,a:.01,d:1,s:.6,r:.04},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.5,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.04,d:1,s:.4,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.15,a:.04,s:1},{w:"sine",v:2,d:.1,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.5,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.6,r:.08},{w:"sine",v:1,f:.2,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:.5,s:.7,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.5,r:.08},{w:"sine",v:1,d:.1,s:4,g:1}],[{w:"square",v:.2,a:.02,d:2,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"square",v:.2,a:.02,d:2,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"square",v:.2,a:.02,d:1,s:.6},{w:"sine",v:2,d:1,g:1}],[{w:"sine",v:.4,a:.02,d:.7,s:.5},{w:"square",v:5,t:2,d:.2,s:.5,g:1}],[{w:"sine",v:.3,a:.05,d:.2,s:.8},{w:"sawtooth",v:6,f:.1,d:.1,s:.3,g:1}],[{w:"sine",v:.3,a:.03,d:.2,s:.4},{w:"square",v:7,f:.2,d:1,s:.1,g:1}],[{w:"square",v:.2,a:.05,d:.1,s:.8},{w:"square",v:4,d:.1,s:1.1,g:1}],[{w:"sine",a:.02,d:2},{w:"sine",v:6,t:2,d:.04,g:1}],[{w:"sine",v:.7,a:.03,d:.4,s:.4},{w:"sine",v:4,t:2,f:.2,d:.4,g:1}],[{w:"sine",v:.7,a:.02,d:.4,s:.6},{w:"sine",v:3,t:2,d:0,s:1,g:1}],[{w:"sine",v:.4,a:.06,d:.3,s:.3},{w:"sine",v:7,t:2,d:.2,s:.2,g:1}],[{w:"sine",a:.02,d:.3,s:.3},{w:"sawtooth",v:3,t:2,d:.3,g:1}],[{w:"sine",v:.4,a:.02,d:2,s:.1},{w:"sawtooth",v:8,t:2,f:1,d:.5,g:1}],[{w:"sine",v:.7,a:.03,d:.5,s:.3},{w:"sine",v:.003,t:0,f:4,d:.1,s:.002,g:1}],[{w:"sine",v:.7,a:.02,d:2},{w:"sine",v:1,t:2,f:1,d:.02,g:1}],[{w:"square",v:.3,d:1,s:.5},{w:"square",v:1,f:.2,d:1,s:.5,g:1}],[{w:"sawtooth",v:.3,d:2,s:.5},{w:"square",v:2,f:.1,s:.5,g:1}],[{w:"triangle",v:.5,a:.05,d:2,s:.6},{w:"sine",v:4,t:2,g:1}],[{w:"triangle",v:.3,a:.01,d:2,s:.3},{w:"sine",v:22,t:2,f:1,d:.03,s:.2,g:1}],[{w:"sawtooth",v:.3,d:1,s:.5},{w:"sine",v:11,t:11,a:.2,d:.05,s:.3,g:1}],[{w:"sine",v:.3,a:.06,d:1,s:.5},{w:"sine",v:7,f:1,d:1,s:.2,g:1}],[{w:"sawtooth",v:.3,a:.03,d:.7,s:.3,r:.2},{w:"sawtooth",v:.3,t:.75,d:.7,a:.1,s:.3,r:.2}],[{w:"triangle",v:.3,a:.01,d:.7,s:.5},{w:"square",v:5,t:.5,d:.7,s:.5,g:1}],[{w:"triangle",v:.3,a:.02,d:.3,s:.3,r:.3},{w:"square",v:3,t:4,f:1,a:.02,d:.1,s:1,g:1},{w:"triangle",v:.08,t:.5,a:.1,h:0,d:.1,s:.5,r:.1,b:0,c:0}],[{w:"sine",v:.3,a:.05,d:1,s:.7,r:.3},{w:"sine",v:2,f:1,d:.3,s:1,g:1}],[{w:"square",v:.3,a:.03,d:.5,s:.3,r:.1},{w:"square",v:4,f:1,a:.03,d:.1,g:1}],[{w:"triangle",v:.3,a:.08,d:1,s:.3,r:.1},{w:"square",v:2,f:1,d:.3,s:.3,g:1,t:4,a:.08}],[{w:"sine",v:.3,a:.05,d:1,s:.3,r:.1},{w:"sine",v:.1,t:2.001,f:1,d:1,s:50,g:1}],[{w:"triangle",v:.3,a:.03,d:.7,s:.3,r:.2},{w:"sine",v:12,t:7,f:1,d:.5,s:1.7,g:1}],[{w:"sine",v:.3,a:.05,d:1,s:.3,r:.1},{w:"sawtooth",v:22,t:6,d:.06,s:.3,g:1}],[{w:"triangle",v:.3,a:.05,d:11,r:.3},{w:"triangle",v:1,d:1,s:8,g:1}],[{w:"sawtooth",v:.3,d:4,s:.8,r:.1},{w:"square",v:1,t:2,f:8,a:1,d:1,s:1,r:.1,g:1}],[{w:"triangle",v:.3,d:1,s:.5,t:.8,a:.2,p:1.25,q:.2},{w:"sawtooth",v:.2,a:.2,d:.3,s:1,t:1.2,p:1.25,q:.2}],[{w:"sine",v:.3,d:1,s:.3},{w:"square",v:22,t:11,d:.5,s:.1,g:1}],[{w:"sawtooth",v:.3,a:.04,d:1,s:.8,r:.1},{w:"square",v:1,t:.5,d:1,s:2,g:1}],[{w:"triangle",v:.3,d:1,s:.3},{w:"sine",v:22,t:6,d:.6,s:.05,g:1}],[{w:"sine",v:.6,a:.1,d:.05,s:.4},{w:"sine",v:5,t:5,f:1,d:.05,s:.3,g:1}],[{w:"sine",a:.1,d:.05,s:.4,v:.8},{w:"sine",v:5,t:5,f:1,d:.05,s:.3,g:1}],[{w:"square",v:.3,a:.1,d:.1,s:.4},{w:"square",v:1,f:1,d:.3,s:.1,g:1}],[{w:"sawtooth",v:.3,d:.5,r:.5},{w:"sawtooth",v:11,t:5,d:.05,g:1}],[{w:"square",v:.3,d:.2,r:.2},{w:"square",v:7,t:3,d:.05,g:1}],[{w:"triangle",d:.2,r:.2},{w:"square",v:9,t:3,d:.1,r:.1,g:1}],[{w:"triangle",d:.3,r:.3},{w:"square",v:6,t:3,d:1,r:1,g:1}],[{w:"triangle",v:.4,d:.2,r:.2},{w:"square",v:22,t:12,d:.1,r:.1,g:1}],[{w:"sine",v:.25,a:.02,d:.05,s:.8},{w:"square",v:1,t:2,d:.03,s:11,g:1}],[{w:"sine",v:.3,a:.05,d:11},{w:"square",v:7,t:3,f:1,s:.7,g:1}],[{w:"square",v:.3,a:.05,d:.1,s:.8},{w:"square",v:4,d:.1,s:1.1,g:1}],[{w:"sine",v:.4,d:.3,r:.3},{w:"sine",v:7,t:9,d:.1,r:.1,g:1}],[{w:"sine",v:.7,d:.1,r:.1},{w:"sine",v:22,t:7,d:.05,g:1}],[{w:"sine",v:.6,d:.15,r:.15},{w:"square",v:11,t:3.2,d:.1,r:.1,g:1}],[{w:"sine",v:.8,d:.07,r:.07},{w:"square",v:11,t:7,r:.01,g:1}],[{w:"triangle",v:.7,t:.5,d:.2,r:.2,p:.95},{w:"n0",v:9,g:1,d:.2,r:.2}],[{w:"sine",v:.7,d:.1,r:.1,p:.9},{w:"square",v:14,t:2,d:.005,r:.005,g:1}],[{w:"square",d:.15,r:.15,p:.5},{w:"square",v:4,t:5,d:.001,r:.001,g:1}],[{w:"n1",v:.3,a:1,s:1,d:.15,r:0,t:.5}],[{w:"sine",t:12.5,d:0,r:0,p:.5,v:.3,h:.2,q:.5},{g:1,w:"sine",v:1,t:2,d:0,r:0,s:1},{g:1,w:"n0",v:.2,t:2,a:.6,h:0,d:.1,r:.1,b:0,c:0}],[{w:"n0",v:.2,a:.05,h:.02,d:.02,r:.02}],[{w:"n0",v:.4,a:1,d:1,t:.25}],[{w:"sine",v:.3,a:.1,d:1,s:.5},{w:"sine",v:4,t:0,f:1.5,d:1,s:1,r:.1,g:1},{g:1,w:"sine",v:4,t:0,f:2,a:.6,h:0,d:.1,s:1,r:.1,b:0,c:0}],[{w:"square",v:.3,t:.25,d:11,s:1},{w:"square",v:12,t:0,f:8,d:1,s:1,r:11,g:1}],[{w:"n0",v:.4,t:.5,a:1,d:11,s:1,r:.5},{w:"square",v:1,t:0,f:14,d:1,s:1,r:11,g:1}],[{w:"sine",t:0,f:1221,a:.2,d:1,r:.25,s:1},{g:1,w:"n0",v:3,t:.5,d:1,s:1,r:1}],[{w:"sine",d:.4,r:.4,p:.1,t:2.5,v:1},{w:"n0",v:12,t:2,d:1,r:1,g:1}]],program0:[[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"triangle",v:.5,d:.7}],[{w:"sawtooth",v:.3,d:.7}],[{w:"sawtooth",v:.3,d:.7}],[{w:"sine",v:.5,d:.3,r:.3}],[{w:"triangle",v:.5,d:.3,r:.3}],[{w:"square",v:.2,d:.3,r:.3}],[{w:"square",v:.2,d:.3,r:.3}],[{w:"sine",v:.5,d:.1,r:.1}],[{w:"sine",v:.5,d:.1,r:.1}],[{w:"square",v:.2,d:1,r:1}],[{w:"sawtooth",v:.3,d:.7,r:.7}],[{w:"sine",v:.5,a:.01,s:1}],[{w:"sine",v:.7,d:.02,s:.7}],[{w:"square",v:.2,s:1}],[{w:"triangle",v:.5,a:.01,s:1}],[{w:"square",v:.2,a:.02,s:1}],[{w:"square",v:.2,a:.02,s:1}],[{w:"square",v:.2,a:.02,s:1}],[{w:"square",v:.2,a:.05,s:1}],[{w:"triangle",v:.5,d:.5}],[{w:"square",v:.2,d:.6}],[{w:"square",v:.2,d:.6}],[{w:"triangle",v:.8,d:.6}],[{w:"triangle",v:.4,d:.05}],[{w:"square",v:.2,d:1}],[{w:"square",v:.2,d:1}],[{w:"sine",v:.4,d:.6}],[{w:"triangle",v:.7,d:.4}],[{w:"triangle",v:.7,d:.7}],[{w:"triangle",v:.7,d:.7}],[{w:"triangle",v:.7,d:.7}],[{w:"square",v:.3,d:.2}],[{w:"square",v:.3,d:.2}],[{w:"square",v:.3,d:.1,s:.2}],[{w:"sawtooth",v:.4,d:.1,s:.2}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.3,d:.1}],[{w:"sawtooth",v:.3,d:.5,r:.5}],[{w:"triangle",v:.6,d:.1,r:.1,h:.03,p:.8}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"sawtooth",v:.2,a:.02,s:1}],[{w:"triangle",v:.3,a:.03,s:1}],[{w:"sine",v:.3,a:.03,s:1}],[{w:"triangle",v:.3,a:.05,s:1}],[{w:"sawtooth",v:.5,a:.01,d:.1}],[{w:"square",v:.3,a:.05,d:.2,s:.6}],[{w:"square",v:.3,a:.05,d:.2,s:.6}],[{w:"square",v:.3,a:.05,d:.2,s:.6}],[{w:"square",v:.2,a:.05,d:.01,s:1}],[{w:"square",v:.3,a:.05,s:1}],[{w:"square",v:.3,s:.7}],[{w:"square",v:.3,s:.7}],[{w:"square",v:.3,s:.7}],[{w:"square",v:.3,a:.02,d:2}],[{w:"square",v:.3,a:.02,d:2}],[{w:"square",v:.3,a:.03,d:2}],[{w:"square",v:.3,a:.04,d:2}],[{w:"square",v:.3,a:.02,d:2}],[{w:"square",v:.3,a:.05,d:2}],[{w:"square",v:.3,a:.03,d:2}],[{w:"square",v:.3,a:.03,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"sine",v:.7,a:.02,d:2}],[{w:"square",v:.3,s:.7}],[{w:"sawtooth",v:.4,s:.7}],[{w:"triangle",v:.5,s:.7}],[{w:"sawtooth",v:.4,s:.7}],[{w:"sawtooth",v:.4,d:12}],[{w:"sine",v:.4,a:.06,d:12}],[{w:"sawtooth",v:.4,d:12}],[{w:"sawtooth",v:.4,d:12}],[{w:"sawtooth",v:.3,d:12}],[{w:"triangle",v:.5,d:12}],[{w:"square",v:.3,d:12}],[{w:"triangle",v:.5,a:.08,d:11}],[{w:"sawtooth",v:.5,a:.05,d:11}],[{w:"sawtooth",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"square",v:.3,d:11}],[{w:"sawtooth",v:.5,a:.04,d:11}],[{w:"sawtooth",v:.5,d:11}],[{w:"triangle",v:.5,a:.8,d:11}],[{w:"triangle",v:.5,d:11}],[{w:"square",v:.3,d:11}],[{w:"sawtooth",v:.3,d:1,r:1}],[{w:"sawtooth",v:.5,d:.3}],[{w:"sawtooth",v:.5,d:.3,r:.3}],[{w:"sawtooth",v:.5,d:.3,r:.3}],[{w:"square",v:.3,d:.2,r:.2}],[{w:"square",v:.3,a:.02,d:2}],[{w:"sawtooth",v:.2,a:.02,d:.7}],[{w:"triangle",v:.5,d:1}],[{w:"sawtooth",v:.3,d:.3,r:.3}],[{w:"sine",v:.8,d:.1,r:.1}],[{w:"square",v:.2,d:.1,r:.1,p:1.05}],[{w:"sine",v:.8,d:.05,r:.05}],[{w:"triangle",v:.5,d:.1,r:.1,p:.96}],[{w:"triangle",v:.5,d:.1,r:.1,p:.97}],[{w:"square",v:.3,d:.1,r:.1}],[{w:"n1",v:.3,a:1,s:1,d:.15,r:0,t:.5}],[{w:"triangle",v:.5,d:.03,t:0,f:1332,r:.001,p:1.1}],[{w:"n0",v:.2,t:.1,d:.02,a:.05,h:.02,r:.02}],[{w:"n0",v:.4,a:1,d:1,t:.25}],[{w:"sine",v:.3,a:.8,d:1,t:0,f:1832}],[{w:"triangle",d:.5,t:0,f:444,s:1}],[{w:"n0",v:.4,d:1,t:0,f:22,s:1}],[{w:"n0",v:.5,a:.2,d:11,t:0,f:44}],[{w:"n0",v:.5,t:.25,d:.4,r:.4}]],drummap1:[[{w:"triangle",t:0,f:70,v:1,d:.05,h:.03,p:.9,q:.1},{w:"n0",g:1,t:6,v:17,r:.01,h:0,p:0}],[{w:"triangle",t:0,f:88,v:1,d:.05,h:.03,p:.5,q:.1},{w:"n0",g:1,t:5,v:42,r:.01,h:0,p:0}],[{w:"n0",f:222,p:0,t:0,r:.01,h:0}],[{w:"triangle",v:.3,f:180,d:.05,t:0,h:.03,p:.9,q:.1},{w:"n0",v:.6,t:0,f:70,h:.02,r:.01,p:0},{g:1,w:"square",v:2,t:0,f:360,r:.01,b:0,c:0}],[{w:"square",f:1150,v:.34,t:0,r:.03,h:.025,d:.03},{g:1,w:"n0",t:0,f:13,h:.025,d:.1,s:1,r:.1,v:1}],[{w:"triangle",f:200,v:1,d:.06,t:0,r:.06},{w:"n0",g:1,t:0,f:400,v:12,r:.02,d:.02}],[{w:"triangle",f:100,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.4,h:.015,d:.005,r:.005}],[{w:"n1",f:390,v:.25,r:.01,t:0}],[{w:"triangle",f:120,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.5,h:.015,d:.005,r:.005}],[{w:"n1",v:.25,f:390,r:.03,t:0,h:.005,d:.03}],[{w:"triangle",f:140,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"n1",v:.25,f:390,t:0,d:.2,r:.2},{w:"n0",v:.3,t:0,c:0,f:440,h:.005,d:.05}],[{w:"triangle",f:155,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"triangle",f:180,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"n1",v:.3,f:1200,d:.2,r:.2,h:.05,t:0},{w:"n1",t:0,v:1,d:.1,r:.1,p:1.2,f:440}],[{w:"triangle",f:220,v:.9,d:.12,h:.02,p:.5,t:0,r:.12},{g:1,w:"n0",v:5,t:.3,h:.015,d:.005,r:.005}],[{w:"n1",f:500,v:.15,d:.4,r:.4,h:0,t:0},{w:"n0",v:.1,t:0,r:.01,f:440}],[{w:"n1",v:.3,f:800,d:.2,r:.2,h:.05,t:0},{w:"square",t:0,v:1,d:.1,r:.1,p:.1,f:220,g:1}],[{w:"sine",f:1651,v:.15,d:.2,r:.2,h:0,t:0},{w:"sawtooth",g:1,t:1.21,v:7.2,d:.1,r:11,h:1},{g:1,w:"n0",v:3.1,t:.152,d:.002,r:.002}],null,[{w:"n1",v:.3,f:1200,d:.2,r:.2,h:.05,t:0},{w:"n1",t:0,v:1,d:.1,r:.1,p:1.2,f:440}],null,[{w:"n1",v:.3,f:555,d:.25,r:.25,h:.05,t:0},{w:"n1",t:0,v:1,d:.1,r:.1,f:440,a:.005,h:.02}],[{w:"sawtooth",f:776,v:.2,d:.3,t:0,r:.3},{g:1,w:"n0",v:2,t:0,f:776,a:.005,h:.02,d:.1,s:1,r:.1,c:0},{g:11,w:"sine",v:.1,t:0,f:22,d:.3,r:.3,b:0,c:0}],[{w:"n1",f:440,v:.15,d:.4,r:.4,h:0,t:0},{w:"n0",v:.4,t:0,r:.01,f:440}],null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,[{w:"sine",f:1720,v:.3,d:.02,t:0,r:.02},{w:"square",g:1,t:0,f:2876,v:6,d:.2,s:1,r:.2}],[{w:"sine",f:1720,v:.3,d:.25,t:0,r:.25},{w:"square",g:1,t:0,f:2876,v:6,d:.2,s:1,r:.2}]],drummap0:[[{w:"triangle",t:0,f:110,v:1,d:.05,h:.02,p:.1}],[{w:"triangle",t:0,f:150,v:.8,d:.1,p:.1,h:.02,r:.01}],[{w:"n0",f:392,v:.5,d:.01,p:0,t:0,r:.05}],[{w:"n0",f:33,d:.05,t:0}],[{w:"n0",f:100,v:.7,d:.03,t:0,r:.03,h:.02}],[{w:"n0",f:44,v:.7,d:.02,p:.1,t:0,h:.02}],[{w:"triangle",f:240,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:440,v:.2,r:.01,t:0}],[{w:"triangle",f:270,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:440,v:.2,d:.04,r:.04,t:0}],[{w:"triangle",f:300,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:440,v:.2,d:.1,r:.1,h:.02,t:0}],[{w:"triangle",f:320,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"triangle",f:360,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:150,v:.2,d:.1,r:.1,h:.05,t:0,p:.1}],[{w:"triangle",f:400,v:.9,d:.1,h:.02,p:.1,t:0}],[{w:"n0",f:150,v:.2,d:.1,r:.01,h:.05,t:0,p:.1}],[{w:"n0",f:150,v:.2,d:.1,r:.01,h:.05,t:0,p:.1}],[{w:"n0",f:440,v:.3,d:.1,p:.9,t:0,r:.1}],[{w:"n0",f:200,v:.2,d:.05,p:.9,t:0}],[{w:"n0",f:440,v:.3,d:.12,p:.9,t:0}],[{w:"sine",f:800,v:.4,d:.06,t:0}],[{w:"n0",f:150,v:.2,d:.1,r:.01,h:.05,t:0,p:.1}],[{w:"n0",f:33,v:.3,d:.2,p:.9,t:0}],[{w:"n0",f:300,v:.3,d:.14,p:.9,t:0}],[{w:"sine",f:200,d:.06,t:0}],[{w:"sine",f:150,d:.06,t:0}],[{w:"sine",f:300,t:0}],[{w:"sine",f:300,d:.06,t:0}],[{w:"sine",f:250,d:.06,t:0}],[{w:"square",f:300,v:.3,d:.06,p:.8,t:0}],[{w:"square",f:260,v:.3,d:.06,p:.8,t:0}],[{w:"sine",f:850,v:.5,d:.07,t:0}],[{w:"sine",f:790,v:.5,d:.07,t:0}],[{w:"n0",f:440,v:.3,a:.05,t:0}],[{w:"n0",f:440,v:.3,a:.05,t:0}],[{w:"triangle",f:1800,v:.4,p:.9,t:0,h:.03}],[{w:"triangle",f:1800,v:.3,p:.9,t:0,h:.13}],[{w:"n0",f:330,v:.3,a:.02,t:0,r:.01}],[{w:"n0",f:330,v:.3,a:.02,t:0,h:.04,r:.01}],[{w:"n0",f:440,v:.3,t:0}],[{w:"sine",f:800,t:0}],[{w:"sine",f:700,t:0}],[{w:"n0",f:330,v:.3,t:0}],[{w:"n0",f:330,v:.3,t:0,h:.1,r:.01,p:.7}],[{w:"sine",t:0,f:1200,v:.3,r:.01}],[{w:"sine",t:0,f:1200,v:.3,d:.2,r:.2}]],ready:function(){var g;this.pg=[],this.vol=[],this.ex=[],this.bend=[],this.rpnidx=[],this.brange=[],this.sustain=[],this.notetab=[],this.rhythm=[],this.masterTuningC=0,this.masterTuningF=0,this.tuningC=[],this.tuningF=[],this.scaleTuning=[],this.maxTick=0,this.playTick=0,this.playing=0,this.releaseRatio=3.5;for(var g=0;g<16;++g)this.pg[g]=0,this.vol[g]=3*100*100/(127*127),this.bend[g]=0,this.brange[g]=256,this.tuningC[g]=0,this.tuningF[g]=0,this.scaleTuning[g]=[0,0,0,0,0,0,0,0,0,0,0,0],this.rhythm[g]=0;this.rhythm[9]=1,this.preroll=.2,this.relcnt=0,setInterval((function(){if(++this.relcnt>=3){this.relcnt=0;for(var y=this.notetab.length-1;y>=0;--y){var C=this.notetab[y];this.actx.currentTime>C.e&&(this._pruneNote(C),this.notetab.splice(y,1))}}if(this.playing&&this.song.ev.length>0)for(var x=this.song.ev[this.playIndex];this.actx.currentTime+this.preroll>this.playTime;)if(x.m[0]==65361?(this.song.tempo=x.m[1],this.tick2Time=4*60/this.song.tempo/this.song.timebase):this.send(x.m,this.playTime),++this.playIndex,this.playIndex>=this.song.ev.length)if(this.loop)x=this.song.ev[this.playIndex=0],this.playTick=x.t;else{this.playTick=this.maxTick,this.playing=0;break}else x=this.song.ev[this.playIndex],this.playTime+=(x.t-this.playTick)*this.tick2Time,this.playTick=x.t}).bind(this),60),this.isReady=1},setMasterVol:function(g){g!=null&&(this.masterVol=g),this.out&&(this.out.gain.value=this.masterVol)},setReverbLev:function(g){g!=null&&(this.reverbLev=g);var y=parseFloat(this.reverbLev);this.rev&&!isNaN(y)&&(this.rev.gain.value=y*8)},setLoop:function(g){this.loop=g},setVoices:function(g){this.voices=g},reset:function(){for(var g=0;g<16;++g)this.setProgram(g,0),this.setBendRange(g,256),this.setModulation(g,0),this.setChVol(g,100),this.setPan(g,64),this.resetAllControllers(g),this.allSoundOff(g),this.rhythm[g]=0,this.tuningC[g]=0,this.tuningF[g]=0,this.scaleTuning[g]=[0,0,0,0,0,0,0,0,0,0,0,0];this.masterTuningC=0,this.masterTuningF=0,this.rhythm[9]=1},setQuality:function(g){var y;for(g!=null&&(this.quality=g),y=0;y<128;++y)this.setTimbre(0,y,this.program0[y]);for(y=0;y<this.drummap0.length;++y)this.setTimbre(1,y+35,this.drummap0[y]);if(this.quality){for(y=0;y<this.program1.length;++y)this.setTimbre(0,y,this.program1[y]);for(y=0;y<this.drummap.length;++y)this.drummap1[y]&&this.setTimbre(1,y+35,this.drummap1[y])}},setTimbre:function(g,y,C){var x={g:0,w:"sine",t:1,f:0,v:.5,a:0,h:.01,d:.01,s:0,r:.05,p:1,q:1,k:0};function w(S){for(y=0;y<S.length;++y)for(p in x)(!S[y].hasOwnProperty(p)||typeof S[y][p]>"u")&&(S[y][p]=x[p]);return S}g&&y>=35&&y<=81&&(this.drummap[y-35]=w(C)),g==0&&y>=0&&y<=127&&(this.program[y]=w(C))},_pruneNote:function(g){for(var y=g.o.length-1;y>=0;--y){if(g.o[y].frequency?g.o[y].frequency.cancelScheduledValues(0):g.o[y].playbackRate.cancelScheduledValues(0),g.g[y].gain.cancelScheduledValues(0),g.o[y].stop(),g.o[y].detune)try{this.chmod[g.ch].disconnect(g.o[y].detune)}catch{}g.g[y].gain.value=0}},_limitVoices:function(g,y){this.notetab.sort(function(w,S){return w.f!=S.f?w.f-S.f:w.e!=S.e?S.e-w.e:S.t-w.t});for(var C=this.notetab.length-1;C>=0;--C){var x=this.notetab[C];(this.actx.currentTime>x.e||C>=this.voices-1)&&(this._pruneNote(x),this.notetab.splice(C,1))}},_note:function(g,y,C,x,w){var S,E,R,k=[],A=[],_=[],D=[],j=[],Z=440*Math.pow(2,(C-69+this.masterTuningC+this.tuningC[y]+(this.masterTuningF+this.tuningF[y]/8192+this.scaleTuning[y][C%12]))/12);this._limitVoices(y,C);for(var F=0;F<w.length;++F){R=w[F];var V=g+R.a+R.h;switch(R.g==0?(S=this.chvol[y],E=x*x/16384,D[F]=Z*R.t+R.f):R.g>10?(S=A[R.g-11].gain,E=1,D[F]=D[R.g-11]*R.t+R.f):k[R.g-1].frequency?(S=k[R.g-1].frequency,E=D[R.g-1],D[F]=D[R.g-1]*R.t+R.f):(S=k[R.g-1].playbackRate,E=D[R.g-1]/440,D[F]=D[R.g-1]*R.t+R.f),R.w[0]){case"n":k[F]=this.actx.createBufferSource(),k[F].buffer=this.noiseBuf[R.w],k[F].loop=!0,k[F].playbackRate.value=D[F]/440,R.p!=1&&this._setParamTarget(k[F].playbackRate,D[F]/440*R.p,g,R.q),k[F].detune&&(this.chmod[y].connect(k[F].detune),k[F].detune.value=this.bend[y]);break;default:k[F]=this.actx.createOscillator(),k[F].frequency.value=D[F],R.p!=1&&this._setParamTarget(k[F].frequency,D[F]*R.p,g,R.q),R.w[0]=="w"?k[F].setPeriodicWave(this.wave[R.w]):k[F].type=R.w,k[F].detune&&(this.chmod[y].connect(k[F].detune),k[F].detune.value=this.bend[y]);break}A[F]=this.actx.createGain(),j[F]=R.r,k[F].connect(A[F]),A[F].connect(S),_[F]=E*R.v,R.k&&(_[F]*=Math.pow(2,(C-60)/12*R.k)),R.a?(A[F].gain.value=0,A[F].gain.setValueAtTime(0,g),A[F].gain.linearRampToValueAtTime(_[F],g+R.a)):A[F].gain.setValueAtTime(_[F],g),this._setParamTarget(A[F].gain,R.s*_[F],V,R.d),k[F].start(g),this.rhythm[y]&&(k[F].onended=function(X,te){return function(){te&&X.disconnect(te)}}(this.chmod[y],k[F].detune),k[F].stop(g+w[0].d*this.releaseRatio))}this.rhythm[y]||this.notetab.push({t:g,e:99999,ch:y,n:C,o:k,g:A,t2:g+R.a,v:_,r:j,f:0})},_setParamTarget:function(g,y,C,x){x!=0?g.setTargetAtTime(y,C,x):g.setValueAtTime(y,C)},_releaseNote:function(g,y){if(g.ch!=9)for(var C=g.g.length-1;C>=0;--C)g.g[C].gain.cancelScheduledValues(y),y==g.t2?g.g[C].gain.setValueAtTime(g.v[C],y):y<g.t2&&g.g[C].gain.setValueAtTime(g.v[C]*(y-g.t)/(g.t2-g.t),y),this._setParamTarget(g.g[C].gain,0,y,g.r[C]);g.e=y+g.r[0]*this.releaseRatio,g.f=1},setModulation:function(g,y,C){this.chmod[g].gain.setValueAtTime(y*100/127,this._tsConv(C))},setChVol:function(g,y,C){this.vol[g]=3*y*y/(127*127),this.chvol[g].gain.setValueAtTime(this.vol[g]*this.ex[g],this._tsConv(C))},setPan:function(g,y,C){this.chpan[g]&&this.chpan[g].pan.setValueAtTime((y-64)/64,this._tsConv(C))},setExpression:function(g,y,C){this.ex[g]=y*y/(127*127),this.chvol[g].gain.setValueAtTime(this.vol[g]*this.ex[g],this._tsConv(C))},setSustain:function(g,y,C){if(this.sustain[g]=y,C=this._tsConv(C),y<64)for(var x=this.notetab.length-1;x>=0;--x){var w=this.notetab[x];C>=w.t&&w.ch==g&&w.f==1&&this._releaseNote(w,C)}},allSoundOff:function(g){for(var y=this.notetab.length-1;y>=0;--y){var C=this.notetab[y];C.ch==g&&(this._pruneNote(C),this.notetab.splice(y,1))}},resetAllControllers:function(g){this.bend[g]=0,this.ex[g]=1,this.rpnidx[g]=16383,this.sustain[g]=0,this.chvol[g]&&(this.chvol[g].gain.value=this.vol[g]*this.ex[g],this.chmod[g].gain.value=0)},setBendRange:function(g,y){this.brange[g]=y},setProgram:function(g,y){this.debug&&console.log("Pg("+g+")="+y),this.pg[g]=y},setBend:function(g,y,C){C=this._tsConv(C);var x=this.brange[g]*100/127;this.bend[g]=(y-8192)*x/8192;for(var w=this.notetab.length-1;w>=0;--w){var S=this.notetab[w];if(S.ch==g)for(var E=S.o.length-1;E>=0;--E)S.o[E].frequency&&S.o[E].detune&&S.o[E].detune.setValueAtTime(this.bend[g],C)}},noteOn:function(g,y,C,x){if(C==0){this.noteOff(g,y,x);return}if(x=this._tsConv(x),this.rhythm[g]){y>=35&&y<=81&&this._note(x,g,y,C,this.drummap[y-35]);return}this._note(x,g,y,C,this.program[this.pg[g]])},noteOff:function(g,y,C){if(!this.rhythm[g]){C=this._tsConv(C);for(var x=this.notetab.length-1;x>=0;--x){var w=this.notetab[x];C>=w.t&&w.ch==g&&w.n==y&&w.f==0&&(w.f=1,this.sustain[g]<64&&this._releaseNote(w,C))}}},_tsConv:function(g){return g==null||g<=0?(g=0,this.actx&&(g=this.actx.currentTime)):this.tsmode&&(g=g*.001-this.tsdiff),g},setTsMode:function(g){this.tsmode=g},send:function(g,y){var C=g[0]&15,x=g[0]&-16;if(!(x<128||x>=256))switch(this.audioContext.state=="suspended"&&this.audioContext.resume(),x){case 176:switch(g[1]){case 1:this.setModulation(C,g[2],y);break;case 7:this.setChVol(C,g[2],y);break;case 10:this.setPan(C,g[2],y);break;case 11:this.setExpression(C,g[2],y);break;case 64:this.setSustain(C,g[2],y);break;case 98:case 99:this.rpnidx[C]=16383;break;case 100:this.rpnidx[C]=this.rpnidx[C]&16256|g[2];break;case 101:this.rpnidx[C]=this.rpnidx[C]&127|g[2]<<7;break;case 6:switch(this.rpnidx[C]){case 0:this.brange[C]=(g[2]<<7)+(this.brange[C]&127);break;case 1:this.tuningF[C]=(g[2]<<7)+(this.tuningF[C]+8192&127)-8192;break;case 2:this.tuningC[C]=g[2]-64;break}break;case 38:switch(this.rpnidx[C]){case 0:this.brange[C]=this.brange[C]&16256|g[2];break;case 1:this.tuningF[C]=(this.tuningF[C]+8192&16256|g[2])-8192;break}break;case 120:case 123:case 124:case 125:case 126:case 127:this.allSoundOff(C);break;case 121:this.resetAllControllers(C);break}break;case 192:this.setProgram(C,g[1]);break;case 224:this.setBend(C,g[1]+(g[2]<<7),y);break;case 144:this.noteOn(C,g[1],g[2],y);break;case 128:this.noteOff(C,g[1],y);break;case 240:if(g[0]==255){this.reset();break}if(g[0]!=254&&this.debug)for(var w=[],S=0;S<g.length;++S)w.push(g[S].toString(16));if(g[0]==240&&(g[1]==127&&g[3]==4&&(g[4]==3&&g.length>=8&&(this.masterTuningF=(g[6]*128+g[5]-8192)/8192),g[4]==4&&g.length>=8&&(this.masterTuningC=g[6]-64)),g[1]==65&&g[3]==66&&g[4]==18&&g[5]==64))if((g[6]&240)==16&&g.length==11){var E=[9,0,1,2,3,4,5,6,7,8,10,11,12,13,14,15][g[6]&15];g[7]==21?this.rhythm[E]=g[8]:g[7]>=64&&g[7]<=75&&(this.scaleTuning[E][g[7]-64]=(g[8]-64)/100)}else g[6]==0&&(g[7]==0&&g.length==14?this.masterTuningF=(g[8]*4096+g[9]*256+g[10]*16+g[11]-1024)/1e3:g[7]==5&&g.length==11&&(this.masterTuningC=g[8]-64));break}},_createWave:function(g){for(var y=new Float32Array(g.length),C=new Float32Array(g.length),x=1;x<g.length;++x)y[x]=g[x];return this.actx.createPeriodicWave(C,y)},getAudioContext:function(){return this.actx},setAudioContext:function(g,y){this.audioContext=this.actx=g,this.dest=y,y||(this.dest=g.destination),this.tsdiff=performance.now()*.001-this.actx.currentTime,this.out=this.actx.createGain(),this.comp=this.actx.createDynamicsCompressor();var C=this.actx.sampleRate*.5|0;this.convBuf=this.actx.createBuffer(2,C,this.actx.sampleRate),this.noiseBuf={},this.noiseBuf.n0=this.actx.createBuffer(1,C,this.actx.sampleRate),this.noiseBuf.n1=this.actx.createBuffer(1,C,this.actx.sampleRate);for(var x=this.convBuf.getChannelData(0),w=this.convBuf.getChannelData(1),S=this.noiseBuf.n0.getChannelData(0),E=this.noiseBuf.n1.getChannelData(0),R=0;R<C;++R)R/C<Math.random()&&(x[R]=Math.exp(-3*R/C)*(Math.random()-.5)*.5,w[R]=Math.exp(-3*R/C)*(Math.random()-.5)*.5),S[R]=Math.random()*2-1;for(var k=0;k<64;++k){var A=Math.random()*10+1,_=Math.random()*10+1;for(R=0;R<C;++R){var D=Math.sin(R/C*2*Math.PI*440*A)*Math.sin(R/C*2*Math.PI*440*_);E[R]+=D/8}}for(this.useReverb&&(this.conv=this.actx.createConvolver(),this.conv.buffer=this.convBuf,this.rev=this.actx.createGain(),this.rev.gain.value=this.reverbLev,this.out.connect(this.conv),this.conv.connect(this.rev),this.rev.connect(this.comp)),this.setMasterVol(),this.out.connect(this.comp),this.comp.connect(this.dest),this.chvol=[],this.chmod=[],this.chpan=[],this.wave={w9999:this._createWave("w9999")},this.lfo=this.actx.createOscillator(),this.lfo.frequency.value=5,this.lfo.start(0),R=0;R<16;++R)this.chvol[R]=this.actx.createGain(),this.actx.createStereoPanner?(this.chpan[R]=this.actx.createStereoPanner(),this.chvol[R].connect(this.chpan[R]),this.chpan[R].connect(this.out)):(this.chpan[R]=null,this.chvol[R].connect(this.out)),this.chmod[R]=this.actx.createGain(),this.lfo.connect(this.chmod[R]),this.pg[R]=0,this.resetAllControllers(R);this.setReverbLev(),this.reset()}};for(var p in this.sy.properties)this[p]=this.sy.properties[p].value;this.setQuality(1),h&&(h.useReverb!=null&&(this.useReverb=h.useReverb),h.quality!=null&&this.setQuality(h.quality),h.voices!=null&&this.setVoices(h.voices)),this.ready()}function o(h,p,g){if(typeof p>"u")return o(h,[],[]);if(h instanceof Object){for(var y=0;y<p.length;y++)if(p[y]===h)return g[y];var C;h instanceof Array?C=[]:C={},p.push(h),g.push(C);for(var x in h)h.hasOwnProperty(x)&&(C[x]=o(h[x],p,g));return C}return h}var c;function s(){return c||(c=t.lib.getAudioContext()),!!c}var l={},d={};d._info=function(h){return h||(h="JZZ.synth.Tiny"),{type:"Web Audio",name:h,manufacturer:"virtual",version:r}},d._openOut=function(h,p){if(s(),!c){h._crash("AudioContext not supported");return}var g;typeof p<"u"?(p=""+p,l[p]||(l[p]=new i),g=l[p]):g=new i,g.setAudioContext(c),h.plug=function(y){y&&(y.context instanceof AudioContext||y.context instanceof webkitAudioContext)&&g.setAudioContext(y.context,y)},h.setSynth=function(y,C,x){g.setTimbre(!!x,y,o(C))},h.getSynth=function(y,C){return o(C?g.drummap[y-35]:g.program[y])},h._info=d._info(p),h._receive=function(y){g.send(y)},h._resume()},t.synth.Tiny=function(h){return t.lib.openMidiOut(h,d)},t.synth.Tiny.register=function(h){return s()?t.lib.registerMidiOut(h,d):!1},t.synth.Tiny.version=function(){return r}})}(i0)),i0.exports}var NF=MF();const hl=class hl{constructor(){oe(this,"isInitialized",!1);oe(this,"virtualPort",null);oe(this,"portName","Virtual Synthesizer")}static getInstance(){return hl.instance||(hl.instance=new hl),hl.instance}async initialize(){if(this.isInitialized)return!0;try{const e=await Hd();return NF.Tiny(Hd),Hd.synth.Tiny.register(this.portName),e.refresh(),console.log(`Virtual MIDI synthesizer registered as: ${this.portName}`),this.isInitialized=!0,!0}catch(e){return console.error("Failed to initialize virtual MIDI synthesizer:",e),!1}}async getVirtualPort(){if(!this.isInitialized&&!await this.initialize())return null;try{return this.virtualPort=await Hd().openMidiOut(this.portName),this.virtualPort}catch(e){return console.error("Failed to open virtual MIDI port:",e),null}}getPortName(){return this.portName}get initialized(){return this.isInitialized}close(){this.virtualPort&&(this.virtualPort.close(),this.virtualPort=null)}};oe(hl,"instance");let cy=hl;const Qs=cy.getInstance();var ly=(n=>(n.Off="off",n.Unfocused="unfocused",n.All="all",n))(ly||{}),es=(n=>(n.SetGeneral="SET_GENERAL",n.SetSpeech="SET_SPEECH",n.SetSound="SET_SOUND",n.SetChannels="SET_CHANNELS",n.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",n.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",n.SetMidi="SET_MIDI",n))(es||{});class OF{constructor(){oe(this,"state");oe(this,"listeners",new Set);oe(this,"dispatch",e=>{this.state=this.reducer(this.state,e),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(t=>t())});var i;const e=localStorage.getItem("preferences"),t=this.getInitialPreferences();let r=e?JSON.parse(e):null;((i=r==null?void 0:r.general)==null?void 0:i.volume)!==void 0&&(r!=null&&r.sound)&&(r.sound.volume||(r.sound.volume=r.general.volume),delete r.general.volume),this.state=r?this.mergePreferences(t,r):t}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},sound:{muteInBackground:!1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0},midi:{enabled:!1}}}mergePreferences(e,t){return{...e,general:{...e.general,...t.general},speech:{...e.speech,...t.speech},sound:{...e.sound,...t.sound},channels:t.channels?{...e.channels,...t.channels}:e.channels,editor:{...e.editor,...t.editor},midi:{...e.midi,...t.midi}}}reducer(e,t){switch(t.type){case"SET_GENERAL":return{...e,general:t.data};case"SET_SPEECH":return{...e,speech:t.data};case"SET_SOUND":return{...e,sound:t.data};case"SET_CHANNELS":return{...e,channels:t.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...e,editor:{...e.editor,autocompleteEnabled:t.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...e,editor:{...e.editor,accessibilityMode:t.data}};case"SET_MIDI":return{...e,midi:t.data};default:return e}}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}}const dr=new OF;class FF{constructor(){oe(this,"jzz",null);oe(this,"inputDevice",null);oe(this,"outputDevice",null);oe(this,"inputCallback",null);oe(this,"deviceChangeCallbacks",new Set);oe(this,"deviceWatcher",null);oe(this,"connectionState",{inputConnected:!1,outputConnected:!1});oe(this,"intentionalDisconnectFlags",{input:!1,output:!1})}async initialize(){try{return this.jzz=await Hd(),console.log("JZZ MIDI engine initialized"),this.deviceWatcher=this.jzz.onChange(e=>{const t=this.processDeviceChanges(e);this.deviceChangeCallbacks.forEach(r=>r(t)),this.handleDeviceDisconnections(t)}),await this.attemptAutoReconnect(),!0}catch(e){return console.error("Failed to initialize JZZ MIDI engine:",e),!1}}getInputDevices(){if(!this.jzz)return[];const e=[],t=this.jzz.info();return t&&t.inputs&&t.inputs.forEach(r=>{e.push({id:r.id||r.name,name:r.name||"Unknown Input Device"})}),e}getOutputDevices(){const e=[];if(Qs.initialized&&e.push({id:"virtual-synth",name:Qs.getPortName()}),this.jzz){const t=this.jzz.info();t&&t.outputs&&t.outputs.forEach(r=>{e.push({id:r.id||r.name,name:r.name||"Unknown Output Device"})})}return e}async connectInputDevice(e,t){if(!this.jzz)return!1;try{this.inputDevice&&this.inputDevice.close(),this.inputDevice=await this.jzz.openMidiIn(e),this.inputCallback=t,this.inputDevice.connect(o=>{var g;const c=o.data||o,s=c[0];if(s===254)return;const l=s&240,d=s&15,h={hex:Array.from(c).map(y=>y.toString(16).padStart(2,"0").toUpperCase()).join(" "),data:new Uint8Array(c),type:this.getMidiMessageType(s)},p={rawData:h};if(l===144||l===128){const y=c[1],C=c[2],x=l===144&&C>0;p.note={note:y,velocity:C,on:x,channel:d}}else if(l===176){const y=c[1],C=c[2];p.controlChange={controller:y,value:C,channel:d}}else if(l===192){const y=c[1];p.programChange={program:y,channel:d}}else(s&240)===240?p.systemMessage={type:this.getSystemMessageType(s),data:Array.from(c)}:p.raw=h;(g=this.inputCallback)==null||g.call(this,p)}),this.connectionState.inputConnected=!0,this.connectionState.inputDeviceId=e;const i=this.getInputDevices().find(o=>o.id===e);return this.connectionState.inputDeviceName=(i==null?void 0:i.name)||"Unknown Device",dr.dispatch({type:"SET_MIDI",data:{...dr.getState().midi,lastInputDeviceId:e}}),this.intentionalDisconnectFlags.input=!1,console.log(`Connected to MIDI input: ${this.connectionState.inputDeviceName}`),!0}catch(r){return console.error("Failed to connect to MIDI input:",r),!1}}async connectOutputDevice(e){var t,r;try{if(this.outputDevice&&((r=(t=this.outputDevice).close)==null||r.call(t)),e==="virtual-synth"){const c=await Qs.getVirtualPort();return c?(this.outputDevice=c,this.connectionState.outputConnected=!0,this.connectionState.outputDeviceId=e,this.connectionState.outputDeviceName=Qs.getPortName(),dr.dispatch({type:"SET_MIDI",data:{...dr.getState().midi,lastOutputDeviceId:e}}),this.intentionalDisconnectFlags.output=!1,console.log(`Connected to virtual MIDI synthesizer: ${Qs.getPortName()}`),!0):!1}if(!this.jzz)return!1;this.outputDevice=await this.jzz.openMidiOut(e),this.connectionState.outputConnected=!0,this.connectionState.outputDeviceId=e;const o=this.getOutputDevices().find(c=>c.id===e);return this.connectionState.outputDeviceName=(o==null?void 0:o.name)||"Unknown Device",dr.dispatch({type:"SET_MIDI",data:{...dr.getState().midi,lastOutputDeviceId:e}}),this.intentionalDisconnectFlags.output=!1,console.log(`Connected to MIDI output: ${this.connectionState.outputDeviceName}`),!0}catch(i){return console.error("Failed to connect to MIDI output:",i),!1}}sendNote(e){if(!this.outputDevice)return;const t=e.channel||0,r=e.on?144|t:128|t,i=e.on?Math.max(1,Math.min(127,e.velocity)):0;this.outputDevice.send([r,e.note,i])}sendRawMessage(e){this.outputDevice&&this.outputDevice.send(e)}sendAllNotesOff(){if(this.outputDevice)for(let e=0;e<16;e++)this.outputDevice.send([176|e,123,0]),this.outputDevice.send([176|e,120,0])}disconnectDevice(e){var t,r,i,o;e==="input"?(this.inputDevice&&((r=(t=this.inputDevice).close)==null||r.call(t),this.inputDevice=null),this.inputCallback=null,this.connectionState.inputConnected=!1,this.connectionState.inputDeviceId=void 0,this.connectionState.inputDeviceName=void 0,console.log("Disconnected input device")):e==="output"&&(this.outputDevice&&((o=(i=this.outputDevice).close)==null||o.call(i),this.outputDevice=null),this.connectionState.outputConnected=!1,this.connectionState.outputDeviceId=void 0,this.connectionState.outputDeviceName=void 0,console.log("Disconnected output device"))}disconnectWithIntent(e){this.setIntentionalDisconnect(e),e==="input"?this.disconnectDevice("input"):e==="output"?this.disconnectDevice("output"):this.disconnect()}disconnect(){var e,t,r,i;this.inputDevice&&((t=(e=this.inputDevice).close)==null||t.call(e),this.inputDevice=null),this.outputDevice&&((i=(r=this.outputDevice).close)==null||i.call(r),this.outputDevice=null),this.inputCallback=null,this.connectionState.inputConnected=!1,this.connectionState.outputConnected=!1,this.connectionState.inputDeviceId=void 0,this.connectionState.outputDeviceId=void 0,this.connectionState.inputDeviceName=void 0,this.connectionState.outputDeviceName=void 0}get isSupported(){return!0}get isInitialized(){return!!this.jzz}get hasInputDevice(){return this.connectionState.inputConnected}get hasOutputDevice(){return this.connectionState.outputConnected}get connectionStatus(){return{...this.connectionState}}get intentionalDisconnectStatus(){return{...this.intentionalDisconnectFlags}}onDeviceChange(e){return this.deviceChangeCallbacks.add(e),()=>this.deviceChangeCallbacks.delete(e)}refresh(){this.jzz&&this.jzz.refresh()}processDeviceChanges(e){var r,i,o,c;const t={inputs:{added:[],removed:[]},outputs:{added:[],removed:[]}};return(r=e.inputs)!=null&&r.added&&e.inputs.added.forEach(s=>{t.inputs.added.push({id:s.id||s.name,name:s.name||"Unknown Input Device"})}),(i=e.inputs)!=null&&i.removed&&e.inputs.removed.forEach(s=>{t.inputs.removed.push({id:s.id||s.name,name:s.name||"Unknown Input Device"})}),(o=e.outputs)!=null&&o.added&&e.outputs.added.forEach(s=>{t.outputs.added.push({id:s.id||s.name,name:s.name||"Unknown Output Device"})}),(c=e.outputs)!=null&&c.removed&&e.outputs.removed.forEach(s=>{t.outputs.removed.push({id:s.id||s.name,name:s.name||"Unknown Output Device"})}),t}handleDeviceDisconnections(e){this.connectionState.inputConnected&&this.connectionState.inputDeviceId&&e.inputs.removed.some(r=>r.id===this.connectionState.inputDeviceId)&&(console.log(`Input device ${this.connectionState.inputDeviceName} was disconnected`),this.connectionState.inputConnected=!1,this.inputDevice=null),this.connectionState.outputConnected&&this.connectionState.outputDeviceId&&e.outputs.removed.some(r=>r.id===this.connectionState.outputDeviceId)&&(console.log(`Output device ${this.connectionState.outputDeviceName} was disconnected`),this.connectionState.outputConnected=!1,this.outputDevice=null)}async attemptAutoReconnect(){const e=dr.getState().midi;if(e.lastInputDeviceId&&!this.intentionalDisconnectFlags.input){const r=this.getInputDevices().find(i=>i.id===e.lastInputDeviceId);r&&console.log(`Input device available for auto-reconnect: ${r.name}`)}else e.lastInputDeviceId&&this.intentionalDisconnectFlags.input&&console.log("Skipping input auto-reconnect due to intentional disconnect");if(e.lastOutputDeviceId&&!this.intentionalDisconnectFlags.output){const r=this.getOutputDevices().find(i=>i.id===e.lastOutputDeviceId);r&&(console.log(`Attempting to auto-reconnect to output device: ${r.name}`),await this.connectOutputDevice(e.lastOutputDeviceId))}else e.lastOutputDeviceId&&this.intentionalDisconnectFlags.output&&console.log("Skipping output auto-reconnect due to intentional disconnect")}async attemptAutoReconnectInput(e){const t=dr.getState().midi;if(t.lastInputDeviceId&&!this.intentionalDisconnectFlags.input){const i=this.getInputDevices().find(o=>o.id===t.lastInputDeviceId);if(i)return console.log(`Attempting to auto-reconnect to input device: ${i.name}`),await this.connectInputDevice(t.lastInputDeviceId,e)}else t.lastInputDeviceId&&this.intentionalDisconnectFlags.input&&console.log("Skipping input auto-reconnect due to intentional disconnect");return!1}canReconnectToDevice(e,t){return(t==="input"?this.getInputDevices():this.getOutputDevices()).some(i=>i.id===e)}async attemptReconnect(e,t){return t==="input"&&this.inputCallback?await this.connectInputDevice(e,this.inputCallback):t==="output"?await this.connectOutputDevice(e):!1}setIntentionalDisconnect(e){(e==="input"||e==="both")&&(this.intentionalDisconnectFlags.input=!0),(e==="output"||e==="both")&&(this.intentionalDisconnectFlags.output=!0),console.log(`Set intentional disconnect flag for: ${e}`)}resetIntentionalDisconnectFlags(){this.intentionalDisconnectFlags.input=!1,this.intentionalDisconnectFlags.output=!1,console.log("Reset intentional disconnect flags")}shutdown(){this.disconnect(),this.deviceWatcher&&(this.deviceWatcher.disconnect(),this.deviceWatcher=null),this.jzz&&(this.jzz.close(),this.jzz=null),this.deviceChangeCallbacks.clear()}getMidiMessageType(e){const t=e&240,r=(e&15)+1;switch(t){case 128:return`Note Off Ch.${r}`;case 144:return`Note On Ch.${r}`;case 160:return`Polyphonic Aftertouch Ch.${r}`;case 176:return`Control Change Ch.${r}`;case 192:return`Program Change Ch.${r}`;case 208:return`Channel Aftertouch Ch.${r}`;case 224:return`Pitch Bend Ch.${r}`;case 240:return this.getSystemMessageType(e);default:return`Unknown (${e.toString(16).toUpperCase()})`}}getSystemMessageType(e){switch(e){case 240:return"System Exclusive";case 241:return"MIDI Time Code Quarter Frame";case 242:return"Song Position Pointer";case 243:return"Song Select";case 246:return"Tune Request";case 247:return"End of Exclusive";case 248:return"Timing Clock";case 250:return"Start";case 251:return"Continue";case 252:return"Stop";case 254:return"Active Sensing";case 255:return"Reset";default:return`System (${e.toString(16).toUpperCase()})`}}}const en=new FF;class BF extends Yn{constructor(t){super(t);oe(this,"packageName","Client.Midi");oe(this,"packageVersion",1);oe(this,"activeNotes",new Map);oe(this,"isAdvertised",!1);oe(this,"debugCallback")}get enabled(){return dr.getState().midi.enabled}async ensureInitialized(){if(this.isInitialized)return!0;if(!en.isSupported)return console.log("MIDI not supported in this browser"),!1;const t=await en.initialize();return t&&(console.log("MIDI service initialized"),await en.attemptAutoReconnectInput(r=>{this.handleInputMessage(r)})),t}get isInitialized(){return en.isInitialized}async connectInputDevice(t){return await this.ensureInitialized()?await en.connectInputDevice(t,i=>{this.handleInputMessage(i)}):!1}async connectOutputDevice(t){return await this.ensureInitialized()?await en.connectOutputDevice(t):!1}handleInputMessage(t){let r="";const i=t.rawData.hex,o=t.rawData.type;if(t.note){const c={note:t.note.note,velocity:t.note.velocity,on:t.note.on,channel:t.note.channel};this.sendData("Note",c),r=`Client.Midi.Note ${JSON.stringify(c)}`}else if(t.controlChange){const c={controller:t.controlChange.controller,value:t.controlChange.value,channel:t.controlChange.channel};this.sendData("ControlChange",c),r=`Client.Midi.ControlChange ${JSON.stringify(c)}`}else if(t.programChange){const c={program:t.programChange.program,channel:t.programChange.channel};this.sendData("ProgramChange",c),r=`Client.Midi.ProgramChange ${JSON.stringify(c)}`}else if(t.systemMessage){const c={type:t.systemMessage.type,data:t.systemMessage.data};this.sendData("SystemMessage",c),r=`Client.Midi.SystemMessage ${JSON.stringify(c)}`}else if(t.raw){const c={hex:t.raw.hex,data:Array.from(t.raw.data),type:t.raw.type};this.sendData("RawMessage",c),r=`Client.Midi.RawMessage ${JSON.stringify(c)}`}this.debugCallback&&r&&this.debugCallback(i,o,r)}sendNoteToServer(t,r){const i={note:t.note,velocity:t.velocity,on:t.on,channel:t.channel};r!==void 0&&(i.duration=r),this.sendData("Note",i)}handleNote(t){const r={note:t.note,velocity:t.velocity,on:t.on,channel:t.channel},i=`${t.note}_${t.channel||0}`;if(this.activeNotes.has(i)&&(clearTimeout(this.activeNotes.get(i)),this.activeNotes.delete(i)),en.sendNote(r),t.on&&t.duration){const o=setTimeout(()=>{en.sendNote({...r,on:!1,velocity:0}),this.activeNotes.delete(i)},t.duration);this.activeNotes.set(i,o)}}handleControlChange(t){if(en.hasOutputDevice){const r=176|t.channel;en.sendRawMessage([r,t.controller,t.value])}}handleProgramChange(t){if(en.hasOutputDevice){const r=192|t.channel;en.sendRawMessage([r,t.program])}}handleSystemMessage(t){en.hasOutputDevice&&en.sendRawMessage(t.data)}handleRawMessage(t){en.hasOutputDevice&&en.sendRawMessage(t.data)}handleEnable(t){console.log("Server MIDI enable status:",t.enabled)}advertiseMidiSupport(){if(!this.isAdvertised){const t=this.client.gmcpHandlers["Core.Supports"];t&&(t.sendAdd([{name:"Client.Midi",version:this.packageVersion||1}]),this.isAdvertised=!0,console.log("Advertised MIDI support to server"))}}unadvertiseMidiSupport(){if(this.isAdvertised){const t=this.client.gmcpHandlers["Core.Supports"];t&&(t.sendRemove(["Client.Midi"]),this.isAdvertised=!1,console.log("Removed MIDI support advertisement from server"))}}sendMidiCapability(){this.sendData("Enable",{enabled:en.isSupported&&en.isInitialized})}sendManualNote(t,r,i,o,c){const s={note:t,velocity:r,on:i,channel:o||0};this.sendNoteToServer(s,c)}sendAllNotesOff(){en.sendAllNotesOff(),this.activeNotes.forEach(t=>{clearTimeout(t)}),this.activeNotes.clear()}async getInputDevices(){return await this.ensureInitialized()?en.getInputDevices():[]}async getOutputDevices(){return await this.ensureInitialized()?en.getOutputDevices():[]}get hasInputDevice(){return en.hasInputDevice}get hasOutputDevice(){return en.hasOutputDevice}setDebugCallback(t){this.debugCallback=t}shutdown(){en.disconnect(),this.activeNotes.forEach(t=>{clearTimeout(t)}),this.activeNotes.clear()}}class LF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Client.Speech")}handleSpeak(t){const r=new SpeechSynthesisUtterance(t.text);r.rate=t.rate,r.pitch=t.pitch,r.volume=t.volume,speechSynthesis.speak(r)}}class UF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Comm.Channel");oe(this,"channels",[])}handleList(t){this.channels=t}sendList(){this.sendData("List")}handleText(t){console.log(`Received Comm.Channel.Text on ${t.channel} from ${t.talker}: ${t.text}`),this.client.emit("channelText",t),t.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${t.talker}`,`${t.text}`))}handlePlayers(t){console.log("Received Comm.Channel.Players:",t),this.client.emit("channelPlayers",t)}sendPlayersRequest(){this.sendData("Players","")}sendEnable(t){this.sendData("Enable",t)}handleStart(t){console.log(`Received Comm.Channel.Start for ${t}`),this.client.emit("channelStart",t)}handleEnd(t){console.log(`Received Comm.Channel.End for ${t}`),this.client.emit("channelEnd",t)}}class jF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Comm.LiveKit")}handleroom_token(t){this.client.worldData.liveKitTokens.push(t.token),this.client.emit("livekitToken",t.token)}handleroom_leave(t){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==t.token),this.client.emit("livekitLeave",t.token)}}class VF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}sendKeepAlive(){this.sendData("KeepAlive")}sendPing(t){this.sendData("Ping",t)}handlePing(){console.log("Received Core.Ping response from server."),this.client.emit("corePing")}handleGoodbye(t){console.log(`Server sent Core.Goodbye: ${t}`),this.client.emit("coreGoodbye",t)}}class GF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Core.Supports")}sendSet(){const t=Object.values(this.client.gmcpHandlers).filter(r=>r.packageName&&r.packageVersion&&r.enabled).map(r=>`${r.packageName} ${r.packageVersion.toString()}`);this.sendData("Set",t)}sendAdd(t){const r=t.map(i=>`${i.name} ${i.version}`);this.sendData("Add",r)}sendRemove(t){this.sendData("Remove",t)}}class WF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Char.Afflictions")}handleList(t){console.log("Received Char.Afflictions.List:",t),this.client.emit("afflictionsList",t)}handleAdd(t){console.log("Received Char.Afflictions.Add:",t),this.client.emit("afflictionAdd",t)}handleRemove(t){console.log("Received Char.Afflictions.Remove:",t),this.client.emit("afflictionRemove",t)}}class zF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Char.Defences")}handleList(t){console.log("Received Char.Defences.List:",t),this.client.emit("defencesList",t)}handleAdd(t){console.log("Received Char.Defences.Add:",t),this.client.emit("defenceAdd",t)}handleRemove(t){console.log("Received Char.Defences.Remove:",t),this.client.emit("defenceRemove",t)}}class HF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Char.Items")}handleList(t){console.log(`Received Char.Items.List for ${t.location}:`,t.items);const r=t.items.map(i=>({...i,location:t.location}));this.client.emit("itemsList",{...t,items:r})}handleAdd(t){console.log(`Received Char.Items.Add for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemAdd",{...t,item:r})}handleRemove(t){console.log(`Received Char.Items.Remove for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemRemove",{...t,item:r})}handleUpdate(t){console.log(`Received Char.Items.Update for ${t.location}:`,t.item);const r={...t.item,location:t.location};this.client.emit("itemUpdate",{...t,item:r})}sendContentsRequest(t){this.sendData("Contents",t)}sendInventoryRequest(){this.sendData("Inv","")}sendRoomRequest(){this.sendData("Room","")}}class ZF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Char.Skills")}handleGroups(t){console.log("Received Char.Skills.Groups:",t),this.client.emit("skillGroups",t)}handleList(t){console.log(`Received Char.Skills.List for ${t.group}:`,t),this.client.emit("skillList",t)}handleInfo(t){console.log(`Received Char.Skills.Info for ${t.group}.${t.skill}:`,t.info),this.client.emit("skillInfo",t)}sendGetRequest(t,r){const i={};t&&(i.group=t),r&&(i.name=r),this.sendData("Get",i)}}class XF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Group")}handleInfo(t){console.log("Received Group.Info:",t),this.client.emit("groupInfo",t)}sendInfoRequest(){this.sendData("Info",{})}}class $F extends Yn{constructor(){super(...arguments);oe(this,"packageName","Logging")}handleError(t){console.error("Received Logging.Error from server:",t),this.client.emit("gmcpError",t)}}class KF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Redirect")}handleWindow(t){const r=t||"main";console.log(`Received Redirect.Window: ${r}`),this.client.emit("redirectWindow",r)}}class qF extends Yn{constructor(){super(...arguments);oe(this,"packageName","Room");oe(this,"name","");oe(this,"id","");oe(this,"exits",[]);oe(this,"people",[])}handleInfo(t){this.client.worldData.roomPlayers=[],this.name=t.name,this.id=t.num.toString(),this.client.worldData.roomId=this.id,this.client.currentRoomInfo=t,console.log("Received Room.Info:",t),this.client.emit("roomInfo",t)}handleWrongDir(t){console.log(`Received Room.WrongDir: ${t}`),this.client.emit("roomWrongDir",t)}handlePlayers(t){console.log("Received Room.Players:",t),this.client.worldData.roomPlayers=t.sort((r,i)=>r.fullname.localeCompare(i.fullname)),this.client.emit("roomPlayers",t)}handleAddPlayer(t){console.log("Received Room.AddPlayer:",t),this.client.worldData.roomPlayers.some(r=>r.name===t.name)||(this.client.worldData.roomPlayers.push(t),this.client.worldData.roomPlayers.sort((r,i)=>r.fullname.localeCompare(i.fullname))),this.client.emit("roomAddPlayer",t)}handleRemovePlayer(t){console.log("Received Room.RemovePlayer:",t),this.client.worldData.roomPlayers=this.client.worldData.roomPlayers.filter(r=>r.name!==t),this.client.emit("roomRemovePlayer",t)}}const du=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,GE=new Set,uy=typeof process=="object"&&process?process:{},WE=(n,e,t,r)=>{typeof uy.emitWarning=="function"?uy.emitWarning(n,e,t,r):console.error(`[${t}] ${e}: ${n}`)};let Cp=globalThis.AbortController,QI=globalThis.AbortSignal;var rk;if(typeof Cp>"u"){QI=class{constructor(){oe(this,"onabort");oe(this,"_onabort",[]);oe(this,"reason");oe(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},Cp=class{constructor(){oe(this,"signal",new QI);e()}abort(r){var i,o;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const c of this.signal._onabort)c(r);(o=(i=this.signal).onabort)==null||o.call(i,r)}}};let n=((rk=uy.env)==null?void 0:rk.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const e=()=>{n&&(n=!1,WE("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const YF=n=>!GE.has(n),gc=n=>n&&n===Math.floor(n)&&n>0&&isFinite(n),zE=n=>gc(n)?n<=Math.pow(2,8)?Uint8Array:n<=Math.pow(2,16)?Uint16Array:n<=Math.pow(2,32)?Uint32Array:n<=Number.MAX_SAFE_INTEGER?o0:null:null;class o0 extends Array{constructor(e){super(e),this.fill(0)}}var Ru;const pl=class pl{constructor(e,t){oe(this,"heap");oe(this,"length");if(!le(pl,Ru))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}static create(e){const t=zE(e);if(!t)return[];Jt(pl,Ru,!0);const r=new pl(e,t);return Jt(pl,Ru,!1),r}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}};Ru=new WeakMap,Pn(pl,Ru,!1);let dy=pl;var ik,ok,ms,To,vs,ys,Du,Pu,qr,Cs,jr,ur,fn,Vi,_o,Ni,ai,xs,ci,bs,Is,Ro,ws,Ic,Gi,xt,hy,ml,Ra,Sf,Do,HE,vl,Mu,Af,mc,vc,py,s0,a0,lr,gy,Zd,yc,my;const G1=class G1{constructor(e){Pn(this,xt);Pn(this,ms);Pn(this,To);Pn(this,vs);Pn(this,ys);Pn(this,Du);Pn(this,Pu);oe(this,"ttl");oe(this,"ttlResolution");oe(this,"ttlAutopurge");oe(this,"updateAgeOnGet");oe(this,"updateAgeOnHas");oe(this,"allowStale");oe(this,"noDisposeOnSet");oe(this,"noUpdateTTL");oe(this,"maxEntrySize");oe(this,"sizeCalculation");oe(this,"noDeleteOnFetchRejection");oe(this,"noDeleteOnStaleGet");oe(this,"allowStaleOnFetchAbort");oe(this,"allowStaleOnFetchRejection");oe(this,"ignoreFetchAbort");Pn(this,qr);Pn(this,Cs);Pn(this,jr);Pn(this,ur);Pn(this,fn);Pn(this,Vi);Pn(this,_o);Pn(this,Ni);Pn(this,ai);Pn(this,xs);Pn(this,ci);Pn(this,bs);Pn(this,Is);Pn(this,Ro);Pn(this,ws);Pn(this,Ic);Pn(this,Gi);Pn(this,ml,()=>{});Pn(this,Ra,()=>{});Pn(this,Sf,()=>{});Pn(this,Do,()=>!1);Pn(this,vl,e=>{});Pn(this,Mu,(e,t,r)=>{});Pn(this,Af,(e,t,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});oe(this,ik,"LRUCache");const{max:t=0,ttl:r,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:c,updateAgeOnHas:s,allowStale:l,dispose:d,disposeAfter:h,noDisposeOnSet:p,noUpdateTTL:g,maxSize:y=0,maxEntrySize:C=0,sizeCalculation:x,fetchMethod:w,memoMethod:S,noDeleteOnFetchRejection:E,noDeleteOnStaleGet:R,allowStaleOnFetchRejection:k,allowStaleOnFetchAbort:A,ignoreFetchAbort:_}=e;if(t!==0&&!gc(t))throw new TypeError("max option must be a nonnegative integer");const D=t?zE(t):Array;if(!D)throw new Error("invalid max value: "+t);if(Jt(this,ms,t),Jt(this,To,y),this.maxEntrySize=C||le(this,To),this.sizeCalculation=x,this.sizeCalculation){if(!le(this,To)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(S!==void 0&&typeof S!="function")throw new TypeError("memoMethod must be a function if defined");if(Jt(this,Pu,S),w!==void 0&&typeof w!="function")throw new TypeError("fetchMethod must be a function if specified");if(Jt(this,Du,w),Jt(this,Ic,!!w),Jt(this,jr,new Map),Jt(this,ur,new Array(t).fill(void 0)),Jt(this,fn,new Array(t).fill(void 0)),Jt(this,Vi,new D(t)),Jt(this,_o,new D(t)),Jt(this,Ni,0),Jt(this,ai,0),Jt(this,xs,dy.create(t)),Jt(this,qr,0),Jt(this,Cs,0),typeof d=="function"&&Jt(this,vs,d),typeof h=="function"?(Jt(this,ys,h),Jt(this,ci,[])):(Jt(this,ys,void 0),Jt(this,ci,void 0)),Jt(this,ws,!!le(this,vs)),Jt(this,Gi,!!le(this,ys)),this.noDisposeOnSet=!!p,this.noUpdateTTL=!!g,this.noDeleteOnFetchRejection=!!E,this.allowStaleOnFetchRejection=!!k,this.allowStaleOnFetchAbort=!!A,this.ignoreFetchAbort=!!_,this.maxEntrySize!==0){if(le(this,To)!==0&&!gc(le(this,To)))throw new TypeError("maxSize must be a positive integer if specified");if(!gc(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Nt(this,xt,HE).call(this)}if(this.allowStale=!!l,this.noDeleteOnStaleGet=!!R,this.updateAgeOnGet=!!c,this.updateAgeOnHas=!!s,this.ttlResolution=gc(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=r||0,this.ttl){if(!gc(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Nt(this,xt,hy).call(this)}if(le(this,ms)===0&&this.ttl===0&&le(this,To)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!le(this,ms)&&!le(this,To)){const j="LRU_CACHE_UNBOUNDED";YF(j)&&(GE.add(j),WE("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",j,G1))}}static unsafeExposeInternals(e){return{starts:le(e,Is),ttls:le(e,Ro),sizes:le(e,bs),keyMap:le(e,jr),keyList:le(e,ur),valList:le(e,fn),next:le(e,Vi),prev:le(e,_o),get head(){return le(e,Ni)},get tail(){return le(e,ai)},free:le(e,xs),isBackgroundFetch:t=>{var r;return Nt(r=e,xt,lr).call(r,t)},backgroundFetch:(t,r,i,o)=>{var c;return Nt(c=e,xt,a0).call(c,t,r,i,o)},moveToTail:t=>{var r;return Nt(r=e,xt,Zd).call(r,t)},indexes:t=>{var r;return Nt(r=e,xt,mc).call(r,t)},rindexes:t=>{var r;return Nt(r=e,xt,vc).call(r,t)},isStale:t=>{var r;return le(r=e,Do).call(r,t)}}}get max(){return le(this,ms)}get maxSize(){return le(this,To)}get calculatedSize(){return le(this,Cs)}get size(){return le(this,qr)}get fetchMethod(){return le(this,Du)}get memoMethod(){return le(this,Pu)}get dispose(){return le(this,vs)}get disposeAfter(){return le(this,ys)}getRemainingTTL(e){return le(this,jr).has(e)?1/0:0}*entries(){for(const e of Nt(this,xt,mc).call(this))le(this,fn)[e]!==void 0&&le(this,ur)[e]!==void 0&&!Nt(this,xt,lr).call(this,le(this,fn)[e])&&(yield[le(this,ur)[e],le(this,fn)[e]])}*rentries(){for(const e of Nt(this,xt,vc).call(this))le(this,fn)[e]!==void 0&&le(this,ur)[e]!==void 0&&!Nt(this,xt,lr).call(this,le(this,fn)[e])&&(yield[le(this,ur)[e],le(this,fn)[e]])}*keys(){for(const e of Nt(this,xt,mc).call(this)){const t=le(this,ur)[e];t!==void 0&&!Nt(this,xt,lr).call(this,le(this,fn)[e])&&(yield t)}}*rkeys(){for(const e of Nt(this,xt,vc).call(this)){const t=le(this,ur)[e];t!==void 0&&!Nt(this,xt,lr).call(this,le(this,fn)[e])&&(yield t)}}*values(){for(const e of Nt(this,xt,mc).call(this))le(this,fn)[e]!==void 0&&!Nt(this,xt,lr).call(this,le(this,fn)[e])&&(yield le(this,fn)[e])}*rvalues(){for(const e of Nt(this,xt,vc).call(this))le(this,fn)[e]!==void 0&&!Nt(this,xt,lr).call(this,le(this,fn)[e])&&(yield le(this,fn)[e])}[(ok=Symbol.iterator,ik=Symbol.toStringTag,ok)](){return this.entries()}find(e,t={}){for(const r of Nt(this,xt,mc).call(this)){const i=le(this,fn)[r],o=Nt(this,xt,lr).call(this,i)?i.__staleWhileFetching:i;if(o!==void 0&&e(o,le(this,ur)[r],this))return this.get(le(this,ur)[r],t)}}forEach(e,t=this){for(const r of Nt(this,xt,mc).call(this)){const i=le(this,fn)[r],o=Nt(this,xt,lr).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(t,o,le(this,ur)[r],this)}}rforEach(e,t=this){for(const r of Nt(this,xt,vc).call(this)){const i=le(this,fn)[r],o=Nt(this,xt,lr).call(this,i)?i.__staleWhileFetching:i;o!==void 0&&e.call(t,o,le(this,ur)[r],this)}}purgeStale(){let e=!1;for(const t of Nt(this,xt,vc).call(this,{allowStale:!0}))le(this,Do).call(this,t)&&(Nt(this,xt,yc).call(this,le(this,ur)[t],"expire"),e=!0);return e}info(e){const t=le(this,jr).get(e);if(t===void 0)return;const r=le(this,fn)[t],i=Nt(this,xt,lr).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const o={value:i};if(le(this,Ro)&&le(this,Is)){const c=le(this,Ro)[t],s=le(this,Is)[t];if(c&&s){const l=c-(du.now()-s);o.ttl=l,o.start=Date.now()}}return le(this,bs)&&(o.size=le(this,bs)[t]),o}dump(){const e=[];for(const t of Nt(this,xt,mc).call(this,{allowStale:!0})){const r=le(this,ur)[t],i=le(this,fn)[t],o=Nt(this,xt,lr).call(this,i)?i.__staleWhileFetching:i;if(o===void 0||r===void 0)continue;const c={value:o};if(le(this,Ro)&&le(this,Is)){c.ttl=le(this,Ro)[t];const s=du.now()-le(this,Is)[t];c.start=Math.floor(Date.now()-s)}le(this,bs)&&(c.size=le(this,bs)[t]),e.unshift([r,c])}return e}load(e){this.clear();for(const[t,r]of e){if(r.start){const i=Date.now()-r.start;r.start=du.now()-i}this.set(t,r.value,r)}}set(e,t,r={}){var g,y,C,x,w;if(t===void 0)return this.delete(e),this;const{ttl:i=this.ttl,start:o,noDisposeOnSet:c=this.noDisposeOnSet,sizeCalculation:s=this.sizeCalculation,status:l}=r;let{noUpdateTTL:d=this.noUpdateTTL}=r;const h=le(this,Af).call(this,e,t,r.size||0,s);if(this.maxEntrySize&&h>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),Nt(this,xt,yc).call(this,e,"set"),this;let p=le(this,qr)===0?void 0:le(this,jr).get(e);if(p===void 0)p=le(this,qr)===0?le(this,ai):le(this,xs).length!==0?le(this,xs).pop():le(this,qr)===le(this,ms)?Nt(this,xt,s0).call(this,!1):le(this,qr),le(this,ur)[p]=e,le(this,fn)[p]=t,le(this,jr).set(e,p),le(this,Vi)[le(this,ai)]=p,le(this,_o)[p]=le(this,ai),Jt(this,ai,p),Mh(this,qr)._++,le(this,Mu).call(this,p,h,l),l&&(l.set="add"),d=!1;else{Nt(this,xt,Zd).call(this,p);const S=le(this,fn)[p];if(t!==S){if(le(this,Ic)&&Nt(this,xt,lr).call(this,S)){S.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:E}=S;E!==void 0&&!c&&(le(this,ws)&&((g=le(this,vs))==null||g.call(this,E,e,"set")),le(this,Gi)&&((y=le(this,ci))==null||y.push([E,e,"set"])))}else c||(le(this,ws)&&((C=le(this,vs))==null||C.call(this,S,e,"set")),le(this,Gi)&&((x=le(this,ci))==null||x.push([S,e,"set"])));if(le(this,vl).call(this,p),le(this,Mu).call(this,p,h,l),le(this,fn)[p]=t,l){l.set="replace";const E=S&&Nt(this,xt,lr).call(this,S)?S.__staleWhileFetching:S;E!==void 0&&(l.oldValue=E)}}else l&&(l.set="update")}if(i!==0&&!le(this,Ro)&&Nt(this,xt,hy).call(this),le(this,Ro)&&(d||le(this,Sf).call(this,p,i,o),l&&le(this,Ra).call(this,l,p)),!c&&le(this,Gi)&&le(this,ci)){const S=le(this,ci);let E;for(;E=S==null?void 0:S.shift();)(w=le(this,ys))==null||w.call(this,...E)}return this}pop(){var e;try{for(;le(this,qr);){const t=le(this,fn)[le(this,Ni)];if(Nt(this,xt,s0).call(this,!0),Nt(this,xt,lr).call(this,t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(le(this,Gi)&&le(this,ci)){const t=le(this,ci);let r;for(;r=t==null?void 0:t.shift();)(e=le(this,ys))==null||e.call(this,...r)}}}has(e,t={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=t,o=le(this,jr).get(e);if(o!==void 0){const c=le(this,fn)[o];if(Nt(this,xt,lr).call(this,c)&&c.__staleWhileFetching===void 0)return!1;if(le(this,Do).call(this,o))i&&(i.has="stale",le(this,Ra).call(this,i,o));else return r&&le(this,ml).call(this,o),i&&(i.has="hit",le(this,Ra).call(this,i,o)),!0}else i&&(i.has="miss");return!1}peek(e,t={}){const{allowStale:r=this.allowStale}=t,i=le(this,jr).get(e);if(i===void 0||!r&&le(this,Do).call(this,i))return;const o=le(this,fn)[i];return Nt(this,xt,lr).call(this,o)?o.__staleWhileFetching:o}async fetch(e,t={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:c=this.ttl,noDisposeOnSet:s=this.noDisposeOnSet,size:l=0,sizeCalculation:d=this.sizeCalculation,noUpdateTTL:h=this.noUpdateTTL,noDeleteOnFetchRejection:p=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:g=this.allowStaleOnFetchRejection,ignoreFetchAbort:y=this.ignoreFetchAbort,allowStaleOnFetchAbort:C=this.allowStaleOnFetchAbort,context:x,forceRefresh:w=!1,status:S,signal:E}=t;if(!le(this,Ic))return S&&(S.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,status:S});const R={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:o,ttl:c,noDisposeOnSet:s,size:l,sizeCalculation:d,noUpdateTTL:h,noDeleteOnFetchRejection:p,allowStaleOnFetchRejection:g,allowStaleOnFetchAbort:C,ignoreFetchAbort:y,status:S,signal:E};let k=le(this,jr).get(e);if(k===void 0){S&&(S.fetch="miss");const A=Nt(this,xt,a0).call(this,e,k,R,x);return A.__returned=A}else{const A=le(this,fn)[k];if(Nt(this,xt,lr).call(this,A)){const F=r&&A.__staleWhileFetching!==void 0;return S&&(S.fetch="inflight",F&&(S.returnedStale=!0)),F?A.__staleWhileFetching:A.__returned=A}const _=le(this,Do).call(this,k);if(!w&&!_)return S&&(S.fetch="hit"),Nt(this,xt,Zd).call(this,k),i&&le(this,ml).call(this,k),S&&le(this,Ra).call(this,S,k),A;const D=Nt(this,xt,a0).call(this,e,k,R,x),Z=D.__staleWhileFetching!==void 0&&r;return S&&(S.fetch=_?"stale":"refresh",Z&&_&&(S.returnedStale=!0)),Z?D.__staleWhileFetching:D.__returned=D}}async forceFetch(e,t={}){const r=await this.fetch(e,t);if(r===void 0)throw new Error("fetch() returned undefined");return r}memo(e,t={}){const r=le(this,Pu);if(!r)throw new Error("no memoMethod provided to constructor");const{context:i,forceRefresh:o,...c}=t,s=this.get(e,c);if(!o&&s!==void 0)return s;const l=r(e,s,{options:c,context:i});return this.set(e,l,c),l}get(e,t={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:c}=t,s=le(this,jr).get(e);if(s!==void 0){const l=le(this,fn)[s],d=Nt(this,xt,lr).call(this,l);return c&&le(this,Ra).call(this,c,s),le(this,Do).call(this,s)?(c&&(c.get="stale"),d?(c&&r&&l.__staleWhileFetching!==void 0&&(c.returnedStale=!0),r?l.__staleWhileFetching:void 0):(o||Nt(this,xt,yc).call(this,e,"expire"),c&&r&&(c.returnedStale=!0),r?l:void 0)):(c&&(c.get="hit"),d?l.__staleWhileFetching:(Nt(this,xt,Zd).call(this,s),i&&le(this,ml).call(this,s),l))}else c&&(c.get="miss")}delete(e){return Nt(this,xt,yc).call(this,e,"delete")}clear(){return Nt(this,xt,my).call(this,"delete")}};ms=new WeakMap,To=new WeakMap,vs=new WeakMap,ys=new WeakMap,Du=new WeakMap,Pu=new WeakMap,qr=new WeakMap,Cs=new WeakMap,jr=new WeakMap,ur=new WeakMap,fn=new WeakMap,Vi=new WeakMap,_o=new WeakMap,Ni=new WeakMap,ai=new WeakMap,xs=new WeakMap,ci=new WeakMap,bs=new WeakMap,Is=new WeakMap,Ro=new WeakMap,ws=new WeakMap,Ic=new WeakMap,Gi=new WeakMap,xt=new WeakSet,hy=function(){const e=new o0(le(this,ms)),t=new o0(le(this,ms));Jt(this,Ro,e),Jt(this,Is,t),Jt(this,Sf,(o,c,s=du.now())=>{if(t[o]=c!==0?s:0,e[o]=c,c!==0&&this.ttlAutopurge){const l=setTimeout(()=>{le(this,Do).call(this,o)&&Nt(this,xt,yc).call(this,le(this,ur)[o],"expire")},c+1);l.unref&&l.unref()}}),Jt(this,ml,o=>{t[o]=e[o]!==0?du.now():0}),Jt(this,Ra,(o,c)=>{if(e[c]){const s=e[c],l=t[c];if(!s||!l)return;o.ttl=s,o.start=l,o.now=r||i();const d=o.now-l;o.remainingTTL=s-d}});let r=0;const i=()=>{const o=du.now();if(this.ttlResolution>0){r=o;const c=setTimeout(()=>r=0,this.ttlResolution);c.unref&&c.unref()}return o};this.getRemainingTTL=o=>{const c=le(this,jr).get(o);if(c===void 0)return 0;const s=e[c],l=t[c];if(!s||!l)return 1/0;const d=(r||i())-l;return s-d},Jt(this,Do,o=>{const c=t[o],s=e[o];return!!s&&!!c&&(r||i())-c>s})},ml=new WeakMap,Ra=new WeakMap,Sf=new WeakMap,Do=new WeakMap,HE=function(){const e=new o0(le(this,ms));Jt(this,Cs,0),Jt(this,bs,e),Jt(this,vl,t=>{Jt(this,Cs,le(this,Cs)-e[t]),e[t]=0}),Jt(this,Af,(t,r,i,o)=>{if(Nt(this,xt,lr).call(this,r))return 0;if(!gc(i))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(i=o(r,t),!gc(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Jt(this,Mu,(t,r,i)=>{if(e[t]=r,le(this,To)){const o=le(this,To)-e[t];for(;le(this,Cs)>o;)Nt(this,xt,s0).call(this,!0)}Jt(this,Cs,le(this,Cs)+e[t]),i&&(i.entrySize=r,i.totalCalculatedSize=le(this,Cs))})},vl=new WeakMap,Mu=new WeakMap,Af=new WeakMap,mc=function*({allowStale:e=this.allowStale}={}){if(le(this,qr))for(let t=le(this,ai);!(!Nt(this,xt,py).call(this,t)||((e||!le(this,Do).call(this,t))&&(yield t),t===le(this,Ni)));)t=le(this,_o)[t]},vc=function*({allowStale:e=this.allowStale}={}){if(le(this,qr))for(let t=le(this,Ni);!(!Nt(this,xt,py).call(this,t)||((e||!le(this,Do).call(this,t))&&(yield t),t===le(this,ai)));)t=le(this,Vi)[t]},py=function(e){return e!==void 0&&le(this,jr).get(le(this,ur)[e])===e},s0=function(e){var o,c;const t=le(this,Ni),r=le(this,ur)[t],i=le(this,fn)[t];return le(this,Ic)&&Nt(this,xt,lr).call(this,i)?i.__abortController.abort(new Error("evicted")):(le(this,ws)||le(this,Gi))&&(le(this,ws)&&((o=le(this,vs))==null||o.call(this,i,r,"evict")),le(this,Gi)&&((c=le(this,ci))==null||c.push([i,r,"evict"]))),le(this,vl).call(this,t),e&&(le(this,ur)[t]=void 0,le(this,fn)[t]=void 0,le(this,xs).push(t)),le(this,qr)===1?(Jt(this,Ni,Jt(this,ai,0)),le(this,xs).length=0):Jt(this,Ni,le(this,Vi)[t]),le(this,jr).delete(r),Mh(this,qr)._--,t},a0=function(e,t,r,i){const o=t===void 0?void 0:le(this,fn)[t];if(Nt(this,xt,lr).call(this,o))return o;const c=new Cp,{signal:s}=r;s==null||s.addEventListener("abort",()=>c.abort(s.reason),{signal:c.signal});const l={signal:c.signal,options:r,context:i},d=(x,w=!1)=>{const{aborted:S}=c.signal,E=r.ignoreFetchAbort&&x!==void 0;if(r.status&&(S&&!w?(r.status.fetchAborted=!0,r.status.fetchError=c.signal.reason,E&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),S&&!E&&!w)return p(c.signal.reason);const R=y;return le(this,fn)[t]===y&&(x===void 0?R.__staleWhileFetching?le(this,fn)[t]=R.__staleWhileFetching:Nt(this,xt,yc).call(this,e,"fetch"):(r.status&&(r.status.fetchUpdated=!0),this.set(e,x,l.options))),x},h=x=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=x),p(x)),p=x=>{const{aborted:w}=c.signal,S=w&&r.allowStaleOnFetchAbort,E=S||r.allowStaleOnFetchRejection,R=E||r.noDeleteOnFetchRejection,k=y;if(le(this,fn)[t]===y&&(!R||k.__staleWhileFetching===void 0?Nt(this,xt,yc).call(this,e,"fetch"):S||(le(this,fn)[t]=k.__staleWhileFetching)),E)return r.status&&k.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),k.__staleWhileFetching;if(k.__returned===k)throw x},g=(x,w)=>{var E;const S=(E=le(this,Du))==null?void 0:E.call(this,e,o,l);S&&S instanceof Promise&&S.then(R=>x(R===void 0?void 0:R),w),c.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(x(void 0),r.allowStaleOnFetchAbort&&(x=R=>d(R,!0)))})};r.status&&(r.status.fetchDispatched=!0);const y=new Promise(g).then(d,h),C=Object.assign(y,{__abortController:c,__staleWhileFetching:o,__returned:void 0});return t===void 0?(this.set(e,C,{...l.options,status:void 0}),t=le(this,jr).get(e)):le(this,fn)[t]=C,C},lr=function(e){if(!le(this,Ic))return!1;const t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof Cp},gy=function(e,t){le(this,_o)[t]=e,le(this,Vi)[e]=t},Zd=function(e){e!==le(this,ai)&&(e===le(this,Ni)?Jt(this,Ni,le(this,Vi)[e]):Nt(this,xt,gy).call(this,le(this,_o)[e],le(this,Vi)[e]),Nt(this,xt,gy).call(this,le(this,ai),e),Jt(this,ai,e))},yc=function(e,t){var i,o,c,s;let r=!1;if(le(this,qr)!==0){const l=le(this,jr).get(e);if(l!==void 0)if(r=!0,le(this,qr)===1)Nt(this,xt,my).call(this,t);else{le(this,vl).call(this,l);const d=le(this,fn)[l];if(Nt(this,xt,lr).call(this,d)?d.__abortController.abort(new Error("deleted")):(le(this,ws)||le(this,Gi))&&(le(this,ws)&&((i=le(this,vs))==null||i.call(this,d,e,t)),le(this,Gi)&&((o=le(this,ci))==null||o.push([d,e,t]))),le(this,jr).delete(e),le(this,ur)[l]=void 0,le(this,fn)[l]=void 0,l===le(this,ai))Jt(this,ai,le(this,_o)[l]);else if(l===le(this,Ni))Jt(this,Ni,le(this,Vi)[l]);else{const h=le(this,_o)[l];le(this,Vi)[h]=le(this,Vi)[l];const p=le(this,Vi)[l];le(this,_o)[p]=le(this,_o)[l]}Mh(this,qr)._--,le(this,xs).push(l)}}if(le(this,Gi)&&((c=le(this,ci))!=null&&c.length)){const l=le(this,ci);let d;for(;d=l==null?void 0:l.shift();)(s=le(this,ys))==null||s.call(this,...d)}return r},my=function(e){var t,r,i;for(const o of Nt(this,xt,vc).call(this,{allowStale:!0})){const c=le(this,fn)[o];if(Nt(this,xt,lr).call(this,c))c.__abortController.abort(new Error("deleted"));else{const s=le(this,ur)[o];le(this,ws)&&((t=le(this,vs))==null||t.call(this,c,s,e)),le(this,Gi)&&((r=le(this,ci))==null||r.push([c,s,e]))}}if(le(this,jr).clear(),le(this,fn).fill(void 0),le(this,ur).fill(void 0),le(this,Ro)&&le(this,Is)&&(le(this,Ro).fill(0),le(this,Is).fill(0)),le(this,bs)&&le(this,bs).fill(0),Jt(this,Ni,0),Jt(this,ai,0),le(this,xs).length=0,Jt(this,Cs,0),Jt(this,qr,0),le(this,Gi)&&le(this,ci)){const o=le(this,ci);let c;for(;c=o==null?void 0:o.shift();)(i=le(this,ys))==null||i.call(this,...c)}};let fy=G1;function QF(n){const e=n.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+n+"`"),null;const t=e[1],r=e[2],i={},o=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let c;for(;c=o.exec(e[3]);){const s=c[1]||c[3],l=c[2]||c[4];s in i?console.log(`Invalid message format: duplicate key ${s} detected`):i[s]=l}return{name:t,authKey:r,keyvals:i}}function JI(n){const e=n.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!e)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+n+"`"),null;const t=e[1]||e[4],r=void 0,i=e[2],o=e[3],c={};return c[i]=o,{name:t,authKey:r,keyvals:c}}function ew(){return(Math.random()+1).toString(36).substring(3,9)}class $u{constructor(e){oe(this,"packageName");oe(this,"minVersion",1);oe(this,"maxVersion",1);oe(this,"packageVersion",0);oe(this,"client");this.client=e}handle(e){throw new Error("Method not implemented.")}handleMultiline(e){throw new Error("Method not implemented.")}closeMultiline(e){throw new Error("Method not implemented.")}shutdown(){}send(e,t){e.startsWith(this.packageName)||(e=this.packageName+"-"+e),this.client.sendMcp(e,t)}}class JF extends $u{constructor(){super(...arguments);oe(this,"packageName","mcp-negotiate");oe(this,"minVersion",2);oe(this,"maxVersion",2)}handle(t){t.name}sendNegotiate(){var t,r;for(const i of Object.values(this.client.mcpHandlers)){let o=(t=i.minVersion)==null?void 0:t.toFixed(1),c=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":o,"max-version":c})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class eB extends $u{constructor(){super(...arguments);oe(this,"packageName","dns-com-awns-status")}handle(t){console.log(t),this.client.emit("statustext",t.keyvals.text)}}class tB extends $u{constructor(t){super(t);oe(this,"packageName","dns-org-mud-moo-simpleedit");oe(this,"currentSession",null)}handle(t){t.name==="dns-org-mud-moo-simpleedit-content"?this.currentSession={name:t.keyvals.name,reference:t.keyvals.reference,type:t.keyvals.type,contents:[]}:console.log(`Unexpected simpleedit message ${t}`)}handleMultiline(t){this.currentSession&&"content"in t.keyvals?this.currentSession.contents.push(t.keyvals.content):console.log(`Unexpected simpleedit ML ${t}`)}closeMultiline(t){console.log(`Closing multiline ${t.name}`),this.currentSession&&(this.client.editors.openEditorWindow(this.currentSession),this.currentSession=null)}}class nB extends $u{constructor(){super(...arguments);oe(this,"packageName","dns-com-awns-getset");oe(this,"id",1);oe(this,"cache",new fy({max:10}));oe(this,"LocalCache",{})}handle(t){switch(t.name){case"dns-com-awns-getset-ack":const r=this.cache.get(t.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${t.keyvals.id}`);break}const i=t.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(t){const r=(this.id++).toString();this.cache.set(r,t),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:t})}sendSet(t,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:t,value:r})}sendDrop(t){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:t})}}class rB extends $u{constructor(){super(...arguments);oe(this,"packageName","dns-com-vmoo-userlist");oe(this,"maxVersion",1.1);oe(this,"player");oe(this,"fields",["Object","Name","Icon"]);oe(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);oe(this,"players",[])}handle(t){switch(t.name){case"dns-com-vmoo-userlist-you":this.player=t.keyvals.nr;break}}handleMultiline(t){if("fields"in t.keyvals&&(this.fields=hs(t.keyvals.fields.trim())),"icons"in t.keyvals&&(this.icons=hs(t.keyvals.icons.trim())),"d"in t.keyvals){const o=t.keyvals.d[0];switch(o){case"=":var r=hs(t.keyvals.d.slice(1));this.players=r.map(s=>this.playerFromArray(s));break;case"+":this.players.push(this.playerFromArray(hs(t.keyvals.d.slice(1))));break;case"-":var i=hs(t.keyvals.d.slice(1));this.players=this.players.filter(s=>!i.includes(s.Object));break;case"*":const c=this.playerFromArray(hs(t.keyvals.d.slice(1)));this.updatePlayer(c);break;case"<":i=hs(t.keyvals.d.slice(1)),this.players.forEach((s,l)=>{i.includes(s.Object)&&(s.idle=!0,this.players[l]=s)});break;case">":i=hs(t.keyvals.d.slice(1)),this.players.forEach((s,l)=>{i.includes(s.Object)&&(s.idle=!1,this.players[l]=s)});break;case"[":i=hs(t.keyvals.d.slice(1)),this.players.forEach((s,l)=>{i.includes(s.Object)&&(s.away=!0,this.players[l]=s)});break;case"]":i=hs(t.keyvals.d.slice(1)),this.players.forEach((s,l)=>{i.includes(s.Object)&&(s.away=!1,this.players[l]=s)});break;default:console.log(`Unknown userlist mode ${o} in ${t.keyvals.d}`);break}this.update()}}updatePlayer(t){const r=this.players.findIndex(i=>i.Object===t.Object);r!==-1?this.players[r]=t:this.players.push(t)}update(){this.players.sort((r,i)=>t(i)-t(r)),this.client.emit("userlist",this.players);function t(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(t){const r={};return t.forEach((i,o)=>{r[this.fields[o]]=i}),r.away=!1,r.idle=!1,r}}function hs(n){n=n.slice(1,-1);let e=[],t="",r=0;for(let o=0;o<n.length;o++){const c=n[o];if(c==="{")r++;else if(c==="}")r--;else if(c===","&&r===0){i(),t="";continue}t+=c}return t.length>0&&i(),e;function i(){t=t.trim(),t.startsWith("{")&&t.endsWith("}")?e.push(hs(t)):Number.isNaN(Number(t))?t.startsWith('"')&&t.endsWith('"')?e.push(t.slice(1,-1)):e.push(t):e.push(Number(t))}}class iB extends $u{constructor(){super(...arguments);oe(this,"packageName","dns-com-awns-ping");oe(this,"id",1)}handle(t){switch(t.name){case"dns-com-awns-ping":this.send("reply",t.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}class oB extends Hp{constructor(t){super();oe(this,"peerConnection",null);oe(this,"dataChannel",null);oe(this,"client");oe(this,"connectionTimeout",3e5);oe(this,"connectionTimeoutId");oe(this,"recipient","");oe(this,"pendingCandidates",[]);oe(this,"remoteOfferReceived",!1);this.client=t}isDataChannelOpen(){return this.dataChannel!==null&&this.dataChannel.readyState==="open"}async createPeerConnection(){try{const t={iceServers:[{urls:["turn:mongoose.world:3478","stun:mongoose.world:3478"],username:"p2p",credential:"p2p"},{urls:"stun:stun.l.google.com:19302"}],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};this.peerConnection=new RTCPeerConnection(t),this.peerConnection.onconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.connectionState;switch(console.log("[WebRTCService] Connection state changed to:",r),this.emit("webRTCStateChange",`Connection: ${r}`),r){case"connected":console.log("[WebRTCService] Peer connection established successfully"),this.emit("webRTCConnected");break;case"disconnected":console.log("[WebRTCService] Connection temporarily disconnected"),this.emit("webRTCDisconnected"),setTimeout(()=>{var o;((o=this.peerConnection)==null?void 0:o.connectionState)==="disconnected"&&this.attemptRecovery()},5e3);break;case"failed":console.log("[WebRTCService] Connection failed - attempting immediate recovery"),this.attemptRecovery();break}},this.peerConnection.oniceconnectionstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceConnectionState;console.log("[WebRTCService] ICE connection state changed to:",r),this.emit("webRTCStateChange",`ICE: ${r}`),r==="failed"&&(console.log("[WebRTCService] ICE connection failed"),this.attemptRecovery())},this.peerConnection.onsignalingstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.signalingState;console.log("[WebRTCService] Signaling state changed to:",r),this.emit("webRTCStateChange",`Signaling: ${r}`),r==="stable"&&console.log("[WebRTCService] Signaling completed successfully")},this.peerConnection.onicegatheringstatechange=()=>{var i;const r=(i=this.peerConnection)==null?void 0:i.iceGatheringState;console.log("[WebRTCService] ICE gathering state changed to:",r),this.emit("webRTCStateChange",`ICE Gathering: ${r}`),r==="complete"&&(console.log("[WebRTCService] ICE gathering completed"),this.emit("iceGatheringComplete"))},this.peerConnection.onicecandidate=r=>{r.candidate?(console.debug("[WebRTCService] New ICE candidate:",{type:r.candidate.type,protocol:r.candidate.protocol,address:r.candidate.address,port:r.candidate.port}),this.recipient&&this.client.gmcp_fileTransfer.sendCandidate(this.recipient,r.candidate)):console.log("[WebRTCService] ICE gathering complete")},this.peerConnection.ondatachannel=r=>{console.log("[WebRTCService] Received data channel"),this.dataChannel=r.channel,this.setupDataChannel()},this.dataChannel||(console.log("[WebRTCService] Creating data channel"),this.dataChannel=this.peerConnection.createDataChannel("fileTransfer",{ordered:!0}),this.setupDataChannel())}catch(t){throw console.error("Error creating peer connection:",t),t}}setupDataChannel(){this.dataChannel&&(this.dataChannel.onopen=()=>{var t;console.log("[WebRTCService] Data channel opened with state:",(t=this.dataChannel)==null?void 0:t.readyState),this.emit("dataChannelOpen")},this.dataChannel.onclose=()=>{console.log("[WebRTCService] Data channel closed"),this.emit("dataChannelClose")},this.dataChannel.onerror=t=>{console.error("[WebRTCService] Data channel error:",t),this.emit("dataChannelError",t)},this.dataChannel.onmessage=t=>{t.data instanceof ArrayBuffer&&this.emit("dataChannelMessage",t.data)})}async attemptRecovery(){try{console.log("[WebRTCService] Attempting connection recovery"),this.close(),await new Promise(t=>setTimeout(t,1e3)),await this.createPeerConnection(),console.log("[WebRTCService] Recovery attempt completed")}catch(t){console.error("[WebRTCService] Recovery attempt failed:",t)}}async attemptChannelRecovery(){var t;try{this.dataChannel=((t=this.peerConnection)==null?void 0:t.createDataChannel("fileTransfer"))??null,this.setupDataChannel()}catch(r){console.error("Failed to recover data channel:",r),this.emit("dataChannelRecoveryFailed",r)}}async sendData(t){if(!this.dataChannel)throw new Error("Data channel not initialized");if(this.dataChannel.readyState!=="open")throw new Error("Data channel is not open");try{for(;this.dataChannel.bufferedAmount>1048576;)await new Promise(i=>{var c;const o=()=>{var s;(s=this.dataChannel)==null||s.removeEventListener("bufferedamountlow",o),i()};(c=this.dataChannel)==null||c.addEventListener("bufferedamountlow",o),this.dataChannel.bufferedAmountLowThreshold=1048576/2});this.dataChannel.send(t)}catch(r){throw console.error("[WebRTCService] Error sending data:",r),r}}async createOffer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const t=await this.peerConnection.createOffer();return await this.peerConnection.setLocalDescription(t),t}catch(t){throw console.error("Error creating offer:",t),t}}async createAnswer(){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{const t=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(t),t}catch(t){throw console.error("Error creating answer:",t),t}}async handleAnswer(t){if(!this.peerConnection)throw new Error("Peer connection not initialized");try{console.log("[WebRTCService] Received WebRTC answer:",t),console.log("[WebRTCService] Current connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Current signaling state:",this.peerConnection.signalingState),await this.peerConnection.setRemoteDescription(new RTCSessionDescription(t)),console.log("[WebRTCService] Remote description set successfully"),console.log("[WebRTCService] Updated connection state:",this.peerConnection.connectionState),console.log("[WebRTCService] Updated signaling state:",this.peerConnection.signalingState),this.pendingCandidates.length>0?(console.log(`[WebRTCService] Adding ${this.pendingCandidates.length} pending ICE candidates`),await Promise.all(this.pendingCandidates.map(async(r,i)=>{console.log(`[WebRTCService] Adding ICE candidate ${i+1}/${this.pendingCandidates.length}`),await this.peerConnection.addIceCandidate(new RTCIceCandidate(r))})),console.log("[WebRTCService] All pending ICE candidates added successfully"),this.pendingCandidates=[]):console.log("[WebRTCService] No pending ICE candidates to add")}catch(r){throw console.error("Error handling answer:",r),r}}async handleIceCandidate(t){if(!this.peerConnection||!this.peerConnection.remoteDescription){console.log("[WebRTCService] Storing ICE candidate until peer connection is ready"),this.pendingCandidates.push(t);return}try{console.log("[WebRTCService] Adding ICE candidate immediately"),await this.peerConnection.addIceCandidate(new RTCIceCandidate(t))}catch(r){throw console.error("Error handling ICE candidate:",r),r}}async reconnect(){this.close(),await this.createPeerConnection(),this.emit("webRTCReconnecting")}cleanup(){this.connectionTimeoutId&&(clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=void 0),this.close()}close(){this.pendingCandidates=[],this.dataChannel&&(this.dataChannel.close(),this.dataChannel=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.emit("webRTCClosed")}async waitForConnection(){return new Promise((t,r)=>{if(this.connectionTimeoutId=window.setTimeout(()=>{c(),r(new Error("Connection timeout"))},this.connectionTimeout),this.isDataChannelOpen())return clearTimeout(this.connectionTimeoutId),t();const i=()=>{clearTimeout(this.connectionTimeoutId),c(),t()},o=()=>{var l;((l=this.peerConnection)==null?void 0:l.connectionState)==="failed"&&(clearTimeout(this.connectionTimeoutId),c(),r(new Error("Connection failed")))},c=()=>{this.dataChannel&&this.dataChannel.removeEventListener("open",i),this.peerConnection&&this.peerConnection.removeEventListener("connectionstatechange",o),this.off("dataChannelOpen",i),this.off("webRTCFailed",s)},s=()=>{clearTimeout(this.connectionTimeoutId),c(),r(new Error("Connection failed"))};this.dataChannel&&this.dataChannel.addEventListener("open",i),this.peerConnection&&this.peerConnection.addEventListener("connectionstatechange",o),this.on("dataChannelOpen",i),this.on("webRTCFailed",s)})}isPeerConnectionInitialized(){var t;return console.log("[WebRTCService] Peer connection state:",(t=this.peerConnection)==null?void 0:t.connectionState),this.peerConnection!==null&&this.peerConnection.connectionState!=="closed"}hasRemoteOffer(){return this.remoteOfferReceived}async waitForRemoteOffer(t=3e4){return console.log("[WebRTCService] Waiting for remote offer..."),new Promise((r,i)=>{const o=setTimeout(()=>{s(),console.log("[WebRTCService] Timeout waiting for remote offer"),i(new Error("Timeout waiting for remote offer"))},t),c=()=>{console.log("[WebRTCService] Remote offer received"),clearTimeout(o),s(),r()},s=()=>{this.client.off("remoteOfferReceived",c)};if(this.remoteOfferReceived){console.log("[WebRTCService] Remote offer already received"),clearTimeout(o),r();return}this.client.on("remoteOfferReceived",c)})}async handleOffer(t){console.log("[WebRTCService] Handling WebRTC offer:",t),this.peerConnection||(console.log("[WebRTCService] Creating new peer connection for offer"),await this.createPeerConnection());try{if(await this.peerConnection.setRemoteDescription(new RTCSessionDescription(t)),this.remoteOfferReceived=!0,this.client.emit("remoteOfferReceived"),console.log("[WebRTCService] Remote offer set successfully"),this.pendingCandidates.length>0){console.log(`[WebRTCService] Processing ${this.pendingCandidates.length} pending ICE candidates`);const r=[...this.pendingCandidates];this.pendingCandidates=[];for(const i of r)try{await this.peerConnection.addIceCandidate(new RTCIceCandidate(i)),console.log("[WebRTCService] Successfully added pending ICE candidate")}catch(o){console.warn("[WebRTCService] Failed to add pending ICE candidate:",o)}}}catch(r){throw console.error("[WebRTCService] Error handling offer:",r),r}}}var c0={exports:{}};function sB(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var l0={exports:{}};const aB={},cB=Object.freeze(Object.defineProperty({__proto__:null,default:aB},Symbol.toStringTag,{value:"Module"})),lB=FD(cB);var uB=l0.exports,tw;function _n(){return tw||(tw=1,function(n,e){(function(t,r){n.exports=r()})(uB,function(){var t=t||function(r,i){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof Jh<"u"&&Jh.crypto&&(o=Jh.crypto),!o&&typeof sB=="function")try{o=lB}catch{}var c=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function E(){}return function(R){var k;return E.prototype=R,k=new E,E.prototype=null,k}}(),l={},d=l.lib={},h=d.Base=function(){return{extend:function(E){var R=s(this);return E&&R.mixIn(E),(!R.hasOwnProperty("init")||this.init===R.init)&&(R.init=function(){R.$super.init.apply(this,arguments)}),R.init.prototype=R,R.$super=this,R},create:function(){var E=this.extend();return E.init.apply(E,arguments),E},init:function(){},mixIn:function(E){for(var R in E)E.hasOwnProperty(R)&&(this[R]=E[R]);E.hasOwnProperty("toString")&&(this.toString=E.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),p=d.WordArray=h.extend({init:function(E,R){E=this.words=E||[],R!=i?this.sigBytes=R:this.sigBytes=E.length*4},toString:function(E){return(E||y).stringify(this)},concat:function(E){var R=this.words,k=E.words,A=this.sigBytes,_=E.sigBytes;if(this.clamp(),A%4)for(var D=0;D<_;D++){var j=k[D>>>2]>>>24-D%4*8&255;R[A+D>>>2]|=j<<24-(A+D)%4*8}else for(var Z=0;Z<_;Z+=4)R[A+Z>>>2]=k[Z>>>2];return this.sigBytes+=_,this},clamp:function(){var E=this.words,R=this.sigBytes;E[R>>>2]&=4294967295<<32-R%4*8,E.length=r.ceil(R/4)},clone:function(){var E=h.clone.call(this);return E.words=this.words.slice(0),E},random:function(E){for(var R=[],k=0;k<E;k+=4)R.push(c());return new p.init(R,E)}}),g=l.enc={},y=g.Hex={stringify:function(E){for(var R=E.words,k=E.sigBytes,A=[],_=0;_<k;_++){var D=R[_>>>2]>>>24-_%4*8&255;A.push((D>>>4).toString(16)),A.push((D&15).toString(16))}return A.join("")},parse:function(E){for(var R=E.length,k=[],A=0;A<R;A+=2)k[A>>>3]|=parseInt(E.substr(A,2),16)<<24-A%8*4;return new p.init(k,R/2)}},C=g.Latin1={stringify:function(E){for(var R=E.words,k=E.sigBytes,A=[],_=0;_<k;_++){var D=R[_>>>2]>>>24-_%4*8&255;A.push(String.fromCharCode(D))}return A.join("")},parse:function(E){for(var R=E.length,k=[],A=0;A<R;A++)k[A>>>2]|=(E.charCodeAt(A)&255)<<24-A%4*8;return new p.init(k,R)}},x=g.Utf8={stringify:function(E){try{return decodeURIComponent(escape(C.stringify(E)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(E){return C.parse(unescape(encodeURIComponent(E)))}},w=d.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new p.init,this._nDataBytes=0},_append:function(E){typeof E=="string"&&(E=x.parse(E)),this._data.concat(E),this._nDataBytes+=E.sigBytes},_process:function(E){var R,k=this._data,A=k.words,_=k.sigBytes,D=this.blockSize,j=D*4,Z=_/j;E?Z=r.ceil(Z):Z=r.max((Z|0)-this._minBufferSize,0);var F=Z*D,V=r.min(F*4,_);if(F){for(var X=0;X<F;X+=D)this._doProcessBlock(A,X);R=A.splice(0,F),k.sigBytes-=V}return new p.init(R,V)},clone:function(){var E=h.clone.call(this);return E._data=this._data.clone(),E},_minBufferSize:0});d.Hasher=w.extend({cfg:h.extend(),init:function(E){this.cfg=this.cfg.extend(E),this.reset()},reset:function(){w.reset.call(this),this._doReset()},update:function(E){return this._append(E),this._process(),this},finalize:function(E){E&&this._append(E);var R=this._doFinalize();return R},blockSize:16,_createHelper:function(E){return function(R,k){return new E.init(k).finalize(R)}},_createHmacHelper:function(E){return function(R,k){return new S.HMAC.init(E,k).finalize(R)}}});var S=l.algo={};return l}(Math);return t})}(l0)),l0.exports}var u0={exports:{}},dB=u0.exports,nw;function Qp(){return nw||(nw=1,function(n,e){(function(t,r){n.exports=r(_n())})(dB,function(t){return function(r){var i=t,o=i.lib,c=o.Base,s=o.WordArray,l=i.x64={};l.Word=c.extend({init:function(d,h){this.high=d,this.low=h}}),l.WordArray=c.extend({init:function(d,h){d=this.words=d||[],h!=r?this.sigBytes=h:this.sigBytes=d.length*8},toX32:function(){for(var d=this.words,h=d.length,p=[],g=0;g<h;g++){var y=d[g];p.push(y.high),p.push(y.low)}return s.create(p,this.sigBytes)},clone:function(){for(var d=c.clone.call(this),h=d.words=this.words.slice(0),p=h.length,g=0;g<p;g++)h[g]=h[g].clone();return d}})}(),t})}(u0)),u0.exports}var d0={exports:{}},fB=d0.exports,rw;function hB(){return rw||(rw=1,function(n,e){(function(t,r){n.exports=r(_n())})(fB,function(t){return function(){if(typeof ArrayBuffer=="function"){var r=t,i=r.lib,o=i.WordArray,c=o.init,s=o.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var d=l.byteLength,h=[],p=0;p<d;p++)h[p>>>2]|=l[p]<<24-p%4*8;c.call(this,h,d)}else c.apply(this,arguments)};s.prototype=o}}(),t.lib.WordArray})}(d0)),d0.exports}var f0={exports:{}},pB=f0.exports,iw;function gB(){return iw||(iw=1,function(n,e){(function(t,r){n.exports=r(_n())})(pB,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,c=r.enc;c.Utf16=c.Utf16BE={stringify:function(l){for(var d=l.words,h=l.sigBytes,p=[],g=0;g<h;g+=2){var y=d[g>>>2]>>>16-g%4*8&65535;p.push(String.fromCharCode(y))}return p.join("")},parse:function(l){for(var d=l.length,h=[],p=0;p<d;p++)h[p>>>1]|=l.charCodeAt(p)<<16-p%2*16;return o.create(h,d*2)}},c.Utf16LE={stringify:function(l){for(var d=l.words,h=l.sigBytes,p=[],g=0;g<h;g+=2){var y=s(d[g>>>2]>>>16-g%4*8&65535);p.push(String.fromCharCode(y))}return p.join("")},parse:function(l){for(var d=l.length,h=[],p=0;p<d;p++)h[p>>>1]|=s(l.charCodeAt(p)<<16-p%2*16);return o.create(h,d*2)}};function s(l){return l<<8&4278255360|l>>>8&16711935}}(),t.enc.Utf16})}(f0)),f0.exports}var h0={exports:{}},mB=h0.exports,ow;function Fl(){return ow||(ow=1,function(n,e){(function(t,r){n.exports=r(_n())})(mB,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,c=r.enc;c.Base64={stringify:function(l){var d=l.words,h=l.sigBytes,p=this._map;l.clamp();for(var g=[],y=0;y<h;y+=3)for(var C=d[y>>>2]>>>24-y%4*8&255,x=d[y+1>>>2]>>>24-(y+1)%4*8&255,w=d[y+2>>>2]>>>24-(y+2)%4*8&255,S=C<<16|x<<8|w,E=0;E<4&&y+E*.75<h;E++)g.push(p.charAt(S>>>6*(3-E)&63));var R=p.charAt(64);if(R)for(;g.length%4;)g.push(R);return g.join("")},parse:function(l){var d=l.length,h=this._map,p=this._reverseMap;if(!p){p=this._reverseMap=[];for(var g=0;g<h.length;g++)p[h.charCodeAt(g)]=g}var y=h.charAt(64);if(y){var C=l.indexOf(y);C!==-1&&(d=C)}return s(l,d,p)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function s(l,d,h){for(var p=[],g=0,y=0;y<d;y++)if(y%4){var C=h[l.charCodeAt(y-1)]<<y%4*2,x=h[l.charCodeAt(y)]>>>6-y%4*2,w=C|x;p[g>>>2]|=w<<24-g%4*8,g++}return o.create(p,g)}}(),t.enc.Base64})}(h0)),h0.exports}var p0={exports:{}},vB=p0.exports,sw;function yB(){return sw||(sw=1,function(n,e){(function(t,r){n.exports=r(_n())})(vB,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,c=r.enc;c.Base64url={stringify:function(l,d){d===void 0&&(d=!0);var h=l.words,p=l.sigBytes,g=d?this._safe_map:this._map;l.clamp();for(var y=[],C=0;C<p;C+=3)for(var x=h[C>>>2]>>>24-C%4*8&255,w=h[C+1>>>2]>>>24-(C+1)%4*8&255,S=h[C+2>>>2]>>>24-(C+2)%4*8&255,E=x<<16|w<<8|S,R=0;R<4&&C+R*.75<p;R++)y.push(g.charAt(E>>>6*(3-R)&63));var k=g.charAt(64);if(k)for(;y.length%4;)y.push(k);return y.join("")},parse:function(l,d){d===void 0&&(d=!0);var h=l.length,p=d?this._safe_map:this._map,g=this._reverseMap;if(!g){g=this._reverseMap=[];for(var y=0;y<p.length;y++)g[p.charCodeAt(y)]=y}var C=p.charAt(64);if(C){var x=l.indexOf(C);x!==-1&&(h=x)}return s(l,h,g)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function s(l,d,h){for(var p=[],g=0,y=0;y<d;y++)if(y%4){var C=h[l.charCodeAt(y-1)]<<y%4*2,x=h[l.charCodeAt(y)]>>>6-y%4*2,w=C|x;p[g>>>2]|=w<<24-g%4*8,g++}return o.create(p,g)}}(),t.enc.Base64url})}(p0)),p0.exports}var g0={exports:{}},CB=g0.exports,aw;function Bl(){return aw||(aw=1,function(n,e){(function(t,r){n.exports=r(_n())})(CB,function(t){return function(r){var i=t,o=i.lib,c=o.WordArray,s=o.Hasher,l=i.algo,d=[];(function(){for(var x=0;x<64;x++)d[x]=r.abs(r.sin(x+1))*4294967296|0})();var h=l.MD5=s.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(x,w){for(var S=0;S<16;S++){var E=w+S,R=x[E];x[E]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360}var k=this._hash.words,A=x[w+0],_=x[w+1],D=x[w+2],j=x[w+3],Z=x[w+4],F=x[w+5],V=x[w+6],X=x[w+7],te=x[w+8],pe=x[w+9],ve=x[w+10],Ie=x[w+11],Re=x[w+12],xe=x[w+13],Ae=x[w+14],ke=x[w+15],H=k[0],ee=k[1],ae=k[2],ye=k[3];H=p(H,ee,ae,ye,A,7,d[0]),ye=p(ye,H,ee,ae,_,12,d[1]),ae=p(ae,ye,H,ee,D,17,d[2]),ee=p(ee,ae,ye,H,j,22,d[3]),H=p(H,ee,ae,ye,Z,7,d[4]),ye=p(ye,H,ee,ae,F,12,d[5]),ae=p(ae,ye,H,ee,V,17,d[6]),ee=p(ee,ae,ye,H,X,22,d[7]),H=p(H,ee,ae,ye,te,7,d[8]),ye=p(ye,H,ee,ae,pe,12,d[9]),ae=p(ae,ye,H,ee,ve,17,d[10]),ee=p(ee,ae,ye,H,Ie,22,d[11]),H=p(H,ee,ae,ye,Re,7,d[12]),ye=p(ye,H,ee,ae,xe,12,d[13]),ae=p(ae,ye,H,ee,Ae,17,d[14]),ee=p(ee,ae,ye,H,ke,22,d[15]),H=g(H,ee,ae,ye,_,5,d[16]),ye=g(ye,H,ee,ae,V,9,d[17]),ae=g(ae,ye,H,ee,Ie,14,d[18]),ee=g(ee,ae,ye,H,A,20,d[19]),H=g(H,ee,ae,ye,F,5,d[20]),ye=g(ye,H,ee,ae,ve,9,d[21]),ae=g(ae,ye,H,ee,ke,14,d[22]),ee=g(ee,ae,ye,H,Z,20,d[23]),H=g(H,ee,ae,ye,pe,5,d[24]),ye=g(ye,H,ee,ae,Ae,9,d[25]),ae=g(ae,ye,H,ee,j,14,d[26]),ee=g(ee,ae,ye,H,te,20,d[27]),H=g(H,ee,ae,ye,xe,5,d[28]),ye=g(ye,H,ee,ae,D,9,d[29]),ae=g(ae,ye,H,ee,X,14,d[30]),ee=g(ee,ae,ye,H,Re,20,d[31]),H=y(H,ee,ae,ye,F,4,d[32]),ye=y(ye,H,ee,ae,te,11,d[33]),ae=y(ae,ye,H,ee,Ie,16,d[34]),ee=y(ee,ae,ye,H,Ae,23,d[35]),H=y(H,ee,ae,ye,_,4,d[36]),ye=y(ye,H,ee,ae,Z,11,d[37]),ae=y(ae,ye,H,ee,X,16,d[38]),ee=y(ee,ae,ye,H,ve,23,d[39]),H=y(H,ee,ae,ye,xe,4,d[40]),ye=y(ye,H,ee,ae,A,11,d[41]),ae=y(ae,ye,H,ee,j,16,d[42]),ee=y(ee,ae,ye,H,V,23,d[43]),H=y(H,ee,ae,ye,pe,4,d[44]),ye=y(ye,H,ee,ae,Re,11,d[45]),ae=y(ae,ye,H,ee,ke,16,d[46]),ee=y(ee,ae,ye,H,D,23,d[47]),H=C(H,ee,ae,ye,A,6,d[48]),ye=C(ye,H,ee,ae,X,10,d[49]),ae=C(ae,ye,H,ee,Ae,15,d[50]),ee=C(ee,ae,ye,H,F,21,d[51]),H=C(H,ee,ae,ye,Re,6,d[52]),ye=C(ye,H,ee,ae,j,10,d[53]),ae=C(ae,ye,H,ee,ve,15,d[54]),ee=C(ee,ae,ye,H,_,21,d[55]),H=C(H,ee,ae,ye,te,6,d[56]),ye=C(ye,H,ee,ae,ke,10,d[57]),ae=C(ae,ye,H,ee,V,15,d[58]),ee=C(ee,ae,ye,H,xe,21,d[59]),H=C(H,ee,ae,ye,Z,6,d[60]),ye=C(ye,H,ee,ae,Ie,10,d[61]),ae=C(ae,ye,H,ee,D,15,d[62]),ee=C(ee,ae,ye,H,pe,21,d[63]),k[0]=k[0]+H|0,k[1]=k[1]+ee|0,k[2]=k[2]+ae|0,k[3]=k[3]+ye|0},_doFinalize:function(){var x=this._data,w=x.words,S=this._nDataBytes*8,E=x.sigBytes*8;w[E>>>5]|=128<<24-E%32;var R=r.floor(S/4294967296),k=S;w[(E+64>>>9<<4)+15]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,w[(E+64>>>9<<4)+14]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,x.sigBytes=(w.length+1)*4,this._process();for(var A=this._hash,_=A.words,D=0;D<4;D++){var j=_[D];_[D]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360}return A},clone:function(){var x=s.clone.call(this);return x._hash=this._hash.clone(),x}});function p(x,w,S,E,R,k,A){var _=x+(w&S|~w&E)+R+A;return(_<<k|_>>>32-k)+w}function g(x,w,S,E,R,k,A){var _=x+(w&E|S&~E)+R+A;return(_<<k|_>>>32-k)+w}function y(x,w,S,E,R,k,A){var _=x+(w^S^E)+R+A;return(_<<k|_>>>32-k)+w}function C(x,w,S,E,R,k,A){var _=x+(S^(w|~E))+R+A;return(_<<k|_>>>32-k)+w}i.MD5=s._createHelper(h),i.HmacMD5=s._createHmacHelper(h)}(Math),t.MD5})}(g0)),g0.exports}var m0={exports:{}},xB=m0.exports,cw;function ZE(){return cw||(cw=1,function(n,e){(function(t,r){n.exports=r(_n())})(xB,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,c=i.Hasher,s=r.algo,l=[],d=s.SHA1=c.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(h,p){for(var g=this._hash.words,y=g[0],C=g[1],x=g[2],w=g[3],S=g[4],E=0;E<80;E++){if(E<16)l[E]=h[p+E]|0;else{var R=l[E-3]^l[E-8]^l[E-14]^l[E-16];l[E]=R<<1|R>>>31}var k=(y<<5|y>>>27)+S+l[E];E<20?k+=(C&x|~C&w)+1518500249:E<40?k+=(C^x^w)+1859775393:E<60?k+=(C&x|C&w|x&w)-1894007588:k+=(C^x^w)-899497514,S=w,w=x,x=C<<30|C>>>2,C=y,y=k}g[0]=g[0]+y|0,g[1]=g[1]+C|0,g[2]=g[2]+x|0,g[3]=g[3]+w|0,g[4]=g[4]+S|0},_doFinalize:function(){var h=this._data,p=h.words,g=this._nDataBytes*8,y=h.sigBytes*8;return p[y>>>5]|=128<<24-y%32,p[(y+64>>>9<<4)+14]=Math.floor(g/4294967296),p[(y+64>>>9<<4)+15]=g,h.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var h=c.clone.call(this);return h._hash=this._hash.clone(),h}});r.SHA1=c._createHelper(d),r.HmacSHA1=c._createHmacHelper(d)}(),t.SHA1})}(m0)),m0.exports}var v0={exports:{}},bB=v0.exports,lw;function PC(){return lw||(lw=1,function(n,e){(function(t,r){n.exports=r(_n())})(bB,function(t){return function(r){var i=t,o=i.lib,c=o.WordArray,s=o.Hasher,l=i.algo,d=[],h=[];(function(){function y(S){for(var E=r.sqrt(S),R=2;R<=E;R++)if(!(S%R))return!1;return!0}function C(S){return(S-(S|0))*4294967296|0}for(var x=2,w=0;w<64;)y(x)&&(w<8&&(d[w]=C(r.pow(x,1/2))),h[w]=C(r.pow(x,1/3)),w++),x++})();var p=[],g=l.SHA256=s.extend({_doReset:function(){this._hash=new c.init(d.slice(0))},_doProcessBlock:function(y,C){for(var x=this._hash.words,w=x[0],S=x[1],E=x[2],R=x[3],k=x[4],A=x[5],_=x[6],D=x[7],j=0;j<64;j++){if(j<16)p[j]=y[C+j]|0;else{var Z=p[j-15],F=(Z<<25|Z>>>7)^(Z<<14|Z>>>18)^Z>>>3,V=p[j-2],X=(V<<15|V>>>17)^(V<<13|V>>>19)^V>>>10;p[j]=F+p[j-7]+X+p[j-16]}var te=k&A^~k&_,pe=w&S^w&E^S&E,ve=(w<<30|w>>>2)^(w<<19|w>>>13)^(w<<10|w>>>22),Ie=(k<<26|k>>>6)^(k<<21|k>>>11)^(k<<7|k>>>25),Re=D+Ie+te+h[j]+p[j],xe=ve+pe;D=_,_=A,A=k,k=R+Re|0,R=E,E=S,S=w,w=Re+xe|0}x[0]=x[0]+w|0,x[1]=x[1]+S|0,x[2]=x[2]+E|0,x[3]=x[3]+R|0,x[4]=x[4]+k|0,x[5]=x[5]+A|0,x[6]=x[6]+_|0,x[7]=x[7]+D|0},_doFinalize:function(){var y=this._data,C=y.words,x=this._nDataBytes*8,w=y.sigBytes*8;return C[w>>>5]|=128<<24-w%32,C[(w+64>>>9<<4)+14]=r.floor(x/4294967296),C[(w+64>>>9<<4)+15]=x,y.sigBytes=C.length*4,this._process(),this._hash},clone:function(){var y=s.clone.call(this);return y._hash=this._hash.clone(),y}});i.SHA256=s._createHelper(g),i.HmacSHA256=s._createHmacHelper(g)}(Math),t.SHA256})}(v0)),v0.exports}var y0={exports:{}},IB=y0.exports,uw;function wB(){return uw||(uw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),PC())})(IB,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,c=r.algo,s=c.SHA256,l=c.SHA224=s.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var d=s._doFinalize.call(this);return d.sigBytes-=4,d}});r.SHA224=s._createHelper(l),r.HmacSHA224=s._createHmacHelper(l)}(),t.SHA224})}(y0)),y0.exports}var C0={exports:{}},SB=C0.exports,dw;function XE(){return dw||(dw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),Qp())})(SB,function(t){return function(){var r=t,i=r.lib,o=i.Hasher,c=r.x64,s=c.Word,l=c.WordArray,d=r.algo;function h(){return s.create.apply(s,arguments)}var p=[h(1116352408,3609767458),h(1899447441,602891725),h(3049323471,3964484399),h(3921009573,2173295548),h(961987163,4081628472),h(1508970993,3053834265),h(2453635748,2937671579),h(2870763221,3664609560),h(3624381080,2734883394),h(310598401,1164996542),h(607225278,1323610764),h(1426881987,3590304994),h(1925078388,4068182383),h(2162078206,991336113),h(2614888103,633803317),h(3248222580,3479774868),h(3835390401,2666613458),h(4022224774,944711139),h(264347078,2341262773),h(604807628,2007800933),h(770255983,1495990901),h(1249150122,1856431235),h(1555081692,3175218132),h(1996064986,2198950837),h(2554220882,3999719339),h(2821834349,766784016),h(2952996808,2566594879),h(3210313671,3203337956),h(3336571891,1034457026),h(3584528711,2466948901),h(113926993,3758326383),h(338241895,168717936),h(666307205,1188179964),h(773529912,1546045734),h(1294757372,1522805485),h(1396182291,2643833823),h(1695183700,2343527390),h(1986661051,1014477480),h(2177026350,1206759142),h(2456956037,344077627),h(2730485921,1290863460),h(2820302411,3158454273),h(3259730800,3505952657),h(3345764771,106217008),h(3516065817,3606008344),h(3600352804,1432725776),h(4094571909,1467031594),h(275423344,851169720),h(430227734,3100823752),h(506948616,1363258195),h(659060556,3750685593),h(883997877,3785050280),h(958139571,3318307427),h(1322822218,3812723403),h(1537002063,2003034995),h(1747873779,3602036899),h(1955562222,1575990012),h(2024104815,1125592928),h(2227730452,2716904306),h(2361852424,442776044),h(2428436474,593698344),h(2756734187,3733110249),h(3204031479,2999351573),h(3329325298,3815920427),h(3391569614,3928383900),h(3515267271,566280711),h(3940187606,3454069534),h(4118630271,4000239992),h(116418474,1914138554),h(174292421,2731055270),h(289380356,3203993006),h(460393269,320620315),h(685471733,587496836),h(852142971,1086792851),h(1017036298,365543100),h(1126000580,2618297676),h(1288033470,3409855158),h(1501505948,4234509866),h(1607167915,987167468),h(1816402316,1246189591)],g=[];(function(){for(var C=0;C<80;C++)g[C]=h()})();var y=d.SHA512=o.extend({_doReset:function(){this._hash=new l.init([new s.init(1779033703,4089235720),new s.init(3144134277,2227873595),new s.init(1013904242,4271175723),new s.init(2773480762,1595750129),new s.init(1359893119,2917565137),new s.init(2600822924,725511199),new s.init(528734635,4215389547),new s.init(1541459225,327033209)])},_doProcessBlock:function(C,x){for(var w=this._hash.words,S=w[0],E=w[1],R=w[2],k=w[3],A=w[4],_=w[5],D=w[6],j=w[7],Z=S.high,F=S.low,V=E.high,X=E.low,te=R.high,pe=R.low,ve=k.high,Ie=k.low,Re=A.high,xe=A.low,Ae=_.high,ke=_.low,H=D.high,ee=D.low,ae=j.high,ye=j.low,Ee=Z,_e=F,Je=V,me=X,it=te,Tt=pe,Xt=ve,Et=Ie,St=Re,Pt=xe,at=Ae,lt=ke,Gt=H,Vt=ee,Dt=ae,Ht=ye,sn=0;sn<80;sn++){var ct,ce,rn=g[sn];if(sn<16)ce=rn.high=C[x+sn*2]|0,ct=rn.low=C[x+sn*2+1]|0;else{var mn=g[sn-15],Vn=mn.high,q=mn.low,N=(Vn>>>1|q<<31)^(Vn>>>8|q<<24)^Vn>>>7,L=(q>>>1|Vn<<31)^(q>>>8|Vn<<24)^(q>>>7|Vn<<25),ne=g[sn-2],Ce=ne.high,Pe=ne.low,Ve=(Ce>>>19|Pe<<13)^(Ce<<3|Pe>>>29)^Ce>>>6,Lt=(Pe>>>19|Ce<<13)^(Pe<<3|Ce>>>29)^(Pe>>>6|Ce<<26),hn=g[sn-7],pn=hn.high,xn=hn.low,dn=g[sn-16],Ln=dn.high,kr=dn.low;ct=L+xn,ce=N+pn+(ct>>>0<L>>>0?1:0),ct=ct+Lt,ce=ce+Ve+(ct>>>0<Lt>>>0?1:0),ct=ct+kr,ce=ce+Ln+(ct>>>0<kr>>>0?1:0),rn.high=ce,rn.low=ct}var yr=St&at^~St&Gt,Qt=Pt&lt^~Pt&Vt,ei=Ee&Je^Ee&it^Je&it,Qe=_e&me^_e&Tt^me&Tt,Tn=(Ee>>>28|_e<<4)^(Ee<<30|_e>>>2)^(Ee<<25|_e>>>7),Wt=(_e>>>28|Ee<<4)^(_e<<30|Ee>>>2)^(_e<<25|Ee>>>7),hr=(St>>>14|Pt<<18)^(St>>>18|Pt<<14)^(St<<23|Pt>>>9),Qn=(Pt>>>14|St<<18)^(Pt>>>18|St<<14)^(Pt<<23|St>>>9),ti=p[sn],Lr=ti.high,ge=ti.low,we=Ht+Qn,J=Dt+hr+(we>>>0<Ht>>>0?1:0),we=we+Qt,J=J+yr+(we>>>0<Qt>>>0?1:0),we=we+ge,J=J+Lr+(we>>>0<ge>>>0?1:0),we=we+ct,J=J+ce+(we>>>0<ct>>>0?1:0),Ge=Wt+Qe,rt=Tn+ei+(Ge>>>0<Wt>>>0?1:0);Dt=Gt,Ht=Vt,Gt=at,Vt=lt,at=St,lt=Pt,Pt=Et+we|0,St=Xt+J+(Pt>>>0<Et>>>0?1:0)|0,Xt=it,Et=Tt,it=Je,Tt=me,Je=Ee,me=_e,_e=we+Ge|0,Ee=J+rt+(_e>>>0<we>>>0?1:0)|0}F=S.low=F+_e,S.high=Z+Ee+(F>>>0<_e>>>0?1:0),X=E.low=X+me,E.high=V+Je+(X>>>0<me>>>0?1:0),pe=R.low=pe+Tt,R.high=te+it+(pe>>>0<Tt>>>0?1:0),Ie=k.low=Ie+Et,k.high=ve+Xt+(Ie>>>0<Et>>>0?1:0),xe=A.low=xe+Pt,A.high=Re+St+(xe>>>0<Pt>>>0?1:0),ke=_.low=ke+lt,_.high=Ae+at+(ke>>>0<lt>>>0?1:0),ee=D.low=ee+Vt,D.high=H+Gt+(ee>>>0<Vt>>>0?1:0),ye=j.low=ye+Ht,j.high=ae+Dt+(ye>>>0<Ht>>>0?1:0)},_doFinalize:function(){var C=this._data,x=C.words,w=this._nDataBytes*8,S=C.sigBytes*8;x[S>>>5]|=128<<24-S%32,x[(S+128>>>10<<5)+30]=Math.floor(w/4294967296),x[(S+128>>>10<<5)+31]=w,C.sigBytes=x.length*4,this._process();var E=this._hash.toX32();return E},clone:function(){var C=o.clone.call(this);return C._hash=this._hash.clone(),C},blockSize:1024/32});r.SHA512=o._createHelper(y),r.HmacSHA512=o._createHmacHelper(y)}(),t.SHA512})}(C0)),C0.exports}var x0={exports:{}},AB=x0.exports,fw;function kB(){return fw||(fw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),Qp(),XE())})(AB,function(t){return function(){var r=t,i=r.x64,o=i.Word,c=i.WordArray,s=r.algo,l=s.SHA512,d=s.SHA384=l.extend({_doReset:function(){this._hash=new c.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var h=l._doFinalize.call(this);return h.sigBytes-=16,h}});r.SHA384=l._createHelper(d),r.HmacSHA384=l._createHmacHelper(d)}(),t.SHA384})}(x0)),x0.exports}var b0={exports:{}},EB=b0.exports,hw;function TB(){return hw||(hw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),Qp())})(EB,function(t){return function(r){var i=t,o=i.lib,c=o.WordArray,s=o.Hasher,l=i.x64,d=l.Word,h=i.algo,p=[],g=[],y=[];(function(){for(var w=1,S=0,E=0;E<24;E++){p[w+5*S]=(E+1)*(E+2)/2%64;var R=S%5,k=(2*w+3*S)%5;w=R,S=k}for(var w=0;w<5;w++)for(var S=0;S<5;S++)g[w+5*S]=S+(2*w+3*S)%5*5;for(var A=1,_=0;_<24;_++){for(var D=0,j=0,Z=0;Z<7;Z++){if(A&1){var F=(1<<Z)-1;F<32?j^=1<<F:D^=1<<F-32}A&128?A=A<<1^113:A<<=1}y[_]=d.create(D,j)}})();var C=[];(function(){for(var w=0;w<25;w++)C[w]=d.create()})();var x=h.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var w=this._state=[],S=0;S<25;S++)w[S]=new d.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(w,S){for(var E=this._state,R=this.blockSize/2,k=0;k<R;k++){var A=w[S+2*k],_=w[S+2*k+1];A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,_=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360;var D=E[k];D.high^=_,D.low^=A}for(var j=0;j<24;j++){for(var Z=0;Z<5;Z++){for(var F=0,V=0,X=0;X<5;X++){var D=E[Z+5*X];F^=D.high,V^=D.low}var te=C[Z];te.high=F,te.low=V}for(var Z=0;Z<5;Z++)for(var pe=C[(Z+4)%5],ve=C[(Z+1)%5],Ie=ve.high,Re=ve.low,F=pe.high^(Ie<<1|Re>>>31),V=pe.low^(Re<<1|Ie>>>31),X=0;X<5;X++){var D=E[Z+5*X];D.high^=F,D.low^=V}for(var xe=1;xe<25;xe++){var F,V,D=E[xe],Ae=D.high,ke=D.low,H=p[xe];H<32?(F=Ae<<H|ke>>>32-H,V=ke<<H|Ae>>>32-H):(F=ke<<H-32|Ae>>>64-H,V=Ae<<H-32|ke>>>64-H);var ee=C[g[xe]];ee.high=F,ee.low=V}var ae=C[0],ye=E[0];ae.high=ye.high,ae.low=ye.low;for(var Z=0;Z<5;Z++)for(var X=0;X<5;X++){var xe=Z+5*X,D=E[xe],Ee=C[xe],_e=C[(Z+1)%5+5*X],Je=C[(Z+2)%5+5*X];D.high=Ee.high^~_e.high&Je.high,D.low=Ee.low^~_e.low&Je.low}var D=E[0],me=y[j];D.high^=me.high,D.low^=me.low}},_doFinalize:function(){var w=this._data,S=w.words;this._nDataBytes*8;var E=w.sigBytes*8,R=this.blockSize*32;S[E>>>5]|=1<<24-E%32,S[(r.ceil((E+1)/R)*R>>>5)-1]|=128,w.sigBytes=S.length*4,this._process();for(var k=this._state,A=this.cfg.outputLength/8,_=A/8,D=[],j=0;j<_;j++){var Z=k[j],F=Z.high,V=Z.low;F=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360,V=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,D.push(V),D.push(F)}return new c.init(D,A)},clone:function(){for(var w=s.clone.call(this),S=w._state=this._state.slice(0),E=0;E<25;E++)S[E]=S[E].clone();return w}});i.SHA3=s._createHelper(x),i.HmacSHA3=s._createHmacHelper(x)}(Math),t.SHA3})}(b0)),b0.exports}var I0={exports:{}},_B=I0.exports,pw;function RB(){return pw||(pw=1,function(n,e){(function(t,r){n.exports=r(_n())})(_B,function(t){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var i=t,o=i.lib,c=o.WordArray,s=o.Hasher,l=i.algo,d=c.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),h=c.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),p=c.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),g=c.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),y=c.create([0,1518500249,1859775393,2400959708,2840853838]),C=c.create([1352829926,1548603684,1836072691,2053994217,0]),x=l.RIPEMD160=s.extend({_doReset:function(){this._hash=c.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(_,D){for(var j=0;j<16;j++){var Z=D+j,F=_[Z];_[Z]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360}var V=this._hash.words,X=y.words,te=C.words,pe=d.words,ve=h.words,Ie=p.words,Re=g.words,xe,Ae,ke,H,ee,ae,ye,Ee,_e,Je;ae=xe=V[0],ye=Ae=V[1],Ee=ke=V[2],_e=H=V[3],Je=ee=V[4];for(var me,j=0;j<80;j+=1)me=xe+_[D+pe[j]]|0,j<16?me+=w(Ae,ke,H)+X[0]:j<32?me+=S(Ae,ke,H)+X[1]:j<48?me+=E(Ae,ke,H)+X[2]:j<64?me+=R(Ae,ke,H)+X[3]:me+=k(Ae,ke,H)+X[4],me=me|0,me=A(me,Ie[j]),me=me+ee|0,xe=ee,ee=H,H=A(ke,10),ke=Ae,Ae=me,me=ae+_[D+ve[j]]|0,j<16?me+=k(ye,Ee,_e)+te[0]:j<32?me+=R(ye,Ee,_e)+te[1]:j<48?me+=E(ye,Ee,_e)+te[2]:j<64?me+=S(ye,Ee,_e)+te[3]:me+=w(ye,Ee,_e)+te[4],me=me|0,me=A(me,Re[j]),me=me+Je|0,ae=Je,Je=_e,_e=A(Ee,10),Ee=ye,ye=me;me=V[1]+ke+_e|0,V[1]=V[2]+H+Je|0,V[2]=V[3]+ee+ae|0,V[3]=V[4]+xe+ye|0,V[4]=V[0]+Ae+Ee|0,V[0]=me},_doFinalize:function(){var _=this._data,D=_.words,j=this._nDataBytes*8,Z=_.sigBytes*8;D[Z>>>5]|=128<<24-Z%32,D[(Z+64>>>9<<4)+14]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,_.sigBytes=(D.length+1)*4,this._process();for(var F=this._hash,V=F.words,X=0;X<5;X++){var te=V[X];V[X]=(te<<8|te>>>24)&16711935|(te<<24|te>>>8)&4278255360}return F},clone:function(){var _=s.clone.call(this);return _._hash=this._hash.clone(),_}});function w(_,D,j){return _^D^j}function S(_,D,j){return _&D|~_&j}function E(_,D,j){return(_|~D)^j}function R(_,D,j){return _&j|D&~j}function k(_,D,j){return _^(D|~j)}function A(_,D){return _<<D|_>>>32-D}i.RIPEMD160=s._createHelper(x),i.HmacRIPEMD160=s._createHmacHelper(x)}(),t.RIPEMD160})}(I0)),I0.exports}var w0={exports:{}},DB=w0.exports,gw;function MC(){return gw||(gw=1,function(n,e){(function(t,r){n.exports=r(_n())})(DB,function(t){(function(){var r=t,i=r.lib,o=i.Base,c=r.enc,s=c.Utf8,l=r.algo;l.HMAC=o.extend({init:function(d,h){d=this._hasher=new d.init,typeof h=="string"&&(h=s.parse(h));var p=d.blockSize,g=p*4;h.sigBytes>g&&(h=d.finalize(h)),h.clamp();for(var y=this._oKey=h.clone(),C=this._iKey=h.clone(),x=y.words,w=C.words,S=0;S<p;S++)x[S]^=1549556828,w[S]^=909522486;y.sigBytes=C.sigBytes=g,this.reset()},reset:function(){var d=this._hasher;d.reset(),d.update(this._iKey)},update:function(d){return this._hasher.update(d),this},finalize:function(d){var h=this._hasher,p=h.finalize(d);h.reset();var g=h.finalize(this._oKey.clone().concat(p));return g}})})()})}(w0)),w0.exports}var S0={exports:{}},PB=S0.exports,mw;function MB(){return mw||(mw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),PC(),MC())})(PB,function(t){return function(){var r=t,i=r.lib,o=i.Base,c=i.WordArray,s=r.algo,l=s.SHA256,d=s.HMAC,h=s.PBKDF2=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(p){this.cfg=this.cfg.extend(p)},compute:function(p,g){for(var y=this.cfg,C=d.create(y.hasher,p),x=c.create(),w=c.create([1]),S=x.words,E=w.words,R=y.keySize,k=y.iterations;S.length<R;){var A=C.update(g).finalize(w);C.reset();for(var _=A.words,D=_.length,j=A,Z=1;Z<k;Z++){j=C.finalize(j),C.reset();for(var F=j.words,V=0;V<D;V++)_[V]^=F[V]}x.concat(A),E[0]++}return x.sigBytes=R*4,x}});r.PBKDF2=function(p,g,y){return h.create(y).compute(p,g)}}(),t.PBKDF2})}(S0)),S0.exports}var A0={exports:{}},NB=A0.exports,vw;function Uc(){return vw||(vw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),ZE(),MC())})(NB,function(t){return function(){var r=t,i=r.lib,o=i.Base,c=i.WordArray,s=r.algo,l=s.MD5,d=s.EvpKDF=o.extend({cfg:o.extend({keySize:128/32,hasher:l,iterations:1}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,p){for(var g,y=this.cfg,C=y.hasher.create(),x=c.create(),w=x.words,S=y.keySize,E=y.iterations;w.length<S;){g&&C.update(g),g=C.update(h).finalize(p),C.reset();for(var R=1;R<E;R++)g=C.finalize(g),C.reset();x.concat(g)}return x.sigBytes=S*4,x}});r.EvpKDF=function(h,p,g){return d.create(g).compute(h,p)}}(),t.EvpKDF})}(A0)),A0.exports}var k0={exports:{}},OB=k0.exports,yw;function fi(){return yw||(yw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),Uc())})(OB,function(t){t.lib.Cipher||function(r){var i=t,o=i.lib,c=o.Base,s=o.WordArray,l=o.BufferedBlockAlgorithm,d=i.enc;d.Utf8;var h=d.Base64,p=i.algo,g=p.EvpKDF,y=o.Cipher=l.extend({cfg:c.extend(),createEncryptor:function(F,V){return this.create(this._ENC_XFORM_MODE,F,V)},createDecryptor:function(F,V){return this.create(this._DEC_XFORM_MODE,F,V)},init:function(F,V,X){this.cfg=this.cfg.extend(X),this._xformMode=F,this._key=V,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(F){return this._append(F),this._process()},finalize:function(F){F&&this._append(F);var V=this._doFinalize();return V},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function F(V){return typeof V=="string"?Z:_}return function(V){return{encrypt:function(X,te,pe){return F(te).encrypt(V,X,te,pe)},decrypt:function(X,te,pe){return F(te).decrypt(V,X,te,pe)}}}}()});o.StreamCipher=y.extend({_doFinalize:function(){var F=this._process(!0);return F},blockSize:1});var C=i.mode={},x=o.BlockCipherMode=c.extend({createEncryptor:function(F,V){return this.Encryptor.create(F,V)},createDecryptor:function(F,V){return this.Decryptor.create(F,V)},init:function(F,V){this._cipher=F,this._iv=V}}),w=C.CBC=function(){var F=x.extend();F.Encryptor=F.extend({processBlock:function(X,te){var pe=this._cipher,ve=pe.blockSize;V.call(this,X,te,ve),pe.encryptBlock(X,te),this._prevBlock=X.slice(te,te+ve)}}),F.Decryptor=F.extend({processBlock:function(X,te){var pe=this._cipher,ve=pe.blockSize,Ie=X.slice(te,te+ve);pe.decryptBlock(X,te),V.call(this,X,te,ve),this._prevBlock=Ie}});function V(X,te,pe){var ve,Ie=this._iv;Ie?(ve=Ie,this._iv=r):ve=this._prevBlock;for(var Re=0;Re<pe;Re++)X[te+Re]^=ve[Re]}return F}(),S=i.pad={},E=S.Pkcs7={pad:function(F,V){for(var X=V*4,te=X-F.sigBytes%X,pe=te<<24|te<<16|te<<8|te,ve=[],Ie=0;Ie<te;Ie+=4)ve.push(pe);var Re=s.create(ve,te);F.concat(Re)},unpad:function(F){var V=F.words[F.sigBytes-1>>>2]&255;F.sigBytes-=V}};o.BlockCipher=y.extend({cfg:y.cfg.extend({mode:w,padding:E}),reset:function(){var F;y.reset.call(this);var V=this.cfg,X=V.iv,te=V.mode;this._xformMode==this._ENC_XFORM_MODE?F=te.createEncryptor:(F=te.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==F?this._mode.init(this,X&&X.words):(this._mode=F.call(te,this,X&&X.words),this._mode.__creator=F)},_doProcessBlock:function(F,V){this._mode.processBlock(F,V)},_doFinalize:function(){var F,V=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(V.pad(this._data,this.blockSize),F=this._process(!0)):(F=this._process(!0),V.unpad(F)),F},blockSize:128/32});var R=o.CipherParams=c.extend({init:function(F){this.mixIn(F)},toString:function(F){return(F||this.formatter).stringify(this)}}),k=i.format={},A=k.OpenSSL={stringify:function(F){var V,X=F.ciphertext,te=F.salt;return te?V=s.create([1398893684,1701076831]).concat(te).concat(X):V=X,V.toString(h)},parse:function(F){var V,X=h.parse(F),te=X.words;return te[0]==1398893684&&te[1]==1701076831&&(V=s.create(te.slice(2,4)),te.splice(0,4),X.sigBytes-=16),R.create({ciphertext:X,salt:V})}},_=o.SerializableCipher=c.extend({cfg:c.extend({format:A}),encrypt:function(F,V,X,te){te=this.cfg.extend(te);var pe=F.createEncryptor(X,te),ve=pe.finalize(V),Ie=pe.cfg;return R.create({ciphertext:ve,key:X,iv:Ie.iv,algorithm:F,mode:Ie.mode,padding:Ie.padding,blockSize:F.blockSize,formatter:te.format})},decrypt:function(F,V,X,te){te=this.cfg.extend(te),V=this._parse(V,te.format);var pe=F.createDecryptor(X,te).finalize(V.ciphertext);return pe},_parse:function(F,V){return typeof F=="string"?V.parse(F,this):F}}),D=i.kdf={},j=D.OpenSSL={execute:function(F,V,X,te,pe){if(te||(te=s.random(64/8)),pe)var ve=g.create({keySize:V+X,hasher:pe}).compute(F,te);else var ve=g.create({keySize:V+X}).compute(F,te);var Ie=s.create(ve.words.slice(V),X*4);return ve.sigBytes=V*4,R.create({key:ve,iv:Ie,salt:te})}},Z=o.PasswordBasedCipher=_.extend({cfg:_.cfg.extend({kdf:j}),encrypt:function(F,V,X,te){te=this.cfg.extend(te);var pe=te.kdf.execute(X,F.keySize,F.ivSize,te.salt,te.hasher);te.iv=pe.iv;var ve=_.encrypt.call(this,F,V,pe.key,te);return ve.mixIn(pe),ve},decrypt:function(F,V,X,te){te=this.cfg.extend(te),V=this._parse(V,te.format);var pe=te.kdf.execute(X,F.keySize,F.ivSize,V.salt,te.hasher);te.iv=pe.iv;var ve=_.decrypt.call(this,F,V,pe.key,te);return ve}})}()})}(k0)),k0.exports}var E0={exports:{}},FB=E0.exports,Cw;function BB(){return Cw||(Cw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),fi())})(FB,function(t){return t.mode.CFB=function(){var r=t.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(o,c){var s=this._cipher,l=s.blockSize;i.call(this,o,c,l,s),this._prevBlock=o.slice(c,c+l)}}),r.Decryptor=r.extend({processBlock:function(o,c){var s=this._cipher,l=s.blockSize,d=o.slice(c,c+l);i.call(this,o,c,l,s),this._prevBlock=d}});function i(o,c,s,l){var d,h=this._iv;h?(d=h.slice(0),this._iv=void 0):d=this._prevBlock,l.encryptBlock(d,0);for(var p=0;p<s;p++)o[c+p]^=d[p]}return r}(),t.mode.CFB})}(E0)),E0.exports}var T0={exports:{}},LB=T0.exports,xw;function UB(){return xw||(xw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),fi())})(LB,function(t){return t.mode.CTR=function(){var r=t.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,c){var s=this._cipher,l=s.blockSize,d=this._iv,h=this._counter;d&&(h=this._counter=d.slice(0),this._iv=void 0);var p=h.slice(0);s.encryptBlock(p,0),h[l-1]=h[l-1]+1|0;for(var g=0;g<l;g++)o[c+g]^=p[g]}});return r.Decryptor=i,r}(),t.mode.CTR})}(T0)),T0.exports}var _0={exports:{}},jB=_0.exports,bw;function VB(){return bw||(bw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),fi())})(jB,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var r=t.lib.BlockCipherMode.extend();function i(s){if((s>>24&255)===255){var l=s>>16&255,d=s>>8&255,h=s&255;l===255?(l=0,d===255?(d=0,h===255?h=0:++h):++d):++l,s=0,s+=l<<16,s+=d<<8,s+=h}else s+=1<<24;return s}function o(s){return(s[0]=i(s[0]))===0&&(s[1]=i(s[1])),s}var c=r.Encryptor=r.extend({processBlock:function(s,l){var d=this._cipher,h=d.blockSize,p=this._iv,g=this._counter;p&&(g=this._counter=p.slice(0),this._iv=void 0),o(g);var y=g.slice(0);d.encryptBlock(y,0);for(var C=0;C<h;C++)s[l+C]^=y[C]}});return r.Decryptor=c,r}(),t.mode.CTRGladman})}(_0)),_0.exports}var R0={exports:{}},GB=R0.exports,Iw;function WB(){return Iw||(Iw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),fi())})(GB,function(t){return t.mode.OFB=function(){var r=t.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(o,c){var s=this._cipher,l=s.blockSize,d=this._iv,h=this._keystream;d&&(h=this._keystream=d.slice(0),this._iv=void 0),s.encryptBlock(h,0);for(var p=0;p<l;p++)o[c+p]^=h[p]}});return r.Decryptor=i,r}(),t.mode.OFB})}(R0)),R0.exports}var D0={exports:{}},zB=D0.exports,ww;function HB(){return ww||(ww=1,function(n,e){(function(t,r,i){n.exports=r(_n(),fi())})(zB,function(t){return t.mode.ECB=function(){var r=t.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(i,o){this._cipher.encryptBlock(i,o)}}),r.Decryptor=r.extend({processBlock:function(i,o){this._cipher.decryptBlock(i,o)}}),r}(),t.mode.ECB})}(D0)),D0.exports}var P0={exports:{}},ZB=P0.exports,Sw;function XB(){return Sw||(Sw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),fi())})(ZB,function(t){return t.pad.AnsiX923={pad:function(r,i){var o=r.sigBytes,c=i*4,s=c-o%c,l=o+s-1;r.clamp(),r.words[l>>>2]|=s<<24-l%4*8,r.sigBytes+=s},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},t.pad.Ansix923})}(P0)),P0.exports}var M0={exports:{}},$B=M0.exports,Aw;function KB(){return Aw||(Aw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),fi())})($B,function(t){return t.pad.Iso10126={pad:function(r,i){var o=i*4,c=o-r.sigBytes%o;r.concat(t.lib.WordArray.random(c-1)).concat(t.lib.WordArray.create([c<<24],1))},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},t.pad.Iso10126})}(M0)),M0.exports}var N0={exports:{}},qB=N0.exports,kw;function YB(){return kw||(kw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),fi())})(qB,function(t){return t.pad.Iso97971={pad:function(r,i){r.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(r,i)},unpad:function(r){t.pad.ZeroPadding.unpad(r),r.sigBytes--}},t.pad.Iso97971})}(N0)),N0.exports}var O0={exports:{}},QB=O0.exports,Ew;function JB(){return Ew||(Ew=1,function(n,e){(function(t,r,i){n.exports=r(_n(),fi())})(QB,function(t){return t.pad.ZeroPadding={pad:function(r,i){var o=i*4;r.clamp(),r.sigBytes+=o-(r.sigBytes%o||o)},unpad:function(r){for(var i=r.words,o=r.sigBytes-1,o=r.sigBytes-1;o>=0;o--)if(i[o>>>2]>>>24-o%4*8&255){r.sigBytes=o+1;break}}},t.pad.ZeroPadding})}(O0)),O0.exports}var F0={exports:{}},eL=F0.exports,Tw;function tL(){return Tw||(Tw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),fi())})(eL,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(F0)),F0.exports}var B0={exports:{}},nL=B0.exports,_w;function rL(){return _w||(_w=1,function(n,e){(function(t,r,i){n.exports=r(_n(),fi())})(nL,function(t){return function(r){var i=t,o=i.lib,c=o.CipherParams,s=i.enc,l=s.Hex,d=i.format;d.Hex={stringify:function(h){return h.ciphertext.toString(l)},parse:function(h){var p=l.parse(h);return c.create({ciphertext:p})}}}(),t.format.Hex})}(B0)),B0.exports}var L0={exports:{}},iL=L0.exports,Rw;function oL(){return Rw||(Rw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),Fl(),Bl(),Uc(),fi())})(iL,function(t){return function(){var r=t,i=r.lib,o=i.BlockCipher,c=r.algo,s=[],l=[],d=[],h=[],p=[],g=[],y=[],C=[],x=[],w=[];(function(){for(var R=[],k=0;k<256;k++)k<128?R[k]=k<<1:R[k]=k<<1^283;for(var A=0,_=0,k=0;k<256;k++){var D=_^_<<1^_<<2^_<<3^_<<4;D=D>>>8^D&255^99,s[A]=D,l[D]=A;var j=R[A],Z=R[j],F=R[Z],V=R[D]*257^D*16843008;d[A]=V<<24|V>>>8,h[A]=V<<16|V>>>16,p[A]=V<<8|V>>>24,g[A]=V;var V=F*16843009^Z*65537^j*257^A*16843008;y[D]=V<<24|V>>>8,C[D]=V<<16|V>>>16,x[D]=V<<8|V>>>24,w[D]=V,A?(A=j^R[R[R[F^j]]],_^=R[R[_]]):A=_=1}})();var S=[0,1,2,4,8,16,32,64,128,27,54],E=c.AES=o.extend({_doReset:function(){var R;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var k=this._keyPriorReset=this._key,A=k.words,_=k.sigBytes/4,D=this._nRounds=_+6,j=(D+1)*4,Z=this._keySchedule=[],F=0;F<j;F++)F<_?Z[F]=A[F]:(R=Z[F-1],F%_?_>6&&F%_==4&&(R=s[R>>>24]<<24|s[R>>>16&255]<<16|s[R>>>8&255]<<8|s[R&255]):(R=R<<8|R>>>24,R=s[R>>>24]<<24|s[R>>>16&255]<<16|s[R>>>8&255]<<8|s[R&255],R^=S[F/_|0]<<24),Z[F]=Z[F-_]^R);for(var V=this._invKeySchedule=[],X=0;X<j;X++){var F=j-X;if(X%4)var R=Z[F];else var R=Z[F-4];X<4||F<=4?V[X]=R:V[X]=y[s[R>>>24]]^C[s[R>>>16&255]]^x[s[R>>>8&255]]^w[s[R&255]]}}},encryptBlock:function(R,k){this._doCryptBlock(R,k,this._keySchedule,d,h,p,g,s)},decryptBlock:function(R,k){var A=R[k+1];R[k+1]=R[k+3],R[k+3]=A,this._doCryptBlock(R,k,this._invKeySchedule,y,C,x,w,l);var A=R[k+1];R[k+1]=R[k+3],R[k+3]=A},_doCryptBlock:function(R,k,A,_,D,j,Z,F){for(var V=this._nRounds,X=R[k]^A[0],te=R[k+1]^A[1],pe=R[k+2]^A[2],ve=R[k+3]^A[3],Ie=4,Re=1;Re<V;Re++){var xe=_[X>>>24]^D[te>>>16&255]^j[pe>>>8&255]^Z[ve&255]^A[Ie++],Ae=_[te>>>24]^D[pe>>>16&255]^j[ve>>>8&255]^Z[X&255]^A[Ie++],ke=_[pe>>>24]^D[ve>>>16&255]^j[X>>>8&255]^Z[te&255]^A[Ie++],H=_[ve>>>24]^D[X>>>16&255]^j[te>>>8&255]^Z[pe&255]^A[Ie++];X=xe,te=Ae,pe=ke,ve=H}var xe=(F[X>>>24]<<24|F[te>>>16&255]<<16|F[pe>>>8&255]<<8|F[ve&255])^A[Ie++],Ae=(F[te>>>24]<<24|F[pe>>>16&255]<<16|F[ve>>>8&255]<<8|F[X&255])^A[Ie++],ke=(F[pe>>>24]<<24|F[ve>>>16&255]<<16|F[X>>>8&255]<<8|F[te&255])^A[Ie++],H=(F[ve>>>24]<<24|F[X>>>16&255]<<16|F[te>>>8&255]<<8|F[pe&255])^A[Ie++];R[k]=xe,R[k+1]=Ae,R[k+2]=ke,R[k+3]=H},keySize:256/32});r.AES=o._createHelper(E)}(),t.AES})}(L0)),L0.exports}var U0={exports:{}},sL=U0.exports,Dw;function aL(){return Dw||(Dw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),Fl(),Bl(),Uc(),fi())})(sL,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,c=i.BlockCipher,s=r.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],d=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],p=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],g=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],y=s.DES=c.extend({_doReset:function(){for(var S=this._key,E=S.words,R=[],k=0;k<56;k++){var A=l[k]-1;R[k]=E[A>>>5]>>>31-A%32&1}for(var _=this._subKeys=[],D=0;D<16;D++){for(var j=_[D]=[],Z=h[D],k=0;k<24;k++)j[k/6|0]|=R[(d[k]-1+Z)%28]<<31-k%6,j[4+(k/6|0)]|=R[28+(d[k+24]-1+Z)%28]<<31-k%6;j[0]=j[0]<<1|j[0]>>>31;for(var k=1;k<7;k++)j[k]=j[k]>>>(k-1)*4+3;j[7]=j[7]<<5|j[7]>>>27}for(var F=this._invSubKeys=[],k=0;k<16;k++)F[k]=_[15-k]},encryptBlock:function(S,E){this._doCryptBlock(S,E,this._subKeys)},decryptBlock:function(S,E){this._doCryptBlock(S,E,this._invSubKeys)},_doCryptBlock:function(S,E,R){this._lBlock=S[E],this._rBlock=S[E+1],C.call(this,4,252645135),C.call(this,16,65535),x.call(this,2,858993459),x.call(this,8,16711935),C.call(this,1,1431655765);for(var k=0;k<16;k++){for(var A=R[k],_=this._lBlock,D=this._rBlock,j=0,Z=0;Z<8;Z++)j|=p[Z][((D^A[Z])&g[Z])>>>0];this._lBlock=D,this._rBlock=_^j}var F=this._lBlock;this._lBlock=this._rBlock,this._rBlock=F,C.call(this,1,1431655765),x.call(this,8,16711935),x.call(this,2,858993459),C.call(this,16,65535),C.call(this,4,252645135),S[E]=this._lBlock,S[E+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function C(S,E){var R=(this._lBlock>>>S^this._rBlock)&E;this._rBlock^=R,this._lBlock^=R<<S}function x(S,E){var R=(this._rBlock>>>S^this._lBlock)&E;this._lBlock^=R,this._rBlock^=R<<S}r.DES=c._createHelper(y);var w=s.TripleDES=c.extend({_doReset:function(){var S=this._key,E=S.words;if(E.length!==2&&E.length!==4&&E.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var R=E.slice(0,2),k=E.length<4?E.slice(0,2):E.slice(2,4),A=E.length<6?E.slice(0,2):E.slice(4,6);this._des1=y.createEncryptor(o.create(R)),this._des2=y.createEncryptor(o.create(k)),this._des3=y.createEncryptor(o.create(A))},encryptBlock:function(S,E){this._des1.encryptBlock(S,E),this._des2.decryptBlock(S,E),this._des3.encryptBlock(S,E)},decryptBlock:function(S,E){this._des3.decryptBlock(S,E),this._des2.encryptBlock(S,E),this._des1.decryptBlock(S,E)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=c._createHelper(w)}(),t.TripleDES})}(U0)),U0.exports}var j0={exports:{}},cL=j0.exports,Pw;function lL(){return Pw||(Pw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),Fl(),Bl(),Uc(),fi())})(cL,function(t){return function(){var r=t,i=r.lib,o=i.StreamCipher,c=r.algo,s=c.RC4=o.extend({_doReset:function(){for(var h=this._key,p=h.words,g=h.sigBytes,y=this._S=[],C=0;C<256;C++)y[C]=C;for(var C=0,x=0;C<256;C++){var w=C%g,S=p[w>>>2]>>>24-w%4*8&255;x=(x+y[C]+S)%256;var E=y[C];y[C]=y[x],y[x]=E}this._i=this._j=0},_doProcessBlock:function(h,p){h[p]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var h=this._S,p=this._i,g=this._j,y=0,C=0;C<4;C++){p=(p+1)%256,g=(g+h[p])%256;var x=h[p];h[p]=h[g],h[g]=x,y|=h[(h[p]+h[g])%256]<<24-C*8}return this._i=p,this._j=g,y}r.RC4=o._createHelper(s);var d=c.RC4Drop=s.extend({cfg:s.cfg.extend({drop:192}),_doReset:function(){s._doReset.call(this);for(var h=this.cfg.drop;h>0;h--)l.call(this)}});r.RC4Drop=o._createHelper(d)}(),t.RC4})}(j0)),j0.exports}var V0={exports:{}},uL=V0.exports,Mw;function dL(){return Mw||(Mw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),Fl(),Bl(),Uc(),fi())})(uL,function(t){return function(){var r=t,i=r.lib,o=i.StreamCipher,c=r.algo,s=[],l=[],d=[],h=c.Rabbit=o.extend({_doReset:function(){for(var g=this._key.words,y=this.cfg.iv,C=0;C<4;C++)g[C]=(g[C]<<8|g[C]>>>24)&16711935|(g[C]<<24|g[C]>>>8)&4278255360;var x=this._X=[g[0],g[3]<<16|g[2]>>>16,g[1],g[0]<<16|g[3]>>>16,g[2],g[1]<<16|g[0]>>>16,g[3],g[2]<<16|g[1]>>>16],w=this._C=[g[2]<<16|g[2]>>>16,g[0]&4294901760|g[1]&65535,g[3]<<16|g[3]>>>16,g[1]&4294901760|g[2]&65535,g[0]<<16|g[0]>>>16,g[2]&4294901760|g[3]&65535,g[1]<<16|g[1]>>>16,g[3]&4294901760|g[0]&65535];this._b=0;for(var C=0;C<4;C++)p.call(this);for(var C=0;C<8;C++)w[C]^=x[C+4&7];if(y){var S=y.words,E=S[0],R=S[1],k=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,A=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,_=k>>>16|A&4294901760,D=A<<16|k&65535;w[0]^=k,w[1]^=_,w[2]^=A,w[3]^=D,w[4]^=k,w[5]^=_,w[6]^=A,w[7]^=D;for(var C=0;C<4;C++)p.call(this)}},_doProcessBlock:function(g,y){var C=this._X;p.call(this),s[0]=C[0]^C[5]>>>16^C[3]<<16,s[1]=C[2]^C[7]>>>16^C[5]<<16,s[2]=C[4]^C[1]>>>16^C[7]<<16,s[3]=C[6]^C[3]>>>16^C[1]<<16;for(var x=0;x<4;x++)s[x]=(s[x]<<8|s[x]>>>24)&16711935|(s[x]<<24|s[x]>>>8)&4278255360,g[y+x]^=s[x]},blockSize:128/32,ivSize:64/32});function p(){for(var g=this._X,y=this._C,C=0;C<8;C++)l[C]=y[C];y[0]=y[0]+1295307597+this._b|0,y[1]=y[1]+3545052371+(y[0]>>>0<l[0]>>>0?1:0)|0,y[2]=y[2]+886263092+(y[1]>>>0<l[1]>>>0?1:0)|0,y[3]=y[3]+1295307597+(y[2]>>>0<l[2]>>>0?1:0)|0,y[4]=y[4]+3545052371+(y[3]>>>0<l[3]>>>0?1:0)|0,y[5]=y[5]+886263092+(y[4]>>>0<l[4]>>>0?1:0)|0,y[6]=y[6]+1295307597+(y[5]>>>0<l[5]>>>0?1:0)|0,y[7]=y[7]+3545052371+(y[6]>>>0<l[6]>>>0?1:0)|0,this._b=y[7]>>>0<l[7]>>>0?1:0;for(var C=0;C<8;C++){var x=g[C]+y[C],w=x&65535,S=x>>>16,E=((w*w>>>17)+w*S>>>15)+S*S,R=((x&4294901760)*x|0)+((x&65535)*x|0);d[C]=E^R}g[0]=d[0]+(d[7]<<16|d[7]>>>16)+(d[6]<<16|d[6]>>>16)|0,g[1]=d[1]+(d[0]<<8|d[0]>>>24)+d[7]|0,g[2]=d[2]+(d[1]<<16|d[1]>>>16)+(d[0]<<16|d[0]>>>16)|0,g[3]=d[3]+(d[2]<<8|d[2]>>>24)+d[1]|0,g[4]=d[4]+(d[3]<<16|d[3]>>>16)+(d[2]<<16|d[2]>>>16)|0,g[5]=d[5]+(d[4]<<8|d[4]>>>24)+d[3]|0,g[6]=d[6]+(d[5]<<16|d[5]>>>16)+(d[4]<<16|d[4]>>>16)|0,g[7]=d[7]+(d[6]<<8|d[6]>>>24)+d[5]|0}r.Rabbit=o._createHelper(h)}(),t.Rabbit})}(V0)),V0.exports}var G0={exports:{}},fL=G0.exports,Nw;function hL(){return Nw||(Nw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),Fl(),Bl(),Uc(),fi())})(fL,function(t){return function(){var r=t,i=r.lib,o=i.StreamCipher,c=r.algo,s=[],l=[],d=[],h=c.RabbitLegacy=o.extend({_doReset:function(){var g=this._key.words,y=this.cfg.iv,C=this._X=[g[0],g[3]<<16|g[2]>>>16,g[1],g[0]<<16|g[3]>>>16,g[2],g[1]<<16|g[0]>>>16,g[3],g[2]<<16|g[1]>>>16],x=this._C=[g[2]<<16|g[2]>>>16,g[0]&4294901760|g[1]&65535,g[3]<<16|g[3]>>>16,g[1]&4294901760|g[2]&65535,g[0]<<16|g[0]>>>16,g[2]&4294901760|g[3]&65535,g[1]<<16|g[1]>>>16,g[3]&4294901760|g[0]&65535];this._b=0;for(var w=0;w<4;w++)p.call(this);for(var w=0;w<8;w++)x[w]^=C[w+4&7];if(y){var S=y.words,E=S[0],R=S[1],k=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,A=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,_=k>>>16|A&4294901760,D=A<<16|k&65535;x[0]^=k,x[1]^=_,x[2]^=A,x[3]^=D,x[4]^=k,x[5]^=_,x[6]^=A,x[7]^=D;for(var w=0;w<4;w++)p.call(this)}},_doProcessBlock:function(g,y){var C=this._X;p.call(this),s[0]=C[0]^C[5]>>>16^C[3]<<16,s[1]=C[2]^C[7]>>>16^C[5]<<16,s[2]=C[4]^C[1]>>>16^C[7]<<16,s[3]=C[6]^C[3]>>>16^C[1]<<16;for(var x=0;x<4;x++)s[x]=(s[x]<<8|s[x]>>>24)&16711935|(s[x]<<24|s[x]>>>8)&4278255360,g[y+x]^=s[x]},blockSize:128/32,ivSize:64/32});function p(){for(var g=this._X,y=this._C,C=0;C<8;C++)l[C]=y[C];y[0]=y[0]+1295307597+this._b|0,y[1]=y[1]+3545052371+(y[0]>>>0<l[0]>>>0?1:0)|0,y[2]=y[2]+886263092+(y[1]>>>0<l[1]>>>0?1:0)|0,y[3]=y[3]+1295307597+(y[2]>>>0<l[2]>>>0?1:0)|0,y[4]=y[4]+3545052371+(y[3]>>>0<l[3]>>>0?1:0)|0,y[5]=y[5]+886263092+(y[4]>>>0<l[4]>>>0?1:0)|0,y[6]=y[6]+1295307597+(y[5]>>>0<l[5]>>>0?1:0)|0,y[7]=y[7]+3545052371+(y[6]>>>0<l[6]>>>0?1:0)|0,this._b=y[7]>>>0<l[7]>>>0?1:0;for(var C=0;C<8;C++){var x=g[C]+y[C],w=x&65535,S=x>>>16,E=((w*w>>>17)+w*S>>>15)+S*S,R=((x&4294901760)*x|0)+((x&65535)*x|0);d[C]=E^R}g[0]=d[0]+(d[7]<<16|d[7]>>>16)+(d[6]<<16|d[6]>>>16)|0,g[1]=d[1]+(d[0]<<8|d[0]>>>24)+d[7]|0,g[2]=d[2]+(d[1]<<16|d[1]>>>16)+(d[0]<<16|d[0]>>>16)|0,g[3]=d[3]+(d[2]<<8|d[2]>>>24)+d[1]|0,g[4]=d[4]+(d[3]<<16|d[3]>>>16)+(d[2]<<16|d[2]>>>16)|0,g[5]=d[5]+(d[4]<<8|d[4]>>>24)+d[3]|0,g[6]=d[6]+(d[5]<<16|d[5]>>>16)+(d[4]<<16|d[4]>>>16)|0,g[7]=d[7]+(d[6]<<8|d[6]>>>24)+d[5]|0}r.RabbitLegacy=o._createHelper(h)}(),t.RabbitLegacy})}(G0)),G0.exports}var W0={exports:{}},pL=W0.exports,Ow;function gL(){return Ow||(Ow=1,function(n,e){(function(t,r,i){n.exports=r(_n(),Fl(),Bl(),Uc(),fi())})(pL,function(t){return function(){var r=t,i=r.lib,o=i.BlockCipher,c=r.algo;const s=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],d=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var h={pbox:[],sbox:[]};function p(w,S){let E=S>>24&255,R=S>>16&255,k=S>>8&255,A=S&255,_=w.sbox[0][E]+w.sbox[1][R];return _=_^w.sbox[2][k],_=_+w.sbox[3][A],_}function g(w,S,E){let R=S,k=E,A;for(let _=0;_<s;++_)R=R^w.pbox[_],k=p(w,R)^k,A=R,R=k,k=A;return A=R,R=k,k=A,k=k^w.pbox[s],R=R^w.pbox[s+1],{left:R,right:k}}function y(w,S,E){let R=S,k=E,A;for(let _=s+1;_>1;--_)R=R^w.pbox[_],k=p(w,R)^k,A=R,R=k,k=A;return A=R,R=k,k=A,k=k^w.pbox[1],R=R^w.pbox[0],{left:R,right:k}}function C(w,S,E){for(let D=0;D<4;D++){w.sbox[D]=[];for(let j=0;j<256;j++)w.sbox[D][j]=d[D][j]}let R=0;for(let D=0;D<s+2;D++)w.pbox[D]=l[D]^S[R],R++,R>=E&&(R=0);let k=0,A=0,_=0;for(let D=0;D<s+2;D+=2)_=g(w,k,A),k=_.left,A=_.right,w.pbox[D]=k,w.pbox[D+1]=A;for(let D=0;D<4;D++)for(let j=0;j<256;j+=2)_=g(w,k,A),k=_.left,A=_.right,w.sbox[D][j]=k,w.sbox[D][j+1]=A;return!0}var x=c.Blowfish=o.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var w=this._keyPriorReset=this._key,S=w.words,E=w.sigBytes/4;C(h,S,E)}},encryptBlock:function(w,S){var E=g(h,w[S],w[S+1]);w[S]=E.left,w[S+1]=E.right},decryptBlock:function(w,S){var E=y(h,w[S],w[S+1]);w[S]=E.left,w[S+1]=E.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=o._createHelper(x)}(),t.Blowfish})}(W0)),W0.exports}var mL=c0.exports,Fw;function vL(){return Fw||(Fw=1,function(n,e){(function(t,r,i){n.exports=r(_n(),Qp(),hB(),gB(),Fl(),yB(),Bl(),ZE(),PC(),wB(),XE(),kB(),TB(),RB(),MC(),MB(),Uc(),fi(),BB(),UB(),VB(),WB(),HB(),XB(),KB(),YB(),JB(),tL(),rL(),oL(),aL(),lL(),dL(),hL(),gL())})(mL,function(t){return t})}(c0)),c0.exports}var yL=vL();const Bw=Nc(yL),CL=(n,e)=>e.some(t=>n instanceof t);let Lw,Uw;function xL(){return Lw||(Lw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bL(){return Uw||(Uw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $E=new WeakMap,vy=new WeakMap,KE=new WeakMap,Ym=new WeakMap,NC=new WeakMap;function IL(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",c)},o=()=>{t(kc(n.result)),i()},c=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&$E.set(t,n)}).catch(()=>{}),NC.set(e,n),e}function wL(n){if(vy.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",c),n.removeEventListener("abort",c)},o=()=>{t(),i()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",c),n.addEventListener("abort",c)});vy.set(n,e)}let yy={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return vy.get(n);if(e==="objectStoreNames")return n.objectStoreNames||KE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return kc(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function SL(n){yy=n(yy)}function AL(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Qm(this),e,...t);return KE.set(r,e.sort?e.sort():[e]),kc(r)}:bL().includes(n)?function(...e){return n.apply(Qm(this),e),kc($E.get(this))}:function(...e){return kc(n.apply(Qm(this),e))}}function kL(n){return typeof n=="function"?AL(n):(n instanceof IDBTransaction&&wL(n),CL(n,xL())?new Proxy(n,yy):n)}function kc(n){if(n instanceof IDBRequest)return IL(n);if(Ym.has(n))return Ym.get(n);const e=kL(n);return e!==n&&(Ym.set(n,e),NC.set(e,n)),e}const Qm=n=>NC.get(n);function EL(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){const c=indexedDB.open(n,e),s=kc(c);return r&&c.addEventListener("upgradeneeded",l=>{r(kc(c.result),l.oldVersion,l.newVersion,kc(c.transaction),l)}),t&&c.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),s.then(l=>{o&&l.addEventListener("close",()=>o()),i&&l.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),s}const TL=["get","getKey","getAll","getAllKeys","count"],_L=["put","add","delete","clear"],Jm=new Map;function jw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Jm.get(e))return Jm.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=_L.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||TL.includes(t)))return;const o=async function(c,...s){const l=this.transaction(c,i?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(s.shift())),(await Promise.all([d[t](...s),i&&l.done]))[0]};return Jm.set(e,o),o}SL(n=>({...n,get:(e,t,r)=>jw(e,t)||n.get(e,t,r),has:(e,t)=>!!jw(e,t)||n.has(e,t)}));class RL{constructor(){oe(this,"db",null);oe(this,"dbName","file-transfer-store");oe(this,"dbVersion",1)}async initialize(){this.db=await EL(this.dbName,this.dbVersion,{upgrade(e){e.objectStoreNames.contains("chunks")||e.createObjectStore("chunks",{keyPath:["hash","index"]}).createIndex("hash","hash",{unique:!1}),e.objectStoreNames.contains("metadata")||e.createObjectStore("metadata",{keyPath:"hash"}).createIndex("direction","direction",{unique:!1})}})}async saveChunk(e){this.db||await this.initialize(),await this.db.put("chunks",e);const t=await this.getFileMetadata(e.hash);t&&(t.receivedChunks.includes(e.index)||(t.receivedChunks.push(e.index),t.lastActivityTimestamp=Date.now(),await this.updateFileMetadata(t)))}async getChunk(e,t){return this.db||await this.initialize(),this.db.get("chunks",[e,t])}async getAllChunks(e){return this.db||await this.initialize(),this.db.getAllFromIndex("chunks","hash",e)}async saveFileMetadata(e){this.db||await this.initialize(),await this.db.put("metadata",e)}async updateFileMetadata(e){this.db||await this.initialize(),await this.db.put("metadata",e)}async getFileMetadata(e){return this.db||await this.initialize(),this.db.get("metadata",e)}async getAllFileMetadata(){return this.db||await this.initialize(),this.db.getAll("metadata")}async getIncompleteTransfers(e){return this.db||await this.initialize(),(await this.db.getAllFromIndex("metadata","direction",e)).filter(r=>r.receivedChunks.length<r.totalChunks)}async deleteFile(e){this.db||await this.initialize();const t=this.db.transaction(["chunks","metadata"],"readwrite"),r=await t.objectStore("chunks").getAllFromIndex("hash",e);for(const i of r)await t.objectStore("chunks").delete([e,i.index]);await t.objectStore("metadata").delete(e),await t.done}async clearAll(){this.db||await this.initialize();const e=this.db.transaction(["chunks","metadata"],"readwrite");await e.objectStore("chunks").clear(),await e.objectStore("metadata").clear(),await e.done}async close(){this.db&&(this.db.close(),this.db=null)}async reconstructFile(e){const t=await this.getFileMetadata(e);if(!t)return null;const r=await this.getAllChunks(e);return r.length!==t.totalChunks?null:(r.sort((i,o)=>i.index-o.index),new Blob(r.map(i=>i.data),{type:t.mimeType||"application/octet-stream"}))}async isTransferComplete(e){const t=await this.getFileMetadata(e);return t?t.receivedChunks.length===t.totalChunks:!1}}class qo extends Error{constructor(e,t){super(t),this.code=e,this.name="FileTransferError"}}const Xs={CONNECTION_FAILED:"CONNECTION_FAILED",TRANSFER_TIMEOUT:"TRANSFER_TIMEOUT",INVALID_FILE:"INVALID_FILE",DATA_CHANNEL_ERROR:"DATA_CHANNEL_ERROR"};class DL extends Hp{constructor(t,r){super();oe(this,"webRTCService");oe(this,"client");oe(this,"gmcpFileTransfer");oe(this,"chunkSize",16384);oe(this,"transferTimeoutInterval");oe(this,"incomingTransfers",new Map);oe(this,"outgoingTransfers",new Map);oe(this,"maxFileSize",100*1024*1024);oe(this,"transferTimeout",3e4);oe(this,"pendingOffers",new Map);oe(this,"store");oe(this,"storeInitialized",!1);this.client=t,this.gmcpFileTransfer=r,this.webRTCService=t.webRTCService,this.store=new RL,this.initializeStore(),this.setupListeners()}async initializeStore(){try{await this.store.initialize(),this.storeInitialized=!0,console.log("[FileTransferManager] Store initialized successfully")}catch(t){console.error("[FileTransferManager] Failed to initialize store:",t)}}isDataChannelReady(){return this.webRTCService.isDataChannelOpen()}setupListeners(){this.webRTCService.on("dataChannelMessage",this.handleIncomingChunk.bind(this)),this.client.on("fileTransferAccepted",this.handleAcceptedTransfer.bind(this)),this.transferTimeoutInterval=window.setInterval(()=>this.checkTransferTimeouts(),5e3)}async initializeWebRTC(){this.webRTCService.isDataChannelOpen()||await this.webRTCService.createPeerConnection()}async sendFile(t,r){if(t.size>this.maxFileSize)throw new qo(Xs.INVALID_FILE,`File size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);const i=await this.computeFileHash(t);console.log(`[FileTransferManager] Computed hash for ${t.name}: ${i}`),console.log(`[FileTransferManager] Registering outgoing transfer for file: ${t.name}`),this.outgoingTransfers.set(i,{file:t,filename:t.name,hash:i,lastActivityTimestamp:Date.now()});try{await this.initializeWebRTC(),this.webRTCService.recipient=r;const o=await this.webRTCService.createOffer();console.log(`[FileTransferManager] Sending offer for file: ${t.name}`),await this.gmcpFileTransfer.sendOffer(r,t.name,t.size,JSON.stringify(o),i),await this.webRTCService.waitForConnection()}catch(o){console.error(`[FileTransferManager] Failed to send file ${t.name}:`,o),this.handleTransferError(i,t.name,"send",o instanceof qo?o:new qo(Xs.CONNECTION_FAILED,"Failed to establish connection")),this.cleanupTransfer(i)}}async computeFileHash(t){return new Promise((r,i)=>{const o=new FileReader;o.onload=()=>{if(o.result instanceof ArrayBuffer){const c=Bw.lib.WordArray.create(o.result),s=Bw.SHA256(c).toString();r(s)}else i(new Error("Failed to read file for hashing"))},o.onerror=()=>i(o.error),o.readAsArrayBuffer(t)})}async startFileTransfer(t,r){let i=0;const o=new FileReader;for(;i<t.size;){const c=t.slice(i,i+this.chunkSize),s=await new Promise((d,h)=>{o.onload=()=>{o.result instanceof ArrayBuffer?d(o.result):h(new qo(Xs.INVALID_FILE,"Failed to read file chunk"))},o.onerror=()=>h(new qo(Xs.INVALID_FILE,"Error reading file")),o.readAsArrayBuffer(c)});await this.sendChunk(t.name,r,s,i,t.size),i+=s.byteLength;const l={hash:r,filename:t.name,sentBytes:i,totalBytes:t.size};this.emit("fileSendProgress",l)}}async sendChunk(t,r,i,o,c){try{const s={hash:r,filename:t,chunkIndex:Math.floor(o/this.chunkSize),totalChunks:Math.ceil(c/this.chunkSize),chunkSize:i.byteLength,totalSize:c},l=JSON.stringify(s),d=new TextEncoder().encode(l),h=new ArrayBuffer(4);new DataView(h).setUint32(0,d.byteLength,!0);const p=new Uint8Array(4+d.byteLength+i.byteLength);p.set(new Uint8Array(h),0),p.set(d,4),p.set(new Uint8Array(i),4+d.byteLength),await this.webRTCService.sendData(p.buffer)}catch{throw new qo(Xs.DATA_CHANNEL_ERROR,"Failed to send chunk")}}async handleAcceptedTransfer(t){console.log("[FileTransferManager] Handling accepted transfer for file transfer request ",t);const{sender:r,hash:i,filename:o,answerSdp:c}=t,s=this.outgoingTransfers.get(i);if(!s){const l=`No outgoing transfer found for hash: ${i} (${o}). Active transfers: ${Array.from(this.outgoingTransfers.keys()).join(", ")}`;console.error(`[FileTransferManager] ${l}`),this.client.onFileTransferError(i,o,"send",l);return}try{console.log(`[FileTransferManager] Processing WebRTC answer for file: ${o}`);const l=JSON.parse(c);console.log(`[FileTransferManager] Answer object for file: ${o}`,l),await this.webRTCService.handleAnswer(l),console.log(`[FileTransferManager] Waiting for data channel to open for file: ${o}`),await this.waitForDataChannel(i),console.log(`[FileTransferManager] Data channel ready for outgoing transfer of: ${o}`),await this.startFileTransfer(s.file,s.hash),console.log(`[FileTransferManager] File transfer completed successfully: ${o}`),this.client.onFileSendComplete(i,o)}catch(l){console.error(`[FileTransferManager] Error in accepted transfer for ${o}:`,l),this.handleTransferError(i,o,"send",l)}finally{console.log(`[FileTransferManager] Cleaning up successful transfer: ${o} (${i})`),this.outgoingTransfers.delete(i)}}async waitForDataChannel(t){return new Promise((r,i)=>{if(this.isDataChannelReady()){r();return}let o=0;const c=50,s=setInterval(()=>{o++,this.isDataChannelReady()?(clearInterval(s),r()):o>=c&&(clearInterval(s),i(new qo(Xs.CONNECTION_FAILED,`Data channel failed to open for transfer ${t} after ${o} attempts`)))},100)})}async handleIncomingChunk(t){let r;try{if(t.byteLength<4)throw new Error("Received data is too short to contain header size");const i=new Uint8Array(t.slice(0,4)),o=new DataView(i.buffer).getUint32(0,!0);if(t.byteLength<4+o)throw new Error("Received data is too short to contain header");const c=new TextDecoder().decode(t.slice(4,4+o)),s=JSON.parse(c);if(r=s.hash,t.byteLength<4+o+s.chunkSize)throw new Error("Received data is too short to contain chunk data");const l=this.pendingOffers.get(s.hash),d=(l==null?void 0:l.sender)||"unknown";if(typeof s.chunkIndex!="number"||s.chunkIndex<0||s.chunkIndex>=s.totalChunks)throw new Error("Invalid chunk index in header");if(typeof s.totalChunks!="number"||s.totalChunks<=0)throw new Error("Invalid total chunks in header");const h=t.slice(4+o,4+o+s.chunkSize);let p=this.incomingTransfers.get(s.hash);if(!p){if(s.totalSize>this.maxFileSize){this.client.onFileTransferError(s.hash,s.filename,"receive",`Incoming file size exceeds the maximum allowed size of ${this.maxFileSize/(1024*1024)} MB`);return}p={hash:s.hash,filename:s.filename,totalSize:s.totalSize,receivedSize:0,chunks:new Array(s.totalChunks),lastActivityTimestamp:Date.now(),sender:d},this.incomingTransfers.set(s.hash,p),this.storeInitialized&&await this.store.saveFileMetadata({hash:s.hash,filename:s.filename,totalSize:s.totalSize,totalChunks:s.totalChunks,receivedChunks:[],direction:"incoming",sender:d,lastActivityTimestamp:Date.now()})}p.chunks[s.chunkIndex]=h,p.receivedSize+=h.byteLength,p.lastActivityTimestamp=Date.now(),this.storeInitialized&&await this.store.saveChunk({hash:s.hash,index:s.chunkIndex,data:h});const g={hash:s.hash,filename:s.filename,receivedBytes:p.receivedSize,totalBytes:p.totalSize};if(this.emit("fileReceiveProgress",g),p.receivedSize===p.totalSize)if(p.chunks.every(y=>y)){const y=new Blob(p.chunks),C=new File([y],p.filename,{type:y.type});if(await this.computeFileHash(C)!==p.hash){this.client.onFileTransferError(p.hash,s.filename,"receive","File integrity check failed - hash mismatch"),this.incomingTransfers.delete(p.hash),this.storeInitialized&&await this.store.deleteFile(p.hash);return}const w=window.URL.createObjectURL(y),S=document.createElement("a");S.href=w,S.download=s.filename,document.body.appendChild(S),S.click(),document.body.removeChild(S),window.URL.revokeObjectURL(w);const E={hash:p.hash,filename:s.filename,file:y};this.emit("fileReceiveComplete",E),this.incomingTransfers.delete(p.hash),this.storeInitialized&&await this.store.deleteFile(p.hash)}else this.client.onFileTransferError(p.hash,s.filename,"receive","Missing chunks in received file")}catch(i){const o=r||"unknown";this.handleTransferError(o,"unknown_file","receive",new qo("UNKNOWN_ERROR",i instanceof Error?i.message:"Unknown error"))}}handleTransferError(t,r,i,o){console.error(`Error ${i}ing file ${r} (${t}):`,o);const c=o instanceof Error?o.message:"Unknown error";this.client.onFileTransferError(t,r,i,c);const s=this.outgoingTransfers.get(t),l=this.incomingTransfers.get(t);this.cleanupTransfer(t),this.attemptRecovery(t,r,i,s,l)}cleanupTransfer(t){console.log(`[FileTransferManager] Starting cleanup for hash: ${t}`);const r=this.outgoingTransfers.get(t);r&&(console.log(`[FileTransferManager] Cleaning up outgoing transfer for: ${r.filename} (${t})`),this.outgoingTransfers.delete(t));const i=this.incomingTransfers.get(t);if(i&&(console.log(`[FileTransferManager] Cleaning up incoming transfer for: ${i.filename} (${t})`),this.incomingTransfers.delete(t)),this.pendingOffers.has(t)){const o=this.pendingOffers.get(t);console.log(`[FileTransferManager] Removing pending offer for: ${o==null?void 0:o.filename} (${t})`),this.pendingOffers.delete(t)}console.log(`[FileTransferManager] Cleanup complete for hash: ${t}`)}async attemptRecovery(t,r,i,o,c){try{await this.webRTCService.createPeerConnection(),this.client.onConnectionRecovered({hash:t,filename:r,direction:i}),i==="send"&&o?(this.outgoingTransfers.set(t,o),await this.startFileTransfer(o.file,o.hash)):i==="receive"&&c&&this.gmcpFileTransfer.sendRequestResend(c.sender,t)}catch(s){console.error("Failed to recover connection:",s),this.client.onRecoveryFailed({filename:r,direction:i,error:s instanceof Error?s.message:"Unknown error"})}}checkTransferTimeouts(){const t=Date.now();this.incomingTransfers.forEach((r,i)=>{t-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"receive",new qo(Xs.TRANSFER_TIMEOUT,"Transfer timeout - no data received"))}),this.outgoingTransfers.forEach((r,i)=>{t-r.lastActivityTimestamp>this.transferTimeout&&this.handleTransferError(i,r.filename,"send",new qo(Xs.TRANSFER_TIMEOUT,"Transfer timeout - no activity"))})}cleanup(){this.transferTimeoutInterval&&(clearInterval(this.transferTimeoutInterval),this.transferTimeoutInterval=void 0),[...this.outgoingTransfers.keys()].forEach(t=>this.cancelTransfer(t)),[...this.incomingTransfers.keys()].forEach(t=>this.cancelTransfer(t)),this.incomingTransfers.clear(),this.outgoingTransfers.clear(),this.pendingOffers.clear(),this.webRTCService.cleanup(),this.storeInitialized&&(this.store.close(),this.storeInitialized=!1)}cancelTransfer(t){const r=this.outgoingTransfers.get(t)||this.incomingTransfers.get(t);r?(console.log(`[FileTransferManager] Cancelling transfer for hash: ${t} (${r.filename})`),this.cleanupTransfer(t),this.storeInitialized&&this.store.deleteFile(t).catch(i=>console.error("[FileTransferManager] Failed to delete file from store:",i)),this.client.onFileTransferCancel(this.client.worldData.playerId,t),this.gmcpFileTransfer.sendCancel(this.client.worldData.playerId,t)):console.log(`[FileTransferManager] No active transfer found for hash: ${t}`)}async acceptTransfer(t,r){if(console.log("[FileTransferManager] Accepting transfer",t,r),this.incomingTransfers.has(r))throw new Error("Already receiving this file");const i=this.pendingOffers.get(r);if(console.log("[FileTransferManager] Checking pending offers:",Array.from(this.pendingOffers.entries())),!i)throw new qo(Xs.INVALID_FILE,`No pending offer found for transfer with hash: ${r}`);console.log("[FileTransferManager] Found pending offer for transfer:",{sender:t,hash:r,filename:i.filename,filesize:i.filesize});try{await this.initializeWebRTC(),this.webRTCService.recipient=t,console.log("[FileTransferManager] Setting remote description with offer"),await this.webRTCService.handleOffer(JSON.parse(i.offerSdp)),console.log("[FileTransferManager] Creating WebRTC answer");const o=await this.webRTCService.createAnswer();if(console.log("[FileTransferManager] WebRTC answer created successfully"),this.pendingOffers.has(r))await this.gmcpFileTransfer.sendAccept(t,r,i.filename,JSON.stringify(o)),await this.waitForDataChannel(r),console.log("[FileTransferManager] Data channel ready for incoming transfer"),this.pendingOffers.delete(r);else throw new Error("Transfer was cancelled during setup")}catch(o){throw console.error("Failed to accept transfer:",o),this.cleanupTransfer(r),new qo(Xs.CONNECTION_FAILED,`Failed to accept transfer: ${o instanceof Error?o.message:"Unknown error"}`)}}}class PL extends Hp{constructor(t,r){super();oe(this,"ws");oe(this,"decoder",new TextDecoder("utf8"));oe(this,"telnet");oe(this,"_connected",!1);oe(this,"intentionalDisconnect",!1);oe(this,"host");oe(this,"port");oe(this,"telnetNegotiation",!1);oe(this,"telnetBuffer","");oe(this,"gmcpHandlers",{});oe(this,"mcpHandlers",{});oe(this,"mcpMultilines",{});oe(this,"mcpAuthKey",null);oe(this,"mcp_negotiate");oe(this,"mcp_getset");oe(this,"gmcp_char");oe(this,"gmcp_fileTransfer");oe(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[],roomPlayers:[]});oe(this,"cacophony");oe(this,"editors");oe(this,"webRTCService");oe(this,"fileTransferManager");oe(this,"currentRoomInfo",null);oe(this,"_autosay",!1);oe(this,"globalMuted",!1);oe(this,"isWindowFocused",!0);this.host=t,this.port=r,this.mcp_negotiate=this.registerMcpPackage(JF),this.mcp_getset=this.registerMcpPackage(nB),this.gmcp_char=this.registerGMCPPackage(Ak),this.gmcp_fileTransfer=this.registerGMCPPackage(kk),this.cacophony=new AF,this.cacophony.setGlobalVolume(dr.getState().sound.volume),this.editors=new R3(this),this.webRTCService=new oB(this),this.fileTransferManager=new DL(this,this.gmcp_fileTransfer),window.addEventListener("focus",()=>{this.isWindowFocused=!0,this.updateBackgroundMuteState()}),window.addEventListener("blur",()=>{this.isWindowFocused=!1,this.updateBackgroundMuteState()}),dr.subscribe(()=>{this.updateBackgroundMuteState()})}get connected(){return this._connected}get autosay(){return this._autosay}set autosay(t){this._autosay=t,this.emit("autosayChanged",t)}async sendFile(t,r){await this.fileTransferManager.sendFile(t,r)}cancelTransfer(t){this.fileTransferManager.cancelTransfer(t)}acceptTransfer(t,r){this.fileTransferManager.acceptTransfer(t,r).catch(i=>{console.error("[MudClient] Failed to accept transfer:",i),this.onFileTransferError(r,"unknown","receive",i.message)})}rejectTransfer(t,r){this.gmcp_fileTransfer.sendReject(t,r)}onFileTransferOffer(t,r,i,o,c){console.log("[MudClient] Emitting fileTransferOffer event:",{sender:t,hash:r,filename:i,filesize:o,offerSdp:c}),this.emit("fileTransferOffer",{sender:t,hash:r,filename:i,filesize:o,offerSdp:c})}onFileTransferAccept(t,r,i,o){console.log("[MudClient] Emitting fileTransferAccepted event:",{sender:t,hash:r,filename:i,answerSdp:o}),this.emit("fileTransferAccepted",{sender:t,hash:r,filename:i,answerSdp:o})}onFileTransferReject(t,r){this.emit("fileTransferRejected",{sender:t,hash:r})}onFileTransferCancel(t,r){this.emit("fileTransferCancelled",{sender:t,hash:r})}onFileSendComplete(t,r){this.emit("fileSendComplete",{hash:t,filename:r})}onFileTransferError(t,r,i,o){this.emit("fileTransferError",{hash:t,filename:r,direction:i,error:o})}onConnectionRecovered(t){this.emit("connectionRecovered",t)}onRecoveryFailed(t){this.emit("recoveryFailed",t)}sendFileTransferOffer(t,r,i,o,c){this.gmcp_fileTransfer.sendOffer(t,r,o,c,i)}sendFileTransferAccept(t,r,i,o){this.gmcp_fileTransfer.sendAccept(t,i,r,o)}registerGMCPPackage(t){const r=new t(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(t){const r=new t(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.intentionalDisconnect=!1,this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new k3(new A3(this.ws)),this.ws.onopen=()=>{this._connected=!0,en.resetIntentionalDisconnectFlags(),this.emit("connect"),this.emit("connectionChange",!0)},this.telnet.on("data",t=>{this.handleData(t)}),this.telnet.on("negotiation",(t,r)=>{t===zd.WILL&&r===Wd.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(zd.DO,Wd.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):t===zd.DO&&r===Wd.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(zd.WILL,Wd.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(t,r)=>{console.log("GMCP Package:",t,r);try{this.handleGmcpData(t,r)}catch(i){console.error("Calling GMCP:",i)}}),this.ws.onclose=()=>{this.cleanupConnection(),this.intentionalDisconnect||setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=t=>{this.emit("error",t)}}send(t){this.ws.send(t)}cleanupConnection(){this._connected=!1,this.mcpAuthKey=null,this.telnetBuffer="",this.telnetNegotiation=!1,this.currentRoomInfo=null,this.webRTCService.cleanup(),this.fileTransferManager.cleanup(),this.intentionalDisconnect&&(this.intentionalDisconnect=!1),this.emit("disconnect"),this.emit("connectionChange",!1)}close(){this.intentionalDisconnect=!0,this.ws&&this.ws.close(),this.cleanupConnection()}sendCommand(t){dr.getState().general.localEcho&&this.emit("command",t),this.autosay&&!t.startsWith("-")&&!t.startsWith("'")&&(t="say "+t),this.send(t+`\r
`),console.log("> "+t)}handleData(t){const r=this.decoder.decode(t).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(t){if(t.startsWith("#$#*")){const i=JI(t.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(t.startsWith("#$#:")){const i=JI(t.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=QF(t.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=ew(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(t,r){const i=t.lastIndexOf("."),o=t.substring(0,i),c=t.substring(i+1);console.log("GMCP Message:",o,c,r);const s=this.gmcpHandlers[o];if(!s){console.log("No handler for GMCP package:",o);return}const l=s["handle"+c];if(l){console.log("Calling handler for:",c,l);let d;typeof r=="string"&&r.trim()!==""?d=r:(console.warn(`GMCP message data for ${o}.${c} is missing or empty. Defaulting to {}. Original data:`,r),d="{}");try{const h=JSON.parse(d);l.call(s,h)}catch(h){console.error(`Error parsing GMCP JSON for ${o}.${c}:`,h),console.error("Attempted to parse:",d)}}else console.log("No handler on package:",o,c)}emitMessage(t){const r=dr.getState().speech.autoreadMode;r===ly.All&&this.speak(t),r===ly.Unfocused&&!document.hasFocus()&&this.speak(t),this.emit("message",t)}sendGmcp(t,r){console.log("Sending GMCP:",t,r),this.telnet.sendGmcp(t,r)}sendMcp(t,r){if(typeof r=="object"){let o="";for(const[c,s]of Object.entries(r))o+=` ${c}: ${s||'""'}`;r=o}const i=`#$#${t} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(t,r,i){this.send(`#$#* ${t} ${r}: ${i}\r
`)}closeMcpML(t){this.send(`#$#: ${t}\r
`)}sendMCPMultiline(t,r,i){const o=ew();r["_data-tag"]=o,this.sendMcp(t,r);for(const c of i)this.sendMcpMLLine(o,"content",c);this.closeMcpML(o)}shutdown(){Object.values(this.mcpHandlers).forEach(t=>{t.shutdown()}),Object.values(this.gmcpHandlers).forEach(t=>{t.shutdown()}),this.editors.shutdown(),this.webRTCService.cleanup(),this.fileTransferManager.cleanup()}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(t,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(t,{body:r})}speak(t){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(_3(t));r.lang="en-US";const{rate:i,pitch:o,voice:c,volume:s}=dr.getState().speech;r.rate=i,r.pitch=o,r.volume=s;const d=speechSynthesis.getVoices().find(h=>h.name===c);d&&(r.voice=d),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}updateBackgroundMuteState(){const r=dr.getState().sound.muteInBackground&&!this.isWindowFocused;this.cacophony.muted=this.globalMuted||r}setGlobalMute(t){this.globalMuted=t,this.updateBackgroundMuteState()}}class ML{constructor(){oe(this,"history",[]);oe(this,"currentIndex",-1);oe(this,"unsentInput","")}addCommand(e){e.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==e)&&this.history.push(e.trim()),this.currentIndex=-1,this.unsentInput=""}navigateUp(e){return this.currentIndex===-1&&(this.unsentInput=e),this.history.length>0&&this.currentIndex<this.history.length-1&&this.currentIndex++,this.history.length>0?this.history[this.history.length-1-this.currentIndex]:""}navigateDown(e){return this.currentIndex===-1&&(this.unsentInput=e),this.currentIndex>0?(this.currentIndex--,this.history[this.history.length-1-this.currentIndex]):(this.currentIndex=-1,this.unsentInput)}getCurrentInput(){return this.currentIndex===-1?this.unsentInput:this.history[this.history.length-1-this.currentIndex]}getHistory(){return[...this.history]}}const NL=()=>{const[,n]=B.useReducer(e=>e+1,0);return B.useEffect(()=>Ba.subscribe(n),[]),[Ba.getState(),Ba.dispatch]},Vw="command_history",OL=1e3,ev=n=>n.includes(" ")?`"${n}"`:n,tv=n=>{if(n.startsWith('"'))return{leadingPunctuation:"",namePart:n.substring(1)};{const e=n.match(/^([^\w\s"]+)(.*)$/);return e?{leadingPunctuation:e[1],namePart:e[2]}:{leadingPunctuation:"",namePart:n}}},FL=({onSend:n,inputRef:e,client:t})=>{const r=B.useRef(new ML),[i,o]=NL(),c=B.useRef([]),s=B.useRef(0),l=B.useRef(null);B.useEffect(()=>{const y=localStorage.getItem(Vw);y&&JSON.parse(y).forEach(x=>{r.current.addCommand(x)})},[]),B.useEffect(()=>{Ba.registerInputRef(e)},[e]);const d=()=>{try{const C=r.current.getHistory().slice(-OL);localStorage.setItem(Vw,JSON.stringify(C))}catch(y){console.warn("Failed to save command history:",y)}},h=B.useCallback(()=>{c.current=[],s.current=0,l.current=null},[]),p=B.useCallback(()=>{var C;const y=i.text;y.trim()&&(n(y),r.current.addCommand(y),d(),wM(),(C=e.current)==null||C.focus(),h())},[i.text,n,e,h]),g=B.useCallback(y=>{const C=r.current,x=i.text,w=e.current;if(y.key==="Tab"){if(!w)return;if(x===""){h();return}y.preventDefault();const S=w.selectionStart,E=x.substring(0,S),R=E.match(/(?:[^"\s]\S*|"[^"]*"?)$/),k=R?R[0]:"",A=R?E.lastIndexOf(k):-1;if(k===""&&l.current===null){h();return}let _=!1;if(l.current!==null&&c.current.length>0){const D=c.current[s.current],{leadingPunctuation:j}=tv(l.current),Z=j+ev(D.name);_=k===Z}if(_){s.current=(s.current+1)%c.current.length;const D=c.current[s.current],{leadingPunctuation:j}=tv(l.current),Z=ev(D.name),F=j+Z,V=x.substring(0,A)+F+x.substring(S);fl(V);const X=A+F.length;requestAnimationFrame(()=>w.setSelectionRange(X,X))}else{h();const{leadingPunctuation:D,namePart:j}=tv(k);if(j==="")return;const F=(t.worldData.roomPlayers||[]).filter(V=>{const X=typeof V.name=="string"&&V.name.toLowerCase().startsWith(j.toLowerCase()),pe=(typeof V.fullname=="string"?V.fullname.toLowerCase().split(" "):[]).some(ve=>ve.startsWith(j.toLowerCase()));return X||pe}).sort((V,X)=>{const te=V.name.localeCompare(X.name);return te!==0?te:V.fullname.localeCompare(X.fullname)});if(F.length>0){l.current=k,c.current=F,s.current=0;const V=F[0],X=ev(V.name),te=D+X,pe=x.substring(0,A)+te+x.substring(S);fl(pe);const ve=A+te.length;requestAnimationFrame(()=>w.setSelectionRange(ve,ve))}}}else if(y.key==="Enter"&&!y.shiftKey)y.preventDefault(),p();else if(y.key==="ArrowUp"){y.preventDefault();const S=C.navigateUp(x);fl(S),h()}else if(y.key==="ArrowDown"){y.preventDefault();const S=C.navigateDown(x);fl(S),h()}else(y.key.length===1||y.key==="Backspace"||y.key==="Delete")&&h()},[i.text,t,e,n,h,p]);return K.jsxs("div",{className:"command-input-container",children:[K.jsx("textarea",{value:i.text,onChange:y=>{fl(y.target.value),h()},onKeyDown:g,id:"command-input",ref:e,autoFocus:!0}),K.jsx("button",{onClick:p,className:"send-button",children:"Send"})]})},qE=7e3;let $s=null;function Gw(n,e="assertive",t=qE){$s?$s.announce(n,e,t):($s=new BL,(typeof IS_REACT_ACT_ENVIRONMENT=="boolean"?IS_REACT_ACT_ENVIRONMENT:typeof jest<"u")?$s.announce(n,e,t):setTimeout(()=>{$s!=null&&$s.isAttached()&&($s==null||$s.announce(n,e,t))},100))}class BL{isAttached(){var e;return(e=this.node)===null||e===void 0?void 0:e.isConnected}createLog(e){let t=document.createElement("div");return t.setAttribute("role","log"),t.setAttribute("aria-live",e),t.setAttribute("aria-relevant","additions"),t}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,t="assertive",r=qE){var i,o;if(!this.node)return;let c=document.createElement("div");typeof e=="object"?(c.setAttribute("role","img"),c.setAttribute("aria-labelledby",e["aria-labelledby"])):c.textContent=e,t==="assertive"?(i=this.assertiveLog)===null||i===void 0||i.appendChild(c):(o=this.politeLog)===null||o===void 0||o.appendChild(c),e!==""&&setTimeout(()=>{c.remove()},r)}clear(e){this.node&&((!e||e==="assertive")&&this.assertiveLog&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&this.politeLog&&(this.politeLog.innerHTML=""))}constructor(){this.node=null,this.assertiveLog=null,this.politeLog=null,typeof document<"u"&&(this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node))}}var nv,Ww;function LL(){if(Ww)return nv;Ww=1;var n=function(){function o(c,s){for(var l=0;l<s.length;l++){var d=s[l];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}return function(c,s,l){return s&&o(c.prototype,s),l&&o(c,l),c}}();function e(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")}var t=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],r=/(https?:\/\/(?:[A-Za-z0-9#;/?:@=+$',_.!~*()[\]-]|&amp;|%[A-Fa-f0-9]{2})+)/gm,i=function(){n(o,null,[{key:"escapeForHtml",value:function(s){return new o().escapeForHtml(s)}},{key:"linkify",value:function(s){return new o().linkify(s)}},{key:"ansiToHtml",value:function(s,l){return new o().ansiToHtml(s,l)}},{key:"ansiToJson",value:function(s,l){return new o().ansiToJson(s,l)}},{key:"ansiToText",value:function(s){return new o().ansiToText(s)}}]);function o(){e(this,o),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return n(o,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var s=0;s<2;++s)for(var l=0;l<8;++l)this.PALETTE_COLORS.push(t[s][l].color);for(var d=[0,95,135,175,215,255],h=function(S,E,R){return d[S]+", "+d[E]+", "+d[R]},p=0;p<6;++p)for(var g=0;g<6;++g)for(var y=0;y<6;++y)this.PALETTE_COLORS.push(h(p,g,y));for(var C=8,x=0;x<24;++x,C+=10)this.PALETTE_COLORS.push(h(C,C,C))}},{key:"escapeForHtml",value:function(s){return s.replace(/[&<>\"]/gm,function(l){return l=="&"?"&amp;":l=='"'?"&quot;":l=="<"?"&lt;":l==">"?"&gt;":""})}},{key:"linkify",value:function(s){return s.replace(r,function(l){return'<a href="'+l+'">'+l+"</a>"})}},{key:"ansiToHtml",value:function(s,l){return this.process(s,l,!0)}},{key:"ansiToJson",value:function(s,l){return l=l||{},l.json=!0,l.clearLine=!1,this.process(s,l,!0)}},{key:"ansiToText",value:function(s){return this.process(s,{},!1)}},{key:"process",value:function(s,l,d){var h=this,p=this,g=s.split(/\033\[/),y=g.shift();l==null&&(l={}),l.clearLine=/\r/.test(s);var C=g.map(function(w){return h.processChunk(w,l,d)});if(l&&l.json){var x=p.processChunkJson("");return x.content=y,x.clearLine=l.clearLine,C.unshift(x),l.remove_empty&&(C=C.filter(function(w){return!w.isEmpty()})),C}else C.unshift(y);return C.join("")}},{key:"processChunkJson",value:function(s,l,d){l=typeof l>"u"?{}:l;var h=l.use_classes=typeof l.use_classes<"u"&&l.use_classes,p=l.key=h?"class":"color",g={content:s,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:l.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!g.content}},y=s.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!y)return g;g.content=y[4];var C=y[2].split(";");if(y[1]!==""||y[3]!=="m"||!d)return g;for(var x=this;C.length>0;){var w=C.shift(),S=parseInt(w);if(isNaN(S)||S===0)x.fg=x.bg=null,x.decorations=[];else if(S===1)x.decorations.push("bold");else if(S===2)x.decorations.push("dim");else if(S===3)x.decorations.push("italic");else if(S===4)x.decorations.push("underline");else if(S===5)x.decorations.push("blink");else if(S===7)x.decorations.push("reverse");else if(S===8)x.decorations.push("hidden");else if(S===9)x.decorations.push("strikethrough");else if(S===21)x.removeDecoration("bold");else if(S===22)x.removeDecoration("bold"),x.removeDecoration("dim");else if(S===23)x.removeDecoration("italic");else if(S===24)x.removeDecoration("underline");else if(S===25)x.removeDecoration("blink");else if(S===27)x.removeDecoration("reverse");else if(S===28)x.removeDecoration("hidden");else if(S===29)x.removeDecoration("strikethrough");else if(S===39)x.fg=null;else if(S===49)x.bg=null;else if(S>=30&&S<38)x.fg=t[0][S%10][p];else if(S>=90&&S<98)x.fg=t[1][S%10][p];else if(S>=40&&S<48)x.bg=t[0][S%10][p];else if(S>=100&&S<108)x.bg=t[1][S%10][p];else if(S===38||S===48){var E=S===38;if(C.length>=1){var R=C.shift();if(R==="5"&&C.length>=1){var k=parseInt(C.shift());if(k>=0&&k<=255)if(!h)this.PALETTE_COLORS||x.setupPalette(),E?x.fg=this.PALETTE_COLORS[k]:x.bg=this.PALETTE_COLORS[k];else{var A=k>=16?"ansi-palette-"+k:t[k>7?1:0][k%8].class;E?x.fg=A:x.bg=A}}else if(R==="2"&&C.length>=3){var _=parseInt(C.shift()),D=parseInt(C.shift()),j=parseInt(C.shift());if(_>=0&&_<=255&&D>=0&&D<=255&&j>=0&&j<=255){var Z=_+", "+D+", "+j;h?E?(x.fg="ansi-truecolor",x.fg_truecolor=Z):(x.bg="ansi-truecolor",x.bg_truecolor=Z):E?x.fg=Z:x.bg=Z}}}}}return x.fg===null&&x.bg===null&&x.decorations.length===0||(g.fg=x.fg,g.bg=x.bg,g.fg_truecolor=x.fg_truecolor,g.bg_truecolor=x.bg_truecolor,g.decorations=x.decorations,g.decoration=x.decorations.slice(-1).pop()||null,g.was_processed=!0),g}},{key:"processChunk",value:function(s,l,d){var h=this;l=l||{};var p=this.processChunkJson(s,l,d),g=l.use_classes;if(p.decorations=p.decorations.filter(function(E){if(E==="reverse"){p.fg||(p.fg=t[0][7][g?"class":"color"]),p.bg||(p.bg=t[0][0][g?"class":"color"]);var R=p.fg;p.fg=p.bg,p.bg=R;var k=p.fg_truecolor;return p.fg_truecolor=p.bg_truecolor,p.bg_truecolor=k,p.isInverted=!0,!1}return!0}),l.json)return p;if(p.isEmpty())return"";if(!p.was_processed)return p.content;var y=[],C=[],x=[],w={},S=function(R){var k=[],A=void 0;for(A in R)R.hasOwnProperty(A)&&k.push("data-"+A+'="'+h.escapeForHtml(R[A])+'"');return k.length>0?" "+k.join(" "):""};return p.isInverted&&(w["ansi-is-inverted"]="true"),p.fg&&(g?(y.push(p.fg+"-fg"),p.fg_truecolor!==null&&(w["ansi-truecolor-fg"]=p.fg_truecolor,p.fg_truecolor=null)):y.push("color:rgb("+p.fg+")")),p.bg&&(g?(y.push(p.bg+"-bg"),p.bg_truecolor!==null&&(w["ansi-truecolor-bg"]=p.bg_truecolor,p.bg_truecolor=null)):y.push("background-color:rgb("+p.bg+")")),p.decorations.forEach(function(E){if(g){C.push("ansi-"+E);return}E==="bold"?C.push("font-weight:bold"):E==="dim"?C.push("opacity:0.5"):E==="italic"?C.push("font-style:italic"):E==="hidden"?C.push("visibility:hidden"):E==="strikethrough"?x.push("line-through"):x.push(E)}),x.length&&C.push("text-decoration:"+x.join(" ")),g?'<span class="'+y.concat(C).join(" ")+'"'+S(w)+">"+p.content+"</span>":'<span style="'+y.concat(C).join(";")+'"'+S(w)+">"+p.content+"</span>"}},{key:"removeDecoration",value:function(s){var l=this.decorations.indexOf(s);l>=0&&this.decorations.splice(l,1)}}]),o}();return nv=i,nv}var UL=LL();const jL=Nc(UL);function zw(n,e){let t=[];for(const r of n.split(`\r
`)){const i=jL.ansiToJson(r,{json:!0,remove_empty:!1});let o=[];for(const c of i){const s=zL(c,e);o=[...o,...s]}t=[...t,K.jsx("span",{children:o},t.length)]}return t}const VL=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,GL=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,WL=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function zL(n,e){const t=HL(n),r=[];let i=0,o=0;function c(h,p){let g;for(;(g=h.exec(n.content))!==null;){const y=g.index;y>i&&r.push(n.content.substring(i,y)),r.push(p(g)),i=h.lastIndex}}function s(h){const[,p,g]=h,y=g;return K.jsxs(K.Fragment,{children:[p,K.jsx("a",{href:y,target:"_blank",rel:"noreferrer",children:g})]})}function l(h){const p=h.groups.name,g=`mailto:${p}`;return K.jsxs(K.Fragment,{children:[h.groups.slorp1,K.jsx("a",{href:g,target:"_blank",rel:"noreferrer",children:p}),h.groups.slorp2]})}function d(h){const[,p,g]=h;return K.jsx("a",{onClick:()=>e(p),className:"exit",children:g})}return c(VL,s),c(GL,l),c(WL,d),i<n.content.length&&r.push(n.content.substring(i)),r.map(h=>K.jsx("span",{style:t,children:h},o++))}function HL(n){const e={};switch(n.bg&&(e.backgroundColor=`rgb(${n.bg})`),n.fg&&(e.color=`rgb(${n.fg})`),n.decoration){case"bold":e.fontWeight="bold";break;case"dim":e.opacity="0.5";break;case"italic":e.fontStyle="italic";break;case"hidden":e.visibility="hidden";break;case"strikethrough":e.textDecoration="line-through";break;case"underline":e.textDecoration="underline";break;case"blink":e.textDecoration="blink";break}return e}var dc={},al={},Hw;function ZL(){if(Hw)return al;Hw=1;var n=kf();function e(M){for(var G="https://reactjs.org/docs/error-decoder.html?invariant="+M,Q=1;Q<arguments.length;Q++)G+="&args[]="+encodeURIComponent(arguments[Q]);return"Minified React error #"+M+"; visit "+G+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t=Object.prototype.hasOwnProperty,r=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,i={},o={};function c(M){return t.call(o,M)?!0:t.call(i,M)?!1:r.test(M)?o[M]=!0:(i[M]=!0,!1)}function s(M,G,Q,ie,Oe,Te,ze){this.acceptsBooleans=G===2||G===3||G===4,this.attributeName=ie,this.attributeNamespace=Oe,this.mustUseProperty=Q,this.propertyName=M,this.type=G,this.sanitizeURL=Te,this.removeEmptyString=ze}var l={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(M){l[M]=new s(M,0,!1,M,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(M){var G=M[0];l[G]=new s(G,1,!1,M[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(M){l[M]=new s(M,2,!1,M.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(M){l[M]=new s(M,2,!1,M,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(M){l[M]=new s(M,3,!1,M.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(M){l[M]=new s(M,3,!0,M,null,!1,!1)}),["capture","download"].forEach(function(M){l[M]=new s(M,4,!1,M,null,!1,!1)}),["cols","rows","size","span"].forEach(function(M){l[M]=new s(M,6,!1,M,null,!1,!1)}),["rowSpan","start"].forEach(function(M){l[M]=new s(M,5,!1,M.toLowerCase(),null,!1,!1)});var d=/[\-:]([a-z])/g;function h(M){return M[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(M){var G=M.replace(d,h);l[G]=new s(G,1,!1,M,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(M){var G=M.replace(d,h);l[G]=new s(G,1,!1,M,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(M){var G=M.replace(d,h);l[G]=new s(G,1,!1,M,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(M){l[M]=new s(M,1,!1,M.toLowerCase(),null,!1,!1)}),l.xlinkHref=new s("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(M){l[M]=new s(M,1,!1,M.toLowerCase(),null,!0,!0)});var p={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},g=["Webkit","ms","Moz","O"];Object.keys(p).forEach(function(M){g.forEach(function(G){G=G+M.charAt(0).toUpperCase()+M.substring(1),p[G]=p[M]})});var y=/["'&<>]/;function C(M){if(typeof M=="boolean"||typeof M=="number")return""+M;M=""+M;var G=y.exec(M);if(G){var Q="",ie,Oe=0;for(ie=G.index;ie<M.length;ie++){switch(M.charCodeAt(ie)){case 34:G="&quot;";break;case 38:G="&amp;";break;case 39:G="&#x27;";break;case 60:G="&lt;";break;case 62:G="&gt;";break;default:continue}Oe!==ie&&(Q+=M.substring(Oe,ie)),Oe=ie+1,Q+=G}M=Oe!==ie?Q+M.substring(Oe,ie):Q}return M}var x=/([A-Z])/g,w=/^ms-/,S=Array.isArray;function E(M,G){return{insertionMode:M,selectedValue:G}}function R(M,G,Q){switch(G){case"select":return E(1,Q.value!=null?Q.value:Q.defaultValue);case"svg":return E(2,null);case"math":return E(3,null);case"foreignObject":return E(1,null);case"table":return E(4,null);case"thead":case"tbody":case"tfoot":return E(5,null);case"colgroup":return E(7,null);case"tr":return E(6,null)}return 4<=M.insertionMode||M.insertionMode===0?E(1,null):M}var k=new Map;function A(M,G,Q){if(typeof Q!="object")throw Error(e(62));G=!0;for(var ie in Q)if(t.call(Q,ie)){var Oe=Q[ie];if(Oe!=null&&typeof Oe!="boolean"&&Oe!==""){if(ie.indexOf("--")===0){var Te=C(ie);Oe=C((""+Oe).trim())}else{Te=ie;var ze=k.get(Te);ze!==void 0||(ze=C(Te.replace(x,"-$1").toLowerCase().replace(w,"-ms-")),k.set(Te,ze)),Te=ze,Oe=typeof Oe=="number"?Oe===0||t.call(p,ie)?""+Oe:Oe+"px":C((""+Oe).trim())}G?(G=!1,M.push(' style="',Te,":",Oe)):M.push(";",Te,":",Oe)}}G||M.push('"')}function _(M,G,Q,ie){switch(Q){case"style":A(M,G,ie);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<Q.length)||Q[0]!=="o"&&Q[0]!=="O"||Q[1]!=="n"&&Q[1]!=="N"){if(G=l.hasOwnProperty(Q)?l[Q]:null,G!==null){switch(typeof ie){case"function":case"symbol":return;case"boolean":if(!G.acceptsBooleans)return}switch(Q=G.attributeName,G.type){case 3:ie&&M.push(" ",Q,'=""');break;case 4:ie===!0?M.push(" ",Q,'=""'):ie!==!1&&M.push(" ",Q,'="',C(ie),'"');break;case 5:isNaN(ie)||M.push(" ",Q,'="',C(ie),'"');break;case 6:!isNaN(ie)&&1<=ie&&M.push(" ",Q,'="',C(ie),'"');break;default:G.sanitizeURL&&(ie=""+ie),M.push(" ",Q,'="',C(ie),'"')}}else if(c(Q)){switch(typeof ie){case"function":case"symbol":return;case"boolean":if(G=Q.toLowerCase().slice(0,5),G!=="data-"&&G!=="aria-")return}M.push(" ",Q,'="',C(ie),'"')}}}function D(M,G,Q){if(G!=null){if(Q!=null)throw Error(e(60));if(typeof G!="object"||!("__html"in G))throw Error(e(61));G=G.__html,G!=null&&M.push(""+G)}}function j(M){var G="";return n.Children.forEach(M,function(Q){Q!=null&&(G+=Q)}),G}function Z(M,G,Q,ie){M.push(X(Q));var Oe=Q=null,Te;for(Te in G)if(t.call(G,Te)){var ze=G[Te];if(ze!=null)switch(Te){case"children":Q=ze;break;case"dangerouslySetInnerHTML":Oe=ze;break;default:_(M,ie,Te,ze)}}return M.push(">"),D(M,Oe,Q),typeof Q=="string"?(M.push(C(Q)),null):Q}var F=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,V=new Map;function X(M){var G=V.get(M);if(G===void 0){if(!F.test(M))throw Error(e(65,M));G="<"+M,V.set(M,G)}return G}function te(M,G,Q,ie,Oe){switch(G){case"select":M.push(X("select"));var Te=null,ze=null;for(an in Q)if(t.call(Q,an)){var dt=Q[an];if(dt!=null)switch(an){case"children":Te=dt;break;case"dangerouslySetInnerHTML":ze=dt;break;case"defaultValue":case"value":break;default:_(M,ie,an,dt)}}return M.push(">"),D(M,ze,Te),Te;case"option":ze=Oe.selectedValue,M.push(X("option"));var mt=dt=null,Kt=null,an=null;for(Te in Q)if(t.call(Q,Te)){var Un=Q[Te];if(Un!=null)switch(Te){case"children":dt=Un;break;case"selected":Kt=Un;break;case"dangerouslySetInnerHTML":an=Un;break;case"value":mt=Un;default:_(M,ie,Te,Un)}}if(ze!=null)if(Q=mt!==null?""+mt:j(dt),S(ze)){for(ie=0;ie<ze.length;ie++)if(""+ze[ie]===Q){M.push(' selected=""');break}}else""+ze===Q&&M.push(' selected=""');else Kt&&M.push(' selected=""');return M.push(">"),D(M,an,dt),dt;case"textarea":M.push(X("textarea")),an=ze=Te=null;for(dt in Q)if(t.call(Q,dt)&&(mt=Q[dt],mt!=null))switch(dt){case"children":an=mt;break;case"value":Te=mt;break;case"defaultValue":ze=mt;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:_(M,ie,dt,mt)}if(Te===null&&ze!==null&&(Te=ze),M.push(">"),an!=null){if(Te!=null)throw Error(e(92));if(S(an)&&1<an.length)throw Error(e(93));Te=""+an}return typeof Te=="string"&&Te[0]===`
`&&M.push(`
`),Te!==null&&M.push(C(""+Te)),null;case"input":M.push(X("input")),mt=an=dt=Te=null;for(ze in Q)if(t.call(Q,ze)&&(Kt=Q[ze],Kt!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":mt=Kt;break;case"defaultValue":dt=Kt;break;case"checked":an=Kt;break;case"value":Te=Kt;break;default:_(M,ie,ze,Kt)}return an!==null?_(M,ie,"checked",an):mt!==null&&_(M,ie,"checked",mt),Te!==null?_(M,ie,"value",Te):dt!==null&&_(M,ie,"value",dt),M.push("/>"),null;case"menuitem":M.push(X("menuitem"));for(var wi in Q)if(t.call(Q,wi)&&(Te=Q[wi],Te!=null))switch(wi){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:_(M,ie,wi,Te)}return M.push(">"),null;case"title":M.push(X("title")),Te=null;for(Un in Q)if(t.call(Q,Un)&&(ze=Q[Un],ze!=null))switch(Un){case"children":Te=ze;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:_(M,ie,Un,ze)}return M.push(">"),Te;case"listing":case"pre":M.push(X(G)),ze=Te=null;for(mt in Q)if(t.call(Q,mt)&&(dt=Q[mt],dt!=null))switch(mt){case"children":Te=dt;break;case"dangerouslySetInnerHTML":ze=dt;break;default:_(M,ie,mt,dt)}if(M.push(">"),ze!=null){if(Te!=null)throw Error(e(60));if(typeof ze!="object"||!("__html"in ze))throw Error(e(61));Q=ze.__html,Q!=null&&(typeof Q=="string"&&0<Q.length&&Q[0]===`
`?M.push(`
`,Q):M.push(""+Q))}return typeof Te=="string"&&Te[0]===`
`&&M.push(`
`),Te;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":M.push(X(G));for(var Si in Q)if(t.call(Q,Si)&&(Te=Q[Si],Te!=null))switch(Si){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,G));default:_(M,ie,Si,Te)}return M.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Z(M,Q,G,ie);case"html":return Oe.insertionMode===0&&M.push("<!DOCTYPE html>"),Z(M,Q,G,ie);default:if(G.indexOf("-")===-1&&typeof Q.is!="string")return Z(M,Q,G,ie);M.push(X(G)),ze=Te=null;for(Kt in Q)if(t.call(Q,Kt)&&(dt=Q[Kt],dt!=null))switch(Kt){case"children":Te=dt;break;case"dangerouslySetInnerHTML":ze=dt;break;case"style":A(M,ie,dt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:c(Kt)&&typeof dt!="function"&&typeof dt!="symbol"&&M.push(" ",Kt,'="',C(dt),'"')}return M.push(">"),D(M,ze,Te),Te}}function pe(M,G,Q){if(M.push('<!--$?--><template id="'),Q===null)throw Error(e(395));return M.push(Q),M.push('"></template>')}function ve(M,G,Q,ie){switch(Q.insertionMode){case 0:case 1:return M.push('<div hidden id="'),M.push(G.segmentPrefix),G=ie.toString(16),M.push(G),M.push('">');case 2:return M.push('<svg aria-hidden="true" style="display:none" id="'),M.push(G.segmentPrefix),G=ie.toString(16),M.push(G),M.push('">');case 3:return M.push('<math aria-hidden="true" style="display:none" id="'),M.push(G.segmentPrefix),G=ie.toString(16),M.push(G),M.push('">');case 4:return M.push('<table hidden id="'),M.push(G.segmentPrefix),G=ie.toString(16),M.push(G),M.push('">');case 5:return M.push('<table hidden><tbody id="'),M.push(G.segmentPrefix),G=ie.toString(16),M.push(G),M.push('">');case 6:return M.push('<table hidden><tr id="'),M.push(G.segmentPrefix),G=ie.toString(16),M.push(G),M.push('">');case 7:return M.push('<table hidden><colgroup id="'),M.push(G.segmentPrefix),G=ie.toString(16),M.push(G),M.push('">');default:throw Error(e(397))}}function Ie(M,G){switch(G.insertionMode){case 0:case 1:return M.push("</div>");case 2:return M.push("</svg>");case 3:return M.push("</math>");case 4:return M.push("</table>");case 5:return M.push("</tbody></table>");case 6:return M.push("</tr></table>");case 7:return M.push("</colgroup></table>");default:throw Error(e(397))}}var Re=/[<\u2028\u2029]/g;function xe(M){return JSON.stringify(M).replace(Re,function(G){switch(G){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function Ae(M,G){return G=G===void 0?"":G,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:G+"P:",segmentPrefix:G+"S:",boundaryPrefix:G+"B:",idPrefix:G,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:M}}function ke(M,G,Q,ie){return Q.generateStaticMarkup?(M.push(C(G)),!1):(G===""?M=ie:(ie&&M.push("<!-- -->"),M.push(C(G)),M=!0),M)}var H=Object.assign,ee=Symbol.for("react.element"),ae=Symbol.for("react.portal"),ye=Symbol.for("react.fragment"),Ee=Symbol.for("react.strict_mode"),_e=Symbol.for("react.profiler"),Je=Symbol.for("react.provider"),me=Symbol.for("react.context"),it=Symbol.for("react.forward_ref"),Tt=Symbol.for("react.suspense"),Xt=Symbol.for("react.suspense_list"),Et=Symbol.for("react.memo"),St=Symbol.for("react.lazy"),Pt=Symbol.for("react.scope"),at=Symbol.for("react.debug_trace_mode"),lt=Symbol.for("react.legacy_hidden"),Gt=Symbol.for("react.default_value"),Vt=Symbol.iterator;function Dt(M){if(M==null)return null;if(typeof M=="function")return M.displayName||M.name||null;if(typeof M=="string")return M;switch(M){case ye:return"Fragment";case ae:return"Portal";case _e:return"Profiler";case Ee:return"StrictMode";case Tt:return"Suspense";case Xt:return"SuspenseList"}if(typeof M=="object")switch(M.$$typeof){case me:return(M.displayName||"Context")+".Consumer";case Je:return(M._context.displayName||"Context")+".Provider";case it:var G=M.render;return M=M.displayName,M||(M=G.displayName||G.name||"",M=M!==""?"ForwardRef("+M+")":"ForwardRef"),M;case Et:return G=M.displayName||null,G!==null?G:Dt(M.type)||"Memo";case St:G=M._payload,M=M._init;try{return Dt(M(G))}catch{}}return null}var Ht={};function sn(M,G){if(M=M.contextTypes,!M)return Ht;var Q={},ie;for(ie in M)Q[ie]=G[ie];return Q}var ct=null;function ce(M,G){if(M!==G){M.context._currentValue2=M.parentValue,M=M.parent;var Q=G.parent;if(M===null){if(Q!==null)throw Error(e(401))}else{if(Q===null)throw Error(e(401));ce(M,Q)}G.context._currentValue2=G.value}}function rn(M){M.context._currentValue2=M.parentValue,M=M.parent,M!==null&&rn(M)}function mn(M){var G=M.parent;G!==null&&mn(G),M.context._currentValue2=M.value}function Vn(M,G){if(M.context._currentValue2=M.parentValue,M=M.parent,M===null)throw Error(e(402));M.depth===G.depth?ce(M,G):Vn(M,G)}function q(M,G){var Q=G.parent;if(Q===null)throw Error(e(402));M.depth===Q.depth?ce(M,Q):q(M,Q),G.context._currentValue2=G.value}function N(M){var G=ct;G!==M&&(G===null?mn(M):M===null?rn(G):G.depth===M.depth?ce(G,M):G.depth>M.depth?Vn(G,M):q(G,M),ct=M)}var L={isMounted:function(){return!1},enqueueSetState:function(M,G){M=M._reactInternals,M.queue!==null&&M.queue.push(G)},enqueueReplaceState:function(M,G){M=M._reactInternals,M.replace=!0,M.queue=[G]},enqueueForceUpdate:function(){}};function ne(M,G,Q,ie){var Oe=M.state!==void 0?M.state:null;M.updater=L,M.props=Q,M.state=Oe;var Te={queue:[],replace:!1};M._reactInternals=Te;var ze=G.contextType;if(M.context=typeof ze=="object"&&ze!==null?ze._currentValue2:ie,ze=G.getDerivedStateFromProps,typeof ze=="function"&&(ze=ze(Q,Oe),Oe=ze==null?Oe:H({},Oe,ze),M.state=Oe),typeof G.getDerivedStateFromProps!="function"&&typeof M.getSnapshotBeforeUpdate!="function"&&(typeof M.UNSAFE_componentWillMount=="function"||typeof M.componentWillMount=="function"))if(G=M.state,typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount(),G!==M.state&&L.enqueueReplaceState(M,M.state,null),Te.queue!==null&&0<Te.queue.length)if(G=Te.queue,ze=Te.replace,Te.queue=null,Te.replace=!1,ze&&G.length===1)M.state=G[0];else{for(Te=ze?G[0]:M.state,Oe=!0,ze=ze?1:0;ze<G.length;ze++){var dt=G[ze];dt=typeof dt=="function"?dt.call(M,Te,Q,ie):dt,dt!=null&&(Oe?(Oe=!1,Te=H({},Te,dt)):H(Te,dt))}M.state=Te}else Te.queue=null}var Ce={id:1,overflow:""};function Pe(M,G,Q){var ie=M.id;M=M.overflow;var Oe=32-Ve(ie)-1;ie&=~(1<<Oe),Q+=1;var Te=32-Ve(G)+Oe;if(30<Te){var ze=Oe-Oe%5;return Te=(ie&(1<<ze)-1).toString(32),ie>>=ze,Oe-=ze,{id:1<<32-Ve(G)+Oe|Q<<Oe|ie,overflow:Te+M}}return{id:1<<Te|Q<<Oe|ie,overflow:M}}var Ve=Math.clz32?Math.clz32:pn,Lt=Math.log,hn=Math.LN2;function pn(M){return M>>>=0,M===0?32:31-(Lt(M)/hn|0)|0}function xn(M,G){return M===G&&(M!==0||1/M===1/G)||M!==M&&G!==G}var dn=typeof Object.is=="function"?Object.is:xn,Ln=null,kr=null,yr=null,Qt=null,ei=!1,Qe=!1,Tn=0,Wt=null,hr=0;function Qn(){if(Ln===null)throw Error(e(321));return Ln}function ti(){if(0<hr)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function Lr(){return Qt===null?yr===null?(ei=!1,yr=Qt=ti()):(ei=!0,Qt=yr):Qt.next===null?(ei=!1,Qt=Qt.next=ti()):(ei=!0,Qt=Qt.next),Qt}function ge(){kr=Ln=null,Qe=!1,yr=null,hr=0,Qt=Wt=null}function we(M,G){return typeof G=="function"?G(M):G}function J(M,G,Q){if(Ln=Qn(),Qt=Lr(),ei){var ie=Qt.queue;if(G=ie.dispatch,Wt!==null&&(Q=Wt.get(ie),Q!==void 0)){Wt.delete(ie),ie=Qt.memoizedState;do ie=M(ie,Q.action),Q=Q.next;while(Q!==null);return Qt.memoizedState=ie,[ie,G]}return[Qt.memoizedState,G]}return M=M===we?typeof G=="function"?G():G:Q!==void 0?Q(G):G,Qt.memoizedState=M,M=Qt.queue={last:null,dispatch:null},M=M.dispatch=rt.bind(null,Ln,M),[Qt.memoizedState,M]}function Ge(M,G){if(Ln=Qn(),Qt=Lr(),G=G===void 0?null:G,Qt!==null){var Q=Qt.memoizedState;if(Q!==null&&G!==null){var ie=Q[1];e:if(ie===null)ie=!1;else{for(var Oe=0;Oe<ie.length&&Oe<G.length;Oe++)if(!dn(G[Oe],ie[Oe])){ie=!1;break e}ie=!0}if(ie)return Q[0]}}return M=M(),Qt.memoizedState=[M,G],M}function rt(M,G,Q){if(25<=hr)throw Error(e(301));if(M===Ln)if(Qe=!0,M={action:Q,next:null},Wt===null&&(Wt=new Map),Q=Wt.get(G),Q===void 0)Wt.set(G,M);else{for(G=Q;G.next!==null;)G=G.next;G.next=M}}function _t(){throw Error(e(394))}function Ot(){}var pt={readContext:function(M){return M._currentValue2},useContext:function(M){return Qn(),M._currentValue2},useMemo:Ge,useReducer:J,useRef:function(M){Ln=Qn(),Qt=Lr();var G=Qt.memoizedState;return G===null?(M={current:M},Qt.memoizedState=M):G},useState:function(M){return J(we,M)},useInsertionEffect:Ot,useLayoutEffect:function(){},useCallback:function(M,G){return Ge(function(){return M},G)},useImperativeHandle:Ot,useEffect:Ot,useDebugValue:Ot,useDeferredValue:function(M){return Qn(),M},useTransition:function(){return Qn(),[!1,_t]},useId:function(){var M=kr.treeContext,G=M.overflow;M=M.id,M=(M&~(1<<32-Ve(M)-1)).toString(32)+G;var Q=gt;if(Q===null)throw Error(e(404));return G=Tn++,M=":"+Q.idPrefix+"R"+M,0<G&&(M+="H"+G.toString(32)),M+":"},useMutableSource:function(M,G){return Qn(),G(M._source)},useSyncExternalStore:function(M,G,Q){if(Q===void 0)throw Error(e(407));return Q()}},gt=null,bt=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Le(M){return console.error(M),null}function ut(){}function He(M,G,Q,ie,Oe,Te,ze,dt,mt){var Kt=[],an=new Set;return G={destination:null,responseState:G,progressiveChunkSize:ie===void 0?12800:ie,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:an,pingedTasks:Kt,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Oe===void 0?Le:Oe,onAllReady:ut,onShellReady:ze===void 0?ut:ze,onShellError:ut,onFatalError:ut},Q=st(G,0,null,Q,!1,!1),Q.parentFlushed=!0,M=bn(G,M,null,Q,an,Ht,null,Ce),Kt.push(M),G}function bn(M,G,Q,ie,Oe,Te,ze,dt){M.allPendingTasks++,Q===null?M.pendingRootTasks++:Q.pendingTasks++;var mt={node:G,ping:function(){var Kt=M.pingedTasks;Kt.push(mt),Kt.length===1&&or(M)},blockedBoundary:Q,blockedSegment:ie,abortSet:Oe,legacyContext:Te,context:ze,treeContext:dt};return Oe.add(mt),mt}function st(M,G,Q,ie,Oe,Te){return{status:0,id:-1,index:G,parentFlushed:!1,chunks:[],children:[],formatContext:ie,boundary:Q,lastPushedText:Oe,textEmbedded:Te}}function de(M,G){if(M=M.onError(G),M!=null&&typeof M!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof M+'" instead');return M}function Ze(M,G){var Q=M.onShellError;Q(G),Q=M.onFatalError,Q(G),M.destination!==null?(M.status=2,M.destination.destroy(G)):(M.status=1,M.fatalError=G)}function It(M,G,Q,ie,Oe){for(Ln={},kr=G,Tn=0,M=Q(ie,Oe);Qe;)Qe=!1,Tn=0,hr+=1,Qt=null,M=Q(ie,Oe);return ge(),M}function In(M,G,Q,ie){var Oe=Q.render(),Te=ie.childContextTypes;if(Te!=null){var ze=G.legacyContext;if(typeof Q.getChildContext!="function")ie=ze;else{Q=Q.getChildContext();for(var dt in Q)if(!(dt in Te))throw Error(e(108,Dt(ie)||"Unknown",dt));ie=H({},ze,Q)}G.legacyContext=ie,zt(M,G,Oe),G.legacyContext=ze}else zt(M,G,Oe)}function Ft(M,G){if(M&&M.defaultProps){G=H({},G),M=M.defaultProps;for(var Q in M)G[Q]===void 0&&(G[Q]=M[Q]);return G}return G}function wt(M,G,Q,ie,Oe){if(typeof Q=="function")if(Q.prototype&&Q.prototype.isReactComponent){Oe=sn(Q,G.legacyContext);var Te=Q.contextType;Te=new Q(ie,typeof Te=="object"&&Te!==null?Te._currentValue2:Oe),ne(Te,Q,ie,Oe),In(M,G,Te,Q)}else{Te=sn(Q,G.legacyContext),Oe=It(M,G,Q,ie,Te);var ze=Tn!==0;if(typeof Oe=="object"&&Oe!==null&&typeof Oe.render=="function"&&Oe.$$typeof===void 0)ne(Oe,Q,ie,Te),In(M,G,Oe,Q);else if(ze){ie=G.treeContext,G.treeContext=Pe(ie,1,0);try{zt(M,G,Oe)}finally{G.treeContext=ie}}else zt(M,G,Oe)}else if(typeof Q=="string"){switch(Oe=G.blockedSegment,Te=te(Oe.chunks,Q,ie,M.responseState,Oe.formatContext),Oe.lastPushedText=!1,ze=Oe.formatContext,Oe.formatContext=R(ze,Q,ie),er(M,G,Te),Oe.formatContext=ze,Q){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Oe.chunks.push("</",Q,">")}Oe.lastPushedText=!1}else{switch(Q){case lt:case at:case Ee:case _e:case ye:zt(M,G,ie.children);return;case Xt:zt(M,G,ie.children);return;case Pt:throw Error(e(343));case Tt:e:{Q=G.blockedBoundary,Oe=G.blockedSegment,Te=ie.fallback,ie=ie.children,ze=new Set;var dt={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:ze,errorDigest:null},mt=st(M,Oe.chunks.length,dt,Oe.formatContext,!1,!1);Oe.children.push(mt),Oe.lastPushedText=!1;var Kt=st(M,0,null,Oe.formatContext,!1,!1);Kt.parentFlushed=!0,G.blockedBoundary=dt,G.blockedSegment=Kt;try{if(er(M,G,ie),M.responseState.generateStaticMarkup||Kt.lastPushedText&&Kt.textEmbedded&&Kt.chunks.push("<!-- -->"),Kt.status=1,nn(dt,Kt),dt.pendingTasks===0)break e}catch(an){Kt.status=4,dt.forceClientRender=!0,dt.errorDigest=de(M,an)}finally{G.blockedBoundary=Q,G.blockedSegment=Oe}G=bn(M,Te,Q,mt,ze,G.legacyContext,G.context,G.treeContext),M.pingedTasks.push(G)}return}if(typeof Q=="object"&&Q!==null)switch(Q.$$typeof){case it:if(ie=It(M,G,Q.render,ie,Oe),Tn!==0){Q=G.treeContext,G.treeContext=Pe(Q,1,0);try{zt(M,G,ie)}finally{G.treeContext=Q}}else zt(M,G,ie);return;case Et:Q=Q.type,ie=Ft(Q,ie),wt(M,G,Q,ie,Oe);return;case Je:if(Oe=ie.children,Q=Q._context,ie=ie.value,Te=Q._currentValue2,Q._currentValue2=ie,ze=ct,ct=ie={parent:ze,depth:ze===null?0:ze.depth+1,context:Q,parentValue:Te,value:ie},G.context=ie,zt(M,G,Oe),M=ct,M===null)throw Error(e(403));ie=M.parentValue,M.context._currentValue2=ie===Gt?M.context._defaultValue:ie,M=ct=M.parent,G.context=M;return;case me:ie=ie.children,ie=ie(Q._currentValue2),zt(M,G,ie);return;case St:Oe=Q._init,Q=Oe(Q._payload),ie=Ft(Q,ie),wt(M,G,Q,ie,void 0);return}throw Error(e(130,Q==null?Q:typeof Q,""))}}function zt(M,G,Q){if(G.node=Q,typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case ee:wt(M,G,Q.type,Q.props,Q.ref);return;case ae:throw Error(e(257));case St:var ie=Q._init;Q=ie(Q._payload),zt(M,G,Q);return}if(S(Q)){Jn(M,G,Q);return}if(Q===null||typeof Q!="object"?ie=null:(ie=Vt&&Q[Vt]||Q["@@iterator"],ie=typeof ie=="function"?ie:null),ie&&(ie=ie.call(Q))){if(Q=ie.next(),!Q.done){var Oe=[];do Oe.push(Q.value),Q=ie.next();while(!Q.done);Jn(M,G,Oe)}return}throw M=Object.prototype.toString.call(Q),Error(e(31,M==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":M))}typeof Q=="string"?(ie=G.blockedSegment,ie.lastPushedText=ke(G.blockedSegment.chunks,Q,M.responseState,ie.lastPushedText)):typeof Q=="number"&&(ie=G.blockedSegment,ie.lastPushedText=ke(G.blockedSegment.chunks,""+Q,M.responseState,ie.lastPushedText))}function Jn(M,G,Q){for(var ie=Q.length,Oe=0;Oe<ie;Oe++){var Te=G.treeContext;G.treeContext=Pe(Te,ie,Oe);try{er(M,G,Q[Oe])}finally{G.treeContext=Te}}}function er(M,G,Q){var ie=G.blockedSegment.formatContext,Oe=G.legacyContext,Te=G.context;try{return zt(M,G,Q)}catch(mt){if(ge(),typeof mt=="object"&&mt!==null&&typeof mt.then=="function"){Q=mt;var ze=G.blockedSegment,dt=st(M,ze.chunks.length,null,ze.formatContext,ze.lastPushedText,!0);ze.children.push(dt),ze.lastPushedText=!1,M=bn(M,G.node,G.blockedBoundary,dt,G.abortSet,G.legacyContext,G.context,G.treeContext).ping,Q.then(M,M),G.blockedSegment.formatContext=ie,G.legacyContext=Oe,G.context=Te,N(Te)}else throw G.blockedSegment.formatContext=ie,G.legacyContext=Oe,G.context=Te,N(Te),mt}}function ir(M){var G=M.blockedBoundary;M=M.blockedSegment,M.status=3,vn(this,G,M)}function Fn(M,G,Q){var ie=M.blockedBoundary;M.blockedSegment.status=3,ie===null?(G.allPendingTasks--,G.status!==2&&(G.status=2,G.destination!==null&&G.destination.push(null))):(ie.pendingTasks--,ie.forceClientRender||(ie.forceClientRender=!0,M=Q===void 0?Error(e(432)):Q,ie.errorDigest=G.onError(M),ie.parentFlushed&&G.clientRenderedBoundaries.push(ie)),ie.fallbackAbortableTasks.forEach(function(Oe){return Fn(Oe,G,Q)}),ie.fallbackAbortableTasks.clear(),G.allPendingTasks--,G.allPendingTasks===0&&(ie=G.onAllReady,ie()))}function nn(M,G){if(G.chunks.length===0&&G.children.length===1&&G.children[0].boundary===null){var Q=G.children[0];Q.id=G.id,Q.parentFlushed=!0,Q.status===1&&nn(M,Q)}else M.completedSegments.push(G)}function vn(M,G,Q){if(G===null){if(Q.parentFlushed){if(M.completedRootSegment!==null)throw Error(e(389));M.completedRootSegment=Q}M.pendingRootTasks--,M.pendingRootTasks===0&&(M.onShellError=ut,G=M.onShellReady,G())}else G.pendingTasks--,G.forceClientRender||(G.pendingTasks===0?(Q.parentFlushed&&Q.status===1&&nn(G,Q),G.parentFlushed&&M.completedBoundaries.push(G),G.fallbackAbortableTasks.forEach(ir,M),G.fallbackAbortableTasks.clear()):Q.parentFlushed&&Q.status===1&&(nn(G,Q),G.completedSegments.length===1&&G.parentFlushed&&M.partialBoundaries.push(G)));M.allPendingTasks--,M.allPendingTasks===0&&(M=M.onAllReady,M())}function or(M){if(M.status!==2){var G=ct,Q=bt.current;bt.current=pt;var ie=gt;gt=M.responseState;try{var Oe=M.pingedTasks,Te;for(Te=0;Te<Oe.length;Te++){var ze=Oe[Te],dt=M,mt=ze.blockedSegment;if(mt.status===0){N(ze.context);try{zt(dt,ze,ze.node),dt.responseState.generateStaticMarkup||mt.lastPushedText&&mt.textEmbedded&&mt.chunks.push("<!-- -->"),ze.abortSet.delete(ze),mt.status=1,vn(dt,ze.blockedBoundary,mt)}catch(ni){if(ge(),typeof ni=="object"&&ni!==null&&typeof ni.then=="function"){var Kt=ze.ping;ni.then(Kt,Kt)}else{ze.abortSet.delete(ze),mt.status=4;var an=ze.blockedBoundary,Un=ni,wi=de(dt,Un);if(an===null?Ze(dt,Un):(an.pendingTasks--,an.forceClientRender||(an.forceClientRender=!0,an.errorDigest=wi,an.parentFlushed&&dt.clientRenderedBoundaries.push(an))),dt.allPendingTasks--,dt.allPendingTasks===0){var Si=dt.onAllReady;Si()}}}finally{}}}Oe.splice(0,Te),M.destination!==null&&Ji(M,M.destination)}catch(ni){de(M,ni),Ze(M,ni)}finally{gt=ie,bt.current=Q,Q===pt&&N(G)}}}function hi(M,G,Q){switch(Q.parentFlushed=!0,Q.status){case 0:var ie=Q.id=M.nextSegmentId++;return Q.lastPushedText=!1,Q.textEmbedded=!1,M=M.responseState,G.push('<template id="'),G.push(M.placeholderPrefix),M=ie.toString(16),G.push(M),G.push('"></template>');case 1:Q.status=2;var Oe=!0;ie=Q.chunks;var Te=0;Q=Q.children;for(var ze=0;ze<Q.length;ze++){for(Oe=Q[ze];Te<Oe.index;Te++)G.push(ie[Te]);Oe=yn(M,G,Oe)}for(;Te<ie.length-1;Te++)G.push(ie[Te]);return Te<ie.length&&(Oe=G.push(ie[Te])),Oe;default:throw Error(e(390))}}function yn(M,G,Q){var ie=Q.boundary;if(ie===null)return hi(M,G,Q);if(ie.parentFlushed=!0,ie.forceClientRender)return M.responseState.generateStaticMarkup||(ie=ie.errorDigest,G.push("<!--$!-->"),G.push("<template"),ie&&(G.push(' data-dgst="'),ie=C(ie),G.push(ie),G.push('"')),G.push("></template>")),hi(M,G,Q),M=M.responseState.generateStaticMarkup?!0:G.push("<!--/$-->"),M;if(0<ie.pendingTasks){ie.rootSegmentID=M.nextSegmentId++,0<ie.completedSegments.length&&M.partialBoundaries.push(ie);var Oe=M.responseState,Te=Oe.nextSuspenseID++;return Oe=Oe.boundaryPrefix+Te.toString(16),ie=ie.id=Oe,pe(G,M.responseState,ie),hi(M,G,Q),G.push("<!--/$-->")}if(ie.byteSize>M.progressiveChunkSize)return ie.rootSegmentID=M.nextSegmentId++,M.completedBoundaries.push(ie),pe(G,M.responseState,ie.id),hi(M,G,Q),G.push("<!--/$-->");if(M.responseState.generateStaticMarkup||G.push("<!--$-->"),Q=ie.completedSegments,Q.length!==1)throw Error(e(391));return yn(M,G,Q[0]),M=M.responseState.generateStaticMarkup?!0:G.push("<!--/$-->"),M}function Wr(M,G,Q){return ve(G,M.responseState,Q.formatContext,Q.id),yn(M,G,Q),Ie(G,Q.formatContext)}function At(M,G,Q){for(var ie=Q.completedSegments,Oe=0;Oe<ie.length;Oe++)Lo(M,G,Q,ie[Oe]);if(ie.length=0,M=M.responseState,ie=Q.id,Q=Q.rootSegmentID,G.push(M.startInlineScript),M.sentCompleteBoundaryFunction?G.push('$RC("'):(M.sentCompleteBoundaryFunction=!0,G.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),ie===null)throw Error(e(395));return Q=Q.toString(16),G.push(ie),G.push('","'),G.push(M.segmentPrefix),G.push(Q),G.push('")<\/script>')}function Lo(M,G,Q,ie){if(ie.status===2)return!0;var Oe=ie.id;if(Oe===-1){if((ie.id=Q.rootSegmentID)===-1)throw Error(e(392));return Wr(M,G,ie)}return Wr(M,G,ie),M=M.responseState,G.push(M.startInlineScript),M.sentCompleteSegmentFunction?G.push('$RS("'):(M.sentCompleteSegmentFunction=!0,G.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),G.push(M.segmentPrefix),Oe=Oe.toString(16),G.push(Oe),G.push('","'),G.push(M.placeholderPrefix),G.push(Oe),G.push('")<\/script>')}function Ji(M,G){try{var Q=M.completedRootSegment;if(Q!==null&&M.pendingRootTasks===0){yn(M,G,Q),M.completedRootSegment=null;var ie=M.responseState.bootstrapChunks;for(Q=0;Q<ie.length-1;Q++)G.push(ie[Q]);Q<ie.length&&G.push(ie[Q])}var Oe=M.clientRenderedBoundaries,Te;for(Te=0;Te<Oe.length;Te++){var ze=Oe[Te];ie=G;var dt=M.responseState,mt=ze.id,Kt=ze.errorDigest,an=ze.errorMessage,Un=ze.errorComponentStack;if(ie.push(dt.startInlineScript),dt.sentClientRenderFunction?ie.push('$RX("'):(dt.sentClientRenderFunction=!0,ie.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),mt===null)throw Error(e(395));if(ie.push(mt),ie.push('"'),Kt||an||Un){ie.push(",");var wi=xe(Kt||"");ie.push(wi)}if(an||Un){ie.push(",");var Si=xe(an||"");ie.push(Si)}if(Un){ie.push(",");var ni=xe(Un);ie.push(ni)}if(!ie.push(")<\/script>")){M.destination=null,Te++,Oe.splice(0,Te);return}}Oe.splice(0,Te);var Ai=M.completedBoundaries;for(Te=0;Te<Ai.length;Te++)if(!At(M,G,Ai[Te])){M.destination=null,Te++,Ai.splice(0,Te);return}Ai.splice(0,Te);var ki=M.partialBoundaries;for(Te=0;Te<ki.length;Te++){var Cr=ki[Te];e:{Oe=M,ze=G;var ri=Cr.completedSegments;for(dt=0;dt<ri.length;dt++)if(!Lo(Oe,ze,Cr,ri[dt])){dt++,ri.splice(0,dt);var tr=!1;break e}ri.splice(0,dt),tr=!0}if(!tr){M.destination=null,Te++,ki.splice(0,Te);return}}ki.splice(0,Te);var zr=M.completedBoundaries;for(Te=0;Te<zr.length;Te++)if(!At(M,G,zr[Te])){M.destination=null,Te++,zr.splice(0,Te);return}zr.splice(0,Te)}finally{M.allPendingTasks===0&&M.pingedTasks.length===0&&M.clientRenderedBoundaries.length===0&&M.completedBoundaries.length===0&&G.push(null)}}function eo(M,G){try{var Q=M.abortableTasks;Q.forEach(function(ie){return Fn(ie,M,G)}),Q.clear(),M.destination!==null&&Ji(M,M.destination)}catch(ie){de(M,ie),Ze(M,ie)}}function kt(){}function on(M,G,Q,ie){var Oe=!1,Te=null,ze="",dt={push:function(Kt){return Kt!==null&&(ze+=Kt),!0},destroy:function(Kt){Oe=!0,Te=Kt}},mt=!1;if(M=He(M,Ae(Q,G?G.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,kt,void 0,function(){mt=!0}),or(M),eo(M,ie),M.status===1)M.status=2,dt.destroy(M.fatalError);else if(M.status!==2&&M.destination===null){M.destination=dt;try{Ji(M,dt)}catch(Kt){de(M,Kt),Ze(M,Kt)}}if(Oe)throw Te;if(!mt)throw Error(e(426));return ze}return al.renderToNodeStream=function(){throw Error(e(207))},al.renderToStaticMarkup=function(M,G){return on(M,G,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},al.renderToStaticNodeStream=function(){throw Error(e(208))},al.renderToString=function(M,G){return on(M,G,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},al.version="18.3.1",al}var Vh={},Zw;function XL(){if(Zw)return Vh;Zw=1;var n=kf();function e(P){for(var W="https://reactjs.org/docs/error-decoder.html?invariant="+P,Y=1;Y<arguments.length;Y++)W+="&args[]="+encodeURIComponent(arguments[Y]);return"Minified React error #"+P+"; visit "+W+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t=null,r=0;function i(P,W){if(W.length!==0)if(512<W.length)0<r&&(P.enqueue(new Uint8Array(t.buffer,0,r)),t=new Uint8Array(512),r=0),P.enqueue(W);else{var Y=t.length-r;Y<W.length&&(Y===0?P.enqueue(t):(t.set(W.subarray(0,Y),r),P.enqueue(t),W=W.subarray(Y)),t=new Uint8Array(512),r=0),t.set(W,r),r+=W.length}}function o(P,W){return i(P,W),!0}function c(P){t&&0<r&&(P.enqueue(new Uint8Array(t.buffer,0,r)),t=null,r=0)}var s=new TextEncoder;function l(P){return s.encode(P)}function d(P){return s.encode(P)}function h(P,W){typeof P.error=="function"?P.error(W):P.close()}var p=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},C={};function x(P){return p.call(C,P)?!0:p.call(y,P)?!1:g.test(P)?C[P]=!0:(y[P]=!0,!1)}function w(P,W,Y,re,Ne,De,Ke){this.acceptsBooleans=W===2||W===3||W===4,this.attributeName=re,this.attributeNamespace=Ne,this.mustUseProperty=Y,this.propertyName=P,this.type=W,this.sanitizeURL=De,this.removeEmptyString=Ke}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(P){S[P]=new w(P,0,!1,P,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(P){var W=P[0];S[W]=new w(W,1,!1,P[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(P){S[P]=new w(P,2,!1,P.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(P){S[P]=new w(P,2,!1,P,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(P){S[P]=new w(P,3,!1,P.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(P){S[P]=new w(P,3,!0,P,null,!1,!1)}),["capture","download"].forEach(function(P){S[P]=new w(P,4,!1,P,null,!1,!1)}),["cols","rows","size","span"].forEach(function(P){S[P]=new w(P,6,!1,P,null,!1,!1)}),["rowSpan","start"].forEach(function(P){S[P]=new w(P,5,!1,P.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function R(P){return P[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(P){var W=P.replace(E,R);S[W]=new w(W,1,!1,P,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(P){var W=P.replace(E,R);S[W]=new w(W,1,!1,P,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(P){var W=P.replace(E,R);S[W]=new w(W,1,!1,P,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(P){S[P]=new w(P,1,!1,P.toLowerCase(),null,!1,!1)}),S.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(P){S[P]=new w(P,1,!1,P.toLowerCase(),null,!0,!0)});var k={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},A=["Webkit","ms","Moz","O"];Object.keys(k).forEach(function(P){A.forEach(function(W){W=W+P.charAt(0).toUpperCase()+P.substring(1),k[W]=k[P]})});var _=/["'&<>]/;function D(P){if(typeof P=="boolean"||typeof P=="number")return""+P;P=""+P;var W=_.exec(P);if(W){var Y="",re,Ne=0;for(re=W.index;re<P.length;re++){switch(P.charCodeAt(re)){case 34:W="&quot;";break;case 38:W="&amp;";break;case 39:W="&#x27;";break;case 60:W="&lt;";break;case 62:W="&gt;";break;default:continue}Ne!==re&&(Y+=P.substring(Ne,re)),Ne=re+1,Y+=W}P=Ne!==re?Y+P.substring(Ne,re):Y}return P}var j=/([A-Z])/g,Z=/^ms-/,F=Array.isArray,V=d("<script>"),X=d("<\/script>"),te=d('<script src="'),pe=d('<script type="module" src="'),ve=d('" async=""><\/script>'),Ie=/(<\/|<)(s)(cript)/gi;function Re(P,W,Y,re){return""+W+(Y==="s"?"\\u0073":"\\u0053")+re}function xe(P,W,Y,re,Ne){P=P===void 0?"":P,W=W===void 0?V:d('<script nonce="'+D(W)+'">');var De=[];if(Y!==void 0&&De.push(W,l((""+Y).replace(Ie,Re)),X),re!==void 0)for(Y=0;Y<re.length;Y++)De.push(te,l(D(re[Y])),ve);if(Ne!==void 0)for(re=0;re<Ne.length;re++)De.push(pe,l(D(Ne[re])),ve);return{bootstrapChunks:De,startInlineScript:W,placeholderPrefix:d(P+"P:"),segmentPrefix:d(P+"S:"),boundaryPrefix:P+"B:",idPrefix:P,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function Ae(P,W){return{insertionMode:P,selectedValue:W}}function ke(P){return Ae(P==="http://www.w3.org/2000/svg"?2:P==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function H(P,W,Y){switch(W){case"select":return Ae(1,Y.value!=null?Y.value:Y.defaultValue);case"svg":return Ae(2,null);case"math":return Ae(3,null);case"foreignObject":return Ae(1,null);case"table":return Ae(4,null);case"thead":case"tbody":case"tfoot":return Ae(5,null);case"colgroup":return Ae(7,null);case"tr":return Ae(6,null)}return 4<=P.insertionMode||P.insertionMode===0?Ae(1,null):P}var ee=d("<!-- -->");function ae(P,W,Y,re){return W===""?re:(re&&P.push(ee),P.push(l(D(W))),!0)}var ye=new Map,Ee=d(' style="'),_e=d(":"),Je=d(";");function me(P,W,Y){if(typeof Y!="object")throw Error(e(62));W=!0;for(var re in Y)if(p.call(Y,re)){var Ne=Y[re];if(Ne!=null&&typeof Ne!="boolean"&&Ne!==""){if(re.indexOf("--")===0){var De=l(D(re));Ne=l(D((""+Ne).trim()))}else{De=re;var Ke=ye.get(De);Ke!==void 0||(Ke=d(D(De.replace(j,"-$1").toLowerCase().replace(Z,"-ms-"))),ye.set(De,Ke)),De=Ke,Ne=typeof Ne=="number"?Ne===0||p.call(k,re)?l(""+Ne):l(Ne+"px"):l(D((""+Ne).trim()))}W?(W=!1,P.push(Ee,De,_e,Ne)):P.push(Je,De,_e,Ne)}}W||P.push(Xt)}var it=d(" "),Tt=d('="'),Xt=d('"'),Et=d('=""');function St(P,W,Y,re){switch(Y){case"style":me(P,W,re);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<Y.length)||Y[0]!=="o"&&Y[0]!=="O"||Y[1]!=="n"&&Y[1]!=="N"){if(W=S.hasOwnProperty(Y)?S[Y]:null,W!==null){switch(typeof re){case"function":case"symbol":return;case"boolean":if(!W.acceptsBooleans)return}switch(Y=l(W.attributeName),W.type){case 3:re&&P.push(it,Y,Et);break;case 4:re===!0?P.push(it,Y,Et):re!==!1&&P.push(it,Y,Tt,l(D(re)),Xt);break;case 5:isNaN(re)||P.push(it,Y,Tt,l(D(re)),Xt);break;case 6:!isNaN(re)&&1<=re&&P.push(it,Y,Tt,l(D(re)),Xt);break;default:W.sanitizeURL&&(re=""+re),P.push(it,Y,Tt,l(D(re)),Xt)}}else if(x(Y)){switch(typeof re){case"function":case"symbol":return;case"boolean":if(W=Y.toLowerCase().slice(0,5),W!=="data-"&&W!=="aria-")return}P.push(it,l(Y),Tt,l(D(re)),Xt)}}}var Pt=d(">"),at=d("/>");function lt(P,W,Y){if(W!=null){if(Y!=null)throw Error(e(60));if(typeof W!="object"||!("__html"in W))throw Error(e(61));W=W.__html,W!=null&&P.push(l(""+W))}}function Gt(P){var W="";return n.Children.forEach(P,function(Y){Y!=null&&(W+=Y)}),W}var Vt=d(' selected=""');function Dt(P,W,Y,re){P.push(ce(Y));var Ne=Y=null,De;for(De in W)if(p.call(W,De)){var Ke=W[De];if(Ke!=null)switch(De){case"children":Y=Ke;break;case"dangerouslySetInnerHTML":Ne=Ke;break;default:St(P,re,De,Ke)}}return P.push(Pt),lt(P,Ne,Y),typeof Y=="string"?(P.push(l(D(Y))),null):Y}var Ht=d(`
`),sn=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,ct=new Map;function ce(P){var W=ct.get(P);if(W===void 0){if(!sn.test(P))throw Error(e(65,P));W=d("<"+P),ct.set(P,W)}return W}var rn=d("<!DOCTYPE html>");function mn(P,W,Y,re,Ne){switch(W){case"select":P.push(ce("select"));var De=null,Ke=null;for(Zt in Y)if(p.call(Y,Zt)){var et=Y[Zt];if(et!=null)switch(Zt){case"children":De=et;break;case"dangerouslySetInnerHTML":Ke=et;break;case"defaultValue":case"value":break;default:St(P,re,Zt,et)}}return P.push(Pt),lt(P,Ke,De),De;case"option":Ke=Ne.selectedValue,P.push(ce("option"));var $t=et=null,un=null,Zt=null;for(De in Y)if(p.call(Y,De)){var Gn=Y[De];if(Gn!=null)switch(De){case"children":et=Gn;break;case"selected":un=Gn;break;case"dangerouslySetInnerHTML":Zt=Gn;break;case"value":$t=Gn;default:St(P,re,De,Gn)}}if(Ke!=null)if(Y=$t!==null?""+$t:Gt(et),F(Ke)){for(re=0;re<Ke.length;re++)if(""+Ke[re]===Y){P.push(Vt);break}}else""+Ke===Y&&P.push(Vt);else un&&P.push(Vt);return P.push(Pt),lt(P,Zt,et),et;case"textarea":P.push(ce("textarea")),Zt=Ke=De=null;for(et in Y)if(p.call(Y,et)&&($t=Y[et],$t!=null))switch(et){case"children":Zt=$t;break;case"value":De=$t;break;case"defaultValue":Ke=$t;break;case"dangerouslySetInnerHTML":throw Error(e(91));default:St(P,re,et,$t)}if(De===null&&Ke!==null&&(De=Ke),P.push(Pt),Zt!=null){if(De!=null)throw Error(e(92));if(F(Zt)&&1<Zt.length)throw Error(e(93));De=""+Zt}return typeof De=="string"&&De[0]===`
`&&P.push(Ht),De!==null&&P.push(l(D(""+De))),null;case"input":P.push(ce("input")),$t=Zt=et=De=null;for(Ke in Y)if(p.call(Y,Ke)&&(un=Y[Ke],un!=null))switch(Ke){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,"input"));case"defaultChecked":$t=un;break;case"defaultValue":et=un;break;case"checked":Zt=un;break;case"value":De=un;break;default:St(P,re,Ke,un)}return Zt!==null?St(P,re,"checked",Zt):$t!==null&&St(P,re,"checked",$t),De!==null?St(P,re,"value",De):et!==null&&St(P,re,"value",et),P.push(at),null;case"menuitem":P.push(ce("menuitem"));for(var Ir in Y)if(p.call(Y,Ir)&&(De=Y[Ir],De!=null))switch(Ir){case"children":case"dangerouslySetInnerHTML":throw Error(e(400));default:St(P,re,Ir,De)}return P.push(Pt),null;case"title":P.push(ce("title")),De=null;for(Gn in Y)if(p.call(Y,Gn)&&(Ke=Y[Gn],Ke!=null))switch(Gn){case"children":De=Ke;break;case"dangerouslySetInnerHTML":throw Error(e(434));default:St(P,re,Gn,Ke)}return P.push(Pt),De;case"listing":case"pre":P.push(ce(W)),Ke=De=null;for($t in Y)if(p.call(Y,$t)&&(et=Y[$t],et!=null))switch($t){case"children":De=et;break;case"dangerouslySetInnerHTML":Ke=et;break;default:St(P,re,$t,et)}if(P.push(Pt),Ke!=null){if(De!=null)throw Error(e(60));if(typeof Ke!="object"||!("__html"in Ke))throw Error(e(61));Y=Ke.__html,Y!=null&&(typeof Y=="string"&&0<Y.length&&Y[0]===`
`?P.push(Ht,l(Y)):P.push(l(""+Y)))}return typeof De=="string"&&De[0]===`
`&&P.push(Ht),De;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":P.push(ce(W));for(var Ei in Y)if(p.call(Y,Ei)&&(De=Y[Ei],De!=null))switch(Ei){case"children":case"dangerouslySetInnerHTML":throw Error(e(399,W));default:St(P,re,Ei,De)}return P.push(at),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Dt(P,Y,W,re);case"html":return Ne.insertionMode===0&&P.push(rn),Dt(P,Y,W,re);default:if(W.indexOf("-")===-1&&typeof Y.is!="string")return Dt(P,Y,W,re);P.push(ce(W)),Ke=De=null;for(un in Y)if(p.call(Y,un)&&(et=Y[un],et!=null))switch(un){case"children":De=et;break;case"dangerouslySetInnerHTML":Ke=et;break;case"style":me(P,re,et);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:x(un)&&typeof et!="function"&&typeof et!="symbol"&&P.push(it,l(un),Tt,l(D(et)),Xt)}return P.push(Pt),lt(P,Ke,De),De}}var Vn=d("</"),q=d(">"),N=d('<template id="'),L=d('"></template>'),ne=d("<!--$-->"),Ce=d('<!--$?--><template id="'),Pe=d('"></template>'),Ve=d("<!--$!-->"),Lt=d("<!--/$-->"),hn=d("<template"),pn=d('"'),xn=d(' data-dgst="');d(' data-msg="'),d(' data-stck="');var dn=d("></template>");function Ln(P,W,Y){if(i(P,Ce),Y===null)throw Error(e(395));return i(P,Y),o(P,Pe)}var kr=d('<div hidden id="'),yr=d('">'),Qt=d("</div>"),ei=d('<svg aria-hidden="true" style="display:none" id="'),Qe=d('">'),Tn=d("</svg>"),Wt=d('<math aria-hidden="true" style="display:none" id="'),hr=d('">'),Qn=d("</math>"),ti=d('<table hidden id="'),Lr=d('">'),ge=d("</table>"),we=d('<table hidden><tbody id="'),J=d('">'),Ge=d("</tbody></table>"),rt=d('<table hidden><tr id="'),_t=d('">'),Ot=d("</tr></table>"),pt=d('<table hidden><colgroup id="'),gt=d('">'),bt=d("</colgroup></table>");function Le(P,W,Y,re){switch(Y.insertionMode){case 0:case 1:return i(P,kr),i(P,W.segmentPrefix),i(P,l(re.toString(16))),o(P,yr);case 2:return i(P,ei),i(P,W.segmentPrefix),i(P,l(re.toString(16))),o(P,Qe);case 3:return i(P,Wt),i(P,W.segmentPrefix),i(P,l(re.toString(16))),o(P,hr);case 4:return i(P,ti),i(P,W.segmentPrefix),i(P,l(re.toString(16))),o(P,Lr);case 5:return i(P,we),i(P,W.segmentPrefix),i(P,l(re.toString(16))),o(P,J);case 6:return i(P,rt),i(P,W.segmentPrefix),i(P,l(re.toString(16))),o(P,_t);case 7:return i(P,pt),i(P,W.segmentPrefix),i(P,l(re.toString(16))),o(P,gt);default:throw Error(e(397))}}function ut(P,W){switch(W.insertionMode){case 0:case 1:return o(P,Qt);case 2:return o(P,Tn);case 3:return o(P,Qn);case 4:return o(P,ge);case 5:return o(P,Ge);case 6:return o(P,Ot);case 7:return o(P,bt);default:throw Error(e(397))}}var He=d('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),bn=d('$RS("'),st=d('","'),de=d('")<\/script>'),Ze=d('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),It=d('$RC("'),In=d('","'),Ft=d('")<\/script>'),wt=d('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),zt=d('$RX("'),Jn=d('"'),er=d(")<\/script>"),ir=d(","),Fn=/[<\u2028\u2029]/g;function nn(P){return JSON.stringify(P).replace(Fn,function(W){switch(W){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var vn=Object.assign,or=Symbol.for("react.element"),hi=Symbol.for("react.portal"),yn=Symbol.for("react.fragment"),Wr=Symbol.for("react.strict_mode"),At=Symbol.for("react.profiler"),Lo=Symbol.for("react.provider"),Ji=Symbol.for("react.context"),eo=Symbol.for("react.forward_ref"),kt=Symbol.for("react.suspense"),on=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),Q=Symbol.for("react.scope"),ie=Symbol.for("react.debug_trace_mode"),Oe=Symbol.for("react.legacy_hidden"),Te=Symbol.for("react.default_value"),ze=Symbol.iterator;function dt(P){if(P==null)return null;if(typeof P=="function")return P.displayName||P.name||null;if(typeof P=="string")return P;switch(P){case yn:return"Fragment";case hi:return"Portal";case At:return"Profiler";case Wr:return"StrictMode";case kt:return"Suspense";case on:return"SuspenseList"}if(typeof P=="object")switch(P.$$typeof){case Ji:return(P.displayName||"Context")+".Consumer";case Lo:return(P._context.displayName||"Context")+".Provider";case eo:var W=P.render;return P=P.displayName,P||(P=W.displayName||W.name||"",P=P!==""?"ForwardRef("+P+")":"ForwardRef"),P;case M:return W=P.displayName||null,W!==null?W:dt(P.type)||"Memo";case G:W=P._payload,P=P._init;try{return dt(P(W))}catch{}}return null}var mt={};function Kt(P,W){if(P=P.contextTypes,!P)return mt;var Y={},re;for(re in P)Y[re]=W[re];return Y}var an=null;function Un(P,W){if(P!==W){P.context._currentValue=P.parentValue,P=P.parent;var Y=W.parent;if(P===null){if(Y!==null)throw Error(e(401))}else{if(Y===null)throw Error(e(401));Un(P,Y)}W.context._currentValue=W.value}}function wi(P){P.context._currentValue=P.parentValue,P=P.parent,P!==null&&wi(P)}function Si(P){var W=P.parent;W!==null&&Si(W),P.context._currentValue=P.value}function ni(P,W){if(P.context._currentValue=P.parentValue,P=P.parent,P===null)throw Error(e(402));P.depth===W.depth?Un(P,W):ni(P,W)}function Ai(P,W){var Y=W.parent;if(Y===null)throw Error(e(402));P.depth===Y.depth?Un(P,Y):Ai(P,Y),W.context._currentValue=W.value}function ki(P){var W=an;W!==P&&(W===null?Si(P):P===null?wi(W):W.depth===P.depth?Un(W,P):W.depth>P.depth?ni(W,P):Ai(W,P),an=P)}var Cr={isMounted:function(){return!1},enqueueSetState:function(P,W){P=P._reactInternals,P.queue!==null&&P.queue.push(W)},enqueueReplaceState:function(P,W){P=P._reactInternals,P.replace=!0,P.queue=[W]},enqueueForceUpdate:function(){}};function ri(P,W,Y,re){var Ne=P.state!==void 0?P.state:null;P.updater=Cr,P.props=Y,P.state=Ne;var De={queue:[],replace:!1};P._reactInternals=De;var Ke=W.contextType;if(P.context=typeof Ke=="object"&&Ke!==null?Ke._currentValue:re,Ke=W.getDerivedStateFromProps,typeof Ke=="function"&&(Ke=Ke(Y,Ne),Ne=Ke==null?Ne:vn({},Ne,Ke),P.state=Ne),typeof W.getDerivedStateFromProps!="function"&&typeof P.getSnapshotBeforeUpdate!="function"&&(typeof P.UNSAFE_componentWillMount=="function"||typeof P.componentWillMount=="function"))if(W=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),W!==P.state&&Cr.enqueueReplaceState(P,P.state,null),De.queue!==null&&0<De.queue.length)if(W=De.queue,Ke=De.replace,De.queue=null,De.replace=!1,Ke&&W.length===1)P.state=W[0];else{for(De=Ke?W[0]:P.state,Ne=!0,Ke=Ke?1:0;Ke<W.length;Ke++){var et=W[Ke];et=typeof et=="function"?et.call(P,De,Y,re):et,et!=null&&(Ne?(Ne=!1,De=vn({},De,et)):vn(De,et))}P.state=De}else De.queue=null}var tr={id:1,overflow:""};function zr(P,W,Y){var re=P.id;P=P.overflow;var Ne=32-Co(re)-1;re&=~(1<<Ne),Y+=1;var De=32-Co(W)+Ne;if(30<De){var Ke=Ne-Ne%5;return De=(re&(1<<Ke)-1).toString(32),re>>=Ke,Ne-=Ke,{id:1<<32-Co(W)+Ne|Y<<Ne|re,overflow:De+P}}return{id:1<<De|Y<<Ne|re,overflow:P}}var Co=Math.clz32?Math.clz32:bo,xo=Math.log,fa=Math.LN2;function bo(P){return P>>>=0,P===0?32:31-(xo(P)/fa|0)|0}function ha(P,W){return P===W&&(P!==0||1/P===1/W)||P!==P&&W!==W}var Yu=typeof Object.is=="function"?Object.is:ha,to=null,rs=null,pa=null,jn=null,xr=!1,Ct=!1,pi=0,sr=null,gi=0;function no(){if(to===null)throw Error(e(321));return to}function ga(){if(0<gi)throw Error(e(312));return{memoizedState:null,queue:null,next:null}}function Uo(){return jn===null?pa===null?(xr=!1,pa=jn=ga()):(xr=!0,jn=pa):jn.next===null?(xr=!1,jn=jn.next=ga()):(xr=!0,jn=jn.next),jn}function Us(){rs=to=null,Ct=!1,pa=null,gi=0,jn=sr=null}function za(P,W){return typeof W=="function"?W(P):W}function Hn(P,W,Y){if(to=no(),jn=Uo(),xr){var re=jn.queue;if(W=re.dispatch,sr!==null&&(Y=sr.get(re),Y!==void 0)){sr.delete(re),re=jn.memoizedState;do re=P(re,Y.action),Y=Y.next;while(Y!==null);return jn.memoizedState=re,[re,W]}return[jn.memoizedState,W]}return P=P===za?typeof W=="function"?W():W:Y!==void 0?Y(W):W,jn.memoizedState=P,P=jn.queue={last:null,dispatch:null},P=P.dispatch=Hr.bind(null,to,P),[jn.memoizedState,P]}function ln(P,W){if(to=no(),jn=Uo(),W=W===void 0?null:W,jn!==null){var Y=jn.memoizedState;if(Y!==null&&W!==null){var re=Y[1];e:if(re===null)re=!1;else{for(var Ne=0;Ne<re.length&&Ne<W.length;Ne++)if(!Yu(W[Ne],re[Ne])){re=!1;break e}re=!0}if(re)return Y[0]}}return P=P(),jn.memoizedState=[P,W],P}function Hr(P,W,Y){if(25<=gi)throw Error(e(301));if(P===to)if(Ct=!0,P={action:Y,next:null},sr===null&&(sr=new Map),Y=sr.get(W),Y===void 0)sr.set(W,P);else{for(W=Y;W.next!==null;)W=W.next;W.next=P}}function jl(){throw Error(e(394))}function is(){}var ma={readContext:function(P){return P._currentValue},useContext:function(P){return no(),P._currentValue},useMemo:ln,useReducer:Hn,useRef:function(P){to=no(),jn=Uo();var W=jn.memoizedState;return W===null?(P={current:P},jn.memoizedState=P):W},useState:function(P){return Hn(za,P)},useInsertionEffect:is,useLayoutEffect:function(){},useCallback:function(P,W){return ln(function(){return P},W)},useImperativeHandle:is,useEffect:is,useDebugValue:is,useDeferredValue:function(P){return no(),P},useTransition:function(){return no(),[!1,jl]},useId:function(){var P=rs.treeContext,W=P.overflow;P=P.id,P=(P&~(1<<32-Co(P)-1)).toString(32)+W;var Y=va;if(Y===null)throw Error(e(404));return W=pi++,P=":"+Y.idPrefix+"R"+P,0<W&&(P+="H"+W.toString(32)),P+":"},useMutableSource:function(P,W){return no(),W(P._source)},useSyncExternalStore:function(P,W,Y){if(Y===void 0)throw Error(e(407));return Y()}},va=null,Zr=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function jo(P){return console.error(P),null}function Io(){}function wo(P,W,Y,re,Ne,De,Ke,et,$t){var un=[],Zt=new Set;return W={destination:null,responseState:W,progressiveChunkSize:re===void 0?12800:re,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Zt,pingedTasks:un,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Ne===void 0?jo:Ne,onAllReady:De===void 0?Io:De,onShellReady:Ke===void 0?Io:Ke,onShellError:et===void 0?Io:et,onFatalError:$t===void 0?Io:$t},Y=js(W,0,null,Y,!1,!1),Y.parentFlushed=!0,P=Wc(W,P,null,Y,Zt,mt,null,tr),un.push(P),W}function Wc(P,W,Y,re,Ne,De,Ke,et){P.allPendingTasks++,Y===null?P.pendingRootTasks++:Y.pendingTasks++;var $t={node:W,ping:function(){var un=P.pingedTasks;un.push($t),un.length===1&&Go(P)},blockedBoundary:Y,blockedSegment:re,abortSet:Ne,legacyContext:De,context:Ke,treeContext:et};return Ne.add($t),$t}function js(P,W,Y,re,Ne,De){return{status:0,id:-1,index:W,parentFlushed:!1,chunks:[],children:[],formatContext:re,boundary:Y,lastPushedText:Ne,textEmbedded:De}}function os(P,W){if(P=P.onError(W),P!=null&&typeof P!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof P+'" instead');return P}function Vo(P,W){var Y=P.onShellError;Y(W),Y=P.onFatalError,Y(W),P.destination!==null?(P.status=2,h(P.destination,W)):(P.status=1,P.fatalError=W)}function Vs(P,W,Y,re,Ne){for(to={},rs=W,pi=0,P=Y(re,Ne);Ct;)Ct=!1,pi=0,gi+=1,jn=null,P=Y(re,Ne);return Us(),P}function zc(P,W,Y,re){var Ne=Y.render(),De=re.childContextTypes;if(De!=null){var Ke=W.legacyContext;if(typeof Y.getChildContext!="function")re=Ke;else{Y=Y.getChildContext();for(var et in Y)if(!(et in De))throw Error(e(108,dt(re)||"Unknown",et));re=vn({},Ke,Y)}W.legacyContext=re,Xr(P,W,Ne),W.legacyContext=Ke}else Xr(P,W,Ne)}function Ha(P,W){if(P&&P.defaultProps){W=vn({},W),P=P.defaultProps;for(var Y in P)W[Y]===void 0&&(W[Y]=P[Y]);return W}return W}function Hc(P,W,Y,re,Ne){if(typeof Y=="function")if(Y.prototype&&Y.prototype.isReactComponent){Ne=Kt(Y,W.legacyContext);var De=Y.contextType;De=new Y(re,typeof De=="object"&&De!==null?De._currentValue:Ne),ri(De,Y,re,Ne),zc(P,W,De,Y)}else{De=Kt(Y,W.legacyContext),Ne=Vs(P,W,Y,re,De);var Ke=pi!==0;if(typeof Ne=="object"&&Ne!==null&&typeof Ne.render=="function"&&Ne.$$typeof===void 0)ri(Ne,Y,re,De),zc(P,W,Ne,Y);else if(Ke){re=W.treeContext,W.treeContext=zr(re,1,0);try{Xr(P,W,Ne)}finally{W.treeContext=re}}else Xr(P,W,Ne)}else if(typeof Y=="string"){switch(Ne=W.blockedSegment,De=mn(Ne.chunks,Y,re,P.responseState,Ne.formatContext),Ne.lastPushedText=!1,Ke=Ne.formatContext,Ne.formatContext=H(Ke,Y,re),Zc(P,W,De),Ne.formatContext=Ke,Y){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Ne.chunks.push(Vn,l(Y),q)}Ne.lastPushedText=!1}else{switch(Y){case Oe:case ie:case Wr:case At:case yn:Xr(P,W,re.children);return;case on:Xr(P,W,re.children);return;case Q:throw Error(e(343));case kt:e:{Y=W.blockedBoundary,Ne=W.blockedSegment,De=re.fallback,re=re.children,Ke=new Set;var et={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:Ke,errorDigest:null},$t=js(P,Ne.chunks.length,et,Ne.formatContext,!1,!1);Ne.children.push($t),Ne.lastPushedText=!1;var un=js(P,0,null,Ne.formatContext,!1,!1);un.parentFlushed=!0,W.blockedBoundary=et,W.blockedSegment=un;try{if(Zc(P,W,re),un.lastPushedText&&un.textEmbedded&&un.chunks.push(ee),un.status=1,Za(et,un),et.pendingTasks===0)break e}catch(Zt){un.status=4,et.forceClientRender=!0,et.errorDigest=os(P,Zt)}finally{W.blockedBoundary=Y,W.blockedSegment=Ne}W=Wc(P,De,Y,$t,Ke,W.legacyContext,W.context,W.treeContext),P.pingedTasks.push(W)}return}if(typeof Y=="object"&&Y!==null)switch(Y.$$typeof){case eo:if(re=Vs(P,W,Y.render,re,Ne),pi!==0){Y=W.treeContext,W.treeContext=zr(Y,1,0);try{Xr(P,W,re)}finally{W.treeContext=Y}}else Xr(P,W,re);return;case M:Y=Y.type,re=Ha(Y,re),Hc(P,W,Y,re,Ne);return;case Lo:if(Ne=re.children,Y=Y._context,re=re.value,De=Y._currentValue,Y._currentValue=re,Ke=an,an=re={parent:Ke,depth:Ke===null?0:Ke.depth+1,context:Y,parentValue:De,value:re},W.context=re,Xr(P,W,Ne),P=an,P===null)throw Error(e(403));re=P.parentValue,P.context._currentValue=re===Te?P.context._defaultValue:re,P=an=P.parent,W.context=P;return;case Ji:re=re.children,re=re(Y._currentValue),Xr(P,W,re);return;case G:Ne=Y._init,Y=Ne(Y._payload),re=Ha(Y,re),Hc(P,W,Y,re,void 0);return}throw Error(e(130,Y==null?Y:typeof Y,""))}}function Xr(P,W,Y){if(W.node=Y,typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case or:Hc(P,W,Y.type,Y.props,Y.ref);return;case hi:throw Error(e(257));case G:var re=Y._init;Y=re(Y._payload),Xr(P,W,Y);return}if(F(Y)){Er(P,W,Y);return}if(Y===null||typeof Y!="object"?re=null:(re=ze&&Y[ze]||Y["@@iterator"],re=typeof re=="function"?re:null),re&&(re=re.call(Y))){if(Y=re.next(),!Y.done){var Ne=[];do Ne.push(Y.value),Y=re.next();while(!Y.done);Er(P,W,Ne)}return}throw P=Object.prototype.toString.call(Y),Error(e(31,P==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":P))}typeof Y=="string"?(re=W.blockedSegment,re.lastPushedText=ae(W.blockedSegment.chunks,Y,P.responseState,re.lastPushedText)):typeof Y=="number"&&(re=W.blockedSegment,re.lastPushedText=ae(W.blockedSegment.chunks,""+Y,P.responseState,re.lastPushedText))}function Er(P,W,Y){for(var re=Y.length,Ne=0;Ne<re;Ne++){var De=W.treeContext;W.treeContext=zr(De,re,Ne);try{Zc(P,W,Y[Ne])}finally{W.treeContext=De}}}function Zc(P,W,Y){var re=W.blockedSegment.formatContext,Ne=W.legacyContext,De=W.context;try{return Xr(P,W,Y)}catch($t){if(Us(),typeof $t=="object"&&$t!==null&&typeof $t.then=="function"){Y=$t;var Ke=W.blockedSegment,et=js(P,Ke.chunks.length,null,Ke.formatContext,Ke.lastPushedText,!0);Ke.children.push(et),Ke.lastPushedText=!1,P=Wc(P,W.node,W.blockedBoundary,et,W.abortSet,W.legacyContext,W.context,W.treeContext).ping,Y.then(P,P),W.blockedSegment.formatContext=re,W.legacyContext=Ne,W.context=De,ki(De)}else throw W.blockedSegment.formatContext=re,W.legacyContext=Ne,W.context=De,ki(De),$t}}function Qu(P){var W=P.blockedBoundary;P=P.blockedSegment,P.status=3,Xa(this,W,P)}function Vl(P,W,Y){var re=P.blockedBoundary;P.blockedSegment.status=3,re===null?(W.allPendingTasks--,W.status!==2&&(W.status=2,W.destination!==null&&W.destination.close())):(re.pendingTasks--,re.forceClientRender||(re.forceClientRender=!0,P=Y===void 0?Error(e(432)):Y,re.errorDigest=W.onError(P),re.parentFlushed&&W.clientRenderedBoundaries.push(re)),re.fallbackAbortableTasks.forEach(function(Ne){return Vl(Ne,W,Y)}),re.fallbackAbortableTasks.clear(),W.allPendingTasks--,W.allPendingTasks===0&&(re=W.onAllReady,re()))}function Za(P,W){if(W.chunks.length===0&&W.children.length===1&&W.children[0].boundary===null){var Y=W.children[0];Y.id=W.id,Y.parentFlushed=!0,Y.status===1&&Za(P,Y)}else P.completedSegments.push(W)}function Xa(P,W,Y){if(W===null){if(Y.parentFlushed){if(P.completedRootSegment!==null)throw Error(e(389));P.completedRootSegment=Y}P.pendingRootTasks--,P.pendingRootTasks===0&&(P.onShellError=Io,W=P.onShellReady,W())}else W.pendingTasks--,W.forceClientRender||(W.pendingTasks===0?(Y.parentFlushed&&Y.status===1&&Za(W,Y),W.parentFlushed&&P.completedBoundaries.push(W),W.fallbackAbortableTasks.forEach(Qu,P),W.fallbackAbortableTasks.clear()):Y.parentFlushed&&Y.status===1&&(Za(W,Y),W.completedSegments.length===1&&W.parentFlushed&&P.partialBoundaries.push(W)));P.allPendingTasks--,P.allPendingTasks===0&&(P=P.onAllReady,P())}function Go(P){if(P.status!==2){var W=an,Y=Zr.current;Zr.current=ma;var re=va;va=P.responseState;try{var Ne=P.pingedTasks,De;for(De=0;De<Ne.length;De++){var Ke=Ne[De],et=P,$t=Ke.blockedSegment;if($t.status===0){ki(Ke.context);try{Xr(et,Ke,Ke.node),$t.lastPushedText&&$t.textEmbedded&&$t.chunks.push(ee),Ke.abortSet.delete(Ke),$t.status=1,Xa(et,Ke.blockedBoundary,$t)}catch(Ti){if(Us(),typeof Ti=="object"&&Ti!==null&&typeof Ti.then=="function"){var un=Ke.ping;Ti.then(un,un)}else{Ke.abortSet.delete(Ke),$t.status=4;var Zt=Ke.blockedBoundary,Gn=Ti,Ir=os(et,Gn);if(Zt===null?Vo(et,Gn):(Zt.pendingTasks--,Zt.forceClientRender||(Zt.forceClientRender=!0,Zt.errorDigest=Ir,Zt.parentFlushed&&et.clientRenderedBoundaries.push(Zt))),et.allPendingTasks--,et.allPendingTasks===0){var Ei=et.onAllReady;Ei()}}}finally{}}}Ne.splice(0,De),P.destination!==null&&$c(P,P.destination)}catch(Ti){os(P,Ti),Vo(P,Ti)}finally{va=re,Zr.current=Y,Y===ma&&ki(W)}}}function Gs(P,W,Y){switch(Y.parentFlushed=!0,Y.status){case 0:var re=Y.id=P.nextSegmentId++;return Y.lastPushedText=!1,Y.textEmbedded=!1,P=P.responseState,i(W,N),i(W,P.placeholderPrefix),P=l(re.toString(16)),i(W,P),o(W,L);case 1:Y.status=2;var Ne=!0;re=Y.chunks;var De=0;Y=Y.children;for(var Ke=0;Ke<Y.length;Ke++){for(Ne=Y[Ke];De<Ne.index;De++)i(W,re[De]);Ne=$a(P,W,Ne)}for(;De<re.length-1;De++)i(W,re[De]);return De<re.length&&(Ne=o(W,re[De])),Ne;default:throw Error(e(390))}}function $a(P,W,Y){var re=Y.boundary;if(re===null)return Gs(P,W,Y);if(re.parentFlushed=!0,re.forceClientRender)re=re.errorDigest,o(W,Ve),i(W,hn),re&&(i(W,xn),i(W,l(D(re))),i(W,pn)),o(W,dn),Gs(P,W,Y);else if(0<re.pendingTasks){re.rootSegmentID=P.nextSegmentId++,0<re.completedSegments.length&&P.partialBoundaries.push(re);var Ne=P.responseState,De=Ne.nextSuspenseID++;Ne=d(Ne.boundaryPrefix+De.toString(16)),re=re.id=Ne,Ln(W,P.responseState,re),Gs(P,W,Y)}else if(re.byteSize>P.progressiveChunkSize)re.rootSegmentID=P.nextSegmentId++,P.completedBoundaries.push(re),Ln(W,P.responseState,re.id),Gs(P,W,Y);else{if(o(W,ne),Y=re.completedSegments,Y.length!==1)throw Error(e(391));$a(P,W,Y[0])}return o(W,Lt)}function Gl(P,W,Y){return Le(W,P.responseState,Y.formatContext,Y.id),$a(P,W,Y),ut(W,Y.formatContext)}function Xc(P,W,Y){for(var re=Y.completedSegments,Ne=0;Ne<re.length;Ne++)br(P,W,Y,re[Ne]);if(re.length=0,P=P.responseState,re=Y.id,Y=Y.rootSegmentID,i(W,P.startInlineScript),P.sentCompleteBoundaryFunction?i(W,It):(P.sentCompleteBoundaryFunction=!0,i(W,Ze)),re===null)throw Error(e(395));return Y=l(Y.toString(16)),i(W,re),i(W,In),i(W,P.segmentPrefix),i(W,Y),o(W,Ft)}function br(P,W,Y,re){if(re.status===2)return!0;var Ne=re.id;if(Ne===-1){if((re.id=Y.rootSegmentID)===-1)throw Error(e(392));return Gl(P,W,re)}return Gl(P,W,re),P=P.responseState,i(W,P.startInlineScript),P.sentCompleteSegmentFunction?i(W,bn):(P.sentCompleteSegmentFunction=!0,i(W,He)),i(W,P.segmentPrefix),Ne=l(Ne.toString(16)),i(W,Ne),i(W,st),i(W,P.placeholderPrefix),i(W,Ne),o(W,de)}function $c(P,W){t=new Uint8Array(512),r=0;try{var Y=P.completedRootSegment;if(Y!==null&&P.pendingRootTasks===0){$a(P,W,Y),P.completedRootSegment=null;var re=P.responseState.bootstrapChunks;for(Y=0;Y<re.length-1;Y++)i(W,re[Y]);Y<re.length&&o(W,re[Y])}var Ne=P.clientRenderedBoundaries,De;for(De=0;De<Ne.length;De++){var Ke=Ne[De];re=W;var et=P.responseState,$t=Ke.id,un=Ke.errorDigest,Zt=Ke.errorMessage,Gn=Ke.errorComponentStack;if(i(re,et.startInlineScript),et.sentClientRenderFunction?i(re,zt):(et.sentClientRenderFunction=!0,i(re,wt)),$t===null)throw Error(e(395));i(re,$t),i(re,Jn),(un||Zt||Gn)&&(i(re,ir),i(re,l(nn(un||"")))),(Zt||Gn)&&(i(re,ir),i(re,l(nn(Zt||"")))),Gn&&(i(re,ir),i(re,l(nn(Gn)))),o(re,er)}Ne.splice(0,De);var Ir=P.completedBoundaries;for(De=0;De<Ir.length;De++)Xc(P,W,Ir[De]);Ir.splice(0,De),c(W),t=new Uint8Array(512),r=0;var Ei=P.partialBoundaries;for(De=0;De<Ei.length;De++){var Ti=Ei[De];e:{Ne=P,Ke=W;var ro=Ti.completedSegments;for(et=0;et<ro.length;et++)if(!br(Ne,Ke,Ti,ro[et])){et++,ro.splice(0,et);var Ka=!1;break e}ro.splice(0,et),Ka=!0}if(!Ka){P.destination=null,De++,Ei.splice(0,De);return}}Ei.splice(0,De);var Bi=P.completedBoundaries;for(De=0;De<Bi.length;De++)Xc(P,W,Bi[De]);Bi.splice(0,De)}finally{c(W),P.allPendingTasks===0&&P.pingedTasks.length===0&&P.clientRenderedBoundaries.length===0&&P.completedBoundaries.length===0&&W.close()}}function So(P,W){try{var Y=P.abortableTasks;Y.forEach(function(re){return Vl(re,P,W)}),Y.clear(),P.destination!==null&&$c(P,P.destination)}catch(re){os(P,re),Vo(P,re)}}return Vh.renderToReadableStream=function(P,W){return new Promise(function(Y,re){var Ne,De,Ke=new Promise(function(Zt,Gn){De=Zt,Ne=Gn}),et=wo(P,xe(W?W.identifierPrefix:void 0,W?W.nonce:void 0,W?W.bootstrapScriptContent:void 0,W?W.bootstrapScripts:void 0,W?W.bootstrapModules:void 0),ke(W?W.namespaceURI:void 0),W?W.progressiveChunkSize:void 0,W?W.onError:void 0,De,function(){var Zt=new ReadableStream({type:"bytes",pull:function(Gn){if(et.status===1)et.status=2,h(Gn,et.fatalError);else if(et.status!==2&&et.destination===null){et.destination=Gn;try{$c(et,Gn)}catch(Ir){os(et,Ir),Vo(et,Ir)}}},cancel:function(){So(et)}},{highWaterMark:0});Zt.allReady=Ke,Y(Zt)},function(Zt){Ke.catch(function(){}),re(Zt)},Ne);if(W&&W.signal){var $t=W.signal,un=function(){So(et,$t.reason),$t.removeEventListener("abort",un)};$t.addEventListener("abort",un)}Go(et)})},Vh.version="18.3.1",Vh}var Xw;function $L(){if(Xw)return dc;Xw=1;var n,e;return n=ZL(),e=XL(),dc.version=n.version,dc.renderToString=n.renderToString,dc.renderToStaticMarkup=n.renderToStaticMarkup,dc.renderToNodeStream=n.renderToNodeStream,dc.renderToStaticNodeStream=n.renderToStaticNodeStream,dc.renderToReadableStream=e.renderToReadableStream,dc}var KL=$L();const qL=Nc(KL);/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:YE,setPrototypeOf:$w,isFrozen:YL,getPrototypeOf:QL,getOwnPropertyDescriptor:JL}=Object;let{freeze:qi,seal:ts,create:QE}=Object,{apply:Cy,construct:xy}=typeof Reflect<"u"&&Reflect;qi||(qi=function(e){return e});ts||(ts=function(e){return e});Cy||(Cy=function(e,t,r){return e.apply(t,r)});xy||(xy=function(e,t){return new e(...t)});const Gh=Yi(Array.prototype.forEach),e8=Yi(Array.prototype.lastIndexOf),Kw=Yi(Array.prototype.pop),Td=Yi(Array.prototype.push),t8=Yi(Array.prototype.splice),z0=Yi(String.prototype.toLowerCase),rv=Yi(String.prototype.toString),qw=Yi(String.prototype.match),_d=Yi(String.prototype.replace),n8=Yi(String.prototype.indexOf),r8=Yi(String.prototype.trim),ps=Yi(Object.prototype.hasOwnProperty),ji=Yi(RegExp.prototype.test),Rd=i8(TypeError);function Yi(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return Cy(n,e,r)}}function i8(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return xy(n,t)}}function An(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:z0;$w&&$w(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=t(i);o!==i&&(YL(e)||(e[r]=o),i=o)}n[i]=!0}return n}function o8(n){for(let e=0;e<n.length;e++)ps(n,e)||(n[e]=null);return n}function ka(n){const e=QE(null);for(const[t,r]of YE(n))ps(n,t)&&(Array.isArray(r)?e[t]=o8(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=ka(r):e[t]=r);return e}function Dd(n,e){for(;n!==null;){const r=JL(n,e);if(r){if(r.get)return Yi(r.get);if(typeof r.value=="function")return Yi(r.value)}n=QL(n)}function t(){return null}return t}const Yw=qi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),iv=qi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ov=qi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),s8=qi(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),sv=qi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),a8=qi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Qw=qi(["#text"]),Jw=qi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),av=qi(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),eS=qi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Wh=qi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),c8=ts(/\{\{[\w\W]*|[\w\W]*\}\}/gm),l8=ts(/<%[\w\W]*|[\w\W]*%>/gm),u8=ts(/\$\{[\w\W]*/gm),d8=ts(/^data-[\-\w.\u00B7-\uFFFF]+$/),f8=ts(/^aria-[\-\w]+$/),JE=ts(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),h8=ts(/^(?:\w+script|data):/i),p8=ts(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),eT=ts(/^html$/i),g8=ts(/^[a-z][.\w]*(-[.\w]+)+$/i);var tS=Object.freeze({__proto__:null,ARIA_ATTR:f8,ATTR_WHITESPACE:p8,CUSTOM_ELEMENT:g8,DATA_ATTR:d8,DOCTYPE_NAME:eT,ERB_EXPR:l8,IS_ALLOWED_URI:JE,IS_SCRIPT_OR_DATA:h8,MUSTACHE_EXPR:c8,TMPLIT_EXPR:u8});const Pd={element:1,text:3,progressingInstruction:7,comment:8,document:9},m8=function(){return typeof window>"u"?null:window},v8=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},nS=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function tT(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m8();const e=st=>tT(st);if(e.version="3.2.6",e.removed=[],!n||!n.document||n.document.nodeType!==Pd.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:c,Node:s,Element:l,NodeFilter:d,NamedNodeMap:h=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:p,DOMParser:g,trustedTypes:y}=n,C=l.prototype,x=Dd(C,"cloneNode"),w=Dd(C,"remove"),S=Dd(C,"nextSibling"),E=Dd(C,"childNodes"),R=Dd(C,"parentNode");if(typeof c=="function"){const st=t.createElement("template");st.content&&st.content.ownerDocument&&(t=st.content.ownerDocument)}let k,A="";const{implementation:_,createNodeIterator:D,createDocumentFragment:j,getElementsByTagName:Z}=t,{importNode:F}=r;let V=nS();e.isSupported=typeof YE=="function"&&typeof R=="function"&&_&&_.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:X,ERB_EXPR:te,TMPLIT_EXPR:pe,DATA_ATTR:ve,ARIA_ATTR:Ie,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:xe,CUSTOM_ELEMENT:Ae}=tS;let{IS_ALLOWED_URI:ke}=tS,H=null;const ee=An({},[...Yw,...iv,...ov,...sv,...Qw]);let ae=null;const ye=An({},[...Jw,...av,...eS,...Wh]);let Ee=Object.seal(QE(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),_e=null,Je=null,me=!0,it=!0,Tt=!1,Xt=!0,Et=!1,St=!0,Pt=!1,at=!1,lt=!1,Gt=!1,Vt=!1,Dt=!1,Ht=!0,sn=!1;const ct="user-content-";let ce=!0,rn=!1,mn={},Vn=null;const q=An({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let N=null;const L=An({},["audio","video","img","source","image","track"]);let ne=null;const Ce=An({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Pe="http://www.w3.org/1998/Math/MathML",Ve="http://www.w3.org/2000/svg",Lt="http://www.w3.org/1999/xhtml";let hn=Lt,pn=!1,xn=null;const dn=An({},[Pe,Ve,Lt],rv);let Ln=An({},["mi","mo","mn","ms","mtext"]),kr=An({},["annotation-xml"]);const yr=An({},["title","style","font","a","script"]);let Qt=null;const ei=["application/xhtml+xml","text/html"],Qe="text/html";let Tn=null,Wt=null;const hr=t.createElement("form"),Qn=function(de){return de instanceof RegExp||de instanceof Function},ti=function(){let de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Wt&&Wt===de)){if((!de||typeof de!="object")&&(de={}),de=ka(de),Qt=ei.indexOf(de.PARSER_MEDIA_TYPE)===-1?Qe:de.PARSER_MEDIA_TYPE,Tn=Qt==="application/xhtml+xml"?rv:z0,H=ps(de,"ALLOWED_TAGS")?An({},de.ALLOWED_TAGS,Tn):ee,ae=ps(de,"ALLOWED_ATTR")?An({},de.ALLOWED_ATTR,Tn):ye,xn=ps(de,"ALLOWED_NAMESPACES")?An({},de.ALLOWED_NAMESPACES,rv):dn,ne=ps(de,"ADD_URI_SAFE_ATTR")?An(ka(Ce),de.ADD_URI_SAFE_ATTR,Tn):Ce,N=ps(de,"ADD_DATA_URI_TAGS")?An(ka(L),de.ADD_DATA_URI_TAGS,Tn):L,Vn=ps(de,"FORBID_CONTENTS")?An({},de.FORBID_CONTENTS,Tn):q,_e=ps(de,"FORBID_TAGS")?An({},de.FORBID_TAGS,Tn):ka({}),Je=ps(de,"FORBID_ATTR")?An({},de.FORBID_ATTR,Tn):ka({}),mn=ps(de,"USE_PROFILES")?de.USE_PROFILES:!1,me=de.ALLOW_ARIA_ATTR!==!1,it=de.ALLOW_DATA_ATTR!==!1,Tt=de.ALLOW_UNKNOWN_PROTOCOLS||!1,Xt=de.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Et=de.SAFE_FOR_TEMPLATES||!1,St=de.SAFE_FOR_XML!==!1,Pt=de.WHOLE_DOCUMENT||!1,Gt=de.RETURN_DOM||!1,Vt=de.RETURN_DOM_FRAGMENT||!1,Dt=de.RETURN_TRUSTED_TYPE||!1,lt=de.FORCE_BODY||!1,Ht=de.SANITIZE_DOM!==!1,sn=de.SANITIZE_NAMED_PROPS||!1,ce=de.KEEP_CONTENT!==!1,rn=de.IN_PLACE||!1,ke=de.ALLOWED_URI_REGEXP||JE,hn=de.NAMESPACE||Lt,Ln=de.MATHML_TEXT_INTEGRATION_POINTS||Ln,kr=de.HTML_INTEGRATION_POINTS||kr,Ee=de.CUSTOM_ELEMENT_HANDLING||{},de.CUSTOM_ELEMENT_HANDLING&&Qn(de.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ee.tagNameCheck=de.CUSTOM_ELEMENT_HANDLING.tagNameCheck),de.CUSTOM_ELEMENT_HANDLING&&Qn(de.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ee.attributeNameCheck=de.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),de.CUSTOM_ELEMENT_HANDLING&&typeof de.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ee.allowCustomizedBuiltInElements=de.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Et&&(it=!1),Vt&&(Gt=!0),mn&&(H=An({},Qw),ae=[],mn.html===!0&&(An(H,Yw),An(ae,Jw)),mn.svg===!0&&(An(H,iv),An(ae,av),An(ae,Wh)),mn.svgFilters===!0&&(An(H,ov),An(ae,av),An(ae,Wh)),mn.mathMl===!0&&(An(H,sv),An(ae,eS),An(ae,Wh))),de.ADD_TAGS&&(H===ee&&(H=ka(H)),An(H,de.ADD_TAGS,Tn)),de.ADD_ATTR&&(ae===ye&&(ae=ka(ae)),An(ae,de.ADD_ATTR,Tn)),de.ADD_URI_SAFE_ATTR&&An(ne,de.ADD_URI_SAFE_ATTR,Tn),de.FORBID_CONTENTS&&(Vn===q&&(Vn=ka(Vn)),An(Vn,de.FORBID_CONTENTS,Tn)),ce&&(H["#text"]=!0),Pt&&An(H,["html","head","body"]),H.table&&(An(H,["tbody"]),delete _e.tbody),de.TRUSTED_TYPES_POLICY){if(typeof de.TRUSTED_TYPES_POLICY.createHTML!="function")throw Rd('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof de.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Rd('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=de.TRUSTED_TYPES_POLICY,A=k.createHTML("")}else k===void 0&&(k=v8(y,i)),k!==null&&typeof A=="string"&&(A=k.createHTML(""));qi&&qi(de),Wt=de}},Lr=An({},[...iv,...ov,...s8]),ge=An({},[...sv,...a8]),we=function(de){let Ze=R(de);(!Ze||!Ze.tagName)&&(Ze={namespaceURI:hn,tagName:"template"});const It=z0(de.tagName),In=z0(Ze.tagName);return xn[de.namespaceURI]?de.namespaceURI===Ve?Ze.namespaceURI===Lt?It==="svg":Ze.namespaceURI===Pe?It==="svg"&&(In==="annotation-xml"||Ln[In]):!!Lr[It]:de.namespaceURI===Pe?Ze.namespaceURI===Lt?It==="math":Ze.namespaceURI===Ve?It==="math"&&kr[In]:!!ge[It]:de.namespaceURI===Lt?Ze.namespaceURI===Ve&&!kr[In]||Ze.namespaceURI===Pe&&!Ln[In]?!1:!ge[It]&&(yr[It]||!Lr[It]):!!(Qt==="application/xhtml+xml"&&xn[de.namespaceURI]):!1},J=function(de){Td(e.removed,{element:de});try{R(de).removeChild(de)}catch{w(de)}},Ge=function(de,Ze){try{Td(e.removed,{attribute:Ze.getAttributeNode(de),from:Ze})}catch{Td(e.removed,{attribute:null,from:Ze})}if(Ze.removeAttribute(de),de==="is")if(Gt||Vt)try{J(Ze)}catch{}else try{Ze.setAttribute(de,"")}catch{}},rt=function(de){let Ze=null,It=null;if(lt)de="<remove></remove>"+de;else{const wt=qw(de,/^[\r\n\t ]+/);It=wt&&wt[0]}Qt==="application/xhtml+xml"&&hn===Lt&&(de='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+de+"</body></html>");const In=k?k.createHTML(de):de;if(hn===Lt)try{Ze=new g().parseFromString(In,Qt)}catch{}if(!Ze||!Ze.documentElement){Ze=_.createDocument(hn,"template",null);try{Ze.documentElement.innerHTML=pn?A:In}catch{}}const Ft=Ze.body||Ze.documentElement;return de&&It&&Ft.insertBefore(t.createTextNode(It),Ft.childNodes[0]||null),hn===Lt?Z.call(Ze,Pt?"html":"body")[0]:Pt?Ze.documentElement:Ft},_t=function(de){return D.call(de.ownerDocument||de,de,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},Ot=function(de){return de instanceof p&&(typeof de.nodeName!="string"||typeof de.textContent!="string"||typeof de.removeChild!="function"||!(de.attributes instanceof h)||typeof de.removeAttribute!="function"||typeof de.setAttribute!="function"||typeof de.namespaceURI!="string"||typeof de.insertBefore!="function"||typeof de.hasChildNodes!="function")},pt=function(de){return typeof s=="function"&&de instanceof s};function gt(st,de,Ze){Gh(st,It=>{It.call(e,de,Ze,Wt)})}const bt=function(de){let Ze=null;if(gt(V.beforeSanitizeElements,de,null),Ot(de))return J(de),!0;const It=Tn(de.nodeName);if(gt(V.uponSanitizeElement,de,{tagName:It,allowedTags:H}),St&&de.hasChildNodes()&&!pt(de.firstElementChild)&&ji(/<[/\w!]/g,de.innerHTML)&&ji(/<[/\w!]/g,de.textContent)||de.nodeType===Pd.progressingInstruction||St&&de.nodeType===Pd.comment&&ji(/<[/\w]/g,de.data))return J(de),!0;if(!H[It]||_e[It]){if(!_e[It]&&ut(It)&&(Ee.tagNameCheck instanceof RegExp&&ji(Ee.tagNameCheck,It)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(It)))return!1;if(ce&&!Vn[It]){const In=R(de)||de.parentNode,Ft=E(de)||de.childNodes;if(Ft&&In){const wt=Ft.length;for(let zt=wt-1;zt>=0;--zt){const Jn=x(Ft[zt],!0);Jn.__removalCount=(de.__removalCount||0)+1,In.insertBefore(Jn,S(de))}}}return J(de),!0}return de instanceof l&&!we(de)||(It==="noscript"||It==="noembed"||It==="noframes")&&ji(/<\/no(script|embed|frames)/i,de.innerHTML)?(J(de),!0):(Et&&de.nodeType===Pd.text&&(Ze=de.textContent,Gh([X,te,pe],In=>{Ze=_d(Ze,In," ")}),de.textContent!==Ze&&(Td(e.removed,{element:de.cloneNode()}),de.textContent=Ze)),gt(V.afterSanitizeElements,de,null),!1)},Le=function(de,Ze,It){if(Ht&&(Ze==="id"||Ze==="name")&&(It in t||It in hr))return!1;if(!(it&&!Je[Ze]&&ji(ve,Ze))){if(!(me&&ji(Ie,Ze))){if(!ae[Ze]||Je[Ze]){if(!(ut(de)&&(Ee.tagNameCheck instanceof RegExp&&ji(Ee.tagNameCheck,de)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(de))&&(Ee.attributeNameCheck instanceof RegExp&&ji(Ee.attributeNameCheck,Ze)||Ee.attributeNameCheck instanceof Function&&Ee.attributeNameCheck(Ze))||Ze==="is"&&Ee.allowCustomizedBuiltInElements&&(Ee.tagNameCheck instanceof RegExp&&ji(Ee.tagNameCheck,It)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(It))))return!1}else if(!ne[Ze]){if(!ji(ke,_d(It,xe,""))){if(!((Ze==="src"||Ze==="xlink:href"||Ze==="href")&&de!=="script"&&n8(It,"data:")===0&&N[de])){if(!(Tt&&!ji(Re,_d(It,xe,"")))){if(It)return!1}}}}}}return!0},ut=function(de){return de!=="annotation-xml"&&qw(de,Ae)},He=function(de){gt(V.beforeSanitizeAttributes,de,null);const{attributes:Ze}=de;if(!Ze||Ot(de))return;const It={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ae,forceKeepAttr:void 0};let In=Ze.length;for(;In--;){const Ft=Ze[In],{name:wt,namespaceURI:zt,value:Jn}=Ft,er=Tn(wt),ir=Jn;let Fn=wt==="value"?ir:r8(ir);if(It.attrName=er,It.attrValue=Fn,It.keepAttr=!0,It.forceKeepAttr=void 0,gt(V.uponSanitizeAttribute,de,It),Fn=It.attrValue,sn&&(er==="id"||er==="name")&&(Ge(wt,de),Fn=ct+Fn),St&&ji(/((--!?|])>)|<\/(style|title)/i,Fn)){Ge(wt,de);continue}if(It.forceKeepAttr)continue;if(!It.keepAttr){Ge(wt,de);continue}if(!Xt&&ji(/\/>/i,Fn)){Ge(wt,de);continue}Et&&Gh([X,te,pe],vn=>{Fn=_d(Fn,vn," ")});const nn=Tn(de.nodeName);if(!Le(nn,er,Fn)){Ge(wt,de);continue}if(k&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!zt)switch(y.getAttributeType(nn,er)){case"TrustedHTML":{Fn=k.createHTML(Fn);break}case"TrustedScriptURL":{Fn=k.createScriptURL(Fn);break}}if(Fn!==ir)try{zt?de.setAttributeNS(zt,wt,Fn):de.setAttribute(wt,Fn),Ot(de)?J(de):Kw(e.removed)}catch{Ge(wt,de)}}gt(V.afterSanitizeAttributes,de,null)},bn=function st(de){let Ze=null;const It=_t(de);for(gt(V.beforeSanitizeShadowDOM,de,null);Ze=It.nextNode();)gt(V.uponSanitizeShadowNode,Ze,null),bt(Ze),He(Ze),Ze.content instanceof o&&st(Ze.content);gt(V.afterSanitizeShadowDOM,de,null)};return e.sanitize=function(st){let de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ze=null,It=null,In=null,Ft=null;if(pn=!st,pn&&(st="<!-->"),typeof st!="string"&&!pt(st))if(typeof st.toString=="function"){if(st=st.toString(),typeof st!="string")throw Rd("dirty is not a string, aborting")}else throw Rd("toString is not a function");if(!e.isSupported)return st;if(at||ti(de),e.removed=[],typeof st=="string"&&(rn=!1),rn){if(st.nodeName){const Jn=Tn(st.nodeName);if(!H[Jn]||_e[Jn])throw Rd("root node is forbidden and cannot be sanitized in-place")}}else if(st instanceof s)Ze=rt("<!---->"),It=Ze.ownerDocument.importNode(st,!0),It.nodeType===Pd.element&&It.nodeName==="BODY"||It.nodeName==="HTML"?Ze=It:Ze.appendChild(It);else{if(!Gt&&!Et&&!Pt&&st.indexOf("<")===-1)return k&&Dt?k.createHTML(st):st;if(Ze=rt(st),!Ze)return Gt?null:Dt?A:""}Ze&&lt&&J(Ze.firstChild);const wt=_t(rn?st:Ze);for(;In=wt.nextNode();)bt(In),He(In),In.content instanceof o&&bn(In.content);if(rn)return st;if(Gt){if(Vt)for(Ft=j.call(Ze.ownerDocument);Ze.firstChild;)Ft.appendChild(Ze.firstChild);else Ft=Ze;return(ae.shadowroot||ae.shadowrootmode)&&(Ft=F.call(r,Ft,!0)),Ft}let zt=Pt?Ze.outerHTML:Ze.innerHTML;return Pt&&H["!doctype"]&&Ze.ownerDocument&&Ze.ownerDocument.doctype&&Ze.ownerDocument.doctype.name&&ji(eT,Ze.ownerDocument.doctype.name)&&(zt="<!DOCTYPE "+Ze.ownerDocument.doctype.name+`>
`+zt),Et&&Gh([X,te,pe],Jn=>{zt=_d(zt,Jn," ")}),k&&Dt?k.createHTML(zt):zt},e.setConfig=function(){let st=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ti(st),at=!0},e.clearConfig=function(){Wt=null,at=!1},e.isValidAttribute=function(st,de,Ze){Wt||ti({});const It=Tn(st),In=Tn(de);return Le(It,In,Ze)},e.addHook=function(st,de){typeof de=="function"&&Td(V[st],de)},e.removeHook=function(st,de){if(de!==void 0){const Ze=e8(V[st],de);return Ze===-1?void 0:t8(V[st],Ze,1)[0]}return Kw(V[st])},e.removeHooks=function(st){V[st]=[]},e.removeAllHooks=function(){V=nS()},e}var rS=tT();function y8(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])}return n}function by(n,e){return Array(e+1).join(n)}function C8(n){return n.replace(/^\n*/,"")}function x8(n){for(var e=n.length;e>0&&n[e-1]===`
`;)e--;return n.substring(0,e)}var b8=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function OC(n){return FC(n,b8)}var nT=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function rT(n){return FC(n,nT)}function I8(n){return oT(n,nT)}var iT=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function w8(n){return FC(n,iT)}function S8(n){return oT(n,iT)}function FC(n,e){return e.indexOf(n.nodeName)>=0}function oT(n,e){return n.getElementsByTagName&&e.some(function(t){return n.getElementsByTagName(t).length})}var Fi={};Fi.paragraph={filter:"p",replacement:function(n){return`

`+n+`

`}};Fi.lineBreak={filter:"br",replacement:function(n,e,t){return t.br+`
`}};Fi.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(n,e,t){var r=Number(e.nodeName.charAt(1));if(t.headingStyle==="setext"&&r<3){var i=by(r===1?"=":"-",n.length);return`

`+n+`
`+i+`

`}else return`

`+by("#",r)+" "+n+`

`}};Fi.blockquote={filter:"blockquote",replacement:function(n){return n=n.replace(/^\n+|\n+$/g,""),n=n.replace(/^/gm,"> "),`

`+n+`

`}};Fi.list={filter:["ul","ol"],replacement:function(n,e){var t=e.parentNode;return t.nodeName==="LI"&&t.lastElementChild===e?`
`+n:`

`+n+`

`}};Fi.listItem={filter:"li",replacement:function(n,e,t){n=n.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var r=t.bulletListMarker+"   ",i=e.parentNode;if(i.nodeName==="OL"){var o=i.getAttribute("start"),c=Array.prototype.indexOf.call(i.children,e);r=(o?Number(o)+c:c+1)+".  "}return r+n+(e.nextSibling&&!/\n$/.test(n)?`
`:"")}};Fi.indentedCodeBlock={filter:function(n,e){return e.codeBlockStyle==="indented"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,e,t){return`

    `+e.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};Fi.fencedCodeBlock={filter:function(n,e){return e.codeBlockStyle==="fenced"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,e,t){for(var r=e.firstChild.getAttribute("class")||"",i=(r.match(/language-(\S+)/)||[null,""])[1],o=e.firstChild.textContent,c=t.fence.charAt(0),s=3,l=new RegExp("^"+c+"{3,}","gm"),d;d=l.exec(o);)d[0].length>=s&&(s=d[0].length+1);var h=by(c,s);return`

`+h+i+`
`+o.replace(/\n$/,"")+`
`+h+`

`}};Fi.horizontalRule={filter:"hr",replacement:function(n,e,t){return`

`+t.hr+`

`}};Fi.inlineLink={filter:function(n,e){return e.linkStyle==="inlined"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,e){var t=e.getAttribute("href");t&&(t=t.replace(/([()])/g,"\\$1"));var r=xp(e.getAttribute("title"));return r&&(r=' "'+r.replace(/"/g,'\\"')+'"'),"["+n+"]("+t+r+")"}};Fi.referenceLink={filter:function(n,e){return e.linkStyle==="referenced"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,e,t){var r=e.getAttribute("href"),i=xp(e.getAttribute("title"));i&&(i=' "'+i+'"');var o,c;switch(t.linkReferenceStyle){case"collapsed":o="["+n+"][]",c="["+n+"]: "+r+i;break;case"shortcut":o="["+n+"]",c="["+n+"]: "+r+i;break;default:var s=this.references.length+1;o="["+n+"]["+s+"]",c="["+s+"]: "+r+i}return this.references.push(c),o},references:[],append:function(n){var e="";return this.references.length&&(e=`

`+this.references.join(`
`)+`

`,this.references=[]),e}};Fi.emphasis={filter:["em","i"],replacement:function(n,e,t){return n.trim()?t.emDelimiter+n+t.emDelimiter:""}};Fi.strong={filter:["strong","b"],replacement:function(n,e,t){return n.trim()?t.strongDelimiter+n+t.strongDelimiter:""}};Fi.code={filter:function(n){var e=n.previousSibling||n.nextSibling,t=n.parentNode.nodeName==="PRE"&&!e;return n.nodeName==="CODE"&&!t},replacement:function(n){if(!n)return"";n=n.replace(/\r?\n|\r/g," ");for(var e=/^`|^ .*?[^ ].* $|`$/.test(n)?" ":"",t="`",r=n.match(/`+/gm)||[];r.indexOf(t)!==-1;)t=t+"`";return t+e+n+e+t}};Fi.image={filter:"img",replacement:function(n,e){var t=xp(e.getAttribute("alt")),r=e.getAttribute("src")||"",i=xp(e.getAttribute("title")),o=i?' "'+i+'"':"";return r?"!["+t+"]("+r+o+")":""}};function xp(n){return n?n.replace(/(\n+\s*)+/g,`
`):""}function sT(n){this.options=n,this._keep=[],this._remove=[],this.blankRule={replacement:n.blankReplacement},this.keepReplacement=n.keepReplacement,this.defaultRule={replacement:n.defaultReplacement},this.array=[];for(var e in n.rules)this.array.push(n.rules[e])}sT.prototype={add:function(n,e){this.array.unshift(e)},keep:function(n){this._keep.unshift({filter:n,replacement:this.keepReplacement})},remove:function(n){this._remove.unshift({filter:n,replacement:function(){return""}})},forNode:function(n){if(n.isBlank)return this.blankRule;var e;return(e=cv(this.array,n,this.options))||(e=cv(this._keep,n,this.options))||(e=cv(this._remove,n,this.options))?e:this.defaultRule},forEach:function(n){for(var e=0;e<this.array.length;e++)n(this.array[e],e)}};function cv(n,e,t){for(var r=0;r<n.length;r++){var i=n[r];if(A8(i,e,t))return i}}function A8(n,e,t){var r=n.filter;if(typeof r=="string"){if(r===e.nodeName.toLowerCase())return!0}else if(Array.isArray(r)){if(r.indexOf(e.nodeName.toLowerCase())>-1)return!0}else if(typeof r=="function"){if(r.call(n,e,t))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function k8(n){var e=n.element,t=n.isBlock,r=n.isVoid,i=n.isPre||function(p){return p.nodeName==="PRE"};if(!(!e.firstChild||i(e))){for(var o=null,c=!1,s=null,l=iS(s,e,i);l!==e;){if(l.nodeType===3||l.nodeType===4){var d=l.data.replace(/[ \r\n\t]+/g," ");if((!o||/ $/.test(o.data))&&!c&&d[0]===" "&&(d=d.substr(1)),!d){l=lv(l);continue}l.data=d,o=l}else if(l.nodeType===1)t(l)||l.nodeName==="BR"?(o&&(o.data=o.data.replace(/ $/,"")),o=null,c=!1):r(l)||i(l)?(o=null,c=!0):o&&(c=!1);else{l=lv(l);continue}var h=iS(s,l,i);s=l,l=h}o&&(o.data=o.data.replace(/ $/,""),o.data||lv(o))}}function lv(n){var e=n.nextSibling||n.parentNode;return n.parentNode.removeChild(n),e}function iS(n,e,t){return n&&n.parentNode===e||t(e)?e.nextSibling||e.parentNode:e.firstChild||e.nextSibling||e.parentNode}var BC=typeof window<"u"?window:{};function E8(){var n=BC.DOMParser,e=!1;try{new n().parseFromString("","text/html")&&(e=!0)}catch{}return e}function T8(){var n=function(){};return _8()?n.prototype.parseFromString=function(e){var t=new window.ActiveXObject("htmlfile");return t.designMode="on",t.open(),t.write(e),t.close(),t}:n.prototype.parseFromString=function(e){var t=document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),t},n}function _8(){var n=!1;try{document.implementation.createHTMLDocument("").open()}catch{BC.ActiveXObject&&(n=!0)}return n}var R8=E8()?BC.DOMParser:T8();function D8(n,e){var t;if(typeof n=="string"){var r=P8().parseFromString('<x-turndown id="turndown-root">'+n+"</x-turndown>","text/html");t=r.getElementById("turndown-root")}else t=n.cloneNode(!0);return k8({element:t,isBlock:OC,isVoid:rT,isPre:e.preformattedCode?M8:null}),t}var uv;function P8(){return uv=uv||new R8,uv}function M8(n){return n.nodeName==="PRE"||n.nodeName==="CODE"}function N8(n,e){return n.isBlock=OC(n),n.isCode=n.nodeName==="CODE"||n.parentNode.isCode,n.isBlank=O8(n),n.flankingWhitespace=F8(n,e),n}function O8(n){return!rT(n)&&!w8(n)&&/^\s*$/i.test(n.textContent)&&!I8(n)&&!S8(n)}function F8(n,e){if(n.isBlock||e.preformattedCode&&n.isCode)return{leading:"",trailing:""};var t=B8(n.textContent);return t.leadingAscii&&oS("left",n,e)&&(t.leading=t.leadingNonAscii),t.trailingAscii&&oS("right",n,e)&&(t.trailing=t.trailingNonAscii),{leading:t.leading,trailing:t.trailing}}function B8(n){var e=n.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:e[1],leadingAscii:e[2],leadingNonAscii:e[3],trailing:e[4],trailingNonAscii:e[5],trailingAscii:e[6]}}function oS(n,e,t){var r,i,o;return n==="left"?(r=e.previousSibling,i=/ $/):(r=e.nextSibling,i=/^ /),r&&(r.nodeType===3?o=i.test(r.nodeValue):t.preformattedCode&&r.nodeName==="CODE"?o=!1:r.nodeType===1&&!OC(r)&&(o=i.test(r.textContent))),o}var L8=Array.prototype.reduce,U8=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function cf(n){if(!(this instanceof cf))return new cf(n);var e={rules:Fi,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(t,r){return r.isBlock?`

`:""},keepReplacement:function(t,r){return r.isBlock?`

`+r.outerHTML+`

`:r.outerHTML},defaultReplacement:function(t,r){return r.isBlock?`

`+t+`

`:t}};this.options=y8({},e,n),this.rules=new sT(this.options)}cf.prototype={turndown:function(n){if(!G8(n))throw new TypeError(n+" is not a string, or an element/document/fragment node.");if(n==="")return"";var e=aT.call(this,new D8(n,this.options));return j8.call(this,e)},use:function(n){if(Array.isArray(n))for(var e=0;e<n.length;e++)this.use(n[e]);else if(typeof n=="function")n(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(n,e){return this.rules.add(n,e),this},keep:function(n){return this.rules.keep(n),this},remove:function(n){return this.rules.remove(n),this},escape:function(n){return U8.reduce(function(e,t){return e.replace(t[0],t[1])},n)}};function aT(n){var e=this;return L8.call(n.childNodes,function(t,r){r=new N8(r,e.options);var i="";return r.nodeType===3?i=r.isCode?r.nodeValue:e.escape(r.nodeValue):r.nodeType===1&&(i=V8.call(e,r)),cT(t,i)},"")}function j8(n){var e=this;return this.rules.forEach(function(t){typeof t.append=="function"&&(n=cT(n,t.append(e.options)))}),n.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function V8(n){var e=this.rules.forNode(n),t=aT.call(this,n),r=n.flankingWhitespace;return(r.leading||r.trailing)&&(t=t.trim()),r.leading+e.replacement(t,n,this.options)+r.trailing}function cT(n,e){var t=x8(n),r=C8(e),i=Math.max(n.length-t.length,e.length-r.length),o=`

`.substring(0,i);return t+o+r}function G8(n){return n!=null&&(typeof n=="string"||n.nodeType&&(n.nodeType===1||n.nodeType===9||n.nodeType===11))}const W8=({blockquoteElement:n,contentType:e})=>{const[t,r]=B.useState("default"),i=new cf({headingStyle:"atx",emDelimiter:"*"}),o=async s=>{s.preventDefault(),s.stopPropagation();try{const l=n.cloneNode(!0);l.querySelectorAll(".blockquote-copy-button").forEach(p=>p.remove());let h;if(e==="text/markdown"){const p=l.innerHTML;h=i.turndown(p)}else h=l.textContent||"";await navigator.clipboard.writeText(h.trim()),r("copied"),setTimeout(()=>{r("default")},1500)}catch(l){console.error("Failed to copy text: ",l),r("error"),setTimeout(()=>{r("default")},1500)}},c=()=>{switch(t){case"copied":return"Copied!";case"error":return"Error";default:return"Copy"}};return K.jsx("button",{className:`blockquote-copy-button ${t!=="default"?t:""}`,onClick:o,type:"button","aria-label":"Copy blockquote content",children:c()})},sS=({children:n,contentType:e})=>{const t=B.useRef(null),[r,i]=B.useState(!1);return B.useEffect(()=>{i(!0)},[]),K.jsxs("div",{className:"blockquote-with-copy",style:{position:"relative"},children:[K.jsx("blockquote",{ref:t,"data-content-type":e,dangerouslySetInnerHTML:typeof n=="string"?{__html:n}:void 0,children:typeof n!="string"?n:void 0}),r&&t.current&&K.jsx(W8,{blockquoteElement:t.current,contentType:e})]})},aS=2,z8=2,gs=class gs extends Cn.Component{constructor(t){super(t);oe(this,"outputRef",Cn.createRef());oe(this,"messageKey",0);oe(this,"unsubscribePrefs");oe(this,"turndownService",new cf({headingStyle:"atx",emDelimiter:"*"}));oe(this,"handlePreferencesChange",()=>{this.setState({localEchoActive:dr.getState().general.localEcho})});oe(this,"saveOutput",()=>{const t=this.state.output.map(i=>({type:i.type,sourceType:i.sourceType,sourceContent:i.sourceContent,metadata:i.metadata})).filter(i=>i.sourceContent!==""),r={version:aS,lines:t};localStorage.setItem(gs.LOCAL_STORAGE_KEY,JSON.stringify(r))});oe(this,"recreateContentFromSource",t=>{switch(t.sourceType){case"ansi":return zw(t.sourceContent,this.handleExitClick);case"html":const r=rS.sanitize(t.sourceContent),o=new DOMParser().parseFromString(r,"text/html");if(o.querySelectorAll("blockquote").length>0){const s=[],l=o.body;let d="";return Array.from(l.childNodes).forEach((h,p)=>{if(h.nodeName==="BLOCKQUOTE"){d.trim()&&(s.push(K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:d}},`content-${p}`)),d="");const g=h,y=g.getAttribute("data-content-type")||void 0;s.push(K.jsx(sS,{contentType:y,children:g.innerHTML},`blockquote-${p}`))}else h.nodeType===Node.ELEMENT_NODE?d+=h.outerHTML:h.nodeType===Node.TEXT_NODE&&(d+=h.textContent||"")}),d.trim()&&s.push(K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:d}},"remaining-content")),s}else return[K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}})];case"command":return[K.jsx("span",{className:"command","aria-live":"off",children:t.sourceContent})];case"error":return[K.jsxs("h2",{children:[" Error: ",t.sourceContent]})];case"system":return[K.jsxs("h2",{children:[" ",t.sourceContent]})];default:return console.warn(`Unknown sourceType: ${t.sourceType}, falling back to text display`),[K.jsx("span",{children:t.sourceContent})]}});oe(this,"loadOutput",()=>{const t=localStorage.getItem(gs.LOCAL_STORAGE_KEY);if(t)try{const r=JSON.parse(t);if(r&&typeof r=="object"&&"version"in r&&"lines"in r){const i=r;return i.version===aS?i.lines.map(o=>{const c=this.messageKey++,s=this.recreateContentFromSource(o),l=s.length===1?s[0]:K.jsx(K.Fragment,{children:s});return{id:c,type:o.type,content:K.jsx("div",{className:`output-line output-line-${o.type}`,children:l},c),sourceType:o.sourceType,sourceContent:o.sourceContent,metadata:o.metadata}}):(console.warn(`Unsupported log version: ${i.version}. Clearing old data.`),localStorage.removeItem(gs.LOCAL_STORAGE_KEY),[])}else return console.log("Clearing old format output log."),localStorage.removeItem(gs.LOCAL_STORAGE_KEY),[]}catch(r){return console.error("Failed to parse saved output log:",r),localStorage.removeItem(gs.LOCAL_STORAGE_KEY),[]}return[]});oe(this,"addCommand",t=>{this.addToOutput([K.jsx("span",{className:"command","aria-live":"off",children:t})],"command",!1,"command",t)});oe(this,"addError",t=>this.addToOutput([K.jsxs("h2",{children:[" Error: ",t.message]})],"errorMessage",!0,"error",t.message));oe(this,"handleConnected",()=>this.addToOutput([K.jsx("h2",{children:" Connected"})],"systemInfo",!0,"system","Connected"));oe(this,"handleDisconnected",()=>{this.addToOutput([K.jsx("h2",{children:" Disconnected"})],"systemInfo",!0,"system","Disconnected"),this.setState({sidebarVisible:!1})});oe(this,"handleUserList",t=>this.setState({sidebarVisible:!!t}));oe(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});oe(this,"isScrolledToBottom",()=>{const t=this.outputRef.current;if(!t)return!1;const r=Math.ceil(t.scrollHeight-t.scrollTop),i=Math.ceil(t.clientHeight);return r<=i+z8});oe(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});oe(this,"scrollToBottom",()=>{const t=this.outputRef.current;t&&requestAnimationFrame(()=>{t.scrollTop=t.scrollHeight})});oe(this,"handleMessage",t=>{if(!t)return;const r=zw(t,this.handleExitClick);this.addToOutput(r,"serverMessage",!0,"ansi",t)});oe(this,"handleHtml",t=>{const r=rS.sanitize(t),o=new DOMParser().parseFromString(r,"text/html");if(o.querySelectorAll("blockquote").length>0){const s=[],l=o.body;let d="";Array.from(l.childNodes).forEach((h,p)=>{if(h.nodeName==="BLOCKQUOTE"){d.trim()&&(s.push(K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:d}},`content-${p}`)),d="");const g=h,y=g.getAttribute("data-content-type")||void 0;s.push(K.jsx(sS,{contentType:y,children:g.innerHTML},`blockquote-${p}`))}else h.nodeType===Node.ELEMENT_NODE?d+=h.outerHTML:h.nodeType===Node.TEXT_NODE&&(d+=h.textContent||"")}),d.trim()&&s.push(K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:d}},"remaining-content")),this.addToOutput(s,"serverMessage",!0,"html",t)}else{const s=K.jsx("div",{style:{whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:r}});this.addToOutput([s],"serverMessage",!0,"html",t)}});oe(this,"handleExitClick",t=>{this.props.client.sendCommand(t)});oe(this,"handleDataTextClick",t=>{var o,c;const i=t.target.closest("a.command[data-text]");if(i instanceof HTMLAnchorElement){t.preventDefault();const s=i.dataset.text;s!=null&&(fl(s),(c=(o=this.props).focusInput)==null||c.call(o))}});this.state={output:this.loadOutput(),sidebarVisible:!1,newLinesCount:0,localEchoActive:dr.getState().general.localEcho}}getSnapshotBeforeUpdate(t,r){return this.outputRef.current?(this.outputRef.current,this.isScrolledToBottom()):null}componentDidUpdate(t,r,i){i&&this.scrollToBottom();const o=this.state.output.slice(r.output.length);if(o.length>0){const c=o.filter(s=>this.state.localEchoActive||s.type!=="command").length;c>0&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState(s=>({newLinesCount:s.newLinesCount+c})))}this.saveOutput()}componentDidMount(){const{client:t}=this.props;t.on("message",this.handleMessage),t.on("html",this.handleHtml),t.on("connect",this.handleConnected),t.on("disconnect",this.handleDisconnected),t.on("error",this.addError),t.on("command",this.addCommand),t.on("userlist",this.handleUserList),this.unsubscribePrefs=dr.subscribe(this.handlePreferencesChange)}componentWillUnmount(){const{client:t}=this.props;this.unsubscribePrefs&&this.unsubscribePrefs(),t.removeListener("message",this.handleMessage),t.removeListener("html",this.handleHtml),t.removeListener("connect",this.handleConnected),t.removeListener("disconnect",this.handleDisconnected),t.removeListener("error",this.addError),t.removeListener("command",this.addCommand),t.removeListener("userlist",this.handleUserList)}sanitizeHtml(t){return new DOMParser().parseFromString(t,"text/html").body.textContent||""}addToOutput(t,r,i=!0,o="unknown",c="",s){i&&t.forEach(l=>{if(Cn.isValidElement(l)){const d=qL.renderToString(l),h=this.sanitizeHtml(d);Gw(h)}else typeof l=="string"&&Gw(l)}),this.setState(l=>{const d=t.map(g=>{const y=this.messageKey++;return{id:y,type:r,content:K.jsx("div",{className:`output-line output-line-${r}`,children:g},y),sourceType:o,sourceContent:c,metadata:s}});return{output:[...l.output,...d].slice(-gs.MAX_OUTPUT_LENGTH)}})}saveLog(){const t=this.outputRef.current;if(t){const r=t.innerHTML,i=new Blob([r],{type:"text/html"}),o=URL.createObjectURL(i),c=document.createElement("a"),s=new Date,l=s.toLocaleDateString(),d=s.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),p=`${document.title.replace(/\s+/g,"-")}-log-${l}-${d}.html`;c.download=p,c.href=o,c.click(),URL.revokeObjectURL(o),c.remove()}}clearLog(){this.setState({output:[]}),localStorage.removeItem(gs.LOCAL_STORAGE_KEY)}copyLog(){const t=this.outputRef.current;if(t){const r=t.innerText;navigator.clipboard.writeText(r).then(()=>{console.log("Log copied to clipboard.")}).catch(i=>{console.error("Failed to copy log: ",i),alert("Failed to copy log to clipboard. See console for details.")})}}render(){var t="output";this.state.sidebarVisible&&(t+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return K.jsxs("div",{ref:this.outputRef,className:t,onScroll:this.handleScroll,onClick:this.handleDataTextClick,children:[this.state.output.filter(i=>this.state.localEchoActive||i.type!=="command").map(i=>i.content),this.state.newLinesCount>0&&K.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};oe(gs,"MAX_OUTPUT_LENGTH",7500),oe(gs,"LOCAL_STORAGE_KEY","outputLog");let Iy=gs;const H8="90e42d3cf7eea18cf6cbcace5cc22983d4f07e3e",Bo=()=>{const[,n]=B.useReducer(e=>e+1,0);return B.useEffect(()=>dr.subscribe(n),[]),[dr.getState(),dr.dispatch]},Z8=()=>{const[n,e]=B.useState([]);return B.useEffect(()=>{const t=()=>{e(window.speechSynthesis.getVoices())};t(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=t)},[]),n},lT=({tabs:n})=>{const[e,t]=B.useState(0),r=B.useRef([]),i=B.useRef(!1);return B.useEffect(()=>{r.current=r.current.slice(0,n.length)},[n]),B.useEffect(()=>{const o=s=>{switch(s.key){case"ArrowLeft":i.current=!0,t(l=>l>0?l-1:n.length-1);break;case"ArrowRight":i.current=!0,t(l=>l<n.length-1?l+1:0);break;case"Home":i.current=!0,t(0);break;case"End":i.current=!0,t(n.length-1);break}},c=r.current[e];return c==null||c.addEventListener("keydown",o),()=>{c==null||c.removeEventListener("keydown",o)}},[n.length,e]),B.useEffect(()=>{var o;i.current&&((o=r.current[e])==null||o.focus())},[e]),K.jsxs("div",{className:"tabs-container",children:[K.jsx("div",{role:"tablist",children:n.map((o,c)=>K.jsx("button",{ref:s=>r.current[c]=s,role:"tab","aria-selected":e===c,id:o.id,"aria-controls":`${o.id}-panel`,onClick:()=>{console.log(`Tab onClick triggered for: ${o.label} (Index: ${c})`),i.current=!0,t(c),console.log(`Tab state updated to index: ${c}`)},tabIndex:e===c?void 0:-1,children:o.label},c))}),n.map((o,c)=>K.jsx("div",{role:"tabpanel",id:`${o.id}-panel`,"aria-labelledby":o.id,hidden:e!==c,children:K.jsx("div",{className:"sidebar-tab-content",children:o.content})},o.id))]})},X8=()=>{const[n,e]=Bo();return K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.general.localEcho,onChange:t=>e({type:es.SetGeneral,data:{...n.general,localEcho:t.target.checked}})}),"Local Echo"]})},$8=()=>{const[n,e]=Bo();return K.jsxs("label",{children:["Auto Read:",K.jsxs("select",{value:n.speech.autoreadMode,onChange:t=>e({type:es.SetSpeech,data:{...n.speech,autoreadMode:t.target.value}}),children:[K.jsx("option",{value:"off",children:"Off"}),K.jsx("option",{value:"unfocused",children:"Unfocused"}),K.jsx("option",{value:"all",children:"Always"})]})]})},K8=()=>{const[n,e]=Bo(),t=Z8();return K.jsxs("label",{children:["Voice:",K.jsx("select",{value:n.speech.voice,onChange:r=>e({type:es.SetSpeech,data:{...n.speech,voice:r.target.value}}),children:t.map(r=>K.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},q8=()=>{const[n,e]=Bo();return K.jsxs("label",{children:["Rate (0.1 - 10.0):",K.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:n.speech.rate,onChange:t=>e({type:es.SetSpeech,data:{...n.speech,rate:parseFloat(t.target.value)}})})]})},Y8=()=>{const[n,e]=Bo();return K.jsxs("label",{children:["Pitch (0 - 2):",K.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:n.speech.pitch,onChange:t=>e({type:es.SetSpeech,data:{...n.speech,pitch:parseFloat(t.target.value)}})})]})},Q8=()=>{const[n,e]=Bo();return K.jsxs("label",{children:["Volume (0 - 1):",K.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:n.speech.volume,onChange:t=>e({type:es.SetSpeech,data:{...n.speech,volume:parseFloat(t.target.value)}})})]})},J8=()=>{const[n]=Bo(),[e,t]=B.useState(!1),r=Cn.useRef(!0);Cn.useEffect(()=>()=>{r.current=!1,speechSynthesis.cancel()},[]);const i=()=>{if(e)return;t(!0),console.log("Preview button clicked");const o=()=>{if(!r.current)return;const c=new SpeechSynthesisUtterance("This is a preview of the selected voice settings."),s=speechSynthesis.getVoices();console.log("Available voices:",s.map(d=>d.name));const l=s.find(d=>d.name===n.speech.voice);console.log("Selected voice:",l?l.name:"Not found"),c.voice=l||null,c.rate=n.speech.rate,c.pitch=n.speech.pitch,c.volume=n.speech.volume,console.log("Utterance settings:",{voice:c.voice?c.voice.name:"Default",rate:c.rate,pitch:c.pitch,volume:c.volume}),c.onend=()=>{r.current&&(console.log("Speech ended"),t(!1))},c.onerror=d=>{r.current&&(console.error("Speech synthesis error:",d),t(!1))},speechSynthesis.cancel(),speechSynthesis.speak(c),console.log("Speech started")};if(speechSynthesis.getVoices().length>0)o();else{let c=()=>{c&&(speechSynthesis.onvoiceschanged=null,c=null,r.current&&o())};speechSynthesis.onvoiceschanged=c;const s=()=>{c&&(speechSynthesis.onvoiceschanged=null,c=null)};Cn.useEffect(()=>s,[])}};return K.jsx("button",{onClick:i,disabled:e,children:e?"Playing...":"Preview Voice"})},e6=()=>K.jsxs("div",{children:[K.jsx($8,{}),K.jsx("br",{}),K.jsx(K8,{}),K.jsx("br",{}),K.jsx(q8,{}),K.jsx("br",{}),K.jsx(Y8,{}),K.jsx("br",{}),K.jsx(Q8,{}),K.jsx("br",{}),K.jsx(J8,{})]}),t6=()=>{const[n,e]=Bo();return K.jsx("div",{children:K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.sound.muteInBackground,onChange:t=>e({type:es.SetSound,data:{...n.sound,muteInBackground:t.target.checked}})}),"Mute sounds when in background"]})})},n6=()=>{const[n,e]=Bo(),t=n.editor,r=o=>{e({type:es.SetEditorAutocompleteEnabled,data:o.target.checked})},i=o=>{e({type:es.SetEditorAccessibilityMode,data:o.target.checked})};return K.jsxs("div",{children:[K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:t.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),K.jsx("br",{}),K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:t.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),K.jsx("br",{})]})},r6=()=>{const[n,e]=Bo(),t=r=>{e({type:es.SetMidi,data:{enabled:r.target.checked}})};return en.isSupported?K.jsxs("div",{children:[K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:n.midi.enabled,onChange:t}),"Enable MIDI"]}),K.jsx("br",{}),K.jsx("br",{}),n.midi.enabled&&K.jsx("p",{style:{color:"#666",fontSize:"0.9em"},children:"Device selection and management is available in the MIDI tab when connected to a server."})]}):K.jsxs("div",{children:[K.jsx("p",{children:"MIDI is not supported in this browser."}),K.jsx("p",{children:"MIDI support is available in Chrome, Edge, Opera, and Brave."})]})},i6=()=>{const n=[{label:"General",content:K.jsx(X8,{})},{label:"Speech",content:K.jsx(e6,{})},{label:"Sounds",content:K.jsx(t6,{})},{label:"Editor",content:K.jsx(n6,{})},{label:"MIDI",content:K.jsx(r6,{})}];return K.jsx(lT,{tabs:n})};function o6(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}function lf(){return lf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},lf.apply(null,arguments)}var wy="data-focus-lock",uT="data-focus-lock-disabled",s6="data-no-focus-lock",a6="data-autofocus-inside",c6="data-no-autofocus";function dv(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function l6(n,e){var t=B.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var i=t.value;i!==r&&(t.value=r,t.callback(r,i))}}}})[0];return t.callback=e,t.facade}var u6=typeof window<"u"?B.useLayoutEffect:B.useEffect,cS=new WeakMap;function d6(n,e){var t=l6(null,function(r){return n.forEach(function(i){return dv(i,r)})});return u6(function(){var r=cS.get(t);if(r){var i=new Set(r),o=new Set(n),c=t.current;i.forEach(function(s){o.has(s)||dv(s,null)}),o.forEach(function(s){i.has(s)||dv(s,c)})}cS.set(t,n)},[n]),t}var fv={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},Sy=function(){return Sy=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Sy.apply(this,arguments)};function dT(n){return n}function fT(n,e){e===void 0&&(e=dT);var t=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(o){var c=e(o,r);return t.push(c),function(){t=t.filter(function(s){return s!==c})}},assignSyncMedium:function(o){for(r=!0;t.length;){var c=t;t=[],c.forEach(o)}t={push:function(s){return o(s)},filter:function(){return t}}},assignMedium:function(o){r=!0;var c=[];if(t.length){var s=t;t=[],s.forEach(o),c=t}var l=function(){var h=c;c=[],h.forEach(o)},d=function(){return Promise.resolve().then(l)};d(),t={push:function(h){c.push(h),d()},filter:function(h){return c=c.filter(h),t}}}};return i}function LC(n,e){return e===void 0&&(e=dT),fT(n,e)}function f6(n){n===void 0&&(n={});var e=fT(null);return e.options=Sy({async:!0,ssr:!1},n),e}var hT=LC({},function(n){var e=n.target,t=n.currentTarget;return{target:e,currentTarget:t}}),pT=LC(),h6=LC(),p6=f6({async:!0,ssr:typeof document<"u"}),g6=B.createContext(void 0),m6=[],UC=B.forwardRef(function(e,t){var r,i=B.useState(),o=i[0],c=i[1],s=B.useRef(),l=B.useRef(!1),d=B.useRef(null),h=B.useState({}),p=h[1],g=e.children,y=e.disabled,C=y===void 0?!1:y,x=e.noFocusGuards,w=x===void 0?!1:x,S=e.persistentFocus,E=S===void 0?!1:S,R=e.crossFrame,k=R===void 0?!0:R,A=e.autoFocus,_=A===void 0?!0:A;e.allowTextSelection;var D=e.group,j=e.className,Z=e.whiteList,F=e.hasPositiveIndices,V=e.shards,X=V===void 0?m6:V,te=e.as,pe=te===void 0?"div":te,ve=e.lockProps,Ie=ve===void 0?{}:ve,Re=e.sideCar,xe=e.returnFocus,Ae=xe===void 0?!1:xe,ke=e.focusOptions,H=e.onActivation,ee=e.onDeactivation,ae=B.useState({}),ye=ae[0],Ee=B.useCallback(function(lt){var Gt=lt.captureFocusRestore;if(!d.current){var Vt,Dt=(Vt=document)==null?void 0:Vt.activeElement;d.current=Dt,Dt!==document.body&&(d.current=Gt(Dt))}s.current&&H&&H(s.current),l.current=!0,p()},[H]),_e=B.useCallback(function(){l.current=!1,ee&&ee(s.current),p()},[ee]),Je=B.useCallback(function(lt){var Gt=d.current;if(Gt){var Vt=(typeof Gt=="function"?Gt():Gt)||document.body,Dt=typeof Ae=="function"?Ae(Vt):Ae;if(Dt){var Ht=typeof Dt=="object"?Dt:void 0;d.current=null,lt?Promise.resolve().then(function(){return Vt.focus(Ht)}):Vt.focus(Ht)}}},[Ae]),me=B.useCallback(function(lt){l.current&&hT.useMedium(lt)},[]),it=pT.useMedium,Tt=B.useCallback(function(lt){s.current!==lt&&(s.current=lt,c(lt))},[]),Xt=lf((r={},r[uT]=C&&"disabled",r[wy]=D,r),Ie),Et=w!==!0,St=Et&&w!=="tail",Pt=d6([t,Tt]),at=B.useMemo(function(){return{observed:s,shards:X,enabled:!C,active:l.current}},[C,l.current,X,o]);return Cn.createElement(B.Fragment,null,Et&&[Cn.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:C?-1:0,style:fv}),F?Cn.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:C?-1:1,style:fv}):null],!C&&Cn.createElement(Re,{id:ye,sideCar:p6,observed:o,disabled:C,persistentFocus:E,crossFrame:k,autoFocus:_,whiteList:Z,shards:X,onActivation:Ee,onDeactivation:_e,returnFocus:Je,focusOptions:ke,noFocusGuards:w}),Cn.createElement(pe,lf({ref:Pt},Xt,{className:j,onBlur:it,onFocus:me}),Cn.createElement(g6.Provider,{value:at},g)),St&&Cn.createElement("div",{"data-focus-guard":!0,tabIndex:C?-1:0,style:fv}))});UC.propTypes={};function Ay(n,e){return Ay=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Ay(n,e)}function v6(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Ay(n,e)}function uf(n){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uf(n)}function y6(n,e){if(uf(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(uf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function C6(n){var e=y6(n,"string");return uf(e)=="symbol"?e:e+""}function x6(n,e,t){return(e=C6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function b6(n,e){function t(r){return r.displayName||r.name||"Component"}return function(i){var o=[],c;function s(){c=n(o.map(function(d){return d.props})),e(c)}var l=function(d){v6(h,d);function h(){return d.apply(this,arguments)||this}h.peek=function(){return c};var p=h.prototype;return p.componentDidMount=function(){o.push(this),s()},p.componentDidUpdate=function(){s()},p.componentWillUnmount=function(){var y=o.indexOf(this);o.splice(y,1),s()},p.render=function(){return Cn.createElement(i,this.props)},h}(B.PureComponent);return x6(l,"displayName","SideEffect("+t(i)+")"),l}}var aa=function(n){for(var e=Array(n.length),t=0;t<n.length;++t)e[t]=n[t];return e},Al=function(n){return Array.isArray(n)?n:[n]},gT=function(n){return Array.isArray(n)?n[0]:n},I6=function(n){if(n.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(n,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},mT=function(n){return n.parentNode&&n.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.parentNode.host:n.parentNode},vT=function(n){return n===document||n&&n.nodeType===Node.DOCUMENT_NODE},w6=function(n){return n.hasAttribute("inert")},S6=function(n,e){return!n||vT(n)||!I6(n)&&!w6(n)&&e(mT(n))},yT=function(n,e){var t=n.get(e);if(t!==void 0)return t;var r=S6(e,yT.bind(void 0,n));return n.set(e,r),r},A6=function(n,e){return n&&!vT(n)?T6(n)?e(mT(n)):!1:!0},CT=function(n,e){var t=n.get(e);if(t!==void 0)return t;var r=A6(e,CT.bind(void 0,n));return n.set(e,r),r},xT=function(n){return n.dataset},k6=function(n){return n.tagName==="BUTTON"},bT=function(n){return n.tagName==="INPUT"},IT=function(n){return bT(n)&&n.type==="radio"},E6=function(n){return!((bT(n)||k6(n))&&(n.type==="hidden"||n.disabled))},T6=function(n){var e=n.getAttribute(c6);return![!0,"true",""].includes(e)},jC=function(n){var e;return!!(n&&(!((e=xT(n))===null||e===void 0)&&e.focusGuard))},ky=function(n){return!jC(n)},_6=function(n){return!!n},R6=function(n,e){var t=Math.max(0,n.tabIndex),r=Math.max(0,e.tabIndex),i=t-r,o=n.index-e.index;if(i){if(!t)return 1;if(!r)return-1}return i||o},D6=function(n){return n.tabIndex<0&&!n.hasAttribute("tabindex")?0:n.tabIndex},VC=function(n,e,t){return aa(n).map(function(r,i){var o=D6(r);return{node:r,index:i,tabIndex:t&&o===-1?(r.dataset||{}).focusGuard?0:-1:o}}).filter(function(r){return!e||r.tabIndex>=0}).sort(R6)},P6=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],GC=P6.join(","),M6="".concat(GC,", [data-focus-guard]"),wT=function(n,e){return aa((n.shadowRoot||n).children).reduce(function(t,r){return t.concat(r.matches(e?M6:GC)?[r]:[],wT(r))},[])},N6=function(n,e){var t;return n instanceof HTMLIFrameElement&&(!((t=n.contentDocument)===null||t===void 0)&&t.body)?Bu([n.contentDocument.body],e):[n]},Bu=function(n,e){return n.reduce(function(t,r){var i,o=wT(r,e),c=(i=[]).concat.apply(i,o.map(function(s){return N6(s,e)}));return t.concat(c,r.parentNode?aa(r.parentNode.querySelectorAll(GC)).filter(function(s){return s===r}):[])},[])},O6=function(n){var e=n.querySelectorAll("[".concat(a6,"]"));return aa(e).map(function(t){return Bu([t])}).reduce(function(t,r){return t.concat(r)},[])},WC=function(n,e){return aa(n).filter(function(t){return yT(e,t)}).filter(function(t){return E6(t)})},lS=function(n,e){return e===void 0&&(e=new Map),aa(n).filter(function(t){return CT(e,t)})},zC=function(n,e,t){return VC(WC(Bu(n,t),e),!0,t)},df=function(n,e){return VC(WC(Bu(n),e),!1)},F6=function(n,e){return WC(O6(n),e)},Cl=function(n,e){return n.shadowRoot?Cl(n.shadowRoot,e):Object.getPrototypeOf(n).contains!==void 0&&Object.getPrototypeOf(n).contains.call(n,e)?!0:aa(n.children).some(function(t){var r;if(t instanceof HTMLIFrameElement){var i=(r=t.contentDocument)===null||r===void 0?void 0:r.body;return i?Cl(i,e):!1}return Cl(t,e)})},B6=function(n){for(var e=new Set,t=n.length,r=0;r<t;r+=1)for(var i=r+1;i<t;i+=1){var o=n[r].compareDocumentPosition(n[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return n.filter(function(c,s){return!e.has(s)})},ST=function(n){return n.parentNode?ST(n.parentNode):n},HC=function(n){var e=Al(n);return e.filter(Boolean).reduce(function(t,r){var i=r.getAttribute(wy);return t.push.apply(t,i?B6(aa(ST(r).querySelectorAll("[".concat(wy,'="').concat(i,'"]:not([').concat(uT,'="disabled"])')))):[r]),t},[])},L6=function(n){try{return n()}catch{return}},ff=function(n){if(n===void 0&&(n=document),!(!n||!n.activeElement)){var e=n.activeElement;return e.shadowRoot?ff(e.shadowRoot):e instanceof HTMLIFrameElement&&L6(function(){return e.contentWindow.document})?ff(e.contentWindow.document):e}},U6=function(n,e){return n===e},j6=function(n,e){return!!aa(n.querySelectorAll("iframe")).some(function(t){return U6(t,e)})},AT=function(n,e){return e===void 0&&(e=ff(gT(n).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:HC(n).some(function(t){return Cl(t,e)||j6(t,e)})},V6=function(n){n===void 0&&(n=document);var e=ff(n);return e?aa(n.querySelectorAll("[".concat(s6,"]"))).some(function(t){return Cl(t,e)}):!1},G6=function(n,e){return e.filter(IT).filter(function(t){return t.name===n.name}).filter(function(t){return t.checked})[0]||n},ZC=function(n,e){return IT(n)&&n.name?G6(n,e):n},W6=function(n){var e=new Set;return n.forEach(function(t){return e.add(ZC(t,n))}),n.filter(function(t){return e.has(t)})},uS=function(n){return n[0]&&n.length>1?ZC(n[0],n):n[0]},dS=function(n,e){return n.indexOf(ZC(e,n))},Ey="NEW_FOCUS",z6=function(n,e,t,r,i){var o=n.length,c=n[0],s=n[o-1],l=jC(r);if(!(r&&n.indexOf(r)>=0)){var d=r!==void 0?t.indexOf(r):-1,h=i?t.indexOf(i):d,p=i?n.indexOf(i):-1;if(d===-1)return p!==-1?p:Ey;if(p===-1)return Ey;var g=d-h,y=t.indexOf(c),C=t.indexOf(s),x=W6(t),w=r!==void 0?x.indexOf(r):-1,S=i?x.indexOf(i):w,E=x.filter(function(j){return j.tabIndex>=0}),R=r!==void 0?E.indexOf(r):-1,k=i?E.indexOf(i):R,A=R>=0&&k>=0?k-R:S-w;if(!g&&p>=0||e.length===0)return p;var _=dS(n,e[0]),D=dS(n,e[e.length-1]);if(d<=y&&l&&Math.abs(g)>1)return D;if(d>=C&&l&&Math.abs(g)>1)return _;if(g&&Math.abs(A)>1)return p;if(d<=y)return D;if(d>C)return _;if(g)return Math.abs(g)>1?p:(o+p+g)%o}},H6=function(n){return function(e){var t,r=(t=xT(e))===null||t===void 0?void 0:t.autofocus;return e.autofocus||r!==void 0&&r!=="false"||n.indexOf(e)>=0}},fS=function(n,e,t){var r=n.map(function(o){var c=o.node;return c}),i=lS(r.filter(H6(t)));return i&&i.length?uS(i):uS(lS(e))},Ty=function(n,e){return e===void 0&&(e=[]),e.push(n),n.parentNode&&Ty(n.parentNode.host||n.parentNode,e),e},hv=function(n,e){for(var t=Ty(n),r=Ty(e),i=0;i<t.length;i+=1){var o=t[i];if(r.indexOf(o)>=0)return o}return!1},kT=function(n,e,t){var r=Al(n),i=Al(e),o=r[0],c=!1;return i.filter(Boolean).forEach(function(s){c=hv(c||s,s)||c,t.filter(Boolean).forEach(function(l){var d=hv(o,l);d&&(!c||Cl(d,c)?c=d:c=hv(d,c))})}),c},hS=function(n,e){return n.reduce(function(t,r){return t.concat(F6(r,e))},[])},Z6=function(n,e){var t=new Map;return e.forEach(function(r){return t.set(r.node,r)}),n.map(function(r){return t.get(r)}).filter(_6)},X6=function(n,e){var t=ff(Al(n).length>0?document:gT(n).ownerDocument),r=HC(n).filter(ky),i=kT(t||n,n,r),o=new Map,c=df(r,o),s=c.filter(function(C){var x=C.node;return ky(x)});if(s[0]){var l=df([i],o).map(function(C){var x=C.node;return x}),d=Z6(l,s),h=d.map(function(C){var x=C.node;return x}),p=d.filter(function(C){var x=C.tabIndex;return x>=0}).map(function(C){var x=C.node;return x}),g=z6(h,p,l,t,e);if(g===Ey){var y=fS(c,p,hS(r,o))||fS(c,h,hS(r,o));if(y)return{node:y};console.warn("focus-lock: cannot find any node to move focus into");return}return g===void 0?g:d[g]}},$6=function(n){var e=HC(n).filter(ky),t=kT(n,n,e),r=VC(Bu([t],!0),!0,!0),i=Bu(e,!1);return r.map(function(o){var c=o.node,s=o.index;return{node:c,index:s,lockItem:i.indexOf(c)>=0,guard:jC(c)}})},XC=function(n,e){n&&("focus"in n&&n.focus(e),"contentWindow"in n&&n.contentWindow&&n.contentWindow.focus())},pv=0,gv=!1,ET=function(n,e,t){t===void 0&&(t={});var r=X6(n,e);if(!gv&&r){if(pv>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),gv=!0,setTimeout(function(){gv=!1},1);return}pv++,XC(r.node,t.focusOptions),pv--}};function Md(n){if(!n)return null;if(typeof WeakRef>"u")return function(){return n||null};var e=n?new WeakRef(n):null;return function(){return(e==null?void 0:e.deref())||null}}var K6=function(n){if(!n)return null;for(var e=[],t=n;t&&t!==document.body;)e.push({current:Md(t),parent:Md(t.parentElement),left:Md(t.previousElementSibling),right:Md(t.nextElementSibling)}),t=t.parentElement;return{element:Md(n),stack:e,ownerDocument:n.ownerDocument}},q6=function(n){var e,t,r,i,o;if(n)for(var c=n.stack,s=n.ownerDocument,l=new Map,d=0,h=c;d<h.length;d++){var p=h[d],g=(e=p.parent)===null||e===void 0?void 0:e.call(p);if(g&&s.contains(g)){for(var y=(t=p.left)===null||t===void 0?void 0:t.call(p),C=p.current(),x=g.contains(C)?C:void 0,w=(r=p.right)===null||r===void 0?void 0:r.call(p),S=zC([g],l),E=(o=(i=x??(y==null?void 0:y.nextElementSibling))!==null&&i!==void 0?i:w)!==null&&o!==void 0?o:y;E;){for(var R=0,k=S;R<k.length;R++){var A=k[R];if(E!=null&&E.contains(A.node))return A.node}E=E.nextElementSibling}if(S.length)return S[0].node}}},TT=function(n){var e=K6(n);return function(){return q6(e)}},Y6=function(n,e,t){if(!n||!e)return console.error("no element or scope given"),{};var r=Al(e);if(r.every(function(c){return!Cl(c,n)}))return console.error("Active element is not contained in the scope"),{};var i=t?zC(r,new Map):df(r,new Map),o=i.findIndex(function(c){var s=c.node;return s===n});if(o!==-1)return{prev:i[o-1],next:i[o+1],first:i[0],last:i[i.length-1]}},Q6=function(n,e){var t=e?zC(Al(n),new Map):df(Al(n),new Map);return{first:t[0],last:t[t.length-1]}},J6=function(n){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},n)},_T=function(n,e,t){e===void 0&&(e={});var r=J6(e),i=Y6(n,r.scope,r.onlyTabbable);if(i){var o=t(i,r.cycle);o&&XC(o.node,r.focusOptions)}},e9=function(n,e){e===void 0&&(e={}),_T(n,e,function(t,r){var i=t.next,o=t.first;return i||r&&o})},t9=function(n,e){e===void 0&&(e={}),_T(n,e,function(t,r){var i=t.prev,o=t.last;return i||r&&o})},RT=function(n,e,t){var r,i=Q6(n,(r=e.onlyTabbable)!==null&&r!==void 0?r:!0),o=i[t];o&&XC(o.node,e.focusOptions)},n9=function(n,e){e===void 0&&(e={}),RT(n,e,"first")},r9=function(n,e){e===void 0&&(e={}),RT(n,e,"last")};function $C(n){setTimeout(n,1)}var i9=function(e){return e&&"current"in e?e.current:e},DT=function(){return document&&document.activeElement===document.body},o9=function(){return DT()||V6()},Cu=null,uo=null,pS=function(){return null},xu=null,hf=!1,KC=!1,s9=function(){return!0},a9=function(e){return(Cu.whiteList||s9)(e)},c9=function(e,t){xu={observerNode:e,portaledElement:t}},l9=function(e){return xu&&xu.portaledElement===e};function gS(n,e,t,r){var i=null,o=n;do{var c=r[o];if(c.guard)c.node.dataset.focusAutoGuard&&(i=c);else if(c.lockItem){if(o!==n)return;i=null}else break}while((o+=t)!==e);i&&(i.node.tabIndex=0)}var u9=function(e){return e?!!hf:hf==="meanwhile"},d9=function n(e,t,r){return t&&(t.host===e&&(!t.activeElement||r.contains(t.activeElement))||t.parentNode&&n(e,t.parentNode,r))},f9=function(e,t){return t.some(function(r){return d9(e,r,r)})},PT=function(e){return df(e,new Map)},h9=function(e){return!PT([e.parentNode]).some(function(t){return t.node===e})},bp=function(){var e=!1;if(Cu){var t=Cu,r=t.observed,i=t.persistentFocus,o=t.autoFocus,c=t.shards,s=t.crossFrame,l=t.focusOptions,d=t.noFocusGuards,h=r||xu&&xu.portaledElement;if(DT()&&uo&&uo!==document.body&&(!document.body.contains(uo)||h9(uo))){var p=pS();p&&p.focus()}var g=document&&document.activeElement;if(h){var y=[h].concat(c.map(i9).filter(Boolean)),C=function(){if(!u9(s)||!d||!uo||KC)return!1;var R=PT(y),k=R.findIndex(function(A){var _=A.node;return _===uo});return k===0||k===R.length-1};if((!g||a9(g))&&(i||C()||!o9()||!uo&&o)&&(h&&!(AT(y)||g&&f9(g,y)||l9(g))&&(document&&!uo&&g&&!o?(g.blur&&g.blur(),document.body.focus()):(e=ET(y,uo,{focusOptions:l}),xu={})),uo=document&&document.activeElement,uo!==document.body&&(pS=TT(uo)),hf=!1),document&&g!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var x=document&&document.activeElement,w=$6(y),S=w.map(function(E){var R=E.node;return R}).indexOf(x);S>-1&&(w.filter(function(E){var R=E.guard,k=E.node;return R&&k.dataset.focusAutoGuard}).forEach(function(E){var R=E.node;return R.removeAttribute("tabIndex")}),gS(S,w.length,1,w),gS(S,-1,-1,w))}}}return e},MT=function(e){bp()&&e&&(e.stopPropagation(),e.preventDefault())},qC=function(){return $C(bp)},p9=function(e){var t=e.target,r=e.currentTarget;r.contains(t)||c9(r,t)},g9=function(){return null},NT=function(){KC=!0},OT=function(){KC=!1,hf="just",$C(function(){hf="meanwhile"})},m9=function(){document.addEventListener("focusin",MT),document.addEventListener("focusout",qC),window.addEventListener("focus",NT),window.addEventListener("blur",OT)},v9=function(){document.removeEventListener("focusin",MT),document.removeEventListener("focusout",qC),window.removeEventListener("focus",NT),window.removeEventListener("blur",OT)};function y9(n){return n.filter(function(e){var t=e.disabled;return!t})}var FT={moveFocusInside:ET,focusInside:AT,focusNextElement:e9,focusPrevElement:t9,focusFirstElement:n9,focusLastElement:r9,captureFocusRestore:TT};function C9(n){var e=n.slice(-1)[0];e&&!Cu&&m9();var t=Cu,r=t&&e&&e.id===t.id;Cu=e,t&&!r&&(t.onDeactivation(),n.filter(function(i){var o=i.id;return o===t.id}).length||t.returnFocus(!e)),e?(uo=null,(!r||t.observed!==e.observed)&&e.onActivation(FT),bp(),$C(bp)):(v9(),uo=null)}hT.assignSyncMedium(p9);pT.assignMedium(qC);h6.assignMedium(function(n){return n(FT)});const x9=b6(y9,C9)(g9);var BT=B.forwardRef(function(e,t){return Cn.createElement(UC,lf({sideCar:x9,ref:t},e))}),LT=UC.propTypes||{};LT.sideCar;o6(LT,["sideCar"]);BT.propTypes={};const b9=Cn.forwardRef((n,e)=>{const[t,r]=B.useState(!1),i=B.useRef(null);return Cn.useImperativeHandle(e,()=>({open(){r(!0)},close(){r(!1)}})),B.useEffect(()=>{var o;t&&((o=i.current)==null||o.focus())},[t]),B.useEffect(()=>{const o=c=>{c.key==="Escape"&&r(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]),K.jsx(BT,{disabled:!t,children:K.jsxs("dialog",{className:"preferences-dialog",open:t,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[K.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),t&&K.jsx(i6,{}),K.jsx("button",{onClick:()=>r(!1),children:"Close"}),K.jsx("br",{}),K.jsxs("span",{id:"commit-hash",children:["Version: ",H8]})]})})});var UT={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},mS=Cn.createContext&&Cn.createContext(UT),I9=["attr","size","title"];function w9(n,e){if(n==null)return{};var t=S9(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function S9(n,e){if(n==null)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function Ip(){return Ip=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ip.apply(this,arguments)}function vS(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function wp(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?vS(Object(t),!0).forEach(function(r){A9(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):vS(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function A9(n,e,t){return e=k9(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function k9(n){var e=E9(n,"string");return typeof e=="symbol"?e:e+""}function E9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function jT(n){return n&&n.map((e,t)=>Cn.createElement(e.tag,wp({key:t},e.attr),jT(e.child)))}function Ls(n){return e=>Cn.createElement(T9,Ip({attr:wp({},n.attr)},e),jT(n.child))}function T9(n){var e=t=>{var{attr:r,size:i,title:o}=n,c=w9(n,I9),s=i||t.size||"1em",l;return t.className&&(l=t.className),n.className&&(l=(l?l+" ":"")+n.className),Cn.createElement("svg",Ip({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,c,{className:l,style:wp(wp({color:n.color||t.color},t.style),n.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),o&&Cn.createElement("title",null,o),n.children)};return mS!==void 0?Cn.createElement(mS.Consumer,null,t=>e(t)):e(UT)}function VT(n){return Ls({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(n)}function GT(n){return Ls({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(n)}function _9(n){return Ls({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(n)}function R9(n){return Ls({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32zM128 272c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(n)}function D9(n){return Ls({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"},child:[]}]})(n)}function P9(n){return Ls({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(n)}function M9(n){return Ls({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"},child:[]}]})(n)}function WT(n){return Ls({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(n)}function N9(n){return Ls({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(n)}function O9(n){return Ls({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(n)}function F9(n){return Ls({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(n)}const B9=({onFileChange:n,onRecipientChange:e,onSendFile:t,selectedFile:r,recipient:i})=>{const o=s=>{s.target.files&&s.target.files.length>0&&n(s.target.files[0])},c=s=>{e(s.target.value)};return K.jsxs("div",{className:"file-transfer-controls",children:[K.jsx("input",{type:"file",onChange:o}),K.jsx("input",{type:"text",placeholder:"Recipient",value:i,onChange:c}),K.jsx("button",{onClick:t,disabled:!r||!i,children:"Send File"})]})},L9=({progress:n})=>K.jsxs("div",{className:"progress-bar",children:[K.jsx("progress",{value:n,max:"100"}),K.jsxs("span",{children:[n.toFixed(2),"%"]})]}),U9=({offer:n,onAccept:e,onReject:t})=>K.jsxs("div",{className:"incoming-transfer",children:[K.jsxs("p",{children:["Incoming file: ",n.filename," from ",n.sender]}),K.jsx("button",{onClick:()=>e(n.sender,n.hash),children:"Accept"}),K.jsx("button",{onClick:()=>t(n.sender,n.hash),children:"Reject"})]}),j9=({history:n})=>K.jsxs("div",{className:"transfer-history","aria-live":"polite",children:[K.jsx("h4",{children:"Transfer History"}),K.jsx("ul",{children:n.map((e,t)=>K.jsx("li",{children:e},t))})]}),V9=({client:n,expanded:e})=>{const[t,r]=B.useState(null),[i,o]=B.useState(""),[c,s]=B.useState(0),[l,d]=B.useState(0),[h,p]=B.useState([]),[g,y]=B.useState([]),C=B.useCallback(V=>{y(X=>[...X,V].slice(-10))},[]),x=B.useCallback(V=>{const X=V.sentBytes/V.totalBytes*100;s(X)},[]),w=B.useCallback(V=>{const X=V.receivedBytes/V.totalBytes*100;d(X)},[]),S=B.useCallback(V=>{C(`File sent successfully: ${V.filename}`),s(0)},[C]),E=B.useCallback(V=>{C(`File received successfully: ${V.filename}`),d(0)},[C]),R=B.useCallback(V=>{C(`Error ${V.direction}ing file ${V.filename}: ${V.error}`),V.direction==="send"?s(0):d(0)},[C]),k=B.useCallback(V=>{C(`File transfer cancelled: ${V.filename} (${V.direction})`),V.direction==="send"?s(0):d(0)},[C]),A=B.useCallback(V=>{C(`File transfer rejected: ${V.filename} from ${V.sender}`)},[C]),_=B.useCallback(V=>{C(`File transfer accepted: ${V.filename} by ${V.sender}`)},[C]),D=B.useCallback(V=>{p(X=>[...X,V]),C(`Incoming file offer: ${V.filename} from ${V.sender}`)},[C]);B.useEffect(()=>(n.on("fileTransferOffer",D),n.on("fileTransferAccepted",_),n.fileTransferManager.on("fileSendProgress",x),n.fileTransferManager.on("fileReceiveProgress",w),n.on("fileTransferError",R),n.on("fileTransferCancelled",k),n.on("fileTransferRejected",A),n.on("fileSendComplete",S),n.fileTransferManager.on("fileReceiveComplete",E),()=>{n.off("fileTransferOffer",D),n.off("fileTransferAccepted",_),n.fileTransferManager.off("fileSendProgress",x),n.fileTransferManager.off("fileReceiveProgress",w),n.off("fileTransferError",R),n.off("fileTransferCancelled",k),n.off("fileTransferRejected",A),n.off("fileSendComplete",S),n.fileTransferManager.off("fileReceiveComplete",E)}),[n,D,_,x,w,R,k,A,S,E]);const j=()=>{t&&i&&n.sendFile(t,i).then(()=>{C(`Sending ${t.name} to ${i}`)}).catch(V=>{C(`Error sending file: ${V.message}`)})},Z=(V,X)=>{n.acceptTransfer(V,X);const te=h.find(pe=>pe.hash===X);te&&C(`Accepting file transfer: ${te.filename} from ${V}`),p(pe=>pe.filter(ve=>ve.hash!==X))},F=(V,X)=>{n.rejectTransfer(V,X);const te=h.find(pe=>pe.hash===X);te&&C(`Rejected file transfer: ${te.filename} from ${V}`),p(pe=>pe.filter(ve=>ve.hash!==X))};return K.jsxs("div",{className:`file-transfer-ui ${e?"expanded":"collapsed"}`,children:[K.jsx("h3",{children:"File Transfer"}),K.jsx(B9,{onFileChange:r,onRecipientChange:o,onSendFile:j,selectedFile:t,recipient:i}),(c>0||l>0)&&K.jsx(L9,{progress:c>0?c:l}),h.map(V=>K.jsx(U9,{offer:V,onAccept:Z,onReject:F},`${V.sender}-${V.filename}`)),K.jsx(j9,{history:g})]})};var yS={};function G9(n,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if(r!=="default"&&!(r in n)){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(n)}var W9=Object.defineProperty,z9=(n,e,t)=>e in n?W9(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,CS=(n,e,t)=>z9(n,typeof e!="symbol"?e+"":e,t);let $i=class{constructor(){CS(this,"_locking"),CS(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const t=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),r}};function Dr(n,e){if(!n)throw new Error(e)}const H9=34028234663852886e22,Z9=-34028234663852886e22,X9=4294967295,$9=2147483647,K9=-2147483648;function H0(n){if(typeof n!="number")throw new Error("invalid int 32: "+typeof n);if(!Number.isInteger(n)||n>$9||n<K9)throw new Error("invalid int 32: "+n)}function _y(n){if(typeof n!="number")throw new Error("invalid uint 32: "+typeof n);if(!Number.isInteger(n)||n>X9||n<0)throw new Error("invalid uint 32: "+n)}function zT(n){if(typeof n!="number")throw new Error("invalid float 32: "+typeof n);if(Number.isFinite(n)&&(n>H9||n<Z9))throw new Error("invalid float 32: "+n)}const HT=Symbol("@bufbuild/protobuf/enum-type");function q9(n){const e=n[HT];return Dr(e,"missing enum type on enum object"),e}function ZT(n,e,t,r){n[HT]=XT(e,t.map(i=>({no:i.no,name:i.name,localName:n[i.no]})))}function XT(n,e,t){const r=Object.create(null),i=Object.create(null),o=[];for(const c of e){const s=$T(c);o.push(s),r[c.name]=s,i[c.no]=s}return{typeName:n,values:o,findName(c){return r[c]},findNumber(c){return i[c]}}}function Y9(n,e,t){const r={};for(const i of e){const o=$T(i);r[o.localName]=o.no,r[o.no]=o.localName}return ZT(r,n,e),r}function $T(n){return"localName"in n?n:Object.assign(Object.assign({},n),{localName:n.name})}class YC{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const r=this.getType(),i=r.runtime.bin,o=i.makeReadOptions(t);return i.readMessage(this,o.readerFactory(e),e.byteLength,o),this}fromJson(e,t){const r=this.getType(),i=r.runtime.json,o=i.makeReadOptions(t);return i.readMessage(r,e,o,this),this}fromJsonString(e,t){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,t)}toBinary(e){const t=this.getType(),r=t.runtime.bin,i=r.makeWriteOptions(e),o=i.writerFactory();return r.writeMessage(this,o,i),o.finish()}toJson(e){const t=this.getType(),r=t.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var t;const r=this.toJson(e);return JSON.stringify(r,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Q9(n,e,t,r){var i;const o=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),c={[o]:function(s){n.util.initFields(this),n.util.initPartial(s,this)}}[o];return Object.setPrototypeOf(c.prototype,new YC),Object.assign(c,{runtime:n,typeName:e,fields:n.util.newFieldList(t),fromBinary(s,l){return new c().fromBinary(s,l)},fromJson(s,l){return new c().fromJson(s,l)},fromJsonString(s,l){return new c().fromJsonString(s,l)},equals(s,l){return n.util.equals(c,s,l)}}),c}function J9(){let n=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(n|=(i&127)<<r,(i&128)==0)return this.assertBounds(),[n,e]}let t=this.buf[this.pos++];if(n|=(t&15)<<28,e=(t&112)>>4,(t&128)==0)return this.assertBounds(),[n,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,(i&128)==0)return this.assertBounds(),[n,e]}throw new Error("invalid varint")}function mv(n,e,t){for(let o=0;o<28;o=o+7){const c=n>>>o,s=!(!(c>>>7)&&e==0),l=(s?c|128:c)&255;if(t.push(l),!s)return}const r=n>>>28&15|(e&7)<<4,i=e>>3!=0;if(t.push((i?r|128:r)&255),!!i){for(let o=3;o<31;o=o+7){const c=e>>>o,s=!!(c>>>7),l=(s?c|128:c)&255;if(t.push(l),!s)return}t.push(e>>>31&1)}}const Z0=4294967296;function xS(n){const e=n[0]==="-";e&&(n=n.slice(1));const t=1e6;let r=0,i=0;function o(c,s){const l=Number(n.slice(c,s));i*=t,r=r*t+l,r>=Z0&&(i=i+(r/Z0|0),r=r%Z0)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),e?qT(r,i):QC(r,i)}function e7(n,e){let t=QC(n,e);const r=t.hi&2147483648;r&&(t=qT(t.lo,t.hi));const i=KT(t.lo,t.hi);return r?"-"+i:i}function KT(n,e){if({lo:n,hi:e}=t7(n,e),e<=2097151)return String(Z0*e+n);const t=n&16777215,r=(n>>>24|e<<8)&16777215,i=e>>16&65535;let o=t+r*6777216+i*6710656,c=r+i*8147497,s=i*2;const l=1e7;return o>=l&&(c+=Math.floor(o/l),o%=l),c>=l&&(s+=Math.floor(c/l),c%=l),s.toString()+bS(c)+bS(o)}function t7(n,e){return{lo:n>>>0,hi:e>>>0}}function QC(n,e){return{lo:n|0,hi:e|0}}function qT(n,e){return e=~e,n?n=~n+1:e+=1,QC(n,e)}const bS=n=>{const e=String(n);return"0000000".slice(e.length)+e};function IS(n,e){if(n>=0){for(;n>127;)e.push(n&127|128),n=n>>>7;e.push(n)}else{for(let t=0;t<9;t++)e.push(n&127|128),n=n>>7;e.push(1)}}function n7(){let n=this.buf[this.pos++],e=n&127;if((n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<7,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<14,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<21,(n&128)==0)return this.assertBounds(),e;n=this.buf[this.pos++],e|=(n&15)<<28;for(let t=5;(n&128)!==0&&t<10;t++)n=this.buf[this.pos++];if((n&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function r7(){const n=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof n.getBigInt64=="function"&&typeof n.getBigUint64=="function"&&typeof n.setBigInt64=="function"&&typeof n.setBigUint64=="function"&&(typeof process!="object"||typeof yS!="object"||yS.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),c=BigInt("0"),s=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(l){const d=typeof l=="bigint"?l:BigInt(l);if(d>o||d<i)throw new Error("int64 invalid: ".concat(l));return d},uParse(l){const d=typeof l=="bigint"?l:BigInt(l);if(d>s||d<c)throw new Error("uint64 invalid: ".concat(l));return d},enc(l){return n.setBigInt64(0,this.parse(l),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},uEnc(l){return n.setBigInt64(0,this.uParse(l),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},dec(l,d){return n.setInt32(0,l,!0),n.setInt32(4,d,!0),n.getBigInt64(0,!0)},uDec(l,d){return n.setInt32(0,l,!0),n.setInt32(4,d,!0),n.getBigUint64(0,!0)}}}const t=i=>Dr(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>Dr(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),t(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),t(i),xS(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),xS(i)},dec(i,o){return e7(i,o)},uDec(i,o){return KT(i,o)}}}const vr=r7();var Ye;(function(n){n[n.DOUBLE=1]="DOUBLE",n[n.FLOAT=2]="FLOAT",n[n.INT64=3]="INT64",n[n.UINT64=4]="UINT64",n[n.INT32=5]="INT32",n[n.FIXED64=6]="FIXED64",n[n.FIXED32=7]="FIXED32",n[n.BOOL=8]="BOOL",n[n.STRING=9]="STRING",n[n.BYTES=12]="BYTES",n[n.UINT32=13]="UINT32",n[n.SFIXED32=15]="SFIXED32",n[n.SFIXED64=16]="SFIXED64",n[n.SINT32=17]="SINT32",n[n.SINT64=18]="SINT64"})(Ye||(Ye={}));var Dc;(function(n){n[n.BIGINT=0]="BIGINT",n[n.STRING=1]="STRING"})(Dc||(Dc={}));function fc(n,e,t){if(e===t)return!0;if(n==Ye.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}switch(n){case Ye.UINT64:case Ye.FIXED64:case Ye.INT64:case Ye.SFIXED64:case Ye.SINT64:return e==t}return!1}function Lu(n,e){switch(n){case Ye.BOOL:return!1;case Ye.UINT64:case Ye.FIXED64:case Ye.INT64:case Ye.SFIXED64:case Ye.SINT64:return e==0?vr.zero:"0";case Ye.DOUBLE:case Ye.FLOAT:return 0;case Ye.BYTES:return new Uint8Array(0);case Ye.STRING:return"";default:return 0}}function YT(n,e){switch(n){case Ye.BOOL:return e===!1;case Ye.STRING:return e==="";case Ye.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var Fr;(function(n){n[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32"})(Fr||(Fr={}));class i7{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let t=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)t.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(_y(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return H0(e),IS(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){zT(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){_y(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){H0(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return H0(e),e=(e<<1^e>>31)>>>0,IS(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=vr.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=vr.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=vr.enc(e);return mv(t.lo,t.hi,this.buf),this}sint64(e){let t=vr.enc(e),r=t.hi>>31,i=t.lo<<1^r,o=(t.hi<<1|t.lo>>>31)^r;return mv(i,o,this.buf),this}uint64(e){let t=vr.uEnc(e);return mv(t.lo,t.hi,this.buf),this}}class o7{constructor(e,t){this.varint64=J9,this.uint32=n7,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,r=e&7;if(t<=0||r<0||r>5)throw new Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e,t){let r=this.pos;switch(e){case Fr.Varint:for(;this.buf[this.pos++]&128;);break;case Fr.Bit64:this.pos+=4;case Fr.Bit32:this.pos+=4;break;case Fr.LengthDelimited:let i=this.uint32();this.pos+=i;break;case Fr.StartGroup:for(;;){const[o,c]=this.tag();if(c===Fr.EndGroup){if(t!==void 0&&o!==t)throw new Error("invalid end group tag");break}this.skip(c,o)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return vr.dec(...this.varint64())}uint64(){return vr.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(e&1);return e=(e>>>1|(t&1)<<31)^r,t=t>>>1^r,vr.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return vr.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return vr.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function s7(n,e,t,r){let i;return{typeName:e,extendee:t,get field(){if(!i){const o=typeof r=="function"?r():r;o.name=e.split(".").pop(),o.jsonName="[".concat(e,"]"),i=n.util.newFieldList([o]).list()[0]}return i},runtime:n}}function QT(n){const e=n.field.localName,t=Object.create(null);return t[e]=a7(n),[t,()=>t[e]]}function a7(n){const e=n.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return Lu(e.T,e.L);case"message":const t=e.T,r=new t;return t.fieldWrapper?t.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function c7(n,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let t=n.length-1;t>=0;--t)if(n[t].no==e.no)return[n[t]];return[]}return n.filter(t=>t.no===e.no)}let Da="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Jp=[];for(let n=0;n<Da.length;n++)Jp[Da[n].charCodeAt(0)]=n;Jp[45]=Da.indexOf("+");Jp[95]=Da.indexOf("/");const JT={dec(n){let e=n.length*3/4;n[n.length-2]=="="?e-=2:n[n.length-1]=="="&&(e-=1);let t=new Uint8Array(e),r=0,i=0,o,c=0;for(let s=0;s<n.length;s++){if(o=Jp[n.charCodeAt(s)],o===void 0)switch(n[s]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:c=o,i=1;break;case 1:t[r++]=c<<2|(o&48)>>4,c=o,i=2;break;case 2:t[r++]=(c&15)<<4|(o&60)>>2,c=o,i=3;break;case 3:t[r++]=(c&3)<<6|o,i=0;break}}if(i==1)throw Error("invalid base64 string.");return t.subarray(0,r)},enc(n){let e="",t=0,r,i=0;for(let o=0;o<n.length;o++)switch(r=n[o],t){case 0:e+=Da[r>>2],i=(r&3)<<4,t=1;break;case 1:e+=Da[i|r>>4],i=(r&15)<<2,t=2;break;case 2:e+=Da[i|r>>6],e+=Da[r&63],t=0;break}return t&&(e+=Da[i],e+="=",t==1&&(e+="=")),e}};function l7(n,e,t){t_(e,n);const r=e.runtime.bin.makeReadOptions(t),i=c7(n.getType().runtime.bin.listUnknownFields(n),e.field),[o,c]=QT(e);for(const s of i)e.runtime.bin.readField(o,r.readerFactory(s.data),e.field,s.wireType,r);return c()}function u7(n,e,t,r){t_(e,n);const i=e.runtime.bin.makeReadOptions(r),o=e.runtime.bin.makeWriteOptions(r);if(e_(n,e)){const d=n.getType().runtime.bin.listUnknownFields(n).filter(h=>h.no!=e.field.no);n.getType().runtime.bin.discardUnknownFields(n);for(const h of d)n.getType().runtime.bin.onUnknownField(n,h.no,h.wireType,h.data)}const c=o.writerFactory();let s=e.field;!s.opt&&!s.repeated&&(s.kind=="enum"||s.kind=="scalar")&&(s=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(s,t,c,o);const l=i.readerFactory(c.finish());for(;l.pos<l.len;){const[d,h]=l.tag(),p=l.skip(h,d);n.getType().runtime.bin.onUnknownField(n,d,h,p)}}function e_(n,e){const t=n.getType();return e.extendee.typeName===t.typeName&&!!t.runtime.bin.listUnknownFields(n).find(r=>r.no==e.field.no)}function t_(n,e){Dr(n.extendee.typeName==e.getType().typeName,"extension ".concat(n.typeName," can only be applied to message ").concat(n.extendee.typeName))}function n_(n,e){const t=n.localName;if(n.repeated)return e[t].length>0;if(n.oneof)return e[n.oneof.localName].case===t;switch(n.kind){case"enum":case"scalar":return n.opt||n.req?e[t]!==void 0:n.kind=="enum"?e[t]!==n.T.values[0].no:!YT(n.T,e[t]);case"message":return e[t]!==void 0;case"map":return Object.keys(e[t]).length>0}}function wS(n,e){const t=n.localName,r=!n.opt&&!n.req;if(n.repeated)e[t]=[];else if(n.oneof)e[n.oneof.localName]={case:void 0};else switch(n.kind){case"map":e[t]={};break;case"enum":e[t]=r?n.T.values[0].no:void 0;break;case"scalar":e[t]=r?Lu(n.T,n.L):void 0;break;case"message":e[t]=void 0;break}}function Pa(n,e){if(n===null||typeof n!="object"||!Object.getOwnPropertyNames(YC.prototype).every(r=>r in n&&typeof n[r]=="function"))return!1;const t=n.getType();return t===null||typeof t!="function"||!("typeName"in t)||typeof t.typeName!="string"?!1:e===void 0?!0:t.typeName==e.typeName}function r_(n,e){return Pa(e)||!n.fieldWrapper?e:n.fieldWrapper.wrapField(e)}Ye.DOUBLE,Ye.FLOAT,Ye.INT64,Ye.UINT64,Ye.INT32,Ye.UINT32,Ye.BOOL,Ye.STRING,Ye.BYTES;const SS={ignoreUnknownFields:!1},AS={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function d7(n){return n?Object.assign(Object.assign({},SS),n):SS}function f7(n){return n?Object.assign(Object.assign({},AS),n):AS}const Sp=Symbol(),X0=Symbol();function h7(){return{makeReadOptions:d7,makeWriteOptions:f7,readMessage(n,e,t,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(Ys(e)));r=r??new n;const i=new Map,o=t.typeRegistry;for(const[c,s]of Object.entries(e)){const l=n.fields.findJsonName(c);if(l){if(l.oneof){if(s===null&&l.kind=="scalar")continue;const d=i.get(l.oneof);if(d!==void 0)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(l.oneof.name,'" present: "').concat(d,'", "').concat(c,'"'));i.set(l.oneof,c)}kS(r,s,l,t,n)}else{let d=!1;if(o!=null&&o.findExtension&&c.startsWith("[")&&c.endsWith("]")){const h=o.findExtension(c.substring(1,c.length-1));if(h&&h.extendee.typeName==n.typeName){d=!0;const[p,g]=QT(h);kS(p,s,h.field,t,h),u7(r,h,g(),t)}}if(!d&&!t.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(c,'" is unknown'))}}return r},writeMessage(n,e){const t=n.getType(),r={};let i;try{for(i of t.fields.byNumber()){if(!n_(i,n)){if(i.req)throw"required field not set";if(!e.emitDefaultValues||!g7(i))continue}const c=i.oneof?n[i.oneof.localName].value:n[i.localName],s=ES(i,c,e);s!==void 0&&(r[e.useProtoFieldName?i.name:i.jsonName]=s)}const o=e.typeRegistry;if(o!=null&&o.findExtensionFor)for(const c of t.runtime.bin.listUnknownFields(n)){const s=o.findExtensionFor(t.typeName,c.no);if(s&&e_(n,s)){const l=l7(n,s,e),d=ES(s.field,l,e);d!==void 0&&(r[s.field.jsonName]=d)}}}catch(o){const c=i?"cannot encode field ".concat(t.typeName,".").concat(i.name," to JSON"):"cannot encode message ".concat(t.typeName," to JSON"),s=o instanceof Error?o.message:String(o);throw new Error(c+(s.length>0?": ".concat(s):""))}return r},readScalar(n,e,t){return Yd(n,e,t??Dc.BIGINT,!0)},writeScalar(n,e,t){if(e!==void 0&&(t||YT(n,e)))return $0(n,e)},debug:Ys}}function Ys(n){if(n===null)return"null";switch(typeof n){case"object":return Array.isArray(n)?"array":"object";case"string":return n.length>100?"string":'"'.concat(n.split('"').join('\\"'),'"');default:return String(n)}}function kS(n,e,t,r,i){let o=t.localName;if(t.repeated){if(Dr(t.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ys(e)));const c=n[o];for(const s of e){if(s===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ys(s)));switch(t.kind){case"message":c.push(t.T.fromJson(s,r));break;case"enum":const l=vv(t.T,s,r.ignoreUnknownFields,!0);l!==X0&&c.push(l);break;case"scalar":try{c.push(Yd(t.T,s,t.L,!0))}catch(d){let h="cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ys(s));throw d instanceof Error&&d.message.length>0&&(h+=": ".concat(d.message)),new Error(h)}break}}}else if(t.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ys(e)));const c=n[o];for(const[s,l]of Object.entries(e)){if(l===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: map value null"));let d;try{d=p7(t.K,s)}catch(h){let p="cannot decode map key for field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ys(e));throw h instanceof Error&&h.message.length>0&&(p+=": ".concat(h.message)),new Error(p)}switch(t.V.kind){case"message":c[d]=t.V.T.fromJson(l,r);break;case"enum":const h=vv(t.V.T,l,r.ignoreUnknownFields,!0);h!==X0&&(c[d]=h);break;case"scalar":try{c[d]=Yd(t.V.T,l,Dc.BIGINT,!0)}catch(p){let g="cannot decode map value for field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ys(e));throw p instanceof Error&&p.message.length>0&&(g+=": ".concat(p.message)),new Error(g)}break}}}else switch(t.oneof&&(n=n[t.oneof.localName]={case:o},o="value"),t.kind){case"message":const c=t.T;if(e===null&&c.typeName!="google.protobuf.Value")return;let s=n[o];Pa(s)?s.fromJson(e,r):(n[o]=s=c.fromJson(e,r),c.fieldWrapper&&!t.oneof&&(n[o]=c.fieldWrapper.unwrapField(s)));break;case"enum":const l=vv(t.T,e,r.ignoreUnknownFields,!1);switch(l){case Sp:wS(t,n);break;case X0:break;default:n[o]=l;break}break;case"scalar":try{const d=Yd(t.T,e,t.L,!1);switch(d){case Sp:wS(t,n);break;default:n[o]=d;break}}catch(d){let h="cannot decode field ".concat(i.typeName,".").concat(t.name," from JSON: ").concat(Ys(e));throw d instanceof Error&&d.message.length>0&&(h+=": ".concat(d.message)),new Error(h)}break}}function p7(n,e){if(n===Ye.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Yd(n,e,Dc.BIGINT,!0).toString()}function Yd(n,e,t,r){if(e===null)return r?Lu(n,t):Sp;switch(n){case Ye.DOUBLE:case Ye.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const i=Number(e);if(Number.isNaN(i)||!Number.isFinite(i))break;return n==Ye.FLOAT&&zT(i),i;case Ye.INT32:case Ye.FIXED32:case Ye.SFIXED32:case Ye.SINT32:case Ye.UINT32:let o;if(typeof e=="number"?o=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(o=Number(e)),o===void 0)break;return n==Ye.UINT32||n==Ye.FIXED32?_y(o):H0(o),o;case Ye.INT64:case Ye.SFIXED64:case Ye.SINT64:if(typeof e!="number"&&typeof e!="string")break;const c=vr.parse(e);return t?c.toString():c;case Ye.FIXED64:case Ye.UINT64:if(typeof e!="number"&&typeof e!="string")break;const s=vr.uParse(e);return t?s.toString():s;case Ye.BOOL:if(typeof e!="boolean")break;return e;case Ye.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case Ye.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return JT.dec(e)}throw new Error}function vv(n,e,t,r){if(e===null)return n.typeName=="google.protobuf.NullValue"?0:r?n.values[0].no:Sp;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const i=n.findName(e);if(i!==void 0)return i.no;if(t)return X0;break}throw new Error("cannot decode enum ".concat(n.typeName," from JSON: ").concat(Ys(e)))}function g7(n){return n.repeated||n.kind=="map"?!0:!(n.oneof||n.kind=="message"||n.opt||n.req)}function ES(n,e,t){if(n.kind=="map"){Dr(typeof e=="object"&&e!=null);const r={},i=Object.entries(e);switch(n.V.kind){case"scalar":for(const[c,s]of i)r[c.toString()]=$0(n.V.T,s);break;case"message":for(const[c,s]of i)r[c.toString()]=s.toJson(t);break;case"enum":const o=n.V.T;for(const[c,s]of i)r[c.toString()]=yv(o,s,t.enumAsInteger);break}return t.emitDefaultValues||i.length>0?r:void 0}if(n.repeated){Dr(Array.isArray(e));const r=[];switch(n.kind){case"scalar":for(let i=0;i<e.length;i++)r.push($0(n.T,e[i]));break;case"enum":for(let i=0;i<e.length;i++)r.push(yv(n.T,e[i],t.enumAsInteger));break;case"message":for(let i=0;i<e.length;i++)r.push(e[i].toJson(t));break}return t.emitDefaultValues||r.length>0?r:void 0}switch(n.kind){case"scalar":return $0(n.T,e);case"enum":return yv(n.T,e,t.enumAsInteger);case"message":return r_(n.T,e).toJson(t)}}function yv(n,e,t){var r;if(Dr(typeof e=="number"),n.typeName=="google.protobuf.NullValue")return null;if(t)return e;const i=n.findNumber(e);return(r=i==null?void 0:i.name)!==null&&r!==void 0?r:e}function $0(n,e){switch(n){case Ye.INT32:case Ye.SFIXED32:case Ye.SINT32:case Ye.FIXED32:case Ye.UINT32:return Dr(typeof e=="number"),e;case Ye.FLOAT:case Ye.DOUBLE:return Dr(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case Ye.STRING:return Dr(typeof e=="string"),e;case Ye.BOOL:return Dr(typeof e=="boolean"),e;case Ye.UINT64:case Ye.FIXED64:case Ye.INT64:case Ye.SFIXED64:case Ye.SINT64:return Dr(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case Ye.BYTES:return Dr(e instanceof Uint8Array),JT.enc(e)}}const fu=Symbol("@bufbuild/protobuf/unknown-fields"),TS={readUnknownFields:!0,readerFactory:n=>new o7(n)},_S={writeUnknownFields:!0,writerFactory:()=>new i7};function m7(n){return n?Object.assign(Object.assign({},TS),n):TS}function v7(n){return n?Object.assign(Object.assign({},_S),n):_S}function y7(){return{makeReadOptions:m7,makeWriteOptions:v7,listUnknownFields(n){var e;return(e=n[fu])!==null&&e!==void 0?e:[]},discardUnknownFields(n){delete n[fu]},writeUnknownFields(n,e){const r=n[fu];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(n,e,t,r){const i=n;Array.isArray(i[fu])||(i[fu]=[]),i[fu].push({no:e,wireType:t,data:r})},readMessage(n,e,t,r,i){const o=n.getType(),c=i?e.len:e.pos+t;let s,l;for(;e.pos<c&&([s,l]=e.tag(),!(i===!0&&l==Fr.EndGroup));){const d=o.fields.find(s);if(!d){const h=e.skip(l,s);r.readUnknownFields&&this.onUnknownField(n,s,l,h);continue}RS(n,e,d,l,r)}if(i&&(l!=Fr.EndGroup||s!==t))throw new Error("invalid end group tag")},readField:RS,writeMessage(n,e,t){const r=n.getType();for(const i of r.fields.byNumber()){if(!n_(i,n)){if(i.req)throw new Error("cannot encode field ".concat(r.typeName,".").concat(i.name," to binary: required field not set"));continue}const o=i.oneof?n[i.oneof.localName].value:n[i.localName];DS(i,o,e,t)}return t.writeUnknownFields&&this.writeUnknownFields(n,e),e},writeField(n,e,t,r){e!==void 0&&DS(n,e,t,r)}}}function RS(n,e,t,r,i){let{repeated:o,localName:c}=t;switch(t.oneof&&(n=n[t.oneof.localName],n.case!=c&&delete n.value,n.case=c,c="value"),t.kind){case"scalar":case"enum":const s=t.kind=="enum"?Ye.INT32:t.T;let l=Ap;if(t.kind=="scalar"&&t.L>0&&(l=x7),o){let g=n[c];if(r==Fr.LengthDelimited&&s!=Ye.STRING&&s!=Ye.BYTES){let C=e.uint32()+e.pos;for(;e.pos<C;)g.push(l(e,s))}else g.push(l(e,s))}else n[c]=l(e,s);break;case"message":const d=t.T;o?n[c].push(K0(e,new d,i,t)):Pa(n[c])?K0(e,n[c],i,t):(n[c]=K0(e,new d,i,t),d.fieldWrapper&&!t.oneof&&!t.repeated&&(n[c]=d.fieldWrapper.unwrapField(n[c])));break;case"map":let[h,p]=C7(t,e,i);n[c][h]=p;break}}function K0(n,e,t,r){const i=e.getType().runtime.bin,o=r==null?void 0:r.delimited;return i.readMessage(e,n,o?r.no:n.uint32(),t,o),e}function C7(n,e,t){const r=e.uint32(),i=e.pos+r;let o,c;for(;e.pos<i;){const[s]=e.tag();switch(s){case 1:o=Ap(e,n.K);break;case 2:switch(n.V.kind){case"scalar":c=Ap(e,n.V.T);break;case"enum":c=e.int32();break;case"message":c=K0(e,new n.V.T,t,void 0);break}break}}if(o===void 0&&(o=Lu(n.K,Dc.BIGINT)),typeof o!="string"&&typeof o!="number"&&(o=o.toString()),c===void 0)switch(n.V.kind){case"scalar":c=Lu(n.V.T,Dc.BIGINT);break;case"enum":c=n.V.T.values[0].no;break;case"message":c=new n.V.T;break}return[o,c]}function x7(n,e){const t=Ap(n,e);return typeof t=="bigint"?t.toString():t}function Ap(n,e){switch(e){case Ye.STRING:return n.string();case Ye.BOOL:return n.bool();case Ye.DOUBLE:return n.double();case Ye.FLOAT:return n.float();case Ye.INT32:return n.int32();case Ye.INT64:return n.int64();case Ye.UINT64:return n.uint64();case Ye.FIXED64:return n.fixed64();case Ye.BYTES:return n.bytes();case Ye.FIXED32:return n.fixed32();case Ye.SFIXED32:return n.sfixed32();case Ye.SFIXED64:return n.sfixed64();case Ye.SINT64:return n.sint64();case Ye.UINT32:return n.uint32();case Ye.SINT32:return n.sint32()}}function DS(n,e,t,r){Dr(e!==void 0);const i=n.repeated;switch(n.kind){case"scalar":case"enum":let o=n.kind=="enum"?Ye.INT32:n.T;if(i)if(Dr(Array.isArray(e)),n.packed)I7(t,o,n.no,e);else for(const c of e)Qd(t,o,n.no,c);else Qd(t,o,n.no,e);break;case"message":if(i){Dr(Array.isArray(e));for(const c of e)PS(t,r,n,c)}else PS(t,r,n,e);break;case"map":Dr(typeof e=="object"&&e!=null);for(const[c,s]of Object.entries(e))b7(t,r,n,c,s);break}}function b7(n,e,t,r,i){n.tag(t.no,Fr.LengthDelimited),n.fork();let o=r;switch(t.K){case Ye.INT32:case Ye.FIXED32:case Ye.UINT32:case Ye.SFIXED32:case Ye.SINT32:o=Number.parseInt(r);break;case Ye.BOOL:Dr(r=="true"||r=="false"),o=r=="true";break}switch(Qd(n,t.K,1,o),t.V.kind){case"scalar":Qd(n,t.V.T,2,i);break;case"enum":Qd(n,Ye.INT32,2,i);break;case"message":Dr(i!==void 0),n.tag(2,Fr.LengthDelimited).bytes(i.toBinary(e));break}n.join()}function PS(n,e,t,r){const i=r_(t.T,r);t.delimited?n.tag(t.no,Fr.StartGroup).raw(i.toBinary(e)).tag(t.no,Fr.EndGroup):n.tag(t.no,Fr.LengthDelimited).bytes(i.toBinary(e))}function Qd(n,e,t,r){Dr(r!==void 0);let[i,o]=i_(e);n.tag(t,i)[o](r)}function I7(n,e,t,r){if(!r.length)return;n.tag(t,Fr.LengthDelimited).fork();let[,i]=i_(e);for(let o=0;o<r.length;o++)n[i](r[o]);n.join()}function i_(n){let e=Fr.Varint;switch(n){case Ye.BYTES:case Ye.STRING:e=Fr.LengthDelimited;break;case Ye.DOUBLE:case Ye.FIXED64:case Ye.SFIXED64:e=Fr.Bit64;break;case Ye.FIXED32:case Ye.SFIXED32:case Ye.FLOAT:e=Fr.Bit32;break}const t=Ye[n].toLowerCase();return[e,t]}function w7(){return{setEnumType:ZT,initPartial(n,e){if(n===void 0)return;const t=e.getType();for(const r of t.fields.byMember()){const i=r.localName,o=e,c=n;if(c[i]!=null)switch(r.kind){case"oneof":const s=c[i].case;if(s===void 0)continue;const l=r.findField(s);let d=c[i].value;l&&l.kind=="message"&&!Pa(d,l.T)?d=new l.T(d):l&&l.kind==="scalar"&&l.T===Ye.BYTES&&(d=Nd(d)),o[i]={case:s,value:d};break;case"scalar":case"enum":let h=c[i];r.T===Ye.BYTES&&(h=r.repeated?h.map(Nd):Nd(h)),o[i]=h;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===Ye.BYTES)for(const[y,C]of Object.entries(c[i]))o[i][y]=Nd(C);else Object.assign(o[i],c[i]);break;case"message":const g=r.V.T;for(const y of Object.keys(c[i])){let C=c[i][y];g.fieldWrapper||(C=new g(C)),o[i][y]=C}break}break;case"message":const p=r.T;if(r.repeated)o[i]=c[i].map(g=>Pa(g,p)?g:new p(g));else{const g=c[i];p.fieldWrapper?p.typeName==="google.protobuf.BytesValue"?o[i]=Nd(g):o[i]=g:o[i]=Pa(g,p)?g:new p(g)}break}}},equals(n,e,t){return e===t?!0:!e||!t?!1:n.fields.byMember().every(r=>{const i=e[r.localName],o=t[r.localName];if(r.repeated){if(i.length!==o.length)return!1;switch(r.kind){case"message":return i.every((c,s)=>r.T.equals(c,o[s]));case"scalar":return i.every((c,s)=>fc(r.T,c,o[s]));case"enum":return i.every((c,s)=>fc(Ye.INT32,c,o[s]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":let c=i,s=o;return r.T.fieldWrapper&&(c!==void 0&&!Pa(c)&&(c=r.T.fieldWrapper.wrapField(c)),s!==void 0&&!Pa(s)&&(s=r.T.fieldWrapper.wrapField(s))),r.T.equals(c,s);case"enum":return fc(Ye.INT32,i,o);case"scalar":return fc(r.T,i,o);case"oneof":if(i.case!==o.case)return!1;const l=r.findField(i.case);if(l===void 0)return!0;switch(l.kind){case"message":return l.T.equals(i.value,o.value);case"enum":return fc(Ye.INT32,i.value,o.value);case"scalar":return fc(l.T,i.value,o.value)}throw new Error("oneof cannot contain ".concat(l.kind));case"map":const d=Object.keys(i).concat(Object.keys(o));switch(r.V.kind){case"message":const h=r.V.T;return d.every(g=>h.equals(i[g],o[g]));case"enum":return d.every(g=>fc(Ye.INT32,i[g],o[g]));case"scalar":const p=r.V.T;return d.every(g=>fc(p,i[g],o[g]))}break}})},clone(n){const e=n.getType(),t=new e,r=t;for(const i of e.fields.byMember()){const o=n[i.localName];let c;if(i.repeated)c=o.map(zh);else if(i.kind=="map"){c=r[i.localName];for(const[s,l]of Object.entries(o))c[s]=zh(l)}else i.kind=="oneof"?c=i.findField(o.case)?{case:o.case,value:zh(o.value)}:{case:void 0}:c=zh(o);r[i.localName]=c}for(const i of e.runtime.bin.listUnknownFields(n))e.runtime.bin.onUnknownField(r,i.no,i.wireType,i.data);return t}}}function zh(n){if(n===void 0)return n;if(Pa(n))return n.clone();if(n instanceof Uint8Array){const e=new Uint8Array(n.byteLength);return e.set(n),e}return n}function Nd(n){return n instanceof Uint8Array?n:new Uint8Array(n)}function S7(n,e,t){return{syntax:n,json:h7(),bin:y7(),util:Object.assign(Object.assign({},w7()),{newFieldList:e,initFields:t}),makeMessageType(r,i,o){return Q9(this,r,i,o)},makeEnum:Y9,makeEnumType:XT,getEnumType:q9,makeExtension(r,i,o){return s7(this,r,i,o)}}}class A7{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const r of this.list())t[r.jsonName]=t[r.name]=r;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const r of this.list())t[r.no]=r;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const r of this.list())r.oneof?r.oneof!==t&&(t=r.oneof,e.push(t)):e.push(r)}return this.members}}function o_(n,e){const t=s_(n);return e?t:D7(R7(t))}function k7(n){return o_(n,!1)}const E7=s_;function s_(n){let e=!1;const t=[];for(let r=0;r<n.length;r++){let i=n.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),t.push(i);break}}return t.join("")}const T7=new Set(["constructor","toString","toJSON","valueOf"]),_7=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),a_=n=>"".concat(n,"$"),R7=n=>_7.has(n)?a_(n):n,D7=n=>T7.has(n)?a_(n):n;class P7{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=k7(e)}addField(e){Dr(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}function M7(n,e){var t,r,i,o,c,s;const l=[];let d;for(const h of typeof n=="function"?n():n){const p=h;if(p.localName=o_(h.name,h.oneof!==void 0),p.jsonName=(t=h.jsonName)!==null&&t!==void 0?t:E7(h.name),p.repeated=(r=h.repeated)!==null&&r!==void 0?r:!1,h.kind=="scalar"&&(p.L=(i=h.L)!==null&&i!==void 0?i:Dc.BIGINT),p.delimited=(o=h.delimited)!==null&&o!==void 0?o:!1,p.req=(c=h.req)!==null&&c!==void 0?c:!1,p.opt=(s=h.opt)!==null&&s!==void 0?s:!1,h.packed===void 0&&(p.packed=h.kind=="enum"||h.kind=="scalar"&&h.T!=Ye.BYTES&&h.T!=Ye.STRING),h.oneof!==void 0){const g=typeof h.oneof=="string"?h.oneof:h.oneof.name;(!d||d.name!=g)&&(d=new P7(g)),p.oneof=d,d.addField(p)}l.push(p)}return l}const Fe=S7("proto3",n=>new A7(n,e=>M7(e)),n=>{for(const e of n.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,r=n;if(e.repeated){r[t]=[];continue}switch(e.kind){case"oneof":r[t]={case:void 0};break;case"enum":r[t]=0;break;case"map":r[t]={};break;case"scalar":r[t]=Lu(e.T,e.L);break}}});class po extends YC{constructor(e){super(),this.seconds=vr.zero,this.nanos=0,Fe.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(Fe.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=vr.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(t).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return po.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new po({seconds:vr.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new po().fromBinary(e,t)}static fromJson(e,t){return new po().fromJson(e,t)}static fromJsonString(e,t){return new po().fromJsonString(e,t)}static equals(e,t){return Fe.util.equals(po,e,t)}}po.runtime=Fe;po.typeName="google.protobuf.Timestamp";po.fields=Fe.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const N7=Fe.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:po},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:O7,repeated:!0},{no:5,name:"events",kind:"message",T:B7,repeated:!0}]),O7=Fe.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:F7,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),F7=Fe.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:po},{no:3,name:"value",kind:"scalar",T:2}]),B7=Fe.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:po},{no:7,name:"normalized_end_timestamp",kind:"message",T:po,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),c_=Fe.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),ks=Fe.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),Gr=Fe.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),JC=Fe.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Xd=Fe.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),pf=Fe.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),Rs=Fe.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),cl=Fe.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),L7=Fe.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),li=Fe.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),eg=Fe.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:kp,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:b_}]),kp=Fe.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),U7=Fe.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:Fe.getEnumType(Gr),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),kl=Fe.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:Fe.getEnumType(bu)},{no:4,name:"tracks",kind:"message",T:gu,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:U7},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:Fe.getEnumType(gf)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:Fe.getEnumType(Rs)},{no:18,name:"kind_details",kind:"enum",T:Fe.getEnumType(j7),repeated:!0}]),bu=Fe.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),gf=Fe.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"}]),j7=Fe.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),Yr=Fe.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),V7=Fe.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Ec,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:Fe.getEnumType(l_)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),gu=Fe.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:Fe.getEnumType(ks)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:Fe.getEnumType(Gr)},{no:10,name:"layers",kind:"message",T:Ec,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:V7,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:Fe.getEnumType(Yr)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:b_},{no:19,name:"audio_features",kind:"enum",T:Fe.getEnumType(li),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:Fe.getEnumType(c_)}]),Ec=Fe.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:Fe.getEnumType(JC)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),l_=Fe.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),Hi=Fe.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:Fe.getEnumType(Sn)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:e1,oneof:"value"},{no:3,name:"speaker",kind:"message",T:G7,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:h_,oneof:"value"},{no:7,name:"transcription",kind:"message",T:W7,oneof:"value"},{no:8,name:"metrics",kind:"message",T:N7,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Ep,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:t1,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:n1,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:r1,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:Tp,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:_p,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:Rp,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:u_,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),Sn=Fe.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),u_=Fe.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:Fe.getEnumType(Yr)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),d_=Fe.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:e1,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:Ep,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:t1,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:n1,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:r1,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:Tp,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:_p,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:Rp,oneof:"value"}]),G7=Fe.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:f_,repeated:!0}]),f_=Fe.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),e1=Fe.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),h_=Fe.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),W7=Fe.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:z7,repeated:!0}]),z7=Fe.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),Ep=Fe.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),t1=Fe.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),n1=Fe.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),r1=Fe.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:p_,oneof:"value"}]),p_=Fe.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),g_=Fe.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),m_=Fe.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:Fe.getEnumType(v_)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),v_=Fe.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),y_=Fe.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:Fe.getEnumType(C_)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),C_=Fe.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),x_=Fe.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:MS},{no:2,name:"screen",kind:"message",T:MS},{no:3,name:"resume_connection",kind:"enum",T:Fe.getEnumType(pf)},{no:4,name:"disabled_codecs",kind:"message",T:H7},{no:5,name:"force_relay",kind:"enum",T:Fe.getEnumType(pf)}]),MS=Fe.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:Fe.getEnumType(pf)}]),H7=Fe.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:kp,repeated:!0},{no:2,name:"publish",kind:"message",T:kp,repeated:!0}]),b_=Fe.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),Ry=Fe.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),I_=Fe.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:Fe.getEnumType(Ry)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),w_=Fe.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),Tp=Fe.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:Fe.getEnumType(Yr)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:I_,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:w_,oneof:"content_header"}],{localName:"DataStream_Header"}),_p=Fe.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),Rp=Fe.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),Z7=Fe.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),Es=Fe.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),Dy=Fe.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),X7=Fe.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),$7=Fe.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Pc,oneof:"message"},{no:2,name:"answer",kind:"message",T:Pc,oneof:"message"},{no:3,name:"trickle",kind:"message",T:tg,oneof:"message"},{no:4,name:"add_track",kind:"message",T:mf,oneof:"message"},{no:5,name:"mute",kind:"message",T:ng,oneof:"message"},{no:6,name:"subscription",kind:"message",T:rg,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:S_,oneof:"message"},{no:8,name:"leave",kind:"message",T:ig,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:k_,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:__,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:c1,oneof:"message"},{no:13,name:"simulate",kind:"message",T:qs,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:s1,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:P_,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:o1,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:A_,oneof:"message"}]),NS=Fe.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:K7,oneof:"message"},{no:2,name:"answer",kind:"message",T:Pc,oneof:"message"},{no:3,name:"offer",kind:"message",T:Pc,oneof:"message"},{no:4,name:"trickle",kind:"message",T:tg,oneof:"message"},{no:5,name:"update",kind:"message",T:Q7,oneof:"message"},{no:6,name:"track_published",kind:"message",T:i1,oneof:"message"},{no:8,name:"leave",kind:"message",T:ig,oneof:"message"},{no:9,name:"mute",kind:"message",T:ng,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:J7,oneof:"message"},{no:11,name:"room_update",kind:"message",T:eU,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:nU,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:iU,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:sU,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:cU,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:Y7,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:q7,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:uU,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:hU,oneof:"message"},{no:22,name:"request_response",kind:"message",T:pU,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:gU,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:lU,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:CU,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:aU,oneof:"message"}]),Py=Fe.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Ec,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:Fe.getEnumType(l_)}]),mf=Fe.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:Fe.getEnumType(ks)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:Fe.getEnumType(Gr)},{no:9,name:"layers",kind:"message",T:Ec,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Py,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:Fe.getEnumType(Yr)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:Fe.getEnumType(c_)},{no:17,name:"audio_features",kind:"enum",T:Fe.getEnumType(li),repeated:!0}]),tg=Fe.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:Fe.getEnumType(Es)},{no:3,name:"final",kind:"scalar",T:8}]),ng=Fe.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),K7=Fe.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:eg},{no:2,name:"participant",kind:"message",T:kl},{no:3,name:"other_participants",kind:"message",T:kl,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:E_,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:x_},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:m_},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:kp,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),q7=Fe.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:E_,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:x_},{no:3,name:"server_info",kind:"message",T:m_},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),i1=Fe.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:gu}]),Y7=Fe.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Pc=Fe.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),Q7=Fe.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:kl,repeated:!0}]),rg=Fe.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:g_,repeated:!0}]),S_=Fe.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:Fe.getEnumType(JC)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),o1=Fe.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:Fe.getEnumType(li),repeated:!0}]),A_=Fe.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),ig=Fe.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:Fe.getEnumType(Rs)},{no:3,name:"action",kind:"enum",T:Fe.getEnumType(Iu)},{no:4,name:"regions",kind:"message",T:dU}]),Iu=Fe.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),k_=Fe.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Ec,repeated:!0}]),s1=Fe.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),E_=Fe.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),J7=Fe.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:f_,repeated:!0}]),eU=Fe.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:eg}]),tU=Fe.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:Fe.getEnumType(Xd)},{no:3,name:"score",kind:"scalar",T:2}]),nU=Fe.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:tU,repeated:!0}]),rU=Fe.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:Fe.getEnumType(Dy)}]),iU=Fe.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:rU,repeated:!0}]),a1=Fe.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:Fe.getEnumType(JC)},{no:2,name:"enabled",kind:"scalar",T:8}]),oU=Fe.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:a1,repeated:!0}]),sU=Fe.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:a1,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:oU,repeated:!0}]),aU=Fe.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:Z7,repeated:!0}]),T_=Fe.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),__=Fe.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:T_,repeated:!0}]),cU=Fe.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),lU=Fe.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:eg},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:kl},{no:4,name:"other_participants",kind:"message",T:kl,repeated:!0}]),c1=Fe.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Pc},{no:2,name:"subscription",kind:"message",T:rg},{no:3,name:"publish_tracks",kind:"message",T:i1,repeated:!0},{no:4,name:"data_channels",kind:"message",T:D_,repeated:!0},{no:5,name:"offer",kind:"message",T:Pc},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:R_,repeated:!0}]),R_=Fe.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),D_=Fe.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:Fe.getEnumType(Es)}]),qs=Fe.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:Fe.getEnumType(X7),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),P_=Fe.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),uU=Fe.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),dU=Fe.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:fU,repeated:!0}]),fU=Fe.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),hU=Fe.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:Fe.getEnumType(L7)}]),pU=Fe.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:Fe.getEnumType(l1)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:tg,oneof:"request"},{no:5,name:"add_track",kind:"message",T:mf,oneof:"request"},{no:6,name:"mute",kind:"message",T:ng,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:s1,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:o1,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:A_,oneof:"request"}]),l1=Fe.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"}]),gU=Fe.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),M_=Fe.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8}]),mU=Fe.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:y_},{no:2,name:"connection_settings",kind:"message",T:M_},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:mf,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:Pc},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:Fe.getEnumType(cl)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:c1}]),vU=Fe.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:Fe.getEnumType(yU)},{no:2,name:"join_request",kind:"scalar",T:12}]),yU=Fe.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),CU=Fe.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function xU(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var q0={exports:{}},bU=q0.exports,OS;function IU(){return OS||(OS=1,function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(bU,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},c=null;function s(x,w){var S=x[w];if(typeof S.bind=="function")return S.bind(x);try{return Function.prototype.bind.call(S,x)}catch{return function(){return Function.prototype.apply.apply(S,[x,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function d(x){return x==="debug"&&(x="log"),typeof console===t?!1:x==="trace"&&r?l:console[x]!==void 0?s(console,x):console.log!==void 0?s(console,"log"):e}function h(){for(var x=this.getLevel(),w=0;w<i.length;w++){var S=i[w];this[S]=w<x?e:this.methodFactory(S,x,this.name)}if(this.log=this.debug,typeof console===t&&x<this.levels.SILENT)return"No console available for logging"}function p(x){return function(){typeof console!==t&&(h.call(this),this[x].apply(this,arguments))}}function g(x,w,S){return d(x)||p.apply(this,arguments)}function y(x,w){var S=this,E,R,k,A="loglevel";typeof x=="string"?A+=":"+x:typeof x=="symbol"&&(A=void 0);function _(V){var X=(i[V]||"silent").toUpperCase();if(!(typeof window===t||!A)){try{window.localStorage[A]=X;return}catch{}try{window.document.cookie=encodeURIComponent(A)+"="+X+";"}catch{}}}function D(){var V;if(!(typeof window===t||!A)){try{V=window.localStorage[A]}catch{}if(typeof V===t)try{var X=window.document.cookie,te=encodeURIComponent(A),pe=X.indexOf(te+"=");pe!==-1&&(V=/^([^;]+)/.exec(X.slice(pe+te.length+1))[1])}catch{}return S.levels[V]===void 0&&(V=void 0),V}}function j(){if(!(typeof window===t||!A)){try{window.localStorage.removeItem(A)}catch{}try{window.document.cookie=encodeURIComponent(A)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function Z(V){var X=V;if(typeof X=="string"&&S.levels[X.toUpperCase()]!==void 0&&(X=S.levels[X.toUpperCase()]),typeof X=="number"&&X>=0&&X<=S.levels.SILENT)return X;throw new TypeError("log.setLevel() called with invalid level: "+V)}S.name=x,S.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},S.methodFactory=w||g,S.getLevel=function(){return k??R??E},S.setLevel=function(V,X){return k=Z(V),X!==!1&&_(k),h.call(S)},S.setDefaultLevel=function(V){R=Z(V),D()||S.setLevel(V,!1)},S.resetLevel=function(){k=null,j(),h.call(S)},S.enableAll=function(V){S.setLevel(S.levels.TRACE,V)},S.disableAll=function(V){S.setLevel(S.levels.SILENT,V)},S.rebuild=function(){if(c!==S&&(E=Z(c.getLevel())),h.call(S),c===S)for(var V in o)o[V].rebuild()},E=Z(c?c.getLevel():"WARN");var F=D();F!=null&&(k=Z(F)),h.call(S)}c=new y,c.getLogger=function(w){if(typeof w!="symbol"&&typeof w!="string"||w==="")throw new TypeError("You must supply a name when creating a logger.");var S=o[w];return S||(S=o[w]=new y(w,c.methodFactory)),S};var C=typeof window!==t?window.log:void 0;return c.noConflict=function(){return typeof window!==t&&window.log===c&&(window.log=C),c},c.getLoggers=function(){return o},c.default=c,c})}(q0)),q0.exports}var og=IU(),My;(function(n){n[n.trace=0]="trace",n[n.debug=1]="debug",n[n.info=2]="info",n[n.warn=3]="warn",n[n.error=4]="error",n[n.silent=5]="silent"})(My||(My={}));var Ps;(function(n){n.Default="livekit",n.Room="livekit-room",n.TokenSource="livekit-token-source",n.Participant="livekit-participant",n.Track="livekit-track",n.Publication="livekit-track-publication",n.Engine="livekit-engine",n.Signal="livekit-signal",n.PCManager="livekit-pc-manager",n.PCTransport="livekit-pc-transport",n.E2EE="lk-e2ee"})(Ps||(Ps={}));let gn=og.getLogger("livekit");Object.values(Ps).map(n=>og.getLogger(n));gn.setDefaultLevel(My.info);function Ua(n){const e=og.getLogger(n);return e.setDefaultLevel(gn.getLevel()),e}const wU=og.getLogger("lk-e2ee"),Od=7e3,SU=[0,300,2*2*300,3*3*300,4*4*300,Od,Od,Od,Od,Od];class AU{constructor(e){this._retryDelays=e!==void 0?[...e]:SU}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+Math.random()*1e3}}function kU(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function he(n,e,t,r){function i(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function s(h){try{d(r.next(h))}catch(p){c(p)}}function l(h){try{d(r.throw(h))}catch(p){c(p)}}function d(h){h.done?o(h.value):i(h.value).then(s,l)}d((r=r.apply(n,e||[])).next())})}function FS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ma(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof FS=="function"?FS(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(c){return new Promise(function(s,l){c=n[o](c),i(s,l,c.done,c.value)})}}function i(o,c,s,l){Promise.resolve(l).then(function(d){o({value:d,done:s})},c)}}var Hh={exports:{}},BS;function EU(){if(BS)return Hh.exports;BS=1;var n=typeof Reflect=="object"?Reflect:null,e=n&&typeof n.apply=="function"?n.apply:function(A,_,D){return Function.prototype.apply.call(A,_,D)},t;n&&typeof n.ownKeys=="function"?t=n.ownKeys:Object.getOwnPropertySymbols?t=function(A){return Object.getOwnPropertyNames(A).concat(Object.getOwnPropertySymbols(A))}:t=function(A){return Object.getOwnPropertyNames(A)};function r(k){console&&console.warn&&console.warn(k)}var i=Number.isNaN||function(A){return A!==A};function o(){o.init.call(this)}Hh.exports=o,Hh.exports.once=S,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var c=10;function s(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(k){if(typeof k!="number"||k<0||i(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");c=k}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(A){if(typeof A!="number"||A<0||i(A))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+A+".");return this._maxListeners=A,this};function l(k){return k._maxListeners===void 0?o.defaultMaxListeners:k._maxListeners}o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(A){for(var _=[],D=1;D<arguments.length;D++)_.push(arguments[D]);var j=A==="error",Z=this._events;if(Z!==void 0)j=j&&Z.error===void 0;else if(!j)return!1;if(j){var F;if(_.length>0&&(F=_[0]),F instanceof Error)throw F;var V=new Error("Unhandled error."+(F?" ("+F.message+")":""));throw V.context=F,V}var X=Z[A];if(X===void 0)return!1;if(typeof X=="function")e(X,this,_);else for(var te=X.length,pe=C(X,te),D=0;D<te;++D)e(pe[D],this,_);return!0};function d(k,A,_,D){var j,Z,F;if(s(_),Z=k._events,Z===void 0?(Z=k._events=Object.create(null),k._eventsCount=0):(Z.newListener!==void 0&&(k.emit("newListener",A,_.listener?_.listener:_),Z=k._events),F=Z[A]),F===void 0)F=Z[A]=_,++k._eventsCount;else if(typeof F=="function"?F=Z[A]=D?[_,F]:[F,_]:D?F.unshift(_):F.push(_),j=l(k),j>0&&F.length>j&&!F.warned){F.warned=!0;var V=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+String(A)+" listeners added. Use emitter.setMaxListeners() to increase limit");V.name="MaxListenersExceededWarning",V.emitter=k,V.type=A,V.count=F.length,r(V)}return k}o.prototype.addListener=function(A,_){return d(this,A,_,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(A,_){return d(this,A,_,!0)};function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(k,A,_){var D={fired:!1,wrapFn:void 0,target:k,type:A,listener:_},j=h.bind(D);return j.listener=_,D.wrapFn=j,j}o.prototype.once=function(A,_){return s(_),this.on(A,p(this,A,_)),this},o.prototype.prependOnceListener=function(A,_){return s(_),this.prependListener(A,p(this,A,_)),this},o.prototype.removeListener=function(A,_){var D,j,Z,F,V;if(s(_),j=this._events,j===void 0)return this;if(D=j[A],D===void 0)return this;if(D===_||D.listener===_)--this._eventsCount===0?this._events=Object.create(null):(delete j[A],j.removeListener&&this.emit("removeListener",A,D.listener||_));else if(typeof D!="function"){for(Z=-1,F=D.length-1;F>=0;F--)if(D[F]===_||D[F].listener===_){V=D[F].listener,Z=F;break}if(Z<0)return this;Z===0?D.shift():x(D,Z),D.length===1&&(j[A]=D[0]),j.removeListener!==void 0&&this.emit("removeListener",A,V||_)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(A){var _,D,j;if(D=this._events,D===void 0)return this;if(D.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):D[A]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete D[A]),this;if(arguments.length===0){var Z=Object.keys(D),F;for(j=0;j<Z.length;++j)F=Z[j],F!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(_=D[A],typeof _=="function")this.removeListener(A,_);else if(_!==void 0)for(j=_.length-1;j>=0;j--)this.removeListener(A,_[j]);return this};function g(k,A,_){var D=k._events;if(D===void 0)return[];var j=D[A];return j===void 0?[]:typeof j=="function"?_?[j.listener||j]:[j]:_?w(j):C(j,j.length)}o.prototype.listeners=function(A){return g(this,A,!0)},o.prototype.rawListeners=function(A){return g(this,A,!1)},o.listenerCount=function(k,A){return typeof k.listenerCount=="function"?k.listenerCount(A):y.call(k,A)},o.prototype.listenerCount=y;function y(k){var A=this._events;if(A!==void 0){var _=A[k];if(typeof _=="function")return 1;if(_!==void 0)return _.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function C(k,A){for(var _=new Array(A),D=0;D<A;++D)_[D]=k[D];return _}function x(k,A){for(;A+1<k.length;A++)k[A]=k[A+1];k.pop()}function w(k){for(var A=new Array(k.length),_=0;_<A.length;++_)A[_]=k[_].listener||k[_];return A}function S(k,A){return new Promise(function(_,D){function j(F){k.removeListener(A,Z),D(F)}function Z(){typeof k.removeListener=="function"&&k.removeListener("error",j),_([].slice.call(arguments))}R(k,A,Z,{once:!0}),A!=="error"&&E(k,j,{once:!0})})}function E(k,A,_){typeof k.on=="function"&&R(k,"error",A,_)}function R(k,A,_,D){if(typeof k.on=="function")D.once?k.once(A,_):k.on(A,_);else if(typeof k.addEventListener=="function")k.addEventListener(A,function j(Z){D.once&&k.removeEventListener(A,j),_(Z)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}return Hh.exports}var ca=EU();let N_=!0,O_=!0;function $d(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseFloat(r[t],10)}function Ll(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(c,s){if(c!==e)return i.apply(this,arguments);const l=d=>{const h=t(d);h&&(s.handleEvent?s.handleEvent(h):s(h))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(s,l),i.apply(this,[c,l])};const o=r.removeEventListener;r.removeEventListener=function(c,s){if(c!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(s))return o.apply(this,arguments);const l=this._eventMap[e].get(s);return this._eventMap[e].delete(s),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[c,l])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(c){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),c&&this.addEventListener(e,this["_on"+e]=c)},enumerable:!0,configurable:!0})}function TU(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(N_=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function _U(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(O_=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function F_(){if(typeof window=="object"){if(N_)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function u1(n,e){O_&&console.warn(n+" is deprecated, please use "+e+" instead.")}function RU(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.userAgentData&&t.userAgentData.brands){const r=t.userAgentData.brands.find(i=>i.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt($d(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt($d(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt($d(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype,e._safariVersion=$d(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function LS(n){return Object.prototype.toString.call(n)==="[object Object]"}function B_(n){return LS(n)?Object.keys(n).reduce(function(e,t){const r=LS(n[t]),i=r?B_(n[t]):n[t],o=r&&!Object.keys(i).length;return i===void 0||o?e:Object.assign(e,{[t]:i})},{}):n}function Ny(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Ny(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(i=>{Ny(n,n.get(i),t)})}))}function US(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const o=[];return n.forEach(c=>{c.type==="track"&&c.trackIdentifier===e.id&&o.push(c)}),o.forEach(c=>{n.forEach(s=>{s.type===r&&s.trackId===c.id&&Ny(n,s,i)})}),i}const jS=F_;function L_(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const r=function(s){if(typeof s!="object"||s.mandatory||s.optional)return s;const l={};return Object.keys(s).forEach(d=>{if(d==="require"||d==="advanced"||d==="mediaSource")return;const h=typeof s[d]=="object"?s[d]:{ideal:s[d]};h.exact!==void 0&&typeof h.exact=="number"&&(h.min=h.max=h.exact);const p=function(g,y){return g?g+y.charAt(0).toUpperCase()+y.slice(1):y==="deviceId"?"sourceId":y};if(h.ideal!==void 0){l.optional=l.optional||[];let g={};typeof h.ideal=="number"?(g[p("min",d)]=h.ideal,l.optional.push(g),g={},g[p("max",d)]=h.ideal,l.optional.push(g)):(g[p("",d)]=h.ideal,l.optional.push(g))}h.exact!==void 0&&typeof h.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[p("",d)]=h.exact):["min","max"].forEach(g=>{h[g]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[p(g,d)]=h[g])})}),s.advanced&&(l.optional=(l.optional||[]).concat(s.advanced)),l},i=function(s,l){if(e.version>=61)return l(s);if(s=JSON.parse(JSON.stringify(s)),s&&typeof s.audio=="object"){const d=function(h,p,g){p in h&&!(g in h)&&(h[g]=h[p],delete h[p])};s=JSON.parse(JSON.stringify(s)),d(s.audio,"autoGainControl","googAutoGainControl"),d(s.audio,"noiseSuppression","googNoiseSuppression"),s.audio=r(s.audio)}if(s&&typeof s.video=="object"){let d=s.video.facingMode;d=d&&(typeof d=="object"?d:{ideal:d});const h=e.version<66;if(d&&(d.exact==="user"||d.exact==="environment"||d.ideal==="user"||d.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!h)){delete s.video.facingMode;let p;if(d.exact==="environment"||d.ideal==="environment"?p=["back","rear"]:(d.exact==="user"||d.ideal==="user")&&(p=["front"]),p)return t.mediaDevices.enumerateDevices().then(g=>{g=g.filter(C=>C.kind==="videoinput");let y=g.find(C=>p.some(x=>C.label.toLowerCase().includes(x)));return!y&&g.length&&p.includes("back")&&(y=g[g.length-1]),y&&(s.video.deviceId=d.exact?{exact:y.deviceId}:{ideal:y.deviceId}),s.video=r(s.video),jS("chrome: "+JSON.stringify(s)),l(s)})}s.video=r(s.video)}return jS("chrome: "+JSON.stringify(s)),l(s)},o=function(s){return e.version>=64?s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[s.name]||s.name,message:s.message,constraint:s.constraint||s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},c=function(s,l,d){i(s,h=>{t.webkitGetUserMedia(h,l,p=>{d&&d(o(p))})})};if(t.getUserMedia=c.bind(t),t.mediaDevices.getUserMedia){const s=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(l){return i(l,d=>s(d).then(h=>{if(d.audio&&!h.getAudioTracks().length||d.video&&!h.getVideoTracks().length)throw h.getTracks().forEach(p=>{p.stop()}),new DOMException("","NotFoundError");return h},h=>Promise.reject(o(h))))}}}function U_(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function j_(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let o;n.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(s=>s.track&&s.track.id===i.track.id):o={track:i.track};const c=new Event("track");c.track=i.track,c.receiver=o,c.transceiver={receiver:o},c.streams=[r.stream],this.dispatchEvent(c)}),r.stream.getTracks().forEach(i=>{let o;n.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(s=>s.track&&s.track.id===i.id):o={track:i};const c=new Event("track");c.track=i,c.receiver=o,c.transceiver={receiver:o},c.streams=[r.stream],this.dispatchEvent(c)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Ll(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function V_(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(s,l){let d=i.apply(this,arguments);return d||(d=e(this,s),this._senders.push(d)),d};const o=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(s){o.apply(this,arguments);const l=this._senders.indexOf(s);l!==-1&&this._senders.splice(l,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],t.apply(this,[o]),o.getTracks().forEach(c=>{this._senders.push(e(this,c))})};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(c=>{const s=this._senders.find(l=>l.track===c);s&&this._senders.splice(this._senders.indexOf(s),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function G_(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const o=t.apply(this,[]);return o.forEach(c=>c._pc=this),o});const r=n.RTCPeerConnection.prototype.addTrack;r&&(n.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),n.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(c=>US(c,o.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const i=t.apply(this,[]);return i.forEach(o=>o._pc=this),i}),Ll(n,"track",r=>(r.receiver._pc=r.srcElement,r)),n.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>US(o,i.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const r=arguments[0];let i,o,c;return this.getSenders().forEach(s=>{s.track===r&&(i?c=!0:i=s)}),this.getReceivers().forEach(s=>(s.track===r&&(o?c=!0:o=s),s.track===r)),c||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function W_(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(c=>this._shimmedLocalStreams[c][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(c,s){if(!s)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=e.apply(this,arguments);return this._shimmedLocalStreams[s.id]?this._shimmedLocalStreams[s.id].indexOf(l)===-1&&this._shimmedLocalStreams[s.id].push(l):this._shimmedLocalStreams[s.id]=[s,l],l};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(c){this._shimmedLocalStreams=this._shimmedLocalStreams||{},c.getTracks().forEach(d=>{if(this.getSenders().find(p=>p.track===d))throw new DOMException("Track already exists.","InvalidAccessError")});const s=this.getSenders();t.apply(this,arguments);const l=this.getSenders().filter(d=>s.indexOf(d)===-1);this._shimmedLocalStreams[c.id]=[c].concat(l)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[c.id],r.apply(this,arguments)};const i=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},c&&Object.keys(this._shimmedLocalStreams).forEach(s=>{const l=this._shimmedLocalStreams[s].indexOf(c);l!==-1&&this._shimmedLocalStreams[s].splice(l,1),this._shimmedLocalStreams[s].length===1&&delete this._shimmedLocalStreams[s]}),i.apply(this,arguments)}}function z_(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return W_(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const h=t.apply(this);return this._reverseStreams=this._reverseStreams||{},h.map(p=>this._reverseStreams[p.id])};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(h){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},h.getTracks().forEach(p=>{if(this.getSenders().find(y=>y.track===p))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[h.id]){const p=new n.MediaStream(h.getTracks());this._streams[h.id]=p,this._reverseStreams[p.id]=h,h=p}r.apply(this,[h])};const i=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(h){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[h.id]||h]),delete this._reverseStreams[this._streams[h.id]?this._streams[h.id].id:h.id],delete this._streams[h.id]},n.RTCPeerConnection.prototype.addTrack=function(h,p){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const g=[].slice.call(arguments,1);if(g.length!==1||!g[0].getTracks().find(x=>x===h))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(x=>x.track===h))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const C=this._streams[p.id];if(C)C.addTrack(h),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const x=new n.MediaStream([h]);this._streams[p.id]=x,this._reverseStreams[x.id]=p,this.addStream(x)}return this.getSenders().find(x=>x.track===h)};function o(d,h){let p=h.sdp;return Object.keys(d._reverseStreams||[]).forEach(g=>{const y=d._reverseStreams[g],C=d._streams[y.id];p=p.replace(new RegExp(C.id,"g"),y.id)}),new RTCSessionDescription({type:h.type,sdp:p})}function c(d,h){let p=h.sdp;return Object.keys(d._reverseStreams||[]).forEach(g=>{const y=d._reverseStreams[g],C=d._streams[y.id];p=p.replace(new RegExp(y.id,"g"),C.id)}),new RTCSessionDescription({type:h.type,sdp:p})}["createOffer","createAnswer"].forEach(function(d){const h=n.RTCPeerConnection.prototype[d],p={[d](){const g=arguments;return arguments.length&&typeof arguments[0]=="function"?h.apply(this,[C=>{const x=o(this,C);g[0].apply(null,[x])},C=>{g[1]&&g[1].apply(null,C)},arguments[2]]):h.apply(this,arguments).then(C=>o(this,C))}};n.RTCPeerConnection.prototype[d]=p[d]});const s=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?s.apply(this,arguments):(arguments[0]=c(this,arguments[0]),s.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const d=l.get.apply(this);return d.type===""?d:o(this,d)}}),n.RTCPeerConnection.prototype.removeTrack=function(h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!h._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(h._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let g;Object.keys(this._streams).forEach(y=>{this._streams[y].getTracks().find(x=>h.track===x)&&(g=this._streams[y])}),g&&(g.getTracks().length===1?this.removeStream(this._reverseStreams[g.id]):g.removeTrack(h.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Oy(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=n.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=i[t]})}function H_(n,e){Ll(n,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}var VS=Object.freeze({__proto__:null,fixNegotiationNeeded:H_,shimAddTrackRemoveTrack:z_,shimAddTrackRemoveTrackWithNative:W_,shimGetSendersWithDtmf:V_,shimGetUserMedia:L_,shimMediaStream:U_,shimOnTrack:j_,shimPeerConnection:Oy,shimSenderReceiverGetStats:G_});function Z_(n,e){const t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(i,o,c){u1("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(i).then(o,c)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const i=function(c,s,l){s in c&&!(l in c)&&(c[l]=c[s],delete c[s])},o=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(c){return typeof c=="object"&&typeof c.audio=="object"&&(c=JSON.parse(JSON.stringify(c)),i(c.audio,"autoGainControl","mozAutoGainControl"),i(c.audio,"noiseSuppression","mozNoiseSuppression")),o(c)},r&&r.prototype.getSettings){const c=r.prototype.getSettings;r.prototype.getSettings=function(){const s=c.apply(this,arguments);return i(s,"mozAutoGainControl","autoGainControl"),i(s,"mozNoiseSuppression","noiseSuppression"),s}}if(r&&r.prototype.applyConstraints){const c=r.prototype.applyConstraints;r.prototype.applyConstraints=function(s){return this.kind==="audio"&&typeof s=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s,"autoGainControl","mozAutoGainControl"),i(s,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[s])}}}}function DU(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(r)})}function X_(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Fy(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=n.RTCPeerConnection.prototype[i],c={[i](){return arguments[0]=new(i==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};n.RTCPeerConnection.prototype[i]=c[i]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[o,c,s]=arguments;return r.apply(this,[o||null]).then(l=>{if(e.version<53&&!c)try{l.forEach(d=>{d.type=t[d.type]||d.type})}catch(d){if(d.name!=="TypeError")throw d;l.forEach((h,p)=>{l.set(p,Object.assign({},h,{type:t[h.type]||h.type}))})}return l}).then(c,s)}}function $_(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const i=t.apply(this,arguments);return i._pc=this,i}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function K_(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Ll(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function q_(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){u1("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function Y_(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function Q_(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(c=>{if("rid"in c&&!/^[a-z0-9]{0,16}$/i.test(c.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in c&&!(parseFloat(c.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in c&&!(parseFloat(c.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(i){const{sender:c}=o,s=c.getParameters();(!("encodings"in s)||s.encodings.length===1&&Object.keys(s.encodings[0]).length===0)&&(s.encodings=r,c.sendEncodings=r,this.setParametersPromises.push(c.setParameters(s).then(()=>{delete c.sendEncodings}).catch(()=>{delete c.sendEncodings})))}return o})}function J_(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function e2(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function t2(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var GS=Object.freeze({__proto__:null,shimAddTransceiver:Q_,shimCreateAnswer:t2,shimCreateOffer:e2,shimGetDisplayMedia:DU,shimGetParameters:J_,shimGetUserMedia:Z_,shimOnTrack:X_,shimPeerConnection:Fy,shimRTCDataChannel:Y_,shimReceiverGetStats:K_,shimRemoveStream:q_,shimSenderGetStats:$_});function n2(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},n.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),c=1;c<i;c++)o[c-1]=arguments[c];return o&&o.forEach(s=>{this._localStreams?this._localStreams.includes(s)||this._localStreams.push(s):this._localStreams=[s]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const i=t.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function r2(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const c=new Event("addstream");c.stream=o,r.dispatchEvent(c)})}),e.apply(r,arguments)}}}function i2(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,o=e.setRemoteDescription,c=e.addIceCandidate;e.createOffer=function(d,h){const p=arguments.length>=2?arguments[2]:arguments[0],g=t.apply(this,[p]);return h?(g.then(d,h),Promise.resolve()):g},e.createAnswer=function(d,h){const p=arguments.length>=2?arguments[2]:arguments[0],g=r.apply(this,[p]);return h?(g.then(d,h),Promise.resolve()):g};let s=function(l,d,h){const p=i.apply(this,[l]);return h?(p.then(d,h),Promise.resolve()):p};e.setLocalDescription=s,s=function(l,d,h){const p=o.apply(this,[l]);return h?(p.then(d,h),Promise.resolve()):p},e.setRemoteDescription=s,s=function(l,d,h){const p=c.apply(this,[l]);return h?(p.then(d,h),Promise.resolve()):p},e.addIceCandidate=s}function o2(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=i=>r(s2(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,o){e.mediaDevices.getUserMedia(r).then(i,o)}).bind(e))}function s2(n){return n&&n.video!==void 0?Object.assign({},n,{video:B_(n.video)}):n}function a2(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const o=[];for(let c=0;c<r.iceServers.length;c++){let s=r.iceServers[c];s.urls===void 0&&s.url?(u1("RTCIceServer.url","RTCIceServer.urls"),s=JSON.parse(JSON.stringify(s)),s.urls=s.url,delete s.url,o.push(s)):o.push(r.iceServers[c])}r.iceServers=o}return new e(r,i)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function c2(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function l2(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(c=>c.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(c=>c.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function u2(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}var WS=Object.freeze({__proto__:null,shimAudioContext:u2,shimCallbacksAPI:i2,shimConstraints:s2,shimCreateOfferLegacy:l2,shimGetUserMedia:o2,shimLocalStreamsAPI:n2,shimRTCIceServerUrls:a2,shimRemoteStreamsAPI:r2,shimTrackEventTransceiver:c2}),Cv={exports:{}},zS;function PU(){return zS||(zS=1,function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":i.relatedAddress=r[o+1];break;case"rport":i.relatedPort=parseInt(r[o+1],10);break;case"tcptype":i.tcpType=r[o+1];break;case"ufrag":i.ufrag=r[o+1],i.usernameFragment=r[o+1];break;default:i[r[o]]===void 0&&(i[r[o]]=r[o+1]);break}return i},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const i=t.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const o=t.type;return r.push("typ"),r.push(o),o!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let i;const o=t.substring(t.indexOf(" ")+1).split(";");for(let c=0;c<o.length;c++)i=o[c].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(t){let r="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const o=[];Object.keys(t.parameters).forEach(c=>{t.parameters[c]!==void 0?o.push(c+"="+t.parameters[c]):o.push(c)}),r+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),i={ssrc:parseInt(t.substring(7,r),10)},o=t.indexOf(":",r);return o>-1?(i.attribute=t.substring(r+1,o),i.value=t.substring(o+1)):i.attribute=t.substring(r+1),i},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let i="a=setup:"+r+`\r
`;return t.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const i=e.matchPrefix(t+r,"a=ice-ufrag:")[0],o=e.matchPrefix(t+r,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(t)[0].split(" ");r.profile=o[2];for(let s=3;s<o.length;s++){const l=o[s],d=e.matchPrefix(t,"a=rtpmap:"+l+" ")[0];if(d){const h=e.parseRtpMap(d),p=e.matchPrefix(t,"a=fmtp:"+l+" ");switch(h.parameters=p.length?e.parseFmtp(p[0]):{},h.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb),r.codecs.push(h),h.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(h.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(s=>{r.headerExtensions.push(e.parseExtmap(s))});const c=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(s=>{c.forEach(l=>{s.rtcpFeedback.find(h=>h.type===l.type&&h.parameter===l.parameter)||s.rtcpFeedback.push(l)})}),r},e.writeRtpDescription=function(t,r){let i="";i+="m="+t+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(c=>c.preferredPayloadType!==void 0?c.preferredPayloadType:c.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(c=>{i+=e.writeRtpMap(c),i+=e.writeFmtp(c),i+=e.writeRtcpFb(c)});let o=0;return r.codecs.forEach(c=>{c.maxptime>o&&(o=c.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(c=>{i+=e.writeExtmap(c)}),i},e.parseRtpEncodingParameters=function(t){const r=[],i=e.parseRtpParameters(t),o=i.fecMechanisms.indexOf("RED")!==-1,c=i.fecMechanisms.indexOf("ULPFEC")!==-1,s=e.matchPrefix(t,"a=ssrc:").map(g=>e.parseSsrcMedia(g)).filter(g=>g.attribute==="cname"),l=s.length>0&&s[0].ssrc;let d;const h=e.matchPrefix(t,"a=ssrc-group:FID").map(g=>g.substring(17).split(" ").map(C=>parseInt(C,10)));h.length>0&&h[0].length>1&&h[0][0]===l&&(d=h[0][1]),i.codecs.forEach(g=>{if(g.name.toUpperCase()==="RTX"&&g.parameters.apt){let y={ssrc:l,codecPayloadType:parseInt(g.parameters.apt,10)};l&&d&&(y.rtx={ssrc:d}),r.push(y),o&&(y=JSON.parse(JSON.stringify(y)),y.fec={ssrc:l,mechanism:c?"red+ulpfec":"red"},r.push(y))}}),r.length===0&&l&&r.push({ssrc:l});let p=e.matchPrefix(t,"b=");return p.length&&(p[0].indexOf("b=TIAS:")===0?p=parseInt(p[0].substring(7),10):p[0].indexOf("b=AS:")===0?p=parseInt(p[0].substring(5),10)*1e3*.95-50*40*8:p=void 0,r.forEach(g=>{g.maxBitrate=p})),r},e.parseRtcpParameters=function(t){const r={},i=e.matchPrefix(t,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const o=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const c=e.matchPrefix(t,"a=rtcp-mux");return r.mux=c.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const i=e.matchPrefix(t,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=e.matchPrefix(t,"a=ssrc:").map(c=>e.parseSsrcMedia(c)).filter(c=>c.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),i=e.matchPrefix(t,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const c=e.matchPrefix(t,"a=sctp-port:");if(c.length>0)return{port:parseInt(c[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const s=e.matchPrefix(t,"a=sctpmap:");if(s.length>0){const l=s[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:o}}},e.writeSctpDescription=function(t,r){let i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,i){let o;const c=r!==void 0?r:2;return t?o=t:o=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+c+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const i=e.splitLines(t);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const i=e.splitLines(t)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(t){const i=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},n.exports=e}(Cv)),Cv.exports}var d2=PU(),wu=xU(d2),MU=G9({__proto__:null,default:wu},[d2]);function Y0(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),o=wu.parseCandidate(r.candidate);for(const c in o)c in i||Object.defineProperty(i,c,{value:o[c]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},n.RTCIceCandidate.prototype=e.prototype,Ll(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function By(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||Ll(n,"icecandidate",e=>{if(e.candidate){const t=wu.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function Q0(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(s){if(!s||!s.sdp)return!1;const l=wu.splitSections(s.sdp);return l.shift(),l.some(d=>{const h=wu.parseMLine(d);return h&&h.kind==="application"&&h.protocol.indexOf("SCTP")!==-1})},r=function(s){const l=s.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const d=parseInt(l[1],10);return d!==d?-1:d},i=function(s){let l=65536;return e.browser==="firefox"&&(e.version<57?s===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},o=function(s,l){let d=65536;e.browser==="firefox"&&e.version===57&&(d=65535);const h=wu.matchPrefix(s.sdp,"a=max-message-size:");return h.length>0?d=parseInt(h[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(d=2147483637),d},c=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const l=r(arguments[0]),d=i(l),h=o(arguments[0],l);let p;d===0&&h===0?p=Number.POSITIVE_INFINITY:d===0||h===0?p=Math.max(d,h):p=Math.min(d,h);const g={};Object.defineProperty(g,"maxMessageSize",{get(){return p}}),this._sctp=g}return c.apply(this,arguments)}}function J0(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(r,i){const o=r.send;r.send=function(){const s=arguments[0],l=s.length||s.size||s.byteLength;if(r.readyState==="open"&&i.sctp&&l>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const i=t.apply(this,arguments);return e(i,this),i},Ll(n,"datachannel",r=>(e(r.channel,r.target),r))}function Ly(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const c=new Event("connectionstatechange",i);o.dispatchEvent(c)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Uy(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(c=>c.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&i instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return t.apply(this,arguments)}}function ep(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function tp(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return t.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?t.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(c=>t.apply(this,[c]))})}var NU=Object.freeze({__proto__:null,removeExtmapAllowMixed:Uy,shimAddIceCandidateNullOrEmpty:ep,shimConnectionState:Ly,shimMaxMessageSize:Q0,shimParameterlessSetLocalDescription:tp,shimRTCIceCandidate:Y0,shimRTCIceCandidateRelayProtocol:By,shimSendThrowTypeError:J0});function OU(){let{window:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const t=F_,r=RU(n),i={browserDetails:r,commonShim:NU,extractVersion:$d,disableLog:TU,disableWarnings:_U,sdp:MU};switch(r.browser){case"chrome":if(!VS||!Oy||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),i;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),i;t("adapter.js shimming chrome."),i.browserShim=VS,ep(n,r),tp(n),L_(n,r),U_(n),Oy(n,r),j_(n),z_(n,r),V_(n),G_(n),H_(n,r),Y0(n),By(n),Ly(n),Q0(n,r),J0(n),Uy(n,r);break;case"firefox":if(!GS||!Fy||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),i;t("adapter.js shimming firefox."),i.browserShim=GS,ep(n,r),tp(n),Z_(n,r),Fy(n,r),X_(n),q_(n),$_(n),K_(n),Y_(n),Q_(n),J_(n),e2(n),t2(n),Y0(n),Ly(n),Q0(n,r),J0(n);break;case"safari":if(!WS||!e.shimSafari)return t("Safari shim is not included in this adapter release."),i;t("adapter.js shimming safari."),i.browserShim=WS,ep(n,r),tp(n),a2(n),l2(n),i2(n),n2(n),r2(n),c2(n),o2(n),u2(n),Y0(n),By(n),Q0(n,r),J0(n),Uy(n,r);break;default:t("Unsupported browser!");break}return i}OU({window:typeof window>"u"?void 0:window});class go extends Promise{constructor(e){super(e)}catch(e){return super.catch(e)}static reject(e){return super.reject(e)}static all(e){return super.all(e)}static race(e){return super.race(e)}}const FU=/version\/(\d+(\.?_?\d+)+)/i;let xv;function Ki(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const t=navigator.userAgent.toLowerCase();if(xv===void 0||e){const r=BU.find(i=>{let{test:o}=i;return o.test(t)});xv=r==null?void 0:r.describe(t)}return xv}const BU=[{test:/firefox|iceweasel|fxios/i,describe(n){return{name:"Firefox",version:np(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:bv(n)}}},{test:/chrom|crios|crmo/i,describe(n){return{name:"Chrome",version:np(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("crios")?"iOS":void 0,osVersion:bv(n)}}},{test:/safari|applewebkit/i,describe(n){return{name:"Safari",version:np(FU,n),os:n.includes("mobile/")?"iOS":"macOS",osVersion:bv(n)}}}];function np(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(n);return r&&r.length>=t&&r[t]||""}function bv(n){return n.includes("mac os")?np(/\(.+?(\d+_\d+(:?_\d+)?)/,n,1).replace(/_/g,"."):void 0}var LU="2.17.0";const UU=LU,jU=16;class la extends Error{constructor(e,t){super(t||"an error has occured"),this.name="LiveKitError",this.code=e}}var Kn;(function(n){n[n.NotAllowed=0]="NotAllowed",n[n.ServerUnreachable=1]="ServerUnreachable",n[n.InternalError=2]="InternalError",n[n.Cancelled=3]="Cancelled",n[n.LeaveRequest=4]="LeaveRequest",n[n.Timeout=5]="Timeout",n[n.WebSocket=6]="WebSocket",n[n.ServiceNotFound=7]="ServiceNotFound"})(Kn||(Kn={}));class tn extends la{constructor(e,t,r,i){super(1,e),this.name="ConnectionError",this.status=r,this.reason=t,this.context=i,this.reasonName=Kn[t]}static notAllowed(e,t,r){return new tn(e,Kn.NotAllowed,t,r)}static timeout(e){return new tn(e,Kn.Timeout)}static leaveRequest(e,t){return new tn(e,Kn.LeaveRequest,void 0,t)}static internal(e,t){return new tn(e,Kn.InternalError,void 0,t)}static cancelled(e){return new tn(e,Kn.Cancelled)}static serverUnreachable(e,t){return new tn(e,Kn.ServerUnreachable,t)}static websocket(e,t,r){return new tn(e,Kn.WebSocket,t,r)}static serviceNotFound(e,t){return new tn(e,Kn.ServiceNotFound,void 0,t)}}class d1 extends la{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class Na extends la{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class VU extends la{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class Or extends la{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Su extends la{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class HS extends la{constructor(e,t){super(15,e),this.name="PublishTrackError",this.status=t}}class ZS extends la{constructor(e,t){super(15,e),this.name="SignalRequestError",this.reason=t,this.reasonName=typeof t=="string"?t:l1[t]}}var Wi;(function(n){n[n.AlreadyOpened=0]="AlreadyOpened",n[n.AbnormalEnd=1]="AbnormalEnd",n[n.DecodeFailed=2]="DecodeFailed",n[n.LengthExceeded=3]="LengthExceeded",n[n.Incomplete=4]="Incomplete",n[n.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",n[n.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"})(Wi||(Wi={}));class Qo extends la{constructor(e,t){super(16,e),this.name="DataStreamError",this.reason=t,this.reasonName=Wi[t]}}class hu extends la{constructor(e){super(18,e),this.name="SignalReconnectError"}}var vf;(function(n){n.PermissionDenied="PermissionDenied",n.NotFound="NotFound",n.DeviceInUse="DeviceInUse",n.Other="Other"})(vf||(vf={}));(function(n){function e(t){if(t&&"name"in t)return t.name==="NotFoundError"||t.name==="DevicesNotFoundError"?n.NotFound:t.name==="NotAllowedError"||t.name==="PermissionDeniedError"?n.PermissionDenied:t.name==="NotReadableError"||t.name==="TrackStartError"?n.DeviceInUse:n.Other}n.getFailure=e})(vf||(vf={}));class yi{}yi.setTimeout=function(){return setTimeout(...arguments)};yi.setInterval=function(){return setInterval(...arguments)};yi.clearTimeout=function(){return clearTimeout(...arguments)};yi.clearInterval=function(){return clearInterval(...arguments)};var We;(function(n){n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting",n.Reconnected="reconnected",n.Disconnected="disconnected",n.ConnectionStateChanged="connectionStateChanged",n.Moved="moved",n.MediaDevicesChanged="mediaDevicesChanged",n.ParticipantConnected="participantConnected",n.ParticipantDisconnected="participantDisconnected",n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalAudioSilenceDetected="localAudioSilenceDetected",n.ActiveSpeakersChanged="activeSpeakersChanged",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.ParticipantAttributesChanged="participantAttributesChanged",n.ParticipantActive="participantActive",n.RoomMetadataChanged="roomMetadataChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.AudioPlaybackStatusChanged="audioPlaybackChanged",n.VideoPlaybackStatusChanged="videoPlaybackChanged",n.MediaDevicesError="mediaDevicesError",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.SignalConnected="signalConnected",n.RecordingStatusChanged="recordingStatusChanged",n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ActiveDeviceChanged="activeDeviceChanged",n.ChatMessage="chatMessage",n.LocalTrackSubscribed="localTrackSubscribed",n.MetricsReceived="metricsReceived"})(We||(We={}));var $e;(function(n){n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalTrackCpuConstrained="localTrackCpuConstrained",n.LocalSenderCreated="localSenderCreated",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.IsSpeakingChanged="isSpeakingChanged",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.TrackCpuConstrained="trackCpuConstrained",n.MediaDevicesError="mediaDevicesError",n.AudioStreamAcquired="audioStreamAcquired",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.PCTrackAdded="pcTrackAdded",n.AttributesChanged="attributesChanged",n.LocalTrackSubscribed="localTrackSubscribed",n.ChatMessage="chatMessage",n.Active="active"})($e||($e={}));var vt;(function(n){n.TransportsCreated="transportsCreated",n.Connected="connected",n.Disconnected="disconnected",n.Resuming="resuming",n.Resumed="resumed",n.Restarting="restarting",n.Restarted="restarted",n.SignalResumed="signalResumed",n.SignalRestarted="signalRestarted",n.Closing="closing",n.MediaTrackAdded="mediaTrackAdded",n.ActiveSpeakersUpdate="activeSpeakersUpdate",n.DataPacketReceived="dataPacketReceived",n.RTPVideoMapUpdate="rtpVideoMapUpdate",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ParticipantUpdate="participantUpdate",n.RoomUpdate="roomUpdate",n.SpeakersChanged="speakersChanged",n.StreamStateChanged="streamStateChanged",n.ConnectionQualityUpdate="connectionQualityUpdate",n.SubscriptionError="subscriptionError",n.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",n.RemoteMute="remoteMute",n.SubscribedQualityUpdate="subscribedQualityUpdate",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalTrackSubscribed="localTrackSubscribed",n.Offline="offline",n.SignalRequestResponse="signalRequestResponse",n.SignalConnected="signalConnected",n.RoomMoved="roomMoved"})(vt||(vt={}));var ht;(function(n){n.Message="message",n.Muted="muted",n.Unmuted="unmuted",n.Restarted="restarted",n.Ended="ended",n.Subscribed="subscribed",n.Unsubscribed="unsubscribed",n.CpuConstrained="cpuConstrained",n.UpdateSettings="updateSettings",n.UpdateSubscription="updateSubscription",n.AudioPlaybackStarted="audioPlaybackStarted",n.AudioPlaybackFailed="audioPlaybackFailed",n.AudioSilenceDetected="audioSilenceDetected",n.VisibilityChanged="visibilityChanged",n.VideoDimensionsChanged="videoDimensionsChanged",n.VideoPlaybackStarted="videoPlaybackStarted",n.VideoPlaybackFailed="videoPlaybackFailed",n.ElementAttached="elementAttached",n.ElementDetached="elementDetached",n.UpstreamPaused="upstreamPaused",n.UpstreamResumed="upstreamResumed",n.SubscriptionPermissionChanged="subscriptionPermissionChanged",n.SubscriptionStatusChanged="subscriptionStatusChanged",n.SubscriptionFailed="subscriptionFailed",n.TrackProcessorUpdate="trackProcessorUpdate",n.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",n.TranscriptionReceived="transcriptionReceived",n.TimeSyncUpdate="timeSyncUpdate",n.PreConnectBufferFlushed="preConnectBufferFlushed"})(ht||(ht={}));function GU(n){return typeof n>"u"?n:typeof structuredClone=="function"?typeof n=="object"&&n!==null?structuredClone(Object.assign({},n)):structuredClone(n):JSON.parse(JSON.stringify(n))}class Xn{constructor(e,t,r,i,o){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(t!==void 0&&r!==void 0)this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:r,maxFramerate:i,priority:o};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const WU=["vp8","h264"],zU=["vp8","h264","vp9","av1","h265"];function HU(n){return!!WU.find(e=>e===n)}const ZU=HU;var XS;(function(n){n[n.PREFER_REGRESSION=0]="PREFER_REGRESSION",n[n.SIMULCAST=1]="SIMULCAST",n[n.REGRESSION=2]="REGRESSION"})(XS||(XS={}));var jy;(function(n){n.telephone={maxBitrate:12e3},n.speech={maxBitrate:24e3},n.music={maxBitrate:48e3},n.musicStereo={maxBitrate:64e3},n.musicHighQuality={maxBitrate:96e3},n.musicHighQualityStereo={maxBitrate:128e3}})(jy||(jy={}));const yf={h90:new Xn(160,90,9e4,20),h180:new Xn(320,180,16e4,20),h216:new Xn(384,216,18e4,20),h360:new Xn(640,360,45e4,20),h540:new Xn(960,540,8e5,25),h720:new Xn(1280,720,17e5,30),h1080:new Xn(1920,1080,3e6,30),h1440:new Xn(2560,1440,5e6,30),h2160:new Xn(3840,2160,8e6,30)},Vy={h120:new Xn(160,120,7e4,20),h180:new Xn(240,180,125e3,20),h240:new Xn(320,240,14e4,20),h360:new Xn(480,360,33e4,20),h480:new Xn(640,480,5e5,20),h540:new Xn(720,540,6e5,25),h720:new Xn(960,720,13e5,30),h1080:new Xn(1440,1080,23e5,30),h1440:new Xn(1920,1440,38e5,30)},f1={h360fps3:new Xn(640,360,2e5,3,"medium"),h360fps15:new Xn(640,360,4e5,15,"medium"),h720fps5:new Xn(1280,720,8e5,5,"medium"),h720fps15:new Xn(1280,720,15e5,15,"medium"),h720fps30:new Xn(1280,720,2e6,30,"medium"),h1080fps15:new Xn(1920,1080,25e5,15,"medium"),h1080fps30:new Xn(1920,1080,5e6,30,"medium"),original:new Xn(0,0,7e6,30,"medium")};function f2(n,e,t){var r,i,o,c;const{optionsWithoutProcessor:s,audioProcessor:l,videoProcessor:d}=p2(n??{}),h=e==null?void 0:e.processor,p=t==null?void 0:t.processor,g=s??{};return g.audio===!0&&(g.audio={}),g.video===!0&&(g.video={}),g.audio&&(Gy(g.audio,e),(r=(o=g.audio).deviceId)!==null&&r!==void 0||(o.deviceId={ideal:"default"}),(l||h)&&(g.audio.processor=l??h)),g.video&&(Gy(g.video,t),(i=(c=g.video).deviceId)!==null&&i!==void 0||(c.deviceId={ideal:"default"}),(d||p)&&(g.video.processor=d??p)),g}function Gy(n,e){return Object.keys(e).forEach(t=>{n[t]===void 0&&(n[t]=e[t])}),n}function h1(n){var e,t,r,i;const o={};if(n.video)if(typeof n.video=="object"){const c={},s=c,l=n.video;Object.keys(l).forEach(d=>{switch(d){case"resolution":Gy(s,l.resolution);break;default:s[d]=l[d]}}),o.video=c,(e=(r=o.video).deviceId)!==null&&e!==void 0||(r.deviceId={ideal:"default"})}else o.video=n.video?{deviceId:{ideal:"default"}}:!1;else o.video=!1;return n.audio?typeof n.audio=="object"?(o.audio=n.audio,(t=(i=o.audio).deviceId)!==null&&t!==void 0||(i.deviceId={ideal:"default"})):o.audio={deviceId:{ideal:"default"}}:o.audio=!1,o}function h2(n){return he(this,arguments,void 0,function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const r=p1();if(r){const i=r.createAnalyser();i.fftSize=2048;const o=i.frequencyBinCount,c=new Uint8Array(o);r.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield Ci(t),i.getByteTimeDomainData(c);const l=c.some(d=>d!==128&&d!==0);return r.close(),!l}return!1}()})}function p1(){var n;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const t=new e({latencyHint:"interactive"});if(t.state==="suspended"&&typeof window<"u"&&(!((n=window.document)===null||n===void 0)&&n.body)){const r=()=>he(this,void 0,void 0,function*(){var i;try{t.state==="suspended"&&(yield t.resume())}catch(o){console.warn("Error trying to auto-resume audio context",o)}finally{(i=window.document.body)===null||i===void 0||i.removeEventListener("click",r)}});t.addEventListener("statechange",()=>{var i;t.state==="closed"&&((i=window.document.body)===null||i===void 0||i.removeEventListener("click",r))}),window.document.body.addEventListener("click",r)}return t}}function XU(n){return n==="audioinput"?je.Source.Microphone:n==="videoinput"?je.Source.Camera:je.Source.Unknown}function Wy(n){return n===je.Source.Microphone?"audioinput":n===je.Source.Camera?"videoinput":void 0}function $U(n){var e,t;let r=(e=n.video)!==null&&e!==void 0?e:!0;return n.resolution&&n.resolution.width>0&&n.resolution.height>0&&(r=typeof r=="boolean"?{}:r,Tl()?r=Object.assign(Object.assign({},r),{width:{max:n.resolution.width},height:{max:n.resolution.height},frameRate:n.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:n.resolution.width},height:{ideal:n.resolution.height},frameRate:n.resolution.frameRate})),{audio:(t=n.audio)!==null&&t!==void 0?t:!1,video:r,controller:n.controller,selfBrowserSurface:n.selfBrowserSurface,surfaceSwitching:n.surfaceSwitching,systemAudio:n.systemAudio,preferCurrentTab:n.preferCurrentTab}}function Jd(n){return n.split("/")[1].toLowerCase()}function KU(n){const e=[];return n.forEach(t=>{t.track!==void 0&&e.push(new i1({cid:t.track.mediaStreamID,track:t.trackInfo}))}),e}function kn(n){return"mediaStreamTrack"in n?{trackID:n.sid,source:n.source,muted:n.isMuted,enabled:n.mediaStreamTrack.enabled,kind:n.kind,streamID:n.mediaStreamID,streamTrackID:n.mediaStreamTrack.id}:{trackID:n.trackSid,enabled:n.isEnabled,muted:n.isMuted,trackInfo:Object.assign({mimeType:n.mimeType,name:n.trackName,encrypted:n.isEncrypted,kind:n.kind,source:n.source},n.track?kn(n.track):{})}}function qU(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function YU(n,e){var t;n===void 0&&(n={}),e===void 0&&(e={});const r=[...Object.keys(e),...Object.keys(n)],i={};for(const o of r)n[o]!==e[o]&&(i[o]=(t=e[o])!==null&&t!==void 0?t:"");return i}function p2(n){const e=Object.assign({},n);let t,r;return typeof e.audio=="object"&&e.audio.processor&&(t=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(r=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:t,videoProcessor:r,optionsWithoutProcessor:GU(e)}}function QU(n){switch(n){case Gr.CAMERA:return je.Source.Camera;case Gr.MICROPHONE:return je.Source.Microphone;case Gr.SCREEN_SHARE:return je.Source.ScreenShare;case Gr.SCREEN_SHARE_AUDIO:return je.Source.ScreenShareAudio;default:return je.Source.Unknown}}function $S(n,e){return n.width*n.height<e.width*e.height}function JU(n,e){var t;return(t=n.layers)===null||t===void 0?void 0:t.find(r=>r.quality===e)}const ej=5e3,Fd=[];var No;(function(n){n[n.LOW=0]="LOW",n[n.MEDIUM=1]="MEDIUM",n[n.HIGH=2]="HIGH"})(No||(No={}));class je extends ca.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=je.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=gn,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),ej):this.handleAppVisibilityChanged()},this.log=Ua((i=r.loggerName)!==null&&i!==void 0?i:Ps.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=je.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),kn(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===je.Kind.Video&&(t="video"),this.attachedElements.length===0&&this.kind===je.Kind.Video&&this.addAppVisibilityListener(),e||(t==="audio"&&(Fd.forEach(o=>{o.parentElement===null&&!e&&(e=o)}),e&&Fd.splice(Fd.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),mu(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(o=>o.kind==="audio");return e.play().then(()=>{this.emit(i?ht.AudioPlaybackStarted:ht.VideoPlaybackStarted)}).catch(o=>{o.name==="NotAllowedError"?this.emit(i?ht.AudioPlaybackFailed:ht.VideoPlaybackFailed,o):o.name==="AbortError"?gn.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):gn.warn("could not playback ".concat(i?"audio":"video"),o),i&&e&&r.some(c=>c.kind==="video")&&o.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(ht.ElementAttached,e),e}detach(e){try{if(e){Au(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(ht.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(r=>{Au(this.mediaStreamTrack,r),t.push(r),this.recycleElement(r),this.emit(ht.ElementDetached,r)}),this.attachedElements=[],t}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=Ua(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),Fd.forEach(r=>{r.parentElement||(t=!1)}),t&&Fd.push(e)}}handleAppVisibilityChanged(){return he(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===je.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){mo()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){mo()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function mu(n,e){let t;e.srcObject instanceof MediaStream?t=e.srcObject:t=new MediaStream;let r;n.kind==="audio"?r=t.getAudioTracks():r=t.getVideoTracks(),r.includes(n)||(r.forEach(i=>{t.removeTrack(i)}),t.addTrack(n)),(!Tl()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=t.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==t&&(e.srcObject=t,(Tl()||El())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=t,e.play().catch(()=>{})},0))}function Au(n,e){if(e.srcObject instanceof MediaStream){const t=e.srcObject;t.removeTrack(n),t.getTracks().length>0?e.srcObject=t:e.srcObject=null}}(function(n){let e;(function(d){d.Audio="audio",d.Video="video",d.Unknown="unknown"})(e=n.Kind||(n.Kind={}));let t;(function(d){d.Camera="camera",d.Microphone="microphone",d.ScreenShare="screen_share",d.ScreenShareAudio="screen_share_audio",d.Unknown="unknown"})(t=n.Source||(n.Source={}));let r;(function(d){d.Active="active",d.Paused="paused",d.Unknown="unknown"})(r=n.StreamState||(n.StreamState={}));function i(d){switch(d){case e.Audio:return ks.AUDIO;case e.Video:return ks.VIDEO;default:return ks.DATA}}n.kindToProto=i;function o(d){switch(d){case ks.AUDIO:return e.Audio;case ks.VIDEO:return e.Video;default:return e.Unknown}}n.kindFromProto=o;function c(d){switch(d){case t.Camera:return Gr.CAMERA;case t.Microphone:return Gr.MICROPHONE;case t.ScreenShare:return Gr.SCREEN_SHARE;case t.ScreenShareAudio:return Gr.SCREEN_SHARE_AUDIO;default:return Gr.UNKNOWN}}n.sourceToProto=c;function s(d){switch(d){case Gr.CAMERA:return t.Camera;case Gr.MICROPHONE:return t.Microphone;case Gr.SCREEN_SHARE:return t.ScreenShare;case Gr.SCREEN_SHARE_AUDIO:return t.ScreenShareAudio;default:return t.Unknown}}n.sourceFromProto=s;function l(d){switch(d){case Dy.ACTIVE:return r.Active;case Dy.PAUSED:return r.Paused;default:return r.Unknown}}n.streamStateFromProto=l})(je||(je={}));const tj="|",KS="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function nj(n){const e=n.split(tj);return e.length>1?[e[0],n.substr(e[0].length+1)]:[n,""]}function Ci(n){return new go(e=>yi.setTimeout(e,n))}function zy(){return"addTransceiver"in RTCPeerConnection.prototype}function Hy(){return"addTrack"in RTCPeerConnection.prototype}function rj(){if(!("getCapabilities"in RTCRtpSender)||Tl()||El())return!1;const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType.toLowerCase()==="video/av1"){e=!0;break}}return e}function ij(){if(!("getCapabilities"in RTCRtpSender)||El())return!1;if(Tl()){const t=Ki();if(t!=null&&t.version&&Ms(t.version,"16")<0||(t==null?void 0:t.os)==="iOS"&&(t!=null&&t.osVersion)&&Ms(t.osVersion,"16")<0)return!1}const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType.toLowerCase()==="video/vp9"){e=!0;break}}return e}function Ts(n){return n==="av1"||n==="vp9"}function Zy(n){return!document||Cf()?!1:(n||(n=document.createElement("audio")),"setSinkId"in n)}function oj(){return typeof RTCPeerConnection>"u"?!1:zy()||Hy()}function El(){var n;return((n=Ki())===null||n===void 0?void 0:n.name)==="Firefox"}function qS(){const n=Ki();return!!n&&n.name==="Chrome"&&n.os!=="iOS"}function Tl(){var n;return((n=Ki())===null||n===void 0?void 0:n.name)==="Safari"}function Cf(){const n=Ki();return(n==null?void 0:n.name)==="Safari"||(n==null?void 0:n.os)==="iOS"}function sj(){const n=Ki();return(n==null?void 0:n.name)==="Safari"&&n.version.startsWith("17.")||(n==null?void 0:n.os)==="iOS"&&!!(n!=null&&n.osVersion)&&Ms(n.osVersion,"17")>=0}function aj(n){return n||(n=Ki()),(n==null?void 0:n.name)==="Safari"&&Ms(n.version,"18.3")>0||(n==null?void 0:n.os)==="iOS"&&!!(n!=null&&n.osVersion)&&Ms(n.osVersion,"18.3")>0}function g2(){var n,e;return mo()?(e=(n=navigator.userAgentData)===null||n===void 0?void 0:n.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function cj(){const n=Ki(),e="17.2";if(n)return n.name!=="Safari"&&n.os!=="iOS"||n.os==="iOS"&&n.osVersion&&Ms(n.osVersion,e)>=0?!0:n.name==="Safari"&&Ms(n.version,e)>=0}function mo(){return typeof document<"u"}function na(){return navigator.product=="ReactNative"}function Uu(n){return n.hostname.endsWith(".livekit.cloud")||n.hostname.endsWith(".livekit.run")}function Iv(n){return Uu(n)?n.hostname.split(".")[0]:null}function m2(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function v2(){if(!na())return;let n=m2();if(n)return n.platform}function YS(){if(mo())return window.devicePixelRatio;if(na()){let n=m2();if(n)return n.devicePixelRatio}return 1}function Ms(n,e){const t=n.split("."),r=e.split("."),i=Math.min(t.length,r.length);for(let o=0;o<i;++o){const c=parseInt(t[o],10),s=parseInt(r[o],10);if(c>s)return 1;if(c<s)return-1;if(o===i-1&&c===s)return 0}return n===""&&e!==""?-1:e===""?1:t.length==r.length?0:t.length<r.length?-1:1}function lj(n){for(const e of n)e.target.handleResize(e)}function uj(n){for(const e of n)e.target.handleVisibilityChanged(e)}let wv=null;const QS=()=>(wv||(wv=new ResizeObserver(lj)),wv);let Sv=null;const JS=()=>(Sv||(Sv=new IntersectionObserver(uj,{root:null,rootMargin:"0px"})),Sv);function dj(){var n;const e=new y_({sdk:C_.JS,protocol:jU,version:UU});return na()&&(e.os=(n=v2())!==null&&n!==void 0?n:""),e}function eA(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=n,i.height=e;const o=i.getContext("2d");o==null||o.fillRect(0,0,i.width,i.height),r&&o&&(o.beginPath(),o.arc(n/2,e/2,50,0,Math.PI*2,!0),o.closePath(),o.fillStyle="grey",o.fill());const c=i.captureStream(),[s]=c.getTracks();if(!s)throw Error("Could not get empty media stream video track");return s.enabled=t,s}let Bd;function Av(){if(!Bd){const n=new AudioContext,e=n.createOscillator(),t=n.createGain();t.gain.setValueAtTime(0,0);const r=n.createMediaStreamDestination();if(e.connect(t),t.connect(r),e.start(),[Bd]=r.stream.getAudioTracks(),!Bd)throw Error("Could not get empty media stream audio track");Bd.enabled=!1}return Bd.clone()}class Jo{get isResolved(){return this._isResolved}constructor(e,t){this._isResolved=!1,this.onFinally=t,this.promise=new Promise((r,i)=>he(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;this._isResolved=!0,(r=this.onFinally)===null||r===void 0||r.call(this)})}}function fj(n,e){const t=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=p1();if(!r)throw new Error("Audio Context not supported on this browser");const i=t.cloneTrack?n.mediaStreamTrack.clone():n.mediaStreamTrack,o=r.createMediaStreamSource(new MediaStream([i])),c=r.createAnalyser();c.minDecibels=t.minDecibels,c.maxDecibels=t.maxDecibels,c.fftSize=t.fftSize,c.smoothingTimeConstant=t.smoothingTimeConstant,o.connect(c);const s=new Uint8Array(c.frequencyBinCount);return{calculateVolume:()=>{c.getByteFrequencyData(s);let h=0;for(const g of s)h+=Math.pow(g/255,2);return Math.sqrt(h/s.length)},analyser:c,cleanup:()=>he(this,void 0,void 0,function*(){yield r.close(),t.cloneTrack&&i.stop()})}}function hj(n){return zU.includes(n)}function Tc(n){if(typeof n=="string"||typeof n=="number")return n;if(Array.isArray(n))return n[0];if(n.exact!==void 0)return Array.isArray(n.exact)?n.exact[0]:n.exact;if(n.ideal!==void 0)return Array.isArray(n.ideal)?n.ideal[0]:n.ideal;throw Error("could not unwrap constraint")}function pj(n){return n.startsWith("http")?n.replace(/^(http)/,"ws"):n}function xf(n){return n.startsWith("ws")?n.replace(/^(ws)/,"http"):n}function gj(n,e){return n.segments.map(t=>{let{id:r,text:i,language:o,startTime:c,endTime:s,final:l}=t;var d;const h=(d=e.get(r))!==null&&d!==void 0?d:Date.now(),p=Date.now();return l?e.delete(r):e.set(r,h),{id:r,text:i,startTime:Number.parseInt(c.toString()),endTime:Number.parseInt(s.toString()),final:l,language:o,firstReceivedTime:h,lastReceivedTime:p}})}function mj(n){const{id:e,timestamp:t,message:r,editTimestamp:i}=n;return{id:e,timestamp:Number.parseInt(t.toString()),editTimestamp:i?Number.parseInt(i.toString()):void 0,message:r}}function tA(n){switch(n.reason){case Kn.LeaveRequest:return n.context;case Kn.Cancelled:return Rs.CLIENT_INITIATED;case Kn.NotAllowed:return Rs.USER_REJECTED;case Kn.ServerUnreachable:return Rs.JOIN_FAILURE;default:return Rs.UNKNOWN_REASON}}function rp(n){return n!==void 0?Number(n):void 0}function ll(n){return n!==void 0?BigInt(n):void 0}function xl(n){return!!n&&!(n instanceof MediaStreamTrack)&&n.isLocal}function Js(n){return!!n&&n.kind==je.Kind.Audio}function jc(n){return!!n&&n.kind==je.Kind.Video}function hc(n){return xl(n)&&jc(n)}function Ea(n){return xl(n)&&Js(n)}function Xy(n){return!!n&&!n.isLocal}function vj(n){return!!n&&!n.isLocal}function kv(n){return Xy(n)&&jc(n)}function yj(n){return n.isLocal}function Cj(n,e){const t=[];let r=new TextEncoder().encode(n);for(;r.length>e;){let i=e;for(;i>0;){const o=r[i];if(o!==void 0&&(o&192)!==128)break;i--}t.push(r.slice(0,i)),r=r.slice(i)}return r.length>0&&t.push(r),t}function xj(n){var e;const t=n.get("Cache-Control");if(t){const r=(e=t.match(/(?:^|[,\s])max-age=(\d+)/))===null||e===void 0?void 0:e[1];if(r)return parseInt(r,10)}}function bj(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=Ij(n,e);return t?r:g1(r,"v1")}function Ij(n,e){const t=new URL(pj(n));return e.forEach((r,i)=>{t.searchParams.set(i,r)}),g1(t,"rtc")}function wj(n){const e=new URL(xf(n));return g1(e,"validate")}function y2(n){return n.endsWith("/")?n:"".concat(n,"/")}function g1(n,e){return n.pathname="".concat(y2(n.pathname)).concat(e),n}function nA(n){if(typeof n=="string")return NS.fromJson(JSON.parse(n),{ignoreUnknownFields:!0});if(n instanceof ArrayBuffer)return NS.fromBinary(new Uint8Array(n));throw new Error("could not decode websocket message: ".concat(typeof n))}function Sj(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Unknown reason";if(!(n instanceof AbortSignal))return e;const t=n.reason;switch(typeof t){case"string":return t;case"object":return t instanceof Error?t.message:e;default:return"toString"in t?t.toString():e}}const Aj=10,Ld="lk_e2ee",kj="LKFrameEncryptionKey",Ej={sharedKey:!1,ratchetSalt:kj,ratchetWindowSize:8,failureTolerance:Aj,keyringSize:16};var _c;(function(n){n.SetKey="setKey",n.RatchetRequest="ratchetRequest",n.KeyRatcheted="keyRatcheted"})(_c||(_c={}));var rA;(function(n){n.KeyRatcheted="keyRatcheted"})(rA||(rA={}));var Sc;(function(n){n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError"})(Sc||(Sc={}));var iA;(function(n){n.Error="cryptorError"})(iA||(iA={}));function Tj(){return _j()||$y()}function $y(){return typeof window.RTCRtpScriptTransform<"u"}function _j(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}function Rj(n){var e,t,r,i,o;if(((e=n.value)===null||e===void 0?void 0:e.case)!=="sipDtmf"&&((t=n.value)===null||t===void 0?void 0:t.case)!=="metrics"&&((r=n.value)===null||r===void 0?void 0:r.case)!=="speaker"&&((i=n.value)===null||i===void 0?void 0:i.case)!=="transcription"&&((o=n.value)===null||o===void 0?void 0:o.case)!=="encryptedPacket")return new d_({value:n.value})}class _$ extends ca.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(t,r,i)=>{gn.debug("key ratcheted event received",{ratchetResult:t,participantId:r,keyIndex:i})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},Ej),e),this.on(_c.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,t,r){const i={key:e,participantIdentity:t,keyIndex:r};if(!this.options.sharedKey&&!t)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(t??"shared","-").concat(r??0),i),this.emit(_c.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,t){this.emit(_c.RatchetRequest,e,t)}}var oA;(function(n){n[n.InvalidKey=0]="InvalidKey",n[n.MissingKey=1]="MissingKey",n[n.InternalError=2]="InternalError"})(oA||(oA={}));class Dj extends ca.EventEmitter{constructor(e,t){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=r=>{var i,o;const{kind:c,data:s}=r.data;switch(c){case"error":if(gn.error(s.error.message),s.uuid){const h=this.decryptDataRequests.get(s.uuid);if(h!=null&&h.reject){h.reject(s.error);break}const p=this.encryptDataRequests.get(s.uuid);if(p!=null&&p.reject){p.reject(s.error);break}}this.emit(Sc.EncryptionError,s.error,s.participantIdentity);break;case"initAck":s.enabled&&this.keyProvider.getKeys().forEach(h=>{this.postKey(h)});break;case"enable":if(s.enabled&&this.keyProvider.getKeys().forEach(h=>{this.postKey(h)}),this.encryptionEnabled!==s.enabled&&s.participantIdentity===((i=this.room)===null||i===void 0?void 0:i.localParticipant.identity))this.emit(Sc.ParticipantEncryptionStatusChanged,s.enabled,this.room.localParticipant),this.encryptionEnabled=s.enabled;else if(s.participantIdentity){const h=(o=this.room)===null||o===void 0?void 0:o.getParticipantByIdentity(s.participantIdentity);if(!h)throw TypeError("couldn't set encryption status, participant not found".concat(s.participantIdentity));this.emit(Sc.ParticipantEncryptionStatusChanged,s.enabled,h)}break;case"ratchetKey":this.keyProvider.emit(_c.KeyRatcheted,s.ratchetResult,s.participantIdentity,s.keyIndex);break;case"decryptDataResponse":const l=this.decryptDataRequests.get(s.uuid);l!=null&&l.resolve&&l.resolve(s);break;case"encryptDataResponse":const d=this.encryptDataRequests.get(s.uuid);d!=null&&d.resolve&&d.resolve(s);break}},this.onWorkerError=r=>{gn.error("e2ee worker encountered an error:",{error:r.error}),this.emit(Sc.EncryptionError,r.error,void 0)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=t}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!Tj())throw new d1("tried to setup end-to-end encryption on an unsupported browser");if(gn.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:wU.getLevel()}};this.worker&&(gn.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){gn.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){!e||e.length===0?gn.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(vt.RTPVideoMapUpdate,t=>{this.postRTPMap(t)})}setupEventListeners(e,t){e.on(We.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Yr.NONE,i.identity)),e.on(We.ConnectionStateChanged,r=>{r===Mn.Connected&&e.remoteParticipants.forEach(i=>{i.trackPublications.forEach(o=>{this.setParticipantCryptorEnabled(o.trackInfo.encryption!==Yr.NONE,i.identity)})})}).on(We.TrackUnsubscribed,(r,i,o)=>{var c;const s={kind:"removeTransform",data:{participantIdentity:o.identity,trackId:r.mediaStreamID}};(c=this.worker)===null||c===void 0||c.postMessage(s)}).on(We.TrackSubscribed,(r,i,o)=>{this.setupE2EEReceiver(r,o.identity,i.trackInfo)}).on(We.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");t.getKeys().forEach(r=>{this.postKey(r)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on($e.LocalSenderCreated,(r,i)=>he(this,void 0,void 0,function*(){this.setupE2EESender(i,r)})),e.localParticipant.on($e.LocalTrackPublished,r=>{if(!jc(r.track)||!Cf())return;const i={kind:"updateCodec",data:{trackId:r.track.mediaStreamID,codec:Jd(r.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(i)}),t.on(_c.SetKey,r=>this.postKey(r)).on(_c.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}encryptData(e){return he(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const t=crypto.randomUUID(),r={kind:"encryptDataRequest",data:{uuid:t,payload:e,participantIdentity:this.room.localParticipant.identity}},i=new Jo;return i.onFinally=()=>{this.encryptDataRequests.delete(t)},this.encryptDataRequests.set(t,i),this.worker.postMessage(r),i.promise})}handleEncryptedData(e,t,r,i){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const o=crypto.randomUUID(),c={kind:"decryptDataRequest",data:{uuid:o,payload:e,iv:t,participantIdentity:r,keyIndex:i}},s=new Jo;return s.onFinally=()=>{this.decryptDataRequests.delete(o)},this.decryptDataRequests.set(o,s),this.worker.postMessage(c),s.promise}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(r)}postKey(e){let{key:t,participantIdentity:r,keyIndex:i}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const c={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity),key:t,keyIndex:i}};this.worker.postMessage(c)}postEnable(e,t){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((t=this.room)===null||t===void 0)&&t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,e.kind==="video"?Jd(r.mimeType):void 0)}}setupE2EESender(e,t){if(!xl(e)||!t){t||gn.warn("early return because sender is not ready");return}this.handleSender(t,e.mediaStreamID,void 0)}handleReceiver(e,t,r,i){return he(this,void 0,void 0,function*(){if(this.worker){if($y()&&!qS()){const o={kind:"decode",participantIdentity:r,trackId:t,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(Ld in e&&i){const l={kind:"updateCodec",data:{trackId:t,codec:i,participantIdentity:r}};this.worker.postMessage(l);return}let o=e.writableStream,c=e.readableStream;if(!o||!c){const l=e.createEncodedStreams();e.writableStream=l.writable,o=l.writable,e.readableStream=l.readable,c=l.readable}const s={kind:"decode",data:{readableStream:c,writableStream:o,trackId:t,codec:i,participantIdentity:r,isReuse:Ld in e}};this.worker.postMessage(s,[c,o])}e[Ld]=!0}})}handleSender(e,t,r){var i;if(!(Ld in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if($y()&&!qS()){gn.info("initialize script transform");const o={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{gn.info("initialize encoded streams");const o=e.createEncodedStreams(),c={kind:"encode",data:{readableStream:o.readable,writableStream:o.writable,codec:r,trackId:t,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(c,[o.readable,o.writable])}e[Ld]=!0}}}const Pj=500,Mj=15e3;class ku{constructor(){this.failedConnectionAttempts=new Map,this.backOffPromises=new Map}static getInstance(){return this._instance||(this._instance=new ku),this._instance}addFailedConnectionAttempt(e){var t;const r=new URL(e),i=Iv(r);if(!i)return;let o=(t=this.failedConnectionAttempts.get(i))!==null&&t!==void 0?t:0;this.failedConnectionAttempts.set(i,o+1),this.backOffPromises.set(i,Ci(Math.min(Pj*Math.pow(2,o),Mj)))}getBackOffPromise(e){const t=new URL(e),r=t&&Iv(t);return r&&this.backOffPromises.get(r)||Promise.resolve()}resetFailedConnectionAttempts(e){const t=new URL(e),r=t&&Iv(t);r&&(this.failedConnectionAttempts.set(r,0),this.backOffPromises.set(r,Promise.resolve()))}resetAll(){this.backOffPromises.clear(),this.failedConnectionAttempts.clear()}}ku._instance=null;const Ev="default";class ui{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new ui),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o;if(((o=ui.userMediaPromiseMap)===null||o===void 0?void 0:o.size)>0){gn.debug("awaiting getUserMedia promise");try{t?yield ui.userMediaPromiseMap.get(t):yield Promise.all(ui.userMediaPromiseMap.values())}catch{gn.warn("error waiting for media permissons")}}let c=yield navigator.mediaDevices.enumerateDevices();if(i&&!(Tl()&&r.hasDeviceInUse(t))&&(c.filter(l=>l.kind===t).length===0||c.some(l=>{const d=l.label==="",h=t?l.kind===t:!0;return d&&h}))){const l={video:t!=="audioinput"&&t!=="audiooutput",audio:t!=="videoinput"&&{deviceId:{ideal:"default"}}},d=yield navigator.mediaDevices.getUserMedia(l);c=yield navigator.mediaDevices.enumerateDevices(),d.getTracks().forEach(h=>{h.stop()})}return r._previousDevices=c,t&&(c=c.filter(s=>s.kind===t)),c}()})}normalizeDeviceId(e,t,r){return he(this,void 0,void 0,function*(){if(t!==Ev)return t;const i=yield this.getDevices(e),o=i.find(s=>s.deviceId===Ev);if(!o){gn.warn("could not reliably determine default device");return}const c=i.find(s=>s.deviceId!==Ev&&s.groupId===(r??o.groupId));if(!c){gn.warn("could not reliably determine default device");return}return c==null?void 0:c.deviceId})}hasDeviceInUse(e){return e?ui.userMediaPromiseMap.has(e):ui.userMediaPromiseMap.size>0}}ui.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];ui.userMediaPromiseMap=new Map;var ef;(function(n){n[n.WAITING=0]="WAITING",n[n.RUNNING=1]="RUNNING",n[n.COMPLETED=2]="COMPLETED"})(ef||(ef={}));class Nj{constructor(){this.pendingTasks=new Map,this.taskMutex=new $i,this.nextTaskIndex=0}run(e){return he(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:ef.WAITING};this.pendingTasks.set(t.id,t);const r=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=ef.RUNNING,yield e()}finally{t.status=ef.COMPLETED,this.pendingTasks.delete(t.id),r()}})}flush(){return he(this,void 0,void 0,function*(){return this.run(()=>he(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class Oj{get readyState(){return this.ws.readyState}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r,i;if(!((r=t.signal)===null||r===void 0)&&r.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=e;const o=new WebSocket(e,(i=t.protocols)!==null&&i!==void 0?i:[]);o.binaryType="arraybuffer",this.ws=o;const c=function(){let{closeCode:s,reason:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return o.close(s,l)};this.opened=new go((s,l)=>{const d=()=>{l(tn.websocket("Encountered websocket error during connection establishment"))};o.onopen=()=>{s({readable:new ReadableStream({start(h){o.onmessage=p=>{let{data:g}=p;return h.enqueue(g)},o.onerror=p=>h.error(p)},cancel:c}),writable:new WritableStream({write(h){o.send(h)},abort(){o.close()},close:c}),protocol:o.protocol,extensions:o.extensions}),o.removeEventListener("error",d)},o.addEventListener("error",d)}),this.closed=new go((s,l)=>{const d=()=>he(this,void 0,void 0,function*(){const h=new go(g=>{o.readyState!==WebSocket.CLOSED&&o.addEventListener("close",y=>{g(y)},{once:!0})}),p=yield go.race([Ci(250),h]);p?s(p):l(tn.websocket("Encountered unspecified websocket error without a timely close event"))});o.onclose=h=>{let{code:p,reason:g}=h;s({closeCode:p,reason:g}),o.removeEventListener("error",d)},o.addEventListener("error",d)}),t.signal&&(t.signal.onabort=()=>o.close()),this.close=c}}const Fj=["syncState","trickle","offer","answer","simulate","leave"];function Bj(n){const e=Fj.indexOf(n.case)>=0;return gn.trace("request allowed to bypass queue:",{canPass:e,req:n}),e}var $n;(function(n){n[n.CONNECTING=0]="CONNECTING",n[n.CONNECTED=1]="CONNECTED",n[n.RECONNECTING=2]="RECONNECTING",n[n.DISCONNECTING=3]="DISCONNECTING",n[n.DISCONNECTED=4]="DISCONNECTED"})($n||($n={}));const Lj=250;class m1{get currentState(){return this.state}get isDisconnected(){return this.state===$n.DISCONNECTING||this.state===$n.DISCONNECTED}get isEstablishingConnection(){return this.state===$n.CONNECTING||this.state===$n.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=$n.DISCONNECTED,this.log=gn,this._requestId=0,this.useV0SignalPath=!1,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=Ua((r=t.loggerName)!==null&&r!==void 0?r:Ps.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new Nj,this.queuedRequests=[],this.closingLock=new $i,this.connectionLock=new $i,this.state=$n.DISCONNECTED}get logContext(){var e,t;return(t=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&t!==void 0?t:{}}join(e,t,r,i){return he(this,arguments,void 0,function(o,c,s,l){var d=this;let h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return function*(){return d.state=$n.CONNECTING,d.options=s,yield d.connect(o,c,s,l,h)}()})}reconnect(e,t,r,i){return he(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=$n.RECONNECTING,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}),void 0,this.useV0SignalPath)})}connect(e,t,r,i){return he(this,arguments,void 0,function(o,c,s,l){var d=this;let h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return function*(){const p=yield d.connectionLock.lock();d.connectOptions=s,d.useV0SignalPath=h;const g=dj(),y=h?Uj(c,g,s):jj(c,g,s),C=bj(o,y,h).toString(),x=wj(C).toString();return new Promise((w,S)=>he(d,void 0,void 0,function*(){var E,R;try{let k=!1;const A=F=>he(this,void 0,void 0,function*(){if(k)return;k=!0;const V=F instanceof Event?F.currentTarget:F,X=Sj(V,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(X)).catch(te=>{this.log.error(te),this.close()}):this.close(),_(),S(tn.cancelled(X))});l==null||l.addEventListener("abort",A);const _=()=>{clearTimeout(D),l==null||l.removeEventListener("abort",A)},D=setTimeout(()=>{A(tn.timeout("room connection has timed out (signal)"))},s.websocketTimeout),j=(F,V)=>{this.handleSignalConnected(F,D,V)},Z=new URL(C);Z.searchParams.has("access_token")&&Z.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(Z),Object.assign({reconnect:s.reconnect,reconnectReason:s.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new Oj(C);try{this.ws.closed.then(Ie=>{var Re;this.isEstablishingConnection&&S(tn.internal("Websocket got closed during a (re)connection attempt: ".concat(Ie.reason))),Ie.closeCode!==1e3&&(this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:Ie.reason,code:Ie.closeCode,wasClean:Ie.closeCode===1e3,state:this.state})),this.state===$n.CONNECTED&&this.handleOnClose((Re=Ie.reason)!==null&&Re!==void 0?Re:"Unexpected WS error"))}).catch(Ie=>{this.isEstablishingConnection&&S(tn.internal("Websocket error during a (re)connection attempt: ".concat(Ie)))});const F=yield this.ws.opened.catch(Ie=>he(this,void 0,void 0,function*(){if(this.state!==$n.CONNECTED){this.state=$n.DISCONNECTED,clearTimeout(D);const Re=yield this.handleConnectionError(Ie,x);S(Re);return}this.handleWSError(Ie),S(Ie)}));if(clearTimeout(D),!F)return;const V=F.readable.getReader();this.streamWriter=F.writable.getWriter();const X=yield V.read();if(V.releaseLock(),!X.value)throw tn.internal("no message received as first message");const te=nA(X.value),pe=this.validateFirstMessage(te,(E=s.reconnect)!==null&&E!==void 0?E:!1);if(!pe.isValid){S(pe.error);return}((R=te.message)===null||R===void 0?void 0:R.case)==="join"&&(this.pingTimeoutDuration=te.message.value.pingTimeout,this.pingIntervalDuration=te.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})));const ve=pe.shouldProcessFirstMessage?te:void 0;j(F,ve),w(pe.response)}catch(F){S(F)}finally{_()}}finally{p()}}))}()})}startReadingLoop(e,t){return he(this,void 0,void 0,function*(){for(t&&this.handleSignalResponse(t);;){this.signalLatency&&(yield Ci(this.signalLatency));const{done:r,value:i}=yield e.read();if(r)break;const o=nA(i);this.handleSignalResponse(o)}})}close(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Close method called on signal client";return function*(){if([$n.DISCONNECTING||$n.DISCONNECTED].includes(e.state)){e.log.debug("ignoring signal close as it's already in disconnecting state");return}const i=yield e.closingLock.lock();try{if(e.clearPingInterval(),t&&(e.state=$n.DISCONNECTING),e.ws){e.ws.close({closeCode:1e3,reason:r});const o=e.ws.closed;e.ws=void 0,e.streamWriter=void 0,yield Promise.race([o,Ci(Lj)])}}catch(o){e.log.debug("websocket error while closing",Object.assign(Object.assign({},e.logContext),{error:o}))}finally{t&&(e.state=$n.DISCONNECTED),i()}}()})}sendOffer(e,t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:vu(e,t)})}sendAnswer(e,t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:vu(e,t)})}sendIceCandidate(e,t){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new tg({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new ng({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return he(this,arguments,void 0,function(r,i){var o=this;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const s=o.getNextRequestId();return yield o.sendRequest({case:"updateMetadata",value:new s1({requestId:s,metadata:r,name:i,attributes:c})}),s}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new k_({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new __({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:vr.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new P_({timestamp:vr.parse(Date.now()),rtt:vr.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,t){return this.sendRequest({case:"updateAudioTrack",value:new o1({trackSid:e,features:t})})}sendLeave(){return this.sendRequest({case:"leave",value:new ig({reason:Rs.CLIENT_INITIATED,action:Iu.DISCONNECT})})}sendRequest(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!i&&!Bj(t)&&r.state===$n.RECONNECTING){r.queuedRequests.push(()=>he(r,void 0,void 0,function*(){yield this.sendRequest(t,!0)}));return}if(i||(yield r.requestQueue.flush()),r.signalLatency&&(yield Ci(r.signalLatency)),r.isDisconnected){r.log.debug("skipping signal request (type: ".concat(t.case,") - SignalClient disconnected"));return}if(!r.streamWriter){r.log.error("cannot send signal request before connected, type: ".concat(t==null?void 0:t.case),r.logContext);return}const c=new $7({message:t});try{r.useJSON?yield r.streamWriter.write(c.toJsonString()):yield r.streamWriter.write(c.toBinary())}catch(s){r.log.error("error sending signal message",Object.assign(Object.assign({},r.logContext),{error:s}))}}()})}handleSignalResponse(e){var t,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let o=!1;if(i.case==="answer"){const c=sA(i.value);this.onAnswer&&this.onAnswer(c,i.value.id,i.value.midToTrackId)}else if(i.case==="offer"){const c=sA(i.value);this.onOffer&&this.onOffer(c,i.value.id,i.value.midToTrackId)}else if(i.case==="trickle"){const c=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(c,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((t=i.value.participants)!==null&&t!==void 0?t:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):i.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(i.value):i.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(i.value.trackSid):i.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(i.value.token),this.onRoomMoved&&this.onRoomMoved(i.value)):i.case==="mediaSectionsRequirement"?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(i.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return he(this,void 0,void 0,function*(){if(this.state===$n.DISCONNECTED)return;const t=this.onClose;yield this.close(void 0,e),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=yi.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&yi.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=yi.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&yi.clearInterval(this.pingInterval)}handleSignalConnected(e,t,r){this.state=$n.CONNECTED,clearTimeout(t),this.startPingInterval(),this.startReadingLoop(e.readable.getReader(),r)}validateFirstMessage(e,t){var r,i,o,c,s;return((r=e.message)===null||r===void 0?void 0:r.case)==="join"?{isValid:!0,response:e.message.value}:this.state===$n.RECONNECTING&&((i=e.message)===null||i===void 0?void 0:i.case)!=="leave"?((o=e.message)===null||o===void 0?void 0:o.case)==="reconnect"?{isValid:!0,response:e.message.value}:(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0}):this.isEstablishingConnection&&((c=e.message)===null||c===void 0?void 0:c.case)==="leave"?{isValid:!1,error:tn.leaveRequest("Received leave request while trying to (re)connect",e.message.value.reason)}:t?{isValid:!1,error:tn.internal("Unexpected first message")}:{isValid:!1,error:tn.internal("did not receive join response, got ".concat((s=e.message)===null||s===void 0?void 0:s.case," instead"))}}handleConnectionError(e,t){return he(this,void 0,void 0,function*(){try{const r=yield fetch(t);switch(r.status){case 404:return tn.serviceNotFound("v1 RTC path not found. Consider upgrading your LiveKit server version","v0-rtc");case 401:case 403:const i=yield r.text();return tn.notAllowed(i,r.status);default:break}return e instanceof tn?e:tn.internal("Encountered unknown websocket error during connection: ".concat(e),{status:r.status,statusText:r.statusText})}catch(r){return r instanceof tn?r:tn.serverUnreachable(r instanceof Error?r.message:"server was not reachable")}})}}function sA(n){const e={type:"offer",sdp:n.sdp};switch(n.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=n.type;break}return e}function vu(n,e){return new Pc({sdp:n.sdp,type:n.type,id:e})}function Uj(n,e,t){var r;const i=new URLSearchParams;return i.set("access_token",n),t.reconnect&&(i.set("reconnect","1"),t.sid&&i.set("sid",t.sid)),i.set("auto_subscribe",t.autoSubscribe?"1":"0"),i.set("sdk",na()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),t.adaptiveStream&&i.set("adaptive_stream","1"),t.reconnectReason&&i.set("reconnect_reason",t.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),i}function jj(n,e,t){const r=new URLSearchParams;r.set("access_token",n);const i=new mU({clientInfo:e,connectionSettings:new M_({autoSubscribe:!!t.autoSubscribe,adaptiveStream:!!t.adaptiveStream}),reconnect:!!t.reconnect,participantSid:t.sid?t.sid:void 0});t.reconnectReason&&(i.reconnectReason=t.reconnectReason);const o=new vU({joinRequest:i.toBinary()});return r.set("join_request",btoa(new TextDecoder("utf-8").decode(o.toBinary()))),r}class aA{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const t=this.buffer[0];if(this._totalSize-t.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class Vj{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,t){const r=Date.now();r-this._lastCleanup>this.ttl/2&&this.cleanup();const i=r+this.ttl;return this._map.set(e,{value:t,expiresAt:i}),this}get(e){const t=this._map.get(e);if(t){if(t.expiresAt<Date.now()){this._map.delete(e);return}return t.value}}has(e){const t=this._map.get(e);return t?t.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[t,r]of this._map.entries())r.expiresAt<e&&this._map.delete(t);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[t,r]of this._map.entries())r.expiresAt>=Date.now()&&e(r.value,t,this.asValueMap())}map(e){this.cleanup();const t=[],r=this.asValueMap();for(const[i,o]of r.entries())t.push(e(o,i,r));return t}asValueMap(){const e=new Map;for(const[t,r]of this._map.entries())r.expiresAt>=Date.now()&&e.set(t,r.value);return e}}var fs={},Tv={},_v={exports:{}},cA;function v1(){if(cA)return _v.exports;cA=1;var n=_v.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(n).forEach(function(e){var t=n[e];t.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),_v.exports}var lA;function Gj(){return lA||(lA=1,function(n){var e=function(s){return String(Number(s))===s?Number(s):s},t=function(s,l,d,h){if(h&&!d)l[h]=e(s[1]);else for(var p=0;p<d.length;p+=1)s[p+1]!=null&&(l[d[p]]=e(s[p+1]))},r=function(s,l,d){var h=s.name&&s.names;s.push&&!l[s.push]?l[s.push]=[]:h&&!l[s.name]&&(l[s.name]={});var p=s.push?{}:h?l[s.name]:l;t(d.match(s.reg),p,s.names,s.name),s.push&&l[s.push].push(p)},i=v1(),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(s){var l={},d=[],h=l;return s.split(/(\r\n|\r|\n)/).filter(o).forEach(function(p){var g=p[0],y=p.slice(2);g==="m"&&(d.push({rtp:[],fmtp:[]}),h=d[d.length-1]);for(var C=0;C<(i[g]||[]).length;C+=1){var x=i[g][C];if(x.reg.test(y))return r(x,h,y)}}),l.media=d,l};var c=function(s,l){var d=l.split(/=(.+)/,2);return d.length===2?s[d[0]]=e(d[1]):d.length===1&&l.length>1&&(s[d[0]]=void 0),s};n.parseParams=function(s){return s.split(/;\s?/).reduce(c,{})},n.parseFmtpConfig=n.parseParams,n.parsePayloads=function(s){return s.toString().split(" ").map(Number)},n.parseRemoteCandidates=function(s){for(var l=[],d=s.split(" ").map(e),h=0;h<d.length;h+=3)l.push({component:d[h],ip:d[h+1],port:d[h+2]});return l},n.parseImageAttributes=function(s){return s.split(" ").map(function(l){return l.substring(1,l.length-1).split(",").reduce(c,{})})},n.parseSimulcastStreamList=function(s){return s.split(";").map(function(l){return l.split(",").map(function(d){var h,p=!1;return d[0]!=="~"?h=e(d):(h=e(d.substring(1,d.length)),p=!0),{scid:h,paused:p}})})}}(Tv)),Tv}var Rv,uA;function Wj(){if(uA)return Rv;uA=1;var n=v1(),e=/%[sdv%]/g,t=function(c){var s=1,l=arguments,d=l.length;return c.replace(e,function(h){if(s>=d)return h;var p=l[s];switch(s+=1,h){case"%%":return"%";case"%s":return String(p);case"%d":return Number(p);case"%v":return""}})},r=function(c,s,l){var d=s.format instanceof Function?s.format(s.push?l:l[s.name]):s.format,h=[c+"="+d];if(s.names)for(var p=0;p<s.names.length;p+=1){var g=s.names[p];s.name?h.push(l[s.name][g]):h.push(l[s.names[p]])}else h.push(l[s.name]);return t.apply(null,h)},i=["v","o","s","i","u","e","p","c","b","t","r","z","a"],o=["i","c","b","a"];return Rv=function(c,s){s=s||{},c.version==null&&(c.version=0),c.name==null&&(c.name=" "),c.media.forEach(function(p){p.payloads==null&&(p.payloads="")});var l=s.outerOrder||i,d=s.innerOrder||o,h=[];return l.forEach(function(p){n[p].forEach(function(g){g.name in c&&c[g.name]!=null?h.push(r(p,g,c)):g.push in c&&c[g.push]!=null&&c[g.push].forEach(function(y){h.push(r(p,g,y))})})}),c.media.forEach(function(p){h.push(r("m",n.m[0],p)),d.forEach(function(g){n[g].forEach(function(y){y.name in p&&p[y.name]!=null?h.push(r(g,y,p)):y.push in p&&p[y.push]!=null&&p[y.push].forEach(function(C){h.push(r(g,y,C))})})})}),h.join(`\r
`)+`\r
`},Rv}var dA;function zj(){if(dA)return fs;dA=1;var n=Gj(),e=Wj(),t=v1();return fs.grammar=t,fs.write=e,fs.parse=n.parse,fs.parseParams=n.parseParams,fs.parseFmtpConfig=n.parseFmtpConfig,fs.parsePayloads=n.parsePayloads,fs.parseRemoteCandidates=n.parseRemoteCandidates,fs.parseImageAttributes=n.parseImageAttributes,fs.parseSimulcastStreamList=n.parseSimulcastStreamList,fs}var Cc=zj();function y1(n,e,t){var r,i,o;e===void 0&&(e=50),t===void 0&&(t={});var c=(r=t.isImmediate)!=null&&r,s=(i=t.callback)!=null&&i,l=t.maxWait,d=Date.now(),h=[];function p(){if(l!==void 0){var y=Date.now()-d;if(y+e>=l)return l-y}return e}var g=function(){var y=[].slice.call(arguments),C=this;return new Promise(function(x,w){var S=c&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,d=Date.now(),!c){var R=n.apply(C,y);s&&s(R),h.forEach(function(k){return(0,k.resolve)(R)}),h=[]}},p()),S){var E=n.apply(C,y);return s&&s(E),x(E)}h.push({resolve:x,reject:w})})};return g.cancel=function(y){o!==void 0&&clearTimeout(o),h.forEach(function(C){return(0,C.reject)(y)}),h=[]},g}const Hj=.7,Zj=20,Eu={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class fA extends ca.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;super(),this.log=gn,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=y1(i=>he(this,void 0,void 0,function*(){this.emit(Eu.NegotiationStarted);try{yield this.createAndSendOffer()}catch(o){if(i)i(o);else throw o}}),Zj),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Ua((r=t.loggerName)!==null&&r!==void 0?r:Ps.PCTransport),this.loggerOptions=t,this.config=e,this._pc=this.createPC(),this.offerLock=new $i}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=t=>{var r;t.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,t.candidate))},e.onicecandidateerror=t=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,t)},e.oniceconnectionstatechange=()=>{var t;(t=this.onIceConnectionStateChange)===null||t===void 0||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;(t=this.onSignalingStatechange)===null||t===void 0||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,e.connectionState)},e.ondatachannel=t=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,t)},e.ontrack=t=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,t)},e}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return he(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,t){return he(this,void 0,void 0,function*(){var r;if(e.type==="answer"&&this.latestOfferId>0&&t>0&&t!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:t,latestOfferId:this.latestOfferId})),!1;let i;if(e.type==="offer"){let{stereoMids:o,nackMids:c}=Xj(e);this.remoteStereoMids=o,this.remoteNackMids=c}else if(e.type==="answer"){const o=Cc.parse((r=e.sdp)!==null&&r!==void 0?r:"");o.media.forEach(c=>{const s=C1(c.mid);c.type==="audio"&&this.trackBitrates.some(l=>{if(!l.transceiver||s!=l.transceiver.mid)return!1;let d=0;if(c.rtp.some(p=>p.codec.toUpperCase()===l.codec.toUpperCase()?(d=p.payload,!0):!1),d===0)return!0;let h=!1;for(const p of c.fmtp)if(p.payload===d){p.config=p.config.split(";").filter(g=>!g.includes("maxaveragebitrate")).join(";"),l.maxbr>0&&(p.config+=";maxaveragebitrate=".concat(l.maxbr*1e3)),h=!0;break}return h||l.maxbr>0&&c.fmtp.push({payload:d,config:"maxaveragebitrate=".concat(l.maxbr*1e3)}),!0})}),i=Cc.write(o)}return yield this.setMungedSDP(e,i,!0),this.pendingCandidates.forEach(o=>{this.pc.addIceCandidate(o)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Eu.NegotiationComplete),e.sdp&&Cc.parse(e.sdp).media.forEach(c=>{c.type==="video"&&this.emit(Eu.RTPVideoPayloadTypes,c.rtp)})),!0})}createAndSendOffer(e){return he(this,void 0,void 0,function*(){var t;const r=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const i=this.latestOfferId+1;this.latestOfferId=i;const o=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:o.sdp},this.logContext));const c=Cc.parse((t=o.sdp)!==null&&t!==void 0?t:"");if(c.media.forEach(s=>{pA(s),s.type==="audio"?hA(s,["all"],[]):s.type==="video"&&this.trackBitrates.some(l=>{if(!s.msid||!l.cid||!s.msid.includes(l.cid))return!1;let d=0;if(s.rtp.some(p=>p.codec.toUpperCase()===l.codec.toUpperCase()?(d=p.payload,!0):!1),d===0||(Ts(l.codec)&&!Tl()&&this.ensureVideoDDExtensionForSVC(s,c),!Ts(l.codec)))return!0;const h=Math.round(l.maxbr*Hj);for(const p of s.fmtp)if(p.payload===d){p.config.includes("x-google-start-bitrate")||(p.config+=";x-google-start-bitrate=".concat(h));break}return!0})}),this.latestOfferId>i){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:i}));return}yield this.setMungedSDP(o,Cc.write(c)),this.onOffer(o,this.latestOfferId)}finally{r()}})}createAndSetAnswer(){return he(this,void 0,void 0,function*(){var e;const t=yield this.pc.createAnswer(),r=Cc.parse((e=t.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{pA(i),i.type==="audio"&&hA(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,Cc.write(r)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTransceiverOfKind(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new Or("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new Or("PC closed, cannot configure");return(t=this._pc)===null||t===void 0?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var t;return(t=this._pc)===null||t===void 0?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&t!==void 0?t:"closed"}getICEConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&t!==void 0?t:"closed"}getSignallingState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&t!==void 0?t:"closed"}getTransceivers(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&t!==void 0?t:[]}getSenders(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&t!==void 0?t:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return he(this,void 0,void 0,function*(){var e;if(!this._pc)return;let t="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(s=>{switch(s.type){case"transport":t=s.selectedCandidatePairId;break;case"candidate-pair":t===""&&s.selected&&(t=s.id),r.set(s.id,s);break;case"remote-candidate":i.set(s.id,"".concat(s.address,":").concat(s.port));break}}),t==="")return;const c=(e=r.get(t))===null||e===void 0?void 0:e.remoteCandidateId;if(c!==void 0)return i.get(c)})}setMungedSDP(e,t,r){return he(this,void 0,void 0,function*(){if(t){const i=e.sdp;e.sdp=t;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(o){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:o,sdp:t})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let o="unknown error";i instanceof Error?o=i.message:typeof i=="string"&&(o=i);const c={error:o,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(c.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:c})),new Su(o)}})}ensureVideoDDExtensionForSVC(e,t){var r,i;if(!((r=e.ext)===null||r===void 0?void 0:r.some(c=>c.uri===KS))){if(this.ddExtID===0){let c=0;t.media.forEach(s=>{var l;s.type==="video"&&((l=s.ext)===null||l===void 0||l.forEach(d=>{d.value>c&&(c=d.value)}))}),this.ddExtID=c+1}(i=e.ext)===null||i===void 0||i.push({value:this.ddExtID,uri:KS})}}}function hA(n,e,t){const r=C1(n.mid);let i=0;n.rtp.some(o=>o.codec==="opus"?(i=o.payload,!0):!1),i>0&&(n.rtcpFb||(n.rtcpFb=[]),t.includes(r)&&!n.rtcpFb.some(o=>o.payload===i&&o.type==="nack")&&n.rtcpFb.push({payload:i,type:"nack"}),(e.includes(r)||e.length===1&&e[0]==="all")&&n.fmtp.some(o=>o.payload===i?(o.config.includes("stereo=1")||(o.config+=";stereo=1"),!0):!1))}function Xj(n){var e;const t=[],r=[],i=Cc.parse((e=n.sdp)!==null&&e!==void 0?e:"");let o=0;return i.media.forEach(c=>{var s;const l=C1(c.mid);c.type==="audio"&&(c.rtp.some(d=>d.codec==="opus"?(o=d.payload,!0):!1),!((s=c.rtcpFb)===null||s===void 0)&&s.some(d=>d.payload===o&&d.type==="nack")&&r.push(l),c.fmtp.some(d=>d.payload===o?(d.config.includes("sprop-stereo=1")&&t.push(l),!0):!1))}),{stereoMids:t,nackMids:r}}function pA(n){if(n.connection){const e=n.connection.ip.indexOf(":")>=0;(n.connection.version===4&&e||n.connection.version===6&&!e)&&(n.connection.ip="0.0.0.0",n.connection.version=4)}}function C1(n){return typeof n=="number"?n.toFixed(0):n}const Ky="vp8",$j={audioPreset:jy.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:f1.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Ky,backupCodec:!0,preConnectBuffer:!1},C2={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},x2={deviceId:{ideal:"default"},resolution:yf.h720.resolution},Kj={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new AU,disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!0},x1={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var _r;(function(n){n[n.NEW=0]="NEW",n[n.CONNECTING=1]="CONNECTING",n[n.CONNECTED=2]="CONNECTED",n[n.FAILED=3]="FAILED",n[n.CLOSING=4]="CLOSING",n[n.CLOSED=5]="CLOSED"})(_r||(_r={}));class qj{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}get mode(){return this._mode}constructor(e,t,r){var i;this.peerConnectionTimeout=x1.peerConnectionTimeout,this.log=gn,this.updateState=()=>{var o,c;const s=this.state,l=this.requiredTransports.map(d=>d.getConnectionState());l.every(d=>d==="connected")?this.state=_r.CONNECTED:l.some(d=>d==="failed")?this.state=_r.FAILED:l.some(d=>d==="connecting")?this.state=_r.CONNECTING:l.every(d=>d==="closed")?this.state=_r.CLOSED:l.some(d=>d==="closed")?this.state=_r.CLOSING:l.every(d=>d==="new")&&(this.state=_r.NEW),s!==this.state&&(this.log.debug("pc state change: from ".concat(_r[s]," to ").concat(_r[this.state]),this.logContext),(o=this.onStateChange)===null||o===void 0||o.call(this,this.state,this.publisher.getConnectionState(),(c=this.subscriber)===null||c===void 0?void 0:c.getConnectionState()))},this.log=Ua((i=r.loggerName)!==null&&i!==void 0?i:Ps.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=t!=="subscriber-primary",this.isSubscriberConnectionRequired=t==="subscriber-primary",this.publisher=new fA(e,r),this._mode=t,t!=="publisher-only"&&(this.subscriber=new fA(e,r),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=o=>{var c;(c=this.onIceCandidate)===null||c===void 0||c.call(this,o,Es.SUBSCRIBER)},this.subscriber.onDataChannel=o=>{var c;(c=this.onDataChannel)===null||c===void 0||c.call(this,o)},this.subscriber.onTrack=o=>{var c;(c=this.onTrack)===null||c===void 0||c.call(this,o)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=o=>{var c;(c=this.onIceCandidate)===null||c===void 0||c.call(this,o,Es.PUBLISHER)},this.publisher.onTrack=o=>{var c;(c=this.onTrack)===null||c===void 0||c.call(this,o)},this.publisher.onOffer=(o,c)=>{var s;(s=this.onPublisherOffer)===null||s===void 0||s.call(this,o,c)},this.state=_r.NEW,this.connectionLock=new $i,this.remoteOfferLock=new $i}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,t){return this.publisher.setRemoteDescription(e,t)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return he(this,void 0,void 0,function*(){var e;if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const t=this.publisher;for(const r of t.getSenders())try{t.canRemoveTrack()&&t.removeTrack(r)}catch(i){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:i}))}}yield Promise.all([this.publisher.close(),(e=this.subscriber)===null||e===void 0?void 0:e.close()]),this.updateState()})}triggerIceRestart(){return he(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return he(this,void 0,void 0,function*(){var r;t===Es.PUBLISHER?yield this.publisher.addIceCandidate(e):yield(r=this.subscriber)===null||r===void 0?void 0:r.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,t){return he(this,void 0,void 0,function*(){var r,i,o;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:(r=this.subscriber)===null||r===void 0?void 0:r.getSignallingState().toString()}));const c=yield this.remoteOfferLock.lock();try{return(yield(i=this.subscriber)===null||i===void 0?void 0:i.setRemoteDescription(e,t))?yield(o=this.subscriber)===null||o===void 0?void 0:o.createAndSetAnswer():void 0}finally{c()}})}updateConfiguration(e,t){var r;this.publisher.setConfiguration(e),(r=this.subscriber)===null||r===void 0||r.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){return he(this,void 0,void 0,function*(){var r;const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(o=>this.ensureTransportConnected(o,e,t)))}finally{i()}})}negotiate(e){return he(this,void 0,void 0,function*(){return new go((t,r)=>he(this,void 0,void 0,function*(){const i=setTimeout(()=>{r(new Su("negotiation timed out"))},this.peerConnectionTimeout),o=()=>{clearTimeout(i),r(new Su("negotiation aborted"))};e.signal.addEventListener("abort",o),this.publisher.once(Eu.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Eu.NegotiationComplete,()=>{clearTimeout(i),t()})}),yield this.publisher.negotiate(c=>{clearTimeout(i),c instanceof Error?r(c):r(new Error(String(c)))})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTransceiverOfKind(e,t){return this.publisher.addTransceiverOfKind(e,t)}getMidForReceiver(e){const r=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(i=>i.receiver===e);return r==null?void 0:r.mid}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===Es.PUBLISHER?this.publisher.getConnectedAddress():e===Es.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&e.push(this.subscriber),e}ensureTransportConnected(e,t){return he(this,arguments,void 0,function(r,i){var o=this;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(r.getConnectionState()!=="connected")return new Promise((l,d)=>he(o,void 0,void 0,function*(){const h=()=>{this.log.warn("abort transport connection",this.logContext),yi.clearTimeout(p),d(tn.cancelled("room connection has been cancelled"))};i!=null&&i.signal.aborted&&h(),i==null||i.signal.addEventListener("abort",h);const p=yi.setTimeout(()=>{i==null||i.signal.removeEventListener("abort",h),d(tn.internal("could not establish pc connection"))},c);for(;this.state!==_r.CONNECTED;)if(yield Ci(50),i!=null&&i.signal.aborted){d(tn.cancelled("room connection has been cancelled"));return}yi.clearTimeout(p),i==null||i.signal.removeEventListener("abort",h),l()}))}()})}}const b2=5e3,Yj=3e4;class Nn{static fetchRegionSettings(e,t,r){return he(this,void 0,void 0,function*(){const i=yield Nn.fetchLock.lock();try{const o=yield fetch("".concat(Qj(e),"/regions"),{headers:{authorization:"Bearer ".concat(t)},signal:r});if(o.ok){const c=xj(o.headers),s=c?c*1e3:b2;return{regionSettings:yield o.json(),updatedAtInMs:Date.now(),maxAgeInMs:s}}else throw o.status===401?tn.notAllowed("Could not fetch region settings: ".concat(o.statusText),o.status):tn.internal("Could not fetch region settings: ".concat(o.statusText))}catch(o){throw o instanceof tn?o:r!=null&&r.aborted?tn.cancelled("Region fetching was aborted"):tn.serverUnreachable("Could not fetch region settings, ".concat(o instanceof Error?"".concat(o.name,": ").concat(o.message):o))}finally{i()}})}static scheduleRefetch(e,t,r){return he(this,void 0,void 0,function*(){const i=Nn.settingsTimeouts.get(e.hostname);clearTimeout(i),Nn.settingsTimeouts.set(e.hostname,setTimeout(()=>he(this,void 0,void 0,function*(){try{const o=yield Nn.fetchRegionSettings(e,t);Nn.updateCachedRegionSettings(e,t,o)}catch(o){if(o instanceof tn&&o.reason===Kn.NotAllowed){gn.debug("token is not valid, cancelling auto region refresh");return}gn.debug("auto refetching of region settings failed",{error:o}),Nn.scheduleRefetch(e,t,r)}}),r))})}static updateCachedRegionSettings(e,t,r){Nn.cache.set(e.hostname,r),Nn.scheduleRefetch(e,t,r.maxAgeInMs)}static stopRefetch(e){const t=Nn.settingsTimeouts.get(e);t&&(clearTimeout(t),Nn.settingsTimeouts.delete(e))}static scheduleCleanup(e){let t=Nn.connectionTrackers.get(e);t&&(t.cleanupTimeout&&clearTimeout(t.cleanupTimeout),t.cleanupTimeout=setTimeout(()=>{const r=Nn.connectionTrackers.get(e);r&&r.connectionCount===0&&(gn.debug("stopping region refetch after disconnect delay",{hostname:e}),Nn.stopRefetch(e)),r&&(r.cleanupTimeout=void 0)},Yj))}static cancelCleanup(e){const t=Nn.connectionTrackers.get(e);t!=null&&t.cleanupTimeout&&(clearTimeout(t.cleanupTimeout),t.cleanupTimeout=void 0)}notifyConnected(){const e=this.serverUrl.hostname;let t=Nn.connectionTrackers.get(e);t||(t={connectionCount:0},Nn.connectionTrackers.set(e,t)),t.connectionCount++,Nn.cancelCleanup(e)}notifyDisconnected(){const e=this.serverUrl.hostname,t=Nn.connectionTrackers.get(e);t&&(t.connectionCount=Math.max(0,t.connectionCount-1),t.connectionCount===0&&Nn.scheduleCleanup(e))}constructor(e,t){this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return Uu(this.serverUrl)}getServerUrl(){return this.serverUrl}fetchRegionSettings(e){return he(this,void 0,void 0,function*(){return Nn.fetchRegionSettings(this.serverUrl,this.token,e)})}getNextBestRegionUrl(e){return he(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");let t=Nn.cache.get(this.serverUrl.hostname);(!t||Date.now()-t.updatedAtInMs>t.maxAgeInMs)&&(t=yield this.fetchRegionSettings(e),Nn.updateCachedRegionSettings(this.serverUrl,this.token,t));const r=t.regionSettings.regions.filter(i=>!this.attemptedRegions.find(o=>o.url===i.url));if(r.length>0){const i=r[0];return this.attemptedRegions.push(i),gn.debug("next region: ".concat(i.region)),i.url}else return null})}resetAttempts(){this.attemptedRegions=[]}setServerReportedRegions(e){Nn.updateCachedRegionSettings(this.serverUrl,this.token,e)}}Nn.cache=new Map;Nn.settingsTimeouts=new Map;Nn.connectionTrackers=new Map;Nn.fetchLock=new $i;function Qj(n){return"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")}class Pr extends Error{constructor(e,t,r){super(t),this.code=e,this.message=gA(t,Pr.MAX_MESSAGE_BYTES),this.data=r?gA(r,Pr.MAX_DATA_BYTES):void 0}static fromProto(e){return new Pr(e.code,e.message,e.data)}toProto(){return new p_({code:this.code,message:this.message,data:this.data})}static builtIn(e,t){return new Pr(Pr.ErrorCode[e],Pr.ErrorMessage[e],t)}}Pr.MAX_MESSAGE_BYTES=256;Pr.MAX_DATA_BYTES=15360;Pr.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};Pr.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const I2=15360;function b1(n){return new TextEncoder().encode(n).length}function gA(n,e){if(b1(n)<=e)return n;let t=0,r=n.length;const i=new TextEncoder;for(;t<r;){const o=Math.floor((t+r+1)/2);i.encode(n.slice(0,o)).length<=e?t=o:r=o-1}return n.slice(0,t)}const I1=2e3;function sg(n,e){if(!e)return 0;let t,r;return"bytesReceived"in n?(t=n.bytesReceived,r=e.bytesReceived):"bytesSent"in n&&(t=n.bytesSent,r=e.bytesSent),t===void 0||r===void 0||n.timestamp===void 0||e.timestamp===void 0?0:(t-r)*8*1e3/(n.timestamp-e.timestamp)}const w1=typeof MediaRecorder<"u";class Jj{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const eV=w1?MediaRecorder:Jj;class tV extends eV{constructor(e,t){if(!w1)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),t);let r,i;const o=()=>i===void 0,c=()=>{this.removeEventListener("dataavailable",r),this.removeEventListener("stop",c),this.removeEventListener("error",s),i==null||i.close(),i=void 0},s=l=>{i==null||i.error(l),this.removeEventListener("dataavailable",r),this.removeEventListener("stop",c),this.removeEventListener("error",s),i=void 0};this.byteStream=new ReadableStream({start:l=>{i=l,r=d=>he(this,void 0,void 0,function*(){let h;if(d.data.arrayBuffer){const p=yield d.data.arrayBuffer();h=new Uint8Array(p)}else if(d.data.byteArray)h=d.data.byteArray;else throw new Error("no data available!");o()||l.enqueue(h)}),this.addEventListener("dataavailable",r)},cancel:()=>{c()}}),this.addEventListener("stop",c),this.addEventListener("error",s)}}function nV(){return w1}const rV=1e3,iV=1e4;class w2 extends je{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;super(e,t,o),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=y1(()=>he(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>he(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(ht.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new $i,this.pauseUpstreamLock=new $i,this.trackChangeLock=new $i,this.trackChangeLock.lock().then(c=>he(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{c()}})),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==je.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();if(e&&t)return{width:e,height:t}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return(t=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&t!==void 0?t:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,t){return he(this,void 0,void 0,function*(){var r;if(e===this._mediaStreamTrack&&!t)return;this._mediaStreamTrack&&(this.attachedElements.forEach(o=>{Au(this._mediaStreamTrack,o)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let i;if(this.processor&&e){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(mu(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}this.sender&&((r=this.sender.transport)===null||r===void 0?void 0:r.state)!=="closed"&&(yield this.sender.replaceTrack(i??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(o=>{mu(i??e,o)}))})}waitForDimensions(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rV;return function*(){var r;if(e.kind===je.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((r=Ki())===null||r===void 0?void 0:r.os)==="iOS"&&(yield Ci(10));const i=Date.now();for(;Date.now()-i<t;){const o=e.dimensions;if(o)return o;yield Ci(50)}throw new Na("unable to get track dimensions after timeout")}()})}setDeviceId(e){return he(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Tc(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Tc(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===je.Source.ScreenShare)return;const{deviceId:r,groupId:i}=e._mediaStreamTrack.getSettings(),o=e.kind===je.Kind.Audio?"audioinput":"videoinput";return t?ui.getInstance().normalizeDeviceId(o,r,i):r}()})}mute(){return he(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return he(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,t){return he(this,void 0,void 0,function*(){const r=yield this.trackChangeLock.lock();try{if(!this.sender)throw new Na("unable to replace an unpublished track");let i,o;return typeof t=="boolean"?i=t:t!==void 0&&(i=t.userProvidedTrack,o=t.stopProcessor),this.providedByUser=i??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),o&&this.processor&&(yield this.internalStopProcessor()),this}finally{r()}})}restart(e){return he(this,void 0,void 0,function*(){this.manuallyStopped=!1;const t=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:r,facingMode:i}=e,o=kU(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const c={audio:!1,video:!1};this.kind===je.Kind.Video?c.video=r||i?{deviceId:r,facingMode:i}:!0:c.audio=r?Object.assign({deviceId:r},o):!0,this.attachedElements.forEach(d=>{Au(this.mediaStreamTrack,d)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const l=(yield navigator.mediaDevices.getUserMedia(c)).getTracks()[0];return this.kind===je.Kind.Video&&(yield l.applyConstraints(o)),l.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(l),this._constraints=e,this.emit(ht.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{t()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ht.Muted:ht.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return he(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),g2()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return he(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(ht.UpstreamPaused,this);const r=Ki();if((r==null?void 0:r.name)==="Safari"&&Ms(r.version,"12.0")<0)throw new d1("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{t()}})}resumeUpstream(){return he(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(ht.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{t()}})}getRTCStatsReport(){return he(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o;const c=yield r.trackChangeLock.lock();try{r.log.debug("setting up processor",r.logContext);const s=document.createElement(r.kind),l={kind:r.kind,track:r._mediaStreamTrack,element:s,audioContext:r.audioContext};if(yield t.init(l),r.log.debug("processor initialized",r.logContext),r.processor&&(yield r.internalStopProcessor()),r.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(mu(r._mediaStreamTrack,s),s.muted=!0,s.play().catch(d=>{d instanceof DOMException&&d.name==="AbortError"?(r.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},r.logContext),{error:d})),setTimeout(()=>{s.play().catch(h=>{r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{err:h}))})},100)):r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{error:d}))}),r.processor=t,r.processorElement=s,r.processor.processedTrack){for(const d of r.attachedElements)d!==r.processorElement&&i&&(Au(r._mediaStreamTrack,d),mu(r.processor.processedTrack,d));yield(o=r.sender)===null||o===void 0?void 0:o.replaceTrack(r.processor.processedTrack)}r.emit(ht.TrackProcessorUpdate,r.processor)}finally{c()}}()})}getProcessor(){return this.processor}stopProcessor(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(t)}finally{r()}}()})}internalStopProcessor(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var r,i;e.processor&&(e.log.debug("stopping processor",e.logContext),(r=e.processor.processedTrack)===null||r===void 0||r.stop(),yield e.processor.destroy(),e.processor=void 0,t||((i=e.processorElement)===null||i===void 0||i.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(ht.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!nV()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let t="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(t)||(t="video/mp4"),this.localTrackRecorder=new tV(this,{mimeType:t})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},iV)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class Dp extends w2{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(e,je.Kind.Audio,t,r,o),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>he(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let c;try{c=yield this.getSenderStats()}catch(s){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:s}));return}c&&this.prevStats&&(this._currentBitrate=sg(c,this.prevStats)),this.prevStats=c}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(ht.AudioTrackFeatureUpdate,this,li.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(ht.AudioTrackFeatureUpdate,this,li.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=i,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return he(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===je.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return he(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Tc(this._constraints.deviceId);return this.source===je.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return he(this,void 0,void 0,function*(){let t;if(e){const r=h1({audio:e});typeof r.audio!="boolean"&&(t=r.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return he(this,void 0,void 0,function*(){const r=yield t.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){mo()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},I1)))}setProcessor(e){return he(this,void 0,void 0,function*(){var t;const r=yield this.trackChangeLock.lock();try{if(!na()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(t=this.sender)===null||t===void 0?void 0:t.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(ht.TrackProcessorUpdate,this.processor)}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return he(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const t=yield this.sender.getStats();let r;return t.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return he(this,void 0,void 0,function*(){const e=yield h2(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit(ht.AudioSilenceDetected)),e})}}function oV(n,e,t){switch(n.kind){case"audio":return new Dp(n,e,!1,void 0,t);case"video":return new Pp(n,e,!1,t);default:throw new Na("unsupported track type: ".concat(n.kind))}}const sV=Object.values(yf),aV=Object.values(Vy),cV=Object.values(f1),lV=[yf.h180,yf.h360],uV=[Vy.h180,Vy.h360],dV=n=>[{scaleResolutionDownBy:2,fps:n.encoding.maxFramerate}].map(t=>{var r,i;return new Xn(Math.floor(n.width/t.scaleResolutionDownBy),Math.floor(n.height/t.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(t.scaleResolutionDownBy,2)*(((r=n.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=t.fps)!==null&&i!==void 0?i:30))))),t.fps,n.encoding.priority)}),qy=["q","h","f"];function Yy(n,e,t,r){var i,o;let c=r==null?void 0:r.videoEncoding;n&&(c=r==null?void 0:r.screenShareEncoding);const s=r==null?void 0:r.simulcast,l=r==null?void 0:r.scalabilityMode,d=r==null?void 0:r.videoCodec;if(!c&&!s&&!l||!e||!t)return[{}];c||(c=hV(n,e,t,d),gn.debug("using video encoding",c));const h=c.maxFramerate,p=new Xn(e,t,c.maxBitrate,c.maxFramerate,c.priority);if(l&&Ts(d)){const C=new S2(l),x=[];if(C.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(l));const w=Ki();if(Cf()||na()||(w==null?void 0:w.name)==="Chrome"&&Ms(w==null?void 0:w.version,"113")<0){const S=C.suffix=="h"?2:3,E=aj(w);for(let R=0;R<C.spatial;R+=1)x.push({rid:qy[2-R],maxBitrate:c.maxBitrate/Math.pow(S,R),maxFramerate:p.encoding.maxFramerate,scaleResolutionDownBy:E?Math.pow(2,R):void 0});x[0].scalabilityMode=l}else x.push({maxBitrate:c.maxBitrate,maxFramerate:p.encoding.maxFramerate,scalabilityMode:l});return p.encoding.priority&&(x[0].priority=p.encoding.priority,x[0].networkPriority=p.encoding.priority),gn.debug("using svc encoding",{encodings:x}),x}if(!s)return[c];let g=[];n?g=(i=vA(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:mA(n,p):g=(o=vA(r==null?void 0:r.videoSimulcastLayers))!==null&&o!==void 0?o:mA(n,p);let y;if(g.length>0){const C=g[0];g.length>1&&([,y]=g);const x=Math.max(e,t);if(x>=960&&y)return Dv(e,t,[C,y,p],h);if(x>=480)return Dv(e,t,[C,p],h)}return Dv(e,t,[p])}function fV(n,e,t){var r,i,o,c;if(!t.backupCodec||t.backupCodec===!0||t.backupCodec.codec===t.videoCodec)return;e!==t.backupCodec.codec&&gn.warn("requested a different codec than specified as backup",{serverRequested:e,backup:t.backupCodec.codec}),t.videoCodec=e,t.videoEncoding=t.backupCodec.encoding;const s=n.mediaStreamTrack.getSettings(),l=(r=s.width)!==null&&r!==void 0?r:(i=n.dimensions)===null||i===void 0?void 0:i.width,d=(o=s.height)!==null&&o!==void 0?o:(c=n.dimensions)===null||c===void 0?void 0:c.height;return n.source===je.Source.ScreenShare&&t.simulcast&&(t.simulcast=!1),Yy(n.source===je.Source.ScreenShare,l,d,t)}function hV(n,e,t,r){const i=pV(n,e,t);let{encoding:o}=i[0];const c=Math.max(e,t);for(let s=0;s<i.length;s+=1){const l=i[s];if(o=l.encoding,l.width>=c)break}if(r)switch(r){case"av1":case"h265":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.7;break;case"vp9":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.85;break}return o}function pV(n,e,t){if(n)return cV;const r=e>t?e/t:t/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?sV:aV}function mA(n,e){if(n)return dV(e);const{width:t,height:r}=e,i=t>r?t/r:r/t;return Math.abs(i-16/9)<Math.abs(i-4/3)?lV:uV}function Dv(n,e,t,r){const i=[];if(t.forEach((o,c)=>{if(c>=qy.length)return;const s=Math.min(n,e),d={rid:qy[c],scaleResolutionDownBy:Math.max(1,s/Math.min(o.width,o.height)),maxBitrate:o.encoding.maxBitrate},h=r&&o.encoding.maxFramerate?Math.min(r,o.encoding.maxFramerate):o.encoding.maxFramerate;h&&(d.maxFramerate=h);const p=El()||c===0;o.encoding.priority&&p&&(d.priority=o.encoding.priority,d.networkPriority=o.encoding.priority),i.push(d)}),na()&&v2()==="ios"){let o;i.forEach(s=>{o?s.maxFramerate&&s.maxFramerate>o&&(o=s.maxFramerate):o=s.maxFramerate});let c=!0;i.forEach(s=>{var l;s.maxFramerate!=o&&(c&&(c=!1,gn.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),gn.info('Setting framerate of encoding "'.concat((l=s.rid)!==null&&l!==void 0?l:"",'" to ').concat(o)),s.maxFramerate=o)})}return i}function vA(n){if(n)return n.sort((e,t)=>{const{encoding:r}=e,{encoding:i}=t;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class S2{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function gV(n){return n.source===je.Source.ScreenShare||n.constraints.height&&Tc(n.constraints.height)>=1080?"maintain-resolution":"balanced"}const mV=5e3;class Pp extends w2{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,je.Kind.Video,t,r,i),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>he(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(l){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:l}));return}const c=new Map(o.map(l=>[l.rid,l])),s=o.some(l=>l.qualityLimitationReason==="cpu");if(s!==this.isCpuConstrained&&(this.isCpuConstrained=s,this.isCpuConstrained&&this.emit(ht.CpuConstrained)),this.prevStats){let l=0;c.forEach((d,h)=>{var p;const g=(p=this.prevStats)===null||p===void 0?void 0:p.get(h);l+=sg(d,g)}),this._currentBitrate=l}this.prevStats=c}),this.senderLock=new $i}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!mo())return;const r=(t=this.sender)===null||t===void 0?void 0:t.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},I1))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return he(this,void 0,void 0,function*(){var t,r,i,o,c;yield e.pauseUpstream.call(this);try{for(var s=!0,l=Ma(this.simulcastCodecs.values()),d;d=yield l.next(),t=d.done,!t;s=!0)o=d.value,s=!1,yield(c=o.sender)===null||c===void 0?void 0:c.replaceTrack(null)}catch(h){r={error:h}}finally{try{!s&&!t&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return he(this,void 0,void 0,function*(){var t,r,i,o,c;yield e.resumeUpstream.call(this);try{for(var s=!0,l=Ma(this.simulcastCodecs.values()),d;d=yield l.next(),t=d.done,!t;s=!0){o=d.value,s=!1;const h=o;yield(c=h.sender)===null||c===void 0?void 0:c.replaceTrack(h.mediaStreamTrack)}}catch(h){r={error:h}}finally{try{!s&&!t&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return he(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===je.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return he(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.source===je.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){return he(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const t=[],r=yield this.sender.getStats();return r.forEach(i=>{var o;if(i.type==="outbound-rtp"){const c={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,framesPerSecond:i.framesPerSecond,framesSent:i.framesSent,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationDurations:i.qualityLimitationDurations,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges,rid:(o=i.rid)!==null&&o!==void 0?o:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,targetBitrate:i.targetBitrate,timestamp:i.timestamp},s=r.get(i.remoteId);s&&(c.jitter=s.jitter,c.packetsLost=s.packetsLost,c.roundTripTime=s.roundTripTime),t.push(c)}}),t.sort((i,o)=>{var c,s;return((c=o.frameWidth)!==null&&c!==void 0?c:0)-((s=i.frameWidth)!==null&&s!==void 0?s:0)}),t})}setPublishingQuality(e){const t=[];for(let r=No.LOW;r<=No.HIGH;r+=1)t.push(new a1({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(Ts(this.codec),t)}restartTrack(e){return he(this,void 0,void 0,function*(){var t,r,i,o,c;let s;if(e){const p=h1({video:e});typeof p.video!="boolean"&&(s=p.video)}yield this.restart(s),this.isCpuConstrained=!1;try{for(var l=!0,d=Ma(this.simulcastCodecs.values()),h;h=yield d.next(),t=h.done,!t;l=!0){o=h.value,l=!1;const p=o;p.sender&&((c=p.sender.transport)===null||c===void 0?void 0:c.state)!=="closed"&&(p.mediaStreamTrack=this.mediaStreamTrack.clone(),yield p.sender.replaceTrack(p.mediaStreamTrack))}}catch(p){r={error:p}}finally{try{!l&&!t&&(i=d.return)&&(yield i.call(d))}finally{if(r)throw r.error}}})}setProcessor(e){const t=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return he(this,arguments,void 0,function(r){var i=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var c,s,l,d,h,p;if(yield t.setProcessor.call(i,r,o),!((h=i.processor)===null||h===void 0)&&h.processedTrack)try{for(var g=!0,y=Ma(i.simulcastCodecs.values()),C;C=yield y.next(),c=C.done,!c;g=!0)d=C.value,g=!1,yield(p=d.sender)===null||p===void 0?void 0:p.replaceTrack(i.processor.processedTrack)}catch(x){s={error:x}}finally{try{!g&&!c&&(l=y.return)&&(yield l.call(y))}finally{if(s)throw s.error}}}()})}setDegradationPreference(e){return he(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const t=this.sender.getParameters();t.degradationPreference=e,this.sender.setParameters(t)}catch(t){this.log.warn("failed to set degradationPreference",Object.assign({error:t},this.logContext))}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,t){const r=this.simulcastCodecs.get(e);r&&(r.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},mV))}setPublishingCodecs(e){return he(this,void 0,void 0,function*(){var t,r,i,o,c,s,l;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(Ts(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const d=[];try{for(t=!0,r=Ma(e);i=yield r.next(),o=i.done,!o;t=!0){l=i.value,t=!1;const h=l;if(!this.codec||this.codec===h.codec)yield this.setPublishingLayers(Ts(h.codec),h.qualities);else{const p=this.simulcastCodecs.get(h.codec);if(this.log.debug("try setPublishingCodec for ".concat(h.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:p})),!p||!p.sender){for(const g of h.qualities)if(g.enabled){d.push(h.codec);break}}else p.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(h.codec),this.logContext),yield yA(p.sender,p.encodings,h.qualities,this.senderLock,Ts(h.codec),this.log,this.logContext))}}}catch(h){c={error:h}}finally{try{!t&&!o&&(s=r.return)&&(yield s.call(r))}finally{if(c)throw c.error}}return d})}setPublishingLayers(e,t){return he(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:t}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),!(!this.sender||!this.encodings)&&(yield yA(this.sender,this.encodings,t,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return he(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const t=this.sender.getParameters();t.encodings=t.encodings.map((r,i)=>{var o;return Object.assign(Object.assign({},r),{active:i===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((o=this.mediaStreamTrack.getSettings().height)!==null&&o!==void 0?o:360)/360)),scalabilityMode:i===0&&Ts(this.codec)?"L1T3":void 0,maxFramerate:i===0?15:0,maxBitrate:i===0?r.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:t.encodings})),this.encodings=t.encodings,yield this.sender.setParameters(t)}catch(t){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:t})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return he(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),g2()&&this.isInBackground&&this.source===je.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function yA(n,e,t,r,i,o,c){return he(this,void 0,void 0,function*(){const s=yield r.lock();o.debug("setPublishingLayersForSender",Object.assign(Object.assign({},c),{sender:n,qualities:t,senderEncodings:e}));try{const l=n.getParameters(),{encodings:d}=l;if(!d)return;if(d.length!==e.length){o.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},c),{encodings:d,senderEncodings:e}));return}let h=!1;!1&&d[0].scalabilityMode||(i&&t.some(y=>y.enabled)&&t.forEach(y=>y.enabled=!0),d.forEach((g,y)=>{var C;let x=(C=g.rid)!==null&&C!==void 0?C:"";x===""&&(x="q");const w=A2(x),S=t.find(E=>E.quality===w);S&&g.active!==S.enabled&&(h=!0,g.active=S.enabled,o.debug("setting layer ".concat(S.quality," to ").concat(g.active?"enabled":"disabled"),c),El()&&(S.enabled?(g.scaleResolutionDownBy=e[y].scaleResolutionDownBy,g.maxBitrate=e[y].maxBitrate,g.maxFrameRate=e[y].maxFrameRate):(g.scaleResolutionDownBy=4,g.maxBitrate=10,g.maxFrameRate=2)))})),h&&(l.encodings=d,o.debug("setting encodings",Object.assign(Object.assign({},c),{encodings:l.encodings})),yield n.setParameters(l))}finally{s()}})}function A2(n){switch(n){case"f":return No.HIGH;case"h":return No.MEDIUM;case"q":return No.LOW;default:return No.HIGH}}function CA(n,e,t,r){if(!t)return[new Ec({quality:No.HIGH,width:n,height:e,bitrate:0,ssrc:0})];if(r){const i=t[0].scalabilityMode,o=new S2(i),c=[],s=o.suffix=="h"?1.5:2,l=o.suffix=="h"?2:3;for(let d=0;d<o.spatial;d+=1)c.push(new Ec({quality:Math.min(No.HIGH,o.spatial-1)-d,width:Math.ceil(n/Math.pow(s,d)),height:Math.ceil(e/Math.pow(s,d)),bitrate:t[0].maxBitrate?Math.ceil(t[0].maxBitrate/Math.pow(l,d)):0,ssrc:0}));return c}return t.map(i=>{var o,c,s;const l=(o=i.scaleResolutionDownBy)!==null&&o!==void 0?o:1;let d=A2((c=i.rid)!==null&&c!==void 0?c:"");return new Ec({quality:d,width:Math.ceil(n/l),height:Math.ceil(e/l),bitrate:(s=i.maxBitrate)!==null&&s!==void 0?s:0,ssrc:0})})}const xA="_lossy",bA="_reliable",vV=2*1e3,Pv="leave-reconnect",yV=3e4,CV=8*1024,xV=256*1024;var Yo;(function(n){n[n.New=0]="New",n[n.Connected=1]="Connected",n[n.Disconnected=2]="Disconnected",n[n.Reconnecting=3]="Reconnecting",n[n.Closed=4]="Closed"})(Yo||(Yo={}));class bV extends ca.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=x1.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=Yo.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=gn,this.reliableDataSequence=1,this.reliableMessageBuffer=new aA,this.reliableReceivedState=new Vj(yV),this.lossyDataStatCurrentBytes=0,this.lossyDataStatByterate=0,this.lossyDataDropCount=0,this.midToTrackId={},this.isWaitingForNetworkReconnect=!1,this.handleDataChannel=r=>he(this,[r],void 0,function(i){var o=this;let{channel:c}=i;return function*(){if(c){if(c.label===bA)o.reliableDCSub=c;else if(c.label===xA)o.lossyDCSub=c;else return;o.log.debug("on data channel ".concat(c.id,", ").concat(c.label),o.logContext),c.onmessage=o.handleDataMessage}}()}),this.handleDataMessage=r=>he(this,void 0,void 0,function*(){var i,o,c,s,l;const d=yield this.dataProcessLock.lock();try{let h;if(r.data instanceof ArrayBuffer)h=r.data;else if(r.data instanceof Blob)h=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const p=Hi.fromBinary(new Uint8Array(h));if(p.sequence>0&&p.participantSid!==""){const g=this.reliableReceivedState.get(p.participantSid);if(g&&p.sequence<=g)return;this.reliableReceivedState.set(p.participantSid,p.sequence)}if(((i=p.value)===null||i===void 0?void 0:i.case)==="speaker")this.emit(vt.ActiveSpeakersUpdate,p.value.value.speakers);else if(((o=p.value)===null||o===void 0?void 0:o.case)==="encryptedPacket"){if(!this.e2eeManager){this.log.error("Received encrypted packet but E2EE not set up",this.logContext);return}const g=yield(c=this.e2eeManager)===null||c===void 0?void 0:c.handleEncryptedData(p.value.value.encryptedValue,p.value.value.iv,p.participantIdentity,p.value.value.keyIndex),y=d_.fromBinary(g.payload),C=new Hi({value:y.value,participantIdentity:p.participantIdentity,participantSid:p.participantSid});((s=C.value)===null||s===void 0?void 0:s.case)==="user"&&IA(C,C.value.value),this.emit(vt.DataPacketReceived,C,p.value.value.encryptionType)}else((l=p.value)===null||l===void 0?void 0:l.case)==="user"&&IA(p,p.value.value),this.emit(vt.DataPacketReceived,p,Yr.NONE)}finally{d()}}),this.handleDataError=r=>{const o=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:c}=r.error;this.log.error("DataChannel error on ".concat(o,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:c}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const o=r.currentTarget.maxRetransmits===0?Sn.LOSSY:Sn.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const o=l=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(l,"ms. giving up"),this.logContext),this.emit(vt.Disconnected),this.close()},c=Date.now()-this.reconnectStart;let s=this.getNextRetryDelay({elapsedMs:c,retryCount:this.reconnectAttempts});if(s===null){o(c);return}r===Pv&&(s=0),this.log.debug("reconnecting in ".concat(s,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=yi.setTimeout(()=>this.attemptReconnect(i).finally(()=>this.reconnectTimeout=void 0),s)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===Yo.Connected&&r();const o=()=>{this.off(vt.Disconnected,c),r()},c=()=>{this.off(vt.Restarted,o),i()};this.once(vt.Restarted,o),this.once(vt.Disconnected,c)}),this.updateAndEmitDCBufferStatus=r=>{if(r===Sn.RELIABLE){const o=this.dataChannelForKind(r);o&&this.reliableMessageBuffer.alignBufferedAmount(o.bufferedAmount)}const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(vt.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>he(this,void 0,void 0,function*(){!this.url||!(yield fetch(xf(this.url),{method:"HEAD"}).then(i=>i.ok).catch(()=>!1))||(this.log.info("detected network reconnected"),(this.client.currentState===$n.RECONNECTING||this.isWaitingForNetworkReconnect&&this.client.currentState===$n.CONNECTED)&&(this.clearReconnectTimeout(),this.attemptReconnect(cl.RR_SIGNAL_DISCONNECTED),this.isWaitingForNetworkReconnect=!1))}),this.handleBrowserOffline=()=>he(this,void 0,void 0,function*(){if(this.url)try{yield Promise.race([fetch(xf(this.url),{method:"HEAD"}),Ci(4e3).then(()=>Promise.reject())])}catch{window.navigator.onLine===!1&&(this.log.info("detected network interruption"),this.isWaitingForNetworkReconnect=!0)}}),this.log=Ua((t=e.loggerName)!==null&&t!==void 0?t:Ps.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new m1(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new $i,this.dataProcessLock=new $i,this.dcBufferStatus=new Map([[Sn.LOSSY,!0],[Sn.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(vt.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(vt.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(vt.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(vt.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(vt.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(vt.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(vt.StreamStateChanged,r),this.client.onRequestResponse=r=>this.emit(vt.SignalRequestResponse,r)}get logContext(){var e,t,r,i,o,c;return{room:(t=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||t===void 0?void 0:t.name,roomID:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,participant:(c=(o=this.latestJoinResponse)===null||o===void 0?void 0:o.participant)===null||c===void 0?void 0:c.identity,pID:this.participantSid}}join(e,t,r,i){return he(this,arguments,void 0,function(o,c,s,l){var d=this;let h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return function*(){d.url=o,d.token=c,d.signalOpts=s,d.maxJoinAttempts=s.maxRetries;try{d.joinAttempts+=1,d.setupSignalClientCallbacks();const p=yield d.client.join(o,c,s,l,h);return d._isClosed=!1,d.latestJoinResponse=p,d.subscriberPrimary=p.subscriberPrimary,d.pcManager||(yield d.configure(p,!h)),(!d.subscriberPrimary||p.fastPublish)&&d.negotiate().catch(g=>{gn.error(g,d.logContext)}),d.registerOnLineListener(),d.clientConfiguration=p.clientConfiguration,d.emit(vt.SignalConnected,p),p}catch(p){if(p instanceof tn){if(p.reason===Kn.ServerUnreachable){if(d.log.warn("Couldn't connect to server, attempt ".concat(d.joinAttempts," of ").concat(d.maxJoinAttempts),d.logContext),d.joinAttempts<d.maxJoinAttempts)return d.join(o,c,s,l,h)}else if(p.reason===Kn.ServiceNotFound)return d.log.warn("Initial connection failed: ".concat(p.message,"  Retrying")),d.join(o,c,s,l,!0)}throw p}}()})}close(){return he(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(vt.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),this.cleanupLossyDataStats(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return he(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const t=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new aA,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupLossyDataStats(){this.lossyDataStatByterate=0,this.lossyDataStatCurrentBytes=0,this.lossyDataStatInterval&&(clearInterval(this.lossyDataStatInterval),this.lossyDataStatInterval=void 0),this.lossyDataDropCount=0}cleanupClient(){return he(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Na("a track with the same ID has already been published");return new Promise((t,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(tn.timeout("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:o=>{clearTimeout(i),t(o)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(t){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:t}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return he(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e,t){return he(this,void 0,void 0,function*(){var r,i;if(this.pcManager&&this.pcManager.currentState!==_r.NEW)return;this.participantSid=(r=e.participant)===null||r===void 0?void 0:r.sid;const o=this.makeRTCConfiguration(e);this.pcManager=new qj(o,t?"publisher-only":e.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(vt.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(c,s)=>{this.client.sendIceCandidate(c,s)},this.pcManager.onPublisherOffer=(c,s)=>{this.client.sendOffer(c,s)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(c,s,l)=>he(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(c),this.logContext),["closed","disconnected","failed"].includes(s)&&(this.publisherConnectionPromise=void 0),c===_r.CONNECTED){const p=this.pcState===Yo.New;this.pcState=Yo.Connected,p&&this.emit(vt.Connected,e)}else c===_r.FAILED&&(this.pcState===Yo.Connected||this.pcState===Yo.Reconnecting)&&(this.pcState=Yo.Disconnected,this.handleDisconnect("peerconnection failed",l==="failed"?cl.RR_SUBSCRIBER_FAILED:cl.RR_PUBLISHER_FAILED));const d=this.client.isDisconnected||this.client.currentState===$n.RECONNECTING,h=[_r.FAILED,_r.CLOSING,_r.CLOSED].includes(c);d&&h&&!this._isClosed&&this.emit(vt.Offline)}),this.pcManager.onTrack=c=>{c.streams.length!==0&&this.emit(vt.MediaTrackAdded,c.track,c.streams[0],c.receiver)},IV((i=e.serverInfo)===null||i===void 0?void 0:i.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,t,r)=>he(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,midToTrackId:r})),this.midToTrackId=r,yield this.pcManager.setPublisherAnswer(e,t))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=(e,t,r)=>he(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=t,!this.pcManager)return;this.midToTrackId=r;const i=yield this.pcManager.createSubscriberAnswerFromOffer(e,t);i&&this.client.sendAnswer(i,t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(t=e.track)===null||t===void 0?void 0:t.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(vt.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(vt.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{var t;this.token=e,(t=this.regionUrlProvider)===null||t===void 0||t.updateToken(e)},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(vt.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(vt.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var t;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(vt.RoomMoved,e)},this.client.onMediaSectionsRequirement=e=>{var t,r;const i={direction:"recvonly"};for(let o=0;o<e.numAudios;o++)(t=this.pcManager)===null||t===void 0||t.addPublisherTransceiverOfKind("audio",i);for(let o=0;o<e.numVideos;o++)(r=this.pcManager)===null||r===void 0||r.addPublisherTransceiverOfKind("video",i);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",cl.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions({updatedAtInMs:Date.now(),maxAgeInMs:b2,regionSettings:e.regions})),e.action){case Iu.DISCONNECT:this.emit(vt.Disconnected,e==null?void 0:e.reason),this.close();break;case Iu.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(Pv);break;case Iu.RESUME:this.handleDisconnect(Pv)}}}makeRTCConfiguration(e){var t;const r=Object.assign({},this.rtcConfig);if(!((t=this.signalOpts)===null||t===void 0)&&t.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(o=>{const c={urls:o.urls};o.username&&(c.username=o.username),o.credential&&(c.credential=o.credential),i.push(c)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===pf.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(xA,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(bA,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow,this.cleanupLossyDataStats(),this.lossyDataStatInterval=setInterval(()=>{this.lossyDataStatByterate=this.lossyDataStatCurrentBytes,this.lossyDataStatCurrentBytes=0;const e=this.dataChannelForKind(Sn.LOSSY);if(e){const t=this.lossyDataStatByterate/10;e.bufferedAmountLowThreshold=Math.min(Math.max(t,CV),xV)}},1e3))}createSender(e,t,r){return he(this,void 0,void 0,function*(){if(zy())return yield this.createTransceiverRTCRtpSender(e,t,r);if(Hy())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Or("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,r,i){return he(this,void 0,void 0,function*(){if(zy())return this.createSimulcastTransceiverSender(e,t,r,i);if(Hy())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Or("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,r){return he(this,void 0,void 0,function*(){if(!this.pcManager)throw new Or("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream),jc(e)&&(e.codec=t.videoCodec);const o={direction:"sendonly",streams:i};return r&&(o.sendEncodings=r),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,o)).sender})}createSimulcastTransceiverSender(e,t,r,i){return he(this,void 0,void 0,function*(){if(!this.pcManager)throw new Or("publisher is closed");const o={direction:"sendonly"};i&&(o.sendEncodings=i);const c=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,o);if(r.videoCodec)return e.setSimulcastTrackSender(r.videoCodec,c.sender),c.sender})}createRTCRtpSender(e){return he(this,void 0,void 0,function*(){if(!this.pcManager)throw new Or("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return he(this,void 0,void 0,function*(){var t,r,i;if(!this._isClosed){if(this.attemptingReconnect){gn.warn("already attempting reconnect, returning early",this.logContext);return}(((t=this.clientConfiguration)===null||t===void 0?void 0:t.resumeConnection)===pf.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:_r.NEW)===_r.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(o){this.reconnectAttempts+=1;let c=!0;o instanceof Or?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:o})),c=!1):o instanceof hu||(this.fullReconnectOnNext=!0),c?this.handleDisconnect("reconnect",cl.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(vt.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(t){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:t}))}return null}restartConnection(e){return he(this,void 0,void 0,function*(){var t,r,i;try{if(!this.url||!this.token)throw new Or("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(vt.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let o;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new hu;o=yield this.join(e??this.url,this.token,this.signalOpts,void 0,!this.options.singlePeerConnection)}catch(c){throw c instanceof tn&&c.reason===Kn.NotAllowed?new Or("could not reconnect, token might be expired"):new hu}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(vt.SignalRestarted,o),yield this.waitForPCReconnected(),this.client.currentState!==$n.CONNECTED)throw new hu("Signal connection got severed during reconnect");(t=this.regionUrlProvider)===null||t===void 0||t.resetAttempts(),this.emit(vt.Restarted)}catch(o){const c=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(c){yield this.restartConnection(c);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),o}})}resumeConnection(e){return he(this,void 0,void 0,function*(){var t;if(!this.url||!this.token)throw new Or("could not reconnect, url or token not saved");if(!this.pcManager)throw new Or("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(vt.Resuming);let r;try{this.setupSignalClientCallbacks(),r=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(i){let o="";throw i instanceof Error&&(o=i.message,this.log.error(i.message,Object.assign(Object.assign({},this.logContext),{error:i}))),i instanceof tn&&i.reason===Kn.NotAllowed?new Or("could not reconnect, token might be expired"):i instanceof tn&&i.reason===Kn.LeaveRequest?i:new hu(o)}if(this.emit(vt.SignalResumed),r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=r.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==$n.CONNECTED)throw new hu("Signal connection got severed during reconnect");this.client.setReconnected(),((t=this.reliableDC)===null||t===void 0?void 0:t.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),r!=null&&r.lastMessageSeq&&this.resendReliableMessagesForResume(r.lastMessageSeq),this.emit(vt.Resumed)})}waitForPCInitialConnection(e,t){return he(this,void 0,void 0,function*(){if(!this.pcManager)throw new Or("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return he(this,void 0,void 0,function*(){this.pcState=Yo.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Ci(vV),!this.pcManager)throw new Or("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Yo.Connected}catch(e){throw this.pcState=Yo.Disconnected,tn.internal("could not establish PC connection, ".concat(e.message))}})}publishRpcResponse(e,t,r,i){return he(this,void 0,void 0,function*(){const o=new Hi({destinationIdentities:[e],kind:Sn.RELIABLE,value:{case:"rpcResponse",value:new r1({requestId:t,value:i?{case:"error",value:i.toProto()}:{case:"payload",value:r??""}})}});yield this.sendDataPacket(o,Sn.RELIABLE)})}publishRpcAck(e,t){return he(this,void 0,void 0,function*(){const r=new Hi({destinationIdentities:[e],kind:Sn.RELIABLE,value:{case:"rpcAck",value:new n1({requestId:t})}});yield this.sendDataPacket(r,Sn.RELIABLE)})}sendDataPacket(e,t){return he(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(t),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const o=Rj(e);if(o){const c=yield this.e2eeManager.encryptData(o.toBinary());e.value={case:"encryptedPacket",value:new u_({encryptedValue:c.payload,iv:c.iv,keyIndex:c.keyIndex})}}}t===Sn.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const r=e.toBinary(),i=this.dataChannelForKind(t);if(i){if(t===Sn.RELIABLE)yield this.waitForBufferStatusLow(t),this.reliableMessageBuffer.push({data:r,sequence:e.sequence});else{if(!this.isBufferStatusLow(t)){this.lossyDataDropCount+=1,this.lossyDataDropCount%100===0&&this.log.warn("dropping lossy data channel messages, total dropped: ".concat(this.lossyDataDropCount),this.logContext);return}this.lossyDataStatCurrentBytes+=r.byteLength}if(this.attemptingReconnect)return;i.send(r)}this.updateAndEmitDCBufferStatus(t)})}resendReliableMessagesForResume(e){return he(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(Sn.RELIABLE);const t=this.dataChannelForKind(Sn.RELIABLE);t&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(r=>{t.send(r.data)})),this.updateAndEmitDCBufferStatus(Sn.RELIABLE)})}waitForBufferStatusLow(e){return new go((t,r)=>he(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))t();else{const i=()=>r(new Or("engine closed"));for(this.once(vt.Closing,i);!this.dcBufferStatus.get(e);)yield Ci(10);this.off(vt.Closing,i),t()}}))}ensureDataTransportConnected(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var o;if(!r.pcManager)throw new Or("PC manager is closed");const c=i?r.pcManager.subscriber:r.pcManager.publisher,s=i?"Subscriber":"Publisher";if(!c)throw tn.internal("".concat(s," connection not set"));let l=!1;!i&&!r.dataChannelForKind(t,i)&&(r.createDataChannels(),l=!0),!l&&!i&&!r.pcManager.publisher.isICEConnected&&r.pcManager.publisher.getICEConnectionState()!=="checking"&&(l=!0),l&&r.negotiate().catch(p=>{gn.error(p,r.logContext)});const d=r.dataChannelForKind(t,i);if((d==null?void 0:d.readyState)==="open")return;const h=new Date().getTime()+r.peerConnectionTimeout;for(;new Date().getTime()<h;){if(c.isICEConnected&&((o=r.dataChannelForKind(t,i))===null||o===void 0?void 0:o.readyState)==="open")return;yield Ci(50)}throw tn.internal("could not establish ".concat(s," connection, state: ").concat(c.getICEConnectionState()))}()})}ensurePublisherConnected(e){return he(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==_r.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return he(this,void 0,void 0,function*(){return new go((e,t)=>he(this,void 0,void 0,function*(){if(!this.pcManager){t(new Su("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t(new Su("cannot negotiate on closed engine")),this.on(vt.Closing,i),this.pcManager.publisher.once(Eu.RTPVideoPayloadTypes,o=>{const c=new Map;o.forEach(s=>{const l=s.codec.toLowerCase();hj(l)&&c.set(s.payload,l)}),this.emit(vt.RTPVideoMapUpdate,c)});try{yield this.pcManager.negotiate(r),e()}catch(o){o instanceof Su&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",cl.RR_UNKNOWN),o instanceof Error?t(o):t(new Error(String(o)))}finally{this.off(vt.Closing,i)}}))})}dataChannelForKind(e,t){if(t){if(e===Sn.LOSSY)return this.lossyDCSub;if(e===Sn.RELIABLE)return this.reliableDCSub}else{if(e===Sn.LOSSY)return this.lossyDC;if(e===Sn.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var r,i,o,c;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const s=this.pcManager.publisher.getLocalDescription(),l=this.pcManager.publisher.getRemoteDescription(),d=(r=this.pcManager.subscriber)===null||r===void 0?void 0:r.getRemoteDescription(),h=(i=this.pcManager.subscriber)===null||i===void 0?void 0:i.getLocalDescription(),p=(c=(o=this.signalOpts)===null||o===void 0?void 0:o.autoSubscribe)!==null&&c!==void 0?c:!0,g=new Array,y=new Array;e.forEach(C=>{C.isDesired!==p&&g.push(C.trackSid),C.isEnabled||y.push(C.trackSid)}),this.client.sendSyncState(new c1({answer:this.pcManager.mode==="publisher-only"?l?vu({sdp:l.sdp,type:l.type}):void 0:h?vu({sdp:h.sdp,type:h.type}):void 0,offer:this.pcManager.mode==="publisher-only"?s?vu({sdp:s.sdp,type:s.type}):void 0:d?vu({sdp:d.sdp,type:d.type}):void 0,subscription:new rg({trackSids:g,subscribe:!p,participantTracks:[]}),publishTracks:KU(t),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:y,datachannelReceiveStates:this.reliableReceivedState.map((C,x)=>new R_({publisherSid:x,lastSeq:C}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new D_({label:r.label,id:r.id,target:i}))};return t(this.dataChannelForKind(Sn.LOSSY),Es.PUBLISHER),t(this.dataChannelForKind(Sn.RELIABLE),Es.PUBLISHER),t(this.dataChannelForKind(Sn.LOSSY,!0),Es.SUBSCRIBER),t(this.dataChannelForKind(Sn.RELIABLE,!0),Es.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&yi.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){mo()&&(window.addEventListener("online",this.handleBrowserOnLine),window.addEventListener("offline",this.handleBrowserOffline))}deregisterOnLineListener(){mo()&&(window.removeEventListener("online",this.handleBrowserOnLine),window.removeEventListener("offline",this.handleBrowserOffline))}getTrackIdForReceiver(e){var t;const r=(t=this.pcManager)===null||t===void 0?void 0:t.getMidForReceiver(e);if(r){const i=Object.entries(this.midToTrackId).find(o=>{let[c]=o;return c===r});if(i)return i[1]}}}function IV(n){return n!==void 0&&n>13}function IA(n,e){const t=n.participantIdentity?n.participantIdentity:e.participantIdentity;n.participantIdentity=t,e.participantIdentity=t;const r=n.destinationIdentities.length!==0?n.destinationIdentities:e.destinationIdentities;n.destinationIdentities=r,e.destinationIdentities=r}class k2{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(e&&this.bytesReceived<this.totalByteSize)throw new Qo("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),Wi.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new Qo("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),Wi.LengthExceeded)}}constructor(e,t,r,i){this.reader=t,this.totalByteSize=r,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=i}}class wV extends k2{handleChunkReceived(e){var t;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader();let t=new Jo,r=null,i=null;if(this.signal){const c=this.signal;i=()=>{var s;(s=t.reject)===null||s===void 0||s.call(t,c.reason)},c.addEventListener("abort",i),r=c}const o=()=>{e.releaseLock(),r&&i&&r.removeEventListener("abort",i),this.signal=void 0};return{next:()=>he(this,void 0,void 0,function*(){var c,s;try{const{done:l,value:d}=yield Promise.race([e.read(),t.promise,(s=(c=this.outOfBandFailureRejectingFuture)===null||c===void 0?void 0:c.promise)!==null&&s!==void 0?s:new Promise(()=>{})]);return l?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(d),{done:!1,value:d.content})}catch(l){throw o(),l}}),return(){return he(this,void 0,void 0,function*(){return o(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var r,i,o,c;let s=new Set;const l=t.signal?e.withAbortSignal(t.signal):e;try{for(var d=!0,h=Ma(l),p;p=yield h.next(),r=p.done,!r;d=!0){c=p.value,d=!1;const g=c;s.add(g)}}catch(g){i={error:g}}finally{try{!d&&!r&&(o=h.return)&&(yield o.call(h))}finally{if(i)throw i.error}}return Array.from(s)}()})}}class SV extends k2{constructor(e,t,r,i){super(e,t,r,i),this.receivedChunks=new Map}handleChunkReceived(e){var t;const r=rp(e.chunkIndex),i=this.receivedChunks.get(r);if(i&&i.version>e.version)return;this.receivedChunks.set(r,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const o=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,o)}[Symbol.asyncIterator](){const e=this.reader.getReader(),t=new TextDecoder("utf-8",{fatal:!0});let r=new Jo,i=null,o=null;if(this.signal){const s=this.signal;o=()=>{var l;(l=r.reject)===null||l===void 0||l.call(r,s.reason)},s.addEventListener("abort",o),i=s}const c=()=>{e.releaseLock(),i&&o&&i.removeEventListener("abort",o),this.signal=void 0};return{next:()=>he(this,void 0,void 0,function*(){var s,l;try{const{done:d,value:h}=yield Promise.race([e.read(),r.promise,(l=(s=this.outOfBandFailureRejectingFuture)===null||s===void 0?void 0:s.promise)!==null&&l!==void 0?l:new Promise(()=>{})]);if(d)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(h);let p;try{p=t.decode(h.content)}catch(g){throw new Qo("Cannot decode datastream chunk ".concat(h.chunkIndex," as text: ").concat(g),Wi.DecodeFailed)}return{done:!1,value:p}}}catch(d){throw c(),d}}),return(){return he(this,void 0,void 0,function*(){return c(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return he(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var r,i,o,c;let s="";const l=t.signal?e.withAbortSignal(t.signal):e;try{for(var d=!0,h=Ma(l),p;p=yield h.next(),r=p.done,!r;d=!0)c=p.value,d=!1,s+=c}catch(g){i={error:g}}finally{try{!d&&!r&&(o=h.return)&&(yield o.call(h))}finally{if(i)throw i.error}}return s}()})}}class AV{constructor(){this.log=gn,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,t){if(this.textStreamHandlers.has(e))throw new Qo('A text stream handler for topic "'.concat(e,'" has already been set.'),Wi.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,t)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,t){if(this.byteStreamHandlers.has(e))throw new Qo('A byte stream handler for topic "'.concat(e,'" has already been set.'),Wi.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,t)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear()}validateParticipantHasNoActiveDataStreams(e){var t,r,i,o;const c=Array.from(this.textStreamControllers.entries()).filter(l=>l[1].sendingParticipantIdentity===e),s=Array.from(this.byteStreamControllers.entries()).filter(l=>l[1].sendingParticipantIdentity===e);if(c.length>0||s.length>0){const l=new Qo("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),Wi.AbnormalEnd);for(const[d,h]of s)(r=(t=h.outOfBandFailureRejectingFuture).reject)===null||r===void 0||r.call(t,l),this.byteStreamControllers.delete(d);for(const[d,h]of c)(o=(i=h.outOfBandFailureRejectingFuture).reject)===null||o===void 0||o.call(i,l),this.textStreamControllers.delete(d)}}handleDataStreamPacket(e,t){return he(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,t);case"streamChunk":return this.handleStreamChunk(e.value.value,t);case"streamTrailer":return this.handleStreamTrailer(e.value.value,t);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,t,r){return he(this,void 0,void 0,function*(){var i;if(e.contentHeader.case==="byteHeader"){const o=this.byteStreamHandlers.get(e.topic);if(!o){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let c;const s=new Jo;s.promise.catch(h=>{this.log.error(h)});const l={id:e.streamId,name:(i=e.contentHeader.value.name)!==null&&i!==void 0?i:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:rp(e.timestamp),attributes:e.attributes,encryptionType:r},d=new ReadableStream({start:h=>{if(c=h,this.textStreamControllers.has(e.streamId))throw new Qo("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Wi.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:l,controller:c,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:s})}});o(new wV(l,d,rp(e.totalLength),s),{identity:t})}else if(e.contentHeader.case==="textHeader"){const o=this.textStreamHandlers.get(e.topic);if(!o){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let c;const s=new Jo;s.promise.catch(h=>{this.log.error(h)});const l={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:r},d=new ReadableStream({start:h=>{if(c=h,this.textStreamControllers.has(e.streamId))throw new Qo("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Wi.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:l,controller:c,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:s})}});o(new SV(l,d,rp(e.totalLength),s),{identity:t})}})}handleStreamChunk(e,t){const r=this.byteStreamControllers.get(e.streamId);r&&(r.info.encryptionType!==t?(r.controller.error(new Qo("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(r.info.encryptionType),Wi.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&r.controller.enqueue(e));const i=this.textStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==t?(i.controller.error(new Qo("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(i.info.encryptionType),Wi.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&i.controller.enqueue(e))}handleStreamTrailer(e,t){const r=this.textStreamControllers.get(e.streamId);r&&(r.info.encryptionType!==t?r.controller.error(new Qo("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(r.info.encryptionType),Wi.EncryptionTypeMismatch)):(r.info.attributes=Object.assign(Object.assign({},r.info.attributes),e.attributes),r.controller.close(),this.textStreamControllers.delete(e.streamId)));const i=this.byteStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==t?i.controller.error(new Qo("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(i.info.encryptionType),Wi.EncryptionTypeMismatch)):(i.info.attributes=Object.assign(Object.assign({},i.info.attributes),e.attributes),i.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class E2{constructor(e,t,r){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=r,this.info=t}write(e){return this.defaultWriter.write(e)}close(){return he(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class kV extends E2{}class EV extends E2{}const wA=15e3;class TV{constructor(e,t){this.engine=e,this.log=t}setupEngine(e){this.engine=e}sendText(e,t){return he(this,void 0,void 0,function*(){var r;const i=crypto.randomUUID(),c=new TextEncoder().encode(e).byteLength,s=(r=t==null?void 0:t.attachments)===null||r===void 0?void 0:r.map(()=>crypto.randomUUID()),l=new Array(s?s.length+1:1).fill(0),d=(p,g)=>{var y;l[g]=p;const C=l.reduce((x,w)=>x+w,0);(y=t==null?void 0:t.onProgress)===null||y===void 0||y.call(t,C)},h=yield this.streamText({streamId:i,totalSize:c,destinationIdentities:t==null?void 0:t.destinationIdentities,topic:t==null?void 0:t.topic,attachedStreamIds:s,attributes:t==null?void 0:t.attributes});return yield h.write(e),d(1,0),yield h.close(),t!=null&&t.attachments&&s&&(yield Promise.all(t.attachments.map((p,g)=>he(this,void 0,void 0,function*(){return this._sendFile(s[g],p,{topic:t.topic,mimeType:p.type,onProgress:y=>{d(y,g+1)}})})))),h.info})}streamText(e){return he(this,void 0,void 0,function*(){var t,r,i;const o=(t=e==null?void 0:e.streamId)!==null&&t!==void 0?t:crypto.randomUUID(),c={id:o,mimeType:"text/plain",timestamp:Date.now(),topic:(r=e==null?void 0:e.topic)!==null&&r!==void 0?r:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes,encryptionType:!((i=this.engine.e2eeManager)===null||i===void 0)&&i.isDataChannelEncryptionEnabled?Yr.GCM:Yr.NONE},s=new Tp({streamId:o,mimeType:c.mimeType,topic:c.topic,timestamp:ll(c.timestamp),totalLength:ll(e==null?void 0:e.totalSize),attributes:c.attributes,contentHeader:{case:"textHeader",value:new I_({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?Ry.UPDATE:Ry.CREATE})}}),l=e==null?void 0:e.destinationIdentities,d=new Hi({destinationIdentities:l,value:{case:"streamHeader",value:s}});yield this.engine.sendDataPacket(d,Sn.RELIABLE);let h=0;const p=this.engine,g=new WritableStream({write(x){return he(this,void 0,void 0,function*(){for(const w of Cj(x,wA)){const S=new _p({content:w,streamId:o,chunkIndex:ll(h)}),E=new Hi({destinationIdentities:l,value:{case:"streamChunk",value:S}});yield p.sendDataPacket(E,Sn.RELIABLE),h+=1}})},close(){return he(this,void 0,void 0,function*(){const x=new Rp({streamId:o}),w=new Hi({destinationIdentities:l,value:{case:"streamTrailer",value:x}});yield p.sendDataPacket(w,Sn.RELIABLE)})},abort(x){console.log("Sink error:",x)}});let y=()=>he(this,void 0,void 0,function*(){yield C.close()});p.once(vt.Closing,y);const C=new kV(g,c,()=>this.engine.off(vt.Closing,y));return C})}sendFile(e,t){return he(this,void 0,void 0,function*(){const r=crypto.randomUUID();return yield this._sendFile(r,e,t),{id:r}})}_sendFile(e,t,r){return he(this,void 0,void 0,function*(){var i;const o=yield this.streamBytes({streamId:e,totalSize:t.size,name:t.name,mimeType:(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:t.type,topic:r==null?void 0:r.topic,destinationIdentities:r==null?void 0:r.destinationIdentities}),c=t.stream().getReader();for(;;){const{done:s,value:l}=yield c.read();if(s)break;yield o.write(l)}return yield o.close(),o.info})}streamBytes(e){return he(this,void 0,void 0,function*(){var t,r,i,o,c,s;const l=(t=e==null?void 0:e.streamId)!==null&&t!==void 0?t:crypto.randomUUID(),d=e==null?void 0:e.destinationIdentities,h={id:l,mimeType:(r=e==null?void 0:e.mimeType)!==null&&r!==void 0?r:"application/octet-stream",topic:(i=e==null?void 0:e.topic)!==null&&i!==void 0?i:"",timestamp:Date.now(),attributes:e==null?void 0:e.attributes,size:e==null?void 0:e.totalSize,name:(o=e==null?void 0:e.name)!==null&&o!==void 0?o:"unknown",encryptionType:!((c=this.engine.e2eeManager)===null||c===void 0)&&c.isDataChannelEncryptionEnabled?Yr.GCM:Yr.NONE},p=new Tp({totalLength:ll((s=h.size)!==null&&s!==void 0?s:0),mimeType:h.mimeType,streamId:l,topic:h.topic,timestamp:ll(Date.now()),attributes:h.attributes,contentHeader:{case:"byteHeader",value:new w_({name:h.name})}}),g=new Hi({destinationIdentities:d,value:{case:"streamHeader",value:p}});yield this.engine.sendDataPacket(g,Sn.RELIABLE);let y=0;const C=new $i,x=this.engine,w=this.log,S=new WritableStream({write(R){return he(this,void 0,void 0,function*(){const k=yield C.lock();let A=0;try{for(;A<R.byteLength;){const _=R.slice(A,A+wA),D=new Hi({destinationIdentities:d,value:{case:"streamChunk",value:new _p({content:_,streamId:l,chunkIndex:ll(y)})}});yield x.sendDataPacket(D,Sn.RELIABLE),y+=1,A+=_.byteLength}}finally{k()}})},close(){return he(this,void 0,void 0,function*(){const R=new Rp({streamId:l}),k=new Hi({destinationIdentities:d,value:{case:"streamTrailer",value:R}});yield x.sendDataPacket(k,Sn.RELIABLE)})},abort(R){w.error("Sink error:",R)}});return new EV(S,h)})}}class T2 extends je{constructor(e,t,r,i,o){super(e,r,o),this.sid=t,this.receiver=i}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ht.Muted:ht.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(ht.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return he(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),I1)),qU()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var t;this.timeSyncHandle=requestAnimationFrame(()=>e());const r=(t=this.receiver)===null||t===void 0?void 0:t.getSynchronizationSources()[0];if(r){const{timestamp:i,rtpTimestamp:o}=r;o&&this.rtpTimestamp!==o&&(this.emit(ht.TimeSyncUpdate,{timestamp:i,rtpTimestamp:o}),this.rtpTimestamp=o)}};e()}}class _2 extends T2{constructor(e,t,r,i,o,c){super(e,t,je.Kind.Audio,r,c),this.monitorReceiver=()=>he(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=sg(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var t;for(const r of this.attachedElements)this.audioContext?(t=this.gainNode)===null||t===void 0||t.gain.setTargetAtTime(e,0,.1):r.volume=e;na()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(na())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return he(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(Zy(t))return t.setSinkId(e)}))})}attach(e){const t=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Zy(e)&&e.setSinkId(this.sinkId).catch(r=>{this.log.error("Failed to set sink id on remote audio track",r,this.logContext)}),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(ht.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(ht.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,t;(e=this.gainNode)===null||e===void 0||e.disconnect(),(t=this.sourceNode)===null||t===void 0||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return he(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t;return e.forEach(r=>{r.type==="inbound-rtp"&&(t={type:"audio",streamId:r.id,timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),t})}}const Mv=100;class _V extends T2{constructor(e,t,r,i,o){super(e,t,je.Kind.Video,r,o),this.elementInfos=[],this.monitorReceiver=()=>he(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const c=yield this.getReceiverStats();c&&this.prevStats&&this.receiver&&(this._currentBitrate=sg(c,this.prevStats)),this.prevStats=c}),this.debouncedHandleResize=y1(()=>{this.updateDimensions()},Mv),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}setStreamState(e){super.setStreamState(e),this.log.debug("setStreamState",e),this.isAdaptiveStream&&e===je.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?Au(this._mediaStreamTrack,t):mu(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(t=>t.element===e)===void 0){const t=new RV(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(t=>t===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const t=this.elementInfos.filter(r=>r===e);for(const r of t)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const r of t)this.stopObservingElement(r);return t}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return he(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,r="",i=new Map;return e.forEach(o=>{o.type==="inbound-rtp"?(r=o.codecId,t={type:"video",streamId:o.id,framesDecoded:o.framesDecoded,framesDropped:o.framesDropped,framesReceived:o.framesReceived,packetsReceived:o.packetsReceived,packetsLost:o.packetsLost,frameWidth:o.frameWidth,frameHeight:o.frameHeight,pliCount:o.pliCount,firCount:o.firCount,nackCount:o.nackCount,jitter:o.jitter,timestamp:o.timestamp,bytesReceived:o.bytesReceived,decoderImplementation:o.decoderImplementation}):o.type==="codec"&&i.set(o.id,o)}),t&&r!==""&&i.get(r)&&(t.mimeType=i.get(r).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(r=>r.element===e);for(const r of t)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return he(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var t,r;const i=this.elementInfos.reduce((l,d)=>Math.max(l,d.visibilityChangedAt||0),0),o=!((r=(t=this.adaptiveStreamSettings)===null||t===void 0?void 0:t.pauseVideoInBackground)!==null&&r!==void 0)||r?this.isInBackground:!1,c=this.elementInfos.some(l=>l.pictureInPicture),s=this.elementInfos.some(l=>l.visible)&&!o||c;if(!(this.lastVisible===s&&!e)){if(!s&&Date.now()-i<Mv){yi.setTimeout(()=>{this.updateVisibility()},Mv);return}this.lastVisible=s,this.emit(ht.VisibilityChanged,s,this)}}updateDimensions(){var e,t;let r=0,i=0;const o=this.getPixelDensity();for(const c of this.elementInfos){const s=c.width()*o,l=c.height()*o;s+l>r+i&&(r=s,i=l)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((t=this.lastDimensions)===null||t===void 0?void 0:t.height)===i||(this.lastDimensions={width:r,height:i},this.emit(ht.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return t==="screen"?YS():t||(YS()>2?2:1)}}class RV{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=r=>{var i;const{target:o,isIntersecting:c}=r;o===this.element&&(this.isIntersecting=c,this.isPiP=Ud(this.element),this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r,i,o;(i=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||i===void 0||i.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Ud(this.element),(o=this.handleVisibilityChanged)===null||o===void 0||o.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=Ud(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=t??Qy(e),this.isPiP=mo()&&Ud(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,t,r;this.isIntersecting=Qy(this.element),this.isPiP=Ud(this.element),this.element.handleResize=()=>{var i;(i=this.handleResize)===null||i===void 0||i.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,JS().observe(this.element),QS().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(r=(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,t,r,i,o;(e=JS())===null||e===void 0||e.unobserve(this.element),(t=QS())===null||t===void 0||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(r=window.documentPictureInPicture)===null||r===void 0||r.removeEventListener("enter",this.onEnterPiP),(o=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||o===void 0||o.removeEventListener("pagehide",this.onLeavePiP)}}function Ud(n){var e,t;return document.pictureInPictureElement===n?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Qy(n,(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window):!1}function Qy(n,e){const t=e||window;let r=n.offsetTop,i=n.offsetLeft;const o=n.offsetWidth,c=n.offsetHeight,{hidden:s}=n,{display:l}=getComputedStyle(n);for(;n.offsetParent;)n=n.offsetParent,r+=n.offsetTop,i+=n.offsetLeft;return r<t.pageYOffset+t.innerHeight&&i<t.pageXOffset+t.innerWidth&&r+c>t.pageYOffset&&i+o>t.pageXOffset&&!s&&l!=="none"}class _a extends ca.EventEmitter{constructor(e,t,r,i){var o;super(),this.metadataMuted=!1,this.encryption=Yr.NONE,this.log=gn,this.handleMuted=()=>{this.emit(ht.Muted)},this.handleUnmuted=()=>{this.emit(ht.Unmuted)},this.log=Ua((o=i==null?void 0:i.loggerName)!==null&&o!==void 0?o:Ps.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=r,this.source=je.Source.Unknown}setTrack(e){this.track&&(this.track.off(ht.Muted,this.handleMuted),this.track.off(ht.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(ht.Muted,this.handleMuted),e.on(ht.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),kn(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Yr.NONE}get audioTrack(){if(Js(this.track))return this.track}get videoTrack(){if(jc(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=je.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===je.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(n){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(n.SubscriptionStatus||(n.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(n.PermissionStatus||(n.PermissionStatus={}))})(_a||(_a={}));class Mp extends _a{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,t,r,i){super(e,t.sid,t.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(ht.Ended)},this.handleCpuConstrained=()=>{this.track&&jc(this.track)&&this.emit(ht.CpuConstrained,this.track)},this.updateInfo(t),this.setTrack(r)}setTrack(e){this.track&&(this.track.off(ht.Ended,this.handleTrackEnded),this.track.off(ht.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(ht.Ended,this.handleTrackEnded),e.on(ht.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return he(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return he(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return he(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return he(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(Js(this.track)){const t=this.track.getSourceTrackSettings(),r=new Set;return t.autoGainControl&&r.add(li.TF_AUTO_GAIN_CONTROL),t.echoCancellation&&r.add(li.TF_ECHO_CANCELLATION),t.noiseSuppression&&r.add(li.TF_NOISE_SUPPRESSION),t.channelCount&&t.channelCount>1&&r.add(li.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||r.add(li.TF_NO_DTX),this.track.enhancedNoiseCancellation&&r.add(li.TF_ENHANCED_NOISE_CANCELLATION),Array.from(r.values())}else return[]}}function ag(n,e){return he(this,void 0,void 0,function*(){n??(n={});let t=!1;const{audioProcessor:r,videoProcessor:i,optionsWithoutProcessor:o}=p2(n);let c=o.audio,s=o.video;if(r&&typeof o.audio=="object"&&(o.audio.processor=r),i&&typeof o.video=="object"&&(o.video.processor=i),n.audio&&typeof o.audio=="object"&&typeof o.audio.deviceId=="string"){const p=o.audio.deviceId;o.audio.deviceId={exact:p},t=!0,c=Object.assign(Object.assign({},o.audio),{deviceId:{ideal:p}})}if(o.video&&typeof o.video=="object"&&typeof o.video.deviceId=="string"){const p=o.video.deviceId;o.video.deviceId={exact:p},t=!0,s=Object.assign(Object.assign({},o.video),{deviceId:{ideal:p}})}o.audio===!0?o.audio={deviceId:"default"}:typeof o.audio=="object"&&o.audio!==null&&(o.audio=Object.assign(Object.assign({},o.audio),{deviceId:o.audio.deviceId||"default"})),o.video===!0?o.video={deviceId:"default"}:typeof o.video=="object"&&!o.video.deviceId&&(o.video.deviceId="default");const l=f2(o,C2,x2),d=h1(l),h=navigator.mediaDevices.getUserMedia(d);o.audio&&(ui.userMediaPromiseMap.set("audioinput",h),h.catch(()=>ui.userMediaPromiseMap.delete("audioinput"))),o.video&&(ui.userMediaPromiseMap.set("videoinput",h),h.catch(()=>ui.userMediaPromiseMap.delete("videoinput")));try{const p=yield h;return yield Promise.all(p.getTracks().map(g=>he(this,void 0,void 0,function*(){const y=g.kind==="audio";let C=y?l.audio:l.video;(typeof C=="boolean"||!C)&&(C={});let x;const w=y?d.audio:d.video;typeof w!="boolean"&&(x=w);const S=g.getSettings().deviceId;x!=null&&x.deviceId&&Tc(x.deviceId)!==S?x.deviceId=S:x||(x={deviceId:S});const E=oV(g,x,e);return E.kind===je.Kind.Video?E.source=je.Source.Camera:E.kind===je.Kind.Audio&&(E.source=je.Source.Microphone),E.mediaStream=p,Js(E)&&r?yield E.setProcessor(r):jc(E)&&i&&(yield E.setProcessor(i)),E})))}catch(p){if(!t)throw p;return ag(Object.assign(Object.assign({},n),{audio:c,video:s}),e)}})}function DV(n){return he(this,void 0,void 0,function*(){return(yield ag({audio:!1,video:!0}))[0]})}function PV(n){return he(this,void 0,void 0,function*(){return(yield ag({audio:!0,video:!1}))[0]})}var _s;(function(n){n.Excellent="excellent",n.Good="good",n.Poor="poor",n.Lost="lost",n.Unknown="unknown"})(_s||(_s={}));function MV(n){switch(n){case Xd.EXCELLENT:return _s.Excellent;case Xd.GOOD:return _s.Good;case Xd.POOR:return _s.Poor;case Xd.LOST:return _s.Lost;default:return _s.Unknown}}class R2 extends ca.EventEmitter{get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===gf.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===bu.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,t,r,i,o,c){let s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:gf.STANDARD;var l;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=_s.Unknown,this.log=gn,this.log=Ua((l=c==null?void 0:c.loggerName)!==null&&l!==void 0?l:Ps.Participant),this.loggerOptions=c,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=r,this.metadata=i,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=s,this._attributes=o??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,t]of this.trackPublications)if(t.source===e)return t}getTrackPublicationByName(e){for(const[,t]of this.trackPublications)if(t.trackName===e)return t}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new Jo,this.once($e.Active,()=>{var e,t;(t=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||t===void 0||t.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrackPublication(je.Source.Camera);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const t=this.getTrackPublication(je.Source.Microphone);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(je.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var t;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===bu.ACTIVE&&((t=this.participantInfo)===null||t===void 0?void 0:t.state)!==bu.ACTIVE&&this.emit($e.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const t=this.metadata!==e,r=this.metadata;this.metadata=e,t&&this.emit($e.ParticipantMetadataChanged,r)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit($e.ParticipantNameChanged,e)}_setAttributes(e){const t=YU(this.attributes,e);this._attributes=e,Object.keys(t).length>0&&this.emit($e.AttributesChanged,t)}setPermissions(e){var t,r,i,o,c,s;const l=this.permissions,d=e.canPublish!==((t=this.permissions)===null||t===void 0?void 0:t.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((o=this.permissions)===null||o===void 0?void 0:o.hidden)||e.recorder!==((c=this.permissions)===null||c===void 0?void 0:c.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((h,p)=>{var g;return h!==((g=this.permissions)===null||g===void 0?void 0:g.canPublishSources[p])})||e.canSubscribeMetrics!==((s=this.permissions)===null||s===void 0?void 0:s.canSubscribeMetrics);return this.permissions=e,d&&this.emit($e.ParticipantPermissionsChanged,l),d}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit($e.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=MV(e),t!==this._connectionQuality&&this.emit($e.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,t;this.activeFuture&&((t=(e=this.activeFuture).reject)===null||t===void 0||t.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(t=>Js(t.track)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(ht.Muted,()=>{this.emit($e.TrackMuted,e)}),e.on(ht.Unmuted,()=>{this.emit($e.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case je.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case je.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function NV(n){var e,t,r;if(!n.participantSid&&!n.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new T_({participantIdentity:(e=n.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(t=n.participantSid)!==null&&t!==void 0?t:"",allTracks:(r=n.allowAll)!==null&&r!==void 0?r:!1,trackSids:n.allowedTrackSids||[]})}class OV extends R2{constructor(e,t,r,i,o,c){super(e,t,void 0,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Yr.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Jo)},this.handleReconnected=()=>{var s,l;(l=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||l===void 0||l.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var s,l,d,h,p,g;this.reconnectFuture&&(this.reconnectFuture.promise.catch(y=>this.log.warn(y.message,this.logContext)),(l=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||l===void 0||l.call(s,new Error("Got disconnected during reconnection attempt")),this.reconnectFuture=void 0),this.signalConnectedFuture&&((h=(d=this.signalConnectedFuture).reject)===null||h===void 0||h.call(d,new Error("Got disconnected without signal connected")),this.signalConnectedFuture=void 0),(g=(p=this.activeAgentFuture)===null||p===void 0?void 0:p.reject)===null||g===void 0||g.call(p,new Error("Got disconnected without active agent present")),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=s=>{var l,d;s.participant&&this.updateInfo(s.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Jo),(d=(l=this.signalConnectedFuture).resolve)===null||d===void 0||d.call(l)},this.handleSignalRequestResponse=s=>{const{requestId:l,reason:d,message:h}=s,p=this.pendingSignalRequests.get(l);p&&(d!==l1.OK&&p.reject(new ZS(h,d)),this.pendingSignalRequests.delete(l))},this.handleDataPacket=s=>{switch(s.value.case){case"rpcResponse":let l=s.value.value,d=null,h=null;l.value.case==="payload"?d=l.value.value:l.value.case==="error"&&(h=Pr.fromProto(l.value.value)),this.handleIncomingRpcResponse(l.requestId,d,h);break;case"rpcAck":let p=s.value.value;this.handleIncomingRpcAck(p.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>NV(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,l)=>{if(l===void 0&&(l=!0),!s.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),kn(s)));return}this.engine.updateMuteStatus(s.sid,l)},this.onTrackUpstreamPaused=s=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),kn(s))),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),kn(s))),this.onTrackMuted(s,s.isMuted)},this.onTrackFeatureUpdate=s=>{const l=this.audioTrackPublications.get(s.sid);if(!l){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(s.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(l.trackSid,l.getTrackFeatures())},this.onTrackCpuConstrained=(s,l)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),kn(l))),this.emit($e.LocalTrackCpuConstrained,s,l)},this.handleSubscribedQualityUpdate=s=>he(this,void 0,void 0,function*(){var l,d,h,p,g;if(!(!((g=this.roomOptions)===null||g===void 0)&&g.dynacast))return;const y=this.videoTrackPublications.get(s.trackSid);if(!y){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}if(!y.videoTrack)return;const C=yield y.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var x=!0,w=Ma(C),S;S=yield w.next(),l=S.done,!l;x=!0){p=S.value,x=!1;const E=p;ZU(E)&&(this.log.debug("publish ".concat(E," for ").concat(y.videoTrack.sid),Object.assign(Object.assign({},this.logContext),kn(y))),yield this.publishAdditionalCodecForTrack(y.videoTrack,E,y.options))}}catch(E){d={error:E}}finally{try{!x&&!l&&(h=w.return)&&(yield h.call(w))}finally{if(d)throw d.error}}}),this.handleLocalTrackUnpublished=s=>{const l=this.trackPublications.get(s.trackSid);if(!l){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}this.unpublishTrack(l.track)},this.handleTrackEnded=s=>he(this,void 0,void 0,function*(){if(s.source===je.Source.ScreenShare||s.source===je.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),kn(s))),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(Ea(s)||hc(s))try{if(mo())try{const l=yield navigator==null?void 0:navigator.permissions.query({name:s.source===je.Source.Camera?"camera":"microphone"});if(l&&l.state==="denied")throw this.log.warn("user has revoked access to ".concat(s.source),Object.assign(Object.assign({},this.logContext),kn(s))),l.onchange=()=>{l.state!=="denied"&&(s.isMuted||s.restartTrack(),l.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}s.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),kn(s))),Ea(s)?yield s.restartTrack({deviceId:"default"}):yield s.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),kn(s))),yield s.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=o,this.roomOutgoingDataStreamManager=c}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Yr.NONE}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setupEngine(e){var t;this.engine=e,this.engine.on(vt.RemoteMute,(r,i)=>{const o=this.trackPublications.get(r);!o||!o.track||(i?o.mute():o.unmute())}),!((t=this.signalConnectedFuture)===null||t===void 0)&&t.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(vt.Connected,this.handleReconnected).on(vt.SignalConnected,this.handleSignalConnected).on(vt.SignalRestarted,this.handleReconnected).on(vt.SignalResumed,this.handleReconnected).on(vt.Restarting,this.handleReconnecting).on(vt.Resuming,this.handleReconnecting).on(vt.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(vt.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(vt.Closing,this.handleClosing).on(vt.SignalRequestResponse,this.handleSignalRequestResponse).on(vt.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return he(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return he(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return he(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return he(this,arguments,void 0,function(t){var r=this;let{metadata:i,name:o,attributes:c}=t;return function*(){return new go((s,l)=>he(r,void 0,void 0,function*(){var d,h;try{let p=!1;const g=yield this.engine.client.sendUpdateLocalMetadata((d=i??this.metadata)!==null&&d!==void 0?d:"",(h=o??this.name)!==null&&h!==void 0?h:"",c),y=performance.now();for(this.pendingSignalRequests.set(g,{resolve:s,reject:C=>{l(C),p=!0},values:{name:o,metadata:i,attributes:c}});performance.now()-y<5e3&&!p;){if((!o||this.name===o)&&(!i||this.metadata===i)&&(!c||Object.entries(c).every(C=>{let[x,w]=C;return this.attributes[x]===w||w===""&&!this.attributes[x]}))){this.pendingSignalRequests.delete(g),s();return}yield Ci(50)}l(new ZS("Request to update local metadata timed out","TimeoutError"))}catch(p){p instanceof Error?l(p):l(new Error(String(p)))}}))}()})}setCameraEnabled(e,t,r){return this.setTrackEnabled(je.Source.Camera,e,t,r)}setMicrophoneEnabled(e,t,r){return this.setTrackEnabled(je.Source.Microphone,e,t,r)}setScreenShareEnabled(e,t,r){return this.setTrackEnabled(je.Source.ScreenShare,e,t,r)}setE2EEEnabled(e){return he(this,void 0,void 0,function*(){this.encryptionType=e?Yr.GCM:Yr.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,r,i){return he(this,void 0,void 0,function*(){var o,c;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t})),this.republishPromise&&(yield this.republishPromise);let s=this.getTrackPublication(e);if(t)if(s)yield s.unmute();else{let l;if(this.pendingPublishing.has(e)){const d=yield this.waitForPendingPublicationOfSource(e);return d||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield d==null?void 0:d.unmute(),d}this.pendingPublishing.add(e);try{switch(e){case je.Source.Camera:l=yield this.createTracks({video:(o=r)!==null&&o!==void 0?o:!0});break;case je.Source.Microphone:l=yield this.createTracks({audio:(c=r)!==null&&c!==void 0?c:!0});break;case je.Source.ScreenShare:l=yield this.createScreenTracks(Object.assign({},r));break;default:throw new Na(e)}}catch(d){throw l==null||l.forEach(h=>{h.stop()}),d instanceof Error&&this.emit($e.MediaDevicesError,d,Wy(e)),this.pendingPublishing.delete(e),d}for(const d of l){const h=Object.assign(Object.assign({},this.roomOptions.publishDefaults),r);e===je.Source.Microphone&&Js(d)&&h.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),d.startPreConnectBuffer())}try{const d=[];for(const p of l)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),kn(p))),d.push(this.publishTrack(p,i));[s]=yield Promise.all(d)}catch(d){throw l==null||l.forEach(h=>{h.stop()}),d}finally{this.pendingPublishing.delete(e)}}else if(!(s!=null&&s.track)&&this.pendingPublishing.has(e)&&(s=yield this.waitForPendingPublicationOfSource(e),s||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),s&&s.track)if(e===je.Source.ScreenShare){s=yield this.unpublishTrack(s.track);const l=this.getTrackPublication(je.Source.ScreenShareAudio);l&&l.track&&this.unpublishTrack(l.track)}else yield s.mute();return s})}enableCameraAndMicrophone(){return he(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(je.Source.Camera)||this.pendingPublishing.has(je.Source.Microphone))){this.pendingPublishing.add(je.Source.Camera),this.pendingPublishing.add(je.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(t=>this.publishTrack(t)))}finally{this.pendingPublishing.delete(je.Source.Camera),this.pendingPublishing.delete(je.Source.Microphone)}}})}createTracks(e){return he(this,void 0,void 0,function*(){var t,r;e??(e={});const i=f2(e,(t=this.roomOptions)===null||t===void 0?void 0:t.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults);try{return(yield ag(i,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(s=>(Js(s)&&(this.microphoneError=void 0,s.setAudioContext(this.audioContext),s.source=je.Source.Microphone,this.emit($e.AudioStreamAcquired)),jc(s)&&(this.cameraError=void 0,s.source=je.Source.Camera),s))}catch(o){throw o instanceof Error&&(e.audio&&(this.microphoneError=o),e.video&&(this.cameraError=o)),o}})}createScreenTracks(e){return he(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new d1("getDisplayMedia not supported");e.resolution===void 0&&!sj()&&(e.resolution=f1.h1080fps30.resolution);const t=$U(e),r=yield navigator.mediaDevices.getDisplayMedia(t),i=r.getVideoTracks();if(i.length===0)throw new Na("no video track found");const o=new Pp(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=je.Source.ScreenShare,e.contentHint&&(o.mediaStreamTrack.contentHint=e.contentHint);const c=[o];if(r.getAudioTracks().length>0){this.emit($e.AudioStreamAcquired);const s=new Dp(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=je.Source.ScreenShareAudio,c.push(s)}return c})}publishTrack(e,t){return he(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,t)})}publishOrRepublishTrack(e,t){return he(this,arguments,void 0,function(r,i){var o=this;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var s,l,d,h;Ea(r)&&r.setAudioContext(o.audioContext),yield(s=o.reconnectFuture)===null||s===void 0?void 0:s.promise,o.republishPromise&&!c&&(yield o.republishPromise),xl(r)&&o.pendingPublishPromises.has(r)&&(yield o.pendingPublishPromises.get(r));let p;if(r instanceof MediaStreamTrack)p=r.getConstraints();else{p=r.constraints;let S;switch(r.source){case je.Source.Microphone:S="audioinput";break;case je.Source.Camera:S="videoinput"}S&&o.activeDeviceMap.has(S)&&(p=Object.assign(Object.assign({},p),{deviceId:o.activeDeviceMap.get(S)}))}if(r instanceof MediaStreamTrack)switch(r.kind){case"audio":r=new Dp(r,p,!0,o.audioContext,{loggerName:o.roomOptions.loggerName,loggerContextCb:()=>o.logContext});break;case"video":r=new Pp(r,p,!0,{loggerName:o.roomOptions.loggerName,loggerContextCb:()=>o.logContext});break;default:throw new Na("unsupported MediaStreamTrack kind ".concat(r.kind))}else r.updateLoggerOptions({loggerName:o.roomOptions.loggerName,loggerContextCb:()=>o.logContext});let g;if(o.trackPublications.forEach(S=>{S.track&&S.track===r&&(g=S)}),g)return o.log.warn("track has already been published, skipping",Object.assign(Object.assign({},o.logContext),kn(g))),g;const y=Object.assign(Object.assign({},o.roomOptions.publishDefaults),i),C="channelCount"in r.mediaStreamTrack.getSettings()&&r.mediaStreamTrack.getSettings().channelCount===2||r.mediaStreamTrack.getConstraints().channelCount===2,x=(l=y.forceStereo)!==null&&l!==void 0?l:C;x&&(y.dtx===void 0&&o.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},o.logContext),kn(r))),y.red===void 0&&o.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(d=y.dtx)!==null&&d!==void 0||(y.dtx=!1),(h=y.red)!==null&&h!==void 0||(y.red=!1)),!cj()&&o.roomOptions.e2ee&&(o.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},o.logContext)),y.simulcast=!1),y.source&&(r.source=y.source);const w=new Promise((S,E)=>he(o,void 0,void 0,function*(){try{if(this.engine.client.currentState!==$n.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:kn(r)}));let R=!1;const k=setTimeout(()=>{R=!0,r.stop(),E(new HS("publishing rejected as engine not connected within timeout",408))},15e3);if(yield this.waitUntilEngineConnected(),clearTimeout(k),R)return;const A=yield this.publish(r,y,x);S(A)}else try{const R=yield this.publish(r,y,x);S(R)}catch(R){E(R)}}catch(R){E(R)}}));o.pendingPublishPromises.set(r,w);try{return yield w}catch(S){throw S}finally{o.pendingPublishPromises.delete(r)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Jo),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),kn(e))),!1;const{canPublish:t,canPublishSources:r}=this.permissions;return t&&(r.length===0||r.map(i=>QU(i)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),kn(e))),!1)}publish(e,t,r){return he(this,void 0,void 0,function*(){var i,o,c,s,l,d,h,p,g,y;if(!this.hasPermissionsToPublish(e))throw new HS("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(Z=>xl(e)&&Z.source===e.source)&&e.source!==je.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),kn(e))),t.stopMicTrackOnMute&&Js(e)&&(e.stopOnMute=!0),e.source===je.Source.ScreenShare&&El()&&(t.simulcast=!1),t.videoCodec==="av1"&&!rj()&&(t.videoCodec=void 0),t.videoCodec==="vp9"&&!ij()&&(t.videoCodec=void 0),t.videoCodec===void 0&&(t.videoCodec=Ky),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(Z=>t.videoCodec===Jd(Z.mime))||(t.videoCodec=Jd(this.enabledPublishVideoCodecs[0].mime)));const x=t.videoCodec;e.on(ht.Muted,this.onTrackMuted),e.on(ht.Unmuted,this.onTrackUnmuted),e.on(ht.Ended,this.handleTrackEnded),e.on(ht.UpstreamPaused,this.onTrackUpstreamPaused),e.on(ht.UpstreamResumed,this.onTrackUpstreamResumed),e.on(ht.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const w=[],S=!(!((i=t.dtx)!==null&&i!==void 0)||i),E=e.getSourceTrackSettings();E.autoGainControl&&w.push(li.TF_AUTO_GAIN_CONTROL),E.echoCancellation&&w.push(li.TF_ECHO_CANCELLATION),E.noiseSuppression&&w.push(li.TF_NOISE_SUPPRESSION),E.channelCount&&E.channelCount>1&&w.push(li.TF_STEREO),S&&w.push(li.TF_NO_DTX),Ea(e)&&e.hasPreConnectBuffer&&w.push(li.TF_PRECONNECT_BUFFER);const R=new mf({cid:e.mediaStreamTrack.id,name:t.name,type:je.kindToProto(e.kind),muted:e.isMuted,source:je.sourceToProto(e.source),disableDtx:S,encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((o=t.red)!==null&&o!==void 0)||o),stream:t==null?void 0:t.stream,backupCodecPolicy:t==null?void 0:t.backupCodecPolicy,audioFeatures:w});let k;if(e.kind===je.Kind.Video){let Z={width:0,height:0};try{Z=yield e.waitForDimensions()}catch{const V=(s=(c=this.roomOptions.videoCaptureDefaults)===null||c===void 0?void 0:c.resolution)!==null&&s!==void 0?s:yf.h720.resolution;Z={width:V.width,height:V.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),kn(e)),{dims:Z}))}R.width=Z.width,R.height=Z.height,hc(e)&&(Ts(x)&&(e.source===je.Source.ScreenShare&&(t.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),kn(e))))),t.scalabilityMode=(l=t.scalabilityMode)!==null&&l!==void 0?l:"L3T3_KEY"),R.simulcastCodecs=[new Py({codec:x,cid:e.mediaStreamTrack.id})],t.backupCodec===!0&&(t.backupCodec={codec:Ky}),t.backupCodec&&x!==t.backupCodec.codec&&R.encryption===Yr.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),R.simulcastCodecs.push(new Py({codec:t.backupCodec.codec,cid:""})))),k=Yy(e.source===je.Source.ScreenShare,R.width,R.height,t),R.layers=CA(R.width,R.height,k,Ts(t.videoCodec))}else e.kind===je.Kind.Audio&&(k=[{maxBitrate:(d=t.audioPreset)===null||d===void 0?void 0:d.maxBitrate,priority:(p=(h=t.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high",networkPriority:(y=(g=t.audioPreset)===null||g===void 0?void 0:g.priority)!==null&&y!==void 0?y:"high"}]);if(!this.engine||this.engine.isClosed)throw new Or("cannot publish track when not connected");const A=()=>he(this,void 0,void 0,function*(){var Z,F,V;if(!this.engine.pcManager)throw new Or("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,t,k),this.emit($e.LocalSenderCreated,e.sender,e),hc(e)&&((Z=t.degradationPreference)!==null&&Z!==void 0||(t.degradationPreference=gV(e)),e.setDegradationPreference(t.degradationPreference)),k)if(El()&&e.kind===je.Kind.Audio){let X;for(const te of this.engine.pcManager.publisher.getTransceivers())if(te.sender===e.sender){X=te;break}X&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:X,codec:"opus",maxbr:!((F=k[0])===null||F===void 0)&&F.maxBitrate?k[0].maxBitrate/1e3:0})}else e.codec&&Ts(e.codec)&&(!((V=k[0])===null||V===void 0)&&V.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:R.cid,codec:e.codec,maxbr:k[0].maxBitrate/1e3});yield this.engine.negotiate()});let _;const D=new Promise((Z,F)=>he(this,void 0,void 0,function*(){var V;try{_=yield this.engine.addTrack(R),Z(_)}catch(X){e.sender&&(!((V=this.engine.pcManager)===null||V===void 0)&&V.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(te=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),kn(e)),{error:te}))})),F(X)}}));if(this.enabledPublishVideoCodecs.length>0)_=(yield Promise.all([D,A()]))[0];else{_=yield D;let Z;if(_.codecs.forEach(F=>{Z===void 0&&(Z=F.mimeType)}),Z&&e.kind===je.Kind.Video){const F=Jd(Z);F!==x&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),kn(e)),{codec:F})),t.videoCodec=F,k=Yy(e.source===je.Source.ScreenShare,R.width,R.height,t))}yield A()}const j=new Mp(e.kind,_,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(j.on(ht.CpuConstrained,Z=>this.onTrackCpuConstrained(Z,j)),j.options=t,e.sid=_.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:k,trackInfo:_})),hc(e)?e.startMonitor(this.engine.client):Ea(e)&&e.startMonitor(),this.addTrackPublication(j),this.emit($e.LocalTrackPublished,j),Ea(e)&&_.audioFeatures.includes(li.TF_PRECONNECT_BUFFER)){const Z=e.getPreConnectBuffer(),F=e.getPreConnectBufferMimeType();this.on($e.LocalTrackSubscribed,V=>{if(V.trackSid===_.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),kn(e))),e.stopPreConnectBuffer()}}),Z&&new Promise((X,te)=>he(this,void 0,void 0,function*(){var pe,ve,Ie,Re,xe,Ae;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),kn(e)));const ae=setTimeout(()=>{te(new Error("agent not active within 10 seconds"))},1e4),ye=yield this.waitUntilActiveAgentPresent();clearTimeout(ae),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),kn(e)));const Ee=yield this.streamBytes({name:"preconnect-buffer",mimeType:F,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[ye.identity],attributes:{trackId:j.trackSid,sampleRate:String((xe=E.sampleRate)!==null&&xe!==void 0?xe:"48000"),channels:String((Ae=E.channelCount)!==null&&Ae!==void 0?Ae:"1")}});try{for(var ke=!0,H=Ma(Z),ee;ee=yield H.next(),pe=ee.done,!pe;ke=!0){Re=ee.value,ke=!1;const _e=Re;yield Ee.write(_e)}}catch(_e){ve={error:_e}}finally{try{!ke&&!pe&&(Ie=H.return)&&(yield Ie.call(H))}finally{if(ve)throw ve.error}}yield Ee.close(),X()}catch(ae){te(ae)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),kn(e)))}).catch(X=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),kn(e)),{error:X}))})}return j})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,r){return he(this,void 0,void 0,function*(){var i;if(this.encryptionType!==Yr.NONE)return;let o;if(this.trackPublications.forEach(y=>{y.track&&y.track===e&&(o=y)}),!o)throw new Na("track is not published");if(!hc(e))throw new Na("track is not a video track");const c=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),s=fV(e,t,c);if(!s){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),kn(e)));return}const l=e.addSimulcastTrack(t,s);if(!l)return;const d=new mf({cid:l.mediaStreamTrack.id,type:je.kindToProto(e.kind),muted:e.isMuted,source:je.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:c.videoCodec,cid:l.mediaStreamTrack.id}]});if(d.layers=CA(d.width,d.height,s),!this.engine||this.engine.isClosed)throw new Or("cannot publish track when not connected");const h=()=>he(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,l,c,s),yield this.engine.negotiate()}),g=(yield Promise.all([this.engine.addTrack(d),h()]))[0];this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:s,trackInfo:g}))})}unpublishTrack(e,t){return he(this,void 0,void 0,function*(){var r,i;if(xl(e)){const d=this.pendingPublishPromises.get(e);d&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),kn(e))),yield d)}const o=this.getPublicationForTrack(e),c=o?kn(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),c)),!o||!o.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),c));return}e=o.track,e.off(ht.Muted,this.onTrackMuted),e.off(ht.Unmuted,this.onTrackUnmuted),e.off(ht.Ended,this.handleTrackEnded),e.off(ht.UpstreamPaused,this.onTrackUpstreamPaused),e.off(ht.UpstreamResumed,this.onTrackUpstreamResumed),e.off(ht.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),t===void 0&&(t=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),t?e.stop():e.stopMonitor();let s=!1;const l=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<_r.FAILED&&l)try{for(const d of this.engine.pcManager.publisher.getTransceivers())d.sender===l&&(d.direction="inactive",s=!0);if(this.engine.removeTrack(l)&&(s=!0),hc(e)){for(const[,d]of e.simulcastCodecs)d.sender&&(this.engine.removeTrack(d.sender)&&(s=!0),d.sender=void 0);e.simulcastCodecs.clear()}}catch(d){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),c),{error:d}))}switch(this.trackPublications.delete(o.trackSid),o.kind){case je.Kind.Audio:this.audioTrackPublications.delete(o.trackSid);break;case je.Kind.Video:this.videoTrackPublications.delete(o.trackSid);break}return this.emit($e.LocalTrackUnpublished,o),o.setTrack(void 0),s&&(yield this.engine.negotiate()),o})}unpublishTracks(e){return he(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>!!r)})}republishAllTracks(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){r.republishPromise&&(yield r.republishPromise),r.republishPromise=new go((o,c)=>he(r,void 0,void 0,function*(){try{const s=[];this.trackPublications.forEach(l=>{l.track&&(t&&(l.options=Object.assign(Object.assign({},l.options),t)),s.push(l))}),yield Promise.all(s.map(l=>he(this,void 0,void 0,function*(){const d=l.track;yield this.unpublishTrack(d,!1),i&&!d.isMuted&&d.source!==je.Source.ScreenShare&&d.source!==je.Source.ScreenShareAudio&&(Ea(d)||hc(d))&&!d.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:l.trackSid})),yield d.restartTrack()),yield this.publishOrRepublishTrack(d,l.options,!0)}))),o()}catch(s){s instanceof Error?c(s):c(new Error(String(s)))}finally{this.republishPromise=void 0}})),yield r.republishPromise}()})}publishData(e){return he(this,arguments,void 0,function(t){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const o=i.reliable?Sn.RELIABLE:Sn.LOSSY,c=i.destinationIdentities,s=i.topic;let l=new e1({participantIdentity:r.identity,payload:t,destinationIdentities:c,topic:s});const d=new Hi({kind:o,value:{case:"user",value:l}});yield r.engine.sendDataPacket(d,o)}()})}publishDtmf(e,t){return he(this,void 0,void 0,function*(){const r=new Hi({kind:Sn.RELIABLE,value:{case:"sipDtmf",value:new h_({code:e,digit:t})}});yield this.engine.sendDataPacket(r,Sn.RELIABLE)})}sendChatMessage(e,t){return he(this,void 0,void 0,function*(){const r={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:t==null?void 0:t.attachments},i=new Hi({value:{case:"chatMessage",value:new Ep(Object.assign(Object.assign({},r),{timestamp:vr.parse(r.timestamp)}))}});return yield this.engine.sendDataPacket(i,Sn.RELIABLE),this.emit($e.ChatMessage,r),r})}editChatMessage(e,t){return he(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},t),{message:e,editTimestamp:Date.now()}),i=new Hi({value:{case:"chatMessage",value:new Ep(Object.assign(Object.assign({},r),{timestamp:vr.parse(r.timestamp),editTimestamp:vr.parse(r.editTimestamp)}))}});return yield this.engine.sendDataPacket(i,Sn.RELIABLE),this.emit($e.ChatMessage,r),r})}sendText(e,t){return he(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,t)})}streamText(e){return he(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,t){return he(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,t)})}streamBytes(e){return he(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){let{destinationIdentity:t,method:r,payload:i,responseTimeout:o=15e3}=e;const c=7e3,s=c+1e3;return new go((l,d)=>he(this,void 0,void 0,function*(){var h,p,g,y;if(b1(i)>I2){d(Pr.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((p=(h=this.engine.latestJoinResponse)===null||h===void 0?void 0:h.serverInfo)===null||p===void 0)&&p.version&&Ms((y=(g=this.engine.latestJoinResponse)===null||g===void 0?void 0:g.serverInfo)===null||y===void 0?void 0:y.version,"1.8.0")<0){d(Pr.builtIn("UNSUPPORTED_SERVER"));return}const C=Math.max(o,s),x=crypto.randomUUID();yield this.publishRpcRequest(t,x,r,i,C);const w=setTimeout(()=>{this.pendingAcks.delete(x),d(Pr.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(x),clearTimeout(S)},c);this.pendingAcks.set(x,{resolve:()=>{clearTimeout(w)},participantIdentity:t});const S=setTimeout(()=>{this.pendingResponses.delete(x),d(Pr.builtIn("RESPONSE_TIMEOUT"))},o);this.pendingResponses.set(x,{resolve:(E,R)=>{clearTimeout(S),this.pendingAcks.has(x)&&(this.log.warn("RPC response received before ack",x),this.pendingAcks.delete(x),clearTimeout(w)),R?d(R):l(E??"")},participantIdentity:t})}))}registerRpcMethod(e,t){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const t=this.pendingAcks.get(e);t?(t.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,t,r){const i=this.pendingResponses.get(e);i?(i.resolve(t,r),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,t,r,i,o){return he(this,void 0,void 0,function*(){const c=new Hi({destinationIdentities:[e],kind:Sn.RELIABLE,value:{case:"rpcRequest",value:new t1({id:t,method:r,payload:i,responseTimeoutMs:o,version:1})}});yield this.engine.sendDataPacket(c,Sn.RELIABLE)})}handleParticipantDisconnected(e){for(const[t,{participantIdentity:r}]of this.pendingAcks)r===e&&this.pendingAcks.delete(t);for(const[t,{participantIdentity:r,resolve:i}]of this.pendingResponses)r===e&&(i(null,Pr.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(t))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(t=>t.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(t=>{var r,i;const o=this.trackPublications.get(t.sid);if(o){const c=o.isMuted||((i=(r=o.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);c!==t.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),kn(o)),{mutedOnServer:c})),this.engine.client.sendMuteTrack(t.sid,c))}}),!0):!1}setActiveAgent(e){var t,r,i,o;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(r=(t=this.activeAgentFuture)===null||t===void 0?void 0:t.resolve)===null||r===void 0||r.call(t,e):(o=(i=this.activeAgentFuture)===null||i===void 0?void 0:i.reject)===null||o===void 0||o.call(i,new Error("Agent disconnected")),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Jo),this.activeAgentFuture.promise)}getPublicationForTrack(e){let t;return this.trackPublications.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(Ea(i)||hc(i))&&i.mediaStreamTrack===e&&(t=r):e===i&&(t=r))}),t}waitForPendingPublicationOfSource(e){return he(this,void 0,void 0,function*(){const r=Date.now();for(;Date.now()<r+1e4;){const i=Array.from(this.pendingPublishPromises.entries()).find(o=>{let[c]=o;return c.source===e});if(i)return i[1];yield Ci(20)}})}}class D2 extends _a{constructor(e,t,r,i){super(e,t.sid,t.name,i),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=o=>{this.setTrack(void 0),this.emit(ht.Ended,o)},this.handleVisibilityChange=o=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(o),this.logContext),this.visible=o,this.emitTrackUpdate()},this.handleVideoDimensionsChange=o=>{this.log.debug("adaptivestream video dimensions ".concat(o.width,"x").concat(o.height),this.logContext),this.videoDimensionsAdaptiveStream=o,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new rg({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new g_({participantSid:"",trackSids:[this.trackSid]})]});this.emit(ht.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?_a.SubscriptionStatus.Unsubscribed:super.isSubscribed?_a.SubscriptionStatus.Subscribed:_a.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?_a.PermissionStatus.Allowed:_a.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,r;this.isManualOperationAllowed()&&(((t=this.requestedVideoDimensions)===null||t===void 0?void 0:t.width)===e.width&&((r=this.requestedVideoDimensions)===null||r===void 0?void 0:r.height)===e.height||(kv(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&kv(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:No.HIGH}setTrack(e){const t=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(ht.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(ht.VisibilityChanged,this.handleVisibilityChange),i.off(ht.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(ht.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(ht.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(ht.VisibilityChanged,this.handleVisibilityChange),e.on(ht.Ended,this.handleEnded),this.emit(ht.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(ht.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?ht.Muted:ht.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(ht.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(ht.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return kv(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new S_({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===je.Kind.Video){let t=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(t)$S(this.videoDimensionsAdaptiveStream,t)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const r=JU(this.trackInfo,this.requestedMaxQuality);r&&$S(this.videoDimensionsAdaptiveStream,r)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream;t?(e.width=Math.ceil(t.width),e.height=Math.ceil(t.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:No.HIGH})),e.quality=No.HIGH)}this.emit(ht.UpdateSettings,e)}}class Np extends R2{static fromParticipantInfo(e,t,r){return new Np(e,t.sid,t.identity,t.name,t.metadata,t.attributes,r,t.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,t,r,i,o,c,s){let l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:gf.STANDARD;super(t,r||"",i,o,c,s,l),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(ht.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),kn(e)),{settings:t})),this.signalClient.sendUpdateTrackSettings(t)}),e.on(ht.UpdateSubscription,t=>{t.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(t)}),e.on(ht.SubscriptionPermissionChanged,t=>{this.emit($e.TrackSubscriptionPermissionChanged,e,t)}),e.on(ht.SubscriptionStatusChanged,t=>{this.emit($e.TrackSubscriptionStatusChanged,e,t)}),e.on(ht.Subscribed,t=>{this.emit($e.TrackSubscribed,t,e)}),e.on(ht.Unsubscribed,t=>{this.emit($e.TrackUnsubscribed,t,e)}),e.on(ht.SubscriptionFailed,t=>{this.emit($e.TrackSubscriptionFailed,e.trackSid,t)})}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je.Source.Microphone;this.volumeMap.set(t,e);const r=this.getTrackPublication(t);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:je.Source.Microphone;const t=this.getTrackPublication(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,r,i,o,c){let s=this.getTrackPublicationBySid(t);if(s||t.startsWith("TR")||this.trackPublications.forEach(h=>{!s&&e.kind===h.kind.toString()&&(s=h)}),!s){if(c===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),this.emit($e.TrackSubscriptionFailed,t);return}c===void 0&&(c=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,t,r,i,o,c-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),kn(s))),this.emit($e.TrackSubscriptionFailed,t);return}const l=e.kind==="video";let d;return l?d=new _V(e,t,i,o):d=new _2(e,t,i,this.audioContext,this.audioOutput),d.source=s.source,d.isMuted=s.isMuted,d.setMediaStream(r),d.start(),s.setTrack(d),this.volumeMap.has(s.source)&&Xy(d)&&Js(d)&&d.setVolume(this.volumeMap.get(s.source)),s}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,r=new Map;return e.tracks.forEach(i=>{var o,c;let s=this.getTrackPublicationBySid(i.sid);if(s)s.updateInfo(i);else{const l=je.kindFromProto(i.type);if(!l)return;s=new D2(l,i,(o=this.signalClient.connectOptions)===null||o===void 0?void 0:o.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(c=this.loggerOptions)===null||c===void 0?void 0:c.loggerName}),s.updateInfo(i),r.set(i.sid,s);const d=Array.from(this.trackPublications.values()).find(h=>h.source===(s==null?void 0:s.source));d&&s.source!==je.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(s.source),Object.assign(Object.assign({},this.logContext),{oldTrack:kn(d),newTrack:kn(s)})),this.addTrackPublication(s)}t.set(i.sid,s)}),this.trackPublications.forEach(i=>{t.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),kn(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit($e.TrackPublished,i)}),!0}unpublishTrack(e,t){const r=this.trackPublications.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.trackPublications.delete(e),r.kind){case je.Kind.Audio:this.audioTrackPublications.delete(e);break;case je.Kind.Video:this.videoTrackPublications.delete(e);break}t&&this.emit($e.TrackUnpublished,r)}setAudioOutput(e){return he(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTrackPublications.forEach(r=>{var i;Js(r.track)&&Xy(r.track)&&t.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}var Mn;(function(n){n.Disconnected="disconnected",n.Connecting="connecting",n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting"})(Mn||(Mn={}));const FV=4*1e3;class ja extends ca.EventEmitter{get hasE2EESetup(){return this.e2eeManager!==void 0}constructor(e){var t,r,i,o,c;if(super(),t=this,this.state=Mn.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=gn,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(s,l,d)=>he(this,void 0,void 0,function*(){var h;if(!oj())throw na()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const p=yield this.disconnectLock.lock();if(this.state===Mn.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),p(),Promise.resolve();if(this.connectFuture)return p(),this.connectFuture.promise;this.setAndEmitConnectionState(Mn.Connecting),((h=this.regionUrlProvider)===null||h===void 0?void 0:h.getServerUrl().toString())!==y2(s)&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Uu(new URL(s))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Nn(s,l):this.regionUrlProvider.updateToken(l),this.regionUrlProvider.fetchRegionSettings().then(C=>{var x;(x=this.regionUrlProvider)===null||x===void 0||x.setServerReportedRegions(C)}).catch(C=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:C}))}));const g=(C,x,w)=>he(this,void 0,void 0,function*(){var S,E;this.abortController&&this.abortController.abort();const R=new AbortController;this.abortController=R,p==null||p();try{if(yield ku.getInstance().getBackOffPromise(s),R.signal.aborted)throw tn.cancelled("Connection attempt aborted");yield this.attemptConnection(w??s,l,d,R),this.abortController=void 0,C()}catch(k){if(this.regionUrlProvider&&k instanceof tn&&k.reason!==Kn.Cancelled&&k.reason!==Kn.NotAllowed){let A=null;try{this.log.debug("Fetching next region"),A=yield this.regionUrlProvider.getNextBestRegionUrl((S=this.abortController)===null||S===void 0?void 0:S.signal)}catch(_){if(_ instanceof tn&&(_.status===401||_.reason===Kn.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),x(_);return}}[Kn.InternalError,Kn.ServerUnreachable,Kn.Timeout].includes(k.reason)&&(this.log.debug("Adding failed connection attempt to back off"),ku.getInstance().addFailedConnectionAttempt(s)),A&&!(!((E=this.abortController)===null||E===void 0)&&E.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(k.message,". Retrying with another region: ").concat(A),this.logContext),this.recreateEngine(),yield g(C,x,A)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,tA(k)),x(k))}else{let A=Rs.UNKNOWN_REASON;k instanceof tn&&(A=tA(k)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,A),x(k)}}}),y=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Jo((C,x)=>{g(C,x,y)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(s,l,d,h,p,g)=>he(this,void 0,void 0,function*(){var y,C,x;const w=yield d.join(s,l,{autoSubscribe:h.autoSubscribe,adaptiveStream:typeof p.adaptiveStream=="object"?!0:p.adaptiveStream,maxRetries:h.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:h.websocketTimeout},g.signal,!p.singlePeerConnection);let S=w.serverInfo;if(S||(S={version:w.serverVersion,region:w.serverRegion}),this.serverInfo=S,this.log.debug("connected to Livekit Server ".concat(Object.entries(S).map(E=>{let[R,k]=E;return"".concat(R,": ").concat(k)}).join(", ")),{room:(y=w.room)===null||y===void 0?void 0:y.name,roomSid:(C=w.room)===null||C===void 0?void 0:C.sid,identity:(x=w.participant)===null||x===void 0?void 0:x.identity}),!S.version)throw new VU("unknown server version");return S.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),p.dynacast=!1),w}),this.applyJoinResponse=s=>{const l=s.participant;if(this.localParticipant.sid=l.sid,this.localParticipant.identity=l.identity,this.localParticipant.setEnabledPublishCodecs(s.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(s.sifTrailer)}catch(d){this.log.error(d instanceof Error?d.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:d}))}this.handleParticipantUpdates([l,...s.otherParticipants]),s.room&&this.handleRoomUpdate(s.room)},this.attemptConnection=(s,l,d,h)=>he(this,void 0,void 0,function*(){var p,g;this.state===Mn.Reconnecting||this.isResuming||!((p=this.engine)===null||p===void 0)&&p.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((g=this.regionUrlProvider)===null||g===void 0)&&g.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},x1),d),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const y=yield this.connectSignal(s,l,this.engine,this.connOptions,this.options,h);this.applyJoinResponse(y),this.setupLocalParticipantEvents(),this.emit(We.SignalConnected)}catch(y){yield this.engine.close(),this.recreateEngine();const C=h.signal.aborted?tn.cancelled("Signal connection aborted"):tn.serverUnreachable("could not establish signal connection");throw y instanceof Error&&(C.message="".concat(C.message,": ").concat(y.message)),y instanceof tn&&(C.reason=y.reason,C.status=y.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:y})),C}if(h.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),tn.cancelled("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,h)}catch(y){throw yield this.engine.close(),this.recreateEngine(),y}mo()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),mo()&&window.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Mn.Connected),this.emit(We.Connected),ku.getInstance().resetFailedConnectionAttempts(s),this.registerConnectionReconcile(),this.regionUrlProvider&&this.regionUrlProvider.notifyConnected()}),this.disconnect=function(){for(var s=arguments.length,l=new Array(s),d=0;d<s;d++)l[d]=arguments[d];return he(t,[...l],void 0,function(){var h=this;let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var g,y,C;const x=yield h.disconnectLock.lock();try{if(h.state===Mn.Disconnected){h.log.debug("already disconnected",h.logContext);return}if(h.log.info("disconnect from room",Object.assign({},h.logContext)),h.state===Mn.Connecting||h.state===Mn.Reconnecting||h.isResuming){const w="Abort connection attempt due to user initiated disconnect";h.log.warn(w,h.logContext),(g=h.abortController)===null||g===void 0||g.abort(w),(C=(y=h.connectFuture)===null||y===void 0?void 0:y.reject)===null||C===void 0||C.call(y,tn.cancelled("Client initiated disconnect")),h.connectFuture=void 0}h.engine&&(h.engine.client.isDisconnected||(yield h.engine.client.sendLeave()),yield h.engine.close()),h.handleDisconnect(p,Rs.CLIENT_INITIATED),h.engine=void 0}finally{x()}}()})},this.onPageLeave=()=>he(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>he(this,void 0,void 0,function*(){const s=[],l=Ki();if(l&&l.os==="iOS"){const d="livekit-dummy-audio-el";let h=document.getElementById(d);if(!h){h=document.createElement("audio"),h.id=d,h.autoplay=!0,h.hidden=!0;const p=Av();p.enabled=!0;const g=new MediaStream([p]);h.srcObject=g,document.addEventListener("visibilitychange",()=>{h&&(h.srcObject=document.hidden?null:g,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(h),this.once(We.Disconnected,()=>{h==null||h.remove(),h=null})}s.push(h)}this.remoteParticipants.forEach(d=>{d.audioTrackPublications.forEach(h=>{h.track&&h.track.attachedElements.forEach(p=>{s.push(p)})})});try{yield Promise.all([this.acquireAudioContext(),...s.map(d=>(d.muted=!1,d.play()))]),this.handleAudioPlaybackStarted()}catch(d){throw this.handleAudioPlaybackFailed(d),d}}),this.startVideo=()=>he(this,void 0,void 0,function*(){const s=[];for(const l of this.remoteParticipants.values())l.videoTrackPublications.forEach(d=>{var h;(h=d.track)===null||h===void 0||h.attachedElements.forEach(p=>{s.includes(p)||s.push(p)})});yield Promise.all(s.map(l=>l.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(l=>{l.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const s of this.remoteParticipants.values())this.handleParticipantDisconnected(s.identity,s);this.setAndEmitConnectionState(Mn.Reconnecting)&&this.emit(We.Reconnecting)},this.handleSignalRestarted=s=>he(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(s.serverRegion),Object.assign(Object.assign({},this.logContext),{region:s.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(s);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(l){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:l}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:s.serverRegion}))}catch{return}this.setAndEmitConnectionState(Mn.Connected),this.emit(We.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=s=>{s.forEach(l=>{var d;if(l.identity===this.localParticipant.identity){this.localParticipant.updateInfo(l);return}l.identity===""&&(l.identity=(d=this.sidToIdentity.get(l.sid))!==null&&d!==void 0?d:"");let h=this.remoteParticipants.get(l.identity);l.state===bu.DISCONNECTED?this.handleParticipantDisconnected(l.identity,h):h=this.getOrCreateParticipant(l.identity,l)})},this.handleActiveSpeakersUpdate=s=>{const l=[],d={};s.forEach(h=>{if(d[h.sid]=!0,h.sid===this.localParticipant.sid)this.localParticipant.audioLevel=h.level,this.localParticipant.setIsSpeaking(!0),l.push(this.localParticipant);else{const p=this.getRemoteParticipantBySid(h.sid);p&&(p.audioLevel=h.level,p.setIsSpeaking(!0),l.push(p))}}),d[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(h=>{d[h.sid]||(h.audioLevel=0,h.setIsSpeaking(!1))}),this.activeSpeakers=l,this.emitWhenConnected(We.ActiveSpeakersChanged,l)},this.handleSpeakersChanged=s=>{const l=new Map;this.activeSpeakers.forEach(h=>{const p=this.remoteParticipants.get(h.identity);p&&p.sid!==h.sid||l.set(h.sid,h)}),s.forEach(h=>{let p=this.getRemoteParticipantBySid(h.sid);h.sid===this.localParticipant.sid&&(p=this.localParticipant),p&&(p.audioLevel=h.level,p.setIsSpeaking(h.active),h.active?l.set(h.sid,p):l.delete(h.sid))});const d=Array.from(l.values());d.sort((h,p)=>p.audioLevel-h.audioLevel),this.activeSpeakers=d,this.emitWhenConnected(We.ActiveSpeakersChanged,d)},this.handleStreamStateUpdate=s=>{s.streamStates.forEach(l=>{const d=this.getRemoteParticipantBySid(l.participantSid);if(!d)return;const h=d.getTrackPublicationBySid(l.trackSid);if(!h||!h.track)return;const p=je.streamStateFromProto(l.state);h.track.setStreamState(p),p!==h.track.streamState&&(d.emit($e.TrackStreamStateChanged,h,h.track.streamState),this.emitWhenConnected(We.TrackStreamStateChanged,h,h.track.streamState,d))})},this.handleSubscriptionPermissionUpdate=s=>{const l=this.getRemoteParticipantBySid(s.participantSid);if(!l)return;const d=l.getTrackPublicationBySid(s.trackSid);d&&d.setAllowed(s.allowed)},this.handleSubscriptionError=s=>{const l=Array.from(this.remoteParticipants.values()).find(h=>h.trackPublications.has(s.trackSid));if(!l)return;const d=l.getTrackPublicationBySid(s.trackSid);d&&d.setSubscriptionError(s.err)},this.handleDataPacket=(s,l)=>{const d=this.remoteParticipants.get(s.participantIdentity);if(s.value.case==="user")this.handleUserPacket(d,s.value.value,s.kind,l);else if(s.value.case==="transcription")this.handleTranscription(d,s.value.value);else if(s.value.case==="sipDtmf")this.handleSipDtmf(d,s.value.value);else if(s.value.case==="chatMessage")this.handleChatMessage(d,s.value.value);else if(s.value.case==="metrics")this.handleMetrics(s.value.value,d);else if(s.value.case==="streamHeader"||s.value.case==="streamChunk"||s.value.case==="streamTrailer")this.handleDataStream(s,l);else if(s.value.case==="rpcRequest"){const h=s.value.value;this.handleIncomingRpcRequest(s.participantIdentity,h.id,h.method,h.payload,h.responseTimeoutMs,h.version)}},this.handleUserPacket=(s,l,d,h)=>{this.emit(We.DataReceived,l.payload,s,d,l.topic,h),s==null||s.emit($e.DataReceived,l.payload,d,h)},this.handleSipDtmf=(s,l)=>{this.emit(We.SipDTMFReceived,l,s),s==null||s.emit($e.SipDTMFReceived,l)},this.handleTranscription=(s,l)=>{const d=l.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(l.transcribedParticipantIdentity),h=d==null?void 0:d.trackPublications.get(l.trackId),p=gj(l,this.transcriptionReceivedTimes);h==null||h.emit(ht.TranscriptionReceived,p),d==null||d.emit($e.TranscriptionReceived,p,h),this.emit(We.TranscriptionReceived,p,d,h)},this.handleChatMessage=(s,l)=>{const d=mj(l);this.emit(We.ChatMessage,d,s)},this.handleMetrics=(s,l)=>{this.emit(We.MetricsReceived,s,l)},this.handleDataStream=(s,l)=>{this.incomingDataStreamManager.handleDataStreamPacket(s,l)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(We.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=s=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:s})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(We.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(We.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(We.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>he(this,void 0,void 0,function*(){var s;((s=Ki())===null||s===void 0?void 0:s.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(We.MediaDevicesChanged)}),this.handleRoomUpdate=s=>{const l=this.roomInfo;this.roomInfo=s,l&&l.metadata!==s.metadata&&this.emitWhenConnected(We.RoomMetadataChanged,s.metadata),(l==null?void 0:l.activeRecording)!==s.activeRecording&&this.emitWhenConnected(We.RecordingStatusChanged,s.activeRecording)},this.handleConnectionQualityUpdate=s=>{s.updates.forEach(l=>{if(l.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(l.quality);return}const d=this.getRemoteParticipantBySid(l.participantSid);d&&d.setConnectionQuality(l.quality)})},this.onLocalParticipantMetadataChanged=s=>{this.emit(We.ParticipantMetadataChanged,s,this.localParticipant)},this.onLocalParticipantNameChanged=s=>{this.emit(We.ParticipantNameChanged,s,this.localParticipant)},this.onLocalAttributesChanged=s=>{this.emit(We.ParticipantAttributesChanged,s,this.localParticipant)},this.onLocalTrackMuted=s=>{this.emit(We.TrackMuted,s,this.localParticipant)},this.onLocalTrackUnmuted=s=>{this.emit(We.TrackUnmuted,s,this.localParticipant)},this.onTrackProcessorUpdate=s=>{var l;(l=s==null?void 0:s.onPublish)===null||l===void 0||l.call(s,this)},this.onLocalTrackPublished=s=>he(this,void 0,void 0,function*(){var l,d,h,p,g,y;(l=s.track)===null||l===void 0||l.on(ht.TrackProcessorUpdate,this.onTrackProcessorUpdate),(d=s.track)===null||d===void 0||d.on(ht.Restarted,this.onLocalTrackRestarted),(g=(p=(h=s.track)===null||h===void 0?void 0:h.getProcessor())===null||p===void 0?void 0:p.onPublish)===null||g===void 0||g.call(p,this),this.emit(We.LocalTrackPublished,s,this.localParticipant),Ea(s.track)&&(yield s.track.checkForSilence())&&this.emit(We.LocalAudioSilenceDetected,s);const C=yield(y=s.track)===null||y===void 0?void 0:y.getDeviceId(!1),x=Wy(s.source);x&&C&&C!==this.localParticipant.activeDeviceMap.get(x)&&(this.localParticipant.activeDeviceMap.set(x,C),this.emit(We.ActiveDeviceChanged,x,C))}),this.onLocalTrackUnpublished=s=>{var l,d;(l=s.track)===null||l===void 0||l.off(ht.TrackProcessorUpdate,this.onTrackProcessorUpdate),(d=s.track)===null||d===void 0||d.off(ht.Restarted,this.onLocalTrackRestarted),this.emit(We.LocalTrackUnpublished,s,this.localParticipant)},this.onLocalTrackRestarted=s=>he(this,void 0,void 0,function*(){const l=yield s.getDeviceId(!1),d=Wy(s.source);d&&l&&l!==this.localParticipant.activeDeviceMap.get(d)&&(this.log.debug("local track restarted, setting ".concat(d," ").concat(l," active"),this.logContext),this.localParticipant.activeDeviceMap.set(d,l),this.emit(We.ActiveDeviceChanged,d,l))}),this.onLocalConnectionQualityChanged=s=>{this.emit(We.ConnectionQualityChanged,s,this.localParticipant)},this.onMediaDevicesError=(s,l)=>{this.emit(We.MediaDevicesError,s,l)},this.onLocalParticipantPermissionsChanged=s=>{this.emit(We.ParticipantPermissionsChanged,s,this.localParticipant)},this.onLocalChatMessageSent=s=>{this.emit(We.ChatMessage,s,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},Kj),e),this.log=Ua((r=this.options.loggerName)!==null&&r!==void 0?r:Ps.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},C2),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},x2),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},$j),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new AV,this.outgoingDataStreamManager=new TV(this.engine,this.log),this.disconnectLock=new $i,this.localParticipant=new OV("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Tc(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Tc(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",Tc(this.options.audioOutput.deviceId)).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),mo()){const s=new AbortController;(c=(o=navigator.mediaDevices)===null||o===void 0?void 0:o.addEventListener)===null||c===void 0||c.call(o,"devicechange",this.handleDeviceChange,{signal:s.signal}),ja.cleanupRegistry&&ja.cleanupRegistry.register(this,()=>{s.abort()})}}registerTextStreamHandler(e,t){return this.incomingDataStreamManager.registerTextStreamHandler(e,t)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,t){return this.incomingDataStreamManager.registerByteStreamHandler(e,t)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,t){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return he(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;const t=!!this.options.encryption,r=this.options.encryption||this.options.e2ee;r&&("e2eeManager"in r?(this.e2eeManager=r.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=t):this.e2eeManager=new Dj(r,t),this.e2eeManager.on(Sc.ParticipantEncryptionStatusChanged,(i,o)=>{yj(o)&&(this.isE2EEEnabled=i),this.emit(We.ParticipantEncryptionStatusChanged,i,o)}),this.e2eeManager.on(Sc.EncryptionError,(i,o)=>{const c=o?this.getParticipantByIdentity(o):void 0;this.emit(We.EncryptionError,i,c)}),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&t!==void 0?t:!1}getSid(){return this.state===Mn.Disconnected?go.resolve(""):this.roomInfo&&this.roomInfo.sid!==""?go.resolve(this.roomInfo.sid):new go((e,t)=>{const r=i=>{i.sid!==""&&(this.engine.off(vt.RoomUpdate,r),e(i.sid))};this.engine.on(vt.RoomUpdate,r),this.once(We.Disconnected,()=>{this.engine.off(vt.RoomUpdate,r),t(new Or("Room disconnected before room server id was available"))})})}get name(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&t!==void 0?t:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&t!==void 0?t:0}get numPublishers(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&t!==void 0?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new bV(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(vt.ParticipantUpdate,this.handleParticipantUpdates).on(vt.RoomUpdate,this.handleRoomUpdate).on(vt.SpeakersChanged,this.handleSpeakersChanged).on(vt.StreamStateChanged,this.handleStreamStateUpdate).on(vt.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(vt.SubscriptionError,this.handleSubscriptionError).on(vt.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(vt.MediaTrackAdded,(e,t,r)=>{this.onTrackAdded(e,t,r)}).on(vt.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(vt.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(vt.DataPacketReceived,this.handleDataPacket).on(vt.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Mn.SignalReconnecting)&&this.emit(We.SignalReconnecting)}).on(vt.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Mn.Connected)&&this.emit(We.Reconnected)}).on(vt.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Mn.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(vt.Restarting,this.handleRestarting).on(vt.SignalRestarted,this.handleSignalRestarted).on(vt.Offline,()=>{this.setAndEmitConnectionState(Mn.Reconnecting)&&this.emit(We.Reconnecting)}).on(vt.DCBufferStatusChanged,(e,t)=>{this.emit(We.DCBufferStatusChanged,e,t)}).on(vt.LocalTrackSubscribed,e=>{const t=this.localParticipant.getTrackPublications().find(r=>{let{trackSid:i}=r;return i===e});if(!t){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit($e.LocalTrackSubscribed,t),this.emitWhenConnected(We.LocalTrackSubscribed,t,this.localParticipant)}).on(vt.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((t,r)=>{this.handleParticipantDisconnected(r,t)}),this.emit(We.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return ui.getInstance().getDevices(e,t)}prepareConnection(e,t){return he(this,void 0,void 0,function*(){if(this.state===Mn.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Uu(new URL(e))&&t){this.regionUrlProvider=new Nn(e,t);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===Mn.Disconnected&&(this.regionUrl=r,yield fetch(xf(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(xf(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return he(this,void 0,void 0,function*(){let r=()=>he(this,void 0,void 0,function*(){}),i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new qs({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new qs({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new qs({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new qs({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>he(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new qs({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>he(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new qs({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new qs({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>he(this,void 0,void 0,function*(){const o=this.engine.client.onLeave;o&&o(new ig({reason:Rs.CLIENT_INITIATED,action:Iu.RECONNECT}))});break;case"subscriber-bandwidth":if(t===void 0||typeof t!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new qs({scenario:{case:"subscriberBandwidth",value:ll(t)}});break;case"leave-full-reconnect":i=new qs({scenario:{case:"leaveRequestFullReconnect",value:!0}})}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){return he(this,arguments,void 0,function(r,i){var o=this;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return function*(){var s,l,d,h,p,g,y;let C=!0,x=!1;const w=c?{exact:i}:i;if(r==="audioinput"){x=o.localParticipant.audioTrackPublications.size===0;const S=(s=o.getActiveDevice(r))!==null&&s!==void 0?s:o.options.audioCaptureDefaults.deviceId;o.options.audioCaptureDefaults.deviceId=w;const E=Array.from(o.localParticipant.audioTrackPublications.values()).filter(k=>k.source===je.Source.Microphone);try{C=(yield Promise.all(E.map(k=>{var A;return(A=k.audioTrack)===null||A===void 0?void 0:A.setDeviceId(w)}))).every(k=>k===!0)}catch(k){throw o.options.audioCaptureDefaults.deviceId=S,k}const R=E.some(k=>{var A,_;return(_=(A=k.track)===null||A===void 0?void 0:A.isMuted)!==null&&_!==void 0?_:!1});C&&R&&(x=!0)}else if(r==="videoinput"){x=o.localParticipant.videoTrackPublications.size===0;const S=(l=o.getActiveDevice(r))!==null&&l!==void 0?l:o.options.videoCaptureDefaults.deviceId;o.options.videoCaptureDefaults.deviceId=w;const E=Array.from(o.localParticipant.videoTrackPublications.values()).filter(k=>k.source===je.Source.Camera);try{C=(yield Promise.all(E.map(k=>{var A;return(A=k.videoTrack)===null||A===void 0?void 0:A.setDeviceId(w)}))).every(k=>k===!0)}catch(k){throw o.options.videoCaptureDefaults.deviceId=S,k}const R=E.some(k=>{var A,_;return(_=(A=k.track)===null||A===void 0?void 0:A.isMuted)!==null&&_!==void 0?_:!1});C&&R&&(x=!0)}else if(r==="audiooutput"){if(x=!0,!Zy()&&!o.options.webAudioMix||o.options.webAudioMix&&o.audioContext&&!("setSinkId"in o.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");o.options.webAudioMix&&(i=(d=yield ui.getInstance().normalizeDeviceId("audiooutput",i))!==null&&d!==void 0?d:""),(h=(y=o.options).audioOutput)!==null&&h!==void 0||(y.audioOutput={});const S=(p=o.getActiveDevice(r))!==null&&p!==void 0?p:o.options.audioOutput.deviceId;o.options.audioOutput.deviceId=i;try{o.options.webAudioMix&&((g=o.audioContext)===null||g===void 0||g.setSinkId(i)),yield Promise.all(Array.from(o.remoteParticipants.values()).map(E=>E.setAudioOutput({deviceId:i})))}catch(E){throw o.options.audioOutput.deviceId=S,E}}return x&&(o.localParticipant.activeDeviceMap.set(r,i),o.emit(We.ActiveDeviceChanged,r,i)),C}()})}setupLocalParticipantEvents(){this.localParticipant.on($e.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on($e.ParticipantNameChanged,this.onLocalParticipantNameChanged).on($e.AttributesChanged,this.onLocalAttributesChanged).on($e.TrackMuted,this.onLocalTrackMuted).on($e.TrackUnmuted,this.onLocalTrackUnmuted).on($e.LocalTrackPublished,this.onLocalTrackPublished).on($e.LocalTrackUnpublished,this.onLocalTrackUnpublished).on($e.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on($e.MediaDevicesError,this.onMediaDevicesError).on($e.AudioStreamAcquired,this.startAudio).on($e.ChatMessage,this.onLocalChatMessageSent).on($e.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,r){if(this.state===Mn.Connecting||this.state===Mn.Reconnecting){const p=()=>{this.log.debug("deferring on track for later",{mediaTrackId:e.id,mediaStreamId:t.id,tracksInStream:t.getTracks().map(y=>y.id)}),this.onTrackAdded(e,t,r),g()},g=()=>{this.off(We.Reconnected,p),this.off(We.Connected,p),this.off(We.Disconnected,g)};this.once(We.Reconnected,p),this.once(We.Connected,p),this.once(We.Disconnected,g);return}if(this.state===Mn.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const i=nj(t.id),o=i[0];let c=i[1],s=e.id;if(c&&c.startsWith("TR")&&(s=c),o===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const l=Array.from(this.remoteParticipants.values()).find(p=>p.sid===o);if(!l){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);return}if(!s.startsWith("TR")){const p=this.engine.getTrackIdForReceiver(r);if(!p){this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(o),this.logContext);return}s=p}s.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(o,", streamId: ").concat(c,", trackId: ").concat(s),Object.assign(Object.assign({},this.logContext),{rpID:o,streamId:c,trackId:s}));let d;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?d=this.options.adaptiveStream:d={});const h=l.addSubscribedMediaTrack(e,s,t,r,d);h!=null&&h.isEncrypted&&!this.e2eeManager&&this.emit(We.EncryptionError,new Error("Encrypted ".concat(h.source," track received from participant ").concat(l.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1?arguments[1]:void 0;var r,i;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearControllers(),this.state!==Mn.Disconnected){this.regionUrl=void 0,this.regionUrlProvider&&this.regionUrlProvider.notifyDisconnected();try{this.remoteParticipants.forEach(o=>{o.trackPublications.forEach(c=>{o.unpublishTrack(c.trackSid)})}),this.localParticipant.trackPublications.forEach(o=>{var c,s,l;o.track&&this.localParticipant.unpublishTrack(o.track,e),e?((c=o.track)===null||c===void 0||c.detach(),(s=o.track)===null||s===void 0||s.stop()):(l=o.track)===null||l===void 0||l.stopMonitor()}),this.localParticipant.off($e.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off($e.ParticipantNameChanged,this.onLocalParticipantNameChanged).off($e.AttributesChanged,this.onLocalAttributesChanged).off($e.TrackMuted,this.onLocalTrackMuted).off($e.TrackUnmuted,this.onLocalTrackUnmuted).off($e.LocalTrackPublished,this.onLocalTrackPublished).off($e.LocalTrackUnpublished,this.onLocalTrackUnpublished).off($e.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off($e.MediaDevicesError,this.onMediaDevicesError).off($e.AudioStreamAcquired,this.startAudio).off($e.ChatMessage,this.onLocalChatMessageSent).off($e.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),mo()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(i=(r=navigator.mediaDevices)===null||r===void 0?void 0:r.removeEventListener)===null||i===void 0||i.call(r,"devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Mn.Disconnected),this.emit(We.Disconnected,t)}}}handleParticipantDisconnected(e,t){var r;this.remoteParticipants.delete(e),t&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),t.trackPublications.forEach(i=>{t.unpublishTrack(i.trackSid,!0)}),this.emit(We.ParticipantDisconnected,t),t.setDisconnected(),(r=this.localParticipant)===null||r===void 0||r.handleParticipantDisconnected(t.identity))}handleIncomingRpcRequest(e,t,r,i,o,c){return he(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,t),c!==1){yield this.engine.publishRpcResponse(e,t,null,Pr.builtIn("UNSUPPORTED_VERSION"));return}const s=this.rpcHandlers.get(r);if(!s){yield this.engine.publishRpcResponse(e,t,null,Pr.builtIn("UNSUPPORTED_METHOD"));return}let l=null,d=null;try{const h=yield s({requestId:t,callerIdentity:e,payload:i,responseTimeout:o});b1(h)>I2?(l=Pr.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),this.log.warn("RPC Response payload too large for ".concat(r))):d=h}catch(h){h instanceof Pr?l=h:(this.log.warn("Uncaught error returned by RPC handler for ".concat(r,". Returning APPLICATION_ERROR instead."),h),l=Pr.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,t,d,l)})}selectDefaultDevices(){return he(this,void 0,void 0,function*(){var e,t,r;const i=ui.getInstance().previousDevices,o=yield ui.getInstance().getDevices(void 0,!1),c=Ki();if((c==null?void 0:c.name)==="Chrome"&&c.os!=="iOS")for(let l of o){const d=i.find(h=>h.deviceId===l.deviceId);d&&d.label!==""&&d.kind===l.kind&&d.label!==l.label&&this.getActiveDevice(l.kind)==="default"&&this.emit(We.ActiveDeviceChanged,l.kind,l.deviceId)}const s=["audiooutput","audioinput","videoinput"];for(let l of s){const d=XU(l),h=this.localParticipant.getTrackPublication(d);if(h&&(!((e=h.track)===null||e===void 0)&&e.isUserProvided))continue;const p=o.filter(y=>y.kind===l),g=this.getActiveDevice(l);if(g===((t=i.filter(y=>y.kind===l)[0])===null||t===void 0?void 0:t.deviceId)&&p.length>0&&((r=p[0])===null||r===void 0?void 0:r.deviceId)!==g){yield this.switchActiveDevice(l,p[0].deviceId);continue}l==="audioinput"&&!Cf()||l==="videoinput"||p.length>0&&!p.find(y=>y.deviceId===this.getActiveDevice(l))&&(l!=="audiooutput"||!Cf())&&(yield this.switchActiveDevice(l,p[0].deviceId))}})}acquireAudioContext(){return he(this,void 0,void 0,function*(){var e,t;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=p1())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),Ci(200)])}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}const r=((t=this.audioContext)===null||t===void 0?void 0:t.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(We.AudioPlaybackStatusChanged,r))})}createParticipant(e,t){var r;let i;return t?i=Np.fromParticipantInfo(this.engine.client,t,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):i=new Np(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),i}getOrCreateParticipant(e,t){if(this.remoteParticipants.has(e)){const i=this.remoteParticipants.get(e);return t&&i.updateInfo(t)&&this.sidToIdentity.set(t.sid,t.identity),i}const r=this.createParticipant(e,t);return this.remoteParticipants.set(e,r),this.sidToIdentity.set(t.sid,t.identity),this.emitWhenConnected(We.ParticipantConnected,r),r.on($e.TrackPublished,i=>{this.emitWhenConnected(We.TrackPublished,i,r)}).on($e.TrackSubscribed,(i,o)=>{i.kind===je.Kind.Audio?(i.on(ht.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(ht.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===je.Kind.Video&&(i.on(ht.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(ht.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(We.TrackSubscribed,i,o,r)}).on($e.TrackUnpublished,i=>{this.emit(We.TrackUnpublished,i,r)}).on($e.TrackUnsubscribed,(i,o)=>{this.emit(We.TrackUnsubscribed,i,o,r)}).on($e.TrackMuted,i=>{this.emitWhenConnected(We.TrackMuted,i,r)}).on($e.TrackUnmuted,i=>{this.emitWhenConnected(We.TrackUnmuted,i,r)}).on($e.ParticipantMetadataChanged,i=>{this.emitWhenConnected(We.ParticipantMetadataChanged,i,r)}).on($e.ParticipantNameChanged,i=>{this.emitWhenConnected(We.ParticipantNameChanged,i,r)}).on($e.AttributesChanged,i=>{this.emitWhenConnected(We.ParticipantAttributesChanged,i,r)}).on($e.ConnectionQualityChanged,i=>{this.emitWhenConnected(We.ConnectionQualityChanged,i,r)}).on($e.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(We.ParticipantPermissionsChanged,i,r)}).on($e.TrackSubscriptionStatusChanged,(i,o)=>{this.emitWhenConnected(We.TrackSubscriptionStatusChanged,i,o,r)}).on($e.TrackSubscriptionFailed,(i,o)=>{this.emit(We.TrackSubscriptionFailed,i,r,o)}).on($e.TrackSubscriptionPermissionChanged,(i,o)=>{this.emitWhenConnected(We.TrackSubscriptionPermissionChanged,i,o,r)}).on($e.Active,()=>{this.emitWhenConnected(We.ParticipantActive,r),r.kind===gf.AGENT&&this.localParticipant.setActiveAgent(r)}),t&&r.updateInfo(t),r}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((r,i)=>(r.push(...i.getTrackPublications()),r),[]),t=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const t of e.videoTrackPublications.values())t.isSubscribed&&vj(t)&&t.emitTrackUpdate()}getRemoteParticipantBySid(e){const t=this.sidToIdentity.get(e);if(t)return this.remoteParticipants.get(t)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=yi.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Rs.STATE_MISMATCH))):e=0},FV)}clearConnectionReconcile(){this.connectionReconcileInterval&&yi.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(We.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,r]=e;this.emit(t,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];if(this.state===Mn.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,r]);else if(this.state===Mn.Connected)return this.emit(e,...r);return!1}simulateParticipants(e){return he(this,void 0,void 0,function*(){var t,r,i,o;const c=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new eg({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:vr.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new kl({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(We.SignalConnected),this.emit(We.Connected),this.setAndEmitConnectionState(Mn.Connected),c.video){const l=new Mp(je.Kind.Video,new gu({source:Gr.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:ks.AUDIO,name:"video-dummy"}),new Pp(c.useRealTracks&&(!((t=window.navigator.mediaDevices)===null||t===void 0)&&t.getUserMedia)?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:eA(160*((r=s.aspectRatios[0])!==null&&r!==void 0?r:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(l),this.localParticipant.emit($e.LocalTrackPublished,l)}if(c.audio){const l=new Mp(je.Kind.Audio,new gu({source:Gr.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:ks.AUDIO}),new Dp(c.useRealTracks&&(!((i=navigator.mediaDevices)===null||i===void 0)&&i.getUserMedia)?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Av(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(l),this.localParticipant.emit($e.LocalTrackPublished,l)}for(let l=0;l<s.count-1;l+=1){let d=new kl({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(l),state:bu.ACTIVE,tracks:[],joinedAt:vr.parse(Date.now())});const h=this.getOrCreateParticipant(d.identity,d);if(s.video){const p=eA(160*((o=s.aspectRatios[l%s.aspectRatios.length])!==null&&o!==void 0?o:1),160,!1,!0),g=new gu({source:Gr.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:ks.AUDIO});h.addSubscribedMediaTrack(p,g.sid,new MediaStream([p]),new RTCRtpReceiver),d.tracks=[...d.tracks,g]}if(s.audio){const p=Av(),g=new gu({source:Gr.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:ks.AUDIO});h.addSubscribedMediaTrack(p,g.sid,new MediaStream([p]),new RTCRtpReceiver),d.tracks=[...d.tracks,g]}h.updateInfo(d)}})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];if(e!==We.ActiveSpeakersChanged&&e!==We.TranscriptionReceived){const o=P2(r).filter(c=>c!==void 0);(e===We.TrackSubscribed||e===We.TrackUnsubscribed)&&this.log.trace("subscribe trace: ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:o})),this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:o}))}return super.emit(e,...r)}}ja.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(n=>{n()});function P2(n){return n.map(e=>{if(e)return Array.isArray(e)?P2(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var As;(function(n){n[n.IDLE=0]="IDLE",n[n.RUNNING=1]="RUNNING",n[n.SKIPPED=2]="SKIPPED",n[n.SUCCESS=3]="SUCCESS",n[n.FAILED=4]="FAILED"})(As||(As={}));class Vc extends ca.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=As.IDLE,this.logs=[],this.options={},this.url=e,this.token=t,this.name=this.constructor.name,this.room=new ja(r.roomOptions),this.connectOptions=r.connectOptions,this.options=r}run(e){return he(this,void 0,void 0,function*(){if(this.status!==As.IDLE)throw Error("check is running already");this.setStatus(As.RUNNING);try{yield this.perform()}catch(t){t instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(t.message):this.appendError(t.message))}return yield this.disconnect(),yield new Promise(t=>setTimeout(t,500)),this.status!==As.SKIPPED&&this.setStatus(this.isSuccess()?As.SUCCESS:As.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return he(this,void 0,void 0,function*(){return this.room.state===Mn.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return he(this,void 0,void 0,function*(){this.room&&this.room.state!==Mn.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(As.SKIPPED)}switchProtocol(e){return he(this,void 0,void 0,function*(){let t=!1,r=!1;if(this.room.on(We.Reconnecting,()=>{t=!0}),this.room.once(We.Reconnected,()=>{r=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(o=>setTimeout(o,1e3)),!t)return;const i=Date.now()+1e4;for(;Date.now()<i;){if(r)return;yield Ci(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class BV extends Vc{get description(){return"Cloud regions"}perform(){return he(this,void 0,void 0,function*(){const e=new Nn(this.url,this.token);if(!e.isCloud()){this.skip();return}const t=[],r=new Set;for(let o=0;o<3;o++){const c=yield e.getNextBestRegionUrl();if(!c)break;if(r.has(c))continue;r.add(c);const s=yield this.checkCloudRegion(c);this.appendMessage("".concat(s.region," RTT: ").concat(s.rtt,"ms, duration: ").concat(s.duration,"ms")),t.push(s)}t.sort((o,c)=>(o.duration-c.duration)*.5+(o.rtt-c.rtt)*.5);const i=t[0];this.bestStats=i,this.appendMessage("best Cloud region: ".concat(i.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return he(this,void 0,void 0,function*(){var t,r;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const i=(t=this.room.serverInfo)===null||t===void 0?void 0:t.region;if(!i)throw new Error("Region not found");const o=yield this.room.localParticipant.streamText({topic:"test"}),c=1e3,l=1e6/c,d="A".repeat(c),h=Date.now();for(let C=0;C<l;C++)yield o.write(d);yield o.close();const p=Date.now(),g=yield(r=this.room.engine.pcManager)===null||r===void 0?void 0:r.publisher.getStats(),y={region:i,rtt:1e4,duration:p-h};return g==null||g.forEach(C=>{C.type==="candidate-pair"&&C.nominated&&(y.rtt=C.currentRoundTripTime*1e3)}),yield this.disconnect(),y})}}const Nv=1e4;class LV extends Vc{get description(){return"Connection via UDP vs TCP"}perform(){return he(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),t=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-t.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-t.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=t):this.appendMessage("best connection quality via udp");const r=this.bestStats;this.appendMessage("upstream bitrate: ".concat((r.bitrateTotal/r.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((r.rttTotal/r.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((r.jitterTotal/r.count*1e3).toFixed(2)," ms")),r.packetsLost>0&&this.appendWarning("packets lost: ".concat((r.packetsLost/r.packetsSent*100).toFixed(2),"%")),r.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((r.qualityLimitationDurations.bandwidth/(Nv/1e3)*100).toFixed(2),"%")),r.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((r.qualityLimitationDurations.cpu/(Nv/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return he(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const t=document.createElement("canvas");t.width=1280,t.height=720;const r=t.getContext("2d");if(!r)throw new Error("Could not get canvas context");let i=0;const o=()=>{i=(i+1)%360,r.fillStyle="hsl(".concat(i,", 100%, 50%)"),r.fillRect(0,0,t.width,t.height),requestAnimationFrame(o)};o();const s=t.captureStream(30).getVideoTracks()[0],d=(yield this.room.localParticipant.publishTrack(s,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,h={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},p=setInterval(()=>he(this,void 0,void 0,function*(){const g=yield d.getRTCStatsReport();g==null||g.forEach(y=>{y.type==="outbound-rtp"?(h.packetsSent=y.packetsSent,h.qualityLimitationDurations=y.qualityLimitationDurations,h.bitrateTotal+=y.targetBitrate,h.count++):y.type==="remote-inbound-rtp"&&(h.packetsLost=y.packetsLost,h.rttTotal+=y.roundTripTime,h.jitterTotal+=y.jitter)})}),1e3);return yield new Promise(g=>setTimeout(g,Nv)),clearInterval(p),s.stop(),t.remove(),yield this.disconnect(),h})}}class UV extends Vc{get description(){return"Can publish audio"}perform(){return he(this,void 0,void 0,function*(){var e;const t=yield this.connect(),r=yield PV();if(yield h2(r,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),t.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const o=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let c=0;if(o.forEach(s=>{s.type==="outbound-rtp"&&(s.kind==="audio"||!s.kind&&s.mediaType==="audio")&&(c=s.packetsSent)}),c===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(c," audio packets"))})}}class jV extends Vc{get description(){return"Can publish video"}perform(){return he(this,void 0,void 0,function*(){var e;const t=yield this.connect(),r=yield DV();yield this.checkForVideo(r.mediaStreamTrack),t.localParticipant.publishTrack(r),yield new Promise(c=>setTimeout(c,5e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let o=0;if(i.forEach(c=>{c.type==="outbound-rtp"&&(c.kind==="video"||!c.kind&&c.mediaType==="video")&&(o+=c.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," video packets"))})}checkForVideo(e){return he(this,void 0,void 0,function*(){const t=new MediaStream;t.addTrack(e.clone());const r=document.createElement("video");r.srcObject=t,r.muted=!0,r.autoplay=!0,r.playsInline=!0,r.setAttribute("playsinline","true"),document.body.appendChild(r),yield new Promise(i=>{r.onplay=()=>{setTimeout(()=>{var o,c,s,l;const d=document.createElement("canvas"),h=e.getSettings(),p=(c=(o=h.width)!==null&&o!==void 0?o:r.videoWidth)!==null&&c!==void 0?c:1280,g=(l=(s=h.height)!==null&&s!==void 0?s:r.videoHeight)!==null&&l!==void 0?l:720;d.width=p,d.height=g;const y=d.getContext("2d");y.drawImage(r,0,0);const x=y.getImageData(0,0,d.width,d.height).data;let w=!0;for(let S=0;S<x.length;S+=4)if(x[S]!==0||x[S+1]!==0||x[S+2]!==0){w=!1;break}w?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),i()},1e3)},r.play()}),t.getTracks().forEach(i=>i.stop()),r.remove()})}}class VV extends Vc{get description(){return"Resuming connection after interruption"}perform(){return he(this,void 0,void 0,function*(){var e;const t=yield this.connect();let r=!1,i=!1,o;const c=new Promise(d=>{setTimeout(d,5e3),o=d}),s=()=>{r=!0};t.on(We.SignalReconnecting,s).on(We.Reconnecting,s).on(We.Reconnected,()=>{i=!0,o(!0)}),(e=t.engine.client.ws)===null||e===void 0||e.close();const l=t.engine.client.onClose;if(l&&l(""),yield c,r){if(!i||t.state!==Mn.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class GV extends Vc{get description(){return"Can connect via TURN"}perform(){return he(this,void 0,void 0,function*(){var e,t,r;Uu(new URL(this.url))&&(this.appendMessage("Using region specific url"),this.url=(e=yield new Nn(this.url,this.token).getNextBestRegionUrl())!==null&&e!==void 0?e:this.url);const i=new m1,o=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0);let c=!1,s=!1,l=!1;for(let d of o.iceServers)for(let h of d.urls)h.startsWith("turn:")?(s=!0,l=!0):h.startsWith("turns:")&&(s=!0,l=!0,c=!0),h.startsWith("stun:")&&(l=!0);l?s&&!c&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield i.close(),!((r=(t=this.connectOptions)===null||t===void 0?void 0:t.rtcConfig)===null||r===void 0)&&r.iceServers||s?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(d=>setTimeout(d,0)))})}}class WV extends Vc{get description(){return"Establishing WebRTC connection"}perform(){return he(this,void 0,void 0,function*(){let e=!1,t=!1;this.room.on(We.SignalConnected,()=>{var r;const i=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(o,c)=>{if(o.candidate){const s=new RTCIceCandidate(o);let l="".concat(s.protocol," ").concat(s.address,":").concat(s.port," ").concat(s.type);s.address&&(zV(s.address)?l+=" (private)":s.protocol==="tcp"&&s.tcpType==="passive"?(e=!0,l+=" (passive)"):s.protocol==="udp"&&(t=!0)),this.appendMessage(l)}i&&i(o,c)},!((r=this.room.engine.pcManager)===null||r===void 0)&&r.subscriber&&(this.room.engine.pcManager.subscriber.onIceCandidateError=o=>{o instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(o.errorCode," ").concat(o.errorText," ").concat(o.url))})});try{yield this.connect(),gn.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),t||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function zV(n){const e=n.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const t=parseInt(e[1],10);if(t>=16&&t<=31)return!0}}return!1}class HV extends Vc{get description(){return"Connecting to signal connection via WebSocket"}perform(){return he(this,void 0,void 0,function*(){var e,t,r;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new m1,o;try{o=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0)}catch(c){if(Uu(new URL(this.url))){this.appendMessage("Initial connection failed with error ".concat(c.message,". Retrying with region fallback"));const l=yield new Nn(this.url,this.token).getNextBestRegionUrl();l&&(o=yield i.join(l,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0),this.appendMessage("Fallback to region worked. To avoid initial connections failing, ensure you're calling room.prepareConnection() ahead of time"))}}o?(this.appendMessage("Connected to server, version ".concat(o.serverVersion,".")),((e=o.serverInfo)===null||e===void 0?void 0:e.edition)===v_.Cloud&&(!((t=o.serverInfo)===null||t===void 0)&&t.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=o.serverInfo)===null||r===void 0?void 0:r.region))):this.appendError("Websocket connection could not be established"),yield i.close()})}}class R$ extends ca.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=t,this.options=r}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:As.IDLE,name:"",description:""}),e}updateCheck(e,t){this.checkResults.set(e,t),this.emit("checkUpdate",e,t)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==As.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return he(this,void 0,void 0,function*(){const t=this.getNextCheckId(),r=new e(this.url,this.token,this.options),i=c=>{this.updateCheck(t,c)};r.on("update",i);const o=yield r.run();return r.off("update",i),o})}checkWebsocket(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(HV)})}checkWebRTC(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(WV)})}checkTURN(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(GV)})}checkReconnect(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(VV)})}checkPublishAudio(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(UV)})}checkPublishVideo(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(jV)})}checkConnectionProtocol(){return he(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(LV);if(e.data&&"protocol"in e.data){const t=e.data;this.options.protocol=t.protocol}return e})}checkCloudRegion(){return he(this,void 0,void 0,function*(){return this.createAndRunCheck(BV)})}}function En(n,e,t){return(e=XV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ZV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function XV(n){var e=ZV(n,"string");return typeof e=="symbol"?e:e+""}new TextEncoder;new TextDecoder;class Qi extends Error{constructor(e,t){var r;super(e,t),En(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,(r=Error.captureStackTrace)===null||r===void 0||r.call(Error,this,this.constructor)}}En(Qi,"code","ERR_JOSE_GENERIC");class $V extends Qi{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:r,reason:i,payload:t}}),En(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),En(this,"claim",void 0),En(this,"reason",void 0),En(this,"payload",void 0),this.claim=r,this.reason=i,this.payload=t}}En($V,"code","ERR_JWT_CLAIM_VALIDATION_FAILED");class KV extends Qi{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:r,reason:i,payload:t}}),En(this,"code","ERR_JWT_EXPIRED"),En(this,"claim",void 0),En(this,"reason",void 0),En(this,"payload",void 0),this.claim=r,this.reason=i,this.payload=t}}En(KV,"code","ERR_JWT_EXPIRED");class qV extends Qi{constructor(){super(...arguments),En(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}}En(qV,"code","ERR_JOSE_ALG_NOT_ALLOWED");class YV extends Qi{constructor(){super(...arguments),En(this,"code","ERR_JOSE_NOT_SUPPORTED")}}En(YV,"code","ERR_JOSE_NOT_SUPPORTED");class QV extends Qi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"decryption operation failed",t=arguments.length>1?arguments[1]:void 0;super(e,t),En(this,"code","ERR_JWE_DECRYPTION_FAILED")}}En(QV,"code","ERR_JWE_DECRYPTION_FAILED");class JV extends Qi{constructor(){super(...arguments),En(this,"code","ERR_JWE_INVALID")}}En(JV,"code","ERR_JWE_INVALID");class eG extends Qi{constructor(){super(...arguments),En(this,"code","ERR_JWS_INVALID")}}En(eG,"code","ERR_JWS_INVALID");class tG extends Qi{constructor(){super(...arguments),En(this,"code","ERR_JWT_INVALID")}}En(tG,"code","ERR_JWT_INVALID");class nG extends Qi{constructor(){super(...arguments),En(this,"code","ERR_JWK_INVALID")}}En(nG,"code","ERR_JWK_INVALID");class rG extends Qi{constructor(){super(...arguments),En(this,"code","ERR_JWKS_INVALID")}}En(rG,"code","ERR_JWKS_INVALID");class iG extends Qi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"no applicable key found in the JSON Web Key Set",t=arguments.length>1?arguments[1]:void 0;super(e,t),En(this,"code","ERR_JWKS_NO_MATCHING_KEY")}}En(iG,"code","ERR_JWKS_NO_MATCHING_KEY");class oG extends Qi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"multiple matching keys found in the JSON Web Key Set",t=arguments.length>1?arguments[1]:void 0;super(e,t),En(this,Symbol.asyncIterator,void 0),En(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}}En(oG,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");class sG extends Qi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"request timed out",t=arguments.length>1?arguments[1]:void 0;super(e,t),En(this,"code","ERR_JWKS_TIMEOUT")}}En(sG,"code","ERR_JWKS_TIMEOUT");class aG extends Qi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"signature verification failed",t=arguments.length>1?arguments[1]:void 0;super(e,t),En(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}}En(aG,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");function cG(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var t;const r=xl(n)?n.mediaStreamTrack:n,i=r.getSettings();let o={facingMode:(t=e.defaultFacingMode)!==null&&t!==void 0?t:"user",confidence:"low"};if("facingMode"in i){const c=i.facingMode;gn.trace("rawFacingMode",{rawFacingMode:c}),c&&typeof c=="string"&&dG(c)&&(o={facingMode:c,confidence:"high"})}if(["low","medium"].includes(o.confidence)){gn.trace("Try to get facing mode from device label: (".concat(r.label,")"));const c=uG(r.label);c!==void 0&&(o=c)}return o}const SA=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),lG=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function uG(n){var e;const t=n.trim().toLowerCase();if(t!=="")return SA.has(t)?SA.get(t):(e=Array.from(lG.entries()).find(r=>{let[i]=r;return t.includes(i)}))===null||e===void 0?void 0:e[1]}function dG(n){return n===void 0||["user","environment","left","right"].includes(n)}const Op=Math.min,bl=Math.max,Fp=Math.round,Zh=Math.floor,ea=n=>({x:n,y:n}),fG={left:"right",right:"left",bottom:"top",top:"bottom"},hG={start:"end",end:"start"};function AA(n,e,t){return bl(n,Op(e,t))}function cg(n,e){return typeof n=="function"?n(e):n}function _l(n){return n.split("-")[0]}function lg(n){return n.split("-")[1]}function M2(n){return n==="x"?"y":"x"}function N2(n){return n==="y"?"height":"width"}const pG=new Set(["top","bottom"]);function Ac(n){return pG.has(_l(n))?"y":"x"}function O2(n){return M2(Ac(n))}function gG(n,e,t){t===void 0&&(t=!1);const r=lg(n),i=O2(n),o=N2(i);let c=i==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(c=Bp(c)),[c,Bp(c)]}function mG(n){const e=Bp(n);return[Jy(n),e,Jy(e)]}function Jy(n){return n.replace(/start|end/g,e=>hG[e])}const kA=["left","right"],EA=["right","left"],vG=["top","bottom"],yG=["bottom","top"];function CG(n,e,t){switch(n){case"top":case"bottom":return t?e?EA:kA:e?kA:EA;case"left":case"right":return e?vG:yG;default:return[]}}function xG(n,e,t,r){const i=lg(n);let o=CG(_l(n),t==="start",r);return i&&(o=o.map(c=>c+"-"+i),e&&(o=o.concat(o.map(Jy)))),o}function Bp(n){return n.replace(/left|right|bottom|top/g,e=>fG[e])}function bG(n){return{top:0,right:0,bottom:0,left:0,...n}}function IG(n){return typeof n!="number"?bG(n):{top:n,right:n,bottom:n,left:n}}function Lp(n){const{x:e,y:t,width:r,height:i}=n;return{width:r,height:i,top:t,left:e,right:e+r,bottom:t+i,x:e,y:t}}function TA(n,e,t){let{reference:r,floating:i}=n;const o=Ac(e),c=O2(e),s=N2(c),l=_l(e),d=o==="y",h=r.x+r.width/2-i.width/2,p=r.y+r.height/2-i.height/2,g=r[s]/2-i[s]/2;let y;switch(l){case"top":y={x:h,y:r.y-i.height};break;case"bottom":y={x:h,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:p};break;case"left":y={x:r.x-i.width,y:p};break;default:y={x:r.x,y:r.y}}switch(lg(e)){case"start":y[c]-=g*(t&&d?-1:1);break;case"end":y[c]+=g*(t&&d?-1:1);break}return y}const wG=async(n,e,t)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:c}=t,s=o.filter(Boolean),l=await(c.isRTL==null?void 0:c.isRTL(e));let d=await c.getElementRects({reference:n,floating:e,strategy:i}),{x:h,y:p}=TA(d,r,l),g=r,y={},C=0;for(let x=0;x<s.length;x++){const{name:w,fn:S}=s[x],{x:E,y:R,data:k,reset:A}=await S({x:h,y:p,initialPlacement:r,placement:g,strategy:i,middlewareData:y,rects:d,platform:c,elements:{reference:n,floating:e}});h=E??h,p=R??p,y={...y,[w]:{...y[w],...k}},A&&C<=50&&(C++,typeof A=="object"&&(A.placement&&(g=A.placement),A.rects&&(d=A.rects===!0?await c.getElementRects({reference:n,floating:e,strategy:i}):A.rects),{x:h,y:p}=TA(d,g,l)),x=-1)}return{x:h,y:p,placement:g,strategy:i,middlewareData:y}};async function F2(n,e){var t;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:c,elements:s,strategy:l}=n,{boundary:d="clippingAncestors",rootBoundary:h="viewport",elementContext:p="floating",altBoundary:g=!1,padding:y=0}=cg(e,n),C=IG(y),x=s[g?p==="floating"?"reference":"floating":p],w=Lp(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(x)))==null||t?x:x.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:d,rootBoundary:h,strategy:l})),S=p==="floating"?{x:r,y:i,width:c.floating.width,height:c.floating.height}:c.reference,E=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),R=await(o.isElement==null?void 0:o.isElement(E))?await(o.getScale==null?void 0:o.getScale(E))||{x:1,y:1}:{x:1,y:1},k=Lp(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:S,offsetParent:E,strategy:l}):S);return{top:(w.top-k.top+C.top)/R.y,bottom:(k.bottom-w.bottom+C.bottom)/R.y,left:(w.left-k.left+C.left)/R.x,right:(k.right-w.right+C.right)/R.x}}const SG=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:i,middlewareData:o,rects:c,initialPlacement:s,platform:l,elements:d}=e,{mainAxis:h=!0,crossAxis:p=!0,fallbackPlacements:g,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:C="none",flipAlignment:x=!0,...w}=cg(n,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const S=_l(i),E=Ac(s),R=_l(s)===s,k=await(l.isRTL==null?void 0:l.isRTL(d.floating)),A=g||(R||!x?[Bp(s)]:mG(s)),_=C!=="none";!g&&_&&A.push(...xG(s,x,C,k));const D=[s,...A],j=await F2(e,w),Z=[];let F=((r=o.flip)==null?void 0:r.overflows)||[];if(h&&Z.push(j[S]),p){const pe=gG(i,c,k);Z.push(j[pe[0]],j[pe[1]])}if(F=[...F,{placement:i,overflows:Z}],!Z.every(pe=>pe<=0)){var V,X;const pe=(((V=o.flip)==null?void 0:V.index)||0)+1,ve=D[pe];if(ve&&(!(p==="alignment"&&E!==Ac(ve))||F.every(Re=>Ac(Re.placement)===E?Re.overflows[0]>0:!0)))return{data:{index:pe,overflows:F},reset:{placement:ve}};let Ie=(X=F.filter(Re=>Re.overflows[0]<=0).sort((Re,xe)=>Re.overflows[1]-xe.overflows[1])[0])==null?void 0:X.placement;if(!Ie)switch(y){case"bestFit":{var te;const Re=(te=F.filter(xe=>{if(_){const Ae=Ac(xe.placement);return Ae===E||Ae==="y"}return!0}).map(xe=>[xe.placement,xe.overflows.filter(Ae=>Ae>0).reduce((Ae,ke)=>Ae+ke,0)]).sort((xe,Ae)=>xe[1]-Ae[1])[0])==null?void 0:te[0];Re&&(Ie=Re);break}case"initialPlacement":Ie=s;break}if(i!==Ie)return{reset:{placement:Ie}}}return{}}}},AG=new Set(["left","top"]);async function kG(n,e){const{placement:t,platform:r,elements:i}=n,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),c=_l(t),s=lg(t),l=Ac(t)==="y",d=AG.has(c)?-1:1,h=o&&l?-1:1,p=cg(e,n);let{mainAxis:g,crossAxis:y,alignmentAxis:C}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return s&&typeof C=="number"&&(y=s==="end"?C*-1:C),l?{x:y*h,y:g*d}:{x:g*d,y:y*h}}const EG=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:i,y:o,placement:c,middlewareData:s}=e,l=await kG(e,n);return c===((t=s.offset)==null?void 0:t.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:c}}}}},TG=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:c=!1,limiter:s={fn:w=>{let{x:S,y:E}=w;return{x:S,y:E}}},...l}=cg(n,e),d={x:t,y:r},h=await F2(e,l),p=Ac(_l(i)),g=M2(p);let y=d[g],C=d[p];if(o){const w=g==="y"?"top":"left",S=g==="y"?"bottom":"right",E=y+h[w],R=y-h[S];y=AA(E,y,R)}if(c){const w=p==="y"?"top":"left",S=p==="y"?"bottom":"right",E=C+h[w],R=C-h[S];C=AA(E,C,R)}const x=s.fn({...e,[g]:y,[p]:C});return{...x,data:{x:x.x-t,y:x.y-r,enabled:{[g]:o,[p]:c}}}}}};function ug(){return typeof window<"u"}function Ku(n){return B2(n)?(n.nodeName||"").toLowerCase():"#document"}function Oo(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function ua(n){var e;return(e=(B2(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function B2(n){return ug()?n instanceof Node||n instanceof Oo(n).Node:!1}function Ns(n){return ug()?n instanceof Element||n instanceof Oo(n).Element:!1}function ra(n){return ug()?n instanceof HTMLElement||n instanceof Oo(n).HTMLElement:!1}function _A(n){return!ug()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Oo(n).ShadowRoot}const _G=new Set(["inline","contents"]);function Lf(n){const{overflow:e,overflowX:t,overflowY:r,display:i}=Os(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!_G.has(i)}const RG=new Set(["table","td","th"]);function DG(n){return RG.has(Ku(n))}const PG=[":popover-open",":modal"];function dg(n){return PG.some(e=>{try{return n.matches(e)}catch{return!1}})}const MG=["transform","translate","scale","rotate","perspective"],NG=["transform","translate","scale","rotate","perspective","filter"],OG=["paint","layout","strict","content"];function S1(n){const e=A1(),t=Ns(n)?Os(n):n;return MG.some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||NG.some(r=>(t.willChange||"").includes(r))||OG.some(r=>(t.contain||"").includes(r))}function FG(n){let e=Mc(n);for(;ra(e)&&!ju(e);){if(S1(e))return e;if(dg(e))return null;e=Mc(e)}return null}function A1(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const BG=new Set(["html","body","#document"]);function ju(n){return BG.has(Ku(n))}function Os(n){return Oo(n).getComputedStyle(n)}function fg(n){return Ns(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function Mc(n){if(Ku(n)==="html")return n;const e=n.assignedSlot||n.parentNode||_A(n)&&n.host||ua(n);return _A(e)?e.host:e}function L2(n){const e=Mc(n);return ju(e)?n.ownerDocument?n.ownerDocument.body:n.body:ra(e)&&Lf(e)?e:L2(e)}function bf(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=L2(n),o=i===((r=n.ownerDocument)==null?void 0:r.body),c=Oo(i);if(o){const s=eC(c);return e.concat(c,c.visualViewport||[],Lf(i)?i:[],s&&t?bf(s):[])}return e.concat(i,bf(i,[],t))}function eC(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function U2(n){const e=Os(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=ra(n),o=i?n.offsetWidth:t,c=i?n.offsetHeight:r,s=Fp(t)!==o||Fp(r)!==c;return s&&(t=o,r=c),{width:t,height:r,$:s}}function k1(n){return Ns(n)?n:n.contextElement}function Tu(n){const e=k1(n);if(!ra(e))return ea(1);const t=e.getBoundingClientRect(),{width:r,height:i,$:o}=U2(e);let c=(o?Fp(t.width):t.width)/r,s=(o?Fp(t.height):t.height)/i;return(!c||!Number.isFinite(c))&&(c=1),(!s||!Number.isFinite(s))&&(s=1),{x:c,y:s}}const LG=ea(0);function j2(n){const e=Oo(n);return!A1()||!e.visualViewport?LG:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function UG(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Oo(n)?!1:e}function Rl(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=n.getBoundingClientRect(),o=k1(n);let c=ea(1);e&&(r?Ns(r)&&(c=Tu(r)):c=Tu(n));const s=UG(o,t,r)?j2(o):ea(0);let l=(i.left+s.x)/c.x,d=(i.top+s.y)/c.y,h=i.width/c.x,p=i.height/c.y;if(o){const g=Oo(o),y=r&&Ns(r)?Oo(r):r;let C=g,x=eC(C);for(;x&&r&&y!==C;){const w=Tu(x),S=x.getBoundingClientRect(),E=Os(x),R=S.left+(x.clientLeft+parseFloat(E.paddingLeft))*w.x,k=S.top+(x.clientTop+parseFloat(E.paddingTop))*w.y;l*=w.x,d*=w.y,h*=w.x,p*=w.y,l+=R,d+=k,C=Oo(x),x=eC(C)}}return Lp({width:h,height:p,x:l,y:d})}function hg(n,e){const t=fg(n).scrollLeft;return e?e.left+t:Rl(ua(n)).left+t}function V2(n,e){const t=n.getBoundingClientRect(),r=t.left+e.scrollLeft-hg(n,t),i=t.top+e.scrollTop;return{x:r,y:i}}function jG(n){let{elements:e,rect:t,offsetParent:r,strategy:i}=n;const o=i==="fixed",c=ua(r),s=e?dg(e.floating):!1;if(r===c||s&&o)return t;let l={scrollLeft:0,scrollTop:0},d=ea(1);const h=ea(0),p=ra(r);if((p||!p&&!o)&&((Ku(r)!=="body"||Lf(c))&&(l=fg(r)),ra(r))){const y=Rl(r);d=Tu(r),h.x=y.x+r.clientLeft,h.y=y.y+r.clientTop}const g=c&&!p&&!o?V2(c,l):ea(0);return{width:t.width*d.x,height:t.height*d.y,x:t.x*d.x-l.scrollLeft*d.x+h.x+g.x,y:t.y*d.y-l.scrollTop*d.y+h.y+g.y}}function VG(n){return Array.from(n.getClientRects())}function GG(n){const e=ua(n),t=fg(n),r=n.ownerDocument.body,i=bl(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=bl(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let c=-t.scrollLeft+hg(n);const s=-t.scrollTop;return Os(r).direction==="rtl"&&(c+=bl(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:c,y:s}}const RA=25;function WG(n,e){const t=Oo(n),r=ua(n),i=t.visualViewport;let o=r.clientWidth,c=r.clientHeight,s=0,l=0;if(i){o=i.width,c=i.height;const h=A1();(!h||h&&e==="fixed")&&(s=i.offsetLeft,l=i.offsetTop)}const d=hg(r);if(d<=0){const h=r.ownerDocument,p=h.body,g=getComputedStyle(p),y=h.compatMode==="CSS1Compat"&&parseFloat(g.marginLeft)+parseFloat(g.marginRight)||0,C=Math.abs(r.clientWidth-p.clientWidth-y);C<=RA&&(o-=C)}else d<=RA&&(o+=d);return{width:o,height:c,x:s,y:l}}const zG=new Set(["absolute","fixed"]);function HG(n,e){const t=Rl(n,!0,e==="fixed"),r=t.top+n.clientTop,i=t.left+n.clientLeft,o=ra(n)?Tu(n):ea(1),c=n.clientWidth*o.x,s=n.clientHeight*o.y,l=i*o.x,d=r*o.y;return{width:c,height:s,x:l,y:d}}function DA(n,e,t){let r;if(e==="viewport")r=WG(n,t);else if(e==="document")r=GG(ua(n));else if(Ns(e))r=HG(e,t);else{const i=j2(n);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return Lp(r)}function G2(n,e){const t=Mc(n);return t===e||!Ns(t)||ju(t)?!1:Os(t).position==="fixed"||G2(t,e)}function ZG(n,e){const t=e.get(n);if(t)return t;let r=bf(n,[],!1).filter(s=>Ns(s)&&Ku(s)!=="body"),i=null;const o=Os(n).position==="fixed";let c=o?Mc(n):n;for(;Ns(c)&&!ju(c);){const s=Os(c),l=S1(c);!l&&s.position==="fixed"&&(i=null),(o?!l&&!i:!l&&s.position==="static"&&i&&zG.has(i.position)||Lf(c)&&!l&&G2(n,c))?r=r.filter(d=>d!==c):i=s,c=Mc(c)}return e.set(n,r),r}function XG(n){let{element:e,boundary:t,rootBoundary:r,strategy:i}=n;const o=[...t==="clippingAncestors"?dg(e)?[]:ZG(e,this._c):[].concat(t),r],c=o[0],s=o.reduce((l,d)=>{const h=DA(e,d,i);return l.top=bl(h.top,l.top),l.right=Op(h.right,l.right),l.bottom=Op(h.bottom,l.bottom),l.left=bl(h.left,l.left),l},DA(e,c,i));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function $G(n){const{width:e,height:t}=U2(n);return{width:e,height:t}}function KG(n,e,t){const r=ra(e),i=ua(e),o=t==="fixed",c=Rl(n,!0,o,e);let s={scrollLeft:0,scrollTop:0};const l=ea(0);function d(){l.x=hg(i)}if(r||!r&&!o)if((Ku(e)!=="body"||Lf(i))&&(s=fg(e)),r){const y=Rl(e,!0,o,e);l.x=y.x+e.clientLeft,l.y=y.y+e.clientTop}else i&&d();o&&!r&&i&&d();const h=i&&!r&&!o?V2(i,s):ea(0),p=c.left+s.scrollLeft-l.x-h.x,g=c.top+s.scrollTop-l.y-h.y;return{x:p,y:g,width:c.width,height:c.height}}function Ov(n){return Os(n).position==="static"}function PA(n,e){if(!ra(n)||Os(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return ua(n)===t&&(t=t.ownerDocument.body),t}function W2(n,e){const t=Oo(n);if(dg(n))return t;if(!ra(n)){let i=Mc(n);for(;i&&!ju(i);){if(Ns(i)&&!Ov(i))return i;i=Mc(i)}return t}let r=PA(n,e);for(;r&&DG(r)&&Ov(r);)r=PA(r,e);return r&&ju(r)&&Ov(r)&&!S1(r)?t:r||FG(n)||t}const qG=async function(n){const e=this.getOffsetParent||W2,t=this.getDimensions,r=await t(n.floating);return{reference:KG(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function YG(n){return Os(n).direction==="rtl"}const QG={convertOffsetParentRelativeRectToViewportRelativeRect:jG,getDocumentElement:ua,getClippingRect:XG,getOffsetParent:W2,getElementRects:qG,getClientRects:VG,getDimensions:$G,getScale:Tu,isElement:Ns,isRTL:YG};function z2(n,e){return n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height}function JG(n,e){let t=null,r;const i=ua(n);function o(){var s;clearTimeout(r),(s=t)==null||s.disconnect(),t=null}function c(s,l){s===void 0&&(s=!1),l===void 0&&(l=1),o();const d=n.getBoundingClientRect(),{left:h,top:p,width:g,height:y}=d;if(s||e(),!g||!y)return;const C=Zh(p),x=Zh(i.clientWidth-(h+g)),w=Zh(i.clientHeight-(p+y)),S=Zh(h),E={rootMargin:-C+"px "+-x+"px "+-w+"px "+-S+"px",threshold:bl(0,Op(1,l))||1};let R=!0;function k(A){const _=A[0].intersectionRatio;if(_!==l){if(!R)return c();_?c(!1,_):r=setTimeout(()=>{c(!1,1e-7)},1e3)}_===1&&!z2(d,n.getBoundingClientRect())&&c(),R=!1}try{t=new IntersectionObserver(k,{...E,root:i.ownerDocument})}catch{t=new IntersectionObserver(k,E)}t.observe(n)}return c(!0),o}function eW(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,d=k1(n),h=i||o?[...d?bf(d):[],...bf(e)]:[];h.forEach(S=>{i&&S.addEventListener("scroll",t,{passive:!0}),o&&S.addEventListener("resize",t)});const p=d&&s?JG(d,t):null;let g=-1,y=null;c&&(y=new ResizeObserver(S=>{let[E]=S;E&&E.target===d&&y&&(y.unobserve(e),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var R;(R=y)==null||R.observe(e)})),t()}),d&&!l&&y.observe(d),y.observe(e));let C,x=l?Rl(n):null;l&&w();function w(){const S=Rl(n);x&&!z2(x,S)&&t(),x=S,C=requestAnimationFrame(w)}return t(),()=>{var S;h.forEach(E=>{i&&E.removeEventListener("scroll",t),o&&E.removeEventListener("resize",t)}),p==null||p(),(S=y)==null||S.disconnect(),y=null,l&&cancelAnimationFrame(C)}}const tW=EG,nW=TG,rW=SG,iW=(n,e,t)=>{const r=new Map,i={platform:QG,...t},o={...i.platform,_c:r};return wG(n,e,{...i,platform:o})};var Xh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function oW(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var tC={exports:{}},sW=tC.exports,MA;function aW(){return MA||(MA=1,function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(sW,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},c=null;function s(x,w){var S=x[w];if(typeof S.bind=="function")return S.bind(x);try{return Function.prototype.bind.call(S,x)}catch{return function(){return Function.prototype.apply.apply(S,[x,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function d(x){return x==="debug"&&(x="log"),typeof console===t?!1:x==="trace"&&r?l:console[x]!==void 0?s(console,x):console.log!==void 0?s(console,"log"):e}function h(){for(var x=this.getLevel(),w=0;w<i.length;w++){var S=i[w];this[S]=w<x?e:this.methodFactory(S,x,this.name)}if(this.log=this.debug,typeof console===t&&x<this.levels.SILENT)return"No console available for logging"}function p(x){return function(){typeof console!==t&&(h.call(this),this[x].apply(this,arguments))}}function g(x,w,S){return d(x)||p.apply(this,arguments)}function y(x,w){var S=this,E,R,k,A="loglevel";typeof x=="string"?A+=":"+x:typeof x=="symbol"&&(A=void 0);function _(V){var X=(i[V]||"silent").toUpperCase();if(!(typeof window===t||!A)){try{window.localStorage[A]=X;return}catch{}try{window.document.cookie=encodeURIComponent(A)+"="+X+";"}catch{}}}function D(){var V;if(!(typeof window===t||!A)){try{V=window.localStorage[A]}catch{}if(typeof V===t)try{var X=window.document.cookie,te=encodeURIComponent(A),pe=X.indexOf(te+"=");pe!==-1&&(V=/^([^;]+)/.exec(X.slice(pe+te.length+1))[1])}catch{}return S.levels[V]===void 0&&(V=void 0),V}}function j(){if(!(typeof window===t||!A)){try{window.localStorage.removeItem(A)}catch{}try{window.document.cookie=encodeURIComponent(A)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function Z(V){var X=V;if(typeof X=="string"&&S.levels[X.toUpperCase()]!==void 0&&(X=S.levels[X.toUpperCase()]),typeof X=="number"&&X>=0&&X<=S.levels.SILENT)return X;throw new TypeError("log.setLevel() called with invalid level: "+V)}S.name=x,S.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},S.methodFactory=w||g,S.getLevel=function(){return k??R??E},S.setLevel=function(V,X){return k=Z(V),X!==!1&&_(k),h.call(S)},S.setDefaultLevel=function(V){R=Z(V),D()||S.setLevel(V,!1)},S.resetLevel=function(){k=null,j(),h.call(S)},S.enableAll=function(V){S.setLevel(S.levels.TRACE,V)},S.disableAll=function(V){S.setLevel(S.levels.SILENT,V)},S.rebuild=function(){if(c!==S&&(E=Z(c.getLevel())),h.call(S),c===S)for(var V in o)o[V].rebuild()},E=Z(c?c.getLevel():"WARN");var F=D();F!=null&&(k=Z(F)),h.call(S)}c=new y,c.getLogger=function(x){if(typeof x!="symbol"&&typeof x!="string"||x==="")throw new TypeError("You must supply a name when creating a logger.");var w=o[x];return w||(w=o[x]=new y(x,c.methodFactory)),w};var C=typeof window!==t?window.log:void 0;return c.noConflict=function(){return typeof window!==t&&window.log===c&&(window.log=C),c},c.getLoggers=function(){return o},c.default=c,c})}(tC)),tC.exports}var cW=aW();const lW=oW(cW);var nC=function(n,e){return nC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},nC(n,e)};function Ga(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");nC(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function uW(n,e,t,r){function i(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function s(h){try{d(r.next(h))}catch(p){c(p)}}function l(h){try{d(r.throw(h))}catch(p){c(p)}}function d(h){h.done?o(h.value):i(h.value).then(s,l)}d((r=r.apply(n,[])).next())})}function H2(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=s(0),c.throw=s(1),c.return=s(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(d){return function(h){return l([d,h])}}function l(d){if(r)throw new TypeError("Generator is already executing.");for(;c&&(c=0,d[0]&&(t=0)),t;)try{if(r=1,i&&(o=d[0]&2?i.return:d[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,d[1])).done)return o;switch(i=0,o&&(d=[d[0]&2,o.value]),d[0]){case 0:case 1:o=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,i=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!o||d[1]>o[0]&&d[1]<o[3])){t.label=d[1];break}if(d[0]===6&&t.label<o[1]){t.label=o[1],o=d;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(d);break}o[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(h){d=[6,h],i=0}finally{r=o=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Vu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Up(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,o=[],c;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(s){c={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(c)throw c.error}}return o}function jp(n,e,t){if(arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}function _u(n){return this instanceof _u?(this.v=n,this):new _u(n)}function dW(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",c),i[Symbol.asyncIterator]=function(){return this},i;function c(y){return function(C){return Promise.resolve(C).then(y,p)}}function s(y,C){r[y]&&(i[y]=function(x){return new Promise(function(w,S){o.push([y,x,w,S])>1||l(y,x)})},C&&(i[y]=C(i[y])))}function l(y,C){try{d(r[y](C))}catch(x){g(o[0][3],x)}}function d(y){y.value instanceof _u?Promise.resolve(y.value.v).then(h,p):g(o[0][2],y)}function h(y){l("next",y)}function p(y){l("throw",y)}function g(y,C){y(C),o.shift(),o.length&&l(o[0][0],o[0][1])}}function fW(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Vu=="function"?Vu(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(c){return new Promise(function(s,l){c=n[o](c),i(s,l,c.done,c.value)})}}function i(o,c,s,l){Promise.resolve(l).then(function(d){o({value:d,done:s})},c)}}function Qr(n){return typeof n=="function"}function E1(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Fv=E1(function(n){return function(e){n(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(t,r){return r+1+") "+t.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function Vp(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Uf=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,i,o;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var s=Vu(c),l=s.next();!l.done;l=s.next()){var d=l.value;d.remove(this)}}catch(x){e={error:x}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else c.remove(this);var h=this.initialTeardown;if(Qr(h))try{h()}catch(x){o=x instanceof Fv?x.errors:[x]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var g=Vu(p),y=g.next();!y.done;y=g.next()){var C=y.value;try{NA(C)}catch(x){o=o??[],x instanceof Fv?o=jp(jp([],Up(o)),Up(x.errors)):o.push(x)}}}catch(x){r={error:x}}finally{try{y&&!y.done&&(i=g.return)&&i.call(g)}finally{if(r)throw r.error}}}if(o)throw new Fv(o)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)NA(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Vp(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&Vp(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),Z2=Uf.EMPTY;function X2(n){return n instanceof Uf||n&&"closed"in n&&Qr(n.remove)&&Qr(n.add)&&Qr(n.unsubscribe)}function NA(n){Qr(n)?n():n.unsubscribe()}var hW={Promise:void 0},pW={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,jp([n,e],Up(t)))},clearTimeout:function(n){return clearTimeout(n)},delegate:void 0};function $2(n){pW.setTimeout(function(){throw n})}function rC(){}function ip(n){n()}var T1=function(n){Ga(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,X2(t)&&t.add(r)):r.destination=vW,r}return e.create=function(t,r,i){return new iC(t,r,i)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Uf),gW=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){$h(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){$h(r)}else $h(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){$h(t)}},n}(),iC=function(n){Ga(e,n);function e(t,r,i){var o=n.call(this)||this,c;return Qr(t)||!t?c={next:t??void 0,error:r??void 0,complete:i??void 0}:c=t,o.destination=new gW(c),o}return e}(T1);function $h(n){$2(n)}function mW(n){throw n}var vW={closed:!0,next:rC,error:mW,complete:rC},_1=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function K2(n){return n}function yW(n){return n.length===0?K2:n.length===1?n[0]:function(e){return n.reduce(function(t,r){return r(t)},e)}}var di=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var i=this,o=xW(e)?e:new iC(e,t,r);return ip(function(){var c=i,s=c.operator,l=c.source;o.add(s?s.call(o,l):l?i._subscribe(o):i._trySubscribe(o))}),o},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=OA(t),new t(function(i,o){var c=new iC({next:function(s){try{e(s)}catch(l){o(l),c.unsubscribe()}},error:o,complete:i});r.subscribe(c)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[_1]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return yW(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=OA(e),new e(function(r,i){var o;t.subscribe(function(c){return o=c},function(c){return i(c)},function(){return r(o)})})},n.create=function(e){return new n(e)},n}();function OA(n){var e;return(e=n??hW.Promise)!==null&&e!==void 0?e:Promise}function CW(n){return n&&Qr(n.next)&&Qr(n.error)&&Qr(n.complete)}function xW(n){return n&&n instanceof T1||CW(n)&&X2(n)}function bW(n){return Qr(n==null?void 0:n.lift)}function Gc(n){return function(e){if(bW(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Dl(n,e,t,r,i){return new IW(n,e,t,r,i)}var IW=function(n){Ga(e,n);function e(t,r,i,o,c,s){var l=n.call(this,t)||this;return l.onFinalize=c,l.shouldUnsubscribe=s,l._next=r?function(d){try{r(d)}catch(h){t.error(h)}}:n.prototype._next,l._error=o?function(d){try{o(d)}catch(h){t.error(h)}finally{this.unsubscribe()}}:n.prototype._error,l._complete=i?function(){try{i()}catch(d){t.error(d)}finally{this.unsubscribe()}}:n.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(T1),wW=E1(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Pl=function(n){Ga(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new FA(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new wW},e.prototype.next=function(t){var r=this;ip(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var c=Vu(r.currentObservers),s=c.next();!s.done;s=c.next()){var l=s.value;l.next(t)}}catch(d){i={error:d}}finally{try{s&&!s.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var r=this;ip(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var i=r.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;ip(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,i=this,o=i.hasError,c=i.isStopped,s=i.observers;return o||c?Z2:(this.currentObservers=null,s.push(t),new Uf(function(){r.currentObservers=null,Vp(s,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,i=r.hasError,o=r.thrownError,c=r.isStopped;i?t.error(o):c&&t.complete()},e.prototype.asObservable=function(){var t=new di;return t.source=this,t},e.create=function(t,r){return new FA(t,r)},e}(di),FA=function(n){Ga(e,n);function e(t,r){var i=n.call(this)||this;return i.destination=t,i.source=r,i}return e.prototype.next=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,t)},e.prototype.error=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&i!==void 0?i:Z2},e}(Pl),q2=function(n){Ga(e,n);function e(t){var r=n.call(this)||this;return r._value=t,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=n.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,r=t.hasError,i=t.thrownError,o=t._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(t){n.prototype.next.call(this,this._value=t)},e}(Pl),SW={now:function(){return Date.now()}},AW=function(n){Ga(e,n);function e(t,r){return n.call(this)||this}return e.prototype.schedule=function(t,r){return this},e}(Uf),BA={setInterval:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setInterval.apply(void 0,jp([n,e],Up(t)))},clearInterval:function(n){return clearInterval(n)},delegate:void 0},kW=function(n){Ga(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i.pending=!1,i}return e.prototype.schedule=function(t,r){var i;if(r===void 0&&(r=0),this.closed)return this;this.state=t;var o=this.id,c=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(c,o,r)),this.pending=!0,this.delay=r,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(c,this.id,r),this},e.prototype.requestAsyncId=function(t,r,i){return i===void 0&&(i=0),BA.setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;r!=null&&BA.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var i=!1,o;try{this.work(t)}catch(c){i=!0,o=c||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),o},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,i=t.scheduler,o=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Vp(o,this),r!=null&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,n.prototype.unsubscribe.call(this)}},e}(AW),LA=function(){function n(e,t){t===void 0&&(t=n.now),this.schedulerActionCtor=e,this.now=t}return n.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},n.now=SW.now,n}(),EW=function(n){Ga(e,n);function e(t,r){r===void 0&&(r=LA.now);var i=n.call(this,t,r)||this;return i.actions=[],i._active=!1,i}return e.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var i;this._active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,i){for(;t=r.shift();)t.unsubscribe();throw i}},e}(LA);new EW(kW);function TW(n){return n&&Qr(n.schedule)}function _W(n){return n[n.length-1]}function Y2(n){return TW(_W(n))?n.pop():void 0}var Q2=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function J2(n){return Qr(n==null?void 0:n.then)}function eR(n){return Qr(n[_1])}function tR(n){return Symbol.asyncIterator&&Qr(n==null?void 0:n[Symbol.asyncIterator])}function nR(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function RW(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var rR=RW();function iR(n){return Qr(n==null?void 0:n[rR])}function oR(n){return dW(this,arguments,function(){var e,t,r,i;return H2(this,function(o){switch(o.label){case 0:e=n.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,_u(e.read())];case 3:return t=o.sent(),r=t.value,i=t.done,i?[4,_u(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,_u(r)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function sR(n){return Qr(n==null?void 0:n.getReader)}function qu(n){if(n instanceof di)return n;if(n!=null){if(eR(n))return DW(n);if(Q2(n))return PW(n);if(J2(n))return MW(n);if(tR(n))return aR(n);if(iR(n))return NW(n);if(sR(n))return OW(n)}throw nR(n)}function DW(n){return new di(function(e){var t=n[_1]();if(Qr(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function PW(n){return new di(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function MW(n){return new di(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,$2)})}function NW(n){return new di(function(e){var t,r;try{for(var i=Vu(n),o=i.next();!o.done;o=i.next()){var c=o.value;if(e.next(c),e.closed)return}}catch(s){t={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.complete()})}function aR(n){return new di(function(e){FW(n,e).catch(function(t){return e.error(t)})})}function OW(n){return aR(oR(n))}function FW(n,e){var t,r,i,o;return uW(this,void 0,void 0,function(){var c,s;return H2(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=fW(n),l.label=1;case 1:return[4,t.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(c=r.value,e.next(c),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=l.sent(),i={error:s},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(o=t.return)?[4,o.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Il(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function cR(n,e){return e===void 0&&(e=0),Gc(function(t,r){t.subscribe(Dl(r,function(i){return Il(r,n,function(){return r.next(i)},e)},function(){return Il(r,n,function(){return r.complete()},e)},function(i){return Il(r,n,function(){return r.error(i)},e)}))})}function lR(n,e){return e===void 0&&(e=0),Gc(function(t,r){r.add(n.schedule(function(){return t.subscribe(r)},e))})}function BW(n,e){return qu(n).pipe(lR(e),cR(e))}function LW(n,e){return qu(n).pipe(lR(e),cR(e))}function UW(n,e){return new di(function(t){var r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function jW(n,e){return new di(function(t){var r;return Il(t,e,function(){r=n[rR](),Il(t,e,function(){var i,o,c;try{i=r.next(),o=i.value,c=i.done}catch(s){t.error(s);return}c?t.complete():t.next(o)},0,!0)}),function(){return Qr(r==null?void 0:r.return)&&r.return()}})}function uR(n,e){if(!n)throw new Error("Iterable cannot be null");return new di(function(t){Il(t,e,function(){var r=n[Symbol.asyncIterator]();Il(t,e,function(){r.next().then(function(i){i.done?t.complete():t.next(i.value)})},0,!0)})})}function VW(n,e){return uR(oR(n),e)}function GW(n,e){if(n!=null){if(eR(n))return BW(n,e);if(Q2(n))return UW(n,e);if(J2(n))return LW(n,e);if(tR(n))return uR(n,e);if(iR(n))return jW(n,e);if(sR(n))return VW(n,e)}throw nR(n)}function dR(n,e){return e?GW(n,e):qu(n)}E1(function(n){return function(e){e===void 0&&(e=null),n(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e}});function bi(n,e){return Gc(function(t,r){var i=0;t.subscribe(Dl(r,function(o){r.next(n.call(e,o,i++))}))})}function WW(n,e,t,r,i,o,c,s){var l=[],d=0,h=0,p=!1,g=function(){p&&!l.length&&!d&&e.complete()},y=function(x){return d<r?C(x):l.push(x)},C=function(x){d++;var w=!1;qu(t(x,h++)).subscribe(Dl(e,function(S){e.next(S)},function(){w=!0},void 0,function(){if(w)try{d--;for(var S=function(){var E=l.shift();c||C(E)};l.length&&d<r;)S();g()}catch(E){e.error(E)}}))};return n.subscribe(Dl(e,y,function(){p=!0,g()})),function(){}}function fR(n,e,t){return t===void 0&&(t=1/0),Qr(e)?fR(function(r,i){return bi(function(o,c){return e(r,o,i,c)})(qu(n(r,i)))},t):(typeof e=="number"&&(t=e),Gc(function(r,i){return WW(r,i,n,t)}))}function zW(n){return fR(K2,n)}function HW(){return zW(1)}function oC(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return HW()(dR(n,Y2(n)))}function R1(n,e){return Gc(function(t,r){var i=0;t.subscribe(Dl(r,function(o){return n.call(e,o,i++)&&r.next(o)}))})}function ZW(n,e,t,r,i){return function(o,c){var s=t,l=e,d=0;o.subscribe(Dl(c,function(h){var p=d++;l=s?n(l,h,p):(s=!0,h),c.next(l)},i))}}function UA(n,e){return Gc(ZW(n,e,arguments.length>=2,!0))}function da(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=Y2(n);return Gc(function(r,i){(t?oC(n,r,t):oC(n,r)).subscribe(i)})}function jA(n){return Gc(function(e,t){qu(n).subscribe(Dl(t,function(){return t.complete()},rC)),!t.closed&&e.subscribe(t)})}var XW=Object.defineProperty,$W=Object.defineProperties,KW=Object.getOwnPropertyDescriptors,VA=Object.getOwnPropertySymbols,qW=Object.prototype.hasOwnProperty,YW=Object.prototype.propertyIsEnumerable,GA=(n,e,t)=>e in n?XW(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,bc=(n,e)=>{for(var t in e||(e={}))qW.call(e,t)&&GA(n,t,e[t]);if(VA)for(var t of VA(e))YW.call(e,t)&&GA(n,t,e[t]);return n},jd=(n,e)=>$W(n,KW(e)),Fs=(n,e,t)=>new Promise((r,i)=>{var o=l=>{try{s(t.next(l))}catch(d){i(d)}},c=l=>{try{s(t.throw(l))}catch(d){i(d)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,c);s((t=t.apply(n,e)).next())}),hR="lk";function pg(n){return typeof n>"u"?!1:QW(n)||JW(n)}function QW(n){var e;return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&n.hasOwnProperty("track")&&typeof((e=n.publication)==null?void 0:e.track)<"u":!1}function JW(n){return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&n.hasOwnProperty("publication")&&typeof n.publication<"u":!1}function ez(n){return n?n.hasOwnProperty("participant")&&n.hasOwnProperty("source")&&typeof n.publication>"u":!1}function D1(n){if(typeof n=="string"||typeof n=="number")return`${n}`;if(ez(n))return`${n.participant.identity}_${n.source}_placeholder`;if(pg(n))return`${n.participant.identity}_${n.publication.source}_${n.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${n}`)}function tz(n,e,t){return eW(n,e,()=>Fs(this,null,function*(){const{x:r,y:i}=yield iW(n,e,{placement:"top",middleware:[tW(6),rW(),nW({padding:5})]});t==null||t(r,i)}))}function nz(n,e){return!n.contains(e.target)}var rz=[We.ConnectionStateChanged,We.RoomMetadataChanged,We.ActiveSpeakersChanged,We.ConnectionQualityChanged,We.ParticipantConnected,We.ParticipantDisconnected,We.ParticipantPermissionsChanged,We.ParticipantMetadataChanged,We.ParticipantNameChanged,We.ParticipantAttributesChanged,We.TrackMuted,We.TrackUnmuted,We.TrackPublished,We.TrackUnpublished,We.TrackStreamStateChanged,We.TrackSubscriptionFailed,We.TrackSubscriptionPermissionChanged,We.TrackSubscriptionStatusChanged],iz=[...rz,We.LocalTrackPublished,We.LocalTrackUnpublished];$e.TrackPublished,$e.TrackUnpublished,$e.TrackMuted,$e.TrackUnmuted,$e.TrackStreamStateChanged,$e.TrackSubscribed,$e.TrackUnsubscribed,$e.TrackSubscriptionPermissionChanged,$e.TrackSubscriptionFailed,$e.LocalTrackPublished,$e.LocalTrackUnpublished;var oz=[$e.ConnectionQualityChanged,$e.IsSpeakingChanged,$e.ParticipantMetadataChanged,$e.ParticipantPermissionsChanged,$e.TrackMuted,$e.TrackUnmuted,$e.TrackPublished,$e.TrackUnpublished,$e.TrackStreamStateChanged,$e.TrackSubscriptionFailed,$e.TrackSubscriptionPermissionChanged,$e.TrackSubscriptionStatusChanged];[...oz,$e.LocalTrackPublished,$e.LocalTrackUnpublished];var Rn=lW.getLogger("lk-components-js");Rn.setDefaultLevel("WARN");function sz(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var pR=(n=>(n.AgentState="lk.agent.state",n.PublishOnBehalf="lk.publish_on_behalf",n.TranscriptionFinal="lk.transcription_final",n.TranscriptionSegmentId="lk.segment_id",n.TranscribedTrackId="lk.transcribed_track_id",n))(pR||{}),az=[],cz={showChat:!1,unreadMessages:0,showSettings:!1};function gR(n){return typeof n=="object"}function mR(n){return Array.isArray(n)&&n.filter(gR).length>0}function ns(n){return`${hR}-${n}`}function lz(n){const e=sC(n),t=vR(n.participant).pipe(bi(()=>sC(n)),da(e));return{className:ns(n.source===je.Source.Camera||n.source===je.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:t}}function sC(n){if(pg(n))return n.publication;{const{source:e,name:t,participant:r}=n;if(e&&t)return r.getTrackPublications().find(i=>i.source===e&&i.trackName===t);if(t)return r.getTrackPublicationByName(t);if(e)return r.getTrackPublication(e);throw new Error("At least one of source and name needs to be defined")}}function P1(n,...e){return new di(t=>{const r=()=>{t.next(n)};return e.forEach(i=>{n.on(i,r)}),()=>{e.forEach(i=>{n.off(i,r)})}}).pipe(da(n))}function M1(n,e){return new di(t=>{const r=(...i)=>{t.next(i)};return n.on(e,r),()=>{n.off(e,r)}})}function uz(n){return M1(n,We.ConnectionStateChanged).pipe(bi(([e])=>e),da(n.state))}function dz(n,e,t=!0){const r=new di(o=>{ja.getLocalDevices(n,t).then(c=>{o.next(c),o.complete()}).catch(c=>{e==null||e(c),o.next([]),o.complete()})}),i=new di(o=>{var c;const s=()=>Fs(this,null,function*(){try{const l=yield ja.getLocalDevices(n,t);o.next(l)}catch(l){e==null||e(l)}});if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(c=navigator==null?void 0:navigator.mediaDevices)==null||c.addEventListener("devicechange",s)}return()=>{var l;(l=navigator==null?void 0:navigator.mediaDevices)==null||l.removeEventListener("devicechange",s)}});return oC(r,i)}function fz(n){return M1(n,We.DataReceived)}function hz(n){return P1(n,We.AudioPlaybackStatusChanged).pipe(bi(e=>({canPlayAudio:e.canPlaybackAudio})))}function pz(n){return P1(n,We.VideoPlaybackStatusChanged).pipe(bi(e=>({canPlayVideo:e.canPlaybackVideo})))}function gz(n,e){return M1(n,We.ActiveDeviceChanged).pipe(R1(([t])=>t===e),bi(([t,r])=>(Rn.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:t,deviceId:r}),r)))}function N1(n,...e){return new di(t=>{const r=()=>{t.next(n)};return e.forEach(i=>{n.on(i,r)}),()=>{e.forEach(i=>{n.off(i,r)})}}).pipe(da(n))}function vR(n){return N1(n,$e.TrackMuted,$e.TrackUnmuted,$e.ParticipantPermissionsChanged,$e.TrackPublished,$e.TrackUnpublished,$e.LocalTrackPublished,$e.LocalTrackUnpublished,$e.MediaDevicesError,$e.TrackSubscriptionStatusChanged).pipe(bi(e=>{const{isMicrophoneEnabled:t,isCameraEnabled:r,isScreenShareEnabled:i}=e,o=e.getTrackPublication(je.Source.Microphone),c=e.getTrackPublication(je.Source.Camera);return{isCameraEnabled:r,isMicrophoneEnabled:t,isScreenShareEnabled:i,cameraTrack:c,microphoneTrack:o,participant:e}}))}function mz(n){return n?N1(n,$e.ParticipantMetadataChanged,$e.ParticipantNameChanged).pipe(bi(({name:e,identity:t,metadata:r})=>({name:e,identity:t,metadata:r})),da({name:n.name,identity:n.identity,metadata:n.metadata})):void 0}function vz(n){return O1(n,$e.ConnectionQualityChanged).pipe(bi(([e])=>e),da(n.connectionQuality))}function O1(n,e){return new di(t=>{const r=(...i)=>{t.next(i)};return n.on(e,r),()=>{n.off(e,r)}})}function yR(n){var e,t,r,i;return N1(n.participant,$e.TrackMuted,$e.TrackUnmuted,$e.TrackSubscribed,$e.TrackUnsubscribed,$e.LocalTrackPublished,$e.LocalTrackUnpublished).pipe(bi(o=>{var c,s;const l=(c=n.publication)!=null?c:o.getTrackPublication(n.source);return(s=l==null?void 0:l.isMuted)!=null?s:!0}),da((i=(r=(e=n.publication)==null?void 0:e.isMuted)!=null?r:(t=n.participant.getTrackPublication(n.source))==null?void 0:t.isMuted)!=null?i:!0))}function yz(n){return O1(n,$e.IsSpeakingChanged).pipe(bi(([e])=>e))}function Cz(n){return O1(n,$e.ParticipantPermissionsChanged).pipe(bi(()=>n.permissions),da(n.permissions))}function xz(n,e,t,r,i){const{localParticipant:o}=e,c=(h,p)=>{let g=!1;switch(h){case je.Source.Camera:g=p.isCameraEnabled;break;case je.Source.Microphone:g=p.isMicrophoneEnabled;break;case je.Source.ScreenShare:g=p.isScreenShareEnabled;break}return g},s=vR(o).pipe(bi(h=>c(n,h.participant)),da(c(n,o))),l=new Pl,d=(h,p)=>Fs(this,null,function*(){try{switch(p??(p=t),l.next(!0),n){case je.Source.Camera:return yield o.setCameraEnabled(h??!o.isCameraEnabled,p,r),o.isCameraEnabled;case je.Source.Microphone:return yield o.setMicrophoneEnabled(h??!o.isMicrophoneEnabled,p,r),o.isMicrophoneEnabled;case je.Source.ScreenShare:return yield o.setScreenShareEnabled(h??!o.isScreenShareEnabled,p,r),o.isScreenShareEnabled;default:throw new TypeError("Tried to toggle unsupported source")}}catch(g){if(i&&g instanceof Error){i==null||i(g);return}else throw g}finally{l.next(!1)}});return{className:ns("button"),toggle:d,enabledObserver:s,pendingObserver:l.asObservable()}}function bz(){let n=!1;const e=new Pl,t=new Pl,r=i=>Fs(this,null,function*(){t.next(!0),n=i??!n,e.next(n),t.next(!1)});return{className:ns("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:t.asObservable()}}function Iz(n,e,t){const r=new q2(void 0),i=gz(e,n),o=(c,...s)=>Fs(this,[c,...s],function*(l,d={}){var h,p,g;if(e){const y=Ki();if(n==="audiooutput"&&((y==null?void 0:y.name)==="Safari"||(y==null?void 0:y.os)==="iOS")){Rn.warn("Switching audio output device is not supported on Safari and iOS.");return}Rn.debug(`Switching active device of kind "${n}" with id ${l}.`),yield e.switchActiveDevice(n,l,d.exact);const C=(h=e.getActiveDevice(n))!=null?h:l;C!==l&&l!=="default"&&Rn.info(`We tried to select the device with id (${l}), but the browser decided to select the device with id (${C}) instead.`);let x;n==="audioinput"?x=(p=e.localParticipant.getTrackPublication(je.Source.Microphone))==null?void 0:p.track:n==="videoinput"&&(x=(g=e.localParticipant.getTrackPublication(je.Source.Camera))==null?void 0:g.track);const w=l==="default"&&!x||l==="default"&&(x==null?void 0:x.mediaStreamTrack.label.startsWith("Default"));r.next(w?l:C)}});return{className:ns("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:o}}function wz(n){const e=t=>{n.disconnect(t)};return{className:ns("disconnect-button"),disconnect:e}}function Sz(n){const e=ns("connection-quality"),t=vz(n);return{className:e,connectionQualityObserver:t}}function Az(n){let e="track-muted-indicator-camera";switch(n.source){case je.Source.Camera:e="track-muted-indicator-camera";break;case je.Source.Microphone:e="track-muted-indicator-microphone";break}const t=ns(e),r=yR(n);return{className:t,mediaMutedObserver:r}}function kz(n){return{className:"lk-participant-name",infoObserver:mz(n)}}function Ez(){return{className:ns("participant-tile")}}var Tz={CHAT:"lk.chat"},_z={CHAT:"lk-chat-topic"};function CR(n,e){return Fs(this,arguments,function*(t,r,i={}){const{reliable:o,destinationIdentities:c,topic:s}=i;yield t.publishData(r,{destinationIdentities:c,topic:s,reliable:o})})}function Rz(n,e,t){const r=Array.isArray(e)?e:[e],i=fz(n).pipe(R1(([,,,s])=>e===void 0||s!==void 0&&r.includes(s)),bi(([s,l,,d])=>({payload:s,topic:d,from:l})));let o;const c=new di(s=>{o=s});return{messageObservable:i,isSendingObservable:c,send:(s,...l)=>Fs(this,[s,...l],function*(d,h={}){o.next(!0);try{yield CR(n.localParticipant,d,bc({topic:r[0]},h))}finally{o.next(!1)}})}}var Kh=new WeakMap;function Dz(n){return n.ignoreLegacy==!0}var Pz=n=>JSON.parse(new TextDecoder().decode(n)),Mz=n=>new TextEncoder().encode(JSON.stringify(n));function Nz(n,e){var t,r,i,o,c,s;const l=()=>{var A,_,D;return((A=n.serverInfo)==null?void 0:A.edition)===1||!!((_=n.serverInfo)!=null&&_.version)&&Ms((D=n.serverInfo)==null?void 0:D.version,"1.8.2")>0},d=new Pl,h=(t=e==null?void 0:e.channelTopic)!=null?t:Tz.CHAT,p=(r=e==null?void 0:e.channelTopic)!=null?r:_z.CHAT;let g=!1;Kh.has(n)||(g=!0);const y=(i=Kh.get(n))!=null?i:new Map,C=(o=y.get(h))!=null?o:new Pl;y.set(h,C),Kh.set(n,y);const x=(c=e==null?void 0:e.messageDecoder)!=null?c:Pz;if(g){n.registerTextStreamHandler(h,(_,D)=>Fs(this,null,function*(){const{id:j,timestamp:Z}=_.info;dR(_).pipe(UA((F,V)=>F+V),bi(F=>({id:j,timestamp:Z,message:F,from:n.getParticipantByIdentity(D.identity),type:"chatMessage"}))).subscribe({next:F=>C.next(F)})}));const{messageObservable:A}=Rz(n,[p]);A.pipe(bi(_=>{const D=x(_.payload);return Dz(D)?void 0:jd(bc({},D),{type:"chatMessage",from:_.from})}),R1(_=>!!_),jA(d)).subscribe(C)}const w=C.pipe(UA((A,_)=>{if("id"in _&&A.find(D=>{var j,Z;return((j=D.from)==null?void 0:j.identity)===((Z=_.from)==null?void 0:Z.identity)&&D.id===_.id})){const D=A.findIndex(j=>j.id===_.id);if(D>-1){const j=A[D];A[D]=jd(bc({},_),{timestamp:j.timestamp,editTimestamp:_.timestamp})}return[...A]}return[...A,_]},[]),jA(d)),S=new q2(!1),E=(s=e==null?void 0:e.messageEncoder)!=null?s:Mz,R=(A,_)=>Fs(this,null,function*(){_||(_={}),_.topic!=null||(_.topic=h),S.next(!0);try{const D={id:(yield n.localParticipant.sendText(A,_)).id,timestamp:Date.now(),message:A},j=jd(bc({},D),{attachedFiles:_.attachments}),Z=jd(bc({},j),{type:"chatMessage",from:n.localParticipant,attributes:_.attributes});C.next(Z);const F=E(jd(bc({},D),{ignoreLegacy:l()}));try{yield CR(n.localParticipant,F,{reliable:!0,topic:p})}catch(V){Rn.info("could not send message in legacy chat format",V)}return Z}finally{S.next(!1)}});function k(){d.next(),d.complete(),C.complete(),Kh.delete(n),n.unregisterTextStreamHandler(h)}return n.once(We.Disconnected,k),{messageObservable:w,isSendingObservable:S,send:R}}function Oz(){const n=e=>Fs(this,null,function*(){Rn.info("Start Audio for room: ",e),yield e.startAudio()});return{className:ns("start-audio-button"),roomAudioPlaybackAllowedObservable:hz,handleStartAudioPlayback:n}}function Fz(){const n=e=>Fs(this,null,function*(){Rn.info("Start Video for room: ",e),yield e.startVideo()});return{className:ns("start-audio-button"),roomVideoPlaybackAllowedObservable:pz,handleStartVideoPlayback:n}}function Bz(){return{className:[ns("button"),ns("chat-toggle")].join(" ")}}function Lz(){return{className:"lk-room-container"}}function WA(n,e,t=!0){const r=[n.localParticipant,...Array.from(n.remoteParticipants.values())],i=[];return r.forEach(o=>{e.forEach(c=>{const s=Array.from(o.trackPublications.values()).filter(l=>l.source===c&&(!t||l.track)).map(l=>({participant:o,publication:l,source:l.source}));i.push(...s)})}),{trackReferences:i,participants:r}}function Uz(n,e,t){var r,i;const o=(r=t.additionalRoomEvents)!=null?r:iz,c=(i=t.onlySubscribed)!=null?i:!0,s=Array.from(new Set([We.ParticipantConnected,We.ParticipantDisconnected,We.ConnectionStateChanged,We.LocalTrackPublished,We.LocalTrackUnpublished,We.TrackPublished,We.TrackUnpublished,We.TrackSubscriptionStatusChanged,...o]).values());return P1(n,...s).pipe(bi(l=>{const d=WA(l,e,c);return Rn.debug(`TrackReference[] was updated. (length ${d.trackReferences.length})`,d),d}),da(WA(n,e,c)))}function jz(n,e){if(typeof localStorage>"u"){Rn.error("Local storage is not available.");return}try{if(e){const t=Object.fromEntries(Object.entries(e).filter(([,r])=>r!==""));localStorage.setItem(n,JSON.stringify(t))}}catch(t){Rn.error(`Error setting item to local storage: ${t}`)}}function Vz(n){if(typeof localStorage>"u"){Rn.error("Local storage is not available.");return}try{const e=localStorage.getItem(n);if(!e){Rn.warn(`Item with key ${n} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){Rn.error(`Error getting item from local storage: ${e}`);return}}function Gz(n){return{load:()=>Vz(n),save:e=>jz(n,e)}}var Wz=`${hR}-user-choices`,Vd={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"default",audioDeviceId:"default",username:""},{load:zz,save:Hz}=Gz(Wz);function Zz(n,e=!1){e!==!0&&Hz(n)}function Xz(n,e=!1){var t,r,i,o,c;const s={videoEnabled:(t=n==null?void 0:n.videoEnabled)!=null?t:Vd.videoEnabled,audioEnabled:(r=n==null?void 0:n.audioEnabled)!=null?r:Vd.audioEnabled,videoDeviceId:(i=n==null?void 0:n.videoDeviceId)!=null?i:Vd.videoDeviceId,audioDeviceId:(o=n==null?void 0:n.audioDeviceId)!=null?o:Vd.audioDeviceId,username:(c=n==null?void 0:n.username)!=null?c:Vd.username};if(e)return s;{const l=zz();return bc(bc({},s),l??{})}}function $z(n,e){if(e.msg==="show_chat")return{...n,showChat:!0,unreadMessages:0};if(e.msg==="hide_chat")return{...n,showChat:!1};if(e.msg==="toggle_chat"){const t={...n,showChat:!n.showChat};return t.showChat===!0&&(t.unreadMessages=0),t}else return e.msg==="unread_msg"?{...n,unreadMessages:e.count}:e.msg==="toggle_settings"?{...n,showSettings:!n.showSettings}:{...n}}function Kz(n,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:{...n}}const F1=B.createContext(void 0);function xR(){const n=B.useContext(F1);if(!n)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return n}function qz(n){const[e,t]=B.useReducer(Kz,az),[r,i]=B.useReducer($z,cz);return n??{pin:{dispatch:t,state:e},widget:{dispatch:i,state:r}}}function bR(){return B.useContext(F1)}const B1=B.createContext(void 0);function L1(){return B.useContext(B1)}function gg(n){const e=L1(),t=n??e;if(!t)throw new Error("No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly");return t}const Yz=B.createContext(void 0);function Qz(){return B.useContext(Yz)}function mg(n){const e=Qz(),t=L1(),r=n??e??(t==null?void 0:t.participant);if(!r)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return r}const U1=B.createContext(void 0);function j1(){const n=B.useContext(U1);if(!n)throw Error("tried to access room context outside of livekit room component");return n}function vg(){return B.useContext(U1)}function jf(n){const e=vg(),t=n??e;if(!t)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return t}B.createContext(void 0);const Jz=B.createContext(void 0);var zA={};function IR(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=IR(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function wR(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=IR(n))&&(r&&(r+=" "),r+=e);return r}function eH(...n){return(...e)=>{for(const t of n)if(typeof t=="function")try{t(...e)}catch(r){console.error(r)}}}function Wa(...n){const e={...n[0]};for(let t=1;t<n.length;t++){const r=n[t];for(const i in r){const o=e[i],c=r[i];typeof o=="function"&&typeof c=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=eH(o,c):(i==="className"||i==="UNSAFE_className")&&typeof o=="string"&&typeof c=="string"?e[i]=wR(o,c):e[i]=c!==void 0?c:o}}return e}function tH(n){return n!==void 0}function Ul(...n){return Wa(...n.filter(tH))}function V1(n,e,t){return B.Children.map(n,r=>B.isValidElement(r)&&B.Children.only(n)?(r.props.className&&(e??(e={}),e.className=wR(r.props.className,e.className),e.style={...r.props.style,...e.style}),B.cloneElement(r,{...e,key:t})):r)}function nH(n){var e,t;if(typeof window<"u"&&typeof process<"u"&&(((e=process==null?void 0:zA)==null?void 0:e.NODE_ENV)==="dev"||((t=process==null?void 0:zA)==null?void 0:t.NODE_ENV)==="development")){const r=document.querySelector(".lk-room-container");r&&!getComputedStyle(r).getPropertyValue("--lk-has-imported-styles")&&Rn.warn("It looks like you're not using the `@livekit/components-styles package`. To render the UI with the default styling, please import it in your layout or page.")}}function rH(n,e){return n==="processor"&&e&&typeof e=="object"&&"name"in e?e.name:n==="e2ee"&&e?"e2ee-enabled":e}const iH={connect:!0,audio:!1,video:!1};function oH(n){const{token:e,serverUrl:t,options:r,room:i,connectOptions:o,connect:c,audio:s,video:l,screen:d,onConnected:h,onDisconnected:p,onError:g,onMediaDeviceFailure:y,onEncryptionError:C,simulateParticipants:x,...w}={...iH,...n};r&&i&&Rn.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[S,E]=B.useState(),R=B.useRef(c);B.useEffect(()=>{E(i??new ja(r))},[i,JSON.stringify(r,rH)]);const k=B.useMemo(()=>{const{className:A}=Lz();return Wa(w,{className:A})},[w]);return B.useEffect(()=>{if(!S)return;const A=()=>{const F=S.localParticipant;Rn.debug("trying to publish local tracks"),Promise.all([F.setMicrophoneEnabled(!!s,typeof s!="boolean"?s:void 0),F.setCameraEnabled(!!l,typeof l!="boolean"?l:void 0),F.setScreenShareEnabled(!!d,typeof d!="boolean"?d:void 0)]).catch(V=>{Rn.warn(V),g==null||g(V)})},_=(F,V)=>{const X=vf.getFailure(F);y==null||y(X,V)},D=F=>{C==null||C(F)},j=F=>{p==null||p(F)},Z=()=>{h==null||h()};return S.on(We.SignalConnected,A).on(We.MediaDevicesError,_).on(We.EncryptionError,D).on(We.Disconnected,j).on(We.Connected,Z),()=>{S.off(We.SignalConnected,A).off(We.MediaDevicesError,_).off(We.EncryptionError,D).off(We.Disconnected,j).off(We.Connected,Z)}},[S,s,l,d,g,C,y,h,p]),B.useEffect(()=>{if(S){if(x){S.simulateParticipants({participants:{count:x},publish:{audio:!0,useRealTracks:!0}});return}if(c){if(R.current=!0,Rn.debug("connecting"),!e){Rn.debug("no token yet");return}if(!t){Rn.warn("no livekit url provided"),g==null||g(Error("no livekit url provided"));return}S.connect(t,e,o).catch(A=>{Rn.warn(A),R.current===!0&&(g==null||g(A))})}else Rn.debug("disconnecting because connect is false"),R.current=!1,S.disconnect()}},[c,e,JSON.stringify(o),S,g,t,x]),B.useEffect(()=>{if(S)return()=>{Rn.info("disconnecting on onmount"),S.disconnect()}},[S]),{room:S,htmlProps:k}}const sH=B.forwardRef(function(n,e){const{room:t,htmlProps:r}=oH(n);return B.createElement("div",{ref:e,...r},t&&B.createElement(U1.Provider,{value:t},B.createElement(Jz.Provider,{value:n.featureFlags},n.children)))});function Fo(n,e,t=!0){const[r,i]=B.useState(e);return B.useEffect(()=>{if(t&&i(e),typeof window>"u"||!n)return;const o=n.subscribe(i);return()=>o.unsubscribe()},[n,t]),r}function aH(n){const e=o=>typeof window<"u"?window.matchMedia(o).matches:!1,[t,r]=B.useState(e(n));function i(){r(e(n))}return B.useEffect(()=>{const o=window.matchMedia(n);return i(),o.addListener?o.addListener(i):o.addEventListener("change",i),()=>{o.removeListener?o.removeListener(i):o.removeEventListener("change",i)}},[n]),t}function cH(n={}){const e=mg(n.participant),{className:t,connectionQualityObserver:r}=B.useMemo(()=>Sz(e),[e]),i=Fo(r,e.connectionQuality);return{className:t,quality:i}}function SR(n){const e=jf(n),t=B.useMemo(()=>uz(e),[e]);return Fo(t,e.state)}function lH(n){const e=j1(),t=SR(e);return{buttonProps:B.useMemo(()=>{const{className:r,disconnect:i}=wz(e);return Wa(n,{className:r,onClick:()=>i(n.stopTracks??!0),disabled:t===Mn.Disconnected})},[e,n,t])}}function uH(n){if(n.publication instanceof Mp){const e=n.publication.track;if(e){const{facingMode:t}=cG(e);return t}}return"undefined"}function HA(n,e={}){var t,r;const i=typeof n=="string"?e.participant:n.participant,o=mg(i),c=typeof n=="string"?{participant:o,source:n}:n,[s,l]=B.useState(!!((t=c.publication)!=null&&t.isMuted||(r=o.getTrackPublication(c.source))!=null&&r.isMuted));return B.useEffect(()=>{const d=yR(c).subscribe(l);return()=>d.unsubscribe()},[D1(c)]),s}function dH(n){const e=mg(n),t=B.useMemo(()=>yz(e),[e]);return Fo(t,e.isSpeaking)}function fH(){const n=j1(),e=B.useMemo(()=>Cz(n.localParticipant),[n]);return Fo(e,n.localParticipant.permissions)}function hH({kind:n,room:e,track:t,requestPermissions:r,onError:i}){const o=vg(),c=B.useMemo(()=>e??o??new ja,[e,o]),s=B.useMemo(()=>dz(n,i,r),[n,r,i]),l=Fo(s,[]),[d,h]=B.useState((c==null?void 0:c.getActiveDevice(n))??"default"),{className:p,activeDeviceObservable:g,setActiveMediaDevice:y}=B.useMemo(()=>Iz(n,c),[n,c,t]);return B.useEffect(()=>{const C=g.subscribe(x=>{x&&(Rn.info("setCurrentDeviceId",x),h(x))});return()=>{C==null||C.unsubscribe()}},[g]),{devices:l,className:p,activeDeviceId:d,setActiveMediaDevice:y}}function pH({trackRef:n,onParticipantClick:e,disableSpeakingIndicator:t,htmlProps:r}){const i=gg(n),o=B.useMemo(()=>{const{className:g}=Ez();return Wa(r,{className:g,onClick:y=>{var C;if((C=r.onClick)==null||C.call(r,y),typeof e=="function"){const x=i.publication??i.participant.getTrackPublication(i.source);e({participant:i.participant,track:x})}}})},[r,e,i.publication,i.source,i.participant]),c=i.participant.getTrackPublication(je.Source.Microphone),s=B.useMemo(()=>({participant:i.participant,source:je.Source.Microphone,publication:c}),[c,i.participant]),l=HA(i),d=HA(s),h=dH(i.participant),p=uH(i);return{elementProps:{"data-lk-audio-muted":d,"data-lk-video-muted":l,"data-lk-speaking":t===!0?!1:h,"data-lk-local-participant":i.participant.isLocal,"data-lk-source":i.source,"data-lk-facing-mode":p,...o}}}function gH({room:n,props:e}){const t=jf(n),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:o}=B.useMemo(()=>Oz(),[]),c=B.useMemo(()=>i(t),[t,i]),{canPlayAudio:s}=Fo(c,{canPlayAudio:t.canPlaybackAudio});return{mergedProps:B.useMemo(()=>Wa(e,{className:r,onClick:()=>{o(t)},style:{display:s?"none":"block"}}),[e,r,s,o,t]),canPlayAudio:s}}function mH({room:n,props:e}){const t=jf(n),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:o}=B.useMemo(()=>Fz(),[]),c=B.useMemo(()=>i(t),[t,i]),{canPlayVideo:s}=Fo(c,{canPlayVideo:t.canPlaybackVideo});return{mergedProps:B.useMemo(()=>Wa(e,{className:r,onClick:()=>{o(t)},style:{display:s?"none":"block"}}),[e,r,s,o,t]),canPlayVideo:s}}function vH({props:n}){const{dispatch:e,state:t}=xR().widget,{className:r}=B.useMemo(()=>Bz(),[]);return{mergedProps:B.useMemo(()=>Wa(n,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":t!=null&&t.showChat?"true":"false","data-lk-unread-msgs":t?t.unreadMessages<10?t.unreadMessages.toFixed(0):"9+":"0"}),[n,r,e,t])}}function yH(n){var e,t;const r=gg(n),{className:i,mediaMutedObserver:o}=B.useMemo(()=>Az(r),[D1(r)]);return{isMuted:Fo(o,!!((e=r.publication)!=null&&e.isMuted||(t=r.participant.getTrackPublication(r.source))!=null&&t.isMuted)),className:i}}function CH({source:n,onChange:e,initialState:t,captureOptions:r,publishOptions:i,onDeviceError:o,room:c,...s}){var l;const d=vg(),h=B.useMemo(()=>c??d,[c,d]),p=(l=h==null?void 0:h.localParticipant)==null?void 0:l.getTrackPublication(n),g=B.useRef(!1),{toggle:y,className:C,pendingObserver:x,enabledObserver:w}=B.useMemo(()=>h?xz(n,h,r,i,o):bz(),[h,n,JSON.stringify(r),i]),S=Fo(x,!1),E=Fo(w,t??!!(p!=null&&p.isEnabled));B.useEffect(()=>{e==null||e(E,g.current),g.current=!1},[E,e]),B.useEffect(()=>{t!==void 0&&(Rn.debug("forcing initial toggle state",n,t),y(t))},[]);const R=B.useMemo(()=>Wa(s,{className:C}),[s,C]),k=B.useCallback(A=>{var _;g.current=!0,y().catch(()=>g.current=!1),(_=s.onClick)==null||_.call(s,A)},[s,y]);return{toggle:y,enabled:E,pending:S,track:p,buttonProps:{...R,"aria-pressed":E,"data-lk-source":n,"data-lk-enabled":E,disabled:S,onClick:k}}}function xH(n=[je.Source.Camera,je.Source.Microphone,je.Source.ScreenShare,je.Source.ScreenShareAudio,je.Source.Unknown],e={}){const t=jf(e.room),[r,i]=B.useState([]),[o,c]=B.useState([]),s=B.useMemo(()=>n.map(l=>gR(l)?l.source:l),[JSON.stringify(n)]);return B.useEffect(()=>{const l=Uz(t,s,{additionalRoomEvents:e.updateOnlyOn,onlySubscribed:e.onlySubscribed}).subscribe(({trackReferences:d,participants:h})=>{Rn.debug("setting track bundles",d,h),i(d),c(h)});return()=>l.unsubscribe()},[t,JSON.stringify(e.onlySubscribed),JSON.stringify(e.updateOnlyOn),JSON.stringify(n)]),B.useMemo(()=>{if(mR(n)){const l=IH(n,o),d=Array.from(r);return o.forEach(h=>{l.has(h.identity)&&(l.get(h.identity)??[]).forEach(p=>{if(r.find(({participant:y,publication:C})=>h.identity===y.identity&&C.source===p))return;Rn.debug(`Add ${p} placeholder for participant ${h.identity}.`);const g={participant:h,source:p};d.push(g)})}),d}else return r},[r,o,n])}function bH(n,e){const t=new Set(n);for(const r of e)t.delete(r);return t}function IH(n,e){const t=new Map;if(mR(n)){const r=n.filter(i=>i.withPlaceholder).map(i=>i.source);e.forEach(i=>{const o=i.getTrackPublications().map(s=>{var l;return(l=s.track)==null?void 0:l.source}).filter(s=>s!==void 0),c=Array.from(bH(new Set(r),new Set(o)));c.length>0&&t.set(i.identity,c)})}return t}function wH(n){const e=jf(n==null?void 0:n.room),t=SR(e),r=B.useMemo(()=>t===Mn.Disconnected,[t]),i=B.useMemo(()=>Nz(e,n),[e,n,r]),o=Fo(i.isSendingObservable,!1),c=Fo(i.messageObservable,[]);return{send:i.send,chatMessages:c,isSending:o}}function SH(n={}){const[e,t]=B.useState(Xz(n.defaults,n.preventLoad??!1)),r=B.useCallback(l=>{t(d=>({...d,audioEnabled:l}))},[]),i=B.useCallback(l=>{t(d=>({...d,videoEnabled:l}))},[]),o=B.useCallback(l=>{t(d=>({...d,audioDeviceId:l}))},[]),c=B.useCallback(l=>{t(d=>({...d,videoDeviceId:l}))},[]),s=B.useCallback(l=>{t(d=>({...d,username:l}))},[]);return B.useEffect(()=>{Zz(e,n.preventSave??!1)},[e,n.preventSave]),{userChoices:e,saveAudioInputEnabled:r,saveVideoInputEnabled:i,saveAudioInputDeviceId:o,saveVideoInputDeviceId:c,saveUsername:s}}const AH=n=>{const e=t=>{let r=1-Math.max(-100,Math.min(-10,t))*-1/100;return r=Math.sqrt(r),r};return n.map(t=>t===-1/0?0:e(t))},kH={bands:5,loPass:100,hiPass:600,updateInterval:32,analyserOptions:{fftSize:2048}};function EH(n,e={}){var t;const r=n instanceof je?n:(t=n==null?void 0:n.publication)==null?void 0:t.track,i={...kH,...e},[o,c]=B.useState(new Array(i.bands).fill(0));return B.useEffect(()=>{if(!r||!(r!=null&&r.mediaStream)){c(g=>g.slice().fill(0));return}const{analyser:s,cleanup:l}=fj(r,i.analyserOptions),d=s.frequencyBinCount,h=new Float32Array(d),p=setInterval(()=>{s.getFloatFrequencyData(h);let g=new Float32Array(h.length);for(let w=0;w<h.length;w++)g[w]=h[w];g=g.slice(i.loPass,i.hiPass);const y=AH(g),C=y.length,x=[];for(let w=0;w<i.bands;w++){const S=Math.floor(w*C/i.bands),E=Math.floor((w+1)*C/i.bands),R=y.slice(S,E),k=R.length;if(k===0)x.push(0);else{const A=R.reduce((_,D)=>_+=D,0);x.push(A/k)}}c(x)},i.updateInterval);return()=>{l(),clearInterval(p)}},[r,r==null?void 0:r.mediaStream,JSON.stringify(e)]),o}pR.AgentState;var qh={exports:{}},ZA;function TH(){if(ZA)return qh.exports;ZA=1;var n=typeof Reflect=="object"?Reflect:null,e=n&&typeof n.apply=="function"?n.apply:function(k,A,_){return Function.prototype.apply.call(k,A,_)},t;n&&typeof n.ownKeys=="function"?t=n.ownKeys:Object.getOwnPropertySymbols?t=function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:t=function(k){return Object.getOwnPropertyNames(k)};function r(k){console&&console.warn&&console.warn(k)}var i=Number.isNaN||function(k){return k!==k};function o(){o.init.call(this)}qh.exports=o,qh.exports.once=S,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var c=10;function s(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(k){if(typeof k!="number"||k<0||i(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");c=k}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||i(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this};function l(k){return k._maxListeners===void 0?o.defaultMaxListeners:k._maxListeners}o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(k){for(var A=[],_=1;_<arguments.length;_++)A.push(arguments[_]);var D=k==="error",j=this._events;if(j!==void 0)D=D&&j.error===void 0;else if(!D)return!1;if(D){var Z;if(A.length>0&&(Z=A[0]),Z instanceof Error)throw Z;var F=new Error("Unhandled error."+(Z?" ("+Z.message+")":""));throw F.context=Z,F}var V=j[k];if(V===void 0)return!1;if(typeof V=="function")e(V,this,A);else for(var X=V.length,te=C(V,X),_=0;_<X;++_)e(te[_],this,A);return!0};function d(k,A,_,D){var j,Z,F;if(s(_),Z=k._events,Z===void 0?(Z=k._events=Object.create(null),k._eventsCount=0):(Z.newListener!==void 0&&(k.emit("newListener",A,_.listener?_.listener:_),Z=k._events),F=Z[A]),F===void 0)F=Z[A]=_,++k._eventsCount;else if(typeof F=="function"?F=Z[A]=D?[_,F]:[F,_]:D?F.unshift(_):F.push(_),j=l(k),j>0&&F.length>j&&!F.warned){F.warned=!0;var V=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+String(A)+" listeners added. Use emitter.setMaxListeners() to increase limit");V.name="MaxListenersExceededWarning",V.emitter=k,V.type=A,V.count=F.length,r(V)}return k}o.prototype.addListener=function(k,A){return d(this,k,A,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(k,A){return d(this,k,A,!0)};function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(k,A,_){var D={fired:!1,wrapFn:void 0,target:k,type:A,listener:_},j=h.bind(D);return j.listener=_,D.wrapFn=j,j}o.prototype.once=function(k,A){return s(A),this.on(k,p(this,k,A)),this},o.prototype.prependOnceListener=function(k,A){return s(A),this.prependListener(k,p(this,k,A)),this},o.prototype.removeListener=function(k,A){var _,D,j,Z,F;if(s(A),D=this._events,D===void 0)return this;if(_=D[k],_===void 0)return this;if(_===A||_.listener===A)--this._eventsCount===0?this._events=Object.create(null):(delete D[k],D.removeListener&&this.emit("removeListener",k,_.listener||A));else if(typeof _!="function"){for(j=-1,Z=_.length-1;Z>=0;Z--)if(_[Z]===A||_[Z].listener===A){F=_[Z].listener,j=Z;break}if(j<0)return this;j===0?_.shift():x(_,j),_.length===1&&(D[k]=_[0]),D.removeListener!==void 0&&this.emit("removeListener",k,F||A)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(k){var A,_,D;if(_=this._events,_===void 0)return this;if(_.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):_[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete _[k]),this;if(arguments.length===0){var j=Object.keys(_),Z;for(D=0;D<j.length;++D)Z=j[D],Z!=="removeListener"&&this.removeAllListeners(Z);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=_[k],typeof A=="function")this.removeListener(k,A);else if(A!==void 0)for(D=A.length-1;D>=0;D--)this.removeListener(k,A[D]);return this};function g(k,A,_){var D=k._events;if(D===void 0)return[];var j=D[A];return j===void 0?[]:typeof j=="function"?_?[j.listener||j]:[j]:_?w(j):C(j,j.length)}o.prototype.listeners=function(k){return g(this,k,!0)},o.prototype.rawListeners=function(k){return g(this,k,!1)},o.listenerCount=function(k,A){return typeof k.listenerCount=="function"?k.listenerCount(A):y.call(k,A)},o.prototype.listenerCount=y;function y(k){var A=this._events;if(A!==void 0){var _=A[k];if(typeof _=="function")return 1;if(_!==void 0)return _.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function C(k,A){for(var _=new Array(A),D=0;D<A;++D)_[D]=k[D];return _}function x(k,A){for(;A+1<k.length;A++)k[A]=k[A+1];k.pop()}function w(k){for(var A=new Array(k.length),_=0;_<A.length;++_)A[_]=k[_].listener||k[_];return A}function S(k,A){return new Promise(function(_,D){function j(F){k.removeListener(A,Z),D(F)}function Z(){typeof k.removeListener=="function"&&k.removeListener("error",j),_([].slice.call(arguments))}R(k,A,Z,{once:!0}),A!=="error"&&E(k,j,{once:!0})})}function E(k,A,_){typeof k.on=="function"&&R(k,"error",A,_)}function R(k,A,_,D){if(typeof k.on=="function")D.once?k.once(A,_):k.on(A,_);else if(typeof k.addEventListener=="function")k.addEventListener(A,function j(Z){D.once&&k.removeEventListener(A,j),_(Z)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}return qh.exports}TH();const AR=B.forwardRef(function(n,e){const{mergedProps:t}=vH({props:n});return B.createElement("button",{ref:e,...t},n.children)}),_H=B.forwardRef(function(n,e){const{buttonProps:t}=lH(n);return B.createElement("button",{ref:e,...t},n.children)}),RH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...n},B.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),B.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),DH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...n},B.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),PH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24",...n},B.createElement("path",{fill:"#FFF",d:"M4.99 3.99a1 1 0 0 0-.697 1.717L10.586 12l-6.293 6.293a1 1 0 1 0 1.414 1.414L12 13.414l6.293 6.293a1 1 0 1 0 1.414-1.414L13.414 12l6.293-6.293a1 1 0 0 0-.727-1.717 1 1 0 0 0-.687.303L12 10.586 5.707 4.293a1 1 0 0 0-.717-.303z"})),MH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none",...n},B.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),B.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),NH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...n},B.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M8.961.894C8.875-.298 7.125-.298 7.04.894c-.066.912-1.246 1.228-1.76.472-.67-.99-2.186-.115-1.664.96.399.824-.465 1.688-1.288 1.289-1.076-.522-1.95.994-.961 1.665.756.513.44 1.693-.472 1.759-1.192.086-1.192 1.836 0 1.922.912.066 1.228 1.246.472 1.76-.99.67-.115 2.186.96 1.664.824-.399 1.688.465 1.289 1.288-.522 1.076.994 1.95 1.665.961.513-.756 1.693-.44 1.759.472.086 1.192 1.836 1.192 1.922 0 .066-.912 1.246-1.228 1.76-.472.67.99 2.186.115 1.664-.96-.399-.824.465-1.688 1.288-1.289 1.076.522 1.95-.994.961-1.665-.756-.513-.44-1.693.472-1.759 1.192-.086 1.192-1.836 0-1.922-.912-.066-1.228-1.246-.472-1.76.99-.67.115-2.186-.96-1.664-.824.399-1.688-.465-1.289-1.288.522-1.076-.994-1.95-1.665-.961-.513.756-1.693.44-1.759-.472ZM8 13A5 5 0 1 0 8 3a5 5 0 0 0 0 10Z",clipRule:"evenodd"})),OH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...n},B.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),B.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),FH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...n},B.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),B.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),BH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...n},B.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),B.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),LH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...n},B.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),B.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),UH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...n},B.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),B.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),B.createElement("g",{opacity:.25},B.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),B.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),jH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...n},B.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),B.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),B.createElement("g",{opacity:.25},B.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),B.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),B.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),VH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...n},B.createElement("g",{opacity:.25},B.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),B.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),GH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...n},B.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),B.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),WH=n=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...n},B.createElement("g",{fill:"currentColor"},B.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),B.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),Bv=B.forwardRef(function({kind:n,initialSelection:e,onActiveDeviceChange:t,onDeviceListChange:r,onDeviceSelectError:i,exactMatch:o,track:c,requestPermissions:s,onError:l,...d},h){const p=vg(),g=B.useRef("default"),y=B.useCallback(_=>{p&&p.emit(We.MediaDevicesError,_),l==null||l(_)},[p,l]),{devices:C,activeDeviceId:x,setActiveMediaDevice:w,className:S}=hH({kind:n,room:p,track:c,requestPermissions:s,onError:y});B.useEffect(()=>{e!==void 0&&w(e)},[w]),B.useEffect(()=>{typeof r=="function"&&r(C)},[r,C]),B.useEffect(()=>{x!==g.current&&(t==null||t(x)),g.current=x},[x]);const E=async _=>{try{await w(_,{exact:o??!0})}catch(D){if(D instanceof Error)i==null||i(D);else throw D}},R=B.useMemo(()=>Ul(d,{className:S},{className:"lk-list"}),[S,d]),k=!!C.find(_=>_.label.toLowerCase().startsWith("default"));function A(_,D,j){return _===D||!k&&j===0&&D==="default"}return B.createElement("ul",{ref:h,...R},C.map((_,D)=>B.createElement("li",{key:_.deviceId,id:_.deviceId,"data-lk-active":A(_.deviceId,x,D),"aria-selected":A(_.deviceId,x,D),role:"option"},B.createElement("button",{className:"lk-button",onClick:()=>E(_.deviceId)},_.label))))}),zH=B.forwardRef(function({label:n,...e},t){const r=j1(),{mergedProps:i,canPlayAudio:o}=gH({room:r,props:e}),{mergedProps:c,canPlayVideo:s}=mH({room:r,props:i}),{style:l,...d}=c;return l.display=o&&s?"none":"block",B.createElement("button",{ref:t,style:l,...d},n??`Start ${o?"Video":"Audio"}`)});function kR(n,e){switch(n){case je.Source.Microphone:return e?B.createElement(BH,null):B.createElement(FH,null);case je.Source.Camera:return e?B.createElement(DH,null):B.createElement(RH,null);case je.Source.ScreenShare:return e?B.createElement(WH,null):B.createElement(GH,null);default:return}}function HH(n){switch(n){case _s.Excellent:return B.createElement(LH,null);case _s.Good:return B.createElement(UH,null);case _s.Poor:return B.createElement(jH,null);default:return B.createElement(VH,null)}}const Lv=B.forwardRef(function({showIcon:n,...e},t){const{buttonProps:r,enabled:i}=CH(e),[o,c]=B.useState(!1);return B.useEffect(()=>{c(!0)},[]),o&&B.createElement("button",{ref:t,...r},(n??!0)&&kR(e.source,i),e.children)}),ZH=B.forwardRef(function(n,e){const{className:t,quality:r}=cH(n),i=B.useMemo(()=>({...Ul(n,{className:t}),"data-lk-quality":r}),[r,n,t]);return B.createElement("div",{ref:e,...i},n.children??HH(r))}),XH=B.forwardRef(function({participant:n,...e},t){const r=mg(n),{className:i,infoObserver:o}=B.useMemo(()=>kz(r),[r]),{identity:c,name:s}=Fo(o,{name:r.name,identity:r.identity,metadata:r.metadata}),l=B.useMemo(()=>Ul(e,{className:i,"data-lk-participant-name":s}),[e,i,s]);return B.createElement("span",{ref:t,...l},s!==""?s:c,e.children)}),$H=B.forwardRef(function({trackRef:n,show:e="always",...t},r){const{className:i,isMuted:o}=yH(n),c=e==="always"||e==="muted"&&o||e==="unmuted"&&!o,s=B.useMemo(()=>Ul(t,{className:i}),[i,t]);return c?B.createElement("div",{ref:r,...s,"data-lk-muted":o},t.children??kR(n.source,!o)):null});function KH(n,e={}){const[t,r]=B.useState(sC(n)),[i,o]=B.useState(t==null?void 0:t.isMuted),[c,s]=B.useState(t==null?void 0:t.isSubscribed),[l,d]=B.useState(t==null?void 0:t.track),[h,p]=B.useState("landscape"),g=B.useRef(),{className:y,trackObserver:C}=B.useMemo(()=>lz(n),[n.participant.sid??n.participant.identity,n.source,pg(n)&&n.publication.trackSid]);return B.useEffect(()=>{const x=C.subscribe(w=>{Rn.debug("update track",w),r(w),o(w==null?void 0:w.isMuted),s(w==null?void 0:w.isSubscribed),d(w==null?void 0:w.track)});return()=>x==null?void 0:x.unsubscribe()},[C]),B.useEffect(()=>{var x,w;return l&&(g.current&&l.detach(g.current),(x=e.element)!=null&&x.current&&!(n.participant.isLocal&&(l==null?void 0:l.kind)==="audio")&&l.attach(e.element.current)),g.current=(w=e.element)==null?void 0:w.current,()=>{g.current&&(l==null||l.detach(g.current))}},[l,e.element]),B.useEffect(()=>{var x,w;if(typeof((x=t==null?void 0:t.dimensions)==null?void 0:x.width)=="number"&&typeof((w=t==null?void 0:t.dimensions)==null?void 0:w.height)=="number"){const S=t.dimensions.width>t.dimensions.height?"landscape":"portrait";p(S)}},[t]),{publication:t,isMuted:i,isSubscribed:c,track:l,elementProps:Ul(e.props,{className:y,"data-lk-local-participant":n.participant.isLocal,"data-lk-source":t==null?void 0:t.source,...(t==null?void 0:t.kind)==="video"&&{"data-lk-orientation":h}})}}var Uv,XA;function qH(){if(XA)return Uv;XA=1;var n="Expected a function",e=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,c=/^0o[0-7]+$/i,s=parseInt,l=typeof Xh=="object"&&Xh&&Xh.Object===Object&&Xh,d=typeof self=="object"&&self&&self.Object===Object&&self,h=l||d||Function("return this")(),p=Object.prototype,g=p.toString,y=Math.max,C=Math.min,x=function(){return h.Date.now()};function w(A,_,D){var j,Z,F,V,X,te,pe=0,ve=!1,Ie=!1,Re=!0;if(typeof A!="function")throw new TypeError(n);_=k(_)||0,S(D)&&(ve=!!D.leading,Ie="maxWait"in D,F=Ie?y(k(D.maxWait)||0,_):F,Re="trailing"in D?!!D.trailing:Re);function xe(Je){var me=j,it=Z;return j=Z=void 0,pe=Je,V=A.apply(it,me),V}function Ae(Je){return pe=Je,X=setTimeout(ee,_),ve?xe(Je):V}function ke(Je){var me=Je-te,it=Je-pe,Tt=_-me;return Ie?C(Tt,F-it):Tt}function H(Je){var me=Je-te,it=Je-pe;return te===void 0||me>=_||me<0||Ie&&it>=F}function ee(){var Je=x();if(H(Je))return ae(Je);X=setTimeout(ee,ke(Je))}function ae(Je){return X=void 0,Re&&j?xe(Je):(j=Z=void 0,V)}function ye(){X!==void 0&&clearTimeout(X),pe=0,j=te=Z=X=void 0}function Ee(){return X===void 0?V:ae(x())}function _e(){var Je=x(),me=H(Je);if(j=arguments,Z=this,te=Je,me){if(X===void 0)return Ae(te);if(Ie)return X=setTimeout(ee,_),xe(te)}return X===void 0&&(X=setTimeout(ee,_)),V}return _e.cancel=ye,_e.flush=Ee,_e}function S(A){var _=typeof A;return!!A&&(_=="object"||_=="function")}function E(A){return!!A&&typeof A=="object"}function R(A){return typeof A=="symbol"||E(A)&&g.call(A)==t}function k(A){if(typeof A=="number")return A;if(R(A))return e;if(S(A)){var _=typeof A.valueOf=="function"?A.valueOf():A;A=S(_)?_+"":_}if(typeof A!="string")return A===0?A:+A;A=A.replace(r,"");var D=o.test(A);return D||c.test(A)?s(A.slice(2),D?2:8):i.test(A)?e:+A}return Uv=w,Uv}qH();const YH=B.forwardRef(function({trackRef:n,onSubscriptionStatusChanged:e,volume:t,...r},i){const o=gg(n),c=B.useRef(null);B.useImperativeHandle(i,()=>c.current);const{elementProps:s,isSubscribed:l,track:d,publication:h}=KH(o,{element:c,props:r});return B.useEffect(()=>{e==null||e(!!l)},[l,e]),B.useEffect(()=>{d===void 0||t===void 0||(d instanceof _2?d.setVolume(t):Rn.warn("Volume can only be set on remote audio tracks."))},[t,d]),B.useEffect(()=>{h===void 0||r.muted===void 0||(h instanceof D2?h.setEnabled(!r.muted):Rn.warn("Can only call setEnabled on remote track publications."))},[r.muted,h,d]),B.createElement("audio",{ref:c,...s})});function QH({tracks:n,...e}){return B.createElement(B.Fragment,null,n.map(t=>B.createElement(B1.Provider,{value:t,key:D1(t)},V1(e.children))))}function JH({value:n,onPinChange:e,onWidgetChange:t,children:r}){const i=qz(n);return B.useEffect(()=>{Rn.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),B.useEffect(()=>{Rn.debug("Widget Updated",{widgetState:i.widget.state}),t&&i.widget.state&&t(i.widget.state)},[t,i.widget.state]),B.createElement(F1.Provider,{value:i},r)}const eZ=n=>{const e=[];for(let t=0;t<n;t++)e.push([t,n-1-t]);return e},$A=n=>[[Math.floor(n/2)],[-1]],tZ=(n,e,t)=>{const[r,i]=B.useState(0),[o,c]=B.useState([[]]);B.useEffect(()=>{if(n==="thinking")c($A(e));else if(n==="connecting"||n==="initializing"){const l=[...eZ(e)];c(l)}else c(n==="listening"?$A(e):n===void 0||n==="speaking"?[new Array(e).fill(0).map((l,d)=>d)]:[[]]);i(0)},[n,e]);const s=B.useRef(null);return B.useEffect(()=>{let l=performance.now();const d=h=>{h-l>=t&&(i(p=>p+1),l=h),s.current=requestAnimationFrame(d)};return s.current=requestAnimationFrame(d),()=>{s.current!==null&&cancelAnimationFrame(s.current)}},[t,e,n,o.length]),o[r%o.length]},nZ=new Map([["connecting",2e3],["initializing",2e3],["listening",500],["thinking",150]]),rZ=(n,e)=>{if(n===void 0)return 1e3;let t=nZ.get(n);if(t)switch(n){case"connecting":t/=e;break}return t},iZ=B.forwardRef(function({state:n,options:e,barCount:t=15,trackRef:r,track:i,children:o,...c},s){const l=Ul(c,{className:"lk-audio-bar-visualizer"});let d=L1();(r||i)&&(d=r||i);const h=EH(d,{bands:t,loPass:100,hiPass:200}),p=(e==null?void 0:e.minHeight)??20,g=(e==null?void 0:e.maxHeight)??100,y=tZ(n,t,rZ(n,t)??100);return B.createElement("div",{ref:s,...l,"data-lk-va-state":n},h.map((C,x)=>o?V1(o,{"data-lk-highlighted":y.includes(x),"data-lk-bar-index":x,className:"lk-audio-bar",style:{height:`${Math.min(g,Math.max(p,C*100+5))}%`}}):B.createElement("span",{key:x,"data-lk-highlighted":y.includes(x),"data-lk-bar-index":x,className:`lk-audio-bar ${y.includes(x)&&"lk-highlighted"}`,style:{height:`${Math.min(g,Math.max(p,C*100+5))}%`}})))}),oZ=B.forwardRef(function({children:n,disableSpeakingIndicator:e,onParticipantClick:t,trackRef:r,...i},o){const c=gg(r),{elementProps:s}=pH({trackRef:c,htmlProps:i,disableSpeakingIndicator:e,onParticipantClick:t});return B.createElement("div",{ref:o,style:{position:"relative",minHeight:"160px"},...s},B.createElement(B1.Provider,{value:c},n??B.createElement(B.Fragment,null,pg(c)&&B.createElement(YH,{trackRef:c}),B.createElement(iZ,{barCount:7,options:{minHeight:8}}),B.createElement("div",{className:"lk-participant-metadata"},B.createElement("div",{className:"lk-participant-metadata-item"},B.createElement($H,{trackRef:c}),B.createElement(XH,null)),B.createElement(ZH,{className:"lk-participant-metadata-item"})))))}),sZ=B.forwardRef(function({entry:n,hideName:e=!1,hideTimestamp:t=!1,messageFormatter:r,...i},o){var c,s,l,d;const h=B.useMemo(()=>r?r(n.message):n.message,[n.message,r]),p=!!n.editTimestamp,g=new Date(n.timestamp),y=typeof navigator<"u"?navigator.language:"en-US",C=((c=n.from)==null?void 0:c.name)??((s=n.from)==null?void 0:s.identity);return B.createElement("li",{ref:o,className:"lk-chat-entry",title:g.toLocaleTimeString(y,{timeStyle:"full"}),"data-lk-message-origin":(l=n.from)!=null&&l.isLocal?"local":"remote",...i},(!t||!e||p)&&B.createElement("span",{className:"lk-meta-data"},!e&&B.createElement("strong",{className:"lk-participant-name"},C),(!t||p)&&B.createElement("span",{className:"lk-timestamp"},p&&"edited ",g.toLocaleTimeString(y,{timeStyle:"short"}))),B.createElement("span",{className:"lk-message-body"},h),B.createElement("span",{className:"lk-message-attachements"},(d=n.attachedFiles)==null?void 0:d.map(x=>x.type.startsWith("image/")&&B.createElement("img",{style:{maxWidth:"300px",maxHeight:"300px"},key:x.name,src:URL.createObjectURL(x),alt:x.name}))))});function aZ({messageFormatter:n,messageDecoder:e,messageEncoder:t,channelTopic:r,...i}){const o=B.useRef(null),c=B.useRef(null),s=B.useMemo(()=>({messageDecoder:e,messageEncoder:t,channelTopic:r}),[e,t,r]),{chatMessages:l,send:d,isSending:h}=wH(s),p=bR(),g=B.useRef(0);async function y(C){C.preventDefault(),c.current&&c.current.value.trim()!==""&&(await d(c.current.value),c.current.value="",c.current.focus())}return B.useEffect(()=>{var C;o&&((C=o.current)==null||C.scrollTo({top:o.current.scrollHeight}))},[o,l]),B.useEffect(()=>{var C,x,w,S,E;if(!p||l.length===0)return;if((C=p.widget.state)!=null&&C.showChat&&l.length>0&&g.current!==((x=l[l.length-1])==null?void 0:x.timestamp)){g.current=(w=l[l.length-1])==null?void 0:w.timestamp;return}const R=l.filter(A=>!g.current||A.timestamp>g.current).length,{widget:k}=p;R>0&&((S=k.state)==null?void 0:S.unreadMessages)!==R&&((E=k.dispatch)==null||E.call(k,{msg:"unread_msg",count:R}))},[l,p==null?void 0:p.widget]),B.createElement("div",{...i,className:"lk-chat"},B.createElement("div",{className:"lk-chat-header"},"Messages",p&&B.createElement(AR,{className:"lk-close-button"},B.createElement(PH,null))),B.createElement("ul",{className:"lk-list lk-chat-messages",ref:o},i.children?l.map((C,x)=>V1(i.children,{entry:C,key:C.id??x,messageFormatter:n})):l.map((C,x,w)=>{const S=x>=1&&w[x-1].from===C.from,E=x>=1&&C.timestamp-w[x-1].timestamp<6e4;return B.createElement(sZ,{key:C.id??x,hideName:S,hideTimestamp:S===!1?!1:E,entry:C,messageFormatter:n})})),B.createElement("form",{className:"lk-chat-form",onSubmit:y},B.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:h,ref:c,type:"text",placeholder:"Enter a message...",onInput:C=>C.stopPropagation(),onKeyDown:C=>C.stopPropagation(),onKeyUp:C=>C.stopPropagation()}),B.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:h},"Send")))}function KA({kind:n,initialSelection:e,onActiveDeviceChange:t,tracks:r,requestPermissions:i=!1,...o}){const[c,s]=B.useState(!1),[l,d]=B.useState([]),[h,p]=B.useState(!0),[g,y]=B.useState(i),C=(E,R)=>{Rn.debug("handle device change"),s(!1),t==null||t(E,R)},x=B.useRef(null),w=B.useRef(null);B.useLayoutEffect(()=>{c&&y(!0)},[c]),B.useLayoutEffect(()=>{let E;return x.current&&w.current&&(l||h)&&(E=tz(x.current,w.current,(R,k)=>{w.current&&Object.assign(w.current.style,{left:`${R}px`,top:`${k}px`})})),p(!1),()=>{E==null||E()}},[x,w,l,h]);const S=B.useCallback(E=>{w.current&&E.target!==x.current&&c&&nz(w.current,E)&&s(!1)},[c,w,x]);return B.useEffect(()=>(document.addEventListener("click",S),()=>{document.removeEventListener("click",S)}),[S]),B.createElement(B.Fragment,null,B.createElement("button",{className:"lk-button lk-button-menu","aria-pressed":c,...o,onClick:()=>s(!c),ref:x},o.children),!o.disabled&&B.createElement("div",{className:"lk-device-menu",ref:w,style:{visibility:c?"visible":"hidden"}},n?B.createElement(Bv,{initialSelection:e,onActiveDeviceChange:E=>C(n,E),onDeviceListChange:d,kind:n,track:r==null?void 0:r[n],requestPermissions:g}):B.createElement(B.Fragment,null,B.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),B.createElement(Bv,{kind:"audioinput",onActiveDeviceChange:E=>C("audioinput",E),onDeviceListChange:d,track:r==null?void 0:r.audioinput,requestPermissions:g}),B.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),B.createElement(Bv,{kind:"videoinput",onActiveDeviceChange:E=>C("videoinput",E),onDeviceListChange:d,track:r==null?void 0:r.videoinput,requestPermissions:g}))))}function cZ(){B.useEffect(()=>{nH()},[])}function lZ({props:n}){const{dispatch:e,state:t}=xR().widget,r="lk-button lk-settings-toggle";return{mergedProps:B.useMemo(()=>Wa(n,{className:r,onClick:()=>{e&&e({msg:"toggle_settings"})},"aria-pressed":t!=null&&t.showSettings?"true":"false"}),[n,r,e,t])}}const uZ=B.forwardRef(function(n,e){const{mergedProps:t}=lZ({props:n});return B.createElement("button",{ref:e,...t},n.children)}),dZ=n=>{switch(n){case je.Source.Camera:return 1;case je.Source.Microphone:return 2;case je.Source.ScreenShare:return 3;default:return 0}};function fZ({variation:n,controls:e,saveUserChoices:t=!0,onDeviceError:r,...i}){var o;const[c,s]=B.useState(!1),l=bR();B.useEffect(()=>{var Z,F;((Z=l==null?void 0:l.widget.state)==null?void 0:Z.showChat)!==void 0&&s((F=l==null?void 0:l.widget.state)==null?void 0:F.showChat)},[(o=l==null?void 0:l.widget.state)==null?void 0:o.showChat]);const d=aH(`(max-width: ${c?1e3:760}px)`)?"minimal":"verbose";n??(n=d);const h={leave:!0,...e},p=fH();if(!p)h.camera=!1,h.chat=!1,h.microphone=!1,h.screenShare=!1;else{const Z=F=>p.canPublish&&(p.canPublishSources.length===0||p.canPublishSources.includes(dZ(F)));h.camera??(h.camera=Z(je.Source.Camera)),h.microphone??(h.microphone=Z(je.Source.Microphone)),h.screenShare??(h.screenShare=Z(je.Source.ScreenShare)),h.chat??(h.chat=p.canPublishData&&(e==null?void 0:e.chat))}const g=B.useMemo(()=>n==="minimal"||n==="verbose",[n]),y=B.useMemo(()=>n==="textOnly"||n==="verbose",[n]),C=sz(),[x,w]=B.useState(!1),S=B.useCallback(Z=>{w(Z)},[w]),E=Ul({className:"lk-control-bar"},i),{saveAudioInputEnabled:R,saveVideoInputEnabled:k,saveAudioInputDeviceId:A,saveVideoInputDeviceId:_}=SH({preventSave:!t}),D=B.useCallback((Z,F)=>F?R(Z):null,[R]),j=B.useCallback((Z,F)=>F?k(Z):null,[k]);return B.createElement("div",{...E},h.microphone&&B.createElement("div",{className:"lk-button-group"},B.createElement(Lv,{source:je.Source.Microphone,showIcon:g,onChange:D,onDeviceError:Z=>r==null?void 0:r({source:je.Source.Microphone,error:Z})},y&&"Microphone"),B.createElement("div",{className:"lk-button-group-menu"},B.createElement(KA,{kind:"audioinput",onActiveDeviceChange:(Z,F)=>A(F??"default")}))),h.camera&&B.createElement("div",{className:"lk-button-group"},B.createElement(Lv,{source:je.Source.Camera,showIcon:g,onChange:j,onDeviceError:Z=>r==null?void 0:r({source:je.Source.Camera,error:Z})},y&&"Camera"),B.createElement("div",{className:"lk-button-group-menu"},B.createElement(KA,{kind:"videoinput",onActiveDeviceChange:(Z,F)=>_(F??"default")}))),h.screenShare&&C&&B.createElement(Lv,{source:je.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:g,onChange:S,onDeviceError:Z=>r==null?void 0:r({source:je.Source.ScreenShare,error:Z})},y&&(x?"Stop screen share":"Share screen")),h.chat&&B.createElement(AR,null,g&&B.createElement(MH,null),y&&"Chat"),h.settings&&B.createElement(uZ,null,g&&B.createElement(NH,null),y&&"Settings"),h.leave&&B.createElement(_H,null,g&&B.createElement(OH,null),y&&"Leave"),B.createElement(zH,null))}function hZ({...n}){const[e,t]=B.useState({showChat:!1,unreadMessages:0}),r=xH([je.Source.Microphone]);return cZ(),B.createElement(JH,{onWidgetChange:t},B.createElement("div",{className:"lk-audio-conference",...n},B.createElement("div",{className:"lk-audio-conference-stage"},B.createElement(QH,{tracks:r},B.createElement(oZ,null))),B.createElement(fZ,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),e.showChat&&B.createElement(aZ,null)))}const pZ="wss://mongoose-67t79p35.livekit.cloud",gZ=({client:n})=>{const[e,t]=B.useState([]),[r,i]=B.useState(!1);return B.useEffect(()=>{const o=s=>{t(l=>[...l,s]),i(!0)},c=s=>{t(l=>{const d=l.filter(h=>h!==s);return d.length===0&&i(!1),d})};return n.on("livekitToken",o),n.on("livekitLeave",c),()=>{n.off("livekitToken",o),n.off("livekitLeave",c)}},[n]),e.length?K.jsxs("div",{"data-lk-theme":"default",children:[e.map((o,c)=>K.jsx(sH,{video:!1,audio:!0,token:o,serverUrl:pZ,connect:!0,onDisconnected:()=>n.emit("livekitLeave",o),children:K.jsx(hZ,{})},c)),K.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null},Gp=({items:n,renderItem:e,listId:t,labelledBy:r,className:i="",itemClassName:o,getItemTextValue:c=l=>(l.name||l.id||"").toString().toLowerCase(),onSelectedIndexChange:s})=>{var C;const[l,d]=B.useState(-1),h=B.useRef(null),p=B.useCallback(x=>{d(x),s&&s(x)},[s]),g=()=>{l===-1&&n.length>0&&p(0)};B.useEffect(()=>{var x;if(l>=n.length&&p(n.length>0?0:-1),l!==-1&&n[l]){const w=`${t}-item-${(x=n[l])==null?void 0:x.id}`,S=document.getElementById(w);S&&S.scrollIntoView({block:"nearest"})}},[l,n,t]);const y=B.useCallback(x=>{if(n.length===0)return;let w=l,S=!0;switch(x.key){case"ArrowDown":w=(l+1)%n.length;break;case"ArrowUp":w=(l-1+n.length)%n.length;break;case"Home":w=0;break;case"End":w=n.length-1;break;case"PageUp":w=Math.max(l-5,0);break;case"PageDown":w=Math.min(l+5,n.length-1);break;default:if(x.key.length===1&&!x.ctrlKey&&!x.metaKey&&!x.altKey){const E=x.key.toLowerCase();let R=l===-1?0:(l+1)%n.length,k=-1;for(let A=0;A<n.length;A++){const _=(R+A)%n.length;if(c(n[_]).startsWith(E)){k=_;break}}k!==-1?w=k:S=!1}else S=!1;break}w!==l&&p(w),S&&x.preventDefault()},[l,n,c]);return K.jsx("div",{id:t,className:`accessible-list-container ${i}`,ref:h,tabIndex:0,role:"listbox","aria-labelledby":r,"aria-activedescendant":l!==-1?`${t}-item-${(C=n[l])==null?void 0:C.id}`:void 0,onFocus:g,onKeyDown:y,children:K.jsx("ul",{role:"none",className:"accessible-list-ul",children:n.map((x,w)=>{const S=w===l,E=e(x,w,S),R=o?o(x,w,S):"";return K.jsx("li",{id:`${t}-item-${x.id}`,className:`${R} ${S?"selected":""}`,role:"option","aria-selected":S,onClick:()=>p(w),children:E},x.id)})})})},mZ=n=>({...n,id:n.Object}),vZ=({users:n})=>{const e=n.map(mZ),t=(o,c,s)=>{let l="Online";return o.away&&(l="Away"),o.idle&&(l==="Online"?l="Idle":l+=" + Idle"),K.jsxs(K.Fragment,{children:[o.Name,K.jsxs("span",{className:"sr-only",children:["",`(${l})`]})]})},r=(o,c,s)=>{let l="userlist-item";return o.away&&(l+=" away"),o.idle&&(l+=" idle"),l},i=o=>o.Name?o.Name.toLowerCase():"";return K.jsxs(K.Fragment,{children:[K.jsx("div",{className:"sidebar-header",id:"userlist-header","aria-hidden":"true",children:"Connected Players"}),K.jsxs("div",{className:"sidebar",children:[" ",K.jsxs("div",{className:"sidebar-content",children:[" ",K.jsx(Gp,{items:e,renderItem:t,listId:"userlist",labelledBy:"userlist-header",className:"userlist-accessible-container",itemClassName:r,getItemTextValue:i})]})]})]})},yZ=({items:n,onItemSelected:e,listId:t,labelledBy:r})=>{const i=l=>{l>-1&&n[l]?e(n[l]):e(null)},o=(l,d,h)=>K.jsxs("span",{children:[" ",l.name]}),c=(l,d,h)=>"inventory-list-li",s=l=>l.name?l.name.toLowerCase():"";return K.jsx(Gp,{items:n,renderItem:o,listId:t,labelledBy:r,className:"inventory-accessible-list",itemClassName:c,getItemTextValue:s,onSelectedIndexChange:i})},ER=({item:n,onDrop:e,onWear:t,onRemove:r,onGet:i})=>{var h,p;const o=n.name,c=(h=n.Attrib)==null?void 0:h.includes("W"),s=(p=n.Attrib)==null?void 0:p.includes("w"),l=g=>{g.stopPropagation(),e&&e(n)},d=g=>{g.stopPropagation(),i&&i(n)};return K.jsxs("div",{className:"item-card",title:o,"data-item-id":n.id,children:[n.icon&&K.jsx("img",{src:n.icon,alt:"",className:"item-icon"}),K.jsxs("div",{className:"item-details",children:[" ",K.jsx("div",{className:"item-name",children:n.name})]}),K.jsxs("div",{className:"item-actions",children:[n.location==="room"&&i&&K.jsx("button",{className:"item-get-button",onClick:d,"aria-label":`Get ${n.name}`,tabIndex:0,accessKey:"g",children:"Get"}),n.location==="inv"&&c&&!s&&t&&K.jsx("button",{className:"item-wear-button",onClick:()=>t(n),"aria-label":`Wear ${n.name}`,tabIndex:0,accessKey:"w",children:"Wear"}),n.location==="inv"&&s&&r&&K.jsx("button",{className:"item-remove-button",onClick:()=>r(n),"aria-label":`Remove ${n.name}`,tabIndex:0,accessKey:"r",children:"Remove"}),n.location==="inv"&&e&&K.jsx("button",{className:"item-drop-button",onClick:l,"aria-label":`Drop ${n.name}`,tabIndex:0,accessKey:"d"})]})]})},CZ=({client:n})=>{const[e,t]=B.useState([]),[r,i]=B.useState(null),o=B.useCallback((x,w)=>{x==="inv"&&(t(w),(w.length===0||!w.find(S=>S.id===(r==null?void 0:r.id)))&&i(null),n.emit("inventoryDataReceived"))},[n,r==null?void 0:r.id]),c=B.useCallback((x,w)=>{x==="inv"&&t(S=>{if(S.some(R=>R.id===w.id))return S;const E=[...S,w];return n.emit("inventoryDataReceived"),E})},[n]),s=B.useCallback((x,w)=>{x==="inv"&&t(S=>{const E=S.filter(R=>R.id!==w.id);return E.length<S.length&&n.emit("inventoryDataReceived"),(r==null?void 0:r.id)===w.id&&i(null),E})},[n,r==null?void 0:r.id]),l=B.useCallback((x,w)=>{x==="inv"&&(t(S=>S.map(E=>E.id===w.id?{...E,...w}:E)),(r==null?void 0:r.id)===w.id&&i(S=>S?{...S,...w}:null),n.emit("inventoryDataReceived"))},[n,r==null?void 0:r.id]);B.useEffect(()=>{const x=k=>o(k.location,k.items),w=k=>c(k.location,k.item),S=k=>s(k.location,k.item),E=k=>l(k.location,k.item);n.on("itemsList",x),n.on("itemAdd",w),n.on("itemRemove",S),n.on("itemUpdate",E);const R=n.gmcpHandlers["Char.Items"];return R!=null&&R.sendInventoryRequest&&R.sendInventoryRequest(),()=>{n.off("itemsList",x),n.off("itemAdd",w),n.off("itemRemove",S),n.off("itemUpdate",E)}},[n,o,c,s,l]);const d=x=>{i(x)},h=B.useCallback(x=>{n.sendCommand(`drop ${x.id}`)},[n]),p=B.useCallback(x=>{n.sendCommand(`wear ${x.id}`)},[n]),g=B.useCallback(x=>{n.sendCommand(`remove ${x.id}`)},[n]),y="inventory-heading";return K.jsxs("div",{className:"inventory-tab-content",role:"region","aria-labelledby":y,children:[K.jsx("h4",{id:y,tabIndex:-1,children:"Inventory"}),e.length===0?K.jsx("p",{children:"Your inventory is empty."}):K.jsx(yZ,{items:e,onItemSelected:d,listId:"inventory-listbox",labelledBy:y}),r&&K.jsx("div",{className:"selected-item-card-container",style:{marginTop:"1rem"},children:K.jsx(ER,{item:r,onDrop:h,onWear:p,onRemove:g})})]})};function If(n,e,t){const[r,i]=B.useState(t);return B.useEffect(()=>{if(!n)return i(t),()=>{};const o=c=>{i(c)};return n.on(e,o),()=>{n.off(e,o)}},[n,e,t]),r}const xZ=({player:n,onLook:e,onFollow:t})=>{const r=s=>{s.stopPropagation(),EI(`page ${n.name} `)},i=s=>{s.stopPropagation(),EI(`-${n.name} `)},o=s=>{s.stopPropagation(),e(n)},c=s=>{s.stopPropagation(),t(n)};return K.jsxs("div",{className:"player-card",title:n.fullname,"data-player-name":n.name,children:[K.jsx("div",{className:"player-details",children:K.jsx("div",{className:"player-name",children:n.fullname})}),K.jsxs("div",{className:"player-actions",children:[K.jsx("button",{className:"player-page-button",onClick:r,"aria-label":`Page ${n.fullname}`,tabIndex:0,accessKey:"p",children:"Page"}),K.jsx("button",{className:"player-sayto-button",onClick:i,"aria-label":`Say to ${n.fullname} (using -${n.name})`,title:`Say to ${n.fullname} (uses -${n.name} command)`,tabIndex:0,accessKey:"s",children:"Say To"}),K.jsx("button",{className:"player-look-button",onClick:o,"aria-label":`Look at ${n.fullname}`,tabIndex:0,accessKey:"l",children:"Look"}),K.jsx("button",{className:"player-follow-button",onClick:c,"aria-label":`Follow ${n.fullname}`,tabIndex:0,accessKey:"f",children:"Follow"})]})]})},bZ=({client:n})=>{const[e,t]=B.useState(n.currentRoomInfo),[r,i]=B.useState([]),[o,c]=B.useState(null),[s,l]=B.useState(n.worldData.roomPlayers||[]),[d,h]=B.useState(null),p=n.gmcpHandlers["Char.Items"],g=B.useCallback((ae,ye)=>ye.some(Ee=>ae.name.toLowerCase()===Ee.fullname.toLowerCase()),[]),y=B.useMemo(()=>r.filter(ae=>!g(ae,s)),[r,s,g]),C=B.useCallback(ae=>{t(ae)},[]);B.useEffect(()=>(n.on("roomInfo",C),p!=null&&p.sendRoomRequest&&p.sendRoomRequest(),()=>{n.off("roomInfo",C)}),[n,p,C]);const x=B.useCallback((ae,ye)=>{ae==="room"&&(i(ye),o&&!ye.find(Ee=>Ee.id===o.id)&&c(null))},[o]),w=B.useCallback((ae,ye)=>{ae==="room"&&i(Ee=>Ee.some(_e=>_e.id===ye.id)?Ee:[...Ee,ye])},[]),S=B.useCallback((ae,ye)=>{ae==="room"&&(i(Ee=>Ee.filter(_e=>_e.id!==ye.id)),(o==null?void 0:o.id)===ye.id&&c(null))},[o]);B.useEffect(()=>{const ae=_e=>x(_e.location,_e.items),ye=_e=>w(_e.location,_e.item),Ee=_e=>S(_e.location,_e.item);return n.on("itemsList",ae),n.on("itemAdd",ye),n.on("itemRemove",Ee),()=>{n.off("itemsList",ae),n.off("itemAdd",ye),n.off("itemRemove",Ee)}},[n,x,w,S]);const E=B.useCallback(ae=>{l(ae),d&&!ae.find(ye=>ye.name===d.name)&&h(null)},[d]),R=B.useCallback(ae=>{l(ye=>ye.some(Ee=>Ee.name===ae.name)?ye:[...ye,ae])},[]),k=B.useCallback(ae=>{l(ye=>ye.filter(Ee=>Ee.name!==ae)),(d==null?void 0:d.name)===ae&&h(null)},[d]);B.useEffect(()=>(n.on("roomPlayers",E),n.on("roomAddPlayer",R),n.on("roomRemovePlayer",k),()=>{n.off("roomPlayers",E),n.off("roomAddPlayer",R),n.off("roomRemovePlayer",k)}),[n,E,R,k]);const A=ae=>{n.sendCommand(ae)},_=ae=>{c(ae>-1&&y[ae]?y[ae]:null)},D=B.useCallback(ae=>{n.sendCommand(`get ${ae.id}`)},[n]),j=ae=>{h(ae>-1&&s[ae]?s[ae]:null)},Z=B.useCallback(ae=>{n.sendCommand(`look ${ae.name}`)},[n]),F=B.useCallback(ae=>{n.sendCommand(`follow ${ae.name}`)},[n]),V=ae=>K.jsx("span",{children:ae.name}),X=()=>"room-item-li",te=ae=>ae.name.toLowerCase(),pe=ae=>K.jsx("span",{children:ae.fullname}),ve=()=>"room-player-li",Ie=ae=>ae.fullname.toLowerCase(),Re="room-info-heading",xe="room-contents-heading",Ae="room-contents-list",ke="room-players-heading",H="room-players-list";if(!e&&y.length===0)return K.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":Re,children:[K.jsx("h4",{id:Re,children:"Room Info"}),K.jsx("p",{children:"Waiting for room data..."})]});const ee=e!=null&&e.exits?Object.entries(e.exits).sort(([ae],[ye])=>ae.localeCompare(ye)):[];return K.jsxs("div",{className:"room-info-display",role:"region","aria-labelledby":Re,children:[e&&K.jsxs(K.Fragment,{children:[K.jsx("h4",{id:Re,children:e.name||"Current Room"}),e.area&&K.jsxs("p",{className:"room-area",children:["Area: ",e.area]}),ee.length>0&&K.jsxs("div",{className:"room-exits",children:[K.jsx("h5",{children:"Exits"}),K.jsx("ul",{"aria-label":"Room Exits",children:ee.map(([ae,ye])=>K.jsx("li",{children:K.jsx("button",{onClick:()=>A(ae),title:`Go ${ae} (to room ${ye})`,"aria-label":`Go ${ae}`,children:ae.toUpperCase()})},ae))})]})]}),K.jsxs("div",{className:"room-contents-section",children:[K.jsx("h5",{id:xe,tabIndex:-1,children:"Contents"}),y.length===0?K.jsx("p",{children:"Nothing on the ground."}):K.jsx(Gp,{items:y,renderItem:V,listId:Ae,labelledBy:xe,className:"room-items-accessible-list",itemClassName:X,getItemTextValue:te,onSelectedIndexChange:_})]}),o&&K.jsx("div",{className:"selected-room-item-card-container",style:{marginTop:"1rem"},children:K.jsx(ER,{item:o,onGet:D})}),K.jsxs("div",{className:"room-players-section",children:[K.jsx("h5",{id:ke,tabIndex:-1,children:"Players in Room"}),s.length===0?K.jsx("p",{children:"No other players here."}):K.jsx(Gp,{items:s.map(ae=>({...ae,id:ae.name})),renderItem:pe,listId:H,labelledBy:ke,className:"room-players-accessible-list",itemClassName:ve,getItemTextValue:Ie,onSelectedIndexChange:j})]}),d&&K.jsx("div",{className:"selected-player-card-container",style:{marginTop:"1rem"},children:K.jsx(xZ,{player:d,onLook:Z,onFollow:F})})]})},IZ=({client:n})=>{const[e]=Bo(),[t,r]=B.useState(null),[i,o]=B.useState([]),[c,s]=B.useState([]),[l,d]=B.useState(""),[h,p]=B.useState(""),[g,y]=B.useState(en.connectionStatus),[C,x]=B.useState([]),[w,S]=B.useState({}),[E,R]=B.useState(60),[k,A]=B.useState(64),[_,D]=B.useState(!0),[j,Z]=B.useState(0),[F,V]=B.useState(!1),[X,te]=B.useState(1e3),[pe,ve]=B.useState([]);B.useEffect(()=>{const me=n.gmcpHandlers["Client.Midi"];me&&r(me)},[n]);const Ie=async()=>{if(!e.midi.enabled)return;Qs.initialized||await Qs.initialize();const me=en.getInputDevices(),it=en.getOutputDevices();o(me),s(it),y(en.connectionStatus),await Re()},Re=async()=>{const me=dr.getState().midi,it=en.intentionalDisconnectStatus,Tt={};if(me.lastInputDeviceId&&!g.inputConnected){const Xt=i.find(Et=>Et.id===me.lastInputDeviceId);if(Xt&&en.canReconnectToDevice(me.lastInputDeviceId,"input"))if(Tt.input=Xt,t&&!it.input)try{if(await t.connectInputDevice(me.lastInputDeviceId)){y(en.connectionStatus),x(St=>[{timestamp:new Date().toLocaleTimeString(),message:`Auto-reconnected to input: ${Xt.name}`,type:"reconnect"},...St].slice(0,10));return}}catch(Et){console.error("Error during input auto-reconnection:",Et)}else it.input&&console.log("Skipping input auto-reconnect due to intentional disconnect")}if(me.lastOutputDeviceId&&!g.outputConnected){const Xt=c.find(Et=>Et.id===me.lastOutputDeviceId);if(Xt&&en.canReconnectToDevice(me.lastOutputDeviceId,"output"))if(Tt.output=Xt,t&&!it.output)try{if(await t.connectOutputDevice(me.lastOutputDeviceId)){y(en.connectionStatus),x(St=>[{timestamp:new Date().toLocaleTimeString(),message:`Auto-reconnected to output: ${Xt.name}`,type:"reconnect"},...St].slice(0,10));return}}catch(Et){console.error("Error during output auto-reconnection:",Et)}else it.output&&console.log("Skipping output auto-reconnect due to intentional disconnect")}S(Tt)};B.useEffect(()=>{if(e.midi.enabled){!en.isInitialized&&t?t.ensureInitialized().then(()=>{Ie()}):Ie();const me=setInterval(()=>{Ie();const Tt=en.connectionStatus;JSON.stringify(Tt)!==JSON.stringify(g)&&y(Tt)},2e3),it=en.onDeviceChange(Tt=>{const Xt=new Date().toLocaleTimeString(),Et=[];Tt.inputs.added.forEach(St=>{Et.push({timestamp:Xt,message:`Input device connected: ${St.name}`,type:"connected"})}),Tt.outputs.added.forEach(St=>{Et.push({timestamp:Xt,message:`Output device connected: ${St.name}`,type:"connected"})}),Tt.inputs.removed.forEach(St=>{Et.push({timestamp:Xt,message:`Input device disconnected: ${St.name}`,type:"disconnected"})}),Tt.outputs.removed.forEach(St=>{Et.push({timestamp:Xt,message:`Output device disconnected: ${St.name}`,type:"disconnected"})}),Et.length>0&&x(St=>[...Et,...St].slice(0,10)),Ie()});return()=>{clearInterval(me),it()}}else o([]),s([]),y({inputConnected:!1,outputConnected:!1}),S({})},[e.midi.enabled,en.isInitialized]),B.useEffect(()=>{Re()},[g,i,c,t]);const xe=async()=>{if(!t||!l)return;await t.connectInputDevice(l)&&(y(en.connectionStatus),d(""),Ie())},Ae=()=>{en.disconnectWithIntent("input"),y(en.connectionStatus),Ie()},ke=async()=>{if(!t||!h)return;await t.connectOutputDevice(h)&&(y(en.connectionStatus),p(""),Ie())},H=()=>{en.disconnectWithIntent("output"),y(en.connectionStatus),Ie()},ee=async()=>{en.refresh(),Qs.initialized||await Qs.initialize(),Ie(),y(en.connectionStatus)},ae=async()=>{if(!w.input||!t)return;await en.attemptReconnect(w.input.id,"input")&&(y(en.connectionStatus),Ie(),x(it=>[{timestamp:new Date().toLocaleTimeString(),message:`Reconnected to input: ${w.input.name}`,type:"reconnect"},...it].slice(0,10)))},ye=async()=>{if(!w.output||!t)return;await en.attemptReconnect(w.output.id,"output")&&(y(en.connectionStatus),Ie(),x(it=>[{timestamp:new Date().toLocaleTimeString(),message:`Reconnected to output: ${w.output.name}`,type:"reconnect"},...it].slice(0,10)))};B.useEffect(()=>{if(t)return t.setDebugCallback((me,it,Tt)=>{const Xt=new Date().toLocaleTimeString(),Et={hex:me,type:it,gmcp:Tt,timestamp:Xt};ve(St=>[Et,...St].slice(0,15))}),()=>{t.setDebugCallback(()=>{})}},[t]);const Ee=()=>{t&&t.sendAllNotesOff()},_e=()=>{if(!t)return;const me=F&&_?X:void 0;t.sendManualNote(E,k,_,j,me)},Je=me=>{const it=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Tt=Math.floor(me/12)-1;return`${it[me%12]}${Tt}`};return e.midi.enabled?K.jsxs("div",{style:{padding:"10px"},children:[K.jsx("h3",{children:"MIDI Status"}),K.jsxs("div",{style:{marginBottom:"15px"},children:[K.jsx("div",{style:{marginBottom:"8px"},children:K.jsx("strong",{children:"Input Device:"})}),g.inputConnected?K.jsxs("div",{style:{marginBottom:"8px"},children:[K.jsxs("span",{style:{color:"green"},children:[" ",g.inputDeviceName]}),K.jsx("button",{onClick:Ae,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em"},children:"Disconnect"})]}):K.jsxs("div",{style:{marginBottom:"8px"},children:[w.input&&K.jsxs("div",{style:{marginBottom:"8px",padding:"8px",backgroundColor:"#e3f2fd",border:"1px solid #2196F3",borderRadius:"4px"},children:[K.jsx("div",{style:{fontSize:"0.9em",marginBottom:"5px"},children:K.jsx("span",{style:{color:"#1976D2"},children:" Last used device available:"})}),K.jsxs("div",{children:[K.jsx("span",{children:w.input.name}),K.jsx("button",{onClick:ae,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"},children:"Reconnect"})]})]}),i.length===0?K.jsx("span",{style:{color:"#666",fontSize:"0.9em"},children:"No input devices found"}):K.jsxs(K.Fragment,{children:[K.jsxs("select",{value:l,onChange:me=>d(me.target.value),style:{marginRight:"10px"},children:[K.jsx("option",{value:"",children:"Select input device..."}),i.map(me=>K.jsx("option",{value:me.id,children:me.name},me.id))]}),K.jsx("button",{onClick:xe,disabled:!l,style:{padding:"2px 8px",fontSize:"0.8em",marginRight:"5px"},children:"Connect"})]})]})]}),K.jsxs("div",{style:{marginBottom:"15px"},children:[K.jsx("div",{style:{marginBottom:"8px"},children:K.jsx("strong",{children:"Output Device:"})}),g.outputConnected?K.jsxs("div",{style:{marginBottom:"8px"},children:[K.jsxs("span",{style:{color:"green"},children:[" ",g.outputDeviceName]}),K.jsx("button",{onClick:H,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em"},children:"Disconnect"})]}):K.jsxs("div",{style:{marginBottom:"8px"},children:[w.output&&K.jsxs("div",{style:{marginBottom:"8px",padding:"8px",backgroundColor:"#e8f5e8",border:"1px solid #4CAF50",borderRadius:"4px"},children:[K.jsx("div",{style:{fontSize:"0.9em",marginBottom:"5px"},children:K.jsx("span",{style:{color:"#2E7D32"},children:" Last used device available:"})}),K.jsxs("div",{children:[K.jsx("span",{children:w.output.name}),K.jsx("button",{onClick:ye,style:{marginLeft:"10px",padding:"2px 8px",fontSize:"0.8em",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"2px",cursor:"pointer"},children:"Reconnect"})]})]}),c.length===0?K.jsx("span",{style:{color:"#666",fontSize:"0.9em"},children:"No output devices found"}):K.jsxs(K.Fragment,{children:[K.jsxs("select",{value:h,onChange:me=>p(me.target.value),style:{marginRight:"10px"},children:[K.jsx("option",{value:"",children:"Select output device..."}),c.map(me=>K.jsx("option",{value:me.id,children:me.name},me.id))]}),K.jsx("button",{onClick:ke,disabled:!h,style:{padding:"2px 8px",fontSize:"0.8em",marginRight:"5px"},children:"Connect"})]})]})]}),K.jsx("div",{style:{marginBottom:"15px"},children:K.jsx("button",{onClick:ee,style:{padding:"4px 12px",fontSize:"0.8em"},children:"Refresh Devices"})}),K.jsx("div",{style:{marginBottom:"15px"},children:K.jsx("button",{onClick:Ee,children:"All Notes Off"})}),K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"Manual Note Controls"})}),K.jsxs("div",{style:{padding:"10px 0"},children:[K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Note:"})," ",K.jsx("input",{type:"number",min:"0",max:"127",value:E,onChange:me=>R(parseInt(me.target.value)),style:{width:"60px",marginRight:"10px"}}),K.jsxs("span",{style:{fontSize:"0.9em",color:"#666"},children:["(",Je(E),")"]})]})}),K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Velocity:"})," ",K.jsx("input",{type:"range",min:"1",max:"127",value:k,onChange:me=>A(parseInt(me.target.value)),style:{width:"100px",marginRight:"10px"}}),K.jsx("span",{style:{fontSize:"0.9em"},children:k})]})}),K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Channel:"})," ",K.jsx("select",{value:j,onChange:me=>Z(parseInt(me.target.value)),style:{marginRight:"10px"},children:Array.from({length:16},(me,it)=>K.jsx("option",{value:it,children:it+1},it))})]})}),K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:F,onChange:me=>V(me.target.checked),style:{marginRight:"8px"}}),K.jsx("strong",{children:"Use Duration"})," (auto Note Off)"]})}),F?K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("strong",{children:"Duration:"})," ",K.jsx("input",{type:"number",min:"100",max:"10000",step:"100",value:X,onChange:me=>te(parseInt(me.target.value)),style:{width:"80px",marginRight:"10px"}}),K.jsx("span",{style:{fontSize:"0.9em",color:"#666"},children:"ms"})]})}):K.jsx("div",{style:{marginBottom:"10px"},children:K.jsxs("label",{children:[K.jsx("input",{type:"checkbox",checked:_,onChange:me=>D(me.target.checked),style:{marginRight:"8px"}}),K.jsx("strong",{children:"Note On"})," (unchecked = Note Off)"]})}),K.jsx("div",{style:{marginBottom:"15px"},children:K.jsx("button",{onClick:_e,style:{padding:"8px 16px",backgroundColor:F?"#2196F3":_?"#4CAF50":"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:F?`Send Note (${X}ms duration)`:`Send ${_?"Note On":"Note Off"} to Server`})})]})]}),C.length>0&&K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"Device Connection Events"})}),K.jsx("div",{style:{padding:"10px 0"},children:K.jsx("div",{style:{maxHeight:"200px",overflow:"auto",fontFamily:"monospace",fontSize:"0.8em",backgroundColor:"#f9f9f9",padding:"10px",border:"1px solid #ddd",marginBottom:"15px"},children:C.map((me,it)=>K.jsxs("div",{style:{marginBottom:"5px",paddingBottom:"5px",borderBottom:it<C.length-1?"1px solid #eee":"none",color:me.type==="connected"?"#2E7D32":me.type==="disconnected"?"#D32F2F":"#1976D2"},children:[K.jsx("span",{style:{color:"#666"},children:me.timestamp})," - ",me.message]},it))})})]}),K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"MIDI Debug Monitor"})}),K.jsx("div",{style:{padding:"10px 0"},children:K.jsxs("div",{style:{maxHeight:"300px",overflow:"auto",fontFamily:"monospace",fontSize:"0.8em",backgroundColor:"#f5f5f5",padding:"10px",border:"1px solid #ddd",marginBottom:"15px"},children:[pe.length===0?K.jsx("div",{style:{color:"#999"},children:"No MIDI messages received yet"}):pe.map((me,it)=>K.jsxs("div",{style:{marginBottom:"8px",paddingBottom:"8px",borderBottom:it<pe.length-1?"1px solid #ddd":"none"},children:[K.jsxs("div",{children:[K.jsx("strong",{children:"MIDI:"})," ",me.hex," (",me.type,") ",K.jsx("span",{style:{color:"#666",fontSize:"0.9em"},children:me.timestamp})]}),K.jsxs("div",{children:[K.jsx("strong",{children:"GMCP:"})," ",me.gmcp]})]},it)),K.jsx("div",{style:{marginTop:"10px",color:"#666",fontSize:"0.9em",borderTop:"1px solid #ddd",paddingTop:"5px"},children:"Showing last 15 messages  Active Sensing (0xFE) suppressed"})]})})]}),K.jsxs("details",{children:[K.jsx("summary",{children:K.jsx("strong",{children:"Usage"})}),K.jsxs("div",{style:{padding:"10px 0",fontSize:"0.9em",color:"#666"},children:[K.jsx("p",{children:" Press keys on your MIDI keyboard to send notes to the server"}),K.jsx("p",{children:" Server can send notes back to play on your MIDI device"}),K.jsx("p",{children:" Use manual controls above to test server communication"}),K.jsxs("p",{children:[" ",K.jsx("strong",{children:"Duration Mode:"})," Send Note On with auto Note Off after specified time"]}),K.jsxs("p",{children:[" ",K.jsx("strong",{children:"Manual Mode:"})," Send explicit Note On/Off messages"]}),K.jsx("p",{children:" Press Escape to stop all sounds and MIDI notes"}),K.jsx("p",{children:" MIDI notes: 0-127 (60 = Middle C, 69 = A4-440Hz)"})]})]})]}):K.jsx("div",{style:{padding:"10px"},children:K.jsx("p",{children:"MIDI is disabled. Enable it in preferences to use MIDI features."})})},wZ=Cn.forwardRef(({client:n,collapsed:e,onToggleCollapse:t},r)=>{const i=If(n,"userlist",[]),[o]=Bo(),[c,s]=B.useState(!0),[l,d]=B.useState(!1),[h,p]=B.useState(!!n.currentRoomInfo);B.useEffect(()=>{const C=n.gmcpHandlers["Client.Midi"];C&&n.connected&&(o.midi.enabled?C.advertiseMidiSupport():C.unadvertiseMidiSupport())},[o.midi.enabled,n]),B.useEffect(()=>{const C=()=>d(!0);return n.on("itemsList",C),()=>{n.off("itemsList",C)}},[n]),B.useEffect(()=>{const C=()=>{h||p(!0)};return n.on("roomInfo",C),()=>{n.off("roomInfo",C)}},[n,h]);const g=[{id:"room-tab",label:"Room",content:K.jsx(bZ,{client:n}),condition:h},{id:"inventory-tab",label:"Inventory",content:K.jsx(CZ,{client:n}),condition:l},{id:"users-tab",label:"Users",content:K.jsx(vZ,{users:i}),condition:!0},{id:"midi-tab",label:"MIDI",content:K.jsx(IZ,{client:n}),condition:o.midi.enabled},{id:"files-tab",label:"Files",content:K.jsx(V9,{client:n,expanded:c}),condition:!0},{id:"audio-tab",label:"Audio",content:K.jsx(gZ,{client:n}),condition:!0}],y=Cn.useMemo(()=>g.filter(C=>C.condition??!0),[h,l,o.midi.enabled]);return Cn.useImperativeHandle(r,()=>({switchToTab:C=>{var x;if(C>=0&&C<y.length){const w=(x=y[C])==null?void 0:x.id;if(w){console.log(`switchToTab: Trying index ${C}, ID: ${w}`);const S=document.getElementById(w);S?(console.log("switchToTab: Found button element, attempting click..."),S.click(),console.log("switchToTab: Click simulation finished.")):console.error(`switchToTab: Could not find button element with ID: ${w}`)}else console.warn(`switchToTab: Could not determine targetTabId for index ${C}. Visible tabs:`,y)}else console.warn(`switchToTab: Invalid targetIndex ${C}. Visible tabs count: ${y.length}`)}}),[y]),B.useEffect(()=>{const C=()=>s(!0);return n.on("fileTransferOffer",C),()=>{n.off("fileTransferOffer",C)}},[n]),K.jsxs("div",{className:`sidebar ${e?"collapsed":""}`,children:[" ",K.jsxs("button",{className:"sidebar-collapse-btn",onClick:t,title:e?"Expand sidebar":"Collapse sidebar","aria-label":e?"Expand sidebar":"Collapse sidebar",children:[e?K.jsx(VT,{}):K.jsx(GT,{}),K.jsx("span",{children:e?"Expand":"Collapse"})]}),!e&&K.jsxs("div",{className:"sidebar-content",children:[K.jsx(lT,{tabs:y})," "]})]})}),SZ=({client:n})=>{const[e,t]=B.useState("Not connected"),[r,i]=B.useState(null),o=B.useCallback(g=>t(g),[]),c=B.useCallback(()=>t("Connected"),[]),s=B.useCallback(()=>{t("Disconnected"),i(null)},[]),l=B.useCallback(g=>i(g),[]);B.useEffect(()=>(n.on("statustext",o),n.on("connect",c),n.on("disconnect",s),n.on("vitals",l),()=>{n.off("statustext",o),n.off("connect",c),n.off("disconnect",s),n.off("vitals",l)}),[n,o,c,s,l]);const d=(g,y)=>g===void 0||y===void 0?null:`${g}/${y}`,h=d(r==null?void 0:r.hp,r==null?void 0:r.maxhp),p=d(r==null?void 0:r.mp,r==null?void 0:r.maxmp);return K.jsxs("div",{className:"statusbar",children:[K.jsx("span",{className:"status-connection",children:e}),r&&K.jsxs("span",{className:"status-vitals",children:[h&&` HP: ${h}`,p&&` MP: ${p}`]})]})},AZ=({client:n,onClearLog:e,onSaveLog:t,onCopyLog:r,onToggleSidebar:i,onOpenPrefs:o,showSidebar:c})=>{const s=If(n,"connectionChange",n.connected),[l,d]=Cn.useState(n.cacophony.muted),h=If(n,"autosayChanged",n.autosay)||!1,[p,g]=Cn.useState(dr.getState().sound.volume),y=B.useCallback(()=>{const S=!l;d(S),n.setGlobalMute(S)},[l,n]),C=B.useCallback(S=>{const E=Number(S.target.value)/100;g(E),n.cacophony.setGlobalVolume(E),dr.dispatch({type:es.SetSound,data:{...dr.getState().sound,volume:E}})},[n]),x=B.useCallback(S=>{n.autosay=S.target.checked},[n]),w=B.useCallback(()=>{s?n.close():n.connect()},[s,n]);return K.jsxs("div",{className:"toolbar",children:[K.jsxs("button",{onClick:t,accessKey:"l",children:[K.jsx(WT,{}),"Save Log (Alt+L)"]}),K.jsxs("button",{onClick:r,accessKey:"C",children:[K.jsx(D9,{}),"Copy Log (Alt+Shift+C)"]}),K.jsxs("button",{onClick:e,accessKey:"E",children:[" ",K.jsx(M9,{}),"Clear Log (Alt+E)"]}),K.jsxs("button",{onClick:o,accessKey:"p",children:[K.jsx(_9,{}),"Preferences (Alt+P)"]}),K.jsxs("button",{onClick:y,accessKey:"M",children:[l?K.jsx(F9,{}):K.jsx(O9,{}),l?"Unmute":"Mute"]}),K.jsxs("label",{children:["Volume",K.jsx("input",{type:"range",min:"0",max:"100",value:p*100,onChange:C,accessKey:"V"})]}),K.jsxs("label",{children:[K.jsx(R9,{}),"Autosay",K.jsx("input",{type:"checkbox",checked:h,onChange:x})]}),K.jsx("button",{onClick:w,children:s?"Disconnect":"Connect"}),K.jsxs("button",{onClick:i,accessKey:"U",title:c?"Hide Sidebar (Alt+U)":"Show Sidebar (Alt+U)","aria-label":c?"Hide Sidebar":"Show Sidebar","aria-expanded":c,children:[c?K.jsx(GT,{}):K.jsx(VT,{}),c?"Hide Sidebar":"Show Sidebar"]})]})};function kZ(){const[n,e]=B.useState(null),[t,r]=B.useState(!1),[i,o]=B.useState(!1),[c,s]=B.useState(!1),[l,d]=B.useState(!1);If(n,"userlist",[]);const h=Cn.useRef(null),p=Cn.useRef(null),g=Cn.useRef(null),y=Cn.useRef(null),C=B.useRef(!1),x=()=>{h.current&&h.current.saveLog()},w=()=>{h.current&&h.current.clearLog()},S=()=>{h.current&&h.current.copyLog()},E=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);B.useEffect(()=>{if(C.current)return;const _=new PL("mongoose.moo.mud.org",8765);_.registerGMCPPackage(VF),_.registerGMCPPackage(EF),_.registerGMCPPackage(BF),_.registerGMCPPackage(LF),_.registerGMCPPackage(SM),_.registerGMCPPackage(GF),_.registerGMCPPackage(UF),_.registerGMCPPackage(jF),_.registerGMCPPackage(D3),_.registerGMCPPackage(bM),_.registerGMCPPackage(L3),_.registerGMCPPackage(kk),_.registerGMCPPackage(HF),_.registerGMCPPackage(N3),_.registerGMCPPackage(Ak),_.registerGMCPPackage(P3),_.registerGMCPPackage(M3),_.registerGMCPPackage(O3),_.registerGMCPPackage(F3),_.registerGMCPPackage(B3),_.registerGMCPPackage(WF),_.registerGMCPPackage(zF),_.registerGMCPPackage(ZF),_.registerGMCPPackage(XF),_.registerGMCPPackage($F),_.registerGMCPPackage(KF),_.registerGMCPPackage(qF),_.registerMcpPackage(eB),_.registerMcpPackage(tB),_.registerMcpPackage(rB),_.registerMcpPackage(iB),_.connect(),_.requestNotificationPermission();const D=new URLSearchParams(window.location.search),j=D.get("username"),Z=D.get("password");j&&Z&&_.once("connect",()=>{console.log("Auto-logging in with URL params..."),setTimeout(()=>{_.sendCommand(j),setTimeout(()=>{_.sendCommand(Z)},500)},1e3)}),e(_),r(!E),window.mudClient=_,C.current=!0,Qs.initialize().then(X=>{console.log(X?"Virtual MIDI synthesizer initialized":"Failed to initialize virtual MIDI synthesizer")}).catch(X=>{console.error("Error initializing virtual MIDI synthesizer:",X)});const F=X=>{if(_&&(X.key==="Control"&&_.cancelSpeech(),X.key==="Escape")){_.stopAllSounds();const te=_.gmcpHandlers["Client.Midi"];te&&te.sendAllNotesOff()}};window.addEventListener("keydown",F);const V=()=>{var X;(X=p.current)==null||X.focus()};return document.addEventListener("focus",V),()=>{window.removeEventListener("keydown",F),document.removeEventListener("focus",V)}},[E]),B.useEffect(()=>{const _=D=>{var Z;if(!t||!D.ctrlKey)return;const j=parseInt(D.key,10);if(!isNaN(j)&&j>=1&&j<=9){const F=j-1;D.preventDefault(),console.log(`App: Detected CTRL+${j}, calling switchToTab(${F})`),(Z=y.current)==null||Z.switchToTab(F)}};return document.addEventListener("keydown",_,!0),()=>{document.removeEventListener("keydown",_,!0)}},[t]);const R=If(n,"fileTransferOffer",null),k=B.useCallback(_=>{n&&n.sendCommand(_)},[n]),A=B.useCallback(()=>{var _;(_=p.current)==null||_.focus()},[]);return B.useEffect(()=>{R!==null&&(d(!0),s(!0),n==null||n.sendNotification("File Transfer Offer",`${R.sender} wants to send you ${R.filename} (${Math.round(R.filesize/1024)} KB)`))},[R,n]),Sk(_=>{n&&n.shutdown()}),B.useEffect(()=>{var _;(_=p.current)==null||_.focus()},[]),n?K.jsxs("div",{className:`App ${t?i?"sidebar-collapsed":"sidebar-shown":""}`,children:[K.jsx("header",{role:"banner",style:{gridArea:"header"},children:K.jsx(AZ,{client:n,onSaveLog:x,onClearLog:w,onCopyLog:S,onToggleSidebar:()=>r(!t),onOpenPrefs:()=>{var _;return(_=g.current)==null?void 0:_.open()},showSidebar:t})}),K.jsx("main",{role:"main",style:{gridArea:"main"},children:K.jsx(Iy,{client:n,ref:h,focusInput:A})}),K.jsx("div",{role:"region","aria-label":"Command input",style:{gridArea:"input"},children:K.jsx(FL,{onSend:k,inputRef:p,client:n})}),t&&K.jsx("aside",{role:"complementary","aria-roledescription":"Sidebar",style:{gridArea:"sidebar"},children:K.jsx(wZ,{ref:y,client:n,collapsed:i,onToggleCollapse:()=>o(!i)})}),K.jsx("footer",{role:"contentinfo",style:{gridArea:"status"},children:K.jsx(SZ,{client:n})}),K.jsx(b9,{ref:g})]}):null}function EZ(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qA(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function YA(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qA(Object(t),!0).forEach(function(r){EZ(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qA(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function TZ(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function _Z(n,e){if(n==null)return{};var t=TZ(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function RZ(n,e){return DZ(n)||PZ(n,e)||MZ(n,e)||NZ()}function DZ(n){if(Array.isArray(n))return n}function PZ(n,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(n)))){var t=[],r=!0,i=!1,o=void 0;try{for(var c=n[Symbol.iterator](),s;!(r=(s=c.next()).done)&&(t.push(s.value),!(e&&t.length===e));r=!0);}catch(l){i=!0,o=l}finally{try{!r&&c.return!=null&&c.return()}finally{if(i)throw o}}return t}}function MZ(n,e){if(n){if(typeof n=="string")return QA(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return QA(n,e)}}function QA(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function NZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OZ(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function JA(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function ek(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?JA(Object(t),!0).forEach(function(r){OZ(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):JA(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function FZ(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(r){return e.reduceRight(function(i,o){return o(i)},r)}}function Kd(n){return function e(){for(var t=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=n.length?n.apply(this,i):function(){for(var c=arguments.length,s=new Array(c),l=0;l<c;l++)s[l]=arguments[l];return e.apply(t,[].concat(i,s))}}}function Wp(n){return{}.toString.call(n).includes("Object")}function BZ(n){return!Object.keys(n).length}function wf(n){return typeof n=="function"}function LZ(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function UZ(n,e){return Wp(e)||Rc("changeType"),Object.keys(e).some(function(t){return!LZ(n,t)})&&Rc("changeField"),e}function jZ(n){wf(n)||Rc("selectorType")}function VZ(n){wf(n)||Wp(n)||Rc("handlerType"),Wp(n)&&Object.values(n).some(function(e){return!wf(e)})&&Rc("handlersType")}function GZ(n){n||Rc("initialIsRequired"),Wp(n)||Rc("initialType"),BZ(n)&&Rc("initialContent")}function WZ(n,e){throw new Error(n[e]||n.default)}var zZ={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Rc=Kd(WZ)(zZ),Yh={changes:UZ,selector:jZ,handler:VZ,initial:GZ};function HZ(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Yh.initial(n),Yh.handler(e);var t={current:n},r=Kd($Z)(t,e),i=Kd(XZ)(t),o=Kd(Yh.changes)(n),c=Kd(ZZ)(t);function s(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(h){return h};return Yh.selector(d),d(t.current)}function l(d){FZ(r,i,o,c)(d)}return[s,l]}function ZZ(n,e){return wf(e)?e(n.current):e}function XZ(n,e){return n.current=ek(ek({},n.current),e),e}function $Z(n,e,t){return wf(e)?e(n.current):Object.keys(t).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,n.current[r])}),t}var KZ={create:HZ},qZ={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function YZ(n){return function e(){for(var t=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return i.length>=n.length?n.apply(this,i):function(){for(var c=arguments.length,s=new Array(c),l=0;l<c;l++)s[l]=arguments[l];return e.apply(t,[].concat(i,s))}}}function QZ(n){return{}.toString.call(n).includes("Object")}function JZ(n){return n||tk("configIsRequired"),QZ(n)||tk("configType"),n.urls?(eX(),{paths:{vs:n.urls.monacoBase}}):n}function eX(){console.warn(TR.deprecation)}function tX(n,e){throw new Error(n[e]||n.default)}var TR={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},tk=YZ(tX)(TR),nX={config:JZ},rX=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(i){return t.reduceRight(function(o,c){return c(o)},i)}};function _R(n,e){return Object.keys(e).forEach(function(t){e[t]instanceof Object&&n[t]&&Object.assign(e[t],_R(n[t],e[t]))}),YA(YA({},n),e)}var iX={type:"cancelation",msg:"operation is manually canceled"};function jv(n){var e=!1,t=new Promise(function(r,i){n.then(function(o){return e?i(iX):r(o)}),n.catch(i)});return t.cancel=function(){return e=!0},t}var oX=KZ.create({config:qZ,isInitialized:!1,resolve:null,reject:null,monaco:null}),RR=RZ(oX,2),Vf=RR[0],yg=RR[1];function sX(n){var e=nX.config(n),t=e.monaco,r=_Z(e,["monaco"]);yg(function(i){return{config:_R(i.config,r),monaco:t}})}function aX(){var n=Vf(function(e){var t=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:t,isInitialized:r,resolve:i}});if(!n.isInitialized){if(yg({isInitialized:!0}),n.monaco)return n.resolve(n.monaco),jv(Vv);if(window.monaco&&window.monaco.editor)return DR(window.monaco),n.resolve(window.monaco),jv(Vv);rX(cX,uX)(dX)}return jv(Vv)}function cX(n){return document.body.appendChild(n)}function lX(n){var e=document.createElement("script");return n&&(e.src=n),e}function uX(n){var e=Vf(function(r){var i=r.config,o=r.reject;return{config:i,reject:o}}),t=lX("".concat(e.config.paths.vs,"/loader.js"));return t.onload=function(){return n()},t.onerror=e.reject,t}function dX(){var n=Vf(function(t){var r=t.config,i=t.resolve,o=t.reject;return{config:r,resolve:i,reject:o}}),e=window.require;e.config(n.config),e(["vs/editor/editor.main"],function(t){DR(t),n.resolve(t)},function(t){n.reject(t)})}function DR(n){Vf().monaco||yg({monaco:n})}function fX(){return Vf(function(n){var e=n.monaco;return e})}var Vv=new Promise(function(n,e){return yg({resolve:n,reject:e})}),PR={config:sX,init:aX,__getMonacoInstance:fX},hX={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Gv=hX,pX={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},gX=pX;function mX({children:n}){return Cn.createElement("div",{style:gX.container},n)}var vX=mX,yX=vX;function CX({width:n,height:e,isEditorReady:t,loading:r,_ref:i,className:o,wrapperProps:c}){return Cn.createElement("section",{style:{...Gv.wrapper,width:n,height:e},...c},!t&&Cn.createElement(yX,null,r),Cn.createElement("div",{ref:i,style:{...Gv.fullWidth,...!t&&Gv.hide},className:o}))}var xX=CX,MR=B.memo(xX);function bX(n){B.useEffect(n,[])}var NR=bX;function IX(n,e,t=!0){let r=B.useRef(!0);B.useEffect(r.current||!t?()=>{r.current=!1}:n,e)}var Mo=IX;function tf(){}function yu(n,e,t,r){return wX(n,r)||SX(n,e,t,r)}function wX(n,e){return n.editor.getModel(OR(n,e))}function SX(n,e,t,r){return n.editor.createModel(e,t,r?OR(n,r):void 0)}function OR(n,e){return n.Uri.parse(e)}function AX({original:n,modified:e,language:t,originalLanguage:r,modifiedLanguage:i,originalModelPath:o,modifiedModelPath:c,keepCurrentOriginalModel:s=!1,keepCurrentModifiedModel:l=!1,theme:d="light",loading:h="Loading...",options:p={},height:g="100%",width:y="100%",className:C,wrapperProps:x={},beforeMount:w=tf,onMount:S=tf}){let[E,R]=B.useState(!1),[k,A]=B.useState(!0),_=B.useRef(null),D=B.useRef(null),j=B.useRef(null),Z=B.useRef(S),F=B.useRef(w),V=B.useRef(!1);NR(()=>{let ve=PR.init();return ve.then(Ie=>(D.current=Ie)&&A(!1)).catch(Ie=>(Ie==null?void 0:Ie.type)!=="cancelation"&&console.error("Monaco initialization: error:",Ie)),()=>_.current?pe():ve.cancel()}),Mo(()=>{if(_.current&&D.current){let ve=_.current.getOriginalEditor(),Ie=yu(D.current,n||"",r||t||"text",o||"");Ie!==ve.getModel()&&ve.setModel(Ie)}},[o],E),Mo(()=>{if(_.current&&D.current){let ve=_.current.getModifiedEditor(),Ie=yu(D.current,e||"",i||t||"text",c||"");Ie!==ve.getModel()&&ve.setModel(Ie)}},[c],E),Mo(()=>{let ve=_.current.getModifiedEditor();ve.getOption(D.current.editor.EditorOption.readOnly)?ve.setValue(e||""):e!==ve.getValue()&&(ve.executeEdits("",[{range:ve.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),ve.pushUndoStop())},[e],E),Mo(()=>{var ve,Ie;(Ie=(ve=_.current)==null?void 0:ve.getModel())==null||Ie.original.setValue(n||"")},[n],E),Mo(()=>{let{original:ve,modified:Ie}=_.current.getModel();D.current.editor.setModelLanguage(ve,r||t||"text"),D.current.editor.setModelLanguage(Ie,i||t||"text")},[t,r,i],E),Mo(()=>{var ve;(ve=D.current)==null||ve.editor.setTheme(d)},[d],E),Mo(()=>{var ve;(ve=_.current)==null||ve.updateOptions(p)},[p],E);let X=B.useCallback(()=>{var Re;if(!D.current)return;F.current(D.current);let ve=yu(D.current,n||"",r||t||"text",o||""),Ie=yu(D.current,e||"",i||t||"text",c||"");(Re=_.current)==null||Re.setModel({original:ve,modified:Ie})},[t,e,i,n,r,o,c]),te=B.useCallback(()=>{var ve;!V.current&&j.current&&(_.current=D.current.editor.createDiffEditor(j.current,{automaticLayout:!0,...p}),X(),(ve=D.current)==null||ve.editor.setTheme(d),R(!0),V.current=!0)},[p,d,X]);B.useEffect(()=>{E&&Z.current(_.current,D.current)},[E]),B.useEffect(()=>{!k&&!E&&te()},[k,E,te]);function pe(){var Ie,Re,xe,Ae;let ve=(Ie=_.current)==null?void 0:Ie.getModel();s||((Re=ve==null?void 0:ve.original)==null||Re.dispose()),l||((xe=ve==null?void 0:ve.modified)==null||xe.dispose()),(Ae=_.current)==null||Ae.dispose()}return Cn.createElement(MR,{width:y,height:g,isEditorReady:E,loading:h,_ref:j,className:C,wrapperProps:x})}var kX=AX;B.memo(kX);function EX(n){let e=B.useRef();return B.useEffect(()=>{e.current=n},[n]),e.current}var TX=EX,Qh=new Map;function _X({defaultValue:n,defaultLanguage:e,defaultPath:t,value:r,language:i,path:o,theme:c="light",line:s,loading:l="Loading...",options:d={},overrideServices:h={},saveViewState:p=!0,keepCurrentModel:g=!1,width:y="100%",height:C="100%",className:x,wrapperProps:w={},beforeMount:S=tf,onMount:E=tf,onChange:R,onValidate:k=tf}){let[A,_]=B.useState(!1),[D,j]=B.useState(!0),Z=B.useRef(null),F=B.useRef(null),V=B.useRef(null),X=B.useRef(E),te=B.useRef(S),pe=B.useRef(),ve=B.useRef(r),Ie=TX(o),Re=B.useRef(!1),xe=B.useRef(!1);NR(()=>{let H=PR.init();return H.then(ee=>(Z.current=ee)&&j(!1)).catch(ee=>(ee==null?void 0:ee.type)!=="cancelation"&&console.error("Monaco initialization: error:",ee)),()=>F.current?ke():H.cancel()}),Mo(()=>{var ee,ae,ye,Ee;let H=yu(Z.current,n||r||"",e||i||"",o||t||"");H!==((ee=F.current)==null?void 0:ee.getModel())&&(p&&Qh.set(Ie,(ae=F.current)==null?void 0:ae.saveViewState()),(ye=F.current)==null||ye.setModel(H),p&&((Ee=F.current)==null||Ee.restoreViewState(Qh.get(o))))},[o],A),Mo(()=>{var H;(H=F.current)==null||H.updateOptions(d)},[d],A),Mo(()=>{!F.current||r===void 0||(F.current.getOption(Z.current.editor.EditorOption.readOnly)?F.current.setValue(r):r!==F.current.getValue()&&(xe.current=!0,F.current.executeEdits("",[{range:F.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),F.current.pushUndoStop(),xe.current=!1))},[r],A),Mo(()=>{var ee,ae;let H=(ee=F.current)==null?void 0:ee.getModel();H&&i&&((ae=Z.current)==null||ae.editor.setModelLanguage(H,i))},[i],A),Mo(()=>{var H;s!==void 0&&((H=F.current)==null||H.revealLine(s))},[s],A),Mo(()=>{var H;(H=Z.current)==null||H.editor.setTheme(c)},[c],A);let Ae=B.useCallback(()=>{var H;if(!(!V.current||!Z.current)&&!Re.current){te.current(Z.current);let ee=o||t,ae=yu(Z.current,r||n||"",e||i||"",ee||"");F.current=(H=Z.current)==null?void 0:H.editor.create(V.current,{model:ae,automaticLayout:!0,...d},h),p&&F.current.restoreViewState(Qh.get(ee)),Z.current.editor.setTheme(c),s!==void 0&&F.current.revealLine(s),_(!0),Re.current=!0}},[n,e,t,r,i,o,d,h,p,c,s]);B.useEffect(()=>{A&&X.current(F.current,Z.current)},[A]),B.useEffect(()=>{!D&&!A&&Ae()},[D,A,Ae]),ve.current=r,B.useEffect(()=>{var H,ee;A&&R&&((H=pe.current)==null||H.dispose(),pe.current=(ee=F.current)==null?void 0:ee.onDidChangeModelContent(ae=>{xe.current||R(F.current.getValue(),ae)}))},[A,R]),B.useEffect(()=>{if(A){let H=Z.current.editor.onDidChangeMarkers(ee=>{var ye;let ae=(ye=F.current.getModel())==null?void 0:ye.uri;if(ae&&ee.find(Ee=>Ee.path===ae.path)){let Ee=Z.current.editor.getModelMarkers({resource:ae});k==null||k(Ee)}});return()=>{H==null||H.dispose()}}return()=>{}},[A,k]);function ke(){var H,ee;(H=pe.current)==null||H.dispose(),g?p&&Qh.set(o,F.current.saveViewState()):(ee=F.current.getModel())==null||ee.dispose(),F.current.dispose()}return Cn.createElement(MR,{width:y,height:C,isEditorReady:A,loading:l,_ref:V,className:x,wrapperProps:w})}var RX=_X,DX=B.memo(RX),PX=DX,MX={restoreOnUnmount:!1};function NX(n,e){e===void 0&&(e=MX);var t=B.useRef(document.title);document.title!==n&&(document.title=n),B.useEffect(function(){if(e&&e.restoreOnUnmount)return function(){document.title=t.current}},[])}const OX=typeof document<"u"?NX:function(n){};function FX({onSave:n,onRevert:e,onDownload:t}){return K.jsx("div",{className:"editor-toolbar",children:K.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[K.jsxs("button",{onClick:n,accessKey:"s",title:"Save (Alt+S)",children:[K.jsx(WT,{"aria-hidden":"true"}),"Save"]}),K.jsxs("button",{onClick:e,accessKey:"r",title:"Revert (Alt+R)",children:[K.jsx(N9,{"aria-hidden":"true"}),"Revert"]}),K.jsxs("button",{onClick:t,accessKey:"d",title:"Download (Alt+D)",children:[K.jsx(P9,{"aria-hidden":"true"}),"Download"]})]})})}const BX=({docstate:n,session:e})=>K.jsxs("div",{"aria-live":"polite",className:"editor-statusbar",children:[K.jsx("span",{children:n}),K.jsx("span",{"aria-hidden":"true",children:"|"}),K.jsx("span",{children:e.reference}),K.jsx("span",{"aria-hidden":"true",children:"|"}),K.jsx("span",{children:e.type})]});function LX(){const n=Ik(),e=Cn.useRef(null),[t,r]=B.useState(""),[i,o]=B.useState(""),[c,s]=B.useState(""),[l,d]=B.useState(0),[h,p]=B.useState({name:"none",contents:[],reference:"",type:""}),g=(te,pe)=>{e.current=te},[y,C]=Bo();console.log(y);const x=y.editor.accessibilityMode,w=y.editor.autocompleteEnabled;Sk(te=>{A.postMessage({type:"close",id:D}),l===1&&te.preventDefault()});const[S,E]=B.useState(!1),R=S?`${h.name} - Mongoose Editor`:"Mongoose Editor";OX(R);const k=B.useMemo(()=>{switch(l){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[l]),A=B.useMemo(()=>new BroadcastChannel("editor"),[]),_=new URLSearchParams(n.search),D=decodeURIComponent(_.get("reference")||"");B.useEffect(()=>{if(!D)return;console.log("ID: "+D),console.log("Sending ready message"),A.postMessage({type:"ready",id:D});const te=pe=>{switch(console.log(pe.data),pe.data.type){case"load":if(t!=="")return;const ve=pe.data.session.contents.join(`
`);o(ve),s(ve),p(pe.data.session),d(0),r(pe.data.clientId),E(!0),setTimeout(X,100);break;case"shutdown":if(console.log("Received shutdown message"),l===1&&!window.confirm("You have unsaved changes. Are you sure you want to close this editor?"))return;A.close(),window.close();break;default:console.warn("Unknown message type received",pe.data.type)}};return A.addEventListener("message",te),()=>{A.removeEventListener("message",te),A.postMessage({type:"close",id:D})}},[A,t,D,l]);const j=()=>{o(c),d(0)},Z=te=>{const pe=i.split(/\r\n|\r|\n/),ve={...h,contents:pe};A.postMessage({type:"save",session:ve,id:D}),d(2),X(),te.preventDefault()},F=te=>{te!==void 0&&(console.log("Original: "+c),console.log("New: "+te),o(te),te.split(/\r\n|\r|\n/).join(`
`)!==c?d(1):d(0),S||E(!0))},V=()=>{const te=new Blob([i],{type:"text/plain"}),pe=URL.createObjectURL(te),ve=document.createElement("a"),Ie=new Date,Re=Ie.toLocaleDateString().replace(/\//g,"-"),xe=Ie.toLocaleTimeString().replace(/:/g,"-"),Ae=`${h.name}-${Re}-${xe}.txt`;ve.download=Ae,ve.href=pe,ve.click(),URL.revokeObjectURL(pe),ve.remove()};return K.jsxs("div",{id:"editor-window",children:[K.jsx(FX,{onSave:Z,onRevert:j,onDownload:V}),K.jsx(PX,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:F,options:{wordWrap:"on",accessibilitySupport:x?"on":"off",quickSuggestions:w},onMount:g,path:h.reference}),K.jsx(BX,{docstate:k,session:h})]});function X(){e.current!==null&&e.current.focus()}}const UX="modulepreload",jX=function(n){return"/"+n},nk={},FR=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let c=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),l=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=c(t.map(d=>{if(d=jX(d),d in nk)return;nk[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":UX,h||(g.as="script"),g.crossOrigin="",g.href=d,l&&g.setAttribute("nonce",l),document.head.appendChild(g),h)return new Promise((y,C)=>{g.addEventListener("load",y),g.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(c){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=c,window.dispatchEvent(s),!s.defaultPrevented)throw c}return i.then(c=>{for(const s of c||[])s.status==="rejected"&&o(s.reason);return e().catch(o)})},VX=n=>{n&&n instanceof Function&&FR(async()=>{const{getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:o}=await import("./web-vitals-CFnx-5Zt.js");return{getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:o}},[]).then(({getCLS:e,getFID:t,getFCP:r,getLCP:i,getTTFB:o})=>{e(n),t(n),r(n),i(n),o(n)})};function GX(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:o,onRegisterError:c}=n;let s,l;const d=async(p=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(s=await FR(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/sw.js",{scope:"/",type:"classic"})).catch(p=>{c==null||c(p)}),!s)return;s.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),s.addEventListener("installed",p=>{p.isUpdate||r==null||r()}),s.register({immediate:e}).then(p=>{o?o("/sw.js",p):i==null||i(p)}).catch(p=>{c==null||c(p)})}}return l=h(),d}const WX=c3([{path:"/",element:K.jsx(kZ,{})},{path:"/editor",element:K.jsx(LX,{})}]),zX=ZD.createRoot(document.getElementById("root"));zX.render(K.jsx(Cn.StrictMode,{children:K.jsx(v3,{router:WX})}));VX(console.log);GX();

var TB=Object.defineProperty;var _B=(e,t,n)=>t in e?TB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var V=(e,t,n)=>(_B(e,typeof t!="symbol"?t+"":t,n),n),ty=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var M=(e,t,n)=>(ty(e,t,"read from private field"),n?n.call(e):t.get(e)),De=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Ae=(e,t,n,r)=>(ty(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);var Dh=(e,t,n,r)=>({set _(i){Ae(e,t,i,n)},get _(){return M(e,t,r)}}),Se=(e,t,n)=>(ty(e,t,"access private method"),n);function S_(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var RB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ch(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var b_={exports:{}},Nm={},w_={exports:{}},$e={},lh=Symbol.for("react.element"),xB=Symbol.for("react.portal"),NB=Symbol.for("react.fragment"),PB=Symbol.for("react.strict_mode"),MB=Symbol.for("react.profiler"),OB=Symbol.for("react.provider"),DB=Symbol.for("react.context"),LB=Symbol.for("react.forward_ref"),BB=Symbol.for("react.suspense"),FB=Symbol.for("react.memo"),UB=Symbol.for("react.lazy"),nk=Symbol.iterator;function VB(e){return e===null||typeof e!="object"?null:(e=nk&&e[nk]||e["@@iterator"],typeof e=="function"?e:null)}var k_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A_=Object.assign,E_={};function Wu(e,t,n){this.props=e,this.context=t,this.refs=E_,this.updater=n||k_}Wu.prototype.isReactComponent={};Wu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Wu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function T_(){}T_.prototype=Wu.prototype;function cS(e,t,n){this.props=e,this.context=t,this.refs=E_,this.updater=n||k_}var lS=cS.prototype=new T_;lS.constructor=cS;A_(lS,Wu.prototype);lS.isPureReactComponent=!0;var rk=Array.isArray,__=Object.prototype.hasOwnProperty,uS={current:null},R_={key:!0,ref:!0,__self:!0,__source:!0};function x_(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)__.call(t,r)&&!R_.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:lh,type:e,key:s,ref:o,props:i,_owner:uS.current}}function GB(e,t){return{$$typeof:lh,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function dS(e){return typeof e=="object"&&e!==null&&e.$$typeof===lh}function WB(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ik=/\/+/g;function ny(e,t){return typeof e=="object"&&e!==null&&e.key!=null?WB(""+e.key):t.toString(36)}function wp(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case lh:case xB:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+ny(o,0):r,rk(i)?(n="",e!=null&&(n=e.replace(ik,"$&/")+"/"),wp(i,t,n,"",function(l){return l})):i!=null&&(dS(i)&&(i=GB(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(ik,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",rk(e))for(var a=0;a<e.length;a++){s=e[a];var c=r+ny(s,a);o+=wp(s,t,n,c,i)}else if(c=VB(e),typeof c=="function")for(e=c.call(e),a=0;!(s=e.next()).done;)s=s.value,c=r+ny(s,a++),o+=wp(s,t,n,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Lh(e,t,n){if(e==null)return e;var r=[],i=0;return wp(e,r,"","",function(s){return t.call(n,s,i++)}),r}function jB(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var gr={current:null},kp={transition:null},HB={ReactCurrentDispatcher:gr,ReactCurrentBatchConfig:kp,ReactCurrentOwner:uS};$e.Children={map:Lh,forEach:function(e,t,n){Lh(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Lh(e,function(){t++}),t},toArray:function(e){return Lh(e,function(t){return t})||[]},only:function(e){if(!dS(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};$e.Component=Wu;$e.Fragment=NB;$e.Profiler=MB;$e.PureComponent=cS;$e.StrictMode=PB;$e.Suspense=BB;$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HB;$e.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=A_({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=uS.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)__.call(t,c)&&!R_.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:lh,type:e.type,key:i,ref:s,props:r,_owner:o}};$e.createContext=function(e){return e={$$typeof:DB,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:OB,_context:e},e.Consumer=e};$e.createElement=x_;$e.createFactory=function(e){var t=x_.bind(null,e);return t.type=e,t};$e.createRef=function(){return{current:null}};$e.forwardRef=function(e){return{$$typeof:LB,render:e}};$e.isValidElement=dS;$e.lazy=function(e){return{$$typeof:UB,_payload:{_status:-1,_result:e},_init:jB}};$e.memo=function(e,t){return{$$typeof:FB,type:e,compare:t===void 0?null:t}};$e.startTransition=function(e){var t=kp.transition;kp.transition={};try{e()}finally{kp.transition=t}};$e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};$e.useCallback=function(e,t){return gr.current.useCallback(e,t)};$e.useContext=function(e){return gr.current.useContext(e)};$e.useDebugValue=function(){};$e.useDeferredValue=function(e){return gr.current.useDeferredValue(e)};$e.useEffect=function(e,t){return gr.current.useEffect(e,t)};$e.useId=function(){return gr.current.useId()};$e.useImperativeHandle=function(e,t,n){return gr.current.useImperativeHandle(e,t,n)};$e.useInsertionEffect=function(e,t){return gr.current.useInsertionEffect(e,t)};$e.useLayoutEffect=function(e,t){return gr.current.useLayoutEffect(e,t)};$e.useMemo=function(e,t){return gr.current.useMemo(e,t)};$e.useReducer=function(e,t,n){return gr.current.useReducer(e,t,n)};$e.useRef=function(e){return gr.current.useRef(e)};$e.useState=function(e){return gr.current.useState(e)};$e.useSyncExternalStore=function(e,t,n){return gr.current.useSyncExternalStore(e,t,n)};$e.useTransition=function(){return gr.current.useTransition()};$e.version="18.2.0";w_.exports=$e;var w=w_.exports;const vt=ch(w),$B=S_({__proto__:null,default:vt},[w]);var zB=w,ZB=Symbol.for("react.element"),XB=Symbol.for("react.fragment"),KB=Object.prototype.hasOwnProperty,JB=zB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,YB={key:!0,ref:!0,__self:!0,__source:!0};function N_(e,t,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)KB.call(t,r)&&!YB.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:ZB,type:e,key:s,ref:o,props:i,_owner:JB.current}}Nm.Fragment=XB;Nm.jsx=N_;Nm.jsxs=N_;b_.exports=Nm;var J=b_.exports,S0={},P_={exports:{}},ti={},M_={exports:{}},O_={};(function(e){function t(W,X){var ne=W.length;W.push(X);e:for(;0<ne;){var Z=ne-1>>>1,ie=W[Z];if(0<i(ie,X))W[Z]=X,W[ne]=ie,ne=Z;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var X=W[0],ne=W.pop();if(ne!==X){W[0]=ne;e:for(var Z=0,ie=W.length,ke=ie>>>1;Z<ke;){var Ee=2*(Z+1)-1,ge=W[Ee],Te=Ee+1,Qe=W[Te];if(0>i(ge,ne))Te<ie&&0>i(Qe,ge)?(W[Z]=Qe,W[Te]=ne,Z=Te):(W[Z]=ge,W[Ee]=ne,Z=Ee);else if(Te<ie&&0>i(Qe,ne))W[Z]=Qe,W[Te]=ne,Z=Te;else break e}}return X}function i(W,X){var ne=W.sortIndex-X.sortIndex;return ne!==0?ne:W.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var c=[],l=[],u=1,d=null,f=3,h=!1,p=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var X=n(l);X!==null;){if(X.callback===null)r(l);else if(X.startTime<=W)r(l),X.sortIndex=X.expirationTime,t(c,X);else break;X=n(l)}}function E(W){if(m=!1,S(W),!p)if(n(c)!==null)p=!0,$(k);else{var X=n(l);X!==null&&q(E,X.startTime-W)}}function k(W,X){p=!1,m&&(m=!1,g(_),_=-1),h=!0;var ne=f;try{for(S(X),d=n(c);d!==null&&(!(d.expirationTime>X)||W&&!O());){var Z=d.callback;if(typeof Z=="function"){d.callback=null,f=d.priorityLevel;var ie=Z(d.expirationTime<=X);X=e.unstable_now(),typeof ie=="function"?d.callback=ie:d===n(c)&&r(c),S(X)}else r(c);d=n(c)}if(d!==null)var ke=!0;else{var Ee=n(l);Ee!==null&&q(E,Ee.startTime-X),ke=!1}return ke}finally{d=null,f=ne,h=!1}}var b=!1,A=null,_=-1,P=5,N=-1;function O(){return!(e.unstable_now()-N<P)}function D(){if(A!==null){var W=e.unstable_now();N=W;var X=!0;try{X=A(!0,W)}finally{X?U():(b=!1,A=null)}}else b=!1}var U;if(typeof v=="function")U=function(){v(D)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,z=G.port2;G.port1.onmessage=D,U=function(){z.postMessage(null)}}else U=function(){y(D,0)};function $(W){A=W,b||(b=!0,U())}function q(W,X){_=y(function(){W(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,$(k))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(W){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var ne=f;f=X;try{return W()}finally{f=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ne=f;f=W;try{return X()}finally{f=ne}},e.unstable_scheduleCallback=function(W,X,ne){var Z=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?Z+ne:Z):ne=Z,W){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=ne+ie,W={id:u++,callback:X,priorityLevel:W,startTime:ne,expirationTime:ie,sortIndex:-1},ne>Z?(W.sortIndex=ne,t(l,W),n(c)===null&&W===n(l)&&(m?(g(_),_=-1):m=!0,q(E,ne-Z))):(W.sortIndex=ie,t(c,W),p||h||(p=!0,$(k))),W},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(W){var X=f;return function(){var ne=f;f=X;try{return W.apply(this,arguments)}finally{f=ne}}}})(O_);M_.exports=O_;var qB=M_.exports,D_=w,Qr=qB;function oe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var L_=new Set,mf={};function Qc(e,t){Iu(e,t),Iu(e+"Capture",t)}function Iu(e,t){for(mf[e]=t,e=0;e<t.length;e++)L_.add(t[e])}var Do=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),b0=Object.prototype.hasOwnProperty,QB=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sk={},ok={};function eF(e){return b0.call(ok,e)?!0:b0.call(sk,e)?!1:QB.test(e)?ok[e]=!0:(sk[e]=!0,!1)}function tF(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function nF(e,t,n,r){if(t===null||typeof t>"u"||tF(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function mr(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Vn[e]=new mr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Vn[t]=new mr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Vn[e]=new mr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Vn[e]=new mr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Vn[e]=new mr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Vn[e]=new mr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Vn[e]=new mr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Vn[e]=new mr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Vn[e]=new mr(e,5,!1,e.toLowerCase(),null,!1,!1)});var fS=/[\-:]([a-z])/g;function hS(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(fS,hS);Vn[t]=new mr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(fS,hS);Vn[t]=new mr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(fS,hS);Vn[t]=new mr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Vn[e]=new mr(e,1,!1,e.toLowerCase(),null,!1,!1)});Vn.xlinkHref=new mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Vn[e]=new mr(e,1,!1,e.toLowerCase(),null,!0,!0)});function pS(e,t,n,r){var i=Vn.hasOwnProperty(t)?Vn[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(nF(t,n,i,r)&&(n=null),r||i===null?eF(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Zo=D_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Bh=Symbol.for("react.element"),Al=Symbol.for("react.portal"),El=Symbol.for("react.fragment"),gS=Symbol.for("react.strict_mode"),w0=Symbol.for("react.profiler"),B_=Symbol.for("react.provider"),F_=Symbol.for("react.context"),mS=Symbol.for("react.forward_ref"),k0=Symbol.for("react.suspense"),A0=Symbol.for("react.suspense_list"),vS=Symbol.for("react.memo"),ua=Symbol.for("react.lazy"),U_=Symbol.for("react.offscreen"),ak=Symbol.iterator;function ud(e){return e===null||typeof e!="object"?null:(e=ak&&e[ak]||e["@@iterator"],typeof e=="function"?e:null)}var jt=Object.assign,ry;function Pd(e){if(ry===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ry=t&&t[1]||""}return`
`+ry+e}var iy=!1;function sy(e,t){if(!e||iy)return"";iy=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=a);break}}}finally{iy=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Pd(e):""}function rF(e){switch(e.tag){case 5:return Pd(e.type);case 16:return Pd("Lazy");case 13:return Pd("Suspense");case 19:return Pd("SuspenseList");case 0:case 2:case 15:return e=sy(e.type,!1),e;case 11:return e=sy(e.type.render,!1),e;case 1:return e=sy(e.type,!0),e;default:return""}}function E0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case El:return"Fragment";case Al:return"Portal";case w0:return"Profiler";case gS:return"StrictMode";case k0:return"Suspense";case A0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case F_:return(e.displayName||"Context")+".Consumer";case B_:return(e._context.displayName||"Context")+".Provider";case mS:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case vS:return t=e.displayName||null,t!==null?t:E0(e.type)||"Memo";case ua:t=e._payload,e=e._init;try{return E0(e(t))}catch{}}return null}function iF(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return E0(t);case 8:return t===gS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function za(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function V_(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function sF(e){var t=V_(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Fh(e){e._valueTracker||(e._valueTracker=sF(e))}function G_(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=V_(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ug(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function T0(e,t){var n=t.checked;return jt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function ck(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=za(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function W_(e,t){t=t.checked,t!=null&&pS(e,"checked",t,!1)}function _0(e,t){W_(e,t);var n=za(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?R0(e,t.type,n):t.hasOwnProperty("defaultValue")&&R0(e,t.type,za(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function lk(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function R0(e,t,n){(t!=="number"||ug(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Md=Array.isArray;function Kl(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+za(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function x0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(oe(91));return jt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function uk(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(oe(92));if(Md(n)){if(1<n.length)throw Error(oe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:za(n)}}function j_(e,t){var n=za(t.value),r=za(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function dk(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function H_(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function N0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?H_(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Uh,$_=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Uh=Uh||document.createElement("div"),Uh.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Uh.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function vf(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Zd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oF=["Webkit","ms","Moz","O"];Object.keys(Zd).forEach(function(e){oF.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zd[t]=Zd[e]})});function z_(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Zd.hasOwnProperty(e)&&Zd[e]?(""+t).trim():t+"px"}function Z_(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=z_(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var aF=jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function P0(e,t){if(t){if(aF[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(oe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(oe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(oe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(oe(62))}}function M0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var O0=null;function yS(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var D0=null,Jl=null,Yl=null;function fk(e){if(e=fh(e)){if(typeof D0!="function")throw Error(oe(280));var t=e.stateNode;t&&(t=Lm(t),D0(e.stateNode,e.type,t))}}function X_(e){Jl?Yl?Yl.push(e):Yl=[e]:Jl=e}function K_(){if(Jl){var e=Jl,t=Yl;if(Yl=Jl=null,fk(e),t)for(e=0;e<t.length;e++)fk(t[e])}}function J_(e,t){return e(t)}function Y_(){}var oy=!1;function q_(e,t,n){if(oy)return e(t,n);oy=!0;try{return J_(e,t,n)}finally{oy=!1,(Jl!==null||Yl!==null)&&(Y_(),K_())}}function yf(e,t){var n=e.stateNode;if(n===null)return null;var r=Lm(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(oe(231,t,typeof n));return n}var L0=!1;if(Do)try{var dd={};Object.defineProperty(dd,"passive",{get:function(){L0=!0}}),window.addEventListener("test",dd,dd),window.removeEventListener("test",dd,dd)}catch{L0=!1}function cF(e,t,n,r,i,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var Xd=!1,dg=null,fg=!1,B0=null,lF={onError:function(e){Xd=!0,dg=e}};function uF(e,t,n,r,i,s,o,a,c){Xd=!1,dg=null,cF.apply(lF,arguments)}function dF(e,t,n,r,i,s,o,a,c){if(uF.apply(this,arguments),Xd){if(Xd){var l=dg;Xd=!1,dg=null}else throw Error(oe(198));fg||(fg=!0,B0=l)}}function el(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Q_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function hk(e){if(el(e)!==e)throw Error(oe(188))}function fF(e){var t=e.alternate;if(!t){if(t=el(e),t===null)throw Error(oe(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return hk(i),e;if(s===r)return hk(i),t;s=s.sibling}throw Error(oe(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(oe(189))}}if(n.alternate!==r)throw Error(oe(190))}if(n.tag!==3)throw Error(oe(188));return n.stateNode.current===n?e:t}function eR(e){return e=fF(e),e!==null?tR(e):null}function tR(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=tR(e);if(t!==null)return t;e=e.sibling}return null}var nR=Qr.unstable_scheduleCallback,pk=Qr.unstable_cancelCallback,hF=Qr.unstable_shouldYield,pF=Qr.unstable_requestPaint,tn=Qr.unstable_now,gF=Qr.unstable_getCurrentPriorityLevel,CS=Qr.unstable_ImmediatePriority,rR=Qr.unstable_UserBlockingPriority,hg=Qr.unstable_NormalPriority,mF=Qr.unstable_LowPriority,iR=Qr.unstable_IdlePriority,Pm=null,Bs=null;function vF(e){if(Bs&&typeof Bs.onCommitFiberRoot=="function")try{Bs.onCommitFiberRoot(Pm,e,void 0,(e.current.flags&128)===128)}catch{}}var zi=Math.clz32?Math.clz32:IF,yF=Math.log,CF=Math.LN2;function IF(e){return e>>>=0,e===0?32:31-(yF(e)/CF|0)|0}var Vh=64,Gh=4194304;function Od(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pg(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Od(a):(s&=o,s!==0&&(r=Od(s)))}else o=n&~i,o!==0?r=Od(o):s!==0&&(r=Od(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-zi(t),i=1<<n,r|=e[n],t&=~i;return r}function SF(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bF(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-zi(s),a=1<<o,c=i[o];c===-1?(!(a&n)||a&r)&&(i[o]=SF(a,t)):c<=t&&(e.expiredLanes|=a),s&=~a}}function F0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function sR(){var e=Vh;return Vh<<=1,!(Vh&4194240)&&(Vh=64),e}function ay(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function uh(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-zi(t),e[t]=n}function wF(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-zi(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function IS(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-zi(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var ot=0;function oR(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var aR,SS,cR,lR,uR,U0=!1,Wh=[],Pa=null,Ma=null,Oa=null,Cf=new Map,If=new Map,va=[],kF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gk(e,t){switch(e){case"focusin":case"focusout":Pa=null;break;case"dragenter":case"dragleave":Ma=null;break;case"mouseover":case"mouseout":Oa=null;break;case"pointerover":case"pointerout":Cf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":If.delete(t.pointerId)}}function fd(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=fh(t),t!==null&&SS(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function AF(e,t,n,r,i){switch(t){case"focusin":return Pa=fd(Pa,e,t,n,r,i),!0;case"dragenter":return Ma=fd(Ma,e,t,n,r,i),!0;case"mouseover":return Oa=fd(Oa,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Cf.set(s,fd(Cf.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,If.set(s,fd(If.get(s)||null,e,t,n,r,i)),!0}return!1}function dR(e){var t=yc(e.target);if(t!==null){var n=el(t);if(n!==null){if(t=n.tag,t===13){if(t=Q_(n),t!==null){e.blockedOn=t,uR(e.priority,function(){cR(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ap(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=V0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);O0=r,n.target.dispatchEvent(r),O0=null}else return t=fh(n),t!==null&&SS(t),e.blockedOn=n,!1;t.shift()}return!0}function mk(e,t,n){Ap(e)&&n.delete(t)}function EF(){U0=!1,Pa!==null&&Ap(Pa)&&(Pa=null),Ma!==null&&Ap(Ma)&&(Ma=null),Oa!==null&&Ap(Oa)&&(Oa=null),Cf.forEach(mk),If.forEach(mk)}function hd(e,t){e.blockedOn===t&&(e.blockedOn=null,U0||(U0=!0,Qr.unstable_scheduleCallback(Qr.unstable_NormalPriority,EF)))}function Sf(e){function t(i){return hd(i,e)}if(0<Wh.length){hd(Wh[0],e);for(var n=1;n<Wh.length;n++){var r=Wh[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Pa!==null&&hd(Pa,e),Ma!==null&&hd(Ma,e),Oa!==null&&hd(Oa,e),Cf.forEach(t),If.forEach(t),n=0;n<va.length;n++)r=va[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<va.length&&(n=va[0],n.blockedOn===null);)dR(n),n.blockedOn===null&&va.shift()}var ql=Zo.ReactCurrentBatchConfig,gg=!0;function TF(e,t,n,r){var i=ot,s=ql.transition;ql.transition=null;try{ot=1,bS(e,t,n,r)}finally{ot=i,ql.transition=s}}function _F(e,t,n,r){var i=ot,s=ql.transition;ql.transition=null;try{ot=4,bS(e,t,n,r)}finally{ot=i,ql.transition=s}}function bS(e,t,n,r){if(gg){var i=V0(e,t,n,r);if(i===null)vy(e,t,r,mg,n),gk(e,r);else if(AF(i,e,t,n,r))r.stopPropagation();else if(gk(e,r),t&4&&-1<kF.indexOf(e)){for(;i!==null;){var s=fh(i);if(s!==null&&aR(s),s=V0(e,t,n,r),s===null&&vy(e,t,r,mg,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else vy(e,t,r,null,n)}}var mg=null;function V0(e,t,n,r){if(mg=null,e=yS(r),e=yc(e),e!==null)if(t=el(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Q_(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return mg=e,null}function fR(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gF()){case CS:return 1;case rR:return 4;case hg:case mF:return 16;case iR:return 536870912;default:return 16}default:return 16}}var Sa=null,wS=null,Ep=null;function hR(){if(Ep)return Ep;var e,t=wS,n=t.length,r,i="value"in Sa?Sa.value:Sa.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[s-r];r++);return Ep=i.slice(e,1<r?1-r:void 0)}function Tp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function jh(){return!0}function vk(){return!1}function ni(e){function t(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?jh:vk,this.isPropagationStopped=vk,this}return jt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=jh)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=jh)},persist:function(){},isPersistent:jh}),t}var ju={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kS=ni(ju),dh=jt({},ju,{view:0,detail:0}),RF=ni(dh),cy,ly,pd,Mm=jt({},dh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:AS,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pd&&(pd&&e.type==="mousemove"?(cy=e.screenX-pd.screenX,ly=e.screenY-pd.screenY):ly=cy=0,pd=e),cy)},movementY:function(e){return"movementY"in e?e.movementY:ly}}),yk=ni(Mm),xF=jt({},Mm,{dataTransfer:0}),NF=ni(xF),PF=jt({},dh,{relatedTarget:0}),uy=ni(PF),MF=jt({},ju,{animationName:0,elapsedTime:0,pseudoElement:0}),OF=ni(MF),DF=jt({},ju,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),LF=ni(DF),BF=jt({},ju,{data:0}),Ck=ni(BF),FF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},VF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GF(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=VF[e])?!!t[e]:!1}function AS(){return GF}var WF=jt({},dh,{key:function(e){if(e.key){var t=FF[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Tp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?UF[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:AS,charCode:function(e){return e.type==="keypress"?Tp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Tp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jF=ni(WF),HF=jt({},Mm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ik=ni(HF),$F=jt({},dh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:AS}),zF=ni($F),ZF=jt({},ju,{propertyName:0,elapsedTime:0,pseudoElement:0}),XF=ni(ZF),KF=jt({},Mm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),JF=ni(KF),YF=[9,13,27,32],ES=Do&&"CompositionEvent"in window,Kd=null;Do&&"documentMode"in document&&(Kd=document.documentMode);var qF=Do&&"TextEvent"in window&&!Kd,pR=Do&&(!ES||Kd&&8<Kd&&11>=Kd),Sk=" ",bk=!1;function gR(e,t){switch(e){case"keyup":return YF.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mR(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Tl=!1;function QF(e,t){switch(e){case"compositionend":return mR(t);case"keypress":return t.which!==32?null:(bk=!0,Sk);case"textInput":return e=t.data,e===Sk&&bk?null:e;default:return null}}function e3(e,t){if(Tl)return e==="compositionend"||!ES&&gR(e,t)?(e=hR(),Ep=wS=Sa=null,Tl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pR&&t.locale!=="ko"?null:t.data;default:return null}}var t3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wk(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!t3[e.type]:t==="textarea"}function vR(e,t,n,r){X_(r),t=vg(t,"onChange"),0<t.length&&(n=new kS("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Jd=null,bf=null;function n3(e){_R(e,0)}function Om(e){var t=xl(e);if(G_(t))return e}function r3(e,t){if(e==="change")return t}var yR=!1;if(Do){var dy;if(Do){var fy="oninput"in document;if(!fy){var kk=document.createElement("div");kk.setAttribute("oninput","return;"),fy=typeof kk.oninput=="function"}dy=fy}else dy=!1;yR=dy&&(!document.documentMode||9<document.documentMode)}function Ak(){Jd&&(Jd.detachEvent("onpropertychange",CR),bf=Jd=null)}function CR(e){if(e.propertyName==="value"&&Om(bf)){var t=[];vR(t,bf,e,yS(e)),q_(n3,t)}}function i3(e,t,n){e==="focusin"?(Ak(),Jd=t,bf=n,Jd.attachEvent("onpropertychange",CR)):e==="focusout"&&Ak()}function s3(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Om(bf)}function o3(e,t){if(e==="click")return Om(t)}function a3(e,t){if(e==="input"||e==="change")return Om(t)}function c3(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ji=typeof Object.is=="function"?Object.is:c3;function wf(e,t){if(Ji(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!b0.call(t,i)||!Ji(e[i],t[i]))return!1}return!0}function Ek(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Tk(e,t){var n=Ek(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ek(n)}}function IR(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?IR(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function SR(){for(var e=window,t=ug();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ug(e.document)}return t}function TS(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function l3(e){var t=SR(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&IR(n.ownerDocument.documentElement,n)){if(r!==null&&TS(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=Tk(n,s);var o=Tk(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var u3=Do&&"documentMode"in document&&11>=document.documentMode,_l=null,G0=null,Yd=null,W0=!1;function _k(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;W0||_l==null||_l!==ug(r)||(r=_l,"selectionStart"in r&&TS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Yd&&wf(Yd,r)||(Yd=r,r=vg(G0,"onSelect"),0<r.length&&(t=new kS("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=_l)))}function Hh(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Rl={animationend:Hh("Animation","AnimationEnd"),animationiteration:Hh("Animation","AnimationIteration"),animationstart:Hh("Animation","AnimationStart"),transitionend:Hh("Transition","TransitionEnd")},hy={},bR={};Do&&(bR=document.createElement("div").style,"AnimationEvent"in window||(delete Rl.animationend.animation,delete Rl.animationiteration.animation,delete Rl.animationstart.animation),"TransitionEvent"in window||delete Rl.transitionend.transition);function Dm(e){if(hy[e])return hy[e];if(!Rl[e])return e;var t=Rl[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in bR)return hy[e]=t[n];return e}var wR=Dm("animationend"),kR=Dm("animationiteration"),AR=Dm("animationstart"),ER=Dm("transitionend"),TR=new Map,Rk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qa(e,t){TR.set(e,t),Qc(t,[e])}for(var py=0;py<Rk.length;py++){var gy=Rk[py],d3=gy.toLowerCase(),f3=gy[0].toUpperCase()+gy.slice(1);qa(d3,"on"+f3)}qa(wR,"onAnimationEnd");qa(kR,"onAnimationIteration");qa(AR,"onAnimationStart");qa("dblclick","onDoubleClick");qa("focusin","onFocus");qa("focusout","onBlur");qa(ER,"onTransitionEnd");Iu("onMouseEnter",["mouseout","mouseover"]);Iu("onMouseLeave",["mouseout","mouseover"]);Iu("onPointerEnter",["pointerout","pointerover"]);Iu("onPointerLeave",["pointerout","pointerover"]);Qc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),h3=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dd));function xk(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,dF(r,t,void 0,e),e.currentTarget=null}function _R(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;xk(i,a,l),s=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;xk(i,a,l),s=c}}}if(fg)throw e=B0,fg=!1,B0=null,e}function Rt(e,t){var n=t[Z0];n===void 0&&(n=t[Z0]=new Set);var r=e+"__bubble";n.has(r)||(RR(t,e,2,!1),n.add(r))}function my(e,t,n){var r=0;t&&(r|=4),RR(n,e,r,t)}var $h="_reactListening"+Math.random().toString(36).slice(2);function kf(e){if(!e[$h]){e[$h]=!0,L_.forEach(function(n){n!=="selectionchange"&&(h3.has(n)||my(n,!1,e),my(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[$h]||(t[$h]=!0,my("selectionchange",!1,t))}}function RR(e,t,n,r){switch(fR(t)){case 1:var i=TF;break;case 4:i=_F;break;default:i=bS}n=i.bind(null,t,n,e),i=void 0,!L0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function vy(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=yc(a),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}a=a.parentNode}}r=r.return}q_(function(){var l=s,u=yS(n),d=[];e:{var f=TR.get(e);if(f!==void 0){var h=kS,p=e;switch(e){case"keypress":if(Tp(n)===0)break e;case"keydown":case"keyup":h=jF;break;case"focusin":p="focus",h=uy;break;case"focusout":p="blur",h=uy;break;case"beforeblur":case"afterblur":h=uy;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=yk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=NF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=zF;break;case wR:case kR:case AR:h=OF;break;case ER:h=XF;break;case"scroll":h=RF;break;case"wheel":h=JF;break;case"copy":case"cut":case"paste":h=LF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Ik}var m=(t&4)!==0,y=!m&&e==="scroll",g=m?f!==null?f+"Capture":null:f;m=[];for(var v=l,S;v!==null;){S=v;var E=S.stateNode;if(S.tag===5&&E!==null&&(S=E,g!==null&&(E=yf(v,g),E!=null&&m.push(Af(v,E,S)))),y)break;v=v.return}0<m.length&&(f=new h(f,p,null,n,u),d.push({event:f,listeners:m}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==O0&&(p=n.relatedTarget||n.fromElement)&&(yc(p)||p[Lo]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?yc(p):null,p!==null&&(y=el(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(m=yk,E="onMouseLeave",g="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(m=Ik,E="onPointerLeave",g="onPointerEnter",v="pointer"),y=h==null?f:xl(h),S=p==null?f:xl(p),f=new m(E,v+"leave",h,n,u),f.target=y,f.relatedTarget=S,E=null,yc(u)===l&&(m=new m(g,v+"enter",p,n,u),m.target=S,m.relatedTarget=y,E=m),y=E,h&&p)t:{for(m=h,g=p,v=0,S=m;S;S=pl(S))v++;for(S=0,E=g;E;E=pl(E))S++;for(;0<v-S;)m=pl(m),v--;for(;0<S-v;)g=pl(g),S--;for(;v--;){if(m===g||g!==null&&m===g.alternate)break t;m=pl(m),g=pl(g)}m=null}else m=null;h!==null&&Nk(d,f,h,m,!1),p!==null&&y!==null&&Nk(d,y,p,m,!0)}}e:{if(f=l?xl(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var k=r3;else if(wk(f))if(yR)k=a3;else{k=s3;var b=i3}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=o3);if(k&&(k=k(e,l))){vR(d,k,n,u);break e}b&&b(e,f,l),e==="focusout"&&(b=f._wrapperState)&&b.controlled&&f.type==="number"&&R0(f,"number",f.value)}switch(b=l?xl(l):window,e){case"focusin":(wk(b)||b.contentEditable==="true")&&(_l=b,G0=l,Yd=null);break;case"focusout":Yd=G0=_l=null;break;case"mousedown":W0=!0;break;case"contextmenu":case"mouseup":case"dragend":W0=!1,_k(d,n,u);break;case"selectionchange":if(u3)break;case"keydown":case"keyup":_k(d,n,u)}var A;if(ES)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Tl?gR(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(pR&&n.locale!=="ko"&&(Tl||_!=="onCompositionStart"?_==="onCompositionEnd"&&Tl&&(A=hR()):(Sa=u,wS="value"in Sa?Sa.value:Sa.textContent,Tl=!0)),b=vg(l,_),0<b.length&&(_=new Ck(_,e,null,n,u),d.push({event:_,listeners:b}),A?_.data=A:(A=mR(n),A!==null&&(_.data=A)))),(A=qF?QF(e,n):e3(e,n))&&(l=vg(l,"onBeforeInput"),0<l.length&&(u=new Ck("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:l}),u.data=A))}_R(d,t)})}function Af(e,t,n){return{instance:e,listener:t,currentTarget:n}}function vg(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=yf(e,n),s!=null&&r.unshift(Af(e,s,i)),s=yf(e,t),s!=null&&r.push(Af(e,s,i))),e=e.return}return r}function pl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Nk(e,t,n,r,i){for(var s=t._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&l!==null&&(a=l,i?(c=yf(n,s),c!=null&&o.unshift(Af(n,c,a))):i||(c=yf(n,s),c!=null&&o.push(Af(n,c,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var p3=/\r\n?/g,g3=/\u0000|\uFFFD/g;function Pk(e){return(typeof e=="string"?e:""+e).replace(p3,`
`).replace(g3,"")}function zh(e,t,n){if(t=Pk(t),Pk(e)!==t&&n)throw Error(oe(425))}function yg(){}var j0=null,H0=null;function $0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var z0=typeof setTimeout=="function"?setTimeout:void 0,m3=typeof clearTimeout=="function"?clearTimeout:void 0,Mk=typeof Promise=="function"?Promise:void 0,v3=typeof queueMicrotask=="function"?queueMicrotask:typeof Mk<"u"?function(e){return Mk.resolve(null).then(e).catch(y3)}:z0;function y3(e){setTimeout(function(){throw e})}function yy(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Sf(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Sf(t)}function Da(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ok(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Hu=Math.random().toString(36).slice(2),gs="__reactFiber$"+Hu,Ef="__reactProps$"+Hu,Lo="__reactContainer$"+Hu,Z0="__reactEvents$"+Hu,C3="__reactListeners$"+Hu,I3="__reactHandles$"+Hu;function yc(e){var t=e[gs];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Lo]||n[gs]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Ok(e);e!==null;){if(n=e[gs])return n;e=Ok(e)}return t}e=n,n=e.parentNode}return null}function fh(e){return e=e[gs]||e[Lo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function xl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(oe(33))}function Lm(e){return e[Ef]||null}var X0=[],Nl=-1;function Qa(e){return{current:e}}function Ot(e){0>Nl||(e.current=X0[Nl],X0[Nl]=null,Nl--)}function Tt(e,t){Nl++,X0[Nl]=e.current,e.current=t}var Za={},er=Qa(Za),Rr=Qa(!1),Dc=Za;function Su(e,t){var n=e.type.contextTypes;if(!n)return Za;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function xr(e){return e=e.childContextTypes,e!=null}function Cg(){Ot(Rr),Ot(er)}function Dk(e,t,n){if(er.current!==Za)throw Error(oe(168));Tt(er,t),Tt(Rr,n)}function xR(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(oe(108,iF(e)||"Unknown",i));return jt({},n,r)}function Ig(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Za,Dc=er.current,Tt(er,e),Tt(Rr,Rr.current),!0}function Lk(e,t,n){var r=e.stateNode;if(!r)throw Error(oe(169));n?(e=xR(e,t,Dc),r.__reactInternalMemoizedMergedChildContext=e,Ot(Rr),Ot(er),Tt(er,e)):Ot(Rr),Tt(Rr,n)}var Qs=null,Bm=!1,Cy=!1;function NR(e){Qs===null?Qs=[e]:Qs.push(e)}function S3(e){Bm=!0,NR(e)}function ec(){if(!Cy&&Qs!==null){Cy=!0;var e=0,t=ot;try{var n=Qs;for(ot=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Qs=null,Bm=!1}catch(i){throw Qs!==null&&(Qs=Qs.slice(e+1)),nR(CS,ec),i}finally{ot=t,Cy=!1}}return null}var Pl=[],Ml=0,Sg=null,bg=0,ci=[],li=0,Lc=null,io=1,so="";function dc(e,t){Pl[Ml++]=bg,Pl[Ml++]=Sg,Sg=e,bg=t}function PR(e,t,n){ci[li++]=io,ci[li++]=so,ci[li++]=Lc,Lc=e;var r=io;e=so;var i=32-zi(r)-1;r&=~(1<<i),n+=1;var s=32-zi(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,io=1<<32-zi(t)+i|n<<i|r,so=s+e}else io=1<<s|n<<i|r,so=e}function _S(e){e.return!==null&&(dc(e,1),PR(e,1,0))}function RS(e){for(;e===Sg;)Sg=Pl[--Ml],Pl[Ml]=null,bg=Pl[--Ml],Pl[Ml]=null;for(;e===Lc;)Lc=ci[--li],ci[li]=null,so=ci[--li],ci[li]=null,io=ci[--li],ci[li]=null}var Yr=null,Kr=null,Ft=!1,Bi=null;function MR(e,t){var n=di(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Bk(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Yr=e,Kr=Da(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Yr=e,Kr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Lc!==null?{id:io,overflow:so}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=di(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Yr=e,Kr=null,!0):!1;default:return!1}}function K0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function J0(e){if(Ft){var t=Kr;if(t){var n=t;if(!Bk(e,t)){if(K0(e))throw Error(oe(418));t=Da(n.nextSibling);var r=Yr;t&&Bk(e,t)?MR(r,n):(e.flags=e.flags&-4097|2,Ft=!1,Yr=e)}}else{if(K0(e))throw Error(oe(418));e.flags=e.flags&-4097|2,Ft=!1,Yr=e}}}function Fk(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Yr=e}function Zh(e){if(e!==Yr)return!1;if(!Ft)return Fk(e),Ft=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!$0(e.type,e.memoizedProps)),t&&(t=Kr)){if(K0(e))throw OR(),Error(oe(418));for(;t;)MR(e,t),t=Da(t.nextSibling)}if(Fk(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(oe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Kr=Da(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Kr=null}}else Kr=Yr?Da(e.stateNode.nextSibling):null;return!0}function OR(){for(var e=Kr;e;)e=Da(e.nextSibling)}function bu(){Kr=Yr=null,Ft=!1}function xS(e){Bi===null?Bi=[e]:Bi.push(e)}var b3=Zo.ReactCurrentBatchConfig;function Ai(e,t){if(e&&e.defaultProps){t=jt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}var wg=Qa(null),kg=null,Ol=null,NS=null;function PS(){NS=Ol=kg=null}function MS(e){var t=wg.current;Ot(wg),e._currentValue=t}function Y0(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ql(e,t){kg=e,NS=Ol=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Er=!0),e.firstContext=null)}function mi(e){var t=e._currentValue;if(NS!==e)if(e={context:e,memoizedValue:t,next:null},Ol===null){if(kg===null)throw Error(oe(308));Ol=e,kg.dependencies={lanes:0,firstContext:e}}else Ol=Ol.next=e;return t}var Cc=null;function OS(e){Cc===null?Cc=[e]:Cc.push(e)}function DR(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,OS(t)):(n.next=i.next,i.next=n),t.interleaved=n,Bo(e,r)}function Bo(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var da=!1;function DS(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function LR(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function No(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function La(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Bo(e,n)}return i=r.interleaved,i===null?(t.next=t,OS(r)):(t.next=i.next,i.next=t),r.interleaved=t,Bo(e,n)}function _p(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,IS(e,n)}}function Uk(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ag(e,t,n,r){var i=e.updateQueue;da=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?s=l:o.next=l,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(s!==null){var d=i.baseState;o=0,u=l=c=null,a=s;do{var f=a.lane,h=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(f=t,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=jt({},d,f);break e;case 2:da=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=h,c=d):u=u.next=h,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Fc|=o,e.lanes=o,e.memoizedState=d}}function Vk(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(oe(191,i));i.call(r)}}}var BR=new D_.Component().refs;function q0(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:jt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Fm={isMounted:function(e){return(e=e._reactInternals)?el(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=pr(),i=Fa(e),s=No(r,i);s.payload=t,n!=null&&(s.callback=n),t=La(e,s,i),t!==null&&(Zi(t,e,i,r),_p(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=pr(),i=Fa(e),s=No(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=La(e,s,i),t!==null&&(Zi(t,e,i,r),_p(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=pr(),r=Fa(e),i=No(n,r);i.tag=2,t!=null&&(i.callback=t),t=La(e,i,r),t!==null&&(Zi(t,e,r,n),_p(t,e,r))}};function Gk(e,t,n,r,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,o):t.prototype&&t.prototype.isPureReactComponent?!wf(n,r)||!wf(i,s):!0}function FR(e,t,n){var r=!1,i=Za,s=t.contextType;return typeof s=="object"&&s!==null?s=mi(s):(i=xr(t)?Dc:er.current,r=t.contextTypes,s=(r=r!=null)?Su(e,i):Za),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Fm,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Wk(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Fm.enqueueReplaceState(t,t.state,null)}function Q0(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=BR,DS(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=mi(s):(s=xr(t)?Dc:er.current,i.context=Su(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(q0(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Fm.enqueueReplaceState(i,i.state,null),Ag(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function gd(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(oe(309));var r=n.stateNode}if(!r)throw Error(oe(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=i.refs;a===BR&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(oe(284));if(!n._owner)throw Error(oe(290,e))}return e}function Xh(e,t){throw e=Object.prototype.toString.call(t),Error(oe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function jk(e){var t=e._init;return t(e._payload)}function UR(e){function t(g,v){if(e){var S=g.deletions;S===null?(g.deletions=[v],g.flags|=16):S.push(v)}}function n(g,v){if(!e)return null;for(;v!==null;)t(g,v),v=v.sibling;return null}function r(g,v){for(g=new Map;v!==null;)v.key!==null?g.set(v.key,v):g.set(v.index,v),v=v.sibling;return g}function i(g,v){return g=Ua(g,v),g.index=0,g.sibling=null,g}function s(g,v,S){return g.index=S,e?(S=g.alternate,S!==null?(S=S.index,S<v?(g.flags|=2,v):S):(g.flags|=2,v)):(g.flags|=1048576,v)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function a(g,v,S,E){return v===null||v.tag!==6?(v=Ey(S,g.mode,E),v.return=g,v):(v=i(v,S),v.return=g,v)}function c(g,v,S,E){var k=S.type;return k===El?u(g,v,S.props.children,E,S.key):v!==null&&(v.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===ua&&jk(k)===v.type)?(E=i(v,S.props),E.ref=gd(g,v,S),E.return=g,E):(E=Op(S.type,S.key,S.props,null,g.mode,E),E.ref=gd(g,v,S),E.return=g,E)}function l(g,v,S,E){return v===null||v.tag!==4||v.stateNode.containerInfo!==S.containerInfo||v.stateNode.implementation!==S.implementation?(v=Ty(S,g.mode,E),v.return=g,v):(v=i(v,S.children||[]),v.return=g,v)}function u(g,v,S,E,k){return v===null||v.tag!==7?(v=xc(S,g.mode,E,k),v.return=g,v):(v=i(v,S),v.return=g,v)}function d(g,v,S){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Ey(""+v,g.mode,S),v.return=g,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Bh:return S=Op(v.type,v.key,v.props,null,g.mode,S),S.ref=gd(g,null,v),S.return=g,S;case Al:return v=Ty(v,g.mode,S),v.return=g,v;case ua:var E=v._init;return d(g,E(v._payload),S)}if(Md(v)||ud(v))return v=xc(v,g.mode,S,null),v.return=g,v;Xh(g,v)}return null}function f(g,v,S,E){var k=v!==null?v.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return k!==null?null:a(g,v,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Bh:return S.key===k?c(g,v,S,E):null;case Al:return S.key===k?l(g,v,S,E):null;case ua:return k=S._init,f(g,v,k(S._payload),E)}if(Md(S)||ud(S))return k!==null?null:u(g,v,S,E,null);Xh(g,S)}return null}function h(g,v,S,E,k){if(typeof E=="string"&&E!==""||typeof E=="number")return g=g.get(S)||null,a(v,g,""+E,k);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Bh:return g=g.get(E.key===null?S:E.key)||null,c(v,g,E,k);case Al:return g=g.get(E.key===null?S:E.key)||null,l(v,g,E,k);case ua:var b=E._init;return h(g,v,S,b(E._payload),k)}if(Md(E)||ud(E))return g=g.get(S)||null,u(v,g,E,k,null);Xh(v,E)}return null}function p(g,v,S,E){for(var k=null,b=null,A=v,_=v=0,P=null;A!==null&&_<S.length;_++){A.index>_?(P=A,A=null):P=A.sibling;var N=f(g,A,S[_],E);if(N===null){A===null&&(A=P);break}e&&A&&N.alternate===null&&t(g,A),v=s(N,v,_),b===null?k=N:b.sibling=N,b=N,A=P}if(_===S.length)return n(g,A),Ft&&dc(g,_),k;if(A===null){for(;_<S.length;_++)A=d(g,S[_],E),A!==null&&(v=s(A,v,_),b===null?k=A:b.sibling=A,b=A);return Ft&&dc(g,_),k}for(A=r(g,A);_<S.length;_++)P=h(A,g,_,S[_],E),P!==null&&(e&&P.alternate!==null&&A.delete(P.key===null?_:P.key),v=s(P,v,_),b===null?k=P:b.sibling=P,b=P);return e&&A.forEach(function(O){return t(g,O)}),Ft&&dc(g,_),k}function m(g,v,S,E){var k=ud(S);if(typeof k!="function")throw Error(oe(150));if(S=k.call(S),S==null)throw Error(oe(151));for(var b=k=null,A=v,_=v=0,P=null,N=S.next();A!==null&&!N.done;_++,N=S.next()){A.index>_?(P=A,A=null):P=A.sibling;var O=f(g,A,N.value,E);if(O===null){A===null&&(A=P);break}e&&A&&O.alternate===null&&t(g,A),v=s(O,v,_),b===null?k=O:b.sibling=O,b=O,A=P}if(N.done)return n(g,A),Ft&&dc(g,_),k;if(A===null){for(;!N.done;_++,N=S.next())N=d(g,N.value,E),N!==null&&(v=s(N,v,_),b===null?k=N:b.sibling=N,b=N);return Ft&&dc(g,_),k}for(A=r(g,A);!N.done;_++,N=S.next())N=h(A,g,_,N.value,E),N!==null&&(e&&N.alternate!==null&&A.delete(N.key===null?_:N.key),v=s(N,v,_),b===null?k=N:b.sibling=N,b=N);return e&&A.forEach(function(D){return t(g,D)}),Ft&&dc(g,_),k}function y(g,v,S,E){if(typeof S=="object"&&S!==null&&S.type===El&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Bh:e:{for(var k=S.key,b=v;b!==null;){if(b.key===k){if(k=S.type,k===El){if(b.tag===7){n(g,b.sibling),v=i(b,S.props.children),v.return=g,g=v;break e}}else if(b.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===ua&&jk(k)===b.type){n(g,b.sibling),v=i(b,S.props),v.ref=gd(g,b,S),v.return=g,g=v;break e}n(g,b);break}else t(g,b);b=b.sibling}S.type===El?(v=xc(S.props.children,g.mode,E,S.key),v.return=g,g=v):(E=Op(S.type,S.key,S.props,null,g.mode,E),E.ref=gd(g,v,S),E.return=g,g=E)}return o(g);case Al:e:{for(b=S.key;v!==null;){if(v.key===b)if(v.tag===4&&v.stateNode.containerInfo===S.containerInfo&&v.stateNode.implementation===S.implementation){n(g,v.sibling),v=i(v,S.children||[]),v.return=g,g=v;break e}else{n(g,v);break}else t(g,v);v=v.sibling}v=Ty(S,g.mode,E),v.return=g,g=v}return o(g);case ua:return b=S._init,y(g,v,b(S._payload),E)}if(Md(S))return p(g,v,S,E);if(ud(S))return m(g,v,S,E);Xh(g,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,v!==null&&v.tag===6?(n(g,v.sibling),v=i(v,S),v.return=g,g=v):(n(g,v),v=Ey(S,g.mode,E),v.return=g,g=v),o(g)):n(g,v)}return y}var wu=UR(!0),VR=UR(!1),hh={},Fs=Qa(hh),Tf=Qa(hh),_f=Qa(hh);function Ic(e){if(e===hh)throw Error(oe(174));return e}function LS(e,t){switch(Tt(_f,t),Tt(Tf,e),Tt(Fs,hh),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:N0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=N0(t,e)}Ot(Fs),Tt(Fs,t)}function ku(){Ot(Fs),Ot(Tf),Ot(_f)}function GR(e){Ic(_f.current);var t=Ic(Fs.current),n=N0(t,e.type);t!==n&&(Tt(Tf,e),Tt(Fs,n))}function BS(e){Tf.current===e&&(Ot(Fs),Ot(Tf))}var Vt=Qa(0);function Eg(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Iy=[];function FS(){for(var e=0;e<Iy.length;e++)Iy[e]._workInProgressVersionPrimary=null;Iy.length=0}var Rp=Zo.ReactCurrentDispatcher,Sy=Zo.ReactCurrentBatchConfig,Bc=0,Wt=null,hn=null,En=null,Tg=!1,qd=!1,Rf=0,w3=0;function Zn(){throw Error(oe(321))}function US(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ji(e[n],t[n]))return!1;return!0}function VS(e,t,n,r,i,s){if(Bc=s,Wt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Rp.current=e===null||e.memoizedState===null?T3:_3,e=n(r,i),qd){s=0;do{if(qd=!1,Rf=0,25<=s)throw Error(oe(301));s+=1,En=hn=null,t.updateQueue=null,Rp.current=R3,e=n(r,i)}while(qd)}if(Rp.current=_g,t=hn!==null&&hn.next!==null,Bc=0,En=hn=Wt=null,Tg=!1,t)throw Error(oe(300));return e}function GS(){var e=Rf!==0;return Rf=0,e}function cs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?Wt.memoizedState=En=e:En=En.next=e,En}function vi(){if(hn===null){var e=Wt.alternate;e=e!==null?e.memoizedState:null}else e=hn.next;var t=En===null?Wt.memoizedState:En.next;if(t!==null)En=t,hn=e;else{if(e===null)throw Error(oe(310));hn=e,e={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},En===null?Wt.memoizedState=En=e:En=En.next=e}return En}function xf(e,t){return typeof t=="function"?t(e):t}function by(e){var t=vi(),n=t.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=e;var r=hn,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,c=null,l=s;do{var u=l.lane;if((Bc&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=d,o=r):c=c.next=d,Wt.lanes|=u,Fc|=u}l=l.next}while(l!==null&&l!==s);c===null?o=r:c.next=a,Ji(r,t.memoizedState)||(Er=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,Wt.lanes|=s,Fc|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wy(e){var t=vi(),n=t.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);Ji(s,t.memoizedState)||(Er=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function WR(){}function jR(e,t){var n=Wt,r=vi(),i=t(),s=!Ji(r.memoizedState,i);if(s&&(r.memoizedState=i,Er=!0),r=r.queue,WS(zR.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||En!==null&&En.memoizedState.tag&1){if(n.flags|=2048,Nf(9,$R.bind(null,n,r,i,t),void 0,null),Rn===null)throw Error(oe(349));Bc&30||HR(n,t,i)}return i}function HR(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Wt.updateQueue,t===null?(t={lastEffect:null,stores:null},Wt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function $R(e,t,n,r){t.value=n,t.getSnapshot=r,ZR(t)&&XR(e)}function zR(e,t,n){return n(function(){ZR(t)&&XR(e)})}function ZR(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ji(e,n)}catch{return!0}}function XR(e){var t=Bo(e,1);t!==null&&Zi(t,e,1,-1)}function Hk(e){var t=cs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xf,lastRenderedState:e},t.queue=e,e=e.dispatch=E3.bind(null,Wt,e),[t.memoizedState,e]}function Nf(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Wt.updateQueue,t===null?(t={lastEffect:null,stores:null},Wt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function KR(){return vi().memoizedState}function xp(e,t,n,r){var i=cs();Wt.flags|=e,i.memoizedState=Nf(1|t,n,void 0,r===void 0?null:r)}function Um(e,t,n,r){var i=vi();r=r===void 0?null:r;var s=void 0;if(hn!==null){var o=hn.memoizedState;if(s=o.destroy,r!==null&&US(r,o.deps)){i.memoizedState=Nf(t,n,s,r);return}}Wt.flags|=e,i.memoizedState=Nf(1|t,n,s,r)}function $k(e,t){return xp(8390656,8,e,t)}function WS(e,t){return Um(2048,8,e,t)}function JR(e,t){return Um(4,2,e,t)}function YR(e,t){return Um(4,4,e,t)}function qR(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function QR(e,t,n){return n=n!=null?n.concat([e]):null,Um(4,4,qR.bind(null,t,e),n)}function jS(){}function ex(e,t){var n=vi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&US(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function tx(e,t){var n=vi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&US(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function nx(e,t,n){return Bc&21?(Ji(n,t)||(n=sR(),Wt.lanes|=n,Fc|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Er=!0),e.memoizedState=n)}function k3(e,t){var n=ot;ot=n!==0&&4>n?n:4,e(!0);var r=Sy.transition;Sy.transition={};try{e(!1),t()}finally{ot=n,Sy.transition=r}}function rx(){return vi().memoizedState}function A3(e,t,n){var r=Fa(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ix(e))sx(t,n);else if(n=DR(e,t,n,r),n!==null){var i=pr();Zi(n,e,r,i),ox(n,t,r)}}function E3(e,t,n){var r=Fa(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ix(e))sx(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Ji(a,o)){var c=t.interleaved;c===null?(i.next=i,OS(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}n=DR(e,t,i,r),n!==null&&(i=pr(),Zi(n,e,r,i),ox(n,t,r))}}function ix(e){var t=e.alternate;return e===Wt||t!==null&&t===Wt}function sx(e,t){qd=Tg=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ox(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,IS(e,n)}}var _g={readContext:mi,useCallback:Zn,useContext:Zn,useEffect:Zn,useImperativeHandle:Zn,useInsertionEffect:Zn,useLayoutEffect:Zn,useMemo:Zn,useReducer:Zn,useRef:Zn,useState:Zn,useDebugValue:Zn,useDeferredValue:Zn,useTransition:Zn,useMutableSource:Zn,useSyncExternalStore:Zn,useId:Zn,unstable_isNewReconciler:!1},T3={readContext:mi,useCallback:function(e,t){return cs().memoizedState=[e,t===void 0?null:t],e},useContext:mi,useEffect:$k,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,xp(4194308,4,qR.bind(null,t,e),n)},useLayoutEffect:function(e,t){return xp(4194308,4,e,t)},useInsertionEffect:function(e,t){return xp(4,2,e,t)},useMemo:function(e,t){var n=cs();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=cs();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=A3.bind(null,Wt,e),[r.memoizedState,e]},useRef:function(e){var t=cs();return e={current:e},t.memoizedState=e},useState:Hk,useDebugValue:jS,useDeferredValue:function(e){return cs().memoizedState=e},useTransition:function(){var e=Hk(!1),t=e[0];return e=k3.bind(null,e[1]),cs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Wt,i=cs();if(Ft){if(n===void 0)throw Error(oe(407));n=n()}else{if(n=t(),Rn===null)throw Error(oe(349));Bc&30||HR(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,$k(zR.bind(null,r,s,e),[e]),r.flags|=2048,Nf(9,$R.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=cs(),t=Rn.identifierPrefix;if(Ft){var n=so,r=io;n=(r&~(1<<32-zi(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Rf++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=w3++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},_3={readContext:mi,useCallback:ex,useContext:mi,useEffect:WS,useImperativeHandle:QR,useInsertionEffect:JR,useLayoutEffect:YR,useMemo:tx,useReducer:by,useRef:KR,useState:function(){return by(xf)},useDebugValue:jS,useDeferredValue:function(e){var t=vi();return nx(t,hn.memoizedState,e)},useTransition:function(){var e=by(xf)[0],t=vi().memoizedState;return[e,t]},useMutableSource:WR,useSyncExternalStore:jR,useId:rx,unstable_isNewReconciler:!1},R3={readContext:mi,useCallback:ex,useContext:mi,useEffect:WS,useImperativeHandle:QR,useInsertionEffect:JR,useLayoutEffect:YR,useMemo:tx,useReducer:wy,useRef:KR,useState:function(){return wy(xf)},useDebugValue:jS,useDeferredValue:function(e){var t=vi();return hn===null?t.memoizedState=e:nx(t,hn.memoizedState,e)},useTransition:function(){var e=wy(xf)[0],t=vi().memoizedState;return[e,t]},useMutableSource:WR,useSyncExternalStore:jR,useId:rx,unstable_isNewReconciler:!1};function Au(e,t){try{var n="",r=t;do n+=rF(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function ky(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function eC(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var x3=typeof WeakMap=="function"?WeakMap:Map;function ax(e,t,n){n=No(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){xg||(xg=!0,uC=r),eC(e,t)},n}function cx(e,t,n){n=No(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){eC(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){eC(e,t),typeof r!="function"&&(Ba===null?Ba=new Set([this]):Ba.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function zk(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new x3;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=H3.bind(null,e,t,n),t.then(e,e))}function Zk(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Xk(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=No(-1,1),t.tag=2,La(n,t,1))),n.lanes|=1),e)}var N3=Zo.ReactCurrentOwner,Er=!1;function sr(e,t,n,r){t.child=e===null?VR(t,null,n,r):wu(t,e.child,n,r)}function Kk(e,t,n,r,i){n=n.render;var s=t.ref;return Ql(t,i),r=VS(e,t,n,r,s,i),n=GS(),e!==null&&!Er?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Fo(e,t,i)):(Ft&&n&&_S(t),t.flags|=1,sr(e,t,r,i),t.child)}function Jk(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!YS(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,lx(e,t,s,r,i)):(e=Op(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:wf,n(o,r)&&e.ref===t.ref)return Fo(e,t,i)}return t.flags|=1,e=Ua(s,r),e.ref=t.ref,e.return=t,t.child=e}function lx(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(wf(s,r)&&e.ref===t.ref)if(Er=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&(Er=!0);else return t.lanes=e.lanes,Fo(e,t,i)}return tC(e,t,n,r,i)}function ux(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tt(Ll,Wr),Wr|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Tt(Ll,Wr),Wr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Tt(Ll,Wr),Wr|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,Tt(Ll,Wr),Wr|=r;return sr(e,t,i,n),t.child}function dx(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function tC(e,t,n,r,i){var s=xr(n)?Dc:er.current;return s=Su(t,s),Ql(t,i),n=VS(e,t,n,r,s,i),r=GS(),e!==null&&!Er?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Fo(e,t,i)):(Ft&&r&&_S(t),t.flags|=1,sr(e,t,n,i),t.child)}function Yk(e,t,n,r,i){if(xr(n)){var s=!0;Ig(t)}else s=!1;if(Ql(t,i),t.stateNode===null)Np(e,t),FR(t,n,r),Q0(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var c=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=mi(l):(l=xr(n)?Dc:er.current,l=Su(t,l));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==l)&&Wk(t,o,r,l),da=!1;var f=t.memoizedState;o.state=f,Ag(t,r,o,i),c=t.memoizedState,a!==r||f!==c||Rr.current||da?(typeof u=="function"&&(q0(t,n,u,r),c=t.memoizedState),(a=da||Gk(t,n,a,r,f,c,l))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=l,r=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,LR(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:Ai(t.type,a),o.props=l,d=t.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=mi(c):(c=xr(n)?Dc:er.current,c=Su(t,c));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==c)&&Wk(t,o,r,c),da=!1,f=t.memoizedState,o.state=f,Ag(t,r,o,i);var p=t.memoizedState;a!==d||f!==p||Rr.current||da?(typeof h=="function"&&(q0(t,n,h,r),p=t.memoizedState),(l=da||Gk(t,n,l,r,f,p,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=c,r=l):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return nC(e,t,n,r,s,i)}function nC(e,t,n,r,i,s){dx(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&Lk(t,n,!1),Fo(e,t,s);r=t.stateNode,N3.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=wu(t,e.child,null,s),t.child=wu(t,null,a,s)):sr(e,t,a,s),t.memoizedState=r.state,i&&Lk(t,n,!0),t.child}function fx(e){var t=e.stateNode;t.pendingContext?Dk(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Dk(e,t.context,!1),LS(e,t.containerInfo)}function qk(e,t,n,r,i){return bu(),xS(i),t.flags|=256,sr(e,t,n,r),t.child}var rC={dehydrated:null,treeContext:null,retryLane:0};function iC(e){return{baseLanes:e,cachePool:null,transitions:null}}function hx(e,t,n){var r=t.pendingProps,i=Vt.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Tt(Vt,i&1),e===null)return J0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,s?(r=t.mode,s=t.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Wm(o,r,0,null),e=xc(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=iC(n),t.memoizedState=rC,e):HS(t,o));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return P3(e,t,o,r,a,i,n);if(s){s=r.fallback,o=t.mode,i=e.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Ua(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Ua(a,s):(s=xc(s,o,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,o=e.child.memoizedState,o=o===null?iC(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=rC,r}return s=e.child,e=s.sibling,r=Ua(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function HS(e,t){return t=Wm({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Kh(e,t,n,r){return r!==null&&xS(r),wu(t,e.child,null,n),e=HS(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function P3(e,t,n,r,i,s,o){if(n)return t.flags&256?(t.flags&=-257,r=ky(Error(oe(422))),Kh(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Wm({mode:"visible",children:r.children},i,0,null),s=xc(s,i,o,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&wu(t,e.child,null,o),t.child.memoizedState=iC(o),t.memoizedState=rC,s);if(!(t.mode&1))return Kh(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(oe(419)),r=ky(s,r,void 0),Kh(e,t,o,r)}if(a=(o&e.childLanes)!==0,Er||a){if(r=Rn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Bo(e,i),Zi(r,e,i,-1))}return JS(),r=ky(Error(oe(421))),Kh(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=$3.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Kr=Da(i.nextSibling),Yr=t,Ft=!0,Bi=null,e!==null&&(ci[li++]=io,ci[li++]=so,ci[li++]=Lc,io=e.id,so=e.overflow,Lc=t),t=HS(t,r.children),t.flags|=4096,t)}function Qk(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Y0(e.return,t,n)}function Ay(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function px(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(sr(e,t,r.children,n),r=Vt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Qk(e,n,t);else if(e.tag===19)Qk(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Tt(Vt,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Eg(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ay(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Eg(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ay(t,!0,n,null,s);break;case"together":Ay(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Np(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Fo(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Fc|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(oe(153));if(t.child!==null){for(e=t.child,n=Ua(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ua(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function M3(e,t,n){switch(t.tag){case 3:fx(t),bu();break;case 5:GR(t);break;case 1:xr(t.type)&&Ig(t);break;case 4:LS(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Tt(wg,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Tt(Vt,Vt.current&1),t.flags|=128,null):n&t.child.childLanes?hx(e,t,n):(Tt(Vt,Vt.current&1),e=Fo(e,t,n),e!==null?e.sibling:null);Tt(Vt,Vt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return px(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Tt(Vt,Vt.current),r)break;return null;case 22:case 23:return t.lanes=0,ux(e,t,n)}return Fo(e,t,n)}var gx,sC,mx,vx;gx=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};sC=function(){};mx=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ic(Fs.current);var s=null;switch(n){case"input":i=T0(e,i),r=T0(e,r),s=[];break;case"select":i=jt({},i,{value:void 0}),r=jt({},r,{value:void 0}),s=[];break;case"textarea":i=x0(e,i),r=x0(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=yg)}P0(n,r);var o;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(mf.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in r){var c=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(mf.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&Rt("scroll",e),s||a===c||(s=[])):(s=s||[]).push(l,c))}n&&(s=s||[]).push("style",n);var l=s;(t.updateQueue=l)&&(t.flags|=4)}};vx=function(e,t,n,r){n!==r&&(t.flags|=4)};function md(e,t){if(!Ft)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Xn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function O3(e,t,n){var r=t.pendingProps;switch(RS(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xn(t),null;case 1:return xr(t.type)&&Cg(),Xn(t),null;case 3:return r=t.stateNode,ku(),Ot(Rr),Ot(er),FS(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Zh(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Bi!==null&&(hC(Bi),Bi=null))),sC(e,t),Xn(t),null;case 5:BS(t);var i=Ic(_f.current);if(n=t.type,e!==null&&t.stateNode!=null)mx(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(oe(166));return Xn(t),null}if(e=Ic(Fs.current),Zh(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[gs]=t,r[Ef]=s,e=(t.mode&1)!==0,n){case"dialog":Rt("cancel",r),Rt("close",r);break;case"iframe":case"object":case"embed":Rt("load",r);break;case"video":case"audio":for(i=0;i<Dd.length;i++)Rt(Dd[i],r);break;case"source":Rt("error",r);break;case"img":case"image":case"link":Rt("error",r),Rt("load",r);break;case"details":Rt("toggle",r);break;case"input":ck(r,s),Rt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Rt("invalid",r);break;case"textarea":uk(r,s),Rt("invalid",r)}P0(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&zh(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&zh(r.textContent,a,e),i=["children",""+a]):mf.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Rt("scroll",r)}switch(n){case"input":Fh(r),lk(r,s,!0);break;case"textarea":Fh(r),dk(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=yg)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=H_(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[gs]=t,e[Ef]=r,gx(e,t,!1,!1),t.stateNode=e;e:{switch(o=M0(n,r),n){case"dialog":Rt("cancel",e),Rt("close",e),i=r;break;case"iframe":case"object":case"embed":Rt("load",e),i=r;break;case"video":case"audio":for(i=0;i<Dd.length;i++)Rt(Dd[i],e);i=r;break;case"source":Rt("error",e),i=r;break;case"img":case"image":case"link":Rt("error",e),Rt("load",e),i=r;break;case"details":Rt("toggle",e),i=r;break;case"input":ck(e,r),i=T0(e,r),Rt("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=jt({},r,{value:void 0}),Rt("invalid",e);break;case"textarea":uk(e,r),i=x0(e,r),Rt("invalid",e);break;default:i=r}P0(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?Z_(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&$_(e,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&vf(e,c):typeof c=="number"&&vf(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(mf.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Rt("scroll",e):c!=null&&pS(e,s,c,o))}switch(n){case"input":Fh(e),lk(e,r,!1);break;case"textarea":Fh(e),dk(e);break;case"option":r.value!=null&&e.setAttribute("value",""+za(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?Kl(e,!!r.multiple,s,!1):r.defaultValue!=null&&Kl(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=yg)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Xn(t),null;case 6:if(e&&t.stateNode!=null)vx(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(oe(166));if(n=Ic(_f.current),Ic(Fs.current),Zh(t)){if(r=t.stateNode,n=t.memoizedProps,r[gs]=t,(s=r.nodeValue!==n)&&(e=Yr,e!==null))switch(e.tag){case 3:zh(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&zh(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[gs]=t,t.stateNode=r}return Xn(t),null;case 13:if(Ot(Vt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ft&&Kr!==null&&t.mode&1&&!(t.flags&128))OR(),bu(),t.flags|=98560,s=!1;else if(s=Zh(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(oe(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(oe(317));s[gs]=t}else bu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Xn(t),s=!1}else Bi!==null&&(hC(Bi),Bi=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Vt.current&1?mn===0&&(mn=3):JS())),t.updateQueue!==null&&(t.flags|=4),Xn(t),null);case 4:return ku(),sC(e,t),e===null&&kf(t.stateNode.containerInfo),Xn(t),null;case 10:return MS(t.type._context),Xn(t),null;case 17:return xr(t.type)&&Cg(),Xn(t),null;case 19:if(Ot(Vt),s=t.memoizedState,s===null)return Xn(t),null;if(r=(t.flags&128)!==0,o=s.rendering,o===null)if(r)md(s,!1);else{if(mn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Eg(e),o!==null){for(t.flags|=128,md(s,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Tt(Vt,Vt.current&1|2),t.child}e=e.sibling}s.tail!==null&&tn()>Eu&&(t.flags|=128,r=!0,md(s,!1),t.lanes=4194304)}else{if(!r)if(e=Eg(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),md(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ft)return Xn(t),null}else 2*tn()-s.renderingStartTime>Eu&&n!==1073741824&&(t.flags|=128,r=!0,md(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=tn(),t.sibling=null,n=Vt.current,Tt(Vt,r?n&1|2:n&1),t):(Xn(t),null);case 22:case 23:return KS(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Wr&1073741824&&(Xn(t),t.subtreeFlags&6&&(t.flags|=8192)):Xn(t),null;case 24:return null;case 25:return null}throw Error(oe(156,t.tag))}function D3(e,t){switch(RS(t),t.tag){case 1:return xr(t.type)&&Cg(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ku(),Ot(Rr),Ot(er),FS(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return BS(t),null;case 13:if(Ot(Vt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(oe(340));bu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ot(Vt),null;case 4:return ku(),null;case 10:return MS(t.type._context),null;case 22:case 23:return KS(),null;case 24:return null;default:return null}}var Jh=!1,Jn=!1,L3=typeof WeakSet=="function"?WeakSet:Set,he=null;function Dl(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Zt(e,t,r)}else n.current=null}function oC(e,t,n){try{n()}catch(r){Zt(e,t,r)}}var eA=!1;function B3(e,t){if(j0=gg,e=SR(),TS(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,l=0,u=0,d=e,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(c=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===e)break t;if(f===n&&++l===i&&(a=o),f===s&&++u===r&&(c=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(H0={focusedElem:e,selectionRange:n},gg=!1,he=t;he!==null;)if(t=he,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,he=e;else for(;he!==null;){t=he;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,y=p.memoizedState,g=t.stateNode,v=g.getSnapshotBeforeUpdate(t.elementType===t.type?m:Ai(t.type,m),y);g.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var S=t.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(E){Zt(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,he=e;break}he=t.return}return p=eA,eA=!1,p}function Qd(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&oC(t,n,s)}i=i.next}while(i!==r)}}function Vm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function aC(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function yx(e){var t=e.alternate;t!==null&&(e.alternate=null,yx(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[gs],delete t[Ef],delete t[Z0],delete t[C3],delete t[I3])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Cx(e){return e.tag===5||e.tag===3||e.tag===4}function tA(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Cx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cC(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=yg));else if(r!==4&&(e=e.child,e!==null))for(cC(e,t,n),e=e.sibling;e!==null;)cC(e,t,n),e=e.sibling}function lC(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(lC(e,t,n),e=e.sibling;e!==null;)lC(e,t,n),e=e.sibling}var Mn=null,Oi=!1;function ea(e,t,n){for(n=n.child;n!==null;)Ix(e,t,n),n=n.sibling}function Ix(e,t,n){if(Bs&&typeof Bs.onCommitFiberUnmount=="function")try{Bs.onCommitFiberUnmount(Pm,n)}catch{}switch(n.tag){case 5:Jn||Dl(n,t);case 6:var r=Mn,i=Oi;Mn=null,ea(e,t,n),Mn=r,Oi=i,Mn!==null&&(Oi?(e=Mn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Mn.removeChild(n.stateNode));break;case 18:Mn!==null&&(Oi?(e=Mn,n=n.stateNode,e.nodeType===8?yy(e.parentNode,n):e.nodeType===1&&yy(e,n),Sf(e)):yy(Mn,n.stateNode));break;case 4:r=Mn,i=Oi,Mn=n.stateNode.containerInfo,Oi=!0,ea(e,t,n),Mn=r,Oi=i;break;case 0:case 11:case 14:case 15:if(!Jn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&oC(n,t,o),i=i.next}while(i!==r)}ea(e,t,n);break;case 1:if(!Jn&&(Dl(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Zt(n,t,a)}ea(e,t,n);break;case 21:ea(e,t,n);break;case 22:n.mode&1?(Jn=(r=Jn)||n.memoizedState!==null,ea(e,t,n),Jn=r):ea(e,t,n);break;default:ea(e,t,n)}}function nA(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new L3),t.forEach(function(r){var i=z3.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Si(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Mn=a.stateNode,Oi=!1;break e;case 3:Mn=a.stateNode.containerInfo,Oi=!0;break e;case 4:Mn=a.stateNode.containerInfo,Oi=!0;break e}a=a.return}if(Mn===null)throw Error(oe(160));Ix(s,o,i),Mn=null,Oi=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){Zt(i,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Sx(t,e),t=t.sibling}function Sx(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Si(t,e),rs(e),r&4){try{Qd(3,e,e.return),Vm(3,e)}catch(m){Zt(e,e.return,m)}try{Qd(5,e,e.return)}catch(m){Zt(e,e.return,m)}}break;case 1:Si(t,e),rs(e),r&512&&n!==null&&Dl(n,n.return);break;case 5:if(Si(t,e),rs(e),r&512&&n!==null&&Dl(n,n.return),e.flags&32){var i=e.stateNode;try{vf(i,"")}catch(m){Zt(e,e.return,m)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&W_(i,s),M0(a,o);var l=M0(a,s);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?Z_(i,d):u==="dangerouslySetInnerHTML"?$_(i,d):u==="children"?vf(i,d):pS(i,u,d,l)}switch(a){case"input":_0(i,s);break;case"textarea":j_(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?Kl(i,!!s.multiple,h,!1):f!==!!s.multiple&&(s.defaultValue!=null?Kl(i,!!s.multiple,s.defaultValue,!0):Kl(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ef]=s}catch(m){Zt(e,e.return,m)}}break;case 6:if(Si(t,e),rs(e),r&4){if(e.stateNode===null)throw Error(oe(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){Zt(e,e.return,m)}}break;case 3:if(Si(t,e),rs(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Sf(t.containerInfo)}catch(m){Zt(e,e.return,m)}break;case 4:Si(t,e),rs(e);break;case 13:Si(t,e),rs(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(ZS=tn())),r&4&&nA(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(Jn=(l=Jn)||u,Si(t,e),Jn=l):Si(t,e),rs(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!u&&e.mode&1)for(he=e,u=e.child;u!==null;){for(d=he=u;he!==null;){switch(f=he,h=f.child,f.tag){case 0:case 11:case 14:case 15:Qd(4,f,f.return);break;case 1:Dl(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){Zt(r,n,m)}}break;case 5:Dl(f,f.return);break;case 22:if(f.memoizedState!==null){iA(d);continue}}h!==null?(h.return=f,he=h):iA(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,l?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=z_("display",o))}catch(m){Zt(e,e.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(m){Zt(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Si(t,e),rs(e),r&4&&nA(e);break;case 21:break;default:Si(t,e),rs(e)}}function rs(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Cx(n)){var r=n;break e}n=n.return}throw Error(oe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(vf(i,""),r.flags&=-33);var s=tA(e);lC(e,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=tA(e);cC(e,a,o);break;default:throw Error(oe(161))}}catch(c){Zt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function F3(e,t,n){he=e,bx(e)}function bx(e,t,n){for(var r=(e.mode&1)!==0;he!==null;){var i=he,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Jh;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Jn;a=Jh;var l=Jn;if(Jh=o,(Jn=c)&&!l)for(he=i;he!==null;)o=he,c=o.child,o.tag===22&&o.memoizedState!==null?sA(i):c!==null?(c.return=o,he=c):sA(i);for(;s!==null;)he=s,bx(s),s=s.sibling;he=i,Jh=a,Jn=l}rA(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,he=s):rA(e)}}function rA(e){for(;he!==null;){var t=he;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Jn||Vm(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Jn)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Ai(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Vk(t,s,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Vk(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Sf(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}Jn||t.flags&512&&aC(t)}catch(f){Zt(t,t.return,f)}}if(t===e){he=null;break}if(n=t.sibling,n!==null){n.return=t.return,he=n;break}he=t.return}}function iA(e){for(;he!==null;){var t=he;if(t===e){he=null;break}var n=t.sibling;if(n!==null){n.return=t.return,he=n;break}he=t.return}}function sA(e){for(;he!==null;){var t=he;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Vm(4,t)}catch(c){Zt(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(c){Zt(t,i,c)}}var s=t.return;try{aC(t)}catch(c){Zt(t,s,c)}break;case 5:var o=t.return;try{aC(t)}catch(c){Zt(t,o,c)}}}catch(c){Zt(t,t.return,c)}if(t===e){he=null;break}var a=t.sibling;if(a!==null){a.return=t.return,he=a;break}he=t.return}}var U3=Math.ceil,Rg=Zo.ReactCurrentDispatcher,$S=Zo.ReactCurrentOwner,gi=Zo.ReactCurrentBatchConfig,qe=0,Rn=null,an=null,Fn=0,Wr=0,Ll=Qa(0),mn=0,Pf=null,Fc=0,Gm=0,zS=0,ef=null,wr=null,ZS=0,Eu=1/0,Js=null,xg=!1,uC=null,Ba=null,Yh=!1,ba=null,Ng=0,tf=0,dC=null,Pp=-1,Mp=0;function pr(){return qe&6?tn():Pp!==-1?Pp:Pp=tn()}function Fa(e){return e.mode&1?qe&2&&Fn!==0?Fn&-Fn:b3.transition!==null?(Mp===0&&(Mp=sR()),Mp):(e=ot,e!==0||(e=window.event,e=e===void 0?16:fR(e.type)),e):1}function Zi(e,t,n,r){if(50<tf)throw tf=0,dC=null,Error(oe(185));uh(e,n,r),(!(qe&2)||e!==Rn)&&(e===Rn&&(!(qe&2)&&(Gm|=n),mn===4&&ya(e,Fn)),Nr(e,r),n===1&&qe===0&&!(t.mode&1)&&(Eu=tn()+500,Bm&&ec()))}function Nr(e,t){var n=e.callbackNode;bF(e,t);var r=pg(e,e===Rn?Fn:0);if(r===0)n!==null&&pk(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&pk(n),t===1)e.tag===0?S3(oA.bind(null,e)):NR(oA.bind(null,e)),v3(function(){!(qe&6)&&ec()}),n=null;else{switch(oR(r)){case 1:n=CS;break;case 4:n=rR;break;case 16:n=hg;break;case 536870912:n=iR;break;default:n=hg}n=xx(n,wx.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function wx(e,t){if(Pp=-1,Mp=0,qe&6)throw Error(oe(327));var n=e.callbackNode;if(eu()&&e.callbackNode!==n)return null;var r=pg(e,e===Rn?Fn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Pg(e,r);else{t=r;var i=qe;qe|=2;var s=Ax();(Rn!==e||Fn!==t)&&(Js=null,Eu=tn()+500,Rc(e,t));do try{W3();break}catch(a){kx(e,a)}while(!0);PS(),Rg.current=s,qe=i,an!==null?t=0:(Rn=null,Fn=0,t=mn)}if(t!==0){if(t===2&&(i=F0(e),i!==0&&(r=i,t=fC(e,i))),t===1)throw n=Pf,Rc(e,0),ya(e,r),Nr(e,tn()),n;if(t===6)ya(e,r);else{if(i=e.current.alternate,!(r&30)&&!V3(i)&&(t=Pg(e,r),t===2&&(s=F0(e),s!==0&&(r=s,t=fC(e,s))),t===1))throw n=Pf,Rc(e,0),ya(e,r),Nr(e,tn()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(oe(345));case 2:fc(e,wr,Js);break;case 3:if(ya(e,r),(r&130023424)===r&&(t=ZS+500-tn(),10<t)){if(pg(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){pr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=z0(fc.bind(null,e,wr,Js),t);break}fc(e,wr,Js);break;case 4:if(ya(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-zi(r);s=1<<o,o=t[o],o>i&&(i=o),r&=~s}if(r=i,r=tn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*U3(r/1960))-r,10<r){e.timeoutHandle=z0(fc.bind(null,e,wr,Js),r);break}fc(e,wr,Js);break;case 5:fc(e,wr,Js);break;default:throw Error(oe(329))}}}return Nr(e,tn()),e.callbackNode===n?wx.bind(null,e):null}function fC(e,t){var n=ef;return e.current.memoizedState.isDehydrated&&(Rc(e,t).flags|=256),e=Pg(e,t),e!==2&&(t=wr,wr=n,t!==null&&hC(t)),e}function hC(e){wr===null?wr=e:wr.push.apply(wr,e)}function V3(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ji(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ya(e,t){for(t&=~zS,t&=~Gm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-zi(t),r=1<<n;e[n]=-1,t&=~r}}function oA(e){if(qe&6)throw Error(oe(327));eu();var t=pg(e,0);if(!(t&1))return Nr(e,tn()),null;var n=Pg(e,t);if(e.tag!==0&&n===2){var r=F0(e);r!==0&&(t=r,n=fC(e,r))}if(n===1)throw n=Pf,Rc(e,0),ya(e,t),Nr(e,tn()),n;if(n===6)throw Error(oe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,fc(e,wr,Js),Nr(e,tn()),null}function XS(e,t){var n=qe;qe|=1;try{return e(t)}finally{qe=n,qe===0&&(Eu=tn()+500,Bm&&ec())}}function Uc(e){ba!==null&&ba.tag===0&&!(qe&6)&&eu();var t=qe;qe|=1;var n=gi.transition,r=ot;try{if(gi.transition=null,ot=1,e)return e()}finally{ot=r,gi.transition=n,qe=t,!(qe&6)&&ec()}}function KS(){Wr=Ll.current,Ot(Ll)}function Rc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,m3(n)),an!==null)for(n=an.return;n!==null;){var r=n;switch(RS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Cg();break;case 3:ku(),Ot(Rr),Ot(er),FS();break;case 5:BS(r);break;case 4:ku();break;case 13:Ot(Vt);break;case 19:Ot(Vt);break;case 10:MS(r.type._context);break;case 22:case 23:KS()}n=n.return}if(Rn=e,an=e=Ua(e.current,null),Fn=Wr=t,mn=0,Pf=null,zS=Gm=Fc=0,wr=ef=null,Cc!==null){for(t=0;t<Cc.length;t++)if(n=Cc[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Cc=null}return e}function kx(e,t){do{var n=an;try{if(PS(),Rp.current=_g,Tg){for(var r=Wt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Tg=!1}if(Bc=0,En=hn=Wt=null,qd=!1,Rf=0,$S.current=null,n===null||n.return===null){mn=1,Pf=t,an=null;break}e:{var s=e,o=n.return,a=n,c=t;if(t=Fn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=Zk(o);if(h!==null){h.flags&=-257,Xk(h,o,a,s,t),h.mode&1&&zk(s,l,t),t=h,c=l;var p=t.updateQueue;if(p===null){var m=new Set;m.add(c),t.updateQueue=m}else p.add(c);break e}else{if(!(t&1)){zk(s,l,t),JS();break e}c=Error(oe(426))}}else if(Ft&&a.mode&1){var y=Zk(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Xk(y,o,a,s,t),xS(Au(c,a));break e}}s=c=Au(c,a),mn!==4&&(mn=2),ef===null?ef=[s]:ef.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var g=ax(s,c,t);Uk(s,g);break e;case 1:a=c;var v=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Ba===null||!Ba.has(S)))){s.flags|=65536,t&=-t,s.lanes|=t;var E=cx(s,a,t);Uk(s,E);break e}}s=s.return}while(s!==null)}Tx(n)}catch(k){t=k,an===n&&n!==null&&(an=n=n.return);continue}break}while(!0)}function Ax(){var e=Rg.current;return Rg.current=_g,e===null?_g:e}function JS(){(mn===0||mn===3||mn===2)&&(mn=4),Rn===null||!(Fc&268435455)&&!(Gm&268435455)||ya(Rn,Fn)}function Pg(e,t){var n=qe;qe|=2;var r=Ax();(Rn!==e||Fn!==t)&&(Js=null,Rc(e,t));do try{G3();break}catch(i){kx(e,i)}while(!0);if(PS(),qe=n,Rg.current=r,an!==null)throw Error(oe(261));return Rn=null,Fn=0,mn}function G3(){for(;an!==null;)Ex(an)}function W3(){for(;an!==null&&!hF();)Ex(an)}function Ex(e){var t=Rx(e.alternate,e,Wr);e.memoizedProps=e.pendingProps,t===null?Tx(e):an=t,$S.current=null}function Tx(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=D3(n,t),n!==null){n.flags&=32767,an=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mn=6,an=null;return}}else if(n=O3(n,t,Wr),n!==null){an=n;return}if(t=t.sibling,t!==null){an=t;return}an=t=e}while(t!==null);mn===0&&(mn=5)}function fc(e,t,n){var r=ot,i=gi.transition;try{gi.transition=null,ot=1,j3(e,t,n,r)}finally{gi.transition=i,ot=r}return null}function j3(e,t,n,r){do eu();while(ba!==null);if(qe&6)throw Error(oe(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(oe(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(wF(e,s),e===Rn&&(an=Rn=null,Fn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Yh||(Yh=!0,xx(hg,function(){return eu(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=gi.transition,gi.transition=null;var o=ot;ot=1;var a=qe;qe|=4,$S.current=null,B3(e,n),Sx(n,e),l3(H0),gg=!!j0,H0=j0=null,e.current=n,F3(n),pF(),qe=a,ot=o,gi.transition=s}else e.current=n;if(Yh&&(Yh=!1,ba=e,Ng=i),s=e.pendingLanes,s===0&&(Ba=null),vF(n.stateNode),Nr(e,tn()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(xg)throw xg=!1,e=uC,uC=null,e;return Ng&1&&e.tag!==0&&eu(),s=e.pendingLanes,s&1?e===dC?tf++:(tf=0,dC=e):tf=0,ec(),null}function eu(){if(ba!==null){var e=oR(Ng),t=gi.transition,n=ot;try{if(gi.transition=null,ot=16>e?16:e,ba===null)var r=!1;else{if(e=ba,ba=null,Ng=0,qe&6)throw Error(oe(331));var i=qe;for(qe|=4,he=e.current;he!==null;){var s=he,o=s.child;if(he.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(he=l;he!==null;){var u=he;switch(u.tag){case 0:case 11:case 15:Qd(8,u,s)}var d=u.child;if(d!==null)d.return=u,he=d;else for(;he!==null;){u=he;var f=u.sibling,h=u.return;if(yx(u),u===l){he=null;break}if(f!==null){f.return=h,he=f;break}he=h}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}he=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,he=o;else e:for(;he!==null;){if(s=he,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Qd(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,he=g;break e}he=s.return}}var v=e.current;for(he=v;he!==null;){o=he;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,he=S;else e:for(o=v;he!==null;){if(a=he,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Vm(9,a)}}catch(k){Zt(a,a.return,k)}if(a===o){he=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,he=E;break e}he=a.return}}if(qe=i,ec(),Bs&&typeof Bs.onPostCommitFiberRoot=="function")try{Bs.onPostCommitFiberRoot(Pm,e)}catch{}r=!0}return r}finally{ot=n,gi.transition=t}}return!1}function aA(e,t,n){t=Au(n,t),t=ax(e,t,1),e=La(e,t,1),t=pr(),e!==null&&(uh(e,1,t),Nr(e,t))}function Zt(e,t,n){if(e.tag===3)aA(e,e,n);else for(;t!==null;){if(t.tag===3){aA(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ba===null||!Ba.has(r))){e=Au(n,e),e=cx(t,e,1),t=La(t,e,1),e=pr(),t!==null&&(uh(t,1,e),Nr(t,e));break}}t=t.return}}function H3(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=pr(),e.pingedLanes|=e.suspendedLanes&n,Rn===e&&(Fn&n)===n&&(mn===4||mn===3&&(Fn&130023424)===Fn&&500>tn()-ZS?Rc(e,0):zS|=n),Nr(e,t)}function _x(e,t){t===0&&(e.mode&1?(t=Gh,Gh<<=1,!(Gh&130023424)&&(Gh=4194304)):t=1);var n=pr();e=Bo(e,t),e!==null&&(uh(e,t,n),Nr(e,n))}function $3(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),_x(e,n)}function z3(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(oe(314))}r!==null&&r.delete(t),_x(e,n)}var Rx;Rx=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Rr.current)Er=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Er=!1,M3(e,t,n);Er=!!(e.flags&131072)}else Er=!1,Ft&&t.flags&1048576&&PR(t,bg,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Np(e,t),e=t.pendingProps;var i=Su(t,er.current);Ql(t,n),i=VS(null,t,r,e,i,n);var s=GS();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,xr(r)?(s=!0,Ig(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,DS(t),i.updater=Fm,t.stateNode=i,i._reactInternals=t,Q0(t,r,e,n),t=nC(null,t,r,!0,s,n)):(t.tag=0,Ft&&s&&_S(t),sr(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Np(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=X3(r),e=Ai(r,e),i){case 0:t=tC(null,t,r,e,n);break e;case 1:t=Yk(null,t,r,e,n);break e;case 11:t=Kk(null,t,r,e,n);break e;case 14:t=Jk(null,t,r,Ai(r.type,e),n);break e}throw Error(oe(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ai(r,i),tC(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ai(r,i),Yk(e,t,r,i,n);case 3:e:{if(fx(t),e===null)throw Error(oe(387));r=t.pendingProps,s=t.memoizedState,i=s.element,LR(e,t),Ag(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Au(Error(oe(423)),t),t=qk(e,t,r,n,i);break e}else if(r!==i){i=Au(Error(oe(424)),t),t=qk(e,t,r,n,i);break e}else for(Kr=Da(t.stateNode.containerInfo.firstChild),Yr=t,Ft=!0,Bi=null,n=VR(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(bu(),r===i){t=Fo(e,t,n);break e}sr(e,t,r,n)}t=t.child}return t;case 5:return GR(t),e===null&&J0(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,$0(r,i)?o=null:s!==null&&$0(r,s)&&(t.flags|=32),dx(e,t),sr(e,t,o,n),t.child;case 6:return e===null&&J0(t),null;case 13:return hx(e,t,n);case 4:return LS(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=wu(t,null,r,n):sr(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ai(r,i),Kk(e,t,r,i,n);case 7:return sr(e,t,t.pendingProps,n),t.child;case 8:return sr(e,t,t.pendingProps.children,n),t.child;case 12:return sr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Tt(wg,r._currentValue),r._currentValue=o,s!==null)if(Ji(s.value,o)){if(s.children===i.children&&!Rr.current){t=Fo(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=No(-1,n&-n),c.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Y0(s.return,n,t),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(oe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Y0(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}sr(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ql(t,n),i=mi(i),r=r(i),t.flags|=1,sr(e,t,r,n),t.child;case 14:return r=t.type,i=Ai(r,t.pendingProps),i=Ai(r.type,i),Jk(e,t,r,i,n);case 15:return lx(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ai(r,i),Np(e,t),t.tag=1,xr(r)?(e=!0,Ig(t)):e=!1,Ql(t,n),FR(t,r,i),Q0(t,r,i,n),nC(null,t,r,!0,e,n);case 19:return px(e,t,n);case 22:return ux(e,t,n)}throw Error(oe(156,t.tag))};function xx(e,t){return nR(e,t)}function Z3(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(e,t,n,r){return new Z3(e,t,n,r)}function YS(e){return e=e.prototype,!(!e||!e.isReactComponent)}function X3(e){if(typeof e=="function")return YS(e)?1:0;if(e!=null){if(e=e.$$typeof,e===mS)return 11;if(e===vS)return 14}return 2}function Ua(e,t){var n=e.alternate;return n===null?(n=di(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Op(e,t,n,r,i,s){var o=2;if(r=e,typeof e=="function")YS(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case El:return xc(n.children,i,s,t);case gS:o=8,i|=8;break;case w0:return e=di(12,n,t,i|2),e.elementType=w0,e.lanes=s,e;case k0:return e=di(13,n,t,i),e.elementType=k0,e.lanes=s,e;case A0:return e=di(19,n,t,i),e.elementType=A0,e.lanes=s,e;case U_:return Wm(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B_:o=10;break e;case F_:o=9;break e;case mS:o=11;break e;case vS:o=14;break e;case ua:o=16,r=null;break e}throw Error(oe(130,e==null?e:typeof e,""))}return t=di(o,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function xc(e,t,n,r){return e=di(7,e,r,t),e.lanes=n,e}function Wm(e,t,n,r){return e=di(22,e,r,t),e.elementType=U_,e.lanes=n,e.stateNode={isHidden:!1},e}function Ey(e,t,n){return e=di(6,e,null,t),e.lanes=n,e}function Ty(e,t,n){return t=di(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function K3(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ay(0),this.expirationTimes=ay(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ay(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function qS(e,t,n,r,i,s,o,a,c){return e=new K3(e,t,n,a,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=di(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},DS(s),e}function J3(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Al,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Nx(e){if(!e)return Za;e=e._reactInternals;e:{if(el(e)!==e||e.tag!==1)throw Error(oe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(xr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(oe(171))}if(e.tag===1){var n=e.type;if(xr(n))return xR(e,n,t)}return t}function Px(e,t,n,r,i,s,o,a,c){return e=qS(n,r,!0,e,i,s,o,a,c),e.context=Nx(null),n=e.current,r=pr(),i=Fa(n),s=No(r,i),s.callback=t??null,La(n,s,i),e.current.lanes=i,uh(e,i,r),Nr(e,r),e}function jm(e,t,n,r){var i=t.current,s=pr(),o=Fa(i);return n=Nx(n),t.context===null?t.context=n:t.pendingContext=n,t=No(s,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=La(i,t,o),e!==null&&(Zi(e,i,o,s),_p(e,i,o)),o}function Mg(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function cA(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function QS(e,t){cA(e,t),(e=e.alternate)&&cA(e,t)}function Y3(){return null}var Mx=typeof reportError=="function"?reportError:function(e){console.error(e)};function eb(e){this._internalRoot=e}Hm.prototype.render=eb.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(oe(409));jm(e,t,null,null)};Hm.prototype.unmount=eb.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Uc(function(){jm(null,e,null,null)}),t[Lo]=null}};function Hm(e){this._internalRoot=e}Hm.prototype.unstable_scheduleHydration=function(e){if(e){var t=lR();e={blockedOn:null,target:e,priority:t};for(var n=0;n<va.length&&t!==0&&t<va[n].priority;n++);va.splice(n,0,e),n===0&&dR(e)}};function tb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $m(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function lA(){}function q3(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var l=Mg(o);s.call(l)}}var o=Px(t,r,e,0,null,!1,!1,"",lA);return e._reactRootContainer=o,e[Lo]=o.current,kf(e.nodeType===8?e.parentNode:e),Uc(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=Mg(c);a.call(l)}}var c=qS(e,0,!1,null,null,!1,!1,"",lA);return e._reactRootContainer=c,e[Lo]=c.current,kf(e.nodeType===8?e.parentNode:e),Uc(function(){jm(t,c,n,r)}),c}function zm(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=Mg(o);a.call(c)}}jm(t,o,e,i)}else o=q3(n,t,e,i,r);return Mg(o)}aR=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Od(t.pendingLanes);n!==0&&(IS(t,n|1),Nr(t,tn()),!(qe&6)&&(Eu=tn()+500,ec()))}break;case 13:Uc(function(){var r=Bo(e,1);if(r!==null){var i=pr();Zi(r,e,1,i)}}),QS(e,1)}};SS=function(e){if(e.tag===13){var t=Bo(e,134217728);if(t!==null){var n=pr();Zi(t,e,134217728,n)}QS(e,134217728)}};cR=function(e){if(e.tag===13){var t=Fa(e),n=Bo(e,t);if(n!==null){var r=pr();Zi(n,e,t,r)}QS(e,t)}};lR=function(){return ot};uR=function(e,t){var n=ot;try{return ot=e,t()}finally{ot=n}};D0=function(e,t,n){switch(t){case"input":if(_0(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Lm(r);if(!i)throw Error(oe(90));G_(r),_0(r,i)}}}break;case"textarea":j_(e,n);break;case"select":t=n.value,t!=null&&Kl(e,!!n.multiple,t,!1)}};J_=XS;Y_=Uc;var Q3={usingClientEntryPoint:!1,Events:[fh,xl,Lm,X_,K_,XS]},vd={findFiberByHostInstance:yc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},e5={bundleType:vd.bundleType,version:vd.version,rendererPackageName:vd.rendererPackageName,rendererConfig:vd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=eR(e),e===null?null:e.stateNode},findFiberByHostInstance:vd.findFiberByHostInstance||Y3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qh.isDisabled&&qh.supportsFiber)try{Pm=qh.inject(e5),Bs=qh}catch{}}ti.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q3;ti.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tb(t))throw Error(oe(200));return J3(e,t,null,n)};ti.createRoot=function(e,t){if(!tb(e))throw Error(oe(299));var n=!1,r="",i=Mx;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=qS(e,1,!1,null,null,n,!1,r,i),e[Lo]=t.current,kf(e.nodeType===8?e.parentNode:e),new eb(t)};ti.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(oe(188)):(e=Object.keys(e).join(","),Error(oe(268,e)));return e=eR(t),e=e===null?null:e.stateNode,e};ti.flushSync=function(e){return Uc(e)};ti.hydrate=function(e,t,n){if(!$m(t))throw Error(oe(200));return zm(null,e,t,!0,n)};ti.hydrateRoot=function(e,t,n){if(!tb(e))throw Error(oe(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=Mx;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Px(t,null,e,1,n??null,i,!1,s,o),e[Lo]=t.current,kf(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Hm(t)};ti.render=function(e,t,n){if(!$m(t))throw Error(oe(200));return zm(null,e,t,!1,n)};ti.unmountComponentAtNode=function(e){if(!$m(e))throw Error(oe(40));return e._reactRootContainer?(Uc(function(){zm(null,null,e,!1,function(){e._reactRootContainer=null,e[Lo]=null})}),!0):!1};ti.unstable_batchedUpdates=XS;ti.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!$m(n))throw Error(oe(200));if(e==null||e._reactInternals===void 0)throw Error(oe(38));return zm(e,t,n,!1,r)};ti.version="18.2.0-next-9e3b772b8-20220608";function Ox(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ox)}catch(e){console.error(e)}}Ox(),P_.exports=ti;var nb=P_.exports;const t5=ch(nb),n5=S_({__proto__:null,default:t5},[nb]);var uA=nb;S0.createRoot=uA.createRoot,S0.hydrateRoot=uA.hydrateRoot;/**
 * @remix-run/router v1.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xt(){return Xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xt.apply(this,arguments)}var qt;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(qt||(qt={}));const dA="popstate";function r5(e){e===void 0&&(e={});function t(r,i){let{pathname:s,search:o,hash:a}=r.location;return Mf("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:ph(i)}return s5(t,n,null,e)}function Xe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Vc(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function i5(){return Math.random().toString(36).substr(2,8)}function fA(e,t){return{usr:e.state,key:e.key,idx:t}}function Mf(e,t,n,r){return n===void 0&&(n=null),Xt({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Xo(t):t,{state:n,key:t&&t.key||r||i5()})}function ph(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Xo(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function s5(e,t,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=qt.Pop,c=null,l=u();l==null&&(l=0,o.replaceState(Xt({},o.state,{idx:l}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=qt.Pop;let y=u(),g=y==null?null:y-l;l=y,c&&c({action:a,location:m.location,delta:g})}function f(y,g){a=qt.Push;let v=Mf(m.location,y,g);n&&n(v,y),l=u()+1;let S=fA(v,l),E=m.createHref(v);try{o.pushState(S,"",E)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(E)}s&&c&&c({action:a,location:m.location,delta:1})}function h(y,g){a=qt.Replace;let v=Mf(m.location,y,g);n&&n(v,y),l=u();let S=fA(v,l),E=m.createHref(v);o.replaceState(S,"",E),s&&c&&c({action:a,location:m.location,delta:0})}function p(y){let g=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof y=="string"?y:ph(y);return Xe(g,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,g)}let m={get action(){return a},get location(){return e(i,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(dA,d),c=y,()=>{i.removeEventListener(dA,d),c=null}},createHref(y){return t(i,y)},createURL:p,encodeLocation(y){let g=p(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(y){return o.go(y)}};return m}var zt;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(zt||(zt={}));const o5=new Set(["lazy","caseSensitive","path","id","index","children"]);function a5(e){return e.index===!0}function pC(e,t,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),e.map((i,s)=>{let o=[...n,s],a=typeof i.id=="string"?i.id:o.join("-");if(Xe(i.index!==!0||!i.children,"Cannot specify children on an index route"),Xe(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),a5(i)){let c=Xt({},i,t(i),{id:a});return r[a]=c,c}else{let c=Xt({},i,t(i),{id:a,children:void 0});return r[a]=c,i.children&&(c.children=pC(i.children,t,o,r)),c}})}function Bl(e,t,n){n===void 0&&(n="/");let r=typeof t=="string"?Xo(t):t,i=gh(r.pathname||"/",n);if(i==null)return null;let s=Dx(e);l5(s);let o=null;for(let a=0;o==null&&a<s.length;++a)o=y5(s[a],S5(i));return o}function c5(e,t){let{route:n,pathname:r,params:i}=e;return{id:n.id,pathname:r,params:i,data:t[n.id],handle:n.handle}}function Dx(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let c={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(Xe(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let l=Nc([r,c.relativePath]),u=n.concat(c);s.children&&s.children.length>0&&(Xe(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),Dx(s.children,t,u,l)),!(s.path==null&&!s.index)&&t.push({path:l,score:m5(l,s.index),routesMeta:u})};return e.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let c of Lx(s.path))i(s,o,c)}),t}function Lx(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=Lx(r.join("/")),a=[];return a.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&a.push(...o),a.map(c=>e.startsWith("/")&&c===""?"/":c)}function l5(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:v5(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const u5=/^:[\w-]+$/,d5=3,f5=2,h5=1,p5=10,g5=-2,hA=e=>e==="*";function m5(e,t){let n=e.split("/"),r=n.length;return n.some(hA)&&(r+=g5),t&&(r+=f5),n.filter(i=>!hA(i)).reduce((i,s)=>i+(u5.test(s)?d5:s===""?h5:p5),r)}function v5(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function y5(e,t){let{routesMeta:n}=e,r={},i="/",s=[];for(let o=0;o<n.length;++o){let a=n[o],c=o===n.length-1,l=i==="/"?t:t.slice(i.length)||"/",u=C5({path:a.relativePath,caseSensitive:a.caseSensitive,end:c},l);if(!u)return null;Object.assign(r,u.params);let d=a.route;s.push({params:r,pathname:Nc([i,u.pathname]),pathnameBase:T5(Nc([i,u.pathnameBase])),route:d}),u.pathnameBase!=="/"&&(i=Nc([i,u.pathnameBase]))}return s}function C5(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=I5(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((l,u,d)=>{let{paramName:f,isOptional:h}=u;if(f==="*"){let m=a[d]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?l[f]=void 0:l[f]=b5(p||"",f),l},{}),pathname:s,pathnameBase:o,pattern:e}}function I5(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Vc(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function S5(e){try{return decodeURI(e)}catch(t){return Vc(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function b5(e,t){try{return decodeURIComponent(e)}catch(n){return Vc(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),e}}function gh(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function w5(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?Xo(e):e;return{pathname:n?n.startsWith("/")?n:k5(n,t):t,search:_5(r),hash:R5(i)}}function k5(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function _y(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Bx(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function A5(e,t){let n=Bx(e);return t?n.map((r,i)=>i===e.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function E5(e,t,n,r){r===void 0&&(r=!1);let i;typeof e=="string"?i=Xo(e):(i=Xt({},e),Xe(!i.pathname||!i.pathname.includes("?"),_y("?","pathname","search",i)),Xe(!i.pathname||!i.pathname.includes("#"),_y("#","pathname","hash",i)),Xe(!i.search||!i.search.includes("#"),_y("#","search","hash",i)));let s=e===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let d=t.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?t[d]:"/"}let c=w5(i,a),l=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}const Nc=e=>e.join("/").replace(/\/\/+/g,"/"),T5=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),_5=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,R5=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class rb{constructor(t,n,r,i){i===void 0&&(i=!1),this.status=t,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Fx(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Ux=["post","put","patch","delete"],x5=new Set(Ux),N5=["get",...Ux],P5=new Set(N5),M5=new Set([301,302,303,307,308]),O5=new Set([307,308]),Ry={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},D5={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},yd={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Vx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,L5=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),Gx="remix-router-transitions";function B5(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",r=!n;Xe(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(e.mapRouteProperties)i=e.mapRouteProperties;else if(e.detectErrorBoundary){let B=e.detectErrorBoundary;i=H=>({hasErrorBoundary:B(H)})}else i=L5;let s={},o=pC(e.routes,i,void 0,s),a,c=e.basename||"/",l=Xt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1},e.future),u=null,d=new Set,f=null,h=null,p=null,m=e.hydrationData!=null,y=Bl(o,e.history.location,c),g=null;if(y==null){let B=ai(404,{pathname:e.history.location.pathname}),{matches:H,route:ee}=SA(o);y=H,g={[ee.id]:B}}let v,S=y.some(B=>B.route.lazy),E=y.some(B=>B.route.loader);if(S)v=!1;else if(!E)v=!0;else if(l.v7_partialHydration){let B=e.hydrationData?e.hydrationData.loaderData:null,H=e.hydrationData?e.hydrationData.errors:null;v=y.every(ee=>ee.route.loader&&ee.route.loader.hydrate!==!0&&(B&&B[ee.route.id]!==void 0||H&&H[ee.route.id]!==void 0))}else v=e.hydrationData!=null;let k,b={historyAction:e.history.action,location:e.history.location,matches:y,initialized:v,navigation:Ry,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||g,fetchers:new Map,blockers:new Map},A=qt.Pop,_=!1,P,N=!1,O=new Map,D=null,U=!1,G=!1,z=[],$=[],q=new Map,W=0,X=-1,ne=new Map,Z=new Set,ie=new Map,ke=new Map,Ee=new Set,ge=new Map,Te=new Map,Qe=!1;function ae(){if(u=e.history.listen(B=>{let{action:H,location:ee,delta:ue}=B;if(Qe){Qe=!1;return}Vc(Te.size===0||ue!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ye=ht({currentLocation:b.location,nextLocation:ee,historyAction:H});if(ye&&ue!=null){Qe=!0,e.history.go(ue*-1),ft(ye,{state:"blocked",location:ee,proceed(){ft(ye,{state:"proceeding",proceed:void 0,reset:void 0,location:ee}),e.history.go(ue)},reset(){let We=new Map(b.blockers);We.set(ye,yd),Ct({blockers:We})}});return}return ce(H,ee)}),n){X5(t,O);let B=()=>K5(t,O);t.addEventListener("pagehide",B),D=()=>t.removeEventListener("pagehide",B)}return b.initialized||ce(qt.Pop,b.location,{initialHydration:!0}),k}function rn(){u&&u(),D&&D(),d.clear(),P&&P.abort(),b.fetchers.forEach((B,H)=>T(H)),b.blockers.forEach((B,H)=>Oe(H))}function In(B){return d.add(B),()=>d.delete(B)}function Ct(B,H){H===void 0&&(H={}),b=Xt({},b,B);let ee=[],ue=[];l.v7_fetcherPersist&&b.fetchers.forEach((ye,We)=>{ye.state==="idle"&&(Ee.has(We)?ue.push(We):ee.push(We))}),[...d].forEach(ye=>ye(b,{deletedFetchers:ue,unstable_viewTransitionOpts:H.viewTransitionOpts,unstable_flushSync:H.flushSync===!0})),l.v7_fetcherPersist&&(ee.forEach(ye=>b.fetchers.delete(ye)),ue.forEach(ye=>T(ye)))}function cn(B,H,ee){var ue,ye;let{flushSync:We}=ee===void 0?{}:ee,xe=b.actionData!=null&&b.navigation.formMethod!=null&&Di(b.navigation.formMethod)&&b.navigation.state==="loading"&&((ue=B.state)==null?void 0:ue._isRedirect)!==!0,Re;H.actionData?Object.keys(H.actionData).length>0?Re=H.actionData:Re=null:xe?Re=b.actionData:Re=null;let we=H.loaderData?IA(b.loaderData,H.loaderData,H.matches||[],H.errors):b.loaderData,ze=b.blockers;ze.size>0&&(ze=new Map(ze),ze.forEach((St,Nn)=>ze.set(Nn,yd)));let bn=_===!0||b.navigation.formMethod!=null&&Di(b.navigation.formMethod)&&((ye=B.state)==null?void 0:ye._isRedirect)!==!0;a&&(o=a,a=void 0),U||A===qt.Pop||(A===qt.Push?e.history.push(B,B.state):A===qt.Replace&&e.history.replace(B,B.state));let Be;if(A===qt.Pop){let St=O.get(b.location.pathname);St&&St.has(B.pathname)?Be={currentLocation:b.location,nextLocation:B}:O.has(B.pathname)&&(Be={currentLocation:B,nextLocation:b.location})}else if(N){let St=O.get(b.location.pathname);St?St.add(B.pathname):(St=new Set([B.pathname]),O.set(b.location.pathname,St)),Be={currentLocation:b.location,nextLocation:B}}Ct(Xt({},H,{actionData:Re,loaderData:we,historyAction:A,location:B,initialized:!0,navigation:Ry,revalidation:"idle",restoreScrollPosition:tk(B,H.matches||b.matches),preventScrollReset:bn,blockers:ze}),{viewTransitionOpts:Be,flushSync:We===!0}),A=qt.Pop,_=!1,N=!1,U=!1,G=!1,z=[],$=[]}async function dt(B,H){if(typeof B=="number"){e.history.go(B);return}let ee=gC(b.location,b.matches,c,l.v7_prependBasename,B,l.v7_relativeSplatPath,H==null?void 0:H.fromRouteId,H==null?void 0:H.relative),{path:ue,submission:ye,error:We}=pA(l.v7_normalizeFormMethod,!1,ee,H),xe=b.location,Re=Mf(b.location,ue,H&&H.state);Re=Xt({},Re,e.history.encodeLocation(Re));let we=H&&H.replace!=null?H.replace:void 0,ze=qt.Push;we===!0?ze=qt.Replace:we===!1||ye!=null&&Di(ye.formMethod)&&ye.formAction===b.location.pathname+b.location.search&&(ze=qt.Replace);let bn=H&&"preventScrollReset"in H?H.preventScrollReset===!0:void 0,Be=(H&&H.unstable_flushSync)===!0,St=ht({currentLocation:xe,nextLocation:Re,historyAction:ze});if(St){ft(St,{state:"blocked",location:Re,proceed(){ft(St,{state:"proceeding",proceed:void 0,reset:void 0,location:Re}),dt(B,H)},reset(){let Nn=new Map(b.blockers);Nn.set(St,yd),Ct({blockers:Nn})}});return}return await ce(ze,Re,{submission:ye,pendingError:We,preventScrollReset:bn,replace:H&&H.replace,enableViewTransition:H&&H.unstable_viewTransition,flushSync:Be})}function Ut(){if(Pe(),Ct({revalidation:"loading"}),b.navigation.state!=="submitting"){if(b.navigation.state==="idle"){ce(b.historyAction,b.location,{startUninterruptedRevalidation:!0});return}ce(A||b.historyAction,b.navigation.location,{overrideNavigation:b.navigation})}}async function ce(B,H,ee){P&&P.abort(),P=null,A=B,U=(ee&&ee.startUninterruptedRevalidation)===!0,kB(b.location,b.matches),_=(ee&&ee.preventScrollReset)===!0,N=(ee&&ee.enableViewTransition)===!0;let ue=a||o,ye=ee&&ee.overrideNavigation,We=Bl(ue,H,c),xe=(ee&&ee.flushSync)===!0;if(!We){let Nn=ai(404,{pathname:H.pathname}),{matches:ii,route:wn}=SA(ue);It(),cn(H,{matches:ii,loaderData:{},errors:{[wn.id]:Nn}},{flushSync:xe});return}if(b.initialized&&!G&&W5(b.location,H)&&!(ee&&ee.submission&&Di(ee.submission.formMethod))){cn(H,{matches:We},{flushSync:xe});return}P=new AbortController;let Re=Id(e.history,H,P.signal,ee&&ee.submission),we,ze;if(ee&&ee.pendingError)ze={[nf(We).route.id]:ee.pendingError};else if(ee&&ee.submission&&Di(ee.submission.formMethod)){let Nn=await Ce(Re,H,ee.submission,We,{replace:ee.replace,flushSync:xe});if(Nn.shortCircuited)return;we=Nn.pendingActionData,ze=Nn.pendingActionError,ye=xy(H,ee.submission),xe=!1,Re=new Request(Re.url,{signal:Re.signal})}let{shortCircuited:bn,loaderData:Be,errors:St}=await rt(Re,H,We,ye,ee&&ee.submission,ee&&ee.fetcherSubmission,ee&&ee.replace,ee&&ee.initialHydration===!0,xe,we,ze);bn||(P=null,cn(H,Xt({matches:We},we?{actionData:we}:{},{loaderData:Be,errors:St})))}async function Ce(B,H,ee,ue,ye){ye===void 0&&(ye={}),Pe();let We=z5(H,ee);Ct({navigation:We},{flushSync:ye.flushSync===!0});let xe,Re=vC(ue,H);if(!Re.route.action&&!Re.route.lazy)xe={type:zt.error,error:ai(405,{method:B.method,pathname:H.pathname,routeId:Re.route.id})};else if(xe=await Cd("action",B,Re,ue,s,i,c,l.v7_relativeSplatPath),B.signal.aborted)return{shortCircuited:!0};if(bc(xe)){let we;return ye&&ye.replace!=null?we=ye.replace:we=xe.location===b.location.pathname+b.location.search,await Ie(b,xe,{submission:ee,replace:we}),{shortCircuited:!0}}if(Fl(xe)){let we=nf(ue,Re.route.id);return(ye&&ye.replace)!==!0&&(A=qt.Push),{pendingActionData:{},pendingActionError:{[we.route.id]:xe.error}}}if(Sc(xe))throw ai(400,{type:"defer-action"});return{pendingActionData:{[Re.route.id]:xe.data}}}async function rt(B,H,ee,ue,ye,We,xe,Re,we,ze,bn){let Be=ue||xy(H,ye),St=ye||We||kA(Be),Nn=a||o,[ii,wn]=gA(e.history,b,ee,St,H,l.v7_partialHydration&&Re===!0,G,z,$,Ee,ie,Z,Nn,c,ze,bn);if(It(pt=>!(ee&&ee.some(Lt=>Lt.route.id===pt))||ii&&ii.some(Lt=>Lt.route.id===pt)),X=++W,ii.length===0&&wn.length===0){let pt=L();return cn(H,Xt({matches:ee,loaderData:{},errors:bn||null},ze?{actionData:ze}:{},pt?{fetchers:new Map(b.fetchers)}:{}),{flushSync:we}),{shortCircuited:!0}}if(!U&&(!l.v7_partialHydration||!Re)){wn.forEach(Lt=>{let ns=b.fetchers.get(Lt.key),Oh=Sd(void 0,ns?ns.data:void 0);b.fetchers.set(Lt.key,Oh)});let pt=ze||b.actionData;Ct(Xt({navigation:Be},pt?Object.keys(pt).length===0?{actionData:null}:{actionData:pt}:{},wn.length>0?{fetchers:new Map(b.fetchers)}:{}),{flushSync:we})}wn.forEach(pt=>{q.has(pt.key)&&I(pt.key),pt.controller&&q.set(pt.key,pt.controller)});let dl=()=>wn.forEach(pt=>I(pt.key));P&&P.signal.addEventListener("abort",dl);let{results:Yv,loaderResults:fl,fetcherResults:Qo}=await Ze(b.matches,ee,ii,wn,B);if(B.signal.aborted)return{shortCircuited:!0};P&&P.signal.removeEventListener("abort",dl),wn.forEach(pt=>q.delete(pt.key));let lc=bA(Yv);if(lc){if(lc.idx>=ii.length){let pt=wn[lc.idx-ii.length].key;Z.add(pt)}return await Ie(b,lc.result,{replace:xe}),{shortCircuited:!0}}let{loaderData:qv,errors:Qv}=CA(b,ee,ii,fl,bn,wn,Qo,ge);ge.forEach((pt,Lt)=>{pt.subscribe(ns=>{(ns||pt.done)&&ge.delete(Lt)})});let ey=L(),hl=j(X),Mh=ey||hl||wn.length>0;return Xt({loaderData:qv,errors:Qv},Mh?{fetchers:new Map(b.fetchers)}:{})}function tt(B,H,ee,ue){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");q.has(B)&&I(B);let ye=(ue&&ue.unstable_flushSync)===!0,We=a||o,xe=gC(b.location,b.matches,c,l.v7_prependBasename,ee,l.v7_relativeSplatPath,H,ue==null?void 0:ue.relative),Re=Bl(We,xe,c);if(!Re){Sn(B,H,ai(404,{pathname:xe}),{flushSync:ye});return}let{path:we,submission:ze,error:bn}=pA(l.v7_normalizeFormMethod,!0,xe,ue);if(bn){Sn(B,H,bn,{flushSync:ye});return}let Be=vC(Re,we);if(_=(ue&&ue.preventScrollReset)===!0,ze&&Di(ze.formMethod)){le(B,H,we,Be,Re,ye,ze);return}ie.set(B,{routeId:H,path:we}),Fe(B,H,we,Be,Re,ye,ze)}async function le(B,H,ee,ue,ye,We,xe){if(Pe(),ie.delete(B),!ue.route.action&&!ue.route.lazy){let Lt=ai(405,{method:xe.formMethod,pathname:ee,routeId:H});Sn(B,H,Lt,{flushSync:We});return}let Re=b.fetchers.get(B);Ht(B,Z5(xe,Re),{flushSync:We});let we=new AbortController,ze=Id(e.history,ee,we.signal,xe);q.set(B,we);let bn=W,Be=await Cd("action",ze,ue,ye,s,i,c,l.v7_relativeSplatPath);if(ze.signal.aborted){q.get(B)===we&&q.delete(B);return}if(l.v7_fetcherPersist&&Ee.has(B)){if(bc(Be)||Fl(Be)){Ht(B,ia(void 0));return}}else{if(bc(Be))if(q.delete(B),X>bn){Ht(B,ia(void 0));return}else return Z.add(B),Ht(B,Sd(xe)),Ie(b,Be,{fetcherSubmission:xe});if(Fl(Be)){Sn(B,H,Be.error);return}}if(Sc(Be))throw ai(400,{type:"defer-action"});let St=b.navigation.location||b.location,Nn=Id(e.history,St,we.signal),ii=a||o,wn=b.navigation.state!=="idle"?Bl(ii,b.navigation.location,c):b.matches;Xe(wn,"Didn't find any matches after fetcher action");let dl=++W;ne.set(B,dl);let Yv=Sd(xe,Be.data);b.fetchers.set(B,Yv);let[fl,Qo]=gA(e.history,b,wn,xe,St,!1,G,z,$,Ee,ie,Z,ii,c,{[ue.route.id]:Be.data},void 0);Qo.filter(Lt=>Lt.key!==B).forEach(Lt=>{let ns=Lt.key,Oh=b.fetchers.get(ns),EB=Sd(void 0,Oh?Oh.data:void 0);b.fetchers.set(ns,EB),q.has(ns)&&I(ns),Lt.controller&&q.set(ns,Lt.controller)}),Ct({fetchers:new Map(b.fetchers)});let lc=()=>Qo.forEach(Lt=>I(Lt.key));we.signal.addEventListener("abort",lc);let{results:qv,loaderResults:Qv,fetcherResults:ey}=await Ze(b.matches,wn,fl,Qo,Nn);if(we.signal.aborted)return;we.signal.removeEventListener("abort",lc),ne.delete(B),q.delete(B),Qo.forEach(Lt=>q.delete(Lt.key));let hl=bA(qv);if(hl){if(hl.idx>=fl.length){let Lt=Qo[hl.idx-fl.length].key;Z.add(Lt)}return Ie(b,hl.result)}let{loaderData:Mh,errors:pt}=CA(b,b.matches,fl,Qv,void 0,Qo,ey,ge);if(b.fetchers.has(B)){let Lt=ia(Be.data);b.fetchers.set(B,Lt)}j(dl),b.navigation.state==="loading"&&dl>X?(Xe(A,"Expected pending action"),P&&P.abort(),cn(b.navigation.location,{matches:wn,loaderData:Mh,errors:pt,fetchers:new Map(b.fetchers)})):(Ct({errors:pt,loaderData:IA(b.loaderData,Mh,wn,pt),fetchers:new Map(b.fetchers)}),G=!1)}async function Fe(B,H,ee,ue,ye,We,xe){let Re=b.fetchers.get(B);Ht(B,Sd(xe,Re?Re.data:void 0),{flushSync:We});let we=new AbortController,ze=Id(e.history,ee,we.signal);q.set(B,we);let bn=W,Be=await Cd("loader",ze,ue,ye,s,i,c,l.v7_relativeSplatPath);if(Sc(Be)&&(Be=await Hx(Be,ze.signal,!0)||Be),q.get(B)===we&&q.delete(B),!ze.signal.aborted){if(Ee.has(B)){Ht(B,ia(void 0));return}if(bc(Be))if(X>bn){Ht(B,ia(void 0));return}else{Z.add(B),await Ie(b,Be);return}if(Fl(Be)){Sn(B,H,Be.error);return}Xe(!Sc(Be),"Unhandled fetcher deferred data"),Ht(B,ia(Be.data))}}async function Ie(B,H,ee){let{submission:ue,fetcherSubmission:ye,replace:We}=ee===void 0?{}:ee;H.revalidate&&(G=!0);let xe=Mf(B.location,H.location,{_isRedirect:!0});if(Xe(xe,"Expected a location on the redirect navigation"),n){let St=!1;if(H.reloadDocument)St=!0;else if(Vx.test(H.location)){const Nn=e.history.createURL(H.location);St=Nn.origin!==t.location.origin||gh(Nn.pathname,c)==null}if(St){We?t.location.replace(H.location):t.location.assign(H.location);return}}P=null;let Re=We===!0?qt.Replace:qt.Push,{formMethod:we,formAction:ze,formEncType:bn}=B.navigation;!ue&&!ye&&we&&ze&&bn&&(ue=kA(B.navigation));let Be=ue||ye;if(O5.has(H.status)&&Be&&Di(Be.formMethod))await ce(Re,xe,{submission:Xt({},Be,{formAction:H.location}),preventScrollReset:_});else{let St=xy(xe,ue);await ce(Re,xe,{overrideNavigation:St,fetcherSubmission:ye,preventScrollReset:_})}}async function Ze(B,H,ee,ue,ye){let We=await Promise.all([...ee.map(we=>Cd("loader",ye,we,H,s,i,c,l.v7_relativeSplatPath)),...ue.map(we=>we.matches&&we.match&&we.controller?Cd("loader",Id(e.history,we.path,we.controller.signal),we.match,we.matches,s,i,c,l.v7_relativeSplatPath):{type:zt.error,error:ai(404,{pathname:we.path})})]),xe=We.slice(0,ee.length),Re=We.slice(ee.length);return await Promise.all([wA(B,ee,xe,xe.map(()=>ye.signal),!1,b.loaderData),wA(B,ue.map(we=>we.match),Re,ue.map(we=>we.controller?we.controller.signal:null),!0)]),{results:We,loaderResults:xe,fetcherResults:Re}}function Pe(){G=!0,z.push(...It()),ie.forEach((B,H)=>{q.has(H)&&($.push(H),I(H))})}function Ht(B,H,ee){ee===void 0&&(ee={}),b.fetchers.set(B,H),Ct({fetchers:new Map(b.fetchers)},{flushSync:(ee&&ee.flushSync)===!0})}function Sn(B,H,ee,ue){ue===void 0&&(ue={});let ye=nf(b.matches,H);T(B),Ct({errors:{[ye.route.id]:ee},fetchers:new Map(b.fetchers)},{flushSync:(ue&&ue.flushSync)===!0})}function ul(B){return l.v7_fetcherPersist&&(ke.set(B,(ke.get(B)||0)+1),Ee.has(B)&&Ee.delete(B)),b.fetchers.get(B)||D5}function T(B){let H=b.fetchers.get(B);q.has(B)&&!(H&&H.state==="loading"&&ne.has(B))&&I(B),ie.delete(B),ne.delete(B),Z.delete(B),Ee.delete(B),b.fetchers.delete(B)}function C(B){if(l.v7_fetcherPersist){let H=(ke.get(B)||0)-1;H<=0?(ke.delete(B),Ee.add(B)):ke.set(B,H)}else T(B);Ct({fetchers:new Map(b.fetchers)})}function I(B){let H=q.get(B);Xe(H,"Expected fetch controller: "+B),H.abort(),q.delete(B)}function x(B){for(let H of B){let ee=ul(H),ue=ia(ee.data);b.fetchers.set(H,ue)}}function L(){let B=[],H=!1;for(let ee of Z){let ue=b.fetchers.get(ee);Xe(ue,"Expected fetcher: "+ee),ue.state==="loading"&&(Z.delete(ee),B.push(ee),H=!0)}return x(B),H}function j(B){let H=[];for(let[ee,ue]of ne)if(ue<B){let ye=b.fetchers.get(ee);Xe(ye,"Expected fetcher: "+ee),ye.state==="loading"&&(I(ee),ne.delete(ee),H.push(ee))}return x(H),H.length>0}function Q(B,H){let ee=b.blockers.get(B)||yd;return Te.get(B)!==H&&Te.set(B,H),ee}function Oe(B){b.blockers.delete(B),Te.delete(B)}function ft(B,H){let ee=b.blockers.get(B)||yd;Xe(ee.state==="unblocked"&&H.state==="blocked"||ee.state==="blocked"&&H.state==="blocked"||ee.state==="blocked"&&H.state==="proceeding"||ee.state==="blocked"&&H.state==="unblocked"||ee.state==="proceeding"&&H.state==="unblocked","Invalid blocker state transition: "+ee.state+" -> "+H.state);let ue=new Map(b.blockers);ue.set(B,H),Ct({blockers:ue})}function ht(B){let{currentLocation:H,nextLocation:ee,historyAction:ue}=B;if(Te.size===0)return;Te.size>1&&Vc(!1,"A router only supports one blocker at a time");let ye=Array.from(Te.entries()),[We,xe]=ye[ye.length-1],Re=b.blockers.get(We);if(!(Re&&Re.state==="proceeding")&&xe({currentLocation:H,nextLocation:ee,historyAction:ue}))return We}function It(B){let H=[];return ge.forEach((ee,ue)=>{(!B||B(ue))&&(ee.cancel(),H.push(ue),ge.delete(ue))}),H}function it(B,H,ee){if(f=B,p=H,h=ee||null,!m&&b.navigation===Ry){m=!0;let ue=tk(b.location,b.matches);ue!=null&&Ct({restoreScrollPosition:ue})}return()=>{f=null,p=null,h=null}}function ek(B,H){return h&&h(B,H.map(ue=>c5(ue,b.loaderData)))||B.key}function kB(B,H){if(f&&p){let ee=ek(B,H);f[ee]=p()}}function tk(B,H){if(f){let ee=ek(B,H),ue=f[ee];if(typeof ue=="number")return ue}return null}function AB(B){s={},a=pC(B,i,void 0,s)}return k={get basename(){return c},get future(){return l},get state(){return b},get routes(){return o},get window(){return t},initialize:ae,subscribe:In,enableScrollRestoration:it,navigate:dt,fetch:tt,revalidate:Ut,createHref:B=>e.history.createHref(B),encodeLocation:B=>e.history.encodeLocation(B),getFetcher:ul,deleteFetcher:C,dispose:rn,getBlocker:Q,deleteBlocker:Oe,_internalFetchControllers:q,_internalActiveDeferreds:ge,_internalSetRoutes:AB},k}function F5(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function gC(e,t,n,r,i,s,o,a){let c,l;if(o){c=[];for(let d of t)if(c.push(d),d.route.id===o){l=d;break}}else c=t,l=t[t.length-1];let u=E5(i||".",A5(c,s),gh(e.pathname,n)||e.pathname,a==="path");return i==null&&(u.search=e.search,u.hash=e.hash),(i==null||i===""||i===".")&&l&&l.route.index&&!ib(u.search)&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:Nc([n,u.pathname])),ph(u)}function pA(e,t,n,r){if(!r||!F5(r))return{path:n};if(r.formMethod&&!$5(r.formMethod))return{path:n,error:ai(405,{method:r.formMethod})};let i=()=>({path:n,error:ai(400,{type:"invalid-body"})}),s=r.formMethod||"get",o=e?s.toUpperCase():s.toLowerCase(),a=jx(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Di(o))return i();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[m,y]=p;return""+h+m+"="+y+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!Di(o))return i();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return i()}}}Xe(typeof FormData=="function","FormData is not available in this environment");let c,l;if(r.formData)c=mC(r.formData),l=r.formData;else if(r.body instanceof FormData)c=mC(r.body),l=r.body;else if(r.body instanceof URLSearchParams)c=r.body,l=yA(c);else if(r.body==null)c=new URLSearchParams,l=new FormData;else try{c=new URLSearchParams(r.body),l=yA(c)}catch{return i()}let u={formMethod:o,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:l,json:void 0,text:void 0};if(Di(u.formMethod))return{path:n,submission:u};let d=Xo(n);return t&&d.search&&ib(d.search)&&c.append("index",""),d.search="?"+c,{path:ph(d),submission:u}}function U5(e,t){let n=e;if(t){let r=e.findIndex(i=>i.route.id===t);r>=0&&(n=e.slice(0,r))}return n}function gA(e,t,n,r,i,s,o,a,c,l,u,d,f,h,p,m){let y=m?Object.values(m)[0]:p?Object.values(p)[0]:void 0,g=e.createURL(t.location),v=e.createURL(i),S=m?Object.keys(m)[0]:void 0,k=U5(n,S).filter((A,_)=>{let{route:P}=A;if(P.lazy)return!0;if(P.loader==null)return!1;if(s)return P.loader.hydrate?!0:t.loaderData[P.id]===void 0&&(!t.errors||t.errors[P.id]===void 0);if(V5(t.loaderData,t.matches[_],A)||a.some(D=>D===A.route.id))return!0;let N=t.matches[_],O=A;return mA(A,Xt({currentUrl:g,currentParams:N.params,nextUrl:v,nextParams:O.params},r,{actionResult:y,defaultShouldRevalidate:o||g.pathname+g.search===v.pathname+v.search||g.search!==v.search||Wx(N,O)}))}),b=[];return u.forEach((A,_)=>{if(s||!n.some(U=>U.route.id===A.routeId)||l.has(_))return;let P=Bl(f,A.path,h);if(!P){b.push({key:_,routeId:A.routeId,path:A.path,matches:null,match:null,controller:null});return}let N=t.fetchers.get(_),O=vC(P,A.path),D=!1;d.has(_)?D=!1:c.includes(_)?D=!0:N&&N.state!=="idle"&&N.data===void 0?D=o:D=mA(O,Xt({currentUrl:g,currentParams:t.matches[t.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params},r,{actionResult:y,defaultShouldRevalidate:o})),D&&b.push({key:_,routeId:A.routeId,path:A.path,matches:P,match:O,controller:new AbortController})}),[k,b]}function V5(e,t,n){let r=!t||n.route.id!==t.route.id,i=e[n.route.id]===void 0;return r||i}function Wx(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function mA(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}async function vA(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let i=n[e.id];Xe(i,"No route found in manifest");let s={};for(let o in r){let c=i[o]!==void 0&&o!=="hasErrorBoundary";Vc(!c,'Route "'+i.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!c&&!o5.has(o)&&(s[o]=r[o])}Object.assign(i,s),Object.assign(i,Xt({},t(i),{lazy:void 0}))}async function Cd(e,t,n,r,i,s,o,a,c){c===void 0&&(c={});let l,u,d,f=m=>{let y,g=new Promise((v,S)=>y=S);return d=()=>y(),t.signal.addEventListener("abort",d),Promise.race([m({request:t,params:n.params,context:c.requestContext}),g])};try{let m=n.route[e];if(n.route.lazy)if(m){let y,g=await Promise.all([f(m).catch(v=>{y=v}),vA(n.route,s,i)]);if(y)throw y;u=g[0]}else if(await vA(n.route,s,i),m=n.route[e],m)u=await f(m);else if(e==="action"){let y=new URL(t.url),g=y.pathname+y.search;throw ai(405,{method:t.method,pathname:g,routeId:n.route.id})}else return{type:zt.data,data:void 0};else if(m)u=await f(m);else{let y=new URL(t.url),g=y.pathname+y.search;throw ai(404,{pathname:g})}Xe(u!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(m){l=zt.error,u=m}finally{d&&t.signal.removeEventListener("abort",d)}if(H5(u)){let m=u.status;if(M5.has(m)){let g=u.headers.get("Location");if(Xe(g,"Redirects returned/thrown from loaders/actions must have a Location header"),!Vx.test(g))g=gC(new URL(t.url),r.slice(0,r.indexOf(n)+1),o,!0,g,a);else if(!c.isStaticRequest){let v=new URL(t.url),S=g.startsWith("//")?new URL(v.protocol+g):new URL(g),E=gh(S.pathname,o)!=null;S.origin===v.origin&&E&&(g=S.pathname+S.search+S.hash)}if(c.isStaticRequest)throw u.headers.set("Location",g),u;return{type:zt.redirect,status:m,location:g,revalidate:u.headers.get("X-Remix-Revalidate")!==null,reloadDocument:u.headers.get("X-Remix-Reload-Document")!==null}}if(c.isRouteRequest)throw{type:l===zt.error?zt.error:zt.data,response:u};let y;try{let g=u.headers.get("Content-Type");g&&/\bapplication\/json\b/.test(g)?u.body==null?y=null:y=await u.json():y=await u.text()}catch(g){return{type:zt.error,error:g}}return l===zt.error?{type:l,error:new rb(m,u.statusText,y),headers:u.headers}:{type:zt.data,data:y,statusCode:u.status,headers:u.headers}}if(l===zt.error)return{type:l,error:u};if(j5(u)){var h,p;return{type:zt.deferred,deferredData:u,statusCode:(h=u.init)==null?void 0:h.status,headers:((p=u.init)==null?void 0:p.headers)&&new Headers(u.init.headers)}}return{type:zt.data,data:u}}function Id(e,t,n,r){let i=e.createURL(jx(t)).toString(),s={signal:n};if(r&&Di(r.formMethod)){let{formMethod:o,formEncType:a}=r;s.method=o.toUpperCase(),a==="application/json"?(s.headers=new Headers({"Content-Type":a}),s.body=JSON.stringify(r.json)):a==="text/plain"?s.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?s.body=mC(r.formData):s.body=r.formData}return new Request(i,s)}function mC(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function yA(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function G5(e,t,n,r,i){let s={},o=null,a,c=!1,l={};return n.forEach((u,d)=>{let f=t[d].route.id;if(Xe(!bc(u),"Cannot handle redirect results in processLoaderData"),Fl(u)){let h=nf(e,f),p=u.error;r&&(p=Object.values(r)[0],r=void 0),o=o||{},o[h.route.id]==null&&(o[h.route.id]=p),s[f]=void 0,c||(c=!0,a=Fx(u.error)?u.error.status:500),u.headers&&(l[f]=u.headers)}else Sc(u)?(i.set(f,u.deferredData),s[f]=u.deferredData.data):s[f]=u.data,u.statusCode!=null&&u.statusCode!==200&&!c&&(a=u.statusCode),u.headers&&(l[f]=u.headers)}),r&&(o=r,s[Object.keys(r)[0]]=void 0),{loaderData:s,errors:o,statusCode:a||200,loaderHeaders:l}}function CA(e,t,n,r,i,s,o,a){let{loaderData:c,errors:l}=G5(t,n,r,i,a);for(let u=0;u<s.length;u++){let{key:d,match:f,controller:h}=s[u];Xe(o!==void 0&&o[u]!==void 0,"Did not find corresponding fetcher result");let p=o[u];if(!(h&&h.signal.aborted))if(Fl(p)){let m=nf(e.matches,f==null?void 0:f.route.id);l&&l[m.route.id]||(l=Xt({},l,{[m.route.id]:p.error})),e.fetchers.delete(d)}else if(bc(p))Xe(!1,"Unhandled fetcher revalidation redirect");else if(Sc(p))Xe(!1,"Unhandled fetcher deferred data");else{let m=ia(p.data);e.fetchers.set(d,m)}}return{loaderData:c,errors:l}}function IA(e,t,n,r){let i=Xt({},t);for(let s of n){let o=s.route.id;if(t.hasOwnProperty(o)?t[o]!==void 0&&(i[o]=t[o]):e[o]!==void 0&&s.route.loader&&(i[o]=e[o]),r&&r.hasOwnProperty(o))break}return i}function nf(e,t){return(t?e.slice(0,e.findIndex(r=>r.route.id===t)+1):[...e]).reverse().find(r=>r.route.hasErrorBoundary===!0)||e[0]}function SA(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function ai(e,t){let{pathname:n,routeId:r,method:i,type:s}=t===void 0?{}:t,o="Unknown Server Error",a="Unknown @remix-run/router error";return e===400?(o="Bad Request",i&&n&&r?a="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":s==="defer-action"?a="defer() is not supported in actions":s==="invalid-body"&&(a="Unable to encode submission body")):e===403?(o="Forbidden",a='Route "'+r+'" does not match URL "'+n+'"'):e===404?(o="Not Found",a='No route matches URL "'+n+'"'):e===405&&(o="Method Not Allowed",i&&n&&r?a="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(a='Invalid request method "'+i.toUpperCase()+'"')),new rb(e||500,o,new Error(a),!0)}function bA(e){for(let t=e.length-1;t>=0;t--){let n=e[t];if(bc(n))return{result:n,idx:t}}}function jx(e){let t=typeof e=="string"?Xo(e):e;return ph(Xt({},t,{hash:""}))}function W5(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function Sc(e){return e.type===zt.deferred}function Fl(e){return e.type===zt.error}function bc(e){return(e&&e.type)===zt.redirect}function j5(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function H5(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function $5(e){return P5.has(e.toLowerCase())}function Di(e){return x5.has(e.toLowerCase())}async function wA(e,t,n,r,i,s){for(let o=0;o<n.length;o++){let a=n[o],c=t[o];if(!c)continue;let l=e.find(d=>d.route.id===c.route.id),u=l!=null&&!Wx(l,c)&&(s&&s[c.route.id])!==void 0;if(Sc(a)&&(i||u)){let d=r[o];Xe(d,"Expected an AbortSignal for revalidating fetcher deferred result"),await Hx(a,d,i).then(f=>{f&&(n[o]=f||n[o])})}}}async function Hx(e,t,n){if(n===void 0&&(n=!1),!await e.deferredData.resolveData(t)){if(n)try{return{type:zt.data,data:e.deferredData.unwrappedData}}catch(i){return{type:zt.error,error:i}}return{type:zt.data,data:e.deferredData.data}}}function ib(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function vC(e,t){let n=typeof t=="string"?Xo(t).search:t.search;if(e[e.length-1].route.index&&ib(n||""))return e[e.length-1];let r=Bx(e);return r[r.length-1]}function kA(e){let{formMethod:t,formAction:n,formEncType:r,text:i,formData:s,json:o}=e;if(!(!t||!n||!r)){if(i!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:t,formAction:n,formEncType:r,formData:s,json:void 0,text:void 0};if(o!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function xy(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function z5(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Sd(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function Z5(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function ia(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function X5(e,t){try{let n=e.sessionStorage.getItem(Gx);if(n){let r=JSON.parse(n);for(let[i,s]of Object.entries(r||{}))s&&Array.isArray(s)&&t.set(i,new Set(s||[]))}}catch{}}function K5(e,t){if(t.size>0){let n={};for(let[r,i]of t)n[r]=[...i];try{e.sessionStorage.setItem(Gx,JSON.stringify(n))}catch(r){Vc(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Og(){return Og=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Og.apply(this,arguments)}const $x=w.createContext(null),zx=w.createContext(null),Zx=w.createContext(null),Zm=w.createContext(null),Xm=w.createContext({outlet:null,matches:[],isDataRoute:!1}),Xx=w.createContext(null);function sb(){return w.useContext(Zm)!=null}function Kx(){return sb()||Xe(!1),w.useContext(Zm).location}function J5(e,t,n,r){sb()||Xe(!1);let{navigator:i}=w.useContext(Zx),{matches:s}=w.useContext(Xm),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let l=Kx(),u;if(t){var d;let y=typeof t=="string"?Xo(t):t;c==="/"||(d=y.pathname)!=null&&d.startsWith(c)||Xe(!1),u=y}else u=l;let f=u.pathname||"/",h=c==="/"?f:f.slice(c.length)||"/",p=Bl(e,{pathname:h}),m=tU(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:Nc([c,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Nc([c,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,n,r);return t&&m?w.createElement(Zm.Provider,{value:{location:Og({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:qt.Pop}},m):m}function Y5(){let e=sU(),t=Fx(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},t),n?w.createElement("pre",{style:i},n):null,null)}const q5=w.createElement(Y5,null);class Q5 extends w.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?w.createElement(Xm.Provider,{value:this.props.routeContext},w.createElement(Xx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function eU(e){let{routeContext:t,match:n,children:r}=e,i=w.useContext($x);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Xm.Provider,{value:t},r)}function tU(e,t,n,r){var i;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var s;if((s=n)!=null&&s.errors)e=n.matches;else return null}let o=e,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id]));u>=0||Xe(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=u),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){c=!0,l>=0?o=o.slice(0,l+1):o=[o[0]];break}}}return o.reduceRight((u,d,f)=>{let h,p=!1,m=null,y=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||q5,c&&(l<0&&f===0?(oU("route-fallback",!1),p=!0,y=null):l===f&&(p=!0,y=d.route.hydrateFallbackElement||null)));let g=t.concat(o.slice(0,f+1)),v=()=>{let S;return h?S=m:p?S=y:d.route.Component?S=w.createElement(d.route.Component,null):d.route.element?S=d.route.element:S=u,w.createElement(eU,{match:d,routeContext:{outlet:u,matches:g,isDataRoute:n!=null},children:S})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?w.createElement(Q5,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:v(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):v()},null)}var yC=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(yC||{});function nU(e){let t=w.useContext(zx);return t||Xe(!1),t}function rU(e){let t=w.useContext(Xm);return t||Xe(!1),t}function iU(e){let t=rU(),n=t.matches[t.matches.length-1];return n.route.id||Xe(!1),n.route.id}function sU(){var e;let t=w.useContext(Xx),n=nU(yC.UseRouteError),r=iU(yC.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}const AA={};function oU(e,t,n){!t&&!AA[e]&&(AA[e]=!0)}function aU(e){let{basename:t="/",children:n=null,location:r,navigationType:i=qt.Pop,navigator:s,static:o=!1,future:a}=e;sb()&&Xe(!1);let c=t.replace(/^\/*/,"/"),l=w.useMemo(()=>({basename:c,navigator:s,static:o,future:Og({v7_relativeSplatPath:!1},a)}),[c,a,s,o]);typeof r=="string"&&(r=Xo(r));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,m=w.useMemo(()=>{let y=gh(u,c);return y==null?null:{location:{pathname:y,search:d,hash:f,state:h,key:p},navigationType:i}},[c,u,d,f,h,p,i]);return m==null?null:w.createElement(Zx.Provider,{value:l},w.createElement(Zm.Provider,{children:n,value:m}))}new Promise(()=>{});function cU(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:w.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:w.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:w.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dg(){return Dg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dg.apply(this,arguments)}const lU="6";try{window.__reactRouterVersion=lU}catch{}function uU(e,t){return B5({basename:t==null?void 0:t.basename,future:Dg({},t==null?void 0:t.future,{v7_prependBasename:!0}),history:r5({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||dU(),routes:e,mapRouteProperties:cU,window:t==null?void 0:t.window}).initialize()}function dU(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=Dg({},t,{errors:fU(t.errors)})),t}function fU(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,i]of t)if(i&&i.__type==="RouteErrorResponse")n[r]=new rb(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let o=new s(i.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let s=new Error(i.message);s.stack="",n[r]=s}}else n[r]=i;return n}const hU=w.createContext({isTransitioning:!1}),pU=w.createContext(new Map),gU="startTransition",EA=$B[gU],mU="flushSync",TA=n5[mU];function vU(e){EA?EA(e):e()}function bd(e){TA?TA(e):e()}class yU{constructor(){this.status="pending",this.promise=new Promise((t,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",t(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function CU(e){let{fallbackElement:t,router:n,future:r}=e,[i,s]=w.useState(n.state),[o,a]=w.useState(),[c,l]=w.useState({isTransitioning:!1}),[u,d]=w.useState(),[f,h]=w.useState(),[p,m]=w.useState(),y=w.useRef(new Map),{v7_startTransition:g}=r||{},v=w.useCallback(A=>{g?vU(A):A()},[g]),S=w.useCallback((A,_)=>{let{deletedFetchers:P,unstable_flushSync:N,unstable_viewTransitionOpts:O}=_;P.forEach(U=>y.current.delete(U)),A.fetchers.forEach((U,G)=>{U.data!==void 0&&y.current.set(G,U.data)});let D=n.window==null||typeof n.window.document.startViewTransition!="function";if(!O||D){N?bd(()=>s(A)):v(()=>s(A));return}if(N){bd(()=>{f&&(u&&u.resolve(),f.skipTransition()),l({isTransitioning:!0,flushSync:!0,currentLocation:O.currentLocation,nextLocation:O.nextLocation})});let U=n.window.document.startViewTransition(()=>{bd(()=>s(A))});U.finished.finally(()=>{bd(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})})}),bd(()=>h(U));return}f?(u&&u.resolve(),f.skipTransition(),m({state:A,currentLocation:O.currentLocation,nextLocation:O.nextLocation})):(a(A),l({isTransitioning:!0,flushSync:!1,currentLocation:O.currentLocation,nextLocation:O.nextLocation}))},[n.window,f,u,y,v]);w.useLayoutEffect(()=>n.subscribe(S),[n,S]),w.useEffect(()=>{c.isTransitioning&&!c.flushSync&&d(new yU)},[c]),w.useEffect(()=>{if(u&&o&&n.window){let A=o,_=u.promise,P=n.window.document.startViewTransition(async()=>{v(()=>s(A)),await _});P.finished.finally(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})}),h(P)}},[v,o,u,n.window]),w.useEffect(()=>{u&&o&&i.location.key===o.location.key&&u.resolve()},[u,f,i.location,o]),w.useEffect(()=>{!c.isTransitioning&&p&&(a(p.state),l({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),m(void 0))},[c.isTransitioning,p]),w.useEffect(()=>{},[]);let E=w.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:A=>n.navigate(A),push:(A,_,P)=>n.navigate(A,{state:_,preventScrollReset:P==null?void 0:P.preventScrollReset}),replace:(A,_,P)=>n.navigate(A,{replace:!0,state:_,preventScrollReset:P==null?void 0:P.preventScrollReset})}),[n]),k=n.basename||"/",b=w.useMemo(()=>({router:n,navigator:E,static:!1,basename:k}),[n,E,k]);return w.createElement(w.Fragment,null,w.createElement($x.Provider,{value:b},w.createElement(zx.Provider,{value:i},w.createElement(pU.Provider,{value:y.current},w.createElement(hU.Provider,{value:c},w.createElement(aU,{basename:k,location:i.location,navigationType:i.historyAction,navigator:E,future:{v7_relativeSplatPath:n.future.v7_relativeSplatPath}},i.initialized||n.future.v7_partialHydration?w.createElement(IU,{routes:n.routes,future:n.future,state:i}):t))))),null)}function IU(e){let{routes:t,future:n,state:r}=e;return J5(t,void 0,r,n)}var _A;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(_A||(_A={}));var RA;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(RA||(RA={}));const Jx=e=>{const t=typeof e=="function",n=w.useRef(e);w.useEffect(()=>{n.current=e}),w.useEffect(()=>{if(t){const r=i=>{const s=n.current(i);if(typeof s=="string")return i.preventDefault(),i.returnValue=s;if(i.defaultPrevented)return i.returnValue=""};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}},[t])};var xA=function(){function e(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function SU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ta=[[{color:"0, 0, 0",class:"ansi-black"},{color:"187, 0, 0",class:"ansi-red"},{color:"0, 187, 0",class:"ansi-green"},{color:"187, 187, 0",class:"ansi-yellow"},{color:"0, 0, 187",class:"ansi-blue"},{color:"187, 0, 187",class:"ansi-magenta"},{color:"0, 187, 187",class:"ansi-cyan"},{color:"255,255,255",class:"ansi-white"}],[{color:"85, 85, 85",class:"ansi-bright-black"},{color:"255, 85, 85",class:"ansi-bright-red"},{color:"0, 255, 0",class:"ansi-bright-green"},{color:"255, 255, 85",class:"ansi-bright-yellow"},{color:"85, 85, 255",class:"ansi-bright-blue"},{color:"255, 85, 255",class:"ansi-bright-magenta"},{color:"85, 255, 255",class:"ansi-bright-cyan"},{color:"255, 255, 255",class:"ansi-bright-white"}]],bU=function(){xA(e,null,[{key:"escapeForHtml",value:function(n){return new e().escapeForHtml(n)}},{key:"linkify",value:function(n){return new e().linkify(n)}},{key:"ansiToHtml",value:function(n,r){return new e().ansiToHtml(n,r)}},{key:"ansiToJson",value:function(n,r){return new e().ansiToJson(n,r)}},{key:"ansiToText",value:function(n){return new e().ansiToText(n)}}]);function e(){SU(this,e),this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0,this.decorations=[]}return xA(e,[{key:"setupPalette",value:function(){this.PALETTE_COLORS=[];for(var n=0;n<2;++n)for(var r=0;r<8;++r)this.PALETTE_COLORS.push(ta[n][r].color);for(var i=[0,95,135,175,215,255],s=function(f,h,p){return i[f]+", "+i[h]+", "+i[p]},o=0;o<6;++o)for(var a=0;a<6;++a)for(var c=0;c<6;++c)this.PALETTE_COLORS.push(s(o,a,c));for(var l=8,u=0;u<24;++u,l+=10)this.PALETTE_COLORS.push(s(l,l,l))}},{key:"escapeForHtml",value:function(n){return n.replace(/[&<>\"]/gm,function(r){return r=="&"?"&amp;":r=='"'?"&quot;":r=="<"?"&lt;":r==">"?"&gt;":""})}},{key:"linkify",value:function(n){return n.replace(/(https?:\/\/[^\s]+)/gm,function(r){return'<a href="'+r+'">'+r+"</a>"})}},{key:"ansiToHtml",value:function(n,r){return this.process(n,r,!0)}},{key:"ansiToJson",value:function(n,r){return r=r||{},r.json=!0,r.clearLine=!1,this.process(n,r,!0)}},{key:"ansiToText",value:function(n){return this.process(n,{},!1)}},{key:"process",value:function(n,r,i){var s=this,o=this,a=n.split(/\033\[/),c=a.shift();r==null&&(r={}),r.clearLine=/\r/.test(n);var l=a.map(function(d){return s.processChunk(d,r,i)});if(r&&r.json){var u=o.processChunkJson("");return u.content=c,u.clearLine=r.clearLine,l.unshift(u),r.remove_empty&&(l=l.filter(function(d){return!d.isEmpty()})),l}else l.unshift(c);return l.join("")}},{key:"processChunkJson",value:function(n,r,i){r=typeof r>"u"?{}:r;var s=r.use_classes=typeof r.use_classes<"u"&&r.use_classes,o=r.key=s?"class":"color",a={content:n,fg:null,bg:null,fg_truecolor:null,bg_truecolor:null,isInverted:!1,clearLine:r.clearLine,decoration:null,decorations:[],was_processed:!1,isEmpty:function(){return!a.content}},c=n.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!c)return a;a.content=c[4];var l=c[2].split(";");if(c[1]!==""||c[3]!=="m"||!i)return a;for(var u=this;l.length>0;){var d=l.shift(),f=parseInt(d);if(isNaN(f)||f===0)u.fg=u.bg=null,u.decorations=[];else if(f===1)u.decorations.push("bold");else if(f===2)u.decorations.push("dim");else if(f===3)u.decorations.push("italic");else if(f===4)u.decorations.push("underline");else if(f===5)u.decorations.push("blink");else if(f===7)u.decorations.push("reverse");else if(f===8)u.decorations.push("hidden");else if(f===9)u.decorations.push("strikethrough");else if(f===21)u.removeDecoration("bold");else if(f===22)u.removeDecoration("bold"),u.removeDecoration("dim");else if(f===23)u.removeDecoration("italic");else if(f===24)u.removeDecoration("underline");else if(f===25)u.removeDecoration("blink");else if(f===27)u.removeDecoration("reverse");else if(f===28)u.removeDecoration("hidden");else if(f===29)u.removeDecoration("strikethrough");else if(f===39)u.fg=null;else if(f===49)u.bg=null;else if(f>=30&&f<38)u.fg=ta[0][f%10][o];else if(f>=90&&f<98)u.fg=ta[1][f%10][o];else if(f>=40&&f<48)u.bg=ta[0][f%10][o];else if(f>=100&&f<108)u.bg=ta[1][f%10][o];else if(f===38||f===48){var h=f===38;if(l.length>=1){var p=l.shift();if(p==="5"&&l.length>=1){var m=parseInt(l.shift());if(m>=0&&m<=255)if(!s)this.PALETTE_COLORS||u.setupPalette(),h?u.fg=this.PALETTE_COLORS[m]:u.bg=this.PALETTE_COLORS[m];else{var y=m>=16?"ansi-palette-"+m:ta[m>7?1:0][m%8].class;h?u.fg=y:u.bg=y}}else if(p==="2"&&l.length>=3){var g=parseInt(l.shift()),v=parseInt(l.shift()),S=parseInt(l.shift());if(g>=0&&g<=255&&v>=0&&v<=255&&S>=0&&S<=255){var E=g+", "+v+", "+S;s?h?(u.fg="ansi-truecolor",u.fg_truecolor=E):(u.bg="ansi-truecolor",u.bg_truecolor=E):h?u.fg=E:u.bg=E}}}}}return u.fg===null&&u.bg===null&&u.decorations.length===0||(a.fg=u.fg,a.bg=u.bg,a.fg_truecolor=u.fg_truecolor,a.bg_truecolor=u.bg_truecolor,a.decorations=u.decorations,a.decoration=u.decorations.slice(-1).pop()||null,a.was_processed=!0),a}},{key:"processChunk",value:function(n,r,i){var s=this;r=r||{};var o=this.processChunkJson(n,r,i),a=r.use_classes;if(o.decorations=o.decorations.filter(function(h){if(h==="reverse"){o.fg||(o.fg=ta[0][7][a?"class":"color"]),o.bg||(o.bg=ta[0][0][a?"class":"color"]);var p=o.fg;o.fg=o.bg,o.bg=p;var m=o.fg_truecolor;return o.fg_truecolor=o.bg_truecolor,o.bg_truecolor=m,o.isInverted=!0,!1}return!0}),r.json)return o;if(o.isEmpty())return"";if(!o.was_processed)return o.content;var c=[],l=[],u=[],d={},f=function(p){var m=[],y=void 0;for(y in p)p.hasOwnProperty(y)&&m.push("data-"+y+'="'+s.escapeForHtml(p[y])+'"');return m.length>0?" "+m.join(" "):""};return o.isInverted&&(d["ansi-is-inverted"]="true"),o.fg&&(a?(c.push(o.fg+"-fg"),o.fg_truecolor!==null&&(d["ansi-truecolor-fg"]=o.fg_truecolor,o.fg_truecolor=null)):c.push("color:rgb("+o.fg+")")),o.bg&&(a?(c.push(o.bg+"-bg"),o.bg_truecolor!==null&&(d["ansi-truecolor-bg"]=o.bg_truecolor,o.bg_truecolor=null)):c.push("background-color:rgb("+o.bg+")")),o.decorations.forEach(function(h){if(a){l.push("ansi-"+h);return}h==="bold"?l.push("font-weight:bold"):h==="dim"?l.push("opacity:0.5"):h==="italic"?l.push("font-style:italic"):h==="hidden"?l.push("visibility:hidden"):h==="strikethrough"?u.push("line-through"):u.push(h)}),u.length&&l.push("text-decoration:"+u.join(" ")),a?'<span class="'+c.concat(l).join(" ")+'"'+f(d)+">"+o.content+"</span>":'<span style="'+c.concat(l).join(";")+'"'+f(d)+">"+o.content+"</span>"}},{key:"removeDecoration",value:function(n){var r=this.decorations.indexOf(n);r>=0&&this.decorations.splice(r,1)}}]),e}(),wU=bU;const kU=ch(wU);function AU(e,t){let n=[];for(const r of e.split(`\r
`)){const i=kU.ansiToJson(r,{json:!0,remove_empty:!1});let s=[];for(const o of i){const a=RU(o,t);s=[...s,...a]}n=[...n,J.jsx("span",{children:s},n.length)]}return n}const EU=/(\s|^)((\w+):\/\/(?:www\.|(?!www))[^\s.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g,TU=/(?<slorp1>\s|^)(?<name>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+[a-zA-Z])(?<slorp2>\s|$|\.)/g,_U=/@\[exit:([a-zA-Z]+)\]([a-zA-Z]+)@\[\/\]/g;function RU(e,t){const n=xU(e),r=[];let i=0,s=0;function o(u,d){let f;for(;(f=u.exec(e.content))!==null;){const h=f.index;h>i&&r.push(e.content.substring(i,h)),r.push(d(f)),i=u.lastIndex}}function a(u){const[,d,f]=u,h=f;return J.jsxs(J.Fragment,{children:[d,J.jsx("a",{href:h,target:"_blank",rel:"noreferrer",children:f})]})}function c(u){const d=u.groups.name,f=`mailto:${d}`;return J.jsxs(J.Fragment,{children:[u.groups.slorp1,J.jsx("a",{href:f,target:"_blank",rel:"noreferrer",children:d}),u.groups.slorp2]})}function l(u){const[,d,f]=u;return J.jsx("a",{onClick:()=>t(d),className:"exit",children:f})}return o(EU,a),o(TU,c),o(_U,l),i<e.content.length&&r.push(e.content.substring(i)),r.map(u=>J.jsx("span",{style:n,children:u},s++))}function xU(e){const t={};switch(e.bg&&(t.backgroundColor=`rgb(${e.bg})`),e.fg&&(t.color=`rgb(${e.fg})`),e.decoration){case"bold":t.fontWeight="bold";break;case"dim":t.opacity="0.5";break;case"italic":t.fontStyle="italic";break;case"hidden":t.visibility="hidden";break;case"strikethrough":t.textDecoration="line-through";break;case"underline":t.textDecoration="underline";break;case"blink":t.textDecoration="blink";break}return t}var tl={},$u={},Yx=w;function Me(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ir=Object.prototype.hasOwnProperty,NU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,NA={},PA={};function qx(e){return Ir.call(PA,e)?!0:Ir.call(NA,e)?!1:NU.test(e)?PA[e]=!0:(NA[e]=!0,!1)}function vr(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Gn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Gn[e]=new vr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Gn[t]=new vr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Gn[e]=new vr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Gn[e]=new vr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Gn[e]=new vr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Gn[e]=new vr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Gn[e]=new vr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Gn[e]=new vr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Gn[e]=new vr(e,5,!1,e.toLowerCase(),null,!1,!1)});var ob=/[\-:]([a-z])/g;function ab(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ob,ab);Gn[t]=new vr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ob,ab);Gn[t]=new vr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ob,ab);Gn[t]=new vr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Gn[e]=new vr(e,1,!1,e.toLowerCase(),null,!1,!1)});Gn.xlinkHref=new vr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Gn[e]=new vr(e,1,!1,e.toLowerCase(),null,!0,!0)});var Dp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},PU=["Webkit","ms","Moz","O"];Object.keys(Dp).forEach(function(e){PU.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Dp[t]=Dp[e]})});var MU=/["'&<>]/;function lr(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=MU.exec(e);if(t){var n="",r,i=0;for(r=t.index;r<e.length;r++){switch(e.charCodeAt(r)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}i!==r&&(n+=e.substring(i,r)),i=r+1,n+=t}e=i!==r?n+e.substring(i,r):n}return e}var OU=/([A-Z])/g,DU=/^ms-/,CC=Array.isArray;function Xs(e,t){return{insertionMode:e,selectedValue:t}}function LU(e,t,n){switch(t){case"select":return Xs(1,n.value!=null?n.value:n.defaultValue);case"svg":return Xs(2,null);case"math":return Xs(3,null);case"foreignObject":return Xs(1,null);case"table":return Xs(4,null);case"thead":case"tbody":case"tfoot":return Xs(5,null);case"colgroup":return Xs(7,null);case"tr":return Xs(6,null)}return 4<=e.insertionMode||e.insertionMode===0?Xs(1,null):e}var MA=new Map;function Qx(e,t,n){if(typeof n!="object")throw Error(Me(62));t=!0;for(var r in n)if(Ir.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var s=lr(r);i=lr((""+i).trim())}else{s=r;var o=MA.get(s);o!==void 0||(o=lr(s.replace(OU,"-$1").toLowerCase().replace(DU,"-ms-")),MA.set(s,o)),s=o,i=typeof i=="number"?i===0||Ir.call(Dp,r)?""+i:i+"px":lr((""+i).trim())}t?(t=!1,e.push(' style="',s,":",i)):e.push(";",s,":",i)}}t||e.push('"')}function Lr(e,t,n,r){switch(n){case"style":Qx(e,t,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(t=Gn.hasOwnProperty(n)?Gn[n]:null,t!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(n=t.attributeName,t.type){case 3:r&&e.push(" ",n,'=""');break;case 4:r===!0?e.push(" ",n,'=""'):r!==!1&&e.push(" ",n,'="',lr(r),'"');break;case 5:isNaN(r)||e.push(" ",n,'="',lr(r),'"');break;case 6:!isNaN(r)&&1<=r&&e.push(" ",n,'="',lr(r),'"');break;default:t.sanitizeURL&&(r=""+r),e.push(" ",n,'="',lr(r),'"')}}else if(qx(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(t=n.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(" ",n,'="',lr(r),'"')}}}function Lp(e,t,n){if(t!=null){if(n!=null)throw Error(Me(60));if(typeof t!="object"||!("__html"in t))throw Error(Me(61));t=t.__html,t!=null&&e.push(""+t)}}function BU(e){var t="";return Yx.Children.forEach(e,function(n){n!=null&&(t+=n)}),t}function Ny(e,t,n,r){e.push(ss(n));var i=n=null,s;for(s in t)if(Ir.call(t,s)){var o=t[s];if(o!=null)switch(s){case"children":n=o;break;case"dangerouslySetInnerHTML":i=o;break;default:Lr(e,r,s,o)}}return e.push(">"),Lp(e,i,n),typeof n=="string"?(e.push(lr(n)),null):n}var FU=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,OA=new Map;function ss(e){var t=OA.get(e);if(t===void 0){if(!FU.test(e))throw Error(Me(65,e));t="<"+e,OA.set(e,t)}return t}function UU(e,t,n,r,i){switch(t){case"select":e.push(ss("select"));var s=null,o=null;for(u in n)if(Ir.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":s=a;break;case"dangerouslySetInnerHTML":o=a;break;case"defaultValue":case"value":break;default:Lr(e,r,u,a)}}return e.push(">"),Lp(e,o,s),s;case"option":o=i.selectedValue,e.push(ss("option"));var c=a=null,l=null,u=null;for(s in n)if(Ir.call(n,s)){var d=n[s];if(d!=null)switch(s){case"children":a=d;break;case"selected":l=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":c=d;default:Lr(e,r,s,d)}}if(o!=null)if(n=c!==null?""+c:BU(a),CC(o)){for(r=0;r<o.length;r++)if(""+o[r]===n){e.push(' selected=""');break}}else""+o===n&&e.push(' selected=""');else l&&e.push(' selected=""');return e.push(">"),Lp(e,u,a),a;case"textarea":e.push(ss("textarea")),u=o=s=null;for(a in n)if(Ir.call(n,a)&&(c=n[a],c!=null))switch(a){case"children":u=c;break;case"value":s=c;break;case"defaultValue":o=c;break;case"dangerouslySetInnerHTML":throw Error(Me(91));default:Lr(e,r,a,c)}if(s===null&&o!==null&&(s=o),e.push(">"),u!=null){if(s!=null)throw Error(Me(92));if(CC(u)&&1<u.length)throw Error(Me(93));s=""+u}return typeof s=="string"&&s[0]===`
`&&e.push(`
`),s!==null&&e.push(lr(""+s)),null;case"input":e.push(ss("input")),c=u=a=s=null;for(o in n)if(Ir.call(n,o)&&(l=n[o],l!=null))switch(o){case"children":case"dangerouslySetInnerHTML":throw Error(Me(399,"input"));case"defaultChecked":c=l;break;case"defaultValue":a=l;break;case"checked":u=l;break;case"value":s=l;break;default:Lr(e,r,o,l)}return u!==null?Lr(e,r,"checked",u):c!==null&&Lr(e,r,"checked",c),s!==null?Lr(e,r,"value",s):a!==null&&Lr(e,r,"value",a),e.push("/>"),null;case"menuitem":e.push(ss("menuitem"));for(var f in n)if(Ir.call(n,f)&&(s=n[f],s!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(Me(400));default:Lr(e,r,f,s)}return e.push(">"),null;case"title":e.push(ss("title")),s=null;for(d in n)if(Ir.call(n,d)&&(o=n[d],o!=null))switch(d){case"children":s=o;break;case"dangerouslySetInnerHTML":throw Error(Me(434));default:Lr(e,r,d,o)}return e.push(">"),s;case"listing":case"pre":e.push(ss(t)),o=s=null;for(c in n)if(Ir.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":s=a;break;case"dangerouslySetInnerHTML":o=a;break;default:Lr(e,r,c,a)}if(e.push(">"),o!=null){if(s!=null)throw Error(Me(60));if(typeof o!="object"||!("__html"in o))throw Error(Me(61));n=o.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?e.push(`
`,n):e.push(""+n))}return typeof s=="string"&&s[0]===`
`&&e.push(`
`),s;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(ss(t));for(var h in n)if(Ir.call(n,h)&&(s=n[h],s!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(Me(399,t));default:Lr(e,r,h,s)}return e.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Ny(e,n,t,r);case"html":return i.insertionMode===0&&e.push("<!DOCTYPE html>"),Ny(e,n,t,r);default:if(t.indexOf("-")===-1&&typeof n.is!="string")return Ny(e,n,t,r);e.push(ss(t)),o=s=null;for(l in n)if(Ir.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":s=a;break;case"dangerouslySetInnerHTML":o=a;break;case"style":Qx(e,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:qx(l)&&typeof a!="function"&&typeof a!="symbol"&&e.push(" ",l,'="',lr(a),'"')}return e.push(">"),Lp(e,o,s),s}}function DA(e,t,n){if(e.push('<!--$?--><template id="'),n===null)throw Error(Me(395));return e.push(n),e.push('"></template>')}function VU(e,t,n,r){switch(n.insertionMode){case 0:case 1:return e.push('<div hidden id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 2:return e.push('<svg aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 3:return e.push('<math aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 4:return e.push('<table hidden id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 5:return e.push('<table hidden><tbody id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 6:return e.push('<table hidden><tr id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');case 7:return e.push('<table hidden><colgroup id="'),e.push(t.segmentPrefix),t=r.toString(16),e.push(t),e.push('">');default:throw Error(Me(397))}}function GU(e,t){switch(t.insertionMode){case 0:case 1:return e.push("</div>");case 2:return e.push("</svg>");case 3:return e.push("</math>");case 4:return e.push("</table>");case 5:return e.push("</tbody></table>");case 6:return e.push("</tr></table>");case 7:return e.push("</colgroup></table>");default:throw Error(Me(397))}}var WU=/[<\u2028\u2029]/g;function Py(e){return JSON.stringify(e).replace(WU,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function jU(e,t){return t=t===void 0?"":t,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:t+"P:",segmentPrefix:t+"S:",boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:e}}function LA(e,t,n,r){return n.generateStaticMarkup?(e.push(lr(t)),!1):(t===""?e=r:(r&&e.push("<!-- -->"),e.push(lr(t)),e=!0),e)}var rf=Object.assign,HU=Symbol.for("react.element"),eN=Symbol.for("react.portal"),tN=Symbol.for("react.fragment"),nN=Symbol.for("react.strict_mode"),rN=Symbol.for("react.profiler"),iN=Symbol.for("react.provider"),sN=Symbol.for("react.context"),oN=Symbol.for("react.forward_ref"),aN=Symbol.for("react.suspense"),cN=Symbol.for("react.suspense_list"),lN=Symbol.for("react.memo"),cb=Symbol.for("react.lazy"),$U=Symbol.for("react.scope"),zU=Symbol.for("react.debug_trace_mode"),ZU=Symbol.for("react.legacy_hidden"),XU=Symbol.for("react.default_value"),BA=Symbol.iterator;function IC(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case tN:return"Fragment";case eN:return"Portal";case rN:return"Profiler";case nN:return"StrictMode";case aN:return"Suspense";case cN:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sN:return(e.displayName||"Context")+".Consumer";case iN:return(e._context.displayName||"Context")+".Provider";case oN:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case lN:return t=e.displayName||null,t!==null?t:IC(e.type)||"Memo";case cb:t=e._payload,e=e._init;try{return IC(e(t))}catch{}}return null}var uN={};function FA(e,t){if(e=e.contextTypes,!e)return uN;var n={},r;for(r in e)n[r]=t[r];return n}var wc=null;function Km(e,t){if(e!==t){e.context._currentValue2=e.parentValue,e=e.parent;var n=t.parent;if(e===null){if(n!==null)throw Error(Me(401))}else{if(n===null)throw Error(Me(401));Km(e,n)}t.context._currentValue2=t.value}}function dN(e){e.context._currentValue2=e.parentValue,e=e.parent,e!==null&&dN(e)}function fN(e){var t=e.parent;t!==null&&fN(t),e.context._currentValue2=e.value}function hN(e,t){if(e.context._currentValue2=e.parentValue,e=e.parent,e===null)throw Error(Me(402));e.depth===t.depth?Km(e,t):hN(e,t)}function pN(e,t){var n=t.parent;if(n===null)throw Error(Me(402));e.depth===n.depth?Km(e,n):pN(e,n),t.context._currentValue2=t.value}function Lg(e){var t=wc;t!==e&&(t===null?fN(e):e===null?dN(t):t.depth===e.depth?Km(t,e):t.depth>e.depth?hN(t,e):pN(t,e),wc=e)}var UA={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function VA(e,t,n,r){var i=e.state!==void 0?e.state:null;e.updater=UA,e.props=n,e.state=i;var s={queue:[],replace:!1};e._reactInternals=s;var o=t.contextType;if(e.context=typeof o=="object"&&o!==null?o._currentValue2:r,o=t.getDerivedStateFromProps,typeof o=="function"&&(o=o(n,i),i=o==null?i:rf({},i,o),e.state=i),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&UA.enqueueReplaceState(e,e.state,null),s.queue!==null&&0<s.queue.length)if(t=s.queue,o=s.replace,s.queue=null,s.replace=!1,o&&t.length===1)e.state=t[0];else{for(s=o?t[0]:e.state,i=!0,o=o?1:0;o<t.length;o++){var a=t[o];a=typeof a=="function"?a.call(e,s,n,r):a,a!=null&&(i?(i=!1,s=rf({},s,a)):rf(s,a))}e.state=s}else s.queue=null}var KU={id:1,overflow:""};function SC(e,t,n){var r=e.id;e=e.overflow;var i=32-Bp(r)-1;r&=~(1<<i),n+=1;var s=32-Bp(t)+i;if(30<s){var o=i-i%5;return s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,{id:1<<32-Bp(t)+i|n<<i|r,overflow:s+e}}return{id:1<<s|n<<i|r,overflow:e}}var Bp=Math.clz32?Math.clz32:qU,JU=Math.log,YU=Math.LN2;function qU(e){return e>>>=0,e===0?32:31-(JU(e)/YU|0)|0}function QU(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var e4=typeof Object.is=="function"?Object.is:QU,Uo=null,lb=null,Fp=null,kt=null,Ld=!1,Bg=!1,Of=0,wa=null,Jm=0;function hc(){if(Uo===null)throw Error(Me(321));return Uo}function GA(){if(0<Jm)throw Error(Me(312));return{memoizedState:null,queue:null,next:null}}function ub(){return kt===null?Fp===null?(Ld=!1,Fp=kt=GA()):(Ld=!0,kt=Fp):kt.next===null?(Ld=!1,kt=kt.next=GA()):(Ld=!0,kt=kt.next),kt}function db(){lb=Uo=null,Bg=!1,Fp=null,Jm=0,kt=wa=null}function gN(e,t){return typeof t=="function"?t(e):t}function WA(e,t,n){if(Uo=hc(),kt=ub(),Ld){var r=kt.queue;if(t=r.dispatch,wa!==null&&(n=wa.get(r),n!==void 0)){wa.delete(r),r=kt.memoizedState;do r=e(r,n.action),n=n.next;while(n!==null);return kt.memoizedState=r,[r,t]}return[kt.memoizedState,t]}return e=e===gN?typeof t=="function"?t():t:n!==void 0?n(t):t,kt.memoizedState=e,e=kt.queue={last:null,dispatch:null},e=e.dispatch=t4.bind(null,Uo,e),[kt.memoizedState,e]}function jA(e,t){if(Uo=hc(),kt=ub(),t=t===void 0?null:t,kt!==null){var n=kt.memoizedState;if(n!==null&&t!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<t.length;i++)if(!e4(t[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return e=e(),kt.memoizedState=[e,t],e}function t4(e,t,n){if(25<=Jm)throw Error(Me(301));if(e===Uo)if(Bg=!0,e={action:n,next:null},wa===null&&(wa=new Map),n=wa.get(t),n===void 0)wa.set(t,e);else{for(t=n;t.next!==null;)t=t.next;t.next=e}}function n4(){throw Error(Me(394))}function Qh(){}var HA={readContext:function(e){return e._currentValue2},useContext:function(e){return hc(),e._currentValue2},useMemo:jA,useReducer:WA,useRef:function(e){Uo=hc(),kt=ub();var t=kt.memoizedState;return t===null?(e={current:e},kt.memoizedState=e):t},useState:function(e){return WA(gN,e)},useInsertionEffect:Qh,useLayoutEffect:function(){},useCallback:function(e,t){return jA(function(){return e},t)},useImperativeHandle:Qh,useEffect:Qh,useDebugValue:Qh,useDeferredValue:function(e){return hc(),e},useTransition:function(){return hc(),[!1,n4]},useId:function(){var e=lb.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-Bp(e)-1)).toString(32)+t;var n=Up;if(n===null)throw Error(Me(404));return t=Of++,e=":"+n.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return hc(),t(e._source)},useSyncExternalStore:function(e,t,n){if(n===void 0)throw Error(Me(407));return n()}},Up=null,My=Yx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function r4(e){return console.error(e),null}function Bd(){}function i4(e,t,n,r,i,s,o,a,c){var l=[],u=new Set;return t={destination:null,responseState:t,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:l,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?r4:i,onAllReady:s===void 0?Bd:s,onShellReady:o===void 0?Bd:o,onShellError:a===void 0?Bd:a,onFatalError:c===void 0?Bd:c},n=Fg(t,0,null,n,!1,!1),n.parentFlushed=!0,e=fb(t,e,null,n,u,uN,null,KU),l.push(e),t}function fb(e,t,n,r,i,s,o,a){e.allPendingTasks++,n===null?e.pendingRootTasks++:n.pendingTasks++;var c={node:t,ping:function(){var l=e.pingedTasks;l.push(c),l.length===1&&yN(e)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:s,context:o,treeContext:a};return i.add(c),c}function Fg(e,t,n,r,i,s){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:s}}function Df(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function Ug(e,t){var n=e.onShellError;n(t),n=e.onFatalError,n(t),e.destination!==null?(e.status=2,e.destination.destroy(t)):(e.status=1,e.fatalError=t)}function $A(e,t,n,r,i){for(Uo={},lb=t,Of=0,e=n(r,i);Bg;)Bg=!1,Of=0,Jm+=1,kt=null,e=n(r,i);return db(),e}function zA(e,t,n,r){var i=n.render(),s=r.childContextTypes;if(s!=null){var o=t.legacyContext;if(typeof n.getChildContext!="function")r=o;else{n=n.getChildContext();for(var a in n)if(!(a in s))throw Error(Me(108,IC(r)||"Unknown",a));r=rf({},o,n)}t.legacyContext=r,jr(e,t,i),t.legacyContext=o}else jr(e,t,i)}function ZA(e,t){if(e&&e.defaultProps){t=rf({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function bC(e,t,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=FA(n,t.legacyContext);var s=n.contextType;s=new n(r,typeof s=="object"&&s!==null?s._currentValue2:i),VA(s,n,r,i),zA(e,t,s,n)}else{s=FA(n,t.legacyContext),i=$A(e,t,n,r,s);var o=Of!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)VA(i,n,r,s),zA(e,t,i,n);else if(o){r=t.treeContext,t.treeContext=SC(r,1,0);try{jr(e,t,i)}finally{t.treeContext=r}}else jr(e,t,i)}else if(typeof n=="string"){switch(i=t.blockedSegment,s=UU(i.chunks,n,r,e.responseState,i.formatContext),i.lastPushedText=!1,o=i.formatContext,i.formatContext=LU(o,n,r),wC(e,t,s),i.formatContext=o,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push("</",n,">")}i.lastPushedText=!1}else{switch(n){case ZU:case zU:case nN:case rN:case tN:jr(e,t,r.children);return;case cN:jr(e,t,r.children);return;case $U:throw Error(Me(343));case aN:e:{n=t.blockedBoundary,i=t.blockedSegment,s=r.fallback,r=r.children,o=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:o,errorDigest:null},c=Fg(e,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(c),i.lastPushedText=!1;var l=Fg(e,0,null,i.formatContext,!1,!1);l.parentFlushed=!0,t.blockedBoundary=a,t.blockedSegment=l;try{if(wC(e,t,r),e.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),l.status=1,Vg(a,l),a.pendingTasks===0)break e}catch(u){l.status=4,a.forceClientRender=!0,a.errorDigest=Df(e,u)}finally{t.blockedBoundary=n,t.blockedSegment=i}t=fb(e,s,n,c,o,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case oN:if(r=$A(e,t,n.render,r,i),Of!==0){n=t.treeContext,t.treeContext=SC(n,1,0);try{jr(e,t,r)}finally{t.treeContext=n}}else jr(e,t,r);return;case lN:n=n.type,r=ZA(n,r),bC(e,t,n,r,i);return;case iN:if(i=r.children,n=n._context,r=r.value,s=n._currentValue2,n._currentValue2=r,o=wc,wc=r={parent:o,depth:o===null?0:o.depth+1,context:n,parentValue:s,value:r},t.context=r,jr(e,t,i),e=wc,e===null)throw Error(Me(403));r=e.parentValue,e.context._currentValue2=r===XU?e.context._defaultValue:r,e=wc=e.parent,t.context=e;return;case sN:r=r.children,r=r(n._currentValue2),jr(e,t,r);return;case cb:i=n._init,n=i(n._payload),r=ZA(n,r),bC(e,t,n,r,void 0);return}throw Error(Me(130,n==null?n:typeof n,""))}}function jr(e,t,n){if(t.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case HU:bC(e,t,n.type,n.props,n.ref);return;case eN:throw Error(Me(257));case cb:var r=n._init;n=r(n._payload),jr(e,t,n);return}if(CC(n)){XA(e,t,n);return}if(n===null||typeof n!="object"?r=null:(r=BA&&n[BA]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);XA(e,t,i)}return}throw e=Object.prototype.toString.call(n),Error(Me(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}typeof n=="string"?(r=t.blockedSegment,r.lastPushedText=LA(t.blockedSegment.chunks,n,e.responseState,r.lastPushedText)):typeof n=="number"&&(r=t.blockedSegment,r.lastPushedText=LA(t.blockedSegment.chunks,""+n,e.responseState,r.lastPushedText))}function XA(e,t,n){for(var r=n.length,i=0;i<r;i++){var s=t.treeContext;t.treeContext=SC(s,r,i);try{wC(e,t,n[i])}finally{t.treeContext=s}}}function wC(e,t,n){var r=t.blockedSegment.formatContext,i=t.legacyContext,s=t.context;try{return jr(e,t,n)}catch(c){if(db(),typeof c=="object"&&c!==null&&typeof c.then=="function"){n=c;var o=t.blockedSegment,a=Fg(e,o.chunks.length,null,o.formatContext,o.lastPushedText,!0);o.children.push(a),o.lastPushedText=!1,e=fb(e,t.node,t.blockedBoundary,a,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,n.then(e,e),t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=s,Lg(s)}else throw t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=s,Lg(s),c}}function s4(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,vN(this,t,e)}function mN(e,t,n){var r=e.blockedBoundary;e.blockedSegment.status=3,r===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.push(null))):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,e=n===void 0?Error(Me(432)):n,r.errorDigest=t.onError(e),r.parentFlushed&&t.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return mN(i,t,n)}),r.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(r=t.onAllReady,r()))}function Vg(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var n=t.children[0];n.id=t.id,n.parentFlushed=!0,n.status===1&&Vg(e,n)}else e.completedSegments.push(t)}function vN(e,t,n){if(t===null){if(n.parentFlushed){if(e.completedRootSegment!==null)throw Error(Me(389));e.completedRootSegment=n}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=Bd,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(n.parentFlushed&&n.status===1&&Vg(t,n),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(s4,e),t.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(Vg(t,n),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function yN(e){if(e.status!==2){var t=wc,n=My.current;My.current=HA;var r=Up;Up=e.responseState;try{var i=e.pingedTasks,s;for(s=0;s<i.length;s++){var o=i[s],a=e,c=o.blockedSegment;if(c.status===0){Lg(o.context);try{jr(a,o,o.node),a.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("<!-- -->"),o.abortSet.delete(o),c.status=1,vN(a,o.blockedBoundary,c)}catch(p){if(db(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var l=o.ping;p.then(l,l)}else{o.abortSet.delete(o),c.status=4;var u=o.blockedBoundary,d=p,f=Df(a,d);if(u===null?Ug(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,s),e.destination!==null&&hb(e,e.destination)}catch(p){Df(e,p),Ug(e,p)}finally{Up=r,My.current=n,n===HA&&Lg(t)}}}function ep(e,t,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=e.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,e=e.responseState,t.push('<template id="'),t.push(e.placeholderPrefix),e=r.toString(16),t.push(e),t.push('"></template>');case 1:n.status=2;var i=!0;r=n.chunks;var s=0;n=n.children;for(var o=0;o<n.length;o++){for(i=n[o];s<i.index;s++)t.push(r[s]);i=Ym(e,t,i)}for(;s<r.length-1;s++)t.push(r[s]);return s<r.length&&(i=t.push(r[s])),i;default:throw Error(Me(390))}}function Ym(e,t,n){var r=n.boundary;if(r===null)return ep(e,t,n);if(r.parentFlushed=!0,r.forceClientRender)return e.responseState.generateStaticMarkup||(r=r.errorDigest,t.push("<!--$!-->"),t.push("<template"),r&&(t.push(' data-dgst="'),r=lr(r),t.push(r),t.push('"')),t.push("></template>")),ep(e,t,n),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e;if(0<r.pendingTasks){r.rootSegmentID=e.nextSegmentId++,0<r.completedSegments.length&&e.partialBoundaries.push(r);var i=e.responseState,s=i.nextSuspenseID++;return i=i.boundaryPrefix+s.toString(16),r=r.id=i,DA(t,e.responseState,r),ep(e,t,n),t.push("<!--/$-->")}if(r.byteSize>e.progressiveChunkSize)return r.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(r),DA(t,e.responseState,r.id),ep(e,t,n),t.push("<!--/$-->");if(e.responseState.generateStaticMarkup||t.push("<!--$-->"),n=r.completedSegments,n.length!==1)throw Error(Me(391));return Ym(e,t,n[0]),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e}function KA(e,t,n){return VU(t,e.responseState,n.formatContext,n.id),Ym(e,t,n),GU(t,n.formatContext)}function JA(e,t,n){for(var r=n.completedSegments,i=0;i<r.length;i++)CN(e,t,n,r[i]);if(r.length=0,e=e.responseState,r=n.id,n=n.rootSegmentID,t.push(e.startInlineScript),e.sentCompleteBoundaryFunction?t.push('$RC("'):(e.sentCompleteBoundaryFunction=!0,t.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),r===null)throw Error(Me(395));return n=n.toString(16),t.push(r),t.push('","'),t.push(e.segmentPrefix),t.push(n),t.push('")<\/script>')}function CN(e,t,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(Me(392));return KA(e,t,r)}return KA(e,t,r),e=e.responseState,t.push(e.startInlineScript),e.sentCompleteSegmentFunction?t.push('$RS("'):(e.sentCompleteSegmentFunction=!0,t.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),t.push(e.segmentPrefix),i=i.toString(16),t.push(i),t.push('","'),t.push(e.placeholderPrefix),t.push(i),t.push('")<\/script>')}function hb(e,t){try{var n=e.completedRootSegment;if(n!==null&&e.pendingRootTasks===0){Ym(e,t,n),e.completedRootSegment=null;var r=e.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)t.push(r[n]);n<r.length&&t.push(r[n])}var i=e.clientRenderedBoundaries,s;for(s=0;s<i.length;s++){var o=i[s];r=t;var a=e.responseState,c=o.id,l=o.errorDigest,u=o.errorMessage,d=o.errorComponentStack;if(r.push(a.startInlineScript),a.sentClientRenderFunction?r.push('$RX("'):(a.sentClientRenderFunction=!0,r.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),c===null)throw Error(Me(395));if(r.push(c),r.push('"'),l||u||d){r.push(",");var f=Py(l||"");r.push(f)}if(u||d){r.push(",");var h=Py(u||"");r.push(h)}if(d){r.push(",");var p=Py(d);r.push(p)}if(!r.push(")<\/script>")){e.destination=null,s++,i.splice(0,s);return}}i.splice(0,s);var m=e.completedBoundaries;for(s=0;s<m.length;s++)if(!JA(e,t,m[s])){e.destination=null,s++,m.splice(0,s);return}m.splice(0,s);var y=e.partialBoundaries;for(s=0;s<y.length;s++){var g=y[s];e:{i=e,o=t;var v=g.completedSegments;for(a=0;a<v.length;a++)if(!CN(i,o,g,v[a])){a++,v.splice(0,a);var S=!1;break e}v.splice(0,a),S=!0}if(!S){e.destination=null,s++,y.splice(0,s);return}}y.splice(0,s);var E=e.completedBoundaries;for(s=0;s<E.length;s++)if(!JA(e,t,E[s])){e.destination=null,s++,E.splice(0,s);return}E.splice(0,s)}finally{e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.push(null)}}function o4(e,t){try{var n=e.abortableTasks;n.forEach(function(r){return mN(r,e,t)}),n.clear(),e.destination!==null&&hb(e,e.destination)}catch(r){Df(e,r),Ug(e,r)}}function a4(){}function IN(e,t,n,r){var i=!1,s=null,o="",a={push:function(l){return l!==null&&(o+=l),!0},destroy:function(l){i=!0,s=l}},c=!1;if(e=i4(e,jU(n,t?t.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,a4,void 0,function(){c=!0},void 0,void 0),yN(e),o4(e,r),e.status===1)e.status=2,a.destroy(e.fatalError);else if(e.status!==2&&e.destination===null){e.destination=a;try{hb(e,a)}catch(l){Df(e,l),Ug(e,l)}}if(i)throw s;if(!c)throw Error(Me(426));return o}$u.renderToNodeStream=function(){throw Error(Me(207))};$u.renderToStaticMarkup=function(e,t){return IN(e,t,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};$u.renderToStaticNodeStream=function(){throw Error(Me(208))};$u.renderToString=function(e,t){return IN(e,t,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};$u.version="18.2.0";var pb={},SN=w;function Ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hr=null,$r=0;function ve(e,t){if(t.length!==0)if(512<t.length)0<$r&&(e.enqueue(new Uint8Array(Hr.buffer,0,$r)),Hr=new Uint8Array(512),$r=0),e.enqueue(t);else{var n=Hr.length-$r;n<t.length&&(n===0?e.enqueue(Hr):(Hr.set(t.subarray(0,n),$r),e.enqueue(Hr),t=t.subarray(n)),Hr=new Uint8Array(512),$r=0),Hr.set(t,$r),$r+=t.length}}function Mt(e,t){return ve(e,t),!0}function YA(e){Hr&&0<$r&&(e.enqueue(new Uint8Array(Hr.buffer,0,$r)),Hr=null,$r=0)}var bN=new TextEncoder;function je(e){return bN.encode(e)}function de(e){return bN.encode(e)}function wN(e,t){typeof e.error=="function"?e.error(t):e.close()}var Sr=Object.prototype.hasOwnProperty,c4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qA={},QA={};function kN(e){return Sr.call(QA,e)?!0:Sr.call(qA,e)?!1:c4.test(e)?QA[e]=!0:(qA[e]=!0,!1)}function yr(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Wn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Wn[e]=new yr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Wn[t]=new yr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Wn[e]=new yr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Wn[e]=new yr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Wn[e]=new yr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Wn[e]=new yr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Wn[e]=new yr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Wn[e]=new yr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Wn[e]=new yr(e,5,!1,e.toLowerCase(),null,!1,!1)});var gb=/[\-:]([a-z])/g;function mb(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(gb,mb);Wn[t]=new yr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(gb,mb);Wn[t]=new yr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(gb,mb);Wn[t]=new yr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Wn[e]=new yr(e,1,!1,e.toLowerCase(),null,!1,!1)});Wn.xlinkHref=new yr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Wn[e]=new yr(e,1,!1,e.toLowerCase(),null,!0,!0)});var Vp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},l4=["Webkit","ms","Moz","O"];Object.keys(Vp).forEach(function(e){l4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Vp[t]=Vp[e]})});var u4=/["'&<>]/;function Ln(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=u4.exec(e);if(t){var n="",r,i=0;for(r=t.index;r<e.length;r++){switch(e.charCodeAt(r)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}i!==r&&(n+=e.substring(i,r)),i=r+1,n+=t}e=i!==r?n+e.substring(i,r):n}return e}var d4=/([A-Z])/g,f4=/^ms-/,kC=Array.isArray,h4=de("<script>"),p4=de("<\/script>"),g4=de('<script src="'),m4=de('<script type="module" src="'),e1=de('" async=""><\/script>'),v4=/(<\/|<)(s)(cript)/gi;function y4(e,t,n,r){return""+t+(n==="s"?"\\u0073":"\\u0053")+r}function C4(e,t,n,r,i){e=e===void 0?"":e,t=t===void 0?h4:de('<script nonce="'+Ln(t)+'">');var s=[];if(n!==void 0&&s.push(t,je((""+n).replace(v4,y4)),p4),r!==void 0)for(n=0;n<r.length;n++)s.push(g4,je(Ln(r[n])),e1);if(i!==void 0)for(r=0;r<i.length;r++)s.push(m4,je(Ln(i[r])),e1);return{bootstrapChunks:s,startInlineScript:t,placeholderPrefix:de(e+"P:"),segmentPrefix:de(e+"S:"),boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function os(e,t){return{insertionMode:e,selectedValue:t}}function I4(e){return os(e==="http://www.w3.org/2000/svg"?2:e==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function S4(e,t,n){switch(t){case"select":return os(1,n.value!=null?n.value:n.defaultValue);case"svg":return os(2,null);case"math":return os(3,null);case"foreignObject":return os(1,null);case"table":return os(4,null);case"thead":case"tbody":case"tfoot":return os(5,null);case"colgroup":return os(7,null);case"tr":return os(6,null)}return 4<=e.insertionMode||e.insertionMode===0?os(1,null):e}var vb=de("<!-- -->");function t1(e,t,n,r){return t===""?r:(r&&e.push(vb),e.push(je(Ln(t))),!0)}var n1=new Map,b4=de(' style="'),r1=de(":"),w4=de(";");function AN(e,t,n){if(typeof n!="object")throw Error(Ge(62));t=!0;for(var r in n)if(Sr.call(n,r)){var i=n[r];if(i!=null&&typeof i!="boolean"&&i!==""){if(r.indexOf("--")===0){var s=je(Ln(r));i=je(Ln((""+i).trim()))}else{s=r;var o=n1.get(s);o!==void 0||(o=de(Ln(s.replace(d4,"-$1").toLowerCase().replace(f4,"-ms-"))),n1.set(s,o)),s=o,i=typeof i=="number"?i===0||Sr.call(Vp,r)?je(""+i):je(i+"px"):je(Ln((""+i).trim()))}t?(t=!1,e.push(b4,s,r1,i)):e.push(w4,s,r1,i)}}t||e.push(pc)}var sa=de(" "),Sl=de('="'),pc=de('"'),i1=de('=""');function Br(e,t,n,r){switch(n){case"style":AN(e,t,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(t=Wn.hasOwnProperty(n)?Wn[n]:null,t!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(n=je(t.attributeName),t.type){case 3:r&&e.push(sa,n,i1);break;case 4:r===!0?e.push(sa,n,i1):r!==!1&&e.push(sa,n,Sl,je(Ln(r)),pc);break;case 5:isNaN(r)||e.push(sa,n,Sl,je(Ln(r)),pc);break;case 6:!isNaN(r)&&1<=r&&e.push(sa,n,Sl,je(Ln(r)),pc);break;default:t.sanitizeURL&&(r=""+r),e.push(sa,n,Sl,je(Ln(r)),pc)}}else if(kN(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(t=n.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(sa,je(n),Sl,je(Ln(r)),pc)}}}var oa=de(">"),s1=de("/>");function Gp(e,t,n){if(t!=null){if(n!=null)throw Error(Ge(60));if(typeof t!="object"||!("__html"in t))throw Error(Ge(61));t=t.__html,t!=null&&e.push(je(""+t))}}function k4(e){var t="";return SN.Children.forEach(e,function(n){n!=null&&(t+=n)}),t}var Oy=de(' selected=""');function Dy(e,t,n,r){e.push(as(n));var i=n=null,s;for(s in t)if(Sr.call(t,s)){var o=t[s];if(o!=null)switch(s){case"children":n=o;break;case"dangerouslySetInnerHTML":i=o;break;default:Br(e,r,s,o)}}return e.push(oa),Gp(e,i,n),typeof n=="string"?(e.push(je(Ln(n))),null):n}var Ly=de(`
`),A4=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,o1=new Map;function as(e){var t=o1.get(e);if(t===void 0){if(!A4.test(e))throw Error(Ge(65,e));t=de("<"+e),o1.set(e,t)}return t}var E4=de("<!DOCTYPE html>");function T4(e,t,n,r,i){switch(t){case"select":e.push(as("select"));var s=null,o=null;for(u in n)if(Sr.call(n,u)){var a=n[u];if(a!=null)switch(u){case"children":s=a;break;case"dangerouslySetInnerHTML":o=a;break;case"defaultValue":case"value":break;default:Br(e,r,u,a)}}return e.push(oa),Gp(e,o,s),s;case"option":o=i.selectedValue,e.push(as("option"));var c=a=null,l=null,u=null;for(s in n)if(Sr.call(n,s)){var d=n[s];if(d!=null)switch(s){case"children":a=d;break;case"selected":l=d;break;case"dangerouslySetInnerHTML":u=d;break;case"value":c=d;default:Br(e,r,s,d)}}if(o!=null)if(n=c!==null?""+c:k4(a),kC(o)){for(r=0;r<o.length;r++)if(""+o[r]===n){e.push(Oy);break}}else""+o===n&&e.push(Oy);else l&&e.push(Oy);return e.push(oa),Gp(e,u,a),a;case"textarea":e.push(as("textarea")),u=o=s=null;for(a in n)if(Sr.call(n,a)&&(c=n[a],c!=null))switch(a){case"children":u=c;break;case"value":s=c;break;case"defaultValue":o=c;break;case"dangerouslySetInnerHTML":throw Error(Ge(91));default:Br(e,r,a,c)}if(s===null&&o!==null&&(s=o),e.push(oa),u!=null){if(s!=null)throw Error(Ge(92));if(kC(u)&&1<u.length)throw Error(Ge(93));s=""+u}return typeof s=="string"&&s[0]===`
`&&e.push(Ly),s!==null&&e.push(je(Ln(""+s))),null;case"input":e.push(as("input")),c=u=a=s=null;for(o in n)if(Sr.call(n,o)&&(l=n[o],l!=null))switch(o){case"children":case"dangerouslySetInnerHTML":throw Error(Ge(399,"input"));case"defaultChecked":c=l;break;case"defaultValue":a=l;break;case"checked":u=l;break;case"value":s=l;break;default:Br(e,r,o,l)}return u!==null?Br(e,r,"checked",u):c!==null&&Br(e,r,"checked",c),s!==null?Br(e,r,"value",s):a!==null&&Br(e,r,"value",a),e.push(s1),null;case"menuitem":e.push(as("menuitem"));for(var f in n)if(Sr.call(n,f)&&(s=n[f],s!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(Ge(400));default:Br(e,r,f,s)}return e.push(oa),null;case"title":e.push(as("title")),s=null;for(d in n)if(Sr.call(n,d)&&(o=n[d],o!=null))switch(d){case"children":s=o;break;case"dangerouslySetInnerHTML":throw Error(Ge(434));default:Br(e,r,d,o)}return e.push(oa),s;case"listing":case"pre":e.push(as(t)),o=s=null;for(c in n)if(Sr.call(n,c)&&(a=n[c],a!=null))switch(c){case"children":s=a;break;case"dangerouslySetInnerHTML":o=a;break;default:Br(e,r,c,a)}if(e.push(oa),o!=null){if(s!=null)throw Error(Ge(60));if(typeof o!="object"||!("__html"in o))throw Error(Ge(61));n=o.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?e.push(Ly,je(n)):e.push(je(""+n)))}return typeof s=="string"&&s[0]===`
`&&e.push(Ly),s;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(as(t));for(var h in n)if(Sr.call(n,h)&&(s=n[h],s!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(Ge(399,t));default:Br(e,r,h,s)}return e.push(s1),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Dy(e,n,t,r);case"html":return i.insertionMode===0&&e.push(E4),Dy(e,n,t,r);default:if(t.indexOf("-")===-1&&typeof n.is!="string")return Dy(e,n,t,r);e.push(as(t)),o=s=null;for(l in n)if(Sr.call(n,l)&&(a=n[l],a!=null))switch(l){case"children":s=a;break;case"dangerouslySetInnerHTML":o=a;break;case"style":AN(e,r,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:kN(l)&&typeof a!="function"&&typeof a!="symbol"&&e.push(sa,je(l),Sl,je(Ln(a)),pc)}return e.push(oa),Gp(e,o,s),s}}var _4=de("</"),R4=de(">"),x4=de('<template id="'),N4=de('"></template>'),P4=de("<!--$-->"),M4=de('<!--$?--><template id="'),O4=de('"></template>'),D4=de("<!--$!-->"),L4=de("<!--/$-->"),B4=de("<template"),F4=de('"'),U4=de(' data-dgst="');de(' data-msg="');de(' data-stck="');var V4=de("></template>");function a1(e,t,n){if(ve(e,M4),n===null)throw Error(Ge(395));return ve(e,n),Mt(e,O4)}var G4=de('<div hidden id="'),W4=de('">'),j4=de("</div>"),H4=de('<svg aria-hidden="true" style="display:none" id="'),$4=de('">'),z4=de("</svg>"),Z4=de('<math aria-hidden="true" style="display:none" id="'),X4=de('">'),K4=de("</math>"),J4=de('<table hidden id="'),Y4=de('">'),q4=de("</table>"),Q4=de('<table hidden><tbody id="'),eV=de('">'),tV=de("</tbody></table>"),nV=de('<table hidden><tr id="'),rV=de('">'),iV=de("</tr></table>"),sV=de('<table hidden><colgroup id="'),oV=de('">'),aV=de("</colgroup></table>");function cV(e,t,n,r){switch(n.insertionMode){case 0:case 1:return ve(e,G4),ve(e,t.segmentPrefix),ve(e,je(r.toString(16))),Mt(e,W4);case 2:return ve(e,H4),ve(e,t.segmentPrefix),ve(e,je(r.toString(16))),Mt(e,$4);case 3:return ve(e,Z4),ve(e,t.segmentPrefix),ve(e,je(r.toString(16))),Mt(e,X4);case 4:return ve(e,J4),ve(e,t.segmentPrefix),ve(e,je(r.toString(16))),Mt(e,Y4);case 5:return ve(e,Q4),ve(e,t.segmentPrefix),ve(e,je(r.toString(16))),Mt(e,eV);case 6:return ve(e,nV),ve(e,t.segmentPrefix),ve(e,je(r.toString(16))),Mt(e,rV);case 7:return ve(e,sV),ve(e,t.segmentPrefix),ve(e,je(r.toString(16))),Mt(e,oV);default:throw Error(Ge(397))}}function lV(e,t){switch(t.insertionMode){case 0:case 1:return Mt(e,j4);case 2:return Mt(e,z4);case 3:return Mt(e,K4);case 4:return Mt(e,q4);case 5:return Mt(e,tV);case 6:return Mt(e,iV);case 7:return Mt(e,aV);default:throw Error(Ge(397))}}var uV=de('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),dV=de('$RS("'),fV=de('","'),hV=de('")<\/script>'),pV=de('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),gV=de('$RC("'),mV=de('","'),vV=de('")<\/script>'),yV=de('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),CV=de('$RX("'),IV=de('"'),SV=de(")<\/script>"),By=de(","),bV=/[<\u2028\u2029]/g;function Fy(e){return JSON.stringify(e).replace(bV,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var sf=Object.assign,wV=Symbol.for("react.element"),EN=Symbol.for("react.portal"),TN=Symbol.for("react.fragment"),_N=Symbol.for("react.strict_mode"),RN=Symbol.for("react.profiler"),xN=Symbol.for("react.provider"),NN=Symbol.for("react.context"),PN=Symbol.for("react.forward_ref"),MN=Symbol.for("react.suspense"),ON=Symbol.for("react.suspense_list"),DN=Symbol.for("react.memo"),yb=Symbol.for("react.lazy"),kV=Symbol.for("react.scope"),AV=Symbol.for("react.debug_trace_mode"),EV=Symbol.for("react.legacy_hidden"),TV=Symbol.for("react.default_value"),c1=Symbol.iterator;function AC(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case TN:return"Fragment";case EN:return"Portal";case RN:return"Profiler";case _N:return"StrictMode";case MN:return"Suspense";case ON:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case NN:return(e.displayName||"Context")+".Consumer";case xN:return(e._context.displayName||"Context")+".Provider";case PN:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case DN:return t=e.displayName||null,t!==null?t:AC(e.type)||"Memo";case yb:t=e._payload,e=e._init;try{return AC(e(t))}catch{}}return null}var LN={};function l1(e,t){if(e=e.contextTypes,!e)return LN;var n={},r;for(r in e)n[r]=t[r];return n}var kc=null;function qm(e,t){if(e!==t){e.context._currentValue=e.parentValue,e=e.parent;var n=t.parent;if(e===null){if(n!==null)throw Error(Ge(401))}else{if(n===null)throw Error(Ge(401));qm(e,n)}t.context._currentValue=t.value}}function BN(e){e.context._currentValue=e.parentValue,e=e.parent,e!==null&&BN(e)}function FN(e){var t=e.parent;t!==null&&FN(t),e.context._currentValue=e.value}function UN(e,t){if(e.context._currentValue=e.parentValue,e=e.parent,e===null)throw Error(Ge(402));e.depth===t.depth?qm(e,t):UN(e,t)}function VN(e,t){var n=t.parent;if(n===null)throw Error(Ge(402));e.depth===n.depth?qm(e,n):VN(e,n),t.context._currentValue=t.value}function Gg(e){var t=kc;t!==e&&(t===null?FN(e):e===null?BN(t):t.depth===e.depth?qm(t,e):t.depth>e.depth?UN(t,e):VN(t,e),kc=e)}var u1={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function d1(e,t,n,r){var i=e.state!==void 0?e.state:null;e.updater=u1,e.props=n,e.state=i;var s={queue:[],replace:!1};e._reactInternals=s;var o=t.contextType;if(e.context=typeof o=="object"&&o!==null?o._currentValue:r,o=t.getDerivedStateFromProps,typeof o=="function"&&(o=o(n,i),i=o==null?i:sf({},i,o),e.state=i),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&u1.enqueueReplaceState(e,e.state,null),s.queue!==null&&0<s.queue.length)if(t=s.queue,o=s.replace,s.queue=null,s.replace=!1,o&&t.length===1)e.state=t[0];else{for(s=o?t[0]:e.state,i=!0,o=o?1:0;o<t.length;o++){var a=t[o];a=typeof a=="function"?a.call(e,s,n,r):a,a!=null&&(i?(i=!1,s=sf({},s,a)):sf(s,a))}e.state=s}else s.queue=null}var _V={id:1,overflow:""};function EC(e,t,n){var r=e.id;e=e.overflow;var i=32-Wp(r)-1;r&=~(1<<i),n+=1;var s=32-Wp(t)+i;if(30<s){var o=i-i%5;return s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,{id:1<<32-Wp(t)+i|n<<i|r,overflow:s+e}}return{id:1<<s|n<<i|r,overflow:e}}var Wp=Math.clz32?Math.clz32:NV,RV=Math.log,xV=Math.LN2;function NV(e){return e>>>=0,e===0?32:31-(RV(e)/xV|0)|0}function PV(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var MV=typeof Object.is=="function"?Object.is:PV,Vo=null,Cb=null,jp=null,At=null,Fd=!1,Wg=!1,Lf=0,ka=null,Qm=0;function gc(){if(Vo===null)throw Error(Ge(321));return Vo}function f1(){if(0<Qm)throw Error(Ge(312));return{memoizedState:null,queue:null,next:null}}function Ib(){return At===null?jp===null?(Fd=!1,jp=At=f1()):(Fd=!0,At=jp):At.next===null?(Fd=!1,At=At.next=f1()):(Fd=!0,At=At.next),At}function Sb(){Cb=Vo=null,Wg=!1,jp=null,Qm=0,At=ka=null}function GN(e,t){return typeof t=="function"?t(e):t}function h1(e,t,n){if(Vo=gc(),At=Ib(),Fd){var r=At.queue;if(t=r.dispatch,ka!==null&&(n=ka.get(r),n!==void 0)){ka.delete(r),r=At.memoizedState;do r=e(r,n.action),n=n.next;while(n!==null);return At.memoizedState=r,[r,t]}return[At.memoizedState,t]}return e=e===GN?typeof t=="function"?t():t:n!==void 0?n(t):t,At.memoizedState=e,e=At.queue={last:null,dispatch:null},e=e.dispatch=OV.bind(null,Vo,e),[At.memoizedState,e]}function p1(e,t){if(Vo=gc(),At=Ib(),t=t===void 0?null:t,At!==null){var n=At.memoizedState;if(n!==null&&t!==null){var r=n[1];e:if(r===null)r=!1;else{for(var i=0;i<r.length&&i<t.length;i++)if(!MV(t[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return e=e(),At.memoizedState=[e,t],e}function OV(e,t,n){if(25<=Qm)throw Error(Ge(301));if(e===Vo)if(Wg=!0,e={action:n,next:null},ka===null&&(ka=new Map),n=ka.get(t),n===void 0)ka.set(t,e);else{for(t=n;t.next!==null;)t=t.next;t.next=e}}function DV(){throw Error(Ge(394))}function tp(){}var g1={readContext:function(e){return e._currentValue},useContext:function(e){return gc(),e._currentValue},useMemo:p1,useReducer:h1,useRef:function(e){Vo=gc(),At=Ib();var t=At.memoizedState;return t===null?(e={current:e},At.memoizedState=e):t},useState:function(e){return h1(GN,e)},useInsertionEffect:tp,useLayoutEffect:function(){},useCallback:function(e,t){return p1(function(){return e},t)},useImperativeHandle:tp,useEffect:tp,useDebugValue:tp,useDeferredValue:function(e){return gc(),e},useTransition:function(){return gc(),[!1,DV]},useId:function(){var e=Cb.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-Wp(e)-1)).toString(32)+t;var n=Hp;if(n===null)throw Error(Ge(404));return t=Lf++,e=":"+n.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return gc(),t(e._source)},useSyncExternalStore:function(e,t,n){if(n===void 0)throw Error(Ge(407));return n()}},Hp=null,Uy=SN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function LV(e){return console.error(e),null}function Ud(){}function BV(e,t,n,r,i,s,o,a,c){var l=[],u=new Set;return t={destination:null,responseState:t,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:l,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:i===void 0?LV:i,onAllReady:s===void 0?Ud:s,onShellReady:o===void 0?Ud:o,onShellError:a===void 0?Ud:a,onFatalError:c===void 0?Ud:c},n=jg(t,0,null,n,!1,!1),n.parentFlushed=!0,e=bb(t,e,null,n,u,LN,null,_V),l.push(e),t}function bb(e,t,n,r,i,s,o,a){e.allPendingTasks++,n===null?e.pendingRootTasks++:n.pendingTasks++;var c={node:t,ping:function(){var l=e.pingedTasks;l.push(c),l.length===1&&HN(e)},blockedBoundary:n,blockedSegment:r,abortSet:i,legacyContext:s,context:o,treeContext:a};return i.add(c),c}function jg(e,t,n,r,i,s){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:i,textEmbedded:s}}function Bf(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function Hg(e,t){var n=e.onShellError;n(t),n=e.onFatalError,n(t),e.destination!==null?(e.status=2,wN(e.destination,t)):(e.status=1,e.fatalError=t)}function m1(e,t,n,r,i){for(Vo={},Cb=t,Lf=0,e=n(r,i);Wg;)Wg=!1,Lf=0,Qm+=1,At=null,e=n(r,i);return Sb(),e}function v1(e,t,n,r){var i=n.render(),s=r.childContextTypes;if(s!=null){var o=t.legacyContext;if(typeof n.getChildContext!="function")r=o;else{n=n.getChildContext();for(var a in n)if(!(a in s))throw Error(Ge(108,AC(r)||"Unknown",a));r=sf({},o,n)}t.legacyContext=r,zr(e,t,i),t.legacyContext=o}else zr(e,t,i)}function y1(e,t){if(e&&e.defaultProps){t=sf({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function TC(e,t,n,r,i){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){i=l1(n,t.legacyContext);var s=n.contextType;s=new n(r,typeof s=="object"&&s!==null?s._currentValue:i),d1(s,n,r,i),v1(e,t,s,n)}else{s=l1(n,t.legacyContext),i=m1(e,t,n,r,s);var o=Lf!==0;if(typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0)d1(i,n,r,s),v1(e,t,i,n);else if(o){r=t.treeContext,t.treeContext=EC(r,1,0);try{zr(e,t,i)}finally{t.treeContext=r}}else zr(e,t,i)}else if(typeof n=="string"){switch(i=t.blockedSegment,s=T4(i.chunks,n,r,e.responseState,i.formatContext),i.lastPushedText=!1,o=i.formatContext,i.formatContext=S4(o,n,r),_C(e,t,s),i.formatContext=o,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push(_4,je(n),R4)}i.lastPushedText=!1}else{switch(n){case EV:case AV:case _N:case RN:case TN:zr(e,t,r.children);return;case ON:zr(e,t,r.children);return;case kV:throw Error(Ge(343));case MN:e:{n=t.blockedBoundary,i=t.blockedSegment,s=r.fallback,r=r.children,o=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:o,errorDigest:null},c=jg(e,i.chunks.length,a,i.formatContext,!1,!1);i.children.push(c),i.lastPushedText=!1;var l=jg(e,0,null,i.formatContext,!1,!1);l.parentFlushed=!0,t.blockedBoundary=a,t.blockedSegment=l;try{if(_C(e,t,r),l.lastPushedText&&l.textEmbedded&&l.chunks.push(vb),l.status=1,$g(a,l),a.pendingTasks===0)break e}catch(u){l.status=4,a.forceClientRender=!0,a.errorDigest=Bf(e,u)}finally{t.blockedBoundary=n,t.blockedSegment=i}t=bb(e,s,n,c,o,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case PN:if(r=m1(e,t,n.render,r,i),Lf!==0){n=t.treeContext,t.treeContext=EC(n,1,0);try{zr(e,t,r)}finally{t.treeContext=n}}else zr(e,t,r);return;case DN:n=n.type,r=y1(n,r),TC(e,t,n,r,i);return;case xN:if(i=r.children,n=n._context,r=r.value,s=n._currentValue,n._currentValue=r,o=kc,kc=r={parent:o,depth:o===null?0:o.depth+1,context:n,parentValue:s,value:r},t.context=r,zr(e,t,i),e=kc,e===null)throw Error(Ge(403));r=e.parentValue,e.context._currentValue=r===TV?e.context._defaultValue:r,e=kc=e.parent,t.context=e;return;case NN:r=r.children,r=r(n._currentValue),zr(e,t,r);return;case yb:i=n._init,n=i(n._payload),r=y1(n,r),TC(e,t,n,r,void 0);return}throw Error(Ge(130,n==null?n:typeof n,""))}}function zr(e,t,n){if(t.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case wV:TC(e,t,n.type,n.props,n.ref);return;case EN:throw Error(Ge(257));case yb:var r=n._init;n=r(n._payload),zr(e,t,n);return}if(kC(n)){C1(e,t,n);return}if(n===null||typeof n!="object"?r=null:(r=c1&&n[c1]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var i=[];do i.push(n.value),n=r.next();while(!n.done);C1(e,t,i)}return}throw e=Object.prototype.toString.call(n),Error(Ge(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}typeof n=="string"?(r=t.blockedSegment,r.lastPushedText=t1(t.blockedSegment.chunks,n,e.responseState,r.lastPushedText)):typeof n=="number"&&(r=t.blockedSegment,r.lastPushedText=t1(t.blockedSegment.chunks,""+n,e.responseState,r.lastPushedText))}function C1(e,t,n){for(var r=n.length,i=0;i<r;i++){var s=t.treeContext;t.treeContext=EC(s,r,i);try{_C(e,t,n[i])}finally{t.treeContext=s}}}function _C(e,t,n){var r=t.blockedSegment.formatContext,i=t.legacyContext,s=t.context;try{return zr(e,t,n)}catch(c){if(Sb(),typeof c=="object"&&c!==null&&typeof c.then=="function"){n=c;var o=t.blockedSegment,a=jg(e,o.chunks.length,null,o.formatContext,o.lastPushedText,!0);o.children.push(a),o.lastPushedText=!1,e=bb(e,t.node,t.blockedBoundary,a,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,n.then(e,e),t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=s,Gg(s)}else throw t.blockedSegment.formatContext=r,t.legacyContext=i,t.context=s,Gg(s),c}}function FV(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,jN(this,t,e)}function WN(e,t,n){var r=e.blockedBoundary;e.blockedSegment.status=3,r===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.close())):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,e=n===void 0?Error(Ge(432)):n,r.errorDigest=t.onError(e),r.parentFlushed&&t.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(i){return WN(i,t,n)}),r.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(r=t.onAllReady,r()))}function $g(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var n=t.children[0];n.id=t.id,n.parentFlushed=!0,n.status===1&&$g(e,n)}else e.completedSegments.push(t)}function jN(e,t,n){if(t===null){if(n.parentFlushed){if(e.completedRootSegment!==null)throw Error(Ge(389));e.completedRootSegment=n}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=Ud,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(n.parentFlushed&&n.status===1&&$g(t,n),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(FV,e),t.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&($g(t,n),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function HN(e){if(e.status!==2){var t=kc,n=Uy.current;Uy.current=g1;var r=Hp;Hp=e.responseState;try{var i=e.pingedTasks,s;for(s=0;s<i.length;s++){var o=i[s],a=e,c=o.blockedSegment;if(c.status===0){Gg(o.context);try{zr(a,o,o.node),c.lastPushedText&&c.textEmbedded&&c.chunks.push(vb),o.abortSet.delete(o),c.status=1,jN(a,o.blockedBoundary,c)}catch(p){if(Sb(),typeof p=="object"&&p!==null&&typeof p.then=="function"){var l=o.ping;p.then(l,l)}else{o.abortSet.delete(o),c.status=4;var u=o.blockedBoundary,d=p,f=Bf(a,d);if(u===null?Hg(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=f,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,a.allPendingTasks===0){var h=a.onAllReady;h()}}}finally{}}}i.splice(0,s),e.destination!==null&&wb(e,e.destination)}catch(p){Bf(e,p),Hg(e,p)}finally{Hp=r,Uy.current=n,n===g1&&Gg(t)}}}function np(e,t,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=e.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,e=e.responseState,ve(t,x4),ve(t,e.placeholderPrefix),e=je(r.toString(16)),ve(t,e),Mt(t,N4);case 1:n.status=2;var i=!0;r=n.chunks;var s=0;n=n.children;for(var o=0;o<n.length;o++){for(i=n[o];s<i.index;s++)ve(t,r[s]);i=ev(e,t,i)}for(;s<r.length-1;s++)ve(t,r[s]);return s<r.length&&(i=Mt(t,r[s])),i;default:throw Error(Ge(390))}}function ev(e,t,n){var r=n.boundary;if(r===null)return np(e,t,n);if(r.parentFlushed=!0,r.forceClientRender)r=r.errorDigest,Mt(t,D4),ve(t,B4),r&&(ve(t,U4),ve(t,je(Ln(r))),ve(t,F4)),Mt(t,V4),np(e,t,n);else if(0<r.pendingTasks){r.rootSegmentID=e.nextSegmentId++,0<r.completedSegments.length&&e.partialBoundaries.push(r);var i=e.responseState,s=i.nextSuspenseID++;i=de(i.boundaryPrefix+s.toString(16)),r=r.id=i,a1(t,e.responseState,r),np(e,t,n)}else if(r.byteSize>e.progressiveChunkSize)r.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(r),a1(t,e.responseState,r.id),np(e,t,n);else{if(Mt(t,P4),n=r.completedSegments,n.length!==1)throw Error(Ge(391));ev(e,t,n[0])}return Mt(t,L4)}function I1(e,t,n){return cV(t,e.responseState,n.formatContext,n.id),ev(e,t,n),lV(t,n.formatContext)}function S1(e,t,n){for(var r=n.completedSegments,i=0;i<r.length;i++)$N(e,t,n,r[i]);if(r.length=0,e=e.responseState,r=n.id,n=n.rootSegmentID,ve(t,e.startInlineScript),e.sentCompleteBoundaryFunction?ve(t,gV):(e.sentCompleteBoundaryFunction=!0,ve(t,pV)),r===null)throw Error(Ge(395));return n=je(n.toString(16)),ve(t,r),ve(t,mV),ve(t,e.segmentPrefix),ve(t,n),Mt(t,vV)}function $N(e,t,n,r){if(r.status===2)return!0;var i=r.id;if(i===-1){if((r.id=n.rootSegmentID)===-1)throw Error(Ge(392));return I1(e,t,r)}return I1(e,t,r),e=e.responseState,ve(t,e.startInlineScript),e.sentCompleteSegmentFunction?ve(t,dV):(e.sentCompleteSegmentFunction=!0,ve(t,uV)),ve(t,e.segmentPrefix),i=je(i.toString(16)),ve(t,i),ve(t,fV),ve(t,e.placeholderPrefix),ve(t,i),Mt(t,hV)}function wb(e,t){Hr=new Uint8Array(512),$r=0;try{var n=e.completedRootSegment;if(n!==null&&e.pendingRootTasks===0){ev(e,t,n),e.completedRootSegment=null;var r=e.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)ve(t,r[n]);n<r.length&&Mt(t,r[n])}var i=e.clientRenderedBoundaries,s;for(s=0;s<i.length;s++){var o=i[s];r=t;var a=e.responseState,c=o.id,l=o.errorDigest,u=o.errorMessage,d=o.errorComponentStack;if(ve(r,a.startInlineScript),a.sentClientRenderFunction?ve(r,CV):(a.sentClientRenderFunction=!0,ve(r,yV)),c===null)throw Error(Ge(395));ve(r,c),ve(r,IV),(l||u||d)&&(ve(r,By),ve(r,je(Fy(l||"")))),(u||d)&&(ve(r,By),ve(r,je(Fy(u||"")))),d&&(ve(r,By),ve(r,je(Fy(d)))),Mt(r,SV)}i.splice(0,s);var f=e.completedBoundaries;for(s=0;s<f.length;s++)S1(e,t,f[s]);f.splice(0,s),YA(t),Hr=new Uint8Array(512),$r=0;var h=e.partialBoundaries;for(s=0;s<h.length;s++){var p=h[s];e:{i=e,o=t;var m=p.completedSegments;for(a=0;a<m.length;a++)if(!$N(i,o,p,m[a])){a++,m.splice(0,a);var y=!1;break e}m.splice(0,a),y=!0}if(!y){e.destination=null,s++,h.splice(0,s);return}}h.splice(0,s);var g=e.completedBoundaries;for(s=0;s<g.length;s++)S1(e,t,g[s]);g.splice(0,s)}finally{YA(t),e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.close()}}function b1(e,t){try{var n=e.abortableTasks;n.forEach(function(r){return WN(r,e,t)}),n.clear(),e.destination!==null&&wb(e,e.destination)}catch(r){Bf(e,r),Hg(e,r)}}pb.renderToReadableStream=function(e,t){return new Promise(function(n,r){var i,s,o=new Promise(function(u,d){s=u,i=d}),a=BV(e,C4(t?t.identifierPrefix:void 0,t?t.nonce:void 0,t?t.bootstrapScriptContent:void 0,t?t.bootstrapScripts:void 0,t?t.bootstrapModules:void 0),I4(t?t.namespaceURI:void 0),t?t.progressiveChunkSize:void 0,t?t.onError:void 0,s,function(){var u=new ReadableStream({type:"bytes",pull:function(d){if(a.status===1)a.status=2,wN(d,a.fatalError);else if(a.status!==2&&a.destination===null){a.destination=d;try{wb(a,d)}catch(f){Bf(a,f),Hg(a,f)}}},cancel:function(){b1(a)}},{highWaterMark:0});u.allReady=o,n(u)},function(u){o.catch(function(){}),r(u)},i);if(t&&t.signal){var c=t.signal,l=function(){b1(a,c.reason),c.removeEventListener("abort",l)};c.addEventListener("abort",l)}HN(a)})};pb.version="18.2.0";var zu,zN;zu=$u,zN=pb;tl.version=zu.version;tl.renderToString=zu.renderToString;tl.renderToStaticMarkup=zu.renderToStaticMarkup;tl.renderToNodeStream=zu.renderToNodeStream;tl.renderToStaticNodeStream=zu.renderToStaticNodeStream;tl.renderToReadableStream=zN.renderToReadableStream;const mc=class mc extends vt.Component{constructor(n){super(n);V(this,"outputRef",vt.createRef());V(this,"state",{output:[],sidebarVisible:!1,newLinesCount:0});V(this,"saveOutput",()=>{const n=this.state.output.map(r=>tl.renderToStaticMarkup(r));localStorage.setItem(mc.LOCAL_STORAGE_KEY,JSON.stringify(n))});V(this,"loadOutput",()=>{const n=localStorage.getItem(mc.LOCAL_STORAGE_KEY);if(n){const r=JSON.parse(n).map(i=>vt.createElement("div",{dangerouslySetInnerHTML:{__html:i}}));this.setState({output:r})}});V(this,"addCommand",n=>{this.addToOutput([J.jsx("span",{className:"command","aria-live":"off",children:n})])});V(this,"addError",n=>this.addToOutput([J.jsxs("h2",{children:[" Error: ",n.message]})]));V(this,"handleConnected",()=>this.addToOutput([J.jsx("h2",{children:" Connected"})]));V(this,"handleDisconnected",()=>{this.addToOutput([J.jsx("h2",{children:" Disconnected"})]),this.setState({sidebarVisible:!1})});V(this,"handleUserList",n=>this.setState({sidebarVisible:!!n}));V(this,"handleScroll",()=>{this.isScrolledToBottom()&&this.setState({newLinesCount:0})});V(this,"isScrolledToBottom",()=>{const n=this.outputRef.current;return n?n.scrollHeight-n.scrollTop<=n.clientHeight+1:!1});V(this,"handleScrollToBottom",()=>{this.scrollToBottom(),this.setState({newLinesCount:0})});V(this,"scrollToBottom",()=>{const n=this.outputRef.current;n&&(n.scrollTop=n.scrollHeight)});V(this,"handleMessage",n=>{if(!n)return;const r=AU(n,this.handleExitClick);this.addToOutput(r)});V(this,"handleExitClick",n=>{this.props.client.sendCommand(n)});this.loadOutput(),this.props.client.on("message",this.handleMessage),this.props.client.on("connect",this.handleConnected),this.props.client.on("disconnect",this.handleDisconnected),this.props.client.on("error",this.addError),this.props.client.on("command",this.addCommand),this.props.client.on("userlist",this.handleUserList)}getSnapshotBeforeUpdate(n,r){if(this.outputRef.current){const i=this.outputRef.current;return i.scrollHeight-i.scrollTop<=i.clientHeight}return null}componentDidUpdate(n,r,i){i&&this.scrollToBottom(),this.state.output.length>r.output.length&&(this.isScrolledToBottom()?this.setState({newLinesCount:0}):this.setState({newLinesCount:this.state.newLinesCount+(this.state.output.length-r.output.length)})),this.saveOutput()}componentWillUnmount(){this.props.client.removeListener("message",this.handleMessage)}addToOutput(n){this.setState(r=>{const i=r.output.length,s=n.map((c,l)=>J.jsx("div",{children:c},i+l));return{output:[...r.output,...s].slice(-mc.MAX_OUTPUT_LENGTH)}})}saveLog(){const n=this.outputRef.current;if(n){const r=n.innerHTML,i=new Blob([r],{type:"text/html"}),s=URL.createObjectURL(i),o=document.createElement("a"),a=new Date,c=a.toLocaleDateString(),l=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=`${document.title.replace(/\s+/g,"-")}-log-${c}-${l}.html`;o.download=d,o.href=s,o.click(),URL.revokeObjectURL(s),o.remove()}}clearLog(){this.setState({output:[]})}render(){var n="output";this.state.sidebarVisible&&(n+=" sidebar-visible");const r=`${this.state.newLinesCount} new ${this.state.newLinesCount===1?"message":"messages"}`;return J.jsxs("div",{ref:this.outputRef,className:n,onScroll:this.handleScroll,"aria-live":"polite",role:"log",children:[this.state.output,this.state.newLinesCount>0&&J.jsx("div",{className:"new-lines-notification",onClick:this.handleScrollToBottom,role:"button","aria-live":"off",children:r})]})}};V(mc,"MAX_OUTPUT_LENGTH",5e3),V(mc,"LOCAL_STORAGE_KEY","outputLog");let RC=mc;var ZN={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function s(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new i(u,d||c,f),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],h]:c._events[p].push(h):(c._events[p]=h,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)t.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,f,h,p){var m=n?n+l:l;if(!this._events[m])return!1;var y=this._events[m],g=arguments.length,v,S;if(y.fn){switch(y.once&&this.removeListener(l,y.fn,void 0,!0),g){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,d),!0;case 4:return y.fn.call(y.context,u,d,f),!0;case 5:return y.fn.call(y.context,u,d,f,h),!0;case 6:return y.fn.call(y.context,u,d,f,h,p),!0}for(S=1,v=new Array(g-1);S<g;S++)v[S-1]=arguments[S];y.fn.apply(y.context,v)}else{var E=y.length,k;for(S=0;S<E;S++)switch(y[S].once&&this.removeListener(l,y[S].fn,void 0,!0),g){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,u);break;case 3:y[S].fn.call(y[S].context,u,d);break;case 4:y[S].fn.call(y[S].context,u,d,f);break;default:if(!v)for(k=1,v=new Array(g-1);k<g;k++)v[k-1]=arguments[k];y[S].fn.apply(y[S].context,v)}}return!0},a.prototype.on=function(l,u,d){return s(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return s(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,f){var h=n?n+l:l;if(!this._events[h])return this;if(!u)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&o(this,h);else{for(var m=0,y=[],g=p.length;m<g;m++)(p[m].fn!==u||f&&!p[m].once||d&&p[m].context!==d)&&y.push(p[m]);y.length?this._events[h]=y.length===1?y[0]:y:o(this,h)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(ZN);var UV=ZN.exports;const XN=ch(UV);var Pn={},tv={};tv.byteLength=WV;tv.toByteArray=HV;tv.fromByteArray=ZV;var ms=[],si=[],VV=typeof Uint8Array<"u"?Uint8Array:Array,Vy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var gl=0,GV=Vy.length;gl<GV;++gl)ms[gl]=Vy[gl],si[Vy.charCodeAt(gl)]=gl;si[45]=62;si[95]=63;function KN(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function WV(e){var t=KN(e),n=t[0],r=t[1];return(n+r)*3/4-r}function jV(e,t,n){return(t+n)*3/4-n}function HV(e){var t,n=KN(e),r=n[0],i=n[1],s=new VV(jV(e,r,i)),o=0,a=i>0?r-4:r,c;for(c=0;c<a;c+=4)t=si[e.charCodeAt(c)]<<18|si[e.charCodeAt(c+1)]<<12|si[e.charCodeAt(c+2)]<<6|si[e.charCodeAt(c+3)],s[o++]=t>>16&255,s[o++]=t>>8&255,s[o++]=t&255;return i===2&&(t=si[e.charCodeAt(c)]<<2|si[e.charCodeAt(c+1)]>>4,s[o++]=t&255),i===1&&(t=si[e.charCodeAt(c)]<<10|si[e.charCodeAt(c+1)]<<4|si[e.charCodeAt(c+2)]>>2,s[o++]=t>>8&255,s[o++]=t&255),s}function $V(e){return ms[e>>18&63]+ms[e>>12&63]+ms[e>>6&63]+ms[e&63]}function zV(e,t,n){for(var r,i=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(e[s+2]&255),i.push($V(r));return i.join("")}function ZV(e){for(var t,n=e.length,r=n%3,i=[],s=16383,o=0,a=n-r;o<a;o+=s)i.push(zV(e,o,o+s>a?a:o+s));return r===1?(t=e[n-1],i.push(ms[t>>2]+ms[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],i.push(ms[t>>10]+ms[t>>4&63]+ms[t<<2&63]+"=")),i.join("")}var kb={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */kb.read=function(e,t,n,r,i){var s,o,a=i*8-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?i-1:0,f=n?-1:1,h=e[t+d];for(d+=f,s=h&(1<<-u)-1,h>>=-u,u+=a;u>0;s=s*256+e[t+d],d+=f,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=r;u>0;o=o*256+e[t+d],d+=f,u-=8);if(s===0)s=1-l;else{if(s===c)return o?NaN:(h?-1:1)*(1/0);o=o+Math.pow(2,r),s=s-l}return(h?-1:1)*o*Math.pow(2,s-r)};kb.write=function(e,t,n,r,i,s){var o,a,c,l=s*8-i-1,u=(1<<l)-1,d=u>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:s-1,p=r?1:-1,m=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?t+=f/c:t+=f*Math.pow(2,1-d),t*c>=2&&(o++,c/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(t*c-1)*Math.pow(2,i),o=o+d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[n+h]=a&255,h+=p,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;e[n+h]=o&255,h+=p,o/=256,l-=8);e[n+h-p]|=m*128};(function(e){const t=tv,n=kb,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=v,e.INSPECT_MAX_BYTES=50;const i=2147483647;e.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const T=new Uint8Array(1),C={foo:function(){return 42}};return Object.setPrototypeOf(C,Uint8Array.prototype),Object.setPrototypeOf(T,C),T.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(T){if(T>i)throw new RangeError('The value "'+T+'" is invalid for option "size"');const C=new Uint8Array(T);return Object.setPrototypeOf(C,a.prototype),C}function a(T,C,I){if(typeof T=="number"){if(typeof C=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(T)}return c(T,C,I)}a.poolSize=8192;function c(T,C,I){if(typeof T=="string")return f(T,C);if(ArrayBuffer.isView(T))return p(T);if(T==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T);if(Ze(T,ArrayBuffer)||T&&Ze(T.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ze(T,SharedArrayBuffer)||T&&Ze(T.buffer,SharedArrayBuffer)))return m(T,C,I);if(typeof T=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const x=T.valueOf&&T.valueOf();if(x!=null&&x!==T)return a.from(x,C,I);const L=y(T);if(L)return L;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof T[Symbol.toPrimitive]=="function")return a.from(T[Symbol.toPrimitive]("string"),C,I);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T)}a.from=function(T,C,I){return c(T,C,I)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(T){if(typeof T!="number")throw new TypeError('"size" argument must be of type number');if(T<0)throw new RangeError('The value "'+T+'" is invalid for option "size"')}function u(T,C,I){return l(T),T<=0?o(T):C!==void 0?typeof I=="string"?o(T).fill(C,I):o(T).fill(C):o(T)}a.alloc=function(T,C,I){return u(T,C,I)};function d(T){return l(T),o(T<0?0:g(T)|0)}a.allocUnsafe=function(T){return d(T)},a.allocUnsafeSlow=function(T){return d(T)};function f(T,C){if((typeof C!="string"||C==="")&&(C="utf8"),!a.isEncoding(C))throw new TypeError("Unknown encoding: "+C);const I=S(T,C)|0;let x=o(I);const L=x.write(T,C);return L!==I&&(x=x.slice(0,L)),x}function h(T){const C=T.length<0?0:g(T.length)|0,I=o(C);for(let x=0;x<C;x+=1)I[x]=T[x]&255;return I}function p(T){if(Ze(T,Uint8Array)){const C=new Uint8Array(T);return m(C.buffer,C.byteOffset,C.byteLength)}return h(T)}function m(T,C,I){if(C<0||T.byteLength<C)throw new RangeError('"offset" is outside of buffer bounds');if(T.byteLength<C+(I||0))throw new RangeError('"length" is outside of buffer bounds');let x;return C===void 0&&I===void 0?x=new Uint8Array(T):I===void 0?x=new Uint8Array(T,C):x=new Uint8Array(T,C,I),Object.setPrototypeOf(x,a.prototype),x}function y(T){if(a.isBuffer(T)){const C=g(T.length)|0,I=o(C);return I.length===0||T.copy(I,0,0,C),I}if(T.length!==void 0)return typeof T.length!="number"||Pe(T.length)?o(0):h(T);if(T.type==="Buffer"&&Array.isArray(T.data))return h(T.data)}function g(T){if(T>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return T|0}function v(T){return+T!=T&&(T=0),a.alloc(+T)}a.isBuffer=function(C){return C!=null&&C._isBuffer===!0&&C!==a.prototype},a.compare=function(C,I){if(Ze(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),Ze(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),!a.isBuffer(C)||!a.isBuffer(I))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(C===I)return 0;let x=C.length,L=I.length;for(let j=0,Q=Math.min(x,L);j<Q;++j)if(C[j]!==I[j]){x=C[j],L=I[j];break}return x<L?-1:L<x?1:0},a.isEncoding=function(C){switch(String(C).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(C,I){if(!Array.isArray(C))throw new TypeError('"list" argument must be an Array of Buffers');if(C.length===0)return a.alloc(0);let x;if(I===void 0)for(I=0,x=0;x<C.length;++x)I+=C[x].length;const L=a.allocUnsafe(I);let j=0;for(x=0;x<C.length;++x){let Q=C[x];if(Ze(Q,Uint8Array))j+Q.length>L.length?(a.isBuffer(Q)||(Q=a.from(Q)),Q.copy(L,j)):Uint8Array.prototype.set.call(L,Q,j);else if(a.isBuffer(Q))Q.copy(L,j);else throw new TypeError('"list" argument must be an Array of Buffers');j+=Q.length}return L};function S(T,C){if(a.isBuffer(T))return T.length;if(ArrayBuffer.isView(T)||Ze(T,ArrayBuffer))return T.byteLength;if(typeof T!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof T);const I=T.length,x=arguments.length>2&&arguments[2]===!0;if(!x&&I===0)return 0;let L=!1;for(;;)switch(C){case"ascii":case"latin1":case"binary":return I;case"utf8":case"utf-8":return rt(T).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I*2;case"hex":return I>>>1;case"base64":return Fe(T).length;default:if(L)return x?-1:rt(T).length;C=(""+C).toLowerCase(),L=!0}}a.byteLength=S;function E(T,C,I){let x=!1;if((C===void 0||C<0)&&(C=0),C>this.length||((I===void 0||I>this.length)&&(I=this.length),I<=0)||(I>>>=0,C>>>=0,I<=C))return"";for(T||(T="utf8");;)switch(T){case"hex":return X(this,C,I);case"utf8":case"utf-8":return G(this,C,I);case"ascii":return q(this,C,I);case"latin1":case"binary":return W(this,C,I);case"base64":return U(this,C,I);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne(this,C,I);default:if(x)throw new TypeError("Unknown encoding: "+T);T=(T+"").toLowerCase(),x=!0}}a.prototype._isBuffer=!0;function k(T,C,I){const x=T[C];T[C]=T[I],T[I]=x}a.prototype.swap16=function(){const C=this.length;if(C%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let I=0;I<C;I+=2)k(this,I,I+1);return this},a.prototype.swap32=function(){const C=this.length;if(C%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let I=0;I<C;I+=4)k(this,I,I+3),k(this,I+1,I+2);return this},a.prototype.swap64=function(){const C=this.length;if(C%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let I=0;I<C;I+=8)k(this,I,I+7),k(this,I+1,I+6),k(this,I+2,I+5),k(this,I+3,I+4);return this},a.prototype.toString=function(){const C=this.length;return C===0?"":arguments.length===0?G(this,0,C):E.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(C){if(!a.isBuffer(C))throw new TypeError("Argument must be a Buffer");return this===C?!0:a.compare(this,C)===0},a.prototype.inspect=function(){let C="";const I=e.INSPECT_MAX_BYTES;return C=this.toString("hex",0,I).replace(/(.{2})/g,"$1 ").trim(),this.length>I&&(C+=" ... "),"<Buffer "+C+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(C,I,x,L,j){if(Ze(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),!a.isBuffer(C))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof C);if(I===void 0&&(I=0),x===void 0&&(x=C?C.length:0),L===void 0&&(L=0),j===void 0&&(j=this.length),I<0||x>C.length||L<0||j>this.length)throw new RangeError("out of range index");if(L>=j&&I>=x)return 0;if(L>=j)return-1;if(I>=x)return 1;if(I>>>=0,x>>>=0,L>>>=0,j>>>=0,this===C)return 0;let Q=j-L,Oe=x-I;const ft=Math.min(Q,Oe),ht=this.slice(L,j),It=C.slice(I,x);for(let it=0;it<ft;++it)if(ht[it]!==It[it]){Q=ht[it],Oe=It[it];break}return Q<Oe?-1:Oe<Q?1:0};function b(T,C,I,x,L){if(T.length===0)return-1;if(typeof I=="string"?(x=I,I=0):I>2147483647?I=2147483647:I<-2147483648&&(I=-2147483648),I=+I,Pe(I)&&(I=L?0:T.length-1),I<0&&(I=T.length+I),I>=T.length){if(L)return-1;I=T.length-1}else if(I<0)if(L)I=0;else return-1;if(typeof C=="string"&&(C=a.from(C,x)),a.isBuffer(C))return C.length===0?-1:A(T,C,I,x,L);if(typeof C=="number")return C=C&255,typeof Uint8Array.prototype.indexOf=="function"?L?Uint8Array.prototype.indexOf.call(T,C,I):Uint8Array.prototype.lastIndexOf.call(T,C,I):A(T,[C],I,x,L);throw new TypeError("val must be string, number or Buffer")}function A(T,C,I,x,L){let j=1,Q=T.length,Oe=C.length;if(x!==void 0&&(x=String(x).toLowerCase(),x==="ucs2"||x==="ucs-2"||x==="utf16le"||x==="utf-16le")){if(T.length<2||C.length<2)return-1;j=2,Q/=2,Oe/=2,I/=2}function ft(It,it){return j===1?It[it]:It.readUInt16BE(it*j)}let ht;if(L){let It=-1;for(ht=I;ht<Q;ht++)if(ft(T,ht)===ft(C,It===-1?0:ht-It)){if(It===-1&&(It=ht),ht-It+1===Oe)return It*j}else It!==-1&&(ht-=ht-It),It=-1}else for(I+Oe>Q&&(I=Q-Oe),ht=I;ht>=0;ht--){let It=!0;for(let it=0;it<Oe;it++)if(ft(T,ht+it)!==ft(C,it)){It=!1;break}if(It)return ht}return-1}a.prototype.includes=function(C,I,x){return this.indexOf(C,I,x)!==-1},a.prototype.indexOf=function(C,I,x){return b(this,C,I,x,!0)},a.prototype.lastIndexOf=function(C,I,x){return b(this,C,I,x,!1)};function _(T,C,I,x){I=Number(I)||0;const L=T.length-I;x?(x=Number(x),x>L&&(x=L)):x=L;const j=C.length;x>j/2&&(x=j/2);let Q;for(Q=0;Q<x;++Q){const Oe=parseInt(C.substr(Q*2,2),16);if(Pe(Oe))return Q;T[I+Q]=Oe}return Q}function P(T,C,I,x){return Ie(rt(C,T.length-I),T,I,x)}function N(T,C,I,x){return Ie(tt(C),T,I,x)}function O(T,C,I,x){return Ie(Fe(C),T,I,x)}function D(T,C,I,x){return Ie(le(C,T.length-I),T,I,x)}a.prototype.write=function(C,I,x,L){if(I===void 0)L="utf8",x=this.length,I=0;else if(x===void 0&&typeof I=="string")L=I,x=this.length,I=0;else if(isFinite(I))I=I>>>0,isFinite(x)?(x=x>>>0,L===void 0&&(L="utf8")):(L=x,x=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const j=this.length-I;if((x===void 0||x>j)&&(x=j),C.length>0&&(x<0||I<0)||I>this.length)throw new RangeError("Attempt to write outside buffer bounds");L||(L="utf8");let Q=!1;for(;;)switch(L){case"hex":return _(this,C,I,x);case"utf8":case"utf-8":return P(this,C,I,x);case"ascii":case"latin1":case"binary":return N(this,C,I,x);case"base64":return O(this,C,I,x);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,C,I,x);default:if(Q)throw new TypeError("Unknown encoding: "+L);L=(""+L).toLowerCase(),Q=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(T,C,I){return C===0&&I===T.length?t.fromByteArray(T):t.fromByteArray(T.slice(C,I))}function G(T,C,I){I=Math.min(T.length,I);const x=[];let L=C;for(;L<I;){const j=T[L];let Q=null,Oe=j>239?4:j>223?3:j>191?2:1;if(L+Oe<=I){let ft,ht,It,it;switch(Oe){case 1:j<128&&(Q=j);break;case 2:ft=T[L+1],(ft&192)===128&&(it=(j&31)<<6|ft&63,it>127&&(Q=it));break;case 3:ft=T[L+1],ht=T[L+2],(ft&192)===128&&(ht&192)===128&&(it=(j&15)<<12|(ft&63)<<6|ht&63,it>2047&&(it<55296||it>57343)&&(Q=it));break;case 4:ft=T[L+1],ht=T[L+2],It=T[L+3],(ft&192)===128&&(ht&192)===128&&(It&192)===128&&(it=(j&15)<<18|(ft&63)<<12|(ht&63)<<6|It&63,it>65535&&it<1114112&&(Q=it))}}Q===null?(Q=65533,Oe=1):Q>65535&&(Q-=65536,x.push(Q>>>10&1023|55296),Q=56320|Q&1023),x.push(Q),L+=Oe}return $(x)}const z=4096;function $(T){const C=T.length;if(C<=z)return String.fromCharCode.apply(String,T);let I="",x=0;for(;x<C;)I+=String.fromCharCode.apply(String,T.slice(x,x+=z));return I}function q(T,C,I){let x="";I=Math.min(T.length,I);for(let L=C;L<I;++L)x+=String.fromCharCode(T[L]&127);return x}function W(T,C,I){let x="";I=Math.min(T.length,I);for(let L=C;L<I;++L)x+=String.fromCharCode(T[L]);return x}function X(T,C,I){const x=T.length;(!C||C<0)&&(C=0),(!I||I<0||I>x)&&(I=x);let L="";for(let j=C;j<I;++j)L+=Ht[T[j]];return L}function ne(T,C,I){const x=T.slice(C,I);let L="";for(let j=0;j<x.length-1;j+=2)L+=String.fromCharCode(x[j]+x[j+1]*256);return L}a.prototype.slice=function(C,I){const x=this.length;C=~~C,I=I===void 0?x:~~I,C<0?(C+=x,C<0&&(C=0)):C>x&&(C=x),I<0?(I+=x,I<0&&(I=0)):I>x&&(I=x),I<C&&(I=C);const L=this.subarray(C,I);return Object.setPrototypeOf(L,a.prototype),L};function Z(T,C,I){if(T%1!==0||T<0)throw new RangeError("offset is not uint");if(T+C>I)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(C,I,x){C=C>>>0,I=I>>>0,x||Z(C,I,this.length);let L=this[C],j=1,Q=0;for(;++Q<I&&(j*=256);)L+=this[C+Q]*j;return L},a.prototype.readUintBE=a.prototype.readUIntBE=function(C,I,x){C=C>>>0,I=I>>>0,x||Z(C,I,this.length);let L=this[C+--I],j=1;for(;I>0&&(j*=256);)L+=this[C+--I]*j;return L},a.prototype.readUint8=a.prototype.readUInt8=function(C,I){return C=C>>>0,I||Z(C,1,this.length),this[C]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(C,I){return C=C>>>0,I||Z(C,2,this.length),this[C]|this[C+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(C,I){return C=C>>>0,I||Z(C,2,this.length),this[C]<<8|this[C+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(C,I){return C=C>>>0,I||Z(C,4,this.length),(this[C]|this[C+1]<<8|this[C+2]<<16)+this[C+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(C,I){return C=C>>>0,I||Z(C,4,this.length),this[C]*16777216+(this[C+1]<<16|this[C+2]<<8|this[C+3])},a.prototype.readBigUInt64LE=Sn(function(C){C=C>>>0,dt(C,"offset");const I=this[C],x=this[C+7];(I===void 0||x===void 0)&&Ut(C,this.length-8);const L=I+this[++C]*2**8+this[++C]*2**16+this[++C]*2**24,j=this[++C]+this[++C]*2**8+this[++C]*2**16+x*2**24;return BigInt(L)+(BigInt(j)<<BigInt(32))}),a.prototype.readBigUInt64BE=Sn(function(C){C=C>>>0,dt(C,"offset");const I=this[C],x=this[C+7];(I===void 0||x===void 0)&&Ut(C,this.length-8);const L=I*2**24+this[++C]*2**16+this[++C]*2**8+this[++C],j=this[++C]*2**24+this[++C]*2**16+this[++C]*2**8+x;return(BigInt(L)<<BigInt(32))+BigInt(j)}),a.prototype.readIntLE=function(C,I,x){C=C>>>0,I=I>>>0,x||Z(C,I,this.length);let L=this[C],j=1,Q=0;for(;++Q<I&&(j*=256);)L+=this[C+Q]*j;return j*=128,L>=j&&(L-=Math.pow(2,8*I)),L},a.prototype.readIntBE=function(C,I,x){C=C>>>0,I=I>>>0,x||Z(C,I,this.length);let L=I,j=1,Q=this[C+--L];for(;L>0&&(j*=256);)Q+=this[C+--L]*j;return j*=128,Q>=j&&(Q-=Math.pow(2,8*I)),Q},a.prototype.readInt8=function(C,I){return C=C>>>0,I||Z(C,1,this.length),this[C]&128?(255-this[C]+1)*-1:this[C]},a.prototype.readInt16LE=function(C,I){C=C>>>0,I||Z(C,2,this.length);const x=this[C]|this[C+1]<<8;return x&32768?x|4294901760:x},a.prototype.readInt16BE=function(C,I){C=C>>>0,I||Z(C,2,this.length);const x=this[C+1]|this[C]<<8;return x&32768?x|4294901760:x},a.prototype.readInt32LE=function(C,I){return C=C>>>0,I||Z(C,4,this.length),this[C]|this[C+1]<<8|this[C+2]<<16|this[C+3]<<24},a.prototype.readInt32BE=function(C,I){return C=C>>>0,I||Z(C,4,this.length),this[C]<<24|this[C+1]<<16|this[C+2]<<8|this[C+3]},a.prototype.readBigInt64LE=Sn(function(C){C=C>>>0,dt(C,"offset");const I=this[C],x=this[C+7];(I===void 0||x===void 0)&&Ut(C,this.length-8);const L=this[C+4]+this[C+5]*2**8+this[C+6]*2**16+(x<<24);return(BigInt(L)<<BigInt(32))+BigInt(I+this[++C]*2**8+this[++C]*2**16+this[++C]*2**24)}),a.prototype.readBigInt64BE=Sn(function(C){C=C>>>0,dt(C,"offset");const I=this[C],x=this[C+7];(I===void 0||x===void 0)&&Ut(C,this.length-8);const L=(I<<24)+this[++C]*2**16+this[++C]*2**8+this[++C];return(BigInt(L)<<BigInt(32))+BigInt(this[++C]*2**24+this[++C]*2**16+this[++C]*2**8+x)}),a.prototype.readFloatLE=function(C,I){return C=C>>>0,I||Z(C,4,this.length),n.read(this,C,!0,23,4)},a.prototype.readFloatBE=function(C,I){return C=C>>>0,I||Z(C,4,this.length),n.read(this,C,!1,23,4)},a.prototype.readDoubleLE=function(C,I){return C=C>>>0,I||Z(C,8,this.length),n.read(this,C,!0,52,8)},a.prototype.readDoubleBE=function(C,I){return C=C>>>0,I||Z(C,8,this.length),n.read(this,C,!1,52,8)};function ie(T,C,I,x,L,j){if(!a.isBuffer(T))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>L||C<j)throw new RangeError('"value" argument is out of bounds');if(I+x>T.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(C,I,x,L){if(C=+C,I=I>>>0,x=x>>>0,!L){const Oe=Math.pow(2,8*x)-1;ie(this,C,I,x,Oe,0)}let j=1,Q=0;for(this[I]=C&255;++Q<x&&(j*=256);)this[I+Q]=C/j&255;return I+x},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(C,I,x,L){if(C=+C,I=I>>>0,x=x>>>0,!L){const Oe=Math.pow(2,8*x)-1;ie(this,C,I,x,Oe,0)}let j=x-1,Q=1;for(this[I+j]=C&255;--j>=0&&(Q*=256);)this[I+j]=C/Q&255;return I+x},a.prototype.writeUint8=a.prototype.writeUInt8=function(C,I,x){return C=+C,I=I>>>0,x||ie(this,C,I,1,255,0),this[I]=C&255,I+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(C,I,x){return C=+C,I=I>>>0,x||ie(this,C,I,2,65535,0),this[I]=C&255,this[I+1]=C>>>8,I+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(C,I,x){return C=+C,I=I>>>0,x||ie(this,C,I,2,65535,0),this[I]=C>>>8,this[I+1]=C&255,I+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(C,I,x){return C=+C,I=I>>>0,x||ie(this,C,I,4,4294967295,0),this[I+3]=C>>>24,this[I+2]=C>>>16,this[I+1]=C>>>8,this[I]=C&255,I+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(C,I,x){return C=+C,I=I>>>0,x||ie(this,C,I,4,4294967295,0),this[I]=C>>>24,this[I+1]=C>>>16,this[I+2]=C>>>8,this[I+3]=C&255,I+4};function ke(T,C,I,x,L){cn(C,x,L,T,I,7);let j=Number(C&BigInt(4294967295));T[I++]=j,j=j>>8,T[I++]=j,j=j>>8,T[I++]=j,j=j>>8,T[I++]=j;let Q=Number(C>>BigInt(32)&BigInt(4294967295));return T[I++]=Q,Q=Q>>8,T[I++]=Q,Q=Q>>8,T[I++]=Q,Q=Q>>8,T[I++]=Q,I}function Ee(T,C,I,x,L){cn(C,x,L,T,I,7);let j=Number(C&BigInt(4294967295));T[I+7]=j,j=j>>8,T[I+6]=j,j=j>>8,T[I+5]=j,j=j>>8,T[I+4]=j;let Q=Number(C>>BigInt(32)&BigInt(4294967295));return T[I+3]=Q,Q=Q>>8,T[I+2]=Q,Q=Q>>8,T[I+1]=Q,Q=Q>>8,T[I]=Q,I+8}a.prototype.writeBigUInt64LE=Sn(function(C,I=0){return ke(this,C,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Sn(function(C,I=0){return Ee(this,C,I,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(C,I,x,L){if(C=+C,I=I>>>0,!L){const ft=Math.pow(2,8*x-1);ie(this,C,I,x,ft-1,-ft)}let j=0,Q=1,Oe=0;for(this[I]=C&255;++j<x&&(Q*=256);)C<0&&Oe===0&&this[I+j-1]!==0&&(Oe=1),this[I+j]=(C/Q>>0)-Oe&255;return I+x},a.prototype.writeIntBE=function(C,I,x,L){if(C=+C,I=I>>>0,!L){const ft=Math.pow(2,8*x-1);ie(this,C,I,x,ft-1,-ft)}let j=x-1,Q=1,Oe=0;for(this[I+j]=C&255;--j>=0&&(Q*=256);)C<0&&Oe===0&&this[I+j+1]!==0&&(Oe=1),this[I+j]=(C/Q>>0)-Oe&255;return I+x},a.prototype.writeInt8=function(C,I,x){return C=+C,I=I>>>0,x||ie(this,C,I,1,127,-128),C<0&&(C=255+C+1),this[I]=C&255,I+1},a.prototype.writeInt16LE=function(C,I,x){return C=+C,I=I>>>0,x||ie(this,C,I,2,32767,-32768),this[I]=C&255,this[I+1]=C>>>8,I+2},a.prototype.writeInt16BE=function(C,I,x){return C=+C,I=I>>>0,x||ie(this,C,I,2,32767,-32768),this[I]=C>>>8,this[I+1]=C&255,I+2},a.prototype.writeInt32LE=function(C,I,x){return C=+C,I=I>>>0,x||ie(this,C,I,4,2147483647,-2147483648),this[I]=C&255,this[I+1]=C>>>8,this[I+2]=C>>>16,this[I+3]=C>>>24,I+4},a.prototype.writeInt32BE=function(C,I,x){return C=+C,I=I>>>0,x||ie(this,C,I,4,2147483647,-2147483648),C<0&&(C=4294967295+C+1),this[I]=C>>>24,this[I+1]=C>>>16,this[I+2]=C>>>8,this[I+3]=C&255,I+4},a.prototype.writeBigInt64LE=Sn(function(C,I=0){return ke(this,C,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Sn(function(C,I=0){return Ee(this,C,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ge(T,C,I,x,L,j){if(I+x>T.length)throw new RangeError("Index out of range");if(I<0)throw new RangeError("Index out of range")}function Te(T,C,I,x,L){return C=+C,I=I>>>0,L||ge(T,C,I,4),n.write(T,C,I,x,23,4),I+4}a.prototype.writeFloatLE=function(C,I,x){return Te(this,C,I,!0,x)},a.prototype.writeFloatBE=function(C,I,x){return Te(this,C,I,!1,x)};function Qe(T,C,I,x,L){return C=+C,I=I>>>0,L||ge(T,C,I,8),n.write(T,C,I,x,52,8),I+8}a.prototype.writeDoubleLE=function(C,I,x){return Qe(this,C,I,!0,x)},a.prototype.writeDoubleBE=function(C,I,x){return Qe(this,C,I,!1,x)},a.prototype.copy=function(C,I,x,L){if(!a.isBuffer(C))throw new TypeError("argument should be a Buffer");if(x||(x=0),!L&&L!==0&&(L=this.length),I>=C.length&&(I=C.length),I||(I=0),L>0&&L<x&&(L=x),L===x||C.length===0||this.length===0)return 0;if(I<0)throw new RangeError("targetStart out of bounds");if(x<0||x>=this.length)throw new RangeError("Index out of range");if(L<0)throw new RangeError("sourceEnd out of bounds");L>this.length&&(L=this.length),C.length-I<L-x&&(L=C.length-I+x);const j=L-x;return this===C&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(I,x,L):Uint8Array.prototype.set.call(C,this.subarray(x,L),I),j},a.prototype.fill=function(C,I,x,L){if(typeof C=="string"){if(typeof I=="string"?(L=I,I=0,x=this.length):typeof x=="string"&&(L=x,x=this.length),L!==void 0&&typeof L!="string")throw new TypeError("encoding must be a string");if(typeof L=="string"&&!a.isEncoding(L))throw new TypeError("Unknown encoding: "+L);if(C.length===1){const Q=C.charCodeAt(0);(L==="utf8"&&Q<128||L==="latin1")&&(C=Q)}}else typeof C=="number"?C=C&255:typeof C=="boolean"&&(C=Number(C));if(I<0||this.length<I||this.length<x)throw new RangeError("Out of range index");if(x<=I)return this;I=I>>>0,x=x===void 0?this.length:x>>>0,C||(C=0);let j;if(typeof C=="number")for(j=I;j<x;++j)this[j]=C;else{const Q=a.isBuffer(C)?C:a.from(C,L),Oe=Q.length;if(Oe===0)throw new TypeError('The value "'+C+'" is invalid for argument "value"');for(j=0;j<x-I;++j)this[j+I]=Q[j%Oe]}return this};const ae={};function rn(T,C,I){ae[T]=class extends I{constructor(){super(),Object.defineProperty(this,"message",{value:C.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${T}]`,this.stack,delete this.name}get code(){return T}set code(L){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:L,writable:!0})}toString(){return`${this.name} [${T}]: ${this.message}`}}}rn("ERR_BUFFER_OUT_OF_BOUNDS",function(T){return T?`${T} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),rn("ERR_INVALID_ARG_TYPE",function(T,C){return`The "${T}" argument must be of type number. Received type ${typeof C}`},TypeError),rn("ERR_OUT_OF_RANGE",function(T,C,I){let x=`The value of "${T}" is out of range.`,L=I;return Number.isInteger(I)&&Math.abs(I)>2**32?L=In(String(I)):typeof I=="bigint"&&(L=String(I),(I>BigInt(2)**BigInt(32)||I<-(BigInt(2)**BigInt(32)))&&(L=In(L)),L+="n"),x+=` It must be ${C}. Received ${L}`,x},RangeError);function In(T){let C="",I=T.length;const x=T[0]==="-"?1:0;for(;I>=x+4;I-=3)C=`_${T.slice(I-3,I)}${C}`;return`${T.slice(0,I)}${C}`}function Ct(T,C,I){dt(C,"offset"),(T[C]===void 0||T[C+I]===void 0)&&Ut(C,T.length-(I+1))}function cn(T,C,I,x,L,j){if(T>I||T<C){const Q=typeof C=="bigint"?"n":"";let Oe;throw j>3?C===0||C===BigInt(0)?Oe=`>= 0${Q} and < 2${Q} ** ${(j+1)*8}${Q}`:Oe=`>= -(2${Q} ** ${(j+1)*8-1}${Q}) and < 2 ** ${(j+1)*8-1}${Q}`:Oe=`>= ${C}${Q} and <= ${I}${Q}`,new ae.ERR_OUT_OF_RANGE("value",Oe,T)}Ct(x,L,j)}function dt(T,C){if(typeof T!="number")throw new ae.ERR_INVALID_ARG_TYPE(C,"number",T)}function Ut(T,C,I){throw Math.floor(T)!==T?(dt(T,I),new ae.ERR_OUT_OF_RANGE(I||"offset","an integer",T)):C<0?new ae.ERR_BUFFER_OUT_OF_BOUNDS:new ae.ERR_OUT_OF_RANGE(I||"offset",`>= ${I?1:0} and <= ${C}`,T)}const ce=/[^+/0-9A-Za-z-_]/g;function Ce(T){if(T=T.split("=")[0],T=T.trim().replace(ce,""),T.length<2)return"";for(;T.length%4!==0;)T=T+"=";return T}function rt(T,C){C=C||1/0;let I;const x=T.length;let L=null;const j=[];for(let Q=0;Q<x;++Q){if(I=T.charCodeAt(Q),I>55295&&I<57344){if(!L){if(I>56319){(C-=3)>-1&&j.push(239,191,189);continue}else if(Q+1===x){(C-=3)>-1&&j.push(239,191,189);continue}L=I;continue}if(I<56320){(C-=3)>-1&&j.push(239,191,189),L=I;continue}I=(L-55296<<10|I-56320)+65536}else L&&(C-=3)>-1&&j.push(239,191,189);if(L=null,I<128){if((C-=1)<0)break;j.push(I)}else if(I<2048){if((C-=2)<0)break;j.push(I>>6|192,I&63|128)}else if(I<65536){if((C-=3)<0)break;j.push(I>>12|224,I>>6&63|128,I&63|128)}else if(I<1114112){if((C-=4)<0)break;j.push(I>>18|240,I>>12&63|128,I>>6&63|128,I&63|128)}else throw new Error("Invalid code point")}return j}function tt(T){const C=[];for(let I=0;I<T.length;++I)C.push(T.charCodeAt(I)&255);return C}function le(T,C){let I,x,L;const j=[];for(let Q=0;Q<T.length&&!((C-=2)<0);++Q)I=T.charCodeAt(Q),x=I>>8,L=I%256,j.push(L),j.push(x);return j}function Fe(T){return t.toByteArray(Ce(T))}function Ie(T,C,I,x){let L;for(L=0;L<x&&!(L+I>=C.length||L>=T.length);++L)C[L+I]=T[L];return L}function Ze(T,C){return T instanceof C||T!=null&&T.constructor!=null&&T.constructor.name!=null&&T.constructor.name===C.name}function Pe(T){return T!==T}const Ht=function(){const T="0123456789abcdef",C=new Array(256);for(let I=0;I<16;++I){const x=I*16;for(let L=0;L<16;++L)C[x+L]=T[I]+T[L]}return C}();function Sn(T){return typeof BigInt>"u"?ul:T}function ul(){throw new Error("BigInt not supported")}})(Pn);var Vd=(e=>(e[e.BINARY=0]="BINARY",e[e.ECHO=1]="ECHO",e[e.RCP=2]="RCP",e[e.SUPPRESS_GO_AHEAD=3]="SUPPRESS_GO_AHEAD",e[e.APPROX_MESSAGE_SIZE_NEGOTIATION=4]="APPROX_MESSAGE_SIZE_NEGOTIATION",e[e.STATUS=5]="STATUS",e[e.TIMING_MARK=6]="TIMING_MARK",e[e.REMOTE_CONTROLLED_TRANSMISSION_ECHO=7]="REMOTE_CONTROLLED_TRANSMISSION_ECHO",e[e.OUTPUT_LINE_WIDTH=8]="OUTPUT_LINE_WIDTH",e[e.OUTPUT_PAGE_SIZE=9]="OUTPUT_PAGE_SIZE",e[e.OUTPUT_CARRIAGE_RETURN_DISPOSITION=10]="OUTPUT_CARRIAGE_RETURN_DISPOSITION",e[e.OUTPUT_HORIZONTAL_TAB_STOPS=11]="OUTPUT_HORIZONTAL_TAB_STOPS",e[e.OUTPUT_HORIZONTAL_TAB_DISPOSITION=12]="OUTPUT_HORIZONTAL_TAB_DISPOSITION",e[e.OUTPUT_FORMFEED_DISPOSITION=13]="OUTPUT_FORMFEED_DISPOSITION",e[e.OUTPUT_VERTICAL_TAB_STOPS=14]="OUTPUT_VERTICAL_TAB_STOPS",e[e.OUTPUT_VERTICAL_TAB_DISPOSITION=15]="OUTPUT_VERTICAL_TAB_DISPOSITION",e[e.OUTPUT_LINEFEED_DISPOSITION=16]="OUTPUT_LINEFEED_DISPOSITION",e[e.EXTENDED_ASCII=17]="EXTENDED_ASCII",e[e.LOGOUT=18]="LOGOUT",e[e.BYTE_MACRO=19]="BYTE_MACRO",e[e.DATA_ENTRY_TERMINAL=20]="DATA_ENTRY_TERMINAL",e[e.SUPDUP=21]="SUPDUP",e[e.SUPDUP_OUTPUT=22]="SUPDUP_OUTPUT",e[e.SEND_LOCATION=23]="SEND_LOCATION",e[e.TERMINAL_TYPE=24]="TERMINAL_TYPE",e[e.END_OF_RECORD=25]="END_OF_RECORD",e[e.TACACS_USER_IDENTIFICATION=26]="TACACS_USER_IDENTIFICATION",e[e.OUTPUT_MARKING=27]="OUTPUT_MARKING",e[e.TERMINAL_LOCATION_NUMBER=28]="TERMINAL_LOCATION_NUMBER",e[e.TELNET_3270_REGIME=29]="TELNET_3270_REGIME",e[e.X_3_PAD=30]="X_3_PAD",e[e.NAWS=31]="NAWS",e[e.TERMINAL_SPEED=32]="TERMINAL_SPEED",e[e.REMOTE_FLOW_CONTROL=33]="REMOTE_FLOW_CONTROL",e[e.LINEMODE=34]="LINEMODE",e[e.X_DISPLAY_LOCATION=35]="X_DISPLAY_LOCATION",e[e.ENVIRONMENT_OPTION=36]="ENVIRONMENT_OPTION",e[e.AUTHENTICATION_OPTION=37]="AUTHENTICATION_OPTION",e[e.ENCRYPTION_OPTION=38]="ENCRYPTION_OPTION",e[e.NEW_ENVIRONMENT_OPTION=39]="NEW_ENVIRONMENT_OPTION",e[e.TN3270E=40]="TN3270E",e[e.XAUTH=41]="XAUTH",e[e.CHARSET=42]="CHARSET",e[e.RSP=43]="RSP",e[e.COM_PORT_OPTION=44]="COM_PORT_OPTION",e[e.SUPPRESS_LOCAL_ECHO=45]="SUPPRESS_LOCAL_ECHO",e[e.START_TLS=46]="START_TLS",e[e.KERMIT=47]="KERMIT",e[e.SEND_URL=48]="SEND_URL",e[e.FORWARD_X=49]="FORWARD_X",e[e.PRAGMA_LOGON=138]="PRAGMA_LOGON",e[e.GMCP=201]="GMCP",e))(Vd||{}),Gd=(e=>(e[e.SE=240]="SE",e[e.NOP=241]="NOP",e[e.DM=242]="DM",e[e.BRK=243]="BRK",e[e.IP=244]="IP",e[e.AO=245]="AO",e[e.AYT=246]="AYT",e[e.EC=247]="EC",e[e.EL=248]="EL",e[e.GA=249]="GA",e[e.SB=250]="SB",e[e.WILL=251]="WILL",e[e.WONT=252]="WONT",e[e.DO=253]="DO",e[e.DONT=254]="DONT",e[e.IAC=255]="IAC",e))(Gd||{});class XV{constructor(t){V(this,"ws");this.ws=t}on(t,n){if(t==="data"){this.ws.onmessage=i=>{n(i.data)};return}const r="on"+t;this[r]=n}write(t){this.ws.send(t)}}class KV extends XN{constructor(n){super();V(this,"state");V(this,"buffer");V(this,"subBuffer");V(this,"iacSEBuffer",Pn.Buffer.from([255,240]));V(this,"negotiationByte",0);V(this,"stream");this.state=0,this.buffer=Pn.Buffer.alloc(0),this.subBuffer=Pn.Buffer.alloc(0),n&&n.on("data",r=>this.parse(r)),this.stream=n}parse(n){for(this.buffer=Pn.Buffer.concat([this.buffer,Pn.Buffer.from(n)]);this.buffer.length>0;){let r;switch(this.state){case 0:this.handleData();break;case 1:if(r=this.handleCommand(),r)return;break;case 2:if(r=this.handleSubnegotiation(),r)return;break;case 3:if(r=this.handleNegotiation(),r)return;break}}}handleData(){const n=this.buffer.indexOf(255);if(n===-1){this.emit("data",this.buffer),this.buffer=Pn.Buffer.alloc(0);return}this.emit("data",this.buffer.slice(0,n)),this.buffer=this.buffer.slice(n),this.state=1}handleCommand(){if(this.buffer.length<2)return!0;const n=this.buffer[1];switch(this.buffer=this.buffer.slice(2),n){case 241:this.emit("command",241),this.state=0;break;case 250:this.subBuffer=Pn.Buffer.alloc(0),this.state=2;break;case 253:case 254:case 251:case 252:this.negotiationByte=n,this.state=3;break;default:this.state=0;break}return!1}handleNegotiation(){if(this.buffer.length<1)return!0;const n=this.negotiationByte,r=this.buffer[0];return this.buffer=this.buffer.slice(1),this.emit("negotiation",n,r),this.state=0,!1}handleSubnegotiation(){let n=this.buffer.indexOf(this.iacSEBuffer);if(n===-1)return!0;this.state=0;let r=this.buffer.slice(0,n);return r[0]===201?this.handleGmcp(r.slice(1)):this.emit("subnegotiation",r),this.buffer=this.buffer.slice(n+2),!1}handleGmcp(n){const r=n.toString(),[i,s]=r.split(/ +(.+?)$/,2);this.emit("gmcp",i,s)}sendNegotiation(n,r){this.stream.write(Pn.Buffer.from([255,n,r]))}sendGmcp(n,r){const i=n+" "+r,s=Pn.Buffer.from(i),o=Pn.Buffer.concat([Pn.Buffer.from([255,250]),Pn.Buffer.from([201]),s,this.iacSEBuffer]);this.stream.write(o)}sendTerminalType(n){const r=Pn.Buffer.from(n),i=Pn.Buffer.concat([Pn.Buffer.from([255,250]),Pn.Buffer.from([24,0]),r,this.iacSEBuffer]);this.stream.write(i)}}class Ko{constructor(t){V(this,"packageName");V(this,"packageVersion",1);V(this,"client");this.client=t}sendData(t,n){this.client.sendGmcp(this.packageName+"."+t,JSON.stringify(n))}shutdown(){}}class JV extends Ko{constructor(){super(...arguments);V(this,"packageName","Auth.Autologin")}handleToken(n){localStorage.setItem("LoginRefreshToken",n)}sendLogin(){var n=localStorage.getItem("LoginRefreshToken");n&&this.sendData("Login",n)}}class YV extends Ko{constructor(){super(...arguments);V(this,"packageName","Char")}handleName(n){this.client.worldData.playerId=n.name,this.client.worldData.playerName=n.fullname,this.client.emit("statustext",`Logged in as ${n.fullname}`)}sendLogin(n,r){this.client.sendGmcp("Char.Login",JSON.stringify({name:n,password:r}))}}class qV extends Ko{constructor(n){super(n);V(this,"packageName","Client.Keystrokes");V(this,"bindings",[]);V(this,"boundKeyUpHandler");this.boundKeyUpHandler=this.handleKeyup.bind(this),document.addEventListener("keyup",this.boundKeyUpHandler)}handleKeyup(n){const r=this.findBinding(n);if(r){n.preventDefault();const i=this.client.getInput(),s=this.parseCommand(r.command,i);r.autosend?this.client.sendCommand(s):this.placeInInputField(s)}}shutdown(){document.removeEventListener("keyup",this.boundKeyUpHandler)}findBinding(n){try{return this.bindings.find(r=>{if(r.key.toLowerCase()!==n.key.toLowerCase())return!1;const i=new Set([n.altKey&&"Alt",n.ctrlKey&&"Control",n.shiftKey&&"Shift",n.metaKey&&"Meta"].filter(Boolean));return r.modifiers&&r.modifiers.every(s=>i.has(s))})}catch(r){console.error("Error in finding key binding: ",r);return}}parseCommand(n,r){const i=r.trim().split(/\s+/);return n.replace(/%(\d+|\*)/g,(s,o)=>{if(o==="*")return r;const a=parseInt(o,10)-1;return a>=0&&a<i.length?i[a]:s})}placeInInputField(n){this.client.setInput(n)}bindKey(n){const r={key:n.key,modifiers:n.modifiers,command:n.command,autosend:n.autosend};this.bindings.push(r)}unbindKey(n){this.bindings=this.bindings.filter(r=>!(r.key===n.key&&r.modifiers.length===n.modifiers.length&&r.modifiers.every(i=>n.modifiers.includes(i))))}unbindAll(){this.bindings=[]}handleBind(n){this.bindKey(n)}handleUnbind(n){this.unbindKey(n)}handleBind_all(n){this.bindings=n.bindings.map(r=>({...r}))}listBindings(){return[...this.bindings]}}const w1=(e,t,n)=>({endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}),k1=(e,t,n)=>({endTime:t,insertTime:n,type:"linearRampToValue",value:e}),xC=(e,t)=>({startTime:t,type:"setValue",value:e}),JN=(e,t,n)=>({duration:n,startTime:t,type:"setValueCurve",values:e}),YN=(e,t,{startTime:n,target:r,timeConstant:i})=>r+(t-r)*Math.exp((n-e)/i),Ul=e=>e.type==="exponentialRampToValue",zg=e=>e.type==="linearRampToValue",fa=e=>Ul(e)||zg(e),Ab=e=>e.type==="setValue",Ys=e=>e.type==="setValueCurve",Zg=(e,t,n,r)=>{const i=e[t];return i===void 0?r:fa(i)||Ab(i)?i.value:Ys(i)?i.values[i.values.length-1]:YN(n,Zg(e,t-1,i.startTime,r),i)},A1=(e,t,n,r,i)=>n===void 0?[r.insertTime,i]:fa(n)?[n.endTime,n.value]:Ab(n)?[n.startTime,n.value]:Ys(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,Zg(e,t-1,n.startTime,i)],NC=e=>e.type==="cancelAndHold",PC=e=>e.type==="cancelScheduledValues",na=e=>NC(e)||PC(e)?e.cancelTime:Ul(e)||zg(e)?e.endTime:e.startTime,E1=(e,t,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((e-t)/(r-t)):0,T1=(e,t,n,{endTime:r,value:i})=>n+(e-t)/(r-t)*(i-n),QV=(e,t)=>{const n=Math.floor(t),r=Math.ceil(t);return n===r?e[n]:(1-(t-n))*e[n]+(1-(r-t))*e[r]},eG=(e,{duration:t,startTime:n,values:r})=>{const i=(e-n)/t*(r.length-1);return QV(r,i)},rp=e=>e.type==="setTarget";class tG{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(t){const n=na(t);if(NC(t)||PC(t)){const r=this._automationEvents.findIndex(s=>PC(t)&&Ys(s)?s.startTime+s.duration>=n:na(s)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),NC(t)){const s=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&fa(i)){if(s!==void 0&&rp(s))throw new Error("The internal list is malformed.");const o=s===void 0?i.insertTime:Ys(s)?s.startTime+s.duration:na(s),a=s===void 0?this._defaultValue:Ys(s)?s.values[s.values.length-1]:s.value,c=Ul(i)?E1(n,o,a,i):T1(n,o,a,i),l=Ul(i)?w1(c,n,this._currenTime):k1(c,n,this._currenTime);this._automationEvents.push(l)}if(s!==void 0&&rp(s)&&this._automationEvents.push(xC(this.getValue(n),n)),s!==void 0&&Ys(s)&&s.startTime+s.duration>n){const o=n-s.startTime,a=(s.values.length-1)/s.duration,c=Math.max(2,1+Math.ceil(o*a)),l=o/(c-1)*a,u=s.values.slice(0,c);if(l<1)for(let d=1;d<c;d+=1){const f=l*d%1;u[d]=s.values[d-1]*(1-f)+s.values[d]*f}this._automationEvents[this._automationEvents.length-1]=JN(u,s.startTime,o)}}}else{const r=this._automationEvents.findIndex(o=>na(o)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Ys(i)&&na(i)+i.duration>n)return!1;const s=Ul(t)?w1(t.value,t.endTime,this._currenTime):zg(t)?k1(t.value,n,this._currenTime):t;if(r===-1)this._automationEvents.push(s);else{if(Ys(t)&&n+t.duration>na(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(t){const n=this._automationEvents.findIndex(r=>na(r)>t);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];rp(i)&&r.unshift(xC(Zg(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(t){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(o=>na(o)>t),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,s=this._automationEvents[i];if(s!==void 0&&rp(s)&&(r===void 0||!fa(r)||r.insertTime>t))return YN(t,Zg(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(s!==void 0&&Ab(s)&&(r===void 0||!fa(r)))return s.value;if(s!==void 0&&Ys(s)&&(r===void 0||!fa(r)||s.startTime+s.duration>t))return t<s.startTime+s.duration?eG(t,s):s.values[s.values.length-1];if(s!==void 0&&fa(s)&&(r===void 0||!fa(r)))return s.value;if(r!==void 0&&Ul(r)){const[o,a]=A1(this._automationEvents,i,s,r,this._defaultValue);return E1(t,o,a,r)}if(r!==void 0&&zg(r)){const[o,a]=A1(this._automationEvents,i,s,r,this._defaultValue);return T1(t,o,a,r)}return this._defaultValue}}const nG=e=>({cancelTime:e,type:"cancelAndHold"}),rG=e=>({cancelTime:e,type:"cancelScheduledValues"}),iG=(e,t)=>({endTime:t,type:"exponentialRampToValue",value:e}),sG=(e,t)=>({endTime:t,type:"linearRampToValue",value:e}),oG=(e,t,n)=>({startTime:t,target:e,timeConstant:n,type:"setTarget"}),aG=()=>new DOMException("","AbortError"),cG=e=>(t,n,[r,i,s],o)=>{e(t[i],[n,r,s],a=>a[0]===n&&a[1]===r,o)},lG=e=>(t,n,r)=>{const i=[];for(let s=0;s<r.numberOfInputs;s+=1)i.push(new Set);e.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},uG=e=>(t,n)=>{e.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Tu=new WeakSet,qN=new WeakMap,QN=new WeakMap,eP=new WeakMap,tP=new WeakMap,nP=new WeakMap,rP=new WeakMap,MC=new WeakMap,OC=new WeakMap,DC=new WeakMap,iP={construct(){return iP}},dG=e=>{try{const t=new Proxy(e,iP);new t}catch{return!1}return!0},_1=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,R1=(e,t)=>{const n=[];let r=e.replace(/^[\s]+/,""),i=r.match(_1);for(;i!==null;){const s=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,t).toString());n.push(o),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(_1)}return[n.join(";"),r]},x1=e=>{if(e!==void 0&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},N1=e=>{if(!dG(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(e.prototype===null||typeof e.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},fG=(e,t,n,r,i,s,o,a,c,l,u,d,f)=>{let h=0;return(p,m,y={credentials:"omit"})=>{const g=u.get(p);if(g!==void 0&&g.has(m))return Promise.resolve();const v=l.get(p);if(v!==void 0){const k=v.get(m);if(k!==void 0)return k}const S=s(p),E=S.audioWorklet===void 0?i(m).then(([k,b])=>{const[A,_]=R1(k,b),P=`${A};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${_}
})})(window,'_AWGS')`;return n(P)}).then(()=>{const k=f._AWGS.pop();if(k===void 0)throw new SyntaxError;r(S.currentTime,S.sampleRate,()=>k(class{},void 0,(b,A)=>{if(b.trim()==="")throw t();const _=OC.get(S);if(_!==void 0){if(_.has(b))throw t();N1(A),x1(A.parameterDescriptors),_.set(b,A)}else N1(A),x1(A.parameterDescriptors),OC.set(S,new Map([[b,A]]))},S.sampleRate,void 0,void 0))}):Promise.all([i(m),Promise.resolve(e(d,d))]).then(([[k,b],A])=>{const _=h+1;h=_;const[P,N]=R1(k,b),G=`${P};((AudioWorkletProcessor,registerProcessor)=>{${N}
})(${A?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${A?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${A?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${_}',class extends AudioWorkletProcessor{process(){return !1}})`,z=new Blob([G],{type:"application/javascript; charset=utf-8"}),$=URL.createObjectURL(z);return S.audioWorklet.addModule($,y).then(()=>{if(a(S))return S;const q=o(S);return q.audioWorklet.addModule($,y).then(()=>q)}).then(q=>{if(c===null)throw new SyntaxError;try{new c(q,`__sac${_}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL($))});return v===void 0?l.set(p,new Map([[m,E]])):v.set(m,E),E.then(()=>{const k=u.get(p);k===void 0?u.set(p,new Set([m])):k.add(m)}).finally(()=>{const k=l.get(p);k!==void 0&&k.delete(m)}),E}},Yi=(e,t)=>{const n=e.get(t);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},nv=(e,t)=>{const n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return e.delete(r),r},sP=(e,t,n,r)=>{const i=Yi(e,t),s=nv(i,o=>o[0]===n&&o[1]===r);return i.size===0&&e.delete(t),s},mh=e=>Yi(rP,e),_u=e=>{if(Tu.has(e))throw new Error("The AudioNode is already stored.");Tu.add(e),mh(e).forEach(t=>t(!0))},oP=e=>"port"in e,vh=e=>{if(!Tu.has(e))throw new Error("The AudioNode is not stored.");Tu.delete(e),mh(e).forEach(t=>t(!1))},LC=(e,t)=>{!oP(e)&&t.every(n=>n.size===0)&&vh(e)},hG=(e,t,n,r,i,s,o,a,c,l,u,d,f)=>{const h=new WeakMap;return(p,m,y,g,v)=>{const{activeInputs:S,passiveInputs:E}=s(m),{outputs:k}=s(p),b=a(p),A=_=>{const P=c(m),N=c(p);if(_){const O=sP(E,p,y,g);e(S,p,O,!1),!v&&!d(p)&&n(N,P,y,g),f(m)&&_u(m)}else{const O=r(S,p,y,g);t(E,g,O,!1),!v&&!d(p)&&i(N,P,y,g);const D=o(m);if(D===0)u(m)&&LC(m,S);else{const U=h.get(m);U!==void 0&&clearTimeout(U),h.set(m,setTimeout(()=>{u(m)&&LC(m,S)},D*1e3))}}};return l(k,[m,y,g],_=>_[0]===m&&_[1]===y&&_[2]===g,!0)?(b.add(A),u(p)?e(S,p,[y,g,A],!0):t(E,g,[p,y,A],!0),!0):!1}},pG=e=>(t,n,[r,i,s],o)=>{const a=t.get(r);a===void 0?t.set(r,new Set([[i,n,s]])):e(a,[i,n,s],c=>c[0]===i&&c[1]===n,o)},gG=e=>(t,n)=>{const r=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(t.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},mG=e=>(t,n)=>{e(t).add(n)},vG={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},yG=(e,t,n,r,i,s)=>class extends e{constructor(a,c){const l=i(a),u={...vG,...c},d=r(l,u),f=s(l)?t():null;super(a,!1,d,f),this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},tr=(e,t)=>e.context===t,CG=(e,t,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=t(s);if(!tr(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=e(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},BC=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},js=()=>new DOMException("","IndexSizeError"),aP=e=>{e.getChannelData=(t=>n=>{try{return t.call(e,n)}catch(r){throw r.code===12?js():r}})(e.getChannelData)},IG={numberOfChannels:1},SG=(e,t,n,r,i,s,o,a)=>{let c=null;return class cP{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:f,sampleRate:h}={...IG,...u};c===null&&(c=new i(1,1,44100));const p=r!==null&&t(s,s)?new r({length:d,numberOfChannels:f,sampleRate:h}):c.createBuffer(f,d,h);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(o(p),aP(p)):t(BC,()=>BC(p))||a(p),e.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===cP.prototype||e.has(u)}}},kr=-34028234663852886e22,ar=-kr,Po=e=>Tu.has(e),bG={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},wG=(e,t,n,r,i,s,o,a)=>class extends e{constructor(l,u){const d=s(l),f={...bG,...u},h=i(d,f),p=o(d),m=p?t():null;super(l,!1,h,m),this._audioBufferSourceNodeRenderer=m,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=n(this,p,h.playbackRate,ar,kr)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?l:d}get playbackRate(){return this._playbackRate}start(l=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(l,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[l,u]:[l,u,d]),this.context.state!=="closed"){_u(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),Po(this)&&vh(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},kG=(e,t,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let d=n(l);const f=tr(d,u);if(!f){const h={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=t(u,h),o!==null&&d.start(...o),a!==null&&d.stop(a)}return s.set(u,d),f?await e(u,l.playbackRate,d.playbackRate):await r(u,l.playbackRate,d.playbackRate),await i(l,u,d),d};return{set start(l){o=l},set stop(l){a=l},render(l,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},AG=e=>"playbackRate"in e,EG=e=>"frequency"in e&&"gain"in e,TG=e=>"offset"in e,_G=e=>!("frequency"in e)&&"gain"in e,RG=e=>"detune"in e&&"frequency"in e,xG=e=>"pan"in e,dr=e=>Yi(qN,e),yh=e=>Yi(eP,e),FC=(e,t)=>{const{activeInputs:n}=dr(e);n.forEach(i=>i.forEach(([s])=>{t.includes(e)||FC(s,[...t,e])}));const r=AG(e)?[e.playbackRate]:oP(e)?Array.from(e.parameters.values()):EG(e)?[e.Q,e.detune,e.frequency,e.gain]:TG(e)?[e.offset]:_G(e)?[e.gain]:RG(e)?[e.detune,e.frequency]:xG(e)?[e.pan]:[];for(const i of r){const s=yh(i);s!==void 0&&s.activeInputs.forEach(([o])=>FC(o,t))}Po(e)&&vh(e)},NG=e=>{FC(e.destination,[])},PG=e=>e===void 0||typeof e=="number"||typeof e=="string"&&(e==="balanced"||e==="interactive"||e==="playback"),MG=(e,t,n,r,i,s,o,a,c)=>class extends e{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new c(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(d===null)throw r();if(!PG(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw n();super(d,2);const{latencyHint:f}=u,{sampleRate:h}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:f==="balanced"?512/h:f==="interactive"||f===void 0?256/h:f==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(f*h/128)))*128/h,this._nativeAudioContext=d,c.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",p)};d.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw t()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),NG(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(u){return new o(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?t():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?t():u})}},OG=(e,t,n,r,i,s,o,a)=>class extends e{constructor(l,u){const d=s(l),f=o(d),h=i(d,u,f),p=f?t(a):null;super(l,!1,h,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},DG=e=>{const t=new WeakMap,n=async(r,i)=>{const s=i.destination;return t.set(i,s),await e(r,i,s),s};return{render(r,i){const s=t.get(i);return s!==void 0?Promise.resolve(s):n(r,i)}}},LG=(e,t,n,r,i,s,o,a)=>(c,l)=>{const u=l.listener,d=()=>{const k=new Float32Array(1),b=t(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),A=o(l);let _=!1,P=[0,0,-1,0,1,0],N=[0,0,0];const O=()=>{if(_)return;_=!0;const z=r(l,256,9,0);z.onaudioprocess=({inputBuffer:$})=>{const q=[s($,k,0),s($,k,1),s($,k,2),s($,k,3),s($,k,4),s($,k,5)];q.some((X,ne)=>X!==P[ne])&&(u.setOrientation(...q),P=q);const W=[s($,k,6),s($,k,7),s($,k,8)];W.some((X,ne)=>X!==N[ne])&&(u.setPosition(...W),N=W)},b.connect(z)},D=z=>$=>{$!==P[z]&&(P[z]=$,u.setOrientation(...P))},U=z=>$=>{$!==N[z]&&(N[z]=$,u.setPosition(...N))},G=(z,$,q)=>{const W=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:$});W.connect(b,0,z),W.start(),Object.defineProperty(W.offset,"defaultValue",{get(){return $}});const X=e({context:c},A,W.offset,ar,kr);return a(X,"value",ne=>()=>ne.call(X),ne=>Z=>{try{ne.call(X,Z)}catch(ie){if(ie.code!==9)throw ie}O(),A&&q(Z)}),X.cancelAndHoldAtTime=(ne=>A?()=>{throw i()}:(...Z)=>{const ie=ne.apply(X,Z);return O(),ie})(X.cancelAndHoldAtTime),X.cancelScheduledValues=(ne=>A?()=>{throw i()}:(...Z)=>{const ie=ne.apply(X,Z);return O(),ie})(X.cancelScheduledValues),X.exponentialRampToValueAtTime=(ne=>A?()=>{throw i()}:(...Z)=>{const ie=ne.apply(X,Z);return O(),ie})(X.exponentialRampToValueAtTime),X.linearRampToValueAtTime=(ne=>A?()=>{throw i()}:(...Z)=>{const ie=ne.apply(X,Z);return O(),ie})(X.linearRampToValueAtTime),X.setTargetAtTime=(ne=>A?()=>{throw i()}:(...Z)=>{const ie=ne.apply(X,Z);return O(),ie})(X.setTargetAtTime),X.setValueAtTime=(ne=>A?()=>{throw i()}:(...Z)=>{const ie=ne.apply(X,Z);return O(),ie})(X.setValueAtTime),X.setValueCurveAtTime=(ne=>A?()=>{throw i()}:(...Z)=>{const ie=ne.apply(X,Z);return O(),ie})(X.setValueCurveAtTime),X};return{forwardX:G(0,0,D(0)),forwardY:G(1,0,D(1)),forwardZ:G(2,-1,D(2)),positionX:G(6,0,U(0)),positionY:G(7,0,U(1)),positionZ:G(8,0,U(2)),upX:G(3,0,D(3)),upY:G(4,1,D(4)),upZ:G(5,0,D(5))}},{forwardX:f,forwardY:h,forwardZ:p,positionX:m,positionY:y,positionZ:g,upX:v,upY:S,upZ:E}=u.forwardX===void 0?d():u;return{get forwardX(){return f},get forwardY(){return h},get forwardZ(){return p},get positionX(){return m},get positionY(){return y},get positionZ(){return g},get upX(){return v},get upY(){return S},get upZ(){return E}}},Xg=e=>"context"in e,Ch=e=>Xg(e[0]),nl=(e,t,n,r)=>{for(const i of e)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return e.add(t),!0},P1=(e,t,[n,r],i)=>{nl(e,[t,n,r],s=>s[0]===t&&s[1]===n,i)},M1=(e,[t,n,r],i)=>{const s=e.get(t);s===void 0?e.set(t,new Set([[n,r]])):nl(s,[n,r],o=>o[0]===n,i)},Zu=e=>"inputs"in e,Kg=(e,t,n,r)=>{if(Zu(t)){const i=t.inputs[r];return e.connect(i,n,0),[i,n,0]}return e.connect(t,n,r),[t,n,r]},lP=(e,t,n)=>{for(const r of e)if(r[0]===t&&r[1]===n)return e.delete(r),r;return null},BG=(e,t,n)=>nv(e,r=>r[0]===t&&r[1]===n),uP=(e,t)=>{if(!mh(e).delete(t))throw new Error("Missing the expected event listener.")},dP=(e,t,n)=>{const r=Yi(e,t),i=nv(r,s=>s[0]===n);return r.size===0&&e.delete(t),i},Jg=(e,t,n,r)=>{Zu(t)?e.disconnect(t.inputs[r],n,0):e.disconnect(t,n,r)},Dt=e=>Yi(QN,e),Ff=e=>Yi(tP,e),Gc=e=>MC.has(e),$p=e=>!Tu.has(e),O1=(e,t)=>new Promise(n=>{if(t!==null)n(!0);else{const r=e.createScriptProcessor(256,1,1),i=e.createGain(),s=e.createBuffer(1,2,44100),o=s.getChannelData(0);o[0]=1,o[1]=1;const a=e.createBufferSource();a.buffer=s,a.loop=!0,a.connect(r).connect(e.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(e.destination)},a.start()}}),Gy=(e,t)=>{const n=new Map;for(const r of e)for(const i of r){const s=n.get(i);n.set(i,s===void 0?1:s+1)}n.forEach((r,i)=>t(i,r))},Yg=e=>"context"in e,FG=e=>{const t=new Map;e.connect=(n=>(r,i=0,s=0)=>{const o=Yg(r)?n(r,i,s):n(r,i),a=t.get(r);return a===void 0?t.set(r,[{input:s,output:i}]):a.every(c=>c.input!==s||c.output!==i)&&a.push({input:s,output:i}),o})(e.connect.bind(e)),e.disconnect=(n=>(r,i,s)=>{if(n.apply(e),r===void 0)t.clear();else if(typeof r=="number")for(const[o,a]of t){const c=a.filter(l=>l.output!==r);c.length===0?t.delete(o):t.set(o,c)}else if(t.has(r))if(i===void 0)t.delete(r);else{const o=t.get(r);if(o!==void 0){const a=o.filter(c=>c.output!==i&&(c.input!==s||s===void 0));a.length===0?t.delete(r):t.set(r,a)}}for(const[o,a]of t)a.forEach(c=>{Yg(o)?e.connect(o,c.output,c.input):e.connect(o,c.output)})})(e.disconnect)},UG=(e,t,n,r)=>{const{activeInputs:i,passiveInputs:s}=yh(t),{outputs:o}=dr(e),a=mh(e),c=l=>{const u=Dt(e),d=Ff(t);if(l){const f=dP(s,e,n);P1(i,e,f,!1),!r&&!Gc(e)&&u.connect(d,n)}else{const f=BG(i,e,n);M1(s,f,!1),!r&&!Gc(e)&&u.disconnect(d,n)}};return nl(o,[t,n],l=>l[0]===t&&l[1]===n,!0)?(a.add(c),Po(e)?P1(i,e,[n,c],!0):M1(s,[e,n,c],!0),!0):!1},VG=(e,t,n,r)=>{const{activeInputs:i,passiveInputs:s}=dr(t),o=lP(i[r],e,n);return o===null?[sP(s,e,n,r)[2],!1]:[o[2],!0]},GG=(e,t,n)=>{const{activeInputs:r,passiveInputs:i}=yh(t),s=lP(r,e,n);return s===null?[dP(i,e,n)[1],!1]:[s[2],!0]},Eb=(e,t,n,r,i)=>{const[s,o]=VG(e,n,r,i);if(s!==null&&(uP(e,s),o&&!t&&!Gc(e)&&Jg(Dt(e),Dt(n),r,i)),Po(n)){const{activeInputs:a}=dr(n);LC(n,a)}},Tb=(e,t,n,r)=>{const[i,s]=GG(e,n,r);i!==null&&(uP(e,i),s&&!t&&!Gc(e)&&Dt(e).disconnect(Ff(n),r))},WG=(e,t)=>{const n=dr(e),r=[];for(const i of n.outputs)Ch(i)?Eb(e,t,...i):Tb(e,t,...i),r.push(i[0]);return n.outputs.clear(),r},jG=(e,t,n)=>{const r=dr(e),i=[];for(const s of r.outputs)s[1]===n&&(Ch(s)?Eb(e,t,...s):Tb(e,t,...s),i.push(s[0]),r.outputs.delete(s));return i},HG=(e,t,n,r,i)=>{const s=dr(e);return Array.from(s.outputs).filter(o=>o[0]===n&&(r===void 0||o[1]===r)&&(i===void 0||o[2]===i)).map(o=>(Ch(o)?Eb(e,t,...o):Tb(e,t,...o),s.outputs.delete(o),o[0]))},$G=(e,t,n,r,i,s,o,a,c,l,u,d,f,h,p,m)=>class extends l{constructor(g,v,S,E){super(S),this._context=g,this._nativeAudioNode=S;const k=u(g);d(k)&&n(O1,()=>O1(k,m))!==!0&&FG(S),QN.set(this,S),rP.set(this,new Set),g.state!=="closed"&&v&&_u(this),e(this,E,S)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(g){this._nativeAudioNode.channelCount=g}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(g){this._nativeAudioNode.channelCountMode=g}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(g){this._nativeAudioNode.channelInterpretation=g}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(g,v=0,S=0){if(v<0||v>=this._nativeAudioNode.numberOfOutputs)throw i();const E=u(this._context),k=p(E);if(f(g)||h(g))throw s();if(Xg(g)){const _=Dt(g);try{const N=Kg(this._nativeAudioNode,_,v,S),O=$p(this);(k||O)&&this._nativeAudioNode.disconnect(...N),this.context.state!=="closed"&&!O&&$p(g)&&_u(g)}catch(N){throw N.code===12?s():N}if(t(this,g,v,S,k)){const N=c([this],g);Gy(N,r(k))}return g}const b=Ff(g);if(b.name==="playbackRate"&&b.maxValue===1024)throw o();try{this._nativeAudioNode.connect(b,v),(k||$p(this))&&this._nativeAudioNode.disconnect(b,v)}catch(_){throw _.code===12?s():_}if(UG(this,g,v,k)){const _=c([this],g);Gy(_,r(k))}}disconnect(g,v,S){let E;const k=u(this._context),b=p(k);if(g===void 0)E=WG(this,b);else if(typeof g=="number"){if(g<0||g>=this.numberOfOutputs)throw i();E=jG(this,b,g)}else{if(v!==void 0&&(v<0||v>=this.numberOfOutputs)||Xg(g)&&S!==void 0&&(S<0||S>=g.numberOfInputs))throw i();if(E=HG(this,b,g,v,S),E.length===0)throw s()}for(const A of E){const _=c([this],A);Gy(_,a)}}},zG=(e,t,n,r,i,s,o,a,c,l,u,d,f)=>(h,p,m,y=null,g=null)=>{const v=m.value,S=new tG(v),E=p?r(S):null,k={get defaultValue(){return v},get maxValue(){return y===null?m.maxValue:y},get minValue(){return g===null?m.minValue:g},get value(){return m.value},set value(b){m.value=b,k.setValueAtTime(b,h.context.currentTime)},cancelAndHoldAtTime(b){if(typeof m.cancelAndHoldAtTime=="function")E===null&&S.flush(h.context.currentTime),S.add(i(b)),m.cancelAndHoldAtTime(b);else{const A=Array.from(S).pop();E===null&&S.flush(h.context.currentTime),S.add(i(b));const _=Array.from(S).pop();m.cancelScheduledValues(b),A!==_&&_!==void 0&&(_.type==="exponentialRampToValue"?m.exponentialRampToValueAtTime(_.value,_.endTime):_.type==="linearRampToValue"?m.linearRampToValueAtTime(_.value,_.endTime):_.type==="setValue"?m.setValueAtTime(_.value,_.startTime):_.type==="setValueCurve"&&m.setValueCurveAtTime(_.values,_.startTime,_.duration))}return k},cancelScheduledValues(b){return E===null&&S.flush(h.context.currentTime),S.add(s(b)),m.cancelScheduledValues(b),k},exponentialRampToValueAtTime(b,A){if(b===0)throw new RangeError;if(!Number.isFinite(A)||A<0)throw new RangeError;const _=h.context.currentTime;return E===null&&S.flush(_),Array.from(S).length===0&&(S.add(l(v,_)),m.setValueAtTime(v,_)),S.add(o(b,A)),m.exponentialRampToValueAtTime(b,A),k},linearRampToValueAtTime(b,A){const _=h.context.currentTime;return E===null&&S.flush(_),Array.from(S).length===0&&(S.add(l(v,_)),m.setValueAtTime(v,_)),S.add(a(b,A)),m.linearRampToValueAtTime(b,A),k},setTargetAtTime(b,A,_){return E===null&&S.flush(h.context.currentTime),S.add(c(b,A,_)),m.setTargetAtTime(b,A,_),k},setValueAtTime(b,A){return E===null&&S.flush(h.context.currentTime),S.add(l(b,A)),m.setValueAtTime(b,A),k},setValueCurveAtTime(b,A,_){const P=b instanceof Float32Array?b:new Float32Array(b);if(d!==null&&d.name==="webkitAudioContext"){const N=A+_,O=h.context.sampleRate,D=Math.ceil(A*O),U=Math.floor(N*O),G=U-D,z=new Float32Array(G);for(let q=0;q<G;q+=1){const W=(P.length-1)/_*((D+q)/O-A),X=Math.floor(W),ne=Math.ceil(W);z[q]=X===ne?P[X]:(1-(W-X))*P[X]+(1-(ne-W))*P[ne]}E===null&&S.flush(h.context.currentTime),S.add(u(z,A,_)),m.setValueCurveAtTime(z,A,_);const $=U/O;$<N&&f(k,z[z.length-1],$),f(k,P[P.length-1],N)}else E===null&&S.flush(h.context.currentTime),S.add(u(P,A,_)),m.setValueCurveAtTime(P,A,_);return k}};return n.set(k,m),t.set(k,h),e(k,E),k},ZG=e=>({replay(t){for(const n of e)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;t.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;t.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:s}=n;t.setTargetAtTime(i,r,s)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;t.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:s}=n;t.setValueCurveAtTime(s,i,r)}else throw new Error("Can't apply an unknown automation.")}});class fP{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,n=null){return this._map.forEach((r,i)=>t.call(n,r,i,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const XG={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},KG=(e,t,n,r,i,s,o,a,c,l,u,d,f,h)=>class extends t{constructor(m,y,g){var v;const S=a(m),E=c(S),k=u({...XG,...g});f(k);const b=OC.get(S),A=b==null?void 0:b.get(y),_=E||S.state!=="closed"?S:(v=o(S))!==null&&v!==void 0?v:S,P=i(_,E?null:m.baseLatency,l,y,A,k),N=E?r(y,k,A):null;super(m,!0,P,N);const O=[];P.parameters.forEach((U,G)=>{const z=n(this,E,U);O.push([G,z])}),this._nativeAudioWorkletNode=P,this._onprocessorerror=null,this._parameters=new fP(O),E&&e(S,this);const{activeInputs:D}=s(this);d(P,D)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(m){const y=typeof m=="function"?h(this,m):null;this._nativeAudioWorkletNode.onprocessorerror=y;const g=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=g!==null&&g===y?m:g}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function qg(e,t,n,r,i){if(typeof e.copyFromChannel=="function")t[n].byteLength===0&&(t[n]=new Float32Array(128)),e.copyFromChannel(t[n],r,i);else{const s=e.getChannelData(r);if(t[n].byteLength===0)t[n]=s.slice(i,i+128);else{const o=new Float32Array(s.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(o)}}}const hP=(e,t,n,r,i)=>{typeof e.copyToChannel=="function"?t[n].byteLength!==0&&e.copyToChannel(t[n],r,i):t[n].byteLength!==0&&e.getChannelData(r).set(t[n],i)},Qg=(e,t)=>{const n=[];for(let r=0;r<e;r+=1){const i=[],s=typeof t=="number"?t:t[r];for(let o=0;o<s;o+=1)i.push(new Float32Array(128));n.push(i)}return n},JG=(e,t)=>{const n=Yi(DC,e),r=Dt(t);return Yi(n,r)},YG=async(e,t,n,r,i,s,o)=>{const a=t===null?Math.ceil(e.context.length/128)*128:t.length,c=r.channelCount*r.numberOfInputs,l=i.reduce((y,g)=>y+g,0),u=l===0?null:n.createBuffer(l,a,n.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const d=dr(e),f=await JG(n,e),h=Qg(r.numberOfInputs,r.channelCount),p=Qg(r.numberOfOutputs,i),m=Array.from(e.parameters.keys()).reduce((y,g)=>({...y,[g]:new Float32Array(128)}),{});for(let y=0;y<a;y+=128){if(r.numberOfInputs>0&&t!==null)for(let g=0;g<r.numberOfInputs;g+=1)for(let v=0;v<r.channelCount;v+=1)qg(t,h[g],v,v,y);s.parameterDescriptors!==void 0&&t!==null&&s.parameterDescriptors.forEach(({name:g},v)=>{qg(t,m,g,c+v,y)});for(let g=0;g<r.numberOfInputs;g+=1)for(let v=0;v<i[g];v+=1)p[g][v].byteLength===0&&(p[g][v]=new Float32Array(128));try{const g=h.map((S,E)=>d.activeInputs[E].size===0?[]:S),v=o(y/n.sampleRate,n.sampleRate,()=>f.process(g,p,m));if(u!==null)for(let S=0,E=0;S<r.numberOfOutputs;S+=1){for(let k=0;k<i[S];k+=1)hP(u,p[S],k,E+k,y);E+=i[S]}if(!v)break}catch(g){e.dispatchEvent(new ErrorEvent("processorerror",{colno:g.colno,filename:g.filename,lineno:g.lineno,message:g.message}));break}}return u},qG=(e,t,n,r,i,s,o,a,c,l,u,d,f,h,p,m)=>(y,g,v)=>{const S=new WeakMap;let E=null;const k=async(b,A)=>{let _=u(b),P=null;const N=tr(_,A),O=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(d===null){const D=O.reduce(($,q)=>$+q,0),U=i(A,{channelCount:Math.max(1,D),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,D)}),G=[];for(let $=0;$<b.numberOfOutputs;$+=1)G.push(r(A,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:O[$]}));const z=o(A,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});z.connect=t.bind(null,G),z.disconnect=c.bind(null,G),P=[U,G,z]}else N||(_=new d(A,y));if(S.set(A,P===null?_:P[2]),P!==null){if(E===null){if(v===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const q=b.channelCount*b.numberOfInputs,W=v.parameterDescriptors===void 0?0:v.parameterDescriptors.length,X=q+W;E=YG(b,X===0?null:await(async()=>{const Z=new f(X,Math.ceil(b.context.length/128)*128,A.sampleRate),ie=[],ke=[];for(let Te=0;Te<g.numberOfInputs;Te+=1)ie.push(o(Z,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),ke.push(i(Z,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const Ee=await Promise.all(Array.from(b.parameters.values()).map(async Te=>{const Qe=s(Z,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Te.value});return await h(Z,Te,Qe.offset),Qe})),ge=r(Z,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,q+W)});for(let Te=0;Te<g.numberOfInputs;Te+=1){ie[Te].connect(ke[Te]);for(let Qe=0;Qe<g.channelCount;Qe+=1)ke[Te].connect(ge,Qe,Te*g.channelCount+Qe)}for(const[Te,Qe]of Ee.entries())Qe.connect(ge,0,q+Te),Qe.start(0);return ge.connect(Z.destination),await Promise.all(ie.map(Te=>p(b,Z,Te))),m(Z)})(),A,g,O,v,l)}const D=await E,U=n(A,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[G,z,$]=P;D!==null&&(U.buffer=D,U.start(0)),U.connect(G);for(let q=0,W=0;q<b.numberOfOutputs;q+=1){const X=z[q];for(let ne=0;ne<O[q];ne+=1)G.connect(X,W+ne,ne);W+=O[q]}return $}if(N)for(const[D,U]of b.parameters.entries())await e(A,U,_.parameters.get(D));else for(const[D,U]of b.parameters.entries())await h(A,U,_.parameters.get(D));return await p(b,A,_),_};return{render(b,A){a(A,b);const _=S.get(A);return _!==void 0?Promise.resolve(_):k(b,A)}}},QG=(e,t,n,r,i,s,o,a,c,l,u,d,f,h,p,m,y,g,v,S)=>class extends p{constructor(k,b){super(k,b),this._nativeContext=k,this._audioWorklet=e===void 0?void 0:{addModule:(A,_)=>e(this,A,_)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new i(this)}createBuffer(k,b,A){return new n({length:b,numberOfChannels:k,sampleRate:A})}createBufferSource(){return new r(this)}createChannelMerger(k=6){return new s(this,{numberOfInputs:k})}createChannelSplitter(k=6){return new o(this,{numberOfOutputs:k})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(k=1){return new u(this,{maxDelayTime:k})}createDynamicsCompressor(){return new d(this)}createGain(){return new f(this)}createIIRFilter(k,b){return new h(this,{feedback:b,feedforward:k})}createOscillator(){return new m(this)}createPanner(){return new y(this)}createPeriodicWave(k,b,A={disableNormalization:!1}){return new g(this,{...A,imag:b,real:k})}createStereoPanner(){return new v(this)}createWaveShaper(){return new S(this)}decodeAudioData(k,b,A){return l(this._nativeContext,k).then(_=>(typeof b=="function"&&b(_),_),_=>{throw typeof A=="function"&&A(_),_})}},eW={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},tW=(e,t,n,r,i,s,o,a)=>class extends e{constructor(l,u){const d=s(l),f={...eW,...u},h=i(d,f),p=o(d),m=p?n():null;super(l,!1,h,m),this._Q=t(this,p,h.Q,ar,kr),this._detune=t(this,p,h.detune,1200*Math.log2(ar),-1200*Math.log2(ar)),this._frequency=t(this,p,h.frequency,l.sampleRate/2,0),this._gain=t(this,p,h.gain,40*Math.log10(ar),kr),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,d)}catch(f){throw f.code===11?r():f}if(l.length!==u.length||u.length!==d.length)throw r()}},nW=(e,t,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=tr(l,c);if(!u){const d={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=t(c,d)}return s.set(c,l),u?(await e(c,a.Q,l.Q),await e(c,a.detune,l.detune),await e(c,a.frequency,l.frequency),await e(c,a.gain,l.gain)):(await r(c,a.Q,l.Q),await r(c,a.detune,l.detune),await r(c,a.frequency,l.frequency),await r(c,a.gain,l.gain)),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},rW=(e,t)=>(n,r)=>{const i=t.get(n);if(i!==void 0)return i;const s=e.get(n);if(s!==void 0)return s;try{const o=r();return o instanceof Promise?(e.set(n,o),o.catch(()=>!1).then(a=>(e.delete(n),t.set(n,a),a))):(t.set(n,o),o)}catch{return t.set(n,!1),!1}},iW={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},sW=(e,t,n,r,i)=>class extends e{constructor(o,a){const c=r(o),l={...iW,...a},u=n(c,l),d=i(c)?t():null;super(o,!1,u,d)}},oW=(e,t,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=t(s);if(!tr(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=e(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},aW={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},cW=(e,t,n,r,i,s)=>class extends e{constructor(a,c){const l=r(a),u=s({...aW,...c}),d=n(l,u),f=i(l)?t():null;super(a,!1,d,f)}},lW=(e,t,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=t(s);if(!tr(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=e(o,l)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},uW=e=>(t,n,r)=>e(n,t,r),dW=e=>(t,n,r=0,i=0)=>{const s=t[r];if(s===void 0)throw e();return Yg(n)?s.connect(n,0,i):s.connect(n,0)},fW=e=>(t,n)=>{const r=e(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=t.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},hW={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},pW=(e,t,n,r,i,s,o)=>class extends e{constructor(c,l){const u=i(c),d={...hW,...l},f=r(u,d),h=s(u),p=h?n():null;super(c,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=t(this,h,f.offset,ar,kr),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){_u(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),Po(this)&&vh(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},gW=(e,t,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let d=n(l);const f=tr(d,u);if(!f){const h={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=t(u,h),o!==null&&d.start(o),a!==null&&d.stop(a)}return s.set(u,d),f?await e(u,l.offset,d.offset):await r(u,l.offset,d.offset),await i(l,u,d),d};return{set start(l){o=l},set stop(l){a=l},render(l,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},mW=e=>t=>(e[0]=t,e[0]),vW={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},yW=(e,t,n,r,i,s)=>class extends e{constructor(a,c){const l=r(a),u={...vW,...c},d=n(l,u),h=i(l)?t():null;super(a,!1,d,h),this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},CW=(e,t,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=t(s);if(!tr(a,o)){const l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=e(o,l)}return r.set(o,a),Zu(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},IW=()=>new DOMException("","DataCloneError"),D1=e=>{const{port1:t,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,t.close(),n.close(),r()};n.onmessage=()=>i();try{t.postMessage(e,[e])}catch{}finally{i()}})},SW=(e,t,n,r,i,s,o,a,c,l,u)=>(d,f)=>{const h=o(d)?d:s(d);if(i.has(f)){const p=n();return Promise.reject(p)}try{i.add(f)}catch{}return t(c,()=>c(h))?h.decodeAudioData(f).then(p=>(D1(f).catch(()=>{}),t(a,()=>a(p))||u(p),e.add(p),p)):new Promise((p,m)=>{const y=async()=>{try{await D1(f)}catch{}},g=v=>{m(v),y()};try{h.decodeAudioData(f,v=>{typeof v.copyFromChannel!="function"&&(l(v),aP(v)),e.add(v),y().then(()=>p(v))},v=>{g(v===null?r():v)})}catch(v){g(v)}})},bW=(e,t,n,r,i,s,o,a)=>(c,l)=>{const u=t.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=s(c.context),f=a(d);if(u===l){if(t.delete(c),!f&&o(c)){const h=r(c),{outputs:p}=n(c);for(const m of p)if(Ch(m)){const y=r(m[0]);e(h,y,m[1],m[2])}else{const y=i(m[0]);h.connect(y,m[1])}}}else t.set(c,u-l)},wW={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},kW=(e,t,n,r,i,s,o)=>class extends e{constructor(c,l){const u=i(c),d={...wW,...l},f=r(u,d),h=s(u),p=h?n(d.maxDelayTime):null;super(c,!1,f,p),this._delayTime=t(this,h,f.delayTime),o(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},AW=(e,t,n,r,i)=>s=>{const o=new WeakMap,a=async(c,l)=>{let u=n(c);const d=tr(u,l);if(!d){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=t(l,f)}return o.set(l,u),d?await e(l,c.delayTime,u.delayTime):await r(l,c.delayTime,u.delayTime),await i(c,l,u),u};return{render(c,l){const u=o.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}},EW=e=>(t,n,r,i)=>e(t[i],s=>s[0]===n&&s[1]===r),TW=e=>(t,n)=>{e(t).delete(n)},_W=e=>"delayTime"in e,RW=(e,t,n)=>function r(i,s){const o=Xg(s)?s:n(e,s);if(_W(o))return[];if(i[0]===o)return[i];if(i.includes(o))return[];const{outputs:a}=t(o);return Array.from(a).map(c=>r([...i,o],c[0])).reduce((c,l)=>c.concat(l),[])},ip=(e,t,n)=>{const r=t[n];if(r===void 0)throw e();return r},xW=e=>(t,n=void 0,r=void 0,i=0)=>n===void 0?t.forEach(s=>s.disconnect()):typeof n=="number"?ip(e,t,n).disconnect():Yg(n)?r===void 0?t.forEach(s=>s.disconnect(n)):i===void 0?ip(e,t,r).disconnect(n,0):ip(e,t,r).disconnect(n,0,i):r===void 0?t.forEach(s=>s.disconnect(n)):ip(e,t,r).disconnect(n,0),NW={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},PW=(e,t,n,r,i,s,o,a)=>class extends e{constructor(l,u){const d=s(l),f={...NW,...u},h=r(d,f),p=o(d),m=p?n():null;super(l,!1,h,m),this._attack=t(this,p,h.attack),this._knee=t(this,p,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=t(this,p,h.ratio),this._release=t(this,p,h.release),this._threshold=t(this,p,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},MW=(e,t,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=tr(l,c);if(!u){const d={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=t(c,d)}return s.set(c,l),u?(await e(c,a.attack,l.attack),await e(c,a.knee,l.knee),await e(c,a.ratio,l.ratio),await e(c,a.release,l.release),await e(c,a.threshold,l.threshold)):(await r(c,a.attack,l.attack),await r(c,a.knee,l.knee),await r(c,a.ratio,l.ratio),await r(c,a.release,l.release),await r(c,a.threshold,l.threshold)),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},OW=()=>new DOMException("","EncodingError"),DW=e=>t=>new Promise((n,r)=>{if(e===null){r(new SyntaxError);return}const i=e.document.head;if(i===null)r(new SyntaxError);else{const s=e.document.createElement("script"),o=new Blob([t],{type:"application/javascript"}),a=URL.createObjectURL(o),c=e.onerror,l=()=>{e.onerror=c,URL.revokeObjectURL(a)};e.onerror=(u,d,f,h,p)=>{if(d===a||d===e.location.href&&f===1&&h===1)return l(),r(p),!1;if(c!==null)return c(u,d,f,h,p)},s.onerror=()=>{l(),r(new SyntaxError)},s.onload=()=>{l(),n()},s.src=a,s.type="module",i.appendChild(s)}}),LW=e=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=e(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(n,s,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,s===void 0?null:s,i)}},BW=e=>(t,n,r)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get(){return Math.round(t*n)}},currentTime:{configurable:!0,get(){return t}}});try{return r()}finally{e!==null&&(delete e.currentFrame,delete e.currentTime)}},FW=e=>async t=>{try{const n=await fetch(t);if(n.ok)return[await n.text(),n.url]}catch{}throw e()},UW={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},VW=(e,t,n,r,i,s)=>class extends e{constructor(a,c){const l=i(a),u={...UW,...c},d=r(l,u),f=s(l),h=f?n():null;super(a,!1,d,h),this._gain=t(this,f,d.gain,ar,kr)}get gain(){return this._gain}},GW=(e,t,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=tr(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=t(c,d)}return s.set(c,l),u?await e(c,a.gain,l.gain):await r(c,a.gain,l.gain),await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},WW=(e,t)=>n=>t(e,n),jW=e=>t=>{const n=e(t);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},HW=e=>t=>{var n;return(n=e.get(t))!==null&&n!==void 0?n:0},$W=e=>t=>{const n=e(t);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},zW=e=>t=>e.get(t),Un=()=>new DOMException("","InvalidStateError"),ZW=e=>t=>{const n=e.get(t);if(n===void 0)throw Un();return n},XW=(e,t)=>n=>{let r=e.get(n);if(r!==void 0)return r;if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new t(1,1,44100),e.set(n,r),r},KW=e=>t=>{const n=e.get(t);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},rv=()=>new DOMException("","InvalidAccessError"),JW=e=>{e.getFrequencyResponse=(t=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw rv();return t.call(e,n,r,i)})(e.getFrequencyResponse)},YW={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},qW=(e,t,n,r,i,s)=>class extends e{constructor(a,c){const l=r(a),u=i(l),d={...YW,...c},f=t(l,u?null:a.baseLatency,d),h=u?n(d.feedback,d.feedforward):null;super(a,!1,f,h),JW(f),this._nativeIIRFilterNode=f,s(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}},pP=(e,t,n,r,i,s,o,a,c,l,u)=>{const d=l.length;let f=a;for(let h=0;h<d;h+=1){let p=n[0]*l[h];for(let m=1;m<i;m+=1){const y=f-m&c-1;p+=n[m]*s[y],p-=e[m]*o[y]}for(let m=i;m<r;m+=1)p+=n[m]*s[f-m&c-1];for(let m=i;m<t;m+=1)p-=e[m]*o[f-m&c-1];s[f]=l[h],o[f]=p,f=f+1&c-1,u[h]=p}return f},QW=(e,t,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),s=r instanceof Float64Array?r:new Float64Array(r),o=i.length,a=s.length,c=Math.min(o,a);if(i[0]!==1){for(let p=0;p<o;p+=1)s[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const l=32,u=new Float32Array(l),d=new Float32Array(l),f=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),h=e.numberOfChannels;for(let p=0;p<h;p+=1){const m=e.getChannelData(p),y=f.getChannelData(p);u.fill(0),d.fill(0),pP(i,o,s,a,c,u,d,0,l,m,y)}return f},ej=(e,t,n,r,i)=>(s,o)=>{const a=new WeakMap;let c=null;const l=async(u,d)=>{let f=null,h=t(u);const p=tr(h,d);if(d.createIIRFilter===void 0?f=e(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(h=d.createIIRFilter(o,s)),a.set(d,f===null?h:f),f!==null){if(c===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const y=new n(u.context.destination.channelCount,u.context.length,d.sampleRate);c=(async()=>{await r(u,y,y.destination);const g=await i(y);return QW(g,d,s,o)})()}const m=await c;return f.buffer=m,f.start(0),f}return await r(u,d,h),h};return{render(u,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):l(u,d)}}},tj=(e,t,n,r,i,s)=>o=>(a,c)=>{const l=e.get(a);if(l===void 0){if(!o&&s(a)){const u=r(a),{outputs:d}=n(a);for(const f of d)if(Ch(f)){const h=r(f[0]);t(u,h,f[1],f[2])}else{const h=i(f[0]);u.disconnect(h,f[1])}}e.set(a,c)}else e.set(a,l+c)},nj=e=>t=>e!==null&&t instanceof e,rj=e=>t=>e!==null&&typeof e.AudioNode=="function"&&t instanceof e.AudioNode,ij=e=>t=>e!==null&&typeof e.AudioParam=="function"&&t instanceof e.AudioParam,sj=(e,t)=>n=>e(n)||t(n),oj=e=>t=>e!==null&&t instanceof e,aj=e=>e!==null&&e.isSecureContext,cj=(e,t,n,r)=>class extends e{constructor(s,o){const a=n(s),c=t(a,o);if(r(a))throw TypeError();super(s,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},lj={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},uj=(e,t,n,r)=>class extends e{constructor(s,o){const a=n(s);if(r(a))throw new TypeError;const c={...lj,...o},l=t(a,c);super(s,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},dj=(e,t,n,r)=>class extends e{constructor(s,o){const a=n(s),c=t(a,o);if(r(a))throw new TypeError;super(s,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},fj=(e,t,n)=>class extends e{constructor(i,s){const o=n(i),a=t(o,s);super(i,!0,a,null)}},hj=(e,t,n,r,i,s)=>class extends n{constructor(a,c){super(a),this._nativeContext=a,nP.set(this,a),r(a)&&i.set(a,new Set),this._destination=new e(this,c),this._listener=t(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},UC=e=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=e.decodeAudioData(t.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},pj=(e,t)=>(n,r,i)=>{const s=new Set;return n.connect=(o=>(a,c=0,l=0)=>{const u=s.size===0;if(t(a))return o.call(n,a,c,l),e(s,[a,c,l],d=>d[0]===a&&d[1]===c&&d[2]===l,!0),u&&r(),a;o.call(n,a,c),e(s,[a,c],d=>d[0]===a&&d[1]===c,!0),u&&r()})(n.connect),n.disconnect=(o=>(a,c,l)=>{const u=s.size>0;if(a===void 0)o.apply(n),s.clear();else if(typeof a=="number"){o.call(n,a);for(const f of s)f[1]===a&&s.delete(f)}else{t(a)?o.call(n,a,c,l):o.call(n,a,c);for(const f of s)f[0]===a&&(c===void 0||f[1]===c)&&(l===void 0||f[2]===l)&&s.delete(f)}const d=s.size===0;u&&d&&i()})(n.disconnect),n},Bt=(e,t,n)=>{const r=t[n];r!==void 0&&r!==e[n]&&(e[n]=r)},Cn=(e,t)=>{Bt(e,t,"channelCount"),Bt(e,t,"channelCountMode"),Bt(e,t,"channelInterpretation")},L1=e=>typeof e.getFloatTimeDomainData=="function",gj=e=>{e.getFloatTimeDomainData=t=>{const n=new Uint8Array(t.length);e.getByteTimeDomainData(n);const r=Math.max(n.length,e.fftSize);for(let i=0;i<r;i+=1)t[i]=(n[i]-128)*.0078125;return t}},mj=(e,t)=>(n,r)=>{const i=n.createAnalyser();if(Cn(i,r),!(r.maxDecibels>r.minDecibels))throw t();return Bt(i,r,"fftSize"),Bt(i,r,"maxDecibels"),Bt(i,r,"minDecibels"),Bt(i,r,"smoothingTimeConstant"),e(L1,()=>L1(i))||gj(i),i},vj=e=>e===null?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null,Kt=(e,t,n)=>{const r=t[n];r!==void 0&&r!==e[n].value&&(e[n].value=r)},yj=e=>{e.start=(t=>{let n=!1;return(r=0,i=0,s)=>{if(n)throw Un();t.call(e,r,i,s),n=!0}})(e.start)},_b=e=>{e.start=(t=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(e,n,r,i)})(e.start)},Rb=e=>{e.stop=(t=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");t.call(e,n)})(e.stop)},Cj=(e,t,n,r,i,s,o,a,c,l,u)=>(d,f)=>{const h=d.createBufferSource();return Cn(h,f),Kt(h,f,"playbackRate"),Bt(h,f,"buffer"),Bt(h,f,"loop"),Bt(h,f,"loopEnd"),Bt(h,f,"loopStart"),t(n,()=>n(d))||yj(h),t(r,()=>r(d))||c(h),t(i,()=>i(d))||l(h,d),t(s,()=>s(d))||_b(h),t(o,()=>o(d))||u(h,d),t(a,()=>a(d))||Rb(h),e(d,h),h},Ij=e=>e===null?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null,Sj=(e,t)=>(n,r,i)=>{const s=n.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}i&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});const o=e(n,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return t(o,"channelCount",a=>()=>a.call(o),a=>c=>{a.call(o,c);try{s.channelCount=c}catch(l){if(c>s.maxChannelCount)throw l}}),t(o,"channelCountMode",a=>()=>a.call(o),a=>c=>{a.call(o,c),s.channelCountMode=c}),t(o,"channelInterpretation",a=>()=>a.call(o),a=>c=>{a.call(o,c),s.channelInterpretation=c}),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o},bj=e=>e===null?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null,wj=e=>{const{port1:t}=new MessageChannel;try{t.postMessage(e)}finally{t.close()}},kj=(e,t,n,r,i)=>(s,o,a,c,l,u)=>{if(a!==null)try{const d=new a(s,c,u),f=new Map;let h=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw e()}},channelCountMode:{get:()=>"explicit",set:()=>{throw e()}},onprocessorerror:{get:()=>h,set:p=>{typeof h=="function"&&d.removeEventListener("processorerror",h),h=typeof p=="function"?p:null,typeof h=="function"&&d.addEventListener("processorerror",h)}}}),d.addEventListener=(p=>(...m)=>{if(m[0]==="processorerror"){const y=typeof m[1]=="function"?m[1]:typeof m[1]=="object"&&m[1]!==null&&typeof m[1].handleEvent=="function"?m[1].handleEvent:null;if(y!==null){const g=f.get(m[1]);g!==void 0?m[1]=g:(m[1]=v=>{v.type==="error"?(Object.defineProperties(v,{type:{value:"processorerror"}}),y(v)):y(new ErrorEvent(m[0],{...v}))},f.set(y,m[1]))}}return p.call(d,"error",m[1],m[2]),p.call(d,...m)})(d.addEventListener),d.removeEventListener=(p=>(...m)=>{if(m[0]==="processorerror"){const y=f.get(m[1]);y!==void 0&&(f.delete(m[1]),m[1]=y)}return p.call(d,"error",m[1],m[2]),p.call(d,m[0],m[1],m[2])})(d.removeEventListener),u.numberOfOutputs!==0){const p=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(p).connect(s.destination),i(d,()=>p.disconnect(),()=>p.connect(s.destination))}return d}catch(d){throw d.code===11?r():d}if(l===void 0)throw r();return wj(u),t(s,o,l,u)},gP=(e,t)=>e===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t))))),Aj=e=>new Promise((t,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:s})=>{r.close(),i.close(),t(s)},r.onmessageerror=({data:s})=>{r.close(),i.close(),n(s)},i.postMessage(e)}),Ej=async(e,t)=>{const n=await Aj(t);return new e(n)},Tj=(e,t,n,r)=>{let i=DC.get(e);i===void 0&&(i=new WeakMap,DC.set(e,i));const s=Ej(n,r);return i.set(t,s),s},_j=(e,t,n,r,i,s,o,a,c,l,u,d,f)=>(h,p,m,y)=>{if(y.numberOfInputs===0&&y.numberOfOutputs===0)throw c();const g=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(g.some(ce=>ce<1))throw c();if(g.length!==y.numberOfOutputs)throw t();if(y.channelCountMode!=="explicit")throw c();const v=y.channelCount*y.numberOfInputs,S=g.reduce((ce,Ce)=>ce+Ce,0),E=m.parameterDescriptors===void 0?0:m.parameterDescriptors.length;if(v+E>6||S>6)throw c();const k=new MessageChannel,b=[],A=[];for(let ce=0;ce<y.numberOfInputs;ce+=1)b.push(o(h,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),A.push(i(h,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const _=[];if(m.parameterDescriptors!==void 0)for(const{defaultValue:ce,maxValue:Ce,minValue:rt,name:tt}of m.parameterDescriptors){const le=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:y.parameterData[tt]!==void 0?y.parameterData[tt]:ce===void 0?0:ce});Object.defineProperties(le.offset,{defaultValue:{get:()=>ce===void 0?0:ce},maxValue:{get:()=>Ce===void 0?ar:Ce},minValue:{get:()=>rt===void 0?kr:rt}}),_.push(le)}const P=r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+E)}),N=gP(p,h.sampleRate),O=a(h,N,v+E,Math.max(1,S)),D=i(h,{channelCount:Math.max(1,S),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,S)}),U=[];for(let ce=0;ce<y.numberOfOutputs;ce+=1)U.push(r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[ce]}));for(let ce=0;ce<y.numberOfInputs;ce+=1){b[ce].connect(A[ce]);for(let Ce=0;Ce<y.channelCount;Ce+=1)A[ce].connect(P,Ce,ce*y.channelCount+Ce)}const G=new fP(m.parameterDescriptors===void 0?[]:m.parameterDescriptors.map(({name:ce},Ce)=>{const rt=_[Ce];return rt.connect(P,0,v+Ce),rt.start(0),[ce,rt.offset]}));P.connect(O);let z=y.channelInterpretation,$=null;const q=y.numberOfOutputs===0?[O]:U,W={get bufferSize(){return N},get channelCount(){return y.channelCount},set channelCount(ce){throw n()},get channelCountMode(){return y.channelCountMode},set channelCountMode(ce){throw n()},get channelInterpretation(){return z},set channelInterpretation(ce){for(const Ce of b)Ce.channelInterpretation=ce;z=ce},get context(){return O.context},get inputs(){return b},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},get onprocessorerror(){return $},set onprocessorerror(ce){typeof $=="function"&&W.removeEventListener("processorerror",$),$=typeof ce=="function"?ce:null,typeof $=="function"&&W.addEventListener("processorerror",$)},get parameters(){return G},get port(){return k.port2},addEventListener(...ce){return O.addEventListener(ce[0],ce[1],ce[2])},connect:e.bind(null,q),disconnect:l.bind(null,q),dispatchEvent(...ce){return O.dispatchEvent(ce[0])},removeEventListener(...ce){return O.removeEventListener(ce[0],ce[1],ce[2])}},X=new Map;k.port1.addEventListener=(ce=>(...Ce)=>{if(Ce[0]==="message"){const rt=typeof Ce[1]=="function"?Ce[1]:typeof Ce[1]=="object"&&Ce[1]!==null&&typeof Ce[1].handleEvent=="function"?Ce[1].handleEvent:null;if(rt!==null){const tt=X.get(Ce[1]);tt!==void 0?Ce[1]=tt:(Ce[1]=le=>{u(h.currentTime,h.sampleRate,()=>rt(le))},X.set(rt,Ce[1]))}}return ce.call(k.port1,Ce[0],Ce[1],Ce[2])})(k.port1.addEventListener),k.port1.removeEventListener=(ce=>(...Ce)=>{if(Ce[0]==="message"){const rt=X.get(Ce[1]);rt!==void 0&&(X.delete(Ce[1]),Ce[1]=rt)}return ce.call(k.port1,Ce[0],Ce[1],Ce[2])})(k.port1.removeEventListener);let ne=null;Object.defineProperty(k.port1,"onmessage",{get:()=>ne,set:ce=>{typeof ne=="function"&&k.port1.removeEventListener("message",ne),ne=typeof ce=="function"?ce:null,typeof ne=="function"&&(k.port1.addEventListener("message",ne),k.port1.start())}}),m.prototype.port=k.port1;let Z=null;Tj(h,W,m,y).then(ce=>Z=ce);const ke=Qg(y.numberOfInputs,y.channelCount),Ee=Qg(y.numberOfOutputs,g),ge=m.parameterDescriptors===void 0?[]:m.parameterDescriptors.reduce((ce,{name:Ce})=>({...ce,[Ce]:new Float32Array(128)}),{});let Te=!0;const Qe=()=>{y.numberOfOutputs>0&&O.disconnect(D);for(let ce=0,Ce=0;ce<y.numberOfOutputs;ce+=1){const rt=U[ce];for(let tt=0;tt<g[ce];tt+=1)D.disconnect(rt,Ce+tt,tt);Ce+=g[ce]}},ae=new Map;O.onaudioprocess=({inputBuffer:ce,outputBuffer:Ce})=>{if(Z!==null){const rt=d(W);for(let tt=0;tt<N;tt+=128){for(let le=0;le<y.numberOfInputs;le+=1)for(let Fe=0;Fe<y.channelCount;Fe+=1)qg(ce,ke[le],Fe,Fe,tt);m.parameterDescriptors!==void 0&&m.parameterDescriptors.forEach(({name:le},Fe)=>{qg(ce,ge,le,v+Fe,tt)});for(let le=0;le<y.numberOfInputs;le+=1)for(let Fe=0;Fe<g[le];Fe+=1)Ee[le][Fe].byteLength===0&&(Ee[le][Fe]=new Float32Array(128));try{const le=ke.map((Ie,Ze)=>{if(rt[Ze].size>0)return ae.set(Ze,N/128),Ie;const Ht=ae.get(Ze);return Ht===void 0?[]:(Ie.every(Sn=>Sn.every(ul=>ul===0))&&(Ht===1?ae.delete(Ze):ae.set(Ze,Ht-1)),Ie)});Te=u(h.currentTime+tt/h.sampleRate,h.sampleRate,()=>Z.process(le,Ee,ge));for(let Ie=0,Ze=0;Ie<y.numberOfOutputs;Ie+=1){for(let Pe=0;Pe<g[Ie];Pe+=1)hP(Ce,Ee[Ie],Pe,Ze+Pe,tt);Ze+=g[Ie]}}catch(le){Te=!1,W.dispatchEvent(new ErrorEvent("processorerror",{colno:le.colno,filename:le.filename,lineno:le.lineno,message:le.message}))}if(!Te){for(let le=0;le<y.numberOfInputs;le+=1){b[le].disconnect(A[le]);for(let Fe=0;Fe<y.channelCount;Fe+=1)A[tt].disconnect(P,Fe,le*y.channelCount+Fe)}if(m.parameterDescriptors!==void 0){const le=m.parameterDescriptors.length;for(let Fe=0;Fe<le;Fe+=1){const Ie=_[Fe];Ie.disconnect(P,0,v+Fe),Ie.stop()}}P.disconnect(O),O.onaudioprocess=null,rn?Qe():cn();break}}}};let rn=!1;const In=o(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Ct=()=>O.connect(In).connect(h.destination),cn=()=>{O.disconnect(In),In.disconnect()},dt=()=>{if(Te){cn(),y.numberOfOutputs>0&&O.connect(D);for(let ce=0,Ce=0;ce<y.numberOfOutputs;ce+=1){const rt=U[ce];for(let tt=0;tt<g[ce];tt+=1)D.connect(rt,Ce+tt,tt);Ce+=g[ce]}}rn=!0},Ut=()=>{Te&&(Ct(),Qe()),rn=!1};return Ct(),f(W,dt,Ut)},mP=(e,t)=>{const n=e.createBiquadFilter();return Cn(n,t),Kt(n,t,"Q"),Kt(n,t,"detune"),Kt(n,t,"frequency"),Kt(n,t,"gain"),Bt(n,t,"type"),n},Rj=(e,t)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return e!==null&&e.name==="webkitAudioContext"&&t(n,i),Cn(i,r),i},xj=e=>{const t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>t,set:n=>{if(n!==t)throw Un()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw Un()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw Un()}})},Ih=(e,t)=>{const n=e.createChannelSplitter(t.numberOfOutputs);return Cn(n,t),xj(n),n},Nj=(e,t,n,r,i)=>(s,o)=>{if(s.createConstantSource===void 0)return n(s,o);const a=s.createConstantSource();return Cn(a,o),Kt(a,o,"offset"),t(r,()=>r(s))||_b(a),t(i,()=>i(s))||Rb(a),e(s,a),a},Xu=(e,t)=>(e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e),Pj=(e,t,n,r)=>(i,{offset:s,...o})=>{const a=i.createBuffer(1,2,44100),c=t(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(i,{...o,gain:s}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const d={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(p){l.channelCount=p},get channelCountMode(){return l.channelCountMode},set channelCountMode(p){l.channelCountMode=p},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(p){l.channelInterpretation=p},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(p){c.onended=p},addEventListener(...p){return c.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return c.dispatchEvent(p[0])},removeEventListener(...p){return c.removeEventListener(p[0],p[1],p[2])},start(p=0){c.start.call(c,p)},stop(p=0){c.stop.call(c,p)}},f=()=>c.connect(l),h=()=>c.disconnect(l);return e(i,c),r(Xu(d,l),f,h)},Mj=(e,t)=>(n,r)=>{const i=n.createConvolver();if(Cn(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),Bt(i,r,"buffer"),r.channelCount>2||(t(i,"channelCount",s=>()=>s.call(i),s=>o=>{if(o>2)throw e();return s.call(i,o)}),r.channelCountMode==="max"))throw e();return t(i,"channelCountMode",s=>()=>s.call(i),s=>o=>{if(o==="max")throw e();return s.call(i,o)}),i},vP=(e,t)=>{const n=e.createDelay(t.maxDelayTime);return Cn(n,t),Kt(n,t,"delayTime"),n},Oj=e=>(t,n)=>{const r=t.createDynamicsCompressor();if(Cn(r,n),n.channelCount>2||n.channelCountMode==="max")throw e();return Kt(r,n,"attack"),Kt(r,n,"knee"),Kt(r,n,"ratio"),Kt(r,n,"release"),Kt(r,n,"threshold"),r},Mr=(e,t)=>{const n=e.createGain();return Cn(n,t),Kt(n,t,"gain"),n},Dj=e=>(t,n,r)=>{if(t.createIIRFilter===void 0)return e(t,n,r);const i=t.createIIRFilter(r.feedforward,r.feedback);return Cn(i,r),i};function Lj(e,t){const n=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/n,(e[1]*t[0]-e[0]*t[1])/n]}function Bj(e,t){return[e[0]*t[0]-e[1]*t[1],e[0]*t[1]+e[1]*t[0]]}function B1(e,t){let n=[0,0];for(let r=e.length-1;r>=0;r-=1)n=Bj(n,t),n[0]+=e[r];return n}const Fj=(e,t,n,r)=>(i,s,{channelCount:o,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const d=gP(s,i.sampleRate),f=l instanceof Float64Array?l:new Float64Array(l),h=u instanceof Float64Array?u:new Float64Array(u),p=f.length,m=h.length,y=Math.min(p,m);if(p===0||p>20)throw r();if(f[0]===0)throw t();if(m===0||m>20)throw r();if(h[0]===0)throw t();if(f[0]!==1){for(let _=0;_<m;_+=1)h[_]/=f[0];for(let _=1;_<p;_+=1)f[_]/=f[0]}const g=n(i,d,o,o);g.channelCount=o,g.channelCountMode=a,g.channelInterpretation=c;const v=32,S=[],E=[],k=[];for(let _=0;_<o;_+=1){S.push(0);const P=new Float32Array(v),N=new Float32Array(v);P.fill(0),N.fill(0),E.push(P),k.push(N)}g.onaudioprocess=_=>{const P=_.inputBuffer,N=_.outputBuffer,O=P.numberOfChannels;for(let D=0;D<O;D+=1){const U=P.getChannelData(D),G=N.getChannelData(D);S[D]=pP(f,p,h,m,y,E[D],k[D],S[D],v,U,G)}};const b=i.sampleRate/2;return Xu({get bufferSize(){return d},get channelCount(){return g.channelCount},set channelCount(_){g.channelCount=_},get channelCountMode(){return g.channelCountMode},set channelCountMode(_){g.channelCountMode=_},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(_){g.channelInterpretation=_},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener(..._){return g.addEventListener(_[0],_[1],_[2])},dispatchEvent(..._){return g.dispatchEvent(_[0])},getFrequencyResponse(_,P,N){if(_.length!==P.length||P.length!==N.length)throw e();const O=_.length;for(let D=0;D<O;D+=1){const U=-Math.PI*(_[D]/b),G=[Math.cos(U),Math.sin(U)],z=B1(h,G),$=B1(f,G),q=Lj(z,$);P[D]=Math.sqrt(q[0]*q[0]+q[1]*q[1]),N[D]=Math.atan2(q[1],q[0])}},removeEventListener(..._){return g.removeEventListener(_[0],_[1],_[2])}},g)},Uj=(e,t)=>e.createMediaElementSource(t.mediaElement),Vj=(e,t)=>{const n=e.createMediaStreamDestination();return Cn(n,t),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},Gj=(e,{mediaStream:t})=>{const n=t.getAudioTracks();n.sort((s,o)=>s.id<o.id?-1:s.id>o.id?1:0);const r=n.slice(0,1),i=e.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:t}),i},Wj=(e,t)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),s=n.createMediaStreamSource(i);if(r.kind!=="audio")throw e();if(t(n))throw new TypeError;return s},jj=e=>e===null?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null,Hj=(e,t,n,r,i,s)=>(o,a)=>{const c=o.createOscillator();return Cn(c,a),Kt(c,a,"detune"),Kt(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):Bt(c,a,"type"),t(n,()=>n(o))||_b(c),t(r,()=>r(o))||s(c,o),t(i,()=>i(o))||Rb(c),e(o,c),c},$j=e=>(t,n)=>{const r=t.createPanner();return r.orientationX===void 0?e(t,n):(Cn(r,n),Kt(r,n,"orientationX"),Kt(r,n,"orientationY"),Kt(r,n,"orientationZ"),Kt(r,n,"positionX"),Kt(r,n,"positionY"),Kt(r,n,"positionZ"),Bt(r,n,"coneInnerAngle"),Bt(r,n,"coneOuterAngle"),Bt(r,n,"coneOuterGain"),Bt(r,n,"distanceModel"),Bt(r,n,"maxDistance"),Bt(r,n,"panningModel"),Bt(r,n,"refDistance"),Bt(r,n,"rolloffFactor"),r)},zj=(e,t,n,r,i,s,o,a,c,l)=>(u,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:h,distanceModel:p,maxDistance:m,orientationX:y,orientationY:g,orientationZ:v,panningModel:S,positionX:E,positionY:k,positionZ:b,refDistance:A,rolloffFactor:_,...P})=>{const N=u.createPanner();if(P.channelCount>2||P.channelCountMode==="max")throw o();Cn(N,P);const O={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},D=n(u,{...O,channelInterpretation:"speakers",numberOfInputs:6}),U=r(u,{...P,gain:1}),G=r(u,{...O,gain:1}),z=r(u,{...O,gain:0}),$=r(u,{...O,gain:0}),q=r(u,{...O,gain:0}),W=r(u,{...O,gain:0}),X=r(u,{...O,gain:0}),ne=i(u,256,6,1),Z=s(u,{...O,curve:new Float32Array([1,1]),oversample:"none"});let ie=[y,g,v],ke=[E,k,b];const Ee=new Float32Array(1);ne.onaudioprocess=({inputBuffer:ae})=>{const rn=[c(ae,Ee,0),c(ae,Ee,1),c(ae,Ee,2)];rn.some((Ct,cn)=>Ct!==ie[cn])&&(N.setOrientation(...rn),ie=rn);const In=[c(ae,Ee,3),c(ae,Ee,4),c(ae,Ee,5)];In.some((Ct,cn)=>Ct!==ke[cn])&&(N.setPosition(...In),ke=In)},Object.defineProperty(z.gain,"defaultValue",{get:()=>0}),Object.defineProperty($.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(W.gain,"defaultValue",{get:()=>0}),Object.defineProperty(X.gain,"defaultValue",{get:()=>0});const ge={get bufferSize(){},get channelCount(){return N.channelCount},set channelCount(ae){if(ae>2)throw o();U.channelCount=ae,N.channelCount=ae},get channelCountMode(){return N.channelCountMode},set channelCountMode(ae){if(ae==="max")throw o();U.channelCountMode=ae,N.channelCountMode=ae},get channelInterpretation(){return N.channelInterpretation},set channelInterpretation(ae){U.channelInterpretation=ae,N.channelInterpretation=ae},get coneInnerAngle(){return N.coneInnerAngle},set coneInnerAngle(ae){N.coneInnerAngle=ae},get coneOuterAngle(){return N.coneOuterAngle},set coneOuterAngle(ae){N.coneOuterAngle=ae},get coneOuterGain(){return N.coneOuterGain},set coneOuterGain(ae){if(ae<0||ae>1)throw t();N.coneOuterGain=ae},get context(){return N.context},get distanceModel(){return N.distanceModel},set distanceModel(ae){N.distanceModel=ae},get inputs(){return[U]},get maxDistance(){return N.maxDistance},set maxDistance(ae){if(ae<0)throw new RangeError;N.maxDistance=ae},get numberOfInputs(){return N.numberOfInputs},get numberOfOutputs(){return N.numberOfOutputs},get orientationX(){return G.gain},get orientationY(){return z.gain},get orientationZ(){return $.gain},get panningModel(){return N.panningModel},set panningModel(ae){N.panningModel=ae},get positionX(){return q.gain},get positionY(){return W.gain},get positionZ(){return X.gain},get refDistance(){return N.refDistance},set refDistance(ae){if(ae<0)throw new RangeError;N.refDistance=ae},get rolloffFactor(){return N.rolloffFactor},set rolloffFactor(ae){if(ae<0)throw new RangeError;N.rolloffFactor=ae},addEventListener(...ae){return U.addEventListener(ae[0],ae[1],ae[2])},dispatchEvent(...ae){return U.dispatchEvent(ae[0])},removeEventListener(...ae){return U.removeEventListener(ae[0],ae[1],ae[2])}};d!==ge.coneInnerAngle&&(ge.coneInnerAngle=d),f!==ge.coneOuterAngle&&(ge.coneOuterAngle=f),h!==ge.coneOuterGain&&(ge.coneOuterGain=h),p!==ge.distanceModel&&(ge.distanceModel=p),m!==ge.maxDistance&&(ge.maxDistance=m),y!==ge.orientationX.value&&(ge.orientationX.value=y),g!==ge.orientationY.value&&(ge.orientationY.value=g),v!==ge.orientationZ.value&&(ge.orientationZ.value=v),S!==ge.panningModel&&(ge.panningModel=S),E!==ge.positionX.value&&(ge.positionX.value=E),k!==ge.positionY.value&&(ge.positionY.value=k),b!==ge.positionZ.value&&(ge.positionZ.value=b),A!==ge.refDistance&&(ge.refDistance=A),_!==ge.rolloffFactor&&(ge.rolloffFactor=_),(ie[0]!==1||ie[1]!==0||ie[2]!==0)&&N.setOrientation(...ie),(ke[0]!==0||ke[1]!==0||ke[2]!==0)&&N.setPosition(...ke);const Te=()=>{U.connect(N),e(U,Z,0,0),Z.connect(G).connect(D,0,0),Z.connect(z).connect(D,0,1),Z.connect($).connect(D,0,2),Z.connect(q).connect(D,0,3),Z.connect(W).connect(D,0,4),Z.connect(X).connect(D,0,5),D.connect(ne).connect(u.destination)},Qe=()=>{U.disconnect(N),a(U,Z,0,0),Z.disconnect(G),G.disconnect(D),Z.disconnect(z),z.disconnect(D),Z.disconnect($),$.disconnect(D),Z.disconnect(q),q.disconnect(D),Z.disconnect(W),W.disconnect(D),Z.disconnect(X),X.disconnect(D),D.disconnect(ne),ne.disconnect(u.destination)};return l(Xu(ge,N),Te,Qe)},Zj=e=>(t,{disableNormalization:n,imag:r,real:i})=>{const s=r instanceof Float32Array?r:new Float32Array(r),o=i instanceof Float32Array?i:new Float32Array(i),a=t.createPeriodicWave(o,s,{disableNormalization:n});if(Array.from(r).length<2)throw e();return a},Sh=(e,t,n,r)=>e.createScriptProcessor(t,n,r),Xj=(e,t)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw t();if(n.createStereoPanner===void 0)return e(n,r);const s=n.createStereoPanner();return Cn(s,r),Kt(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:o=>{if(o!==i)throw t()}}),s},Kj=(e,t,n,r,i,s)=>{const a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},d=(p,m,y,g)=>{const v=new Float32Array(16385),S=new Float32Array(16385);for(let P=0;P<16385;P+=1){const N=P/16384*c;v[P]=Math.cos(N),S[P]=Math.sin(N)}const E=n(p,{...l,gain:0}),k=r(p,{...u,curve:v}),b=r(p,{...u,curve:a}),A=n(p,{...l,gain:0}),_=r(p,{...u,curve:S});return{connectGraph(){m.connect(E),m.connect(b.inputs===void 0?b:b.inputs[0]),m.connect(A),b.connect(y),y.connect(k.inputs===void 0?k:k.inputs[0]),y.connect(_.inputs===void 0?_:_.inputs[0]),k.connect(E.gain),_.connect(A.gain),E.connect(g,0,0),A.connect(g,0,1)},disconnectGraph(){m.disconnect(E),m.disconnect(b.inputs===void 0?b:b.inputs[0]),m.disconnect(A),b.disconnect(y),y.disconnect(k.inputs===void 0?k:k.inputs[0]),y.disconnect(_.inputs===void 0?_:_.inputs[0]),k.disconnect(E.gain),_.disconnect(A.gain),E.disconnect(g,0,0),A.disconnect(g,0,1)}}},f=(p,m,y,g)=>{const v=new Float32Array(16385),S=new Float32Array(16385),E=new Float32Array(16385),k=new Float32Array(16385),b=Math.floor(16385/2);for(let q=0;q<16385;q+=1)if(q>b){const W=(q-b)/(16384-b)*c;v[q]=Math.cos(W),S[q]=Math.sin(W),E[q]=0,k[q]=1}else{const W=q/(16384-b)*c;v[q]=1,S[q]=0,E[q]=Math.cos(W),k[q]=Math.sin(W)}const A=t(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),_=n(p,{...l,gain:0}),P=r(p,{...u,curve:v}),N=n(p,{...l,gain:0}),O=r(p,{...u,curve:S}),D=r(p,{...u,curve:a}),U=n(p,{...l,gain:0}),G=r(p,{...u,curve:E}),z=n(p,{...l,gain:0}),$=r(p,{...u,curve:k});return{connectGraph(){m.connect(A),m.connect(D.inputs===void 0?D:D.inputs[0]),A.connect(_,0),A.connect(N,0),A.connect(U,1),A.connect(z,1),D.connect(y),y.connect(P.inputs===void 0?P:P.inputs[0]),y.connect(O.inputs===void 0?O:O.inputs[0]),y.connect(G.inputs===void 0?G:G.inputs[0]),y.connect($.inputs===void 0?$:$.inputs[0]),P.connect(_.gain),O.connect(N.gain),G.connect(U.gain),$.connect(z.gain),_.connect(g,0,0),U.connect(g,0,0),N.connect(g,0,1),z.connect(g,0,1)},disconnectGraph(){m.disconnect(A),m.disconnect(D.inputs===void 0?D:D.inputs[0]),A.disconnect(_,0),A.disconnect(N,0),A.disconnect(U,1),A.disconnect(z,1),D.disconnect(y),y.disconnect(P.inputs===void 0?P:P.inputs[0]),y.disconnect(O.inputs===void 0?O:O.inputs[0]),y.disconnect(G.inputs===void 0?G:G.inputs[0]),y.disconnect($.inputs===void 0?$:$.inputs[0]),P.disconnect(_.gain),O.disconnect(N.gain),G.disconnect(U.gain),$.disconnect(z.gain),_.disconnect(g,0,0),U.disconnect(g,0,0),N.disconnect(g,0,1),z.disconnect(g,0,1)}}},h=(p,m,y,g,v)=>{if(m===1)return d(p,y,g,v);if(m===2)return f(p,y,g,v);throw i()};return(p,{channelCount:m,channelCountMode:y,pan:g,...v})=>{if(y==="max")throw i();const S=e(p,{...v,channelCount:1,channelCountMode:y,numberOfInputs:2}),E=n(p,{...v,channelCount:m,channelCountMode:y,gain:1}),k=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:g});let{connectGraph:b,disconnectGraph:A}=h(p,m,E,k,S);Object.defineProperty(k.gain,"defaultValue",{get:()=>0}),Object.defineProperty(k.gain,"maxValue",{get:()=>1}),Object.defineProperty(k.gain,"minValue",{get:()=>-1});const _={get bufferSize(){},get channelCount(){return E.channelCount},set channelCount(D){E.channelCount!==D&&(P&&A(),{connectGraph:b,disconnectGraph:A}=h(p,D,E,k,S),P&&b()),E.channelCount=D},get channelCountMode(){return E.channelCountMode},set channelCountMode(D){if(D==="clamped-max"||D==="max")throw i();E.channelCountMode=D},get channelInterpretation(){return E.channelInterpretation},set channelInterpretation(D){E.channelInterpretation=D},get context(){return E.context},get inputs(){return[E]},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get pan(){return k.gain},addEventListener(...D){return E.addEventListener(D[0],D[1],D[2])},dispatchEvent(...D){return E.dispatchEvent(D[0])},removeEventListener(...D){return E.removeEventListener(D[0],D[1],D[2])}};let P=!1;const N=()=>{b(),P=!0},O=()=>{A(),P=!1};return s(Xu(_,S),N,O)}},Jj=(e,t,n,r,i,s,o)=>(a,c)=>{const l=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,c);Cn(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw t();Bt(l,{curve:u},"curve"),Bt(l,c,"oversample");let d=null,f=!1;return o(l,"curve",m=>()=>m.call(l),m=>y=>(m.call(l,y),f&&(r(y)&&d===null?d=e(a,l):!r(y)&&d!==null&&(d(),d=null)),y)),i(l,()=>{f=!0,r(l.curve)&&(d=e(a,l))},()=>{f=!1,d!==null&&(d(),d=null)})},Yj=(e,t,n,r,i)=>(s,{curve:o,oversample:a,...c})=>{const l=s.createWaveShaper(),u=s.createWaveShaper();Cn(l,c),Cn(u,c);const d=n(s,{...c,gain:1}),f=n(s,{...c,gain:-1}),h=n(s,{...c,gain:1}),p=n(s,{...c,gain:-1});let m=null,y=!1,g=null;const v={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(k){d.channelCount=k,f.channelCount=k,l.channelCount=k,h.channelCount=k,u.channelCount=k,p.channelCount=k},get channelCountMode(){return l.channelCountMode},set channelCountMode(k){d.channelCountMode=k,f.channelCountMode=k,l.channelCountMode=k,h.channelCountMode=k,u.channelCountMode=k,p.channelCountMode=k},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(k){d.channelInterpretation=k,f.channelInterpretation=k,l.channelInterpretation=k,h.channelInterpretation=k,u.channelInterpretation=k,p.channelInterpretation=k},get context(){return l.context},get curve(){return g},set curve(k){if(k!==null&&k.length<2)throw t();if(k===null)l.curve=k,u.curve=k;else{const b=k.length,A=new Float32Array(b+2-b%2),_=new Float32Array(b+2-b%2);A[0]=k[0],_[0]=-k[b-1];const P=Math.ceil((b+1)/2),N=(b+1)/2-1;for(let O=1;O<P;O+=1){const D=O/P*N,U=Math.floor(D),G=Math.ceil(D);A[O]=U===G?k[U]:(1-(D-U))*k[U]+(1-(G-D))*k[G],_[O]=U===G?-k[b-1-U]:-((1-(D-U))*k[b-1-U])-(1-(G-D))*k[b-1-G]}A[P]=b%2===1?k[P-1]:(k[P-2]+k[P-1])/2,l.curve=A,u.curve=_}g=k,y&&(r(g)&&m===null?m=e(s,d):m!==null&&(m(),m=null))},get inputs(){return[d]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(k){l.oversample=k,u.oversample=k},addEventListener(...k){return d.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return d.dispatchEvent(k[0])},removeEventListener(...k){return d.removeEventListener(k[0],k[1],k[2])}};o!==null&&(v.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==v.oversample&&(v.oversample=a);const S=()=>{d.connect(l).connect(h),d.connect(f).connect(u).connect(p).connect(h),y=!0,r(g)&&(m=e(s,d))},E=()=>{d.disconnect(l),l.disconnect(h),d.disconnect(f),f.disconnect(u),u.disconnect(p),p.disconnect(h),y=!1,m!==null&&(m(),m=null)};return i(Xu(v,h),S,E)},Or=()=>new DOMException("","NotSupportedError"),qj={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Qj=(e,t,n,r,i,s,o)=>class extends e{constructor(c,l){const u=i(c),d={...qj,...l},f=n(u,d),h=s(u),p=h?r():null,m=c.sampleRate/2;super(c,!1,f,p),this._detune=t(this,h,f.detune,153600,-153600),this._frequency=t(this,h,f.frequency,m,-m),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){_u(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),Po(this)&&vh(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},e6=(e,t,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null,c=null;const l=async(u,d)=>{let f=n(u);const h=tr(f,d);if(!h){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:o===null?void 0:o,type:f.type};f=t(d,p),a!==null&&f.start(a),c!==null&&f.stop(c)}return s.set(d,f),h?(await e(d,u.detune,f.detune),await e(d,u.frequency,f.frequency)):(await r(d,u.detune,f.detune),await r(d,u.frequency,f.frequency)),await i(u,d,f),f};return{set periodicWave(u){o=u},set start(u){a=u},set stop(u){c=u},render(u,d){const f=s.get(d);return f!==void 0?Promise.resolve(f):l(u,d)}}},t6={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},n6=(e,t,n,r,i,s,o)=>class extends e{constructor(c,l){const u=i(c),d={...t6,...l},f=n(u,d),h=s(u),p=h?r():null;super(c,!1,f,p),this._nativePannerNode=f,this._orientationX=t(this,h,f.orientationX,ar,kr),this._orientationY=t(this,h,f.orientationY,ar,kr),this._orientationZ=t(this,h,f.orientationZ,ar,kr),this._positionX=t(this,h,f.positionX,ar,kr),this._positionY=t(this,h,f.positionY,ar,kr),this._positionZ=t(this,h,f.positionZ,ar,kr),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},r6=(e,t,n,r,i,s,o,a,c,l)=>()=>{const u=new WeakMap;let d=null;const f=async(h,p)=>{let m=null,y=s(h);const g={channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation},v={...g,coneInnerAngle:y.coneInnerAngle,coneOuterAngle:y.coneOuterAngle,coneOuterGain:y.coneOuterGain,distanceModel:y.distanceModel,maxDistance:y.maxDistance,panningModel:y.panningModel,refDistance:y.refDistance,rolloffFactor:y.rolloffFactor},S=tr(y,p);if("bufferSize"in y)m=r(p,{...g,gain:1});else if(!S){const E={...v,orientationX:y.orientationX.value,orientationY:y.orientationY.value,orientationZ:y.orientationZ.value,positionX:y.positionX.value,positionY:y.positionY.value,positionZ:y.positionZ.value};y=i(p,E)}if(u.set(p,m===null?y:m),m!==null){if(d===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const O=new o(6,h.context.length,p.sampleRate),D=t(O,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});D.connect(O.destination),d=(async()=>{const U=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map(async(G,z)=>{const $=n(O,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:z===0?1:0});return await a(O,G,$.offset),$}));for(let G=0;G<6;G+=1)U[G].connect(D,0,G),U[G].start(0);return l(O)})()}const E=await d,k=r(p,{...g,gain:1});await c(h,p,k);const b=[];for(let O=0;O<E.numberOfChannels;O+=1)b.push(E.getChannelData(O));let A=[b[0][0],b[1][0],b[2][0]],_=[b[3][0],b[4][0],b[5][0]],P=r(p,{...g,gain:1}),N=i(p,{...v,orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:_[0],positionY:_[1],positionZ:_[2]});k.connect(P).connect(N.inputs[0]),N.connect(m);for(let O=128;O<E.length;O+=128){const D=[b[0][O],b[1][O],b[2][O]],U=[b[3][O],b[4][O],b[5][O]];if(D.some((G,z)=>G!==A[z])||U.some((G,z)=>G!==_[z])){A=D,_=U;const G=O/p.sampleRate;P.gain.setValueAtTime(0,G),P=r(p,{...g,gain:0}),N=i(p,{...v,orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:_[0],positionY:_[1],positionZ:_[2]}),P.gain.setValueAtTime(1,G),k.connect(P).connect(N.inputs[0]),N.connect(m)}}return m}return S?(await e(p,h.orientationX,y.orientationX),await e(p,h.orientationY,y.orientationY),await e(p,h.orientationZ,y.orientationZ),await e(p,h.positionX,y.positionX),await e(p,h.positionY,y.positionY),await e(p,h.positionZ,y.positionZ)):(await a(p,h.orientationX,y.orientationX),await a(p,h.orientationY,y.orientationY),await a(p,h.orientationZ,y.orientationZ),await a(p,h.positionX,y.positionX),await a(p,h.positionY,y.positionY),await a(p,h.positionZ,y.positionZ)),Zu(y)?await c(h,p,y.inputs[0]):await c(h,p,y),y};return{render(h,p){const m=u.get(p);return m!==void 0?Promise.resolve(m):f(h,p)}}},i6={disableNormalization:!1},s6=(e,t,n,r)=>class yP{constructor(s,o){const a=t(s),c=r({...i6,...o}),l=e(a,c);return n.add(l),l}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===yP.prototype||n.has(s)}},o6=(e,t)=>(n,r,i)=>(e(r).replay(i),t(r,n,i)),a6=(e,t,n)=>async(r,i,s)=>{const o=e(r);await Promise.all(o.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{const f=await t(l).render(l,i),h=r.context.destination;!n(l)&&(r!==h||!n(r))&&f.connect(s,u,c)})).reduce((a,c)=>[...a,...c],[]))},c6=(e,t,n)=>async(r,i,s)=>{const o=t(r);await Promise.all(Array.from(o.activeInputs).map(async([a,c])=>{const u=await e(a).render(a,i);n(a)||u.connect(s,c)}))},l6=(e,t,n,r)=>i=>e(UC,()=>UC(i))?Promise.resolve(e(r,r)).then(s=>{if(!s){const o=n(i,512,0,1);i.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>i.currentTime,o.connect(i.destination)}return i.startRendering()}):new Promise(s=>{const o=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{o.disconnect(),s(a.renderedBuffer)},o.connect(i.destination),i.startRendering()}),u6=e=>(t,n)=>{e.set(t,n)},d6=e=>(t,n)=>e.set(t,n),f6={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},h6=(e,t,n,r,i,s)=>class extends e{constructor(a,c){const l=i(a),u={...f6,...c},d=n(l,u),f=s(l),h=f?r():null;super(a,!1,d,h),this._pan=t(this,f,d.pan)}get pan(){return this._pan}},p6=(e,t,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let l=n(a);const u=tr(l,c);if(!u){const d={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=t(c,d)}return s.set(c,l),u?await e(c,a.pan,l.pan):await r(c,a.pan,l.pan),Zu(l)?await i(a,c,l.inputs[0]):await i(a,c,l),l};return{render(a,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},g6=e=>()=>{if(e===null)return!1;try{new e({length:1,sampleRate:44100})}catch{return!1}return!0},m6=(e,t)=>async()=>{if(e===null)return!0;if(t===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new t(1,128,44100),i=URL.createObjectURL(n);let s=!1,o=!1;try{await r.audioWorklet.addModule(i);const a=new e(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>o=!0,c.connect(a),c.start(0),await r.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(i)}return s&&!o},v6=(e,t)=>()=>{if(t===null)return Promise.resolve(!1);const n=new t(1,1,44100),r=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},y6=()=>new DOMException("","UnknownError"),C6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},I6=(e,t,n,r,i,s,o)=>class extends e{constructor(c,l){const u=i(c),d={...C6,...l},f=n(u,d),p=s(u)?r():null;super(c,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},S6=(e,t,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=t(s);if(!tr(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=e(o,l)}return r.set(o,a),Zu(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},b6=()=>typeof window>"u"?null:window,w6=(e,t)=>n=>{n.copyFromChannel=(r,i,s=0)=>{const o=e(s),a=e(i);if(a>=n.numberOfChannels)throw t();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=o<0?-o:0;d+o<c&&d<u;d+=1)r[d]=l[d+o]},n.copyToChannel=(r,i,s=0)=>{const o=e(s),a=e(i);if(a>=n.numberOfChannels)throw t();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=o<0?-o:0;d+o<c&&d<u;d+=1)l[d+o]=r[d]}},k6=e=>t=>{t.copyFromChannel=(n=>(r,i,s=0)=>{const o=e(s),a=e(i);if(o<t.length)return n.call(t,r,a,o)})(t.copyFromChannel),t.copyToChannel=(n=>(r,i,s=0)=>{const o=e(s),a=e(i);if(o<t.length)return n.call(t,r,a,o)})(t.copyToChannel)},A6=e=>(t,n)=>{const r=n.createBuffer(1,1,44100);t.buffer===null&&(t.buffer=r),e(t,"buffer",i=>()=>{const s=i.call(t);return s===r?null:s},i=>s=>i.call(t,s===null?r:s))},E6=(e,t)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});const i=n.createBufferSource();t(r,()=>{const a=r.numberOfInputs;for(let c=0;c<a;c+=1)i.connect(r,0,c)},()=>i.disconnect(r))},CP=(e,t,n)=>e.copyFromChannel===void 0?e.getChannelData(n)[0]:(e.copyFromChannel(t,n),t[0]),IP=e=>{if(e===null)return!1;const t=e.length;return t%2!==0?e[Math.floor(t/2)]!==0:e[t/2-1]+e[t/2]!==0},bh=(e,t,n,r)=>{let i=e;for(;!i.hasOwnProperty(t);)i=Object.getPrototypeOf(i);const{get:s,set:o}=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,{get:n(s),set:r(o)})},T6=e=>({...e,outputChannelCount:e.outputChannelCount!==void 0?e.outputChannelCount:e.numberOfInputs===1&&e.numberOfOutputs===1?[e.channelCount]:Array.from({length:e.numberOfOutputs},()=>1)}),_6=e=>({...e,channelCount:e.numberOfOutputs}),R6=e=>{const{imag:t,real:n}=e;return t===void 0?n===void 0?{...e,imag:[0,0],real:[0,0]}:{...e,imag:Array.from(n,()=>0),real:n}:n===void 0?{...e,imag:t,real:Array.from(t,()=>0)}:{...e,imag:t,real:n}},SP=(e,t,n)=>{try{e.setValueAtTime(t,n)}catch(r){if(r.code!==9)throw r;SP(e,t,n+1e-7)}},x6=e=>{const t=e.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},N6=e=>{const t=e.createBufferSource(),n=e.createBuffer(1,1,44100);t.buffer=n;try{t.start(0,1)}catch{return!1}return!0},P6=e=>{const t=e.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},xb=e=>{const t=e.createOscillator();try{t.start(-1)}catch(n){return n instanceof RangeError}return!1},bP=e=>{const t=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=t,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},Nb=e=>{const t=e.createOscillator();try{t.stop(-1)}catch(n){return n instanceof RangeError}return!1},M6=e=>{const{port1:t,port2:n}=new MessageChannel;try{t.postMessage(e)}finally{t.close(),n.close()}},O6=e=>{e.start=(t=>(n=0,r=0,i)=>{const s=e.buffer,o=s===null?r:Math.min(s.duration,r);s!==null&&o>s.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,o,i)})(e.start)},wP=(e,t)=>{const n=t.createGain();e.connect(n);const r=(i=>()=>{i.call(e,n),e.removeEventListener("ended",r)})(e.disconnect);e.addEventListener("ended",r),Xu(e,n),e.stop=(i=>{let s=!1;return(o=0)=>{if(s)try{i.call(e,o)}catch{n.gain.setValueAtTime(0,o)}else i.call(e,o),s=!0}})(e.stop)},Ku=(e,t)=>n=>{const r={value:e};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof t=="function"?t.call(e,n):t.handleEvent.call(e,n)},D6=cG(nl),L6=pG(nl),B6=EW(nv),kP=new WeakMap,F6=HW(kP),Jo=rW(new Map,new WeakMap),Vs=b6(),AP=mj(Jo,js),EP=jW(dr),zn=a6(dr,EP,Gc),U6=CG(AP,Dt,zn),_t=ZW(nP),tc=jj(Vs),yt=oj(tc),TP=new WeakMap,_P=LW(Ku),wh=Ij(Vs),RP=nj(wh),xP=rj(Vs),V6=ij(Vs),Uf=bj(Vs),nn=$G(lG(qN),hG(D6,L6,Kg,B6,Jg,dr,F6,mh,Dt,nl,Po,Gc,$p),Jo,tj(MC,Jg,dr,Dt,Ff,Po),js,rv,Or,bW(Kg,MC,dr,Dt,Ff,_t,Po,yt),RW(TP,dr,Yi),_P,_t,RP,xP,V6,yt,Uf),G6=yG(nn,U6,js,AP,_t,yt),NP=new WeakSet,F1=vj(Vs),PP=mW(new Uint32Array(1)),MP=w6(PP,js),OP=k6(PP),W6=SG(NP,Jo,Or,F1,tc,g6(F1),MP,OP),iv=gG(Mr),DP=c6(EP,yh,Gc),Hs=uW(DP),Ju=Cj(iv,Jo,x6,N6,P6,xb,bP,Nb,O6,A6(bh),wP),$s=o6($W(yh),DP),j6=kG(Hs,Ju,Dt,$s,zn),es=zG(uG(eP),TP,tP,ZG,nG,rG,iG,sG,oG,xC,JN,wh,SP),H6=wG(nn,j6,es,Un,Ju,_t,yt,Ku),$6=OG(nn,DG,js,Un,Sj(Mr,bh),_t,yt,zn),z6=nW(Hs,mP,Dt,$s,zn),rl=d6(kP),Z6=tW(nn,es,z6,rv,mP,_t,yt,rl),nc=pj(nl,xP),X6=E6(Un,nc),rc=Rj(wh,X6),K6=oW(rc,Dt,zn),J6=sW(nn,K6,rc,_t,yt),Y6=lW(Ih,Dt,zn),q6=cW(nn,Y6,Ih,_t,yt,_6),Q6=Pj(iv,Ju,Mr,nc),Yu=Nj(iv,Jo,Q6,xb,Nb),e9=gW(Hs,Yu,Dt,$s,zn),t9=pW(nn,es,e9,Yu,_t,yt,Ku),LP=Mj(Or,bh),n9=CW(LP,Dt,zn),r9=yW(nn,n9,LP,_t,yt,rl),i9=AW(Hs,vP,Dt,$s,zn),s9=kW(nn,es,i9,vP,_t,yt,rl),BP=Oj(Or),o9=MW(Hs,BP,Dt,$s,zn),a9=PW(nn,es,o9,BP,Or,_t,yt,rl),c9=GW(Hs,Mr,Dt,$s,zn),l9=VW(nn,es,c9,Mr,_t,yt),u9=Fj(rv,Un,Sh,Or),Pb=l6(Jo,Mr,Sh,v6(Mr,tc)),d9=ej(Ju,Dt,tc,zn,Pb),f9=Dj(u9),h9=qW(nn,f9,d9,_t,yt,rl),p9=LG(es,rc,Yu,Sh,Or,CP,yt,bh),FP=new WeakMap,g9=hj($6,p9,_P,yt,FP,Ku),UP=Hj(iv,Jo,xb,bP,Nb,wP),m9=e6(Hs,UP,Dt,$s,zn),v9=Qj(nn,es,UP,m9,_t,yt,Ku),VP=fW(Ju),y9=Yj(VP,Un,Mr,IP,nc),sv=Jj(VP,Un,y9,IP,nc,wh,bh),C9=zj(Kg,Un,rc,Mr,Sh,sv,Or,Jg,CP,nc),GP=$j(C9),I9=r6(Hs,rc,Yu,Mr,GP,Dt,tc,$s,zn,Pb),S9=n6(nn,es,GP,I9,_t,yt,rl),b9=Zj(js),w9=s6(b9,_t,new WeakSet,R6),k9=Kj(rc,Ih,Mr,sv,Or,nc),WP=Xj(k9,Or),A9=p6(Hs,WP,Dt,$s,zn),E9=h6(nn,es,WP,A9,_t,yt),T9=S6(sv,Dt,zn),_9=I6(nn,Un,sv,T9,_t,yt,rl),jP=aj(Vs),Mb=BW(Vs),HP=new WeakMap,R9=XW(HP,tc),x9=jP?fG(Jo,Or,DW(Vs),Mb,FW(aG),_t,R9,yt,Uf,new WeakMap,new WeakMap,m6(Uf,tc),Vs):void 0,N9=sj(RP,yt),P9=SW(NP,Jo,IW,OW,new WeakSet,_t,N9,BC,UC,MP,OP),M9=QG(x9,G6,W6,H6,Z6,J6,q6,t9,r9,P9,s9,a9,l9,h9,g9,v9,S9,w9,E9,_9),O9=cj(nn,Uj,_t,yt),D9=uj(nn,Vj,_t,yt),L9=dj(nn,Gj,_t,yt),B9=Wj(Un,yt),F9=fj(nn,B9,_t),U9=MG(M9,Un,Or,y6,O9,D9,L9,F9,wh),$P=KW(FP),V9=mG($P),zP=dW(js),G9=TW($P),ZP=xW(js),XP=new WeakMap,W9=WW(XP,Yi),j9=_j(zP,js,Un,rc,Ih,Yu,Mr,Sh,Or,ZP,Mb,W9,nc),H9=kj(Un,j9,Mr,Or,nc),$9=qG(Hs,zP,Ju,rc,Ih,Yu,Mr,G9,ZP,Mb,Dt,Uf,tc,$s,zn,Pb),z9=zW(HP),Z9=u6(XP),U1=jP?KG(V9,nn,es,$9,H9,dr,z9,_t,yt,Uf,T6,Z9,M6,Ku):void 0;class KP{static async openCache(){try{return await caches.open("audio-cache")}catch(t){throw console.error("Failed to open cache:",t),t}}static async getAudioBufferFromCache(t,n,r){try{const i=await n.match(t);if(i){const s=await i.arrayBuffer();return r.decodeAudioData(s)}return null}catch(i){throw console.error("Failed to get audio data from cache:",i),i}}static async fetchAndCacheAudioBuffer(t,n,r){try{const i=await fetch(t),s=i.clone();n.put(t,s);const o=await i.arrayBuffer();return r.decodeAudioData(o)}catch(i){throw console.error("Failed to fetch and cache audio data:",i),i}}static async getAudioBuffer(t,n){const r=await this.openCache();let i=this.pendingRequests.get(t);return i||await this.getAudioBufferFromCache(t,r,n)||(i=this.fetchAndCacheAudioBuffer(t,r,n),this.pendingRequests.set(t,i),i)}}V(KP,"pendingRequests",new Map);const X9=(e,t)=>{var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer};function K9(e,t){const n=[];let r=0;fetch(e).then(function(s){if(!s.ok)throw new Error("HTTP error, status = "+s.status);if(!s.body)throw new Error("Missing body");var o=s.body.getReader();let a=new ArrayBuffer(0);function c(){return o.read().then(({value:l,done:u})=>{let d=null;if(l){if(a.byteLength?d=X9(a,l.buffer):(a=l.buffer.slice(0,44),d=l.buffer),t.decodeAudioData(d,function(f){n.push(f),n.length&&i()},function(f){console.log("err(decodeAudioData): "+f)}),u){console.log("done");return}c()}})}c()});function i(){for(;n.length;){let s=n.shift();const o=t.createBufferSource();if(!s)return;o.buffer=s,o.connect(t.destination),r==0&&(r=t.currentTime+.02),o.start(r),r+=o.buffer.duration}}}const J9="data:application/javascript;base64,KGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3QgV0VCQVVESU9fQkxPQ0tfU0laRSA9IDEyODsKICAgIGNvbnN0IERFRkFVTFRfQkxPQ0tfU0laRSA9IDEwMjQ7IC8vIERlZmF1bHQgYmxvY2sgc2l6ZSBpZiBub3QgcHJvdmlkZWQgaW4gb3B0aW9ucwogICAgLyoqIE92ZXJsYXAtQWRkIE5vZGUgKi8KICAgIGNsYXNzIE9MQVByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7CiAgICAgICAgbmJJbnB1dHM7CiAgICAgICAgbmJPdXRwdXRzOwogICAgICAgIGJsb2NrU2l6ZTsKICAgICAgICBob3BTaXplOwogICAgICAgIG5iT3ZlcmxhcHM7CiAgICAgICAgaW5wdXRCdWZmZXJzID0gW107CiAgICAgICAgaW5wdXRCdWZmZXJzSGVhZCA9IFtdOwogICAgICAgIGlucHV0QnVmZmVyc1RvU2VuZCA9IFtdOwogICAgICAgIG91dHB1dEJ1ZmZlcnMgPSBbXTsKICAgICAgICBvdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSA9IFtdOwogICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMubmJJbnB1dHMgPSBvcHRpb25zLm51bWJlck9mSW5wdXRzIHx8IDE7CiAgICAgICAgICAgIHRoaXMubmJPdXRwdXRzID0gb3B0aW9ucy5udW1iZXJPZk91dHB1dHMgfHwgMTsKICAgICAgICAgICAgdGhpcy5ibG9ja1NpemUgPSBvcHRpb25zLnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplIHx8IERFRkFVTFRfQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5ob3BTaXplID0gV0VCQVVESU9fQkxPQ0tfU0laRTsKICAgICAgICAgICAgdGhpcy5uYk92ZXJsYXBzID0gTWF0aC5mbG9vcih0aGlzLmJsb2NrU2l6ZSAvIHRoaXMuaG9wU2l6ZSk7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKICAgICAgICB9CiAgICAgICAgaW5pdGlhbGl6ZUJ1ZmZlcnMoKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWQgPSBuZXcgQXJyYXkodGhpcy5uYklucHV0cyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kID0gbmV3IEFycmF5KHRoaXMubmJJbnB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnMgPSBuZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpOwogICAgICAgICAgICB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlID0gbmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYk91dHB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGksIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRlSW5wdXRDaGFubmVscyhpbnB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc0hlYWRbaW5wdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2lucHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplICsgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0QnVmZmVyc1tpbnB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW2lucHV0SW5kZXhdW2ldID0gdGhpcy5pbnB1dEJ1ZmZlcnNbaW5wdXRJbmRleF1baV0uc3ViYXJyYXkoMCwgdGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbaW5wdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBhbGxvY2F0ZU91dHB1dENoYW5uZWxzKG91dHB1dEluZGV4LCBuYkNoYW5uZWxzKSB7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tvdXRwdXRJbmRleF0gPSBuZXcgQXJyYXkobmJDaGFubmVscyk7CiAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbb3V0cHV0SW5kZXhdID0gbmV3IEFycmF5KG5iQ2hhbm5lbHMpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iQ2hhbm5lbHM7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW291dHB1dEluZGV4XVtpXS5maWxsKDApOwogICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVtvdXRwdXRJbmRleF1baV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZChpbnB1dHMsIG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iSW5wdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gaW5wdXRzW2ldLmxlbmd0aDsKICAgICAgICAgICAgICAgIGlmIChuYkNoYW5uZWxzICE9PSB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuYkNoYW5uZWxzID0gb3V0cHV0c1tpXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAobmJDaGFubmVscyAhPT0gdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhpLCBuYkNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZWFkSW5wdXRzKGlucHV0cykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gaW5wdXRzW2ldW2pdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLnNldCh3ZWJBdWRpb0Jsb2NrLCB0aGlzLmJsb2NrU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd3JpdGVPdXRwdXRzKG91dHB1dHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iT3V0cHV0czsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMub3V0cHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCB3ZWJBdWRpb0Jsb2NrID0gb3V0cHV0c1tpXVtqXTsKICAgICAgICAgICAgICAgICAgICB3ZWJBdWRpb0Jsb2NrLnNldCh0aGlzLm91dHB1dEJ1ZmZlcnNbaV1bal0uc3ViYXJyYXkoMCwgV0VCQVVESU9fQkxPQ0tfU0laRSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0SW5wdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2hpZnRPdXRwdXRCdWZmZXJzKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmNvcHlXaXRoaW4oMCwgV0VCQVVESU9fQkxPQ0tfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRCdWZmZXJzW2ldW2pdLmZpbGwoMCwgdGhpcy5ibG9ja1NpemUgLSBXRUJBVURJT19CTE9DS19TSVpFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmlucHV0QnVmZmVyc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW2ldW2pdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbaV1bal0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJPdXRwdXRzOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5vdXRwdXRCdWZmZXJzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmJsb2NrU2l6ZTsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0QnVmZmVyc1tpXVtqXVtrXSArPSB0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW2ldW2pdW2tdIC8gdGhpcy5uYk92ZXJsYXBzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICB0aGlzLnJlYWxsb2NhdGVDaGFubmVsc0lmTmVlZGVkKGlucHV0cywgb3V0cHV0cyk7CiAgICAgICAgICAgIHRoaXMucmVhZElucHV0cyhpbnB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCk7CiAgICAgICAgICAgIHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpOwogICAgICAgICAgICB0aGlzLnByb2Nlc3NPTEEodGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQsIHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUsIHBhcmFtZXRlcnMpOwogICAgICAgICAgICB0aGlzLmhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCk7CiAgICAgICAgICAgIHRoaXMud3JpdGVPdXRwdXRzKG91dHB1dHMpOwogICAgICAgICAgICB0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMgKHgpIHsKICAgIAlyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4OwogICAgfQoKICAgIGZ1bmN0aW9uIEZGVChzaXplKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHNpemUgfCAwOwogICAgICBpZiAodGhpcy5zaXplIDw9IDEgfHwgKHRoaXMuc2l6ZSAmICh0aGlzLnNpemUgLSAxKSkgIT09IDApCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxJyk7CgogICAgICB0aGlzLl9jc2l6ZSA9IHNpemUgPDwgMTsKCiAgICAgIC8vIE5PVEU6IFVzZSBvZiBgdmFyYCBpcyBpbnRlbnRpb25hbCBmb3Igb2xkIFY4IHZlcnNpb25zCiAgICAgIHZhciB0YWJsZSA9IG5ldyBBcnJheSh0aGlzLnNpemUgKiAyKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZS5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5QSSAqIGkgLyB0aGlzLnNpemU7CiAgICAgICAgdGFibGVbaV0gPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgICAgdGFibGVbaSArIDFdID0gLU1hdGguc2luKGFuZ2xlKTsKICAgICAgfQogICAgICB0aGlzLnRhYmxlID0gdGFibGU7CgogICAgICAvLyBGaW5kIHNpemUncyBwb3dlciBvZiB0d28KICAgICAgdmFyIHBvd2VyID0gMDsKICAgICAgZm9yICh2YXIgdCA9IDE7IHRoaXMuc2l6ZSA+IHQ7IHQgPDw9IDEpCiAgICAgICAgcG93ZXIrKzsKCiAgICAgIC8vIENhbGN1bGF0ZSBpbml0aWFsIHN0ZXAncyB3aWR0aDoKICAgICAgLy8gICAqIElmIHdlIGFyZSBmdWxsIHJhZGl4LTQgLSBpdCBpcyAyeCBzbWFsbGVyIHRvIGdpdmUgaW5pdGFsIGxlbj04CiAgICAgIC8vICAgKiBPdGhlcndpc2UgaXQgaXMgdGhlIHNhbWUgYXMgYHBvd2VyYCB0byBnaXZlIGxlbj00CiAgICAgIHRoaXMuX3dpZHRoID0gcG93ZXIgJSAyID09PSAwID8gcG93ZXIgLSAxIDogcG93ZXI7CgogICAgICAvLyBQcmUtY29tcHV0ZSBiaXQtcmV2ZXJzYWwgcGF0dGVybnMKICAgICAgdGhpcy5fYml0cmV2ID0gbmV3IEFycmF5KDEgPDwgdGhpcy5fd2lkdGgpOwogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX2JpdHJldi5sZW5ndGg7IGorKykgewogICAgICAgIHRoaXMuX2JpdHJldltqXSA9IDA7CiAgICAgICAgZm9yICh2YXIgc2hpZnQgPSAwOyBzaGlmdCA8IHRoaXMuX3dpZHRoOyBzaGlmdCArPSAyKSB7CiAgICAgICAgICB2YXIgcmV2U2hpZnQgPSB0aGlzLl93aWR0aCAtIHNoaWZ0IC0gMjsKICAgICAgICAgIHRoaXMuX2JpdHJldltqXSB8PSAoKGogPj4+IHNoaWZ0KSAmIDMpIDw8IHJldlNoaWZ0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb3V0ID0gbnVsbDsKICAgICAgdGhpcy5fZGF0YSA9IG51bGw7CiAgICAgIHRoaXMuX2ludiA9IDA7CiAgICB9CiAgICB2YXIgZmZ0ID0gRkZUOwoKICAgIEZGVC5wcm90b3R5cGUuZnJvbUNvbXBsZXhBcnJheSA9IGZ1bmN0aW9uIGZyb21Db21wbGV4QXJyYXkoY29tcGxleCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCBuZXcgQXJyYXkoY29tcGxleC5sZW5ndGggPj4+IDEpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXgubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgcmVzW2kgPj4+IDFdID0gY29tcGxleFtpXTsKICAgICAgcmV0dXJuIHJlczsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5jcmVhdGVDb21wbGV4QXJyYXkgPSBmdW5jdGlvbiBjcmVhdGVDb21wbGV4QXJyYXkoKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKQogICAgICAgIHJlc1tpXSA9IDA7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudG9Db21wbGV4QXJyYXkgPSBmdW5jdGlvbiB0b0NvbXBsZXhBcnJheShpbnB1dCwgc3RvcmFnZSkgewogICAgICB2YXIgcmVzID0gc3RvcmFnZSB8fCB0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgIHJlc1tpXSA9IGlucHV0W2kgPj4+IDFdOwogICAgICAgIHJlc1tpICsgMV0gPSAwOwogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUuY29tcGxldGVTcGVjdHJ1bSA9IGZ1bmN0aW9uIGNvbXBsZXRlU3BlY3RydW0oc3BlY3RydW0pIHsKICAgICAgdmFyIHNpemUgPSB0aGlzLl9jc2l6ZTsKICAgICAgdmFyIGhhbGYgPSBzaXplID4+PiAxOwogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGhhbGY7IGkgKz0gMikgewogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpXSA9IHNwZWN0cnVtW2ldOwogICAgICAgIHNwZWN0cnVtW3NpemUgLSBpICsgMV0gPSAtc3BlY3RydW1baSArIDFdOwogICAgICB9CiAgICB9OwoKICAgIEZGVC5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gdHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl90cmFuc2Zvcm00KCk7CiAgICAgIHRoaXMuX291dCA9IG51bGw7CiAgICAgIHRoaXMuX2RhdGEgPSBudWxsOwogICAgfTsKCiAgICBGRlQucHJvdG90eXBlLnJlYWxUcmFuc2Zvcm0gPSBmdW5jdGlvbiByZWFsVHJhbnNmb3JtKG91dCwgZGF0YSkgewogICAgICBpZiAob3V0ID09PSBkYXRhKQogICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Jyk7CgogICAgICB0aGlzLl9vdXQgPSBvdXQ7CiAgICAgIHRoaXMuX2RhdGEgPSBkYXRhOwogICAgICB0aGlzLl9pbnYgPSAwOwogICAgICB0aGlzLl9yZWFsVHJhbnNmb3JtNCgpOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgRkZULnByb3RvdHlwZS5pbnZlcnNlVHJhbnNmb3JtID0gZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShvdXQsIGRhdGEpIHsKICAgICAgaWYgKG91dCA9PT0gZGF0YSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCcpOwoKICAgICAgdGhpcy5fb3V0ID0gb3V0OwogICAgICB0aGlzLl9kYXRhID0gZGF0YTsKICAgICAgdGhpcy5faW52ID0gMTsKICAgICAgdGhpcy5fdHJhbnNmb3JtNCgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dC5sZW5ndGg7IGkrKykKICAgICAgICBvdXRbaV0gLz0gdGhpcy5zaXplOwogICAgICB0aGlzLl9vdXQgPSBudWxsOwogICAgICB0aGlzLl9kYXRhID0gbnVsbDsKICAgIH07CgogICAgLy8gcmFkaXgtNCBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IFVzZXMgb2YgYHZhcmAgYXJlIGludGVudGlvbmFsIGZvciBvbGRlciBWOCB2ZXJzaW9uIHRoYXQgZG8gbm90CiAgICAvLyBzdXBwb3J0IGJvdGggYGxldCBjb21wb3VuZCBhc3NpZ25tZW50c2AgYW5kIGBjb25zdCBwaGlgCiAgICBGRlQucHJvdG90eXBlLl90cmFuc2Zvcm00ID0gZnVuY3Rpb24gX3RyYW5zZm9ybTQoKSB7CiAgICAgIHZhciBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIHZhciBzaXplID0gdGhpcy5fY3NpemU7CgogICAgICAvLyBJbml0aWFsIHN0ZXAgKHBlcm11dGUgYW5kIHRyYW5zZm9ybSkKICAgICAgdmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7CiAgICAgIHZhciBzdGVwID0gMSA8PCB3aWR0aDsKICAgICAgdmFyIGxlbiA9IChzaXplIC8gc3RlcCkgPDwgMTsKCiAgICAgIHZhciBvdXRPZmY7CiAgICAgIHZhciB0OwogICAgICB2YXIgYml0cmV2ID0gdGhpcy5fYml0cmV2OwogICAgICBpZiAobGVuID09PSA0KSB7CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gbGVuID09PSA4CiAgICAgICAgZm9yIChvdXRPZmYgPSAwLCB0ID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbiwgdCsrKSB7CiAgICAgICAgICBjb25zdCBvZmYgPSBiaXRyZXZbdF07CiAgICAgICAgICB0aGlzLl9zaW5nbGVUcmFuc2Zvcm00KG91dE9mZiwgb2ZmLCBzdGVwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gbGVuID4+PiAyOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgLy8gRnVsbCBjYXNlCiAgICAgICAgICB2YXIgbGltaXQgPSBvdXRPZmYgKyBxdWFydGVyTGVuOwogICAgICAgICAgZm9yICh2YXIgaSA9IG91dE9mZiwgayA9IDA7IGkgPCBsaW1pdDsgaSArPSAyLCBrICs9IHN0ZXApIHsKICAgICAgICAgICAgY29uc3QgQSA9IGk7CiAgICAgICAgICAgIGNvbnN0IEIgPSBBICsgcXVhcnRlckxlbjsKICAgICAgICAgICAgY29uc3QgQyA9IEIgKyBxdWFydGVyTGVuOwogICAgICAgICAgICBjb25zdCBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgQXIgPSBvdXRbQV07CiAgICAgICAgICAgIGNvbnN0IEFpID0gb3V0W0EgKyAxXTsKICAgICAgICAgICAgY29uc3QgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIGNvbnN0IEJpID0gb3V0W0IgKyAxXTsKICAgICAgICAgICAgY29uc3QgQ3IgPSBvdXRbQ107CiAgICAgICAgICAgIGNvbnN0IENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgY29uc3QgRHIgPSBvdXRbRF07CiAgICAgICAgICAgIGNvbnN0IERpID0gb3V0W0QgKyAxXTsKCiAgICAgICAgICAgIC8vIE1pZGRsZSB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgTUFyID0gQXI7CiAgICAgICAgICAgIGNvbnN0IE1BaSA9IEFpOwoKICAgICAgICAgICAgY29uc3QgdGFibGVCciA9IHRhYmxlW2tdOwogICAgICAgICAgICBjb25zdCB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICBjb25zdCBNQnIgPSBCciAqIHRhYmxlQnIgLSBCaSAqIHRhYmxlQmk7CiAgICAgICAgICAgIGNvbnN0IE1CaSA9IEJyICogdGFibGVCaSArIEJpICogdGFibGVCcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2kgPSBpbnYgKiB0YWJsZVsyICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNQ3IgPSBDciAqIHRhYmxlQ3IgLSBDaSAqIHRhYmxlQ2k7CiAgICAgICAgICAgIGNvbnN0IE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIGNvbnN0IHRhYmxlRHIgPSB0YWJsZVszICoga107CiAgICAgICAgICAgIGNvbnN0IHRhYmxlRGkgPSBpbnYgKiB0YWJsZVszICogayArIDFdOwogICAgICAgICAgICBjb25zdCBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIGNvbnN0IE1EaSA9IERyICogdGFibGVEaSArIERpICogdGFibGVEcjsKCiAgICAgICAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgICAgICAgY29uc3QgVDByID0gTUFyICsgTUNyOwogICAgICAgICAgICBjb25zdCBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIGNvbnN0IFQxciA9IE1BciAtIE1DcjsKICAgICAgICAgICAgY29uc3QgVDFpID0gTUFpIC0gTUNpOwogICAgICAgICAgICBjb25zdCBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIGNvbnN0IFQyaSA9IE1CaSArIE1EaTsKICAgICAgICAgICAgY29uc3QgVDNyID0gaW52ICogKE1CciAtIE1Ecik7CiAgICAgICAgICAgIGNvbnN0IFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKICAgICAgICAgICAgY29uc3QgRkFpID0gVDBpICsgVDJpOwoKICAgICAgICAgICAgY29uc3QgRkNyID0gVDByIC0gVDJyOwogICAgICAgICAgICBjb25zdCBGQ2kgPSBUMGkgLSBUMmk7CgogICAgICAgICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgICAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgICAgICAgIGNvbnN0IEZEciA9IFQxciAtIFQzaTsKICAgICAgICAgICAgY29uc3QgRkRpID0gVDFpICsgVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CiAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgb3V0W0MgKyAxXSA9IEZDaTsKICAgICAgICAgICAgb3V0W0RdID0gRkRyOwogICAgICAgICAgICBvdXRbRCArIDFdID0gRkRpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvLyByYWRpeC0yIGltcGxlbWVudGF0aW9uCiAgICAvLwogICAgLy8gTk9URTogT25seSBjYWxsZWQgZm9yIGxlbj00CiAgICBGRlQucHJvdG90eXBlLl9zaW5nbGVUcmFuc2Zvcm0yID0gZnVuY3Rpb24gX3NpbmdsZVRyYW5zZm9ybTIob3V0T2ZmLCBvZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IGV2ZW5JID0gZGF0YVtvZmYgKyAxXTsKICAgICAgY29uc3Qgb2RkUiA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IG9kZEkgPSBkYXRhW29mZiArIHN0ZXAgKyAxXTsKCiAgICAgIGNvbnN0IGxlZnRSID0gZXZlblIgKyBvZGRSOwogICAgICBjb25zdCBsZWZ0SSA9IGV2ZW5JICsgb2RkSTsKICAgICAgY29uc3QgcmlnaHRSID0gZXZlblIgLSBvZGRSOwogICAgICBjb25zdCByaWdodEkgPSBldmVuSSAtIG9kZEk7CgogICAgICBvdXRbb3V0T2ZmXSA9IGxlZnRSOwogICAgICBvdXRbb3V0T2ZmICsgMV0gPSBsZWZ0STsKICAgICAgb3V0W291dE9mZiArIDJdID0gcmlnaHRSOwogICAgICBvdXRbb3V0T2ZmICsgM10gPSByaWdodEk7CiAgICB9OwoKICAgIC8vIHJhZGl4LTQKICAgIC8vCiAgICAvLyBOT1RFOiBPbmx5IGNhbGxlZCBmb3IgbGVuPTgKICAgIEZGVC5wcm90b3R5cGUuX3NpbmdsZVRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlVHJhbnNmb3JtNChvdXRPZmYsIG9mZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMuX291dDsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2RhdGE7CiAgICAgIGNvbnN0IGludiA9IHRoaXMuX2ludiA/IC0xIDogMTsKICAgICAgY29uc3Qgc3RlcDIgPSBzdGVwICogMjsKICAgICAgY29uc3Qgc3RlcDMgPSBzdGVwICogMzsKCiAgICAgIC8vIE9yaWdpbmFsIHZhbHVlcwogICAgICBjb25zdCBBciA9IGRhdGFbb2ZmXTsKICAgICAgY29uc3QgQWkgPSBkYXRhW29mZiArIDFdOwogICAgICBjb25zdCBCciA9IGRhdGFbb2ZmICsgc3RlcF07CiAgICAgIGNvbnN0IEJpID0gZGF0YVtvZmYgKyBzdGVwICsgMV07CiAgICAgIGNvbnN0IENyID0gZGF0YVtvZmYgKyBzdGVwMl07CiAgICAgIGNvbnN0IENpID0gZGF0YVtvZmYgKyBzdGVwMiArIDFdOwogICAgICBjb25zdCBEciA9IGRhdGFbb2ZmICsgc3RlcDNdOwogICAgICBjb25zdCBEaSA9IGRhdGFbb2ZmICsgc3RlcDMgKyAxXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDBpID0gQWkgKyBDaTsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDFpID0gQWkgLSBDaTsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDJpID0gQmkgKyBEaTsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwogICAgICBjb25zdCBUM2kgPSBpbnYgKiAoQmkgLSBEaSk7CgogICAgICAvLyBGaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgRkFyID0gVDByICsgVDJyOwogICAgICBjb25zdCBGQWkgPSBUMGkgKyBUMmk7CgogICAgICBjb25zdCBGQnIgPSBUMXIgKyBUM2k7CiAgICAgIGNvbnN0IEZCaSA9IFQxaSAtIFQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKICAgICAgY29uc3QgRkNpID0gVDBpIC0gVDJpOwoKICAgICAgY29uc3QgRkRyID0gVDFyIC0gVDNpOwogICAgICBjb25zdCBGRGkgPSBUMWkgKyBUM3I7CgogICAgICBvdXRbb3V0T2ZmXSA9IEZBcjsKICAgICAgb3V0W291dE9mZiArIDFdID0gRkFpOwogICAgICBvdXRbb3V0T2ZmICsgMl0gPSBGQnI7CiAgICAgIG91dFtvdXRPZmYgKyAzXSA9IEZCaTsKICAgICAgb3V0W291dE9mZiArIDRdID0gRkNyOwogICAgICBvdXRbb3V0T2ZmICsgNV0gPSBGQ2k7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICAvLyBSZWFsIGlucHV0IHJhZGl4LTQgaW1wbGVtZW50YXRpb24KICAgIEZGVC5wcm90b3R5cGUuX3JlYWxUcmFuc2Zvcm00ID0gZnVuY3Rpb24gX3JlYWxUcmFuc2Zvcm00KCkgewogICAgICB2YXIgb3V0ID0gdGhpcy5fb3V0OwogICAgICB2YXIgc2l6ZSA9IHRoaXMuX2NzaXplOwoKICAgICAgLy8gSW5pdGlhbCBzdGVwIChwZXJtdXRlIGFuZCB0cmFuc2Zvcm0pCiAgICAgIHZhciB3aWR0aCA9IHRoaXMuX3dpZHRoOwogICAgICB2YXIgc3RlcCA9IDEgPDwgd2lkdGg7CiAgICAgIHZhciBsZW4gPSAoc2l6ZSAvIHN0ZXApIDw8IDE7CgogICAgICB2YXIgb3V0T2ZmOwogICAgICB2YXIgdDsKICAgICAgdmFyIGJpdHJldiA9IHRoaXMuX2JpdHJldjsKICAgICAgaWYgKGxlbiA9PT0gNCkgewogICAgICAgIGZvciAob3V0T2ZmID0gMCwgdCA9IDA7IG91dE9mZiA8IHNpemU7IG91dE9mZiArPSBsZW4sIHQrKykgewogICAgICAgICAgY29uc3Qgb2ZmID0gYml0cmV2W3RdOwogICAgICAgICAgdGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLCBvZmYgPj4+IDEsIHN0ZXAgPj4+IDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBsZW4gPT09IDgKICAgICAgICBmb3IgKG91dE9mZiA9IDAsIHQgPSAwOyBvdXRPZmYgPCBzaXplOyBvdXRPZmYgKz0gbGVuLCB0KyspIHsKICAgICAgICAgIGNvbnN0IG9mZiA9IGJpdHJldlt0XTsKICAgICAgICAgIHRoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG91dE9mZiwgb2ZmID4+PiAxLCBzdGVwID4+PiAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIExvb3AgdGhyb3VnaCBzdGVwcyBpbiBkZWNyZWFzaW5nIG9yZGVyCiAgICAgIHZhciBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7CiAgICAgIGZvciAoc3RlcCA+Pj0gMjsgc3RlcCA+PSAyOyBzdGVwID4+PSAyKSB7CiAgICAgICAgbGVuID0gKHNpemUgLyBzdGVwKSA8PCAxOwogICAgICAgIHZhciBoYWxmTGVuID0gbGVuID4+PiAxOwogICAgICAgIHZhciBxdWFydGVyTGVuID0gaGFsZkxlbiA+Pj4gMTsKICAgICAgICB2YXIgaHF1YXJ0ZXJMZW4gPSBxdWFydGVyTGVuID4+PiAxOwoKICAgICAgICAvLyBMb29wIHRocm91Z2ggb2Zmc2V0cyBpbiB0aGUgZGF0YQogICAgICAgIGZvciAob3V0T2ZmID0gMDsgb3V0T2ZmIDwgc2l6ZTsgb3V0T2ZmICs9IGxlbikgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGsgPSAwOyBpIDw9IGhxdWFydGVyTGVuOyBpICs9IDIsIGsgKz0gc3RlcCkgewogICAgICAgICAgICB2YXIgQSA9IG91dE9mZiArIGk7CiAgICAgICAgICAgIHZhciBCID0gQSArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBDID0gQiArIHF1YXJ0ZXJMZW47CiAgICAgICAgICAgIHZhciBEID0gQyArIHF1YXJ0ZXJMZW47CgogICAgICAgICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgICAgICAgdmFyIEFyID0gb3V0W0FdOwogICAgICAgICAgICB2YXIgQWkgPSBvdXRbQSArIDFdOwogICAgICAgICAgICB2YXIgQnIgPSBvdXRbQl07CiAgICAgICAgICAgIHZhciBCaSA9IG91dFtCICsgMV07CiAgICAgICAgICAgIHZhciBDciA9IG91dFtDXTsKICAgICAgICAgICAgdmFyIENpID0gb3V0W0MgKyAxXTsKICAgICAgICAgICAgdmFyIERyID0gb3V0W0RdOwogICAgICAgICAgICB2YXIgRGkgPSBvdXRbRCArIDFdOwoKICAgICAgICAgICAgLy8gTWlkZGxlIHZhbHVlcwogICAgICAgICAgICB2YXIgTUFyID0gQXI7CiAgICAgICAgICAgIHZhciBNQWkgPSBBaTsKCiAgICAgICAgICAgIHZhciB0YWJsZUJyID0gdGFibGVba107CiAgICAgICAgICAgIHZhciB0YWJsZUJpID0gaW52ICogdGFibGVbayArIDFdOwogICAgICAgICAgICB2YXIgTUJyID0gQnIgKiB0YWJsZUJyIC0gQmkgKiB0YWJsZUJpOwogICAgICAgICAgICB2YXIgTUJpID0gQnIgKiB0YWJsZUJpICsgQmkgKiB0YWJsZUJyOwoKICAgICAgICAgICAgdmFyIHRhYmxlQ3IgPSB0YWJsZVsyICoga107CiAgICAgICAgICAgIHZhciB0YWJsZUNpID0gaW52ICogdGFibGVbMiAqIGsgKyAxXTsKICAgICAgICAgICAgdmFyIE1DciA9IENyICogdGFibGVDciAtIENpICogdGFibGVDaTsKICAgICAgICAgICAgdmFyIE1DaSA9IENyICogdGFibGVDaSArIENpICogdGFibGVDcjsKCiAgICAgICAgICAgIHZhciB0YWJsZURyID0gdGFibGVbMyAqIGtdOwogICAgICAgICAgICB2YXIgdGFibGVEaSA9IGludiAqIHRhYmxlWzMgKiBrICsgMV07CiAgICAgICAgICAgIHZhciBNRHIgPSBEciAqIHRhYmxlRHIgLSBEaSAqIHRhYmxlRGk7CiAgICAgICAgICAgIHZhciBNRGkgPSBEciAqIHRhYmxlRGkgKyBEaSAqIHRhYmxlRHI7CgogICAgICAgICAgICAvLyBQcmUtRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBUMHIgPSBNQXIgKyBNQ3I7CiAgICAgICAgICAgIHZhciBUMGkgPSBNQWkgKyBNQ2k7CiAgICAgICAgICAgIHZhciBUMXIgPSBNQXIgLSBNQ3I7CiAgICAgICAgICAgIHZhciBUMWkgPSBNQWkgLSBNQ2k7CiAgICAgICAgICAgIHZhciBUMnIgPSBNQnIgKyBNRHI7CiAgICAgICAgICAgIHZhciBUMmkgPSBNQmkgKyBNRGk7CiAgICAgICAgICAgIHZhciBUM3IgPSBpbnYgKiAoTUJyIC0gTURyKTsKICAgICAgICAgICAgdmFyIFQzaSA9IGludiAqIChNQmkgLSBNRGkpOwoKICAgICAgICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgICAgICAgIHZhciBGQXIgPSBUMHIgKyBUMnI7CiAgICAgICAgICAgIHZhciBGQWkgPSBUMGkgKyBUMmk7CgogICAgICAgICAgICB2YXIgRkJyID0gVDFyICsgVDNpOwogICAgICAgICAgICB2YXIgRkJpID0gVDFpIC0gVDNyOwoKICAgICAgICAgICAgb3V0W0FdID0gRkFyOwogICAgICAgICAgICBvdXRbQSArIDFdID0gRkFpOwogICAgICAgICAgICBvdXRbQl0gPSBGQnI7CiAgICAgICAgICAgIG91dFtCICsgMV0gPSBGQmk7CgogICAgICAgICAgICAvLyBPdXRwdXQgZmluYWwgbWlkZGxlIHBvaW50CiAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIEZDciA9IFQwciAtIFQycjsKICAgICAgICAgICAgICB2YXIgRkNpID0gVDBpIC0gVDJpOwogICAgICAgICAgICAgIG91dFtDXSA9IEZDcjsKICAgICAgICAgICAgICBvdXRbQyArIDFdID0gRkNpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEbyBub3Qgb3ZlcndyaXRlIG91cnNlbHZlcwogICAgICAgICAgICBpZiAoaSA9PT0gaHF1YXJ0ZXJMZW4pCiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBJbiB0aGUgZmxpcHBlZCBjYXNlOgogICAgICAgICAgICAvLyBNQWkgPSAtTUFpCiAgICAgICAgICAgIC8vIE1Ccj0tTUJpLCBNQmk9LU1CcgogICAgICAgICAgICAvLyBNQ3I9LU1DcgogICAgICAgICAgICAvLyBNRHI9TURpLCBNRGk9TURyCiAgICAgICAgICAgIHZhciBTVDByID0gVDFyOwogICAgICAgICAgICB2YXIgU1QwaSA9IC1UMWk7CiAgICAgICAgICAgIHZhciBTVDFyID0gVDByOwogICAgICAgICAgICB2YXIgU1QxaSA9IC1UMGk7CiAgICAgICAgICAgIHZhciBTVDJyID0gLWludiAqIFQzaTsKICAgICAgICAgICAgdmFyIFNUMmkgPSAtaW52ICogVDNyOwogICAgICAgICAgICB2YXIgU1QzciA9IC1pbnYgKiBUMmk7CiAgICAgICAgICAgIHZhciBTVDNpID0gLWludiAqIFQycjsKCiAgICAgICAgICAgIHZhciBTRkFyID0gU1QwciArIFNUMnI7CiAgICAgICAgICAgIHZhciBTRkFpID0gU1QwaSArIFNUMmk7CgogICAgICAgICAgICB2YXIgU0ZCciA9IFNUMXIgKyBTVDNpOwogICAgICAgICAgICB2YXIgU0ZCaSA9IFNUMWkgLSBTVDNyOwoKICAgICAgICAgICAgdmFyIFNBID0gb3V0T2ZmICsgcXVhcnRlckxlbiAtIGk7CiAgICAgICAgICAgIHZhciBTQiA9IG91dE9mZiArIGhhbGZMZW4gLSBpOwoKICAgICAgICAgICAgb3V0W1NBXSA9IFNGQXI7CiAgICAgICAgICAgIG91dFtTQSArIDFdID0gU0ZBaTsKICAgICAgICAgICAgb3V0W1NCXSA9IFNGQnI7CiAgICAgICAgICAgIG91dFtTQiArIDFdID0gU0ZCaTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLy8gcmFkaXgtMiBpbXBsZW1lbnRhdGlvbgogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49NAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTIgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTIob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwoKICAgICAgY29uc3QgZXZlblIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IG9kZFIgPSBkYXRhW29mZiArIHN0ZXBdOwoKICAgICAgY29uc3QgbGVmdFIgPSBldmVuUiArIG9kZFI7CiAgICAgIGNvbnN0IHJpZ2h0UiA9IGV2ZW5SIC0gb2RkUjsKCiAgICAgIG91dFtvdXRPZmZdID0gbGVmdFI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IHJpZ2h0UjsKICAgICAgb3V0W291dE9mZiArIDNdID0gMDsKICAgIH07CgogICAgLy8gcmFkaXgtNAogICAgLy8KICAgIC8vIE5PVEU6IE9ubHkgY2FsbGVkIGZvciBsZW49OAogICAgRkZULnByb3RvdHlwZS5fc2luZ2xlUmVhbFRyYW5zZm9ybTQgPSBmdW5jdGlvbiBfc2luZ2xlUmVhbFRyYW5zZm9ybTQob3V0T2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCkgewogICAgICBjb25zdCBvdXQgPSB0aGlzLl9vdXQ7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9kYXRhOwogICAgICBjb25zdCBpbnYgPSB0aGlzLl9pbnYgPyAtMSA6IDE7CiAgICAgIGNvbnN0IHN0ZXAyID0gc3RlcCAqIDI7CiAgICAgIGNvbnN0IHN0ZXAzID0gc3RlcCAqIDM7CgogICAgICAvLyBPcmlnaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgQXIgPSBkYXRhW29mZl07CiAgICAgIGNvbnN0IEJyID0gZGF0YVtvZmYgKyBzdGVwXTsKICAgICAgY29uc3QgQ3IgPSBkYXRhW29mZiArIHN0ZXAyXTsKICAgICAgY29uc3QgRHIgPSBkYXRhW29mZiArIHN0ZXAzXTsKCiAgICAgIC8vIFByZS1GaW5hbCB2YWx1ZXMKICAgICAgY29uc3QgVDByID0gQXIgKyBDcjsKICAgICAgY29uc3QgVDFyID0gQXIgLSBDcjsKICAgICAgY29uc3QgVDJyID0gQnIgKyBEcjsKICAgICAgY29uc3QgVDNyID0gaW52ICogKEJyIC0gRHIpOwoKICAgICAgLy8gRmluYWwgdmFsdWVzCiAgICAgIGNvbnN0IEZBciA9IFQwciArIFQycjsKCiAgICAgIGNvbnN0IEZCciA9IFQxcjsKICAgICAgY29uc3QgRkJpID0gLVQzcjsKCiAgICAgIGNvbnN0IEZDciA9IFQwciAtIFQycjsKCiAgICAgIGNvbnN0IEZEciA9IFQxcjsKICAgICAgY29uc3QgRkRpID0gVDNyOwoKICAgICAgb3V0W291dE9mZl0gPSBGQXI7CiAgICAgIG91dFtvdXRPZmYgKyAxXSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyAyXSA9IEZCcjsKICAgICAgb3V0W291dE9mZiArIDNdID0gRkJpOwogICAgICBvdXRbb3V0T2ZmICsgNF0gPSBGQ3I7CiAgICAgIG91dFtvdXRPZmYgKyA1XSA9IDA7CiAgICAgIG91dFtvdXRPZmYgKyA2XSA9IEZEcjsKICAgICAgb3V0W291dE9mZiArIDddID0gRkRpOwogICAgfTsKCiAgICB2YXIgRkZUJDEgPSAvKkBfX1BVUkVfXyovZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoZmZ0KTsKCiAgICBjb25zdCBCVUZGRVJFRF9CTE9DS19TSVpFID0gMjA0ODsKICAgIGZ1bmN0aW9uIGdlbkhhbm5XaW5kb3cobGVuZ3RoKSB7CiAgICAgICAgbGV0IHdpbiA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHdpbltpXSA9IDAuNSAqICgxIC0gTWF0aC5jb3MoMiAqIE1hdGguUEkgKiBpIC8gbGVuZ3RoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB3aW47CiAgICB9CiAgICBjbGFzcyBQaGFzZVZvY29kZXJQcm9jZXNzb3IgZXh0ZW5kcyBPTEFQcm9jZXNzb3IgewogICAgICAgIGZmdFNpemU7CiAgICAgICAgdGltZUN1cnNvcjsKICAgICAgICBoYW5uV2luZG93OwogICAgICAgIGZmdDsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlcjsKICAgICAgICBmcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ7CiAgICAgICAgdGltZUNvbXBsZXhCdWZmZXI7CiAgICAgICAgbWFnbml0dWRlczsKICAgICAgICBwZWFrSW5kZXhlczsKICAgICAgICBuYlBlYWtzOwogICAgICAgIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwaXRjaEZhY3RvcicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAxLjAKICAgICAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHJvY2Vzc29yT3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgIGJsb2NrU2l6ZTogQlVGRkVSRURfQkxPQ0tfU0laRSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3VwZXIob3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuZmZ0U2l6ZSA9IHRoaXMuYmxvY2tTaXplOwogICAgICAgICAgICB0aGlzLnRpbWVDdXJzb3IgPSAwOwogICAgICAgICAgICB0aGlzLmhhbm5XaW5kb3cgPSBnZW5IYW5uV2luZG93KHRoaXMuYmxvY2tTaXplKTsKICAgICAgICAgICAgLy8gcHJlcGFyZSBGRlQgYW5kIHByZS1hbGxvY2F0ZSBidWZmZXJzCiAgICAgICAgICAgIHRoaXMuZmZ0ID0gbmV3IEZGVCQxKHRoaXMuZmZ0U2l6ZSk7CiAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQgPSB0aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKTsKICAgICAgICAgICAgdGhpcy50aW1lQ29tcGxleEJ1ZmZlciA9IHRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpOwogICAgICAgICAgICB0aGlzLm1hZ25pdHVkZXMgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZSAvIDIgKyAxKTsKICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlcyA9IG5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpOwogICAgICAgICAgICB0aGlzLm5iUGVha3MgPSAwOwogICAgICAgIH0KICAgICAgICBwcm9jZXNzT0xBKGlucHV0cywgb3V0cHV0cywgcGFyYW1ldGVycykgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gcGFyYW1ldGVycy5waXRjaEZhY3RvcltwYXJhbWV0ZXJzLnBpdGNoRmFjdG9yLmxlbmd0aCAtIDFdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmJJbnB1dHM7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnB1dHNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IG91dHB1dHNbaV1bal07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseUhhbm5XaW5kb3coaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlciwgaW5wdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHV0ZU1hZ25pdHVkZXMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRQZWFrcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnRQZWFrcyhwaXRjaEZhY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLCBvdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIYW5uV2luZG93KG91dHB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50aW1lQ3Vyc29yICs9IHRoaXMuaG9wU2l6ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGFwcGx5SGFubldpbmRvdyhpbnB1dCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmxvY2tTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGlucHV0W2ldICo9IHRoaXMuaGFubldpbmRvd1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21wdXRlTWFnbml0dWRlcygpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdGhpcy5tYWduaXR1ZGVzLmxlbmd0aDsgaSsrLCBqICs9IDIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2pdOwogICAgICAgICAgICAgICAgY29uc3QgaW1hZyA9IHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbaiArIDFdOwogICAgICAgICAgICAgICAgdGhpcy5tYWduaXR1ZGVzW2ldID0gcmVhbCAqKiAyICsgaW1hZyAqKiAyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmRQZWFrcygpIHsKICAgICAgICAgICAgdGhpcy5uYlBlYWtzID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGVuZCA9IHRoaXMubWFnbml0dWRlcy5sZW5ndGggLSAyOyBpIDwgZW5kOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hZyA9IHRoaXMubWFnbml0dWRlc1tpXTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hZ25pdHVkZXNbaSAtIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSAtIDJdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDFdID49IG1hZyB8fCB0aGlzLm1hZ25pdHVkZXNbaSArIDJdID49IG1hZykgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3MrK10gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNoaWZ0UGVha3MocGl0Y2hGYWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQuZmlsbCgwKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUGVha3M7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcGVha0luZGV4ID0gdGhpcy5wZWFrSW5kZXhlc1tpXTsKICAgICAgICAgICAgICAgIGNvbnN0IHBlYWtJbmRleFNoaWZ0ZWQgPSBNYXRoLnJvdW5kKHBlYWtJbmRleCAqIHBpdGNoRmFjdG9yKTsKICAgICAgICAgICAgICAgIGlmIChwZWFrSW5kZXhTaGlmdGVkID4gdGhpcy5tYWduaXR1ZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAoaSA+IDApID8gcGVha0luZGV4IC0gTWF0aC5mbG9vcigocGVha0luZGV4IC0gdGhpcy5wZWFrSW5kZXhlc1tpIC0gMV0pIC8gMikgOiAwOwogICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gKGkgPCB0aGlzLm5iUGVha3MgLSAxKSA/IHBlYWtJbmRleCArIE1hdGguY2VpbCgodGhpcy5wZWFrSW5kZXhlc1tpICsgMV0gLSBwZWFrSW5kZXgpIC8gMikgOiB0aGlzLmZmdFNpemU7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRJbmRleCAtIHBlYWtJbmRleDsgaiA8IGVuZEluZGV4IC0gcGVha0luZGV4OyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiaW5JbmRleCA9IHBlYWtJbmRleCArIGo7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmluSW5kZXhTaGlmdGVkID0gcGVha0luZGV4U2hpZnRlZCArIGo7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJpbkluZGV4U2hpZnRlZCA+PSB0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBvbWVnYURlbHRhID0gMiAqIE1hdGguUEkgKiAoYmluSW5kZXhTaGlmdGVkIC0gYmluSW5kZXgpIC8gdGhpcy5mZnRTaXplOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBoYXNlU2hpZnRSZWFsID0gTWF0aC5jb3Mob21lZ2FEZWx0YSAqIHRoaXMudGltZUN1cnNvcik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2VTaGlmdEltYWcgPSBNYXRoLnNpbihvbWVnYURlbHRhICogdGhpcy50aW1lQ3Vyc29yKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleFJlYWwgPSBiaW5JbmRleCAqIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhJbWFnID0gaW5kZXhSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZVJlYWwgPSB0aGlzLmZyZXFDb21wbGV4QnVmZmVyW2luZGV4UmVhbF07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVJbWFnID0gdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltpbmRleEltYWddOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZFJlYWwgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0UmVhbCAtIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRJbWFnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlU2hpZnRlZEltYWcgPSB2YWx1ZVJlYWwgKiBwaGFzZVNoaWZ0SW1hZyArIHZhbHVlSW1hZyAqIHBoYXNlU2hpZnRSZWFsOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZFJlYWwgPSBiaW5JbmRleFNoaWZ0ZWQgKiAyOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4U2hpZnRlZEltYWcgPSBpbmRleFNoaWZ0ZWRSZWFsICsgMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtpbmRleFNoaWZ0ZWRSZWFsXSArPSB2YWx1ZVNoaWZ0ZWRSZWFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkW2luZGV4U2hpZnRlZEltYWddICs9IHZhbHVlU2hpZnRlZEltYWc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvLyBAdHMtaWdub3JlCiAgICByZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2RlciIsIFBoYXNlVm9jb2RlclByb2Nlc3Nvcik7CiAgICBjb25zb2xlLmxvZygiUGhhc2VWb2NvZGVyUHJvY2Vzc29yIHJlZ2lzdGVyZWQiKTsKCiAgICBleHBvcnRzLlBoYXNlVm9jb2RlclByb2Nlc3NvciA9IFBoYXNlVm9jb2RlclByb2Nlc3NvcjsKCiAgICByZXR1cm4gZXhwb3J0czsKCn0pKHt9KTsK";var JP=(e=>(e.HTML="HTML",e.Streaming="Streaming",e.Buffer="Buffer",e))(JP||{});let Y9=class{constructor(t){V(this,"context");V(this,"globalGainNode");V(this,"listener");V(this,"prevVolume",1);V(this,"finalizationRegistry");V(this,"createOscillator",({frequency:t,type:n,periodicWave:r})=>{const i=this.context.createOscillator();return i.type=n||"sine",i.setPeriodicWave(r),i.frequency.value=t,i.connect(this.globalGainNode),i});this.context=t||new U9,this.listener=this.context.listener,this.globalGainNode=this.context.createGain(),this.globalGainNode.connect(this.context.destination),this.finalizationRegistry=new FinalizationRegistry(n=>{n.cleanup()})}async loadWorklets(){this.context.audioWorklet?await this.createWorkletNode("phase-vocoder",J9):console.warn("AudioWorklet not supported")}async createWorkletNode(t,n){if(!this.context.audioWorklet)throw new Error("AudioWorklet not supported");try{return new U1(this.context,t)}catch(r){console.error(r),console.log("Loading worklet from url",n);try{await this.context.audioWorklet.addModule(n)}catch(i){throw console.error(i),new Error(`Could not load worklet from url ${n}`)}return new U1(this.context,t)}}async createSound(t,n="Buffer"){if(t instanceof AudioBuffer)return Promise.resolve(new sp("",t,this.context,this.globalGainNode,"Buffer"));const r=t;if(n==="HTML"){const i=new Audio;return i.src=r,i.crossOrigin="anonymous",new sp(r,void 0,this.context,this.globalGainNode,"HTML")}return KP.getAudioBuffer(r,this.context).then(i=>new sp(r,i,this.context,this.globalGainNode,n))}async createGroup(t){const n=new V1;return t.forEach(r=>n.addSound(r)),n}async createGroupFromUrls(t){const n=new V1;return(await Promise.all(t.map(r=>this.createSound(r)))).forEach(r=>n.addSound(r)),n}async createStream(t){return await K9(t,this.context),new sp(t,void 0,this.context,this.globalGainNode,"Streaming")}createBiquadFilter({type:t,frequency:n,gain:r,Q:i}){const s=this.context.createBiquadFilter();return s.type=t||"lowpass",s.frequency.value=n||350,s.gain.value=r||0,s.Q.value=i||1,s}createPanner({coneInnerAngle:t,coneOuterAngle:n,coneOuterGain:r,distanceModel:i,maxDistance:s,channelCount:o,channelCountMode:a,channelInterpretation:c,panningModel:l,refDistance:u,rolloffFactor:d,positionX:f,positionY:h,positionZ:p,orientationX:m,orientationY:y,orientationZ:g}){const v=this.context.createPanner();return v.coneInnerAngle=t||360,v.coneOuterAngle=n||360,v.coneOuterGain=r||0,v.distanceModel=i||"inverse",v.maxDistance=s||1e4,v.channelCount=o||2,v.channelCountMode=a||"clamped-max",v.channelInterpretation=c||"speakers",v.panningModel=l||"HRTF",v.refDistance=u||1,v.rolloffFactor=d||1,v.positionX.value=f||0,v.positionY.value=h||0,v.positionZ.value=p||0,v.orientationX.value=m||0,v.orientationY.value=y||0,v.orientationZ.value=g||0,v}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}setGlobalVolume(t){this.globalGainNode.gain.value=t}get volume(){return this.globalGainNode.gain.value}set volume(t){if(this.muted){this.prevVolume=t;return}this.setGlobalVolume(t)}mute(){this.muted||(this.prevVolume=this.globalGainNode.gain.value,this.setGlobalVolume(0))}unmute(){this.muted&&this.setGlobalVolume(this.prevVolume)}get muted(){return this.globalGainNode.gain.value===0}set muted(t){t!==this.muted&&(t?this.mute():this.unmute())}getMicrophoneStream(){return new Promise((t,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{const i=new eH(this.context);i.play(),t(i)}).catch(r=>{n(r)})})}get listenerOrientation(){return{forward:[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value],up:[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}}set listenerOrientation(t){const{forward:n,up:r}=t,[i,s,o]=n,[a,c,l]=r;this.listener.forwardX.setValueAtTime(i,this.context.currentTime),this.listener.forwardY.setValueAtTime(s,this.context.currentTime),this.listener.forwardZ.setValueAtTime(o,this.context.currentTime),this.listener.upX.setValueAtTime(a,this.context.currentTime),this.listener.upY.setValueAtTime(c,this.context.currentTime),this.listener.upZ.setValueAtTime(l,this.context.currentTime)}get listenerUpOrientation(){return[this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}set listenerUpOrientation(t){const[n,r,i]=t;this.listener.upX.setValueAtTime(n,this.context.currentTime),this.listener.upY.setValueAtTime(r,this.context.currentTime),this.listener.upZ.setValueAtTime(i,this.context.currentTime)}get listenerForwardOrientation(){return[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value]}set listenerForwardOrientation(t){const[n,r,i]=t;this.listener.forwardX.setValueAtTime(n,this.context.currentTime),this.listener.forwardY.setValueAtTime(r,this.context.currentTime),this.listener.forwardZ.setValueAtTime(i,this.context.currentTime)}get listenerPosition(){return[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}set listenerPosition(t){const[n,r,i]=t;this.listener.positionX.setValueAtTime(n,this.context.currentTime),this.listener.positionY.setValueAtTime(r,this.context.currentTime),this.listener.positionZ.setValueAtTime(i,this.context.currentTime)}},ov=class{constructor(){V(this,"filters",[])}addFilter(t){this.filters.push(t)}removeFilter(t){this.filters=this.filters.filter(n=>n!==t)}applyFilters(t){return this.filters.reduce((n,r)=>(n.connect(r),r),t),this.filters.length>0?this.filters[this.filters.length-1]:t}},sp=class YP extends ov{constructor(n,r,i,s,o="Buffer"){super();V(this,"buffer");V(this,"context");V(this,"playbacks",[]);V(this,"globalGainNode");V(this,"_position",[0,0,0]);V(this,"_threeDOptions",{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",panningModel:"HRTF",refDistance:1,rolloffFactor:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0});V(this,"loopCount",0);V(this,"_playbackRate",1);V(this,"_volume",1);this.url=n,this.type=o,this.buffer=r,this.context=i,this.globalGainNode=s,this._position=[0,0,0]}clone(){const n=new YP(this.url,this.buffer,this.context,this.globalGainNode,this.type);return n.loopCount=this.loopCount,n._playbackRate=this._playbackRate,n._volume=this._volume,n._position=this._position,n._threeDOptions=this._threeDOptions,n.filters=this.filters,n}preplay(){let n;if(this.buffer)n=this.context.createBufferSource(),n.buffer=this.buffer;else{const s=new Audio;s.crossOrigin="anonymous",s.src=this.url,s.preload="auto",n=this.context.createMediaElementSource(s)}const r=this.context.createGain();r.connect(this.globalGainNode);const i=new q9(n,r,this.context,this.loopCount);return i.volume=this.volume,i.playbackRate=this.playbackRate,this.filters.forEach(s=>i.addFilter(s)),i.threeDOptions=this.threeDOptions,i.position=this.position,this.playbacks.push(i),[i]}play(){const n=this.preplay();return n.forEach(r=>r.play()),n}stop(){this.playbacks.forEach(n=>n.stop())}pause(){"suspend"in this.context&&this.context.suspend()}resume(){"resume"in this.context&&this.context.resume()}seek(n){this.playbacks.forEach(r=>r.seek(n))}get duration(){var n;return((n=this.buffer)==null?void 0:n.duration)||0}set position(n){this._threeDOptions.positionX=n[0],this._threeDOptions.positionY=n[1],this._threeDOptions.positionZ=n[2],this.playbacks.forEach(r=>r.position=n)}get position(){return[this._threeDOptions.positionX,this._threeDOptions.positionY,this._threeDOptions.positionZ]}get threeDOptions(){return this._threeDOptions}set threeDOptions(n){this._threeDOptions={...this._threeDOptions,...n},this.playbacks.forEach(r=>r.threeDOptions=this._threeDOptions)}loop(n){return n===void 0?this.loopCount:(this.loopCount=n,this.playbacks.forEach(r=>r.sourceLoop=!0),this.loopCount)}addFilter(n){super.addFilter(n),this.playbacks.forEach(r=>r.addFilter(n))}removeFilter(n){super.removeFilter(n),this.playbacks.forEach(r=>r.removeFilter(n))}get volume(){return this._volume}set volume(n){this._volume=n,this.playbacks.forEach(r=>r.volume=n)}isPlaying(){return this.playbacks.some(n=>n.isPlaying())}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.playbacks.forEach(r=>r.playbackRate=n)}},q9=class extends ov{constructor(n,r,i,s=0){super();V(this,"context");V(this,"source");V(this,"gainNode");V(this,"panner");V(this,"loopCount",0);V(this,"currentLoop",0);V(this,"buffer");V(this,"playing",!1);this.loopCount=s,this.source=n,"buffer"in n&&n.buffer&&(this.buffer=n.buffer),"mediaElement"in n&&n.mediaElement?n.mediaElement.onended=this.handleLoop.bind(this):"onended"in n&&(n.onended=this.handleLoop.bind(this)),this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner),this.panner.connect(this.gainNode),this.refreshFilters()}get duration(){if(!this.buffer)throw new Error("Cannot get duration of a sound that has been cleaned up");return this.buffer.duration}get playbackRate(){if(!this.source)throw new Error("Cannot get playback rate of a sound that has been cleaned up");if("playbackRate"in this.source)return this.source.playbackRate.value;if("mediaElement"in this.source&&this.source.mediaElement)return this.source.mediaElement.playbackRate;throw new Error("Unsupported source type")}set playbackRate(n){if(!this.source)throw new Error("Cannot set playback rate of a sound that has been cleaned up");"playbackRate"in this.source&&(this.source.playbackRate.value=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.playbackRate=n)}handleLoop(){this.buffer?(this.source=this.context.createBufferSource(),this.source.buffer=this.buffer):this.seek(0),this.loopCount==="infinite"||this.currentLoop<this.loopCount?(this.currentLoop++,this.playing&&this.play()):this.playing=!1}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return"mediaElement"in this.source&&this.source.mediaElement?this.source.mediaElement.play():"start"in this.source&&this.source.start&&this.source.start(),this.playing=!0,[this]}get threeDOptions(){if(!this.panner)throw new Error("Cannot get 3D options of a sound that has been cleaned up");return{coneInnerAngle:this.panner.coneInnerAngle,coneOuterAngle:this.panner.coneOuterAngle,coneOuterGain:this.panner.coneOuterGain,distanceModel:this.panner.distanceModel,maxDistance:this.panner.maxDistance,channelCount:this.panner.channelCount,channelCountMode:this.panner.channelCountMode,channelInterpretation:this.panner.channelInterpretation,panningModel:this.panner.panningModel,refDistance:this.panner.refDistance,rolloffFactor:this.panner.rolloffFactor,positionX:this.panner.positionX.value,positionY:this.panner.positionY.value,positionZ:this.panner.positionZ.value,orientationX:this.panner.orientationX.value,orientationY:this.panner.orientationY.value,orientationZ:this.panner.orientationZ.value}}set threeDOptions(n){if(!this.panner)throw new Error("Cannot set 3D options of a sound that has been cleaned up");this.panner.coneInnerAngle=n.coneInnerAngle||this.panner.coneInnerAngle,this.panner.coneOuterAngle=n.coneOuterAngle||this.panner.coneOuterAngle,this.panner.coneOuterGain=n.coneOuterGain||this.panner.coneOuterGain,this.panner.distanceModel=n.distanceModel||this.panner.distanceModel,this.panner.maxDistance=n.maxDistance||this.panner.maxDistance,this.panner.channelCount=n.channelCount||this.panner.channelCount,this.panner.channelCountMode=n.channelCountMode||this.panner.channelCountMode,this.panner.channelInterpretation=n.channelInterpretation||this.panner.channelInterpretation,this.panner.panningModel=n.panningModel||this.panner.panningModel,this.panner.refDistance=n.refDistance||this.panner.refDistance,this.panner.rolloffFactor=n.rolloffFactor||this.panner.rolloffFactor,this.panner.positionX.value=n.positionX||this.panner.positionX.value,this.panner.positionY.value=n.positionY||this.panner.positionY.value,this.panner.positionZ.value=n.positionZ||this.panner.positionZ.value,this.panner.orientationX.value=n.orientationX||this.panner.orientationX.value,this.panner.orientationY.value=n.orientationY||this.panner.orientationY.value,this.panner.orientationZ.value=n.orientationZ||this.panner.orientationZ.value}seek(n){if(!this.source||!this.buffer||!this.gainNode||!this.panner)throw new Error("Cannot seek a sound that has been cleaned up");const r=this.isPlaying();this.stop(),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.refreshFilters(),this.source.connect(this.panner).connect(this.gainNode),r&&this.source.start(0,n)}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}set sourceLoop(n){if(!this.source)throw new Error("Cannot set loop on a sound that has been cleaned up");"loop"in this.source&&(this.source.loop=n),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.loop=n)}fadeIn(n,r="linear"){return new Promise(i=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value;const s=1;switch(this.gainNode.gain.value=0,r){case"exponential":this.gainNode.gain.setValueAtTime(.01,this.context.currentTime),this.gainNode.gain.exponentialRampToValueAtTime(s,this.context.currentTime+n);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(s,this.context.currentTime+n);break}setTimeout(()=>{if(!this.gainNode)throw new Error("Cannot fade in a sound that has been cleaned up");this.gainNode.gain.value=s,i()},n*1e3)})}fadeOut(n,r="linear"){return new Promise(i=>{if(!this.gainNode)throw new Error("Cannot fade out a sound that has been cleaned up");switch(this.gainNode.gain.value,r){case"exponential":this.gainNode.gain.exponentialRampToValueAtTime(.01,this.context.currentTime+n);break;case"linear":this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+n)}setTimeout(()=>i(),n*1e3)})}isPlaying(){if(!this.source)throw new Error("Cannot check if a sound is playing that has been cleaned up");return this.playing}cleanup(){this.source&&(this.source.disconnect(),this.source=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0),this.filters.forEach(n=>{n&&n.disconnect()}),this.filters=[]}loop(n){var r;if(!this.source)throw new Error("Cannot loop a sound that has been cleaned up");if(this.source instanceof AudioBufferSourceNode)return n===void 0?this.source.loop===!0?"infinite":0:(this.source.loop=!0,this.source.loopEnd=((r=this.source.buffer)==null?void 0:r.duration)||0,this.source.loopStart=0,this.source.loop===!0?"infinite":0);if("mediaElement"in this.source&&this.source.mediaElement){const i=this.source.mediaElement;return n===void 0||(i.loop=!0),i.loop===!0?"infinite":0}throw new Error("Unsupported source type")}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.isPlaying()&&("stop"in this.source&&this.source.stop(),"mediaElement"in this.source&&this.source.mediaElement&&(this.source.mediaElement.pause(),this.source.mediaElement.currentTime=0),this.playing=!1)}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");"suspend"in this.source.context&&this.source.context.suspend()}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");"resume"in this.source.context&&this.source.context.resume()}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,s]=n;this.panner.positionX.setValueAtTime(r,this.context.currentTime),this.panner.positionY.setValueAtTime(i,this.context.currentTime),this.panner.positionZ.setValueAtTime(s,this.context.currentTime)}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.panner||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.panner;n.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}},V1=class{constructor(){V(this,"sounds",[]);V(this,"_position",[0,0,0]);V(this,"loopCount",0)}get duration(){return this.sounds.map(t=>t.duration).reduce((t,n)=>Math.max(t,n),0)}seek(t){this.sounds.forEach(n=>n.seek&&n.seek(t))}addSound(t){this.sounds.push(t)}preplay(){return this.sounds.reduce((t,n)=>(n.loop&&n.loop(this.loopCount),t.concat(n.preplay())),[])}play(){return this.preplay().map(t=>(t.play(),t))}isPlaying(){return this.sounds.some(t=>t.isPlaying())}stop(){this.sounds.forEach(t=>t.stop())}pause(){this.sounds.forEach(t=>t.pause())}resume(){this.sounds.forEach(t=>t.resume())}loop(t){return t===void 0?this.loopCount:(this.loopCount=t,this.sounds.forEach(n=>n.loop&&n.loop(t)),this.loopCount)}addFilter(t){this.sounds.forEach(n=>n.addFilter(t))}removeFilter(t){this.sounds.forEach(n=>n.removeFilter(t))}set position(t){this._position=t,this.sounds.forEach(n=>n.position=this._position)}get position(){return this._position}get volume(){return this.sounds.map(t=>t.volume).reduce((t,n)=>t+n,0)/this.sounds.length}set volume(t){this.sounds.forEach(n=>n.volume=t)}get playbackRate(){return this.sounds.length===0?1:this.sounds[0].playbackRate}set playbackRate(t){this.sounds.forEach(n=>n.playbackRate=t)}};class Q9 extends ov{constructor(n,r,i,s=0){super();V(this,"context");V(this,"source");V(this,"gainNode");V(this,"panner");this.source=n,this.gainNode=r,this.context=i,this.panner=i.createPanner(),n.connect(this.panner).connect(this.gainNode),this.refreshFilters()}get duration(){return 0}play(){if(!this.source)throw new Error("Cannot play a sound that has been cleaned up");return[this]}isPlaying(){return!!this.source}get volume(){if(!this.gainNode)throw new Error("Cannot get volume of a sound that has been cleaned up");return this.gainNode.gain.value}set volume(n){if(!this.gainNode)throw new Error("Cannot set volume of a sound that has been cleaned up");this.gainNode.gain.value=n}stop(){if(!this.source)throw new Error("Cannot stop a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.stop())}pause(){if(!this.source)throw new Error("Cannot pause a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!1)}resume(){if(!this.source)throw new Error("Cannot resume a sound that has been cleaned up");this.source.mediaStream.getTracks().forEach(n=>n.enabled=!0)}addFilter(n){super.addFilter(n),this.refreshFilters()}removeFilter(n){super.removeFilter(n),this.refreshFilters()}set position(n){if(!this.panner)throw new Error("Cannot move a sound that has been cleaned up");const[r,i,s]=n;this.panner.positionX.value=r,this.panner.positionY.value=i,this.panner.positionZ.value=s}get position(){if(!this.panner)throw new Error("Cannot get position of a sound that has been cleaned up");return[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}refreshFilters(){if(!this.source||!this.gainNode)throw new Error("Cannot update filters on a sound that has been cleaned up");let n=this.source;this.source.disconnect(),n=this.applyFilters(n),n.connect(this.gainNode)}get playbackRate(){return 1}set playbackRate(n){}}let eH=class extends ov{constructor(n){super();V(this,"context");V(this,"_position",[0,0,0]);V(this,"loopCount",0);V(this,"prevVolume",1);V(this,"microphoneGainNode");V(this,"streamPlayback");V(this,"stream");V(this,"streamSource");this.context=n,this.microphoneGainNode=this.context.createGain()}play(){return this.stream||navigator.mediaDevices.getUserMedia({audio:!0}).then(n=>{this.stream=n,this.streamSource=this.context.createMediaStreamSource(this.stream),this.streamPlayback=new Q9(this.streamSource,this.microphoneGainNode,this.context),this.streamPlayback.play()}).catch(n=>{console.error("Error initializing microphone stream:",n)}),this.streamPlayback?[this.streamPlayback]:[]}get duration(){return 0}seek(n){}isPlaying(){return!!this.streamPlayback}stop(){this.streamPlayback&&(this.streamPlayback.stop(),this.streamPlayback=void 0)}pause(){this.streamPlayback&&this.streamPlayback.pause()}resume(){this.streamPlayback&&this.streamPlayback.resume()}addFilter(n){this.streamPlayback&&this.streamPlayback.addFilter(n)}removeFilter(n){this.streamPlayback&&this.streamPlayback.removeFilter(n)}get volume(){return this.streamPlayback?this.streamPlayback.volume:0}set volume(n){this.streamPlayback&&(this.streamPlayback.volume=n)}get position(){return[0,0,0]}set position(n){}loop(n){return 0}get playbackRate(){return 1}set playbackRate(n){}};const tH="https://mongoose.world:9080/?url=";class nH extends Ko{constructor(){super(...arguments);V(this,"packageName","Client.Media");V(this,"sounds",{});V(this,"defaultUrl","")}handleDefault(n){this.defaultUrl=n}async handleLoad(n){const r=(n.url||this.defaultUrl)+n.name,i=n.url+n.name;if(!this.sounds[i]){let o=await this.client.cacophony.createSound(r);o.key=i,this.sounds[i]=o}}mediaUrl(n){var i;let r=(n.url||this.defaultUrl)+n.name;return((i=n.type)==null?void 0:i.toLowerCase())==="music"&&(r=tH+encodeURIComponent(r)),r}async handlePlay(n){let r=this.mediaUrl(n);n.key=n.key||r;let i=this.sounds[n.key];if((!i||i.url!==r)&&(n.type==="music"?i=await this.client.cacophony.createSound(r,JP.HTML):i=await this.client.cacophony.createSound(r)),n.volume!==void 0&&(i.volume=n.volume/100),n.loops!==void 0&&i.loop&&i.loop(n.loops===-1?"infinite":n.loops),n.start&&i.seek(n.start),n.end&&setTimeout(()=>{delete this.sounds[i.key],delete this.sounds[i.key],delete this.sounds[i.key],delete this.sounds[i.key],delete this.sounds[i.key],i.stop()},n.end),n.is3d&&(i.threeDOptions={coneInnerAngle:360,coneOuterAngle:0,panningModel:"HRTF",distanceModel:"inverse"},i.position=[n.position[0],n.position[1],n.position[2]]),n.priority){for(let s in this.sounds){const o=this.sounds[s];o.priority&&o.priority<n.priority&&o.stop()}i.priority=n.priority}if(!i.isPlaying()){const s=i.play()[0];n.fadein&&s.fadeIn(n.fadein),n.fadeout&&s.fadeOut(n.fadeout)}this.sounds[n.key]=i,i.key=n.key}handleStop(n){n.name&&this.soundsByName(n.name).forEach(r=>r.stop()),n.type&&this.soundsByType(n.type).forEach(r=>r.stop()),n.tag&&this.soundsByTag(n.tag).forEach(r=>r.stop()),n.key&&this.soundsByKey(n.key).forEach(r=>r.stop()),!n.name&&!n.type&&!n.tag&&!n.key&&this.allSounds.forEach(r=>r.stop())}handleListenerPosition(n){var r;(r=n.position)!=null&&r.length&&(this.client.cacophony.listenerPosition=n.position)}handleListenerOrientation(n){n.up&&n.up.length&&(this.client.cacophony.listenerUpOrientation=n.up),n.forward&&n.forward.length&&(this.client.cacophony.listenerForwardOrientation=n.forward)}soundsByName(n){return Object.values(this.sounds).filter(r=>r.url&&r.url[r.url.length-1].endsWith(n))}soundsByKey(n){return Object.values(this.sounds).filter(r=>r.key===n)}soundsByTag(n){return Object.values(this.sounds).filter(r=>r.tag===n)}soundsByType(n){return Object.values(this.sounds).filter(r=>r.mediaType===n)}get allSounds(){return Object.values(this.sounds)}stopAllSounds(){this.allSounds.forEach(n=>n.stop()),this.sounds={}}}class rH extends Ko{constructor(){super(...arguments);V(this,"packageName","Client.Speech")}handleSpeak(n){const r=new SpeechSynthesisUtterance(n.text);r.rate=n.rate,r.pitch=n.pitch,r.volume=n.volume,speechSynthesis.speak(r)}}class iH extends Ko{constructor(){super(...arguments);V(this,"packageName","Comm.Channel");V(this,"channels",[])}handleList(n){this.channels=n}sendList(){this.sendData("List")}handleText(n){n.channel==="say_to_you"&&(document.hasFocus()||this.client.sendNotification(`Message from ${n.talker}`,`${n.text}`))}}class sH extends Ko{constructor(){super(...arguments);V(this,"packageName","Comm.LiveKit")}handleroom_token(n){this.client.worldData.liveKitTokens.push(n.token),this.client.emit("livekitToken",n.token)}handleroom_leave(n){this.client.worldData.liveKitTokens=this.client.worldData.liveKitTokens.filter(r=>r!==n.token),this.client.emit("livekitLeave",n.token)}}class oH extends Ko{constructor(){super(...arguments);V(this,"packageName","Core")}sendHello(){this.sendData("Hello",{client:"Mongoose Client",version:"0.1"})}}class aH extends Ko{constructor(){super(...arguments);V(this,"packageName","Core.Supports")}sendSet(){const n=Object.values(this.client.gmcpHandlers).map(r=>r.packageName+" "+r.packageVersion.toString());this.sendData("Set",n)}}const ml=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,qP=new Set,VC=typeof process=="object"&&process?process:{},QP=(e,t,n,r)=>{typeof VC.emitWarning=="function"?VC.emitWarning(e,t,n,r):console.error(`[${n}] ${t}: ${e}`)};let em=globalThis.AbortController,G1=globalThis.AbortSignal;var I_;if(typeof em>"u"){G1=class{constructor(){V(this,"onabort");V(this,"_onabort",[]);V(this,"reason");V(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},em=class{constructor(){V(this,"signal",new G1);t()}abort(r){var i,s;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const o of this.signal._onabort)o(r);(s=(i=this.signal).onabort)==null||s.call(i,r)}}};let e=((I_=VC.env)==null?void 0:I_.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const t=()=>{e&&(e=!1,QP("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}const cH=e=>!qP.has(e),aa=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),eM=e=>aa(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?zp:null:null;class zp extends Array{constructor(t){super(t),this.fill(0)}}var gu;const vc=class vc{constructor(t,n){V(this,"heap");V(this,"length");if(!M(vc,gu))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(t),this.length=0}static create(t){const n=eM(t);if(!n)return[];Ae(vc,gu,!0);const r=new vc(t,n);return Ae(vc,gu,!1),r}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}};gu=new WeakMap,De(vc,gu,!1);let GC=vc;var Ei,Fr,Ti,_i,mu,ln,Ri,on,Nt,Ne,rr,Ur,Kn,kn,xi,An,Ni,Pi,Vr,Mi,Ia,ir,rh,jC,Ec,no,ih,Gr,xm,tM,Tc,vu,sh,us,ca,ds,la,oh,HC,coe,yu,Zp,Cu,Xp,gt,xt,ah,$C,_c,Wd;const Qw=class Qw{constructor(t){De(this,rh);De(this,xm);De(this,us);De(this,ds);De(this,oh);De(this,yu);De(this,Cu);De(this,gt);De(this,ah);De(this,_c);De(this,Ei,void 0);De(this,Fr,void 0);De(this,Ti,void 0);De(this,_i,void 0);De(this,mu,void 0);V(this,"ttl");V(this,"ttlResolution");V(this,"ttlAutopurge");V(this,"updateAgeOnGet");V(this,"updateAgeOnHas");V(this,"allowStale");V(this,"noDisposeOnSet");V(this,"noUpdateTTL");V(this,"maxEntrySize");V(this,"sizeCalculation");V(this,"noDeleteOnFetchRejection");V(this,"noDeleteOnStaleGet");V(this,"allowStaleOnFetchAbort");V(this,"allowStaleOnFetchRejection");V(this,"ignoreFetchAbort");De(this,ln,void 0);De(this,Ri,void 0);De(this,on,void 0);De(this,Nt,void 0);De(this,Ne,void 0);De(this,rr,void 0);De(this,Ur,void 0);De(this,Kn,void 0);De(this,kn,void 0);De(this,xi,void 0);De(this,An,void 0);De(this,Ni,void 0);De(this,Pi,void 0);De(this,Vr,void 0);De(this,Mi,void 0);De(this,Ia,void 0);De(this,ir,void 0);De(this,Ec,()=>{});De(this,no,()=>{});De(this,ih,()=>{});De(this,Gr,()=>!1);De(this,Tc,t=>{});De(this,vu,(t,n,r)=>{});De(this,sh,(t,n,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});V(this,coe,"LRUCache");const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:s,updateAgeOnGet:o,updateAgeOnHas:a,allowStale:c,dispose:l,disposeAfter:u,noDisposeOnSet:d,noUpdateTTL:f,maxSize:h=0,maxEntrySize:p=0,sizeCalculation:m,fetchMethod:y,noDeleteOnFetchRejection:g,noDeleteOnStaleGet:v,allowStaleOnFetchRejection:S,allowStaleOnFetchAbort:E,ignoreFetchAbort:k}=t;if(n!==0&&!aa(n))throw new TypeError("max option must be a nonnegative integer");const b=n?eM(n):Array;if(!b)throw new Error("invalid max value: "+n);if(Ae(this,Ei,n),Ae(this,Fr,h),this.maxEntrySize=p||M(this,Fr),this.sizeCalculation=m,this.sizeCalculation){if(!M(this,Fr)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(y!==void 0&&typeof y!="function")throw new TypeError("fetchMethod must be a function if specified");if(Ae(this,mu,y),Ae(this,Ia,!!y),Ae(this,on,new Map),Ae(this,Nt,new Array(n).fill(void 0)),Ae(this,Ne,new Array(n).fill(void 0)),Ae(this,rr,new b(n)),Ae(this,Ur,new b(n)),Ae(this,Kn,0),Ae(this,kn,0),Ae(this,xi,GC.create(n)),Ae(this,ln,0),Ae(this,Ri,0),typeof l=="function"&&Ae(this,Ti,l),typeof u=="function"?(Ae(this,_i,u),Ae(this,An,[])):(Ae(this,_i,void 0),Ae(this,An,void 0)),Ae(this,Mi,!!M(this,Ti)),Ae(this,ir,!!M(this,_i)),this.noDisposeOnSet=!!d,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!g,this.allowStaleOnFetchRejection=!!S,this.allowStaleOnFetchAbort=!!E,this.ignoreFetchAbort=!!k,this.maxEntrySize!==0){if(M(this,Fr)!==0&&!aa(M(this,Fr)))throw new TypeError("maxSize must be a positive integer if specified");if(!aa(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Se(this,xm,tM).call(this)}if(this.allowStale=!!c,this.noDeleteOnStaleGet=!!v,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!a,this.ttlResolution=aa(i)||i===0?i:1,this.ttlAutopurge=!!s,this.ttl=r||0,this.ttl){if(!aa(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Se(this,rh,jC).call(this)}if(M(this,Ei)===0&&this.ttl===0&&M(this,Fr)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!M(this,Ei)&&!M(this,Fr)){const A="LRU_CACHE_UNBOUNDED";cH(A)&&(qP.add(A),QP("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",A,Qw))}}static unsafeExposeInternals(t){return{starts:M(t,Pi),ttls:M(t,Vr),sizes:M(t,Ni),keyMap:M(t,on),keyList:M(t,Nt),valList:M(t,Ne),next:M(t,rr),prev:M(t,Ur),get head(){return M(t,Kn)},get tail(){return M(t,kn)},free:M(t,xi),isBackgroundFetch:n=>{var r;return Se(r=t,gt,xt).call(r,n)},backgroundFetch:(n,r,i,s)=>{var o;return Se(o=t,Cu,Xp).call(o,n,r,i,s)},moveToTail:n=>{var r;return Se(r=t,_c,Wd).call(r,n)},indexes:n=>{var r;return Se(r=t,us,ca).call(r,n)},rindexes:n=>{var r;return Se(r=t,ds,la).call(r,n)},isStale:n=>{var r;return M(r=t,Gr).call(r,n)}}}get max(){return M(this,Ei)}get maxSize(){return M(this,Fr)}get calculatedSize(){return M(this,Ri)}get size(){return M(this,ln)}get fetchMethod(){return M(this,mu)}get dispose(){return M(this,Ti)}get disposeAfter(){return M(this,_i)}getRemainingTTL(t){return M(this,on).has(t)?1/0:0}*entries(){for(const t of Se(this,us,ca).call(this))M(this,Ne)[t]!==void 0&&M(this,Nt)[t]!==void 0&&!Se(this,gt,xt).call(this,M(this,Ne)[t])&&(yield[M(this,Nt)[t],M(this,Ne)[t]])}*rentries(){for(const t of Se(this,ds,la).call(this))M(this,Ne)[t]!==void 0&&M(this,Nt)[t]!==void 0&&!Se(this,gt,xt).call(this,M(this,Ne)[t])&&(yield[M(this,Nt)[t],M(this,Ne)[t]])}*keys(){for(const t of Se(this,us,ca).call(this)){const n=M(this,Nt)[t];n!==void 0&&!Se(this,gt,xt).call(this,M(this,Ne)[t])&&(yield n)}}*rkeys(){for(const t of Se(this,ds,la).call(this)){const n=M(this,Nt)[t];n!==void 0&&!Se(this,gt,xt).call(this,M(this,Ne)[t])&&(yield n)}}*values(){for(const t of Se(this,us,ca).call(this))M(this,Ne)[t]!==void 0&&!Se(this,gt,xt).call(this,M(this,Ne)[t])&&(yield M(this,Ne)[t])}*rvalues(){for(const t of Se(this,ds,la).call(this))M(this,Ne)[t]!==void 0&&!Se(this,gt,xt).call(this,M(this,Ne)[t])&&(yield M(this,Ne)[t])}[Symbol.iterator](){return this.entries()}find(t,n={}){for(const r of Se(this,us,ca).call(this)){const i=M(this,Ne)[r],s=Se(this,gt,xt).call(this,i)?i.__staleWhileFetching:i;if(s!==void 0&&t(s,M(this,Nt)[r],this))return this.get(M(this,Nt)[r],n)}}forEach(t,n=this){for(const r of Se(this,us,ca).call(this)){const i=M(this,Ne)[r],s=Se(this,gt,xt).call(this,i)?i.__staleWhileFetching:i;s!==void 0&&t.call(n,s,M(this,Nt)[r],this)}}rforEach(t,n=this){for(const r of Se(this,ds,la).call(this)){const i=M(this,Ne)[r],s=Se(this,gt,xt).call(this,i)?i.__staleWhileFetching:i;s!==void 0&&t.call(n,s,M(this,Nt)[r],this)}}purgeStale(){let t=!1;for(const n of Se(this,ds,la).call(this,{allowStale:!0}))M(this,Gr).call(this,n)&&(this.delete(M(this,Nt)[n]),t=!0);return t}info(t){const n=M(this,on).get(t);if(n===void 0)return;const r=M(this,Ne)[n],i=Se(this,gt,xt).call(this,r)?r.__staleWhileFetching:r;if(i===void 0)return;const s={value:i};if(M(this,Vr)&&M(this,Pi)){const o=M(this,Vr)[n],a=M(this,Pi)[n];if(o&&a){const c=o-(ml.now()-a);s.ttl=c,s.start=Date.now()}}return M(this,Ni)&&(s.size=M(this,Ni)[n]),s}dump(){const t=[];for(const n of Se(this,us,ca).call(this,{allowStale:!0})){const r=M(this,Nt)[n],i=M(this,Ne)[n],s=Se(this,gt,xt).call(this,i)?i.__staleWhileFetching:i;if(s===void 0||r===void 0)continue;const o={value:s};if(M(this,Vr)&&M(this,Pi)){o.ttl=M(this,Vr)[n];const a=ml.now()-M(this,Pi)[n];o.start=Math.floor(Date.now()-a)}M(this,Ni)&&(o.size=M(this,Ni)[n]),t.unshift([r,o])}return t}load(t){this.clear();for(const[n,r]of t){if(r.start){const i=Date.now()-r.start;r.start=ml.now()-i}this.set(n,r.value,r)}}set(t,n,r={}){var f,h,p,m,y;if(n===void 0)return this.delete(t),this;const{ttl:i=this.ttl,start:s,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:c}=r;let{noUpdateTTL:l=this.noUpdateTTL}=r;const u=M(this,sh).call(this,t,n,r.size||0,a);if(this.maxEntrySize&&u>this.maxEntrySize)return c&&(c.set="miss",c.maxEntrySizeExceeded=!0),this.delete(t),this;let d=M(this,ln)===0?void 0:M(this,on).get(t);if(d===void 0)d=M(this,ln)===0?M(this,kn):M(this,xi).length!==0?M(this,xi).pop():M(this,ln)===M(this,Ei)?Se(this,yu,Zp).call(this,!1):M(this,ln),M(this,Nt)[d]=t,M(this,Ne)[d]=n,M(this,on).set(t,d),M(this,rr)[M(this,kn)]=d,M(this,Ur)[d]=M(this,kn),Ae(this,kn,d),Dh(this,ln)._++,M(this,vu).call(this,d,u,c),c&&(c.set="add"),l=!1;else{Se(this,_c,Wd).call(this,d);const g=M(this,Ne)[d];if(n!==g){if(M(this,Ia)&&Se(this,gt,xt).call(this,g)){g.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:v}=g;v!==void 0&&!o&&(M(this,Mi)&&((f=M(this,Ti))==null||f.call(this,v,t,"set")),M(this,ir)&&((h=M(this,An))==null||h.push([v,t,"set"])))}else o||(M(this,Mi)&&((p=M(this,Ti))==null||p.call(this,g,t,"set")),M(this,ir)&&((m=M(this,An))==null||m.push([g,t,"set"])));if(M(this,Tc).call(this,d),M(this,vu).call(this,d,u,c),M(this,Ne)[d]=n,c){c.set="replace";const v=g&&Se(this,gt,xt).call(this,g)?g.__staleWhileFetching:g;v!==void 0&&(c.oldValue=v)}}else c&&(c.set="update")}if(i!==0&&!M(this,Vr)&&Se(this,rh,jC).call(this),M(this,Vr)&&(l||M(this,ih).call(this,d,i,s),c&&M(this,no).call(this,c,d)),!o&&M(this,ir)&&M(this,An)){const g=M(this,An);let v;for(;v=g==null?void 0:g.shift();)(y=M(this,_i))==null||y.call(this,...v)}return this}pop(){var t;try{for(;M(this,ln);){const n=M(this,Ne)[M(this,Kn)];if(Se(this,yu,Zp).call(this,!0),Se(this,gt,xt).call(this,n)){if(n.__staleWhileFetching)return n.__staleWhileFetching}else if(n!==void 0)return n}}finally{if(M(this,ir)&&M(this,An)){const n=M(this,An);let r;for(;r=n==null?void 0:n.shift();)(t=M(this,_i))==null||t.call(this,...r)}}}has(t,n={}){const{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=n,s=M(this,on).get(t);if(s!==void 0){const o=M(this,Ne)[s];if(Se(this,gt,xt).call(this,o)&&o.__staleWhileFetching===void 0)return!1;if(M(this,Gr).call(this,s))i&&(i.has="stale",M(this,no).call(this,i,s));else return r&&M(this,Ec).call(this,s),i&&(i.has="hit",M(this,no).call(this,i,s)),!0}else i&&(i.has="miss");return!1}peek(t,n={}){const{allowStale:r=this.allowStale}=n,i=M(this,on).get(t);if(i===void 0||!r&&M(this,Gr).call(this,i))return;const s=M(this,Ne)[i];return Se(this,gt,xt).call(this,s)?s.__staleWhileFetching:s}async fetch(t,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:m,forceRefresh:y=!1,status:g,signal:v}=n;if(!M(this,Ia))return g&&(g.fetch="get"),this.get(t,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:s,status:g});const S={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:s,ttl:o,noDisposeOnSet:a,size:c,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:p,ignoreFetchAbort:h,status:g,signal:v};let E=M(this,on).get(t);if(E===void 0){g&&(g.fetch="miss");const k=Se(this,Cu,Xp).call(this,t,E,S,m);return k.__returned=k}else{const k=M(this,Ne)[E];if(Se(this,gt,xt).call(this,k)){const N=r&&k.__staleWhileFetching!==void 0;return g&&(g.fetch="inflight",N&&(g.returnedStale=!0)),N?k.__staleWhileFetching:k.__returned=k}const b=M(this,Gr).call(this,E);if(!y&&!b)return g&&(g.fetch="hit"),Se(this,_c,Wd).call(this,E),i&&M(this,Ec).call(this,E),g&&M(this,no).call(this,g,E),k;const A=Se(this,Cu,Xp).call(this,t,E,S,m),P=A.__staleWhileFetching!==void 0&&r;return g&&(g.fetch=b?"stale":"refresh",P&&b&&(g.returnedStale=!0)),P?A.__staleWhileFetching:A.__returned=A}}get(t,n={}){const{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:o}=n,a=M(this,on).get(t);if(a!==void 0){const c=M(this,Ne)[a],l=Se(this,gt,xt).call(this,c);return o&&M(this,no).call(this,o,a),M(this,Gr).call(this,a)?(o&&(o.get="stale"),l?(o&&r&&c.__staleWhileFetching!==void 0&&(o.returnedStale=!0),r?c.__staleWhileFetching:void 0):(s||this.delete(t),o&&r&&(o.returnedStale=!0),r?c:void 0)):(o&&(o.get="hit"),l?c.__staleWhileFetching:(Se(this,_c,Wd).call(this,a),i&&M(this,Ec).call(this,a),c))}else o&&(o.get="miss")}delete(t){var r,i,s,o;let n=!1;if(M(this,ln)!==0){const a=M(this,on).get(t);if(a!==void 0)if(n=!0,M(this,ln)===1)this.clear();else{M(this,Tc).call(this,a);const c=M(this,Ne)[a];if(Se(this,gt,xt).call(this,c)?c.__abortController.abort(new Error("deleted")):(M(this,Mi)||M(this,ir))&&(M(this,Mi)&&((r=M(this,Ti))==null||r.call(this,c,t,"delete")),M(this,ir)&&((i=M(this,An))==null||i.push([c,t,"delete"]))),M(this,on).delete(t),M(this,Nt)[a]=void 0,M(this,Ne)[a]=void 0,a===M(this,kn))Ae(this,kn,M(this,Ur)[a]);else if(a===M(this,Kn))Ae(this,Kn,M(this,rr)[a]);else{const l=M(this,Ur)[a];M(this,rr)[l]=M(this,rr)[a];const u=M(this,rr)[a];M(this,Ur)[u]=M(this,Ur)[a]}Dh(this,ln)._--,M(this,xi).push(a)}}if(M(this,ir)&&((s=M(this,An))!=null&&s.length)){const a=M(this,An);let c;for(;c=a==null?void 0:a.shift();)(o=M(this,_i))==null||o.call(this,...c)}return n}clear(){var t,n,r;for(const i of Se(this,ds,la).call(this,{allowStale:!0})){const s=M(this,Ne)[i];if(Se(this,gt,xt).call(this,s))s.__abortController.abort(new Error("deleted"));else{const o=M(this,Nt)[i];M(this,Mi)&&((t=M(this,Ti))==null||t.call(this,s,o,"delete")),M(this,ir)&&((n=M(this,An))==null||n.push([s,o,"delete"]))}}if(M(this,on).clear(),M(this,Ne).fill(void 0),M(this,Nt).fill(void 0),M(this,Vr)&&M(this,Pi)&&(M(this,Vr).fill(0),M(this,Pi).fill(0)),M(this,Ni)&&M(this,Ni).fill(0),Ae(this,Kn,0),Ae(this,kn,0),M(this,xi).length=0,Ae(this,Ri,0),Ae(this,ln,0),M(this,ir)&&M(this,An)){const i=M(this,An);let s;for(;s=i==null?void 0:i.shift();)(r=M(this,_i))==null||r.call(this,...s)}}};coe=Symbol.toStringTag,Ei=new WeakMap,Fr=new WeakMap,Ti=new WeakMap,_i=new WeakMap,mu=new WeakMap,ln=new WeakMap,Ri=new WeakMap,on=new WeakMap,Nt=new WeakMap,Ne=new WeakMap,rr=new WeakMap,Ur=new WeakMap,Kn=new WeakMap,kn=new WeakMap,xi=new WeakMap,An=new WeakMap,Ni=new WeakMap,Pi=new WeakMap,Vr=new WeakMap,Mi=new WeakMap,Ia=new WeakMap,ir=new WeakMap,rh=new WeakSet,jC=function(){const t=new zp(M(this,Ei)),n=new zp(M(this,Ei));Ae(this,Vr,t),Ae(this,Pi,n),Ae(this,ih,(s,o,a=ml.now())=>{if(n[s]=o!==0?a:0,t[s]=o,o!==0&&this.ttlAutopurge){const c=setTimeout(()=>{M(this,Gr).call(this,s)&&this.delete(M(this,Nt)[s])},o+1);c.unref&&c.unref()}}),Ae(this,Ec,s=>{n[s]=t[s]!==0?ml.now():0}),Ae(this,no,(s,o)=>{if(t[o]){const a=t[o],c=n[o];if(!a||!c)return;s.ttl=a,s.start=c,s.now=r||i();const l=s.now-c;s.remainingTTL=a-l}});let r=0;const i=()=>{const s=ml.now();if(this.ttlResolution>0){r=s;const o=setTimeout(()=>r=0,this.ttlResolution);o.unref&&o.unref()}return s};this.getRemainingTTL=s=>{const o=M(this,on).get(s);if(o===void 0)return 0;const a=t[o],c=n[o];if(!a||!c)return 1/0;const l=(r||i())-c;return a-l},Ae(this,Gr,s=>{const o=n[s],a=t[s];return!!a&&!!o&&(r||i())-o>a})},Ec=new WeakMap,no=new WeakMap,ih=new WeakMap,Gr=new WeakMap,xm=new WeakSet,tM=function(){const t=new zp(M(this,Ei));Ae(this,Ri,0),Ae(this,Ni,t),Ae(this,Tc,n=>{Ae(this,Ri,M(this,Ri)-t[n]),t[n]=0}),Ae(this,sh,(n,r,i,s)=>{if(Se(this,gt,xt).call(this,r))return 0;if(!aa(i))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(i=s(r,n),!aa(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),Ae(this,vu,(n,r,i)=>{if(t[n]=r,M(this,Fr)){const s=M(this,Fr)-t[n];for(;M(this,Ri)>s;)Se(this,yu,Zp).call(this,!0)}Ae(this,Ri,M(this,Ri)+t[n]),i&&(i.entrySize=r,i.totalCalculatedSize=M(this,Ri))})},Tc=new WeakMap,vu=new WeakMap,sh=new WeakMap,us=new WeakSet,ca=function*({allowStale:t=this.allowStale}={}){if(M(this,ln))for(let n=M(this,kn);!(!Se(this,oh,HC).call(this,n)||((t||!M(this,Gr).call(this,n))&&(yield n),n===M(this,Kn)));)n=M(this,Ur)[n]},ds=new WeakSet,la=function*({allowStale:t=this.allowStale}={}){if(M(this,ln))for(let n=M(this,Kn);!(!Se(this,oh,HC).call(this,n)||((t||!M(this,Gr).call(this,n))&&(yield n),n===M(this,kn)));)n=M(this,rr)[n]},oh=new WeakSet,HC=function(t){return t!==void 0&&M(this,on).get(M(this,Nt)[t])===t},yu=new WeakSet,Zp=function(t){var s,o;const n=M(this,Kn),r=M(this,Nt)[n],i=M(this,Ne)[n];return M(this,Ia)&&Se(this,gt,xt).call(this,i)?i.__abortController.abort(new Error("evicted")):(M(this,Mi)||M(this,ir))&&(M(this,Mi)&&((s=M(this,Ti))==null||s.call(this,i,r,"evict")),M(this,ir)&&((o=M(this,An))==null||o.push([i,r,"evict"]))),M(this,Tc).call(this,n),t&&(M(this,Nt)[n]=void 0,M(this,Ne)[n]=void 0,M(this,xi).push(n)),M(this,ln)===1?(Ae(this,Kn,Ae(this,kn,0)),M(this,xi).length=0):Ae(this,Kn,M(this,rr)[n]),M(this,on).delete(r),Dh(this,ln)._--,n},Cu=new WeakSet,Xp=function(t,n,r,i){const s=n===void 0?void 0:M(this,Ne)[n];if(Se(this,gt,xt).call(this,s))return s;const o=new em,{signal:a}=r;a==null||a.addEventListener("abort",()=>o.abort(a.reason),{signal:o.signal});const c={signal:o.signal,options:r,context:i},l=(m,y=!1)=>{const{aborted:g}=o.signal,v=r.ignoreFetchAbort&&m!==void 0;if(r.status&&(g&&!y?(r.status.fetchAborted=!0,r.status.fetchError=o.signal.reason,v&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),g&&!v&&!y)return d(o.signal.reason);const S=h;return M(this,Ne)[n]===h&&(m===void 0?S.__staleWhileFetching?M(this,Ne)[n]=S.__staleWhileFetching:this.delete(t):(r.status&&(r.status.fetchUpdated=!0),this.set(t,m,c.options))),m},u=m=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=m),d(m)),d=m=>{const{aborted:y}=o.signal,g=y&&r.allowStaleOnFetchAbort,v=g||r.allowStaleOnFetchRejection,S=v||r.noDeleteOnFetchRejection,E=h;if(M(this,Ne)[n]===h&&(!S||E.__staleWhileFetching===void 0?this.delete(t):g||(M(this,Ne)[n]=E.__staleWhileFetching)),v)return r.status&&E.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),E.__staleWhileFetching;if(E.__returned===E)throw m},f=(m,y)=>{var v;const g=(v=M(this,mu))==null?void 0:v.call(this,t,s,c);g&&g instanceof Promise&&g.then(S=>m(S===void 0?void 0:S),y),o.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(m(void 0),r.allowStaleOnFetchAbort&&(m=S=>l(S,!0)))})};r.status&&(r.status.fetchDispatched=!0);const h=new Promise(f).then(l,u),p=Object.assign(h,{__abortController:o,__staleWhileFetching:s,__returned:void 0});return n===void 0?(this.set(t,p,{...c.options,status:void 0}),n=M(this,on).get(t)):M(this,Ne)[n]=p,p},gt=new WeakSet,xt=function(t){if(!M(this,Ia))return!1;const n=t;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof em},ah=new WeakSet,$C=function(t,n){M(this,Ur)[n]=t,M(this,rr)[t]=n},_c=new WeakSet,Wd=function(t){t!==M(this,kn)&&(t===M(this,Kn)?Ae(this,Kn,M(this,rr)[t]):Se(this,ah,$C).call(this,M(this,Ur)[t],M(this,rr)[t]),Se(this,ah,$C).call(this,M(this,kn),t),Ae(this,kn,t))};let WC=Qw;function lH(e){const t=e.match(/^#\$#(\S+)(?:\s+(\S{6})\s+)?(.*)$/);if(!t)return console.log("Invalid message format: message must match the format '#$#name [authKey] keyval*'\nGot `"+e+"`"),null;const n=t[1],r=t[2],i={},s=/(\S+)\s*:\s*"([^"]*)"|(\S+)\s*:\s*(\S+)/g;let o;for(;o=s.exec(t[3]);){const a=o[1]||o[3],c=o[2]||o[4];a in i?console.log(`Invalid message format: duplicate key ${a} detected`):i[a]=c}return{name:n,authKey:r,keyvals:i}}function W1(e){const t=e.match(/^#\$#\*\s(\S+)\s(\S+)\s*:\s*(.+)$|^#\$#:\s(\S+)$/);if(!t)return console.log("Invalid message format: message must match the format '#$#* datatag keyval'\nGot `"+e+"`"),null;const n=t[1]||t[4],r=void 0,i=t[2],s=t[3],o={};return o[i]=s,{name:n,authKey:r,keyvals:o}}function zC(){return(Math.random()+1).toString(36).substring(3,9)}class qu{constructor(t){V(this,"packageName");V(this,"minVersion",1);V(this,"maxVersion",1);V(this,"packageVersion",0);V(this,"client");this.client=t}handle(t){throw new Error("Method not implemented.")}handleMultiline(t){throw new Error("Method not implemented.")}closeMultiline(t){throw new Error("Method not implemented.")}shutdown(){}send(t,n){t.startsWith(this.packageName)||(t=this.packageName+"-"+t),this.client.sendMcp(t,n)}}class uH extends qu{constructor(){super(...arguments);V(this,"packageName","mcp-negotiate");V(this,"minVersion",2);V(this,"maxVersion",2)}handle(n){switch(n.name){}}sendNegotiate(){var n,r;for(const i of Object.values(this.client.mcpHandlers)){let s=(n=i.minVersion)==null?void 0:n.toFixed(1),o=(r=i.maxVersion)==null?void 0:r.toFixed(1);this.client.sendMcp("mcp-negotiate-can",{package:i.packageName,"min-version":s,"max-version":o})}this.client.sendCommand("#$#$mcp-negotiate-end")}}class dH extends qu{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-status")}handle(n){console.log(n),this.client.emit("statustext",n.keyvals.text)}}class fH extends qu{constructor(n){super(n);V(this,"packageName","dns-org-mud-moo-simpleedit");V(this,"sessions",{});V(this,"clientId");this.clientId=zC()}handle(n){if(n.name==="dns-org-mud-moo-simpleedit-content"){const r={name:n.keyvals.name,reference:n.keyvals.reference,type:n.keyvals.type,contents:[]};this.sessions[n.keyvals["_data-tag"]]=r}else console.log(`Unexpected simpleedit message ${n}`)}handleMultiline(n){"content"in n.keyvals?this.sessions[n.name].contents.push(n.keyvals.content):console.log(`Unexpected simpleedit ML ${n}`)}closeMultiline(n){console.log(`Closing multiline ${n.name}`),this.client.openEditorWindow(this.sessions[n.name])}shutdown(){new BroadcastChannel("editor").postMessage({type:"shutdown"})}}class hH extends qu{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-getset");V(this,"id",1);V(this,"cache",new WC({max:10}));V(this,"LocalCache",{})}handle(n){switch(n.name){case"dns-com-awns-getset-ack":const r=this.cache.get(n.keyvals.id);if(r===void 0){console.log(`Got ack for unknown id ${n.keyvals.id}`);break}const i=n.keyvals.value;console.log(`Got ${r} = ${i}`),this.LocalCache[r]=i,this.client.emit("getset",r,i);break}}sendGet(n){const r=(this.id++).toString();this.cache.set(r,n),this.client.sendMcp("dns-com-awns-getset-get",{id:r,property:n})}sendSet(n,r){this.client.sendMcp("dns-com-awns-getset-set",{id:this.id++,property:n,value:r})}sendDrop(n){this.client.sendMcp("dns-com-awns-getset-drop",{id:this.id++,property:n})}}class pH extends qu{constructor(){super(...arguments);V(this,"packageName","dns-com-vmoo-userlist");V(this,"maxVersion",1.1);V(this,"player");V(this,"fields",["Object","Name","Icon"]);V(this,"icons",["Idle","Away","Idle+Away","Friend","Newbie","Inhabitant","Inhabitant+","Schooled","Wizard","Key","Star"]);V(this,"players",[])}handle(n){switch(n.name){case"dns-com-vmoo-userlist-you":this.player=n.keyvals.nr;break}}handleMultiline(n){if("fields"in n.keyvals&&(this.fields=bi(n.keyvals.fields.trim())),"icons"in n.keyvals&&(this.icons=bi(n.keyvals.icons.trim())),"d"in n.keyvals){const s=n.keyvals.d[0];switch(s){case"=":var r=bi(n.keyvals.d.slice(1));this.players=r.map(a=>this.playerFromArray(a));break;case"+":this.players.push(this.playerFromArray(bi(n.keyvals.d.slice(1))));break;case"-":var i=bi(n.keyvals.d.slice(1));this.players=this.players.filter(a=>!i.includes(a.Object));break;case"*":const o=this.playerFromArray(bi(n.keyvals.d.slice(1)));this.updatePlayer(o);break;case"<":i=bi(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!0,this.players[c]=a)});break;case">":i=bi(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.idle=!1,this.players[c]=a)});break;case"[":i=bi(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!0,this.players[c]=a)});break;case"]":i=bi(n.keyvals.d.slice(1)),this.players.forEach((a,c)=>{i.includes(a.Object)&&(a.away=!1,this.players[c]=a)});break;default:console.log(`Unknown userlist mode ${s} in ${n.keyvals.d}`);break}this.update()}}updatePlayer(n){const r=this.players.findIndex(i=>i.Object===n.Object);r!==-1?this.players[r]=n:this.players.push(n)}update(){this.players.sort((r,i)=>n(i)-n(r)),this.client.emit("userlist",this.players);function n(r){return r.Icon-(r.idle?10:0)-(r.away?20:0)}}playerFromArray(n){const r={};return n.forEach((i,s)=>{r[this.fields[s]]=i}),r.away=!1,r.idle=!1,r}}function bi(e){e=e.slice(1,-1);let t=[],n="",r=0;for(let s=0;s<e.length;s++){const o=e[s];if(o==="{")r++;else if(o==="}")r--;else if(o===","&&r===0){i(),n="";continue}n+=o}return n.length>0&&i(),t;function i(){n=n.trim(),n.startsWith("{")&&n.endsWith("}")?t.push(bi(n)):Number.isNaN(Number(n))?n.startsWith('"')&&n.endsWith('"')?t.push(n.slice(1,-1)):t.push(n):t.push(Number(n))}}class gH extends qu{constructor(){super(...arguments);V(this,"packageName","dns-com-awns-ping");V(this,"id",1)}handle(n){switch(n.name){case"dns-com-awns-ping":this.send("reply",n.keyvals);break}}ping(){this.send("dns-com-awns-ping",{id:this.id++})}}function mH({onlyFirst:e=!1}={}){const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(t,e?void 0:"g")}const vH=mH();function yH(e){if(typeof e!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof e}\``);return e.replace(vH,"")}var ZC=(e=>(e.Off="off",e.Unfocused="unfocused",e.All="all",e))(ZC||{}),Go=(e=>(e.SetGeneral="SET_GENERAL",e.SetSpeech="SET_SPEECH",e.SetChannels="SET_CHANNELS",e.SetEditorAutocompleteEnabled="SET_EDITOR_AUTOCOMPLETE_ENABLED",e.SetEditorAccessibilityMode="SET_EDITOR_ACCESSIBILITY_MODE",e))(Go||{});class CH{constructor(){V(this,"state");V(this,"listeners",new Set);V(this,"dispatch",t=>{this.state=this.reducer(this.state,t),localStorage.setItem("preferences",JSON.stringify(this.state)),this.listeners.forEach(n=>n())});const t=localStorage.getItem("preferences"),n=this.getInitialPreferences();this.state=t?this.mergePreferences(n,JSON.parse(t)):n}getInitialPreferences(){return{general:{localEcho:!1},speech:{autoreadMode:"off",voice:"",rate:1,pitch:1,volume:1},channels:{sayto:{autoreadMode:"off",notify:!0}},editor:{autocompleteEnabled:!0,accessibilityMode:!0}}}mergePreferences(t,n){return{...t,general:{...t.general,...n.general},speech:{...t.speech,...n.speech},channels:n.channels?{...t.channels,...n.channels}:t.channels,editor:{...t.editor,...n.editor}}}reducer(t,n){switch(n.type){case"SET_GENERAL":return{...t,general:n.data};case"SET_SPEECH":return{...t,speech:n.data};case"SET_CHANNELS":return{...t,channels:n.data};case"SET_EDITOR_AUTOCOMPLETE_ENABLED":return{...t,editor:{...t.editor,autocompleteEnabled:n.data}};case"SET_EDITOR_ACCESSIBILITY_MODE":return{...t,editor:{...t.editor,accessibilityMode:n.data}};default:return t}}getState(){return this.state}subscribe(t){return this.listeners.add(t),()=>{this.listeners.delete(t)}}}const tu=new CH;class IH extends XN{constructor(n,r){super();V(this,"ws");V(this,"decoder",new TextDecoder("utf8"));V(this,"telnet");V(this,"host");V(this,"port");V(this,"telnetNegotiation",!1);V(this,"telnetBuffer","");V(this,"gmcpHandlers",{});V(this,"mcpHandlers",{});V(this,"mcpMultilines",{});V(this,"mcpAuthKey",null);V(this,"mcp_negotiate");V(this,"mcp_getset");V(this,"gmcp_char");V(this,"worldData",{playerId:"",playerName:"",roomId:"",liveKitTokens:[]});V(this,"cacophony");V(this,"sendCommand",n=>{tu.getState().general.localEcho&&this.emit("command",n),this.send(n+`\r
`),console.log("> "+n)});this.host=n,this.port=r,this.mcp_negotiate=this.registerMcpPackage(uH),this.mcp_getset=this.registerMcpPackage(hH),this.gmcp_char=this.registerGMCPPackage(YV),this.cacophony=new Y9}registerGMCPPackage(n){const r=new n(this);return this.gmcpHandlers[r.packageName]=r,console.log("Registered GMCP Package:",r.packageName),r}registerMcpPackage(n){const r=new n(this);return this.mcpHandlers[r.packageName]=r,r}connect(){this.ws=new window.WebSocket(`wss://${this.host}:${this.port}`),this.ws.binaryType="arraybuffer",this.telnet=new KV(new XV(this.ws)),this.ws.onopen=()=>{this.emit("connect")},this.telnet.on("data",n=>{this.handleData(n)}),this.telnet.on("negotiation",(n,r)=>{n===Gd.WILL&&r===Vd.GMCP?(console.log("GMCP Negotiation"),this.telnet.sendNegotiation(Gd.DO,Vd.GMCP),this.gmcpHandlers.Core.sendHello(),this.gmcpHandlers["Core.Supports"].sendSet(),this.gmcpHandlers["Auth.Autologin"].sendLogin()):n===Gd.DO&&r===Vd.TERMINAL_TYPE&&(console.log("TTYPE Negotiation"),this.telnet.sendNegotiation(Gd.WILL,Vd.TERMINAL_TYPE),this.telnet.sendTerminalType("Mongoose React Client"),this.telnet.sendTerminalType("ANSI"),this.telnet.sendTerminalType("PROXY"))}),this.telnet.on("gmcp",(n,r)=>{console.log("GMCP Package:",n,r),this.handleGmcpData(n,r)}),this.ws.onclose=()=>{this.emit("disconnect"),this.mcpAuthKey=null,setTimeout(()=>{this.connect()},1e4)},this.ws.onerror=n=>{this.emit("error",n)}}send(n){this.ws.send(n)}close(){this.ws.close()}handleData(n){const r=this.decoder.decode(n).trimEnd();for(const i of r.split(`
`))i&&i.startsWith("#$#")?this.handleMcp(i):this.emitMessage(i)}handleMcp(n){if(n.startsWith("#$#*")){const i=W1(n.trimEnd());i&&(i.name in this.mcpMultilines?this.mcpMultilines[i.name].handleMultiline(i):console.warn("Received continuation for unknown multiline",i));return}if(n.startsWith("#$#:")){const i=W1(n.trimEnd());i&&(this.mcpMultilines[i.name].closeMultiline(i),delete this.mcpMultilines[i.name]);return}const r=lH(n.trimEnd());if(console.log("MCP Message:",r),(r==null?void 0:r.name.toLowerCase())==="mcp"&&r.authKey==null&&this.mcpAuthKey==null)this.mcpAuthKey=zC(),this.sendCommand(`#$#mcp authentication-key: ${this.mcpAuthKey} version: 2.1 to: 2.1`),this.mcp_negotiate.sendNegotiate();else if((r==null?void 0:r.name)!=="mcp-negotiate-end")if((r==null?void 0:r.authKey)===this.mcpAuthKey){let i=r.name;do{if(i in this.mcpHandlers){this.mcpHandlers[i].handle(r),"_data-tag"in r.keyvals&&(console.log("new multiline "+r.keyvals["_data-tag"]),this.mcpMultilines[r.keyvals["_data-tag"]]=this.mcpHandlers[i]);return}i=i.substring(0,i.lastIndexOf("-"))}while(i);console.log(`No handler for ${r.name}`)}else console.log(`Unexpected authkey "${r==null?void 0:r.authKey}", probably a spoofed message.`)}handleGmcpData(n,r){const i=n.lastIndexOf("."),s=n.substring(0,i),o=n.substring(i+1);console.log("GMCP Message:",s,o,r);const a=this.gmcpHandlers[s];if(!a){console.log("No handler for GMCP package:",s);return}const c=a["handle"+o];c?(console.log("Calling handler:",c),c.call(a,JSON.parse(r))):console.log("No handler on package:",s,o)}emitMessage(n){const r=tu.getState().speech.autoreadMode;r===ZC.All&&this.speak(n),r===ZC.Unfocused&&!document.hasFocus()&&this.speak(n),this.emit("message",n)}sendGmcp(n,r){console.log("Sending GMCP:",n,r),this.telnet.sendGmcp(n,r)}sendMcp(n,r){if(typeof r=="object"){let s="";for(const[o,a]of Object.entries(r))s+=` ${o}: ${a||'""'}`;r=s}const i=`#$#${n} ${this.mcpAuthKey} ${r}\r
`;this.send(i)}sendMcpMLLine(n,r,i){this.send(`#$#* ${n} ${r}: ${i}\r
`)}closeMcpML(n){this.send(`#$#: ${n}\r
`)}openEditorWindow(n){console.log(n);const r=new BroadcastChannel("editor"),i=n.reference,s=encodeURIComponent(i),o=window.open(`/editor?reference=${s}`,"_blank");r.onmessage=a=>{console.log("editor window message",a),a.data.id===i&&(a.data.type==="ready"?(console.log("sending editor window session",n),r.postMessage({type:"load",session:n})):a.data.type==="save"?(console.log("saving editor window with session",a.data.session),this.saveEditorWindow(a.data.session)):a.data.type==="close"&&(console.log("closing editor window"),r.close(),r.onmessage=null))},o&&o.focus()}saveEditorWindow(n){const r={reference:n.reference,type:n.type};r["content*"]="",this.sendMCPMultiline("dns-org-mud-moo-simpleedit-set",r,n.contents)}sendMCPMultiline(n,r,i){const s=zC();r["_data-tag"]=s,this.sendMcp(n,r);for(const o of i)this.sendMcpMLLine(s,"content",o);this.closeMcpML(s)}shutdown(){Object.values(this.mcpHandlers).forEach(n=>{n.shutdown()}),Object.values(this.gmcpHandlers).forEach(n=>{n.shutdown()})}requestNotificationPermission(){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="default"&&Notification.requestPermission()}sendNotification(n,r){if(!("Notification"in window)){console.log("This browser does not support desktop notification");return}Notification.permission==="granted"&&new Notification(n,{body:r})}speak(n){if(!("speechSynthesis"in window)){console.log("This browser does not support speech synthesis");return}const r=new SpeechSynthesisUtterance(yH(n));r.lang="en-US";const{rate:i,pitch:s,voice:o,volume:a}=tu.getState().speech;r.rate=i,r.pitch=s,r.volume=a;const l=speechSynthesis.getVoices().find(u=>u.name===o);l&&(r.voice=l),speechSynthesis.speak(r)}cancelSpeech(){speechSynthesis.cancel()}stopAllSounds(){this.gmcpHandlers["Client.Media"].stopAllSounds()}getInput(){var n;return((n=document.getElementById("command-input"))==null?void 0:n.textContent)||""}setInput(n){const r=document.getElementById("command-input");r&&(r.textContent=n)}}class SH{constructor(){V(this,"history",[]);V(this,"currentIndex",null);V(this,"unsentInput","")}addCommand(t){t.trim()!==""&&(this.history.length===0||this.history[this.history.length-1]!==t)&&(this.history.push(t.trim()),this.unsentInput=""),this.currentIndex=null}navigateUp(t){return this.currentIndex===null&&(this.unsentInput=t),this.history.length>0&&(this.currentIndex==null||this.currentIndex>0)?(this.currentIndex=this.currentIndex==null?this.history.length-1:this.currentIndex-1,this.history[this.currentIndex]):this.currentIndex===null?"":this.history[this.currentIndex]}navigateDown(t){return this.currentIndex!==null?this.currentIndex<this.history.length-1?(this.currentIndex++,this.history[this.currentIndex]):(this.currentIndex=null,this.unsentInput):this.unsentInput}getCurrentInput(){return this.currentIndex===null?this.unsentInput:this.history[this.currentIndex]}}const bH=({onSend:e,inputRef:t})=>{const[n,r]=w.useState(""),i=w.useRef(new SH),s=o=>{const a=i.current;if(o.key==="Enter"&&!o.shiftKey)o.preventDefault(),e(n),a.addCommand(n),r("");else if(o.key==="ArrowUp"){o.preventDefault();const c=a.navigateUp(n);r(c)}else if(o.key==="ArrowDown"){o.preventDefault();const c=a.navigateDown(n);r(c)}};return J.jsx("textarea",{value:n,onChange:o=>r(o.target.value),onKeyDown:s,id:"command-input",ref:t,autoFocus:!0})},wH="fa53ebce919011f684f5055b78deacf96fdc1ffe",ic=()=>{const[,e]=w.useReducer(t=>t+1,0);return w.useEffect(()=>tu.subscribe(e),[]),[tu.getState(),tu.dispatch]},kH=()=>{const[e,t]=w.useState([]);return w.useEffect(()=>{const n=()=>{t(window.speechSynthesis.getVoices())};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)},[]),e},AH=({tabs:e})=>{const[t,n]=w.useState(0),r=w.useRef([]);return w.useEffect(()=>{r.current=r.current.slice(0,e.length)},[e]),w.useEffect(()=>{const i=o=>{switch(o.key){case"ArrowLeft":n(a=>a>0?a-1:e.length-1);break;case"ArrowRight":n(a=>a<e.length-1?a+1:0);break}},s=r.current[t];return s==null||s.addEventListener("keydown",i),()=>{s==null||s.removeEventListener("keydown",i)}},[e.length,t]),w.useEffect(()=>{var i;(i=r.current[t])==null||i.focus()},[t]),J.jsxs("div",{children:[J.jsx("div",{role:"tablist","aria-label":"Tabs",children:e.map((i,s)=>J.jsx("button",{ref:o=>r.current[s]=o,role:"tab","aria-selected":t===s,id:`${i.label}-tab`,"aria-controls":`${i.label}-panel`,onClick:()=>n(s),tabIndex:t===s?void 0:-1,children:i.label},s))}),e.map((i,s)=>J.jsx("div",{role:"tabpanel",id:`${i.label}-panel`,"aria-labelledby":`${i.label}-tab`,hidden:t!==s,tabIndex:t===s?0:-1,children:i.content},s))]})},EH=()=>{const[e,t]=ic();return J.jsxs("label",{children:[J.jsx("input",{type:"checkbox",checked:e.general.localEcho,onChange:n=>t({type:Go.SetGeneral,data:{...e.general,localEcho:n.target.checked}})}),"Local Echo"]})},TH=()=>{const[e,t]=ic();return J.jsxs("label",{children:["Auto Read:",J.jsxs("select",{value:e.speech.autoreadMode,onChange:n=>t({type:Go.SetSpeech,data:{...e.speech,autoreadMode:n.target.value}}),children:[J.jsx("option",{value:"off",children:"Off"}),J.jsx("option",{value:"unfocused",children:"Unfocused"}),J.jsx("option",{value:"all",children:"Always"})]})]})},_H=()=>{const[e,t]=ic(),n=kH();return J.jsxs("label",{children:["Voice:",J.jsx("select",{value:e.speech.voice,onChange:r=>t({type:Go.SetSpeech,data:{...e.speech,voice:r.target.value}}),children:n.map(r=>J.jsx("option",{value:r.name,children:r.name},r.voiceURI))})]})},RH=()=>{const[e,t]=ic();return J.jsxs("label",{children:["Rate (0.1 - 10.0):",J.jsx("input",{type:"range",min:"0.1",max:"10.0",step:"0.1",value:e.speech.rate,onChange:n=>t({type:Go.SetSpeech,data:{...e.speech,rate:parseFloat(n.target.value)}})})]})},xH=()=>{const[e,t]=ic();return J.jsxs("label",{children:["Pitch (0 - 2):",J.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:e.speech.pitch,onChange:n=>t({type:Go.SetSpeech,data:{...e.speech,pitch:parseFloat(n.target.value)}})})]})},NH=()=>{const[e,t]=ic();return J.jsxs("label",{children:["Volume (0 - 1):",J.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:e.speech.volume,onChange:n=>t({type:Go.SetSpeech,data:{...e.speech,volume:parseFloat(n.target.value)}})})]})},PH=()=>J.jsxs("div",{children:[J.jsx(TH,{}),J.jsx("br",{}),J.jsx(_H,{}),J.jsx("br",{}),J.jsx(RH,{}),J.jsx("br",{}),J.jsx(xH,{}),J.jsx("br",{}),J.jsx(NH,{}),J.jsx("br",{})]}),MH=()=>{const[e,t]=ic(),n=e.editor,r=s=>{t({type:Go.SetEditorAutocompleteEnabled,data:s.target.checked})},i=s=>{t({type:Go.SetEditorAccessibilityMode,data:s.target.checked})};return J.jsxs("div",{children:[J.jsxs("label",{children:[J.jsx("input",{type:"checkbox",checked:n.autocompleteEnabled,onChange:r}),"Enable Autocomplete"]}),J.jsx("br",{}),J.jsxs("label",{children:[J.jsx("input",{type:"checkbox",checked:n.accessibilityMode,onChange:i}),"Enable Accessibility Mode"]}),J.jsx("br",{})]})},OH=()=>{const e=[{label:"General",content:J.jsx(EH,{})},{label:"Speech",content:J.jsx(PH,{})},{label:"Editor",content:J.jsx(MH,{})}];return J.jsx(AH,{tabs:e})};function DH(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,s;for(s=0;s<r.length;s++)i=r[s],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Vf(){return Vf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vf.apply(this,arguments)}var XC="data-focus-lock",nM="data-focus-lock-disabled",LH="data-no-focus-lock",BH="data-autofocus-inside",FH="data-no-autofocus";function Wy(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function UH(e,t){var n=w.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=t,n.facade}var j1=new WeakMap;function VH(e,t){var n=UH(t||null,function(r){return e.forEach(function(i){return Wy(i,r)})});return w.useLayoutEffect(function(){var r=j1.get(n);if(r){var i=new Set(r),s=new Set(e),o=n.current;i.forEach(function(a){s.has(a)||Wy(a,null)}),s.forEach(function(a){i.has(a)||Wy(a,o)})}j1.set(n,e)},[e]),n}var jy={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},KC=function(e,t){return KC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},KC(e,t)};function Qu(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");KC(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var JC=function(){return JC=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},JC.apply(this,arguments)};function GH(e,t,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(e,t||[])).next())})}function rM(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(n=0)),n;)try{if(r=1,i&&(s=l[0]&2?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){n.label=l[1];break}if(l[0]===6&&n.label<s[1]){n.label=s[1],s=l;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(l);break}s[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(u){l=[6,u],i=0}finally{r=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Ru(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function YC(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function qC(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}function nu(e){return this instanceof nu?(this.v=e,this):new nu(e)}function WH(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(f){r[f]&&(i[f]=function(h){return new Promise(function(p,m){s.push([f,h,p,m])>1||a(f,h)})})}function a(f,h){try{c(r[f](h))}catch(p){d(s[0][3],p)}}function c(f){f.value instanceof nu?Promise.resolve(f.value.v).then(l,u):d(s[0][2],f)}function l(f){a("next",f)}function u(f){a("throw",f)}function d(f,h){f(h),s.shift(),s.length&&a(s[0][0],s[0][1])}}function jH(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Ru=="function"?Ru(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}function iM(e){return e}function sM(e,t){t===void 0&&(t=iM);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(s){var o=t(s,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(r=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var c=function(){var u=o;o=[],u.forEach(s)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){o.push(u),l()},filter:function(u){return o=o.filter(u),n}}}};return i}function Ob(e,t){return t===void 0&&(t=iM),sM(e,t)}function HH(e){e===void 0&&(e={});var t=sM(null);return t.options=JC({async:!0,ssr:!1},e),t}var oM=Ob({},function(e){var t=e.target,n=e.currentTarget;return{target:t,currentTarget:n}}),aM=Ob(),$H=Ob(),zH=HH({async:!0}),ZH=[],cM=w.forwardRef(function(t,n){var r,i=w.useState(),s=i[0],o=i[1],a=w.useRef(),c=w.useRef(!1),l=w.useRef(null),u=t.children,d=t.disabled,f=d===void 0?!1:d,h=t.noFocusGuards,p=h===void 0?!1:h,m=t.persistentFocus,y=m===void 0?!1:m,g=t.crossFrame,v=g===void 0?!0:g,S=t.autoFocus,E=S===void 0?!0:S;t.allowTextSelection;var k=t.group,b=t.className,A=t.whiteList,_=t.hasPositiveIndices,P=t.shards,N=P===void 0?ZH:P,O=t.as,D=O===void 0?"div":O,U=t.lockProps,G=U===void 0?{}:U,z=t.sideCar,$=t.returnFocus,q=$===void 0?!1:$,W=t.focusOptions,X=t.onActivation,ne=t.onDeactivation,Z=w.useState({}),ie=Z[0],ke=w.useCallback(function(){l.current=l.current||document&&document.activeElement,a.current&&X&&X(a.current),c.current=!0},[X]),Ee=w.useCallback(function(){c.current=!1,ne&&ne(a.current)},[ne]);w.useEffect(function(){f||(l.current=null)},[]);var ge=w.useCallback(function(dt){var Ut=l.current;if(Ut&&Ut.focus){var ce=typeof q=="function"?q(Ut):q;if(ce){var Ce=typeof ce=="object"?ce:void 0;l.current=null,dt?Promise.resolve().then(function(){return Ut.focus(Ce)}):Ut.focus(Ce)}}},[q]),Te=w.useCallback(function(dt){c.current&&oM.useMedium(dt)},[]),Qe=aM.useMedium,ae=w.useCallback(function(dt){a.current!==dt&&(a.current=dt,o(dt))},[]),rn=Vf((r={},r[nM]=f&&"disabled",r[XC]=k,r),G),In=p!==!0,Ct=In&&p!=="tail",cn=VH([n,ae]);return w.createElement(w.Fragment,null,In&&[w.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:f?-1:0,style:jy}),_?w.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:f?-1:1,style:jy}):null],!f&&w.createElement(z,{id:ie,sideCar:zH,observed:s,disabled:f,persistentFocus:y,crossFrame:v,autoFocus:E,whiteList:A,shards:N,onActivation:ke,onDeactivation:Ee,returnFocus:ge,focusOptions:W}),w.createElement(D,Vf({ref:cn},rn,{className:b,onBlur:Qe,onFocus:Te}),u),Ct&&w.createElement("div",{"data-focus-guard":!0,tabIndex:f?-1:0,style:jy}))});cM.propTypes={};const lM=cM;function QC(e,t){return QC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},QC(e,t)}function XH(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,QC(e,t)}function Gf(e){"@babel/helpers - typeof";return Gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gf(e)}function KH(e,t){if(Gf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Gf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JH(e){var t=KH(e,"string");return Gf(t)=="symbol"?t:String(t)}function YH(e,t,n){return t=JH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qH(e,t){function n(r){return r.displayName||r.name||"Component"}return function(i){var s=[],o;function a(){o=e(s.map(function(l){return l.props})),t(o)}var c=function(l){XH(u,l);function u(){return l.apply(this,arguments)||this}u.peek=function(){return o};var d=u.prototype;return d.componentDidMount=function(){s.push(this),a()},d.componentDidUpdate=function(){a()},d.componentWillUnmount=function(){var h=s.indexOf(this);s.splice(h,1),a()},d.render=function(){return vt.createElement(i,this.props)},u}(w.PureComponent);return YH(c,"displayName","SideEffect("+n(i)+")"),c}}var zs=function(e){for(var t=Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t},tm=function(e){return Array.isArray(e)?e:[e]},uM=function(e){return Array.isArray(e)?e[0]:e},QH=function(e){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var t=window.getComputedStyle(e,null);return!t||!t.getPropertyValue?!1:t.getPropertyValue("display")==="none"||t.getPropertyValue("visibility")==="hidden"},dM=function(e){return e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode},fM=function(e){return e===document||e&&e.nodeType===Node.DOCUMENT_NODE},e$=function(e){return e.hasAttribute("inert")},t$=function(e,t){return!e||fM(e)||!QH(e)&&!e$(e)&&t(dM(e))},hM=function(e,t){var n=e.get(t);if(n!==void 0)return n;var r=t$(t,hM.bind(void 0,e));return e.set(t,r),r},n$=function(e,t){return e&&!fM(e)?s$(e)?t(dM(e)):!1:!0},pM=function(e,t){var n=e.get(t);if(n!==void 0)return n;var r=n$(t,pM.bind(void 0,e));return e.set(t,r),r},gM=function(e){return e.dataset},r$=function(e){return e.tagName==="BUTTON"},mM=function(e){return e.tagName==="INPUT"},vM=function(e){return mM(e)&&e.type==="radio"},i$=function(e){return!((mM(e)||r$(e))&&(e.type==="hidden"||e.disabled))},s$=function(e){var t=e.getAttribute(FH);return![!0,"true",""].includes(t)},Db=function(e){var t;return!!(e&&(!((t=gM(e))===null||t===void 0)&&t.focusGuard))},nm=function(e){return!Db(e)},o$=function(e){return!!e},a$=function(e,t){var n=e.tabIndex-t.tabIndex,r=e.index-t.index;if(n){if(!e.tabIndex)return 1;if(!t.tabIndex)return-1}return n||r},c$=function(e){return e.tabIndex<0&&!e.hasAttribute("tabindex")?0:e.tabIndex},yM=function(e,t,n){return zs(e).map(function(r,i){var s=c$(r);return{node:r,index:i,tabIndex:n&&s===-1?(r.dataset||{}).focusGuard?0:-1:s}}).filter(function(r){return!t||r.tabIndex>=0}).sort(a$)},l$=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],Lb=l$.join(","),u$="".concat(Lb,", [data-focus-guard]"),CM=function(e,t){return zs((e.shadowRoot||e).children).reduce(function(n,r){return n.concat(r.matches(t?u$:Lb)?[r]:[],CM(r))},[])},d$=function(e,t){var n;return e instanceof HTMLIFrameElement&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?av([e.contentDocument.body],t):[e]},av=function(e,t){return e.reduce(function(n,r){var i,s=CM(r,t),o=(i=[]).concat.apply(i,s.map(function(a){return d$(a,t)}));return n.concat(o,r.parentNode?zs(r.parentNode.querySelectorAll(Lb)).filter(function(a){return a===r}):[])},[])},f$=function(e){var t=e.querySelectorAll("[".concat(BH,"]"));return zs(t).map(function(n){return av([n])}).reduce(function(n,r){return n.concat(r)},[])},Bb=function(e,t){return zs(e).filter(function(n){return hM(t,n)}).filter(function(n){return i$(n)})},H1=function(e,t){return t===void 0&&(t=new Map),zs(e).filter(function(n){return pM(t,n)})},$1=function(e,t,n){return yM(Bb(av(e,n),t),!0,n)},z1=function(e,t){return yM(Bb(av(e),t),!1)},h$=function(e,t){return Bb(f$(e),t)},ru=function(e,t){return e.shadowRoot?ru(e.shadowRoot,t):Object.getPrototypeOf(e).contains!==void 0&&Object.getPrototypeOf(e).contains.call(e,t)?!0:zs(e.children).some(function(n){var r;if(n instanceof HTMLIFrameElement){var i=(r=n.contentDocument)===null||r===void 0?void 0:r.body;return i?ru(i,t):!1}return ru(n,t)})},p$=function(e){for(var t=new Set,n=e.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var s=e[r].compareDocumentPosition(e[i]);(s&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&t.add(i),(s&Node.DOCUMENT_POSITION_CONTAINS)>0&&t.add(r)}return e.filter(function(o,a){return!t.has(a)})},IM=function(e){return e.parentNode?IM(e.parentNode):e},Fb=function(e){var t=tm(e);return t.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(XC);return n.push.apply(n,i?p$(zs(IM(r).querySelectorAll("[".concat(XC,'="').concat(i,'"]:not([').concat(nM,'="disabled"])')))):[r]),n},[])},g$=function(e){try{return e()}catch{return}},Wf=function(e){if(e===void 0&&(e=document),!(!e||!e.activeElement)){var t=e.activeElement;return t.shadowRoot?Wf(t.shadowRoot):t instanceof HTMLIFrameElement&&g$(function(){return t.contentWindow.document})?Wf(t.contentWindow.document):t}},m$=function(e,t){return e===t},v$=function(e,t){return!!zs(e.querySelectorAll("iframe")).some(function(n){return m$(n,t)})},SM=function(e,t){return t===void 0&&(t=Wf(uM(e).ownerDocument)),!t||t.dataset&&t.dataset.focusGuard?!1:Fb(e).some(function(n){return ru(n,t)||v$(n,t)})},y$=function(e){e===void 0&&(e=document);var t=Wf(e);return t?zs(e.querySelectorAll("[".concat(LH,"]"))).some(function(n){return ru(n,t)}):!1},C$=function(e,t){return t.filter(vM).filter(function(n){return n.name===e.name}).filter(function(n){return n.checked})[0]||e},Ub=function(e,t){return vM(e)&&e.name?C$(e,t):e},I$=function(e){var t=new Set;return e.forEach(function(n){return t.add(Ub(n,e))}),e.filter(function(n){return t.has(n)})},Z1=function(e){return e[0]&&e.length>1?Ub(e[0],e):e[0]},X1=function(e,t){return e.indexOf(Ub(t,e))},eI="NEW_FOCUS",S$=function(e,t,n,r,i){var s=e.length,o=e[0],a=e[s-1],c=Db(r);if(!(r&&e.indexOf(r)>=0)){var l=r!==void 0?n.indexOf(r):-1,u=i?n.indexOf(i):l,d=i?e.indexOf(i):-1;if(l===-1)return d!==-1?d:eI;if(d===-1)return eI;var f=l-u,h=n.indexOf(o),p=n.indexOf(a),m=I$(n),y=r!==void 0?m.indexOf(r):-1,g=y-(i?m.indexOf(i):l),v=X1(e,t[0]),S=X1(e,t[t.length-1]);if(!f&&d>=0)return d;if(l<=h&&c&&Math.abs(f)>1)return S;if(l>=p&&c&&Math.abs(f)>1)return v;if(f&&Math.abs(g)>1)return d;if(l<=h)return S;if(l>p)return v;if(f)return Math.abs(f)>1?d:(s+d+f)%s}},b$=function(e){return function(t){var n,r=(n=gM(t))===null||n===void 0?void 0:n.autofocus;return t.autofocus||r!==void 0&&r!=="false"||e.indexOf(t)>=0}},w$=function(e,t,n){var r=e.map(function(s){var o=s.node;return o}),i=H1(r.filter(b$(n)));return i&&i.length?Z1(i):Z1(H1(t))},tI=function(e,t){return t===void 0&&(t=[]),t.push(e),e.parentNode&&tI(e.parentNode.host||e.parentNode,t),t},Hy=function(e,t){for(var n=tI(e),r=tI(t),i=0;i<n.length;i+=1){var s=n[i];if(r.indexOf(s)>=0)return s}return!1},bM=function(e,t,n){var r=tm(e),i=tm(t),s=r[0],o=!1;return i.filter(Boolean).forEach(function(a){o=Hy(o||a,a)||o,n.filter(Boolean).forEach(function(c){var l=Hy(s,c);l&&(!o||ru(l,o)?o=l:o=Hy(l,o))})}),o},k$=function(e,t){return e.reduce(function(n,r){return n.concat(h$(r,t))},[])},A$=function(e,t){var n=new Map;return t.forEach(function(r){return n.set(r.node,r)}),e.map(function(r){return n.get(r)}).filter(o$)},E$=function(e,t){var n=Wf(tm(e).length>0?document:uM(e).ownerDocument),r=Fb(e).filter(nm),i=bM(n||e,e,r),s=new Map,o=z1(r,s),a=o.filter(function(p){var m=p.node;return nm(m)});if(a[0]){var c=z1([i],s).map(function(p){var m=p.node;return m}),l=A$(c,a),u=l.map(function(p){var m=p.node;return m}),d=l.filter(function(p){var m=p.tabIndex;return m>=0}).map(function(p){var m=p.node;return m}),f=S$(u,d,c,n,t);if(f===eI){var h=w$(o,d,k$(r,s));if(h)return{node:h};console.warn("focus-lock: cannot find any node to move focus into");return}return f===void 0?f:l[f]}},T$=function(e){var t=Fb(e).filter(nm),n=bM(e,e,t),r=new Map,i=$1([n],r,!0),s=$1(t,r).filter(function(o){var a=o.node;return nm(a)}).map(function(o){var a=o.node;return a});return i.map(function(o){var a=o.node,c=o.index;return{node:a,index:c,lockItem:s.indexOf(a)>=0,guard:Db(a)}})},_$=function(e,t){e&&("focus"in e&&e.focus(t),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus())},$y=0,zy=!1,wM=function(e,t,n){n===void 0&&(n={});var r=E$(e,t);if(!zy&&r){if($y>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),zy=!0,setTimeout(function(){zy=!1},1);return}$y++,_$(r.node,n.focusOptions),$y--}};function Vb(e){setTimeout(e,1)}var R$=function(){return document&&document.activeElement===document.body},x$=function(){return R$()||y$()},iu=null,Vl=null,su=null,jf=!1,N$=function(){return!0},P$=function(t){return(iu.whiteList||N$)(t)},M$=function(t,n){su={observerNode:t,portaledElement:n}},O$=function(t){return su&&su.portaledElement===t};function K1(e,t,n,r){var i=null,s=e;do{var o=r[s];if(o.guard)o.node.dataset.focusAutoGuard&&(i=o);else if(o.lockItem){if(s!==e)return;i=null}else break}while((s+=n)!==t);i&&(i.node.tabIndex=0)}var D$=function(t){return t&&"current"in t?t.current:t},L$=function(t){return t?!!jf:jf==="meanwhile"},B$=function e(t,n,r){return n&&(n.host===t&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&e(t,n.parentNode,r))},F$=function(t,n){return n.some(function(r){return B$(t,r,r)})},rm=function(){var t=!1;if(iu){var n=iu,r=n.observed,i=n.persistentFocus,s=n.autoFocus,o=n.shards,a=n.crossFrame,c=n.focusOptions,l=r||su&&su.portaledElement,u=document&&document.activeElement;if(l){var d=[l].concat(o.map(D$).filter(Boolean));if((!u||P$(u))&&(i||L$(a)||!x$()||!Vl&&s)&&(l&&!(SM(d)||u&&F$(u,d)||O$(u))&&(document&&!Vl&&u&&!s?(u.blur&&u.blur(),document.body.focus()):(t=wM(d,Vl,{focusOptions:c}),su={})),jf=!1,Vl=document&&document.activeElement),document){var f=document&&document.activeElement,h=T$(d),p=h.map(function(m){var y=m.node;return y}).indexOf(f);p>-1&&(h.filter(function(m){var y=m.guard,g=m.node;return y&&g.dataset.focusAutoGuard}).forEach(function(m){var y=m.node;return y.removeAttribute("tabIndex")}),K1(p,h.length,1,h),K1(p,-1,-1,h))}}}return t},kM=function(t){rm()&&t&&(t.stopPropagation(),t.preventDefault())},Gb=function(){return Vb(rm)},U$=function(t){var n=t.target,r=t.currentTarget;r.contains(n)||M$(r,n)},V$=function(){return null},AM=function(){jf="just",Vb(function(){jf="meanwhile"})},G$=function(){document.addEventListener("focusin",kM),document.addEventListener("focusout",Gb),window.addEventListener("blur",AM)},W$=function(){document.removeEventListener("focusin",kM),document.removeEventListener("focusout",Gb),window.removeEventListener("blur",AM)};function j$(e){return e.filter(function(t){var n=t.disabled;return!n})}function H$(e){var t=e.slice(-1)[0];t&&!iu&&G$();var n=iu,r=n&&t&&t.id===n.id;iu=t,n&&!r&&(n.onDeactivation(),e.filter(function(i){var s=i.id;return s===n.id}).length||n.returnFocus(!t)),t?(Vl=null,(!r||n.observed!==t.observed)&&t.onActivation(),rm(),Vb(rm)):(W$(),Vl=null)}oM.assignSyncMedium(U$);aM.assignMedium(Gb);$H.assignMedium(function(e){return e({moveFocusInside:wM,focusInside:SM})});const $$=qH(j$,H$)(V$);var EM=w.forwardRef(function(t,n){return w.createElement(lM,Vf({sideCar:$$,ref:n},t))}),TM=lM.propTypes||{};TM.sideCar;DH(TM,["sideCar"]);EM.propTypes={};const z$=EM,Z$=vt.forwardRef((e,t)=>{const[n,r]=w.useState(!1),i=w.useRef(null);return vt.useImperativeHandle(t,()=>({open(){r(!0)},close(){r(!1)}})),w.useEffect(()=>{var s;n&&((s=i.current)==null||s.focus())},[n]),w.useEffect(()=>{const s=o=>{o.key==="Escape"&&r(!1)};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[]),J.jsx(z$,{disabled:!n,children:J.jsxs("dialog",{className:"preferences-dialog",open:n,ref:i,tabIndex:-1,"aria-label":"Preferences",children:[J.jsx("h1",{style:{color:"white",textAlign:"center",fontSize:"1.5em",padding:"0.5em",margin:"0.5em",border:"1px solid black",borderRadius:"0.5em",backgroundColor:"black"},children:"Preferences"}),n&&J.jsx(OH,{}),J.jsx("button",{onClick:()=>r(!1),children:"Close"}),J.jsx("br",{}),J.jsxs("span",{id:"commit-hash",children:["Version: ",wH]})]})})});var _M={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},J1=vt.createContext&&vt.createContext(_M),Va=function(){return Va=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Va.apply(this,arguments)},X$=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function RM(e){return e&&e.map(function(t,n){return vt.createElement(t.tag,Va({key:n},t.attr),RM(t.child))})}function il(e){return function(t){return vt.createElement(K$,Va({attr:Va({},e.attr)},t),RM(e.child))}}function K$(e){var t=function(n){var r=e.attr,i=e.size,s=e.title,o=X$(e,["attr","size","title"]),a=i||n.size||"1em",c;return n.className&&(c=n.className),e.className&&(c=(c?c+" ":"")+e.className),vt.createElement("svg",Va({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:c,style:Va(Va({color:e.color||n.color},n.style),e.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&vt.createElement("title",null,s),e.children)};return J1!==void 0?vt.createElement(J1.Consumer,null,function(n){return t(n)}):t(_M)}function J$(e){return il({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}}]})(e)}function Y$(e){return il({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(e)}function q$(e){return il({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"}}]})(e)}function xM(e){return il({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(e)}function Q$(e){return il({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"}}]})(e)}function e8(e){return il({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"}}]})(e)}function t8(e){return il({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"}}]})(e)}const n8=({client:e,onClearLog:t,onSaveLog:n,onToggleUsers:r,onOpenPrefs:i})=>{const[s,o]=vt.useState(e.cacophony.muted);return J.jsxs("div",{className:"toolbar",children:[J.jsxs("button",{onClick:n,accessKey:"l",children:[J.jsx(xM,{}),"Save Log"]}),J.jsxs("button",{onClick:t,accessKey:"c",children:[J.jsx(q$,{}),"Clear Log"]}),J.jsxs("button",{onClick:i,accessKey:"p",children:[J.jsx(J$,{}),"Preferences"]}),J.jsxs("button",{onClick:()=>{o(!s),e.cacophony.muted=!s},accessKey:"m",children:[s?J.jsx(t8,{}):J.jsx(e8,{}),s?"Unmute":"Mute"]}),J.jsx("button",{onClick:r,accessKey:"u",children:"Show/Hide Users"}),J.jsxs("label",{children:["Volume",J.jsx("input",{type:"range",min:"0",max:"100",onChange:a=>e.cacophony.setGlobalVolume(Number(a.target.value)/100)})]})]})};class r8 extends vt.Component{constructor(t){super(t),this.state={statusText:"Not connected"},t.client.on("statustext",n=>this.setState({statusText:n})),t.client.on("connect",()=>this.setState({statusText:"Connected"})),t.client.on("disconnect",()=>this.setState({statusText:"Disconnected"}))}render(){return J.jsx("div",{className:"statusbar",children:this.state.statusText})}}const i8=({users:e})=>J.jsxs("div",{className:"sidebar",children:[J.jsx("div",{className:"sidebar-header",role:"heading","aria-level":2,children:"Connected Players"}),J.jsx("div",{className:"sidebar-content",children:J.jsx("ul",{children:e.map(t=>{let n="";return t.away&&(n+=" away"),t.idle&&(n+=" idle"),J.jsx("li",{className:n,children:t.Name},t.Object)})})})]});var Y1={};function s8(e,t){return t.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in e)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(e)}var o8=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function a8(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var NM={exports:{}};(function(e){(function(t,n){e.exports?e.exports=n():t.log=n()})(o8,function(){var t=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function s(m,y){var g=m[y];if(typeof g.bind=="function")return g.bind(m);try{return Function.prototype.bind.call(g,m)}catch{return function(){return Function.prototype.apply.apply(g,[m,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?o:console[m]!==void 0?s(console,m):console.log!==void 0?s(console,"log"):t}function c(m,y){for(var g=0;g<i.length;g++){var v=i[g];this[v]=g<m?t:this.methodFactory(v,m,y)}this.log=this.debug}function l(m,y,g){return function(){typeof console!==n&&(c.call(this,y,g),this[m].apply(this,arguments))}}function u(m,y,g){return a(m)||l.apply(this,arguments)}function d(m,y,g){var v=this,S;y=y??"WARN";var E="loglevel";typeof m=="string"?E+=":"+m:typeof m=="symbol"&&(E=void 0);function k(P){var N=(i[P]||"silent").toUpperCase();if(!(typeof window===n||!E)){try{window.localStorage[E]=N;return}catch{}try{window.document.cookie=encodeURIComponent(E)+"="+N+";"}catch{}}}function b(){var P;if(!(typeof window===n||!E)){try{P=window.localStorage[E]}catch{}if(typeof P===n)try{var N=window.document.cookie,O=N.indexOf(encodeURIComponent(E)+"=");O!==-1&&(P=/^([^;]+)/.exec(N.slice(O))[1])}catch{}return v.levels[P]===void 0&&(P=void 0),P}}function A(){if(!(typeof window===n||!E)){try{window.localStorage.removeItem(E);return}catch{}try{window.document.cookie=encodeURIComponent(E)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}v.name=m,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=g||u,v.getLevel=function(){return S},v.setLevel=function(P,N){if(typeof P=="string"&&v.levels[P.toUpperCase()]!==void 0&&(P=v.levels[P.toUpperCase()]),typeof P=="number"&&P>=0&&P<=v.levels.SILENT){if(S=P,N!==!1&&k(P),c.call(v,P,m),typeof console===n&&P<v.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+P},v.setDefaultLevel=function(P){y=P,b()||v.setLevel(P,!1)},v.resetLevel=function(){v.setLevel(y,!1),A()},v.enableAll=function(P){v.setLevel(v.levels.TRACE,P)},v.disableAll=function(P){v.setLevel(v.levels.SILENT,P)};var _=b();_==null&&(_=y),v.setLevel(_,!1)}var f=new d,h={};f.getLogger=function(y){if(typeof y!="symbol"&&typeof y!="string"||y==="")throw new TypeError("You must supply a name when creating a logger.");var g=h[y];return g||(g=h[y]=new d(y,f.getLevel(),f.methodFactory)),g};var p=typeof window!==n?window.log:void 0;return f.noConflict=function(){return typeof window!==n&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return h},f.default=f,f})})(NM);var Wb=NM.exports,nI;(function(e){e[e.trace=0]="trace",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.silent=5]="silent"})(nI||(nI={}));var Gs;(function(e){e.Default="livekit",e.Room="livekit-room",e.Participant="livekit-participant",e.Track="livekit-track",e.Publication="livekit-track-publication",e.Engine="livekit-engine",e.Signal="livekit-signal",e.PCManager="livekit-pc-manager",e.PCTransport="livekit-pc-transport",e.E2EE="lk-e2ee"})(Gs||(Gs={}));let He=Wb.getLogger("livekit");He.setDefaultLevel(nI.info);function Wo(e){const t=Wb.getLogger(e);return t.setDefaultLevel(He.getLevel()),t}Wb.getLogger("lk-e2ee");function Ar(e,t){if(!e)throw new Error(t)}const c8=34028234663852886e22,l8=-34028234663852886e22,u8=4294967295,d8=2147483647,f8=-2147483648;function Kp(e){if(typeof e!="number")throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>d8||e<f8)throw new Error("invalid int 32: "+e)}function rI(e){if(typeof e!="number")throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>u8||e<0)throw new Error("invalid uint 32: "+e)}function PM(e){if(typeof e!="number")throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>c8||e<l8))throw new Error("invalid float 32: "+e)}const MM=Symbol("@bufbuild/protobuf/enum-type");function h8(e){const t=e[MM];return Ar(t,"missing enum type on enum object"),t}function OM(e,t,n,r){e[MM]=DM(t,n.map(i=>({no:i.no,name:i.name,localName:e[i.no]})))}function DM(e,t,n){const r=Object.create(null),i=Object.create(null),s=[];for(const o of t){const a=LM(o);s.push(a),r[o.name]=a,i[o.no]=a}return{typeName:e,values:s,findName(o){return r[o]},findNumber(o){return i[o]}}}function p8(e,t,n){const r={};for(const i of t){const s=LM(i);r[s.localName]=s.no,r[s.no]=s.localName}return OM(r,e,t),r}function LM(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class pe{equals(t){return this.getType().runtime.util.equals(this.getType(),this,t)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(t,n){const r=this.getType(),i=r.runtime.bin,s=i.makeReadOptions(n);return i.readMessage(this,s.readerFactory(t),t.byteLength,s),this}fromJson(t,n){const r=this.getType(),i=r.runtime.json,s=i.makeReadOptions(n);return i.readMessage(r,t,s,this),this}fromJsonString(t,n){let r;try{r=JSON.parse(t)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(t){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(t),s=i.writerFactory();return r.writeMessage(this,s,i),s.finish()}toJson(t){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(t);return r.writeMessage(this,i)}toJsonString(t){var n;const r=this.toJson(t);return JSON.stringify(r,null,(n=t==null?void 0:t.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function g8(e,t,n,r){var i;const s=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:t.substring(t.lastIndexOf(".")+1),o={[s]:function(a){e.util.initFields(this),e.util.initPartial(a,this)}}[s];return Object.setPrototypeOf(o.prototype,new pe),Object.assign(o,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary(a,c){return new o().fromBinary(a,c)},fromJson(a,c){return new o().fromJson(a,c)},fromJsonString(a,c){return new o().fromJsonString(a,c)},equals(a,c){return e.util.equals(o,a,c)}}),o}function m8(e,t,n,r){return{syntax:e,json:t,bin:n,util:r,makeMessageType(i,s,o){return g8(this,i,s,o)},makeEnum:p8,makeEnumType:DM,getEnumType:h8}}var te;(function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"})(te||(te={}));var Wc;(function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING"})(Wc||(Wc={}));function v8(){let e=0,t=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(n&15)<<28,t=(n&112)>>4,!(n&128))return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Zy(e,t,n){for(let s=0;s<28;s=s+7){const o=e>>>s,a=!(!(o>>>7)&&t==0),c=(a?o|128:o)&255;if(n.push(c),!a)return}const r=e>>>28&15|(t&7)<<4,i=!!(t>>3);if(n.push((i?r|128:r)&255),!!i){for(let s=3;s<31;s=s+7){const o=t>>>s,a=!!(o>>>7),c=(a?o|128:o)&255;if(n.push(c),!a)return}n.push(t>>>31&1)}}const Jp=4294967296;function q1(e){const t=e[0]==="-";t&&(e=e.slice(1));const n=1e6;let r=0,i=0;function s(o,a){const c=Number(e.slice(o,a));i*=n,r=r*n+c,r>=Jp&&(i=i+(r/Jp|0),r=r%Jp)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),t?FM(r,i):jb(r,i)}function y8(e,t){let n=jb(e,t);const r=n.hi&2147483648;r&&(n=FM(n.lo,n.hi));const i=BM(n.lo,n.hi);return r?"-"+i:i}function BM(e,t){if({lo:e,hi:t}=C8(e,t),t<=2097151)return String(Jp*t+e);const n=e&16777215,r=(e>>>24|t<<8)&16777215,i=t>>16&65535;let s=n+r*6777216+i*6710656,o=r+i*8147497,a=i*2;const c=1e7;return s>=c&&(o+=Math.floor(s/c),s%=c),o>=c&&(a+=Math.floor(o/c),o%=c),a.toString()+Q1(o)+Q1(s)}function C8(e,t){return{lo:e>>>0,hi:t>>>0}}function jb(e,t){return{lo:e|0,hi:t|0}}function FM(e,t){return t=~t,e?e=~e+1:t+=1,jb(e,t)}const Q1=e=>{const t=String(e);return"0000000".slice(t.length)+t};function eE(e,t){if(e>=0){for(;e>127;)t.push(e&127|128),e=e>>>7;t.push(e)}else{for(let n=0;n<9;n++)t.push(e&127|128),e=e>>7;t.push(1)}}function I8(){let e=this.buf[this.pos++],t=e&127;if(!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<7,!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<14,!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<21,!(e&128))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(e&15)<<28;for(let n=5;e&128&&n<10;n++)e=this.buf[this.pos++];if(e&128)throw new Error("invalid varint");return this.assertBounds(),t>>>0}function S8(){const e=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof e.getBigInt64=="function"&&typeof e.getBigUint64=="function"&&typeof e.setBigInt64=="function"&&typeof e.setBigUint64=="function"&&(typeof process!="object"||typeof Y1!="object"||Y1.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),s=BigInt("9223372036854775807"),o=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>s||l<i)throw new Error("int64 invalid: ".concat(c));return l},uParse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>a||l<o)throw new Error("uint64 invalid: ".concat(c));return l},enc(c){return e.setBigInt64(0,this.parse(c),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(c){return e.setBigInt64(0,this.uParse(c),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec(c,l){return e.setInt32(0,c,!0),e.setInt32(4,l,!0),e.getBigInt64(0,!0)},uDec(c,l){return e.setInt32(0,c,!0),e.setInt32(4,l,!0),e.getBigUint64(0,!0)}}}const n=i=>Ar(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>Ar(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),q1(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),q1(i)},dec(i,s){return y8(i,s)},uDec(i,s){return BM(i,s)}}}const Le=S8();var Qt;(function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"})(Qt||(Qt={}));class b8{constructor(t){this.stack=[],this.textEncoder=t??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let t=0;for(let i=0;i<this.chunks.length;i++)t+=this.chunks[i].length;let n=new Uint8Array(t),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let t=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(t.byteLength),this.raw(t)}tag(t,n){return this.uint32((t<<3|n)>>>0)}raw(t){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(t),this}uint32(t){for(rI(t);t>127;)this.buf.push(t&127|128),t=t>>>7;return this.buf.push(t),this}int32(t){return Kp(t),eE(t,this.buf),this}bool(t){return this.buf.push(t?1:0),this}bytes(t){return this.uint32(t.byteLength),this.raw(t)}string(t){let n=this.textEncoder.encode(t);return this.uint32(n.byteLength),this.raw(n)}float(t){PM(t);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,t,!0),this.raw(n)}double(t){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,t,!0),this.raw(n)}fixed32(t){rI(t);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t,!0),this.raw(n)}sfixed32(t){Kp(t);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,t,!0),this.raw(n)}sint32(t){return Kp(t),t=(t<<1^t>>31)>>>0,eE(t,this.buf),this}sfixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Le.enc(t);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Le.uEnc(t);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(t){let n=Le.enc(t);return Zy(n.lo,n.hi,this.buf),this}sint64(t){let n=Le.enc(t),r=n.hi>>31,i=n.lo<<1^r,s=(n.hi<<1|n.lo>>>31)^r;return Zy(i,s,this.buf),this}uint64(t){let n=Le.uEnc(t);return Zy(n.lo,n.hi,this.buf),this}}class w8{constructor(t,n){this.varint64=v8,this.uint32=I8,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.textDecoder=n??new TextDecoder}tag(){let t=this.uint32(),n=t>>>3,r=t&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(t){let n=this.pos;switch(t){case Qt.Varint:for(;this.buf[this.pos++]&128;);break;case Qt.Bit64:this.pos+=4;case Qt.Bit32:this.pos+=4;break;case Qt.LengthDelimited:let r=this.uint32();this.pos+=r;break;case Qt.StartGroup:let i;for(;(i=this.tag()[1])!==Qt.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+t)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)}int64(){return Le.dec(...this.varint64())}uint64(){return Le.uDec(...this.varint64())}sint64(){let[t,n]=this.varint64(),r=-(t&1);return t=(t>>>1|(n&1)<<31)^r,n=n>>>1^r,Le.dec(t,n)}bool(){let[t,n]=this.varint64();return t!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Le.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Le.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let t=this.uint32(),n=this.pos;return this.pos+=t,this.assertBounds(),this.buf.subarray(n,n+t)}string(){return this.textDecoder.decode(this.bytes())}}function iI(e,t){return t instanceof pe||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}te.DOUBLE,te.FLOAT,te.INT64,te.UINT64,te.INT32,te.UINT32,te.BOOL,te.STRING,te.BYTES;function ra(e,t,n){if(t===n)return!0;if(e==te.BYTES){if(!(t instanceof Uint8Array)||!(n instanceof Uint8Array)||t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==n[r])return!1;return!0}switch(e){case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return t==n}return!1}function sI(e,t){switch(e){case te.BOOL:return!1;case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return t==0?Le.zero:"0";case te.DOUBLE:case te.FLOAT:return 0;case te.BYTES:return new Uint8Array(0);case te.STRING:return"";default:return 0}}function UM(e,t){const n=t===void 0;let r=Qt.Varint,i=t===0;switch(e){case te.STRING:i=n||!t.length,r=Qt.LengthDelimited;break;case te.BOOL:i=t===!1;break;case te.DOUBLE:r=Qt.Bit64;break;case te.FLOAT:r=Qt.Bit32;break;case te.INT64:i=n||t==0;break;case te.UINT64:i=n||t==0;break;case te.FIXED64:i=n||t==0,r=Qt.Bit64;break;case te.BYTES:i=n||!t.byteLength,r=Qt.LengthDelimited;break;case te.FIXED32:r=Qt.Bit32;break;case te.SFIXED32:r=Qt.Bit32;break;case te.SFIXED64:i=n||t==0,r=Qt.Bit64;break;case te.SINT64:i=n||t==0;break}const s=te[e].toLowerCase();return[r,s,n||i]}const vl=Symbol("@bufbuild/protobuf/unknown-fields"),tE={readUnknownFields:!0,readerFactory:e=>new w8(e)},nE={writeUnknownFields:!0,writerFactory:()=>new b8};function k8(e){return e?Object.assign(Object.assign({},tE),e):tE}function A8(e){return e?Object.assign(Object.assign({},nE),e):nE}function E8(){return{makeReadOptions:k8,makeWriteOptions:A8,listUnknownFields(e){var t;return(t=e[vl])!==null&&t!==void 0?t:[]},discardUnknownFields(e){delete e[vl]},writeUnknownFields(e,t){const r=e[vl];if(r)for(const i of r)t.tag(i.no,i.wireType).raw(i.data)},onUnknownField(e,t,n,r){const i=e;Array.isArray(i[vl])||(i[vl]=[]),i[vl].push({no:t,wireType:n,data:r})},readMessage(e,t,n,r){const i=e.getType(),s=n===void 0?t.len:t.pos+n;for(;t.pos<s;){const[o,a]=t.tag(),c=i.fields.find(o);if(!c){const f=t.skip(a);r.readUnknownFields&&this.onUnknownField(e,o,a,f);continue}let l=e,u=c.repeated,d=c.localName;switch(c.oneof&&(l=l[c.oneof.localName],l.case!=d&&delete l.value,l.case=d,d="value"),c.kind){case"scalar":case"enum":const f=c.kind=="enum"?te.INT32:c.T;let h=im;if(c.kind=="scalar"&&c.L>0&&(h=_8),u){let g=l[d];if(a==Qt.LengthDelimited&&f!=te.STRING&&f!=te.BYTES){let v=t.uint32()+t.pos;for(;t.pos<v;)g.push(h(t,f))}else g.push(h(t,f))}else l[d]=h(t,f);break;case"message":const p=c.T;u?l[d].push(Yp(t,new p,r)):l[d]instanceof pe?Yp(t,l[d],r):(l[d]=Yp(t,new p,r),p.fieldWrapper&&!c.oneof&&!c.repeated&&(l[d]=p.fieldWrapper.unwrapField(l[d])));break;case"map":let[m,y]=T8(c,t,r);l[d][m]=y;break}}}}}function Yp(e,t,n){return t.getType().runtime.bin.readMessage(t,e,e.uint32(),n),t}function T8(e,t,n){const r=t.uint32(),i=t.pos+r;let s,o;for(;t.pos<i;){let[a]=t.tag();switch(a){case 1:s=im(t,e.K);break;case 2:switch(e.V.kind){case"scalar":o=im(t,e.V.T);break;case"enum":o=t.int32();break;case"message":o=Yp(t,new e.V.T,n);break}break}}if(s===void 0){let a=sI(e.K,Wc.BIGINT);s=e.K==te.BOOL?a.toString():a}if(typeof s!="string"&&typeof s!="number"&&(s=s.toString()),o===void 0)switch(e.V.kind){case"scalar":o=sI(e.V.T,Wc.BIGINT);break;case"enum":o=0;break;case"message":o=new e.V.T;break}return[s,o]}function _8(e,t){const n=im(e,t);return typeof n=="bigint"?n.toString():n}function im(e,t){switch(t){case te.STRING:return e.string();case te.BOOL:return e.bool();case te.DOUBLE:return e.double();case te.FLOAT:return e.float();case te.INT32:return e.int32();case te.INT64:return e.int64();case te.UINT64:return e.uint64();case te.FIXED64:return e.fixed64();case te.BYTES:return e.bytes();case te.FIXED32:return e.fixed32();case te.SFIXED32:return e.sfixed32();case te.SFIXED64:return e.sfixed64();case te.SINT64:return e.sint64();case te.UINT32:return e.uint32();case te.SINT32:return e.sint32()}}function R8(e,t,n,r,i){e.tag(n.no,Qt.LengthDelimited),e.fork();let s=r;switch(n.K){case te.INT32:case te.FIXED32:case te.UINT32:case te.SFIXED32:case te.SINT32:s=Number.parseInt(r);break;case te.BOOL:Ar(r=="true"||r=="false"),s=r=="true";break}switch(of(e,n.K,1,s,!0),n.V.kind){case"scalar":of(e,n.V.T,2,i,!0);break;case"enum":of(e,te.INT32,2,i,!0);break;case"message":oI(e,t,n.V.T,2,i);break}e.join()}function oI(e,t,n,r,i){if(i!==void 0){const s=iI(n,i);e.tag(r,Qt.LengthDelimited).bytes(s.toBinary(t))}}function of(e,t,n,r,i){let[s,o,a]=UM(t,r);(!a||i)&&e.tag(n,s)[o](r)}function x8(e,t,n,r){if(!r.length)return;e.tag(n,Qt.LengthDelimited).fork();let[,i]=UM(t);for(let s=0;s<r.length;s++)e[i](r[s]);e.join()}function N8(){return Object.assign(Object.assign({},E8()),{writeMessage(e,t,n){const r=e.getType();for(const i of r.fields.byNumber()){let s,o=i.repeated,a=i.localName;if(i.oneof){const c=e[i.oneof.localName];if(c.case!==a)continue;s=c.value}else s=e[a];switch(i.kind){case"scalar":case"enum":let c=i.kind=="enum"?te.INT32:i.T;if(o)if(i.packed)x8(t,c,i.no,s);else for(const l of s)of(t,c,i.no,l,!0);else s!==void 0&&of(t,c,i.no,s,!!i.oneof||i.opt);break;case"message":if(o)for(const l of s)oI(t,n,i.T,i.no,l);else oI(t,n,i.T,i.no,s);break;case"map":for(const[l,u]of Object.entries(s))R8(t,n,i,l,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(e,t),t}})}let ro="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),cv=[];for(let e=0;e<ro.length;e++)cv[ro[e].charCodeAt(0)]=e;cv[45]=ro.indexOf("+");cv[95]=ro.indexOf("/");const VM={dec(e){let t=e.length*3/4;e[e.length-2]=="="?t-=2:e[e.length-1]=="="&&(t-=1);let n=new Uint8Array(t),r=0,i=0,s,o=0;for(let a=0;a<e.length;a++){if(s=cv[e.charCodeAt(a)],s===void 0)switch(e[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:o=s,i=1;break;case 1:n[r++]=o<<2|(s&48)>>4,o=s,i=2;break;case 2:n[r++]=(o&15)<<4|(s&60)>>2,o=s,i=3;break;case 3:n[r++]=(o&3)<<6|s,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(e){let t="",n=0,r,i=0;for(let s=0;s<e.length;s++)switch(r=e[s],n){case 0:t+=ro[r>>2],i=(r&3)<<4,n=1;break;case 1:t+=ro[i|r>>4],i=(r&15)<<2,n=2;break;case 2:t+=ro[i|r>>6],t+=ro[r&63],n=0;break}return n&&(t+=ro[i],t+="=",n==1&&(t+="=")),t}},rE={ignoreUnknownFields:!1},iE={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function P8(e){return e?Object.assign(Object.assign({},rE),e):rE}function M8(e){return e?Object.assign(Object.assign({},iE),e):iE}function O8(e){const t=e(D8,sE);return{makeReadOptions:P8,makeWriteOptions:M8,readMessage(n,r,i,s){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(r)));s=s??new n;const o={};for(const[a,c]of Object.entries(r)){const l=n.fields.findJsonName(a);if(!l){if(!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(a,'" is unknown'));continue}let u=l.localName,d=s;if(l.oneof){if(c===null&&l.kind=="scalar")continue;const f=o[l.oneof.localName];if(f)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(l.oneof.name,'" present: "').concat(f,'", "').concat(a,'"'));o[l.oneof.localName]=a,d=d[l.oneof.localName]={case:u},u="value"}if(l.repeated){if(c===null)continue;if(!Array.isArray(c))throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const f=d[u];for(const h of c){if(h===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(h)));let p;switch(l.kind){case"message":p=l.T.fromJson(h,i);break;case"enum":if(p=Xy(l.T,h,i.ignoreUnknownFields),p===void 0)continue;break;case"scalar":try{p=wd(l.T,h,l.L)}catch(m){let y="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(h));throw m instanceof Error&&m.message.length>0&&(y+=": ".concat(m.message)),new Error(y)}break}f.push(p)}}else if(l.kind=="map"){if(c===null)continue;if(Array.isArray(c)||typeof c!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c)));const f=d[u];for(const[h,p]of Object.entries(c)){if(p===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: map value null"));let m;switch(l.V.kind){case"message":m=l.V.T.fromJson(p,i);break;case"enum":if(m=Xy(l.V.T,p,i.ignoreUnknownFields),m===void 0)continue;break;case"scalar":try{m=wd(l.V.T,p,Wc.BIGINT)}catch(y){let g="cannot decode map value for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw y instanceof Error&&y.message.length>0&&(g+=": ".concat(y.message)),new Error(g)}break}try{f[wd(l.K,l.K==te.BOOL?h=="true"?!0:h=="false"?!1:h:h,Wc.BIGINT).toString()]=m}catch(y){let g="cannot decode map key for field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw y instanceof Error&&y.message.length>0&&(g+=": ".concat(y.message)),new Error(g)}}}else switch(l.kind){case"message":const f=l.T;if(c===null&&f.typeName!="google.protobuf.Value"){if(l.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(l.name,' from JSON: null is invalid for oneof field "').concat(a,'"'));continue}d[u]instanceof pe?d[u].fromJson(c,i):(d[u]=f.fromJson(c,i),f.fieldWrapper&&!l.oneof&&(d[u]=f.fieldWrapper.unwrapField(d[u])));break;case"enum":const h=Xy(l.T,c,i.ignoreUnknownFields);h!==void 0&&(d[u]=h);break;case"scalar":try{d[u]=wd(l.T,c,l.L)}catch(p){let m="cannot decode field ".concat(n.typeName,".").concat(l.name," from JSON: ").concat(this.debug(c));throw p instanceof Error&&p.message.length>0&&(m+=": ".concat(p.message)),new Error(m)}break}}return s},writeMessage(n,r){const i=n.getType(),s={};let o;try{for(const a of i.fields.byMember()){let c;if(a.kind=="oneof"){const l=n[a.localName];if(l.value===void 0)continue;if(o=a.findField(l.case),!o)throw"oneof case not found: "+l.case;c=t(o,l.value,r)}else o=a,c=t(o,n[o.localName],r);c!==void 0&&(s[r.useProtoFieldName?o.name:o.jsonName]=c)}}catch(a){const c=o?"cannot encode field ".concat(i.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),l=a instanceof Error?a.message:String(a);throw new Error(c+(l.length>0?": ".concat(l):""))}return s},readScalar:wd,writeScalar:sE,debug:GM}}function GM(e){if(e===null)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return String(e)}}function wd(e,t,n){switch(e){case te.DOUBLE:case te.FLOAT:if(t===null)return 0;if(t==="NaN")return Number.NaN;if(t==="Infinity")return Number.POSITIVE_INFINITY;if(t==="-Infinity")return Number.NEGATIVE_INFINITY;if(t===""||typeof t=="string"&&t.trim().length!==t.length||typeof t!="string"&&typeof t!="number")break;const r=Number(t);if(Number.isNaN(r)||!Number.isFinite(r))break;return e==te.FLOAT&&PM(r),r;case te.INT32:case te.FIXED32:case te.SFIXED32:case te.SINT32:case te.UINT32:if(t===null)return 0;let i;if(typeof t=="number"?i=t:typeof t=="string"&&t.length>0&&t.trim().length===t.length&&(i=Number(t)),i===void 0)break;return e==te.UINT32?rI(i):Kp(i),i;case te.INT64:case te.SFIXED64:case te.SINT64:if(t===null)return Le.zero;if(typeof t!="number"&&typeof t!="string")break;const s=Le.parse(t);return n?s.toString():s;case te.FIXED64:case te.UINT64:if(t===null)return Le.zero;if(typeof t!="number"&&typeof t!="string")break;const o=Le.uParse(t);return n?o.toString():o;case te.BOOL:if(t===null)return!1;if(typeof t!="boolean")break;return t;case te.STRING:if(t===null)return"";if(typeof t!="string")break;try{encodeURIComponent(t)}catch{throw new Error("invalid UTF8")}return t;case te.BYTES:if(t===null||t==="")return new Uint8Array(0);if(typeof t!="string")break;return VM.dec(t)}throw new Error}function Xy(e,t,n){if(t===null)return 0;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const r=e.findName(t);if(r||n)return r==null?void 0:r.no;break}throw new Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(GM(t)))}function D8(e,t,n,r){var i;if(t===void 0)return t;if(t===0&&!n)return;if(r)return t;if(e.typeName=="google.protobuf.NullValue")return null;const s=e.findNumber(t);return(i=s==null?void 0:s.name)!==null&&i!==void 0?i:t}function sE(e,t,n){if(t!==void 0)switch(e){case te.INT32:case te.SFIXED32:case te.SINT32:case te.FIXED32:case te.UINT32:return Ar(typeof t=="number"),t!=0||n?t:void 0;case te.FLOAT:case te.DOUBLE:return Ar(typeof t=="number"),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t!==0||n?t:void 0;case te.STRING:return Ar(typeof t=="string"),t.length>0||n?t:void 0;case te.BOOL:return Ar(typeof t=="boolean"),t||n?t:void 0;case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return Ar(typeof t=="bigint"||typeof t=="string"||typeof t=="number"),n||t!=0?t.toString(10):void 0;case te.BYTES:return Ar(t instanceof Uint8Array),n||t.byteLength>0?VM.enc(t):void 0}}function L8(){return O8((e,t)=>function(r,i,s){if(r.kind=="map"){const o={};switch(r.V.kind){case"scalar":for(const[c,l]of Object.entries(i)){const u=t(r.V.T,l,!0);Ar(u!==void 0),o[c.toString()]=u}break;case"message":for(const[c,l]of Object.entries(i))o[c.toString()]=l.toJson(s);break;case"enum":const a=r.V.T;for(const[c,l]of Object.entries(i)){Ar(l===void 0||typeof l=="number");const u=e(a,l,!0,s.enumAsInteger);Ar(u!==void 0),o[c.toString()]=u}break}return s.emitDefaultValues||Object.keys(o).length>0?o:void 0}else if(r.repeated){const o=[];switch(r.kind){case"scalar":for(let a=0;a<i.length;a++)o.push(t(r.T,i[a],!0));break;case"enum":for(let a=0;a<i.length;a++)o.push(e(r.T,i[a],!0,s.enumAsInteger));break;case"message":for(let a=0;a<i.length;a++)o.push(iI(r.T,i[a]).toJson(s));break}return s.emitDefaultValues||o.length>0?o:void 0}else switch(r.kind){case"scalar":return t(r.T,i,!!r.oneof||r.opt||s.emitDefaultValues);case"enum":return e(r.T,i,!!r.oneof||r.opt||s.emitDefaultValues,s.enumAsInteger);case"message":return i!==void 0?iI(r.T,i).toJson(s):void 0}})}function B8(){return{setEnumType:OM,initPartial(e,t){if(e===void 0)return;const n=t.getType();for(const r of n.fields.byMember()){const i=r.localName,s=t,o=e;if(o[i]!==void 0)switch(r.kind){case"oneof":const a=o[i].case;if(a===void 0)continue;const c=r.findField(a);let l=o[i].value;c&&c.kind=="message"&&!(l instanceof c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===te.BYTES&&(l=kd(l)),s[i]={case:a,value:l};break;case"scalar":case"enum":let u=o[i];r.T===te.BYTES&&(u=r.repeated?u.map(kd):kd(u)),s[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===te.BYTES)for(const[h,p]of Object.entries(o[i]))s[i][h]=kd(p);else Object.assign(s[i],o[i]);break;case"message":const f=r.V.T;for(const h of Object.keys(o[i])){let p=o[i][h];f.fieldWrapper||(p=new f(p)),s[i][h]=p}break}break;case"message":const d=r.T;if(r.repeated)s[i]=o[i].map(f=>f instanceof d?f:new d(f));else if(o[i]!==void 0){const f=o[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?s[i]=kd(f):s[i]=f:s[i]=f instanceof d?f:new d(f)}break}}},equals(e,t,n){return t===n?!0:!t||!n?!1:e.fields.byMember().every(r=>{const i=t[r.localName],s=n[r.localName];if(r.repeated){if(i.length!==s.length)return!1;switch(r.kind){case"message":return i.every((o,a)=>r.T.equals(o,s[a]));case"scalar":return i.every((o,a)=>ra(r.T,o,s[a]));case"enum":return i.every((o,a)=>ra(te.INT32,o,s[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,s);case"enum":return ra(te.INT32,i,s);case"scalar":return ra(r.T,i,s);case"oneof":if(i.case!==s.case)return!1;const o=r.findField(i.case);if(o===void 0)return!0;switch(o.kind){case"message":return o.T.equals(i.value,s.value);case"enum":return ra(te.INT32,i.value,s.value);case"scalar":return ra(o.T,i.value,s.value)}throw new Error("oneof cannot contain ".concat(o.kind));case"map":const a=Object.keys(i).concat(Object.keys(s));switch(r.V.kind){case"message":const c=r.V.T;return a.every(u=>c.equals(i[u],s[u]));case"enum":return a.every(u=>ra(te.INT32,i[u],s[u]));case"scalar":const l=r.V.T;return a.every(u=>ra(l,i[u],s[u]))}break}})},clone(e){const t=e.getType(),n=new t,r=n;for(const i of t.fields.byMember()){const s=e[i.localName];let o;if(i.repeated)o=s.map(op);else if(i.kind=="map"){o=r[i.localName];for(const[a,c]of Object.entries(s))o[a]=op(c)}else i.kind=="oneof"?o=i.findField(s.case)?{case:s.case,value:op(s.value)}:{case:void 0}:o=op(s);r[i.localName]=o}return n}}}function op(e){if(e===void 0)return e;if(e instanceof pe)return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function kd(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class F8{constructor(t,n){this._fields=t,this._normalizer=n}findJsonName(t){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[t]}find(t){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[t]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((t,n)=>t.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const t=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,t.push(n)):t.push(r)}return this.members}}function WM(e,t){const n=jM(e);return t?n:H8(j8(n))}function U8(e){return WM(e,!1)}const V8=jM;function jM(e){let t=!1;const n=[];for(let r=0;r<e.length;r++){let i=e.charAt(r);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const G8=new Set(["constructor","toString","toJSON","valueOf"]),W8=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),HM=e=>"".concat(e,"$"),j8=e=>W8.has(e)?HM(e):e,H8=e=>G8.has(e)?HM(e):e;class $8{constructor(t){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=t,this.localName=U8(t)}addField(t){Ar(t.oneof===this,"field ".concat(t.name," not one of ").concat(this.name)),this.fields.push(t)}findField(t){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[t]}}const R=m8("proto3",L8(),N8(),Object.assign(Object.assign({},B8()),{newFieldList(e){return new F8(e,z8)},initFields(e){for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,r=e;if(t.repeated){r[n]=[];continue}switch(t.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=sI(t.T,t.L);break}}}}));function z8(e){var t,n,r,i;const s=[];let o;for(const a of typeof e=="function"?e():e){const c=a;if(c.localName=WM(a.name,a.oneof!==void 0),c.jsonName=(t=a.jsonName)!==null&&t!==void 0?t:V8(a.name),c.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(c.L=(r=a.L)!==null&&r!==void 0?r:Wc.BIGINT),c.packed=(i=a.packed)!==null&&i!==void 0?i:a.kind=="enum"||a.kind=="scalar"&&a.T!=te.BYTES&&a.T!=te.STRING,a.oneof!==void 0){const l=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!o||o.name!=l)&&(o=new $8(l)),c.oneof=o,o.addField(c)}s.push(c)}return s}class Tn extends pe{constructor(t){super(),this.seconds=Le.zero,this.nanos=0,R.util.initPartial(t,this)}fromJson(t,n){if(typeof t!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(R.json.debug(t)));const r=t.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Le.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(t){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Tn.fromDate(new Date)}static fromDate(t){const n=t.getTime();return new Tn({seconds:Le.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(t,n){return new Tn().fromBinary(t,n)}static fromJson(t,n){return new Tn().fromJson(t,n)}static fromJsonString(t,n){return new Tn().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Tn,t,n)}}Tn.runtime=R;Tn.typeName="google.protobuf.Timestamp";Tn.fields=R.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var aI;(function(e){e[e.DEFAULT_AC=0]="DEFAULT_AC",e[e.OPUS=1]="OPUS",e[e.AAC=2]="AAC"})(aI||(aI={}));R.util.setEnumType(aI,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var cI;(function(e){e[e.DEFAULT_VC=0]="DEFAULT_VC",e[e.H264_BASELINE=1]="H264_BASELINE",e[e.H264_MAIN=2]="H264_MAIN",e[e.H264_HIGH=3]="H264_HIGH",e[e.VP8=4]="VP8"})(cI||(cI={}));R.util.setEnumType(cI,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var lI;(function(e){e[e.IC_DEFAULT=0]="IC_DEFAULT",e[e.IC_JPEG=1]="IC_JPEG"})(lI||(lI={}));R.util.setEnumType(lI,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var Yn;(function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO",e[e.DATA=2]="DATA"})(Yn||(Yn={}));R.util.setEnumType(Yn,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var en;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CAMERA=1]="CAMERA",e[e.MICROPHONE=2]="MICROPHONE",e[e.SCREEN_SHARE=3]="SCREEN_SHARE",e[e.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(en||(en={}));R.util.setEnumType(en,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var vn;(function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e[e.OFF=3]="OFF"})(vn||(vn={}));R.util.setEnumType(vn,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var oo;(function(e){e[e.POOR=0]="POOR",e[e.GOOD=1]="GOOD",e[e.EXCELLENT=2]="EXCELLENT",e[e.LOST=3]="LOST"})(oo||(oo={}));R.util.setEnumType(oo,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var qi;(function(e){e[e.UNSET=0]="UNSET",e[e.DISABLED=1]="DISABLED",e[e.ENABLED=2]="ENABLED"})(qi||(qi={}));R.util.setEnumType(qi,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var Mo;(function(e){e[e.UNKNOWN_REASON=0]="UNKNOWN_REASON",e[e.CLIENT_INITIATED=1]="CLIENT_INITIATED",e[e.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",e[e.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",e[e.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",e[e.ROOM_DELETED=5]="ROOM_DELETED",e[e.STATE_MISMATCH=6]="STATE_MISMATCH",e[e.JOIN_FAILURE=7]="JOIN_FAILURE"})(Mo||(Mo={}));R.util.setEnumType(Mo,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var eo;(function(e){e[e.RR_UNKNOWN=0]="RR_UNKNOWN",e[e.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",e[e.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",e[e.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",e[e.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(eo||(eo={}));R.util.setEnumType(eo,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var Hf;(function(e){e[e.SE_UNKNOWN=0]="SE_UNKNOWN",e[e.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",e[e.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(Hf||(Hf={}));R.util.setEnumType(Hf,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let ed=class jd extends pe{constructor(t){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=Le.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,R.util.initPartial(t,this)}static fromBinary(t,n){return new jd().fromBinary(t,n)}static fromJson(t,n){return new jd().fromJson(t,n)}static fromJsonString(t,n){return new jd().fromJsonString(t,n)}static equals(t,n){return R.util.equals(jd,t,n)}};ed.runtime=R;ed.typeName="livekit.Room";ed.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Ui,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class Ui extends pe{constructor(t){super(),this.mime="",this.fmtpLine="",R.util.initPartial(t,this)}static fromBinary(t,n){return new Ui().fromBinary(t,n)}static fromJson(t,n){return new Ui().fromJson(t,n)}static fromJsonString(t,n){return new Ui().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Ui,t,n)}}Ui.runtime=R;Ui.typeName="livekit.Codec";Ui.fields=R.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class Aa extends pe{constructor(t){super(),this.enabled=!1,this.min=0,this.max=0,R.util.initPartial(t,this)}static fromBinary(t,n){return new Aa().fromBinary(t,n)}static fromJson(t,n){return new Aa().fromJson(t,n)}static fromJsonString(t,n){return new Aa().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Aa,t,n)}}Aa.runtime=R;Aa.typeName="livekit.PlayoutDelay";Aa.fields=R.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class ao extends pe{constructor(t){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,R.util.initPartial(t,this)}static fromBinary(t,n){return new ao().fromBinary(t,n)}static fromJson(t,n){return new ao().fromJson(t,n)}static fromJsonString(t,n){return new ao().fromJsonString(t,n)}static equals(t,n){return R.util.equals(ao,t,n)}}ao.runtime=R;ao.typeName="livekit.ParticipantPermission";ao.fields=R.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:R.getEnumType(en),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class Jr extends pe{constructor(t){super(),this.sid="",this.identity="",this.state=jc.JOINING,this.tracks=[],this.metadata="",this.joinedAt=Le.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,R.util.initPartial(t,this)}static fromBinary(t,n){return new Jr().fromBinary(t,n)}static fromJson(t,n){return new Jr().fromJson(t,n)}static fromJsonString(t,n){return new Jr().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Jr,t,n)}}Jr.runtime=R;Jr.typeName="livekit.ParticipantInfo";Jr.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:R.getEnumType(jc)},{no:4,name:"tracks",kind:"message",T:Tr,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:ao},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var jc;(function(e){e[e.JOINING=0]="JOINING",e[e.JOINED=1]="JOINED",e[e.ACTIVE=2]="ACTIVE",e[e.DISCONNECTED=3]="DISCONNECTED"})(jc||(jc={}));R.util.setEnumType(jc,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class Ea extends pe{constructor(t){super(),R.util.initPartial(t,this)}static fromBinary(t,n){return new Ea().fromBinary(t,n)}static fromJson(t,n){return new Ea().fromJson(t,n)}static fromJsonString(t,n){return new Ea().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Ea,t,n)}}Ea.runtime=R;Ea.typeName="livekit.Encryption";Ea.fields=R.util.newFieldList(()=>[]);var Dn;(function(e){e[e.NONE=0]="NONE",e[e.GCM=1]="GCM",e[e.CUSTOM=2]="CUSTOM"})(Dn||(Dn={}));R.util.setEnumType(Dn,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class co extends pe{constructor(t){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new co().fromBinary(t,n)}static fromJson(t,n){return new co().fromJson(t,n)}static fromJsonString(t,n){return new co().fromJsonString(t,n)}static equals(t,n){return R.util.equals(co,t,n)}}co.runtime=R;co.typeName="livekit.SimulcastCodecInfo";co.fields=R.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:fr,repeated:!0}]);class Tr extends pe{constructor(t){super(),this.sid="",this.type=Yn.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=en.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=Dn.NONE,this.stream="",R.util.initPartial(t,this)}static fromBinary(t,n){return new Tr().fromBinary(t,n)}static fromJson(t,n){return new Tr().fromJson(t,n)}static fromJsonString(t,n){return new Tr().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Tr,t,n)}}Tr.runtime=R;Tr.typeName="livekit.TrackInfo";Tr.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:R.getEnumType(Yn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:R.getEnumType(en)},{no:10,name:"layers",kind:"message",T:fr,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:co,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:R.getEnumType(Dn)},{no:17,name:"stream",kind:"scalar",T:9}]);class fr extends pe{constructor(t){super(),this.quality=vn.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,R.util.initPartial(t,this)}static fromBinary(t,n){return new fr().fromBinary(t,n)}static fromJson(t,n){return new fr().fromJson(t,n)}static fromJsonString(t,n){return new fr().fromJsonString(t,n)}static equals(t,n){return R.util.equals(fr,t,n)}}fr.runtime=R;fr.typeName="livekit.VideoLayer";fr.fields=R.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:R.getEnumType(vn)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class ys extends pe{constructor(t){super(),this.kind=dn.RELIABLE,this.value={case:void 0},R.util.initPartial(t,this)}static fromBinary(t,n){return new ys().fromBinary(t,n)}static fromJson(t,n){return new ys().fromJson(t,n)}static fromJsonString(t,n){return new ys().fromJsonString(t,n)}static equals(t,n){return R.util.equals(ys,t,n)}}ys.runtime=R;ys.typeName="livekit.DataPacket";ys.fields=R.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:R.getEnumType(dn)},{no:2,name:"user",kind:"message",T:Is,oneof:"value"},{no:3,name:"speaker",kind:"message",T:lo,oneof:"value"}]);var dn;(function(e){e[e.RELIABLE=0]="RELIABLE",e[e.LOSSY=1]="LOSSY"})(dn||(dn={}));R.util.setEnumType(dn,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class lo extends pe{constructor(t){super(),this.speakers=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new lo().fromBinary(t,n)}static fromJson(t,n){return new lo().fromJson(t,n)}static fromJsonString(t,n){return new lo().fromJsonString(t,n)}static equals(t,n){return R.util.equals(lo,t,n)}}lo.runtime=R;lo.typeName="livekit.ActiveSpeakerUpdate";lo.fields=R.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Cs,repeated:!0}]);class Cs extends pe{constructor(t){super(),this.sid="",this.level=0,this.active=!1,R.util.initPartial(t,this)}static fromBinary(t,n){return new Cs().fromBinary(t,n)}static fromJson(t,n){return new Cs().fromJson(t,n)}static fromJsonString(t,n){return new Cs().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Cs,t,n)}}Cs.runtime=R;Cs.typeName="livekit.SpeakerInfo";Cs.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class Is extends pe{constructor(t){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new Is().fromBinary(t,n)}static fromJson(t,n){return new Is().fromJson(t,n)}static fromJsonString(t,n){return new Is().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Is,t,n)}}Is.runtime=R;Is.typeName="livekit.UserPacket";Is.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class Ss extends pe{constructor(t){super(),this.participantSid="",this.trackSids=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new Ss().fromBinary(t,n)}static fromJson(t,n){return new Ss().fromJson(t,n)}static fromJsonString(t,n){return new Ss().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Ss,t,n)}}Ss.runtime=R;Ss.typeName="livekit.ParticipantTracks";Ss.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class uo extends pe{constructor(t){super(),this.edition=xu.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",R.util.initPartial(t,this)}static fromBinary(t,n){return new uo().fromBinary(t,n)}static fromJson(t,n){return new uo().fromJson(t,n)}static fromJsonString(t,n){return new uo().fromJsonString(t,n)}static equals(t,n){return R.util.equals(uo,t,n)}}uo.runtime=R;uo.typeName="livekit.ServerInfo";uo.fields=R.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:R.getEnumType(xu)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var xu;(function(e){e[e.Standard=0]="Standard",e[e.Cloud=1]="Cloud"})(xu||(xu={}));R.util.setEnumType(xu,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class fo extends pe{constructor(t){super(),this.sdk=Nu.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",R.util.initPartial(t,this)}static fromBinary(t,n){return new fo().fromBinary(t,n)}static fromJson(t,n){return new fo().fromJson(t,n)}static fromJsonString(t,n){return new fo().fromJsonString(t,n)}static equals(t,n){return R.util.equals(fo,t,n)}}fo.runtime=R;fo.typeName="livekit.ClientInfo";fo.fields=R.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:R.getEnumType(Nu)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var Nu;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JS=1]="JS",e[e.SWIFT=2]="SWIFT",e[e.ANDROID=3]="ANDROID",e[e.FLUTTER=4]="FLUTTER",e[e.GO=5]="GO",e[e.UNITY=6]="UNITY",e[e.REACT_NATIVE=7]="REACT_NATIVE",e[e.RUST=8]="RUST",e[e.PYTHON=9]="PYTHON",e[e.CPP=10]="CPP"})(Nu||(Nu={}));R.util.setEnumType(Nu,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class bs extends pe{constructor(t){super(),this.resumeConnection=qi.UNSET,this.forceRelay=qi.UNSET,R.util.initPartial(t,this)}static fromBinary(t,n){return new bs().fromBinary(t,n)}static fromJson(t,n){return new bs().fromJson(t,n)}static fromJsonString(t,n){return new bs().fromJsonString(t,n)}static equals(t,n){return R.util.equals(bs,t,n)}}bs.runtime=R;bs.typeName="livekit.ClientConfiguration";bs.fields=R.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:ws},{no:2,name:"screen",kind:"message",T:ws},{no:3,name:"resume_connection",kind:"enum",T:R.getEnumType(qi)},{no:4,name:"disabled_codecs",kind:"message",T:ho},{no:5,name:"force_relay",kind:"enum",T:R.getEnumType(qi)}]);class ws extends pe{constructor(t){super(),this.hardwareEncoder=qi.UNSET,R.util.initPartial(t,this)}static fromBinary(t,n){return new ws().fromBinary(t,n)}static fromJson(t,n){return new ws().fromJson(t,n)}static fromJsonString(t,n){return new ws().fromJsonString(t,n)}static equals(t,n){return R.util.equals(ws,t,n)}}ws.runtime=R;ws.typeName="livekit.VideoConfiguration";ws.fields=R.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:R.getEnumType(qi)}]);class ho extends pe{constructor(t){super(),this.codecs=[],this.publish=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new ho().fromBinary(t,n)}static fromJson(t,n){return new ho().fromJson(t,n)}static fromJsonString(t,n){return new ho().fromJsonString(t,n)}static equals(t,n){return R.util.equals(ho,t,n)}}ho.runtime=R;ho.typeName="livekit.DisabledCodecs";ho.fields=R.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:Ui,repeated:!0},{no:2,name:"publish",kind:"message",T:Ui,repeated:!0}]);class ks extends pe{constructor(t){super(),this.duration=0,this.startTimestamp=Le.zero,this.endTimestamp=Le.zero,this.rtpClockTicks=Le.zero,this.driftSamples=Le.zero,this.driftMs=0,this.clockRate=0,R.util.initPartial(t,this)}static fromBinary(t,n){return new ks().fromBinary(t,n)}static fromJson(t,n){return new ks().fromJson(t,n)}static fromJsonString(t,n){return new ks().fromJsonString(t,n)}static equals(t,n){return R.util.equals(ks,t,n)}}ks.runtime=R;ks.typeName="livekit.RTPDrift";ks.fields=R.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:Tn},{no:2,name:"end_time",kind:"message",T:Tn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class Ta extends pe{constructor(t){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=Le.zero,this.headerBytes=Le.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=Le.zero,this.headerBytesDuplicate=Le.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=Le.zero,this.headerBytesPadding=Le.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,R.util.initPartial(t,this)}static fromBinary(t,n){return new Ta().fromBinary(t,n)}static fromJson(t,n){return new Ta().fromJson(t,n)}static fromJsonString(t,n){return new Ta().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Ta,t,n)}}Ta.runtime=R;Ta.typeName="livekit.RTPStats";Ta.fields=R.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:Tn},{no:2,name:"end_time",kind:"message",T:Tn},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:Tn},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:Tn},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:Tn},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:Tn},{no:44,name:"packet_drift",kind:"message",T:ks},{no:45,name:"report_drift",kind:"message",T:ks}]);class _a extends pe{constructor(t){super(),this.unixMicro=Le.zero,this.ticks=0,R.util.initPartial(t,this)}static fromBinary(t,n){return new _a().fromBinary(t,n)}static fromJson(t,n){return new _a().fromJson(t,n)}static fromJsonString(t,n){return new _a().fromJsonString(t,n)}static equals(t,n){return R.util.equals(_a,t,n)}}_a.runtime=R;_a.typeName="livekit.TimedVersion";_a.fields=R.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const Ad=7e3,Z8=[0,300,2*2*300,3*3*300,4*4*300,Ad,Ad,Ad,Ad,Ad];class X8{constructor(t){this._retryDelays=t!==void 0?[...t]:Z8}nextRetryDelayInMs(t){if(t.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[t.retryCount];return t.retryCount<=1?n:n+Math.random()*1e3}}function F(e,t,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(e,t||[])).next())})}function oE(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function bl(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof oE=="function"?oE(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Hb={exports:{}},ou=typeof Reflect=="object"?Reflect:null,aE=ou&&typeof ou.apply=="function"?ou.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},qp;ou&&typeof ou.ownKeys=="function"?qp=ou.ownKeys:Object.getOwnPropertySymbols?qp=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:qp=function(t){return Object.getOwnPropertyNames(t)};function K8(e){console&&console.warn&&console.warn(e)}var $M=Number.isNaN||function(t){return t!==t};function lt(){lt.init.call(this)}Hb.exports=lt;Hb.exports.once=Q8;lt.EventEmitter=lt;lt.prototype._events=void 0;lt.prototype._eventsCount=0;lt.prototype._maxListeners=void 0;var cE=10;function lv(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(lt,"defaultMaxListeners",{enumerable:!0,get:function(){return cE},set:function(e){if(typeof e!="number"||e<0||$M(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");cE=e}});lt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};lt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||$M(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function zM(e){return e._maxListeners===void 0?lt.defaultMaxListeners:e._maxListeners}lt.prototype.getMaxListeners=function(){return zM(this)};lt.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[t];if(c===void 0)return!1;if(typeof c=="function")aE(c,this,n);else for(var l=c.length,u=YM(c,l),r=0;r<l;++r)aE(u[r],this,n);return!0};function ZM(e,t,n,r){var i,s,o;if(lv(n),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),o===void 0)o=s[t]=n,++e._eventsCount;else if(typeof o=="function"?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),i=zM(e),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,K8(a)}return e}lt.prototype.addListener=function(t,n){return ZM(this,t,n,!1)};lt.prototype.on=lt.prototype.addListener;lt.prototype.prependListener=function(t,n){return ZM(this,t,n,!0)};function J8(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function XM(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=J8.bind(r);return i.listener=n,r.wrapFn=i,i}lt.prototype.once=function(t,n){return lv(n),this.on(t,XM(this,t,n)),this};lt.prototype.prependOnceListener=function(t,n){return lv(n),this.prependListener(t,XM(this,t,n)),this};lt.prototype.removeListener=function(t,n){var r,i,s,o,a;if(lv(n),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():Y8(r,s),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,a||n)}return this};lt.prototype.off=lt.prototype.removeListener;lt.prototype.removeAllListeners=function(t){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function KM(e,t,n){var r=e._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?q8(i):YM(i,i.length)}lt.prototype.listeners=function(t){return KM(this,t,!0)};lt.prototype.rawListeners=function(t){return KM(this,t,!1)};lt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):JM.call(e,t)};lt.prototype.listenerCount=JM;function JM(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}lt.prototype.eventNames=function(){return this._eventsCount>0?qp(this._events):[]};function YM(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function Y8(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function q8(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function Q8(e,t){return new Promise(function(n,r){function i(o){e.removeListener(t,s),r(o)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}qM(e,t,s,{once:!0}),t!=="error"&&ez(e,i,{once:!0})})}function ez(e,t,n){typeof e.on=="function"&&qM(e,"error",t,n)}function qM(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){r.once&&e.removeEventListener(t,i),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Zs=Hb.exports;let QM=!0,eO=!0;function Qp(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function sl(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(o,a){if(o!==t)return i.apply(this,arguments);const c=l=>{const u=n(l);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(a,c),i.apply(this,[o,c])};const s=r.removeEventListener;r.removeEventListener=function(o,a){if(o!==t||!this._eventMap||!this._eventMap[t])return s.apply(this,arguments);if(!this._eventMap[t].has(a))return s.apply(this,arguments);const c=this._eventMap[t].get(a);return this._eventMap[t].delete(a),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[o,c])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(o){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),o&&this.addEventListener(t,this["_on"+t]=o)},enumerable:!0,configurable:!0})}function tz(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(QM=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function nz(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(eO=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function tO(){if(typeof window=="object"){if(QM)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function $b(e,t){eO&&console.warn(e+" is deprecated, please use "+t+" instead.")}function rz(e){const t={browser:null,version:null};if(typeof e>"u"||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=Qp(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=Qp(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(e.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))t.browser="safari",t.version=Qp(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype;else return t.browser="Not a supported browser.",t;return t}function lE(e){return Object.prototype.toString.call(e)==="[object Object]"}function nO(e){return lE(e)?Object.keys(e).reduce(function(t,n){const r=lE(e[n]),i=r?nO(e[n]):e[n],s=r&&!Object.keys(i).length;return i===void 0||s?t:Object.assign(t,{[n]:i})},{}):e}function uI(e,t,n){!t||n.has(t.id)||(n.set(t.id,t),Object.keys(t).forEach(r=>{r.endsWith("Id")?uI(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(i=>{uI(e,e.get(i),n)})}))}function uE(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(t===null)return i;const s=[];return e.forEach(o=>{o.type==="track"&&o.trackIdentifier===t.id&&s.push(o)}),s.forEach(o=>{e.forEach(a=>{a.type===r&&a.trackId===o.id&&uI(e,a,i)})}),i}const dE=tO;function rO(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const c={};return Object.keys(a).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof a[l]=="object"?a[l]:{ideal:a[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(f,h){return f?f+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(u.ideal!==void 0){c.optional=c.optional||[];let f={};typeof u.ideal=="number"?(f[d("min",l)]=u.ideal,c.optional.push(f),f={},f[d("max",l)]=u.ideal,c.optional.push(f)):(f[d("",l)]=u.ideal,c.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[d("",l)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[d(f,l)]=u[f])})}),a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced)),c},i=function(a,c){if(t.version>=61)return c(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const l=function(u,d,f){d in u&&!(f in u)&&(u[f]=u[d],delete u[d])};a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","googAutoGainControl"),l(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let l=a.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=t.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let d;if(l.exact==="environment"||l.ideal==="environment"?d=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(p=>p.kind==="videoinput");let h=f.find(p=>d.some(m=>p.label.toLowerCase().includes(m)));return!h&&f.length&&d.includes("back")&&(h=f[f.length-1]),h&&(a.video.deviceId=l.exact?{exact:h.deviceId}:{ideal:h.deviceId}),a.video=r(a.video),dE("chrome: "+JSON.stringify(a)),c(a)})}a.video=r(a.video)}return dE("chrome: "+JSON.stringify(a)),c(a)},s=function(a){return t.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(a,c,l){i(a,u=>{n.webkitGetUserMedia(u,c,d=>{l&&l(s(d))})})};if(n.getUserMedia=o.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return i(c,l=>a(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(s(u))))}}}function iz(e,t){if(!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&e.navigator.mediaDevices){if(typeof t!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(i=>{const s=r.video&&r.video.width,o=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:a||3}},s&&(r.video.mandatory.maxWidth=s),o&&(r.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(r)})}}}function iO(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function sO(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let s;e.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):s={track:i.track};const o=new Event("track");o.track=i.track,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(i=>{let s;e.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.id):s={track:i};const o=new Event("track");o.track=i,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else sl(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function oO(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(i,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=i.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:i}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(a,c){let l=i.apply(this,arguments);return l||(l=t(this,a),this._senders.push(l)),l};const s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(a){s.apply(this,arguments);const c=this._senders.indexOf(a);c!==-1&&this._senders.splice(c,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],n.apply(this,[s]),s.getTracks().forEach(o=>{this._senders.push(t(this,o))})};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],r.apply(this,[s]),s.getTracks().forEach(o=>{const a=this._senders.find(c=>c.track===o);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const r=t.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function aO(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[r,i,s]=arguments;if(arguments.length>0&&typeof r=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof r!="function"))return t.apply(this,[]);const o=function(c){const l={};return c.result().forEach(d=>{const f={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach(h=>{f[h]=d.stat(h)}),l[f.id]=f}),l},a=function(c){return new Map(Object.keys(c).map(l=>[l,c[l]]))};if(arguments.length>=2){const c=function(l){i(a(o(l)))};return t.apply(this,[c,r])}return new Promise((c,l)=>{t.apply(this,[function(u){c(a(o(u)))},l])}).then(i,s)}}function cO(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const n=e.RTCPeerConnection.prototype.getSenders;n&&(e.RTCPeerConnection.prototype.getSenders=function(){const s=n.apply(this,[]);return s.forEach(o=>o._pc=this),s});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),e.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(o=>uE(o,s.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(s=>s._pc=this),i}),sl(e,"track",r=>(r.receiver._pc=r.srcElement,r)),e.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(s=>uE(s,i.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const r=arguments[0];let i,s,o;return this.getSenders().forEach(a=>{a.track===r&&(i?o=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(s?o=!0:s=a),a.track===r)),o||i&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function lO(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(o,a){if(!a)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=t.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(c)===-1&&this._shimmedLocalStreams[a.id].push(c):this._shimmedLocalStreams[a.id]=[a,c],c};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(l=>{if(this.getSenders().find(d=>d.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(l=>a.indexOf(l)===-1);this._shimmedLocalStreams[o.id]=[o].concat(c)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const c=this._shimmedLocalStreams[a].indexOf(o);c!==-1&&this._shimmedLocalStreams[a].splice(c,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function uO(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return lO(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(d=>this._reverseStreams[d.id])};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(d=>{if(this.getSenders().find(h=>h.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const d=new e.MediaStream(u.getTracks());this._streams[u.id]=d,this._reverseStreams[d.id]=u,u=d}r.apply(this,[u])};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},e.RTCPeerConnection.prototype.addTrack=function(u,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(m=>m===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(m=>m.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[d.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const m=new e.MediaStream([u]);this._streams[d.id]=m,this._reverseStreams[m.id]=d,this.addStream(m)}return this.getSenders().find(m=>m.track===u)};function s(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const h=l._reverseStreams[f],p=l._streams[h.id];d=d.replace(new RegExp(p.id,"g"),h.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function o(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const h=l._reverseStreams[f],p=l._streams[h.id];d=d.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(l){const u=e.RTCPeerConnection.prototype[l],d={[l](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const m=s(this,p);f[0].apply(null,[m])},p=>{f[1]&&f[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>s(this,p))}};e.RTCPeerConnection.prototype[l]=d[l]});const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=o(this,arguments[0]),a.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:s(this,l)}}),e.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(m=>u.track===m)&&(f=this._streams[h])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function dI(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=e.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[n]=i[n]})}function dO(e,t){sl(e,"negotiationneeded",n=>{const r=n.target;if(!((t.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var fE=Object.freeze({__proto__:null,fixNegotiationNeeded:dO,shimAddTrackRemoveTrack:uO,shimAddTrackRemoveTrackWithNative:lO,shimGetDisplayMedia:iz,shimGetSendersWithDtmf:oO,shimGetStats:aO,shimGetUserMedia:rO,shimMediaStream:iO,shimOnTrack:sO,shimPeerConnection:dI,shimSenderReceiverGetStats:cO});function fO(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(i,s,o){$b("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(s,o)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(o,a,c){a in o&&!(c in o)&&(o[c]=o[a],delete o[a])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o.audio,"autoGainControl","mozAutoGainControl"),i(o.audio,"noiseSuppression","mozNoiseSuppression")),s(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const a=o.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[a])}}}}function sz(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}function hO(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function fI(e,t){if(typeof e!="object"||!(e.RTCPeerConnection||e.mozRTCPeerConnection))return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=e.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};e.RTCPeerConnection.prototype[i]=o[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[s,o,a]=arguments;return r.apply(this,[s||null]).then(c=>{if(t.version<53&&!o)try{c.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((u,d)=>{c.set(d,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(o,a)}}function pO(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const i=t.apply(this,[]);return i.forEach(s=>s._pc=this),i});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function gO(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const r=t.apply(this,[]);return r.forEach(i=>i._pc=this),r}),sl(e,"track",n=>(n.receiver._pc=n.srcElement,n)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function mO(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(n){$b("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function vO(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function yO(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=t.apply(this,arguments);if(i){const{sender:o}=s,a=o.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(a).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return s})}function CO(e){if(!(typeof e=="object"&&e.RTCRtpSender))return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const r=t.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function IO(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function SO(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var hE=Object.freeze({__proto__:null,shimAddTransceiver:yO,shimCreateAnswer:SO,shimCreateOffer:IO,shimGetDisplayMedia:sz,shimGetParameters:CO,shimGetUserMedia:fO,shimOnTrack:hO,shimPeerConnection:fI,shimRTCDataChannel:vO,shimReceiverGetStats:gO,shimRemoveStream:mO,shimSenderGetStats:pO});function bO(e){if(!(typeof e!="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>t.call(this,i,r)),r.getVideoTracks().forEach(i=>t.call(this,i,r))},e.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return s&&s.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(s=>{i.includes(s.track)&&this.removeTrack(s)})})}}function wO(e){if(!(typeof e!="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const s=new Event("addstream");s.stream=i,this.dispatchEvent(s)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(s=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(s)>=0)return;r._remoteStreams.push(s);const o=new Event("addstream");o.stream=s,r.dispatchEvent(o)})}),t.apply(r,arguments)}}}function kO(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,s=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[d]);return u?(f.then(l,u),Promise.resolve()):f},t.createAnswer=function(l,u){const d=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[d]);return u?(f.then(l,u),Promise.resolve()):f};let a=function(c,l,u){const d=i.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d};t.setLocalDescription=a,a=function(c,l,u){const d=s.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},t.setRemoteDescription=a,a=function(c,l,u){const d=o.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},t.addIceCandidate=a}function AO(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=i=>r(EO(i))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=(function(r,i,s){t.mediaDevices.getUserMedia(r).then(i,s)}).bind(t))}function EO(e){return e&&e.video!==void 0?Object.assign({},e,{video:nO(e.video)}):e}function TO(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const s=[];for(let o=0;o<r.iceServers.length;o++){let a=r.iceServers[o];a.urls===void 0&&a.url?($b("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,s.push(a)):s.push(r.iceServers[o])}r.iceServers=s}return new t(r,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get(){return t.generateCertificate}})}function _O(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function RO(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const s=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function xO(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var pE=Object.freeze({__proto__:null,shimAudioContext:xO,shimCallbacksAPI:kO,shimConstraints:EO,shimCreateOfferLegacy:RO,shimGetUserMedia:AO,shimLocalStreamsAPI:bO,shimRTCIceServerUrls:TO,shimRemoteStreamsAPI:wO,shimTrackEventTransceiver:_O}),NO={exports:{}};(function(e){const t={};t.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},t.localCName=t.generateIdentifier(),t.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},t.splitSections=function(n){return n.split(`
m=`).map((i,s)=>(s>0?"m="+i:i).trim()+`\r
`)},t.getDescription=function(n){const r=t.splitSections(n);return r&&r[0]},t.getMediaSections=function(n){const r=t.splitSections(n);return r.shift(),r},t.matchPrefix=function(n,r){return t.splitLines(n).filter(i=>i.indexOf(r)===0)},t.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":i.relatedAddress=r[s+1];break;case"rport":i.relatedPort=parseInt(r[s+1],10);break;case"tcptype":i.tcpType=r[s+1];break;case"ufrag":i.ufrag=r[s+1],i.usernameFragment=r[s+1];break;default:i[r[s]]===void 0&&(i[r[s]]=r[s+1]);break}return i},t.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const s=n.type;return r.push("typ"),r.push(s),s!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},t.parseIceOptions=function(n){return n.substring(14).split(" ")},t.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},t.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},t.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},t.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},t.parseFmtp=function(n){const r={};let i;const s=n.substring(n.indexOf(" ")+1).split(";");for(let o=0;o<s.length;o++)i=s[o].trim().split("="),r[i[0].trim()]=i[1];return r},t.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const s=[];Object.keys(n.parameters).forEach(o=>{n.parameters[o]!==void 0?s.push(o+"="+n.parameters[o]):s.push(o)}),r+="a=fmtp:"+i+" "+s.join(";")+`\r
`}return r},t.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},t.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+i+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},t.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},s=n.indexOf(":",r);return s>-1?(i.attribute=n.substring(r+1,s),i.value=n.substring(s+1)):i.attribute=n.substring(r+1),i},t.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},t.getMid=function(n){const r=t.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},t.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},t.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:t.matchPrefix(n+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(s=>{i+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),i},t.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},t.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?t.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},t.getCryptoParameters=function(n,r){return t.matchPrefix(n+r,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(n,r){const i=t.matchPrefix(n+r,"a=ice-ufrag:")[0],s=t.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substring(12),password:s.substring(10)}:null},t.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},t.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=t.splitLines(n)[0].split(" ");r.profile=s[2];for(let a=3;a<s.length;a++){const c=s[a],l=t.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(l){const u=t.parseRtpMap(l),d=t.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=d.length?t.parseFmtp(d[0]):{},u.rtcpFeedback=t.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(t.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}t.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(t.parseExtmap(a))});const o=t.matchPrefix(n,"a=rtcp-fb:* ").map(t.parseRtcpFb);return r.codecs.forEach(a=>{o.forEach(c=>{a.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||a.rtcpFeedback.push(c)})}),r},t.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{i+=t.writeRtpMap(o),i+=t.writeFmtp(o),i+=t.writeRtcpFb(o)});let s=0;return r.codecs.forEach(o=>{o.maxptime>s&&(s=o.maxptime)}),s>0&&(i+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{i+=t.writeExtmap(o)}),i},t.parseRtpEncodingParameters=function(n){const r=[],i=t.parseRtpParameters(n),s=i.fecMechanisms.indexOf("RED")!==-1,o=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=t.matchPrefix(n,"a=ssrc:").map(f=>t.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),c=a.length>0&&a[0].ssrc;let l;const u=t.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let h={ssrc:c,codecPayloadType:parseInt(f.parameters.apt,10)};c&&l&&(h.rtx={ssrc:l}),r.push(h),s&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},r.push(h))}}),r.length===0&&c&&r.push({ssrc:c});let d=t.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(f=>{f.maxBitrate=d})),r},t.parseRtcpParameters=function(n){const r={},i=t.matchPrefix(n,"a=ssrc:").map(a=>t.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const s=t.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const o=t.matchPrefix(n,"a=rtcp-mux");return r.mux=o.length>0,r},t.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},t.parseMsid=function(n){let r;const i=t.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=t.matchPrefix(n,"a=ssrc:").map(o=>t.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},t.parseSctpDescription=function(n){const r=t.parseMLine(n),i=t.matchPrefix(n,"a=max-message-size:");let s;i.length>0&&(s=parseInt(i[0].substring(19),10)),isNaN(s)&&(s=65536);const o=t.matchPrefix(n,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const a=t.matchPrefix(n,"a=sctpmap:");if(a.length>0){const c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:s}}},t.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(n,r,i){let s;const o=r!==void 0?r:2;return n?s=n:s=t.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+s+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.getDirection=function(n,r){const i=t.splitLines(n);for(let s=0;s<i.length;s++)switch(i[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[s].substring(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(n){return t.splitLines(n)[0].split(" ")[0].substring(2)},t.isRejected=function(n){return n.split(" ",2)[1]==="0"},t.parseMLine=function(n){const i=t.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},t.parseOLine=function(n){const i=t.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},t.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=t.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},e.exports=t})(NO);var PO=NO.exports,au=a8(PO),oz=s8({__proto__:null,default:au},[PO]);function eg(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new t(r),s=au.parseCandidate(r.candidate);for(const o in s)o in i||Object.defineProperty(i,o,{value:s[o]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(r)},e.RTCIceCandidate.prototype=t.prototype,sl(e,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new e.RTCIceCandidate(n.candidate),writable:"false"}),n))}function hI(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||sl(e,"icecandidate",t=>{if(t.candidate){const n=au.parseCandidate(t.candidate.candidate);n.type==="relay"&&(t.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return t})}function tg(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const c=au.splitSections(a.sdp);return c.shift(),c.some(l=>{const u=au.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(a){const c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},i=function(a){let c=65536;return t.browser==="firefox"&&(t.version<57?a===-1?c=16384:c=2147483637:t.version<60?c=t.version===57?65535:65536:c=2147483637),c},s=function(a,c){let l=65536;t.browser==="firefox"&&t.version===57&&(l=65535);const u=au.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):t.browser==="firefox"&&c!==-1&&(l=2147483637),l},o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=r(arguments[0]),l=i(c),u=s(arguments[0],c);let d;l===0&&u===0?d=Number.POSITIVE_INFINITY:l===0||u===0?d=Math.max(l,u):d=Math.min(l,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return o.apply(this,arguments)}}function ng(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(r,i){const s=r.send;r.send=function(){const a=arguments[0],c=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&c>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return t(i,this),i},sl(e,"datachannel",r=>(t(r.channel,r.target),r))}function pI(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=t[n];t[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const s=i.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const o=new Event("connectionstatechange",i);s.dispatchEvent(o)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function gI(e,t){if(!e.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=i.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&i instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:i.type,sdp:s}):i.sdp=s}return n.apply(this,arguments)}}function rg(e,t){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const n=e.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function ig(e,t){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const n=e.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(e.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>n.apply(this,[o]))})}var az=Object.freeze({__proto__:null,removeExtmapAllowMixed:gI,shimAddIceCandidateNullOrEmpty:rg,shimConnectionState:pI,shimMaxMessageSize:tg,shimParameterlessSetLocalDescription:ig,shimRTCIceCandidate:eg,shimRTCIceCandidateRelayProtocol:hI,shimSendThrowTypeError:ng});function cz(){let{window:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=tO,r=rz(e),i={browserDetails:r,commonShim:az,extractVersion:Qp,disableLog:tz,disableWarnings:nz,sdp:oz};switch(r.browser){case"chrome":if(!fE||!dI||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=fE,rg(e,r),ig(e),rO(e,r),iO(e),dI(e,r),sO(e),uO(e,r),oO(e),aO(e),cO(e),dO(e,r),eg(e),hI(e),pI(e),tg(e,r),ng(e),gI(e,r);break;case"firefox":if(!hE||!fI||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=hE,rg(e,r),ig(e),fO(e,r),fI(e,r),hO(e),mO(e),pO(e),gO(e),vO(e),yO(e),CO(e),IO(e),SO(e),eg(e),pI(e),tg(e,r),ng(e);break;case"safari":if(!pE||!t.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=pE,rg(e,r),ig(e),TO(e),RO(e),kO(e),bO(e),wO(e),_O(e),AO(e),xO(e),eg(e),hI(e),tg(e,r),ng(e),gI(e,r);break;default:n("Unsupported browser!");break}return i}cz({window:typeof window>"u"?void 0:window});const lz=10,ap="lk_e2ee",uz="LKFrameEncryptionKey",dz={sharedKey:!1,ratchetSalt:uz,ratchetWindowSize:8,failureTolerance:lz};var Ga;(function(e){e.SetKey="setKey",e.RatchetRequest="ratchetRequest",e.KeyRatcheted="keyRatcheted"})(Ga||(Ga={}));var gE;(function(e){e.KeyRatcheted="keyRatcheted"})(gE||(gE={}));var Ra;(function(e){e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError"})(Ra||(Ra={}));var mE;(function(e){e.Error="cryptorError"})(mE||(mE={}));function fz(){return hz()||mI()}function mI(){return typeof window.RTCRtpScriptTransform<"u"}function hz(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class $oe extends Zs.EventEmitter{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{He.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},dz),t),this.on(Ga.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(t,n,r){const i={key:t,participantIdentity:n,keyIndex:r};this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(Ga.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(t,n){this.emit(Ga.RatchetRequest,t,n)}}class td extends Error{constructor(t,n){super(n||"an error has occured"),this.code=t}}class Et extends td{constructor(t,n,r){super(1,t),this.status=r,this.reason=n}}class zb extends td{constructor(t){super(21,t??"device is unsupported")}}class fs extends td{constructor(t){super(20,t??"track is invalid")}}class pz extends td{constructor(t){super(10,t??"unsupported server")}}class un extends td{constructor(t){super(12,t??"unexpected connection state")}}class vI extends td{constructor(t){super(13,t??"unable to negotiate")}}var $f;(function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"})($f||($f={}));(function(e){function t(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?e.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?e.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?e.DeviceInUse:e.Other}e.getFailure=t})($f||($f={}));var re;(function(e){e.Connected="connected",e.Reconnecting="reconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.ConnectionStateChanged="connectionStateChanged",e.StateChanged="connectionStateChanged",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalAudioSilenceDetected="localAudioSilenceDetected",e.ActiveSpeakersChanged="activeSpeakersChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.VideoPlaybackStatusChanged="videoPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.SignalConnected="signalConnected",e.RecordingStatusChanged="recordingStatusChanged",e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ActiveDeviceChanged="activeDeviceChanged"})(re||(re={}));var se;(function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.DataReceived="dataReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.MediaDevicesError="mediaDevicesError",e.AudioStreamAcquired="audioStreamAcquired",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.PCTrackAdded="pcTrackAdded"})(se||(se={}));var me;(function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.SignalRestarted="signalRestarted",e.Closing="closing",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived",e.RTPVideoMapUpdate="rtpVideoMapUpdate",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ParticipantUpdate="participantUpdate",e.RoomUpdate="roomUpdate",e.SpeakersChanged="speakersChanged",e.StreamStateChanged="streamStateChanged",e.ConnectionQualityUpdate="connectionQualityUpdate",e.SubscriptionError="subscriptionError",e.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",e.RemoteMute="remoteMute",e.SubscribedQualityUpdate="subscribedQualityUpdate",e.LocalTrackUnpublished="localTrackUnpublished"})(me||(me={}));var fe;(function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Restarted="restarted",e.Ended="ended",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.AudioSilenceDetected="audioSilenceDetected",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged",e.VideoPlaybackStarted="videoPlaybackStarted",e.VideoPlaybackFailed="videoPlaybackFailed",e.ElementAttached="elementAttached",e.ElementDetached="elementDetached",e.UpstreamPaused="upstreamPaused",e.UpstreamResumed="upstreamResumed",e.SubscriptionPermissionChanged="subscriptionPermissionChanged",e.SubscriptionStatusChanged="subscriptionStatusChanged",e.SubscriptionFailed="subscriptionFailed"})(fe||(fe={}));function Zb(e,t,n){var r,i,s;t===void 0&&(t=50),n===void 0&&(n={});var o=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,c=n.maxWait,l=Date.now(),u=[];function d(){if(c!==void 0){var h=Date.now()-l;if(h+t>=c)return c-h}return t}var f=function(){var h=[].slice.call(arguments),p=this;return new Promise(function(m,y){var g=o&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,l=Date.now(),!o){var S=e.apply(p,h);a&&a(S),u.forEach(function(E){return(0,E.resolve)(S)}),u=[]}},d()),g){var v=e.apply(p,h);return a&&a(v),m(v)}u.push({resolve:m,reject:y})})};return f.cancel=function(h){s!==void 0&&clearTimeout(s),u.forEach(function(p){return(0,p.reject)(h)}),u=[]},f}const gz=/version\/(\d+(\.?_?\d+)+)/i;let Ky;function jo(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof e>"u"&&typeof navigator>"u")return;const n=(e??navigator.userAgent).toLowerCase();if(Ky===void 0||t){const r=mz.find(i=>{let{test:s}=i;return s.test(n)});Ky=r==null?void 0:r.describe(n)}return Ky}const mz=[{test:/firefox|iceweasel|fxios/i,describe(e){return{name:"Firefox",version:Jy(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(e){return{name:"Chrome",version:Jy(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(e){return{name:"Safari",version:Jy(gz,e),os:e.includes("mobile/")?"iOS":"macOS"}}}];function Jy(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=t.match(e);return r&&r.length>=n&&r[n]||""}var vz="1.15.12";const yz=vz,Cz=11;class Bn{}Bn.setTimeout=function(){return setTimeout(...arguments)};Bn.setInterval=function(){return setInterval(...arguments)};Bn.clearTimeout=function(){return clearTimeout(...arguments)};Bn.clearInterval=function(){return clearInterval(...arguments)};class ct{constructor(t,n,r,i,s){this.width=t,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i,priority:s}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const Iz=["vp8","h264"],MO=["vp8","h264","vp9","av1"];function Sz(e){return!!Iz.find(t=>t===e)}var sm;(function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:2e4},e.music={maxBitrate:32e3},e.musicStereo={maxBitrate:48e3},e.musicHighQuality={maxBitrate:64e3},e.musicHighQualityStereo={maxBitrate:96e3}})(sm||(sm={}));const zf={h90:new ct(160,90,9e4,20),h180:new ct(320,180,16e4,20),h216:new ct(384,216,18e4,20),h360:new ct(640,360,45e4,20),h540:new ct(960,540,8e5,25),h720:new ct(1280,720,17e5,30),h1080:new ct(1920,1080,3e6,30),h1440:new ct(2560,1440,5e6,30),h2160:new ct(3840,2160,8e6,30)},yI={h120:new ct(160,120,7e4,20),h180:new ct(240,180,125e3,20),h240:new ct(320,240,14e4,20),h360:new ct(480,360,33e4,20),h480:new ct(640,480,5e5,20),h540:new ct(720,540,6e5,25),h720:new ct(960,720,13e5,30),h1080:new ct(1440,1080,23e5,30),h1440:new ct(1920,1440,38e5,30)},Xb={h360fps3:new ct(640,360,2e5,3,"medium"),h360fps15:new ct(640,360,4e5,15,"medium"),h720fps5:new ct(1280,720,8e5,5,"medium"),h720fps15:new ct(1280,720,15e5,15,"medium"),h720fps30:new ct(1280,720,2e6,30,"medium"),h1080fps15:new ct(1920,1080,25e5,15,"medium"),h1080fps30:new ct(1920,1080,5e6,30,"medium"),original:new ct(0,0,7e6,30,"medium")};var qn;(function(e){e[e.PUBLISHER=0]="PUBLISHER",e[e.SUBSCRIBER=1]="SUBSCRIBER"})(qn||(qn={}));R.util.setEnumType(qn,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var Hc;(function(e){e[e.ACTIVE=0]="ACTIVE",e[e.PAUSED=1]="PAUSED"})(Hc||(Hc={}));R.util.setEnumType(Hc,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var om;(function(e){e[e.UDP=0]="UDP",e[e.TCP=1]="TCP",e[e.TLS=2]="TLS"})(om||(om={}));R.util.setEnumType(om,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class po extends pe{constructor(t){super(),this.message={case:void 0},R.util.initPartial(t,this)}static fromBinary(t,n){return new po().fromBinary(t,n)}static fromJson(t,n){return new po().fromJson(t,n)}static fromJsonString(t,n){return new po().fromJsonString(t,n)}static equals(t,n){return R.util.equals(po,t,n)}}po.runtime=R;po.typeName="livekit.SignalRequest";po.fields=R.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:hr,oneof:"message"},{no:2,name:"answer",kind:"message",T:hr,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Wi,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Gi,oneof:"message"},{no:5,name:"mute",kind:"message",T:ji,oneof:"message"},{no:6,name:"subscription",kind:"message",T:fi,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:Es,oneof:"message"},{no:8,name:"leave",kind:"message",T:hi,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Ts,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Ns,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:Ps,oneof:"message"},{no:13,name:"simulate",kind:"message",T:On,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:_s,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Os,oneof:"message"}]);class As extends pe{constructor(t){super(),this.message={case:void 0},R.util.initPartial(t,this)}static fromBinary(t,n){return new As().fromBinary(t,n)}static fromJson(t,n){return new As().fromJson(t,n)}static fromJsonString(t,n){return new As().fromJsonString(t,n)}static equals(t,n){return R.util.equals(As,t,n)}}As.runtime=R;As.typeName="livekit.SignalResponse";As.fields=R.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:go,oneof:"message"},{no:2,name:"answer",kind:"message",T:hr,oneof:"message"},{no:3,name:"offer",kind:"message",T:hr,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Wi,oneof:"message"},{no:5,name:"update",kind:"message",T:yo,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Hi,oneof:"message"},{no:8,name:"leave",kind:"message",T:hi,oneof:"message"},{no:9,name:"mute",kind:"message",T:ji,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Co,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Io,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:bo,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:ko,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Eo,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:To,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:vo,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:mo,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:_o,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:xo,oneof:"message"}]);class Vi extends pe{constructor(t){super(),this.codec="",this.cid="",R.util.initPartial(t,this)}static fromBinary(t,n){return new Vi().fromBinary(t,n)}static fromJson(t,n){return new Vi().fromJson(t,n)}static fromJsonString(t,n){return new Vi().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Vi,t,n)}}Vi.runtime=R;Vi.typeName="livekit.SimulcastCodec";Vi.fields=R.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class Gi extends pe{constructor(t){super(),this.cid="",this.name="",this.type=Yn.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=en.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=Dn.NONE,this.stream="",R.util.initPartial(t,this)}static fromBinary(t,n){return new Gi().fromBinary(t,n)}static fromJson(t,n){return new Gi().fromJson(t,n)}static fromJsonString(t,n){return new Gi().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Gi,t,n)}}Gi.runtime=R;Gi.typeName="livekit.AddTrackRequest";Gi.fields=R.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:R.getEnumType(Yn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:R.getEnumType(en)},{no:9,name:"layers",kind:"message",T:fr,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Vi,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:R.getEnumType(Dn)},{no:15,name:"stream",kind:"scalar",T:9}]);class Wi extends pe{constructor(t){super(),this.candidateInit="",this.target=qn.PUBLISHER,R.util.initPartial(t,this)}static fromBinary(t,n){return new Wi().fromBinary(t,n)}static fromJson(t,n){return new Wi().fromJson(t,n)}static fromJsonString(t,n){return new Wi().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Wi,t,n)}}Wi.runtime=R;Wi.typeName="livekit.TrickleRequest";Wi.fields=R.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:R.getEnumType(qn)}]);class ji extends pe{constructor(t){super(),this.sid="",this.muted=!1,R.util.initPartial(t,this)}static fromBinary(t,n){return new ji().fromBinary(t,n)}static fromJson(t,n){return new ji().fromJson(t,n)}static fromJsonString(t,n){return new ji().fromJsonString(t,n)}static equals(t,n){return R.util.equals(ji,t,n)}}ji.runtime=R;ji.typeName="livekit.MuteTrackRequest";ji.fields=R.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class go extends pe{constructor(t){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),R.util.initPartial(t,this)}static fromBinary(t,n){return new go().fromBinary(t,n)}static fromJson(t,n){return new go().fromJson(t,n)}static fromJsonString(t,n){return new go().fromJsonString(t,n)}static equals(t,n){return R.util.equals(go,t,n)}}go.runtime=R;go.typeName="livekit.JoinResponse";go.fields=R.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:ed},{no:2,name:"participant",kind:"message",T:Jr},{no:3,name:"other_participants",kind:"message",T:Jr,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Rs,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:bs},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:uo},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class mo extends pe{constructor(t){super(),this.iceServers=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new mo().fromBinary(t,n)}static fromJson(t,n){return new mo().fromJson(t,n)}static fromJsonString(t,n){return new mo().fromJsonString(t,n)}static equals(t,n){return R.util.equals(mo,t,n)}}mo.runtime=R;mo.typeName="livekit.ReconnectResponse";mo.fields=R.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:Rs,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:bs}]);class Hi extends pe{constructor(t){super(),this.cid="",R.util.initPartial(t,this)}static fromBinary(t,n){return new Hi().fromBinary(t,n)}static fromJson(t,n){return new Hi().fromJson(t,n)}static fromJsonString(t,n){return new Hi().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Hi,t,n)}}Hi.runtime=R;Hi.typeName="livekit.TrackPublishedResponse";Hi.fields=R.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Tr}]);class vo extends pe{constructor(t){super(),this.trackSid="",R.util.initPartial(t,this)}static fromBinary(t,n){return new vo().fromBinary(t,n)}static fromJson(t,n){return new vo().fromJson(t,n)}static fromJsonString(t,n){return new vo().fromJsonString(t,n)}static equals(t,n){return R.util.equals(vo,t,n)}}vo.runtime=R;vo.typeName="livekit.TrackUnpublishedResponse";vo.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class hr extends pe{constructor(t){super(),this.type="",this.sdp="",R.util.initPartial(t,this)}static fromBinary(t,n){return new hr().fromBinary(t,n)}static fromJson(t,n){return new hr().fromJson(t,n)}static fromJsonString(t,n){return new hr().fromJsonString(t,n)}static equals(t,n){return R.util.equals(hr,t,n)}}hr.runtime=R;hr.typeName="livekit.SessionDescription";hr.fields=R.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class yo extends pe{constructor(t){super(),this.participants=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new yo().fromBinary(t,n)}static fromJson(t,n){return new yo().fromJson(t,n)}static fromJsonString(t,n){return new yo().fromJsonString(t,n)}static equals(t,n){return R.util.equals(yo,t,n)}}yo.runtime=R;yo.typeName="livekit.ParticipantUpdate";yo.fields=R.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:Jr,repeated:!0}]);class fi extends pe{constructor(t){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new fi().fromBinary(t,n)}static fromJson(t,n){return new fi().fromJson(t,n)}static fromJsonString(t,n){return new fi().fromJsonString(t,n)}static equals(t,n){return R.util.equals(fi,t,n)}}fi.runtime=R;fi.typeName="livekit.UpdateSubscription";fi.fields=R.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Ss,repeated:!0}]);class Es extends pe{constructor(t){super(),this.trackSids=[],this.disabled=!1,this.quality=vn.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,R.util.initPartial(t,this)}static fromBinary(t,n){return new Es().fromBinary(t,n)}static fromJson(t,n){return new Es().fromJson(t,n)}static fromJsonString(t,n){return new Es().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Es,t,n)}}Es.runtime=R;Es.typeName="livekit.UpdateTrackSettings";Es.fields=R.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:R.getEnumType(vn)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class hi extends pe{constructor(t){super(),this.canReconnect=!1,this.reason=Mo.UNKNOWN_REASON,R.util.initPartial(t,this)}static fromBinary(t,n){return new hi().fromBinary(t,n)}static fromJson(t,n){return new hi().fromJson(t,n)}static fromJsonString(t,n){return new hi().fromJsonString(t,n)}static equals(t,n){return R.util.equals(hi,t,n)}}hi.runtime=R;hi.typeName="livekit.LeaveRequest";hi.fields=R.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:R.getEnumType(Mo)}]);class Ts extends pe{constructor(t){super(),this.trackSid="",this.layers=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new Ts().fromBinary(t,n)}static fromJson(t,n){return new Ts().fromJson(t,n)}static fromJsonString(t,n){return new Ts().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Ts,t,n)}}Ts.runtime=R;Ts.typeName="livekit.UpdateVideoLayers";Ts.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:fr,repeated:!0}]);class _s extends pe{constructor(t){super(),this.metadata="",this.name="",R.util.initPartial(t,this)}static fromBinary(t,n){return new _s().fromBinary(t,n)}static fromJson(t,n){return new _s().fromJson(t,n)}static fromJsonString(t,n){return new _s().fromJsonString(t,n)}static equals(t,n){return R.util.equals(_s,t,n)}}_s.runtime=R;_s.typeName="livekit.UpdateParticipantMetadata";_s.fields=R.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class Rs extends pe{constructor(t){super(),this.urls=[],this.username="",this.credential="",R.util.initPartial(t,this)}static fromBinary(t,n){return new Rs().fromBinary(t,n)}static fromJson(t,n){return new Rs().fromJson(t,n)}static fromJsonString(t,n){return new Rs().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Rs,t,n)}}Rs.runtime=R;Rs.typeName="livekit.ICEServer";Rs.fields=R.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class Co extends pe{constructor(t){super(),this.speakers=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new Co().fromBinary(t,n)}static fromJson(t,n){return new Co().fromJson(t,n)}static fromJsonString(t,n){return new Co().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Co,t,n)}}Co.runtime=R;Co.typeName="livekit.SpeakersChanged";Co.fields=R.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:Cs,repeated:!0}]);class Io extends pe{constructor(t){super(),R.util.initPartial(t,this)}static fromBinary(t,n){return new Io().fromBinary(t,n)}static fromJson(t,n){return new Io().fromJson(t,n)}static fromJsonString(t,n){return new Io().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Io,t,n)}}Io.runtime=R;Io.typeName="livekit.RoomUpdate";Io.fields=R.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:ed}]);class So extends pe{constructor(t){super(),this.participantSid="",this.quality=oo.POOR,this.score=0,R.util.initPartial(t,this)}static fromBinary(t,n){return new So().fromBinary(t,n)}static fromJson(t,n){return new So().fromJson(t,n)}static fromJsonString(t,n){return new So().fromJsonString(t,n)}static equals(t,n){return R.util.equals(So,t,n)}}So.runtime=R;So.typeName="livekit.ConnectionQualityInfo";So.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:R.getEnumType(oo)},{no:3,name:"score",kind:"scalar",T:2}]);class bo extends pe{constructor(t){super(),this.updates=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new bo().fromBinary(t,n)}static fromJson(t,n){return new bo().fromJson(t,n)}static fromJsonString(t,n){return new bo().fromJsonString(t,n)}static equals(t,n){return R.util.equals(bo,t,n)}}bo.runtime=R;bo.typeName="livekit.ConnectionQualityUpdate";bo.fields=R.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:So,repeated:!0}]);class wo extends pe{constructor(t){super(),this.participantSid="",this.trackSid="",this.state=Hc.ACTIVE,R.util.initPartial(t,this)}static fromBinary(t,n){return new wo().fromBinary(t,n)}static fromJson(t,n){return new wo().fromJson(t,n)}static fromJsonString(t,n){return new wo().fromJsonString(t,n)}static equals(t,n){return R.util.equals(wo,t,n)}}wo.runtime=R;wo.typeName="livekit.StreamStateInfo";wo.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:R.getEnumType(Hc)}]);class ko extends pe{constructor(t){super(),this.streamStates=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new ko().fromBinary(t,n)}static fromJson(t,n){return new ko().fromJson(t,n)}static fromJsonString(t,n){return new ko().fromJsonString(t,n)}static equals(t,n){return R.util.equals(ko,t,n)}}ko.runtime=R;ko.typeName="livekit.StreamStateUpdate";ko.fields=R.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:wo,repeated:!0}]);class $i extends pe{constructor(t){super(),this.quality=vn.LOW,this.enabled=!1,R.util.initPartial(t,this)}static fromBinary(t,n){return new $i().fromBinary(t,n)}static fromJson(t,n){return new $i().fromJson(t,n)}static fromJsonString(t,n){return new $i().fromJsonString(t,n)}static equals(t,n){return R.util.equals($i,t,n)}}$i.runtime=R;$i.typeName="livekit.SubscribedQuality";$i.fields=R.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:R.getEnumType(vn)},{no:2,name:"enabled",kind:"scalar",T:8}]);class Ao extends pe{constructor(t){super(),this.codec="",this.qualities=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new Ao().fromBinary(t,n)}static fromJson(t,n){return new Ao().fromJson(t,n)}static fromJsonString(t,n){return new Ao().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Ao,t,n)}}Ao.runtime=R;Ao.typeName="livekit.SubscribedCodec";Ao.fields=R.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:$i,repeated:!0}]);class Eo extends pe{constructor(t){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new Eo().fromBinary(t,n)}static fromJson(t,n){return new Eo().fromJson(t,n)}static fromJsonString(t,n){return new Eo().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Eo,t,n)}}Eo.runtime=R;Eo.typeName="livekit.SubscribedQualityUpdate";Eo.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:$i,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:Ao,repeated:!0}]);class xs extends pe{constructor(t){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",R.util.initPartial(t,this)}static fromBinary(t,n){return new xs().fromBinary(t,n)}static fromJson(t,n){return new xs().fromJson(t,n)}static fromJsonString(t,n){return new xs().fromJsonString(t,n)}static equals(t,n){return R.util.equals(xs,t,n)}}xs.runtime=R;xs.typeName="livekit.TrackPermission";xs.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class Ns extends pe{constructor(t){super(),this.allParticipants=!1,this.trackPermissions=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new Ns().fromBinary(t,n)}static fromJson(t,n){return new Ns().fromJson(t,n)}static fromJsonString(t,n){return new Ns().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Ns,t,n)}}Ns.runtime=R;Ns.typeName="livekit.SubscriptionPermission";Ns.fields=R.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:xs,repeated:!0}]);class To extends pe{constructor(t){super(),this.participantSid="",this.trackSid="",this.allowed=!1,R.util.initPartial(t,this)}static fromBinary(t,n){return new To().fromBinary(t,n)}static fromJson(t,n){return new To().fromJson(t,n)}static fromJsonString(t,n){return new To().fromJsonString(t,n)}static equals(t,n){return R.util.equals(To,t,n)}}To.runtime=R;To.typeName="livekit.SubscriptionPermissionUpdate";To.fields=R.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class Ps extends pe{constructor(t){super(),this.publishTracks=[],this.dataChannels=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new Ps().fromBinary(t,n)}static fromJson(t,n){return new Ps().fromJson(t,n)}static fromJsonString(t,n){return new Ps().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Ps,t,n)}}Ps.runtime=R;Ps.typeName="livekit.SyncState";Ps.fields=R.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:hr},{no:2,name:"subscription",kind:"message",T:fi},{no:3,name:"publish_tracks",kind:"message",T:Hi,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Ms,repeated:!0},{no:5,name:"offer",kind:"message",T:hr}]);class Ms extends pe{constructor(t){super(),this.label="",this.id=0,this.target=qn.PUBLISHER,R.util.initPartial(t,this)}static fromBinary(t,n){return new Ms().fromBinary(t,n)}static fromJson(t,n){return new Ms().fromJson(t,n)}static fromJsonString(t,n){return new Ms().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Ms,t,n)}}Ms.runtime=R;Ms.typeName="livekit.DataChannelInfo";Ms.fields=R.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:R.getEnumType(qn)}]);class On extends pe{constructor(t){super(),this.scenario={case:void 0},R.util.initPartial(t,this)}static fromBinary(t,n){return new On().fromBinary(t,n)}static fromJson(t,n){return new On().fromJson(t,n)}static fromJsonString(t,n){return new On().fromJsonString(t,n)}static equals(t,n){return R.util.equals(On,t,n)}}On.runtime=R;On.typeName="livekit.SimulateScenario";On.fields=R.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:R.getEnumType(om),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]);class Os extends pe{constructor(t){super(),this.timestamp=Le.zero,this.rtt=Le.zero,R.util.initPartial(t,this)}static fromBinary(t,n){return new Os().fromBinary(t,n)}static fromJson(t,n){return new Os().fromJson(t,n)}static fromJsonString(t,n){return new Os().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Os,t,n)}}Os.runtime=R;Os.typeName="livekit.Ping";Os.fields=R.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class _o extends pe{constructor(t){super(),this.lastPingTimestamp=Le.zero,this.timestamp=Le.zero,R.util.initPartial(t,this)}static fromBinary(t,n){return new _o().fromBinary(t,n)}static fromJson(t,n){return new _o().fromJson(t,n)}static fromJsonString(t,n){return new _o().fromJsonString(t,n)}static equals(t,n){return R.util.equals(_o,t,n)}}_o.runtime=R;_o.typeName="livekit.Pong";_o.fields=R.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class xa extends pe{constructor(t){super(),this.regions=[],R.util.initPartial(t,this)}static fromBinary(t,n){return new xa().fromBinary(t,n)}static fromJson(t,n){return new xa().fromJson(t,n)}static fromJsonString(t,n){return new xa().fromJsonString(t,n)}static equals(t,n){return R.util.equals(xa,t,n)}}xa.runtime=R;xa.typeName="livekit.RegionSettings";xa.fields=R.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:Ro,repeated:!0}]);class Ro extends pe{constructor(t){super(),this.region="",this.url="",this.distance=Le.zero,R.util.initPartial(t,this)}static fromBinary(t,n){return new Ro().fromBinary(t,n)}static fromJson(t,n){return new Ro().fromJson(t,n)}static fromJsonString(t,n){return new Ro().fromJsonString(t,n)}static equals(t,n){return R.util.equals(Ro,t,n)}}Ro.runtime=R;Ro.typeName="livekit.RegionInfo";Ro.fields=R.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class xo extends pe{constructor(t){super(),this.trackSid="",this.err=Hf.SE_UNKNOWN,R.util.initPartial(t,this)}static fromBinary(t,n){return new xo().fromBinary(t,n)}static fromJson(t,n){return new xo().fromJson(t,n)}static fromJsonString(t,n){return new xo().fromJsonString(t,n)}static equals(t,n){return R.util.equals(xo,t,n)}}xo.runtime=R;xo.typeName="livekit.SubscriptionResponse";xo.fields=R.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:R.getEnumType(Hf)}]);function bz(e){if(!(typeof e>"u"))return typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}const wz=5e3,Ed=[];class Y extends Zs.EventEmitter{constructor(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Y.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=He,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),wz):this.handleAppVisibilityChanged()},this.log=Wo((i=r.loggerName)!==null&&i!==void 0?i:Gs.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=t,this._mediaStreamID=t.id,this.source=Y.Source.Unknown}get logContext(){var t;return Object.assign(Object.assign({},(t=this.loggerContextCb)===null||t===void 0?void 0:t.call(this)),Pt(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(t){let n="audio";this.kind===Y.Kind.Video&&(n="video"),this.attachedElements.length===0&&Y.Kind.Video&&this.addAppVisibilityListener(),t||(n==="audio"&&(Ed.forEach(s=>{s.parentElement===null&&!t&&(t=s)}),t&&Ed.splice(Ed.indexOf(t),1)),t||(t=document.createElement(n))),this.attachedElements.includes(t)||this.attachedElements.push(t),Gl(this.mediaStreamTrack,t);const r=t.srcObject.getTracks(),i=r.some(s=>s.kind==="audio");return t.play().then(()=>{this.emit(i?fe.AudioPlaybackStarted:fe.VideoPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(i?fe.AudioPlaybackFailed:fe.VideoPlaybackFailed,s):s.name==="AbortError"?He.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):He.warn("could not playback ".concat(i?"audio":"video"),s),i&&t&&r.some(o=>o.kind==="video")&&s.name==="NotAllowedError"&&(t.muted=!0,t.play().catch(()=>{}))}),this.emit(fe.ElementAttached,t),t}detach(t){try{if(t){cu(this.mediaStreamTrack,t);const r=this.attachedElements.indexOf(t);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(t),this.emit(fe.ElementDetached,t)),t}const n=[];return this.attachedElements.forEach(r=>{cu(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(fe.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(t){t.loggerName&&(this.log=Wo(t.loggerName)),t.loggerContextCb&&(this.loggerContextCb=t.loggerContextCb)}recycleElement(t){if(t instanceof HTMLAudioElement){let n=!0;t.pause(),Ed.forEach(r=>{r.parentElement||(n=!1)}),n&&Ed.push(t)}}handleAppVisibilityChanged(){return F(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){Pr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Pr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Gl(e,t){let n;t.srcObject instanceof MediaStream?n=t.srcObject:n=new MediaStream;let r;e.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(e)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(e)),(!$c()||!(t instanceof HTMLVideoElement))&&(t.autoplay=!0),t.muted=n.getAudioTracks().length===0,t instanceof HTMLVideoElement&&(t.playsInline=!0),t.srcObject!==n&&(t.srcObject=n,($c()||Pu())&&t instanceof HTMLVideoElement&&setTimeout(()=>{t.srcObject=n,t.play().catch(()=>{})},0))}function cu(e,t){if(t.srcObject instanceof MediaStream){const n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}(function(e){let t;(function(l){l.Audio="audio",l.Video="video",l.Unknown="unknown"})(t=e.Kind||(e.Kind={}));let n;(function(l){l.Camera="camera",l.Microphone="microphone",l.ScreenShare="screen_share",l.ScreenShareAudio="screen_share_audio",l.Unknown="unknown"})(n=e.Source||(e.Source={}));let r;(function(l){l.Active="active",l.Paused="paused",l.Unknown="unknown"})(r=e.StreamState||(e.StreamState={}));function i(l){switch(l){case t.Audio:return Yn.AUDIO;case t.Video:return Yn.VIDEO;default:return Yn.DATA}}e.kindToProto=i;function s(l){switch(l){case Yn.AUDIO:return t.Audio;case Yn.VIDEO:return t.Video;default:return t.Unknown}}e.kindFromProto=s;function o(l){switch(l){case n.Camera:return en.CAMERA;case n.Microphone:return en.MICROPHONE;case n.ScreenShare:return en.SCREEN_SHARE;case n.ScreenShareAudio:return en.SCREEN_SHARE_AUDIO;default:return en.UNKNOWN}}e.sourceToProto=o;function a(l){switch(l){case en.CAMERA:return n.Camera;case en.MICROPHONE:return n.Microphone;case en.SCREEN_SHARE:return n.ScreenShare;case en.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}e.sourceFromProto=a;function c(l){switch(l){case Hc.ACTIVE:return r.Active;case Hc.PAUSED:return r.Paused;default:return r.Unknown}}e.streamStateFromProto=c})(Y||(Y={}));function OO(e,t,n){var r;const i=(r=bz(e))!==null&&r!==void 0?r:{};return i.audio===!0&&(i.audio={}),i.video===!0&&(i.video={}),i.audio&&CI(i.audio,t),i.video&&CI(i.video,n),i}function CI(e,t){return Object.keys(t).forEach(n=>{e[n]===void 0&&(e[n]=t[n])}),e}function uv(e){const t={};if(e.video)if(typeof e.video=="object"){const n={},r=n,i=e.video;Object.keys(i).forEach(s=>{switch(s){case"resolution":CI(r,i.resolution);break;default:r[s]=i[s]}}),t.video=n}else t.video=e.video;else t.video=!1;return e.audio?typeof e.audio=="object"?t.audio=e.audio:t.audio=!0:t.audio=!1,t}function kz(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return F(this,void 0,void 0,function*(){const n=Kb();if(n){const r=n.createAnalyser();r.fftSize=2048;const i=r.frequencyBinCount,s=new Uint8Array(i);n.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(r),yield Oo(t),r.getByteTimeDomainData(s);const a=s.some(c=>c!==128&&c!==0);return n.close(),!a}return!1})}function Kb(){const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e)return new e({latencyHint:"interactive"})}function Az(e){return e===Y.Source.Microphone?"audioinput":e===Y.Source.Camera?"videoinput":void 0}function Ez(e){var t,n;let r=(t=e.video)!==null&&t!==void 0?t:!0;return e.resolution&&e.resolution.width>0&&e.resolution.height>0&&(r=typeof r=="boolean"?{}:r,$c()?r=Object.assign(Object.assign({},r),{width:{max:e.resolution.width},height:{max:e.resolution.height},frameRate:e.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:e.resolution.width},height:{ideal:e.resolution.height},frameRate:e.resolution.frameRate})),{audio:(n=e.audio)!==null&&n!==void 0?n:!1,video:r,controller:e.controller,selfBrowserSurface:e.selfBrowserSurface,surfaceSwitching:e.surfaceSwitching,systemAudio:e.systemAudio}}function DO(e){const t=e.split("/")[1].toLowerCase();if(!MO.includes(t))throw Error("Video codec not supported: ".concat(t));return t}function Tz(e){const t=[];return e.forEach(n=>{n.track!==void 0&&t.push(new Hi({cid:n.track.mediaStreamID,track:n.trackInfo}))}),t}function Pt(e){return e instanceof Y?{trackSid:e.sid,trackSource:e.source,trackMuted:e.isMuted,trackEnabled:e.mediaStreamTrack.enabled,trackKind:e.kind}:{trackSid:e.trackSid,trackName:e.trackName,track:e.track?Pt(e.track):void 0,trackEnabled:e.isEnabled,trackEncrypted:e.isEncrypted,trackMimeType:e.mimeType}}const _z="|",vE="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function Rz(e){const t=e.split(_z);return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]}function Oo(e){return F(this,void 0,void 0,function*(){return new Promise(t=>Bn.setTimeout(t,e))})}function yE(){return"addTransceiver"in RTCPeerConnection.prototype}function CE(){return"addTrack"in RTCPeerConnection.prototype}function xz(){if(!("getCapabilities"in RTCRtpSender)||$c())return!1;const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e){for(const n of e.codecs)if(n.mimeType==="video/AV1"){t=!0;break}}return t}function Nz(){if(!("getCapabilities"in RTCRtpSender)||Pu())return!1;if($c()){const n=jo();if(n!=null&&n.version&&Jb(n.version,"16")<0)return!1}const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e){for(const n of e.codecs)if(n.mimeType==="video/VP9"){t=!0;break}}return t}function af(e){return e==="av1"||e==="vp9"}function II(e){return document?(e||(e=document.createElement("audio")),"setSinkId"in e):!1}const Pz={Chrome:"100",Safari:"15",Firefox:"100"};function Mz(e){if(!Pr()||!("setCodecPreferences"in e))return!1;const t=jo();if(!(t!=null&&t.name)||!t.version)return!1;const n=Pz[t.name];return n?Jb(t.version,n)>=0:!1}function Pu(){var e;return((e=jo())===null||e===void 0?void 0:e.name)==="Firefox"}function Oz(){var e;return((e=jo())===null||e===void 0?void 0:e.name)==="Chrome"}function $c(){var e;return((e=jo())===null||e===void 0?void 0:e.name)==="Safari"}function Dz(){const e=jo();return(e==null?void 0:e.name)==="Safari"&&e.version.startsWith("17.")}function LO(){return Pr()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function Pr(){return typeof document<"u"}function zc(){return navigator.product=="ReactNative"}function SI(e){return e.hostname.endsWith(".livekit.cloud")||e.hostname.endsWith(".livekit.run")}function BO(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function FO(){if(!zc())return;let e=BO();if(e)return e.platform}function IE(){if(Pr())return window.devicePixelRatio;if(zc()){let e=BO();if(e)return e.devicePixelRatio}return 1}function Jb(e,t){const n=e.split("."),r=t.split("."),i=Math.min(n.length,r.length);for(let s=0;s<i;++s){const o=parseInt(n[s],10),a=parseInt(r[s],10);if(o>a)return 1;if(o<a)return-1;if(s===i-1&&o===a)return 0}return e===""&&t!==""?-1:t===""?1:n.length==r.length?0:n.length<r.length?-1:1}function Lz(e){for(const t of e)t.target.handleResize(t)}function Bz(e){for(const t of e)t.target.handleVisibilityChanged(t)}let Yy=null;const SE=()=>(Yy||(Yy=new ResizeObserver(Lz)),Yy);let qy=null;const bE=()=>(qy||(qy=new IntersectionObserver(Bz,{root:null,rootMargin:"0px"})),qy);function Fz(){var e;const t=new fo({sdk:Nu.JS,protocol:Cz,version:yz});return zc()&&(t.os=(e=FO())!==null&&e!==void 0?e:""),t}function wE(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=e,i.height=t;const s=i.getContext("2d");s==null||s.fillRect(0,0,i.width,i.height),r&&s&&(s.beginPath(),s.arc(e/2,t/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const o=i.captureStream(),[a]=o.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let Td;function Qy(){if(!Td){const e=new AudioContext,t=e.createOscillator(),n=e.createGain();n.gain.setValueAtTime(0,0);const r=e.createMediaStreamDestination();if(t.connect(n),n.connect(r),t.start(),[Td]=r.stream.getAudioTracks(),!Td)throw Error("Could not get empty media stream audio track");Td.enabled=!1}return Td.clone()}class UO{constructor(t,n){this.onFinally=n,this.promise=new Promise((r,i)=>F(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,t&&(yield t(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function Uz(e,t){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},t),r=Kb();if(!r)throw new Error("Audio Context not supported on this browser");const i=n.cloneTrack?e.mediaStreamTrack.clone():e.mediaStreamTrack,s=r.createMediaStreamSource(new MediaStream([i])),o=r.createAnalyser();o.minDecibels=n.minDecibels,o.maxDecibels=n.maxDecibels,o.fftSize=n.fftSize,o.smoothingTimeConstant=n.smoothingTimeConstant,s.connect(o);const a=new Uint8Array(o.frequencyBinCount);return{calculateVolume:()=>{o.getByteFrequencyData(a);let u=0;for(const f of a)u+=Math.pow(f/255,2);return Math.sqrt(u/a.length)},analyser:o,cleanup:()=>F(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&i.stop()})}}class Xi{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let t;const n=new Promise(i=>t=()=>{this._locks-=1,i()}),r=this._locking.then(()=>t);return this._locking=this._locking.then(()=>n),r}}function Vz(e){return MO.includes(e)}function Pc(e){if(typeof e=="string")return e;if(Array.isArray(e))return e[0];if(e.exact)return Array.isArray(e.exact)?e.exact[0]:e.exact;if(e.ideal)return Array.isArray(e.ideal)?e.ideal[0]:e.ideal;throw Error("could not unwrap constraint")}function Gz(e){return e.startsWith("http")?e.replace(/^(http)/,"ws"):e}function kE(e){return e.startsWith("ws")?e.replace(/^(ws)/,"http"):e}const AE="default";class cr{static getInstance(){return this.instance===void 0&&(this.instance=new cr),this.instance}getDevices(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r;return F(this,void 0,void 0,function*(){if(((r=cr.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){He.debug("awaiting getUserMedia promise");try{t?yield cr.userMediaPromiseMap.get(t):yield Promise.all(cr.userMediaPromiseMap.values())}catch{He.warn("error waiting for media permissons")}}let i=yield navigator.mediaDevices.enumerateDevices();if(n&&!($c()&&this.hasDeviceInUse(t))&&(i.length===0||i.some(o=>{const a=o.label==="",c=t?o.kind===t:!0;return a&&c}))){const o={video:t!=="audioinput"&&t!=="audiooutput",audio:t!=="videoinput"},a=yield navigator.mediaDevices.getUserMedia(o);i=yield navigator.mediaDevices.enumerateDevices(),a.getTracks().forEach(c=>{c.stop()})}return t&&(i=i.filter(s=>s.kind===t)),i})}normalizeDeviceId(t,n,r){return F(this,void 0,void 0,function*(){if(n!==AE)return n;const s=(yield this.getDevices(t)).find(o=>o.groupId===r&&o.deviceId!==AE);return s==null?void 0:s.deviceId})}hasDeviceInUse(t){return t?cr.userMediaPromiseMap.has(t):cr.userMediaPromiseMap.size>0}}cr.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];cr.userMediaPromiseMap=new Map;const Wz=1e3;class Mu extends Y{get constraints(){return this._constraints}constructor(t,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;super(t,n,s),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Zb(()=>F(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>F(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(fe.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new Xi,this.pauseUpstreamLock=new Xi,this.processorLock=new Xi,this.setMediaStreamTrack(t,!0),this._constraints=t.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Y.Kind.Video)return;const{width:t,height:n}=this._mediaStreamTrack.getSettings();if(t&&n)return{width:t,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var t,n;return(n=(t=this.processor)===null||t===void 0?void 0:t.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(t,n){return F(this,void 0,void 0,function*(){if(t===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{cu(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([t]),t&&(t.addEventListener("ended",this.handleEnded),t.addEventListener("mute",this.handleTrackMuteEvent),t.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=t.getConstraints());let r;if(this.processor&&t&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");Gl(t,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:t,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(r??t)),!this.providedByUser&&this._mediaStreamTrack!==t&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=t,t&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{Gl(r??t,i)}))})}waitForDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Wz;var n;return F(this,void 0,void 0,function*(){if(this.kind===Y.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=jo())===null||n===void 0?void 0:n.os)==="iOS"&&(yield Oo(10));const r=Date.now();for(;Date.now()-r<t;){const i=this.dimensions;if(i)return i;yield Oo(50)}throw new fs("unable to get track dimensions after timeout")})}getDeviceId(){return F(this,void 0,void 0,function*(){if(this.source===Y.Source.ScreenShare)return;const{deviceId:t,groupId:n}=this._mediaStreamTrack.getSettings(),r=this.kind===Y.Kind.Audio?"audioinput":"videoinput";return cr.getInstance().normalizeDeviceId(r,t,n)})}mute(){return F(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return F(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return F(this,void 0,void 0,function*(){if(!this.sender)throw new fs("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(t),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(t){return F(this,void 0,void 0,function*(){t||(t=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:t}));const n={audio:!1,video:!1};this.kind===Y.Kind.Video?n.video=t:n.audio=t,this.attachedElements.forEach(s=>{cu(this.mediaStreamTrack,s)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(i),this._constraints=t,this.emit(fe.Restarted,this),this})}setTrackMuted(t){this.log.debug("setting ".concat(this.kind," track ").concat(t?"muted":"unmuted"),this.logContext),!(this.isMuted===t&&this._mediaStreamTrack.enabled!==t)&&(this.isMuted=t,this._mediaStreamTrack.enabled=!t,this.emit(t?fe.Muted:fe.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const t=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return F(this,void 0,void 0,function*(){yield t.handleAppVisibilityChanged.call(this),LO()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var t;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(t=this.processor)===null||t===void 0||t.destroy(),this.processor=void 0}pauseUpstream(){return F(this,void 0,void 0,function*(){const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(fe.UpstreamPaused,this);const n=jo();if((n==null?void 0:n.name)==="Safari"&&Jb(n.version,"12.0")<0)throw new zb("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{t()}})}resumeUpstream(){return F(this,void 0,void 0,function*(){const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(fe.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{t()}})}getRTCStatsReport(){var t;return F(this,void 0,void 0,function*(){return!((t=this.sender)===null||t===void 0)&&t.getStats?yield this.sender.getStats():void 0})}setProcessor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var r,i;return F(this,void 0,void 0,function*(){const s=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(r=this.processorElement)!==null&&r!==void 0?r:document.createElement(this.kind),Gl(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch(a=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:a})));const o={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield t.init(o),this.processor=t,this.processor.processedTrack){for(const a of this.attachedElements)a!==this.processorElement&&n&&(cu(this._mediaStreamTrack,a),Gl(this.processor.processedTrack,a));yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack)}}finally{s()}})}getProcessor(){return this.processor}stopProcessor(){var t,n;return F(this,void 0,void 0,function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),(t=this.processor.processedTrack)===null||t===void 0||t.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class jz extends Zs.EventEmitter{constructor(t){super(),this.onWorkerMessage=n=>{var r,i;const{kind:s,data:o}=n.data;switch(s){case"error":He.error(o.error.message),this.emit(Ra.EncryptionError,o.error);break;case"initAck":o.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(this.encryptionEnabled!==o.enabled&&o.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Ra.ParticipantEncryptionStatusChanged,o.enabled,this.room.localParticipant),this.encryptionEnabled=o.enabled;else if(o.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(o.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(o.participantIdentity));this.emit(Ra.ParticipantEncryptionStatusChanged,o.enabled,a)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"ratchetKey":this.keyProvider.emit(Ga.KeyRatcheted,o.material,o.keyIndex);break}},this.onWorkerError=n=>{He.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Ra.EncryptionError,n.error)},this.keyProvider=t.keyProvider,this.worker=t.worker,this.encryptionEnabled=!1}setup(t){if(!fz())throw new zb("tried to setup end-to-end encryption on an unsupported browser");if(He.info("setting up e2ee"),t!==this.room){this.room=t,this.setupEventListeners(t,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(He.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(t,n){He.debug("set e2ee to ".concat(t," for participant ").concat(n)),this.postEnable(t,n)}setSifTrailer(t){!t||t.length===0?He.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(t)}setupEngine(t){t.on(me.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(t,n){t.on(re.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Dn.NONE,i.identity)),t.on(re.ConnectionStateChanged,r=>{r===et.Connected&&t.participants.forEach(i=>{i.tracks.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==Dn.NONE,i.identity)})})}).on(re.TrackUnsubscribed,(r,i,s)=>{var o;const a={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:r.mediaStreamID}};(o=this.worker)===null||o===void 0||o.postMessage(a)}).on(re.TrackSubscribed,(r,i,s)=>{this.setupE2EEReceiver(r,s.identity,i.trackInfo)}).on(re.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(r=>{this.postKey(r)})}),t.localParticipant.on(se.LocalTrackPublished,r=>F(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(Ga.SetKey,r=>this.postKey(r)).on(Ga.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(t,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:t,keyIndex:n}};this.worker.postMessage(r)}postKey(t){let{key:n,participantIdentity:r,keyIndex:i}=t;var s;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(o)}postEnable(t,n){if(this.worker){const r={kind:"enable",data:{enabled:t,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(t){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:t,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(t){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:t}};this.worker.postMessage(n)}setupE2EEReceiver(t,n,r){if(t.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(t.receiver,t.mediaStreamID,n,t.kind==="video"?DO(r.mimeType):void 0)}}setupE2EESender(t,n){if(!(t instanceof Mu)||!n){n||He.warn("early return because sender is not ready");return}this.handleSender(n,t.mediaStreamID,void 0)}handleReceiver(t,n,r,i){return F(this,void 0,void 0,function*(){if(this.worker){if(mI()){const s={kind:"decode",participantIdentity:r,trackId:n,codec:i};t.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(ap in t&&i){const c={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(c);return}let s=t.writableStream,o=t.readableStream;if(!s||!o){const c=t.createEncodedStreams();t.writableStream=c.writable,s=c.writable,t.readableStream=c.readable,o=c.readable}const a={kind:"decode",data:{readableStream:o,writableStream:s,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[o,s])}t[ap]=!0}})}handleSender(t,n,r){var i;if(!(ap in t||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(mI()){He.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};t.transform=new RTCRtpScriptTransform(this.worker,s)}else{He.info("initialize encoded streams");const s=t.createEncodedStreams(),o={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o,[s.readable,s.writable])}t[ap]=!0}}}var cf;(function(e){e[e.WAITING=0]="WAITING",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED"})(cf||(cf={}));class Hz{constructor(){this.pendingTasks=new Map,this.taskMutex=new Xi,this.nextTaskIndex=0}run(t){return F(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:cf.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=cf.RUNNING,yield t()}finally{n.status=cf.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return F(this,void 0,void 0,function*(){return this.run(()=>F(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const $z=["syncState","trickle","offer","answer","simulate","leave"];function zz(e){const t=$z.indexOf(e.case)>=0;return He.trace("request allowed to bypass queue:",{canPass:t,req:e}),t}var $t;(function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.RECONNECTING=2]="RECONNECTING",e[e.DISCONNECTING=3]="DISCONNECTING",e[e.DISCONNECTED=4]="DISCONNECTED"})($t||($t={}));class Yb{get currentState(){return this.state}get isDisconnected(){return this.state===$t.DISCONNECTING||this.state===$t.DISCONNECTED}get isEstablishingConnection(){return this.state===$t.CONNECTING||this.state===$t.RECONNECTING}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=$t.DISCONNECTED,this.log=He,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=Wo((r=n.loggerName)!==null&&r!==void 0?r:Gs.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=t,this.requestQueue=new Hz,this.queuedRequests=[],this.closingLock=new Xi,this.connectionLock=new Xi,this.state=$t.DISCONNECTED}get logContext(){var t,n;return(n=(t=this.loggerContextCb)===null||t===void 0?void 0:t.call(this))!==null&&n!==void 0?n:{}}join(t,n,r,i){return F(this,void 0,void 0,function*(){return this.state=$t.CONNECTING,this.options=r,yield this.connect(t,n,r,i)})}reconnect(t,n,r,i){return F(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=$t.RECONNECTING,this.clearPingInterval(),yield this.connect(t,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(t,n,r,i){this.connectOptions=r,t=Gz(t),t=t.replace(/\/$/,""),t+="/rtc";const s=Fz(),o=Zz(n,s,r);return new Promise((a,c)=>F(this,void 0,void 0,function*(){const l=yield this.connectionLock.lock();try{const u=()=>F(this,void 0,void 0,function*(){this.close(),clearTimeout(d),c(new Et("room connection has been cancelled (signal)"))}),d=setTimeout(()=>{this.close(),c(new Et("room connection has timed out (signal)"))},r.websocketTimeout);i!=null&&i.aborted&&u(),i==null||i.addEventListener("abort",u),this.log.debug("connecting to ".concat(t+o),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(t+o),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=f=>F(this,void 0,void 0,function*(){if(this.state!==$t.CONNECTED){clearTimeout(d);try{const h=yield fetch("http".concat(t.substring(2),"/validate").concat(o));if(h.status.toFixed(0).startsWith("4")){const p=yield h.text();c(new Et(p,0,h.status))}else c(new Et("Internal error",2,h.status))}catch{c(new Et("server was not reachable",1))}return}this.handleWSError(f)}),this.ws.onmessage=f=>F(this,void 0,void 0,function*(){var h,p,m,y;let g;if(typeof f.data=="string"){const v=JSON.parse(f.data);g=As.fromJson(v)}else if(f.data instanceof ArrayBuffer)g=As.fromBinary(new Uint8Array(f.data));else{this.log.error("could not decode websocket message: ".concat(typeof f.data),this.logContext);return}if(this.state!==$t.CONNECTED){let v=!1;if(((h=g.message)===null||h===void 0?void 0:h.case)==="join"?(this.state=$t.CONNECTED,i==null||i.removeEventListener("abort",u),this.pingTimeoutDuration=g.message.value.pingTimeout,this.pingIntervalDuration=g.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),a(g.message.value)):this.state===$t.RECONNECTING&&g.message.case!=="leave"?(this.state=$t.CONNECTED,i==null||i.removeEventListener("abort",u),this.startPingInterval(),((p=g.message)===null||p===void 0?void 0:p.case)==="reconnect"?a((m=g.message)===null||m===void 0?void 0:m.value):(a(),v=!0)):this.isEstablishingConnection&&g.message.case==="leave"?c(new Et("Received leave request while trying to (re)connect",4)):r.reconnect||c(new Et("did not receive join response, got ".concat((y=g.message)===null||y===void 0?void 0:y.case," instead"))),!v)return}this.signalLatency&&(yield Oo(this.signalLatency)),this.handleSignalResponse(g)}),this.ws.onclose=f=>{this.isEstablishingConnection&&c(new Et("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:f.reason,state:this.state})),this.handleOnClose(f.reason)}}finally{l()}}))}close(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return F(this,void 0,void 0,function*(){const n=yield this.closingLock.lock();try{if(t&&(this.state=$t.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const r=new Promise(i=>{this.ws?this.ws.onclose=()=>{i()}:i()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([r,Oo(250)])),this.ws=void 0}}finally{t&&(this.state=$t.DISCONNECTED),this.clearPingInterval(),n()}})}sendOffer(t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:t.sdp})),this.sendRequest({case:"offer",value:am(t)})}sendAnswer(t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:t.sdp})),this.sendRequest({case:"answer",value:am(t)})}sendIceCandidate(t,n){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:t})),this.sendRequest({case:"trickle",value:new Wi({candidateInit:JSON.stringify(t),target:n})})}sendMuteTrack(t,n){return this.sendRequest({case:"mute",value:new ji({sid:t,muted:n})})}sendAddTrack(t){return this.sendRequest({case:"addTrack",value:t})}sendUpdateLocalMetadata(t,n){return this.sendRequest({case:"updateMetadata",value:new _s({metadata:t,name:n})})}sendUpdateTrackSettings(t){this.sendRequest({case:"trackSetting",value:t})}sendUpdateSubscription(t){return this.sendRequest({case:"subscription",value:t})}sendSyncState(t){return this.sendRequest({case:"syncState",value:t})}sendUpdateVideoLayers(t,n){return this.sendRequest({case:"updateLayers",value:new Ts({trackSid:t,layers:n})})}sendUpdateSubscriptionPermissions(t,n){return this.sendRequest({case:"subscriptionPermission",value:new Ns({allParticipants:t,trackPermissions:n})})}sendSimulateScenario(t){return this.sendRequest({case:"simulate",value:t})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Le.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Os({timestamp:Le.parse(Date.now()),rtt:Le.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new hi({canReconnect:!1,reason:Mo.CLIENT_INITIATED})})}sendRequest(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return F(this,void 0,void 0,function*(){if(!n&&!zz(t)&&this.state===$t.RECONNECTING){this.queuedRequests.push(()=>F(this,void 0,void 0,function*(){yield this.sendRequest(t,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield Oo(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){this.log.error("cannot send signal request before connected, type: ".concat(t==null?void 0:t.case),this.logContext);return}const i=new po({message:t});try{this.useJSON?this.ws.send(i.toJsonString()):this.ws.send(i.toBinary())}catch(s){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:s}))}})}handleSignalResponse(t){var n,r;const i=t.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let s=!1;if(i.case==="answer"){const o=EE(i.value);this.onAnswer&&this.onAnswer(o)}else if(i.case==="offer"){const o=EE(i.value);this.onOffer&&this.onOffer(o)}else if(i.case==="trickle"){const o=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(o,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),s=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));s||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const t=this.queuedRequests.shift();t&&this.requestQueue.run(t)}}handleOnClose(t){return F(this,void 0,void 0,function*(){if(this.state===$t.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(t),Object.assign(Object.assign({},this.logContext),{reason:t})),n&&n(t)})}handleWSError(t){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:t}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Bn.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Bn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Bn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Bn.clearInterval(this.pingInterval)}}function EE(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type;break}return t}function am(e){return new hr({sdp:e.sdp,type:e.type})}function Zz(e,t,n){var r;const i=new URLSearchParams;return i.set("access_token",e),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",zc()?"reactnative":"js"),i.set("version",t.version),i.set("protocol",t.protocol.toString()),t.deviceModel&&i.set("device_model",t.deviceModel),t.os&&i.set("os",t.os),t.osVersion&&i.set("os_version",t.osVersion),t.browser&&i.set("browser",t.browser),t.browserVersion&&i.set("browser_version",t.browserVersion),n.publishOnly!==void 0&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var VO={},GO={exports:{}},TE=GO.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(TE).forEach(function(e){var t=TE[e];t.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var WO=GO.exports;(function(e){var t=function(a){return String(Number(a))===a?Number(a):a},n=function(a,c,l,u){if(u&&!l)c[u]=t(a[1]);else for(var d=0;d<l.length;d+=1)a[d+1]!=null&&(c[l[d]]=t(a[d+1]))},r=function(a,c,l){var u=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:u&&!c[a.name]&&(c[a.name]={});var d=a.push?{}:u?c[a.name]:c;n(l.match(a.reg),d,a.names,a.name),a.push&&c[a.push].push(d)},i=WO,s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(a){var c={},l=[],u=c;return a.split(/(\r\n|\r|\n)/).filter(s).forEach(function(d){var f=d[0],h=d.slice(2);f==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var p=0;p<(i[f]||[]).length;p+=1){var m=i[f][p];if(m.reg.test(h))return r(m,u,h)}}),c.media=l,c};var o=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=t(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};e.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(a){return a.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(t),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},e.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},e.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var u,d=!1;return l[0]!=="~"?u=t(l):(u=t(l.substring(1,l.length)),d=!0),{scid:u,paused:d}})})}})(VO);var e0=WO,Xz=/%[sdv%]/g,Kz=function(e){var t=1,n=arguments,r=n.length;return e.replace(Xz,function(i){if(t>=r)return i;var s=n[t];switch(t+=1,i){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}})},_d=function(e,t,n){var r=t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format,i=[e+"="+r];if(t.names)for(var s=0;s<t.names.length;s+=1){var o=t.names[s];t.name?i.push(n[t.name][o]):i.push(n[t.names[s]])}else i.push(n[t.name]);return Kz.apply(null,i)},Jz=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Yz=["i","c","b","a"],qz=function(e,t){t=t||{},e.version==null&&(e.version=0),e.name==null&&(e.name=" "),e.media.forEach(function(s){s.payloads==null&&(s.payloads="")});var n=t.outerOrder||Jz,r=t.innerOrder||Yz,i=[];return n.forEach(function(s){e0[s].forEach(function(o){o.name in e&&e[o.name]!=null?i.push(_d(s,o,e)):o.push in e&&e[o.push]!=null&&e[o.push].forEach(function(a){i.push(_d(s,o,a))})})}),e.media.forEach(function(s){i.push(_d("m",e0.m[0],s)),r.forEach(function(o){e0[o].forEach(function(a){a.name in s&&s[a.name]!=null?i.push(_d(o,a,s)):a.push in s&&s[a.push]!=null&&s[a.push].forEach(function(c){i.push(_d(o,a,c))})})})}),i.join(`\r
`)+`\r
`},Qz=VO,eZ=qz,t0=eZ,Hd=Qz.parse;const _E=.7,lu={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class RE extends Zs.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.log=He,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Zb(s=>F(this,void 0,void 0,function*(){this.emit(lu.NegotiationStarted);try{yield this.createAndSendOffer()}catch(o){if(s)s(o);else throw o}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Wo((i=r.loggerName)!==null&&i!==void 0?i:Gs.PCTransport),this.loggerOptions=r,this.config=t,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const t=Oz()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return t.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},t.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},t.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,t.iceConnectionState)},t.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,t.signalingState)},t.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,t.connectionState)},t.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},t.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},t}get logContext(){var t,n;return Object.assign({},(n=(t=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(t))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(t){return F(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(t);this.pendingCandidates.push(t)})}setRemoteDescription(t){var n;return F(this,void 0,void 0,function*(){let r;if(t.type==="offer"){let{stereoMids:i,nackMids:s}=nZ(t);this.remoteStereoMids=i,this.remoteNackMids=s}else if(t.type==="answer"){const i=Hd((n=t.sdp)!==null&&n!==void 0?n:"");i.media.forEach(s=>{s.type==="audio"&&this.trackBitrates.some(o=>{if(!o.transceiver||s.mid!=o.transceiver.mid)return!1;let a=0;if(s.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of s.fmtp)if(l.payload===a){l.config=l.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),o.maxbr>0&&(l.config+=";maxaveragebitrate=".concat(o.maxbr*1e3)),c=!0;break}return c||o.maxbr>0&&s.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(o.maxbr*1e3)}),!0})}),r=t0(i)}yield this.setMungedSDP(t,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):t.type==="answer"&&(this.emit(lu.NegotiationComplete),t.sdp&&Hd(t.sdp).media.forEach(s=>{s.type==="video"&&this.emit(lu.RTPVideoPayloadTypes,s.rtp)}))})}createAndSendOffer(t){var n;return F(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(t!=null&&t.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(t!=null&&t.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(t),i=Hd((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(s=>{s.type==="audio"?xE(s,[],[]):s.type==="video"&&(tZ(s),this.trackBitrates.some(o=>{if(!s.msid||!o.cid||!s.msid.includes(o.cid))return!1;let a=0;if(s.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of s.fmtp)if(l.payload===a){l.config.includes("x-google-start-bitrate")||(l.config+=";x-google-start-bitrate=".concat(Math.round(o.maxbr*_E))),l.config.includes("x-google-max-bitrate")||(l.config+=";x-google-max-bitrate=".concat(o.maxbr)),c=!0;break}return c||s.fmtp.push({payload:a,config:"x-google-start-bitrate=".concat(Math.round(o.maxbr*_E),";x-google-max-bitrate=").concat(o.maxbr)}),!0}))}),yield this.setMungedSDP(r,t0(i)),this.onOffer(r)})}createAndSetAnswer(){var t;return F(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),r=Hd((t=n.sdp)!==null&&t!==void 0?t:"");return r.media.forEach(i=>{i.type==="audio"&&xE(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,t0(r)),n})}createDataChannel(t,n){return this.pc.createDataChannel(t,n)}addTransceiver(t,n){return this.pc.addTransceiver(t,n)}addTrack(t){if(!this._pc)throw new un("PC closed, cannot add track");return this._pc.addTrack(t)}setTrackCodecBitrate(t){this.trackBitrates.push(t)}setConfiguration(t){var n;if(!this._pc)throw new un("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(t)}canRemoveTrack(){var t;return!!(!((t=this._pc)===null||t===void 0)&&t.removeTrack)}removeTrack(t){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(t)}getConnectionState(){var t,n;return(n=(t=this._pc)===null||t===void 0?void 0:t.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var t,n;return(n=(t=this._pc)===null||t===void 0?void 0:t.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var t,n;return(n=(t=this._pc)===null||t===void 0?void 0:t.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var t,n;return(n=(t=this._pc)===null||t===void 0?void 0:t.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var t,n;return(n=(t=this._pc)===null||t===void 0?void 0:t.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var t;return(t=this._pc)===null||t===void 0?void 0:t.localDescription}getRemoteDescription(){var t;return(t=this.pc)===null||t===void 0?void 0:t.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var t;return F(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const o=(t=r.get(n))===null||t===void 0?void 0:t.remoteCandidateId;if(o!==void 0)return i.get(o)})}setMungedSDP(t,n,r){return F(this,void 0,void 0,function*(){if(n){const i=t.sdp;t.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(t):yield this.pc.setLocalDescription(t);return}catch(s){this.log.warn("not able to set ".concat(t.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:s,sdp:n})),t.sdp=i}}try{r?yield this.pc.setRemoteDescription(t):yield this.pc.setLocalDescription(t)}catch(i){let s="unknown error";i instanceof Error?s=i.message:typeof i=="string"&&(s=i);const o={error:s,sdp:t.sdp};throw!r&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(t.type),Object.assign(Object.assign({},this.logContext),{fields:o})),new vI(s)}})}}function xE(e,t,n){let r=0;e.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(e.rtcpFb||(e.rtcpFb=[]),n.includes(e.mid)&&!e.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&e.rtcpFb.push({payload:r,type:"nack"}),t.includes(e.mid)&&e.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function tZ(e){var t,n,r,i;const s=(n=(t=e.rtp[0])===null||t===void 0?void 0:t.codec)===null||n===void 0?void 0:n.toLowerCase();if(!af(s))return;let o=0;((r=e.ext)===null||r===void 0?void 0:r.some(c=>c.uri===vE?!0:(c.value>o&&(o=c.value),!1)))||(i=e.ext)===null||i===void 0||i.push({value:o+1,uri:vE})}function nZ(e){var t;const n=[],r=[],i=Hd((t=e.sdp)!==null&&t!==void 0?t:"");let s=0;return i.media.forEach(o=>{var a;o.type==="audio"&&(o.rtp.some(c=>c.codec==="opus"?(s=c.payload,!0):!1),!((a=o.rtcpFb)===null||a===void 0)&&a.some(c=>c.payload===s&&c.type==="nack")&&r.push(o.mid),o.fmtp.some(c=>c.payload===s?(c.config.includes("sprop-stereo=1")&&n.push(o.mid),!0):!1))}),{stereoMids:n,nackMids:r}}const bI="vp8",rZ={audioBitrate:sm.music.maxBitrate,audioPreset:sm.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:Xb.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:bI,backupCodec:!0},jO={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},HO={resolution:zf.h720.resolution},iZ={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new X8,disconnectOnPageLeave:!0,expWebAudioMix:!1},qb={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var fn;(function(e){e[e.NEW=0]="NEW",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.FAILED=3]="FAILED",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"})(fn||(fn={}));class sZ{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(t,n,r){var i;this.peerConnectionTimeout=qb.peerConnectionTimeout,this.log=He,this.updateState=()=>{var o;const a=this.state,c=this.requiredTransports.map(l=>l.getConnectionState());c.every(l=>l==="connected")?this.state=fn.CONNECTED:c.some(l=>l==="failed")?this.state=fn.FAILED:c.some(l=>l==="connecting")?this.state=fn.CONNECTING:c.every(l=>l==="closed")?this.state=fn.CLOSED:c.some(l=>l==="closed")?this.state=fn.CLOSING:c.every(l=>l==="new")&&(this.state=fn.NEW),a!==this.state&&(this.log.debug("pc state change: from ".concat(fn[a]," to ").concat(fn[this.state]),this.logContext),(o=this.onStateChange)===null||o===void 0||o.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=Wo((i=r.loggerName)!==null&&i!==void 0?i:Gs.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const s={optional:[{googDscp:!0}]};this.publisher=new RE(t,s,r),this.subscriber=new RE(t,void 0,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=o=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,o,qn.PUBLISHER)},this.subscriber.onIceCandidate=o=>{var a;(a=this.onIceCandidate)===null||a===void 0||a.call(this,o,qn.SUBSCRIBER)},this.subscriber.onDataChannel=o=>{var a;(a=this.onDataChannel)===null||a===void 0||a.call(this,o)},this.subscriber.onTrack=o=>{var a;(a=this.onTrack)===null||a===void 0||a.call(this,o)},this.publisher.onOffer=o=>{var a;(a=this.onPublisherOffer)===null||a===void 0||a.call(this,o)},this.state=fn.NEW,this.connectionLock=new Xi}get logContext(){var t,n;return Object.assign({},(n=(t=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(t))}requirePublisher(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=t,this.updateState()}requireSubscriber(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=t,this.updateState()}createAndSendPublisherOffer(t){return this.publisher.createAndSendOffer(t)}setPublisherAnswer(t){return this.publisher.setRemoteDescription(t)}removeTrack(t){return this.publisher.removeTrack(t)}close(){return F(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const t=this.publisher;for(const n of t.getSenders())try{t.canRemoveTrack()&&t.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return F(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(t,n){return F(this,void 0,void 0,function*(){n===qn.PUBLISHER?yield this.publisher.addIceCandidate(t):yield this.subscriber.addIceCandidate(t)})}createSubscriberAnswerFromOffer(t){return F(this,void 0,void 0,function*(){return this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:t.type,sdp:t.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(t),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(t,n){this.publisher.setConfiguration(t),this.subscriber.setConfiguration(t),n&&this.triggerIceRestart()}ensurePCTransportConnection(t,n){var r;return F(this,void 0,void 0,function*(){const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(s=>this.ensureTransportConnected(s,t,n)))}finally{i()}})}negotiate(t){return F(this,void 0,void 0,function*(){return new Promise((n,r)=>F(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),s=()=>{clearTimeout(i),r("negotiation aborted")};t.signal.addEventListener("abort",s),this.publisher.once(lu.NegotiationStarted,()=>{t.signal.aborted||this.publisher.once(lu.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(o=>{clearTimeout(i),r(o)})}))})}addPublisherTransceiver(t,n){return this.publisher.addTransceiver(t,n)}addPublisherTrack(t){return this.publisher.addTrack(t)}createPublisherDataChannel(t,n){return this.publisher.createDataChannel(t,n)}getConnectedAddress(t){return t===qn.PUBLISHER?this.publisher.getConnectedAddress():t===qn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const t=[];return this.isPublisherConnectionRequired&&t.push(this.publisher),this.isSubscriberConnectionRequired&&t.push(this.subscriber),t}ensureTransportConnected(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return F(this,void 0,void 0,function*(){if(t.getConnectionState()!=="connected")return new Promise((s,o)=>F(this,void 0,void 0,function*(){const a=()=>{this.log.warn("abort transport connection",this.logContext),Bn.clearTimeout(c),o(new Et("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&a(),n==null||n.signal.addEventListener("abort",a);const c=Bn.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",a),o(new Et("could not establish pc connection"))},r);for(;this.state!==fn.CONNECTED;)if(yield Oo(50),n!=null&&n.signal.aborted){o(new Et("room connection has been cancelled",3));return}Bn.clearTimeout(c),n==null||n.signal.removeEventListener("abort",a),s()}))})}}const NE="_lossy",PE="_reliable",oZ=2*1e3,ME="leave-reconnect";var ki;(function(e){e[e.New=0]="New",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected",e[e.Reconnecting=3]="Reconnecting",e[e.Closed=4]="Closed"})(ki||(ki={}));class aZ extends Zs.EventEmitter{get isClosed(){return this._isClosed}constructor(t){var n;super(),this.options=t,this.rtcConfig={},this.peerConnectionTimeout=qb.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=ki.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=He,this.handleDataChannel=r=>{let{channel:i}=r;return F(this,void 0,void 0,function*(){if(i){if(i.label===PE)this.reliableDCSub=i;else if(i.label===NE)this.lossyDCSub=i;else return;this.log.debug("on data channel ".concat(i.id,", ").concat(i.label),this.logContext),i.onmessage=this.handleDataMessage}})},this.handleDataMessage=r=>F(this,void 0,void 0,function*(){var i,s;const o=yield this.dataProcessLock.lock();try{let a;if(r.data instanceof ArrayBuffer)a=r.data;else if(r.data instanceof Blob)a=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const c=ys.fromBinary(new Uint8Array(a));((i=c.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(me.ActiveSpeakersUpdate,c.value.value.speakers):((s=c.value)===null||s===void 0?void 0:s.case)==="user"&&this.emit(me.DataPacketReceived,c.value.value,c.kind)}finally{o()}}),this.handleDataError=r=>{const s=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:o}=r.error;this.log.error("DataChannel error on ".concat(s,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:o}))}else this.log.error("Unknown DataChannel error on ".concat(s),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const s=r.currentTarget.maxRetransmits===0?dn.LOSSY:dn.RELIABLE;this.updateAndEmitDCBufferStatus(s)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const s=c=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(c,"ms. giving up"),this.logContext),this.emit(me.Disconnected),this.close()},o=Date.now()-this.reconnectStart;let a=this.getNextRetryDelay({elapsedMs:o,retryCount:this.reconnectAttempts});if(a===null){s(o);return}r===ME&&(a=0),this.log.debug("reconnecting in ".concat(a,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Bn.setTimeout(()=>this.attemptReconnect(i),a)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===ki.Connected&&r();const s=()=>{this.off(me.Disconnected,o),r()},o=()=>{this.off(me.Restarted,s),i()};this.once(me.Restarted,s),this.once(me.Disconnected,o)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(me.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===$t.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(eo.RR_SIGNAL_DISCONNECTED))},this.log=Wo((n=t.loggerName)!==null&&n!==void 0?n:Gs.Engine),this.loggerOptions={loggerName:t.loggerName,loggerContextCb:()=>this.logContext},this.client=new Yb(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Xi,this.dataProcessLock=new Xi,this.dcBufferStatus=new Map([[dn.LOSSY,!0],[dn.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(me.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(me.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(me.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(me.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(me.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(me.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(me.StreamStateChanged,r)}get logContext(){var t,n,r,i,s,o;return{room:(n=(t=this.latestJoinResponse)===null||t===void 0?void 0:t.room)===null||n===void 0?void 0:n.name,roomSid:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,identity:(o=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.participant)===null||o===void 0?void 0:o.identity}}join(t,n,r,i){return F(this,void 0,void 0,function*(){this.url=t,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(t,n,r,i);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.pcManager||(yield this.configure(s)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=s.clientConfiguration,s}catch(s){if(s instanceof Et&&s.reason===1&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(t,n,r,i);throw s}})}close(){return F(this,void 0,void 0,function*(){const t=yield this.closingLock.lock();if(this.isClosed){t();return}try{this._isClosed=!0,this.emit(me.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{t()}})}cleanupPeerConnections(){var t;return F(this,void 0,void 0,function*(){yield(t=this.pcManager)===null||t===void 0?void 0:t.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return F(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(t){if(this.pendingTrackResolvers[t.cid])throw new fs("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[t.cid],r(new Et("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[t.cid]={resolve:s=>{clearTimeout(i),n(s)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(t)})}removeTrack(t){if(t.track&&this.pendingTrackResolvers[t.track.id]){const{reject:n}=this.pendingTrackResolvers[t.track.id];n&&n(),delete this.pendingTrackResolvers[t.track.id]}try{return this.pcManager.removeTrack(t),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(t,n){this.client.sendMuteTrack(t,n)}get dataSubscriberReadyState(){var t;return(t=this.reliableDCSub)===null||t===void 0?void 0:t.readyState}getConnectedServerAddress(){var t;return F(this,void 0,void 0,function*(){return(t=this.pcManager)===null||t===void 0?void 0:t.getConnectedAddress()})}setRegionUrlProvider(t){this.regionUrlProvider=t}configure(t){var n;return F(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==fn.NEW)return;this.participantSid=(n=t.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(t);this.pcManager=new sZ(r,t.subscriberPrimary,this.loggerOptions),this.emit(me.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(i,s)=>{this.client.sendIceCandidate(i,s)},this.pcManager.onPublisherOffer=i=>{this.client.sendOffer(i)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(i,s,o)=>F(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(i),this.logContext),i===fn.CONNECTED){const a=this.pcState===ki.New;this.pcState=ki.Connected,a&&this.emit(me.Connected,t)}else i===fn.FAILED&&this.pcState===ki.Connected&&(this.pcState=ki.Disconnected,this.handleDisconnect("peerconnection failed",o==="failed"?eo.RR_SUBSCRIBER_FAILED:eo.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=i=>{this.emit(me.MediaTrackAdded,i.track,i.streams[0],i.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=t=>F(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:t.type})),yield this.pcManager.setPublisherAnswer(t))}),this.client.onTrickle=(t,n)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:t,target:n})),this.pcManager.addIceCandidate(t,n))},this.client.onOffer=t=>F(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(t);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=t=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:t.cid,track:(n=t.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[t.cid]){this.log.error("missing track resolver for ".concat(t.cid),Object.assign(Object.assign({},this.logContext),{cid:t.cid}));return}const{resolve:r}=this.pendingTrackResolvers[t.cid];delete this.pendingTrackResolvers[t.cid],r(t.track)},this.client.onLocalTrackUnpublished=t=>{this.emit(me.LocalTrackUnpublished,t)},this.client.onTokenRefresh=t=>{this.token=t},this.client.onRemoteMuteChanged=(t,n)=>{this.emit(me.RemoteMute,t,n)},this.client.onSubscribedQualityUpdate=t=>{this.emit(me.SubscribedQualityUpdate,t)},this.client.onClose=()=>{this.handleDisconnect("signal",eo.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=t=>{t!=null&&t.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(ME)):(this.emit(me.Disconnected,t==null?void 0:t.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:t==null?void 0:t.reason}))}}makeRTCConfiguration(t){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),t.iceServers&&!r.iceServers){const i=[];t.iceServers.forEach(s=>{const o={urls:s.urls};s.username&&(o.username=s.username),s.credential&&(o.credential=s.credential),i.push(o)}),r.iceServers=i}return t.clientConfiguration&&t.clientConfiguration.forceRelay===qi.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(NE,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(PE,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(t,n,r){if(!("getCapabilities"in RTCRtpSender))return;const i=RTCRtpSender.getCapabilities(n);if(!i)return;this.log.debug("get sender capabilities",Object.assign(Object.assign({},this.logContext),{cap:i}));const s=[],o=[],a=[];i.codecs.forEach(c=>{const l=c.mimeType.toLowerCase();if(l==="audio/opus"){s.push(c);return}if(!(l==="video/".concat(r))){a.push(c);return}if(r==="h264"){c.sdpFmtpLine&&c.sdpFmtpLine.includes("profile-level-id=42e01f")?s.push(c):o.push(c);return}s.push(c)}),Mz(t)&&t.setCodecPreferences(s.concat(o,a))}createSender(t,n,r){return F(this,void 0,void 0,function*(){if(yE())return yield this.createTransceiverRTCRtpSender(t,n,r);if(CE())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(t.mediaStreamTrack);throw new un("Required webRTC APIs not supported on this device")})}createSimulcastSender(t,n,r,i){return F(this,void 0,void 0,function*(){if(yE())return this.createSimulcastTransceiverSender(t,n,r,i);if(CE())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(t.mediaStreamTrack);throw new un("Cannot stream on this device")})}createTransceiverRTCRtpSender(t,n,r){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new un("publisher is closed");const i=[];t.mediaStream&&i.push(t.mediaStream);const s={direction:"sendonly",streams:i};r&&(s.sendEncodings=r);const o=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,s);return t.kind===Y.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(o,t.kind,n.videoCodec),t.codec=n.videoCodec),o.sender})}createSimulcastTransceiverSender(t,n,r,i){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new un("publisher is closed");const s={direction:"sendonly"};i&&(s.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,s);if(r.videoCodec)return this.setPreferredCodec(o,t.kind,r.videoCodec),t.setSimulcastTrackSender(r.videoCodec,o.sender),o.sender})}createRTCRtpSender(t){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new un("publisher is closed");return this.pcManager.addPublisherTrack(t)})}attemptReconnect(t){var n,r,i;return F(this,void 0,void 0,function*(){if(!this._isClosed){if(this.attemptingReconnect){He.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===qi.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:fn.NEW)===fn.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(t),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let o=!0;s instanceof un?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:s})),o=!1):s instanceof yl||(this.fullReconnectOnNext=!0),o?this.handleDisconnect("reconnect",eo.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(me.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(t){try{return this.reconnectPolicy.nextRetryDelayInMs(t)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(t){var n,r,i;return F(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new un("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(me.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new yl;s=yield this.join(t??this.url,this.token,this.signalOpts)}catch(o){throw o instanceof Et&&o.reason===0?new un("could not reconnect, token might be expired"):new yl}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(me.SignalRestarted,s),yield this.waitForPCReconnected(),this.client.currentState!==$t.CONNECTED)throw new yl("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(me.Restarted)}catch(s){const o=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(o){yield this.restartConnection(o);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),s}})}resumeConnection(t){var n;return F(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new un("could not reconnect, url or token not saved");if(!this.pcManager)throw new un("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(me.Resuming);try{this.setupSignalClientCallbacks();const r=yield this.client.reconnect(this.url,this.token,this.participantSid,t);if(r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}}catch(r){let i="";throw r instanceof Error&&(i=r.message,this.log.error(r.message,Object.assign(Object.assign({},this.logContext),{error:r}))),r instanceof Et&&r.reason===0?new un("could not reconnect, token might be expired"):r instanceof Et&&r.reason===4?r:new yl(i)}if(this.emit(me.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==$t.CONNECTED)throw new yl("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(me.Resumed)})}waitForPCInitialConnection(t,n){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new un("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,t)})}waitForPCReconnected(){return F(this,void 0,void 0,function*(){this.pcState=ki.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Oo(oZ),!this.pcManager)throw new un("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=ki.Connected}catch(t){throw this.pcState=ki.Disconnected,new Et("could not establish PC connection, ".concat(t.message))}})}sendDataPacket(t,n){return F(this,void 0,void 0,function*(){const r=t.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var r;return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new un("PC manager is closed");const i=n?this.pcManager.subscriber:this.pcManager.publisher,s=n?"Subscriber":"Publisher";if(!i)throw new Et("".concat(s," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const o=this.dataChannelForKind(t,n);if((o==null?void 0:o.readyState)==="open")return;const a=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<a;){if(i.isICEConnected&&((r=this.dataChannelForKind(t,n))===null||r===void 0?void 0:r.readyState)==="open")return;yield Oo(50)}throw new Et("could not establish ".concat(s," connection, state: ").concat(i.getICEConnectionState()))})}ensurePublisherConnected(t){return F(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(t,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==fn.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return F(this,void 0,void 0,function*(){return new Promise((t,n)=>F(this,void 0,void 0,function*(){if(!this.pcManager){n(new vI("PC manager is closed"));return}this.pcManager.requirePublisher();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),t()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(me.Closing,i),this.pcManager.publisher.once(lu.RTPVideoPayloadTypes,s=>{const o=new Map;s.forEach(a=>{const c=a.codec.toLowerCase();Vz(c)&&o.set(a.payload,c)}),this.emit(me.RTPVideoMapUpdate,o)});try{yield this.pcManager.negotiate(r),t()}catch(s){s instanceof vI&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",eo.RR_UNKNOWN),n(s)}finally{this.off(me.Closing,i)}}))})}dataChannelForKind(t,n){if(n){if(t===dn.LOSSY)return this.lossyDCSub;if(t===dn.RELIABLE)return this.reliableDCSub}else{if(t===dn.LOSSY)return this.lossyDC;if(t===dn.RELIABLE)return this.reliableDC}}sendSyncState(t,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const s=this.pcManager.subscriber.getLocalDescription(),o=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,c=new Array;t.forEach(l=>{l.isDesired!==a&&c.push(l.trackSid)}),this.client.sendSyncState(new Ps({answer:s?am({sdp:s.sdp,type:s.type}):void 0,offer:o?am({sdp:o.sdp,type:o.type}):void 0,subscription:new fi({trackSids:c,subscribe:!a,participantTracks:[]}),publishTracks:Tz(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const t=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&t.push(new Ms({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(dn.LOSSY),qn.PUBLISHER),n(this.dataChannelForKind(dn.RELIABLE),qn.PUBLISHER),n(this.dataChannelForKind(dn.LOSSY,!0),qn.SUBSCRIBER),n(this.dataChannelForKind(dn.RELIABLE,!0),qn.SUBSCRIBER),t}clearReconnectTimeout(){this.reconnectTimeout&&Bn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Pr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Pr()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class yl extends Error{}class OE{constructor(t,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(t),this.token=n}updateToken(t){this.token=t}isCloud(){return SI(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(t){return F(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(t));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),He.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(t){return F(this,void 0,void 0,function*(){const n=yield fetch("".concat(cZ(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:t});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new Et("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function cZ(e){return"".concat(e.protocol.replace("ws","http"),"//").concat(e.host,"/settings")}const Qb=2e3;function dv(e,t){if(!t)return 0;let n,r;return"bytesReceived"in e?(n=e.bytesReceived,r=t.bytesReceived):"bytesSent"in e&&(n=e.bytesSent,r=t.bytesSent),n===void 0||r===void 0||e.timestamp===void 0||t.timestamp===void 0?0:(n-r)*8*1e3/(e.timestamp-t.timestamp)}class br extends Mu{constructor(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;super(t,Y.Kind.Audio,n,r,s),this.stopOnMute=!1,this.monitorSender=()=>F(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}o&&this.prevStats&&(this._currentBitrate=dv(o,this.prevStats)),this.prevStats=o}),this.audioContext=i,this.checkForSilence()}setDeviceId(t){return F(this,void 0,void 0,function*(){return this._constraints.deviceId===t?!0:(this._constraints.deviceId=t,this.isMuted||(yield this.restartTrack()),this.isMuted||Pc(t)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const t=Object.create(null,{mute:{get:()=>super.mute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield t.mute.call(this),this}finally{n()}})}unmute(){const t=Object.create(null,{unmute:{get:()=>super.unmute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Pc(this._constraints.deviceId);return this.source===Y.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield t.unmute.call(this),this}finally{n()}})}restartTrack(t){return F(this,void 0,void 0,function*(){let n;if(t){const r=uv({audio:t});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(t){const n=Object.create(null,{restart:{get:()=>super.restart}});return F(this,void 0,void 0,function*(){const r=yield n.restart.call(this,t);return this.checkForSilence(),r})}startMonitor(){Pr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Qb)))}setProcessor(t){var n;return F(this,void 0,void 0,function*(){const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(t.name),this.logContext),yield t.init(i),this.processor=t,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{r()}})}setAudioContext(t){this.audioContext=t}getSenderStats(){var t;return F(this,void 0,void 0,function*(){if(!(!((t=this.sender)===null||t===void 0)&&t.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return F(this,void 0,void 0,function*(){const t=yield kz(this);return t&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(fe.AudioSilenceDetected)),t})}}function $O(e,t,n){switch(e.kind){case"audio":return new br(e,t,!1,void 0,n);case"video":return new oi(e,t,!1,n);default:throw new fs("unsupported track type: ".concat(e.kind))}}const lZ=Object.values(zf),uZ=Object.values(yI),dZ=Object.values(Xb),fZ=[zf.h180,zf.h360],hZ=[yI.h180,yI.h360],pZ=e=>[{scaleResolutionDownBy:2,fps:e.encoding.maxFramerate}].map(n=>{var r,i;return new ct(Math.floor(e.width/n.scaleResolutionDownBy),Math.floor(e.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(e.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=e.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=n.fps)!==null&&i!==void 0?i:30))))),n.fps,e.encoding.priority)}),wI=["q","h","f"];function kI(e,t,n,r){var i,s;let o=r==null?void 0:r.videoEncoding;e&&(o=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,c=r==null?void 0:r.scalabilityMode,l=r==null?void 0:r.videoCodec;if(!o&&!a&&!c||!t||!n)return[{}];o||(o=mZ(e,t,n,l),He.debug("using video encoding",o));const u=new ct(t,n,o.maxBitrate,o.maxFramerate,o.priority);if(c&&af(l)){He.debug("using svc with scalabilityMode ".concat(c));const h=new zO(c),p=[];if(h.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));for(let m=0;m<h.spatial;m+=1)p.push({rid:wI[2-m],maxBitrate:o.maxBitrate/Math.pow(3,m),maxFramerate:u.encoding.maxFramerate});return p[0].scalabilityMode=c,He.debug("encodings",p),p}if(!a)return[o];let d=[];e?d=(i=LE(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:DE(e,u):d=(s=LE(r==null?void 0:r.videoSimulcastLayers))!==null&&s!==void 0?s:DE(e,u);let f;if(d.length>0){const h=d[0];d.length>1&&([,f]=d);const p=Math.max(t,n);if(p>=960&&f)return n0(t,n,[h,f,u]);if(p>=480)return n0(t,n,[h,u])}return n0(t,n,[u])}function gZ(e,t,n){var r,i,s,o;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;t!==n.backupCodec.codec&&He.warn("requested a different codec than specified as backup",{serverRequested:t,backup:n.backupCodec.codec}),n.videoCodec=t,n.videoEncoding=n.backupCodec.encoding;const a=e.mediaStreamTrack.getSettings(),c=(r=a.width)!==null&&r!==void 0?r:(i=e.dimensions)===null||i===void 0?void 0:i.width,l=(s=a.height)!==null&&s!==void 0?s:(o=e.dimensions)===null||o===void 0?void 0:o.height;return kI(e.source===Y.Source.ScreenShare,c,l,n)}function mZ(e,t,n,r){const i=vZ(e,t,n);let{encoding:s}=i[0];const o=Math.max(t,n);for(let a=0;a<i.length;a+=1){const c=i[a];if(s=c.encoding,c.width>=o)break}if(r)switch(r){case"av1":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function vZ(e,t,n){if(e)return dZ;const r=t>n?t/n:n/t;return Math.abs(r-16/9)<Math.abs(r-4/3)?lZ:uZ}function DE(e,t){if(e)return pZ(t);const{width:n,height:r}=t,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?fZ:hZ}function n0(e,t,n){const r=[];if(n.forEach((i,s)=>{if(s>=wI.length)return;const o=Math.min(e,t),c={rid:wI[s],scaleResolutionDownBy:Math.max(1,o/Math.min(i.width,i.height)),maxBitrate:i.encoding.maxBitrate};i.encoding.maxFramerate&&(c.maxFramerate=i.encoding.maxFramerate);const l=Pu()||s===0;i.encoding.priority&&l&&(c.priority=i.encoding.priority,c.networkPriority=i.encoding.priority),r.push(c)}),zc()&&FO()==="ios"){let i;r.forEach(o=>{i?o.maxFramerate&&o.maxFramerate>i&&(i=o.maxFramerate):i=o.maxFramerate});let s=!0;r.forEach(o=>{var a;o.maxFramerate!=i&&(s&&(s=!1,He.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),He.info('Setting framerate of encoding "'.concat((a=o.rid)!==null&&a!==void 0?a:"",'" to ').concat(i)),o.maxFramerate=i)})}return r}function LE(e){if(e)return e.sort((t,n)=>{const{encoding:r}=t,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class zO{constructor(t){const n=t.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var t;return"L".concat(this.spatial,"T").concat(this.temporal).concat((t=this.suffix)!==null&&t!==void 0?t:"")}}const yZ=5e3;class oi extends Mu{constructor(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(t,Y.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.monitorSender=()=>F(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}const o=new Map(s.map(a=>[a.rid,a]));if(this.prevStats){let a=0;o.forEach((c,l)=>{var u;const d=(u=this.prevStats)===null||u===void 0?void 0:u.get(l);a+=dv(c,d)}),this._currentBitrate=a}this.prevStats=o}),this.senderLock=new Xi}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(t){var n;if(this.signalClient=t,!Pr())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Qb))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(t=>{t.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const t=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,r,i,s,o;return F(this,void 0,void 0,function*(){yield t.pauseUpstream.call(this);try{for(var a=!0,c=bl(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0)s=l.value,a=!1,yield(o=s.sender)===null||o===void 0?void 0:o.replaceTrack(null)}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}resumeUpstream(){const t=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,r,i,s,o;return F(this,void 0,void 0,function*(){yield t.resumeUpstream.call(this);try{for(var a=!0,c=bl(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){s=l.value,a=!1;const u=s;yield(o=u.sender)===null||o===void 0?void 0:o.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}mute(){const t=Object.create(null,{mute:{get:()=>super.mute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield t.mute.call(this),this}finally{n()}})}unmute(){const t=Object.create(null,{unmute:{get:()=>super.unmute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Y.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield t.unmute.call(this),this}finally{n()}})}setTrackMuted(t){super.setTrackMuted(t);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!t}getSenderStats(){var t;return F(this,void 0,void 0,function*(){if(!(!((t=this.sender)===null||t===void 0)&&t.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var s;if(i.type==="outbound-rtp"){const o={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:(s=i.rid)!==null&&s!==void 0?s:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},a=r.get(i.remoteId);a&&(o.jitter=a.jitter,o.packetsLost=a.packetsLost,o.roundTripTime=a.roundTripTime),n.push(o)}}),n})}setPublishingQuality(t){const n=[];for(let r=vn.LOW;r<=vn.HIGH;r+=1)n.push(new $i({quality:r,enabled:r<=t}));this.log.debug("setting publishing quality. max quality ".concat(t),this.logContext),this.setPublishingLayers(n)}setDeviceId(t){return F(this,void 0,void 0,function*(){return this._constraints.deviceId===t&&this._mediaStreamTrack.getSettings().deviceId===Pc(t)?!0:(this._constraints.deviceId=t,this.isMuted||(yield this.restartTrack()),this.isMuted||Pc(t)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(t){var n,r,i,s;return F(this,void 0,void 0,function*(){let o;if(t){const u=uv({video:t});typeof u.video!="boolean"&&(o=u.video)}yield this.restart(o);try{for(var a=!0,c=bl(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){s=l.value,a=!1;const u=s;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){r={error:u}}finally{try{!a&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}setProcessor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var i,s,o,a,c,l;return F(this,void 0,void 0,function*(){if(yield r.setProcessor.call(this,t,n),!((c=this.processor)===null||c===void 0)&&c.processedTrack)try{for(var u=!0,d=bl(this.simulcastCodecs.values()),f;f=yield d.next(),i=f.done,!i;u=!0)a=f.value,u=!1,yield(l=a.sender)===null||l===void 0?void 0:l.replaceTrack(this.processor.processedTrack)}catch(h){s={error:h}}finally{try{!u&&!i&&(o=d.return)&&(yield o.call(d))}finally{if(s)throw s.error}}})}addSimulcastTrack(t,n){if(this.simulcastCodecs.has(t))throw new Error("".concat(t," already added"));const r={codec:t,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(t,r),r}setSimulcastTrackSender(t,n){const r=this.simulcastCodecs.get(t);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},yZ))}setPublishingCodecs(t){var n,r,i,s,o,a,c;return F(this,void 0,void 0,function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:t,currentCodec:this.codec})),!this.codec&&t.length>0)return yield this.setPublishingLayers(t[0].qualities),[];this.subscribedCodecs=t;const l=[];try{for(n=!0,r=bl(t);i=yield r.next(),s=i.done,!s;n=!0){c=i.value,n=!1;const u=c;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(this.log.debug("try setPublishingCodec for ".concat(u.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const f of u.qualities)if(f.enabled){l.push(u.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(u.codec),this.logContext),yield BE(d.sender,d.encodings,u.qualities,this.senderLock,this.log,this.logContext))}}}catch(u){o={error:u}}finally{try{!n&&!s&&(a=r.return)&&(yield a.call(r))}finally{if(o)throw o.error}}return l})}setPublishingLayers(t){return F(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),!(!this.sender||!this.encodings)&&(yield BE(this.sender,this.encodings,t,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const t=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return F(this,void 0,void 0,function*(){yield t.handleAppVisibilityChanged.call(this),LO()&&this.isInBackground&&this.source===Y.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function BE(e,t,n,r,i,s){return F(this,void 0,void 0,function*(){const o=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},s),{sender:e,qualities:n,senderEncodings:t}));try{const a=e.getParameters(),{encodings:c}=a;if(!c)return;if(c.length!==t.length){i.warn("cannot set publishing layers, encodings mismatch");return}let l=!1;!1&&c[0].scalabilityMode||c.forEach((d,f)=>{var h;let p=(h=d.rid)!==null&&h!==void 0?h:"";p===""&&(p="q");const m=ZO(p),y=n.find(g=>g.quality===m);y&&d.active!==y.enabled&&(l=!0,d.active=y.enabled,i.debug("setting layer ".concat(y.quality," to ").concat(d.active?"enabled":"disabled"),s),Pu()&&(y.enabled?(d.scaleResolutionDownBy=t[f].scaleResolutionDownBy,d.maxBitrate=t[f].maxBitrate,d.maxFrameRate=t[f].maxFrameRate):(d.scaleResolutionDownBy=4,d.maxBitrate=10,d.maxFrameRate=2)))}),l&&(a.encodings=c,i.debug("setting encodings",Object.assign(Object.assign({},s),{encodings:a.encodings})),yield e.setParameters(a))}finally{o()}})}function ZO(e){switch(e){case"f":return vn.HIGH;case"h":return vn.MEDIUM;case"q":return vn.LOW;default:return vn.HIGH}}function FE(e,t,n,r){if(!n)return[new fr({quality:vn.HIGH,width:e,height:t,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,s=new zO(i),o=[];for(let a=0;a<s.spatial;a+=1)o.push(new fr({quality:vn.HIGH-a,width:Math.ceil(e/Math.pow(2,a)),height:Math.ceil(t/Math.pow(2,a)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,a)):0,ssrc:0}));return o}return n.map(i=>{var s,o,a;const c=(s=i.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let l=ZO((o=i.rid)!==null&&o!==void 0?o:"");return new fr({quality:l,width:Math.ceil(e/c),height:Math.ceil(t/c),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}class XO extends Y{constructor(t,n,r,i,s){super(t,r,s),this.sid=n,this.receiver=i}setMuted(t){this.isMuted!==t&&(this.isMuted=t,this._mediaStreamTrack.enabled=!t,this.emit(t?fe.Muted:fe.Unmuted,this))}setMediaStream(t){this.mediaStream=t;const n=r=>{r.track===this._mediaStreamTrack&&(t.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(fe.Ended,this))};t.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var t;return F(this,void 0,void 0,function*(){return!((t=this.receiver)===null||t===void 0)&&t.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Qb))}}class Mc extends XO{constructor(t,n,r,i,s,o){super(t,n,Y.Kind.Audio,r,o),this.monitorReceiver=()=>F(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=dv(a,this.prevStats)),this.prevStats=a}),this.audioContext=i,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(t){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(t,0,.1):r.volume=t;zc()&&this._mediaStreamTrack._setVolume(t),this.elementVolume=t}getVolume(){if(this.elementVolume)return this.elementVolume;if(zc())return 1;let t=0;return this.attachedElements.forEach(n=>{n.volume>t&&(t=n.volume)}),t}setSinkId(t){return F(this,void 0,void 0,function*(){this.sinkId=t,yield Promise.all(this.attachedElements.map(n=>{if(II(n))return n.setSinkId(t)}))})}attach(t){const n=this.attachedElements.length===0;return t?super.attach(t):t=super.attach(),this.sinkId&&II(t)&&t.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,t),t.volume=0,t.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),t}detach(t){let n;return t?(n=super.detach(t),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(t){this.audioContext=t,t&&this.attachedElements.length>0?this.connectWebAudio(t,this.attachedElements[0]):t||this.disconnectWebAudio()}setWebAudioPlugins(t){this.webAudioPluginNodes=t,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(t,n){this.disconnectWebAudio(),this.sourceNode=t.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=t.createGain(),r.connect(this.gainNode),this.gainNode.connect(t.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),t.state!=="running"&&t.resume().then(()=>{t.state!=="running"&&this.emit(fe.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(fe.AudioPlaybackFailed,i)})}disconnectWebAudio(){var t,n;(t=this.gainNode)===null||t===void 0||t.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return F(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const t=yield this.receiver.getStats();let n;return t.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const r0=100;class lf extends XO{constructor(t,n,r,i,s){super(t,n,Y.Kind.Video,r,s),this.elementInfos=[],this.monitorReceiver=()=>F(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const o=yield this.getReceiverStats();o&&this.prevStats&&this.receiver&&(this._currentBitrate=dv(o,this.prevStats)),this.prevStats=o}),this.debouncedHandleResize=Zb(()=>{this.updateDimensions()},r0),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(t){super.setMuted(t),this.attachedElements.forEach(n=>{t?cu(this._mediaStreamTrack,n):Gl(this._mediaStreamTrack,n)})}attach(t){if(t?super.attach(t):t=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===t)===void 0){const n=new CZ(t);this.observeElementInfo(n)}return t}observeElementInfo(t){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===t)===void 0?(t.handleResize=()=>{this.debouncedHandleResize()},t.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(t),t.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(t){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===t);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==t),this.updateVisibility(),this.debouncedHandleResize()}detach(t){let n=[];if(t)return this.stopObservingElement(t),super.detach(t);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var t;return(t=this.prevStats)===null||t===void 0?void 0:t.decoderImplementation}getReceiverStats(){return F(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const t=yield this.receiver.getStats();let n,r="",i=new Map;return t.forEach(s=>{s.type==="inbound-rtp"?(r=s.codecId,n={type:"video",framesDecoded:s.framesDecoded,framesDropped:s.framesDropped,framesReceived:s.framesReceived,packetsReceived:s.packetsReceived,packetsLost:s.packetsLost,frameWidth:s.frameWidth,frameHeight:s.frameHeight,pliCount:s.pliCount,firCount:s.firCount,nackCount:s.nackCount,jitter:s.jitter,timestamp:s.timestamp,bytesReceived:s.bytesReceived,decoderImplementation:s.decoderImplementation}):s.type==="codec"&&i.set(s.id,s)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(t){const n=this.elementInfos.filter(r=>r.element===t);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const t=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return F(this,void 0,void 0,function*(){yield t.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var t,n;const r=this.elementInfos.reduce((a,c)=>Math.max(a,c.visibilityChangedAt||0),0),i=!((n=(t=this.adaptiveStreamSettings)===null||t===void 0?void 0:t.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,s=this.elementInfos.some(a=>a.pictureInPicture),o=this.elementInfos.some(a=>a.visible)&&!i||s;if(this.lastVisible!==o){if(!o&&Date.now()-r<r0){Bn.setTimeout(()=>{this.updateVisibility()},r0);return}this.lastVisible=o,this.emit(fe.VisibilityChanged,o,this)}}updateDimensions(){var t,n;let r=0,i=0;const s=this.getPixelDensity();for(const o of this.elementInfos){const a=o.width()*s,c=o.height()*s;a+c>r+i&&(r=a,i=c)}((t=this.lastDimensions)===null||t===void 0?void 0:t.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(fe.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var t;const n=(t=this.adaptiveStreamSettings)===null||t===void 0?void 0:t.pixelDensity;return n==="screen"?IE():n||(IE()>2?2:1)}}class CZ{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(t,n){this.onVisibilityChanged=r=>{var i;const{target:s,isIntersecting:o}=r;s===this.element&&(this.isIntersecting=o,this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r;this.isPiP=!0,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=!1,(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=t,this.isIntersecting=n??UE(t),this.isPiP=Pr()&&document.pictureInPictureElement===t,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=UE(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var t;(t=this.handleResize)===null||t===void 0||t.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,bE().observe(this.element),SE().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var t,n;(t=bE())===null||t===void 0||t.unobserve(this.element),(n=SE())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function UE(e){let t=e.offsetTop,n=e.offsetLeft;const r=e.offsetWidth,i=e.offsetHeight,{hidden:s}=e,{opacity:o,display:a}=getComputedStyle(e);for(;e.offsetParent;)e=e.offsetParent,t+=e.offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+i>window.pageYOffset&&n+r>window.pageXOffset&&!s&&(o!==""?parseFloat(o)>0:!0)&&a!=="none"}class to extends Zs.EventEmitter{constructor(t,n,r,i){var s;super(),this.metadataMuted=!1,this.encryption=Dn.NONE,this.log=He,this.handleMuted=()=>{this.emit(fe.Muted)},this.handleUnmuted=()=>{this.emit(fe.Unmuted)},this.log=Wo((s=i==null?void 0:i.loggerName)!==null&&s!==void 0?s:Gs.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=t,this.trackSid=n,this.trackName=r,this.source=Y.Source.Unknown}setTrack(t){this.track&&(this.track.off(fe.Muted,this.handleMuted),this.track.off(fe.Unmuted,this.handleUnmuted)),this.track=t,t&&(t.on(fe.Muted,this.handleMuted),t.on(fe.Unmuted,this.handleUnmuted))}get logContext(){var t;return Object.assign(Object.assign({},(t=this.loggerContextCb)===null||t===void 0?void 0:t.call(this)),Pt(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Dn.NONE}get audioTrack(){if(this.track instanceof br||this.track instanceof Mc)return this.track}get videoTrack(){if(this.track instanceof oi||this.track instanceof lf)return this.track}updateInfo(t){this.trackSid=t.sid,this.trackName=t.name,this.source=Y.sourceFromProto(t.source),this.mimeType=t.mimeType,this.kind===Y.Kind.Video&&t.width>0&&(this.dimensions={width:t.width,height:t.height},this.simulcasted=t.simulcast),this.encryption=t.encryption,this.trackInfo=t,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:t}))}}(function(e){(function(t){t.Desired="desired",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed"})(e.SubscriptionStatus||(e.SubscriptionStatus={})),function(t){t.Allowed="allowed",t.NotAllowed="not_allowed"}(e.PermissionStatus||(e.PermissionStatus={}))})(to||(to={}));class Zf extends to{get isUpstreamPaused(){var t;return(t=this.track)===null||t===void 0?void 0:t.isUpstreamPaused}constructor(t,n,r,i){super(t,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(fe.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(t){this.track&&this.track.off(fe.Ended,this.handleTrackEnded),super.setTrack(t),t&&t.on(fe.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var t;return F(this,void 0,void 0,function*(){return(t=this.track)===null||t===void 0?void 0:t.mute()})}unmute(){var t;return F(this,void 0,void 0,function*(){return(t=this.track)===null||t===void 0?void 0:t.unmute()})}pauseUpstream(){var t;return F(this,void 0,void 0,function*(){yield(t=this.track)===null||t===void 0?void 0:t.pauseUpstream()})}resumeUpstream(){var t;return F(this,void 0,void 0,function*(){yield(t=this.track)===null||t===void 0?void 0:t.resumeUpstream()})}}var ui;(function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Lost="lost",e.Unknown="unknown"})(ui||(ui={}));function IZ(e){switch(e){case oo.EXCELLENT:return ui.Excellent;case oo.GOOD:return ui.Good;case oo.POOR:return ui.Poor;case oo.LOST:return ui.Lost;default:return ui.Unknown}}class KO extends Zs.EventEmitter{get logContext(){var t,n;return Object.assign(Object.assign({},(n=(t=this.loggerOptions)===null||t===void 0?void 0:t.loggerContextCb)===null||n===void 0?void 0:n.call(t)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(t=>t.isEncrypted)}get isAgent(){var t,n;return(n=(t=this.permissions)===null||t===void 0?void 0:t.agent)!==null&&n!==void 0?n:!1}constructor(t,n,r,i,s){var o;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=ui.Unknown,this.log=He,this.log=Wo((o=s==null?void 0:s.loggerName)!==null&&o!==void 0?o:Gs.Participant),this.loggerOptions=s,this.setMaxListeners(100),this.sid=t,this.identity=n,this.name=r,this.metadata=i,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(t){for(const[,n]of this.tracks)if(n.source===t)return n}getTrackByName(t){for(const[,n]of this.tracks)if(n.trackName===t)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var t;const n=this.getTrack(Y.Source.Camera);return!(!((t=n==null?void 0:n.isMuted)!==null&&t!==void 0)||t)}get isMicrophoneEnabled(){var t;const n=this.getTrack(Y.Source.Microphone);return!(!((t=n==null?void 0:n.isMuted)!==null&&t!==void 0)||t)}get isScreenShareEnabled(){return!!this.getTrack(Y.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(t){return this.participantInfo&&this.participantInfo.sid===t.sid&&this.participantInfo.version>t.version?!1:(this.identity=t.identity,this.sid=t.sid,this._setName(t.name),this._setMetadata(t.metadata),t.permission&&this.setPermissions(t.permission),this.participantInfo=t,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:t})),!0)}_setMetadata(t){const n=this.metadata!==t,r=this.metadata;this.metadata=t,n&&this.emit(se.ParticipantMetadataChanged,r)}_setName(t){const n=this.name!==t;this.name=t,n&&this.emit(se.ParticipantNameChanged,t)}setPermissions(t){var n,r,i,s,o;const a=this.permissions,c=t.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||t.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||t.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||t.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||t.recorder!==((o=this.permissions)===null||o===void 0?void 0:o.recorder)||t.canPublishSources.length!==this.permissions.canPublishSources.length||t.canPublishSources.some((l,u)=>{var d;return l!==((d=this.permissions)===null||d===void 0?void 0:d.canPublishSources[u])});return this.permissions=t,c&&this.emit(se.ParticipantPermissionsChanged,a),c}setIsSpeaking(t){t!==this.isSpeaking&&(this.isSpeaking=t,t&&(this.lastSpokeAt=new Date),this.emit(se.IsSpeakingChanged,t))}setConnectionQuality(t){const n=this._connectionQuality;this._connectionQuality=IZ(t),n!==this._connectionQuality&&this.emit(se.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(t){this.audioContext=t,this.audioTracks.forEach(n=>(n.track instanceof Mc||n.track instanceof br)&&n.track.setAudioContext(t))}addTrackPublication(t){t.on(fe.Muted,()=>{this.emit(se.TrackMuted,t)}),t.on(fe.Unmuted,()=>{this.emit(se.TrackUnmuted,t)});const n=t;switch(n.track&&(n.track.sid=t.trackSid),this.tracks.set(t.trackSid,t),t.kind){case Y.Kind.Audio:this.audioTracks.set(t.trackSid,t);break;case Y.Kind.Video:this.videoTracks.set(t.trackSid,t);break}}}function SZ(e){var t,n,r;if(!e.participantSid&&!e.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new xs({participantIdentity:(t=e.participantIdentity)!==null&&t!==void 0?t:"",participantSid:(n=e.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=e.allowAll)!==null&&r!==void 0?r:!1,trackSids:e.allowedTrackSids||[]})}class ew extends to{constructor(t,n,r,i){super(t,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=vn.HIGH,this.handleEnded=s=>{this.setTrack(void 0),this.emit(fe.Ended,s)},this.handleVisibilityChange=s=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(s),this.logContext),this.disabled=!s,this.emitTrackUpdate()},this.handleVideoDimensionsChange=s=>{this.log.debug("adaptivestream video dimensions ".concat(s.width,"x").concat(s.height),this.logContext),this.videoDimensions=s,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(t){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=t,t&&(this.allowed=!0);const i=new fi({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Ss({participantSid:"",trackSids:[this.trackSid]})]});this.emit(fe.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?to.SubscriptionStatus.Unsubscribed:super.isSubscribed?to.SubscriptionStatus.Subscribed:to.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?to.PermissionStatus.Allowed:to.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(t){!this.isManualOperationAllowed()||this.disabled===!t||(this.disabled=!t,this.emitTrackUpdate())}setVideoQuality(t){!this.isManualOperationAllowed()||this.currentVideoQuality===t||(this.currentVideoQuality=t,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(t){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===t.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===t.height||(this.track instanceof lf&&(this.videoDimensions=t),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(t){this.isManualOperationAllowed()&&this.track instanceof lf&&this.fps!==t&&(this.fps=t,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(t){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==t&&(i&&(i.off(fe.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(fe.VisibilityChanged,this.handleVisibilityChange),i.off(fe.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(fe.Unsubscribed,i)),super.setTrack(t),t&&(t.sid=this.trackSid,t.on(fe.VideoDimensionsChanged,this.handleVideoDimensionsChange),t.on(fe.VisibilityChanged,this.handleVisibilityChange),t.on(fe.Ended,this.handleEnded),this.emit(fe.Subscribed,t)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(t){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=t,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(t){this.emit(fe.SubscriptionFailed,t)}updateInfo(t){super.updateInfo(t);const n=this.metadataMuted;this.metadataMuted=t.muted,this.track?this.track.setMuted(t.muted):n!==t.muted&&this.emit(t.muted?fe.Muted:fe.Unmuted)}emitSubscriptionUpdateIfChanged(t){const n=this.subscriptionStatus;t!==n&&this.emit(fe.SubscriptionStatusChanged,n,t)}emitPermissionUpdateIfChanged(t){this.permissionStatus!==t&&this.emit(fe.SubscriptionPermissionChanged,this.permissionStatus,t)}isManualOperationAllowed(){return this.kind===Y.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof lf&&this.track.isAdaptiveStream}emitTrackUpdate(){const t=new Es({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(t.width=Math.ceil(this.videoDimensions.width),t.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?t.quality=this.currentVideoQuality:t.quality=vn.HIGH,this.emit(fe.UpdateSettings,t)}}class Xf extends KO{static fromParticipantInfo(t,n){return new Xf(t,n.sid,n.identity,n.name,n.metadata)}constructor(t,n,r,i,s,o){super(n,r||"",i,s,o),this.signalClient=t,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(t){super.addTrackPublication(t),t.on(fe.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),Pt(t))),this.signalClient.sendUpdateTrackSettings(n)}),t.on(fe.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),t.on(fe.SubscriptionPermissionChanged,n=>{this.emit(se.TrackSubscriptionPermissionChanged,t,n)}),t.on(fe.SubscriptionStatusChanged,n=>{this.emit(se.TrackSubscriptionStatusChanged,t,n)}),t.on(fe.Subscribed,n=>{this.emit(se.TrackSubscribed,n,t)}),t.on(fe.Unsubscribed,n=>{this.emit(se.TrackUnsubscribed,n,t)}),t.on(fe.SubscriptionFailed,n=>{this.emit(se.TrackSubscriptionFailed,t.trackSid,n)})}getTrack(t){const n=super.getTrack(t);if(n)return n}getTrackByName(t){const n=super.getTrackByName(t);if(n)return n}setVolume(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y.Source.Microphone;this.volumeMap.set(n,t);const r=this.getTrack(n);r&&r.track&&r.track.setVolume(t)}getVolume(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y.Source.Microphone;const n=this.getTrack(t);return n&&n.track?n.track.getVolume():this.volumeMap.get(t)}addSubscribedMediaTrack(t,n,r,i,s,o){let a=this.getTrackPublication(n);if(a||n.startsWith("TR")||this.tracks.forEach(u=>{!a&&t.kind===u.kind.toString()&&(a=u)}),!a){if(o===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(se.TrackSubscriptionFailed,n);return}o===void 0&&(o=20),setTimeout(()=>{this.addSubscribedMediaTrack(t,n,r,i,s,o-1)},150);return}if(t.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Pt(a))),this.emit(se.TrackSubscriptionFailed,n);return}const c=t.kind==="video";let l;return c?l=new lf(t,n,i,s):l=new Mc(t,n,i,this.audioContext,this.audioOutput),l.source=a.source,l.isMuted=a.isMuted,l.setMediaStream(r),l.start(),a.setTrack(l),this.volumeMap.has(a.source)&&l instanceof Mc&&l.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublication(t){return this.tracks.get(t)}updateInfo(t){if(!super.updateInfo(t))return!1;const n=new Map,r=new Map;return t.tracks.forEach(i=>{var s,o;let a=this.getTrackPublication(i.sid);if(a)a.updateInfo(i);else{const c=Y.kindFromProto(i.type);if(!c)return;a=new ew(c,i,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(o=this.loggerOptions)===null||o===void 0?void 0:o.loggerName}),a.updateInfo(i),r.set(i.sid,a);const l=Array.from(this.tracks.values()).find(u=>u.source===(a==null?void 0:a.source));l&&a.source!==Y.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Pt(l),newTrack:Pt(a)})),this.addTrackPublication(a)}n.set(i.sid,a)}),this.tracks.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Pt(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(se.TrackPublished,i)}),!0}unpublishTrack(t,n){const r=this.tracks.get(t);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.tracks.delete(t),r.kind){case Y.Kind.Audio:this.audioTracks.delete(t);break;case Y.Kind.Video:this.videoTracks.delete(t);break}n&&this.emit(se.TrackUnpublished,r)}setAudioOutput(t){return F(this,void 0,void 0,function*(){this.audioOutput=t;const n=[];this.audioTracks.forEach(r=>{var i;r.track instanceof Mc&&n.push(r.track.setSinkId((i=t.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:t,args:r})),super.emit(t,...r)}}class AI extends KO{constructor(t,n,r,i){super(t,n,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Dn.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new UO)},this.handleReconnected=()=>{var s,o;(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||o===void 0||o.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var s,o;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>this.log.warn(a.message,this.logContext)),(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||o===void 0||o.call(s,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>SZ(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,o)=>{if(o===void 0&&(o=!0),!s.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Pt(s)));return}this.engine.updateMuteStatus(s.sid,o)},this.onTrackUpstreamPaused=s=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Pt(s))),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Pt(s))),this.onTrackMuted(s,s.isMuted)},this.handleSubscribedQualityUpdate=s=>F(this,void 0,void 0,function*(){var o,a,c,l,u,d;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const f=this.videoTracks.get(s.trackSid);if(!f){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}if(s.subscribedCodecs.length>0){if(!f.videoTrack)return;const y=yield f.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var h=!0,p=bl(y),m;m=yield p.next(),o=m.done,!o;h=!0){l=m.value,h=!1;const g=l;Sz(g)&&(this.log.debug("publish ".concat(g," for ").concat(f.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Pt(f))),yield this.publishAdditionalCodecForTrack(f.videoTrack,g,f.options))}}catch(g){a={error:g}}finally{try{!h&&!o&&(c=p.return)&&(yield c.call(p))}finally{if(a)throw a.error}}}else s.subscribedQualities.length>0&&(yield(d=f.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(s.subscribedQualities))}),this.handleLocalTrackUnpublished=s=>{const o=this.tracks.get(s.trackSid);if(!o){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}this.unpublishTrack(o.track)},this.handleTrackEnded=s=>F(this,void 0,void 0,function*(){if(s.source===Y.Source.ScreenShare||s.source===Y.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Pt(s))),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(s instanceof br||s instanceof oi)try{if(Pr())try{const o=yield navigator==null?void 0:navigator.permissions.query({name:s.source===Y.Source.Camera?"camera":"microphone"});if(o&&o.state==="denied")throw this.log.warn("user has revoked access to ".concat(s.source),Object.assign(Object.assign({},this.logContext),Pt(s))),o.onchange=()=>{o.state!=="denied"&&(s.isMuted||s.restartTrack(),o.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}s.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Pt(s))),yield s.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Pt(s))),yield s.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Dn.NONE}getTrack(t){const n=super.getTrack(t);if(n)return n}getTrackByName(t){const n=super.getTrackByName(t);if(n)return n}setupEngine(t){this.engine=t,this.engine.on(me.RemoteMute,(n,r)=>{const i=this.tracks.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(me.Connected,this.handleReconnected).on(me.SignalRestarted,this.handleReconnected).on(me.SignalResumed,this.handleReconnected).on(me.Restarting,this.handleReconnecting).on(me.Resuming,this.handleReconnecting).on(me.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(me.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(me.Disconnected,this.handleDisconnected)}setMetadata(t){var n;this.engine.client.sendUpdateLocalMetadata(t,(n=this.name)!==null&&n!==void 0?n:"")}setName(t){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",t)}setCameraEnabled(t,n,r){return this.setTrackEnabled(Y.Source.Camera,t,n,r)}setMicrophoneEnabled(t,n,r){return this.setTrackEnabled(Y.Source.Microphone,t,n,r)}setScreenShareEnabled(t,n,r){return this.setTrackEnabled(Y.Source.ScreenShare,t,n,r)}setPermissions(t){const n=this.permissions,r=super.setPermissions(t);return r&&n&&this.emit(se.ParticipantPermissionsChanged,n),r}setE2EEEnabled(t){return F(this,void 0,void 0,function*(){this.encryptionType=t?Dn.GCM:Dn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(t,n,r,i){var s,o;return F(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:t,enabled:n}));let a=this.getTrack(t);if(n)if(a)yield a.unmute();else{let c;if(this.pendingPublishing.has(t)){this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:t}));return}this.pendingPublishing.add(t);try{switch(t){case Y.Source.Camera:c=yield this.createTracks({video:(s=r)!==null&&s!==void 0?s:!0});break;case Y.Source.Microphone:c=yield this.createTracks({audio:(o=r)!==null&&o!==void 0?o:!0});break;case Y.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},r));break;default:throw new fs(t)}const l=[];for(const d of c)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Pt(d))),l.push(this.publishTrack(d,i));[a]=yield Promise.all(l)}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l instanceof Error&&!(l instanceof fs)&&this.emit(se.MediaDevicesError,l),l}finally{this.pendingPublishing.delete(t)}}else if(a&&a.track)if(t===Y.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const c=this.getTrack(Y.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return F(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Y.Source.Camera)||this.pendingPublishing.has(Y.Source.Microphone))){this.pendingPublishing.add(Y.Source.Camera),this.pendingPublishing.add(Y.Source.Microphone);try{const t=yield this.createTracks({audio:!0,video:!0});yield Promise.all(t.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(Y.Source.Camera),this.pendingPublishing.delete(Y.Source.Microphone)}}})}createTracks(t){var n,r;return F(this,void 0,void 0,function*(){const i=OO(t,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),s=uv(i);let o;try{o=yield navigator.mediaDevices.getUserMedia(s)}catch(a){throw a instanceof Error&&(s.audio&&(this.microphoneError=a),s.video&&(this.cameraError=a)),a}return s.audio&&(this.microphoneError=void 0,this.emit(se.AudioStreamAcquired)),s.video&&(this.cameraError=void 0),o.getTracks().map(a=>{const c=a.kind==="audio";c?t.audio:t.video;let l;const u=c?s.audio:s.video;typeof u!="boolean"&&(l=u);const d=$O(a,l,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return d.kind===Y.Kind.Video?d.source=Y.Source.Camera:d.kind===Y.Kind.Audio&&(d.source=Y.Source.Microphone),d.mediaStream=o,d})})}createScreenTracks(t){return F(this,void 0,void 0,function*(){if(t===void 0&&(t={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new zb("getDisplayMedia not supported");t.resolution===void 0&&!Dz()&&(t.resolution=Xb.h1080fps30.resolution);const n=Ez(t),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new fs("no video track found");const s=new oi(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=Y.Source.ScreenShare,t.contentHint&&(s.mediaStreamTrack.contentHint=t.contentHint);const o=[s];if(r.getAudioTracks().length>0){this.emit(se.AudioStreamAcquired);const a=new br(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=Y.Source.ScreenShareAudio,o.push(a)}return o})}publishTrack(t,n){var r,i,s,o;return F(this,void 0,void 0,function*(){yield(r=this.reconnectFuture)===null||r===void 0?void 0:r.promise,t instanceof Mu&&this.pendingPublishPromises.has(t)&&(yield this.pendingPublishPromises.get(t));let a;if(t instanceof MediaStreamTrack)a=t.getConstraints();else{a=t.constraints;let h;switch(t.source){case Y.Source.Microphone:h="audioinput";break;case Y.Source.Camera:h="videoinput"}h&&this.activeDeviceMap.has(h)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(h)}))}if(t instanceof MediaStreamTrack)switch(t.kind){case"audio":t=new br(t,a,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":t=new oi(t,a,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new fs("unsupported MediaStreamTrack kind ".concat(t.kind))}else t.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});t instanceof br&&t.setAudioContext(this.audioContext);let c;if(this.tracks.forEach(h=>{h.track&&h.track===t&&(c=h)}),c)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),Pt(c))),c;const l="channelCount"in t.mediaStreamTrack.getSettings()&&t.mediaStreamTrack.getSettings().channelCount===2||t.mediaStreamTrack.getConstraints().channelCount===2,u=(i=n==null?void 0:n.forceStereo)!==null&&i!==void 0?i:l;u&&(n||(n={}),n.dtx===void 0&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),Pt(t))),n.red===void 0&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(s=n.dtx)!==null&&s!==void 0||(n.dtx=!1),(o=n.red)!==null&&o!==void 0||(n.red=!1));const d=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);$c()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),d.simulcast=!1),d.source&&(t.source=d.source);const f=this.publish(t,d,u);this.pendingPublishPromises.set(t,f);try{return yield f}catch(h){throw h}finally{this.pendingPublishPromises.delete(t)}})}publish(t,n,r){var i,s,o,a,c,l,u,d,f,h,p,m,y;return F(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(_=>t instanceof Mu&&_.source===t.source)&&t.source!==Y.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(t.source),Object.assign(Object.assign({},this.logContext),Pt(t))),n.stopMicTrackOnMute&&t instanceof br&&(t.stopOnMute=!0),t.source===Y.Source.ScreenShare&&Pu()&&(n.simulcast=!1),n.videoCodec==="av1"&&!xz()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!Nz()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=bI);const v=n.videoCodec;t.on(fe.Muted,this.onTrackMuted),t.on(fe.Unmuted,this.onTrackUnmuted),t.on(fe.Ended,this.handleTrackEnded),t.on(fe.UpstreamPaused,this.onTrackUpstreamPaused),t.on(fe.UpstreamResumed,this.onTrackUpstreamResumed);const S=new Gi({cid:t.mediaStreamTrack.id,name:n.name,type:Y.kindToProto(t.kind),muted:t.isMuted,source:Y.sourceToProto(t.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((s=n.red)!==null&&s!==void 0)||s),stream:n==null?void 0:n.stream});let E;if(t.kind===Y.Kind.Video){let _={width:0,height:0};try{_=yield t.waitForDimensions()}catch{const N=(a=(o=this.roomOptions.videoCaptureDefaults)===null||o===void 0?void 0:o.resolution)!==null&&a!==void 0?a:zf.h720.resolution;_={width:N.width,height:N.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Pt(t)),{dims:_}))}S.width=_.width,S.height=_.height,t instanceof oi&&(af(v)&&(t.source===Y.Source.ScreenShare&&v==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(c=n.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),S.simulcastCodecs=[new Vi({codec:v,cid:t.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:bI}),n.backupCodec&&v!==n.backupCodec.codec&&S.encryption===Dn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),S.simulcastCodecs.push(new Vi({codec:n.backupCodec.codec,cid:""})))),E=kI(t.source===Y.Source.ScreenShare,S.width,S.height,n),S.layers=FE(S.width,S.height,E,af(n.videoCodec))}else t.kind===Y.Kind.Audio&&(E=[{maxBitrate:(u=(l=n.audioPreset)===null||l===void 0?void 0:l.maxBitrate)!==null&&u!==void 0?u:n.audioBitrate,priority:(f=(d=n.audioPreset)===null||d===void 0?void 0:d.priority)!==null&&f!==void 0?f:"high",networkPriority:(p=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new un("cannot publish track when not connected");const k=yield this.engine.addTrack(S);let b;if(k.codecs.forEach(_=>{b===void 0&&(b=_.mimeType)}),b&&t.kind===Y.Kind.Video){const _=DO(b);_!==v&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Pt(t)),{codec:_})),n.videoCodec=_,E=kI(t.source===Y.Source.ScreenShare,S.width,S.height,n))}const A=new Zf(t.kind,k,t,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(A.options=n,t.sid=k.sid,!this.engine.pcManager)throw new un("pcManager is not ready");if(this.log.debug("publishing ".concat(t.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:E,trackInfo:k})),t.sender=yield this.engine.createSender(t,n,E),E)if(Pu()&&t.kind===Y.Kind.Audio){let _;for(const P of this.engine.pcManager.publisher.getTransceivers())if(P.sender===t.sender){_=P;break}_&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:_,codec:"opus",maxbr:!((m=E[0])===null||m===void 0)&&m.maxBitrate?E[0].maxBitrate/1e3:0})}else t.codec&&af(t.codec)&&(!((y=E[0])===null||y===void 0)&&y.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:S.cid,codec:t.codec,maxbr:E[0].maxBitrate/1e3});return yield this.engine.negotiate(),t instanceof oi?t.startMonitor(this.engine.client):t instanceof br&&t.startMonitor(),this.addTrackPublication(A),this.emit(se.LocalTrackPublished,A),A})}get isLocal(){return!0}publishAdditionalCodecForTrack(t,n,r){var i;return F(this,void 0,void 0,function*(){if(this.encryptionType!==Dn.NONE)return;let s;if(this.tracks.forEach(d=>{d.track&&d.track===t&&(s=d)}),!s)throw new fs("track is not published");if(!(t instanceof oi))throw new fs("track is not a video track");const o=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=gZ(t,n,o);if(!a){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Pt(t)));return}const c=t.addSimulcastTrack(n,a),l=new Gi({cid:c.mediaStreamTrack.id,type:Y.kindToProto(t.kind),muted:t.isMuted,source:Y.sourceToProto(t.source),sid:t.sid,simulcastCodecs:[{codec:o.videoCodec,cid:c.mediaStreamTrack.id}]});if(l.layers=FE(l.width,l.height,a),!this.engine||this.engine.isClosed)throw new un("cannot publish track when not connected");const u=yield this.engine.addTrack(l);yield this.engine.createSimulcastSender(t,c,o,a),yield this.engine.negotiate(),this.log.debug("published ".concat(n," for track ").concat(t.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:u}))})}unpublishTrack(t,n){var r,i;return F(this,void 0,void 0,function*(){const s=this.getPublicationForTrack(t),o=s?Pt(s):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!s||!s.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));return}t=s.track,t.off(fe.Muted,this.onTrackMuted),t.off(fe.Unmuted,this.onTrackUnmuted),t.off(fe.Ended,this.handleTrackEnded),t.off(fe.UpstreamPaused,this.onTrackUpstreamPaused),t.off(fe.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n&&t.stop();let a=!1;const c=t.sender;if(t.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<fn.FAILED&&c)try{for(const l of this.engine.pcManager.publisher.getTransceivers())l.sender===c&&(l.direction="inactive",a=!0);if(this.engine.removeTrack(c)&&(a=!0),t instanceof oi){for(const[,l]of t.simulcastCodecs)l.sender&&(this.engine.removeTrack(l.sender)&&(a=!0),l.sender=void 0);t.simulcastCodecs.clear()}}catch(l){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:l}))}switch(this.tracks.delete(s.trackSid),s.kind){case Y.Kind.Audio:this.audioTracks.delete(s.trackSid);break;case Y.Kind.Video:this.videoTracks.delete(s.trackSid);break}return this.emit(se.LocalTrackUnpublished,s),s.setTrack(void 0),a&&(yield this.engine.negotiate()),s})}unpublishTracks(t){return F(this,void 0,void 0,function*(){return(yield Promise.all(t.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof Zf)})}republishAllTracks(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return F(this,void 0,void 0,function*(){const r=[];this.tracks.forEach(i=>{i.track&&(t&&(i.options=Object.assign(Object.assign({},i.options),t)),r.push(i))}),yield Promise.all(r.map(i=>F(this,void 0,void 0,function*(){const s=i.track;yield this.unpublishTrack(s,!1),n&&!s.isMuted&&s.source!==Y.Source.ScreenShare&&s.source!==Y.Source.ScreenShareAudio&&(s instanceof br||s instanceof oi)&&!s.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:i.trackSid})),yield s.restartTrack()),yield this.publishTrack(s,i.options)})))})}publishData(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return F(this,void 0,void 0,function*(){const i=Array.isArray(r)?r:r==null?void 0:r.destination,s=[],o=Array.isArray(r)?void 0:r.topic;i!==void 0&&i.forEach(c=>{c instanceof Xf?s.push(c.sid):s.push(c)});const a=new ys({kind:n,value:{case:"user",value:new Is({participantSid:this.sid,payload:t,destinationSids:s,topic:o})}});yield this.engine.sendDataPacket(a,n)})}setTrackSubscriptionPermissions(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=t,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(t){return t.sid!==this.sid||!super.updateInfo(t)?!1:(t.tracks.forEach(n=>{var r,i;const s=this.tracks.get(n.sid);if(s){const o=s.isMuted||((i=(r=s.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);o!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Pt(s)),{mutedOnServer:o})),this.engine.client.sendMuteTrack(n.sid,o))}}),!0)}getPublicationForTrack(t){let n;return this.tracks.forEach(r=>{const i=r.track;i&&(t instanceof MediaStreamTrack?(i instanceof br||i instanceof oi)&&i.mediaStreamTrack===t&&(n=r):t===i&&(n=r))}),n}}var et;(function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Reconnecting="reconnecting"})(et||(et={}));const bZ=2*1e3;class cm extends Zs.EventEmitter{constructor(t){var n,r,i;super(),n=this,this.state=et.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=He,this.bufferedEvents=[],this.connect=(s,o,a)=>F(this,void 0,void 0,function*(){var c;const l=yield this.disconnectLock.lock();if(this.state===et.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),l(),Promise.resolve();if(this.connectFuture)return l(),this.connectFuture.promise;this.setAndEmitConnectionState(et.Connecting),((c=this.regionUrlProvider)===null||c===void 0?void 0:c.getServerUrl().toString())!==s&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),SI(new URL(s))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new OE(s,o):this.regionUrlProvider.updateToken(o),this.regionUrlProvider.fetchRegionSettings().catch(f=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:f}))}));const u=(f,h,p)=>F(this,void 0,void 0,function*(){var m;this.abortController&&this.abortController.abort();const y=new AbortController;this.abortController=y,l==null||l();try{yield this.attemptConnection(p??s,o,a,y),this.abortController=void 0,f()}catch(g){if(this.regionUrlProvider&&g instanceof Et&&g.reason!==3&&g.reason!==0){let v=null;try{v=yield this.regionUrlProvider.getNextBestRegionUrl((m=this.abortController)===null||m===void 0?void 0:m.signal)}catch(S){if(S instanceof Et&&(S.status===401||S.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(S);return}}v?(this.log.info("Initial connection failed with ConnectionError: ".concat(g.message,". Retrying with another region: ").concat(v),this.logContext),yield u(f,h,v)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(g))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),h(g)}}),d=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new UO((f,h)=>{u(f,h,d)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(s,o,a,c,l,u)=>F(this,void 0,void 0,function*(){var d,f,h;const p=yield a.join(s,o,{autoSubscribe:c.autoSubscribe,publishOnly:c.publishOnly,adaptiveStream:typeof l.adaptiveStream=="object"?!0:l.adaptiveStream,maxRetries:c.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:c.websocketTimeout},u.signal);let m=p.serverInfo;if(m||(m={version:p.serverVersion,region:p.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(m).map(y=>{let[g,v]=y;return"".concat(g,": ").concat(v)}).join(", ")),{room:(d=p.room)===null||d===void 0?void 0:d.name,roomSid:(f=p.room)===null||f===void 0?void 0:f.sid,identity:(h=p.participant)===null||h===void 0?void 0:h.identity}),!p.serverVersion)throw new pz("unknown server version");return p.serverVersion==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),l.dynacast=!1),p}),this.applyJoinResponse=s=>{const o=s.participant;this.localParticipant.sid=o.sid,this.localParticipant.identity=o.identity,this.handleParticipantUpdates([o,...s.otherParticipants]),s.room&&this.handleRoomUpdate(s.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(s.sifTrailer)},this.attemptConnection=(s,o,a,c)=>F(this,void 0,void 0,function*(){var l,u;this.state===et.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((l=this.regionUrlProvider)===null||l===void 0)&&l.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},qb),a),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const d=yield this.connectSignal(s,o,this.engine,this.connOptions,this.options,c);this.applyJoinResponse(d),this.setupLocalParticipantEvents(),this.emit(re.SignalConnected)}catch(d){yield this.engine.close(),this.recreateEngine();const f=new Et("could not establish signal connection");throw d instanceof Error&&(f.message="".concat(f.message,": ").concat(d.message)),d instanceof Et&&(f.reason=d.reason,f.status=d.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:d})),f}if(c.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Et("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,c)}catch(d){throw yield this.engine.close(),this.recreateEngine(),d}Pr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Pr()&&(document.addEventListener("freeze",this.onPageLeave),(u=navigator.mediaDevices)===null||u===void 0||u.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(et.Connected),this.emit(re.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return F(n,void 0,void 0,function*(){var o,a,c,l;const u=yield this.disconnectLock.lock();try{if(this.state===et.Disconnected){this.log.debug("already disconnected",this.logContext);return}this.log.info("disconnect from room",Object.assign({},this.logContext)),(this.state===et.Connecting||this.state===et.Reconnecting)&&(this.log.warn("abort connection attempt",this.logContext),(o=this.abortController)===null||o===void 0||o.abort(),(c=(a=this.connectFuture)===null||a===void 0?void 0:a.reject)===null||c===void 0||c.call(a,new Et("Client initiated disconnect")),this.connectFuture=void 0),!((l=this.engine)===null||l===void 0)&&l.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(s,Mo.CLIENT_INITIATED),this.engine=void 0}finally{u()}})},this.onPageLeave=()=>F(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>F(this,void 0,void 0,function*(){const s=[],o=jo();if(o&&o.os==="iOS"){const a="livekit-dummy-audio-el";let c=document.getElementById(a);if(!c){c=document.createElement("audio"),c.id=a,c.autoplay=!0,c.hidden=!0;const l=Qy();l.enabled=!0;const u=new MediaStream([l]);c.srcObject=u,document.addEventListener("visibilitychange",()=>{c&&(c.srcObject=document.hidden?null:u,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(c),this.once(re.Disconnected,()=>{c==null||c.remove(),c=null})}s.push(c)}this.participants.forEach(a=>{a.audioTracks.forEach(c=>{c.track&&c.track.attachedElements.forEach(l=>{s.push(l)})})});try{yield Promise.all([this.acquireAudioContext(),...s.map(a=>(a.muted=!1,a.play()))]),this.handleAudioPlaybackStarted()}catch(a){throw this.handleAudioPlaybackFailed(a),a}}),this.startVideo=()=>F(this,void 0,void 0,function*(){const s=[];for(const o of this.participants.values())o.videoTracks.forEach(a=>{var c;(c=a.track)===null||c===void 0||c.attachedElements.forEach(l=>{s.includes(l)||s.push(l)})});yield Promise.all(s.map(o=>o.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(o=>{o.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const s of this.participants.values())this.handleParticipantDisconnected(s.sid,s);this.setAndEmitConnectionState(et.Reconnecting)&&this.emit(re.Reconnecting)},this.handleSignalRestarted=s=>F(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(s.serverRegion),Object.assign(Object.assign({},this.logContext),{region:s.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(s);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(o){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:o}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:s.serverRegion}))}catch{return}this.setAndEmitConnectionState(et.Connected),this.emit(re.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=s=>{s.forEach(o=>{if(o.identity===this.localParticipant.identity){this.localParticipant.updateInfo(o);return}const a=this.identityToSid.get(o.identity);a&&a!==o.sid&&this.handleParticipantDisconnected(a,this.participants.get(a));let c=this.participants.get(o.sid);const l=!c;o.state===jc.DISCONNECTED?this.handleParticipantDisconnected(o.sid,c):(c=this.getOrCreateParticipant(o.sid,o),l||c.updateInfo(o))})},this.handleActiveSpeakersUpdate=s=>{const o=[],a={};s.forEach(c=>{if(a[c.sid]=!0,c.sid===this.localParticipant.sid)this.localParticipant.audioLevel=c.level,this.localParticipant.setIsSpeaking(!0),o.push(this.localParticipant);else{const l=this.participants.get(c.sid);l&&(l.audioLevel=c.level,l.setIsSpeaking(!0),o.push(l))}}),a[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(c=>{a[c.sid]||(c.audioLevel=0,c.setIsSpeaking(!1))}),this.activeSpeakers=o,this.emitWhenConnected(re.ActiveSpeakersChanged,o)},this.handleSpeakersChanged=s=>{const o=new Map;this.activeSpeakers.forEach(c=>{o.set(c.sid,c)}),s.forEach(c=>{let l=this.participants.get(c.sid);c.sid===this.localParticipant.sid&&(l=this.localParticipant),l&&(l.audioLevel=c.level,l.setIsSpeaking(c.active),c.active?o.set(c.sid,l):o.delete(c.sid))});const a=Array.from(o.values());a.sort((c,l)=>l.audioLevel-c.audioLevel),this.activeSpeakers=a,this.emitWhenConnected(re.ActiveSpeakersChanged,a)},this.handleStreamStateUpdate=s=>{s.streamStates.forEach(o=>{const a=this.participants.get(o.participantSid);if(!a)return;const c=a.getTrackPublication(o.trackSid);!c||!c.track||(c.track.streamState=Y.streamStateFromProto(o.state),a.emit(se.TrackStreamStateChanged,c,c.track.streamState),this.emitWhenConnected(re.TrackStreamStateChanged,c,c.track.streamState,a))})},this.handleSubscriptionPermissionUpdate=s=>{const o=this.participants.get(s.participantSid);if(!o)return;const a=o.getTrackPublication(s.trackSid);a&&a.setAllowed(s.allowed)},this.handleSubscriptionError=s=>{const o=Array.from(this.participants.values()).find(c=>c.tracks.has(s.trackSid));if(!o)return;const a=o.getTrackPublication(s.trackSid);a&&a.setSubscriptionError(s.err)},this.handleDataPacket=(s,o)=>{const a=this.participants.get(s.participantSid);this.emit(re.DataReceived,s.payload,a,o,s.topic),a==null||a.emit(se.DataReceived,s.payload,o)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(re.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=s=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:s})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(re.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(re.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(re.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>F(this,void 0,void 0,function*(){this.emit(re.MediaDevicesChanged)}),this.handleRoomUpdate=s=>{const o=this.roomInfo;this.roomInfo=s,o&&o.metadata!==s.metadata&&this.emitWhenConnected(re.RoomMetadataChanged,s.metadata),(o==null?void 0:o.activeRecording)!==s.activeRecording&&this.emitWhenConnected(re.RecordingStatusChanged,s.activeRecording)},this.handleConnectionQualityUpdate=s=>{s.updates.forEach(o=>{if(o.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(o.quality);return}const a=this.participants.get(o.participantSid);a&&a.setConnectionQuality(o.quality)})},this.onLocalParticipantMetadataChanged=s=>{this.emit(re.ParticipantMetadataChanged,s,this.localParticipant)},this.onLocalParticipantNameChanged=s=>{this.emit(re.ParticipantNameChanged,s,this.localParticipant)},this.onLocalTrackMuted=s=>{this.emit(re.TrackMuted,s,this.localParticipant)},this.onLocalTrackUnmuted=s=>{this.emit(re.TrackUnmuted,s,this.localParticipant)},this.onLocalTrackPublished=s=>F(this,void 0,void 0,function*(){var o;this.emit(re.LocalTrackPublished,s,this.localParticipant),s.track instanceof br&&(yield s.track.checkForSilence())&&this.emit(re.LocalAudioSilenceDetected,s);const a=yield(o=s.track)===null||o===void 0?void 0:o.getDeviceId(),c=Az(s.source);c&&a&&a!==this.localParticipant.activeDeviceMap.get(c)&&(this.localParticipant.activeDeviceMap.set(c,a),this.emit(re.ActiveDeviceChanged,c,a))}),this.onLocalTrackUnpublished=s=>{this.emit(re.LocalTrackUnpublished,s,this.localParticipant)},this.onLocalConnectionQualityChanged=s=>{this.emit(re.ConnectionQualityChanged,s,this.localParticipant)},this.onMediaDevicesError=s=>{this.emit(re.MediaDevicesError,s)},this.onLocalParticipantPermissionsChanged=s=>{this.emit(re.ParticipantPermissionsChanged,s,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},iZ),t),this.log=Wo((r=this.options.loggerName)!==null&&r!==void 0?r:Gs.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},jO),t==null?void 0:t.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},HO),t==null?void 0:t.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},rZ),t==null?void 0:t.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Xi,this.localParticipant=new AI("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Pc(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Pc(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",Pc(this.options.audioOutput.deviceId)).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(t){return F(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(t)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(t,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var t;this.options.e2ee&&(this.e2eeManager=new jz(this.options.e2ee),this.e2eeManager.on(Ra.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof AI&&(this.isE2EEEnabled=n),this.emit(re.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(Ra.EncryptionError,n=>this.emit(re.EncryptionError,n)),(t=this.e2eeManager)===null||t===void 0||t.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var t,n;return(n=(t=this.roomInfo)===null||t===void 0?void 0:t.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var t,n;return(n=(t=this.roomInfo)===null||t===void 0?void 0:t.sid)!==null&&n!==void 0?n:""}get name(){var t,n;return(n=(t=this.roomInfo)===null||t===void 0?void 0:t.name)!==null&&n!==void 0?n:""}get metadata(){var t;return(t=this.roomInfo)===null||t===void 0?void 0:t.metadata}get numParticipants(){var t,n;return(n=(t=this.roomInfo)===null||t===void 0?void 0:t.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var t,n;return(n=(t=this.roomInfo)===null||t===void 0?void 0:t.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new aZ(this.options),this.engine.on(me.ParticipantUpdate,this.handleParticipantUpdates).on(me.RoomUpdate,this.handleRoomUpdate).on(me.SpeakersChanged,this.handleSpeakersChanged).on(me.StreamStateChanged,this.handleStreamStateUpdate).on(me.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(me.SubscriptionError,this.handleSubscriptionError).on(me.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(me.MediaTrackAdded,(t,n,r)=>{this.onTrackAdded(t,n,r)}).on(me.Disconnected,t=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,t)}).on(me.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(me.DataPacketReceived,this.handleDataPacket).on(me.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(et.Reconnecting)&&this.emit(re.Reconnecting)}).on(me.Resumed,()=>{this.setAndEmitConnectionState(et.Connected),this.emit(re.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()}).on(me.SignalResumed,()=>{this.bufferedEvents=[],this.state===et.Reconnecting&&this.sendSyncState()}).on(me.Restarting,this.handleRestarting).on(me.SignalRestarted,this.handleSignalRestarted).on(me.DCBufferStatusChanged,(t,n)=>{this.emit(re.DCBufferStatusChanged,t,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return cr.getInstance().getDevices(t,n)}prepareConnection(t,n){return F(this,void 0,void 0,function*(){if(this.state===et.Disconnected){this.log.debug("prepareConnection to ".concat(t),this.logContext);try{if(SI(new URL(t))&&n){this.regionUrlProvider=new OE(t,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===et.Disconnected&&(this.regionUrl=r,yield fetch(kE(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(kE(t),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(t){if(this.localParticipant.identity===t)return this.localParticipant;const n=this.identityToSid.get(t);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(t,n){return F(this,void 0,void 0,function*(){let r=()=>{},i;switch(t){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new On({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new On({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new On({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new On({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>F(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new On({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>F(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new On({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new On({scenario:{case:"switchCandidateProtocol",value:t==="force-tls"?2:1}}),r=()=>F(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new hi({reason:Mo.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new On({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var t,n;return(n=(t=this.options.audioOutput)===null||t===void 0?void 0:t.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(t){return this.localParticipant.activeDeviceMap.get(t)}switchActiveDevice(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var i,s,o;return F(this,void 0,void 0,function*(){let a=!1,c=!0;const l=r?{exact:n}:n;if(t==="audioinput"){const u=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.audioTracks.values()).filter(f=>f.source===Y.Source.Microphone);try{c=(yield Promise.all(d.map(f=>{var h;return(h=f.audioTrack)===null||h===void 0?void 0:h.setDeviceId(l)}))).every(f=>f===!0)}catch(f){throw this.options.audioCaptureDefaults.deviceId=u,f}}else if(t==="videoinput"){const u=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=l,a=u!==l;const d=Array.from(this.localParticipant.videoTracks.values()).filter(f=>f.source===Y.Source.Camera);try{c=(yield Promise.all(d.map(f=>{var h;return(h=f.videoTrack)===null||h===void 0?void 0:h.setDeviceId(l)}))).every(f=>f===!0)}catch(f){throw this.options.videoCaptureDefaults.deviceId=u,f}}else if(t==="audiooutput"){if(!II()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(i=(o=this.options).audioOutput)!==null&&i!==void 0||(o.audioOutput={});const u=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,a=u!==l;try{this.options.expWebAudioMix?(s=this.audioContext)===null||s===void 0||s.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(d=>d.setAudioOutput({deviceId:n})))}catch(d){throw this.options.audioOutput.deviceId=u,d}}return a&&c&&(this.localParticipant.activeDeviceMap.set(t,n),this.emit(re.ActiveDeviceChanged,t,n)),c})}setupLocalParticipantEvents(){this.localParticipant.on(se.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(se.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(se.TrackMuted,this.onLocalTrackMuted).on(se.TrackUnmuted,this.onLocalTrackUnmuted).on(se.LocalTrackPublished,this.onLocalTrackPublished).on(se.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(se.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(se.MediaDevicesError,this.onMediaDevicesError).on(se.AudioStreamAcquired,this.startAudio).on(se.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var t;(t=this.engine)===null||t===void 0||t.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(t,n,r){if(this.state===et.Connecting||this.state===et.Reconnecting){const u=()=>{this.onTrackAdded(t,n,r),d()},d=()=>{this.off(re.Reconnected,u),this.off(re.Connected,u),this.off(re.Disconnected,d)};this.once(re.Reconnected,u),this.once(re.Connected,u),this.once(re.Disconnected,d);return}if(this.state===et.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const i=Rz(n.id),s=i[0];let o=i[1],a=t.id;if(o&&o.startsWith("TR")&&(a=o),s===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const c=this.participants.get(s);if(!c){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s),this.logContext);return}let l;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?l=this.options.adaptiveStream:l={}),c.addSubscribedMediaTrack(t,a,n,r,l)}handleDisconnect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==et.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(i=>{i.tracks.forEach(s=>{i.unpublishTrack(s.trackSid)})}),this.localParticipant.tracks.forEach(i=>{var s,o;i.track&&this.localParticipant.unpublishTrack(i.track,t),t&&((s=i.track)===null||s===void 0||s.detach(),(o=i.track)===null||o===void 0||o.stop())}),this.localParticipant.off(se.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(se.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(se.TrackMuted,this.onLocalTrackMuted).off(se.TrackUnmuted,this.onLocalTrackUnmuted).off(se.LocalTrackPublished,this.onLocalTrackPublished).off(se.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(se.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(se.MediaDevicesError,this.onMediaDevicesError).off(se.AudioStreamAcquired,this.startAudio).off(se.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Pr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(et.Disconnected),this.emit(re.Disconnected,n)}}}handleParticipantDisconnected(t,n){this.participants.delete(t),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(re.ParticipantDisconnected,n))}acquireAudioContext(){var t,n;return F(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(t=Kb())!==null&&t!==void 0?t:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.expWebAudioMix&&this.participants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(re.AudioPlaybackStatusChanged,r))})}createParticipant(t,n){var r;let i;return n?i=Xf.fromParticipantInfo(this.engine.client,n):i=new Xf(this.engine.client,t,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),i}getOrCreateParticipant(t,n){if(this.participants.has(t))return this.participants.get(t);const r=this.createParticipant(t,n);return this.participants.set(t,r),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(re.ParticipantConnected,r),r.on(se.TrackPublished,i=>{this.emitWhenConnected(re.TrackPublished,i,r)}).on(se.TrackSubscribed,(i,s)=>{i.kind===Y.Kind.Audio?(i.on(fe.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(fe.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===Y.Kind.Video&&(i.on(fe.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(fe.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(re.TrackSubscribed,i,s,r)}).on(se.TrackUnpublished,i=>{this.emit(re.TrackUnpublished,i,r)}).on(se.TrackUnsubscribed,(i,s)=>{this.emit(re.TrackUnsubscribed,i,s,r)}).on(se.TrackSubscriptionFailed,i=>{this.emit(re.TrackSubscriptionFailed,i,r)}).on(se.TrackMuted,i=>{this.emitWhenConnected(re.TrackMuted,i,r)}).on(se.TrackUnmuted,i=>{this.emitWhenConnected(re.TrackUnmuted,i,r)}).on(se.ParticipantMetadataChanged,i=>{this.emitWhenConnected(re.ParticipantMetadataChanged,i,r)}).on(se.ParticipantNameChanged,i=>{this.emitWhenConnected(re.ParticipantNameChanged,i,r)}).on(se.ConnectionQualityChanged,i=>{this.emitWhenConnected(re.ConnectionQualityChanged,i,r)}).on(se.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(re.ParticipantPermissionsChanged,i,r)}).on(se.TrackSubscriptionStatusChanged,(i,s)=>{this.emitWhenConnected(re.TrackSubscriptionStatusChanged,i,s,r)}).on(se.TrackSubscriptionFailed,(i,s)=>{this.emit(re.TrackSubscriptionFailed,i,r,s)}).on(se.TrackSubscriptionPermissionChanged,(i,s)=>{this.emitWhenConnected(re.TrackSubscriptionPermissionChanged,i,s,r)}),n&&r.updateInfo(n),r}sendSyncState(){const t=Array.from(this.participants.values()).reduce((r,i)=>(r.push(...i.getTracks()),r),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(t,n)}updateSubscriptions(){for(const t of this.participants.values())for(const n of t.videoTracks.values())n.isSubscribed&&n instanceof ew&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let t=0;this.connectionReconcileInterval=Bn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(t++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:t,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),t>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Mo.STATE_MISMATCH))):t=0},bZ)}clearConnectionReconcile(){this.connectionReconcileInterval&&Bn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(t){return t===this.state?!1:(this.state=t,this.emit(re.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(t=>{let[n,r]=t;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.state===et.Connected?this.emit(t,...r):(this.state===et.Reconnecting&&this.bufferedEvents.push([t,r]),!1)}simulateParticipants(t){var n,r;return F(this,void 0,void 0,function*(){const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},t.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},t.participants);if(this.handleDisconnect(),this.roomInfo=new ed({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Le.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Jr({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(re.SignalConnected),this.emit(re.Connected),this.setAndEmitConnectionState(et.Connected),i.video){const o=new Zf(Y.Kind.Video,new Tr({source:en.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Yn.AUDIO,name:"video-dummy"}),new oi(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:wE(160*((n=s.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(se.LocalTrackPublished,o)}if(i.audio){const o=new Zf(Y.Kind.Audio,new Tr({source:en.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Yn.AUDIO}),new br(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Qy(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(se.LocalTrackPublished,o)}for(let o=0;o<s.count-1;o+=1){let a=new Jr({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(o),state:jc.ACTIVE,tracks:[],joinedAt:Le.parse(Date.now())});const c=this.getOrCreateParticipant(a.identity,a);if(s.video){const l=wE(160*((r=s.aspectRatios[o%s.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),u=new Tr({source:en.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Yn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}if(s.audio){const l=Qy(),u=new Tr({source:en.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Yn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l])),a.tracks=[...a.tracks,u]}c.updateInfo(a)}})}emit(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(t!==re.ActiveSpeakersChanged){const s=JO(r).filter(o=>o!==void 0);this.log.debug("room event ".concat(t),Object.assign(Object.assign({},this.logContext),{event:t,args:s}))}return super.emit(t,...r)}}function JO(e){return e.map(t=>{if(t)return Array.isArray(t)?JO(t):typeof t=="object"?"logContext"in t&&t.logContext:t})}var Li;(function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.SKIPPED=2]="SKIPPED",e[e.SUCCESS=3]="SUCCESS",e[e.FAILED=4]="FAILED"})(Li||(Li={}));class nd extends Zs.EventEmitter{constructor(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Li.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=t,this.token=n,this.name=this.constructor.name,this.room=new cm(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(t){return F(this,void 0,void 0,function*(){if(this.status!==Li.IDLE)throw Error("check is running already");this.setStatus(Li.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==Li.SKIPPED&&this.setStatus(this.isSuccess()?Li.SUCCESS:Li.FAILED),t&&t(),this.getInfo()})}isSuccess(){return!this.logs.some(t=>t.level==="error")}connect(){return F(this,void 0,void 0,function*(){return this.room.state===et.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return F(this,void 0,void 0,function*(){this.room&&this.room.state!==et.Disconnected&&(yield this.room.disconnect(),yield new Promise(t=>setTimeout(t,500)))})}skip(){this.setStatus(Li.SKIPPED)}appendMessage(t){this.logs.push({level:"info",message:t}),this.emit("update",this.getInfo())}appendWarning(t){this.logs.push({level:"warning",message:t}),this.emit("update",this.getInfo())}appendError(t){this.logs.push({level:"error",message:t}),this.emit("update",this.getInfo())}setStatus(t){this.status=t,this.emit("update",this.getInfo())}get engine(){var t;return(t=this.room)===null||t===void 0?void 0:t.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function YO(e){var t,n;return F(this,void 0,void 0,function*(){e??(e={}),(t=e.audio)!==null&&t!==void 0||(e.audio=!0),(n=e.video)!==null&&n!==void 0||(e.video=!0);const r=OO(e,jO,HO),i=uv(r),s=navigator.mediaDevices.getUserMedia(i);e.audio&&(cr.userMediaPromiseMap.set("audioinput",s),s.catch(()=>cr.userMediaPromiseMap.delete("audioinput"))),e.video&&(cr.userMediaPromiseMap.set("videoinput",s),s.catch(()=>cr.userMediaPromiseMap.delete("videoinput")));const o=yield s;return o.getTracks().map(a=>{const c=a.kind==="audio";c?e.audio:e.video;let l;const u=c?i.audio:i.video;typeof u!="boolean"&&(l=u),l?l.deviceId=a.getSettings().deviceId:l={deviceId:a.getSettings().deviceId};const d=$O(a,l);return d.kind===Y.Kind.Video?d.source=Y.Source.Camera:d.kind===Y.Kind.Audio&&(d.source=Y.Source.Microphone),d.mediaStream=o,d})})}function wZ(e){return F(this,void 0,void 0,function*(){return(yield YO({audio:!1,video:e}))[0]})}function kZ(e){return F(this,void 0,void 0,function*(){return(yield YO({audio:e,video:!1}))[0]})}class AZ extends nd{get description(){return"Can publish audio"}perform(){var t;return F(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield kZ();n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,3e3));const i=yield(t=r.sender)===null||t===void 0?void 0:t.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&o.mediaType==="audio"&&(s=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class EZ extends nd{get description(){return"Can publish video"}perform(){var t;return F(this,void 0,void 0,function*(){const n=yield this.connect(),r=yield wZ();n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,3e3));const i=yield(t=r.sender)===null||t===void 0?void 0:t.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&o.mediaType==="video"&&(s=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}}class TZ extends nd{get description(){return"Resuming connection after interruption"}perform(){var t;return F(this,void 0,void 0,function*(){const n=yield this.connect();let r=!1,i=!1,s;const o=new Promise(c=>{setTimeout(c,5e3),s=c});n.on(re.Reconnecting,()=>{r=!0}).on(re.Reconnected,()=>{i=!0,s(!0)}),(t=n.engine.client.ws)===null||t===void 0||t.close();const a=n.engine.client.onClose;if(a&&a(""),yield o,r){if(!i||n.state!==et.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class _Z extends nd{get description(){return"Can connect via TURN"}perform(){var t,n;return F(this,void 0,void 0,function*(){const r=new Yb,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let s=!1,o=!1,a=!1;for(let c of i.iceServers)for(let l of c.urls)l.startsWith("turn:")?(o=!0,a=!0):l.startsWith("turns:")&&(o=!0,a=!0,s=!0),l.startsWith("stun:")&&(a=!0);a?o&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(t=this.connectOptions)===null||t===void 0?void 0:t.rtcConfig)===null||n===void 0)&&n.iceServers||o?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(c=>setTimeout(c,0)))})}}class RZ extends nd{get description(){return"Establishing WebRTC connection"}perform(){return F(this,void 0,void 0,function*(){let t=!1,n=!1;this.room.on(re.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,s)=>{if(i.candidate){const o=new RTCIceCandidate(i);let a="".concat(o.protocol," ").concat(o.address,":").concat(o.port," ").concat(o.type);o.address&&(xZ(o.address)?a+=" (private)":o.protocol==="tcp"&&o.tcpType==="passive"?(t=!0,a+=" (passive)"):o.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,s)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),He.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}t||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function xZ(e){const t=e.split(".");if(t.length===4){if(t[0]==="10")return!0;if(t[0]==="192"&&t[1]==="168")return!0;if(t[0]==="172"){const n=parseInt(t[1],10);if(n>=16&&n<=31)return!0}}return!1}class NZ extends nd{get description(){return"Connecting to signal connection via WebSocket"}perform(){var t,n,r;return F(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new Yb;const s=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((t=s.serverInfo)===null||t===void 0?void 0:t.edition)===xu.Cloud&&(!((n=s.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=s.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class zoe extends Zs.EventEmitter{constructor(t,n){super(),this.checkResults=new Map,this.url=t,this.token=n}getNextCheckId(){const t=this.checkResults.size;return this.checkResults.set(t,{logs:[],status:Li.IDLE,name:"",description:""}),t}updateCheck(t,n){this.checkResults.set(t,n),this.emit("checkUpdate",t,n)}isSuccess(){return Array.from(this.checkResults.values()).every(t=>t.status!==Li.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(t){return F(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new t(this.url,this.token),i=o=>{this.updateCheck(n,o)};r.on("update",i);const s=yield r.run();return r.off("update",i),s})}checkWebsocket(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(NZ)})}checkWebRTC(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(RZ)})}checkTURN(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(_Z)})}checkReconnect(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(TZ)})}checkPublishAudio(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(AZ)})}checkPublishVideo(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(EZ)})}}function PZ(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=e instanceof Mu?e.mediaStreamTrack:e,i=r.getSettings();let s={facingMode:(n=t.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const o=i.facingMode;He.debug("rawFacingMode",{rawFacingMode:o}),o&&typeof o=="string"&&DZ(o)&&(s={facingMode:o,confidence:"high"})}if(["low","medium"].includes(s.confidence)){He.debug("Try to get facing mode from device label: (".concat(r.label,")"));const o=OZ(r.label);o!==void 0&&(s=o)}return s}const VE=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),MZ=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function OZ(e){var t;const n=e.trim().toLowerCase();if(n!=="")return VE.has(n)?VE.get(n):(t=Array.from(MZ.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||t===void 0?void 0:t[1]}function DZ(e){return e===void 0||["user","environment","left","right"].includes(e)}const EI=Math.min,uu=Math.max,lm=Math.round,Xa=e=>({x:e,y:e}),LZ={left:"right",right:"left",bottom:"top",top:"bottom"},BZ={start:"end",end:"start"};function GE(e,t,n){return uu(e,EI(t,n))}function fv(e,t){return typeof e=="function"?e(t):e}function Zc(e){return e.split("-")[0]}function hv(e){return e.split("-")[1]}function qO(e){return e==="x"?"y":"x"}function QO(e){return e==="y"?"height":"width"}function pv(e){return["top","bottom"].includes(Zc(e))?"y":"x"}function eD(e){return qO(pv(e))}function FZ(e,t,n){n===void 0&&(n=!1);const r=hv(e),i=eD(e),s=QO(i);let o=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(o=um(o)),[o,um(o)]}function UZ(e){const t=um(e);return[TI(e),t,TI(t)]}function TI(e){return e.replace(/start|end/g,t=>BZ[t])}function VZ(e,t,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?s:o;default:return[]}}function GZ(e,t,n,r){const i=hv(e);let s=VZ(Zc(e),n==="start",r);return i&&(s=s.map(o=>o+"-"+i),t&&(s=s.concat(s.map(TI)))),s}function um(e){return e.replace(/left|right|bottom|top/g,t=>LZ[t])}function WZ(e){return{top:0,right:0,bottom:0,left:0,...e}}function jZ(e){return typeof e!="number"?WZ(e):{top:e,right:e,bottom:e,left:e}}function dm(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function WE(e,t,n){let{reference:r,floating:i}=e;const s=pv(t),o=eD(t),a=QO(o),c=Zc(t),l=s==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[a]/2-i[a]/2;let h;switch(c){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-i.width,y:d};break;default:h={x:r.x,y:r.y}}switch(hv(t)){case"start":h[o]-=f*(n&&l?-1:1);break;case"end":h[o]+=f*(n&&l?-1:1);break}return h}const HZ=async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let l=await o.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:d}=WE(l,r,c),f=r,h={},p=0;for(let m=0;m<a.length;m++){const{name:y,fn:g}=a[m],{x:v,y:S,data:E,reset:k}=await g({x:u,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:h,rects:l,platform:o,elements:{reference:e,floating:t}});u=v??u,d=S??d,h={...h,[y]:{...h[y],...E}},k&&p<=50&&(p++,typeof k=="object"&&(k.placement&&(f=k.placement),k.rects&&(l=k.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:i}):k.rects),{x:u,y:d}=WE(l,f,c)),m=-1)}return{x:u,y:d,placement:f,strategy:i,middlewareData:h}};async function tD(e,t){var n;t===void 0&&(t={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=fv(t,e),p=jZ(h),y=a[f?d==="floating"?"reference":"floating":d],g=dm(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(y)))==null||n?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),v=d==="floating"?{...o.floating,x:r,y:i}:o.reference,S=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),E=await(s.isElement==null?void 0:s.isElement(S))?await(s.getScale==null?void 0:s.getScale(S))||{x:1,y:1}:{x:1,y:1},k=dm(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:S,strategy:c}):v);return{top:(g.top-k.top+p.top)/E.y,bottom:(k.bottom-g.bottom+p.bottom)/E.y,left:(g.left-k.left+p.left)/E.x,right:(k.right-g.right+p.right)/E.x}}const $Z=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...y}=fv(e,t);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const g=Zc(i),v=Zc(a)===a,S=await(c.isRTL==null?void 0:c.isRTL(l.floating)),E=f||(v||!m?[um(a)]:UZ(a));!f&&p!=="none"&&E.push(...GZ(a,m,p,S));const k=[a,...E],b=await tD(t,y),A=[];let _=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&A.push(b[g]),d){const D=FZ(i,o,S);A.push(b[D[0]],b[D[1]])}if(_=[..._,{placement:i,overflows:A}],!A.every(D=>D<=0)){var P,N;const D=(((P=s.flip)==null?void 0:P.index)||0)+1,U=k[D];if(U)return{data:{index:D,overflows:_},reset:{placement:U}};let G=(N=_.filter(z=>z.overflows[0]<=0).sort((z,$)=>z.overflows[1]-$.overflows[1])[0])==null?void 0:N.placement;if(!G)switch(h){case"bestFit":{var O;const z=(O=_.map($=>[$.placement,$.overflows.filter(q=>q>0).reduce((q,W)=>q+W,0)]).sort(($,q)=>$[1]-q[1])[0])==null?void 0:O[0];z&&(G=z);break}case"initialPlacement":G=a;break}if(i!==G)return{reset:{placement:G}}}return{}}}};async function zZ(e,t){const{placement:n,platform:r,elements:i}=e,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=Zc(n),a=hv(n),c=pv(n)==="y",l=["left","top"].includes(o)?-1:1,u=s&&c?-1:1,d=fv(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),c?{x:h*u,y:f*l}:{x:f*l,y:h*u}}const ZZ=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:i,y:s,placement:o,middlewareData:a}=t,c=await zZ(t,e);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+c.x,y:s+c.y,data:{...c,placement:o}}}}},XZ=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:y=>{let{x:g,y:v}=y;return{x:g,y:v}}},...c}=fv(e,t),l={x:n,y:r},u=await tD(t,c),d=pv(Zc(i)),f=qO(d);let h=l[f],p=l[d];if(s){const y=f==="y"?"top":"left",g=f==="y"?"bottom":"right",v=h+u[y],S=h-u[g];h=GE(v,h,S)}if(o){const y=d==="y"?"top":"left",g=d==="y"?"bottom":"right",v=p+u[y],S=p-u[g];p=GE(v,p,S)}const m=a.fn({...t,[f]:h,[d]:p});return{...m,data:{x:m.x-n,y:m.y-r}}}}};function Ka(e){return nD(e)?(e.nodeName||"").toLowerCase():"#document"}function qr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function sc(e){var t;return(t=(nD(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function nD(e){return e instanceof Node||e instanceof qr(e).Node}function Ho(e){return e instanceof Element||e instanceof qr(e).Element}function Ws(e){return e instanceof HTMLElement||e instanceof qr(e).HTMLElement}function jE(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof qr(e).ShadowRoot}function kh(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=yi(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function KZ(e){return["table","td","th"].includes(Ka(e))}function tw(e){const t=nw(),n=yi(e);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function rD(e){let t=Ou(e);for(;Ws(t)&&!gv(t);){if(tw(t))return t;t=Ou(t)}return null}function nw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function gv(e){return["html","body","#document"].includes(Ka(e))}function yi(e){return qr(e).getComputedStyle(e)}function mv(e){return Ho(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Ou(e){if(Ka(e)==="html")return e;const t=e.assignedSlot||e.parentNode||jE(e)&&e.host||sc(e);return jE(t)?t.host:t}function iD(e){const t=Ou(e);return gv(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ws(t)&&kh(t)?t:iD(t)}function _I(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const i=iD(e),s=i===((r=e.ownerDocument)==null?void 0:r.body),o=qr(i);return s?t.concat(o,o.visualViewport||[],kh(i)?i:[],o.frameElement&&n?_I(o.frameElement):[]):t.concat(i,_I(i,[],n))}function sD(e){const t=yi(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=Ws(e),s=i?e.offsetWidth:n,o=i?e.offsetHeight:r,a=lm(n)!==s||lm(r)!==o;return a&&(n=s,r=o),{width:n,height:r,$:a}}function oD(e){return Ho(e)?e:e.contextElement}function du(e){const t=oD(e);if(!Ws(t))return Xa(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:s}=sD(t);let o=(s?lm(n.width):n.width)/r,a=(s?lm(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const JZ=Xa(0);function aD(e){const t=qr(e);return!nw()||!t.visualViewport?JZ:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function YZ(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==qr(e)?!1:t}function Kf(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),s=oD(e);let o=Xa(1);t&&(r?Ho(r)&&(o=du(r)):o=du(e));const a=YZ(s,n,r)?aD(s):Xa(0);let c=(i.left+a.x)/o.x,l=(i.top+a.y)/o.y,u=i.width/o.x,d=i.height/o.y;if(s){const f=qr(s),h=r&&Ho(r)?qr(r):r;let p=f.frameElement;for(;p&&r&&h!==f;){const m=du(p),y=p.getBoundingClientRect(),g=yi(p),v=y.left+(p.clientLeft+parseFloat(g.paddingLeft))*m.x,S=y.top+(p.clientTop+parseFloat(g.paddingTop))*m.y;c*=m.x,l*=m.y,u*=m.x,d*=m.y,c+=v,l+=S,p=qr(p).frameElement}}return dm({width:u,height:d,x:c,y:l})}const qZ=[":popover-open",":modal"];function cD(e){let t=!1,n=0,r=0;function i(s){try{t=t||e.matches(s)}catch{}}if(qZ.forEach(s=>{i(s)}),t){const s=rD(e);if(s){const o=s.getBoundingClientRect();n=o.x,r=o.y}}return[t,n,r]}function QZ(e){let{elements:t,rect:n,offsetParent:r,strategy:i}=e;const s=sc(r),[o]=t?cD(t.floating):[!1];if(r===s||o)return n;let a={scrollLeft:0,scrollTop:0},c=Xa(1);const l=Xa(0),u=Ws(r);if((u||!u&&i!=="fixed")&&((Ka(r)!=="body"||kh(s))&&(a=mv(r)),Ws(r))){const d=Kf(r);c=du(r),l.x=d.x+r.clientLeft,l.y=d.y+r.clientTop}return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-a.scrollLeft*c.x+l.x,y:n.y*c.y-a.scrollTop*c.y+l.y}}function e7(e){return Array.from(e.getClientRects())}function lD(e){return Kf(sc(e)).left+mv(e).scrollLeft}function t7(e){const t=sc(e),n=mv(e),r=e.ownerDocument.body,i=uu(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=uu(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+lD(e);const a=-n.scrollTop;return yi(r).direction==="rtl"&&(o+=uu(t.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:a}}function n7(e,t){const n=qr(e),r=sc(e),i=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,c=0;if(i){s=i.width,o=i.height;const l=nw();(!l||l&&t==="fixed")&&(a=i.offsetLeft,c=i.offsetTop)}return{width:s,height:o,x:a,y:c}}function r7(e,t){const n=Kf(e,!0,t==="fixed"),r=n.top+e.clientTop,i=n.left+e.clientLeft,s=Ws(e)?du(e):Xa(1),o=e.clientWidth*s.x,a=e.clientHeight*s.y,c=i*s.x,l=r*s.y;return{width:o,height:a,x:c,y:l}}function HE(e,t,n){let r;if(t==="viewport")r=n7(e,n);else if(t==="document")r=t7(sc(e));else if(Ho(t))r=r7(t,n);else{const i=aD(e);r={...t,x:t.x-i.x,y:t.y-i.y}}return dm(r)}function uD(e,t){const n=Ou(e);return n===t||!Ho(n)||gv(n)?!1:yi(n).position==="fixed"||uD(n,t)}function i7(e,t){const n=t.get(e);if(n)return n;let r=_I(e,[],!1).filter(a=>Ho(a)&&Ka(a)!=="body"),i=null;const s=yi(e).position==="fixed";let o=s?Ou(e):e;for(;Ho(o)&&!gv(o);){const a=yi(o),c=tw(o);!c&&a.position==="fixed"&&(i=null),(s?!c&&!i:!c&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||kh(o)&&!c&&uD(e,o))?r=r.filter(u=>u!==o):i=a,o=Ou(o)}return t.set(e,r),r}function s7(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const o=[...n==="clippingAncestors"?i7(t,this._c):[].concat(n),r],a=o[0],c=o.reduce((l,u)=>{const d=HE(t,u,i);return l.top=uu(d.top,l.top),l.right=EI(d.right,l.right),l.bottom=EI(d.bottom,l.bottom),l.left=uu(d.left,l.left),l},HE(t,a,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function o7(e){const{width:t,height:n}=sD(e);return{width:t,height:n}}function a7(e,t,n,r){const i=Ws(t),s=sc(t),o=n==="fixed",a=Kf(e,!0,o,t);let c={scrollLeft:0,scrollTop:0};const l=Xa(0);if(i||!i&&!o)if((Ka(t)!=="body"||kh(s))&&(c=mv(t)),i){const m=Kf(t,!0,o,t);l.x=m.x+t.clientLeft,l.y=m.y+t.clientTop}else s&&(l.x=lD(s));let u=a.left+c.scrollLeft-l.x,d=a.top+c.scrollTop-l.y;const[f,h,p]=cD(r);return f&&(u+=h,d+=p,i&&(u+=t.clientLeft,d+=t.clientTop)),{x:u,y:d,width:a.width,height:a.height}}function $E(e,t){return!Ws(e)||yi(e).position==="fixed"?null:t?t(e):e.offsetParent}function dD(e,t){const n=qr(e);if(!Ws(e))return n;let r=$E(e,t);for(;r&&KZ(r)&&yi(r).position==="static";)r=$E(r,t);return r&&(Ka(r)==="html"||Ka(r)==="body"&&yi(r).position==="static"&&!tw(r))?n:r||rD(e)||n}const c7=async function(e){const t=this.getOffsetParent||dD,n=this.getDimensions;return{reference:a7(e.reference,await t(e.floating),e.strategy,e.floating),floating:{x:0,y:0,...await n(e.floating)}}};function l7(e){return yi(e).direction==="rtl"}const u7={convertOffsetParentRelativeRectToViewportRelativeRect:QZ,getDocumentElement:sc,getClippingRect:s7,getOffsetParent:dD,getElementRects:c7,getClientRects:e7,getDimensions:o7,getScale:du,isElement:Ho,isRTL:l7},d7=XZ,f7=$Z,h7=(e,t,n)=>{const r=new Map,i={platform:u7,...n},s={...i.platform,_c:r};return HZ(e,t,{...i,platform:s})};var fD={exports:{}};(function(e){(function(t,n){e.exports?e.exports=n():t.log=n()})(RB,function(){var t=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],s={},o=null;function a(m,y){var g=m[y];if(typeof g.bind=="function")return g.bind(m);try{return Function.prototype.bind.call(g,m)}catch{return function(){return Function.prototype.apply.apply(g,[m,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?c:console[m]!==void 0?a(console,m):console.log!==void 0?a(console,"log"):t}function u(){for(var m=this.getLevel(),y=0;y<i.length;y++){var g=i[y];this[g]=y<m?t:this.methodFactory(g,m,this.name)}if(this.log=this.debug,typeof console===n&&m<this.levels.SILENT)return"No console available for logging"}function d(m){return function(){typeof console!==n&&(u.call(this),this[m].apply(this,arguments))}}function f(m,y,g){return l(m)||d.apply(this,arguments)}function h(m,y){var g=this,v,S,E,k="loglevel";typeof m=="string"?k+=":"+m:typeof m=="symbol"&&(k=void 0);function b(O){var D=(i[O]||"silent").toUpperCase();if(!(typeof window===n||!k)){try{window.localStorage[k]=D;return}catch{}try{window.document.cookie=encodeURIComponent(k)+"="+D+";"}catch{}}}function A(){var O;if(!(typeof window===n||!k)){try{O=window.localStorage[k]}catch{}if(typeof O===n)try{var D=window.document.cookie,U=encodeURIComponent(k),G=D.indexOf(U+"=");G!==-1&&(O=/^([^;]+)/.exec(D.slice(G+U.length+1))[1])}catch{}return g.levels[O]===void 0&&(O=void 0),O}}function _(){if(!(typeof window===n||!k)){try{window.localStorage.removeItem(k)}catch{}try{window.document.cookie=encodeURIComponent(k)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function P(O){var D=O;if(typeof D=="string"&&g.levels[D.toUpperCase()]!==void 0&&(D=g.levels[D.toUpperCase()]),typeof D=="number"&&D>=0&&D<=g.levels.SILENT)return D;throw new TypeError("log.setLevel() called with invalid level: "+O)}g.name=m,g.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},g.methodFactory=y||f,g.getLevel=function(){return E??S??v},g.setLevel=function(O,D){return E=P(O),D!==!1&&b(E),u.call(g)},g.setDefaultLevel=function(O){S=P(O),A()||g.setLevel(O,!1)},g.resetLevel=function(){E=null,_(),u.call(g)},g.enableAll=function(O){g.setLevel(g.levels.TRACE,O)},g.disableAll=function(O){g.setLevel(g.levels.SILENT,O)},g.rebuild=function(){if(o!==g&&(v=P(o.getLevel())),u.call(g),o===g)for(var O in s)s[O].rebuild()},v=P(o?o.getLevel():"WARN");var N=A();N!=null&&(E=P(N)),u.call(g)}o=new h,o.getLogger=function(y){if(typeof y!="symbol"&&typeof y!="string"||y==="")throw new TypeError("You must supply a name when creating a logger.");var g=s[y];return g||(g=s[y]=new h(y,o.methodFactory)),g};var p=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=p),o},o.getLoggers=function(){return s},o.default=o,o})})(fD);var p7=fD.exports;const g7=ch(p7);function yn(e){return typeof e=="function"}function hD(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var i0=hD(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function RI(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var vv=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,i,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Ru(o),c=a.next();!c.done;c=a.next()){var l=c.value;l.remove(this)}}catch(m){t={error:m}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}else o.remove(this);var u=this.initialTeardown;if(yn(u))try{u()}catch(m){s=m instanceof i0?m.errors:[m]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=Ru(d),h=f.next();!h.done;h=f.next()){var p=h.value;try{zE(p)}catch(m){s=s??[],m instanceof i0?s=qC(qC([],YC(s)),YC(m.errors)):s.push(m)}}}catch(m){r={error:m}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(s)throw new i0(s)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)zE(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&RI(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&RI(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),pD=vv.EMPTY;function gD(e){return e instanceof vv||e&&"closed"in e&&yn(e.remove)&&yn(e.add)&&yn(e.unsubscribe)}function zE(e){yn(e)?e():e.unsubscribe()}var mD={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},vD={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,qC([e,t],YC(n)))},clearTimeout:function(e){var t=vD.delegate;return((t==null?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function yD(e){vD.setTimeout(function(){throw e})}function xI(){}function sg(e){e()}var rw=function(e){Qu(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,gD(n)&&n.add(r)):r.destination=C7,r}return t.create=function(n,r,i){return new NI(n,r,i)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(vv),m7=Function.prototype.bind;function s0(e,t){return m7.call(e,t)}var v7=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){cp(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){cp(r)}else cp(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){cp(n)}},e}(),NI=function(e){Qu(t,e);function t(n,r,i){var s=e.call(this)||this,o;if(yn(n)||!n)o={next:n??void 0,error:r??void 0,complete:i??void 0};else{var a;s&&mD.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return s.unsubscribe()},o={next:n.next&&s0(n.next,a),error:n.error&&s0(n.error,a),complete:n.complete&&s0(n.complete,a)}):o=n}return s.destination=new v7(o),s}return t}(rw);function cp(e){yD(e)}function y7(e){throw e}var C7={closed:!0,next:xI,error:y7,complete:xI},iw=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function CD(e){return e}function I7(e){return e.length===0?CD:e.length===1?e[0]:function(n){return e.reduce(function(r,i){return i(r)},n)}}var jn=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var i=this,s=b7(t)?t:new NI(t,n,r);return sg(function(){var o=i,a=o.operator,c=o.source;s.add(a?a.call(s,c):c?i._subscribe(s):i._trySubscribe(s))}),s},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=ZE(n),new n(function(i,s){var o=new NI({next:function(a){try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});r.subscribe(o)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[iw]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return I7(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=ZE(t),new t(function(r,i){var s;n.subscribe(function(o){return s=o},function(o){return i(o)},function(){return r(s)})})},e.create=function(t){return new e(t)},e}();function ZE(e){var t;return(t=e??mD.Promise)!==null&&t!==void 0?t:Promise}function S7(e){return e&&yn(e.next)&&yn(e.error)&&yn(e.complete)}function b7(e){return e&&e instanceof rw||S7(e)&&gD(e)}function w7(e){return yn(e==null?void 0:e.lift)}function Yo(e){return function(t){if(w7(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Xc(e,t,n,r,i){return new k7(e,t,n,r,i)}var k7=function(e){Qu(t,e);function t(n,r,i,s,o,a){var c=e.call(this,n)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=r?function(l){try{r(l)}catch(u){n.error(u)}}:e.prototype._next,c._error=s?function(l){try{s(l)}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=i?function(){try{i()}catch(l){n.error(l)}finally{this.unsubscribe()}}:e.prototype._complete,c}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(rw),A7=hD(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Ja=function(e){Qu(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new XE(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new A7},t.prototype.next=function(n){var r=this;sg(function(){var i,s;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var o=Ru(r.currentObservers),a=o.next();!a.done;a=o.next()){var c=a.value;c.next(n)}}catch(l){i={error:l}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}}})},t.prototype.error=function(n){var r=this;sg(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},t.prototype.complete=function(){var n=this;sg(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,i=this,s=i.hasError,o=i.isStopped,a=i.observers;return s||o?pD:(this.currentObservers=null,a.push(n),new vv(function(){r.currentObservers=null,RI(a,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,s=r.thrownError,o=r.isStopped;i?n.error(s):o&&n.complete()},t.prototype.asObservable=function(){var n=new jn;return n.source=this,n},t.create=function(n,r){return new XE(n,r)},t}(jn),XE=function(e){Qu(t,e);function t(n,r){var i=e.call(this)||this;return i.destination=n,i.source=r,i}return t.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},t.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:pD},t}(Ja),ID=function(e){Qu(t,e);function t(n){var r=e.call(this)||this;return r._value=n,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(n){var r=e.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},t.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,s=n._value;if(r)throw i;return this._throwIfClosed(),s},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t}(Ja);function E7(e){return e&&yn(e.schedule)}function T7(e){return e[e.length-1]}function SD(e){return E7(T7(e))?e.pop():void 0}var bD=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function wD(e){return yn(e==null?void 0:e.then)}function kD(e){return yn(e[iw])}function AD(e){return Symbol.asyncIterator&&yn(e==null?void 0:e[Symbol.asyncIterator])}function ED(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function _7(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var TD=_7();function _D(e){return yn(e==null?void 0:e[TD])}function RD(e){return WH(this,arguments,function(){var n,r,i,s;return rM(this,function(o){switch(o.label){case 0:n=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,nu(n.read())];case 3:return r=o.sent(),i=r.value,s=r.done,s?[4,nu(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,nu(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function xD(e){return yn(e==null?void 0:e.getReader)}function rd(e){if(e instanceof jn)return e;if(e!=null){if(kD(e))return R7(e);if(bD(e))return x7(e);if(wD(e))return N7(e);if(AD(e))return ND(e);if(_D(e))return P7(e);if(xD(e))return M7(e)}throw ED(e)}function R7(e){return new jn(function(t){var n=e[iw]();if(yn(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function x7(e){return new jn(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function N7(e){return new jn(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,yD)})}function P7(e){return new jn(function(t){var n,r;try{for(var i=Ru(e),s=i.next();!s.done;s=i.next()){var o=s.value;if(t.next(o),t.closed)return}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()})}function ND(e){return new jn(function(t){O7(e,t).catch(function(n){return t.error(n)})})}function M7(e){return ND(RD(e))}function O7(e,t){var n,r,i,s;return GH(this,void 0,void 0,function(){var o,a;return rM(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=jH(e),c.label=1;case 1:return[4,n.next()];case 2:if(r=c.sent(),!!r.done)return[3,4];if(o=r.value,t.next(o),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Wa(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(s),!i)return s}function PD(e,t){return t===void 0&&(t=0),Yo(function(n,r){n.subscribe(Xc(r,function(i){return Wa(r,e,function(){return r.next(i)},t)},function(){return Wa(r,e,function(){return r.complete()},t)},function(i){return Wa(r,e,function(){return r.error(i)},t)}))})}function MD(e,t){return t===void 0&&(t=0),Yo(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function D7(e,t){return rd(e).pipe(MD(t),PD(t))}function L7(e,t){return rd(e).pipe(MD(t),PD(t))}function B7(e,t){return new jn(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function F7(e,t){return new jn(function(n){var r;return Wa(n,t,function(){r=e[TD](),Wa(n,t,function(){var i,s,o;try{i=r.next(),s=i.value,o=i.done}catch(a){n.error(a);return}o?n.complete():n.next(s)},0,!0)}),function(){return yn(r==null?void 0:r.return)&&r.return()}})}function OD(e,t){if(!e)throw new Error("Iterable cannot be null");return new jn(function(n){Wa(n,t,function(){var r=e[Symbol.asyncIterator]();Wa(n,t,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function U7(e,t){return OD(RD(e),t)}function V7(e,t){if(e!=null){if(kD(e))return D7(e,t);if(bD(e))return B7(e,t);if(wD(e))return L7(e,t);if(AD(e))return OD(e,t);if(_D(e))return F7(e,t);if(xD(e))return U7(e,t)}throw ED(e)}function G7(e,t){return t?V7(e,t):rd(e)}function Cr(e,t){return Yo(function(n,r){var i=0;n.subscribe(Xc(r,function(s){r.next(e.call(t,s,i++))}))})}function W7(e,t,n,r,i,s,o,a){var c=[],l=0,u=0,d=!1,f=function(){d&&!c.length&&!l&&t.complete()},h=function(m){return l<r?p(m):c.push(m)},p=function(m){s&&t.next(m),l++;var y=!1;rd(n(m,u++)).subscribe(Xc(t,function(g){i==null||i(g),s?h(g):t.next(g)},function(){y=!0},void 0,function(){if(y)try{l--;for(var g=function(){var v=c.shift();o?Wa(t,o,function(){return p(v)}):p(v)};c.length&&l<r;)g();f()}catch(v){t.error(v)}}))};return e.subscribe(Xc(t,h,function(){d=!0,f()})),function(){a==null||a()}}function DD(e,t,n){return n===void 0&&(n=1/0),yn(t)?DD(function(r,i){return Cr(function(s,o){return t(r,s,i,o)})(rd(e(r,i)))},n):(typeof t=="number"&&(n=t),Yo(function(r,i){return W7(r,i,e,n)}))}function j7(e){return e===void 0&&(e=1/0),DD(CD,e)}function H7(){return j7(1)}function PI(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return H7()(G7(e,SD(e)))}function LD(e,t){return Yo(function(n,r){var i=0;n.subscribe(Xc(r,function(s){return e.call(t,s,i++)&&r.next(s)}))})}function $7(e,t,n,r,i){return function(s,o){var a=n,c=t,l=0;s.subscribe(Xc(o,function(u){var d=l++;c=a?e(c,u,d):(a=!0,u),r&&o.next(c)},i&&function(){a&&o.next(c),o.complete()}))}}function z7(e){return Yo(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}function Z7(e,t){return Yo($7(e,t,arguments.length>=2,!0))}function ts(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=SD(e);return Yo(function(r,i){(n?PI(e,r,n):PI(e,r)).subscribe(i)})}function KE(e){return Yo(function(t,n){rd(e).subscribe(Xc(n,function(){return n.complete()},xI)),!n.closed&&t.subscribe(n)})}var X7=Object.defineProperty,K7=Object.defineProperties,J7=Object.getOwnPropertyDescriptors,fm=Object.getOwnPropertySymbols,BD=Object.prototype.hasOwnProperty,FD=Object.prototype.propertyIsEnumerable,JE=(e,t,n)=>t in e?X7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,MI=(e,t)=>{for(var n in t||(t={}))BD.call(t,n)&&JE(e,n,t[n]);if(fm)for(var n of fm(t))FD.call(t,n)&&JE(e,n,t[n]);return e},Y7=(e,t)=>K7(e,J7(t)),q7=(e,t)=>{var n={};for(var r in e)BD.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&fm)for(var r of fm(e))t.indexOf(r)<0&&FD.call(e,r)&&(n[r]=e[r]);return n},qo=(e,t,n)=>new Promise((r,i)=>{var s=c=>{try{a(n.next(c))}catch(l){i(l)}},o=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((n=n.apply(e,t)).next())}),UD="lk";function sw(e){return typeof e>"u"?!1:Q7(e)||eX(e)}function Q7(e){var t;return e?e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("track")&&typeof((t=e.publication)==null?void 0:t.track)<"u":!1}function eX(e){return e?e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("publication")&&typeof e.publication<"u":!1}function tX(e){return e?e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&typeof e.publication>"u":!1}function VD(e){if(typeof e=="string"||typeof e=="number")return`${e}`;if(tX(e))return`${e.participant.identity}_${e.source}_placeholder`;if(sw(e))return`${e.participant.identity}_${e.publication.source}_${e.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${e}`)}function nX(e){return e instanceof AI}function rX(e,t){return qo(this,null,function*(){const{x:n,y:r}=yield h7(e,t,{placement:"top",middleware:[ZZ(6),f7(),d7({padding:5})]});return{x:n,y:r}})}function iX(e,t){return!e.contains(t.target)}var sX=[re.ConnectionStateChanged,re.RoomMetadataChanged,re.ActiveSpeakersChanged,re.ConnectionQualityChanged,re.ParticipantConnected,re.ParticipantDisconnected,re.ParticipantPermissionsChanged,re.ParticipantMetadataChanged,re.TrackMuted,re.TrackUnmuted,re.TrackPublished,re.TrackUnpublished,re.TrackStreamStateChanged,re.TrackSubscriptionFailed,re.TrackSubscriptionPermissionChanged,re.TrackSubscriptionStatusChanged],oX=[...sX,re.LocalTrackPublished,re.LocalTrackUnpublished],aX=[se.ConnectionQualityChanged,se.IsSpeakingChanged,se.ParticipantMetadataChanged,se.ParticipantPermissionsChanged,se.TrackMuted,se.TrackUnmuted,se.TrackPublished,se.TrackUnpublished,se.TrackStreamStateChanged,se.TrackSubscriptionFailed,se.TrackSubscriptionPermissionChanged,se.TrackSubscriptionStatusChanged];[...aX,se.LocalTrackPublished,se.LocalTrackUnpublished];var st=g7.getLogger("lk-components-js");st.setDefaultLevel("WARN");function cX(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var lX=[],uX={showChat:!1,unreadMessages:0};function ow(e,...t){return new jn(r=>{const i=()=>{r.next(e)};return t.forEach(o=>{e.on(o,i)}),()=>{t.forEach(o=>{e.off(o,i)})}}).pipe(ts(e))}function aw(e,t){return new jn(r=>{const i=(...o)=>{r.next(o)};return e.on(t,i),()=>{e.off(t,i)}})}function dX(e){return aw(e,re.ConnectionStateChanged).pipe(Cr(([t])=>t),ts(e.state))}function fX(e,t,n=!0){var r;const i=()=>qo(this,null,function*(){try{const a=yield cm.getLocalDevices(e,n);s.next(a)}catch(a){t==null||t(a)}}),s=new Ja,o=s.pipe(z7(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return PI(cm.getLocalDevices(e,n).catch(a=>t==null?void 0:t(a)),o)}function hX(e){return aw(e,re.DataReceived)}function pX(e){return ow(e,re.AudioPlaybackStatusChanged).pipe(Cr(n=>({canPlayAudio:n.canPlaybackAudio})))}function gX(e){return ow(e,re.VideoPlaybackStatusChanged).pipe(Cr(n=>({canPlayVideo:n.canPlaybackVideo})))}function mX(e,t){return aw(e,re.ActiveDeviceChanged).pipe(LD(([n])=>n===t),Cr(([n,r])=>(st.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)),ts(e.getActiveDevice(t)))}function Ci(e){return`${UD}-${e}`}function vX(e){const t=OI(e),n=lw(e.participant).pipe(Cr(()=>OI(e)),ts(t));return{className:Ci(e.source===Y.Source.Camera||e.source===Y.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function OI(e){if(sw(e))return e.publication;{const{source:t,name:n,participant:r}=e;if(t&&n)return r.getTracks().find(i=>i.source===t&&i.trackName===n);if(n)return r.getTrackByName(n);if(t)return r.getTrack(t);throw new Error("At least one of source and name needs to be defined")}}function cw(e,...t){return new jn(r=>{const i=()=>{r.next(e)};return t.forEach(o=>{e.on(o,i)}),()=>{t.forEach(o=>{e.off(o,i)})}}).pipe(ts(e))}function lw(e){return cw(e,se.TrackMuted,se.TrackUnmuted,se.ParticipantPermissionsChanged,se.TrackPublished,se.TrackUnpublished,se.LocalTrackPublished,se.LocalTrackUnpublished,se.MediaDevicesError,se.TrackSubscriptionStatusChanged).pipe(Cr(n=>{const{isMicrophoneEnabled:r,isCameraEnabled:i,isScreenShareEnabled:s}=n,o=n.getTrack(Y.Source.Microphone),a=n.getTrack(Y.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:r,isScreenShareEnabled:s,cameraTrack:a,microphoneTrack:o,participant:n}}))}function yX(e){return cw(e,se.ParticipantMetadataChanged).pipe(Cr(({name:n,identity:r,metadata:i})=>({name:n,identity:r,metadata:i})),ts({name:e.name,identity:e.identity,metadata:e.metadata}))}function CX(e){return uw(e,se.ConnectionQualityChanged).pipe(Cr(([n])=>n),ts(e.connectionQuality))}function uw(e,t){return new jn(r=>{const i=(...o)=>{r.next(o)};return e.on(t,i),()=>{e.off(t,i)}})}function GD(e){var t,n,r,i;return cw(e.participant,se.TrackMuted,se.TrackUnmuted,se.TrackSubscribed,se.TrackUnsubscribed,se.LocalTrackPublished,se.LocalTrackUnpublished).pipe(Cr(s=>{var o,a;const c=(o=e.publication)!=null?o:s.getTrack(e.source);return(a=c==null?void 0:c.isMuted)!=null?a:!0}),ts((i=(r=(t=e.publication)==null?void 0:t.isMuted)!=null?r:(n=e.participant.getTrack(e.source))==null?void 0:n.isMuted)!=null?i:!0))}function IX(e){return uw(e,se.IsSpeakingChanged).pipe(Cr(([t])=>t))}function SX(e,t={}){var n;let r;const i=new jn(c=>(r=c,()=>a.unsubscribe())).pipe(ts(Array.from(e.participants.values()))),s=(n=t.additionalRoomEvents)!=null?n:oX,o=Array.from(new Set([re.ParticipantConnected,re.ParticipantDisconnected,re.ConnectionStateChanged,...s])),a=ow(e,...o).subscribe(c=>r==null?void 0:r.next(Array.from(c.participants.values())));return e.participants.size>0&&(r==null||r.next(Array.from(e.participants.values()))),i}function bX(e){return uw(e,se.ParticipantPermissionsChanged).pipe(Cr(()=>e.permissions),ts(e.permissions))}function wX(e,t,n){const{localParticipant:r}=t,i=(l,u)=>{let d=!1;switch(l){case Y.Source.Camera:d=u.isCameraEnabled;break;case Y.Source.Microphone:d=u.isMicrophoneEnabled;break;case Y.Source.ScreenShare:d=u.isScreenShareEnabled;break}return d},s=lw(r).pipe(Cr(l=>i(e,l.participant)),ts(i(e,r))),o=new Ja,a=(l,u)=>qo(this,null,function*(){try{switch(u??(u=n),o.next(!0),e){case Y.Source.Camera:yield r.setCameraEnabled(l??!r.isCameraEnabled,u);break;case Y.Source.Microphone:yield r.setMicrophoneEnabled(l??!r.isMicrophoneEnabled,u);break;case Y.Source.ScreenShare:yield r.setScreenShareEnabled(l??!r.isScreenShareEnabled,u);break;default:break}}finally{o.next(!1)}});return{className:Ci("button"),toggle:a,enabledObserver:s,pendingObserver:o.asObservable()}}function kX(){let e=!1;const t=new Ja,n=new Ja,r=s=>{n.next(!0),e=s??!e,t.next(e),n.next(!1)};return{className:Ci("button"),toggle:r,enabledObserver:t.asObservable(),pendingObserver:n.asObservable()}}function AX(e,t,n){const r=new ID(void 0),i=t?mX(t,e):r.asObservable(),s=(a,...c)=>qo(this,[a,...c],function*(l,u={}){var d,f,h;if(t){st.debug(`Switching active device of kind "${e}" with id ${l}.`),yield t.switchActiveDevice(e,l,u.exact);const p=(d=t.getActiveDevice(e))!=null?d:l;p!==l&&l!=="default"&&st.info(`We tried to select the device with id (${l}), but the browser decided to select the device with id (${p}) instead.`);let m;e==="audioinput"?m=(f=t.localParticipant.getTrack(Y.Source.Microphone))==null?void 0:f.track:e==="videoinput"&&(m=(h=t.localParticipant.getTrack(Y.Source.Camera))==null?void 0:h.track);const y=l==="default"&&!m||l==="default"&&(m==null?void 0:m.mediaStreamTrack.label.startsWith("Default"));r.next(y?l:p)}else if(n){yield n.setDeviceId(u.exact?{exact:l}:l);const p=yield n.getDeviceId();r.next(l==="default"&&n.mediaStreamTrack.label.startsWith("Default")?l:p)}else r.value!==l&&(st.warn("device switch skipped, please provide either a room or a local track to switch on. "),r.next(l))});return{className:Ci("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:s}}function EX(e){const t=r=>{e.disconnect(r)};return{className:Ci("disconnect-button"),disconnect:t}}function TX(e){const t=Ci("connection-quality"),n=CX(e);return{className:t,connectionQualityObserver:n}}function _X(e){let t="track-muted-indicator-camera";switch(e.source){case Y.Source.Camera:t="track-muted-indicator-camera";break;case Y.Source.Microphone:t="track-muted-indicator-microphone";break}const n=Ci(t),r=GD(e);return{className:n,mediaMutedObserver:r}}function RX(e){return{className:"lk-participant-name",infoObserver:yX(e)}}function xX(){return{className:Ci("participant-tile")}}var NX={CHAT:"lk-chat-topic"};function WD(e,t,n){return qo(this,arguments,function*(r,i,s,o={}){const{kind:a,destination:c}=o;yield r.publishData(i,a??dn.RELIABLE,{destination:c,topic:s})})}function PX(e,t,n){const r=hX(e).pipe(LD(([,,,a])=>t===void 0||a===t),Cr(([a,c,,l])=>{const u={payload:a,topic:l,from:c};return n==null||n(u),u}));let i;const s=new jn(a=>{i=a});return{messageObservable:r,isSendingObservable:s,send:(a,...c)=>qo(this,[a,...c],function*(l,u={}){i.next(!0);try{yield WD(e.localParticipant,l,t,u)}finally{i.next(!1)}})}}var MX=new TextEncoder,OX=new TextDecoder,lp=new Map,DX=e=>MX.encode(JSON.stringify({message:e.message,timestamp:e.timestamp})),LX=e=>JSON.parse(OX.decode(e));function BX(e,t){var n,r;const i=new Ja,{messageDecoder:s,messageEncoder:o,channelTopic:a}=t??{},c=a??NX.CHAT;let l=!1;lp.has(e)||(l=!0);const u=(n=lp.get(e))!=null?n:new Map,d=(r=u.get(c))!=null?r:new Ja;if(u.set(c,d),lp.set(e,u),l){const{messageObservable:v}=PX(e,c);v.pipe(KE(i)).subscribe(d)}const f=s??LX,h=d.pipe(Cr(v=>{const S=f(v.payload);return Y7(MI({},S),{from:v.from})}),Z7((v,S)=>[...v,S],[]),KE(i)),p=new ID(!1),m=o??DX,y=v=>qo(this,null,function*(){const S=Date.now(),E=m({message:v,timestamp:S});p.next(!0);try{yield WD(e.localParticipant,E,c,{kind:dn.RELIABLE}),d.next({payload:E,topic:c,from:e.localParticipant})}finally{p.next(!1)}});function g(){i.next(),i.complete(),lp.clear()}return e.once(re.Disconnected,g),{messageObservable:h,isSendingObservable:p,send:y}}function FX(){const e=n=>qo(this,null,function*(){st.info("Start Audio for room: ",n),yield n.startAudio()});return{className:Ci("start-audio-button"),roomAudioPlaybackAllowedObservable:pX,handleStartAudioPlayback:e}}function UX(){const e=n=>qo(this,null,function*(){st.info("Start Video for room: ",n),yield n.startVideo()});return{className:Ci("start-audio-button"),roomVideoPlaybackAllowedObservable:gX,handleStartVideoPlayback:e}}function VX(){return{className:[Ci("button"),Ci("chat-toggle")].join(" ")}}function GX(){return{className:"lk-room-container"}}function WX(e,t){if(typeof localStorage>"u"){st.error("Local storage is not available.");return}try{localStorage.setItem(e,JSON.stringify(t))}catch(n){st.error(`Error setting item to local storage: ${n}`)}}function jX(e){if(typeof localStorage>"u"){st.error("Local storage is not available.");return}try{const t=localStorage.getItem(e);if(!t){st.warn(`Item with key ${e} does not exist in local storage.`);return}return JSON.parse(t)}catch(t){st.error(`Error getting item from local storage: ${t}`);return}}function HX(e){return{load:()=>jX(e),save:t=>WX(e,t)}}var $X=`${UD}-user-choices`,uc={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:zX,save:ZX}=HX($X);function XX(e,t=!1){if(t===!0)return;const n=e,r=q7(n,["e2ee","sharedPassphrase"]);ZX(r)}function KX(e,t=!1){var n,r,i,s,o,a,c;const l={videoEnabled:(n=e==null?void 0:e.videoEnabled)!=null?n:uc.videoEnabled,audioEnabled:(r=e==null?void 0:e.audioEnabled)!=null?r:uc.audioEnabled,videoDeviceId:(i=e==null?void 0:e.videoDeviceId)!=null?i:uc.videoDeviceId,audioDeviceId:(s=e==null?void 0:e.audioDeviceId)!=null?s:uc.audioDeviceId,username:(o=e==null?void 0:e.username)!=null?o:uc.username,e2ee:(a=e==null?void 0:e.e2ee)!=null?a:uc.e2ee,sharedPassphrase:(c=e==null?void 0:e.sharedPassphrase)!=null?c:uc.sharedPassphrase};if(t)return l;{const u=zX();return MI(MI({},l),u??{})}}function jD(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=jD(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function JX(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=jD(e))&&(r&&(r+=" "),r+=t);return r}var YX=Object.defineProperty,qX=Object.defineProperties,QX=Object.getOwnPropertyDescriptors,hm=Object.getOwnPropertySymbols,HD=Object.prototype.hasOwnProperty,$D=Object.prototype.propertyIsEnumerable,YE=(e,t,n)=>t in e?YX(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_e=(e,t)=>{for(var n in t||(t={}))HD.call(t,n)&&YE(e,n,t[n]);if(hm)for(var n of hm(t))$D.call(t,n)&&YE(e,n,t[n]);return e},Qn=(e,t)=>qX(e,QX(t)),Hn=(e,t)=>{var n={};for(var r in e)HD.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&hm)for(var r of hm(e))t.indexOf(r)<0&&$D.call(e,r)&&(n[r]=e[r]);return n},zD=(e,t,n)=>new Promise((r,i)=>{var s=c=>{try{a(n.next(c))}catch(l){i(l)}},o=c=>{try{a(n.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((n=n.apply(e,t)).next())});function ei(e,t){const[n,r]=w.useState(t);return w.useEffect(()=>{if(typeof window>"u"||!e)return;const i=e.subscribe(r);return()=>i.unsubscribe()},[e]),n}function eK(e){const t=s=>typeof window<"u"?window.matchMedia(s).matches:!1,[n,r]=w.useState(t(e));function i(){r(t(e))}return w.useEffect(()=>{const s=window.matchMedia(e);return i(),s.addListener?s.addListener(i):s.addEventListener("change",i),()=>{s.removeListener?s.removeListener(i):s.removeEventListener("change",i)}},[e]),n}function tK(e,t){if(t.msg==="show_chat")return Qn(_e({},e),{showChat:!0,unreadMessages:0});if(t.msg==="hide_chat")return Qn(_e({},e),{showChat:!1});if(t.msg==="toggle_chat"){const n=Qn(_e({},e),{showChat:!e.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return t.msg==="unread_msg"?Qn(_e({},e),{unreadMessages:t.count}):_e({},e)}function nK(e,t){return t.msg==="set_pin"?[t.trackReference]:t.msg==="clear_pin"?[]:_e({},e)}var dw=w.createContext(void 0);function rK(){const e=w.useContext(dw);if(!e)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return e}function iK(e){const[t,n]=w.useReducer(nK,lX),[r,i]=w.useReducer(tK,uX);return e??{pin:{dispatch:n,state:t},widget:{dispatch:i,state:r}}}function ZD(){return w.useContext(dw)}var sK=w.createContext(void 0);function Ah(){return w.useContext(sK)}var fw=w.createContext(void 0);function yv(){return w.useContext(fw)}function ol(e){var t;const n=yv(),r=Ah(),i=(t=e??n)!=null?t:r==null?void 0:r.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var hw=w.createContext(void 0);function Cv(){const e=w.useContext(hw);if(!e)throw Error("tried to access room context outside of livekit room component");return e}function Iv(){return w.useContext(hw)}function Eh(e){const t=Iv(),n=e??t;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var oK=w.createContext(void 0);function aK(...e){return(...t)=>{for(const n of e)typeof n=="function"&&n(...t)}}function oc(...e){const t=_e({},e[0]);for(let n=1;n<e.length;n++){const r=e[n];for(const i in r){const s=t[i],o=r[i];typeof s=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?t[i]=aK(s,o):(i==="className"||i==="UNSAFE_className")&&typeof s=="string"&&typeof o=="string"?t[i]=JX(s,o):t[i]=o!==void 0?o:s}}return t}function cK(e={}){const t=ol(e.participant),{className:n,connectionQualityObserver:r}=w.useMemo(()=>TX(t),[t]),i=ei(r,ui.Unknown);return{className:n,quality:i}}function lK(e){const t=Eh(e),n=w.useMemo(()=>dX(t),[t]);return ei(n,t.state)}function uK(e){const t=Cv(),n=lK(t);return{buttonProps:w.useMemo(()=>{const{className:i,disconnect:s}=EX(t);return oc(e,{className:i,onClick:()=>{var a;return s((a=e.stopTracks)!=null?a:!0)},disabled:n===et.Disconnected})},[t,e,n])}}function dK(e){if(e.publication instanceof Zf){const t=e.publication.track;if(t){const{facingMode:n}=PZ(t);return n}}return"undefined"}function qE(e,t={}){var n,r;const i=typeof e=="string"?t.participant:e.participant,s=ol(i),o=typeof e=="string"?{participant:s,source:e}:e,[a,c]=w.useState(!!((n=o.publication)!=null&&n.isMuted||(r=s.getTrack(o.source))!=null&&r.isMuted));return w.useEffect(()=>{const l=GD(o).subscribe(c);return()=>l.unsubscribe()},[VD(o)]),a}function fK(e){const t=ol(e),n=w.useMemo(()=>IX(t),[t]);return ei(n,t.isSpeaking)}var hK={connect:!0,audio:!1,video:!1};function pK(e){const t=_e(_e({},hK),e),{token:n,serverUrl:r,options:i,room:s,connectOptions:o,connect:a,audio:c,video:l,screen:u,onConnected:d,onDisconnected:f,onError:h,onMediaDeviceFailure:p,onEncryptionError:m,simulateParticipants:y}=t,g=Hn(t,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);i&&s&&st.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[v,S]=w.useState();w.useEffect(()=>{S(s??new cm(i))},[s]);const E=w.useMemo(()=>{const{className:k}=GX();return oc(g,{className:k})},[g]);return w.useEffect(()=>{if(!v)return;const k=()=>{const _=v.localParticipant;st.debug("trying to publish local tracks"),Promise.all([_.setMicrophoneEnabled(!!c,typeof c!="boolean"?c:void 0),_.setCameraEnabled(!!l,typeof l!="boolean"?l:void 0),_.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(P=>{st.warn(P),h==null||h(P)})},b=_=>{const P=$f.getFailure(_);p==null||p(P)},A=_=>{m==null||m(_)};return v.on(re.SignalConnected,k).on(re.MediaDevicesError,b).on(re.EncryptionError,A),()=>{v.off(re.SignalConnected,k).off(re.MediaDevicesError,b).off(re.EncryptionError,A)}},[v,c,l,u,h,m,p]),w.useEffect(()=>{if(v){if(y){v.simulateParticipants({participants:{count:y},publish:{audio:!0,useRealTracks:!0}});return}if(!n){st.debug("no token yet");return}if(!r){st.warn("no livekit url provided"),h==null||h(Error("no livekit url provided"));return}a?(st.debug("connecting"),v.connect(r,n,o).catch(k=>{st.warn(k),h==null||h(k)})):(st.debug("disconnecting because connect is false"),v.disconnect())}},[a,n,JSON.stringify(o),v,h,r,y]),w.useEffect(()=>{if(!v)return;const k=b=>{switch(b){case et.Disconnected:f&&f();break;case et.Connected:d&&d();break}};return v.on(re.ConnectionStateChanged,k),()=>{v.off(re.ConnectionStateChanged,k)}},[n,d,f,v]),w.useEffect(()=>{if(v)return()=>{st.info("disconnecting on onmount"),v.disconnect()}},[v]),{room:v,htmlProps:E}}function gK(e={}){const t=Eh(e.room),[n,r]=w.useState(t.localParticipant),[i,s]=w.useState(n.isMicrophoneEnabled),[o,a]=w.useState(n.isMicrophoneEnabled),[c,l]=w.useState(n.lastMicrophoneError),[u,d]=w.useState(n.lastCameraError),[f,h]=w.useState(n.isMicrophoneEnabled),[p,m]=w.useState(void 0),[y,g]=w.useState(void 0),v=S=>{a(S.isCameraEnabled),s(S.isMicrophoneEnabled),h(S.isScreenShareEnabled),g(S.cameraTrack),m(S.microphoneTrack),l(S.participant.lastMicrophoneError),d(S.participant.lastCameraError),r(S.participant)};return w.useEffect(()=>{const S=lw(n).subscribe(v);return()=>S.unsubscribe()},[n]),{isMicrophoneEnabled:i,isScreenShareEnabled:f,isCameraEnabled:o,microphoneTrack:p,cameraTrack:y,lastMicrophoneError:c,lastCameraError:u,localParticipant:n}}function mK(){const e=Cv(),t=w.useMemo(()=>bX(e.localParticipant),[e]);return ei(t,e.localParticipant.permissions)}function vK({kind:e,room:t,track:n,requestPermissions:r,onError:i}){const s=Iv(),o=w.useMemo(()=>fX(e,i,r),[e,r,i]),a=ei(o,[]),[c,l]=w.useState(""),{className:u,activeDeviceObservable:d,setActiveMediaDevice:f}=w.useMemo(()=>AX(e,t??s,n),[e,t,s,n]);return w.useEffect(()=>{const h=d.subscribe(p=>{st.info("setCurrentDeviceId",p),p&&l(p)});return()=>{h==null||h.unsubscribe()}},[d]),{devices:a,className:u,activeDeviceId:c,setActiveMediaDevice:f}}function yK(e){return e!==void 0}function id(...e){return oc(...e.filter(yK))}function XD(e,t,n){return w.Children.map(e,r=>w.isValidElement(r)&&w.Children.only(e)?w.cloneElement(r,Qn(_e({},t),{key:n})):r)}function KD(e,t={}){var n;const[r,i]=w.useState(OI(e)),[s,o]=w.useState(r==null?void 0:r.isMuted),[a,c]=w.useState(r==null?void 0:r.isSubscribed),[l,u]=w.useState(r==null?void 0:r.track),[d,f]=w.useState("landscape"),h=w.useRef(),{className:p,trackObserver:m}=w.useMemo(()=>vX(e),[(n=e.participant.sid)!=null?n:e.participant.identity,e.source,sw(e)&&e.publication.trackSid]);return w.useEffect(()=>{const y=m.subscribe(g=>{st.debug("update track",g),i(g),o(g==null?void 0:g.isMuted),c(g==null?void 0:g.isSubscribed),u(g==null?void 0:g.track)});return()=>y==null?void 0:y.unsubscribe()},[m]),w.useEffect(()=>{var y,g;return l&&(h.current&&l.detach(h.current),(y=t.element)!=null&&y.current&&!(nX(e.participant)&&(l==null?void 0:l.kind)==="audio")&&l.attach(t.element.current)),h.current=(g=t.element)==null?void 0:g.current,()=>{h.current&&(l==null||l.detach(h.current))}},[l,t.element]),w.useEffect(()=>{var y,g;if(typeof((y=r==null?void 0:r.dimensions)==null?void 0:y.width)=="number"&&typeof((g=r==null?void 0:r.dimensions)==null?void 0:g.height)=="number"){const v=r.dimensions.width>r.dimensions.height?"landscape":"portrait";f(v)}},[r]),{publication:r,isMuted:s,isSubscribed:a,track:l,elementProps:id(t.props,_e({className:p,"data-lk-local-participant":e.participant.isLocal,"data-lk-source":r==null?void 0:r.source},(r==null?void 0:r.kind)==="video"&&{"data-lk-orientation":d}))}}function CK({trackRef:e,participant:t,source:n,publication:r,onParticipantClick:i,disableSpeakingIndicator:s,htmlProps:o}){const a=Ah(),c=ol(t),l=w.useMemo(()=>{var m,y,g,v,S,E;const k=(y=(m=e==null?void 0:e.source)!=null?m:a==null?void 0:a.source)!=null?y:n;if(k===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(v=(g=e==null?void 0:e.participant)!=null?g:a==null?void 0:a.participant)!=null?v:c,publication:(E=(S=e==null?void 0:e.publication)!=null?S:a==null?void 0:a.publication)!=null?E:r,source:k}},[e==null?void 0:e.participant,e==null?void 0:e.source,e==null?void 0:e.publication,a==null?void 0:a.participant,a==null?void 0:a.source,a==null?void 0:a.publication,c,n,r]),u=w.useMemo(()=>{const{className:m}=xX();return oc(o,{className:m,onClick:y=>{var g,v;if((g=o.onClick)==null||g.call(o,y),typeof i=="function"){const S=(v=l.publication)!=null?v:l.participant.getTrack(l.source);i({participant:l.participant,track:S})}}})},[o,i,l.publication,l.source,l.participant]),d=qE(Y.Source.Camera,{participant:l.participant}),f=qE(Y.Source.Microphone,{participant:l.participant}),h=fK(l.participant),p=dK(l);return{elementProps:_e({"data-lk-audio-muted":f,"data-lk-video-muted":d,"data-lk-speaking":s===!0?!1:h,"data-lk-local-participant":l.participant.isLocal,"data-lk-source":l.source,"data-lk-facing-mode":p},u)}}function IK(e={}){const t=Eh(e.room),[n,r]=w.useState([]);return w.useEffect(()=>{const i=SX(t,{additionalRoomEvents:e.updateOnlyOn}).subscribe(r);return()=>i.unsubscribe()},[t,JSON.stringify(e.updateOnlyOn)]),n}function SK(e={}){const t=IK(e),{localParticipant:n}=gK(e);return[n,...t]}function bK({room:e,props:t}){const n=Eh(e),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:s}=w.useMemo(()=>FX(),[]),o=w.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=ei(o,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:w.useMemo(()=>oc(t,{className:r,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[t,r,a,s,n]),canPlayAudio:a}}function wK({room:e,props:t}){const n=Eh(e),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:s}=w.useMemo(()=>UX(),[]),o=w.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=ei(o,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:w.useMemo(()=>oc(t,{className:r,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[t,r,a,s,n]),canPlayVideo:a}}function kK({props:e}){const{dispatch:t,state:n}=rK().widget,{className:r}=w.useMemo(()=>VX(),[]);return{mergedProps:w.useMemo(()=>oc(e,{className:r,onClick:()=>{t&&t({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[e,r,t,n])}}function AK(e,t={}){var n,r,i,s;let o=Ah();const a=(r=(n=yv())!=null?n:t.participant)!=null?r:o==null?void 0:o.participant;if(typeof e=="string"){if(!a)throw Error("Participant missing, either provide it via context or pass it in directly");o={participant:a,source:e}}else if(e)o=e;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:c,mediaMutedObserver:l}=w.useMemo(()=>_X(o),[VD(o)]);return{isMuted:ei(l,!!((i=o.publication)!=null&&i.isMuted||(s=o.participant.getTrack(o.source))!=null&&s.isMuted)),className:c}}function EK(e){var t=e,{source:n,onChange:r,initialState:i,captureOptions:s}=t,o=Hn(t,["source","onChange","initialState","captureOptions"]),a;const c=Iv(),l=(a=c==null?void 0:c.localParticipant)==null?void 0:a.getTrack(n),{toggle:u,className:d,pendingObserver:f,enabledObserver:h}=w.useMemo(()=>c?wX(n,c,s):kX(),[c,n,JSON.stringify(s)]),p=ei(f,!1),m=ei(h,i??!!(l!=null&&l.isEnabled));w.useEffect(()=>{r==null||r(m)},[m,r]),w.useEffect(()=>{i!==void 0&&(st.debug("forcing initial toggle state",n,i),u(i))},[]);const y=w.useMemo(()=>oc(o,{className:d}),[o,d]),g=w.useCallback(v=>{var S;u(),(S=o.onClick)==null||S.call(o,v)},[o,u]);return{toggle:u,enabled:m,pending:p,track:l,buttonProps:Qn(_e({},y),{"aria-pressed":m,"data-lk-source":n,"data-lk-enabled":m,disabled:p,onClick:g})}}function TK(e,t={}){return KD(e,t)}function _K(e){const t=Cv(),[n,r]=w.useState(),i=ei(n==null?void 0:n.isSendingObservable,!1),s=ei(n==null?void 0:n.messageObservable,[]);return w.useEffect(()=>{const o=BX(t,e);r(o)},[t,e]),{send:n==null?void 0:n.send,chatMessages:s,isSending:i}}function RK(e={}){var t;const[n,r]=w.useState(KX(e.defaults,(t=e.preventLoad)!=null?t:!1)),i=w.useCallback(l=>{r(u=>Qn(_e({},u),{audioEnabled:l}))},[]),s=w.useCallback(l=>{r(u=>Qn(_e({},u),{videoEnabled:l}))},[]),o=w.useCallback(l=>{r(u=>Qn(_e({},u),{audioDeviceId:l}))},[]),a=w.useCallback(l=>{r(u=>Qn(_e({},u),{videoDeviceId:l}))},[]),c=w.useCallback(l=>{r(u=>Qn(_e({},u),{username:l}))},[]);return w.useEffect(()=>{var l;XX(n,(l=e.preventSave)!=null?l:!1)},[n,e.preventSave]),{userChoices:n,saveAudioInputEnabled:i,saveVideoInputEnabled:s,saveAudioInputDeviceId:o,saveVideoInputDeviceId:a,saveUsername:c}}function xK(e){const{mergedProps:t}=kK({props:e});return w.createElement("button",_e({},t),e.children)}function NK(e){const{buttonProps:t}=uK(e);return w.createElement("button",_e({},t),e.children)}var PK=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),w.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),w.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),MK=PK,OK=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),w.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),DK=OK,LK=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},e),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),BK=LK,FK=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),UK=FK,VK=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),w.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),w.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),GK=VK,WK=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),w.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),w.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),jK=WK,HK=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},e),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),$K=HK,zK=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},e),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("g",{opacity:.25},w.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),ZK=zK,XK=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},e),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("g",{opacity:.25},w.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),w.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),KK=XK,JK=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},e),w.createElement("g",{opacity:.25},w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),w.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),YK=JK,qK=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},e),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),QK=qK,eJ=e=>w.createElement("svg",_e({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},e),w.createElement("g",{fill:"currentColor"},w.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),w.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),tJ=eJ;function o0(e){var t=e,{kind:n,initialSelection:r,onActiveDeviceChange:i,onDeviceListChange:s,onDeviceSelectError:o,exactMatch:a,track:c,requestPermissions:l,onError:u}=t,d=Hn(t,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const f=Iv(),h=w.useCallback(k=>{f&&f.emit(re.MediaDevicesError,k),u==null||u(k)},[f,u]),{devices:p,activeDeviceId:m,setActiveMediaDevice:y,className:g}=vK({kind:n,room:f,track:c,requestPermissions:l,onError:h});w.useEffect(()=>{r!==void 0&&y(r)},[y]),w.useEffect(()=>{typeof s=="function"&&s(p)},[s,p]),w.useEffect(()=>{m&&m!==""&&(i==null||i(m))},[m]);const v=k=>zD(this,null,function*(){try{yield y(k,{exact:a})}catch(b){if(b instanceof Error)o==null||o(b);else throw b}}),S=w.useMemo(()=>id(d,{className:g},{className:"lk-list"}),[g,d]);function E(k,b,A){return k===b||A===0&&b==="default"}return w.createElement("ul",_e({},S),p.map((k,b)=>w.createElement("li",{key:k.deviceId,id:k.deviceId,"data-lk-active":E(k.deviceId,m,b),"aria-selected":E(k.deviceId,m,b),role:"option"},w.createElement("button",{className:"lk-button",onClick:()=>v(k.deviceId)},k.label))))}function JD(e,t){switch(e){case Y.Source.Microphone:return t?w.createElement(jK,null):w.createElement(GK,null);case Y.Source.Camera:return t?w.createElement(DK,null):w.createElement(MK,null);case Y.Source.ScreenShare:return t?w.createElement(tJ,null):w.createElement(QK,null);default:return}}function nJ(e){switch(e){case ui.Excellent:return w.createElement($K,null);case ui.Good:return w.createElement(ZK,null);case ui.Poor:return w.createElement(KK,null);default:return w.createElement(YK,null)}}function a0(e){var t=e,{showIcon:n}=t,r=Hn(t,["showIcon"]);const{buttonProps:i,enabled:s}=EK(r);return w.createElement("button",_e({},i),(n??!0)&&JD(r.source,s),r.children)}function rJ(e){var t;const{className:n,quality:r}=cK(e),i=w.useMemo(()=>Qn(_e({},id(e,{className:n})),{"data-lk-quality":r}),[r,e,n]);return w.createElement("div",_e({},i),(t=e.children)!=null?t:nJ(r))}function iJ(e){var t=e,{participant:n}=t,r=Hn(t,["participant"]);const i=ol(n),{className:s,infoObserver:o}=w.useMemo(()=>RX(i),[i]),{identity:a,name:c}=ei(o,{name:i.name,identity:i.identity,metadata:i.metadata}),l=w.useMemo(()=>id(r,{className:s,"data-lk-participant-name":c}),[r,s,c]);return w.createElement("span",_e({},l),c!==""?c:a,r.children)}function sJ(e){var t=e,{source:n,participant:r,trackRef:i,show:s="always"}=t,o=Hn(t,["source","participant","trackRef","show"]),a,c;const{className:l,isMuted:u}=AK(i??n,{participant:r}),d=s==="always"||s==="muted"&&u||s==="unmuted"&&!u,f=w.useMemo(()=>id(o,{className:l}),[l,o]);return d?w.createElement("div",Qn(_e({},f),{"data-lk-muted":u}),(c=o.children)!=null?c:JD((a=i==null?void 0:i.source)!=null?a:n,!u)):null}function oJ(e){var t=e,{trackRef:n,onSubscriptionStatusChanged:r,volume:i,source:s,name:o,publication:a,participant:c}=t,l=Hn(t,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),u,d,f,h,p,m,y,g,v,S;const E=Ah(),k=(h=(f=(u=n==null?void 0:n.publication)==null?void 0:u.trackName)!=null?f:(d=E==null?void 0:E.publication)==null?void 0:d.trackName)!=null?h:o,b=(m=(p=n==null?void 0:n.source)!=null?p:E==null?void 0:E.source)!=null?m:s,A=(g=(y=n==null?void 0:n.publication)!=null?y:E==null?void 0:E.publication)!=null?g:a,_=(S=(v=n==null?void 0:n.participant)!=null?v:E==null?void 0:E.participant)!=null?S:c;if(b===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const P=w.useRef(null),N=ol(_),{elementProps:O,isSubscribed:D,track:U,publication:G}=KD({source:b,name:k,participant:N,publication:A},{element:P,props:l});return w.useEffect(()=>{r==null||r(!!D)},[D,r]),w.useEffect(()=>{U===void 0||i===void 0||(U instanceof Mc?U.setVolume(i):st.warn("Volume can only be set on remote audio tracks."))},[i,U]),w.useEffect(()=>{G===void 0||l.muted===void 0||(G instanceof ew?G.setEnabled(!l.muted):st.warn("Can only call setEnabled on remote track publications."))},[l.muted,G,U]),w.createElement("audio",_e({ref:P},O))}function aJ(e){const t=!!yv();return e.participant&&!t?w.createElement(fw.Provider,{value:e.participant},e.children):w.createElement(w.Fragment,null,e.children)}function cJ({value:e,onPinChange:t,onWidgetChange:n,children:r}){const i=iK(e);return w.useEffect(()=>{st.debug("PinState Updated",{state:i.pin.state}),t&&i.pin.state&&t(i.pin.state)},[i.pin.state,t]),w.useEffect(()=>{st.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),w.createElement(dw.Provider,{value:i},r)}function lJ(e){const{room:t,htmlProps:n}=pK(e);return w.createElement("div",_e({},n),t&&w.createElement(hw.Provider,{value:t},w.createElement(oK.Provider,{value:e.featureFlags},e.children)))}function uJ(e){var t=e,{participant:n,trackRef:r}=t,i=Hn(t,["participant","trackRef"]),s,o;const[a,c]=w.useState([]),l=200,u=90,d=6,f=4,h=50,p=7,m=(s=yv())!=null?s:n;let y=(o=Ah())!=null?o:r;if(!y){if(!m)throw Error("Participant missing, provide it directly or within a context");y={participant:m,source:Y.Source.Microphone}}const{track:g}=TK(y);return w.useEffect(()=>{if(!g||!(g instanceof br||g instanceof Mc))return;const{analyser:v,cleanup:S}=Uz(g,{smoothingTimeConstant:.8,fftSize:64}),E=new Uint8Array(v.frequencyBinCount),k=()=>{v.getByteFrequencyData(E);const A=new Array(p).fill(0);E.slice(1);const _=6;for(let P=0;P<p/2;P+=1){const N=Math.floor(p/2-P);for(let O=0;O<_;O+=1)A[N]+=Math.pow(E[P*_+O]/255,2);A[N]/=_}for(let P=0;P<p/2;P+=1){const N=Math.floor(p/2+P);if(A[N]===0){for(let O=0;O<_;O+=1)A[N]+=Math.pow(E[P*_+O]/255,2);A[N]/=_}}return A.map(P=>P*h)},b=setInterval(()=>{const A=k();c(A)},100);return()=>{clearInterval(b),S()}},[g]),w.createElement("svg",Qn(_e({width:"100%",height:"100%",viewBox:`0 0 ${l} ${u}`},i),{className:"lk-audio-visualizer"}),w.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%"}),w.createElement("g",{style:{transform:`translate(${(l-p*(d+f))/2}px, 0)`}},a.map((v,S)=>w.createElement("rect",{key:S,x:S*(d+f),y:u/2-v/2,width:d,height:v}))))}function dJ(e){var t=e,{participants:n}=t,r=Hn(t,["participants"]);return w.createElement(w.Fragment,null,n.map(i=>w.createElement(fw.Provider,{value:i,key:i.identity},XD(r.children))))}function fJ(e){var t=e,{participant:n,children:r,source:i,publication:s,disableSpeakingIndicator:o,onParticipantClick:a}=t,c=Hn(t,["participant","children","source","publication","disableSpeakingIndicator","onParticipantClick"]);const l=ol(n),{elementProps:u}=CK({participant:l,htmlProps:c,disableSpeakingIndicator:o,source:Y.Source.Microphone,publication:s,onParticipantClick:a});return w.createElement("div",_e({style:{position:"relative"}},u),w.createElement(aJ,{participant:l},r??w.createElement(w.Fragment,null,w.createElement(oJ,{source:i??Y.Source.Microphone}),w.createElement(uJ,null),w.createElement("div",{className:"lk-participant-metadata"},w.createElement("div",{className:"lk-participant-metadata-item"},w.createElement(sJ,{source:Y.Source.Microphone}),w.createElement(iJ,null)),w.createElement(rJ,{className:"lk-participant-metadata-item"})))))}function hJ(e){var t=e,{entry:n,hideName:r=!1,hideTimestamp:i=!1,messageFormatter:s}=t,o=Hn(t,["entry","hideName","hideTimestamp","messageFormatter"]),a,c,l,u;const d=w.useMemo(()=>s?s(n.message):n.message,[n.message,s]),f=new Date(n.timestamp),h=navigator?navigator.language:"en-US";return w.createElement("li",_e({className:"lk-chat-entry",title:f.toLocaleTimeString(h,{timeStyle:"full"}),"data-lk-message-origin":(a=n.from)!=null&&a.isLocal?"local":"remote"},o),(!i||!r)&&w.createElement("span",{className:"lk-meta-data"},!r&&w.createElement("strong",{className:"lk-participant-name"},(u=(c=n.from)==null?void 0:c.name)!=null?u:(l=n.from)==null?void 0:l.identity),!i&&w.createElement("span",{className:"lk-timestamp"},f.toLocaleTimeString(h,{timeStyle:"short"}))),w.createElement("span",{className:"lk-message-body"},d))}function pJ(e){var t=e,{messageFormatter:n,messageDecoder:r,messageEncoder:i,channelTopic:s}=t,o=Hn(t,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const a=w.useRef(null),c=w.useRef(null),l=w.useMemo(()=>({messageDecoder:r,messageEncoder:i,channelTopic:s}),[r,i,s]),{send:u,chatMessages:d,isSending:f}=_K(l),h=ZD(),p=w.useRef(0);function m(y){return zD(this,null,function*(){y.preventDefault(),a.current&&a.current.value.trim()!==""&&u&&(yield u(a.current.value),a.current.value="",a.current.focus())})}return w.useEffect(()=>{var y;c&&((y=c.current)==null||y.scrollTo({top:c.current.scrollHeight}))},[c,d]),w.useEffect(()=>{var y,g,v,S,E;if(!h||d.length===0)return;if((y=h.widget.state)!=null&&y.showChat&&d.length>0&&p.current!==((g=d[d.length-1])==null?void 0:g.timestamp)){p.current=(v=d[d.length-1])==null?void 0:v.timestamp;return}const k=d.filter(A=>!p.current||A.timestamp>p.current).length,{widget:b}=h;k>0&&((S=b.state)==null?void 0:S.unreadMessages)!==k&&((E=b.dispatch)==null||E.call(b,{msg:"unread_msg",count:k}))},[d,h==null?void 0:h.widget]),w.createElement("div",Qn(_e({},o),{className:"lk-chat"}),w.createElement("ul",{className:"lk-list lk-chat-messages",ref:c},o.children?d.map((y,g)=>XD(o.children,{entry:y,key:g,messageFormatter:n})):d.map((y,g,v)=>{const S=g>=1&&v[g-1].from===y.from,E=g>=1&&y.timestamp-v[g-1].timestamp<6e4;return w.createElement(hJ,{key:g,hideName:S,hideTimestamp:S===!1?!1:E,entry:y,messageFormatter:n})})),w.createElement("form",{className:"lk-chat-form",onSubmit:m},w.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:f,ref:a,type:"text",placeholder:"Enter a message..."}),w.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:f},"Send")))}function QE(e){var t=e,{kind:n,initialSelection:r,onActiveDeviceChange:i,tracks:s,requestPermissions:o=!1}=t,a=Hn(t,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[c,l]=w.useState(!1),[u,d]=w.useState([]),[f,h]=w.useState(!0),p=(v,S)=>{st.debug("handle device change"),l(!1),i==null||i(v,S)},m=w.useRef(null),y=w.useRef(null);w.useLayoutEffect(()=>{m.current&&y.current&&(u||f)&&rX(m.current,y.current).then(({x:v,y:S})=>{y.current&&Object.assign(y.current.style,{left:`${v}px`,top:`${S}px`})}),h(!1)},[m,y,u,f]);const g=w.useCallback(v=>{y.current&&v.target!==m.current&&c&&iX(y.current,v)&&l(!1)},[c,y,m]);return w.useEffect(()=>(document.addEventListener("click",g),window.addEventListener("resize",()=>h(!0)),()=>{document.removeEventListener("click",g),window.removeEventListener("resize",()=>h(!0))}),[g,h]),w.createElement(w.Fragment,null,w.createElement("button",Qn(_e({className:"lk-button lk-button-menu","aria-pressed":c},a),{onClick:()=>l(!c),ref:m}),a.children),!a.disabled&&w.createElement("div",{className:"lk-device-menu",ref:y,style:{visibility:c?"visible":"hidden"}},n?w.createElement(o0,{initialSelection:r,onActiveDeviceChange:v=>p(n,v),onDeviceListChange:d,kind:n,track:s==null?void 0:s[n],requestPermissions:o}):w.createElement(w.Fragment,null,w.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),w.createElement(o0,{kind:"audioinput",onActiveDeviceChange:v=>p("audioinput",v),onDeviceListChange:d,track:s==null?void 0:s.audioinput,requestPermissions:o}),w.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),w.createElement(o0,{kind:"videoinput",onActiveDeviceChange:v=>p("videoinput",v),onDeviceListChange:d,track:s==null?void 0:s.videoinput,requestPermissions:o}))))}function gJ(e){var t=e,{label:n}=t,r=Hn(t,["label"]);const i=Cv(),{mergedProps:s,canPlayAudio:o}=bK({room:i,props:r}),{mergedProps:a,canPlayVideo:c}=wK({room:i,props:s}),l=a,{style:u}=l,d=Hn(l,["style"]);return u.display=o&&c?"none":"block",w.createElement("button",_e({style:u},d),n??`Start ${o?"Video":"Audio"}`)}function mJ(e){var t=e,{variation:n,controls:r,saveUserChoices:i=!0}=t,s=Hn(t,["variation","controls","saveUserChoices"]),o,a,c,l,u;const[d,f]=w.useState(!1),h=ZD();w.useEffect(()=>{var U,G;((U=h==null?void 0:h.widget.state)==null?void 0:U.showChat)!==void 0&&f((G=h==null?void 0:h.widget.state)==null?void 0:G.showChat)},[(o=h==null?void 0:h.widget.state)==null?void 0:o.showChat]);const m=eK(`(max-width: ${d?1e3:760}px)`)?"minimal":"verbose";n??(n=m);const y=_e({leave:!0},r),g=mK();g?((a=y.camera)!=null||(y.camera=g.canPublish),(c=y.microphone)!=null||(y.microphone=g.canPublish),(l=y.screenShare)!=null||(y.screenShare=g.canPublish),(u=y.chat)!=null||(y.chat=g.canPublishData&&(r==null?void 0:r.chat))):(y.camera=!1,y.chat=!1,y.microphone=!1,y.screenShare=!1);const v=w.useMemo(()=>n==="minimal"||n==="verbose",[n]),S=w.useMemo(()=>n==="textOnly"||n==="verbose",[n]),E=cX(),[k,b]=w.useState(!1),A=U=>{b(U)},_=id({className:"lk-control-bar"},s),{saveAudioInputEnabled:P,saveVideoInputEnabled:N,saveAudioInputDeviceId:O,saveVideoInputDeviceId:D}=RK({preventSave:!i});return w.createElement("div",_e({},_),y.microphone&&w.createElement("div",{className:"lk-button-group"},w.createElement(a0,{source:Y.Source.Microphone,showIcon:v,onChange:P},S&&"Microphone"),w.createElement("div",{className:"lk-button-group-menu"},w.createElement(QE,{kind:"audioinput",onActiveDeviceChange:(U,G)=>O(G??"")}))),y.camera&&w.createElement("div",{className:"lk-button-group"},w.createElement(a0,{source:Y.Source.Camera,showIcon:v,onChange:N},S&&"Camera"),w.createElement("div",{className:"lk-button-group-menu"},w.createElement(QE,{kind:"videoinput",onActiveDeviceChange:(U,G)=>D(G??"")}))),y.screenShare&&E&&w.createElement(a0,{source:Y.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:v,onChange:A},S&&(k?"Stop screen share":"Share screen")),y.chat&&w.createElement(xK,null,v&&w.createElement(BK,null),S&&"Chat"),y.leave&&w.createElement(NK,null,v&&w.createElement(UK,null),S&&"Leave"),w.createElement(gJ,null))}function vJ(e){var t=Hn(e,[]);const[n,r]=w.useState({showChat:!1,unreadMessages:0}),i=SK();return w.createElement(cJ,{onWidgetChange:r},w.createElement("div",_e({className:"lk-audio-conference"},t),w.createElement("div",{className:"lk-audio-conference-stage"},w.createElement(dJ,{participants:i},w.createElement(fJ,null))),w.createElement(mJ,{controls:{microphone:!0,screenShare:!1,camera:!1,chat:!0}}),n.showChat&&w.createElement(pJ,null)))}const yJ="wss://mongoose-67t79p35.livekit.cloud",CJ=({client:e})=>{const[t,n]=w.useState([]),[r,i]=w.useState(!1);return w.useEffect(()=>{const s=a=>{n(c=>[...c,a]),i(!0)},o=a=>{n(c=>{const l=c.filter(u=>u!==a);return l.length===0&&i(!1),l})};return e.on("livekitToken",s),e.on("livekitLeave",o),()=>{e.off("livekitToken",s),e.off("livekitLeave",o)}},[e]),t.length?J.jsxs("div",{"data-lk-theme":"default",children:[t.map((s,o)=>J.jsx(lJ,{video:!1,audio:!0,token:s,serverUrl:yJ,connect:!0,onDisconnected:()=>e.emit("livekitLeave",s),children:J.jsx(vJ,{})},o)),J.jsx("div",{className:"audio-status","aria-live":"polite"})]}):null},YD=Object.prototype.toString;function pw(e){switch(YD.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return $o(e,Error)}}function sd(e,t){return YD.call(e)===`[object ${t}]`}function gw(e){return sd(e,"ErrorEvent")}function eT(e){return sd(e,"DOMError")}function IJ(e){return sd(e,"DOMException")}function Us(e){return sd(e,"String")}function mw(e){return typeof e=="object"&&e!==null&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function vw(e){return e===null||mw(e)||typeof e!="object"&&typeof e!="function"}function Du(e){return sd(e,"Object")}function Sv(e){return typeof Event<"u"&&$o(e,Event)}function SJ(e){return typeof Element<"u"&&$o(e,Element)}function bJ(e){return sd(e,"RegExp")}function bv(e){return!!(e&&e.then&&typeof e.then=="function")}function wJ(e){return Du(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function qD(e){return typeof e=="number"&&e!==e}function $o(e,t){try{return e instanceof t}catch{return!1}}function QD(e){return!!(typeof e=="object"&&e!==null&&(e.__isVue||e._isVue))}function fu(e,t=0){return typeof e!="string"||t===0||e.length<=t?e:`${e.slice(0,t)}...`}function tT(e,t){if(!Array.isArray(e))return"";const n=[];for(let r=0;r<e.length;r++){const i=e[r];try{QD(i)?n.push("[VueViewModel]"):n.push(String(i))}catch{n.push("[value cannot be serialized]")}}return n.join(t)}function kJ(e,t,n=!1){return Us(e)?bJ(t)?t.test(e):Us(t)?n?e===t:e.includes(t):!1:!1}function od(e,t=[],n=!1){return t.some(r=>kJ(e,r,n))}function AJ(e,t,n=250,r,i,s,o){if(!s.exception||!s.exception.values||!o||!$o(o.originalException,Error))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;a&&(s.exception.values=EJ(DI(e,t,i,o.originalException,r,s.exception.values,a,0),n))}function DI(e,t,n,r,i,s,o,a){if(s.length>=n+1)return s;let c=[...s];if($o(r[i],Error)){nT(o,a);const l=e(t,r[i]),u=c.length;rT(l,i,u,a),c=DI(e,t,n,r[i],i,[l,...c],l,u)}return Array.isArray(r.errors)&&r.errors.forEach((l,u)=>{if($o(l,Error)){nT(o,a);const d=e(t,l),f=c.length;rT(d,`errors[${u}]`,f,a),c=DI(e,t,n,l,i,[d,...c],d,f)}}),c}function nT(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,is_exception_group:!0,exception_id:t}}function rT(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}function EJ(e,t){return e.map(n=>(n.value&&(n.value=fu(n.value,t)),n))}function up(e){return e&&e.Math==Math?e:void 0}const Je=typeof globalThis=="object"&&up(globalThis)||typeof window=="object"&&up(window)||typeof self=="object"&&up(self)||typeof global=="object"&&up(global)||function(){return this}()||{};function yw(){return Je}function eL(e,t,n){const r=n||Je,i=r.__SENTRY__=r.__SENTRY__||{};return i[e]||(i[e]=t())}const hu=yw(),TJ=80;function Kc(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,i=[];let s=0,o=0;const a=" > ",c=a.length;let l;const u=Array.isArray(t)?t:t.keyAttrs,d=!Array.isArray(t)&&t.maxStringLength||TJ;for(;n&&s++<r&&(l=_J(n,u),!(l==="html"||s>1&&o+i.length*c+l.length>=d));)i.push(l),o+=l.length,n=n.parentNode;return i.reverse().join(a)}catch{return"<unknown>"}}function _J(e,t){const n=e,r=[];let i,s,o,a,c;if(!n||!n.tagName)return"";if(hu.HTMLElement&&n instanceof HTMLElement&&n.dataset&&n.dataset.sentryComponent)return n.dataset.sentryComponent;r.push(n.tagName.toLowerCase());const l=t&&t.length?t.filter(d=>n.getAttribute(d)).map(d=>[d,n.getAttribute(d)]):null;if(l&&l.length)l.forEach(d=>{r.push(`[${d[0]}="${d[1]}"]`)});else if(n.id&&r.push(`#${n.id}`),i=n.className,i&&Us(i))for(s=i.split(/\s+/),c=0;c<s.length;c++)r.push(`.${s[c]}`);const u=["aria-label","type","name","title","alt"];for(c=0;c<u.length;c++)o=u[c],a=n.getAttribute(o),a&&r.push(`[${o}="${a}"]`);return r.join("")}function RJ(){try{return hu.document.location.href}catch{return""}}function xJ(e){return hu.document&&hu.document.querySelector?hu.document.querySelector(e):null}function tL(e){if(!hu.HTMLElement)return null;let t=e;const n=5;for(let r=0;r<n;r++){if(!t)return null;if(t instanceof HTMLElement&&t.dataset.sentryComponent)return t.dataset.sentryComponent;t=t.parentNode}return null}const ad=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,NJ="Sentry Logger ",LI=["debug","info","warn","error","log","assert","trace"],pm={};function Jc(e){if(!("console"in Je))return e();const t=Je.console,n={},r=Object.keys(pm);r.forEach(i=>{const s=pm[i];n[i]=t[i],t[i]=s});try{return e()}finally{r.forEach(i=>{t[i]=n[i]})}}function PJ(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return ad?LI.forEach(n=>{t[n]=(...r)=>{e&&Jc(()=>{Je.console[n](`${NJ}[${n}]:`,...r)})}}):LI.forEach(n=>{t[n]=()=>{}}),t}const K=PJ(),MJ=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function OJ(e){return e==="http"||e==="https"}function cd(e,t=!1){const{host:n,path:r,pass:i,port:s,projectId:o,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&i?`:${i}`:""}@${n}${s?`:${s}`:""}/${r&&`${r}/`}${o}`}function DJ(e){const t=MJ.exec(e);if(!t){Jc(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});return}const[n,r,i="",s,o="",a]=t.slice(1);let c="",l=a;const u=l.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),l=u.pop()),l){const d=l.match(/^\d+/);d&&(l=d[0])}return nL({host:s,pass:i,path:c,projectId:l,port:o,protocol:n,publicKey:r})}function nL(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function LJ(e){if(!ad)return!0;const{port:t,projectId:n,protocol:r}=e;return["protocol","publicKey","host","projectId"].find(o=>e[o]?!1:(K.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?OJ(r)?t&&isNaN(parseInt(t,10))?(K.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):!0:(K.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(K.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function rL(e){const t=typeof e=="string"?DJ(e):nL(e);if(!(!t||!LJ(t)))return t}class vs extends Error{constructor(t,n="warn"){super(t),this.message=t,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}}function _n(e,t,n){if(!(t in e))return;const r=e[t],i=n(r);typeof i=="function"&&iL(i,r),e[t]=i}function Yc(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{ad&&K.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function iL(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,Yc(e,"__sentry_original__",t)}catch{}}function Cw(e){return e.__sentry_original__}function BJ(e){return Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&")}function sL(e){if(pw(e))return{message:e.message,name:e.name,stack:e.stack,...sT(e)};if(Sv(e)){const t={type:e.type,target:iT(e.target),currentTarget:iT(e.currentTarget),...sT(e)};return typeof CustomEvent<"u"&&$o(e,CustomEvent)&&(t.detail=e.detail),t}else return e}function iT(e){try{return SJ(e)?Kc(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function sT(e){if(typeof e=="object"&&e!==null){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}else return{}}function FJ(e,t=40){const n=Object.keys(sL(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return fu(n[0],t);for(let r=n.length;r>0;r--){const i=n.slice(0,r).join(", ");if(!(i.length>t))return r===n.length?i:fu(i,t)}return""}function _r(e){return BI(e,new Map)}function BI(e,t){if(UJ(e)){const n=t.get(e);if(n!==void 0)return n;const r={};t.set(e,r);for(const i of Object.keys(e))typeof e[i]<"u"&&(r[i]=BI(e[i],t));return r}if(Array.isArray(e)){const n=t.get(e);if(n!==void 0)return n;const r=[];return t.set(e,r),e.forEach(i=>{r.push(BI(i,t))}),r}return e}function UJ(e){if(!Du(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||t==="Object"}catch{return!0}}const oL=50,oT=/\(error: (.*)\)/,aT=/captureMessage|captureException/;function aL(...e){const t=e.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0)=>{const i=[],s=n.split(`
`);for(let o=r;o<s.length;o++){const a=s[o];if(a.length>1024)continue;const c=oT.test(a)?a.replace(oT,"$1"):a;if(!c.match(/\S*Error: /)){for(const l of t){const u=l(c);if(u){i.push(u);break}}if(i.length>=oL)break}}return GJ(i)}}function VJ(e){return Array.isArray(e)?aL(...e):e}function GJ(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop(),t.reverse(),aT.test(t[t.length-1].function||"")&&(t.pop(),aT.test(t[t.length-1].function||"")&&t.pop()),t.slice(0,oL).map(n=>({...n,filename:n.filename||t[t.length-1].filename,function:n.function||"?"}))}const c0="<anonymous>";function zo(e){try{return!e||typeof e!="function"?c0:e.name||c0}catch{return c0}}const og={},cT={};function al(e,t){og[e]=og[e]||[],og[e].push(t)}function cl(e,t){cT[e]||(t(),cT[e]=!0)}function Ki(e,t){const n=e&&og[e];if(n)for(const r of n)try{r(t)}catch(i){ad&&K.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${zo(r)}
Error:`,i)}}function WJ(e){const t="console";al(t,e),cl(t,jJ)}function jJ(){"console"in Je&&LI.forEach(function(e){e in Je.console&&_n(Je.console,e,function(t){return pm[e]=t,function(...n){Ki("console",{args:n,level:e});const i=pm[e];i&&i.apply(Je.console,n)}})})}function Jt(){const e=Je,t=e.crypto||e.msCrypto;let n=()=>Math.random()*16;try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>{const r=new Uint8Array(1);return t.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(n()&15)>>r/4).toString(16))}function cL(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function Ca(e){const{message:t,event_id:n}=e;if(t)return t;const r=cL(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function FI(e,t,n){const r=e.exception=e.exception||{},i=r.values=r.values||[],s=i[0]=i[0]||{};s.value||(s.value=t||""),s.type||(s.type=n||"Error")}function Jf(e,t){const n=cL(e);if(!n)return;const r={type:"generic",handled:!0},i=n.mechanism;if(n.mechanism={...r,...i,...t},t&&"data"in t){const s={...i&&i.data,...t.data};n.mechanism.data=s}}function lT(e){if(e&&e.__sentry_captured__)return!0;try{Yc(e,"__sentry_captured__",!0)}catch{}return!1}function lL(e){return Array.isArray(e)?e:[e]}const wl=Je,HJ=1e3;let uT,UI,VI;function uL(e){const t="dom";al(t,e),cl(t,$J)}function $J(){if(!wl.document)return;const e=Ki.bind(null,"dom"),t=dT(e,!0);wl.document.addEventListener("click",t,!1),wl.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(n=>{const r=wl[n]&&wl[n].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(_n(r,"addEventListener",function(i){return function(s,o,a){if(s==="click"||s=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__=c.__sentry_instrumentation_handlers__||{},u=l[s]=l[s]||{refCount:0};if(!u.handler){const d=dT(e);u.handler=d,i.call(this,s,d,a)}u.refCount++}catch{}return i.call(this,s,o,a)}}),_n(r,"removeEventListener",function(i){return function(s,o,a){if(s==="click"||s=="keypress")try{const c=this,l=c.__sentry_instrumentation_handlers__||{},u=l[s];u&&(u.refCount--,u.refCount<=0&&(i.call(this,s,u.handler,a),u.handler=void 0,delete l[s]),Object.keys(l).length===0&&delete c.__sentry_instrumentation_handlers__)}catch{}return i.call(this,s,o,a)}}))})}function zJ(e){if(e.type!==UI)return!1;try{if(!e.target||e.target._sentryId!==VI)return!1}catch{}return!0}function ZJ(e,t){return e!=="keypress"?!1:!t||!t.tagName?!0:!(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable)}function dT(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const r=XJ(n);if(ZJ(n.type,r))return;Yc(n,"_sentryCaptured",!0),r&&!r._sentryId&&Yc(r,"_sentryId",Jt());const i=n.type==="keypress"?"input":n.type;zJ(n)||(e({event:n,name:i,global:t}),UI=n.type,VI=r?r._sentryId:void 0),clearTimeout(uT),uT=wl.setTimeout(()=>{VI=void 0,UI=void 0},HJ)}}function XJ(e){try{return e.target}catch{return null}}const GI=yw();function dL(){if(!("fetch"in GI))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function WI(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function KJ(){if(typeof EdgeRuntime=="string")return!0;if(!dL())return!1;if(WI(GI.fetch))return!0;let e=!1;const t=GI.document;if(t&&typeof t.createElement=="function")try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=WI(n.contentWindow.fetch)),t.head.removeChild(n)}catch(n){ad&&K.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return e}function Iw(e){const t="fetch";al(t,e),cl(t,JJ)}function JJ(){KJ()&&_n(Je,"fetch",function(e){return function(...t){const{method:n,url:r}=YJ(t),i={args:t,fetchData:{method:n,url:r},startTimestamp:Date.now()};return Ki("fetch",{...i}),e.apply(Je,t).then(s=>{const o={...i,endTimestamp:Date.now(),response:s};return Ki("fetch",o),s},s=>{const o={...i,endTimestamp:Date.now(),error:s};throw Ki("fetch",o),s})}})}function jI(e,t){return!!e&&typeof e=="object"&&!!e[t]}function fT(e){return typeof e=="string"?e:e?jI(e,"url")?e.url:e.toString?e.toString():"":""}function YJ(e){if(e.length===0)return{method:"GET",url:""};if(e.length===2){const[n,r]=e;return{url:fT(n),method:jI(r,"method")?String(r.method).toUpperCase():"GET"}}const t=e[0];return{url:fT(t),method:jI(t,"method")?String(t.method).toUpperCase():"GET"}}let dp=null;function fL(e){const t="error";al(t,e),cl(t,qJ)}function qJ(){dp=Je.onerror,Je.onerror=function(e,t,n,r,i){return Ki("error",{column:r,error:i,line:n,msg:e,url:t}),dp&&!dp.__SENTRY_LOADER__?dp.apply(this,arguments):!1},Je.onerror.__SENTRY_INSTRUMENTED__=!0}let fp=null;function hL(e){const t="unhandledrejection";al(t,e),cl(t,QJ)}function QJ(){fp=Je.onunhandledrejection,Je.onunhandledrejection=function(e){return Ki("unhandledrejection",e),fp&&!fp.__SENTRY_LOADER__?fp.apply(this,arguments):!0},Je.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const hp=yw();function eY(){const e=hp.chrome,t=e&&e.app&&e.app.runtime,n="history"in hp&&!!hp.history.pushState&&!!hp.history.replaceState;return!t&&n}const Rd=Je;let pp;function wv(e){const t="history";al(t,e),cl(t,tY)}function tY(){if(!eY())return;const e=Rd.onpopstate;Rd.onpopstate=function(...n){const r=Rd.location.href,i=pp;if(pp=r,Ki("history",{from:i,to:r}),e)try{return e.apply(this,n)}catch{}};function t(n){return function(...r){const i=r.length>2?r[2]:void 0;if(i){const s=pp,o=String(i);pp=o,Ki("history",{from:s,to:o})}return n.apply(this,r)}}_n(Rd.history,"pushState",t),_n(Rd.history,"replaceState",t)}const nY=Je,Na="__sentry_xhr_v3__";function Sw(e){const t="xhr";al(t,e),cl(t,rY)}function rY(){if(!nY.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;_n(e,"open",function(t){return function(...n){const r=Date.now(),i=Us(n[0])?n[0].toUpperCase():void 0,s=iY(n[1]);if(!i||!s)return t.apply(this,n);this[Na]={method:i,url:s,request_headers:{}},i==="POST"&&s.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const o=()=>{const a=this[Na];if(a&&this.readyState===4){try{a.status_code=this.status}catch{}const c={args:[i,s],endTimestamp:Date.now(),startTimestamp:r,xhr:this};Ki("xhr",c)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?_n(this,"onreadystatechange",function(a){return function(...c){return o(),a.apply(this,c)}}):this.addEventListener("readystatechange",o),_n(this,"setRequestHeader",function(a){return function(...c){const[l,u]=c,d=this[Na];return d&&Us(l)&&Us(u)&&(d.request_headers[l.toLowerCase()]=u),a.apply(this,c)}}),t.apply(this,n)}}),_n(e,"send",function(t){return function(...n){const r=this[Na];if(!r)return t.apply(this,n);n[0]!==void 0&&(r.body=n[0]);const i={args:[r.method,r.url],startTimestamp:Date.now(),xhr:this};return Ki("xhr",i),t.apply(this,n)}})}function iY(e){if(Us(e))return e;try{return e.toString()}catch{}}function sY(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function oY(){return"npm"}function aY(){return!sY()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function hT(){return typeof window<"u"&&(!aY()||cY())}function cY(){return Je.process!==void 0&&Je.process.type==="renderer"}function lY(){const e=typeof WeakSet=="function",t=e?new WeakSet:[];function n(i){if(e)return t.has(i)?!0:(t.add(i),!1);for(let s=0;s<t.length;s++)if(t[s]===i)return!0;return t.push(i),!1}function r(i){if(e)t.delete(i);else for(let s=0;s<t.length;s++)if(t[s]===i){t.splice(s,1);break}}return[n,r]}function hs(e,t=100,n=1/0){try{return HI("",e,t,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function pL(e,t=3,n=100*1024){const r=hs(e,t);return hY(r)>n?pL(e,t-1,n):r}function HI(e,t,n=1/0,r=1/0,i=lY()){const[s,o]=i;if(t==null||["number","boolean","string"].includes(typeof t)&&!qD(t))return t;const a=uY(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const c=typeof t.__sentry_override_normalization_depth__=="number"?t.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(s(t))return"[Circular ~]";const l=t;if(l&&typeof l.toJSON=="function")try{const h=l.toJSON();return HI("",h,c-1,r,i)}catch{}const u=Array.isArray(t)?[]:{};let d=0;const f=sL(t);for(const h in f){if(!Object.prototype.hasOwnProperty.call(f,h))continue;if(d>=r){u[h]="[MaxProperties ~]";break}const p=f[h];u[h]=HI(h,p,c-1,r,i),d++}return o(t),u}function uY(e,t){try{if(e==="domain"&&t&&typeof t=="object"&&t._events)return"[Domain]";if(e==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&t===global)return"[Global]";if(typeof window<"u"&&t===window)return"[Window]";if(typeof document<"u"&&t===document)return"[Document]";if(QD(t))return"[VueViewModel]";if(wJ(t))return"[SyntheticEvent]";if(typeof t=="number"&&t!==t)return"[NaN]";if(typeof t=="function")return`[Function: ${zo(t)}]`;if(typeof t=="symbol")return`[${String(t)}]`;if(typeof t=="bigint")return`[BigInt: ${String(t)}]`;const n=dY(t);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function dY(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}function fY(e){return~-encodeURI(e).split(/%..|./).length}function hY(e){return fY(JSON.stringify(e))}var qs;(function(e){e[e.PENDING=0]="PENDING";const n=1;e[e.RESOLVED=n]="RESOLVED";const r=2;e[e.REJECTED=r]="REJECTED"})(qs||(qs={}));function Lu(e){return new Xr(t=>{t(e)})}function bw(e){return new Xr((t,n)=>{n(e)})}class Xr{constructor(t){Xr.prototype.__init.call(this),Xr.prototype.__init2.call(this),Xr.prototype.__init3.call(this),Xr.prototype.__init4.call(this),this._state=qs.PENDING,this._handlers=[];try{t(this._resolve,this._reject)}catch(n){this._reject(n)}}then(t,n){return new Xr((r,i)=>{this._handlers.push([!1,s=>{if(!t)r(s);else try{r(t(s))}catch(o){i(o)}},s=>{if(!n)i(s);else try{r(n(s))}catch(o){i(o)}}]),this._executeHandlers()})}catch(t){return this.then(n=>n,t)}finally(t){return new Xr((n,r)=>{let i,s;return this.then(o=>{s=!1,i=o,t&&t()},o=>{s=!0,i=o,t&&t()}).then(()=>{if(s){r(i);return}n(i)})})}__init(){this._resolve=t=>{this._setResult(qs.RESOLVED,t)}}__init2(){this._reject=t=>{this._setResult(qs.REJECTED,t)}}__init3(){this._setResult=(t,n)=>{if(this._state===qs.PENDING){if(bv(n)){n.then(this._resolve,this._reject);return}this._state=t,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===qs.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach(n=>{n[0]||(this._state===qs.RESOLVED&&n[1](this._value),this._state===qs.REJECTED&&n[2](this._value),n[0]=!0)})}}}function pY(e){const t=[];function n(){return e===void 0||t.length<e}function r(o){return t.splice(t.indexOf(o),1)[0]}function i(o){if(!n())return bw(new vs("Not adding Promise because buffer limit was reached."));const a=o();return t.indexOf(a)===-1&&t.push(a),a.then(()=>r(a)).then(null,()=>r(a).then(null,()=>{})),a}function s(o){return new Xr((a,c)=>{let l=t.length;if(!l)return a(!0);const u=setTimeout(()=>{o&&o>0&&a(!1)},o);t.forEach(d=>{Lu(d).then(()=>{--l||(clearTimeout(u),a(!0))},c)})})}return{$:t,add:i,drain:s}}function ag(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}const gY=["fatal","error","warning","log","info","debug"];function mY(e){return e==="warn"?"warning":gY.includes(e)?e:"log"}const gL=1e3;function Th(){return Date.now()/gL}function vY(){const{performance:e}=Je;if(!e||!e.now)return Th;const t=Date.now()-e.now(),n=e.timeOrigin==null?t:e.timeOrigin;return()=>(n+e.now())/gL}const _h=vY(),Qi=(()=>{const{performance:e}=Je;if(!e||!e.now)return;const t=3600*1e3,n=e.now(),r=Date.now(),i=e.timeOrigin?Math.abs(e.timeOrigin+n-r):t,s=i<t,o=e.timing&&e.timing.navigationStart,c=typeof o=="number"?Math.abs(o+n-r):t,l=c<t;return s||l?i<=c?e.timeOrigin:o:r})(),$I="baggage",mL="sentry-",yY=/^sentry-/,CY=8192;function IY(e){if(!Us(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce((r,i)=>{const s=pT(i);for(const o of Object.keys(s))r[o]=s[o];return r},{});else{if(!e)return;t=pT(e)}const n=Object.entries(t).reduce((r,[i,s])=>{if(i.match(yY)){const o=i.slice(mL.length);r[o]=s}return r},{});if(Object.keys(n).length>0)return n}function vL(e){if(!e)return;const t=Object.entries(e).reduce((n,[r,i])=>(i&&(n[`${mL}${r}`]=i),n),{});return SY(t)}function pT(e){return e.split(",").map(t=>t.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((t,[n,r])=>(t[n]=r,t),{})}function SY(e){if(Object.keys(e).length!==0)return Object.entries(e).reduce((t,[n,r],i)=>{const s=`${encodeURIComponent(n)}=${encodeURIComponent(r)}`,o=i===0?s:`${t},${s}`;return o.length>CY?(ad&&K.warn(`Not adding key: ${n} with val: ${r} to baggage header due to exceeding baggage size limits.`),t):o},"")}const bY=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function wY(e){if(!e)return;const t=e.match(bY);if(!t)return;let n;return t[3]==="1"?n=!0:t[3]==="0"&&(n=!1),{traceId:t[1],parentSampled:n,parentSpanId:t[2]}}function kY(e,t){const n=wY(e),r=IY(t),{traceId:i,parentSpanId:s,parentSampled:o}=n||{};return n?{traceId:i||Jt(),parentSpanId:s||Jt().substring(16),spanId:Jt().substring(16),sampled:o,dsc:r||{}}:{traceId:i||Jt(),spanId:Jt().substring(16)}}function ww(e=Jt(),t=Jt().substring(16),n){let r="";return n!==void 0&&(r=n?"-1":"-0"),`${e}-${t}${r}`}function ll(e,t=[]){return[e,t]}function AY(e,t){const[n,r]=e;return[n,[...r,t]]}function gT(e,t){const n=e[1];for(const r of n){const i=r[0].type;if(t(r,i))return!0}return!1}function zI(e,t){return(t||new TextEncoder).encode(e)}function EY(e,t){const[n,r]=e;let i=JSON.stringify(n);function s(o){typeof i=="string"?i=typeof o=="string"?i+o:[zI(i,t),o]:i.push(typeof o=="string"?zI(o,t):o)}for(const o of r){const[a,c]=o;if(s(`
${JSON.stringify(a)}
`),typeof c=="string"||c instanceof Uint8Array)s(c);else{let l;try{l=JSON.stringify(c)}catch{l=JSON.stringify(hs(c))}s(l)}}return typeof i=="string"?i:TY(i)}function TY(e){const t=e.reduce((i,s)=>i+s.length,0),n=new Uint8Array(t);let r=0;for(const i of e)n.set(i,r),r+=i.length;return n}function _Y(e,t){const n=typeof e.data=="string"?zI(e.data,t):e.data;return[_r({type:"attachment",length:n.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),n]}const RY={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",statsd:"unknown"};function mT(e){return RY[e]}function kw(e){if(!e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function yL(e,t,n,r){const i=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:new Date().toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:cd(r)},...i&&{trace:_r({...i})}}}function xY(e,t,n){const r=[{type:"client_report"},{timestamp:n||Th(),discarded_events:e}];return ll(t?{dsn:t}:{},[r])}const NY=60*1e3;function PY(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${e}`);return isNaN(r)?NY:r-t}function MY(e,t){return e[t]||e.all||0}function CL(e,t,n=Date.now()){return MY(e,t)>n}function IL(e,{statusCode:t,headers:n},r=Date.now()){const i={...e},s=n&&n["x-sentry-rate-limits"],o=n&&n["retry-after"];if(s)for(const a of s.trim().split(",")){const[c,l]=a.split(":",2),u=parseInt(c,10),d=(isNaN(u)?60:u)*1e3;if(!l)i.all=r+d;else for(const f of l.split(";"))i[f]=r+d}else o?i.all=r+PY(o,r):t===429&&(i.all=r+60*1e3);return i}function OY(e,t){return e??t()}function l0(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,(i==="optionalAccess"||i==="optionalCall")&&n==null)return;i==="access"||i==="optionalAccess"?(t=n,n=s(n)):(i==="call"||i==="optionalCall")&&(n=s((...o)=>n.call(t,...o)),t=void 0)}return n}const be=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,kv="production";function Aw(){return eL("globalEventProcessors",()=>[])}function DY(e){Aw().push(e)}function gm(e,t,n,r=0){return new Xr((i,s)=>{const o=e[r];if(t===null||typeof o!="function")i(t);else{const a=o({...t},n);be&&o.id&&a===null&&K.log(`Event processor "${o.id}" dropped event`),bv(a)?a.then(c=>gm(e,c,n,r+1).then(i)).then(null,s):gm(e,a,n,r+1).then(i).then(null,s)}})}function SL(e){const t=_h(),n={sid:Jt(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>LY(n)};return e&&qc(n,e),n}function qc(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),!e.did&&!t.did&&(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||_h(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=t.sid.length===32?t.sid:Jt()),t.init!==void 0&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),typeof t.started=="number"&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if(typeof t.duration=="number")e.duration=t.duration;else{const n=e.timestamp-e.started;e.duration=n>=0?n:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),typeof t.errors=="number"&&(e.errors=t.errors),t.status&&(e.status=t.status)}function bL(e,t){let n={};t?n={status:t}:e.status==="ok"&&(n={status:"exited"}),qc(e,n)}function LY(e){return _r({sid:`${e.sid}`,init:e.init,started:new Date(e.started*1e3).toISOString(),timestamp:new Date(e.timestamp*1e3).toISOString(),status:e.status,errors:e.errors,did:typeof e.did=="number"||typeof e.did=="string"?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}const BY=0,wL=1;function Ew(e){const{spanId:t,traceId:n}=e.spanContext(),{data:r,op:i,parent_span_id:s,status:o,tags:a,origin:c}=$n(e);return _r({data:r,op:i,parent_span_id:s,span_id:t,status:o,tags:a,trace_id:n,origin:c})}function Av(e){const{traceId:t,spanId:n}=e.spanContext(),r=kL(e);return ww(t,n,r)}function Ev(e){return typeof e=="number"?vT(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?vT(e.getTime()):_h()}function vT(e){return e>9999999999?e/1e3:e}function $n(e){return FY(e)?e.getSpanJSON():typeof e.toJSON=="function"?e.toJSON():{}}function FY(e){return typeof e.getSpanJSON=="function"}function kL(e){const{traceFlags:t}=e.spanContext();return!!(t&wL)}function AL(e,t,n,r,i,s){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=e,c={...t,event_id:t.event_id||n.event_id||Jt(),timestamp:t.timestamp||Th()},l=n.integrations||e.integrations.map(y=>y.name);UY(c,e),WY(c,l),t.type===void 0&&VY(c,e.stackParser);const u=HY(r,n.captureContext);n.mechanism&&Jf(c,n.mechanism);const d=i&&i.getEventProcessors?i.getEventProcessors():[],f=nq().getScopeData();if(s){const y=s.getScopeData();ST(f,y)}if(u){const y=u.getScopeData();ST(f,y)}const h=[...n.attachments||[],...f.attachments];h.length&&(n.attachments=h),xL(c,f);const p=[...d,...Aw(),...f.eventProcessors];return gm(p,c,n).then(y=>(y&&GY(y),typeof o=="number"&&o>0?jY(y,o,a):y))}function UY(e,t){const{environment:n,release:r,dist:i,maxValueLength:s=250}=t;"environment"in e||(e.environment="environment"in t?n:kv),e.release===void 0&&r!==void 0&&(e.release=r),e.dist===void 0&&i!==void 0&&(e.dist=i),e.message&&(e.message=fu(e.message,s));const o=e.exception&&e.exception.values&&e.exception.values[0];o&&o.value&&(o.value=fu(o.value,s));const a=e.request;a&&a.url&&(a.url=fu(a.url,s))}const yT=new WeakMap;function VY(e,t){const n=Je._sentryDebugIds;if(!n)return;let r;const i=yT.get(t);i?r=i:(r=new Map,yT.set(t,r));const s=Object.keys(n).reduce((o,a)=>{let c;const l=r.get(a);l?c=l:(c=t(a),r.set(a,c));for(let u=c.length-1;u>=0;u--){const d=c[u];if(d.filename){o[d.filename]=n[a];break}}return o},{});try{e.exception.values.forEach(o=>{o.stacktrace.frames.forEach(a=>{a.filename&&(a.debug_id=s[a.filename])})})}catch{}}function GY(e){const t={};try{e.exception.values.forEach(r=>{r.stacktrace.frames.forEach(i=>{i.debug_id&&(i.abs_path?t[i.abs_path]=i.debug_id:i.filename&&(t[i.filename]=i.debug_id),delete i.debug_id)})})}catch{}if(Object.keys(t).length===0)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.keys(t).forEach(r=>{n.push({type:"sourcemap",code_file:r,debug_id:t[r]})})}function WY(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}function jY(e,t,n){if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(i=>({...i,...i.data&&{data:hs(i.data,t,n)}}))},...e.user&&{user:hs(e.user,t,n)},...e.contexts&&{contexts:hs(e.contexts,t,n)},...e.extra&&{extra:hs(e.extra,t,n)}};return e.contexts&&e.contexts.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=hs(e.contexts.trace.data,t,n))),e.spans&&(r.spans=e.spans.map(i=>{const s=$n(i).data;return s&&(i.data=hs(s,t,n)),i})),r}function HY(e,t){if(!t)return e;const n=e?e.clone():new Ds;return n.update(t),n}function $Y(e){if(e)return zY(e)?{captureContext:e}:XY(e)?{captureContext:e}:e}function zY(e){return e instanceof Ds||typeof e=="function"}const ZY=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function XY(e){return Object.keys(e).some(t=>ZY.includes(t))}function Tv(e,t){return Dr().captureException(e,$Y(t))}function EL(e,t){return Dr().captureEvent(e,t)}function Ya(e,t){Dr().addBreadcrumb(e,t)}function KY(e,t){Dr().setContext(e,t)}function TL(...e){const t=Dr();if(e.length===2){const[n,r]=e;return n?t.withScope(()=>(t.getStackTop().scope=n,r(n))):t.withScope(r)}return t.withScope(e[0])}function ut(){return Dr().getClient()}function Ii(){return Dr().getScope()}function CT(e){const t=ut(),n=ac(),r=Ii(),{release:i,environment:s=kv}=t&&t.getOptions()||{},{userAgent:o}=Je.navigator||{},a=SL({release:i,environment:s,user:r.getUser()||n.getUser(),...o&&{userAgent:o},...e}),c=n.getSession();return c&&c.status==="ok"&&qc(c,{status:"exited"}),_L(),n.setSession(a),r.setSession(a),a}function _L(){const e=ac(),t=Ii(),n=t.getSession()||e.getSession();n&&bL(n),RL(),e.setSession(),t.setSession()}function RL(){const e=ac(),t=Ii(),n=ut(),r=t.getSession()||e.getSession();r&&n&&n.captureSession&&n.captureSession(r)}function IT(e=!1){if(e){_L();return}RL()}function mm(e){return e.transaction}function _v(e,t,n){const r=t.getOptions(),{publicKey:i}=t.getDsn()||{},{segment:s}=n&&n.getUser()||{},o=_r({environment:r.environment||kv,release:r.release,user_segment:s,public_key:i,trace_id:e});return t.emit&&t.emit("createDsc",o),o}function Yf(e){const t=ut();if(!t)return{};const n=_v($n(e).trace_id||"",t,Ii()),r=mm(e);if(!r)return n;const i=r&&r._frozenDynamicSamplingContext;if(i)return i;const{sampleRate:s,source:o}=r.metadata;s!=null&&(n.sample_rate=`${s}`);const a=$n(r);return o&&o!=="url"&&(n.transaction=a.description),n.sampled=String(kL(r)),t.emit&&t.emit("createDsc",n),n}function xL(e,t){const{fingerprint:n,span:r,breadcrumbs:i,sdkProcessingMetadata:s}=t;JY(e,t),r&&QY(e,r),eq(e,n),YY(e,i),qY(e,s)}function ST(e,t){const{extra:n,tags:r,user:i,contexts:s,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:l,eventProcessors:u,attachments:d,propagationContext:f,transactionName:h,span:p}=t;xd(e,"extra",n),xd(e,"tags",r),xd(e,"user",i),xd(e,"contexts",s),xd(e,"sdkProcessingMetadata",a),o&&(e.level=o),h&&(e.transactionName=h),p&&(e.span=p),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),l.length&&(e.fingerprint=[...e.fingerprint,...l]),u.length&&(e.eventProcessors=[...e.eventProcessors,...u]),d.length&&(e.attachments=[...e.attachments,...d]),e.propagationContext={...e.propagationContext,...f}}function xd(e,t,n){if(n&&Object.keys(n).length){e[t]={...e[t]};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[t][r]=n[r])}}function JY(e,t){const{extra:n,tags:r,user:i,contexts:s,level:o,transactionName:a}=t,c=_r(n);c&&Object.keys(c).length&&(e.extra={...c,...e.extra});const l=_r(r);l&&Object.keys(l).length&&(e.tags={...l,...e.tags});const u=_r(i);u&&Object.keys(u).length&&(e.user={...u,...e.user});const d=_r(s);d&&Object.keys(d).length&&(e.contexts={...d,...e.contexts}),o&&(e.level=o),a&&(e.transaction=a)}function YY(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}function qY(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}function QY(e,t){e.contexts={trace:Ew(t),...e.contexts};const n=mm(t);if(n){e.sdkProcessingMetadata={dynamicSamplingContext:Yf(t),...e.sdkProcessingMetadata};const r=$n(n).description;r&&(e.tags={transaction:r,...e.tags})}}function eq(e,t){e.fingerprint=e.fingerprint?lL(e.fingerprint):[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}const tq=100;let u0;class Ds{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=bT()}static clone(t){return t?t.clone():new Ds}clone(){const t=new Ds;return t._breadcrumbs=[...this._breadcrumbs],t._tags={...this._tags},t._extra={...this._extra},t._contexts={...this._contexts},t._user=this._user,t._level=this._level,t._span=this._span,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._requestSession=this._requestSession,t._attachments=[...this._attachments],t._sdkProcessingMetadata={...this._sdkProcessingMetadata},t._propagationContext={...this._propagationContext},t._client=this._client,t}setClient(t){this._client=t}getClient(){return this._client}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&qc(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(t){return this._requestSession=t,this}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,n){return this._tags={...this._tags,[t]:n},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,n){return this._extra={...this._extra,[t]:n},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,n){return n===null?delete this._contexts[t]:this._contexts[t]=n,this._notifyScopeListeners(),this}setSpan(t){return this._span=t,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const t=this._span;return t&&t.transaction}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;if(typeof t=="function"){const n=t(this);return n instanceof Ds?n:this}return t instanceof Ds?(this._tags={...this._tags,...t._tags},this._extra={...this._extra,...t._extra},this._contexts={...this._contexts,...t._contexts},t._user&&Object.keys(t._user).length&&(this._user=t._user),t._level&&(this._level=t._level),t._fingerprint&&(this._fingerprint=t._fingerprint),t._requestSession&&(this._requestSession=t._requestSession),t._propagationContext&&(this._propagationContext=t._propagationContext)):Du(t)&&(t=t,this._tags={...this._tags,...t.tags},this._extra={...this._extra,...t.extra},this._contexts={...this._contexts,...t.contexts},t.user&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint&&(this._fingerprint=t.fingerprint),t.requestSession&&(this._requestSession=t.requestSession),t.propagationContext&&(this._propagationContext=t.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=bT(),this}addBreadcrumb(t,n){const r=typeof n=="number"?n:tq;if(r<=0)return this;const i={timestamp:Th(),...t},s=this._breadcrumbs;return s.push(i),this._breadcrumbs=s.length>r?s.slice(-r):s,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:t,_attachments:n,_contexts:r,_tags:i,_extra:s,_user:o,_level:a,_fingerprint:c,_eventProcessors:l,_propagationContext:u,_sdkProcessingMetadata:d,_transactionName:f,_span:h}=this;return{breadcrumbs:t,attachments:n,contexts:r,tags:i,extra:s,user:o,level:a,fingerprint:c||[],eventProcessors:l,propagationContext:u,sdkProcessingMetadata:d,transactionName:f,span:h}}applyToEvent(t,n={},r=[]){xL(t,this.getScopeData());const i=[...r,...Aw(),...this._eventProcessors];return gm(i,t,n)}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...t},this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,n){const r=n&&n.event_id?n.event_id:Jt();if(!this._client)return K.warn("No client configured on scope - will not capture exception!"),r;const i=new Error("Sentry syntheticException");return this._client.captureException(t,{originalException:t,syntheticException:i,...n,event_id:r},this),r}captureMessage(t,n,r){const i=r&&r.event_id?r.event_id:Jt();if(!this._client)return K.warn("No client configured on scope - will not capture message!"),i;const s=new Error(t);return this._client.captureMessage(t,n,{originalException:t,syntheticException:s,...r,event_id:i},this),i}captureEvent(t,n){const r=n&&n.event_id?n.event_id:Jt();return this._client?(this._client.captureEvent(t,{...n,event_id:r},this),r):(K.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}}function nq(){return u0||(u0=new Ds),u0}function bT(){return{traceId:Jt(),spanId:Jt().substring(16)}}const ZI="7.100.1",NL=parseFloat(ZI),rq=100;class PL{constructor(t,n,r,i=NL){this._version=i;let s;n?s=n:(s=new Ds,s.setClient(t));let o;r?o=r:(o=new Ds,o.setClient(t)),this._stack=[{scope:s}],t&&this.bindClient(t),this._isolationScope=o}isOlderThan(t){return this._version<t}bindClient(t){const n=this.getStackTop();n.client=t,n.scope.setClient(t),t&&t.setupIntegrations&&t.setupIntegrations()}pushScope(){const t=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:t}),t}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(t){const n=this.pushScope();let r;try{r=t(n)}catch(i){throw this.popScope(),i}return bv(r)?r.then(i=>(this.popScope(),i),i=>{throw this.popScope(),i}):(this.popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(t,n){const r=this._lastEventId=n&&n.event_id?n.event_id:Jt(),i=new Error("Sentry syntheticException");return this.getScope().captureException(t,{originalException:t,syntheticException:i,...n,event_id:r}),r}captureMessage(t,n,r){const i=this._lastEventId=r&&r.event_id?r.event_id:Jt(),s=new Error(t);return this.getScope().captureMessage(t,n,{originalException:t,syntheticException:s,...r,event_id:i}),i}captureEvent(t,n){const r=n&&n.event_id?n.event_id:Jt();return t.type||(this._lastEventId=r),this.getScope().captureEvent(t,{...n,event_id:r}),r}lastEventId(){return this._lastEventId}addBreadcrumb(t,n){const{scope:r,client:i}=this.getStackTop();if(!i)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:o=rq}=i.getOptions&&i.getOptions()||{};if(o<=0)return;const c={timestamp:Th(),...t},l=s?Jc(()=>s(c,n)):c;l!==null&&(i.emit&&i.emit("beforeAddBreadcrumb",l,n),r.addBreadcrumb(l,o))}setUser(t){this.getScope().setUser(t),this.getIsolationScope().setUser(t)}setTags(t){this.getScope().setTags(t),this.getIsolationScope().setTags(t)}setExtras(t){this.getScope().setExtras(t),this.getIsolationScope().setExtras(t)}setTag(t,n){this.getScope().setTag(t,n),this.getIsolationScope().setTag(t,n)}setExtra(t,n){this.getScope().setExtra(t,n),this.getIsolationScope().setExtra(t,n)}setContext(t,n){this.getScope().setContext(t,n),this.getIsolationScope().setContext(t,n)}configureScope(t){const{scope:n,client:r}=this.getStackTop();r&&t(n)}run(t){const n=wT(this);try{t(this)}finally{wT(n)}}getIntegration(t){const n=this.getClient();if(!n)return null;try{return n.getIntegration(t)}catch{return be&&K.warn(`Cannot retrieve integration ${t.id} from the current Hub`),null}}startTransaction(t,n){const r=this._callExtensionMethod("startTransaction",t,n);return be&&!r&&(this.getClient()?K.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):K.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),r}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(t=!1){if(t)return this.endSession();this._sendSessionUpdate()}endSession(){const n=this.getStackTop().scope,r=n.getSession();r&&bL(r),this._sendSessionUpdate(),n.setSession()}startSession(t){const{scope:n,client:r}=this.getStackTop(),{release:i,environment:s=kv}=r&&r.getOptions()||{},{userAgent:o}=Je.navigator||{},a=SL({release:i,environment:s,user:n.getUser(),...o&&{userAgent:o},...t}),c=n.getSession&&n.getSession();return c&&c.status==="ok"&&qc(c,{status:"exited"}),this.endSession(),n.setSession(a),a}shouldSendDefaultPii(){const t=this.getClient(),n=t&&t.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){const{scope:t,client:n}=this.getStackTop(),r=t.getSession();r&&n&&n.captureSession&&n.captureSession(r)}_callExtensionMethod(t,...n){const i=Rh().__SENTRY__;if(i&&i.extensions&&typeof i.extensions[t]=="function")return i.extensions[t].apply(this,n);be&&K.warn(`Extension method ${t} couldn't be found, doing nothing.`)}}function Rh(){return Je.__SENTRY__=Je.__SENTRY__||{extensions:{},hub:void 0},Je}function wT(e){const t=Rh(),n=XI(t);return ML(t,e),n}function Dr(){const e=Rh();if(e.__SENTRY__&&e.__SENTRY__.acs){const t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return iq(e)}function ac(){return Dr().getIsolationScope()}function iq(e=Rh()){return(!sq(e)||XI(e).isOlderThan(NL))&&ML(e,new PL),XI(e)}function sq(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function XI(e){return eL("hub",()=>new PL,e)}function ML(e,t){if(!e)return!1;const n=e.__SENTRY__=e.__SENTRY__||{};return n.hub=t,!0}function ld(e){return(e||Dr()).getScope().getTransaction()}let kT=!1;function oq(){kT||(kT=!0,fL(KI),hL(KI))}function KI(){const e=ld();if(e){const t="internal_error";be&&K.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}KI.tag="sentry_tracingErrorCallback";const Oc="sentry.source",Wl="sentry.sample_rate",gp="sentry.op",jl="sentry.origin";var AT;(function(e){const t="ok";e.Ok=t;const n="deadline_exceeded";e.DeadlineExceeded=n;const r="unauthenticated";e.Unauthenticated=r;const i="permission_denied";e.PermissionDenied=i;const s="not_found";e.NotFound=s;const o="resource_exhausted";e.ResourceExhausted=o;const a="invalid_argument";e.InvalidArgument=a;const c="unimplemented";e.Unimplemented=c;const l="unavailable";e.Unavailable=l;const u="internal_error";e.InternalError=u;const d="unknown_error";e.UnknownError=d;const f="cancelled";e.Cancelled=f;const h="already_exists";e.AlreadyExists=h;const p="failed_precondition";e.FailedPrecondition=p;const m="aborted";e.Aborted=m;const y="out_of_range";e.OutOfRange=y;const g="data_loss";e.DataLoss=g})(AT||(AT={}));function aq(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}function Tw(e,t){e.setTag("http.status_code",String(t)),e.setData("http.response.status_code",t);const n=aq(t);n!=="unknown_error"&&e.setStatus(n)}class OL{constructor(t=1e3){this._maxlen=t,this.spans=[]}add(t){this.spans.length>this._maxlen?t.spanRecorder=void 0:this.spans.push(t)}}class _w{constructor(t={}){this._traceId=t.traceId||Jt(),this._spanId=t.spanId||Jt().substring(16),this._startTime=t.startTimestamp||_h(),this.tags=t.tags?{...t.tags}:{},this.data=t.data?{...t.data}:{},this.instrumenter=t.instrumenter||"sentry",this._attributes={},this.setAttributes({[jl]:t.origin||"manual",[gp]:t.op,...t.attributes}),this._name=t.name||t.description,t.parentSpanId&&(this._parentSpanId=t.parentSpanId),"sampled"in t&&(this._sampled=t.sampled),t.status&&(this._status=t.status),t.endTimestamp&&(this._endTime=t.endTimestamp)}get name(){return this._name||""}set name(t){this.updateName(t)}get description(){return this._name}set description(t){this._name=t}get traceId(){return this._traceId}set traceId(t){this._traceId=t}get spanId(){return this._spanId}set spanId(t){this._spanId=t}set parentSpanId(t){this._parentSpanId=t}get parentSpanId(){return this._parentSpanId}get sampled(){return this._sampled}set sampled(t){this._sampled=t}get attributes(){return this._attributes}set attributes(t){this._attributes=t}get startTimestamp(){return this._startTime}set startTimestamp(t){this._startTime=t}get endTimestamp(){return this._endTime}set endTimestamp(t){this._endTime=t}get status(){return this._status}set status(t){this._status=t}get op(){return this._attributes[gp]}set op(t){this.setAttribute(gp,t)}get origin(){return this._attributes[jl]}set origin(t){this.setAttribute(jl,t)}spanContext(){const{_spanId:t,_traceId:n,_sampled:r}=this;return{spanId:t,traceId:n,traceFlags:r?wL:BY}}startChild(t){const n=new _w({...t,parentSpanId:this._spanId,sampled:this._sampled,traceId:this._traceId});n.spanRecorder=this.spanRecorder,n.spanRecorder&&n.spanRecorder.add(n);const r=mm(this);if(n.transaction=r,be&&r){const i=t&&t.op||"< unknown op >",s=$n(n).description||"< unknown name >",o=r.spanContext().spanId,a=`[Tracing] Starting '${i}' span on transaction '${s}' (${o}).`;K.log(a),this._logMessage=a}return n}setTag(t,n){return this.tags={...this.tags,[t]:n},this}setData(t,n){return this.data={...this.data,[t]:n},this}setAttribute(t,n){n===void 0?delete this._attributes[t]:this._attributes[t]=n}setAttributes(t){Object.keys(t).forEach(n=>this.setAttribute(n,t[n]))}setStatus(t){return this._status=t,this}setHttpStatus(t){return Tw(this,t),this}setName(t){this.updateName(t)}updateName(t){return this._name=t,this}isSuccess(){return this._status==="ok"}finish(t){return this.end(t)}end(t){if(this._endTime)return;const n=mm(this);if(be&&n&&n.spanContext().spanId!==this._spanId){const r=this._logMessage;r&&K.log(r.replace("Starting","Finishing"))}this._endTime=Ev(t)}toTraceparent(){return Av(this)}toContext(){return _r({data:this._getData(),description:this._name,endTimestamp:this._endTime,op:this.op,parentSpanId:this._parentSpanId,sampled:this._sampled,spanId:this._spanId,startTimestamp:this._startTime,status:this._status,tags:this.tags,traceId:this._traceId})}updateWithContext(t){return this.data=t.data||{},this._name=t.name||t.description,this._endTime=t.endTimestamp,this.op=t.op,this._parentSpanId=t.parentSpanId,this._sampled=t.sampled,this._spanId=t.spanId||this._spanId,this._startTime=t.startTimestamp||this._startTime,this._status=t.status,this.tags=t.tags||{},this._traceId=t.traceId||this._traceId,this}getTraceContext(){return Ew(this)}getSpanJSON(){return _r({data:this._getData(),description:this._name,op:this._attributes[gp],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:this._status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[jl]})}isRecording(){return!this._endTime&&!!this._sampled}toJSON(){return this.getSpanJSON()}_getData(){const{data:t,_attributes:n}=this,r=Object.keys(t).length>0,i=Object.keys(n).length>0;if(!(!r&&!i))return r&&i?{...t,...n}:r?t:n}}function Rv(e){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const t=ut(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function DL(e){if(!Rv())return;const t=lq(e),n=Dr(),r=e.scope?e.scope.getSpan():cq();if(e.onlyIfParent&&!r)return;const s=ac(),o=Ii();let a;if(r)a=r.startChild(t);else{const{traceId:c,dsc:l,parentSpanId:u,sampled:d}={...s.getPropagationContext(),...o.getPropagationContext()};a=n.startTransaction({traceId:c,parentSpanId:u,parentSampled:d,...t,metadata:{dynamicSamplingContext:l,...t.metadata}})}return uq(a,o,s),a}function cq(){return Ii().getSpan()}function lq(e){if(e.startTime){const t={...e};return t.startTimestamp=Ev(e.startTime),delete t.startTime,t}return e}const LL="_sentryScope",BL="_sentryIsolationScope";function uq(e,t,n){e&&(Yc(e,BL,n),Yc(e,LL,t))}function dq(e){return{scope:e[LL],isolationScope:e[BL]}}class FL extends _w{constructor(t,n){super(t),this._measurements={},this._contexts={},this._hub=n||Dr(),this._name=t.name||"",this._metadata={...t.metadata},this._trimEnd=t.trimEnd,this.transaction=this;const r=this._metadata.dynamicSamplingContext;r&&(this._frozenDynamicSamplingContext={...r})}get name(){return this._name}set name(t){this.setName(t)}get metadata(){return{source:"custom",spanMetadata:{},...this._metadata,...this._attributes[Oc]&&{source:this._attributes[Oc]},...this._attributes[Wl]&&{sampleRate:this._attributes[Wl]}}}set metadata(t){this._metadata=t}setName(t,n="custom"){this._name=t,this.setAttribute(Oc,n)}updateName(t){return this._name=t,this}initSpanRecorder(t=1e3){this.spanRecorder||(this.spanRecorder=new OL(t)),this.spanRecorder.add(this)}setContext(t,n){n===null?delete this._contexts[t]:this._contexts[t]=n}setMeasurement(t,n,r=""){this._measurements[t]={value:n,unit:r}}setMetadata(t){this._metadata={...this._metadata,...t}}end(t){const n=Ev(t),r=this._finishTransaction(n);if(r)return this._hub.captureEvent(r)}toContext(){const t=super.toContext();return _r({...t,name:this._name,trimEnd:this._trimEnd})}updateWithContext(t){return super.updateWithContext(t),this._name=t.name||"",this._trimEnd=t.trimEnd,this}getDynamicSamplingContext(){return Yf(this)}setHub(t){this._hub=t}_finishTransaction(t){if(this._endTime!==void 0)return;this._name||(be&&K.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>"),super.end(t);const n=this._hub.getClient();if(n&&n.emit&&n.emit("finishTransaction",this),this._sampled!==!0){be&&K.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),n&&n.recordDroppedEvent("sample_rate","transaction");return}const r=this.spanRecorder?this.spanRecorder.spans.filter(u=>u!==this&&$n(u).timestamp):[];if(this._trimEnd&&r.length>0){const u=r.map(d=>$n(d).timestamp).filter(Boolean);this._endTime=u.reduce((d,f)=>d>f?d:f)}const{scope:i,isolationScope:s}=dq(this),{metadata:o}=this,{source:a}=o,c={contexts:{...this._contexts,trace:Ew(this)},spans:r,start_timestamp:this._startTime,tags:this.tags,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{...o,capturedSpanScope:i,capturedSpanIsolationScope:s,dynamicSamplingContext:Yf(this)},...a&&{transaction_info:{source:a}}};return Object.keys(this._measurements).length>0&&(be&&K.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),c.measurements=this._measurements),be&&K.log(`[Tracing] Finishing ${this.op} transaction: ${this._name}.`),c}}const cg={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},fq="finishReason",Cl=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class hq extends OL{constructor(t,n,r,i){super(i),this._pushActivity=t,this._popActivity=n,this.transactionSpanId=r}add(t){if(t.spanContext().spanId!==this.transactionSpanId){const n=t.end;t.end=(...r)=>(this._popActivity(t.spanContext().spanId),n.apply(t,r)),$n(t).timestamp===void 0&&this._pushActivity(t.spanContext().spanId)}super.add(t)}}class pq extends FL{constructor(t,n,r=cg.idleTimeout,i=cg.finalTimeout,s=cg.heartbeatInterval,o=!1,a=!1){super(t,n),this._idleHub=n,this._idleTimeout=r,this._finalTimeout=i,this._heartbeatInterval=s,this._onScope=o,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=Cl[4],this._autoFinishAllowed=!a,o&&(be&&K.log(`Setting idle transaction on scope. Span ID: ${this.spanContext().spanId}`),n.getScope().setSpan(this)),a||this._restartIdleTimeout(),setTimeout(()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=Cl[3],this.end())},this._finalTimeout)}end(t){const n=Ev(t);if(this._finished=!0,this.activities={},this.op==="ui.action.click"&&this.setAttribute(fq,this._finishReason),this.spanRecorder){be&&K.log("[Tracing] finishing IdleTransaction",new Date(n*1e3).toISOString(),this.op);for(const r of this._beforeFinishCallbacks)r(this,n);this.spanRecorder.spans=this.spanRecorder.spans.filter(r=>{if(r.spanContext().spanId===this.spanContext().spanId)return!0;$n(r).timestamp||(r.setStatus("cancelled"),r.end(n),be&&K.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(r,void 0,2)));const{start_timestamp:i,timestamp:s}=$n(r),o=i&&i<n,a=(this._finalTimeout+this._idleTimeout)/1e3,c=s&&i&&s-i<a;if(be){const l=JSON.stringify(r,void 0,2);o?c||K.log("[Tracing] discarding Span since it finished after Transaction final timeout",l):K.log("[Tracing] discarding Span since it happened after Transaction was finished",l)}return o&&c}),be&&K.log("[Tracing] flushing IdleTransaction")}else be&&K.log("[Tracing] No active IdleTransaction");if(this._onScope){const r=this._idleHub.getScope();r.getTransaction()===this&&r.setSpan(void 0)}return super.end(t)}registerBeforeFinishCallback(t){this._beforeFinishCallbacks.push(t)}initSpanRecorder(t){if(!this.spanRecorder){const n=i=>{this._finished||this._pushActivity(i)},r=i=>{this._finished||this._popActivity(i)};this.spanRecorder=new hq(n,r,this.spanContext().spanId,t),be&&K.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(t,{restartOnChildSpanChange:n}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=n===!1,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,Object.keys(this.activities).length===0&&this._idleTimeoutCanceledPermanently&&(this._finishReason=Cl[5],this.end(t)))}setFinishReason(t){this._finishReason=t}sendAutoFinishSignal(){this._autoFinishAllowed||(be&&K.log("[Tracing] Received finish signal for idle transaction."),this._restartIdleTimeout(),this._autoFinishAllowed=!0)}_restartIdleTimeout(t){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout(()=>{!this._finished&&Object.keys(this.activities).length===0&&(this._finishReason=Cl[1],this.end(t))},this._idleTimeout)}_pushActivity(t){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),be&&K.log(`[Tracing] pushActivity: ${t}`),this.activities[t]=!0,be&&K.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(t){if(this.activities[t]&&(be&&K.log(`[Tracing] popActivity ${t}`),delete this.activities[t],be&&K.log("[Tracing] new activities count",Object.keys(this.activities).length)),Object.keys(this.activities).length===0){const n=_h();this._idleTimeoutCanceledPermanently?this._autoFinishAllowed&&(this._finishReason=Cl[5],this.end(n)):this._restartIdleTimeout(n+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const t=Object.keys(this.activities).join("");t===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=t,this._heartbeatCounter>=3?this._autoFinishAllowed&&(be&&K.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=Cl[0],this.end()):this._pingHeartbeat()}_pingHeartbeat(){be&&K.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout(()=>{this._beat()},this._heartbeatInterval)}}function UL(e,t,n){if(!Rv(t))return e.sampled=!1,e;if(e.sampled!==void 0)return e.setAttribute(Wl,Number(e.sampled)),e;let r;return typeof t.tracesSampler=="function"?(r=t.tracesSampler(n),e.setAttribute(Wl,Number(r))):n.parentSampled!==void 0?r=n.parentSampled:typeof t.tracesSampleRate<"u"?(r=t.tracesSampleRate,e.setAttribute(Wl,Number(r))):(r=1,e.setAttribute(Wl,r)),gq(r)?r?(e.sampled=Math.random()<r,e.sampled?(be&&K.log(`[Tracing] starting ${e.op} transaction - ${$n(e).description}`),e):(be&&K.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(r)})`),e)):(be&&K.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),e.sampled=!1,e):(be&&K.warn("[Tracing] Discarding transaction because of invalid sample rate."),e.sampled=!1,e)}function gq(e){return qD(e)||!(typeof e=="number"||typeof e=="boolean")?(be&&K.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`),!1):e<0||e>1?(be&&K.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${e}.`),!1):!0}function mq(){const t=this.getScope().getSpan();return t?{"sentry-trace":Av(t)}:{}}function vq(e,t){const n=this.getClient(),r=n&&n.getOptions()||{},i=r.instrumenter||"sentry",s=e.instrumenter||"sentry";i!==s&&(be&&K.error(`A transaction was started with instrumenter=\`${s}\`, but the SDK is configured with the \`${i}\` instrumenter.
The transaction will not be sampled. Please use the ${i} instrumentation to start transactions.`),e.sampled=!1);let o=new FL(e,this);return o=UL(o,r,{name:e.name,parentSampled:e.parentSampled,transactionContext:e,attributes:{...e.data,...e.attributes},...t}),o.isRecording()&&o.initSpanRecorder(r._experiments&&r._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",o),o}function ET(e,t,n,r,i,s,o,a=!1){const c=e.getClient(),l=c&&c.getOptions()||{};let u=new pq(t,e,n,r,o,i,a);return u=UL(u,l,{name:t.name,parentSampled:t.parentSampled,transactionContext:t,attributes:{...t.data,...t.attributes},...s}),u.isRecording()&&u.initSpanRecorder(l._experiments&&l._experiments.maxSpans),c&&c.emit&&c.emit("startTransaction",u),u}function yq(){const e=Rh();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=vq),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=mq),oq())}function Cq(e,t,n){const r=ld();r&&r.setMeasurement(e,t,n)}function Iq(e,t){return t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]]),e}function Sq(e,t,n,r){const i=kw(n),s={sent_at:new Date().toISOString(),...i&&{sdk:i},...!!r&&t&&{dsn:cd(t)}},o="aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()];return ll(s,[o])}function bq(e,t,n,r){const i=kw(n),s=e.type&&e.type!=="replay_event"?e.type:"event";Iq(e,n&&n.sdk);const o=yL(e,i,r,t);return delete e.sdkProcessingMetadata,ll(o,[[{type:s},e]])}const wq="7";function VL(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function kq(e){return`${VL(e)}${e.projectId}/envelope/`}function Aq(e,t){return BJ({sentry_key:e.publicKey,sentry_version:wq,...t&&{sentry_client:`${t.name}/${t.version}`}})}function Eq(e,t={}){const n=typeof t=="string"?t:t.tunnel,r=typeof t=="string"||!t._metadata?void 0:t._metadata.sdk;return n||`${kq(e)}?${Aq(e,r)}`}function Tq(e,t){const n=rL(e);if(!n)return"";const r=`${VL(n)}embed/error-page/`;let i=`dsn=${cd(n)}`;for(const s in t)if(s!=="dsn"&&s!=="onClose")if(s==="user"){const o=t.user;if(!o)continue;o.name&&(i+=`&name=${encodeURIComponent(o.name)}`),o.email&&(i+=`&email=${encodeURIComponent(o.email)}`)}else i+=`&${encodeURIComponent(s)}=${encodeURIComponent(t[s])}`;return`${r}?${i}`}const TT=[];function _q(e){const t={};return e.forEach(n=>{const{name:r}=n,i=t[r];i&&!i.isDefaultInstance&&n.isDefaultInstance||(t[r]=n)}),Object.keys(t).map(n=>t[n])}function Rq(e){const t=e.defaultIntegrations||[],n=e.integrations;t.forEach(o=>{o.isDefaultInstance=!0});let r;Array.isArray(n)?r=[...t,...n]:typeof n=="function"?r=lL(n(t)):r=t;const i=_q(r),s=Nq(i,o=>o.name==="Debug");if(s!==-1){const[o]=i.splice(s,1);i.push(o)}return i}function xq(e,t){const n={};return t.forEach(r=>{r&&GL(e,r,n)}),n}function _T(e,t){for(const n of t)n&&n.afterAllSetup&&n.afterAllSetup(e)}function GL(e,t,n){if(n[t.name]){be&&K.log(`Integration skipped because it was already installed: ${t.name}`);return}if(n[t.name]=t,TT.indexOf(t.name)===-1&&(t.setupOnce(DY,Dr),TT.push(t.name)),t.setup&&typeof t.setup=="function"&&t.setup(e),e.on&&typeof t.preprocessEvent=="function"){const r=t.preprocessEvent.bind(t);e.on("preprocessEvent",(i,s)=>r(i,s,e))}if(e.addEventProcessor&&typeof t.processEvent=="function"){const r=t.processEvent.bind(t),i=Object.assign((s,o)=>r(s,o,e),{id:t.name});e.addEventProcessor(i)}be&&K.log(`Integration installed: ${t.name}`)}function Nq(e,t){for(let n=0;n<e.length;n++)if(t(e[n])===!0)return n;return-1}function cc(e,t){return Object.assign(function(...r){return t(...r)},{id:e})}function Pq(e){let t="";for(const n of e){const r=Object.entries(n.tags),i=r.length>0?`|#${r.map(([s,o])=>`${s}:${o}`).join(",")}`:"";t+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${i}|T${n.timestamp}
`}return t}function Mq(e,t,n,r){const i={sent_at:new Date().toISOString()};n&&n.sdk&&(i.sdk={name:n.sdk.name,version:n.sdk.version}),r&&t&&(i.dsn=cd(t));const s=Oq(e);return ll(i,[s])}function Oq(e){const t=Pq(e);return[{type:"statsd",length:t.length},t]}const RT="Not capturing exception because it's already been captured.";class Dq{constructor(t){if(this._options=t,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],t.dsn?this._dsn=rL(t.dsn):be&&K.warn("No DSN provided, client will not send events."),this._dsn){const n=Eq(this._dsn,t);this._transport=t.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:n})}}captureException(t,n,r){if(lT(t)){be&&K.log(RT);return}let i=n&&n.event_id;return this._process(this.eventFromException(t,n).then(s=>this._captureEvent(s,n,r)).then(s=>{i=s})),i}captureMessage(t,n,r,i){let s=r&&r.event_id;const o=mw(t)?t:String(t),a=vw(t)?this.eventFromMessage(o,n,r):this.eventFromException(t,r);return this._process(a.then(c=>this._captureEvent(c,r,i)).then(c=>{s=c})),s}captureEvent(t,n,r){if(n&&n.originalException&&lT(n.originalException)){be&&K.log(RT);return}let i=n&&n.event_id;const o=(t.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(t,n,o||r).then(a=>{i=a})),i}captureSession(t){typeof t.release!="string"?be&&K.warn("Discarded session because of missing or non-string release"):(this.sendSession(t),qc(t,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){const n=this._transport;return n?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(t).then(r=>n.flush(t).then(i=>r&&i))):Lu(!0)}close(t){return this.flush(t).then(n=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(t){this._eventProcessors.push(t)}setupIntegrations(t){(t&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&this._setupIntegrations()}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationById(t){return this.getIntegrationByName(t)}getIntegrationByName(t){return this._integrations[t]}getIntegration(t){try{return this._integrations[t.id]||null}catch{return be&&K.warn(`Cannot retrieve integration ${t.id} from the current Client`),null}}addIntegration(t){const n=this._integrations[t.name];GL(this,t,this._integrations),n||_T(this,[t])}sendEvent(t,n={}){this.emit("beforeSendEvent",t,n);let r=bq(t,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])r=AY(r,_Y(s,this._options.transportOptions&&this._options.transportOptions.textEncoder));const i=this._sendEnvelope(r);i&&i.then(s=>this.emit("afterSendEvent",t,s),null)}sendSession(t){const n=Sq(t,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}recordDroppedEvent(t,n,r){if(this._options.sendClientReports){const i=`${t}:${n}`;be&&K.log(`Adding outcome: "${i}"`),this._outcomes[i]=this._outcomes[i]+1||1}}captureAggregateMetrics(t){be&&K.log(`Flushing aggregated metrics, number of metrics: ${t.length}`);const n=Mq(t,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}on(t,n){this._hooks[t]||(this._hooks[t]=[]),this._hooks[t].push(n)}emit(t,...n){this._hooks[t]&&this._hooks[t].forEach(r=>r(...n))}_setupIntegrations(){const{integrations:t}=this._options;this._integrations=xq(this,t),_T(this,t),this._integrationsInitialized=!0}_updateSessionFromEvent(t,n){let r=!1,i=!1;const s=n.exception&&n.exception.values;if(s){i=!0;for(const c of s){const l=c.mechanism;if(l&&l.handled===!1){r=!0;break}}}const o=t.status==="ok";(o&&t.errors===0||o&&r)&&(qc(t,{...r&&{status:"crashed"},errors:t.errors||Number(i||r)}),this.captureSession(t))}_isClientDoneProcessing(t){return new Xr(n=>{let r=0;const i=1,s=setInterval(()=>{this._numProcessing==0?(clearInterval(s),n(!0)):(r+=i,t&&r>=t&&(clearInterval(s),n(!1)))},i)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(t,n,r,i=ac()){const s=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&o.length>0&&(n.integrations=o),this.emit("preprocessEvent",t,n),AL(s,t,n,r,this,i).then(a=>{if(a===null)return a;const c={...i.getPropagationContext(),...r?r.getPropagationContext():void 0};if(!(a.contexts&&a.contexts.trace)&&c){const{traceId:u,spanId:d,parentSpanId:f,dsc:h}=c;a.contexts={trace:{trace_id:u,span_id:d,parent_span_id:f},...a.contexts};const p=h||_v(u,this,r);a.sdkProcessingMetadata={dynamicSamplingContext:p,...a.sdkProcessingMetadata}}return a})}_captureEvent(t,n={},r){return this._processEvent(t,n,r).then(i=>i.event_id,i=>{if(be){const s=i;s.logLevel==="log"?K.log(s.message):K.warn(s)}})}_processEvent(t,n,r){const i=this.getOptions(),{sampleRate:s}=i,o=jL(t),a=WL(t),c=t.type||"error",l=`before send for type \`${c}\``;if(a&&typeof s=="number"&&Math.random()>s)return this.recordDroppedEvent("sample_rate","error",t),bw(new vs(`Discarding event because it's not included in the random sample (sampling rate = ${s})`,"log"));const u=c==="replay_event"?"replay":c,f=(t.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(t,n,r,f).then(h=>{if(h===null)throw this.recordDroppedEvent("event_processor",u,t),new vs("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return h;const m=Bq(i,h,n);return Lq(m,l)}).then(h=>{if(h===null)throw this.recordDroppedEvent("before_send",u,t),new vs(`${l} returned \`null\`, will not send event.`,"log");const p=r&&r.getSession();!o&&p&&this._updateSessionFromEvent(p,h);const m=h.transaction_info;if(o&&m&&h.transaction!==t.transaction){const y="custom";h.transaction_info={...m,source:y}}return this.sendEvent(h,n),h}).then(null,h=>{throw h instanceof vs?h:(this.captureException(h,{data:{__sentry__:!0},originalException:h}),new vs(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${h}`))})}_process(t){this._numProcessing++,t.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_sendEnvelope(t){if(this.emit("beforeEnvelope",t),this._isEnabled()&&this._transport)return this._transport.send(t).then(null,n=>{be&&K.error("Error while sending event:",n)});be&&K.error("Transport disabled")}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.keys(t).map(n=>{const[r,i]=n.split(":");return{reason:r,category:i,quantity:t[n]}})}}function Lq(e,t){const n=`${t} must return \`null\` or a valid event.`;if(bv(e))return e.then(r=>{if(!Du(r)&&r!==null)throw new vs(n);return r},r=>{throw new vs(`${t} rejected with ${r}`)});if(!Du(e)&&e!==null)throw new vs(n);return e}function Bq(e,t,n){const{beforeSend:r,beforeSendTransaction:i}=e;return WL(t)&&r?r(t,n):jL(t)&&i?i(t,n):t}function WL(e){return e.type===void 0}function jL(e){return e.type==="transaction"}function Fq(e){const t=ut();!t||!t.addEventProcessor||t.addEventProcessor(e)}function Uq(e,t){t.debug===!0&&(be?K.enable():Jc(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),Ii().update(t.initialScope);const r=new e(t);Vq(r),Gq(r)}function Vq(e){const n=Dr().getStackTop();n.client=e,n.scope.setClient(e)}function Gq(e){e.init?e.init():e.setupIntegrations&&e.setupIntegrations()}const Wq=30;function HL(e,t,n=pY(e.bufferSize||Wq)){let r={};const i=o=>n.drain(o);function s(o){const a=[];if(gT(o,(d,f)=>{const h=mT(f);if(CL(r,h)){const p=xT(d,f);e.recordDroppedEvent("ratelimit_backoff",h,p)}else a.push(d)}),a.length===0)return Lu();const c=ll(o[0],a),l=d=>{gT(c,(f,h)=>{const p=xT(f,h);e.recordDroppedEvent(d,mT(h),p)})},u=()=>t({body:EY(c,e.textEncoder)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&be&&K.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=IL(r,d),d),d=>{throw l("network_error"),d});return n.add(u).then(d=>d,d=>{if(d instanceof vs)return be&&K.error("Skipped sending event because buffer is full."),l("queue_overflow"),Lu();throw d})}return s.__sentry__baseTransport__=!0,{send:s,flush:i}}function xT(e,t){if(!(t!=="event"&&t!=="transaction"))return Array.isArray(e)?e[1]:void 0}function jq(e,t){const n=t&&zq(t)?t.getClient():t,r=n&&n.getDsn(),i=n&&n.getOptions().tunnel;return $q(e,r)||Hq(e,i)}function Hq(e,t){return t?NT(e)===NT(t):!1}function $q(e,t){return t?e.includes(t.host):!1}function NT(e){return e[e.length-1]==="/"?e.slice(0,-1):e}function zq(e){return e.getClient!==void 0}function $L(e,t,n=[t],r="npm"){const i=e._metadata||{};i.sdk||(i.sdk={name:`sentry.javascript.${t}`,packages:n.map(s=>({name:`${r}:@sentry/${s}`,version:ZI})),version:ZI}),e._metadata=i}const Zq=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],Xq=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],zL="InboundFilters",Kq=(e={})=>({name:zL,setupOnce(){},processEvent(t,n,r){const i=r.getOptions(),s=Jq(e,i);return Yq(t,s)?null:t}}),ZL=Kq;cc(zL,ZL);function Jq(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:Zq],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:Xq],ignoreInternal:e.ignoreInternal!==void 0?e.ignoreInternal:!0}}function Yq(e,t){return t.ignoreInternal&&rQ(e)?(be&&K.warn(`Event dropped due to being internal Sentry Error.
Event: ${Ca(e)}`),!0):qq(e,t.ignoreErrors)?(be&&K.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Ca(e)}`),!0):Qq(e,t.ignoreTransactions)?(be&&K.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Ca(e)}`),!0):eQ(e,t.denyUrls)?(be&&K.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Ca(e)}.
Url: ${vm(e)}`),!0):tQ(e,t.allowUrls)?!1:(be&&K.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Ca(e)}.
Url: ${vm(e)}`),!0)}function qq(e,t){return e.type||!t||!t.length?!1:nQ(e).some(n=>od(n,t))}function Qq(e,t){if(e.type!=="transaction"||!t||!t.length)return!1;const n=e.transaction;return n?od(n,t):!1}function eQ(e,t){if(!t||!t.length)return!1;const n=vm(e);return n?od(n,t):!1}function tQ(e,t){if(!t||!t.length)return!0;const n=vm(e);return n?od(n,t):!0}function nQ(e){const t=[];e.message&&t.push(e.message);let n;try{n=e.exception.values[e.exception.values.length-1]}catch{}return n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`)),be&&t.length===0&&K.error(`Could not extract message for event ${Ca(e)}`),t}function rQ(e){try{return e.exception.values[0].type==="SentryError"}catch{}return!1}function iQ(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function vm(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch{}return t?iQ(t):null}catch{return be&&K.error(`Cannot extract url for event ${Ca(e)}`),null}}let PT;const XL="FunctionToString",MT=new WeakMap,sQ=()=>({name:XL,setupOnce(){PT=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=Cw(this),n=MT.has(ut())&&t!==void 0?t:this;return PT.apply(n,e)}}catch{}},setup(e){MT.set(e,!0)}}),KL=sQ;cc(XL,KL);const Gt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,nt=Je;function oQ(){nt&&nt.document?nt.document.addEventListener("visibilitychange",()=>{const e=ld();if(nt.document.hidden&&e){const t="cancelled",{op:n,status:r}=$n(e);Gt&&K.log(`[Tracing] Transaction: ${t} -> since tab moved to the background, op: ${n}`),r||e.setStatus(t),e.setTag("visibilitychange","document.hidden"),e.end()}}):Gt&&K.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const Rw=(e,t,n)=>{let r,i;return s=>{t.value>=0&&(s||n)&&(i=t.value-(r||0),(i||r===void 0)&&(r=t.value,t.delta=i,e(t)))}},aQ=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,cQ=()=>{const e=nt.performance.timing,t=nt.performance.navigation.type,n={entryType:"navigation",startTime:0,type:t==2?"back_forward":t===1?"reload":"navigate"};for(const r in e)r!=="navigationStart"&&r!=="toJSON"&&(n[r]=Math.max(e[r]-e.navigationStart,0));return n},JL=()=>nt.__WEB_VITALS_POLYFILL__?nt.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||cQ()):nt.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],YL=()=>{const e=JL();return e&&e.activationStart||0},xw=(e,t)=>{const n=JL();let r="navigate";return n&&(nt.document.prerendering||YL()>0?r="prerender":r=n.type.replace(/_/g,"-")),{name:e,value:typeof t>"u"?-1:t,rating:"good",delta:0,entries:[],id:aQ(),navigationType:r}},xv=(e,t,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const r=new PerformanceObserver(i=>{t(i.getEntries())});return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch{}},Nv=(e,t)=>{const n=r=>{(r.type==="pagehide"||nt.document.visibilityState==="hidden")&&(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},lQ=e=>{const t=xw("CLS",0);let n,r=0,i=[];const s=a=>{a.forEach(c=>{if(!c.hadRecentInput){const l=i[0],u=i[i.length-1];r&&i.length!==0&&c.startTime-u.startTime<1e3&&c.startTime-l.startTime<5e3?(r+=c.value,i.push(c)):(r=c.value,i=[c]),r>t.value&&(t.value=r,t.entries=i,n&&n())}})},o=xv("layout-shift",s);if(o){n=Rw(e,t);const a=()=>{s(o.takeRecords()),n(!0)};return Nv(a),a}};let lg=-1;const uQ=()=>nt.document.visibilityState==="hidden"&&!nt.document.prerendering?0:1/0,dQ=()=>{Nv(({timeStamp:e})=>{lg=e},!0)},Nw=()=>(lg<0&&(lg=uQ(),dQ()),{get firstHiddenTime(){return lg}}),fQ=e=>{const t=Nw(),n=xw("FID");let r;const i=a=>{a.startTime<t.firstHiddenTime&&(n.value=a.processingStart-a.startTime,n.entries.push(a),r(!0))},s=a=>{a.forEach(i)},o=xv("first-input",s);r=Rw(e,n),o&&Nv(()=>{s(o.takeRecords()),o.disconnect()},!0)},OT={},hQ=e=>{const t=Nw(),n=xw("LCP");let r;const i=o=>{const a=o[o.length-1];if(a){const c=Math.max(a.startTime-YL(),0);c<t.firstHiddenTime&&(n.value=c,n.entries=[a],r())}},s=xv("largest-contentful-paint",i);if(s){r=Rw(e,n);const o=()=>{OT[n.id]||(i(s.takeRecords()),s.disconnect(),OT[n.id]=!0,r(!0))};return["keydown","click"].forEach(a=>{addEventListener(a,o,{once:!0,capture:!0})}),Nv(o,!0),o}},uf={},ym={};let qL,QL,e2;function pQ(e,t=!1){return Pw("cls",e,mQ,qL,t)}function t2(e,t=!1){return Pw("lcp",e,yQ,e2,t)}function gQ(e){return Pw("fid",e,vQ,QL)}function Pv(e,t){return n2(e,t),ym[e]||(CQ(e),ym[e]=!0),r2(e,t)}function Mv(e,t){const n=uf[e];if(!(!n||!n.length))for(const r of n)try{r(t)}catch(i){Gt&&K.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${zo(r)}
Error:`,i)}}function mQ(){return lQ(e=>{Mv("cls",{metric:e}),qL=e})}function vQ(){return fQ(e=>{Mv("fid",{metric:e}),QL=e})}function yQ(){return hQ(e=>{Mv("lcp",{metric:e}),e2=e})}function Pw(e,t,n,r,i=!1){n2(e,t);let s;return ym[e]||(s=n(),ym[e]=!0),r&&t({metric:r}),r2(e,t,i?s:void 0)}function CQ(e){const t={};e==="event"&&(t.durationThreshold=0),xv(e,n=>{Mv(e,{entries:n})},t)}function n2(e,t){uf[e]=uf[e]||[],uf[e].push(t)}function r2(e,t,n){return()=>{n&&n();const r=uf[e];if(!r)return;const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}function d0(e){return typeof e=="number"&&isFinite(e)}function Bu(e,{startTimestamp:t,...n}){return t&&e.startTimestamp>t&&(e.startTimestamp=t),e.startChild({startTimestamp:t,...n})}const IQ=2147483647;function pn(e){return e/1e3}function i2(){return nt&&nt.addEventListener&&nt.performance}let DT=0,Yt={},ls,df;function SQ(){const e=i2();if(e&&Qi){e.mark&&nt.performance.mark("sentry-tracing-init");const t=EQ(),n=kQ(),r=AQ();return()=>{t(),n(),r()}}return()=>{}}function bQ(){Pv("longtask",({entries:e})=>{for(const t of e){const n=ld();if(!n)return;const r=pn(Qi+t.startTime),i=pn(t.duration);n.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i})}})}function wQ(){Pv("event",({entries:e})=>{for(const t of e){const n=ld();if(!n)return;if(t.name==="click"){const r=pn(Qi+t.startTime),i=pn(t.duration),s={description:Kc(t.target),op:`ui.interaction.${t.name}`,origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i},o=tL(t.target);o&&(s.attributes={"ui.component_name":o}),n.startChild(s)}}})}function kQ(){return pQ(({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(Gt&&K.log("[Measurements] Adding CLS"),Yt.cls={value:e.value,unit:""},df=t)},!0)}function AQ(){return t2(({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(Gt&&K.log("[Measurements] Adding LCP"),Yt.lcp={value:e.value,unit:"millisecond"},ls=t)},!0)}function EQ(){return gQ(({metric:e})=>{const t=e.entries[e.entries.length-1];if(!t)return;const n=pn(Qi),r=pn(t.startTime);Gt&&K.log("[Measurements] Adding FID"),Yt.fid={value:e.value,unit:"millisecond"},Yt["mark.fid"]={value:n+r,unit:"second"}})}function TQ(e){const t=i2();if(!t||!nt.performance.getEntries||!Qi)return;Gt&&K.log("[Tracing] Adding & adjusting spans using Performance API");const n=pn(Qi),r=t.getEntries();let i,s;const{op:o,start_timestamp:a}=$n(e);if(r.slice(DT).forEach(c=>{const l=pn(c.startTime),u=pn(c.duration);if(!(e.op==="navigation"&&a&&n+l<a))switch(c.entryType){case"navigation":{RQ(e,c,n),i=n+pn(c.responseStart),s=n+pn(c.requestStart);break}case"mark":case"paint":case"measure":{_Q(e,c,l,u,n);const d=Nw(),f=c.startTime<d.firstHiddenTime;c.name==="first-paint"&&f&&(Gt&&K.log("[Measurements] Adding FP"),Yt.fp={value:c.startTime,unit:"millisecond"}),c.name==="first-contentful-paint"&&f&&(Gt&&K.log("[Measurements] Adding FCP"),Yt.fcp={value:c.startTime,unit:"millisecond"});break}case"resource":{NQ(e,c,c.name,l,u,n);break}}}),DT=Math.max(r.length-1,0),PQ(e),o==="pageload"){OQ(Yt,i,s,a),["fcp","fp","lcp"].forEach(l=>{if(!Yt[l]||!a||n>=a)return;const u=Yt[l].value,d=n+pn(u),f=Math.abs((d-a)*1e3),h=f-u;Gt&&K.log(`[Measurements] Normalized ${l} from ${u} to ${f} (${h})`),Yt[l].value=f});const c=Yt["mark.fid"];c&&Yt.fid&&(Bu(e,{description:"first input delay",endTimestamp:c.value+pn(Yt.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:c.value}),delete Yt["mark.fid"]),"fcp"in Yt||delete Yt.cls,Object.keys(Yt).forEach(l=>{Cq(l,Yt[l].value,Yt[l].unit)}),MQ(e)}ls=void 0,df=void 0,Yt={}}function _Q(e,t,n,r,i){const s=i+n,o=s+r;return Bu(e,{description:t.name,endTimestamp:o,op:t.entryType,origin:"auto.resource.browser.metrics",startTimestamp:s}),s}function RQ(e,t,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(r=>{mp(e,t,r,n)}),mp(e,t,"secureConnection",n,"TLS/SSL","connectEnd"),mp(e,t,"fetch",n,"cache","domainLookupStart"),mp(e,t,"domainLookup",n,"DNS"),xQ(e,t,n)}function mp(e,t,n,r,i,s){const o=s?t[s]:t[`${n}End`],a=t[`${n}Start`];!a||!o||Bu(e,{op:"browser",origin:"auto.browser.browser.metrics",description:i||n,startTimestamp:r+pn(a),endTimestamp:r+pn(o)})}function xQ(e,t,n){t.responseEnd&&(Bu(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:n+pn(t.requestStart),endTimestamp:n+pn(t.responseEnd)}),Bu(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:n+pn(t.responseStart),endTimestamp:n+pn(t.responseEnd)}))}function NQ(e,t,n,r,i,s){if(t.initiatorType==="xmlhttprequest"||t.initiatorType==="fetch")return;const o=ag(n),a={};f0(a,t,"transferSize","http.response_transfer_size"),f0(a,t,"encodedBodySize","http.response_content_length"),f0(a,t,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in t&&(a["resource.render_blocking_status"]=t.renderBlockingStatus),o.protocol&&(a["url.scheme"]=o.protocol.split(":").pop()),o.host&&(a["server.address"]=o.host),a["url.same_origin"]=n.includes(nt.location.origin);const c=s+r,l=c+i;Bu(e,{description:n.replace(nt.location.origin,""),endTimestamp:l,op:t.initiatorType?`resource.${t.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:c,data:a})}function PQ(e){const t=nt.navigator;if(!t)return;const n=t.connection;n&&(n.effectiveType&&e.setTag("effectiveConnectionType",n.effectiveType),n.type&&e.setTag("connectionType",n.type),d0(n.rtt)&&(Yt["connection.rtt"]={value:n.rtt,unit:"millisecond"})),d0(t.deviceMemory)&&e.setTag("deviceMemory",`${t.deviceMemory} GB`),d0(t.hardwareConcurrency)&&e.setTag("hardwareConcurrency",String(t.hardwareConcurrency))}function MQ(e){ls&&(Gt&&K.log("[Measurements] Adding LCP Data"),ls.element&&e.setTag("lcp.element",Kc(ls.element)),ls.id&&e.setTag("lcp.id",ls.id),ls.url&&e.setTag("lcp.url",ls.url.trim().slice(0,200)),e.setTag("lcp.size",ls.size)),df&&df.sources&&(Gt&&K.log("[Measurements] Adding CLS Data"),df.sources.forEach((t,n)=>e.setTag(`cls.source.${n+1}`,Kc(t.node))))}function f0(e,t,n,r){const i=t[n];i!=null&&i<IQ&&(e[r]=i)}function OQ(e,t,n,r){typeof t=="number"&&r&&(Gt&&K.log("[Measurements] Adding TTFB"),e.ttfb={value:Math.max(t-r,0)*1e3,unit:"millisecond"},typeof n=="number"&&n<=t&&(e["ttfb.requestTime"]={value:(t-n)*1e3,unit:"millisecond"}))}function DQ(e,t,n,r,i="auto.http.browser"){if(!Rv()||!e.fetchData)return;const s=t(e.fetchData.url);if(e.endTimestamp&&s){const d=e.fetchData.__span;if(!d)return;const f=r[d];if(f){if(e.response){Tw(f,e.response.status);const h=e.response&&e.response.headers&&e.response.headers.get("content-length");if(h){const p=parseInt(h);p>0&&f.setAttribute("http.response_content_length",p)}}else e.error&&f.setStatus("internal_error");f.end(),delete r[d]}return}const o=Ii(),a=ut(),{method:c,url:l}=e.fetchData,u=s?DL({name:`${c} ${l}`,onlyIfParent:!0,attributes:{url:l,type:"fetch","http.method":c,[jl]:i},op:"http.client"}):void 0;if(u&&(e.fetchData.__span=u.spanContext().spanId,r[u.spanContext().spanId]=u),n(e.fetchData.url)&&a){const d=e.args[0];e.args[1]=e.args[1]||{};const f=e.args[1];f.headers=LQ(d,a,o,f,u)}return u}function LQ(e,t,n,r,i){const s=i||n.getSpan(),o=ac(),{traceId:a,spanId:c,sampled:l,dsc:u}={...o.getPropagationContext(),...n.getPropagationContext()},d=s?Av(s):ww(a,c,l),f=vL(u||(s?Yf(s):_v(a,t,n))),h=r.headers||(typeof Request<"u"&&$o(e,Request)?e.headers:void 0);if(h)if(typeof Headers<"u"&&$o(h,Headers)){const p=new Headers(h);return p.append("sentry-trace",d),f&&p.append($I,f),p}else if(Array.isArray(h)){const p=[...h,["sentry-trace",d]];return f&&p.push([$I,f]),p}else{const p="baggage"in h?h.baggage:void 0,m=[];return Array.isArray(p)?m.push(...p):p&&m.push(p),f&&m.push(f),{...h,"sentry-trace":d,baggage:m.length>0?m.join(","):void 0}}else return{"sentry-trace":d,baggage:f}}const JI=["localhost",/^\/(?!\/)/],YI={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:JI,tracePropagationTargets:JI};function BQ(e){const{traceFetch:t,traceXHR:n,tracePropagationTargets:r,tracingOrigins:i,shouldCreateSpanForRequest:s,enableHTTPTimings:o}={traceFetch:YI.traceFetch,traceXHR:YI.traceXHR,...e},a=typeof s=="function"?s:u=>!0,c=u=>GQ(u,r||i),l={};t&&Iw(u=>{const d=DQ(u,a,c,l);o&&d&&LT(d)}),n&&Sw(u=>{const d=WQ(u,a,c,l);o&&d&&LT(d)})}function FQ(e){return e.entryType==="resource"&&"initiatorType"in e&&typeof e.nextHopProtocol=="string"&&(e.initiatorType==="fetch"||e.initiatorType==="xmlhttprequest")}function LT(e){const{url:t}=$n(e).data||{};if(!t||typeof t!="string")return;const n=Pv("resource",({entries:r})=>{r.forEach(i=>{FQ(i)&&i.name.endsWith(t)&&(VQ(i).forEach(o=>e.setAttribute(...o)),setTimeout(n))})})}function UQ(e){let t="unknown",n="unknown",r="";for(const i of e){if(i==="/"){[t,n]=e.split("/");break}if(!isNaN(Number(i))){t=r==="h"?"http":r,n=e.split(r)[1];break}r+=i}return r===e&&(t=r),{name:t,version:n}}function is(e=0){return((Qi||performance.timeOrigin)+e)/1e3}function VQ(e){const{name:t,version:n}=UQ(e.nextHopProtocol),r=[];return r.push(["network.protocol.version",n],["network.protocol.name",t]),Qi?[...r,["http.request.redirect_start",is(e.redirectStart)],["http.request.fetch_start",is(e.fetchStart)],["http.request.domain_lookup_start",is(e.domainLookupStart)],["http.request.domain_lookup_end",is(e.domainLookupEnd)],["http.request.connect_start",is(e.connectStart)],["http.request.secure_connection_start",is(e.secureConnectionStart)],["http.request.connection_end",is(e.connectEnd)],["http.request.request_start",is(e.requestStart)],["http.request.response_start",is(e.responseStart)],["http.request.response_end",is(e.responseEnd)]]:r}function GQ(e,t){return od(e,t||JI)}function WQ(e,t,n,r){const i=e.xhr,s=i&&i[Na];if(!Rv()||!i||i.__sentry_own_request__||!s)return;const o=t(s.url);if(e.endTimestamp&&o){const d=i.__sentry_xhr_span_id__;if(!d)return;const f=r[d];f&&s.status_code!==void 0&&(Tw(f,s.status_code),f.end(),delete r[d]);return}const a=Ii(),c=ac(),l=o?DL({name:`${s.method} ${s.url}`,onlyIfParent:!0,attributes:{type:"xhr","http.method":s.method,url:s.url,[jl]:"auto.http.browser"},op:"http.client"}):void 0;l&&(i.__sentry_xhr_span_id__=l.spanContext().spanId,r[i.__sentry_xhr_span_id__]=l);const u=ut();if(i.setRequestHeader&&n(s.url)&&u){const{traceId:d,spanId:f,sampled:h,dsc:p}={...c.getPropagationContext(),...a.getPropagationContext()},m=l?Av(l):ww(d,f,h),y=vL(p||(l?Yf(l):_v(d,u,a)));jQ(i,m,y)}return l}function jQ(e,t,n){try{e.setRequestHeader("sentry-trace",t),n&&e.setRequestHeader($I,n)}catch{}}function HQ(e,t=!0,n=!0){if(!nt||!nt.location){Gt&&K.warn("Could not initialize routing instrumentation due to invalid location");return}let r=nt.location.href,i;t&&(i=e({name:nt.location.pathname,startTimestamp:Qi?Qi/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),n&&wv(({to:s,from:o})=>{if(o===void 0&&r&&r.indexOf(s)!==-1){r=void 0;return}o!==s&&(r=void 0,i&&(Gt&&K.log(`[Tracing] Finishing current transaction with op: ${i.op}`),i.end()),i=e({name:nt.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))})}const $Q="BrowserTracing",zQ={...cg,markBackgroundTransactions:!0,routingInstrumentation:HQ,startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...YI};class ZQ{constructor(t){this.name=$Q,this._hasSetTracePropagationTargets=!1,yq(),Gt&&(this._hasSetTracePropagationTargets=!!(t&&(t.tracePropagationTargets||t.tracingOrigins))),this.options={...zQ,...t},this.options._experiments.enableLongTask!==void 0&&(this.options.enableLongTask=this.options._experiments.enableLongTask),t&&!t.tracePropagationTargets&&t.tracingOrigins&&(this.options.tracePropagationTargets=t.tracingOrigins),this._collectWebVitals=SQ(),this.options.enableLongTask&&bQ(),this.options._experiments.enableInteractions&&wQ()}setupOnce(t,n){this._getCurrentHub=n;const i=n().getClient(),s=i&&i.getOptions(),{routingInstrumentation:o,startTransactionOnLocationChange:a,startTransactionOnPageLoad:c,markBackgroundTransactions:l,traceFetch:u,traceXHR:d,shouldCreateSpanForRequest:f,enableHTTPTimings:h,_experiments:p}=this.options,m=s&&s.tracePropagationTargets,y=m||this.options.tracePropagationTargets;Gt&&this._hasSetTracePropagationTargets&&m&&K.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),o(g=>{const v=this._createRouteTransaction(g);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(v,g,n),v},c,a),l&&oQ(),p.enableInteractions&&this._registerInteractionListener(),BQ({traceFetch:u,traceXHR:d,tracePropagationTargets:y,shouldCreateSpanForRequest:f,enableHTTPTimings:h})}_createRouteTransaction(t){if(!this._getCurrentHub){Gt&&K.warn(`[Tracing] Did not create ${t.op} transaction because _getCurrentHub is invalid.`);return}const n=this._getCurrentHub(),{beforeNavigate:r,idleTimeout:i,finalTimeout:s,heartbeatInterval:o}=this.options,a=t.op==="pageload";let c;if(a){const h=a?BT("sentry-trace"):"",p=a?BT("baggage"):void 0,{traceId:m,dsc:y,parentSpanId:g,sampled:v}=kY(h,p);c={traceId:m,parentSpanId:g,parentSampled:v,...t,metadata:{...t.metadata,dynamicSamplingContext:y},trimEnd:!0}}else c={trimEnd:!0,...t};const l=typeof r=="function"?r(c):c,u=l===void 0?{...c,sampled:!1}:l;u.metadata=u.name!==c.name?{...u.metadata,source:"custom"}:u.metadata,this._latestRouteName=u.name,this._latestRouteSource=XQ(u),u.sampled===!1&&Gt&&K.log(`[Tracing] Will not send ${u.op} transaction because of beforeNavigate.`),Gt&&K.log(`[Tracing] Starting ${u.op} transaction on scope`);const{location:d}=nt,f=ET(n,u,i,s,!0,{location:d},o,a);return a&&(nt.document.addEventListener("readystatechange",()=>{["interactive","complete"].includes(nt.document.readyState)&&f.sendAutoFinishSignal()}),["interactive","complete"].includes(nt.document.readyState)&&f.sendAutoFinishSignal()),f.registerBeforeFinishCallback(h=>{this._collectWebVitals(),TQ(h)}),f}_registerInteractionListener(){let t;const n=()=>{const{idleTimeout:r,finalTimeout:i,heartbeatInterval:s}=this.options,o="ui.action.click",a=ld();if(a&&a.op&&["navigation","pageload"].includes(a.op)){Gt&&K.warn(`[Tracing] Did not create ${o} transaction because a pageload or navigation transaction is in progress.`);return}if(t&&(t.setFinishReason("interactionInterrupted"),t.end(),t=void 0),!this._getCurrentHub){Gt&&K.warn(`[Tracing] Did not create ${o} transaction because _getCurrentHub is invalid.`);return}if(!this._latestRouteName){Gt&&K.warn(`[Tracing] Did not create ${o} transaction because _latestRouteName is missing.`);return}const c=this._getCurrentHub(),{location:l}=nt,u={name:this._latestRouteName,op:o,trimEnd:!0,data:{[Oc]:this._latestRouteSource||"url"}};t=ET(c,u,r,i,!0,{location:l},s)};["click"].forEach(r=>{addEventListener(r,n,{once:!1,capture:!0})})}}function BT(e){const t=xJ(`meta[name=${e}]`);return t?t.getAttribute("content"):void 0}function XQ(e){const t=e.attributes&&e.attributes[Oc],n=e.data&&e.data[Oc],r=e.metadata&&e.metadata.source;return t||n||r}const Ye=Je;let qI=0;function s2(){return qI>0}function KQ(){qI++,setTimeout(()=>{qI--})}function Fu(e,t={},n){if(typeof e!="function")return e;try{const i=e.__sentry_wrapped__;if(i)return i;if(Cw(e))return e}catch{return e}const r=function(){const i=Array.prototype.slice.call(arguments);try{n&&typeof n=="function"&&n.apply(this,arguments);const s=i.map(o=>Fu(o,t));return e.apply(this,s)}catch(s){throw KQ(),TL(o=>{o.addEventProcessor(a=>(t.mechanism&&(FI(a,void 0,void 0),Jf(a,t.mechanism)),a.extra={...a.extra,arguments:i},a)),Tv(s)}),s}};try{for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}catch{}iL(r,e),Yc(e,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return e.name}})}catch{}return r}const pi=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function o2(e,t){const n=Mw(e,t),r={type:t&&t.name,value:QQ(t)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function JQ(e,t,n,r){const i=ut(),s=i&&i.getOptions().normalizeDepth,o={exception:{values:[{type:Sv(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:nee(t,{isUnhandledRejection:r})}]},extra:{__serialized__:pL(t,s)}};if(n){const a=Mw(e,n);a.length&&(o.exception.values[0].stacktrace={frames:a})}return o}function h0(e,t){return{exception:{values:[o2(e,t)]}}}function Mw(e,t){const n=t.stacktrace||t.stack||"",r=qQ(t);try{return e(n,r)}catch{}return[]}const YQ=/Minified React error #\d+;/i;function qQ(e){if(e){if(typeof e.framesToPop=="number")return e.framesToPop;if(YQ.test(e.message))return 1}return 0}function QQ(e){const t=e&&e.message;return t?t.error&&typeof t.error.message=="string"?t.error.message:t:"No error message"}function eee(e,t,n,r){const i=n&&n.syntheticException||void 0,s=Ow(e,t,i,r);return Jf(s),s.level="error",n&&n.event_id&&(s.event_id=n.event_id),Lu(s)}function tee(e,t,n="info",r,i){const s=r&&r.syntheticException||void 0,o=QI(e,t,s,i);return o.level=n,r&&r.event_id&&(o.event_id=r.event_id),Lu(o)}function Ow(e,t,n,r,i){let s;if(gw(t)&&t.error)return h0(e,t.error);if(eT(t)||IJ(t)){const o=t;if("stack"in t)s=h0(e,t);else{const a=o.name||(eT(o)?"DOMError":"DOMException"),c=o.message?`${a}: ${o.message}`:a;s=QI(e,c,n,r),FI(s,c)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":`${o.code}`}),s}return pw(t)?h0(e,t):Du(t)||Sv(t)?(s=JQ(e,t,n,i),Jf(s,{synthetic:!0}),s):(s=QI(e,t,n,r),FI(s,`${t}`,void 0),Jf(s,{synthetic:!0}),s)}function QI(e,t,n,r){const i={};if(r&&n){const s=Mw(e,n);s.length&&(i.exception={values:[{value:t,stacktrace:{frames:s}}]})}if(mw(t)){const{__sentry_template_string__:s,__sentry_template_values__:o}=t;return i.logentry={message:s,params:o},i}return i.message=t,i}function nee(e,{isUnhandledRejection:t}){const n=FJ(e),r=t?"promise rejection":"exception";return gw(e)?`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``:Sv(e)?`Event \`${ree(e)}\` (type=${e.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function ree(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}function iee(e,{metadata:t,tunnel:n,dsn:r}){const i={event_id:e.event_id,sent_at:new Date().toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!n&&!!r&&{dsn:cd(r)}},s=see(e);return ll(i,[s])}function see(e){return[{type:"user_report"},e]}class oee extends Dq{constructor(t){const n=Ye.SENTRY_SDK_SOURCE||oY();$L(t,"browser",["browser"],n),super(t),t.sendClientReports&&Ye.document&&Ye.document.addEventListener("visibilitychange",()=>{Ye.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(t,n){return eee(this._options.stackParser,t,n,this._options.attachStacktrace)}eventFromMessage(t,n="info",r){return tee(this._options.stackParser,t,n,r,this._options.attachStacktrace)}captureUserFeedback(t){if(!this._isEnabled()){pi&&K.warn("SDK not enabled, will not capture user feedback.");return}const n=iee(t,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(n)}_prepareEvent(t,n,r){return t.platform=t.platform||"javascript",super._prepareEvent(t,n,r)}_flushOutcomes(){const t=this._clearOutcomes();if(t.length===0){pi&&K.log("No outcomes to send");return}if(!this._dsn){pi&&K.log("No dsn provided, will not send outcomes");return}pi&&K.log("Sending outcomes:",t);const n=xY(t,this._options.tunnel&&cd(this._dsn));this._sendEnvelope(n)}}let $d;function aee(){if($d)return $d;if(WI(Ye.fetch))return $d=Ye.fetch.bind(Ye);const e=Ye.document;let t=Ye.fetch;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n);const r=n.contentWindow;r&&r.fetch&&(t=r.fetch),e.head.removeChild(n)}catch(n){pi&&K.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return $d=t.bind(Ye)}function cee(){$d=void 0}function lee(e,t=aee()){let n=0,r=0;function i(s){const o=s.body.length;n+=o,r++;const a={body:s.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};try{return t(e.url,a).then(c=>(n-=o,r--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return cee(),n-=o,r--,bw(c)}}return HL(e,i)}const uee=4;function dee(e){function t(n){return new Xr((r,i)=>{const s=new XMLHttpRequest;s.onerror=i,s.onreadystatechange=()=>{s.readyState===uee&&r({statusCode:s.status,headers:{"x-sentry-rate-limits":s.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":s.getResponseHeader("Retry-After")}})},s.open("POST",e.url);for(const o in e.headers)Object.prototype.hasOwnProperty.call(e.headers,o)&&s.setRequestHeader(o,e.headers[o]);s.send(n.body)})}return HL(e,t)}const Ov="?",fee=30,hee=40,pee=50;function Dw(e,t,n,r){const i={filename:e,function:t,in_app:!0};return n!==void 0&&(i.lineno=n),r!==void 0&&(i.colno=r),i}const gee=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,mee=/\((\S*)(?::(\d+))(?::(\d+))\)/,vee=e=>{const t=gee.exec(e);if(t){if(t[2]&&t[2].indexOf("eval")===0){const s=mee.exec(t[2]);s&&(t[2]=s[1],t[3]=s[2],t[4]=s[3])}const[r,i]=a2(t[1]||Ov,t[2]);return Dw(i,r,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}},yee=[fee,vee],Cee=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Iee=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,See=e=>{const t=Cee.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const s=Iee.exec(t[3]);s&&(t[1]=t[1]||"eval",t[3]=s[1],t[4]=s[2],t[5]="")}let r=t[3],i=t[1]||Ov;return[i,r]=a2(i,r),Dw(r,i,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},bee=[pee,See],wee=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,kee=e=>{const t=wee.exec(e);return t?Dw(t[2],t[1]||Ov,+t[3],t[4]?+t[4]:void 0):void 0},Aee=[hee,kee],Eee=[yee,bee,Aee],Tee=aL(...Eee),a2=(e,t)=>{const n=e.indexOf("safari-extension")!==-1,r=e.indexOf("safari-web-extension")!==-1;return n||r?[e.indexOf("@")!==-1?e.split("@")[0]:Ov,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]},vp=1024,c2="Breadcrumbs",_ee=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:c2,setupOnce(){},setup(n){t.console&&WJ(Nee(n)),t.dom&&uL(xee(n,t.dom)),t.xhr&&Sw(Pee(n)),t.fetch&&Iw(Mee(n)),t.history&&wv(Oee(n)),t.sentry&&n.on&&n.on("beforeSendEvent",Ree(n))}}},l2=_ee;cc(c2,l2);function Ree(e){return function(n){ut()===e&&Ya({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:Ca(n)},{event:n})}}function xee(e,t){return function(r){if(ut()!==e)return;let i,s,o=typeof t=="object"?t.serializeAttribute:void 0,a=typeof t=="object"&&typeof t.maxStringLength=="number"?t.maxStringLength:void 0;a&&a>vp&&(pi&&K.warn(`\`dom.maxStringLength\` cannot exceed ${vp}, but a value of ${a} was configured. Sentry will use ${vp} instead.`),a=vp),typeof o=="string"&&(o=[o]);try{const l=r.event,u=Dee(l)?l.target:l;i=Kc(u,{keyAttrs:o,maxStringLength:a}),s=tL(u)}catch{i="<unknown>"}if(i.length===0)return;const c={category:`ui.${r.name}`,message:i};s&&(c.data={"ui.component_name":s}),Ya(c,{event:r.event,name:r.name,global:r.global})}}function Nee(e){return function(n){if(ut()!==e)return;const r={category:"console",data:{arguments:n.args,logger:"console"},level:mY(n.level),message:tT(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)r.message=`Assertion failed: ${tT(n.args.slice(1)," ")||"console.assert"}`,r.data.arguments=n.args.slice(1);else return;Ya(r,{input:n.args,level:n.level})}}function Pee(e){return function(n){if(ut()!==e)return;const{startTimestamp:r,endTimestamp:i}=n,s=n.xhr[Na];if(!r||!i||!s)return;const{method:o,url:a,status_code:c,body:l}=s,u={method:o,url:a,status_code:c},d={xhr:n.xhr,input:l,startTimestamp:r,endTimestamp:i};Ya({category:"xhr",data:u,type:"http"},d)}}function Mee(e){return function(n){if(ut()!==e)return;const{startTimestamp:r,endTimestamp:i}=n;if(i&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.error){const s=n.fetchData,o={data:n.error,input:n.args,startTimestamp:r,endTimestamp:i};Ya({category:"fetch",data:s,level:"error",type:"http"},o)}else{const s=n.response,o={...n.fetchData,status_code:s&&s.status},a={input:n.args,response:s,startTimestamp:r,endTimestamp:i};Ya({category:"fetch",data:o,type:"http"},a)}}}function Oee(e){return function(n){if(ut()!==e)return;let r=n.from,i=n.to;const s=ag(Ye.location.href);let o=r?ag(r):void 0;const a=ag(i);(!o||!o.path)&&(o=s),s.protocol===a.protocol&&s.host===a.host&&(i=a.relative),s.protocol===o.protocol&&s.host===o.host&&(r=o.relative),Ya({category:"navigation",data:{from:r,to:i}})}}function Dee(e){return!!e&&!!e.target}const u2="Dedupe",Lee=()=>{let e;return{name:u2,setupOnce(){},processEvent(t){if(t.type)return t;try{if(Bee(t,e))return pi&&K.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return e=t}}},d2=Lee;cc(u2,d2);function Bee(e,t){return t?!!(Fee(e,t)||Uee(e,t)):!1}function Fee(e,t){const n=e.message,r=t.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!h2(e,t)||!f2(e,t))}function Uee(e,t){const n=FT(t),r=FT(e);return!(!n||!r||n.type!==r.type||n.value!==r.value||!h2(e,t)||!f2(e,t))}function f2(e,t){let n=UT(e),r=UT(t);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let i=0;i<r.length;i++){const s=r[i],o=n[i];if(s.filename!==o.filename||s.lineno!==o.lineno||s.colno!==o.colno||s.function!==o.function)return!1}return!0}function h2(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function FT(e){return e.exception&&e.exception.values&&e.exception.values[0]}function UT(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch{return}}const p2="GlobalHandlers",Vee=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:p2,setupOnce(){Error.stackTraceLimit=50},setup(n){t.onerror&&(Gee(n),VT("onerror")),t.onunhandledrejection&&(Wee(n),VT("onunhandledrejection"))}}},g2=Vee;cc(p2,g2);function Gee(e){fL(t=>{const{stackParser:n,attachStacktrace:r}=v2();if(ut()!==e||s2())return;const{msg:i,url:s,line:o,column:a,error:c}=t,l=c===void 0&&Us(i)?$ee(i,s,o,a):m2(Ow(n,c||i,void 0,r,!1),s,o,a);l.level="error",EL(l,{originalException:c,mechanism:{handled:!1,type:"onerror"}})})}function Wee(e){hL(t=>{const{stackParser:n,attachStacktrace:r}=v2();if(ut()!==e||s2())return;const i=jee(t),s=vw(i)?Hee(i):Ow(n,i,void 0,r,!0);s.level="error",EL(s,{originalException:i,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function jee(e){if(vw(e))return e;const t=e;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch{}return e}function Hee(e){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}}function $ee(e,t,n,r){const i=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let s=gw(e)?e.message:e,o="Error";const a=s.match(i);return a&&(o=a[1],s=a[2]),m2({exception:{values:[{type:o,value:s}]}},t,n,r)}function m2(e,t,n,r){const i=e.exception=e.exception||{},s=i.values=i.values||[],o=s[0]=s[0]||{},a=o.stacktrace=o.stacktrace||{},c=a.frames=a.frames||[],l=isNaN(parseInt(r,10))?void 0:r,u=isNaN(parseInt(n,10))?void 0:n,d=Us(t)&&t.length>0?t:RJ();return c.length===0&&c.push({colno:l,filename:d,function:"?",in_app:!0,lineno:u}),e}function VT(e){pi&&K.log(`Global Handler attached: ${e}`)}function v2(){const e=ut();return e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const y2="HttpContext",zee=()=>({name:y2,setupOnce(){},preprocessEvent(e){if(!Ye.navigator&&!Ye.location&&!Ye.document)return;const t=e.request&&e.request.url||Ye.location&&Ye.location.href,{referrer:n}=Ye.document||{},{userAgent:r}=Ye.navigator||{},i={...e.request&&e.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},s={...e.request,...t&&{url:t},headers:i};e.request=s}}),C2=zee;cc(y2,C2);const Zee="cause",Xee=5,I2="LinkedErrors",Kee=(e={})=>{const t=e.limit||Xee,n=e.key||Zee;return{name:I2,setupOnce(){},preprocessEvent(r,i,s){const o=s.getOptions();AJ(o2,o.stackParser,o.maxValueLength,n,t,r,i)}}},S2=Kee;cc(I2,S2);const Jee=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],b2="TryCatch",Yee=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:b2,setupOnce(){t.setTimeout&&_n(Ye,"setTimeout",GT),t.setInterval&&_n(Ye,"setInterval",GT),t.requestAnimationFrame&&_n(Ye,"requestAnimationFrame",qee),t.XMLHttpRequest&&"XMLHttpRequest"in Ye&&_n(XMLHttpRequest.prototype,"send",Qee);const n=t.eventTarget;n&&(Array.isArray(n)?n:Jee).forEach(ete)}}},w2=Yee;cc(b2,w2);function GT(e){return function(...t){const n=t[0];return t[0]=Fu(n,{mechanism:{data:{function:zo(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function qee(e){return function(t){return e.apply(this,[Fu(t,{mechanism:{data:{function:"requestAnimationFrame",handler:zo(e)},handled:!1,type:"instrument"}})])}}function Qee(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(i=>{i in n&&typeof n[i]=="function"&&_n(n,i,function(s){const o={mechanism:{data:{function:i,handler:zo(s)},handled:!1,type:"instrument"}},a=Cw(s);return a&&(o.mechanism.data.handler=zo(a)),Fu(s,o)})}),e.apply(this,t)}}function ete(e){const t=Ye,n=t[e]&&t[e].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(_n(n,"addEventListener",function(r){return function(i,s,o){try{typeof s.handleEvent=="function"&&(s.handleEvent=Fu(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:zo(s),target:e},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[i,Fu(s,{mechanism:{data:{function:"addEventListener",handler:zo(s),target:e},handled:!1,type:"instrument"}}),o])}}),_n(n,"removeEventListener",function(r){return function(i,s,o){const a=s;try{const c=a&&a.__sentry_wrapped__;c&&r.call(this,i,c,o)}catch{}return r.call(this,i,a,o)}}))}const tte=[ZL(),KL(),w2(),l2(),g2(),S2(),d2(),C2()];function nte(e){return[...tte]}function rte(e={}){e.defaultIntegrations===void 0&&(e.defaultIntegrations=nte()),e.release===void 0&&(typeof __SENTRY_RELEASE__=="string"&&(e.release=__SENTRY_RELEASE__),Ye.SENTRY_RELEASE&&Ye.SENTRY_RELEASE.id&&(e.release=Ye.SENTRY_RELEASE.id)),e.autoSessionTracking===void 0&&(e.autoSessionTracking=!0),e.sendClientReports===void 0&&(e.sendClientReports=!0);const t={...e,stackParser:VJ(e.stackParser||Tee),integrations:Rq(e),transport:e.transport||(dL()?lee:dee)};Uq(oee,t),e.autoSessionTracking&&ite()}const WT=(e={},t=Dr())=>{if(!Ye.document){pi&&K.error("Global document not defined in showReportDialog call");return}const{client:n,scope:r}=t.getStackTop(),i=e.dsn||n&&n.getDsn();if(!i){pi&&K.error("DSN not configured for showReportDialog call");return}r&&(e.user={...r.getUser(),...e.user}),e.eventId||(e.eventId=t.lastEventId());const s=Ye.document.createElement("script");s.async=!0,s.crossOrigin="anonymous",s.src=Tq(i,e),e.onLoad&&(s.onload=e.onLoad);const{onClose:o}=e;if(o){const c=l=>{if(l.data==="__sentry_reportdialog_closed__")try{o()}finally{Ye.removeEventListener("message",c)}};Ye.addEventListener("message",c)}const a=Ye.document.head||Ye.document.body;a?a.appendChild(s):pi&&K.error("Not injecting report dialog. No injection point found in HTML")};function ite(){if(typeof Ye.document>"u"){pi&&K.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}CT({ignoreDuration:!0}),IT(),wv(({from:e,to:t})=>{e!==void 0&&e!==t&&(CT({ignoreDuration:!0}),IT())})}const wt=Je,Lw="sentryReplaySession",ste="replay_event",Bw="Unable to send Replay",ote=3e5,ate=9e5,cte=5e3,lte=5500,ute=6e4,dte=5e3,fte=3,jT=15e4,yp=5e3,hte=3e3,pte=300,Fw=2e7,gte=4999,mte=15e3,HT=36e5;function vte(e,t){return e??t()}function Cm(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,(i==="optionalAccess"||i==="optionalCall")&&n==null)return;i==="access"||i==="optionalAccess"?(t=n,n=s(n)):(i==="call"||i==="optionalCall")&&(n=s((...o)=>n.call(t,...o)),t=void 0)}return n}var gn;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(gn||(gn={}));function yte(e){return e.nodeType===e.ELEMENT_NODE}function ff(e){const t=Cm([e,"optionalAccess",n=>n.host]);return Cm([t,"optionalAccess",n=>n.shadowRoot])===e}function hf(e){return Object.prototype.toString.call(e)==="[object ShadowRoot]"}function Cte(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),e}function Ite(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const n=["@import",`url(${JSON.stringify(e.href)})`];return e.layerName===""?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}function Im(e){try{const t=e.rules||e.cssRules;return t?Cte(Array.from(t,k2).join("")):null}catch{return null}}function k2(e){let t;if(bte(e))try{t=Im(e.styleSheet)||Ite(e)}catch{}else if(wte(e)&&e.selectorText.includes(":"))return Ste(e.cssText);return t||e.cssText}function Ste(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}function bte(e){return"styleSheet"in e}function wte(e){return"selectorText"in e}class A2{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){if(!t)return-1;const n=Cm([this,"access",r=>r.getMeta,"call",r=>r(t),"optionalAccess",r=>r.id]);return vte(n,()=>-1)}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,n){const r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)}replace(t,n){const r=this.getNode(t);if(r){const i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(n,i)}this.idNodeMap.set(t,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function kte(){return new A2}function Dv({maskInputOptions:e,tagName:t,type:n}){return t==="OPTION"&&(t="SELECT"),!!(e[t.toLowerCase()]||n&&e[n]||n==="password"||t==="INPUT"&&!n&&e.text)}function qf({isMasked:e,element:t,value:n,maskInputFn:r}){let i=n||"";return e?(r&&(i=r(i,t)),"*".repeat(i.length)):i}function Uu(e){return e.toLowerCase()}function eS(e){return e.toUpperCase()}const $T="__rrweb_original__";function Ate(e){const t=e.getContext("2d");if(!t)return!0;const n=50;for(let r=0;r<e.width;r+=n)for(let i=0;i<e.height;i+=n){const s=t.getImageData,o=$T in s?s[$T]:s;if(new Uint32Array(o.call(t,r,i,Math.min(n,e.width-r),Math.min(n,e.height-i)).data.buffer).some(c=>c!==0))return!1}return!0}function Uw(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?Uu(t):null}function Sm(e,t,n){return t==="INPUT"&&(n==="radio"||n==="checkbox")?e.getAttribute("value")||"":e.value}let Ete=1;const Tte=new RegExp("[^a-z0-9-_:]"),Qf=-2;function Vw(){return Ete++}function _te(e){if(e instanceof HTMLFormElement)return"form";const t=Uu(e.tagName);return Tte.test(t)?"div":t}function Rte(e){let t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}let Il,zT;const xte=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Nte=/^(?:[a-z+]+:)?\/\//i,Pte=/^www\..*/i,Mte=/^(data:)([^,]*),(.*)/i;function bm(e,t){return(e||"").replace(xte,(n,r,i,s,o,a)=>{const c=i||o||a,l=r||s||"";if(!c)return n;if(Nte.test(c)||Pte.test(c))return`url(${l}${c}${l})`;if(Mte.test(c))return`url(${l}${c}${l})`;if(c[0]==="/")return`url(${l}${Rte(t)+c}${l})`;const u=t.split("/"),d=c.split("/");u.pop();for(const f of d)f!=="."&&(f===".."?u.pop():u.push(f));return`url(${l}${u.join("/")}${l})`})}const Ote=/^[^ \t\n\r\u000c]+/,Dte=/^[, \t\n\r\u000c]+/;function Lte(e,t){if(t.trim()==="")return t;let n=0;function r(s){let o;const a=s.exec(t.substring(n));return a?(o=a[0],n+=o.length,o):""}const i=[];for(;r(Dte),!(n>=t.length);){let s=r(Ote);if(s.slice(-1)===",")s=Hl(e,s.substring(0,s.length-1)),i.push(s);else{let o="";s=Hl(e,s);let a=!1;for(;;){const c=t.charAt(n);if(c===""){i.push((s+o).trim());break}else if(a)c===")"&&(a=!1);else if(c===","){n+=1,i.push((s+o).trim());break}else c==="("&&(a=!0);o+=c,n+=1}}}return i.join(", ")}function Hl(e,t){if(!t||t.trim()==="")return t;const n=e.createElement("a");return n.href=t,n.href}function Bte(e){return!!(e.tagName==="svg"||e.ownerSVGElement)}function Gw(){const e=document.createElement("a");return e.href="",e.href}function E2(e,t,n,r,i,s){return r&&(n==="src"||n==="href"&&!(t==="use"&&r[0]==="#")||n==="xlink:href"&&r[0]!=="#"||n==="background"&&(t==="table"||t==="td"||t==="th")?Hl(e,r):n==="srcset"?Lte(e,r):n==="style"?bm(r,Gw()):t==="object"&&n==="data"?Hl(e,r):typeof s=="function"?s(n,r,i):r)}function T2(e,t,n){return(e==="video"||e==="audio")&&t==="autoplay"}function Fte(e,t,n,r){try{if(r&&e.matches(r))return!1;if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(let i=e.classList.length;i--;){const s=e.classList[i];if(t.test(s))return!0}if(n)return e.matches(n)}catch{}return!1}function Ute(e,t){for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!1}function Ac(e,t,n=1/0,r=0){return!e||e.nodeType!==e.ELEMENT_NODE||r>n?-1:t(e)?r:Ac(e.parentNode,t,n,r+1)}function $l(e,t){return n=>{const r=n;if(r===null)return!1;try{if(e){if(typeof e=="string"){if(r.matches(`.${e}`))return!0}else if(Ute(r,e))return!0}return!!(t&&r.matches(t))}catch{return!1}}}function Vu(e,t,n,r,i,s){try{const o=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(o===null)return!1;if(o.tagName==="INPUT"){const l=o.getAttribute("autocomplete");if(["current-password","new-password","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc"].includes(l))return!0}let a=-1,c=-1;if(s){if(c=Ac(o,$l(r,i)),c<0)return!0;a=Ac(o,$l(t,n),c>=0?c:1/0)}else{if(a=Ac(o,$l(t,n)),a<0)return!1;c=Ac(o,$l(r,i),a>=0?a:1/0)}return a>=0?c>=0?a<=c:!0:c>=0?!1:!!s}catch{}return!!s}function Vte(e,t,n){const r=e.contentWindow;if(!r)return;let i=!1,s;try{s=r.document.readyState}catch{return}if(s!=="complete"){const a=setTimeout(()=>{i||(t(),i=!0)},n);e.addEventListener("load",()=>{clearTimeout(a),i=!0,t()});return}const o="about:blank";if(r.location.href!==o||e.src===o||e.src==="")return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}function Gte(e,t,n){let r=!1,i;try{i=e.sheet}catch{return}if(i)return;const s=setTimeout(()=>{r||(t(),r=!0)},n);e.addEventListener("load",()=>{clearTimeout(s),r=!0,t()})}function Wte(e,t){const{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskAttributeFn:c,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f,inlineStylesheet:h,maskInputOptions:p={},maskTextFn:m,maskInputFn:y,dataURLOptions:g={},inlineImages:v,recordCanvas:S,keepIframeSrcFn:E,newlyAddedElement:k=!1}=t,b=jte(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:gn.Document,childNodes:[],compatMode:e.compatMode}:{type:gn.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:gn.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:b};case e.ELEMENT_NODE:return $te(e,{doc:n,blockClass:i,blockSelector:s,unblockSelector:o,inlineStylesheet:h,maskAttributeFn:c,maskInputOptions:p,maskInputFn:y,dataURLOptions:g,inlineImages:v,recordCanvas:S,keepIframeSrcFn:E,newlyAddedElement:k,rootId:b,maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f});case e.TEXT_NODE:return Hte(e,{maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:f,maskTextFn:m,maskInputOptions:p,maskInputFn:y,rootId:b});case e.CDATA_SECTION_NODE:return{type:gn.CDATA,textContent:"",rootId:b};case e.COMMENT_NODE:return{type:gn.Comment,textContent:e.textContent||"",rootId:b};default:return!1}}function jte(e,t){if(!t.hasNode(e))return;const n=t.getId(e);return n===1?void 0:n}function Hte(e,t){const{maskAllText:n,maskTextClass:r,unmaskTextClass:i,maskTextSelector:s,unmaskTextSelector:o,maskTextFn:a,maskInputOptions:c,maskInputFn:l,rootId:u}=t,d=e.parentNode&&e.parentNode.tagName;let f=e.textContent;const h=d==="STYLE"?!0:void 0,p=d==="SCRIPT"?!0:void 0,m=d==="TEXTAREA"?!0:void 0;if(h&&f){try{e.nextSibling||e.previousSibling||Cm([e,"access",g=>g.parentNode,"access",g=>g.sheet,"optionalAccess",g=>g.cssRules])&&(f=Im(e.parentNode.sheet))}catch(g){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${g}`,e)}f=bm(f,Gw())}p&&(f="SCRIPT_PLACEHOLDER");const y=Vu(e,r,s,i,o,n);if(!h&&!p&&!m&&f&&y&&(f=a?a(f):f.replace(/[\S]/g,"*")),m&&f&&(c.textarea||y)&&(f=l?l(f,e.parentNode):f.replace(/[\S]/g,"*")),d==="OPTION"&&f){const g=Dv({type:null,tagName:d,maskInputOptions:c});f=qf({isMasked:Vu(e,r,s,i,o,g),element:e,value:f,maskInputFn:l})}return{type:gn.Text,textContent:f||"",isStyle:h,rootId:u}}function $te(e,t){const{doc:n,blockClass:r,blockSelector:i,unblockSelector:s,inlineStylesheet:o,maskInputOptions:a={},maskAttributeFn:c,maskInputFn:l,dataURLOptions:u={},inlineImages:d,recordCanvas:f,keepIframeSrcFn:h,newlyAddedElement:p=!1,rootId:m,maskAllText:y,maskTextClass:g,unmaskTextClass:v,maskTextSelector:S,unmaskTextSelector:E}=t,k=Fte(e,r,i,s),b=_te(e);let A={};const _=e.attributes.length;for(let N=0;N<_;N++){const O=e.attributes[N];O.name&&!T2(b,O.name,O.value)&&(A[O.name]=E2(n,b,Uu(O.name),O.value,e,c))}if(b==="link"&&o){const N=Array.from(n.styleSheets).find(D=>D.href===e.href);let O=null;N&&(O=Im(N)),O&&(delete A.rel,delete A.href,A._cssText=bm(O,N.href))}if(b==="style"&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const N=Im(e.sheet);N&&(A._cssText=bm(N,Gw()))}if(b==="input"||b==="textarea"||b==="select"||b==="option"){const N=e,O=Uw(N),D=Sm(N,eS(b),O),U=N.checked;if(O!=="submit"&&O!=="button"&&D){const G=Vu(N,g,S,v,E,Dv({type:O,tagName:eS(b),maskInputOptions:a}));A.value=qf({isMasked:G,element:N,value:D,maskInputFn:l})}U&&(A.checked=U)}if(b==="option"&&(e.selected&&!a.select?A.selected=!0:delete A.selected),b==="canvas"&&f){if(e.__context==="2d")Ate(e)||(A.rr_dataURL=e.toDataURL(u.type,u.quality));else if(!("__context"in e)){const N=e.toDataURL(u.type,u.quality),O=document.createElement("canvas");O.width=e.width,O.height=e.height;const D=O.toDataURL(u.type,u.quality);N!==D&&(A.rr_dataURL=N)}}if(b==="img"&&d){Il||(Il=n.createElement("canvas"),zT=Il.getContext("2d"));const N=e,O=N.crossOrigin;N.crossOrigin="anonymous";const D=()=>{N.removeEventListener("load",D);try{Il.width=N.naturalWidth,Il.height=N.naturalHeight,zT.drawImage(N,0,0),A.rr_dataURL=Il.toDataURL(u.type,u.quality)}catch(U){console.warn(`Cannot inline img src=${N.currentSrc}! Error: ${U}`)}O?A.crossOrigin=O:N.removeAttribute("crossorigin")};N.complete&&N.naturalWidth!==0?D():N.addEventListener("load",D)}if((b==="audio"||b==="video")&&(A.rr_mediaState=e.paused?"paused":"played",A.rr_mediaCurrentTime=e.currentTime),p||(e.scrollLeft&&(A.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(A.rr_scrollTop=e.scrollTop)),k){const{width:N,height:O}=e.getBoundingClientRect();A={class:A.class,rr_width:`${N}px`,rr_height:`${O}px`}}b==="iframe"&&!h(A.src)&&(e.contentDocument||(A.rr_src=A.src),delete A.src);let P;try{customElements.get(b)&&(P=!0)}catch{}return{type:gn.Element,tagName:b,attributes:A,childNodes:[],isSVG:Bte(e)||void 0,needBlock:k,rootId:m,isCustom:P}}function bt(e){return e==null?"":e.toLowerCase()}function zte(e,t){if(t.comment&&e.type===gn.Comment)return!0;if(e.type===gn.Element){if(t.script&&(e.tagName==="script"||e.tagName==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(bt(e.attributes.name).match(/^msapplication-tile(image|color)$/)||bt(e.attributes.name)==="application-name"||bt(e.attributes.rel)==="icon"||bt(e.attributes.rel)==="apple-touch-icon"||bt(e.attributes.rel)==="shortcut icon")))return!0;if(e.tagName==="meta"){if(t.headMetaDescKeywords&&bt(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(bt(e.attributes.property).match(/^(og|twitter|fb):/)||bt(e.attributes.name).match(/^(og|twitter):/)||bt(e.attributes.name)==="pinterest"))return!0;if(t.headMetaRobots&&(bt(e.attributes.name)==="robots"||bt(e.attributes.name)==="googlebot"||bt(e.attributes.name)==="bingbot"))return!0;if(t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0)return!0;if(t.headMetaAuthorship&&(bt(e.attributes.name)==="author"||bt(e.attributes.name)==="generator"||bt(e.attributes.name)==="framework"||bt(e.attributes.name)==="publisher"||bt(e.attributes.name)==="progid"||bt(e.attributes.property).match(/^article:/)||bt(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&(bt(e.attributes.name)==="google-site-verification"||bt(e.attributes.name)==="yandex-verification"||bt(e.attributes.name)==="csrf-token"||bt(e.attributes.name)==="p:domain_verify"||bt(e.attributes.name)==="verify-v1"||bt(e.attributes.name)==="verification"||bt(e.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function zl(e,t){const{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:f=!1,inlineStylesheet:h=!0,maskInputOptions:p={},maskAttributeFn:m,maskTextFn:y,maskInputFn:g,slimDOMOptions:v,dataURLOptions:S={},inlineImages:E=!1,recordCanvas:k=!1,onSerialize:b,onIframeLoad:A,iframeLoadTimeout:_=5e3,onStylesheetLoad:P,stylesheetLoadTimeout:N=5e3,keepIframeSrcFn:O=()=>!1,newlyAddedElement:D=!1}=t;let{preserveWhiteSpace:U=!0}=t;const G=Wte(e,{doc:n,mirror:r,blockClass:i,blockSelector:s,maskAllText:a,unblockSelector:o,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:y,maskInputFn:g,dataURLOptions:S,inlineImages:E,recordCanvas:k,keepIframeSrcFn:O,newlyAddedElement:D});if(!G)return console.warn(e,"not serialized"),null;let z;r.hasNode(e)?z=r.getId(e):zte(G,v)||!U&&G.type===gn.Text&&!G.isStyle&&!G.textContent.replace(/^\s+|\s+$/gm,"").length?z=Qf:z=Vw();const $=Object.assign(G,{id:z});if(r.add(e,$),z===Qf)return null;b&&b(e);let q=!f;if($.type===gn.Element){q=q&&!$.needBlock,delete $.needBlock;const W=e.shadowRoot;W&&hf(W)&&($.isShadowHost=!0)}if(($.type===gn.Document||$.type===gn.Element)&&q){v.headWhitespace&&$.type===gn.Element&&$.tagName==="head"&&(U=!1);const W={doc:n,mirror:r,blockClass:i,blockSelector:s,maskAllText:a,unblockSelector:o,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:f,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:y,maskInputFn:g,slimDOMOptions:v,dataURLOptions:S,inlineImages:E,recordCanvas:k,preserveWhiteSpace:U,onSerialize:b,onIframeLoad:A,iframeLoadTimeout:_,onStylesheetLoad:P,stylesheetLoadTimeout:N,keepIframeSrcFn:O};for(const X of Array.from(e.childNodes)){const ne=zl(X,W);ne&&$.childNodes.push(ne)}if(yte(e)&&e.shadowRoot)for(const X of Array.from(e.shadowRoot.childNodes)){const ne=zl(X,W);ne&&(hf(e.shadowRoot)&&(ne.isShadow=!0),$.childNodes.push(ne))}}return e.parentNode&&ff(e.parentNode)&&hf(e.parentNode)&&($.isShadow=!0),$.type===gn.Element&&$.tagName==="iframe"&&Vte(e,()=>{const W=e.contentDocument;if(W&&A){const X=zl(W,{doc:W,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:y,maskInputFn:g,slimDOMOptions:v,dataURLOptions:S,inlineImages:E,recordCanvas:k,preserveWhiteSpace:U,onSerialize:b,onIframeLoad:A,iframeLoadTimeout:_,onStylesheetLoad:P,stylesheetLoadTimeout:N,keepIframeSrcFn:O});X&&A(e,X)}},_),$.type===gn.Element&&$.tagName==="link"&&$.attributes.rel==="stylesheet"&&Gte(e,()=>{if(P){const W=zl(e,{doc:n,mirror:r,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:p,maskAttributeFn:m,maskTextFn:y,maskInputFn:g,slimDOMOptions:v,dataURLOptions:S,inlineImages:E,recordCanvas:k,preserveWhiteSpace:U,onSerialize:b,onIframeLoad:A,iframeLoadTimeout:_,onStylesheetLoad:P,stylesheetLoadTimeout:N,keepIframeSrcFn:O});W&&P(e,W)}},N),$}function Zte(e,t){const{mirror:n=new A2,blockClass:r="rr-block",blockSelector:i=null,unblockSelector:s=null,maskAllText:o=!1,maskTextClass:a="rr-mask",unmaskTextClass:c=null,maskTextSelector:l=null,unmaskTextSelector:u=null,inlineStylesheet:d=!0,inlineImages:f=!1,recordCanvas:h=!1,maskAllInputs:p=!1,maskAttributeFn:m,maskTextFn:y,maskInputFn:g,slimDOM:v=!1,dataURLOptions:S,preserveWhiteSpace:E,onSerialize:k,onIframeLoad:b,iframeLoadTimeout:A,onStylesheetLoad:_,stylesheetLoadTimeout:P,keepIframeSrcFn:N=()=>!1}=t||{};return zl(e,{doc:e,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,maskAllText:o,maskTextClass:a,unmaskTextClass:c,maskTextSelector:l,unmaskTextSelector:u,skipChild:!1,inlineStylesheet:d,maskInputOptions:p===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:p===!1?{}:p,maskAttributeFn:m,maskTextFn:y,maskInputFn:g,slimDOMOptions:v===!0||v==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:v==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:v===!1?{}:v,dataURLOptions:S,inlineImages:f,recordCanvas:h,preserveWhiteSpace:E,onSerialize:k,onIframeLoad:b,iframeLoadTimeout:A,onStylesheetLoad:_,stylesheetLoadTimeout:P,keepIframeSrcFn:N,newlyAddedElement:!1})}function ha(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,(i==="optionalAccess"||i==="optionalCall")&&n==null)return;i==="access"||i==="optionalAccess"?(t=n,n=s(n)):(i==="call"||i==="optionalCall")&&(n=s((...o)=>n.call(t,...o)),t=void 0)}return n}function ur(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const kl=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let ZT={map:{},getId(){return console.error(kl),-1},getNode(){return console.error(kl),null},removeNodeFromMap(){console.error(kl)},has(){return console.error(kl),!1},reset(){console.error(kl)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(ZT=new Proxy(ZT,{get(e,t,n){return t==="map"&&console.error(kl),Reflect.get(e,t,n)}}));function eh(e,t,n={}){let r=null,i=0;return function(...s){const o=Date.now();!i&&n.leading===!1&&(i=o);const a=t-(o-i),c=this;a<=0||a>t?(r&&(clearTimeout(r),r=null),i=o,e.apply(c,s)):!r&&n.trailing!==!1&&(r=setTimeout(()=>{i=n.leading===!1?0:Date.now(),r=null,e.apply(c,s)},a))}}function _2(e,t,n,r,i=window){const s=i.Object.getOwnPropertyDescriptor(e,t);return i.Object.defineProperty(e,t,r?n:{set(o){setTimeout(()=>{n.set.call(this,o)},0),s&&s.set&&s.set.call(this,o)}}),()=>_2(e,t,s||{},!0)}function Ww(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],i=n(r);return typeof i=="function"&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=i,()=>{e[t]=r}}catch{return()=>{}}}let wm=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(wm=()=>new Date().getTime());function R2(e){const t=e.document;return{left:t.scrollingElement?t.scrollingElement.scrollLeft:e.pageXOffset!==void 0?e.pageXOffset:ha([t,"optionalAccess",n=>n.documentElement,"access",n=>n.scrollLeft])||ha([t,"optionalAccess",n=>n.body,"optionalAccess",n=>n.parentElement,"optionalAccess",n=>n.scrollLeft])||ha([t,"optionalAccess",n=>n.body,"optionalAccess",n=>n.scrollLeft])||0,top:t.scrollingElement?t.scrollingElement.scrollTop:e.pageYOffset!==void 0?e.pageYOffset:ha([t,"optionalAccess",n=>n.documentElement,"access",n=>n.scrollTop])||ha([t,"optionalAccess",n=>n.body,"optionalAccess",n=>n.parentElement,"optionalAccess",n=>n.scrollTop])||ha([t,"optionalAccess",n=>n.body,"optionalAccess",n=>n.scrollTop])||0}}function x2(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function N2(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Fi(e,t,n,r,i){if(!e)return!1;const s=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(!s)return!1;const o=$l(t,n);if(!i){const l=r&&s.matches(r);return o(s)&&!l}const a=Ac(s,o);let c=-1;return a<0?!1:(r&&(c=Ac(s,$l(null,r))),a>-1&&c<0?!0:a<c)}function Xte(e,t){return t.getId(e)!==-1}function p0(e,t){return t.getId(e)===Qf}function P2(e,t){if(ff(e))return!1;const n=t.getId(e);return t.has(n)?e.parentNode&&e.parentNode.nodeType===e.DOCUMENT_NODE?!1:e.parentNode?P2(e.parentNode,t):!0:!0}function tS(e){return!!e.changedTouches}function Kte(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let n=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function M2(e,t){return!!(e.nodeName==="IFRAME"&&t.getMeta(e))}function O2(e,t){return!!(e.nodeName==="LINK"&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&e.getAttribute("rel")==="stylesheet"&&t.getMeta(e))}function nS(e){return!!ha([e,"optionalAccess",t=>t.shadowRoot])}class Jte{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(t){return OY(this.styleIDMap.get(t),()=>-1)}has(t){return this.styleIDMap.has(t)}add(t,n){if(this.has(t))return this.getId(t);let r;return n===void 0?r=this.id++:r=n,this.styleIDMap.set(t,r),this.idStyleMap.set(r,t),r}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function D2(e){let t=null;return ha([e,"access",n=>n.getRootNode,"optionalCall",n=>n(),"optionalAccess",n=>n.nodeType])===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(t=e.getRootNode().host),t}function Yte(e){let t=e,n;for(;n=D2(t);)t=n;return t}function qte(e){const t=e.ownerDocument;if(!t)return!1;const n=Yte(e);return t.contains(n)}function L2(e){const t=e.ownerDocument;return t?t.contains(e)||qte(e):!1}let g0;function Qte(){if(g0)return g0;const e=window.document;let t=window.requestAnimationFrame;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n);const r=n.contentWindow;r&&r.requestAnimationFrame&&(t=r.requestAnimationFrame),e.head.removeChild(n)}catch{}return g0=t.bind(window)}function ene(...e){return Qte()(...e)}var Ue=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(Ue||{}),Ve=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(Ve||{}),nr=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(nr||{}),Ks=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(Ks||{});function tne(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,(i==="optionalAccess"||i==="optionalCall")&&n==null)return;i==="access"||i==="optionalAccess"?(t=n,n=s(n)):(i==="call"||i==="optionalCall")&&(n=s((...o)=>n.call(t,...o)),t=void 0)}return n}function XT(e){return"__ln"in e}class nne{constructor(){this.length=0,this.head=null,this.tail=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let n=this.head;for(let r=0;r<t;r++)n=tne([n,"optionalAccess",i=>i.next])||null;return n}addNode(t){const n={value:t,previous:null,next:null};if(t.__ln=n,t.previousSibling&&XT(t.previousSibling)){const r=t.previousSibling.__ln.next;n.next=r,n.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=n,r&&(r.previous=n)}else if(t.nextSibling&&XT(t.nextSibling)&&t.nextSibling.__ln.previous){const r=t.nextSibling.__ln.previous;n.previous=r,n.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=n,r&&(r.next=n)}else this.head&&(this.head.previous=n),n.next=this.head,this.head=n;n.next===null&&(this.tail=n),this.length++}removeNode(t){const n=t.__ln;this.head&&(n.previous?(n.previous.next=n.next,n.next?n.next.previous=n.previous:this.tail=n.previous):(this.head=n.next,this.head?this.head.previous=null:this.tail=null),t.__ln&&delete t.__ln,this.length--)}}const KT=(e,t)=>`${e}@${t}`;class rne{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=t=>{t.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const t=[],n=new Set,r=new nne,i=c=>{let l=c,u=Qf;for(;u===Qf;)l=l&&l.nextSibling,u=l&&this.mirror.getId(l);return u},s=c=>{if(!c.parentNode||!L2(c))return;const l=ff(c.parentNode)?this.mirror.getId(D2(c)):this.mirror.getId(c.parentNode),u=i(c);if(l===-1||u===-1)return r.addNode(c);const d=zl(c,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:f=>{M2(f,this.mirror)&&this.iframeManager.addIframe(f),O2(f,this.mirror)&&this.stylesheetManager.trackLinkElement(f),nS(c)&&this.shadowDomManager.addShadowRoot(c.shadowRoot,this.doc)},onIframeLoad:(f,h)=>{this.iframeManager.attachIframe(f,h),this.shadowDomManager.observeAttachShadow(f)},onStylesheetLoad:(f,h)=>{this.stylesheetManager.attachLinkElement(f,h)}});d&&(t.push({parentId:l,nextId:u,node:d}),n.add(d.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const c of this.movedSet)JT(this.removes,c,this.mirror)&&!this.movedSet.has(c.parentNode)||s(c);for(const c of this.addedSet)!YT(this.droppedSet,c)&&!JT(this.removes,c,this.mirror)||YT(this.movedSet,c)?s(c):this.droppedSet.add(c);let o=null;for(;r.length;){let c=null;if(o){const l=this.mirror.getId(o.value.parentNode),u=i(o.value);l!==-1&&u!==-1&&(c=o)}if(!c){let l=r.tail;for(;l;){const u=l;if(l=l.previous,u){const d=this.mirror.getId(u.value.parentNode);if(i(u.value)===-1)continue;if(d!==-1){c=u;break}else{const h=u.value;if(h.parentNode&&h.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const p=h.parentNode.host;if(this.mirror.getId(p)!==-1){c=u;break}}}}}}if(!c){for(;r.head;)r.removeNode(r.head.value);break}o=c.previous,r.removeNode(c.value),s(c.value)}const a={texts:this.texts.map(c=>({id:this.mirror.getId(c.node),value:c.value})).filter(c=>!n.has(c.id)).filter(c=>this.mirror.has(c.id)),attributes:this.attributes.map(c=>{const{attributes:l}=c;if(typeof l.style=="string"){const u=JSON.stringify(c.styleDiff),d=JSON.stringify(c._unchangedStyles);u.length<l.style.length&&(u+d).split("var(").length===l.style.split("var(").length&&(l.style=c.styleDiff)}return{id:this.mirror.getId(c.node),attributes:l}}).filter(c=>!n.has(c.id)).filter(c=>this.mirror.has(c.id)),removes:this.removes,adds:t};!a.texts.length&&!a.attributes.length&&!a.removes.length&&!a.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(a))},this.processMutation=t=>{if(p0(t.target,this.mirror))return;let n;try{n=document.implementation.createHTMLDocument()}catch{n=this.doc}switch(t.type){case"characterData":{const r=t.target.textContent;!Fi(t.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)&&r!==t.oldValue&&this.texts.push({value:Vu(t.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&r?this.maskTextFn?this.maskTextFn(r):r.replace(/[\S]/g,"*"):r,node:t.target});break}case"attributes":{const r=t.target;let i=t.attributeName,s=t.target.getAttribute(i);if(i==="value"){const a=Uw(r),c=r.tagName;s=Sm(r,c,a);const l=Dv({maskInputOptions:this.maskInputOptions,tagName:c,type:a}),u=Vu(t.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,l);s=qf({isMasked:u,element:r,value:s,maskInputFn:this.maskInputFn})}if(Fi(t.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||s===t.oldValue)return;let o=this.attributes.find(a=>a.node===t.target);if(r.tagName==="IFRAME"&&i==="src"&&!this.keepIframeSrcFn(s))if(!r.contentDocument)i="rr_src";else return;if(o||(o={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(o)),i==="type"&&r.tagName==="INPUT"&&(t.oldValue||"").toLowerCase()==="password"&&r.setAttribute("data-rr-is-password","true"),!T2(r.tagName,i)&&(o.attributes[i]=E2(this.doc,Uu(r.tagName),Uu(i),s,r,this.maskAttributeFn),i==="style")){const a=n.createElement("span");t.oldValue&&a.setAttribute("style",t.oldValue);for(const c of Array.from(r.style)){const l=r.style.getPropertyValue(c),u=r.style.getPropertyPriority(c);l!==a.style.getPropertyValue(c)||u!==a.style.getPropertyPriority(c)?u===""?o.styleDiff[c]=l:o.styleDiff[c]=[l,u]:o._unchangedStyles[c]=[l,u]}for(const c of Array.from(a.style))r.style.getPropertyValue(c)===""&&(o.styleDiff[c]=!1)}break}case"childList":{if(Fi(t.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;t.addedNodes.forEach(r=>this.genAdds(r,t.target)),t.removedNodes.forEach(r=>{const i=this.mirror.getId(r),s=ff(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);Fi(t.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||p0(r,this.mirror)||!Xte(r,this.mirror)||(this.addedSet.has(r)?(rS(this.addedSet,r),this.droppedSet.add(r)):this.addedSet.has(t.target)&&i===-1||P2(t.target,this.mirror)||(this.movedSet.has(r)&&this.movedMap[KT(i,s)]?rS(this.movedSet,r):this.removes.push({parentId:s,id:i,isShadow:ff(t.target)&&hf(t.target)?!0:void 0})),this.mapRemoves.push(r))});break}}},this.genAdds=(t,n)=>{if(!this.processedNodeManager.inOtherBuffer(t,this)&&!(this.addedSet.has(t)||this.movedSet.has(t))){if(this.mirror.hasNode(t)){if(p0(t,this.mirror))return;this.movedSet.add(t);let r=null;n&&this.mirror.hasNode(n)&&(r=this.mirror.getId(n)),r&&r!==-1&&(this.movedMap[KT(this.mirror.getId(t),r)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);Fi(t,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(t.childNodes.forEach(r=>this.genAdds(r)),nS(t)&&t.shadowRoot.childNodes.forEach(r=>{this.processedNodeManager.add(r,this),this.genAdds(r,t)}))}}}init(t){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(n=>{this[n]=t[n]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function rS(e,t){e.delete(t),t.childNodes.forEach(n=>rS(e,n))}function JT(e,t,n){return e.length===0?!1:B2(e,t,n)}function B2(e,t,n){const{parentNode:r}=t;if(!r)return!1;const i=n.getId(r);return e.some(s=>s.id===i)?!0:B2(e,r,n)}function YT(e,t){return e.size===0?!1:F2(e,t)}function F2(e,t){const{parentNode:n}=t;return n?e.has(n)?!0:F2(e,n):!1}let pf;function ine(e){pf=e}function sne(){pf=void 0}const Ke=e=>pf?(...n)=>{try{return e(...n)}catch(r){if(pf&&pf(r)===!0)return()=>{};throw r}}:e;function ps(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,(i==="optionalAccess"||i==="optionalCall")&&n==null)return;i==="access"||i==="optionalAccess"?(t=n,n=s(n)):(i==="call"||i==="optionalCall")&&(n=s((...o)=>n.call(t,...o)),t=void 0)}return n}const Zl=[];function xh(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function U2(e,t){const n=new rne;Zl.push(n),n.init(e);let r=window.MutationObserver||window.__rrMutationObserver;const i=ps([window,"optionalAccess",o=>o.Zone,"optionalAccess",o=>o.__symbol__,"optionalCall",o=>o("MutationObserver")]);i&&window[i]&&(r=window[i]);const s=new r(Ke(o=>{e.onMutation&&e.onMutation(o)===!1||n.processMutations.bind(n)(o)}));return s.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),s}function one({mousemoveCb:e,sampling:t,doc:n,mirror:r}){if(t.mousemove===!1)return()=>{};const i=typeof t.mousemove=="number"?t.mousemove:50,s=typeof t.mousemoveCallback=="number"?t.mousemoveCallback:500;let o=[],a;const c=eh(Ke(d=>{const f=Date.now()-a;e(o.map(h=>(h.timeOffset-=f,h)),d),o=[],a=null}),s),l=Ke(eh(Ke(d=>{const f=xh(d),{clientX:h,clientY:p}=tS(d)?d.changedTouches[0]:d;a||(a=wm()),o.push({x:h,y:p,id:r.getId(f),timeOffset:wm()-a}),c(typeof DragEvent<"u"&&d instanceof DragEvent?Ve.Drag:d instanceof MouseEvent?Ve.MouseMove:Ve.TouchMove)}),i,{trailing:!1})),u=[ur("mousemove",l,n),ur("touchmove",l,n),ur("drag",l,n)];return Ke(()=>{u.forEach(d=>d())})}function ane({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,sampling:o}){if(o.mouseInteraction===!1)return()=>{};const a=o.mouseInteraction===!0||o.mouseInteraction===void 0?{}:o.mouseInteraction,c=[];let l=null;const u=d=>f=>{const h=xh(f);if(Fi(h,r,i,s,!0))return;let p=null,m=d;if("pointerType"in f){switch(f.pointerType){case"mouse":p=Ks.Mouse;break;case"touch":p=Ks.Touch;break;case"pen":p=Ks.Pen;break}p===Ks.Touch?nr[d]===nr.MouseDown?m="TouchStart":nr[d]===nr.MouseUp&&(m="TouchEnd"):Ks.Pen}else tS(f)&&(p=Ks.Touch);p!==null?(l=p,(m.startsWith("Touch")&&p===Ks.Touch||m.startsWith("Mouse")&&p===Ks.Mouse)&&(p=null)):nr[d]===nr.Click&&(p=l,l=null);const y=tS(f)?f.changedTouches[0]:f;if(!y)return;const g=n.getId(h),{clientX:v,clientY:S}=y;Ke(e)({type:nr[m],id:g,x:v,y:S,...p!==null&&{pointerType:p}})};return Object.keys(nr).filter(d=>Number.isNaN(Number(d))&&!d.endsWith("_Departed")&&a[d]!==!1).forEach(d=>{let f=Uu(d);const h=u(d);if(window.PointerEvent)switch(nr[d]){case nr.MouseDown:case nr.MouseUp:f=f.replace("mouse","pointer");break;case nr.TouchStart:case nr.TouchEnd:return}c.push(ur(f,h,t))}),Ke(()=>{c.forEach(d=>d())})}function V2({scrollCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,sampling:o}){const a=Ke(eh(Ke(c=>{const l=xh(c);if(!l||Fi(l,r,i,s,!0))return;const u=n.getId(l);if(l===t&&t.defaultView){const d=R2(t.defaultView);e({id:u,x:d.left,y:d.top})}else e({id:u,x:l.scrollLeft,y:l.scrollTop})}),o.scroll||100));return ur("scroll",a,t)}function cne({viewportResizeCb:e},{win:t}){let n=-1,r=-1;const i=Ke(eh(Ke(()=>{const s=x2(),o=N2();(n!==s||r!==o)&&(e({width:Number(o),height:Number(s)}),n=s,r=o)}),200));return ur("resize",i,t)}const lne=["INPUT","TEXTAREA","SELECT"],qT=new WeakMap;function une({inputCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,ignoreClass:o,ignoreSelector:a,maskInputOptions:c,maskInputFn:l,sampling:u,userTriggeredOnInput:d,maskTextClass:f,unmaskTextClass:h,maskTextSelector:p,unmaskTextSelector:m}){function y(A){let _=xh(A);const P=A.isTrusted,N=_&&eS(_.tagName);if(N==="OPTION"&&(_=_.parentElement),!_||!N||lne.indexOf(N)<0||Fi(_,r,i,s,!0))return;const O=_;if(O.classList.contains(o)||a&&O.matches(a))return;const D=Uw(_);let U=Sm(O,N,D),G=!1;const z=Dv({maskInputOptions:c,tagName:N,type:D}),$=Vu(_,f,p,h,m,z);(D==="radio"||D==="checkbox")&&(G=_.checked),U=qf({isMasked:$,element:_,value:U,maskInputFn:l}),g(_,d?{text:U,isChecked:G,userTriggered:P}:{text:U,isChecked:G});const q=_.name;D==="radio"&&q&&G&&t.querySelectorAll(`input[type="radio"][name="${q}"]`).forEach(W=>{if(W!==_){const X=qf({isMasked:$,element:W,value:Sm(W,N,D),maskInputFn:l});g(W,d?{text:X,isChecked:!G,userTriggered:!1}:{text:X,isChecked:!G})}})}function g(A,_){const P=qT.get(A);if(!P||P.text!==_.text||P.isChecked!==_.isChecked){qT.set(A,_);const N=n.getId(A);Ke(e)({..._,id:N})}}const S=(u.input==="last"?["change"]:["input","change"]).map(A=>ur(A,Ke(y),t)),E=t.defaultView;if(!E)return()=>{S.forEach(A=>A())};const k=E.Object.getOwnPropertyDescriptor(E.HTMLInputElement.prototype,"value"),b=[[E.HTMLInputElement.prototype,"value"],[E.HTMLInputElement.prototype,"checked"],[E.HTMLSelectElement.prototype,"value"],[E.HTMLTextAreaElement.prototype,"value"],[E.HTMLSelectElement.prototype,"selectedIndex"],[E.HTMLOptionElement.prototype,"selected"]];return k&&k.set&&S.push(...b.map(A=>_2(A[0],A[1],{set(){Ke(y)({target:this,isTrusted:!1})}},!1,E))),Ke(()=>{S.forEach(A=>A())})}function km(e){const t=[];function n(r,i){if(Cp("CSSGroupingRule")&&r.parentRule instanceof CSSGroupingRule||Cp("CSSMediaRule")&&r.parentRule instanceof CSSMediaRule||Cp("CSSSupportsRule")&&r.parentRule instanceof CSSSupportsRule||Cp("CSSConditionRule")&&r.parentRule instanceof CSSConditionRule){const o=Array.from(r.parentRule.cssRules).indexOf(r);i.unshift(o)}else if(r.parentStyleSheet){const o=Array.from(r.parentStyleSheet.cssRules).indexOf(r);i.unshift(o)}return i}return n(e,t)}function pa(e,t,n){let r,i;return e?(e.ownerNode?r=t.getId(e.ownerNode):i=n.getId(e),{styleId:i,id:r}):{}}function dne({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const i=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(i,{apply:Ke((u,d,f)=>{const[h,p]=f,{id:m,styleId:y}=pa(d,t,n.styleMirror);return(m&&m!==-1||y&&y!==-1)&&e({id:m,styleId:y,adds:[{rule:h,index:p}]}),u.apply(d,f)})});const s=r.CSSStyleSheet.prototype.deleteRule;r.CSSStyleSheet.prototype.deleteRule=new Proxy(s,{apply:Ke((u,d,f)=>{const[h]=f,{id:p,styleId:m}=pa(d,t,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&e({id:p,styleId:m,removes:[{index:h}]}),u.apply(d,f)})});let o;r.CSSStyleSheet.prototype.replace&&(o=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(o,{apply:Ke((u,d,f)=>{const[h]=f,{id:p,styleId:m}=pa(d,t,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&e({id:p,styleId:m,replace:h}),u.apply(d,f)})}));let a;r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:Ke((u,d,f)=>{const[h]=f,{id:p,styleId:m}=pa(d,t,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&e({id:p,styleId:m,replaceSync:h}),u.apply(d,f)})}));const c={};Ip("CSSGroupingRule")?c.CSSGroupingRule=r.CSSGroupingRule:(Ip("CSSMediaRule")&&(c.CSSMediaRule=r.CSSMediaRule),Ip("CSSConditionRule")&&(c.CSSConditionRule=r.CSSConditionRule),Ip("CSSSupportsRule")&&(c.CSSSupportsRule=r.CSSSupportsRule));const l={};return Object.entries(c).forEach(([u,d])=>{l[u]={insertRule:d.prototype.insertRule,deleteRule:d.prototype.deleteRule},d.prototype.insertRule=new Proxy(l[u].insertRule,{apply:Ke((f,h,p)=>{const[m,y]=p,{id:g,styleId:v}=pa(h.parentStyleSheet,t,n.styleMirror);return(g&&g!==-1||v&&v!==-1)&&e({id:g,styleId:v,adds:[{rule:m,index:[...km(h),y||0]}]}),f.apply(h,p)})}),d.prototype.deleteRule=new Proxy(l[u].deleteRule,{apply:Ke((f,h,p)=>{const[m]=p,{id:y,styleId:g}=pa(h.parentStyleSheet,t,n.styleMirror);return(y&&y!==-1||g&&g!==-1)&&e({id:y,styleId:g,removes:[{index:[...km(h),m]}]}),f.apply(h,p)})})}),Ke(()=>{r.CSSStyleSheet.prototype.insertRule=i,r.CSSStyleSheet.prototype.deleteRule=s,o&&(r.CSSStyleSheet.prototype.replace=o),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(c).forEach(([u,d])=>{d.prototype.insertRule=l[u].insertRule,d.prototype.deleteRule=l[u].deleteRule})})}function G2({mirror:e,stylesheetManager:t},n){let r=null;n.nodeName==="#document"?r=e.getId(n):r=e.getId(n.host);const i=n.nodeName==="#document"?ps([n,"access",o=>o.defaultView,"optionalAccess",o=>o.Document]):ps([n,"access",o=>o.ownerDocument,"optionalAccess",o=>o.defaultView,"optionalAccess",o=>o.ShadowRoot]),s=ps([i,"optionalAccess",o=>o.prototype])?Object.getOwnPropertyDescriptor(ps([i,"optionalAccess",o=>o.prototype]),"adoptedStyleSheets"):void 0;return r===null||r===-1||!i||!s?()=>{}:(Object.defineProperty(n,"adoptedStyleSheets",{configurable:s.configurable,enumerable:s.enumerable,get(){return ps([s,"access",o=>o.get,"optionalAccess",o=>o.call,"call",o=>o(this)])},set(o){const a=ps([s,"access",c=>c.set,"optionalAccess",c=>c.call,"call",c=>c(this,o)]);if(r!==null&&r!==-1)try{t.adoptStyleSheets(o,r)}catch{}return a}}),Ke(()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:s.configurable,enumerable:s.enumerable,get:s.get,set:s.set})}))}function fne({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:r},{win:i}){const s=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:Ke((a,c,l)=>{const[u,d,f]=l;if(n.has(u))return s.apply(c,[u,d,f]);const{id:h,styleId:p}=pa(ps([c,"access",m=>m.parentRule,"optionalAccess",m=>m.parentStyleSheet]),t,r.styleMirror);return(h&&h!==-1||p&&p!==-1)&&e({id:h,styleId:p,set:{property:u,value:d,priority:f},index:km(c.parentRule)}),a.apply(c,l)})});const o=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(o,{apply:Ke((a,c,l)=>{const[u]=l;if(n.has(u))return o.apply(c,[u]);const{id:d,styleId:f}=pa(ps([c,"access",h=>h.parentRule,"optionalAccess",h=>h.parentStyleSheet]),t,r.styleMirror);return(d&&d!==-1||f&&f!==-1)&&e({id:d,styleId:f,remove:{property:u},index:km(c.parentRule)}),a.apply(c,l)})}),Ke(()=>{i.CSSStyleDeclaration.prototype.setProperty=s,i.CSSStyleDeclaration.prototype.removeProperty=o})}function hne({mediaInteractionCb:e,blockClass:t,blockSelector:n,unblockSelector:r,mirror:i,sampling:s,doc:o}){const a=Ke(l=>eh(Ke(u=>{const d=xh(u);if(!d||Fi(d,t,n,r,!0))return;const{currentTime:f,volume:h,muted:p,playbackRate:m}=d;e({type:l,id:i.getId(d),currentTime:f,volume:h,muted:p,playbackRate:m})}),s.media||500)),c=[ur("play",a(0),o),ur("pause",a(1),o),ur("seeked",a(2),o),ur("volumechange",a(3),o),ur("ratechange",a(4),o)];return Ke(()=>{c.forEach(l=>l())})}function pne({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const r=[],i=new WeakMap,s=n.FontFace;n.FontFace=function(c,l,u){const d=new s(c,l,u);return i.set(d,{family:c,buffer:typeof l!="string",descriptors:u,fontSource:typeof l=="string"?l:JSON.stringify(Array.from(new Uint8Array(l)))}),d};const o=Ww(t.fonts,"add",function(a){return function(c){return setTimeout(Ke(()=>{const l=i.get(c);l&&(e(l),i.delete(c))}),0),a.apply(this,[c])}});return r.push(()=>{n.FontFace=s}),r.push(o),Ke(()=>{r.forEach(a=>a())})}function gne(e){const{doc:t,mirror:n,blockClass:r,blockSelector:i,unblockSelector:s,selectionCb:o}=e;let a=!0;const c=Ke(()=>{const l=t.getSelection();if(!l||a&&ps([l,"optionalAccess",f=>f.isCollapsed]))return;a=l.isCollapsed||!1;const u=[],d=l.rangeCount||0;for(let f=0;f<d;f++){const h=l.getRangeAt(f),{startContainer:p,startOffset:m,endContainer:y,endOffset:g}=h;Fi(p,r,i,s,!0)||Fi(y,r,i,s,!0)||u.push({start:n.getId(p),startOffset:m,end:n.getId(y),endOffset:g})}o({ranges:u})});return c(),ur("selectionchange",c)}function mne({doc:e,customElementCb:t}){const n=e.defaultView;return!n||!n.customElements?()=>{}:Ww(n.customElements,"define",function(i){return function(s,o,a){try{t({define:{name:s}})}catch{}return i.apply(this,[s,o,a])}})}function vne(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};const r=U2(e,e.doc),i=one(e),s=ane(e),o=V2(e),a=cne(e,{win:n}),c=une(e),l=hne(e),u=dne(e,{win:n}),d=G2(e,e.doc),f=fne(e,{win:n}),h=e.collectFonts?pne(e):()=>{},p=gne(e),m=mne(e),y=[];for(const g of e.plugins)y.push(g.observer(g.callback,n,g.options));return Ke(()=>{Zl.forEach(g=>g.reset()),r.disconnect(),i(),s(),o(),a(),c(),l(),u(),d(),f(),h(),p(),m(),y.forEach(g=>g())})}function Cp(e){return typeof window[e]<"u"}function Ip(e){return!!(typeof window[e]<"u"&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class iS{constructor(t){this.generateIdFn=t,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(t,n,r,i){const s=r||this.getIdToRemoteIdMap(t),o=i||this.getRemoteIdToIdMap(t);let a=s.get(n);return a||(a=this.generateIdFn(),s.set(n,a),o.set(a,n)),a}getIds(t,n){const r=this.getIdToRemoteIdMap(t),i=this.getRemoteIdToIdMap(t);return n.map(s=>this.getId(t,s,r,i))}getRemoteId(t,n,r){const i=r||this.getRemoteIdToIdMap(t);if(typeof n!="number")return n;const s=i.get(n);return s||-1}getRemoteIds(t,n){const r=this.getRemoteIdToIdMap(t);return n.map(i=>this.getRemoteId(t,i,r))}reset(t){if(!t){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(t),this.iframeRemoteIdToIdMap.delete(t)}getIdToRemoteIdMap(t){let n=this.iframeIdToRemoteIdMap.get(t);return n||(n=new Map,this.iframeIdToRemoteIdMap.set(t,n)),n}getRemoteIdToIdMap(t){let n=this.iframeRemoteIdToIdMap.get(t);return n||(n=new Map,this.iframeRemoteIdToIdMap.set(t,n)),n}}function QT(e){let t,n=e[0],r=1;for(;r<e.length;){const i=e[r],s=e[r+1];if(r+=2,(i==="optionalAccess"||i==="optionalCall")&&n==null)return;i==="access"||i==="optionalAccess"?(t=n,n=s(n)):(i==="call"||i==="optionalCall")&&(n=s((...o)=>n.call(t,...o)),t=void 0)}return n}class yne{constructor(){this.crossOriginIframeMirror=new iS(Vw),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class Cne{constructor(t){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new iS(Vw),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new iS(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(t){this.iframes.set(t,!0),t.contentWindow&&this.crossOriginIframeMap.set(t.contentWindow,t)}addLoadListener(t){this.loadListener=t}attachIframe(t,n){this.mutationCb({adds:[{parentId:this.mirror.getId(t),nextId:null,node:n}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),QT([this,"access",r=>r.loadListener,"optionalCall",r=>r(t)]),t.contentDocument&&t.contentDocument.adoptedStyleSheets&&t.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(t.contentDocument.adoptedStyleSheets,this.mirror.getId(t.contentDocument))}handleMessage(t){const n=t;if(n.data.type!=="rrweb"||n.origin!==n.data.origin||!t.source)return;const i=this.crossOriginIframeMap.get(t.source);if(!i)return;const s=this.transformCrossOriginEvent(i,n.data.event);s&&this.wrappedEmit(s,n.data.isCheckout)}transformCrossOriginEvent(t,n){switch(n.type){case Ue.FullSnapshot:{this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(n.data.node,t);const r=n.data.node.id;return this.crossOriginIframeRootIdMap.set(t,r),this.patchRootIdOnNode(n.data.node,r),{timestamp:n.timestamp,type:Ue.IncrementalSnapshot,data:{source:Ve.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:n.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case Ue.Meta:case Ue.Load:case Ue.DomContentLoaded:return!1;case Ue.Plugin:return n;case Ue.Custom:return this.replaceIds(n.data.payload,t,["id","parentId","previousId","nextId"]),n;case Ue.IncrementalSnapshot:switch(n.data.source){case Ve.Mutation:return n.data.adds.forEach(r=>{this.replaceIds(r,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(r.node,t);const i=this.crossOriginIframeRootIdMap.get(t);i&&this.patchRootIdOnNode(r.node,i)}),n.data.removes.forEach(r=>{this.replaceIds(r,t,["parentId","id"])}),n.data.attributes.forEach(r=>{this.replaceIds(r,t,["id"])}),n.data.texts.forEach(r=>{this.replaceIds(r,t,["id"])}),n;case Ve.Drag:case Ve.TouchMove:case Ve.MouseMove:return n.data.positions.forEach(r=>{this.replaceIds(r,t,["id"])}),n;case Ve.ViewportResize:return!1;case Ve.MediaInteraction:case Ve.MouseInteraction:case Ve.Scroll:case Ve.CanvasMutation:case Ve.Input:return this.replaceIds(n.data,t,["id"]),n;case Ve.StyleSheetRule:case Ve.StyleDeclaration:return this.replaceIds(n.data,t,["id"]),this.replaceStyleIds(n.data,t,["styleId"]),n;case Ve.Font:return n;case Ve.Selection:return n.data.ranges.forEach(r=>{this.replaceIds(r,t,["start","end"])}),n;case Ve.AdoptedStyleSheet:return this.replaceIds(n.data,t,["id"]),this.replaceStyleIds(n.data,t,["styleIds"]),QT([n,"access",r=>r.data,"access",r=>r.styles,"optionalAccess",r=>r.forEach,"call",r=>r(i=>{this.replaceStyleIds(i,t,["styleId"])})]),n}}return!1}replace(t,n,r,i){for(const s of i)!Array.isArray(n[s])&&typeof n[s]!="number"||(Array.isArray(n[s])?n[s]=t.getIds(r,n[s]):n[s]=t.getId(r,n[s]));return n}replaceIds(t,n,r){return this.replace(this.crossOriginIframeMirror,t,n,r)}replaceStyleIds(t,n,r){return this.replace(this.crossOriginIframeStyleMirror,t,n,r)}replaceIdOnNode(t,n){this.replaceIds(t,n,["id","rootId"]),"childNodes"in t&&t.childNodes.forEach(r=>{this.replaceIdOnNode(r,n)})}patchRootIdOnNode(t,n){t.type!==gn.Document&&!t.rootId&&(t.rootId=n),"childNodes"in t&&t.childNodes.forEach(r=>{this.patchRootIdOnNode(r,n)})}}class Ine{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class Sne{constructor(t){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(t,n){if(!hf(t)||this.shadowDoms.has(t))return;this.shadowDoms.add(t);const r=U2({...this.bypassOptions,doc:n,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},t);this.restoreHandlers.push(()=>r.disconnect()),this.restoreHandlers.push(V2({...this.bypassOptions,scrollCb:this.scrollCb,doc:t,mirror:this.mirror})),setTimeout(()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(t.host)),this.restoreHandlers.push(G2({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t))},0)}observeAttachShadow(t){!t.contentWindow||!t.contentDocument||this.patchAttachShadow(t.contentWindow.Element,t.contentDocument)}patchAttachShadow(t,n){const r=this;this.restoreHandlers.push(Ww(t.prototype,"attachShadow",function(i){return function(s){const o=i.call(this,s);return this.shadowRoot&&L2(this)&&r.addShadowRoot(this.shadowRoot,n),o}}))}reset(){this.restoreHandlers.forEach(t=>{try{t()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}class e_{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}snapshot(){}}class bne{constructor(t){this.trackedLinkElements=new WeakSet,this.styleMirror=new Jte,this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,n){"_cssText"in n.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:n.id,attributes:n.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,n){if(t.length===0)return;const r={id:n,styleIds:[]},i=[];for(const s of t){let o;this.styleMirror.has(s)?o=this.styleMirror.getId(s):(o=this.styleMirror.add(s),i.push({styleId:o,rules:Array.from(s.rules||CSSRule,(a,c)=>({rule:k2(a),index:c}))})),r.styleIds.push(o)}i.length>0&&(r.styles=i),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}}class wne{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){ene(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(t,n){const r=this.nodeMap.get(t);return r&&Array.from(r).some(i=>i!==n)}add(t,n){this.nodeMap.set(t,(this.nodeMap.get(t)||new Set).add(n))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}function sn(e){const t=e;return t.timestamp=wm(),t}let Am;const wi=kte();function ja(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:i="rr-block",blockSelector:s=null,unblockSelector:o=null,ignoreClass:a="rr-ignore",ignoreSelector:c=null,maskAllText:l=!1,maskTextClass:u="rr-mask",unmaskTextClass:d=null,maskTextSelector:f=null,unmaskTextSelector:h=null,inlineStylesheet:p=!0,maskAllInputs:m,maskInputOptions:y,slimDOMOptions:g,maskAttributeFn:v,maskInputFn:S,maskTextFn:E,packFn:k,sampling:b={},dataURLOptions:A={},mousemoveWait:_,recordCanvas:P=!1,recordCrossOriginIframes:N=!1,recordAfter:O=e.recordAfter==="DOMContentLoaded"?e.recordAfter:"load",userTriggeredOnInput:D=!1,collectFonts:U=!1,inlineImages:G=!1,plugins:z,keepIframeSrcFn:$=()=>!1,ignoreCSSAttributes:q=new Set([]),errorHandler:W,onMutation:X,getCanvasManager:ne}=e;ine(W);const Z=N?window.parent===window:!0;let ie=!1;if(!Z)try{window.parent.document&&(ie=!1)}catch{ie=!0}if(Z&&!t)throw new Error("emit function is required");_!==void 0&&b.mousemove===void 0&&(b.mousemove=_),wi.reset();const ke=m===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:y!==void 0?y:{},Ee=g===!0||g==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:g==="all",headMetaDescKeywords:g==="all"}:g||{};Kte();let ge,Te=0;const Qe=le=>{for(const Fe of z||[])Fe.eventProcessor&&(le=Fe.eventProcessor(le));return k&&!ie&&(le=k(le)),le},ae=(le,Fe)=>{if(l0([Zl,"access",Ie=>Ie[0],"optionalAccess",Ie=>Ie.isFrozen,"call",Ie=>Ie()])&&le.type!==Ue.FullSnapshot&&!(le.type===Ue.IncrementalSnapshot&&le.data.source===Ve.Mutation)&&Zl.forEach(Ie=>Ie.unfreeze()),Z)l0([t,"optionalCall",Ie=>Ie(Qe(le),Fe)]);else if(ie){const Ie={type:"rrweb",event:Qe(le),origin:window.location.origin,isCheckout:Fe};window.parent.postMessage(Ie,"*")}if(le.type===Ue.FullSnapshot)ge=le,Te=0;else if(le.type===Ue.IncrementalSnapshot){if(le.data.source===Ve.Mutation&&le.data.isAttachIframe)return;Te++;const Ie=r&&Te>=r,Ze=n&&le.timestamp-ge.timestamp>n;(Ie||Ze)&&tt(!0)}},rn=le=>{ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.Mutation,...le}}))},In=le=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.Scroll,...le}})),Ct=le=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.CanvasMutation,...le}})),cn=le=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.AdoptedStyleSheet,...le}})),dt=new bne({mutationCb:rn,adoptedStyleSheetCb:cn}),Ut=typeof __RRWEB_EXCLUDE_IFRAME__=="boolean"&&__RRWEB_EXCLUDE_IFRAME__?new yne:new Cne({mirror:wi,mutationCb:rn,stylesheetManager:dt,recordCrossOriginIframes:N,wrappedEmit:ae});for(const le of z||[])le.getMirror&&le.getMirror({nodeMirror:wi,crossOriginIframeMirror:Ut.crossOriginIframeMirror,crossOriginIframeStyleMirror:Ut.crossOriginIframeStyleMirror});const ce=new wne,Ce=Ane(ne,{mirror:wi,win:window,mutationCb:le=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.CanvasMutation,...le}})),recordCanvas:P,blockClass:i,blockSelector:s,unblockSelector:o,sampling:b.canvas,dataURLOptions:A,errorHandler:W}),rt=typeof __RRWEB_EXCLUDE_SHADOW_DOM__=="boolean"&&__RRWEB_EXCLUDE_SHADOW_DOM__?new Ine:new Sne({mutationCb:rn,scrollCb:In,bypassOptions:{onMutation:X,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,inlineStylesheet:p,maskInputOptions:ke,dataURLOptions:A,maskAttributeFn:v,maskTextFn:E,maskInputFn:S,recordCanvas:P,inlineImages:G,sampling:b,slimDOMOptions:Ee,iframeManager:Ut,stylesheetManager:dt,canvasManager:Ce,keepIframeSrcFn:$,processedNodeManager:ce},mirror:wi}),tt=(le=!1)=>{ae(sn({type:Ue.Meta,data:{href:window.location.href,width:N2(),height:x2()}}),le),dt.reset(),rt.init(),Zl.forEach(Ie=>Ie.lock());const Fe=Zte(document,{mirror:wi,blockClass:i,blockSelector:s,unblockSelector:o,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,inlineStylesheet:p,maskAllInputs:ke,maskAttributeFn:v,maskInputFn:S,maskTextFn:E,slimDOM:Ee,dataURLOptions:A,recordCanvas:P,inlineImages:G,onSerialize:Ie=>{M2(Ie,wi)&&Ut.addIframe(Ie),O2(Ie,wi)&&dt.trackLinkElement(Ie),nS(Ie)&&rt.addShadowRoot(Ie.shadowRoot,document)},onIframeLoad:(Ie,Ze)=>{Ut.attachIframe(Ie,Ze),rt.observeAttachShadow(Ie)},onStylesheetLoad:(Ie,Ze)=>{dt.attachLinkElement(Ie,Ze)},keepIframeSrcFn:$});if(!Fe)return console.warn("Failed to snapshot the document");ae(sn({type:Ue.FullSnapshot,data:{node:Fe,initialOffset:R2(window)}})),Zl.forEach(Ie=>Ie.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&dt.adoptStyleSheets(document.adoptedStyleSheets,wi.getId(document))};Am=tt;try{const le=[],Fe=Ze=>Ke(vne)({onMutation:X,mutationCb:rn,mousemoveCb:(Pe,Ht)=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ht,positions:Pe}})),mouseInteractionCb:Pe=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.MouseInteraction,...Pe}})),scrollCb:In,viewportResizeCb:Pe=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.ViewportResize,...Pe}})),inputCb:Pe=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.Input,...Pe}})),mediaInteractionCb:Pe=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.MediaInteraction,...Pe}})),styleSheetRuleCb:Pe=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.StyleSheetRule,...Pe}})),styleDeclarationCb:Pe=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.StyleDeclaration,...Pe}})),canvasMutationCb:Ct,fontCb:Pe=>ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.Font,...Pe}})),selectionCb:Pe=>{ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.Selection,...Pe}}))},customElementCb:Pe=>{ae(sn({type:Ue.IncrementalSnapshot,data:{source:Ve.CustomElement,...Pe}}))},blockClass:i,ignoreClass:a,ignoreSelector:c,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:f,unmaskTextSelector:h,maskInputOptions:ke,inlineStylesheet:p,sampling:b,recordCanvas:P,inlineImages:G,userTriggeredOnInput:D,collectFonts:U,doc:Ze,maskAttributeFn:v,maskInputFn:S,maskTextFn:E,keepIframeSrcFn:$,blockSelector:s,unblockSelector:o,slimDOMOptions:Ee,dataURLOptions:A,mirror:wi,iframeManager:Ut,stylesheetManager:dt,shadowDomManager:rt,processedNodeManager:ce,canvasManager:Ce,ignoreCSSAttributes:q,plugins:l0([z,"optionalAccess",Pe=>Pe.filter,"call",Pe=>Pe(Ht=>Ht.observer),"optionalAccess",Pe=>Pe.map,"call",Pe=>Pe(Ht=>({observer:Ht.observer,options:Ht.options,callback:Sn=>ae(sn({type:Ue.Plugin,data:{plugin:Ht.name,payload:Sn}}))}))])||[]},{});Ut.addLoadListener(Ze=>{try{le.push(Fe(Ze.contentDocument))}catch(Pe){console.warn(Pe)}});const Ie=()=>{tt(),le.push(Fe(document))};return document.readyState==="interactive"||document.readyState==="complete"?Ie():(le.push(ur("DOMContentLoaded",()=>{ae(sn({type:Ue.DomContentLoaded,data:{}})),O==="DOMContentLoaded"&&Ie()})),le.push(ur("load",()=>{ae(sn({type:Ue.Load,data:{}})),O==="load"&&Ie()},window))),()=>{le.forEach(Ze=>Ze()),ce.destroy(),Am=void 0,sne()}}catch(le){console.warn(le)}}function kne(e){if(!Am)throw new Error("please take full snapshot after start recording");Am(e)}ja.mirror=wi;ja.takeFullSnapshot=kne;function Ane(e,t){try{return e?e(t):new e_}catch{return console.warn("Unable to initialize CanvasManager"),new e_}}const Ene=3,Tne=5;function jw(e){return e>9999999999?e:e*1e3}function m0(e){return e>9999999999?e/1e3:e}function Nh(e,t){t.category!=="sentry.transaction"&&(["ui.click","ui.input"].includes(t.category)?e.triggerUserActivity():e.checkAndHandleExpiredSession(),e.addUpdate(()=>(e.throttledAddEvent({type:Ue.Custom,timestamp:(t.timestamp||0)*1e3,data:{tag:"breadcrumb",payload:hs(t,10,1e3)}}),t.category==="console")))}const _ne="button,a";function W2(e){return e.closest(_ne)||e}function j2(e){const t=H2(e);return!t||!(t instanceof Element)?t:W2(t)}function H2(e){return Rne(e)?e.target:e}function Rne(e){return typeof e=="object"&&!!e&&"target"in e}let ga;function xne(e){return ga||(ga=[],Nne()),ga.push(e),()=>{const t=ga?ga.indexOf(e):-1;t>-1&&ga.splice(t,1)}}function Nne(){_n(wt,"open",function(e){return function(...t){if(ga)try{ga.forEach(n=>n())}catch{}return e.apply(wt,t)}})}function Pne(e,t,n){e.handleClick(t,n)}class Mne{constructor(t,n,r=Nh){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=n.timeout/1e3,this._threshold=n.threshold/1e3,this._scollTimeout=n.scrollTimeout/1e3,this._replay=t,this._ignoreSelector=n.ignoreSelector,this._addBreadcrumbEvent=r}addListeners(){const t=xne(()=>{this._lastMutation=t_()});this._teardown=()=>{t(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(t,n){if(Dne(n,this._ignoreSelector)||!Lne(t))return;const r={timestamp:m0(t.timestamp),clickBreadcrumb:t,clickCount:0,node:n};this._clicks.some(i=>i.node===r.node&&Math.abs(i.timestamp-r.timestamp)<1)||(this._clicks.push(r),this._clicks.length===1&&this._scheduleCheckClicks())}registerMutation(t=Date.now()){this._lastMutation=m0(t)}registerScroll(t=Date.now()){this._lastScroll=m0(t)}registerClick(t){const n=W2(t);this._handleMultiClick(n)}_handleMultiClick(t){this._getClicks(t).forEach(n=>{n.clickCount++})}_getClicks(t){return this._clicks.filter(n=>n.node===t)}_checkClicks(){const t=[],n=t_();this._clicks.forEach(r=>{!r.mutationAfter&&this._lastMutation&&(r.mutationAfter=r.timestamp<=this._lastMutation?this._lastMutation-r.timestamp:void 0),!r.scrollAfter&&this._lastScroll&&(r.scrollAfter=r.timestamp<=this._lastScroll?this._lastScroll-r.timestamp:void 0),r.timestamp+this._timeout<=n&&t.push(r)});for(const r of t){const i=this._clicks.indexOf(r);i>-1&&(this._generateBreadcrumbs(r),this._clicks.splice(i,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(t){const n=this._replay,r=t.scrollAfter&&t.scrollAfter<=this._scollTimeout,i=t.mutationAfter&&t.mutationAfter<=this._threshold,s=!r&&!i,{clickCount:o,clickBreadcrumb:a}=t;if(s){const c=Math.min(t.mutationAfter||this._timeout,this._timeout)*1e3,l=c<this._timeout*1e3?"mutation":"timeout",u={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.slowClickDetected",data:{...a.data,url:wt.location.href,route:n.getCurrentRoute(),timeAfterClickMs:c,endReason:l,clickCount:o||1}};this._addBreadcrumbEvent(n,u);return}if(o>1){const c={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.multiClick",data:{...a.data,url:wt.location.href,route:n.getCurrentRoute(),clickCount:o,metric:!0}};this._addBreadcrumbEvent(n,c)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=setTimeout(()=>this._checkClicks(),1e3)}}const One=["A","BUTTON","INPUT"];function Dne(e,t){return!!(!One.includes(e.tagName)||e.tagName==="INPUT"&&!["submit","button"].includes(e.getAttribute("type")||"")||e.tagName==="A"&&(e.hasAttribute("download")||e.hasAttribute("target")&&e.getAttribute("target")!=="_self")||t&&e.matches(t))}function Lne(e){return!!(e.data&&typeof e.data.nodeId=="number"&&e.timestamp)}function t_(){return Date.now()/1e3}function Bne(e,t){try{if(!Fne(t))return;const{source:n}=t.data;if(n===Ve.Mutation&&e.registerMutation(t.timestamp),n===Ve.Scroll&&e.registerScroll(t.timestamp),Une(t)){const{type:r,id:i}=t.data,s=ja.mirror.getNode(i);s instanceof HTMLElement&&r===nr.Click&&e.registerClick(s)}}catch{}}function Fne(e){return e.type===Ene}function Une(e){return e.data.source===Ve.MouseInteraction}function Ls(e){return{timestamp:Date.now()/1e3,type:"default",...e}}var Em;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(Em||(Em={}));const Vne=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function Gne(e){const t={};for(const n in e)if(Vne.has(n)){let r=n;(n==="data-testid"||n==="data-test-id")&&(r="testId"),t[r]=e[n]}return t}const Wne=e=>t=>{if(!e.isEnabled())return;const n=jne(t);if(!n)return;const r=t.name==="click",i=r?t.event:void 0;r&&e.clickDetector&&i&&i.target&&!i.altKey&&!i.metaKey&&!i.ctrlKey&&!i.shiftKey&&Pne(e.clickDetector,n,j2(t.event)),Nh(e,n)};function $2(e,t){const n=ja.mirror.getId(e),r=n&&ja.mirror.getNode(n),i=r&&ja.mirror.getMeta(r),s=i&&$ne(i)?i:null;return{message:t,data:s?{nodeId:n,node:{id:n,tagName:s.tagName,textContent:Array.from(s.childNodes).map(o=>o.type===Em.Text&&o.textContent).filter(Boolean).map(o=>o.trim()).join(""),attributes:Gne(s.attributes)}}:{}}}function jne(e){const{target:t,message:n}=Hne(e);return Ls({category:`ui.${e.name}`,...$2(t,n)})}function Hne(e){const t=e.name==="click";let n,r=null;try{r=t?j2(e.event):H2(e.event),n=Kc(r,{maxStringLength:200})||"<unknown>"}catch{n="<unknown>"}return{target:r,message:n}}function $ne(e){return e.type===Em.Element}function zne(e,t){if(!e.isEnabled())return;e.updateUserActivity();const n=Zne(t);n&&Nh(e,n)}function Zne(e){const{metaKey:t,shiftKey:n,ctrlKey:r,altKey:i,key:s,target:o}=e;if(!o||Xne(o)||!s)return null;const a=t||r||i,c=s.length===1;if(!a&&c)return null;const l=Kc(o,{maxStringLength:200})||"<unknown>",u=$2(o,l);return Ls({category:"ui.keyDown",message:l,data:{...u.data,metaKey:t,shiftKey:n,ctrlKey:r,altKey:i,key:s}})}function Xne(e){return e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable}const n_={resource:Qne,paint:Yne,navigation:qne};function Kne(e){return e.map(Jne).filter(Boolean)}function Jne(e){return n_[e.entryType]?n_[e.entryType](e):null}function Gu(e){return((Qi||wt.performance.timeOrigin)+e)/1e3}function Yne(e){const{duration:t,entryType:n,name:r,startTime:i}=e,s=Gu(i);return{type:n,name:r,start:s,end:s+t,data:void 0}}function qne(e){const{entryType:t,name:n,decodedBodySize:r,duration:i,domComplete:s,encodedBodySize:o,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,domInteractive:l,loadEventStart:u,loadEventEnd:d,redirectCount:f,startTime:h,transferSize:p,type:m}=e;return i===0?null:{type:`${t}.${m}`,start:Gu(h),end:Gu(s),name:n,data:{size:p,decodedBodySize:r,encodedBodySize:o,duration:i,domInteractive:l,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,loadEventStart:u,loadEventEnd:d,domComplete:s,redirectCount:f}}}function Qne(e){const{entryType:t,initiatorType:n,name:r,responseEnd:i,startTime:s,decodedBodySize:o,encodedBodySize:a,responseStatus:c,transferSize:l}=e;return["fetch","xmlhttprequest"].includes(n)?null:{type:`${t}.${n}`,start:Gu(s),end:Gu(i),name:r,data:{size:l,statusCode:c,decodedBodySize:o,encodedBodySize:a}}}function ere(e){const t=e.entries,n=t[t.length-1],r=n?n.element:void 0,i=e.value,s=Gu(i);return{type:"largest-contentful-paint",name:"largest-contentful-paint",start:s,end:s,data:{value:i,size:i,nodeId:r?ja.mirror.getId(r):void 0}}}function tre(e){function t(i){e.performanceEntries.includes(i)||e.performanceEntries.push(i)}function n({entries:i}){i.forEach(t)}const r=[];return["navigation","paint","resource"].forEach(i=>{r.push(Pv(i,n))}),r.push(t2(({metric:i})=>{e.replayPerformanceEntries.push(ere(i))})),()=>{r.forEach(i=>i())}}const mt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,nre='var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var i=new n(31),a=0;a<31;++a)i[a]=e+=1<<t[a-1];var s=new r(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return{b:i,r:s}},o=s(e,2),f=o.b,h=o.r;f[28]=258,h[258]=28;for(var l=s(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,a=0,s=new n(r);a<i;++a)t[a]&&++s[t[a]-1];var o,f=new n(r);for(a=1;a<r;++a)f[a]=f[a-1]+s[a-1]<<1;if(e){o=new n(1<<r);var h=15-r;for(a=0;a<i;++a)if(t[a])for(var l=a<<4|t[a],c=r-t[a],v=f[t[a]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>h]=l}else for(o=new n(i),a=0;a<i;++a)t[a]&&(o[a]=u[f[t[a]-1]++]>>15-t[a]);return o},g=new t(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var w=new t(32);for(c=0;c<32;++c)w[c]=5;var p=d(g,9,0),y=d(w,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==r||r<0)&&(r=0),(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},A=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},_=function(r,e){for(var i=[],a=0;a<r.length;++a)r[a]&&i.push({s:a,f:r[a]});var s=i.length,o=i.slice();if(!s)return{t:F,l:0};if(1==s){var f=new t(i[0].s+1);return f[i[0].s]=1,{t:f,l:1}}i.sort((function(t,n){return t.f-n.f})),i.push({s:-1,f:25001});var h=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:h.f+l.f,l:h,r:l};c!=s-1;)h=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:h.f+l.f,l:h,r:l};var d=o[0].s;for(a=1;a<s;++a)o[a].s>d&&(d=o[a].s);var g=new n(d+1),w=x(i[c-1],g,0);if(w>e){a=0;var p=0,y=w-e,m=1<<y;for(o.sort((function(t,n){return g[n.s]-g[t.s]||t.f-n.f}));a<s;++a){var b=o[a].s;if(!(g[b]>e))break;p+=m-(1<<w-g[b]),g[b]=e}for(p>>=y;p>0;){var M=o[a].s;g[M]<e?p-=1<<e-g[M]++-1:++a}for(;a>=0&&p;--a){var E=o[a].s;g[E]==e&&(--g[E],++p)}w=e}return{t:new t(g),l:w}},x=function(t,n,r){return-1==t.s?Math.max(x(t.l,n,r+1),x(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,a=t[0],s=1,o=function(t){e[i++]=t},f=1;f<=r;++f)if(t[f]==a&&f!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[f]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var a=0;a<e;++a)t[i+a+4]=r[a];return 8*(i+4+e)},C=function(t,r,s,o,f,h,l,u,c,v,m){z(r,m++,s),++f[256];for(var b=_(f,15),M=b.t,E=b.l,x=_(h,15),C=x.t,U=x.l,F=D(M),I=F.c,S=F.n,L=D(C),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=_(q,7),H=G.t,J=G.l,K=19;K>4&&!H[a[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(f,g)+T(h,w)+l,X=T(f,M)+T(h,C)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(C,U,0),R=C;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[a[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=p,P=g,Q=y,R=w;for(B=0;B<u;++B){var rt=o[B];if(rt>255){A(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;A(r,m,Q[et]),m+=R[et],et>3&&(A(r,m,rt>>5&8191),m+=i[et])}else A(r,m,N[rt]),m+=P[rt]}return A(r,m,N[256]),m+P[256]},U=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,a=0|r.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=e+=r[s];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},L=function(a,s,o,f,u){if(!u&&(u={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),v=new t(c.length+a.length);v.set(c),v.set(a,c.length),a=v,u.w=c.length}return function(a,s,o,f,u,c){var v=c.z||a.length,d=new t(f+v+5*(1+Math.ceil(v/7e3))+u),g=d.subarray(f,d.length-u),w=c.l,p=7&(c.r||0);if(s){p&&(g[0]=c.r>>3);for(var y=U[s-1],M=y>>13,E=8191&y,z=(1<<o)-1,A=c.p||new n(32768),_=c.h||new n(z+1),x=Math.ceil(o/3),D=2*x,T=function(t){return(a[t]^a[t+1]<<x^a[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=_[H];if(A[J]=K,_[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!w)){p=C(a,g,0,F,I,S,O,q,G,j-G,p),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(a[j+Q]==a[j+Q-W]){for(var $=0;$<Z&&a[j+$]==a[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-A[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=A[J])&32767}if(R){F[q++]=268435456|h[Q]<<18|l[R];var it=31&h[Q],at=31&l[R];O+=e[it]+i[at],++I[257+it],++S[at],B=j+Q,++L}else F[q++]=a[j],++I[a[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=a[j],++I[a[j]];p=C(a,g,w,F,I,S,O,q,G,j-G,p),w||(c.r=7&p|g[p/8|0]<<3,p-=7,c.h=_,c.p=A,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+w;j+=65535){var st=j+65535;st>=v&&(g[p/8|0]=w,st=v),p=k(g,p+1,a.subarray(j,st))}c.i=v}return b(d,0,f+m(p)+u)}(a,null==s.level?6:s.level,null==s.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+s.mem,o,f,u)},O=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},j=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(L(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var a=this.b.length-this.s.z;a&&(this.b.set(n.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1)),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(a),32768),this.s.z=n.length-a+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n}();function q(t,n){n||(n={});var r=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}}(),e=t.length;r.p(t);var i,a=L(t,n,10+((i=n).filename?i.filename.length+1:0),8),s=a.length;return function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&O(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}}(a,n),O(a,s-8,r.d()),O(a,s-4,e),a}var B=function(){function t(t,n){this.c=S(),this.v=1,j.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),j.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=L(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=S();i.p(n.dictionary),O(t,2,i.d())}}(r,this.o),this.v=0),n&&O(r,r.length-4,this.c.d()),this.ondata(r,n)},t}(),G="undefined"!=typeof TextEncoder&&new TextEncoder,H="undefined"!=typeof TextDecoder&&new TextDecoder;try{H.decode(F,{stream:!0})}catch(t){}var J=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(K(t),this.d=n||!1)},t}();function K(n,r){if(r){for(var e=new t(n.length),i=0;i<n.length;++i)e[i]=n.charCodeAt(i);return e}if(G)return G.encode(n);var a=n.length,s=new t(n.length+(n.length>>1)),o=0,f=function(t){s[o++]=t};for(i=0;i<a;++i){if(o+5>s.length){var h=new t(o+8+(a-i<<1));h.set(s),s=h}var l=n.charCodeAt(i);l<128||r?f(l):l<2048?(f(192|l>>6),f(128|63&l)):l>55295&&l<57344?(f(240|(l=65536+(1047552&l)|1023&n.charCodeAt(++i))>>18),f(128|l>>12&63),f(128|l>>6&63),f(128|63&l)):(f(224|l>>12),f(128|l>>6&63),f(128|63&l))}return b(s,0,o)}const N=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(let r=0,e=t.length;r<e;r++)n+=t[r].length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new B,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new J(((t,n)=>{this.deflate.push(t,n)})),this.stream.push("[")}},P={clear:()=>{N.clear()},addEvent:t=>N.addEvent(t),finish:()=>N.finish(),compress:t=>function(t){return q(K(t))}(t)};addEventListener("message",(function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in P&&"function"==typeof P[n])try{const t=P[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});';function rre(){const e=new Blob([nre]);return URL.createObjectURL(e)}function or(e,t){mt&&(K.info(e),t&&z2(e))}function pu(e,t){mt&&(K.info(e),t&&setTimeout(()=>{z2(e)},0))}function z2(e){Ya({category:"console",data:{logger:"replay"},level:"info",message:e},{level:"info"})}class Hw extends Error{constructor(){super(`Event buffer exceeded maximum size of ${Fw}.`)}}class Z2{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(t){const n=JSON.stringify(t).length;if(this._totalSize+=n,this._totalSize>Fw)throw new Hw;this.events.push(t)}finish(){return new Promise(t=>{const n=this.events;this.clear(),t(JSON.stringify(n))})}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const t=this.events.map(n=>n.timestamp).sort()[0];return t?jw(t):null}}class ire{constructor(t){this._worker=t,this._id=0}ensureReady(){return this._ensureReadyPromise?this._ensureReadyPromise:(this._ensureReadyPromise=new Promise((t,n)=>{this._worker.addEventListener("message",({data:r})=>{r.success?t():n()},{once:!0}),this._worker.addEventListener("error",r=>{n(r)},{once:!0})}),this._ensureReadyPromise)}destroy(){or("[Replay] Destroying compression worker"),this._worker.terminate()}postMessage(t,n){const r=this._getAndIncrementId();return new Promise((i,s)=>{const o=({data:a})=>{const c=a;if(c.method===t&&c.id===r){if(this._worker.removeEventListener("message",o),!c.success){mt&&K.error("[Replay]",c.response),s(new Error("Error in compression worker"));return}i(c.response)}};this._worker.addEventListener("message",o),this._worker.postMessage({id:r,method:t,arg:n})})}_getAndIncrementId(){return this._id++}}class sre{constructor(t){this._worker=new ire(t),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(t){const n=jw(t.timestamp);(!this._earliestTimestamp||n<this._earliestTimestamp)&&(this._earliestTimestamp=n);const r=JSON.stringify(t);return this._totalSize+=r.length,this._totalSize>Fw?Promise.reject(new Hw):this._sendEventToWorker(r)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear").then(null,t=>{mt&&K.warn('[Replay] Sending "clear" message to worker failed',t)})}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(t){return this._worker.postMessage("addEvent",t)}async _finishRequest(){const t=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,t}}class ore{constructor(t){this._fallback=new Z2,this._compression=new sre(t),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(t){this._used.hasCheckout=t}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(t){return this._used.addEvent(t)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch{or("[Replay] Failed to load the compression worker, falling back to simple buffer");return}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:t,hasCheckout:n}=this._fallback,r=[];for(const i of t)r.push(this._compression.addEvent(i));this._compression.hasCheckout=n,this._used=this._compression;try{await Promise.all(r)}catch(i){mt&&K.warn("[Replay] Failed to add events when switching buffers.",i)}}}function are({useCompression:e,workerUrl:t}){if(e&&window.Worker){const n=cre(t);if(n)return n}return or("[Replay] Using simple buffer"),new Z2}function cre(e){try{const t=e||lre();if(!t)return;or(`[Replay] Using compression worker${e?` from ${e}`:""}`);const n=new Worker(t);return new ore(n)}catch{or("[Replay] Failed to create compression worker")}}function lre(){return typeof __SENTRY_EXCLUDE_REPLAY_WORKER__>"u"||!__SENTRY_EXCLUDE_REPLAY_WORKER__?rre():""}function $w(){try{return"sessionStorage"in wt&&!!wt.sessionStorage}catch{return!1}}function ure(e){dre(),e.session=void 0}function dre(){if($w())try{wt.sessionStorage.removeItem(Lw)}catch{}}function X2(e){return e===void 0?!1:Math.random()<e}function K2(e){const t=Date.now(),n=e.id||Jt(),r=e.started||t,i=e.lastActivity||t,s=e.segmentId||0,o=e.sampled,a=e.previousSessionId;return{id:n,started:r,lastActivity:i,segmentId:s,sampled:o,previousSessionId:a}}function zw(e){if($w())try{wt.sessionStorage.setItem(Lw,JSON.stringify(e))}catch{}}function fre(e,t){return X2(e)?"session":t?"buffer":!1}function r_({sessionSampleRate:e,allowBuffering:t,stickySession:n=!1},{previousSessionId:r}={}){const i=fre(e,t),s=K2({sampled:i,previousSessionId:r});return n&&zw(s),s}function hre(e){if(!$w())return null;try{const t=wt.sessionStorage.getItem(Lw);if(!t)return null;const n=JSON.parse(t);return pu("[Replay] Loading existing session",e),K2(n)}catch{return null}}function sS(e,t,n=+new Date){return e===null||t===void 0||t<0?!0:t===0?!1:e+t<=n}function J2(e,{maxReplayDuration:t,sessionIdleExpire:n,targetTime:r=Date.now()}){return sS(e.started,t,r)||sS(e.lastActivity,n,r)}function Y2(e,{sessionIdleExpire:t,maxReplayDuration:n}){return!(!J2(e,{sessionIdleExpire:t,maxReplayDuration:n})||e.sampled==="buffer"&&e.segmentId===0)}function v0({traceInternals:e,sessionIdleExpire:t,maxReplayDuration:n,previousSessionId:r},i){const s=i.stickySession&&hre(e);return s?Y2(s,{sessionIdleExpire:t,maxReplayDuration:n})?(pu("[Replay] Session in sessionStorage is expired, creating new one..."),r_(i,{previousSessionId:s.id})):s:(pu("[Replay] Creating new session",e),r_(i,{previousSessionId:r}))}function pre(e){return e.type===Ue.Custom}function Zw(e,t,n){return Q2(e,t)?(q2(e,t,n),!0):!1}function gre(e,t,n){return Q2(e,t)?q2(e,t,n):Promise.resolve(null)}async function q2(e,t,n){if(!e.eventBuffer)return null;try{n&&e.recordingMode==="buffer"&&e.eventBuffer.clear(),n&&(e.eventBuffer.hasCheckout=!0);const r=e.getOptions(),i=mre(t,r.beforeAddRecordingEvent);return i?await e.eventBuffer.addEvent(i):void 0}catch(r){const i=r&&r instanceof Hw?"addEventSizeExceeded":"addEvent";mt&&K.error(r),await e.stop({reason:i});const s=ut();s&&s.recordDroppedEvent("internal_sdk_error","replay")}}function Q2(e,t){if(!e.eventBuffer||e.isPaused()||!e.isEnabled())return!1;const n=jw(t.timestamp);return n+e.timeouts.sessionIdlePause<Date.now()?!1:n>e.getContext().initialTimestamp+e.getOptions().maxReplayDuration?(or(`[Replay] Skipping event with timestamp ${n} because it is after maxReplayDuration`,e.getOptions()._experiments.traceInternals),!1):!0}function mre(e,t){try{if(typeof t=="function"&&pre(e))return t(e)}catch(n){return mt&&K.error("[Replay] An error occured in the `beforeAddRecordingEvent` callback, skipping the event...",n),null}return e}function Xw(e){return!e.type}function oS(e){return e.type==="transaction"}function vre(e){return e.type==="replay_event"}function i_(e){return e.type==="feedback"}function eB(e){const t=Ire();return(n,r)=>{if(!e.isEnabled()||!Xw(n)&&!oS(n))return;const i=r&&r.statusCode;if(!(t&&(!i||i<200||i>=300))){if(oS(n)){yre(e,n);return}Cre(e,n)}}}function yre(e,t){const n=e.getContext();t.contexts&&t.contexts.trace&&t.contexts.trace.trace_id&&n.traceIds.size<100&&n.traceIds.add(t.contexts.trace.trace_id)}function Cre(e,t){const n=e.getContext();if(t.event_id&&n.errorIds.size<100&&n.errorIds.add(t.event_id),e.recordingMode!=="buffer"||!t.tags||!t.tags.replayId)return;const{beforeErrorSampling:r}=e.getOptions();typeof r=="function"&&!r(t)||setTimeout(()=>{e.sendBufferedReplayOrFlush()})}function Ire(){const e=ut();if(!e)return!1;const t=e.getTransport();return t&&t.send.__sentry__baseTransport__||!1}function Sre(e){return t=>{!e.isEnabled()||!Xw(t)||bre(e,t)}}function bre(e,t){const n=t.exception&&t.exception.values&&t.exception.values[0].value;if(typeof n=="string"&&(n.match(/reactjs\.org\/docs\/error-decoder\.html\?invariant=(418|419|422|423|425)/)||n.match(/(does not match server-rendered HTML|Hydration failed because)/i))){const r=Ls({category:"replay.hydrate-error"});Nh(e,r)}}function wre(e,t){return e.type||!e.exception||!e.exception.values||!e.exception.values.length?!1:!!(t.originalException&&t.originalException.__rrweb__)}function kre(e,t){e.triggerUserActivity(),e.addUpdate(()=>t.timestamp?(e.throttledAddEvent({type:Ue.Custom,timestamp:t.timestamp*1e3,data:{tag:"breadcrumb",payload:{timestamp:t.timestamp,type:"default",category:"sentry.feedback",data:{feedbackId:t.event_id}}}}),!1):!0)}function Are(e,t){return e.recordingMode!=="buffer"||t.message===Bw||!t.exception||t.type?!1:X2(e.getOptions().errorSampleRate)}function Ere(e,t=!1){const n=t?eB(e):void 0;return Object.assign((r,i)=>e.isEnabled()?vre(r)?(delete r.breadcrumbs,r):!Xw(r)&&!oS(r)&&!i_(r)||!e.checkAndHandleExpiredSession()?r:i_(r)?(e.flush(),r.contexts.feedback.replay_id=e.getSessionId(),kre(e,r),r):wre(r,i)&&!e.getOptions()._experiments.captureExceptions?(mt&&K.log("[Replay] Ignoring error from rrweb internals",r),null):((Are(e,r)||e.recordingMode==="session")&&(r.tags={...r.tags,replayId:e.getSessionId()}),n&&n(r,{statusCode:200}),r):r,{id:"Replay"})}function Lv(e,t){return t.map(({type:n,start:r,end:i,name:s,data:o})=>{const a=e.throttledAddEvent({type:Ue.Custom,timestamp:r,data:{tag:"performanceSpan",payload:{op:n,description:s,startTimestamp:r,endTimestamp:i,data:o}}});return typeof a=="string"?Promise.resolve(null):a})}function Tre(e){const{from:t,to:n}=e,r=Date.now()/1e3;return{type:"navigation.push",start:r,end:r,name:n,data:{previous:t}}}function _re(e){return t=>{if(!e.isEnabled())return;const n=Tre(t);n!==null&&(e.getContext().urls.push(n.name),e.triggerUserActivity(),e.addUpdate(()=>(Lv(e,[n]),!1)))}}function Rre(e,t){return mt&&e.getOptions()._experiments.traceInternals?!1:jq(t,ut())}function Bv(e,t){e.isEnabled()&&t!==null&&(Rre(e,t.name)||e.addUpdate(()=>(Lv(e,[t]),!0)))}function xre(e){const{startTimestamp:t,endTimestamp:n,fetchData:r,response:i}=e;if(!n)return null;const{method:s,url:o}=r;return{type:"resource.fetch",start:t/1e3,end:n/1e3,name:o,data:{method:s,statusCode:i?i.status:void 0}}}function Nre(e){return t=>{if(!e.isEnabled())return;const n=xre(t);Bv(e,n)}}function Pre(e){const{startTimestamp:t,endTimestamp:n,xhr:r}=e,i=r[Na];if(!t||!n||!i)return null;const{method:s,url:o,status_code:a}=i;return o===void 0?null:{type:"resource.xhr",name:o,start:t/1e3,end:n/1e3,data:{method:s,statusCode:a}}}function Mre(e){return t=>{if(!e.isEnabled())return;const n=Pre(t);Bv(e,n)}}function Fv(e,t){if(e)try{if(typeof e=="string")return t.encode(e).length;if(e instanceof URLSearchParams)return t.encode(e.toString()).length;if(e instanceof FormData){const n=iB(e);return t.encode(n).length}if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength}catch{}}function tB(e){if(!e)return;const t=parseInt(e,10);return isNaN(t)?void 0:t}function nB(e){try{if(typeof e=="string")return[e];if(e instanceof URLSearchParams)return[e.toString()];if(e instanceof FormData)return[iB(e)];if(!e)return[void 0]}catch{return mt&&K.warn("[Replay] Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return mt&&K.info("[Replay] Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}function Tm(e,t){if(!e)return{headers:{},size:void 0,_meta:{warnings:[t]}};const n={...e._meta},r=n.warnings||[];return n.warnings=[...r,t],e._meta=n,e}function rB(e,t){if(!t)return null;const{startTimestamp:n,endTimestamp:r,url:i,method:s,statusCode:o,request:a,response:c}=t;return{type:e,start:n/1e3,end:r/1e3,name:i,data:_r({method:s,statusCode:o,request:a,response:c})}}function th(e){return{headers:{},size:e,_meta:{warnings:["URL_SKIPPED"]}}}function Ha(e,t,n){if(!t&&Object.keys(e).length===0)return;if(!t)return{headers:e};if(!n)return{headers:e,size:t};const r={headers:e,size:t},{body:i,warnings:s}=Ore(n);return r.body=i,s&&s.length>0&&(r._meta={warnings:s}),r}function aS(e,t){return Object.keys(e).reduce((n,r)=>{const i=r.toLowerCase();return t.includes(i)&&e[r]&&(n[i]=e[r]),n},{})}function iB(e){return new URLSearchParams(e).toString()}function Ore(e){if(!e||typeof e!="string")return{body:e};const t=e.length>jT,n=Dre(e);if(t){const r=e.slice(0,jT);return n?{body:r,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${r}`,warnings:["TEXT_TRUNCATED"]}}if(n)try{return{body:JSON.parse(e)}}catch{}return{body:e}}function Dre(e){const t=e[0],n=e[e.length-1];return t==="["&&n==="]"||t==="{"&&n==="}"}function _m(e,t){const n=Lre(e);return od(n,t)}function Lre(e,t=wt.document.baseURI){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith(wt.location.origin))return e;const n=new URL(e,t);if(n.origin!==new URL(t).origin)return e;const r=n.href;return!e.endsWith("/")&&r.endsWith("/")?r.slice(0,-1):r}async function Bre(e,t,n){try{const r=await Ure(e,t,n),i=rB("resource.fetch",r);Bv(n.replay,i)}catch(r){mt&&K.error("[Replay] Failed to capture fetch breadcrumb",r)}}function Fre(e,t,n){const{input:r,response:i}=t,s=r?sB(r):void 0,o=Fv(s,n.textEncoder),a=i?tB(i.headers.get("content-length")):void 0;o!==void 0&&(e.data.request_body_size=o),a!==void 0&&(e.data.response_body_size=a)}async function Ure(e,t,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:s=r}=t,{url:o,method:a,status_code:c=0,request_body_size:l,response_body_size:u}=e.data,d=_m(o,n.networkDetailAllowUrls)&&!_m(o,n.networkDetailDenyUrls),f=d?Vre(n,t.input,l):th(l),h=await Gre(d,n,t.response,u);return{startTimestamp:i,endTimestamp:s,url:o,method:a,statusCode:c,request:f,response:h}}function Vre({networkCaptureBodies:e,networkRequestHeaders:t},n,r){const i=n?Hre(n,t):{};if(!e)return Ha(i,r,void 0);const s=sB(n),[o,a]=nB(s),c=Ha(i,r,o);return a?Tm(c,a):c}async function Gre(e,{networkCaptureBodies:t,textEncoder:n,networkResponseHeaders:r},i,s){if(!e&&s!==void 0)return th(s);const o=i?oB(i.headers,r):{};if(!i||!t&&s!==void 0)return Ha(o,s,void 0);const[a,c]=await jre(i),l=Wre(a,{networkCaptureBodies:t,textEncoder:n,responseBodySize:s,captureDetails:e,headers:o});return c?Tm(l,c):l}function Wre(e,{networkCaptureBodies:t,textEncoder:n,responseBodySize:r,captureDetails:i,headers:s}){try{const o=e&&e.length&&r===void 0?Fv(e,n):r;return i?t?Ha(s,o,e):Ha(s,o,void 0):th(o)}catch(o){return mt&&K.warn("[Replay] Failed to serialize response body",o),Ha(s,r,void 0)}}async function jre(e){const t=$re(e);if(!t)return[void 0,"BODY_PARSE_ERROR"];try{return[await zre(t)]}catch(n){return mt&&K.warn("[Replay] Failed to get text body from response",n),[void 0,"BODY_PARSE_ERROR"]}}function sB(e=[]){if(!(e.length!==2||typeof e[1]!="object"))return e[1].body}function oB(e,t){const n={};return t.forEach(r=>{e.get(r)&&(n[r]=e.get(r))}),n}function Hre(e,t){return e.length===1&&typeof e[0]!="string"?s_(e[0],t):e.length===2?s_(e[1],t):{}}function s_(e,t){if(!e)return{};const n=e.headers;return n?n instanceof Headers?oB(n,t):Array.isArray(n)?{}:aS(n,t):{}}function $re(e){try{return e.clone()}catch(t){mt&&K.warn("[Replay] Failed to clone response body",t)}}function zre(e){return new Promise((t,n)=>{const r=setTimeout(()=>n(new Error("Timeout while trying to read response body")),500);Zre(e).then(i=>t(i),i=>n(i)).finally(()=>clearTimeout(r))})}async function Zre(e){return await e.text()}async function Xre(e,t,n){try{const r=Jre(e,t,n),i=rB("resource.xhr",r);Bv(n.replay,i)}catch(r){mt&&K.error("[Replay] Failed to capture xhr breadcrumb",r)}}function Kre(e,t,n){const{xhr:r,input:i}=t;if(!r)return;const s=Fv(i,n.textEncoder),o=r.getResponseHeader("content-length")?tB(r.getResponseHeader("content-length")):eie(r.response,r.responseType,n.textEncoder);s!==void 0&&(e.data.request_body_size=s),o!==void 0&&(e.data.response_body_size=o)}function Jre(e,t,n){const r=Date.now(),{startTimestamp:i=r,endTimestamp:s=r,input:o,xhr:a}=t,{url:c,method:l,status_code:u=0,request_body_size:d,response_body_size:f}=e.data;if(!c)return null;if(!a||!_m(c,n.networkDetailAllowUrls)||_m(c,n.networkDetailDenyUrls)){const b=th(d),A=th(f);return{startTimestamp:i,endTimestamp:s,url:c,method:l,statusCode:u,request:b,response:A}}const h=a[Na],p=h?aS(h.request_headers,n.networkRequestHeaders):{},m=aS(Yre(a),n.networkResponseHeaders),[y,g]=n.networkCaptureBodies?nB(o):[void 0],[v,S]=n.networkCaptureBodies?qre(a):[void 0],E=Ha(p,d,y),k=Ha(m,f,v);return{startTimestamp:i,endTimestamp:s,url:c,method:l,statusCode:u,request:g?Tm(E,g):E,response:S?Tm(k,S):k}}function Yre(e){const t=e.getAllResponseHeaders();return t?t.split(`\r
`).reduce((n,r)=>{const[i,s]=r.split(": ");return n[i.toLowerCase()]=s,n},{}):{}}function qre(e){const t=[];try{return[e.responseText]}catch(n){t.push(n)}try{return Qre(e.response,e.responseType)}catch(n){t.push(n)}return mt&&K.warn("[Replay] Failed to get xhr response body",...t),[void 0]}function Qre(e,t){try{if(typeof e=="string")return[e];if(e instanceof Document)return[e.body.outerHTML];if(t==="json"&&e&&typeof e=="object")return[JSON.stringify(e)];if(!e)return[void 0]}catch{return mt&&K.warn("[Replay] Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return mt&&K.info("[Replay] Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}function eie(e,t,n){try{const r=t==="json"&&e&&typeof e=="object"?JSON.stringify(e):e;return Fv(r,n)}catch{return}}function tie(e){const t=ut();try{const n=new TextEncoder,{networkDetailAllowUrls:r,networkDetailDenyUrls:i,networkCaptureBodies:s,networkRequestHeaders:o,networkResponseHeaders:a}=e.getOptions(),c={replay:e,textEncoder:n,networkDetailAllowUrls:r,networkDetailDenyUrls:i,networkCaptureBodies:s,networkRequestHeaders:o,networkResponseHeaders:a};t&&t.on?t.on("beforeAddBreadcrumb",(l,u)=>nie(c,l,u)):(Iw(Nre(e)),Sw(Mre(e)))}catch{}}function nie(e,t,n){if(t.data)try{rie(t)&&sie(n)&&(Kre(t,n,e),Xre(t,n,e)),iie(t)&&oie(n)&&(Fre(t,n,e),Bre(t,n,e))}catch{mt&&K.warn("Error when enriching network breadcrumb")}}function rie(e){return e.category==="xhr"}function iie(e){return e.category==="fetch"}function sie(e){return e&&e.xhr}function oie(e){return e&&e.response}let o_=null;function aie(e){return!!e.category}const cie=e=>t=>{if(!e.isEnabled())return;const n=lie(t);n&&Nh(e,n)};function lie(e){const t=e.getLastBreadcrumb&&e.getLastBreadcrumb();return o_===t||!t||(o_=t,!aie(t)||["fetch","xhr","sentry.event","sentry.transaction"].includes(t.category)||t.category.startsWith("ui."))?null:t.category==="console"?uie(t):Ls(t)}function uie(e){const t=e.data&&e.data.arguments;if(!Array.isArray(t)||t.length===0)return Ls(e);let n=!1;const r=t.map(i=>{if(!i)return i;if(typeof i=="string")return i.length>yp?(n=!0,`${i.slice(0,yp)}`):i;if(typeof i=="object")try{const s=hs(i,7);return JSON.stringify(s).length>yp?(n=!0,`${JSON.stringify(s,null,2).slice(0,yp)}`):s}catch{}return i});return Ls({...e,data:{...e.data,arguments:r,...n?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}function die(e){const t=Ii(),n=ut();t.addScopeListener(cie(e)),uL(Wne(e)),wv(_re(e)),tie(e);const r=Ere(e,!a_(n));n&&n.addEventProcessor?n.addEventProcessor(r):Fq(r),a_(n)&&(n.on("beforeSendEvent",Sre(e)),n.on("afterSendEvent",eB(e)),n.on("createDsc",i=>{const s=e.getSessionId();s&&e.isEnabled()&&e.recordingMode==="session"&&e.checkAndHandleExpiredSession()&&(i.replay_id=s)}),n.on("startTransaction",i=>{e.lastTransaction=i}),n.on("finishTransaction",i=>{e.lastTransaction=i}),n.on("beforeSendFeedback",(i,s)=>{const o=e.getSessionId();s&&s.includeReplay&&e.isEnabled()&&o&&(e.flush(),i.contexts&&i.contexts.feedback&&(i.contexts.feedback.replay_id=o))}))}function a_(e){return!!(e&&e.on)}async function fie(e){try{return Promise.all(Lv(e,[hie(wt.performance.memory)]))}catch{return[]}}function hie(e){const{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}=e,i=Date.now()/1e3;return{type:"memory",name:"memory",start:i,end:i,data:{memory:{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}}}}function pie(e,t,n){let r,i,s;const o=n&&n.maxWait?Math.max(n.maxWait,t):0;function a(){return c(),r=e(),r}function c(){i!==void 0&&clearTimeout(i),s!==void 0&&clearTimeout(s),i=s=void 0}function l(){return i!==void 0||s!==void 0?a():r}function u(){return i&&clearTimeout(i),i=setTimeout(a,t),o&&s===void 0&&(s=setTimeout(a,o)),r}return u.cancel=c,u.flush=l,u}function gie(e){let t=!1;return(n,r)=>{if(!e.checkAndHandleExpiredSession()){mt&&K.warn("[Replay] Received replay event after session expired.");return}const i=r||!t;t=!0,e.clickDetector&&Bne(e.clickDetector,n),e.addUpdate(()=>{if(e.recordingMode==="buffer"&&i&&e.setInitialState(),!Zw(e,n,i))return!0;if(!i)return!1;if(vie(e,i),e.session&&e.session.previousSessionId)return!0;if(e.recordingMode==="buffer"&&e.session&&e.eventBuffer){const s=e.eventBuffer.getEarliestTimestamp();s&&(or(`[Replay] Updating session start time to earliest event in buffer to ${new Date(s)}`,e.getOptions()._experiments.traceInternals),e.session.started=s,e.getOptions().stickySession&&zw(e.session))}return e.recordingMode==="session"&&e.flush(),!0})}}function mie(e){const t=e.getOptions();return{type:Ue.Custom,timestamp:Date.now(),data:{tag:"options",payload:{shouldRecordCanvas:e.isRecordingCanvas(),sessionSampleRate:t.sessionSampleRate,errorSampleRate:t.errorSampleRate,useCompressionOption:t.useCompression,blockAllMedia:t.blockAllMedia,maskAllText:t.maskAllText,maskAllInputs:t.maskAllInputs,useCompression:e.eventBuffer?e.eventBuffer.type==="worker":!1,networkDetailHasUrls:t.networkDetailAllowUrls.length>0,networkCaptureBodies:t.networkCaptureBodies,networkRequestHasHeaders:t.networkRequestHeaders.length>0,networkResponseHasHeaders:t.networkResponseHeaders.length>0}}}}function vie(e,t){!t||!e.session||e.session.segmentId!==0||Zw(e,mie(e),!1)}function yie(e,t,n,r){return ll(yL(e,kw(e),r,n),[[{type:"replay_event"},e],[{type:"replay_recording",length:typeof t=="string"?new TextEncoder().encode(t).length:t.length},t]])}function Cie({recordingData:e,headers:t}){let n;const r=`${JSON.stringify(t)}
`;if(typeof e=="string")n=`${r}${e}`;else{const s=new TextEncoder().encode(r);n=new Uint8Array(s.length+e.length),n.set(s),n.set(e,s.length)}return n}async function Iie({client:e,scope:t,replayId:n,event:r}){const i=typeof e._integrations=="object"&&e._integrations!==null&&!Array.isArray(e._integrations)?Object.keys(e._integrations):void 0,s={event_id:n,integrations:i};e.emit&&e.emit("preprocessEvent",r,s);const o=await AL(e.getOptions(),r,s,t,e,ac());if(!o)return null;o.platform=o.platform||"javascript";const a=e.getSdkMetadata&&e.getSdkMetadata(),{name:c,version:l}=a&&a.sdk||{};return o.sdk={...o.sdk,name:c||"sentry.javascript.unknown",version:l||"0.0.0"},o}async function Sie({recordingData:e,replayId:t,segmentId:n,eventContext:r,timestamp:i,session:s}){const o=Cie({recordingData:e,headers:{segment_id:n}}),{urls:a,errorIds:c,traceIds:l,initialTimestamp:u}=r,d=ut(),f=Ii(),h=d&&d.getTransport(),p=d&&d.getDsn();if(!d||!h||!p||!s.sampled)return;const m={type:ste,replay_start_timestamp:u/1e3,timestamp:i/1e3,error_ids:c,trace_ids:l,urls:a,replay_id:t,segment_id:n,replay_type:s.sampled},y=await Iie({scope:f,client:d,replayId:t,event:m});if(!y){d.recordDroppedEvent("event_processor","replay",m),or("An event processor returned `null`, will not send event.");return}delete y.sdkProcessingMetadata;const g=yie(y,o,p,d.getOptions().tunnel);let v;try{v=await h.send(g)}catch(E){const k=new Error(Bw);try{k.cause=E}catch{}throw k}if(!v)return v;if(typeof v.statusCode=="number"&&(v.statusCode<200||v.statusCode>=300))throw new aB(v.statusCode);const S=IL({},v);if(CL(S,"replay"))throw new cB(S);return v}class aB extends Error{constructor(t){super(`Transport returned status code ${t}`)}}class cB extends Error{constructor(t){super("Rate limit hit"),this.rateLimits=t}}async function lB(e,t={count:0,interval:dte}){const{recordingData:n,options:r}=e;if(n.length)try{return await Sie(e),!0}catch(i){if(i instanceof aB||i instanceof cB)throw i;if(KY("Replays",{_retryCount:t.count}),mt&&r._experiments&&r._experiments.captureExceptions&&Tv(i),t.count>=fte){const s=new Error(`${Bw} - max retries exceeded`);try{s.cause=i}catch{}throw s}return t.interval*=++t.count,new Promise((s,o)=>{setTimeout(async()=>{try{await lB(e,t),s(!0)}catch(a){o(a)}},t.interval)})}}const uB="__THROTTLED",bie="__SKIPPED";function wie(e,t,n){const r=new Map,i=a=>{const c=a-n;r.forEach((l,u)=>{u<c&&r.delete(u)})},s=()=>[...r.values()].reduce((a,c)=>a+c,0);let o=!1;return(...a)=>{const c=Math.floor(Date.now()/1e3);if(i(c),s()>=t){const u=o;return o=!0,u?bie:uB}o=!1;const l=r.get(c)||0;return r.set(c,l+1),e(...a)}}class ma{constructor({options:t,recordingOptions:n}){ma.prototype.__init.call(this),ma.prototype.__init2.call(this),ma.prototype.__init3.call(this),ma.prototype.__init4.call(this),ma.prototype.__init5.call(this),ma.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:ote,sessionIdleExpire:ate},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=n,this._options=t,this._debouncedFlush=pie(()=>this._flush(),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=wie((o,a)=>gre(this,o,a),300,5);const{slowClickTimeout:r,slowClickIgnoreSelectors:i}=this.getOptions(),s=r?{threshold:Math.min(hte,r),timeout:r,scrollTimeout:pte,ignoreSelector:i?i.join(","):""}:void 0;s&&(this.clickDetector=new Mne(this,s))}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}isRecordingCanvas(){return!!this._canvas}getOptions(){return this._options}initializeSampling(t){const{errorSampleRate:n,sessionSampleRate:r}=this._options;if(!(n<=0&&r<=0)){if(this._initializeSessionForSampling(t),!this.session){this._handleException(new Error("Unable to initialize and create session"));return}this.session.sampled!==!1&&(this.recordingMode=this.session.sampled==="buffer"&&this.session.segmentId===0?"buffer":"session",pu(`[Replay] Starting replay in ${this.recordingMode} mode`,this._options._experiments.traceInternals),this._initializeRecording())}}start(){if(this._isEnabled&&this.recordingMode==="session")throw new Error("Replay recording is already in progress");if(this._isEnabled&&this.recordingMode==="buffer")throw new Error("Replay buffering is in progress, call `flush()` to save the replay");pu("[Replay] Starting replay in session mode",this._options._experiments.traceInternals);const t=v0({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=t,this._initializeRecording()}startBuffering(){if(this._isEnabled)throw new Error("Replay recording is already in progress");pu("[Replay] Starting replay in buffer mode",this._options._experiments.traceInternals);const t=v0({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=t,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{const t=this._canvas;this._stopRecording=ja({...this._recordingOptions,...this.recordingMode==="buffer"&&{checkoutEveryNms:ute},emit:gie(this),onMutation:this._onMutationHandler,...t?{recordCanvas:t.recordCanvas,getCanvasManager:t.getCanvasManager,sampling:t.sampling,dataURLOptions:t.dataURLOptions}:{}})}catch(t){this._handleException(t)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(t){return this._handleException(t),!1}}async stop({forceFlush:t=!1,reason:n}={}){if(this._isEnabled){this._isEnabled=!1;try{or(`[Replay] Stopping Replay${n?` triggered by ${n}`:""}`,this._options._experiments.traceInternals),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),t&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,ure(this)}catch(r){this._handleException(r)}}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),or("[Replay] Pausing replay",this._options._experiments.traceInternals))}resume(){!this._isPaused||!this._checkSession()||(this._isPaused=!1,this.startRecording(),or("[Replay] Resuming replay",this._options._experiments.traceInternals))}async sendBufferedReplayOrFlush({continueRecording:t=!0}={}){if(this.recordingMode==="session")return this.flushImmediate();const n=Date.now();or("[Replay] Converting buffer to session",this._options._experiments.traceInternals),await this.flushImmediate();const r=this.stopRecording();!t||!r||this.recordingMode!=="session"&&(this.recordingMode="session",this.session&&(this._updateUserActivity(n),this._updateSessionActivity(n),this._maybeSaveSession()),this.startRecording())}addUpdate(t){const n=t();this.recordingMode!=="buffer"&&n!==!0&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),!this._stopRecording){if(!this._checkSession())return;this.resume();return}this.checkAndHandleExpiredSession(),this._updateSessionActivity()}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return this.recordingMode==="buffer"?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){if(this._lastActivity&&sS(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&this.session.sampled==="session"){this.pause();return}return!!this._checkSession()}setInitialState(){const t=`${wt.location.pathname}${wt.location.hash}${wt.location.search}`,n=`${wt.location.origin}${t}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=n,this._context.initialTimestamp=Date.now(),this._context.urls.push(n)}throttledAddEvent(t,n){const r=this._throttledAddEvent(t,n);if(r===uB){const i=Ls({category:"replay.throttled"});this.addUpdate(()=>!Zw(this,{type:Tne,timestamp:i.timestamp||0,data:{tag:"breadcrumb",payload:i,metric:!0}}))}return r}getCurrentRoute(){const t=this.lastTransaction||Ii().getTransaction(),r=(t&&$n(t).data||{})[Oc];if(!(!t||!r||!["route","custom"].includes(r)))return $n(t).description}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=are({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_handleException(t){mt&&K.error("[Replay]",t),mt&&this._options._experiments&&this._options._experiments.captureExceptions&&Tv(t)}_initializeSessionForSampling(t){const n=this._options.errorSampleRate>0,r=v0({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals,previousSessionId:t},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:n});this.session=r}_checkSession(){if(!this.session)return!1;const t=this.session;return Y2(t,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})?(this._refreshSession(t),!1):!0}async _refreshSession(t){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(t.id))}_addListeners(){try{wt.document.addEventListener("visibilitychange",this._handleVisibilityChange),wt.addEventListener("blur",this._handleWindowBlur),wt.addEventListener("focus",this._handleWindowFocus),wt.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(die(this),this._hasInitializedCoreListeners=!0)}catch(t){this._handleException(t)}this._performanceCleanupCallback=tre(this)}_removeListeners(){try{wt.document.removeEventListener("visibilitychange",this._handleVisibilityChange),wt.removeEventListener("blur",this._handleWindowBlur),wt.removeEventListener("focus",this._handleWindowFocus),wt.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(t){this._handleException(t)}}__init(){this._handleVisibilityChange=()=>{wt.document.visibilityState==="visible"?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const t=Ls({category:"ui.blur"});this._doChangeToBackgroundTasks(t)}}__init3(){this._handleWindowFocus=()=>{const t=Ls({category:"ui.focus"});this._doChangeToForegroundTasks(t)}}__init4(){this._handleKeyboardEvent=t=>{zne(this,t)}}_doChangeToBackgroundTasks(t){!this.session||J2(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(t&&this._createCustomBreadcrumb(t),this.conditionalFlush())}_doChangeToForegroundTasks(t){if(!this.session)return;if(!this.checkAndHandleExpiredSession()){or("[Replay] Document has become active, but session has expired");return}t&&this._createCustomBreadcrumb(t)}_updateUserActivity(t=Date.now()){this._lastActivity=t}_updateSessionActivity(t=Date.now()){this.session&&(this.session.lastActivity=t,this._maybeSaveSession())}_createCustomBreadcrumb(t){this.addUpdate(()=>{this.throttledAddEvent({type:Ue.Custom,timestamp:t.timestamp||0,data:{tag:"breadcrumb",payload:t}})})}_addPerformanceEntries(){const t=Kne(this.performanceEntries).concat(this.replayPerformanceEntries);return this.performanceEntries=[],this.replayPerformanceEntries=[],Promise.all(Lv(this,t))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:t,eventBuffer:n}=this;if(!t||!n||t.segmentId)return;const r=n.getEarliestTimestamp();r&&r<this._context.initialTimestamp&&(this._context.initialTimestamp=r)}_popEventContext(){const t={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),t}async _runFlush(){const t=this.getSessionId();if(!this.session||!this.eventBuffer||!t){mt&&K.error("[Replay] No session or eventBuffer found to flush.");return}if(await this._addPerformanceEntries(),!(!this.eventBuffer||!this.eventBuffer.hasEvents)&&(await fie(this),!!this.eventBuffer&&t===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const n=Date.now();if(n-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const r=this._popEventContext(),i=this.session.segmentId++;this._maybeSaveSession();const s=await this.eventBuffer.finish();await lB({replayId:t,recordingData:s,segmentId:i,eventContext:r,session:this.session,options:this.getOptions(),timestamp:n})}catch(n){this._handleException(n),this.stop({reason:"sendReplay"});const r=ut();r&&r.recordDroppedEvent("send_error","replay")}}__init5(){this._flush=async({force:t=!1}={})=>{if(!this._isEnabled&&!t)return;if(!this.checkAndHandleExpiredSession()){mt&&K.error("[Replay] Attempting to finish replay event after session expired.");return}if(!this.session)return;const n=this.session.started,i=Date.now()-n;this._debouncedFlush.cancel();const s=i<this._options.minReplayDuration,o=i>this._options.maxReplayDuration+5e3;if(s||o){or(`[Replay] Session duration (${Math.floor(i/1e3)}s) is too ${s?"short":"long"}, not sending replay.`,this._options._experiments.traceInternals),s&&this._debouncedFlush();return}const a=this.eventBuffer;if(a&&this.session.segmentId===0&&!a.hasCheckout&&or("[Replay] Flushing initial segment without checkout.",this._options._experiments.traceInternals),!this._flushLock){this._flushLock=this._runFlush(),await this._flushLock,this._flushLock=void 0;return}try{await this._flushLock}catch(c){mt&&K.error(c)}finally{this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&zw(this.session)}__init6(){this._onMutationHandler=t=>{const n=t.length,r=this._options.mutationLimit,i=this._options.mutationBreadcrumbLimit,s=r&&n>r;if(n>i||s){const o=Ls({category:"replay.mutations",data:{count:n,limit:s}});this._createCustomBreadcrumb(o)}return s?(this.stop({reason:"mutationLimit",forceFlush:this.recordingMode==="session"}),!1):!0}}}function Nd(e,t,n,r){const i=typeof r=="string"?r.split(","):[],s=[...e,...i,...t];return typeof n<"u"&&(typeof n=="string"&&s.push(`.${n}`),Jc(()=>{console.warn("[Replay] You are using a deprecated configuration item for privacy. Read the documentation on how to use the new privacy configuration.")})),s.join(",")}function kie({mask:e,unmask:t,block:n,unblock:r,ignore:i,blockClass:s,blockSelector:o,maskTextClass:a,maskTextSelector:c,ignoreClass:l}){const u=['base[href="/"]'],d=Nd(e,[".sentry-mask","[data-sentry-mask]"],a,c),f=Nd(t,[".sentry-unmask","[data-sentry-unmask]"]),h={maskTextSelector:d,unmaskTextSelector:f,blockSelector:Nd(n,[".sentry-block","[data-sentry-block]",...u],s,o),unblockSelector:Nd(r,[".sentry-unblock","[data-sentry-unblock]"]),ignoreSelector:Nd(i,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'],l)};return s instanceof RegExp&&(h.blockClass=s),a instanceof RegExp&&(h.maskTextClass=a),h}function Aie({el:e,key:t,maskAttributes:n,maskAllText:r,privacyOptions:i,value:s}){return!r||i.unmaskTextSelector&&e.matches(i.unmaskTextSelector)?s:n.includes(t)||t==="value"&&e.tagName==="INPUT"&&["submit","button"].includes(e.getAttribute("type")||"")?s.replace(/[\S]/g,"*"):s}const c_='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',Eie=["content-length","content-type","accept"];let l_=!1;class Uv{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:t=cte,flushMaxDelay:n=lte,minReplayDuration:r=gte,maxReplayDuration:i=HT,stickySession:s=!0,useCompression:o=!0,workerUrl:a,_experiments:c={},sessionSampleRate:l,errorSampleRate:u,maskAllText:d=!0,maskAllInputs:f=!0,blockAllMedia:h=!0,mutationBreadcrumbLimit:p=750,mutationLimit:m=1e4,slowClickTimeout:y=7e3,slowClickIgnoreSelectors:g=[],networkDetailAllowUrls:v=[],networkDetailDenyUrls:S=[],networkCaptureBodies:E=!0,networkRequestHeaders:k=[],networkResponseHeaders:b=[],mask:A=[],maskAttributes:_=["title","placeholder"],unmask:P=[],block:N=[],unblock:O=[],ignore:D=[],maskFn:U,beforeAddRecordingEvent:G,beforeErrorSampling:z,blockClass:$,blockSelector:q,maskInputOptions:W,maskTextClass:X,maskTextSelector:ne,ignoreClass:Z}={}){this.name=Uv.id;const ie=kie({mask:A,unmask:P,block:N,unblock:O,ignore:D,blockClass:$,blockSelector:q,maskTextClass:X,maskTextSelector:ne,ignoreClass:Z});if(this._recordingOptions={maskAllInputs:f,maskAllText:d,maskInputOptions:{...W||{},password:!0},maskTextFn:U,maskInputFn:U,maskAttributeFn:(ke,Ee,ge)=>Aie({maskAttributes:_,maskAllText:d,privacyOptions:ie,key:ke,value:Ee,el:ge}),...ie,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:ke=>{try{ke.__rrweb__=!0}catch{}}},this._initialOptions={flushMinDelay:t,flushMaxDelay:n,minReplayDuration:Math.min(r,mte),maxReplayDuration:Math.min(i,HT),stickySession:s,sessionSampleRate:l,errorSampleRate:u,useCompression:o,workerUrl:a,blockAllMedia:h,maskAllInputs:f,maskAllText:d,mutationBreadcrumbLimit:p,mutationLimit:m,slowClickTimeout:y,slowClickIgnoreSelectors:g,networkDetailAllowUrls:v,networkDetailDenyUrls:S,networkCaptureBodies:E,networkRequestHeaders:u_(k),networkResponseHeaders:u_(b),beforeAddRecordingEvent:G,beforeErrorSampling:z,_experiments:c},typeof l=="number"&&(console.warn(`[Replay] You are passing \`sessionSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysSessionSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysSessionSampleRate: ${l} })`),this._initialOptions.sessionSampleRate=l),typeof u=="number"&&(console.warn(`[Replay] You are passing \`errorSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysOnErrorSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysOnErrorSampleRate: ${u} })`),this._initialOptions.errorSampleRate=u),this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${c_}`:c_),this._isInitialized&&hT())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return l_}set _isInitialized(t){l_=t}setupOnce(){hT()&&(this._setup(),setTimeout(()=>this._initialize()))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:this._replay.recordingMode==="session"}):Promise.resolve()}flush(t){return!this._replay||!this._replay.isEnabled()?Promise.resolve():this._replay.sendBufferedReplayOrFlush(t)}getReplayId(){if(!(!this._replay||!this._replay.isEnabled()))return this._replay.getSessionId()}_initialize(){this._replay&&(this._maybeLoadFromReplayCanvasIntegration(),this._replay.initializeSampling())}_setup(){const t=Tie(this._initialOptions);this._replay=new ma({options:t,recordingOptions:this._recordingOptions})}_maybeLoadFromReplayCanvasIntegration(){try{const n=ut().getIntegrationByName("ReplayCanvas");if(!n)return;this._replay._canvas=n.getOptions()}catch{}}}Uv.__initStatic();function Tie(e){const t=ut(),n=t&&t.getOptions(),r={sessionSampleRate:0,errorSampleRate:0,..._r(e)};return n?(e.sessionSampleRate==null&&e.errorSampleRate==null&&n.replaysSessionSampleRate==null&&n.replaysOnErrorSampleRate==null&&Jc(()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}),typeof n.replaysSessionSampleRate=="number"&&(r.sessionSampleRate=n.replaysSessionSampleRate),typeof n.replaysOnErrorSampleRate=="number"&&(r.errorSampleRate=n.replaysOnErrorSampleRate),r):(Jc(()=>{console.warn("SDK client is not available.")}),r)}function u_(e){return[...Eie,...e.map(t=>t.toLowerCase())]}function _ie(e){const t={...e};$L(t,"react"),rte(t)}var dB={exports:{}},at={},xn=typeof Symbol=="function"&&Symbol.for,Kw=xn?Symbol.for("react.element"):60103,Jw=xn?Symbol.for("react.portal"):60106,Vv=xn?Symbol.for("react.fragment"):60107,Gv=xn?Symbol.for("react.strict_mode"):60108,Wv=xn?Symbol.for("react.profiler"):60114,jv=xn?Symbol.for("react.provider"):60109,Hv=xn?Symbol.for("react.context"):60110,Yw=xn?Symbol.for("react.async_mode"):60111,$v=xn?Symbol.for("react.concurrent_mode"):60111,zv=xn?Symbol.for("react.forward_ref"):60112,Zv=xn?Symbol.for("react.suspense"):60113,Rie=xn?Symbol.for("react.suspense_list"):60120,Xv=xn?Symbol.for("react.memo"):60115,Kv=xn?Symbol.for("react.lazy"):60116,xie=xn?Symbol.for("react.block"):60121,Nie=xn?Symbol.for("react.fundamental"):60117,Pie=xn?Symbol.for("react.responder"):60118,Mie=xn?Symbol.for("react.scope"):60119;function ri(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Kw:switch(e=e.type,e){case Yw:case $v:case Vv:case Wv:case Gv:case Zv:return e;default:switch(e=e&&e.$$typeof,e){case Hv:case zv:case Kv:case Xv:case jv:return e;default:return t}}case Jw:return t}}}function fB(e){return ri(e)===$v}at.AsyncMode=Yw;at.ConcurrentMode=$v;at.ContextConsumer=Hv;at.ContextProvider=jv;at.Element=Kw;at.ForwardRef=zv;at.Fragment=Vv;at.Lazy=Kv;at.Memo=Xv;at.Portal=Jw;at.Profiler=Wv;at.StrictMode=Gv;at.Suspense=Zv;at.isAsyncMode=function(e){return fB(e)||ri(e)===Yw};at.isConcurrentMode=fB;at.isContextConsumer=function(e){return ri(e)===Hv};at.isContextProvider=function(e){return ri(e)===jv};at.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Kw};at.isForwardRef=function(e){return ri(e)===zv};at.isFragment=function(e){return ri(e)===Vv};at.isLazy=function(e){return ri(e)===Kv};at.isMemo=function(e){return ri(e)===Xv};at.isPortal=function(e){return ri(e)===Jw};at.isProfiler=function(e){return ri(e)===Wv};at.isStrictMode=function(e){return ri(e)===Gv};at.isSuspense=function(e){return ri(e)===Zv};at.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Vv||e===$v||e===Wv||e===Gv||e===Zv||e===Rie||typeof e=="object"&&e!==null&&(e.$$typeof===Kv||e.$$typeof===Xv||e.$$typeof===jv||e.$$typeof===Hv||e.$$typeof===zv||e.$$typeof===Nie||e.$$typeof===Pie||e.$$typeof===Mie||e.$$typeof===xie)};at.typeOf=ri;dB.exports=at;var Oie=dB.exports,hB=Oie,Die={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Lie={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},pB={};pB[hB.ForwardRef]=Die;pB[hB.Memo]=Lie;const Bie=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function Fie(e){const t=e.match(/^([^.]+)/);return t!==null&&parseInt(t[0])>=17}const d_={componentStack:null,error:null,eventId:null};function Uie(e,t){const n=new WeakMap;function r(i,s){if(!n.has(i)){if(i.cause)return n.set(i,!0),r(i.cause,s);i.cause=s}}r(e,t)}class qw extends w.Component{constructor(t){super(t),qw.prototype.__init.call(this),this.state=d_,this._openFallbackReportDialog=!0;const n=ut();n&&n.on&&t.showDialog&&(this._openFallbackReportDialog=!1,n.on("afterSendEvent",r=>{!r.type&&r.event_id===this._lastEventId&&WT({...t.dialogOptions,eventId:this._lastEventId})}))}componentDidCatch(t,{componentStack:n}){const{beforeCapture:r,onError:i,showDialog:s,dialogOptions:o}=this.props;TL(a=>{if(Fie(w.version)&&pw(t)){const l=new Error(t.message);l.name=`React ErrorBoundary ${t.name}`,l.stack=n,Uie(t,l)}r&&r(a,t,n);const c=Tv(t,{captureContext:{contexts:{react:{componentStack:n}}},mechanism:{handled:!1}});i&&i(t,n,c),s&&(this._lastEventId=c,this._openFallbackReportDialog&&WT({...o,eventId:c})),this.setState({error:t,componentStack:n,eventId:c})})}componentDidMount(){const{onMount:t}=this.props;t&&t()}componentWillUnmount(){const{error:t,componentStack:n,eventId:r}=this.state,{onUnmount:i}=this.props;i&&i(t,n,r)}__init(){this.resetErrorBoundary=()=>{const{onReset:t}=this.props,{error:n,componentStack:r,eventId:i}=this.state;t&&t(n,r,i),this.setState(d_)}}render(){const{fallback:t,children:n}=this.props,r=this.state;if(r.error){let i;return typeof t=="function"?i=t({error:r.error,componentStack:r.componentStack,resetError:this.resetErrorBoundary,eventId:r.eventId}):i=t,w.isValidElement(i)?i:(t&&Bie&&K.warn("fallback did not produce a valid ReactElement"),null)}return typeof n=="function"?n():n}}function Vie(){const[e,t]=w.useState(null),[n,r]=w.useState(!1),[i,s]=w.useState([]),o=vt.useRef(null),a=vt.useRef(null),c=vt.useRef(null),l=w.useRef(!1),u=()=>{o.current&&o.current.saveLog()},d=()=>{o.current&&o.current.clearLog()},f=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return w.useEffect(()=>{if(l.current)return;const h=new IH("mongoose.moo.mud.org",8765);h.registerGMCPPackage(oH),h.registerGMCPPackage(nH),h.registerGMCPPackage(rH),h.registerGMCPPackage(qV),h.registerGMCPPackage(aH),h.registerGMCPPackage(iH),h.registerGMCPPackage(sH),h.registerGMCPPackage(JV),h.registerMcpPackage(dH),h.registerMcpPackage(fH),h.registerMcpPackage(pH),h.registerMcpPackage(gH),h.connect(),h.requestNotificationPermission(),t(h),r(!f),window.mudClient=h,l.current=!0;const p=y=>{h&&(y.key==="Control"&&h.cancelSpeech(),y.key==="Escape"&&h.stopAllSounds())};window.addEventListener("keydown",p);const m=()=>{var y;(y=a.current)==null||y.focus()};return document.addEventListener("focus",m),()=>{window.removeEventListener("keydown",p),document.removeEventListener("focus",m)}},[f]),w.useEffect(()=>{if(e){const h=m=>{s(m)},p=()=>{s([])};return e.on("userlist",h),e.on("disconnect",p),()=>{e.off("userlist",h),e.off("disconnect",p)}}},[e]),Jx(h=>{e&&e.shutdown()}),e?J.jsx(qw,{fallback:J.jsx("p",{children:"An error has occurred"}),children:J.jsxs("div",{className:"App",children:[J.jsx("header",{className:"App-header"}),J.jsx(n8,{client:e,onSaveLog:u,onClearLog:d,onToggleUsers:()=>r(!n),onOpenPrefs:()=>{var h;return(h=c.current)==null?void 0:h.open()}}),J.jsxs("div",{children:[J.jsx(RC,{client:e,ref:o}),n&&J.jsx(i8,{users:i}),J.jsx(CJ,{client:e})]}),J.jsx(bH,{onSend:e.sendCommand,inputRef:a}),J.jsx(r8,{client:e}),J.jsx(Z$,{ref:c})]})}):null}function Gie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function h_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f_(Object(n),!0).forEach(function(r){Gie(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f_(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Wie(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,s;for(s=0;s<r.length;s++)i=r[s],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function jie(e,t){if(e==null)return{};var n=Wie(e,t),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Hie(e,t){return $ie(e)||zie(e,t)||Zie(e,t)||Xie()}function $ie(e){if(Array.isArray(e))return e}function zie(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,i=!1,s=void 0;try{for(var o=e[Symbol.iterator](),a;!(r=(a=o.next()).done)&&(n.push(a.value),!(t&&n.length===t));r=!0);}catch(c){i=!0,s=c}finally{try{!r&&o.return!=null&&o.return()}finally{if(i)throw s}}return n}}function Zie(e,t){if(e){if(typeof e=="string")return p_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p_(e,t)}}function p_(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function m_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?g_(Object(n),!0).forEach(function(r){Kie(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g_(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Jie(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduceRight(function(i,s){return s(i)},r)}}function zd(e){return function t(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=e.length?e.apply(this,i):function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return t.apply(n,[].concat(i,a))}}}function Rm(e){return{}.toString.call(e).includes("Object")}function Yie(e){return!Object.keys(e).length}function nh(e){return typeof e=="function"}function qie(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Qie(e,t){return Rm(t)||$a("changeType"),Object.keys(t).some(function(n){return!qie(e,n)})&&$a("changeField"),t}function ese(e){nh(e)||$a("selectorType")}function tse(e){nh(e)||Rm(e)||$a("handlerType"),Rm(e)&&Object.values(e).some(function(t){return!nh(t)})&&$a("handlersType")}function nse(e){e||$a("initialIsRequired"),Rm(e)||$a("initialType"),Yie(e)&&$a("initialContent")}function rse(e,t){throw new Error(e[t]||e.default)}var ise={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},$a=zd(rse)(ise),Sp={changes:Qie,selector:ese,handler:tse,initial:nse};function sse(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Sp.initial(e),Sp.handler(t);var n={current:e},r=zd(cse)(n,t),i=zd(ase)(n),s=zd(Sp.changes)(e),o=zd(ose)(n);function a(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return Sp.selector(l),l(n.current)}function c(l){Jie(r,i,s,o)(l)}return[a,c]}function ose(e,t){return nh(t)?t(e.current):t}function ase(e,t){return e.current=m_(m_({},e.current),t),t}function cse(e,t,n){return nh(t)?t(e.current):Object.keys(n).forEach(function(r){var i;return(i=t[r])===null||i===void 0?void 0:i.call(t,e.current[r])}),n}var lse={create:sse},use={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function dse(e){return function t(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=e.length?e.apply(this,i):function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return t.apply(n,[].concat(i,a))}}}function fse(e){return{}.toString.call(e).includes("Object")}function hse(e){return e||v_("configIsRequired"),fse(e)||v_("configType"),e.urls?(pse(),{paths:{vs:e.urls.monacoBase}}):e}function pse(){console.warn(gB.deprecation)}function gse(e,t){throw new Error(e[t]||e.default)}var gB={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},v_=dse(gse)(gB),mse={config:hse},vse=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(s,o){return o(s)},i)}};function mB(e,t){return Object.keys(t).forEach(function(n){t[n]instanceof Object&&e[n]&&Object.assign(t[n],mB(e[n],t[n]))}),h_(h_({},e),t)}var yse={type:"cancelation",msg:"operation is manually canceled"};function y0(e){var t=!1,n=new Promise(function(r,i){e.then(function(s){return t?i(yse):r(s)}),e.catch(i)});return n.cancel=function(){return t=!0},n}var Cse=lse.create({config:use,isInitialized:!1,resolve:null,reject:null,monaco:null}),vB=Hie(Cse,2),Ph=vB[0],Jv=vB[1];function Ise(e){var t=mse.config(e),n=t.monaco,r=jie(t,["monaco"]);Jv(function(i){return{config:mB(i.config,r),monaco:n}})}function Sse(){var e=Ph(function(t){var n=t.monaco,r=t.isInitialized,i=t.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!e.isInitialized){if(Jv({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),y0(C0);if(window.monaco&&window.monaco.editor)return yB(window.monaco),e.resolve(window.monaco),y0(C0);vse(bse,kse)(Ase)}return y0(C0)}function bse(e){return document.body.appendChild(e)}function wse(e){var t=document.createElement("script");return e&&(t.src=e),t}function kse(e){var t=Ph(function(r){var i=r.config,s=r.reject;return{config:i,reject:s}}),n=wse("".concat(t.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=t.reject,n}function Ase(){var e=Ph(function(n){var r=n.config,i=n.resolve,s=n.reject;return{config:r,resolve:i,reject:s}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(n){yB(n),e.resolve(n)},function(n){e.reject(n)})}function yB(e){Ph().monaco||Jv({monaco:e})}function Ese(){return Ph(function(e){var t=e.monaco;return t})}var C0=new Promise(function(e,t){return Jv({resolve:e,reject:t})}),CB={config:Ise,init:Sse,__getMonacoInstance:Ese},Tse={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},I0=Tse,_se={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},Rse=_se;function xse({children:e}){return vt.createElement("div",{style:Rse.container},e)}var Nse=xse,Pse=Nse;function Mse({width:e,height:t,isEditorReady:n,loading:r,_ref:i,className:s,wrapperProps:o}){return vt.createElement("section",{style:{...I0.wrapper,width:e,height:t},...o},!n&&vt.createElement(Pse,null,r),vt.createElement("div",{ref:i,style:{...I0.fullWidth,...!n&&I0.hide},className:s}))}var Ose=Mse,IB=w.memo(Ose);function Dse(e){w.useEffect(e,[])}var SB=Dse;function Lse(e,t,n=!0){let r=w.useRef(!0);w.useEffect(r.current||!n?()=>{r.current=!1}:e,t)}var Zr=Lse;function gf(){}function Xl(e,t,n,r){return Bse(e,r)||Fse(e,t,n,r)}function Bse(e,t){return e.editor.getModel(bB(e,t))}function Fse(e,t,n,r){return e.editor.createModel(t,n,r?bB(e,r):void 0)}function bB(e,t){return e.Uri.parse(t)}function Use({original:e,modified:t,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:s,modifiedModelPath:o,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:c=!1,theme:l="light",loading:u="Loading...",options:d={},height:f="100%",width:h="100%",className:p,wrapperProps:m={},beforeMount:y=gf,onMount:g=gf}){let[v,S]=w.useState(!1),[E,k]=w.useState(!0),b=w.useRef(null),A=w.useRef(null),_=w.useRef(null),P=w.useRef(g),N=w.useRef(y),O=w.useRef(!1);SB(()=>{let z=CB.init();return z.then($=>(A.current=$)&&k(!1)).catch($=>($==null?void 0:$.type)!=="cancelation"&&console.error("Monaco initialization: error:",$)),()=>b.current?G():z.cancel()}),Zr(()=>{if(b.current&&A.current){let z=b.current.getOriginalEditor(),$=Xl(A.current,e||"",r||n||"text",s||"");$!==z.getModel()&&z.setModel($)}},[s],v),Zr(()=>{if(b.current&&A.current){let z=b.current.getModifiedEditor(),$=Xl(A.current,t||"",i||n||"text",o||"");$!==z.getModel()&&z.setModel($)}},[o],v),Zr(()=>{let z=b.current.getModifiedEditor();z.getOption(A.current.editor.EditorOption.readOnly)?z.setValue(t||""):t!==z.getValue()&&(z.executeEdits("",[{range:z.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),z.pushUndoStop())},[t],v),Zr(()=>{var z,$;($=(z=b.current)==null?void 0:z.getModel())==null||$.original.setValue(e||"")},[e],v),Zr(()=>{let{original:z,modified:$}=b.current.getModel();A.current.editor.setModelLanguage(z,r||n||"text"),A.current.editor.setModelLanguage($,i||n||"text")},[n,r,i],v),Zr(()=>{var z;(z=A.current)==null||z.editor.setTheme(l)},[l],v),Zr(()=>{var z;(z=b.current)==null||z.updateOptions(d)},[d],v);let D=w.useCallback(()=>{var q;if(!A.current)return;N.current(A.current);let z=Xl(A.current,e||"",r||n||"text",s||""),$=Xl(A.current,t||"",i||n||"text",o||"");(q=b.current)==null||q.setModel({original:z,modified:$})},[n,t,i,e,r,s,o]),U=w.useCallback(()=>{var z;!O.current&&_.current&&(b.current=A.current.editor.createDiffEditor(_.current,{automaticLayout:!0,...d}),D(),(z=A.current)==null||z.editor.setTheme(l),S(!0),O.current=!0)},[d,l,D]);w.useEffect(()=>{v&&P.current(b.current,A.current)},[v]),w.useEffect(()=>{!E&&!v&&U()},[E,v,U]);function G(){var $,q,W,X;let z=($=b.current)==null?void 0:$.getModel();a||((q=z==null?void 0:z.original)==null||q.dispose()),c||((W=z==null?void 0:z.modified)==null||W.dispose()),(X=b.current)==null||X.dispose()}return vt.createElement(IB,{width:h,height:f,isEditorReady:v,loading:u,_ref:_,className:p,wrapperProps:m})}var Vse=Use;w.memo(Vse);function Gse(e){let t=w.useRef();return w.useEffect(()=>{t.current=e},[e]),t.current}var Wse=Gse,bp=new Map;function jse({defaultValue:e,defaultLanguage:t,defaultPath:n,value:r,language:i,path:s,theme:o="light",line:a,loading:c="Loading...",options:l={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:f=!1,width:h="100%",height:p="100%",className:m,wrapperProps:y={},beforeMount:g=gf,onMount:v=gf,onChange:S,onValidate:E=gf}){let[k,b]=w.useState(!1),[A,_]=w.useState(!0),P=w.useRef(null),N=w.useRef(null),O=w.useRef(null),D=w.useRef(v),U=w.useRef(g),G=w.useRef(),z=w.useRef(r),$=Wse(s),q=w.useRef(!1),W=w.useRef(!1);SB(()=>{let Z=CB.init();return Z.then(ie=>(P.current=ie)&&_(!1)).catch(ie=>(ie==null?void 0:ie.type)!=="cancelation"&&console.error("Monaco initialization: error:",ie)),()=>N.current?ne():Z.cancel()}),Zr(()=>{var ie,ke,Ee,ge;let Z=Xl(P.current,e||r||"",t||i||"",s||n||"");Z!==((ie=N.current)==null?void 0:ie.getModel())&&(d&&bp.set($,(ke=N.current)==null?void 0:ke.saveViewState()),(Ee=N.current)==null||Ee.setModel(Z),d&&((ge=N.current)==null||ge.restoreViewState(bp.get(s))))},[s],k),Zr(()=>{var Z;(Z=N.current)==null||Z.updateOptions(l)},[l],k),Zr(()=>{!N.current||r===void 0||(N.current.getOption(P.current.editor.EditorOption.readOnly)?N.current.setValue(r):r!==N.current.getValue()&&(W.current=!0,N.current.executeEdits("",[{range:N.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),N.current.pushUndoStop(),W.current=!1))},[r],k),Zr(()=>{var ie,ke;let Z=(ie=N.current)==null?void 0:ie.getModel();Z&&i&&((ke=P.current)==null||ke.editor.setModelLanguage(Z,i))},[i],k),Zr(()=>{var Z;a!==void 0&&((Z=N.current)==null||Z.revealLine(a))},[a],k),Zr(()=>{var Z;(Z=P.current)==null||Z.editor.setTheme(o)},[o],k);let X=w.useCallback(()=>{var Z;if(!(!O.current||!P.current)&&!q.current){U.current(P.current);let ie=s||n,ke=Xl(P.current,r||e||"",t||i||"",ie||"");N.current=(Z=P.current)==null?void 0:Z.editor.create(O.current,{model:ke,automaticLayout:!0,...l},u),d&&N.current.restoreViewState(bp.get(ie)),P.current.editor.setTheme(o),a!==void 0&&N.current.revealLine(a),b(!0),q.current=!0}},[e,t,n,r,i,s,l,u,d,o,a]);w.useEffect(()=>{k&&D.current(N.current,P.current)},[k]),w.useEffect(()=>{!A&&!k&&X()},[A,k,X]),z.current=r,w.useEffect(()=>{var Z,ie;k&&S&&((Z=G.current)==null||Z.dispose(),G.current=(ie=N.current)==null?void 0:ie.onDidChangeModelContent(ke=>{W.current||S(N.current.getValue(),ke)}))},[k,S]),w.useEffect(()=>{if(k){let Z=P.current.editor.onDidChangeMarkers(ie=>{var Ee;let ke=(Ee=N.current.getModel())==null?void 0:Ee.uri;if(ke&&ie.find(ge=>ge.path===ke.path)){let ge=P.current.editor.getModelMarkers({resource:ke});E==null||E(ge)}});return()=>{Z==null||Z.dispose()}}return()=>{}},[k,E]);function ne(){var Z,ie;(Z=G.current)==null||Z.dispose(),f?d&&bp.set(s,N.current.saveViewState()):(ie=N.current.getModel())==null||ie.dispose(),N.current.dispose()}return vt.createElement(IB,{width:h,height:p,isEditorReady:k,loading:c,_ref:O,className:m,wrapperProps:y})}var Hse=jse,$se=w.memo(Hse),zse=$se,Zse={restoreOnUnmount:!1};function Xse(e,t){t===void 0&&(t=Zse);var n=w.useRef(document.title);document.title!==e&&(document.title=e),w.useEffect(function(){if(t&&t.restoreOnUnmount)return function(){document.title=n.current}},[])}const Kse=typeof document<"u"?Xse:function(e){};function Jse({onSave:e,onRevert:t,onDownload:n}){return J.jsx("div",{className:"toolbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderBottom:"1px solid #e8e8e8"},children:J.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[J.jsxs("button",{onClick:e,accessKey:"s",children:[J.jsx(xM,{}),"Save"]}),J.jsxs("button",{onClick:t,accessKey:"r",children:[J.jsx(Q$,{}),"Revert"]}),J.jsxs("button",{onClick:n,accessKey:"d",children:[J.jsx(Y$,{}),"Download"]})]})})}const Yse=({docstate:e,session:t})=>J.jsxs("div",{"aria-live":"polite",className:"statusbar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem",height:"10vh",backgroundColor:"#f5f5f5",borderTop:"1px solid #e8e8e8"},children:[J.jsx("span",{children:e}),J.jsx("span",{children:"|"}),J.jsx("span",{children:t.reference}),J.jsx("span",{children:"|"}),J.jsx("span",{children:t.type})]});function qse(){const e=Kx(),t=vt.useRef(null),[n,r]=w.useState(""),[i,s]=w.useState(""),[o,a]=w.useState(""),[c,l]=w.useState(0),[u,d]=w.useState({name:"none",contents:[],reference:"",type:""}),f=(U,G)=>{t.current=U},[h,p]=ic();console.log(h);const m=h.editor.accessibilityMode,y=h.editor.autocompleteEnabled;Jx(U=>{k.postMessage({type:"close",id:A}),c===1&&U.preventDefault()});const[g,v]=w.useState(!1),S=g?`${u.name} - Mongoose Editor`:"Mongoose Editor";Kse(S);const E=w.useMemo(()=>{switch(c){case 0:return"Unchanged";case 1:return"Changed";case 2:return"Saved"}},[c]),k=w.useMemo(()=>new BroadcastChannel("editor"),[]),b=new URLSearchParams(e.search),A=decodeURIComponent(b.get("reference")||"");w.useEffect(()=>{if(!A)return;console.log("ID: "+A),console.log("Sending ready message"),k.postMessage({type:"ready",id:A});const U=G=>{if(console.log(G.data),G.data.type==="load"){if(n!=="")return;const z=G.data.session.contents.join(`
`);s(z),a(z),d(G.data.session),l(0),r(G.data.clientId),setTimeout(D,100)}else if(G.data.type==="shutdown"){if(G.data.clientId!==n)return;k.close(),window.close()}};return k.addEventListener("message",U),()=>k.removeEventListener("message",U)},[k,n,A]);const _=()=>{s(o),l(0)},P=U=>{const G=i.split(/\r\n|\r|\n/),z={...u,contents:G};k.postMessage({type:"save",session:z,id:A}),l(2),D(),U.preventDefault()},N=U=>{U!==void 0&&(console.log("Original: "+o),console.log("New: "+U),s(U),U.split(/\r\n|\r|\n/).join(`
`)!==o?l(1):l(0),g||v(!0))},O=()=>{const U=new Blob([i],{type:"text/plain"}),G=URL.createObjectURL(U),z=document.createElement("a"),$=new Date,q=$.toLocaleDateString().replace(/\//g,"-"),W=$.toLocaleTimeString().replace(/:/g,"-"),X=`${u.name}-${q}-${W}.txt`;z.download=X,z.href=G,z.click(),URL.revokeObjectURL(G),z.remove()};return J.jsxs("div",{id:"editor",children:[J.jsx(Jse,{onSave:P,onRevert:_,onDownload:O}),J.jsx(zse,{height:"80vh",defaultLanguage:"lambdamoo",value:i,onChange:N,options:{wordWrap:"on",accessibilitySupport:m?"on":"off",quickSuggestions:y},onMount:f,path:u.reference}),J.jsx(Yse,{docstate:E,session:u})]});function D(){t.current!==null&&t.current.focus()}}const Qse="modulepreload",eoe=function(e){return"/"+e},y_={},toe=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link");i=Promise.all(n.map(o=>{if(o=eoe(o),o in y_)return;y_[o]=!0;const a=o.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===o&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${c}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":Qse,a||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),a)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})}))}return i.then(()=>t()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},noe=e=>{e&&e instanceof Function&&toe(()=>import("./web-vitals-BptxjviT.js"),__vite__mapDeps([])).then(({getCLS:t,getFID:n,getFCP:r,getLCP:i,getTTFB:s})=>{t(e),n(e),r(e),i(e),s(e)})};var C_={};const roe=!!(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ioe(e){if("serviceWorker"in navigator){if(new URL(C_.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const n=`${C_.PUBLIC_URL}/service-worker.js`;roe?(soe(n,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):wB(n,e)})}}function wB(e,t){navigator.serviceWorker.register(e).then(n=>{n.onupdatefound=()=>{const r=n.installing;r!=null&&(r.onstatechange=()=>{r.state==="installed"&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(n)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(n)))})}}).catch(n=>{console.error("Error during service worker registration:",n)})}function soe(e,t){fetch(e).then(n=>{const r=n.headers.get("content-type");n.status===404||r!=null&&r.indexOf("javascript")===-1?navigator.serviceWorker.ready.then(i=>{i.unregister().then(()=>{window.location.reload()})}):wB(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}_ie({dsn:"https://2356c3ef12dad1afcb30defd749d96f1@new.q-continuum.net/2",integrations:[new ZQ({tracePropagationTargets:["localhost",/^https:\/\/client\.rustytelephone\.net\//]}),new Uv],tracesSampleRate:1,replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1});const ooe=uU([{path:"/",element:J.jsx(Vie,{})},{path:"/editor",element:J.jsx(qse,{})}]),aoe=S0.createRoot(document.getElementById("root"));aoe.render(J.jsx(vt.StrictMode,{children:J.jsx(CU,{router:ooe})}));noe(console.log);ioe();
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
